1
00:00:01,750 --> 00:00:09,490
we would like<font color="#CCCCCC"> to</font><font color="#E5E5E5"> continue with</font><font color="#CCCCCC"> Sean</font>

2
00:00:05,390 --> 00:00:12,799
<font color="#E5E5E5">Metcalf welcome mister ad</font><font color="#CCCCCC"> Security ork</font>

3
00:00:09,490 --> 00:00:16,160
<font color="#E5E5E5">it's very nice to have you here</font>

4
00:00:12,799 --> 00:00:19,070
<font color="#E5E5E5">it's a pleasure</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> toast your talk</font><font color="#CCCCCC"> I</font>

5
00:00:16,160 --> 00:00:28,160
would spare<font color="#CCCCCC"> further introduction and</font>

6
00:00:19,070 --> 00:00:31,969
give the word<font color="#CCCCCC"> to you thank you Bonjour</font>

7
00:00:28,160 --> 00:00:33,950
guten<font color="#CCCCCC"> tag</font><font color="#E5E5E5"> that's the extent of French</font>

8
00:00:31,969 --> 00:00:36,410
and<font color="#E5E5E5"> German that I know so the rest will</font>

9
00:00:33,950 --> 00:00:38,000
be<font color="#E5E5E5"> in English hope that's</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> I'm Sean</font>

10
00:00:36,410 --> 00:00:40,429
Metcalfe this is from work station<font color="#CCCCCC"> to</font>

11
00:00:38,000 --> 00:00:42,050
the main admin<font color="#E5E5E5"> why secure administration</font>

12
00:00:40,430 --> 00:00:45,250
isn't<font color="#E5E5E5"> secure and how to fix it</font>

13
00:00:42,050 --> 00:00:48,019
short title is securing administration

14
00:00:45,250 --> 00:00:50,630
so I'm Sean Metcalfe<font color="#CCCCCC"> I am the founder of</font>

15
00:00:48,020 --> 00:00:51,860
<font color="#E5E5E5">Trimark security company I've spoken at</font>

16
00:00:50,630 --> 00:00:53,840
<font color="#E5E5E5">a number of conferences this is my</font>

17
00:00:51,860 --> 00:00:56,239
second time<font color="#CCCCCC"> speaking of troopers I'm</font>

18
00:00:53,840 --> 00:00:58,820
very happy to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> here I love the concept</font>

19
00:00:56,239 --> 00:01:00,620
and the<font color="#E5E5E5"> implementation of the</font><font color="#CCCCCC"> Active</font>

20
00:00:58,820 --> 00:01:03,230
<font color="#E5E5E5">Directory security trend a lot of people</font>

21
00:01:00,620 --> 00:01:05,658
like<font color="#CCCCCC"> that as well the security</font>

22
00:01:03,230 --> 00:01:07,550
<font color="#E5E5E5">consultant</font><font color="#CCCCCC"> a researcher and I post a lot</font>

23
00:01:05,659 --> 00:01:09,320
<font color="#E5E5E5">of information on any secure</font><font color="#CCCCCC"> doric which</font>

24
00:01:07,550 --> 00:01:12,380
hopefully<font color="#E5E5E5"> raise your hand if you've</font>

25
00:01:09,320 --> 00:01:15,309
heard<font color="#CCCCCC"> of</font><font color="#E5E5E5"> it at</font><font color="#CCCCCC"> least</font><font color="#E5E5E5"> okay so like half</font>

26
00:01:12,380 --> 00:01:15,310
that's<font color="#E5E5E5"> good thank you</font>

27
00:01:15,370 --> 00:01:19,760
let's get<font color="#E5E5E5"> right into it</font><font color="#CCCCCC"> so we're going</font>

28
00:01:18,350 --> 00:01:21,408
to talk<font color="#CCCCCC"> about the</font><font color="#E5E5E5"> current state</font><font color="#CCCCCC"> of</font>

29
00:01:19,760 --> 00:01:23,840
administration the<font color="#E5E5E5"> evolution where we've</font>

30
00:01:21,409 --> 00:01:25,070
come from<font color="#CCCCCC"> where</font><font color="#E5E5E5"> we're headed</font><font color="#CCCCCC"> the things</font>

31
00:01:23,840 --> 00:01:27,470
that a<font color="#E5E5E5"> lot of organizations are doing</font>

32
00:01:25,070 --> 00:01:28,970
<font color="#E5E5E5">now</font><font color="#CCCCCC"> that they think are secure and</font><font color="#E5E5E5"> I'm</font>

33
00:01:27,470 --> 00:01:30,798
going to break<font color="#CCCCCC"> down</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> reasons why they</font>

34
00:01:28,970 --> 00:01:33,770
aren't<font color="#E5E5E5"> and what really needs to be done</font>

35
00:01:30,799 --> 00:01:35,930
<font color="#E5E5E5">because ultimately attackers find a way</font>

36
00:01:33,770 --> 00:01:37,339
to domain admins<font color="#E5E5E5"> and then you have a</font>

37
00:01:35,930 --> 00:01:40,390
<font color="#CCCCCC">situation</font><font color="#E5E5E5"> where the dinosaurs are</font>

38
00:01:37,340 --> 00:01:42,650
running<font color="#E5E5E5"> loose and it's just a disaster</font>

39
00:01:40,390 --> 00:01:44,330
<font color="#E5E5E5">the current state of security is a</font>

40
00:01:42,650 --> 00:01:45,890
situation<font color="#E5E5E5"> where many organizations have</font>

41
00:01:44,330 --> 00:01:47,780
<font color="#E5E5E5">upgraded their security they have better</font>

42
00:01:45,890 --> 00:01:49,820
security tooling<font color="#E5E5E5"> they have event logging</font>

43
00:01:47,780 --> 00:01:51,770
<font color="#CCCCCC">all the</font><font color="#E5E5E5"> events from</font><font color="#CCCCCC"> windows into a sim</font>

44
00:01:49,820 --> 00:01:54,020
which<font color="#E5E5E5"> i think is a huge win because</font>

45
00:01:51,770 --> 00:01:56,030
<font color="#E5E5E5">traditionally we've had only the</font>

46
00:01:54,020 --> 00:01:58,490
perimeter devices the firewalls the web

47
00:01:56,030 --> 00:02:00,439
proxies<font color="#CCCCCC"> network devices flowing into</font><font color="#E5E5E5"> the</font>

48
00:01:58,490 --> 00:02:02,750
<font color="#E5E5E5">sim and for those with</font><font color="#CCCCCC"> Splunk that's</font>

49
00:02:00,439 --> 00:02:04,490
usually<font color="#E5E5E5"> like 90% of what ends up</font><font color="#CCCCCC"> going</font>

50
00:02:02,750 --> 00:02:05,900
into<font color="#CCCCCC"> Splunk</font><font color="#E5E5E5"> and then the poor</font><font color="#CCCCCC"> windows</font>

51
00:02:04,490 --> 00:02:07,820
<font color="#E5E5E5">security people are like can</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> get some</font>

52
00:02:05,900 --> 00:02:09,200
<font color="#CCCCCC">Windows security</font><font color="#E5E5E5"> events in and the</font>

53
00:02:07,820 --> 00:02:11,120
<font color="#CCCCCC">Splunk folks are like no we're</font><font color="#E5E5E5"> already</font>

54
00:02:09,199 --> 00:02:14,380
at 90%<font color="#CCCCCC"> of our ingestion rates we can't</font>

55
00:02:11,120 --> 00:02:16,180
do that that's a<font color="#E5E5E5"> problem</font>

56
00:02:14,380 --> 00:02:17,920
we need to<font color="#E5E5E5"> get better at that</font><font color="#CCCCCC"> because</font>

57
00:02:16,180 --> 00:02:20,140
ultimately<font color="#E5E5E5"> the battles being fought on</font>

58
00:02:17,920 --> 00:02:21,850
<font color="#E5E5E5">the workstations and those are usually</font>

59
00:02:20,140 --> 00:02:23,579
<font color="#E5E5E5">windows which means that we need</font><font color="#CCCCCC"> those</font>

60
00:02:21,850 --> 00:02:25,960
security events from<font color="#E5E5E5"> Windows devices</font>

61
00:02:23,580 --> 00:02:27,550
<font color="#CCCCCC">into our</font><font color="#E5E5E5"> sim so we really understand</font>

62
00:02:25,960 --> 00:02:29,560
what's going<font color="#CCCCCC"> on but we're doing</font>

63
00:02:27,550 --> 00:02:31,630
<font color="#E5E5E5">vulnerability scanning and we a software</font>

64
00:02:29,560 --> 00:02:34,720
<font color="#CCCCCC">security agents which</font><font color="#E5E5E5"> can be good or</font><font color="#CCCCCC"> bad</font>

65
00:02:31,630 --> 00:02:36,490
<font color="#CCCCCC">depending on what we've deployed but</font><font color="#E5E5E5"> the</font>

66
00:02:34,720 --> 00:02:38,680
ultimate problem<font color="#E5E5E5"> the biggest issue is</font>

67
00:02:36,490 --> 00:02:40,630
many organizations have<font color="#E5E5E5"> not fixed or</font>

68
00:02:38,680 --> 00:02:42,490
changed the way they manage<font color="#CCCCCC"> an</font><font color="#E5E5E5"> Active</font>

69
00:02:40,630 --> 00:02:46,410
<font color="#E5E5E5">Directory</font><font color="#CCCCCC"> the way they administer the</font>

70
00:02:42,490 --> 00:02:49,300
<font color="#E5E5E5">system so let's go back to</font><font color="#CCCCCC"> the beginning</font>

71
00:02:46,410 --> 00:02:51,549
<font color="#E5E5E5">we had a user with a workstation</font><font color="#CCCCCC"> was</font>

72
00:02:49,300 --> 00:02:52,690
very happy<font color="#E5E5E5"> just</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> user could do</font>

73
00:02:51,550 --> 00:02:54,010
whatever they<font color="#CCCCCC"> wanted they installed</font>

74
00:02:52,690 --> 00:02:57,880
their own software<font color="#CCCCCC"> they set up their own</font>

75
00:02:54,010 --> 00:02:58,959
printer<font color="#E5E5E5"> very happy not</font><font color="#CCCCCC"> a problem but</font>

76
00:02:57,880 --> 00:03:00,460
<font color="#E5E5E5">they were still using an older version</font>

77
00:02:58,960 --> 00:03:03,100
of Windows so maybe they were not so

78
00:03:00,460 --> 00:03:04,360
happy<font color="#E5E5E5"> then we add a desktop support so</font>

79
00:03:03,100 --> 00:03:06,540
now we have some<font color="#E5E5E5"> other</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> they can</font>

80
00:03:04,360 --> 00:03:09,130
<font color="#E5E5E5">manage and administer that system and</font>

81
00:03:06,540 --> 00:03:10,510
then<font color="#CCCCCC"> we said</font><font color="#E5E5E5"> well which doesn't</font><font color="#CCCCCC"> make</font>

82
00:03:09,130 --> 00:03:12,040
<font color="#CCCCCC">sense</font><font color="#E5E5E5"> for someone to walk around and</font>

83
00:03:10,510 --> 00:03:14,260
<font color="#E5E5E5">actually install patches on all these</font>

84
00:03:12,040 --> 00:03:17,140
<font color="#E5E5E5">systems so we added agents for patching</font>

85
00:03:14,260 --> 00:03:18,910
a patching system and then we got to<font color="#E5E5E5"> the</font>

86
00:03:17,140 --> 00:03:20,890
point where we have this big control

87
00:03:18,910 --> 00:03:22,090
center of<font color="#E5E5E5"> all these different agents of</font>

88
00:03:20,890 --> 00:03:24,459
all<font color="#E5E5E5"> these different</font><font color="#CCCCCC"> systems that</font><font color="#E5E5E5"> manage</font>

89
00:03:22,090 --> 00:03:25,780
<font color="#E5E5E5">all of our workstations and servers and</font>

90
00:03:24,460 --> 00:03:28,620
systems<font color="#CCCCCC"> that</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> but we end up in a</font>

91
00:03:25,780 --> 00:03:30,820
<font color="#CCCCCC">situation</font><font color="#E5E5E5"> where we have one workstation</font>

92
00:03:28,620 --> 00:03:33,250
<font color="#E5E5E5">with 30 accounts and local</font>

93
00:03:30,820 --> 00:03:35,019
administrators<font color="#CCCCCC"> group</font><font color="#E5E5E5"> 50 accounts with</font>

94
00:03:33,250 --> 00:03:37,270
local admin via the software<font color="#CCCCCC"> management</font>

95
00:03:35,020 --> 00:03:39,150
system 20 accounts with control of<font color="#CCCCCC"> the</font>

96
00:03:37,270 --> 00:03:41,830
<font color="#E5E5E5">computer</font><font color="#CCCCCC"> via</font><font color="#E5E5E5"> the security agents and</font>

97
00:03:39,150 --> 00:03:43,600
about a hundred accounts<font color="#CCCCCC"> in the</font>

98
00:03:41,830 --> 00:03:46,120
organization that<font color="#CCCCCC"> have effective admin</font>

99
00:03:43,600 --> 00:03:48,180
rights in the workstation<font color="#E5E5E5"> so depending</font>

100
00:03:46,120 --> 00:03:51,730
<font color="#E5E5E5">on your perspective this number is low</font>

101
00:03:48,180 --> 00:03:54,070
hopefully not<font color="#E5E5E5"> where it's high</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

102
00:03:51,730 --> 00:03:58,090
<font color="#E5E5E5">about an</font><font color="#CCCCCC"> average of what I've seen in</font>

103
00:03:54,070 --> 00:04:00,130
organizations of<font color="#CCCCCC"> various sizes</font><font color="#E5E5E5"> any agent</font>

104
00:03:58,090 --> 00:04:04,030
<font color="#E5E5E5">that can install or run code is of</font>

105
00:04:00,130 --> 00:04:05,140
concern<font color="#E5E5E5"> because we don't</font><font color="#CCCCCC"> really</font>

106
00:04:04,030 --> 00:04:07,060
understand who has<font color="#E5E5E5"> control these</font>

107
00:04:05,140 --> 00:04:08,649
<font color="#E5E5E5">workstations what accounts do</font><font color="#CCCCCC"> pen</font>

108
00:04:07,060 --> 00:04:10,630
<font color="#CCCCCC">testers or</font><font color="#E5E5E5"> red teamers obviously take</font>

109
00:04:08,650 --> 00:04:14,230
advantage of this<font color="#E5E5E5"> you leverage this to</font>

110
00:04:10,630 --> 00:04:16,260
the to their benefit as do attackers so

111
00:04:14,230 --> 00:04:18,909
the way that<font color="#E5E5E5"> administration is has</font>

112
00:04:16,260 --> 00:04:20,920
occurred and is managed as evolved<font color="#E5E5E5"> as</font>

113
00:04:18,910 --> 00:04:23,830
well<font color="#CCCCCC"> we've gone from things</font><font color="#E5E5E5"> from like</font>

114
00:04:20,920 --> 00:04:25,330
VNC to RDP<font color="#CCCCCC"> we do a lot of run as and</font>

115
00:04:23,830 --> 00:04:27,719
then use the Microsoft management

116
00:04:25,330 --> 00:04:30,599
console the MMC locally

117
00:04:27,720 --> 00:04:32,700
and in the<font color="#CCCCCC"> beginning there were admins</font>

118
00:04:30,600 --> 00:04:34,350
everywhere<font color="#E5E5E5"> every local administrator</font>

119
00:04:32,700 --> 00:04:37,260
account is the<font color="#E5E5E5"> same name and password</font>

120
00:04:34,350 --> 00:04:39,480
<font color="#E5E5E5">and some environments had as many domain</font>

121
00:04:37,260 --> 00:04:40,740
admins as users you just<font color="#E5E5E5"> decided you</font>

122
00:04:39,480 --> 00:04:42,180
<font color="#E5E5E5">know what you're a user on this</font>

123
00:04:40,740 --> 00:04:43,950
environment<font color="#E5E5E5"> let's make you a domain</font>

124
00:04:42,180 --> 00:04:45,300
admin<font color="#E5E5E5"> just in case we need</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> do some</font>

125
00:04:43,950 --> 00:04:47,640
maintenance at<font color="#CCCCCC"> the end of the day and</font>

126
00:04:45,300 --> 00:04:49,830
the<font color="#E5E5E5"> people who are</font><font color="#CCCCCC"> designated the</font><font color="#E5E5E5"> ad</font>

127
00:04:47,640 --> 00:04:51,510
admins they're out<font color="#E5E5E5"> where we just need to</font>

128
00:04:49,830 --> 00:04:52,950
<font color="#E5E5E5">shut down the DC for the weekend because</font>

129
00:04:51,510 --> 00:04:54,750
there's a power outage<font color="#CCCCCC"> or we just need</font>

130
00:04:52,950 --> 00:04:57,090
to<font color="#E5E5E5"> restart it we'll just</font><font color="#CCCCCC"> make everyone</font>

131
00:04:54,750 --> 00:04:57,870
an admin<font color="#E5E5E5"> to handle that that way we're</font>

132
00:04:57,090 --> 00:05:00,929
all<font color="#E5E5E5"> that we're all in this together</font>

133
00:04:57,870 --> 00:05:02,520
right<font color="#CCCCCC"> we can</font><font color="#E5E5E5"> trust everyone but</font><font color="#CCCCCC"> this</font>

134
00:05:00,930 --> 00:05:04,140
resulted in<font color="#E5E5E5"> this very target-rich</font>

135
00:05:02,520 --> 00:05:06,990
<font color="#E5E5E5">environment with multiple</font><font color="#CCCCCC"> paths to</font>

136
00:05:04,140 --> 00:05:10,770
exporting the environment and these

137
00:05:06,990 --> 00:05:12,750
traditional methods<font color="#CCCCCC"> are ripe</font><font color="#E5E5E5"> for attack</font>

138
00:05:10,770 --> 00:05:15,020
<font color="#E5E5E5">and</font><font color="#CCCCCC"> compromise because these admin</font>

139
00:05:12,750 --> 00:05:17,790
credentials are everywhere

140
00:05:15,020 --> 00:05:18,990
the<font color="#E5E5E5"> old-school admin methods of logging</font>

141
00:05:17,790 --> 00:05:21,690
<font color="#E5E5E5">out of the</font><font color="#CCCCCC"> workstation as an admin</font>

142
00:05:18,990 --> 00:05:23,640
credentials go in alsace running run as

143
00:05:21,690 --> 00:05:26,010
on the system credentials go in alsace

144
00:05:23,640 --> 00:05:28,770
<font color="#E5E5E5">and then we RDP to the domain controller</font>

145
00:05:26,010 --> 00:05:30,710
or the<font color="#E5E5E5"> admin server</font><font color="#CCCCCC"> remotely</font><font color="#E5E5E5"> and then</font>

146
00:05:28,770 --> 00:05:33,030
the credentials end up in that<font color="#E5E5E5"> alsace</font>

147
00:05:30,710 --> 00:05:34,560
<font color="#E5E5E5">and of course we can use many cats</font><font color="#CCCCCC"> to</font>

148
00:05:33,030 --> 00:05:38,400
<font color="#CCCCCC">pull have admin</font><font color="#E5E5E5"> rights</font><font color="#CCCCCC"> on that</font><font color="#E5E5E5"> system</font>

149
00:05:34,560 --> 00:05:40,880
<font color="#E5E5E5">now</font><font color="#CCCCCC"> organizations have realize this</font>

150
00:05:38,400 --> 00:05:43,590
they've gone to newer more secure

151
00:05:40,880 --> 00:05:47,010
administration methods right<font color="#E5E5E5"> now we</font>

152
00:05:43,590 --> 00:05:50,549
don't<font color="#CCCCCC"> use the MMC locally well actually</font>

153
00:05:47,010 --> 00:05:51,870
<font color="#E5E5E5">they still do but a lot</font><font color="#CCCCCC"> of organizations</font>

154
00:05:50,550 --> 00:05:55,250
<font color="#E5E5E5">have shifted away from that so that's</font>

155
00:05:51,870 --> 00:05:59,220
good<font color="#CCCCCC"> and there's not as much run as</font>

156
00:05:55,250 --> 00:06:02,580
hopefully so that's good<font color="#E5E5E5"> so how do we</font>

157
00:05:59,220 --> 00:06:05,400
secure<font color="#E5E5E5"> our administration now well our</font>

158
00:06:02,580 --> 00:06:08,370
admins are logged<font color="#CCCCCC"> into their workstation</font>

159
00:06:05,400 --> 00:06:10,229
as a user<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is good and they use RDP</font>

160
00:06:08,370 --> 00:06:12,510
to connect into<font color="#CCCCCC"> an admin server to then</font>

161
00:06:10,230 --> 00:06:14,070
perform<font color="#E5E5E5"> their administration this means</font>

162
00:06:12,510 --> 00:06:16,289
<font color="#E5E5E5">that those credentials would be on that</font>

163
00:06:14,070 --> 00:06:17,760
<font color="#CCCCCC">system</font><font color="#E5E5E5"> and not on our</font><font color="#CCCCCC"> local system</font><font color="#E5E5E5"> so</font>

164
00:06:16,290 --> 00:06:19,950
that means tools like bloodhound are not

165
00:06:17,760 --> 00:06:21,570
going to see that an admin is using<font color="#E5E5E5"> that</font>

166
00:06:19,950 --> 00:06:23,099
workstation<font color="#CCCCCC"> to RDP into</font><font color="#E5E5E5"> another one</font>

167
00:06:21,570 --> 00:06:26,159
because<font color="#E5E5E5"> their credentials are not on</font>

168
00:06:23,100 --> 00:06:28,500
<font color="#E5E5E5">that</font><font color="#CCCCCC"> system</font><font color="#E5E5E5"> it's good</font><font color="#CCCCCC"> and maybe they're</font>

169
00:06:26,160 --> 00:06:32,490
<font color="#E5E5E5">using</font><font color="#CCCCCC"> MFA something like duo to protect</font>

170
00:06:28,500 --> 00:06:34,260
that<font color="#E5E5E5"> RDP session</font><font color="#CCCCCC"> or perhaps there's a</font>

171
00:06:32,490 --> 00:06:36,780
password<font color="#E5E5E5"> vault like secret server or</font>

172
00:06:34,260 --> 00:06:38,969
cyber-ark that's in use<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> actually</font>

173
00:06:36,780 --> 00:06:41,130
managing<font color="#E5E5E5"> the credential that admin the</font>

174
00:06:38,970 --> 00:06:41,520
domain admin credential so that way the

175
00:06:41,130 --> 00:06:42,900
<font color="#CCCCCC">person</font>

176
00:06:41,520 --> 00:06:45,120
themselves<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> know it they</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> have</font>

177
00:06:42,900 --> 00:06:49,068
<font color="#E5E5E5">to create that admin</font><font color="#CCCCCC"> one-two-three-four</font>

178
00:06:45,120 --> 00:06:51,569
<font color="#E5E5E5">password</font><font color="#CCCCCC"> the system itself</font><font color="#E5E5E5"> manages</font><font color="#CCCCCC"> it</font>

179
00:06:49,069 --> 00:06:52,860
but<font color="#E5E5E5"> even with the secure method</font><font color="#CCCCCC"> of</font>

180
00:06:51,569 --> 00:06:56,039
administration<font color="#E5E5E5"> there's a number of</font><font color="#CCCCCC"> ways</font>

181
00:06:52,860 --> 00:06:57,659
<font color="#CCCCCC">to exploit</font><font color="#E5E5E5"> this take advantage of it</font><font color="#CCCCCC"> so</font>

182
00:06:56,039 --> 00:07:00,719
here<font color="#CCCCCC"> we have our a regular user account</font>

183
00:06:57,659 --> 00:07:03,509
on the system and<font color="#E5E5E5"> our admin is going to</font>

184
00:07:00,720 --> 00:07:05,250
connect<font color="#CCCCCC"> into our server in this case or</font>

185
00:07:03,509 --> 00:07:06,770
<font color="#E5E5E5">domain controller in</font><font color="#CCCCCC"> order to administer</font>

186
00:07:05,250 --> 00:07:09,270
Active Directory

187
00:07:06,770 --> 00:07:11,460
well what's very interesting is once

188
00:07:09,270 --> 00:07:12,628
this admin does that again they're

189
00:07:11,460 --> 00:07:14,068
logged on to<font color="#E5E5E5"> their regular user</font>

190
00:07:12,629 --> 00:07:15,900
workstation with their regular<font color="#E5E5E5"> user</font>

191
00:07:14,069 --> 00:07:17,580
account and then already<font color="#E5E5E5"> peeing into</font>

192
00:07:15,900 --> 00:07:19,859
<font color="#E5E5E5">their domain controller to</font><font color="#CCCCCC"> perform</font>

193
00:07:17,580 --> 00:07:21,810
administration<font color="#E5E5E5"> with their domain admin</font>

194
00:07:19,860 --> 00:07:23,370
account<font color="#E5E5E5"> is that</font><font color="#CCCCCC"> once they do this</font>

195
00:07:21,810 --> 00:07:25,319
there's a very<font color="#CCCCCC"> odd file that gets</font>

196
00:07:23,370 --> 00:07:28,770
<font color="#E5E5E5">dropped onto the C Drive and it's this</font>

197
00:07:25,319 --> 00:07:31,830
will underscore one dot TMP file which

198
00:07:28,770 --> 00:07:33,120
no one seems<font color="#CCCCCC"> to notice</font><font color="#E5E5E5"> but what has</font>

199
00:07:31,830 --> 00:07:35,880
happened<font color="#CCCCCC"> in the background that the</font>

200
00:07:33,120 --> 00:07:40,199
admin didn't realize is<font color="#E5E5E5"> that there was a</font>

201
00:07:35,880 --> 00:07:42,509
<font color="#CCCCCC">WMI in system</font><font color="#E5E5E5"> anytime</font><font color="#CCCCCC"> ms TS c dot exe</font><font color="#E5E5E5"> is</font>

202
00:07:40,199 --> 00:07:45,569
run there's a<font color="#E5E5E5"> key logger that's</font><font color="#CCCCCC"> ron</font>

203
00:07:42,509 --> 00:07:48,509
<font color="#E5E5E5">under the guise of</font><font color="#CCCCCC"> SCCM</font><font color="#E5E5E5"> health check ps1</font>

204
00:07:45,569 --> 00:07:50,520
<font color="#E5E5E5">and so this is</font><font color="#CCCCCC"> just using</font><font color="#E5E5E5"> a standard</font>

205
00:07:48,509 --> 00:07:52,740
<font color="#CCCCCC">power</font><font color="#E5E5E5"> sploit function called gets</font>

206
00:07:50,520 --> 00:07:57,750
keystrokes<font color="#E5E5E5"> which is looking for</font>

207
00:07:52,740 --> 00:07:59,430
keystrokes whenever it's invoked and it

208
00:07:57,750 --> 00:08:02,099
gets logged to a file much like any key

209
00:07:59,430 --> 00:08:04,259
logger<font color="#E5E5E5"> and continues and continues and</font>

210
00:08:02,099 --> 00:08:05,909
continues what we can use PowerShell<font color="#E5E5E5"> to</font>

211
00:08:04,259 --> 00:08:09,300
<font color="#E5E5E5">very easily and quickly parse through</font>

212
00:08:05,909 --> 00:08:15,210
<font color="#E5E5E5">that and</font><font color="#CCCCCC"> identify what's been typed into</font>

213
00:08:09,300 --> 00:08:16,680
<font color="#E5E5E5">RDP which is a problem well there's some</font>

214
00:08:15,210 --> 00:08:17,940
organizations that<font color="#E5E5E5"> said you know what</font>

215
00:08:16,680 --> 00:08:19,560
<font color="#E5E5E5">we're gonna protect our admins with</font>

216
00:08:17,940 --> 00:08:22,110
smart cards<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> going to go ahead and</font>

217
00:08:19,560 --> 00:08:23,580
do<font color="#CCCCCC"> that</font><font color="#E5E5E5"> RDP with a smart card and that</font>

218
00:08:22,110 --> 00:08:26,490
way there's no passwords on that system

219
00:08:23,580 --> 00:08:28,500
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is secure right because there's no</font>

220
00:08:26,490 --> 00:08:29,639
<font color="#CCCCCC">password or anything like</font><font color="#E5E5E5"> that well if</font>

221
00:08:28,500 --> 00:08:31,770
you were in Vincents session just before

222
00:08:29,639 --> 00:08:33,990
mine<font color="#CCCCCC"> we know</font><font color="#E5E5E5"> that that's not</font><font color="#CCCCCC"> the case</font>

223
00:08:31,770 --> 00:08:35,939
<font color="#E5E5E5">certainly</font><font color="#CCCCCC"> the smart card pin can be</font>

224
00:08:33,990 --> 00:08:37,620
extracted<font color="#E5E5E5"> pretty</font><font color="#CCCCCC"> easily using a number</font>

225
00:08:35,940 --> 00:08:39,719
of<font color="#CCCCCC"> methods maybe cats</font><font color="#E5E5E5"> being one of them</font>

226
00:08:37,620 --> 00:08:40,070
<font color="#E5E5E5">and once we have</font><font color="#CCCCCC"> that pin for that smart</font>

227
00:08:39,719 --> 00:08:42,690
card

228
00:08:40,070 --> 00:08:44,310
does that admin ever really remove<font color="#E5E5E5"> that</font>

229
00:08:42,690 --> 00:08:46,350
smart card from that<font color="#E5E5E5"> system probably not</font>

230
00:08:44,310 --> 00:08:48,449
which<font color="#E5E5E5"> means that it's it's configured</font>

231
00:08:46,350 --> 00:08:50,370
there and they the attacker<font color="#E5E5E5"> on that</font>

232
00:08:48,450 --> 00:08:52,829
system<font color="#E5E5E5"> can leverage that smart card</font>

233
00:08:50,370 --> 00:08:56,190
that's already in place<font color="#CCCCCC"> with that pin in</font>

234
00:08:52,829 --> 00:08:59,589
<font color="#E5E5E5">order to do actions on behalf of that</font>

235
00:08:56,190 --> 00:09:02,200
so we can also look for<font color="#E5E5E5"> what I call</font>

236
00:08:59,590 --> 00:09:04,360
hidden admin and<font color="#E5E5E5"> AD rights by looking at</font>

237
00:09:02,200 --> 00:09:06,390
group policies<font color="#CCCCCC"> root policies are a</font>

238
00:09:04,360 --> 00:09:08,590
<font color="#CCCCCC">goldmine in most organizations</font>

239
00:09:06,390 --> 00:09:10,180
<font color="#E5E5E5">especially when we're looking at the</font>

240
00:09:08,590 --> 00:09:12,280
default<font color="#CCCCCC"> domain controllers policy</font>

241
00:09:10,180 --> 00:09:13,660
<font color="#E5E5E5">because this is the group policy</font><font color="#CCCCCC"> that is</font>

242
00:09:12,280 --> 00:09:15,970
created by default<font color="#E5E5E5"> and</font><font color="#CCCCCC"> linked to the</font>

243
00:09:13,660 --> 00:09:18,310
domain<font color="#CCCCCC"> controller show</font><font color="#E5E5E5"> you and it's</font>

244
00:09:15,970 --> 00:09:20,050
almost<font color="#CCCCCC"> never</font><font color="#E5E5E5"> changed there are some</font>

245
00:09:18,310 --> 00:09:22,930
software packages that<font color="#E5E5E5"> want to update</font>

246
00:09:20,050 --> 00:09:25,030
<font color="#E5E5E5">this and I've heard</font><font color="#CCCCCC"> that they have but</font>

247
00:09:22,930 --> 00:09:26,500
no one<font color="#E5E5E5"> goes back and checks these we</font>

248
00:09:25,030 --> 00:09:28,000
<font color="#E5E5E5">don't use the default</font><font color="#CCCCCC"> domain controllers</font>

249
00:09:26,500 --> 00:09:30,220
policy we have another<font color="#E5E5E5"> policy that we</font>

250
00:09:28,000 --> 00:09:31,990
use<font color="#E5E5E5"> well I found a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> interesting</font>

251
00:09:30,220 --> 00:09:33,550
things<font color="#E5E5E5"> in this in this default domain</font>

252
00:09:31,990 --> 00:09:35,530
controllers policy especially<font color="#CCCCCC"> in the</font>

253
00:09:33,550 --> 00:09:37,660
user rights assignment<font color="#E5E5E5"> because they are</font>

254
00:09:35,530 --> 00:09:39,280
rarely checked<font color="#E5E5E5"> why are they rarely</font><font color="#CCCCCC"> check</font>

255
00:09:37,660 --> 00:09:41,860
<font color="#CCCCCC">because it looks like</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> and that's</font><font color="#E5E5E5"> a</font>

256
00:09:39,280 --> 00:09:44,350
lot to look through<font color="#CCCCCC"> so let's</font><font color="#E5E5E5"> hit a</font>

257
00:09:41,860 --> 00:09:46,780
couple<font color="#CCCCCC"> of</font><font color="#E5E5E5"> these allow log on locally</font>

258
00:09:44,350 --> 00:09:48,550
<font color="#CCCCCC">this is log on locally rights to the</font>

259
00:09:46,780 --> 00:09:50,170
domain controllers<font color="#E5E5E5"> and we have domain</font>

260
00:09:48,550 --> 00:09:52,510
users that has been configured with<font color="#E5E5E5"> this</font>

261
00:09:50,170 --> 00:09:54,430
right why would<font color="#CCCCCC"> a domain</font><font color="#E5E5E5"> user ever need</font>

262
00:09:52,510 --> 00:09:57,370
to log on<font color="#CCCCCC"> to a domain</font><font color="#E5E5E5"> controller</font><font color="#CCCCCC"> I don't</font>

263
00:09:54,430 --> 00:09:59,439
know<font color="#E5E5E5"> in the past two years I found this</font>

264
00:09:57,370 --> 00:10:01,510
about<font color="#CCCCCC"> I don't know ten fifteen percent</font>

265
00:09:59,440 --> 00:10:03,310
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the time and one of the customers</font>

266
00:10:01,510 --> 00:10:05,230
<font color="#CCCCCC">that</font><font color="#E5E5E5"> I talked to about this said no</font>

267
00:10:03,310 --> 00:10:09,479
that's<font color="#CCCCCC"> not the case</font><font color="#E5E5E5"> and ran out</font><font color="#CCCCCC"> the door</font>

268
00:10:05,230 --> 00:10:13,080
so we're all sitting there<font color="#CCCCCC"> waiting and</font>

269
00:10:09,480 --> 00:10:15,550
<font color="#CCCCCC">this person came back in and</font><font color="#E5E5E5"> was like</font>

270
00:10:13,080 --> 00:10:17,050
because sure<font color="#CCCCCC"> enough he</font><font color="#E5E5E5"> was able</font><font color="#CCCCCC"> to log</font>

271
00:10:15,550 --> 00:10:19,000
on as a<font color="#E5E5E5"> domain user to his domain</font>

272
00:10:17,050 --> 00:10:20,410
controller<font color="#E5E5E5"> and</font><font color="#CCCCCC"> his domain controller was</font>

273
00:10:19,000 --> 00:10:21,460
<font color="#E5E5E5">obviously in a place where he gets</font><font color="#CCCCCC"> to</font>

274
00:10:20,410 --> 00:10:25,750
pretty quickly<font color="#E5E5E5"> because we weren't</font>

275
00:10:21,460 --> 00:10:27,940
<font color="#CCCCCC">waiting that long so the question about</font>

276
00:10:25,750 --> 00:10:29,710
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is why would a domain user</font><font color="#E5E5E5"> ever</font>

277
00:10:27,940 --> 00:10:31,570
need to log<font color="#CCCCCC"> onto</font><font color="#E5E5E5"> itamae controller no</font>

278
00:10:29,710 --> 00:10:33,850
there's no good<font color="#CCCCCC"> reason but</font><font color="#E5E5E5"> it got</font>

279
00:10:31,570 --> 00:10:35,800
configured at some point<font color="#CCCCCC"> along</font><font color="#E5E5E5"> the way</font>

280
00:10:33,850 --> 00:10:36,960
<font color="#E5E5E5">and was forgotten about was never seen</font>

281
00:10:35,800 --> 00:10:39,099
again

282
00:10:36,960 --> 00:10:41,350
<font color="#CCCCCC">okay this means</font><font color="#E5E5E5"> that they have</font><font color="#CCCCCC"> to get</font>

283
00:10:39,100 --> 00:10:43,690
<font color="#CCCCCC">onto the console itself</font><font color="#E5E5E5"> so at least</font>

284
00:10:41,350 --> 00:10:46,960
there's<font color="#CCCCCC"> that right</font><font color="#E5E5E5"> well what if we can</font>

285
00:10:43,690 --> 00:10:49,900
gain remote local access we have<font color="#E5E5E5"> virtual</font>

286
00:10:46,960 --> 00:10:52,780
DC's right<font color="#CCCCCC"> post or virtual so we can use</font>

287
00:10:49,900 --> 00:10:55,569
a VMware console or remote virtual

288
00:10:52,780 --> 00:10:57,880
console or if it's physical<font color="#E5E5E5"> we can use</font>

289
00:10:55,570 --> 00:11:00,880
<font color="#CCCCCC">something called</font><font color="#E5E5E5"> eye level at least</font><font color="#CCCCCC"> on</font>

290
00:10:57,880 --> 00:11:02,320
HP servers this<font color="#E5E5E5"> out-of-band access to</font>

291
00:11:00,880 --> 00:11:06,100
our servers which should be on a

292
00:11:02,320 --> 00:11:08,770
separate<font color="#E5E5E5"> network segment switch network</font>

293
00:11:06,100 --> 00:11:13,030
entirely<font color="#E5E5E5"> it's not</font><font color="#CCCCCC"> always the case</font>

294
00:11:08,770 --> 00:11:15,160
and a couple<font color="#E5E5E5"> years ago the</font><font color="#CCCCCC"> airbus</font>

295
00:11:13,030 --> 00:11:17,020
security team<font color="#E5E5E5"> started digging into what</font>

296
00:11:15,160 --> 00:11:19,660
<font color="#CCCCCC">i lo actually is and discovered a</font>

297
00:11:17,020 --> 00:11:21,069
vulnerability<font color="#E5E5E5"> which got patched of</font>

298
00:11:19,660 --> 00:11:22,900
course the<font color="#E5E5E5"> problem</font><font color="#CCCCCC"> with this is who</font>

299
00:11:21,070 --> 00:11:25,360
<font color="#CCCCCC">actually patches</font><font color="#E5E5E5"> the firmware on their</font>

300
00:11:22,900 --> 00:11:26,800
servers once they've deployed them why

301
00:11:25,360 --> 00:11:28,660
don't we patch them because the server

302
00:11:26,800 --> 00:11:30,550
is<font color="#CCCCCC"> working just</font><font color="#E5E5E5"> fine</font><font color="#CCCCCC"> we don't</font><font color="#E5E5E5"> want to</font>

303
00:11:28,660 --> 00:11:32,740
mess<font color="#CCCCCC"> with the firmware</font><font color="#E5E5E5"> unless the vendor</font>

304
00:11:30,550 --> 00:11:34,660
says you have to who even notices that

305
00:11:32,740 --> 00:11:37,750
there's a critical<font color="#E5E5E5"> vulnerability in the</font>

306
00:11:34,660 --> 00:11:39,760
<font color="#CCCCCC">out-of-band</font><font color="#E5E5E5"> access management process or</font>

307
00:11:37,750 --> 00:11:43,210
component of the server and thinks about

308
00:11:39,760 --> 00:11:44,920
<font color="#E5E5E5">updating that and this attack on this</font>

309
00:11:43,210 --> 00:11:46,990
was was pretty simple<font color="#CCCCCC"> you just</font><font color="#E5E5E5"> send it a</font>

310
00:11:44,920 --> 00:11:48,250
<font color="#E5E5E5">bunch of a's and it would overflow it</font>

311
00:11:46,990 --> 00:11:50,620
and then you'd<font color="#CCCCCC"> have access to</font><font color="#E5E5E5"> isla</font>

312
00:11:48,250 --> 00:11:51,970
without any<font color="#E5E5E5"> kind of authentication so</font>

313
00:11:50,620 --> 00:11:56,530
<font color="#CCCCCC">ultimately this vulnerability</font><font color="#E5E5E5"> was</font>

314
00:11:51,970 --> 00:11:59,860
brought to you by the letter A<font color="#CCCCCC"> but it</font>

315
00:11:56,530 --> 00:12:03,250
doesn't stop there<font color="#E5E5E5"> they dug into</font><font color="#CCCCCC"> ILO</font>

316
00:11:59,860 --> 00:12:06,340
even more and HP released<font color="#E5E5E5"> the patch just</font>

317
00:12:03,250 --> 00:12:08,290
last summer<font color="#E5E5E5"> with more issues that were</font>

318
00:12:06,340 --> 00:12:11,350
highlighted<font color="#E5E5E5"> and identified</font><font color="#CCCCCC"> by the same</font>

319
00:12:08,290 --> 00:12:13,089
<font color="#CCCCCC">airbus security folks talking about</font><font color="#E5E5E5"> all</font>

320
00:12:11,350 --> 00:12:14,710
<font color="#E5E5E5">of this their github is at the bottom</font>

321
00:12:13,090 --> 00:12:17,290
these slides will<font color="#CCCCCC"> be on 80 security</font><font color="#E5E5E5"> or</font>

322
00:12:14,710 --> 00:12:19,330
later<font color="#E5E5E5"> definitely read through this if</font>

323
00:12:17,290 --> 00:12:21,520
you have physical HP servers or if you

324
00:12:19,330 --> 00:12:24,910
<font color="#CCCCCC">pentester red team against environments</font>

325
00:12:21,520 --> 00:12:27,490
with servers because this is a big issue

326
00:12:24,910 --> 00:12:29,410
<font color="#CCCCCC">and so they went through</font><font color="#E5E5E5"> and published a</font>

327
00:12:27,490 --> 00:12:32,470
number<font color="#CCCCCC"> of different vulnerabilities or</font>

328
00:12:29,410 --> 00:12:34,930
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> to HP to get these patched</font><font color="#E5E5E5"> ranging</font>

329
00:12:32,470 --> 00:12:38,230
from just<font color="#CCCCCC"> authentication bypassed or a</font>

330
00:12:34,930 --> 00:12:41,260
motor local code execution to actually

331
00:12:38,230 --> 00:12:42,910
pulling<font color="#E5E5E5"> data directly from memory which</font>

332
00:12:41,260 --> 00:12:44,740
is<font color="#E5E5E5"> kind of a problem</font><font color="#CCCCCC"> especially when</font>

333
00:12:42,910 --> 00:12:46,890
you're<font color="#CCCCCC"> talking</font><font color="#E5E5E5"> about</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> physical demand</font>

334
00:12:44,740 --> 00:12:49,180
controller so I went<font color="#CCCCCC"> through and</font>

335
00:12:46,890 --> 00:12:51,370
summarized<font color="#E5E5E5"> all the things that</font><font color="#CCCCCC"> the</font>

336
00:12:49,180 --> 00:12:54,250
<font color="#CCCCCC">airbus security team identified</font><font color="#E5E5E5"> and i lo</font>

337
00:12:51,370 --> 00:12:55,960
from compromising the host<font color="#E5E5E5"> server</font>

338
00:12:54,250 --> 00:12:58,600
operating system through DMA<font color="#E5E5E5"> I</font>

339
00:12:55,960 --> 00:13:00,250
discovered<font color="#CCCCCC"> RCE to exploit</font><font color="#E5E5E5"> an ILO for</font><font color="#CCCCCC"> a</font>

340
00:12:58,600 --> 00:13:02,200
feature which allows read/write access

341
00:13:00,250 --> 00:13:04,630
to the<font color="#CCCCCC"> host memory and then inject a</font>

342
00:13:02,200 --> 00:13:06,490
payload<font color="#CCCCCC"> into it a</font><font color="#E5E5E5"> vulnerability and the</font>

343
00:13:04,630 --> 00:13:09,400
<font color="#E5E5E5">web server</font><font color="#CCCCCC"> to flash a backdoor</font><font color="#E5E5E5"> firmware</font>

344
00:13:06,490 --> 00:13:10,750
use of DMA communication channel execute

345
00:13:09,400 --> 00:13:12,370
arbitrary commands on the<font color="#E5E5E5"> host</font><font color="#CCCCCC"> system</font>

346
00:13:10,750 --> 00:13:14,110
and this<font color="#E5E5E5"> is my favorite one</font>

347
00:13:12,370 --> 00:13:17,920
I<font color="#E5E5E5"> love four or five chips channel</font>

348
00:13:14,110 --> 00:13:21,080
interface<font color="#CCCCCC"> they could make this work even</font>

349
00:13:17,920 --> 00:13:23,779
though I<font color="#E5E5E5"> Louis</font><font color="#CCCCCC"> set is disabled</font>

350
00:13:21,080 --> 00:13:26,269
and then there was supposed to<font color="#E5E5E5"> be an</font>

351
00:13:23,779 --> 00:13:28,910
integrity which they discovered a logic

352
00:13:26,269 --> 00:13:30,680
<font color="#E5E5E5">error last year in which was supposed to</font>

353
00:13:28,910 --> 00:13:33,589
<font color="#E5E5E5">solve a lot</font><font color="#CCCCCC"> of the issues which of</font>

354
00:13:30,680 --> 00:13:35,420
course didn't<font color="#E5E5E5"> and then the</font><font color="#CCCCCC"> Airbus folks</font>

355
00:13:33,589 --> 00:13:37,010
have provided a ghost scanner to

356
00:13:35,420 --> 00:13:39,079
discover vulnerable servers running<font color="#CCCCCC"> I'll</font>

357
00:13:37,010 --> 00:13:41,720
<font color="#CCCCCC">oh</font><font color="#E5E5E5"> so what's the takeaway from this</font>

358
00:13:39,079 --> 00:13:43,969
<font color="#E5E5E5">patch your firmware under HP servers and</font>

359
00:13:41,720 --> 00:13:46,250
others especially<font color="#CCCCCC"> if using I lower</font>

360
00:13:43,970 --> 00:13:48,500
features or even if you're<font color="#CCCCCC"> not maybe</font>

361
00:13:46,250 --> 00:13:51,890
take a look at it see what<font color="#E5E5E5"> that exposure</font>

362
00:13:48,500 --> 00:13:55,850
<font color="#E5E5E5">is because again if you have configured</font>

363
00:13:51,890 --> 00:13:57,410
local access to users or server admins

364
00:13:55,850 --> 00:13:59,390
thinking that they will<font color="#CCCCCC"> only ever log on</font>

365
00:13:57,410 --> 00:14:02,569
to<font color="#E5E5E5"> your server console there may be</font>

366
00:13:59,390 --> 00:14:06,079
other<font color="#E5E5E5"> ways around what you think</font><font color="#CCCCCC"> are</font>

367
00:14:02,570 --> 00:14:07,640
core security<font color="#E5E5E5"> controls and then of</font>

368
00:14:06,079 --> 00:14:09,800
course<font color="#E5E5E5"> maybe you just added server tier</font>

369
00:14:07,640 --> 00:14:11,569
<font color="#E5E5E5">3</font><font color="#CCCCCC"> to they have the ability to log on</font>

370
00:14:09,800 --> 00:14:13,099
locally<font color="#E5E5E5"> and log on</font><font color="#CCCCCC"> through to more</font>

371
00:14:11,570 --> 00:14:14,800
<font color="#CCCCCC">terminal</font><font color="#E5E5E5"> services which means that they</font>

372
00:14:13,100 --> 00:14:17,630
<font color="#CCCCCC">can just log onto</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> DCs anyway</font>

373
00:14:14,800 --> 00:14:19,880
<font color="#E5E5E5">because</font><font color="#CCCCCC"> that might not be what you want</font>

374
00:14:17,630 --> 00:14:21,769
to<font color="#E5E5E5"> have actually configured and</font><font color="#CCCCCC"> who's in</font>

375
00:14:19,880 --> 00:14:24,410
server tier 3 well we have<font color="#CCCCCC"> Eddy in tier</font>

376
00:14:21,769 --> 00:14:26,899
3<font color="#CCCCCC"> why is Eddy in tier 3 no one really</font>

377
00:14:24,410 --> 00:14:28,640
knows why<font color="#E5E5E5"> Eddy's in server tier 3 he had</font>

378
00:14:26,899 --> 00:14:30,770
to manage<font color="#E5E5E5"> a server one time so it seemed</font>

379
00:14:28,640 --> 00:14:32,600
like<font color="#CCCCCC"> a</font><font color="#E5E5E5"> good</font><font color="#CCCCCC"> idea</font><font color="#E5E5E5"> and then people didn't</font>

380
00:14:30,770 --> 00:14:33,800
realize<font color="#E5E5E5"> that server tier 3 had the</font>

381
00:14:32,600 --> 00:14:36,320
<font color="#CCCCCC">ability to log on</font><font color="#E5E5E5"> to the main</font>

382
00:14:33,800 --> 00:14:37,969
controllers so Eddy a regular user can

383
00:14:36,320 --> 00:14:42,140
now log on to our<font color="#CCCCCC"> domain controller</font><font color="#E5E5E5"> and</font>

384
00:14:37,970 --> 00:14:43,940
that's bad then there's another

385
00:14:42,140 --> 00:14:45,439
interesting<font color="#E5E5E5"> user rights assignment</font>

386
00:14:43,940 --> 00:14:47,209
called<font color="#E5E5E5"> manage auditing and security log</font>

387
00:14:45,440 --> 00:14:48,920
you might be familiar<font color="#CCCCCC"> with this because</font>

388
00:14:47,209 --> 00:14:51,770
exchange needs<font color="#E5E5E5"> this right for some</font>

389
00:14:48,920 --> 00:14:53,689
reason<font color="#CCCCCC"> but</font><font color="#E5E5E5"> Microsoft notes that anyone</font>

390
00:14:51,770 --> 00:14:56,480
with this<font color="#CCCCCC"> ability</font><font color="#E5E5E5"> has the right to clear</font>

391
00:14:53,690 --> 00:14:58,970
the security log in a few environments

392
00:14:56,480 --> 00:15:00,860
I've seen this configured where a large

393
00:14:58,970 --> 00:15:03,560
number<font color="#CCCCCC"> of users had the ability to clear</font>

394
00:15:00,860 --> 00:15:06,709
security<font color="#E5E5E5"> logs on workstations seems like</font>

395
00:15:03,560 --> 00:15:09,680
a problem<font color="#E5E5E5"> or on domain controllers which</font>

396
00:15:06,709 --> 00:15:11,029
seems like a really<font color="#E5E5E5"> big problem so</font>

397
00:15:09,680 --> 00:15:12,140
another way that we can secure

398
00:15:11,029 --> 00:15:14,149
administration which has been around

399
00:15:12,140 --> 00:15:16,790
<font color="#CCCCCC">since Active Directory has been released</font>

400
00:15:14,149 --> 00:15:19,160
<font color="#E5E5E5">is by configuring</font><font color="#CCCCCC"> our logon workstations</font>

401
00:15:16,790 --> 00:15:21,230
or our logon hours these are explicit

402
00:15:19,160 --> 00:15:22,910
whitelist configuration of<font color="#E5E5E5"> these are the</font>

403
00:15:21,230 --> 00:15:25,220
<font color="#E5E5E5">workstations or computers that this</font>

404
00:15:22,910 --> 00:15:27,290
account<font color="#E5E5E5"> is allowed to</font><font color="#CCCCCC"> log onto these are</font>

405
00:15:25,220 --> 00:15:29,779
the logon hours the schedule in<font color="#CCCCCC"> which</font>

406
00:15:27,290 --> 00:15:31,610
this account is allowed to<font color="#CCCCCC"> logon</font><font color="#E5E5E5"> no one</font>

407
00:15:29,779 --> 00:15:33,230
really ever does this why because<font color="#CCCCCC"> that</font>

408
00:15:31,610 --> 00:15:34,430
means<font color="#E5E5E5"> we have to identify all of the</font>

409
00:15:33,230 --> 00:15:36,170
systems where the

410
00:15:34,430 --> 00:15:38,270
times that<font color="#E5E5E5"> an admin is actually going to</font>

411
00:15:36,170 --> 00:15:41,689
performing<font color="#E5E5E5"> perform administration or</font>

412
00:15:38,270 --> 00:15:43,939
need to log<font color="#E5E5E5"> on</font><font color="#CCCCCC"> most</font><font color="#E5E5E5"> often I've seen</font>

413
00:15:41,690 --> 00:15:45,350
<font color="#CCCCCC">these configured with honey tokens or</font>

414
00:15:43,940 --> 00:15:46,760
accounts that really aren't supposed<font color="#E5E5E5"> to</font>

415
00:15:45,350 --> 00:15:48,890
do anything but are added to privileged

416
00:15:46,760 --> 00:15:52,160
groups so attackers are looking for this

417
00:15:48,890 --> 00:15:54,980
as well<font color="#E5E5E5"> all right so we know that</font>

418
00:15:52,160 --> 00:15:56,390
<font color="#CCCCCC">username plus password connecting to a</font>

419
00:15:54,980 --> 00:15:58,520
server<font color="#E5E5E5"> is probably not the best thing</font>

420
00:15:56,390 --> 00:16:00,949
<font color="#CCCCCC">that</font><font color="#E5E5E5"> way to do it for RDP so we'll just</font>

421
00:15:58,520 --> 00:16:02,319
<font color="#CCCCCC">mfa the RDP</font><font color="#E5E5E5"> and then that way it's</font><font color="#CCCCCC"> mf8</font>

422
00:16:00,950 --> 00:16:04,100
<font color="#E5E5E5">so we're good</font>

423
00:16:02,320 --> 00:16:05,660
<font color="#CCCCCC">Clinic Asian we're</font><font color="#E5E5E5"> gonna do the same</font>

424
00:16:04,100 --> 00:16:08,090
exact<font color="#CCCCCC"> thing</font><font color="#E5E5E5"> and this time we have our</font>

425
00:16:05,660 --> 00:16:10,579
<font color="#E5E5E5">nice</font><font color="#CCCCCC"> little MFA system here and we're</font>

426
00:16:08,090 --> 00:16:12,590
going<font color="#CCCCCC"> to connect to our RDP server and</font>

427
00:16:10,580 --> 00:16:15,590
then all of a sudden<font color="#E5E5E5"> we have two</font>

428
00:16:12,590 --> 00:16:18,110
back-to-back<font color="#E5E5E5"> MFA requests I've already</font>

429
00:16:15,590 --> 00:16:21,560
hit<font color="#CCCCCC"> accept two the first</font><font color="#E5E5E5"> one what is the</font>

430
00:16:18,110 --> 00:16:23,150
second<font color="#CCCCCC"> one</font><font color="#E5E5E5"> from or maybe I'm connecting</font>

431
00:16:21,560 --> 00:16:25,819
in through<font color="#E5E5E5"> a</font><font color="#CCCCCC"> TFS through my Federation</font>

432
00:16:23,150 --> 00:16:26,990
<font color="#CCCCCC">system and I get the same thing</font><font color="#E5E5E5"> and I</font>

433
00:16:25,820 --> 00:16:29,930
don't<font color="#E5E5E5"> really realize that I'm just</font>

434
00:16:26,990 --> 00:16:31,970
<font color="#E5E5E5">tapping because yes I'm tired</font><font color="#CCCCCC"> I haven't</font>

435
00:16:29,930 --> 00:16:34,520
had my coffee<font color="#CCCCCC"> yet it's 8 a.m. I need to</font>

436
00:16:31,970 --> 00:16:37,580
get onto the system<font color="#E5E5E5"> or how about if I</font>

437
00:16:34,520 --> 00:16:40,010
<font color="#CCCCCC">haven't even unlocked my phone yet and I</font>

438
00:16:37,580 --> 00:16:42,770
just<font color="#CCCCCC"> get</font><font color="#E5E5E5"> a prompt like this but it</font>

439
00:16:40,010 --> 00:16:44,720
happens a few times<font color="#E5E5E5"> is this a hiccup is</font>

440
00:16:42,770 --> 00:16:47,150
this someone monitoring and and trying

441
00:16:44,720 --> 00:16:50,390
to get an MFA collision with me at the

442
00:16:47,150 --> 00:16:54,770
exact same time would<font color="#E5E5E5"> this get report it</font>

443
00:16:50,390 --> 00:16:56,360
if someone<font color="#E5E5E5"> saw this maybe</font><font color="#CCCCCC"> okay let's</font>

444
00:16:54,770 --> 00:16:59,329
talk<font color="#CCCCCC"> about ways that we could subvert</font>

445
00:16:56,360 --> 00:17:01,190
the MVA MFA process<font color="#CCCCCC"> and I found this</font>

446
00:16:59,330 --> 00:17:05,360
<font color="#CCCCCC">configuration at a customer site and I</font>

447
00:17:01,190 --> 00:17:09,190
thought this was unique<font color="#E5E5E5"> unfortunately</font>

448
00:17:05,359 --> 00:17:11,780
not so let's say that<font color="#E5E5E5"> Acme company</font>

449
00:17:09,190 --> 00:17:13,040
<font color="#E5E5E5">genericized has enabled the users to</font>

450
00:17:11,780 --> 00:17:14,359
<font color="#CCCCCC">update several attributes</font><font color="#E5E5E5"> through a</font>

451
00:17:13,040 --> 00:17:16,879
self-service portal<font color="#E5E5E5"> this is pretty</font>

452
00:17:14,359 --> 00:17:18,919
common<font color="#E5E5E5"> where users can update their</font>

453
00:17:16,880 --> 00:17:20,390
address<font color="#CCCCCC"> their work address or mobile</font>

454
00:17:18,920 --> 00:17:22,010
<font color="#E5E5E5">number</font><font color="#CCCCCC"> and some other specific</font>

455
00:17:20,390 --> 00:17:24,620
attributes that<font color="#CCCCCC"> are important for them</font>

456
00:17:22,010 --> 00:17:25,970
<font color="#E5E5E5">that they know let's say they got a new</font>

457
00:17:24,619 --> 00:17:28,280
<font color="#E5E5E5">phone they need to change your number</font>

458
00:17:25,970 --> 00:17:29,810
<font color="#E5E5E5">for whatever reason so they go in and</font>

459
00:17:28,280 --> 00:17:31,850
<font color="#E5E5E5">they see their mobile phone</font><font color="#CCCCCC"> number</font><font color="#E5E5E5"> is is</font>

460
00:17:29,810 --> 00:17:32,960
there so they change it and<font color="#E5E5E5"> this is all</font>

461
00:17:31,850 --> 00:17:34,550
handled<font color="#CCCCCC"> through Active Directory</font>

462
00:17:32,960 --> 00:17:36,320
integrated authentication<font color="#CCCCCC"> so they just</font>

463
00:17:34,550 --> 00:17:37,659
<font color="#E5E5E5">hit the portal site and it auto</font>

464
00:17:36,320 --> 00:17:42,050
<font color="#E5E5E5">syndication happens in the background</font>

465
00:17:37,660 --> 00:17:43,850
<font color="#E5E5E5">automatically for them well the thing</font>

466
00:17:42,050 --> 00:17:46,820
I've noticed is<font color="#CCCCCC"> a lot of organizations</font>

467
00:17:43,850 --> 00:17:48,360
use their user configured attribute

468
00:17:46,820 --> 00:17:52,139
which<font color="#CCCCCC"> is their cell phone number</font>

469
00:17:48,360 --> 00:17:54,179
admins MFA configuration so what this

470
00:17:52,140 --> 00:17:56,280
<font color="#CCCCCC">means is that if an attacker is on this</font>

471
00:17:54,180 --> 00:17:59,460
<font color="#E5E5E5">system</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> connects to this portal</font>

472
00:17:56,280 --> 00:18:01,139
through a hidden browser window<font color="#E5E5E5"> they can</font>

473
00:17:59,460 --> 00:18:03,410
update this mobile phone number<font color="#E5E5E5"> without</font>

474
00:18:01,140 --> 00:18:05,880
anyone noticing<font color="#CCCCCC"> and once they do that</font>

475
00:18:03,410 --> 00:18:07,890
then<font color="#CCCCCC"> they have a way to backdoor MFA</font>

476
00:18:05,880 --> 00:18:11,400
because every MFA system that I've seen

477
00:18:07,890 --> 00:18:13,710
has the enter passcode configuration but

478
00:18:11,400 --> 00:18:16,860
even better<font color="#CCCCCC"> it's text me a code which</font>

479
00:18:13,710 --> 00:18:19,800
uses this cell phone SMS or<font color="#CCCCCC"> text message</font>

480
00:18:16,860 --> 00:18:23,820
as a<font color="#E5E5E5"> backup</font><font color="#CCCCCC"> to your standard MFA push</font><font color="#E5E5E5"> or</font>

481
00:18:19,800 --> 00:18:25,409
the code that<font color="#E5E5E5"> gets presented so I was</font>

482
00:18:23,820 --> 00:18:27,360
able<font color="#E5E5E5"> to do this pretty easily and no one</font>

483
00:18:25,410 --> 00:18:28,680
noticed<font color="#CCCCCC"> I used a phone a cell phone that</font>

484
00:18:27,360 --> 00:18:31,020
<font color="#CCCCCC">was mine instead</font><font color="#E5E5E5"> of one owned by the</font>

485
00:18:28,680 --> 00:18:32,670
organization and when<font color="#CCCCCC"> I</font><font color="#E5E5E5"> went</font><font color="#CCCCCC"> through</font>

486
00:18:31,020 --> 00:18:35,550
this process<font color="#CCCCCC"> and leveraged that</font><font color="#E5E5E5"> as an</font>

487
00:18:32,670 --> 00:18:39,150
MFA<font color="#CCCCCC"> there was no notification to the</font>

488
00:18:35,550 --> 00:18:40,590
<font color="#CCCCCC">user</font><font color="#E5E5E5"> and nobody noticed and it's like I</font>

489
00:18:39,150 --> 00:18:43,100
said<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> not just</font><font color="#CCCCCC"> due oh</font><font color="#E5E5E5"> it's others</font>

490
00:18:40,590 --> 00:18:45,330
that have this MFA process as well<font color="#E5E5E5"> so</font>

491
00:18:43,100 --> 00:18:46,800
<font color="#CCCCCC">ultimately all</font><font color="#E5E5E5"> the attacker needs to do</font>

492
00:18:45,330 --> 00:18:49,409
is drop on in that<font color="#E5E5E5"> system where the user</font>

493
00:18:46,800 --> 00:18:51,540
<font color="#CCCCCC">is update that web portal that has</font><font color="#E5E5E5"> their</font>

494
00:18:49,410 --> 00:18:53,760
mobile number change it to their own

495
00:18:51,540 --> 00:18:56,610
<font color="#E5E5E5">controlled mobile number whatever</font><font color="#CCCCCC"> that</font>

496
00:18:53,760 --> 00:18:58,379
<font color="#E5E5E5">is and</font><font color="#CCCCCC"> then subvert the MFA system by</font>

497
00:18:56,610 --> 00:18:59,909
using<font color="#CCCCCC"> a text message</font><font color="#E5E5E5"> which you can turn</font>

498
00:18:58,380 --> 00:19:02,070
off which I do recommend<font color="#CCCCCC"> you</font><font color="#E5E5E5"> turn that</font>

499
00:18:59,910 --> 00:19:04,410
off<font color="#E5E5E5"> but there is another</font><font color="#CCCCCC"> interesting</font>

500
00:19:02,070 --> 00:19:08,580
<font color="#E5E5E5">thing</font><font color="#CCCCCC"> about specifically how duo MFA</font>

501
00:19:04,410 --> 00:19:10,290
works there's this first install option

502
00:19:08,580 --> 00:19:12,540
here bypass<font color="#CCCCCC"> to authentication went</font>

503
00:19:10,290 --> 00:19:15,600
offline which is fail open<font color="#E5E5E5"> by default</font>

504
00:19:12,540 --> 00:19:18,600
<font color="#CCCCCC">it's failed closed so that means that if</font>

505
00:19:15,600 --> 00:19:21,719
it can't connect<font color="#CCCCCC"> to its duo system</font>

506
00:19:18,600 --> 00:19:26,070
through this DNS lookup it won't let<font color="#CCCCCC"> you</font>

507
00:19:21,720 --> 00:19:27,600
<font color="#E5E5E5">authenticate to</font><font color="#CCCCCC"> the system so you could</font>

508
00:19:26,070 --> 00:19:29,639
do a<font color="#E5E5E5"> diol service but the other way to</font>

509
00:19:27,600 --> 00:19:31,949
do<font color="#CCCCCC"> it is if you had access</font><font color="#E5E5E5"> to the system</font>

510
00:19:29,640 --> 00:19:34,650
at some<font color="#E5E5E5"> point you flip this switch so it</font>

511
00:19:31,950 --> 00:19:36,780
fails open and then what happens is<font color="#CCCCCC"> you</font>

512
00:19:34,650 --> 00:19:38,370
just<font color="#CCCCCC"> deny that system for being able to</font>

513
00:19:36,780 --> 00:19:41,700
<font color="#E5E5E5">ever connect to that do a security</font>

514
00:19:38,370 --> 00:19:43,260
address and thanks to<font color="#CCCCCC"> noopy</font><font color="#E5E5E5"> I learned</font>

515
00:19:41,700 --> 00:19:45,930
about<font color="#E5E5E5"> this</font><font color="#CCCCCC"> and also Jared for the Hat</font>

516
00:19:43,260 --> 00:19:48,930
tip this<font color="#CCCCCC"> is pretty interesting</font>

517
00:19:45,930 --> 00:19:50,310
<font color="#CCCCCC">because</font><font color="#E5E5E5"> again when we</font><font color="#CCCCCC"> think about MFA we</font>

518
00:19:48,930 --> 00:19:52,950
often<font color="#E5E5E5"> think that this is a thing</font><font color="#CCCCCC"> that</font>

519
00:19:50,310 --> 00:19:54,570
<font color="#E5E5E5">protects our accounts but we need to</font>

520
00:19:52,950 --> 00:19:57,180
<font color="#E5E5E5">think about the second and third level</font>

521
00:19:54,570 --> 00:19:59,760
effects of this<font color="#E5E5E5"> if we rely on this</font>

522
00:19:57,180 --> 00:20:01,290
security control to protect<font color="#E5E5E5"> us we have</font>

523
00:19:59,760 --> 00:20:02,010
to<font color="#E5E5E5"> ensure that we understand the</font>

524
00:20:01,290 --> 00:20:04,560
limitations of

525
00:20:02,010 --> 00:20:07,440
security<font color="#E5E5E5"> control</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of organizations</font>

526
00:20:04,560 --> 00:20:09,090
have deployed duo<font color="#E5E5E5"> which is good but</font>

527
00:20:07,440 --> 00:20:11,640
<font color="#E5E5E5">again what are the additional things</font>

528
00:20:09,090 --> 00:20:13,860
that<font color="#E5E5E5"> that could happen then there's</font>

529
00:20:11,640 --> 00:20:15,150
another<font color="#E5E5E5"> option right here</font><font color="#CCCCCC"> which</font><font color="#E5E5E5"> is only</font>

530
00:20:13,860 --> 00:20:18,929
<font color="#E5E5E5">prompt for do authentication when</font>

531
00:20:15,150 --> 00:20:20,490
logging in via RDP so if we check this

532
00:20:18,930 --> 00:20:22,080
this<font color="#E5E5E5"> means local accounts can</font>

533
00:20:20,490 --> 00:20:25,440
authenticate without using a meth they

534
00:20:22,080 --> 00:20:29,460
as well so if<font color="#E5E5E5"> our duo configuration is</font>

535
00:20:25,440 --> 00:20:30,870
changed<font color="#E5E5E5"> who would know about it the</font>

536
00:20:29,460 --> 00:20:32,460
other<font color="#CCCCCC"> thing that's interesting</font><font color="#E5E5E5"> about MFA</font>

537
00:20:30,870 --> 00:20:34,409
is there's usually an onboarding process

538
00:20:32,460 --> 00:20:37,320
where someone goes in hits a<font color="#E5E5E5"> website or</font>

539
00:20:34,410 --> 00:20:39,060
a portal does the request and then goes

540
00:20:37,320 --> 00:20:41,310
through<font color="#CCCCCC"> the</font><font color="#E5E5E5"> process and a lot</font><font color="#CCCCCC"> of times</font>

541
00:20:39,060 --> 00:20:43,290
this is automated<font color="#E5E5E5"> which means that I get</font>

542
00:20:41,310 --> 00:20:46,800
<font color="#CCCCCC">an email I</font><font color="#E5E5E5"> just have to go ahead and</font>

543
00:20:43,290 --> 00:20:49,800
click<font color="#E5E5E5"> on this link okay well if an</font>

544
00:20:46,800 --> 00:20:52,020
attacker has<font color="#CCCCCC"> control of</font><font color="#E5E5E5"> my system they</font>

545
00:20:49,800 --> 00:20:53,850
have control of my<font color="#E5E5E5"> email which means</font>

546
00:20:52,020 --> 00:20:55,860
they can also get<font color="#E5E5E5"> this link</font><font color="#CCCCCC"> before I see</font>

547
00:20:53,850 --> 00:20:57,929
it which<font color="#E5E5E5"> means that they might be able</font>

548
00:20:55,860 --> 00:20:59,879
<font color="#CCCCCC">to</font><font color="#E5E5E5"> add another MFA token to my account</font>

549
00:20:57,930 --> 00:21:01,530
without<font color="#E5E5E5"> me knowing about it</font><font color="#CCCCCC"> so when we</font>

550
00:20:59,880 --> 00:21:02,940
talk about MFA onboarding you want to

551
00:21:01,530 --> 00:21:05,100
make sure<font color="#CCCCCC"> that there is at least one</font>

552
00:21:02,940 --> 00:21:07,230
<font color="#E5E5E5">part of the process where someone has to</font>

553
00:21:05,100 --> 00:21:09,480
do<font color="#CCCCCC"> something outside of an automated</font>

554
00:21:07,230 --> 00:21:10,920
process<font color="#E5E5E5"> or through a system where they</font>

555
00:21:09,480 --> 00:21:13,200
have<font color="#E5E5E5"> to show their badge and prove</font><font color="#CCCCCC"> that</font>

556
00:21:10,920 --> 00:21:16,140
they are the<font color="#CCCCCC"> person</font><font color="#E5E5E5"> I change phones</font>

557
00:21:13,200 --> 00:21:17,880
recently<font color="#E5E5E5"> one of my customers have MFA</font><font color="#CCCCCC"> I</font>

558
00:21:16,140 --> 00:21:20,310
sent them<font color="#E5E5E5"> a</font><font color="#CCCCCC"> message through their slack</font>

559
00:21:17,880 --> 00:21:22,530
system and guess what he did<font color="#CCCCCC"> he</font><font color="#E5E5E5"> said you</font>

560
00:21:20,310 --> 00:21:24,419
have<font color="#CCCCCC"> to call</font><font color="#E5E5E5"> me I needed to know that</font>

561
00:21:22,530 --> 00:21:26,910
<font color="#E5E5E5">you are who you say</font><font color="#CCCCCC"> you are to prove</font>

562
00:21:24,420 --> 00:21:30,270
that this<font color="#CCCCCC"> is this</font><font color="#E5E5E5"> is correcting and</font>

563
00:21:26,910 --> 00:21:33,330
updating the MFA<font color="#E5E5E5"> so yeah absolutely</font><font color="#CCCCCC"> use</font>

564
00:21:30,270 --> 00:21:36,210
MFA it's good to use<font color="#CCCCCC"> it's a an</font>

565
00:21:33,330 --> 00:21:39,120
<font color="#E5E5E5">additional protection and it does have</font>

566
00:21:36,210 --> 00:21:40,590
<font color="#CCCCCC">value we want</font><font color="#E5E5E5"> to MFA everything that we</font>

567
00:21:39,120 --> 00:21:42,270
can<font color="#E5E5E5"> especially when we're talking about</font>

568
00:21:40,590 --> 00:21:44,879
cloud accounts<font color="#E5E5E5"> this is not a cloud</font>

569
00:21:42,270 --> 00:21:46,650
specific talk<font color="#E5E5E5"> but certainly if you have</font>

570
00:21:44,880 --> 00:21:49,610
cloud administration accounts please

571
00:21:46,650 --> 00:21:52,410
<font color="#E5E5E5">make sure</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> MFA is enabled</font><font color="#CCCCCC"> for those</font>

572
00:21:49,610 --> 00:21:53,820
just<font color="#CCCCCC"> don't count</font><font color="#E5E5E5"> on MFA to be the Silver</font>

573
00:21:52,410 --> 00:21:56,250
<font color="#CCCCCC">Bullet for security because there are</font>

574
00:21:53,820 --> 00:21:58,860
<font color="#E5E5E5">limitations any system and what I see a</font>

575
00:21:56,250 --> 00:22:01,710
<font color="#E5E5E5">lot is a customer will say we</font><font color="#CCCCCC"> have this</font>

576
00:21:58,860 --> 00:22:05,429
<font color="#E5E5E5">security control and a lot of paper</font>

577
00:22:01,710 --> 00:22:07,290
<font color="#E5E5E5">audits go check so we want to go beyond</font>

578
00:22:05,430 --> 00:22:08,370
<font color="#E5E5E5">what that paper</font><font color="#CCCCCC"> audit</font><font color="#E5E5E5"> says and go okay</font>

579
00:22:07,290 --> 00:22:09,690
that's great<font color="#CCCCCC"> but what are the</font>

580
00:22:08,370 --> 00:22:11,489
limitations of<font color="#CCCCCC"> that what are the ways</font>

581
00:22:09,690 --> 00:22:12,660
around that<font color="#CCCCCC"> how do</font><font color="#E5E5E5"> we actually have that</font>

582
00:22:11,490 --> 00:22:14,910
configured what are what are<font color="#CCCCCC"> the</font>

583
00:22:12,660 --> 00:22:15,750
conditions and configurations of that so

584
00:22:14,910 --> 00:22:17,370
we<font color="#CCCCCC"> can understand</font>

585
00:22:15,750 --> 00:22:20,430
and what the potential<font color="#E5E5E5"> limitations are</font>

586
00:22:17,370 --> 00:22:22,169
of it<font color="#E5E5E5"> all right so there's also password</font>

587
00:22:20,430 --> 00:22:24,630
vaults<font color="#CCCCCC"> enterprise password vaults are</font>

588
00:22:22,170 --> 00:22:26,820
becoming a lot<font color="#CCCCCC"> more</font><font color="#E5E5E5"> popular cyber-ark is</font>

589
00:22:24,630 --> 00:22:28,620
<font color="#E5E5E5">certainly the the largest of the</font>

590
00:22:26,820 --> 00:22:30,210
companies<font color="#CCCCCC"> that have the enterprise</font>

591
00:22:28,620 --> 00:22:32,669
password vaults and have<font color="#E5E5E5"> expanded beyond</font>

592
00:22:30,210 --> 00:22:35,670
just<font color="#CCCCCC"> that niche they're being deployed</font>

593
00:22:32,670 --> 00:22:37,710
deployed<font color="#E5E5E5"> more broadly so that way</font>

594
00:22:35,670 --> 00:22:39,750
what was originally for primarily

595
00:22:37,710 --> 00:22:42,240
managing service<font color="#CCCCCC"> count passwords now are</font>

596
00:22:39,750 --> 00:22:47,790
managing<font color="#E5E5E5"> 80 admin and domain admin</font>

597
00:22:42,240 --> 00:22:49,410
credentials typically cyber-ark or

598
00:22:47,790 --> 00:22:51,210
<font color="#CCCCCC">psychotic</font><font color="#E5E5E5"> secret server although like I</font>

599
00:22:49,410 --> 00:22:53,460
said<font color="#E5E5E5"> most of what I see a cyber</font><font color="#CCCCCC"> art and</font>

600
00:22:51,210 --> 00:22:55,650
there's usually a reconciliation account

601
00:22:53,460 --> 00:22:57,720
for<font color="#CCCCCC"> this system that's in domain admins</font>

602
00:22:55,650 --> 00:22:59,220
<font color="#E5E5E5">this reconciliation account will</font>

603
00:22:57,720 --> 00:23:01,170
automatically reach out to an account

604
00:22:59,220 --> 00:23:04,050
check to make sure the password is still

605
00:23:01,170 --> 00:23:05,700
<font color="#E5E5E5">valid that it's managing if it is not</font>

606
00:23:04,050 --> 00:23:07,530
<font color="#E5E5E5">currently under control and the</font>

607
00:23:05,700 --> 00:23:09,900
passwords been changed outside<font color="#E5E5E5"> of the</font>

608
00:23:07,530 --> 00:23:11,040
system<font color="#E5E5E5"> then the password vault system</font>

609
00:23:09,900 --> 00:23:13,260
will reach out<font color="#E5E5E5"> and change it to</font><font color="#CCCCCC"> a</font>

610
00:23:11,040 --> 00:23:15,090
<font color="#E5E5E5">password</font><font color="#CCCCCC"> that it knows and it will note</font>

611
00:23:13,260 --> 00:23:17,460
<font color="#CCCCCC">that and move on and</font><font color="#E5E5E5"> there's additional</font>

612
00:23:15,090 --> 00:23:18,929
<font color="#E5E5E5">components to augment security such as</font><font color="#CCCCCC"> a</font>

613
00:23:17,460 --> 00:23:21,000
<font color="#E5E5E5">session manager which is when you</font>

614
00:23:18,930 --> 00:23:22,920
connect<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> password vault and it</font>

615
00:23:21,000 --> 00:23:24,720
works basically like<font color="#E5E5E5"> an RDP proxy</font>

616
00:23:22,920 --> 00:23:25,980
connect to that<font color="#E5E5E5"> and then you connect</font>

617
00:23:24,720 --> 00:23:27,480
directly to the system

618
00:23:25,980 --> 00:23:29,730
you'd never see the<font color="#E5E5E5"> user name you never</font>

619
00:23:27,480 --> 00:23:30,930
<font color="#E5E5E5">see the password</font><font color="#CCCCCC"> so let's see what this</font>

620
00:23:29,730 --> 00:23:32,400
looks<font color="#E5E5E5"> like there's a couple</font><font color="#CCCCCC"> different</font>

621
00:23:30,930 --> 00:23:33,720
scenarios<font color="#E5E5E5"> here that are interesting</font><font color="#CCCCCC"> we</font>

622
00:23:32,400 --> 00:23:35,970
have our<font color="#E5E5E5"> workstation we have a password</font>

623
00:23:33,720 --> 00:23:37,380
<font color="#CCCCCC">vault in our admin server</font><font color="#E5E5E5"> traditionally</font>

624
00:23:35,970 --> 00:23:39,030
we've had the workstation connect

625
00:23:37,380 --> 00:23:41,880
<font color="#CCCCCC">directly through the admin</font><font color="#E5E5E5"> server via</font>

626
00:23:39,030 --> 00:23:43,440
RDP<font color="#E5E5E5"> this is not that</font><font color="#CCCCCC"> much different so</font>

627
00:23:41,880 --> 00:23:45,240
we connect to<font color="#E5E5E5"> our password vault and we</font>

628
00:23:43,440 --> 00:23:47,580
check out<font color="#E5E5E5"> our password</font><font color="#CCCCCC"> so we're</font>

629
00:23:45,240 --> 00:23:49,710
connecting to that<font color="#CCCCCC"> website through HTTPS</font>

630
00:23:47,580 --> 00:23:52,020
so it's secured and then we're<font color="#E5E5E5"> going to</font>

631
00:23:49,710 --> 00:23:54,660
copy<font color="#CCCCCC"> that password down</font><font color="#E5E5E5"> so that password</font>

632
00:23:52,020 --> 00:23:57,240
is now<font color="#E5E5E5"> copied onto that</font><font color="#CCCCCC"> workstation we</font>

633
00:23:54,660 --> 00:24:00,090
<font color="#CCCCCC">could paste it into the RDP logon window</font>

634
00:23:57,240 --> 00:24:01,680
<font color="#E5E5E5">and then connect into RDP this way we</font>

635
00:24:00,090 --> 00:24:03,360
<font color="#CCCCCC">don't have</font><font color="#E5E5E5"> to look at that long 30</font>

636
00:24:01,680 --> 00:24:05,670
character string of<font color="#CCCCCC"> random characters</font>

637
00:24:03,360 --> 00:24:07,169
<font color="#E5E5E5">and type them and manually get it wrong</font>

638
00:24:05,670 --> 00:24:09,300
get it<font color="#E5E5E5"> wrong get it wrong lock out the</font>

639
00:24:07,170 --> 00:24:12,420
account<font color="#E5E5E5"> so we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> copy it</font><font color="#CCCCCC"> paste it</font>

640
00:24:09,300 --> 00:24:13,800
<font color="#E5E5E5">and we're good to</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> of course</font><font color="#CCCCCC"> there's</font>

641
00:24:12,420 --> 00:24:16,170
an issue<font color="#E5E5E5"> here</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> we're using a</font>

642
00:24:13,800 --> 00:24:17,879
regular<font color="#E5E5E5"> user account on a regular</font>

643
00:24:16,170 --> 00:24:20,730
workstation in order to gather this

644
00:24:17,880 --> 00:24:22,590
information<font color="#E5E5E5"> there's another power sploit</font>

645
00:24:20,730 --> 00:24:25,650
function called get clipboard contents

646
00:24:22,590 --> 00:24:27,840
which is a way to pull data out<font color="#E5E5E5"> of the</font>

647
00:24:25,650 --> 00:24:28,620
<font color="#E5E5E5">windows clipboard which is what happens</font>

648
00:24:27,840 --> 00:24:29,490
when you copy

649
00:24:28,620 --> 00:24:33,149
data

650
00:24:29,490 --> 00:24:34,860
using control-c or copy<font color="#CCCCCC"> and so again</font>

651
00:24:33,149 --> 00:24:36,570
there's another<font color="#E5E5E5"> file here</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> gets</font>

652
00:24:34,860 --> 00:24:40,408
dropped<font color="#CCCCCC"> onto the</font><font color="#E5E5E5"> system</font><font color="#CCCCCC"> when it notices</font>

653
00:24:36,570 --> 00:24:41,730
<font color="#E5E5E5">that's it there's an either actually the</font>

654
00:24:40,409 --> 00:24:43,350
probably<font color="#E5E5E5"> the best way to do it is when</font>

655
00:24:41,730 --> 00:24:45,090
the title of a web browser says

656
00:24:43,350 --> 00:24:47,340
cyber-ark<font color="#CCCCCC"> we just</font><font color="#E5E5E5"> kicked this off</font>

657
00:24:45,090 --> 00:24:49,709
<font color="#E5E5E5">because</font><font color="#CCCCCC"> probably someone's going to be</font>

658
00:24:47,340 --> 00:24:51,809
<font color="#CCCCCC">copying contents</font><font color="#E5E5E5"> into the clipboard</font><font color="#CCCCCC"> and</font>

659
00:24:49,710 --> 00:24:53,850
<font color="#E5E5E5">once we do that we can identify</font><font color="#CCCCCC"> some</font>

660
00:24:51,809 --> 00:24:55,408
interesting things<font color="#E5E5E5"> that</font><font color="#CCCCCC"> that end up in</font>

661
00:24:53,850 --> 00:24:59,549
the in the clipboard through this

662
00:24:55,409 --> 00:25:01,409
<font color="#CCCCCC">powersploit function and so with that we</font>

663
00:24:59,549 --> 00:25:02,879
<font color="#E5E5E5">can leverage</font><font color="#CCCCCC"> that information where it's</font>

664
00:25:01,409 --> 00:25:06,059
connected<font color="#CCCCCC"> to</font><font color="#E5E5E5"> that system at the same</font>

665
00:25:02,880 --> 00:25:08,179
time we can also use another<font color="#E5E5E5"> power</font>

666
00:25:06,059 --> 00:25:11,639
<font color="#E5E5E5">sploit function called get</font><font color="#CCCCCC"> x screenshot</font>

667
00:25:08,179 --> 00:25:13,440
<font color="#E5E5E5">which enables us to identify even if we</font>

668
00:25:11,640 --> 00:25:14,730
<font color="#E5E5E5">just have the password what credentials</font>

669
00:25:13,440 --> 00:25:16,500
are actually going to<font color="#E5E5E5"> be used if they're</font>

670
00:25:14,730 --> 00:25:20,010
stored we can<font color="#E5E5E5"> also extract that from</font><font color="#CCCCCC"> the</font>

671
00:25:16,500 --> 00:25:21,600
registry if we really want to so<font color="#E5E5E5"> that's</font>

672
00:25:20,010 --> 00:25:23,370
one way<font color="#CCCCCC"> that it can be</font><font color="#E5E5E5"> done checking</font><font color="#CCCCCC"> out</font>

673
00:25:21,600 --> 00:25:25,230
the password<font color="#CCCCCC"> the second method that is</font>

674
00:25:23,370 --> 00:25:28,439
often configured<font color="#E5E5E5"> as as I mentioned that</font>

675
00:25:25,230 --> 00:25:30,090
<font color="#E5E5E5">sussan doesn't manager or RDP proxy this</font>

676
00:25:28,440 --> 00:25:31,620
is where the password vault<font color="#E5E5E5"> is the jump</font>

677
00:25:30,090 --> 00:25:33,779
system<font color="#E5E5E5"> to perform</font><font color="#CCCCCC"> the administration</font>

678
00:25:31,620 --> 00:25:36,629
with zero knowledge<font color="#E5E5E5"> of the account</font>

679
00:25:33,779 --> 00:25:38,100
<font color="#CCCCCC">password</font><font color="#E5E5E5"> there is</font><font color="#CCCCCC"> a enterprise password</font>

680
00:25:36,630 --> 00:25:39,750
vault vendor<font color="#CCCCCC"> that says this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> what you</font>

681
00:25:38,100 --> 00:25:41,789
<font color="#CCCCCC">should do and you</font><font color="#E5E5E5"> don't need admin</font>

682
00:25:39,750 --> 00:25:46,679
workstations<font color="#E5E5E5"> which I completely disagree</font>

683
00:25:41,789 --> 00:25:48,000
<font color="#E5E5E5">with why let's find out so again</font><font color="#CCCCCC"> we're</font>

684
00:25:46,679 --> 00:25:51,000
going<font color="#E5E5E5"> to connect to the password</font><font color="#CCCCCC"> vol</font><font color="#E5E5E5"> V</font>

685
00:25:48,000 --> 00:25:52,919
HCBS so it's secured and<font color="#CCCCCC"> weird then just</font>

686
00:25:51,000 --> 00:25:55,340
going<font color="#E5E5E5"> to click connect and go right</font>

687
00:25:52,919 --> 00:25:57,000
<font color="#E5E5E5">through to</font><font color="#CCCCCC"> the admin server</font><font color="#E5E5E5"> via RDP</font>

688
00:25:55,340 --> 00:25:59,939
simple right

689
00:25:57,000 --> 00:26:02,279
nothing ends up on the workstation<font color="#E5E5E5"> seems</font>

690
00:25:59,940 --> 00:26:05,190
<font color="#E5E5E5">very secure I don't see any problems</font>

691
00:26:02,279 --> 00:26:07,980
<font color="#CCCCCC">with this but I have some questions</font><font color="#E5E5E5"> what</font>

692
00:26:05,190 --> 00:26:09,929
account<font color="#E5E5E5"> is to log on to</font><font color="#CCCCCC"> the workstation</font>

693
00:26:07,980 --> 00:26:11,010
<font color="#E5E5E5">and what account is used to log on to</font>

694
00:26:09,929 --> 00:26:12,960
<font color="#CCCCCC">the</font><font color="#E5E5E5"> password</font><font color="#CCCCCC"> wall</font>

695
00:26:11,010 --> 00:26:15,720
<font color="#CCCCCC">i'd say</font><font color="#E5E5E5"> nine</font><font color="#CCCCCC"> out of ten times</font><font color="#E5E5E5"> it's the</font>

696
00:26:12,960 --> 00:26:18,059
same account<font color="#E5E5E5"> so the user account has</font>

697
00:26:15,720 --> 00:26:20,130
<font color="#CCCCCC">access to gather the privileged</font>

698
00:26:18,059 --> 00:26:23,639
<font color="#E5E5E5">credential data that's in the past</font>

699
00:26:20,130 --> 00:26:25,620
<font color="#CCCCCC">result</font><font color="#E5E5E5"> and I'd say probably</font><font color="#CCCCCC"> about 60</font><font color="#E5E5E5"> 70</font>

700
00:26:23,640 --> 00:26:32,280
<font color="#CCCCCC">percent of</font><font color="#E5E5E5"> the time that's protected</font>

701
00:26:25,620 --> 00:26:34,800
through MFA maybe hopefully

702
00:26:32,280 --> 00:26:36,149
so we look<font color="#CCCCCC"> at the</font><font color="#E5E5E5"> process and</font><font color="#CCCCCC"> we say</font>

703
00:26:34,800 --> 00:26:37,950
<font color="#E5E5E5">okay that's interesting</font><font color="#CCCCCC"> from the</font>

704
00:26:36,150 --> 00:26:40,520
authentication<font color="#CCCCCC"> method but who</font>

705
00:26:37,950 --> 00:26:42,810
administers<font color="#CCCCCC"> that password vault server</font>

706
00:26:40,520 --> 00:26:45,930
based on what I've seen<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> times</font>

707
00:26:42,810 --> 00:26:48,750
<font color="#E5E5E5">this</font><font color="#CCCCCC"> password vault server which stores</font>

708
00:26:45,930 --> 00:26:51,540
<font color="#CCCCCC">a</font><font color="#E5E5E5"> privileged credentials for Active</font>

709
00:26:48,750 --> 00:26:53,430
Directory domain admin accounts is just

710
00:26:51,540 --> 00:26:56,040
in the<font color="#E5E5E5"> servers of you managed by the</font>

711
00:26:53,430 --> 00:26:57,600
<font color="#E5E5E5">servers team with the same group policy</font>

712
00:26:56,040 --> 00:26:59,909
managing it that manages all the<font color="#E5E5E5"> other</font>

713
00:26:57,600 --> 00:27:03,090
servers because<font color="#CCCCCC"> our password vault</font>

714
00:26:59,910 --> 00:27:04,350
server is<font color="#CCCCCC"> just like any other</font><font color="#E5E5E5"> right it's</font>

715
00:27:03,090 --> 00:27:06,510
not<font color="#E5E5E5"> like it's a domain</font><font color="#CCCCCC"> controller that</font>

716
00:27:04,350 --> 00:27:07,860
<font color="#E5E5E5">has credentials</font><font color="#CCCCCC"> and then the other</font>

717
00:27:06,510 --> 00:27:09,300
<font color="#CCCCCC">question is are the network</font>

718
00:27:07,860 --> 00:27:12,030
communications limited to the password

719
00:27:09,300 --> 00:27:13,470
<font color="#CCCCCC">vault</font><font color="#E5E5E5"> nine times out of ten the entire</font>

720
00:27:12,030 --> 00:27:15,510
network<font color="#CCCCCC"> is able to</font><font color="#E5E5E5"> connect to the</font>

721
00:27:13,470 --> 00:27:20,300
<font color="#E5E5E5">password vault web server where</font><font color="#CCCCCC"> a</font>

722
00:27:15,510 --> 00:27:22,379
<font color="#E5E5E5">website which again has some concern and</font>

723
00:27:20,300 --> 00:27:25,860
then<font color="#E5E5E5"> probably the part of this I think</font>

724
00:27:22,380 --> 00:27:28,620
<font color="#E5E5E5">is the</font><font color="#CCCCCC"> most</font><font color="#E5E5E5"> interesting is this part</font>

725
00:27:25,860 --> 00:27:30,990
<font color="#E5E5E5">right here</font><font color="#CCCCCC"> this this whole part right</font>

726
00:27:28,620 --> 00:27:33,780
here because how do they connect to<font color="#E5E5E5"> the</font>

727
00:27:30,990 --> 00:27:35,370
password<font color="#CCCCCC"> vault it's a website</font><font color="#E5E5E5"> so why</font>

728
00:27:33,780 --> 00:27:37,200
don't<font color="#E5E5E5"> we just try compromising the users</font>

729
00:27:35,370 --> 00:27:38,100
web browser<font color="#E5E5E5"> because what web browsers</font>

730
00:27:37,200 --> 00:27:40,290
<font color="#E5E5E5">are they going to use to connect to</font>

731
00:27:38,100 --> 00:27:42,149
<font color="#E5E5E5">cyber-ark the same one that they use to</font>

732
00:27:40,290 --> 00:27:44,960
go on<font color="#E5E5E5"> Facebook</font><font color="#CCCCCC"> and read it and all the</font>

733
00:27:42,150 --> 00:27:47,730
other<font color="#E5E5E5"> stuff right maybe hopefully not</font>

734
00:27:44,960 --> 00:27:50,820
but if we're<font color="#CCCCCC"> able to get onto the system</font>

735
00:27:47,730 --> 00:27:53,580
<font color="#CCCCCC">and have admin rights</font><font color="#E5E5E5"> to it we could</font>

736
00:27:50,820 --> 00:27:58,919
drop in<font color="#E5E5E5"> another extension like maybe</font>

737
00:27:53,580 --> 00:28:02,189
this one here I'm being<font color="#E5E5E5"> very subtle by</font>

738
00:27:58,920 --> 00:28:03,780
the way and if we're able to do this<font color="#CCCCCC"> and</font>

739
00:28:02,190 --> 00:28:05,700
add an extension we can watch all the

740
00:28:03,780 --> 00:28:07,290
<font color="#E5E5E5">traffic those goes back and forth with</font>

741
00:28:05,700 --> 00:28:08,490
this web browser<font color="#CCCCCC"> which means we</font><font color="#E5E5E5"> don't</font>

742
00:28:07,290 --> 00:28:10,560
need to do anything else

743
00:28:08,490 --> 00:28:13,080
we<font color="#E5E5E5"> can just kind of piggyback into that</font>

744
00:28:10,560 --> 00:28:15,510
session<font color="#CCCCCC"> and like I said if we're looking</font>

745
00:28:13,080 --> 00:28:16,980
<font color="#E5E5E5">at</font><font color="#CCCCCC"> the password vault administration we</font>

746
00:28:15,510 --> 00:28:21,450
can go through<font color="#E5E5E5"> and</font><font color="#CCCCCC"> look</font><font color="#E5E5E5"> to see</font><font color="#CCCCCC"> who</font><font color="#E5E5E5"> the</font>

747
00:28:16,980 --> 00:28:23,010
<font color="#E5E5E5">users are and there's Eddie Eddie</font><font color="#CCCCCC"> Eddie</font>

748
00:28:21,450 --> 00:28:25,470
has all the rights in this<font color="#E5E5E5"> organization</font>

749
00:28:23,010 --> 00:28:27,270
there's usually<font color="#CCCCCC"> one which means</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> our</font>

750
00:28:25,470 --> 00:28:28,980
dinosaurs are running loose and even if

751
00:28:27,270 --> 00:28:30,570
we have everything<font color="#E5E5E5"> else done right if</font>

752
00:28:28,980 --> 00:28:33,180
we're<font color="#E5E5E5"> not protecting who has</font>

753
00:28:30,570 --> 00:28:37,620
<font color="#E5E5E5">administrative rights to our password</font>

754
00:28:33,180 --> 00:28:38,700
vault<font color="#E5E5E5"> there's a problem the other thing</font>

755
00:28:37,620 --> 00:28:41,428
I find<font color="#E5E5E5"> very interesting is that people</font>

756
00:28:38,700 --> 00:28:43,440
<font color="#E5E5E5">put these on the</font><font color="#CCCCCC"> internet</font><font color="#E5E5E5"> so I ran some</font>

757
00:28:41,429 --> 00:28:46,850
<font color="#CCCCCC">Showdown searches and</font><font color="#E5E5E5"> I saw that there</font>

758
00:28:43,440 --> 00:28:49,820
were<font color="#E5E5E5"> cyber-ark systems that were on the</font>

759
00:28:46,850 --> 00:28:53,570
<font color="#CCCCCC">a few of them actually and and one</font>

760
00:28:49,820 --> 00:28:55,570
that's<font color="#E5E5E5"> kind of old</font><font color="#CCCCCC"> which</font><font color="#E5E5E5"> is a problem</font>

761
00:28:53,570 --> 00:28:57,439
which I'll talk about in<font color="#CCCCCC"> just a minute</font>

762
00:28:55,570 --> 00:28:59,210
<font color="#E5E5E5">but</font><font color="#CCCCCC"> there's a number</font><font color="#E5E5E5"> of these weaknesses</font>

763
00:28:57,440 --> 00:29:01,309
<font color="#E5E5E5">that I've discovered and we're working</font>

764
00:28:59,210 --> 00:29:03,230
<font color="#CCCCCC">with customers that have gone all-in on</font>

765
00:29:01,309 --> 00:29:06,770
password<font color="#E5E5E5"> vaults and I've actually talked</font>

766
00:29:03,230 --> 00:29:08,179
<font color="#E5E5E5">to some cyber-ark consultants after I've</font>

767
00:29:06,770 --> 00:29:09,950
talked about<font color="#E5E5E5"> this at</font><font color="#CCCCCC"> other conferences</font>

768
00:29:08,179 --> 00:29:12,170
<font color="#E5E5E5">and they said yeah</font><font color="#CCCCCC"> we talked to our</font>

769
00:29:09,950 --> 00:29:14,570
customers about<font color="#E5E5E5"> making sure they do the</font>

770
00:29:12,170 --> 00:29:15,860
<font color="#E5E5E5">best practices and</font><font color="#CCCCCC"> I said well I</font><font color="#E5E5E5"> don't</font>

771
00:29:14,570 --> 00:29:17,330
think<font color="#E5E5E5"> the</font><font color="#CCCCCC"> message is getting to them</font>

772
00:29:15,860 --> 00:29:20,000
because this<font color="#CCCCCC"> is the way I keep</font><font color="#E5E5E5"> seeing</font>

773
00:29:17,330 --> 00:29:22,040
things configured<font color="#CCCCCC"> because</font><font color="#E5E5E5"> these these</font>

774
00:29:20,000 --> 00:29:23,600
are pretty<font color="#CCCCCC"> common and then</font><font color="#E5E5E5"> of course the</font>

775
00:29:22,040 --> 00:29:25,520
big<font color="#CCCCCC"> one at</font><font color="#E5E5E5"> the bottom</font><font color="#CCCCCC"> if is if there's a</font>

776
00:29:23,600 --> 00:29:27,500
<font color="#CCCCCC">vulnerability or</font><font color="#E5E5E5"> a way to get into the</font>

777
00:29:25,520 --> 00:29:30,530
password<font color="#CCCCCC"> vault then that can result in</font>

778
00:29:27,500 --> 00:29:32,540
Active<font color="#E5E5E5"> Directory compromised so</font>

779
00:29:30,530 --> 00:29:34,309
<font color="#E5E5E5">hopefully</font><font color="#CCCCCC"> they're there has not been any</font>

780
00:29:32,540 --> 00:29:36,190
kind of<font color="#E5E5E5"> vulnerability and</font><font color="#CCCCCC"> any kind of</font>

781
00:29:34,309 --> 00:29:40,490
password<font color="#CCCCCC"> vault that they're very</font><font color="#E5E5E5"> aware</font>

782
00:29:36,190 --> 00:29:44,840
<font color="#E5E5E5">okay yeah that's bad so last year there</font>

783
00:29:40,490 --> 00:29:47,240
was<font color="#E5E5E5"> a red team from Germany</font><font color="#CCCCCC"> that</font>

784
00:29:44,840 --> 00:29:49,610
identified a security vulnerability<font color="#CCCCCC"> in</font>

785
00:29:47,240 --> 00:29:51,890
cyber-ark that was a way to bypass

786
00:29:49,610 --> 00:29:55,250
authentication actually get<font color="#CCCCCC"> RCE into it</font>

787
00:29:51,890 --> 00:29:57,290
<font color="#E5E5E5">based on the rest</font><font color="#CCCCCC"> API</font><font color="#E5E5E5"> and the way that</font>

788
00:29:55,250 --> 00:30:00,710
the<font color="#E5E5E5"> tokens were being handled as part of</font>

789
00:29:57,290 --> 00:30:02,720
<font color="#E5E5E5">that so very</font><font color="#CCCCCC"> complicated method of doing</font>

790
00:30:00,710 --> 00:30:05,600
<font color="#E5E5E5">it but effectively they created a</font>

791
00:30:02,720 --> 00:30:08,150
malicious serialize net object and pass

792
00:30:05,600 --> 00:30:10,070
<font color="#E5E5E5">that into that connection</font><font color="#CCCCCC"> so when I</font>

793
00:30:08,150 --> 00:30:12,590
<font color="#CCCCCC">talked about</font><font color="#E5E5E5"> limiting who has the</font>

794
00:30:10,070 --> 00:30:14,270
ability<font color="#CCCCCC"> to connect to</font><font color="#E5E5E5"> the cyber-ark web</font>

795
00:30:12,590 --> 00:30:15,709
server<font color="#E5E5E5"> or your password</font><font color="#CCCCCC"> role web server</font>

796
00:30:14,270 --> 00:30:18,620
<font color="#E5E5E5">there's a really good</font><font color="#CCCCCC"> reason for that</font>

797
00:30:15,710 --> 00:30:21,230
<font color="#E5E5E5">because it was very nice</font><font color="#CCCCCC"> of this this</font>

798
00:30:18,620 --> 00:30:23,689
team to let cyber work know about it and

799
00:30:21,230 --> 00:30:25,910
get this fixed<font color="#CCCCCC"> but I'm</font><font color="#E5E5E5"> pretty</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that</font>

800
00:30:23,690 --> 00:30:31,760
the<font color="#CCCCCC"> nation-states are</font><font color="#E5E5E5"> not as generous in</font>

801
00:30:25,910 --> 00:30:33,050
<font color="#E5E5E5">their sharing of</font><font color="#CCCCCC"> 0 days so when it comes</font>

802
00:30:31,760 --> 00:30:34,370
to enterprise<font color="#CCCCCC"> password vault there's</font>

803
00:30:33,050 --> 00:30:36,020
some best practices we want to make sure

804
00:30:34,370 --> 00:30:37,939
<font color="#E5E5E5">that our administration is secure we</font>

805
00:30:36,020 --> 00:30:39,500
want to make sure<font color="#CCCCCC"> that only admin</font>

806
00:30:37,940 --> 00:30:41,420
accounts can manage that we want<font color="#E5E5E5"> to make</font>

807
00:30:39,500 --> 00:30:42,380
sure<font color="#E5E5E5"> that we restrict access to</font><font color="#CCCCCC"> this we</font>

808
00:30:41,420 --> 00:30:44,960
treat it like a domain controller

809
00:30:42,380 --> 00:30:47,059
<font color="#CCCCCC">ultimately and then the secure we secure</font>

810
00:30:44,960 --> 00:30:49,010
<font color="#CCCCCC">that authentication</font><font color="#E5E5E5"> what we recommend is</font>

811
00:30:47,059 --> 00:30:50,960
not using a user account<font color="#CCCCCC"> the regular</font>

812
00:30:49,010 --> 00:30:52,970
user account<font color="#CCCCCC"> to get those credentials</font>

813
00:30:50,960 --> 00:30:55,610
we recommend don't<font color="#E5E5E5"> use your admin</font>

814
00:30:52,970 --> 00:30:57,169
account to<font color="#E5E5E5"> get those graduals we talked</font>

815
00:30:55,610 --> 00:30:57,620
about the concept<font color="#CCCCCC"> of a transition</font>

816
00:30:57,169 --> 00:30:59,210
account

817
00:30:57,620 --> 00:31:00,559
it's<font color="#E5E5E5"> another account</font>

818
00:30:59,210 --> 00:31:01,640
has no rights<font color="#E5E5E5"> and the only thing that's</font>

819
00:31:00,559 --> 00:31:04,639
<font color="#E5E5E5">ever used for is to</font><font color="#CCCCCC"> get those</font>

820
00:31:01,640 --> 00:31:06,110
<font color="#E5E5E5">credentials MFA that account and that</font>

821
00:31:04,640 --> 00:31:08,779
way<font color="#E5E5E5"> there's some additional protection</font>

822
00:31:06,110 --> 00:31:11,000
<font color="#CCCCCC">there</font><font color="#E5E5E5"> especially</font><font color="#CCCCCC"> if you're</font><font color="#E5E5E5"> using a user</font>

823
00:31:08,779 --> 00:31:12,140
workstation<font color="#CCCCCC"> there's some other things</font>

824
00:31:11,000 --> 00:31:14,659
that<font color="#E5E5E5"> could be</font><font color="#CCCCCC"> done</font><font color="#E5E5E5"> when you're using an</font>

825
00:31:12,140 --> 00:31:17,390
admin workstation but we want to<font color="#E5E5E5"> ensure</font>

826
00:31:14,659 --> 00:31:18,980
that there's there's a tiered process of

827
00:31:17,390 --> 00:31:21,080
how<font color="#E5E5E5"> to get</font><font color="#CCCCCC"> access to those credentials</font>

828
00:31:18,980 --> 00:31:24,320
<font color="#CCCCCC">and there's not just</font><font color="#E5E5E5"> a way to jump right</font>

829
00:31:21,080 --> 00:31:25,928
into<font color="#CCCCCC"> it and then certainly split out the</font>

830
00:31:24,320 --> 00:31:29,299
roles to separate servers when possible

831
00:31:25,929 --> 00:31:30,980
<font color="#CCCCCC">cyber-ark has their agent that reaches</font>

832
00:31:29,299 --> 00:31:34,039
out to change the<font color="#E5E5E5"> password</font><font color="#CCCCCC"> on systems</font>

833
00:31:30,980 --> 00:31:37,309
<font color="#CCCCCC">that regularly</font><font color="#E5E5E5"> reaches back and</font><font color="#CCCCCC"> talks to</font>

834
00:31:34,039 --> 00:31:39,200
the vault<font color="#CCCCCC"> if the web server</font><font color="#E5E5E5"> is that</font>

835
00:31:37,309 --> 00:31:41,299
server<font color="#E5E5E5"> then that's a problem</font>

836
00:31:39,200 --> 00:31:43,130
cyborg says not to do that but<font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot of</font>

837
00:31:41,299 --> 00:31:45,110
<font color="#E5E5E5">times organizations will have one server</font>

838
00:31:43,130 --> 00:31:47,659
that has all the roles on it that does

839
00:31:45,110 --> 00:31:49,010
everything<font color="#CCCCCC"> and that server of course is</font>

840
00:31:47,659 --> 00:31:52,580
in<font color="#E5E5E5"> the server's area where the server</font>

841
00:31:49,010 --> 00:31:54,620
admins can manage it so the<font color="#E5E5E5"> question I</font>

842
00:31:52,580 --> 00:31:56,090
get a lot<font color="#E5E5E5"> is</font><font color="#CCCCCC"> well what about</font><font color="#E5E5E5"> the admin</font>

843
00:31:54,620 --> 00:31:58,760
<font color="#E5E5E5">forest what about the red forest</font>

844
00:31:56,090 --> 00:32:00,500
<font color="#E5E5E5">what do why don't</font><font color="#CCCCCC"> we just do</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> so the</font>

845
00:31:58,760 --> 00:32:02,419
whole<font color="#CCCCCC"> concept of</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is we have our</font>

846
00:32:00,500 --> 00:32:05,690
production<font color="#CCCCCC"> forests</font><font color="#E5E5E5"> over here on the left</font>

847
00:32:02,419 --> 00:32:07,669
<font color="#E5E5E5">and then over here we have</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> enhanced</font>

848
00:32:05,690 --> 00:32:10,760
security administrative environment aka

849
00:32:07,669 --> 00:32:13,010
red<font color="#E5E5E5"> forest aka admin</font><font color="#CCCCCC"> forest I just like</font>

850
00:32:10,760 --> 00:32:15,860
admin<font color="#CCCCCC"> forest because it's easy</font><font color="#E5E5E5"> to say</font>

851
00:32:13,010 --> 00:32:18,950
and<font color="#E5E5E5"> then you say</font><font color="#CCCCCC"> however you pronounce</font>

852
00:32:15,860 --> 00:32:21,049
that<font color="#E5E5E5"> so</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> whole concept</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

853
00:32:18,950 --> 00:32:23,480
that you're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to set up a brand-new</font>

854
00:32:21,049 --> 00:32:26,210
forest with<font color="#E5E5E5"> only physical servers with</font>

855
00:32:23,480 --> 00:32:30,649
<font color="#CCCCCC">PKI</font><font color="#E5E5E5"> separate patching separate</font>

856
00:32:26,210 --> 00:32:32,149
<font color="#E5E5E5">administration</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> of your admins for</font>

857
00:32:30,649 --> 00:32:33,469
your<font color="#CCCCCC"> production environment they have</font>

858
00:32:32,149 --> 00:32:34,879
<font color="#CCCCCC">regular user accounts</font><font color="#E5E5E5"> in this</font>

859
00:32:33,470 --> 00:32:37,909
environment<font color="#CCCCCC"> they can't modify</font><font color="#E5E5E5"> anything</font>

860
00:32:34,880 --> 00:32:39,710
<font color="#E5E5E5">and any of those people</font><font color="#CCCCCC"> that want to</font>

861
00:32:37,909 --> 00:32:41,750
<font color="#E5E5E5">administer or need to administer this</font>

862
00:32:39,710 --> 00:32:44,480
admin<font color="#CCCCCC"> Forest</font><font color="#E5E5E5"> need to have a second</font>

863
00:32:41,750 --> 00:32:45,770
account with another PGI<font color="#CCCCCC"> smartcard</font><font color="#E5E5E5"> so</font>

864
00:32:44,480 --> 00:32:47,960
the whole<font color="#E5E5E5"> concept of this is it's</font>

865
00:32:45,770 --> 00:32:49,520
entirely isolated<font color="#E5E5E5"> protected and it's</font>

866
00:32:47,960 --> 00:32:52,240
extremely<font color="#CCCCCC"> difficult to</font><font color="#E5E5E5"> get access to</font>

867
00:32:49,520 --> 00:32:54,649
those accounts<font color="#CCCCCC"> of</font><font color="#E5E5E5"> that environment I</font>

868
00:32:52,240 --> 00:32:57,799
think<font color="#CCCCCC"> I've covered all that pretty</font><font color="#E5E5E5"> much</font>

869
00:32:54,649 --> 00:32:59,989
<font color="#E5E5E5">patch quickly run the latest versions of</font>

870
00:32:57,799 --> 00:33:02,720
<font color="#E5E5E5">Windows</font><font color="#CCCCCC"> on the workstation and the</font>

871
00:32:59,990 --> 00:33:04,039
server<font color="#CCCCCC"> making sure</font><font color="#E5E5E5"> that everything is</font>

872
00:33:02,720 --> 00:33:07,309
limited<font color="#CCCCCC"> and then on the production</font><font color="#E5E5E5"> side</font>

873
00:33:04,039 --> 00:33:09,799
<font color="#E5E5E5">we basically empty out</font><font color="#CCCCCC"> our admin</font><font color="#E5E5E5"> or 80</font>

874
00:33:07,309 --> 00:33:12,050
admin groups and just leverage those

875
00:33:09,799 --> 00:33:15,550
those 80 admin<font color="#E5E5E5"> group</font>

876
00:33:12,050 --> 00:33:18,379
or that<font color="#E5E5E5"> sorry that admin</font><font color="#CCCCCC"> Forest Group</font>

877
00:33:15,550 --> 00:33:20,090
there<font color="#E5E5E5"> are some pros to this because it</font>

878
00:33:18,380 --> 00:33:21,710
effectively does<font color="#E5E5E5"> isolate those domain</font>

879
00:33:20,090 --> 00:33:23,959
admins and<font color="#E5E5E5"> other Active Directory admins</font>

880
00:33:21,710 --> 00:33:25,550
<font color="#E5E5E5">and when deployed properly</font><font color="#CCCCCC"> it can be</font>

881
00:33:23,960 --> 00:33:27,950
effective<font color="#E5E5E5"> and limiting attacker</font><font color="#CCCCCC"> ad</font>

882
00:33:25,550 --> 00:33:29,780
privileged access but there are a<font color="#CCCCCC"> number</font>

883
00:33:27,950 --> 00:33:31,820
of cons<font color="#E5E5E5"> number of negatives and them</font>

884
00:33:29,780 --> 00:33:34,550
very drawbacks to this<font color="#CCCCCC"> it's very</font>

885
00:33:31,820 --> 00:33:36,439
<font color="#E5E5E5">expensive the employ first of all you</font>

886
00:33:34,550 --> 00:33:37,940
typically have<font color="#E5E5E5"> Microsoft come in to do</font>

887
00:33:36,440 --> 00:33:40,550
<font color="#CCCCCC">that which means</font><font color="#E5E5E5"> you give them a big bag</font>

888
00:33:37,940 --> 00:33:41,900
of<font color="#E5E5E5"> money</font><font color="#CCCCCC"> usually several big bags of</font>

889
00:33:40,550 --> 00:33:46,639
money with the dollar signs on<font color="#E5E5E5"> the side</font>

890
00:33:41,900 --> 00:33:48,130
or<font color="#E5E5E5"> euros I guess here</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> in greatly</font>

891
00:33:46,640 --> 00:33:50,120
increases the management<font color="#E5E5E5"> operate</font>

892
00:33:48,130 --> 00:33:52,160
operational overhead<font color="#E5E5E5"> and cost</font>

893
00:33:50,120 --> 00:33:53,239
now all the admins have to use this

894
00:33:52,160 --> 00:33:54,620
system<font color="#E5E5E5"> they have to use admin</font>

895
00:33:53,240 --> 00:33:56,810
workstations associated with<font color="#E5E5E5"> that</font>

896
00:33:54,620 --> 00:33:58,669
there's a management<font color="#E5E5E5"> tail of that whole</font>

897
00:33:56,810 --> 00:34:00,679
<font color="#CCCCCC">environment which is very expensive</font><font color="#E5E5E5"> to</font>

898
00:33:58,670 --> 00:34:03,290
manage so<font color="#CCCCCC"> the it's very expensive to</font>

899
00:34:00,680 --> 00:34:04,520
<font color="#E5E5E5">deploy it's very expensive to manage but</font>

900
00:34:03,290 --> 00:34:06,379
at least all<font color="#CCCCCC"> of your Act Directory</font>

901
00:34:04,520 --> 00:34:09,649
admins are over in that right at that

902
00:34:06,380 --> 00:34:12,770
environment now you've<font color="#CCCCCC"> duplicated your</font>

903
00:34:09,649 --> 00:34:15,219
<font color="#E5E5E5">infrastructure</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> biggest issue is it</font>

904
00:34:12,770 --> 00:34:18,110
doesn't<font color="#CCCCCC"> fix your production 80 issues</font>

905
00:34:15,219 --> 00:34:20,719
<font color="#E5E5E5">I've seen many many many times</font>

906
00:34:18,110 --> 00:34:22,399
<font color="#E5E5E5">security issues</font><font color="#CCCCCC"> that I've highlighted</font><font color="#E5E5E5"> in</font>

907
00:34:20,719 --> 00:34:23,989
production<font color="#CCCCCC"> environments</font><font color="#E5E5E5"> and they had an</font>

908
00:34:22,399 --> 00:34:27,020
admin force<font color="#E5E5E5"> they had a red forest</font>

909
00:34:23,989 --> 00:34:28,790
<font color="#E5E5E5">because Microsoft or someone else talked</font>

910
00:34:27,020 --> 00:34:30,469
to the CIO and<font color="#E5E5E5"> said write this check</font>

911
00:34:28,790 --> 00:34:32,840
<font color="#CCCCCC">this</font><font color="#E5E5E5"> will solve</font><font color="#CCCCCC"> your Active Directory</font>

912
00:34:30,469 --> 00:34:36,230
security issues<font color="#E5E5E5"> and they said</font><font color="#CCCCCC"> ok I want</font>

913
00:34:32,840 --> 00:34:38,360
<font color="#E5E5E5">to write</font><font color="#CCCCCC"> that check</font><font color="#E5E5E5"> and later it's</font><font color="#CCCCCC"> still</font>

914
00:34:36,230 --> 00:34:40,429
an issue<font color="#E5E5E5"> why is that still an issue</font>

915
00:34:38,360 --> 00:34:41,540
well we haven't<font color="#E5E5E5"> resolved the expanse of</font>

916
00:34:40,429 --> 00:34:43,460
rights over workstations and servers

917
00:34:41,540 --> 00:34:44,870
<font color="#E5E5E5">because we know that</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> workstation</font>

918
00:34:43,460 --> 00:34:46,940
admins<font color="#CCCCCC"> that has admin rights to all</font>

919
00:34:44,870 --> 00:34:48,799
workstations<font color="#E5E5E5"> server admins that have</font>

920
00:34:46,940 --> 00:34:51,020
admin<font color="#CCCCCC"> rights</font><font color="#E5E5E5"> to pretty much all our</font>

921
00:34:48,800 --> 00:34:54,560
<font color="#E5E5E5">servers including our</font><font color="#CCCCCC"> cyber-ark</font><font color="#E5E5E5"> password</font>

922
00:34:51,020 --> 00:34:56,540
<font color="#CCCCCC">wall</font><font color="#E5E5E5"> and our ad admin accounts may not</font>

923
00:34:54,560 --> 00:34:58,279
be properly discovered if we're<font color="#E5E5E5"> only</font>

924
00:34:56,540 --> 00:34:59,420
looking at our group membership

925
00:34:58,280 --> 00:35:00,740
especially our<font color="#CCCCCC"> privileged</font><font color="#E5E5E5"> group</font>

926
00:34:59,420 --> 00:35:02,630
membership in Active Directory our

927
00:35:00,740 --> 00:35:04,850
default ones like domain admins which is

928
00:35:02,630 --> 00:35:06,260
what everyone<font color="#CCCCCC"> looks</font><font color="#E5E5E5"> that we're not going</font>

929
00:35:04,850 --> 00:35:08,480
<font color="#E5E5E5">to capture all</font><font color="#CCCCCC"> of our act directly</font>

930
00:35:06,260 --> 00:35:09,920
admins if we have to look at our group

931
00:35:08,480 --> 00:35:13,040
policy where<font color="#E5E5E5"> if you look at permissions</font>

932
00:35:09,920 --> 00:35:14,960
in<font color="#E5E5E5"> AD we have to have a good</font>

933
00:35:13,040 --> 00:35:17,779
<font color="#E5E5E5">understanding of what those rights and</font>

934
00:35:14,960 --> 00:35:20,450
those<font color="#CCCCCC"> accounts are and then there's</font><font color="#E5E5E5"> this</font>

935
00:35:17,780 --> 00:35:21,860
like other thing that<font color="#E5E5E5"> people</font><font color="#CCCCCC"> forget</font>

936
00:35:20,450 --> 00:35:23,419
<font color="#CCCCCC">about these</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> called service</font>

937
00:35:21,860 --> 00:35:25,340
accounts<font color="#E5E5E5"> that often are members of</font>

938
00:35:23,420 --> 00:35:25,870
domain admins<font color="#CCCCCC"> that no one wants to touch</font>

939
00:35:25,340 --> 00:35:28,330
ever

940
00:35:25,870 --> 00:35:30,520
why because they were set up years<font color="#CCCCCC"> ago</font>

941
00:35:28,330 --> 00:35:33,009
<font color="#E5E5E5">no one</font><font color="#CCCCCC"> knows really what they do they</font>

942
00:35:30,520 --> 00:35:35,110
<font color="#CCCCCC">just know</font><font color="#E5E5E5"> don't touch this don't change</font>

943
00:35:33,010 --> 00:35:35,470
this password<font color="#CCCCCC"> don't do</font><font color="#E5E5E5"> anything with</font>

944
00:35:35,110 --> 00:35:37,750
this

945
00:35:35,470 --> 00:35:39,279
I mean attackers know when there's an

946
00:35:37,750 --> 00:35:40,870
admin force you're gonna see<font color="#E5E5E5"> something</font>

947
00:35:39,280 --> 00:35:44,230
like this that<font color="#CCCCCC"> shows up its gonna have a</font>

948
00:35:40,870 --> 00:35:46,380
one-way trust<font color="#CCCCCC"> oftentimes it'll</font><font color="#E5E5E5"> have some</font>

949
00:35:44,230 --> 00:35:48,820
<font color="#E5E5E5">additional security configuration on it</font>

950
00:35:46,380 --> 00:35:50,050
<font color="#CCCCCC">it's not</font><font color="#E5E5E5"> that difficult to find</font><font color="#CCCCCC"> and</font>

951
00:35:48,820 --> 00:35:52,870
discover because<font color="#E5E5E5"> again there's usually</font>

952
00:35:50,050 --> 00:35:54,280
group membership from this<font color="#E5E5E5"> this other</font>

953
00:35:52,870 --> 00:35:55,960
force so<font color="#CCCCCC"> that we know that there's</font>

954
00:35:54,280 --> 00:35:59,050
something<font color="#E5E5E5"> else there</font><font color="#CCCCCC"> that looks</font>

955
00:35:55,960 --> 00:36:02,470
interesting<font color="#CCCCCC"> we</font><font color="#E5E5E5"> can do that through our</font>

956
00:35:59,050 --> 00:36:05,590
<font color="#E5E5E5">standard</font><font color="#CCCCCC"> Power View commands in order</font><font color="#E5E5E5"> to</font>

957
00:36:02,470 --> 00:36:07,509
identify<font color="#E5E5E5"> what's there</font><font color="#CCCCCC"> or we can use</font>

958
00:36:05,590 --> 00:36:08,860
other other<font color="#CCCCCC"> Power Cell</font><font color="#E5E5E5"> to look for it</font>

959
00:36:07,510 --> 00:36:11,170
<font color="#CCCCCC">but</font><font color="#E5E5E5"> we're going to see that there's a</font>

960
00:36:08,860 --> 00:36:14,260
one way trust<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that is</font><font color="#E5E5E5"> configured for</font>

961
00:36:11,170 --> 00:36:15,640
<font color="#CCCCCC">this admin forest</font><font color="#E5E5E5"> and again</font><font color="#CCCCCC"> anytime we</font>

962
00:36:14,260 --> 00:36:18,220
see<font color="#CCCCCC"> something like foreign security</font>

963
00:36:15,640 --> 00:36:20,259
principles<font color="#E5E5E5"> that's going to be something</font>

964
00:36:18,220 --> 00:36:22,810
<font color="#E5E5E5">from</font><font color="#CCCCCC"> another</font><font color="#E5E5E5"> forest and we can see here</font>

965
00:36:20,260 --> 00:36:24,760
that<font color="#E5E5E5"> that's what it</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> so via the GUI or</font>

966
00:36:22,810 --> 00:36:27,070
via<font color="#E5E5E5"> PowerShell we can discover this</font>

967
00:36:24,760 --> 00:36:28,960
<font color="#E5E5E5">pretty easily</font><font color="#CCCCCC"> so once we realize that</font>

968
00:36:27,070 --> 00:36:31,360
<font color="#E5E5E5">there's there's all of</font><font color="#CCCCCC"> our admins or</font>

969
00:36:28,960 --> 00:36:33,010
<font color="#E5E5E5">over in this other forest we're gonna</font>

970
00:36:31,360 --> 00:36:34,510
start<font color="#E5E5E5"> looking</font><font color="#CCCCCC"> for a</font><font color="#E5E5E5"> low-hanging fruit</font>

971
00:36:33,010 --> 00:36:36,160
things that are still<font color="#E5E5E5"> available to us</font>

972
00:36:34,510 --> 00:36:38,710
and there's one thing<font color="#CCCCCC"> that's always</font>

973
00:36:36,160 --> 00:36:40,600
going<font color="#E5E5E5"> to be</font><font color="#CCCCCC"> available</font><font color="#E5E5E5"> that you can't</font>

974
00:36:38,710 --> 00:36:43,750
just outsource to another admin force

975
00:36:40,600 --> 00:36:45,730
and<font color="#E5E5E5"> that's back up the main controllers</font>

976
00:36:43,750 --> 00:36:48,520
have to get back down one way or another

977
00:36:45,730 --> 00:36:50,740
<font color="#CCCCCC">a lot of</font><font color="#E5E5E5"> times are backed up through a</font>

978
00:36:48,520 --> 00:36:53,410
system that backs up<font color="#E5E5E5"> everything in the</font>

979
00:36:50,740 --> 00:36:55,750
environment<font color="#E5E5E5"> which seems problematic to</font>

980
00:36:53,410 --> 00:36:57,879
<font color="#CCCCCC">me but it makes sense</font><font color="#E5E5E5"> when</font><font color="#CCCCCC"> you talk</font>

981
00:36:55,750 --> 00:36:59,830
about<font color="#E5E5E5"> how to back and back</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> and</font>

982
00:36:57,880 --> 00:37:01,960
recover things through a process

983
00:36:59,830 --> 00:37:04,299
standard process and so here we<font color="#E5E5E5"> have</font>

984
00:37:01,960 --> 00:37:06,670
membership of the<font color="#E5E5E5"> Active Directory group</font>

985
00:37:04,300 --> 00:37:11,500
backup operators<font color="#E5E5E5"> we have a backup server</font>

986
00:37:06,670 --> 00:37:12,910
and we have a backup<font color="#E5E5E5"> account so if we</font>

987
00:37:11,500 --> 00:37:15,280
have a<font color="#E5E5E5"> backup server with</font><font color="#CCCCCC"> 80 backup</font>

988
00:37:12,910 --> 00:37:16,569
<font color="#E5E5E5">rights and we have an 80 backup service</font>

989
00:37:15,280 --> 00:37:19,030
account we're gonna go<font color="#CCCCCC"> after one of</font>

990
00:37:16,570 --> 00:37:22,120
<font color="#E5E5E5">these and it's very likely this backup</font>

991
00:37:19,030 --> 00:37:25,210
service count has a very simple<font color="#E5E5E5"> password</font>

992
00:37:22,120 --> 00:37:29,170
something<font color="#E5E5E5"> like backup</font><font color="#CCCCCC"> ad</font><font color="#E5E5E5"> 2019 or</font>

993
00:37:25,210 --> 00:37:31,540
<font color="#E5E5E5">probably more likely 2014 and it's not</font>

994
00:37:29,170 --> 00:37:32,770
going<font color="#E5E5E5"> to be that complex as far as a</font>

995
00:37:31,540 --> 00:37:36,490
password goes or have a lot of

996
00:37:32,770 --> 00:37:38,440
<font color="#E5E5E5">restrictions</font><font color="#CCCCCC"> on it because and it may</font>

997
00:37:36,490 --> 00:37:39,988
even<font color="#CCCCCC"> be a member</font><font color="#E5E5E5"> of domain admins which</font>

998
00:37:38,440 --> 00:37:42,369
is kind of scary

999
00:37:39,989 --> 00:37:44,229
there are some backup products that

1000
00:37:42,369 --> 00:37:47,169
require domain admins or<font color="#E5E5E5"> some some level</font>

1001
00:37:44,229 --> 00:37:49,299
of<font color="#CCCCCC"> rights at that level because</font><font color="#E5E5E5"> it's</font>

1002
00:37:47,169 --> 00:37:51,069
<font color="#E5E5E5">able to restore attributes back to the</font>

1003
00:37:49,299 --> 00:37:55,659
way it<font color="#E5E5E5"> was before in order to do that it</font>

1004
00:37:51,069 --> 00:37:57,849
needs<font color="#E5E5E5"> elevated rights so the challenge</font>

1005
00:37:55,659 --> 00:37:59,679
<font color="#E5E5E5">with this is</font><font color="#CCCCCC"> we need a backup domain</font>

1006
00:37:57,849 --> 00:38:00,999
controllers we need to have a service

1007
00:37:59,679 --> 00:38:04,539
account we need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> have a system</font><font color="#CCCCCC"> to do</font>

1008
00:38:00,999 --> 00:38:06,279
it<font color="#E5E5E5"> but by doing</font><font color="#CCCCCC"> so especially</font><font color="#E5E5E5"> if we're</font>

1009
00:38:04,539 --> 00:38:08,380
using something<font color="#CCCCCC"> like net backup that</font>

1010
00:38:06,279 --> 00:38:09,789
backs up everything<font color="#E5E5E5"> then that because</font>

1011
00:38:08,380 --> 00:38:12,939
our<font color="#E5E5E5"> company becomes our entry point</font><font color="#CCCCCC"> to</font>

1012
00:38:09,789 --> 00:38:15,759
that I worked<font color="#E5E5E5"> with a</font><font color="#CCCCCC"> Red Team internal</font>

1013
00:38:12,939 --> 00:38:17,439
<font color="#CCCCCC">Red Team recently</font><font color="#E5E5E5"> and they had a an</font>

1014
00:38:15,759 --> 00:38:19,299
admin force in their environment<font color="#E5E5E5"> and</font>

1015
00:38:17,439 --> 00:38:21,158
this is how we exploited through Active

1016
00:38:19,299 --> 00:38:22,959
Directory<font color="#E5E5E5"> we went through the backup</font>

1017
00:38:21,159 --> 00:38:25,059
server<font color="#E5E5E5"> we jumped on to the</font><font color="#CCCCCC"> dcs</font><font color="#E5E5E5"> and we</font>

1018
00:38:22,959 --> 00:38:26,499
just<font color="#E5E5E5"> waited and then we did some</font><font color="#CCCCCC"> other</font>

1019
00:38:25,059 --> 00:38:29,499
fun stuff<font color="#E5E5E5"> in the admin</font><font color="#CCCCCC"> forest which</font><font color="#E5E5E5"> I</font>

1020
00:38:26,499 --> 00:38:30,908
can talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> later so</font><font color="#CCCCCC"> did you know</font>

1021
00:38:29,499 --> 00:38:32,140
that<font color="#CCCCCC"> the Splunk Universal forwarder</font><font color="#E5E5E5"> is</font>

1022
00:38:30,909 --> 00:38:34,119
often installed in<font color="#CCCCCC"> two main controllers</font>

1023
00:38:32,140 --> 00:38:37,989
<font color="#E5E5E5">and that it's effectively a mini version</font>

1024
00:38:34,119 --> 00:38:41,199
<font color="#CCCCCC">of sparking can run scripts so this is a</font>

1025
00:38:37,989 --> 00:38:42,999
fascinating talk that from the<font color="#CCCCCC"> Splunk</font>

1026
00:38:41,199 --> 00:38:44,499
conference talking<font color="#E5E5E5"> about the</font><font color="#CCCCCC"> spunk</font>

1027
00:38:42,999 --> 00:38:46,089
deployment server and how you can push

1028
00:38:44,499 --> 00:38:47,589
things to systems that<font color="#E5E5E5"> have</font><font color="#CCCCCC"> Splunk</font>

1029
00:38:46,089 --> 00:38:49,749
<font color="#E5E5E5">agents running on it specifically the</font>

1030
00:38:47,589 --> 00:38:51,788
<font color="#CCCCCC">universal</font><font color="#E5E5E5"> Florida</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> personally do not</font>

1031
00:38:49,749 --> 00:38:53,859
like<font color="#E5E5E5"> agents that can install and run</font>

1032
00:38:51,789 --> 00:38:56,199
code on<font color="#E5E5E5"> domain controllers but</font><font color="#CCCCCC"> I also</font>

1033
00:38:53,859 --> 00:38:59,828
understand the operational component and

1034
00:38:56,199 --> 00:39:01,509
how things<font color="#E5E5E5"> have to</font><font color="#CCCCCC"> be managed so</font>

1035
00:38:59,829 --> 00:39:04,599
exploiting the production ad with an<font color="#E5E5E5"> ad</font>

1036
00:39:01,509 --> 00:39:06,969
<font color="#E5E5E5">I've enforced there's a lot of problems</font>

1037
00:39:04,599 --> 00:39:08,679
in the production<font color="#CCCCCC"> ad forests that don't</font>

1038
00:39:06,969 --> 00:39:10,390
get fixed with<font color="#E5E5E5"> an admin</font><font color="#CCCCCC"> forced which is</font>

1039
00:39:08,679 --> 00:39:12,779
why I'm not<font color="#CCCCCC"> a huge fan of an admin force</font>

1040
00:39:10,390 --> 00:39:15,189
<font color="#E5E5E5">except for very specific</font><font color="#CCCCCC"> circumstances</font>

1041
00:39:12,779 --> 00:39:16,719
usually large environments with multiple

1042
00:39:15,189 --> 00:39:18,969
<font color="#CCCCCC">forests it makes sense to have a single</font>

1043
00:39:16,719 --> 00:39:21,789
<font color="#CCCCCC">admin</font><font color="#E5E5E5"> forced to manage those others</font>

1044
00:39:18,969 --> 00:39:25,269
outside<font color="#CCCCCC"> of that it's a huge additional</font>

1045
00:39:21,789 --> 00:39:28,659
cost<font color="#CCCCCC"> with benefits that</font><font color="#E5E5E5"> have to be</font>

1046
00:39:25,269 --> 00:39:30,459
<font color="#CCCCCC">evaluated</font><font color="#E5E5E5"> carefully one of the other</font>

1047
00:39:28,659 --> 00:39:32,199
problems<font color="#CCCCCC"> we</font><font color="#E5E5E5"> see a lot is cross forest</font>

1048
00:39:30,459 --> 00:39:33,939
administration so we have<font color="#CCCCCC"> four</font><font color="#E5E5E5"> stay</font><font color="#CCCCCC"> in</font>

1049
00:39:32,199 --> 00:39:36,999
<font color="#CCCCCC">forest B because I'm really creative at</font>

1050
00:39:33,939 --> 00:39:38,618
naming<font color="#CCCCCC"> forest and so</font><font color="#E5E5E5"> for us B is gonna</font>

1051
00:39:36,999 --> 00:39:41,499
<font color="#CCCCCC">have a</font><font color="#E5E5E5"> truss where it trusts the users</font>

1052
00:39:38,619 --> 00:39:45,069
in forest a and so there's<font color="#E5E5E5"> our ad happy</font>

1053
00:39:41,499 --> 00:39:46,658
domain admin enforced a and<font color="#CCCCCC"> our happy</font><font color="#E5E5E5"> to</font>

1054
00:39:45,069 --> 00:39:48,489
me an admin is told guess what<font color="#CCCCCC"> domain</font>

1055
00:39:46,659 --> 00:39:50,319
admin<font color="#E5E5E5"> we have this new force called</font>

1056
00:39:48,489 --> 00:39:52,300
force B we<font color="#E5E5E5"> want you to manage that</font><font color="#CCCCCC"> also</font>

1057
00:39:50,319 --> 00:39:55,060
really I have enough

1058
00:39:52,300 --> 00:39:57,280
<font color="#E5E5E5">okay sure so our</font><font color="#CCCCCC"> forest a takes</font>

1059
00:39:55,060 --> 00:39:58,810
<font color="#CCCCCC">therefore</font><font color="#E5E5E5"> state domain admin account and</font>

1060
00:39:57,280 --> 00:40:01,660
they're<font color="#E5E5E5"> going to make sure</font><font color="#CCCCCC"> that it's a</font>

1061
00:39:58,810 --> 00:40:03,100
member of the forest<font color="#E5E5E5"> be administrator so</font>

1062
00:40:01,660 --> 00:40:04,870
<font color="#E5E5E5">that they can go ahead and RDP and</font>

1063
00:40:03,100 --> 00:40:06,339
manage<font color="#E5E5E5"> that with one account because</font>

1064
00:40:04,870 --> 00:40:08,049
<font color="#E5E5E5">that makes things easy</font>

1065
00:40:06,340 --> 00:40:09,760
they got this dumped on them on a Friday

1066
00:40:08,050 --> 00:40:13,750
and they have to make<font color="#E5E5E5"> some changes</font><font color="#CCCCCC"> in</font>

1067
00:40:09,760 --> 00:40:15,850
<font color="#CCCCCC">forest be</font><font color="#E5E5E5"> okay the problem</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> even</font>

1068
00:40:13,750 --> 00:40:17,710
with the<font color="#CCCCCC"> one-way</font><font color="#E5E5E5"> trust we now have a</font>

1069
00:40:15,850 --> 00:40:20,470
situation<font color="#E5E5E5"> where if forest B is</font>

1070
00:40:17,710 --> 00:40:23,620
compromised and forced<font color="#CCCCCC"> ad</font><font color="#E5E5E5"> to make a</font>

1071
00:40:20,470 --> 00:40:26,589
forest<font color="#E5E5E5"> a domain admin account is on that</font>

1072
00:40:23,620 --> 00:40:29,020
domain<font color="#E5E5E5"> controller it's compromised also</font>

1073
00:40:26,590 --> 00:40:31,330
and so the<font color="#CCCCCC"> compromise of</font><font color="#E5E5E5"> forest B can</font>

1074
00:40:29,020 --> 00:40:34,170
jump<font color="#E5E5E5"> back over to</font><font color="#CCCCCC"> force</font><font color="#E5E5E5"> day so you can</font>

1075
00:40:31,330 --> 00:40:37,540
expand this to force B as your DMZ

1076
00:40:34,170 --> 00:40:39,610
common scenario how is<font color="#E5E5E5"> that being</font>

1077
00:40:37,540 --> 00:40:41,860
<font color="#E5E5E5">administered one of the biggest</font>

1078
00:40:39,610 --> 00:40:43,750
challenges that<font color="#CCCCCC"> ad admins have is I've</font>

1079
00:40:41,860 --> 00:40:45,550
got these forests because now I've been

1080
00:40:43,750 --> 00:40:48,940
told to<font color="#E5E5E5"> set up these forests so I have</font>

1081
00:40:45,550 --> 00:40:50,710
<font color="#CCCCCC">thrust so I can manage them</font><font color="#E5E5E5"> so I use my</font>

1082
00:40:48,940 --> 00:40:52,870
production ad admin account because

1083
00:40:50,710 --> 00:40:54,040
that's has a long password it's got MFA

1084
00:40:52,870 --> 00:40:57,970
it's got all the<font color="#CCCCCC"> other stuff that</font><font color="#E5E5E5"> I'm</font>

1085
00:40:54,040 --> 00:40:59,710
supposed to<font color="#E5E5E5"> be using maybe and that's</font>

1086
00:40:57,970 --> 00:41:00,879
the one that<font color="#E5E5E5"> I keep track of I don't</font>

1087
00:40:59,710 --> 00:41:04,030
<font color="#E5E5E5">want to keep track of five different</font>

1088
00:41:00,880 --> 00:41:05,950
admin accounts but this is the way it

1089
00:41:04,030 --> 00:41:09,070
ends<font color="#CCCCCC"> up happening a lot</font><font color="#E5E5E5"> of the time is</font>

1090
00:41:05,950 --> 00:41:10,870
we<font color="#E5E5E5"> have this trust because Microsoft</font>

1091
00:41:09,070 --> 00:41:13,630
said to create<font color="#E5E5E5"> trust so we create trust</font>

1092
00:41:10,870 --> 00:41:15,339
we made it easy<font color="#CCCCCC"> on ourselves</font><font color="#E5E5E5"> but with</font>

1093
00:41:13,630 --> 00:41:17,200
this ease of use we have<font color="#E5E5E5"> the problem</font>

1094
00:41:15,340 --> 00:41:18,880
where we end up with a full<font color="#CCCCCC"> compromise</font>

1095
00:41:17,200 --> 00:41:20,710
of the<font color="#E5E5E5"> production</font><font color="#CCCCCC"> because the</font><font color="#E5E5E5"> DMZ was</font>

1096
00:41:18,880 --> 00:41:23,620
popped<font color="#E5E5E5"> we're using the same account to</font>

1097
00:41:20,710 --> 00:41:25,600
administer it so<font color="#E5E5E5"> ultimately the best way</font>

1098
00:41:23,620 --> 00:41:27,970
to mitigate<font color="#E5E5E5"> this is to ensure that any</font>

1099
00:41:25,600 --> 00:41:30,100
of these<font color="#E5E5E5"> external</font><font color="#CCCCCC"> force</font><font color="#E5E5E5"> outside</font><font color="#CCCCCC"> of a</font>

1100
00:41:27,970 --> 00:41:31,689
production<font color="#CCCCCC"> eighty forests have their own</font>

1101
00:41:30,100 --> 00:41:33,880
accounts<font color="#E5E5E5"> inside them that are used to</font>

1102
00:41:31,690 --> 00:41:35,800
manage<font color="#E5E5E5"> them let's not use cross</font><font color="#CCCCCC"> forest</font>

1103
00:41:33,880 --> 00:41:38,490
<font color="#E5E5E5">groups in order</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> manage systems</font>

1104
00:41:35,800 --> 00:41:41,350
because that<font color="#E5E5E5"> just makes it more complex</font>

1105
00:41:38,490 --> 00:41:44,950
from the perspective<font color="#E5E5E5"> of who has rights</font>

1106
00:41:41,350 --> 00:41:47,259
<font color="#E5E5E5">to what I recently assess an environment</font>

1107
00:41:44,950 --> 00:41:50,649
with<font color="#CCCCCC"> four forests and they had such</font>

1108
00:41:47,260 --> 00:41:52,060
complex interest relationships that I

1109
00:41:50,650 --> 00:41:54,280
felt<font color="#E5E5E5"> like I was watching a soap opera</font>

1110
00:41:52,060 --> 00:41:57,670
<font color="#CCCCCC">trying to map out who had rights where</font>

1111
00:41:54,280 --> 00:41:59,650
in order<font color="#E5E5E5"> to determine and it just</font><font color="#CCCCCC"> got</font><font color="#E5E5E5"> to</font>

1112
00:41:57,670 --> 00:42:01,090
a<font color="#CCCCCC"> point where I said okay</font><font color="#E5E5E5"> you have a</font>

1113
00:41:59,650 --> 00:42:03,070
user account<font color="#CCCCCC"> that's over here that has</font>

1114
00:42:01,090 --> 00:42:05,260
admin rights over<font color="#E5E5E5"> to this forest which</font>

1115
00:42:03,070 --> 00:42:05,930
then<font color="#E5E5E5"> it's administrators group is now</font>

1116
00:42:05,260 --> 00:42:08,569
over and

1117
00:42:05,930 --> 00:42:11,270
<font color="#CCCCCC">forest over there</font><font color="#E5E5E5"> it gets complicated</font>

1118
00:42:08,569 --> 00:42:14,869
<font color="#E5E5E5">and that</font><font color="#CCCCCC"> means that any one of those</font>

1119
00:42:11,270 --> 00:42:16,759
force gets popped<font color="#E5E5E5"> all of them do had</font>

1120
00:42:14,869 --> 00:42:18,260
another customer<font color="#CCCCCC"> that had ransomware</font>

1121
00:42:16,760 --> 00:42:20,420
just ravaged through<font color="#E5E5E5"> their Active</font>

1122
00:42:18,260 --> 00:42:21,890
Directory forest<font color="#E5E5E5"> and they had other</font>

1123
00:42:20,420 --> 00:42:25,130
<font color="#CCCCCC">forests they said well we're so glad</font><font color="#E5E5E5"> we</font>

1124
00:42:21,890 --> 00:42:26,868
<font color="#CCCCCC">had separate</font><font color="#E5E5E5"> forest but you have to wait</font>

1125
00:42:25,130 --> 00:42:28,760
trust between<font color="#E5E5E5"> all your</font><font color="#CCCCCC"> forest that</font><font color="#E5E5E5"> that</font>

1126
00:42:26,869 --> 00:42:30,829
ransomware was just very<font color="#E5E5E5"> bad it</font><font color="#CCCCCC"> just</font>

1127
00:42:28,760 --> 00:42:32,410
wasn't<font color="#CCCCCC"> smart enough</font><font color="#E5E5E5"> to look because it</font>

1128
00:42:30,829 --> 00:42:35,750
could have<font color="#E5E5E5"> just taken over all of them</font>

1129
00:42:32,410 --> 00:42:38,450
so there's things<font color="#E5E5E5"> that we</font><font color="#CCCCCC"> can do to</font>

1130
00:42:35,750 --> 00:42:40,339
isolate<font color="#E5E5E5"> these these these environments</font>

1131
00:42:38,450 --> 00:42:41,569
<font color="#E5E5E5">and protect them better because</font>

1132
00:42:40,339 --> 00:42:43,970
ultimately we<font color="#E5E5E5"> want to build the best</font>

1133
00:42:41,569 --> 00:42:45,890
<font color="#CCCCCC">defenses and so I put these</font><font color="#E5E5E5"> together as</font>

1134
00:42:43,970 --> 00:42:47,390
defensive pillars<font color="#E5E5E5"> so we have our</font>

1135
00:42:45,890 --> 00:42:49,730
administrative credential isolation of

1136
00:42:47,390 --> 00:42:52,460
protection we have<font color="#E5E5E5"> hardening our</font>

1137
00:42:49,730 --> 00:42:53,990
administrative methods we have reducing

1138
00:42:52,460 --> 00:42:56,300
and limiting service count<font color="#E5E5E5"> rights and</font>

1139
00:42:53,990 --> 00:43:01,399
effective<font color="#E5E5E5"> monitoring which I</font><font color="#CCCCCC"> don't have</font>

1140
00:42:56,300 --> 00:43:02,869
<font color="#E5E5E5">time to cover but it is important so we</font>

1141
00:43:01,400 --> 00:43:04,190
<font color="#CCCCCC">want to make sure that we're I slay ting</font>

1142
00:43:02,869 --> 00:43:05,869
protecting<font color="#E5E5E5"> these and one of the best</font>

1143
00:43:04,190 --> 00:43:07,760
things to do is the things that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> talk</font>

1144
00:43:05,869 --> 00:43:09,290
about<font color="#E5E5E5"> forever is is separate</font><font color="#CCCCCC"> eighty</font>

1145
00:43:07,760 --> 00:43:10,940
admin account from<font color="#E5E5E5"> our user account</font>

1146
00:43:09,290 --> 00:43:12,380
separate<font color="#CCCCCC"> eighty admin account from</font><font color="#E5E5E5"> other</font>

1147
00:43:10,940 --> 00:43:14,599
admin accounts<font color="#E5E5E5"> that way we're</font><font color="#CCCCCC"> not</font>

1148
00:43:12,380 --> 00:43:16,309
putting<font color="#E5E5E5"> those 80 domain admin</font>

1149
00:43:14,599 --> 00:43:18,500
credentials<font color="#E5E5E5"> on a whole bunch</font><font color="#CCCCCC"> of systems</font>

1150
00:43:16,309 --> 00:43:20,599
<font color="#E5E5E5">because we need a managed sequel for</font>

1151
00:43:18,500 --> 00:43:23,599
example and one of the best things<font color="#CCCCCC"> you</font>

1152
00:43:20,599 --> 00:43:25,609
can<font color="#E5E5E5"> do is use distinct naming I did an</font>

1153
00:43:23,599 --> 00:43:27,680
assessment<font color="#CCCCCC"> of one organization and I</font>

1154
00:43:25,609 --> 00:43:29,359
went<font color="#CCCCCC"> through and I said what's your name</font>

1155
00:43:27,680 --> 00:43:32,089
<font color="#E5E5E5">expander here because I'm seeing all</font>

1156
00:43:29,359 --> 00:43:33,380
<font color="#E5E5E5">these random</font><font color="#CCCCCC"> things it's like initials</font>

1157
00:43:32,089 --> 00:43:35,960
first initial middle initial last

1158
00:43:33,380 --> 00:43:38,599
<font color="#E5E5E5">initial and</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> first</font><font color="#CCCCCC"> name last initial</font>

1159
00:43:35,960 --> 00:43:40,400
<font color="#E5E5E5">and then first</font><font color="#CCCCCC"> name last initial</font><font color="#E5E5E5"> last</font>

1160
00:43:38,599 --> 00:43:43,420
<font color="#CCCCCC">name first</font><font color="#E5E5E5"> initial all over the place</font>

1161
00:43:40,400 --> 00:43:48,230
and<font color="#E5E5E5"> I said well what's</font><font color="#CCCCCC"> your standard</font><font color="#E5E5E5"> ah</font>

1162
00:43:43,420 --> 00:43:52,160
<font color="#E5E5E5">we do that</font><font color="#CCCCCC"> the attacker doesn't know</font><font color="#E5E5E5"> who</font>

1163
00:43:48,230 --> 00:43:54,619
the admins are so that's<font color="#E5E5E5"> great but I</font>

1164
00:43:52,160 --> 00:43:56,750
<font color="#CCCCCC">have this report</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> that lists</font><font color="#E5E5E5"> out all</font>

1165
00:43:54,619 --> 00:43:58,250
<font color="#E5E5E5">of your</font><font color="#CCCCCC"> Active Directory admins</font><font color="#E5E5E5"> and I</font>

1166
00:43:56,750 --> 00:44:00,859
<font color="#CCCCCC">don't know which accounts</font><font color="#E5E5E5"> are supposed</font>

1167
00:43:58,250 --> 00:44:02,630
to be there<font color="#E5E5E5"> so you're just making</font><font color="#CCCCCC"> this</font>

1168
00:44:00,859 --> 00:44:05,630
more<font color="#E5E5E5"> complicated for yourself because</font>

1169
00:44:02,630 --> 00:44:07,490
<font color="#E5E5E5">the the attackers aren't going to be</font>

1170
00:44:05,630 --> 00:44:10,160
confused<font color="#E5E5E5"> through this level</font><font color="#CCCCCC"> of obscurity</font>

1171
00:44:07,490 --> 00:44:11,450
they're just<font color="#E5E5E5"> gonna go oh it's Dave</font><font color="#CCCCCC"> yeah</font>

1172
00:44:10,160 --> 00:44:12,950
that's the domain<font color="#E5E5E5"> admin</font><font color="#CCCCCC"> accounts so</font>

1173
00:44:11,450 --> 00:44:16,759
where's Dave oh he logs on over here

1174
00:44:12,950 --> 00:44:17,868
<font color="#E5E5E5">okay sure I can do that so we want to</font>

1175
00:44:16,760 --> 00:44:19,790
make sure<font color="#E5E5E5"> that we have distinct naming</font>

1176
00:44:17,869 --> 00:44:21,680
why is this important

1177
00:44:19,790 --> 00:44:24,710
because we can programmatically and

1178
00:44:21,680 --> 00:44:27,319
automatically identify if an<font color="#CCCCCC"> ata account</font>

1179
00:44:24,710 --> 00:44:29,140
logs<font color="#E5E5E5"> on</font><font color="#CCCCCC"> to a workstation</font><font color="#E5E5E5"> hopefully we're</font>

1180
00:44:27,320 --> 00:44:31,850
monitoring and pulling back<font color="#E5E5E5"> those logs</font>

1181
00:44:29,140 --> 00:44:33,740
but we can identify that<font color="#CCCCCC"> we can identify</font>

1182
00:44:31,850 --> 00:44:36,200
when account is<font color="#CCCCCC"> logging on where they</font>

1183
00:44:33,740 --> 00:44:38,240
shouldn't<font color="#E5E5E5"> and</font><font color="#CCCCCC"> hopefully we're also using</font>

1184
00:44:36,200 --> 00:44:39,589
technical controls like<font color="#CCCCCC"> your policy to</font>

1185
00:44:38,240 --> 00:44:42,319
<font color="#E5E5E5">prevent them from logging on</font><font color="#CCCCCC"> to those</font>

1186
00:44:39,590 --> 00:44:44,390
<font color="#E5E5E5">systems as well but short of that</font><font color="#CCCCCC"> we can</font>

1187
00:44:42,320 --> 00:44:46,970
at least<font color="#E5E5E5"> identify when they are we can</font>

1188
00:44:44,390 --> 00:44:49,009
also use this to<font color="#CCCCCC"> identify when a non</font><font color="#E5E5E5"> ata</font>

1189
00:44:46,970 --> 00:44:50,149
count gets added<font color="#E5E5E5"> to</font><font color="#CCCCCC"> a group that it</font>

1190
00:44:49,010 --> 00:44:52,550
shouldn't<font color="#E5E5E5"> be because someone made a</font>

1191
00:44:50,150 --> 00:44:54,470
mistake<font color="#CCCCCC"> and we can track through that</font>

1192
00:44:52,550 --> 00:44:57,020
member group membership recursively<font color="#E5E5E5"> and</font>

1193
00:44:54,470 --> 00:44:59,089
<font color="#E5E5E5">go a daa-daa</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> wait there's an</font><font color="#CCCCCC"> SI</font>

1194
00:44:57,020 --> 00:45:01,940
account here what happened<font color="#E5E5E5"> where did our</font>

1195
00:44:59,090 --> 00:45:04,490
process<font color="#E5E5E5"> break down this way we can</font>

1196
00:45:01,940 --> 00:45:06,500
<font color="#CCCCCC">ensure that we know who's a</font><font color="#E5E5E5"> member of</font>

1197
00:45:04,490 --> 00:45:09,229
what group and should they belong there

1198
00:45:06,500 --> 00:45:11,060
at<font color="#E5E5E5"> least at a point and then we have</font>

1199
00:45:09,230 --> 00:45:13,190
controls around<font color="#E5E5E5"> those</font><font color="#CCCCCC"> ATA accounts</font><font color="#E5E5E5"> like</font>

1200
00:45:11,060 --> 00:45:15,470
putting all<font color="#E5E5E5"> the ADA accounts into</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> ad</font>

1201
00:45:13,190 --> 00:45:18,410
a group and then using group policy to

1202
00:45:15,470 --> 00:45:20,120
<font color="#E5E5E5">deny</font><font color="#CCCCCC"> logon for all</font><font color="#E5E5E5"> of our</font><font color="#CCCCCC"> other systems</font>

1203
00:45:18,410 --> 00:45:24,140
<font color="#CCCCCC">that those</font><font color="#E5E5E5"> ATA accounts shouldn't log on</font>

1204
00:45:20,120 --> 00:45:26,569
<font color="#E5E5E5">to but</font><font color="#CCCCCC"> i probably spend most of my time</font>

1205
00:45:24,140 --> 00:45:29,029
talking<font color="#CCCCCC"> to customers</font><font color="#E5E5E5"> about this why</font><font color="#CCCCCC"> are</font>

1206
00:45:26,570 --> 00:45:31,070
admin workstations important hopefully

1207
00:45:29,030 --> 00:45:32,390
at this point<font color="#E5E5E5"> in this presentation we</font>

1208
00:45:31,070 --> 00:45:35,000
all have a good<font color="#E5E5E5"> idea of why they are</font>

1209
00:45:32,390 --> 00:45:38,060
important ultimately<font color="#CCCCCC"> we have moved from</font>

1210
00:45:35,000 --> 00:45:41,030
<font color="#E5E5E5">the from the stage of we need to protect</font>

1211
00:45:38,060 --> 00:45:43,009
our<font color="#E5E5E5"> and and set up these really strong</font>

1212
00:45:41,030 --> 00:45:44,600
boundaries for our perimeter to our

1213
00:45:43,010 --> 00:45:46,340
<font color="#CCCCCC">workstation is where the ballot battle</font>

1214
00:45:44,600 --> 00:45:47,480
is being fought and we already<font color="#E5E5E5"> know that</font>

1215
00:45:46,340 --> 00:45:49,430
<font color="#E5E5E5">there are a lot of counts that have</font>

1216
00:45:47,480 --> 00:45:52,100
access and administrative rights or

1217
00:45:49,430 --> 00:45:54,350
regular<font color="#E5E5E5"> workstations and we know that</font>

1218
00:45:52,100 --> 00:45:59,839
<font color="#CCCCCC">people jump from those two to other</font>

1219
00:45:54,350 --> 00:46:01,730
systems<font color="#E5E5E5"> and the the issue with agents is</font>

1220
00:45:59,840 --> 00:46:03,860
that if they<font color="#E5E5E5"> can install and run code</font>

1221
00:46:01,730 --> 00:46:06,500
<font color="#E5E5E5">they typically have admin or system</font>

1222
00:46:03,860 --> 00:46:08,000
rights<font color="#E5E5E5"> and hopefully they're not</font><font color="#CCCCCC"> running</font>

1223
00:46:06,500 --> 00:46:09,380
as a service account that's a member of

1224
00:46:08,000 --> 00:46:12,110
domain admins because that would be a

1225
00:46:09,380 --> 00:46:13,940
really<font color="#E5E5E5"> big problem so just a little</font>

1226
00:46:12,110 --> 00:46:15,680
<font color="#E5E5E5">while ago Swift on security put-put</font>

1227
00:46:13,940 --> 00:46:17,120
<font color="#E5E5E5">tweeted this out and said funny how the</font>

1228
00:46:15,680 --> 00:46:19,100
ransomware stories in the news didn't

1229
00:46:17,120 --> 00:46:21,440
<font color="#E5E5E5">impact employees who weren't on the VPN</font>

1230
00:46:19,100 --> 00:46:22,819
<font color="#E5E5E5">your users are safer at</font><font color="#CCCCCC"> McDonalds and</font>

1231
00:46:21,440 --> 00:46:27,050
connecting<font color="#E5E5E5"> to most of your enterprise</font>

1232
00:46:22,820 --> 00:46:29,120
networks why is that<font color="#E5E5E5"> why is that that's</font>

1233
00:46:27,050 --> 00:46:30,860
because we have flat networks<font color="#E5E5E5"> and it's</font>

1234
00:46:29,120 --> 00:46:32,630
too easy<font color="#E5E5E5"> to jump from one</font><font color="#CCCCCC"> system to the</font>

1235
00:46:30,860 --> 00:46:33,890
<font color="#E5E5E5">other</font><font color="#CCCCCC"> because we haven't set up the</font>

1236
00:46:32,630 --> 00:46:35,810
<font color="#E5E5E5">controls</font><font color="#CCCCCC"> that</font>

1237
00:46:33,890 --> 00:46:38,029
we're at a point now<font color="#CCCCCC"> where we</font><font color="#E5E5E5"> need</font>

1238
00:46:35,810 --> 00:46:39,770
host-based firewalls<font color="#E5E5E5"> on all our</font>

1239
00:46:38,030 --> 00:46:40,940
workstations<font color="#E5E5E5"> there's no need for one</font>

1240
00:46:39,770 --> 00:46:42,950
workstation<font color="#CCCCCC"> that connects in the other</font>

1241
00:46:40,940 --> 00:46:46,490
<font color="#CCCCCC">oh but Sean we have printers</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> are</font>

1242
00:46:42,950 --> 00:46:48,799
shared<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> by some network printers</font><font color="#CCCCCC"> I'm</font>

1243
00:46:46,490 --> 00:46:51,410
sorry they're like<font color="#E5E5E5"> 500 bucks</font><font color="#CCCCCC"> or 500</font>

1244
00:46:48,800 --> 00:46:53,300
euros<font color="#CCCCCC"> that that's where we're at now we</font>

1245
00:46:51,410 --> 00:46:56,029
need to get<font color="#E5E5E5"> to the point where we block</font>

1246
00:46:53,300 --> 00:46:57,920
the default open<font color="#CCCCCC"> access that we used to</font>

1247
00:46:56,030 --> 00:46:59,210
have most of us<font color="#E5E5E5"> don't work in</font>

1248
00:46:57,920 --> 00:47:01,850
universities<font color="#CCCCCC"> I worked at a university</font>

1249
00:46:59,210 --> 00:47:04,250
<font color="#E5E5E5">before and they had a very open policy</font>

1250
00:47:01,850 --> 00:47:06,290
they even<font color="#E5E5E5"> changed that in the past</font>

1251
00:47:04,250 --> 00:47:09,020
number of<font color="#E5E5E5"> years because</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the fact that</font>

1252
00:47:06,290 --> 00:47:10,520
the threats have changed<font color="#E5E5E5"> they've gotten</font>

1253
00:47:09,020 --> 00:47:12,380
<font color="#CCCCCC">more complex it's more difficult to</font>

1254
00:47:10,520 --> 00:47:15,140
protect<font color="#CCCCCC"> the environment now with an open</font>

1255
00:47:12,380 --> 00:47:16,370
policy<font color="#E5E5E5"> so we</font><font color="#CCCCCC"> want to make sure</font><font color="#E5E5E5"> we</font>

1256
00:47:15,140 --> 00:47:17,839
isolate<font color="#CCCCCC"> and protect</font><font color="#E5E5E5"> these privileged</font>

1257
00:47:16,370 --> 00:47:21,770
credentials we have our<font color="#E5E5E5"> 80 admin</font>

1258
00:47:17,840 --> 00:47:23,630
accounts we need to know<font color="#E5E5E5"> actually just</font>

1259
00:47:21,770 --> 00:47:25,310
<font color="#E5E5E5">to show of hands who</font><font color="#CCCCCC"> here knows a</font>

1260
00:47:23,630 --> 00:47:27,230
hundred percent<font color="#E5E5E5"> where all of their</font>

1261
00:47:25,310 --> 00:47:34,310
domain admin accounts log<font color="#E5E5E5"> on to in their</font>

1262
00:47:27,230 --> 00:47:35,960
network<font color="#CCCCCC"> ok so like</font><font color="#E5E5E5"> five six</font><font color="#CCCCCC"> ok that's</font>

1263
00:47:34,310 --> 00:47:37,759
part of what we<font color="#CCCCCC"> need to figure out in</font>

1264
00:47:35,960 --> 00:47:39,560
order<font color="#CCCCCC"> to better identify this</font><font color="#E5E5E5"> things</font>

1265
00:47:37,760 --> 00:47:41,210
<font color="#E5E5E5">like bloodhound will help us</font><font color="#CCCCCC"> identify</font>

1266
00:47:39,560 --> 00:47:43,400
where accounts are logging on

1267
00:47:41,210 --> 00:47:45,380
interactively but they don't always tell

1268
00:47:43,400 --> 00:47:48,430
the<font color="#E5E5E5"> story</font><font color="#CCCCCC"> about who</font><font color="#E5E5E5"> where if someone</font><font color="#CCCCCC"> is</font>

1269
00:47:45,380 --> 00:47:49,550
<font color="#E5E5E5">already peeing from</font><font color="#CCCCCC"> - which is another</font>

1270
00:47:48,430 --> 00:47:53,839
second

1271
00:47:49,550 --> 00:47:54,920
second factor consequence of<font color="#E5E5E5"> this we</font>

1272
00:47:53,840 --> 00:47:56,600
want<font color="#E5E5E5"> to make</font><font color="#CCCCCC"> sure that we have</font><font color="#E5E5E5"> the</font>

1273
00:47:54,920 --> 00:47:58,010
secure administrative environment for

1274
00:47:56,600 --> 00:48:01,100
our admins and that they're forced<font color="#CCCCCC"> to</font>

1275
00:47:58,010 --> 00:48:04,160
use it<font color="#E5E5E5"> because</font><font color="#CCCCCC"> ultimately the common</font>

1276
00:48:01,100 --> 00:48:05,540
attacker<font color="#E5E5E5"> playbook is chapter</font><font color="#CCCCCC"> one we drop</font>

1277
00:48:04,160 --> 00:48:07,640
on<font color="#E5E5E5"> this workstation we dump the</font>

1278
00:48:05,540 --> 00:48:10,790
credentials<font color="#CCCCCC"> oh look</font><font color="#E5E5E5"> we have a domain</font>

1279
00:48:07,640 --> 00:48:13,009
admin account or oh look the same local

1280
00:48:10,790 --> 00:48:14,750
<font color="#E5E5E5">admin account and</font><font color="#CCCCCC"> password or on all</font>

1281
00:48:13,010 --> 00:48:17,110
over<font color="#CCCCCC"> workstations</font><font color="#E5E5E5"> and then we just</font>

1282
00:48:14,750 --> 00:48:19,460
spread<font color="#E5E5E5"> out and then we move from there</font>

1283
00:48:17,110 --> 00:48:24,260
so<font color="#E5E5E5"> we want to make sure that our admin</font>

1284
00:48:19,460 --> 00:48:26,930
<font color="#CCCCCC">ik admin accounts can log on to this -</font>

1285
00:48:24,260 --> 00:48:28,340
the special system<font color="#E5E5E5"> but with not no admin</font>

1286
00:48:26,930 --> 00:48:29,750
rights<font color="#E5E5E5"> so when we're talking about an</font>

1287
00:48:28,340 --> 00:48:31,970
<font color="#E5E5E5">admiral workstation we want to make</font><font color="#CCCCCC"> sure</font>

1288
00:48:29,750 --> 00:48:34,010
that we limit<font color="#E5E5E5"> these and protect these</font>

1289
00:48:31,970 --> 00:48:36,529
better<font color="#E5E5E5"> than what we do with everything</font>

1290
00:48:34,010 --> 00:48:38,360
else<font color="#E5E5E5"> we have an admin workstation we</font>

1291
00:48:36,530 --> 00:48:41,240
want to look at this and hold this up<font color="#CCCCCC"> to</font>

1292
00:48:38,360 --> 00:48:42,740
<font color="#CCCCCC">our highest</font><font color="#E5E5E5"> security standard we want to</font>

1293
00:48:41,240 --> 00:48:44,180
fire all<font color="#CCCCCC"> of them off we want</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> protect</font>

1294
00:48:42,740 --> 00:48:46,069
that that<font color="#CCCCCC"> network</font><font color="#E5E5E5"> communication we want</font>

1295
00:48:44,180 --> 00:48:47,118
to make sure<font color="#E5E5E5"> that just any random system</font>

1296
00:48:46,070 --> 00:48:49,249
<font color="#CCCCCC">on the network can't</font>

1297
00:48:47,119 --> 00:48:52,069
just connect to<font color="#E5E5E5"> it and ask it for some</font>

1298
00:48:49,249 --> 00:48:53,509
<font color="#E5E5E5">information</font><font color="#CCCCCC"> and one</font><font color="#E5E5E5"> of the most</font>

1299
00:48:52,069 --> 00:48:55,970
important<font color="#E5E5E5"> things you</font><font color="#CCCCCC"> can do is enforce</font>

1300
00:48:53,509 --> 00:48:57,619
<font color="#CCCCCC">nla for all RDP sessions</font><font color="#E5E5E5"> this is the</font>

1301
00:48:55,970 --> 00:48:59,149
thing where when you're doing an RDP

1302
00:48:57,619 --> 00:49:00,859
connection to a system it pops up that

1303
00:48:59,150 --> 00:49:01,549
<font color="#E5E5E5">little box this is what's your username</font>

1304
00:49:00,859 --> 00:49:04,640
and<font color="#E5E5E5"> password</font>

1305
00:49:01,549 --> 00:49:06,259
why is this important<font color="#E5E5E5"> there's a number</font>

1306
00:49:04,640 --> 00:49:09,879
<font color="#CCCCCC">of really well-known and</font><font color="#E5E5E5"> understood</font>

1307
00:49:06,259 --> 00:49:12,559
persistence methods for leveraging

1308
00:49:09,880 --> 00:49:14,329
accessibility options like util<font color="#CCCCCC"> man and</font>

1309
00:49:12,559 --> 00:49:15,829
some of the others where all you have<font color="#CCCCCC"> to</font>

1310
00:49:14,329 --> 00:49:18,019
do is already<font color="#E5E5E5"> P to the to the system</font>

1311
00:49:15,829 --> 00:49:19,910
<font color="#E5E5E5">that you had before</font><font color="#CCCCCC"> and LA is disabled</font>

1312
00:49:18,019 --> 00:49:20,749
<font color="#CCCCCC">you just hit shift 5 times it pops up</font><font color="#E5E5E5"> a</font>

1313
00:49:19,910 --> 00:49:22,279
system<font color="#E5E5E5"> box</font>

1314
00:49:20,749 --> 00:49:24,379
it's like movie hacking it's brilliant

1315
00:49:22,279 --> 00:49:26,390
<font color="#E5E5E5">but this protects against that sort</font><font color="#CCCCCC"> of</font>

1316
00:49:24,380 --> 00:49:27,710
thing<font color="#E5E5E5"> and we want to make</font><font color="#CCCCCC"> sure that we</font>

1317
00:49:26,390 --> 00:49:30,650
<font color="#E5E5E5">protect our systems as best as possible</font>

1318
00:49:27,710 --> 00:49:35,180
and of course<font color="#E5E5E5"> MFA is very important as</font>

1319
00:49:30,650 --> 00:49:36,430
part<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this hardening process so raise</font>

1320
00:49:35,180 --> 00:49:39,169
your<font color="#CCCCCC"> hand if</font><font color="#E5E5E5"> you've seen this before</font>

1321
00:49:36,430 --> 00:49:42,200
<font color="#CCCCCC">keep your hand up if you feel like it is</font>

1322
00:49:39,170 --> 00:49:46,609
feasible<font color="#E5E5E5"> can be implemented</font><font color="#CCCCCC"> and/or you</font>

1323
00:49:42,200 --> 00:49:48,819
have implemented this fully<font color="#E5E5E5"> I am</font>

1324
00:49:46,609 --> 00:49:51,288
impressed<font color="#CCCCCC"> I am</font><font color="#E5E5E5"> very impressed</font><font color="#CCCCCC"> that</font>

1325
00:49:48,819 --> 00:49:53,538
<font color="#CCCCCC">there's there's a</font><font color="#E5E5E5"> couple of hands that</font>

1326
00:49:51,289 --> 00:49:56,059
were mostly<font color="#CCCCCC"> out for this because</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

1327
00:49:53,539 --> 00:49:58,569
<font color="#E5E5E5">very difficult</font><font color="#CCCCCC"> usually when I show this</font>

1328
00:49:56,059 --> 00:50:05,930
slide<font color="#E5E5E5"> or talk to customers about this I</font>

1329
00:49:58,569 --> 00:50:08,119
see them mentally doing this if that's a

1330
00:50:05,930 --> 00:50:10,129
problem<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is like the key way to</font>

1331
00:50:08,119 --> 00:50:11,839
protect our environment<font color="#CCCCCC"> and no one can</font>

1332
00:50:10,130 --> 00:50:14,749
<font color="#E5E5E5">do</font><font color="#CCCCCC"> it this is</font><font color="#E5E5E5"> what Microsoft has on</font>

1333
00:50:11,839 --> 00:50:17,089
their website<font color="#CCCCCC"> today</font><font color="#E5E5E5"> under securing</font>

1334
00:50:14,749 --> 00:50:19,939
privileged access<font color="#E5E5E5"> so I'm going to</font>

1335
00:50:17,089 --> 00:50:23,480
simplify<font color="#E5E5E5"> this and let's go from this to</font>

1336
00:50:19,940 --> 00:50:25,309
<font color="#CCCCCC">this</font><font color="#E5E5E5"> let's focus on our</font><font color="#CCCCCC"> tier</font><font color="#E5E5E5"> 0 let's</font>

1337
00:50:23,480 --> 00:50:27,200
focus on<font color="#CCCCCC"> our domain</font><font color="#E5E5E5"> admins let's focus</font>

1338
00:50:25,309 --> 00:50:29,480
on our<font color="#CCCCCC"> domain controllers let's focus on</font>

1339
00:50:27,200 --> 00:50:31,700
our<font color="#CCCCCC"> Adger 80 connect server if you have</font>

1340
00:50:29,480 --> 00:50:33,650
<font color="#E5E5E5">if you have office</font><font color="#CCCCCC"> 365 you probably have</font>

1341
00:50:31,700 --> 00:50:35,538
as your ad<font color="#E5E5E5"> connect and it's very likely</font>

1342
00:50:33,650 --> 00:50:37,609
you've enabled password hash sync if

1343
00:50:35,539 --> 00:50:39,440
you've enabled password hash sync your

1344
00:50:37,609 --> 00:50:40,660
azure ad<font color="#CCCCCC"> Connect server needs to be</font>

1345
00:50:39,440 --> 00:50:42,890
<font color="#CCCCCC">protected like a domain controller</font>

1346
00:50:40,660 --> 00:50:44,089
<font color="#E5E5E5">because it's requesting the password</font>

1347
00:50:42,890 --> 00:50:46,819
hashes from<font color="#E5E5E5"> the domain controllers in</font>

1348
00:50:44,089 --> 00:50:48,650
<font color="#E5E5E5">that domain every two minutes and they</font>

1349
00:50:46,819 --> 00:50:50,839
flow through<font color="#E5E5E5"> and then they get hashed</font>

1350
00:50:48,650 --> 00:50:53,450
again to be sent up<font color="#CCCCCC"> to officer 65 in</font>

1351
00:50:50,839 --> 00:50:55,999
<font color="#E5E5E5">Azure ad these are the things we need</font><font color="#CCCCCC"> to</font>

1352
00:50:53,450 --> 00:50:58,129
protect<font color="#E5E5E5"> ad FS Federation needs to be</font>

1353
00:50:55,999 --> 00:51:00,019
<font color="#CCCCCC">protected to this level</font><font color="#E5E5E5"> because your ad</font>

1354
00:50:58,130 --> 00:51:00,620
FS servers are your domain<font color="#CCCCCC"> controllers</font>

1355
00:51:00,019 --> 00:51:05,000
<font color="#E5E5E5">for all</font>

1356
00:51:00,620 --> 00:51:07,160
your cloud access<font color="#E5E5E5"> so focus on tier</font><font color="#CCCCCC"> zero</font>

1357
00:51:05,000 --> 00:51:09,950
because that<font color="#CCCCCC"> will give you the the most</font>

1358
00:51:07,160 --> 00:51:11,149
value for what you're trying<font color="#CCCCCC"> to do like</font>

1359
00:51:09,950 --> 00:51:13,069
I said<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> very difficult to do this</font>

1360
00:51:11,150 --> 00:51:14,710
<font color="#E5E5E5">few have actually implemented I know of</font>

1361
00:51:13,070 --> 00:51:17,840
<font color="#E5E5E5">only a couple</font><font color="#CCCCCC"> of organizations that</font><font color="#E5E5E5"> have</font>

1362
00:51:14,710 --> 00:51:19,310
so let's not focus<font color="#E5E5E5"> so much on all of it</font>

1363
00:51:17,840 --> 00:51:21,530
let's focus on the<font color="#E5E5E5"> things that are going</font>

1364
00:51:19,310 --> 00:51:23,390
<font color="#CCCCCC">to be the most</font><font color="#E5E5E5"> critical like protecting</font>

1365
00:51:21,530 --> 00:51:25,630
our<font color="#CCCCCC"> 80 admin accounts protecting</font><font color="#E5E5E5"> our</font>

1366
00:51:23,390 --> 00:51:27,980
domain controllers<font color="#CCCCCC"> protect me Roger 80</font>

1367
00:51:25,630 --> 00:51:29,510
<font color="#CCCCCC">connect servers protecting our ad FS</font>

1368
00:51:27,980 --> 00:51:32,120
servers and all the other ones<font color="#E5E5E5"> that a</font>

1369
00:51:29,510 --> 00:51:35,840
they get<font color="#E5E5E5"> captured in that section in</font>

1370
00:51:32,120 --> 00:51:37,970
that area so tier<font color="#CCCCCC"> 0 like I said it's all</font>

1371
00:51:35,840 --> 00:51:40,190
of those things<font color="#CCCCCC"> that</font><font color="#E5E5E5"> are a critical</font>

1372
00:51:37,970 --> 00:51:42,680
infrastructure<font color="#E5E5E5"> anything the passwords</font>

1373
00:51:40,190 --> 00:51:44,810
are flowing<font color="#CCCCCC"> through this could be any</font>

1374
00:51:42,680 --> 00:51:47,960
system that<font color="#E5E5E5"> is handling your</font><font color="#CCCCCC"> Federation</font>

1375
00:51:44,810 --> 00:51:49,279
as I mentioned or your<font color="#CCCCCC"> PTI we want to</font>

1376
00:51:47,960 --> 00:51:51,830
make sure<font color="#E5E5E5"> we protect these at a very</font>

1377
00:51:49,280 --> 00:51:53,990
high<font color="#CCCCCC"> level because of the risk the</font>

1378
00:51:51,830 --> 00:51:56,960
threat<font color="#E5E5E5"> of what happens when these get</font>

1379
00:51:53,990 --> 00:51:58,910
compromised<font color="#CCCCCC"> any of them so the challenge</font>

1380
00:51:56,960 --> 00:52:01,460
I have<font color="#CCCCCC"> is convincing admins that admin</font>

1381
00:51:58,910 --> 00:52:04,339
workstations<font color="#E5E5E5"> are in critical because</font>

1382
00:52:01,460 --> 00:52:07,190
<font color="#CCCCCC">often times</font><font color="#E5E5E5"> who are the people</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> have</font>

1383
00:52:04,340 --> 00:52:09,080
to implement<font color="#CCCCCC"> these I literally say</font>

1384
00:52:07,190 --> 00:52:11,750
here's the configuration here's the

1385
00:52:09,080 --> 00:52:14,060
workstation<font color="#E5E5E5"> setup everything in AD it's</font>

1386
00:52:11,750 --> 00:52:15,440
our<font color="#CCCCCC"> 80 admins</font><font color="#E5E5E5"> and they are less than</font>

1387
00:52:14,060 --> 00:52:18,049
thrilled to hear that<font color="#CCCCCC"> they have</font><font color="#E5E5E5"> to do</font>

1388
00:52:15,440 --> 00:52:20,840
something<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> going to add more to</font>

1389
00:52:18,050 --> 00:52:24,410
getting a ticket closed<font color="#E5E5E5"> or getting work</font>

1390
00:52:20,840 --> 00:52:26,360
<font color="#CCCCCC">done</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> we have to talk to them</font><font color="#E5E5E5"> work</font>

1391
00:52:24,410 --> 00:52:28,339
with them in a<font color="#CCCCCC"> way that's going to</font><font color="#E5E5E5"> be</font>

1392
00:52:26,360 --> 00:52:30,230
<font color="#CCCCCC">very collaborative</font><font color="#E5E5E5"> we have to talk</font><font color="#CCCCCC"> about</font>

1393
00:52:28,340 --> 00:52:33,710
<font color="#E5E5E5">what the threat is</font><font color="#CCCCCC"> we have to talk about</font>

1394
00:52:30,230 --> 00:52:35,240
what's<font color="#CCCCCC"> possible the Microsoft Surface</font>

1395
00:52:33,710 --> 00:52:36,890
devices are a nice small<font color="#CCCCCC"> lightweight</font>

1396
00:52:35,240 --> 00:52:38,629
they work great<font color="#E5E5E5"> they support all the</font>

1397
00:52:36,890 --> 00:52:40,069
windows send<font color="#E5E5E5"> security features</font><font color="#CCCCCC"> I don't</font>

1398
00:52:38,630 --> 00:52:41,360
make anything from Microsoft by saying

1399
00:52:40,070 --> 00:52:43,670
that<font color="#E5E5E5"> but I</font>

1400
00:52:41,360 --> 00:52:45,830
I<font color="#CCCCCC"> like the</font><font color="#E5E5E5"> systems that's a nice second</font>

1401
00:52:43,670 --> 00:52:49,040
<font color="#E5E5E5">system in order to</font><font color="#CCCCCC"> be that the admin</font>

1402
00:52:45,830 --> 00:52:50,509
<font color="#E5E5E5">workstation I've talked to customers</font>

1403
00:52:49,040 --> 00:52:52,670
<font color="#CCCCCC">about some other</font><font color="#E5E5E5"> ways that</font><font color="#CCCCCC"> they can</font>

1404
00:52:50,510 --> 00:52:53,900
configure this so they<font color="#CCCCCC"> can have an admin</font>

1405
00:52:52,670 --> 00:52:55,760
system<font color="#E5E5E5"> that's workable in their</font>

1406
00:52:53,900 --> 00:52:57,230
environment<font color="#E5E5E5"> but then the</font><font color="#CCCCCC"> other part of</font>

1407
00:52:55,760 --> 00:53:00,610
this<font color="#CCCCCC"> is management</font><font color="#E5E5E5"> has to be convinced</font>

1408
00:52:57,230 --> 00:53:02,630
<font color="#E5E5E5">tickets are now going to take 20%</font><font color="#CCCCCC"> longer</font>

1409
00:53:00,610 --> 00:53:04,550
it's<font color="#E5E5E5"> going to take longer to get these</font>

1410
00:53:02,630 --> 00:53:07,670
<font color="#E5E5E5">things solved it's going to take more</font>

1411
00:53:04,550 --> 00:53:10,040
effort<font color="#E5E5E5"> we have hardware costs but here's</font>

1412
00:53:07,670 --> 00:53:13,430
the thing<font color="#CCCCCC"> all of this is cheaper than</font>

1413
00:53:10,040 --> 00:53:14,600
recovering<font color="#CCCCCC"> from a breach</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> fireEye</font>

1414
00:53:13,430 --> 00:53:18,649
<font color="#E5E5E5">crowds try</font>

1415
00:53:14,600 --> 00:53:20,600
<font color="#CCCCCC">all of the IRS very expensive</font><font color="#E5E5E5"> and many</font>

1416
00:53:18,650 --> 00:53:21,410
<font color="#CCCCCC">organizations have</font><font color="#E5E5E5"> to pay them a</font>

1417
00:53:20,600 --> 00:53:23,089
retainer

1418
00:53:21,410 --> 00:53:24,770
just in case stuff<font color="#E5E5E5"> happens because of</font>

1419
00:53:23,090 --> 00:53:26,930
<font color="#E5E5E5">their</font><font color="#CCCCCC"> insurance requirements the</font>

1420
00:53:24,770 --> 00:53:29,420
retainer is still cheaper than<font color="#CCCCCC"> having to</font>

1421
00:53:26,930 --> 00:53:31,339
go through<font color="#CCCCCC"> the breach</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> then you</font>

1422
00:53:29,420 --> 00:53:32,780
then you<font color="#CCCCCC"> have</font><font color="#E5E5E5"> all your staff some of</font>

1423
00:53:31,340 --> 00:53:35,570
your best<font color="#E5E5E5"> people in your organization</font>

1424
00:53:32,780 --> 00:53:38,150
working 80 hours<font color="#E5E5E5"> 100 hours 120 hours a</font>

1425
00:53:35,570 --> 00:53:39,830
week for<font color="#E5E5E5"> however long it takes</font><font color="#CCCCCC"> and then</font>

1426
00:53:38,150 --> 00:53:43,040
once the breach is over they go back to

1427
00:53:39,830 --> 00:53:45,290
their nine-to-five<font color="#E5E5E5"> or or work in their</font>

1428
00:53:43,040 --> 00:53:49,060
60 or 70 hours<font color="#CCCCCC"> to try to do</font><font color="#E5E5E5"> all the</font>

1429
00:53:45,290 --> 00:53:50,900
recovery<font color="#E5E5E5"> stuff so when we talk about</font>

1430
00:53:49,060 --> 00:53:52,370
convincing management this<font color="#E5E5E5"> is an</font>

1431
00:53:50,900 --> 00:53:53,690
important part<font color="#CCCCCC"> of it</font><font color="#E5E5E5"> because we need to</font>

1432
00:53:52,370 --> 00:53:56,180
get to a<font color="#E5E5E5"> point where we have a workable</font>

1433
00:53:53,690 --> 00:53:59,540
<font color="#E5E5E5">admin system separate</font><font color="#CCCCCC"> physical devices</font>

1434
00:53:56,180 --> 00:54:02,029
<font color="#E5E5E5">is best but we can use a virtual system</font>

1435
00:53:59,540 --> 00:54:04,880
in order<font color="#E5E5E5"> to get that working in order to</font>

1436
00:54:02,030 --> 00:54:08,000
get it<font color="#CCCCCC"> implemented</font><font color="#E5E5E5"> we don't want best to</font>

1437
00:54:04,880 --> 00:54:10,340
be the<font color="#CCCCCC"> enemy of</font><font color="#E5E5E5"> good we want</font><font color="#CCCCCC"> something</font>

1438
00:54:08,000 --> 00:54:13,280
better than what<font color="#CCCCCC"> we have today and so</font>

1439
00:54:10,340 --> 00:54:15,380
with a virtual<font color="#E5E5E5"> environment</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> can have</font>

1440
00:54:13,280 --> 00:54:17,360
the host<font color="#CCCCCC"> OS as the admin environment and</font>

1441
00:54:15,380 --> 00:54:19,430
the user environment is the VM on the

1442
00:54:17,360 --> 00:54:21,380
system so we can<font color="#E5E5E5"> have one</font><font color="#CCCCCC"> system where</font>

1443
00:54:19,430 --> 00:54:23,620
they're able to do their administration

1444
00:54:21,380 --> 00:54:27,230
as well<font color="#E5E5E5"> as</font><font color="#CCCCCC"> do all the user activities</font>

1445
00:54:23,620 --> 00:54:29,779
<font color="#CCCCCC">and then they're going to log on</font><font color="#E5E5E5"> to the</font>

1446
00:54:27,230 --> 00:54:31,040
<font color="#CCCCCC">system using</font><font color="#E5E5E5"> a transition account as I</font>

1447
00:54:29,780 --> 00:54:33,890
mentioned<font color="#CCCCCC"> before it</font><font color="#E5E5E5"> doesn't have any</font>

1448
00:54:31,040 --> 00:54:35,420
rights on the system<font color="#E5E5E5"> in some instances</font>

1449
00:54:33,890 --> 00:54:37,009
you<font color="#CCCCCC"> can even use that admin admin</font>

1450
00:54:35,420 --> 00:54:39,050
account<font color="#E5E5E5"> on depending on the</font>

1451
00:54:37,010 --> 00:54:41,180
configuration<font color="#CCCCCC"> and then manage your</font>

1452
00:54:39,050 --> 00:54:45,170
environment from that system<font color="#CCCCCC"> by using</font>

1453
00:54:41,180 --> 00:54:46,549
RDP to connect to your admin server so

1454
00:54:45,170 --> 00:54:47,960
there<font color="#E5E5E5"> are challenges</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> this but</font>

1455
00:54:46,550 --> 00:54:50,210
<font color="#E5E5E5">effectively this</font><font color="#CCCCCC"> is what it looks from</font><font color="#E5E5E5"> a</font>

1456
00:54:47,960 --> 00:54:52,460
visual<font color="#E5E5E5"> perspective regular user account</font>

1457
00:54:50,210 --> 00:54:54,500
logs<font color="#CCCCCC"> onto</font><font color="#E5E5E5"> the user VM transition account</font>

1458
00:54:52,460 --> 00:54:56,120
<font color="#CCCCCC">or in some cases the admin account but</font>

1459
00:54:54,500 --> 00:54:58,310
<font color="#E5E5E5">ultimately your ad admin account is</font>

1460
00:54:56,120 --> 00:54:59,870
going to RDP into<font color="#CCCCCC"> your admin server this</font>

1461
00:54:58,310 --> 00:55:02,060
<font color="#E5E5E5">way we can isolate protect our</font>

1462
00:54:59,870 --> 00:55:04,790
<font color="#E5E5E5">credentials and we don't want to reverse</font>

1463
00:55:02,060 --> 00:55:06,470
<font color="#E5E5E5">this scenario where we have our admin</font>

1464
00:55:04,790 --> 00:55:09,170
workstation in a VM and<font color="#E5E5E5"> our user</font>

1465
00:55:06,470 --> 00:55:11,299
environment in the<font color="#E5E5E5"> host because</font><font color="#CCCCCC"> then</font>

1466
00:55:09,170 --> 00:55:13,040
we're sending privileged credentials

1467
00:55:11,300 --> 00:55:16,280
through<font color="#E5E5E5"> an untrusted environment to get</font>

1468
00:55:13,040 --> 00:55:17,960
to a trusted<font color="#E5E5E5"> environment effectively if</font>

1469
00:55:16,280 --> 00:55:20,420
you use a password vault<font color="#CCCCCC"> same type of</font>

1470
00:55:17,960 --> 00:55:21,710
<font color="#E5E5E5">scenario</font><font color="#CCCCCC"> regular user account transition</font>

1471
00:55:20,420 --> 00:55:23,630
account which would then connect into

1472
00:55:21,710 --> 00:55:26,180
<font color="#E5E5E5">the pastor vault to then connect to the</font>

1473
00:55:23,630 --> 00:55:28,040
<font color="#E5E5E5">admin server again hopefully mfh of the</font>

1474
00:55:26,180 --> 00:55:30,020
password vault through

1475
00:55:28,040 --> 00:55:31,640
<font color="#CCCCCC">and so when we're talking about our</font>

1476
00:55:30,020 --> 00:55:32,960
admin workstation<font color="#CCCCCC"> employment we want to</font>

1477
00:55:31,640 --> 00:55:34,970
make sure<font color="#CCCCCC"> we</font><font color="#E5E5E5"> start with</font><font color="#CCCCCC"> ad admins</font>

1478
00:55:32,960 --> 00:55:35,480
<font color="#E5E5E5">virtual infrastructure is</font><font color="#CCCCCC"> extremely</font>

1479
00:55:34,970 --> 00:55:36,890
important

1480
00:55:35,480 --> 00:55:39,290
don't forget about<font color="#CCCCCC"> VMware you have</font>

1481
00:55:36,890 --> 00:55:41,509
virtual<font color="#E5E5E5"> DC's who has administrative</font>

1482
00:55:39,290 --> 00:55:43,550
rights to<font color="#E5E5E5"> your VM environment</font><font color="#CCCCCC"> who knows</font>

1483
00:55:41,510 --> 00:55:45,620
the<font color="#E5E5E5"> root password for your ESX hosts are</font>

1484
00:55:43,550 --> 00:55:47,990
they different<font color="#CCCCCC"> these are things that</font>

1485
00:55:45,620 --> 00:55:50,750
<font color="#E5E5E5">have to</font><font color="#CCCCCC"> be thought about again</font><font color="#E5E5E5"> about who</font>

1486
00:55:47,990 --> 00:55:53,049
has access<font color="#CCCCCC"> to the systems cloud admin</font>

1487
00:55:50,750 --> 00:55:56,120
server admins workstation admins<font color="#E5E5E5"> and</font>

1488
00:55:53,050 --> 00:55:58,790
then<font color="#CCCCCC"> PKI and mainframe admins need admin</font>

1489
00:55:56,120 --> 00:56:02,029
workstations<font color="#CCCCCC"> too those are also critical</font>

1490
00:55:58,790 --> 00:56:04,420
<font color="#E5E5E5">parts of the infrastructure but focus on</font>

1491
00:56:02,030 --> 00:56:06,590
phase<font color="#E5E5E5"> one your Active Directory admins</font>

1492
00:56:04,420 --> 00:56:08,450
because this is the new<font color="#CCCCCC"> standard for ad</font>

1493
00:56:06,590 --> 00:56:10,250
admins they only ever log on to<font color="#CCCCCC"> de</font><font color="#E5E5E5"> main</font>

1494
00:56:08,450 --> 00:56:11,839
controllers<font color="#CCCCCC"> ad admin workstations</font>

1495
00:56:10,250 --> 00:56:13,760
servers<font color="#CCCCCC"> keep them separate from</font>

1496
00:56:11,840 --> 00:56:17,450
<font color="#E5E5E5">everything else and no service counts</font>

1497
00:56:13,760 --> 00:56:18,860
with<font color="#CCCCCC"> AD admin rights because</font><font color="#E5E5E5"> service</font>

1498
00:56:17,450 --> 00:56:20,270
counts are one of<font color="#CCCCCC"> our</font><font color="#E5E5E5"> biggest problems</font>

1499
00:56:18,860 --> 00:56:22,370
in<font color="#E5E5E5"> our environment I would I would</font><font color="#CCCCCC"> argue</font>

1500
00:56:20,270 --> 00:56:24,350
that they probably are outside of<font color="#CCCCCC"> ad</font>

1501
00:56:22,370 --> 00:56:25,880
administration there are members of

1502
00:56:24,350 --> 00:56:28,310
admin groups that have too many<font color="#E5E5E5"> rights</font>

1503
00:56:25,880 --> 00:56:30,680
<font color="#E5E5E5">I've read through a lot of product</font>

1504
00:56:28,310 --> 00:56:31,790
documentation<font color="#E5E5E5"> and this is kind of what</font>

1505
00:56:30,680 --> 00:56:33,319
you end up<font color="#E5E5E5"> seeing and all the</font>

1506
00:56:31,790 --> 00:56:35,960
<font color="#E5E5E5">documentation they need domain user</font>

1507
00:56:33,320 --> 00:56:38,360
<font color="#E5E5E5">domain admins system rights 80 privilege</font>

1508
00:56:35,960 --> 00:56:39,890
rights<font color="#CCCCCC"> and I found that the pattern</font>

1509
00:56:38,360 --> 00:56:41,720
emerged as I was reading<font color="#CCCCCC"> through</font><font color="#E5E5E5"> all</font>

1510
00:56:39,890 --> 00:56:43,580
this documentation<font color="#CCCCCC"> ah</font><font color="#E5E5E5"> my eyes started to</font>

1511
00:56:41,720 --> 00:56:45,290
blur<font color="#E5E5E5"> that</font><font color="#CCCCCC"> there was one thing</font><font color="#E5E5E5"> that they</font>

1512
00:56:43,580 --> 00:56:47,480
<font color="#CCCCCC">all said that they need it and hopefully</font>

1513
00:56:45,290 --> 00:56:49,250
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> see the pattern to you because</font>

1514
00:56:47,480 --> 00:56:51,530
it jumped out<font color="#E5E5E5"> at</font><font color="#CCCCCC"> me that</font><font color="#E5E5E5"> they all want</font>

1515
00:56:49,250 --> 00:56:53,270
<font color="#CCCCCC">to be a member of domain admin and</font>

1516
00:56:51,530 --> 00:56:55,670
there's some common<font color="#E5E5E5"> ones the</font>

1517
00:56:53,270 --> 00:56:57,410
vulnerability scanning tool I hate the

1518
00:56:55,670 --> 00:56:59,030
vulnerability scanning companies don't

1519
00:56:57,410 --> 00:57:01,910
<font color="#E5E5E5">make it easy</font><font color="#CCCCCC"> to have separate accounts</font>

1520
00:56:59,030 --> 00:57:07,190
<font color="#E5E5E5">for separate scans for different classes</font>

1521
00:57:01,910 --> 00:57:09,680
<font color="#CCCCCC">of systems workstations servers</font><font color="#E5E5E5"> domain</font>

1522
00:57:07,190 --> 00:57:11,090
controllers<font color="#CCCCCC"> I always get</font><font color="#E5E5E5"> scared when I</font>

1523
00:57:09,680 --> 00:57:13,879
see one vulnerability<font color="#E5E5E5"> scanning</font>

1524
00:57:11,090 --> 00:57:14,810
<font color="#CCCCCC">accountant domain admins please don't do</font>

1525
00:57:13,880 --> 00:57:17,780
that

1526
00:57:14,810 --> 00:57:19,490
backups<font color="#E5E5E5"> VPN for some reason a VPN</font>

1527
00:57:17,780 --> 00:57:21,590
account was put into the main admins<font color="#CCCCCC"> why</font>

1528
00:57:19,490 --> 00:57:23,509
as it turned out after<font color="#E5E5E5"> asking a lot of</font>

1529
00:57:21,590 --> 00:57:26,270
<font color="#CCCCCC">questions that way if the users password</font>

1530
00:57:23,510 --> 00:57:27,620
<font color="#E5E5E5">expires then the VPN service</font><font color="#CCCCCC"> count can</font>

1531
00:57:26,270 --> 00:57:29,560
change their password on behalf of the

1532
00:57:27,620 --> 00:57:32,089
user<font color="#E5E5E5"> when they type in the new password</font>

1533
00:57:29,560 --> 00:57:35,029
<font color="#E5E5E5">you can delegate</font><font color="#CCCCCC"> that it doesn't</font><font color="#E5E5E5"> need to</font>

1534
00:57:32,090 --> 00:57:36,500
<font color="#E5E5E5">be a member domain admins and then of</font>

1535
00:57:35,030 --> 00:57:38,510
course sequel<font color="#E5E5E5"> there's never a good</font>

1536
00:57:36,500 --> 00:57:40,730
reason for sequel<font color="#CCCCCC"> often</font><font color="#E5E5E5"> times someone</font>

1537
00:57:38,510 --> 00:57:42,550
<font color="#E5E5E5">will install sequel as a domain admin so</font>

1538
00:57:40,730 --> 00:57:47,180
I can update the<font color="#E5E5E5"> spins</font>

1539
00:57:42,550 --> 00:57:48,980
<font color="#CCCCCC">no you don't</font><font color="#E5E5E5"> need to do that so in</font>

1540
00:57:47,180 --> 00:57:51,020
conclusion the traditional<font color="#CCCCCC"> ad</font>

1541
00:57:48,980 --> 00:57:53,420
<font color="#E5E5E5">administration methods have to evolve</font>

1542
00:57:51,020 --> 00:57:54,920
<font color="#E5E5E5">with what we're seeing</font><font color="#CCCCCC"> our priority is</font>

1543
00:57:53,420 --> 00:57:56,510
<font color="#CCCCCC">going to be</font><font color="#E5E5E5"> removing our accounts and</font>

1544
00:57:54,920 --> 00:57:58,550
service counts<font color="#CCCCCC"> from</font><font color="#E5E5E5"> 80</font><font color="#CCCCCC"> privilege groups</font>

1545
00:57:56,510 --> 00:58:00,890
as much as possible<font color="#CCCCCC"> clean those up</font><font color="#E5E5E5"> and</font>

1546
00:57:58,550 --> 00:58:02,450
priority number two is protecting and

1547
00:58:00,890 --> 00:58:04,370
isolating or<font color="#E5E5E5"> 80 admin credentials by</font>

1548
00:58:02,450 --> 00:58:06,169
ensuring these credentials<font color="#E5E5E5"> or limited to</font>

1549
00:58:04,370 --> 00:58:08,420
specific<font color="#E5E5E5"> systems we know where they</font><font color="#CCCCCC"> are</font>

1550
00:58:06,170 --> 00:58:10,730
<font color="#E5E5E5">we can monitor for them we can track</font>

1551
00:58:08,420 --> 00:58:12,590
this so I'm gonna<font color="#E5E5E5"> have the slides up</font>

1552
00:58:10,730 --> 00:58:13,880
later on<font color="#E5E5E5"> presentations at 80</font><font color="#CCCCCC"> secure data</font>

1553
00:58:12,590 --> 00:58:15,980
work or you<font color="#E5E5E5"> can go straight to 80</font>

1554
00:58:13,880 --> 00:58:18,430
<font color="#E5E5E5">security org but that's been my time</font>

1555
00:58:15,980 --> 00:58:21,540
thanks<font color="#E5E5E5"> so much for yours appreciate it</font>

1556
00:58:18,430 --> 00:58:21,540
[Applause]

1557
00:58:21,940 --> 00:58:25,019
[Music]

1558
00:58:27,269 --> 00:58:40,808
<font color="#E5E5E5">thank you much</font><font color="#CCCCCC"> Sean for your great</font>

1559
00:58:30,160 --> 00:58:43,029
oversight questions hi there

1560
00:58:40,809 --> 00:58:47,410
my name's Steve and<font color="#E5E5E5"> one of the questions</font>

1561
00:58:43,029 --> 00:58:50,710
<font color="#CCCCCC">that I have is what do you</font><font color="#E5E5E5"> consider the</font>

1562
00:58:47,410 --> 00:58:53,828
<font color="#CCCCCC">significance</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> CI</font><font color="#E5E5E5"> CD system</font><font color="#CCCCCC"> of systems</font>

1563
00:58:50,710 --> 00:58:55,660
<font color="#E5E5E5">as</font><font color="#CCCCCC"> it relates to the tiered model of</font>

1564
00:58:53,829 --> 00:58:58,930
critical infrastructure in that<font color="#E5E5E5"> they</font>

1565
00:58:55,660 --> 00:59:01,990
interact with<font color="#E5E5E5"> secrets</font><font color="#CCCCCC"> credentials</font><font color="#E5E5E5"> source</font>

1566
00:58:58,930 --> 00:59:05,098
code and also<font color="#E5E5E5"> cross logical security</font>

1567
00:59:01,990 --> 00:59:07,689
boundaries should<font color="#CCCCCC"> they be teased tr0</font>

1568
00:59:05,099 --> 00:59:09,880
that's a great question I'm<font color="#E5E5E5"> not</font>

1569
00:59:07,690 --> 00:59:11,950
are you talking<font color="#E5E5E5"> about the systems that</font>

1570
00:59:09,880 --> 00:59:15,150
<font color="#CCCCCC">have I heard source code and some</font><font color="#E5E5E5"> of the</font>

1571
00:59:11,950 --> 00:59:18,189
others I'm not<font color="#CCCCCC"> familiar</font><font color="#E5E5E5"> with that term</font>

1572
00:59:15,150 --> 00:59:22,480
so like a<font color="#E5E5E5"> Jenkins based CI CD pipeline</font>

1573
00:59:18,190 --> 00:59:25,329
that interacts<font color="#E5E5E5"> with git</font><font color="#CCCCCC"> and then builds</font>

1574
00:59:22,480 --> 00:59:27,730
various elements<font color="#E5E5E5"> and then promotes them</font>

1575
00:59:25,329 --> 00:59:30,249
<font color="#E5E5E5">across one security boundary to staging</font>

1576
00:59:27,730 --> 00:59:32,170
then on to production<font color="#E5E5E5"> I would think so</font>

1577
00:59:30,249 --> 00:59:34,209
yeah I mean when you're<font color="#CCCCCC"> talking about a</font>

1578
00:59:32,170 --> 00:59:35,559
<font color="#E5E5E5">system</font><font color="#CCCCCC"> that is automatically generating</font>

1579
00:59:34,210 --> 00:59:37,359
and figuring an environment which is

1580
00:59:35,559 --> 00:59:39,220
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to be used by a large</font><font color="#CCCCCC"> number of</font>

1581
00:59:37,359 --> 00:59:41,348
<font color="#E5E5E5">users the other thing is there's there's</font>

1582
00:59:39,220 --> 00:59:42,519
companies<font color="#CCCCCC"> that have source code</font>

1583
00:59:41,349 --> 00:59:44,019
the other interesting thing<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that</font>

1584
00:59:42,519 --> 00:59:46,808
there's financial<font color="#E5E5E5"> companies that write</font>

1585
00:59:44,019 --> 00:59:49,450
their<font color="#CCCCCC"> own applications that then manage</font>

1586
00:59:46,809 --> 00:59:51,460
all<font color="#CCCCCC"> of their</font><font color="#E5E5E5"> financial systems it's one</font>

1587
00:59:49,450 --> 00:59:53,288
<font color="#E5E5E5">of those things where you look at what</font>

1588
00:59:51,460 --> 00:59:55,359
the system is you look at what the risk

1589
00:59:53,289 --> 00:59:57,579
is<font color="#CCCCCC"> if it's</font><font color="#E5E5E5"> exposed and then make the</font>

1590
00:59:55,359 --> 00:59:59,650
decision<font color="#CCCCCC"> and determination of what level</font>

1591
00:59:57,579 --> 01:00:01,150
<font color="#E5E5E5">do we need to protect protect this what</font>

1592
00:59:59,650 --> 01:00:03,700
would happen if an attacker gains access

1593
01:00:01,150 --> 01:00:06,400
<font color="#E5E5E5">to this how can we protect it so tier</font>

1594
01:00:03,700 --> 01:00:08,169
<font color="#CCCCCC">zero is a concept</font><font color="#E5E5E5"> but ultimately we've</font>

1595
01:00:06,400 --> 01:00:10,269
had these sort<font color="#E5E5E5"> of things before in the</font>

1596
01:00:08,170 --> 01:00:12,519
<font color="#E5E5E5">u.s. PCI things along those lines</font>

1597
01:00:10,269 --> 01:00:14,649
<font color="#CCCCCC">elsewhere isolating them protecting them</font>

1598
01:00:12,519 --> 01:00:17,258
<font color="#E5E5E5">I think</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> concept is the</font><font color="#CCCCCC"> same and can</font>

1599
01:00:14,650 --> 01:00:19,359
<font color="#E5E5E5">be reused certainly looking at the risk</font>

1600
01:00:17,259 --> 01:00:21,849
and what the threat is<font color="#E5E5E5"> against that is</font>

1601
01:00:19,359 --> 01:00:23,980
the best way to<font color="#E5E5E5"> determine what the best</font>

1602
01:00:21,849 --> 01:00:25,450
pathway<font color="#CCCCCC"> forward is and of course the</font>

1603
01:00:23,980 --> 01:00:27,099
most important<font color="#CCCCCC"> thing is management</font>

1604
01:00:25,450 --> 01:00:29,529
<font color="#E5E5E5">buy-in I worked with an organization</font>

1605
01:00:27,099 --> 01:00:31,029
<font color="#CCCCCC">that where every user could</font><font color="#E5E5E5"> do whatever</font>

1606
01:00:29,529 --> 01:00:33,400
<font color="#E5E5E5">they want it they were developers they</font>

1607
01:00:31,029 --> 01:00:34,900
could they had<font color="#E5E5E5"> full admin rights</font><font color="#CCCCCC"> they</font>

1608
01:00:33,400 --> 01:00:36,970
didn't have good<font color="#E5E5E5"> tooling they didn't</font>

1609
01:00:34,900 --> 01:00:38,289
have<font color="#E5E5E5"> good monitoring and basically</font>

1610
01:00:36,970 --> 01:00:40,269
<font color="#E5E5E5">management said now we can</font>

1611
01:00:38,289 --> 01:00:43,269
have<font color="#E5E5E5"> this anymore if we</font><font color="#CCCCCC"> get hacked</font><font color="#E5E5E5"> our</font>

1612
01:00:40,269 --> 01:00:45,640
reputation is out the window<font color="#CCCCCC"> and in just</font>

1613
01:00:43,269 --> 01:00:48,189
a<font color="#E5E5E5"> matter of a</font><font color="#CCCCCC"> year or so they have gone</font>

1614
01:00:45,640 --> 01:00:50,650
<font color="#E5E5E5">from nothing</font><font color="#CCCCCC"> to one of the best I've</font>

1615
01:00:48,189 --> 01:00:53,439
seen<font color="#CCCCCC"> with security tool and controls</font>

1616
01:00:50,650 --> 01:00:54,910
<font color="#E5E5E5">tracking management</font><font color="#CCCCCC"> I mean they're very</font>

1617
01:00:53,439 --> 01:00:56,288
solid so it's one<font color="#E5E5E5"> of those things where</font>

1618
01:00:54,910 --> 01:00:58,868
management<font color="#CCCCCC"> has to understand what that</font>

1619
01:00:56,289 --> 01:01:00,519
risk is<font color="#E5E5E5"> as well because the developers</font>

1620
01:00:58,869 --> 01:01:01,839
are going<font color="#E5E5E5"> to complain and we have to be</font>

1621
01:01:00,519 --> 01:01:03,609
able to counter that<font color="#E5E5E5"> and say</font><font color="#CCCCCC"> okay I</font>

1622
01:01:01,839 --> 01:01:04,808
understand your concerns<font color="#E5E5E5"> but</font><font color="#CCCCCC"> this is</font>

1623
01:01:03,609 --> 01:01:10,900
what the risk is this is what we need to

1624
01:01:04,809 --> 01:01:18,400
do to get<font color="#E5E5E5"> this to a better place</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the</font>

1625
01:01:10,900 --> 01:01:21,839
questions<font color="#CCCCCC"> hi my question</font><font color="#E5E5E5"> is about</font>

1626
01:01:18,400 --> 01:01:24,910
<font color="#E5E5E5">passwords what would you do to protect</font>

1627
01:01:21,839 --> 01:01:29,709
people<font color="#CCCCCC"> from using</font><font color="#E5E5E5"> the same</font><font color="#CCCCCC"> password on</font>

1628
01:01:24,910 --> 01:01:31,269
different yeah like da and and<font color="#CCCCCC"> sa</font>

1629
01:01:29,709 --> 01:01:34,390
account as we call it in<font color="#CCCCCC"> the standard</font>

1630
01:01:31,269 --> 01:01:36,999
<font color="#E5E5E5">Corp ID account it's a great question</font>

1631
01:01:34,390 --> 01:01:40,660
<font color="#CCCCCC">one</font><font color="#E5E5E5"> that doesn't have a simple solution</font>

1632
01:01:36,999 --> 01:01:42,069
<font color="#E5E5E5">unfortunately I think password auditing</font>

1633
01:01:40,660 --> 01:01:44,199
is probably the best way to go with<font color="#E5E5E5"> that</font>

1634
01:01:42,069 --> 01:01:46,239
<font color="#CCCCCC">then I</font><font color="#E5E5E5"> have some concerns about the</font>

1635
01:01:44,199 --> 01:01:48,249
traditional password<font color="#CCCCCC"> itting method which</font>

1636
01:01:46,239 --> 01:01:49,809
is where you basically<font color="#E5E5E5"> take a copy of</font>

1637
01:01:48,249 --> 01:01:52,118
the<font color="#E5E5E5"> dit you put it</font><font color="#CCCCCC"> onto another</font><font color="#E5E5E5"> system</font>

1638
01:01:49,809 --> 01:01:53,890
you go through and crack it<font color="#CCCCCC"> or</font><font color="#E5E5E5"> check it</font>

1639
01:01:52,119 --> 01:01:56,679
there's a<font color="#E5E5E5"> few interesting</font><font color="#CCCCCC"> things that</font>

1640
01:01:53,890 --> 01:01:59,499
have been configured that I've seen<font color="#E5E5E5"> see</font>

1641
01:01:56,679 --> 01:02:02,229
<font color="#CCCCCC">where effectively</font><font color="#E5E5E5"> you have a system that</font>

1642
01:01:59,499 --> 01:02:05,558
<font color="#E5E5E5">pulls DC</font><font color="#CCCCCC"> saying password hashes and goes</font>

1643
01:02:02,229 --> 01:02:07,058
through<font color="#CCCCCC"> that and checks them out there's</font>

1644
01:02:05,559 --> 01:02:09,759
not I don't<font color="#E5E5E5"> feel like there's a really</font>

1645
01:02:07,059 --> 01:02:16,089
great<font color="#CCCCCC"> solution for</font><font color="#E5E5E5"> that other than</font>

1646
01:02:09,759 --> 01:02:18,309
<font color="#E5E5E5">password auditing and it actually</font><font color="#CCCCCC"> one</font>

1647
01:02:16,089 --> 01:02:20,619
<font color="#E5E5E5">one way that you can help limit that is</font>

1648
01:02:18,309 --> 01:02:22,479
using fine-grained password policies on

1649
01:02:20,619 --> 01:02:26,409
your privileged accounts<font color="#E5E5E5"> and giving them</font>

1650
01:02:22,479 --> 01:02:28,479
a 16 or<font color="#E5E5E5"> 17 character password minimum</font>

1651
01:02:26,409 --> 01:02:30,909
and so<font color="#CCCCCC"> on your domain you're gonna have</font>

1652
01:02:28,479 --> 01:02:34,448
whatever it normally is<font color="#E5E5E5"> 7 8 10 12</font>

1653
01:02:30,909 --> 01:02:36,099
hopefully<font color="#E5E5E5"> 14 or 15</font><font color="#CCCCCC"> but that way there's</font>

1654
01:02:34,449 --> 01:02:37,329
less less likely they're gonna use the

1655
01:02:36,099 --> 01:02:40,390
same<font color="#E5E5E5"> password if there's different</font>

1656
01:02:37,329 --> 01:02:41,709
password<font color="#E5E5E5"> length requirements that's</font>

1657
01:02:40,390 --> 01:02:43,689
<font color="#E5E5E5">probably the probably</font><font color="#CCCCCC"> the easy</font><font color="#E5E5E5"> button</font>

1658
01:02:41,709 --> 01:02:46,239
for it I'm sorry there's not<font color="#E5E5E5"> a better</font>

1659
01:02:43,689 --> 01:02:49,598
<font color="#E5E5E5">answer</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> least</font><font color="#CCCCCC"> that I have I think</font>

1660
01:02:46,239 --> 01:02:51,400
<font color="#E5E5E5">Microsoft even</font><font color="#CCCCCC"> in the times of Windows</font>

1661
01:02:49,599 --> 01:02:56,440
<font color="#E5E5E5">NT provided</font>

1662
01:02:51,400 --> 01:03:00,339
a<font color="#CCCCCC"> pass dll that that performs some</font>

1663
01:02:56,440 --> 01:03:02,920
checks<font color="#E5E5E5"> but this never worked so good</font><font color="#CCCCCC"> but</font>

1664
01:03:00,339 --> 01:03:07,960
there are some companies<font color="#CCCCCC"> that offer</font>

1665
01:03:02,920 --> 01:03:09,940
these<font color="#E5E5E5"> but as you said yeah</font><font color="#CCCCCC"> there's no</font>

1666
01:03:07,960 --> 01:03:11,680
filter<font color="#E5E5E5"> can definitely check against</font>

1667
01:03:09,940 --> 01:03:13,990
known bad passwords or ones<font color="#E5E5E5"> you don't</font>

1668
01:03:11,680 --> 01:03:16,779
want<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> in Microsoft released over the</font>

1669
01:03:13,990 --> 01:03:19,749
<font color="#E5E5E5">summer</font><font color="#CCCCCC"> the azure ad password protection</font>

1670
01:03:16,779 --> 01:03:21,999
which is<font color="#CCCCCC"> a support a tool by Microsoft</font>

1671
01:03:19,749 --> 01:03:24,459
<font color="#E5E5E5">that you install the agents on your dcs</font>

1672
01:03:21,999 --> 01:03:26,859
<font color="#E5E5E5">you install an agent on a server it</font>

1673
01:03:24,460 --> 01:03:28,710
pulls down<font color="#E5E5E5"> from</font><font color="#CCCCCC"> azure ad</font><font color="#E5E5E5"> the known bad</font>

1674
01:03:26,859 --> 01:03:30,730
passwords and then it does some

1675
01:03:28,710 --> 01:03:33,759
intelligence around<font color="#E5E5E5"> that so</font><font color="#CCCCCC"> that way</font>

1676
01:03:30,730 --> 01:03:35,920
<font color="#E5E5E5">users can't use really bad known</font><font color="#CCCCCC"> Pat and</font>

1677
01:03:33,759 --> 01:03:37,920
known bad passwords<font color="#CCCCCC"> that updates on a</font>

1678
01:03:35,920 --> 01:03:41,079
<font color="#CCCCCC">regular basis it's a password filter</font>

1679
01:03:37,920 --> 01:03:45,609
<font color="#E5E5E5">they what's interesting about is it</font>

1680
01:03:41,079 --> 01:03:48,279
leverages a<font color="#E5E5E5"> effectively a group policy</font>

1681
01:03:45,609 --> 01:03:50,049
so they create a group<font color="#CCCCCC"> policy entry into</font>

1682
01:03:48,279 --> 01:03:51,880
<font color="#E5E5E5">sis fall and that's where they update</font>

1683
01:03:50,049 --> 01:03:53,920
the the password data they that pulls

1684
01:03:51,880 --> 01:03:56,380
<font color="#E5E5E5">down from Azure ad so it replicates</font>

1685
01:03:53,920 --> 01:03:58,029
around all the<font color="#CCCCCC"> DC's to DC checks against</font>

1686
01:03:56,380 --> 01:04:00,099
that whenever<font color="#E5E5E5"> a user changes their</font>

1687
01:03:58,029 --> 01:04:01,720
password that doesn't<font color="#E5E5E5"> solve</font><font color="#CCCCCC"> the problem</font>

1688
01:04:00,099 --> 01:04:04,450
of<font color="#E5E5E5"> two users using the same password</font>

1689
01:04:01,720 --> 01:04:06,549
though<font color="#E5E5E5"> but you can have custom</font><font color="#CCCCCC"> band</font>

1690
01:04:04,450 --> 01:04:09,009
passwords through that as well<font color="#E5E5E5"> so you</font>

1691
01:04:06,549 --> 01:04:10,390
could type in<font color="#E5E5E5"> I don't know Heidelberg</font>

1692
01:04:09,009 --> 01:04:13,019
and then it would do the automatic

1693
01:04:10,390 --> 01:04:15,480
checks against leet-speak and other

1694
01:04:13,019 --> 01:04:19,238
character substitutions<font color="#E5E5E5"> of Heidelberg to</font>

1695
01:04:15,480 --> 01:04:21,069
<font color="#CCCCCC">protect against</font><font color="#E5E5E5"> that so that's an option</font>

1696
01:04:19,239 --> 01:04:23,410
<font color="#CCCCCC">for bad passwords but</font><font color="#E5E5E5"> again doesn't</font>

1697
01:04:21,069 --> 01:04:25,799
solve the<font color="#CCCCCC"> problem of</font><font color="#E5E5E5"> one user using the</font>

1698
01:04:23,410 --> 01:04:25,799
same password

