1
00:00:06,000 --> 00:00:09,120
hi everybody um sorry it's working

2
00:00:09,120 --> 00:00:10,719
just make sure that it is actually on

3
00:00:10,719 --> 00:00:11,840
you can't actually hear me oh yeah i can

4
00:00:11,840 --> 00:00:13,679
hear the echo in the room now all good

5
00:00:13,679 --> 00:00:14,920
hi everybody

6
00:00:14,920 --> 00:00:18,400
um i'm jed i'm a principal consultant

7
00:00:18,400 --> 00:00:20,480
i'm part of the very wonderful awesome

8
00:00:20,480 --> 00:00:23,119
and sexy team at cyber cx

9
00:00:23,119 --> 00:00:25,599
today i'm going to be talking about

10
00:00:25,599 --> 00:00:27,920
my home and my home automation journey

11
00:00:27,920 --> 00:00:29,599
the purpose of this talk is slightly

12
00:00:29,599 --> 00:00:31,119
technical i'll be going into some

13
00:00:31,119 --> 00:00:32,960
examples of things that i've done

14
00:00:32,960 --> 00:00:35,200
mostly to give you ideas um as the

15
00:00:35,200 --> 00:00:37,680
hacker alex once said

16
00:00:37,680 --> 00:00:39,280
um when i found that you could do

17
00:00:39,280 --> 00:00:41,280
something and like nothing bad happens

18
00:00:41,280 --> 00:00:43,120
then suddenly i could do it too and so

19
00:00:43,120 --> 00:00:44,879
that's the first part of my talk

20
00:00:44,879 --> 00:00:47,120
and the second reason is to kind of

21
00:00:47,120 --> 00:00:49,600
illustrate real-life examples of risk

22
00:00:49,600 --> 00:00:51,760
and compliance work sort of this the

23
00:00:51,760 --> 00:00:54,960
stuff that tom was just talking about

24
00:00:54,960 --> 00:00:56,640
governance risk and compliance work is

25
00:00:56,640 --> 00:00:58,640
security work uh if you're starting out

26
00:00:58,640 --> 00:01:00,879
in your career and you're like me and

27
00:01:00,879 --> 00:01:02,719
you don't like hack all the things all

28
00:01:02,719 --> 00:01:04,799
day every day that doesn't mean that you

29
00:01:04,799 --> 00:01:06,320
don't have value

30
00:01:06,320 --> 00:01:09,040
in the security world because that is a

31
00:01:09,040 --> 00:01:10,799
big part of it

32
00:01:10,799 --> 00:01:13,200
um the the presentation is a trilogy in

33
00:01:13,200 --> 00:01:15,280
five acts um so basically i'm going to

34
00:01:15,280 --> 00:01:17,200
go through five different examples it's

35
00:01:17,200 --> 00:01:18,960
not comprehensive i'm not going to go

36
00:01:18,960 --> 00:01:21,600
into a lot of detail of anything if you

37
00:01:21,600 --> 00:01:23,439
are interested in anything that i've

38
00:01:23,439 --> 00:01:24,720
talked about

39
00:01:24,720 --> 00:01:27,360
feel free to hit me up if you're in this

40
00:01:27,360 --> 00:01:29,119
room if you're in the other room if

41
00:01:29,119 --> 00:01:32,320
you're watching online hi um then i'll

42
00:01:32,320 --> 00:01:34,400
i've left my email address slack discord

43
00:01:34,400 --> 00:01:37,520
etc at the end of the talk

44
00:01:37,520 --> 00:01:38,880
so let's start all the way back at the

45
00:01:38,880 --> 00:01:42,000
beginning why am i even here today um

46
00:01:42,000 --> 00:01:45,040
on 15th of april 2016

47
00:01:45,040 --> 00:01:46,640
is when my home automation journey

48
00:01:46,640 --> 00:01:48,880
started and i know this date exactly

49
00:01:48,880 --> 00:01:50,399
because this was the date that my house

50
00:01:50,399 --> 00:01:51,920
got broken into

51
00:01:51,920 --> 00:01:54,960
burglar came in took about 1 500 worth

52
00:01:54,960 --> 00:01:57,840
of electronics an old ipad a camera lens

53
00:01:57,840 --> 00:01:59,200
annoyingly like a whole bunch of

54
00:01:59,200 --> 00:02:00,320
chargers

55
00:02:00,320 --> 00:02:01,920
um and all of it was covered by

56
00:02:01,920 --> 00:02:03,840
insurance like

57
00:02:03,840 --> 00:02:06,960
the the total like loss to me was very

58
00:02:06,960 --> 00:02:09,119
very minimal but as anyone who's been

59
00:02:09,119 --> 00:02:10,959
broken into knows like it's the feeling

60
00:02:10,959 --> 00:02:13,200
that someone's come into your space and

61
00:02:13,200 --> 00:02:14,480
come and gone through your stuff that

62
00:02:14,480 --> 00:02:16,480
makes you want to do things to stop

63
00:02:16,480 --> 00:02:18,160
anything like that ever happening again

64
00:02:18,160 --> 00:02:20,319
it is very very deeply personal and very

65
00:02:20,319 --> 00:02:22,400
very deeply upsetting

66
00:02:22,400 --> 00:02:24,160
so you know with one thousand five

67
00:02:24,160 --> 00:02:26,000
hundred dollars of covered loss i went

68
00:02:26,000 --> 00:02:28,160
out and spent two thousand dollars on a

69
00:02:28,160 --> 00:02:29,680
home alarm system because that's of

70
00:02:29,680 --> 00:02:31,519
course you know what typical enterprises

71
00:02:31,519 --> 00:02:33,200
do you spend a lot of money on very

72
00:02:33,200 --> 00:02:35,519
expensive security solutions

73
00:02:35,519 --> 00:02:38,800
and it completely and totally sucks

74
00:02:38,800 --> 00:02:40,879
um for those who like have one of these

75
00:02:40,879 --> 00:02:43,280
things you know that's a joke but it's

76
00:02:43,280 --> 00:02:44,800
kind of serious because sometimes the

77
00:02:44,800 --> 00:02:46,959
capacitive touch buttons like don't

78
00:02:46,959 --> 00:02:49,519
register your fingers

79
00:02:49,519 --> 00:02:51,280
so if you're holding a sleeping child

80
00:02:51,280 --> 00:02:52,640
and you're trying to get in the house

81
00:02:52,640 --> 00:02:54,000
you're playing russian roulette as to

82
00:02:54,000 --> 00:02:55,599
whether or not the alarm is going to go

83
00:02:55,599 --> 00:02:57,920
off before you've managed to actually

84
00:02:57,920 --> 00:03:00,080
mung the five digits into the keypad

85
00:03:00,080 --> 00:03:01,840
properly

86
00:03:01,840 --> 00:03:03,360
it also sucks because like when you set

87
00:03:03,360 --> 00:03:04,720
the alarm and then you realize you've

88
00:03:04,720 --> 00:03:06,400
forgotten your wallet you then have to

89
00:03:06,400 --> 00:03:09,040
like unset it and run upstairs and then

90
00:03:09,040 --> 00:03:10,720
you've got to read the whole process and

91
00:03:10,720 --> 00:03:12,560
hope that it works again it's just like

92
00:03:12,560 --> 00:03:15,200
a horrible user experience again a lot

93
00:03:15,200 --> 00:03:17,360
of parallels to it to a typical

94
00:03:17,360 --> 00:03:19,599
enterprise security solution where

95
00:03:19,599 --> 00:03:20,800
you're spending a whole bunch of money

96
00:03:20,800 --> 00:03:22,720
and your users hate you

97
00:03:22,720 --> 00:03:24,799
um

98
00:03:24,799 --> 00:03:27,120
and so after about like six months with

99
00:03:27,120 --> 00:03:29,599
that keypad of doom i was frustrated my

100
00:03:29,599 --> 00:03:31,519
wife was frustrated and i was thinking

101
00:03:31,519 --> 00:03:33,599
geez there's got to be a better way like

102
00:03:33,599 --> 00:03:36,000
we're living in 2017 this is the year of

103
00:03:36,000 --> 00:03:37,920
the future

104
00:03:37,920 --> 00:03:40,080
what can i do

105
00:03:40,080 --> 00:03:42,159
so the alarm i bought has an ethernet

106
00:03:42,159 --> 00:03:44,640
port and the vendor

107
00:03:44,640 --> 00:03:46,480
that provides it also provides a mobile

108
00:03:46,480 --> 00:03:49,280
app and i think yeah you know every

109
00:03:49,280 --> 00:03:51,680
we've both got really nice iphones this

110
00:03:51,680 --> 00:03:52,799
is going to be absolutely fantastic

111
00:03:52,799 --> 00:03:54,239
because everyone loves having apps like

112
00:03:54,239 --> 00:03:55,360
everyone loves having apps for things

113
00:03:55,360 --> 00:03:56,480
just being able to press buttons on

114
00:03:56,480 --> 00:03:58,799
their phones

115
00:03:58,799 --> 00:04:00,400
and hopefully they had this little

116
00:04:00,400 --> 00:04:02,000
diagram about how to make it so that you

117
00:04:02,000 --> 00:04:03,920
could do this even when you're like not

118
00:04:03,920 --> 00:04:06,239
on your wi-fi and um

119
00:04:06,239 --> 00:04:08,720
have the mobile app work

120
00:04:08,720 --> 00:04:10,159
and i thought yeah this looks cool

121
00:04:10,159 --> 00:04:12,879
except if we like enhance those ports a

122
00:04:12,879 --> 00:04:14,879
little bit um

123
00:04:14,879 --> 00:04:18,478
yeah no um that's a bad idea

124
00:04:18,478 --> 00:04:21,040
don't put http especially security

125
00:04:21,040 --> 00:04:23,600
things like on the public internet

126
00:04:23,600 --> 00:04:25,360
but while i instinctively see this as a

127
00:04:25,360 --> 00:04:28,400
bad idea like why is it a bad idea um

128
00:04:28,400 --> 00:04:29,919
this is a security system and like

129
00:04:29,919 --> 00:04:31,919
surely they've done some work and this

130
00:04:31,919 --> 00:04:34,000
is okay right

131
00:04:34,000 --> 00:04:36,320
they have a padlock on their website

132
00:04:36,320 --> 00:04:38,560
um turns out they cooked up their own

133
00:04:38,560 --> 00:04:40,479
encryption algorithm and a nice little

134
00:04:40,479 --> 00:04:42,960
padlock logo and murm rings about html5

135
00:04:42,960 --> 00:04:44,960
and like basically what they tried to do

136
00:04:44,960 --> 00:04:47,120
was make it easy for people to install

137
00:04:47,120 --> 00:04:48,320
these things and not have to worry about

138
00:04:48,320 --> 00:04:50,400
those pesky certificates and they came

139
00:04:50,400 --> 00:04:52,560
up with their own encryption

140
00:04:52,560 --> 00:04:54,880
encryption algorithm

141
00:04:54,880 --> 00:04:56,880
to like basically

142
00:04:56,880 --> 00:04:59,360
make it semi-secure so it's sort of

143
00:04:59,360 --> 00:05:01,759
obfuscated um i'm not going to go into

144
00:05:01,759 --> 00:05:03,039
the technical detail this is a very

145
00:05:03,039 --> 00:05:05,280
short talk um take a picture it lasts

146
00:05:05,280 --> 00:05:08,000
longer um again if you are into crypto

147
00:05:08,000 --> 00:05:09,440
um you know

148
00:05:09,440 --> 00:05:11,600
come and talk to me afterwards

149
00:05:11,600 --> 00:05:13,039
for those of you who haven't come across

150
00:05:13,039 --> 00:05:15,199
bruce schneier and schneier's law um it

151
00:05:15,199 --> 00:05:17,600
basically says that you know anyone can

152
00:05:17,600 --> 00:05:19,440
build an encryption algorithm that they

153
00:05:19,440 --> 00:05:21,440
themselves can't break but building one

154
00:05:21,440 --> 00:05:23,440
that other people can't break is a much

155
00:05:23,440 --> 00:05:26,639
harder effort and so this is my example

156
00:05:26,639 --> 00:05:28,639
i was reverse engineering the alarm

157
00:05:28,639 --> 00:05:30,639
system to try to like you know be able

158
00:05:30,639 --> 00:05:32,240
to automate with it and be able to do

159
00:05:32,240 --> 00:05:34,240
cool things and i saw this and i went

160
00:05:34,240 --> 00:05:36,400
through the whole responsible disclosure

161
00:05:36,400 --> 00:05:39,600
process um back in 2017 they said they

162
00:05:39,600 --> 00:05:41,680
were going to add like a let's encrypt

163
00:05:41,680 --> 00:05:44,240
client and move to https um and then

164
00:05:44,240 --> 00:05:46,320
they kind of stopped talking to me and

165
00:05:46,320 --> 00:05:49,120
um yeah so like casual oda anyone maybe

166
00:05:49,120 --> 00:05:51,280
it's not like super bad but it's but

167
00:05:51,280 --> 00:05:52,720
it's bad enough to make me a little bit

168
00:05:52,720 --> 00:05:54,160
uncomfortable about putting this thing

169
00:05:54,160 --> 00:05:55,680
on the internet and just relying on it

170
00:05:55,680 --> 00:05:56,800
solely

171
00:05:56,800 --> 00:05:59,199
but i can't just like shut down and

172
00:05:59,199 --> 00:06:01,039
hermit out and go okay well you know i'm

173
00:06:01,039 --> 00:06:02,400
just stuck with the keypad i'm still

174
00:06:02,400 --> 00:06:04,000
frustrated i still have to find a

175
00:06:04,000 --> 00:06:07,199
solution to my problem so

176
00:06:07,199 --> 00:06:09,919
what can i do

177
00:06:09,919 --> 00:06:13,600
oh yeah you poor unfortunate souls

178
00:06:13,600 --> 00:06:15,360
taking a step back so the way that we

179
00:06:15,360 --> 00:06:17,759
typically describe risk when it comes to

180
00:06:17,759 --> 00:06:19,600
security is describing it in terms of

181
00:06:19,600 --> 00:06:21,680
confidentiality integrity and

182
00:06:21,680 --> 00:06:23,039
availability

183
00:06:23,039 --> 00:06:25,600
how these risks arise and how they

184
00:06:25,600 --> 00:06:27,440
affect you will be different depending

185
00:06:27,440 --> 00:06:29,520
on who you are and what you're trying to

186
00:06:29,520 --> 00:06:32,000
protect

187
00:06:32,000 --> 00:06:33,120
and whether you can live with these

188
00:06:33,120 --> 00:06:35,440
risks really depends on

189
00:06:35,440 --> 00:06:38,000
how big the impact could be and whether

190
00:06:38,000 --> 00:06:39,360
or not you can mitigate those big

191
00:06:39,360 --> 00:06:40,800
impacts down

192
00:06:40,800 --> 00:06:44,160
using appropriate compensating controls

193
00:06:44,160 --> 00:06:46,720
for me my biggest risks are around the

194
00:06:46,720 --> 00:06:49,440
integrity of the system making sure that

195
00:06:49,440 --> 00:06:52,080
i can rely on it to detect burglars and

196
00:06:52,080 --> 00:06:53,680
that it's going to notify me correctly

197
00:06:53,680 --> 00:06:56,160
every time but also the availability

198
00:06:56,160 --> 00:06:58,240
making sure that my wife doesn't have to

199
00:06:58,240 --> 00:06:59,919
call me up and say hey

200
00:06:59,919 --> 00:07:02,240
your wonderful whiz-bang system isn't

201
00:07:02,240 --> 00:07:03,520
working and now i'm locked out of the

202
00:07:03,520 --> 00:07:05,759
house and you need to come and fix this

203
00:07:05,759 --> 00:07:06,639
now

204
00:07:06,639 --> 00:07:08,160
because i like being able to do

205
00:07:08,160 --> 00:07:09,680
presentations in conferences like this

206
00:07:09,680 --> 00:07:12,240
and i don't like being on-call 24 7.

207
00:07:12,240 --> 00:07:13,680
so if a vendor is asking me to publish

208
00:07:13,680 --> 00:07:15,840
http ports to the internet and i can

209
00:07:15,840 --> 00:07:16,720
find vulnerabilities in the

210
00:07:16,720 --> 00:07:18,880
implementation and as i say i'm like not

211
00:07:18,880 --> 00:07:20,319
part of the elite hacking crew at cyber

212
00:07:20,319 --> 00:07:23,199
cx but if i can find them then

213
00:07:23,199 --> 00:07:24,560
probably other things lurking there as

214
00:07:24,560 --> 00:07:26,400
well

215
00:07:26,400 --> 00:07:27,840
and the biggest problem is i don't

216
00:07:27,840 --> 00:07:29,759
really have any sort of mitigations i

217
00:07:29,759 --> 00:07:31,199
can reasonably put in place like a

218
00:07:31,199 --> 00:07:33,520
firewall is not going to help me here um

219
00:07:33,520 --> 00:07:35,360
i i could come up with some crazy

220
00:07:35,360 --> 00:07:37,520
waffles but then i'm putting a lot of

221
00:07:37,520 --> 00:07:39,840
risk at the availability of the system

222
00:07:39,840 --> 00:07:41,680
and and it makes me uncomfortable but

223
00:07:41,680 --> 00:07:43,520
again i just can't live in that

224
00:07:43,520 --> 00:07:45,360
uncomfortable world i have to find a

225
00:07:45,360 --> 00:07:47,199
solution

226
00:07:47,199 --> 00:07:48,639
so after looking at those issues i

227
00:07:48,639 --> 00:07:49,759
started looking around what are the

228
00:07:49,759 --> 00:07:51,360
other options

229
00:07:51,360 --> 00:07:53,199
the alarm system also had a binary

230
00:07:53,199 --> 00:07:54,960
network integration protocol so that it

231
00:07:54,960 --> 00:07:55,759
could

232
00:07:55,759 --> 00:07:57,599
interface with other systems the idea

233
00:07:57,599 --> 00:07:59,919
being that in a large office building

234
00:07:59,919 --> 00:08:01,759
you'll want to be able to control the

235
00:08:01,759 --> 00:08:03,599
lights control the alarm system etc all

236
00:08:03,599 --> 00:08:05,759
from a centralized place

237
00:08:05,759 --> 00:08:07,280
and at the time

238
00:08:07,280 --> 00:08:09,759
i'm a apple user

239
00:08:09,759 --> 00:08:11,360
no particular reason other than i just

240
00:08:11,360 --> 00:08:12,479
am

241
00:08:12,479 --> 00:08:14,479
the apple home app was like months old

242
00:08:14,479 --> 00:08:16,319
at that point and people had already

243
00:08:16,319 --> 00:08:17,680
started reverse engineering the

244
00:08:17,680 --> 00:08:19,680
proprietary homekit protocol

245
00:08:19,680 --> 00:08:20,800
and

246
00:08:20,800 --> 00:08:23,120
you can kind of see where this is going

247
00:08:23,120 --> 00:08:24,800
i was a bit hesitant at just assuming

248
00:08:24,800 --> 00:08:26,479
that apple could do a better job of

249
00:08:26,479 --> 00:08:28,080
designing a protocol

250
00:08:28,080 --> 00:08:30,080
and that the open source implementations

251
00:08:30,080 --> 00:08:31,840
would actually be any good open source

252
00:08:31,840 --> 00:08:33,519
implementations are only as good as the

253
00:08:33,519 --> 00:08:34,719
amount of effort that people have put

254
00:08:34,719 --> 00:08:36,240
into them

255
00:08:36,240 --> 00:08:37,519
but

256
00:08:37,519 --> 00:08:39,440
and this is the big point here is that i

257
00:08:39,440 --> 00:08:42,000
could mitigate those risks

258
00:08:42,000 --> 00:08:43,760
i could mitigate them down to a point

259
00:08:43,760 --> 00:08:46,480
where i was comfortable enough that

260
00:08:46,480 --> 00:08:48,399
like my threat model is not about

261
00:08:48,399 --> 00:08:49,920
worrying about you know sophisticated

262
00:08:49,920 --> 00:08:51,519
burglars it's more about just making

263
00:08:51,519 --> 00:08:53,200
sure that the system

264
00:08:53,200 --> 00:08:55,760
works most of the time

265
00:08:55,760 --> 00:08:57,360
so now i've accepted the risk and i can

266
00:08:57,360 --> 00:08:58,880
get on with building like you know every

267
00:08:58,880 --> 00:09:00,959
other security person here

268
00:09:00,959 --> 00:09:02,640
the architecture that i chose was kind

269
00:09:02,640 --> 00:09:03,920
of in two parts

270
00:09:03,920 --> 00:09:06,080
running on a raspberry pi i chose to use

271
00:09:06,080 --> 00:09:08,959
the home kit to mqtt software to

272
00:09:08,959 --> 00:09:10,800
interface with the apple home app over

273
00:09:10,800 --> 00:09:13,120
my wifi so so when my phone connects i

274
00:09:13,120 --> 00:09:15,600
can then do things like turn off the

275
00:09:15,600 --> 00:09:18,480
alarm system and open the garage door

276
00:09:18,480 --> 00:09:21,200
and then that then talks over mqtt to a

277
00:09:21,200 --> 00:09:22,560
bit of python code that i wrote to

278
00:09:22,560 --> 00:09:23,920
interface with the binary control

279
00:09:23,920 --> 00:09:25,519
protocol because there wasn't anything

280
00:09:25,519 --> 00:09:27,279
available at the time and today i

281
00:09:27,279 --> 00:09:29,839
haven't been able to find anything else

282
00:09:29,839 --> 00:09:32,480
for those who haven't come across mqtt

283
00:09:32,480 --> 00:09:37,519
it is a absolutely awesome open protocol

284
00:09:37,519 --> 00:09:38,720
you have

285
00:09:38,720 --> 00:09:40,640
any number of devices that connect to

286
00:09:40,640 --> 00:09:43,200
your server these devices can publish

287
00:09:43,200 --> 00:09:44,720
into certain channels and then you can

288
00:09:44,720 --> 00:09:46,399
have other bits of software connected to

289
00:09:46,399 --> 00:09:48,480
the same server that can subscribe to

290
00:09:48,480 --> 00:09:49,680
those channels

291
00:09:49,680 --> 00:09:51,600
so it makes it very easy

292
00:09:51,600 --> 00:09:53,839
both to add more devices in the future

293
00:09:53,839 --> 00:09:55,760
without having to create a very

294
00:09:55,760 --> 00:09:58,480
complicated mesh integration pattern but

295
00:09:58,480 --> 00:10:00,080
it also means that you can swap things

296
00:10:00,080 --> 00:10:01,519
out and that will become important for

297
00:10:01,519 --> 00:10:03,120
reasons that you'll kind of see very

298
00:10:03,120 --> 00:10:05,680
soon

299
00:10:05,680 --> 00:10:07,920
and my python code is like horrible and

300
00:10:07,920 --> 00:10:10,480
dodgy and everything's wrong with it it

301
00:10:10,480 --> 00:10:12,959
uses the construct library because

302
00:10:12,959 --> 00:10:14,720
trying to talk binary to things is

303
00:10:14,720 --> 00:10:16,399
really hard and i found that the

304
00:10:16,399 --> 00:10:17,600
construct

305
00:10:17,600 --> 00:10:19,440
library in python does a reasonable job

306
00:10:19,440 --> 00:10:21,440
of being able to have a declarative

307
00:10:21,440 --> 00:10:23,279
language say what it is that you want it

308
00:10:23,279 --> 00:10:25,120
to look like not how to get their kind

309
00:10:25,120 --> 00:10:27,200
of thing

310
00:10:27,200 --> 00:10:29,279
and the result as you can see is that i

311
00:10:29,279 --> 00:10:31,600
can control the alarm system

312
00:10:31,600 --> 00:10:34,880
and that then has a wire off the garage

313
00:10:34,880 --> 00:10:36,800
door to allow me to open up the garage

314
00:10:36,800 --> 00:10:39,360
door and this is really really handy

315
00:10:39,360 --> 00:10:41,440
because like when you're biking home you

316
00:10:41,440 --> 00:10:43,040
really don't want to have to like get

317
00:10:43,040 --> 00:10:45,519
off your bike and take take your keys

318
00:10:45,519 --> 00:10:47,200
out and open the front door and then go

319
00:10:47,200 --> 00:10:49,200
around and open the garage door that is

320
00:10:49,200 --> 00:10:51,279
a really great interface

321
00:10:51,279 --> 00:10:52,800
but it's also a really great interface

322
00:10:52,800 --> 00:10:54,959
because suddenly the user expectation

323
00:10:54,959 --> 00:10:56,560
and the level of frustration that a user

324
00:10:56,560 --> 00:10:58,720
has to have has gone from having this

325
00:10:58,720 --> 00:11:00,640
like clutchy interface they don't want

326
00:11:00,640 --> 00:11:03,040
to use to something that they can

327
00:11:03,040 --> 00:11:05,440
natively do and they can do in multiple

328
00:11:05,440 --> 00:11:07,760
ways it's possible to do this um using

329
00:11:07,760 --> 00:11:09,519
siri it's possible to do this by pushing

330
00:11:09,519 --> 00:11:10,480
buttons

331
00:11:10,480 --> 00:11:13,200
it's it it really is a good solution and

332
00:11:13,200 --> 00:11:16,640
so by adding more software and like iot

333
00:11:16,640 --> 00:11:18,240
things into my network i've actually

334
00:11:18,240 --> 00:11:21,440
made my home more secure because now

335
00:11:21,440 --> 00:11:23,920
i'm incentivized to make sure that i'm

336
00:11:23,920 --> 00:11:25,839
setting the alarm every time that i

337
00:11:25,839 --> 00:11:27,200
leave the house and the same thing goes

338
00:11:27,200 --> 00:11:29,440
for my wife as well as well as anyone

339
00:11:29,440 --> 00:11:31,279
else who cares to visit as long as

340
00:11:31,279 --> 00:11:32,880
they've got an iphone

341
00:11:32,880 --> 00:11:35,040
um

342
00:11:35,040 --> 00:11:36,959
so a couple lessons learned from this

343
00:11:36,959 --> 00:11:38,560
one um

344
00:11:38,560 --> 00:11:40,720
so first one is that not all padlock

345
00:11:40,720 --> 00:11:42,640
icons mean the same thing

346
00:11:42,640 --> 00:11:44,800
if you see a padlock and it's not based

347
00:11:44,800 --> 00:11:46,720
on something that you kind of recognize

348
00:11:46,720 --> 00:11:48,160
have a play with it

349
00:11:48,160 --> 00:11:49,760
because it can lead to some very

350
00:11:49,760 --> 00:11:51,360
interesting scenarios

351
00:11:51,360 --> 00:11:52,720
the second thing is that quantifying

352
00:11:52,720 --> 00:11:54,160
your risk makes it easier to treat them

353
00:11:54,160 --> 00:11:56,320
it's it's it's easy to just throw your

354
00:11:56,320 --> 00:11:58,639
hands up and say it's insecure it's iot

355
00:11:58,639 --> 00:12:01,279
i don't trust it um if you actually work

356
00:12:01,279 --> 00:12:02,639
out well what are the threats that

357
00:12:02,639 --> 00:12:04,399
you're trying to protect against and how

358
00:12:04,399 --> 00:12:05,839
could you protect against them you're

359
00:12:05,839 --> 00:12:07,279
going to have a much better time at

360
00:12:07,279 --> 00:12:09,519
developing a solution

361
00:12:09,519 --> 00:12:11,920
and finally like i wrote this code back

362
00:12:11,920 --> 00:12:13,920
in 2017 and i've had to maintain it

363
00:12:13,920 --> 00:12:15,920
since then and one of the biggest

364
00:12:15,920 --> 00:12:17,519
feelings that i had was not writing

365
00:12:17,519 --> 00:12:19,600
enough automated integration tests up

366
00:12:19,600 --> 00:12:20,480
front

367
00:12:20,480 --> 00:12:22,880
a lot of iot devices like this is why

368
00:12:22,880 --> 00:12:24,320
there are so many vulnerabilities is

369
00:12:24,320 --> 00:12:26,160
because actually maintaining them going

370
00:12:26,160 --> 00:12:28,320
forward is really hard because you can't

371
00:12:28,320 --> 00:12:30,480
remember what you did to make that thing

372
00:12:30,480 --> 00:12:32,560
work and then when i had to do the

373
00:12:32,560 --> 00:12:35,600
migration from python 2 to python 3

374
00:12:35,600 --> 00:12:37,440
i was basically just like opening and

375
00:12:37,440 --> 00:12:39,519
closing my garage door all night long

376
00:12:39,519 --> 00:12:40,959
trying to make sure that it worked

377
00:12:40,959 --> 00:12:42,800
because i didn't have a automated test

378
00:12:42,800 --> 00:12:44,800
bed where i could just plug it in and

379
00:12:44,800 --> 00:12:46,480
see if it was working

380
00:12:46,480 --> 00:12:48,959
not fun

381
00:12:49,040 --> 00:12:51,040
so i'm not going to talk too much about

382
00:12:51,040 --> 00:12:53,200
these because these are one of the more

383
00:12:53,200 --> 00:12:54,399
boring things

384
00:12:54,399 --> 00:12:55,839
in my opinion

385
00:12:55,839 --> 00:12:57,519
but there's a whole bunch of cheap

386
00:12:57,519 --> 00:13:00,480
mass-produced smart devices out there

387
00:13:00,480 --> 00:13:02,399
and almost all of these are manufactured

388
00:13:02,399 --> 00:13:04,320
by a single vendor called

389
00:13:04,320 --> 00:13:05,279
tui

390
00:13:05,279 --> 00:13:07,200
who then provide white label products

391
00:13:07,200 --> 00:13:09,279
for companies to be able to slap their

392
00:13:09,279 --> 00:13:11,440
logo and rubbishy app on

393
00:13:11,440 --> 00:13:14,000
um one of my uni friends mark hi mark

394
00:13:14,000 --> 00:13:16,000
um wrote a great tutorial on how to use

395
00:13:16,000 --> 00:13:18,000
a vulnerability in the 2year software

396
00:13:18,000 --> 00:13:19,920
that was on these devices to then load

397
00:13:19,920 --> 00:13:22,880
an open source firmware called tasmota

398
00:13:22,880 --> 00:13:24,399
you can do this without having to open

399
00:13:24,399 --> 00:13:26,560
up the device you're not voiding any of

400
00:13:26,560 --> 00:13:28,800
the electrical safety certifications in

401
00:13:28,800 --> 00:13:29,920
doing so

402
00:13:29,920 --> 00:13:32,160
it's just a really really good idea

403
00:13:32,160 --> 00:13:34,480
but unfortunately tuya after many years

404
00:13:34,480 --> 00:13:36,320
updated their firmware so that any new

405
00:13:36,320 --> 00:13:37,920
devices which unfortunately ship with

406
00:13:37,920 --> 00:13:40,560
the same model numbers and everything um

407
00:13:40,560 --> 00:13:42,959
they they can't have this vulnerability

408
00:13:42,959 --> 00:13:45,360
um exploited in the same way which is a

409
00:13:45,360 --> 00:13:47,680
bit sad

410
00:13:47,680 --> 00:13:49,199
but the kind of key takeaway here is

411
00:13:49,199 --> 00:13:50,720
that actually like

412
00:13:50,720 --> 00:13:52,720
mass-produced devices yeah they are

413
00:13:52,720 --> 00:13:55,040
insecure as tom said there's a lot of

414
00:13:55,040 --> 00:13:57,279
things that you have to get right and um

415
00:13:57,279 --> 00:13:58,800
unfortunately not a lot of vendors

416
00:13:58,800 --> 00:14:00,240
actually get them right

417
00:14:00,240 --> 00:14:01,839
but you can sometimes take these

418
00:14:01,839 --> 00:14:03,440
mass-produced devices which you can go

419
00:14:03,440 --> 00:14:04,959
and buy from the ghost of dick smith for

420
00:14:04,959 --> 00:14:07,120
like 25 bucks a pop and make them more

421
00:14:07,120 --> 00:14:08,720
useful um

422
00:14:08,720 --> 00:14:11,040
do your research have a have a good have

423
00:14:11,040 --> 00:14:12,320
a good look around about what it is that

424
00:14:12,320 --> 00:14:13,760
you're trying to do and what's kind of

425
00:14:13,760 --> 00:14:15,279
out there don't don't think you have to

426
00:14:15,279 --> 00:14:17,199
make your own hardware for everything

427
00:14:17,199 --> 00:14:18,240
from

428
00:14:18,240 --> 00:14:21,040
from the ground up

429
00:14:21,040 --> 00:14:22,800
and now uh jumping forward a little bit

430
00:14:22,800 --> 00:14:25,519
to may 2020 and just as we were leaving

431
00:14:25,519 --> 00:14:27,680
level four lockdown uh my garage door

432
00:14:27,680 --> 00:14:29,519
opener got cabin fever and decided that

433
00:14:29,519 --> 00:14:31,199
yeah no i'm just not going to work for

434
00:14:31,199 --> 00:14:32,639
you anymore

435
00:14:32,639 --> 00:14:33,920
apparently

436
00:14:33,920 --> 00:14:36,079
after 15 years of service if you don't

437
00:14:36,079 --> 00:14:38,160
get the springs tightened in your garage

438
00:14:38,160 --> 00:14:39,920
door like the actual motor doesn't do

439
00:14:39,920 --> 00:14:42,079
the heavy lifting it just kind of opens

440
00:14:42,079 --> 00:14:44,000
and closes it if you don't get your

441
00:14:44,000 --> 00:14:45,519
springs tightened every couple years

442
00:14:45,519 --> 00:14:47,360
you'll burn out the motor and then this

443
00:14:47,360 --> 00:14:48,880
is what happens and now you've got a

444
00:14:48,880 --> 00:14:52,160
brand new garage door opener to buy

445
00:14:52,160 --> 00:14:54,959
not great which is fine except the old

446
00:14:54,959 --> 00:14:57,839
opener had a 24 volt output that

447
00:14:57,839 --> 00:14:59,920
indicated whether or not the door was up

448
00:14:59,920 --> 00:15:02,160
or down which is really really useful so

449
00:15:02,160 --> 00:15:03,120
that

450
00:15:03,120 --> 00:15:04,639
if you accidentally say hey siri open

451
00:15:04,639 --> 00:15:06,399
the garage door and don't you dare do

452
00:15:06,399 --> 00:15:08,480
that please

453
00:15:08,480 --> 00:15:10,079
that you can then see whether or not you

454
00:15:10,079 --> 00:15:11,600
have actually done that or whether it's

455
00:15:11,600 --> 00:15:13,199
just ignored you

456
00:15:13,199 --> 00:15:15,040
i was able to read the open and close

457
00:15:15,040 --> 00:15:17,040
status through the small optocoupler

458
00:15:17,040 --> 00:15:18,959
circuit so an optocoupler is a device

459
00:15:18,959 --> 00:15:20,639
which takes um

460
00:15:20,639 --> 00:15:22,959
it basically creates inside the device a

461
00:15:22,959 --> 00:15:24,959
light on one side and then has a

462
00:15:24,959 --> 00:15:27,199
photosensitive resistor on the other so

463
00:15:27,199 --> 00:15:29,120
you can take any sort of voltage input

464
00:15:29,120 --> 00:15:31,600
and then monitor it with any other

465
00:15:31,600 --> 00:15:33,920
device including like a 3.3 volt or a 5

466
00:15:33,920 --> 00:15:36,399
volt raspberry pi

467
00:15:36,399 --> 00:15:38,000
but the new opener didn't have that

468
00:15:38,000 --> 00:15:39,120
output

469
00:15:39,120 --> 00:15:41,839
so instead it has a 24 volt output that

470
00:15:41,839 --> 00:15:43,519
indicates whether or not the garage door

471
00:15:43,519 --> 00:15:46,079
is moving which is kind of helpful but

472
00:15:46,079 --> 00:15:47,680
not what i actually want to know i want

473
00:15:47,680 --> 00:15:50,079
to know whether it's open or closed

474
00:15:50,079 --> 00:15:50,959
um

475
00:15:50,959 --> 00:15:52,399
there's a there's a bunch of different

476
00:15:52,399 --> 00:15:54,560
ways that you could solve this um but

477
00:15:54,560 --> 00:15:56,320
the way that sounded like the coolest

478
00:15:56,320 --> 00:15:58,000
bad idea to me

479
00:15:58,000 --> 00:15:59,440
was to tape something to the back of the

480
00:15:59,440 --> 00:16:01,120
garage door as opposed to like running a

481
00:16:01,120 --> 00:16:02,720
whole bunch of trunking and wiring all

482
00:16:02,720 --> 00:16:04,240
up and down

483
00:16:04,240 --> 00:16:08,360
that is an accelerometer connected to an

484
00:16:08,360 --> 00:16:11,440
esp8266 so the accelerometer works by

485
00:16:11,440 --> 00:16:14,720
detecting uh its orientation relative to

486
00:16:14,720 --> 00:16:15,440
to

487
00:16:15,440 --> 00:16:17,600
gravity so by taping it to the top of

488
00:16:17,600 --> 00:16:19,440
your garage door if the garage door is

489
00:16:19,440 --> 00:16:21,839
open even just a little bit

490
00:16:21,839 --> 00:16:23,680
that will tilt and then that will be

491
00:16:23,680 --> 00:16:25,040
detectable

492
00:16:25,040 --> 00:16:27,920
the bma 220 accelerometer that i use

493
00:16:27,920 --> 00:16:30,480
also has a handy interrupt so that i can

494
00:16:30,480 --> 00:16:32,639
put the esp into deep sleep not drain

495
00:16:32,639 --> 00:16:35,040
the batteries until the garage door is

496
00:16:35,040 --> 00:16:37,440
moving and then it wakes up connects to

497
00:16:37,440 --> 00:16:40,399
wi-fi talks to the mqtt server sends a

498
00:16:40,399 --> 00:16:42,000
message saying hey

499
00:16:42,000 --> 00:16:43,839
i'm opening now

500
00:16:43,839 --> 00:16:46,560
those are six double-a batteries which

501
00:16:46,560 --> 00:16:49,759
is has has lasted for quite a while i

502
00:16:49,759 --> 00:16:50,880
think it's about eight months at this

503
00:16:50,880 --> 00:16:52,720
point on this set of them

504
00:16:52,720 --> 00:16:54,880
i wanted double a batteries and not like

505
00:16:54,880 --> 00:16:57,519
a more powerful lithium pack because

506
00:16:57,519 --> 00:16:58,720
there's something about taping high

507
00:16:58,720 --> 00:17:00,240
explosive lithium to the back of my

508
00:17:00,240 --> 00:17:02,160
garage door which like sometimes gets

509
00:17:02,160 --> 00:17:04,400
wet due to condensation just seemed like

510
00:17:04,400 --> 00:17:07,199
a bad idea

511
00:17:07,760 --> 00:17:09,599
this is a graph of the messages that are

512
00:17:09,599 --> 00:17:11,359
sent to the mqtc

513
00:17:11,359 --> 00:17:16,079
mqtt server when the esp wakes up so

514
00:17:16,079 --> 00:17:18,480
you can see both the status open closed

515
00:17:18,480 --> 00:17:20,959
as well as the xyz

516
00:17:20,959 --> 00:17:23,119
orientation and as you can clearly see

517
00:17:23,119 --> 00:17:25,119
you can quite clearly see when it's open

518
00:17:25,119 --> 00:17:27,839
even just a little bit

519
00:17:27,839 --> 00:17:28,720
um

520
00:17:28,720 --> 00:17:30,240
lessons learned here

521
00:17:30,240 --> 00:17:32,080
look after your stuff for those of you

522
00:17:32,080 --> 00:17:34,080
who haven't watched the technology

523
00:17:34,080 --> 00:17:37,039
connections youtube guy um basically

524
00:17:37,039 --> 00:17:38,559
like he spends 30 minutes just

525
00:17:38,559 --> 00:17:40,160
explaining that if you look after things

526
00:17:40,160 --> 00:17:41,760
according to the way the manufacturers

527
00:17:41,760 --> 00:17:43,280
wanted you to look after them they'll

528
00:17:43,280 --> 00:17:44,640
last a long time and you'll get good

529
00:17:44,640 --> 00:17:46,320
results out of them get your springs

530
00:17:46,320 --> 00:17:48,160
tightened

531
00:17:48,160 --> 00:17:49,520
and the second is to invest in those

532
00:17:49,520 --> 00:17:51,760
architectural choices up front so

533
00:17:51,760 --> 00:17:54,640
because i'd put in place that mqtt bus

534
00:17:54,640 --> 00:17:56,720
i didn't have to write any more code to

535
00:17:56,720 --> 00:17:58,320
make it work with my existing system i

536
00:17:58,320 --> 00:17:59,840
basically just wired it into the

537
00:17:59,840 --> 00:18:02,240
existing channels and everything kept on

538
00:18:02,240 --> 00:18:04,000
working right away

539
00:18:04,000 --> 00:18:05,679
having that flexible point makes it

540
00:18:05,679 --> 00:18:07,840
possible to then as i said

541
00:18:07,840 --> 00:18:10,400
add devices change devices but also swap

542
00:18:10,400 --> 00:18:12,080
out components i could swap out that

543
00:18:12,080 --> 00:18:14,880
front end if i ever went to android for

544
00:18:14,880 --> 00:18:16,160
whatever reason

545
00:18:16,160 --> 00:18:17,520
i like software updates so i'm not going

546
00:18:17,520 --> 00:18:19,200
to do that but you know it's a

547
00:18:19,200 --> 00:18:21,760
possibility

548
00:18:21,760 --> 00:18:22,640
um

549
00:18:22,640 --> 00:18:24,400
then adding to the list of things

550
00:18:24,400 --> 00:18:26,480
breaking around my house earlier this

551
00:18:26,480 --> 00:18:27,919
year my air conditioner stopped working

552
00:18:27,919 --> 00:18:30,080
just as we were coming into winter

553
00:18:30,080 --> 00:18:32,160
that sequence of lights apparently means

554
00:18:32,160 --> 00:18:34,000
the indoor unit can't communicate with

555
00:18:34,000 --> 00:18:36,080
the outdoor unit and it's more than just

556
00:18:36,080 --> 00:18:37,679
a simple loose wire that's got

557
00:18:37,679 --> 00:18:39,360
disconnected

558
00:18:39,360 --> 00:18:41,360
and also apparently

559
00:18:41,360 --> 00:18:44,320
a pcb replacement for the outdoor unit

560
00:18:44,320 --> 00:18:47,360
again this thing's about 15 years old

561
00:18:47,360 --> 00:18:50,160
a pcb replacement was almost as much of

562
00:18:50,160 --> 00:18:52,080
as just getting a whole new air

563
00:18:52,080 --> 00:18:53,360
conditioner because there's something

564
00:18:53,360 --> 00:18:55,520
about covid in the global supply chain

565
00:18:55,520 --> 00:18:57,760
problems that means that like

566
00:18:57,760 --> 00:18:59,200
we've just got a whole bunch of problems

567
00:18:59,200 --> 00:19:00,559
with supply chain and parts aren't

568
00:19:00,559 --> 00:19:03,280
available anymore

569
00:19:03,280 --> 00:19:04,880
and with the new one came the

570
00:19:04,880 --> 00:19:06,799
opportunity to hook it up as well

571
00:19:06,799 --> 00:19:09,280
so there's an open source project

572
00:19:09,280 --> 00:19:10,640
i'll i've

573
00:19:10,640 --> 00:19:12,640
got a link in a further slide

574
00:19:12,640 --> 00:19:15,360
the interfaces with the cn-105 connector

575
00:19:15,360 --> 00:19:17,919
on mitsubishi heat pumps they're

576
00:19:17,919 --> 00:19:19,200
it's been the same connector in the same

577
00:19:19,200 --> 00:19:22,559
protocol for decades again used in large

578
00:19:22,559 --> 00:19:24,960
commercial

579
00:19:24,960 --> 00:19:27,200
applications where you need to integrate

580
00:19:27,200 --> 00:19:29,679
multiple units together mitsubishi also

581
00:19:29,679 --> 00:19:32,000
sells like a device that you can plug in

582
00:19:32,000 --> 00:19:33,840
which then talks to wi-fi and they've

583
00:19:33,840 --> 00:19:36,480
got some cloud thing and application

584
00:19:36,480 --> 00:19:38,720
that didn't sound nearly nearly as fun

585
00:19:38,720 --> 00:19:41,039
as being able to like open it up and

586
00:19:41,039 --> 00:19:44,320
take another esp8266 and then like wire

587
00:19:44,320 --> 00:19:46,400
it randomly in there

588
00:19:46,400 --> 00:19:48,640
um so naturally i did it and that's me

589
00:19:48,640 --> 00:19:51,200
um the day after it was installed with

590
00:19:51,200 --> 00:19:53,200
the cover off i had disconnected the

591
00:19:53,200 --> 00:19:55,440
power first be safe everyone

592
00:19:55,440 --> 00:19:56,559
um

593
00:19:56,559 --> 00:19:58,640
and i'd remember to use disconnectable

594
00:19:58,640 --> 00:20:01,600
jumpers so that you know esp82 a266s are

595
00:20:01,600 --> 00:20:03,919
notoriously unreliable sometimes and so

596
00:20:03,919 --> 00:20:05,520
if you need to be able to like swap it

597
00:20:05,520 --> 00:20:07,679
out or reflash the firmware being able

598
00:20:07,679 --> 00:20:09,360
to do that without without taking the

599
00:20:09,360 --> 00:20:12,320
whole unit apart is a great positive

600
00:20:12,320 --> 00:20:15,280
and looking back on it this was one of

601
00:20:15,280 --> 00:20:18,159
the top 10 stupidest things i have ever

602
00:20:18,159 --> 00:20:21,440
done in my life here i was

603
00:20:21,440 --> 00:20:24,480
with a brand new expensive heat pump in

604
00:20:24,480 --> 00:20:26,159
the middle of a global pandemic with

605
00:20:26,159 --> 00:20:29,200
supply shortages after waiting months

606
00:20:29,200 --> 00:20:31,280
for this thing to be installed

607
00:20:31,280 --> 00:20:34,159
in the middle of winter and here i was

608
00:20:34,159 --> 00:20:36,000
ripping it apart to plug in some dodgy

609
00:20:36,000 --> 00:20:37,919
electronics and run some code that i've

610
00:20:37,919 --> 00:20:40,240
never really reviewed and hope that it

611
00:20:40,240 --> 00:20:41,600
all works

612
00:20:41,600 --> 00:20:42,720
and like

613
00:20:42,720 --> 00:20:44,320
yeah um

614
00:20:44,320 --> 00:20:46,240
come to think of it like just because

615
00:20:46,240 --> 00:20:47,679
you can do something doesn't mean you

616
00:20:47,679 --> 00:20:49,280
should and i'd forgotten to watch that

617
00:20:49,280 --> 00:20:51,440
movie before you know attempting this

618
00:20:51,440 --> 00:20:52,480
one

619
00:20:52,480 --> 00:20:55,120
the risks definitely outweighed the

620
00:20:55,120 --> 00:20:58,240
benefits like i hardly ever use this

621
00:20:58,240 --> 00:21:00,720
like actually to automate or as part of

622
00:21:00,720 --> 00:21:02,960
any sort of automation process

623
00:21:02,960 --> 00:21:04,720
but i've got it there now so i might as

624
00:21:04,720 --> 00:21:07,360
well leave it i guess um

625
00:21:07,360 --> 00:21:09,360
but try to consider what your goals are

626
00:21:09,360 --> 00:21:11,120
and what it is that you're actually

627
00:21:11,120 --> 00:21:13,440
doing and is it helping you to achieve

628
00:21:13,440 --> 00:21:16,400
those goals

629
00:21:16,400 --> 00:21:18,320
um now this is the point in the talk

630
00:21:18,320 --> 00:21:20,799
where if i were american i'm hamiltonian

631
00:21:20,799 --> 00:21:23,039
canadian um i would put a disclaimer and

632
00:21:23,039 --> 00:21:25,200
say you know do not attempt this at home

633
00:21:25,200 --> 00:21:28,400
uh but i'm not so like just be safe

634
00:21:28,400 --> 00:21:31,120
how to be safe um so when you're dealing

635
00:21:31,120 --> 00:21:34,080
with 240 volt outlets worksafe have on

636
00:21:34,080 --> 00:21:35,919
the website the electrical codes of

637
00:21:35,919 --> 00:21:37,919
practice for homeowners which details

638
00:21:37,919 --> 00:21:39,520
requirements for

639
00:21:39,520 --> 00:21:41,440
how you can safely repair your own

640
00:21:41,440 --> 00:21:44,880
electrical appliances at home read them

641
00:21:44,880 --> 00:21:46,960
if you don't understand them if you

642
00:21:46,960 --> 00:21:47,840
don't

643
00:21:47,840 --> 00:21:49,440
if you aren't completely comfortable

644
00:21:49,440 --> 00:21:51,360
that you know what you're doing

645
00:21:51,360 --> 00:21:54,720
maybe like don't try this at home

646
00:21:54,720 --> 00:21:55,760
maybe

647
00:21:55,760 --> 00:21:58,640
um

648
00:21:58,640 --> 00:22:00,880
definitely read the instructions before

649
00:22:00,880 --> 00:22:03,280
you get started

650
00:22:03,280 --> 00:22:05,600
these are shelley devices which combine

651
00:22:05,600 --> 00:22:07,520
a relay and a switch input into

652
00:22:07,520 --> 00:22:09,360
something small enough to fit inside

653
00:22:09,360 --> 00:22:11,120
existing switch cavities

654
00:22:11,120 --> 00:22:13,039
here's two on my bench the black one can

655
00:22:13,039 --> 00:22:15,520
control two outputs independently

656
00:22:15,520 --> 00:22:17,280
the blue one can only control one of

657
00:22:17,280 --> 00:22:18,000
them

658
00:22:18,000 --> 00:22:20,240
i was recommended these by other people

659
00:22:20,240 --> 00:22:23,919
that i worked with hi phil hi matt

660
00:22:23,919 --> 00:22:25,360
mostly because of the electrical

661
00:22:25,360 --> 00:22:26,880
certification markings that you can see

662
00:22:26,880 --> 00:22:28,720
on the bottom i wasn't about to put

663
00:22:28,720 --> 00:22:30,720
random electronics in the walls of my

664
00:22:30,720 --> 00:22:32,480
home that i wasn't like completely

665
00:22:32,480 --> 00:22:34,000
comfortable wasn't going to burn the

666
00:22:34,000 --> 00:22:36,080
place down

667
00:22:36,080 --> 00:22:37,440
two things i kind of took for granted

668
00:22:37,440 --> 00:22:38,880
and this is a bit of a side note the

669
00:22:38,880 --> 00:22:40,880
first is that anything that has a wi-fi

670
00:22:40,880 --> 00:22:43,120
interface and can talk to the internet

671
00:22:43,120 --> 00:22:46,640
knows exactly where it is in the world

672
00:22:46,640 --> 00:22:48,400
because it can see wi-fi access points

673
00:22:48,400 --> 00:22:50,000
not just yours but the ones around it

674
00:22:50,000 --> 00:22:52,000
and it can use open source databases

675
00:22:52,000 --> 00:22:54,320
like weigel to work out exactly where it

676
00:22:54,320 --> 00:22:55,360
is

677
00:22:55,360 --> 00:22:57,280
depending on who you are you know just

678
00:22:57,280 --> 00:22:58,799
maybe something to keep in mind because

679
00:22:58,799 --> 00:23:00,880
i certainly didn't appreciate this until

680
00:23:00,880 --> 00:23:03,120
i saw my latitude and longitude and was

681
00:23:03,120 --> 00:23:07,200
like hey how did you find that like yeah

682
00:23:07,200 --> 00:23:08,880
and the second is that by god it's full

683
00:23:08,880 --> 00:23:10,880
of unencrypted http

684
00:23:10,880 --> 00:23:13,520
um i originally thought that it wasn't

685
00:23:13,520 --> 00:23:15,600
because i i did a packet capture on the

686
00:23:15,600 --> 00:23:17,520
network and i couldn't see any plain

687
00:23:17,520 --> 00:23:19,360
text like which you would normally see i

688
00:23:19,360 --> 00:23:21,039
thought hey have they just like invented

689
00:23:21,039 --> 00:23:22,960
their own binary protocol using the same

690
00:23:22,960 --> 00:23:25,760
port so that it gets out of firewalls

691
00:23:25,760 --> 00:23:27,120
but for those of you who might have

692
00:23:27,120 --> 00:23:29,200
noticed i was doing this at 10 30 at

693
00:23:29,200 --> 00:23:32,159
night and so i was just you know tired

694
00:23:32,159 --> 00:23:33,840
and not thinking properly

695
00:23:33,840 --> 00:23:36,320
if you have a hardware offload on your

696
00:23:36,320 --> 00:23:38,320
router you need to turn that off in

697
00:23:38,320 --> 00:23:39,440
order to be able to do a full packet

698
00:23:39,440 --> 00:23:41,679
capture so yes no it's definitely

699
00:23:41,679 --> 00:23:44,159
unencrypted going out to a server and

700
00:23:44,159 --> 00:23:46,240
downloading firmware updates

701
00:23:46,240 --> 00:23:47,919
which could be tampered by anyone in the

702
00:23:47,919 --> 00:23:49,279
middle of that

703
00:23:49,279 --> 00:23:50,640
but you'll note on the bottom that it's

704
00:23:50,640 --> 00:23:52,880
using the eu endpoint so at least it is

705
00:23:52,880 --> 00:23:54,880
gdpr compliant you know that's a that's

706
00:23:54,880 --> 00:23:57,200
a good positive

707
00:23:57,200 --> 00:23:58,799
in the end though i decided to go ahead

708
00:23:58,799 --> 00:24:00,480
with it because these things were not

709
00:24:00,480 --> 00:24:03,039
new risks i already had compensating

710
00:24:03,039 --> 00:24:04,880
controls to make up for the fact that

711
00:24:04,880 --> 00:24:06,720
you know i was putting something at a

712
00:24:06,720 --> 00:24:09,360
network level that was insecure into my

713
00:24:09,360 --> 00:24:10,240
home

714
00:24:10,240 --> 00:24:12,159
but because these are on a separate

715
00:24:12,159 --> 00:24:14,000
wireless ssid because they're in a

716
00:24:14,000 --> 00:24:15,840
separate vlan that can't normally talk

717
00:24:15,840 --> 00:24:17,279
out to the internet except when i'm

718
00:24:17,279 --> 00:24:19,039
explicitly allowing it to do firmware

719
00:24:19,039 --> 00:24:20,159
updates

720
00:24:20,159 --> 00:24:22,159
i've kind of mitigated these risks and i

721
00:24:22,159 --> 00:24:24,559
could look for other devices that didn't

722
00:24:24,559 --> 00:24:26,720
necessarily have these software

723
00:24:26,720 --> 00:24:28,960
vulnerabilities but then the quality of

724
00:24:28,960 --> 00:24:30,880
them in particular their electrical

725
00:24:30,880 --> 00:24:32,720
certifications might not be up to the

726
00:24:32,720 --> 00:24:35,440
same level of scratch so actually i care

727
00:24:35,440 --> 00:24:36,880
more about the fact that i don't want

728
00:24:36,880 --> 00:24:39,279
these things to burn my house down

729
00:24:39,279 --> 00:24:41,200
i ideally don't want them to get like

730
00:24:41,200 --> 00:24:43,520
stuxnetted but

731
00:24:43,520 --> 00:24:45,120
it's just not in my threat model to care

732
00:24:45,120 --> 00:24:46,640
about that

733
00:24:46,640 --> 00:24:48,880
this is me having partially installed it

734
00:24:48,880 --> 00:24:50,400
into a light switch

735
00:24:50,400 --> 00:24:52,480
and then this is it fully installed

736
00:24:52,480 --> 00:24:55,039
a really cool feature is that you can

737
00:24:55,039 --> 00:24:57,760
define triggers based on both short long

738
00:24:57,760 --> 00:25:00,240
and double press events so a short press

739
00:25:00,240 --> 00:25:02,320
for me turns on and off the main light

740
00:25:02,320 --> 00:25:04,960
in the room a long press turns off and

741
00:25:04,960 --> 00:25:06,880
on a small lamp

742
00:25:06,880 --> 00:25:08,720
which is really the whole reason why i

743
00:25:08,720 --> 00:25:10,559
did this in the first place is that when

744
00:25:10,559 --> 00:25:12,480
my son is falling asleep i want to be

745
00:25:12,480 --> 00:25:14,240
able to turn off the main light turn on

746
00:25:14,240 --> 00:25:16,000
the small light without having to move

747
00:25:16,000 --> 00:25:18,320
him um or have someone else in the room

748
00:25:18,320 --> 00:25:20,159
turn the switch on for me which doesn't

749
00:25:20,159 --> 00:25:21,440
always happen

750
00:25:21,440 --> 00:25:23,279
being able to do this from your watch is

751
00:25:23,279 --> 00:25:25,039
really really cool of course he's a

752
00:25:25,039 --> 00:25:26,320
clever clogs and now he wants to play

753
00:25:26,320 --> 00:25:27,679
with my watch to make the lights go on

754
00:25:27,679 --> 00:25:29,840
and off but that's a separate problem

755
00:25:29,840 --> 00:25:32,400
um so again some more lessons learned

756
00:25:32,400 --> 00:25:34,799
even good vendors even even ones that

757
00:25:34,799 --> 00:25:36,799
you recommended may still do

758
00:25:36,799 --> 00:25:39,440
less than ideal things from time to time

759
00:25:39,440 --> 00:25:42,000
but again prioritize your requirements i

760
00:25:42,000 --> 00:25:44,320
wanted that ul certification i wanted

761
00:25:44,320 --> 00:25:47,039
that rsm tick i didn't care so much

762
00:25:47,039 --> 00:25:50,159
about um whether or not it was going to

763
00:25:50,159 --> 00:25:52,159
like be controllable by some random

764
00:25:52,159 --> 00:25:53,919
person at some random time

765
00:25:53,919 --> 00:25:55,039
and again

766
00:25:55,039 --> 00:25:57,200
even with these risks i have mitigations

767
00:25:57,200 --> 00:25:59,200
i can put in place i'm not reliant on

768
00:25:59,200 --> 00:26:01,360
someone else to to

769
00:26:01,360 --> 00:26:03,840
um to protect me from bad things that

770
00:26:03,840 --> 00:26:06,880
could happen to these devices

771
00:26:06,880 --> 00:26:09,279
so wrapping up this is my current home

772
00:26:09,279 --> 00:26:11,600
network diagram or actually it's it's

773
00:26:11,600 --> 00:26:13,200
just the home automation bit i've got a

774
00:26:13,200 --> 00:26:15,600
whole lot of other devices um i'm

775
00:26:15,600 --> 00:26:17,520
i'm i'm i'm a little bit sad i read an

776
00:26:17,520 --> 00:26:19,200
article many years ago about like how

777
00:26:19,200 --> 00:26:20,799
the number of devices will exceed the

778
00:26:20,799 --> 00:26:23,679
number of humans and i was like nah

779
00:26:23,679 --> 00:26:25,279
it'll never happen

780
00:26:25,279 --> 00:26:26,159
um

781
00:26:26,159 --> 00:26:27,039
so

782
00:26:27,039 --> 00:26:28,640
on each of these things again if you're

783
00:26:28,640 --> 00:26:30,320
interested take a picture it lasts

784
00:26:30,320 --> 00:26:32,400
longer there's a whole bunch of github

785
00:26:32,400 --> 00:26:34,640
repos that are open i haven't talked

786
00:26:34,640 --> 00:26:35,919
about some of the other cool things that

787
00:26:35,919 --> 00:26:37,679
i'm doing so like you know because i've

788
00:26:37,679 --> 00:26:40,000
got that common integration bus i've

789
00:26:40,000 --> 00:26:42,640
also got a slack bot which which listens

790
00:26:42,640 --> 00:26:44,559
in the channels where alerts happen so

791
00:26:44,559 --> 00:26:46,159
that if someone's breaking into my home

792
00:26:46,159 --> 00:26:48,080
or something's gone wrong and i'm at the

793
00:26:48,080 --> 00:26:49,840
beach i can get an alert and start

794
00:26:49,840 --> 00:26:51,440
freaking out and not be able to do

795
00:26:51,440 --> 00:26:52,720
anything because i don't have a robot to

796
00:26:52,720 --> 00:26:54,159
actually go and like hit them with a

797
00:26:54,159 --> 00:26:56,000
hammer or something that's coming

798
00:26:56,000 --> 00:26:57,120
um

799
00:26:57,120 --> 00:26:59,600
i've also got everything logging off to

800
00:26:59,600 --> 00:27:02,000
azure so that i can have those you know

801
00:27:02,000 --> 00:27:04,240
like that graph that i showed you which

802
00:27:04,240 --> 00:27:06,640
which had the garage door statuses i can

803
00:27:06,640 --> 00:27:08,240
i can check things over time i can

804
00:27:08,240 --> 00:27:10,080
measure temperature and humidity changes

805
00:27:10,080 --> 00:27:11,840
over time really kind of cool just

806
00:27:11,840 --> 00:27:13,840
having logs available

807
00:27:13,840 --> 00:27:15,120
um

808
00:27:15,120 --> 00:27:16,080
and

809
00:27:16,080 --> 00:27:17,600
um

810
00:27:17,600 --> 00:27:20,080
yeah so with mqtt it is one of the

811
00:27:20,080 --> 00:27:22,080
better protocols to use because you can

812
00:27:22,080 --> 00:27:24,320
both do things like turn on

813
00:27:24,320 --> 00:27:26,880
ssl encryption so you can have things

814
00:27:26,880 --> 00:27:28,960
not just talking plain text on the wire

815
00:27:28,960 --> 00:27:31,360
you've got fairly granular controls in

816
00:27:31,360 --> 00:27:33,360
terms of access control lists so you

817
00:27:33,360 --> 00:27:35,679
can't just have random light switch a

818
00:27:35,679 --> 00:27:37,600
talking to random temperature sensor b

819
00:27:37,600 --> 00:27:39,200
kind of thing

820
00:27:39,200 --> 00:27:40,720
really cool stuff again if you're

821
00:27:40,720 --> 00:27:42,960
interested in any of this i'm not going

822
00:27:42,960 --> 00:27:44,480
deep on any of the technical components

823
00:27:44,480 --> 00:27:47,600
but feel free to reach out to me

824
00:27:47,600 --> 00:27:50,799
so in short like yes iot devices home

825
00:27:50,799 --> 00:27:53,200
automation stuff is insecure like these

826
00:27:53,200 --> 00:27:54,080
are

827
00:27:54,080 --> 00:27:56,799
cheap and featureful and mass-produced

828
00:27:56,799 --> 00:27:59,200
devices you're not going to get a high

829
00:27:59,200 --> 00:28:01,200
level of security assurance from them

830
00:28:01,200 --> 00:28:03,200
but that doesn't mean that you

831
00:28:03,200 --> 00:28:05,360
can't use them shouldn't use them in

832
00:28:05,360 --> 00:28:08,799
some cases having them can help you

833
00:28:08,799 --> 00:28:10,559
protect your home as i said with the

834
00:28:10,559 --> 00:28:12,960
alarm system by doing all this stuff i'm

835
00:28:12,960 --> 00:28:14,880
now actually setting the alarm and

836
00:28:14,880 --> 00:28:16,000
that's something that a lot of people

837
00:28:16,000 --> 00:28:17,600
don't do

838
00:28:17,600 --> 00:28:20,399
um and of course have fun like this this

839
00:28:20,399 --> 00:28:22,080
stuff is coming and there's going to be

840
00:28:22,080 --> 00:28:23,919
a lot of crossover between what people

841
00:28:23,919 --> 00:28:26,159
do in their homes what they do at work

842
00:28:26,159 --> 00:28:28,399
over the next couple years it's a great

843
00:28:28,399 --> 00:28:30,720
idea to experiment in an environment

844
00:28:30,720 --> 00:28:32,480
where it's a lot more safe to experiment

845
00:28:32,480 --> 00:28:34,000
as opposed to like doing something for

846
00:28:34,000 --> 00:28:36,000
the first time in prague at a major

847
00:28:36,000 --> 00:28:37,760
customer

848
00:28:37,760 --> 00:28:39,760
finally i'd like to give a big thank you

849
00:28:39,760 --> 00:28:41,279
to my wife beverly for allowing me to

850
00:28:41,279 --> 00:28:42,720
tinker with things over the last couple

851
00:28:42,720 --> 00:28:43,840
years

852
00:28:43,840 --> 00:28:45,279
i know how frustrating that can be

853
00:28:45,279 --> 00:28:47,840
sometimes thank you

854
00:28:47,840 --> 00:28:51,200
um and that's it that's me email twitter

855
00:28:51,200 --> 00:28:52,880
slack discord again if you're interested

856
00:28:52,880 --> 00:28:55,600
in this hit me up and

857
00:28:55,600 --> 00:28:56,720
finally

858
00:28:56,720 --> 00:28:59,039
in cyber cx news uh this is a hacker

859
00:28:59,039 --> 00:29:01,440
conference we have a hackathon going in

860
00:29:01,440 --> 00:29:03,520
about a month's time if you're just

861
00:29:03,520 --> 00:29:06,480
getting started if you uh want to like

862
00:29:06,480 --> 00:29:08,480
actually have a sandbox environment and

863
00:29:08,480 --> 00:29:11,360
cash prizes go and check that out

864
00:29:11,360 --> 00:29:12,970
thank you very much

865
00:29:12,970 --> 00:29:16,380
[Applause]

