1
00:00:05,359 --> 00:00:06,640
so what i'm going to look at today in

2
00:00:06,640 --> 00:00:07,759
this talk

3
00:00:07,759 --> 00:00:09,360
i'm going to go over what is a denial of

4
00:00:09,360 --> 00:00:10,719
service attack

5
00:00:10,719 --> 00:00:12,480
why people will actually go and perform

6
00:00:12,480 --> 00:00:14,480
denial service attacks what they're

7
00:00:14,480 --> 00:00:16,239
going to do and target how they're going

8
00:00:16,239 --> 00:00:19,520
to identify and targe find these targets

9
00:00:19,520 --> 00:00:20,720
and then finally we're going to finish

10
00:00:20,720 --> 00:00:22,800
up with how to protect your systems and

11
00:00:22,800 --> 00:00:24,640
a bit about prioritization and ordering

12
00:00:24,640 --> 00:00:27,840
the tasks into a plan

13
00:00:27,840 --> 00:00:30,480
so what is a denial of service attack

14
00:00:30,480 --> 00:00:31,760
they fall into

15
00:00:31,760 --> 00:00:33,600
it's when an attacker is going to do

16
00:00:33,600 --> 00:00:35,680
some actions that make your system

17
00:00:35,680 --> 00:00:38,960
unstable and unavailable to users it may

18
00:00:38,960 --> 00:00:41,360
also not be an attacker it could be

19
00:00:41,360 --> 00:00:45,039
someone at facebook doing a bgp upgrade

20
00:00:45,039 --> 00:00:48,960
and taking the whole company offline

21
00:00:48,960 --> 00:00:51,440
but that aside the these two main types

22
00:00:51,440 --> 00:00:54,559
is volumetric last seven protocol

23
00:00:54,559 --> 00:00:56,480
so volumetric

24
00:00:56,480 --> 00:00:58,399
is when they just send so much traffic

25
00:00:58,399 --> 00:01:00,399
everything gets clogged up nothing can

26
00:01:00,399 --> 00:01:02,160
work on the server the pipes are full

27
00:01:02,160 --> 00:01:06,240
the firewalls run out of cpu

28
00:01:06,240 --> 00:01:08,000
last 7 protocol is a little bit more

29
00:01:08,000 --> 00:01:09,840
targeted and this is when you start

30
00:01:09,840 --> 00:01:11,280
exploiting weaknesses in the

31
00:01:11,280 --> 00:01:12,720
infrastructure

32
00:01:12,720 --> 00:01:14,479
or the application these are quite

33
00:01:14,479 --> 00:01:16,159
attractive to attackers because they're

34
00:01:16,159 --> 00:01:18,159
going to have a low input with a high

35
00:01:18,159 --> 00:01:20,000
impact

36
00:01:20,000 --> 00:01:22,080
so for instance one request will tie up

37
00:01:22,080 --> 00:01:23,920
and stop other requests being made so if

38
00:01:23,920 --> 00:01:26,159
there's a database query that locks

39
00:01:26,159 --> 00:01:27,680
everything up and the other users can't

40
00:01:27,680 --> 00:01:28,960
use the system

41
00:01:28,960 --> 00:01:30,720
that's that and this is also quite hard

42
00:01:30,720 --> 00:01:32,960
to filter and target

43
00:01:32,960 --> 00:01:35,200
remove because it's going to look like

44
00:01:35,200 --> 00:01:37,280
legitimate traffic normal users using

45
00:01:37,280 --> 00:01:39,520
the system

46
00:01:39,520 --> 00:01:40,960
and it may sort of take the form of if

47
00:01:40,960 --> 00:01:42,799
anyone's had a performance test report

48
00:01:42,799 --> 00:01:44,799
there'll be some slow pages or something

49
00:01:44,799 --> 00:01:46,000
that comes up

50
00:01:46,000 --> 00:01:47,840
so the business owner may just say oh

51
00:01:47,840 --> 00:01:49,439
don't worry about that page it's used

52
00:01:49,439 --> 00:01:50,960
once a quarter

53
00:01:50,960 --> 00:01:52,560
it doesn't matter if it takes an extra

54
00:01:52,560 --> 00:01:54,560
30 seconds no one's really going to

55
00:01:54,560 --> 00:01:57,119
worry about it but as an attacker i'll

56
00:01:57,119 --> 00:01:58,799
go yep that's exactly what want to hit

57
00:01:58,799 --> 00:02:00,000
and i'm just going to hit that over and

58
00:02:00,000 --> 00:02:01,200
over and over again and it's going to

59
00:02:01,200 --> 00:02:03,600
use up all your cpu or disk space or

60
00:02:03,600 --> 00:02:05,040
database queries or something along

61
00:02:05,040 --> 00:02:07,280
those lines

62
00:02:07,280 --> 00:02:09,038
it may also take the form of

63
00:02:09,038 --> 00:02:10,800
vulnerabilities in the application that

64
00:02:10,800 --> 00:02:14,000
crashes it causes infinite loops uh zip

65
00:02:14,000 --> 00:02:16,160
bombs so this is when you have a large

66
00:02:16,160 --> 00:02:18,560
file that sits down really small and for

67
00:02:18,560 --> 00:02:20,160
instance you could attach that to an

68
00:02:20,160 --> 00:02:21,200
email

69
00:02:21,200 --> 00:02:23,760
as the antivirus on the email extracts

70
00:02:23,760 --> 00:02:24,959
the

71
00:02:24,959 --> 00:02:25,920
file

72
00:02:25,920 --> 00:02:27,680
it uses up all the memory all the disk

73
00:02:27,680 --> 00:02:29,840
space and then your av checking on your

74
00:02:29,840 --> 00:02:32,800
inbound emails stops working

75
00:02:32,800 --> 00:02:35,440
some of that is say xml billion laughed

76
00:02:35,440 --> 00:02:38,319
so this is recursively expanding xml

77
00:02:38,319 --> 00:02:40,480
this that xml will expand out to about

78
00:02:40,480 --> 00:02:42,319
three gigabytes of memory and it's only

79
00:02:42,319 --> 00:02:45,519
about a dozen lines long so quite small

80
00:02:45,519 --> 00:02:47,920
sure most xml libraries will block that

81
00:02:47,920 --> 00:02:50,239
these days still find stuff that will

82
00:02:50,239 --> 00:02:52,640
crash

83
00:02:52,720 --> 00:02:55,440
so which ones will attackers use layer 7

84
00:02:55,440 --> 00:02:58,159
volumetric on a large attack these big

85
00:02:58,159 --> 00:03:00,000
coordinate attacks that we've seen in

86
00:03:00,000 --> 00:03:01,599
the last few months last year with

87
00:03:01,599 --> 00:03:03,680
winzide x they're going to use a variety

88
00:03:03,680 --> 00:03:05,440
of methods and they're going to find

89
00:03:05,440 --> 00:03:06,720
their attack which is going to return

90
00:03:06,720 --> 00:03:08,879
the best benefit best return on

91
00:03:08,879 --> 00:03:11,200
investment for their attacker to get the

92
00:03:11,200 --> 00:03:12,319
best

93
00:03:12,319 --> 00:03:14,720
well the worst crash on the

94
00:03:14,720 --> 00:03:16,239
on the target

95
00:03:16,239 --> 00:03:18,720
for them a little bit sort of

96
00:03:18,720 --> 00:03:20,560
terminology denial of service attack

97
00:03:20,560 --> 00:03:23,519
that's the overall overarching class of

98
00:03:23,519 --> 00:03:25,760
vulnerabilities a distributed denial of

99
00:03:25,760 --> 00:03:28,080
service attack as a particular subset of

100
00:03:28,080 --> 00:03:29,920
denial of service attacks

101
00:03:29,920 --> 00:03:32,159
where a large bot net or similar is used

102
00:03:32,159 --> 00:03:34,560
to send targets so it's distributed the

103
00:03:34,560 --> 00:03:36,080
traffic's come from a distributed

104
00:03:36,080 --> 00:03:37,440
network

105
00:03:37,440 --> 00:03:39,519
um often a botnet

106
00:03:39,519 --> 00:03:41,200
so why do people want to perform a

107
00:03:41,200 --> 00:03:43,519
denial of service attack

108
00:03:43,519 --> 00:03:45,360
it all comes down to motives um

109
00:03:45,360 --> 00:03:49,200
ransomware the blackmail style

110
00:03:49,360 --> 00:03:52,959
dos like we saw so with nzx last year it

111
00:03:52,959 --> 00:03:54,319
it's a business

112
00:03:54,319 --> 00:03:57,280
they've got some kpis to achieve

113
00:03:57,280 --> 00:03:58,720
their shareholders are going to want

114
00:03:58,720 --> 00:04:01,360
dividends it's a company you know to the

115
00:04:01,360 --> 00:04:03,120
point of they'll have a service desk who

116
00:04:03,120 --> 00:04:04,720
will help walk you through buying

117
00:04:04,720 --> 00:04:07,120
bitcoin they're most probably and this

118
00:04:07,120 --> 00:04:08,560
some of their service desks are a lot

119
00:04:08,560 --> 00:04:10,400
better than normal organizations because

120
00:04:10,400 --> 00:04:12,080
how many service desks could actually

121
00:04:12,080 --> 00:04:15,840
walk someone through buying bitcoin

122
00:04:16,238 --> 00:04:17,759
if it's an issue motivated group they

123
00:04:17,759 --> 00:04:19,600
might just dislike your organization so

124
00:04:19,600 --> 00:04:21,680
they're going to attack you

125
00:04:21,680 --> 00:04:23,759
because they just don't like you it may

126
00:04:23,759 --> 00:04:25,199
also be used for a distraction if you're

127
00:04:25,199 --> 00:04:26,479
doing another attack you want to

128
00:04:26,479 --> 00:04:29,199
exfiltrate some data plant a back door

129
00:04:29,199 --> 00:04:30,479
or something

130
00:04:30,479 --> 00:04:32,400
you do a denial of service attack that's

131
00:04:32,400 --> 00:04:34,160
really noisy you get the sock and the

132
00:04:34,160 --> 00:04:36,639
security team focused on that while

133
00:04:36,639 --> 00:04:38,080
you're doing some other attack somewhere

134
00:04:38,080 --> 00:04:40,960
else in the business

135
00:04:41,280 --> 00:04:44,160
so with the dos for blackmail and

136
00:04:44,160 --> 00:04:46,160
ransomware there are some similarities

137
00:04:46,160 --> 00:04:48,160
hey they're both wanting money for some

138
00:04:48,160 --> 00:04:49,600
sort of thing but there's a little bit

139
00:04:49,600 --> 00:04:51,440
of a difference in that

140
00:04:51,440 --> 00:04:52,400
for

141
00:04:52,400 --> 00:04:54,479
denial of service it's normally a threat

142
00:04:54,479 --> 00:04:57,199
money for a threat so give me some money

143
00:04:57,199 --> 00:04:59,600
or i'll doss you while ransomware is hey

144
00:04:59,600 --> 00:05:01,759
i've locked all your files give me money

145
00:05:01,759 --> 00:05:03,199
like that is starting to change a little

146
00:05:03,199 --> 00:05:05,440
bit with ransomware because there's now

147
00:05:05,440 --> 00:05:08,960
also money so we don't leak it

148
00:05:08,960 --> 00:05:12,080
um and some say the ncdx attacks last

149
00:05:12,080 --> 00:05:13,919
year lasted for so long was being

150
00:05:13,919 --> 00:05:16,560
covered in the media so the group behind

151
00:05:16,560 --> 00:05:19,680
it was using it as advertising as for

152
00:05:19,680 --> 00:05:21,199
their cv to say hey we're actually

153
00:05:21,199 --> 00:05:23,199
really competent what we could do we can

154
00:05:23,199 --> 00:05:24,720
have a long run in attack you really

155
00:05:24,720 --> 00:05:26,400
want to pay us when we

156
00:05:26,400 --> 00:05:29,520
tell you we're going to dos you

157
00:05:29,759 --> 00:05:31,600
so how are denial of service attacks

158
00:05:31,600 --> 00:05:33,680
performed

159
00:05:33,680 --> 00:05:34,479
so

160
00:05:34,479 --> 00:05:36,560
methodology so for the volumetric

161
00:05:36,560 --> 00:05:38,000
attacks you're most probably going to

162
00:05:38,000 --> 00:05:39,600
need a botnet

163
00:05:39,600 --> 00:05:41,199
quite often compromise a whole bunch of

164
00:05:41,199 --> 00:05:43,280
cheap isp modems routers of default

165
00:05:43,280 --> 00:05:45,440
creds get them to send a whole lot of

166
00:05:45,440 --> 00:05:46,800
traffic

167
00:05:46,800 --> 00:05:50,240
most of it will be icmp or udp

168
00:05:50,240 --> 00:05:52,240
tcp not so much just because of the

169
00:05:52,240 --> 00:05:54,479
handshakes and it establishes a bit more

170
00:05:54,479 --> 00:05:57,120
you'd more use the tcp and

171
00:05:57,120 --> 00:05:58,000
your

172
00:05:58,000 --> 00:05:59,520
last seven attacks

173
00:05:59,520 --> 00:06:01,600
udp is quite interesting because it can

174
00:06:01,600 --> 00:06:03,520
be you can use it for reflective and

175
00:06:03,520 --> 00:06:06,479
amplification so reflective has seen udp

176
00:06:06,479 --> 00:06:08,560
messages you could set the

177
00:06:08,560 --> 00:06:10,080
source address so

178
00:06:10,080 --> 00:06:12,240
to be your target opposed to you so in

179
00:06:12,240 --> 00:06:14,319
this example we've got the botnet it's

180
00:06:14,319 --> 00:06:16,800
doing a dns query it's set the source is

181
00:06:16,800 --> 00:06:18,720
actually the target so when the dns

182
00:06:18,720 --> 00:06:20,880
server responds it's sending it to the

183
00:06:20,880 --> 00:06:22,960
target not back to the botnet and

184
00:06:22,960 --> 00:06:25,840
there's also amplification going on

185
00:06:25,840 --> 00:06:28,639
in that you know the dns request might

186
00:06:28,639 --> 00:06:31,199
only be 24 bytes quite small the

187
00:06:31,199 --> 00:06:33,199
response can be up to 512 bytes so

188
00:06:33,199 --> 00:06:35,440
you're getting a 20 times amplification

189
00:06:35,440 --> 00:06:36,800
going on so

190
00:06:36,800 --> 00:06:38,960
you know if we got one byte leaving the

191
00:06:38,960 --> 00:06:41,120
botnet you've actually got 20 bytes

192
00:06:41,120 --> 00:06:43,919
hitting the target

193
00:06:44,400 --> 00:06:47,120
dangers of open udp ports we're a

194
00:06:47,120 --> 00:06:49,440
customer a couple of years back and

195
00:06:49,440 --> 00:06:52,080
they'd left a ms sequel udp port opened

196
00:06:52,080 --> 00:06:53,360
to the internet

197
00:06:53,360 --> 00:06:55,520
it was used in a reflective attack so

198
00:06:55,520 --> 00:06:56,880
they were just

199
00:06:56,880 --> 00:06:58,479
that middle dna server they weren't

200
00:06:58,479 --> 00:07:01,039
actually the target of their attack

201
00:07:01,039 --> 00:07:02,560
and they received a multi-thousand

202
00:07:02,560 --> 00:07:05,199
dollar azure bill just over the weekend

203
00:07:05,199 --> 00:07:06,319
and they were just the relay they

204
00:07:06,319 --> 00:07:09,440
weren't actually the target in this case

205
00:07:09,440 --> 00:07:11,120
so how do you go about making botnets

206
00:07:11,120 --> 00:07:11,840
well

207
00:07:11,840 --> 00:07:14,240
on the internet there's a bunch of old

208
00:07:14,240 --> 00:07:17,039
stuff which isn't patched stuff that

209
00:07:17,039 --> 00:07:18,479
should just really not be on the

210
00:07:18,479 --> 00:07:20,960
internet

211
00:07:21,280 --> 00:07:22,560
people just leave things with the

212
00:07:22,560 --> 00:07:24,479
default creds on the front page so you

213
00:07:24,479 --> 00:07:26,880
can log in on them some people put

214
00:07:26,880 --> 00:07:30,080
things on the internet with no passwords

215
00:07:30,080 --> 00:07:32,400
um and if that's all too much

216
00:07:32,400 --> 00:07:33,520
there's

217
00:07:33,520 --> 00:07:35,360
stress testing and

218
00:07:35,360 --> 00:07:37,520
as a service so you can just use your

219
00:07:37,520 --> 00:07:38,319
dos

220
00:07:38,319 --> 00:07:40,560
as a service that's 2021 everything's as

221
00:07:40,560 --> 00:07:43,280
a service right

222
00:07:43,360 --> 00:07:46,639
so last seven denial of service attacks

223
00:07:46,639 --> 00:07:48,240
firstly you need to find a vulnerability

224
00:07:48,240 --> 00:07:49,680
in the application of the network to

225
00:07:49,680 --> 00:07:52,080
exploit so there's a bit more

226
00:07:52,080 --> 00:07:53,599
research and reconnaissance that needs

227
00:07:53,599 --> 00:07:55,120
to go into this

228
00:07:55,120 --> 00:07:57,440
you still mostly use a bit of a buffnet

229
00:07:57,440 --> 00:07:59,919
botnet but you'll need a lot less hosts

230
00:07:59,919 --> 00:08:02,240
because you're targeting a particular

231
00:08:02,240 --> 00:08:03,199
piece

232
00:08:03,199 --> 00:08:04,639
and the application of the target for

233
00:08:04,639 --> 00:08:05,840
example

234
00:08:05,840 --> 00:08:07,280
where the customer said oh yeah we've

235
00:08:07,280 --> 00:08:09,680
paid for dos mitigations we'd like you

236
00:08:09,680 --> 00:08:12,720
to test it found out that all these

237
00:08:12,720 --> 00:08:14,400
um preventions were sort of for

238
00:08:14,400 --> 00:08:16,240
volumetric attacks so we

239
00:08:16,240 --> 00:08:18,879
spun up an ec2 instance for about 12

240
00:08:18,879 --> 00:08:20,800
cents an hour

241
00:08:20,800 --> 00:08:23,360
and the server went down with sort of

242
00:08:23,360 --> 00:08:25,520
a low number hundreds or a low thousands

243
00:08:25,520 --> 00:08:28,319
of requests per second nothing too

244
00:08:28,319 --> 00:08:30,639
much

245
00:08:31,120 --> 00:08:33,919
so what's an attacker going to go after

246
00:08:33,919 --> 00:08:36,719
an attack in an organization

247
00:08:36,719 --> 00:08:38,399
so we had the motives before and these

248
00:08:38,399 --> 00:08:41,200
will tie into the goals

249
00:08:41,200 --> 00:08:43,200
so the blackmail they're going to find

250
00:08:43,200 --> 00:08:44,640
something that's going to disrupt

251
00:08:44,640 --> 00:08:46,080
business operations so you're going to

252
00:08:46,080 --> 00:08:47,760
pay it because you need to get your

253
00:08:47,760 --> 00:08:50,160
business going again

254
00:08:50,160 --> 00:08:51,839
if it's public relations they want

255
00:08:51,839 --> 00:08:54,080
something that's publicly facing so it's

256
00:08:54,080 --> 00:08:56,640
going to get some media coverage

257
00:08:56,640 --> 00:08:58,720
so they can attach their message about

258
00:08:58,720 --> 00:09:01,120
how bad your company is to that media

259
00:09:01,120 --> 00:09:02,880
coverage and if it's distraction the

260
00:09:02,880 --> 00:09:04,320
most probably won't do a little bit

261
00:09:04,320 --> 00:09:07,320
everywhere

262
00:09:09,440 --> 00:09:12,399
so attacker's mindset

263
00:09:12,399 --> 00:09:14,000
um you know if it's a pressure of a

264
00:09:14,000 --> 00:09:16,560
website why bother business is just

265
00:09:16,560 --> 00:09:18,000
going to continue the website's not

266
00:09:18,000 --> 00:09:19,120
actually doing something so you want to

267
00:09:19,120 --> 00:09:20,880
find targets that are going to affect

268
00:09:20,880 --> 00:09:22,720
the business in some ways that people

269
00:09:22,720 --> 00:09:24,240
are going to notice it

270
00:09:24,240 --> 00:09:26,000
so a lot of people say hey you got to

271
00:09:26,000 --> 00:09:27,760
where it's just the websites you need to

272
00:09:27,760 --> 00:09:29,839
worry about we'll put a cdn in front of

273
00:09:29,839 --> 00:09:31,279
it or a wef

274
00:09:31,279 --> 00:09:33,120
you're all good

275
00:09:33,120 --> 00:09:34,399
but so

276
00:09:34,399 --> 00:09:36,320
you know cdns content distribution

277
00:09:36,320 --> 00:09:38,320
networks will have a

278
00:09:38,320 --> 00:09:40,320
some scrubbing some dos scrubbing

279
00:09:40,320 --> 00:09:41,920
they'll have some weapon there they

280
00:09:41,920 --> 00:09:43,279
might

281
00:09:43,279 --> 00:09:45,120
um throttle stuff they'll do some case

282
00:09:45,120 --> 00:09:47,120
sheet to try and stop all the requests

283
00:09:47,120 --> 00:09:48,640
going back to the origin server which is

284
00:09:48,640 --> 00:09:49,920
the actual server that's running the

285
00:09:49,920 --> 00:09:52,080
database in the application so as an

286
00:09:52,080 --> 00:09:53,920
attacker we want to find a way to get

287
00:09:53,920 --> 00:09:56,000
around that cdn and go directly to the

288
00:09:56,000 --> 00:09:57,440
origin server because if we can hit that

289
00:09:57,440 --> 00:09:59,519
directly chances are we can knock that

290
00:09:59,519 --> 00:10:01,920
offline

291
00:10:02,480 --> 00:10:04,800
so you know this can be quite easy to

292
00:10:04,800 --> 00:10:05,600
find

293
00:10:05,600 --> 00:10:06,399
for

294
00:10:06,399 --> 00:10:09,120
example some companies who go oh cdns

295
00:10:09,120 --> 00:10:10,240
cost a lot of money so we'll just put

296
00:10:10,240 --> 00:10:13,120
production on a cd and test doesn't

297
00:10:13,120 --> 00:10:14,640
matter we'll just have that people

298
00:10:14,640 --> 00:10:16,720
directly hook into the server so hey

299
00:10:16,720 --> 00:10:19,519
we'll find the test url

300
00:10:19,519 --> 00:10:22,320
not behind a cdn what are the chances

301
00:10:22,320 --> 00:10:23,760
are that the prod server and the test

302
00:10:23,760 --> 00:10:26,320
server are behind the same firewall

303
00:10:26,320 --> 00:10:28,399
yeah that's fairly you know pretty

304
00:10:28,399 --> 00:10:29,680
common

305
00:10:29,680 --> 00:10:32,480
same host that's unfortunately also far

306
00:10:32,480 --> 00:10:35,200
too common same database about the same

307
00:10:35,200 --> 00:10:36,399
if it's on the same host it's going to

308
00:10:36,399 --> 00:10:38,640
be on the same database so we can attack

309
00:10:38,640 --> 00:10:39,920
the test server and we actually will

310
00:10:39,920 --> 00:10:43,680
take production off at the same time

311
00:10:45,040 --> 00:10:47,120
so and so we had those screenshots

312
00:10:47,120 --> 00:10:49,200
before that zx security has a tool

313
00:10:49,200 --> 00:10:50,800
internally which we call flaming ping

314
00:10:50,800 --> 00:10:52,399
which which is similar to showdown or

315
00:10:52,399 --> 00:10:54,560
metal slow hand kiwi fruit and that's

316
00:10:54,560 --> 00:10:56,640
scanning new zealand's ip address space

317
00:10:56,640 --> 00:10:58,240
to identify what's there doing port

318
00:10:58,240 --> 00:11:00,480
scans the screenshots which you saw

319
00:11:00,480 --> 00:11:02,320
before

320
00:11:02,320 --> 00:11:04,240
and it'll be fair to assume an attacker

321
00:11:04,240 --> 00:11:05,680
is going to do something something

322
00:11:05,680 --> 00:11:07,519
similar to find all your other

323
00:11:07,519 --> 00:11:09,120
infrastructure that isn't just your

324
00:11:09,120 --> 00:11:10,560
website

325
00:11:10,560 --> 00:11:12,640
so for instance we can identify branch

326
00:11:12,640 --> 00:11:15,200
sites and retail sites

327
00:11:15,200 --> 00:11:17,279
through the stall so we'll find people

328
00:11:17,279 --> 00:11:19,839
who'll put their tank status directly on

329
00:11:19,839 --> 00:11:21,279
on the internet

330
00:11:21,279 --> 00:11:23,040
sometimes if you need to you need to

331
00:11:23,040 --> 00:11:24,640
know exactly how much fuel you've got in

332
00:11:24,640 --> 00:11:27,839
all your fuel tanks at your truck

333
00:11:27,839 --> 00:11:29,200
if you're a

334
00:11:29,200 --> 00:11:31,040
supermarket you'll

335
00:11:31,040 --> 00:11:32,720
need to know whether your fridges are

336
00:11:32,720 --> 00:11:35,040
working or not

337
00:11:35,040 --> 00:11:37,120
and if you're a little pizza store

338
00:11:37,120 --> 00:11:38,399
you'll need to put your point of sale

339
00:11:38,399 --> 00:11:40,800
system directly on the internet

340
00:11:40,800 --> 00:11:42,480
including the page

341
00:11:42,480 --> 00:11:44,160
that appeared to allow you to edit all

342
00:11:44,160 --> 00:11:46,719
the prices

343
00:11:48,399 --> 00:11:50,880
so and when so these are retail sites so

344
00:11:50,880 --> 00:11:53,680
as an attacker i found a retail site i'm

345
00:11:53,680 --> 00:11:55,040
thinking chances are this is going to be

346
00:11:55,040 --> 00:11:57,440
on a ufb or cell connection

347
00:11:57,440 --> 00:11:59,279
chances are these aren't going to have

348
00:11:59,279 --> 00:12:01,120
dos scrubbing or

349
00:12:01,120 --> 00:12:02,639
monitoring by the isp because they're

350
00:12:02,639 --> 00:12:04,560
just sort of normal residential style

351
00:12:04,560 --> 00:12:05,760
connections

352
00:12:05,760 --> 00:12:07,040
but what are the chances are that the

353
00:12:07,040 --> 00:12:08,959
point of sale and ifpos machine is using

354
00:12:08,959 --> 00:12:10,880
the same internet connection so if i

355
00:12:10,880 --> 00:12:13,040
take that down i'm also going to take

356
00:12:13,040 --> 00:12:14,079
down

357
00:12:14,079 --> 00:12:15,440
the point of sale what's going to happen

358
00:12:15,440 --> 00:12:17,519
if the business

359
00:12:17,519 --> 00:12:20,399
can't do fbos for a day

360
00:12:20,399 --> 00:12:22,000
an hour

361
00:12:22,000 --> 00:12:23,680
you know and can an attacker easily

362
00:12:23,680 --> 00:12:25,760
identify these well look at those

363
00:12:25,760 --> 00:12:26,959
screenshots

364
00:12:26,959 --> 00:12:29,360
yeah fairly easily

365
00:12:29,360 --> 00:12:31,040
remote access

366
00:12:31,040 --> 00:12:32,959
some of this people instead just using

367
00:12:32,959 --> 00:12:36,480
the generic vpn pages or webmail pages

368
00:12:36,480 --> 00:12:38,240
they're going to brand it with the fact

369
00:12:38,240 --> 00:12:42,480
that scada and with their council name

370
00:12:42,480 --> 00:12:44,800
so i'm going to see that and go that's

371
00:12:44,800 --> 00:12:46,399
going to be good because that's the most

372
00:12:46,399 --> 00:12:48,480
quite important a scada network for a

373
00:12:48,480 --> 00:12:50,720
council

374
00:12:50,720 --> 00:12:51,920
or you're just going to put your web

375
00:12:51,920 --> 00:12:53,600
mail in there brand it up with your logo

376
00:12:53,600 --> 00:12:54,639
on your name

377
00:12:54,639 --> 00:12:57,279
knock this off what happens if your your

378
00:12:57,279 --> 00:12:59,600
users and your staff can't do their

379
00:12:59,600 --> 00:13:02,560
email for a day

380
00:13:02,560 --> 00:13:04,160
so this is going to disrupt people

381
00:13:04,160 --> 00:13:06,000
working from home it's going to make

382
00:13:06,000 --> 00:13:08,160
remote support difficult if the

383
00:13:08,160 --> 00:13:10,240
if the support people can't log into the

384
00:13:10,240 --> 00:13:11,600
systems they're going to have to come on

385
00:13:11,600 --> 00:13:12,560
site

386
00:13:12,560 --> 00:13:14,320
to fix it and plug in directly to the

387
00:13:14,320 --> 00:13:15,519
network

388
00:13:15,519 --> 00:13:17,120
and also consider the same things which

389
00:13:17,120 --> 00:13:18,880
reverse the same firewall if i take down

390
00:13:18,880 --> 00:13:20,399
your vpn server

391
00:13:20,399 --> 00:13:22,320
what's using the same firewall the same

392
00:13:22,320 --> 00:13:24,240
internet connection because if i attack

393
00:13:24,240 --> 00:13:25,600
that it's mostly going to take down

394
00:13:25,600 --> 00:13:26,880
everything else

395
00:13:26,880 --> 00:13:29,519
behind that

396
00:13:29,839 --> 00:13:30,639
and

397
00:13:30,639 --> 00:13:32,720
so another way an attacker can go about

398
00:13:32,720 --> 00:13:35,120
identifying systems as certificate

399
00:13:35,120 --> 00:13:36,959
transparency so every time an http

400
00:13:36,959 --> 00:13:39,440
certificate is issued it gets added to

401
00:13:39,440 --> 00:13:41,519
the certificate transparency log

402
00:13:41,519 --> 00:13:43,839
we can go through that we can chuck all

403
00:13:43,839 --> 00:13:47,040
those into dns see which one's resolved

404
00:13:47,040 --> 00:13:49,360
hosts and ip addresses we can target and

405
00:13:49,360 --> 00:13:50,800
this is particularly interesting if

406
00:13:50,800 --> 00:13:52,480
those ip addresses are not behind some

407
00:13:52,480 --> 00:13:55,120
sort of cdn or allows us to find that

408
00:13:55,120 --> 00:13:57,839
origin server so quick example for

409
00:13:57,839 --> 00:14:00,079
google there's websites you type in

410
00:14:00,079 --> 00:14:02,399
google it will show you all the sub all

411
00:14:02,399 --> 00:14:04,320
the certificates for google and anything

412
00:14:04,320 --> 00:14:06,320
under it that's a certificate issued so

413
00:14:06,320 --> 00:14:09,279
we can use all that

414
00:14:09,440 --> 00:14:11,600
so going back to the some performance

415
00:14:11,600 --> 00:14:13,920
test reports where we had that slow page

416
00:14:13,920 --> 00:14:16,560
that no one really cared about hey we

417
00:14:16,560 --> 00:14:19,440
could just spy to the site and find

418
00:14:19,440 --> 00:14:21,360
these slow pages so even if they're

419
00:14:21,360 --> 00:14:24,000
using a cdn chances are if the page is

420
00:14:24,000 --> 00:14:26,240
really slow it would indicate that the

421
00:14:26,240 --> 00:14:28,240
request is going back to the origin

422
00:14:28,240 --> 00:14:29,279
server

423
00:14:29,279 --> 00:14:30,800
and you've even though you're going

424
00:14:30,800 --> 00:14:32,079
through the cdn you've actually got a

425
00:14:32,079 --> 00:14:34,720
cdn bypass because that page or report

426
00:14:34,720 --> 00:14:37,440
or something can't be

427
00:14:37,440 --> 00:14:39,199
cached so you're hitting the origin

428
00:14:39,199 --> 00:14:42,240
server you had in the database

429
00:14:42,240 --> 00:14:44,160
and spider and websites some of the

430
00:14:44,160 --> 00:14:45,120
times

431
00:14:45,120 --> 00:14:46,480
if they're not using the cd and it can

432
00:14:46,480 --> 00:14:48,959
go down you know just using the laptop

433
00:14:48,959 --> 00:14:50,079
this week

434
00:14:50,079 --> 00:14:51,680
burp and

435
00:14:51,680 --> 00:14:54,079
25 threads in this case this week

436
00:14:54,079 --> 00:14:56,240
site went down stop

437
00:14:56,240 --> 00:14:58,880
stop burp site went back up again so

438
00:14:58,880 --> 00:15:00,800
some sites aren't particularly robust if

439
00:15:00,800 --> 00:15:02,720
they're not behind a cdn and

440
00:15:02,720 --> 00:15:05,600
something else like that

441
00:15:05,600 --> 00:15:08,480
so email hitters so

442
00:15:08,480 --> 00:15:10,880
systems will send out emails for new

443
00:15:10,880 --> 00:15:13,519
accounts or password resets if you trawl

444
00:15:13,519 --> 00:15:14,399
through

445
00:15:14,399 --> 00:15:15,839
the email headers you'll quite often

446
00:15:15,839 --> 00:15:17,760
find the actual

447
00:15:17,760 --> 00:15:19,920
um the ip addresses of the

448
00:15:19,920 --> 00:15:21,360
infrastructure like

449
00:15:21,360 --> 00:15:23,279
the application cert the web application

450
00:15:23,279 --> 00:15:25,600
server or maybe their internal email

451
00:15:25,600 --> 00:15:28,560
relay which you could target

452
00:15:28,560 --> 00:15:30,480
and again take the system down what

453
00:15:30,480 --> 00:15:31,680
happens if

454
00:15:31,680 --> 00:15:33,519
your your site can't take new

455
00:15:33,519 --> 00:15:35,040
registrations because it can't send out

456
00:15:35,040 --> 00:15:36,880
emails what's going to be the business

457
00:15:36,880 --> 00:15:39,680
impact to that

458
00:15:39,680 --> 00:15:42,000
historical dns one of the

459
00:15:42,000 --> 00:15:43,920
pretty much every cdn will say when you

460
00:15:43,920 --> 00:15:45,759
move to a cdn

461
00:15:45,759 --> 00:15:47,519
once you've done that and moved across

462
00:15:47,519 --> 00:15:49,279
make sure you change the ip address of

463
00:15:49,279 --> 00:15:50,959
your origin server

464
00:15:50,959 --> 00:15:52,000
so

465
00:15:52,000 --> 00:15:54,000
people can't say find it in historical

466
00:15:54,000 --> 00:15:55,120
dns

467
00:15:55,120 --> 00:15:57,680
so what historical dns is some people

468
00:15:57,680 --> 00:16:00,959
are capturing dns over a long time so

469
00:16:00,959 --> 00:16:02,560
you can go back and see what the hosts

470
00:16:02,560 --> 00:16:04,720
were previously chances are the ip

471
00:16:04,720 --> 00:16:07,360
address just before it moved to a cdn is

472
00:16:07,360 --> 00:16:10,880
going to be the origin service stall

473
00:16:11,360 --> 00:16:14,160
and regulatory requirements we had nzx

474
00:16:14,160 --> 00:16:16,160
last year as an example of this

475
00:16:16,160 --> 00:16:18,800
it was their website that was attacked

476
00:16:18,800 --> 00:16:21,440
they said throughout that their trading

477
00:16:21,440 --> 00:16:22,880
platform was fine their training

478
00:16:22,880 --> 00:16:24,480
platform

479
00:16:24,480 --> 00:16:26,160
never actually was attacked never went

480
00:16:26,160 --> 00:16:27,199
down

481
00:16:27,199 --> 00:16:28,320
but

482
00:16:28,320 --> 00:16:29,680
they still had to halt the market

483
00:16:29,680 --> 00:16:30,720
because they had a regulatory

484
00:16:30,720 --> 00:16:32,480
requirement that particular documents

485
00:16:32,480 --> 00:16:33,759
needed to be available to market

486
00:16:33,759 --> 00:16:35,040
participants

487
00:16:35,040 --> 00:16:36,800
these were hosted on the website so when

488
00:16:36,800 --> 00:16:38,959
the website went down they had to turn

489
00:16:38,959 --> 00:16:41,758
off the market

490
00:16:42,240 --> 00:16:45,040
um similar to that collateral damage

491
00:16:45,040 --> 00:16:47,519
what happens if someone targets another

492
00:16:47,519 --> 00:16:50,639
customer of your isp or your

493
00:16:50,639 --> 00:16:52,880
a service provider which gives you say

494
00:16:52,880 --> 00:16:55,519
your email or something what happens to

495
00:16:55,519 --> 00:16:57,120
your business can you be collateral

496
00:16:57,120 --> 00:16:58,880
damage have you isolated and got

497
00:16:58,880 --> 00:17:00,959
guaranteed pipes

498
00:17:00,959 --> 00:17:03,199
that your systems won't get taken down

499
00:17:03,199 --> 00:17:04,640
if a customer

500
00:17:04,640 --> 00:17:06,319
if another customer of one of your

501
00:17:06,319 --> 00:17:07,280
vendors

502
00:17:07,280 --> 00:17:09,119
is attacked

503
00:17:09,119 --> 00:17:11,119
so part you might throw most

504
00:17:11,119 --> 00:17:12,720
instructions how can we go about

505
00:17:12,720 --> 00:17:15,839
protecting your systems

506
00:17:16,079 --> 00:17:18,000
first thing you've got to do is what

507
00:17:18,000 --> 00:17:20,559
systems do you have

508
00:17:20,559 --> 00:17:22,799
um if you've got shadow i.t chances are

509
00:17:22,799 --> 00:17:23,919
an attacker doing some good

510
00:17:23,919 --> 00:17:26,240
reconnaissance microphone got a better

511
00:17:26,240 --> 00:17:27,679
indication of what your all your

512
00:17:27,679 --> 00:17:29,919
external facing infrastructure is than

513
00:17:29,919 --> 00:17:31,760
you do as the it team

514
00:17:31,760 --> 00:17:33,840
and you can't defend what you don't know

515
00:17:33,840 --> 00:17:36,000
about and even if the system isn't

516
00:17:36,000 --> 00:17:38,000
something you don't know about it might

517
00:17:38,000 --> 00:17:39,919
cause issues to other systems it might

518
00:17:39,919 --> 00:17:40,880
affect

519
00:17:40,880 --> 00:17:42,559
particular parts of the business or it

520
00:17:42,559 --> 00:17:45,679
could just cause reputational damage

521
00:17:45,679 --> 00:17:47,039
so i'll go through a little bit of a

522
00:17:47,039 --> 00:17:48,799
scenario now

523
00:17:48,799 --> 00:17:50,880
we've got a little organization got a

524
00:17:50,880 --> 00:17:53,440
web server an email server dns server

525
00:17:53,440 --> 00:17:55,600
firewall

526
00:17:55,600 --> 00:17:59,120
web content we just use the cdn right

527
00:17:59,120 --> 00:18:00,640
you know sitting in the front of the web

528
00:18:00,640 --> 00:18:02,640
server

529
00:18:02,640 --> 00:18:04,960
maybe not so much you've got to think is

530
00:18:04,960 --> 00:18:06,720
your content actual

531
00:18:06,720 --> 00:18:08,720
actually caseable how are you handling

532
00:18:08,720 --> 00:18:10,240
the dynamic sessions and the user

533
00:18:10,240 --> 00:18:11,600
sessions because they need to go back to

534
00:18:11,600 --> 00:18:14,559
the database to validate the log on or

535
00:18:14,559 --> 00:18:16,400
generate the or the app server needs to

536
00:18:16,400 --> 00:18:19,840
generate the dynamic content

537
00:18:21,120 --> 00:18:23,600
and have you configured the right boxes

538
00:18:23,600 --> 00:18:25,280
on your origin server and the cdn does

539
00:18:25,280 --> 00:18:27,200
your origin server only allow requests

540
00:18:27,200 --> 00:18:29,120
from the cdn or can anyone still make a

541
00:18:29,120 --> 00:18:30,480
request to it

542
00:18:30,480 --> 00:18:32,640
who can purge and expire documents that

543
00:18:32,640 --> 00:18:34,400
are cased in the cdn

544
00:18:34,400 --> 00:18:37,840
so for example with a customer we could

545
00:18:37,840 --> 00:18:41,360
do a request i wasn't the case

546
00:18:41,360 --> 00:18:44,240
0.3 of a second that was fine

547
00:18:44,240 --> 00:18:46,000
though from a randomized address we

548
00:18:46,000 --> 00:18:49,600
could send a purge request to the cdn

549
00:18:49,600 --> 00:18:51,520
they were successful

550
00:18:51,520 --> 00:18:53,760
next request takes almost four times as

551
00:18:53,760 --> 00:18:55,200
long

552
00:18:55,200 --> 00:18:56,559
because it's not cash got to go back to

553
00:18:56,559 --> 00:18:58,880
the origin server subsequence are fine

554
00:18:58,880 --> 00:18:59,840
so

555
00:18:59,840 --> 00:19:02,080
what we can do here is as an attacker i

556
00:19:02,080 --> 00:19:03,760
just need to issue purge requests to the

557
00:19:03,760 --> 00:19:05,440
cdn and then it's actually the

558
00:19:05,440 --> 00:19:07,280
legitimate traffic and the legitimate

559
00:19:07,280 --> 00:19:08,880
users going to the site that are

560
00:19:08,880 --> 00:19:10,160
actually going to cause the load of the

561
00:19:10,160 --> 00:19:12,400
origin server so the origin server's

562
00:19:12,400 --> 00:19:14,240
logs will show that

563
00:19:14,240 --> 00:19:16,000
their normal user base is actually

564
00:19:16,000 --> 00:19:17,760
causing the denial of service attack

565
00:19:17,760 --> 00:19:18,559
again

566
00:19:18,559 --> 00:19:20,160
not their attacker who's just sending

567
00:19:20,160 --> 00:19:22,720
purges which only go as far as the edge

568
00:19:22,720 --> 00:19:25,360
of the cd cdn

569
00:19:26,640 --> 00:19:28,880
you know making sure you protect your

570
00:19:28,880 --> 00:19:31,360
origin service people can't find them

571
00:19:31,360 --> 00:19:33,200
you know can they find the ip addresses

572
00:19:33,200 --> 00:19:34,080
in

573
00:19:34,080 --> 00:19:36,559
dns history have you used domain names

574
00:19:36,559 --> 00:19:38,480
you could find a certificate certificate

575
00:19:38,480 --> 00:19:40,160
transparency log like

576
00:19:40,160 --> 00:19:43,160
originserver.example.com

577
00:19:44,160 --> 00:19:46,160
and can you still send traffic to these

578
00:19:46,160 --> 00:19:47,919
ip addresses so even if the firewall is

579
00:19:47,919 --> 00:19:50,320
doing a deny

580
00:19:50,320 --> 00:19:52,160
it's still going to consume some cpu

581
00:19:52,160 --> 00:19:53,600
resource

582
00:19:53,600 --> 00:19:55,120
to actually do that tonight so hopefully

583
00:19:55,120 --> 00:19:57,360
the file server oh sorry the firewall

584
00:19:57,360 --> 00:19:59,760
can stop that so things are still

585
00:19:59,760 --> 00:20:02,320
vulnerable and when it does go crash

586
00:20:02,320 --> 00:20:04,240
your cdn is going to be really good at

587
00:20:04,240 --> 00:20:06,400
throwing you under the bus and they're

588
00:20:06,400 --> 00:20:08,480
really good at saying that the cdn's

589
00:20:08,480 --> 00:20:12,240
fine that's the website that's down

590
00:20:12,240 --> 00:20:13,919
so you do need to make sure even though

591
00:20:13,919 --> 00:20:14,960
you've got to sit in you're still

592
00:20:14,960 --> 00:20:16,400
protecting your web server you still

593
00:20:16,400 --> 00:20:18,320
need to think about that it's not a

594
00:20:18,320 --> 00:20:21,799
one-trick pony

595
00:20:22,640 --> 00:20:24,559
dns domain registrations the lawn

596
00:20:24,559 --> 00:20:26,320
mitigations are going to require dns

597
00:20:26,320 --> 00:20:28,799
updates to move your critical systems so

598
00:20:28,799 --> 00:20:30,880
it's really good if your dns is scalable

599
00:20:30,880 --> 00:20:33,679
to dos tax so you can use a provider to

600
00:20:33,679 --> 00:20:35,280
do this make sure if you're a new

601
00:20:35,280 --> 00:20:36,720
zealand company they've also got a point

602
00:20:36,720 --> 00:20:38,720
of presence in new zealand so it's nice

603
00:20:38,720 --> 00:20:41,679
and fast for you new zealand users and

604
00:20:41,679 --> 00:20:43,919
those changes quickly

605
00:20:43,919 --> 00:20:45,520
subject to the dns time to live so

606
00:20:45,520 --> 00:20:46,799
hopefully if you're under attack you

607
00:20:46,799 --> 00:20:49,039
haven't set all your dns to be 48 hours

608
00:20:49,039 --> 00:20:50,880
or five days because

609
00:20:50,880 --> 00:20:52,720
that's going to be a long time to before

610
00:20:52,720 --> 00:20:56,640
you can actually implement any changes

611
00:20:57,200 --> 00:20:58,480
and while you're doing this make sure

612
00:20:58,480 --> 00:21:01,440
you think about consolidating your dns

613
00:21:01,440 --> 00:21:03,039
and your domain registrations in one

614
00:21:03,039 --> 00:21:03,919
place

615
00:21:03,919 --> 00:21:06,240
know who has access to it

616
00:21:06,240 --> 00:21:08,080
make sure you're using like a shared

617
00:21:08,080 --> 00:21:09,520
mail inbox

618
00:21:09,520 --> 00:21:11,039
rather than

619
00:21:11,039 --> 00:21:12,799
someone who signed up for it five years

620
00:21:12,799 --> 00:21:14,400
ago has now left the company so your

621
00:21:14,400 --> 00:21:16,159
company loses the domain because you

622
00:21:16,159 --> 00:21:17,440
never got

623
00:21:17,440 --> 00:21:19,200
renew your domain

624
00:21:19,200 --> 00:21:21,360
email because it went to a former

625
00:21:21,360 --> 00:21:23,918
employee

626
00:21:24,400 --> 00:21:26,240
now other infrastructure

627
00:21:26,240 --> 00:21:29,440
you know make sure your bgp updates

628
00:21:29,440 --> 00:21:30,960
are appropriately restricted also make

629
00:21:30,960 --> 00:21:32,960
sure they've got a fail back state

630
00:21:32,960 --> 00:21:34,000
which will happen all of them

631
00:21:34,000 --> 00:21:36,480
automatically so maybe you don't end up

632
00:21:36,480 --> 00:21:40,080
with such a facebook example for that

633
00:21:40,080 --> 00:21:42,720
mail hey it's 2021

634
00:21:42,720 --> 00:21:45,440
just use a cloud provider for email it's

635
00:21:45,440 --> 00:21:47,200
you know email for communications is

636
00:21:47,200 --> 00:21:48,720
generally still really important for

637
00:21:48,720 --> 00:21:50,080
most businesses

638
00:21:50,080 --> 00:21:52,000
so make sure you've

639
00:21:52,000 --> 00:21:53,679
just do it in the cloud rolling your own

640
00:21:53,679 --> 00:21:56,720
is pretty much over

641
00:21:57,360 --> 00:21:59,520
yep so move that out of the organization

642
00:21:59,520 --> 00:22:01,919
so once we've defended what we've got

643
00:22:01,919 --> 00:22:03,039
already

644
00:22:03,039 --> 00:22:05,919
when you bring your new applications new

645
00:22:05,919 --> 00:22:07,760
network architectures make sure you're

646
00:22:07,760 --> 00:22:09,600
actually thinking about how you're going

647
00:22:09,600 --> 00:22:11,840
to prevent dos attacks and making sure

648
00:22:11,840 --> 00:22:13,600
if you've got particular tools and

649
00:22:13,600 --> 00:22:16,240
scrubbing and caching and cdn's making

650
00:22:16,240 --> 00:22:17,679
sure you're designing your application

651
00:22:17,679 --> 00:22:19,600
to make the best use

652
00:22:19,600 --> 00:22:23,678
of that of the protections in front

653
00:22:23,919 --> 00:22:25,760
for example anything that's not cashable

654
00:22:25,760 --> 00:22:27,840
should be behind some sort of log on or

655
00:22:27,840 --> 00:22:29,919
capture or rate limiting

656
00:22:29,919 --> 00:22:32,400
that's um that's enforced at the edge of

657
00:22:32,400 --> 00:22:34,559
the cdn not back at the application

658
00:22:34,559 --> 00:22:36,960
service respective application server

659
00:22:36,960 --> 00:22:38,400
that's still

660
00:22:38,400 --> 00:22:40,480
you know still vulnerable

661
00:22:40,480 --> 00:22:42,080
and if you're implementing a sort of a

662
00:22:42,080 --> 00:22:43,760
multi-tier architecture make sure you

663
00:22:43,760 --> 00:22:45,120
don't end up with sort of layer seven

664
00:22:45,120 --> 00:22:48,880
bottlenecks so we're the customer who

665
00:22:48,880 --> 00:22:51,039
they've gone oh yep so we want to be

666
00:22:51,039 --> 00:22:52,559
able to scale this application so put a

667
00:22:52,559 --> 00:22:55,039
whole brunt of sort of front-end web

668
00:22:55,039 --> 00:22:57,760
servers those will horizontally scale

669
00:22:57,760 --> 00:22:59,760
and scale up as there's more load and

670
00:22:59,760 --> 00:23:01,919
scale down when there's not so much load

671
00:23:01,919 --> 00:23:03,360
same with the databases but we've got

672
00:23:03,360 --> 00:23:05,600
this big old legacy java application

673
00:23:05,600 --> 00:23:07,760
that handles a session management and

674
00:23:07,760 --> 00:23:10,880
all the state inside we can't really hop

675
00:23:10,880 --> 00:23:12,880
and it's a vendor code and the vendor's

676
00:23:12,880 --> 00:23:14,720
not going to change anything

677
00:23:14,720 --> 00:23:17,760
so we can't make it horizontally scale

678
00:23:17,760 --> 00:23:20,159
so you know a few users that's fine

679
00:23:20,159 --> 00:23:22,240
whole bunch of users the horizontal

680
00:23:22,240 --> 00:23:23,679
scaling is just going to fire more

681
00:23:23,679 --> 00:23:26,159
requests at this monolithic code in the

682
00:23:26,159 --> 00:23:29,280
middle faster and make it crash

683
00:23:29,280 --> 00:23:31,120
so your preventions have actually just

684
00:23:31,120 --> 00:23:33,919
made it crash faster

685
00:23:33,919 --> 00:23:35,440
so for layer 7 make sure when you're

686
00:23:35,440 --> 00:23:36,720
implementing these new things get a

687
00:23:36,720 --> 00:23:39,120
performance test report done of all the

688
00:23:39,120 --> 00:23:40,799
web outside or the infrastructure make

689
00:23:40,799 --> 00:23:42,240
sure you understand what the bottlenecks

690
00:23:42,240 --> 00:23:45,840
are and don't just put them down to

691
00:23:45,840 --> 00:23:47,760
um oh yeah no one uses that that will be

692
00:23:47,760 --> 00:23:49,679
fine make sure you actually put in

693
00:23:49,679 --> 00:23:51,440
protections in place so remember that a

694
00:23:51,440 --> 00:23:53,200
waff isn't going to solve

695
00:23:53,200 --> 00:23:55,120
last seven problems

696
00:23:55,120 --> 00:23:56,400
because these are going to look like

697
00:23:56,400 --> 00:23:59,760
legitimate uses of the site

698
00:23:59,760 --> 00:24:02,320
to the point of who would think 404

699
00:24:02,320 --> 00:24:04,400
pages should be fine right

700
00:24:04,400 --> 00:24:06,960
well you know that 12 cents an hour we d

701
00:24:06,960 --> 00:24:09,039
we took a server down on before

702
00:24:09,039 --> 00:24:10,480
mentioned before

703
00:24:10,480 --> 00:24:12,000
that was because

704
00:24:12,000 --> 00:24:14,240
we were just had were generating random

705
00:24:14,240 --> 00:24:15,600
urls

706
00:24:15,600 --> 00:24:18,880
and which resulted in 404. the cdns were

707
00:24:18,880 --> 00:24:20,559
really good at caching pages which had

708
00:24:20,559 --> 00:24:22,559
been requested before but we're sitting

709
00:24:22,559 --> 00:24:24,480
in random urls that haven't been seen

710
00:24:24,480 --> 00:24:27,360
before resulting in 404 pages and

711
00:24:27,360 --> 00:24:28,720
depending on the quality management

712
00:24:28,720 --> 00:24:31,520
system 404 pages can be quite expensive

713
00:24:31,520 --> 00:24:33,520
to check for because it might check

714
00:24:33,520 --> 00:24:35,520
the pages table it might then check the

715
00:24:35,520 --> 00:24:38,000
redirections table it might check the u

716
00:24:38,000 --> 00:24:40,880
the people table it might go and check

717
00:24:40,880 --> 00:24:42,799
the tags table so it's doing like five

718
00:24:42,799 --> 00:24:44,320
six a dozen

719
00:24:44,320 --> 00:24:46,000
database lookups before it can actually

720
00:24:46,000 --> 00:24:48,320
return the 404. so you've got to find a

721
00:24:48,320 --> 00:24:49,679
way of like

722
00:24:49,679 --> 00:24:51,679
telling your cdn these are all the valid

723
00:24:51,679 --> 00:24:54,720
urls if it's anything else from the edge

724
00:24:54,720 --> 00:24:56,960
can you please server 404

725
00:24:56,960 --> 00:24:58,799
don't don't come back to the server to

726
00:24:58,799 --> 00:25:01,520
do that

727
00:25:01,520 --> 00:25:02,720
another thing just make sure your

728
00:25:02,720 --> 00:25:04,159
patches are installed these are going to

729
00:25:04,159 --> 00:25:05,840
stop exploitations of bugs and the

730
00:25:05,840 --> 00:25:07,840
applications of the device which may

731
00:25:07,840 --> 00:25:10,400
slow things down or crash it

732
00:25:10,400 --> 00:25:12,480
and sort of had those branch sites

733
00:25:12,480 --> 00:25:14,400
before we could geofence it to new

734
00:25:14,400 --> 00:25:16,159
zealand ip addresses

735
00:25:16,159 --> 00:25:18,480
or even better still just

736
00:25:18,480 --> 00:25:20,960
site-to-site vpn so you're not actually

737
00:25:20,960 --> 00:25:22,559
exposing your

738
00:25:22,559 --> 00:25:25,039
your retail sites to the internet

739
00:25:25,039 --> 00:25:27,039
it's only over a vpn from head office

740
00:25:27,039 --> 00:25:29,840
that it can be accessed

741
00:25:30,159 --> 00:25:32,480
so making sure we protect everything and

742
00:25:32,480 --> 00:25:34,720
all the branch sites as well

743
00:25:34,720 --> 00:25:36,640
make sure we monitor all the things and

744
00:25:36,640 --> 00:25:38,799
monitoring you need to start now so you

745
00:25:38,799 --> 00:25:40,880
know what normal looks like

746
00:25:40,880 --> 00:25:42,880
because if you go one of your

747
00:25:42,880 --> 00:25:45,520
competitors is being attacked and you

748
00:25:45,520 --> 00:25:47,200
look at your logs all the first time you

749
00:25:47,200 --> 00:25:48,080
go

750
00:25:48,080 --> 00:25:50,320
oh we're under attack as well what do we

751
00:25:50,320 --> 00:25:52,799
do panic panic panic and then an hour or

752
00:25:52,799 --> 00:25:54,720
two or three down the track you realize

753
00:25:54,720 --> 00:25:56,320
oh this is normal and we're not actually

754
00:25:56,320 --> 00:25:58,640
under attack but you've

755
00:25:58,640 --> 00:26:00,559
everyone's scared everyone's working on

756
00:26:00,559 --> 00:26:02,080
it and

757
00:26:02,080 --> 00:26:03,840
doesn't result in a good day so make

758
00:26:03,840 --> 00:26:04,960
sure you know what normal looks like

759
00:26:04,960 --> 00:26:06,640
ahead of time

760
00:26:06,640 --> 00:26:08,159
and when you're monitoring these things

761
00:26:08,159 --> 00:26:09,840
make sure you do it from outside the

762
00:26:09,840 --> 00:26:12,159
organization because another monitoring

763
00:26:12,159 --> 00:26:13,120
server

764
00:26:13,120 --> 00:26:15,200
on the same switch

765
00:26:15,200 --> 00:26:17,360
beside your web server and your database

766
00:26:17,360 --> 00:26:18,960
server it's always going to be fine

767
00:26:18,960 --> 00:26:20,880
because chances are their attack might

768
00:26:20,880 --> 00:26:22,799
be further upstream so make sure you're

769
00:26:22,799 --> 00:26:24,880
doing monitoring yes internally but also

770
00:26:24,880 --> 00:26:27,200
externally following the code path or

771
00:26:27,200 --> 00:26:29,279
sorry the network path that your users

772
00:26:29,279 --> 00:26:31,840
would be using

773
00:26:31,840 --> 00:26:33,919
make sure you also monitor disk space

774
00:26:33,919 --> 00:26:36,159
with a customer we're just doing a

775
00:26:36,159 --> 00:26:38,640
routine port scan against them

776
00:26:38,640 --> 00:26:41,360
their firewall was logging all the deny

777
00:26:41,360 --> 00:26:44,080
requests the disk on the firewall fell

778
00:26:44,080 --> 00:26:45,520
filled up and when the disks on the

779
00:26:45,520 --> 00:26:47,039
firewall filled up the firewall went

780
00:26:47,039 --> 00:26:49,120
into a state where it said i'm blocking

781
00:26:49,120 --> 00:26:51,200
everything even stuff i should allow and

782
00:26:51,200 --> 00:26:52,559
i'll wait for someone to plug in and

783
00:26:52,559 --> 00:26:54,720
clear up disk space

784
00:26:54,720 --> 00:26:56,880
um client complained we just logged to

785
00:26:56,880 --> 00:26:59,760
high risk finding

786
00:27:00,480 --> 00:27:01,679
um then you want to make sure you're

787
00:27:01,679 --> 00:27:04,480
doing some tests and some simulation so

788
00:27:04,480 --> 00:27:05,279
you know

789
00:27:05,279 --> 00:27:07,440
does the end-to-end systems work how you

790
00:27:07,440 --> 00:27:08,559
expect it to work for the dos

791
00:27:08,559 --> 00:27:11,039
preventions um and does your service

792
00:27:11,039 --> 00:27:12,880
provider have the correct phone numbers

793
00:27:12,880 --> 00:27:13,840
we had

794
00:27:13,840 --> 00:27:16,159
we were doing a test for a customer and

795
00:27:16,159 --> 00:27:18,880
were testing their dos preventions

796
00:27:18,880 --> 00:27:21,919
found out that the isp who was doing the

797
00:27:21,919 --> 00:27:24,720
monitoring the dos scrubbing had their

798
00:27:24,720 --> 00:27:26,720
four-year-old service desk since then

799
00:27:26,720 --> 00:27:28,960
the change service desk but

800
00:27:28,960 --> 00:27:30,559
somewhere along the while

801
00:27:30,559 --> 00:27:32,640
the way that i that phone number had

802
00:27:32,640 --> 00:27:34,399
never got updated so they're ringing up

803
00:27:34,399 --> 00:27:37,120
the wrong people

804
00:27:37,120 --> 00:27:38,320
so

805
00:27:38,320 --> 00:27:40,720
hopefully from today you've you've

806
00:27:40,720 --> 00:27:42,240
started thinking about

807
00:27:42,240 --> 00:27:44,960
what systems could your business

808
00:27:44,960 --> 00:27:46,559
maybe starting to think about some other

809
00:27:46,559 --> 00:27:48,240
systems other than your website that you

810
00:27:48,240 --> 00:27:50,880
need to do some dos prevention for

811
00:27:50,880 --> 00:27:52,159
hopefully you've got some ideas about

812
00:27:52,159 --> 00:27:54,640
how you can identify and find these

813
00:27:54,640 --> 00:27:56,640
threats maybe start to get a little bit

814
00:27:56,640 --> 00:27:59,039
of a plan to defend them

815
00:27:59,039 --> 00:28:00,480
chances are you may be a little bit

816
00:28:00,480 --> 00:28:02,159
overwhelmed about all these effects that

817
00:28:02,159 --> 00:28:04,159
you think about

818
00:28:04,159 --> 00:28:05,520
so you need to do things that are sets

819
00:28:05,520 --> 00:28:07,840
broader so on the zx security website

820
00:28:07,840 --> 00:28:09,840
we've got a blog post about a dos

821
00:28:09,840 --> 00:28:11,440
preparation model

822
00:28:11,440 --> 00:28:12,480
which

823
00:28:12,480 --> 00:28:13,840
steps it through

824
00:28:13,840 --> 00:28:15,600
this is a screenshot but the blog goes

825
00:28:15,600 --> 00:28:17,919
on a lot longer have a read through it

826
00:28:17,919 --> 00:28:18,880
but it

827
00:28:18,880 --> 00:28:21,520
roughly distills down to first step is

828
00:28:21,520 --> 00:28:23,679
you want to figure out what you have and

829
00:28:23,679 --> 00:28:25,279
what you need to defend and the attacker

830
00:28:25,279 --> 00:28:26,640
is going to attack

831
00:28:26,640 --> 00:28:28,240
then you put in a place for how do you

832
00:28:28,240 --> 00:28:30,480
defend your assets you put those

833
00:28:30,480 --> 00:28:32,720
defenses in place and they're sort of at

834
00:28:32,720 --> 00:28:35,120
level five you start monitoring and

835
00:28:35,120 --> 00:28:37,440
doing the simulations

836
00:28:37,440 --> 00:28:38,559
so

837
00:28:38,559 --> 00:28:41,120
thank you all for coming

838
00:28:41,120 --> 00:28:43,360
thank you for the christchurch concrete

839
00:28:43,360 --> 00:28:45,039
accepted my talk

840
00:28:45,039 --> 00:28:46,640
cheers to the zx team and the other

841
00:28:46,640 --> 00:28:48,720
people i've bounced ideas off for this

842
00:28:48,720 --> 00:28:50,159
talk

843
00:28:50,159 --> 00:28:53,880
thank you all very much

844
00:28:56,030 --> 00:28:59,750
[Applause]

845
00:29:00,559 --> 00:29:02,639
you

