1
00:00:03,199 --> 00:00:03,520
like

2
00:00:03,520 --> 00:00:06,480
eventually right wow that was awesome um

3
00:00:06,480 --> 00:00:08,240
and then my macbook crashed right before

4
00:00:08,240 --> 00:00:09,280
i came out here

5
00:00:09,280 --> 00:00:10,559
so like i should have bought a surface

6
00:00:10,559 --> 00:00:13,360
like sarah said this morning um

7
00:00:13,360 --> 00:00:15,440
it's so great to be back at another

8
00:00:15,440 --> 00:00:17,520
check on and just to be able to go to a

9
00:00:17,520 --> 00:00:18,640
security conference

10
00:00:18,640 --> 00:00:21,039
in person this year i just want to start

11
00:00:21,039 --> 00:00:22,720
with a massive shout out to the check on

12
00:00:22,720 --> 00:00:24,560
crew for making this happen

13
00:00:24,560 --> 00:00:26,400
in the midst of all this craziness and

14
00:00:26,400 --> 00:00:27,680
can we get a quick round of applause for

15
00:00:27,680 --> 00:00:31,180
the crew for

16
00:00:31,180 --> 00:00:34,239
[Applause]

17
00:00:34,239 --> 00:00:36,559
so a little bit about me um my name is

18
00:00:36,559 --> 00:00:38,640
logan if you haven't met me before

19
00:00:38,640 --> 00:00:40,239
i'm a senior security consultant with

20
00:00:40,239 --> 00:00:41,920
aura in wellington

21
00:00:41,920 --> 00:00:44,480
i do all the usual pen test type stuff

22
00:00:44,480 --> 00:00:46,800
but my real passion is physical security

23
00:00:46,800 --> 00:00:48,239
and red teaming

24
00:00:48,239 --> 00:00:49,680
in the last couple of years i've let

25
00:00:49,680 --> 00:00:51,920
myself into substations water treatment

26
00:00:51,920 --> 00:00:52,640
plants

27
00:00:52,640 --> 00:00:54,399
a frightening number of government

28
00:00:54,399 --> 00:00:56,800
agencies and a fun range of private

29
00:00:56,800 --> 00:00:58,000
sector organizations

30
00:00:58,000 --> 00:01:00,160
ranging from medical facilities to

31
00:01:00,160 --> 00:01:01,840
logistics providers

32
00:01:01,840 --> 00:01:03,359
if you ever come across me in your

33
00:01:03,359 --> 00:01:05,040
building and i look like i might be

34
00:01:05,040 --> 00:01:06,400
trying to be invisible

35
00:01:06,400 --> 00:01:08,159
please don't bust me or i'll feature you

36
00:01:08,159 --> 00:01:10,720
in my next con talk

37
00:01:10,720 --> 00:01:12,560
i'm a huge lock nerd which you may have

38
00:01:12,560 --> 00:01:14,080
noticed if you come past the lock sport

39
00:01:14,080 --> 00:01:14,960
table

40
00:01:14,960 --> 00:01:16,560
and i have an unhealthy interest in

41
00:01:16,560 --> 00:01:19,200
getting secured doors open

42
00:01:19,200 --> 00:01:20,720
right so the stuff i'm going to talk

43
00:01:20,720 --> 00:01:22,720
about has real world applications

44
00:01:22,720 --> 00:01:24,799
that could very definitely enable you to

45
00:01:24,799 --> 00:01:26,000
do crimes

46
00:01:26,000 --> 00:01:28,320
so i'm obliged to kind of request that

47
00:01:28,320 --> 00:01:29,920
you only use these techniques

48
00:01:29,920 --> 00:01:32,400
where you're explicitly authorized to

49
00:01:32,400 --> 00:01:33,840
and with that out of the way onto the

50
00:01:33,840 --> 00:01:35,600
crimes

51
00:01:35,600 --> 00:01:37,280
now i love a bit of storytelling as you

52
00:01:37,280 --> 00:01:39,759
may know if you've seen me talk before

53
00:01:39,759 --> 00:01:41,360
so to kick this off and to provide some

54
00:01:41,360 --> 00:01:43,600
context this is the tale of a physical

55
00:01:43,600 --> 00:01:44,640
security focused

56
00:01:44,640 --> 00:01:46,640
red team engagement that we did a little

57
00:01:46,640 --> 00:01:48,000
while ago

58
00:01:48,000 --> 00:01:49,439
it's worthwhile noting that the client

59
00:01:49,439 --> 00:01:50,799
here is a critical national

60
00:01:50,799 --> 00:01:52,320
infrastructure provider

61
00:01:52,320 --> 00:01:54,159
so we had a pretty broad range of

62
00:01:54,159 --> 00:01:56,000
techniques available to us

63
00:01:56,000 --> 00:01:57,520
you see there's no point in kind of

64
00:01:57,520 --> 00:02:00,079
larping as some like high-tech villain

65
00:02:00,079 --> 00:02:03,119
james bond type thing if your target

66
00:02:03,119 --> 00:02:04,719
actually has a really low tech threat

67
00:02:04,719 --> 00:02:05,280
model

68
00:02:05,280 --> 00:02:07,680
but this is a sector that has genuinely

69
00:02:07,680 --> 00:02:09,520
had some slightly crazy

70
00:02:09,520 --> 00:02:12,000
like nation-state flavor stuff happen

71
00:02:12,000 --> 00:02:13,280
within it um

72
00:02:13,280 --> 00:02:16,160
so we got to step things up a bit and

73
00:02:16,160 --> 00:02:17,760
specifically this was a local power

74
00:02:17,760 --> 00:02:19,360
distribution network

75
00:02:19,360 --> 00:02:20,879
and they're responsible for the last few

76
00:02:20,879 --> 00:02:22,959
kilometers of power delivery

77
00:02:22,959 --> 00:02:25,280
to the region that they look after you

78
00:02:25,280 --> 00:02:27,280
know your substations transformers power

79
00:02:27,280 --> 00:02:29,200
poles that kind of thing

80
00:02:29,200 --> 00:02:31,760
the kind of tech where people can die if

81
00:02:31,760 --> 00:02:33,519
things go wrong

82
00:02:33,519 --> 00:02:35,519
the objectives with this engagement were

83
00:02:35,519 --> 00:02:37,280
for us to gain unauthorized access to

84
00:02:37,280 --> 00:02:38,160
their head office

85
00:02:38,160 --> 00:02:39,760
with stretch goals of accessing their

86
00:02:39,760 --> 00:02:41,200
scada systems

87
00:02:41,200 --> 00:02:43,599
that control the local grid and the

88
00:02:43,599 --> 00:02:44,480
on-premise

89
00:02:44,480 --> 00:02:47,120
server room and for our internal trophy

90
00:02:47,120 --> 00:02:47,760
wall

91
00:02:47,760 --> 00:02:49,200
this meant trying to get some bad

92
00:02:49,200 --> 00:02:52,480
selfies in each of these locations

93
00:02:52,480 --> 00:02:54,160
so we showed up at the site and started

94
00:02:54,160 --> 00:02:56,080
our reconnaissance and i cannot

95
00:02:56,080 --> 00:02:57,840
emphasize enough the importance of

96
00:02:57,840 --> 00:02:59,280
thorough reconnaissance

97
00:02:59,280 --> 00:03:01,280
when you're doing these kinds of jobs

98
00:03:01,280 --> 00:03:02,959
because knowing

99
00:03:02,959 --> 00:03:04,720
what you're getting yourself into allows

100
00:03:04,720 --> 00:03:06,480
you to plan appropriately

101
00:03:06,480 --> 00:03:08,080
for dealing with those obstacles as you

102
00:03:08,080 --> 00:03:10,000
encounter them um although as you'll see

103
00:03:10,000 --> 00:03:10,959
in a moment we

104
00:03:10,959 --> 00:03:13,120
had a couple of unknowns just because

105
00:03:13,120 --> 00:03:15,200
you are limited in what you can actually

106
00:03:15,200 --> 00:03:17,120
see from the outside of a building that

107
00:03:17,120 --> 00:03:18,800
caught us out a little

108
00:03:18,800 --> 00:03:20,159
at this particular site they had a

109
00:03:20,159 --> 00:03:23,040
modern relatively high end alarm system

110
00:03:23,040 --> 00:03:24,799
they had electronic access control you

111
00:03:24,799 --> 00:03:26,799
know standard rfid swipe card reader on

112
00:03:26,799 --> 00:03:28,560
their primary entrance

113
00:03:28,560 --> 00:03:30,480
and we knew that everybody left the

114
00:03:30,480 --> 00:03:33,200
building by about 6 30 at night

115
00:03:33,200 --> 00:03:36,239
arming the alarm on their way out now

116
00:03:36,239 --> 00:03:37,680
because we've been fairly thorough about

117
00:03:37,680 --> 00:03:39,599
our recon we also knew that there was no

118
00:03:39,599 --> 00:03:41,599
electronic access control on some of the

119
00:03:41,599 --> 00:03:44,640
other entrances to the building

120
00:03:44,640 --> 00:03:46,319
and that one of these entrances had a

121
00:03:46,319 --> 00:03:48,480
fairly low grade lock installed on it

122
00:03:48,480 --> 00:03:50,480
um further we knew that they had a

123
00:03:50,480 --> 00:03:51,840
couple of commercial cleaners

124
00:03:51,840 --> 00:03:53,599
who came through and cleaned the place

125
00:03:53,599 --> 00:03:55,920
later on each night

126
00:03:55,920 --> 00:03:57,680
so we waited until all the staff had

127
00:03:57,680 --> 00:03:58,959
left for the day

128
00:03:58,959 --> 00:04:00,640
confirming that they had indeed armed

129
00:04:00,640 --> 00:04:02,560
the alarm and you'd be surprised how

130
00:04:02,560 --> 00:04:04,560
many places have a really nice alarm but

131
00:04:04,560 --> 00:04:06,640
just don't use it

132
00:04:06,640 --> 00:04:08,640
fortunately the rear entrance entrance

133
00:04:08,640 --> 00:04:10,640
to this building was nicely secluded

134
00:04:10,640 --> 00:04:11,920
from the street

135
00:04:11,920 --> 00:04:13,760
and i went around and picked the lock on

136
00:04:13,760 --> 00:04:15,120
that door open

137
00:04:15,120 --> 00:04:17,120
but did not open the door knowing that

138
00:04:17,120 --> 00:04:18,639
the alarm was armed and would presumably

139
00:04:18,639 --> 00:04:20,238
go off i entered

140
00:04:20,238 --> 00:04:22,000
we then waited nearby until we saw the

141
00:04:22,000 --> 00:04:23,919
cleaners arrive and of course they do

142
00:04:23,919 --> 00:04:25,280
the usual thing they swipe in at the

143
00:04:25,280 --> 00:04:26,880
front door they go and disarm the alarm

144
00:04:26,880 --> 00:04:27,840
and they go and start cleaning a

145
00:04:27,840 --> 00:04:29,120
building

146
00:04:29,120 --> 00:04:30,720
so while they're doing that in a

147
00:04:30,720 --> 00:04:32,240
different part of the building we let

148
00:04:32,240 --> 00:04:33,680
ourselves in through the

149
00:04:33,680 --> 00:04:35,759
previously unlocked door went and found

150
00:04:35,759 --> 00:04:36,720
a desk

151
00:04:36,720 --> 00:04:38,400
sat down and just made it look like

152
00:04:38,400 --> 00:04:40,800
we're a couple of serious business it

153
00:04:40,800 --> 00:04:42,000
people working on

154
00:04:42,000 --> 00:04:45,040
a problem that dns probably caused

155
00:04:45,040 --> 00:04:47,280
so when the cleaners came into that part

156
00:04:47,280 --> 00:04:48,240
of the building

157
00:04:48,240 --> 00:04:50,240
we made a point of making ourselves

158
00:04:50,240 --> 00:04:52,160
known we went and said hello

159
00:04:52,160 --> 00:04:55,040
you know had a sort of random complaint

160
00:04:55,040 --> 00:04:56,000
about having to work late

161
00:04:56,000 --> 00:04:58,639
on computer stuff um you know and we're

162
00:04:58,639 --> 00:05:00,240
just making sure that they knew

163
00:05:00,240 --> 00:05:03,280
that we were there um and that it seemed

164
00:05:03,280 --> 00:05:05,039
that we were authorized to be there and

165
00:05:05,039 --> 00:05:06,000
you know there's a sort of

166
00:05:06,000 --> 00:05:09,360
an inherent implication that you're

167
00:05:09,360 --> 00:05:10,479
authorized to be there

168
00:05:10,479 --> 00:05:12,880
because you're inside a secure facility

169
00:05:12,880 --> 00:05:13,680
that has

170
00:05:13,680 --> 00:05:15,280
presumably somewhat robust perimeter

171
00:05:15,280 --> 00:05:17,360
controls after hours

172
00:05:17,360 --> 00:05:19,520
and then according to our plan the

173
00:05:19,520 --> 00:05:20,880
cleaners were like

174
00:05:20,880 --> 00:05:23,360
okay so yeah good luck and just left us

175
00:05:23,360 --> 00:05:25,280
all alone inside this building

176
00:05:25,280 --> 00:05:28,320
which meant it was time for scada room

177
00:05:28,320 --> 00:05:29,280
selfies

178
00:05:29,280 --> 00:05:31,840
this is the sequel to my kiwi con talk

179
00:05:31,840 --> 00:05:32,880
if you caught it

180
00:05:32,880 --> 00:05:36,000
um occasionally we do bring along

181
00:05:36,000 --> 00:05:37,919
non-pen test staff on these engagements

182
00:05:37,919 --> 00:05:39,440
where possible you know if they just

183
00:05:39,440 --> 00:05:40,880
happen to be in the same city or

184
00:05:40,880 --> 00:05:41,759
whatever

185
00:05:41,759 --> 00:05:44,720
so we brought phil the ops manager along

186
00:05:44,720 --> 00:05:46,240
and that gives them a bit of firsthand

187
00:05:46,240 --> 00:05:48,560
experience is how these jobs actually go

188
00:05:48,560 --> 00:05:52,080
on the ground it's worth noting that

189
00:05:52,080 --> 00:05:54,479
in my experience with these scada

190
00:05:54,479 --> 00:05:55,759
systems um

191
00:05:55,759 --> 00:05:58,560
often scatter terminals don't lock they

192
00:05:58,560 --> 00:06:00,080
might have a screen saver but

193
00:06:00,080 --> 00:06:01,840
they just don't lock and presumably this

194
00:06:01,840 --> 00:06:03,120
is because they're generally

195
00:06:03,120 --> 00:06:04,560
kind of at the heart of a secure

196
00:06:04,560 --> 00:06:06,639
facility and so

197
00:06:06,639 --> 00:06:08,639
you know ease of use and whatever and

198
00:06:08,639 --> 00:06:10,160
some operator can just turn around and

199
00:06:10,160 --> 00:06:11,360
go and do stuff and they don't have to

200
00:06:11,360 --> 00:06:12,800
remember a password or they have some

201
00:06:12,800 --> 00:06:13,840
horrible shared account and the

202
00:06:13,840 --> 00:06:15,520
passwords on a post-it note

203
00:06:15,520 --> 00:06:17,919
um you know but we're sitting there with

204
00:06:17,919 --> 00:06:18,560
these

205
00:06:18,560 --> 00:06:21,360
live unlocked scada control systems and

206
00:06:21,360 --> 00:06:22,960
at this point we're literally a few

207
00:06:22,960 --> 00:06:24,319
clicks away from affecting power

208
00:06:24,319 --> 00:06:26,720
delivery

209
00:06:26,800 --> 00:06:28,400
right so at this point we've got two of

210
00:06:28,400 --> 00:06:30,479
the three goals ticked off

211
00:06:30,479 --> 00:06:33,039
so it was time to go get the third one

212
00:06:33,039 --> 00:06:34,880
and hopefully some bad photos that i can

213
00:06:34,880 --> 00:06:37,600
use in a con talk at some point

214
00:06:37,600 --> 00:06:39,440
so we rock up to the server room door

215
00:06:39,440 --> 00:06:41,280
and on this job i had my

216
00:06:41,280 --> 00:06:44,479
full bag of badness with me like all of

217
00:06:44,479 --> 00:06:45,919
the mischief this is the kind of thing

218
00:06:45,919 --> 00:06:47,440
where if for whatever reason you got

219
00:06:47,440 --> 00:06:48,000
stopped by

220
00:06:48,000 --> 00:06:49,360
a police officer and they looked in your

221
00:06:49,360 --> 00:06:52,720
bag they would be like prison

222
00:06:52,720 --> 00:06:55,360
the prison you know i had pretty much

223
00:06:55,360 --> 00:06:57,360
every type of lockpick that exists an

224
00:06:57,360 --> 00:07:00,000
under the door tool had shims prying

225
00:07:00,000 --> 00:07:00,800
tools

226
00:07:00,800 --> 00:07:04,240
just all the mischief and there on this

227
00:07:04,240 --> 00:07:05,199
door

228
00:07:05,199 --> 00:07:08,400
is this stupid push button combination

229
00:07:08,400 --> 00:07:08,880
lock

230
00:07:08,880 --> 00:07:10,400
this is like in new zealand these things

231
00:07:10,400 --> 00:07:12,639
are ubiquitous it's called a lockwood dx

232
00:07:12,639 --> 00:07:15,199
dx digital whatever and these are you

233
00:07:15,199 --> 00:07:16,479
see these on like

234
00:07:16,479 --> 00:07:19,440
shoe store shoe shop store rooms and

235
00:07:19,440 --> 00:07:21,120
employee bathrooms and

236
00:07:21,120 --> 00:07:22,880
apparently also critical national

237
00:07:22,880 --> 00:07:25,599
infrastructure server rooms

238
00:07:25,599 --> 00:07:27,360
the problem was that i actually had no

239
00:07:27,360 --> 00:07:28,639
real idea

240
00:07:28,639 --> 00:07:30,240
how to attack these things you know do

241
00:07:30,240 --> 00:07:32,400
you twist the thumb turn and

242
00:07:32,400 --> 00:07:36,400
push buttons and feel for you know

243
00:07:36,400 --> 00:07:39,440
something or can you you know put a thin

244
00:07:39,440 --> 00:07:41,759
piece of metal in somewhere and

245
00:07:41,759 --> 00:07:43,680
feel whether there's a gate like you can

246
00:07:43,680 --> 00:07:46,400
with the luggage locks things like that

247
00:07:46,400 --> 00:07:48,800
no idea frustratingly this actually

248
00:07:48,800 --> 00:07:50,479
meant that we didn't get into that

249
00:07:50,479 --> 00:07:52,960
server room which is kind of like

250
00:07:52,960 --> 00:07:55,039
this massive anti-climax of you know we

251
00:07:55,039 --> 00:07:56,560
got past this fancy control and that

252
00:07:56,560 --> 00:07:58,080
fancy control and we did the social

253
00:07:58,080 --> 00:07:59,360
engineering and all this stuff and then

254
00:07:59,360 --> 00:08:01,919
we got beaten by like this

255
00:08:01,919 --> 00:08:03,520
what is generally perceived to be a

256
00:08:03,520 --> 00:08:05,280
pretty crappy lock

257
00:08:05,280 --> 00:08:06,720
um but you know i went away from this

258
00:08:06,720 --> 00:08:08,080
and i was determined to work out a

259
00:08:08,080 --> 00:08:10,319
useful attack against these things

260
00:08:10,319 --> 00:08:11,840
and i will see where for a moment here

261
00:08:11,840 --> 00:08:13,759
there was this crazy thing that happened

262
00:08:13,759 --> 00:08:15,039
during this engagement

263
00:08:15,039 --> 00:08:16,560
um and i'm including it here purely for

264
00:08:16,560 --> 00:08:18,960
entertainment's sake um the customer had

265
00:08:18,960 --> 00:08:20,000
asked us

266
00:08:20,000 --> 00:08:21,919
regardless of whether we gained entry or

267
00:08:21,919 --> 00:08:24,479
not to set the alarm off on the building

268
00:08:24,479 --> 00:08:25,759
in the middle of the night

269
00:08:25,759 --> 00:08:27,360
so that they could gauge the monitoring

270
00:08:27,360 --> 00:08:28,800
company's response

271
00:08:28,800 --> 00:08:30,639
thus annoying all of the neighbours and

272
00:08:30,639 --> 00:08:32,399
probably getting the police called

273
00:08:32,399 --> 00:08:35,120
now contrary to appearances i'm not

274
00:08:35,120 --> 00:08:38,000
actually in a huge hurry to be arrested

275
00:08:38,000 --> 00:08:39,679
so i thought that i'd head this one off

276
00:08:39,679 --> 00:08:41,360
preemptively and i just phoned the

277
00:08:41,360 --> 00:08:42,799
police beforehand

278
00:08:42,799 --> 00:08:45,839
which went a bit like this hi

279
00:08:45,839 --> 00:08:48,880
um nice police person

280
00:08:48,880 --> 00:08:52,240
uh i'm a security tester

281
00:08:52,240 --> 00:08:54,959
uh and i'm gonna set the alarm off at 21

282
00:08:54,959 --> 00:08:57,120
sesame street at some point between 10

283
00:08:57,120 --> 00:08:58,800
p.m and 2 a.m tonight

284
00:08:58,800 --> 00:09:00,480
and it would be awesome if you didn't

285
00:09:00,480 --> 00:09:02,959
show up

286
00:09:04,880 --> 00:09:06,160
and they were like cool thanks for

287
00:09:06,160 --> 00:09:09,040
letting us know bye

288
00:09:09,040 --> 00:09:12,160
and i was like okay crime

289
00:09:12,160 --> 00:09:14,399
and it works like later that night we're

290
00:09:14,399 --> 00:09:16,000
standing outside this building

291
00:09:16,000 --> 00:09:18,080
the alarm box is wailing there's a

292
00:09:18,080 --> 00:09:20,240
flashing blue light and two police cars

293
00:09:20,240 --> 00:09:23,440
drove past and we're like

294
00:09:23,440 --> 00:09:25,600
so hypothetically if you're ever going

295
00:09:25,600 --> 00:09:27,600
to do hypothetical bank robbery or

296
00:09:27,600 --> 00:09:28,880
something

297
00:09:28,880 --> 00:09:30,399
hypothetically let the police know

298
00:09:30,399 --> 00:09:33,040
beforehand

299
00:09:34,320 --> 00:09:36,480
so anyway back to the locks um and my

300
00:09:36,480 --> 00:09:37,680
plan

301
00:09:37,680 --> 00:09:39,440
my plan to find some sort of interesting

302
00:09:39,440 --> 00:09:41,600
way to get these things open

303
00:09:41,600 --> 00:09:44,240
um yeah that's awesome isn't it what a

304
00:09:44,240 --> 00:09:45,279
blowout

305
00:09:45,279 --> 00:09:48,880
don't do crimes um you know i wanted to

306
00:09:48,880 --> 00:09:51,440
have a viable attack it had to be

307
00:09:51,440 --> 00:09:52,720
repeatable

308
00:09:52,720 --> 00:09:54,959
both against an individual lock and

309
00:09:54,959 --> 00:09:56,880
against this family of locks

310
00:09:56,880 --> 00:09:59,760
um you know it had to work more or less

311
00:09:59,760 --> 00:10:01,600
the same way every time you tried it

312
00:10:01,600 --> 00:10:03,680
and it had to have a definite output i

313
00:10:03,680 --> 00:10:05,519
didn't want to create some technique

314
00:10:05,519 --> 00:10:07,360
that relied on some sort of subjective

315
00:10:07,360 --> 00:10:09,279
determination of like

316
00:10:09,279 --> 00:10:11,760
how did the button feel when you pressed

317
00:10:11,760 --> 00:10:12,480
it

318
00:10:12,480 --> 00:10:15,279
or like you know i didn't i wanted

319
00:10:15,279 --> 00:10:16,720
something that wasn't dependent on the

320
00:10:16,720 --> 00:10:18,560
skill level of the person performing the

321
00:10:18,560 --> 00:10:20,240
attack

322
00:10:20,240 --> 00:10:21,760
and so we'll start off with some prior

323
00:10:21,760 --> 00:10:23,279
art and that's looking at attacks

324
00:10:23,279 --> 00:10:24,320
against these locks

325
00:10:24,320 --> 00:10:26,640
that are already known about like any

326
00:10:26,640 --> 00:10:28,480
good security research it's worthwhile

327
00:10:28,480 --> 00:10:30,399
knowing what people before you have done

328
00:10:30,399 --> 00:10:32,000
as it will both save you some time

329
00:10:32,000 --> 00:10:34,160
rehashing like you know going and

330
00:10:34,160 --> 00:10:35,920
making this round thing that helps

331
00:10:35,920 --> 00:10:37,760
transport goods and

332
00:10:37,760 --> 00:10:40,000
rolls well you know and announcing it to

333
00:10:40,000 --> 00:10:41,600
the world and everyone laughs at you

334
00:10:41,600 --> 00:10:44,000
um you know and it may also give you

335
00:10:44,000 --> 00:10:45,839
some ideas of some places to start and

336
00:10:45,839 --> 00:10:46,959
where to go and

337
00:10:46,959 --> 00:10:48,720
you know someone might say oh we looked

338
00:10:48,720 --> 00:10:50,320
at this and it was interesting but we

339
00:10:50,320 --> 00:10:51,040
didn't go

340
00:10:51,040 --> 00:10:53,760
deep on it that kind of thing so early

341
00:10:53,760 --> 00:10:54,800
models of these

342
00:10:54,800 --> 00:10:56,959
lockwoods and a lot of the cheap copies

343
00:10:56,959 --> 00:10:58,240
of them that have come out over the

344
00:10:58,240 --> 00:10:59,440
years

345
00:10:59,440 --> 00:11:02,399
they have a direct bypass vulnerability

346
00:11:02,399 --> 00:11:03,600
so basically the

347
00:11:03,600 --> 00:11:05,360
thumb turn that you use to open the lock

348
00:11:05,360 --> 00:11:06,720
with there's a

349
00:11:06,720 --> 00:11:08,560
square shaft that runs through the door

350
00:11:08,560 --> 00:11:10,320
and actually actuates the

351
00:11:10,320 --> 00:11:12,560
latch and you could take a thin piece of

352
00:11:12,560 --> 00:11:14,320
metal with a notch in it and slip it

353
00:11:14,320 --> 00:11:15,839
behind the lock and just turn the

354
00:11:15,839 --> 00:11:17,040
locking shaft

355
00:11:17,040 --> 00:11:19,440
and the door would just open however

356
00:11:19,440 --> 00:11:20,880
they got wires to this and there's a few

357
00:11:20,880 --> 00:11:22,240
different ways that this

358
00:11:22,240 --> 00:11:23,920
can be mitigated some of the locks have

359
00:11:23,920 --> 00:11:25,920
a small sleeve that extends into the

360
00:11:25,920 --> 00:11:27,920
hole in the door so you can't get it out

361
00:11:27,920 --> 00:11:29,279
some of them have kind of like a rubber

362
00:11:29,279 --> 00:11:31,440
gasket that kind of thing

363
00:11:31,440 --> 00:11:32,720
the other thing about that attack is it

364
00:11:32,720 --> 00:11:34,079
is a little bit risky because you can

365
00:11:34,079 --> 00:11:36,079
gouge up the finish on the door

366
00:11:36,079 --> 00:11:40,000
and clients get grumpy when you do that

367
00:11:40,000 --> 00:11:41,279
another way that you can sometimes

368
00:11:41,279 --> 00:11:43,200
easily obtain numbers and a combination

369
00:11:43,200 --> 00:11:44,560
lock

370
00:11:44,560 --> 00:11:47,600
is just by observing the lock closely um

371
00:11:47,600 --> 00:11:48,959
combination locks that have been well

372
00:11:48,959 --> 00:11:50,639
used will often have wear

373
00:11:50,639 --> 00:11:53,680
as you see here smudges greasy marks or

374
00:11:53,680 --> 00:11:55,440
other distinguishing features

375
00:11:55,440 --> 00:11:56,800
on the commonly pressed buttons

376
00:11:56,800 --> 00:11:58,399
particularly if the code hasn't been

377
00:11:58,399 --> 00:12:00,639
changed fairly regularly

378
00:12:00,639 --> 00:12:02,560
you know it's like a password what's the

379
00:12:02,560 --> 00:12:03,839
new guidance don't change it ever and

380
00:12:03,839 --> 00:12:04,720
make it really long

381
00:12:04,720 --> 00:12:07,760
like no good for these

382
00:12:07,760 --> 00:12:09,760
you know and locks that are used

383
00:12:09,760 --> 00:12:11,440
infrequently will often have a thin

384
00:12:11,440 --> 00:12:13,040
layer of dust sitting on top of the

385
00:12:13,040 --> 00:12:13,760
buttons

386
00:12:13,760 --> 00:12:15,040
however the ones that have been pushed

387
00:12:15,040 --> 00:12:17,120
will have had the dust brushed off so

388
00:12:17,120 --> 00:12:18,399
just by looking at the

389
00:12:18,399 --> 00:12:19,839
lock you may be able to determine the

390
00:12:19,839 --> 00:12:22,320
components of the combination

391
00:12:22,320 --> 00:12:25,839
but what about the order of the numbers

392
00:12:25,839 --> 00:12:28,000
and this leads me into a kind of

393
00:12:28,000 --> 00:12:30,160
interesting fact about these locks that

394
00:12:30,160 --> 00:12:31,680
i was surprised by how many people

395
00:12:31,680 --> 00:12:33,680
weren't aware of it the order on these

396
00:12:33,680 --> 00:12:35,839
locks doesn't actually matter

397
00:12:35,839 --> 00:12:38,320
and each button can only be pressed once

398
00:12:38,320 --> 00:12:40,160
because the way these locks work is that

399
00:12:40,160 --> 00:12:42,240
each button has what i'll call a tumbler

400
00:12:42,240 --> 00:12:43,040
underneath it this

401
00:12:43,040 --> 00:12:46,880
is on the right here

402
00:12:47,519 --> 00:12:49,839
and the tumbler either blocks the lock

403
00:12:49,839 --> 00:12:51,760
when it hasn't been pressed

404
00:12:51,760 --> 00:12:53,600
if it's included in the combination i

405
00:12:53,600 --> 00:12:57,279
hope that sort of follows which is the

406
00:12:57,279 --> 00:13:00,959
bottom one or

407
00:13:00,959 --> 00:13:03,360
it blocks the lock if it has been

408
00:13:03,360 --> 00:13:04,959
pressed and it's not included in the

409
00:13:04,959 --> 00:13:06,560
combination

410
00:13:06,560 --> 00:13:08,720
yeah i think i got there so as long as

411
00:13:08,720 --> 00:13:10,320
you've pressed all of the buttons in the

412
00:13:10,320 --> 00:13:11,680
combination and none

413
00:13:11,680 --> 00:13:14,480
aren't the lock will open and kind of to

414
00:13:14,480 --> 00:13:15,839
illustrate that

415
00:13:15,839 --> 00:13:17,680
all of the codes on the left hand side

416
00:13:17,680 --> 00:13:19,920
here are functionally identical as far

417
00:13:19,920 --> 00:13:22,320
as these locks are concerned

418
00:13:22,320 --> 00:13:24,079
and so then we can get into the maths of

419
00:13:24,079 --> 00:13:25,760
the key space of the lock

420
00:13:25,760 --> 00:13:27,440
and this is the total number of possible

421
00:13:27,440 --> 00:13:29,120
combinations and what essentially gives

422
00:13:29,120 --> 00:13:31,120
the lock any semblance of security

423
00:13:31,120 --> 00:13:32,639
due to the number of permutations you

424
00:13:32,639 --> 00:13:33,920
would need to try if you would

425
00:13:33,920 --> 00:13:36,079
exhaustively brute force the

426
00:13:36,079 --> 00:13:39,360
entire possibility so these locks

427
00:13:39,360 --> 00:13:40,880
typically have the numbers zero through

428
00:13:40,880 --> 00:13:42,320
nine and they have three letters

429
00:13:42,320 --> 00:13:45,199
xyz there's also a c which is for clear

430
00:13:45,199 --> 00:13:46,240
and that just kind of like

431
00:13:46,240 --> 00:13:48,320
undoes whatever's been pushed on the

432
00:13:48,320 --> 00:13:49,519
lock um

433
00:13:49,519 --> 00:13:51,519
you know and if this was a password we

434
00:13:51,519 --> 00:13:52,639
have a character set

435
00:13:52,639 --> 00:13:54,720
total character set of 13 and we have a

436
00:13:54,720 --> 00:13:56,320
typical password length of four

437
00:13:56,320 --> 00:13:57,839
characters and this is because most of

438
00:13:57,839 --> 00:13:58,720
these locks

439
00:13:58,720 --> 00:14:00,560
come configured with four of the

440
00:14:00,560 --> 00:14:02,320
tumblers they usually come with a couple

441
00:14:02,320 --> 00:14:04,240
of extra tumblers so you can lengthen

442
00:14:04,240 --> 00:14:05,920
or if you really want to shorten the

443
00:14:05,920 --> 00:14:08,000
combination but the very vast majority

444
00:14:08,000 --> 00:14:09,279
of them they come across are configured

445
00:14:09,279 --> 00:14:10,880
with a four character

446
00:14:10,880 --> 00:14:12,800
combination so this gives you a total

447
00:14:12,800 --> 00:14:15,279
key space of 13 to the power of 4

448
00:14:15,279 --> 00:14:18,880
or 28 561 possible combinations

449
00:14:18,880 --> 00:14:21,040
now that's rubbish for a computer type

450
00:14:21,040 --> 00:14:22,399
system where you can do

451
00:14:22,399 --> 00:14:23,920
hundreds or thousands of guesses a

452
00:14:23,920 --> 00:14:25,680
second but it's actually pretty useful

453
00:14:25,680 --> 00:14:27,760
when it takes you several seconds to try

454
00:14:27,760 --> 00:14:31,760
a password out however unlike a password

455
00:14:31,760 --> 00:14:33,519
we have two constraints here

456
00:14:33,519 --> 00:14:35,760
the order doesn't matter and a character

457
00:14:35,760 --> 00:14:37,279
cannot be used twice

458
00:14:37,279 --> 00:14:38,720
now we're essentially calculating

459
00:14:38,720 --> 00:14:40,639
lottery odds but you only have to

460
00:14:40,639 --> 00:14:42,639
correctly draw four correct numbers

461
00:14:42,639 --> 00:14:45,600
in any order from a pool of 13. and the

462
00:14:45,600 --> 00:14:46,240
odds of this

463
00:14:46,240 --> 00:14:49,600
is deep breath 13 factorial over 4

464
00:14:49,600 --> 00:14:50,480
factorial times

465
00:14:50,480 --> 00:14:55,440
13 minus 4 factorial or 1 in 715

466
00:14:55,440 --> 00:14:58,399
so these locks when used with a

467
00:14:58,399 --> 00:15:00,000
four-digit combination

468
00:15:00,000 --> 00:15:02,320
actually have a smaller key space than

469
00:15:02,320 --> 00:15:03,839
those three-wheel

470
00:15:03,839 --> 00:15:06,000
luggage combination locks that you get

471
00:15:06,000 --> 00:15:07,360
at the two-dollar shop i mean those have

472
00:15:07,360 --> 00:15:08,880
their own vulnerabilities but from a

473
00:15:08,880 --> 00:15:11,839
purely like mathematical

474
00:15:11,839 --> 00:15:14,079
they're kind of more secure it's still

475
00:15:14,079 --> 00:15:15,360
not awesome to have to try and brute

476
00:15:15,360 --> 00:15:17,519
force your way through 715 combinations

477
00:15:17,519 --> 00:15:18,959
though

478
00:15:18,959 --> 00:15:20,480
so i got my hands on a couple of these

479
00:15:20,480 --> 00:15:21,920
locks and i started playing around with

480
00:15:21,920 --> 00:15:22,399
them

481
00:15:22,399 --> 00:15:24,079
pulling them apart examining how the

482
00:15:24,079 --> 00:15:26,160
internal components interact and i will

483
00:15:26,160 --> 00:15:27,720
just start by saying that these are

484
00:15:27,720 --> 00:15:30,480
fiendishly fiddly little locks and they

485
00:15:30,480 --> 00:15:30,800
are

486
00:15:30,800 --> 00:15:33,600
full of these tiny little springs that

487
00:15:33,600 --> 00:15:35,440
when you pull the lock apart they fly

488
00:15:35,440 --> 00:15:38,720
all over your lounge room and you go fun

489
00:15:38,720 --> 00:15:40,079
i love crawling around the floor of the

490
00:15:40,079 --> 00:15:43,199
torch looking for tony lock parts

491
00:15:43,199 --> 00:15:45,600
oh and then you find it in your shoelace

492
00:15:45,600 --> 00:15:47,279
and it's been following you around the

493
00:15:47,279 --> 00:15:48,320
room

494
00:15:48,320 --> 00:15:52,399
ah anyway when you try to turn the thumb

495
00:15:52,399 --> 00:15:52,959
turn

496
00:15:52,959 --> 00:15:55,360
it pushes this frame thing which is kind

497
00:15:55,360 --> 00:15:57,600
of that outer

498
00:15:57,600 --> 00:15:59,680
slightly jaggedy bit there and that

499
00:15:59,680 --> 00:16:01,120
corresponds to the fence

500
00:16:01,120 --> 00:16:02,639
in a traditional combination lock for

501
00:16:02,639 --> 00:16:04,480
those who are familiar with them

502
00:16:04,480 --> 00:16:08,000
it it pushes that upward in the lock and

503
00:16:08,000 --> 00:16:09,920
the little tabs that extend from that

504
00:16:09,920 --> 00:16:10,399
frame

505
00:16:10,399 --> 00:16:12,560
into the sort of middle section of that

506
00:16:12,560 --> 00:16:14,560
lock they are either um

507
00:16:14,560 --> 00:16:16,720
blocked by tumblers that are incorrectly

508
00:16:16,720 --> 00:16:19,199
set or allowed to pass through gates

509
00:16:19,199 --> 00:16:21,600
incorrectly set tumblers when all of

510
00:16:21,600 --> 00:16:23,040
them are correctly set

511
00:16:23,040 --> 00:16:24,959
none of the tabs are blocked the frame

512
00:16:24,959 --> 00:16:26,880
moves upward and the thumb turn is

513
00:16:26,880 --> 00:16:29,279
allowed to rotate and the door opens

514
00:16:29,279 --> 00:16:32,000
it's worth noting that the thumb turn is

515
00:16:32,000 --> 00:16:32,639
actually quite

516
00:16:32,639 --> 00:16:35,279
indirectly connected to this frame it

517
00:16:35,279 --> 00:16:36,240
goes through like a

518
00:16:36,240 --> 00:16:37,920
gear drive and there's these little pins

519
00:16:37,920 --> 00:16:40,959
and stuff so you can't actually derive

520
00:16:40,959 --> 00:16:44,000
much in the way of useful feedback of

521
00:16:44,000 --> 00:16:45,839
the state of the tumblers from the frame

522
00:16:45,839 --> 00:16:48,959
because of that indirectness

523
00:16:48,959 --> 00:16:51,120
so tumblers underneath buttons that have

524
00:16:51,120 --> 00:16:52,959
been pushed are held in place

525
00:16:52,959 --> 00:16:55,040
by these little tiny springy tabs

526
00:16:55,040 --> 00:16:56,639
fortunately they don't shoot out of the

527
00:16:56,639 --> 00:16:58,560
lock

528
00:16:58,560 --> 00:17:00,639
and they hold the tumblers up and when

529
00:17:00,639 --> 00:17:01,920
you hit the clear button

530
00:17:01,920 --> 00:17:03,680
all of the springy tabs move away from

531
00:17:03,680 --> 00:17:05,359
the tumblers simultaneously

532
00:17:05,359 --> 00:17:07,119
and the lock gives this audible little

533
00:17:07,119 --> 00:17:09,199
click as all of the spring-loaded

534
00:17:09,199 --> 00:17:10,799
tumblers pop back into the resting

535
00:17:10,799 --> 00:17:12,880
position

536
00:17:12,880 --> 00:17:15,439
now the fact that the lock emits sound

537
00:17:15,439 --> 00:17:16,959
when you interact with it

538
00:17:16,959 --> 00:17:18,240
means that it may be vulnerable to

539
00:17:18,240 --> 00:17:20,079
what's called a side channel attack

540
00:17:20,079 --> 00:17:22,240
where a system leaks information through

541
00:17:22,240 --> 00:17:24,079
something that is intrinsic to

542
00:17:24,079 --> 00:17:26,720
how it operates and safe cracking using

543
00:17:26,720 --> 00:17:28,480
a stethoscope like this awesome stock

544
00:17:28,480 --> 00:17:30,080
image here

545
00:17:30,080 --> 00:17:31,840
you know in that you're listening for

546
00:17:31,840 --> 00:17:33,280
discrepancies

547
00:17:33,280 --> 00:17:35,520
differences just variations and how a

548
00:17:35,520 --> 00:17:37,039
dial combination lock

549
00:17:37,039 --> 00:17:38,799
sounds and this is a type of physical

550
00:17:38,799 --> 00:17:40,880
security side channel attack

551
00:17:40,880 --> 00:17:42,960
the lock is leaking information about

552
00:17:42,960 --> 00:17:44,400
its configuration

553
00:17:44,400 --> 00:17:46,799
in the form of sounds when it's used in

554
00:17:46,799 --> 00:17:49,039
a particular way

555
00:17:49,039 --> 00:17:50,320
and there's actually some really novel

556
00:17:50,320 --> 00:17:52,559
attacks against electronic systems that

557
00:17:52,559 --> 00:17:55,760
use um they involve monitoring

558
00:17:55,760 --> 00:17:58,400
very tiny variations in for example

559
00:17:58,400 --> 00:18:00,160
power consumption or power draw from a

560
00:18:00,160 --> 00:18:01,919
battery

561
00:18:01,919 --> 00:18:04,400
and reviewing those as for example a

562
00:18:04,400 --> 00:18:06,160
cryptographic key is retrieved or

563
00:18:06,160 --> 00:18:07,280
generated

564
00:18:07,280 --> 00:18:08,559
but in this case we are looking for

565
00:18:08,559 --> 00:18:11,200
something a lot more low tech

566
00:18:11,200 --> 00:18:13,280
so back to that frame thing when you're

567
00:18:13,280 --> 00:18:14,480
trying to open the lock

568
00:18:14,480 --> 00:18:16,720
the tabs are blocked by incorrectly set

569
00:18:16,720 --> 00:18:17,919
tumblers

570
00:18:17,919 --> 00:18:19,919
on the left you can see that the frame

571
00:18:19,919 --> 00:18:21,600
you can barely see it's pretty tiny and

572
00:18:21,600 --> 00:18:23,760
like go cell phone pictures but

573
00:18:23,760 --> 00:18:27,039
on the left the tab is blocking as being

574
00:18:27,039 --> 00:18:29,039
blocked by the tumbler

575
00:18:29,039 --> 00:18:30,480
and on the right you can just kind of

576
00:18:30,480 --> 00:18:33,360
see it is it's underneath that

577
00:18:33,360 --> 00:18:35,200
blocky part of it it is able to pass

578
00:18:35,200 --> 00:18:36,960
through the tumbler

579
00:18:36,960 --> 00:18:39,280
you know but what if we misuse the lock

580
00:18:39,280 --> 00:18:41,039
and operate it in a way that wasn't

581
00:18:41,039 --> 00:18:42,000
expected

582
00:18:42,000 --> 00:18:44,160
and after a bit of experimenting i found

583
00:18:44,160 --> 00:18:45,280
that if you only push

584
00:18:45,280 --> 00:18:47,919
one button and then you put moderately

585
00:18:47,919 --> 00:18:50,320
heavy torque onto the thumb turn

586
00:18:50,320 --> 00:18:53,760
in most cases the tab on the frame when

587
00:18:53,760 --> 00:18:55,520
it comes up against that tumbler

588
00:18:55,520 --> 00:18:57,520
if you apply talk it will grab that

589
00:18:57,520 --> 00:19:00,080
tumbler and it will hold it in place

590
00:19:00,080 --> 00:19:01,840
and then when you press the clear button

591
00:19:01,840 --> 00:19:04,000
it holds that tumbler up instead of

592
00:19:04,000 --> 00:19:04,720
letting it

593
00:19:04,720 --> 00:19:06,799
return to its position if you're

594
00:19:06,799 --> 00:19:08,799
familiar with the concepts of regular

595
00:19:08,799 --> 00:19:11,280
lock picking this is similar to how a

596
00:19:11,280 --> 00:19:12,320
pin binds

597
00:19:12,320 --> 00:19:13,760
when picking a lock and it was actually

598
00:19:13,760 --> 00:19:17,039
the inspiration for this technique

599
00:19:17,039 --> 00:19:19,440
so what we can hold a tumbler in place

600
00:19:19,440 --> 00:19:20,080
but

601
00:19:20,080 --> 00:19:23,120
you know there it is there's an

602
00:19:23,120 --> 00:19:25,360
opportunity for a side channel attack

603
00:19:25,360 --> 00:19:27,679
and because the tumbler is held in place

604
00:19:27,679 --> 00:19:30,320
what happens when clear is pressed

605
00:19:30,320 --> 00:19:33,440
nothing and because nothing happens

606
00:19:33,440 --> 00:19:35,360
nothing is heard from the lock

607
00:19:35,360 --> 00:19:37,280
conversely if you test a button that is

608
00:19:37,280 --> 00:19:38,400
in the combination

609
00:19:38,400 --> 00:19:40,000
there's nothing for the frame to grab

610
00:19:40,000 --> 00:19:41,919
onto on the tumbler because

611
00:19:41,919 --> 00:19:43,360
the frame is just going into the space

612
00:19:43,360 --> 00:19:45,280
where the gate is and so when you hit

613
00:19:45,280 --> 00:19:45,760
clear

614
00:19:45,760 --> 00:19:47,679
the lock will audibly click as the

615
00:19:47,679 --> 00:19:50,559
tumbler falls back into place

616
00:19:50,559 --> 00:19:52,400
and this means that through sound the

617
00:19:52,400 --> 00:19:54,080
lock will provide you information about

618
00:19:54,080 --> 00:19:55,280
its configuration

619
00:19:55,280 --> 00:19:57,120
eliminating buttons from the possible

620
00:19:57,120 --> 00:19:58,400
combination

621
00:19:58,400 --> 00:20:01,039
if you hit clear and there is no click

622
00:20:01,039 --> 00:20:02,880
you can categorically exclude that

623
00:20:02,880 --> 00:20:03,360
button

624
00:20:03,360 --> 00:20:05,679
from your possible combinations the

625
00:20:05,679 --> 00:20:07,440
complete process is just to go through

626
00:20:07,440 --> 00:20:08,880
all of the buttons on the lock

627
00:20:08,880 --> 00:20:11,760
following that process of press talk

628
00:20:11,760 --> 00:20:12,480
clear

629
00:20:12,480 --> 00:20:14,559
listen and then you note the behavior of

630
00:20:14,559 --> 00:20:16,000
each button

631
00:20:16,000 --> 00:20:18,240
if you get an unclear result like a

632
00:20:18,240 --> 00:20:20,400
quiet click or some muffled

633
00:20:20,400 --> 00:20:22,720
mechanical sort of sound and not sure

634
00:20:22,720 --> 00:20:24,080
whether that was a click or not

635
00:20:24,080 --> 00:20:25,760
sometimes turning the thumb turn the

636
00:20:25,760 --> 00:20:27,440
other direction um

637
00:20:27,440 --> 00:20:30,240
or within reason increasing the torque

638
00:20:30,240 --> 00:20:31,760
on the thumb turn can give you a more

639
00:20:31,760 --> 00:20:34,559
clear result

640
00:20:34,559 --> 00:20:36,000
unfortunately this isn't yet a

641
00:20:36,000 --> 00:20:38,159
completely foolproof attack

642
00:20:38,159 --> 00:20:40,000
due to basically manufacturing

643
00:20:40,000 --> 00:20:42,720
tolerances and subtle variations between

644
00:20:42,720 --> 00:20:43,760
locks

645
00:20:43,760 --> 00:20:45,840
sometimes one of the valid tumblers is a

646
00:20:45,840 --> 00:20:47,360
really chunky boy

647
00:20:47,360 --> 00:20:49,120
and the frame will be blocked by it

648
00:20:49,120 --> 00:20:50,640
every time

649
00:20:50,640 --> 00:20:52,400
no matter what you how you push the

650
00:20:52,400 --> 00:20:54,720
other ones that tumbler is just blocking

651
00:20:54,720 --> 00:20:55,760
the frame

652
00:20:55,760 --> 00:20:57,039
and that means that you've got a click

653
00:20:57,039 --> 00:20:59,440
from invalid buttons

654
00:20:59,440 --> 00:21:02,080
so it you know limits which buttons you

655
00:21:02,080 --> 00:21:03,440
can eliminate from the combination

656
00:21:03,440 --> 00:21:05,360
um you know i've spent several hours

657
00:21:05,360 --> 00:21:08,000
sitting there with a lock to my ear like

658
00:21:08,000 --> 00:21:09,840
pushing this button and having a listen

659
00:21:09,840 --> 00:21:11,280
and being like was that a click and then

660
00:21:11,280 --> 00:21:12,640
you think you've got some technique and

661
00:21:12,640 --> 00:21:13,360
then you try it

662
00:21:13,360 --> 00:21:14,720
five times and on the fifth time it

663
00:21:14,720 --> 00:21:16,559
doesn't work and you it's a bit

664
00:21:16,559 --> 00:21:18,159
miserable but

665
00:21:18,159 --> 00:21:20,080
i'm not quite there yet i'm confident

666
00:21:20,080 --> 00:21:22,240
that there will be some

667
00:21:22,240 --> 00:21:24,480
chain of actions that will improve this

668
00:21:24,480 --> 00:21:25,760
attack and

669
00:21:25,760 --> 00:21:28,000
bring it up to that like maximum

670
00:21:28,000 --> 00:21:30,240
consistency level but

671
00:21:30,240 --> 00:21:32,960
anyway back to the maths in standard

672
00:21:32,960 --> 00:21:34,559
kiwi fashion i've declared that this

673
00:21:34,559 --> 00:21:36,159
attack is still good enough

674
00:21:36,159 --> 00:21:38,400
to be useful um if you can eliminate

675
00:21:38,400 --> 00:21:39,760
just one button

676
00:21:39,760 --> 00:21:42,400
you're down to 495 combinations assuming

677
00:21:42,400 --> 00:21:44,080
a four character code

678
00:21:44,080 --> 00:21:46,240
and it's not very useful but if you can

679
00:21:46,240 --> 00:21:47,440
eliminate say

680
00:21:47,440 --> 00:21:50,240
six buttons you're down to only 35

681
00:21:50,240 --> 00:21:51,760
combinations which is

682
00:21:51,760 --> 00:21:53,600
fairly feasible to iterate through

683
00:21:53,600 --> 00:21:55,440
especially if you try any obvious ones

684
00:21:55,440 --> 00:21:57,039
first

685
00:21:57,039 --> 00:21:58,559
and look for any distinguishing marks

686
00:21:58,559 --> 00:22:00,080
like i mentioned earlier on the lock

687
00:22:00,080 --> 00:22:01,840
that may help you narrow it down

688
00:22:01,840 --> 00:22:04,159
um i recently purchased a used lock on

689
00:22:04,159 --> 00:22:05,200
trademe

690
00:22:05,200 --> 00:22:07,280
took it out of the courier bag they sent

691
00:22:07,280 --> 00:22:09,280
it in sent to me in

692
00:22:09,280 --> 00:22:10,799
and using this technique i was able to

693
00:22:10,799 --> 00:22:12,320
immediately eliminate eight of the

694
00:22:12,320 --> 00:22:13,120
buttons

695
00:22:13,120 --> 00:22:14,960
leaving a total of just five possible

696
00:22:14,960 --> 00:22:16,400
combinations

697
00:22:16,400 --> 00:22:17,760
and so you know law of averages or

698
00:22:17,760 --> 00:22:19,760
whatever five possible combinations

699
00:22:19,760 --> 00:22:21,280
you're fairly likely to get it after two

700
00:22:21,280 --> 00:22:22,799
or three attempts

701
00:22:22,799 --> 00:22:25,520
other locks that i've tried and ask

702
00:22:25,520 --> 00:22:27,280
other people to try this technique on

703
00:22:27,280 --> 00:22:30,559
have actually given a 100 accuracy rate

704
00:22:30,559 --> 00:22:32,640
in determining the state of the tumbler

705
00:22:32,640 --> 00:22:33,760
and they will leak the correct

706
00:22:33,760 --> 00:22:35,600
combination after just one pass through

707
00:22:35,600 --> 00:22:38,000
the possible characters

708
00:22:38,000 --> 00:22:40,480
and like so what something that makes

709
00:22:40,480 --> 00:22:42,320
any physical security vulnerability

710
00:22:42,320 --> 00:22:44,640
really interesting is that patching them

711
00:22:44,640 --> 00:22:46,880
is really really difficult

712
00:22:46,880 --> 00:22:48,400
even if something was changed in these

713
00:22:48,400 --> 00:22:50,080
locks tomorrow to prevent this

714
00:22:50,080 --> 00:22:51,200
information leakage

715
00:22:51,200 --> 00:22:53,919
and some sort of retrofit kit was made

716
00:22:53,919 --> 00:22:56,080
available to fix locks that were already

717
00:22:56,080 --> 00:22:56,880
installed

718
00:22:56,880 --> 00:22:58,480
there would be thousands of vulnerable

719
00:22:58,480 --> 00:23:00,480
locks that remained out there in use

720
00:23:00,480 --> 00:23:03,200
throughout new zealand you know and this

721
00:23:03,200 --> 00:23:04,799
is completely setting aside the fact

722
00:23:04,799 --> 00:23:06,640
that a lot of physical security vendors

723
00:23:06,640 --> 00:23:08,000
have a pretty rough history of

724
00:23:08,000 --> 00:23:09,200
completely ignoring

725
00:23:09,200 --> 00:23:10,559
well-known vulnerabilities in their

726
00:23:10,559 --> 00:23:12,480
products and

727
00:23:12,480 --> 00:23:13,840
you know the point of this is twofold

728
00:23:13,840 --> 00:23:15,679
the first being that if you're red

729
00:23:15,679 --> 00:23:16,480
teaming

730
00:23:16,480 --> 00:23:18,240
these locks are totally attackable you

731
00:23:18,240 --> 00:23:20,320
know if you can get just a few minutes

732
00:23:20,320 --> 00:23:21,600
unattended in front of one of these

733
00:23:21,600 --> 00:23:23,200
locks there's a pretty good chance that

734
00:23:23,200 --> 00:23:24,000
you'll

735
00:23:24,000 --> 00:23:25,440
be able to narrow the combination down

736
00:23:25,440 --> 00:23:27,600
and get the thing open the second

737
00:23:27,600 --> 00:23:29,600
being that like if you're responsible

738
00:23:29,600 --> 00:23:31,360
for the security of a critical national

739
00:23:31,360 --> 00:23:32,880
infrastructure server room you probably

740
00:23:32,880 --> 00:23:35,840
need a better lock than this

741
00:23:35,840 --> 00:23:37,760
where else does this lead um i'm still

742
00:23:37,760 --> 00:23:40,000
working on improving that technique

743
00:23:40,000 --> 00:23:41,760
so that it will correctly identify the

744
00:23:41,760 --> 00:23:43,360
state of all of the buttons

745
00:23:43,360 --> 00:23:45,039
um sometimes i wake up in the middle of

746
00:23:45,039 --> 00:23:46,720
the night with some bizarre idea and i

747
00:23:46,720 --> 00:23:48,840
like go and get a combination lock and

748
00:23:48,840 --> 00:23:50,720
i'm

749
00:23:50,720 --> 00:23:52,000
two o'clock in the morning and getting

750
00:23:52,000 --> 00:23:54,400
told off for it it's probably a problem

751
00:23:54,400 --> 00:23:56,159
i don't know

752
00:23:56,159 --> 00:23:59,679
um once i have a nice technique with a

753
00:23:59,679 --> 00:24:02,000
even better kind of success rate i'd be

754
00:24:02,000 --> 00:24:03,520
quite keen to put together a little app

755
00:24:03,520 --> 00:24:04,320
that you can

756
00:24:04,320 --> 00:24:05,520
have there on your cell phone and it

757
00:24:05,520 --> 00:24:08,159
will guide you through with a series of

758
00:24:08,159 --> 00:24:09,919
like test and observe questions that

759
00:24:09,919 --> 00:24:11,520
will guide you through decoding the lock

760
00:24:11,520 --> 00:24:12,960
and hopefully after a certain number of

761
00:24:12,960 --> 00:24:14,400
steps it will just spit out

762
00:24:14,400 --> 00:24:16,840
you know the password is 0843 or

763
00:24:16,840 --> 00:24:18,080
something

764
00:24:18,080 --> 00:24:21,200
um you know the other thing i'm

765
00:24:21,200 --> 00:24:21,919
interested in

766
00:24:21,919 --> 00:24:24,400
is feedback from people that have been

767
00:24:24,400 --> 00:24:26,000
able to try this technique

768
00:24:26,000 --> 00:24:28,799
and tell me if it worked for you i've

769
00:24:28,799 --> 00:24:30,320
had a very good success rate on my

770
00:24:30,320 --> 00:24:32,799
current sample size which is about

771
00:24:32,799 --> 00:24:34,480
somewhere in the ballpark of 30 locks or

772
00:24:34,480 --> 00:24:35,679
i wouldn't be here talking to you about

773
00:24:35,679 --> 00:24:36,640
them but

774
00:24:36,640 --> 00:24:38,720
you run into that sort of limit of locks

775
00:24:38,720 --> 00:24:40,080
that you're authorized to be messing

776
00:24:40,080 --> 00:24:40,880
around with

777
00:24:40,880 --> 00:24:42,480
and the fact that these locks are kind

778
00:24:42,480 --> 00:24:44,000
of output of about 200

779
00:24:44,000 --> 00:24:45,600
so i can't just go and buy a whole lot

780
00:24:45,600 --> 00:24:48,080
and test this across them all

781
00:24:48,080 --> 00:24:49,440
so i'd love to hear from anyone who

782
00:24:49,440 --> 00:24:51,200
tries it out on locks that they're

783
00:24:51,200 --> 00:24:53,440
authorized to try it out on

784
00:24:53,440 --> 00:24:56,559
no crime and that pretty much wraps this

785
00:24:56,559 --> 00:24:58,320
up

786
00:24:58,320 --> 00:25:00,080
again a huge shout out to the check on

787
00:25:00,080 --> 00:25:01,520
crew for making this happen

788
00:25:01,520 --> 00:25:03,440
uh and to the whole aura crew who

789
00:25:03,440 --> 00:25:04,799
tolerate my desk

790
00:25:04,799 --> 00:25:06,559
and those either side of it looking like

791
00:25:06,559 --> 00:25:08,640
some sort of locksmith junkyard

792
00:25:08,640 --> 00:25:11,919
um i'm on the bird thing at infosnack nz

793
00:25:11,919 --> 00:25:13,200
if you want to contact me

794
00:25:13,200 --> 00:25:17,440
i lurk on the infosec nz slack a lot

795
00:25:17,440 --> 00:25:19,360
and i love to talk security especially

796
00:25:19,360 --> 00:25:20,640
physical security

797
00:25:20,640 --> 00:25:22,880
so feel free to come say hi in person

798
00:25:22,880 --> 00:25:23,679
tomorrow i'll

799
00:25:23,679 --> 00:25:26,159
predominantly be lurking around the lock

800
00:25:26,159 --> 00:25:28,000
sport upstairs come and give that a go

801
00:25:28,000 --> 00:25:30,080
and have a chat and i should have a

802
00:25:30,080 --> 00:25:31,520
couple of these locks

803
00:25:31,520 --> 00:25:34,880
um available tomorrow if you want to

804
00:25:34,880 --> 00:25:37,520
come and try this out have a tinker just

805
00:25:37,520 --> 00:25:42,040
see what they're like thank you

806
00:25:42,040 --> 00:25:45,389
[Applause]

807
00:25:57,120 --> 00:25:59,199
you

