1
00:00:10,400 --> 00:00:11,280
okay

2
00:00:11,280 --> 00:00:14,320
before i start just get everyone's hands

3
00:00:14,320 --> 00:00:15,759
up if you've heard of mitre attack

4
00:00:15,759 --> 00:00:17,119
before it's when i kind of read the room

5
00:00:17,119 --> 00:00:17,760
okay so

6
00:00:17,760 --> 00:00:20,720
hands up okay

7
00:00:21,359 --> 00:00:24,800
hands up if you use mitotek at work

8
00:00:24,800 --> 00:00:27,599
so in a professional setting a little

9
00:00:27,599 --> 00:00:28,880
bit less

10
00:00:28,880 --> 00:00:30,400
and what about hands up again if you

11
00:00:30,400 --> 00:00:33,599
think you use attack well

12
00:00:34,800 --> 00:00:37,360
one person two people okay cool small

13
00:00:37,360 --> 00:00:39,040
small number

14
00:00:39,040 --> 00:00:41,040
okay so this is all the stuff we're

15
00:00:41,040 --> 00:00:43,040
going to try and cover off today

16
00:00:43,040 --> 00:00:44,559
we've got quite a bit of ground to get

17
00:00:44,559 --> 00:00:45,840
through and there's some quite meaty

18
00:00:45,840 --> 00:00:47,039
topics so we're gonna have to move

19
00:00:47,039 --> 00:00:48,239
pretty fast

20
00:00:48,239 --> 00:00:50,239
um to do this i've made a bunch of

21
00:00:50,239 --> 00:00:51,920
assumptions and predications around what

22
00:00:51,920 --> 00:00:54,079
organizations tend to look like

23
00:00:54,079 --> 00:00:55,199
but we should acknowledge here there's a

24
00:00:55,199 --> 00:00:57,039
bias towards quote unquote normal

25
00:00:57,039 --> 00:01:00,640
organizations to allow us to do this

26
00:01:00,960 --> 00:01:03,760
so why do they want to give this talk

27
00:01:03,760 --> 00:01:04,799
this was born out of some of the

28
00:01:04,799 --> 00:01:06,400
frustrations and learnings i've had from

29
00:01:06,400 --> 00:01:08,159
working with the tech

30
00:01:08,159 --> 00:01:09,280
this means we're going to try and look

31
00:01:09,280 --> 00:01:11,840
at some of the art behind the science

32
00:01:11,840 --> 00:01:13,439
and hopefully by being here today we can

33
00:01:13,439 --> 00:01:14,080
at least

34
00:01:14,080 --> 00:01:15,600
sort of explore some of the perils and

35
00:01:15,600 --> 00:01:17,280
pitfalls

36
00:01:17,280 --> 00:01:19,280
that i've seen and you can sort of think

37
00:01:19,280 --> 00:01:20,240
about some ways that you might be able

38
00:01:20,240 --> 00:01:22,000
to address them

39
00:01:22,000 --> 00:01:23,280
in particular we're going to try to look

40
00:01:23,280 --> 00:01:26,159
at this problem in a new zealand context

41
00:01:26,159 --> 00:01:27,520
we have our own unique set of

42
00:01:27,520 --> 00:01:29,200
circumstances which have helped shape

43
00:01:29,200 --> 00:01:31,280
the way things evolved here

44
00:01:31,280 --> 00:01:33,200
and we're going to use that same context

45
00:01:33,200 --> 00:01:35,280
to help shape the conversation as well

46
00:01:35,280 --> 00:01:36,880
because a lot of the content about

47
00:01:36,880 --> 00:01:38,720
attack that's out there is aimed at cti

48
00:01:38,720 --> 00:01:39,680
teams

49
00:01:39,680 --> 00:01:41,600
which as we'll discuss you don't likely

50
00:01:41,600 --> 00:01:43,840
have access to

51
00:01:43,840 --> 00:01:46,560
so just some acronyms before i start

52
00:01:46,560 --> 00:01:47,040
attack

53
00:01:47,040 --> 00:01:48,960
is a knowledge base of adversarial

54
00:01:48,960 --> 00:01:50,960
tactics and techniques

55
00:01:50,960 --> 00:01:52,720
attack was made by some people called at

56
00:01:52,720 --> 00:01:55,280
mitre amida is a not-for-profit that

57
00:01:55,280 --> 00:01:56,640
works very closely with the us

58
00:01:56,640 --> 00:01:58,960
government

59
00:01:58,960 --> 00:02:01,600
ttp stands for tactics techniques and

60
00:02:01,600 --> 00:02:02,479
procedures

61
00:02:02,479 --> 00:02:04,560
and these represent activities that

62
00:02:04,560 --> 00:02:06,000
adversaries can conduct

63
00:02:06,000 --> 00:02:07,920
whereas an ioc stands for an indicator

64
00:02:07,920 --> 00:02:09,598
of compromise and this represents a

65
00:02:09,598 --> 00:02:11,038
digital artifact associated with

66
00:02:11,038 --> 00:02:12,160
malicious activity

67
00:02:12,160 --> 00:02:13,840
and cti of course stands for cyber

68
00:02:13,840 --> 00:02:16,319
threat intelligence

69
00:02:16,319 --> 00:02:19,520
okay so let's zoom out and start with a

70
00:02:19,520 --> 00:02:20,959
look at cti and some of the market

71
00:02:20,959 --> 00:02:24,480
forces we have in new zealand

72
00:02:24,560 --> 00:02:26,239
so i'm going to front load this by

73
00:02:26,239 --> 00:02:28,000
saying that free intelligence

74
00:02:28,000 --> 00:02:30,319
almost doesn't exist in new zealand and

75
00:02:30,319 --> 00:02:32,319
by that i mean we have near zero people

76
00:02:32,319 --> 00:02:33,040
working

77
00:02:33,040 --> 00:02:34,400
in developing or working with threat

78
00:02:34,400 --> 00:02:36,319
intelligence as a day job

79
00:02:36,319 --> 00:02:38,400
obviously we have a few organizations

80
00:02:38,400 --> 00:02:39,680
that specialize intelligence within the

81
00:02:39,680 --> 00:02:40,319
government

82
00:02:40,319 --> 00:02:44,879
we have almost no professional cti

83
00:02:44,879 --> 00:02:46,640
and that's likely because cyber maturity

84
00:02:46,640 --> 00:02:48,239
new zealand is very low

85
00:02:48,239 --> 00:02:49,519
even so even amongst cyber security

86
00:02:49,519 --> 00:02:51,040
professionals threat intelligence is

87
00:02:51,040 --> 00:02:52,640
often seen as a really dark and obscure

88
00:02:52,640 --> 00:02:55,440
art performed by people overseas

89
00:02:55,440 --> 00:02:57,200
and where we do consume intelligence in

90
00:02:57,200 --> 00:02:58,480
a commercial context at least it's

91
00:02:58,480 --> 00:03:00,319
almost entirely produced offshore as

92
00:03:00,319 --> 00:03:02,560
well

93
00:03:02,800 --> 00:03:05,840
so why might this be why is cti so hard

94
00:03:05,840 --> 00:03:07,040
to find

95
00:03:07,040 --> 00:03:08,800
uh if we're here we have like a maturity

96
00:03:08,800 --> 00:03:10,800
scale right and this is one way we can

97
00:03:10,800 --> 00:03:12,640
look at how organizations acquire new

98
00:03:12,640 --> 00:03:14,159
security technology

99
00:03:14,159 --> 00:03:15,760
threat intelligence is something pretty

100
00:03:15,760 --> 00:03:17,280
far off at the top of a ladder pretty

101
00:03:17,280 --> 00:03:18,720
much everyone

102
00:03:18,720 --> 00:03:20,080
covers off those really foundational

103
00:03:20,080 --> 00:03:22,000
steps but very few organizations seem to

104
00:03:22,000 --> 00:03:23,440
make it all the way to the top

105
00:03:23,440 --> 00:03:24,799
and subsequently through intelligence is

106
00:03:24,799 --> 00:03:26,000
seen as something that's difficult to

107
00:03:26,000 --> 00:03:27,360
consume it's expensive and it's

108
00:03:27,360 --> 00:03:29,040
difficult to quantify

109
00:03:29,040 --> 00:03:31,360
in practice all of those lower steps

110
00:03:31,360 --> 00:03:32,720
they contain their own forms of

111
00:03:32,720 --> 00:03:33,599
intelligence

112
00:03:33,599 --> 00:03:35,200
but it's being shaped and filtered to

113
00:03:35,200 --> 00:03:37,120
you by the vendor or the provider of the

114
00:03:37,120 --> 00:03:37,920
service

115
00:03:37,920 --> 00:03:39,360
and that probably makes sense if you've

116
00:03:39,360 --> 00:03:41,120
got ten seats in your org right but what

117
00:03:41,120 --> 00:03:42,640
about if you've got a thousand or five

118
00:03:42,640 --> 00:03:45,040
thousand or ten thousand

119
00:03:45,040 --> 00:03:46,879
or you know as often in the case of new

120
00:03:46,879 --> 00:03:48,720
zealand what about if some of these

121
00:03:48,720 --> 00:03:50,959
technologies or services are outsourced

122
00:03:50,959 --> 00:03:52,640
right you've got a service provider what

123
00:03:52,640 --> 00:03:53,920
do they understand about threat

124
00:03:53,920 --> 00:03:55,360
intelligence

125
00:03:55,360 --> 00:03:56,720
i don't necessarily want to suggest this

126
00:03:56,720 --> 00:03:58,159
is a problem but it does reflect the

127
00:03:58,159 --> 00:03:59,439
status quo

128
00:03:59,439 --> 00:04:01,040
and because of that we sort of answer

129
00:04:01,040 --> 00:04:03,120
the who's the whys the where's the house

130
00:04:03,120 --> 00:04:04,640
very late in the cycle by the time we

131
00:04:04,640 --> 00:04:06,480
have people who are able to understand

132
00:04:06,480 --> 00:04:07,360
those concepts

133
00:04:07,360 --> 00:04:08,799
those lower steps and the technologies

134
00:04:08,799 --> 00:04:10,400
they represent are somewhat locked into

135
00:04:10,400 --> 00:04:12,720
place

136
00:04:12,879 --> 00:04:15,439
so this is the somewhat cynical uh

137
00:04:15,439 --> 00:04:17,199
security auraboros

138
00:04:17,199 --> 00:04:18,639
you may recognize yourself somewhere in

139
00:04:18,639 --> 00:04:20,478
the cycle it begins with identifying a

140
00:04:20,478 --> 00:04:22,079
risk

141
00:04:22,079 --> 00:04:23,759
consultants or service providers start

142
00:04:23,759 --> 00:04:25,680
to whisper in your ears about a solution

143
00:04:25,680 --> 00:04:27,040
and in all likelihood you don't have any

144
00:04:27,040 --> 00:04:29,120
money then after some time

145
00:04:29,120 --> 00:04:31,440
often years you will get some budget and

146
00:04:31,440 --> 00:04:33,040
you'll acquire the technology

147
00:04:33,040 --> 00:04:34,479
almost certainly skipping over the

148
00:04:34,479 --> 00:04:36,160
people and the processes bit and you're

149
00:04:36,160 --> 00:04:37,520
going to end up feeling dissatisfied and

150
00:04:37,520 --> 00:04:39,520
starting the cycle again

151
00:04:39,520 --> 00:04:42,000
this loop exists because organizations

152
00:04:42,000 --> 00:04:43,759
grow organically

153
00:04:43,759 --> 00:04:45,600
i.t moves really fast as well so we

154
00:04:45,600 --> 00:04:47,440
don't hire enterprise architects to sort

155
00:04:47,440 --> 00:04:48,639
of design what an organization is going

156
00:04:48,639 --> 00:04:50,880
to look like in 10 years time

157
00:04:50,880 --> 00:04:52,720
if they did draw plans for the future by

158
00:04:52,720 --> 00:04:53,600
the time we were ready for them they'd

159
00:04:53,600 --> 00:04:55,040
be out of date right the technology just

160
00:04:55,040 --> 00:04:57,440
wouldn't be relevant anymore

161
00:04:57,440 --> 00:04:59,120
we also have this which is the 2020

162
00:04:59,120 --> 00:05:00,880
redux uh

163
00:05:00,880 --> 00:05:02,479
where you get ransomware some

164
00:05:02,479 --> 00:05:04,240
consultants come you get ransomware

165
00:05:04,240 --> 00:05:04,720
again

166
00:05:04,720 --> 00:05:05,840
you buy some more stuff you get

167
00:05:05,840 --> 00:05:09,440
ransomware again and so on and so forth

168
00:05:09,440 --> 00:05:11,600
so if we abstract ourselves a little bit

169
00:05:11,600 --> 00:05:12,880
higher and look down about what we've

170
00:05:12,880 --> 00:05:13,600
talked about

171
00:05:13,600 --> 00:05:14,880
we can see that new zealand doesn't

172
00:05:14,880 --> 00:05:16,560
really have any sort of sign of cyber

173
00:05:16,560 --> 00:05:18,479
self-sufficiency in a broad sense

174
00:05:18,479 --> 00:05:20,000
i'd like to say that we're roughly 10

175
00:05:20,000 --> 00:05:21,520
years behind australia

176
00:05:21,520 --> 00:05:23,039
and to try and quantify that i'd

177
00:05:23,039 --> 00:05:24,080
encourage you to look at some of the

178
00:05:24,080 --> 00:05:25,039
programs they have over

179
00:05:25,039 --> 00:05:27,919
there like jcsc or msp3 as examples of

180
00:05:27,919 --> 00:05:29,440
reasonably affordable and practical

181
00:05:29,440 --> 00:05:30,639
things that we don't have any sort of

182
00:05:30,639 --> 00:05:32,000
direct equivalency

183
00:05:32,000 --> 00:05:35,919
in new zealand so even the very largest

184
00:05:35,919 --> 00:05:37,199
businesses in new zealand and government

185
00:05:37,199 --> 00:05:38,960
departments they rely pretty heavily on

186
00:05:38,960 --> 00:05:40,160
technical expertise

187
00:05:40,160 --> 00:05:43,120
from outside this isn't just cti but

188
00:05:43,120 --> 00:05:44,320
other specialist areas like incident

189
00:05:44,320 --> 00:05:45,680
response or forensics

190
00:05:45,680 --> 00:05:48,000
so given some sort of proverbial cyber

191
00:05:48,000 --> 00:05:49,199
conflict

192
00:05:49,199 --> 00:05:50,560
or at least a situation where those sort

193
00:05:50,560 --> 00:05:52,560
of skills were suddenly and very much in

194
00:05:52,560 --> 00:05:53,840
contention globally

195
00:05:53,840 --> 00:05:55,120
new zealanders wouldn't have enough

196
00:05:55,120 --> 00:05:57,039
access to domestic talent to defend or

197
00:05:57,039 --> 00:06:00,160
respond to our own networks

198
00:06:00,160 --> 00:06:01,759
so let's take a look at some seek job

199
00:06:01,759 --> 00:06:03,840
data to try and quantify the lack of cti

200
00:06:03,840 --> 00:06:06,319
expertise onshore australia is roughly

201
00:06:06,319 --> 00:06:07,759
five times bigger than new zealand as we

202
00:06:07,759 --> 00:06:08,160
know

203
00:06:08,160 --> 00:06:09,759
in terms of population so it stands to

204
00:06:09,759 --> 00:06:11,280
reason there'd be roughly five times as

205
00:06:11,280 --> 00:06:12,960
many jobs in australia

206
00:06:12,960 --> 00:06:14,479
mentioning cti as there is in new

207
00:06:14,479 --> 00:06:16,080
zealand right

208
00:06:16,080 --> 00:06:18,240
so this is from the first of october and

209
00:06:18,240 --> 00:06:19,919
we can see that there's three jobs on

210
00:06:19,919 --> 00:06:21,360
seek it's a little bit hard to see

211
00:06:21,360 --> 00:06:24,560
uh that mentioned through intelligence

212
00:06:24,560 --> 00:06:29,120
and if we move to australia there's 72.

213
00:06:29,120 --> 00:06:31,199
so and to be fair one of those three

214
00:06:31,199 --> 00:06:32,639
jobs actually was the same job listed

215
00:06:32,639 --> 00:06:33,280
twice

216
00:06:33,280 --> 00:06:35,039
i didn't de-duplicate the australian job

217
00:06:35,039 --> 00:06:37,360
data but you kind of get the picture

218
00:06:37,360 --> 00:06:38,639
so today in new zealand there's about

219
00:06:38,639 --> 00:06:40,560
six jobs on seek that mention

220
00:06:40,560 --> 00:06:41,759
through intelligence and that's mostly

221
00:06:41,759 --> 00:06:43,520
because ncsc has got a gone on a hiring

222
00:06:43,520 --> 00:06:45,919
spree it looks like

223
00:06:45,919 --> 00:06:47,520
but at any given moment there's roughly

224
00:06:47,520 --> 00:06:49,360
10 times as many uh people

225
00:06:49,360 --> 00:06:51,840
in cti jobs in australia as there are in

226
00:06:51,840 --> 00:06:53,199
new zealand i'd make the comment that

227
00:06:53,199 --> 00:06:54,400
those australian jobs are often really

228
00:06:54,400 --> 00:06:55,520
really high paid

229
00:06:55,520 --> 00:06:56,720
and they involve working with or

230
00:06:56,720 --> 00:06:58,080
developing intelligence whereas the new

231
00:06:58,080 --> 00:07:00,840
zealand roles often just mention it in

232
00:07:00,840 --> 00:07:02,240
passing

233
00:07:02,240 --> 00:07:05,919
so we're at the very dawn uh or start of

234
00:07:05,919 --> 00:07:06,720
sort of groups

235
00:07:06,720 --> 00:07:09,120
coalescing around intelligent sharing

236
00:07:09,120 --> 00:07:10,560
unfortunately organizations that could

237
00:07:10,560 --> 00:07:12,160
probably use this the most

238
00:07:12,160 --> 00:07:13,599
they're the least likely to be doing it

239
00:07:13,599 --> 00:07:15,039
and by that i mean that they're probably

240
00:07:15,039 --> 00:07:17,120
the least mature or the least regulated

241
00:07:17,120 --> 00:07:18,720
in practice this means everyone who's

242
00:07:18,720 --> 00:07:20,560
not in fs isac

243
00:07:20,560 --> 00:07:22,479
regulated industries typically place

244
00:07:22,479 --> 00:07:23,680
more value on risk so they've been

245
00:07:23,680 --> 00:07:25,280
willing to collaborate effectively if it

246
00:07:25,280 --> 00:07:26,240
means they can reduce

247
00:07:26,240 --> 00:07:29,680
that risk the groups that we do have

248
00:07:29,680 --> 00:07:30,960
that share intelligence they mostly do

249
00:07:30,960 --> 00:07:32,400
it in unstructured ways as well

250
00:07:32,400 --> 00:07:34,080
so they're swapping around iocs rather

251
00:07:34,080 --> 00:07:35,440
than focusing on sort of the higher

252
00:07:35,440 --> 00:07:37,680
level issues or campaigns

253
00:07:37,680 --> 00:07:39,919
and there's also a code of silence so

254
00:07:39,919 --> 00:07:41,759
organizations definitely do not want to

255
00:07:41,759 --> 00:07:44,000
disclose that they've been compromised

256
00:07:44,000 --> 00:07:45,199
but they're also reluctant to say that

257
00:07:45,199 --> 00:07:48,080
they've detected and shut down something

258
00:07:48,080 --> 00:07:49,840
or even to share simple indicators so

259
00:07:49,840 --> 00:07:51,280
the people who are doing this technical

260
00:07:51,280 --> 00:07:51,840
sharing

261
00:07:51,840 --> 00:07:53,039
they're often doing it without the

262
00:07:53,039 --> 00:07:54,960
express permission of the organization

263
00:07:54,960 --> 00:07:56,639
that they work for

264
00:07:56,639 --> 00:07:57,680
and unfortunately it's not all that

265
00:07:57,680 --> 00:07:58,960
uncommon to see this information being

266
00:07:58,960 --> 00:08:00,560
handled and appropriately as well

267
00:08:00,560 --> 00:08:02,400
so we see things like misfeeds push

268
00:08:02,400 --> 00:08:03,599
style indicators

269
00:08:03,599 --> 00:08:04,960
junior analysts reaching out and

270
00:08:04,960 --> 00:08:06,639
touching adversary infrastructure or

271
00:08:06,639 --> 00:08:08,000
handling malware unsafely

272
00:08:08,000 --> 00:08:09,360
or people you know just forwarding

273
00:08:09,360 --> 00:08:11,520
malicious urls

274
00:08:11,520 --> 00:08:12,800
and one of the reasons we do this to

275
00:08:12,800 --> 00:08:13,919
each other because we actually lack

276
00:08:13,919 --> 00:08:15,120
people who are trained in how to do

277
00:08:15,120 --> 00:08:17,919
these things safely

278
00:08:18,319 --> 00:08:20,160
so in summary we can say that new

279
00:08:20,160 --> 00:08:21,599
zealand sort of lacks technical

280
00:08:21,599 --> 00:08:22,960
expertise and leadership

281
00:08:22,960 --> 00:08:24,240
because we haven't placed enough value

282
00:08:24,240 --> 00:08:26,720
on cyber security this leaves us with

283
00:08:26,720 --> 00:08:28,000
service providers and vendors filling

284
00:08:28,000 --> 00:08:29,840
the void both of whom are inherently

285
00:08:29,840 --> 00:08:30,639
partisan

286
00:08:30,639 --> 00:08:33,200
this leaves us with lots of room to grow

287
00:08:33,200 --> 00:08:34,719
but what's been the biggest driver here

288
00:08:34,719 --> 00:08:36,000
hasn't actually been law reform in

289
00:08:36,000 --> 00:08:36,958
recent times

290
00:08:36,958 --> 00:08:38,159
it's been people getting shredded with

291
00:08:38,159 --> 00:08:39,919
ransomware or in the past few weeks

292
00:08:39,919 --> 00:08:41,440
getting dost and melting your border

293
00:08:41,440 --> 00:08:44,000
device or your file or your website

294
00:08:44,000 --> 00:08:45,760
so strangely enough this makes eastern

295
00:08:45,760 --> 00:08:47,600
european cyber criminals the mvps of

296
00:08:47,600 --> 00:08:51,040
security uplift in new zealand right now

297
00:08:51,040 --> 00:08:52,560
we also miss an opportunity with our new

298
00:08:52,560 --> 00:08:54,399
privacy act we can imagine how much

299
00:08:54,399 --> 00:08:55,600
stronger of a position we would have

300
00:08:55,600 --> 00:08:56,880
likely been in

301
00:08:56,880 --> 00:08:58,720
if in five or ten years time say if

302
00:08:58,720 --> 00:08:59,920
we've done what the uk did and just

303
00:08:59,920 --> 00:09:01,519
copied word for word the gdpr

304
00:09:01,519 --> 00:09:03,200
or even closer to home the australian

305
00:09:03,200 --> 00:09:07,120
notifi notifiable data breaches scheme

306
00:09:07,360 --> 00:09:09,440
okay so let's move on and have a look at

307
00:09:09,440 --> 00:09:10,560
attack in the wild

308
00:09:10,560 --> 00:09:12,800
um i'm going to do a lot of talking

309
00:09:12,800 --> 00:09:15,360
about ttps and iocs

310
00:09:15,360 --> 00:09:17,040
just a reminder ttps are things that

311
00:09:17,040 --> 00:09:18,959
adversaries do and iocs are things they

312
00:09:18,959 --> 00:09:21,600
leave behind

313
00:09:21,600 --> 00:09:23,040
so if you head over to the attack

314
00:09:23,040 --> 00:09:24,000
website this is what you're going to be

315
00:09:24,000 --> 00:09:24,800
greeted with

316
00:09:24,800 --> 00:09:26,959
it's pretty daunting there's lots of

317
00:09:26,959 --> 00:09:28,240
words lots of options

318
00:09:28,240 --> 00:09:29,839
it's actually not as bad as it looks so

319
00:09:29,839 --> 00:09:31,120
broadly if we break it down we've kind

320
00:09:31,120 --> 00:09:32,720
of got a two-dimensional matrix

321
00:09:32,720 --> 00:09:34,480
we have the higher level tactics along

322
00:09:34,480 --> 00:09:36,720
the top and we then drop down to the

323
00:09:36,720 --> 00:09:38,240
techniques associated with those tactics

324
00:09:38,240 --> 00:09:39,760
below

325
00:09:39,760 --> 00:09:41,120
and if we think back to the dark depths

326
00:09:41,120 --> 00:09:42,800
of history prior to attack

327
00:09:42,800 --> 00:09:44,240
we had something called the kill chain

328
00:09:44,240 --> 00:09:45,920
which was just a single dimension so we

329
00:09:45,920 --> 00:09:47,279
can think about attack as describing all

330
00:09:47,279 --> 00:09:48,839
the possible kill chains that could

331
00:09:48,839 --> 00:09:50,560
exist with attack

332
00:09:50,560 --> 00:09:51,920
bad guys move from left to right

333
00:09:51,920 --> 00:09:53,279
starting with initial access and then

334
00:09:53,279 --> 00:09:54,560
moving all the way through to

335
00:09:54,560 --> 00:09:57,200
impact but it's worth noting that the

336
00:09:57,200 --> 00:09:58,399
order these steps occur

337
00:09:58,399 --> 00:10:01,360
doesn't have to be linear and they can

338
00:10:01,360 --> 00:10:02,640
people can absolutely skip steps or

339
00:10:02,640 --> 00:10:03,760
perform actions that achieve

340
00:10:03,760 --> 00:10:07,120
multiple tactics at the same time

341
00:10:07,760 --> 00:10:09,680
so a tax language is very precise when

342
00:10:09,680 --> 00:10:11,200
it says things like tactics techniques

343
00:10:11,200 --> 00:10:12,320
and procedures

344
00:10:12,320 --> 00:10:13,839
this helps us place it on the pyramid of

345
00:10:13,839 --> 00:10:15,360
pain which is hopefully something

346
00:10:15,360 --> 00:10:17,200
everyone here is familiar with

347
00:10:17,200 --> 00:10:19,040
ultimately it's a way of describing the

348
00:10:19,040 --> 00:10:20,800
difficulty of changing a given indicator

349
00:10:20,800 --> 00:10:21,839
or an observable from an

350
00:10:21,839 --> 00:10:24,079
offensive standpoint so the lower are

351
00:10:24,079 --> 00:10:24,880
you down on this

352
00:10:24,880 --> 00:10:26,720
on the pyramid the more brittle the

353
00:10:26,720 --> 00:10:28,000
detection is so the easier it is to

354
00:10:28,000 --> 00:10:29,279
change

355
00:10:29,279 --> 00:10:31,040
ttps are very difficult for adversaries

356
00:10:31,040 --> 00:10:32,959
to change it's the way they're operating

357
00:10:32,959 --> 00:10:34,640
you can't do that in the middle of a an

358
00:10:34,640 --> 00:10:36,240
intrusion so if we're able to detect

359
00:10:36,240 --> 00:10:37,680
people up the top there

360
00:10:37,680 --> 00:10:40,800
we're in a much better position

361
00:10:41,519 --> 00:10:45,200
so attack provides an abstracted view

362
00:10:45,200 --> 00:10:47,200
of offensive techniques fundamentally

363
00:10:47,200 --> 00:10:49,120
it's an intelligence driven framework

364
00:10:49,120 --> 00:10:50,959
but this may be self-evident but it's

365
00:10:50,959 --> 00:10:52,480
worth pointing out on the list that bad

366
00:10:52,480 --> 00:10:53,680
stuff doesn't automatically get

367
00:10:53,680 --> 00:10:55,120
categorized into one of those procedures

368
00:10:55,120 --> 00:10:56,000
attack has

369
00:10:56,000 --> 00:10:57,920
people retroactively apply those labels

370
00:10:57,920 --> 00:11:00,240
to behavior that they can be observed so

371
00:11:00,240 --> 00:11:03,120
because of this attack focuses on

372
00:11:03,120 --> 00:11:05,519
real-world adversary techniques

373
00:11:05,519 --> 00:11:08,480
there's no concept of of theoreticals in

374
00:11:08,480 --> 00:11:09,440
there

375
00:11:09,440 --> 00:11:10,720
and attack does an awesome job of

376
00:11:10,720 --> 00:11:12,480
describing badness in a vendor-agnostic

377
00:11:12,480 --> 00:11:13,920
way which is probably why it's become so

378
00:11:13,920 --> 00:11:16,319
popular

379
00:11:17,279 --> 00:11:19,279
so as you talk about using attack in

380
00:11:19,279 --> 00:11:20,720
practice

381
00:11:20,720 --> 00:11:23,279
using attack to map or validate controls

382
00:11:23,279 --> 00:11:24,720
is really awesome

383
00:11:24,720 --> 00:11:26,480
it does an excellent job of this so if

384
00:11:26,480 --> 00:11:27,839
you want to try and prove something you

385
00:11:27,839 --> 00:11:29,040
at least now have a data driven

386
00:11:29,040 --> 00:11:30,720
framework that you can do that right so

387
00:11:30,720 --> 00:11:32,959
you deploy a tool does it work something

388
00:11:32,959 --> 00:11:35,680
changed cool does it still work

389
00:11:35,680 --> 00:11:38,720
um this gets a little bit trickier when

390
00:11:38,720 --> 00:11:40,480
we're trying to use it as a defender

391
00:11:40,480 --> 00:11:42,160
because attack does a terrible job of

392
00:11:42,160 --> 00:11:44,160
explaining things like the frequency or

393
00:11:44,160 --> 00:11:45,920
likelihood of an observed technique

394
00:11:45,920 --> 00:11:47,200
or that some of them are super rare

395
00:11:47,200 --> 00:11:49,279
esoteric and something that you actually

396
00:11:49,279 --> 00:11:50,639
can't mitigate against right

397
00:11:50,639 --> 00:11:52,480
it also doesn't show you the cost

398
00:11:52,480 --> 00:11:53,920
involved in mitigating against any

399
00:11:53,920 --> 00:11:56,240
particular thing so

400
00:11:56,240 --> 00:11:57,360
we as defenders as well we don't

401
00:11:57,360 --> 00:11:59,040
necessarily get to choose the impact of

402
00:11:59,040 --> 00:12:00,000
a breach

403
00:12:00,000 --> 00:12:02,399
which is the final column in attack and

404
00:12:02,399 --> 00:12:03,279
there's some other things we're not

405
00:12:03,279 --> 00:12:04,720
necessarily able to control like you

406
00:12:04,720 --> 00:12:07,920
know the initial access methods

407
00:12:08,079 --> 00:12:10,160
so one of the interesting things about

408
00:12:10,160 --> 00:12:11,440
attack as well is that it

409
00:12:11,440 --> 00:12:13,680
um it really highlights defense in depth

410
00:12:13,680 --> 00:12:15,760
so and so how weak some of those sort of

411
00:12:15,760 --> 00:12:17,440
basic controls we might consider it

412
00:12:17,440 --> 00:12:18,480
might be

413
00:12:18,480 --> 00:12:20,079
um if we look at the picture on screen i

414
00:12:20,079 --> 00:12:21,760
appreciate it it's really small

415
00:12:21,760 --> 00:12:23,760
we can see um this is what sort of bog

416
00:12:23,760 --> 00:12:25,279
standard av and some sort of edge

417
00:12:25,279 --> 00:12:26,399
firewall would get you in kind of a

418
00:12:26,399 --> 00:12:27,920
windows environment

419
00:12:27,920 --> 00:12:30,639
um the the greens are probables and the

420
00:12:30,639 --> 00:12:31,600
yellows are sort of

421
00:12:31,600 --> 00:12:33,839
plausibles and so we can see all that

422
00:12:33,839 --> 00:12:34,959
white space would be space that would

423
00:12:34,959 --> 00:12:36,240
have no visibility that

424
00:12:36,240 --> 00:12:37,680
adversaries can move around it we would

425
00:12:37,680 --> 00:12:40,959
have no vis

426
00:12:41,040 --> 00:12:42,480
so to explain this a little bit better

427
00:12:42,480 --> 00:12:43,760
we're going to dive into a sort of

428
00:12:43,760 --> 00:12:47,600
theoretical model i've called car crash

429
00:12:48,160 --> 00:12:50,959
so here's the setup we keep responding

430
00:12:50,959 --> 00:12:52,560
to car accidents

431
00:12:52,560 --> 00:12:54,079
we don't have a common language or

432
00:12:54,079 --> 00:12:56,639
framework to describe what's happened

433
00:12:56,639 --> 00:12:58,079
so we've broken down all the various

434
00:12:58,079 --> 00:12:59,200
factors along the top into the

435
00:12:59,200 --> 00:13:00,720
individual techniques below

436
00:13:00,720 --> 00:13:02,160
how old was the driver we can actually

437
00:13:02,160 --> 00:13:03,519
figure that out by the social media they

438
00:13:03,519 --> 00:13:04,320
use

439
00:13:04,320 --> 00:13:06,160
was the driver impaired we have a test

440
00:13:06,160 --> 00:13:07,839
for fadedness

441
00:13:07,839 --> 00:13:09,680
how fast were they going well we can

442
00:13:09,680 --> 00:13:10,959
test that as well

443
00:13:10,959 --> 00:13:13,600
but unfortunately we don't have any way

444
00:13:13,600 --> 00:13:14,079
of

445
00:13:14,079 --> 00:13:15,760
sort of mitigating against what they hit

446
00:13:15,760 --> 00:13:16,800
right we can't we don't have a

447
00:13:16,800 --> 00:13:18,560
mitigation against a tree or a pole

448
00:13:18,560 --> 00:13:20,079
and we again as defenders we don't get

449
00:13:20,079 --> 00:13:23,279
to control the impact

450
00:13:23,600 --> 00:13:25,680
so let's think about where we can deploy

451
00:13:25,680 --> 00:13:27,360
our controls

452
00:13:27,360 --> 00:13:29,200
turns out we've got really excellent vis

453
00:13:29,200 --> 00:13:31,279
into facebook right we've got a proxy we

454
00:13:31,279 --> 00:13:34,800
can see everyone using facebook

455
00:13:34,800 --> 00:13:36,639
we've also got really good vis into

456
00:13:36,639 --> 00:13:38,079
people who are faded we have

457
00:13:38,079 --> 00:13:39,440
breathalyzers on every street and we're

458
00:13:39,440 --> 00:13:40,880
able to detect pretty much anyone who is

459
00:13:40,880 --> 00:13:43,519
driving drunk

460
00:13:43,680 --> 00:13:45,839
we have really good vers into people who

461
00:13:45,839 --> 00:13:47,199
are speeding we can detect

462
00:13:47,199 --> 00:13:48,240
someone who's even speeding just a

463
00:13:48,240 --> 00:13:51,199
little bit but again we don't have any

464
00:13:51,199 --> 00:13:52,880
coverage over trees and power poles we

465
00:13:52,880 --> 00:13:54,079
don't know how to mitigate against power

466
00:13:54,079 --> 00:13:55,839
poles

467
00:13:55,839 --> 00:13:57,920
and again as a defender we don't really

468
00:13:57,920 --> 00:14:00,240
get to control the impact there

469
00:14:00,240 --> 00:14:03,680
beyond our control so that goes without

470
00:14:03,680 --> 00:14:04,399
saying

471
00:14:04,399 --> 00:14:06,000
that people who use tic-tock and people

472
00:14:06,000 --> 00:14:07,360
who have a strong pinterest game

473
00:14:07,360 --> 00:14:08,639
middle-aged people

474
00:14:08,639 --> 00:14:11,199
we can't see them we don't have any

475
00:14:11,199 --> 00:14:14,399
coverage against people who

476
00:14:14,800 --> 00:14:18,880
aren't wasted and we also uh can't see

477
00:14:18,880 --> 00:14:19,839
people who are just

478
00:14:19,839 --> 00:14:21,199
not breaking the law by their driving

479
00:14:21,199 --> 00:14:23,040
within the speed limit

480
00:14:23,040 --> 00:14:26,000
so you might say who cares uh attack by

481
00:14:26,000 --> 00:14:27,440
itself doesn't make this kind of cost

482
00:14:27,440 --> 00:14:29,279
benefit analysis clear

483
00:14:29,279 --> 00:14:31,040
there's whole classes of technologies

484
00:14:31,040 --> 00:14:32,560
that we're unlikely to be able to

485
00:14:32,560 --> 00:14:33,279
influence right

486
00:14:33,279 --> 00:14:35,360
public facing applications or external

487
00:14:35,360 --> 00:14:36,959
resources you're not going to be able to

488
00:14:36,959 --> 00:14:38,639
control

489
00:14:38,639 --> 00:14:39,760
several of the techniques listed in

490
00:14:39,760 --> 00:14:41,360
attack are either unmitigatable or

491
00:14:41,360 --> 00:14:42,959
they'd be prohibitively expensive

492
00:14:42,959 --> 00:14:44,720
right supply chain compromises are a

493
00:14:44,720 --> 00:14:47,760
classic example of this

494
00:14:48,560 --> 00:14:51,680
so here we have two car drivers dave and

495
00:14:51,680 --> 00:14:52,800
karen

496
00:14:52,800 --> 00:14:54,240
dave as we can see has a strong

497
00:14:54,240 --> 00:14:56,880
pinterest game he's middle aged

498
00:14:56,880 --> 00:14:58,880
he wasn't wasted at the time he was

499
00:14:58,880 --> 00:15:01,120
driving slowly and he hit another car

500
00:15:01,120 --> 00:15:04,320
and that had a financial impact karen on

501
00:15:04,320 --> 00:15:05,680
the other hand she exclusively uses

502
00:15:05,680 --> 00:15:07,440
facebook she was pretty old

503
00:15:07,440 --> 00:15:10,000
um she was pretty faded she was

504
00:15:10,000 --> 00:15:11,040
shouldn't been driving

505
00:15:11,040 --> 00:15:12,880
and she was driving too fast as well she

506
00:15:12,880 --> 00:15:14,959
hit a pole but it also had a financial

507
00:15:14,959 --> 00:15:16,639
impact

508
00:15:16,639 --> 00:15:18,720
so both of these two crashes are the

509
00:15:18,720 --> 00:15:20,079
same in the sense that the impact is the

510
00:15:20,079 --> 00:15:21,279
same but we can see that

511
00:15:21,279 --> 00:15:22,959
the things that led up to them there's

512
00:15:22,959 --> 00:15:26,000
not a lot of overlap there

513
00:15:26,000 --> 00:15:27,519
if we remember back to the controls we

514
00:15:27,519 --> 00:15:29,519
were able to deploy at least in karen's

515
00:15:29,519 --> 00:15:30,160
case

516
00:15:30,160 --> 00:15:31,519
we had really good visibility into

517
00:15:31,519 --> 00:15:32,639
facebook and we had a really good

518
00:15:32,639 --> 00:15:34,800
visibility into people who have faded

519
00:15:34,800 --> 00:15:36,560
uh we we were able to detect people who

520
00:15:36,560 --> 00:15:37,759
were speeding we didn't have a

521
00:15:37,759 --> 00:15:39,600
mitigation against polls and financial

522
00:15:39,600 --> 00:15:40,240
was sort of

523
00:15:40,240 --> 00:15:42,000
the impact was out of scope so we would

524
00:15:42,000 --> 00:15:43,440
probably be able to see this or at least

525
00:15:43,440 --> 00:15:44,720
detect it whether we could stop it as a

526
00:15:44,720 --> 00:15:45,839
different story but we'd at least be

527
00:15:45,839 --> 00:15:46,959
able to detect this sort of thing

528
00:15:46,959 --> 00:15:48,480
happening

529
00:15:48,480 --> 00:15:50,480
dave on the other hand pretty much

530
00:15:50,480 --> 00:15:52,000
flying blind we would have been unlikely

531
00:15:52,000 --> 00:15:55,440
to have seen him

532
00:15:55,440 --> 00:15:58,320
so let's leave car crash behind let's

533
00:15:58,320 --> 00:15:59,839
talk about some of the adoption panes

534
00:15:59,839 --> 00:16:02,480
behind attack

535
00:16:02,639 --> 00:16:05,279
so where attack is adopted it's often

536
00:16:05,279 --> 00:16:06,639
adopted from the bottom up

537
00:16:06,639 --> 00:16:09,199
and this is probably due to low maturity

538
00:16:09,199 --> 00:16:10,880
so it might improve over time

539
00:16:10,880 --> 00:16:12,800
i think i've seen one government rfp

540
00:16:12,800 --> 00:16:14,000
that mentioned something like attack and

541
00:16:14,000 --> 00:16:16,160
its methodology recently

542
00:16:16,160 --> 00:16:17,040
and one of the issues with these

543
00:16:17,040 --> 00:16:18,800
bottom-up approaches is that the process

544
00:16:18,800 --> 00:16:20,480
changes they often require are locked

545
00:16:20,480 --> 00:16:22,000
behind people who make decisions as

546
00:16:22,000 --> 00:16:23,519
opposed to a top down change

547
00:16:23,519 --> 00:16:25,040
where people who make decisions that

548
00:16:25,040 --> 00:16:26,720
desire is kind of implicit

549
00:16:26,720 --> 00:16:28,480
if your boss doesn't understand cyber

550
00:16:28,480 --> 00:16:30,560
security or technical cyber security

551
00:16:30,560 --> 00:16:32,240
convincing them to adopt attack might be

552
00:16:32,240 --> 00:16:34,800
pretty hard

553
00:16:35,680 --> 00:16:37,360
and so let's look at some other reasons

554
00:16:37,360 --> 00:16:38,880
why adoptions are sort of painful of

555
00:16:38,880 --> 00:16:39,759
fraught

556
00:16:39,759 --> 00:16:41,680
attack has a deceptively low barrier to

557
00:16:41,680 --> 00:16:43,519
entry in terms of dollar cost right it's

558
00:16:43,519 --> 00:16:45,040
free

559
00:16:45,040 --> 00:16:46,320
but the cost of comprehension is

560
00:16:46,320 --> 00:16:48,800
comparatively high so comprehension is

561
00:16:48,800 --> 00:16:50,800
really tricky because we can't

562
00:16:50,800 --> 00:16:52,880
outsource or scale comprehension in the

563
00:16:52,880 --> 00:16:55,279
same way we can outsource other problems

564
00:16:55,279 --> 00:16:56,720
time is also a difficult thing to

565
00:16:56,720 --> 00:16:58,639
quantify ahead of time especially if

566
00:16:58,639 --> 00:16:59,839
you're effectively writing a business

567
00:16:59,839 --> 00:17:00,880
case and you need to provide some

568
00:17:00,880 --> 00:17:03,040
estimates right it's hard to do

569
00:17:03,040 --> 00:17:04,480
and keep in mind we're actually adopting

570
00:17:04,480 --> 00:17:06,319
a framework not a discrete piece of

571
00:17:06,319 --> 00:17:08,160
technology

572
00:17:08,160 --> 00:17:10,000
that requires some amount of constant

573
00:17:10,000 --> 00:17:11,679
feeding and watering and attack is a

574
00:17:11,679 --> 00:17:12,880
living framework right

575
00:17:12,880 --> 00:17:16,319
updated it had a big update on wednesday

576
00:17:16,799 --> 00:17:19,119
so there's literally a bajillion

577
00:17:19,119 --> 00:17:20,480
half-started assessments

578
00:17:20,480 --> 00:17:22,400
um because people can't surface their

579
00:17:22,400 --> 00:17:24,559
results back to decision makers

580
00:17:24,559 --> 00:17:25,839
this on screen is something that looks

581
00:17:25,839 --> 00:17:27,439
like the average organization's

582
00:17:27,439 --> 00:17:28,720
implementation of attack

583
00:17:28,720 --> 00:17:30,559
and i've personally seen this a few hand

584
00:17:30,559 --> 00:17:33,200
first hand a couple of times

585
00:17:33,200 --> 00:17:34,640
it's really hard to show on a digestible

586
00:17:34,640 --> 00:17:36,559
slide but understanding an

587
00:17:36,559 --> 00:17:38,400
organization's requirements

588
00:17:38,400 --> 00:17:40,320
the road map and strategy things like

589
00:17:40,320 --> 00:17:41,440
management buy-in which can all

590
00:17:41,440 --> 00:17:42,720
influence the outcome they're really

591
00:17:42,720 --> 00:17:44,160
hard to show

592
00:17:44,160 --> 00:17:45,200
and this is where those guerrilla

593
00:17:45,200 --> 00:17:46,559
adoptions we talked about they seem to

594
00:17:46,559 --> 00:17:47,600
fall down

595
00:17:47,600 --> 00:17:49,039
people start off really enthusiastic but

596
00:17:49,039 --> 00:17:51,039
they end up just fading out

597
00:17:51,039 --> 00:17:52,640
so again hopefully by being here today

598
00:17:52,640 --> 00:17:54,400
we can at least see

599
00:17:54,400 --> 00:17:55,919
and try and understand some of the

600
00:17:55,919 --> 00:17:57,520
pitfalls you might face so you can start

601
00:17:57,520 --> 00:17:58,799
thinking about a ways you might want to

602
00:17:58,799 --> 00:18:01,679
address them

603
00:18:01,679 --> 00:18:05,200
okay so let's talk about some pitfalls

604
00:18:05,280 --> 00:18:08,400
this is a true story we had a security

605
00:18:08,400 --> 00:18:09,520
manager at a large new zealand

606
00:18:09,520 --> 00:18:11,200
organization

607
00:18:11,200 --> 00:18:12,720
he probably heard about attacking a cso

608
00:18:12,720 --> 00:18:14,320
magazine i'm guessing

609
00:18:14,320 --> 00:18:16,160
and he wanted or expected mitigations

610
00:18:16,160 --> 00:18:17,600
for all of the things

611
00:18:17,600 --> 00:18:19,840
coverage across every single ttp on the

612
00:18:19,840 --> 00:18:21,360
matrix

613
00:18:21,360 --> 00:18:24,240
so why is that a bad idea you don't have

614
00:18:24,240 --> 00:18:26,240
infinite resources for a start

615
00:18:26,240 --> 00:18:28,240
as we talked about many of the attack uh

616
00:18:28,240 --> 00:18:30,559
techniques are unmitigatable effectively

617
00:18:30,559 --> 00:18:32,000
or they'd be unpalatable to try and

618
00:18:32,000 --> 00:18:34,240
mitigate so really if you went down this

619
00:18:34,240 --> 00:18:35,600
path you'd just be fooling yourself you

620
00:18:35,600 --> 00:18:36,480
could notionally

621
00:18:36,480 --> 00:18:38,799
ascribe some method to each of the the

622
00:18:38,799 --> 00:18:40,160
individual ttps

623
00:18:40,160 --> 00:18:41,600
but in reality that's just not going to

624
00:18:41,600 --> 00:18:43,840
be the case

625
00:18:43,840 --> 00:18:45,760
so let's have a look a little bit deeper

626
00:18:45,760 --> 00:18:47,200
and we'll try and cover off both sides

627
00:18:47,200 --> 00:18:48,720
of the aisle here

628
00:18:48,720 --> 00:18:51,200
we've got our tier 2 sock analyst she's

629
00:18:51,200 --> 00:18:52,640
going for a promotion

630
00:18:52,640 --> 00:18:54,880
so she's going to go to the atomic red

631
00:18:54,880 --> 00:18:56,160
team

632
00:18:56,160 --> 00:18:57,760
she's going to download the mimikatz

633
00:18:57,760 --> 00:18:59,280
test she's going to run it

634
00:18:59,280 --> 00:19:01,200
get the coffee esky and now she's

635
00:19:01,200 --> 00:19:03,360
confused

636
00:19:03,360 --> 00:19:04,880
on the offensive side we have the sort

637
00:19:04,880 --> 00:19:06,320
of desire to move on from yet another

638
00:19:06,320 --> 00:19:07,440
web app

639
00:19:07,440 --> 00:19:09,280
and we're going to do some kind of that

640
00:19:09,280 --> 00:19:10,880
cool red teaming stuff we keep hearing

641
00:19:10,880 --> 00:19:11,440
about

642
00:19:11,440 --> 00:19:12,799
so the pentest is going to take his

643
00:19:12,799 --> 00:19:14,640
pre-supplied list of in-scope targets

644
00:19:14,640 --> 00:19:18,000
snuffle up some hashes use cme and fire

645
00:19:18,000 --> 00:19:19,600
out memory cats across the entire range

646
00:19:19,600 --> 00:19:20,880
like slash 24

647
00:19:20,880 --> 00:19:22,320
and get da and then we're going to call

648
00:19:22,320 --> 00:19:24,400
it adversary simulation

649
00:19:24,400 --> 00:19:27,760
awesome so starting with the defensive

650
00:19:27,760 --> 00:19:28,559
side

651
00:19:28,559 --> 00:19:30,080
you fire off your tests and you get an

652
00:19:30,080 --> 00:19:33,919
alert like why might this be sub-optimal

653
00:19:33,919 --> 00:19:36,000
well you're testing a tool for a start

654
00:19:36,000 --> 00:19:38,000
and one that's touch disk so it's not

655
00:19:38,000 --> 00:19:39,760
staged accurately in the case of

656
00:19:39,760 --> 00:19:41,039
something like mimikats it's probably

657
00:19:41,039 --> 00:19:42,480
got a billion string matches in it right

658
00:19:42,480 --> 00:19:43,440
like it's not funny the amount of

659
00:19:43,440 --> 00:19:44,559
detection engineering that goes into

660
00:19:44,559 --> 00:19:45,280
that

661
00:19:45,280 --> 00:19:47,360
you should be assessing the technique

662
00:19:47,360 --> 00:19:48,640
not the tool

663
00:19:48,640 --> 00:19:50,000
there's a whole lot of other ways you

664
00:19:50,000 --> 00:19:51,440
can get secrets out of memory other than

665
00:19:51,440 --> 00:19:52,160
mimikats

666
00:19:52,160 --> 00:19:53,280
and most of them don't have anywhere

667
00:19:53,280 --> 00:19:54,240
near as much of that detection

668
00:19:54,240 --> 00:19:56,480
engineering put into them

669
00:19:56,480 --> 00:19:58,559
there's other questions as well so what

670
00:19:58,559 --> 00:20:00,480
percentage of your systems can you see

671
00:20:00,480 --> 00:20:01,200
this on

672
00:20:01,200 --> 00:20:02,559
you've almost certainly got some old

673
00:20:02,559 --> 00:20:04,640
crusty ones

674
00:20:04,640 --> 00:20:05,760
and when it comes to network-based

675
00:20:05,760 --> 00:20:07,760
detections it's even more difficult

676
00:20:07,760 --> 00:20:09,280
right you don't have network visibility

677
00:20:09,280 --> 00:20:10,799
everywhere that depends on what segment

678
00:20:10,799 --> 00:20:11,760
you're on

679
00:20:11,760 --> 00:20:13,600
and people who are working from home in

680
00:20:13,600 --> 00:20:14,880
the era of cover that's going to get

681
00:20:14,880 --> 00:20:17,600
worse not better

682
00:20:17,600 --> 00:20:19,600
from the offensive side this kind of

683
00:20:19,600 --> 00:20:21,360
classic pentestery behavior just isn't

684
00:20:21,360 --> 00:20:23,039
something we see bad guys do

685
00:20:23,039 --> 00:20:24,799
so are these results valid yes

686
00:20:24,799 --> 00:20:26,880
absolutely but we need to recognize them

687
00:20:26,880 --> 00:20:28,640
as a synthetic result

688
00:20:28,640 --> 00:20:30,159
when an offensive team gets the crown

689
00:20:30,159 --> 00:20:31,840
jewels they found an unbroken path

690
00:20:31,840 --> 00:20:33,600
through attack to get there

691
00:20:33,600 --> 00:20:35,600
but there's a view that that's not as

692
00:20:35,600 --> 00:20:37,200
useful necessarily as following the path

693
00:20:37,200 --> 00:20:40,720
that adversaries are likely to use

694
00:20:40,720 --> 00:20:41,919
so let's dive into that a little bit

695
00:20:41,919 --> 00:20:44,559
deeper we have a situation that's

696
00:20:44,559 --> 00:20:45,280
natural

697
00:20:45,280 --> 00:20:47,520
where red teams don't want to get caught

698
00:20:47,520 --> 00:20:48,960
but the way they often do this is by

699
00:20:48,960 --> 00:20:50,240
distorting themselves away from what

700
00:20:50,240 --> 00:20:51,840
real adversaries try and do

701
00:20:51,840 --> 00:20:53,600
we have a situation with life imitating

702
00:20:53,600 --> 00:20:55,520
art imitating life

703
00:20:55,520 --> 00:20:58,320
my own backgrounds and ir and we have a

704
00:20:58,320 --> 00:21:00,080
pretty broad consensus amongst dfir

705
00:21:00,080 --> 00:21:00,640
types

706
00:21:00,640 --> 00:21:02,720
that real bad guys look and feel very

707
00:21:02,720 --> 00:21:04,320
different to the way red teams behave

708
00:21:04,320 --> 00:21:06,720
and that's for good reason

709
00:21:06,720 --> 00:21:08,559
but there's more value probably in

710
00:21:08,559 --> 00:21:10,400
hunting say big game hunting ransomware

711
00:21:10,400 --> 00:21:11,679
operator ttps

712
00:21:11,679 --> 00:21:13,120
than there is in doing cool stuff with

713
00:21:13,120 --> 00:21:14,880
yagi antennas for lots of organizations

714
00:21:14,880 --> 00:21:16,720
right closely access operations just

715
00:21:16,720 --> 00:21:18,159
unscoped for a lot of three actors and

716
00:21:18,159 --> 00:21:20,559
especially right now tearing covert

717
00:21:20,559 --> 00:21:22,400
likewise i've seen you know weird rules

718
00:21:22,400 --> 00:21:23,679
around not blocking an endpoint

719
00:21:23,679 --> 00:21:24,480
detection

720
00:21:24,480 --> 00:21:26,640
or in extreme cases getting

721
00:21:26,640 --> 00:21:28,000
infrastructure tracked and burned ahead

722
00:21:28,000 --> 00:21:29,039
of an engagement

723
00:21:29,039 --> 00:21:30,159
which is something we're actually able

724
00:21:30,159 --> 00:21:32,159
to do for some teams uh you could go

725
00:21:32,159 --> 00:21:33,760
check out the domains that jim appleby

726
00:21:33,760 --> 00:21:35,280
is registered in new zealand

727
00:21:35,280 --> 00:21:37,039
uh especially if there's a test where

728
00:21:37,039 --> 00:21:38,400
defenders don't know it's coming right

729
00:21:38,400 --> 00:21:40,159
like this all just skews ourselves away

730
00:21:40,159 --> 00:21:42,799
from reality

731
00:21:43,600 --> 00:21:46,480
okay so what are some good uses of

732
00:21:46,480 --> 00:21:48,799
attack

733
00:21:49,760 --> 00:21:52,480
the question of coverage mapping is what

734
00:21:52,480 --> 00:21:54,159
can i see right now

735
00:21:54,159 --> 00:21:56,240
so which techniques should you check all

736
00:21:56,240 --> 00:21:57,679
of them would be a bad idea

737
00:21:57,679 --> 00:22:00,240
take an intelligent steer so take public

738
00:22:00,240 --> 00:22:01,440
reporting if you want and start with

739
00:22:01,440 --> 00:22:02,559
that

740
00:22:02,559 --> 00:22:03,919
and you can and absolutely should do

741
00:22:03,919 --> 00:22:05,440
this to us outsource provider you don't

742
00:22:05,440 --> 00:22:06,559
really need that permission to do that

743
00:22:06,559 --> 00:22:08,879
either

744
00:22:09,679 --> 00:22:11,360
or before your boss goes and buys

745
00:22:11,360 --> 00:22:13,360
something so attack is really useful in

746
00:22:13,360 --> 00:22:14,799
this pre-sale space

747
00:22:14,799 --> 00:22:16,240
if you're being wined and dined by a

748
00:22:16,240 --> 00:22:18,080
vendor you should ask them for an attack

749
00:22:18,080 --> 00:22:19,600
coverage map right sales engineers

750
00:22:19,600 --> 00:22:21,679
seriously have to do this

751
00:22:21,679 --> 00:22:22,799
and obviously there's other factors as

752
00:22:22,799 --> 00:22:24,000
well like who buys the best dinner

753
00:22:24,000 --> 00:22:25,440
what's easiest to manage

754
00:22:25,440 --> 00:22:26,880
but once you have that data you can now

755
00:22:26,880 --> 00:22:28,240
actually assess it right so does the

756
00:22:28,240 --> 00:22:29,679
product work and is it going to work in

757
00:22:29,679 --> 00:22:32,400
my environment

758
00:22:33,280 --> 00:22:34,880
so we'll talk about threat active

759
00:22:34,880 --> 00:22:37,039
mapping quickly

760
00:22:37,039 --> 00:22:38,159
the overwhelming majority of

761
00:22:38,159 --> 00:22:39,520
organizations in new zealand are

762
00:22:39,520 --> 00:22:40,480
defending against

763
00:22:40,480 --> 00:22:42,400
something rather than a sort of specific

764
00:22:42,400 --> 00:22:44,720
class of adversary

765
00:22:44,720 --> 00:22:46,320
and three actors you know they only want

766
00:22:46,320 --> 00:22:47,760
one thing but knowing which one thing

767
00:22:47,760 --> 00:22:49,919
that is is kind of the tricky part

768
00:22:49,919 --> 00:22:51,840
so given a resource constraint situation

769
00:22:51,840 --> 00:22:53,600
which is probably you

770
00:22:53,600 --> 00:22:55,600
you might be better off understanding

771
00:22:55,600 --> 00:22:56,960
what you can actually detect and then

772
00:22:56,960 --> 00:22:57,520
mapping

773
00:22:57,520 --> 00:23:01,600
new data about intrusion sets to that

774
00:23:02,000 --> 00:23:03,600
so this is one of the finer points about

775
00:23:03,600 --> 00:23:04,640
attack right we need to be really

776
00:23:04,640 --> 00:23:06,960
careful about aging out indicators

777
00:23:06,960 --> 00:23:08,640
finding and then referring to the

778
00:23:08,640 --> 00:23:10,159
published reporting is useful for a lot

779
00:23:10,159 --> 00:23:11,120
of reasons

780
00:23:11,120 --> 00:23:12,480
but we need to be cognizant of the age

781
00:23:12,480 --> 00:23:14,559
of that data the older the data is

782
00:23:14,559 --> 00:23:15,840
it's harder to make assertions about

783
00:23:15,840 --> 00:23:17,600
your organization's coverage

784
00:23:17,600 --> 00:23:20,240
um so saying you know we've found all

785
00:23:20,240 --> 00:23:20,960
these reports we're going to keep them

786
00:23:20,960 --> 00:23:21,600
in a repo

787
00:23:21,600 --> 00:23:23,039
and we can assess these techniques we're

788
00:23:23,039 --> 00:23:24,880
covered against x

789
00:23:24,880 --> 00:23:28,080
needs to be heavily caveated

790
00:23:28,559 --> 00:23:29,840
so we'll just touch quickly on the

791
00:23:29,840 --> 00:23:31,679
difference between adversaries ttps and

792
00:23:31,679 --> 00:23:33,360
iocs

793
00:23:33,360 --> 00:23:35,360
broadly adversary tradecraft evolves

794
00:23:35,360 --> 00:23:36,480
right

795
00:23:36,480 --> 00:23:38,400
so tradecraft represents what

796
00:23:38,400 --> 00:23:40,799
adversaries are doing at the moment

797
00:23:40,799 --> 00:23:41,760
obviously some things are going to

798
00:23:41,760 --> 00:23:43,440
remain useful popular forever right

799
00:23:43,440 --> 00:23:46,240
using a shell is a good example there

800
00:23:46,240 --> 00:23:47,840
but if you limit yourself to sort of

801
00:23:47,840 --> 00:23:50,000
campaign or specific intrusions

802
00:23:50,000 --> 00:23:51,520
the ttp's associated with them you can

803
00:23:51,520 --> 00:23:54,320
manage those ttps much more cleanly

804
00:23:54,320 --> 00:23:56,480
at a high level uh knowing what fancy

805
00:23:56,480 --> 00:23:58,159
bed did in 2016 is probably an

806
00:23:58,159 --> 00:23:59,360
anti-pattern to what they're doing right

807
00:23:59,360 --> 00:24:00,320
now

808
00:24:00,320 --> 00:24:02,159
and knowing what domains fancy bear used

809
00:24:02,159 --> 00:24:04,159
in 2016 isn't very useful for us

810
00:24:04,159 --> 00:24:07,760
in terms of ioc mapping either

811
00:24:08,000 --> 00:24:09,600
okay so here's how you can actually do

812
00:24:09,600 --> 00:24:11,520
this in practice

813
00:24:11,520 --> 00:24:13,440
we have here the mida attack navigator

814
00:24:13,440 --> 00:24:14,640
which is a free resource i recommend

815
00:24:14,640 --> 00:24:15,600
everyone checks it out

816
00:24:15,600 --> 00:24:16,960
and what we have on screen is some

817
00:24:16,960 --> 00:24:18,720
pre-supplied thread actor

818
00:24:18,720 --> 00:24:21,120
ttps so this is a particular group and

819
00:24:21,120 --> 00:24:22,480
this is their coverage as assessed to

820
00:24:22,480 --> 00:24:23,919
motor

821
00:24:23,919 --> 00:24:25,600
we're also able to upload what our own

822
00:24:25,600 --> 00:24:27,120
organization is able to see

823
00:24:27,120 --> 00:24:29,760
we've put our controls into navigator

824
00:24:29,760 --> 00:24:31,039
and you can actually diff the two we

825
00:24:31,039 --> 00:24:32,320
have a heat map here

826
00:24:32,320 --> 00:24:34,880
of both of the sides so this is really

827
00:24:34,880 --> 00:24:35,840
useful data it's

828
00:24:35,840 --> 00:24:37,919
visual and it's it's much more

829
00:24:37,919 --> 00:24:40,559
digestible than just a report

830
00:24:40,559 --> 00:24:43,600
so on that reporting

831
00:24:43,600 --> 00:24:44,960
there's obviously a big trend to map

832
00:24:44,960 --> 00:24:46,880
your reporting data to attack

833
00:24:46,880 --> 00:24:48,080
but if we just leave it there we're

834
00:24:48,080 --> 00:24:49,520
missing so much more of what attack

835
00:24:49,520 --> 00:24:51,440
could actually do

836
00:24:51,440 --> 00:24:53,039
attack lends itself to infographics

837
00:24:53,039 --> 00:24:55,120
really really well and if people want to

838
00:24:55,120 --> 00:24:56,720
fiddle with that data send them that

839
00:24:56,720 --> 00:24:58,080
json and the navigator link right it

840
00:24:58,080 --> 00:24:59,279
doesn't take that long to become

841
00:24:59,279 --> 00:25:01,679
familiar with it

842
00:25:01,679 --> 00:25:03,360
at the end of the day the more we can

843
00:25:03,360 --> 00:25:04,799
make this data

844
00:25:04,799 --> 00:25:07,200
digestible to decision makers the more

845
00:25:07,200 --> 00:25:08,480
effort or the more impact we're going to

846
00:25:08,480 --> 00:25:09,360
have

847
00:25:09,360 --> 00:25:10,960
people might actually patch stuff right

848
00:25:10,960 --> 00:25:13,120
so

849
00:25:13,840 --> 00:25:17,120
okay so i'd like to thank

850
00:25:17,120 --> 00:25:20,480
uh mida by the way who put out a big uh

851
00:25:20,480 --> 00:25:23,039
big change on wednesday uh almost made

852
00:25:23,039 --> 00:25:23,760
my talk

853
00:25:23,760 --> 00:25:26,240
uh quite different um and i'd like to

854
00:25:26,240 --> 00:25:27,679
thank all the people in new zealand who

855
00:25:27,679 --> 00:25:28,159
actually

856
00:25:28,159 --> 00:25:29,760
share intelligent stuff behind the

857
00:25:29,760 --> 00:25:31,679
scenes they don't normally do it for any

858
00:25:31,679 --> 00:25:32,640
sort of financial gain

859
00:25:32,640 --> 00:25:34,240
and a huge amount of this happens in

860
00:25:34,240 --> 00:25:35,760
closed groups

861
00:25:35,760 --> 00:25:37,520
for the benefit of everybody and i'd

862
00:25:37,520 --> 00:25:39,200
also like to thank chcon for putting on

863
00:25:39,200 --> 00:25:39,679
an awful

864
00:25:39,679 --> 00:25:43,840
awesome conference

865
00:25:56,559 --> 00:25:58,639
you

