1
00:00:03,360 --> 00:00:05,040
i hope everyone's having a wonderful

2
00:00:05,040 --> 00:00:06,399
morning this morning and didn't stay out

3
00:00:06,399 --> 00:00:07,600
too late last night

4
00:00:07,600 --> 00:00:09,679
i know uh hugh was in real early i think

5
00:00:09,679 --> 00:00:11,679
it was around 2am or something

6
00:00:11,679 --> 00:00:14,639
but he's here today so that's good um so

7
00:00:14,639 --> 00:00:15,280
today

8
00:00:15,280 --> 00:00:16,720
we're gonna be talking about exploring

9
00:00:16,720 --> 00:00:18,480
new zealand's internet ip space and

10
00:00:18,480 --> 00:00:19,439
style

11
00:00:19,439 --> 00:00:22,720
um and uh let's just get started um so

12
00:00:22,720 --> 00:00:24,000
uh i don't know if you guys have read

13
00:00:24,000 --> 00:00:25,279
the crimes act but it's really

14
00:00:25,279 --> 00:00:26,560
unambiguous

15
00:00:26,560 --> 00:00:29,840
uh so it says access is pretty much uh

16
00:00:29,840 --> 00:00:30,400
anything

17
00:00:30,400 --> 00:00:32,800
including communicating with or

18
00:00:32,800 --> 00:00:34,000
receiving data from

19
00:00:34,000 --> 00:00:36,480
so when you think of a port scan that's

20
00:00:36,480 --> 00:00:37,760
in no ambiguous terms

21
00:00:37,760 --> 00:00:39,920
accessing a computer and then it says if

22
00:00:39,920 --> 00:00:41,440
you access without authorization you go

23
00:00:41,440 --> 00:00:42,719
to jail

24
00:00:42,719 --> 00:00:45,760
so uh i'm not a lawyer you may

25
00:00:45,760 --> 00:00:47,680
realize um but it's probably illegal

26
00:00:47,680 --> 00:00:49,200
until case law says otherwise

27
00:00:49,200 --> 00:00:50,480
i would actually love to be caselor on

28
00:00:50,480 --> 00:00:51,600
this because i think it'd be a real fun

29
00:00:51,600 --> 00:00:52,960
case to take the court

30
00:00:52,960 --> 00:00:56,559
um but uh i would say hold off doing it

31
00:00:56,559 --> 00:00:58,239
yourself unless you talk to a lawyer

32
00:00:58,239 --> 00:01:01,440
or you're full of hubris

33
00:01:02,320 --> 00:01:06,080
uh so hello i'm hugh i'm a security

34
00:01:06,080 --> 00:01:08,799
professional i guess and yeah he doesn't

35
00:01:08,799 --> 00:01:10,159
actually have a saw arm he's just making

36
00:01:10,159 --> 00:01:10,799
fun of me

37
00:01:10,799 --> 00:01:13,200
who does no i was riding his scooter

38
00:01:13,200 --> 00:01:14,320
yesterday and

39
00:01:14,320 --> 00:01:19,040
just fell off so in contrast i'm a 196

40
00:01:19,040 --> 00:01:20,000
iq hacker

41
00:01:20,000 --> 00:01:23,119
and i annoy people on the internet uh

42
00:01:23,119 --> 00:01:25,040
i'm really humble i won the ctf last

43
00:01:25,040 --> 00:01:26,320
year but i gave my prize away

44
00:01:26,320 --> 00:01:28,479
because i you know i just want to share

45
00:01:28,479 --> 00:01:29,759
my prizes with everyone

46
00:01:29,759 --> 00:01:32,880
because of how humble i am uh and

47
00:01:32,880 --> 00:01:35,040
unrelated i broke my shoulder recently

48
00:01:35,040 --> 00:01:36,000
so if i

49
00:01:36,000 --> 00:01:37,360
need a hand around the conference just

50
00:01:37,360 --> 00:01:39,280
um come and help me out also one more

51
00:01:39,280 --> 00:01:40,640
person says oh

52
00:01:40,640 --> 00:01:42,720
go out there and break an arm it's

53
00:01:42,720 --> 00:01:45,360
really annoying

54
00:01:46,159 --> 00:01:50,399
also i'm covered in yeah

55
00:01:51,200 --> 00:01:54,320
okay cool

56
00:01:54,320 --> 00:01:56,799
uh so today we are going to be talking

57
00:01:56,799 --> 00:01:58,640
about a lot of things we're going to

58
00:01:58,640 --> 00:02:01,040
give you a quick intro over some

59
00:02:01,040 --> 00:02:02,479
internet scanners

60
00:02:02,479 --> 00:02:04,640
uh then we're going to talk about

61
00:02:04,640 --> 00:02:06,079
flaming penguin

62
00:02:06,079 --> 00:02:08,160
cool name right oh it's good it's good

63
00:02:08,160 --> 00:02:09,840
we're gonna tell you about

64
00:02:09,840 --> 00:02:12,319
why we built it uh we're gonna teach you

65
00:02:12,319 --> 00:02:13,440
uh not teach you sorry

66
00:02:13,440 --> 00:02:14,879
uh we're gonna talk about the

67
00:02:14,879 --> 00:02:16,000
architecture because it's kind of

68
00:02:16,000 --> 00:02:17,040
interesting um

69
00:02:17,040 --> 00:02:19,200
we've got some plugins we had some

70
00:02:19,200 --> 00:02:20,080
problems

71
00:02:20,080 --> 00:02:21,280
and we're gonna show you what new

72
00:02:21,280 --> 00:02:23,840
zealand looks like

73
00:02:25,599 --> 00:02:27,040
i think you're on this slide oh there's

74
00:02:27,040 --> 00:02:28,959
me we don't have our speaker notes up so

75
00:02:28,959 --> 00:02:30,080
we can't see i thought

76
00:02:30,080 --> 00:02:32,400
you remember uh yeah so uh brief history

77
00:02:32,400 --> 00:02:33,680
of some scanners um

78
00:02:33,680 --> 00:02:36,720
map is old everyone's using that um

79
00:02:36,720 --> 00:02:40,319
we've also got nessus shodan mescan

80
00:02:40,319 --> 00:02:44,160
and z map um so these are a bunch of

81
00:02:44,160 --> 00:02:45,760
scanners it's it's just going to be

82
00:02:45,760 --> 00:02:46,959
attached really we're trying to get rid

83
00:02:46,959 --> 00:02:49,200
of it i couldn't do it

84
00:02:49,200 --> 00:02:51,839
thank you

85
00:02:53,200 --> 00:02:54,800
and so yeah these were all uh

86
00:02:54,800 --> 00:02:56,959
inspirations for our little tool flaming

87
00:02:56,959 --> 00:02:58,000
penguin

88
00:02:58,000 --> 00:03:00,959
some specific inspirations were uh the

89
00:03:00,959 --> 00:03:02,159
canon.net

90
00:03:02,159 --> 00:03:04,800
um if you saw the internet census 2012

91
00:03:04,800 --> 00:03:05,360
this was

92
00:03:05,360 --> 00:03:06,959
one piece of research that i read that i

93
00:03:06,959 --> 00:03:08,800
was like damn that is the coolest thing

94
00:03:08,800 --> 00:03:10,000
i have ever seen

95
00:03:10,000 --> 00:03:11,920
um so for those who don't recall or

96
00:03:11,920 --> 00:03:13,120
possibly weren't

97
00:03:13,120 --> 00:03:15,519
uh on the internet around that time um

98
00:03:15,519 --> 00:03:16,239
someone

99
00:03:16,239 --> 00:03:18,560
basically created a botnet that used

100
00:03:18,560 --> 00:03:19,760
root root admin

101
00:03:19,760 --> 00:03:21,680
admin admin and blank passwords and

102
00:03:21,680 --> 00:03:23,680
scanned for embedded devices

103
00:03:23,680 --> 00:03:25,599
routers that kind of thing and created a

104
00:03:25,599 --> 00:03:27,440
botnet from it um so it's kind of a

105
00:03:27,440 --> 00:03:29,200
precursor to the midi bot net if you

106
00:03:29,200 --> 00:03:30,720
know that one and kind of the subsequent

107
00:03:30,720 --> 00:03:32,239
ones that came after that

108
00:03:32,239 --> 00:03:34,959
but all they used it for was performing

109
00:03:34,959 --> 00:03:36,799
a census of the internet so they built

110
00:03:36,799 --> 00:03:37,920
this botnet the

111
00:03:37,920 --> 00:03:39,120
engineering that went into it is really

112
00:03:39,120 --> 00:03:40,959
amazing if you think about

113
00:03:40,959 --> 00:03:43,360
using embedded devices and and that kind

114
00:03:43,360 --> 00:03:45,519
of thing how you pull down

115
00:03:45,519 --> 00:03:48,560
scans of the entire internet pretty much

116
00:03:48,560 --> 00:03:50,239
all the data you can collect

117
00:03:50,239 --> 00:03:52,720
so really great engineering if you

118
00:03:52,720 --> 00:03:53,599
haven't read it

119
00:03:53,599 --> 00:03:55,280
it's mirrored you can read it i

120
00:03:55,280 --> 00:03:56,640
definitely recommend it

121
00:03:56,640 --> 00:03:58,159
though of course it was an illegal.net

122
00:03:58,159 --> 00:04:01,120
but still a great inspiration

123
00:04:01,120 --> 00:04:03,200
so they produce things like this so i

124
00:04:03,200 --> 00:04:04,239
wasn't just collecting the data they

125
00:04:04,239 --> 00:04:05,439
produced graphics like this it's a

126
00:04:05,439 --> 00:04:06,959
little bit hard to see the day night

127
00:04:06,959 --> 00:04:07,360
line

128
00:04:07,360 --> 00:04:09,200
but this is showing uh average

129
00:04:09,200 --> 00:04:11,120
utilization of ip addresses

130
00:04:11,120 --> 00:04:13,200
based on whether they respond to ping

131
00:04:13,200 --> 00:04:14,720
through the day-night cycle

132
00:04:14,720 --> 00:04:16,160
and so this is an example of the kind of

133
00:04:16,160 --> 00:04:17,918
data that they could collect and kind of

134
00:04:17,918 --> 00:04:19,279
show

135
00:04:19,279 --> 00:04:21,279
whether people stayed up past the day

136
00:04:21,279 --> 00:04:22,560
night line or whether they

137
00:04:22,560 --> 00:04:25,040
didn't and all that kind of useful

138
00:04:25,040 --> 00:04:26,560
information

139
00:04:26,560 --> 00:04:28,960
another inspiration was lohan kiwifruit

140
00:04:28,960 --> 00:04:29,919
so that was built by

141
00:04:29,919 --> 00:04:32,960
middlestorm who uh works at insomnia now

142
00:04:32,960 --> 00:04:35,919
part of cybersex

143
00:04:36,320 --> 00:04:38,320
so he built the first version around

144
00:04:38,320 --> 00:04:40,479
2009 or so

145
00:04:40,479 --> 00:04:42,400
and there was python-based stored

146
00:04:42,400 --> 00:04:44,080
everything in mongodb

147
00:04:44,080 --> 00:04:47,120
uh and so one one thing about that was

148
00:04:47,120 --> 00:04:47,440
in

149
00:04:47,440 --> 00:04:49,680
contrast to showdown or something uh

150
00:04:49,680 --> 00:04:50,880
laughing gibby fruit would scan on

151
00:04:50,880 --> 00:04:52,960
demand so he would let out a gigabit of

152
00:04:52,960 --> 00:04:54,880
packets across new zealand

153
00:04:54,880 --> 00:04:56,400
and get the results back and then this

154
00:04:56,400 --> 00:04:58,639
game would be done um

155
00:04:58,639 --> 00:05:00,080
it's a little bit longer than that but

156
00:05:00,080 --> 00:05:02,080
still um eventually that

157
00:05:02,080 --> 00:05:03,520
included australia and luxembourg

158
00:05:03,520 --> 00:05:04,960
started with just new zealand uh and i

159
00:05:04,960 --> 00:05:06,479
did actually ask him many times i went

160
00:05:06,479 --> 00:05:07,840
back through my isa logs and there was

161
00:05:07,840 --> 00:05:08,960
at least five times i was like hey

162
00:05:08,960 --> 00:05:10,080
middle why don't you give me the source

163
00:05:10,080 --> 00:05:10,560
code

164
00:05:10,560 --> 00:05:11,840
he was like oh it's really easy to build

165
00:05:11,840 --> 00:05:13,680
just do it yourself he lied

166
00:05:13,680 --> 00:05:16,479
he definitely lied

167
00:05:18,000 --> 00:05:19,840
so this is what a low-hanging kiwifruit

168
00:05:19,840 --> 00:05:21,600
looked like back in the day

169
00:05:21,600 --> 00:05:22,960
i don't know if he maintains it anymore

170
00:05:22,960 --> 00:05:24,560
i certainly don't have access anymore

171
00:05:24,560 --> 00:05:27,520
maybe he doesn't trust me

172
00:05:27,520 --> 00:05:29,919
so that's where we came and decided we

173
00:05:29,919 --> 00:05:31,919
would just uh build our own

174
00:05:31,919 --> 00:05:33,919
we called it flaming penguin the name

175
00:05:33,919 --> 00:05:35,520
just came from github

176
00:05:35,520 --> 00:05:37,039
auto suggest yeah you know when you put

177
00:05:37,039 --> 00:05:38,720
in like project one then it's like how

178
00:05:38,720 --> 00:05:40,080
about something that's actually

179
00:05:40,080 --> 00:05:40,880
interesting

180
00:05:40,880 --> 00:05:42,160
that's what came up with this one and

181
00:05:42,160 --> 00:05:44,080
we've got a sweet logo which we just

182
00:05:44,080 --> 00:05:46,479
stole off the internet yesterday i mean

183
00:05:46,479 --> 00:05:48,000
uh months ago when we were doing our

184
00:05:48,000 --> 00:05:50,080
slides

185
00:05:50,080 --> 00:05:52,479
this is what it looks like we'll give it

186
00:05:52,479 --> 00:05:55,440
a little demo certainly

187
00:05:55,680 --> 00:05:57,600
um well let's start that demo right now

188
00:05:57,600 --> 00:06:00,400
um so we do have to unplug the laptop

189
00:06:00,400 --> 00:06:02,400
very briefly because uh occasionally

190
00:06:02,400 --> 00:06:03,919
people in new zealand host pornographic

191
00:06:03,919 --> 00:06:05,199
material and that kind of thing

192
00:06:05,199 --> 00:06:07,759
and uh we checked and the organizers are

193
00:06:07,759 --> 00:06:10,639
not cool with that so

194
00:06:10,639 --> 00:06:12,560
you know tell them about the tv in our

195
00:06:12,560 --> 00:06:14,560
office yeah we've got a massive tv

196
00:06:14,560 --> 00:06:19,520
in the zx office and it sometimes shows

197
00:06:19,520 --> 00:06:22,880
explicit images i guess yeah our boss

198
00:06:22,880 --> 00:06:23,840
didn't know that until

199
00:06:23,840 --> 00:06:25,280
last night when we were telling him why

200
00:06:25,280 --> 00:06:28,318
the tv's off sometimes

201
00:06:29,199 --> 00:06:31,039
okay i'm just waiting for the internet

202
00:06:31,039 --> 00:06:32,240
no internet no answer

203
00:06:32,240 --> 00:06:35,280
man okay let's uh gotta do some ssh

204
00:06:35,280 --> 00:06:37,758
tunneling

205
00:06:41,120 --> 00:06:42,240
quick tell them a story while we're

206
00:06:42,240 --> 00:06:44,479
waiting uh the story is stephen is

207
00:06:44,479 --> 00:06:45,199
logging in

208
00:06:45,199 --> 00:06:48,960
um two fa on my ssh because i'm a good

209
00:06:48,960 --> 00:06:49,280
boy

210
00:06:49,280 --> 00:06:51,919
yeah we got 2fa we're typing in the 2fa

211
00:06:51,919 --> 00:06:52,639
you can't see it

212
00:06:52,639 --> 00:06:56,240
one one one oh that's just your password

213
00:06:56,240 --> 00:06:58,639
isn't it

214
00:07:00,800 --> 00:07:03,840
right okay

215
00:07:04,720 --> 00:07:08,560
now check the material we shouldn't see

216
00:07:08,560 --> 00:07:10,400
wait for it to load oh that's juicy that

217
00:07:10,400 --> 00:07:17,599
looks all good that's juicy

218
00:07:17,599 --> 00:07:20,880
so um okay here we are okay

219
00:07:20,880 --> 00:07:23,280
we'll just wait for it to uh flick over

220
00:07:23,280 --> 00:07:24,240
and then we'll begin

221
00:07:24,240 --> 00:07:28,400
yeah to do your time for a story

222
00:07:28,400 --> 00:07:31,039
uh oh it's already working saved by the

223
00:07:31,039 --> 00:07:32,000
bill

224
00:07:32,000 --> 00:07:34,639
um so this is uh the screenshot viewer

225
00:07:34,639 --> 00:07:36,160
so of course on things like showdown

226
00:07:36,160 --> 00:07:37,280
things like low hanging heavy fruit we

227
00:07:37,280 --> 00:07:38,160
have screenshots

228
00:07:38,160 --> 00:07:39,039
uh these are some of the most

229
00:07:39,039 --> 00:07:40,880
interesting things to go through um

230
00:07:40,880 --> 00:07:42,400
sorry the mouse is a bit glitched out i

231
00:07:42,400 --> 00:07:44,000
didn't i didn't think this would happen

232
00:07:44,000 --> 00:07:46,800
um but so i was at dunstan high school i

233
00:07:46,800 --> 00:07:47,919
don't know where that is

234
00:07:47,919 --> 00:07:49,520
uh but it's somewhere oh yeah and they

235
00:07:49,520 --> 00:07:51,680
had an intranet on the internet

236
00:07:51,680 --> 00:07:53,520
yeah it's an internet there so this is

237
00:07:53,520 --> 00:07:54,879
the kind of thing you can see as you go

238
00:07:54,879 --> 00:07:55,280
through

239
00:07:55,280 --> 00:07:56,879
so uh because this is live we couldn't

240
00:07:56,879 --> 00:07:58,240
really show you anything particularly

241
00:07:58,240 --> 00:07:59,199
interesting so we have some more

242
00:07:59,199 --> 00:08:00,240
interesting stuff later

243
00:08:00,240 --> 00:08:01,919
um you may be surprised about the number

244
00:08:01,919 --> 00:08:03,919
of uh draytek routers

245
00:08:03,919 --> 00:08:06,560
in new zealand there are a lot of them

246
00:08:06,560 --> 00:08:08,000
we'll go through exactly how much

247
00:08:08,000 --> 00:08:10,639
yes so if we just go back to the main

248
00:08:10,639 --> 00:08:12,000
page we'll see that

249
00:08:12,000 --> 00:08:14,639
that thing we saw before so this is you

250
00:08:14,639 --> 00:08:16,319
can scan a particular api if you want it

251
00:08:16,319 --> 00:08:17,440
really up to date because of course

252
00:08:17,440 --> 00:08:19,280
scanning new zealand takes a long time

253
00:08:19,280 --> 00:08:21,440
um you can do still searches as well so

254
00:08:21,440 --> 00:08:22,639
let's do a search for

255
00:08:22,639 --> 00:08:24,800
all the new zealand government stuff

256
00:08:24,800 --> 00:08:26,479
that we can find

257
00:08:26,479 --> 00:08:27,680
so that i have to look at the

258
00:08:27,680 --> 00:08:30,120
documentation every time this is a

259
00:08:30,120 --> 00:08:35,599
cert.dns name with a regular expression

260
00:08:36,479 --> 00:08:40,719
okay see if it auto completes for us

261
00:08:40,719 --> 00:08:43,279
oh yeah

262
00:08:45,360 --> 00:08:47,200
and here we are so this is an example of

263
00:08:47,200 --> 00:08:48,399
using it to look at

264
00:08:48,399 --> 00:08:49,920
what things are available with a

265
00:08:49,920 --> 00:08:51,519
particular dns name

266
00:08:51,519 --> 00:08:52,959
and shows little screenshots there it

267
00:08:52,959 --> 00:08:54,880
shows us the ip address when it was last

268
00:08:54,880 --> 00:08:55,680
scanned

269
00:08:55,680 --> 00:08:57,120
and then we can click on one of these to

270
00:08:57,120 --> 00:08:59,200
see a little bit more information

271
00:08:59,200 --> 00:09:01,760
so someone icc i don't even know what

272
00:09:01,760 --> 00:09:02,640
that department is

273
00:09:02,640 --> 00:09:05,120
they have a sofas user portal open i

274
00:09:05,120 --> 00:09:07,360
guess it's in the cargo city council

275
00:09:07,360 --> 00:09:08,399
and this is an example of something they

276
00:09:08,399 --> 00:09:09,920
have publicly on the internet that we

277
00:09:09,920 --> 00:09:10,959
can find searching by

278
00:09:10,959 --> 00:09:14,320
dns so that is a little um example

279
00:09:14,320 --> 00:09:17,920
of how plugin general works

280
00:09:18,160 --> 00:09:23,839
let's jump into it sounds good

281
00:09:23,839 --> 00:09:26,640
do you want the other mouse no it's fine

282
00:09:26,640 --> 00:09:27,920
will that do

283
00:09:27,920 --> 00:09:30,640
he said the trackpad like glitches out

284
00:09:30,640 --> 00:09:32,640
and he assured me that this cable here

285
00:09:32,640 --> 00:09:33,040
would

286
00:09:33,040 --> 00:09:35,200
fix it alas i guess i need a new laptop

287
00:09:35,200 --> 00:09:38,080
you hear that boss

288
00:09:38,240 --> 00:09:40,480
um anyway so there was a demo we might

289
00:09:40,480 --> 00:09:41,760
come back to more demos

290
00:09:41,760 --> 00:09:45,839
later but yeah why don't we build this

291
00:09:47,440 --> 00:09:49,680
this one wasn't wrong a client asks us

292
00:09:49,680 --> 00:09:51,519
to build something that can scan a slash

293
00:09:51,519 --> 00:09:51,920
10.

294
00:09:51,920 --> 00:09:53,440
so if you guys have used inmet before

295
00:09:53,440 --> 00:09:55,600
for example or nessus uh

296
00:09:55,600 --> 00:09:57,839
especially in matt it it can scan a

297
00:09:57,839 --> 00:09:59,120
slash 10 easily

298
00:09:59,120 --> 00:10:00,399
but then how do you view the results

299
00:10:00,399 --> 00:10:01,440
what do you actually do with that once

300
00:10:01,440 --> 00:10:03,279
you've got the slash 10 scanned

301
00:10:03,279 --> 00:10:05,680
slash chain has some million ip

302
00:10:05,680 --> 00:10:07,279
addresses in it or something like that

303
00:10:07,279 --> 00:10:09,040
and so we needed to scan this regularly

304
00:10:09,040 --> 00:10:11,279
analyze the results uh nmap is not told

305
00:10:11,279 --> 00:10:12,399
that will you do that you need something

306
00:10:12,399 --> 00:10:13,200
else

307
00:10:13,200 --> 00:10:16,399
on top of that you have tools like uh

308
00:10:16,399 --> 00:10:18,880
nessus but uh it's not very nice i don't

309
00:10:18,880 --> 00:10:20,399
know if you guys have used nss but it's

310
00:10:20,399 --> 00:10:21,360
uh not

311
00:10:21,360 --> 00:10:23,680
not a nice tool to be using um and it's

312
00:10:23,680 --> 00:10:24,640
also cool as heck

313
00:10:24,640 --> 00:10:26,079
like uh if you have the opportunity to

314
00:10:26,079 --> 00:10:27,200
build something like this it's like a

315
00:10:27,200 --> 00:10:28,399
really fun learning experience

316
00:10:28,399 --> 00:10:30,399
yeah if i'm building it yeah basically

317
00:10:30,399 --> 00:10:32,000
we got paid to do something fun which is

318
00:10:32,000 --> 00:10:33,680
the best thing

319
00:10:33,680 --> 00:10:36,240
so what we needed for this well what we

320
00:10:36,240 --> 00:10:37,920
wanted required whatever

321
00:10:37,920 --> 00:10:40,000
uh we wanted to be able to use a bunch

322
00:10:40,000 --> 00:10:42,079
of tools from

323
00:10:42,079 --> 00:10:44,079
the internet because like hey like

324
00:10:44,079 --> 00:10:46,079
security has a lot of open source tools

325
00:10:46,079 --> 00:10:47,680
and like just cool tools that we can use

326
00:10:47,680 --> 00:10:49,600
and we want to make it so we can extend

327
00:10:49,600 --> 00:10:51,839
it we add whatever tool we want

328
00:10:51,839 --> 00:10:53,680
we want to be able to scan large

329
00:10:53,680 --> 00:10:55,040
networks we want it to be

330
00:10:55,040 --> 00:10:57,200
resilient not crashing we'll talk more

331
00:10:57,200 --> 00:10:59,519
about crashing later

332
00:10:59,519 --> 00:11:01,440
speed isn't too much of a priority so

333
00:11:01,440 --> 00:11:03,040
we'll just kick off a scan leave it and

334
00:11:03,040 --> 00:11:05,040
come back whenever we want

335
00:11:05,040 --> 00:11:07,440
and we also want a interface that we can

336
00:11:07,440 --> 00:11:10,560
see the data that we get

337
00:11:10,560 --> 00:11:13,120
so the architecture that we've got um do

338
00:11:13,120 --> 00:11:14,160
you want to counter this

339
00:11:14,160 --> 00:11:17,600
is your choice oh i don't know i'll do

340
00:11:17,600 --> 00:11:18,240
it all right

341
00:11:18,240 --> 00:11:20,720
um so it's distributed using zero mq so

342
00:11:20,720 --> 00:11:22,000
um if you think back to low hanging

343
00:11:22,000 --> 00:11:23,760
kiwifruit that uses i think uh

344
00:11:23,760 --> 00:11:25,839
a salary or rabbit enqueue with a

345
00:11:25,839 --> 00:11:27,680
similar system using zero enqueue xeromq

346
00:11:27,680 --> 00:11:30,880
very nice and so the idea behind that is

347
00:11:30,880 --> 00:11:32,480
what we really want is a system where

348
00:11:32,480 --> 00:11:33,600
things can die

349
00:11:33,600 --> 00:11:36,720
crash be hit by cosmic rays shelled and

350
00:11:36,720 --> 00:11:37,920
just we don't care about it

351
00:11:37,920 --> 00:11:41,279
you can just kill them off it uses nmap

352
00:11:41,279 --> 00:11:42,880
currently and so the reason behind that

353
00:11:42,880 --> 00:11:44,240
is it means less code to write so we

354
00:11:44,240 --> 00:11:45,920
have alternatives like mass scan which

355
00:11:45,920 --> 00:11:47,040
we have implemented

356
00:11:47,040 --> 00:11:49,200
um but when you do a big scan with mass

357
00:11:49,200 --> 00:11:51,040
scan you get very limited information

358
00:11:51,040 --> 00:11:52,720
back you get basically whether the port

359
00:11:52,720 --> 00:11:53,760
is up or down

360
00:11:53,760 --> 00:11:56,880
um for a given ip address and and port

361
00:11:56,880 --> 00:11:58,720
we really like the extra information

362
00:11:58,720 --> 00:12:00,720
email gives us and the less code we can

363
00:12:00,720 --> 00:12:02,000
write the better so that really helps

364
00:12:02,000 --> 00:12:03,440
with that

365
00:12:03,440 --> 00:12:06,320
uh as i said support from scan and then

366
00:12:06,320 --> 00:12:07,120
we store it all

367
00:12:07,120 --> 00:12:09,920
in mongodb which um i'm still not sure

368
00:12:09,920 --> 00:12:10,959
if it's a mistake

369
00:12:10,959 --> 00:12:14,560
uh that works it works most of the time

370
00:12:14,560 --> 00:12:15,360
but uh

371
00:12:15,360 --> 00:12:16,959
it's such a horrible database to work

372
00:12:16,959 --> 00:12:18,399
with it's one of those things where i'm

373
00:12:18,399 --> 00:12:18,880
like

374
00:12:18,880 --> 00:12:21,200
surely this is the ideal use case we

375
00:12:21,200 --> 00:12:22,959
implement it and it's like ah

376
00:12:22,959 --> 00:12:24,160
and every step of the way we're like

377
00:12:24,160 --> 00:12:25,279
maybe we should go back to something

378
00:12:25,279 --> 00:12:27,040
like postgres uh but uh

379
00:12:27,040 --> 00:12:28,800
here we are using mongodb and it's all

380
00:12:28,800 --> 00:12:30,639
denormalized in there we were debating

381
00:12:30,639 --> 00:12:31,440
having uh

382
00:12:31,440 --> 00:12:34,000
postgres as well as yeah yeah

383
00:12:34,000 --> 00:12:34,880
because that's of course

384
00:12:34,880 --> 00:12:36,480
as every enterprise knows the solution

385
00:12:36,480 --> 00:12:37,760
to your problems is to add more

386
00:12:37,760 --> 00:12:40,240
technology onto it

387
00:12:40,240 --> 00:12:43,440
two databases twice as good so we used

388
00:12:43,440 --> 00:12:44,639
golang for writing most of the core

389
00:12:44,639 --> 00:12:45,680
components

390
00:12:45,680 --> 00:12:47,279
for those who haven't used golang it's a

391
00:12:47,279 --> 00:12:49,120
really nice threading and

392
00:12:49,120 --> 00:12:52,720
kind of ipc so if you ever need to

393
00:12:52,720 --> 00:12:54,639
if you even need to do something where

394
00:12:54,639 --> 00:12:55,839
you're going to need threads

395
00:12:55,839 --> 00:12:58,160
i i recommend something like golang some

396
00:12:58,160 --> 00:12:59,839
people would say rust they're heathens

397
00:12:59,839 --> 00:13:01,040
don't listen to them

398
00:13:01,040 --> 00:13:02,639
um golang is definitely the language you

399
00:13:02,639 --> 00:13:04,240
want to be using but then we

400
00:13:04,240 --> 00:13:06,480
can also put plugins in any language so

401
00:13:06,480 --> 00:13:07,279
i think we've got

402
00:13:07,279 --> 00:13:09,680
some plugins and like node and some

403
00:13:09,680 --> 00:13:11,440
plugins and

404
00:13:11,440 --> 00:13:13,680
newer i guess yeah we've got some other

405
00:13:13,680 --> 00:13:15,040
plugins and that's one of the advantages

406
00:13:15,040 --> 00:13:16,639
of using something like zero and q here

407
00:13:16,639 --> 00:13:17,040
where

408
00:13:17,040 --> 00:13:19,040
the transport for sending messages is

409
00:13:19,040 --> 00:13:20,160
completely agnostic

410
00:13:20,160 --> 00:13:23,839
to the languages we use yeah cool

411
00:13:23,839 --> 00:13:26,399
here's a nice little screen diagram that

412
00:13:26,399 --> 00:13:28,000
we uh

413
00:13:28,000 --> 00:13:29,920
built uh about a month ago i think yeah

414
00:13:29,920 --> 00:13:32,240
yeah not last night

415
00:13:32,240 --> 00:13:34,320
so one of the uh things with this as

416
00:13:34,320 --> 00:13:35,360
well if we look at

417
00:13:35,360 --> 00:13:36,639
the overall architecture i think it's

418
00:13:36,639 --> 00:13:38,560
big enough to see um is that each of

419
00:13:38,560 --> 00:13:39,600
these boxes

420
00:13:39,600 --> 00:13:41,760
circles hexagons cylinders can be

421
00:13:41,760 --> 00:13:43,120
running in a different part of the world

422
00:13:43,120 --> 00:13:43,920
theoretically

423
00:13:43,920 --> 00:13:45,920
so when we talk about uh scanning the

424
00:13:45,920 --> 00:13:47,839
internet it's really nice that we could

425
00:13:47,839 --> 00:13:49,519
launch something up in the node in the

426
00:13:49,519 --> 00:13:50,160
states

427
00:13:50,160 --> 00:13:51,760
we could launch something here in site

428
00:13:51,760 --> 00:13:53,360
host we could launch something wherever

429
00:13:53,360 --> 00:13:54,000
we want

430
00:13:54,000 --> 00:13:56,000
and get a scan performed and then it all

431
00:13:56,000 --> 00:13:58,079
comes back to the centralized place

432
00:13:58,079 --> 00:13:59,680
and so that's really one of the one of

433
00:13:59,680 --> 00:14:00,959
the nice things about an architecture

434
00:14:00,959 --> 00:14:02,800
like this

435
00:14:02,800 --> 00:14:04,480
it's not super clear from this but the

436
00:14:04,480 --> 00:14:06,000
way it works is that when

437
00:14:06,000 --> 00:14:08,160
one of the nmap scanners or mass scan

438
00:14:08,160 --> 00:14:09,360
scanners find something

439
00:14:09,360 --> 00:14:10,560
they'll just send the message being like

440
00:14:10,560 --> 00:14:12,240
hey this port was open and then it's up

441
00:14:12,240 --> 00:14:14,000
to the plug-in system to decide

442
00:14:14,000 --> 00:14:16,320
hey i care about that port being open i

443
00:14:16,320 --> 00:14:18,079
care about that i pee a bit appear just

444
00:14:18,079 --> 00:14:18,959
being open

445
00:14:18,959 --> 00:14:21,279
uh and so the way you write a plugin

446
00:14:21,279 --> 00:14:22,639
with this is you just say hey i care

447
00:14:22,639 --> 00:14:24,480
about all the port 80 things or you say

448
00:14:24,480 --> 00:14:26,720
i care about all the http services

449
00:14:26,720 --> 00:14:28,000
and then those plugins just subscribe to

450
00:14:28,000 --> 00:14:30,160
those channels and they can do anything

451
00:14:30,160 --> 00:14:31,120
they want with them

452
00:14:31,120 --> 00:14:34,160
works seamlessly i like it

453
00:14:34,160 --> 00:14:36,720
so plugins we've made in map of course

454
00:14:36,720 --> 00:14:38,240
so we need to be able to

455
00:14:38,240 --> 00:14:40,480
scan things and map was kind of the

456
00:14:40,480 --> 00:14:43,760
easiest one to use and it's a good tool

457
00:14:43,760 --> 00:14:46,480
it is also kind of good because map in

458
00:14:46,480 --> 00:14:48,399
itself has a bunch of plugins so we can

459
00:14:48,399 --> 00:14:51,279
have a plugin that runs map plugins

460
00:14:51,279 --> 00:14:53,760
which we do for some things

461
00:14:53,760 --> 00:14:55,600
we've also got a screenshot of which

462
00:14:55,600 --> 00:14:57,279
you've seen in the demo so we can get

463
00:14:57,279 --> 00:14:58,959
http screenshots

464
00:14:58,959 --> 00:15:01,120
more protocols to come so like rdp and

465
00:15:01,120 --> 00:15:02,000
like vnc

466
00:15:02,000 --> 00:15:04,880
and just whatever we've also got one

467
00:15:04,880 --> 00:15:05,199
that

468
00:15:05,199 --> 00:15:07,440
checks whether there's anonymous smb

469
00:15:07,440 --> 00:15:08,399
shares

470
00:15:08,399 --> 00:15:10,880
around but that's disabled by default

471
00:15:10,880 --> 00:15:12,079
because

472
00:15:12,079 --> 00:15:14,560
i guess it refers back to that prime zac

473
00:15:14,560 --> 00:15:16,399
page

474
00:15:16,399 --> 00:15:18,480
we've got a sweet little citrix

475
00:15:18,480 --> 00:15:20,480
vulnerability detector for that uh

476
00:15:20,480 --> 00:15:22,560
sweet citrix bin yeah that was the one

477
00:15:22,560 --> 00:15:25,120
that came out back in 2020 that surely

478
00:15:25,120 --> 00:15:26,399
everyone has patch form

479
00:15:26,399 --> 00:15:28,079
but uh we will see whether that is the

480
00:15:28,079 --> 00:15:30,240
case very soon yeah

481
00:15:30,240 --> 00:15:33,040
and we've also got a tls certificate

482
00:15:33,040 --> 00:15:34,639
information retriever so we can get a

483
00:15:34,639 --> 00:15:36,720
bunch of data out of the tls

484
00:15:36,720 --> 00:15:38,639
certificates and do searches on there

485
00:15:38,639 --> 00:15:40,639
and all sorts of stuff

486
00:15:40,639 --> 00:15:42,320
so we actually we actually had another

487
00:15:42,320 --> 00:15:43,759
plugin we were working on yesterday

488
00:15:43,759 --> 00:15:45,680
afternoon which was uh that weblogic bug

489
00:15:45,680 --> 00:15:46,720
that some of you may

490
00:15:46,720 --> 00:15:48,320
be familiar with since you had to patch

491
00:15:48,320 --> 00:15:50,480
it yesterday um

492
00:15:50,480 --> 00:15:52,320
but uh it's one of those things where if

493
00:15:52,320 --> 00:15:54,720
we then talk about that plug-in here

494
00:15:54,720 --> 00:15:56,720
uh i've heard that the patch is not

495
00:15:56,720 --> 00:15:58,000
sufficient at the moment and there might

496
00:15:58,000 --> 00:15:59,040
need to be another one

497
00:15:59,040 --> 00:16:00,320
and i don't want to make anyone's lives

498
00:16:00,320 --> 00:16:03,120
harder but it does go back to the idea

499
00:16:03,120 --> 00:16:04,320
of how easy plugins

500
00:16:04,320 --> 00:16:06,160
are to write deploying one that checks

501
00:16:06,160 --> 00:16:07,440
to that weblogic bug

502
00:16:07,440 --> 00:16:10,399
is easy checking then across all of new

503
00:16:10,399 --> 00:16:11,519
zealand is easy

504
00:16:11,519 --> 00:16:12,800
and then if you were an attacker you

505
00:16:12,800 --> 00:16:14,880
would already be on

506
00:16:14,880 --> 00:16:16,639
so i think a tool like this really

507
00:16:16,639 --> 00:16:18,720
demonstrates how easy it is to go from

508
00:16:18,720 --> 00:16:19,360
well you

509
00:16:19,360 --> 00:16:21,600
put the investment in and now i have a

510
00:16:21,600 --> 00:16:22,720
botnet um

511
00:16:22,720 --> 00:16:24,800
like that really easy to transition to

512
00:16:24,800 --> 00:16:26,480
that

513
00:16:26,480 --> 00:16:28,720
so we ran into some problems during this

514
00:16:28,720 --> 00:16:30,480
little project um

515
00:16:30,480 --> 00:16:32,880
one of the first ones i guess was when

516
00:16:32,880 --> 00:16:34,959
we were doing the s b plugin i think uh

517
00:16:34,959 --> 00:16:36,639
we're using nmap to

518
00:16:36,639 --> 00:16:39,680
do the smd stuff the

519
00:16:39,680 --> 00:16:42,000
version that ships with ubuntu doesn't

520
00:16:42,000 --> 00:16:43,120
support modern

521
00:16:43,120 --> 00:16:45,680
versions of windows so we we were

522
00:16:45,680 --> 00:16:48,480
running bleeding edge map for a while

523
00:16:48,480 --> 00:16:49,839
i heard a real good joke the other day

524
00:16:49,839 --> 00:16:51,360
it's a little bit unrelated i was on an

525
00:16:51,360 --> 00:16:52,639
ifc channel

526
00:16:52,639 --> 00:16:54,959
uh uh someone said how dare you like

527
00:16:54,959 --> 00:16:56,240
remove this package

528
00:16:56,240 --> 00:16:58,399
from my distro after it hasn't been

529
00:16:58,399 --> 00:16:59,920
maintained for 11 years

530
00:16:59,920 --> 00:17:01,360
there should be a museum for pieces of

531
00:17:01,360 --> 00:17:03,120
software like this and someone said oh

532
00:17:03,120 --> 00:17:06,160
yeah that's deep being stable

533
00:17:06,400 --> 00:17:09,760
yeah pretty much um we also had like

534
00:17:09,760 --> 00:17:11,119
map crashing might because we were

535
00:17:11,119 --> 00:17:13,280
running bleeding edge who knows um

536
00:17:13,280 --> 00:17:15,199
yeah i guess map is one of those pieces

537
00:17:15,199 --> 00:17:17,119
of software where you come to rely on it

538
00:17:17,119 --> 00:17:18,799
so much that when it crashes it's really

539
00:17:18,799 --> 00:17:20,559
like what how can map crash like it's

540
00:17:20,559 --> 00:17:22,160
been developed for so many years

541
00:17:22,160 --> 00:17:23,679
uh and you expect it to be reliable and

542
00:17:23,679 --> 00:17:25,359
then it just crashes all the damn type

543
00:17:25,359 --> 00:17:27,039
yeah just all the sig faults it was real

544
00:17:27,039 --> 00:17:29,039
hard to debug and

545
00:17:29,039 --> 00:17:31,840
i guess we just let it happen yeah it's

546
00:17:31,840 --> 00:17:33,120
easy to let it crash isn't it it's part

547
00:17:33,120 --> 00:17:34,320
of the architecture it's like if it

548
00:17:34,320 --> 00:17:35,760
crashes we don't really care so we just

549
00:17:35,760 --> 00:17:37,840
started again did it happen

550
00:17:37,840 --> 00:17:40,160
and it remembers whether it has scans so

551
00:17:40,160 --> 00:17:40,880
like

552
00:17:40,880 --> 00:17:42,400
if something crashes and comes back up

553
00:17:42,400 --> 00:17:43,600
it will be like oh i haven't actually

554
00:17:43,600 --> 00:17:44,799
finished scanning that so i'll

555
00:17:44,799 --> 00:17:48,799
do it um we also

556
00:17:48,799 --> 00:17:50,160
had a bit of a problem because we're

557
00:17:50,160 --> 00:17:51,760
scanning it well we were scanning a

558
00:17:51,760 --> 00:17:53,200
flash 10 and how do we

559
00:17:53,200 --> 00:17:56,080
like tell the system to just scan it

560
00:17:56,080 --> 00:17:57,120
slash 10.

561
00:17:57,120 --> 00:17:58,799
so we actually like chunked it all up

562
00:17:58,799 --> 00:18:01,120
then made it uh smaller

563
00:18:01,120 --> 00:18:03,520
little scans that we can do because one

564
00:18:03,520 --> 00:18:05,039
thing we found was when we're scanning

565
00:18:05,039 --> 00:18:05,440
like

566
00:18:05,440 --> 00:18:07,760
a whole subnet it might be all down and

567
00:18:07,760 --> 00:18:09,440
it will just take forever

568
00:18:09,440 --> 00:18:10,799
you're better off randomizing it and

569
00:18:10,799 --> 00:18:12,559
make it a bit more efficient yeah so

570
00:18:12,559 --> 00:18:14,000
that's i guess one of the trade-offs

571
00:18:14,000 --> 00:18:15,600
um especially in contrast to something

572
00:18:15,600 --> 00:18:17,520
like mass scan where it will randomize

573
00:18:17,520 --> 00:18:18,160
ports

574
00:18:18,160 --> 00:18:20,080
um we end up being a lot less stealthy

575
00:18:20,080 --> 00:18:21,200
in our case because

576
00:18:21,200 --> 00:18:23,520
we just scanned a big chunk at one time

577
00:18:23,520 --> 00:18:25,840
um but it's also faster

578
00:18:25,840 --> 00:18:27,760
with how we have it set up so there's a

579
00:18:27,760 --> 00:18:29,120
lot of these trade-offs that you end up

580
00:18:29,120 --> 00:18:30,480
coming up against as you're developing

581
00:18:30,480 --> 00:18:30,720
it

582
00:18:30,720 --> 00:18:34,320
um one particular

583
00:18:34,320 --> 00:18:37,360
isp two degrees i guess um

584
00:18:37,360 --> 00:18:40,080
weirdly all the ports show open like

585
00:18:40,080 --> 00:18:40,480
just

586
00:18:40,480 --> 00:18:44,080
across their entire ips branch um

587
00:18:44,080 --> 00:18:45,440
if a lot of people have been running map

588
00:18:45,440 --> 00:18:46,880
scans you come across that quite often

589
00:18:46,880 --> 00:18:48,400
where you have a stateful firewall that

590
00:18:48,400 --> 00:18:50,080
just trips at the

591
00:18:50,080 --> 00:18:53,760
hair trigger and then yeah yes results

592
00:18:53,760 --> 00:18:57,039
and that that's new what do you mean by

593
00:18:57,039 --> 00:18:57,360
that

594
00:18:57,360 --> 00:18:58,880
i added that last night i mean two weeks

595
00:18:58,880 --> 00:19:00,400
ago um one of the

596
00:19:00,400 --> 00:19:01,679
real big problems we have is that when

597
00:19:01,679 --> 00:19:03,679
you have this much data uh

598
00:19:03,679 --> 00:19:05,039
if you think about the structure of it

599
00:19:05,039 --> 00:19:06,880
it's not super structured so for example

600
00:19:06,880 --> 00:19:07,679
you can say

601
00:19:07,679 --> 00:19:09,760
well an ip address has services that are

602
00:19:09,760 --> 00:19:11,039
open and there's the port numbers and

603
00:19:11,039 --> 00:19:12,320
they're either open or closed

604
00:19:12,320 --> 00:19:13,360
then you get down to well it's not

605
00:19:13,360 --> 00:19:14,480
really open or closed then you're like

606
00:19:14,480 --> 00:19:16,000
what about historical scans

607
00:19:16,000 --> 00:19:18,799
what about if the time a plug-in runs is

608
00:19:18,799 --> 00:19:19,360
different

609
00:19:19,360 --> 00:19:21,200
to the time the initial scan happened

610
00:19:21,200 --> 00:19:22,720
and you need to attach like a screenshot

611
00:19:22,720 --> 00:19:24,080
for example the screenshot technically

612
00:19:24,080 --> 00:19:26,480
wasn't taken at the time the scan was

613
00:19:26,480 --> 00:19:29,120
so do you take it and store it in a new

614
00:19:29,120 --> 00:19:31,120
record or do you put on the same record

615
00:19:31,120 --> 00:19:33,200
and so these kind of like nitty gritty

616
00:19:33,200 --> 00:19:35,280
details um i think we middle said it was

617
00:19:35,280 --> 00:19:36,880
really easy to scan for example

618
00:19:36,880 --> 00:19:38,080
he man it's really easy to do the

619
00:19:38,080 --> 00:19:40,400
initial part scripting in-map is really

620
00:19:40,400 --> 00:19:41,919
easily storing that in the database is

621
00:19:41,919 --> 00:19:42,720
really easy

622
00:19:42,720 --> 00:19:44,640
everything beyond that is progressively

623
00:19:44,640 --> 00:19:46,000
harder because the kind of data you're

624
00:19:46,000 --> 00:19:47,679
working with is so unstructured

625
00:19:47,679 --> 00:19:50,240
uh and so messy by its nature um that

626
00:19:50,240 --> 00:19:51,440
you don't have a good way to store it

627
00:19:51,440 --> 00:19:52,960
you don't have a good way to query it

628
00:19:52,960 --> 00:19:55,039
um which is what we have hoped mongodb

629
00:19:55,039 --> 00:19:56,640
would help with that hasn't

630
00:19:56,640 --> 00:19:59,120
but yeah

631
00:19:59,919 --> 00:20:01,200
let's talk about the state of new

632
00:20:01,200 --> 00:20:03,360
zealand

633
00:20:03,360 --> 00:20:06,640
don't fix me um

634
00:20:06,640 --> 00:20:08,320
there's a sad face there as we're about

635
00:20:08,320 --> 00:20:10,639
to see

636
00:20:10,720 --> 00:20:13,679
what's this this is a microtech from

637
00:20:13,679 --> 00:20:17,440
what year is that 2013 2013.

638
00:20:17,440 --> 00:20:19,360
there's um a lot of bugs in the

639
00:20:19,360 --> 00:20:20,720
microtech stuff from

640
00:20:20,720 --> 00:20:24,080
back then um also i say like shooting

641
00:20:24,080 --> 00:20:25,760
safaris aren't fun because a lot of it's

642
00:20:25,760 --> 00:20:27,520
like foreign stuff i don't care about

643
00:20:27,520 --> 00:20:29,919
but uh all this um new zealand stuff is

644
00:20:29,919 --> 00:20:31,600
super fun because it feels like oh i

645
00:20:31,600 --> 00:20:32,960
could totally build this botnet

646
00:20:32,960 --> 00:20:34,400
yeah i know i'm saying that a lot i

647
00:20:34,400 --> 00:20:35,360
haven't actually done it please don't

648
00:20:35,360 --> 00:20:37,600
arrest me

649
00:20:37,600 --> 00:20:41,520
got some draytek oh 2013 2013

650
00:20:41,520 --> 00:20:44,480
pretty old week 2016. yeah this one's

651
00:20:44,480 --> 00:20:46,400
interesting because uh that's a

652
00:20:46,400 --> 00:20:49,360
that's like an eye law um which haven't

653
00:20:49,360 --> 00:20:51,039
been known to have the best security

654
00:20:51,039 --> 00:20:52,000
and then it's also one of the things

655
00:20:52,000 --> 00:20:53,840
you're like hang on how did this even

656
00:20:53,840 --> 00:20:55,679
get on the internet like

657
00:20:55,679 --> 00:20:57,120
how badly do you have to misconfigure

658
00:20:57,120 --> 00:20:58,240
your network to get in the state in the

659
00:20:58,240 --> 00:20:59,520
first place there were quite a few of

660
00:20:59,520 --> 00:21:00,400
these weren't there

661
00:21:00,400 --> 00:21:01,840
uh there's like i think less than a

662
00:21:01,840 --> 00:21:04,080
hundred which might sound bad but it's

663
00:21:04,080 --> 00:21:06,799
actually very good

664
00:21:07,600 --> 00:21:10,000
um a lot of printers for the printers i

665
00:21:10,000 --> 00:21:11,600
especially like this one

666
00:21:11,600 --> 00:21:13,200
it says please configure a password it's

667
00:21:13,200 --> 00:21:15,679
like asking you it's like hey uh

668
00:21:15,679 --> 00:21:16,880
just so you know you might want to put a

669
00:21:16,880 --> 00:21:19,360
password on this um also i think as a

670
00:21:19,360 --> 00:21:21,360
pen tester we realize these printers

671
00:21:21,360 --> 00:21:22,880
seem not interesting until you realize

672
00:21:22,880 --> 00:21:24,000
you can shell them and pivot to the

673
00:21:24,000 --> 00:21:25,039
internal network

674
00:21:25,039 --> 00:21:27,039
or you can pull off any documents that

675
00:21:27,039 --> 00:21:28,480
have been printed that kind of thing

676
00:21:28,480 --> 00:21:30,960
all the and stuff yeah people often

677
00:21:30,960 --> 00:21:32,960
connect them to like active directory so

678
00:21:32,960 --> 00:21:33,360
um

679
00:21:33,360 --> 00:21:35,280
yeah yeah well printers are good if you

680
00:21:35,280 --> 00:21:36,799
plan to print it definitely

681
00:21:36,799 --> 00:21:37,840
it's another one of those questions

682
00:21:37,840 --> 00:21:39,280
where you're like how did they get that

683
00:21:39,280 --> 00:21:40,720
on the internet like did they plug that

684
00:21:40,720 --> 00:21:41,440
directly into

685
00:21:41,440 --> 00:21:44,080
omt like how did that happen yeah this

686
00:21:44,080 --> 00:21:45,760
one's a little fun one

687
00:21:45,760 --> 00:21:48,240
yeah so as we move into the uh i guess

688
00:21:48,240 --> 00:21:49,280
more scary stuff

689
00:21:49,280 --> 00:21:52,159
um so this is a tank gauge and alarm

690
00:21:52,159 --> 00:21:52,880
system

691
00:21:52,880 --> 00:21:54,400
um and i guess on one hand this is a

692
00:21:54,400 --> 00:21:55,919
read-only system right but

693
00:21:55,919 --> 00:21:58,159
on the other hand this is an alarm

694
00:21:58,159 --> 00:21:59,520
system this is the thing that's designed

695
00:21:59,520 --> 00:22:00,880
to tell you when it's empty when it's

696
00:22:00,880 --> 00:22:02,799
full when something's going wrong

697
00:22:02,799 --> 00:22:05,200
um here it is on the internet it's

698
00:22:05,200 --> 00:22:08,159
weirdly on the internet

699
00:22:08,480 --> 00:22:12,880
oh one oh this hundred plus it needs

700
00:22:13,679 --> 00:22:17,280
yeah so this is a truck stop in redacted

701
00:22:17,280 --> 00:22:20,159
um we have all the tank data here um i

702
00:22:20,159 --> 00:22:21,520
know this is the kind of system where i

703
00:22:21,520 --> 00:22:23,039
think if you looked into it

704
00:22:23,039 --> 00:22:24,559
you'd be like ah maybe i can do some

705
00:22:24,559 --> 00:22:26,480
stuff here um but initially it just

706
00:22:26,480 --> 00:22:27,840
gives you that visceral reaction of once

707
00:22:27,840 --> 00:22:29,120
again why is this on the internet

708
00:22:29,120 --> 00:22:30,640
yeah um i think in the case of like a

709
00:22:30,640 --> 00:22:32,080
remote truck stop we can kind of figure

710
00:22:32,080 --> 00:22:33,440
that out it's like oh they needed to

711
00:22:33,440 --> 00:22:34,960
access it somehow and they just

712
00:22:34,960 --> 00:22:36,960
put it on the internet and uh they're

713
00:22:36,960 --> 00:22:38,240
like no one would scan the internet

714
00:22:38,240 --> 00:22:41,679
would they

715
00:22:41,679 --> 00:22:43,520
this is an unnamed supermarket don't

716
00:22:43,520 --> 00:22:46,080
look too hard

717
00:22:47,120 --> 00:22:48,640
i didn't actually notice the background

718
00:22:48,640 --> 00:22:51,520
to start yeah

719
00:22:51,919 --> 00:22:54,400
and it turns out a lot of supermarkets

720
00:22:54,400 --> 00:22:55,200
uh have

721
00:22:55,200 --> 00:22:56,720
a lot of refrigerator systems heating

722
00:22:56,720 --> 00:22:58,960
systems and for some reason they're all

723
00:22:58,960 --> 00:23:00,880
on the internet

724
00:23:00,880 --> 00:23:02,799
uh this one i don't exactly understand

725
00:23:02,799 --> 00:23:04,960
it doesn't make sense to me but

726
00:23:04,960 --> 00:23:06,480
once again you could have a little uh

727
00:23:06,480 --> 00:23:08,720
look at those

728
00:23:08,720 --> 00:23:10,880
another little one there yeah really

729
00:23:10,880 --> 00:23:13,120
similar system

730
00:23:13,120 --> 00:23:14,799
oh what's this this is a pause system

731
00:23:14,799 --> 00:23:16,320
directly on the internet

732
00:23:16,320 --> 00:23:19,360
who are you hungry yes

733
00:23:19,360 --> 00:23:22,159
should we order a pizza i like how

734
00:23:22,159 --> 00:23:23,520
there's no authentication on it which

735
00:23:23,520 --> 00:23:25,280
kind of makes sense that like if you

736
00:23:25,280 --> 00:23:26,320
were in the store you wouldn't have

737
00:23:26,320 --> 00:23:27,200
authentication

738
00:23:27,200 --> 00:23:28,799
but it does make you wonder hang on this

739
00:23:28,799 --> 00:23:30,480
door computers are just like

740
00:23:30,480 --> 00:23:32,320
loading this thing from the internet i

741
00:23:32,320 --> 00:23:34,400
don't know um you gotta imagine this one

742
00:23:34,400 --> 00:23:36,320
did not have a risk analysis performed

743
00:23:36,320 --> 00:23:37,200
on it before

744
00:23:37,200 --> 00:23:40,320
they um threw into that oh cheesy garlic

745
00:23:40,320 --> 00:23:41,039
pizza

746
00:23:41,039 --> 00:23:45,039
simply cheese or truffle

747
00:23:45,039 --> 00:23:48,080
there were some more stuff that we were

748
00:23:48,080 --> 00:23:50,400
thinking of including but um like a lot

749
00:23:50,400 --> 00:23:52,240
of webcams like

750
00:23:52,240 --> 00:23:54,400
so many webcams a lot of webcams but i

751
00:23:54,400 --> 00:23:55,279
guess you get into

752
00:23:55,279 --> 00:23:57,360
uh privacy invasive issues at that point

753
00:23:57,360 --> 00:23:59,279
where on one hand if there's a webcam on

754
00:23:59,279 --> 00:24:00,960
the internet it's like fair game

755
00:24:00,960 --> 00:24:02,159
and on their hand you're like oh i can

756
00:24:02,159 --> 00:24:04,000
see inside that person's house maybe

757
00:24:04,000 --> 00:24:05,360
we shouldn't be looking at this there

758
00:24:05,360 --> 00:24:07,679
was that one that had the presets

759
00:24:07,679 --> 00:24:10,960
um looking in the neighbor's houses yes

760
00:24:10,960 --> 00:24:11,440
there

761
00:24:11,440 --> 00:24:13,679
had been some people who set out their

762
00:24:13,679 --> 00:24:14,960
cameras in very

763
00:24:14,960 --> 00:24:17,760
naughty ways yeah you normally don't set

764
00:24:17,760 --> 00:24:19,120
it up pointing in someone else's house

765
00:24:19,120 --> 00:24:20,559
but uh this guy did

766
00:24:20,559 --> 00:24:23,760
pretty much uh do we want more demo yes

767
00:24:23,760 --> 00:24:24,559
i think we

768
00:24:24,559 --> 00:24:26,240
have more time to go so let's do a

769
00:24:26,240 --> 00:24:28,559
little bit of demo sounds good

770
00:24:28,559 --> 00:24:31,360
so here is a sweet demo which is uh

771
00:24:31,360 --> 00:24:32,640
showing kind of

772
00:24:32,640 --> 00:24:34,640
sorry let me get my mouse working how

773
00:24:34,640 --> 00:24:36,720
the plugin system lets us do things like

774
00:24:36,720 --> 00:24:37,600
oh what's going on

775
00:24:37,600 --> 00:24:39,279
did you want this message oh no did my

776
00:24:39,279 --> 00:24:42,000
ssh die

777
00:24:42,320 --> 00:24:46,000
oh it did good

778
00:24:46,000 --> 00:24:48,240
yeah okay i'm gonna just restart this

779
00:24:48,240 --> 00:24:50,640
ssh session give me a minute

780
00:24:50,640 --> 00:24:53,919
the internet in here is not great

781
00:24:54,960 --> 00:24:56,480
um we got any more stories while we're

782
00:24:56,480 --> 00:24:59,840
doing this uh stories

783
00:24:59,840 --> 00:25:02,880
what the chicken crossed the road

784
00:25:02,880 --> 00:25:04,960
i don't think this one's very good yeah

785
00:25:04,960 --> 00:25:06,480
i don't actually have a punchline for us

786
00:25:06,480 --> 00:25:08,320
though

787
00:25:08,320 --> 00:25:10,320
um i guess we can talk about the cisco

788
00:25:10,320 --> 00:25:12,720
uh sorry uh citrix stuff for a while

789
00:25:12,720 --> 00:25:15,120
um i guess one of the interesting things

790
00:25:15,120 --> 00:25:16,000
about building this

791
00:25:16,000 --> 00:25:19,279
for me has been seeing how something

792
00:25:19,279 --> 00:25:20,799
like the citrix bug

793
00:25:20,799 --> 00:25:24,320
is just not patched for so long

794
00:25:25,840 --> 00:25:28,000
coming from pentesting i guess it's

795
00:25:28,000 --> 00:25:29,600
normal to see things unpatched

796
00:25:29,600 --> 00:25:32,080
on internal networks that happens more

797
00:25:32,080 --> 00:25:34,159
often than not i guess you'd say

798
00:25:34,159 --> 00:25:36,159
but seeing things on the internet that

799
00:25:36,159 --> 00:25:38,159
is unpatched is like

800
00:25:38,159 --> 00:25:39,440
with something this bad it's fairly

801
00:25:39,440 --> 00:25:42,080
uncommon and it's easy to think like wow

802
00:25:42,080 --> 00:25:43,279
you know most people do patch and if

803
00:25:43,279 --> 00:25:44,960
they don't patch they get on so to

804
00:25:44,960 --> 00:25:45,679
actually see

805
00:25:45,679 --> 00:25:47,760
people not patching is like uh i guess a

806
00:25:47,760 --> 00:25:49,440
really interesting wake-up call

807
00:25:49,440 --> 00:25:51,760
so uh here we are let's grab this little

808
00:25:51,760 --> 00:25:53,360
search string

809
00:25:53,360 --> 00:25:55,760
you can see it now right yeah okay get

810
00:25:55,760 --> 00:25:58,480
your mouse working

811
00:25:58,480 --> 00:26:00,480
uh people always confuse the search and

812
00:26:00,480 --> 00:26:02,240
scan on this which always is funny when

813
00:26:02,240 --> 00:26:03,360
you come back to it and see a bunch of

814
00:26:03,360 --> 00:26:03,840
scans

815
00:26:03,840 --> 00:26:05,840
so here is the list of unique ip

816
00:26:05,840 --> 00:26:07,360
addresses in new zealand that have not

817
00:26:07,360 --> 00:26:10,000
patched that citrix export yet

818
00:26:10,000 --> 00:26:11,440
we haven't censored it because i figure

819
00:26:11,440 --> 00:26:14,000
at this point if you haven't patched it

820
00:26:14,000 --> 00:26:16,240
well it's too late someone's already

821
00:26:16,240 --> 00:26:18,400
seen it these aren't magical like secret

822
00:26:18,400 --> 00:26:20,240
hacking techniques this is we just ip

823
00:26:20,240 --> 00:26:21,520
scan new zealand

824
00:26:21,520 --> 00:26:22,720
so if you do see a name in here you

825
00:26:22,720 --> 00:26:24,080
recognize and you can maybe talk to

826
00:26:24,080 --> 00:26:25,200
someone about patching that

827
00:26:25,200 --> 00:26:27,200
that would be really ideal some of the

828
00:26:27,200 --> 00:26:28,720
scan dates are from you know

829
00:26:28,720 --> 00:26:30,720
a week ago or something like that i

830
00:26:30,720 --> 00:26:33,760
think a lot of them are quite recent

831
00:26:33,760 --> 00:26:36,880
and so this is the kind of thing that we

832
00:26:36,880 --> 00:26:38,559
found when building this project and i

833
00:26:38,559 --> 00:26:40,320
think it's one of the real wake-up calls

834
00:26:40,320 --> 00:26:40,960
you know

835
00:26:40,960 --> 00:26:43,200
uh we can all go on a showdown safari

836
00:26:43,200 --> 00:26:44,960
and look at this but seeing it

837
00:26:44,960 --> 00:26:47,919
in new zealand i i don't know like for

838
00:26:47,919 --> 00:26:50,000
me it's a real

839
00:26:50,000 --> 00:26:51,679
i don't know it feels bad in a way but

840
00:26:51,679 --> 00:26:53,600
also like good that we get to see it

841
00:26:53,600 --> 00:26:54,880
there's a lot of conflicted feelings how

842
00:26:54,880 --> 00:26:55,919
do you feel about it

843
00:26:55,919 --> 00:26:58,880
i don't know like petrol yeah

844
00:26:58,880 --> 00:27:00,240
that's pretty simple

845
00:27:00,240 --> 00:27:02,159
um oh yeah the other thing we saw there

846
00:27:02,159 --> 00:27:05,760
was so many like default ias pages like

847
00:27:05,760 --> 00:27:07,520
yeah we do have a lot of default ideas i

848
00:27:07,520 --> 00:27:08,880
don't know why people just like

849
00:27:08,880 --> 00:27:12,159
load it up and just do nothing with it

850
00:27:12,159 --> 00:27:13,520
one of the last things we'll show just

851
00:27:13,520 --> 00:27:14,320
because i think we're running out of

852
00:27:14,320 --> 00:27:16,320
time is um

853
00:27:16,320 --> 00:27:18,399
what services are really common so most

854
00:27:18,399 --> 00:27:19,600
popular services

855
00:27:19,600 --> 00:27:21,840
um this might be a little bit hard to

856
00:27:21,840 --> 00:27:23,600
see but i guess i'll read it as i go

857
00:27:23,600 --> 00:27:26,960
um so to be clear this isn't this isn't

858
00:27:26,960 --> 00:27:28,720
exactly an exhaustive scan for various

859
00:27:28,720 --> 00:27:29,440
reasons

860
00:27:29,440 --> 00:27:31,840
um but we do see that nginx is really

861
00:27:31,840 --> 00:27:32,559
popular

862
00:27:32,559 --> 00:27:34,720
but straight under that one of the other

863
00:27:34,720 --> 00:27:36,799
most popular things in new zealand

864
00:27:36,799 --> 00:27:40,640
is a dratic router with over 4 000 of

865
00:27:40,640 --> 00:27:41,200
them

866
00:27:41,200 --> 00:27:43,360
accessible on the internet and i guess

867
00:27:43,360 --> 00:27:44,159
that's the kind of thing where you're

868
00:27:44,159 --> 00:27:45,919
like did some isp roll out these

869
00:27:45,919 --> 00:27:46,960
straight x

870
00:27:46,960 --> 00:27:48,559
and just like not firewall them off or

871
00:27:48,559 --> 00:27:50,080
anything um

872
00:27:50,080 --> 00:27:51,360
what else is interesting in here the

873
00:27:51,360 --> 00:27:53,120
microtech bandwidth test server

874
00:27:53,120 --> 00:27:55,440
oh yeah there are almost 3 000 instances

875
00:27:55,440 --> 00:27:56,640
of that in new zealand

876
00:27:56,640 --> 00:27:58,000
i don't know these are the kind of stats

877
00:27:58,000 --> 00:27:59,440
that i really enjoy digging into because

878
00:27:59,440 --> 00:28:00,000
it gives you

879
00:28:00,000 --> 00:28:03,039
a real good idea of um where specific

880
00:28:03,039 --> 00:28:04,240
failings are

881
00:28:04,240 --> 00:28:05,840
in new zealand i don't know so it's fun

882
00:28:05,840 --> 00:28:07,840
yeah cool is there any more stats you

883
00:28:07,840 --> 00:28:08,320
want to show

884
00:28:08,320 --> 00:28:10,399
uh no that's probably good i think our

885
00:28:10,399 --> 00:28:12,480
time's good

886
00:28:12,480 --> 00:28:16,720
let me get my mouse give you more slides

887
00:28:16,720 --> 00:28:19,520
oh yeah we do have one more we're done

888
00:28:19,520 --> 00:28:20,399
um

889
00:28:20,399 --> 00:28:22,880
i guess we are running out of time so if

890
00:28:22,880 --> 00:28:24,720
you have any questions or comments

891
00:28:24,720 --> 00:28:31,840
see us after otherwise uh thank you

892
00:28:41,760 --> 00:28:43,840
you

