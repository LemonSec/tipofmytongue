1
00:00:06,769 --> 00:00:09,950
presentation I

2
00:00:12,110 --> 00:00:15,709
behind me and Josh sokol they'll be

3
00:00:15,709 --> 00:00:17,650
talking about how to get the data out

4
00:00:17,650 --> 00:00:21,230
once you've found it gentlemen welcome

5
00:00:21,230 --> 00:00:26,270
thank you how's everybody doing it yeah

6
00:00:26,270 --> 00:00:28,849
doing good we're tired sleepy little bit

7
00:00:28,849 --> 00:00:32,809
alright cool so a new technique in data

8
00:00:32,809 --> 00:00:34,610
exfiltration and confidentiality I

9
00:00:34,610 --> 00:00:36,860
realized that's a long title when we did

10
00:00:36,860 --> 00:00:38,570
this talk out of besides Las Vegas we

11
00:00:38,570 --> 00:00:41,000
called it how to hide your porn a little

12
00:00:41,000 --> 00:00:44,180
bit shorter title not quite as the

13
00:00:44,180 --> 00:00:46,400
script over perhaps more descriptive so

14
00:00:46,400 --> 00:00:48,650
that's why all this stuff is right here

15
00:00:48,650 --> 00:00:50,480
but really what we're talking about is

16
00:00:50,480 --> 00:00:52,310
data exfiltration right how do you get

17
00:00:52,310 --> 00:00:54,800
your stuff off of the system that you've

18
00:00:54,800 --> 00:00:56,540
compromised or that's been compromised

19
00:00:56,540 --> 00:00:58,820
and get it into your hands without

20
00:00:58,820 --> 00:01:03,260
people knowing about it so uh all right

21
00:01:03,260 --> 00:01:06,710
so Who am I orlando barrera I have a

22
00:01:06,710 --> 00:01:08,210
couple of security exploits some

23
00:01:08,210 --> 00:01:09,740
vulnerabilities I'm basically a code

24
00:01:09,740 --> 00:01:12,380
monkey I work as a security analyst at

25
00:01:12,380 --> 00:01:15,549
NSS labs right now and that's about it

26
00:01:15,549 --> 00:01:19,850
and me I'm Josh sokol I presented a huge

27
00:01:19,850 --> 00:01:22,390
second last year I was the lunchtime

28
00:01:22,390 --> 00:01:25,310
keynote I'm the Austin no loss chapter

29
00:01:25,310 --> 00:01:26,960
president at least until January when I

30
00:01:26,960 --> 00:01:29,030
handed over somebody else I'm the

31
00:01:29,030 --> 00:01:30,530
co-chair of what is now the largest

32
00:01:30,530 --> 00:01:33,320
security conference in Texas it's in

33
00:01:33,320 --> 00:01:35,450
Austin it's called last con check it out

34
00:01:35,450 --> 00:01:37,820
if you haven't been I'm here because I

35
00:01:37,820 --> 00:01:39,530
like to talk about security i'm not one

36
00:01:39,530 --> 00:01:41,210
of those limelight people or whatever I

37
00:01:41,210 --> 00:01:43,070
just like to talk about things that I

38
00:01:43,070 --> 00:01:44,810
think are cool and I like to learn about

39
00:01:44,810 --> 00:01:46,340
things that I think are cool so that's

40
00:01:46,340 --> 00:01:48,500
why I'm here I'm not selling anything

41
00:01:48,500 --> 00:01:50,150
i'm not talking about my company i'm not

42
00:01:50,150 --> 00:01:51,860
doing anything like that in fact if you

43
00:01:51,860 --> 00:01:54,080
ask me which company I'm from I'm going

44
00:01:54,080 --> 00:01:56,150
to vary hesitantly tell you I don't want

45
00:01:56,150 --> 00:01:58,310
to talk about that so if you want to

46
00:01:58,310 --> 00:02:00,200
write about the talk or whatever do so

47
00:02:00,200 --> 00:02:04,220
keep my company out of it this project

48
00:02:04,220 --> 00:02:08,030
started we do these weird monthly Austin

49
00:02:08,030 --> 00:02:09,459
security professionals happy hours

50
00:02:09,459 --> 00:02:11,480
there's lots of cool people that hang

51
00:02:11,480 --> 00:02:13,010
out them and we talked about lots of

52
00:02:13,010 --> 00:02:15,230
strange things and for some reason we

53
00:02:15,230 --> 00:02:16,340
started talking about how to hide your

54
00:02:16,340 --> 00:02:19,939
porn and I got this idea that how to

55
00:02:19,939 --> 00:02:22,310
hide your porn would be a great title

56
00:02:22,310 --> 00:02:24,319
for a presentation and then I had to

57
00:02:24,319 --> 00:02:25,530
come up with something to go

58
00:02:25,530 --> 00:02:27,600
along with it I started talking to

59
00:02:27,600 --> 00:02:29,790
orlando at the austin be sized event

60
00:02:29,790 --> 00:02:32,190
which is really really fun event it's

61
00:02:32,190 --> 00:02:35,130
free it's in austin right around South

62
00:02:35,130 --> 00:02:37,200
by Southwest time and by the next

63
00:02:37,200 --> 00:02:39,569
morning Orlando had actually written was

64
00:02:39,569 --> 00:02:42,590
now the base of stego which is our tool

65
00:02:42,590 --> 00:02:44,910
this was a quote when we originally did

66
00:02:44,910 --> 00:02:47,190
this it was at besides Las Vegas thrown

67
00:02:47,190 --> 00:02:49,319
by Chris Nickerson or organized by Chris

68
00:02:49,319 --> 00:02:51,480
Nickerson and I thought it was very

69
00:02:51,480 --> 00:02:53,520
fitting right veerana is really awesome

70
00:02:53,520 --> 00:02:56,010
because it gets you your porn and by

71
00:02:56,010 --> 00:02:59,510
porn we basically mean stuff that is

72
00:02:59,510 --> 00:03:04,470
important to you yeah so what we're

73
00:03:04,470 --> 00:03:06,420
considering porn is data worth hiding

74
00:03:06,420 --> 00:03:07,680
our data that's worth protecting

75
00:03:07,680 --> 00:03:09,510
anything you want to hold on to you want

76
00:03:09,510 --> 00:03:12,360
other people have access to excellent is

77
00:03:12,360 --> 00:03:15,450
so he's going to talk about how not tied

78
00:03:15,450 --> 00:03:19,019
you're born all right so what don't you

79
00:03:19,019 --> 00:03:20,220
want to do to hide your pole and these

80
00:03:20,220 --> 00:03:23,100
are things that are semi effective may

81
00:03:23,100 --> 00:03:24,959
be completely effective below lame

82
00:03:24,959 --> 00:03:27,390
whatever right so the first thing hidden

83
00:03:27,390 --> 00:03:29,280
files and directories hidden files and

84
00:03:29,280 --> 00:03:32,280
directories was cool back in the 80s

85
00:03:32,280 --> 00:03:33,540
when you're trying to hide things from

86
00:03:33,540 --> 00:03:36,209
your parents right really all it is is

87
00:03:36,209 --> 00:03:37,890
young go into properties check the

88
00:03:37,890 --> 00:03:39,810
little inbox and then it doesn't show up

89
00:03:39,810 --> 00:03:41,850
as a directory or as a file in that

90
00:03:41,850 --> 00:03:45,329
folder right it's really good if you're

91
00:03:45,329 --> 00:03:46,440
trying to hide things from somebody

92
00:03:46,440 --> 00:03:48,630
who's not very techincal at all but one

93
00:03:48,630 --> 00:03:52,560
comes down to a hiding from say a friend

94
00:03:52,560 --> 00:03:54,600
Zack investigator or something like that

95
00:03:54,600 --> 00:03:57,870
it's useless right so the second thing

96
00:03:57,870 --> 00:04:01,290
is renaming the Fowler extension again

97
00:04:01,290 --> 00:04:03,720
if you're just trying to hide data from

98
00:04:03,720 --> 00:04:05,280
somebody who's kind of lame doesn't

99
00:04:05,280 --> 00:04:06,920
understand technical things whatever

100
00:04:06,920 --> 00:04:09,359
renaming the Fowler extension is fun

101
00:04:09,359 --> 00:04:12,060
right I change it you know from porn jpg

102
00:04:12,060 --> 00:04:13,980
to porn dot PDF and nobody knows the

103
00:04:13,980 --> 00:04:17,130
wiser right the especially if they're

104
00:04:17,130 --> 00:04:19,709
doing a search for images right but

105
00:04:19,709 --> 00:04:22,770
again kinda lame the other thing that

106
00:04:22,770 --> 00:04:24,600
you can do is the et thing right put

107
00:04:24,600 --> 00:04:26,220
with other similar files somebody goes

108
00:04:26,220 --> 00:04:27,900
they open the closet door and they have

109
00:04:27,900 --> 00:04:29,340
no idea what's there because it looks

110
00:04:29,340 --> 00:04:31,680
like everything else so if you have a

111
00:04:31,680 --> 00:04:34,500
bunch of images throw it throw it in a

112
00:04:34,500 --> 00:04:36,200
folder with a whole bunch of other image

113
00:04:36,200 --> 00:04:38,930
that kind of thing you can also bury it

114
00:04:38,930 --> 00:04:41,540
several directories down so in this case

115
00:04:41,540 --> 00:04:43,850
you know you have something you found my

116
00:04:43,850 --> 00:04:46,100
porn stash right but it's buried down in

117
00:04:46,100 --> 00:04:47,870
do not open this folder that's not cool

118
00:04:47,870 --> 00:04:49,250
why are you invading my privacy like

119
00:04:49,250 --> 00:04:53,120
this etc right so yeah guilt is

120
00:04:53,120 --> 00:04:54,320
infinitely more effective than

121
00:04:54,320 --> 00:04:56,120
encryption or obscure file names but

122
00:04:56,120 --> 00:04:57,890
really in the end this doesn't work that

123
00:04:57,890 --> 00:04:59,240
well right because somebody can just

124
00:04:59,240 --> 00:05:00,980
click click click and finally they get

125
00:05:00,980 --> 00:05:03,290
to your stuff you can place it with

126
00:05:03,290 --> 00:05:04,820
other positive and compressed format the

127
00:05:04,820 --> 00:05:07,100
idea being that if I zip it up if I put

128
00:05:07,100 --> 00:05:09,170
everything together in one archive file

129
00:05:09,170 --> 00:05:11,120
and you're doing the search on the on

130
00:05:11,120 --> 00:05:12,710
the file system you're not going to see

131
00:05:12,710 --> 00:05:14,360
the stuff in the archive file you're

132
00:05:14,360 --> 00:05:15,920
going to see the archive file and that's

133
00:05:15,920 --> 00:05:17,420
going to bypass whatever filters you're

134
00:05:17,420 --> 00:05:18,800
looking for so if you're looking for

135
00:05:18,800 --> 00:05:20,810
images it's not going to show up as an

136
00:05:20,810 --> 00:05:22,190
image just going to show up as a zip

137
00:05:22,190 --> 00:05:25,280
right again this doesn't work very well

138
00:05:25,280 --> 00:05:26,840
these days because a lot of the search

139
00:05:26,840 --> 00:05:28,670
engines a lot of the finder features of

140
00:05:28,670 --> 00:05:30,950
the operating systems can actually look

141
00:05:30,950 --> 00:05:34,280
in these archive files alternate data

142
00:05:34,280 --> 00:05:37,340
streams is actually really cool it is a

143
00:05:37,340 --> 00:05:40,580
feature of Windows and what we can see

144
00:05:40,580 --> 00:05:44,270
here is there's a file called setup act

145
00:05:44,270 --> 00:05:47,300
dot log right and what we do is we

146
00:05:47,300 --> 00:05:49,160
create an alternate data stream for this

147
00:05:49,160 --> 00:05:50,990
file well what that alternate data

148
00:05:50,990 --> 00:05:54,380
stream is is a appendage to that file

149
00:05:54,380 --> 00:05:56,930
that has some other data but when

150
00:05:56,930 --> 00:05:59,570
windows displays this file in a normal

151
00:05:59,570 --> 00:06:02,210
setting it only shows you this it only

152
00:06:02,210 --> 00:06:04,160
shows you that original one you have two

153
00:06:04,160 --> 00:06:06,290
sets of data the file name is exactly

154
00:06:06,290 --> 00:06:08,540
the same when it comes down to searching

155
00:06:08,540 --> 00:06:10,250
the file system you don't see both

156
00:06:10,250 --> 00:06:12,320
things unless if you know the right flag

157
00:06:12,320 --> 00:06:14,930
so if you use this right flag now all of

158
00:06:14,930 --> 00:06:16,190
a sudden the alternate data stream

159
00:06:16,190 --> 00:06:19,250
starts showing up and hiding it is kind

160
00:06:19,250 --> 00:06:21,230
of useless at that point so cool feature

161
00:06:21,230 --> 00:06:24,920
I don't know what this was intended for

162
00:06:24,920 --> 00:06:29,000
other than hiding stuff but it works as

163
00:06:29,000 --> 00:06:30,740
long as you don't know the flag again

164
00:06:30,740 --> 00:06:33,200
for a non technical person this would

165
00:06:33,200 --> 00:06:36,110
probably evade them this was a cool tool

166
00:06:36,110 --> 00:06:37,700
that found when I was doing research on

167
00:06:37,700 --> 00:06:40,070
this project called spam mimic this is a

168
00:06:40,070 --> 00:06:42,320
website you can go to you enter some

169
00:06:42,320 --> 00:06:44,660
text in this case my text was the

170
00:06:44,660 --> 00:06:47,390
password is prone and what happens is it

171
00:06:47,390 --> 00:06:49,490
takes that tax and it actually encodes

172
00:06:49,490 --> 00:06:52,400
it into a spam message and the spam

173
00:06:52,400 --> 00:06:53,900
message you can dig through here all you

174
00:06:53,900 --> 00:06:56,000
want you actually won't find any of

175
00:06:56,000 --> 00:06:57,650
these words in there they do a very good

176
00:06:57,650 --> 00:07:00,290
job of jumbling it up but then you can

177
00:07:00,290 --> 00:07:02,060
take the spam message send it to your

178
00:07:02,060 --> 00:07:04,700
buddy he goes he opens it up he goes to

179
00:07:04,700 --> 00:07:06,710
the decoder for this website and all of

180
00:07:06,710 --> 00:07:07,970
a sudden he gets back to your original

181
00:07:07,970 --> 00:07:09,860
message so if you're trying to evade

182
00:07:09,860 --> 00:07:12,170
things like a sysadmin or somebody who's

183
00:07:12,170 --> 00:07:13,910
monitoring your network this is actually

184
00:07:13,910 --> 00:07:15,500
a pretty good way I do it he just sees

185
00:07:15,500 --> 00:07:17,600
that spam your buddy however can

186
00:07:17,600 --> 00:07:19,280
actually take this message decrypt it

187
00:07:19,280 --> 00:07:21,620
and get the the original content that's

188
00:07:21,620 --> 00:07:24,380
there the problem again is if a system

189
00:07:24,380 --> 00:07:26,060
administrator knows to look for this

190
00:07:26,060 --> 00:07:28,190
they can go right to spam mimic and

191
00:07:28,190 --> 00:07:31,850
decode there as well hidden partitions

192
00:07:31,850 --> 00:07:33,860
this is another thing that you can do to

193
00:07:33,860 --> 00:07:37,460
hide stuff very very simply it's a

194
00:07:37,460 --> 00:07:40,100
another partition on your hard drive but

195
00:07:40,100 --> 00:07:41,240
it's something that doesn't show up

196
00:07:41,240 --> 00:07:43,100
within the file system so you can

197
00:07:43,100 --> 00:07:45,560
actually store data in there and

198
00:07:45,560 --> 00:07:47,570
somebody is just doing a normal search

199
00:07:47,570 --> 00:07:49,820
of the hard drive won't find that the

200
00:07:49,820 --> 00:07:51,980
problem here being if they actually go

201
00:07:51,980 --> 00:07:54,500
and look at partitions and how the disk

202
00:07:54,500 --> 00:07:56,480
is set up then they can find your hidden

203
00:07:56,480 --> 00:08:00,410
partitions very similarly i invisible

204
00:08:00,410 --> 00:08:02,690
partitions work pretty much the same way

205
00:08:02,690 --> 00:08:04,370
you can create a partition that's

206
00:08:04,370 --> 00:08:06,830
invisible to the operating system and

207
00:08:06,830 --> 00:08:09,050
basically you can store your data there

208
00:08:09,050 --> 00:08:11,090
again if i actually go and look at the

209
00:08:11,090 --> 00:08:13,040
partitions that are on the system then

210
00:08:13,040 --> 00:08:15,920
that day it becomes readable this is

211
00:08:15,920 --> 00:08:17,890
actually a really cool thing slack space

212
00:08:17,890 --> 00:08:21,020
when you allocate files on a hard disk

213
00:08:21,020 --> 00:08:23,990
your files take up multiple sectors so

214
00:08:23,990 --> 00:08:25,940
in this case here's our data and our

215
00:08:25,940 --> 00:08:28,220
data takes up all of these sectors the

216
00:08:28,220 --> 00:08:30,680
problem is our file is just shy of

217
00:08:30,680 --> 00:08:33,190
making it to this last sex the

218
00:08:33,190 --> 00:08:35,809
completing out this last sector so what

219
00:08:35,809 --> 00:08:38,270
we call this area between the end of the

220
00:08:38,270 --> 00:08:40,280
file and the end of that sector that's

221
00:08:40,280 --> 00:08:42,650
called slack space and what we can do is

222
00:08:42,650 --> 00:08:45,770
we can hide data in that slack space and

223
00:08:45,770 --> 00:08:48,410
what in all this slack space kind of

224
00:08:48,410 --> 00:08:50,360
adds up on your hard drive to make a

225
00:08:50,360 --> 00:08:53,360
pretty decent place to hide data again

226
00:08:53,360 --> 00:08:54,920
if you're a friend Zack investigator you

227
00:08:54,920 --> 00:08:56,300
can look for these things you can look

228
00:08:56,300 --> 00:08:57,950
for the end of the file and then look to

229
00:08:57,950 --> 00:09:00,140
see if there's data inside that slack

230
00:09:00,140 --> 00:09:00,800
space so

231
00:09:00,800 --> 00:09:02,420
it's a good way to hide it from somebody

232
00:09:02,420 --> 00:09:04,339
who's not technical but I wouldn't use

233
00:09:04,339 --> 00:09:05,990
this to hide my data from law

234
00:09:05,990 --> 00:09:09,320
enforcement for example also similarly

235
00:09:09,320 --> 00:09:12,380
you can hide data in bad blocks and by

236
00:09:12,380 --> 00:09:14,390
bad blocks you can actually label a

237
00:09:14,390 --> 00:09:16,279
block on your hard disk as being bad

238
00:09:16,279 --> 00:09:18,740
that tells the hard disk don't use this

239
00:09:18,740 --> 00:09:21,019
space on the hard drive and by labeling

240
00:09:21,019 --> 00:09:23,450
as bad now you can store your stuff in

241
00:09:23,450 --> 00:09:25,070
there and access it as soon as you flip

242
00:09:25,070 --> 00:09:27,140
the bit baton back and can use it again

243
00:09:27,140 --> 00:09:29,390
so very cool you can put stuff in there

244
00:09:29,390 --> 00:09:32,480
as well anybody else have any other

245
00:09:32,480 --> 00:09:34,940
ideas I know this is a complete list

246
00:09:34,940 --> 00:09:36,230
this was just some stuff that I was

247
00:09:36,230 --> 00:09:38,089
looking through and found and I thought

248
00:09:38,089 --> 00:09:40,490
this was a pretty decent list of things

249
00:09:40,490 --> 00:09:42,890
that are out there so let's talk about

250
00:09:42,890 --> 00:09:45,440
some stuff that works encryption right

251
00:09:45,440 --> 00:09:47,779
this is the the classic security

252
00:09:47,779 --> 00:09:49,610
practitioner example of something that

253
00:09:49,610 --> 00:09:52,880
works to hide your data the problem here

254
00:09:52,880 --> 00:09:55,310
is this the presence of encryption

255
00:09:55,310 --> 00:09:58,279
provides reasonable suspicion this was a

256
00:09:58,279 --> 00:10:00,740
guy he was at the misty InfoSec world

257
00:10:00,740 --> 00:10:02,360
conference when I was presenting out

258
00:10:02,360 --> 00:10:04,640
there in april and he's a friend Zack

259
00:10:04,640 --> 00:10:06,140
investigator he's a guy who does this

260
00:10:06,140 --> 00:10:08,390
for a living and so as a security

261
00:10:08,390 --> 00:10:09,920
practitioner as somebody who has

262
00:10:09,920 --> 00:10:11,930
something to hide maybe it's bank

263
00:10:11,930 --> 00:10:15,470
account information you know whatever if

264
00:10:15,470 --> 00:10:18,680
you have encrypting software on your

265
00:10:18,680 --> 00:10:21,140
system if you have encrypted archives on

266
00:10:21,140 --> 00:10:24,079
your system if a if a law enforcement

267
00:10:24,079 --> 00:10:26,540
official were to see that they may be

268
00:10:26,540 --> 00:10:29,720
compelled to try and get that right so

269
00:10:29,720 --> 00:10:31,730
if you're trying to hide data having

270
00:10:31,730 --> 00:10:33,440
something that encrypts the data or

271
00:10:33,440 --> 00:10:35,720
having encrypted data on the drive is

272
00:10:35,720 --> 00:10:39,860
probably a bad thing and taking that

273
00:10:39,860 --> 00:10:41,770
step further this is actually showing

274
00:10:41,770 --> 00:10:46,070
the FBI William sessions has said that

275
00:10:46,070 --> 00:10:48,740
they consider the use of encryption to

276
00:10:48,740 --> 00:10:52,550
be a threat to the federal government so

277
00:10:52,550 --> 00:10:54,529
they don't want you to use encryption

278
00:10:54,529 --> 00:10:56,060
because they know that by using

279
00:10:56,060 --> 00:10:57,769
encryption you're preventing them from

280
00:10:57,769 --> 00:11:00,350
doing their job however they want to be

281
00:11:00,350 --> 00:11:04,640
able to use encryption did you want to

282
00:11:04,640 --> 00:11:07,410
talk about this one okay

283
00:11:07,410 --> 00:11:10,190
so this is just another example here

284
00:11:10,190 --> 00:11:13,319
this is a particular case where this

285
00:11:13,319 --> 00:11:14,910
woman was brought up on charges I

286
00:11:14,910 --> 00:11:16,829
believe it had to do with a mortgage

287
00:11:16,829 --> 00:11:19,680
scam and what happened was this woman

288
00:11:19,680 --> 00:11:21,389
was actually using encrypted software

289
00:11:21,389 --> 00:11:24,360
encrypting software on her system will

290
00:11:24,360 --> 00:11:26,220
the judge Frye in this particular case

291
00:11:26,220 --> 00:11:29,250
said you have to enter your password and

292
00:11:29,250 --> 00:11:33,329
basically self incriminate because

293
00:11:33,329 --> 00:11:34,439
that's how we're going to build the case

294
00:11:34,439 --> 00:11:36,750
against you right so the judge is

295
00:11:36,750 --> 00:11:38,939
actively trying to compel this woman to

296
00:11:38,939 --> 00:11:40,889
enter a password to decrypt that archive

297
00:11:40,889 --> 00:11:43,560
and she's like no you know that that's

298
00:11:43,560 --> 00:11:46,050
my private data well it turns out that

299
00:11:46,050 --> 00:11:47,610
where the US government is concerned

300
00:11:47,610 --> 00:11:49,620
they feel like your private data is in

301
00:11:49,620 --> 00:11:51,750
private so this guy's thinking about

302
00:11:51,750 --> 00:11:54,149
something right if having an encryption

303
00:11:54,149 --> 00:11:57,329
software on my hard disk or encrypting

304
00:11:57,329 --> 00:12:00,689
archives on my hard disk compels them or

305
00:12:00,689 --> 00:12:02,160
makes them on compel me to give them

306
00:12:02,160 --> 00:12:03,990
passwords and things like that we need

307
00:12:03,990 --> 00:12:06,959
to avoid that right so in comes oh yeah

308
00:12:06,959 --> 00:12:12,449
the this is a XKCD I believe cartoon and

309
00:12:12,449 --> 00:12:13,560
this is really what ends up happening

310
00:12:13,560 --> 00:12:16,019
right in the crypto nerds imagination

311
00:12:16,019 --> 00:12:17,850
he's got this laptop it's all decked out

312
00:12:17,850 --> 00:12:20,509
he's got like this super-awesome

313
00:12:20,509 --> 00:12:24,870
encryption scheme right 400,000 96 bit

314
00:12:24,870 --> 00:12:27,180
RSA whatever right and the guy tries to

315
00:12:27,180 --> 00:12:29,550
take his information and you can crack

316
00:12:29,550 --> 00:12:31,500
it right that's the crypt under guy but

317
00:12:31,500 --> 00:12:33,300
in reality this is the government right

318
00:12:33,300 --> 00:12:34,920
they take a five dollar wrench they beat

319
00:12:34,920 --> 00:12:36,720
you over the head until you give up the

320
00:12:36,720 --> 00:12:40,189
goods right we want to prevent this so

321
00:12:40,189 --> 00:12:42,060
anybody know what's hiding in this

322
00:12:42,060 --> 00:12:44,730
picture all right that's what's hiding

323
00:12:44,730 --> 00:12:46,889
in this picture incomes steganography

324
00:12:46,889 --> 00:12:50,069
right the ability to hide data within an

325
00:12:50,069 --> 00:12:53,579
image itself so this is that same

326
00:12:53,579 --> 00:12:55,019
investigator that talked about before

327
00:12:55,019 --> 00:12:57,240
and this was that same presentation I

328
00:12:57,240 --> 00:12:59,009
went to an infosec world he said the

329
00:12:59,009 --> 00:13:01,230
cases I've lost I've been able to detect

330
00:13:01,230 --> 00:13:03,959
steganography but not break it and I

331
00:13:03,959 --> 00:13:05,850
thought dude that is a great quote for

332
00:13:05,850 --> 00:13:07,379
this presentation because that's what

333
00:13:07,379 --> 00:13:09,300
we're talking about here right if I want

334
00:13:09,300 --> 00:13:12,209
to hide data from somebody I should do

335
00:13:12,209 --> 00:13:14,309
this I should encrypt it I should stay

336
00:13:14,309 --> 00:13:17,009
to it well these guys figured it out

337
00:13:17,009 --> 00:13:19,380
before I did Ryan terror groups have

338
00:13:19,380 --> 00:13:19,830
been you

339
00:13:19,830 --> 00:13:22,920
this for a long time since 1993 they're

340
00:13:22,920 --> 00:13:24,360
basically using encryption and

341
00:13:24,360 --> 00:13:27,060
steganography to hide their data to do

342
00:13:27,060 --> 00:13:29,310
secure communications amongst each other

343
00:13:29,310 --> 00:13:33,240
right so this is an anything new did you

344
00:13:33,240 --> 00:13:35,880
want to talk about this all right so we

345
00:13:35,880 --> 00:13:38,370
started looking at it after we actually

346
00:13:38,370 --> 00:13:40,320
did our project we found some other

347
00:13:40,320 --> 00:13:42,240
applications that kind of take this

348
00:13:42,240 --> 00:13:44,580
concept the difference is all these

349
00:13:44,580 --> 00:13:45,990
applications you need to have software

350
00:13:45,990 --> 00:13:47,130
on your system or install an operating

351
00:13:47,130 --> 00:13:49,680
system and again yeah that gets back to

352
00:13:49,680 --> 00:13:51,690
that reasonable suspicion if you have

353
00:13:51,690 --> 00:13:53,820
encryption are steganography software on

354
00:13:53,820 --> 00:13:55,380
your system that provides them

355
00:13:55,380 --> 00:13:57,660
reasonable suspicion and this is a list

356
00:13:57,660 --> 00:13:58,890
of some other projects that kind of go

357
00:13:58,890 --> 00:14:01,020
along encryption steganography next

358
00:14:01,020 --> 00:14:03,360
slide yeah it definitely it's not a

359
00:14:03,360 --> 00:14:06,300
complete list so our tour it's a new

360
00:14:06,300 --> 00:14:08,250
concept for data protection exfiltration

361
00:14:08,250 --> 00:14:10,740
and we came up with something we call

362
00:14:10,740 --> 00:14:13,710
stay go so it's at ww stay calm it's

363
00:14:13,710 --> 00:14:14,970
basically a web application that

364
00:14:14,970 --> 00:14:17,240
provides this encryption steganography

365
00:14:17,240 --> 00:14:20,370
benefits while actually providing I

366
00:14:20,370 --> 00:14:22,620
guess an extra layer of abstraction of

367
00:14:22,620 --> 00:14:25,020
that data what's different about this

368
00:14:25,020 --> 00:14:27,300
tool is of course it's web-based a CVS

369
00:14:27,300 --> 00:14:29,940
upload and the entire data is broken up

370
00:14:29,940 --> 00:14:31,920
to binary data chunks and each data

371
00:14:31,920 --> 00:14:33,960
chunk is then encrypted and then stay

372
00:14:33,960 --> 00:14:35,580
NGO dinh images and those images are

373
00:14:35,580 --> 00:14:37,140
placed out in the clouds so there's no

374
00:14:37,140 --> 00:14:39,300
data on our server or any day and on

375
00:14:39,300 --> 00:14:42,050
your client in system on your system and

376
00:14:42,050 --> 00:14:44,340
the benefits of this technology of

377
00:14:44,340 --> 00:14:46,230
course is a data exfiltration to remote

378
00:14:46,230 --> 00:14:48,630
system via standard port you know 443

379
00:14:48,630 --> 00:14:51,630
our port 80 encrypted contents prevent

380
00:14:51,630 --> 00:14:53,400
others from accessing data and the

381
00:14:53,400 --> 00:14:54,780
stakeout contents prevent others from

382
00:14:54,780 --> 00:14:56,400
finding the data so basically you have a

383
00:14:56,400 --> 00:14:58,140
bunch of images out there in the cloud

384
00:14:58,140 --> 00:15:00,600
that have your encrypted data in little

385
00:15:00,600 --> 00:15:03,090
chunks and good luck trying to find all

386
00:15:03,090 --> 00:15:04,950
those images decrypting it diste go in

387
00:15:04,950 --> 00:15:07,260
and put him back together and like I

388
00:15:07,260 --> 00:15:08,910
said nothing stored locally so this

389
00:15:08,910 --> 00:15:12,150
provides plausible deniability and let's

390
00:15:12,150 --> 00:15:13,260
go to the architecture of the proof

391
00:15:13,260 --> 00:15:15,810
concept tool so our main goal was to

392
00:15:15,810 --> 00:15:17,970
provide confidentiality integrity and

393
00:15:17,970 --> 00:15:21,090
availability of your data right the CIA

394
00:15:21,090 --> 00:15:23,730
triangle thing so what we do is we take

395
00:15:23,730 --> 00:15:25,710
a binary file whatever file you want to

396
00:15:25,710 --> 00:15:28,050
upload we take the contents of that file

397
00:15:28,050 --> 00:15:30,570
and we break it up to data chunks so you

398
00:15:30,570 --> 00:15:32,250
could have an encrypted file you could

399
00:15:32,250 --> 00:15:33,180
have something that's already

400
00:15:33,180 --> 00:15:35,000
pressed you could have images video

401
00:15:35,000 --> 00:15:38,340
executable binary dll any type of file

402
00:15:38,340 --> 00:15:40,950
take it insert it it'll break it up to

403
00:15:40,950 --> 00:15:42,750
date of chunks and then after it breaks

404
00:15:42,750 --> 00:15:46,170
it up it creates a hash of not only the

405
00:15:46,170 --> 00:15:48,150
entire data file but each data chunks to

406
00:15:48,150 --> 00:15:51,150
provide I guess integrity of that data

407
00:15:51,150 --> 00:15:53,670
so you can make sure that nobody's mess

408
00:15:53,670 --> 00:15:54,870
with that data on the other hand when

409
00:15:54,870 --> 00:15:55,950
you get it back you could compare those

410
00:15:55,950 --> 00:15:59,610
hashes and this is just a simple example

411
00:15:59,610 --> 00:16:01,920
of an algorithm using if use encryption

412
00:16:01,920 --> 00:16:04,590
it actually adds some padding to the

413
00:16:04,590 --> 00:16:07,860
data so if you're using encryption we

414
00:16:07,860 --> 00:16:10,110
take the chunk size and limit it to

415
00:16:10,110 --> 00:16:13,650
smaller bits of data chunks and this is

416
00:16:13,650 --> 00:16:16,410
just showing the checking of the hashes

417
00:16:16,410 --> 00:16:17,850
so you have a hash before your hash

418
00:16:17,850 --> 00:16:19,320
after if there's any changes to that

419
00:16:19,320 --> 00:16:21,360
binary data the hash for match we know

420
00:16:21,360 --> 00:16:23,520
something's you know gone wrong and we

421
00:16:23,520 --> 00:16:25,830
won't continue the process after that so

422
00:16:25,830 --> 00:16:27,420
this is just a simple example of the

423
00:16:27,420 --> 00:16:30,870
algorithm for checking the hashes so you

424
00:16:30,870 --> 00:16:32,280
have your hash before of course your

425
00:16:32,280 --> 00:16:35,250
hash akal after they're not equal we

426
00:16:35,250 --> 00:16:36,990
can't validate the security or integrity

427
00:16:36,990 --> 00:16:38,790
of that data so we don't process it any

428
00:16:38,790 --> 00:16:42,960
further next so encryption every data

429
00:16:42,960 --> 00:16:44,790
chunk is encrypted prior to

430
00:16:44,790 --> 00:16:47,250
steganography using a simple encrypt our

431
00:16:47,250 --> 00:16:49,650
decrypt PHP function but you have the

432
00:16:49,650 --> 00:16:53,220
option to use a es 128 or 256 encryption

433
00:16:53,220 --> 00:16:55,290
and that's to provide data

434
00:16:55,290 --> 00:16:57,270
confidentiality so every piece of data

435
00:16:57,270 --> 00:17:01,920
is encrypted whether you want hey Enz

436
00:17:01,920 --> 00:17:04,020
krypton functions this is an example of

437
00:17:04,020 --> 00:17:06,569
some of the code for the actual

438
00:17:06,569 --> 00:17:07,920
encryption of it as you can see it's

439
00:17:07,920 --> 00:17:09,810
just a function takes it in there

440
00:17:09,810 --> 00:17:11,790
decrypt your data are in crypts and I'm

441
00:17:11,790 --> 00:17:14,460
sorry on this part again this is the

442
00:17:14,460 --> 00:17:16,859
reverse of that algorithm just

443
00:17:16,859 --> 00:17:21,030
decrypting the data and what's different

444
00:17:21,030 --> 00:17:23,130
ok so different steganography we've

445
00:17:23,130 --> 00:17:24,450
talked a little about the encryption of

446
00:17:24,450 --> 00:17:26,130
course it's kind of basic encryption the

447
00:17:26,130 --> 00:17:27,599
steganography is what really makes this

448
00:17:27,599 --> 00:17:29,910
to a little bit different is there's a

449
00:17:29,910 --> 00:17:30,900
lot of different techniques for

450
00:17:30,900 --> 00:17:33,090
steganography one is to store the data

451
00:17:33,090 --> 00:17:34,590
in the comment field of an image that's

452
00:17:34,590 --> 00:17:36,090
really lame it's not really sticking out

453
00:17:36,090 --> 00:17:38,190
raphy anyone can find that you could use

454
00:17:38,190 --> 00:17:40,710
the unused space though color space so

455
00:17:40,710 --> 00:17:42,510
usually have like a 32-bit color and a

456
00:17:42,510 --> 00:17:44,790
lot of times then we'll use 24 bits so

457
00:17:44,790 --> 00:17:46,390
you can use that extra space

458
00:17:46,390 --> 00:17:47,980
of course you could use the transparency

459
00:17:47,980 --> 00:17:50,170
channel which is the alpha channel which

460
00:17:50,170 --> 00:17:51,910
gives you about seven bits of data per

461
00:17:51,910 --> 00:17:55,810
pixel next slide and this is a really

462
00:17:55,810 --> 00:17:57,580
cool technique we use something along

463
00:17:57,580 --> 00:17:59,200
these lines with a little different

464
00:17:59,200 --> 00:18:01,210
algorithm it's called pixel value

465
00:18:01,210 --> 00:18:03,280
differencing so what it is is basically

466
00:18:03,280 --> 00:18:05,230
for every pixel you have an algorithm

467
00:18:05,230 --> 00:18:07,900
that compares the pixel prior to and

468
00:18:07,900 --> 00:18:10,840
after and it makes an algorithm that

469
00:18:10,840 --> 00:18:12,790
says is this pixel value you know odd or

470
00:18:12,790 --> 00:18:14,500
even and with that algorithm that you

471
00:18:14,500 --> 00:18:16,510
can have symbolic binary data stored

472
00:18:16,510 --> 00:18:19,240
within your stay code image do you

473
00:18:19,240 --> 00:18:20,950
understand so it's not actually binary

474
00:18:20,950 --> 00:18:22,270
data stored within the image it's

475
00:18:22,270 --> 00:18:23,800
symbolically represented by the

476
00:18:23,800 --> 00:18:26,590
difference of the pixel values all right

477
00:18:26,590 --> 00:18:28,390
so we took that kind of concept and use

478
00:18:28,390 --> 00:18:31,420
it within stay go each primary color is

479
00:18:31,420 --> 00:18:34,030
altered to be either even or odd so that

480
00:18:34,030 --> 00:18:35,320
allows us to store one bit of data

481
00:18:35,320 --> 00:18:37,720
breach every primary color you get about

482
00:18:37,720 --> 00:18:39,910
three bits so for your red green blue

483
00:18:39,910 --> 00:18:42,580
value you have you know if it's 255 it

484
00:18:42,580 --> 00:18:44,920
could be one if it's 250 40 that kind of

485
00:18:44,920 --> 00:18:46,630
symbolic representations so there's not

486
00:18:46,630 --> 00:18:49,300
actually any binary data stored within

487
00:18:49,300 --> 00:18:51,520
the images it's symbolically represented

488
00:18:51,520 --> 00:18:55,240
by the value of the pixels so the

489
00:18:55,240 --> 00:18:56,830
advantage of this method is that like I

490
00:18:56,830 --> 00:18:58,330
said there's nothing actually stored in

491
00:18:58,330 --> 00:18:59,230
there it's just symbolic you've

492
00:18:59,230 --> 00:19:01,510
represented represented by the pixel

493
00:19:01,510 --> 00:19:04,840
values and we were able to get about 175

494
00:19:04,840 --> 00:19:07,030
kilobytes of data with compression in an

495
00:19:07,030 --> 00:19:09,930
800 x 600 pixel image which isn't bad

496
00:19:09,930 --> 00:19:12,730
this is an example of the actual

497
00:19:12,730 --> 00:19:16,270
algorithm for staying the image so as

498
00:19:16,270 --> 00:19:17,320
you can see down on the bottom it has a

499
00:19:17,320 --> 00:19:19,600
simple function to put the data file the

500
00:19:19,600 --> 00:19:21,850
image the key and then the image file

501
00:19:21,850 --> 00:19:24,700
that's actually storing it to diste

502
00:19:24,700 --> 00:19:26,230
going the same thing it's just a simple

503
00:19:26,230 --> 00:19:28,390
function to get the image back from the

504
00:19:28,390 --> 00:19:30,790
encrypted response your royal you

505
00:19:30,790 --> 00:19:32,770
provide the key and it grabs your data

506
00:19:32,770 --> 00:19:34,840
back so now we're going to do a little

507
00:19:34,840 --> 00:19:36,880
demo of the tools you'll see all this in

508
00:19:36,880 --> 00:19:43,600
action alright so I learned from my by

509
00:19:43,600 --> 00:19:46,660
robert hansen that live demos are not a

510
00:19:46,660 --> 00:19:49,900
good idea wireless networks are flaky

511
00:19:49,900 --> 00:19:53,440
yadda so what I have is a pre-prepared

512
00:19:53,440 --> 00:19:55,950
video for you guys and I realized like

513
00:19:55,950 --> 00:19:58,490
aspect ratios and whatnot or

514
00:19:58,490 --> 00:20:00,260
little funky here but hopefully you can

515
00:20:00,260 --> 00:20:03,440
kind of see the the basics all right let

516
00:20:03,440 --> 00:20:05,030
me click play we log in with our

517
00:20:05,030 --> 00:20:07,550
username test and our password click

518
00:20:07,550 --> 00:20:10,220
login this is the actual stego tool you

519
00:20:10,220 --> 00:20:11,570
can see kind of the interface very

520
00:20:11,570 --> 00:20:14,300
simple stego page d stego page on the

521
00:20:14,300 --> 00:20:15,860
stego page we give it a name for the

522
00:20:15,860 --> 00:20:18,380
project we have the option of providing

523
00:20:18,380 --> 00:20:20,750
movie name this is used to pull the

524
00:20:20,750 --> 00:20:23,690
images that we then put the data into we

525
00:20:23,690 --> 00:20:26,090
give it a key and we can determine what

526
00:20:26,090 --> 00:20:28,490
kind of encryption we want here we

527
00:20:28,490 --> 00:20:30,980
choose aes-128 and we choose 0 verbose

528
00:20:30,980 --> 00:20:33,440
output we select our file we go ahead

529
00:20:33,440 --> 00:20:36,020
and click Submit it goes ahead and

530
00:20:36,020 --> 00:20:38,809
updates first thing it does is it pulls

531
00:20:38,809 --> 00:20:40,760
down the image set you'll actually pull

532
00:20:40,760 --> 00:20:43,190
40 images at a time just so that we have

533
00:20:43,190 --> 00:20:45,290
something to go off of we don't always

534
00:20:45,290 --> 00:20:48,740
use all 40 of those images but it's nice

535
00:20:48,740 --> 00:20:50,630
to kind of pre-prep it so that the rest

536
00:20:50,630 --> 00:20:52,760
of the work goes faster you can see here

537
00:20:52,760 --> 00:20:55,070
it's actually chunking out that image or

538
00:20:55,070 --> 00:20:57,350
the the text file that I upload it goes

539
00:20:57,350 --> 00:20:59,480
in beds it does the encryption and beds

540
00:20:59,480 --> 00:21:01,790
it and there's our image right there now

541
00:21:01,790 --> 00:21:03,890
that image shows up because we selected

542
00:21:03,890 --> 00:21:06,080
the verbose output if you don't select

543
00:21:06,080 --> 00:21:07,760
verbose output they won't do that and

544
00:21:07,760 --> 00:21:09,620
I'll talk a little bit about why later I

545
00:21:09,620 --> 00:21:12,830
went ahead and I selected that URL we go

546
00:21:12,830 --> 00:21:14,360
ahead and click there and sure enough it

547
00:21:14,360 --> 00:21:15,920
shows up in the imageshack it's just

548
00:21:15,920 --> 00:21:18,440
file sing out there on their servers in

549
00:21:18,440 --> 00:21:20,300
the cloud now when we want to get that

550
00:21:20,300 --> 00:21:24,080
back we go our d stego page we go ahead

551
00:21:24,080 --> 00:21:25,730
and select our project there's our

552
00:21:25,730 --> 00:21:27,620
passwords project we have to enter our

553
00:21:27,620 --> 00:21:29,840
key so that we can decrypt and East I go

554
00:21:29,840 --> 00:21:32,210
again i select a verbose output and you

555
00:21:32,210 --> 00:21:34,429
can see the the project right there we

556
00:21:34,429 --> 00:21:36,950
click Submit it goes out it grabs that

557
00:21:36,950 --> 00:21:39,559
file from there it reassembles it

558
00:21:39,559 --> 00:21:42,080
decrypts it and we can see my original

559
00:21:42,080 --> 00:21:44,510
password document those are all my real

560
00:21:44,510 --> 00:21:46,429
passwords by the way so don't pay

561
00:21:46,429 --> 00:21:49,640
attention do you have a question sorry

562
00:21:49,640 --> 00:21:51,790
sir

563
00:21:57,340 --> 00:21:59,740
yes so the user is able to provide their

564
00:21:59,740 --> 00:22:02,320
own key for this and we'll talk a little

565
00:22:02,320 --> 00:22:03,760
bit about this layer this is a proof of

566
00:22:03,760 --> 00:22:05,530
concept tool so feel free to play with

567
00:22:05,530 --> 00:22:07,720
it what not but don't you know trust us

568
00:22:07,720 --> 00:22:09,670
with whatever work kind of nefarious in

569
00:22:09,670 --> 00:22:12,370
that way but yeah you basically provide

570
00:22:12,370 --> 00:22:14,800
your own key that key is actually used

571
00:22:14,800 --> 00:22:16,660
to do the steganography to do the

572
00:22:16,660 --> 00:22:19,930
encryption so unless if you know the key

573
00:22:19,930 --> 00:22:23,280
there's no way get that data back

574
00:22:40,899 --> 00:22:43,940
the answer is so the question was do we

575
00:22:43,940 --> 00:22:45,859
enforce any sort of length or password

576
00:22:45,859 --> 00:22:48,049
requirements or anything like that we

577
00:22:48,049 --> 00:22:49,669
are bad security professionals we don't

578
00:22:49,669 --> 00:22:52,249
do anything like that it's up to you to

579
00:22:52,249 --> 00:22:54,710
figure that stuff out it's a

580
00:22:54,710 --> 00:22:58,009
proof-of-concept tool so so we don't do

581
00:22:58,009 --> 00:22:59,509
things like that we don't limit you in

582
00:22:59,509 --> 00:23:01,489
that way so so on this comment i just

583
00:23:01,489 --> 00:23:03,320
want to mention obviously you're

584
00:23:03,320 --> 00:23:04,519
concerned about the security on the site

585
00:23:04,519 --> 00:23:05,960
and all that and i don't want people to

586
00:23:05,960 --> 00:23:07,070
rely on the security that's why you

587
00:23:07,070 --> 00:23:08,539
could upload any kind of files if you

588
00:23:08,539 --> 00:23:10,519
want to add your own encryption to it

589
00:23:10,519 --> 00:23:12,169
compress the file do your own

590
00:23:12,169 --> 00:23:13,789
steganography and then use this tool as

591
00:23:13,789 --> 00:23:15,619
a data transfer medium that's mainly

592
00:23:15,619 --> 00:23:16,820
what this intended for is a way of

593
00:23:16,820 --> 00:23:20,389
transferring data you know by all means

594
00:23:20,389 --> 00:23:21,320
you could do that in the tool should

595
00:23:21,320 --> 00:23:22,759
accept whatever data file you want so

596
00:23:22,759 --> 00:23:23,599
you could do your own encryption

597
00:23:23,599 --> 00:23:25,759
security on the back end of the file and

598
00:23:25,759 --> 00:23:28,039
would have to rely on our security

599
00:23:28,039 --> 00:23:34,999
measures here yeah there will be some

600
00:23:34,999 --> 00:23:36,529
time at the end we'll leave time for

601
00:23:36,529 --> 00:23:39,229
questions questions are a sign of

602
00:23:39,229 --> 00:23:42,889
intelligence so all right let's go here

603
00:23:42,889 --> 00:23:45,440
so this is another demo and this is just

604
00:23:45,440 --> 00:23:47,720
going to show uploading a different type

605
00:23:47,720 --> 00:23:49,720
of file the first one was a text file

606
00:23:49,720 --> 00:23:52,340
this one is actually an image file so

607
00:23:52,340 --> 00:23:54,289
the same Qandil we enter the name of our

608
00:23:54,289 --> 00:23:56,869
project we select a movie this time I

609
00:23:56,869 --> 00:24:00,019
selected Goonies we give it a key we go

610
00:24:00,019 --> 00:24:02,629
ahead and select verbose output I never

611
00:24:02,629 --> 00:24:04,220
selected encryption on this one just

612
00:24:04,220 --> 00:24:06,710
because encryption tends to add extra

613
00:24:06,710 --> 00:24:10,099
stuff to this makes it take longer so

614
00:24:10,099 --> 00:24:11,659
for this particular example I decide not

615
00:24:11,659 --> 00:24:13,039
to because the image was a little bit

616
00:24:13,039 --> 00:24:15,409
bigger we go ahead and submit I did a

617
00:24:15,409 --> 00:24:16,999
little bit of time-lapse photography

618
00:24:16,999 --> 00:24:20,450
here so it'll go a lot faster another

619
00:24:20,450 --> 00:24:22,999
benefit to not doing the live live

620
00:24:22,999 --> 00:24:24,859
demonstration and what you can see here

621
00:24:24,859 --> 00:24:26,840
is it's actually taking the image it's

622
00:24:26,840 --> 00:24:28,909
splitting it up into chunks and each

623
00:24:28,909 --> 00:24:31,099
chunk it's embedded to a new piece and

624
00:24:31,099 --> 00:24:34,039
so it's grabbing it grabs 40 images at a

625
00:24:34,039 --> 00:24:36,349
time starts and bang each chunk into one

626
00:24:36,349 --> 00:24:37,820
of those images and then uploads every

627
00:24:37,820 --> 00:24:39,409
single one of those images into

628
00:24:39,409 --> 00:24:41,840
imageshack so when we're all done we're

629
00:24:41,840 --> 00:24:43,249
going to have lots and lots of images

630
00:24:43,249 --> 00:24:45,139
that are up there they can all be

631
00:24:45,139 --> 00:24:48,710
reassembled then for our original data

632
00:24:48,710 --> 00:24:50,370
which in this case is an image

633
00:24:50,370 --> 00:24:54,059
so I drag it all the way down here you

634
00:24:54,059 --> 00:24:55,770
can see all the images that got uploaded

635
00:24:55,770 --> 00:24:59,900
lots and lots of viewing these pictures

636
00:25:01,520 --> 00:25:04,470
and at the end it will give us kind of a

637
00:25:04,470 --> 00:25:05,760
little summary in this case there were

638
00:25:05,760 --> 00:25:07,680
28 images that were uploaded

639
00:25:07,680 --> 00:25:10,170
successfully some of the images didn't

640
00:25:10,170 --> 00:25:12,750
have enough to store the data so they

641
00:25:12,750 --> 00:25:15,870
were thrown out so we go this D stego

642
00:25:15,870 --> 00:25:18,960
page we enter our password again we

643
00:25:18,960 --> 00:25:21,890
select our project

644
00:25:50,000 --> 00:25:53,210
there we go all right and we're back

645
00:25:53,210 --> 00:25:57,780
okay so you can see it went it grabbed

646
00:25:57,780 --> 00:25:59,760
every single one of those 28 images back

647
00:25:59,760 --> 00:26:02,370
out of the image share all those images

648
00:26:02,370 --> 00:26:05,970
we can see it took about 30 seconds to D

649
00:26:05,970 --> 00:26:08,130
stego this guy we can see the original

650
00:26:08,130 --> 00:26:10,200
file size that was there we can see that

651
00:26:10,200 --> 00:26:12,510
we matched with our d stego file size it

652
00:26:12,510 --> 00:26:14,940
also does the hashing behind the scenes

653
00:26:14,940 --> 00:26:17,910
and let's go ahead and get the project

654
00:26:17,910 --> 00:26:23,370
file access if we want to open it we go

655
00:26:23,370 --> 00:26:27,000
ahead and say ok and up pops the image

656
00:26:27,000 --> 00:26:32,670
that I at upload cool so there you have

657
00:26:32,670 --> 00:26:36,530
it this is the stego tool in action and

658
00:26:36,530 --> 00:26:41,550
what it does so full disclosure and

659
00:26:41,550 --> 00:26:48,060
caveats maybe alright so we've tested a

660
00:26:48,060 --> 00:26:49,830
bunch of file types to make sure that

661
00:26:49,830 --> 00:26:51,840
they work well a few right here we've

662
00:26:51,840 --> 00:26:54,780
tested way more than this text file zip

663
00:26:54,780 --> 00:26:57,150
files middies images all sorts of types

664
00:26:57,150 --> 00:26:59,250
of images but as Orlando said we've

665
00:26:59,250 --> 00:27:02,070
actually the way that this algorithm

666
00:27:02,070 --> 00:27:04,560
works it's just working on binary data

667
00:27:04,560 --> 00:27:07,950
so in theory it doesn't matter what file

668
00:27:07,950 --> 00:27:09,990
type you're using anything that you

669
00:27:09,990 --> 00:27:11,640
upload whether it's images videos

670
00:27:11,640 --> 00:27:15,810
whatever it should work aes 256

671
00:27:15,810 --> 00:27:19,200
encryption so this is experimental the

672
00:27:19,200 --> 00:27:21,950
reason why

673
00:28:52,870 --> 00:28:56,110
retrieve any useful if good but like we

674
00:28:56,110 --> 00:28:57,580
said to circumvent that all you do is

675
00:28:57,580 --> 00:28:59,559
add a random watermark to every image

676
00:28:59,559 --> 00:29:01,570
that you scrape from online there's no

677
00:29:01,570 --> 00:29:03,730
original image so what we found with

678
00:29:03,730 --> 00:29:05,559
this is that high-definition images

679
00:29:05,559 --> 00:29:07,300
because of the fact that they're high

680
00:29:07,300 --> 00:29:10,210
definite high-def are the best images to

681
00:29:10,210 --> 00:29:11,950
use they can store more data in it

682
00:29:11,950 --> 00:29:15,460
because they're they're bigger so

683
00:29:15,460 --> 00:29:17,380
unencrypted data so the uploads

684
00:29:17,380 --> 00:29:20,320
encrypted right it goes via HTTPS there

685
00:29:20,320 --> 00:29:22,090
shouldn't be any issues there but the

686
00:29:22,090 --> 00:29:24,190
file exists on the server for a very

687
00:29:24,190 --> 00:29:26,080
short period of time before it gets

688
00:29:26,080 --> 00:29:28,770
chunked out encrypted staggered whatnot

689
00:29:28,770 --> 00:29:31,630
where it is in an encrypted state so

690
00:29:31,630 --> 00:29:34,030
it's possible that that unencrypted file

691
00:29:34,030 --> 00:29:36,190
might reside in memory might reside on

692
00:29:36,190 --> 00:29:39,610
disk at some point so there's some

693
00:29:39,610 --> 00:29:41,410
temporary location there are ways that

694
00:29:41,410 --> 00:29:43,840
you could probably clear that out we

695
00:29:43,840 --> 00:29:48,010
just haven't gone that far ssl robert

696
00:29:48,010 --> 00:29:49,510
hansen and i gave a talk at block had a

697
00:29:49,510 --> 00:29:51,850
couple years ago talking about issues

698
00:29:51,850 --> 00:29:54,160
with ssl and whatnot but it's very well

699
00:29:54,160 --> 00:29:56,620
known we use a snake-oil cert because i

700
00:29:56,620 --> 00:29:59,710
didn't want to buy one frankly so snake

701
00:29:59,710 --> 00:30:01,420
oil certs lead to man in the middle so

702
00:30:01,420 --> 00:30:03,130
if you're trying to use this tool for

703
00:30:03,130 --> 00:30:06,490
anything that you care about just heads

704
00:30:06,490 --> 00:30:09,550
up captcha the capture works really well

705
00:30:09,550 --> 00:30:12,190
in firefox it works in IE but you have

706
00:30:12,190 --> 00:30:14,410
to click the right yes I accept this do

707
00:30:14,410 --> 00:30:17,470
this whatever from the dialog boxes so

708
00:30:17,470 --> 00:30:21,460
but easier if you use firefox file

709
00:30:21,460 --> 00:30:23,620
upload size we've actually restricted

710
00:30:23,620 --> 00:30:27,690
the file upload size for the demo it's

711
00:30:27,690 --> 00:30:31,570
11 million well one hundred and two

712
00:30:31,570 --> 00:30:33,760
thousand four hundred bytes for the demo

713
00:30:33,760 --> 00:30:36,760
that was our return we just chose a

714
00:30:36,760 --> 00:30:39,250
random value we could change that or

715
00:30:39,250 --> 00:30:42,670
whatever caused it yeah yeah if somebody

716
00:30:42,670 --> 00:30:44,650
uploaded very large files it could

717
00:30:44,650 --> 00:30:45,970
certainly bring down or tweet up those

718
00:30:45,970 --> 00:30:50,950
like a movie take a long time yeah all

719
00:30:50,950 --> 00:30:55,480
right cash so caching is very very

720
00:30:55,480 --> 00:30:57,250
popular on the internet these days to

721
00:30:57,250 --> 00:30:59,530
speed up website performance there's all

722
00:30:59,530 --> 00:31:02,290
sorts of things like you know squid

723
00:31:02,290 --> 00:31:06,389
proxies and you know things like that

724
00:32:50,090 --> 00:32:52,650
check check all right so bigger files

725
00:32:52,650 --> 00:32:53,820
are great if you're talking about things

726
00:32:53,820 --> 00:32:55,890
like text but if I want to do things

727
00:32:55,890 --> 00:32:59,070
like images you saw there that took you

728
00:32:59,070 --> 00:33:01,650
know 28 images for me to encrypt to

729
00:33:01,650 --> 00:33:04,470
encode one image file so what if we

730
00:33:04,470 --> 00:33:06,990
start doing things like using mp3s or

731
00:33:06,990 --> 00:33:10,200
using mpegs movies things like that you

732
00:33:10,200 --> 00:33:11,970
could potentially use things like

733
00:33:11,970 --> 00:33:14,640
YouTube as a repository or SoundCloud as

734
00:33:14,640 --> 00:33:16,680
a repository and you can store far more

735
00:33:16,680 --> 00:33:19,050
data in those files than an individual

736
00:33:19,050 --> 00:33:22,230
image we talked a little bit about this

737
00:33:22,230 --> 00:33:25,410
the caching issues we never implemented

738
00:33:25,410 --> 00:33:27,150
this this would be like one line of code

739
00:33:27,150 --> 00:33:28,860
so we just kind of thought it was silly

740
00:33:28,860 --> 00:33:31,140
but you could add no cash or HTTP

741
00:33:31,140 --> 00:33:33,150
expires headers and hopefully that would

742
00:33:33,150 --> 00:33:35,400
tell the cash you know the proxies to

743
00:33:35,400 --> 00:33:37,980
just not cash that stuff right not all

744
00:33:37,980 --> 00:33:39,690
proxies would listen to that obviously

745
00:33:39,690 --> 00:33:42,870
but it might work alright so back to the

746
00:33:42,870 --> 00:33:45,300
future we're not the only guys who have

747
00:33:45,300 --> 00:33:48,150
thought about something like this when

748
00:33:48,150 --> 00:33:49,560
we were doing research on this we came

749
00:33:49,560 --> 00:33:52,140
across this guy this is web based covert

750
00:33:52,140 --> 00:33:56,340
file system these guys may 2007 they

751
00:33:56,340 --> 00:33:58,860
outlined how to use steganography to

752
00:33:58,860 --> 00:34:00,960
create an actual file system and this

753
00:34:00,960 --> 00:34:03,510
thing actually was bad I nodes and data

754
00:34:03,510 --> 00:34:06,120
and all sorts of stuff is fantastic and

755
00:34:06,120 --> 00:34:08,550
this was actually based on images within

756
00:34:08,550 --> 00:34:11,610
flickr photos and so they create an

757
00:34:11,610 --> 00:34:13,679
entire file system based off of

758
00:34:13,679 --> 00:34:16,290
steganography very very cool took it a

759
00:34:16,290 --> 00:34:18,659
step further they called it picks us SF

760
00:34:18,659 --> 00:34:20,400
you can actually go and download pics

761
00:34:20,400 --> 00:34:24,300
f'd SF the privacy enhancing image-based

762
00:34:24,300 --> 00:34:26,940
collaborative file system really cool

763
00:34:26,940 --> 00:34:28,949
they took it a step further they have

764
00:34:28,949 --> 00:34:30,860
automatic image selection from a video

765
00:34:30,860 --> 00:34:33,780
they use tor to additionally protect

766
00:34:33,780 --> 00:34:35,668
users so is random routing across the

767
00:34:35,668 --> 00:34:38,489
internet they took that covert FS that

768
00:34:38,489 --> 00:34:40,080
we talked about and they put it on top

769
00:34:40,080 --> 00:34:41,969
of this fuse framework and ultimately

770
00:34:41,969 --> 00:34:44,159
they have entire file system that's

771
00:34:44,159 --> 00:34:47,000
based off of steganography that's

772
00:34:47,000 --> 00:34:49,600
randomized across the internet

773
00:34:49,600 --> 00:34:52,690
the software on use it yeah so the issue

774
00:34:52,690 --> 00:34:54,610
with both of these is you still have the

775
00:34:54,610 --> 00:34:56,560
software on your system right you still

776
00:34:56,560 --> 00:34:59,410
have that the the thing that's going to

777
00:34:59,410 --> 00:35:01,660
give them that reasonable suspicion and

778
00:35:01,660 --> 00:35:05,070
they're still going to come after you so

779
00:35:05,070 --> 00:35:08,200
in closing it's a proof of concept right

780
00:35:08,200 --> 00:35:11,380
this is not a production application and

781
00:35:11,380 --> 00:35:13,180
we said this a couple times this was

782
00:35:13,180 --> 00:35:14,830
just something we kind of wrote up we

783
00:35:14,830 --> 00:35:17,170
thought would be a cool idea a cool

784
00:35:17,170 --> 00:35:19,060
proof-of-concept you are free to play

785
00:35:19,060 --> 00:35:21,400
with it that it's for educational

786
00:35:21,400 --> 00:35:23,530
purposes only it's a bit redundant but

787
00:35:23,530 --> 00:35:25,420
we're not responsible for your use or

788
00:35:25,420 --> 00:35:27,640
misuse of this tool right you can do

789
00:35:27,640 --> 00:35:29,470
some naughty things with this please

790
00:35:29,470 --> 00:35:32,830
don't but you could and that's the

791
00:35:32,830 --> 00:35:34,390
reason why orlando and i have not

792
00:35:34,390 --> 00:35:37,270
released code for this tool all comments

793
00:35:37,270 --> 00:35:39,490
and opinions are the property of us they

794
00:35:39,490 --> 00:35:41,200
don't represent our employers or their

795
00:35:41,200 --> 00:35:44,290
policies like I said my employer's name

796
00:35:44,290 --> 00:35:46,990
is completely out of this for that

797
00:35:46,990 --> 00:35:49,330
reason and all content is provided as is

798
00:35:49,330 --> 00:35:51,400
no warranties assurances guarantees

799
00:35:51,400 --> 00:35:54,510
whatever right traditional disclaimer so

800
00:35:54,510 --> 00:36:00,870
with that questions you were first

