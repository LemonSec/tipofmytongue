1
00:00:04,160 --> 00:00:17,630
welcome<font color="#CCCCCC"> Robel</font><font color="#E5E5E5"> leo thank you thank you</font>

2
00:00:10,460 --> 00:00:19,640
<font color="#E5E5E5">very much appreciate it thank you so</font>

3
00:00:17,630 --> 00:00:20,180
<font color="#E5E5E5">apparently I have to manage</font><font color="#CCCCCC"> my time wish</font>

4
00:00:19,640 --> 00:00:22,489
me<font color="#CCCCCC"> luck</font>

5
00:00:20,180 --> 00:00:24,259
I have no<font color="#E5E5E5"> ability to do that whatsoever</font>

6
00:00:22,489 --> 00:00:26,079
can you switch to my screen<font color="#CCCCCC"> if that's</font>

7
00:00:24,259 --> 00:00:31,040
all right<font color="#E5E5E5"> I'm gonna start</font><font color="#CCCCCC"> now</font>

8
00:00:26,079 --> 00:00:34,309
<font color="#CCCCCC">due to do</font><font color="#E5E5E5"> I try</font><font color="#CCCCCC"> to alright</font><font color="#E5E5E5"> so I wrote a</font>

9
00:00:31,040 --> 00:00:38,600
little uh presentation software for you

10
00:00:34,309 --> 00:00:41,839
guys so let's<font color="#E5E5E5"> see if it works okay</font><font color="#CCCCCC"> so</font>

11
00:00:38,600 --> 00:00:43,310
<font color="#CCCCCC">this is</font><font color="#E5E5E5"> gonna be my class</font><font color="#CCCCCC"> alright my</font>

12
00:00:41,840 --> 00:00:46,850
talk<font color="#E5E5E5"> a little bit about how to buy our</font>

13
00:00:43,310 --> 00:00:48,680
car in<font color="#CCCCCC"> 60,000 milliseconds if you don't</font>

14
00:00:46,850 --> 00:00:52,960
know what a millisecond is neither<font color="#E5E5E5"> do i</font>

15
00:00:48,680 --> 00:00:55,130
<font color="#CCCCCC">I'm American we don't we we do it and in</font>

16
00:00:52,960 --> 00:00:56,960
<font color="#CCCCCC">metric</font><font color="#E5E5E5"> the metric system is just beyond</font>

17
00:00:55,130 --> 00:00:58,240
us<font color="#CCCCCC"> so we're just still trying to</font><font color="#E5E5E5"> figure</font>

18
00:00:56,960 --> 00:01:00,500
it<font color="#E5E5E5"> out</font>

19
00:00:58,240 --> 00:01:02,090
thank you for coming<font color="#E5E5E5"> it's a lot of</font>

20
00:01:00,500 --> 00:01:03,860
people I appreciate it I thought this

21
00:01:02,090 --> 00:01:05,869
was going<font color="#CCCCCC"> to be a small con a little</font>

22
00:01:03,860 --> 00:01:07,820
tiny couple of hundred people<font color="#CCCCCC"> maybe a</font>

23
00:01:05,869 --> 00:01:09,259
lot<font color="#E5E5E5"> more people</font><font color="#CCCCCC"> today</font><font color="#E5E5E5"> than I expected so</font>

24
00:01:07,820 --> 00:01:12,648
I appreciate you<font color="#E5E5E5"> guys</font><font color="#CCCCCC"> coming out staying</font>

25
00:01:09,259 --> 00:01:14,329
<font color="#E5E5E5">till</font><font color="#CCCCCC"> the last</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> I'm gonna talk a</font>

26
00:01:12,649 --> 00:01:15,770
little bit about<font color="#CCCCCC"> here's some of the</font>

27
00:01:14,329 --> 00:01:16,999
objectives<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I'm gonna go over I'm</font>

28
00:01:15,770 --> 00:01:19,399
gonna talk a little bit about starting

29
00:01:16,999 --> 00:01:21,710
systems so vehicle again this is all

30
00:01:19,399 --> 00:01:24,829
vehicle starting systems or and talk a

31
00:01:21,710 --> 00:01:29,139
little bit about immobilizers<font color="#CCCCCC"> we'll talk</font>

32
00:01:24,829 --> 00:01:31,969
about<font color="#E5E5E5"> vehicle networks Diagnostics</font>

33
00:01:29,139 --> 00:01:33,829
<font color="#CCCCCC">methods</font><font color="#E5E5E5"> for borrowing cars if you don't</font>

34
00:01:31,969 --> 00:01:36,259
know what<font color="#E5E5E5"> that is it's a euphemism for</font>

35
00:01:33,829 --> 00:01:38,538
stealing cars yes

36
00:01:36,259 --> 00:01:40,459
relay attacks<font color="#E5E5E5"> you might have heard of in</font>

37
00:01:38,539 --> 00:01:42,920
the news and other talks on relay

38
00:01:40,459 --> 00:01:45,200
attacks<font color="#CCCCCC"> we're gonna talk a little bit</font>

39
00:01:42,920 --> 00:01:46,729
about some of<font color="#CCCCCC"> the more practical methods</font>

40
00:01:45,200 --> 00:01:49,159
for stealing cars which is<font color="#E5E5E5"> adding new</font>

41
00:01:46,729 --> 00:01:51,939
keys oops

42
00:01:49,159 --> 00:01:54,969
of course I was going<font color="#E5E5E5"> to mess this up</font>

43
00:01:51,939 --> 00:01:58,178
and then<font color="#E5E5E5"> hacking the out of it it's</font>

44
00:01:54,969 --> 00:02:00,850
always<font color="#CCCCCC"> a good</font><font color="#E5E5E5"> option as well</font><font color="#CCCCCC"> and we'll</font>

45
00:01:58,179 --> 00:02:03,310
talk a little<font color="#E5E5E5"> bit about the law boo-boo</font>

46
00:02:00,850 --> 00:02:05,288
<font color="#CCCCCC">and</font><font color="#E5E5E5"> we're gonna learn a little bit more</font>

47
00:02:03,310 --> 00:02:08,699
<font color="#CCCCCC">I'm gonna we're gonna</font><font color="#E5E5E5"> learn about</font><font color="#CCCCCC"> how</font><font color="#E5E5E5"> to</font>

48
00:02:05,289 --> 00:02:12,040
learn more about car hacking<font color="#E5E5E5"> as well</font>

49
00:02:08,699 --> 00:02:13,060
okay<font color="#CCCCCC"> so let's move on</font><font color="#E5E5E5"> so let's talk a</font>

50
00:02:12,040 --> 00:02:14,798
little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> about starting systems</font>

51
00:02:13,060 --> 00:02:17,140
because in order<font color="#E5E5E5"> to start a car you have</font>

52
00:02:14,799 --> 00:02:18,370
<font color="#CCCCCC">to understand how it starts so I'm gonna</font>

53
00:02:17,140 --> 00:02:19,480
give<font color="#E5E5E5"> you some fundamentals of how</font>

54
00:02:18,370 --> 00:02:22,000
starting system<font color="#E5E5E5"> works so we're gonna</font>

55
00:02:19,480 --> 00:02:22,899
talk about<font color="#E5E5E5"> how to hotwire a car if you</font>

56
00:02:22,000 --> 00:02:25,060
<font color="#E5E5E5">don't know what hot working it's</font>

57
00:02:22,900 --> 00:02:27,640
actually using the wires itself to start

58
00:02:25,060 --> 00:02:30,310
<font color="#E5E5E5">the vehicle itself so it's really</font><font color="#CCCCCC"> simple</font>

59
00:02:27,640 --> 00:02:32,170
<font color="#E5E5E5">we connect the ignition and the starter</font>

60
00:02:30,310 --> 00:02:34,120
wire<font color="#E5E5E5"> there's just two wires usually you</font>

61
00:02:32,170 --> 00:02:35,440
can find<font color="#CCCCCC"> them</font><font color="#E5E5E5"> underneath</font><font color="#CCCCCC"> the dash you</font>

62
00:02:34,120 --> 00:02:37,000
like you've seen<font color="#E5E5E5"> the movies you just</font>

63
00:02:35,440 --> 00:02:37,810
pull those two wires<font color="#E5E5E5"> it's literally that</font>

64
00:02:37,000 --> 00:02:41,019
simple actually

65
00:02:37,810 --> 00:02:43,720
you pull two wires<font color="#CCCCCC"> you find the starter</font>

66
00:02:41,019 --> 00:02:46,209
you find the<font color="#CCCCCC"> 12-volt battery you find</font>

67
00:02:43,720 --> 00:02:48,129
the ignition<font color="#CCCCCC"> and you power you power</font>

68
00:02:46,209 --> 00:02:51,579
them all at<font color="#E5E5E5"> the same</font><font color="#CCCCCC"> time the engine</font>

69
00:02:48,129 --> 00:02:53,709
will crank<font color="#CCCCCC"> once you</font><font color="#E5E5E5"> remove power</font><font color="#CCCCCC"> from</font>

70
00:02:51,579 --> 00:02:55,870
once it's cranked you<font color="#E5E5E5"> remove power from</font>

71
00:02:53,709 --> 00:02:57,849
<font color="#CCCCCC">the starter wire and you keep power on</font>

72
00:02:55,870 --> 00:03:00,220
the ignition<font color="#E5E5E5"> and it'll stay running</font><font color="#CCCCCC"> it's</font>

73
00:02:57,849 --> 00:03:03,388
that simple we talked a little bit<font color="#E5E5E5"> about</font>

74
00:03:00,220 --> 00:03:06,069
the relays themselves so what is a relay

75
00:03:03,389 --> 00:03:08,109
well here is<font color="#E5E5E5"> my first image how do you</font>

76
00:03:06,069 --> 00:03:11,470
like it<font color="#CCCCCC"> I made</font><font color="#E5E5E5"> that myself</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is a</font>

77
00:03:08,109 --> 00:03:14,200
relay a relay is is is literally<font color="#E5E5E5"> it</font>

78
00:03:11,470 --> 00:03:17,440
takes<font color="#CCCCCC"> it's a switch it's a it takes low</font>

79
00:03:14,200 --> 00:03:19,328
current<font color="#E5E5E5"> which is</font><font color="#CCCCCC"> on the 85 and</font><font color="#E5E5E5"> 86</font><font color="#CCCCCC"> it</font>

80
00:03:17,440 --> 00:03:22,060
takes low current and<font color="#E5E5E5"> it puts it out on</font>

81
00:03:19,329 --> 00:03:24,190
the<font color="#CCCCCC"> eight the 87 and 30 so</font><font color="#E5E5E5"> you can take</font>

82
00:03:22,060 --> 00:03:25,690
12 volts<font color="#E5E5E5"> and this is how your car starts</font>

83
00:03:24,190 --> 00:03:28,980
starts it does<font color="#CCCCCC"> uses these relays</font>

84
00:03:25,690 --> 00:03:32,079
internally to start the<font color="#E5E5E5"> vehicle itself</font>

85
00:03:28,980 --> 00:03:34,119
talk a little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> about the ignition it</font>

86
00:03:32,079 --> 00:03:35,709
turns<font color="#E5E5E5"> it's the ignition wire there's</font>

87
00:03:34,120 --> 00:03:37,989
actually a<font color="#E5E5E5"> physical wire called the</font>

88
00:03:35,709 --> 00:03:39,819
ignition<font color="#E5E5E5"> that turns the lights on the</font>

89
00:03:37,989 --> 00:03:41,709
cluster gauges so you can find the

90
00:03:39,819 --> 00:03:43,000
ignition really simply if<font color="#E5E5E5"> you were to</font>

91
00:03:41,709 --> 00:03:44,349
<font color="#CCCCCC">Hotwire the vehicle because all the</font>

92
00:03:43,000 --> 00:03:48,459
lights would<font color="#E5E5E5"> come on the</font><font color="#CCCCCC"> cluster the</font>

93
00:03:44,349 --> 00:03:50,679
<font color="#E5E5E5">gauges the headlights if you had them</font><font color="#CCCCCC"> it</font>

94
00:03:48,459 --> 00:03:51,970
enables the engine controller as<font color="#CCCCCC"> well so</font>

95
00:03:50,680 --> 00:03:54,250
the engine controller looks for the

96
00:03:51,970 --> 00:03:58,989
ignition<font color="#E5E5E5"> to be on before it even turns</font>

97
00:03:54,250 --> 00:04:00,940
on<font color="#CCCCCC"> itself when it's off the engine it</font>

98
00:03:58,989 --> 00:04:02,500
cannot<font color="#E5E5E5"> and will not run it needs that</font>

99
00:04:00,940 --> 00:04:03,940
<font color="#E5E5E5">ignition wire so it's very important</font>

100
00:04:02,500 --> 00:04:05,380
when<font color="#E5E5E5"> we're working these</font><font color="#CCCCCC"> things</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> it's</font>

101
00:04:03,940 --> 00:04:05,989
understand understandable the starter

102
00:04:05,380 --> 00:04:09,109
itself

103
00:04:05,989 --> 00:04:10,819
uses a relay and it starts the<font color="#CCCCCC"> engine</font>

104
00:04:09,110 --> 00:04:14,330
<font color="#E5E5E5">right it actually turns the engine over</font>

105
00:04:10,819 --> 00:04:18,079
it makes it go and it starts up<font color="#CCCCCC"> it's</font>

106
00:04:14,330 --> 00:04:21,919
also when it's active<font color="#E5E5E5"> the vehicle will</font>

107
00:04:18,079 --> 00:04:24,080
attempt<font color="#CCCCCC"> to</font><font color="#E5E5E5"> start when it's C active when</font>

108
00:04:21,918 --> 00:04:25,250
essentially that usually starts<font color="#E5E5E5"> usually</font>

109
00:04:24,080 --> 00:04:27,349
the<font color="#E5E5E5"> relay</font>

110
00:04:25,250 --> 00:04:29,540
starts and then<font color="#CCCCCC"> stop soon after the</font>

111
00:04:27,350 --> 00:04:30,800
engine starts turning<font color="#E5E5E5"> so there's a</font>

112
00:04:29,540 --> 00:04:32,449
sensor there that determines when the

113
00:04:30,800 --> 00:04:35,300
<font color="#E5E5E5">engine should</font><font color="#CCCCCC"> or the relay should shut</font>

114
00:04:32,449 --> 00:04:36,800
off as well there's also a<font color="#E5E5E5"> third device</font>

115
00:04:35,300 --> 00:04:39,470
in here it's usually the body control

116
00:04:36,800 --> 00:04:41,000
module<font color="#E5E5E5"> on modern</font><font color="#CCCCCC"> vehicles</font><font color="#E5E5E5"> when you put</font>

117
00:04:39,470 --> 00:04:42,919
the key in the vehicle<font color="#CCCCCC"> you turn the</font>

118
00:04:41,000 --> 00:04:44,780
ignition and<font color="#CCCCCC"> you turn the controller it</font>

119
00:04:42,919 --> 00:04:47,990
actually doesn't start the car anymore

120
00:04:44,780 --> 00:04:50,659
<font color="#CCCCCC">what it is is the body controller now</font>

121
00:04:47,990 --> 00:04:52,430
monitors the key itself<font color="#E5E5E5"> right it's</font>

122
00:04:50,660 --> 00:04:55,010
responsible<font color="#CCCCCC"> for</font><font color="#E5E5E5"> monitoring the key state</font>

123
00:04:52,430 --> 00:04:56,510
and and then it might send out<font color="#CCCCCC"> canned</font>

124
00:04:55,010 --> 00:04:57,500
messages if you're not familiar<font color="#E5E5E5"> with can</font>

125
00:04:56,510 --> 00:04:59,330
we're<font color="#E5E5E5"> going to go into that pretty</font>

126
00:04:57,500 --> 00:05:02,930
heavily later<font color="#E5E5E5"> but it might send out</font>

127
00:04:59,330 --> 00:05:04,849
vehicle data<font color="#CCCCCC"> network messages too</font><font color="#E5E5E5"> to the</font>

128
00:05:02,930 --> 00:05:06,800
rest of the<font color="#E5E5E5"> vehicle to let it</font><font color="#CCCCCC"> know</font>

129
00:05:04,850 --> 00:05:09,979
what's happening so<font color="#CCCCCC"> we it conveys this</font>

130
00:05:06,800 --> 00:05:11,720
key position<font color="#E5E5E5"> so no longer</font><font color="#CCCCCC"> in the past</font>

131
00:05:09,979 --> 00:05:12,919
<font color="#E5E5E5">vehicles when you turn the key it</font>

132
00:05:11,720 --> 00:05:14,840
actually was like<font color="#E5E5E5"> a switch you're</font>

133
00:05:12,919 --> 00:05:16,580
actually<font color="#E5E5E5"> turning on and off but now</font>

134
00:05:14,840 --> 00:05:18,590
there's the body<font color="#CCCCCC"> controllable</font><font color="#E5E5E5"> module</font>

135
00:05:16,580 --> 00:05:21,099
monitors the state of the key and

136
00:05:18,590 --> 00:05:23,359
determines what state it should<font color="#CCCCCC"> be in</font>

137
00:05:21,099 --> 00:05:24,560
and whether the ignition should be on

138
00:05:23,360 --> 00:05:27,280
whether<font color="#E5E5E5"> it should be cranking or</font>

139
00:05:24,560 --> 00:05:29,350
something like<font color="#E5E5E5"> that</font>

140
00:05:27,280 --> 00:05:32,950
<font color="#E5E5E5">all right what's an immobilizer so in</font>

141
00:05:29,350 --> 00:05:37,210
order<font color="#E5E5E5"> to prevent this</font><font color="#CCCCCC"> stealing of</font>

142
00:05:32,950 --> 00:05:38,740
vehicles<font color="#E5E5E5"> OMS created immobilizers they</font>

143
00:05:37,210 --> 00:05:40,960
introduced this concept where they

144
00:05:38,740 --> 00:05:43,510
actually authenticate the physical key

145
00:05:40,960 --> 00:05:46,270
itself<font color="#E5E5E5"> so immobilizers prevent or</font>

146
00:05:43,510 --> 00:05:48,370
disable<font color="#E5E5E5"> the fuel and the spark so the</font>

147
00:05:46,270 --> 00:05:50,080
engine doesn't<font color="#CCCCCC"> start right ooh</font>

148
00:05:48,370 --> 00:05:51,850
we're disabling it but guess what we're

149
00:05:50,080 --> 00:05:54,090
disabling<font color="#E5E5E5"> a software we're gonna figure</font>

150
00:05:51,850 --> 00:05:56,290
out<font color="#E5E5E5"> how software can be our friend later</font>

151
00:05:54,090 --> 00:05:58,570
<font color="#CCCCCC">ultimately the engine controller is</font><font color="#E5E5E5"> the</font>

152
00:05:56,290 --> 00:06:01,210
immobilizer<font color="#E5E5E5"> so the engine itself is what</font>

153
00:05:58,570 --> 00:06:04,960
stops<font color="#E5E5E5"> the vehicle from actually cranking</font>

154
00:06:01,210 --> 00:06:06,549
or starting<font color="#E5E5E5"> okay so the immobilizer is</font>

155
00:06:04,960 --> 00:06:08,260
essentially it's<font color="#E5E5E5"> the best way to</font>

156
00:06:06,550 --> 00:06:10,900
describe this<font color="#E5E5E5"> at least a bunch of a room</font>

157
00:06:08,260 --> 00:06:14,380
of hackers<font color="#CCCCCC"> is</font><font color="#E5E5E5"> a keychain</font><font color="#CCCCCC"> right it's a</font>

158
00:06:10,900 --> 00:06:16,840
chain of different controllers that<font color="#E5E5E5"> are</font>

159
00:06:14,380 --> 00:06:18,250
authentic ating themselves right so we

160
00:06:16,840 --> 00:06:19,690
have the engine controller which

161
00:06:18,250 --> 00:06:22,540
authenticates with other controllers

162
00:06:19,690 --> 00:06:26,770
which<font color="#E5E5E5"> gates at the end with a physical</font>

163
00:06:22,540 --> 00:06:29,020
key<font color="#E5E5E5"> itself so it prevents the the engine</font>

164
00:06:26,770 --> 00:06:31,210
from starting without<font color="#E5E5E5"> authentication so</font>

165
00:06:29,020 --> 00:06:33,729
if you don't have if the key hasn't been

166
00:06:31,210 --> 00:06:35,830
authenticated<font color="#CCCCCC"> then</font><font color="#E5E5E5"> the next module in</font>

167
00:06:33,729 --> 00:06:37,390
the change doesn't<font color="#CCCCCC"> any Cait itself which</font>

168
00:06:35,830 --> 00:06:40,510
in turn doesn't authenticate to<font color="#E5E5E5"> the</font>

169
00:06:37,390 --> 00:06:43,450
<font color="#E5E5E5">engine controller itself this prevents</font>

170
00:06:40,510 --> 00:06:45,789
the vehicle theft<font color="#E5E5E5"> if</font><font color="#CCCCCC"> the valid key isn't</font>

171
00:06:43,450 --> 00:06:48,940
present<font color="#E5E5E5"> right I mean it almost</font>

172
00:06:45,789 --> 00:06:50,710
<font color="#CCCCCC">eradicated vehicle theft in general if</font>

173
00:06:48,940 --> 00:06:52,450
<font color="#E5E5E5">you</font><font color="#CCCCCC"> look at the amount of vehicle theft</font>

174
00:06:50,710 --> 00:06:55,210
after<font color="#E5E5E5"> the immobilizer was introduced</font>

175
00:06:52,450 --> 00:06:56,979
it's been significantly less<font color="#E5E5E5"> so let's</font>

176
00:06:55,210 --> 00:07:00,070
take a look more at the<font color="#CCCCCC"> mobilization</font>

177
00:06:56,979 --> 00:07:01,990
process so here I'll sort<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this most</font>

178
00:07:00,070 --> 00:07:03,969
simplest way is<font color="#E5E5E5"> to just point out three</font>

179
00:07:01,990 --> 00:07:06,250
<font color="#CCCCCC">different controllers or</font><font color="#E5E5E5"> ECU's</font>

180
00:07:03,970 --> 00:07:08,350
electronic controllers so on the Left<font color="#E5E5E5"> we</font>

181
00:07:06,250 --> 00:07:09,910
have an issue which is actually used to

182
00:07:08,350 --> 00:07:12,640
<font color="#CCCCCC">authenticate the</font><font color="#E5E5E5"> physical key it might</font>

183
00:07:09,910 --> 00:07:14,950
be through<font color="#CCCCCC"> RFID</font><font color="#E5E5E5"> it might be through some</font>

184
00:07:12,640 --> 00:07:17,380
sort of proximity<font color="#CCCCCC"> there's a lot of</font>

185
00:07:14,950 --> 00:07:19,810
different key authentication<font color="#E5E5E5"> systems out</font>

186
00:07:17,380 --> 00:07:22,600
there<font color="#E5E5E5"> sometimes they use like our IR</font>

187
00:07:19,810 --> 00:07:23,830
infrared<font color="#E5E5E5"> things like that and then in</font>

188
00:07:22,600 --> 00:07:25,450
<font color="#E5E5E5">the middle</font><font color="#CCCCCC"> we have</font><font color="#E5E5E5"> the body control</font>

189
00:07:23,830 --> 00:07:28,599
module which typically authenticates the

190
00:07:25,450 --> 00:07:29,979
<font color="#E5E5E5">key controller itself</font><font color="#CCCCCC"> and then we have</font>

191
00:07:28,600 --> 00:07:31,300
the engine controller itself which is

192
00:07:29,979 --> 00:07:34,900
<font color="#E5E5E5">ultimately authenticates</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> body</font>

193
00:07:31,300 --> 00:07:36,310
control module<font color="#E5E5E5"> so the user this is sort</font>

194
00:07:34,900 --> 00:07:37,179
of just<font color="#CCCCCC"> a straight chain of different</font>

195
00:07:36,310 --> 00:07:39,099
things we<font color="#CCCCCC"> have three different channels</font>

196
00:07:37,180 --> 00:07:39,580
<font color="#E5E5E5">we have an RF channel typically on the</font>

197
00:07:39,099 --> 00:07:41,199
<font color="#E5E5E5">left</font>

198
00:07:39,580 --> 00:07:44,620
<font color="#E5E5E5">whether it's RFID</font>

199
00:07:41,199 --> 00:07:46,029
or<font color="#CCCCCC"> regular radio we have a can bus</font><font color="#E5E5E5"> km</font>

200
00:07:44,620 --> 00:07:47,650
bus is<font color="#E5E5E5"> just a network if you're not</font>

201
00:07:46,029 --> 00:07:49,870
familiar with<font color="#E5E5E5"> it it's like Ethernet in a</font>

202
00:07:47,650 --> 00:07:51,429
way it's a bus topology though and then

203
00:07:49,870 --> 00:07:52,930
we have a set<font color="#CCCCCC"> usually a secondary can</font>

204
00:07:51,430 --> 00:07:54,009
bus that connects the body controller to

205
00:07:52,930 --> 00:07:57,999
the<font color="#CCCCCC"> indica trailer I'll call that</font><font color="#E5E5E5"> can</font>

206
00:07:54,009 --> 00:08:00,009
<font color="#E5E5E5">bus B so first we have the the user</font>

207
00:07:57,999 --> 00:08:01,659
activates the car maybe they put the key

208
00:08:00,009 --> 00:08:02,710
in the<font color="#E5E5E5"> ignition or they open the door or</font>

209
00:08:01,659 --> 00:08:05,110
<font color="#CCCCCC">something</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> that some sort of</font>

210
00:08:02,710 --> 00:08:06,789
activation so at that<font color="#E5E5E5"> point the key su</font>

211
00:08:05,110 --> 00:08:09,550
authenticates the<font color="#E5E5E5"> key so it's ready to</font>

212
00:08:06,789 --> 00:08:11,860
<font color="#E5E5E5">go</font><font color="#CCCCCC"> right and then</font><font color="#E5E5E5"> we move over and we</font>

213
00:08:09,550 --> 00:08:13,300
<font color="#E5E5E5">actually turn the or engage the ignition</font>

214
00:08:11,860 --> 00:08:15,039
where that's hitting<font color="#E5E5E5"> the button or</font>

215
00:08:13,300 --> 00:08:16,960
starting the key turn or<font color="#CCCCCC"> something like</font>

216
00:08:15,039 --> 00:08:19,659
that<font color="#E5E5E5"> some sort of ignition is activated</font>

217
00:08:16,960 --> 00:08:22,539
by their body or to<font color="#E5E5E5"> the body controller</font>

218
00:08:19,659 --> 00:08:23,830
<font color="#E5E5E5">itself the at the say at that</font><font color="#CCCCCC"> time we</font>

219
00:08:22,539 --> 00:08:25,029
<font color="#CCCCCC">the ignition is activated the body</font>

220
00:08:23,830 --> 00:08:27,490
controller and the engine controller

221
00:08:25,029 --> 00:08:30,279
will both challenge<font color="#E5E5E5"> their respective</font>

222
00:08:27,490 --> 00:08:32,110
partners<font color="#E5E5E5"> so in this case the the body</font>

223
00:08:30,279 --> 00:08:33,939
controller will try to<font color="#E5E5E5"> challenge the</font>

224
00:08:32,110 --> 00:08:36,880
keys you and the engine controller will

225
00:08:33,940 --> 00:08:39,849
challenge the BCM so those two

226
00:08:36,880 --> 00:08:41,679
challenges<font color="#CCCCCC"> will go back across</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> key</font>

227
00:08:39,849 --> 00:08:43,300
ECU will hopefully respond to that

228
00:08:41,679 --> 00:08:45,640
challenge<font color="#CCCCCC"> is there's a</font><font color="#E5E5E5"> valid key there</font>

229
00:08:43,299 --> 00:08:47,979
it will respond<font color="#E5E5E5"> and then it'll</font><font color="#CCCCCC"> moot</font>

230
00:08:45,640 --> 00:08:52,120
<font color="#E5E5E5">it'll validate itself using some sort of</font>

231
00:08:47,980 --> 00:08:54,880
crypto algorithm<font color="#E5E5E5"> back to back to the</font><font color="#CCCCCC"> BCM</font>

232
00:08:52,120 --> 00:08:56,800
itself<font color="#E5E5E5"> so the BCM is now valid</font><font color="#CCCCCC"> and so it</font>

233
00:08:54,880 --> 00:08:58,810
will respond since<font color="#E5E5E5"> it's happy it'll take</font>

234
00:08:56,800 --> 00:09:00,760
<font color="#E5E5E5">some time</font><font color="#CCCCCC"> and respond</font><font color="#E5E5E5"> back to</font><font color="#CCCCCC"> the beat</font>

235
00:08:58,810 --> 00:09:02,140
the<font color="#E5E5E5"> engine controller from the BCM and</font>

236
00:09:00,760 --> 00:09:04,240
respond to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> android controller and</font>

237
00:09:02,140 --> 00:09:06,720
<font color="#CCCCCC">only at that point</font><font color="#E5E5E5"> is an immobilizer</font>

238
00:09:04,240 --> 00:09:08,800
bypass<font color="#E5E5E5"> so it'll enable and then then the</font>

239
00:09:06,720 --> 00:09:10,660
ignition relay will<font color="#CCCCCC"> be enabled</font>

240
00:09:08,800 --> 00:09:12,519
sometimes the BCM pulls up on<font color="#E5E5E5"> the</font>

241
00:09:10,660 --> 00:09:14,319
<font color="#E5E5E5">ignition relay and the</font><font color="#CCCCCC"> android control</font>

242
00:09:12,519 --> 00:09:17,199
will pull<font color="#CCCCCC"> down on it</font><font color="#E5E5E5"> thus causing the</font>

243
00:09:14,320 --> 00:09:20,290
relay to activate so we enable the

244
00:09:17,199 --> 00:09:22,089
starter relay as well at this<font color="#E5E5E5"> point and</font>

245
00:09:20,290 --> 00:09:25,810
the vehicle<font color="#CCCCCC"> if everything is done well</font>

246
00:09:22,089 --> 00:09:27,220
we'll start that's<font color="#E5E5E5"> the idea see that's</font>

247
00:09:25,810 --> 00:09:30,518
true but that's<font color="#CCCCCC"> sort of the general</font>

248
00:09:27,220 --> 00:09:31,990
<font color="#CCCCCC">overview of how immobilizer systems work</font>

249
00:09:30,519 --> 00:09:33,730
<font color="#CCCCCC">as we</font><font color="#E5E5E5"> have these three</font><font color="#CCCCCC"> different</font>

250
00:09:31,990 --> 00:09:35,940
controllers and they will just

251
00:09:33,730 --> 00:09:38,800
constantly be challenging each other to

252
00:09:35,940 --> 00:09:40,430
to validate if there's a valid key in

253
00:09:38,800 --> 00:09:42,260
the vehicle

254
00:09:40,430 --> 00:09:44,029
vehicle networks<font color="#CCCCCC"> so let me give you a</font>

255
00:09:42,260 --> 00:09:46,160
little<font color="#E5E5E5"> overview</font><font color="#CCCCCC"> of different physical</font>

256
00:09:44,029 --> 00:09:47,750
layers this<font color="#CCCCCC"> is more for a reference</font><font color="#E5E5E5"> but</font>

257
00:09:46,160 --> 00:09:50,089
it could be helpful<font color="#E5E5E5"> later as I talk</font>

258
00:09:47,750 --> 00:09:51,710
<font color="#E5E5E5">about other other physical layers later</font>

259
00:09:50,089 --> 00:09:53,390
in the talk<font color="#CCCCCC"> just sort of what I give</font><font color="#E5E5E5"> you</font>

260
00:09:51,710 --> 00:09:55,490
guys<font color="#CCCCCC"> a primer on different physical</font>

261
00:09:53,390 --> 00:09:58,160
layers so controller area network is a

262
00:09:55,490 --> 00:09:59,660
can bus<font color="#CCCCCC"> so when I</font><font color="#E5E5E5"> talk about that there</font>

263
00:09:58,160 --> 00:10:01,790
are a lot<font color="#CCCCCC"> of different</font><font color="#E5E5E5"> physical layers</font>

264
00:09:59,660 --> 00:10:04,040
or flavors of<font color="#CCCCCC"> canvas</font>

265
00:10:01,790 --> 00:10:06,079
there's<font color="#E5E5E5"> iso 11 8 9 8 - 2 which is called</font>

266
00:10:04,040 --> 00:10:08,390
<font color="#E5E5E5">tool where can there's fault-tolerant</font>

267
00:10:06,080 --> 00:10:10,400
can and single where it can so<font color="#E5E5E5"> these are</font>

268
00:10:08,390 --> 00:10:12,350
most common types of can buses that<font color="#E5E5E5"> will</font>

269
00:10:10,400 --> 00:10:14,750
see in vehicles<font color="#E5E5E5"> today and there's a new</font>

270
00:10:12,350 --> 00:10:17,570
one<font color="#CCCCCC"> coming out</font><font color="#E5E5E5"> it'll</font><font color="#CCCCCC"> be available</font><font color="#E5E5E5"> in the</font>

271
00:10:14,750 --> 00:10:20,120
next<font color="#E5E5E5"> couple years called</font><font color="#CCCCCC"> iso 11 8 7</font>

272
00:10:17,570 --> 00:10:22,490
which<font color="#E5E5E5"> is can FD so if you're working</font>

273
00:10:20,120 --> 00:10:25,130
<font color="#E5E5E5">with</font><font color="#CCCCCC"> canvas</font><font color="#E5E5E5"> you need to update yourself</font>

274
00:10:22,490 --> 00:10:27,320
<font color="#CCCCCC">on the new cans specification there are</font>

275
00:10:25,130 --> 00:10:28,010
some<font color="#E5E5E5"> UART networks that we will talk</font>

276
00:10:27,320 --> 00:10:30,740
<font color="#E5E5E5">about later</font>

277
00:10:28,010 --> 00:10:34,189
ISO<font color="#E5E5E5"> 91 41 not so much but we will</font>

278
00:10:30,740 --> 00:10:36,710
definitely<font color="#E5E5E5"> talk about 11 17 9 8 7 which</font>

279
00:10:34,190 --> 00:10:38,450
<font color="#E5E5E5">is called Lin bus which</font><font color="#CCCCCC"> is another</font><font color="#E5E5E5"> it's</font>

280
00:10:36,710 --> 00:10:41,029
called a local interconnect Network

281
00:10:38,450 --> 00:10:44,720
it's UART based it's a one wire<font color="#CCCCCC"> 12 volt</font>

282
00:10:41,029 --> 00:10:49,189
<font color="#E5E5E5">network that signals data across it very</font>

283
00:10:44,720 --> 00:10:51,650
slowly<font color="#CCCCCC"> typically runs about a</font><font color="#E5E5E5"> 19 1900</font>

284
00:10:49,190 --> 00:10:54,709
<font color="#E5E5E5">baaad 1900 bits per second 19.2</font>

285
00:10:51,650 --> 00:10:55,910
typically<font color="#CCCCCC"> so it's a slow network but</font>

286
00:10:54,709 --> 00:10:58,400
works great for key and key

287
00:10:55,910 --> 00:10:59,630
authentication<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then there's this</font>

288
00:10:58,400 --> 00:11:01,100
<font color="#E5E5E5">thing called Ethernet I don't know if</font>

289
00:10:59,630 --> 00:11:04,540
you're familiar<font color="#E5E5E5"> with</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> but they're</font>

290
00:11:01,100 --> 00:11:07,370
adding it to cars now so it's 10 base<font color="#E5E5E5"> TX</font>

291
00:11:04,540 --> 00:11:09,709
really standard Ethernet and vehicles

292
00:11:07,370 --> 00:11:12,380
<font color="#E5E5E5">and then we have a new specification for</font>

293
00:11:09,709 --> 00:11:14,510
Ethernet which is 10 base<font color="#E5E5E5"> T 1 or 100</font>

294
00:11:12,380 --> 00:11:16,220
base<font color="#E5E5E5"> T</font><font color="#CCCCCC"> 1 sorry which is</font><font color="#E5E5E5"> automotive</font>

295
00:11:14,510 --> 00:11:18,170
Ethernet which is a one pair Ethernet

296
00:11:16,220 --> 00:11:21,680
which is<font color="#E5E5E5"> happening now</font><font color="#CCCCCC"> and vehicles</font>

297
00:11:18,170 --> 00:11:23,599
today<font color="#E5E5E5"> we'll take a look</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> little at the</font>

298
00:11:21,680 --> 00:11:26,900
obd2<font color="#E5E5E5"> connector so how do you interface</font>

299
00:11:23,600 --> 00:11:28,610
<font color="#E5E5E5">with</font><font color="#CCCCCC"> these systems</font><font color="#E5E5E5"> we take a look at the</font>

300
00:11:26,900 --> 00:11:31,670
<font color="#E5E5E5">obd2 connector and this is my awesome</font>

301
00:11:28,610 --> 00:11:33,380
<font color="#CCCCCC">ASCII</font><font color="#E5E5E5"> alright again</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is an obd2</font>

302
00:11:31,670 --> 00:11:37,550
connector if you haven't seen one<font color="#CCCCCC"> sort</font>

303
00:11:33,380 --> 00:11:38,150
of a trapezoidal connector<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> inside</font>

304
00:11:37,550 --> 00:11:40,640
<font color="#CCCCCC">of your vehicle</font>

305
00:11:38,150 --> 00:11:41,750
typically underneath the dash if you can

306
00:11:40,640 --> 00:11:44,410
reach your hand underneath it you'll

307
00:11:41,750 --> 00:11:48,050
find that<font color="#E5E5E5"> there's a 16 pin connector</font>

308
00:11:44,410 --> 00:11:50,089
about<font color="#E5E5E5"> this big</font><font color="#CCCCCC"> if you guys can tell</font><font color="#E5E5E5"> not</font>

309
00:11:48,050 --> 00:11:51,560
very not<font color="#CCCCCC"> very large</font><font color="#E5E5E5"> but there's a lot of</font>

310
00:11:50,089 --> 00:11:53,660
it's a really common<font color="#E5E5E5"> connector it's</font>

311
00:11:51,560 --> 00:11:54,380
actually been<font color="#CCCCCC"> theirs in the</font><font color="#E5E5E5"> US since 96</font>

312
00:11:53,660 --> 00:11:57,350
<font color="#E5E5E5">in newer</font>

313
00:11:54,380 --> 00:12:01,760
pickles<font color="#E5E5E5"> in Europe in like 2005 and newer</font>

314
00:11:57,350 --> 00:12:03,680
vehicles have required this connector<font color="#CCCCCC"> so</font>

315
00:12:01,760 --> 00:12:05,270
look for it it<font color="#E5E5E5"> has a lot of information</font>

316
00:12:03,680 --> 00:12:06,770
<font color="#CCCCCC">all</font><font color="#E5E5E5"> of the</font><font color="#CCCCCC"> canned</font><font color="#E5E5E5"> buses and in fact</font>

317
00:12:05,270 --> 00:12:09,560
everything<font color="#E5E5E5"> are you talking about today</font>

318
00:12:06,770 --> 00:12:11,630
<font color="#E5E5E5">you connect to this connector and</font><font color="#CCCCCC"> for</font>

319
00:12:09,560 --> 00:12:14,530
<font color="#CCCCCC">most most of</font><font color="#E5E5E5"> the networks specifically</font>

320
00:12:11,630 --> 00:12:18,260
<font color="#CCCCCC">the can networks you</font><font color="#E5E5E5"> can find all of the</font>

321
00:12:14,530 --> 00:12:21,560
the<font color="#E5E5E5"> can bus on this connector itself so</font>

322
00:12:18,260 --> 00:12:24,740
which pins is it on<font color="#CCCCCC"> typically pin</font><font color="#E5E5E5"> 6 and</font>

323
00:12:21,560 --> 00:12:27,800
14<font color="#E5E5E5"> are</font><font color="#CCCCCC"> gonna be your ISO 11</font><font color="#E5E5E5"> 809 which is</font>

324
00:12:24,740 --> 00:12:30,130
your standard<font color="#E5E5E5"> can bus</font><font color="#CCCCCC"> sometimes we'll</font>

325
00:12:27,800 --> 00:12:33,020
see other networks<font color="#E5E5E5"> brought out to this</font>

326
00:12:30,130 --> 00:12:35,689
connector<font color="#E5E5E5"> and there's discretionary pins</font>

327
00:12:33,020 --> 00:12:38,750
that allow us to allow the manufacturer

328
00:12:35,690 --> 00:12:41,360
<font color="#CCCCCC">the vehicle to bring</font><font color="#E5E5E5"> out their own their</font>

329
00:12:38,750 --> 00:12:45,710
<font color="#CCCCCC">own individual or custom networks to</font>

330
00:12:41,360 --> 00:12:47,780
these connectors and specifically<font color="#E5E5E5"> but</font>

331
00:12:45,710 --> 00:12:49,280
<font color="#E5E5E5">not but the truth is not all networks</font>

332
00:12:47,780 --> 00:12:51,319
<font color="#CCCCCC">are brought out</font><font color="#E5E5E5"> here sometimes we have</font>

333
00:12:49,280 --> 00:12:54,140
to go to the modules<font color="#CCCCCC"> that might be</font>

334
00:12:51,320 --> 00:12:55,940
connecting<font color="#CCCCCC"> to these systems</font><font color="#E5E5E5"> and we might</font>

335
00:12:54,140 --> 00:12:58,220
actually<font color="#CCCCCC"> have to connect directly to</font>

336
00:12:55,940 --> 00:13:01,760
modules or pin or wiring harnesses at

337
00:12:58,220 --> 00:13:04,160
the module itself<font color="#E5E5E5"> standard Ethernet does</font>

338
00:13:01,760 --> 00:13:07,280
exist at this connector as well<font color="#E5E5E5"> pins 3</font>

339
00:13:04,160 --> 00:13:09,709
11 and 12 and 13-hour<font color="#CCCCCC"> Rx and</font><font color="#E5E5E5"> TX high and</font>

340
00:13:07,280 --> 00:13:11,209
low respectively<font color="#E5E5E5"> I don't recall off the</font>

341
00:13:09,710 --> 00:13:13,070
top of<font color="#E5E5E5"> my head which ones are which but</font>

342
00:13:11,210 --> 00:13:14,390
there's a lot of<font color="#E5E5E5"> there's a lot of pin</font>

343
00:13:13,070 --> 00:13:16,640
outs in fact I should<font color="#CCCCCC"> have referenced</font>

344
00:13:14,390 --> 00:13:18,680
<font color="#E5E5E5">pin out start are you it's a</font><font color="#CCCCCC"> Russian</font>

345
00:13:16,640 --> 00:13:21,740
site that indicates a lot of these obd2

346
00:13:18,680 --> 00:13:23,479
connectors<font color="#E5E5E5"> it's really helpful and pin</font>

347
00:13:21,740 --> 00:13:25,730
<font color="#CCCCCC">eight is an enable pin you put that to</font><font color="#E5E5E5"> V</font>

348
00:13:23,480 --> 00:13:27,860
bat and you'll turn your<font color="#E5E5E5"> Ethernet on if</font>

349
00:13:25,730 --> 00:13:29,450
you have Ethernet<font color="#E5E5E5"> at those pins so</font>

350
00:13:27,860 --> 00:13:31,010
<font color="#E5E5E5">always a good good idea to check that</font>

351
00:13:29,450 --> 00:13:32,510
out it's<font color="#E5E5E5"> just standard Ethernet for wire</font>

352
00:13:31,010 --> 00:13:36,170
Ethernet<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you could bring in to your</font>

353
00:13:32,510 --> 00:13:37,910
<font color="#E5E5E5">PC as well</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> often just used for</font>

354
00:13:36,170 --> 00:13:40,760
<font color="#CCCCCC">diagnostics it's</font><font color="#E5E5E5"> also referred to as</font>

355
00:13:37,910 --> 00:13:41,900
dope or<font color="#E5E5E5"> Diagnostics over IP as well so</font>

356
00:13:40,760 --> 00:13:42,400
that's<font color="#CCCCCC"> something</font><font color="#E5E5E5"> that's happening that's</font>

357
00:13:41,900 --> 00:13:44,990
new

358
00:13:42,400 --> 00:13:47,329
just<font color="#CCCCCC"> can-can frames themselves I'm going</font>

359
00:13:44,990 --> 00:13:49,190
to talk<font color="#CCCCCC"> about them a lot later can</font>

360
00:13:47,330 --> 00:13:50,810
frames have really two distinct features

361
00:13:49,190 --> 00:13:53,600
there's arbitration ID

362
00:13:50,810 --> 00:13:55,520
I call it ARB<font color="#E5E5E5"> ARB here and then there's</font>

363
00:13:53,600 --> 00:13:57,590
<font color="#CCCCCC">eight up to eight bytes of data per</font>

364
00:13:55,520 --> 00:14:01,130
frame that's the maximum<font color="#CCCCCC"> amount of data</font>

365
00:13:57,590 --> 00:14:04,280
per per frame of canvas<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> just a</font>

366
00:14:01,130 --> 00:14:06,230
limitation<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> of the canvas itself</font>

367
00:14:04,280 --> 00:14:08,089
there's also<font color="#E5E5E5"> that's an 11-bit frame and</font>

368
00:14:06,230 --> 00:14:10,550
there's also a<font color="#E5E5E5"> 29 bit</font>

369
00:14:08,089 --> 00:14:12,110
<font color="#CCCCCC">you'll</font><font color="#E5E5E5"> notice</font><font color="#CCCCCC"> just the</font><font color="#E5E5E5"> idea itself is a</font>

370
00:14:10,550 --> 00:14:13,550
little bit bigger<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> really the</font>

371
00:14:12,110 --> 00:14:15,139
<font color="#CCCCCC">difference</font><font color="#E5E5E5"> you can have up to eight</font>

372
00:14:13,550 --> 00:14:17,420
bytes I've<font color="#CCCCCC"> show</font><font color="#E5E5E5"> six here but there can</font>

373
00:14:15,139 --> 00:14:19,910
be up to<font color="#E5E5E5"> eight bytes as well on a</font><font color="#CCCCCC"> twenty</font>

374
00:14:17,420 --> 00:14:21,949
<font color="#CCCCCC">nine bit frame so we have</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> eleven bit</font>

375
00:14:19,910 --> 00:14:23,540
frame<font color="#CCCCCC"> three</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> one frame and</font><font color="#E5E5E5"> then we</font>

376
00:14:21,949 --> 00:14:25,309
have a<font color="#E5E5E5"> twenty nine bit frame and</font><font color="#CCCCCC"> you</font>

377
00:14:23,540 --> 00:14:27,620
will be working<font color="#CCCCCC"> with both those I show</font>

378
00:14:25,309 --> 00:14:30,439
some<font color="#CCCCCC"> examples later again</font><font color="#E5E5E5"> eight bytes</font>

379
00:14:27,620 --> 00:14:32,240
maximum per frame there are there's

380
00:14:30,439 --> 00:14:34,519
something<font color="#CCCCCC"> called K</font><font color="#E5E5E5"> line which looks like</font>

381
00:14:32,240 --> 00:14:36,290
<font color="#E5E5E5">this so when we talk</font><font color="#CCCCCC"> about that</font><font color="#E5E5E5"> later</font>

382
00:14:34,519 --> 00:14:39,199
<font color="#E5E5E5">it's essentially a</font><font color="#CCCCCC"> three byte header</font>

383
00:14:36,290 --> 00:14:41,449
<font color="#E5E5E5">it's UART based and it has can have an</font>

384
00:14:39,199 --> 00:14:43,069
<font color="#E5E5E5">unlimited number of data the frame size</font>

385
00:14:41,449 --> 00:14:44,059
isn't<font color="#E5E5E5"> really limited with K line when we</font>

386
00:14:43,069 --> 00:14:46,939
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that later</font>

387
00:14:44,059 --> 00:14:49,490
there's<font color="#CCCCCC"> Lin bus as well Lin bus is a</font>

388
00:14:46,939 --> 00:14:52,819
single byte header and it can have

389
00:14:49,490 --> 00:14:55,759
<font color="#E5E5E5">really from from</font><font color="#CCCCCC"> one to eight bytes of</font>

390
00:14:52,819 --> 00:14:57,620
data depending on what the actual

391
00:14:55,759 --> 00:14:58,910
<font color="#E5E5E5">identifier is there's different ranges</font>

392
00:14:57,620 --> 00:15:07,129
<font color="#CCCCCC">of identifiers that allowed to have</font>

393
00:14:58,910 --> 00:15:08,180
different<font color="#E5E5E5"> size payloads okay maybe</font><font color="#CCCCCC"> all</font>

394
00:15:07,129 --> 00:15:09,769
<font color="#CCCCCC">right we're gonna talk a little bit I</font>

395
00:15:08,180 --> 00:15:12,888
diagnosed<font color="#E5E5E5"> six I'm at delve a little bit</font>

396
00:15:09,769 --> 00:15:15,259
deeper into<font color="#E5E5E5"> the functions and</font><font color="#CCCCCC"> services</font>

397
00:15:12,889 --> 00:15:17,839
that are that<font color="#E5E5E5"> are part of your vehicle</font>

398
00:15:15,259 --> 00:15:19,879
<font color="#CCCCCC">so</font><font color="#E5E5E5"> Diagnostics</font><font color="#CCCCCC"> when we talk about</font>

399
00:15:17,839 --> 00:15:22,370
vehicles<font color="#E5E5E5"> it's a series of methods or</font>

400
00:15:19,879 --> 00:15:25,970
functions that<font color="#E5E5E5"> essentially allow you</font>

401
00:15:22,370 --> 00:15:28,730
allow you as a<font color="#E5E5E5"> as</font><font color="#CCCCCC"> a hacker or</font><font color="#E5E5E5"> engineer</font>

402
00:15:25,970 --> 00:15:30,230
<font color="#E5E5E5">or service technician to communicate</font>

403
00:15:28,730 --> 00:15:33,139
directly with<font color="#E5E5E5"> the controllers</font><font color="#CCCCCC"> in the</font>

404
00:15:30,230 --> 00:15:35,149
vehicle itself<font color="#E5E5E5"> so it's a request</font>

405
00:15:33,139 --> 00:15:36,980
response<font color="#E5E5E5"> protocol so for every time we</font>

406
00:15:35,149 --> 00:15:39,019
send a request to<font color="#CCCCCC"> the controller</font>

407
00:15:36,980 --> 00:15:40,610
we should get<font color="#E5E5E5"> a response back if the</font>

408
00:15:39,019 --> 00:15:43,459
controller's awake<font color="#CCCCCC"> and communicating</font>

409
00:15:40,610 --> 00:15:45,829
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> so user transmits a message</font>

410
00:15:43,459 --> 00:15:47,689
<font color="#CCCCCC">typically can bus is the way to do</font>

411
00:15:45,829 --> 00:15:49,489
<font color="#CCCCCC">Diagnostics on</font><font color="#E5E5E5"> via and vehicles at the</font>

412
00:15:47,689 --> 00:15:51,589
<font color="#E5E5E5">at that diagnostic connector that I</font>

413
00:15:49,490 --> 00:15:54,649
showed<font color="#CCCCCC"> you earlier</font><font color="#E5E5E5"> typically will</font>

414
00:15:51,589 --> 00:15:56,959
transmit a message<font color="#CCCCCC"> we use a transport</font>

415
00:15:54,649 --> 00:16:00,470
<font color="#CCCCCC">layer called ISO 15</font><font color="#E5E5E5"> seven six five -</font><font color="#CCCCCC"> -</font>

416
00:15:56,959 --> 00:16:03,138
almost every OEM or a manufacturer uses

417
00:16:00,470 --> 00:16:05,300
ISO 15 seven six five - - for<font color="#E5E5E5"> their</font>

418
00:16:03,139 --> 00:16:06,860
transport protocol<font color="#E5E5E5"> so it's a really if</font>

419
00:16:05,300 --> 00:16:08,899
you if there's anything you<font color="#CCCCCC"> google and</font>

420
00:16:06,860 --> 00:16:10,459
<font color="#E5E5E5">try to learn how something works</font><font color="#CCCCCC"> iso</font>

421
00:16:08,899 --> 00:16:12,259
<font color="#CCCCCC">fifteen seven six five - - is a really</font>

422
00:16:10,459 --> 00:16:14,089
good one<font color="#CCCCCC"> I'm gonna go over it as well in</font>

423
00:16:12,259 --> 00:16:15,259
this<font color="#E5E5E5"> talk so</font><font color="#CCCCCC"> that you guys aren't lost</font>

424
00:16:14,089 --> 00:16:17,029
when I'm talking about it as well

425
00:16:15,259 --> 00:16:19,970
there's another transport protocol

426
00:16:17,029 --> 00:16:21,560
called TP 2.0<font color="#CCCCCC"> X's</font><font color="#E5E5E5"> once called TP 1.6 and</font>

427
00:16:19,970 --> 00:16:23,720
<font color="#E5E5E5">TP 2.0</font><font color="#CCCCCC"> for</font>

428
00:16:21,560 --> 00:16:25,219
<font color="#E5E5E5">w so they went a little bit and made</font>

429
00:16:23,720 --> 00:16:26,960
their own transport protocol so they're

430
00:16:25,220 --> 00:16:29,300
a<font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit</font><font color="#CCCCCC"> different</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> for the</font><font color="#E5E5E5"> most</font>

431
00:16:26,960 --> 00:16:31,310
<font color="#CCCCCC">part everybody</font><font color="#E5E5E5"> else uses</font><font color="#CCCCCC"> ISO 15</font><font color="#E5E5E5"> 765 and</font>

432
00:16:29,300 --> 00:16:33,219
I'll talk about<font color="#E5E5E5"> that a little bit some</font>

433
00:16:31,310 --> 00:16:36,979
other<font color="#E5E5E5"> high-level protocols standard</font>

434
00:16:33,220 --> 00:16:38,540
Diagnostics is<font color="#E5E5E5"> iso 15 so 15 301 but then</font>

435
00:16:36,980 --> 00:16:40,610
we have this<font color="#E5E5E5"> other thing</font><font color="#CCCCCC"> called enhanced</font>

436
00:16:38,540 --> 00:16:42,800
<font color="#CCCCCC">diagnostic</font><font color="#E5E5E5"> so essentially all of the</font>

437
00:16:40,610 --> 00:16:46,190
functions that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can ever hope to do</font>

438
00:16:42,800 --> 00:16:48,290
on a<font color="#CCCCCC"> vehicle use iso enhanced agnostic</font>

439
00:16:46,190 --> 00:16:53,270
so something called<font color="#E5E5E5"> iso 14 230 which is</font>

440
00:16:48,290 --> 00:16:55,670
also called<font color="#CCCCCC"> keyword 2014 2 to</font><font color="#E5E5E5"> 9</font><font color="#CCCCCC"> & GM</font><font color="#E5E5E5"> LAN</font>

441
00:16:53,270 --> 00:16:57,230
<font color="#E5E5E5">for</font><font color="#CCCCCC"> General Motors</font><font color="#E5E5E5"> in the United States</font>

442
00:16:55,670 --> 00:17:00,410
a<font color="#E5E5E5"> little bit in the US and Europe</font><font color="#CCCCCC"> to</font>

443
00:16:57,230 --> 00:17:01,610
<font color="#CCCCCC">Opel such here's a</font><font color="#E5E5E5"> small list of</font>

444
00:17:00,410 --> 00:17:03,439
interesting services that<font color="#E5E5E5"> I'm going to</font>

445
00:17:01,610 --> 00:17:04,730
be<font color="#CCCCCC"> talking</font><font color="#E5E5E5"> about later</font><font color="#CCCCCC"> and so when I</font>

446
00:17:03,440 --> 00:17:06,439
<font color="#CCCCCC">talk about services</font><font color="#E5E5E5"> I'm really talking</font>

447
00:17:04,730 --> 00:17:08,689
<font color="#CCCCCC">about individual functions that</font><font color="#E5E5E5"> these</font>

448
00:17:06,439 --> 00:17:10,490
<font color="#E5E5E5">controllers can do right and these this</font>

449
00:17:08,689 --> 00:17:12,319
is the<font color="#CCCCCC"> this is</font><font color="#E5E5E5"> the these are things that</font>

450
00:17:10,490 --> 00:17:14,420
you can actually<font color="#E5E5E5"> go to a vehicle</font><font color="#CCCCCC"> and ask</font>

451
00:17:12,319 --> 00:17:16,699
the vehicle to do<font color="#E5E5E5"> so start</font><font color="#CCCCCC"> Diagnostics</font>

452
00:17:14,420 --> 00:17:18,230
<font color="#E5E5E5">or initiate Diagnostics is a way to ask</font>

453
00:17:16,699 --> 00:17:20,630
the controller to do something

454
00:17:18,230 --> 00:17:22,699
interesting<font color="#CCCCCC"> to turn it</font><font color="#E5E5E5"> into a specific</font>

455
00:17:20,630 --> 00:17:23,750
mode<font color="#E5E5E5"> there's something called ECU reset</font>

456
00:17:22,699 --> 00:17:24,860
which you can imagine how much fun<font color="#E5E5E5"> you</font>

457
00:17:23,750 --> 00:17:26,240
can<font color="#E5E5E5"> have when you're driving</font><font color="#CCCCCC"> down the</font>

458
00:17:24,859 --> 00:17:29,629
<font color="#CCCCCC">road and</font><font color="#E5E5E5"> you're resetting your ECU</font>

459
00:17:26,240 --> 00:17:31,940
at speeds it's really fun reading codes

460
00:17:29,630 --> 00:17:33,440
<font color="#E5E5E5">there's something called</font><font color="#CCCCCC"> DTC s sometimes</font>

461
00:17:31,940 --> 00:17:35,750
<font color="#CCCCCC">you can read these codes from the</font>

462
00:17:33,440 --> 00:17:36,860
<font color="#CCCCCC">controllers themselves communication</font>

463
00:17:35,750 --> 00:17:38,450
control you can<font color="#CCCCCC"> actually tell</font>

464
00:17:36,860 --> 00:17:41,209
controllers<font color="#E5E5E5"> to stop transmitting or to</font>

465
00:17:38,450 --> 00:17:43,040
transmit their information read

466
00:17:41,210 --> 00:17:44,810
parameter by ID so<font color="#CCCCCC"> you can actually get</font>

467
00:17:43,040 --> 00:17:47,149
information<font color="#E5E5E5"> or read data directly from</font>

468
00:17:44,810 --> 00:17:49,399
like static or dynamic information<font color="#CCCCCC"> from</font>

469
00:17:47,150 --> 00:17:50,990
the vehicle itself<font color="#E5E5E5"> read memory by</font>

470
00:17:49,400 --> 00:17:52,450
address that's right you can<font color="#CCCCCC"> actually</font>

471
00:17:50,990 --> 00:17:56,179
ask<font color="#E5E5E5"> a controller</font>

472
00:17:52,450 --> 00:17:58,429
to give you its memory<font color="#CCCCCC"> and I don't</font><font color="#E5E5E5"> want</font>

473
00:17:56,179 --> 00:18:00,740
<font color="#E5E5E5">to under emphasize this this is</font>

474
00:17:58,429 --> 00:18:03,200
literally the<font color="#E5E5E5"> best service that's ever</font>

475
00:18:00,740 --> 00:18:06,830
existed<font color="#CCCCCC"> especially</font><font color="#E5E5E5"> for somebody who's</font>

476
00:18:03,200 --> 00:18:08,600
getting<font color="#E5E5E5"> into like embedded systems start</font>

477
00:18:06,830 --> 00:18:10,820
with automotive if you talk to<font color="#E5E5E5"> these if</font>

478
00:18:08,600 --> 00:18:12,500
you saw the lack of talks ago talking

479
00:18:10,820 --> 00:18:14,928
<font color="#E5E5E5">about</font><font color="#CCCCCC"> how you had</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> D</font><font color="#E5E5E5"> you know D solder</font>

480
00:18:12,500 --> 00:18:17,410
a chip<font color="#E5E5E5"> from</font><font color="#CCCCCC"> the board and and hook up</font>

481
00:18:14,929 --> 00:18:19,850
devices to it to<font color="#E5E5E5"> read the memory from it</font>

482
00:18:17,410 --> 00:18:21,080
<font color="#CCCCCC">with cars we make it a lot</font><font color="#E5E5E5"> easier we</font>

483
00:18:19,850 --> 00:18:22,850
just give you<font color="#CCCCCC"> a service and</font><font color="#E5E5E5"> you just</font>

484
00:18:21,080 --> 00:18:25,669
<font color="#E5E5E5">read it it's pretty simple for the most</font>

485
00:18:22,850 --> 00:18:27,169
<font color="#CCCCCC">part</font><font color="#E5E5E5"> I'll</font><font color="#CCCCCC"> show you why in a little bit</font>

486
00:18:25,670 --> 00:18:28,640
but<font color="#E5E5E5"> for the most part for</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot of</font>

487
00:18:27,170 --> 00:18:30,320
controllers you could just ask it for

488
00:18:28,640 --> 00:18:32,900
<font color="#E5E5E5">the memory and it'll just give it to you</font>

489
00:18:30,320 --> 00:18:34,280
it's quite<font color="#E5E5E5"> nice there changing that the</font>

490
00:18:32,900 --> 00:18:35,330
good<font color="#E5E5E5"> news good news is though they do</font>

491
00:18:34,280 --> 00:18:37,160
more talk sir

492
00:18:35,330 --> 00:18:39,139
fixing these problems<font color="#E5E5E5"> one is called</font>

493
00:18:37,160 --> 00:18:40,340
security<font color="#E5E5E5"> access</font><font color="#CCCCCC"> the way they're fixing</font>

494
00:18:39,140 --> 00:18:42,080
the problem by doing<font color="#CCCCCC"> this thing called</font>

495
00:18:40,340 --> 00:18:45,350
security access<font color="#E5E5E5"> where you actually have</font>

496
00:18:42,080 --> 00:18:47,060
to<font color="#E5E5E5"> do a secure seed key exchange</font>

497
00:18:45,350 --> 00:18:49,580
<font color="#CCCCCC">I mean security access allows you to do</font>

498
00:18:47,060 --> 00:18:50,659
that<font color="#E5E5E5"> and one there's</font><font color="#CCCCCC"> another</font><font color="#E5E5E5"> one called</font>

499
00:18:49,580 --> 00:18:52,970
<font color="#E5E5E5">input-output control where you can</font>

500
00:18:50,660 --> 00:18:55,160
<font color="#E5E5E5">actually control like things like lights</font>

501
00:18:52,970 --> 00:18:59,450
<font color="#E5E5E5">and horn and a bunch of other features</font>

502
00:18:55,160 --> 00:19:01,610
<font color="#E5E5E5">as well</font><font color="#CCCCCC"> and last is routine control I</font>

503
00:18:59,450 --> 00:19:03,350
think it's<font color="#E5E5E5"> less routine control allows</font>

504
00:19:01,610 --> 00:19:05,179
you to actually activate certain

505
00:19:03,350 --> 00:19:07,639
functions sort of macros if you will<font color="#E5E5E5"> of</font>

506
00:19:05,180 --> 00:19:09,260
series<font color="#E5E5E5"> of functions</font><font color="#CCCCCC"> and we'll talk about</font>

507
00:19:07,640 --> 00:19:11,390
<font color="#E5E5E5">that a little bit later</font><font color="#CCCCCC"> oh and last</font><font color="#E5E5E5"> this</font>

508
00:19:09,260 --> 00:19:13,460
texture present which<font color="#CCCCCC"> Oh</font><font color="#E5E5E5"> second to last</font>

509
00:19:11,390 --> 00:19:15,080
<font color="#E5E5E5">is Testament and then reserved for OEM</font>

510
00:19:13,460 --> 00:19:19,310
they actually have their<font color="#CCCCCC"> own range of</font>

511
00:19:15,080 --> 00:19:21,980
like<font color="#E5E5E5"> future use cases or like like you</font>

512
00:19:19,310 --> 00:19:24,889
<font color="#E5E5E5">know very very</font><font color="#CCCCCC"> specific to their to</font>

513
00:19:21,980 --> 00:19:27,920
<font color="#E5E5E5">their own internal functions</font><font color="#CCCCCC"> a range of</font>

514
00:19:24,890 --> 00:19:31,940
<font color="#E5E5E5">services</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> they can use as well so</font>

515
00:19:27,920 --> 00:19:34,400
let's dissect a single frame so so let's

516
00:19:31,940 --> 00:19:39,800
take a look at a single<font color="#E5E5E5"> frame</font><font color="#CCCCCC"> of canvas</font>

517
00:19:34,400 --> 00:19:44,600
<font color="#CCCCCC">so again we have an 11-bit message 7000</font>

518
00:19:39,800 --> 00:19:48,230
<font color="#CCCCCC">322 f 1 2000</font><font color="#E5E5E5"> 0 0 0 0 0 so that's</font><font color="#CCCCCC"> the max</font>

519
00:19:44,600 --> 00:19:51,949
size so it's a single<font color="#E5E5E5"> frame of canvas</font>

520
00:19:48,230 --> 00:19:55,610
<font color="#CCCCCC">and this</font><font color="#E5E5E5"> is actually a request to read</font>

521
00:19:51,950 --> 00:19:57,650
so if we look at service 22<font color="#E5E5E5"> you see the</font>

522
00:19:55,610 --> 00:20:01,010
<font color="#E5E5E5">22 there this is a request to read a</font>

523
00:19:57,650 --> 00:20:02,120
parameter ID called<font color="#CCCCCC"> F 120 so at the very</font>

524
00:20:01,010 --> 00:20:03,860
end of<font color="#E5E5E5"> it we have this thing called</font>

525
00:20:02,120 --> 00:20:05,300
padding which is just we fill it in with

526
00:20:03,860 --> 00:20:07,550
<font color="#E5E5E5">zeros</font><font color="#CCCCCC"> you can fill it in with</font><font color="#E5E5E5"> whatever</font>

527
00:20:05,300 --> 00:20:08,840
value you want<font color="#CCCCCC"> it</font><font color="#E5E5E5"> doesn't matter it</font>

528
00:20:07,550 --> 00:20:12,020
doesn't<font color="#CCCCCC"> really count towards the message</font>

529
00:20:08,840 --> 00:20:15,350
itself<font color="#CCCCCC"> and then next we have the</font>

530
00:20:12,020 --> 00:20:17,090
parameter<font color="#E5E5E5"> ID itself so the</font><font color="#CCCCCC"> F 120 is a</font>

531
00:20:15,350 --> 00:20:18,800
parameter ID in this case we're reading

532
00:20:17,090 --> 00:20:20,780
the<font color="#E5E5E5"> VIN from this particular OEM</font>

533
00:20:18,800 --> 00:20:23,030
<font color="#E5E5E5">different OEMs this pit will mean</font>

534
00:20:20,780 --> 00:20:25,370
<font color="#E5E5E5">something else</font><font color="#CCCCCC"> so if I</font><font color="#E5E5E5"> use this on a</font><font color="#CCCCCC"> 4</font>

535
00:20:23,030 --> 00:20:27,139
if I use it<font color="#CCCCCC"> on a Renault or if I use it</font>

536
00:20:25,370 --> 00:20:29,239
<font color="#CCCCCC">on a VW it's gonna</font><font color="#E5E5E5"> be a completely</font>

537
00:20:27,140 --> 00:20:30,410
<font color="#CCCCCC">different parameter</font><font color="#E5E5E5"> so that's something</font>

538
00:20:29,240 --> 00:20:32,720
<font color="#E5E5E5">you got to learn that's unique</font><font color="#CCCCCC"> to each</font>

539
00:20:30,410 --> 00:20:36,890
<font color="#CCCCCC">OM but the services themselves like this</font>

540
00:20:32,720 --> 00:20:40,040
service 22 service ID 22 is<font color="#CCCCCC"> request paid</font>

541
00:20:36,890 --> 00:20:42,230
so I gave it a paid<font color="#CCCCCC"> f1 20 and I used</font><font color="#E5E5E5"> sir</font>

542
00:20:40,040 --> 00:20:45,050
that particular service 22 to request

543
00:20:42,230 --> 00:20:46,940
the bid<font color="#CCCCCC"> and then the next byte left is</font>

544
00:20:45,050 --> 00:20:48,860
really<font color="#E5E5E5"> the transport protocol that ISO</font>

545
00:20:46,940 --> 00:20:50,690
15 7 6 5<font color="#CCCCCC"> - 2</font>

546
00:20:48,860 --> 00:20:52,639
this case there's a three there that's

547
00:20:50,690 --> 00:20:56,600
how we know that<font color="#CCCCCC"> there's three bites</font>

548
00:20:52,640 --> 00:20:59,059
inside of the frame<font color="#CCCCCC"> so 322 F 120 is the</font>

549
00:20:56,600 --> 00:21:01,610
entire<font color="#E5E5E5"> message and the zero indicates</font>

550
00:20:59,059 --> 00:21:03,678
that this entire<font color="#E5E5E5"> message will live in a</font>

551
00:21:01,610 --> 00:21:05,059
single<font color="#E5E5E5"> frame so we put a zero</font><font color="#CCCCCC"> on the</font>

552
00:21:03,679 --> 00:21:06,860
<font color="#E5E5E5">first nibble</font><font color="#CCCCCC"> of the first bite to</font>

553
00:21:05,059 --> 00:21:08,330
indicate that<font color="#E5E5E5"> and the last thing that</font>

554
00:21:06,860 --> 00:21:10,129
the actual<font color="#E5E5E5"> address</font><font color="#CCCCCC"> itself is the</font>

555
00:21:08,330 --> 00:21:11,809
controller ID<font color="#E5E5E5"> it's the controller</font><font color="#CCCCCC"> that</font>

556
00:21:10,130 --> 00:21:13,160
we want to<font color="#E5E5E5"> talk to so if individual</font>

557
00:21:11,809 --> 00:21:14,928
controllers will have their own

558
00:21:13,160 --> 00:21:16,910
<font color="#E5E5E5">identifier that you can talk to them in</font>

559
00:21:14,929 --> 00:21:18,559
this case<font color="#CCCCCC"> 70</font><font color="#E5E5E5"> zero is the engine control</font>

560
00:21:16,910 --> 00:21:20,960
<font color="#E5E5E5">that's pretty</font><font color="#CCCCCC"> universal</font><font color="#E5E5E5"> across all</font>

561
00:21:18,559 --> 00:21:25,100
vehicles really<font color="#E5E5E5"> throughout</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> world on</font>

562
00:21:20,960 --> 00:21:27,320
<font color="#CCCCCC">CANbus 70</font><font color="#E5E5E5"> 0 entry controllers so let's</font>

563
00:21:25,100 --> 00:21:28,879
take a look<font color="#CCCCCC"> at a multi frame message</font><font color="#E5E5E5"> as</font>

564
00:21:27,320 --> 00:21:31,250
well so<font color="#E5E5E5"> I'm teaching</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> little bit about</font>

565
00:21:28,880 --> 00:21:32,960
this so<font color="#E5E5E5"> here's a multi frame message</font>

566
00:21:31,250 --> 00:21:35,330
itself so we have<font color="#E5E5E5"> essentially four</font>

567
00:21:32,960 --> 00:21:38,120
<font color="#E5E5E5">messages in this request or is this</font>

568
00:21:35,330 --> 00:21:40,010
<font color="#E5E5E5">actually a response</font><font color="#CCCCCC"> so we did</font><font color="#E5E5E5"> a VIN</font>

569
00:21:38,120 --> 00:21:41,989
request and maybe we want<font color="#E5E5E5"> to get the VIN</font>

570
00:21:40,010 --> 00:21:44,540
this is like a VIN returning back to<font color="#E5E5E5"> us</font>

571
00:21:41,990 --> 00:21:45,950
so the VIN itself is 17 characters<font color="#E5E5E5"> the</font>

572
00:21:44,540 --> 00:21:47,870
VIN if you don't know is<font color="#E5E5E5"> the vehicle</font>

573
00:21:45,950 --> 00:21:49,490
<font color="#CCCCCC">identification number</font><font color="#E5E5E5"> and it's the</font>

574
00:21:47,870 --> 00:21:52,129
<font color="#E5E5E5">number</font><font color="#CCCCCC"> that uniquely identifies each</font>

575
00:21:49,490 --> 00:21:55,340
vehicle<font color="#CCCCCC"> out there in</font><font color="#E5E5E5"> the world</font><font color="#CCCCCC"> so if you</font>

576
00:21:52,130 --> 00:21:57,110
wanted to<font color="#E5E5E5"> request the VIN</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> the</font>

577
00:21:55,340 --> 00:21:58,760
<font color="#E5E5E5">message above which the first one I</font>

578
00:21:57,110 --> 00:22:01,040
showed<font color="#CCCCCC"> you</font><font color="#E5E5E5"> is how you request it and</font>

579
00:21:58,760 --> 00:22:02,750
then below is how it<font color="#E5E5E5"> returned back</font><font color="#CCCCCC"> to</font>

580
00:22:01,040 --> 00:22:05,990
you and it returned back<font color="#CCCCCC"> to in multiple</font>

581
00:22:02,750 --> 00:22:08,030
frames right<font color="#E5E5E5"> so we have 78 is actually a</font>

582
00:22:05,990 --> 00:22:09,169
response<font color="#E5E5E5"> ID from the controller and then</font>

583
00:22:08,030 --> 00:22:11,750
we have a bunch of<font color="#E5E5E5"> other</font><font color="#CCCCCC"> data and I'll</font>

584
00:22:09,169 --> 00:22:14,150
go<font color="#E5E5E5"> into that a little bit so</font><font color="#CCCCCC"> let's take</font>

585
00:22:11,750 --> 00:22:18,470
a look at the first frame<font color="#E5E5E5"> of this multi</font>

586
00:22:14,150 --> 00:22:20,540
frame request<font color="#CCCCCC"> the first the</font><font color="#E5E5E5"> VIN</font>

587
00:22:18,470 --> 00:22:22,490
characters will be<font color="#CCCCCC"> at the end they'll</font>

588
00:22:20,540 --> 00:22:24,710
actually be part<font color="#E5E5E5"> of the payload of</font><font color="#CCCCCC"> the</font>

589
00:22:22,490 --> 00:22:27,110
frame itself<font color="#E5E5E5"> so the first three</font>

590
00:22:24,710 --> 00:22:29,090
characters<font color="#CCCCCC"> there then again we have that</font>

591
00:22:27,110 --> 00:22:31,189
parameter ID that<font color="#E5E5E5"> F 120 is actually</font>

592
00:22:29,090 --> 00:22:32,720
<font color="#CCCCCC">gonna be replayed back to us in there in</font>

593
00:22:31,190 --> 00:22:35,720
our response that's coming back<font color="#E5E5E5"> from the</font>

594
00:22:32,720 --> 00:22:37,370
controller<font color="#E5E5E5"> itself</font><font color="#CCCCCC"> we have a pot this is</font>

595
00:22:35,720 --> 00:22:38,929
<font color="#E5E5E5">a</font><font color="#CCCCCC"> positive response</font><font color="#E5E5E5"> and how do we know</font>

596
00:22:37,370 --> 00:22:40,219
it's a positive<font color="#E5E5E5"> response</font><font color="#CCCCCC"> well</font><font color="#E5E5E5"> our</font>

597
00:22:38,929 --> 00:22:42,770
initial<font color="#E5E5E5"> if you recall</font><font color="#CCCCCC"> our initial</font>

598
00:22:40,220 --> 00:22:45,460
request was 22 that's a service<font color="#E5E5E5"> if you</font>

599
00:22:42,770 --> 00:22:48,440
add<font color="#E5E5E5"> 40 hex to that 22</font><font color="#CCCCCC"> it's you get 60 to</font>

600
00:22:45,460 --> 00:22:50,720
<font color="#E5E5E5">that 40 hex - plus the original service</font>

601
00:22:48,440 --> 00:22:52,490
<font color="#E5E5E5">equals positive response so that's how</font>

602
00:22:50,720 --> 00:22:54,020
we<font color="#E5E5E5"> know</font><font color="#CCCCCC"> it's a positive</font><font color="#E5E5E5"> meaning</font><font color="#CCCCCC"> it's</font>

603
00:22:52,490 --> 00:22:55,669
successful I'll talk about<font color="#E5E5E5"> negative</font>

604
00:22:54,020 --> 00:22:59,960
responses later and what it<font color="#E5E5E5"> means when</font>

605
00:22:55,669 --> 00:23:02,570
you<font color="#CCCCCC"> get</font><font color="#E5E5E5"> those the next the the the</font>

606
00:22:59,960 --> 00:23:06,020
<font color="#E5E5E5">previous three nibbles or</font>

607
00:23:02,570 --> 00:23:07,100
<font color="#E5E5E5">12 bits</font><font color="#CCCCCC"> 0 1 4</font><font color="#E5E5E5"> indicates the data length</font>

608
00:23:06,020 --> 00:23:09,170
<font color="#E5E5E5">of a message</font>

609
00:23:07,100 --> 00:23:10,399
now it's a<font color="#CCCCCC"> multiframe message so we're</font>

610
00:23:09,170 --> 00:23:13,010
gonna<font color="#E5E5E5"> need a little</font><font color="#CCCCCC"> bit more data</font><font color="#E5E5E5"> to</font>

611
00:23:10,400 --> 00:23:16,010
describe how many bytes are<font color="#E5E5E5"> gonna be in</font>

612
00:23:13,010 --> 00:23:19,040
a total message<font color="#E5E5E5"> in this case 14 hex 20</font>

613
00:23:16,010 --> 00:23:20,690
bytes and the one that first<font color="#E5E5E5"> nibble the</font>

614
00:23:19,040 --> 00:23:23,180
first frame indicates the frame type

615
00:23:20,690 --> 00:23:25,520
again<font color="#E5E5E5"> and this is the first frame of a</font>

616
00:23:23,180 --> 00:23:28,760
multi frame message so the<font color="#CCCCCC"> 1 indicates</font>

617
00:23:25,520 --> 00:23:31,220
the first frame the 78 we had 70<font color="#E5E5E5"> 0</font>

618
00:23:28,760 --> 00:23:32,780
before 78 is actually still from the

619
00:23:31,220 --> 00:23:34,250
engine controller<font color="#CCCCCC"> so again this is</font>

620
00:23:32,780 --> 00:23:36,200
Diagnostics so we're sending<font color="#E5E5E5"> a request</font>

621
00:23:34,250 --> 00:23:39,770
to the<font color="#E5E5E5"> controller it's returning a</font>

622
00:23:36,200 --> 00:23:43,580
response back<font color="#E5E5E5"> it uses 78 to return all</font>

623
00:23:39,770 --> 00:23:45,440
of<font color="#E5E5E5"> its responses back to us so the next</font>

624
00:23:43,580 --> 00:23:47,300
<font color="#E5E5E5">byte</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> the next frame is what we call</font>

625
00:23:45,440 --> 00:23:50,420
a flow control frame it's us sending

626
00:23:47,300 --> 00:23:54,470
again we have padding<font color="#CCCCCC"> we</font><font color="#E5E5E5"> actually have a</font>

627
00:23:50,420 --> 00:23:55,220
<font color="#E5E5E5">separation time we have block</font><font color="#CCCCCC"> seperation</font>

628
00:23:54,470 --> 00:23:57,800
I'm going to go through this because

629
00:23:55,220 --> 00:24:00,530
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> that is important</font><font color="#E5E5E5"> we have a</font>

630
00:23:57,800 --> 00:24:02,810
continue and we have the frame type 3

631
00:24:00,530 --> 00:24:04,639
indicating<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> a flow control frame and</font>

632
00:24:02,810 --> 00:24:06,440
we're<font color="#E5E5E5"> talking to the engine controller</font>

633
00:24:04,640 --> 00:24:08,420
so if you<font color="#E5E5E5"> recall we send a request to</font>

634
00:24:06,440 --> 00:24:10,640
<font color="#CCCCCC">the engine controller</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> sum</font><font color="#E5E5E5"> as the</font>

635
00:24:08,420 --> 00:24:14,210
first frame back<font color="#E5E5E5"> well we need some rules</font>

636
00:24:10,640 --> 00:24:15,590
<font color="#E5E5E5">to tell that controller that hey you're</font>

637
00:24:14,210 --> 00:24:16,910
gonna we're gonna we want to see the

638
00:24:15,590 --> 00:24:18,949
rest<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> message but we want to</font>

639
00:24:16,910 --> 00:24:22,220
receive it at a<font color="#E5E5E5"> certain speed that's the</font>

640
00:24:18,950 --> 00:24:23,780
time we<font color="#E5E5E5"> want to we want to have</font><font color="#CCCCCC"> you wait</font>

641
00:24:22,220 --> 00:24:25,370
a certain<font color="#CCCCCC"> period of time before we send</font>

642
00:24:23,780 --> 00:24:27,470
another<font color="#E5E5E5"> flow control that's a block</font>

643
00:24:25,370 --> 00:24:29,659
separation and<font color="#CCCCCC"> we want you to continue</font>

644
00:24:27,470 --> 00:24:32,360
that's<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Casteneda continuation frame</font>

645
00:24:29,660 --> 00:24:34,630
the<font color="#E5E5E5"> 0</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the 3</font><font color="#CCCCCC"> 0 and</font><font color="#E5E5E5"> that byte so</font>

646
00:24:32,360 --> 00:24:36,740
there's a lot<font color="#CCCCCC"> of information there so</font>

647
00:24:34,630 --> 00:24:38,870
<font color="#CCCCCC">then we get the</font><font color="#E5E5E5"> consecutive frames</font>

648
00:24:36,740 --> 00:24:40,910
coming back to<font color="#CCCCCC"> us we</font><font color="#E5E5E5"> get the next</font><font color="#CCCCCC"> 7</font>

649
00:24:38,870 --> 00:24:42,949
characters<font color="#E5E5E5"> of the VIN we get a row</font>

650
00:24:40,910 --> 00:24:45,410
encounter to indicate that the this<font color="#CCCCCC"> is</font>

651
00:24:42,950 --> 00:24:49,430
the first<font color="#CCCCCC"> of the of the first frame of</font>

652
00:24:45,410 --> 00:24:50,990
<font color="#CCCCCC">the</font><font color="#E5E5E5"> consecutive</font><font color="#CCCCCC"> frames we got a 2 to</font>

653
00:24:49,430 --> 00:24:53,210
indicate<font color="#CCCCCC"> this is a consecutive frame</font>

654
00:24:50,990 --> 00:24:54,710
because the<font color="#E5E5E5"> frame type is</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> 2 and then</font>

655
00:24:53,210 --> 00:24:57,830
it comes<font color="#E5E5E5"> from the Android controller so</font>

656
00:24:54,710 --> 00:24:59,870
it's 78<font color="#CCCCCC"> is our response and then we get</font>

657
00:24:57,830 --> 00:25:02,060
the final<font color="#E5E5E5"> frame and our multi frame</font>

658
00:24:59,870 --> 00:25:03,949
message which is<font color="#CCCCCC"> the remaining data</font><font color="#E5E5E5"> and</font>

659
00:25:02,060 --> 00:25:05,540
the VIN<font color="#E5E5E5"> and then just like the one</font>

660
00:25:03,950 --> 00:25:08,420
before it's got the rolling counter

661
00:25:05,540 --> 00:25:10,580
increments by 1 and then<font color="#E5E5E5"> we get a frame</font>

662
00:25:08,420 --> 00:25:12,790
our frame type is still<font color="#CCCCCC"> a</font><font color="#E5E5E5"> 2 because it's</font>

663
00:25:10,580 --> 00:25:15,260
still a consecutive frame<font color="#CCCCCC"> in all</font><font color="#E5E5E5"> frames</font>

664
00:25:12,790 --> 00:25:16,159
<font color="#E5E5E5">associated with this</font><font color="#CCCCCC"> message will be to</font>

665
00:25:15,260 --> 00:25:18,850
there

666
00:25:16,160 --> 00:25:18,850
<font color="#CCCCCC">seventy-eight</font>

667
00:25:19,170 --> 00:25:23,500
so now let's talk a<font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit about how</font>

668
00:25:21,460 --> 00:25:25,210
we borrow cars<font color="#E5E5E5"> right so we've gotten all</font>

669
00:25:23,500 --> 00:25:26,800
<font color="#E5E5E5">these things</font><font color="#CCCCCC"> so let's talk about</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> of</font>

670
00:25:25,210 --> 00:25:28,960
the methods<font color="#CCCCCC"> that might you might use</font>

671
00:25:26,800 --> 00:25:31,540
some<font color="#CCCCCC"> of the ideas that</font><font color="#E5E5E5"> you might use</font><font color="#CCCCCC"> to</font>

672
00:25:28,960 --> 00:25:33,280
borrow a vehicle<font color="#E5E5E5"> so remember starting</font>

673
00:25:31,540 --> 00:25:36,309
systems are<font color="#E5E5E5"> controlled by modules</font>

674
00:25:33,280 --> 00:25:38,559
<font color="#E5E5E5">electronic control modules</font><font color="#CCCCCC"> very few</font>

675
00:25:36,309 --> 00:25:40,300
physical<font color="#E5E5E5"> methods are left to prevent the</font>

676
00:25:38,559 --> 00:25:43,180
theft<font color="#E5E5E5"> of vehicles what I mean by that is</font>

677
00:25:40,300 --> 00:25:45,790
there's<font color="#CCCCCC"> no they used to be</font><font color="#E5E5E5"> like locks on</font>

678
00:25:43,180 --> 00:25:47,950
the<font color="#E5E5E5"> steering</font><font color="#CCCCCC"> wheel and locks to prevent</font>

679
00:25:45,790 --> 00:25:50,530
<font color="#CCCCCC">you from moving the vehicle out of park</font>

680
00:25:47,950 --> 00:25:52,990
<font color="#E5E5E5">all of those are easily bypassed or just</font>

681
00:25:50,530 --> 00:25:55,480
removed from vehicles nowaday because of

682
00:25:52,990 --> 00:25:56,980
immobilizers<font color="#E5E5E5"> so it's very rare to</font><font color="#CCCCCC"> have</font>

683
00:25:55,480 --> 00:26:00,429
these steering wheel locks or column

684
00:25:56,980 --> 00:26:02,260
locks<font color="#E5E5E5"> etc</font><font color="#CCCCCC"> physical</font><font color="#E5E5E5"> keys that may be</font>

685
00:26:00,429 --> 00:26:06,580
<font color="#E5E5E5">replaced by push buttons</font><font color="#CCCCCC"> or electronic</font>

686
00:26:02,260 --> 00:26:09,580
keys so proximity<font color="#E5E5E5"> keys are nice we can</font>

687
00:26:06,580 --> 00:26:12,909
do these<font color="#E5E5E5"> we can proximity keys we can</font>

688
00:26:09,580 --> 00:26:13,928
relay<font color="#CCCCCC"> we can do these relay attacks</font>

689
00:26:12,910 --> 00:26:16,210
which I'll go<font color="#CCCCCC"> into a little</font><font color="#E5E5E5"> bit more</font>

690
00:26:13,929 --> 00:26:18,580
<font color="#E5E5E5">about how we</font><font color="#CCCCCC"> can extend</font><font color="#E5E5E5"> the range of</font>

691
00:26:16,210 --> 00:26:20,800
<font color="#E5E5E5">these attacks or we can actually extend</font>

692
00:26:18,580 --> 00:26:24,220
<font color="#E5E5E5">the range of your key fob now up to 100</font>

693
00:26:20,800 --> 00:26:27,070
1.5 kilometers<font color="#CCCCCC"> line-of-sight which</font><font color="#E5E5E5"> is</font>

694
00:26:24,220 --> 00:26:29,220
nice<font color="#CCCCCC"> and keys of course are programmable</font>

695
00:26:27,070 --> 00:26:31,480
<font color="#E5E5E5">right manufacturers don't want people to</font>

696
00:26:29,220 --> 00:26:33,550
when they lose all<font color="#CCCCCC"> their keys of their</font>

697
00:26:31,480 --> 00:26:35,350
vehicle to<font color="#E5E5E5"> just have to</font><font color="#CCCCCC"> replace the</font>

698
00:26:33,550 --> 00:26:37,149
<font color="#E5E5E5">entire vehicle or whole modules and the</font>

699
00:26:35,350 --> 00:26:39,820
vehicle it's very<font color="#CCCCCC"> expensive</font><font color="#E5E5E5"> so we need</font>

700
00:26:37,150 --> 00:26:42,640
to be<font color="#CCCCCC"> 8 make these programmable so keys</font>

701
00:26:39,820 --> 00:26:45,280
are a double to your vehicle using

702
00:26:42,640 --> 00:26:48,010
<font color="#E5E5E5">programming methods as well so here's a</font>

703
00:26:45,280 --> 00:26:52,178
key programmer<font color="#E5E5E5"> obviously look at that</font>

704
00:26:48,010 --> 00:26:55,120
<font color="#E5E5E5">see that I made that myself and there's</font>

705
00:26:52,179 --> 00:26:58,390
a key programmer<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> all my cool ASCII</font>

706
00:26:55,120 --> 00:27:01,330
art<font color="#E5E5E5"> so again systems rely on a chain of</font>

707
00:26:58,390 --> 00:27:03,309
<font color="#E5E5E5">trust right we authenticate physical to</font>

708
00:27:01,330 --> 00:27:05,439
authenticate physical keys right<font color="#E5E5E5"> so</font>

709
00:27:03,309 --> 00:27:08,740
<font color="#CCCCCC">bypassing the trust anywhere along that</font>

710
00:27:05,440 --> 00:27:10,120
<font color="#E5E5E5">chain will start the vehicle</font><font color="#CCCCCC"> right so we</font>

711
00:27:08,740 --> 00:27:12,190
<font color="#E5E5E5">can bypass it</font><font color="#CCCCCC"> either from the keys</font>

712
00:27:10,120 --> 00:27:13,750
perspective<font color="#E5E5E5"> from the body controller to</font>

713
00:27:12,190 --> 00:27:15,010
the<font color="#E5E5E5"> key or from the key or the engine</font>

714
00:27:13,750 --> 00:27:17,860
controller to the<font color="#E5E5E5"> body controller right</font>

715
00:27:15,010 --> 00:27:19,629
<font color="#E5E5E5">so Mo's immobilizer bypasses</font><font color="#CCCCCC"> our popular</font>

716
00:27:17,860 --> 00:27:23,169
applications<font color="#E5E5E5"> and at least in the</font><font color="#CCCCCC"> u.s.</font>

717
00:27:19,630 --> 00:27:24,610
where I'm from<font color="#E5E5E5"> we have remote starts I</font>

718
00:27:23,170 --> 00:27:27,160
don't<font color="#CCCCCC"> think they exist</font><font color="#E5E5E5"> at all in Europe</font>

719
00:27:24,610 --> 00:27:28,719
<font color="#E5E5E5">but it gets really cold in Michigan</font><font color="#CCCCCC"> and</font>

720
00:27:27,160 --> 00:27:30,010
<font color="#E5E5E5">it's really nice to</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> into a warm car</font>

721
00:27:28,720 --> 00:27:32,500
so we have these remote start

722
00:27:30,010 --> 00:27:32,860
applications<font color="#E5E5E5"> and we have to</font><font color="#CCCCCC"> bypass the</font>

723
00:27:32,500 --> 00:27:34,330
mobile

724
00:27:32,860 --> 00:27:36,399
therefore<font color="#E5E5E5"> these applications and so it's</font>

725
00:27:34,330 --> 00:27:39,010
a<font color="#E5E5E5"> really common function in the United</font>

726
00:27:36,400 --> 00:27:40,900
States<font color="#CCCCCC"> and oh yeah I'm typically used</font>

727
00:27:39,010 --> 00:27:42,820
proprietary security algorithms right

728
00:27:40,900 --> 00:27:44,110
they roll their own<font color="#E5E5E5"> security algorithms</font>

729
00:27:42,820 --> 00:27:46,090
and if there's anything we've<font color="#E5E5E5"> ever</font>

730
00:27:44,110 --> 00:27:48,689
learned from<font color="#E5E5E5"> DEFCON or any of these</font>

731
00:27:46,090 --> 00:27:51,220
hacker conferences<font color="#E5E5E5"> don't roll</font><font color="#CCCCCC"> your own</font>

732
00:27:48,690 --> 00:27:55,540
<font color="#CCCCCC">security algorithm</font><font color="#E5E5E5"> they do it all the</font>

733
00:27:51,220 --> 00:27:57,340
time<font color="#E5E5E5"> good for us</font><font color="#CCCCCC"> so and when they do</font>

734
00:27:55,540 --> 00:27:59,139
<font color="#E5E5E5">implement standard algorithms they don't</font>

735
00:27:57,340 --> 00:28:00,879
always implement security correctly and

736
00:27:59,140 --> 00:28:03,250
that's really common<font color="#CCCCCC"> there's now</font>

737
00:28:00,880 --> 00:28:06,460
nowadays so<font color="#E5E5E5"> let's those are the few ways</font>

738
00:28:03,250 --> 00:28:09,520
<font color="#CCCCCC">to sort</font><font color="#E5E5E5"> of steal a car let's</font><font color="#CCCCCC"> go into the</font>

739
00:28:06,460 --> 00:28:11,140
individual<font color="#E5E5E5"> attack surfaces themselves</font><font color="#CCCCCC"> so</font>

740
00:28:09,520 --> 00:28:14,080
let's talk about<font color="#E5E5E5"> a relay attack itself</font>

741
00:28:11,140 --> 00:28:16,330
<font color="#E5E5E5">so a really attack is</font><font color="#CCCCCC"> uh it's</font><font color="#E5E5E5"> not based</font>

742
00:28:14,080 --> 00:28:18,250
it's not based on<font color="#CCCCCC"> the</font><font color="#E5E5E5"> electrical relay</font>

743
00:28:16,330 --> 00:28:20,260
but rather on<font color="#CCCCCC"> the concepts of relaying</font>

744
00:28:18,250 --> 00:28:21,580
<font color="#CCCCCC">the message</font><font color="#E5E5E5"> so we talk about relay it's</font>

745
00:28:20,260 --> 00:28:23,830
not the<font color="#E5E5E5"> actual</font><font color="#CCCCCC"> physical relay but</font>

746
00:28:21,580 --> 00:28:25,720
<font color="#E5E5E5">relaying the messages from one point to</font>

747
00:28:23,830 --> 00:28:29,740
another essentially extending the range

748
00:28:25,720 --> 00:28:31,750
of your key fob<font color="#E5E5E5"> so let's what is the</font>

749
00:28:29,740 --> 00:28:34,510
concept of a relay attack well<font color="#E5E5E5"> you have</font>

750
00:28:31,750 --> 00:28:36,309
to<font color="#E5E5E5"> have a passive vehicle system right</font>

751
00:28:34,510 --> 00:28:38,470
or a passive key system so one of<font color="#E5E5E5"> these</font>

752
00:28:36,309 --> 00:28:40,270
key in your keep the key in<font color="#CCCCCC"> your pocket</font>

753
00:28:38,470 --> 00:28:42,610
<font color="#CCCCCC">kind of systems you don't actually have</font>

754
00:28:40,270 --> 00:28:47,110
<font color="#E5E5E5">to turn the key and at least two</font>

755
00:28:42,610 --> 00:28:48,549
attackers or<font color="#E5E5E5"> two</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> antenna one attacker</font>

756
00:28:47,110 --> 00:28:50,320
will be near the<font color="#E5E5E5"> physical key of the</font>

757
00:28:48,549 --> 00:28:54,120
vehicle<font color="#E5E5E5"> another attacker near the</font>

758
00:28:50,320 --> 00:28:56,740
vehicle<font color="#CCCCCC"> itself</font><font color="#E5E5E5"> and there's the key</font>

759
00:28:54,120 --> 00:29:00,010
typically<font color="#E5E5E5"> a key will work</font><font color="#CCCCCC"> a short-range</font>

760
00:28:56,740 --> 00:29:02,500
<font color="#CCCCCC">short</font><font color="#E5E5E5"> range communications our RF is</font>

761
00:29:00,010 --> 00:29:05,530
usually over 150 kilohertz and the

762
00:29:02,500 --> 00:29:06,940
<font color="#CCCCCC">long-range</font><font color="#E5E5E5"> RF components usually</font><font color="#CCCCCC"> 315</font><font color="#E5E5E5"> 4-3</font>

763
00:29:05,530 --> 00:29:09,520
or<font color="#CCCCCC"> 900 megahertz depending on which</font>

764
00:29:06,940 --> 00:29:12,100
country you're<font color="#E5E5E5"> in u.s. uses all three</font>

765
00:29:09,520 --> 00:29:14,410
<font color="#E5E5E5">but I think Europe just sticks to 433</font>

766
00:29:12,100 --> 00:29:16,629
and<font color="#E5E5E5"> maybe 900 I think those</font><font color="#CCCCCC"> are your two</font>

767
00:29:14,410 --> 00:29:18,280
options<font color="#CCCCCC"> so let's take a</font><font color="#E5E5E5"> look at it</font>

768
00:29:16,630 --> 00:29:21,130
here's an antenna<font color="#E5E5E5"> that's near</font><font color="#CCCCCC"> the</font>

769
00:29:18,280 --> 00:29:24,240
attackers key<font color="#E5E5E5"> and we have we establish a</font>

770
00:29:21,130 --> 00:29:28,780
two-way<font color="#CCCCCC"> communication channel</font><font color="#E5E5E5"> to a comms</font>

771
00:29:24,240 --> 00:29:34,510
<font color="#E5E5E5">when we up convert the initial signal of</font>

772
00:29:28,780 --> 00:29:37,570
the antenna<font color="#E5E5E5"> to from the 315 or for 150</font>

773
00:29:34,510 --> 00:29:40,450
kilohertz<font color="#CCCCCC"> to 2.4 gigahertz and</font><font color="#E5E5E5"> we talked</font>

774
00:29:37,570 --> 00:29:42,639
to<font color="#E5E5E5"> receiving antenna</font><font color="#CCCCCC"> and so we</font>

775
00:29:40,450 --> 00:29:46,030
essentially extend the range near the

776
00:29:42,640 --> 00:29:46,780
key of the actual key itself<font color="#E5E5E5"> and then we</font>

777
00:29:46,030 --> 00:29:50,139
have the

778
00:29:46,780 --> 00:29:53,560
<font color="#E5E5E5">antenna</font><font color="#CCCCCC"> lives near the vehicle there's</font>

779
00:29:50,140 --> 00:29:54,760
my Ferrari<font color="#CCCCCC"> lives near the vehicle it's</font>

780
00:29:53,560 --> 00:29:58,780
<font color="#E5E5E5">literally</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> best for our I could</font>

781
00:29:54,760 --> 00:30:01,300
afford<font color="#CCCCCC"> so here we have our key near the</font>

782
00:29:58,780 --> 00:30:03,399
vehicle<font color="#CCCCCC"> and we</font><font color="#E5E5E5"> are allowed to</font><font color="#CCCCCC"> extend</font><font color="#E5E5E5"> the</font>

783
00:30:01,300 --> 00:30:07,090
range of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> individual of the vehicle</font>

784
00:30:03,400 --> 00:30:08,650
itself<font color="#E5E5E5"> so it depends</font><font color="#CCCCCC"> that timing</font><font color="#E5E5E5"> is</font>

785
00:30:07,090 --> 00:30:12,970
really important because<font color="#E5E5E5"> you</font><font color="#CCCCCC"> have this</font>

786
00:30:08,650 --> 00:30:15,640
range<font color="#CCCCCC"> you're transmitting a message from</font>

787
00:30:12,970 --> 00:30:22,000
a key<font color="#E5E5E5"> it's getting retransmitted or up</font>

788
00:30:15,640 --> 00:30:24,190
<font color="#E5E5E5">up</font><font color="#CCCCCC"> they up shift the the</font><font color="#E5E5E5"> frequency to a</font>

789
00:30:22,000 --> 00:30:26,800
different frequency to extend the<font color="#E5E5E5"> range</font>

790
00:30:24,190 --> 00:30:28,390
and and because of this up shifting<font color="#E5E5E5"> of</font>

791
00:30:26,800 --> 00:30:30,669
<font color="#CCCCCC">the frequency and down shifting</font><font color="#E5E5E5"> of the</font>

792
00:30:28,390 --> 00:30:32,950
frequency we have<font color="#CCCCCC"> some time and some</font>

793
00:30:30,670 --> 00:30:35,860
<font color="#E5E5E5">latency there so obviously</font><font color="#CCCCCC"> the timing</font><font color="#E5E5E5"> of</font>

794
00:30:32,950 --> 00:30:38,560
the messages that the car expects<font color="#E5E5E5"> really</font>

795
00:30:35,860 --> 00:30:39,699
depend makes the range change<font color="#CCCCCC"> and I'll</font>

796
00:30:38,560 --> 00:30:41,679
talk a little<font color="#CCCCCC"> bit about some of the</font>

797
00:30:39,700 --> 00:30:44,620
<font color="#E5E5E5">hardware if you haven't had</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> chance</font>

798
00:30:41,680 --> 00:30:47,700
<font color="#CCCCCC">check out wired there's a company called</font>

799
00:30:44,620 --> 00:30:50,320
a unicorn team or called kyu-ho 360 a

800
00:30:47,700 --> 00:30:55,210
<font color="#E5E5E5">Chinese research firm that made their</font>

801
00:30:50,320 --> 00:30:57,460
own<font color="#CCCCCC"> really</font><font color="#E5E5E5"> low-cost really attack</font>

802
00:30:55,210 --> 00:30:58,660
devices now they made them<font color="#CCCCCC"> themselves</font>

803
00:30:57,460 --> 00:31:00,190
<font color="#E5E5E5">and they</font><font color="#CCCCCC"> talked to a little they had a</font>

804
00:30:58,660 --> 00:31:04,150
really<font color="#E5E5E5"> good talk about</font><font color="#CCCCCC"> a year</font><font color="#E5E5E5"> and a half</font>

805
00:31:00,190 --> 00:31:05,680
ago at<font color="#E5E5E5"> hack in the box</font><font color="#CCCCCC"> if you had a</font>

806
00:31:04,150 --> 00:31:08,410
chance<font color="#E5E5E5"> to go you would have seen it it</font>

807
00:31:05,680 --> 00:31:10,360
was it described how to essentially

808
00:31:08,410 --> 00:31:12,790
build your own<font color="#E5E5E5"> and really for the cost</font>

809
00:31:10,360 --> 00:31:14,979
of like<font color="#CCCCCC"> 30</font><font color="#E5E5E5"> dollars</font><font color="#CCCCCC"> you could build your</font>

810
00:31:12,790 --> 00:31:16,510
own I'm sure<font color="#E5E5E5"> you have to source a lot of</font>

811
00:31:14,980 --> 00:31:17,320
<font color="#E5E5E5">Chinese components they were very lucky</font>

812
00:31:16,510 --> 00:31:21,129
<font color="#E5E5E5">to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> in China</font>

813
00:31:17,320 --> 00:31:23,260
<font color="#E5E5E5">but really at the cost of $100 $200 each</font>

814
00:31:21,130 --> 00:31:26,500
they're very low cost you<font color="#E5E5E5"> can and I've</font>

815
00:31:23,260 --> 00:31:28,960
seen them on Alibaba<font color="#E5E5E5"> you can find a</font>

816
00:31:26,500 --> 00:31:32,050
really<font color="#E5E5E5"> low</font><font color="#CCCCCC"> cost really attack devices</font>

817
00:31:28,960 --> 00:31:34,690
out there today<font color="#CCCCCC"> so there it's a really</font>

818
00:31:32,050 --> 00:31:37,810
<font color="#E5E5E5">economical way to just to borrow cars if</font>

819
00:31:34,690 --> 00:31:40,960
you<font color="#E5E5E5"> needed</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the other way is to add a</font>

820
00:31:37,810 --> 00:31:42,429
new<font color="#E5E5E5"> key right don't you don't have you</font>

821
00:31:40,960 --> 00:31:45,250
<font color="#CCCCCC">don't want to</font><font color="#E5E5E5"> get near the actual</font>

822
00:31:42,430 --> 00:31:47,170
physical key maybe you<font color="#E5E5E5"> just want</font><font color="#CCCCCC"> to plug</font>

823
00:31:45,250 --> 00:31:49,570
into<font color="#E5E5E5"> the car</font><font color="#CCCCCC"> if you</font><font color="#E5E5E5"> have access to</font><font color="#CCCCCC"> the</font>

824
00:31:47,170 --> 00:31:50,950
obd2<font color="#E5E5E5"> port and you can then just add</font><font color="#CCCCCC"> your</font>

825
00:31:49,570 --> 00:31:53,470
<font color="#E5E5E5">own key maybe you got one in</font><font color="#CCCCCC"> your pocket</font>

826
00:31:50,950 --> 00:31:55,360
<font color="#CCCCCC">just want to use</font><font color="#E5E5E5"> it for something so</font>

827
00:31:53,470 --> 00:31:58,210
dealers need to service<font color="#E5E5E5"> the vehicles</font>

828
00:31:55,360 --> 00:32:00,699
this<font color="#E5E5E5"> is a big problem for OEM some OEMs</font>

829
00:31:58,210 --> 00:32:03,760
don't let the dealers<font color="#E5E5E5"> add new keys</font>

830
00:32:00,700 --> 00:32:06,370
<font color="#E5E5E5">but for the ones who do</font><font color="#CCCCCC"> this is the</font>

831
00:32:03,760 --> 00:32:10,660
reason why this<font color="#E5E5E5"> is a problem is because</font>

832
00:32:06,370 --> 00:32:13,540
<font color="#CCCCCC">it's easy</font><font color="#E5E5E5"> to add them</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so dealer</font>

833
00:32:10,660 --> 00:32:16,140
tools<font color="#E5E5E5"> can add keys right</font><font color="#CCCCCC"> dealer tools</font>

834
00:32:13,540 --> 00:32:19,210
can be<font color="#E5E5E5"> reverse and reverse engineered</font>

835
00:32:16,140 --> 00:32:21,010
<font color="#E5E5E5">dealer tools run Windows or Java right</font>

836
00:32:19,210 --> 00:32:23,260
<font color="#E5E5E5">so that can be reverse engineered and</font>

837
00:32:21,010 --> 00:32:25,540
window<font color="#CCCCCC"> and Java applications can be</font>

838
00:32:23,260 --> 00:32:28,930
reverse<font color="#CCCCCC"> engineered so because of the all</font>

839
00:32:25,540 --> 00:32:31,360
<font color="#CCCCCC">of these things security is very low on</font>

840
00:32:28,930 --> 00:32:33,850
these systems<font color="#E5E5E5"> often security</font><font color="#CCCCCC"> access</font>

841
00:32:31,360 --> 00:32:35,560
service 27 is used for<font color="#E5E5E5"> privileged access</font>

842
00:32:33,850 --> 00:32:39,189
<font color="#E5E5E5">and I'm going to show you what that</font>

843
00:32:35,560 --> 00:32:40,870
<font color="#E5E5E5">looks like</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> little bit later</font><font color="#CCCCCC"> to test if</font>

844
00:32:39,190 --> 00:32:42,910
a function requires<font color="#E5E5E5"> security access</font>

845
00:32:40,870 --> 00:32:45,399
<font color="#E5E5E5">here's this set here's a request we</font>

846
00:32:42,910 --> 00:32:47,190
could send so here's an example<font color="#CCCCCC"> we're</font>

847
00:32:45,400 --> 00:32:49,990
sending<font color="#E5E5E5"> a</font><font color="#CCCCCC"> request to the ng-controller</font>

848
00:32:47,190 --> 00:32:51,700
to ask it to<font color="#CCCCCC"> learn a</font><font color="#E5E5E5"> new key we</font><font color="#CCCCCC"> use</font>

849
00:32:49,990 --> 00:32:54,310
service 31 which is<font color="#CCCCCC"> a really</font><font color="#E5E5E5"> common</font>

850
00:32:51,700 --> 00:32:55,480
service for these and it'll respond back

851
00:32:54,310 --> 00:32:57,879
<font color="#CCCCCC">to us with what's called a negative</font>

852
00:32:55,480 --> 00:33:00,990
<font color="#E5E5E5">response and we that's indicated with</font>

853
00:32:57,880 --> 00:33:03,870
<font color="#E5E5E5">the 7f here just</font><font color="#CCCCCC"> before the the</font><font color="#E5E5E5"> O 3 7</font>

854
00:33:00,990 --> 00:33:07,060
<font color="#CCCCCC">f7f indicates security access</font><font color="#E5E5E5"> or</font>

855
00:33:03,870 --> 00:33:08,679
negative response and the 33<font color="#CCCCCC"> which is</font>

856
00:33:07,060 --> 00:33:11,320
<font color="#CCCCCC">the negative response code which is the</font>

857
00:33:08,680 --> 00:33:14,350
<font color="#E5E5E5">reason</font><font color="#CCCCCC"> why it failed indicates</font><font color="#E5E5E5"> it's</font>

858
00:33:11,320 --> 00:33:16,000
denied<font color="#E5E5E5"> because security access is denied</font>

859
00:33:14,350 --> 00:33:18,879
so there's a few<font color="#CCCCCC"> different security</font>

860
00:33:16,000 --> 00:33:21,040
access<font color="#E5E5E5"> negative response codes 33 or</font>

861
00:33:18,880 --> 00:33:22,060
anything in the<font color="#CCCCCC"> 3</font><font color="#E5E5E5"> something range is</font>

862
00:33:21,040 --> 00:33:24,250
<font color="#E5E5E5">usually something to do with the</font>

863
00:33:22,060 --> 00:33:26,139
security<font color="#E5E5E5"> so anytime there's a security</font>

864
00:33:24,250 --> 00:33:28,630
access<font color="#CCCCCC"> requests</font><font color="#E5E5E5"> or requests that require</font>

865
00:33:26,140 --> 00:33:30,650
security<font color="#E5E5E5"> access you might see a response</font>

866
00:33:28,630 --> 00:33:33,470
like<font color="#CCCCCC"> this a negative response</font>

867
00:33:30,650 --> 00:33:36,980
so in order to<font color="#CCCCCC"> bypass</font><font color="#E5E5E5"> the security</font>

868
00:33:33,470 --> 00:33:38,630
access<font color="#CCCCCC"> we</font><font color="#E5E5E5"> need we need</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> security</font>

869
00:33:36,980 --> 00:33:40,790
access routine or some sort of<font color="#E5E5E5"> security</font>

870
00:33:38,630 --> 00:33:44,390
<font color="#E5E5E5">access algorithm and in order</font><font color="#CCCCCC"> to bypass</font>

871
00:33:40,790 --> 00:33:46,100
<font color="#E5E5E5">it so let's get the OEM scan tool</font><font color="#CCCCCC"> all</font>

872
00:33:44,390 --> 00:33:48,470
<font color="#CCCCCC">right</font><font color="#E5E5E5"> that seems easy</font><font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> just borrow</font>

873
00:33:46,100 --> 00:33:50,030
it<font color="#CCCCCC"> from</font><font color="#E5E5E5"> eBay right and how do you do</font>

874
00:33:48,470 --> 00:33:51,200
that<font color="#E5E5E5"> you buy it off</font><font color="#CCCCCC"> eBay</font><font color="#E5E5E5"> and then you</font>

875
00:33:50,030 --> 00:33:52,520
turn<font color="#CCCCCC"> around you sell it once you're done</font>

876
00:33:51,200 --> 00:33:55,700
with<font color="#E5E5E5"> it for the same</font><font color="#CCCCCC"> price you bought it</font>

877
00:33:52,520 --> 00:33:58,129
for choosing my usually the best<font color="#E5E5E5"> way</font><font color="#CCCCCC"> um</font>

878
00:33:55,700 --> 00:34:00,530
<font color="#CCCCCC">a lot of these applications</font><font color="#E5E5E5"> just you</font>

879
00:33:58,130 --> 00:34:01,940
<font color="#CCCCCC">Java</font><font color="#E5E5E5"> job is really common and if it</font>

880
00:34:00,530 --> 00:34:03,440
doesn't<font color="#E5E5E5"> use Java it's even easier</font>

881
00:34:01,940 --> 00:34:05,090
probably<font color="#E5E5E5"> because it's some old</font>

882
00:34:03,440 --> 00:34:09,889
application that they don't maintain

883
00:34:05,090 --> 00:34:13,179
anymore<font color="#CCCCCC"> so we find</font><font color="#E5E5E5"> references and files</font>

884
00:34:09,889 --> 00:34:15,080
directories and in our<font color="#CCCCCC"> example we found</font>

885
00:34:13,179 --> 00:34:17,330
one<font color="#CCCCCC"> that I'm</font><font color="#E5E5E5"> going to talk about we</font>

886
00:34:15,080 --> 00:34:19,429
<font color="#E5E5E5">found this app this thing called es use</font>

887
00:34:17,330 --> 00:34:21,168
<font color="#E5E5E5">we didn't know what es you meant I did a</font>

888
00:34:19,429 --> 00:34:22,760
little bit of<font color="#CCCCCC"> searching and</font><font color="#E5E5E5"> found found</font>

889
00:34:21,168 --> 00:34:24,980
<font color="#E5E5E5">that it meant like encrypted storage</font>

890
00:34:22,760 --> 00:34:27,740
<font color="#E5E5E5">unit or something like</font><font color="#CCCCCC"> that so let's</font>

891
00:34:24,980 --> 00:34:31,990
look at a hex view of any<font color="#E5E5E5"> su and you can</font>

892
00:34:27,739 --> 00:34:31,989
tell that<font color="#CCCCCC"> it looks super encrypted right</font>

893
00:34:33,489 --> 00:34:38,918
<font color="#CCCCCC">I know there's lots and</font><font color="#E5E5E5"> lots</font><font color="#CCCCCC"> of entropy</font>

894
00:34:34,989 --> 00:34:40,719
<font color="#CCCCCC">not much structure so my guess is</font><font color="#E5E5E5"> it's</font>

895
00:34:38,918 --> 00:34:42,310
encrypted

896
00:34:40,719 --> 00:34:43,719
<font color="#CCCCCC">I won't</font><font color="#E5E5E5"> I mean it's really the whole</font>

897
00:34:42,310 --> 00:34:45,310
file so it's not<font color="#E5E5E5"> that big</font>

898
00:34:43,719 --> 00:34:48,040
took a lot less time when<font color="#CCCCCC"> I was doing</font>

899
00:34:45,310 --> 00:34:50,619
<font color="#CCCCCC">later</font><font color="#E5E5E5"> okay so lots entropy probably</font>

900
00:34:48,040 --> 00:34:53,230
encrypted so we have to find a function

901
00:34:50,619 --> 00:34:55,389
that<font color="#CCCCCC"> decrypt the file</font><font color="#E5E5E5"> that's what I did</font>

902
00:34:53,230 --> 00:34:57,310
<font color="#CCCCCC">I could have tried to</font><font color="#E5E5E5"> see if the tool</font>

903
00:34:55,389 --> 00:34:58,780
would decrypt it for me but I just

904
00:34:57,310 --> 00:35:00,910
<font color="#CCCCCC">reverse-engineer it was a java</font>

905
00:34:58,780 --> 00:35:01,840
application so we've looked inside of

906
00:35:00,910 --> 00:35:05,290
the java application

907
00:35:01,840 --> 00:35:06,430
I found a decompiled all of the<font color="#CCCCCC"> Java</font>

908
00:35:05,290 --> 00:35:08,259
code there's a lot of<font color="#E5E5E5"> DiGiovanni</font>

909
00:35:06,430 --> 00:35:09,790
compilers out there tons of them they

910
00:35:08,260 --> 00:35:12,400
all<font color="#E5E5E5"> work they all seem to work</font><font color="#CCCCCC"> really</font>

911
00:35:09,790 --> 00:35:14,860
<font color="#CCCCCC">well</font><font color="#E5E5E5"> because Java isn't really secure</font>

912
00:35:12,400 --> 00:35:17,800
<font color="#CCCCCC">and</font><font color="#E5E5E5"> there was one function or</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> class</font>

913
00:35:14,860 --> 00:35:21,220
called<font color="#E5E5E5"> encrypted security unlock as a</font>

914
00:35:17,800 --> 00:35:23,260
big hint right so we found<font color="#CCCCCC"> that and we</font>

915
00:35:21,220 --> 00:35:26,259
found it used this really weird method

916
00:35:23,260 --> 00:35:28,780
called<font color="#E5E5E5"> you see not sure what</font><font color="#CCCCCC"> UC meant</font>

917
00:35:26,260 --> 00:35:31,900
<font color="#E5E5E5">but it</font><font color="#CCCCCC"> seemed</font><font color="#E5E5E5"> cryptic enough to probably</font>

918
00:35:28,780 --> 00:35:35,260
<font color="#CCCCCC">be what we were looking for</font><font color="#E5E5E5"> so I found</font>

919
00:35:31,900 --> 00:35:38,380
another<font color="#E5E5E5"> class</font><font color="#CCCCCC"> called</font><font color="#E5E5E5"> UC and to have a</font>

920
00:35:35,260 --> 00:35:40,420
code<font color="#E5E5E5"> from the OEM kind of look like this</font>

921
00:35:38,380 --> 00:35:42,610
that looks like it's doing<font color="#E5E5E5"> something</font>

922
00:35:40,420 --> 00:35:45,640
really<font color="#E5E5E5"> odd</font><font color="#CCCCCC"> right here we</font><font color="#E5E5E5"> have this</font>

923
00:35:42,610 --> 00:35:47,740
system<font color="#E5E5E5"> trying to like I don't know</font>

924
00:35:45,640 --> 00:35:50,379
listener<font color="#CCCCCC"> it didn't it didn't look like</font>

925
00:35:47,740 --> 00:35:54,669
anything else<font color="#CCCCCC"> and in all of the other</font>

926
00:35:50,380 --> 00:35:56,860
classes<font color="#E5E5E5"> themselves so we so I did what I</font>

927
00:35:54,670 --> 00:36:00,070
<font color="#CCCCCC">did is I just patched it</font><font color="#E5E5E5"> I just made my</font>

928
00:35:56,860 --> 00:36:01,870
own<font color="#CCCCCC"> version</font><font color="#E5E5E5"> of this</font><font color="#CCCCCC"> I made my own</font>

929
00:36:00,070 --> 00:36:04,390
function that called this you see

930
00:36:01,870 --> 00:36:07,950
function<font color="#CCCCCC"> and I pointed</font><font color="#E5E5E5"> it to the</font>

931
00:36:04,390 --> 00:36:07,950
directory<font color="#CCCCCC"> of all the su files</font>

932
00:36:08,320 --> 00:36:13,030
<font color="#E5E5E5">right</font><font color="#CCCCCC"> and I</font><font color="#E5E5E5"> just asked it</font><font color="#CCCCCC"> I know it's</font>

933
00:36:10,570 --> 00:36:15,760
just<font color="#E5E5E5"> a bunch of stuff this is it so all</font>

934
00:36:13,030 --> 00:36:17,440
we really<font color="#E5E5E5"> had</font><font color="#CCCCCC"> to do instead of trying to</font>

935
00:36:15,760 --> 00:36:20,910
<font color="#E5E5E5">figure it</font><font color="#CCCCCC"> out is just</font><font color="#E5E5E5"> point it to the</font>

936
00:36:17,440 --> 00:36:23,260
<font color="#E5E5E5">text files</font><font color="#CCCCCC"> themselves</font><font color="#E5E5E5"> so I wrote my</font><font color="#CCCCCC"> own</font>

937
00:36:20,910 --> 00:36:27,339
<font color="#CCCCCC">decryptor as you can see it has some</font>

938
00:36:23,260 --> 00:36:29,530
<font color="#E5E5E5">information about the OEM here</font><font color="#CCCCCC"> I gave it</font>

939
00:36:27,340 --> 00:36:31,450
<font color="#CCCCCC">to home path of my ASU files</font>

940
00:36:29,530 --> 00:36:35,940
I had it output to the file called

941
00:36:31,450 --> 00:36:39,879
<font color="#E5E5E5">mother lode text and and when I got when</font>

942
00:36:35,940 --> 00:36:41,440
and then just had it out just decrypt

943
00:36:39,880 --> 00:36:44,050
the data just<font color="#CCCCCC"> whatever was in there it</font>

944
00:36:41,440 --> 00:36:47,170
<font color="#CCCCCC">just is just a general unlock and the</font>

945
00:36:44,050 --> 00:36:49,570
<font color="#E5E5E5">decrypted file that is</font><font color="#CCCCCC"> amias es you file</font>

946
00:36:47,170 --> 00:36:51,490
<font color="#E5E5E5">just turned it to JavaScript</font><font color="#CCCCCC"> right and</font>

947
00:36:49,570 --> 00:36:56,470
inside the JavaScript we saw these big

948
00:36:51,490 --> 00:36:58,209
arrays<font color="#CCCCCC"> C</font><font color="#E5E5E5"> key calc</font><font color="#CCCCCC"> first a function</font>

949
00:36:56,470 --> 00:37:03,279
called calculate seed which is<font color="#E5E5E5"> exactly</font>

950
00:36:58,210 --> 00:37:08,640
what service<font color="#CCCCCC"> 2087</font><font color="#E5E5E5"> uses as a seed</font><font color="#CCCCCC"> it did</font>

951
00:37:03,280 --> 00:37:12,210
this<font color="#E5E5E5"> special math here and it out put it</font>

952
00:37:08,640 --> 00:37:14,640
and output<font color="#CCCCCC"> they returned the</font><font color="#E5E5E5"> the seed</font>

953
00:37:12,210 --> 00:37:15,960
from its rich<font color="#CCCCCC"> Mane returns so here we</font>

954
00:37:14,640 --> 00:37:18,299
are we<font color="#CCCCCC"> have the</font><font color="#E5E5E5"> actual security</font>

955
00:37:15,960 --> 00:37:21,029
<font color="#E5E5E5">algorithm in fact with this method</font><font color="#CCCCCC"> I</font>

956
00:37:18,299 --> 00:37:24,750
dumped the entire<font color="#E5E5E5"> the OEMs entire seed</font>

957
00:37:21,029 --> 00:37:27,269
key<font color="#E5E5E5"> all of the ones that they had ever</font>

958
00:37:24,750 --> 00:37:30,569
stored on any vehicle ever<font color="#E5E5E5"> so it was</font>

959
00:37:27,269 --> 00:37:32,609
<font color="#CCCCCC">quite nice and they also they didn't</font>

960
00:37:30,569 --> 00:37:34,769
just support their<font color="#CCCCCC"> own</font><font color="#E5E5E5"> there's a lot of</font>

961
00:37:32,609 --> 00:37:37,619
<font color="#E5E5E5">crossover between this OEM and other</font>

962
00:37:34,769 --> 00:37:39,959
<font color="#CCCCCC">OEMs</font><font color="#E5E5E5"> so it actually had extra from</font>

963
00:37:37,619 --> 00:37:42,240
different car manufacturers as<font color="#CCCCCC"> well so</font>

964
00:37:39,960 --> 00:37:44,339
that<font color="#E5E5E5"> was quite nice</font><font color="#CCCCCC"> so there are two</font>

965
00:37:42,240 --> 00:37:48,029
modules that<font color="#E5E5E5"> we need to work</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> when</font>

966
00:37:44,339 --> 00:37:51,960
we're learning<font color="#E5E5E5"> a</font><font color="#CCCCCC"> key 720 and 728</font><font color="#E5E5E5"> this is</font>

967
00:37:48,029 --> 00:37:53,579
a different OEMs<font color="#CCCCCC"> and 70 zero and 78 this</font>

968
00:37:51,960 --> 00:37:55,619
<font color="#E5E5E5">is the engine controller so we had a</font>

969
00:37:53,579 --> 00:37:58,289
body controller and an intricate roller

970
00:37:55,619 --> 00:38:00,210
and here's what a key learn might look

971
00:37:58,289 --> 00:38:03,539
like<font color="#E5E5E5"> on a separate control on a separate</font>

972
00:38:00,210 --> 00:38:06,230
OEM<font color="#CCCCCC"> so we requests diagnostic trouble</font>

973
00:38:03,539 --> 00:38:08,519
codes<font color="#CCCCCC"> just to see if there's any</font><font color="#E5E5E5"> issues</font>

974
00:38:06,230 --> 00:38:11,640
with reprogramming the key there were

975
00:38:08,519 --> 00:38:13,828
none so I actually used the separate key

976
00:38:11,640 --> 00:38:17,910
programming tool and just<font color="#E5E5E5"> watch monitor</font>

977
00:38:13,829 --> 00:38:21,240
it as it was<font color="#E5E5E5"> doing a key doing a key</font>

978
00:38:17,910 --> 00:38:23,730
program<font color="#E5E5E5"> and documented it here so we</font>

979
00:38:21,240 --> 00:38:25,950
read the number of keys programmed we

980
00:38:23,730 --> 00:38:27,420
switched<font color="#E5E5E5"> to a programming mode and we</font>

981
00:38:25,950 --> 00:38:29,700
see that it returned a negative response

982
00:38:27,420 --> 00:38:32,730
<font color="#E5E5E5">which says security</font><font color="#CCCCCC"> access is required</font>

983
00:38:29,700 --> 00:38:35,640
<font color="#CCCCCC">in this situation</font><font color="#E5E5E5"> no big deal</font>

984
00:38:32,730 --> 00:38:37,440
we'll just request<font color="#E5E5E5"> the seed we need to</font>

985
00:38:35,640 --> 00:38:39,150
switch our mode<font color="#E5E5E5"> we need</font><font color="#CCCCCC"> to start</font>

986
00:38:37,440 --> 00:38:41,970
<font color="#CCCCCC">diagnostic so we do</font><font color="#E5E5E5"> this enhanced mode</font>

987
00:38:39,150 --> 00:38:44,789
<font color="#CCCCCC">Diagnostics and then we ask for</font><font color="#E5E5E5"> a key or</font>

988
00:38:41,970 --> 00:38:46,828
<font color="#CCCCCC">a seed</font><font color="#E5E5E5"> sorry we</font><font color="#CCCCCC"> ask for a seed</font><font color="#E5E5E5"> to come</font>

989
00:38:44,789 --> 00:38:48,720
back what happens is we<font color="#E5E5E5"> take the seed</font>

990
00:38:46,829 --> 00:38:50,880
and<font color="#E5E5E5"> we turn it into a key using a</font>

991
00:38:48,720 --> 00:38:52,859
special algorithm<font color="#E5E5E5"> that way maybe we got</font>

992
00:38:50,880 --> 00:38:54,359
from this the scan tool or<font color="#E5E5E5"> something</font>

993
00:38:52,859 --> 00:38:56,609
like that<font color="#CCCCCC"> the one that I just</font><font color="#E5E5E5"> dumped</font>

994
00:38:54,359 --> 00:38:58,950
just<font color="#E5E5E5"> before this we have to</font><font color="#CCCCCC"> use some</font>

995
00:38:56,609 --> 00:39:02,460
sort<font color="#CCCCCC"> of algorithm</font><font color="#E5E5E5"> on this seed so let's</font>

996
00:38:58,950 --> 00:39:04,558
see what this quick<font color="#CCCCCC"> pause</font><font color="#E5E5E5"> here let's see</font>

997
00:39:02,460 --> 00:39:06,779
what the actual OEM does security<font color="#E5E5E5"> access</font>

998
00:39:04,559 --> 00:39:09,000
we found just<font color="#E5E5E5"> before this is from</font>

999
00:39:06,779 --> 00:39:11,279
<font color="#E5E5E5">another vehicle we really haven't had a</font>

1000
00:39:09,000 --> 00:39:15,150
<font color="#CCCCCC">chance yet to reverse-engineer</font><font color="#E5E5E5"> this one</font>

1001
00:39:11,279 --> 00:39:17,460
so let's research<font color="#E5E5E5"> if you</font><font color="#CCCCCC"> want to this</font>

1002
00:39:15,150 --> 00:39:19,710
OEM a lot of lot was done with<font color="#CCCCCC"> Christmas</font>

1003
00:39:17,460 --> 00:39:21,480
<font color="#E5E5E5">early Miller and Chris valasek they have</font>

1004
00:39:19,710 --> 00:39:23,840
a good paper on how to<font color="#E5E5E5"> reverse</font><font color="#CCCCCC"> engineer</font>

1005
00:39:21,480 --> 00:39:26,130
this particular OEM

1006
00:39:23,840 --> 00:39:28,050
security access algorithms<font color="#E5E5E5"> infectious</font>

1007
00:39:26,130 --> 00:39:30,660
<font color="#CCCCCC">their first paper that they did</font><font color="#E5E5E5"> that's a</font>

1008
00:39:28,050 --> 00:39:33,510
hint<font color="#CCCCCC"> so let's</font><font color="#E5E5E5"> take a look at the</font>

1009
00:39:30,660 --> 00:39:36,660
response<font color="#CCCCCC"> that we saw this</font><font color="#E5E5E5"> tool do so the</font>

1010
00:39:33,510 --> 00:39:40,320
the<font color="#CCCCCC"> tool sent a key response which was</font>

1011
00:39:36,660 --> 00:39:43,560
<font color="#E5E5E5">equal to the seed so scratch your head</font>

1012
00:39:40,320 --> 00:39:47,460
for a second<font color="#E5E5E5"> and say hey Robert wait</font><font color="#CCCCCC"> I</font>

1013
00:39:43,560 --> 00:39:48,750
<font color="#CCCCCC">got a positive response</font><font color="#E5E5E5"> the module this</font>

1014
00:39:47,460 --> 00:39:50,430
was supposed to<font color="#E5E5E5"> be a positive response</font><font color="#CCCCCC"> I</font>

1015
00:39:48,750 --> 00:39:53,310
got a different negative response it

1016
00:39:50,430 --> 00:39:56,580
wasn't security<font color="#CCCCCC"> access denied it was hey</font>

1017
00:39:53,310 --> 00:39:58,470
wait<font color="#CCCCCC"> your</font><font color="#E5E5E5"> your access</font><font color="#CCCCCC"> is correct you</font>

1018
00:39:56,580 --> 00:40:00,569
just have to wait a little while<font color="#CCCCCC"> for</font><font color="#E5E5E5"> it</font>

1019
00:39:58,470 --> 00:40:05,370
<font color="#E5E5E5">so I thought this was security access</font>

1020
00:40:00,570 --> 00:40:08,400
<font color="#CCCCCC">but it's not the actual</font><font color="#E5E5E5"> key for on this</font>

1021
00:40:05,370 --> 00:40:11,250
<font color="#E5E5E5">OEM and I found out later it was</font>

1022
00:40:08,400 --> 00:40:12,900
essentially for like<font color="#CCCCCC"> 10-15 years they</font>

1023
00:40:11,250 --> 00:40:17,070
didn't have any<font color="#E5E5E5"> security access to</font>

1024
00:40:12,900 --> 00:40:18,990
program a key<font color="#CCCCCC"> you could</font><font color="#E5E5E5"> just simply send</font>

1025
00:40:17,070 --> 00:40:23,010
the same<font color="#CCCCCC"> whatever you saw as your seed</font>

1026
00:40:18,990 --> 00:40:24,930
was your key so the algorithm was<font color="#CCCCCC"> seed</font>

1027
00:40:23,010 --> 00:40:26,100
<font color="#E5E5E5">equals key it's pretty simple but</font>

1028
00:40:24,930 --> 00:40:27,990
there's a<font color="#E5E5E5"> little bit more</font><font color="#CCCCCC"> information</font>

1029
00:40:26,100 --> 00:40:30,240
here is you<font color="#CCCCCC"> actually had a time delay</font>

1030
00:40:27,990 --> 00:40:32,040
<font color="#E5E5E5">and anybody who's done these keys before</font>

1031
00:40:30,240 --> 00:40:34,259
<font color="#E5E5E5">will say oh I know exactly which Olean</font>

1032
00:40:32,040 --> 00:40:36,060
that is there was<font color="#E5E5E5"> a slight time delay it</font>

1033
00:40:34,260 --> 00:40:38,190
said time delay not<font color="#E5E5E5"> expired so he needs</font>

1034
00:40:36,060 --> 00:40:40,860
<font color="#E5E5E5">to wait you need to wait a period of</font>

1035
00:40:38,190 --> 00:40:43,590
<font color="#E5E5E5">time</font><font color="#CCCCCC"> in fact you had to wait</font><font color="#E5E5E5"> for 10</font>

1036
00:40:40,860 --> 00:40:47,220
<font color="#CCCCCC">minutes specifically but</font><font color="#E5E5E5"> 10</font><font color="#CCCCCC"> minutes</font>

1037
00:40:43,590 --> 00:40:50,850
later<font color="#CCCCCC"> all right we have this</font><font color="#E5E5E5"> positive</font>

1038
00:40:47,220 --> 00:40:54,149
response key accepted<font color="#CCCCCC"> it's happy now and</font>

1039
00:40:50,850 --> 00:40:58,470
we are<font color="#CCCCCC"> now in programming mode now I can</font>

1040
00:40:54,150 --> 00:41:00,390
simply send a 3101<font color="#E5E5E5"> seven one six B which</font>

1041
00:40:58,470 --> 00:41:02,609
is this routine access control

1042
00:41:00,390 --> 00:41:05,310
I saw the tool will do it so now I can

1043
00:41:02,610 --> 00:41:07,080
replay<font color="#E5E5E5"> it</font><font color="#CCCCCC"> any time I want</font><font color="#E5E5E5"> and I</font><font color="#CCCCCC"> can go</font>

1044
00:41:05,310 --> 00:41:09,390
<font color="#E5E5E5">to different vehicles</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> just program</font>

1045
00:41:07,080 --> 00:41:11,910
<font color="#E5E5E5">their keys</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> them all I have to do is</font>

1046
00:41:09,390 --> 00:41:15,600
wait<font color="#CCCCCC"> 10 minutes</font><font color="#E5E5E5"> and there is no security</font>

1047
00:41:11,910 --> 00:41:17,430
so some OMS use some security<font color="#CCCCCC"> others do</font>

1048
00:41:15,600 --> 00:41:20,220
not<font color="#CCCCCC"> so that's just something to</font><font color="#E5E5E5"> be aware</font>

1049
00:41:17,430 --> 00:41:21,960
<font color="#E5E5E5">of just having a key programming tool</font>

1050
00:41:20,220 --> 00:41:24,520
will help<font color="#E5E5E5"> you get there and again</font><font color="#CCCCCC"> you</font>

1051
00:41:21,960 --> 00:41:27,020
can borrow them from eBay

1052
00:41:24,520 --> 00:41:28,910
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> so we introduced the new key after</font>

1053
00:41:27,020 --> 00:41:31,850
<font color="#E5E5E5">we've unlocked it and we get</font><font color="#CCCCCC"> a positive</font>

1054
00:41:28,910 --> 00:41:33,680
response<font color="#CCCCCC"> and if we request</font><font color="#E5E5E5"> to see how</font>

1055
00:41:31,850 --> 00:41:36,200
<font color="#E5E5E5">many keys are programmed again it</font>

1056
00:41:33,680 --> 00:41:38,480
<font color="#E5E5E5">increments from</font><font color="#CCCCCC"> o2 which was it</font><font color="#E5E5E5"> was what</font>

1057
00:41:36,200 --> 00:41:40,549
it was<font color="#E5E5E5"> before 203 now we have three keys</font>

1058
00:41:38,480 --> 00:41:42,650
programmed<font color="#E5E5E5"> which is good</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> means our</font>

1059
00:41:40,550 --> 00:41:44,120
key is<font color="#CCCCCC"> now</font><font color="#E5E5E5"> should be working and sure</font>

1060
00:41:42,650 --> 00:41:47,210
<font color="#CCCCCC">enough</font><font color="#E5E5E5"> I was</font><font color="#CCCCCC"> able to start the</font><font color="#E5E5E5"> vehicle</font>

1061
00:41:44,120 --> 00:41:48,740
<font color="#CCCCCC">after that success we have a key we</font>

1062
00:41:47,210 --> 00:41:50,210
could<font color="#E5E5E5"> drive it away just took me 10</font>

1063
00:41:48,740 --> 00:41:51,919
minutes<font color="#CCCCCC"> now</font><font color="#E5E5E5"> that might sound like a lot</font>

1064
00:41:50,210 --> 00:41:54,830
that's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> sixty</font><font color="#E5E5E5"> thousand milliseconds</font>

1065
00:41:51,920 --> 00:41:56,720
Robert<font color="#E5E5E5"> but in some cases that's all you</font>

1066
00:41:54,830 --> 00:41:58,640
need is<font color="#CCCCCC"> just</font><font color="#E5E5E5"> no security just ten</font>

1067
00:41:56,720 --> 00:42:01,040
<font color="#CCCCCC">minutes is this</font><font color="#E5E5E5"> the only security there</font>

1068
00:41:58,640 --> 00:42:02,480
and last met the last method<font color="#E5E5E5"> is kind</font><font color="#CCCCCC"> of</font>

1069
00:42:01,040 --> 00:42:05,779
<font color="#E5E5E5">just the hack the out of it</font>

1070
00:42:02,480 --> 00:42:07,040
<font color="#E5E5E5">right so I don't know what time how do I</font>

1071
00:42:05,780 --> 00:42:11,330
have in time<font color="#E5E5E5"> probably like one minute</font>

1072
00:42:07,040 --> 00:42:15,050
<font color="#CCCCCC">left so I'll be really fast here so we</font>

1073
00:42:11,330 --> 00:42:17,870
need<font color="#E5E5E5"> to find a way to bypass</font><font color="#CCCCCC"> mo bypass</font>

1074
00:42:15,050 --> 00:42:19,730
the immobilizer<font color="#CCCCCC"> so we have lots of chant</font>

1075
00:42:17,870 --> 00:42:22,580
channels we<font color="#CCCCCC"> have this change</font><font color="#E5E5E5"> trust which</font>

1076
00:42:19,730 --> 00:42:24,950
<font color="#CCCCCC">I already talked about here's a wiring</font>

1077
00:42:22,580 --> 00:42:27,290
<font color="#E5E5E5">diagram</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> ASCII so that's pretty cool</font>

1078
00:42:24,950 --> 00:42:29,390
<font color="#CCCCCC">nobody likes that</font><font color="#E5E5E5"> but if you notice</font>

1079
00:42:27,290 --> 00:42:30,890
<font color="#CCCCCC">there's a secure</font><font color="#E5E5E5"> K line I looked up a</font>

1080
00:42:29,390 --> 00:42:33,140
wiring diagram off the internet and

1081
00:42:30,890 --> 00:42:35,500
there's a secure K line and there's some

1082
00:42:33,140 --> 00:42:38,210
<font color="#CCCCCC">Lin traffic associated with this</font><font color="#E5E5E5"> request</font>

1083
00:42:35,500 --> 00:42:40,880
<font color="#CCCCCC">and I did a lot of research just</font><font color="#E5E5E5"> to kind</font>

1084
00:42:38,210 --> 00:42:43,220
of get it looked very cryptographically

1085
00:42:40,880 --> 00:42:45,290
secure<font color="#E5E5E5"> in fact when we did dump the</font>

1086
00:42:43,220 --> 00:42:47,629
firmware<font color="#E5E5E5"> on this dump the flash memory</font>

1087
00:42:45,290 --> 00:42:50,240
<font color="#E5E5E5">we found a lot of</font><font color="#CCCCCC"> s boxes and if you</font>

1088
00:42:47,630 --> 00:42:51,820
know s boxes<font color="#E5E5E5"> it</font><font color="#CCCCCC"> was a yes so we thought</font>

1089
00:42:50,240 --> 00:42:54,410
<font color="#CCCCCC">for sure this</font><font color="#E5E5E5"> is gonna be really tough</font>

1090
00:42:51,820 --> 00:42:57,230
<font color="#E5E5E5">until we found that of course we dump</font>

1091
00:42:54,410 --> 00:42:59,779
the firmware and guess what also<font color="#E5E5E5"> this</font>

1092
00:42:57,230 --> 00:43:02,660
the keys are in the memory as<font color="#E5E5E5"> well so</font>

1093
00:42:59,780 --> 00:43:04,090
let's<font color="#E5E5E5"> send a request to read memory so</font>

1094
00:43:02,660 --> 00:43:07,040
this is kind of what it looked like<font color="#E5E5E5"> on</font>

1095
00:43:04,090 --> 00:43:09,700
canvas but we<font color="#CCCCCC"> need it</font><font color="#E5E5E5"> secure we needed</font>

1096
00:43:07,040 --> 00:43:12,500
it like this time when<font color="#E5E5E5"> we wanted to read</font>

1097
00:43:09,700 --> 00:43:14,390
the<font color="#CCCCCC"> memory</font><font color="#E5E5E5"> we did require security</font>

1098
00:43:12,500 --> 00:43:17,000
access<font color="#E5E5E5"> so we had to unlock the</font>

1099
00:43:14,390 --> 00:43:19,370
controller using that method that we

1100
00:43:17,000 --> 00:43:21,800
described earlier about how to reverse

1101
00:43:19,370 --> 00:43:23,920
<font color="#CCCCCC">engineer the factory scan tool we were</font>

1102
00:43:21,800 --> 00:43:27,170
able<font color="#CCCCCC"> to quickly move through</font><font color="#E5E5E5"> and</font>

1103
00:43:23,920 --> 00:43:29,120
<font color="#CCCCCC">reverse-engineer using that the security</font>

1104
00:43:27,170 --> 00:43:31,190
access algorithms that<font color="#E5E5E5"> the OEM had</font>

1105
00:43:29,120 --> 00:43:32,450
<font color="#CCCCCC">provided for us</font><font color="#E5E5E5"> in their scan tool and</font>

1106
00:43:31,190 --> 00:43:34,340
even<font color="#CCCCCC"> if you don't want to reverse</font>

1107
00:43:32,450 --> 00:43:37,189
engineer<font color="#E5E5E5"> it you could have the OEM scan</font>

1108
00:43:34,340 --> 00:43:37,940
tool unlock the device<font color="#CCCCCC"> just</font><font color="#E5E5E5"> plugging it</font>

1109
00:43:37,190 --> 00:43:41,480
in<font color="#CCCCCC"> and then</font>

1110
00:43:37,940 --> 00:43:43,640
take<font color="#E5E5E5"> over</font><font color="#CCCCCC"> its session and start</font><font color="#E5E5E5"> sending</font>

1111
00:43:41,480 --> 00:43:45,230
<font color="#E5E5E5">memory read requests to dump the</font>

1112
00:43:43,640 --> 00:43:46,098
firmware<font color="#E5E5E5"> as well so there was another</font>

1113
00:43:45,230 --> 00:43:47,300
option<font color="#E5E5E5"> as well</font>

1114
00:43:46,099 --> 00:43:50,329
so we needed<font color="#E5E5E5"> to find the target</font>

1115
00:43:47,300 --> 00:43:52,310
processor<font color="#CCCCCC"> we had to open</font><font color="#E5E5E5"> it up once we</font>

1116
00:43:50,329 --> 00:43:56,060
<font color="#E5E5E5">had</font><font color="#CCCCCC"> it we had</font><font color="#E5E5E5"> the firmware</font><font color="#CCCCCC"> we just use</font>

1117
00:43:52,310 --> 00:43:58,310
Ida<font color="#CCCCCC"> we found the</font><font color="#E5E5E5"> AES secret key lived in</font>

1118
00:43:56,060 --> 00:44:01,520
this particular memory address because

1119
00:43:58,310 --> 00:44:03,950
<font color="#CCCCCC">it kept referencing this dress this</font><font color="#E5E5E5"> is</font>

1120
00:44:01,520 --> 00:44:08,119
on a real<font color="#CCCCCC"> vehicle</font><font color="#E5E5E5"> I'll show you the</font><font color="#CCCCCC"> in</font>

1121
00:44:03,950 --> 00:44:10,640
<font color="#E5E5E5">just a second</font><font color="#CCCCCC"> we were able</font><font color="#E5E5E5"> to find the</font>

1122
00:44:08,119 --> 00:44:13,190
there's actually a key identifier as

1123
00:44:10,640 --> 00:44:15,589
well<font color="#E5E5E5"> key fob ID which was required for</font>

1124
00:44:13,190 --> 00:44:17,210
bypassing<font color="#CCCCCC"> as well we</font><font color="#E5E5E5"> found that as</font>

1125
00:44:15,589 --> 00:44:19,880
<font color="#E5E5E5">memory in memory so I could walk up</font><font color="#CCCCCC"> to</font>

1126
00:44:17,210 --> 00:44:22,160
the vehicle<font color="#E5E5E5"> and essentially with the</font>

1127
00:44:19,880 --> 00:44:24,470
with AES which we know the security

1128
00:44:22,160 --> 00:44:28,310
<font color="#E5E5E5">algorithm with just the secret key and</font>

1129
00:44:24,470 --> 00:44:28,819
the key fob ID<font color="#E5E5E5"> I was able to start the</font>

1130
00:44:28,310 --> 00:44:31,670
<font color="#E5E5E5">vehicle</font>

1131
00:44:28,819 --> 00:44:33,950
so we just calculated crypto a

1132
00:44:31,670 --> 00:44:35,750
cryptographic<font color="#E5E5E5"> response and</font><font color="#CCCCCC"> I'm a</font><font color="#E5E5E5"> small</font>

1133
00:44:33,950 --> 00:44:39,569
<font color="#E5E5E5">video</font>

1134
00:44:35,750 --> 00:44:41,820
of me if<font color="#CCCCCC"> you've open</font>

1135
00:44:39,570 --> 00:44:45,410
look at there's me<font color="#E5E5E5"> look at no key it's</font>

1136
00:44:41,820 --> 00:44:47,970
hard to see<font color="#E5E5E5"> well I'll get no key driving</font>

1137
00:44:45,410 --> 00:44:48,660
<font color="#E5E5E5">don't look at the car</font><font color="#CCCCCC"> it's that's not</font>

1138
00:44:47,970 --> 00:44:52,109
<font color="#E5E5E5">important</font>

1139
00:44:48,660 --> 00:44:54,390
here it is<font color="#E5E5E5"> driving away car key in the</font>

1140
00:44:52,110 --> 00:44:56,700
vehicle<font color="#E5E5E5"> that's pretty exciting</font><font color="#CCCCCC"> so I was</font>

1141
00:44:54,390 --> 00:45:01,920
able to borrow<font color="#E5E5E5"> my own car it was mine</font>

1142
00:44:56,700 --> 00:45:06,210
potentially<font color="#CCCCCC"> and that's what I've told</font>

1143
00:45:01,920 --> 00:45:08,430
the<font color="#E5E5E5"> cops</font><font color="#CCCCCC"> so able to just plug in</font>

1144
00:45:06,210 --> 00:45:11,130
essentially connect to the vehicle and

1145
00:45:08,430 --> 00:45:12,509
without a key do that<font color="#E5E5E5"> so let's talk</font>

1146
00:45:11,130 --> 00:45:15,150
about<font color="#E5E5E5"> the law first of all I'm not a</font>

1147
00:45:12,510 --> 00:45:18,630
lawyer<font color="#CCCCCC"> it's the truth but I do play one</font>

1148
00:45:15,150 --> 00:45:21,450
on stage and in<font color="#E5E5E5"> the u.s. we have DCMA so</font>

1149
00:45:18,630 --> 00:45:23,370
we're allowed to<font color="#E5E5E5"> and here's the</font>

1150
00:45:21,450 --> 00:45:25,350
exemption<font color="#E5E5E5"> that we have in the United</font>

1151
00:45:23,370 --> 00:45:27,600
States<font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't know if you guys have it</font>

1152
00:45:25,350 --> 00:45:29,819
here so I<font color="#E5E5E5"> apologize if you don't but in</font>

1153
00:45:27,600 --> 00:45:33,630
the<font color="#CCCCCC"> US they just recently</font><font color="#E5E5E5"> made it legal</font>

1154
00:45:29,820 --> 00:45:36,510
to hack cars<font color="#CCCCCC"> and specifically we</font><font color="#E5E5E5"> can</font>

1155
00:45:33,630 --> 00:45:40,740
hack cars of our<font color="#E5E5E5"> own car right we can do</font>

1156
00:45:36,510 --> 00:45:42,780
<font color="#E5E5E5">that to our own as long</font><font color="#CCCCCC"> as it's as long</font>

1157
00:45:40,740 --> 00:45:44,850
<font color="#CCCCCC">as it's research so we were allowed to</font>

1158
00:45:42,780 --> 00:45:46,920
do<font color="#E5E5E5"> that here</font><font color="#CCCCCC"> in the and the at least</font><font color="#E5E5E5"> in</font>

1159
00:45:44,850 --> 00:45:50,040
the United States<font color="#E5E5E5"> but in my experience</font>

1160
00:45:46,920 --> 00:45:52,350
I've been doing this now<font color="#CCCCCC"> for</font><font color="#E5E5E5"> I mean I'm</font>

1161
00:45:50,040 --> 00:45:54,810
<font color="#CCCCCC">in</font><font color="#E5E5E5"> had cars for about 20</font><font color="#CCCCCC"> years now</font>

1162
00:45:52,350 --> 00:45:57,210
<font color="#CCCCCC">Oh II am sure pretty open</font><font color="#E5E5E5"> I've only had</font>

1163
00:45:54,810 --> 00:45:58,730
one cease-and-desist<font color="#E5E5E5"> in my life that's</font>

1164
00:45:57,210 --> 00:46:02,490
pretty good

1165
00:45:58,730 --> 00:46:03,480
maybe I'll get<font color="#CCCCCC"> two</font><font color="#E5E5E5"> after this</font><font color="#CCCCCC"> but we</font><font color="#E5E5E5"> got</font>

1166
00:46:02,490 --> 00:46:05,819
to proceed with caution

1167
00:46:03,480 --> 00:46:08,370
<font color="#CCCCCC">if it's your car you're probably</font><font color="#E5E5E5"> good</font>

1168
00:46:05,820 --> 00:46:10,320
it's not don't<font color="#E5E5E5"> do that just don't crash</font>

1169
00:46:08,370 --> 00:46:12,480
<font color="#E5E5E5">in anyone so always a good step</font><font color="#CCCCCC"> when are</font>

1170
00:46:10,320 --> 00:46:15,810
you doing car hacking<font color="#CCCCCC"> and don't steal</font>

1171
00:46:12,480 --> 00:46:17,760
cars<font color="#E5E5E5"> should borrow them right so</font><font color="#CCCCCC"> just do</font>

1172
00:46:15,810 --> 00:46:20,100
<font color="#CCCCCC">that</font><font color="#E5E5E5"> okay</font>

1173
00:46:17,760 --> 00:46:21,750
a little bit about how<font color="#E5E5E5"> to learn more I'm</font>

1174
00:46:20,100 --> 00:46:24,120
not<font color="#E5E5E5"> sure I'm doing that time but I might</font>

1175
00:46:21,750 --> 00:46:26,640
<font color="#E5E5E5">be over</font><font color="#CCCCCC"> I think I'm over a little</font><font color="#E5E5E5"> bit</font><font color="#CCCCCC"> so</font>

1176
00:46:24,120 --> 00:46:30,509
I do host<font color="#CCCCCC"> the class at blackhat about</font>

1177
00:46:26,640 --> 00:46:32,520
car hacking<font color="#E5E5E5"> I do hunt site clacking but</font>

1178
00:46:30,510 --> 00:46:34,110
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can also</font><font color="#E5E5E5"> visit our</font><font color="#CCCCCC"> website</font><font color="#E5E5E5"> car</font>

1179
00:46:32,520 --> 00:46:35,630
hacking<font color="#CCCCCC"> village</font><font color="#E5E5E5"> comm follow me on</font>

1180
00:46:34,110 --> 00:46:37,400
<font color="#E5E5E5">Twitter</font>

1181
00:46:35,630 --> 00:46:39,890
and you can also use the Google thing

1182
00:46:37,400 --> 00:46:41,359
<font color="#CCCCCC">also one real good shout</font><font color="#E5E5E5"> out for</font>

1183
00:46:39,890 --> 00:46:43,879
somebody<font color="#E5E5E5"> else</font><font color="#CCCCCC"> That's not</font><font color="#E5E5E5"> me</font>

1184
00:46:41,359 --> 00:46:46,009
comedy I has a really good<font color="#E5E5E5"> github</font>

1185
00:46:43,880 --> 00:46:48,440
<font color="#CCCCCC">they're trying to build databases of car</font>

1186
00:46:46,009 --> 00:46:50,779
information<font color="#CCCCCC"> I really love it</font>

1187
00:46:48,440 --> 00:46:54,700
check it out<font color="#CCCCCC"> thank you</font><font color="#E5E5E5"> very much and</font>

1188
00:46:50,779 --> 00:46:54,700
<font color="#CCCCCC">Mexi thanks</font>

1189
00:47:08,850 --> 00:47:17,710
thank you very much troubled<font color="#CCCCCC"> I think</font>

1190
00:47:13,490 --> 00:47:21,078
I think we were making just<font color="#CCCCCC"> one question</font>

1191
00:47:17,710 --> 00:47:24,109
<font color="#CCCCCC">and so then we are</font><font color="#E5E5E5"> going to terminate</font>

1192
00:47:21,079 --> 00:47:27,670
the<font color="#CCCCCC"> talks because you can meet obviously</font>

1193
00:47:24,109 --> 00:47:27,670
you can meet Robert<font color="#CCCCCC"> after the talk so</font>

1194
00:47:28,510 --> 00:47:34,010
<font color="#E5E5E5">yeah</font><font color="#CCCCCC"> he so he's doing a workshop</font><font color="#E5E5E5"> and you</font>

1195
00:47:31,790 --> 00:47:36,829
can meet<font color="#E5E5E5"> him at his workshop</font><font color="#CCCCCC"> ask him</font>

1196
00:47:34,010 --> 00:47:39,619
anything you<font color="#CCCCCC"> want enjoy what has to show</font>

1197
00:47:36,829 --> 00:47:46,359
you so<font color="#E5E5E5"> just one question</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> order for us</font>

1198
00:47:39,619 --> 00:47:46,359
to finish<font color="#E5E5E5"> anyone</font><font color="#CCCCCC"> cereal from</font><font color="#E5E5E5"> your home</font>

1199
00:47:52,460 --> 00:47:54,520
you

1200
00:47:55,809 --> 00:48:02,019
if you take the defenders side of things

1201
00:47:58,829 --> 00:48:07,479
<font color="#CCCCCC">what kind of forensics can you do on a</font>

1202
00:48:02,019 --> 00:48:09,279
car<font color="#E5E5E5"> that acts like</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> well okay</font>

1203
00:48:07,479 --> 00:48:11,049
can you okay so from a forensics point

1204
00:48:09,279 --> 00:48:13,450
of view<font color="#E5E5E5"> all of these message that I'm</font>

1205
00:48:11,049 --> 00:48:16,479
<font color="#CCCCCC">sending should never really</font><font color="#E5E5E5"> be there</font>

1206
00:48:13,450 --> 00:48:18,669
<font color="#E5E5E5">right</font><font color="#CCCCCC"> unless a dealer's tool is hooked</font>

1207
00:48:16,479 --> 00:48:21,189
<font color="#E5E5E5">up now if a dealer tool is hooked up</font>

1208
00:48:18,670 --> 00:48:23,079
<font color="#E5E5E5">they probably use a very standard way of</font>

1209
00:48:21,190 --> 00:48:24,549
requesting this information and<font color="#E5E5E5"> most of</font>

1210
00:48:23,079 --> 00:48:28,839
the time when I'm doing it I'm using a

1211
00:48:24,549 --> 00:48:30,970
non-standard dealer tool<font color="#CCCCCC"> so I think</font><font color="#E5E5E5"> it's</font>

1212
00:48:28,839 --> 00:48:33,339
probably<font color="#CCCCCC"> easy</font><font color="#E5E5E5"> to see with timing</font><font color="#CCCCCC"> and</font>

1213
00:48:30,970 --> 00:48:37,058
it's also easy to see what the<font color="#E5E5E5"> messages</font>

1214
00:48:33,339 --> 00:48:39,099
<font color="#CCCCCC">that are sent that something unusual is</font>

1215
00:48:37,059 --> 00:48:41,650
<font color="#CCCCCC">happening on the network</font><font color="#E5E5E5"> because of how</font>

1216
00:48:39,099 --> 00:48:44,920
close<font color="#CCCCCC"> these systems are any unusual</font>

1217
00:48:41,650 --> 00:48:48,839
<font color="#E5E5E5">message is a red flag immediately</font><font color="#CCCCCC"> so</font>

1218
00:48:44,920 --> 00:48:51,460
it'd<font color="#CCCCCC"> be really easy</font><font color="#E5E5E5"> from a from a from a</font>

1219
00:48:48,839 --> 00:48:52,808
forensic standpoint<font color="#E5E5E5"> to determine this</font>

1220
00:48:51,460 --> 00:48:55,210
<font color="#CCCCCC">was something</font><font color="#E5E5E5"> bad was happening on</font><font color="#CCCCCC"> this</font>

1221
00:48:52,809 --> 00:48:56,950
car<font color="#E5E5E5"> but then you got to store it you got</font>

1222
00:48:55,210 --> 00:49:00,279
to transmit it you got to<font color="#CCCCCC"> notify the</font>

1223
00:48:56,950 --> 00:49:03,489
<font color="#CCCCCC">end-users</font><font color="#E5E5E5"> and some service so</font><font color="#CCCCCC"> again I'll</font>

1224
00:49:00,279 --> 00:49:06,430
be doing a workshop<font color="#CCCCCC"> I think so see</font>

1225
00:49:03,489 --> 00:49:08,229
something<font color="#CCCCCC"> like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> I'll be doing a</font>

1226
00:49:06,430 --> 00:49:11,078
workshop I don't have a enough for

1227
00:49:08,229 --> 00:49:13,029
<font color="#E5E5E5">everybody so but this small works out</font>

1228
00:49:11,079 --> 00:49:14,469
but please<font color="#E5E5E5"> come and hang out and ask me</font>

1229
00:49:13,029 --> 00:49:16,509
some questions afterwards<font color="#E5E5E5"> but I have to</font>

1230
00:49:14,469 --> 00:49:18,339
head right there so that's where I'll<font color="#CCCCCC"> be</font>

1231
00:49:16,509 --> 00:49:20,999
if<font color="#CCCCCC"> you need me</font><font color="#E5E5E5"> thanks Robert</font>

1232
00:49:18,339 --> 00:49:20,999
thank you very<font color="#E5E5E5"> much</font>

