1
00:00:02,879 --> 00:00:04,160
so this is actually refreshing because

2
00:00:04,160 --> 00:00:05,839
this is the first presentation i've done

3
00:00:05,839 --> 00:00:07,279
live in front of an audience in two

4
00:00:07,279 --> 00:00:08,880
years which means i don't get the whole

5
00:00:08,880 --> 00:00:10,639
cheating of actually looking at my notes

6
00:00:10,639 --> 00:00:12,799
into a zoom screen anymore so if i

7
00:00:12,799 --> 00:00:14,639
forget where i am if i drew that's why

8
00:00:14,639 --> 00:00:16,720
out of practice so what we're going to

9
00:00:16,720 --> 00:00:18,800
do today is we're going to talk through

10
00:00:18,800 --> 00:00:21,119
um the evolution of modern ransomware

11
00:00:21,119 --> 00:00:22,640
and how we kind of got to this point

12
00:00:22,640 --> 00:00:24,480
over time so we'll go through the

13
00:00:24,480 --> 00:00:26,320
tactics techniques and procedures that

14
00:00:26,320 --> 00:00:28,160
these different groups use we'll talk

15
00:00:28,160 --> 00:00:30,160
about how you can understand that to use

16
00:00:30,160 --> 00:00:32,000
it to defend against them but most of

17
00:00:32,000 --> 00:00:34,000
all i want to under let you understand

18
00:00:34,000 --> 00:00:35,920
how we got to where we are today and

19
00:00:35,920 --> 00:00:38,320
where it's likely to go next

20
00:00:38,320 --> 00:00:40,559
so we'll start off with this this is a

21
00:00:40,559 --> 00:00:43,280
really important slide this is the aids

22
00:00:43,280 --> 00:00:45,280
ransomware trojan and the reason why

23
00:00:45,280 --> 00:00:47,120
it's important is it shows up in just

24
00:00:47,120 --> 00:00:49,680
about every damn ransomware presentation

25
00:00:49,680 --> 00:00:51,120
where somebody will normally show you a

26
00:00:51,120 --> 00:00:52,480
picture of a five and a quarter inch

27
00:00:52,480 --> 00:00:54,480
floppy disk and tell you that ransomware

28
00:00:54,480 --> 00:00:57,520
all started back in 1989 with this thing

29
00:00:57,520 --> 00:00:58,640
it didn't

30
00:00:58,640 --> 00:01:01,199
um it's true that malware that could

31
00:01:01,199 --> 00:01:04,000
encrypt devices and um you know networks

32
00:01:04,000 --> 00:01:06,720
and so on did exist back then but this

33
00:01:06,720 --> 00:01:08,640
trojan has about as much in common with

34
00:01:08,640 --> 00:01:11,040
today's modern ransomware as a cart

35
00:01:11,040 --> 00:01:12,720
pulled by a half-blind donkey called

36
00:01:12,720 --> 00:01:14,799
dave has with a high-end tesla it's

37
00:01:14,799 --> 00:01:16,560
utterly irrelevant

38
00:01:16,560 --> 00:01:18,400
so what we're going to talk about

39
00:01:18,400 --> 00:01:21,680
instead is ransomware as service so what

40
00:01:21,680 --> 00:01:23,360
is ransomware as a service and how did

41
00:01:23,360 --> 00:01:25,119
we get to kind of where we are well

42
00:01:25,119 --> 00:01:27,040
we'll fast we'll go back in time a bit

43
00:01:27,040 --> 00:01:28,960
to about the 2000s first of all to tell

44
00:01:28,960 --> 00:01:30,880
you what was kind of before this and

45
00:01:30,880 --> 00:01:33,759
that was theft based um

46
00:01:33,759 --> 00:01:35,840
cybercrime models so by and large

47
00:01:35,840 --> 00:01:37,759
whether it was banking trojans credit

48
00:01:37,759 --> 00:01:40,000
card stealing password dealing doesn't

49
00:01:40,000 --> 00:01:42,159
matter all of the ransomware or sorry

50
00:01:42,159 --> 00:01:44,000
all of the malware back then was focused

51
00:01:44,000 --> 00:01:45,759
on stealing information and then

52
00:01:45,759 --> 00:01:48,000
monetizing it by selling it in some way

53
00:01:48,000 --> 00:01:50,880
shape or form right and that was highly

54
00:01:50,880 --> 00:01:52,560
successful for a long time or at least

55
00:01:52,560 --> 00:01:54,399
it was successful by those standards

56
00:01:54,399 --> 00:01:56,640
it's nothing compared to what ransomware

57
00:01:56,640 --> 00:01:58,799
um does today

58
00:01:58,799 --> 00:02:01,200
fast forward a bit later and we

59
00:02:01,200 --> 00:02:03,680
notice that a whole service industry

60
00:02:03,680 --> 00:02:06,399
spins up in the kind of malware

61
00:02:06,399 --> 00:02:08,878
infrastructure so whether this was the

62
00:02:08,878 --> 00:02:11,760
case of the the kind of emerging cloud

63
00:02:11,760 --> 00:02:13,360
industry that was out at the time and

64
00:02:13,360 --> 00:02:15,520
people seen how successful that was or

65
00:02:15,520 --> 00:02:17,200
maybe some cyber criminals got a jeff

66
00:02:17,200 --> 00:02:18,959
bezos biography for christmas i'm not

67
00:02:18,959 --> 00:02:21,440
entirely sure but either way everything

68
00:02:21,440 --> 00:02:23,599
started to become services so you want

69
00:02:23,599 --> 00:02:26,480
to send um phishing emails you want to

70
00:02:26,480 --> 00:02:28,480
um compromise networks you want to do

71
00:02:28,480 --> 00:02:30,000
money laundering you want to any of that

72
00:02:30,000 --> 00:02:32,160
stuff there's a service first so if you

73
00:02:32,160 --> 00:02:34,000
want to think of an analogy

74
00:02:34,000 --> 00:02:36,000
imagine spam imagine you want to get

75
00:02:36,000 --> 00:02:37,840
your malware out to as many people

76
00:02:37,840 --> 00:02:39,920
around the world as you possibly want to

77
00:02:39,920 --> 00:02:42,239
so instead of having to code all that

78
00:02:42,239 --> 00:02:43,599
yourself which would have been the the

79
00:02:43,599 --> 00:02:45,440
previous way of doing things you'd

80
00:02:45,440 --> 00:02:47,360
simply go and find a service provider

81
00:02:47,360 --> 00:02:48,959
who will send the spam for you and they

82
00:02:48,959 --> 00:02:50,879
will guarantee you know a million spam

83
00:02:50,879 --> 00:02:52,319
per day and they will get it delivered

84
00:02:52,319 --> 00:02:54,560
to certain countries and so on and the

85
00:02:54,560 --> 00:02:56,640
nice part of the service model is you

86
00:02:56,640 --> 00:02:58,080
don't need to understand how that

87
00:02:58,080 --> 00:02:59,840
actually works right you just trust that

88
00:02:59,840 --> 00:03:01,519
there is a good reputation and they'll

89
00:03:01,519 --> 00:03:03,920
do what they said they would so whether

90
00:03:03,920 --> 00:03:05,599
they're doing it through a whole bot net

91
00:03:05,599 --> 00:03:07,280
of machines they're using for spamming

92
00:03:07,280 --> 00:03:08,879
or they've compromised mail servers

93
00:03:08,879 --> 00:03:10,800
around the world doesn't really matter

94
00:03:10,800 --> 00:03:12,720
not your problem just like when you spin

95
00:03:12,720 --> 00:03:16,159
up a ec2 instance in a cloud and amazon

96
00:03:16,159 --> 00:03:17,440
you don't really need to know how it

97
00:03:17,440 --> 00:03:18,720
works under the

98
00:03:18,720 --> 00:03:20,400
hood as long as it works everything's

99
00:03:20,400 --> 00:03:22,640
good and everything's happy days

100
00:03:22,640 --> 00:03:24,400
the other advantage of this service

101
00:03:24,400 --> 00:03:26,319
model is it makes things incredibly

102
00:03:26,319 --> 00:03:28,879
scalable for criminals so now when you

103
00:03:28,879 --> 00:03:30,879
want to run a criminal business you just

104
00:03:30,879 --> 00:03:32,319
need to come up with the idea the

105
00:03:32,319 --> 00:03:34,000
business model essentially stitch

106
00:03:34,000 --> 00:03:35,599
together all the different services you

107
00:03:35,599 --> 00:03:37,680
need to make that happen and then you do

108
00:03:37,680 --> 00:03:40,159
a quick calculation that if the money

109
00:03:40,159 --> 00:03:42,959
you're paying out for those services is

110
00:03:42,959 --> 00:03:44,480
less than the amount of money that you

111
00:03:44,480 --> 00:03:46,959
will make and it will be then you have a

112
00:03:46,959 --> 00:03:48,640
profitable criminal business and it's

113
00:03:48,640 --> 00:03:49,920
just a case of running that and it's

114
00:03:49,920 --> 00:03:51,840
really really scalable

115
00:03:51,840 --> 00:03:53,439
the other thing that evolved over this

116
00:03:53,439 --> 00:03:56,319
time period was ransomware itself

117
00:03:56,319 --> 00:03:58,080
so i mentioned that before kind of

118
00:03:58,080 --> 00:04:00,319
ransomware became as big as it is today

119
00:04:00,319 --> 00:04:03,280
we had mostly theft based models right

120
00:04:03,280 --> 00:04:04,959
theft is the crime that actually it all

121
00:04:04,959 --> 00:04:07,120
boils down to banking trojans whatever

122
00:04:07,120 --> 00:04:09,760
it doesn't matter the core crime was

123
00:04:09,760 --> 00:04:11,439
theft of information

124
00:04:11,439 --> 00:04:13,120
there's a problem though with theft of

125
00:04:13,120 --> 00:04:14,959
information so as our information got

126
00:04:14,959 --> 00:04:17,279
bigger and bigger the theft of it

127
00:04:17,279 --> 00:04:18,959
actually is hard to monetize so if you

128
00:04:18,959 --> 00:04:21,600
can imagine i had my laptop my work

129
00:04:21,600 --> 00:04:23,680
laptop in front of me here and somebody

130
00:04:23,680 --> 00:04:25,440
in the audience actually compromises the

131
00:04:25,440 --> 00:04:28,000
work laptop and they have access now to

132
00:04:28,000 --> 00:04:30,880
gigabytes of trend micro software

133
00:04:30,880 --> 00:04:33,360
projects i'm working on my email

134
00:04:33,360 --> 00:04:35,680
folder with star wars fan fiction if you

135
00:04:35,680 --> 00:04:37,199
really want that one

136
00:04:37,199 --> 00:04:38,880
all that sort of stuff

137
00:04:38,880 --> 00:04:40,479
that's great but i want you to think

138
00:04:40,479 --> 00:04:42,720
like criminals for a minute and think

139
00:04:42,720 --> 00:04:44,960
how do you monetize that so first of all

140
00:04:44,960 --> 00:04:46,960
who would you sell that to and how much

141
00:04:46,960 --> 00:04:48,960
would you charge for it right there is

142
00:04:48,960 --> 00:04:50,720
an underground community of star wars

143
00:04:50,720 --> 00:04:52,320
reylo fans who will pay good money for

144
00:04:52,320 --> 00:04:53,759
some of the stuff i've written but good

145
00:04:53,759 --> 00:04:55,840
luck finding those people right so

146
00:04:55,840 --> 00:04:58,000
instead they thought well this is bad

147
00:04:58,000 --> 00:04:59,440
enough when we have just bob's laptop

148
00:04:59,440 --> 00:05:00,960
what about we have a thousand people's

149
00:05:00,960 --> 00:05:03,440
computers to go through on a daily basis

150
00:05:03,440 --> 00:05:05,440
so they did instead is they came up at a

151
00:05:05,440 --> 00:05:07,520
different model and that is quite simply

152
00:05:07,520 --> 00:05:10,000
extortion instead of theft right

153
00:05:10,000 --> 00:05:12,320
fundamentally different type of crime

154
00:05:12,320 --> 00:05:14,720
the idea here is they know the data on

155
00:05:14,720 --> 00:05:17,039
the compromised machine is valuable but

156
00:05:17,039 --> 00:05:18,479
they don't know to who it's actually

157
00:05:18,479 --> 00:05:20,320
valuable right but there's one person

158
00:05:20,320 --> 00:05:22,240
that absolutely definitely thinks that

159
00:05:22,240 --> 00:05:23,919
information is valuable that's you

160
00:05:23,919 --> 00:05:26,000
because it's your data right so simply

161
00:05:26,000 --> 00:05:28,000
denying you access to that data and then

162
00:05:28,000 --> 00:05:29,759
charging you for it back means they've

163
00:05:29,759 --> 00:05:32,479
got a guaranteed customer in these cases

164
00:05:32,479 --> 00:05:34,720
and that and then led to this emergence

165
00:05:34,720 --> 00:05:36,560
of extortion based crime so

166
00:05:36,560 --> 00:05:38,000
fundamentally different as i said from

167
00:05:38,000 --> 00:05:39,919
the theft based crime that went before

168
00:05:39,919 --> 00:05:41,919
and as we see it actually can be a lot

169
00:05:41,919 --> 00:05:44,000
more profitable

170
00:05:44,000 --> 00:05:46,000
so what i'm going to do next is i want

171
00:05:46,000 --> 00:05:48,560
to take us through an evolution a bit

172
00:05:48,560 --> 00:05:50,000
over time that's a high level view but

173
00:05:50,000 --> 00:05:51,759
like how did we kind of evolve through

174
00:05:51,759 --> 00:05:53,199
the different stages of ransomware to

175
00:05:53,199 --> 00:05:54,720
this point

176
00:05:54,720 --> 00:05:56,720
well first of all if we have to start

177
00:05:56,720 --> 00:05:58,319
out the very start of ransomware we

178
00:05:58,319 --> 00:05:59,919
start with no no i'm missing we're not

179
00:05:59,919 --> 00:06:01,919
going to go through this right not this

180
00:06:01,919 --> 00:06:04,240
skipping ahead the early days of

181
00:06:04,240 --> 00:06:07,199
ransomware were about 2010 ish

182
00:06:07,199 --> 00:06:08,960
approximately and back then what

183
00:06:08,960 --> 00:06:10,639
ransomware looked like might look

184
00:06:10,639 --> 00:06:12,479
completely different to what you see

185
00:06:12,479 --> 00:06:14,319
with ransomware today so i assume

186
00:06:14,319 --> 00:06:15,919
everybody knows how ransomware generally

187
00:06:15,919 --> 00:06:18,560
works you deploy malware on a machine it

188
00:06:18,560 --> 00:06:20,639
encrypts files that are important to

189
00:06:20,639 --> 00:06:22,960
that person and then it charges a ransom

190
00:06:22,960 --> 00:06:24,479
through some note of some description

191
00:06:24,479 --> 00:06:26,240
and says pay this money and you get your

192
00:06:26,240 --> 00:06:28,400
files back simple out right

193
00:06:28,400 --> 00:06:30,639
so back in about 2010 how this worked

194
00:06:30,639 --> 00:06:32,400
was it was primarily targeting home

195
00:06:32,400 --> 00:06:34,800
users and the ransom amounts were kind

196
00:06:34,800 --> 00:06:37,120
of in the hundreds or maybe thousands

197
00:06:37,120 --> 00:06:38,720
and part of the limiting factor there

198
00:06:38,720 --> 00:06:41,280
was how they had to get paid so

199
00:06:41,280 --> 00:06:43,280
a lot of the payment uh ransomware if

200
00:06:43,280 --> 00:06:45,039
you see back then was actually paid over

201
00:06:45,039 --> 00:06:47,759
like sms not like just a straight up sms

202
00:06:47,759 --> 00:06:49,680
but some countries have systems where

203
00:06:49,680 --> 00:06:52,080
you can send funds uh up to hundreds or

204
00:06:52,080 --> 00:06:54,400
thousands over sms so for example in

205
00:06:54,400 --> 00:06:55,919
russia and some of the russian-speaking

206
00:06:55,919 --> 00:06:57,440
countries has happened

207
00:06:57,440 --> 00:06:59,599
the downside to that is it was good

208
00:06:59,599 --> 00:07:02,240
money by the time but it also is limited

209
00:07:02,240 --> 00:07:04,080
by geography right so if you have a

210
00:07:04,080 --> 00:07:05,520
russian number and your ransomware is

211
00:07:05,520 --> 00:07:06,800
only going to work for them it's not

212
00:07:06,800 --> 00:07:07,840
going to work in ireland you have to

213
00:07:07,840 --> 00:07:09,680
find a you know equivalent service to

214
00:07:09,680 --> 00:07:11,120
make it work over here and so on so it

215
00:07:11,120 --> 00:07:13,680
doesn't scale particularly well

216
00:07:13,680 --> 00:07:15,199
fast forward a bit

217
00:07:15,199 --> 00:07:17,199
and we have the start of much more mass

218
00:07:17,199 --> 00:07:19,759
ransomware so the big differentiator

219
00:07:19,759 --> 00:07:22,000
here was bitcoin so with bitcoin

220
00:07:22,000 --> 00:07:24,560
emerging you now had a way that anybody

221
00:07:24,560 --> 00:07:26,240
in the world who could essentially buy

222
00:07:26,240 --> 00:07:28,560
bitcoin for some local exchange can now

223
00:07:28,560 --> 00:07:30,880
transfer money to the criminal right and

224
00:07:30,880 --> 00:07:32,880
even nicer there's a whole anonymizing

225
00:07:32,880 --> 00:07:34,800
nature that comes with bitcoin as well

226
00:07:34,800 --> 00:07:37,440
so it makes it even even nicer for them

227
00:07:37,440 --> 00:07:38,479
so

228
00:07:38,479 --> 00:07:40,240
this then led to the spread of mass

229
00:07:40,240 --> 00:07:42,319
ransomware on a global scale where they

230
00:07:42,319 --> 00:07:44,400
could get paid and in the process this

231
00:07:44,400 --> 00:07:45,759
was kind of when we moved from a

232
00:07:45,759 --> 00:07:47,759
targeting home users to it also hitting

233
00:07:47,759 --> 00:07:49,599
companies it didn't really so much

234
00:07:49,599 --> 00:07:51,360
target companies as the fact that it was

235
00:07:51,360 --> 00:07:53,520
just hitting everything and that was

236
00:07:53,520 --> 00:07:55,599
also affecting customer or companies as

237
00:07:55,599 --> 00:07:56,960
well

238
00:07:56,960 --> 00:07:58,479
fast forward a little bit further and we

239
00:07:58,479 --> 00:07:59,919
get to the start of what's kind of

240
00:07:59,919 --> 00:08:02,639
modern ransomware um at the moment so

241
00:08:02,639 --> 00:08:04,479
the key differentiator was in a couple

242
00:08:04,479 --> 00:08:06,160
of years after ransomware went and

243
00:08:06,160 --> 00:08:08,080
exploded all the different security

244
00:08:08,080 --> 00:08:09,759
vendors basically upgraded their

245
00:08:09,759 --> 00:08:11,599
solutions taught about it figured out

246
00:08:11,599 --> 00:08:13,520
how to stop it and generally speaking if

247
00:08:13,520 --> 00:08:15,120
you have a modern kind of security

248
00:08:15,120 --> 00:08:17,120
solution that does things like can

249
00:08:17,120 --> 00:08:18,879
detect encryption when it's happening

250
00:08:18,879 --> 00:08:21,440
right do any method protect certain

251
00:08:21,440 --> 00:08:23,280
folders from being even accessed you

252
00:08:23,280 --> 00:08:25,120
know has decent backups all of those

253
00:08:25,120 --> 00:08:27,840
type of things make a really big dent in

254
00:08:27,840 --> 00:08:30,560
stopping ransomware as we know it unless

255
00:08:30,560 --> 00:08:32,399
of course you know some scenario where

256
00:08:32,399 --> 00:08:33,839
the attackers had compromised the

257
00:08:33,839 --> 00:08:36,000
network so completely that they had full

258
00:08:36,000 --> 00:08:38,080
admin access of the network and they've

259
00:08:38,080 --> 00:08:39,839
disabled all of those security solutions

260
00:08:39,839 --> 00:08:41,440
in which case you're screwed right but

261
00:08:41,440 --> 00:08:43,200
that's not going to really happen turns

262
00:08:43,200 --> 00:08:45,040
out that's exactly what happens so

263
00:08:45,040 --> 00:08:47,120
because these security solutions were

264
00:08:47,120 --> 00:08:48,800
getting better the criminals needed a

265
00:08:48,800 --> 00:08:50,560
way to get around that and the easiest

266
00:08:50,560 --> 00:08:52,640
way to do that was moving from a more

267
00:08:52,640 --> 00:08:55,440
mass ransomware type approach then to a

268
00:08:55,440 --> 00:08:57,120
heavily targeted approach where there

269
00:08:57,120 --> 00:08:59,040
would be actually humans on the network

270
00:08:59,040 --> 00:09:00,800
disabling security software working

271
00:09:00,800 --> 00:09:02,640
their way around and so on and obviously

272
00:09:02,640 --> 00:09:04,800
to make that whole model uh work you

273
00:09:04,800 --> 00:09:06,800
have to charge more money for it or make

274
00:09:06,800 --> 00:09:08,640
more money out of every single victim

275
00:09:08,640 --> 00:09:10,560
and that brings us up to what we kind of

276
00:09:10,560 --> 00:09:12,720
see today with the kind of modern double

277
00:09:12,720 --> 00:09:14,959
extortion ransomware which i'll get into

278
00:09:14,959 --> 00:09:16,240
in just a minute so it's much more

279
00:09:16,240 --> 00:09:17,519
targeted it's no longer the kind of

280
00:09:17,519 --> 00:09:19,440
volume business we saw in the past but

281
00:09:19,440 --> 00:09:22,160
the ransoms can be exceptionally high

282
00:09:22,160 --> 00:09:23,680
making instant millionaires in some

283
00:09:23,680 --> 00:09:25,120
cases

284
00:09:25,120 --> 00:09:27,440
so before we dive more into this trend

285
00:09:27,440 --> 00:09:28,560
and we'll talk about where it's going to

286
00:09:28,560 --> 00:09:30,480
go next i want to just backtrack for a

287
00:09:30,480 --> 00:09:31,440
minute

288
00:09:31,440 --> 00:09:33,440
and look into it from the criminal's

289
00:09:33,440 --> 00:09:34,880
point of view because seeing this

290
00:09:34,880 --> 00:09:36,320
evolution from a criminal point of view

291
00:09:36,320 --> 00:09:37,920
sometimes really helps you to think how

292
00:09:37,920 --> 00:09:40,560
do i defend against um all of this

293
00:09:40,560 --> 00:09:42,000
so we're going to take an example that

294
00:09:42,000 --> 00:09:44,080
ultimately leads up to a troj or to a

295
00:09:44,080 --> 00:09:46,000
ransomware called nephilim and we're

296
00:09:46,000 --> 00:09:47,600
going to start off with this individual

297
00:09:47,600 --> 00:09:51,839
which is a js worm in early 2019

298
00:09:51,839 --> 00:09:53,760
so two things to point out before we go

299
00:09:53,760 --> 00:09:55,600
any further first of all all the

300
00:09:55,600 --> 00:09:57,839
original posts here were written in

301
00:09:57,839 --> 00:09:59,279
russian text which we've machine

302
00:09:59,279 --> 00:10:01,440
translated for you you're welcome that's

303
00:10:01,440 --> 00:10:02,800
also why some of the text doesn't make

304
00:10:02,800 --> 00:10:05,040
sense and secondly obviously the

305
00:10:05,040 --> 00:10:07,440
author's name is not really js worm

306
00:10:07,440 --> 00:10:09,760
nobody's parents hate them that much

307
00:10:09,760 --> 00:10:11,519
this is just one of the various handles

308
00:10:11,519 --> 00:10:13,040
that they actually use

309
00:10:13,040 --> 00:10:16,240
at the time so js worm started out their

310
00:10:16,240 --> 00:10:18,560
career with a remote administration

311
00:10:18,560 --> 00:10:22,000
trojan or a rat called rav c rat right

312
00:10:22,000 --> 00:10:23,680
very common for criminals to start out

313
00:10:23,680 --> 00:10:25,279
this way and by

314
00:10:25,279 --> 00:10:27,760
um by rat standards it's pretty decent

315
00:10:27,760 --> 00:10:29,200
nothing wrong with it it does all the

316
00:10:29,200 --> 00:10:31,120
kind of things you'd expect from a rash

317
00:10:31,120 --> 00:10:32,959
or a key logger it gives you you know

318
00:10:32,959 --> 00:10:34,800
remote reverse proxies you know file

319
00:10:34,800 --> 00:10:37,360
manager key loggers back door capability

320
00:10:37,360 --> 00:10:38,880
all that kind of stuff does all of those

321
00:10:38,880 --> 00:10:39,920
things

322
00:10:39,920 --> 00:10:42,000
and key loggers and rats are very common

323
00:10:42,000 --> 00:10:43,120
entry point for criminals because

324
00:10:43,120 --> 00:10:44,800
they're not hard to code there's a lot

325
00:10:44,800 --> 00:10:46,160
of source code out there you can just

326
00:10:46,160 --> 00:10:48,240
take adapt and modify a little bit but

327
00:10:48,240 --> 00:10:49,920
it's also not terribly profitable right

328
00:10:49,920 --> 00:10:51,519
you might sell a key log or a rat for a

329
00:10:51,519 --> 00:10:53,440
couple of hundred dollars um and it

330
00:10:53,440 --> 00:10:54,959
doesn't it's not people don't return

331
00:10:54,959 --> 00:10:56,640
back to you that often to keep buying

332
00:10:56,640 --> 00:10:58,399
from you right so as a business model

333
00:10:58,399 --> 00:11:00,959
not terribly profitable so this

334
00:11:00,959 --> 00:11:02,880
particular actor js worm is quite the

335
00:11:02,880 --> 00:11:05,200
entrepreneur and kind of moves on

336
00:11:05,200 --> 00:11:07,920
over time and sees this ongoing trend of

337
00:11:07,920 --> 00:11:09,600
the mass ransomware that was happening

338
00:11:09,600 --> 00:11:12,000
at the time so created their own version

339
00:11:12,000 --> 00:11:14,560
called js worm ransomer which no prizes

340
00:11:14,560 --> 00:11:17,360
for originality on the naming um there

341
00:11:17,360 --> 00:11:18,959
and when we look from a technical point

342
00:11:18,959 --> 00:11:21,040
of view it's well written it's not in

343
00:11:21,040 --> 00:11:22,720
groundbreaking but ransomware doesn't

344
00:11:22,720 --> 00:11:24,320
really have to be it just has to encrypt

345
00:11:24,320 --> 00:11:26,800
files right you can technically throw

346
00:11:26,800 --> 00:11:28,480
everything into a password-protected zip

347
00:11:28,480 --> 00:11:30,880
file and it's a ransomware rights is not

348
00:11:30,880 --> 00:11:32,160
a particularly good one but it still

349
00:11:32,160 --> 00:11:33,279
kind of works

350
00:11:33,279 --> 00:11:35,040
so in their case what was more

351
00:11:35,040 --> 00:11:37,519
interesting was the amount of ways this

352
00:11:37,519 --> 00:11:39,760
got onto a system so when you looked at

353
00:11:39,760 --> 00:11:41,839
it js worm ransomware has been spread

354
00:11:41,839 --> 00:11:43,440
over email who's been spread through

355
00:11:43,440 --> 00:11:45,360
drive-by downloads through direct

356
00:11:45,360 --> 00:11:48,079
infections rdp connections literally any

357
00:11:48,079 --> 00:11:49,760
sort of infection method you can think

358
00:11:49,760 --> 00:11:52,240
of this thing was being spread by so how

359
00:11:52,240 --> 00:11:53,680
is that happening how is it this

360
00:11:53,680 --> 00:11:55,519
widespread well the reason is this

361
00:11:55,519 --> 00:11:56,399
widespread

362
00:11:56,399 --> 00:11:58,560
is down to this line here so it mentions

363
00:11:58,560 --> 00:12:01,279
that they have a 70 30 split between an

364
00:12:01,279 --> 00:12:02,959
affiliate and themselves how does that

365
00:12:02,959 --> 00:12:04,959
work so what they essentially were doing

366
00:12:04,959 --> 00:12:06,720
the business model here is that they

367
00:12:06,720 --> 00:12:08,000
partner with

368
00:12:08,000 --> 00:12:10,880
um affiliates or like kind of pen tester

369
00:12:10,880 --> 00:12:12,880
initial infection type people

370
00:12:12,880 --> 00:12:15,519
they break into the network they deploy

371
00:12:15,519 --> 00:12:17,279
um their back doors and things around it

372
00:12:17,279 --> 00:12:18,399
until they have complete control of the

373
00:12:18,399 --> 00:12:20,000
network and finally they drop the

374
00:12:20,000 --> 00:12:22,399
ransomware component for you and to make

375
00:12:22,399 --> 00:12:25,040
that um work for everybody the affiliate

376
00:12:25,040 --> 00:12:27,279
takes 70 percent of the overall ransomer

377
00:12:27,279 --> 00:12:29,680
profits and 30 goes to the actual

378
00:12:29,680 --> 00:12:31,279
ransomware author right so it doesn't

379
00:12:31,279 --> 00:12:32,959
have to do half as much work for the

380
00:12:32,959 --> 00:12:34,160
effort so that's why they're not getting

381
00:12:34,160 --> 00:12:36,160
paid as much money and that's also why

382
00:12:36,160 --> 00:12:39,279
you see so many different um infection

383
00:12:39,279 --> 00:12:40,480
vectors here because there's different

384
00:12:40,480 --> 00:12:42,720
affiliates in every case doing this it's

385
00:12:42,720 --> 00:12:44,399
also why if you're an ior company and

386
00:12:44,399 --> 00:12:46,079
you're looking at a ransomware incident

387
00:12:46,079 --> 00:12:47,600
it can be really hard to put together

388
00:12:47,600 --> 00:12:49,279
the kill chain because there isn't one

389
00:12:49,279 --> 00:12:51,120
killjet there's like two or three kill

390
00:12:51,120 --> 00:12:52,639
chains all overlapping that you're

391
00:12:52,639 --> 00:12:55,120
trying to detangle from each other

392
00:12:55,120 --> 00:12:57,600
so fast forward a bit further

393
00:12:57,600 --> 00:12:58,959
click and

394
00:12:58,959 --> 00:13:02,880
in about the end of 2019 js worm changes

395
00:13:02,880 --> 00:13:05,360
and brings out a new ransomware called

396
00:13:05,360 --> 00:13:08,240
nimty now nimty operates using the exact

397
00:13:08,240 --> 00:13:10,320
same kind of split an affiliate model

398
00:13:10,320 --> 00:13:13,920
that um js worm had it's of 70 30. the

399
00:13:13,920 --> 00:13:16,880
file itself isn't massively different

400
00:13:16,880 --> 00:13:18,959
from what came before so the question

401
00:13:18,959 --> 00:13:21,680
would be why why bother rebranding this

402
00:13:21,680 --> 00:13:22,399
right

403
00:13:22,399 --> 00:13:24,079
and if you look into details it kind of

404
00:13:24,079 --> 00:13:25,600
does a lot of the same stuff and gives

405
00:13:25,600 --> 00:13:28,240
details before but the 70 30 split so

406
00:13:28,240 --> 00:13:31,200
the answer is we don't 100 know why they

407
00:13:31,200 --> 00:13:33,120
would have done this and kind of rebrand

408
00:13:33,120 --> 00:13:35,200
it but if i had to guess i would guess

409
00:13:35,200 --> 00:13:37,120
it's down to they wanted to cut out some

410
00:13:37,120 --> 00:13:38,560
of the affiliates that they were working

411
00:13:38,560 --> 00:13:40,480
with up to that point so if you can

412
00:13:40,480 --> 00:13:41,920
imagine for a minute imagine being a

413
00:13:41,920 --> 00:13:44,000
startup and going into a frat house in

414
00:13:44,000 --> 00:13:46,160
california and saying hands up who wants

415
00:13:46,160 --> 00:13:48,560
to join a tech startup you will get some

416
00:13:48,560 --> 00:13:50,240
really talented people who will jump on

417
00:13:50,240 --> 00:13:52,000
board and you'll get a bunch of wasters

418
00:13:52,000 --> 00:13:54,720
in the process right so fast forwarded

419
00:13:54,720 --> 00:13:56,000
like six months of doing this and there

420
00:13:56,000 --> 00:13:57,279
was probably some affiliates that they

421
00:13:57,279 --> 00:13:59,199
worked with that just did their head in

422
00:13:59,199 --> 00:14:00,880
and were not particularly useful and not

423
00:14:00,880 --> 00:14:02,240
particularly profitable and they wanted

424
00:14:02,240 --> 00:14:04,000
to get rid of so when they were

425
00:14:04,000 --> 00:14:05,600
advertised and empty they actually

426
00:14:05,600 --> 00:14:07,920
limited to only 25 affiliates they would

427
00:14:07,920 --> 00:14:09,600
work with and they would even offer up

428
00:14:09,600 --> 00:14:11,600
to 90 10 split for really good

429
00:14:11,600 --> 00:14:13,120
affiliates who could get them onto a lot

430
00:14:13,120 --> 00:14:15,120
of good networks right so this is just a

431
00:14:15,120 --> 00:14:16,800
case of them kind of trimming the fat

432
00:14:16,800 --> 00:14:19,760
off their business if you like

433
00:14:19,760 --> 00:14:22,000
moving forward in a bit again and around

434
00:14:22,000 --> 00:14:25,040
the end of 2019 start of 2020 was when

435
00:14:25,040 --> 00:14:27,040
this whole new world of double extortion

436
00:14:27,040 --> 00:14:28,880
ransomware was starting up and i haven't

437
00:14:28,880 --> 00:14:30,160
already explained double extortion

438
00:14:30,160 --> 00:14:31,440
ransomware yet but i will in just a

439
00:14:31,440 --> 00:14:32,399
minute

440
00:14:32,399 --> 00:14:35,199
and js worm everyday entrepreneur jumped

441
00:14:35,199 --> 00:14:37,839
on this bandwagon with a new trojan our

442
00:14:37,839 --> 00:14:39,440
sorry new ransomware which they called

443
00:14:39,440 --> 00:14:40,720
nephilim it was actually originally

444
00:14:40,720 --> 00:14:43,120
called an empty revenue edition um which

445
00:14:43,120 --> 00:14:44,880
is uh what they've marketed as

446
00:14:44,880 --> 00:14:47,040
originally so what's the difference

447
00:14:47,040 --> 00:14:48,639
between this and the others well it's

448
00:14:48,639 --> 00:14:49,760
the whole

449
00:14:49,760 --> 00:14:51,440
double extortion model so if you don't

450
00:14:51,440 --> 00:14:53,199
know the double extortion model the idea

451
00:14:53,199 --> 00:14:55,279
is the affiliates get on the network

452
00:14:55,279 --> 00:14:56,639
they go around and they're going to

453
00:14:56,639 --> 00:14:58,320
deploy the ransomware but before they

454
00:14:58,320 --> 00:15:00,079
actually do that they hoover up any

455
00:15:00,079 --> 00:15:01,680
files they can from anywhere in the

456
00:15:01,680 --> 00:15:02,800
network that they think would be

457
00:15:02,800 --> 00:15:04,959
sensitive right so obviously your source

458
00:15:04,959 --> 00:15:07,360
code your like sales details the star

459
00:15:07,360 --> 00:15:09,279
wars fan fiction i mentioned earlier all

460
00:15:09,279 --> 00:15:11,519
of that gets zipped up in one file like

461
00:15:11,519 --> 00:15:13,440
a couple of gigabytes in size and then

462
00:15:13,440 --> 00:15:15,440
exfiltrate it off the network to some

463
00:15:15,440 --> 00:15:16,959
other location under the attacker's

464
00:15:16,959 --> 00:15:19,040
control and then once all that is done

465
00:15:19,040 --> 00:15:20,320
they deployed a ransomware and all the

466
00:15:20,320 --> 00:15:22,800
endpoints and at that point the board

467
00:15:22,800 --> 00:15:24,399
realizes they're in they're actually

468
00:15:24,399 --> 00:15:25,600
under attack

469
00:15:25,600 --> 00:15:27,279
so this has

470
00:15:27,279 --> 00:15:28,959
two things the board have to kind of

471
00:15:28,959 --> 00:15:30,480
consider at this point one they're

472
00:15:30,480 --> 00:15:31,759
dealing with the fact their systems are

473
00:15:31,759 --> 00:15:33,759
mostly offline so they can't work they

474
00:15:33,759 --> 00:15:35,360
can't do whatever it is the business is

475
00:15:35,360 --> 00:15:36,560
actually doing that's the ransomware

476
00:15:36,560 --> 00:15:38,639
component and the second part is they

477
00:15:38,639 --> 00:15:41,519
have this looming kind of possible gdpr

478
00:15:41,519 --> 00:15:43,360
breach that they have to deal with um on

479
00:15:43,360 --> 00:15:45,040
the back end which is a very powerful

480
00:15:45,040 --> 00:15:46,959
kind of card that the attacker can bring

481
00:15:46,959 --> 00:15:49,279
in mid negotiation to kind of put extra

482
00:15:49,279 --> 00:15:51,040
pressure on whenever they need to use

483
00:15:51,040 --> 00:15:52,800
that at that point

484
00:15:52,800 --> 00:15:54,240
a couple of other things to know about

485
00:15:54,240 --> 00:15:56,560
this this model one is it's technically

486
00:15:56,560 --> 00:15:58,240
not double extortion everybody calls it

487
00:15:58,240 --> 00:15:59,440
double extortion but it's actually

488
00:15:59,440 --> 00:16:01,440
extortion with a blackmail chaser but

489
00:16:01,440 --> 00:16:03,120
that's hard to explain double extortion

490
00:16:03,120 --> 00:16:04,639
looks catcher in a headline so that's

491
00:16:04,639 --> 00:16:06,079
what everybody goes with

492
00:16:06,079 --> 00:16:07,759
the second is when you look at a leak

493
00:16:07,759 --> 00:16:09,279
site like this which is where all this

494
00:16:09,279 --> 00:16:11,199
stuff gets posted up on

495
00:16:11,199 --> 00:16:13,839
it's um only the people who have not

496
00:16:13,839 --> 00:16:15,920
paid normally go up on these sites so

497
00:16:15,920 --> 00:16:17,440
that's not all their victims that's just

498
00:16:17,440 --> 00:16:19,199
the ones who've refused to pay and i had

499
00:16:19,199 --> 00:16:21,440
their data breached as a result and

500
00:16:21,440 --> 00:16:22,959
another thing to consider is if you're a

501
00:16:22,959 --> 00:16:24,399
board on the receiving end of something

502
00:16:24,399 --> 00:16:26,399
like this by the time you notice the

503
00:16:26,399 --> 00:16:28,639
ransomware is deployed the real crime

504
00:16:28,639 --> 00:16:30,320
which is the complete compromise of your

505
00:16:30,320 --> 00:16:32,000
network and theft of all that data

506
00:16:32,000 --> 00:16:33,759
happened maybe a week ago or weeks

507
00:16:33,759 --> 00:16:36,000
depending on the actual um case so

508
00:16:36,000 --> 00:16:38,240
you're already far more more damaged

509
00:16:38,240 --> 00:16:39,680
than you think you're actually in at

510
00:16:39,680 --> 00:16:41,440
this point

511
00:16:41,440 --> 00:16:42,480
so

512
00:16:42,480 --> 00:16:44,880
we took the actual victims of nephilim

513
00:16:44,880 --> 00:16:46,320
and we kind of broke them down to see

514
00:16:46,320 --> 00:16:48,079
what did the victim profiles look like

515
00:16:48,079 --> 00:16:50,079
and if you look at the actual the

516
00:16:50,079 --> 00:16:52,240
countries that the different uh uh

517
00:16:52,240 --> 00:16:54,079
people on the league side came from we

518
00:16:54,079 --> 00:16:55,600
can see they're heavily targeted north

519
00:16:55,600 --> 00:16:57,519
america south america be about second

520
00:16:57,519 --> 00:16:59,199
biggest but they also hit targets in

521
00:16:59,199 --> 00:17:02,639
europe uh asia oceana as well right so

522
00:17:02,639 --> 00:17:04,240
but it was clearly that they were

523
00:17:04,240 --> 00:17:06,000
targeting north america when they could

524
00:17:06,000 --> 00:17:08,720
uh when they had preference to do so

525
00:17:08,720 --> 00:17:10,079
what's more interesting though is we

526
00:17:10,079 --> 00:17:11,520
look at the actual breakdown of the

527
00:17:11,520 --> 00:17:12,559
victims

528
00:17:12,559 --> 00:17:14,720
and nephilim strangely enough in terms

529
00:17:14,720 --> 00:17:16,319
of the number of victims they're about

530
00:17:16,319 --> 00:17:17,839
middle of the pack so they're not

531
00:17:17,839 --> 00:17:19,599
terribly interesting compared to some of

532
00:17:19,599 --> 00:17:21,760
the others also in terms of the volume

533
00:17:21,760 --> 00:17:23,439
of data just the sheer gigabytes

534
00:17:23,439 --> 00:17:25,119
uploaded again they're middle of the

535
00:17:25,119 --> 00:17:27,039
road um although they're still one

536
00:17:27,039 --> 00:17:29,039
terabyte of data is not to be laughed at

537
00:17:29,039 --> 00:17:30,960
right and at this stage where they're

538
00:17:30,960 --> 00:17:32,799
most definitely not middle of the pack

539
00:17:32,799 --> 00:17:35,200
though is in the revenue of the people

540
00:17:35,200 --> 00:17:37,520
they targeted so on average the revenue

541
00:17:37,520 --> 00:17:40,400
of those companies was 890 million um

542
00:17:40,400 --> 00:17:42,640
plus and even on the advertisements when

543
00:17:42,640 --> 00:17:44,160
they're reaching out to affiliates so we

544
00:17:44,160 --> 00:17:46,240
see in criminal forums they specifically

545
00:17:46,240 --> 00:17:48,080
say they only want companies that are

546
00:17:48,080 --> 00:17:50,559
200 million plus in revenue and ideally

547
00:17:50,559 --> 00:17:52,320
in the billion dollar ranges so this is

548
00:17:52,320 --> 00:17:53,600
what their kind of market is they're

549
00:17:53,600 --> 00:17:55,120
going to and if you think of that from

550
00:17:55,120 --> 00:17:57,120
the business strategy it means that

551
00:17:57,120 --> 00:17:58,880
those people that they in fact are going

552
00:17:58,880 --> 00:18:01,280
to be much harder to actually ransom

553
00:18:01,280 --> 00:18:02,400
they're going to have better security

554
00:18:02,400 --> 00:18:04,799
software infosec teams all of those type

555
00:18:04,799 --> 00:18:06,240
of things so they're harder nuts to

556
00:18:06,240 --> 00:18:08,799
crack but if you crack them any one of

557
00:18:08,799 --> 00:18:10,720
those is a massive payday potentially

558
00:18:10,720 --> 00:18:12,000
right because they have much more money

559
00:18:12,000 --> 00:18:13,679
on the books than the middle of the road

560
00:18:13,679 --> 00:18:15,039
so this is just a kind of business

561
00:18:15,039 --> 00:18:16,720
strategy if you like if you think of it

562
00:18:16,720 --> 00:18:19,120
like in security terms nephilim target

563
00:18:19,120 --> 00:18:21,280
enterprise customers right or customers

564
00:18:21,280 --> 00:18:22,799
to them or victims right but they target

565
00:18:22,799 --> 00:18:24,799
them where somebody like conti is more

566
00:18:24,799 --> 00:18:27,280
like middle of the road smb type people

567
00:18:27,280 --> 00:18:28,960
so likewise

568
00:18:28,960 --> 00:18:30,799
nephilim are going to keep going in a

569
00:18:30,799 --> 00:18:33,039
negotiation a lot longer because they've

570
00:18:33,039 --> 00:18:34,799
invested so much into it where someone

571
00:18:34,799 --> 00:18:36,240
like conti will bail out of a

572
00:18:36,240 --> 00:18:37,760
negotiation if it's not going well

573
00:18:37,760 --> 00:18:40,000
faster because they just move on to the

574
00:18:40,000 --> 00:18:41,440
next one right so you can kind of tell

575
00:18:41,440 --> 00:18:43,280
from these things

576
00:18:43,280 --> 00:18:44,960
so if we look from a technical level at

577
00:18:44,960 --> 00:18:47,280
the actual kill chain of these groups

578
00:18:47,280 --> 00:18:48,880
so everybody here is familiar with the

579
00:18:48,880 --> 00:18:51,280
kind of the kill chain but as you notice

580
00:18:51,280 --> 00:18:52,799
with these ransomware groups and this

581
00:18:52,799 --> 00:18:54,960
isn't just nephilim it's all of them the

582
00:18:54,960 --> 00:18:57,919
kill chains get very murky very quickly

583
00:18:57,919 --> 00:19:00,240
uh when we start looking into these

584
00:19:00,240 --> 00:19:01,200
so

585
00:19:01,200 --> 00:19:02,480
if we start with the kill chain you

586
00:19:02,480 --> 00:19:03,600
normally traditionally look at the

587
00:19:03,600 --> 00:19:05,679
reconnaissance and weaponization phase

588
00:19:05,679 --> 00:19:07,039
that's the phase we actually have the

589
00:19:07,039 --> 00:19:08,720
least details on for any of these

590
00:19:08,720 --> 00:19:10,000
ransomware groups because that's the

591
00:19:10,000 --> 00:19:11,520
part you don't see in your network that

592
00:19:11,520 --> 00:19:13,520
all kind of happens on the attacker side

593
00:19:13,520 --> 00:19:15,600
and actually interestingly none of that

594
00:19:15,600 --> 00:19:17,520
has anything to do with the actual

595
00:19:17,520 --> 00:19:19,039
ransomware itself

596
00:19:19,039 --> 00:19:21,120
so the reason behind that is the kind of

597
00:19:21,120 --> 00:19:23,360
affiliate model split i mentioned before

598
00:19:23,360 --> 00:19:25,120
so if you think about it the affiliate

599
00:19:25,120 --> 00:19:27,760
is um the affiliate is taking care of

600
00:19:27,760 --> 00:19:29,280
this kind of part the first part of the

601
00:19:29,280 --> 00:19:31,200
kill chain and interior the ransomware

602
00:19:31,200 --> 00:19:32,799
gets deployed at the very end and does

603
00:19:32,799 --> 00:19:34,799
the other part of the kill chain

604
00:19:34,799 --> 00:19:36,320
but it actually gets a little bit

605
00:19:36,320 --> 00:19:38,240
trickier than this as you see as we go

606
00:19:38,240 --> 00:19:40,640
on here so if we flick ahead into the

607
00:19:40,640 --> 00:19:42,559
kind of delivery and exploitation phase

608
00:19:42,559 --> 00:19:44,559
which is where you would see the first

609
00:19:44,559 --> 00:19:46,400
kind of signs of them actually on your

610
00:19:46,400 --> 00:19:48,960
network there's a couple of methods that

611
00:19:48,960 --> 00:19:51,280
nephilim themselves favored so nephilim

612
00:19:51,280 --> 00:19:53,760
would regularly use microsoft rdp and

613
00:19:53,760 --> 00:19:55,440
they would either use stolen credentials

614
00:19:55,440 --> 00:19:56,960
that they'd gotten somewhere else or

615
00:19:56,960 --> 00:19:59,600
just brute force to gain access they

616
00:19:59,600 --> 00:20:01,679
also liked using network vulnerabilities

617
00:20:01,679 --> 00:20:03,280
in their case their favorite was the

618
00:20:03,280 --> 00:20:05,360
citrix net scalar vulnerability other

619
00:20:05,360 --> 00:20:07,120
ransomware groups use different network

620
00:20:07,120 --> 00:20:08,880
vulnerabilities but similar approaches

621
00:20:08,880 --> 00:20:11,120
to this so this kind of is generic if

622
00:20:11,120 --> 00:20:12,320
you like

623
00:20:12,320 --> 00:20:13,840
once they'd used that for the initial

624
00:20:13,840 --> 00:20:15,679
beachhead they would set about actually

625
00:20:15,679 --> 00:20:18,000
establishing kind of stronger control of

626
00:20:18,000 --> 00:20:19,679
the machine so the way they would do

627
00:20:19,679 --> 00:20:21,600
this is to use tools like process hacker

628
00:20:21,600 --> 00:20:23,760
to delete or disable the security

629
00:20:23,760 --> 00:20:25,600
software on the machine itself which

630
00:20:25,600 --> 00:20:27,039
then means they can kind of run around

631
00:20:27,039 --> 00:20:29,039
without any of those pesky ransomware

632
00:20:29,039 --> 00:20:31,200
and stuff or anti-ransomware stopping

633
00:20:31,200 --> 00:20:31,840
them

634
00:20:31,840 --> 00:20:34,320
they'd use powershell which has really

635
00:20:34,320 --> 00:20:36,559
sped up their deployment so in the past

636
00:20:36,559 --> 00:20:38,080
a lot of this was manual now they've

637
00:20:38,080 --> 00:20:39,760
kind of scripted up their playbook they

638
00:20:39,760 --> 00:20:41,520
just run scripts the script ripped

639
00:20:41,520 --> 00:20:43,039
through the network at very very fast

640
00:20:43,039 --> 00:20:44,559
speed and do all the kind of standard

641
00:20:44,559 --> 00:20:46,080
things they would do

642
00:20:46,080 --> 00:20:48,320
and of course they make use of uh the

643
00:20:48,320 --> 00:20:50,480
big tobacco of the legitimate software

644
00:20:50,480 --> 00:20:52,880
industry which is cobalt strike um

645
00:20:52,880 --> 00:20:54,960
everybody has hacked cobalt strike and

646
00:20:54,960 --> 00:20:57,200
they use this for back doors to control

647
00:20:57,200 --> 00:21:00,159
the machines to laterally move around um

648
00:21:00,159 --> 00:21:02,480
dump admin credentials and so on and as

649
00:21:02,480 --> 00:21:04,400
the actual command and control to

650
00:21:04,400 --> 00:21:06,640
actually control the overall attack and

651
00:21:06,640 --> 00:21:08,000
that's interesting because you would

652
00:21:08,000 --> 00:21:09,360
think the command and control happens at

653
00:21:09,360 --> 00:21:10,799
the end of the kill chain so it's on the

654
00:21:10,799 --> 00:21:12,480
ransomware side but this shows you how

655
00:21:12,480 --> 00:21:14,799
this gets kind of murky right the a lot

656
00:21:14,799 --> 00:21:16,640
of the ransomware don't have command and

657
00:21:16,640 --> 00:21:18,480
controls because they don't need one

658
00:21:18,480 --> 00:21:20,720
right it's just deployed manually by the

659
00:21:20,720 --> 00:21:22,320
affiliate as they actually get onto the

660
00:21:22,320 --> 00:21:24,480
network itself but it does make all this

661
00:21:24,480 --> 00:21:26,799
more murky to try and pick apart who did

662
00:21:26,799 --> 00:21:28,320
one

663
00:21:28,320 --> 00:21:29,679
so then once they've done that they need

664
00:21:29,679 --> 00:21:31,520
to escalate privileges a bit and move

665
00:21:31,520 --> 00:21:33,039
laterally around the network and

666
00:21:33,039 --> 00:21:34,880
mimikatz is a favorite tool for that for

667
00:21:34,880 --> 00:21:36,480
taking the credentials they've dumped

668
00:21:36,480 --> 00:21:38,880
and trying them in other machines also

669
00:21:38,880 --> 00:21:40,640
they would use certain like privileged

670
00:21:40,640 --> 00:21:42,400
escalation vulnerabilities that exist at

671
00:21:42,400 --> 00:21:44,080
a time just to get more you know admin

672
00:21:44,080 --> 00:21:46,000
rights in the machines that they have

673
00:21:46,000 --> 00:21:48,320
and tools like adfind which help them

674
00:21:48,320 --> 00:21:50,320
map the whole active directory network

675
00:21:50,320 --> 00:21:51,919
and that's for two reasons one so they

676
00:21:51,919 --> 00:21:53,679
know where they want to go and target um

677
00:21:53,679 --> 00:21:55,760
but also they quite often don't know who

678
00:21:55,760 --> 00:21:57,600
they just infected right so they have to

679
00:21:57,600 --> 00:21:59,679
figure out what is this network how big

680
00:21:59,679 --> 00:22:01,200
is it and then who am i going to sell

681
00:22:01,200 --> 00:22:03,120
this network to so for example if they

682
00:22:03,120 --> 00:22:05,600
found out it's like 50 seats they might

683
00:22:05,600 --> 00:22:07,200
say okay nephilim are never going to pay

684
00:22:07,200 --> 00:22:10,000
for that i'll go sell this to klopp or

685
00:22:10,000 --> 00:22:11,840
conti or somebody like that whereas if

686
00:22:11,840 --> 00:22:14,080
it's like a fortune 500 company to have

687
00:22:14,080 --> 00:22:15,440
nephilim would probably pay them more

688
00:22:15,440 --> 00:22:18,640
money for that than anybody else would

689
00:22:18,640 --> 00:22:20,559
and then the next stage just before the

690
00:22:20,559 --> 00:22:22,400
ransomware is deployed is exfiltrating

691
00:22:22,400 --> 00:22:24,000
all that data off the network normally

692
00:22:24,000 --> 00:22:25,919
they bring it to one server internally

693
00:22:25,919 --> 00:22:27,280
first and then pull it all out if

694
00:22:27,280 --> 00:22:29,520
they're either using something like ftp

695
00:22:29,520 --> 00:22:31,840
or mega sync and others use or clone and

696
00:22:31,840 --> 00:22:33,760
some other things to do this

697
00:22:33,760 --> 00:22:35,120
with the same idea

698
00:22:35,120 --> 00:22:36,799
and then finally to deploy the actual

699
00:22:36,799 --> 00:22:39,360
ransomware component itself right and

700
00:22:39,360 --> 00:22:41,120
the ransomware isn't terribly

701
00:22:41,120 --> 00:22:42,640
interesting in terms of its technical

702
00:22:42,640 --> 00:22:45,440
capabilities it uses a mixture between

703
00:22:45,440 --> 00:22:47,360
private and public keys aes for

704
00:22:47,360 --> 00:22:49,440
encryption and it just encrypts the

705
00:22:49,440 --> 00:22:51,039
files as you kind of expect it to do

706
00:22:51,039 --> 00:22:53,039
quite quickly one important thing to

707
00:22:53,039 --> 00:22:55,120
point out here is everybody when they

708
00:22:55,120 --> 00:22:57,039
get ransomed the first thing they do is

709
00:22:57,039 --> 00:22:59,679
they google and they go name of ransom

710
00:22:59,679 --> 00:23:02,159
decrypter and they pray and it is

711
00:23:02,159 --> 00:23:04,880
pointless because any modern ransomware

712
00:23:04,880 --> 00:23:06,799
will not have a decrypter think about it

713
00:23:06,799 --> 00:23:08,400
from the affiliates point of view would

714
00:23:08,400 --> 00:23:10,480
you partner with a ransomware group that

715
00:23:10,480 --> 00:23:12,640
you put all this effort into and it gets

716
00:23:12,640 --> 00:23:14,000
wasted at the end because somebody just

717
00:23:14,000 --> 00:23:15,520
downloaded an executable off the

718
00:23:15,520 --> 00:23:17,280
internet ran it and they're back to

719
00:23:17,280 --> 00:23:18,960
being fine again just doesn't happen

720
00:23:18,960 --> 00:23:21,600
right in today's case unfortunately

721
00:23:21,600 --> 00:23:23,039
so what does happen with these

722
00:23:23,039 --> 00:23:25,440
ransomwares was they constantly evolved

723
00:23:25,440 --> 00:23:27,840
their code to get faster or add features

724
00:23:27,840 --> 00:23:29,679
and so on because their customers want

725
00:23:29,679 --> 00:23:31,280
in the case of nephilim they keep adding

726
00:23:31,280 --> 00:23:32,960
different extensions to the end which is

727
00:23:32,960 --> 00:23:34,480
this kind of word cloud that you see

728
00:23:34,480 --> 00:23:36,320
here and what's interesting is if we

729
00:23:36,320 --> 00:23:37,760
take all those different variants and we

730
00:23:37,760 --> 00:23:39,120
just map them out

731
00:23:39,120 --> 00:23:41,120
we actually use uh this is a dendogram

732
00:23:41,120 --> 00:23:43,039
which is like a family tree if you like

733
00:23:43,039 --> 00:23:45,440
and we use a tlsh fuzzy hashing to do

734
00:23:45,440 --> 00:23:46,799
this but essentially if you think of

735
00:23:46,799 --> 00:23:48,559
this like a family tree where the common

736
00:23:48,559 --> 00:23:50,480
ancestor is all the way on the left and

737
00:23:50,480 --> 00:23:51,840
then the more you get to the right the

738
00:23:51,840 --> 00:23:53,840
closer they are to each other right so

739
00:23:53,840 --> 00:23:55,919
the green stuff at the top was the

740
00:23:55,919 --> 00:23:57,679
original version of nephilim was coded

741
00:23:57,679 --> 00:23:59,919
in c plus plus and then they changed to

742
00:23:59,919 --> 00:24:02,080
using the go language after that and as

743
00:24:02,080 --> 00:24:03,279
you can see the important thing here is

744
00:24:03,279 --> 00:24:04,960
just the constant iterations right

745
00:24:04,960 --> 00:24:07,360
there's constant evolution over time of

746
00:24:07,360 --> 00:24:09,039
the actual trojan showing that they're

747
00:24:09,039 --> 00:24:11,760
really evolving this this thing

748
00:24:11,760 --> 00:24:13,679
so if we put that all together on a

749
00:24:13,679 --> 00:24:16,080
miter map like this one here it looks

750
00:24:16,080 --> 00:24:17,840
very complex

751
00:24:17,840 --> 00:24:19,360
in fact if you

752
00:24:19,360 --> 00:24:20,960
took this miter map and i showed it to

753
00:24:20,960 --> 00:24:23,520
you with no context whatsoever a couple

754
00:24:23,520 --> 00:24:24,880
of years ago and didn't tell you was

755
00:24:24,880 --> 00:24:26,320
ransomware you'd be forgiven for

756
00:24:26,320 --> 00:24:28,080
thinking this is probably an apt attack

757
00:24:28,080 --> 00:24:29,200
because that's what a lot of these

758
00:24:29,200 --> 00:24:31,039
actually look like because criminals

759
00:24:31,039 --> 00:24:33,120
read apt reports too right and they take

760
00:24:33,120 --> 00:24:34,720
ideas from them like that's really smart

761
00:24:34,720 --> 00:24:36,960
we should do that and unlike an apt

762
00:24:36,960 --> 00:24:38,559
attack where it's probably more stealthy

763
00:24:38,559 --> 00:24:39,840
and they're trying to try and stay in

764
00:24:39,840 --> 00:24:40,960
the background the network and not

765
00:24:40,960 --> 00:24:42,880
really damage you directly apart from

766
00:24:42,880 --> 00:24:45,120
the information theft with ransomware

767
00:24:45,120 --> 00:24:46,720
it's going to be very visual and do

768
00:24:46,720 --> 00:24:48,240
damage because that's how it works right

769
00:24:48,240 --> 00:24:51,120
it's going to be visual and in your face

770
00:24:51,120 --> 00:24:52,960
so we've put all we've wrapped all of

771
00:24:52,960 --> 00:24:55,120
this up into our report i'm just

772
00:24:55,120 --> 00:24:56,720
highlighting here at 3. anyone can

773
00:24:56,720 --> 00:24:58,880
download it it's 96 pages long so i

774
00:24:58,880 --> 00:25:00,480
can't go through all of this

775
00:25:00,480 --> 00:25:03,200
um but if you google double extortion

776
00:25:03,200 --> 00:25:04,799
and trend micro you'll find it very

777
00:25:04,799 --> 00:25:06,640
easily what i do want to highlight from

778
00:25:06,640 --> 00:25:08,240
the report is there's a ton of

779
00:25:08,240 --> 00:25:10,159
recommendations in it and it's a big

780
00:25:10,159 --> 00:25:11,679
long section but i'm going to call out

781
00:25:11,679 --> 00:25:13,039
the ones i think make the most

782
00:25:13,039 --> 00:25:14,559
difference when you're defending

783
00:25:14,559 --> 00:25:16,480
and those are first of all don't ever

784
00:25:16,480 --> 00:25:18,720
expose rdp on the internet for any

785
00:25:18,720 --> 00:25:21,360
reason ever it always ends badly and it

786
00:25:21,360 --> 00:25:23,440
like it will always embody the second

787
00:25:23,440 --> 00:25:25,440
one is patching i know patching is a

788
00:25:25,440 --> 00:25:27,200
pain i know all the issues with patching

789
00:25:27,200 --> 00:25:28,799
and there's very good reasons why it's

790
00:25:28,799 --> 00:25:31,120
hard but at the end of the day some of

791
00:25:31,120 --> 00:25:33,279
these vulnerabilities are four years old

792
00:25:33,279 --> 00:25:34,960
right they have patches that would make

793
00:25:34,960 --> 00:25:36,400
a big difference in stopping these move

794
00:25:36,400 --> 00:25:37,360
around

795
00:25:37,360 --> 00:25:40,000
also any of those like dual use tools

796
00:25:40,000 --> 00:25:42,559
like adfind or powershell or ps exec and

797
00:25:42,559 --> 00:25:45,039
so on really limit which machines in the

798
00:25:45,039 --> 00:25:46,559
network are allowed to use them maybe

799
00:25:46,559 --> 00:25:48,559
the admin really needs them but nowhere

800
00:25:48,559 --> 00:25:49,760
else in the network needs them and that

801
00:25:49,760 --> 00:25:52,080
will really help and finally and most

802
00:25:52,080 --> 00:25:54,000
importantly from defenses make sure

803
00:25:54,000 --> 00:25:55,919
you're defending against the affiliates

804
00:25:55,919 --> 00:25:59,120
not the ransomware if you uh if you put

805
00:25:59,120 --> 00:26:00,720
all your money into defending the

806
00:26:00,720 --> 00:26:02,640
ransomware component but the attacker

807
00:26:02,640 --> 00:26:03,760
has completely controlled the machine

808
00:26:03,760 --> 00:26:05,279
and turns off your fancy new shiny

809
00:26:05,279 --> 00:26:07,840
securities offer it's useless instead

810
00:26:07,840 --> 00:26:10,000
put all the energy or as much energy you

811
00:26:10,000 --> 00:26:12,000
can into the initial access and stopping

812
00:26:12,000 --> 00:26:13,520
your affiliates if they never get in the

813
00:26:13,520 --> 00:26:15,360
network they never deploy to ransomware

814
00:26:15,360 --> 00:26:16,400
and you have much better chance of

815
00:26:16,400 --> 00:26:17,840
defending

816
00:26:17,840 --> 00:26:19,520
so what comes next to just wrap up with

817
00:26:19,520 --> 00:26:22,320
two or three slides um before i get

818
00:26:22,320 --> 00:26:25,360
killed by the ipad in the front um so

819
00:26:25,360 --> 00:26:27,039
we've talked about double extortion and

820
00:26:27,039 --> 00:26:28,799
a lot of people think that because of

821
00:26:28,799 --> 00:26:30,320
all this data leak part of double

822
00:26:30,320 --> 00:26:32,240
extortion the logical thing to do is to

823
00:26:32,240 --> 00:26:33,760
move away from ransomware and actually

824
00:26:33,760 --> 00:26:35,600
be completely based on the data leakage

825
00:26:35,600 --> 00:26:37,600
itself and actually in reality that's a

826
00:26:37,600 --> 00:26:39,360
really poor strategy while the data

827
00:26:39,360 --> 00:26:40,799
leaking gets a lot of the media

828
00:26:40,799 --> 00:26:42,799
attention it's kind of the weakest part

829
00:26:42,799 --> 00:26:44,240
of the whole chain because at the end of

830
00:26:44,240 --> 00:26:45,760
the day you're just relying on a

831
00:26:45,760 --> 00:26:47,760
criminal keeping the word that the pinky

832
00:26:47,760 --> 00:26:49,279
promise swear that they will delete all

833
00:26:49,279 --> 00:26:50,799
your data after they've taken it off the

834
00:26:50,799 --> 00:26:52,960
site which they won't right

835
00:26:52,960 --> 00:26:56,000
and also it means that um

836
00:26:56,000 --> 00:26:57,840
these leak sites very few people

837
00:26:57,840 --> 00:26:59,600
download that data in the start when

838
00:26:59,600 --> 00:27:00,960
there's only a few of these groups

839
00:27:00,960 --> 00:27:02,799
people would download and look for data

840
00:27:02,799 --> 00:27:04,559
now there's leaks every single day no

841
00:27:04,559 --> 00:27:06,480
media has time to go through all of them

842
00:27:06,480 --> 00:27:08,400
and they're all on tour sites i don't

843
00:27:08,400 --> 00:27:10,000
know if anybody's tried to download 100

844
00:27:10,000 --> 00:27:11,840
gigabytes of data over tor yet but if

845
00:27:11,840 --> 00:27:13,760
you did and you started last year it's

846
00:27:13,760 --> 00:27:15,279
still running on your machine right now

847
00:27:15,279 --> 00:27:17,120
right so nobody actually looks at them

848
00:27:17,120 --> 00:27:19,279
unless it's a really like political

849
00:27:19,279 --> 00:27:21,600
victim or something that is high profile

850
00:27:21,600 --> 00:27:23,440
instead uh we are seeing some

851
00:27:23,440 --> 00:27:25,600
experimentation conti for example

852
00:27:25,600 --> 00:27:28,159
started experiment by trying to sell the

853
00:27:28,159 --> 00:27:29,760
access to the data so instead of like

854
00:27:29,760 --> 00:27:31,120
just dumping in the data site they're

855
00:27:31,120 --> 00:27:32,880
saying is there anybody out there who's

856
00:27:32,880 --> 00:27:35,120
a specialist in like finance data if so

857
00:27:35,120 --> 00:27:37,039
we'll sell the data to you we don't know

858
00:27:37,039 --> 00:27:38,960
exactly how the split of this would go

859
00:27:38,960 --> 00:27:40,480
whether it's a one-time sale or to take

860
00:27:40,480 --> 00:27:42,240
a percentage of the profits but that's

861
00:27:42,240 --> 00:27:43,679
one model that's been tried in the last

862
00:27:43,679 --> 00:27:44,799
couple of weeks but they've since

863
00:27:44,799 --> 00:27:45,840
stopped this so i don't know how

864
00:27:45,840 --> 00:27:47,520
successful it was

865
00:27:47,520 --> 00:27:49,600
then there's the triple extortion idea

866
00:27:49,600 --> 00:27:52,080
this is simply adding ddos on top so if

867
00:27:52,080 --> 00:27:53,520
you think about when they're negotiating

868
00:27:53,520 --> 00:27:54,960
if they have the ability to hit you with

869
00:27:54,960 --> 00:27:56,880
a ddos attack to put extra pressure on

870
00:27:56,880 --> 00:27:59,600
you it's quite easy to do ddos is very

871
00:27:59,600 --> 00:28:01,520
scalable very cheap to do so a lot of

872
00:28:01,520 --> 00:28:03,760
groups are going to adopt this and it

873
00:28:03,760 --> 00:28:05,520
just makes sense and then more

874
00:28:05,520 --> 00:28:08,000
importantly quadruple extortion which is

875
00:28:08,000 --> 00:28:09,279
the um

876
00:28:09,279 --> 00:28:11,360
not marketing bingo i promise

877
00:28:11,360 --> 00:28:14,159
but yeah um but what quadruple extortion

878
00:28:14,159 --> 00:28:16,159
is essentially they take the data leak

879
00:28:16,159 --> 00:28:17,919
that they have they essentially scan

880
00:28:17,919 --> 00:28:19,200
through it for emails of all your

881
00:28:19,200 --> 00:28:21,520
customers and they email them and

882
00:28:21,520 --> 00:28:24,399
basically say you did company x got

883
00:28:24,399 --> 00:28:26,559
ransomed we're going to leak all your

884
00:28:26,559 --> 00:28:28,480
data from them unless you get onto the

885
00:28:28,480 --> 00:28:30,399
ceo by the way here's their email

886
00:28:30,399 --> 00:28:32,000
and tell them to pay the ransom now and

887
00:28:32,000 --> 00:28:33,279
that puts the board in an impossible

888
00:28:33,279 --> 00:28:35,360
position where everybody knows knows

889
00:28:35,360 --> 00:28:37,039
they're on the ransom and if they don't

890
00:28:37,039 --> 00:28:39,039
pay it their customers will blame them

891
00:28:39,039 --> 00:28:41,039
for their data going on the internet and

892
00:28:41,039 --> 00:28:42,880
to finalize up the last thing that we

893
00:28:42,880 --> 00:28:44,480
expect to change we talked about how to

894
00:28:44,480 --> 00:28:46,080
kill chains kind of look like this to

895
00:28:46,080 --> 00:28:48,320
this point that makes perfect sense when

896
00:28:48,320 --> 00:28:50,640
you are maybe selling or doing a ransom

897
00:28:50,640 --> 00:28:52,480
for ten thousand but if you're doing a

898
00:28:52,480 --> 00:28:53,919
ransom for a hundred thousand or a

899
00:28:53,919 --> 00:28:56,159
million that is a ton of money to give

900
00:28:56,159 --> 00:28:58,320
away for no good reason so what a lot of

901
00:28:58,320 --> 00:29:00,000
these groups are doing is bringing this

902
00:29:00,000 --> 00:29:02,799
in-house they're maybe giving 20 30 to

903
00:29:02,799 --> 00:29:05,039
the initial finder like a finder's fee

904
00:29:05,039 --> 00:29:06,240
and then they're actually the lateral

905
00:29:06,240 --> 00:29:07,760
movement part they're just putting pen

906
00:29:07,760 --> 00:29:09,840
testers on salaries which is saving them

907
00:29:09,840 --> 00:29:11,279
a ton of money in the process and

908
00:29:11,279 --> 00:29:13,279
basically increasing your margins so

909
00:29:13,279 --> 00:29:14,880
almost every group will adapt this

910
00:29:14,880 --> 00:29:16,960
approach going forward so that's it for

911
00:29:16,960 --> 00:29:18,559
me i want to wrap up saying we did a

912
00:29:18,559 --> 00:29:20,000
whole there's a whole bunch more we

913
00:29:20,000 --> 00:29:21,279
could talk about in ransomware we

914
00:29:21,279 --> 00:29:22,799
haven't talked about things like the

915
00:29:22,799 --> 00:29:24,480
effects of the colonial pipeline or the

916
00:29:24,480 --> 00:29:28,720
hse breach um or hd taxes say on um the

917
00:29:28,720 --> 00:29:30,080
underground or a whole bunch of other

918
00:29:30,080 --> 00:29:31,520
things we could get into there's a load

919
00:29:31,520 --> 00:29:33,200
of other ransomware team talks today so

920
00:29:33,200 --> 00:29:34,720
you can get to see some of that there

921
00:29:34,720 --> 00:29:37,039
but i would be unforgivable if i didn't

922
00:29:37,039 --> 00:29:38,880
cover one last part of ransomware which

923
00:29:38,880 --> 00:29:40,080
is critically important that you

924
00:29:40,080 --> 00:29:42,320
understand and that is of course

925
00:29:42,320 --> 00:29:43,840
reminding you of how all this started

926
00:29:43,840 --> 00:29:46,240
back in 1989

927
00:29:46,240 --> 00:29:49,880
thank you very much everybody

