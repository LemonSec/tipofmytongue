1
00:00:03,840 --> 00:00:05,920
so hello everyone it's a pleasure to be

2
00:00:05,920 --> 00:00:06,720
here

3
00:00:06,720 --> 00:00:08,000
um

4
00:00:08,000 --> 00:00:09,920
what can i say i have to follow brian

5
00:00:09,920 --> 00:00:12,080
honan's talk and i'm between you and

6
00:00:12,080 --> 00:00:14,320
lunch so it's not the easiest sessions

7
00:00:14,320 --> 00:00:15,360
to do

8
00:00:15,360 --> 00:00:16,400
but i hope to try and keep you

9
00:00:16,400 --> 00:00:18,080
entertained throughout

10
00:00:18,080 --> 00:00:20,720
um so my name is joseph carson i'm based

11
00:00:20,720 --> 00:00:22,240
in estonia so i've traveled all the way

12
00:00:22,240 --> 00:00:23,840
from estonia to be here

13
00:00:23,840 --> 00:00:25,199
but you're probably guessing where's

14
00:00:25,199 --> 00:00:26,800
that accent from

15
00:00:26,800 --> 00:00:29,359
um i'm originally from belfast so you

16
00:00:29,359 --> 00:00:31,679
know it's a good time to get here and to

17
00:00:31,679 --> 00:00:33,680
be talking uh to you

18
00:00:33,680 --> 00:00:35,440
so i've been privileged you know first

19
00:00:35,440 --> 00:00:37,200
of all i want to give can we give brian

20
00:00:37,200 --> 00:00:39,040
a big round of applause because

21
00:00:39,040 --> 00:00:41,440
organizing these conferences

22
00:00:41,440 --> 00:00:44,760
is so difficult

23
00:00:45,120 --> 00:00:47,280
and also doing ad hoc talks when you

24
00:00:47,280 --> 00:00:48,960
have the fill spaces is also a challenge

25
00:00:48,960 --> 00:00:50,800
as well but i've been privileged i'm

26
00:00:50,800 --> 00:00:52,239
here to talk about a session i'm going

27
00:00:52,239 --> 00:00:55,199
to take you through a real world story

28
00:00:55,199 --> 00:00:57,280
about a ransomware victim

29
00:00:57,280 --> 00:00:59,280
so one thing i always think is we always

30
00:00:59,280 --> 00:01:02,079
talk about the attackers we talk about

31
00:01:02,079 --> 00:01:03,520
what they did and we talk about the

32
00:01:03,520 --> 00:01:05,519
different incidents but i'd like to take

33
00:01:05,519 --> 00:01:06,799
it sometimes from the approach of the

34
00:01:06,799 --> 00:01:07,760
victim

35
00:01:07,760 --> 00:01:09,920
and try to understand about how their

36
00:01:09,920 --> 00:01:12,000
experience was what they were doing what

37
00:01:12,000 --> 00:01:13,920
they were thinking the challenges that

38
00:01:13,920 --> 00:01:15,840
they faced and this is going to take you

39
00:01:15,840 --> 00:01:17,040
through that journey and this was not a

40
00:01:17,040 --> 00:01:19,200
sophisticated cyber attack it's

41
00:01:19,200 --> 00:01:22,000
basically textbook ransomware incidents

42
00:01:22,000 --> 00:01:23,680
so i want to tell you their story i've

43
00:01:23,680 --> 00:01:25,280
been fortunate to be able to be approved

44
00:01:25,280 --> 00:01:27,280
to tell their story most victims do want

45
00:01:27,280 --> 00:01:29,360
to be known most victims don't want to

46
00:01:29,360 --> 00:01:31,040
tell you that they've been a victim

47
00:01:31,040 --> 00:01:32,640
so they've been privileged and their

48
00:01:32,640 --> 00:01:34,799
point of me sharing the story is they

49
00:01:34,799 --> 00:01:37,439
want to prevent you from making the same

50
00:01:37,439 --> 00:01:39,920
mistakes that they did they want to help

51
00:01:39,920 --> 00:01:42,320
others prevent from having that same

52
00:01:42,320 --> 00:01:44,720
incident and same damage to the business

53
00:01:44,720 --> 00:01:45,680
so i'm going to take you through the

54
00:01:45,680 --> 00:01:48,720
journey so this incident starts with the

55
00:01:48,720 --> 00:01:51,280
variant of crylok so crylock was a

56
00:01:51,280 --> 00:01:53,439
ransomware basically that evolved out of

57
00:01:53,439 --> 00:01:56,240
the previously version which was cryakal

58
00:01:56,240 --> 00:01:58,719
and actually kaspersky did a fantastic

59
00:01:58,719 --> 00:02:01,040
research on blog and chronicle

60
00:02:01,040 --> 00:02:02,960
that actually they did have significant

61
00:02:02,960 --> 00:02:04,960
weaknesses in the encryption method that

62
00:02:04,960 --> 00:02:07,680
was used but crylock which was the

63
00:02:07,680 --> 00:02:10,160
second generation of that evolved around

64
00:02:10,160 --> 00:02:12,640
early 2020 and it was one of the earlier

65
00:02:12,640 --> 00:02:13,840
ransom

66
00:02:13,840 --> 00:02:15,840
groups that actually started to use the

67
00:02:15,840 --> 00:02:17,520
affiliate program ransomware as a

68
00:02:17,520 --> 00:02:19,040
service so rather than actually

69
00:02:19,040 --> 00:02:21,040
delivering the ransomware themselves

70
00:02:21,040 --> 00:02:22,640
they actually give it to other criminal

71
00:02:22,640 --> 00:02:24,640
organizations who would actually gain

72
00:02:24,640 --> 00:02:26,879
the access and deploy it

73
00:02:26,879 --> 00:02:28,959
so they basically are specialized in the

74
00:02:28,959 --> 00:02:30,959
creation of the crypto itself and then

75
00:02:30,959 --> 00:02:32,319
give it to others who will actually use

76
00:02:32,319 --> 00:02:33,599
and abuse it

77
00:02:33,599 --> 00:02:35,040
so this is basically it was an

78
00:02:35,040 --> 00:02:36,800
interesting version a variant that was

79
00:02:36,800 --> 00:02:37,840
being used

80
00:02:37,840 --> 00:02:40,400
and this is basically an organization

81
00:02:40,400 --> 00:02:41,680
who one day

82
00:02:41,680 --> 00:02:43,280
sunday morning

83
00:02:43,280 --> 00:02:45,360
saw this and all their servers and

84
00:02:45,360 --> 00:02:46,720
machines that was connected to the

85
00:02:46,720 --> 00:02:47,599
network

86
00:02:47,599 --> 00:02:49,120
now for many organizations what you'll

87
00:02:49,120 --> 00:02:51,280
typically hear hear or learn about a

88
00:02:51,280 --> 00:02:53,120
ransomware incident is either from your

89
00:02:53,120 --> 00:02:55,519
employees you might find about from your

90
00:02:55,519 --> 00:02:59,440
customers your partners your contractors

91
00:02:59,440 --> 00:03:01,599
in this case the actually ransomware

92
00:03:01,599 --> 00:03:03,840
group emailed the iet department and

93
00:03:03,840 --> 00:03:04,640
said

94
00:03:04,640 --> 00:03:06,879
you become a victim of ransomware and

95
00:03:06,879 --> 00:03:08,239
they started giving instructions they

96
00:03:08,239 --> 00:03:10,560
started giving communications so this

97
00:03:10,560 --> 00:03:12,560
was basically the first lessons that

98
00:03:12,560 --> 00:03:14,800
they learned when they became a victim

99
00:03:14,800 --> 00:03:16,800
now of course this triggers your typical

100
00:03:16,800 --> 00:03:18,800
instant response

101
00:03:18,800 --> 00:03:20,640
and one of the things what i want to

102
00:03:20,640 --> 00:03:22,720
make sure that we all understand

103
00:03:22,720 --> 00:03:24,239
is there's a big difference between

104
00:03:24,239 --> 00:03:25,840
insta response

105
00:03:25,840 --> 00:03:28,159
and being incident ready there's a big

106
00:03:28,159 --> 00:03:29,440
difference having an instant response

107
00:03:29,440 --> 00:03:31,360
plan that you went through you created

108
00:03:31,360 --> 00:03:33,280
your checklist you created your plan you

109
00:03:33,280 --> 00:03:35,280
put it in a drawer and then two years

110
00:03:35,280 --> 00:03:36,159
later

111
00:03:36,159 --> 00:03:37,599
you become a victim and you take that

112
00:03:37,599 --> 00:03:38,879
out and you try to figure out how to

113
00:03:38,879 --> 00:03:40,640
follow it there's a big difference

114
00:03:40,640 --> 00:03:42,319
between instant response plan and

115
00:03:42,319 --> 00:03:44,879
actually having insta-response readiness

116
00:03:44,879 --> 00:03:46,720
and this is a massive difference in this

117
00:03:46,720 --> 00:03:48,480
in this particular incident

118
00:03:48,480 --> 00:03:50,480
this was a major lesson that this

119
00:03:50,480 --> 00:03:52,959
organization was not inc response ready

120
00:03:52,959 --> 00:03:55,200
they actually hadn't agreed on time

121
00:03:55,200 --> 00:03:56,799
format

122
00:03:56,799 --> 00:03:59,599
naming conventions of gathering images

123
00:03:59,599 --> 00:04:01,680
they didn't have any policies in place

124
00:04:01,680 --> 00:04:04,159
about how hr should communicate they

125
00:04:04,159 --> 00:04:06,959
didn't have actually legal uh council

126
00:04:06,959 --> 00:04:08,640
about how they should actually from a

127
00:04:08,640 --> 00:04:10,319
legal perspective did they have to

128
00:04:10,319 --> 00:04:11,920
follow things like gdpr did they have to

129
00:04:11,920 --> 00:04:14,319
notify the data protection authority

130
00:04:14,319 --> 00:04:16,238
they actually hadn't communications or

131
00:04:16,238 --> 00:04:17,680
established connections with law

132
00:04:17,680 --> 00:04:19,358
enforcement about how they should deal

133
00:04:19,358 --> 00:04:21,279
with it the national cert they didn't

134
00:04:21,279 --> 00:04:22,800
have actually communications are and

135
00:04:22,800 --> 00:04:25,440
relationships established

136
00:04:25,440 --> 00:04:27,199
also evidence gathering

137
00:04:27,199 --> 00:04:29,040
they didn't know how to collect evidence

138
00:04:29,040 --> 00:04:31,360
and maintain it and prevent damaging or

139
00:04:31,360 --> 00:04:33,919
tampering um of that evidence as well

140
00:04:33,919 --> 00:04:35,919
they also didn't have identities or

141
00:04:35,919 --> 00:04:38,400
access that was segregated

142
00:04:38,400 --> 00:04:40,000
we actually in the instant response we

143
00:04:40,000 --> 00:04:42,080
had to use the same identities that the

144
00:04:42,080 --> 00:04:43,840
criminals had already compromised in the

145
00:04:43,840 --> 00:04:46,720
environment in order to gain control

146
00:04:46,720 --> 00:04:48,320
contaminates evidence that's the last

147
00:04:48,320 --> 00:04:49,919
thing you want to be doing they also had

148
00:04:49,919 --> 00:04:51,040
lots of service accounts that they

149
00:04:51,040 --> 00:04:52,960
didn't know how to rotate credentials

150
00:04:52,960 --> 00:04:54,560
because the fear of breaking more

151
00:04:54,560 --> 00:04:57,440
systems

152
00:04:57,440 --> 00:04:59,120
one thing that i always have is a go bag

153
00:04:59,120 --> 00:05:01,440
as well because you never know how long

154
00:05:01,440 --> 00:05:02,320
when you're actually dealing with

155
00:05:02,320 --> 00:05:03,600
innocent you'll be sitting in a data

156
00:05:03,600 --> 00:05:05,440
center for a long time

157
00:05:05,440 --> 00:05:07,199
without actually having any access to

158
00:05:07,199 --> 00:05:09,280
food so having something ready to go

159
00:05:09,280 --> 00:05:12,240
huge amounts of clean sanitized disks as

160
00:05:12,240 --> 00:05:13,759
well because you will go through lots of

161
00:05:13,759 --> 00:05:16,720
hard disks and taking lots of images

162
00:05:16,720 --> 00:05:18,880
also alternative means of communication

163
00:05:18,880 --> 00:05:20,240
many times

164
00:05:20,240 --> 00:05:22,880
you might not have access to email your

165
00:05:22,880 --> 00:05:24,560
phone system might be a voip phone

166
00:05:24,560 --> 00:05:26,880
system which might not be available so

167
00:05:26,880 --> 00:05:28,479
also making sure that your readiness

168
00:05:28,479 --> 00:05:30,240
goes through making sure you've got set

169
00:05:30,240 --> 00:05:32,000
up alternative means of communication as

170
00:05:32,000 --> 00:05:32,800
well

171
00:05:32,800 --> 00:05:34,960
many organizations have a support team

172
00:05:34,960 --> 00:05:38,080
or help desk also having the help desk

173
00:05:38,080 --> 00:05:41,120
practice and be prepared because when

174
00:05:41,120 --> 00:05:43,680
that goes public once the criminal guide

175
00:05:43,680 --> 00:05:45,680
puts something out on social media on

176
00:05:45,680 --> 00:05:48,639
twitter they will get an influx of calls

177
00:05:48,639 --> 00:05:52,720
from worried customers worried partners

178
00:05:52,720 --> 00:05:54,320
it will actually have a massive impact

179
00:05:54,320 --> 00:05:56,720
in organization support and help desk

180
00:05:56,720 --> 00:05:58,400
having the plan

181
00:05:58,400 --> 00:06:00,160
and having practice drills is so

182
00:06:00,160 --> 00:06:02,080
critical so make sure you differentiate

183
00:06:02,080 --> 00:06:03,280
between the difference between being

184
00:06:03,280 --> 00:06:04,960
insert ready and having an instant

185
00:06:04,960 --> 00:06:06,960
response plan and make sure you keep it

186
00:06:06,960 --> 00:06:08,880
updated and keep it practiced this

187
00:06:08,880 --> 00:06:11,280
organization they had a plan but they

188
00:06:11,280 --> 00:06:12,560
were not prepared when the incident

189
00:06:12,560 --> 00:06:13,680
happened

190
00:06:13,680 --> 00:06:15,680
so they did have a checklist response

191
00:06:15,680 --> 00:06:17,759
which was a bit outdated

192
00:06:17,759 --> 00:06:19,360
this is one that i helped them create

193
00:06:19,360 --> 00:06:20,880
and help them actually improve as we

194
00:06:20,880 --> 00:06:22,639
went through the incident making sure

195
00:06:22,639 --> 00:06:24,319
they had clear definite definition of

196
00:06:24,319 --> 00:06:26,400
who's responsible in ownership for what

197
00:06:26,400 --> 00:06:28,720
part of the incident and one thing they

198
00:06:28,720 --> 00:06:30,720
realized was there's a big difference

199
00:06:30,720 --> 00:06:33,280
between a security incident or an iet

200
00:06:33,280 --> 00:06:35,919
incident and a business response a

201
00:06:35,919 --> 00:06:37,520
business incident

202
00:06:37,520 --> 00:06:39,520
because they had traditionally looked at

203
00:06:39,520 --> 00:06:41,280
their response plan as being something

204
00:06:41,280 --> 00:06:44,160
that it was only an i.t team response

205
00:06:44,160 --> 00:06:45,840
they didn't realize that actually entire

206
00:06:45,840 --> 00:06:47,280
organization the business had to come

207
00:06:47,280 --> 00:06:49,120
together to respond

208
00:06:49,120 --> 00:06:50,639
so making sure you've got clear

209
00:06:50,639 --> 00:06:52,880
ownership so who's communicating what

210
00:06:52,880 --> 00:06:55,680
having an updated contact list including

211
00:06:55,680 --> 00:06:58,160
access to specialists and experts who

212
00:06:58,160 --> 00:07:00,960
actually do this on a daily basis

213
00:07:00,960 --> 00:07:02,960
also clear definition of the threat

214
00:07:02,960 --> 00:07:05,039
understand what you're dealing with make

215
00:07:05,039 --> 00:07:07,440
sure that you know what type of incident

216
00:07:07,440 --> 00:07:10,240
is it data exfiltration is it ransomware

217
00:07:10,240 --> 00:07:11,680
does it self propagate around the

218
00:07:11,680 --> 00:07:13,520
network does it laterally move do the

219
00:07:13,520 --> 00:07:15,360
attackers still have access are they

220
00:07:15,360 --> 00:07:17,199
ddos in the environment as well holding

221
00:07:17,199 --> 00:07:19,280
up the service having a clear definition

222
00:07:19,280 --> 00:07:20,639
will also help make sure you have

223
00:07:20,639 --> 00:07:22,720
relevant press statements prepared for

224
00:07:22,720 --> 00:07:24,479
those different types of responses as

225
00:07:24,479 --> 00:07:25,440
well

226
00:07:25,440 --> 00:07:27,520
understanding your in-house capabilities

227
00:07:27,520 --> 00:07:29,280
this was an it team

228
00:07:29,280 --> 00:07:31,599
who also did security but they were not

229
00:07:31,599 --> 00:07:34,240
security experts so they didn't have

230
00:07:34,240 --> 00:07:37,039
outsourced or external uh retainers with

231
00:07:37,039 --> 00:07:38,479
experts who could come in quickly to

232
00:07:38,479 --> 00:07:40,160
help them they didn't understand about

233
00:07:40,160 --> 00:07:42,400
how to contain the uh the actually the

234
00:07:42,400 --> 00:07:43,599
incident itself

235
00:07:43,599 --> 00:07:45,840
they had no press statements ready

236
00:07:45,840 --> 00:07:47,360
they had actually legal counsel but they

237
00:07:47,360 --> 00:07:49,120
didn't have any legal assessment for

238
00:07:49,120 --> 00:07:51,280
risks things like gdpr they didn't

239
00:07:51,280 --> 00:07:53,680
understand about how to eradicate

240
00:07:53,680 --> 00:07:55,840
what recovery practices were also done

241
00:07:55,840 --> 00:07:57,120
and also going through that lessons

242
00:07:57,120 --> 00:07:58,639
learned so it's important to also make

243
00:07:58,639 --> 00:08:00,560
sure you have this checklist and

244
00:08:00,560 --> 00:08:02,720
actually do it and practice it on a

245
00:08:02,720 --> 00:08:04,319
regular basis

246
00:08:04,319 --> 00:08:06,639
so when i come in to help them

247
00:08:06,639 --> 00:08:08,639
i responded and some of the questions

248
00:08:08,639 --> 00:08:10,080
that i go through to make sure i

249
00:08:10,080 --> 00:08:11,280
understand

250
00:08:11,280 --> 00:08:14,319
how actually severe the incident is

251
00:08:14,319 --> 00:08:15,520
some of the questions i will have is

252
00:08:15,520 --> 00:08:16,879
things like did they have access to the

253
00:08:16,879 --> 00:08:18,879
domain controller did they have access

254
00:08:18,879 --> 00:08:21,440
to domain accounts

255
00:08:21,440 --> 00:08:23,199
what about systems

256
00:08:23,199 --> 00:08:25,280
so in this case yes the attackers did

257
00:08:25,280 --> 00:08:28,400
have full domain administrator access

258
00:08:28,400 --> 00:08:29,520
and i will actually take you through the

259
00:08:29,520 --> 00:08:31,520
process of how they did that in the

260
00:08:31,520 --> 00:08:33,200
attack path that they took

261
00:08:33,200 --> 00:08:34,799
they had access to the systems which

262
00:08:34,799 --> 00:08:36,479
were online

263
00:08:36,479 --> 00:08:38,240
so it happened of course early hours of

264
00:08:38,240 --> 00:08:40,320
sunday morning so fortunately enough a

265
00:08:40,320 --> 00:08:41,839
lot of the employees had taken their

266
00:08:41,839 --> 00:08:43,519
laptops home and were not connected to

267
00:08:43,519 --> 00:08:45,120
the network so they were actually

268
00:08:45,120 --> 00:08:47,360
prevented from becoming victims

269
00:08:47,360 --> 00:08:49,120
the machines at the office a lot of the

270
00:08:49,120 --> 00:08:50,560
machines actually been switched off of

271
00:08:50,560 --> 00:08:52,720
the employees so also they were excluded

272
00:08:52,720 --> 00:08:54,959
from becoming affected but any machine

273
00:08:54,959 --> 00:08:56,800
that was connected that was online in

274
00:08:56,800 --> 00:08:59,200
that infrastructure became infected the

275
00:08:59,200 --> 00:09:00,800
attackers had access to all the

276
00:09:00,800 --> 00:09:01,760
corporate

277
00:09:01,760 --> 00:09:03,279
applications

278
00:09:03,279 --> 00:09:05,279
they had access to only the on-premise

279
00:09:05,279 --> 00:09:07,440
environment it hadn't laterally moved to

280
00:09:07,440 --> 00:09:08,399
the cloud

281
00:09:08,399 --> 00:09:09,760
so they were fortunate enough that their

282
00:09:09,760 --> 00:09:11,600
cloud environment had been segregated

283
00:09:11,600 --> 00:09:13,200
and actually prevented because it

284
00:09:13,200 --> 00:09:14,959
allowed some element of the business to

285
00:09:14,959 --> 00:09:16,320
continue

286
00:09:16,320 --> 00:09:18,080
the investigation

287
00:09:18,080 --> 00:09:19,760
find that the actually attackers had

288
00:09:19,760 --> 00:09:21,680
hands-on keyboard access for

289
00:09:21,680 --> 00:09:24,240
approximately almost two weeks so just a

290
00:09:24,240 --> 00:09:26,880
little bit over 14 days almost 15 days

291
00:09:26,880 --> 00:09:28,560
was the active time that they were

292
00:09:28,560 --> 00:09:29,839
actually hands on keyboard in the

293
00:09:29,839 --> 00:09:32,240
environment doing enumeration

294
00:09:32,240 --> 00:09:34,320
searching for privilege elevation

295
00:09:34,320 --> 00:09:35,839
and looking for basically their crown

296
00:09:35,839 --> 00:09:37,920
dolls and jewels they're very valuable

297
00:09:37,920 --> 00:09:39,519
data to make sure that they actually

298
00:09:39,519 --> 00:09:41,920
cause as much damage as possible

299
00:09:41,920 --> 00:09:44,000
the entire attack actually

300
00:09:44,000 --> 00:09:45,680
the first instant the attack was seven

301
00:09:45,680 --> 00:09:47,519
months prior

302
00:09:47,519 --> 00:09:49,040
seven months prior to that and i'll get

303
00:09:49,040 --> 00:09:50,959
to that shortly so that's kind of the

304
00:09:50,959 --> 00:09:52,800
length of time two weeks of active

305
00:09:52,800 --> 00:09:53,839
keyboard

306
00:09:53,839 --> 00:09:55,839
seven months of the initial actually uh

307
00:09:55,839 --> 00:09:57,839
attack um had started

308
00:09:57,839 --> 00:09:59,360
i'll also go through i like to

309
00:09:59,360 --> 00:10:00,480
understand about what tools and

310
00:10:00,480 --> 00:10:02,000
techniques they use so i'm gonna share

311
00:10:02,000 --> 00:10:04,240
with you some of those tools as well

312
00:10:04,240 --> 00:10:05,920
also what types of back doors you find a

313
00:10:05,920 --> 00:10:08,000
lot of the criminal guides will also

314
00:10:08,000 --> 00:10:09,920
leave back doors so even if they do get

315
00:10:09,920 --> 00:10:11,600
payment or don't get payment they might

316
00:10:11,600 --> 00:10:13,440
decide to sell that access to other

317
00:10:13,440 --> 00:10:14,880
criminals who will actually use and

318
00:10:14,880 --> 00:10:16,800
abuse it as well there's a massive

319
00:10:16,800 --> 00:10:18,800
market for actually selling access to

320
00:10:18,800 --> 00:10:21,120
organizations um and actually this

321
00:10:21,120 --> 00:10:22,959
particular case there was multiple

322
00:10:22,959 --> 00:10:25,040
parties involved there was an uh

323
00:10:25,040 --> 00:10:27,279
criminal guy who specialized in gaining

324
00:10:27,279 --> 00:10:28,640
access

325
00:10:28,640 --> 00:10:30,480
they sold the access to another criminal

326
00:10:30,480 --> 00:10:33,440
guy that criminal guy bought the access

327
00:10:33,440 --> 00:10:35,760
they bought the crypters and then used

328
00:10:35,760 --> 00:10:37,360
that access to again

329
00:10:37,360 --> 00:10:39,360
initial foothold in the organization and

330
00:10:39,360 --> 00:10:40,720
then the help desk the team that was

331
00:10:40,720 --> 00:10:43,040
communicating with the organization was

332
00:10:43,040 --> 00:10:44,800
also a separate they were help desk for

333
00:10:44,800 --> 00:10:46,480
hire in order to help communicate

334
00:10:46,480 --> 00:10:47,680
because of course the criminals don't

335
00:10:47,680 --> 00:10:50,000
speak native english

336
00:10:50,000 --> 00:10:51,440
so sometimes you're dealing with

337
00:10:51,440 --> 00:10:54,000
multiple attackers in that attack chain

338
00:10:54,000 --> 00:10:55,760
also understand about what data did they

339
00:10:55,760 --> 00:10:57,839
take and how did they take it as well

340
00:10:57,839 --> 00:10:59,360
what was the entire timeline creating

341
00:10:59,360 --> 00:11:01,519
that super timeline using things like

342
00:11:01,519 --> 00:11:03,279
plaso or log to timeline in order to

343
00:11:03,279 --> 00:11:05,200
understand about the series of events

344
00:11:05,200 --> 00:11:06,640
and actually when we did the log to

345
00:11:06,640 --> 00:11:08,560
timeline it actually uncovered more

346
00:11:08,560 --> 00:11:10,480
interesting other incidents that had

347
00:11:10,480 --> 00:11:11,920
happened in the environment that were

348
00:11:11,920 --> 00:11:13,519
not related to the ransomware case

349
00:11:13,519 --> 00:11:15,839
itself things like somebody had deployed

350
00:11:15,839 --> 00:11:17,519
a crypto mining software in the

351
00:11:17,519 --> 00:11:19,519
environment and using the organization's

352
00:11:19,519 --> 00:11:21,120
uh computer resource to mine

353
00:11:21,120 --> 00:11:23,040
cryptocurrency so you sometimes you'll

354
00:11:23,040 --> 00:11:25,200
uncover other instances and other events

355
00:11:25,200 --> 00:11:27,279
when you do these super timelines and

356
00:11:27,279 --> 00:11:29,519
also what evidence is remaining another

357
00:11:29,519 --> 00:11:31,040
important area

358
00:11:31,040 --> 00:11:32,560
so we get through

359
00:11:32,560 --> 00:11:34,640
when you go through that questions

360
00:11:34,640 --> 00:11:35,920
one of the things you you start thinking

361
00:11:35,920 --> 00:11:37,120
about how do we can get that

362
00:11:37,120 --> 00:11:39,040
organization back to recovery how we can

363
00:11:39,040 --> 00:11:41,120
get them back to business how can we you

364
00:11:41,120 --> 00:11:42,640
know make the organization

365
00:11:42,640 --> 00:11:43,920
move forward

366
00:11:43,920 --> 00:11:45,920
i tend to have three responses sometimes

367
00:11:45,920 --> 00:11:48,079
there's four but mostly three let's

368
00:11:48,079 --> 00:11:49,839
restore from your backup

369
00:11:49,839 --> 00:11:52,079
well i've got unfortunate news

370
00:11:52,079 --> 00:11:54,240
the backups also encrypted

371
00:11:54,240 --> 00:11:56,079
they had a backup system but the backup

372
00:11:56,079 --> 00:11:59,120
strategy was not actually tailored or

373
00:11:59,120 --> 00:12:00,959
actually focused around ransomware

374
00:12:00,959 --> 00:12:02,639
prevention it was actually focused on

375
00:12:02,639 --> 00:12:04,320
data corruption it was focused around

376
00:12:04,320 --> 00:12:06,399
hardware failure so we have to make sure

377
00:12:06,399 --> 00:12:08,639
that if you have a backup and recovery

378
00:12:08,639 --> 00:12:10,320
strategy that you actually make sure

379
00:12:10,320 --> 00:12:11,839
that actually is effective against

380
00:12:11,839 --> 00:12:13,600
ransomware not just against hardware

381
00:12:13,600 --> 00:12:16,000
failure or data corruption because the

382
00:12:16,000 --> 00:12:17,120
last thing you want to be doing is

383
00:12:17,120 --> 00:12:18,639
looking at your backup server and it's

384
00:12:18,639 --> 00:12:20,160
also encrypted so you're left with

385
00:12:20,160 --> 00:12:21,360
nothing

386
00:12:21,360 --> 00:12:23,360
so this is the start of their backup

387
00:12:23,360 --> 00:12:24,480
server

388
00:12:24,480 --> 00:12:27,360
basically was also fully encrypted

389
00:12:27,360 --> 00:12:29,600
so left them to the next choices paying

390
00:12:29,600 --> 00:12:31,120
the ransom

391
00:12:31,120 --> 00:12:32,959
they started negotiating with the ransom

392
00:12:32,959 --> 00:12:34,320
and actually an interesting survey that

393
00:12:34,320 --> 00:12:36,399
we did at psychotic centrify was

394
00:12:36,399 --> 00:12:38,079
actually recently the survey and as he

395
00:12:38,079 --> 00:12:39,200
relates to some of the comments that

396
00:12:39,200 --> 00:12:41,760
brian had made was actually more than 80

397
00:12:41,760 --> 00:12:43,839
organizations are paying the ransom to

398
00:12:43,839 --> 00:12:46,399
recover 80 percent of organizations

399
00:12:46,399 --> 00:12:48,480
funding the next generation of

400
00:12:48,480 --> 00:12:51,120
ransomware crime

401
00:12:51,120 --> 00:12:53,279
it just means it's going to get more

402
00:12:53,279 --> 00:12:55,360
like improved and evolved ransomware

403
00:12:55,360 --> 00:12:56,399
it's going to make our jobs more

404
00:12:56,399 --> 00:12:57,760
difficult in the future

405
00:12:57,760 --> 00:12:58,880
so it's really important to understand

406
00:12:58,880 --> 00:13:01,680
about is paying rent to run an option

407
00:13:01,680 --> 00:13:03,120
so they decided they're not going to pay

408
00:13:03,120 --> 00:13:05,600
the ransomware they move to the third

409
00:13:05,600 --> 00:13:07,760
option here which is what rebuild how do

410
00:13:07,760 --> 00:13:09,920
we rebuild fortunately enough they

411
00:13:09,920 --> 00:13:12,639
actually did a server migration one year

412
00:13:12,639 --> 00:13:13,920
prior to that

413
00:13:13,920 --> 00:13:15,920
one year prior their erp system went and

414
00:13:15,920 --> 00:13:17,279
did a migration

415
00:13:17,279 --> 00:13:19,839
the system that they migrated from was

416
00:13:19,839 --> 00:13:21,360
actually due to be de-provisioned and

417
00:13:21,360 --> 00:13:22,959
repurposed fortunately enough was

418
00:13:22,959 --> 00:13:24,399
sitting gathering dust and hadn't been

419
00:13:24,399 --> 00:13:26,560
used so we were able to use that system

420
00:13:26,560 --> 00:13:28,480
as a baseline it meant that they

421
00:13:28,480 --> 00:13:30,720
actually lost an entire year's worth of

422
00:13:30,720 --> 00:13:33,680
business data one full year

423
00:13:33,680 --> 00:13:35,279
of data was lost

424
00:13:35,279 --> 00:13:36,880
so it meant that we had to go through in

425
00:13:36,880 --> 00:13:38,480
order to recover and look at getting the

426
00:13:38,480 --> 00:13:40,480
business back to operations was to find

427
00:13:40,480 --> 00:13:42,880
data in things like paper receipts

428
00:13:42,880 --> 00:13:46,399
inventory receipts in people's emails in

429
00:13:46,399 --> 00:13:48,880
usb drives we went searching for as much

430
00:13:48,880 --> 00:13:50,880
data as possible in order to start the

431
00:13:50,880 --> 00:13:52,720
rebuild process

432
00:13:52,720 --> 00:13:54,480
it took them three months

433
00:13:54,480 --> 00:13:56,720
to take that one-year-old migrated

434
00:13:56,720 --> 00:13:57,920
database

435
00:13:57,920 --> 00:13:59,279
and all of the data that they're

436
00:13:59,279 --> 00:14:00,880
actually in other places to try and

437
00:14:00,880 --> 00:14:04,000
rebuild three months and a ton of people

438
00:14:04,000 --> 00:14:05,920
uh creating and entering that data in in

439
00:14:05,920 --> 00:14:08,160
order to get back to somewhat similar

440
00:14:08,160 --> 00:14:09,680
operations that they had prior to this

441
00:14:09,680 --> 00:14:12,000
so three months of impacted business

442
00:14:12,000 --> 00:14:13,760
significant there sometimes is a fourth

443
00:14:13,760 --> 00:14:15,920
option but it's not one that i put here

444
00:14:15,920 --> 00:14:17,120
is that you might find security

445
00:14:17,120 --> 00:14:18,639
researchers are able to find weaknesses

446
00:14:18,639 --> 00:14:20,480
in the encryption they might be able to

447
00:14:20,480 --> 00:14:21,839
recover the key and the key might be

448
00:14:21,839 --> 00:14:23,600
fine and made public it might be a

449
00:14:23,600 --> 00:14:25,279
static key that's reused across the

450
00:14:25,279 --> 00:14:27,440
encrypters so you might be fortunate

451
00:14:27,440 --> 00:14:28,959
enough to find security researchers who

452
00:14:28,959 --> 00:14:32,160
do that but it's not an option that is

453
00:14:32,160 --> 00:14:34,639
happens often and it's not enough to put

454
00:14:34,639 --> 00:14:36,079
it up here to give you that fourth

455
00:14:36,079 --> 00:14:37,279
option

456
00:14:37,279 --> 00:14:38,399
so

457
00:14:38,399 --> 00:14:39,920
you're now faced with these options

458
00:14:39,920 --> 00:14:41,680
you're looking at your recovery scenario

459
00:14:41,680 --> 00:14:42,959
you've got your insta response plan

460
00:14:42,959 --> 00:14:44,240
you've got different people tasked with

461
00:14:44,240 --> 00:14:45,839
different scenarios

462
00:14:45,839 --> 00:14:47,519
the question is do the attackers still

463
00:14:47,519 --> 00:14:48,800
have access

464
00:14:48,800 --> 00:14:50,720
in this case yes the attacker still had

465
00:14:50,720 --> 00:14:52,639
ongoing access and this is all happening

466
00:14:52,639 --> 00:14:54,480
at the same time all of these decisions

467
00:14:54,480 --> 00:14:56,959
are all happening in the first few hours

468
00:14:56,959 --> 00:14:58,800
of the incident the first few hours of

469
00:14:58,800 --> 00:15:01,680
communication that actually was detected

470
00:15:01,680 --> 00:15:04,480
and they were faced with these scenarios

471
00:15:04,480 --> 00:15:06,160
can we go back to manual operations can

472
00:15:06,160 --> 00:15:07,760
we go back to paper for a lot of the

473
00:15:07,760 --> 00:15:09,279
business

474
00:15:09,279 --> 00:15:10,800
what systems are still operational what

475
00:15:10,800 --> 00:15:13,519
was turned off at the time of the attack

476
00:15:13,519 --> 00:15:14,720
and was the attacker still having

477
00:15:14,720 --> 00:15:17,600
persistent active access

478
00:15:17,600 --> 00:15:19,360
and they were they still had a remote

479
00:15:19,360 --> 00:15:21,680
session open up to the environment so we

480
00:15:21,680 --> 00:15:24,000
had to make the tough decision about

481
00:15:24,000 --> 00:15:26,320
switching off the internet

482
00:15:26,320 --> 00:15:28,079
so we go back to ralph who breaks the

483
00:15:28,079 --> 00:15:29,680
internet we actually had to turn off the

484
00:15:29,680 --> 00:15:31,360
internet for this entire business in

485
00:15:31,360 --> 00:15:33,440
order to regain control to make sure the

486
00:15:33,440 --> 00:15:36,800
attackers didn't have persistent access

487
00:15:36,800 --> 00:15:38,800
not a lot of businesses can do that

488
00:15:38,800 --> 00:15:40,240
if you're also dependent on cloud

489
00:15:40,240 --> 00:15:41,519
environments how do you turn off the

490
00:15:41,519 --> 00:15:43,519
cloud

491
00:15:43,519 --> 00:15:45,279
how do maybe they've pers you know

492
00:15:45,279 --> 00:15:47,360
severed your access to your environment

493
00:15:47,360 --> 00:15:48,720
so you have to understand about how you

494
00:15:48,720 --> 00:15:50,399
can recover that

495
00:15:50,399 --> 00:15:52,480
fortunate enough we were able to simply

496
00:15:52,480 --> 00:15:54,880
unplug the isp provider and sever that

497
00:15:54,880 --> 00:15:57,040
connection but it left a bit of a mess

498
00:15:57,040 --> 00:15:59,279
for us to clean up so the next thing

499
00:15:59,279 --> 00:16:01,440
that i do is i'm looking for a copy of

500
00:16:01,440 --> 00:16:02,880
the crypter i want to find out what is

501
00:16:02,880 --> 00:16:04,160
it we're dealing with

502
00:16:04,160 --> 00:16:06,000
how severe is the impact does this

503
00:16:06,000 --> 00:16:07,920
crypto self propagate around the

504
00:16:07,920 --> 00:16:09,279
environment does it also steal

505
00:16:09,279 --> 00:16:10,560
credentials

506
00:16:10,560 --> 00:16:12,560
what's the encryption like so finding a

507
00:16:12,560 --> 00:16:14,399
copy of the crypter is so critical to

508
00:16:14,399 --> 00:16:16,160
understand about what it exactly is

509
00:16:16,160 --> 00:16:17,839
you're dealing with and ultimately

510
00:16:17,839 --> 00:16:20,000
basically i use tools like joe sandbox

511
00:16:20,000 --> 00:16:21,759
you might be familiar with it taking a

512
00:16:21,759 --> 00:16:23,279
copy of that crypter and uploading it

513
00:16:23,279 --> 00:16:24,639
and we'll actually go through and run

514
00:16:24,639 --> 00:16:27,199
the hex decrypter in a sandbox to find

515
00:16:27,199 --> 00:16:29,199
out is there a command and control does

516
00:16:29,199 --> 00:16:31,199
it steal credentials how does it

517
00:16:31,199 --> 00:16:32,959
propagate what changes does it make in

518
00:16:32,959 --> 00:16:35,120
the registry there's a persistence so

519
00:16:35,120 --> 00:16:36,800
this gives me a really good idea of how

520
00:16:36,800 --> 00:16:39,040
severe the impact and what we can do to

521
00:16:39,040 --> 00:16:41,040
look at the recovery path what's our

522
00:16:41,040 --> 00:16:42,399
recovery options about how do we

523
00:16:42,399 --> 00:16:44,160
eradicate do we actually need to rebuild

524
00:16:44,160 --> 00:16:45,519
the entire active directory and end

525
00:16:45,519 --> 00:16:47,199
points from scratch

526
00:16:47,199 --> 00:16:48,480
so this gives me good understanding

527
00:16:48,480 --> 00:16:50,639
about how do we recover what is it we're

528
00:16:50,639 --> 00:16:52,399
dealing with

529
00:16:52,399 --> 00:16:54,079
the next phase of course you want to why

530
00:16:54,079 --> 00:16:55,519
did your security controls you had in

531
00:16:55,519 --> 00:16:57,120
place not work

532
00:16:57,120 --> 00:16:59,360
this organization had security it's not

533
00:16:59,360 --> 00:17:01,279
that they basically were completely

534
00:17:01,279 --> 00:17:03,360
opened they actually had security in

535
00:17:03,360 --> 00:17:05,599
place they had antivirus they had erp

536
00:17:05,599 --> 00:17:07,520
systems they had firewalls they had

537
00:17:07,520 --> 00:17:09,679
multi-factor authentication like most

538
00:17:09,679 --> 00:17:12,400
organizations they had security in place

539
00:17:12,400 --> 00:17:14,319
so we want to understand why it didn't

540
00:17:14,319 --> 00:17:16,240
affect what was it what was the impact

541
00:17:16,240 --> 00:17:18,720
why is it not effective this is actually

542
00:17:18,720 --> 00:17:21,199
a running of it shortly after

543
00:17:21,199 --> 00:17:22,959
the incident where most avs started

544
00:17:22,959 --> 00:17:24,799
picking it up but when we did this

545
00:17:24,799 --> 00:17:27,199
initially the first time we uploaded the

546
00:17:27,199 --> 00:17:30,000
variant of the crypto that attacked them

547
00:17:30,000 --> 00:17:32,480
only two out of all the avs were

548
00:17:32,480 --> 00:17:34,000
detecting it

549
00:17:34,000 --> 00:17:34,720
so

550
00:17:34,720 --> 00:17:36,480
it meant that if your organization was

551
00:17:36,480 --> 00:17:39,840
still running any avs on this list

552
00:17:39,840 --> 00:17:42,240
that only two were actually detecting it

553
00:17:42,240 --> 00:17:43,440
out of that

554
00:17:43,440 --> 00:17:44,880
so it meant that we had to look at well

555
00:17:44,880 --> 00:17:46,960
why wasn't it detected it was actually a

556
00:17:46,960 --> 00:17:48,880
pretty recent uh

557
00:17:48,880 --> 00:17:50,720
creation of the variant it was pretty

558
00:17:50,720 --> 00:17:52,480
new so not many organizations have

559
00:17:52,480 --> 00:17:54,559
become previous victims it was actually

560
00:17:54,559 --> 00:17:56,720
from the creation of the crypter to

561
00:17:56,720 --> 00:17:58,799
deployment was a space of about three to

562
00:17:58,799 --> 00:18:00,799
four weeks

563
00:18:00,799 --> 00:18:02,400
and also we did find that they actually

564
00:18:02,400 --> 00:18:04,480
also had other cryptos in their tool set

565
00:18:04,480 --> 00:18:05,840
as well

566
00:18:05,840 --> 00:18:07,840
they just decided to use this one

567
00:18:07,840 --> 00:18:09,919
because this organization was would not

568
00:18:09,919 --> 00:18:12,160
detect it they had other versions they

569
00:18:12,160 --> 00:18:13,679
had double pulsar and a few other

570
00:18:13,679 --> 00:18:15,600
variants of ransomware that was ready to

571
00:18:15,600 --> 00:18:16,640
go

572
00:18:16,640 --> 00:18:18,559
ready to be deployed but they decided to

573
00:18:18,559 --> 00:18:20,400
choose the crylock version

574
00:18:20,400 --> 00:18:22,160
so that's one thing you have to be aware

575
00:18:22,160 --> 00:18:23,360
of that they'll actually be looking at

576
00:18:23,360 --> 00:18:25,039
by which

577
00:18:25,039 --> 00:18:26,720
how your systems will not detect it

578
00:18:26,720 --> 00:18:27,919
making sure they were able to be as

579
00:18:27,919 --> 00:18:29,760
effective as possible so they actually

580
00:18:29,760 --> 00:18:30,880
first of all do the enumeration

581
00:18:30,880 --> 00:18:32,960
environment and then decide which crypto

582
00:18:32,960 --> 00:18:34,480
decide to deploy

583
00:18:34,480 --> 00:18:36,400
the next thing so i like to basically

584
00:18:36,400 --> 00:18:38,480
now i've got an idea of the crypter i've

585
00:18:38,480 --> 00:18:40,640
got an idea of why it wasn't actually

586
00:18:40,640 --> 00:18:42,480
defended why the organization didn't

587
00:18:42,480 --> 00:18:44,320
prevent it so then i started going

588
00:18:44,320 --> 00:18:45,600
through following the attacker's

589
00:18:45,600 --> 00:18:47,520
footprints i started putting my ethical

590
00:18:47,520 --> 00:18:48,960
hacker hat on and tried to understand

591
00:18:48,960 --> 00:18:50,960
about well if i was in those shoes how

592
00:18:50,960 --> 00:18:52,799
would i should do this attack and start

593
00:18:52,799 --> 00:18:54,720
doing the reverse so the first thing is

594
00:18:54,720 --> 00:18:56,080
you're going to go through and you want

595
00:18:56,080 --> 00:18:58,480
to find those initial staging systems

596
00:18:58,480 --> 00:19:00,400
you want to find out where basically

597
00:19:00,400 --> 00:19:01,840
they gain the access you want to shut

598
00:19:01,840 --> 00:19:03,440
the door permanently you understand

599
00:19:03,440 --> 00:19:05,280
about how did they get that initial

600
00:19:05,280 --> 00:19:06,880
foothold what other systems the

601
00:19:06,880 --> 00:19:08,240
environment that they use for staging

602
00:19:08,240 --> 00:19:10,240
machines because what they will tend to

603
00:19:10,240 --> 00:19:11,840
do is they'll do enumeration one of the

604
00:19:11,840 --> 00:19:13,120
things that brian mentioned earlier but

605
00:19:13,120 --> 00:19:14,320
name a convention which is always

606
00:19:14,320 --> 00:19:16,960
hilarious sometimes we name the systems

607
00:19:16,960 --> 00:19:19,039
so poorly that we actually tell the

608
00:19:19,039 --> 00:19:21,600
attackers what the server is doing

609
00:19:21,600 --> 00:19:23,360
this is our erp server this is our

610
00:19:23,360 --> 00:19:25,120
backup server this is our sql server

611
00:19:25,120 --> 00:19:26,880
this is our you know

612
00:19:26,880 --> 00:19:29,440
access server we name things to simplify

613
00:19:29,440 --> 00:19:30,960
for us but we also give the attackers an

614
00:19:30,960 --> 00:19:32,880
advantage of making it easier for them

615
00:19:32,880 --> 00:19:34,480
to actually understand what task or

616
00:19:34,480 --> 00:19:36,640
purpose that machine or server is doing

617
00:19:36,640 --> 00:19:37,840
so it's really important to find these

618
00:19:37,840 --> 00:19:39,679
initial staging but the unfortunate

619
00:19:39,679 --> 00:19:41,520
thing for an insta responder is that you

620
00:19:41,520 --> 00:19:42,720
tend to find that they're really good at

621
00:19:42,720 --> 00:19:44,960
hiding their tracks

622
00:19:44,960 --> 00:19:47,120
for me going into this environment and

623
00:19:47,120 --> 00:19:48,559
starting to try and understand about

624
00:19:48,559 --> 00:19:50,320
what was happening

625
00:19:50,320 --> 00:19:53,679
is think about it you get a 10 000 piece

626
00:19:53,679 --> 00:19:55,840
jigsaw puzzle right

627
00:19:55,840 --> 00:19:59,200
but you only have 200 pieces remaining

628
00:19:59,200 --> 00:20:00,880
and you have to put those 200 pieces

629
00:20:00,880 --> 00:20:02,880
together and understand about what the

630
00:20:02,880 --> 00:20:05,679
entire picture was what that full jigsaw

631
00:20:05,679 --> 00:20:07,679
puzzle was that's what's like being in

632
00:20:07,679 --> 00:20:09,919
its responder when attackers basically

633
00:20:09,919 --> 00:20:11,600
are using ransomware

634
00:20:11,600 --> 00:20:12,799
to actually

635
00:20:12,799 --> 00:20:14,080
hide their tracks they use their

636
00:20:14,080 --> 00:20:16,799
ransomware as ways to actually corrupt

637
00:20:16,799 --> 00:20:19,039
the staging machines to actually corrupt

638
00:20:19,039 --> 00:20:20,960
the log files to clear the evidence they

639
00:20:20,960 --> 00:20:23,200
use ransomware to do that

640
00:20:23,200 --> 00:20:24,720
it's a very effective weapon for them to

641
00:20:24,720 --> 00:20:26,240
hide their tracks

642
00:20:26,240 --> 00:20:28,159
but fortunately enough they didn't hide

643
00:20:28,159 --> 00:20:29,440
them well enough

644
00:20:29,440 --> 00:20:31,600
so we were able to basically dissect and

645
00:20:31,600 --> 00:20:34,000
find the attack path that they use so

646
00:20:34,000 --> 00:20:35,200
one of the first things we're able to

647
00:20:35,200 --> 00:20:36,880
use for basically looking at the logs

648
00:20:36,880 --> 00:20:38,799
and evidence was remaining and sometimes

649
00:20:38,799 --> 00:20:40,960
you'll even look through for example

650
00:20:40,960 --> 00:20:43,440
when the event logs were cleared you'll

651
00:20:43,440 --> 00:20:45,520
be able to find a timestamp of those

652
00:20:45,520 --> 00:20:48,080
series of uh clearing of the event logs

653
00:20:48,080 --> 00:20:49,520
and try to find out which one was the

654
00:20:49,520 --> 00:20:51,280
first one to be done and try and

655
00:20:51,280 --> 00:20:53,360
navigate and try to create that attack

656
00:20:53,360 --> 00:20:55,039
path visibility so you actually

657
00:20:55,039 --> 00:20:56,640
understand about how they move they run

658
00:20:56,640 --> 00:20:58,320
the network but one of the first things

659
00:20:58,320 --> 00:20:59,600
we find of course we're all familiar

660
00:20:59,600 --> 00:21:01,200
with psec

661
00:21:01,200 --> 00:21:02,640
something i've been using pretty much my

662
00:21:02,640 --> 00:21:04,559
entire career from basically the windows

663
00:21:04,559 --> 00:21:06,400
internal tools it's a fantastic tool it

664
00:21:06,400 --> 00:21:07,840
helps us do our job it helps us do

665
00:21:07,840 --> 00:21:09,679
automation it's great for system

666
00:21:09,679 --> 00:21:11,280
administration

667
00:21:11,280 --> 00:21:13,280
but also not only is it going to be used

668
00:21:13,280 --> 00:21:14,799
for good purposes but also be used for

669
00:21:14,799 --> 00:21:16,400
malicious purposes

670
00:21:16,400 --> 00:21:18,400
in this case they'd use ps exact in

671
00:21:18,400 --> 00:21:19,919
order to actually run scripts and

672
00:21:19,919 --> 00:21:22,159
commands around the network this is how

673
00:21:22,159 --> 00:21:24,000
they were using as their automation the

674
00:21:24,000 --> 00:21:25,919
way to laterally move

675
00:21:25,919 --> 00:21:27,919
so ultimately after analyzing and

676
00:21:27,919 --> 00:21:29,600
looking all the machines where ps exact

677
00:21:29,600 --> 00:21:31,840
had been executed and run we're able to

678
00:21:31,840 --> 00:21:34,000
find it back to a few staging machines

679
00:21:34,000 --> 00:21:35,919
where those would be initiating from

680
00:21:35,919 --> 00:21:38,159
when we got to the staging machines

681
00:21:38,159 --> 00:21:40,080
we found out that they're actually using

682
00:21:40,080 --> 00:21:41,600
soft perfect

683
00:21:41,600 --> 00:21:43,679
network scanner in order to actually do

684
00:21:43,679 --> 00:21:45,679
and run the automation so that was

685
00:21:45,679 --> 00:21:47,360
scanning the network it was actually

686
00:21:47,360 --> 00:21:49,039
being able to pull back the inventory

687
00:21:49,039 --> 00:21:50,400
about what servers were doing what

688
00:21:50,400 --> 00:21:52,000
operating systems are running so we

689
00:21:52,000 --> 00:21:53,840
actually use this which of course can be

690
00:21:53,840 --> 00:21:55,679
used it's used legitimate software that

691
00:21:55,679 --> 00:21:57,760
we use for scanning the network but can

692
00:21:57,760 --> 00:22:00,720
also be used for malicious actors

693
00:22:00,720 --> 00:22:02,000
and actually just to give you an example

694
00:22:02,000 --> 00:22:04,400
here this is actually real screenshots

695
00:22:04,400 --> 00:22:05,280
of

696
00:22:05,280 --> 00:22:07,600
the actually techn

697
00:22:07,600 --> 00:22:09,600
the scripts and what they've actually

698
00:22:09,600 --> 00:22:10,480
done

699
00:22:10,480 --> 00:22:12,240
i've actually modified it to make it

700
00:22:12,240 --> 00:22:14,000
anonymous so that it doesn't reveal any

701
00:22:14,000 --> 00:22:15,600
details about the victim

702
00:22:15,600 --> 00:22:18,159
um but also just to note that all of

703
00:22:18,159 --> 00:22:20,400
these commands that was actually in the

704
00:22:20,400 --> 00:22:22,720
application part of the software was

705
00:22:22,720 --> 00:22:24,559
actually in russian language i actually

706
00:22:24,559 --> 00:22:26,320
had my kids translated for me

707
00:22:26,320 --> 00:22:28,240
fortunately i've got kids who speak and

708
00:22:28,240 --> 00:22:30,480
uh read russian so they help me go

709
00:22:30,480 --> 00:22:31,919
through and actually translate a lot of

710
00:22:31,919 --> 00:22:33,280
the scripts so it's great if you have

711
00:22:33,280 --> 00:22:34,720
kids who speak russian they actually

712
00:22:34,720 --> 00:22:37,200
help me with my job quite often

713
00:22:37,200 --> 00:22:38,720
my language skills are not my greatest

714
00:22:38,720 --> 00:22:40,880
part of my area but

715
00:22:40,880 --> 00:22:42,559
i went through and translated these from

716
00:22:42,559 --> 00:22:44,000
russian to english which meant that we

717
00:22:44,000 --> 00:22:45,440
knew that we were dealing with russian

718
00:22:45,440 --> 00:22:47,840
speaking a russian origin

719
00:22:47,840 --> 00:22:49,200
of the attackers

720
00:22:49,200 --> 00:22:51,120
the ip addresses that we're able to find

721
00:22:51,120 --> 00:22:53,760
basically from the domain the dns and

722
00:22:53,760 --> 00:22:56,000
other areas did show that attackers

723
00:22:56,000 --> 00:22:58,640
actually use servers in uk

724
00:22:58,640 --> 00:23:01,440
uh they use servers in holland and also

725
00:23:01,440 --> 00:23:03,200
ukraine so that was some of the

726
00:23:03,200 --> 00:23:05,039
countries where we saw affiliations and

727
00:23:05,039 --> 00:23:06,720
sources off basically being used of

728
00:23:06,720 --> 00:23:08,480
course is proxies

729
00:23:08,480 --> 00:23:11,440
known basically malicious ip ranges

730
00:23:11,440 --> 00:23:12,640
so basically what they've done was

731
00:23:12,640 --> 00:23:14,000
automation

732
00:23:14,000 --> 00:23:15,280
this translates back to a lot of the

733
00:23:15,280 --> 00:23:17,200
scripts that they'd use and then also

734
00:23:17,200 --> 00:23:19,280
they'd actually created their own

735
00:23:19,280 --> 00:23:21,360
local administrators on those staging

736
00:23:21,360 --> 00:23:23,280
machines in case they needed to create

737
00:23:23,280 --> 00:23:25,039
backdoors and be able to return if the

738
00:23:25,039 --> 00:23:27,200
user ever changed their credentials

739
00:23:27,200 --> 00:23:28,720
so this was indication that they'd use

740
00:23:28,720 --> 00:23:30,880
these on the staging machines in order

741
00:23:30,880 --> 00:23:33,760
to be the way also deploy

742
00:23:33,760 --> 00:23:36,320
the the ransomware itself the next area

743
00:23:36,320 --> 00:23:37,919
of course we find on those staging

744
00:23:37,919 --> 00:23:40,400
machines was that use mimikats that

745
00:23:40,400 --> 00:23:42,000
actually use mimikats in order to go

746
00:23:42,000 --> 00:23:44,000
from local administrator rights up to

747
00:23:44,000 --> 00:23:46,320
domain if you have users here local

748
00:23:46,320 --> 00:23:47,919
administrator rights it's literally two

749
00:23:47,919 --> 00:23:51,520
steps to go from local to domain don't i

750
00:23:51,520 --> 00:23:53,200
hate we put local in front of it because

751
00:23:53,200 --> 00:23:54,720
it makes us assume that it's limited to

752
00:23:54,720 --> 00:23:56,640
only the local machine but it gives the

753
00:23:56,640 --> 00:23:58,799
attackers a way to elevate

754
00:23:58,799 --> 00:23:59,840
in this case they were using

755
00:23:59,840 --> 00:24:02,480
unfortunately windows server 2012

756
00:24:02,480 --> 00:24:05,120
and uh it was basically one of the the

757
00:24:05,120 --> 00:24:08,080
sp2 versions which meant that the

758
00:24:08,080 --> 00:24:10,000
registry key here basically had been

759
00:24:10,000 --> 00:24:11,760
changed so default credentials or

760
00:24:11,760 --> 00:24:13,039
credentials would not be stored in clear

761
00:24:13,039 --> 00:24:15,279
text and memory

762
00:24:15,279 --> 00:24:17,279
but simply by changing this registry key

763
00:24:17,279 --> 00:24:18,880
back on later versions of servers will

764
00:24:18,880 --> 00:24:20,559
allow you to actually re-enable that so

765
00:24:20,559 --> 00:24:22,400
running mimikats will allow you to

766
00:24:22,400 --> 00:24:24,559
extract any types of credentials in

767
00:24:24,559 --> 00:24:26,480
clear text now one of the things that

768
00:24:26,480 --> 00:24:28,240
they had done of course was they went

769
00:24:28,240 --> 00:24:29,360
into the machine they changed their

770
00:24:29,360 --> 00:24:30,960
credentials

771
00:24:30,960 --> 00:24:32,960
cause some problems in that machine

772
00:24:32,960 --> 00:24:33,919
leave

773
00:24:33,919 --> 00:24:35,760
clear up their tracks at the same time

774
00:24:35,760 --> 00:24:37,679
and wait for an administrator to log in

775
00:24:37,679 --> 00:24:40,559
to fix the problem

776
00:24:40,960 --> 00:24:42,480
an administrator is going to log in with

777
00:24:42,480 --> 00:24:44,720
what domain credentials helpdesk worker

778
00:24:44,720 --> 00:24:46,240
is going to log in with what the main

779
00:24:46,240 --> 00:24:47,919
credentials to fix problems because it

780
00:24:47,919 --> 00:24:49,679
gives them the ability to do things ad

781
00:24:49,679 --> 00:24:51,679
hoc when they need to

782
00:24:51,679 --> 00:24:53,120
and that's one of the ways they're able

783
00:24:53,120 --> 00:24:55,279
to extract the domain administrator so

784
00:24:55,279 --> 00:24:57,360
this is how they got to the domain admin

785
00:24:57,360 --> 00:24:59,120
the next thing we actually look for was

786
00:24:59,120 --> 00:25:00,559
persistence and back doors we want to

787
00:25:00,559 --> 00:25:01,919
make sure that we understand about how

788
00:25:01,919 --> 00:25:05,039
did they maintain their access

789
00:25:05,039 --> 00:25:05,919
and

790
00:25:05,919 --> 00:25:08,080
this has been around for a long time

791
00:25:08,080 --> 00:25:10,000
we've been using sticky key methods

792
00:25:10,000 --> 00:25:12,240
since around windows xp in the early

793
00:25:12,240 --> 00:25:15,120
days that actually use sticky keys in

794
00:25:15,120 --> 00:25:16,400
order to create back doors and

795
00:25:16,400 --> 00:25:18,960
persistence on those staging machines

796
00:25:18,960 --> 00:25:20,240
so if you're familiar with sticky keys

797
00:25:20,240 --> 00:25:21,440
what it allows you to do is simply throw

798
00:25:21,440 --> 00:25:23,520
a registry change anything in the log on

799
00:25:23,520 --> 00:25:25,440
screen when you're on the log on screen

800
00:25:25,440 --> 00:25:27,360
you've got utility helper you've got

801
00:25:27,360 --> 00:25:29,120
sticky keys which you basically hit the

802
00:25:29,120 --> 00:25:31,440
shift button five times and it produces

803
00:25:31,440 --> 00:25:33,440
sticky keys if you hit the shift button

804
00:25:33,440 --> 00:25:35,520
five times on these staging machines it

805
00:25:35,520 --> 00:25:37,520
will actually pop up a command prompt

806
00:25:37,520 --> 00:25:38,960
that was running under anti-authority

807
00:25:38,960 --> 00:25:40,799
system and therefore the attackers could

808
00:25:40,799 --> 00:25:44,240
then enable create users open up rdp and

809
00:25:44,240 --> 00:25:46,400
create persistent access so it's really

810
00:25:46,400 --> 00:25:47,679
important they were not looking for

811
00:25:47,679 --> 00:25:49,520
these you need to be actively looking

812
00:25:49,520 --> 00:25:51,520
for those registry changes you need to

813
00:25:51,520 --> 00:25:53,120
be threat hunting you need to be going

814
00:25:53,120 --> 00:25:54,799
and searching do any of my machines have

815
00:25:54,799 --> 00:25:57,440
this registries key settings

816
00:25:57,440 --> 00:25:59,360
do they actually have the minicats

817
00:25:59,360 --> 00:26:01,200
registry key setting that allows them to

818
00:26:01,200 --> 00:26:03,120
actually extracting clear text looking

819
00:26:03,120 --> 00:26:04,000
for these

820
00:26:04,000 --> 00:26:05,840
correctively

821
00:26:05,840 --> 00:26:07,200
unfortunately one of the reasons why

822
00:26:07,200 --> 00:26:08,720
they were able to run all of these was

823
00:26:08,720 --> 00:26:10,799
the compromise user credential that the

824
00:26:10,799 --> 00:26:12,640
attackers again accessed was a local

825
00:26:12,640 --> 00:26:14,240
administrator

826
00:26:14,240 --> 00:26:16,240
so the initial user that they gain

827
00:26:16,240 --> 00:26:17,440
access

828
00:26:17,440 --> 00:26:19,120
being a local administrator meant that

829
00:26:19,120 --> 00:26:20,559
they were actually able to

830
00:26:20,559 --> 00:26:22,400
turn off security

831
00:26:22,400 --> 00:26:25,039
their sessions were approximately

832
00:26:25,039 --> 00:26:27,679
10 to 20 minutes long no longer they

833
00:26:27,679 --> 00:26:29,840
would disable security

834
00:26:29,840 --> 00:26:30,720
do their

835
00:26:30,720 --> 00:26:33,200
enumeration make the changes

836
00:26:33,200 --> 00:26:37,120
and then re-enable security and leave

837
00:26:37,440 --> 00:26:40,240
so in the actual endpoint detection in

838
00:26:40,240 --> 00:26:42,240
an av it just looked at this machine

839
00:26:42,240 --> 00:26:45,440
dropped offline for a couple of minutes

840
00:26:45,440 --> 00:26:46,960
actually the machine looks normal

841
00:26:46,960 --> 00:26:48,320
security's turned on it's enabled it's

842
00:26:48,320 --> 00:26:50,640
doing its job

843
00:26:50,640 --> 00:26:52,000
you want to be looking for those periods

844
00:26:52,000 --> 00:26:53,440
of times it drops

845
00:26:53,440 --> 00:26:54,480
you want to be looking for those you

846
00:26:54,480 --> 00:26:56,720
know 10 to 20 minute sessions

847
00:26:56,720 --> 00:26:57,840
because those are the times that the

848
00:26:57,840 --> 00:26:59,039
attackers are doing the malicious

849
00:26:59,039 --> 00:27:00,799
activity

850
00:27:00,799 --> 00:27:02,880
so never give users look of ministerial

851
00:27:02,880 --> 00:27:04,799
rights it literally gives the attackers

852
00:27:04,799 --> 00:27:07,039
a way to hide their tracks and elevate

853
00:27:07,039 --> 00:27:09,120
privileges to domain very easily

854
00:27:09,120 --> 00:27:11,039
of course this all started

855
00:27:11,039 --> 00:27:12,159
with what

856
00:27:12,159 --> 00:27:15,679
a public-facing rdp server

857
00:27:15,679 --> 00:27:17,919
yes the company did have terminal

858
00:27:17,919 --> 00:27:20,159
services multi-factor authentication but

859
00:27:20,159 --> 00:27:21,679
during the pandemic

860
00:27:21,679 --> 00:27:23,440
a third-party accountant needed to have

861
00:27:23,440 --> 00:27:25,520
access to the accounting system

862
00:27:25,520 --> 00:27:27,679
so they decided that let's do it quickly

863
00:27:27,679 --> 00:27:29,360
so they enabled the particular machine

864
00:27:29,360 --> 00:27:30,799
in order to give the accountant access

865
00:27:30,799 --> 00:27:33,200
to the environment

866
00:27:33,200 --> 00:27:36,080
outside the visibility of the i.t team

867
00:27:36,080 --> 00:27:39,360
it was done within the department

868
00:27:40,640 --> 00:27:44,000
of one machine it only takes one machine

869
00:27:44,000 --> 00:27:46,080
that failure to secure it will give the

870
00:27:46,080 --> 00:27:47,600
attackers that access

871
00:27:47,600 --> 00:27:49,200
and of course going back prior to the

872
00:27:49,200 --> 00:27:50,640
seven months before

873
00:27:50,640 --> 00:27:52,480
the attack happened it was all done

874
00:27:52,480 --> 00:27:54,799
through brute force

875
00:27:54,799 --> 00:27:56,480
by bringing that system up putting it

876
00:27:56,480 --> 00:27:58,320
public facing will give the attackers

877
00:27:58,320 --> 00:28:00,880
enough time in order to gain access so

878
00:28:00,880 --> 00:28:02,480
again those who specialize in getting

879
00:28:02,480 --> 00:28:03,760
the access

880
00:28:03,760 --> 00:28:06,480
selling it to the affiliates and then

881
00:28:06,480 --> 00:28:08,000
buying cryptos in order to actually

882
00:28:08,000 --> 00:28:09,200
deploy it

883
00:28:09,200 --> 00:28:10,559
bringing this organization to complete

884
00:28:10,559 --> 00:28:11,600
stop

885
00:28:11,600 --> 00:28:13,120
so what things can we do to reduce the

886
00:28:13,120 --> 00:28:14,960
risks and i'm going to repeat a lot of

887
00:28:14,960 --> 00:28:16,720
what my peers had said throughout the

888
00:28:16,720 --> 00:28:17,679
day

889
00:28:17,679 --> 00:28:19,039
is that it's really getting back to

890
00:28:19,039 --> 00:28:20,640
basics and one thing that eugene

891
00:28:20,640 --> 00:28:22,159
mentioned earlier he talked about

892
00:28:22,159 --> 00:28:24,159
security by design i think we need to go

893
00:28:24,159 --> 00:28:26,240
a bit further we need to go to security

894
00:28:26,240 --> 00:28:27,760
by default

895
00:28:27,760 --> 00:28:29,679
security should be by default not just

896
00:28:29,679 --> 00:28:33,520
by design but on and used and basically

897
00:28:33,520 --> 00:28:36,879
we're using it effectively

898
00:28:37,279 --> 00:28:38,480
so it's really important we get to that

899
00:28:38,480 --> 00:28:40,880
stage but having good education in cyber

900
00:28:40,880 --> 00:28:42,880
hygiene

901
00:28:42,880 --> 00:28:44,960
whenever your employees should never be

902
00:28:44,960 --> 00:28:48,320
afraid to ask for advice

903
00:28:48,480 --> 00:28:49,840
that's one of the best ways if your

904
00:28:49,840 --> 00:28:52,480
employees do something or accidentally

905
00:28:52,480 --> 00:28:54,399
clicking something and they suspect that

906
00:28:54,399 --> 00:28:55,360
they shouldn't done it they should not

907
00:28:55,360 --> 00:28:57,760
be afraid it shouldn't be feeling that i

908
00:28:57,760 --> 00:28:59,360
shouldn't tell anyone otherwise i might

909
00:28:59,360 --> 00:29:01,039
be victimized we should empower

910
00:29:01,039 --> 00:29:03,760
employees to talk and basically reach

911
00:29:03,760 --> 00:29:07,200
out and be proactive to communicate

912
00:29:07,200 --> 00:29:09,360
having a backup and test plan and

913
00:29:09,360 --> 00:29:12,240
recovery but actually one that's

914
00:29:12,240 --> 00:29:14,799
basically focused around ransomware as

915
00:29:14,799 --> 00:29:17,919
well not just having online uh servers

916
00:29:17,919 --> 00:29:20,320
having segments segregation getting into

917
00:29:20,320 --> 00:29:22,080
zero trusted principal least privilege

918
00:29:22,080 --> 00:29:23,600
your administrator should not be freely

919
00:29:23,600 --> 00:29:25,440
just logging into systems as domain

920
00:29:25,440 --> 00:29:27,440
administrators and those credentials

921
00:29:27,440 --> 00:29:30,640
should be rotated after every single use

922
00:29:30,640 --> 00:29:32,640
if they had rotated those credentials

923
00:29:32,640 --> 00:29:34,000
the attacker would not have been able to

924
00:29:34,000 --> 00:29:35,440
leverage those credentials of those

925
00:29:35,440 --> 00:29:37,440
hashes to laterally move and reuse it in

926
00:29:37,440 --> 00:29:39,200
ps exec

927
00:29:39,200 --> 00:29:40,880
privilege access security so they can

928
00:29:40,880 --> 00:29:42,559
actually have something they check out

929
00:29:42,559 --> 00:29:44,399
and log in the system securely and

930
00:29:44,399 --> 00:29:46,399
rotate the credentials for them

931
00:29:46,399 --> 00:29:48,559
application control that can detect for

932
00:29:48,559 --> 00:29:51,360
example one ps exec is actually

933
00:29:51,360 --> 00:29:53,200
executing out of time

934
00:29:53,200 --> 00:29:55,600
sunday night is it normal and make sure

935
00:29:55,600 --> 00:29:57,840
you patch an update so that point in

936
00:29:57,840 --> 00:29:58,640
time

937
00:29:58,640 --> 00:30:00,880
we're here it's all about reducing risk

938
00:30:00,880 --> 00:30:02,080
it's all about

939
00:30:02,080 --> 00:30:03,919
forcing the attackers

940
00:30:03,919 --> 00:30:05,200
to create

941
00:30:05,200 --> 00:30:07,200
more risk to make their job more

942
00:30:07,200 --> 00:30:09,760
difficult the more risks that they take

943
00:30:09,760 --> 00:30:11,039
the more noise they will create in your

944
00:30:11,039 --> 00:30:12,960
networks giving you visibility to

945
00:30:12,960 --> 00:30:14,320
actually detect them

946
00:30:14,320 --> 00:30:16,159
and stop them

947
00:30:16,159 --> 00:30:17,520
ultimately

948
00:30:17,520 --> 00:30:19,600
we're here the more you know about the

949
00:30:19,600 --> 00:30:21,039
techniques that they use

950
00:30:21,039 --> 00:30:23,360
and other victims lessons learned

951
00:30:23,360 --> 00:30:24,640
the more we can do to make it more

952
00:30:24,640 --> 00:30:26,559
difficult for them but ultimately we

953
00:30:26,559 --> 00:30:28,000
have to translate that into business

954
00:30:28,000 --> 00:30:30,559
goals and business value

955
00:30:30,559 --> 00:30:32,000
to get the budget we need to do the

956
00:30:32,000 --> 00:30:34,960
things in order to actually help

957
00:30:34,960 --> 00:30:36,960
and be safer

958
00:30:36,960 --> 00:30:38,559
so that wraps it up

959
00:30:38,559 --> 00:30:40,000
i'm here before lunch i don't know i've

960
00:30:40,000 --> 00:30:41,760
got time for questions no time for

961
00:30:41,760 --> 00:30:43,679
questions so if you want to talk to me

962
00:30:43,679 --> 00:30:45,600
i'm here for the rest of the day i'll be

963
00:30:45,600 --> 00:30:48,480
outside we do have a booth at the back

964
00:30:48,480 --> 00:30:50,000
i hope this was valuable hope it was

965
00:30:50,000 --> 00:30:52,159
educational stay safe

966
00:30:52,159 --> 00:30:53,919
enjoy the lunch and enjoy the rest of

967
00:30:53,919 --> 00:30:57,480
conference thank you

