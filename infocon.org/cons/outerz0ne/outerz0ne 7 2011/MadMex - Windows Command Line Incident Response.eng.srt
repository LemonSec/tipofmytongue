1
00:00:06,080 --> 00:00:17,509
good morning my name is Carlo I have a

2
00:00:14,790 --> 00:00:19,859
last name but i can't pronounce it<font color="#CCCCCC"> i</font>

3
00:00:17,510 --> 00:00:23,310
have free stickers later if anybody

4
00:00:19,859 --> 00:00:25,080
wants to take a stab at it today<font color="#E5E5E5"> i'm</font>

5
00:00:23,310 --> 00:00:27,150
<font color="#E5E5E5">talking about</font><font color="#CCCCCC"> windows incident response</font>

6
00:00:25,080 --> 00:00:30,150
via the command line I<font color="#E5E5E5"> thought it was</font>

7
00:00:27,150 --> 00:00:31,769
<font color="#E5E5E5">very apt that sky dog was talking this</font>

8
00:00:30,150 --> 00:00:34,100
morning about how everybody was<font color="#CCCCCC"> very</font>

9
00:00:31,769 --> 00:00:36,780
much afraid of<font color="#CCCCCC"> doing anything in the</font>

10
00:00:34,100 --> 00:00:41,190
<font color="#CCCCCC">mysterious black box that is the windows</font>

11
00:00:36,780 --> 00:00:45,870
dos command prompt figured it would be a

12
00:00:41,190 --> 00:00:49,260
pretty<font color="#E5E5E5"> good topic and so we'll go from</font>

13
00:00:45,870 --> 00:00:51,839
there before I get started I do want to

14
00:00:49,260 --> 00:00:53,579
get<font color="#E5E5E5"> on my soapbox for two minutes I want</font>

15
00:00:51,840 --> 00:00:54,660
<font color="#E5E5E5">to say that I I think it's really cool</font>

16
00:00:53,579 --> 00:00:56,129
that I get to come<font color="#E5E5E5"> up</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> and do</font>

17
00:00:54,660 --> 00:00:59,038
presentations this is actually my<font color="#CCCCCC"> first</font>

18
00:00:56,129 --> 00:01:02,579
presentation ever I've never done a talk

19
00:00:59,039 --> 00:01:05,070
before I<font color="#E5E5E5"> I hope this will go well and</font>

20
00:01:02,579 --> 00:01:10,950
well if it doesn't else will be a second

21
00:01:05,069 --> 00:01:14,850
one<font color="#E5E5E5"> so that's</font><font color="#CCCCCC"> okay good</font><font color="#E5E5E5"> you know no that</font>

22
00:01:10,950 --> 00:01:17,280
doesn't work so well but you know it<font color="#E5E5E5"> was</font>

23
00:01:14,850 --> 00:01:19,470
only two years ago I started going to

24
00:01:17,280 --> 00:01:22,470
conferences and a lot of the guys<font color="#CCCCCC"> that</font>

25
00:01:19,470 --> 00:01:25,170
I'd see speak were people like iron geek

26
00:01:22,470 --> 00:01:27,000
in the<font color="#CCCCCC"> back guys that I'd known through</font>

27
00:01:25,170 --> 00:01:30,439
their<font color="#CCCCCC"> websites and their videos and</font>

28
00:01:27,000 --> 00:01:32,610
other guys through their books and<font color="#E5E5E5"> I</font>

29
00:01:30,439 --> 00:01:34,559
felt like you know<font color="#E5E5E5"> living in my little</font>

30
00:01:32,610 --> 00:01:36,780
infosec bubble that you know there was

31
00:01:34,560 --> 00:01:39,990
us mere mortals that you know showed up

32
00:01:36,780 --> 00:01:42,450
to work around eleven-thirty and you

33
00:01:39,990 --> 00:01:44,250
know worked and and went home and you

34
00:01:42,450 --> 00:01:45,810
know got online and read the stuff that

35
00:01:44,250 --> 00:01:47,820
<font color="#E5E5E5">these people wrote and that you know</font>

36
00:01:45,810 --> 00:01:50,280
they were like these these gods on Mount

37
00:01:47,820 --> 00:01:52,559
Olympus and you know we were these lowly

38
00:01:50,280 --> 00:01:55,500
humans and that you know never<font color="#E5E5E5"> the twain</font>

39
00:01:52,560 --> 00:01:57,920
shall meet going to conferences i found

40
00:01:55,500 --> 00:02:00,119
out i learned a couple<font color="#E5E5E5"> things actually</font>

41
00:01:57,920 --> 00:02:03,600
should be too surprising to some of you

42
00:02:00,119 --> 00:02:04,860
is that one they're normal people the

43
00:02:03,600 --> 00:02:06,570
guys that<font color="#CCCCCC"> you know come up and do the</font>

44
00:02:04,860 --> 00:02:11,580
conferences and do the talks and write

45
00:02:06,570 --> 00:02:13,290
the books in normal ish a very flexible

46
00:02:11,580 --> 00:02:17,459
value for

47
00:02:13,290 --> 00:02:22,439
variable normal the smarter the guys are

48
00:02:17,459 --> 00:02:24,450
the more approachable they are nuts from

49
00:02:22,439 --> 00:02:26,459
back track is a great example one<font color="#E5E5E5"> of the</font>

50
00:02:24,450 --> 00:02:28,589
coolest guys most laid-back that you'll

51
00:02:26,459 --> 00:02:31,530
ever meet and you know you<font color="#E5E5E5"> think you</font>

52
00:02:28,590 --> 00:02:34,340
<font color="#CCCCCC">know oh my god</font><font color="#E5E5E5"> it's mutts he's just it's</font>

53
00:02:31,530 --> 00:02:38,459
<font color="#E5E5E5">just a regular guy he'll tell you that</font>

54
00:02:34,340 --> 00:02:40,859
there there's a<font color="#E5E5E5"> lot less degrees of</font>

55
00:02:38,459 --> 00:02:42,840
separation in the information security

56
00:02:40,859 --> 00:02:45,090
community that I<font color="#E5E5E5"> first thought you</font>

57
00:02:42,840 --> 00:02:48,750
probably<font color="#E5E5E5"> know more than three degrees</font>

58
00:02:45,090 --> 00:02:52,379
away from anybody<font color="#E5E5E5"> whose books you own or</font>

59
00:02:48,750 --> 00:02:55,769
whose videos you watch so you know take

60
00:02:52,379 --> 00:02:58,409
that to heart it really are a small

61
00:02:55,769 --> 00:03:00,569
bunch in all industries I mean we're not

62
00:02:58,409 --> 00:03:02,129
like doctors there's you<font color="#CCCCCC"> know thousands</font>

63
00:03:00,569 --> 00:03:03,988
<font color="#E5E5E5">of them in</font><font color="#CCCCCC"> every city</font><font color="#E5E5E5"> information</font>

64
00:03:02,129 --> 00:03:07,888
technology guys there might be two

65
00:03:03,989 --> 00:03:14,959
hundred so you know it's a<font color="#CCCCCC"> it's a cool</font>

66
00:03:07,889 --> 00:03:18,109
thing so well go ahead<font color="#E5E5E5"> and get started</font>

67
00:03:14,959 --> 00:03:18,109
thank you

68
00:03:18,860 --> 00:03:23,310
<font color="#E5E5E5">alright so anytime I you know get tasked</font>

69
00:03:21,510 --> 00:03:25,530
with writing a paper or doing any kind

70
00:03:23,310 --> 00:03:27,750
of research you know usually<font color="#E5E5E5"> they give</font>

71
00:03:25,530 --> 00:03:28,770
me some<font color="#E5E5E5"> really boring title so try to</font>

72
00:03:27,750 --> 00:03:29,760
give it something a little more fun

73
00:03:28,770 --> 00:03:31,680
something<font color="#E5E5E5"> that's going to keep me</font>

74
00:03:29,760 --> 00:03:33,929
interested because it like skydog

75
00:03:31,680 --> 00:03:36,450
sometimes<font color="#CCCCCC"> I do have the tendency to have</font>

76
00:03:33,930 --> 00:03:37,920
the attention span of a gnat and you

77
00:03:36,450 --> 00:03:38,910
know I see<font color="#E5E5E5"> something shiny or pretty and</font>

78
00:03:37,920 --> 00:03:41,760
I<font color="#E5E5E5"> just kind of go off in another</font>

79
00:03:38,910 --> 00:03:43,950
direction so my original title for this

80
00:03:41,760 --> 00:03:45,630
project was turtle taming or how i

81
00:03:43,950 --> 00:03:48,750
learned to stop worrying and love the

82
00:03:45,630 --> 00:03:50,460
shell like I<font color="#E5E5E5"> said the command line seems</font>

83
00:03:48,750 --> 00:03:52,260
to be this big mysterious<font color="#CCCCCC"> box as you</font>

84
00:03:50,460 --> 00:03:53,280
know people don't want<font color="#E5E5E5"> to touch it or</font>

85
00:03:52,260 --> 00:03:55,200
you show it<font color="#CCCCCC"> to them they're like nah</font>

86
00:03:53,280 --> 00:03:57,240
dude<font color="#E5E5E5"> I I'm just gonna go and grab the</font>

87
00:03:55,200 --> 00:04:00,359
mouse because<font color="#CCCCCC"> I feel like</font><font color="#E5E5E5"> if i do</font>

88
00:03:57,240 --> 00:04:01,890
something in there<font color="#CCCCCC"> its permanent</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> i'm</font>

89
00:04:00,360 --> 00:04:03,630
<font color="#E5E5E5">probably gonna break something that's</font>

90
00:04:01,890 --> 00:04:05,820
like well you know<font color="#E5E5E5"> it's okay</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know</font>

91
00:04:03,630 --> 00:04:07,859
you<font color="#CCCCCC"> don't have</font><font color="#E5E5E5"> to be scared of it you</font>

92
00:04:05,820 --> 00:04:09,299
<font color="#E5E5E5">know most people if they do use</font><font color="#CCCCCC"> it the</font>

93
00:04:07,860 --> 00:04:12,090
only<font color="#E5E5E5"> thing they</font><font color="#CCCCCC"> think it's for is for</font>

94
00:04:09,300 --> 00:04:13,709
ipconfig all right it's like<font color="#CCCCCC"> Oh up tell</font>

95
00:04:12,090 --> 00:04:17,010
me find out what Maya p address is I'm a

96
00:04:13,709 --> 00:04:21,690
hacker look at me nuts you know it's a

97
00:04:17,010 --> 00:04:23,610
start bless your heart this is Terry the

98
00:04:21,690 --> 00:04:25,410
turtle Tamara for any of you guys who

99
00:04:23,610 --> 00:04:28,200
don't know she's actually from an online

100
00:04:25,410 --> 00:04:31,669
turn-based game from it's called kingdom

101
00:04:28,200 --> 00:04:34,289
of loathing it's<font color="#E5E5E5"> a fantastic</font>

102
00:04:31,669 --> 00:04:36,900
intellectual game where they<font color="#CCCCCC"> basically</font>

103
00:04:34,290 --> 00:04:41,760
make fun of themselves and everything

104
00:04:36,900 --> 00:04:43,830
else in popular<font color="#E5E5E5"> culture and it's all the</font>

105
00:04:41,760 --> 00:04:46,050
<font color="#CCCCCC">ark is you know line</font><font color="#E5E5E5"> stick figure kind</font>

106
00:04:43,830 --> 00:04:48,690
of art and anybody who's ever played D&D

107
00:04:46,050 --> 00:04:51,540
or you know any<font color="#CCCCCC"> kind of role-playing</font>

108
00:04:48,690 --> 00:04:53,880
game check it out asymmetric

109
00:04:51,540 --> 00:04:59,610
publications it's the really funny cool

110
00:04:53,880 --> 00:05:00,990
group of guys<font color="#CCCCCC"> alright so why why would I</font>

111
00:04:59,610 --> 00:05:03,300
want to do incident response to your the

112
00:05:00,990 --> 00:05:04,919
command line I have a mouse you know I'm

113
00:05:03,300 --> 00:05:07,350
comfortable it's got two buttons some of

114
00:05:04,919 --> 00:05:11,909
them have the little clicky wheel and

115
00:05:07,350 --> 00:05:14,910
I'm good<font color="#CCCCCC"> with that well alright right</font>

116
00:05:11,910 --> 00:05:17,199
and we paid 4n cakes

117
00:05:14,910 --> 00:05:21,340
so<font color="#E5E5E5"> I</font><font color="#CCCCCC"> think there's too much dependency</font>

118
00:05:17,199 --> 00:05:23,229
on on graphical tools you know the

119
00:05:21,340 --> 00:05:24,818
command line I think and I do call them

120
00:05:23,229 --> 00:05:26,050
incantations because a lot of times you

121
00:05:24,819 --> 00:05:28,419
<font color="#E5E5E5">know show somebody something and they'll</font>

122
00:05:26,050 --> 00:05:29,889
say you know there's a colon slash and

123
00:05:28,419 --> 00:05:32,039
you might as well<font color="#E5E5E5"> have the oh with the</font>

124
00:05:29,889 --> 00:05:34,660
slash and the oom lot you know and<font color="#CCCCCC"> the</font>

125
00:05:32,039 --> 00:05:37,568
backwards and like<font color="#E5E5E5"> people just you know</font>

126
00:05:34,660 --> 00:05:40,750
kind of back away slowly remote shells

127
00:05:37,569 --> 00:05:42,310
are cool most people<font color="#E5E5E5"> that have been</font>

128
00:05:40,750 --> 00:05:44,080
<font color="#E5E5E5">blessed enough to grow</font><font color="#CCCCCC"> up with a unix</font>

129
00:05:42,310 --> 00:05:46,210
environment at their fingertips and a

130
00:05:44,080 --> 00:05:47,740
<font color="#E5E5E5">really</font><font color="#CCCCCC"> good mentor will tell you that</font>

131
00:05:46,210 --> 00:05:50,650
there's very<font color="#CCCCCC"> few things</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> you can't</font>

132
00:05:47,740 --> 00:05:52,599
accomplish using the command line you

133
00:05:50,650 --> 00:05:54,130
know that sticker you know you could be

134
00:05:52,599 --> 00:06:00,520
replaced by a<font color="#E5E5E5"> properly coded shell</font>

135
00:05:54,130 --> 00:06:03,580
script yeah<font color="#CCCCCC"> I live by that you</font><font color="#E5E5E5"> know hmm</font>

136
00:06:00,520 --> 00:06:05,049
<font color="#CCCCCC">all right so who is this guy you know</font>

137
00:06:03,580 --> 00:06:06,550
besides the guys runs around looking

138
00:06:05,050 --> 00:06:08,970
like he's only had four hours of<font color="#CCCCCC"> sleep</font>

139
00:06:06,550 --> 00:06:16,060
in<font color="#E5E5E5"> the past 48 hours because he has</font>

140
00:06:08,970 --> 00:06:19,240
Thank You<font color="#E5E5E5"> sky dog yeah welcome yeah</font>

141
00:06:16,060 --> 00:06:22,720
<font color="#CCCCCC">Carlo one Carlo to is in the</font><font color="#E5E5E5"> audience</font>

142
00:06:19,240 --> 00:06:24,580
yeah that's right so I've been doing

143
00:06:22,720 --> 00:06:27,430
incident response for a little bit over

144
00:06:24,580 --> 00:06:29,440
<font color="#E5E5E5">five years I'm 24 by 7 security</font>

145
00:06:27,430 --> 00:06:31,719
operations center for a variety of

146
00:06:29,440 --> 00:06:33,250
government clients I'm not allowed to

147
00:06:31,719 --> 00:06:35,199
list them because if I did I would<font color="#CCCCCC"> have</font>

148
00:06:33,250 --> 00:06:37,539
to submit<font color="#E5E5E5"> my talk to their PR department</font>

149
00:06:35,199 --> 00:06:39,370
for each<font color="#E5E5E5"> and</font><font color="#CCCCCC"> every one and that would</font>

150
00:06:37,539 --> 00:06:41,889
take a while if you're really interested

151
00:06:39,370 --> 00:06:44,020
I'm talk to me later if you're impressed

152
00:06:41,889 --> 00:06:47,490
with letters I have a whole<font color="#E5E5E5"> bunch after</font>

153
00:06:44,020 --> 00:06:47,490
my name some are real

154
00:06:49,200 --> 00:06:55,780
yeah yeah<font color="#CCCCCC"> that's cdre guy it's</font><font color="#E5E5E5"> like who</font>

155
00:06:52,570 --> 00:06:57,460
is that guy yeah don't you yeah and<font color="#E5E5E5"> the</font>

156
00:06:55,780 --> 00:07:01,690
Apple technician I've actually had that

157
00:06:57,460 --> 00:07:10,479
since 1997 so if you have like a mac

158
00:07:01,690 --> 00:07:13,150
classic I can help<font color="#E5E5E5"> you awesome yeah</font>

159
00:07:10,480 --> 00:07:14,830
that's true but I'm also running the

160
00:07:13,150 --> 00:07:16,210
makers corner i'm not entirely sure what

161
00:07:14,830 --> 00:07:19,390
I'm going to start that probably after

162
00:07:16,210 --> 00:07:22,719
this talk so come make an LED throwing I

163
00:07:19,390 --> 00:07:24,880
have batteries and leds for everybody we

164
00:07:22,720 --> 00:07:27,580
have all toys tins and you know just

165
00:07:24,880 --> 00:07:28,870
<font color="#CCCCCC">kind of kind of just play with it but I</font>

166
00:07:27,580 --> 00:07:30,909
wanted everybody to at least have the

167
00:07:28,870 --> 00:07:31,930
opportunity a lot of guys you know we

168
00:07:30,910 --> 00:07:34,030
spent our lives in front<font color="#E5E5E5"> of the computer</font>

169
00:07:31,930 --> 00:07:36,430
and we admire the guys to do hardware

170
00:07:34,030 --> 00:07:37,419
hacking and stuff and I thought well

171
00:07:36,430 --> 00:07:40,900
what's the simplest thing I could come

172
00:07:37,420 --> 00:07:42,940
up with that's uh you know everybody can

173
00:07:40,900 --> 00:07:44,710
do doesn't take<font color="#E5E5E5"> any soldering and it's</font>

174
00:07:42,940 --> 00:07:46,060
kind of cool and you know the coolest

175
00:07:44,710 --> 00:07:49,090
thing I came<font color="#CCCCCC"> up with</font><font color="#E5E5E5"> was a battery and</font>

176
00:07:46,060 --> 00:07:50,590
an LED and a piece of tape<font color="#E5E5E5"> and you know</font>

177
00:07:49,090 --> 00:07:52,270
you put the three together and special

178
00:07:50,590 --> 00:07:54,700
combination and tell all your LED comes

179
00:07:52,270 --> 00:07:55,990
on and you know I it's because i'm a

180
00:07:54,700 --> 00:07:58,510
geek but I<font color="#E5E5E5"> actually think putting a</font>

181
00:07:55,990 --> 00:07:59,860
battery and LED is pretty damn<font color="#CCCCCC"> cool like</font>

182
00:07:58,510 --> 00:08:01,870
at the entity I'm like look I made this

183
00:07:59,860 --> 00:08:03,130
you know it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> just because I come</font>

184
00:08:01,870 --> 00:08:05,110
home and I can't actually talk about

185
00:08:03,130 --> 00:08:07,719
<font color="#E5E5E5">what I</font><font color="#CCCCCC"> did but I can look at my LED</font>

186
00:08:05,110 --> 00:08:10,570
throwing my wife just kind of looks at

187
00:08:07,720 --> 00:08:14,620
me like<font color="#E5E5E5"> well okay sure whatever I got</font>

188
00:08:10,570 --> 00:08:19,599
lots<font color="#E5E5E5"> of</font><font color="#CCCCCC"> those around the house so</font><font color="#E5E5E5"> led</font>

189
00:08:14,620 --> 00:08:21,940
throw<font color="#E5E5E5"> east not shut</font><font color="#CCCCCC"> up Scott all right</font>

190
00:08:19,600 --> 00:08:23,860
so so who's this for you know obviously

191
00:08:21,940 --> 00:08:25,300
people who do instant response and

192
00:08:23,860 --> 00:08:28,180
<font color="#CCCCCC">working</font><font color="#E5E5E5"> security does anybody do that</font>

193
00:08:25,300 --> 00:08:30,940
now show hands couple people<font color="#CCCCCC"> all right</font>

194
00:08:28,180 --> 00:08:34,270
so you know<font color="#E5E5E5"> security professionals in</font>

195
00:08:30,940 --> 00:08:36,059
general and you know pretty<font color="#CCCCCC"> much anybody</font>

196
00:08:34,270 --> 00:08:38,819
who's been tasked to support windows one

197
00:08:36,059 --> 00:08:41,469
one time or another you know popular

198
00:08:38,820 --> 00:08:43,840
opinion on Microsoft operating systems

199
00:08:41,470 --> 00:08:45,460
are what they are but at the end of the

200
00:08:43,840 --> 00:08:47,200
day I<font color="#E5E5E5"> think we can pretty much all agree</font>

201
00:08:45,460 --> 00:08:52,030
that they're<font color="#E5E5E5"> here to stay right at least</font>

202
00:08:47,200 --> 00:08:54,310
for the end user so every presentation

203
00:08:52,030 --> 00:08:56,920
has or should have<font color="#E5E5E5"> a prerequisite slide</font>

204
00:08:54,310 --> 00:08:57,880
and mine is no different what are you

205
00:08:56,920 --> 00:09:00,069
going to<font color="#E5E5E5"> need well you're going to need</font>

206
00:08:57,880 --> 00:09:00,630
administrative rights if you don't have

207
00:09:00,070 --> 00:09:02,070
admin

208
00:09:00,630 --> 00:09:03,900
<font color="#CCCCCC">nights and you just have a regular user</font>

209
00:09:02,070 --> 00:09:05,190
account then I'm sorry but you're

210
00:09:03,900 --> 00:09:07,380
probably not<font color="#E5E5E5"> going to be able to</font>

211
00:09:05,190 --> 00:09:09,660
experience<font color="#E5E5E5"> the magic that is incident</font>

212
00:09:07,380 --> 00:09:12,240
response to be at a command line so<font color="#E5E5E5"> you</font>

213
00:09:09,660 --> 00:09:13,680
know I can't tell you how to escalate

214
00:09:12,240 --> 00:09:20,310
your privileges that's really a

215
00:09:13,680 --> 00:09:21,540
different talk<font color="#E5E5E5"> come talk to me after all</font>

216
00:09:20,310 --> 00:09:22,800
right so what am I<font color="#CCCCCC"> really gonna be</font>

217
00:09:21,540 --> 00:09:25,400
talking<font color="#E5E5E5"> about so I'm going to be talking</font>

218
00:09:22,800 --> 00:09:27,530
<font color="#E5E5E5">about a Windows command called run as</font>

219
00:09:25,400 --> 00:09:30,689
we'll talk about that a<font color="#CCCCCC"> little later</font>

220
00:09:27,530 --> 00:09:33,360
wmic which I kind of stumbled upon and

221
00:09:30,690 --> 00:09:39,300
its really referred to as the most

222
00:09:33,360 --> 00:09:40,680
<font color="#E5E5E5">unknown command in Windows PS tools put</font>

223
00:09:39,300 --> 00:09:43,319
together by the<font color="#E5E5E5"> SIS internal guys who</font>

224
00:09:40,680 --> 00:09:45,239
are now owned by microsoft and reg and

225
00:09:43,320 --> 00:09:46,950
there'll be a sprinkling of one or two

226
00:09:45,240 --> 00:09:50,670
other commands but they're just<font color="#E5E5E5"> kind of</font>

227
00:09:46,950 --> 00:09:52,200
in support of these so if any of<font color="#E5E5E5"> you out</font>

228
00:09:50,670 --> 00:09:53,790
there don't<font color="#E5E5E5"> think incident responses you</font>

229
00:09:52,200 --> 00:09:56,760
know sexy is you know breaking in and

230
00:09:53,790 --> 00:09:59,099
stuff think about this this taya this is

231
00:09:56,760 --> 00:10:01,500
the title<font color="#E5E5E5"> for this presentation could</font>

232
00:09:59,100 --> 00:10:04,290
just as easily been called<font color="#E5E5E5"> okay I have a</font>

233
00:10:01,500 --> 00:10:05,490
shell now what you know it's great<font color="#E5E5E5"> when</font>

234
00:10:04,290 --> 00:10:06,900
you have<font color="#E5E5E5"> your</font><font color="#CCCCCC"> metasploit you've got your</font>

235
00:10:05,490 --> 00:10:08,370
modules and your meterpreter and you're

236
00:10:06,900 --> 00:10:10,530
like hey<font color="#E5E5E5"> look i turned the guys webcam</font>

237
00:10:08,370 --> 00:10:12,090
on and the cds come in and out<font color="#E5E5E5"> and you</font>

238
00:10:10,530 --> 00:10:15,600
know that's all fine good but at the end

239
00:10:12,090 --> 00:10:18,750
of the day if<font color="#CCCCCC"> i give you</font><font color="#E5E5E5"> an admin shell</font>

240
00:10:15,600 --> 00:10:20,400
on some remote machine are you going to

241
00:10:18,750 --> 00:10:23,720
know what<font color="#E5E5E5"> to do with</font><font color="#CCCCCC"> it you know if you</font>

242
00:10:20,400 --> 00:10:27,020
don't have some<font color="#CCCCCC"> kind of middleware layer</font>

243
00:10:23,720 --> 00:10:30,600
that's<font color="#E5E5E5"> kind of what this is all about so</font>

244
00:10:27,020 --> 00:10:32,400
keep<font color="#CCCCCC"> that in the back</font><font color="#E5E5E5"> your mind all</font>

245
00:10:30,600 --> 00:10:35,730
<font color="#E5E5E5">right so run as it's really just a</font>

246
00:10:32,400 --> 00:10:41,310
shortcut to admin if you're a UNIX guy

247
00:10:35,730 --> 00:10:43,140
it it's sudo for windows hey you don't

248
00:10:41,310 --> 00:10:44,880
have to log out of your machine<font color="#E5E5E5"> with</font>

249
00:10:43,140 --> 00:10:46,620
your user account and log back in with

250
00:10:44,880 --> 00:10:48,300
your admin account you can just you know

251
00:10:46,620 --> 00:10:49,650
open up<font color="#E5E5E5"> a specific window or issue</font>

252
00:10:48,300 --> 00:10:51,209
commands using your administrative

253
00:10:49,650 --> 00:10:53,520
rights I know that<font color="#CCCCCC"> sounds kind of stupid</font>

254
00:10:51,210 --> 00:10:55,860
to some<font color="#E5E5E5"> of you but there are people out</font>

255
00:10:53,520 --> 00:10:57,840
there who don't<font color="#E5E5E5"> know that you can run an</font>

256
00:10:55,860 --> 00:11:00,090
administrative window inside your user

257
00:10:57,840 --> 00:11:02,010
account and do everything that<font color="#CCCCCC"> you need</font>

258
00:11:00,090 --> 00:11:03,840
to do they will actually<font color="#CCCCCC"> log out log</font>

259
00:11:02,010 --> 00:11:05,550
back in or you know use<font color="#E5E5E5"> two computers</font>

260
00:11:03,840 --> 00:11:06,780
<font color="#E5E5E5">and stuff and sometimes that's good you</font>

261
00:11:05,550 --> 00:11:08,339
want the extra real estate on<font color="#E5E5E5"> the screen</font>

262
00:11:06,780 --> 00:11:13,350
but you don't<font color="#E5E5E5"> you don't have to do it</font>

263
00:11:08,340 --> 00:11:14,460
that way<font color="#E5E5E5"> all right so whereas run as was</font>

264
00:11:13,350 --> 00:11:15,480
<font color="#E5E5E5">a shortcut to admin</font>

265
00:11:14,460 --> 00:11:19,170
I'm going<font color="#E5E5E5"> to teach you</font><font color="#CCCCCC"> how to make a</font>

266
00:11:15,480 --> 00:11:21,090
shortcut called admin to run ass so work

267
00:11:19,170 --> 00:11:22,439
with me here all right so everybody

268
00:11:21,090 --> 00:11:23,640
doesn't make a shortcut right right

269
00:11:22,440 --> 00:11:26,970
click on<font color="#CCCCCC"> your desktop that's not</font>

270
00:11:23,640 --> 00:11:29,580
earth-shattering so what we have here<font color="#CCCCCC"> is</font>

271
00:11:26,970 --> 00:11:32,880
<font color="#E5E5E5">basically the incantation that you're</font>

272
00:11:29,580 --> 00:11:35,010
going<font color="#E5E5E5"> to need to</font><font color="#CCCCCC"> make this happen I call</font>

273
00:11:32,880 --> 00:11:38,150
mine admin only<font color="#E5E5E5"> because they told me is</font>

274
00:11:35,010 --> 00:11:41,790
<font color="#E5E5E5">not a good idea to call mine pwnage</font>

275
00:11:38,150 --> 00:11:43,260
especially at work I kill two birds with

276
00:11:41,790 --> 00:11:44,790
one stone actually with this because not

277
00:11:43,260 --> 00:11:47,010
only do I get<font color="#CCCCCC"> a shortcut to make an</font>

278
00:11:44,790 --> 00:11:49,349
admin shell anytime I want but I have it

279
00:11:47,010 --> 00:11:51,720
tell it to drop me into my PS tools

280
00:11:49,350 --> 00:11:53,310
folder so then I can execute all my PS

281
00:11:51,720 --> 00:11:55,110
tools<font color="#E5E5E5"> commands and anything else I want</font>

282
00:11:53,310 --> 00:11:57,420
to<font color="#E5E5E5"> drop in there could i have set</font>

283
00:11:55,110 --> 00:12:04,950
environmental variable and windows yeah

284
00:11:57,420 --> 00:12:07,530
but you know i don't<font color="#E5E5E5"> i'm lazy so i know</font>

285
00:12:04,950 --> 00:12:09,090
so really you just give<font color="#CCCCCC"> me the shell so</font>

286
00:12:07,530 --> 00:12:11,520
if the stars are aligned correctly and

287
00:12:09,090 --> 00:12:12,960
you put in your password correctly you

288
00:12:11,520 --> 00:12:14,880
should now be sitting at a window that

289
00:12:12,960 --> 00:12:16,830
looks<font color="#CCCCCC"> very similar to this</font><font color="#E5E5E5"> only with you</font>

290
00:12:14,880 --> 00:12:18,689
know your name not mine because if it's

291
00:12:16,830 --> 00:12:23,730
my name and we really do need to talk

292
00:12:18,690 --> 00:12:29,190
after<font color="#E5E5E5"> this you can actually you can set</font>

293
00:12:23,730 --> 00:12:31,020
your colors go back if you see that<font color="#E5E5E5"> my</font>

294
00:12:29,190 --> 00:12:33,120
long incantation there near the<font color="#E5E5E5"> end</font>

295
00:12:31,020 --> 00:12:37,740
right<font color="#E5E5E5"> before the admin title admin</font>

296
00:12:33,120 --> 00:12:41,520
console<font color="#CCCCCC"> I have color 02 the first digit</font>

297
00:12:37,740 --> 00:12:43,440
<font color="#CCCCCC">is the</font><font color="#E5E5E5"> background color and the second</font>

298
00:12:41,520 --> 00:12:45,870
digit<font color="#E5E5E5"> is your font color so you can</font>

299
00:12:43,440 --> 00:12:47,460
actually play with those and set those

300
00:12:45,870 --> 00:12:49,830
in your command line I went with<font color="#E5E5E5"> this</font>

301
00:12:47,460 --> 00:12:51,660
for a couple of<font color="#E5E5E5"> reasons one I grew up in</font>

302
00:12:49,830 --> 00:12:53,940
the<font color="#E5E5E5"> old school monochrome</font><font color="#CCCCCC"> green screen</font>

303
00:12:51,660 --> 00:12:56,520
days you know the terminals and this

304
00:12:53,940 --> 00:13:00,360
just kind<font color="#E5E5E5"> of reminds me of that and it's</font>

305
00:12:56,520 --> 00:13:03,180
<font color="#E5E5E5">kind of matrix e 2 so you know</font><font color="#CCCCCC"> alright</font>

306
00:13:00,360 --> 00:13:04,680
so this is our shortcut to our

307
00:13:03,180 --> 00:13:06,300
administrative shell now i know i said

308
00:13:04,680 --> 00:13:08,310
earlier the remote shells are cool and

309
00:13:06,300 --> 00:13:09,719
some of your<font color="#E5E5E5"> like well yeah but that's</font>

310
00:13:08,310 --> 00:13:12,270
not<font color="#E5E5E5"> really remote shell dude you just</font>

311
00:13:09,720 --> 00:13:17,730
kind of shell into yourself with an

312
00:13:12,270 --> 00:13:19,230
admin that's that's not pwnage so once

313
00:13:17,730 --> 00:13:22,080
you<font color="#CCCCCC"> have your admin shell and your</font>

314
00:13:19,230 --> 00:13:24,660
awesome PS tools this is kind of what

315
00:13:22,080 --> 00:13:27,900
you're what you're looking for it really

316
00:13:24,660 --> 00:13:31,980
is that<font color="#CCCCCC"> simple</font><font color="#E5E5E5"> PS xxxx / / IP</font>

317
00:13:27,900 --> 00:13:33,900
or hostname and cmd.exe now PS exec

318
00:13:31,980 --> 00:13:36,660
allows you to execute any command that

319
00:13:33,900 --> 00:13:38,850
you<font color="#E5E5E5"> put after it once you give it a</font>

320
00:13:36,660 --> 00:13:44,069
destination address it's going<font color="#E5E5E5"> to use</font>

321
00:13:38,850 --> 00:13:46,110
whatever rights that you're using<font color="#E5E5E5"> that</font>

322
00:13:44,070 --> 00:13:48,300
you happen to be and you can create a

323
00:13:46,110 --> 00:13:50,160
much longer PS exec incantation where

324
00:13:48,300 --> 00:13:51,479
you actually tell it your administrative

325
00:13:50,160 --> 00:13:52,980
user name that we have to type in your

326
00:13:51,480 --> 00:13:56,130
password but sends your password<font color="#E5E5E5"> and</font>

327
00:13:52,980 --> 00:13:57,450
clear text and that's not<font color="#E5E5E5"> so great so</font>

328
00:13:56,130 --> 00:13:58,950
that's one of<font color="#E5E5E5"> the reasons why</font><font color="#CCCCCC"> I do an</font>

329
00:13:57,450 --> 00:14:00,870
admin shell and then you know again

330
00:13:58,950 --> 00:14:02,280
because I'm lazy I have an admin shell I

331
00:14:00,870 --> 00:14:04,050
<font color="#CCCCCC">don't have to tell it my username and</font>

332
00:14:02,280 --> 00:14:06,720
password all the time I can just execute

333
00:14:04,050 --> 00:14:09,449
my PS exec tell it I want to<font color="#E5E5E5"> run cmd.exe</font>

334
00:14:06,720 --> 00:14:14,250
on a remote machine boom Bob's your

335
00:14:09,450 --> 00:14:16,320
uncle you've got a shell you<font color="#CCCCCC"> can execute</font>

336
00:14:14,250 --> 00:14:19,410
these locally or remotely the line

337
00:14:16,320 --> 00:14:20,820
between local shell and remote shell

338
00:14:19,410 --> 00:14:22,350
starts to get kind of blurry because you

339
00:14:20,820 --> 00:14:24,780
have a<font color="#E5E5E5"> local admin shell that you use to</font>

340
00:14:22,350 --> 00:14:27,960
get<font color="#E5E5E5"> a remote shell but you could in that</font>

341
00:14:24,780 --> 00:14:32,480
remote shell execute commands locally it

342
00:14:27,960 --> 00:14:34,680
yeah so what we'll get into that so wmic

343
00:14:32,480 --> 00:14:38,100
don't we can<font color="#CCCCCC"> I say is actually really</font>

344
00:14:34,680 --> 00:14:40,469
<font color="#CCCCCC">cool we're going</font><font color="#E5E5E5"> to actually be using</font>

345
00:14:38,100 --> 00:14:43,290
something called wmic exe it comes

346
00:14:40,470 --> 00:14:48,570
loaded reloaded windows XP pro it's not

347
00:14:43,290 --> 00:14:51,599
in home and that's<font color="#CCCCCC"> okay windows 2003</font>

348
00:14:48,570 --> 00:14:54,600
server<font color="#CCCCCC"> in vista windows 7 you really</font>

349
00:14:51,600 --> 00:14:56,240
need to<font color="#E5E5E5"> use</font><font color="#CCCCCC"> powershell you can use wmic</font>

350
00:14:54,600 --> 00:14:59,850
commands but you have to put them<font color="#CCCCCC"> in</font>

351
00:14:56,240 --> 00:15:01,800
<font color="#CCCCCC">powershell speak and</font><font color="#E5E5E5"> i am working on</font>

352
00:14:59,850 --> 00:15:04,170
some<font color="#CCCCCC"> PowerShell examples and</font><font color="#E5E5E5"> I'm hoping</font>

353
00:15:01,800 --> 00:15:07,260
to do that maybe next year talk about

354
00:15:04,170 --> 00:15:12,349
PowerShell maybe depending on how this

355
00:15:07,260 --> 00:15:12,350
goes all right I know where you sleep

356
00:15:14,330 --> 00:15:22,080
yeah yeah yeah<font color="#CCCCCC"> all right so here's what</font>

357
00:15:19,440 --> 00:15:23,520
the wmic syntax looks like it is an

358
00:15:22,080 --> 00:15:26,310
object oriented language<font color="#CCCCCC"> I am by no</font>

359
00:15:23,520 --> 00:15:28,620
means programmer but I would love<font color="#CCCCCC"> to be</font>

360
00:15:26,310 --> 00:15:31,979
one day but this<font color="#E5E5E5"> is this is what it</font><font color="#CCCCCC"> is</font>

361
00:15:28,620 --> 00:15:34,110
we have our alias each alias has an

362
00:15:31,980 --> 00:15:37,980
attribute and the attributes have

363
00:15:34,110 --> 00:15:40,170
methods that can be acted upon so for

364
00:15:37,980 --> 00:15:41,130
example if we generate an alias called

365
00:15:40,170 --> 00:15:44,040
outer zone

366
00:15:41,130 --> 00:15:47,370
if you were to say wmic outer zone list

367
00:15:44,040 --> 00:15:50,819
brief / format list it would spit out in

368
00:15:47,370 --> 00:15:53,880
brief<font color="#E5E5E5"> mode which is</font><font color="#CCCCCC"> windows picking for</font>

369
00:15:50,820 --> 00:15:56,760
you what values it thinks are important

370
00:15:53,880 --> 00:15:59,910
to you and it's<font color="#CCCCCC"> usually anywhere between</font>

371
00:15:56,760 --> 00:16:02,910
two to eight of them so you can see the

372
00:15:59,910 --> 00:16:05,579
outer zones version is seven value is

373
00:16:02,910 --> 00:16:08,250
priceless price is free and the mood is

374
00:16:05,580 --> 00:16:09,750
fun but ok so let's say I wanted to get

375
00:16:08,250 --> 00:16:13,520
something that wasn't shown there you

376
00:16:09,750 --> 00:16:17,130
know what about the value for win so

377
00:16:13,520 --> 00:16:19,640
outer zone as a when value is full so

378
00:16:17,130 --> 00:16:22,260
obviously its outer zone is full of win

379
00:16:19,640 --> 00:16:24,319
on the other<font color="#E5E5E5"> hand let's say I was going</font>

380
00:16:22,260 --> 00:16:27,510
to actually<font color="#CCCCCC"> you know change a value</font>

381
00:16:24,320 --> 00:16:31,860
where security conferences locations or

382
00:16:27,510 --> 00:16:34,410
outer zone call is the website updated

383
00:16:31,860 --> 00:16:36,690
yet and you can<font color="#CCCCCC"> actually pass it a value</font>

384
00:16:34,410 --> 00:16:40,860
<font color="#CCCCCC">of you know yes finally and I think</font><font color="#E5E5E5"> this</font>

385
00:16:36,690 --> 00:16:44,540
was accurate as of last night sky dog is

386
00:16:40,860 --> 00:16:44,540
waving his knife at me just<font color="#E5E5E5"> so you know</font>

387
00:16:45,440 --> 00:16:52,350
<font color="#CCCCCC">alright so</font><font color="#E5E5E5"> let's get</font><font color="#CCCCCC"> into the actual fun</font>

388
00:16:48,600 --> 00:16:54,510
pneus of the stuff here so what<font color="#CCCCCC"> can I do</font>

389
00:16:52,350 --> 00:16:57,870
with<font color="#E5E5E5"> this stuff what can</font><font color="#CCCCCC"> i what will</font>

390
00:16:54,510 --> 00:16:59,550
wmic do for me right well among other

391
00:16:57,870 --> 00:17:01,980
<font color="#E5E5E5">things you can get some information like</font>

392
00:16:59,550 --> 00:17:04,470
your<font color="#CCCCCC"> bios kind of motherboard you're</font>

393
00:17:01,980 --> 00:17:05,579
running if you you<font color="#CCCCCC"> know go into a remote</font>

394
00:17:04,470 --> 00:17:08,069
machine you want to know whether they're

395
00:17:05,579 --> 00:17:12,089
32 or<font color="#E5E5E5"> 64 bit you can get that</font>

396
00:17:08,069 --> 00:17:14,609
information these<font color="#E5E5E5"> commands are basically</font>

397
00:17:12,089 --> 00:17:19,109
executed locally because you can use

398
00:17:14,609 --> 00:17:22,319
your PS exec<font color="#E5E5E5"> Rio remote shell in you can</font>

399
00:17:19,109 --> 00:17:24,629
also do them locally from your admin

400
00:17:22,319 --> 00:17:27,540
shell using the slash node you know

401
00:17:24,630 --> 00:17:28,800
colon quote remote box I leave it up<font color="#E5E5E5"> to</font>

402
00:17:27,540 --> 00:17:30,510
you whatever your preference is if

403
00:17:28,800 --> 00:17:31,800
you're only<font color="#E5E5E5"> going to issue one you'll</font>

404
00:17:30,510 --> 00:17:33,180
probably want to put<font color="#CCCCCC"> in the slash node</font>

405
00:17:31,800 --> 00:17:34,800
if you're going to issue a whole bunch

406
00:17:33,180 --> 00:17:38,820
you'll probably just get your remote

407
00:17:34,800 --> 00:17:40,320
shell and get in<font color="#CCCCCC"> that way this is what</font>

408
00:17:38,820 --> 00:17:41,550
it looks like actually<font color="#E5E5E5"> change the colors</font>

409
00:17:40,320 --> 00:17:44,220
just because it looks<font color="#CCCCCC"> better on the</font>

410
00:17:41,550 --> 00:17:47,250
projector yeah you're welcome<font color="#E5E5E5"> and i made</font>

411
00:17:44,220 --> 00:17:48,900
the screenshots nice and big<font color="#E5E5E5"> so here's</font>

412
00:17:47,250 --> 00:17:50,220
our commands that we issued and you can

413
00:17:48,900 --> 00:17:53,559
see you know it spits out the

414
00:17:50,220 --> 00:17:57,490
<font color="#CCCCCC">information and</font><font color="#E5E5E5"> your it's Adele and</font>

415
00:17:53,559 --> 00:18:00,519
<font color="#CCCCCC">32-bit</font><font color="#E5E5E5"> processor it's okay that's not</font>

416
00:17:57,490 --> 00:18:01,960
<font color="#E5E5E5">like super awesome but you know I I want</font>

417
00:18:00,519 --> 00:18:03,580
to break<font color="#E5E5E5"> you guys in slowly because I</font>

418
00:18:01,960 --> 00:18:05,919
don't just<font color="#E5E5E5"> want to like overwhelm you</font>

419
00:18:03,580 --> 00:18:07,658
with awesomeness<font color="#E5E5E5"> that would be just too</font>

420
00:18:05,919 --> 00:18:09,429
much to handle for both of us at this

421
00:18:07,659 --> 00:18:11,440
<font color="#E5E5E5">point</font><font color="#CCCCCC"> it was not had a nearly enough</font>

422
00:18:09,429 --> 00:18:18,789
sleep for that<font color="#CCCCCC"> all right so you can</font><font color="#E5E5E5"> talk</font>

423
00:18:11,440 --> 00:18:20,169
to the operating system you can and wmic

424
00:18:18,789 --> 00:18:21,639
is in a cure-all there's some things

425
00:18:20,169 --> 00:18:24,820
that it can't do as well as other

426
00:18:21,639 --> 00:18:28,209
commands one of the<font color="#E5E5E5"> things is reg reg is</font>

427
00:18:24,820 --> 00:18:30,189
a built in windows command for the

428
00:18:28,210 --> 00:18:33,399
command prompt that allows you to query

429
00:18:30,190 --> 00:18:35,409
the registry I had no idea windows even

430
00:18:33,399 --> 00:18:37,689
add this command but you can do a lot<font color="#E5E5E5"> of</font>

431
00:18:35,409 --> 00:18:38,889
really slick stuff right off the bat any

432
00:18:37,690 --> 00:18:41,110
of you<font color="#CCCCCC"> guys have</font><font color="#E5E5E5"> any kind</font><font color="#CCCCCC"> of forensics</font>

433
00:18:38,889 --> 00:18:43,719
background and know what windows stores

434
00:18:41,110 --> 00:18:46,508
in the registry in terms of well just

435
00:18:43,720 --> 00:18:48,820
about everything you can pull out some

436
00:18:46,509 --> 00:18:50,799
information really quickly and make<font color="#E5E5E5"> a</font>

437
00:18:48,820 --> 00:18:53,320
determination on<font color="#CCCCCC"> the fly is this an</font>

438
00:18:50,799 --> 00:18:56,710
incident or is this just an anomalous

439
00:18:53,320 --> 00:19:00,249
security event what may have taken you

440
00:18:56,710 --> 00:19:03,669
45 minutes<font color="#E5E5E5"> with a GUI I won't name names</font>

441
00:19:00,249 --> 00:19:06,159
and case to remote in and pull the

442
00:19:03,669 --> 00:19:08,350
registry and look at<font color="#E5E5E5"> all the stuff you</font>

443
00:19:06,159 --> 00:19:11,619
<font color="#CCCCCC">can do with our motel for free if you</font>

444
00:19:08,350 --> 00:19:14,590
know what you're looking<font color="#E5E5E5"> for you</font><font color="#CCCCCC"> can</font>

445
00:19:11,619 --> 00:19:16,209
check<font color="#E5E5E5"> the install date you'd be</font>

446
00:19:14,590 --> 00:19:19,299
surprised how<font color="#E5E5E5"> many times we get called</font>

447
00:19:16,210 --> 00:19:21,100
to re-install machines that have been

448
00:19:19,299 --> 00:19:23,139
infected right you know standard

449
00:19:21,100 --> 00:19:26,289
procedure machines infected you got to

450
00:19:23,139 --> 00:19:28,269
pave it reinstall it everything that<font color="#E5E5E5"> you</font>

451
00:19:26,289 --> 00:19:31,809
do and<font color="#CCCCCC"> the security operation center has</font>

452
00:19:28,269 --> 00:19:34,090
to be documented so you have to say okay

453
00:19:31,809 --> 00:19:35,529
you know i called the field tech i gave

454
00:19:34,090 --> 00:19:38,259
him<font color="#CCCCCC"> the</font><font color="#E5E5E5"> name of the machine a sent him</font>

455
00:19:35,529 --> 00:19:40,419
all the information and then you wait

456
00:19:38,259 --> 00:19:41,950
and you never hear back from the guy

457
00:19:40,419 --> 00:19:45,429
<font color="#E5E5E5">because he's probably busy putting out</font>

458
00:19:41,950 --> 00:19:48,309
fire somewhere else did the Machine<font color="#CCCCCC"> get</font>

459
00:19:45,429 --> 00:19:50,139
reimage I don't know you know<font color="#E5E5E5"> let's go</font>

460
00:19:48,309 --> 00:19:52,389
<font color="#E5E5E5">ahead and ping it now look that's its</font>

461
00:19:50,139 --> 00:19:53,740
online how do I<font color="#E5E5E5"> know he didn't just put</font>

462
00:19:52,389 --> 00:19:56,229
it in<font color="#CCCCCC"> a closet for</font><font color="#E5E5E5"> two weeks and then</font>

463
00:19:53,740 --> 00:19:59,639
decide to pull it back out get your

464
00:19:56,230 --> 00:20:03,399
remote shell wmic<font color="#E5E5E5"> OS get installed eight</font>

465
00:19:59,639 --> 00:20:07,168
it does keep field techs honest not that

466
00:20:03,399 --> 00:20:07,168
they would<font color="#CCCCCC"> ever try to deceive you</font>

467
00:20:09,430 --> 00:20:19,040
say again it gets<font color="#E5E5E5"> the date from the bios</font>

468
00:20:16,690 --> 00:20:21,950
so yeah it does account for if they have

469
00:20:19,040 --> 00:20:25,610
like<font color="#CCCCCC"> a gold disc that</font><font color="#E5E5E5"> they are using it</font>

470
00:20:21,950 --> 00:20:27,890
doesn't pull it from the<font color="#E5E5E5"> image here's</font>

471
00:20:25,610 --> 00:20:29,770
what the output<font color="#CCCCCC"> of Reggie looks</font><font color="#E5E5E5"> like you</font>

472
00:20:27,890 --> 00:20:32,210
know if you want to get your uninstall

473
00:20:29,770 --> 00:20:34,220
information for example it'll<font color="#CCCCCC"> just start</font>

474
00:20:32,210 --> 00:20:36,830
listing all that stuff it's also a good

475
00:20:34,220 --> 00:20:40,280
way to get an idea<font color="#CCCCCC"> of what software</font><font color="#E5E5E5"> is</font>

476
00:20:36,830 --> 00:20:41,899
installed in<font color="#E5E5E5"> the machine not all windows</font>

477
00:20:40,280 --> 00:20:43,460
registry locations are created equal and

478
00:20:41,900 --> 00:20:50,510
<font color="#E5E5E5">I</font><font color="#CCCCCC"> found that this is the closest thing</font>

479
00:20:43,460 --> 00:20:51,410
to the add/remove programs window so

480
00:20:50,510 --> 00:20:53,840
there's two ways you can<font color="#E5E5E5"> get your</font>

481
00:20:51,410 --> 00:20:55,310
installation date with wmic you can get

482
00:20:53,840 --> 00:20:56,899
the OS get installed eight and<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

483
00:20:55,310 --> 00:21:00,310
what<font color="#E5E5E5"> it will look like it's a little</font>

484
00:20:56,900 --> 00:21:03,800
kludgy it's not<font color="#E5E5E5"> the most elegant output</font>

485
00:21:00,310 --> 00:21:04,940
you can<font color="#E5E5E5"> compare it to system info a lot</font>

486
00:21:03,800 --> 00:21:06,980
of<font color="#E5E5E5"> people</font><font color="#CCCCCC"> probably didn't know you could</font>

487
00:21:04,940 --> 00:21:08,930
take<font color="#E5E5E5"> the output of one das command and</font>

488
00:21:06,980 --> 00:21:10,970
pipe it like you can in UNIX to another

489
00:21:08,930 --> 00:21:13,850
one you<font color="#CCCCCC"> can this</font><font color="#E5E5E5"> is what that looks like</font>

490
00:21:10,970 --> 00:21:16,580
it's<font color="#E5E5E5"> really slick if you look you can</font>

491
00:21:13,850 --> 00:21:20,270
see you know<font color="#E5E5E5"> the install tapes 2009 10</font>

492
00:21:16,580 --> 00:21:22,429
6pm so you can kind of decipher it the

493
00:21:20,270 --> 00:21:27,110
output<font color="#CCCCCC"> of wmic you can read</font><font color="#E5E5E5"> it as you</font>

494
00:21:22,430 --> 00:21:29,240
know 2009 09 08 13 06 the military time

495
00:21:27,110 --> 00:21:32,540
same<font color="#E5E5E5"> thing just takes a little bit more</font>

496
00:21:29,240 --> 00:21:34,610
<font color="#E5E5E5">getting used to by the way system info</font>

497
00:21:32,540 --> 00:21:37,159
is another really good command it will

498
00:21:34,610 --> 00:21:39,050
<font color="#CCCCCC">give you a goodly amount of information</font>

499
00:21:37,160 --> 00:21:41,450
on whatever machine you're issuing it on

500
00:21:39,050 --> 00:21:45,830
not just install information but also

501
00:21:41,450 --> 00:21:47,600
windows version service packs security

502
00:21:45,830 --> 00:21:48,949
patches things of that nature so it's

503
00:21:47,600 --> 00:21:52,340
another really good one<font color="#E5E5E5"> that's worth</font>

504
00:21:48,950 --> 00:21:54,470
checking out<font color="#E5E5E5"> all right you can talk to</font>

505
00:21:52,340 --> 00:21:55,879
the hardware like we showed earlier you

506
00:21:54,470 --> 00:21:57,880
can get motherboard information but you

507
00:21:55,880 --> 00:22:00,320
can also get<font color="#E5E5E5"> disk drive information and</font>

508
00:21:57,880 --> 00:22:03,010
you<font color="#E5E5E5"> can get your mac address as</font><font color="#CCCCCC"> well</font>

509
00:22:00,320 --> 00:22:07,189
which I you know thanks pretty slick

510
00:22:03,010 --> 00:22:09,470
here's<font color="#E5E5E5"> what that looks like dr</font>

511
00:22:07,190 --> 00:22:12,320
information you can see your partitions

512
00:22:09,470 --> 00:22:14,660
your sizes as you know windows has a lot

513
00:22:12,320 --> 00:22:17,000
of interfaces network interfaces so

514
00:22:14,660 --> 00:22:18,710
it'll show those as well being an

515
00:22:17,000 --> 00:22:19,220
instant responder and a lot<font color="#CCCCCC"> of ways is</font>

516
00:22:18,710 --> 00:22:20,929
like being a

517
00:22:19,220 --> 00:22:23,289
detective I mean you always get called

518
00:22:20,929 --> 00:22:26,179
in after the crime happens and

519
00:22:23,289 --> 00:22:27,919
everybody's every instant responder has

520
00:22:26,179 --> 00:22:30,559
their hell story where they have to deal

521
00:22:27,919 --> 00:22:31,880
<font color="#E5E5E5">with some guy who's like a super VIP but</font>

522
00:22:30,559 --> 00:22:33,470
it just happens<font color="#CCCCCC"> that his machine is the</font>

523
00:22:31,880 --> 00:22:36,440
one that's like beaconing out to some

524
00:22:33,470 --> 00:22:37,340
foreign nation on an IRC port and you

525
00:22:36,440 --> 00:22:39,289
know you're<font color="#E5E5E5"> gonna have to take the</font>

526
00:22:37,340 --> 00:22:40,490
<font color="#E5E5E5">machine the</font><font color="#CCCCCC"> guy's machine offline you're</font>

527
00:22:39,289 --> 00:22:43,190
going to have to pay that he's<font color="#E5E5E5"> probably</font>

528
00:22:40,490 --> 00:22:45,200
going to<font color="#E5E5E5"> lose some work and he is</font>

529
00:22:43,190 --> 00:22:47,330
raising I mean he's just<font color="#E5E5E5"> screaming</font>

530
00:22:45,200 --> 00:22:48,799
bloody murder over this so of course

531
00:22:47,330 --> 00:22:50,418
<font color="#CCCCCC">your management's coming to come to you</font>

532
00:22:48,799 --> 00:22:52,220
<font color="#CCCCCC">be</font><font color="#E5E5E5"> like love karlo we need to mean to</font>

533
00:22:50,419 --> 00:22:54,470
make sure that you have the right

534
00:22:52,220 --> 00:22:57,230
machine because if you don't you know

535
00:22:54,470 --> 00:22:59,000
heads will roll so you know it doesn't

536
00:22:57,230 --> 00:23:00,950
<font color="#CCCCCC">matter you've got your IDs logs you've</font>

537
00:22:59,000 --> 00:23:02,690
got your firewall logs you've got your

538
00:23:00,950 --> 00:23:04,010
web proxy logs that you know maybe it

539
00:23:02,690 --> 00:23:06,260
has<font color="#E5E5E5"> authentication it's got the guys</font>

540
00:23:04,010 --> 00:23:09,580
username it's got the guys IP address

541
00:23:06,260 --> 00:23:12,500
it's got the guys<font color="#CCCCCC"> hostname</font><font color="#E5E5E5"> you know what</font>

542
00:23:09,580 --> 00:23:13,610
we're still not sure can you check

543
00:23:12,500 --> 00:23:14,750
something else is there is there

544
00:23:13,610 --> 00:23:17,120
something<font color="#E5E5E5"> else you can use</font>

545
00:23:14,750 --> 00:23:19,340
cross-reference sure I can remote in the

546
00:23:17,120 --> 00:23:22,280
guys machine I<font color="#E5E5E5"> can get his MAC address I</font>

547
00:23:19,340 --> 00:23:25,070
can compare it to the dhcp logs put the

548
00:23:22,280 --> 00:23:26,000
two together that and the<font color="#E5E5E5"> preponderance</font>

549
00:23:25,070 --> 00:23:27,950
of information<font color="#E5E5E5"> that I've already</font>

550
00:23:26,000 --> 00:23:30,070
gathered yes this is your guy you're

551
00:23:27,950 --> 00:23:33,289
gonna have<font color="#E5E5E5"> to go pull his machine so</font>

552
00:23:30,070 --> 00:23:34,850
things like<font color="#CCCCCC"> that happened only wish that</font>

553
00:23:33,289 --> 00:23:36,919
like a detective we could also get a

554
00:23:34,850 --> 00:23:38,570
warrant<font color="#E5E5E5"> and be the one who actually gets</font>

555
00:23:36,919 --> 00:23:40,520
like kicked down the guys door and like

556
00:23:38,570 --> 00:23:44,600
yank his machine from his hands<font color="#E5E5E5"> because</font>

557
00:23:40,520 --> 00:23:51,740
that would be so satisfying sadly that

558
00:23:44,600 --> 00:23:53,870
<font color="#CCCCCC">is not the case</font><font color="#E5E5E5"> right you can get a</font>

559
00:23:51,740 --> 00:23:55,880
really<font color="#E5E5E5"> cool example of what you can do</font>

560
00:23:53,870 --> 00:23:57,949
with the reg command in terms of the

561
00:23:55,880 --> 00:24:00,830
registries that you can show the USB

562
00:23:57,950 --> 00:24:03,169
history of a device for those that you

563
00:24:00,830 --> 00:24:06,168
don't know windows stores a history<font color="#CCCCCC"> of</font>

564
00:24:03,169 --> 00:24:08,720
<font color="#E5E5E5">the time and the date the unique serial</font>

565
00:24:06,169 --> 00:24:10,490
number and the name<font color="#E5E5E5"> of the USB device</font>

566
00:24:08,720 --> 00:24:12,850
that you attached to your<font color="#E5E5E5"> Windows</font>

567
00:24:10,490 --> 00:24:15,880
machine so if your company has an

568
00:24:12,850 --> 00:24:20,418
authorized USB thumb drive you know

569
00:24:15,880 --> 00:24:22,549
sandisk for example you<font color="#CCCCCC"> can find out if</font>

570
00:24:20,419 --> 00:24:24,679
the<font color="#E5E5E5"> u.s. be borne virus that</font><font color="#CCCCCC"> you now</font>

571
00:24:22,549 --> 00:24:27,350
detected on this user's machine came

572
00:24:24,679 --> 00:24:30,470
from his authorized thumb drive or his

573
00:24:27,350 --> 00:24:32,919
home thumb drive<font color="#E5E5E5"> I'll give you a guess</font>

574
00:24:30,470 --> 00:24:35,510
as to which one it always is

575
00:24:32,920 --> 00:24:38,480
of course always like<font color="#CCCCCC"> now it wasn't</font><font color="#E5E5E5"> me</font>

576
00:24:35,510 --> 00:24:43,160
was<font color="#E5E5E5"> you know but one hour man sure sure</font>

577
00:24:38,480 --> 00:24:45,950
was another<font color="#E5E5E5"> really slick thing you can</font>

578
00:24:43,160 --> 00:24:47,360
do you can<font color="#E5E5E5"> query the security event log</font>

579
00:24:45,950 --> 00:24:48,650
you can queer any event log with

580
00:24:47,360 --> 00:24:50,479
security event logs the one that I'm in

581
00:24:48,650 --> 00:24:51,950
the most often a lot of times you get

582
00:24:50,480 --> 00:24:54,080
asked the question well who's logged

583
00:24:51,950 --> 00:24:56,180
into<font color="#E5E5E5"> the machine before you know who's</font>

584
00:24:54,080 --> 00:24:58,730
logged in now well you can find that

585
00:24:56,180 --> 00:25:01,220
who's logged in down the next next

586
00:24:58,730 --> 00:25:03,590
command you<font color="#E5E5E5"> can use the</font><font color="#CCCCCC"> wmic you know</font>

587
00:25:01,220 --> 00:25:05,810
node computer system get username<font color="#CCCCCC"> p.s</font>

588
00:25:03,590 --> 00:25:08,330
tools has an<font color="#CCCCCC"> awesome tool for that</font>

589
00:25:05,810 --> 00:25:10,370
called PS logged on PS logged on / /

590
00:25:08,330 --> 00:25:12,740
remote machine it'll<font color="#E5E5E5"> tell you who signed</font>

591
00:25:10,370 --> 00:25:15,409
into it right now for historical

592
00:25:12,740 --> 00:25:21,890
purposes the security event log you can

593
00:25:15,410 --> 00:25:27,410
use wmse for that my netbook is about to

594
00:25:21,890 --> 00:25:28,790
die hang on<font color="#CCCCCC"> Oh much better these are</font>

595
00:25:27,410 --> 00:25:32,510
real world commands I use these every

596
00:25:28,790 --> 00:25:36,649
day you<font color="#E5E5E5"> know it's really really neat</font>

597
00:25:32,510 --> 00:25:40,490
stuff hey it can take a<font color="#CCCCCC"> two hour</font>

598
00:25:36,650 --> 00:25:42,230
incident down to 15<font color="#E5E5E5"> minutes and when</font>

599
00:25:40,490 --> 00:25:43,820
you're being you know asked to help on

600
00:25:42,230 --> 00:25:45,710
six different incidents at the same time

601
00:25:43,820 --> 00:25:47,000
and stuff just<font color="#E5E5E5"> coming in your answer</font>

602
00:25:45,710 --> 00:25:49,040
response is a lot like<font color="#E5E5E5"> work in the post</font>

603
00:25:47,000 --> 00:25:50,690
office the mail keeps on coming the

604
00:25:49,040 --> 00:25:52,190
incidents can never stop you know so

605
00:25:50,690 --> 00:25:54,320
long as people are getting email and

606
00:25:52,190 --> 00:25:56,300
someone sent<font color="#E5E5E5"> me a greeting card and I</font>

607
00:25:54,320 --> 00:25:59,950
have a secret<font color="#E5E5E5"> admirer there's three</font>

608
00:25:56,300 --> 00:25:59,950
dancing bears on your screen<font color="#E5E5E5"> to serve</font>

609
00:26:01,210 --> 00:26:06,050
all right you can<font color="#CCCCCC"> also get some some</font>

610
00:26:04,550 --> 00:26:09,649
other information<font color="#CCCCCC"> you can get</font><font color="#E5E5E5"> a list of</font>

611
00:26:06,050 --> 00:26:11,030
services for example there some actually

612
00:26:09,650 --> 00:26:13,190
really need stuff coming up in<font color="#E5E5E5"> terms of</font>

613
00:26:11,030 --> 00:26:16,310
what's running on machine here you can

614
00:26:13,190 --> 00:26:18,050
get<font color="#E5E5E5"> a list of processes earlier I talked</font>

615
00:26:16,310 --> 00:26:22,280
<font color="#CCCCCC">about</font><font color="#E5E5E5"> the difference between getting a</font>

616
00:26:18,050 --> 00:26:23,629
brief output and in the full full list

617
00:26:22,280 --> 00:26:26,690
of something so we're going<font color="#E5E5E5"> to see that</font>

618
00:26:23,630 --> 00:26:29,510
<font color="#E5E5E5">here in just a second so i'm going to</font>

619
00:26:26,690 --> 00:26:30,500
show you the wmic process list brief and

620
00:26:29,510 --> 00:26:32,960
i'm<font color="#E5E5E5"> going to show you what happens when</font>

621
00:26:30,500 --> 00:26:37,940
<font color="#E5E5E5">i actually asked a machine to give me</font>

622
00:26:32,960 --> 00:26:40,460
individual attributes of the process so

623
00:26:37,940 --> 00:26:42,470
here's brief right it gives me the

624
00:26:40,460 --> 00:26:44,210
handle count the name the priority the

625
00:26:42,470 --> 00:26:46,560
process ID the thread<font color="#CCCCCC"> count the working</font>

626
00:26:44,210 --> 00:26:48,610
set<font color="#CCCCCC"> size</font>

627
00:26:46,560 --> 00:26:51,790
other than the name none of this is

628
00:26:48,610 --> 00:26:53,379
<font color="#E5E5E5">actually useful to me but what if I</font>

629
00:26:51,790 --> 00:26:55,990
<font color="#CCCCCC">asked them for the name the executable</font>

630
00:26:53,380 --> 00:26:57,400
path the command line the process ID and

631
00:26:55,990 --> 00:27:00,550
I told that to give it to me in a nice

632
00:26:57,400 --> 00:27:02,800
pretty list all of a sudden we get some

633
00:27:00,550 --> 00:27:05,020
really really useful information for

634
00:27:02,800 --> 00:27:06,490
example that first one is my command

635
00:27:05,020 --> 00:27:09,010
line incantation that it showed you the

636
00:27:06,490 --> 00:27:11,260
beginning of<font color="#E5E5E5"> the presentation if you</font>

637
00:27:09,010 --> 00:27:13,629
were to run task manager login via you

638
00:27:11,260 --> 00:27:17,230
know<font color="#E5E5E5"> mstsc you would pull up task</font>

639
00:27:13,630 --> 00:27:20,230
manager and you would see cmd.exe and it

640
00:27:17,230 --> 00:27:22,480
would have my name but you wouldn't be

641
00:27:20,230 --> 00:27:25,840
able to<font color="#E5E5E5"> actually know what</font><font color="#CCCCCC"> I typed at</font>

642
00:27:22,480 --> 00:27:28,090
the command prompt and this will show

643
00:27:25,840 --> 00:27:30,550
<font color="#E5E5E5">you this will show you every executable</font>

644
00:27:28,090 --> 00:27:33,189
that is<font color="#E5E5E5"> running and what was issued to</font>

645
00:27:30,550 --> 00:27:37,540
the operating system what flags were

646
00:27:33,190 --> 00:27:38,950
passed to it what values this is<font color="#CCCCCC"> super</font>

647
00:27:37,540 --> 00:27:40,780
useful information if you're trying to

648
00:27:38,950 --> 00:27:44,950
troubleshoot a process that's called you

649
00:27:40,780 --> 00:27:47,440
know I<font color="#E5E5E5"> don't know what's a good one yeah</font>

650
00:27:44,950 --> 00:27:49,630
service dot exe you know but it's<font color="#CCCCCC"> making</font>

651
00:27:47,440 --> 00:27:53,710
remote connections outbound to foreign

652
00:27:49,630 --> 00:27:55,810
country oops you know so you'll issue

653
00:27:53,710 --> 00:27:58,210
this command and if it is you know

654
00:27:55,810 --> 00:28:00,490
you're less early cleverly crafted

655
00:27:58,210 --> 00:28:02,110
malware all of a<font color="#CCCCCC"> sudden it's going to be</font>

656
00:28:00,490 --> 00:28:09,210
<font color="#E5E5E5">pointing to a file like you know c colon</font>

657
00:28:02,110 --> 00:28:13,719
backslash windows xk 293 you know ye XE

658
00:28:09,210 --> 00:28:17,160
hmm that shouldn't<font color="#E5E5E5"> be there or you know</font>

659
00:28:13,720 --> 00:28:20,910
some other unusual<font color="#E5E5E5"> startup place</font>

660
00:28:17,160 --> 00:28:20,910
actually go back up one

661
00:28:22,990 --> 00:28:30,139
not too far<font color="#CCCCCC"> you also get</font><font color="#E5E5E5"> your startup</font>

662
00:28:27,080 --> 00:28:32,240
programs which is another really good

663
00:28:30,139 --> 00:28:34,279
place to check<font color="#E5E5E5"> you would do a</font><font color="#CCCCCC"> wmse</font>

664
00:28:32,240 --> 00:28:36,559
<font color="#E5E5E5">startup list full and that would give</font>

665
00:28:34,279 --> 00:28:37,639
<font color="#E5E5E5">you</font><font color="#CCCCCC"> the full list of anything that's set</font>

666
00:28:36,559 --> 00:28:43,190
to start at boot time and you can also

667
00:28:37,639 --> 00:28:46,158
catch the malware there as well<font color="#CCCCCC"> alright</font>

668
00:28:43,190 --> 00:28:47,899
so<font color="#E5E5E5"> that's basically my summary of the</font>

669
00:28:46,159 --> 00:28:50,980
stuff you can<font color="#E5E5E5"> get from windows when</font>

670
00:28:47,899 --> 00:28:53,689
<font color="#CCCCCC">you're trying to</font><font color="#E5E5E5"> do some investigation</font>

671
00:28:50,980 --> 00:28:55,429
what can I actually change in Windows

672
00:28:53,690 --> 00:28:57,139
and this is where we<font color="#E5E5E5"> talk about you know</font>

673
00:28:55,429 --> 00:29:00,379
the line between an incident responder

674
00:28:57,139 --> 00:29:02,658
and a you know your pen tester / you

675
00:29:00,379 --> 00:29:04,158
know shady individual who's trying to

676
00:29:02,659 --> 00:29:08,619
break into<font color="#E5E5E5"> your system kind of starts to</font>

677
00:29:04,159 --> 00:29:08,619
blur you know how do i hack the gibson

678
00:29:08,980 --> 00:29:18,559
<font color="#E5E5E5">yeah grown alright so here's how we take</font>

679
00:29:14,149 --> 00:29:20,090
<font color="#CCCCCC">action remotely</font><font color="#E5E5E5"> you can run anything</font>

680
00:29:18,559 --> 00:29:22,460
that's on the<font color="#E5E5E5"> machine natively on your</font>

681
00:29:20,090 --> 00:29:24,830
remote host you could use X copy and

682
00:29:22,460 --> 00:29:26,960
copy and installer over and install

683
00:29:24,830 --> 00:29:30,649
software all without ever having to<font color="#E5E5E5"> use</font>

684
00:29:26,960 --> 00:29:31,850
anything more than your command line for

685
00:29:30,649 --> 00:29:34,070
better<font color="#CCCCCC"> or worse there's a lot of</font>

686
00:29:31,850 --> 00:29:36,320
instances where you<font color="#E5E5E5"> get asked to reboot</font>

687
00:29:34,070 --> 00:29:37,879
a machine and rerun a semantic scan in

688
00:29:36,320 --> 00:29:40,399
the hopes that maybe it'll you know

689
00:29:37,879 --> 00:29:43,459
catch something this time this is how

690
00:29:40,399 --> 00:29:44,899
you would do it you for<font color="#E5E5E5"> specifically for</font>

691
00:29:43,460 --> 00:29:50,149
<font color="#E5E5E5">Symantec this is the command line</font>

692
00:29:44,899 --> 00:29:52,399
incantation to scan all the<font color="#E5E5E5"> drives let's</font>

693
00:29:50,149 --> 00:29:54,320
say you<font color="#E5E5E5"> know you're running on a hard</font>

694
00:29:52,399 --> 00:29:56,479
disk space everybody knows hard drives

695
00:29:54,320 --> 00:29:58,549
are really expensive hard disk space is

696
00:29:56,480 --> 00:30:01,490
really<font color="#E5E5E5"> hard to come by</font><font color="#CCCCCC"> so how do</font><font color="#E5E5E5"> I start</font>

697
00:29:58,549 --> 00:30:02,720
uninstalling software right or let's say

698
00:30:01,490 --> 00:30:05,840
I<font color="#E5E5E5"> really want to mess</font><font color="#CCCCCC"> with somebody and</font>

699
00:30:02,720 --> 00:30:10,999
uninstall their microsoft office you can

700
00:30:05,840 --> 00:30:14,350
use wmic run on install command yeah or

701
00:30:10,999 --> 00:30:14,350
you<font color="#E5E5E5"> know one install their antivirus</font>

702
00:30:15,460 --> 00:30:21,049
yeah well yeah<font color="#CCCCCC"> all the clever malware</font>

703
00:30:18,320 --> 00:30:25,610
does do that<font color="#E5E5E5"> as well maybe they use wmic</font>

704
00:30:21,049 --> 00:30:28,520
<font color="#E5E5E5">I don't know</font><font color="#CCCCCC"> alright</font>

705
00:30:25,610 --> 00:30:31,428
reboot somebody's machine pretty<font color="#CCCCCC"> simple</font>

706
00:30:28,520 --> 00:30:34,879
again don't do this to people they get

707
00:30:31,429 --> 00:30:37,400
really upset you<font color="#E5E5E5"> also don't launch</font>

708
00:30:34,880 --> 00:30:44,059
notepad and calc exe randomly on their

709
00:30:37,400 --> 00:30:48,350
desktop they'll awesome yeah yeah<font color="#E5E5E5"> that's</font>

710
00:30:44,059 --> 00:30:50,030
<font color="#E5E5E5">true there's a stupid question quota yes</font>

711
00:30:48,350 --> 00:30:52,399
this is the<font color="#E5E5E5"> equivalent of the</font><font color="#CCCCCC"> god email</font>

712
00:30:50,030 --> 00:30:54,200
<font color="#E5E5E5">I think there actually is a flag you can</font>

713
00:30:52,400 --> 00:30:56,600
pass a note pad that will shove text

714
00:30:54,200 --> 00:30:59,150
into it so you can really really mess

715
00:30:56,600 --> 00:31:00,110
with some people or let's say they're

716
00:30:59,150 --> 00:31:02,230
working on a really important

717
00:31:00,110 --> 00:31:07,909
presentation that they stole<font color="#E5E5E5"> from you</font>

718
00:31:02,230 --> 00:31:10,730
you can kill their process oops where

719
00:31:07,910 --> 00:31:14,679
did it go after you're<font color="#E5E5E5"> done messing with</font>

720
00:31:10,730 --> 00:31:14,679
it you can<font color="#E5E5E5"> clear the security event log</font>

721
00:31:15,340 --> 00:31:21,949
you can clear the security event log

722
00:31:17,990 --> 00:31:30,020
from the command line that's pretty

723
00:31:21,950 --> 00:31:32,210
awesome and dangerous right security

724
00:31:30,020 --> 00:31:34,570
<font color="#E5E5E5">event log is full and you're getting</font><font color="#CCCCCC"> a</font>

725
00:31:32,210 --> 00:31:36,850
bunch of errors you have to go clear it

726
00:31:34,570 --> 00:31:39,860
yeah the<font color="#E5E5E5"> hard does about fill up right</font>

727
00:31:36,850 --> 00:31:42,139
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> so there's one more feature wmic</font>

728
00:31:39,860 --> 00:31:44,750
it has native<font color="#E5E5E5"> mop functions yes I made</font>

729
00:31:42,140 --> 00:31:46,580
this up<font color="#E5E5E5"> I made this up just like I made</font>

730
00:31:44,750 --> 00:31:48,169
up<font color="#CCCCCC"> l RF support back when I used to get</font>

731
00:31:46,580 --> 00:31:49,760
calls from sales guys who would<font color="#E5E5E5"> say</font>

732
00:31:48,169 --> 00:31:51,380
things like dude I've got this totally

733
00:31:49,760 --> 00:31:52,760
awesome switch you've totally got come

734
00:31:51,380 --> 00:31:54,320
check it out it's<font color="#CCCCCC"> ten times more than</font>

735
00:31:52,760 --> 00:31:56,360
switches you're running but it's just

736
00:31:54,320 --> 00:32:00,918
totally awesome like well does<font color="#CCCCCC"> it have a</font>

737
00:31:56,360 --> 00:32:02,168
<font color="#E5E5E5">large support crickets I don't know man</font>

738
00:32:00,919 --> 00:32:05,059
let me get<font color="#E5E5E5"> a sales engineer on the phone</font>

739
00:32:02,169 --> 00:32:06,470
sales engineer gets on the phone yeah

740
00:32:05,059 --> 00:32:10,549
I'm<font color="#E5E5E5"> trying to</font><font color="#CCCCCC"> find out if your product</font>

741
00:32:06,470 --> 00:32:16,059
is l RF support what l RF support you

742
00:32:10,549 --> 00:32:16,059
know l RF version for little rubber feet

743
00:32:16,440 --> 00:32:20,270
I wouldn't tell<font color="#CCCCCC"> them that but</font><font color="#E5E5E5"> they would</font>

744
00:32:18,180 --> 00:32:22,260
never be like<font color="#E5E5E5"> I let me call</font><font color="#CCCCCC"> you back</font>

745
00:32:20,270 --> 00:32:26,310
that's how<font color="#E5E5E5"> you get off their list real</font>

746
00:32:22,260 --> 00:32:31,820
fast yeah<font color="#CCCCCC"> what but it is this support</font>

747
00:32:26,310 --> 00:32:35,100
ssl<font color="#CCCCCC"> alright so mop is make output pretty</font>

748
00:32:31,820 --> 00:32:36,570
wmic<font color="#E5E5E5"> has some really what</font><font color="#CCCCCC"> i think is</font>

749
00:32:35,100 --> 00:32:38,850
<font color="#CCCCCC">really advanced stuff</font><font color="#E5E5E5"> somebody put some</font>

750
00:32:36,570 --> 00:32:41,820
serious thought into this it has

751
00:32:38,850 --> 00:32:44,850
built-in<font color="#CCCCCC"> XL style sheets for data</font>

752
00:32:41,820 --> 00:32:48,179
reporting you can output into an HTML

753
00:32:44,850 --> 00:32:50,219
table you can output into csv or even

754
00:32:48,180 --> 00:32:52,140
<font color="#CCCCCC">xml and it even comes with a flag you'll</font>

755
00:32:50,220 --> 00:32:55,740
see down here the translate / translate

756
00:32:52,140 --> 00:32:58,710
basic<font color="#CCCCCC"> XML it will translate the</font>

757
00:32:55,740 --> 00:33:00,360
characters around the values into<font color="#CCCCCC"> there</font>

758
00:32:58,710 --> 00:33:01,650
in the actual<font color="#E5E5E5"> XML because if you don't</font>

759
00:33:00,360 --> 00:33:03,090
put<font color="#CCCCCC"> that flag in there it'll use the</font>

760
00:33:01,650 --> 00:33:04,200
HTML equivalents because it assumes

761
00:33:03,090 --> 00:33:08,480
you're trying to help<font color="#E5E5E5"> put this out to</font>

762
00:33:04,200 --> 00:33:12,630
some kind<font color="#E5E5E5"> of HTML thing super handy</font>

763
00:33:08,480 --> 00:33:14,100
here's what the<font color="#E5E5E5"> table looks like not</font>

764
00:33:12,630 --> 00:33:16,140
only does it spit it out<font color="#E5E5E5"> into a handy</font>

765
00:33:14,100 --> 00:33:18,510
table they actually you know change the

766
00:33:16,140 --> 00:33:22,340
color of the title and alternated every

767
00:33:18,510 --> 00:33:24,090
other row there so you can read<font color="#CCCCCC"> it</font>

768
00:33:22,340 --> 00:33:26,100
sometimes it's the little things you

769
00:33:24,090 --> 00:33:28,230
need to<font color="#E5E5E5"> appreciate in terms of what you</font>

770
00:33:26,100 --> 00:33:30,540
can do with<font color="#E5E5E5"> Windows I think that's</font>

771
00:33:28,230 --> 00:33:31,950
pretty slick I mean this is one command

772
00:33:30,540 --> 00:33:34,200
you don't have to do this<font color="#E5E5E5"> you don't have</font>

773
00:33:31,950 --> 00:33:35,970
to dump a dick cell and you know do what

774
00:33:34,200 --> 00:33:37,200
I do or<font color="#CCCCCC"> you highlight two rows and you</font>

775
00:33:35,970 --> 00:33:38,520
change the color and then<font color="#E5E5E5"> you cut and</font>

776
00:33:37,200 --> 00:33:39,870
paste<font color="#E5E5E5"> that all down because you're too</font>

777
00:33:38,520 --> 00:33:42,420
stupid to<font color="#CCCCCC"> know how to</font><font color="#E5E5E5"> make it do it in</font>

778
00:33:39,870 --> 00:33:43,800
the background automatically yeah it's

779
00:33:42,420 --> 00:33:49,080
like you can catch a hacker but you

780
00:33:43,800 --> 00:33:55,889
don't know<font color="#CCCCCC"> how to use excel and don't</font>

781
00:33:49,080 --> 00:33:57,240
hate ten cents to hate<font color="#E5E5E5"> I want to</font><font color="#CCCCCC"> show</font>

782
00:33:55,890 --> 00:34:00,390
<font color="#CCCCCC">you this one last one because I think</font>

783
00:33:57,240 --> 00:34:03,450
it's actually pretty<font color="#CCCCCC"> awesome you can</font>

784
00:34:00,390 --> 00:34:06,180
rear out somebody's<font color="#E5E5E5"> DNS in two easy</font>

785
00:34:03,450 --> 00:34:11,370
steps one if you knew what<font color="#E5E5E5"> their index</font>

786
00:34:06,180 --> 00:34:14,820
was there is so much awesomeness in

787
00:34:11,370 --> 00:34:16,739
trying to change somebody's<font color="#CCCCCC"> DNS this is</font>

788
00:34:14,820 --> 00:34:19,980
actually one of my favorite attack

789
00:34:16,739 --> 00:34:22,259
vectors in terms of just you know

790
00:34:19,980 --> 00:34:23,940
viruses and malware there was actually

791
00:34:22,260 --> 00:34:26,100
one where it will if you have like an

792
00:34:23,940 --> 00:34:28,590
open wireless it'll go out like it will

793
00:34:26,100 --> 00:34:29,909
infect your laptop and it'll stand for

794
00:34:28,590 --> 00:34:33,059
open wireless networks

795
00:34:29,909 --> 00:34:35,730
find what your router is use your

796
00:34:33,059 --> 00:34:38,549
default password for your router change

797
00:34:35,730 --> 00:34:40,829
your dns servers to you know its foreign

798
00:34:38,549 --> 00:34:43,770
nation<font color="#CCCCCC"> dns servers and then be</font><font color="#E5E5E5"> able to</font>

799
00:34:40,829 --> 00:34:46,710
track all of your traffic push ads to

800
00:34:43,770 --> 00:34:49,288
you impersonate your bank all because of

801
00:34:46,710 --> 00:34:51,990
<font color="#E5E5E5">dns</font><font color="#CCCCCC"> i mean think about this the entire</font>

802
00:34:49,289 --> 00:34:53,490
backbone operates on IP but humans don't

803
00:34:51,989 --> 00:34:54,779
know how to remember numbers so they

804
00:34:53,489 --> 00:34:56,819
have to remember things like yahoo and

805
00:34:54,780 --> 00:34:59,539
google com and stuff that's where<font color="#E5E5E5"> dns</font>

806
00:34:56,819 --> 00:35:02,190
comes in and it's a huge vulnerability

807
00:34:59,539 --> 00:35:04,260
so you can rewrite somebody's dns and

808
00:35:02,190 --> 00:35:07,020
the way you do this is first you issue

809
00:35:04,260 --> 00:35:09,329
this command because every<font color="#E5E5E5"> network</font>

810
00:35:07,020 --> 00:35:10,380
interface and windows is issued an index

811
00:35:09,329 --> 00:35:12,359
number so you need to know what that

812
00:35:10,380 --> 00:35:14,640
<font color="#E5E5E5">index number is so first you get your</font>

813
00:35:12,359 --> 00:35:16,910
index number mine was number eight in

814
00:35:14,640 --> 00:35:20,578
<font color="#E5E5E5">this example and then you just say hey</font>

815
00:35:16,910 --> 00:35:23,250
wmic / node remote box Nick<font color="#E5E5E5"> config we're</font>

816
00:35:20,579 --> 00:35:30,359
index equals<font color="#E5E5E5"> eight</font><font color="#CCCCCC"> call set dns server</font>

817
00:35:23,250 --> 00:35:32,579
<font color="#E5E5E5">cert order boom and actually put this</font>

818
00:35:30,359 --> 00:35:33,690
title in here<font color="#CCCCCC"> just for iron geek because</font>

819
00:35:32,579 --> 00:35:35,039
<font color="#CCCCCC">i know this is</font><font color="#E5E5E5"> one of his favorite</font>

820
00:35:33,690 --> 00:35:39,000
phrases and it cracks me up every time

821
00:35:35,039 --> 00:35:43,109
he uses it and it'll do it just like

822
00:35:39,000 --> 00:35:45,569
<font color="#CCCCCC">that so what is</font><font color="#E5E5E5"> the non nefarious</font>

823
00:35:43,109 --> 00:35:46,920
purpose for something like this if you

824
00:35:45,569 --> 00:35:48,450
have a<font color="#E5E5E5"> machine on your network that's</font>

825
00:35:46,920 --> 00:35:51,180
infected let's say it's in a remote host

826
00:35:48,450 --> 00:35:53,279
<font color="#E5E5E5">that has an ISDN link because it's some</font>

827
00:35:51,180 --> 00:35:56,399
crazy remote location and you know

828
00:35:53,279 --> 00:35:58,369
trying to do<font color="#E5E5E5"> full-blown mstsc remote</font>

829
00:35:56,400 --> 00:36:02,160
desktop on it's<font color="#E5E5E5"> just going to choke that</font>

830
00:35:58,369 --> 00:36:04,470
<font color="#CCCCCC">464 k link you</font><font color="#E5E5E5"> can do this if you have a</font>

831
00:36:02,160 --> 00:36:07,410
<font color="#CCCCCC">dns server on your network that you use</font>

832
00:36:04,470 --> 00:36:10,980
just for this purpose you can take the

833
00:36:07,410 --> 00:36:12,868
<font color="#CCCCCC">dns output from that server's log pipe</font>

834
00:36:10,980 --> 00:36:16,020
it into your<font color="#E5E5E5"> network management system</font>

835
00:36:12,869 --> 00:36:19,650
your nagios your<font color="#CCCCCC"> splunk your arc site</font>

836
00:36:16,020 --> 00:36:21,630
and just have a specific channel set up

837
00:36:19,650 --> 00:36:24,660
to watch<font color="#E5E5E5"> this you don't need to know</font>

838
00:36:21,630 --> 00:36:26,910
where it's going because rerouting its

839
00:36:24,660 --> 00:36:28,920
dns and watching that traffic on your

840
00:36:26,910 --> 00:36:30,779
network monitoring system will tell you

841
00:36:28,920 --> 00:36:32,910
everything<font color="#E5E5E5"> you need to know unless its</font>

842
00:36:30,779 --> 00:36:35,819
IP<font color="#CCCCCC"> based but let's face it most malware</font>

843
00:36:32,910 --> 00:36:38,129
out there den<font color="#CCCCCC"> DNS org right some kind of</font>

844
00:36:35,819 --> 00:36:40,020
dynamic dns very few<font color="#E5E5E5"> of them have</font>

845
00:36:38,130 --> 00:36:41,700
hard-coded ip's because they know those

846
00:36:40,020 --> 00:36:42,900
can be<font color="#E5E5E5"> blocked</font><font color="#CCCCCC"> at the firewall but</font><font color="#E5E5E5"> you</font>

847
00:36:41,700 --> 00:36:45,089
can<font color="#E5E5E5"> change dns name</font>

848
00:36:42,900 --> 00:36:48,109
background as many times as you need to

849
00:36:45,089 --> 00:36:50,220
to point to a different IP so you can I

850
00:36:48,109 --> 00:36:52,770
don't<font color="#CCCCCC"> necessarily want to</font><font color="#E5E5E5"> use the term</font>

851
00:36:50,220 --> 00:36:54,598
<font color="#E5E5E5">pseudo honeynet a box because it's not</font>

852
00:36:52,770 --> 00:36:57,150
entirely accurate but in terms of you

853
00:36:54,599 --> 00:37:01,099
know hijacking their DNS traffic for an

854
00:36:57,150 --> 00:37:03,930
actual good use this<font color="#E5E5E5"> is what you can do</font>

855
00:37:01,099 --> 00:37:05,160
so out of all the commands that<font color="#E5E5E5"> I've</font>

856
00:37:03,930 --> 00:37:08,399
found so far this is by far the coolest

857
00:37:05,160 --> 00:37:11,420
such I had to share that<font color="#CCCCCC"> because I DNS</font>

858
00:37:08,400 --> 00:37:16,589
hijacking is just so elegant and simple

859
00:37:11,420 --> 00:37:21,359
<font color="#E5E5E5">so that's what I got so far how am i</font>

860
00:37:16,589 --> 00:37:26,940
doing on time<font color="#CCCCCC"> okay I've got</font><font color="#E5E5E5"> what five</font>

861
00:37:21,359 --> 00:37:28,589
minutes I want to thank skydog for

862
00:37:26,940 --> 00:37:30,720
looking me in the eye last year at outer

863
00:37:28,589 --> 00:37:32,460
zone and saying hey thanks<font color="#E5E5E5"> for helping</font>

864
00:37:30,720 --> 00:37:39,930
unload the truck by the way you're<font color="#CCCCCC"> doing</font>

865
00:37:32,460 --> 00:37:41,789
a talk next year yeah exactly and<font color="#E5E5E5"> I know</font>

866
00:37:39,930 --> 00:37:43,230
<font color="#E5E5E5">I talked earlier about you know there</font>

867
00:37:41,789 --> 00:37:47,609
really isn't that much of a separation

868
00:37:43,230 --> 00:37:50,369
<font color="#CCCCCC">between you know attendees and speakers</font>

869
00:37:47,609 --> 00:37:53,160
the only difference is someone looks you

870
00:37:50,369 --> 00:37:54,210
in the eye and says hey you need<font color="#E5E5E5"> to find</font>

871
00:37:53,160 --> 00:37:56,640
out what<font color="#E5E5E5"> you're really passionate about</font>

872
00:37:54,210 --> 00:37:58,950
what<font color="#E5E5E5"> is it that</font><font color="#CCCCCC"> you do that you could</font>

873
00:37:56,640 --> 00:38:02,069
talk for 45 minutes about it's really

874
00:37:58,950 --> 00:38:03,960
not that long a lot of<font color="#CCCCCC"> people are</font>

875
00:38:02,069 --> 00:38:06,569
intimidated they think well you know I

876
00:38:03,960 --> 00:38:08,730
<font color="#CCCCCC">don't know any zero day exploits I</font>

877
00:38:06,569 --> 00:38:11,130
haven't discovered you know anything

878
00:38:08,730 --> 00:38:14,059
super awesome<font color="#E5E5E5"> and you know I can't</font>

879
00:38:11,130 --> 00:38:17,430
compare<font color="#CCCCCC"> to the other speakers</font><font color="#E5E5E5"> well</font>

880
00:38:14,059 --> 00:38:20,640
conference organizers i have found are

881
00:38:17,430 --> 00:38:22,680
very<font color="#E5E5E5"> happy to have a handful of speakers</font>

882
00:38:20,640 --> 00:38:25,410
they know they can always call upon to

883
00:38:22,680 --> 00:38:26,609
get on stage and fill time slots because

884
00:38:25,410 --> 00:38:28,890
they know that<font color="#E5E5E5"> they're going to draw a</font>

885
00:38:26,609 --> 00:38:32,009
crowd and their materials usually pretty

886
00:38:28,890 --> 00:38:33,299
good at the same time they also hold

887
00:38:32,010 --> 00:38:35,670
these conferences because they want<font color="#E5E5E5"> to</font>

888
00:38:33,299 --> 00:38:37,799
give new people a chance to<font color="#E5E5E5"> get in front</font>

889
00:38:35,670 --> 00:38:39,510
<font color="#E5E5E5">of the audience experience what it's</font>

890
00:38:37,799 --> 00:38:44,640
like to give a talk maybe get<font color="#CCCCCC"> on the</font>

891
00:38:39,510 --> 00:38:47,180
talk circuit as it were and help improve

892
00:38:44,640 --> 00:38:50,129
those individuals careers as well and

893
00:38:47,180 --> 00:38:52,310
allow them to network and meet other

894
00:38:50,130 --> 00:38:55,100
people

895
00:38:52,310 --> 00:38:57,380
I would ask<font color="#E5E5E5"> you</font><font color="#CCCCCC"> to do the same thing you</font>

896
00:38:55,100 --> 00:38:59,600
<font color="#E5E5E5">know go home take some time think about</font>

897
00:38:57,380 --> 00:39:01,910
what it is that you do on a daily basis

898
00:38:59,600 --> 00:39:02,810
because I mean I do this every day you

899
00:39:01,910 --> 00:39:04,490
know I didn't really<font color="#CCCCCC"> think there was</font>

900
00:39:02,810 --> 00:39:05,960
anything all that special about<font color="#CCCCCC"> it until</font>

901
00:39:04,490 --> 00:39:07,669
I really started to talk to<font color="#E5E5E5"> other people</font>

902
00:39:05,960 --> 00:39:09,620
and go hey you know you can rewrite some

903
00:39:07,670 --> 00:39:10,670
buddies ANS or hey you<font color="#E5E5E5"> know you can find</font>

904
00:39:09,620 --> 00:39:12,290
out when somebody's machine was

905
00:39:10,670 --> 00:39:13,490
installed and they're saying<font color="#E5E5E5"> oh that's</font>

906
00:39:12,290 --> 00:39:14,810
pretty<font color="#E5E5E5"> slick I didn't I didn't know you</font>

907
00:39:13,490 --> 00:39:16,479
could do that and the more times you

908
00:39:14,810 --> 00:39:18,740
start hearing that<font color="#E5E5E5"> you start thinking</font>

909
00:39:16,480 --> 00:39:20,390
maybe I could talk<font color="#E5E5E5"> about that you know</font>

910
00:39:18,740 --> 00:39:22,160
<font color="#E5E5E5">maybe I need to hold a little class at</font>

911
00:39:20,390 --> 00:39:25,460
work and you know teach them the other

912
00:39:22,160 --> 00:39:28,100
guys how to do it maybe I can<font color="#CCCCCC"> ask skydog</font>

913
00:39:25,460 --> 00:39:35,090
if I can<font color="#E5E5E5"> talk at the next outer zone yes</font>

914
00:39:28,100 --> 00:39:36,380
sir I would make<font color="#CCCCCC"> sure I knew who that</font>

915
00:39:35,090 --> 00:39:38,210
the question was how do<font color="#E5E5E5"> you prevent it</font>

916
00:39:36,380 --> 00:39:41,200
<font color="#E5E5E5">from having on our network you need to</font>

917
00:39:38,210 --> 00:39:43,700
keep an eye on who it is that you grant

918
00:39:41,200 --> 00:39:45,859
administrative rights to on your Windows

919
00:39:43,700 --> 00:39:49,939
domain I mean I<font color="#E5E5E5"> hate to say it but it</font>

920
00:39:45,860 --> 00:39:52,280
comes<font color="#CCCCCC"> down to that for PS tools there</font>

921
00:39:49,940 --> 00:39:55,130
are specific<font color="#E5E5E5"> IDs signatures that will</font>

922
00:39:52,280 --> 00:39:58,400
detect the execution of those commands

923
00:39:55,130 --> 00:40:00,140
across the network there's nothing

924
00:39:58,400 --> 00:40:02,000
<font color="#E5E5E5">saying that those nefarious individuals</font>

925
00:40:00,140 --> 00:40:04,339
won't know what those rules are and

926
00:40:02,000 --> 00:40:06,350
change the codes so that that specific

927
00:40:04,340 --> 00:40:09,260
visited signature-based won't trigger

928
00:40:06,350 --> 00:40:11,960
but you can do it<font color="#E5E5E5"> that way that's a good</font>

929
00:40:09,260 --> 00:40:14,480
<font color="#E5E5E5">question in terms of wmic I'm gonna have</font>

930
00:40:11,960 --> 00:40:15,710
to do some some packet captures and see

931
00:40:14,480 --> 00:40:18,080
what that looks like and see if you can

932
00:40:15,710 --> 00:40:20,480
write<font color="#E5E5E5"> a signature</font><font color="#CCCCCC"> to detect wmic</font>

933
00:40:18,080 --> 00:40:23,480
remotely the command line the remote

934
00:40:20,480 --> 00:40:25,760
shell for example would trigger the PS

935
00:40:23,480 --> 00:40:26,990
tools PS exact rule if you're<font color="#E5E5E5"> going to</font>

936
00:40:25,760 --> 00:40:32,150
do it that way i don't<font color="#CCCCCC"> know about</font><font color="#E5E5E5"> the</font>

937
00:40:26,990 --> 00:40:35,839
slash remote box equals take some time

938
00:40:32,150 --> 00:40:37,670
to really decide if everybody that has

939
00:40:35,840 --> 00:40:39,320
<font color="#E5E5E5">domain admin rights really needs them or</font>

940
00:40:37,670 --> 00:40:41,480
if they if<font color="#CCCCCC"> you can get away with</font>

941
00:40:39,320 --> 00:40:44,660
spending a couple of<font color="#E5E5E5"> weeks making some</font>

942
00:40:41,480 --> 00:40:47,750
more stringent and better controlled

943
00:40:44,660 --> 00:40:49,910
accounts for people one<font color="#E5E5E5"> of the best</font>

944
00:40:47,750 --> 00:40:51,710
examples in a lot of<font color="#E5E5E5"> institutions the</font>

945
00:40:49,910 --> 00:40:53,810
individuals<font color="#E5E5E5"> with</font><font color="#CCCCCC"> the least amount of</font>

946
00:40:51,710 --> 00:40:56,900
liability in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> highest amount of</font>

947
00:40:53,810 --> 00:41:00,500
privileges are your help desk because it

948
00:40:56,900 --> 00:41:02,030
evolves naturally you know like oh babe

949
00:41:00,500 --> 00:41:05,540
this guy you know needs to have his

950
00:41:02,030 --> 00:41:08,040
password reset really

951
00:41:05,540 --> 00:41:09,960
you're going to hire some help desk guy

952
00:41:08,040 --> 00:41:12,119
to give them the ability to reset

953
00:41:09,960 --> 00:41:13,680
passwords all over your enterprise and I

954
00:41:12,119 --> 00:41:18,349
don't have an easy solution for that you

955
00:41:13,680 --> 00:41:20,520
know but that's kind of how it happens

956
00:41:18,349 --> 00:41:22,230
institute some kind of self-service

957
00:41:20,520 --> 00:41:24,630
password reset in feature stuff like

958
00:41:22,230 --> 00:41:32,930
that but there's no super easy way to

959
00:41:24,630 --> 00:41:32,930
detect it on the network yeah thank<font color="#E5E5E5"> you</font>

960
00:41:45,000 --> 00:41:48,600
so the<font color="#E5E5E5"> question is have ever used wmic</font>

961
00:41:47,040 --> 00:41:51,270
to get a baseline of the software that's

962
00:41:48,600 --> 00:41:54,480
installed I can<font color="#E5E5E5"> because I have access</font><font color="#CCCCCC"> to</font>

963
00:41:51,270 --> 00:41:55,920
the base image it's<font color="#E5E5E5"> something that's</font>

964
00:41:54,480 --> 00:41:57,900
hard to track obviously because patches

965
00:41:55,920 --> 00:41:59,970
get applied to stuff all the time and

966
00:41:57,900 --> 00:42:02,700
it's not as reliable to say md5 hashes

967
00:41:59,970 --> 00:42:05,250
but you could absolutely use that if you

968
00:42:02,700 --> 00:42:07,859
were willing to just generate one every

969
00:42:05,250 --> 00:42:10,770
week or even once a month would be<font color="#E5E5E5"> super</font>

970
00:42:07,860 --> 00:42:12,660
helpful and you would you know be

971
00:42:10,770 --> 00:42:15,150
instantly able to determine what was the

972
00:42:12,660 --> 00:42:18,060
<font color="#E5E5E5">Delta you know and then I would</font>

973
00:42:15,150 --> 00:42:19,950
recommend wind if there's actually

974
00:42:18,060 --> 00:42:21,840
command and<font color="#E5E5E5"> windows called WC which</font>

975
00:42:19,950 --> 00:42:29,250
allows you to<font color="#E5E5E5"> take two files and compare</font>

976
00:42:21,840 --> 00:42:31,080
them little kludgy yeah in the<font color="#E5E5E5"> back it</font>

977
00:42:29,250 --> 00:42:32,820
does generate an event that says the

978
00:42:31,080 --> 00:42:35,700
event log has<font color="#CCCCCC"> been cleared so it's not</font>

979
00:42:32,820 --> 00:42:39,780
you know super secret yeah by this by

980
00:42:35,700 --> 00:42:42,799
this account you<font color="#E5E5E5"> just write a script</font>

981
00:42:39,780 --> 00:42:42,800
that<font color="#E5E5E5"> just does it over and over again</font>

982
00:42:46,820 --> 00:42:50,730
yeah well I mean<font color="#E5E5E5"> if you have domain</font>

983
00:42:48,810 --> 00:42:54,770
admin rights you create a new<font color="#CCCCCC"> user grant</font>

984
00:42:50,730 --> 00:42:54,770
him admin rights and go on

985
00:43:04,029 --> 00:43:12,079
hey<font color="#CCCCCC"> buddy have any other questions</font><font color="#E5E5E5"> no</font>

986
00:43:07,759 --> 00:43:14,329
all right Sam it's my name this

987
00:43:12,079 --> 00:43:18,499
presentation will be up on SE solutions

988
00:43:14,329 --> 00:43:22,690
com pretty soon and got to get a hold of

989
00:43:18,499 --> 00:43:22,689
<font color="#E5E5E5">me drop me a line thank you guys</font>

990
00:43:41,110 --> 00:43:43,170
you

