1
00:00:05,359 --> 00:00:10,530
see why<font color="#E5E5E5"> I should use</font><font color="#CCCCCC"> to handle now good</font>

2
00:00:09,210 --> 00:00:12,420
afternoon everybody my name<font color="#CCCCCC"> is Nick</font>

3
00:00:10,530 --> 00:00:14,820
Chapman I mean we talking about embedded

4
00:00:12,420 --> 00:00:16,020
malicious JavaScript this is<font color="#E5E5E5"> something I</font>

5
00:00:14,820 --> 00:00:18,539
really got interested<font color="#E5E5E5"> in looking at some</font>

6
00:00:16,020 --> 00:00:20,640
of<font color="#E5E5E5"> the ass</font><font color="#CCCCCC"> Brock's attacks of last year</font>

7
00:00:18,539 --> 00:00:21,830
which<font color="#CCCCCC"> is if you saw the headlines</font>

8
00:00:20,640 --> 00:00:25,890
hundreds of thousands of websites

9
00:00:21,830 --> 00:00:29,909
compromised all kinds of fun<font color="#E5E5E5"> Dow all</font>

10
00:00:25,890 --> 00:00:31,439
kinds of nastiness first of all what<font color="#CCCCCC"> is</font>

11
00:00:29,910 --> 00:00:34,710
this we're talking<font color="#CCCCCC"> about it's a</font>

12
00:00:31,439 --> 00:00:39,530
generally<font color="#E5E5E5"> JavaScript</font><font color="#CCCCCC"> it's embedded said</font>

13
00:00:34,710 --> 00:00:42,300
my shouting to<font color="#E5E5E5"> the mic too much okay</font>

14
00:00:39,530 --> 00:00:45,660
jelly in bed surreptitiously into

15
00:00:42,300 --> 00:00:48,569
legitimate normal web pages malicious

16
00:00:45,660 --> 00:00:50,578
generally used to identify some more

17
00:00:48,570 --> 00:00:53,390
sophisticated versions will also use to

18
00:00:50,579 --> 00:00:56,610
target specific exploits based upon

19
00:00:53,390 --> 00:01:00,350
browser or operating system or a<font color="#E5E5E5"> couple</font>

20
00:00:56,610 --> 00:01:02,519
of things<font color="#E5E5E5"> country of origin and</font>

21
00:01:00,350 --> 00:01:04,439
<font color="#CCCCCC">JavaScript obviously</font><font color="#E5E5E5"> cuz pretty</font><font color="#CCCCCC"> much</font>

22
00:01:02,520 --> 00:01:07,140
everyone in the world has javascript

23
00:01:04,438 --> 00:01:09,020
turned onto<font color="#CCCCCC"> the web browser even if</font>

24
00:01:07,140 --> 00:01:11,340
using no script or something like that

25
00:01:09,020 --> 00:01:14,130
still really easy to<font color="#E5E5E5"> get caught by this</font>

26
00:01:11,340 --> 00:01:15,720
because<font color="#CCCCCC"> I know I use no script a lot and</font>

27
00:01:14,130 --> 00:01:17,789
you go to a website<font color="#E5E5E5"> and they'll be you</font>

28
00:01:15,720 --> 00:01:19,470
know eight<font color="#CCCCCC"> or ten different domains at</font>

29
00:01:17,790 --> 00:01:21,150
all different<font color="#CCCCCC"> kinds of code running and</font>

30
00:01:19,470 --> 00:01:23,429
surely a pain to figure out which ones

31
00:01:21,150 --> 00:01:25,619
you have to<font color="#CCCCCC"> enable to actually make the</font>

32
00:01:23,430 --> 00:01:27,390
web page work so if you're<font color="#CCCCCC"> just</font><font color="#E5E5E5"> never do</font>

33
00:01:25,619 --> 00:01:29,490
as you say yeah let all that stuff go by

34
00:01:27,390 --> 00:01:32,040
and<font color="#E5E5E5"> you'll let on you know legitimate</font>

35
00:01:29,490 --> 00:01:35,939
site<font color="#E5E5E5"> calm and also evil bad hacker</font>

36
00:01:32,040 --> 00:01:38,610
<font color="#CCCCCC">sitecom this is something generally</font>

37
00:01:35,939 --> 00:01:40,408
called a drive-by malware which is

38
00:01:38,610 --> 00:01:42,600
basically you just go to the<font color="#CCCCCC"> website and</font>

39
00:01:40,409 --> 00:01:45,149
<font color="#E5E5E5">it's got this little iframe or script</font>

40
00:01:42,600 --> 00:01:46,829
source link that then takes you to an

41
00:01:45,149 --> 00:01:49,799
evil site that downloads the evil

42
00:01:46,829 --> 00:01:51,289
<font color="#E5E5E5">JavaScript and the bad guys do this for</font>

43
00:01:49,799 --> 00:01:53,729
a<font color="#CCCCCC"> couple of reasons it's a lot easier</font>

44
00:01:51,290 --> 00:01:55,799
what they would do<font color="#CCCCCC"> previously is</font>

45
00:01:53,729 --> 00:01:58,560
generally use search engine optimization

46
00:01:55,799 --> 00:02:01,079
techniques you know set up a hundred a

47
00:01:58,560 --> 00:02:04,350
thousand domains<font color="#E5E5E5"> link them back to each</font>

48
00:02:01,079 --> 00:02:06,839
other they tend to go after dot edu

49
00:02:04,350 --> 00:02:08,160
sites insert a bunch of<font color="#E5E5E5"> links in there</font>

50
00:02:06,840 --> 00:02:10,890
because<font color="#E5E5E5"> they tend to be less</font><font color="#CCCCCC"> well</font>

51
00:02:08,160 --> 00:02:15,579
<font color="#CCCCCC">protected have a good reputation</font>

52
00:02:10,889 --> 00:02:17,559
it's the next slide actually and<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

53
00:02:15,580 --> 00:02:19,330
<font color="#E5E5E5">just easier they also get you know the</font>

54
00:02:17,560 --> 00:02:21,010
eyes automatically<font color="#E5E5E5"> have to go take you</font>

55
00:02:19,330 --> 00:02:22,390
know insert a link into walmart down to

56
00:02:21,010 --> 00:02:24,640
bother driving eyes<font color="#CCCCCC"> to that</font><font color="#E5E5E5"> are driving</font>

57
00:02:22,390 --> 00:02:27,640
<font color="#E5E5E5">up their central rankings it's just</font>

58
00:02:24,640 --> 00:02:29,320
there and just like<font color="#CCCCCC"> you</font><font color="#E5E5E5"> mentioned the</font>

59
00:02:27,640 --> 00:02:34,899
first rule instance we saw this was the

60
00:02:29,320 --> 00:02:36,880
<font color="#CCCCCC">Super Bowl Sunday in 2007 someone</font>

61
00:02:34,900 --> 00:02:40,660
inserted malicious links into dolphin

62
00:02:36,880 --> 00:02:43,090
stadium<font color="#E5E5E5"> calm to the best of my knowledge</font>

63
00:02:40,660 --> 00:02:45,250
is probably done by using<font color="#E5E5E5"> an automated</font>

64
00:02:43,090 --> 00:02:48,220
scanning tool but manual sequel

65
00:02:45,250 --> 00:02:52,630
injection the hit dolphins<font color="#E5E5E5"> stadium</font><font color="#CCCCCC"> about</font>

66
00:02:48,220 --> 00:02:56,709
50 other websites to<font color="#E5E5E5"> main exploits</font><font color="#CCCCCC"> MSO</font>

67
00:02:52,630 --> 00:02:59,560
<font color="#CCCCCC">604 teams the M deck exploit and ms 0704</font>

68
00:02:56,709 --> 00:03:03,100
which is a vml buffer overload offer

69
00:02:59,560 --> 00:03:06,070
overflow rather they basically then you

70
00:03:03,100 --> 00:03:08,260
got<font color="#CCCCCC"> a WoW password stealing</font><font color="#E5E5E5"> Trojan is</font>

71
00:03:06,070 --> 00:03:10,390
believed to be done by a chinese gold

72
00:03:08,260 --> 00:03:12,280
farming syndicate and there was actually

73
00:03:10,390 --> 00:03:13,929
just an article in<font color="#CCCCCC"> The Guardian on</font>

74
00:03:12,280 --> 00:03:18,900
Thursday about gold farming so I've got

75
00:03:13,930 --> 00:03:21,160
some statistics on that there was um see

76
00:03:18,900 --> 00:03:23,850
they estimate there was a study at

77
00:03:21,160 --> 00:03:26,380
Manchester where they estimate that

78
00:03:23,850 --> 00:03:28,480
<font color="#CCCCCC">400,000</font><font color="#E5E5E5"> people in Asia are employed in</font>

79
00:03:26,380 --> 00:03:33,130
<font color="#CCCCCC">the gold farming industry that it makes</font>

80
00:03:28,480 --> 00:03:34,359
a 980 six million dollars a year and the

81
00:03:33,130 --> 00:03:36,220
Chinese government's apparently just

82
00:03:34,360 --> 00:03:39,370
slapped their twenty percent tax on gold

83
00:03:36,220 --> 00:03:44,050
farming Joe I thought was really

84
00:03:39,370 --> 00:03:45,580
<font color="#E5E5E5">entertaining this was why L 18 down n</font>

85
00:03:44,050 --> 00:03:47,290
you have<font color="#E5E5E5"> to bear with me these names</font>

86
00:03:45,580 --> 00:03:49,959
aren't very pronounceable so I'm just

87
00:03:47,290 --> 00:03:51,910
gonna come make it up as I go along this

88
00:03:49,959 --> 00:03:54,340
was the first one we know for sure was

89
00:03:51,910 --> 00:03:57,370
an automated sequel injection attack

90
00:03:54,340 --> 00:03:59,080
using<font color="#E5E5E5"> this</font><font color="#CCCCCC"> all long cast heck string</font>

91
00:03:57,370 --> 00:04:01,930
vein<font color="#CCCCCC"> you</font><font color="#E5E5E5"> guys have seen that before go</font>

92
00:03:59,080 --> 00:04:05,110
over that in a minute to it would

93
00:04:01,930 --> 00:04:07,780
initially just<font color="#E5E5E5"> brother</font><font color="#CCCCCC"> 0j s script</font><font color="#E5E5E5"> link</font>

94
00:04:05,110 --> 00:04:09,940
into these various websites and then

95
00:04:07,780 --> 00:04:12,310
redirect to a zero dot HTML page it had

96
00:04:09,940 --> 00:04:14,739
just<font color="#E5E5E5"> a whole bunch of iframes sprouting</font>

97
00:04:12,310 --> 00:04:17,918
out with a ton of different exploits on

98
00:04:14,739 --> 00:04:20,620
some activex<font color="#CCCCCC"> tov some Yahoo toolbar it</font>

99
00:04:17,918 --> 00:04:22,299
wasn't terribly sophisticated because

100
00:04:20,620 --> 00:04:23,080
basically just you'd have you know five

101
00:04:22,300 --> 00:04:25,569
or ten export

102
00:04:23,080 --> 00:04:27,490
firing off at the same time and<font color="#E5E5E5"> if one</font>

103
00:04:25,569 --> 00:04:29,310
<font color="#CCCCCC">of those was to crash your browser then</font>

104
00:04:27,490 --> 00:04:32,500
on<font color="#CCCCCC"> the other ones are going to work</font>

105
00:04:29,310 --> 00:04:35,500
later on actually and on the seventh of

106
00:04:32,500 --> 00:04:40,750
<font color="#E5E5E5">November they replaced as zero HTML with</font>

107
00:04:35,500 --> 00:04:42,129
<font color="#CCCCCC">Ed image HTM which was a activex control</font>

108
00:04:40,750 --> 00:04:43,650
that was<font color="#E5E5E5"> flawed and allowed arbitrary</font>

109
00:04:42,129 --> 00:04:46,780
code to be executed and they did that

110
00:04:43,650 --> 00:04:48,310
only five days<font color="#E5E5E5"> after the exploit was</font>

111
00:04:46,780 --> 00:04:49,929
publicly disclosed these guys<font color="#E5E5E5"> are pretty</font>

112
00:04:48,310 --> 00:04:53,969
quick about picking up<font color="#E5E5E5"> on the newest</font>

113
00:04:49,930 --> 00:04:56,889
latest best thing here's the<font color="#E5E5E5"> actual</font>

114
00:04:53,969 --> 00:04:58,810
sequel I this is obviously a lot<font color="#E5E5E5"> longer</font>

115
00:04:56,889 --> 00:05:00,879
in practice that that cast ring will<font color="#CCCCCC"> be</font>

116
00:04:58,810 --> 00:05:02,440
a thousand or so character so it's

117
00:05:00,879 --> 00:05:03,520
really easy to filter from block if you

118
00:05:02,440 --> 00:05:06,039
<font color="#E5E5E5">know what you're</font><font color="#CCCCCC"> looking for if</font><font color="#E5E5E5"> you've</font>

119
00:05:03,520 --> 00:05:08,318
<font color="#E5E5E5">gotten IPS or a laugh or something you</font>

120
00:05:06,039 --> 00:05:10,568
can<font color="#CCCCCC"> put in there they're actually been a</font>

121
00:05:08,319 --> 00:05:14,500
couple<font color="#E5E5E5"> different variants on this the</font>

122
00:05:10,569 --> 00:05:15,819
first<font color="#CCCCCC"> couple of Chinese tax would use on</font>

123
00:05:14,500 --> 00:05:18,129
a couple<font color="#E5E5E5"> of strings see if you were</font>

124
00:05:15,819 --> 00:05:20,740
vulnerable then<font color="#CCCCCC"> launched this one later</font>

125
00:05:18,129 --> 00:05:22,270
on asp rocks and things like that we

126
00:05:20,740 --> 00:05:24,729
<font color="#E5E5E5">just go ahead and blindly inject this</font>

127
00:05:22,270 --> 00:05:27,029
and if it works<font color="#E5E5E5"> it works if</font><font color="#CCCCCC"> not oh well</font>

128
00:05:24,729 --> 00:05:29,590
just<font color="#E5E5E5"> get bit more noise in your logs</font>

129
00:05:27,029 --> 00:05:32,740
this one in particular i'll show you the

130
00:05:29,590 --> 00:05:34,539
this is the decoded version and this got

131
00:05:32,740 --> 00:05:36,159
upgraded a bit later but this<font color="#E5E5E5"> one just</font>

132
00:05:34,539 --> 00:05:39,310
basically goes through and looks for any

133
00:05:36,159 --> 00:05:41,440
VAR char's in your database grabs like

134
00:05:39,310 --> 00:05:45,849
all the tables and<font color="#E5E5E5"> just sticks this</font>

135
00:05:41,440 --> 00:05:47,529
little JavaScript portion in there so

136
00:05:45,849 --> 00:05:48,819
any any text<font color="#CCCCCC"> you had that was later</font>

137
00:05:47,529 --> 00:05:51,849
displayed on your web page you know

138
00:05:48,819 --> 00:05:55,710
titles content whatever just gets a

139
00:05:51,849 --> 00:05:59,259
whole bunch of JavaScript stuck in it

140
00:05:55,710 --> 00:06:01,539
<font color="#CCCCCC">okay going a little bit later the next</font>

141
00:05:59,259 --> 00:06:04,389
round was in December of 2007 this one

142
00:06:01,539 --> 00:06:08,199
didn't have too many websites exploited

143
00:06:04,389 --> 00:06:10,930
but it's using<font color="#CCCCCC"> the same same exploit the</font>

144
00:06:08,199 --> 00:06:13,839
<font color="#E5E5E5">M DAC one and</font><font color="#CCCCCC"> also the</font><font color="#E5E5E5"> realplayer buffer</font>

145
00:06:10,930 --> 00:06:16,029
overflow and this was again I<font color="#E5E5E5"> believe</font>

146
00:06:13,839 --> 00:06:19,509
just a few weeks after this particular

147
00:06:16,029 --> 00:06:21,729
real pro player exploit was disclosed

148
00:06:19,509 --> 00:06:23,949
they were again using it and watching<font color="#E5E5E5"> a</font>

149
00:06:21,729 --> 00:06:25,508
whole new round of attacks so that they

150
00:06:23,949 --> 00:06:28,080
could take<font color="#E5E5E5"> advantage</font><font color="#CCCCCC"> of it before people</font>

151
00:06:25,509 --> 00:06:28,080
<font color="#E5E5E5">start patching</font>

152
00:06:28,520 --> 00:06:35,690
and the<font color="#E5E5E5"> next round is inviting some of</font>

153
00:06:31,819 --> 00:06:38,449
the<font color="#E5E5E5"> same IPS for sending back data for</font>

154
00:06:35,690 --> 00:06:40,430
the Trojan<font color="#CCCCCC"> that was downloaded this</font><font color="#E5E5E5"> one</font>

155
00:06:38,449 --> 00:06:42,259
<font color="#E5E5E5">did a bit better about 40,000 websites</font>

156
00:06:40,430 --> 00:06:45,319
and this was the first one to use an

157
00:06:42,259 --> 00:06:47,659
actual cursor based sequel injection

158
00:06:45,319 --> 00:06:49,280
attacks<font color="#E5E5E5"> I'll show you in a minute that's</font>

159
00:06:47,659 --> 00:06:53,240
that's beneficial because it also<font color="#E5E5E5"> goes</font>

160
00:06:49,280 --> 00:06:56,299
after n text text and<font color="#E5E5E5"> var</font><font color="#CCCCCC"> chard fields</font>

161
00:06:53,240 --> 00:06:58,430
all kinds of<font color="#CCCCCC"> different stuff and this</font><font color="#E5E5E5"> is</font>

162
00:06:56,300 --> 00:07:01,880
<font color="#E5E5E5">just a kind of generic password stealing</font>

163
00:06:58,430 --> 00:07:05,690
<font color="#E5E5E5">Trojan it just basically sits there and</font>

164
00:07:01,880 --> 00:07:08,750
watches for<font color="#E5E5E5"> ie to post forms doesn't</font>

165
00:07:05,690 --> 00:07:11,180
affect firefox just<font color="#E5E5E5"> ie and any time it</font>

166
00:07:08,750 --> 00:07:13,069
sees a post request of a input type of

167
00:07:11,180 --> 00:07:15,680
password it encrypts it and sends it off

168
00:07:13,069 --> 00:07:20,810
to China for them to do what they will

169
00:07:15,680 --> 00:07:23,389
with it this is the the newer improved

170
00:07:20,810 --> 00:07:25,880
version this actually uses a cursor

171
00:07:23,389 --> 00:07:27,139
which I wasn't<font color="#E5E5E5"> wearable this was until I</font>

172
00:07:25,880 --> 00:07:29,360
start looking at it's basically<font color="#E5E5E5"> kind</font>

173
00:07:27,139 --> 00:07:32,389
just like a loop for sequel where you go

174
00:07:29,360 --> 00:07:34,280
through and instantiate this cursor that

175
00:07:32,389 --> 00:07:36,919
does something<font color="#E5E5E5"> to each and every table</font>

176
00:07:34,280 --> 00:07:41,059
and in this case again it's<font color="#E5E5E5"> just going</font>

177
00:07:36,919 --> 00:07:44,109
through and checking the tight looking

178
00:07:41,060 --> 00:07:48,650
for various VAR<font color="#E5E5E5"> char's and such and</font>

179
00:07:44,110 --> 00:07:51,169
inserting this lovely string which they

180
00:07:48,650 --> 00:07:53,750
said get<font color="#E5E5E5"> a bit fun just call it p</font>

181
00:07:51,169 --> 00:07:55,310
pjs which some<font color="#E5E5E5"> of these guys actually</font>

182
00:07:53,750 --> 00:08:00,380
have<font color="#E5E5E5"> a sense of</font><font color="#CCCCCC"> humor as will see a bit</font>

183
00:07:55,310 --> 00:08:01,669
later<font color="#CCCCCC"> on in April</font><font color="#E5E5E5"> sans was able to</font>

184
00:08:00,380 --> 00:08:04,099
actually find one of<font color="#E5E5E5"> the tools being</font>

185
00:08:01,669 --> 00:08:05,448
used to the sequel injection there we

186
00:08:04,099 --> 00:08:07,759
know there<font color="#CCCCCC"> are a number of different</font>

187
00:08:05,449 --> 00:08:11,690
tools<font color="#E5E5E5"> running around this one in</font>

188
00:08:07,759 --> 00:08:15,259
particular uses a google scanning engine

189
00:08:11,690 --> 00:08:17,960
which<font color="#E5E5E5"> i believe</font><font color="#CCCCCC"> most of them do and it</font>

190
00:08:15,259 --> 00:08:20,029
will look<font color="#CCCCCC"> for asp pages that's what</font>

191
00:08:17,960 --> 00:08:23,719
initially all of these did was go after

192
00:08:20,029 --> 00:08:26,210
specifically only asp pages later it

193
00:08:23,719 --> 00:08:30,560
involved<font color="#CCCCCC"> too also</font><font color="#E5E5E5"> asp net instead of</font>

194
00:08:26,210 --> 00:08:33,110
classic asp and also cold fusion and all

195
00:08:30,560 --> 00:08:35,539
just microsoft stuff which<font color="#E5E5E5"> like yourself</font>

196
00:08:33,110 --> 00:08:37,159
is very firm it's not<font color="#CCCCCC"> us there's no</font>

197
00:08:35,539 --> 00:08:40,260
security problem there's nothing we can

198
00:08:37,159 --> 00:08:42,059
patch it's just poor web app coding

199
00:08:40,260 --> 00:08:43,770
it allows<font color="#CCCCCC"> a</font><font color="#E5E5E5"> sequel injection which is</font>

200
00:08:42,059 --> 00:08:46,109
true<font color="#CCCCCC"> but they still got a lot of heat</font>

201
00:08:43,770 --> 00:08:47,550
from that<font color="#E5E5E5"> and eventually they had to</font>

202
00:08:46,110 --> 00:08:50,460
make<font color="#CCCCCC"> a response to it even though it's</font>

203
00:08:47,550 --> 00:08:53,339
<font color="#CCCCCC">not really their problem although it is</font>

204
00:08:50,460 --> 00:08:55,560
kind of<font color="#E5E5E5"> a one thing that did Microsoft</font>

205
00:08:53,340 --> 00:08:58,530
sequel server allows is multiple

206
00:08:55,560 --> 00:09:01,829
compound statements so that does make it

207
00:08:58,530 --> 00:09:03,480
a lot easier to<font color="#E5E5E5"> do on sequel injection</font>

208
00:09:01,830 --> 00:09:05,790
because you can just comment out

209
00:09:03,480 --> 00:09:12,270
something<font color="#E5E5E5"> and then continue on with a</font>

210
00:09:05,790 --> 00:09:16,800
<font color="#E5E5E5">statement the next big round was a wind</font>

211
00:09:12,270 --> 00:09:18,600
<font color="#E5E5E5">z i sees i guess this was in</font><font color="#CCCCCC"> may and</font>

212
00:09:16,800 --> 00:09:21,030
<font color="#E5E5E5">this got over a hundred thousand sites</font>

213
00:09:18,600 --> 00:09:23,460
this is when they started going to using

214
00:09:21,030 --> 00:09:25,380
multiple domains instead of just one so

215
00:09:23,460 --> 00:09:31,130
you've got<font color="#E5E5E5"> the winzip sees that had</font>

216
00:09:25,380 --> 00:09:36,480
about 75,000 sites and also<font color="#E5E5E5"> this BBS dot</font>

217
00:09:31,130 --> 00:09:37,740
<font color="#CCCCCC">jujus arm</font><font color="#E5E5E5"> i guess about 44,000 and this</font>

218
00:09:36,480 --> 00:09:39,810
was the first time we saw them actually

219
00:09:37,740 --> 00:09:41,250
integrating unknown exploit kit i I

220
00:09:39,810 --> 00:09:43,829
don't<font color="#E5E5E5"> know the name of it's a Chinese</font>

221
00:09:41,250 --> 00:09:46,500
one but it used a whole bunch of

222
00:09:43,830 --> 00:09:48,510
<font color="#E5E5E5">different different exploits that are</font>

223
00:09:46,500 --> 00:09:52,860
actually targeted somewhat based upon

224
00:09:48,510 --> 00:09:54,810
the browser it would look at if you have

225
00:09:52,860 --> 00:09:57,210
IE six or seven depending upon that

226
00:09:54,810 --> 00:09:58,800
<font color="#E5E5E5">would give you different realplayer</font>

227
00:09:57,210 --> 00:10:02,070
exploits actually two different versions

228
00:09:58,800 --> 00:10:05,430
of that<font color="#E5E5E5"> and a few other exploits as well</font>

229
00:10:02,070 --> 00:10:07,950
and this one who is again a password

230
00:10:05,430 --> 00:10:12,989
stealing<font color="#CCCCCC"> trojan for a while and it</font>

231
00:10:07,950 --> 00:10:15,150
actually had a further had a further wow

232
00:10:12,990 --> 00:10:17,070
connection and i'm sure most you've

233
00:10:15,150 --> 00:10:18,959
heard of the problems of wow people

234
00:10:17,070 --> 00:10:21,240
having their their characters stolen and

235
00:10:18,960 --> 00:10:25,710
all that stuff apparently a lot of that

236
00:10:21,240 --> 00:10:29,100
happens actually the post to various

237
00:10:25,710 --> 00:10:31,740
valve forums that are linked to key

238
00:10:29,100 --> 00:10:33,120
loggers and<font color="#E5E5E5"> trojans and stuff and when</font>

239
00:10:31,740 --> 00:10:34,860
<font color="#E5E5E5">the shadow server guys were looking at</font>

240
00:10:33,120 --> 00:10:37,560
this<font color="#E5E5E5"> they found that there was a um</font>

241
00:10:34,860 --> 00:10:42,030
whenever you<font color="#E5E5E5"> got a 404 error on this</font>

242
00:10:37,560 --> 00:10:44,550
website it would include a test HTM file

243
00:10:42,030 --> 00:10:48,959
an iframe they would just load one of

244
00:10:44,550 --> 00:10:50,370
these random while screenshots with kind

245
00:10:48,960 --> 00:10:53,650
<font color="#E5E5E5">of interesting</font>

246
00:10:50,370 --> 00:10:56,050
alternate tags and it's all about<font color="#E5E5E5"> this</font>

247
00:10:53,650 --> 00:10:58,329
<font color="#CCCCCC">stuff I am the red which I</font><font color="#E5E5E5"> don't play</font>

248
00:10:56,050 --> 00:11:01,150
wow so I didn't really<font color="#E5E5E5"> have any idea</font>

249
00:10:58,330 --> 00:11:04,210
what<font color="#E5E5E5"> this was at all I'm</font><font color="#CCCCCC"> actually to go</font>

250
00:11:01,150 --> 00:11:06,459
do some<font color="#CCCCCC"> research on it and found out</font>

251
00:11:04,210 --> 00:11:08,860
actually the<font color="#CCCCCC"> shadow server guys continue</font>

252
00:11:06,460 --> 00:11:11,530
to<font color="#E5E5E5"> look at it and they found this this</font>

253
00:11:08,860 --> 00:11:14,200
post that the ret paladin which

254
00:11:11,530 --> 00:11:16,900
apparently is some wow character that's

255
00:11:14,200 --> 00:11:18,760
really good at a player killing so

256
00:11:16,900 --> 00:11:22,360
everyone loves to hate on them and some

257
00:11:18,760 --> 00:11:24,310
guy made this rather humorous post I'm

258
00:11:22,360 --> 00:11:26,890
not sure<font color="#E5E5E5"> of you guys can read that about</font>

259
00:11:24,310 --> 00:11:28,719
i am<font color="#CCCCCC"> the ret i am you know leapt in I</font>

260
00:11:26,890 --> 00:11:34,240
kill people<font color="#CCCCCC"> and all kinds of good stuff</font>

261
00:11:28,720 --> 00:11:36,640
and this got a pretty good following and

262
00:11:34,240 --> 00:11:39,580
lots of lolz and the<font color="#E5E5E5"> wild communities so</font>

263
00:11:36,640 --> 00:11:41,500
what these guys<font color="#E5E5E5"> started do is just take</font>

264
00:11:39,580 --> 00:11:44,890
this same<font color="#CCCCCC"> thing and there's a little</font>

265
00:11:41,500 --> 00:11:47,500
<font color="#E5E5E5">flash file here at the end they take</font>

266
00:11:44,890 --> 00:11:50,170
that that flash link and just redirect

267
00:11:47,500 --> 00:11:52,510
it to that test<font color="#E5E5E5"> at HTM and so you'd get</font>

268
00:11:50,170 --> 00:11:54,040
<font color="#E5E5E5">a random screenshot and the same time</font>

269
00:11:52,510 --> 00:11:58,300
you downloading a keylogger in a

270
00:11:54,040 --> 00:12:01,959
password<font color="#CCCCCC"> stealer for a while they also</font>

271
00:11:58,300 --> 00:12:04,599
did that with another post something

272
00:12:01,960 --> 00:12:06,400
about some giant Alliance raid but<font color="#E5E5E5"> again</font>

273
00:12:04,600 --> 00:12:08,530
out really play a while so I don't know

274
00:12:06,400 --> 00:12:11,110
<font color="#CCCCCC">one one good thing</font><font color="#E5E5E5"> i can say to defend</font>

275
00:12:08,530 --> 00:12:12,670
against that play nethack it's a much

276
00:12:11,110 --> 00:12:17,020
<font color="#CCCCCC">better game and no one would give you a</font>

277
00:12:12,670 --> 00:12:19,150
<font color="#CCCCCC">trojan tries to your</font><font color="#E5E5E5"> password later on</font>

278
00:12:17,020 --> 00:12:21,220
in<font color="#CCCCCC"> may this may was actually a pretty</font>

279
00:12:19,150 --> 00:12:24,579
big month for the sequel injection may

280
00:12:21,220 --> 00:12:26,320
and june were both significant up tix in

281
00:12:24,580 --> 00:12:29,650
May the<font color="#E5E5E5"> Russians decide to start getting</font>

282
00:12:26,320 --> 00:12:33,580
<font color="#E5E5E5">involved the guys behind this lob trojan</font>

283
00:12:29,650 --> 00:12:36,939
or also the dns change our Trojan they

284
00:12:33,580 --> 00:12:39,120
decide to go after a PHP bulletin board

285
00:12:36,940 --> 00:12:43,840
and instead<font color="#E5E5E5"> of doing sequel injection</font>

286
00:12:39,120 --> 00:12:46,090
they actually<font color="#CCCCCC"> went for a remote file</font>

287
00:12:43,840 --> 00:12:47,530
inclusion and as you can tell by the

288
00:12:46,090 --> 00:12:51,310
number of websites<font color="#CCCCCC"> they</font><font color="#E5E5E5"> did pretty well</font>

289
00:12:47,530 --> 00:12:53,589
they got<font color="#CCCCCC"> over 800,000 websites and again</font>

290
00:12:51,310 --> 00:12:57,250
just insert this little script source

291
00:12:53,590 --> 00:12:58,810
equals going to a<font color="#E5E5E5"> JavaScript and you'll</font>

292
00:12:57,250 --> 00:12:59,830
notice<font color="#CCCCCC"> that a lot</font><font color="#E5E5E5"> of these and I'm not</font>

293
00:12:58,810 --> 00:13:02,140
<font color="#CCCCCC">sure if that's because</font><font color="#E5E5E5"> it's the same</font>

294
00:12:59,830 --> 00:13:06,330
tool or just because they stole the code

295
00:13:02,140 --> 00:13:09,610
usually uses<font color="#CCCCCC"> JavaScript files r 1j s bjs</font>

296
00:13:06,330 --> 00:13:12,100
fjs a bit later they actually got a bit

297
00:13:09,610 --> 00:13:14,710
more involved and start using like

298
00:13:12,100 --> 00:13:17,620
script<font color="#CCCCCC"> j</font><font color="#E5E5E5"> s style j/s things are a bit</font>

299
00:13:14,710 --> 00:13:19,240
harder to filter because I mean it's

300
00:13:17,620 --> 00:13:20,530
pretty obvious if you're<font color="#E5E5E5"> going if you</font>

301
00:13:19,240 --> 00:13:22,570
see a link to something it's<font color="#CCCCCC"> like you</font>

302
00:13:20,530 --> 00:13:26,079
know blah blah blah<font color="#E5E5E5"> random characters</font>

303
00:13:22,570 --> 00:13:28,180
dot are you / 1<font color="#CCCCCC"> j s it's something fishy</font>

304
00:13:26,080 --> 00:13:32,830
is going on and you probably don't

305
00:13:28,180 --> 00:13:34,630
really want<font color="#CCCCCC"> to go there see this one was</font>

306
00:13:32,830 --> 00:13:37,840
actually the sobs done a couple of

307
00:13:34,630 --> 00:13:39,880
different kinds of<font color="#E5E5E5"> attacks sometimes the</font>

308
00:13:37,840 --> 00:13:42,580
windows pop up attack where you know

309
00:13:39,880 --> 00:13:47,530
your computer is a virus like the AV

310
00:13:42,580 --> 00:13:49,690
2009 stuff download this to fix it this

311
00:13:47,530 --> 00:13:51,850
one was actually a video codecs one

312
00:13:49,690 --> 00:13:55,240
where you know you go<font color="#E5E5E5"> this site and they</font>

313
00:13:51,850 --> 00:13:57,420
say<font color="#E5E5E5"> oh hot naked ladies or you know</font>

314
00:13:55,240 --> 00:14:00,220
George Bush falling and hitting his head

315
00:13:57,420 --> 00:14:02,800
just download install this codex and you

316
00:14:00,220 --> 00:14:07,240
can see it which of course you get

317
00:14:02,800 --> 00:14:09,160
nothing at then accepted a<font color="#CCCCCC"> Trojan and</font>

318
00:14:07,240 --> 00:14:12,430
this is the the one that I<font color="#CCCCCC"> really got</font>

319
00:14:09,160 --> 00:14:14,980
<font color="#CCCCCC">into is ass Brock's which I</font><font color="#E5E5E5"> I'm a guy's</font>

320
00:14:12,430 --> 00:14:19,030
you have heard of<font color="#E5E5E5"> a</font><font color="#CCCCCC"> sports before many</font>

321
00:14:14,980 --> 00:14:21,730
<font color="#E5E5E5">okay this is kind of the big 800-pound</font>

322
00:14:19,030 --> 00:14:24,790
gorilla of the<font color="#E5E5E5"> mass sequel injections</font>

323
00:14:21,730 --> 00:14:27,730
it's a botnet it was<font color="#E5E5E5"> originally based</font>

324
00:14:24,790 --> 00:14:29,800
upon a Trojan called damik there was

325
00:14:27,730 --> 00:14:31,030
<font color="#CCCCCC">just a generic password stealing Trojan</font>

326
00:14:29,800 --> 00:14:34,780
you know go try and steal your

327
00:14:31,030 --> 00:14:36,310
credentials for this or that and as the

328
00:14:34,780 --> 00:14:39,240
bad guys buying this stuff tend to do

329
00:14:36,310 --> 00:14:43,089
they then expanded that<font color="#E5E5E5"> into a full</font>

330
00:14:39,240 --> 00:14:46,750
crime we're family such that it would on

331
00:14:43,090 --> 00:14:49,560
push updates talk back to control and

332
00:14:46,750 --> 00:14:52,390
command servers all kinds<font color="#E5E5E5"> of fun stuff</font>

333
00:14:49,560 --> 00:14:54,910
right now<font color="#E5E5E5"> it's mostly used for phishing</font>

334
00:14:52,390 --> 00:14:58,480
emails and just generic spam it was one

335
00:14:54,910 --> 00:15:00,699
of<font color="#E5E5E5"> the big spam botnets of 2008</font><font color="#CCCCCC"> they're</font>

336
00:14:58,480 --> 00:15:03,820
believed pretty strongly to be working

337
00:15:00,700 --> 00:15:05,830
with the rockfish gang which is a more

338
00:15:03,820 --> 00:15:09,870
the guys behind most most of the

339
00:15:05,830 --> 00:15:09,870
phishing emails there in arm

340
00:15:09,890 --> 00:15:14,970
<font color="#CCCCCC">romania thank you romania</font><font color="#E5E5E5"> is also it's</font>

341
00:15:13,350 --> 00:15:16,260
amazing<font color="#CCCCCC"> i think some of the countries</font>

342
00:15:14,970 --> 00:15:17,940
that this stuff comes<font color="#CCCCCC"> from because</font>

343
00:15:16,260 --> 00:15:21,660
everyone knows you know China and Russia

344
00:15:17,940 --> 00:15:24,900
are really big on<font color="#E5E5E5"> this stuff but Romania</font>

345
00:15:21,660 --> 00:15:26,640
<font color="#CCCCCC">is also big turkey I thought</font><font color="#E5E5E5"> something</font>

346
00:15:24,900 --> 00:15:28,890
was kind<font color="#E5E5E5"> of amusing a few months ago</font>

347
00:15:26,640 --> 00:15:31,500
there was actually a guy who snitched on

348
00:15:28,890 --> 00:15:34,290
some hackers in Turkey and he got

349
00:15:31,500 --> 00:15:35,490
kidnapped off the street and then they

350
00:15:34,290 --> 00:15:38,250
released photos him holding a little

351
00:15:35,490 --> 00:15:40,440
<font color="#E5E5E5">sign sticking out I am rat I am bitch</font><font color="#CCCCCC"> I</font>

352
00:15:38,250 --> 00:15:43,680
snitched on whatever this guy's handle

353
00:15:40,440 --> 00:15:46,260
was and I mean those guys play for real

354
00:15:43,680 --> 00:15:50,040
I mean<font color="#E5E5E5"> everyone kind of like the rbn is</font>

355
00:15:46,260 --> 00:15:51,720
is mafia involved but<font color="#E5E5E5"> you know at least</font>

356
00:15:50,040 --> 00:15:53,250
here in America<font color="#CCCCCC"> we don't have to worry</font>

357
00:15:51,720 --> 00:15:59,089
about you<font color="#E5E5E5"> know being snatched off the</font>

358
00:15:53,250 --> 00:15:59,089
street by bad guys by the<font color="#E5E5E5"> FBI maybe oh</font>

359
00:16:00,020 --> 00:16:06,120
<font color="#E5E5E5">okay I'm sorry the rbn is the Russian</font>

360
00:16:03,060 --> 00:16:09,390
business Network it's a kind of

361
00:16:06,120 --> 00:16:12,270
metastasis but for a long time<font color="#CCCCCC"> it was</font>

362
00:16:09,390 --> 00:16:14,790
doing a lot of the badness out of Russia

363
00:16:12,270 --> 00:16:16,339
and uh they actually moved servers off

364
00:16:14,790 --> 00:16:20,099
to Turkey and in some of the other areas

365
00:16:16,339 --> 00:16:21,690
<font color="#E5E5E5">but they were doing a lot of</font><font color="#CCCCCC"> charting</font>

366
00:16:20,100 --> 00:16:28,140
<font color="#E5E5E5">what's missing you know what would</font>

367
00:16:21,690 --> 00:16:30,150
specific stuff they were doing yeah they

368
00:16:28,140 --> 00:16:32,069
were<font color="#CCCCCC"> running hosting services for</font>

369
00:16:30,150 --> 00:16:33,750
colleague bulletproof hosting should you

370
00:16:32,070 --> 00:16:37,080
guys move that's where you know spammers

371
00:16:33,750 --> 00:16:38,880
go to pay 10 grand a month to all be

372
00:16:37,080 --> 00:16:41,810
able<font color="#CCCCCC"> to send spam and do all kinds of</font>

373
00:16:38,880 --> 00:16:44,460
nasty<font color="#E5E5E5"> stuff the rbn would basically</font>

374
00:16:41,810 --> 00:16:49,199
lease out their facilities<font color="#E5E5E5"> there their</font>

375
00:16:44,460 --> 00:16:50,760
server space and stuff yeah well did a

376
00:16:49,200 --> 00:16:53,540
lot of<font color="#CCCCCC"> people think the Russian mafia</font>

377
00:16:50,760 --> 00:16:56,450
controls and there's allegations of KGB

378
00:16:53,540 --> 00:16:58,980
influence there was actually an<font color="#E5E5E5"> American</font>

379
00:16:56,450 --> 00:17:01,820
security researcher who is from Russia

380
00:16:58,980 --> 00:17:04,500
who actually made the mistake of

381
00:17:01,820 --> 00:17:07,650
commenting that the<font color="#CCCCCC"> KGB was linked</font><font color="#E5E5E5"> up</font>

382
00:17:04,500 --> 00:17:12,900
the rbn on record so I<font color="#E5E5E5"> don't think he</font>

383
00:17:07,650 --> 00:17:14,819
can go home again and in May May twelfth

384
00:17:12,900 --> 00:17:16,709
<font color="#E5E5E5">of 2008 notice exactly because one of my</font>

385
00:17:14,819 --> 00:17:18,688
colleagues Joe Stewart actually monitors

386
00:17:16,709 --> 00:17:21,990
the spot net and a lot<font color="#CCCCCC"> of others they</font>

387
00:17:18,689 --> 00:17:24,360
pushed out a new binary I ms<font color="#E5E5E5"> center</font>

388
00:17:21,990 --> 00:17:26,390
security center extension which then

389
00:17:24,359 --> 00:17:30,629
installed itself as that service and

390
00:17:26,390 --> 00:17:33,929
this was the the sequel attack component

391
00:17:30,630 --> 00:17:35,910
to ask Brock's it's got two basic things

392
00:17:33,929 --> 00:17:40,110
it'll go like everything else go look

393
00:17:35,910 --> 00:17:43,470
for google look for an ASP and then in

394
00:17:40,110 --> 00:17:45,059
the URL it's just a looks for different

395
00:17:43,470 --> 00:17:49,950
<font color="#E5E5E5">kinds of variable somebody possibly</font>

396
00:17:45,059 --> 00:17:52,220
vulnerable to sequel injection another

397
00:17:49,950 --> 00:17:54,270
thing that ass<font color="#CCCCCC"> profs does really well is</font>

398
00:17:52,220 --> 00:17:56,610
upgrading to the latest and grace you

399
00:17:54,270 --> 00:17:58,980
saw they stole this on this<font color="#E5E5E5"> sequel</font>

400
00:17:56,610 --> 00:18:01,350
injection stuff from the<font color="#E5E5E5"> Chinese which</font>

401
00:17:58,980 --> 00:18:03,000
again this happened in May<font color="#CCCCCC"> sands</font>

402
00:18:01,350 --> 00:18:07,350
published that the tool was available in

403
00:18:03,000 --> 00:18:10,170
<font color="#E5E5E5">April</font><font color="#CCCCCC"> so could be a coincidence</font><font color="#E5E5E5"> but both</font>

404
00:18:07,350 --> 00:18:13,830
those lob guys and ass Brock's both went

405
00:18:10,170 --> 00:18:15,480
after stuff in may and april and again

406
00:18:13,830 --> 00:18:18,809
in May marked out if you remember this

407
00:18:15,480 --> 00:18:21,210
inhuman flash exploit where he was doing

408
00:18:18,809 --> 00:18:25,260
all kinds of crazy stuff I believe he

409
00:18:21,210 --> 00:18:27,890
had on actual<font color="#E5E5E5"> shellcode that was at</font>

410
00:18:25,260 --> 00:18:30,860
various times be interpreted as both um

411
00:18:27,890 --> 00:18:34,280
<font color="#E5E5E5">ActionScript byte code for flash and</font>

412
00:18:30,860 --> 00:18:38,250
also for the actual shellcode for all

413
00:18:34,280 --> 00:18:41,809
the exploit and I I can't<font color="#E5E5E5"> really follow</font>

414
00:18:38,250 --> 00:18:45,870
that<font color="#E5E5E5"> I'm not that lead but these guys</font>

415
00:18:41,809 --> 00:18:47,850
apparently<font color="#CCCCCC"> a month later</font><font color="#E5E5E5"> or two knows he</font>

416
00:18:45,870 --> 00:18:52,169
released in late May and it was in June

417
00:18:47,850 --> 00:18:54,090
so a little bit later add this to asp

418
00:18:52,170 --> 00:18:55,740
rocks and when this was when this

419
00:18:54,090 --> 00:18:56,909
exploit was first being seen i think was

420
00:18:55,740 --> 00:18:59,390
actually the<font color="#E5E5E5"> chinese they were doing it</font>

421
00:18:56,910 --> 00:19:01,440
first it was believed to be an<font color="#E5E5E5"> oday</font>

422
00:18:59,390 --> 00:19:03,210
because no one had seen something like

423
00:19:01,440 --> 00:19:04,620
this before and then later people

424
00:19:03,210 --> 00:19:06,570
<font color="#E5E5E5">realized oh no</font><font color="#CCCCCC"> wait that's</font><font color="#E5E5E5"> that's a</font>

425
00:19:04,620 --> 00:19:11,399
crazy stuff that<font color="#E5E5E5"> the mark marked out was</font>

426
00:19:06,570 --> 00:19:13,230
doing so they looked at it that way see

427
00:19:11,400 --> 00:19:15,950
and just<font color="#E5E5E5"> to go over this is some of the</font>

428
00:19:13,230 --> 00:19:19,679
code<font color="#E5E5E5"> being used by this doe initially</font>

429
00:19:15,950 --> 00:19:22,620
inject the link to bjs this is<font color="#E5E5E5"> pretty</font>

430
00:19:19,679 --> 00:19:24,990
simple it creates a cookie sets an

431
00:19:22,620 --> 00:19:28,590
expiration time and just kind of sends

432
00:19:24,990 --> 00:19:30,780
you on an iframe through to the next

433
00:19:28,590 --> 00:19:34,629
page

434
00:19:30,780 --> 00:19:37,210
which this is then the the add HTML<font color="#E5E5E5"> and</font>

435
00:19:34,630 --> 00:19:43,780
it's just just some basic version

436
00:19:37,210 --> 00:19:45,250
checking it looks flash 115 was the

437
00:19:43,780 --> 00:19:47,379
latest<font color="#E5E5E5"> version</font><font color="#CCCCCC"> who</font><font color="#E5E5E5"> was affected</font><font color="#CCCCCC"> by this</font>

438
00:19:45,250 --> 00:19:49,600
flaw I'm guessing there was something

439
00:19:47,380 --> 00:19:51,040
slightly different about the 47 version

440
00:19:49,600 --> 00:19:54,549
because they give you two different

441
00:19:51,040 --> 00:19:58,120
flash files either advert swf or banner

442
00:19:54,549 --> 00:20:01,420
<font color="#E5E5E5">on swf and just depending which flash</font>

443
00:19:58,120 --> 00:20:03,070
you have<font color="#CCCCCC"> I'm actually go over the</font>

444
00:20:01,420 --> 00:20:06,040
details of the expo itself because like

445
00:20:03,070 --> 00:20:07,570
I said I'm just<font color="#CCCCCC"> not that</font><font color="#E5E5E5"> elite but if</font>

446
00:20:06,040 --> 00:20:10,570
you look<font color="#E5E5E5"> at in hex you can see it</font>

447
00:20:07,570 --> 00:20:14,070
there's actually a link to an executable

448
00:20:10,570 --> 00:20:17,020
which is a slightly different one for

449
00:20:14,070 --> 00:20:19,928
the banner and the advert flash files

450
00:20:17,020 --> 00:20:24,280
but they both just basically end up

451
00:20:19,929 --> 00:20:26,770
being asked<font color="#CCCCCC"> Brock's Trojans that then</font>

452
00:20:24,280 --> 00:20:28,780
you know take<font color="#E5E5E5"> over your box and you</font>

453
00:20:26,770 --> 00:20:32,950
start sending out spam and fish and and

454
00:20:28,780 --> 00:20:35,918
what have you another really<font color="#E5E5E5"> click it</font>

455
00:20:32,950 --> 00:20:38,700
any of<font color="#E5E5E5"> you familiar with that one this</font>

456
00:20:35,919 --> 00:20:41,740
this one is does some really nasty

457
00:20:38,700 --> 00:20:43,570
obvious cated<font color="#CCCCCC"> JavaScript like I mean</font>

458
00:20:41,740 --> 00:20:45,010
these guys have done<font color="#E5E5E5"> several different</font>

459
00:20:43,570 --> 00:20:46,780
<font color="#CCCCCC">things</font><font color="#E5E5E5"> to offer you skate stuff usually</font>

460
00:20:45,010 --> 00:20:48,669
it's it's pretty simple stuff<font color="#CCCCCC"> like you</font>

461
00:20:46,780 --> 00:20:50,320
know<font color="#E5E5E5"> you're instantiating activex</font>

462
00:20:48,669 --> 00:20:52,600
control we've got that nice long good

463
00:20:50,320 --> 00:20:54,939
they'll just break<font color="#CCCCCC"> that up so if you've</font>

464
00:20:52,600 --> 00:20:56,770
gotten you just a simple<font color="#E5E5E5"> IDs you can't</font>

465
00:20:54,940 --> 00:20:58,270
<font color="#E5E5E5">just look for the whole string and</font>

466
00:20:56,770 --> 00:21:02,470
they'll do things like<font color="#CCCCCC"> that or breaking</font>

467
00:20:58,270 --> 00:21:04,330
up you know eval or or just or location

468
00:21:02,470 --> 00:21:06,790
at<font color="#E5E5E5"> href for different things</font><font color="#CCCCCC"> to just</font><font color="#E5E5E5"> you</font>

469
00:21:04,330 --> 00:21:08,678
<font color="#CCCCCC">know kind</font><font color="#E5E5E5"> of pop out and scream this is</font>

470
00:21:06,790 --> 00:21:10,928
bad in two different variables<font color="#CCCCCC"> and be</font>

471
00:21:08,679 --> 00:21:12,850
combining them these<font color="#E5E5E5"> guys go a lot</font>

472
00:21:10,929 --> 00:21:15,490
further one things they do is they

473
00:21:12,850 --> 00:21:16,870
randomized all the function names as

474
00:21:15,490 --> 00:21:19,929
you'll see in a min so they're<font color="#E5E5E5"> just all</font>

475
00:21:16,870 --> 00:21:22,149
random characters you you can't keep

476
00:21:19,929 --> 00:21:24,669
<font color="#E5E5E5">them the same from one to one there's no</font>

477
00:21:22,150 --> 00:21:28,210
real use to just write filters for just

478
00:21:24,669 --> 00:21:29,950
the name it's not terribly prevalent in

479
00:21:28,210 --> 00:21:32,910
<font color="#CCCCCC">the wild it's pretty expensive as far as</font>

480
00:21:29,950 --> 00:21:34,960
malware kids go it's a 1500<font color="#CCCCCC"> 23 grand</font>

481
00:21:32,910 --> 00:21:36,429
which if you're not familiar with the

482
00:21:34,960 --> 00:21:37,990
exploit kick game<font color="#E5E5E5"> I think it's kind of</font>

483
00:21:36,429 --> 00:21:42,040
<font color="#CCCCCC">funny that</font><font color="#E5E5E5"> these bad guys are actually</font>

484
00:21:37,990 --> 00:21:43,870
charging money for their wares I mean

485
00:21:42,040 --> 00:21:46,570
and they've got various differ

486
00:21:43,870 --> 00:21:49,110
ways to<font color="#CCCCCC"> try to you know make sure</font><font color="#E5E5E5"> people</font>

487
00:21:46,570 --> 00:21:51,850
actually do it correctly like the arm

488
00:21:49,110 --> 00:21:53,559
the tool that sands found it was doing

489
00:21:51,850 --> 00:21:58,090
sequel injection actually went back and

490
00:21:53,559 --> 00:22:00,340
talked<font color="#E5E5E5"> to a paid ASP script located in</font>

491
00:21:58,090 --> 00:22:02,590
China<font color="#CCCCCC"> includes some sort of a serial</font>

492
00:22:00,340 --> 00:22:05,199
number presumably for the you know

493
00:22:02,590 --> 00:22:06,669
malware as a service so that this guy

494
00:22:05,200 --> 00:22:09,250
who get paid for every time they do a

495
00:22:06,670 --> 00:22:13,950
sequel injection you know fifty cents<font color="#E5E5E5"> a</font>

496
00:22:09,250 --> 00:22:17,530
pop or dollar a pop or what have you

497
00:22:13,950 --> 00:22:18,760
what's<font color="#CCCCCC"> that yeah impacts another one</font>

498
00:22:17,530 --> 00:22:21,850
that one's actually a lot<font color="#CCCCCC"> cheaper it's</font>

499
00:22:18,760 --> 00:22:25,570
only about<font color="#E5E5E5"> $300 usually this one was</font>

500
00:22:21,850 --> 00:22:28,449
launched version one point or so is

501
00:22:25,570 --> 00:22:31,740
launching being<font color="#CCCCCC"> of 2007 and 20 was in</font>

502
00:22:28,450 --> 00:22:34,090
beta at the end of two thousand seven

503
00:22:31,740 --> 00:22:37,330
and here's<font color="#E5E5E5"> what</font><font color="#CCCCCC"> it would</font><font color="#E5E5E5"> actually look</font>

504
00:22:34,090 --> 00:22:39,490
like you<font color="#E5E5E5"> basically got a couple of</font>

505
00:22:37,330 --> 00:22:41,590
things<font color="#E5E5E5"> here I didn't read there's the</font>

506
00:22:39,490 --> 00:22:44,290
location out href<font color="#CCCCCC"> Devo everyone knows</font>

507
00:22:41,590 --> 00:22:46,470
you<font color="#CCCCCC"> val is evil right</font><font color="#E5E5E5"> now no reason oh</font>

508
00:22:44,290 --> 00:22:50,440
and<font color="#E5E5E5"> it would ever use eval for good code</font>

509
00:22:46,470 --> 00:22:52,179
and the arguments<font color="#E5E5E5"> Kali which is I think</font>

510
00:22:50,440 --> 00:22:54,460
one of more interesting things<font color="#E5E5E5"> about how</font>

511
00:22:52,179 --> 00:22:55,990
<font color="#E5E5E5">this works and it starts off this</font>

512
00:22:54,460 --> 00:22:58,660
dysfunction here which is obviously

513
00:22:55,990 --> 00:23:01,870
randomized and at the end of the script

514
00:22:58,660 --> 00:23:03,970
you've got just this huge encoded stuff

515
00:23:01,870 --> 00:23:07,270
that has<font color="#E5E5E5"> to be decrypted and this guy is</font>

516
00:23:03,970 --> 00:23:09,010
<font color="#CCCCCC">actually using real encryption because</font>

517
00:23:07,270 --> 00:23:10,960
normally what you<font color="#E5E5E5"> do when you've got a</font>

518
00:23:09,010 --> 00:23:12,490
obvious gated JavaScript you<font color="#CCCCCC"> all find</font>

519
00:23:10,960 --> 00:23:14,830
out what it is you<font color="#CCCCCC"> just find the vow</font>

520
00:23:12,490 --> 00:23:17,230
change it to an alert or document dot

521
00:23:14,830 --> 00:23:19,300
write and take a look<font color="#E5E5E5"> at it try to do it</font>

522
00:23:17,230 --> 00:23:21,790
on this one<font color="#E5E5E5"> and you just</font><font color="#CCCCCC"> get gibberish</font>

523
00:23:19,300 --> 00:23:26,200
and what they're doing<font color="#E5E5E5"> is this</font><font color="#CCCCCC"> arguments</font>

524
00:23:21,790 --> 00:23:29,200
<font color="#CCCCCC">colleague here is</font><font color="#E5E5E5"> actually the entire</font>

525
00:23:26,200 --> 00:23:32,429
function and they use the<font color="#CCCCCC"> in text of the</font>

526
00:23:29,200 --> 00:23:35,800
entire function as the key to decrypt it

527
00:23:32,429 --> 00:23:37,809
so that if you change anything by

528
00:23:35,800 --> 00:23:40,840
changing that eval to a document right

529
00:23:37,809 --> 00:23:43,928
you've just messed up<font color="#E5E5E5"> the key and now it</font>

530
00:23:40,840 --> 00:23:45,669
doesn't work so the solution to<font color="#E5E5E5"> that is</font>

531
00:23:43,929 --> 00:23:47,440
basically just<font color="#E5E5E5"> to copy the entire</font>

532
00:23:45,670 --> 00:23:52,390
function into another variable and then

533
00:23:47,440 --> 00:23:55,000
<font color="#E5E5E5">change it here's a bit of a look at the</font>

534
00:23:52,390 --> 00:23:56,210
code I've kind of<font color="#E5E5E5"> D off you scared this</font>

535
00:23:55,000 --> 00:24:01,250
and put in

536
00:23:56,210 --> 00:24:03,890
decent actual names for things as you

537
00:24:01,250 --> 00:24:05,660
can<font color="#CCCCCC"> tell</font><font color="#E5E5E5"> it's basically this it takes</font>

538
00:24:03,890 --> 00:24:09,260
this huge long string that was at<font color="#E5E5E5"> the</font>

539
00:24:05,660 --> 00:24:12,440
<font color="#E5E5E5">bottom to decode it and then it goes</font>

540
00:24:09,260 --> 00:24:14,930
through does a bunch of things assign

541
00:24:12,440 --> 00:24:17,390
some some functional keywords two

542
00:24:14,930 --> 00:24:21,200
variables it<font color="#E5E5E5"> also goes through and like</font>

543
00:24:17,390 --> 00:24:25,340
replaces some various things changes it

544
00:24:21,200 --> 00:24:27,290
around it will a call to uppercase then

545
00:24:25,340 --> 00:24:29,600
go through<font color="#CCCCCC"> and do a whole bunch of loops</font>

546
00:24:27,290 --> 00:24:33,050
and then go to<font color="#E5E5E5"> the actual decryption</font>

547
00:24:29,600 --> 00:24:34,669
code which is over here<font color="#E5E5E5"> which I'm not</font>

548
00:24:33,050 --> 00:24:36,350
<font color="#E5E5E5">terribly good at map so I can't</font><font color="#CCCCCC"> tell you</font>

549
00:24:34,670 --> 00:24:38,000
exactly how<font color="#E5E5E5"> it works but this is if you</font>

550
00:24:36,350 --> 00:24:40,730
ever seen code for encryption it's got

551
00:24:38,000 --> 00:24:42,950
you know all the nice rates to a certain

552
00:24:40,730 --> 00:24:47,450
thing and a big loop and all that<font color="#CCCCCC"> all</font>

553
00:24:42,950 --> 00:24:49,850
<font color="#CCCCCC">that good math stuff and as I mentioned</font>

554
00:24:47,450 --> 00:24:52,310
<font color="#E5E5E5">Microsoft was getting all kinds of heat</font>

555
00:24:49,850 --> 00:24:56,090
about this even though it's<font color="#E5E5E5"> not actually</font>

556
00:24:52,310 --> 00:24:59,000
a flaw in<font color="#E5E5E5"> any</font><font color="#CCCCCC"> Microsoft product still</font>

557
00:24:56,090 --> 00:25:00,709
because so many Microsoft sites were

558
00:24:59,000 --> 00:25:02,570
being attacked news only Microsoft sites

559
00:25:00,710 --> 00:25:05,330
that were targeted they<font color="#E5E5E5"> eventually had</font>

560
00:25:02,570 --> 00:25:07,879
to do something<font color="#CCCCCC"> so on june twenty-fourth</font>

561
00:25:05,330 --> 00:25:09,770
they released an advisory they released

562
00:25:07,880 --> 00:25:12,590
an updated version of something called

563
00:25:09,770 --> 00:25:16,700
URL scams basically a very basic basic

564
00:25:12,590 --> 00:25:18,050
<font color="#CCCCCC">Wow for web application firewall the</font>

565
00:25:16,700 --> 00:25:21,560
last version they'd actually released

566
00:25:18,050 --> 00:25:23,090
was 2.5 which was five years ago so

567
00:25:21,560 --> 00:25:25,429
obviously someone at Microsoft decided

568
00:25:23,090 --> 00:25:28,429
now and we can't take this anymore we've

569
00:25:25,430 --> 00:25:30,080
got<font color="#CCCCCC"> a got</font><font color="#E5E5E5"> to do something about this so</font>

570
00:25:28,430 --> 00:25:33,050
it really<font color="#CCCCCC"> it's this new version arms got</font>

571
00:25:30,080 --> 00:25:35,780
<font color="#E5E5E5">a couple new features mainly they can</font>

572
00:25:33,050 --> 00:25:38,540
scan for keywords in query strings and

573
00:25:35,780 --> 00:25:40,190
it can also decode them so that that big

574
00:25:38,540 --> 00:25:41,810
long heck string you can<font color="#E5E5E5"> just look for</font>

575
00:25:40,190 --> 00:25:44,720
stuff in that<font color="#E5E5E5"> and just look for you know</font>

576
00:25:41,810 --> 00:25:48,470
<font color="#E5E5E5">the badness and that you can also just</font>

577
00:25:44,720 --> 00:25:50,480
disable<font color="#E5E5E5"> URLs that are over a certain</font>

578
00:25:48,470 --> 00:25:55,490
size so<font color="#E5E5E5"> a real simple</font><font color="#CCCCCC"> way to avoid</font><font color="#E5E5E5"> any</font>

579
00:25:50,480 --> 00:25:57,530
of this is just<font color="#CCCCCC"> to you know not allow or</font>

580
00:25:55,490 --> 00:25:59,990
just block any<font color="#CCCCCC"> request to your web</font>

581
00:25:57,530 --> 00:26:03,500
server there over a que for almost any

582
00:25:59,990 --> 00:26:05,540
you<font color="#CCCCCC"> know normal web application</font><font color="#E5E5E5"> that</font>

583
00:26:03,500 --> 00:26:06,950
that's perfectly fine and of course<font color="#E5E5E5"> you</font>

584
00:26:05,540 --> 00:26:08,960
have to tail this to your own web app

585
00:26:06,950 --> 00:26:12,320
but unless you're<font color="#E5E5E5"> doing something really</font>

586
00:26:08,960 --> 00:26:17,210
weird like ad sites cause all kinds of

587
00:26:12,320 --> 00:26:19,939
problems for<font color="#CCCCCC"> IPS filters you'll be fine</font>

588
00:26:17,210 --> 00:26:25,600
<font color="#CCCCCC">just blocking anything over a k they</font>

589
00:26:19,940 --> 00:26:25,600
also worked with HP<font color="#CCCCCC"> formally uh yeah</font>

590
00:26:27,880 --> 00:26:33,169
<font color="#CCCCCC">microsoft websites it goes after yeah it</font>

591
00:26:31,669 --> 00:26:36,409
specifically originally<font color="#E5E5E5"> just targeted</font>

592
00:26:33,169 --> 00:26:43,070
<font color="#CCCCCC">ASP websites ASP classic and then also</font>

593
00:26:36,409 --> 00:26:45,470
went to asp net and later ColdFusion URL

594
00:26:43,070 --> 00:26:47,750
scans a web application firewall so it

595
00:26:45,470 --> 00:26:49,580
lives on the actual web server and

596
00:26:47,750 --> 00:26:51,020
basically inspects the traffic coming to

597
00:26:49,580 --> 00:26:58,370
the web server before it actually hits

598
00:26:51,020 --> 00:26:59,779
the IAS process exactly<font color="#E5E5E5"> and that's it's</font>

599
00:26:58,370 --> 00:27:01,428
nothing like<font color="#E5E5E5"> I said something particular</font>

600
00:26:59,779 --> 00:27:04,460
about<font color="#E5E5E5"> Microsoft it causes it</font><font color="#CCCCCC"> to be</font>

601
00:27:01,429 --> 00:27:05,299
attacked it's just the figure<font color="#CCCCCC"> ASP people</font>

602
00:27:04,460 --> 00:27:09,190
<font color="#E5E5E5">running yet don't really know what</font>

603
00:27:05,299 --> 00:27:09,190
they're doing probably be an easy target

604
00:27:11,799 --> 00:27:14,799
sorry

605
00:27:18,080 --> 00:27:22,250
no if you want to they're<font color="#CCCCCC"> basically two</font>

606
00:27:20,690 --> 00:27:24,710
different kinds<font color="#E5E5E5"> of attacks here there's</font>

607
00:27:22,250 --> 00:27:27,080
the injecting the code on into the web

608
00:27:24,710 --> 00:27:28,370
page which is sequel injection to

609
00:27:27,080 --> 00:27:31,129
protect against that you<font color="#E5E5E5"> have to either</font>

610
00:27:28,370 --> 00:27:32,418
write code properly so not vulnerable to

611
00:27:31,130 --> 00:27:36,110
sequin<font color="#CCCCCC"> Jack's you know parameterize</font>

612
00:27:32,419 --> 00:27:38,210
queries input sanitization all that kind

613
00:27:36,110 --> 00:27:41,240
of good stuff or include a web

614
00:27:38,210 --> 00:27:43,549
application firewall or like URL scan or

615
00:27:41,240 --> 00:27:47,269
<font color="#E5E5E5">self or other ones Ahmad securities the</font>

616
00:27:43,549 --> 00:27:49,970
<font color="#CCCCCC">Apache product</font><font color="#E5E5E5"> they will basically look</font>

617
00:27:47,269 --> 00:27:51,799
for sequel injection and block it but

618
00:27:49,970 --> 00:27:56,179
then if you're a user browsing these

619
00:27:51,799 --> 00:27:57,379
<font color="#CCCCCC">websites have</font><font color="#E5E5E5"> been</font><font color="#CCCCCC"> affected if your user</font>

620
00:27:56,179 --> 00:27:59,269
browsing these websites that have been

621
00:27:57,380 --> 00:28:01,970
infected you're going to need something

622
00:27:59,269 --> 00:28:04,970
<font color="#E5E5E5">like no script that will block this</font>

623
00:28:01,970 --> 00:28:07,760
JavaScript coming from afar and like<font color="#E5E5E5"> I</font>

624
00:28:04,970 --> 00:28:09,769
said earlier that works<font color="#E5E5E5"> but you've got</font>

625
00:28:07,760 --> 00:28:11,330
to be careful because if you want to

626
00:28:09,769 --> 00:28:14,510
make a<font color="#E5E5E5"> website work sometimes you have</font>

627
00:28:11,330 --> 00:28:16,939
<font color="#E5E5E5">to enable several different domains that</font>

628
00:28:14,510 --> 00:28:19,908
oftentimes don't see me related all to

629
00:28:16,940 --> 00:28:23,539
the original domain so if you<font color="#E5E5E5"> just allow</font>

630
00:28:19,909 --> 00:28:25,580
all<font color="#CCCCCC"> of them you're screwed also if</font><font color="#E5E5E5"> you</font>

631
00:28:23,539 --> 00:28:27,080
do then go to these depending on which

632
00:28:25,580 --> 00:28:29,480
exploit they're using you may or may not

633
00:28:27,080 --> 00:28:31,220
be vulnerable to it they<font color="#E5E5E5"> generally don't</font>

634
00:28:29,480 --> 00:28:33,409
use<font color="#CCCCCC"> otay exploits I mean</font><font color="#E5E5E5"> a lot of these</font>

635
00:28:31,220 --> 00:28:37,639
are actually from like<font color="#E5E5E5"> Microsoft patches</font>

636
00:28:33,409 --> 00:28:39,830
from 06 or 07<font color="#CCCCCC"> and these</font><font color="#E5E5E5"> are late 07 @</font>

637
00:28:37,639 --> 00:28:41,629
through OA did these attacks are going

638
00:28:39,830 --> 00:28:44,059
on showing that you know you<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> need</font>

639
00:28:41,630 --> 00:28:47,990
<font color="#CCCCCC">O'Day to actually get a lot of</font>

640
00:28:44,059 --> 00:28:49,460
compromises and like I said about this

641
00:28:47,990 --> 00:28:50,750
law of stuff it's<font color="#E5E5E5"> not you can do this</font>

642
00:28:49,460 --> 00:28:53,240
<font color="#E5E5E5">for other things besides sequel</font>

643
00:28:50,750 --> 00:28:56,659
injection they use remote file inclusion

644
00:28:53,240 --> 00:28:59,840
attacks against PHP bulletin board which

645
00:28:56,659 --> 00:29:01,610
is generally just a lot<font color="#E5E5E5"> of content</font>

646
00:28:59,840 --> 00:29:05,360
management systems in bulletin boards

647
00:29:01,610 --> 00:29:06,918
will allow you to include files and the

648
00:29:05,360 --> 00:29:08,240
idea is it's supposed to be a local<font color="#E5E5E5"> file</font>

649
00:29:06,919 --> 00:29:10,580
like you point to another file on the

650
00:29:08,240 --> 00:29:12,889
server but if there's a flaw in<font color="#E5E5E5"> the code</font>

651
00:29:10,580 --> 00:29:15,799
you<font color="#E5E5E5"> can just include from random bad</font>

652
00:29:12,889 --> 00:29:17,629
<font color="#E5E5E5">sitecom and then you've got you know</font>

653
00:29:15,799 --> 00:29:19,879
either your own code there it's how they

654
00:29:17,630 --> 00:29:22,760
do a lob defacements people also include

655
00:29:19,880 --> 00:29:25,909
a lot<font color="#CCCCCC"> of web shells which are basically</font>

656
00:29:22,760 --> 00:29:29,200
just a little PHP or whatever code that

657
00:29:25,909 --> 00:29:31,490
lets people execute commands on local

658
00:29:29,200 --> 00:29:35,929
machine by using exact or

659
00:29:31,490 --> 00:29:41,750
system or<font color="#E5E5E5"> something like that oh yeah</font>

660
00:29:35,929 --> 00:29:43,340
it's great sorry<font color="#E5E5E5"> about that and also in</font>

661
00:29:41,750 --> 00:29:45,140
<font color="#CCCCCC">addition to that they also released a</font>

662
00:29:43,340 --> 00:29:49,030
web vulnerability scanning tool is

663
00:29:45,140 --> 00:29:51,320
actually HP which had bought<font color="#CCCCCC"> websense</font>

664
00:29:49,030 --> 00:29:53,000
released a version of web inspect all

665
00:29:51,320 --> 00:29:55,100
scroll<font color="#E5E5E5"> ER it's a just really</font>

666
00:29:53,000 --> 00:29:56,660
stripped-down version just looks for

667
00:29:55,100 --> 00:29:59,559
sequel injection doesn't<font color="#E5E5E5"> look at post</font>

668
00:29:56,660 --> 00:30:03,050
forms can't actually log into websites

669
00:29:59,559 --> 00:30:06,410
but just kind of a here try this you

670
00:30:03,050 --> 00:30:08,149
know<font color="#E5E5E5"> I think they called it on defense</font>

671
00:30:06,410 --> 00:30:10,040
and inspection or something in their

672
00:30:08,150 --> 00:30:11,870
advisory some flashy shocking all<font color="#E5E5E5"> name</font>

673
00:30:10,040 --> 00:30:14,240
you know look for your vulnerabilities

674
00:30:11,870 --> 00:30:19,520
here block the attacks here kind<font color="#E5E5E5"> of</font>

675
00:30:14,240 --> 00:30:20,990
thing another piece of malicious

676
00:30:19,520 --> 00:30:22,760
<font color="#CCCCCC">javascript</font><font color="#E5E5E5"> that i found this was</font>

677
00:30:20,990 --> 00:30:26,150
<font color="#CCCCCC">actually on sands talked about some</font>

678
00:30:22,760 --> 00:30:29,420
other diary entries this is fake<font color="#E5E5E5"> yahoo</font>

679
00:30:26,150 --> 00:30:30,800
excuse me it says big yahoo toolbar but

680
00:30:29,420 --> 00:30:32,690
should say fake yahoo encounter i

681
00:30:30,800 --> 00:30:34,280
<font color="#E5E5E5">apologize i was really sick this week</font>

682
00:30:32,690 --> 00:30:39,200
when I was making<font color="#CCCCCC"> these slides it was</font>

683
00:30:34,280 --> 00:30:42,860
under heavy robitussin but this

684
00:30:39,200 --> 00:30:46,190
basically once you d off you skate all

685
00:30:42,860 --> 00:30:50,709
that will basically just again send you

686
00:30:46,190 --> 00:30:52,910
to a malicious exploit ridden<font color="#CCCCCC"> web page</font>

687
00:30:50,710 --> 00:30:55,220
this one actually is kinda interesting

688
00:30:52,910 --> 00:30:56,900
how it got there there's a certain web

689
00:30:55,220 --> 00:31:00,740
hosting provider that seems to be<font color="#E5E5E5"> having</font>

690
00:30:56,900 --> 00:31:02,660
<font color="#CCCCCC">some security issues in the I've seen</font>

691
00:31:00,740 --> 00:31:05,630
different estimates but a half or more

692
00:31:02,660 --> 00:31:07,100
of their<font color="#CCCCCC"> web sites</font><font color="#E5E5E5"> have been affected by</font>

693
00:31:05,630 --> 00:31:11,570
something like this there's other

694
00:31:07,100 --> 00:31:14,030
exploits not quite sure how<font color="#E5E5E5"> they got in</font>

695
00:31:11,570 --> 00:31:16,639
but these guys are seeing<font color="#E5E5E5"> a lot of other</font>

696
00:31:14,030 --> 00:31:19,690
issues as well their files is suddenly

697
00:31:16,640 --> 00:31:22,400
<font color="#CCCCCC">beach ahmad 2777 for no apparent reason</font>

698
00:31:19,690 --> 00:31:24,320
they'll get this stuff everywhere it

699
00:31:22,400 --> 00:31:26,809
seems to be<font color="#E5E5E5"> the database is actually</font>

700
00:31:24,320 --> 00:31:29,540
compromised because people clean

701
00:31:26,809 --> 00:31:31,340
everything out and then next thing it's

702
00:31:29,540 --> 00:31:33,500
right back there and actually a lot<font color="#CCCCCC"> of</font>

703
00:31:31,340 --> 00:31:35,209
these will actually<font color="#E5E5E5"> include rootkits so</font>

704
00:31:33,500 --> 00:31:38,059
they'll put this into your website<font color="#E5E5E5"> then</font>

705
00:31:35,210 --> 00:31:39,170
include rootkit code on your server so

706
00:31:38,059 --> 00:31:43,309
if you clean out<font color="#E5E5E5"> there just come back</font>

707
00:31:39,170 --> 00:31:44,909
<font color="#E5E5E5">and</font><font color="#CCCCCC"> put it</font><font color="#E5E5E5"> back on this guy is kind of</font>

708
00:31:43,309 --> 00:31:47,700
<font color="#E5E5E5">funny because if you run this</font>

709
00:31:44,909 --> 00:31:49,799
well I forget<font color="#CCCCCC"> what the sands</font><font color="#E5E5E5"> guys did</font>

710
00:31:47,700 --> 00:31:51,119
but if you run for<font color="#CCCCCC"> the basic trying to</font>

711
00:31:49,799 --> 00:31:53,849
obvious Kate just comes of accomplices

712
00:31:51,119 --> 00:31:56,428
just off so like I said these<font color="#CCCCCC"> guys</font>

713
00:31:53,849 --> 00:31:58,649
have a sense of humor another thing the

714
00:31:56,429 --> 00:32:00,599
associative this or again maybe just

715
00:31:58,649 --> 00:32:05,459
because these guys are compromised six

716
00:32:00,599 --> 00:32:07,439
ways from<font color="#E5E5E5"> Sunday is they get this HT</font>

717
00:32:05,460 --> 00:32:09,929
Access file that if you're coming from

718
00:32:07,440 --> 00:32:14,099
<font color="#CCCCCC">google or msn or a big search engine</font>

719
00:32:09,929 --> 00:32:17,039
just redirects you to malware yeah which

720
00:32:14,099 --> 00:32:18,149
is<font color="#E5E5E5"> nice and could subtle because if you</font>

721
00:32:17,039 --> 00:32:19,769
know if you're just<font color="#E5E5E5"> going to your</font>

722
00:32:18,149 --> 00:32:22,349
website or<font color="#E5E5E5"> if it's a front of yours just</font>

723
00:32:19,769 --> 00:32:24,059
types it in your fine but if you're just

724
00:32:22,349 --> 00:32:29,489
<font color="#E5E5E5">randomly surfing for it you know through</font>

725
00:32:24,059 --> 00:32:32,129
google or whatever nope you get out and

726
00:32:29,489 --> 00:32:34,580
looking<font color="#CCCCCC"> on to the future I</font><font color="#E5E5E5"> think this is</font>

727
00:32:32,129 --> 00:32:39,059
<font color="#CCCCCC">just going</font><font color="#E5E5E5"> to continue to happen I mean</font>

728
00:32:34,580 --> 00:32:41,428
we've seen this from really get big from

729
00:32:39,059 --> 00:32:44,220
the end of 2007 all the way through 2008

730
00:32:41,429 --> 00:32:46,349
and still happening there's still tons

731
00:32:44,220 --> 00:32:50,549
and tons of websites<font color="#E5E5E5"> that are vulnerable</font>

732
00:32:46,349 --> 00:32:52,649
to sequel injection there and that's

733
00:32:50,549 --> 00:32:54,960
just one way to attack as we saw with

734
00:32:52,649 --> 00:32:58,129
the PHP bulletin board remote file

735
00:32:54,960 --> 00:32:59,970
inclusion<font color="#E5E5E5"> they've got 800,000 websites</font>

736
00:32:58,129 --> 00:33:01,859
another thing I think<font color="#E5E5E5"> we'll continue to</font>

737
00:32:59,970 --> 00:33:03,359
see is this specialization the

738
00:33:01,859 --> 00:33:05,549
underground economy you've got ass

739
00:33:03,359 --> 00:33:07,949
Brock's which is you know great botnet

740
00:33:05,549 --> 00:33:09,450
good for sending spam good for hosting

741
00:33:07,950 --> 00:33:13,019
malicious websites they take up<font color="#E5E5E5"> with</font>

742
00:33:09,450 --> 00:33:14,700
rockfish and these guys are just the top

743
00:33:13,019 --> 00:33:17,700
of the game as far<font color="#E5E5E5"> as actual sending</font>

744
00:33:14,700 --> 00:33:20,220
Fisher emails and making good<font color="#E5E5E5"> Fisher</font>

745
00:33:17,700 --> 00:33:21,809
sites look legitimate so these guys team

746
00:33:20,220 --> 00:33:23,639
up and you know they got the ability to

747
00:33:21,809 --> 00:33:26,908
send spam the ability<font color="#CCCCCC"> to host websites</font>

748
00:33:23,639 --> 00:33:28,529
and the expertise to do it well I think

749
00:33:26,909 --> 00:33:31,679
we'll keep seeing that will keep seeing

750
00:33:28,529 --> 00:33:33,359
bad guys can you to innovate and then

751
00:33:31,679 --> 00:33:35,789
steal each other's innovations like this

752
00:33:33,359 --> 00:33:38,189
<font color="#E5E5E5">Manya the Chinese started it then the</font>

753
00:33:35,789 --> 00:33:40,470
Russians<font color="#E5E5E5"> got involved and then they</font>

754
00:33:38,190 --> 00:33:42,059
started taking<font color="#E5E5E5"> exploit kits and I mean</font>

755
00:33:40,470 --> 00:33:45,690
they might<font color="#E5E5E5"> have paid for that</font><font color="#CCCCCC"> neos Boyd</font>

756
00:33:42,059 --> 00:33:47,970
<font color="#CCCCCC">kit or the Chinese tool but I doubt it I</font>

757
00:33:45,690 --> 00:33:49,590
think we'll continue to see content

758
00:33:47,970 --> 00:33:50,909
<font color="#E5E5E5">management systems affecting</font><font color="#CCCCCC"> more</font>

759
00:33:49,590 --> 00:33:53,849
<font color="#CCCCCC">because these</font><font color="#E5E5E5"> things are</font><font color="#CCCCCC"> just completely</font>

760
00:33:50,909 --> 00:33:56,609
<font color="#E5E5E5">wide-open you know joomla and all this</font>

761
00:33:53,849 --> 00:33:57,370
<font color="#CCCCCC">stuff they're just new exploits found</font>

762
00:33:56,609 --> 00:33:59,679
them<font color="#E5E5E5"> every day</font>

763
00:33:57,370 --> 00:34:01,179
almost and a<font color="#E5E5E5"> lot of people use them</font>

764
00:33:59,680 --> 00:34:04,300
they're just<font color="#E5E5E5"> right for the picking it's</font>

765
00:34:01,180 --> 00:34:06,670
the low-hanging fruit yeah and people

766
00:34:04,300 --> 00:34:08,739
<font color="#E5E5E5">don't patch them what I think would be</font>

767
00:34:06,670 --> 00:34:11,110
really<font color="#E5E5E5"> interesting finds a novel attack</font>

768
00:34:08,739 --> 00:34:12,638
either a novel form of sequin jection

769
00:34:11,110 --> 00:34:15,960
that gets passed all of<font color="#E5E5E5"> the existing</font>

770
00:34:12,639 --> 00:34:18,700
filters or some other way<font color="#E5E5E5"> to do it and</font>

771
00:34:15,960 --> 00:34:20,830
combines out of an ode a client exploit

772
00:34:18,699 --> 00:34:24,250
and then you'll have<font color="#E5E5E5"> a whole bunch of</font>

773
00:34:20,830 --> 00:34:25,600
people going<font color="#CCCCCC"> through you know tons</font>

774
00:34:24,250 --> 00:34:28,360
probably hundreds of thousands<font color="#CCCCCC"> of</font>

775
00:34:25,600 --> 00:34:29,679
websites infected and then there's no

776
00:34:28,360 --> 00:34:32,409
defense in the client<font color="#CCCCCC"> site except for</font>

777
00:34:29,679 --> 00:34:34,450
something<font color="#E5E5E5"> like no script and speaking of</font>

778
00:34:32,409 --> 00:34:36,340
this this<font color="#CCCCCC"> is on something I'd seen</font>

779
00:34:34,449 --> 00:34:39,040
recently I'm<font color="#CCCCCC"> not really sure who's doing</font>

780
00:34:36,340 --> 00:34:40,570
its these<font color="#E5E5E5"> arm sequel injection just</font>

781
00:34:39,040 --> 00:34:42,100
recon scans doesn't actually do anything

782
00:34:40,570 --> 00:34:45,159
malicious just tries to get a list<font color="#E5E5E5"> of</font>

783
00:34:42,100 --> 00:34:49,569
your tables coming from a user agent<font color="#CCCCCC"> NB</font>

784
00:34:45,159 --> 00:34:52,450
<font color="#CCCCCC">3 2 ts coming from multiple IPS they</font>

785
00:34:49,570 --> 00:34:53,379
don't match any known botnets so I don't

786
00:34:52,449 --> 00:34:55,899
know what<font color="#E5E5E5"> they're doing but they could</font>

787
00:34:53,379 --> 00:34:58,049
very well be compiling a list of sites

788
00:34:55,899 --> 00:35:00,850
known to be<font color="#E5E5E5"> vulnerable they can just go</font>

789
00:34:58,050 --> 00:35:02,590
attack all at once one day actually if

790
00:35:00,850 --> 00:35:10,080
anyone does have to know what<font color="#E5E5E5"> that is</font>

791
00:35:02,590 --> 00:35:10,080
<font color="#CCCCCC">please let me know questions comments</font>

792
00:35:12,530 --> 00:35:27,440
ok

793
00:35:14,780 --> 00:35:32,090
well yes not on camera I'll be around

794
00:35:27,440 --> 00:35:34,490
<font color="#E5E5E5">later here are some references and</font><font color="#CCCCCC"> for</font>

795
00:35:32,090 --> 00:35:37,670
other questions I've got a few other

796
00:35:34,490 --> 00:35:40,279
just uh code samples here this is a

797
00:35:37,670 --> 00:35:43,070
relatively recent one from asp rocks

798
00:35:40,280 --> 00:35:44,300
it's just from january of this year just

799
00:35:43,070 --> 00:35:45,710
showing you some of the different other

800
00:35:44,300 --> 00:35:48,230
kinds<font color="#E5E5E5"> of encryption yell a neat thing</font>

801
00:35:45,710 --> 00:35:53,150
here is they're looking<font color="#E5E5E5"> for very</font>

802
00:35:48,230 --> 00:35:56,600
specific character sets so like no

803
00:35:53,150 --> 00:35:57,530
<font color="#CCCCCC">Chinese I think that's</font><font color="#E5E5E5"> Korean and i'm</font>

804
00:35:56,600 --> 00:36:00,500
not<font color="#E5E5E5"> sure</font><font color="#CCCCCC"> what some of these other guys</font>

805
00:35:57,530 --> 00:36:02,600
are but they in the malware market

806
00:36:00,500 --> 00:36:04,910
different countries are<font color="#E5E5E5"> more valuable</font>

807
00:36:02,600 --> 00:36:07,069
than others just<font color="#E5E5E5"> like you know Carter's</font>

808
00:36:04,910 --> 00:36:09,890
will sell credit cards and the better

809
00:36:07,070 --> 00:36:12,470
complete is and so on silver of

810
00:36:09,890 --> 00:36:13,879
different values a known bought<font color="#CCCCCC"> a known</font>

811
00:36:12,470 --> 00:36:17,270
computer in America is worth a lot more

812
00:36:13,880 --> 00:36:18,770
than own computer in China and for a

813
00:36:17,270 --> 00:36:20,240
while the the Chinese underground seem

814
00:36:18,770 --> 00:36:22,730
to be a bit reluctant to attack other

815
00:36:20,240 --> 00:36:25,250
Chinese sites also oh that is changing

816
00:36:22,730 --> 00:36:28,360
<font color="#CCCCCC">now live in some</font><font color="#E5E5E5"> China on china doll</font>

817
00:36:25,250 --> 00:36:28,360
situations going on

818
00:36:29,040 --> 00:36:40,980
what's<font color="#CCCCCC"> that oh yeah what's that</font>

819
00:36:36,650 --> 00:36:44,240
indonesia<font color="#E5E5E5"> okay and this is just some</font>

820
00:36:40,980 --> 00:36:46,620
<font color="#E5E5E5">other stuff same guys the next fall in</font>

821
00:36:44,240 --> 00:36:50,879
just showing how they kind of do a

822
00:36:46,620 --> 00:36:53,640
little bit of obfuscation this is

823
00:36:50,880 --> 00:36:55,320
another one from<font color="#E5E5E5"> I think the beginning</font>

824
00:36:53,640 --> 00:36:57,120
<font color="#E5E5E5">of this year this</font><font color="#CCCCCC"> is a Chinese my blues</font>

825
00:36:55,320 --> 00:36:59,280
mother just random<font color="#E5E5E5"> Chinese tools not</font>

826
00:36:57,120 --> 00:37:00,509
<font color="#E5E5E5">related to ask Brock's not sure it's</font>

827
00:36:59,280 --> 00:37:02,190
actually a botnet or just people

828
00:37:00,510 --> 00:37:04,320
individually just using this tool to go

829
00:37:02,190 --> 00:37:06,120
through it let's just shows you a little

830
00:37:04,320 --> 00:37:10,500
bit of the browser fingerprinting

831
00:37:06,120 --> 00:37:12,270
they'll do you know if you've<font color="#CCCCCC"> got ie6 do</font>

832
00:37:10,500 --> 00:37:15,780
this you've got ie7 do that if you've

833
00:37:12,270 --> 00:37:17,840
got<font color="#CCCCCC"> Firefox just write a line so I'm</font><font color="#E5E5E5"> not</font>

834
00:37:15,780 --> 00:37:21,000
I guess they don't want<font color="#CCCCCC"> to compromise</font>

835
00:37:17,840 --> 00:37:33,420
Firefox I mean they<font color="#CCCCCC"> just don't have any</font>

836
00:37:21,000 --> 00:37:34,890
exploits for it yeah yeah it's mainly

837
00:37:33,420 --> 00:37:37,140
JavaScript eccentric on so<font color="#E5E5E5"> I'm actually</font>

838
00:37:34,890 --> 00:37:38,580
to use VBS tribute time but oh but web

839
00:37:37,140 --> 00:37:42,210
to a point of law gives you time like I

840
00:37:38,580 --> 00:37:44,370
Ajax or<font color="#E5E5E5"> I'm Ajax is still JavaScript so</font>

841
00:37:42,210 --> 00:37:45,870
I mean<font color="#E5E5E5"> really the real thing about web</font>

842
00:37:44,370 --> 00:37:47,970
two point I<font color="#CCCCCC"> think the real challenge we</font>

843
00:37:45,870 --> 00:37:50,040
have there is the whole idea of web two

844
00:37:47,970 --> 00:37:53,520
point O is running arbitrary code from

845
00:37:50,040 --> 00:37:56,580
untrusted sources how do you do that you

846
00:37:53,520 --> 00:37:57,780
can you know try and examine the<font color="#E5E5E5"> code</font>

847
00:37:56,580 --> 00:38:00,380
then you just run to the halting problem

848
00:37:57,780 --> 00:38:03,240
where if you're<font color="#E5E5E5"> going to run</font><font color="#CCCCCC"> the code</font>

849
00:38:00,380 --> 00:38:05,580
you know you you can't do that<font color="#E5E5E5"> unless</font>

850
00:38:03,240 --> 00:38:06,959
you actually run in a sandbox and then

851
00:38:05,580 --> 00:38:09,270
running a sandbox get lots<font color="#E5E5E5"> of problems</font>

852
00:38:06,960 --> 00:38:11,160
of user interaction did it stopped

853
00:38:09,270 --> 00:38:13,470
because I didn't click here or what have

854
00:38:11,160 --> 00:38:16,680
you I think that's that's<font color="#E5E5E5"> really the</font>

855
00:38:13,470 --> 00:38:19,319
<font color="#E5E5E5">next big issue in computer security is</font>

856
00:38:16,680 --> 00:38:21,080
how to do a BBQ are entrusted code you

857
00:38:19,320 --> 00:38:23,730
could try a reputation sister damn it

858
00:38:21,080 --> 00:38:26,310
you<font color="#CCCCCC"> could try a reputation system of</font>

859
00:38:23,730 --> 00:38:28,890
some kind but that gets kind of iffy<font color="#E5E5E5"> too</font>

860
00:38:26,310 --> 00:38:30,060
because like you're seeing here people

861
00:38:28,890 --> 00:38:32,609
would just attack the people of a good

862
00:38:30,060 --> 00:38:34,850
reputation and then insert their code

863
00:38:32,610 --> 00:38:34,850
there

864
00:38:35,720 --> 00:38:41,089
this is<font color="#CCCCCC"> just a bit more of</font><font color="#E5E5E5"> some other</font>

865
00:38:39,349 --> 00:38:44,200
kind of encryption they do or off East

866
00:38:41,090 --> 00:38:49,510
occasionally<font color="#E5E5E5"> is in real encryption and</font>

867
00:38:44,200 --> 00:38:49,509
think yeah so I got any other questions

868
00:38:50,830 --> 00:38:54,560
not yet but I figured I'd put them onto

869
00:38:53,270 --> 00:38:55,970
if Scott<font color="#CCCCCC"> augas</font><font color="#E5E5E5"> gonna pull</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> anywhere</font>

870
00:38:54,560 --> 00:38:57,500
not but i'll make them<font color="#E5E5E5"> available you</font>

871
00:38:55,970 --> 00:39:03,589
just drop me an email and chapman<font color="#E5E5E5"> it</font>

872
00:38:57,500 --> 00:39:13,570
<font color="#E5E5E5">secure works yes cool yeah i'll give you</font>

873
00:39:03,590 --> 00:39:13,570
a copy then where you can download them

874
00:39:13,869 --> 00:39:18,770
if you<font color="#E5E5E5"> just mean the actual javascript</font>

875
00:39:16,160 --> 00:39:21,980
itself that's really easy to find just

876
00:39:18,770 --> 00:39:26,630
go to google and search for bjs or<font color="#CCCCCC"> zero</font>

877
00:39:21,980 --> 00:39:28,250
<font color="#CCCCCC">jas shadow server has a list of russian</font>

878
00:39:26,630 --> 00:39:30,619
<font color="#E5E5E5">clue slot of that as a list of the</font>

879
00:39:28,250 --> 00:39:33,260
different domains but even<font color="#E5E5E5"> the domains</font>

880
00:39:30,619 --> 00:39:34,280
that were from like 2007 an early two

881
00:39:33,260 --> 00:39:36,109
thousand eight you can<font color="#E5E5E5"> still find</font>

882
00:39:34,280 --> 00:39:38,180
websites they'd still have those haven't

883
00:39:36,109 --> 00:39:39,529
been cleaned up yet so you can do that

884
00:39:38,180 --> 00:39:43,430
and just kind of follow them through the

885
00:39:39,530 --> 00:39:44,720
different links they do try<font color="#CCCCCC"> and add some</font>

886
00:39:43,430 --> 00:39:46,368
some of them and try and clued some

887
00:39:44,720 --> 00:39:48,649
measures to make it more difficult<font color="#E5E5E5"> for</font>

888
00:39:46,369 --> 00:39:50,930
researchers to find like you have to

889
00:39:48,650 --> 00:39:52,490
have a valid<font color="#E5E5E5"> user agent so no</font><font color="#CCCCCC"> w get by</font>

890
00:39:50,930 --> 00:39:55,598
itself won't work you<font color="#E5E5E5"> have to</font><font color="#CCCCCC"> have the</font>

891
00:39:52,490 --> 00:39:57,529
cookie from before there are timeouts

892
00:39:55,599 --> 00:39:58,880
where you have to<font color="#E5E5E5"> go from one gether a</font>

893
00:39:57,530 --> 00:40:10,280
certain amount of time things like<font color="#E5E5E5"> that</font>

894
00:39:58,880 --> 00:40:13,760
<font color="#E5E5E5">yes cuz i can ever do anything I can</font>

895
00:40:10,280 --> 00:40:16,490
monitors registrar's registrar's are

896
00:40:13,760 --> 00:40:21,710
pretty much on their own I actually went

897
00:40:16,490 --> 00:40:23,720
looked up the I can on well either

898
00:40:21,710 --> 00:40:25,820
either way they pretty much push on the

899
00:40:23,720 --> 00:40:28,490
<font color="#CCCCCC">Registrar but I can will monitor they</font>

900
00:40:25,820 --> 00:40:30,430
only do certain things like if you want

901
00:40:28,490 --> 00:40:33,020
to<font color="#E5E5E5"> get I can't pissed off at a registrar</font>

902
00:40:30,430 --> 00:40:34,700
<font color="#E5E5E5">till I can they're not on the Registrar</font>

903
00:40:33,020 --> 00:40:37,369
isn't making people include correct<font color="#CCCCCC"> two</font>

904
00:40:34,700 --> 00:40:39,098
<font color="#CCCCCC">ways because I can</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> botley disclaims</font>

905
00:40:37,369 --> 00:40:43,400
any responsibility for malicious content

906
00:40:39,099 --> 00:40:47,300
but false who is is no good EST domains

907
00:40:43,400 --> 00:40:49,570
recently was kicked off as an official

908
00:40:47,300 --> 00:40:50,920
registrar not because of all the

909
00:40:49,570 --> 00:40:53,220
stuff they were hosting but because

910
00:40:50,920 --> 00:40:57,640
<font color="#E5E5E5">their president was convicted of a crime</font>

911
00:40:53,220 --> 00:40:59,980
so I<font color="#CCCCCC"> ICANN's not in my experience very</font>

912
00:40:57,640 --> 00:41:03,359
interested in overseeing that it all

913
00:40:59,980 --> 00:41:03,360
comes down to the individual registrar

914
00:41:03,780 --> 00:41:12,340
any other questions<font color="#E5E5E5"> okay thank you I'll</font>

915
00:41:10,690 --> 00:41:15,280
go to hack I just need how to you know

916
00:41:12,340 --> 00:41:17,460
follow JavaScript around thank you very

917
00:41:15,280 --> 00:41:17,460
much

