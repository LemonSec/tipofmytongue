1
00:00:00,230 --> 00:00:02,299
[Music]

2
00:00:05,870 --> 00:00:09,420
my talk today is kind of on the hardware

3
00:00:09,420 --> 00:00:11,130
side of supply chains so when we talk

4
00:00:11,130 --> 00:00:13,559
about supply chain tax and and all these

5
00:00:13,559 --> 00:00:15,150
things but what we're really talking

6
00:00:15,150 --> 00:00:17,820
about is specific different attack

7
00:00:17,820 --> 00:00:20,279
vectors that are kind of focused the

8
00:00:20,279 --> 00:00:23,640
hardware layer so I'm going to talk

9
00:00:23,640 --> 00:00:28,260
about oh I did I use a clicker alright

10
00:00:28,260 --> 00:00:29,970
so we're going to talk about the

11
00:00:29,970 --> 00:00:32,399
different types of hardware attacks and

12
00:00:32,399 --> 00:00:35,370
then techniques assessing the different

13
00:00:35,370 --> 00:00:37,440
you know costs associated with each one

14
00:00:37,440 --> 00:00:39,230
as well as access that it does provide

15
00:00:39,230 --> 00:00:41,910
and how we can defend against them if at

16
00:00:41,910 --> 00:00:46,950
all so it to recap in some previous some

17
00:00:46,950 --> 00:00:50,280
attacks that have happened in the past

18
00:00:50,280 --> 00:00:52,110
so my slides differ a little bit from

19
00:00:52,110 --> 00:00:55,230
this but we have the big hack that

20
00:00:55,230 --> 00:00:57,510
happened recently

21
00:00:57,510 --> 00:01:00,750
so everyone heard about it all right so

22
00:01:00,750 --> 00:01:03,539
I was attacked by ideally you know

23
00:01:03,539 --> 00:01:06,090
Chinese spies reaching across many many

24
00:01:06,090 --> 00:01:09,090
companies and the idea was that they

25
00:01:09,090 --> 00:01:10,979
were back toward at manufacturing time

26
00:01:10,979 --> 00:01:12,299
alright so everyone's heard about this

27
00:01:12,299 --> 00:01:16,290
one and theoretically it was easy to

28
00:01:16,290 --> 00:01:21,270
detect and then earlier yesterday we had

29
00:01:21,270 --> 00:01:23,189
a discussion about shadow shadow hammer

30
00:01:23,189 --> 00:01:25,590
and shadow pad different types of

31
00:01:25,590 --> 00:01:29,130
attacks the Asus one was interesting as

32
00:01:29,130 --> 00:01:31,320
it was actually mul weird but it

33
00:01:31,320 --> 00:01:33,450
actually used the MAC addresses on on

34
00:01:33,450 --> 00:01:36,060
laptops to target different types of

35
00:01:36,060 --> 00:01:39,030
attacks and so this is just the example

36
00:01:39,030 --> 00:01:41,250
in short of what happened during this

37
00:01:41,250 --> 00:01:44,790
attack and so it's still a mystery

38
00:01:44,790 --> 00:01:47,100
actually why attackers reduce the impact

39
00:01:47,100 --> 00:01:49,740
of their payload to only about 600

40
00:01:49,740 --> 00:01:51,540
victims even though it infected infected

41
00:01:51,540 --> 00:01:56,880
money and then the shadow Pat attack was

42
00:01:56,880 --> 00:01:58,469
interesting as it was actually targeting

43
00:01:58,469 --> 00:02:02,159
the update procedure behind different

44
00:02:02,159 --> 00:02:05,549
types of behind different sign binaries

45
00:02:05,549 --> 00:02:07,619
I'm and on the right hand side here we

46
00:02:07,619 --> 00:02:10,560
have infestation a popular video game by

47
00:02:10,560 --> 00:02:12,780
Point Blank I mean it cane contains

48
00:02:12,780 --> 00:02:14,730
similar malware injection

49
00:02:14,730 --> 00:02:17,030
it was designed by South Korean company

50
00:02:17,030 --> 00:02:20,549
Gepetto company whose digital signature

51
00:02:20,549 --> 00:02:23,340
was abused in this situation the

52
00:02:23,340 --> 00:02:25,950
signature was actually revoked however

53
00:02:25,950 --> 00:02:28,379
as a pedo still use the certificate

54
00:02:28,379 --> 00:02:31,819
through the end of February of this year

55
00:02:32,000 --> 00:02:36,180
so now my slides are saying to this all

56
00:02:36,180 --> 00:02:37,890
right so when we're unpacking different

57
00:02:37,890 --> 00:02:39,629
types of hardware attacks we're looking

58
00:02:39,629 --> 00:02:42,030
at the full stack right and it turns out

59
00:02:42,030 --> 00:02:43,879
we're pretty good at defending against

60
00:02:43,879 --> 00:02:47,970
these parts of our systems right we know

61
00:02:47,970 --> 00:02:49,470
how to encrypt data we know how to sign

62
00:02:49,470 --> 00:02:51,690
binaries we know how to put things in

63
00:02:51,690 --> 00:02:54,450
virtual systems or sand boxes we know

64
00:02:54,450 --> 00:02:56,489
how to audit code we can look at

65
00:02:56,489 --> 00:03:00,359
hypervisors and and even the firmware

66
00:03:00,359 --> 00:03:02,489
behind it we know how did that that

67
00:03:02,489 --> 00:03:04,049
system works but we really don't have a

68
00:03:04,049 --> 00:03:07,549
good solution for is the hardware layer

69
00:03:09,560 --> 00:03:14,849
okay so the different types of hardware

70
00:03:14,849 --> 00:03:16,200
attacks that I'm going to be talking

71
00:03:16,200 --> 00:03:18,629
about our external standalone implants

72
00:03:18,629 --> 00:03:22,139
external peripheral implants internal

73
00:03:22,139 --> 00:03:25,799
peripheral implants as well as internal

74
00:03:25,799 --> 00:03:28,829
implants at the chip layer and then of

75
00:03:28,829 --> 00:03:31,109
course we have the firmware backdoors as

76
00:03:31,109 --> 00:03:33,239
well so on this picture here we see the

77
00:03:33,239 --> 00:03:37,980
external standalone implants so that

78
00:03:37,980 --> 00:03:39,449
would be like a packet sniffer device

79
00:03:39,449 --> 00:03:41,060
listening on your Ethernet or Wi-Fi

80
00:03:41,060 --> 00:03:44,099
cables a camera or a microphone spying

81
00:03:44,099 --> 00:03:47,730
on your keystrokes or on your video and

82
00:03:47,730 --> 00:03:49,620
on the right-hand side we have a USB

83
00:03:49,620 --> 00:03:51,810
maybe keystroke logger physically

84
00:03:51,810 --> 00:03:53,010
plugged into your computer it's a

85
00:03:53,010 --> 00:03:54,440
completely separate piece of hardware

86
00:03:54,440 --> 00:03:56,519
and I'm sure everyone's played around

87
00:03:56,519 --> 00:03:59,959
with these things pretty low cost

88
00:03:59,959 --> 00:04:03,810
however it's it's very targeted right

89
00:04:03,810 --> 00:04:10,859
we have PCB implants so so this would be

90
00:04:10,859 --> 00:04:13,859
things like like pictured here where

91
00:04:13,859 --> 00:04:16,709
inside the chip or inside the board

92
00:04:16,709 --> 00:04:18,720
itself you have a specific piece of

93
00:04:18,720 --> 00:04:21,269
hardware so this is a picture of what

94
00:04:21,269 --> 00:04:24,180
purportedly was the super micro tech

95
00:04:24,180 --> 00:04:27,210
where a small

96
00:04:27,210 --> 00:04:30,750
a package or a piece was actually put on

97
00:04:30,750 --> 00:04:32,580
the board at a specific part on the

98
00:04:32,580 --> 00:04:36,509
board to leak data or or to gain access

99
00:04:36,509 --> 00:04:39,080
to that system

100
00:04:39,080 --> 00:04:46,979
all right so and then also not pictured

101
00:04:46,979 --> 00:04:51,960
in these slides is the soccer IC

102
00:04:51,960 --> 00:04:55,880
implants so actually a picture here but

103
00:04:55,880 --> 00:04:59,069
most modern processors have many many

104
00:04:59,069 --> 00:05:02,430
cores inside of a single chip so in fact

105
00:05:02,430 --> 00:05:04,650
the integrated circuit or the IC chip

106
00:05:04,650 --> 00:05:09,930
has on cell phones especially has

107
00:05:09,930 --> 00:05:11,580
everything the device needs so it has a

108
00:05:11,580 --> 00:05:14,810
USB audio/video ethernet memory cards

109
00:05:14,810 --> 00:05:17,550
and they're all handled on one chip not

110
00:05:17,550 --> 00:05:20,580
pictured here and obviously the cost of

111
00:05:20,580 --> 00:05:22,349
performing this type of intentional

112
00:05:22,349 --> 00:05:25,620
backdoor is much higher and more

113
00:05:25,620 --> 00:05:27,810
feasible technique is what was pictured

114
00:05:27,810 --> 00:05:29,460
previously with the super micro case

115
00:05:29,460 --> 00:05:30,539
where you actually just put something

116
00:05:30,539 --> 00:05:33,770
different on the board an example of the

117
00:05:33,770 --> 00:05:36,210
integrated circuit backdoor is actually

118
00:05:36,210 --> 00:05:41,270
the AMD backdoor which came out I

119
00:05:41,270 --> 00:05:44,099
believe last year but it was idea was

120
00:05:44,099 --> 00:05:47,070
that at the IC layer you had back cheat

121
00:05:47,070 --> 00:05:48,710
codes in the game in the silicon

122
00:05:48,710 --> 00:05:56,280
basically yep so the slides that you

123
00:05:56,280 --> 00:05:58,199
guys have don't have these slides and

124
00:05:58,199 --> 00:06:00,810
then that Victoria as well is firmware

125
00:06:00,810 --> 00:06:03,930
implants so and that would just be like

126
00:06:03,930 --> 00:06:05,909
bug doors which we'll be talking about

127
00:06:05,909 --> 00:06:08,400
later today at about 3 for the hawawa

128
00:06:08,400 --> 00:06:12,509
discussion all right so now let's look

129
00:06:12,509 --> 00:06:15,300
at discuss techniques but we're going to

130
00:06:15,300 --> 00:06:16,830
start with the super micro case so that

131
00:06:16,830 --> 00:06:23,210
first example of of this PCB implant

132
00:06:23,210 --> 00:06:27,599
okay all right so the big hack right

133
00:06:27,599 --> 00:06:29,729
what was it so it was an additional

134
00:06:29,729 --> 00:06:33,060
microchip on the motherboard not much

135
00:06:33,060 --> 00:06:36,449
bigger than a grain of rice and it was

136
00:06:36,449 --> 00:06:38,820
it deviated completely from the original

137
00:06:38,820 --> 00:06:40,780
design so it would be something

138
00:06:40,780 --> 00:06:41,920
if you knew what that board should look

139
00:06:41,920 --> 00:06:44,230
like it should be different it was great

140
00:06:44,230 --> 00:06:47,590
gray or off-white in color and the idea

141
00:06:47,590 --> 00:06:49,750
was it an intercepted the CPUs temporary

142
00:06:49,750 --> 00:06:52,270
memory and was able to read that off and

143
00:06:52,270 --> 00:06:53,800
send that over the network through the

144
00:06:53,800 --> 00:06:56,020
chip and they could do this because they

145
00:06:56,020 --> 00:06:57,220
were connected to the base board

146
00:06:57,220 --> 00:07:00,250
management controller which is one part

147
00:07:00,250 --> 00:07:01,720
of that board that you would want to

148
00:07:01,720 --> 00:07:03,400
connect to if you wanted to get data off

149
00:07:03,400 --> 00:07:06,310
of it the idea was it as a signal

150
00:07:06,310 --> 00:07:07,900
conditioning coupler which is just a

151
00:07:07,900 --> 00:07:10,330
component so that was a specific

152
00:07:10,330 --> 00:07:12,550
component they were saying it was and it

153
00:07:12,550 --> 00:07:14,680
altered the memory operating system as

154
00:07:14,680 --> 00:07:18,070
well so a most for the most part all of

155
00:07:18,070 --> 00:07:20,710
Hardware implants actually a sister

156
00:07:20,710 --> 00:07:26,470
facilitate a variant or a miss function

157
00:07:26,470 --> 00:07:28,510
in the firmware I'm so they're always

158
00:07:28,510 --> 00:07:30,250
your they're usually as a software

159
00:07:30,250 --> 00:07:33,100
component to it as well and the idea was

160
00:07:33,100 --> 00:07:35,140
that it was embedded between PCB layers

161
00:07:35,140 --> 00:07:37,090
it was thin enough where you wouldn't

162
00:07:37,090 --> 00:07:39,960
really notice it if you weren't looking

163
00:07:39,960 --> 00:07:44,290
all right so what's possible here at a

164
00:07:44,290 --> 00:07:46,990
network level we can use signal

165
00:07:46,990 --> 00:07:49,390
conditioning couplers to do memory

166
00:07:49,390 --> 00:07:53,950
processing or network functions so

167
00:07:53,950 --> 00:07:55,570
ideally you'd have found suspicious

168
00:07:55,570 --> 00:07:59,850
network activity if this case were true

169
00:07:59,850 --> 00:08:02,350
downloading firmware that's altered is

170
00:08:02,350 --> 00:08:04,270
also possibility in this situation so

171
00:08:04,270 --> 00:08:05,590
Supermicro firmware could have been

172
00:08:05,590 --> 00:08:08,289
updated and the malware was on the

173
00:08:08,289 --> 00:08:09,550
network card drive or something like

174
00:08:09,550 --> 00:08:11,950
that which would assist or be that

175
00:08:11,950 --> 00:08:13,660
second stage associated with the

176
00:08:13,660 --> 00:08:17,590
hardware implant built on the server's

177
00:08:17,590 --> 00:08:19,890
Ethernet connector to get network access

178
00:08:19,890 --> 00:08:22,840
you know it appear as if it had normal

179
00:08:22,840 --> 00:08:24,130
functionality as well as secondary

180
00:08:24,130 --> 00:08:27,340
functionality so that's what the big

181
00:08:27,340 --> 00:08:29,919
hack kind of shed light on but what are

182
00:08:29,919 --> 00:08:33,549
different other different types of these

183
00:08:33,549 --> 00:08:37,179
backdoors so to display this we have to

184
00:08:37,179 --> 00:08:40,419
take a step back and look at a new wafer

185
00:08:40,419 --> 00:08:42,900
level chip scaling package that came out

186
00:08:42,900 --> 00:08:47,580
in the past five years right so the WL

187
00:08:47,580 --> 00:08:50,560
CSP provides a soldering and connect

188
00:08:50,560 --> 00:08:52,630
directly between a device and the

189
00:08:52,630 --> 00:08:54,440
motherboard of the end product so

190
00:08:54,440 --> 00:08:56,629
as you can see here this is what it

191
00:08:56,629 --> 00:08:58,759
would look like might not look like much

192
00:08:58,759 --> 00:09:02,120
however it provides the TSV or through

193
00:09:02,120 --> 00:09:06,889
silicon via which allows you to have 3ds

194
00:09:06,889 --> 00:09:09,949
3d packaging so it would contain two or

195
00:09:09,949 --> 00:09:12,439
more chips stacked vertically so they

196
00:09:12,439 --> 00:09:14,930
occupy less space and this would be an

197
00:09:14,930 --> 00:09:16,759
example of what one would look like on

198
00:09:16,759 --> 00:09:18,860
the right for mobile so you'd have

199
00:09:18,860 --> 00:09:21,800
different components all connected in 3d

200
00:09:21,800 --> 00:09:23,899
space the resulting the result of which

201
00:09:23,899 --> 00:09:25,579
would mean you'd have higher bandwidth

202
00:09:25,579 --> 00:09:28,660
and lower energy consumption so

203
00:09:28,660 --> 00:09:31,699
optimizations and saves money so it

204
00:09:31,699 --> 00:09:33,980
sounds great right but from a security

205
00:09:33,980 --> 00:09:36,430
standpoint an issue with this is that

206
00:09:36,430 --> 00:09:38,480
you clearly can't see everything that's

207
00:09:38,480 --> 00:09:40,910
going on so some of these vias might

208
00:09:40,910 --> 00:09:43,399
actually differ and the differencing the

209
00:09:43,399 --> 00:09:44,870
differences in where vias are placed

210
00:09:44,870 --> 00:09:47,689
might actually affect certain initial

211
00:09:47,689 --> 00:09:50,600
security components of the chip or might

212
00:09:50,600 --> 00:09:52,069
actually connect a completely different

213
00:09:52,069 --> 00:09:54,800
chip that's hidden in the sandwich and

214
00:09:54,800 --> 00:09:57,050
so for example something could be hidden

215
00:09:57,050 --> 00:09:58,370
right here that you wouldn't see at the

216
00:09:58,370 --> 00:10:02,959
surface layer all right so the ad has a

217
00:10:02,959 --> 00:10:04,459
different type of technique right so you

218
00:10:04,459 --> 00:10:06,470
have the sandwich you have the ad the ad

219
00:10:06,470 --> 00:10:08,750
would be what the super micro case was

220
00:10:08,750 --> 00:10:10,399
alleged to be it'd be addition to the

221
00:10:10,399 --> 00:10:13,399
board however the issue with this is of

222
00:10:13,399 --> 00:10:15,259
course that can be a legit legitimate ad

223
00:10:15,259 --> 00:10:17,779
all right you can move one component

224
00:10:17,779 --> 00:10:19,160
from one pattern and the other to save

225
00:10:19,160 --> 00:10:21,589
costs you would replace a component with

226
00:10:21,589 --> 00:10:23,660
a differ different ones that has similar

227
00:10:23,660 --> 00:10:25,540
functionality that also replace costs

228
00:10:25,540 --> 00:10:27,380
there's different package sizes

229
00:10:27,380 --> 00:10:29,810
available for certain things and

230
00:10:29,810 --> 00:10:31,279
depending on logistics of that

231
00:10:31,279 --> 00:10:33,589
manufacturing plant only certain ones

232
00:10:33,589 --> 00:10:37,910
might be in stock however this would

233
00:10:37,910 --> 00:10:39,709
differ from the original spec however

234
00:10:39,709 --> 00:10:44,329
it's become almost probably improvement

235
00:10:44,329 --> 00:10:46,880
across different manufacturing firms

236
00:10:46,880 --> 00:10:51,259
that these replacements do happen all

237
00:10:51,259 --> 00:10:53,839
right and so you can also have inside of

238
00:10:53,839 --> 00:10:56,629
a package so you'd have different flash

239
00:10:56,629 --> 00:10:59,000
memory packages as you see on in the

240
00:10:59,000 --> 00:11:01,250
picture here there was actually

241
00:11:01,250 --> 00:11:04,939
different 3d bonding patterns on this

242
00:11:04,939 --> 00:11:08,180
chip now the reason for this was the

243
00:11:08,180 --> 00:11:09,740
actually use it for many different types

244
00:11:09,740 --> 00:11:12,770
of boards so they'll swap out different

245
00:11:12,770 --> 00:11:14,540
subcomponents that have multiple

246
00:11:14,540 --> 00:11:17,029
functionality and then just not solder

247
00:11:17,029 --> 00:11:20,060
different vias into into the board and

248
00:11:20,060 --> 00:11:21,860
they do that so they can reduce costs

249
00:11:21,860 --> 00:11:25,850
increase the time from you know start to

250
00:11:25,850 --> 00:11:30,290
finish that sort of thing all right so

251
00:11:30,290 --> 00:11:32,330
this isn't a picture of Trammell

252
00:11:32,330 --> 00:11:34,820
Hudson's example of what he would do for

253
00:11:34,820 --> 00:11:38,630
a hardware implant he swapped a

254
00:11:38,630 --> 00:11:42,380
component on the device this is just one

255
00:11:42,380 --> 00:11:45,110
example of a different of what one thing

256
00:11:45,110 --> 00:11:48,860
you could swap and this would mean that

257
00:11:48,860 --> 00:11:50,390
the board would function as usual except

258
00:11:50,390 --> 00:11:52,360
it would have a different functionality

259
00:11:52,360 --> 00:11:55,070
they were able to flip ones two zeros in

260
00:11:55,070 --> 00:11:58,100
flash memory using this swap and it

261
00:11:58,100 --> 00:12:00,830
could alter enough data such that when

262
00:12:00,830 --> 00:12:02,360
you connected to it or when the firmware

263
00:12:02,360 --> 00:12:04,220
read on it you could actually get

264
00:12:04,220 --> 00:12:10,220
command execution all right so PCB or

265
00:12:10,220 --> 00:12:13,459
Die level attacks this is hasn't really

266
00:12:13,459 --> 00:12:15,970
been discussed much except in academia

267
00:12:15,970 --> 00:12:19,100
however it is possible and that would

268
00:12:19,100 --> 00:12:21,980
just be an addition to the actual

269
00:12:21,980 --> 00:12:26,120
silicon of of the PCB so it would be

270
00:12:26,120 --> 00:12:27,920
very hard to detect these things are

271
00:12:27,920 --> 00:12:29,150
really small so you'd actually have to

272
00:12:29,150 --> 00:12:33,140
use microscope micro Sophia on a decap

273
00:12:33,140 --> 00:12:37,910
chip and again this can be done inside

274
00:12:37,910 --> 00:12:39,980
of a legitimate processor at foundry

275
00:12:39,980 --> 00:12:45,440
time so one of the one thing I joke

276
00:12:45,440 --> 00:12:46,850
about is you know every hardware talk

277
00:12:46,850 --> 00:12:49,490
you can know it's a hardware talk by the

278
00:12:49,490 --> 00:12:51,170
fact that all the pictures and the

279
00:12:51,170 --> 00:12:53,329
slides are not actually screenshots but

280
00:12:53,329 --> 00:12:56,209
these are pictures of the different

281
00:12:56,209 --> 00:12:59,930
stages of manufacturing time and so you

282
00:12:59,930 --> 00:13:01,940
know allegedly the manufacturing plants

283
00:13:01,940 --> 00:13:04,339
claim that at each stage there are

284
00:13:04,339 --> 00:13:06,470
checks such that if there were these

285
00:13:06,470 --> 00:13:07,880
backdoors put in place they would know

286
00:13:07,880 --> 00:13:08,300
about it

287
00:13:08,300 --> 00:13:09,740
right because of all these different

288
00:13:09,740 --> 00:13:12,170
tests that happen and for the most part

289
00:13:12,170 --> 00:13:14,450
that is true so it'd be very difficult

290
00:13:14,450 --> 00:13:18,050
for an unsuspecting manufacturing plants

291
00:13:18,050 --> 00:13:19,700
actually have someone put a malicious

292
00:13:19,700 --> 00:13:22,130
backdoor and at any of these stages

293
00:13:22,130 --> 00:13:26,920
once their designs have been approved of

294
00:13:29,320 --> 00:13:34,180
okay so what's the most likely attack so

295
00:13:34,180 --> 00:13:37,670
in general counterfeit or e-waste parts

296
00:13:37,670 --> 00:13:39,980
are often used to shave costs off the

297
00:13:39,980 --> 00:13:41,660
manufacturing time this is probably the

298
00:13:41,660 --> 00:13:45,350
most likely scenario of lowest-cost

299
00:13:45,350 --> 00:13:47,480
it's the largest risk to firm so maybe

300
00:13:47,480 --> 00:13:49,700
it's not even a security or a back door

301
00:13:49,700 --> 00:13:52,220
that's put in but it alters a design of

302
00:13:52,220 --> 00:13:54,140
the board's such that it reduces the

303
00:13:54,140 --> 00:13:59,990
security of the design and so to prove

304
00:13:59,990 --> 00:14:01,580
intentionality is it is a different

305
00:14:01,580 --> 00:14:08,900
problem entirely okay so like for

306
00:14:08,900 --> 00:14:10,360
example in Bunny's example of

307
00:14:10,360 --> 00:14:15,520
engineering on FPGAs the most likely a

308
00:14:15,520 --> 00:14:19,550
type of attack we would be these e-waste

309
00:14:19,550 --> 00:14:23,120
parts and you know why does money talk

310
00:14:23,120 --> 00:14:25,310
here a distributor makes about three to

311
00:14:25,310 --> 00:14:27,560
five percent off of a chip so if they

312
00:14:27,560 --> 00:14:29,240
can inject three to five percents of

313
00:14:29,240 --> 00:14:31,280
fake chips in there also they would

314
00:14:31,280 --> 00:14:32,900
actually double their profits just

315
00:14:32,900 --> 00:14:35,750
because in engineering you know costs

316
00:14:35,750 --> 00:14:37,960
are so high that profits pretty low so

317
00:14:37,960 --> 00:14:42,050
these are actually from the super micro

318
00:14:42,050 --> 00:14:44,150
boards here different components that

319
00:14:44,150 --> 00:14:46,400
actually didn't match the ones in the

320
00:14:46,400 --> 00:14:49,550
specification however they're different

321
00:14:49,550 --> 00:14:52,220
models of the same thing so the idea

322
00:14:52,220 --> 00:14:55,250
that we assumed was it was just a cost

323
00:14:55,250 --> 00:14:58,940
reduction now to defend against this is

324
00:14:58,940 --> 00:15:00,530
pretty difficult to you'd have to have

325
00:15:00,530 --> 00:15:02,480
representative in that factory verifying

326
00:15:02,480 --> 00:15:05,920
that each board has the approved of of

327
00:15:05,920 --> 00:15:09,020
components on the board so it's it's

328
00:15:09,020 --> 00:15:10,280
pretty unlikely that you'd you'd

329
00:15:10,280 --> 00:15:19,420
actually do that all right so another

330
00:15:19,420 --> 00:15:22,220
well example of the cost here is is just

331
00:15:22,220 --> 00:15:24,500
bunnies numbers that he used in his talk

332
00:15:24,500 --> 00:15:26,360
earlier this year where he was saying

333
00:15:26,360 --> 00:15:28,940
that it would have really cost in the

334
00:15:28,940 --> 00:15:31,670
low attend k4 a wire bound implants to

335
00:15:31,670 --> 00:15:35,900
happen and the mid 100k for that double

336
00:15:35,900 --> 00:15:41,570
ul CSP that 3d chip packaging implant so

337
00:15:41,570 --> 00:15:44,000
it's it's much cheaper to actually just

338
00:15:44,000 --> 00:15:52,730
change out a component all right so this

339
00:15:52,730 --> 00:15:54,920
is just kind of laying out the different

340
00:15:54,920 --> 00:15:56,540
types of hardware techs and what we

341
00:15:56,540 --> 00:15:58,870
considered to be easy attacks to perform

342
00:15:58,870 --> 00:16:01,220
and easy to detect

343
00:16:01,220 --> 00:16:04,190
so obviously the add component one you'd

344
00:16:04,190 --> 00:16:05,690
be able to know for sure if that was

345
00:16:05,690 --> 00:16:06,800
different

346
00:16:06,800 --> 00:16:09,380
however the substituting the component

347
00:16:09,380 --> 00:16:12,110
one is actually quite hard so with

348
00:16:12,110 --> 00:16:13,940
trammels example where as an active

349
00:16:13,940 --> 00:16:15,710
component you'd actually have to do

350
00:16:15,710 --> 00:16:18,410
additional analysis determine if for

351
00:16:18,410 --> 00:16:20,030
example a passive component on the board

352
00:16:20,030 --> 00:16:22,580
was actually active if it different

353
00:16:22,580 --> 00:16:24,860
enough from the original the

354
00:16:24,860 --> 00:16:26,990
specification of the board to cause

355
00:16:26,990 --> 00:16:29,030
problems in your design that sort of

356
00:16:29,030 --> 00:16:31,910
thing no I in my opinion at least

357
00:16:31,910 --> 00:16:35,450
editing the IP list at manufacturer

358
00:16:35,450 --> 00:16:36,740
before manufacturing time actually

359
00:16:36,740 --> 00:16:40,310
starts so editing the silicon designed

360
00:16:40,310 --> 00:16:44,830
the RTL files which are actually these

361
00:16:44,830 --> 00:16:48,290
kind of dll's that are loaded in it at

362
00:16:48,290 --> 00:16:51,140
manufacturing to help design the silicon

363
00:16:51,140 --> 00:16:53,570
parts of the chip if you could edit

364
00:16:53,570 --> 00:16:57,260
those then you'd actually have you know

365
00:16:57,260 --> 00:16:59,690
pretty low cost but pretty hard to

366
00:16:59,690 --> 00:17:03,620
perform modification to all these chips

367
00:17:03,620 --> 00:17:06,609
so the example of that would be arm so

368
00:17:06,609 --> 00:17:08,630
everyone knows that arm makes their

369
00:17:08,630 --> 00:17:11,089
money because they license their RTL

370
00:17:11,089 --> 00:17:13,490
files right the license about people

371
00:17:13,490 --> 00:17:16,280
take those files they put them in a CAD

372
00:17:16,280 --> 00:17:17,990
program or something and they print

373
00:17:17,990 --> 00:17:20,030
those that silicon into the chip and on

374
00:17:20,030 --> 00:17:22,700
the hip arm but in that situation if the

375
00:17:22,700 --> 00:17:25,040
design actually has a specific problem

376
00:17:25,040 --> 00:17:28,610
in that file or certain commands that

377
00:17:28,610 --> 00:17:32,000
really shouldn't be there then that

378
00:17:32,000 --> 00:17:34,190
would affect everyone and be very hard

379
00:17:34,190 --> 00:17:36,830
to deduct it would be very prolific and

380
00:17:36,830 --> 00:17:39,950
that was the example at the AMG cheat

381
00:17:39,950 --> 00:17:42,650
code hack that came out earlier this

382
00:17:42,650 --> 00:17:44,770
year

383
00:17:45,809 --> 00:17:47,399
all right so how do we defend against

384
00:17:47,399 --> 00:17:48,749
this though right so we have all these

385
00:17:48,749 --> 00:17:50,879
different types of hardware implants we

386
00:17:50,879 --> 00:17:52,769
want to look at the board and say this

387
00:17:52,769 --> 00:17:55,980
is perfectly good or not now you know

388
00:17:55,980 --> 00:17:57,539
one thing that people are playing with

389
00:17:57,539 --> 00:18:01,409
is before fab time the actual RTL or the

390
00:18:01,409 --> 00:18:03,509
silicon design of the chip can actually

391
00:18:03,509 --> 00:18:05,309
be formally verified so companies like

392
00:18:05,309 --> 00:18:08,519
Galois or are creating tooling to allow

393
00:18:08,519 --> 00:18:11,159
you to say this circuit design is a

394
00:18:11,159 --> 00:18:12,870
hundred percent secure this circuit does

395
00:18:12,870 --> 00:18:16,049
exactly this nothing more nothing less

396
00:18:16,049 --> 00:18:17,519
and that's one way to lock down the

397
00:18:17,519 --> 00:18:23,009
silicon of the chip however if you have

398
00:18:23,009 --> 00:18:24,480
your boy already what would you go about

399
00:18:24,480 --> 00:18:29,279
doing so going through all my

400
00:18:29,279 --> 00:18:36,029
transitions here okay so you'd have to

401
00:18:36,029 --> 00:18:38,700
assess your security hygiene so no

402
00:18:38,700 --> 00:18:40,799
matter what even if your boards are

403
00:18:40,799 --> 00:18:42,240
backdoored if you know you don't have

404
00:18:42,240 --> 00:18:44,789
good corporate security in general then

405
00:18:44,789 --> 00:18:46,860
it doesn't really matter there's no need

406
00:18:46,860 --> 00:18:48,749
for the hardware backdoor anyway they're

407
00:18:48,749 --> 00:18:51,990
probably already on your system but then

408
00:18:51,990 --> 00:18:53,369
also you'd have to assess your supply

409
00:18:53,369 --> 00:18:56,159
chain risk so one thing that super micro

410
00:18:56,159 --> 00:18:58,529
you know didn't have going for it was

411
00:18:58,529 --> 00:19:01,740
there they actually outsourced their

412
00:19:01,740 --> 00:19:06,480
manufacturing to a third party in Taiwan

413
00:19:06,480 --> 00:19:09,389
I think and they actually outsource

414
00:19:09,389 --> 00:19:11,460
different parts of manufacturing to

415
00:19:11,460 --> 00:19:13,860
other sub companies as well and so at

416
00:19:13,860 --> 00:19:16,049
that point it's becoming a larger and

417
00:19:16,049 --> 00:19:17,490
larger problem and harder and harder to

418
00:19:17,490 --> 00:19:19,710
lock down and so at every point in that

419
00:19:19,710 --> 00:19:22,830
process something could happen - oh just

420
00:19:22,830 --> 00:19:25,460
the design in a way that's undetectable

421
00:19:25,460 --> 00:19:28,529
and so also you know obviously it's

422
00:19:28,529 --> 00:19:31,340
focus on different areas of your

423
00:19:31,340 --> 00:19:33,029
manufacturing so you have to look at the

424
00:19:33,029 --> 00:19:35,999
code the build system programming

425
00:19:35,999 --> 00:19:37,769
hardware there's a lot of different

426
00:19:37,769 --> 00:19:42,149
components of a good chip and so when

427
00:19:42,149 --> 00:19:45,619
one quote from the UK support on Huawei

428
00:19:45,619 --> 00:19:48,659
was you know they said we couldn't

429
00:19:48,659 --> 00:19:51,119
really determine intentionality for all

430
00:19:51,119 --> 00:19:54,210
the for any of these bugs in in the chip

431
00:19:54,210 --> 00:19:57,720
or in the software but these findings

432
00:19:57,720 --> 00:19:59,610
were just about base

433
00:19:59,610 --> 00:20:01,590
engineering competence in cybersecurity

434
00:20:01,590 --> 00:20:05,160
hygiene and so in this situation you

435
00:20:05,160 --> 00:20:07,050
know there could be bugged or is it

436
00:20:07,050 --> 00:20:09,390
could be just really bad but the fact

437
00:20:09,390 --> 00:20:12,270
that a lot of these problems with with

438
00:20:12,270 --> 00:20:14,520
the design at all layers that weren't

439
00:20:14,520 --> 00:20:17,610
addressed was really the critical part

440
00:20:17,610 --> 00:20:19,850
here

441
00:20:19,940 --> 00:20:23,880
all right so supply chain if you try and

442
00:20:23,880 --> 00:20:25,170
break it down into the different

443
00:20:25,170 --> 00:20:28,530
components of assessment this is kind of

444
00:20:28,530 --> 00:20:30,810
the line that I like using you have a

445
00:20:30,810 --> 00:20:32,280
software and hardware components that

446
00:20:32,280 --> 00:20:34,950
eventually merge so after the boards are

447
00:20:34,950 --> 00:20:37,110
made it shipped somewhere else and the

448
00:20:37,110 --> 00:20:38,960
code is actually flashed onto the chip

449
00:20:38,960 --> 00:20:42,510
so the first stage of course you know

450
00:20:42,510 --> 00:20:50,940
security alright the first stage you

451
00:20:50,940 --> 00:20:54,000
want to look at specification of the

452
00:20:54,000 --> 00:20:57,510
actual hardware and software of the of

453
00:20:57,510 --> 00:20:59,310
the board so you develop this

454
00:20:59,310 --> 00:21:00,810
specification usually that's done

455
00:21:00,810 --> 00:21:02,640
in-house for supermicro that was done in

456
00:21:02,640 --> 00:21:04,620
California and that can be easily

457
00:21:04,620 --> 00:21:06,180
checked so you know you have one

458
00:21:06,180 --> 00:21:09,300
specification one RTL file for the

459
00:21:09,300 --> 00:21:11,850
silicon formally verify or go through

460
00:21:11,850 --> 00:21:14,190
and just code review this can be easily

461
00:21:14,190 --> 00:21:15,750
checked for backdoors or other failings

462
00:21:15,750 --> 00:21:19,080
in-house now this is the easiest time to

463
00:21:19,080 --> 00:21:21,300
insert a low-level Hardware backdoor if

464
00:21:21,300 --> 00:21:23,070
you do control this process right so if

465
00:21:23,070 --> 00:21:24,780
you controlled everything the

466
00:21:24,780 --> 00:21:26,100
manufacturing you could say okay we'll

467
00:21:26,100 --> 00:21:28,290
just insert a back door here it's cheap

468
00:21:28,290 --> 00:21:33,120
it's easy everyone's happy however in

469
00:21:33,120 --> 00:21:36,300
stage two you start to reduce the

470
00:21:36,300 --> 00:21:39,630
specification and design to practice so

471
00:21:39,630 --> 00:21:41,490
you'd start to have you'd start to go

472
00:21:41,490 --> 00:21:43,740
through and look and say well we've had

473
00:21:43,740 --> 00:21:46,050
these this bits of code in here forever

474
00:21:46,050 --> 00:21:48,990
ms was the case with Super Micro they

475
00:21:48,990 --> 00:21:50,880
actually use libraries with the 90s and

476
00:21:50,880 --> 00:21:53,100
some of their firmware development and

477
00:21:53,100 --> 00:21:55,620
so you'd have to say well we haven't

478
00:21:55,620 --> 00:21:56,850
looked at this in a while let's go

479
00:21:56,850 --> 00:22:00,660
through it and so I three four and five

480
00:22:00,660 --> 00:22:04,380
just labeled here manufacturing on the

481
00:22:04,380 --> 00:22:06,210
other hand happens through a third party

482
00:22:06,210 --> 00:22:10,590
so it's not as hard to to detect so that

483
00:22:10,590 --> 00:22:12,330
would be the product line programming

484
00:22:12,330 --> 00:22:13,170
provisioning

485
00:22:13,170 --> 00:22:16,800
all done out of house in the hardware

486
00:22:16,800 --> 00:22:18,600
integration as well so at all these

487
00:22:18,600 --> 00:22:20,190
stages here it's it's kind of out of

488
00:22:20,190 --> 00:22:23,760
your hands for the most part and so by

489
00:22:23,760 --> 00:22:25,020
the time you get to the district

490
00:22:25,020 --> 00:22:28,650
distribution channels you know in the

491
00:22:28,650 --> 00:22:30,420
warehouse are in transits the customer

492
00:22:30,420 --> 00:22:32,190
the company the customer has less

493
00:22:32,190 --> 00:22:34,500
ability to claim the device matches the

494
00:22:34,500 --> 00:22:37,800
specification so around stages you know

495
00:22:37,800 --> 00:22:40,890
two four or five you start to lose

496
00:22:40,890 --> 00:22:42,210
control of what that actual that

497
00:22:42,210 --> 00:22:44,700
specification looks like and you lose

498
00:22:44,700 --> 00:22:46,740
the ability to actually check easily if

499
00:22:46,740 --> 00:22:49,980
it does match and then finally obviously

500
00:22:49,980 --> 00:22:53,010
it's installed in the system and defense

501
00:22:53,010 --> 00:22:54,690
really depends entirely on the customer

502
00:22:54,690 --> 00:22:57,030
so once it's installed in the Amazon

503
00:22:57,030 --> 00:22:58,860
servers something super micro can

504
00:22:58,860 --> 00:23:04,110
actually easily help them out at all now

505
00:23:04,110 --> 00:23:06,840
attacks are possible at 6 & 7 so you

506
00:23:06,840 --> 00:23:08,670
know distribution obviously you don't

507
00:23:08,670 --> 00:23:10,110
know who's shipping your stuff where

508
00:23:10,110 --> 00:23:11,700
what's being done to it in that process

509
00:23:11,700 --> 00:23:14,310
um however we're not really gonna talk

510
00:23:14,310 --> 00:23:20,430
about that much today okay so super

511
00:23:20,430 --> 00:23:23,250
micro claimed a lot of the R&D happened

512
00:23:23,250 --> 00:23:25,410
in-house which it did they were using

513
00:23:25,410 --> 00:23:27,270
code from the 90s but it was still done

514
00:23:27,270 --> 00:23:28,500
in-house they sold the ability to go

515
00:23:28,500 --> 00:23:30,720
through and check the design of the

516
00:23:30,720 --> 00:23:33,750
hardware of the silicon everything

517
00:23:33,750 --> 00:23:37,170
however they contracted out to a large a

518
00:23:37,170 --> 00:23:40,320
large supply chain and they had a lot of

519
00:23:40,320 --> 00:23:43,950
customers so able comm technologies

520
00:23:43,950 --> 00:23:46,020
which is a Taiwanese company that I

521
00:23:46,020 --> 00:23:48,030
mentioned is actually run by the Super

522
00:23:48,030 --> 00:23:50,280
Micro CEOs brother which I thought was

523
00:23:50,280 --> 00:23:53,520
funny and they actually only offer a

524
00:23:53,520 --> 00:23:55,800
warehousing and coordination so they're

525
00:23:55,800 --> 00:23:57,690
not they're the ones who manufacture the

526
00:23:57,690 --> 00:23:59,520
device but in fact they don't do any of

527
00:23:59,520 --> 00:24:03,030
the manufacturing and they take up 15%

528
00:24:03,030 --> 00:24:04,320
of the cost of sales so they have a

529
00:24:04,320 --> 00:24:06,000
pretty big stake in the company's

530
00:24:06,000 --> 00:24:10,740
success in the success of the chip and

531
00:24:10,740 --> 00:24:14,760
they basically do warehousing accuracy

532
00:24:14,760 --> 00:24:17,220
and forecasts so they determine you know

533
00:24:17,220 --> 00:24:18,960
where different parts are and where the

534
00:24:18,960 --> 00:24:20,310
best place to manufacture certain

535
00:24:20,310 --> 00:24:24,270
components are at that given time all

536
00:24:24,270 --> 00:24:25,830
right so

537
00:24:25,830 --> 00:24:27,480
stepping through this again super micro

538
00:24:27,480 --> 00:24:29,880
designs that abled my able micro

539
00:24:29,880 --> 00:24:32,669
coordinates contract manufacturers

540
00:24:32,669 --> 00:24:34,590
produce and actually do the shipments

541
00:24:34,590 --> 00:24:37,380
and they shipped to the San Jose in

542
00:24:37,380 --> 00:24:40,070
other loans or Taiwan for final assembly

543
00:24:40,070 --> 00:24:42,690
so final assembly of all the parts and

544
00:24:42,690 --> 00:24:44,549
the flashing of the firmware actually

545
00:24:44,549 --> 00:24:47,730
happens in only three locations and then

546
00:24:47,730 --> 00:24:50,039
they obviously go through distributor to

547
00:24:50,039 --> 00:24:55,710
customer all right so late last year we

548
00:24:55,710 --> 00:24:57,179
were given task of looking at some of

549
00:24:57,179 --> 00:25:00,419
these boards and so we sat down we had

550
00:25:00,419 --> 00:25:01,620
some boards in front of us and I'm like

551
00:25:01,620 --> 00:25:03,000
okay well it's gray or off-white in

552
00:25:03,000 --> 00:25:04,019
color

553
00:25:04,019 --> 00:25:05,880
we're looking for maybe a signal

554
00:25:05,880 --> 00:25:08,370
conditioning coupler you know who really

555
00:25:08,370 --> 00:25:12,299
knows and we're looking for things that

556
00:25:12,299 --> 00:25:14,370
are unlikely to be to be detected

557
00:25:14,370 --> 00:25:15,779
without specialized equipment so

558
00:25:15,779 --> 00:25:17,880
something that probably has that hidden

559
00:25:17,880 --> 00:25:20,820
behavior however this is a very poor

560
00:25:20,820 --> 00:25:22,980
description and so actually just basing

561
00:25:22,980 --> 00:25:26,909
it off this was impossible so we started

562
00:25:26,909 --> 00:25:29,970
to simply look at everything and that

563
00:25:29,970 --> 00:25:33,260
was answer for most of these problems

564
00:25:33,260 --> 00:25:36,149
all right so first thing you can do when

565
00:25:36,149 --> 00:25:37,260
you're just looking at the board is

566
00:25:37,260 --> 00:25:39,750
follow traces on the board trying to

567
00:25:39,750 --> 00:25:41,779
reverse out the netlist that's actually

568
00:25:41,779 --> 00:25:44,100
physically in front of you and compare

569
00:25:44,100 --> 00:25:47,580
that against the netlist from the super

570
00:25:47,580 --> 00:25:51,779
micro design design spec a netlist for

571
00:25:51,779 --> 00:25:54,570
those who don't know is just basically a

572
00:25:54,570 --> 00:25:56,880
map of components on the board and how

573
00:25:56,880 --> 00:26:00,179
they connect to each other and so

574
00:26:00,179 --> 00:26:02,190
obviously this takes a lot of time it's

575
00:26:02,190 --> 00:26:04,500
visually time-consuming and it requires

576
00:26:04,500 --> 00:26:07,080
expert knowledge of how these things

577
00:26:07,080 --> 00:26:10,950
connect no electrical testing is useful

578
00:26:10,950 --> 00:26:13,049
for the cases where components are

579
00:26:13,049 --> 00:26:15,090
actually active versus passive so that

580
00:26:15,090 --> 00:26:17,880
would just be components that maybe look

581
00:26:17,880 --> 00:26:21,539
the same but they actually do processing

582
00:26:21,539 --> 00:26:24,000
of the difference bits that are going

583
00:26:24,000 --> 00:26:25,529
through them instead of just passively

584
00:26:25,529 --> 00:26:30,510
passing them on alright so how are we

585
00:26:30,510 --> 00:26:33,929
going to look for the ad here well you

586
00:26:33,929 --> 00:26:38,250
can try x-rays so if you have a IC you

587
00:26:38,250 --> 00:26:40,160
can look through it with an x-ray

588
00:26:40,160 --> 00:26:42,510
because the just looking at it from the

589
00:26:42,510 --> 00:26:45,140
top level actually doesn't tell you much

590
00:26:45,140 --> 00:26:49,200
so if this is pretty destructive as well

591
00:26:49,200 --> 00:26:51,990
this is just a picture of the different

592
00:26:51,990 --> 00:26:55,140
parts of the chip so as you see here the

593
00:26:55,140 --> 00:26:56,850
top part that looks pretty normal it

594
00:26:56,850 --> 00:26:58,260
matches the picture we saw a few slides

595
00:26:58,260 --> 00:27:00,990
ago however if you look at it from the

596
00:27:00,990 --> 00:27:03,320
side there's different layers to this

597
00:27:03,320 --> 00:27:06,180
integrated circuit and each layer has

598
00:27:06,180 --> 00:27:07,950
the potential to be slightly different

599
00:27:07,950 --> 00:27:09,600
or to have slightly different

600
00:27:09,600 --> 00:27:11,520
functionality based on how it's

601
00:27:11,520 --> 00:27:13,800
connected and so that actually means you

602
00:27:13,800 --> 00:27:16,560
have to start delayering this integrated

603
00:27:16,560 --> 00:27:20,700
circuit additionally you can use x-rays

604
00:27:20,700 --> 00:27:23,520
to detect passive versus active like I

605
00:27:23,520 --> 00:27:26,640
was talking about earlier so here on the

606
00:27:26,640 --> 00:27:30,240
right we see the x-ray of of a board

607
00:27:30,240 --> 00:27:33,420
this isn't a Super Micro board but same

608
00:27:33,420 --> 00:27:33,750
idea

609
00:27:33,750 --> 00:27:35,550
usually these boards are much more

610
00:27:35,550 --> 00:27:36,960
complicated than this this is pretty

611
00:27:36,960 --> 00:27:39,420
simple so you'd have maybe thousands of

612
00:27:39,420 --> 00:27:42,030
different components in this x-ray that

613
00:27:42,030 --> 00:27:44,460
you're actually looking for for active

614
00:27:44,460 --> 00:27:47,040
opponents so we have the resistor which

615
00:27:47,040 --> 00:27:49,890
is just passive capacitor on the upper

616
00:27:49,890 --> 00:27:52,170
right hand side and then we actually

617
00:27:52,170 --> 00:27:56,070
have that chip which is active or the

618
00:27:56,070 --> 00:27:59,370
inductor inside of the this di P package

619
00:27:59,370 --> 00:28:02,340
which is pretty interesting however this

620
00:28:02,340 --> 00:28:04,770
also is pretty destructive to the board

621
00:28:04,770 --> 00:28:06,330
and it requires removal of the

622
00:28:06,330 --> 00:28:09,240
components so the real problem with this

623
00:28:09,240 --> 00:28:11,010
is that you can't do this on all of the

624
00:28:11,010 --> 00:28:12,060
boards that you get in the shipment

625
00:28:12,060 --> 00:28:14,100
right so you're getting a bunch of

626
00:28:14,100 --> 00:28:16,470
boards maybe you can test one this way

627
00:28:16,470 --> 00:28:19,740
but there's no reason to claim that if

628
00:28:19,740 --> 00:28:22,650
you prove one's good and correct that it

629
00:28:22,650 --> 00:28:25,940
actually means that all of them are

630
00:28:25,940 --> 00:28:28,170
alright so specifically for the

631
00:28:28,170 --> 00:28:30,630
Supermicro assessment we ended up

632
00:28:30,630 --> 00:28:34,140
looking at a lot of x-ray images you

633
00:28:34,140 --> 00:28:37,710
have to do about 500 per PCB just to get

634
00:28:37,710 --> 00:28:40,380
the actual full image of what's going on

635
00:28:40,380 --> 00:28:44,400
inside and get all the port details and

636
00:28:44,400 --> 00:28:47,910
stuff so a lot of images look through

637
00:28:47,910 --> 00:28:50,540
and unfortunately there's no real

638
00:28:50,540 --> 00:28:53,460
automated tooling for this so

639
00:28:53,460 --> 00:28:56,070
one idea that you know I think it's kind

640
00:28:56,070 --> 00:28:57,779
of in research stages now is to actually

641
00:28:57,779 --> 00:28:59,909
use open CV or something like that to

642
00:28:59,909 --> 00:29:02,640
process all of these images of the board

643
00:29:02,640 --> 00:29:05,610
itself maybe pull off that netlist or of

644
00:29:05,610 --> 00:29:08,399
these x-rays to to pull off the

645
00:29:08,399 --> 00:29:09,659
different interconnects between the

646
00:29:09,659 --> 00:29:12,539
layers and maybe match that against a

647
00:29:12,539 --> 00:29:19,409
known good PCB x-ray all right so each

648
00:29:19,409 --> 00:29:20,909
person that was operating these x-rays

649
00:29:20,909 --> 00:29:23,070
had five to ten years of experience in

650
00:29:23,070 --> 00:29:26,220
electronics and had to analyze the image

651
00:29:26,220 --> 00:29:28,799
twice for it this is just kind of

652
00:29:28,799 --> 00:29:30,419
showing that you know it is pretty

653
00:29:30,419 --> 00:29:32,130
difficult to do this this sort of

654
00:29:32,130 --> 00:29:35,370
analysis following different wires and

655
00:29:35,370 --> 00:29:38,490
connects and things like that and you

656
00:29:38,490 --> 00:29:41,279
end up with you know a huge tub of SMD

657
00:29:41,279 --> 00:29:49,169
parts from the motherboard all right

658
00:29:49,169 --> 00:29:52,370
so going back to our earlier example

659
00:29:52,370 --> 00:29:55,380
because the super micro vector was

660
00:29:55,380 --> 00:29:58,580
allegedly on the bus not the SPI

661
00:29:58,580 --> 00:30:01,169
you can't refresh

662
00:30:01,169 --> 00:30:03,570
watch the SP but with spi bus by

663
00:30:03,570 --> 00:30:07,649
clipping on set spi chip or replace the

664
00:30:07,649 --> 00:30:09,330
spi chip because it probably won't

665
00:30:09,330 --> 00:30:11,460
actually help in this situation

666
00:30:11,460 --> 00:30:13,440
I'm so this is pictures from Trammell

667
00:30:13,440 --> 00:30:17,130
Hudson's talk at CCC which shows the

668
00:30:17,130 --> 00:30:21,090
different types of of diff of ways that

669
00:30:21,090 --> 00:30:23,460
people would try to detect his implant

670
00:30:23,460 --> 00:30:27,779
but it wouldn't actually work just given

671
00:30:27,779 --> 00:30:34,679
the location of it all right so that's

672
00:30:34,679 --> 00:30:36,270
all of the hardware stuff right but who

673
00:30:36,270 --> 00:30:37,470
cares about codes

674
00:30:37,470 --> 00:30:39,690
who cares about code in these sort of

675
00:30:39,690 --> 00:30:43,440
supply chain techs and so in this

676
00:30:43,440 --> 00:30:46,289
specific example there was a firmware

677
00:30:46,289 --> 00:30:49,529
update that actually also distributed

678
00:30:49,529 --> 00:30:55,950
malware as well all right so this is

679
00:30:55,950 --> 00:30:57,270
what kind one thing I mentioned earlier

680
00:30:57,270 --> 00:30:58,799
but one thing to reiterate is all

681
00:30:58,799 --> 00:31:01,320
Hardware implants don't operate alone

682
00:31:01,320 --> 00:31:04,590
you know they probably can however if

683
00:31:04,590 --> 00:31:07,169
you actually want a successful useful

684
00:31:07,169 --> 00:31:07,980
two

685
00:31:07,980 --> 00:31:10,320
that's implanted it into the pants of

686
00:31:10,320 --> 00:31:11,970
the board you'll actually have to have a

687
00:31:11,970 --> 00:31:15,059
software component here and so what do

688
00:31:15,059 --> 00:31:16,440
you do with that right so how do you

689
00:31:16,440 --> 00:31:18,330
check that this the software isn't

690
00:31:18,330 --> 00:31:23,160
actually abusing or using I miss a

691
00:31:23,160 --> 00:31:27,630
misprint or a incorrectness in that

692
00:31:27,630 --> 00:31:31,200
board and so you know that you can check

693
00:31:31,200 --> 00:31:33,870
your code at compile time look at the

694
00:31:33,870 --> 00:31:35,580
build system reverse engineer the

695
00:31:35,580 --> 00:31:38,250
firmware that we actually you pull from

696
00:31:38,250 --> 00:31:40,140
from the board which is what we did with

697
00:31:40,140 --> 00:31:45,330
Super Micro however as the UK's report

698
00:31:45,330 --> 00:31:48,150
on who always says it's not possible to

699
00:31:48,150 --> 00:31:50,039
be confident that source code actually

700
00:31:50,039 --> 00:31:53,520
matches what's on on any specific board

701
00:31:53,520 --> 00:31:56,880
at a specific time so it might actually

702
00:31:56,880 --> 00:31:58,799
match what's on the board immediately

703
00:31:58,799 --> 00:32:01,559
but after an update or two it could be

704
00:32:01,559 --> 00:32:03,860
completely different

705
00:32:03,860 --> 00:32:07,470
all right so obviously different

706
00:32:07,470 --> 00:32:09,559
different steps that you could do this

707
00:32:09,559 --> 00:32:12,240
source code which would be those bug

708
00:32:12,240 --> 00:32:14,549
doors which is what the UK was trying to

709
00:32:14,549 --> 00:32:17,640
do to look at hallway you could look at

710
00:32:17,640 --> 00:32:20,220
compiled firmware which is what we were

711
00:32:20,220 --> 00:32:23,700
doing for Super Micro and and even

712
00:32:23,700 --> 00:32:24,870
though you might not have the original

713
00:32:24,870 --> 00:32:27,240
firmware you can look at boards across

714
00:32:27,240 --> 00:32:30,059
different time periods to see if if the

715
00:32:30,059 --> 00:32:33,470
firmware deviates at all significantly

716
00:32:33,470 --> 00:32:36,450
at specific parts of the process so

717
00:32:36,450 --> 00:32:38,179
normally they're not going to change

718
00:32:38,179 --> 00:32:40,200
parts of firmware that interact directly

719
00:32:40,200 --> 00:32:41,909
with a component that's been there

720
00:32:41,909 --> 00:32:42,419
forever

721
00:32:42,419 --> 00:32:44,789
so if you see a change a change in that

722
00:32:44,789 --> 00:32:51,539
that's a red flag so and also at the

723
00:32:51,539 --> 00:32:55,289
chip layer different citizens in lower

724
00:32:55,289 --> 00:32:59,789
high bits actually matter a lot for

725
00:32:59,789 --> 00:33:01,320
firmware are different parts so looking

726
00:33:01,320 --> 00:33:07,830
at that as well yep all right so other

727
00:33:07,830 --> 00:33:09,780
things to look at that I'm not going to

728
00:33:09,780 --> 00:33:11,400
go into depth with and when what we

729
00:33:11,400 --> 00:33:13,200
would have done if we continued on the

730
00:33:13,200 --> 00:33:16,140
Super Micro stuff is look at once it's

731
00:33:16,140 --> 00:33:19,470
turned on is there our art is there any

732
00:33:19,470 --> 00:33:21,240
RF components to

733
00:33:21,240 --> 00:33:23,610
it's operation or any Network anomalies

734
00:33:23,610 --> 00:33:27,480
that can be detected or how it or does

735
00:33:27,480 --> 00:33:31,440
do the network or RF outputs differ at

736
00:33:31,440 --> 00:33:35,810
all from previous supermicro boards

737
00:33:36,590 --> 00:33:40,370
alright so you know possible solutions

738
00:33:40,370 --> 00:33:41,820
there you go

739
00:33:41,820 --> 00:33:44,550
computer vision machine learning I know

740
00:33:44,550 --> 00:33:46,490
I do think that there's there's a more

741
00:33:46,490 --> 00:33:49,050
there's more room to be done on

742
00:33:49,050 --> 00:33:51,870
automating the reverse engineering

743
00:33:51,870 --> 00:33:55,440
process of these IC components as well

744
00:33:55,440 --> 00:33:58,800
as the actual board itself so one thing

745
00:33:58,800 --> 00:33:59,940
I really do want to see is better

746
00:33:59,940 --> 00:34:02,310
tooling around lifting netlist soft

747
00:34:02,310 --> 00:34:05,520
boards looking at inner integrated

748
00:34:05,520 --> 00:34:08,250
circuit connects we need the ability to

749
00:34:08,250 --> 00:34:12,270
which back to automatic automatically

750
00:34:12,270 --> 00:34:15,719
trace or compare lifted netlist or

751
00:34:15,719 --> 00:34:18,360
x-rays between each other and obviously

752
00:34:18,360 --> 00:34:20,370
these are destructive and you know you

753
00:34:20,370 --> 00:34:24,210
can't apply security you can't apply

754
00:34:24,210 --> 00:34:26,610
security results from one boards the

755
00:34:26,610 --> 00:34:29,940
other but it would actually help a lot

756
00:34:29,940 --> 00:34:31,830
in this in this domain as most of it's

757
00:34:31,830 --> 00:34:34,230
very very manual right now alright so

758
00:34:34,230 --> 00:34:37,280
that's my talk are there any questions

759
00:34:37,280 --> 00:34:38,330
[Applause]

760
00:34:38,330 --> 00:34:52,480
[Music]

