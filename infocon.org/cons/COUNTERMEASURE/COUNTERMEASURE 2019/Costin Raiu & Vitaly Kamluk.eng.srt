1
00:00:00,230 --> 00:00:02,299
[Music]

2
00:00:05,870 --> 00:00:08,580
so today we want to tell you a few

3
00:00:08,580 --> 00:00:11,070
things from our investigations in supply

4
00:00:11,070 --> 00:00:13,590
chain attacks why because we think

5
00:00:13,590 --> 00:00:16,170
supply chain attacks are very cool

6
00:00:16,170 --> 00:00:18,779
things and it doesn't matter from let's

7
00:00:18,779 --> 00:00:20,789
say which side of the barrier you're

8
00:00:20,789 --> 00:00:22,560
looking into this may be let's say

9
00:00:22,560 --> 00:00:24,000
between you there's people who are

10
00:00:24,000 --> 00:00:26,789
working on supply chain attacks for fun

11
00:00:26,789 --> 00:00:30,119
for profit and maybe there's of course

12
00:00:30,119 --> 00:00:32,399
people who look into catching those

13
00:00:32,399 --> 00:00:36,750
things speaking from our side we are

14
00:00:36,750 --> 00:00:38,969
let's say specializing in catching the

15
00:00:38,969 --> 00:00:40,680
supply chain attacks as well as other

16
00:00:40,680 --> 00:00:44,340
sophisticated attacks we were members of

17
00:00:44,340 --> 00:00:46,289
the global research and analysis team at

18
00:00:46,289 --> 00:00:50,219
Kaspersky also known as great which led

19
00:00:50,219 --> 00:00:52,890
inevitably to a lot of jokes I just make

20
00:00:52,890 --> 00:00:57,000
great great again or great is not great

21
00:00:57,000 --> 00:00:58,320
anymore

22
00:00:58,320 --> 00:01:00,899
I can assure that we're still doing some

23
00:01:00,899 --> 00:01:04,379
things not sure if they're great and

24
00:01:04,379 --> 00:01:06,030
these are some of the things that we

25
00:01:06,030 --> 00:01:09,299
have written about in the past years to

26
00:01:09,299 --> 00:01:11,460
be honest they don't fit on one screen

27
00:01:11,460 --> 00:01:14,070
anymore so these are just some of the

28
00:01:14,070 --> 00:01:19,500
let's say older researches now I think

29
00:01:19,500 --> 00:01:21,600
it's good when talking about supply

30
00:01:21,600 --> 00:01:24,180
chain attacks to remember some may be of

31
00:01:24,180 --> 00:01:28,110
the kind of the old school days how many

32
00:01:28,110 --> 00:01:30,329
people had one of these in their pockets

33
00:01:30,329 --> 00:01:36,689
like a couple of years ago oh yes sorry

34
00:01:36,689 --> 00:01:48,960
about the research years and now they

35
00:01:48,960 --> 00:01:52,619
should be synced all right thank you for

36
00:01:52,619 --> 00:01:56,909
that technology right so how many people

37
00:01:56,909 --> 00:01:58,860
had one of these in their pockets

38
00:01:58,860 --> 00:02:00,479
because it was like really surprising

39
00:02:00,479 --> 00:02:02,040
nobody had one of these in their pockets

40
00:02:02,040 --> 00:02:04,829
also like one or that strange actually

41
00:02:04,829 --> 00:02:08,369
my wife she works for a an American

42
00:02:08,369 --> 00:02:10,500
company and she had one of these as well

43
00:02:10,500 --> 00:02:11,930
and

44
00:02:11,930 --> 00:02:13,640
actually Sharia until they replaced it

45
00:02:13,640 --> 00:02:15,920
with a software version of this thing

46
00:02:15,920 --> 00:02:17,269
that she runs on her left and I was

47
00:02:17,269 --> 00:02:19,430
thinking what's the point in having this

48
00:02:19,430 --> 00:02:22,010
as a software on the same laptop so the

49
00:02:22,010 --> 00:02:23,780
idea is to have a kind of two-factor

50
00:02:23,780 --> 00:02:27,560
authentication right but I was a an

51
00:02:27,560 --> 00:02:32,870
interesting story in 2011 when ours they

52
00:02:32,870 --> 00:02:35,450
actually offered to replace these tokens

53
00:02:35,450 --> 00:02:38,209
and that was a kind of a let's say

54
00:02:38,209 --> 00:02:41,900
interesting offer from the CEO of RSA

55
00:02:41,900 --> 00:02:46,669
and I guess that one of the reasons for

56
00:02:46,669 --> 00:02:48,739
that can let's say be the fact that the

57
00:02:48,739 --> 00:02:51,709
RSA they actually got hacked I think it

58
00:02:51,709 --> 00:02:55,099
was in December of 2010 or maybe even

59
00:02:55,099 --> 00:02:59,120
earlier when someone received someone in

60
00:02:59,120 --> 00:03:01,849
um I think HR received an email with an

61
00:03:01,849 --> 00:03:05,719
excel file called 2011 recruitment plans

62
00:03:05,719 --> 00:03:07,400
and that actually happened to you have a

63
00:03:07,400 --> 00:03:09,560
zero day exploit install the backdoor

64
00:03:09,560 --> 00:03:14,180
and well that was very nicely described

65
00:03:14,180 --> 00:03:18,650
by RSA so kudos for transparency and but

66
00:03:18,650 --> 00:03:20,419
what was interesting is the fact that

67
00:03:20,419 --> 00:03:25,909
our say probably was not the target of

68
00:03:25,909 --> 00:03:29,419
this attack so around the same time

69
00:03:29,419 --> 00:03:33,370
Lockheed Martin also detected an

70
00:03:33,370 --> 00:03:36,049
intrusion in their network and Stephen

71
00:03:36,049 --> 00:03:38,120
attack be test spoke about the kill

72
00:03:38,120 --> 00:03:40,069
chain back in the days when we were

73
00:03:40,069 --> 00:03:41,930
wondering what what is this kill chain

74
00:03:41,930 --> 00:03:44,090
thingy and nowadays I guess it's

75
00:03:44,090 --> 00:03:47,840
everybody kind of knows but well one of

76
00:03:47,840 --> 00:03:51,159
the things let's say that were inferred

77
00:03:51,159 --> 00:03:54,229
was the fact that RSA was not really the

78
00:03:54,229 --> 00:03:57,109
target of this attack but actually you

79
00:03:57,109 --> 00:03:59,810
know Lockheed never confirmed that the

80
00:03:59,810 --> 00:04:03,019
intrusion was actually the result of the

81
00:04:03,019 --> 00:04:04,609
RSA bridge

82
00:04:04,609 --> 00:04:06,259
according to add eggbeater but some

83
00:04:06,259 --> 00:04:08,780
people you know draw this conclusion

84
00:04:08,780 --> 00:04:11,209
that some of these breaches were

85
00:04:11,209 --> 00:04:13,909
actually related one to each other and

86
00:04:13,909 --> 00:04:17,329
the attackers actually try to breach RSA

87
00:04:17,329 --> 00:04:20,298
in order to obtain knowledge about the

88
00:04:20,298 --> 00:04:23,080
tokens not many people actually asked

89
00:04:23,080 --> 00:04:25,160
how can

90
00:04:25,160 --> 00:04:28,010
say breaching our say can give them an

91
00:04:28,010 --> 00:04:31,190
advantage or if they the ability to hack

92
00:04:31,190 --> 00:04:33,440
into other companies and why did the CEO

93
00:04:33,440 --> 00:04:36,080
of RSA offered to replace the tokens

94
00:04:36,080 --> 00:04:38,000
that kind of suggests that the tokens

95
00:04:38,000 --> 00:04:40,610
were compromised right but that also

96
00:04:40,610 --> 00:04:44,150
suggests that RSA actually saved the

97
00:04:44,150 --> 00:04:46,940
keys from all those tokens in a database

98
00:04:46,940 --> 00:04:49,670
so RSA actually hold was holding they

99
00:04:49,670 --> 00:04:53,090
held the keys that were written in all

100
00:04:53,090 --> 00:04:55,370
those tokens which is I think another

101
00:04:55,370 --> 00:04:56,500
interesting question

102
00:04:56,500 --> 00:05:03,170
and why was that the case now well in

103
00:05:03,170 --> 00:05:05,600
the there was an open letter from the

104
00:05:05,600 --> 00:05:08,570
RSA German art Coviello and he actually

105
00:05:08,570 --> 00:05:11,060
confirmed that information taken from

106
00:05:11,060 --> 00:05:14,000
the RSA has been used in an element of

107
00:05:14,000 --> 00:05:16,520
an attempted broader attack on Lockheed

108
00:05:16,520 --> 00:05:19,970
Martin so let's say we kind of know that

109
00:05:19,970 --> 00:05:21,950
these two incidents were connected to

110
00:05:21,950 --> 00:05:24,550
each other so we also of course

111
00:05:24,550 --> 00:05:26,600
understand the Lockheed Martin as

112
00:05:26,600 --> 00:05:28,130
military contract had pretty good

113
00:05:28,130 --> 00:05:30,670
security so they were using all sorts of

114
00:05:30,670 --> 00:05:33,640
technologies into placing look including

115
00:05:33,640 --> 00:05:37,010
two-factor authentication so RSA was

116
00:05:37,010 --> 00:05:39,170
probably a key component in this whole

117
00:05:39,170 --> 00:05:41,930
equation into hacking Lockheed Martin

118
00:05:41,930 --> 00:05:46,720
RSA was an important point now well

119
00:05:46,720 --> 00:05:49,250
another interesting breach which

120
00:05:49,250 --> 00:05:51,440
occurred the same around the same time

121
00:05:51,440 --> 00:05:53,450
was a bit 9 which how many people

122
00:05:53,450 --> 00:05:56,510
remember a bit 9 we see they're now

123
00:05:56,510 --> 00:05:59,030
known as carbon black and they had an

124
00:05:59,030 --> 00:06:04,730
incident pretty much around 2011 and the

125
00:06:04,730 --> 00:06:08,180
hackers which breached mid 9 they got

126
00:06:08,180 --> 00:06:09,650
access to their code signing

127
00:06:09,650 --> 00:06:12,230
certificates and they signed malware

128
00:06:12,230 --> 00:06:14,510
with the bit 9 certificates which allow

129
00:06:14,510 --> 00:06:17,360
them to bypass a bit 9 solutions to

130
00:06:17,360 --> 00:06:20,740
target 3 customers and bit 9 ever

131
00:06:20,740 --> 00:06:23,600
knowledge who were those three customers

132
00:06:23,600 --> 00:06:26,000
that were targeted when the information

133
00:06:26,000 --> 00:06:30,919
with I think that overall you know it

134
00:06:30,919 --> 00:06:33,890
was kind of interesting to watch all

135
00:06:33,890 --> 00:06:35,750
these three things happening at the same

136
00:06:35,750 --> 00:06:37,920
time the RSA breach the

137
00:06:37,920 --> 00:06:39,480
midnight breach the Lockheed Martin

138
00:06:39,480 --> 00:06:42,240
bridge and for sure they were not the

139
00:06:42,240 --> 00:06:44,010
only ones they were like several ones

140
00:06:44,010 --> 00:06:45,810
which took place around the same time

141
00:06:45,810 --> 00:06:48,810
that were not publicized in the same

142
00:06:48,810 --> 00:06:51,540
manner it's also interesting to see why

143
00:06:51,540 --> 00:06:53,430
bid nine was hacked and this is what

144
00:06:53,430 --> 00:06:56,370
they wrote on the blog that due to an

145
00:06:56,370 --> 00:06:58,830
operational oversight within bid nine we

146
00:06:58,830 --> 00:07:00,930
fail to install our own product on a

147
00:07:00,930 --> 00:07:03,060
handful of computers within our own

148
00:07:03,060 --> 00:07:05,790
network we have a saying in Romania

149
00:07:05,790 --> 00:07:07,800
which is the shoemaker doesn't have

150
00:07:07,800 --> 00:07:11,670
shoes and the reality is this happens

151
00:07:11,670 --> 00:07:15,060
that people you know overlook systems

152
00:07:15,060 --> 00:07:16,620
they don't install security solutions

153
00:07:16,620 --> 00:07:19,290
everywhere even if those solutions could

154
00:07:19,290 --> 00:07:22,410
have stopped a lot of bridges and they

155
00:07:22,410 --> 00:07:24,120
do have knowledge that three customers

156
00:07:24,120 --> 00:07:26,670
only three customers were affected by

157
00:07:26,670 --> 00:07:29,400
the signed malware the Muellers signed

158
00:07:29,400 --> 00:07:32,160
with the bit nine certificates and I

159
00:07:32,160 --> 00:07:36,500
guess that if we fast forward the bit to

160
00:07:36,500 --> 00:07:42,150
2017 we see some similar cases one of

161
00:07:42,150 --> 00:07:45,630
them known as the shadow pad case this

162
00:07:45,630 --> 00:07:48,930
was in 2017 we got a call from a

163
00:07:48,930 --> 00:07:51,390
financial institution who was not our

164
00:07:51,390 --> 00:07:54,180
client however they said they have some

165
00:07:54,180 --> 00:07:56,670
unusual traffic in their networks and

166
00:07:56,670 --> 00:07:58,290
they want to hire us to investigate

167
00:07:58,290 --> 00:08:01,290
because they can pinpoint the source of

168
00:08:01,290 --> 00:08:05,340
that unusual traffic and we went to this

169
00:08:05,340 --> 00:08:07,650
financial institution well we also

170
00:08:07,650 --> 00:08:10,110
looked at the system I was making the

171
00:08:10,110 --> 00:08:12,030
traffic and that system was actually one

172
00:08:12,030 --> 00:08:16,790
used for payments in that bank and

173
00:08:16,790 --> 00:08:19,140
basically we couldn't identify any

174
00:08:19,140 --> 00:08:22,560
malware by looking at the files on disk

175
00:08:22,560 --> 00:08:24,780
so we dumped the memory we done that

176
00:08:24,780 --> 00:08:26,880
system and we started looking for the

177
00:08:26,880 --> 00:08:29,460
unusual network traffic in the memory

178
00:08:29,460 --> 00:08:31,740
dump and there we found there was a

179
00:08:31,740 --> 00:08:33,450
piece of software running of that

180
00:08:33,450 --> 00:08:35,760
machine from a company called net Sarang

181
00:08:35,760 --> 00:08:37,890
and that was actually a legitimate

182
00:08:37,890 --> 00:08:41,070
software used for remote management but

183
00:08:41,070 --> 00:08:43,200
inside his software there was an

184
00:08:43,200 --> 00:08:45,640
interesting piece of code the

185
00:08:45,640 --> 00:08:48,720
would attempt to contact a bunch of

186
00:08:48,720 --> 00:08:52,540
random domains and in the beginning we

187
00:08:52,540 --> 00:08:55,480
weren't entirely sure if this is a less

188
00:08:55,480 --> 00:08:58,420
a desired behavior maybe you know it's a

189
00:08:58,420 --> 00:09:00,399
legitimate software which is expected to

190
00:09:00,399 --> 00:09:03,310
do these things but when we compared it

191
00:09:03,310 --> 00:09:05,560
with all the versions of the software we

192
00:09:05,560 --> 00:09:07,779
discover that that piece of code has

193
00:09:07,779 --> 00:09:09,850
been injected into this software from

194
00:09:09,850 --> 00:09:11,980
netzarim so we got in touch with the

195
00:09:11,980 --> 00:09:14,560
Nets around and they did a brilliant

196
00:09:14,560 --> 00:09:17,680
thing at mitigating the attack so what

197
00:09:17,680 --> 00:09:19,870
happened here was another quite

198
00:09:19,870 --> 00:09:21,970
interesting case when Nets Arang was

199
00:09:21,970 --> 00:09:24,220
breached with the purpose of injecting

200
00:09:24,220 --> 00:09:27,250
this backdoor in this software that was

201
00:09:27,250 --> 00:09:30,760
actually used in a lot of enterprises

202
00:09:30,760 --> 00:09:34,690
around the world and that was let's say

203
00:09:34,690 --> 00:09:37,740
the entrance into all these different

204
00:09:37,740 --> 00:09:41,740
companies for a very interesting apt

205
00:09:41,740 --> 00:09:45,279
group that has been around for quite a

206
00:09:45,279 --> 00:09:48,160
long time and I guess that in my opinion

207
00:09:48,160 --> 00:09:50,260
they're probably the masters when it

208
00:09:50,260 --> 00:09:55,449
comes to supply chain attacks so if we

209
00:09:55,449 --> 00:09:58,360
look at the code from this malware that

210
00:09:58,360 --> 00:10:01,810
we recovered from the Nets rank case we

211
00:10:01,810 --> 00:10:04,329
discovered that was quite similar with

212
00:10:04,329 --> 00:10:06,279
the plugin from an old Erwin nti

213
00:10:06,279 --> 00:10:08,370
incident win and Ti is another

214
00:10:08,370 --> 00:10:10,990
interesting apt group and you'll see how

215
00:10:10,990 --> 00:10:14,140
it all falls into this equation and if

216
00:10:14,140 --> 00:10:15,490
you look at the code is pretty obvious

217
00:10:15,490 --> 00:10:20,380
what it does actually no it isn't but if

218
00:10:20,380 --> 00:10:22,180
you look at the code this way it's

219
00:10:22,180 --> 00:10:24,220
pretty obvious what it does probably

220
00:10:24,220 --> 00:10:28,269
still not so I think what it does it

221
00:10:28,269 --> 00:10:31,029
actually is a hashing algorithm for the

222
00:10:31,029 --> 00:10:34,480
API calls so they need to do this in

223
00:10:34,480 --> 00:10:36,579
order to run their shellcode in memory

224
00:10:36,579 --> 00:10:38,649
because they have no API imports in the

225
00:10:38,649 --> 00:10:42,250
code in this code with the two unique

226
00:10:42,250 --> 00:10:45,070
constants you see there mmm it's very

227
00:10:45,070 --> 00:10:47,320
specific and this actually allows you to

228
00:10:47,320 --> 00:10:49,600
group them together and to see you

229
00:10:49,600 --> 00:10:56,470
what's behind it now another I guess mmm

230
00:10:56,470 --> 00:10:58,449
interesting information about this

231
00:10:58,449 --> 00:10:59,350
attack came from

232
00:10:59,350 --> 00:11:01,420
Microsoft and Meyers of actually they

233
00:11:01,420 --> 00:11:04,690
took an apt group known as barium to

234
00:11:04,690 --> 00:11:07,450
court so they sue them and they said

235
00:11:07,450 --> 00:11:09,220
that the method of compromising still

236
00:11:09,220 --> 00:11:11,950
information involves the shadow pad

237
00:11:11,950 --> 00:11:14,920
malware which the barium different

238
00:11:14,920 --> 00:11:17,080
defendants distributed by a third

239
00:11:17,080 --> 00:11:18,670
third-party software provider

240
00:11:18,670 --> 00:11:20,500
compromised update we know it's nets

241
00:11:20,500 --> 00:11:24,460
around so this is Microsoft saying that

242
00:11:24,460 --> 00:11:28,120
the apt group known as barium was behind

243
00:11:28,120 --> 00:11:33,550
this Nets Arang incident if we go a bit

244
00:11:33,550 --> 00:11:37,480
further in September 2017 Morphy second

245
00:11:37,480 --> 00:11:40,540
Israeli company found another of quite

246
00:11:40,540 --> 00:11:42,400
interesting software ccleaner which is

247
00:11:42,400 --> 00:11:45,820
way more popular than Nets around

248
00:11:45,820 --> 00:11:47,290
software I think the Nets around

249
00:11:47,290 --> 00:11:50,170
software was used mostly in you know big

250
00:11:50,170 --> 00:11:52,720
enterprises but CCleaner I think they

251
00:11:52,720 --> 00:11:55,240
have over 16 million users around the

252
00:11:55,240 --> 00:11:59,770
world and one of the updates of ccleaner

253
00:11:59,770 --> 00:12:02,260
came with a very interesting piece of

254
00:12:02,260 --> 00:12:06,070
code inside which performed kind of a

255
00:12:06,070 --> 00:12:08,710
remote backdoor functionality and if we

256
00:12:08,710 --> 00:12:10,960
again will look at the code and this

257
00:12:10,960 --> 00:12:13,630
time there is no C code to help I think

258
00:12:13,630 --> 00:12:16,600
but if you look at the air it's a custom

259
00:12:16,600 --> 00:12:19,390
base 64 encoding and this is actually

260
00:12:19,390 --> 00:12:22,480
identical to the code used in a backdoor

261
00:12:22,480 --> 00:12:26,110
called missile from an apt group known

262
00:12:26,110 --> 00:12:33,370
as apt 17 which falls into something

263
00:12:33,370 --> 00:12:35,470
that people have called the axiom

264
00:12:35,470 --> 00:12:39,130
umbrella and there's a paper from Nevada

265
00:12:39,130 --> 00:12:41,290
which I guess is the definite of paper

266
00:12:41,290 --> 00:12:44,320
on the axiom group but to be honest the

267
00:12:44,320 --> 00:12:46,480
axiom group is something which is so big

268
00:12:46,480 --> 00:12:50,410
there there's a lot of different apt

269
00:12:50,410 --> 00:12:52,720
groups and operations which can fall

270
00:12:52,720 --> 00:12:58,090
under that but nevertheless the ccleaner

271
00:12:58,090 --> 00:13:01,690
attack is again confirmed by Microsoft

272
00:13:01,690 --> 00:13:05,710
at the virus bulletins conference John

273
00:13:05,710 --> 00:13:07,990
Lambert from Microsoft said that the

274
00:13:07,990 --> 00:13:11,470
barium apt was also behind the ccleaner

275
00:13:11,470 --> 00:13:13,320
attacks so we have the Barry

276
00:13:13,320 --> 00:13:15,990
a PT group behind the ccleaner attack we

277
00:13:15,990 --> 00:13:18,720
have it behind the shadow pet attack

278
00:13:18,720 --> 00:13:21,330
that we discovered so I guess that the

279
00:13:21,330 --> 00:13:23,850
kind of a picture starts to you know

280
00:13:23,850 --> 00:13:27,210
form and we also looked at other samples

281
00:13:27,210 --> 00:13:31,560
that have the same base 64 code and some

282
00:13:31,560 --> 00:13:34,830
of them are above a malware called hi

283
00:13:34,830 --> 00:13:35,850
kit

284
00:13:35,850 --> 00:13:38,250
and others are for malware known as

285
00:13:38,250 --> 00:13:41,160
socks PNG and it's quite interesting

286
00:13:41,160 --> 00:13:44,370
that there's a very good presentation by

287
00:13:44,370 --> 00:13:47,610
the way what is missile Chris McConkey

288
00:13:47,610 --> 00:13:51,270
from PwC spoke about a that SAS

289
00:13:51,270 --> 00:13:54,450
conference two years ago and he spoke

290
00:13:54,450 --> 00:13:56,220
about missile which is actually the

291
00:13:56,220 --> 00:13:59,910
nickname of a developer that worked for

292
00:13:59,910 --> 00:14:03,930
apt 17 and some of these Chinese

293
00:14:03,930 --> 00:14:06,980
speaking apt groups and there's a lot of

294
00:14:06,980 --> 00:14:09,780
digital trails he left on the internet

295
00:14:09,780 --> 00:14:13,070
all these years that you know eventually

296
00:14:13,070 --> 00:14:16,260
can identify him by the name and so on

297
00:14:16,260 --> 00:14:18,630
so I can recommend you to look at this

298
00:14:18,630 --> 00:14:20,880
clip however I think the most

299
00:14:20,880 --> 00:14:22,710
interesting part comes from the Nevada

300
00:14:22,710 --> 00:14:25,110
papers where they say that you know some

301
00:14:25,110 --> 00:14:27,690
of the malware used by axiom such as

302
00:14:27,690 --> 00:14:30,180
poison ivy goes that Excel does kind of

303
00:14:30,180 --> 00:14:30,870
generic

304
00:14:30,870 --> 00:14:36,600
however tools only seen by axiom or Sox

305
00:14:36,600 --> 00:14:41,070
PNG and Hickey and hike it for Hickey

306
00:14:41,070 --> 00:14:43,710
was one of the malware that was used in

307
00:14:43,710 --> 00:14:48,810
the beat 9 hack from 2011 so if you you

308
00:14:48,810 --> 00:14:50,700
know put all these things together you

309
00:14:50,700 --> 00:14:53,190
know a big picture starts to emerge and

310
00:14:53,190 --> 00:14:54,690
you realize that these guys have been

311
00:14:54,690 --> 00:14:57,780
around for a long time doing the supply

312
00:14:57,780 --> 00:15:00,450
chain attacks so probably going back to

313
00:15:00,450 --> 00:15:06,560
2009 that maybe even before so when n TI

314
00:15:06,560 --> 00:15:10,290
barium lad is another less a sister

315
00:15:10,290 --> 00:15:12,390
group of barium by Microsoft name and

316
00:15:12,390 --> 00:15:15,480
axiom how do they always say fit

317
00:15:15,480 --> 00:15:18,270
together well Microsoft published two

318
00:15:18,270 --> 00:15:21,150
blog about these guys in 2017 I split

319
00:15:21,150 --> 00:15:24,060
them into two activity groups known as

320
00:15:24,060 --> 00:15:26,970
barium and sled and they said the

321
00:15:26,970 --> 00:15:29,910
let's say one of the defining traits of

322
00:15:29,910 --> 00:15:31,830
these groups is their usage of the Wynn

323
00:15:31,830 --> 00:15:33,870
nti Mahler and that's interesting

324
00:15:33,870 --> 00:15:35,670
because we wrote about the Wynn nti

325
00:15:35,670 --> 00:15:40,590
malware in 2013 2012 although our

326
00:15:40,590 --> 00:15:42,870
research on the win nti malar begin

327
00:15:42,870 --> 00:15:49,200
around 2011 and when we started our

328
00:15:49,200 --> 00:15:52,230
research into this stuff we found a lot

329
00:15:52,230 --> 00:15:55,500
of forum posts in Chinese from a number

330
00:15:55,500 --> 00:15:58,110
of people so one of them for instance

331
00:15:58,110 --> 00:16:01,260
here it was a security researcher job

332
00:16:01,260 --> 00:16:04,200
like pen testing you know kind of the

333
00:16:04,200 --> 00:16:07,800
usual technical requirements nothing

334
00:16:07,800 --> 00:16:11,370
special there location is Guangdong or

335
00:16:11,370 --> 00:16:14,220
Guangzhou and it was a very cool comment

336
00:16:14,220 --> 00:16:17,190
there we said powerful background and no

337
00:16:17,190 --> 00:16:21,210
comments and if you're competent you

338
00:16:21,210 --> 00:16:23,420
know you can contact us at these

339
00:16:23,420 --> 00:16:25,650
addresses and you see that as like a

340
00:16:25,650 --> 00:16:28,830
free meal apartments of villa of 200

341
00:16:28,830 --> 00:16:31,590
meters and even a single completed

342
00:16:31,590 --> 00:16:33,900
project will provide you with the money

343
00:16:33,900 --> 00:16:37,590
for your monthly expenses and some

344
00:16:37,590 --> 00:16:41,910
people on the forum actually replied one

345
00:16:41,910 --> 00:16:46,230
of the actors emergency or M ER for E

346
00:16:46,230 --> 00:16:49,500
and 7y he replied to this job offer and

347
00:16:49,500 --> 00:16:51,390
merchants is actually one of the wynn

348
00:16:51,390 --> 00:16:53,850
nti actors that we identify he said

349
00:16:53,850 --> 00:16:56,420
aren't you recruiting people for apt

350
00:16:56,420 --> 00:16:59,520
Guangzhou is actually too far but anyway

351
00:16:59,520 --> 00:17:01,470
I supported while other people on the

352
00:17:01,470 --> 00:17:04,040
forum they said that powerful background

353
00:17:04,040 --> 00:17:07,680
actually means that it's supported by

354
00:17:07,680 --> 00:17:10,109
the government and it's kind of funny to

355
00:17:10,109 --> 00:17:12,540
see what happened to merchants II a

356
00:17:12,540 --> 00:17:15,569
couple of years later in June 2017 he

357
00:17:15,569 --> 00:17:19,020
was indicted for hacking into capstone

358
00:17:19,020 --> 00:17:24,359
turbine and we have him LS a quite

359
00:17:24,359 --> 00:17:27,619
nicely identifies an individual named

360
00:17:27,619 --> 00:17:30,900
Gao Hong Kuen together with a few other

361
00:17:30,900 --> 00:17:35,370
perpetrators but putting together all

362
00:17:35,370 --> 00:17:37,260
these different points and the trails

363
00:17:37,260 --> 00:17:38,310
they left

364
00:17:38,310 --> 00:17:40,560
behind all this years you realize that

365
00:17:40,560 --> 00:17:42,750
they've been doing these things for a

366
00:17:42,750 --> 00:17:45,690
very long time in a very very persistent

367
00:17:45,690 --> 00:17:49,500
manner compromising different companies

368
00:17:49,500 --> 00:17:53,370
as a means to get into other places so

369
00:17:53,370 --> 00:17:55,860
obviously why this is happening I guess

370
00:17:55,860 --> 00:17:58,080
that one of the reasons is that we build

371
00:17:58,080 --> 00:18:00,720
pretty good defenses everybody nowadays

372
00:18:00,720 --> 00:18:03,600
has antivirus firewall sandboxing

373
00:18:03,600 --> 00:18:07,200
next-gen whitelisting and actually

374
00:18:07,200 --> 00:18:10,170
bypassing all these different walls is

375
00:18:10,170 --> 00:18:13,140
getting harder and harder the truth is

376
00:18:13,140 --> 00:18:15,810
that the high-end actors will always

377
00:18:15,810 --> 00:18:17,820
find a way to breach a target they'll

378
00:18:17,820 --> 00:18:20,270
have a zero-day for anything right and

379
00:18:20,270 --> 00:18:23,130
they will eventually breach that target

380
00:18:23,130 --> 00:18:25,530
so to be honest high-end actors don't

381
00:18:25,530 --> 00:18:27,960
need this kind of supply chain attacks

382
00:18:27,960 --> 00:18:31,860
however medium tire actors did let's say

383
00:18:31,860 --> 00:18:33,540
you know this is kind of their bread and

384
00:18:33,540 --> 00:18:37,080
butter so groups such as those under the

385
00:18:37,080 --> 00:18:40,680
bigger axiom umbrella barium apt 10 this

386
00:18:40,680 --> 00:18:43,850
is I think one of the early say top

387
00:18:43,850 --> 00:18:47,220
methodologies and you know the law of

388
00:18:47,220 --> 00:18:49,980
tired actors will just have to move on

389
00:18:49,980 --> 00:18:55,110
to other targets now why are they so

390
00:18:55,110 --> 00:18:58,320
hard to discover well mainly because

391
00:18:58,320 --> 00:19:00,600
they abuse the existing trusts such as

392
00:19:00,600 --> 00:19:03,060
co-signing certificates or trusted

393
00:19:03,060 --> 00:19:05,370
update the mechanism so we had the case

394
00:19:05,370 --> 00:19:07,140
with one a cry a couple of years ago

395
00:19:07,140 --> 00:19:09,120
which happened because their people did

396
00:19:09,120 --> 00:19:11,880
install patches however a few months

397
00:19:11,880 --> 00:19:14,430
later we had the medoc incident in which

398
00:19:14,430 --> 00:19:18,360
you know the patches for me doc injected

399
00:19:18,360 --> 00:19:21,990
malware into all the victim systems and

400
00:19:21,990 --> 00:19:24,510
the problem is how to spot a tiny

401
00:19:24,510 --> 00:19:26,790
malicious code fragment which can be a

402
00:19:26,790 --> 00:19:29,340
few kilobytes in size within 20

403
00:19:29,340 --> 00:19:31,890
megabytes of clinical which is the

404
00:19:31,890 --> 00:19:34,500
proverbial needle in the haystack so

405
00:19:34,500 --> 00:19:36,900
these are I guess the main reasons why

406
00:19:36,900 --> 00:19:40,230
they are so hard to discover another

407
00:19:40,230 --> 00:19:42,630
thing is that there's a lot of hype sand

408
00:19:42,630 --> 00:19:44,790
rumors about supply chain attacks for

409
00:19:44,790 --> 00:19:46,620
instance how many people heard about the

410
00:19:46,620 --> 00:19:48,950
super micro story

411
00:19:48,950 --> 00:19:51,560
okay let's do it let's do it wrestler

412
00:19:51,560 --> 00:19:53,990
actually how many people believe that

413
00:19:53,990 --> 00:19:56,080
this story is true

414
00:19:56,080 --> 00:19:59,330
hmm one guy okay that's good two guys

415
00:19:59,330 --> 00:20:03,520
how many people believe it is untrue

416
00:20:03,520 --> 00:20:06,230
okay a few more and there's a lot of

417
00:20:06,230 --> 00:20:08,690
people who are probably not sure it's

418
00:20:08,690 --> 00:20:11,900
either way right well when when

419
00:20:11,900 --> 00:20:14,120
supermicro actually published the story

420
00:20:14,120 --> 00:20:16,910
they put a picture in that story um and

421
00:20:16,910 --> 00:20:18,380
that is you know you see they're the

422
00:20:18,380 --> 00:20:21,200
main board of a high-end Super Micro

423
00:20:21,200 --> 00:20:24,590
server and they circled a very small dot

424
00:20:24,590 --> 00:20:27,380
on the main board which is allegedly a

425
00:20:27,380 --> 00:20:30,910
small chip near the base plant near the

426
00:20:30,910 --> 00:20:34,370
main board the BMC the base board

427
00:20:34,370 --> 00:20:37,310
management controller and I know a lot

428
00:20:37,310 --> 00:20:39,590
of people who actually opened their

429
00:20:39,590 --> 00:20:42,170
Super Micro servers one of them being

430
00:20:42,170 --> 00:20:46,460
myself and started looking for that rice

431
00:20:46,460 --> 00:20:50,330
grain on the main board and it wasn't

432
00:20:50,330 --> 00:20:51,830
until teams that are posting on Twitter

433
00:20:51,830 --> 00:20:53,870
like if you're hunting for malicious

434
00:20:53,870 --> 00:20:56,500
chips based on the jiff from the story

435
00:20:56,500 --> 00:21:02,120
it's just an illustration yeah how many

436
00:21:02,120 --> 00:21:05,150
hours of time people wasted looking for

437
00:21:05,150 --> 00:21:07,550
that say I can confirm that at least I

438
00:21:07,550 --> 00:21:13,130
wasted a few hours on that so let me ask

439
00:21:13,130 --> 00:21:16,400
Vitaly to tell a few words about some

440
00:21:16,400 --> 00:21:18,530
other cases of supply chain attacks

441
00:21:18,530 --> 00:21:22,490
doing thank you thank you coach saying

442
00:21:22,490 --> 00:21:24,620
good morning everyone my name is Vitaly

443
00:21:24,620 --> 00:21:26,510
and I came from Singapore and I'm

444
00:21:26,510 --> 00:21:28,610
extremely excited to to be in candidates

445
00:21:28,610 --> 00:21:30,860
my first time here and I spent last five

446
00:21:30,860 --> 00:21:33,620
years in Singapore where we have 33

447
00:21:33,620 --> 00:21:37,160
degrees Celsius everyday 365 days a year

448
00:21:37,160 --> 00:21:40,610
and I was extremely excited to see snow

449
00:21:40,610 --> 00:21:46,640
this morning outside yeah and my slides

450
00:21:46,640 --> 00:21:48,710
they almost a little bit spiced with

451
00:21:48,710 --> 00:21:50,780
this technical ingredient so if you see

452
00:21:50,780 --> 00:21:52,370
too many technical screen should just

453
00:21:52,370 --> 00:21:54,350
start yawning massively okay so I'll

454
00:21:54,350 --> 00:21:57,680
just you know flip it quickly I wanted

455
00:21:57,680 --> 00:21:59,900
to start from the best of the supply

456
00:21:59,900 --> 00:22:02,450
chain attacks in my my point of view

457
00:22:02,450 --> 00:22:04,430
I gave it an Oscar mmm supply chain

458
00:22:04,430 --> 00:22:08,300
attacks it's this one that's the ATM

459
00:22:08,300 --> 00:22:10,370
card management software sorry you don't

460
00:22:10,370 --> 00:22:13,910
see it just a moment let me see okay

461
00:22:13,910 --> 00:22:17,390
the ATM card management software called

462
00:22:17,390 --> 00:22:20,780
smart card o in 1 or X one that was

463
00:22:20,780 --> 00:22:24,830
available on a number of forums well you

464
00:22:24,830 --> 00:22:27,470
can quickly look into this and and those

465
00:22:27,470 --> 00:22:29,030
securities are just realized that this

466
00:22:29,030 --> 00:22:31,280
is apparently not not the legitimate one

467
00:22:31,280 --> 00:22:33,350
in fact that one was distributed through

468
00:22:33,350 --> 00:22:37,670
a number of you know crooks only or the

469
00:22:37,670 --> 00:22:40,310
criminal forums criminal forums and a

470
00:22:40,310 --> 00:22:41,930
party that was not legit so it was used

471
00:22:41,930 --> 00:22:44,840
to be promoted it as a tool to flash

472
00:22:44,840 --> 00:22:48,230
those cards that contain chip on the

473
00:22:48,230 --> 00:22:49,700
card that were reprogrammed

474
00:22:49,700 --> 00:22:52,070
reprogrammable so it actually put some

475
00:22:52,070 --> 00:22:54,320
real banking account information of

476
00:22:54,320 --> 00:22:58,280
other stolen cards onto those cards that

477
00:22:58,280 --> 00:23:00,880
you have deployed kind of blank cards

478
00:23:00,880 --> 00:23:03,500
and it was basically the database

479
00:23:03,500 --> 00:23:05,180
management software and also flashing

480
00:23:05,180 --> 00:23:08,290
software that required this USB

481
00:23:08,290 --> 00:23:11,120
appliance basically to do the defleshing

482
00:23:11,120 --> 00:23:15,580
so the fun part of this is that someone

483
00:23:15,580 --> 00:23:18,170
decided to enhance this by adding a

484
00:23:18,170 --> 00:23:21,050
dependency to you as Aledo DOL that's

485
00:23:21,050 --> 00:23:22,880
generally known as compression library

486
00:23:22,880 --> 00:23:24,470
but the illegitimate one is called zili

487
00:23:24,470 --> 00:23:27,290
bwando dll so that that looks very much

488
00:23:27,290 --> 00:23:29,420
digit and they just modify the

489
00:23:29,420 --> 00:23:31,550
executable by adding dependency

490
00:23:31,550 --> 00:23:35,170
additional dll file that in fact

491
00:23:35,170 --> 00:23:38,270
resulted in loading of additional DLL

492
00:23:38,270 --> 00:23:40,580
into memory of that processor of the

493
00:23:40,580 --> 00:23:42,620
tool that was offered on the forum and

494
00:23:42,620 --> 00:23:45,080
it was distributed on the forums so what

495
00:23:45,080 --> 00:23:48,220
we found during this hunt after the

496
00:23:48,220 --> 00:23:50,660
Lazaro's gang or blue nor of gang that

497
00:23:50,660 --> 00:23:53,150
was known for this notorious hacker d

498
00:23:53,150 --> 00:23:55,430
Bank what their central bank in 2016

499
00:23:55,430 --> 00:23:59,840
when they try to steal 951 million years

500
00:23:59,840 --> 00:24:01,490
dollars from Central Bank of Bangladesh

501
00:24:01,490 --> 00:24:04,910
so these guys also tried to kind of

502
00:24:04,910 --> 00:24:06,950
piggyback and and hunt the other

503
00:24:06,950 --> 00:24:09,380
criminals to steal from their pockets

504
00:24:09,380 --> 00:24:10,960
it's kind of a third party collection

505
00:24:10,960 --> 00:24:13,970
from the criminals you know if you steal

506
00:24:13,970 --> 00:24:15,470
from criminals nobody will ever trace

507
00:24:15,470 --> 00:24:16,340
you

508
00:24:16,340 --> 00:24:18,529
back to you it'll probably find the

509
00:24:18,529 --> 00:24:20,539
original criminal that was hacked not

510
00:24:20,539 --> 00:24:23,270
not the the second player right so

511
00:24:23,270 --> 00:24:24,799
that's what they did and I call it the

512
00:24:24,799 --> 00:24:26,480
king of supply chain attacks because

513
00:24:26,480 --> 00:24:28,789
this actually targeted the criminals by

514
00:24:28,789 --> 00:24:30,409
other criminals

515
00:24:30,409 --> 00:24:32,750
so if only all of them were the same

516
00:24:32,750 --> 00:24:37,070
what about the real banking software is

517
00:24:37,070 --> 00:24:39,590
it getting breached so there is a story

518
00:24:39,590 --> 00:24:41,840
we found and I wanted to give a warning

519
00:24:41,840 --> 00:24:44,270
that not all banks are the same so I'm

520
00:24:44,270 --> 00:24:46,460
not talking about big develop banks but

521
00:24:46,460 --> 00:24:48,860
some of those that are from the kind of

522
00:24:48,860 --> 00:24:50,809
the middle level they don't actually

523
00:24:50,809 --> 00:24:52,970
have enough of budgets for proper

524
00:24:52,970 --> 00:24:55,190
security and you know control the

525
00:24:55,190 --> 00:24:57,830
software in their supply chain vendors

526
00:24:57,830 --> 00:25:00,919
this is why they got into troubles and

527
00:25:00,919 --> 00:25:04,159
we happen to discover these troubles so

528
00:25:04,159 --> 00:25:06,740
what we discovered was in the end the

529
00:25:06,740 --> 00:25:09,620
recipe that the criminals used so I

530
00:25:09,620 --> 00:25:11,110
wanted to show you this perfect pie

531
00:25:11,110 --> 00:25:13,159
cybercriminal pie in nine steps how to

532
00:25:13,159 --> 00:25:15,950
get into a bank or maybe a number of

533
00:25:15,950 --> 00:25:17,659
banks first of all you find an ATM

534
00:25:17,659 --> 00:25:20,539
manufacturer because every bank uses you

535
00:25:20,539 --> 00:25:21,740
know one way or another

536
00:25:21,740 --> 00:25:25,010
ATMs it has to be not too big because it

537
00:25:25,010 --> 00:25:27,260
must be easier easy to breach right so

538
00:25:27,260 --> 00:25:28,700
if it's a big one they will probably

539
00:25:28,700 --> 00:25:31,250
invest a lot into defense not too small

540
00:25:31,250 --> 00:25:32,779
has to be international so it's not

541
00:25:32,779 --> 00:25:34,760
based in your own country right better

542
00:25:34,760 --> 00:25:37,570
to cover the more country is the batter

543
00:25:37,570 --> 00:25:40,220
and then preferably offering white-label

544
00:25:40,220 --> 00:25:42,620
ATMs that means they're kind of non

545
00:25:42,620 --> 00:25:44,330
branded or can be shared by multiple

546
00:25:44,330 --> 00:25:46,909
banks by just you know gluing and

547
00:25:46,909 --> 00:25:50,059
sticking those logos on top that's a

548
00:25:50,059 --> 00:25:51,679
good thing because you can breach multi

549
00:25:51,679 --> 00:25:53,960
back multiple banks if you compromise

550
00:25:53,960 --> 00:25:56,929
this vendor and then you go and breach

551
00:25:56,929 --> 00:25:58,909
the software distribution website where

552
00:25:58,909 --> 00:26:00,950
this software is available injective

553
00:26:00,950 --> 00:26:02,720
tiny code into the software distributive

554
00:26:02,720 --> 00:26:06,919
wait wait war and then bingo you can

555
00:26:06,919 --> 00:26:09,020
please the dark side right now you can

556
00:26:09,020 --> 00:26:10,250
do whatever you want because this

557
00:26:10,250 --> 00:26:12,169
software will be downloaded distributive

558
00:26:12,169 --> 00:26:14,059
of the ATM management software will be

559
00:26:14,059 --> 00:26:16,940
downloaded by the banks willingly so

560
00:26:16,940 --> 00:26:19,549
it's kind of the watering hole attack

561
00:26:19,549 --> 00:26:21,440
against banks and this has really

562
00:26:21,440 --> 00:26:23,539
happened so all these points are from

563
00:26:23,539 --> 00:26:25,850
the real case that we discovered couple

564
00:26:25,850 --> 00:26:28,070
years ago one of our customers in

565
00:26:28,070 --> 00:26:29,990
Australia actually showed signs

566
00:26:29,990 --> 00:26:32,390
of some animals activities beaming out

567
00:26:32,390 --> 00:26:34,429
of their networks so when we investigate

568
00:26:34,429 --> 00:26:37,370
how it happened we narrow it down to the

569
00:26:37,370 --> 00:26:39,440
distributive of the software that the

570
00:26:39,440 --> 00:26:41,750
administrator has brilliantly downloaded

571
00:26:41,750 --> 00:26:44,330
from the vendor website and that one was

572
00:26:44,330 --> 00:26:47,920
still distributing the trojan eyes

573
00:26:47,920 --> 00:26:53,210
software for anyone in the world so

574
00:26:53,210 --> 00:26:57,710
there is 0.9 if you noticed so in ideal

575
00:26:57,710 --> 00:26:59,179
case of course you have to be caught by

576
00:26:59,179 --> 00:27:03,800
Kaspersky but that's how it looked the

577
00:27:03,800 --> 00:27:06,320
distributive and all the bad guys needed

578
00:27:06,320 --> 00:27:08,420
to do is just to inject these few lines

579
00:27:08,420 --> 00:27:11,030
of the original basic script into the

580
00:27:11,030 --> 00:27:15,260
msi installation package so and that was

581
00:27:15,260 --> 00:27:18,350
one that case was linked back to the

582
00:27:18,350 --> 00:27:18,980
us-based

583
00:27:18,980 --> 00:27:21,679
vendor radium's who we notified shortly

584
00:27:21,679 --> 00:27:23,420
after in discovery and they had to put

585
00:27:23,420 --> 00:27:25,490
it down and do the cleanup on their side

586
00:27:25,490 --> 00:27:28,370
but just a few lines of code you know

587
00:27:28,370 --> 00:27:30,230
that leads to the cushion of PowerShell

588
00:27:30,230 --> 00:27:32,350
downloading of additional components and

589
00:27:32,350 --> 00:27:35,090
eventually breach in a number of banks

590
00:27:35,090 --> 00:27:39,370
that use this software let's move on and

591
00:27:39,370 --> 00:27:42,320
kind of the the main course of our

592
00:27:42,320 --> 00:27:44,179
presentations the shadow hammer story it

593
00:27:44,179 --> 00:27:48,320
happened this year where we me and

594
00:27:48,320 --> 00:27:50,570
costing worked closely on this

595
00:27:50,570 --> 00:27:52,970
particular investigation and in the

596
00:27:52,970 --> 00:27:54,350
beginning I wanted to say that it was

597
00:27:54,350 --> 00:27:58,160
rated first of all last year people

598
00:27:58,160 --> 00:28:01,490
wouldn't read it that are quite security

599
00:28:01,490 --> 00:28:05,210
savvy notice that there was a new update

600
00:28:05,210 --> 00:28:07,010
from Asus or

601
00:28:07,010 --> 00:28:09,650
Asus company from Japan and they

602
00:28:09,650 --> 00:28:11,809
normally show like what is in the update

603
00:28:11,809 --> 00:28:14,390
so they show this notification of a

604
00:28:14,390 --> 00:28:16,190
critical update but it was nothing so

605
00:28:16,190 --> 00:28:17,300
basically there was an update that

606
00:28:17,300 --> 00:28:20,300
installed nothing which looked a little

607
00:28:20,300 --> 00:28:22,250
bit strange to some of people they

608
00:28:22,250 --> 00:28:23,990
started looking into a quote exactly it

609
00:28:23,990 --> 00:28:26,809
is what's the executable and some of

610
00:28:26,809 --> 00:28:30,050
them noticed that that's a little bit

611
00:28:30,050 --> 00:28:32,840
strange one

612
00:28:32,840 --> 00:28:34,640
some people are posited to you to

613
00:28:34,640 --> 00:28:37,309
virustotal to check for potential more

614
00:28:37,309 --> 00:28:39,830
inside and of course that was was clean

615
00:28:39,830 --> 00:28:42,460
because it had digital signature by asus

616
00:28:42,460 --> 00:28:44,600
assess a computer

617
00:28:44,600 --> 00:28:47,540
was a valid verifiable signature by a

618
00:28:47,540 --> 00:28:49,160
trusted vendor right it was not detected

619
00:28:49,160 --> 00:28:52,180
by any IV so people go down very quickly

620
00:28:52,180 --> 00:28:54,770
some of them found other explanation of

621
00:28:54,770 --> 00:28:58,690
some Rock misspelling of the board force

622
00:28:58,690 --> 00:29:01,340
someone speculated that just because a

623
00:29:01,340 --> 00:29:02,990
source is unknown German company

624
00:29:02,990 --> 00:29:05,090
apparently and you know they do have

625
00:29:05,090 --> 00:29:06,710
these kind of mistakes you can see this

626
00:29:06,710 --> 00:29:10,220
file name of their spouse force in it

627
00:29:10,220 --> 00:29:15,680
was a mistake but the problem was

628
00:29:15,680 --> 00:29:19,250
apparently deeper so people actually

629
00:29:19,250 --> 00:29:21,680
cooled down because nobody detected

630
00:29:21,680 --> 00:29:23,330
nobody found anything suspicious there

631
00:29:23,330 --> 00:29:24,980
was no network activity from that

632
00:29:24,980 --> 00:29:32,840
executable and people let it go and also

633
00:29:32,840 --> 00:29:35,120
somebody actually noticed that the

634
00:29:35,120 --> 00:29:37,150
executable that was pushed was dated as

635
00:29:37,150 --> 00:29:41,990
made in 2015 and they even try to

636
00:29:41,990 --> 00:29:44,600
contact the technical support of Isis

637
00:29:44,600 --> 00:29:47,360
and ask about that and it tried to also

638
00:29:47,360 --> 00:29:50,570
calm him down and suggesting to scan

639
00:29:50,570 --> 00:29:53,000
their computers for viruses if if they

640
00:29:53,000 --> 00:29:57,950
are you know feeling paranoid partly

641
00:29:57,950 --> 00:30:00,560
they did not discover anything for those

642
00:30:00,560 --> 00:30:03,440
people but human the curious discover

643
00:30:03,440 --> 00:30:06,410
later it happened in the end of January

644
00:30:06,410 --> 00:30:09,350
this year where we spotted some fishing

645
00:30:09,350 --> 00:30:13,280
updates that contained the partly

646
00:30:13,280 --> 00:30:17,210
something something strange they were

647
00:30:17,210 --> 00:30:20,540
coming from the official as update

648
00:30:20,540 --> 00:30:22,550
server and it was related to the live

649
00:30:22,550 --> 00:30:25,610
update utility of Asus and we had

650
00:30:25,610 --> 00:30:28,150
digital signature but at the same time

651
00:30:28,150 --> 00:30:31,100
there was something in them the trigger

652
00:30:31,100 --> 00:30:34,130
tower our detection so we recently

653
00:30:34,130 --> 00:30:36,200
started hunting for different techniques

654
00:30:36,200 --> 00:30:39,080
used by apt groups and then we found a

655
00:30:39,080 --> 00:30:41,360
match in one of those digitally signed

656
00:30:41,360 --> 00:30:42,710
binary so initially we thought that was

657
00:30:42,710 --> 00:30:44,210
a false positive but when you look

658
00:30:44,210 --> 00:30:46,700
closer we found that in fact it

659
00:30:46,700 --> 00:30:48,830
contained injection and it wasn't the

660
00:30:48,830 --> 00:30:50,600
same exact executable that was dated as

661
00:30:50,600 --> 00:30:53,750
2015 but pushed last year to customers

662
00:30:53,750 --> 00:30:57,700
of Asus so it all looked fishy

663
00:30:57,700 --> 00:31:00,100
we quickly made a report and and get in

664
00:31:00,100 --> 00:31:02,409
touch with Isis to do our due diligence

665
00:31:02,409 --> 00:31:04,779
we reported that there's some malicious

666
00:31:04,779 --> 00:31:06,429
injection they definitely need to check

667
00:31:06,429 --> 00:31:08,440
all of their is cute bulls and take care

668
00:31:08,440 --> 00:31:10,440
of that and we keep kept supporting them

669
00:31:10,440 --> 00:31:15,090
since that answering all their questions

670
00:31:15,090 --> 00:31:17,380
technical questions and we made quite a

671
00:31:17,380 --> 00:31:20,230
few of discoveries on the way so the

672
00:31:20,230 --> 00:31:22,389
Victorian techniques do used the in fact

673
00:31:22,389 --> 00:31:24,940
took all the executable from Asus from

674
00:31:24,940 --> 00:31:27,610
2015 and then they patched it they

675
00:31:27,610 --> 00:31:29,380
injected tiny malicious code and and

676
00:31:29,380 --> 00:31:31,330
replaced one of the resource files in

677
00:31:31,330 --> 00:31:33,250
inside so they could transfer the

678
00:31:33,250 --> 00:31:35,320
execution flow from the original

679
00:31:35,320 --> 00:31:36,970
executable the benign one to the

680
00:31:36,970 --> 00:31:39,100
malicious and then download additional

681
00:31:39,100 --> 00:31:42,100
components from the network so in the

682
00:31:42,100 --> 00:31:44,049
middle of last year they understood

683
00:31:44,049 --> 00:31:46,090
that's probably you know too visible

684
00:31:46,090 --> 00:31:48,279
it was all in plain text and so the

685
00:31:48,279 --> 00:31:49,929
added encryption they had an additional

686
00:31:49,929 --> 00:31:52,570
layer and that's why they introduced the

687
00:31:52,570 --> 00:31:54,309
payload Decrypter added to you one of

688
00:31:54,309 --> 00:31:56,919
the executable code sections but the

689
00:31:56,919 --> 00:31:58,480
principle remains the same they just

690
00:31:58,480 --> 00:32:00,970
patch the same executable from 2015 they

691
00:32:00,970 --> 00:32:02,409
didn't even care about changing the

692
00:32:02,409 --> 00:32:09,990
timestamp so these are some of the

693
00:32:09,990 --> 00:32:12,760
screenshots how how the early very

694
00:32:12,760 --> 00:32:15,039
inspector looked like nothing special

695
00:32:15,039 --> 00:32:18,309
but just a location of the memory and

696
00:32:18,309 --> 00:32:20,980
then running that executable code in

697
00:32:20,980 --> 00:32:24,510
that block what was interesting is this

698
00:32:24,510 --> 00:32:28,389
original PDB path or program debug

699
00:32:28,389 --> 00:32:30,519
database or ICU Authority onion okay

700
00:32:30,519 --> 00:32:33,370
that's good okay I'll start doing this

701
00:32:33,370 --> 00:32:36,429
so you can see the dig created project

702
00:32:36,429 --> 00:32:38,850
cause also schalke which means they

703
00:32:38,850 --> 00:32:40,210
specifically

704
00:32:40,210 --> 00:32:42,399
program that payload for asses

705
00:32:42,399 --> 00:32:44,559
individually so did not reuse any of

706
00:32:44,559 --> 00:32:46,419
their tools they made it specifically

707
00:32:46,419 --> 00:32:48,970
for this company which is kind of cool

708
00:32:48,970 --> 00:32:50,950
they definitely cared about not being

709
00:32:50,950 --> 00:32:54,100
detected so the new variants they just

710
00:32:54,100 --> 00:32:57,010
change the technique how they inject the

711
00:32:57,010 --> 00:32:59,679
code they replaced come one of the

712
00:32:59,679 --> 00:33:01,870
common runtime functions such standard

713
00:33:01,870 --> 00:33:03,700
functions added to executables while you

714
00:33:03,700 --> 00:33:06,460
can fire with a visual C so it looks

715
00:33:06,460 --> 00:33:08,649
very much legit so they just hijacked

716
00:33:08,649 --> 00:33:10,680
the address where the

717
00:33:10,680 --> 00:33:15,950
always been made to their own shellcode

718
00:33:15,950 --> 00:33:20,190
loader basically also goes through this

719
00:33:20,190 --> 00:33:22,440
another thing we found is that I'm

720
00:33:22,440 --> 00:33:26,010
actually 230 of unique samples that we

721
00:33:26,010 --> 00:33:27,360
discovered and we wanna require they're

722
00:33:27,360 --> 00:33:29,430
all different and they all contain these

723
00:33:29,430 --> 00:33:32,550
strange tables of hexadecimal numbers

724
00:33:32,550 --> 00:33:35,310
and then we analyze like what was those

725
00:33:35,310 --> 00:33:40,820
numbers they were actually quadruples of

726
00:33:40,820 --> 00:33:44,550
numbers all together deformed the md5

727
00:33:44,550 --> 00:33:46,950
hash of the MAC address your physical

728
00:33:46,950 --> 00:33:48,510
address with your network card be it

729
00:33:48,510 --> 00:33:51,870
Wi-Fi court or the land network card so

730
00:33:51,870 --> 00:33:54,480
they try to target people individually

731
00:33:54,480 --> 00:33:57,300
by their MAC addresses sometimes if you

732
00:33:57,300 --> 00:33:59,700
have two network cards installed usually

733
00:33:59,700 --> 00:34:01,920
just land and Wi-Fi they would verify

734
00:34:01,920 --> 00:34:05,220
those MAC addresses per victim so to be

735
00:34:05,220 --> 00:34:07,350
very very precise and it really cared

736
00:34:07,350 --> 00:34:09,540
about who you get hit by this although

737
00:34:09,540 --> 00:34:11,730
this update from Asus was pushed to

738
00:34:11,730 --> 00:34:13,650
probably hundreds of thousands of users

739
00:34:13,650 --> 00:34:16,320
the only were after a few hundreds of

740
00:34:16,320 --> 00:34:20,190
users and it's still not very clear like

741
00:34:20,190 --> 00:34:23,040
who those where we try to find the

742
00:34:23,040 --> 00:34:24,989
targets we even started an open campaign

743
00:34:24,989 --> 00:34:27,989
like verify if you're in that list and

744
00:34:27,989 --> 00:34:30,420
so on we released a free tool to check

745
00:34:30,420 --> 00:34:33,060
if you were targeted but so far we

746
00:34:33,060 --> 00:34:35,219
haven't seen any real hits there was

747
00:34:35,219 --> 00:34:38,070
some false positive some why we 3G

748
00:34:38,070 --> 00:34:39,929
modems for example we're hurting the

749
00:34:39,929 --> 00:34:41,820
list but they all shared the same MAC

750
00:34:41,820 --> 00:34:43,409
address for some reason so all devices

751
00:34:43,409 --> 00:34:45,719
had the same those were false positives

752
00:34:45,719 --> 00:34:49,199
but but no real victims came back to us

753
00:34:49,199 --> 00:34:51,480
we could only see I could only make this

754
00:34:51,480 --> 00:34:54,020
breakout by by the vendors of the

755
00:34:54,020 --> 00:34:56,219
manufacturers of the network cards

756
00:34:56,219 --> 00:34:58,230
apparently the leading one was assisted

757
00:34:58,230 --> 00:35:00,480
computers itself and then there was into

758
00:35:00,480 --> 00:35:04,740
and other wave technology so it doesn't

759
00:35:04,740 --> 00:35:06,720
tell us much who exactly where those

760
00:35:06,720 --> 00:35:09,050
targets were the politicians were they

761
00:35:09,050 --> 00:35:11,460
scientists where they security

762
00:35:11,460 --> 00:35:13,920
researchers we don't really know it's do

763
00:35:13,920 --> 00:35:16,620
a mystery now but the story doesn't end

764
00:35:16,620 --> 00:35:20,580
here so there is a actually extension of

765
00:35:20,580 --> 00:35:22,410
this once we found as we started hunting

766
00:35:22,410 --> 00:35:23,890
for four

767
00:35:23,890 --> 00:35:27,010
or using detection for the technique

768
00:35:27,010 --> 00:35:29,980
itself and very quickly within days we

769
00:35:29,980 --> 00:35:32,740
found more it all happened in in

770
00:35:32,740 --> 00:35:34,720
beginning of February it was boom

771
00:35:34,720 --> 00:35:38,320
because I live in Asia and the research

772
00:35:38,320 --> 00:35:41,230
thing as Chinese New Year it's pretty

773
00:35:41,230 --> 00:35:43,000
much like Christmas in in the Western

774
00:35:43,000 --> 00:35:45,790
world and you can imagine that role I

775
00:35:45,790 --> 00:35:48,700
had when I had to call asses and a

776
00:35:48,700 --> 00:35:50,350
number of other vendors and tell them

777
00:35:50,350 --> 00:35:51,970
just before Christmas that they are

778
00:35:51,970 --> 00:35:54,390
breached the digital signature

779
00:35:54,390 --> 00:35:57,220
certificates are stolen and abused to

780
00:35:57,220 --> 00:35:58,510
distribute malware from their own

781
00:35:58,510 --> 00:35:59,380
websites

782
00:35:59,380 --> 00:36:01,450
that's not type of news you probably

783
00:36:01,450 --> 00:36:04,210
want to report to the ventas so I had

784
00:36:04,210 --> 00:36:06,930
some hard time and hard conversations

785
00:36:06,930 --> 00:36:10,300
with with those but we managed to find

786
00:36:10,300 --> 00:36:12,250
more companies so there are at least

787
00:36:12,250 --> 00:36:14,650
three different Asian gaming vendors

788
00:36:14,650 --> 00:36:17,050
that were compromised in the similar

789
00:36:17,050 --> 00:36:19,930
manner but the bad guys injected code

790
00:36:19,930 --> 00:36:22,120
into digitally signed executables the

791
00:36:22,120 --> 00:36:25,090
certificates were all genuine so the

792
00:36:25,090 --> 00:36:27,700
binaries were validated but they

793
00:36:27,700 --> 00:36:30,820
contained malicious injections and later

794
00:36:30,820 --> 00:36:33,340
we I figure out what arsenal they used

795
00:36:33,340 --> 00:36:35,650
and we started you know identifying

796
00:36:35,650 --> 00:36:37,290
those hosts on the internet and we found

797
00:36:37,290 --> 00:36:40,420
three additional businesses for some

798
00:36:40,420 --> 00:36:41,770
reason they were all located in South

799
00:36:41,770 --> 00:36:44,050
Korea some of them were game vendors

800
00:36:44,050 --> 00:36:45,490
some of them were from a suitable

801
00:36:45,490 --> 00:36:46,930
company some of them were a big

802
00:36:46,930 --> 00:36:49,270
enterprise like conglomerate from South

803
00:36:49,270 --> 00:36:52,330
Korea doing pretty much everything they

804
00:36:52,330 --> 00:36:54,340
had those back doors installed on their

805
00:36:54,340 --> 00:36:57,190
service but the beginning of the story

806
00:36:57,190 --> 00:36:59,410
like all this malware became linked to

807
00:36:59,410 --> 00:37:03,400
one actor or at least the the group that

808
00:37:03,400 --> 00:37:05,830
is known as an axiom umbrella so it's

809
00:37:05,830 --> 00:37:07,420
basically several groups perhaps they

810
00:37:07,420 --> 00:37:10,210
were actors but kind of linked to each

811
00:37:10,210 --> 00:37:11,410
other

812
00:37:11,410 --> 00:37:13,630
initially they were reported to us in

813
00:37:13,630 --> 00:37:14,580
the end of November

814
00:37:14,580 --> 00:37:17,530
what about partners came to me and said

815
00:37:17,530 --> 00:37:19,240
look I have this sample I don't know

816
00:37:19,240 --> 00:37:20,350
what it is can you tell me if it's

817
00:37:20,350 --> 00:37:21,760
Malvar or not and I'm like reverse

818
00:37:21,760 --> 00:37:24,010
engineer said like okay couple vows and

819
00:37:24,010 --> 00:37:26,680
and you know I'll do this I spent couple

820
00:37:26,680 --> 00:37:31,120
of hours no but they know few days more

821
00:37:31,120 --> 00:37:34,210
I couldn't break that I like it was it

822
00:37:34,210 --> 00:37:36,180
was like a a very sophisticated

823
00:37:36,180 --> 00:37:37,250
commercial

824
00:37:37,250 --> 00:37:40,760
oh great Packer the virtual

825
00:37:40,760 --> 00:37:42,470
machine-based which is usually you know

826
00:37:42,470 --> 00:37:45,080
hard turn pack but on top they had

827
00:37:45,080 --> 00:37:47,450
additional protectors I'm going to show

828
00:37:47,450 --> 00:37:51,080
you this in few slides but first of all

829
00:37:51,080 --> 00:37:53,120
just linking these all cases together an

830
00:37:53,120 --> 00:37:55,910
s-rank story that Costin mentioned the

831
00:37:55,910 --> 00:37:59,000
shadow pad breach in this korean vendor

832
00:37:59,000 --> 00:38:02,950
of seven management software nets ranked

833
00:38:03,340 --> 00:38:06,830
there was sign in this case of the game

834
00:38:06,830 --> 00:38:09,560
in vendor that they also use nets ranked

835
00:38:09,560 --> 00:38:12,500
internally so it just a coincidence but

836
00:38:12,500 --> 00:38:15,590
it could be also a vector of you know

837
00:38:15,590 --> 00:38:18,910
how did attackers could get in then in

838
00:38:18,910 --> 00:38:21,440
sickly in a story where shadow parties

839
00:38:21,440 --> 00:38:25,400
also seems to be responsible it was

840
00:38:25,400 --> 00:38:27,710
published by a vast the company that now

841
00:38:27,710 --> 00:38:30,800
owns the ccleaner software that asses

842
00:38:30,800 --> 00:38:33,260
was among the targets that received

843
00:38:33,260 --> 00:38:34,940
second stage payload that means they

844
00:38:34,940 --> 00:38:37,130
were breached in other words they were

845
00:38:37,130 --> 00:38:38,720
target in the neighbor bridge so it

846
00:38:38,720 --> 00:38:40,280
could also be a precursor of these

847
00:38:40,280 --> 00:38:42,650
attacks that we see this year so it's

848
00:38:42,650 --> 00:38:44,840
stretching over many years and also

849
00:38:44,840 --> 00:38:47,150
there is a link through the korean cook

850
00:38:47,150 --> 00:38:49,190
university there is a command control

851
00:38:49,190 --> 00:38:51,830
center and that there were two different

852
00:38:51,830 --> 00:38:53,060
command control centers but they were

853
00:38:53,060 --> 00:38:57,170
all in the same small IT range swears

854
00:38:57,170 --> 00:39:00,470
twenty-four network and we don't think

855
00:39:00,470 --> 00:39:02,000
that this is just a coincidence they

856
00:39:02,000 --> 00:39:04,100
just systematically abused that

857
00:39:04,100 --> 00:39:06,140
particular network to host their proxies

858
00:39:06,140 --> 00:39:10,040
for the command control centers few

859
00:39:10,040 --> 00:39:12,260
words about the arsenal of tools some of

860
00:39:12,260 --> 00:39:14,300
the cool things they do they use cheap

861
00:39:14,300 --> 00:39:16,730
tools to burn them first just in case

862
00:39:16,730 --> 00:39:19,160
it's picked up by security products or

863
00:39:19,160 --> 00:39:20,930
administrators or security researchers

864
00:39:20,930 --> 00:39:23,150
so the users rudimentary backdoor that

865
00:39:23,150 --> 00:39:25,400
is written probably by some students or

866
00:39:25,400 --> 00:39:28,250
juniors in their teams so they push it

867
00:39:28,250 --> 00:39:29,960
first for initial recurrences and this

868
00:39:29,960 --> 00:39:32,360
is where they collect MAC addresses if

869
00:39:32,360 --> 00:39:33,920
you've been wondering aquatic god those

870
00:39:33,920 --> 00:39:36,020
MAC addresses of the targets probably D

871
00:39:36,020 --> 00:39:38,000
collected throughout a number of other

872
00:39:38,000 --> 00:39:40,760
campaigns through such back there

873
00:39:40,760 --> 00:39:41,930
interestingly this back door actually

874
00:39:41,930 --> 00:39:43,400
detected all versions of feed on

875
00:39:43,400 --> 00:39:44,990
starting from Windows 95

876
00:39:44,990 --> 00:39:48,050
I guess the interested in that too but

877
00:39:48,050 --> 00:39:50,150
that one was very minimalistic so they

878
00:39:50,150 --> 00:39:51,360
see the target is in

879
00:39:51,360 --> 00:39:52,500
and they would push something more

880
00:39:52,500 --> 00:39:54,690
complex such as this and this is what

881
00:39:54,690 --> 00:39:56,400
I've been working on since the end of

882
00:39:56,400 --> 00:39:59,220
November that's the model Eric first it

883
00:39:59,220 --> 00:40:01,020
was like vien protect shield it called

884
00:40:01,020 --> 00:40:03,600
like multiple layers of decryption

885
00:40:03,600 --> 00:40:05,430
decryption decryption at some stage I

886
00:40:05,430 --> 00:40:08,160
got stuck because it decrypted using the

887
00:40:08,160 --> 00:40:10,320
key I didn't have it was the key that

888
00:40:10,320 --> 00:40:13,380
derived from the one of the kind of

889
00:40:13,380 --> 00:40:15,330
system properties it was a serial number

890
00:40:15,330 --> 00:40:18,420
of the drive C that was used to produce

891
00:40:18,420 --> 00:40:20,760
the key to dynamically decrypt it in the

892
00:40:20,760 --> 00:40:22,680
next payload and execute that so if you

893
00:40:22,680 --> 00:40:25,110
don't have the right serial number of

894
00:40:25,110 --> 00:40:28,950
your C Drive it will just crash which

895
00:40:28,950 --> 00:40:30,420
happened to me which happened to the

896
00:40:30,420 --> 00:40:32,550
sandbox analysis and many other attempts

897
00:40:32,550 --> 00:40:34,440
to analyze it so I had to brute-force

898
00:40:34,440 --> 00:40:37,260
and find the right the right zero number

899
00:40:37,260 --> 00:40:39,360
in order to continue analysis so it took

900
00:40:39,360 --> 00:40:41,730
me some time to make the tool to brute

901
00:40:41,730 --> 00:40:45,450
force effectively and then eventually

902
00:40:45,450 --> 00:40:48,060
discover like the whole set of the

903
00:40:48,060 --> 00:40:51,450
connectors and plugins they have and in

904
00:40:51,450 --> 00:40:52,680
the end it didn't contain the real

905
00:40:52,680 --> 00:40:54,240
payload it would go to the Google Drive

906
00:40:54,240 --> 00:40:57,180
and fetch the next stage command control

907
00:40:57,180 --> 00:41:00,870
server address the interesting tool

908
00:41:00,870 --> 00:41:03,210
among those used by this actor was

909
00:41:03,210 --> 00:41:06,000
several persistence this is what we

910
00:41:06,000 --> 00:41:07,350
managed to find out internet live

911
00:41:07,350 --> 00:41:11,850
servers hosting that malware it's very

912
00:41:11,850 --> 00:41:14,580
cool too they kind of open and work on

913
00:41:14,580 --> 00:41:16,170
top of the port 80 which is a common

914
00:41:16,170 --> 00:41:19,170
port for the web servers right the HTTP

915
00:41:19,170 --> 00:41:22,200
protocol the old one but they kind of

916
00:41:22,200 --> 00:41:24,570
add additional channel so they can host

917
00:41:24,570 --> 00:41:26,790
their executable in separate process not

918
00:41:26,790 --> 00:41:30,360
as the traditional web script or the web

919
00:41:30,360 --> 00:41:32,430
application but it runs as an executable

920
00:41:32,430 --> 00:41:35,520
and and replies to certain requests

921
00:41:35,520 --> 00:41:40,290
through through the Microsoft HTTP API

922
00:41:40,290 --> 00:41:43,110
so it's extremely hard for system

923
00:41:43,110 --> 00:41:46,230
administrators to track it trace it back

924
00:41:46,230 --> 00:41:47,630
to the particular executable that

925
00:41:47,630 --> 00:41:50,730
processes a specific HTTP request

926
00:41:50,730 --> 00:41:52,590
because there is no mechanism in Windows

927
00:41:52,590 --> 00:41:58,770
that that can help you do that so if you

928
00:41:58,770 --> 00:42:02,190
remember the also skis right and it

929
00:42:02,190 --> 00:42:04,570
seemed big

930
00:42:04,570 --> 00:42:06,190
in fact according to our lead we got

931
00:42:06,190 --> 00:42:10,960
only 57,000 of our customers having one

932
00:42:10,960 --> 00:42:13,030
way or another those Trojan ice

933
00:42:13,030 --> 00:42:15,010
executables and now of course don't

934
00:42:15,010 --> 00:42:18,160
everybody uses Kaspersky right and not

935
00:42:18,160 --> 00:42:19,900
everybody uses antivirus at all

936
00:42:19,900 --> 00:42:22,120
so the real numbers are probably you

937
00:42:22,120 --> 00:42:24,970
know much much more like time so maybe

938
00:42:24,970 --> 00:42:27,640
dozens times more than this but if you

939
00:42:27,640 --> 00:42:28,720
look at the gaming industry there's

940
00:42:28,720 --> 00:42:30,340
three vendors that we managed to

941
00:42:30,340 --> 00:42:34,270
discover already we're twice as big as

942
00:42:34,270 --> 00:42:36,490
the Asus case so we're probably talking

943
00:42:36,490 --> 00:42:40,060
about many many more users and in that

944
00:42:40,060 --> 00:42:42,040
particular case the targeted pretty much

945
00:42:42,040 --> 00:42:44,140
everyone they collected information from

946
00:42:44,140 --> 00:42:46,660
every single system in Asus case they

947
00:42:46,660 --> 00:42:48,640
were much more careful few hundreds were

948
00:42:48,640 --> 00:42:50,380
targeted so there was no network

949
00:42:50,380 --> 00:42:52,020
connections no network activity

950
00:42:52,020 --> 00:42:54,070
noticeable on those systems that were

951
00:42:54,070 --> 00:42:58,180
not targeted so gaming users from the

952
00:42:58,180 --> 00:42:59,860
video game in the world of course don't

953
00:42:59,860 --> 00:43:01,900
care that much about suspicious

954
00:43:01,900 --> 00:43:04,510
connections and their OS security

955
00:43:04,510 --> 00:43:06,520
cautious that's why they target everyone

956
00:43:06,520 --> 00:43:09,190
to get as much information as possible

957
00:43:09,190 --> 00:43:13,270
so coming back to the malware injection

958
00:43:13,270 --> 00:43:14,200
technique I just wanted to highlight

959
00:43:14,200 --> 00:43:16,090
that in Asus case made it

960
00:43:16,090 --> 00:43:18,130
tiny injection to original executable

961
00:43:18,130 --> 00:43:20,290
and in the gaming vendor stated

962
00:43:20,290 --> 00:43:23,980
something very different the model was

963
00:43:23,980 --> 00:43:26,620
seamlessly integrated into executable it

964
00:43:26,620 --> 00:43:28,660
looked like the developer put it there

965
00:43:28,660 --> 00:43:31,120
in the source code from the reverse

966
00:43:31,120 --> 00:43:33,340
engineering perspective and this is what

967
00:43:33,340 --> 00:43:35,460
we were wondering like where those

968
00:43:35,460 --> 00:43:38,470
vendors having some inside job or or

969
00:43:38,470 --> 00:43:40,510
what work but three companies at the

970
00:43:40,510 --> 00:43:43,510
same time it didn't look quite real so

971
00:43:43,510 --> 00:43:44,950
it must have been something else so we

972
00:43:44,950 --> 00:43:47,260
kept looking and we found that in fact

973
00:43:47,260 --> 00:43:49,360
their development environment was

974
00:43:49,360 --> 00:43:52,600
breached so this is like the next stage

975
00:43:52,600 --> 00:43:56,200
of compromising supply chains

976
00:43:56,200 --> 00:43:58,420
we're not particular software that was

977
00:43:58,420 --> 00:44:01,030
created is Joe Genest

978
00:44:01,030 --> 00:44:03,970
but the development tools art organized

979
00:44:03,970 --> 00:44:05,740
so that everything you produce with this

980
00:44:05,740 --> 00:44:07,450
development tools will have a Trojan

981
00:44:07,450 --> 00:44:10,600
code inside so it's like a you know meta

982
00:44:10,600 --> 00:44:12,970
bridge I would say and it is very very

983
00:44:12,970 --> 00:44:15,700
hard to notice they just changed this

984
00:44:15,700 --> 00:44:18,220
link don't eggs if I'm the Microsoft

985
00:44:18,220 --> 00:44:23,040
Visual Studio to set again the Edit DOL

986
00:44:23,040 --> 00:44:25,990
dependency which did the job once it is

987
00:44:25,990 --> 00:44:28,420
loaded into the same address penalty of

988
00:44:28,420 --> 00:44:30,820
the process pretty much like you know

989
00:44:30,820 --> 00:44:33,340
this best ever supply chain hack by

990
00:44:33,340 --> 00:44:34,870
criminal psych and criminals very

991
00:44:34,870 --> 00:44:38,080
similar technique of injection but to

992
00:44:38,080 --> 00:44:40,990
conclude like and this is every point is

993
00:44:40,990 --> 00:44:42,910
number one right it's very important

994
00:44:42,910 --> 00:44:45,280
when you can paralyze to you like it is

995
00:44:45,280 --> 00:44:49,620
really hard to find where the mower is

996
00:44:49,620 --> 00:44:52,660
you will try to probably talk to your

997
00:44:52,660 --> 00:44:54,700
developers try to figure out where it is

998
00:44:54,700 --> 00:44:56,800
coming from where where somebody

999
00:44:56,800 --> 00:44:58,390
injected that malicious source code

1000
00:44:58,390 --> 00:45:00,670
you'll do the review of the source code

1001
00:45:00,670 --> 00:45:03,700
but if you'll find nothing there still

1002
00:45:03,700 --> 00:45:05,470
the more you will be compiled in and if

1003
00:45:05,470 --> 00:45:07,060
you look like you put in their own

1004
00:45:07,060 --> 00:45:09,220
purpose as the developer of that

1005
00:45:09,220 --> 00:45:13,150
software into of course go below the

1006
00:45:13,150 --> 00:45:15,730
rather because once the developer

1007
00:45:15,730 --> 00:45:17,200
compile the code you probably have

1008
00:45:17,200 --> 00:45:18,910
secure channels to deliver to the code

1009
00:45:18,910 --> 00:45:23,850
signing server and people do the job and

1010
00:45:23,850 --> 00:45:26,320
most importantly it will not be possible

1011
00:45:26,320 --> 00:45:28,150
for the developer to easily find this

1012
00:45:28,150 --> 00:45:30,760
because let's say developer creates a

1013
00:45:30,760 --> 00:45:32,740
dummy project like hello world right at

1014
00:45:32,740 --> 00:45:34,240
the compile and see if it contains

1015
00:45:34,240 --> 00:45:36,760
mother or not in this case it will not

1016
00:45:36,760 --> 00:45:39,250
contain more they are the authors of

1017
00:45:39,250 --> 00:45:41,770
this particular technique they actually

1018
00:45:41,770 --> 00:45:43,390
hard-coded the names of the projects

1019
00:45:43,390 --> 00:45:45,340
that they want to backdoor so if you try

1020
00:45:45,340 --> 00:45:46,990
to compile something else such as hello

1021
00:45:46,990 --> 00:45:48,400
world application or testing

1022
00:45:48,400 --> 00:45:49,930
applications will not contain any

1023
00:45:49,930 --> 00:45:52,390
malicious injection it was very smart I

1024
00:45:52,390 --> 00:45:54,820
mean that delight the discovery of the

1025
00:45:54,820 --> 00:46:00,840
backdoor component in in the compiler

1026
00:46:00,840 --> 00:46:09,640
yeah and to conclude like to you and I

1027
00:46:09,640 --> 00:46:12,700
know we're out of time but I think after

1028
00:46:12,700 --> 00:46:13,600
going through all these different

1029
00:46:13,600 --> 00:46:15,880
examples we have seen there in the last

1030
00:46:15,880 --> 00:46:17,890
ten years or so

1031
00:46:17,890 --> 00:46:20,620
well I guess that when it comes to

1032
00:46:20,620 --> 00:46:22,270
discovering supply chain attacks

1033
00:46:22,270 --> 00:46:24,640
existing technologies are not very good

1034
00:46:24,640 --> 00:46:26,590
and that's because existing technologies

1035
00:46:26,590 --> 00:46:29,670
are not good at catching thrust abuse

1036
00:46:29,670 --> 00:46:32,140
and there's two main issues here

1037
00:46:32,140 --> 00:46:34,780
one there's a code signing so the moment

1038
00:46:34,780 --> 00:46:37,510
the malware is called you know it's code

1039
00:46:37,510 --> 00:46:40,330
signed that's kind of game over for most

1040
00:46:40,330 --> 00:46:42,640
security solutions out there the other

1041
00:46:42,640 --> 00:46:44,320
issue is that even let's say that you

1042
00:46:44,320 --> 00:46:46,360
disregard the certificates you need to

1043
00:46:46,360 --> 00:46:49,090
find the needle in the haystack a tiny

1044
00:46:49,090 --> 00:46:52,480
piece of malicious code within tens of

1045
00:46:52,480 --> 00:46:57,070
megabytes of legitimate code so I guess

1046
00:46:57,070 --> 00:47:01,540
how do you catch future attacks if you

1047
00:47:01,540 --> 00:47:03,850
look at what worked for all these cases

1048
00:47:03,850 --> 00:47:09,220
I guess that code similarity is one of

1049
00:47:09,220 --> 00:47:11,830
them another one that is very effective

1050
00:47:11,830 --> 00:47:13,960
was a network based detection remember

1051
00:47:13,960 --> 00:47:16,390
the financial institution who found the

1052
00:47:16,390 --> 00:47:18,820
malicious traffic from their

1053
00:47:18,820 --> 00:47:21,100
organization before being able to catch

1054
00:47:21,100 --> 00:47:24,430
anything else and I think was a Rob

1055
00:47:24,430 --> 00:47:28,630
Joyce who was the head of NSA style who

1056
00:47:28,630 --> 00:47:31,360
once said that one of the biggest

1057
00:47:31,360 --> 00:47:34,900
nightmares for the NSA is a out-of-band

1058
00:47:34,900 --> 00:47:37,720
network tap and the diligence is admin

1059
00:47:37,720 --> 00:47:41,110
taking the logs so when you apply this

1060
00:47:41,110 --> 00:47:43,780
lesson and you look at the logs these

1061
00:47:43,780 --> 00:47:47,500
can find supply chain attacks doesn't

1062
00:47:47,500 --> 00:47:49,260
matter if they're hardware software

1063
00:47:49,260 --> 00:47:51,940
eventually those need to exfiltrate

1064
00:47:51,940 --> 00:47:54,780
information or connect to their CNCs

1065
00:47:54,780 --> 00:47:57,280
program flow analysis is one technique

1066
00:47:57,280 --> 00:47:59,530
that we've been playing with trying to

1067
00:47:59,530 --> 00:48:02,050
see how a new version of a program

1068
00:48:02,050 --> 00:48:05,050
differs from previous variants the only

1069
00:48:05,050 --> 00:48:07,060
issues that some of these attacks you

1070
00:48:07,060 --> 00:48:08,850
know they're getting smarter and smarter

1071
00:48:08,850 --> 00:48:13,900
and in the case for instance of the Asus

1072
00:48:13,900 --> 00:48:17,170
incident they wouldn't reach out to the

1073
00:48:17,170 --> 00:48:21,130
C&C unless one of those MAC addresses

1074
00:48:21,130 --> 00:48:24,520
were found so there would be like very

1075
00:48:24,520 --> 00:48:27,120
little signs that there's something bad

1076
00:48:27,120 --> 00:48:31,300
happening in that system but I guess we

1077
00:48:31,300 --> 00:48:33,310
need to develop you know more such

1078
00:48:33,310 --> 00:48:37,920
testers more techniques and probably as

1079
00:48:37,920 --> 00:48:40,690
trade groups are getting more mature and

1080
00:48:40,690 --> 00:48:42,370
these attack technologies are getting

1081
00:48:42,370 --> 00:48:45,700
more sophisticated we will also need to

1082
00:48:45,700 --> 00:48:48,910
technologies that can find more supply

1083
00:48:48,910 --> 00:48:52,150
chain attacks so let's see what we'll

1084
00:48:52,150 --> 00:48:55,750
bring to in 2020 I guess I will see even

1085
00:48:55,750 --> 00:48:57,550
more supply chain attacks we haven't

1086
00:48:57,550 --> 00:48:59,710
seen any significant I guess on the

1087
00:48:59,710 --> 00:49:01,930
mobile side of things there have been a

1088
00:49:01,930 --> 00:49:04,000
couple of Rooter attacks but I think

1089
00:49:04,000 --> 00:49:05,890
that's also quite interesting territory

1090
00:49:05,890 --> 00:49:08,740
so I think it's a very very interesting

1091
00:49:08,740 --> 00:49:12,700
field and very very three Keith kind of

1092
00:49:12,700 --> 00:49:15,610
area of research doesn't matter if

1093
00:49:15,610 --> 00:49:18,010
you're on the you know offensive side of

1094
00:49:18,010 --> 00:49:20,560
things defensive supply chain attacks

1095
00:49:20,560 --> 00:49:23,530
for sure we'll be in the spotlight for

1096
00:49:23,530 --> 00:49:25,530
the next years

1097
00:49:25,530 --> 00:49:27,800
thank you very much

1098
00:49:27,800 --> 00:49:29,020
[Applause]

1099
00:49:29,020 --> 00:49:42,139
[Music]

