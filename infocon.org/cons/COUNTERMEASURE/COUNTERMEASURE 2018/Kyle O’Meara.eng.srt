1
00:00:00,000 --> 00:00:14,759
oh thank you for coming out I want to

2
00:00:14,759 --> 00:00:16,049
thank the organizers and thank you

3
00:00:16,049 --> 00:00:17,670
Andrew for the introduction you know

4
00:00:17,670 --> 00:00:19,410
Krim and mike putting this on it's a

5
00:00:19,410 --> 00:00:20,670
great conference this is my second time

6
00:00:20,670 --> 00:00:22,590
here I was here two years ago wasn't

7
00:00:22,590 --> 00:00:23,519
able to make it last year but I think

8
00:00:23,519 --> 00:00:25,730
it's one of really great conferences

9
00:00:25,730 --> 00:00:28,710
that I think that exists so I'm going to

10
00:00:28,710 --> 00:00:31,650
try to continue to come every year but

11
00:00:31,650 --> 00:00:33,480
like I said let's get right into this so

12
00:00:33,480 --> 00:00:38,010
this is my talk on an embedded device

13
00:00:38,010 --> 00:00:39,750
analysis approach for like network

14
00:00:39,750 --> 00:00:41,820
defenders if you were playing buzzword

15
00:00:41,820 --> 00:00:43,500
bingo you could probably just call it

16
00:00:43,500 --> 00:00:44,969
something like this you know blue team

17
00:00:44,969 --> 00:00:47,250
approach to you know a red team in bed

18
00:00:47,250 --> 00:00:50,940
device analysis process so before we get

19
00:00:50,940 --> 00:00:52,980
into this this is this Claymore slide so

20
00:00:52,980 --> 00:00:55,170
that I don't get sued or you don't get

21
00:00:55,170 --> 00:00:57,899
sued and things like that it's all open

22
00:00:57,899 --> 00:00:59,309
source everything's that exists out

23
00:00:59,309 --> 00:00:59,550
there

24
00:00:59,550 --> 00:01:01,530
so obviously this typical agenda stuff

25
00:01:01,530 --> 00:01:04,080
but really quick Who I am Who am I so I

26
00:01:04,080 --> 00:01:05,720
work for the software engineer Institute

27
00:01:05,720 --> 00:01:08,220
it's part of Carnegie Mellon University

28
00:01:08,220 --> 00:01:10,140
and specifically I'm on the cert

29
00:01:10,140 --> 00:01:12,510
coordination team so cert stands for

30
00:01:12,510 --> 00:01:13,229
nothing

31
00:01:13,229 --> 00:01:16,350
it's just cert we actually had the

32
00:01:16,350 --> 00:01:18,030
trademark on it we as in so Carnegie

33
00:01:18,030 --> 00:01:20,460
Mellon University does and exists and we

34
00:01:20,460 --> 00:01:21,990
were originally the original cert that

35
00:01:21,990 --> 00:01:23,310
existed

36
00:01:23,310 --> 00:01:24,720
we're federally funded research to

37
00:01:24,720 --> 00:01:26,400
develop a senator but 1988 when the

38
00:01:26,400 --> 00:01:28,770
Morse word happened government came to

39
00:01:28,770 --> 00:01:30,780
CMU at the time and said hey look you

40
00:01:30,780 --> 00:01:32,460
guys should really like coordinate like

41
00:01:32,460 --> 00:01:34,320
things that go on an Internet so at that

42
00:01:34,320 --> 00:01:36,570
point in time it was like answering the

43
00:01:36,570 --> 00:01:38,369
University emails cuz that would exist

44
00:01:38,369 --> 00:01:39,869
it and picking up a phone when someone

45
00:01:39,869 --> 00:01:41,549
would call about like hey my like I

46
00:01:41,549 --> 00:01:42,780
can't get access to my own internet

47
00:01:42,780 --> 00:01:44,909
right so we used to do instant response

48
00:01:44,909 --> 00:01:47,369
you could call it for everybody at that

49
00:01:47,369 --> 00:01:50,579
point in time obviously after 9/11 and

50
00:01:50,579 --> 00:01:53,340
2013 came around DHS was stood up in

51
00:01:53,340 --> 00:01:55,530
sort of you assert came to be now you're

52
00:01:55,530 --> 00:01:57,060
a certain name actually has fallen off

53
00:01:57,060 --> 00:01:59,280
but they're still DHS sort of taking

54
00:01:59,280 --> 00:02:00,780
over the role of instant response for

55
00:02:00,780 --> 00:02:03,479
the government United States I'm also I

56
00:02:03,479 --> 00:02:06,990
also teach at a couple universities on

57
00:02:06,990 --> 00:02:09,330
and then my night job I like to say I

58
00:02:09,330 --> 00:02:10,860
enjoy I think it's important to give

59
00:02:10,860 --> 00:02:11,720
back

60
00:02:11,720 --> 00:02:13,250
I'm probably the smartest person in the

61
00:02:13,250 --> 00:02:14,570
room but I'd like to at least give some

62
00:02:14,570 --> 00:02:15,860
knowledge and people hopefully

63
00:02:15,860 --> 00:02:17,720
exponentially when they're 10 years 12

64
00:02:17,720 --> 00:02:19,100
years out they'll be exponentially

65
00:02:19,100 --> 00:02:19,880
better than I am

66
00:02:19,880 --> 00:02:23,120
I do the B side CTF I used to work at

67
00:02:23,120 --> 00:02:24,980
fire I so I get the whole product world

68
00:02:24,980 --> 00:02:27,170
the consulting world did a consulting

69
00:02:27,170 --> 00:02:29,240
gig which was the longest 11 months of

70
00:02:29,240 --> 00:02:32,960
my life enjoyed some of it but I'm glad

71
00:02:32,960 --> 00:02:34,370
I did it when I was younger I would

72
00:02:34,370 --> 00:02:36,680
never do consulting again and then I

73
00:02:36,680 --> 00:02:38,690
used to work for departments events or

74
00:02:38,690 --> 00:02:42,020
better yet I worked for NSA for about

75
00:02:42,020 --> 00:02:43,640
four and a half years I enjoyed

76
00:02:43,640 --> 00:02:45,310
everything I did there had a lot of fun

77
00:02:45,310 --> 00:02:48,320
and then you know speaking engagement

78
00:02:48,320 --> 00:02:49,520
and other you know anything that I

79
00:02:49,520 --> 00:02:51,290
publish is out there on the SDI digital

80
00:02:51,290 --> 00:02:52,760
library I'll give you some links to

81
00:02:52,760 --> 00:02:55,760
documentation at the end so let's get

82
00:02:55,760 --> 00:03:00,230
into this so I was doing as we saw in

83
00:03:00,230 --> 00:03:01,640
last slide I used to be on the

84
00:03:01,640 --> 00:03:03,500
vulnerability analysis team well now I'm

85
00:03:03,500 --> 00:03:05,150
back on the malware analysis team doing

86
00:03:05,150 --> 00:03:06,560
reverse engineering again of malware

87
00:03:06,560 --> 00:03:09,770
type indicators but I was doing more

88
00:03:09,770 --> 00:03:11,870
vulnerability discovery exploit

89
00:03:11,870 --> 00:03:17,270
development type things and I was

90
00:03:17,270 --> 00:03:19,160
looking at embedded devices and I said

91
00:03:19,160 --> 00:03:22,130
you know hey hey I want to you know pick

92
00:03:22,130 --> 00:03:23,900
up these IOT devices right and look at

93
00:03:23,900 --> 00:03:25,250
them and stuff like that and let me go

94
00:03:25,250 --> 00:03:26,750
and see if someone else has done some

95
00:03:26,750 --> 00:03:28,459
you know interesting research or they

96
00:03:28,459 --> 00:03:30,020
put together a starting to pick model of

97
00:03:30,020 --> 00:03:31,730
how we can do this you know going back

98
00:03:31,730 --> 00:03:33,470
to like fifth grade science class like

99
00:03:33,470 --> 00:03:34,520
oh you start with this you have a

100
00:03:34,520 --> 00:03:36,050
hypothesis and we follow these steps

101
00:03:36,050 --> 00:03:38,000
well nothing like that existed there's

102
00:03:38,000 --> 00:03:39,800
some great blog posts or this article

103
00:03:39,800 --> 00:03:41,300
from this company and so forth and so on

104
00:03:41,300 --> 00:03:43,160
and a lot of it just winging it right

105
00:03:43,160 --> 00:03:44,690
and I said ah that's not gonna work for

106
00:03:44,690 --> 00:03:46,340
me especially where we work where we

107
00:03:46,340 --> 00:03:48,050
have to like put together repeatable

108
00:03:48,050 --> 00:03:51,739
processes that our sponsors can use we

109
00:03:51,739 --> 00:03:54,020
can reuse anybody can reuse right so I

110
00:03:54,020 --> 00:03:56,239
did a hard pause and like my analysis I

111
00:03:56,239 --> 00:03:58,160
said we needed a methodology and maybe

112
00:03:58,160 --> 00:03:59,270
I'm not the best person to do it but I'm

113
00:03:59,270 --> 00:04:00,260
gonna put it out there for everybody

114
00:04:00,260 --> 00:04:03,800
also was running around a repetitive

115
00:04:03,800 --> 00:04:06,470
grep statements to find stuff when I was

116
00:04:06,470 --> 00:04:08,090
looking to embed devices my god not

117
00:04:08,090 --> 00:04:09,709
gonna do that anymore so I wrote

118
00:04:09,709 --> 00:04:12,770
together a tool tool you can call it

119
00:04:12,770 --> 00:04:16,488
Python script I'm not a developer I like

120
00:04:16,488 --> 00:04:17,899
to write what I like to call analyst

121
00:04:17,899 --> 00:04:21,640
code it works majority of time

122
00:04:21,810 --> 00:04:23,580
but the goal is to create like a

123
00:04:23,580 --> 00:04:25,620
repeatable process that parades thorough

124
00:04:25,620 --> 00:04:27,810
results ensure that every component can

125
00:04:27,810 --> 00:04:29,580
be at least minimally tested by anybody

126
00:04:29,580 --> 00:04:31,410
to start out with right like anybody can

127
00:04:31,410 --> 00:04:33,240
pick this methodology up and use it on

128
00:04:33,240 --> 00:04:35,340
anything right and then create an

129
00:04:35,340 --> 00:04:36,900
open-source tool to share right I like

130
00:04:36,900 --> 00:04:39,650
to give back it's nice being outside the

131
00:04:39,650 --> 00:04:41,610
intelligence community world where I can

132
00:04:41,610 --> 00:04:43,410
do publications and speak where is like

133
00:04:43,410 --> 00:04:45,210
inside there you can't even think about

134
00:04:45,210 --> 00:04:48,510
doing that so when I say embedded

135
00:04:48,510 --> 00:04:50,760
devices I'm you can also lump in

136
00:04:50,760 --> 00:04:52,470
Internet of Things into there I like to

137
00:04:52,470 --> 00:04:54,600
put embedded devices at the umbrella for

138
00:04:54,600 --> 00:04:56,730
it and then Internet of Things is

139
00:04:56,730 --> 00:04:57,750
underneath that because you know your

140
00:04:57,750 --> 00:04:59,820
car is an embedded device a satellite

141
00:04:59,820 --> 00:05:01,590
terminal that goes on a maritime ship is

142
00:05:01,590 --> 00:05:05,940
set in by a device and then there's a

143
00:05:05,940 --> 00:05:06,900
you know a vulnerability research

144
00:05:06,900 --> 00:05:09,419
process to did it exist and then you

145
00:05:09,419 --> 00:05:11,010
know like I said create this concrete

146
00:05:11,010 --> 00:05:14,390
methodology that anybody can use

147
00:05:15,830 --> 00:05:18,240
so really the methodology or the red

148
00:05:18,240 --> 00:05:19,530
team approach right so I'm going to talk

149
00:05:19,530 --> 00:05:21,360
about that first and then we'll flip it

150
00:05:21,360 --> 00:05:22,560
on its head I'd like to say and we'll

151
00:05:22,560 --> 00:05:23,970
talk about like a network defense to

152
00:05:23,970 --> 00:05:28,220
that so this is sort of the methodology

153
00:05:28,220 --> 00:05:31,320
myself and at the time my intern but now

154
00:05:31,320 --> 00:05:33,660
she's my colleague as well she got hired

155
00:05:33,660 --> 00:05:36,900
on to do more of the vulnerability type

156
00:05:36,900 --> 00:05:39,600
work but this is type of a methodology

157
00:05:39,600 --> 00:05:41,130
put together right so we have embedded

158
00:05:41,130 --> 00:05:43,740
device list creation you know and then

159
00:05:43,740 --> 00:05:45,600
we do go into information gathering and

160
00:05:45,600 --> 00:05:47,310
we do firmware analysis we look at the

161
00:05:47,310 --> 00:05:49,800
web app we look at the mobile app do a

162
00:05:49,800 --> 00:05:51,210
little bit of hardware analysis where I

163
00:05:51,210 --> 00:05:52,289
think that actually scares a lot of

164
00:05:52,289 --> 00:05:55,080
people and then you do look at you know

165
00:05:55,080 --> 00:05:56,640
and the vulnerability analysis side of

166
00:05:56,640 --> 00:05:59,729
things so embedded device list creation

167
00:05:59,729 --> 00:06:02,490
is just a long word a long phrase to say

168
00:06:02,490 --> 00:06:05,640
like figure out all the devices out

169
00:06:05,640 --> 00:06:07,169
there that you want to look at right if

170
00:06:07,169 --> 00:06:08,460
you want to look at web cams for the

171
00:06:08,460 --> 00:06:10,140
specific company like let's get all the

172
00:06:10,140 --> 00:06:11,550
information about that those webcams

173
00:06:11,550 --> 00:06:13,950
read specific company right the idea is

174
00:06:13,950 --> 00:06:15,900
that access to physical device right

175
00:06:15,900 --> 00:06:18,060
actually having that will help you more

176
00:06:18,060 --> 00:06:21,060
do more complete results obviously if

177
00:06:21,060 --> 00:06:22,410
you can't get access to that embedded

178
00:06:22,410 --> 00:06:24,330
device hopefully there's a way to get

179
00:06:24,330 --> 00:06:25,530
you the access to the firmware that's

180
00:06:25,530 --> 00:06:28,710
out there right so nns at the same point

181
00:06:28,710 --> 00:06:30,240
in time collect all the firmware if the

182
00:06:30,240 --> 00:06:31,770
company posted on their website download

183
00:06:31,770 --> 00:06:33,900
all of it all versions new and old just

184
00:06:33,900 --> 00:06:35,700
download it all and we'll talk about why

185
00:06:35,700 --> 00:06:37,740
downloading the old version will help

186
00:06:37,740 --> 00:06:40,410
you can in sort of a red team approach

187
00:06:40,410 --> 00:06:41,910
at some point in time and a more recent

188
00:06:41,910 --> 00:06:44,670
thing I was looking at why going back

189
00:06:44,670 --> 00:06:46,440
into like the first version when I

190
00:06:46,440 --> 00:06:48,390
version 7 I was able to find you know a

191
00:06:48,390 --> 00:06:50,940
password right that was then encrypted

192
00:06:50,940 --> 00:06:52,350
but and then the first version was this

193
00:06:52,350 --> 00:06:57,480
they're in plain text right the next

194
00:06:57,480 --> 00:06:58,710
step is really just going into

195
00:06:58,710 --> 00:07:00,240
information gathering right collecting

196
00:07:00,240 --> 00:07:01,830
all the information about past and

197
00:07:01,830 --> 00:07:03,090
present vulnerabilities and exploits

198
00:07:03,090 --> 00:07:05,130
associated with that device and maybe

199
00:07:05,130 --> 00:07:06,780
even outside the device maybe everything

200
00:07:06,780 --> 00:07:08,310
that's associated with that company its

201
00:07:08,310 --> 00:07:11,400
products right as we'll talk later lots

202
00:07:11,400 --> 00:07:13,440
of files are shared across all the

203
00:07:13,440 --> 00:07:15,030
firmware right for all types of devices

204
00:07:15,030 --> 00:07:16,890
so something you might find for a camera

205
00:07:16,890 --> 00:07:19,890
might actually work for a router so

206
00:07:19,890 --> 00:07:21,390
really descended to identifying the

207
00:07:21,390 --> 00:07:24,450
vulnerabilities and then identifying any

208
00:07:24,450 --> 00:07:26,340
exploits associated with them and any

209
00:07:26,340 --> 00:07:28,320
other pertinent information you think is

210
00:07:28,320 --> 00:07:30,060
valuable at that point time maybe

211
00:07:30,060 --> 00:07:32,430
articles you know this you know X vendor

212
00:07:32,430 --> 00:07:34,410
wrote up about the product while I

213
00:07:34,410 --> 00:07:35,670
bender wrote up about you know this

214
00:07:35,670 --> 00:07:37,740
different products maybe malware that

215
00:07:37,740 --> 00:07:39,390
hit this product right as we can see

216
00:07:39,390 --> 00:07:41,160
more recently like the Mirai stuff and

217
00:07:41,160 --> 00:07:45,630
the VPN filtering information next we'll

218
00:07:45,630 --> 00:07:47,310
jump into what's you know this firmware

219
00:07:47,310 --> 00:07:50,730
analysis right so ideally you choose the

220
00:07:50,730 --> 00:07:52,110
device that you were able to gather at

221
00:07:52,110 --> 00:07:54,720
associated firmware off the website and

222
00:07:54,720 --> 00:07:56,190
you just basically analyze it when you

223
00:07:56,190 --> 00:07:57,870
break it down typically it's an embedded

224
00:07:57,870 --> 00:08:00,810
file system most of time is a squash FS

225
00:08:00,810 --> 00:08:03,240
file system but it's just a winner so it

226
00:08:03,240 --> 00:08:05,220
looks like Linux it's basically a Linux

227
00:08:05,220 --> 00:08:07,980
like file system itself so bin walk is

228
00:08:07,980 --> 00:08:09,450
your you know a nice open source tool

229
00:08:09,450 --> 00:08:11,910
you can use to theoretically extract the

230
00:08:11,910 --> 00:08:15,180
information from the from our blob right

231
00:08:15,180 --> 00:08:16,950
and then the tool that I wrote called

232
00:08:16,950 --> 00:08:19,800
trommel will help you sort of sift

233
00:08:19,800 --> 00:08:21,090
through the embedded device files to

234
00:08:21,090 --> 00:08:22,950
identify potential vulnerable indicators

235
00:08:22,950 --> 00:08:25,230
long way to say is like I searched for

236
00:08:25,230 --> 00:08:26,520
different things that could point you

237
00:08:26,520 --> 00:08:28,410
down to a path that hey maybe there's a

238
00:08:28,410 --> 00:08:29,370
hard-coded password

239
00:08:29,370 --> 00:08:31,020
maybe it's config file has information

240
00:08:31,020 --> 00:08:33,360
in it that talks about logins and

241
00:08:33,360 --> 00:08:35,220
different IP addresses associated so

242
00:08:35,220 --> 00:08:37,289
Fwends so forth and so on like I say

243
00:08:37,289 --> 00:08:39,360
it's out there on github I'll show you

244
00:08:39,360 --> 00:08:41,070
the link later I like to say it takes

245
00:08:41,070 --> 00:08:43,890
out like 75% in the manual process so

246
00:08:43,890 --> 00:08:44,880
when you run the script though you're

247
00:08:44,880 --> 00:08:46,080
still going to get a couple different

248
00:08:46,080 --> 00:08:47,250
text files that you need to parse

249
00:08:47,250 --> 00:08:48,810
through of course there's going to be

250
00:08:48,810 --> 00:08:49,630
false positive

251
00:08:49,630 --> 00:08:50,950
right you know if they're right in a

252
00:08:50,950 --> 00:08:53,080
comment this is password right obviously

253
00:08:53,080 --> 00:08:54,670
that's not the password but you know

254
00:08:54,670 --> 00:08:56,770
still my point to more information about

255
00:08:56,770 --> 00:08:58,330
a file or look at files that you might

256
00:08:58,330 --> 00:09:00,850
not even thought about looking at and

257
00:09:00,850 --> 00:09:03,610
the nice thing is that I found a tool

258
00:09:03,610 --> 00:09:05,200
called V feed that's out there it's an

259
00:09:05,200 --> 00:09:07,180
open source curated Vanar ability and

260
00:09:07,180 --> 00:09:10,170
intelligence you know database wrapper

261
00:09:10,170 --> 00:09:13,660
this individual NJ has put together this

262
00:09:13,660 --> 00:09:15,640
database where he just pulls in all the

263
00:09:15,640 --> 00:09:18,010
information about sea bees you know

264
00:09:18,010 --> 00:09:20,200
exploit DB throws a nice database right

265
00:09:20,200 --> 00:09:22,270
and so I'll pivot and use that database

266
00:09:22,270 --> 00:09:25,600
to say okay I have this software on this

267
00:09:25,600 --> 00:09:27,610
machine tell me all the sea bees and

268
00:09:27,610 --> 00:09:29,860
Metasploit modules exploit DB

269
00:09:29,860 --> 00:09:32,470
information associated with this CBE

270
00:09:32,470 --> 00:09:33,940
right and you can kind of expand there

271
00:09:33,940 --> 00:09:35,380
anything that you can include n Maps

272
00:09:35,380 --> 00:09:37,600
scripts as well the database is pretty

273
00:09:37,600 --> 00:09:39,400
extensive I use just a sliver of it

274
00:09:39,400 --> 00:09:42,340
right and you can use a lot of it so

275
00:09:42,340 --> 00:09:44,020
there's free inversions if free and paid

276
00:09:44,020 --> 00:09:46,270
versions of it I use a free version so

277
00:09:46,270 --> 00:09:47,560
anybody can use the free version it's

278
00:09:47,560 --> 00:09:49,750
just sort of like the snort cigs it only

279
00:09:49,750 --> 00:09:51,640
gets updated once a month for the free /

280
00:09:51,640 --> 00:09:57,040
free users that is so most as we all

281
00:09:57,040 --> 00:09:58,660
probably know most embedded devices have

282
00:09:58,660 --> 00:10:01,950
sort of web app front end to it right so

283
00:10:01,950 --> 00:10:03,820
obviously you should probably test this

284
00:10:03,820 --> 00:10:05,350
for you know some of the most common app

285
00:10:05,350 --> 00:10:07,510
web application vulnerabilities you can

286
00:10:07,510 --> 00:10:09,880
use a lot of open source tools out there

287
00:10:09,880 --> 00:10:12,430
nikto and zap or obviously the free you

288
00:10:12,430 --> 00:10:13,870
know there is a free version of burp

289
00:10:13,870 --> 00:10:17,230
suite but you know paying for the little

290
00:10:17,230 --> 00:10:18,460
out of pocket gives you more

291
00:10:18,460 --> 00:10:20,650
capabilities but you know it's able to

292
00:10:20,650 --> 00:10:22,090
intercept that traffic and look you know

293
00:10:22,090 --> 00:10:23,650
passively and actively look for you know

294
00:10:23,650 --> 00:10:26,790
different types of vulnerabilities

295
00:10:29,810 --> 00:10:31,279
so a mobile application I think is

296
00:10:31,279 --> 00:10:32,749
sometimes skipped in the process by a

297
00:10:32,749 --> 00:10:34,430
lot of these devices you can access it

298
00:10:34,430 --> 00:10:36,620
to the mobile application so it's very

299
00:10:36,620 --> 00:10:38,389
similar to the web application as far as

300
00:10:38,389 --> 00:10:40,519
you know my testing processes were and

301
00:10:40,519 --> 00:10:42,860
we pull down the apks right the Android

302
00:10:42,860 --> 00:10:46,579
package you know files themselves and

303
00:10:46,579 --> 00:10:48,740
using another open-source tool apktool

304
00:10:48,740 --> 00:10:51,379
it basically decompresses that whole apk

305
00:10:51,379 --> 00:10:53,930
and you can run trommel on it to then

306
00:10:53,930 --> 00:10:55,550
find any of the similar indicators that

307
00:10:55,550 --> 00:10:57,980
you would find in the firmware file

308
00:10:57,980 --> 00:11:03,290
system itself and then jump into like

309
00:11:03,290 --> 00:11:05,540
the scary part like Oh hardware analysis

310
00:11:05,540 --> 00:11:06,680
like what I don't want to do that well

311
00:11:06,680 --> 00:11:08,209
there's a lot you can get from that and

312
00:11:08,209 --> 00:11:10,399
to take into account right so the

313
00:11:10,399 --> 00:11:11,990
hardware analysis part I broke down in

314
00:11:11,990 --> 00:11:14,269
the you know five simple steps right

315
00:11:14,269 --> 00:11:15,740
look at the actual device if you

316
00:11:15,740 --> 00:11:17,240
physically have the device look at the

317
00:11:17,240 --> 00:11:19,910
device right what's on the device

318
00:11:19,910 --> 00:11:21,589
what kind of informations on there

319
00:11:21,589 --> 00:11:22,639
usually there's some kind of insert a

320
00:11:22,639 --> 00:11:24,980
new frequencies associated you know it's

321
00:11:24,980 --> 00:11:26,389
gonna be registered in you know the

322
00:11:26,389 --> 00:11:28,910
China database the FCC database United

323
00:11:28,910 --> 00:11:31,100
States IC database and Canada and so

324
00:11:31,100 --> 00:11:32,809
forth so you can go to those databases

325
00:11:32,809 --> 00:11:33,889
and then see what kind of information

326
00:11:33,889 --> 00:11:37,250
they submitted to the - you know that

327
00:11:37,250 --> 00:11:39,139
database and what it what kind of radio

328
00:11:39,139 --> 00:11:41,029
frequencies it's using what range it's

329
00:11:41,029 --> 00:11:42,559
using which certain can help you with

330
00:11:42,559 --> 00:11:44,389
further analysis that we're not gonna

331
00:11:44,389 --> 00:11:46,009
talk about but which we could be future

332
00:11:46,009 --> 00:11:48,230
steps and once you're done with that

333
00:11:48,230 --> 00:11:50,059
opening it up what's on the printed

334
00:11:50,059 --> 00:11:51,860
circuit board itself right what's in

335
00:11:51,860 --> 00:11:54,500
that PCB what chips does it have what

336
00:11:54,500 --> 00:11:55,990
can you identify about those chips

337
00:11:55,990 --> 00:11:57,829
really you're looking for that flash

338
00:11:57,829 --> 00:11:59,180
component on there right because that

339
00:11:59,180 --> 00:12:00,769
flash component typically is where it's

340
00:12:00,769 --> 00:12:02,680
gonna the firmware is gonna be installed

341
00:12:02,680 --> 00:12:05,540
try to dump the flash memory off of

342
00:12:05,540 --> 00:12:08,329
there and then once you that once you're

343
00:12:08,329 --> 00:12:10,339
at that process you can extract it and

344
00:12:10,339 --> 00:12:12,500
let analyze it just like you would if

345
00:12:12,500 --> 00:12:14,899
you grabbed it from the website and the

346
00:12:14,899 --> 00:12:16,970
idea then is then compare what was on

347
00:12:16,970 --> 00:12:18,740
the device to what was on the website

348
00:12:18,740 --> 00:12:21,410
and the times I've done this is that

349
00:12:21,410 --> 00:12:23,269
even if this device says it's version

350
00:12:23,269 --> 00:12:24,709
four and I pull version four from the

351
00:12:24,709 --> 00:12:26,600
website there's still differences in

352
00:12:26,600 --> 00:12:28,730
there so it's a little interesting like

353
00:12:28,730 --> 00:12:30,319
is this version four better than what's

354
00:12:30,319 --> 00:12:32,240
on here probably they probably found

355
00:12:32,240 --> 00:12:33,470
mistakes after they pushed it out

356
00:12:33,470 --> 00:12:34,939
because they assume that when everybody

357
00:12:34,939 --> 00:12:36,350
gets a product they're gonna hit update

358
00:12:36,350 --> 00:12:39,290
firmware right I beg to differ that

359
00:12:39,290 --> 00:12:41,420
doesn't always happen

360
00:12:41,420 --> 00:12:44,210
a couple you know pro tips here not that

361
00:12:44,210 --> 00:12:46,160
I'm a pro but things to think about is

362
00:12:46,160 --> 00:12:47,810
how is the you know if once you're doing

363
00:12:47,810 --> 00:12:49,610
this extraction of the firmware like how

364
00:12:49,610 --> 00:12:51,740
are you gonna what how you gonna supply

365
00:12:51,740 --> 00:12:53,570
power to the device to get the supply of

366
00:12:53,570 --> 00:12:55,310
power to the chip or do you power it

367
00:12:55,310 --> 00:12:57,860
from the you know the component I use

368
00:12:57,860 --> 00:13:00,710
the bus pirate right the pin layout

369
00:13:00,710 --> 00:13:02,960
don't swap the make sure you don't swap

370
00:13:02,960 --> 00:13:05,120
it right so data out goes data in and

371
00:13:05,120 --> 00:13:06,800
data in goes the data out right you have

372
00:13:06,800 --> 00:13:08,150
to cross those obviously cuz it's

373
00:13:08,150 --> 00:13:09,770
reading from there right you get it

374
00:13:09,770 --> 00:13:11,060
wrong and get a bad read it'll still

375
00:13:11,060 --> 00:13:12,290
read it but it's not gonna look like

376
00:13:12,290 --> 00:13:14,300
anything you're not gonna be wondering

377
00:13:14,300 --> 00:13:19,100
why using micro clips as opposed to an

378
00:13:19,100 --> 00:13:21,740
SOI c-clip I found was very fruitful I

379
00:13:21,740 --> 00:13:24,260
would spend spend numerous times banging

380
00:13:24,260 --> 00:13:26,620
my head why it wasn't you know

381
00:13:26,620 --> 00:13:28,490
extracting the thing when it looks like

382
00:13:28,490 --> 00:13:29,930
was making good connections in it that

383
00:13:29,930 --> 00:13:31,490
bumps into next bull is make sure that

384
00:13:31,490 --> 00:13:33,380
like what you have is good connections

385
00:13:33,380 --> 00:13:34,880
more recently a geek week I was trying

386
00:13:34,880 --> 00:13:37,550
to the same thing the tools I had buss

387
00:13:37,550 --> 00:13:39,170
pirate and flash rom which is an open

388
00:13:39,170 --> 00:13:40,490
source tool that you can easily install

389
00:13:40,490 --> 00:13:44,000
on Kali understood this chip but I was

390
00:13:44,000 --> 00:13:45,530
getting I wasn't getting good reads so

391
00:13:45,530 --> 00:13:47,930
that tells me like my might now my micro

392
00:13:47,930 --> 00:13:49,190
clips that were using we're actually

393
00:13:49,190 --> 00:13:51,740
clipping nicely onto the pins off the

394
00:13:51,740 --> 00:13:53,600
flash chip but you know we didn't have

395
00:13:53,600 --> 00:13:55,070
the capabilities nor do I want to try to

396
00:13:55,070 --> 00:13:57,170
extract that flash chip and then look at

397
00:13:57,170 --> 00:13:58,250
it that way now that is the way you

398
00:13:58,250 --> 00:13:59,420
could do it if you have a hardware shop

399
00:13:59,420 --> 00:14:01,490
that does things like that but like I

400
00:14:01,490 --> 00:14:03,050
said that's a more advanced type

401
00:14:03,050 --> 00:14:04,790
hardware analysis I want to do something

402
00:14:04,790 --> 00:14:07,430
basic that anybody can do it's like I

403
00:14:07,430 --> 00:14:09,110
said there's a couple tools I use bus

404
00:14:09,110 --> 00:14:11,090
pirate and then flash ROM right and I'll

405
00:14:11,090 --> 00:14:12,950
talk later about bus part it just cost a

406
00:14:12,950 --> 00:14:15,470
little bit like less than you know 40

407
00:14:15,470 --> 00:14:18,140
bucks u.s. and then flash ROM you can

408
00:14:18,140 --> 00:14:22,060
open source and they actually started

409
00:14:22,300 --> 00:14:24,830
supporting it again they pulled it over

410
00:14:24,830 --> 00:14:25,850
to github and people are actually

411
00:14:25,850 --> 00:14:27,830
supporting it again right whereas a year

412
00:14:27,830 --> 00:14:29,360
ago there wasn't support for it like for

413
00:14:29,360 --> 00:14:30,680
like two years right so it's nice that

414
00:14:30,680 --> 00:14:34,490
it's actually being supported again and

415
00:14:34,490 --> 00:14:36,260
then vulnerability analysis right so

416
00:14:36,260 --> 00:14:38,180
research and testing like this is broken

417
00:14:38,180 --> 00:14:39,650
down into three little steps as well

418
00:14:39,650 --> 00:14:41,780
right so review the firmware updates for

419
00:14:41,780 --> 00:14:43,190
the patches typically found in the

420
00:14:43,190 --> 00:14:44,600
release notes what information can you

421
00:14:44,600 --> 00:14:46,400
gather from there what actually did they

422
00:14:46,400 --> 00:14:48,200
fix before do they talk about what it

423
00:14:48,200 --> 00:14:51,560
fixed did just say bug fix was that like

424
00:14:51,560 --> 00:14:54,230
probably a remote code execution I would

425
00:14:54,230 --> 00:14:54,980
say no

426
00:14:54,980 --> 00:14:56,660
but we don't know because they maybe not

427
00:14:56,660 --> 00:14:57,949
give a lot of detail but if they have

428
00:14:57,949 --> 00:14:59,209
release notes take a look at those

429
00:14:59,209 --> 00:15:00,769
release notes and tell you what was

430
00:15:00,769 --> 00:15:05,000
affecting it before ideally maybe test

431
00:15:05,000 --> 00:15:06,889
actual exploits against the device if

432
00:15:06,889 --> 00:15:08,269
you physically have it might as well

433
00:15:08,269 --> 00:15:09,920
fire it up and you know if someone wrote

434
00:15:09,920 --> 00:15:11,360
like a nice you know Metasploit module

435
00:15:11,360 --> 00:15:13,699
for it be able to go at the device right

436
00:15:13,699 --> 00:15:15,829
you have a closed network ideally you'll

437
00:15:15,829 --> 00:15:18,380
be doing this on you'll be able to see

438
00:15:18,380 --> 00:15:19,670
if that's actually working

439
00:15:19,670 --> 00:15:22,810
I would actually test also similar

440
00:15:22,810 --> 00:15:24,829
exploits for other devices that the

441
00:15:24,829 --> 00:15:27,800
vendor has like I said lots of the share

442
00:15:27,800 --> 00:15:29,839
of object files and library files are

443
00:15:29,839 --> 00:15:32,089
very similar across all the devices and

444
00:15:32,089 --> 00:15:33,380
at the end of day if it's it's in your

445
00:15:33,380 --> 00:15:34,519
wheelhouse you can write your own proof

446
00:15:34,519 --> 00:15:37,279
of concept we did this on the device

447
00:15:37,279 --> 00:15:39,079
we're looking at right I really like a

448
00:15:39,079 --> 00:15:41,839
web app sort of exploitation because we

449
00:15:41,839 --> 00:15:43,279
found a flaw and that there nothing

450
00:15:43,279 --> 00:15:46,100
existed before but the most important

451
00:15:46,100 --> 00:15:48,949
part right phoner to be vulnerability

452
00:15:48,949 --> 00:15:51,230
disclosure so working for the cert

453
00:15:51,230 --> 00:15:52,610
Coordination Center we've been

454
00:15:52,610 --> 00:15:55,310
corriander abilities for the government

455
00:15:55,310 --> 00:15:57,560
and other security researchers out there

456
00:15:57,560 --> 00:16:00,620
for as long as I've known I think that

457
00:16:00,620 --> 00:16:03,350
started more in the mid 90s where people

458
00:16:03,350 --> 00:16:05,240
would submit bug to us and we

459
00:16:05,240 --> 00:16:06,410
communicate so we have a very good

460
00:16:06,410 --> 00:16:08,029
relationship with lots of vendors soro

461
00:16:08,029 --> 00:16:09,949
if you're a researcher out there that's

462
00:16:09,949 --> 00:16:12,589
doing a lot of bug bounties and physical

463
00:16:12,589 --> 00:16:14,209
devices and you're finding things and

464
00:16:14,209 --> 00:16:15,760
you're trying to do the proper thing to

465
00:16:15,760 --> 00:16:17,750
disclose it to the vendor and they're

466
00:16:17,750 --> 00:16:19,160
not responding or they don't even have a

467
00:16:19,160 --> 00:16:22,339
process to do so reach out to us after

468
00:16:22,339 --> 00:16:24,949
you done try to talk to the vendor we

469
00:16:24,949 --> 00:16:26,360
also have a guide out there that you can

470
00:16:26,360 --> 00:16:28,940
read it's not the you know it's very dry

471
00:16:28,940 --> 00:16:31,339
but it's a guide for coordinated

472
00:16:31,339 --> 00:16:33,889
vulnerability disclosure you know

473
00:16:33,889 --> 00:16:35,180
because we want to encourage you to do

474
00:16:35,180 --> 00:16:36,980
it properly you know and we'll work with

475
00:16:36,980 --> 00:16:38,690
you and we have our connections back to

476
00:16:38,690 --> 00:16:40,730
the most vendors to say hey like this is

477
00:16:40,730 --> 00:16:41,959
pretty serious you should probably take

478
00:16:41,959 --> 00:16:44,120
a look at that typically we're involved

479
00:16:44,120 --> 00:16:45,620
in a lot of the process that you hear

480
00:16:45,620 --> 00:16:47,389
about different other bigger

481
00:16:47,389 --> 00:16:49,160
vulnerabilities that were out there and

482
00:16:49,160 --> 00:16:50,569
you know because the government's always

483
00:16:50,569 --> 00:16:51,649
gonna come to us and say hey what do you

484
00:16:51,649 --> 00:16:53,360
know about for instance like Spectre

485
00:16:53,360 --> 00:16:54,829
meltdown and things like that right so

486
00:16:54,829 --> 00:16:56,089
something more major but we were

487
00:16:56,089 --> 00:16:58,190
involved a lot so take a look this you

488
00:16:58,190 --> 00:16:59,329
know this coordinated vulnerability

489
00:16:59,329 --> 00:17:00,350
disclosure guide if you have any

490
00:17:00,350 --> 00:17:02,810
questions let myself know reach out to

491
00:17:02,810 --> 00:17:04,339
the contacts on there and if you're

492
00:17:04,339 --> 00:17:06,349
doing this type of work try to be you

493
00:17:06,349 --> 00:17:07,700
know responsible with your disclosure

494
00:17:07,700 --> 00:17:09,470
now we're all researchers out there and

495
00:17:09,470 --> 00:17:12,440
we're worried about you know draw back

496
00:17:12,440 --> 00:17:13,940
from the vendor and things like that or

497
00:17:13,940 --> 00:17:15,290
you know companies like Huawei or they

498
00:17:15,290 --> 00:17:16,940
say you can't look at our devices you

499
00:17:16,940 --> 00:17:18,560
know that's it's illegal or it breaks

500
00:17:18,560 --> 00:17:20,960
are you law and things like that but you

501
00:17:20,960 --> 00:17:23,300
still should do what you need to do and

502
00:17:23,300 --> 00:17:24,410
if you have problems definitely reach

503
00:17:24,410 --> 00:17:25,700
out to us and we'll help chlorinate it

504
00:17:25,700 --> 00:17:28,220
as best as we can so that's sort of the

505
00:17:28,220 --> 00:17:30,980
red team approach to this so flipping it

506
00:17:30,980 --> 00:17:33,290
on its head applying the same

507
00:17:33,290 --> 00:17:36,770
methodology for network defense or that

508
00:17:36,770 --> 00:17:39,200
blue team approach right so more nice

509
00:17:39,200 --> 00:17:41,360
quote I found a while back was obviously

510
00:17:41,360 --> 00:17:43,910
more i io t means more value but also

511
00:17:43,910 --> 00:17:45,950
means greater risk right and I think we

512
00:17:45,950 --> 00:17:48,110
all sort of think about this and maybe

513
00:17:48,110 --> 00:17:50,630
we as the security resources think about

514
00:17:50,630 --> 00:17:52,370
it and or as other big companies it's

515
00:17:52,370 --> 00:17:55,370
really pushing for the c-suite people

516
00:17:55,370 --> 00:17:57,050
who weren't analysts at one point in

517
00:17:57,050 --> 00:17:58,400
time trying to convince them the

518
00:17:58,400 --> 00:17:59,810
importance to take a look at the devices

519
00:17:59,810 --> 00:18:01,220
before we put them on our networks I

520
00:18:01,220 --> 00:18:05,080
know I'm preaching to the choir but so

521
00:18:05,080 --> 00:18:07,490
due to the fact that you know embedded

522
00:18:07,490 --> 00:18:08,720
devices are becoming more ubiquitous

523
00:18:08,720 --> 00:18:10,250
across the you know they're it's

524
00:18:10,250 --> 00:18:11,630
increasing the threat landscape it's

525
00:18:11,630 --> 00:18:13,820
increasing the ways our adversaries can

526
00:18:13,820 --> 00:18:17,270
get in so you might want to start our

527
00:18:17,270 --> 00:18:19,460
continued discussion with your network

528
00:18:19,460 --> 00:18:21,440
defenders or yourselves right understand

529
00:18:21,440 --> 00:18:23,000
what embedded devices reside on your

530
00:18:23,000 --> 00:18:24,140
network and how you're gonna actually

531
00:18:24,140 --> 00:18:31,670
protect those devices themselves so the

532
00:18:31,670 --> 00:18:33,110
network defense approach to looking at

533
00:18:33,110 --> 00:18:34,880
embedded device list creation right so

534
00:18:34,880 --> 00:18:37,190
asset awareness like what devices do you

535
00:18:37,190 --> 00:18:38,660
have on your network are you aware of

536
00:18:38,660 --> 00:18:40,190
the devices on your network right you

537
00:18:40,190 --> 00:18:41,870
might have different security groups

538
00:18:41,870 --> 00:18:43,850
that are testing different devices right

539
00:18:43,850 --> 00:18:45,710
are you know are they to the testing

540
00:18:45,710 --> 00:18:47,420
devices that can get out to the Internet

541
00:18:47,420 --> 00:18:50,390
are they you close network obviously

542
00:18:50,390 --> 00:18:52,250
what devices do you have on your network

543
00:18:52,250 --> 00:18:53,870
but what does it do you have to plan to

544
00:18:53,870 --> 00:18:55,010
add your network have you actually

545
00:18:55,010 --> 00:18:58,070
thought about that what you what you're

546
00:18:58,070 --> 00:18:59,390
gonna do and how you're gonna handle

547
00:18:59,390 --> 00:19:01,330
them once they come on to your network

548
00:19:01,330 --> 00:19:03,440
obviously it probably makes sense to

549
00:19:03,440 --> 00:19:05,030
pick more than one vendor that has a

550
00:19:05,030 --> 00:19:06,470
similar product and really take a look

551
00:19:06,470 --> 00:19:08,480
at both of them and the pros and cons of

552
00:19:08,480 --> 00:19:10,820
each understanding of the features but

553
00:19:10,820 --> 00:19:12,530
the technical details right like what

554
00:19:12,530 --> 00:19:14,570
you know what components they have built

555
00:19:14,570 --> 00:19:16,550
into them what components they not do

556
00:19:16,550 --> 00:19:17,750
you actually need all the components

557
00:19:17,750 --> 00:19:19,020
they have built in or something

558
00:19:19,020 --> 00:19:20,160
more scaled-down better for your

559
00:19:20,160 --> 00:19:23,010
environment and there's this you know is

560
00:19:23,010 --> 00:19:24,990
it actually applicable to your network

561
00:19:24,990 --> 00:19:26,370
right do you really need it at the end

562
00:19:26,370 --> 00:19:29,820
of the day so information gathering

563
00:19:29,820 --> 00:19:32,490
right so look basically at this point

564
00:19:32,490 --> 00:19:33,570
you're looking at the threat ends the

565
00:19:33,570 --> 00:19:35,430
threat landscape associated with the

566
00:19:35,430 --> 00:19:37,980
device right as a device or similar

567
00:19:37,980 --> 00:19:40,740
devices consistently been riddled with

568
00:19:40,740 --> 00:19:42,480
vulnerabilities or known exploits like

569
00:19:42,480 --> 00:19:43,500
that shouldn't be something you should

570
00:19:43,500 --> 00:19:45,210
look into like it's your device that

571
00:19:45,210 --> 00:19:46,650
you're gonna be purchasing always

572
00:19:46,650 --> 00:19:48,420
showing up on like the VPN filter type

573
00:19:48,420 --> 00:19:49,740
reports you know is they always been in

574
00:19:49,740 --> 00:19:51,510
the attack by the Mirai botnet you know

575
00:19:51,510 --> 00:19:53,520
type things that will come in our future

576
00:19:53,520 --> 00:19:55,830
right where does that line with that you

577
00:19:55,830 --> 00:19:57,090
know take a look at and understand

578
00:19:57,090 --> 00:20:00,600
what's going on with there really

579
00:20:00,600 --> 00:20:02,450
important is how often do they implement

580
00:20:02,450 --> 00:20:05,010
patches the vendor itself right so for

581
00:20:05,010 --> 00:20:06,570
your devices if something comes out how

582
00:20:06,570 --> 00:20:08,130
quickly do they do it are they actually

583
00:20:08,130 --> 00:20:09,960
implementing patches for the specific

584
00:20:09,960 --> 00:20:12,680
device is it still support is it not

585
00:20:12,680 --> 00:20:15,720
have a you know how's that how does

586
00:20:15,720 --> 00:20:17,820
those patches gonna affect you know your

587
00:20:17,820 --> 00:20:20,640
day to day activity and then what

588
00:20:20,640 --> 00:20:22,710
reviews you know I would take a look at

589
00:20:22,710 --> 00:20:24,390
the reviews one funny cause I'll

590
00:20:24,390 --> 00:20:26,430
recently if someone said shout out to

591
00:20:26,430 --> 00:20:28,170
people who rate and review things cuz I

592
00:20:28,170 --> 00:20:29,880
don't rate or review things but I'd like

593
00:20:29,880 --> 00:20:31,290
to know how things are rated and

594
00:20:31,290 --> 00:20:32,970
reviewed I think a lot of us might fall

595
00:20:32,970 --> 00:20:35,280
in that category I know I am I don't

596
00:20:35,280 --> 00:20:36,750
rate or review anything but I'd like to

597
00:20:36,750 --> 00:20:38,160
know what someone else is said about

598
00:20:38,160 --> 00:20:39,960
this device and you know what things

599
00:20:39,960 --> 00:20:41,310
they have and whether the technical or

600
00:20:41,310 --> 00:20:46,350
not so look at the firmware analysis

601
00:20:46,350 --> 00:20:48,540
process so do you know what's actually

602
00:20:48,540 --> 00:20:50,580
on the device what is it running what

603
00:20:50,580 --> 00:20:52,410
versions running is it actually the

604
00:20:52,410 --> 00:20:55,170
version that says is it's running you

605
00:20:55,170 --> 00:20:56,820
can still analyze this as we were doing

606
00:20:56,820 --> 00:20:58,110
earlier you know if you have the device

607
00:20:58,110 --> 00:20:59,280
you're thinking about getting device

608
00:20:59,280 --> 00:21:00,930
maybe buy one of them and analyze it

609
00:21:00,930 --> 00:21:02,970
itself make sure you can compare what's

610
00:21:02,970 --> 00:21:05,240
you know actually on the system itself

611
00:21:05,240 --> 00:21:07,770
you know what software's package is is

612
00:21:07,770 --> 00:21:09,420
this device you know by default right

613
00:21:09,420 --> 00:21:13,080
you know what's on there do they put a

614
00:21:13,080 --> 00:21:14,580
lot of third-party software on there did

615
00:21:14,580 --> 00:21:16,170
they write their own applications to put

616
00:21:16,170 --> 00:21:18,600
on there themselves have those have

617
00:21:18,600 --> 00:21:21,390
associated vulnerabilities and you know

618
00:21:21,390 --> 00:21:23,040
a third-party software they have

619
00:21:23,040 --> 00:21:24,540
installed on there is their known

620
00:21:24,540 --> 00:21:27,180
vulnerabilities for that how often is

621
00:21:27,180 --> 00:21:28,530
the firmware get updated right like

622
00:21:28,530 --> 00:21:30,030
what's a time frame you know if

623
00:21:30,030 --> 00:21:32,640
something you know big comes out how

624
00:21:32,640 --> 00:21:33,149
quickly

625
00:21:33,149 --> 00:21:35,549
are they to market to put out a patch

626
00:21:35,549 --> 00:21:39,839
for that you know looking at the

627
00:21:39,839 --> 00:21:41,339
changelogs themselves like the

628
00:21:41,339 --> 00:21:42,659
development we're support right if this

629
00:21:42,659 --> 00:21:44,759
is like an everyday webcam that you know

630
00:21:44,759 --> 00:21:46,769
everybody uses like is that getting as

631
00:21:46,769 --> 00:21:48,330
much attention as like their main router

632
00:21:48,330 --> 00:21:49,979
they might have on you know owned by the

633
00:21:49,979 --> 00:21:52,379
same company obviously the tool I wrote

634
00:21:52,379 --> 00:21:53,879
and could also assist with this part

635
00:21:53,879 --> 00:21:55,739
right you running across the you know

636
00:21:55,739 --> 00:21:57,149
firmware looking for things like

637
00:21:57,149 --> 00:21:59,609
hard-coded vulnerabilities our software

638
00:21:59,609 --> 00:22:02,369
out of date associated bilities or

639
00:22:02,369 --> 00:22:04,499
exploits with that software again is

640
00:22:04,499 --> 00:22:07,679
their custom software out-of-date

641
00:22:07,679 --> 00:22:09,269
software is notorious most of these

642
00:22:09,269 --> 00:22:11,129
embedded devices have something called

643
00:22:11,129 --> 00:22:12,929
busybox I'm sure you're all aware of

644
00:22:12,929 --> 00:22:16,200
right it's a they package all different

645
00:22:16,200 --> 00:22:18,210
types of the good new core utilities

646
00:22:18,210 --> 00:22:20,339
into busy box and you can you know sort

647
00:22:20,339 --> 00:22:22,559
of customize busy box to include what

648
00:22:22,559 --> 00:22:24,239
you want in there but they're not even

649
00:22:24,239 --> 00:22:25,769
installing the most up-to-date stable

650
00:22:25,769 --> 00:22:27,419
version of busy box something you buy

651
00:22:27,419 --> 00:22:28,830
today that's brand new is gonna have

652
00:22:28,830 --> 00:22:30,929
probably an old version of busy box

653
00:22:30,929 --> 00:22:32,669
maybe this is the first version right I

654
00:22:32,669 --> 00:22:34,320
can tell you the first version itself

655
00:22:34,320 --> 00:22:37,320
has like six known CVS associated with

656
00:22:37,320 --> 00:22:39,299
it right and like a couple like exploit

657
00:22:39,299 --> 00:22:41,820
DB modules associated with it now is it

658
00:22:41,820 --> 00:22:43,769
gonna work into your device maybe maybe

659
00:22:43,769 --> 00:22:45,989
not right but I'm like I always like to

660
00:22:45,989 --> 00:22:47,969
say just because something doesn't have

661
00:22:47,969 --> 00:22:50,940
an exploit and as for CVE doesn't mean

662
00:22:50,940 --> 00:22:51,960
that if someone in have enough time and

663
00:22:51,960 --> 00:22:57,269
energy could they develop one so looking

664
00:22:57,269 --> 00:22:58,639
at the web application right is it

665
00:22:58,639 --> 00:23:01,440
password-protected is it you're using

666
00:23:01,440 --> 00:23:03,869
the default stuff have you disabled a

667
00:23:03,869 --> 00:23:05,429
remote administration is this something

668
00:23:05,429 --> 00:23:06,479
you actually need to take into account

669
00:23:06,479 --> 00:23:09,029
if not why do you need a remote

670
00:23:09,029 --> 00:23:10,859
administration of IOT or embedded

671
00:23:10,859 --> 00:23:12,629
devices on your network why can't you

672
00:23:12,629 --> 00:23:14,580
just take care of them like by VPN in it

673
00:23:14,580 --> 00:23:16,889
and things like that who and what can

674
00:23:16,889 --> 00:23:18,719
access that web application or a device

675
00:23:18,719 --> 00:23:20,369
right to take into account obviously

676
00:23:20,369 --> 00:23:22,619
have you changed default credentials

677
00:23:22,619 --> 00:23:26,129
I bought a recent little mini router to

678
00:23:26,129 --> 00:23:28,799
put into like when I travel right and

679
00:23:28,799 --> 00:23:30,509
create like a hotspot if they could give

680
00:23:30,509 --> 00:23:32,580
you a Ethernet into your hotel room the

681
00:23:32,580 --> 00:23:33,719
first thing that steps when you set up

682
00:23:33,719 --> 00:23:35,219
is like change your defaults so that's

683
00:23:35,219 --> 00:23:36,539
actually nice to see it the device

684
00:23:36,539 --> 00:23:37,919
actually forcing you to change the

685
00:23:37,919 --> 00:23:39,659
defaults but if it doesn't have you

686
00:23:39,659 --> 00:23:41,369
changed to a fault and obviously we can

687
00:23:41,369 --> 00:23:42,690
answer that a lot of people don't do

688
00:23:42,690 --> 00:23:44,669
this because that's how I know Mariah

689
00:23:44,669 --> 00:23:47,070
was successful that's why VPN filters

690
00:23:47,070 --> 00:23:51,690
probably successful and but bigger thing

691
00:23:51,690 --> 00:23:53,070
is have you actually considered the web

692
00:23:53,070 --> 00:23:54,600
application of the embedded device

693
00:23:54,600 --> 00:23:55,889
that's on your network as part of your

694
00:23:55,889 --> 00:23:58,799
everyday assessment right probably not

695
00:23:58,799 --> 00:24:00,690
probably people forget about it that it

696
00:24:00,690 --> 00:24:02,220
has a web app front and butt for testing

697
00:24:02,220 --> 00:24:04,049
your normal website and other web apps

698
00:24:04,049 --> 00:24:06,090
you have for your business or that you

699
00:24:06,090 --> 00:24:08,009
use right why wouldn't you test the ones

700
00:24:08,009 --> 00:24:09,720
associate with the IOT devices you have

701
00:24:09,720 --> 00:24:14,909
on your network so looking at the mobile

702
00:24:14,909 --> 00:24:16,769
application right it's very similar to

703
00:24:16,769 --> 00:24:19,500
the web application do you need to

704
00:24:19,500 --> 00:24:21,559
actually use a mobile application to

705
00:24:21,559 --> 00:24:24,210
access device sometimes I did you know

706
00:24:24,210 --> 00:24:25,409
it is true you might need the mobile

707
00:24:25,409 --> 00:24:26,789
application to at least set it up

708
00:24:26,789 --> 00:24:29,039
initially before you can then pivot to

709
00:24:29,039 --> 00:24:30,899
like the web app front-end that you can

710
00:24:30,899 --> 00:24:33,389
access from your network but who has

711
00:24:33,389 --> 00:24:35,039
access to that are they willing to keep

712
00:24:35,039 --> 00:24:36,480
that you know is a company itself

713
00:24:36,480 --> 00:24:38,190
willing to keep that application up to

714
00:24:38,190 --> 00:24:40,379
date but also is that person keeping

715
00:24:40,379 --> 00:24:41,850
their phone up to date that's accessing

716
00:24:41,850 --> 00:24:43,590
it right someone has to have the web app

717
00:24:43,590 --> 00:24:45,379
on their phone right somehow some way

718
00:24:45,379 --> 00:24:47,789
how does the web application access to

719
00:24:47,789 --> 00:24:49,259
the device are there different ports is

720
00:24:49,259 --> 00:24:50,610
going to be using like you have to take

721
00:24:50,610 --> 00:24:52,259
that into account you know what kind of

722
00:24:52,259 --> 00:24:53,490
traffic who's gonna create what

723
00:24:53,490 --> 00:24:54,690
footprint is it gonna create on your

724
00:24:54,690 --> 00:24:57,480
network itself what permissions so this

725
00:24:57,480 --> 00:24:58,590
is where a trommel actually looks at

726
00:24:58,590 --> 00:25:00,600
like what permissions that that device

727
00:25:00,600 --> 00:25:02,580
have be able to access on your phone

728
00:25:02,580 --> 00:25:04,200
right does it need to access things it

729
00:25:04,200 --> 00:25:06,690
shouldn't need to access thing to and if

730
00:25:06,690 --> 00:25:08,610
so why and you actually need to use the

731
00:25:08,610 --> 00:25:11,669
mobile application obviously is the

732
00:25:11,669 --> 00:25:13,110
vendor updating the mobile application

733
00:25:13,110 --> 00:25:15,480
take that into consideration and there's

734
00:25:15,480 --> 00:25:17,309
the application from their website or is

735
00:25:17,309 --> 00:25:18,690
it from the associated you know app

736
00:25:18,690 --> 00:25:20,690
stores that exist right you can download

737
00:25:20,690 --> 00:25:23,009
both types of applications from any

738
00:25:23,009 --> 00:25:25,049
website sometimes you're wondering then

739
00:25:25,049 --> 00:25:26,190
why did they push it through the

740
00:25:26,190 --> 00:25:27,870
curation process to get it to the Apple

741
00:25:27,870 --> 00:25:29,490
Store or the Android you know

742
00:25:29,490 --> 00:25:31,649
application store take that into

743
00:25:31,649 --> 00:25:36,269
consideration for hardware analysis

744
00:25:36,269 --> 00:25:38,250
right you can you know the biggest thing

745
00:25:38,250 --> 00:25:39,629
is obviously changes the faults are

746
00:25:39,629 --> 00:25:41,309
actually on the device right just

747
00:25:41,309 --> 00:25:44,730
because it uses this you know you know

748
00:25:44,730 --> 00:25:47,250
RFC 1918 IP address like you can change

749
00:25:47,250 --> 00:25:49,679
it from a 192.168 network to a 10 right

750
00:25:49,679 --> 00:25:50,850
you don't have to use what's on the back

751
00:25:50,850 --> 00:25:52,230
of the device you can force it to use

752
00:25:52,230 --> 00:25:53,850
other things you can change the

753
00:25:53,850 --> 00:25:55,559
information on there but I would try to

754
00:25:55,559 --> 00:25:57,840
change that information what information

755
00:25:57,840 --> 00:26:00,120
is in these databases that exist if it

756
00:26:00,120 --> 00:26:02,700
does have radio frequency communications

757
00:26:02,700 --> 00:26:04,740
right what does exist in there is there

758
00:26:04,740 --> 00:26:07,260
it you know does it not have bluetooth

759
00:26:07,260 --> 00:26:09,510
but it has a Bluetooth chip inside of it

760
00:26:09,510 --> 00:26:10,860
like why does it have that I know

761
00:26:10,860 --> 00:26:13,110
medical devices

762
00:26:13,110 --> 00:26:14,700
we're notorious for this for like

763
00:26:14,700 --> 00:26:16,320
putting Wi-Fi chips in their device

764
00:26:16,320 --> 00:26:17,879
because you know down the road we'll use

765
00:26:17,879 --> 00:26:19,230
it right but we're not to use it now but

766
00:26:19,230 --> 00:26:20,610
then they leave it wide open right you

767
00:26:20,610 --> 00:26:22,559
know this is a very common problem it's

768
00:26:22,559 --> 00:26:24,960
probably still to this day and then

769
00:26:24,960 --> 00:26:26,370
think about other ways you can harden

770
00:26:26,370 --> 00:26:28,169
the device right you know scanning the

771
00:26:28,169 --> 00:26:29,820
device itself well how can you lock down

772
00:26:29,820 --> 00:26:31,500
the device right if it's sitting in and

773
00:26:31,500 --> 00:26:32,909
it's plugged in down here what happens

774
00:26:32,909 --> 00:26:34,500
if someone plugs it right you have to

775
00:26:34,500 --> 00:26:36,149
consider that that everybody is nice

776
00:26:36,149 --> 00:26:37,889
maybe it's in an open space maybe you

777
00:26:37,889 --> 00:26:39,840
have stuff inside a hospital so forth

778
00:26:39,840 --> 00:26:41,399
and so on who can actually get you know

779
00:26:41,399 --> 00:26:43,409
access to the notoriously you see lots

780
00:26:43,409 --> 00:26:44,909
of like Ethernet cables plugged in right

781
00:26:44,909 --> 00:26:46,139
underneath of the device why didn't they

782
00:26:46,139 --> 00:26:47,820
just put that behind the wall does it

783
00:26:47,820 --> 00:26:56,159
consider so a vulnerability analysis

784
00:26:56,159 --> 00:26:58,049
right amenable to perform you know at

785
00:26:58,049 --> 00:26:59,760
least your own vulnerability scans

786
00:26:59,760 --> 00:27:03,779
across the devices see what's there see

787
00:27:03,779 --> 00:27:05,580
what how it pops up like what's you know

788
00:27:05,580 --> 00:27:07,710
what's is there anything you know the

789
00:27:07,710 --> 00:27:09,090
typical applications that you can run

790
00:27:09,090 --> 00:27:11,460
across it but you know does the vendor

791
00:27:11,460 --> 00:27:12,720
have the big things do vendor have a

792
00:27:12,720 --> 00:27:14,309
disclosure process like if you do find

793
00:27:14,309 --> 00:27:15,899
something and maybe you're not like a

794
00:27:15,899 --> 00:27:17,610
red teamer but you find these flaws like

795
00:27:17,610 --> 00:27:19,169
maybe we still want to tell the vendor

796
00:27:19,169 --> 00:27:21,090
hey like these it's you know this web

797
00:27:21,090 --> 00:27:22,470
app is showing up with like all these

798
00:27:22,470 --> 00:27:24,779
different indicators of vulnerabilities

799
00:27:24,779 --> 00:27:27,510
like maybe can you fix this right and

800
00:27:27,510 --> 00:27:29,250
push out an update right do they have a

801
00:27:29,250 --> 00:27:33,059
way to do that how does the vendor

802
00:27:33,059 --> 00:27:34,769
communicate information about patches

803
00:27:34,769 --> 00:27:36,929
itself you know is it putting the proper

804
00:27:36,929 --> 00:27:39,690
information inside a change log is it

805
00:27:39,690 --> 00:27:41,220
telling you why this one was been

806
00:27:41,220 --> 00:27:43,679
updated you know it what type of patches

807
00:27:43,679 --> 00:27:45,149
did it make like I said earlier to just

808
00:27:45,149 --> 00:27:47,669
say bug fix right it always makes you

809
00:27:47,669 --> 00:27:51,059
wonder when they when the vendor finds

810
00:27:51,059 --> 00:27:53,460
their own remote code execution flaw on

811
00:27:53,460 --> 00:27:54,659
their own code like they're not

812
00:27:54,659 --> 00:27:56,399
submitting this for us CVE right they're

813
00:27:56,399 --> 00:27:57,629
quickly trying to patch it before

814
00:27:57,629 --> 00:28:01,740
someone else finds it so that's where

815
00:28:01,740 --> 00:28:04,230
they you know flip it on its head type

816
00:28:04,230 --> 00:28:06,240
approach I moved pretty quickly through

817
00:28:06,240 --> 00:28:10,080
that but one thing I haven't talked

818
00:28:10,080 --> 00:28:11,580
about before is you know budget

819
00:28:11,580 --> 00:28:13,080
everybody's like well

820
00:28:13,080 --> 00:28:15,899
how do i budget for doing this myself as

821
00:28:15,899 --> 00:28:20,429
opposed to maybe outsource in it so the

822
00:28:20,429 --> 00:28:21,779
nice thing is that when I create this I

823
00:28:21,779 --> 00:28:23,519
thought about that and I said like you

824
00:28:23,519 --> 00:28:25,110
can probably do 90% of this methodology

825
00:28:25,110 --> 00:28:28,879
to perform analysis at no cost right

826
00:28:28,879 --> 00:28:31,049
only on the hardware size where you

827
00:28:31,049 --> 00:28:32,399
started to get some cost right you can

828
00:28:32,399 --> 00:28:33,869
even leave that out right or you can do

829
00:28:33,869 --> 00:28:35,970
just bits and pieces of it we do have a

830
00:28:35,970 --> 00:28:37,799
limited budget and I say limited by like

831
00:28:37,799 --> 00:28:41,249
$100 you know you can pick up a Wi-Fi

832
00:28:41,249 --> 00:28:43,649
dongle itself you could pick up a bus

833
00:28:43,649 --> 00:28:45,960
pirate you know and do these things

834
00:28:45,960 --> 00:28:47,489
right these are just suggestions now

835
00:28:47,489 --> 00:28:49,529
endorsements if you have a larger budget

836
00:28:49,529 --> 00:28:51,179
right you can then take care of a few

837
00:28:51,179 --> 00:28:54,570
other options right around $1,500 itself

838
00:28:54,570 --> 00:28:55,830
right you can buy the device you know

839
00:28:55,830 --> 00:28:58,019
Wi-Fi dongle the bus pirate maybe you

840
00:28:58,019 --> 00:28:59,460
have other frequencies you can do you

841
00:28:59,460 --> 00:29:00,869
know look at the hack RF one which

842
00:29:00,869 --> 00:29:02,519
covers more of a range of frequencies on

843
00:29:02,519 --> 00:29:05,039
the device you can buy a license for

844
00:29:05,039 --> 00:29:06,600
burp suite you can buy a license for

845
00:29:06,600 --> 00:29:08,519
binary ninja to do some reverse

846
00:29:08,519 --> 00:29:10,109
engineering that the applications off to

847
00:29:10,109 --> 00:29:12,119
the device if it has Bluetooth you can

848
00:29:12,119 --> 00:29:18,210
buy you know the uber tooth so you know

849
00:29:18,210 --> 00:29:19,679
the past present future work right so

850
00:29:19,679 --> 00:29:21,840
the work of this was done this

851
00:29:21,840 --> 00:29:24,389
methodology is out there we apply it to

852
00:29:24,389 --> 00:29:26,039
a couple different web cameras in the

853
00:29:26,039 --> 00:29:27,720
paper itself we talked about one itself

854
00:29:27,720 --> 00:29:29,609
I've applied it to other embedded

855
00:29:29,609 --> 00:29:31,109
devices since then that are not

856
00:29:31,109 --> 00:29:32,940
typically IOT and I still follow this

857
00:29:32,940 --> 00:29:37,379
process ideally you know there's lots

858
00:29:37,379 --> 00:29:40,049
still that I didn't cover but didn't

859
00:29:40,049 --> 00:29:41,669
even write about and take into

860
00:29:41,669 --> 00:29:43,169
consideration right well actually

861
00:29:43,169 --> 00:29:44,730
looking at the you know radio frequency

862
00:29:44,730 --> 00:29:47,159
analysis looking more at Wi-Fi looking

863
00:29:47,159 --> 00:29:48,749
at Bluetooth looking at other you know

864
00:29:48,749 --> 00:29:50,639
maybe they have ZigBee or z-wave built

865
00:29:50,639 --> 00:29:53,309
into it you know as a network or defense

866
00:29:53,309 --> 00:29:56,190
approach you know do a lot allow Wi-Fi

867
00:29:56,190 --> 00:29:57,600
or Bluetooth on your network maybe you

868
00:29:57,600 --> 00:30:00,119
don't great if so how these devices

869
00:30:00,119 --> 00:30:02,399
segment does the device operate on other

870
00:30:02,399 --> 00:30:05,070
frequencies right you know is it's gonna

871
00:30:05,070 --> 00:30:06,809
affect other products that you have is

872
00:30:06,809 --> 00:30:08,249
there gonna be the overlapping channels

873
00:30:08,249 --> 00:30:09,960
is it gonna cause some noise in the

874
00:30:09,960 --> 00:30:12,600
network so actually then another

875
00:30:12,600 --> 00:30:14,249
approach that we're you know putting

876
00:30:14,249 --> 00:30:15,600
together you know looking at the other

877
00:30:15,600 --> 00:30:17,489
devices off their right arm and you know

878
00:30:17,489 --> 00:30:19,080
MIPS files from the device creating

879
00:30:19,080 --> 00:30:20,940
little scripts that you could do for

880
00:30:20,940 --> 00:30:22,190
some reverse engine

881
00:30:22,190 --> 00:30:25,419
low-level reverse engineering

882
00:30:25,419 --> 00:30:26,919
as a network defense approach like I'm

883
00:30:26,919 --> 00:30:28,869
not a reverse engineer but I still I

884
00:30:28,869 --> 00:30:31,299
still care about what's on there so you

885
00:30:31,299 --> 00:30:32,499
can think about what is the vendor

886
00:30:32,499 --> 00:30:33,639
running on the device

887
00:30:33,639 --> 00:30:35,379
how much third-party software is on the

888
00:30:35,379 --> 00:30:36,909
device and it's just information

889
00:30:36,909 --> 00:30:38,559
vulnerable if you didn't really want to

890
00:30:38,559 --> 00:30:39,759
get into the whole reverse engineering

891
00:30:39,759 --> 00:30:41,320
aspect you can still cover these things

892
00:30:41,320 --> 00:30:43,149
and I think still think fall into that

893
00:30:43,149 --> 00:30:45,070
that bucket I didn't look at anything

894
00:30:45,070 --> 00:30:47,019
iOS it's really it's a lot harder to get

895
00:30:47,019 --> 00:30:49,330
iOS applications than it is to get your

896
00:30:49,330 --> 00:30:54,100
hands on an android apk itself but you

897
00:30:54,100 --> 00:30:55,990
know how does how did those two

898
00:30:55,990 --> 00:30:58,450
applications differ you know for each

899
00:30:58,450 --> 00:30:59,830
device

900
00:30:59,830 --> 00:31:01,539
you know comparing it that way as well

901
00:31:01,539 --> 00:31:04,570
and just a device support both sides you

902
00:31:04,570 --> 00:31:06,639
know as the developer the vendor itself

903
00:31:06,639 --> 00:31:08,169
actually putting out iOS and Android

904
00:31:08,169 --> 00:31:10,720
fought you know application for the

905
00:31:10,720 --> 00:31:13,029
device and then this is a big thing as

906
00:31:13,029 --> 00:31:15,249
Network mapping right in the footprint

907
00:31:15,249 --> 00:31:17,619
of device on a network so the network

908
00:31:17,619 --> 00:31:19,269
defense approach was like what ports are

909
00:31:19,269 --> 00:31:22,749
open on the device a big thing what does

910
00:31:22,749 --> 00:31:24,159
the traffic look like as it's talking

911
00:31:24,159 --> 00:31:26,740
you know it's it's in in different

912
00:31:26,740 --> 00:31:29,259
states as well and like an idle or you

913
00:31:29,259 --> 00:31:30,730
know could this information be easily

914
00:31:30,730 --> 00:31:32,379
altered or spoofed right can something

915
00:31:32,379 --> 00:31:33,730
else make itself look like that

916
00:31:33,730 --> 00:31:36,210
for instance one good you know

917
00:31:36,210 --> 00:31:38,139
comparison is like the phillips hughes

918
00:31:38,139 --> 00:31:39,909
light bulbs even in the off state it

919
00:31:39,909 --> 00:31:41,470
sends about two million packets a day

920
00:31:41,470 --> 00:31:43,600
it's consistently updating and talking

921
00:31:43,600 --> 00:31:45,340
out to network right that's in the off

922
00:31:45,340 --> 00:31:47,470
state right I can't I didn't test it in

923
00:31:47,470 --> 00:31:49,210
the on state how much more or less it

924
00:31:49,210 --> 00:31:54,070
does so a couple closing thoughts right

925
00:31:54,070 --> 00:31:55,869
so this methodology was developed to

926
00:31:55,869 --> 00:31:58,389
create a macro level process to do

927
00:31:58,389 --> 00:32:00,360
embedded device vulnerability analysis

928
00:32:00,360 --> 00:32:02,740
to make you know to put together more

929
00:32:02,740 --> 00:32:04,240
comprehensive results and actionable

930
00:32:04,240 --> 00:32:05,499
results that you can actually take and

931
00:32:05,499 --> 00:32:08,350
use create an open source tool you can

932
00:32:08,350 --> 00:32:10,360
use we're trying to expand the

933
00:32:10,360 --> 00:32:11,769
methodology it's gonna be a little

934
00:32:11,769 --> 00:32:12,999
harder now than back in the malware

935
00:32:12,999 --> 00:32:14,379
world as opposed to vulnerability

936
00:32:14,379 --> 00:32:15,789
analysis world but it's still my little

937
00:32:15,789 --> 00:32:17,799
side project stuff I like to do and they

938
00:32:17,799 --> 00:32:19,659
it shows you to how you can take a red

939
00:32:19,659 --> 00:32:21,340
team process and turn it into the blue

940
00:32:21,340 --> 00:32:23,110
team so I might call that purple team

941
00:32:23,110 --> 00:32:24,970
nowadays but it's a way you can spin on

942
00:32:24,970 --> 00:32:29,110
its head this is my information how you

943
00:32:29,110 --> 00:32:31,539
can get a hold of me Masen Oliver my

944
00:32:31,539 --> 00:32:33,220
colleague now helping it you know down

945
00:32:33,220 --> 00:32:34,990
the original path of his methodology so

946
00:32:34,990 --> 00:32:36,560
I want to thank her

947
00:32:36,560 --> 00:32:38,930
the papers out there on the fuse SDI

948
00:32:38,930 --> 00:32:40,790
digital library search for my name or

949
00:32:40,790 --> 00:32:42,200
mass his name it'll be out there

950
00:32:42,200 --> 00:32:44,480
trembles out there on github if you just

951
00:32:44,480 --> 00:32:46,640
search search cc or search trommel

952
00:32:46,640 --> 00:32:49,240
I've been asked why the name trommel

953
00:32:49,240 --> 00:32:51,380
trommel is a tool you use during mining

954
00:32:51,380 --> 00:32:52,580
that you shake and all the nice stuff

955
00:32:52,580 --> 00:32:54,980
like sits on top that's how I got to

956
00:32:54,980 --> 00:32:57,430
that I thought sieve sounded weird

957
00:32:57,430 --> 00:32:59,330
that's another word that does the same

958
00:32:59,330 --> 00:33:00,430
thing

959
00:33:00,430 --> 00:33:02,750
[Applause]

960
00:33:02,750 --> 00:33:17,250
[Music]

