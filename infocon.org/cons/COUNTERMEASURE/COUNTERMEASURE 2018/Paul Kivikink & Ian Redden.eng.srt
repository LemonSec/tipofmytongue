1
00:00:00,330 --> 00:00:09,389
[Music]

2
00:00:11,870 --> 00:00:14,000
thanks for coming

3
00:00:14,000 --> 00:00:16,139
certainly we find the topic of threat

4
00:00:16,139 --> 00:00:18,300
hunting and just interesting we talk a

5
00:00:18,300 --> 00:00:20,369
lot about it internally we were lucky

6
00:00:20,369 --> 00:00:22,769
enough to get engaged in a lot of these

7
00:00:22,769 --> 00:00:25,310
activities with different organizations

8
00:00:25,310 --> 00:00:27,539
ian is a wealth of knowledge and I'm

9
00:00:27,539 --> 00:00:28,619
really happy to have him here from

10
00:00:28,619 --> 00:00:30,390
Toronto so we put together a

11
00:00:30,390 --> 00:00:32,308
presentation that we hope is useful to

12
00:00:32,308 --> 00:00:34,920
you guys if you're just embarking on the

13
00:00:34,920 --> 00:00:36,420
activity of threat hunting within your

14
00:00:36,420 --> 00:00:38,280
cybersecurity program or if you're

15
00:00:38,280 --> 00:00:40,020
experienced hunters hopefully we can

16
00:00:40,020 --> 00:00:42,180
provide a few tips and maybe ideas to

17
00:00:42,180 --> 00:00:44,219
help with your hunting so let me get

18
00:00:44,219 --> 00:00:46,230
started I thought I'd start this by

19
00:00:46,230 --> 00:00:48,120
posing the question of what is threat

20
00:00:48,120 --> 00:00:51,539
hunting it seems like a simple question

21
00:00:51,539 --> 00:00:54,210
Ian and I had the privilege of attending

22
00:00:54,210 --> 00:00:56,340
a threat hunting panel at RSA Conference

23
00:00:56,340 --> 00:00:58,680
last April and it was a really

24
00:00:58,680 --> 00:01:01,289
interesting panel it was hosted by Anton

25
00:01:01,289 --> 00:01:03,059
from Gartner and if you follow Anton on

26
00:01:03,059 --> 00:01:04,489
Twitter he's a very interesting

27
00:01:04,489 --> 00:01:07,650
opinionated fellow but on this panel was

28
00:01:07,650 --> 00:01:10,710
a CSO from Google the seaso from Telstra

29
00:01:10,710 --> 00:01:14,070
telecom in Australia and the CTO from

30
00:01:14,070 --> 00:01:14,729
CrowdStrike

31
00:01:14,729 --> 00:01:17,040
and they asked this question as the

32
00:01:17,040 --> 00:01:18,900
opening question in the panel of what is

33
00:01:18,900 --> 00:01:22,409
threat hunting and three arguably some

34
00:01:22,409 --> 00:01:24,119
of the most mature organizations in the

35
00:01:24,119 --> 00:01:25,229
industry from a security perspective

36
00:01:25,229 --> 00:01:28,049
none of them could actually agree on the

37
00:01:28,049 --> 00:01:30,150
same definition of threat hunting it was

38
00:01:30,150 --> 00:01:32,640
really interesting on one end of the

39
00:01:32,640 --> 00:01:36,119
spectrum you had the belief that threat

40
00:01:36,119 --> 00:01:38,640
hunting could be you know automated you

41
00:01:38,640 --> 00:01:40,860
could leverage AI and machine learning

42
00:01:40,860 --> 00:01:43,140
to do threat hunting on the opposite end

43
00:01:43,140 --> 00:01:45,479
of the spectrum you had people believing

44
00:01:45,479 --> 00:01:48,420
that hunt 300 is a purely human driven

45
00:01:48,420 --> 00:01:51,570
process while I believe it could be a

46
00:01:51,570 --> 00:01:54,000
combination of both I thought I would

47
00:01:54,000 --> 00:01:55,470
level set and just say you know between

48
00:01:55,470 --> 00:01:58,770
Ian and I we believe it's a human driven

49
00:01:58,770 --> 00:02:02,219
process that could arguably be automated

50
00:02:02,219 --> 00:02:04,439
in some stages but looking for instance

51
00:02:04,439 --> 00:02:07,259
or weaknesses within your organization

52
00:02:07,259 --> 00:02:09,538
without prior knowledge of that attack

53
00:02:09,538 --> 00:02:12,380
that would otherwise circumvent your

54
00:02:12,380 --> 00:02:14,540
engine and threat detection systems so

55
00:02:14,540 --> 00:02:16,340
something to think about I bet you if

56
00:02:16,340 --> 00:02:17,990
you ask the person next to you what is

57
00:02:17,990 --> 00:02:20,180
threat hunting you'll likely get a

58
00:02:20,180 --> 00:02:21,230
different answer of what you think

59
00:02:21,230 --> 00:02:25,220
threat hunting is oh how do I work this

60
00:02:25,220 --> 00:02:26,660
thing Bing button out of the top oh

61
00:02:26,660 --> 00:02:31,250
great so boom right into it

62
00:02:31,250 --> 00:02:33,770
Locard's exchange principle just show

63
00:02:33,770 --> 00:02:36,670
her hands who has heard of low cards

64
00:02:36,670 --> 00:02:42,020
yeah James at the back about three years

65
00:02:42,020 --> 00:02:44,000
ago I started really myself hearing

66
00:02:44,000 --> 00:02:45,140
about threat hunting and I always

67
00:02:45,140 --> 00:02:46,970
wondered what threat hunting was and how

68
00:02:46,970 --> 00:02:49,420
it differentiated itself from forensics

69
00:02:49,420 --> 00:02:53,470
in my mind they're one in the same

70
00:02:53,470 --> 00:02:57,520
forensics yes tends to be primarily

71
00:02:57,520 --> 00:03:01,400
reactive there are instances where you

72
00:03:01,400 --> 00:03:04,990
use it for a proactive approach but

73
00:03:04,990 --> 00:03:07,220
they're one in the same and the

74
00:03:07,220 --> 00:03:09,950
principle still applies like Locard's

75
00:03:09,950 --> 00:03:12,430
exchange principle is when two things

76
00:03:12,430 --> 00:03:14,870
come into contact of each other you have

77
00:03:14,870 --> 00:03:19,760
an exchange of matter and the idea is

78
00:03:19,760 --> 00:03:23,690
that similar to a crime scene you have

79
00:03:23,690 --> 00:03:26,840
bloody fingerprints or you have mud

80
00:03:26,840 --> 00:03:28,550
through the crime scene

81
00:03:28,550 --> 00:03:30,050
you take something always leave

82
00:03:30,050 --> 00:03:30,950
something behind

83
00:03:30,950 --> 00:03:33,350
and this principle applies to the

84
00:03:33,350 --> 00:03:36,470
digital realm for example when you

85
00:03:36,470 --> 00:03:39,110
connect to a web server somewhere that

86
00:03:39,110 --> 00:03:43,580
connection is logged you have an FTP

87
00:03:43,580 --> 00:03:45,709
there's evidence of you downloading a

88
00:03:45,709 --> 00:03:48,530
file and even there's cases where it's

89
00:03:48,530 --> 00:03:52,300
not actually logged anywhere it could be

90
00:03:52,300 --> 00:03:56,840
a piece of log entry that's a fragment

91
00:03:56,840 --> 00:04:00,110
in memory or it's Ana temporary file but

92
00:04:00,110 --> 00:04:01,850
you you always leave something behind

93
00:04:01,850 --> 00:04:04,459
principal the thing that I hear often

94
00:04:04,459 --> 00:04:07,520
times and threat hunting is they can't

95
00:04:07,520 --> 00:04:10,280
find it so the idea is is that you know

96
00:04:10,280 --> 00:04:12,350
nothing is detectable you just don't

97
00:04:12,350 --> 00:04:14,600
have the right information yet also the

98
00:04:14,600 --> 00:04:16,250
other thing is in security we tend to

99
00:04:16,250 --> 00:04:18,290
say well there is no such thing as 100%

100
00:04:18,290 --> 00:04:20,630
security that's highly improbable or

101
00:04:20,630 --> 00:04:23,470
impossible but you can have near 100%

102
00:04:23,470 --> 00:04:25,340
visibility by

103
00:04:25,340 --> 00:04:31,520
threat hunting so why hunt this is I

104
00:04:31,520 --> 00:04:34,810
think the question why most of you here

105
00:04:34,810 --> 00:04:38,090
because it's proactive I think most of

106
00:04:38,090 --> 00:04:40,970
us in this room can agree there's times

107
00:04:40,970 --> 00:04:42,740
in our life especially in this industry

108
00:04:42,740 --> 00:04:44,300
where we kind of feel like we're on the

109
00:04:44,300 --> 00:04:46,790
losing team that the bad guys are always

110
00:04:46,790 --> 00:04:49,760
winning so quite a few years ago I

111
00:04:49,760 --> 00:04:53,660
started working at a bank and just had a

112
00:04:53,660 --> 00:04:55,490
Solaris box with whole bunch of logs and

113
00:04:55,490 --> 00:04:56,810
I just started looking through the logs

114
00:04:56,810 --> 00:04:58,790
and and grepping things and I was

115
00:04:58,790 --> 00:05:01,220
finding all sorts of evidence of

116
00:05:01,220 --> 00:05:04,400
malicious behavior or employee misuse

117
00:05:04,400 --> 00:05:07,520
just by grepping certain strings through

118
00:05:07,520 --> 00:05:12,290
the logs and quickly realized that by

119
00:05:12,290 --> 00:05:14,990
threat hunting it's much harder for the

120
00:05:14,990 --> 00:05:16,340
talker to hide if you're actively

121
00:05:16,340 --> 00:05:18,410
looking for them and you're also

122
00:05:18,410 --> 00:05:20,540
actively learning about your network

123
00:05:20,540 --> 00:05:23,060
you're learning things that stalkers

124
00:05:23,060 --> 00:05:24,590
usually when they come onto your network

125
00:05:24,590 --> 00:05:26,540
and they attack you first thing they do

126
00:05:26,540 --> 00:05:28,669
is enumerate enumerate enumerate they

127
00:05:28,669 --> 00:05:30,380
know more about your network when they

128
00:05:30,380 --> 00:05:33,979
attack you than most IT groups so it's

129
00:05:33,979 --> 00:05:35,750
much harder to hide when when you know

130
00:05:35,750 --> 00:05:39,350
you're in your environment lastly the

131
00:05:39,350 --> 00:05:41,360
thing very quickly when I was back at

132
00:05:41,360 --> 00:05:42,979
the bank I was starting my threat

133
00:05:42,979 --> 00:05:46,130
hunting exercise I suddenly realized

134
00:05:46,130 --> 00:05:47,660
that I was being invited to all these

135
00:05:47,660 --> 00:05:50,810
architect meetings and it was because I

136
00:05:50,810 --> 00:05:52,100
knew more about the network than they

137
00:05:52,100 --> 00:05:54,169
did their network diagrams hadn't been

138
00:05:54,169 --> 00:05:56,390
upgraded updated and in quite a while

139
00:05:56,390 --> 00:06:00,050
and suddenly found myself as a thought

140
00:06:00,050 --> 00:06:02,260
leader especially in the organization

141
00:06:02,260 --> 00:06:05,750
yeah when I started out as a security

142
00:06:05,750 --> 00:06:09,470
analyst many years ago now much less

143
00:06:09,470 --> 00:06:12,380
great hair I had a very narrow view of

144
00:06:12,380 --> 00:06:14,870
the world I mean my world was I I could

145
00:06:14,870 --> 00:06:17,300
respond to the alerts and the tools and

146
00:06:17,300 --> 00:06:19,340
and data that I had and my view of the

147
00:06:19,340 --> 00:06:20,960
world was really focused on the data

148
00:06:20,960 --> 00:06:22,460
that I had coming into my security

149
00:06:22,460 --> 00:06:25,280
solutions so I think to IANS point one

150
00:06:25,280 --> 00:06:26,930
of the residual benefits to threat

151
00:06:26,930 --> 00:06:28,850
hunting is you actually close your

152
00:06:28,850 --> 00:06:31,310
infrastructure knowledge gap so not only

153
00:06:31,310 --> 00:06:33,050
are you looking for threats on your

154
00:06:33,050 --> 00:06:35,030
network or looking for weaknesses or or

155
00:06:35,030 --> 00:06:36,560
other things on your network but you're

156
00:06:36,560 --> 00:06:37,880
actually discovering more about your

157
00:06:37,880 --> 00:06:38,400
network

158
00:06:38,400 --> 00:06:41,160
you ever knew before so it's closing an

159
00:06:41,160 --> 00:06:42,870
infrastructure knowledge gap learning

160
00:06:42,870 --> 00:06:44,669
about either new areas on your network

161
00:06:44,669 --> 00:06:46,710
could be additional assets on your

162
00:06:46,710 --> 00:06:48,000
network that you never knew were there

163
00:06:48,000 --> 00:06:49,500
applications running on your network

164
00:06:49,500 --> 00:06:51,030
that you didn't know we're there so

165
00:06:51,030 --> 00:06:52,229
these are things that aren't necessarily

166
00:06:52,229 --> 00:06:54,270
feeding into your existing security

167
00:06:54,270 --> 00:06:56,370
tools and is a really valuable part of

168
00:06:56,370 --> 00:06:58,590
threat hunting so not only the threat

169
00:06:58,590 --> 00:07:00,240
centric part of it but also the

170
00:07:00,240 --> 00:07:01,650
knowledge about what's in your

171
00:07:01,650 --> 00:07:05,400
infrastructure now if you're building

172
00:07:05,400 --> 00:07:07,259
the threat hunting program and you have

173
00:07:07,259 --> 00:07:08,820
the buy-in from management and you're

174
00:07:08,820 --> 00:07:12,360
exploring how to start this we'd highly

175
00:07:12,360 --> 00:07:17,160
recommend choosing a framework to to

176
00:07:17,160 --> 00:07:19,080
basically structure your threat hunting

177
00:07:19,080 --> 00:07:21,600
program around now a framework does a

178
00:07:21,600 --> 00:07:23,490
few can provide a few different things

179
00:07:23,490 --> 00:07:25,220
for you first it can give you the

180
00:07:25,220 --> 00:07:28,620
repeatable steps in threat hunting

181
00:07:28,620 --> 00:07:30,720
because as you're creating hypotheses

182
00:07:30,720 --> 00:07:32,580
and you're asking questions you'd like

183
00:07:32,580 --> 00:07:34,260
to create read appealable steps and

184
00:07:34,260 --> 00:07:35,940
you'd also be able to create a language

185
00:07:35,940 --> 00:07:38,490
that you can actually share in your team

186
00:07:38,490 --> 00:07:39,840
and if you're sharing information

187
00:07:39,840 --> 00:07:41,789
between organizations it's helpful to

188
00:07:41,789 --> 00:07:44,010
have a a common language and consistency

189
00:07:44,010 --> 00:07:50,030
now attackers have a large variety of

190
00:07:50,030 --> 00:07:52,289
methods they use to attack organizations

191
00:07:52,289 --> 00:07:55,620
and there's a variety of reasons why

192
00:07:55,620 --> 00:07:57,750
they may be attacking your organization

193
00:07:57,750 --> 00:08:00,180
and these steps that an attacker has to

194
00:08:00,180 --> 00:08:02,610
walk through to attack you although the

195
00:08:02,610 --> 00:08:05,280
tools may be different the elements and

196
00:08:05,280 --> 00:08:07,949
the steps they have to take to x-play or

197
00:08:07,949 --> 00:08:10,229
organization gain persistence and

198
00:08:10,229 --> 00:08:12,539
foothold within your organization either

199
00:08:12,539 --> 00:08:14,310
a command and control to take control of

200
00:08:14,310 --> 00:08:16,080
it and then a way to exfiltrate data

201
00:08:16,080 --> 00:08:17,849
these steps are very common between

202
00:08:17,849 --> 00:08:19,560
attackers the tools may be different but

203
00:08:19,560 --> 00:08:22,229
the steps are the same and these roughly

204
00:08:22,229 --> 00:08:24,210
map to what we call the cyber kill chain

205
00:08:24,210 --> 00:08:26,070
and there are a lot of different cyber

206
00:08:26,070 --> 00:08:27,750
kill chains available in the industry

207
00:08:27,750 --> 00:08:29,849
there was originally Lockheed cyber kill

208
00:08:29,849 --> 00:08:31,860
chain Gardner had their own cyber kill

209
00:08:31,860 --> 00:08:35,309
chain the latest one which we follow and

210
00:08:35,309 --> 00:08:36,690
a lot of the industry is now following

211
00:08:36,690 --> 00:08:39,270
is mitre cyber kill chain so if you're

212
00:08:39,270 --> 00:08:42,750
looking at following a framework for

213
00:08:42,750 --> 00:08:44,850
threat hunting I'd highly recommend

214
00:08:44,850 --> 00:08:46,920
checking out mitre cyber kill chain now

215
00:08:46,920 --> 00:08:49,740
a few the benefits of all cyber kill

216
00:08:49,740 --> 00:08:51,329
chains and I really like miters layout

217
00:08:51,329 --> 00:08:52,000
is they

218
00:08:52,000 --> 00:08:54,009
they've laid out the cyber kill chain

219
00:08:54,009 --> 00:08:55,779
and here are the elements that an

220
00:08:55,779 --> 00:08:57,310
attacker has to walk through or

221
00:08:57,310 --> 00:08:59,139
observations attacker has to walk

222
00:08:59,139 --> 00:09:01,660
through to basically compromise your

223
00:09:01,660 --> 00:09:03,879
organization on the right here it breaks

224
00:09:03,879 --> 00:09:05,589
down the high-level steps of you know

225
00:09:05,589 --> 00:09:07,209
they have to gain persistence they have

226
00:09:07,209 --> 00:09:08,980
to gain critical access discovery

227
00:09:08,980 --> 00:09:12,430
lateral movement and within each of

228
00:09:12,430 --> 00:09:15,220
these there's then a subset of different

229
00:09:15,220 --> 00:09:17,470
items saying if you're looking for an

230
00:09:17,470 --> 00:09:19,089
attacker trying to gain persistence in

231
00:09:19,089 --> 00:09:21,519
your network well here's a list of a few

232
00:09:21,519 --> 00:09:23,410
dozen things you should be looking at in

233
00:09:23,410 --> 00:09:25,540
that phase where an attacker has to

234
00:09:25,540 --> 00:09:29,379
execute now if you navigate to miters

235
00:09:29,379 --> 00:09:30,670
website and i've got the links at the

236
00:09:30,670 --> 00:09:31,810
bottom there they've actually got a

237
00:09:31,810 --> 00:09:34,629
really cool navigator in that you can

238
00:09:34,629 --> 00:09:36,959
choose different threat groups so apt

239
00:09:36,959 --> 00:09:39,399
whatever number or different pieces of

240
00:09:39,399 --> 00:09:41,259
malware and mitre has actually gone the

241
00:09:41,259 --> 00:09:44,199
extra step and highlighted the areas of

242
00:09:44,199 --> 00:09:45,970
the framework where if you're hunting

243
00:09:45,970 --> 00:09:48,100
for this threat group or this apt or

244
00:09:48,100 --> 00:09:50,170
this piece of malware here the different

245
00:09:50,170 --> 00:09:51,850
elements or objectives within the

246
00:09:51,850 --> 00:09:53,319
framework that you should be looking at

247
00:09:53,319 --> 00:09:56,199
and these aren't signature centric so

248
00:09:56,199 --> 00:09:58,689
it's not IPS and hashes it's more tools

249
00:09:58,689 --> 00:10:00,730
tactics procedures so they're going to

250
00:10:00,730 --> 00:10:02,800
try to gain persistence in this area of

251
00:10:02,800 --> 00:10:06,040
the network or in this endpoint and with

252
00:10:06,040 --> 00:10:07,779
you know in the endpoint maybe you

253
00:10:07,779 --> 00:10:09,939
should be looking in dot bash or the

254
00:10:09,939 --> 00:10:12,759
history or different areas have your

255
00:10:12,759 --> 00:10:14,980
network so highly recommend choosing a

256
00:10:14,980 --> 00:10:17,319
framework really helpful when forming

257
00:10:17,319 --> 00:10:19,809
hypotheses and questions about what i'm

258
00:10:19,809 --> 00:10:26,199
going to hunt for now before we get into

259
00:10:26,199 --> 00:10:29,319
the topic of what we should look for the

260
00:10:29,319 --> 00:10:31,209
question often comes up is how am I

261
00:10:31,209 --> 00:10:34,629
gonna measure success and it's very hard

262
00:10:34,629 --> 00:10:38,110
to quantify the value of security

263
00:10:38,110 --> 00:10:39,910
solutions so if someone comes to you and

264
00:10:39,910 --> 00:10:41,800
go we've invested in this tool how much

265
00:10:41,800 --> 00:10:43,269
value am I getting out of it it's very

266
00:10:43,269 --> 00:10:44,529
hard for us practitioners they usually

267
00:10:44,529 --> 00:10:46,389
assign a dollar amount or figures to

268
00:10:46,389 --> 00:10:47,949
that they kind of give it a thumbs up or

269
00:10:47,949 --> 00:10:50,949
a thumbs down so I I tried to lay out a

270
00:10:50,949 --> 00:10:54,279
few metrics to well justify your

271
00:10:54,279 --> 00:10:56,889
existence as a threat hunter and that

272
00:10:56,889 --> 00:10:58,240
you actually have some measurable

273
00:10:58,240 --> 00:11:01,240
outputs not solely based on finding bad

274
00:11:01,240 --> 00:11:04,079
stuff within your network

275
00:11:04,840 --> 00:11:06,580
when you begin threat hunting for the

276
00:11:06,580 --> 00:11:08,740
first time you're likely going to

277
00:11:08,740 --> 00:11:11,920
encounter one of two scenarios the first

278
00:11:11,920 --> 00:11:14,529
scenario is that you've never hunted

279
00:11:14,529 --> 00:11:16,450
before and you're gonna find all kinds

280
00:11:16,450 --> 00:11:19,170
of bad stuff and if you start uncovering

281
00:11:19,170 --> 00:11:21,010
incidents or bad stuff within your

282
00:11:21,010 --> 00:11:22,690
network the first sort of short term

283
00:11:22,690 --> 00:11:25,150
metrics as well document what types of

284
00:11:25,150 --> 00:11:27,760
incidents they are the severity of those

285
00:11:27,760 --> 00:11:29,020
incidents and the type of those

286
00:11:29,020 --> 00:11:31,360
incidents and add additional I think

287
00:11:31,360 --> 00:11:33,310
equally important metric not only in the

288
00:11:33,310 --> 00:11:34,930
number of bad things you find as dwell

289
00:11:34,930 --> 00:11:37,110
time so those incidents that you find

290
00:11:37,110 --> 00:11:39,880
how long have they been in my network

291
00:11:39,880 --> 00:11:42,010
undetected before I found them and

292
00:11:42,010 --> 00:11:43,690
that'll come in handy later because this

293
00:11:43,690 --> 00:11:44,950
is a metric you can start gauging

294
00:11:44,950 --> 00:11:48,370
yourself across now that's the first

295
00:11:48,370 --> 00:11:49,930
scenario is you're hunting and you're

296
00:11:49,930 --> 00:11:52,000
finding bad stuff the second scenario is

297
00:11:52,000 --> 00:11:53,440
that you're hunting and you're gonna go

298
00:11:53,440 --> 00:11:56,740
months without finding anything we're an

299
00:11:56,740 --> 00:12:00,100
organization of over a hundred thousand

300
00:12:00,100 --> 00:12:00,580
people

301
00:12:00,580 --> 00:12:03,400
we're in RSA and VMware and all these

302
00:12:03,400 --> 00:12:06,310
companies are now in by Dell and as part

303
00:12:06,310 --> 00:12:08,350
of our sock

304
00:12:08,350 --> 00:12:11,580
we have arguably some of the most mature

305
00:12:11,580 --> 00:12:13,990
hunters in the industry we have access

306
00:12:13,990 --> 00:12:17,500
to all the tools that you can buy we you

307
00:12:17,500 --> 00:12:18,880
know if I look at our stats from a

308
00:12:18,880 --> 00:12:20,860
couple years ago we're uncovering maybe

309
00:12:20,860 --> 00:12:25,000
ten incidents a year so that's a large

310
00:12:25,000 --> 00:12:26,950
gap between the time that it takes when

311
00:12:26,950 --> 00:12:28,660
we're hunting and finding stuff so we're

312
00:12:28,660 --> 00:12:30,760
not finding you know something every

313
00:12:30,760 --> 00:12:32,650
hunting session we're only finding you

314
00:12:32,650 --> 00:12:34,810
know a handful a year so how do I

315
00:12:34,810 --> 00:12:38,350
measure my output and success if my only

316
00:12:38,350 --> 00:12:40,300
metric if I'm I'm not basing my only

317
00:12:40,300 --> 00:12:43,060
metric on finding bad stuff so I would I

318
00:12:43,060 --> 00:12:46,570
think a realistic goal is every time you

319
00:12:46,570 --> 00:12:49,209
go into a hunting session you try to

320
00:12:49,209 --> 00:12:51,310
find one thing to improve your

321
00:12:51,310 --> 00:12:53,560
visibility and improving visibility can

322
00:12:53,560 --> 00:12:54,940
meet a lot of different things so it

323
00:12:54,940 --> 00:12:57,220
could be uncovering a vulnerability in

324
00:12:57,220 --> 00:13:00,250
one of your systems it could be finding

325
00:13:00,250 --> 00:13:02,080
insecure business practices so if you

326
00:13:02,080 --> 00:13:04,000
walk into an IC shop and say hey do you

327
00:13:04,000 --> 00:13:06,160
have any clear text FTP and they're like

328
00:13:06,160 --> 00:13:08,290
no against policy there's no clear text

329
00:13:08,290 --> 00:13:10,480
protocols in my network I assure you

330
00:13:10,480 --> 00:13:12,550
you're going to uncover stuff that's

331
00:13:12,550 --> 00:13:14,230
against policy and this is stuff that

332
00:13:14,230 --> 00:13:16,330
increases your attack surface and makes

333
00:13:16,330 --> 00:13:18,330
you more vulnerable to it

334
00:13:18,330 --> 00:13:20,100
there's going to be new assets that you

335
00:13:20,100 --> 00:13:23,459
discover so all this is useful

336
00:13:23,459 --> 00:13:24,839
information to start building your own

337
00:13:24,839 --> 00:13:25,950
threat intelligence about your

338
00:13:25,950 --> 00:13:27,990
organization so these are things that I

339
00:13:27,990 --> 00:13:30,149
think are achievable try to find one

340
00:13:30,149 --> 00:13:32,070
thing within your network that either

341
00:13:32,070 --> 00:13:34,620
it's a weakness it could be something

342
00:13:34,620 --> 00:13:36,360
you know that the users shouldn't be

343
00:13:36,360 --> 00:13:38,370
doing but they are doing that is risky

344
00:13:38,370 --> 00:13:40,589
to the organization it could be new

345
00:13:40,589 --> 00:13:42,029
areas of your network that are

346
00:13:42,029 --> 00:13:43,980
undiscovered new applications all this

347
00:13:43,980 --> 00:13:46,980
is useful for enhancing the visibility I

348
00:13:46,980 --> 00:13:48,600
think that's a realistic goal for every

349
00:13:48,600 --> 00:13:53,730
hunting session ok well well it's the

350
00:13:53,730 --> 00:13:55,620
the one thing I'll add to that is it's

351
00:13:55,620 --> 00:13:58,830
not necessarily just finding evil I was

352
00:13:58,830 --> 00:14:02,459
recently at a customer that very quickly

353
00:14:02,459 --> 00:14:03,959
we realized that their Active Directory

354
00:14:03,959 --> 00:14:06,510
servers were on the were public I peed

355
00:14:06,510 --> 00:14:09,959
protected by a very simple firewall that

356
00:14:09,959 --> 00:14:12,330
was blocking inbound but allowed

357
00:14:12,330 --> 00:14:15,770
everything outbound and you know when I

358
00:14:15,770 --> 00:14:18,000
notified to them their response was well

359
00:14:18,000 --> 00:14:21,630
our vendor set it up that way so it

360
00:14:21,630 --> 00:14:23,940
wasn't necessarily they were compromised

361
00:14:23,940 --> 00:14:29,370
but that was definitely a threat now for

362
00:14:29,370 --> 00:14:32,010
long-term metrics I think dwell time is

363
00:14:32,010 --> 00:14:34,440
a fantastic metric to start measuring

364
00:14:34,440 --> 00:14:37,260
success as you begin finding bad things

365
00:14:37,260 --> 00:14:39,570
within your network so that initial how

366
00:14:39,570 --> 00:14:42,560
long does it take for me to identify

367
00:14:42,560 --> 00:14:44,760
something that's been in my network and

368
00:14:44,760 --> 00:14:47,040
ideally that number should be getting

369
00:14:47,040 --> 00:14:48,930
shortened in time so you're getting

370
00:14:48,930 --> 00:14:51,180
better and quicker at detecting things

371
00:14:51,180 --> 00:14:53,190
that make it past your prevention

372
00:14:53,190 --> 00:14:55,980
detection systems the residual effect is

373
00:14:55,980 --> 00:14:58,040
hopefully that should start reducing the

374
00:14:58,040 --> 00:15:00,570
response and investigation time in your

375
00:15:00,570 --> 00:15:02,430
other tools whether it be your stim or

376
00:15:02,430 --> 00:15:04,620
other threat the techs and tools and

377
00:15:04,620 --> 00:15:07,170
security tool detection efficacy I think

378
00:15:07,170 --> 00:15:09,060
is one of the most important metrics to

379
00:15:09,060 --> 00:15:10,410
start tracking over time because this

380
00:15:10,410 --> 00:15:12,570
actually resonates with your management

381
00:15:12,570 --> 00:15:14,339
and your organization as a whole

382
00:15:14,339 --> 00:15:17,399
so as you're tracking incidents and

383
00:15:17,399 --> 00:15:20,520
finding bad things are you consistently

384
00:15:20,520 --> 00:15:23,790
finding incidents that should have been

385
00:15:23,790 --> 00:15:26,029
detected by your intrusion detection

386
00:15:26,029 --> 00:15:28,920
tools or your prevention tools so

387
00:15:28,920 --> 00:15:31,440
detection efficacy is our my tools that

388
00:15:31,440 --> 00:15:33,330
have in place performing as well as they

389
00:15:33,330 --> 00:15:35,970
should am i finding incidents that

390
00:15:35,970 --> 00:15:37,410
should have been stopped and caught at

391
00:15:37,410 --> 00:15:39,480
an earlier phase and then using that

392
00:15:39,480 --> 00:15:42,300
information to then tune your detection

393
00:15:42,300 --> 00:15:44,550
systems and prevention systems the other

394
00:15:44,550 --> 00:15:47,550
part of that is if you're consistently

395
00:15:47,550 --> 00:15:49,890
coming across incidents that you have no

396
00:15:49,890 --> 00:15:51,630
way of detecting neetha these things

397
00:15:51,630 --> 00:15:53,790
outside of threat hunting these are

398
00:15:53,790 --> 00:15:55,920
things that you can use to build a good

399
00:15:55,920 --> 00:15:58,380
business case to start to buy a tool to

400
00:15:58,380 --> 00:16:00,210
deploy to detect that type of thing

401
00:16:00,210 --> 00:16:01,950
because if you're finding the same thing

402
00:16:01,950 --> 00:16:04,100
over and over the same type of incident

403
00:16:04,100 --> 00:16:07,020
that should probably be automated out of

404
00:16:07,020 --> 00:16:08,490
your threat hunting activities and

405
00:16:08,490 --> 00:16:09,840
should you know you should have a tool

406
00:16:09,840 --> 00:16:11,610
in place to start detecting that so

407
00:16:11,610 --> 00:16:13,230
these are this is good information to

408
00:16:13,230 --> 00:16:14,670
start tracking and then you can help

409
00:16:14,670 --> 00:16:16,290
reporting up and - you know we're

410
00:16:16,290 --> 00:16:17,820
finding things that we don't have

411
00:16:17,820 --> 00:16:19,590
anything in place to detect it maybe we

412
00:16:19,590 --> 00:16:20,910
can build a business case around a tool

413
00:16:20,910 --> 00:16:24,420
and then finding documenting everything

414
00:16:24,420 --> 00:16:26,640
you find about your network and your

415
00:16:26,640 --> 00:16:29,070
infrastructure so what is normal on your

416
00:16:29,070 --> 00:16:31,950
network and then use your definition of

417
00:16:31,950 --> 00:16:34,770
normal to start tuning your detection

418
00:16:34,770 --> 00:16:36,030
and prevention systems and it really

419
00:16:36,030 --> 00:16:39,390
turns into a feedback loop and then a

420
00:16:39,390 --> 00:16:42,150
few benefits of the organization so if

421
00:16:42,150 --> 00:16:43,410
your organization is well why do I need

422
00:16:43,410 --> 00:16:44,850
a threat hunting program well we

423
00:16:44,850 --> 00:16:46,740
actually have the ability to now start

424
00:16:46,740 --> 00:16:48,270
detecting threats that make it past

425
00:16:48,270 --> 00:16:50,430
everything else I own and interesting

426
00:16:50,430 --> 00:16:51,900
stats are certainly if you start

427
00:16:51,900 --> 00:16:53,760
tracking dwell time and that dwell time

428
00:16:53,760 --> 00:16:54,810
is reducing over time that's an

429
00:16:54,810 --> 00:16:56,610
interesting set to provide up to

430
00:16:56,610 --> 00:16:59,160
management and you know tool detection

431
00:16:59,160 --> 00:17:01,680
efficacy can be really really useful as

432
00:17:01,680 --> 00:17:08,339
well yeah now before we start hunting we

433
00:17:08,339 --> 00:17:13,349
need data so data and visibility is very

434
00:17:13,349 --> 00:17:15,060
important to threat hunting is really

435
00:17:15,060 --> 00:17:16,619
the foundation of if I'm gonna look for

436
00:17:16,619 --> 00:17:18,410
stuff well I need a data set to look at

437
00:17:18,410 --> 00:17:22,319
if my soule data set is a little bit of

438
00:17:22,319 --> 00:17:24,060
net flow coming from an outbound router

439
00:17:24,060 --> 00:17:26,280
and maybe some log on log offs or my

440
00:17:26,280 --> 00:17:28,860
firewall you likely don't have the right

441
00:17:28,860 --> 00:17:31,530
data and visibility in place to start

442
00:17:31,530 --> 00:17:32,880
threat hunting so there's sort of a

443
00:17:32,880 --> 00:17:35,790
minimum level before you get into threat

444
00:17:35,790 --> 00:17:37,320
hunting now you don't have to be a super

445
00:17:37,320 --> 00:17:39,330
mature organization with a dedicated

446
00:17:39,330 --> 00:17:41,340
threat hunting team you just need really

447
00:17:41,340 --> 00:17:44,010
a way to collect one primary source of

448
00:17:44,010 --> 00:17:44,940
data before you could

449
00:17:44,940 --> 00:17:48,720
begin typically it's a sim so these are

450
00:17:48,720 --> 00:17:51,000
key areas of log events that you should

451
00:17:51,000 --> 00:17:53,010
be bringing into a central solution and

452
00:17:53,010 --> 00:17:55,290
that can be a primary source of data

453
00:17:55,290 --> 00:17:57,120
where you can begin your threat hunting

454
00:17:57,120 --> 00:17:58,380
if you're bringing in these sources of

455
00:17:58,380 --> 00:18:02,520
data secondary sources are if you're

456
00:18:02,520 --> 00:18:05,960
pulling in network capture as well and

457
00:18:05,960 --> 00:18:08,880
endpoint information so endpoint

458
00:18:08,880 --> 00:18:11,160
information could be from auto runs it

459
00:18:11,160 --> 00:18:13,740
could be what processes are running you

460
00:18:13,740 --> 00:18:15,690
know artifacts and inventory and this

461
00:18:15,690 --> 00:18:17,550
all maps back to the framework that we

462
00:18:17,550 --> 00:18:18,840
were talking about earlier if you're

463
00:18:18,840 --> 00:18:20,070
looking at that framework to form

464
00:18:20,070 --> 00:18:21,990
questions or hypotheses these are the

465
00:18:21,990 --> 00:18:24,660
types of data that you'd want to be want

466
00:18:24,660 --> 00:18:27,600
to be bringing in and a few years ago I

467
00:18:27,600 --> 00:18:31,320
would say this was in order of level of

468
00:18:31,320 --> 00:18:33,270
effort it used to be that logs were the

469
00:18:33,270 --> 00:18:35,160
easiest thing to centrally collect and

470
00:18:35,160 --> 00:18:37,020
the network and endpoint was kind of the

471
00:18:37,020 --> 00:18:38,010
hardest to collect this type of

472
00:18:38,010 --> 00:18:41,190
telemetry with the advent of things like

473
00:18:41,190 --> 00:18:42,780
EDR endpoint detection and response

474
00:18:42,780 --> 00:18:45,510
solutions it can be just as easy to

475
00:18:45,510 --> 00:18:47,130
start an endpoint and gather that data

476
00:18:47,130 --> 00:18:49,080
now and bring it in and same with

477
00:18:49,080 --> 00:18:51,270
network with nd our solution so at least

478
00:18:51,270 --> 00:18:53,580
get one primary source of data fine

479
00:18:53,580 --> 00:18:55,110
there's likely something and you're

480
00:18:55,110 --> 00:18:57,360
collecting your organization now so just

481
00:18:57,360 --> 00:18:58,830
tune that to start collecting the right

482
00:18:58,830 --> 00:19:01,590
amount of data and data sets and I would

483
00:19:01,590 --> 00:19:04,140
say right data is key because you don't

484
00:19:04,140 --> 00:19:06,990
want to just start dumping all data into

485
00:19:06,990 --> 00:19:08,730
this solution you want you know a set of

486
00:19:08,730 --> 00:19:11,880
high quality data and yeah it's going to

487
00:19:11,880 --> 00:19:15,210
be an incredible wait just wait for it

488
00:19:15,210 --> 00:19:20,520
let it sink in no I don't know if

489
00:19:20,520 --> 00:19:22,230
there's any Star Trek fans in the Big

490
00:19:22,230 --> 00:19:32,520
Data nice Paul so then the question is

491
00:19:32,520 --> 00:19:34,050
well where do we begin we've we've

492
00:19:34,050 --> 00:19:35,670
collected all these primary sources of

493
00:19:35,670 --> 00:19:40,320
data what next we have an idea of a

494
00:19:40,320 --> 00:19:45,390
framework that we want to use and the

495
00:19:45,390 --> 00:19:46,890
next part is is creating your

496
00:19:46,890 --> 00:19:49,920
situational awareness knowing the lay of

497
00:19:49,920 --> 00:19:53,940
the land how your network is set up it's

498
00:19:53,940 --> 00:19:56,580
configured types of common traffic you

499
00:19:56,580 --> 00:19:57,530
see over it

500
00:19:57,530 --> 00:19:58,740
really

501
00:19:58,740 --> 00:20:00,380
it's all about creating a baseline

502
00:20:00,380 --> 00:20:03,360
normalizing a traffic and I kid you not

503
00:20:03,360 --> 00:20:04,830
even for a small Network this is

504
00:20:04,830 --> 00:20:06,620
probably gonna be a three to six month

505
00:20:06,620 --> 00:20:09,870
effort of just constantly looking in

506
00:20:09,870 --> 00:20:13,710
your network but eventually you get to

507
00:20:13,710 --> 00:20:16,620
the point where you're able to see the

508
00:20:16,620 --> 00:20:18,150
anomalies they just stick out like a

509
00:20:18,150 --> 00:20:21,300
sore thumb so things like going to if

510
00:20:21,300 --> 00:20:24,000
you have an internal DevOps team going

511
00:20:24,000 --> 00:20:28,020
to them and asking say it's a HTTP web

512
00:20:28,020 --> 00:20:30,480
application asking them what are the

513
00:20:30,480 --> 00:20:34,020
methods and the URIs that are commonly

514
00:20:34,020 --> 00:20:35,640
used by that application or and start

515
00:20:35,640 --> 00:20:38,280
white listing things just just

516
00:20:38,280 --> 00:20:40,380
constantly going through all the

517
00:20:40,380 --> 00:20:41,970
applications all the services on your

518
00:20:41,970 --> 00:20:47,190
network other thing to note is don't

519
00:20:47,190 --> 00:20:48,840
necessarily start with an indicator of

520
00:20:48,840 --> 00:20:50,520
compromise we're looking for threats

521
00:20:50,520 --> 00:20:52,920
indicator of compromise while threat

522
00:20:52,920 --> 00:20:56,940
intelligence has its place I want to

523
00:20:56,940 --> 00:20:59,400
start more with the hypothesis for

524
00:20:59,400 --> 00:21:01,470
example if you were looking at data

525
00:21:01,470 --> 00:21:04,440
leaving your network what's the exit

526
00:21:04,440 --> 00:21:08,160
points and I've commonly gone to clients

527
00:21:08,160 --> 00:21:10,230
and and asked that question they said oh

528
00:21:10,230 --> 00:21:11,700
well it's only this gateway and then I

529
00:21:11,700 --> 00:21:13,500
find out there's a Rogers cable modem

530
00:21:13,500 --> 00:21:15,540
and some data center that a co-op

531
00:21:15,540 --> 00:21:18,870
student bridge the two networks / DHCP

532
00:21:18,870 --> 00:21:20,910
and all sorts of fun stuff happening and

533
00:21:20,910 --> 00:21:24,030
data is going out a network that nobody

534
00:21:24,030 --> 00:21:24,450
knew about

535
00:21:24,450 --> 00:21:29,610
so start start with a hypothesis also

536
00:21:29,610 --> 00:21:33,630
what's key is the the kiss theory you

537
00:21:33,630 --> 00:21:35,929
know keep it simple and don't

538
00:21:35,929 --> 00:21:39,720
necessarily start with a hypothesis of

539
00:21:39,720 --> 00:21:42,179
you know aliens attacking or any super

540
00:21:42,179 --> 00:21:49,440
elite malware just keep it simple okay

541
00:21:49,440 --> 00:21:50,910
if you've never seen the pyramid of pain

542
00:21:50,910 --> 00:21:52,590
this has been out for a few years now

543
00:21:52,590 --> 00:21:55,410
2013 it was released by David Bianco and

544
00:21:55,410 --> 00:21:58,350
I think this really illustrates well of

545
00:21:58,350 --> 00:22:01,260
why why you should not start with a

546
00:22:01,260 --> 00:22:05,370
typical IOC so if our goal as threat

547
00:22:05,370 --> 00:22:07,919
hunters is to be the most disruptive as

548
00:22:07,919 --> 00:22:09,840
possible to the attackers against our

549
00:22:09,840 --> 00:22:11,950
organization the peer

550
00:22:11,950 --> 00:22:14,980
of pain illustrates at the very bottom

551
00:22:14,980 --> 00:22:17,500
is the items that are the least

552
00:22:17,500 --> 00:22:20,380
disruptive so if I'm hunting for hashes

553
00:22:20,380 --> 00:22:22,990
or IP addresses as in domains that's not

554
00:22:22,990 --> 00:22:25,809
really all disruptive that disruptive to

555
00:22:25,809 --> 00:22:28,000
an attacker it's trivial to chart to

556
00:22:28,000 --> 00:22:30,519
change it hash hash or an IP or a domain

557
00:22:30,519 --> 00:22:33,519
in their attack to an organization so as

558
00:22:33,519 --> 00:22:35,710
threat hunters we want to focus really

559
00:22:35,710 --> 00:22:38,200
on the top three tiers of the pyramid of

560
00:22:38,200 --> 00:22:41,200
pain and this is difficult because now

561
00:22:41,200 --> 00:22:43,240
you have to start going after more the

562
00:22:43,240 --> 00:22:45,370
behaviors of the attacker and the tools

563
00:22:45,370 --> 00:22:47,409
tactics and procedures and again this is

564
00:22:47,409 --> 00:22:48,639
where the framework can come into play

565
00:22:48,639 --> 00:22:50,740
because it'll help you focus and ask

566
00:22:50,740 --> 00:22:53,679
your questions and hypothesis so while I

567
00:22:53,679 --> 00:22:56,260
OCS can be helpful and why while threat

568
00:22:56,260 --> 00:22:57,669
reports can be helpful and you know

569
00:22:57,669 --> 00:22:59,289
looking for things in your network try

570
00:22:59,289 --> 00:23:01,029
to stay away from the bottom of the

571
00:23:01,029 --> 00:23:03,159
pyramid of team because really it's not

572
00:23:03,159 --> 00:23:04,630
gonna do you any good because the

573
00:23:04,630 --> 00:23:06,279
attackers can adapt to that really

574
00:23:06,279 --> 00:23:08,320
quickly try to stay to the top of the

575
00:23:08,320 --> 00:23:09,760
pyramid of pain in your hunting

576
00:23:09,760 --> 00:23:16,000
activities so just show our hands who

577
00:23:16,000 --> 00:23:17,980
has done threat hunting just want to

578
00:23:17,980 --> 00:23:19,510
know how far in the weeds I should go

579
00:23:19,510 --> 00:23:24,029
here okay okay so I won't go too deep

580
00:23:24,029 --> 00:23:27,570
one one thing pet peeve of mine is

581
00:23:27,570 --> 00:23:30,130
organizations that don't typically do

582
00:23:30,130 --> 00:23:31,570
threat hunting on endpoints

583
00:23:31,570 --> 00:23:34,230
usually they rely on an IDs or an IPS

584
00:23:34,230 --> 00:23:37,840
which is great you know it will detect

585
00:23:37,840 --> 00:23:41,919
and block known indicators but it

586
00:23:41,919 --> 00:23:44,260
doesn't give you process tracking it

587
00:23:44,260 --> 00:23:47,139
just gives you a snapshot in time at

588
00:23:47,139 --> 00:23:50,230
best and you can't see really what

589
00:23:50,230 --> 00:23:54,309
processes are running other processes so

590
00:23:54,309 --> 00:23:56,080
when when you're doing threat hunting if

591
00:23:56,080 --> 00:23:57,820
you have this tool that is gathering

592
00:23:57,820 --> 00:24:00,549
this information and out-of-the-box

593
00:24:00,549 --> 00:24:02,679
windows doesn't enable this through are

594
00:24:02,679 --> 00:24:05,500
ways to enable it and it's it's now

595
00:24:05,500 --> 00:24:07,600
feeding into your primary sources of

596
00:24:07,600 --> 00:24:13,480
data things to look for are abnormal

597
00:24:13,480 --> 00:24:16,330
binary paths one that I see a lot is

598
00:24:16,330 --> 00:24:18,669
things like SVC host where the o is a

599
00:24:18,669 --> 00:24:22,840
zero or SVC host and a NT user profile

600
00:24:22,840 --> 00:24:24,580
directory

601
00:24:24,580 --> 00:24:26,169
and you're just looking at it and task

602
00:24:26,169 --> 00:24:27,879
manager' like okay well that that

603
00:24:27,879 --> 00:24:29,379
probably belongs

604
00:24:29,379 --> 00:24:31,119
you know you google SVC host it's just

605
00:24:31,119 --> 00:24:33,209
microsoft okay it's probably fine but

606
00:24:33,209 --> 00:24:36,129
but just just not trusting things still

607
00:24:36,129 --> 00:24:38,979
going that further step grabbing a hash

608
00:24:38,979 --> 00:24:42,489
of the executable you know if you're

609
00:24:42,489 --> 00:24:44,019
starting out you know throwing it up to

610
00:24:44,019 --> 00:24:45,609
virustotal is probably fine you want to

611
00:24:45,609 --> 00:24:48,849
be careful with that of course but just

612
00:24:48,849 --> 00:24:51,459
just go that further mile and just

613
00:24:51,459 --> 00:24:53,559
validate everything you see and and

614
00:24:53,559 --> 00:24:55,629
again it is quite a process three to six

615
00:24:55,629 --> 00:24:58,539
months to get started start finding

616
00:24:58,539 --> 00:25:01,029
abnormal things on your network but it's

617
00:25:01,029 --> 00:25:04,059
it it's worthy effort in the in the long

618
00:25:04,059 --> 00:25:08,320
run another one that I've seen is Adobe

619
00:25:08,320 --> 00:25:11,529
Photoshop probably a lot of some of you

620
00:25:11,529 --> 00:25:13,089
have used Adobe Photoshop they have that

621
00:25:13,089 --> 00:25:17,079
great license licensing system on the

622
00:25:17,079 --> 00:25:20,229
back end there's when Photoshop starts

623
00:25:20,229 --> 00:25:23,909
it fire is another executable or a dll

624
00:25:23,909 --> 00:25:27,219
that can do all sorts of extra stuff if

625
00:25:27,219 --> 00:25:30,179
you are - were to infect it with malware

626
00:25:30,179 --> 00:25:32,679
so persistence

627
00:25:32,679 --> 00:25:34,570
it's another means of persistence for an

628
00:25:34,570 --> 00:25:37,690
attacker so every time Photoshop starts

629
00:25:37,690 --> 00:25:39,729
up you know if you were to replace that

630
00:25:39,729 --> 00:25:43,419
license manager executable with say CMD

631
00:25:43,419 --> 00:25:46,269
dot exe get now potentially for kachelle

632
00:25:46,269 --> 00:25:47,919
every time someone knows Photoshop and

633
00:25:47,919 --> 00:25:49,479
if it's a critical application to your

634
00:25:49,479 --> 00:25:51,879
organization every time some employee

635
00:25:51,879 --> 00:25:54,099
comes in sits down at a computer even

636
00:25:54,099 --> 00:25:56,409
loads up out luck you can do persistence

637
00:25:56,409 --> 00:25:59,799
with outlook that's potentially a means

638
00:25:59,799 --> 00:26:02,190
for persistence for an attacker so

639
00:26:02,190 --> 00:26:05,619
another one is inner Explorer has some

640
00:26:05,619 --> 00:26:07,059
other browsers how browser helper

641
00:26:07,059 --> 00:26:10,029
objects like the Bing toolbar those are

642
00:26:10,029 --> 00:26:11,889
ways for you know you walk around your

643
00:26:11,889 --> 00:26:14,049
organization most people are running a

644
00:26:14,049 --> 00:26:18,099
web browser so persistence of course you

645
00:26:18,099 --> 00:26:19,659
have some standard ones like scheduled

646
00:26:19,659 --> 00:26:23,649
tasks won't get too much into this is a

647
00:26:23,649 --> 00:26:25,839
good start Windows log events to look

648
00:26:25,839 --> 00:26:28,599
for you're looking in your sim most

649
00:26:28,599 --> 00:26:30,909
numbers I can't

650
00:26:30,909 --> 00:26:33,039
recommended enough The Sands digital

651
00:26:33,039 --> 00:26:34,779
forensics and incident response posters

652
00:26:34,779 --> 00:26:37,629
I always pay the 25 bucks while worth it

653
00:26:37,629 --> 00:26:42,099
put it up in my my cubicle they just

654
00:26:42,099 --> 00:26:43,779
have a wealth of information it's kind

655
00:26:43,779 --> 00:26:45,789
of like a run book or like a cheat sheet

656
00:26:45,789 --> 00:26:49,119
for for doing forensics analysis on an

657
00:26:49,119 --> 00:26:50,349
endpoint yeah if you're looking at

658
00:26:50,349 --> 00:26:52,570
starting endpoints forensics analysis

659
00:26:52,570 --> 00:26:53,889
and threat hunting download the

660
00:26:53,889 --> 00:26:55,570
framework from mitre and go to that link

661
00:26:55,570 --> 00:26:57,639
and download this poster from sans

662
00:26:57,639 --> 00:26:59,499
because it provides just some run books

663
00:26:59,499 --> 00:27:01,179
and very common areas to look for things

664
00:27:01,179 --> 00:27:03,399
on your endpoints so go grab it it's

665
00:27:03,399 --> 00:27:08,379
free so the next movie on especially

666
00:27:08,379 --> 00:27:12,460
with with hunting on your network having

667
00:27:12,460 --> 00:27:15,669
a tool of course this is our an RC

668
00:27:15,669 --> 00:27:17,769
product we use but having a tool that

669
00:27:17,769 --> 00:27:21,519
will cost to find data and why that's

670
00:27:21,519 --> 00:27:23,049
important is because if the date has

671
00:27:23,049 --> 00:27:24,849
been classified it's a protocol that is

672
00:27:24,849 --> 00:27:27,999
known to Internet you can quickly just

673
00:27:27,999 --> 00:27:29,919
filter that out and say ok show me the

674
00:27:29,919 --> 00:27:32,349
other bucket show me any traffic that is

675
00:27:32,349 --> 00:27:36,599
not known it's a quick way to look for

676
00:27:36,599 --> 00:27:39,039
encrypted like covert channels of

677
00:27:39,039 --> 00:27:42,340
communication especially even if you're

678
00:27:42,340 --> 00:27:44,379
hunting in the other bucket there's

679
00:27:44,379 --> 00:27:46,749
other more advanced things like entropy

680
00:27:46,749 --> 00:27:51,070
that you can do and then of course you

681
00:27:51,070 --> 00:27:53,019
know getting into of course the standard

682
00:27:53,019 --> 00:27:57,220
tor traffic IRC traffic that's you know

683
00:27:57,220 --> 00:27:58,779
especially dealing with CloudFlare

684
00:27:58,779 --> 00:28:01,960
they're now using HSTs with HTTP 2

685
00:28:01,960 --> 00:28:05,169
encrypted that's another one to look for

686
00:28:05,169 --> 00:28:07,210
is if you're you're starting out threat

687
00:28:07,210 --> 00:28:09,029
hunting low-hanging fruits are

688
00:28:09,029 --> 00:28:12,009
CloudFlare and let's encrypt SSL

689
00:28:12,009 --> 00:28:15,340
Certificates pay very close attention to

690
00:28:15,340 --> 00:28:18,820
those and then of course traffic over a

691
00:28:18,820 --> 00:28:22,479
non-standard ports like other than

692
00:28:22,479 --> 00:28:25,299
internal traffic you probably don't want

693
00:28:25,299 --> 00:28:27,820
to see HTTP traffic going outbound to

694
00:28:27,820 --> 00:28:32,799
like a proxy port 3 1 to 8 or or 8080 of

695
00:28:32,799 --> 00:28:34,960
course I'm just spouting off a lot of

696
00:28:34,960 --> 00:28:36,789
terms one thing that I will know with

697
00:28:36,789 --> 00:28:40,450
threat hunting is it's about 90%

698
00:28:40,450 --> 00:28:43,580
research and about 10% actually hunting

699
00:28:43,580 --> 00:28:45,590
you're just constantly finding stuff and

700
00:28:45,590 --> 00:28:46,610
then you'll spend the rest of your day

701
00:28:46,610 --> 00:28:49,190
just pulling up the RFC for that

702
00:28:49,190 --> 00:28:52,639
protocol or or just you know trying to

703
00:28:52,639 --> 00:28:55,309
figure out how it works is SSH a valid

704
00:28:55,309 --> 00:28:57,860
protocol to use for corporate use oh yes

705
00:28:57,860 --> 00:29:01,249
no you know and I had this debate

706
00:29:01,249 --> 00:29:04,549
yesterday you know nice firm or Ian

707
00:29:04,549 --> 00:29:06,919
firmly believes that's the sage to the

708
00:29:06,919 --> 00:29:10,039
band there's no corporate use for SSH

709
00:29:10,039 --> 00:29:11,629
within a network yeah

710
00:29:11,629 --> 00:29:15,350
change his mind sometimes when I go to a

711
00:29:15,350 --> 00:29:17,299
customer and I need a quick win so I

712
00:29:17,299 --> 00:29:21,259
just go port 22 and I almost always see

713
00:29:21,259 --> 00:29:24,289
SSH out the corporate network to Roger

714
00:29:24,289 --> 00:29:27,679
Rogers cable modem it's like mmm that's

715
00:29:27,679 --> 00:29:30,379
what's going on there and it almost

716
00:29:30,379 --> 00:29:32,989
always is some IT administrators saying

717
00:29:32,989 --> 00:29:35,989
well I want to you know tunnel home and

718
00:29:35,989 --> 00:29:37,700
I want to be able to work from home and

719
00:29:37,700 --> 00:29:40,009
you know the VPN it's just it's too

720
00:29:40,009 --> 00:29:43,190
difficult to get on right because it's

721
00:29:43,190 --> 00:29:46,039
almost always you know some Rogers

722
00:29:46,039 --> 00:29:49,100
cogeco whatever cable modem so as to say

723
00:29:49,100 --> 00:29:50,989
should just be white you know it's like

724
00:29:50,989 --> 00:29:54,169
there's no need for it there's no need

725
00:29:54,169 --> 00:29:55,489
for the protocol you can't do something

726
00:29:55,489 --> 00:30:05,230
else with with a more secure and so this

727
00:30:05,230 --> 00:30:08,570
graphic on the screen there that kind of

728
00:30:08,570 --> 00:30:10,249
depicts your life as a threat hunter

729
00:30:10,249 --> 00:30:13,789
it's a lot of staring at screens you

730
00:30:13,789 --> 00:30:16,299
know two hours later stretching and then

731
00:30:16,299 --> 00:30:20,149
eventually the I think that's Jackie

732
00:30:20,149 --> 00:30:22,369
Chan I'm not sure on the screen but the

733
00:30:22,369 --> 00:30:24,710
rage monster hits and then finally you

734
00:30:24,710 --> 00:30:25,909
figure it out and you're like Freddie

735
00:30:25,909 --> 00:30:34,220
Mercury but my point is have a plan have

736
00:30:34,220 --> 00:30:37,039
a hypothesis but be ready to adapt and

737
00:30:37,039 --> 00:30:38,989
you're going to change that hypothesis

738
00:30:38,989 --> 00:30:45,289
constantly it's it's important to to

739
00:30:45,289 --> 00:30:48,159
know what you're you're looking for but

740
00:30:48,159 --> 00:30:52,119
have a back-up plan have a plan B of

741
00:30:52,119 --> 00:30:54,830
something else and just slowly over the

742
00:30:54,830 --> 00:30:56,340
time just just

743
00:30:56,340 --> 00:30:58,500
picking different indicators and

744
00:30:58,500 --> 00:30:59,610
different things that are interesting

745
00:30:59,610 --> 00:31:01,440
and just just start collecting

746
00:31:01,440 --> 00:31:07,740
information and document remain be be

747
00:31:07,740 --> 00:31:09,570
flexible with your hypothesis is what

748
00:31:09,570 --> 00:31:16,410
I'm saying the the golden rule here is

749
00:31:16,410 --> 00:31:19,290
is try harder if you don't find it you

750
00:31:19,290 --> 00:31:21,560
know try harder

751
00:31:21,560 --> 00:31:24,030
anything you want to add to that no I'll

752
00:31:24,030 --> 00:31:25,440
go back to saying that the number of

753
00:31:25,440 --> 00:31:27,600
wheat incidents we find every year and

754
00:31:27,600 --> 00:31:30,180
there's a lot of time spent hunting and

755
00:31:30,180 --> 00:31:33,750
not finding real incident so don't get

756
00:31:33,750 --> 00:31:39,740
frustrated yes

757
00:31:52,070 --> 00:32:02,270
uh well I I personally cuz I did 12

758
00:32:02,270 --> 00:32:05,380
years in forensics I used the forensics

759
00:32:05,380 --> 00:32:09,050
note-taking method I just timestamp

760
00:32:09,050 --> 00:32:12,590
everything right that's how I learned

761
00:32:12,590 --> 00:32:15,080
I literally document everything there's

762
00:32:15,080 --> 00:32:18,830
there's tons of tools I use Kali Linux

763
00:32:18,830 --> 00:32:21,050
and there's some great know keeping

764
00:32:21,050 --> 00:32:25,880
tools in Kali that allows you to search

765
00:32:25,880 --> 00:32:27,590
it very easily I've seen some guys use

766
00:32:27,590 --> 00:32:31,880
markdown as their their language to be

767
00:32:31,880 --> 00:32:37,510
able to no take but I have so many times

768
00:32:37,510 --> 00:32:39,740
gone into the boat where I've seen

769
00:32:39,740 --> 00:32:43,100
something not written it down and then

770
00:32:43,100 --> 00:32:45,170
three hours later realize that's the

771
00:32:45,170 --> 00:32:48,350
answer and not been able to go back and

772
00:32:48,350 --> 00:32:54,200
find it so I know not to the to the

773
00:32:54,200 --> 00:32:56,690
level of you know tracking every mouse

774
00:32:56,690 --> 00:32:58,490
click but just you know everything you

775
00:32:58,490 --> 00:33:03,680
see just there's forget the name that

776
00:33:03,680 --> 00:33:05,470
ass Snagit I think it's the tool I use

777
00:33:05,470 --> 00:33:08,330
and if I see something on the screen I

778
00:33:08,330 --> 00:33:09,980
want to come back to it I'll just hit

779
00:33:09,980 --> 00:33:12,430
print screen it just stores a picture

780
00:33:12,430 --> 00:33:15,620
Kali you can just do a screen recording

781
00:33:15,620 --> 00:33:18,230
and you can just rewind the tape and say

782
00:33:18,230 --> 00:33:19,970
oh oh there's the answer that's what I

783
00:33:19,970 --> 00:33:22,670
saw documentation is one of the most

784
00:33:22,670 --> 00:33:24,860
important things note-taking

785
00:33:24,860 --> 00:33:27,350
I'm a big believer in just path of least

786
00:33:27,350 --> 00:33:29,120
resistance if you have something in

787
00:33:29,120 --> 00:33:30,500
place right now within your team that

788
00:33:30,500 --> 00:33:32,960
you're sharing start with that whether

789
00:33:32,960 --> 00:33:35,810
it's you know an internal wiki but as

790
00:33:35,810 --> 00:33:38,510
Ian said you know document your

791
00:33:38,510 --> 00:33:40,250
hypothesis about the question you're

792
00:33:40,250 --> 00:33:42,440
asking document the paths you've gone

793
00:33:42,440 --> 00:33:44,360
down you know I explored this protocol

794
00:33:44,360 --> 00:33:46,310
these are a type es and additional

795
00:33:46,310 --> 00:33:48,440
details interesting stuff screenshots

796
00:33:48,440 --> 00:33:50,510
just capture as much as you can and

797
00:33:50,510 --> 00:33:52,220
share it I mean there there's certainly

798
00:33:52,220 --> 00:33:54,860
the the proper way of recording things

799
00:33:54,860 --> 00:33:57,730
forensic ly that that Ian can share I'm

800
00:33:57,730 --> 00:33:59,750
of the opinion that if you're just

801
00:33:59,750 --> 00:34:01,490
starting out just document everything

802
00:34:01,490 --> 00:34:02,509
you can and what

803
00:34:02,509 --> 00:34:03,889
and what you have and then you can work

804
00:34:03,889 --> 00:34:08,259
towards you know the a better system

805
00:34:21,480 --> 00:34:25,918
oh that's I still think it's a manual

806
00:34:25,918 --> 00:34:28,739
process I don't trust the artificial

807
00:34:28,739 --> 00:34:33,179
stuff yet but it might be able to cut

808
00:34:33,179 --> 00:34:34,859
some of the noise oh but you don't know

809
00:34:34,859 --> 00:34:37,918
what else it's doing potentially what

810
00:34:37,918 --> 00:34:41,129
you may be missing so I kind of put that

811
00:34:41,129 --> 00:34:42,839
in the same boat as starting with an

812
00:34:42,839 --> 00:34:44,699
indicator of compromise like you don't

813
00:34:44,699 --> 00:34:47,399
know the full facts of that indicator

814
00:34:47,399 --> 00:34:54,449
how it was established yeah I I prefer

815
00:34:54,449 --> 00:34:56,339
to set up whitelist for applications I

816
00:34:56,339 --> 00:34:58,410
know and I just slowly just keep

817
00:34:58,410 --> 00:35:00,180
whittling down that unknown bucket the

818
00:35:00,180 --> 00:35:02,700
percentage of it just keep digging into

819
00:35:02,700 --> 00:35:05,460
it classifying data it's probably a good

820
00:35:05,460 --> 00:35:08,339
segue into the methodology well yeah how

821
00:35:08,339 --> 00:35:10,349
we approach thank you for the question

822
00:35:10,349 --> 00:35:16,109
yes and overbake of money no the

823
00:35:16,109 --> 00:35:19,140
labyrinth this is not to be confused

824
00:35:19,140 --> 00:35:23,849
with David Bowie but this is something

825
00:35:23,849 --> 00:35:26,819
we created at RSA and the threat hunting

826
00:35:26,819 --> 00:35:29,910
team and it was we found very quickly

827
00:35:29,910 --> 00:35:32,190
that it was this rubber-stamp method

828
00:35:32,190 --> 00:35:35,510
that we kept doing over and over and

829
00:35:35,510 --> 00:35:38,640
this is called the labyrinth so starts

830
00:35:38,640 --> 00:35:40,470
with directionality you're looking

831
00:35:40,470 --> 00:35:42,710
inbound or are you looking outbound and

832
00:35:42,710 --> 00:35:45,869
from there you pivot to a service so it

833
00:35:45,869 --> 00:35:52,530
shows HTTP SSL DN asks SSH RDP whatever

834
00:35:52,530 --> 00:35:59,940
which I actually put SSH is bad and the

835
00:35:59,940 --> 00:36:02,579
same goes for the opposite direction you

836
00:36:02,579 --> 00:36:06,150
have service outbound FTP I don't know

837
00:36:06,150 --> 00:36:07,650
why you would have FTP Oh to your

838
00:36:07,650 --> 00:36:09,720
network it is a clear text protocol who

839
00:36:09,720 --> 00:36:11,190
knows who was listening out there

840
00:36:11,190 --> 00:36:15,030
ICMP tunneling probably bad DNS I don't

841
00:36:15,030 --> 00:36:17,099
know why you would allow DNS outside

842
00:36:17,099 --> 00:36:18,900
your network other than from your DNS

843
00:36:18,900 --> 00:36:23,130
servers some common-sense things and

844
00:36:23,130 --> 00:36:25,349
then of course under the service you

845
00:36:25,349 --> 00:36:28,230
have like HTTP start looking for strange

846
00:36:28,230 --> 00:36:31,020
methods or strange sequences of methods

847
00:36:31,020 --> 00:36:33,300
which all dig into in a second

848
00:36:33,300 --> 00:36:35,260
yeah I think if you're looking for the

849
00:36:35,260 --> 00:36:39,190
one one area to start HTTP is probably

850
00:36:39,190 --> 00:36:41,470
socket that's going to provide the most

851
00:36:41,470 --> 00:36:44,170
value of course you're all in

852
00:36:44,170 --> 00:36:46,240
organizations that claim to have only

853
00:36:46,240 --> 00:36:49,150
HTTPS and there's no HTTP on the network

854
00:36:49,150 --> 00:36:50,680
you're gonna you're gonna find your

855
00:36:50,680 --> 00:36:53,800
initial wins in HTTP yeah yeah this this

856
00:36:53,800 --> 00:36:56,850
is - sorry

857
00:37:02,900 --> 00:37:13,390
I use it all the time on my pen testing

858
00:37:13,390 --> 00:37:15,970
yeah that's great

859
00:37:15,970 --> 00:37:20,599
I I'm a I'm an okay programmer I know

860
00:37:20,599 --> 00:37:24,490
Python really well PHP and dotnet and

861
00:37:24,490 --> 00:37:29,869
assembly is kind of 50% but it's really

862
00:37:29,869 --> 00:37:32,500
easy to use the API in the last year

863
00:37:32,500 --> 00:37:36,430
you're exploiting it's already there so

864
00:37:36,430 --> 00:37:39,799
path of lost this resistance and I can't

865
00:37:39,799 --> 00:37:41,450
afford the level of quality assurance

866
00:37:41,450 --> 00:37:43,970
Microsoft just put into you know my code

867
00:37:43,970 --> 00:37:47,809
like as a malware author I I don't want

868
00:37:47,809 --> 00:37:49,579
bugs in my code right so I'll just use

869
00:37:49,579 --> 00:37:50,390
what's already there

870
00:37:50,390 --> 00:37:53,630
usually it's quick to just fire up HTTP

871
00:37:53,630 --> 00:37:56,839
or I've seen FTP encryption I've seen

872
00:37:56,839 --> 00:37:58,329
things like rot13

873
00:37:58,329 --> 00:38:01,339
X or you know just really really simple

874
00:38:01,339 --> 00:38:04,609
that's again that's the kiss Theory I

875
00:38:04,609 --> 00:38:06,289
started out thinking oh well it's you

876
00:38:06,289 --> 00:38:07,609
know they're gonna use military-grade

877
00:38:07,609 --> 00:38:10,970
encryption from China and you know all

878
00:38:10,970 --> 00:38:13,190
this weird and wacky stuff but what I

879
00:38:13,190 --> 00:38:15,829
found predominantly is not that I

880
00:38:15,829 --> 00:38:17,450
haven't seen it because I've seen some

881
00:38:17,450 --> 00:38:22,279
weird stuff but really really simple

882
00:38:22,279 --> 00:38:25,700
the last years that can break basically

883
00:38:25,700 --> 00:38:27,799
I think I'd agree that over the past

884
00:38:27,799 --> 00:38:31,309
five years we've seen c2 encryption or

885
00:38:31,309 --> 00:38:33,920
to moving to encrypted communications

886
00:38:33,920 --> 00:38:36,410
for sure that doesn't mean they haven't

887
00:38:36,410 --> 00:38:40,339
left tracks in other areas of HTTP

888
00:38:40,339 --> 00:38:42,170
yeah or there's a lot of other context

889
00:38:42,170 --> 00:38:44,480
around this that yeah I can't read the

890
00:38:44,480 --> 00:38:46,460
encrypted payload but there's a lot

891
00:38:46,460 --> 00:38:47,660
happening around those sessions

892
00:38:47,660 --> 00:38:50,770
especially if you have logs or network

893
00:38:50,770 --> 00:38:53,809
packet capture or endpoint data from

894
00:38:53,809 --> 00:38:56,210
earlier before the c2 started when

895
00:38:56,210 --> 00:38:57,680
they're originally trying to gain

896
00:38:57,680 --> 00:38:59,630
persistence within your network so if

897
00:38:59,630 --> 00:39:00,829
you're following the framework in the

898
00:39:00,829 --> 00:39:02,809
cyber kill chain yeah you're right maybe

899
00:39:02,809 --> 00:39:04,339
that far down the kill chain you can't

900
00:39:04,339 --> 00:39:05,720
read the payload but there's probably

901
00:39:05,720 --> 00:39:07,819
artifacts from earlier before they put

902
00:39:07,819 --> 00:39:10,210
it in that will likely be helpful

903
00:39:10,210 --> 00:39:12,559
there's there's a few projects that are

904
00:39:12,559 --> 00:39:14,960
digging into entropy with SSL TLS

905
00:39:14,960 --> 00:39:15,920
fingerprinting

906
00:39:15,920 --> 00:39:20,390
oh really cool oh yeah so if you has any

907
00:39:20,390 --> 00:39:23,089
one explored ja3 from Salesforce so

908
00:39:23,089 --> 00:39:25,010
they're actually building detection

909
00:39:25,010 --> 00:39:27,950
signatures for detecting things within

910
00:39:27,950 --> 00:39:30,950
encrypted sort of SSL communication so

911
00:39:30,950 --> 00:39:33,829
if you look up j3 signatures it's trying

912
00:39:33,829 --> 00:39:36,140
to provide intelligence and detection

913
00:39:36,140 --> 00:39:38,569
mechanisms in these sort of encrypted

914
00:39:38,569 --> 00:39:41,390
communications stuff that we do because

915
00:39:41,390 --> 00:39:43,339
we have some access to some cool tools

916
00:39:43,339 --> 00:39:45,559
as we can we start looking at entropy as

917
00:39:45,559 --> 00:39:47,539
well so do you and you probably have a

918
00:39:47,539 --> 00:39:49,339
better definition of entropy than I do

919
00:39:49,339 --> 00:39:52,069
well well yeah the the principle is if

920
00:39:52,069 --> 00:39:54,440
they've taken programs like cobalt

921
00:39:54,440 --> 00:39:56,720
strike or rapid oven or Metasploit or

922
00:39:56,720 --> 00:39:58,670
whatever and they said okay well you

923
00:39:58,670 --> 00:40:00,619
know it's the same in the backend it's

924
00:40:00,619 --> 00:40:03,109
using Ruby and whatever to stop a

925
00:40:03,109 --> 00:40:04,730
certain communication but the

926
00:40:04,730 --> 00:40:07,039
fingerprint of that is always going to

927
00:40:07,039 --> 00:40:08,839
be because it's the same program every

928
00:40:08,839 --> 00:40:11,029
time Ram so just fingerprinting that not

929
00:40:11,029 --> 00:40:12,470
any not to a database and then doing

930
00:40:12,470 --> 00:40:14,480
some fuzzy logic to see if things match

931
00:40:14,480 --> 00:40:17,359
and it's like you know a hundred percent

932
00:40:17,359 --> 00:40:19,849
certainty but it's you know if you see

933
00:40:19,849 --> 00:40:21,829
the same thing over and over scripting

934
00:40:21,829 --> 00:40:23,390
hitting your network you can fingerprint

935
00:40:23,390 --> 00:40:25,190
it and say all with relative like fifty

936
00:40:25,190 --> 00:40:26,839
percent certainty that's probably the

937
00:40:26,839 --> 00:40:29,480
meterpreter payload right so it's pretty

938
00:40:29,480 --> 00:40:31,779
cool

939
00:40:41,720 --> 00:40:44,720
yeah

940
00:40:48,450 --> 00:40:53,369
this yeah that's a talk on its own

941
00:40:53,369 --> 00:40:56,819
don't use virustotal I don't know if

942
00:40:56,819 --> 00:40:58,650
anybody hears from virustotal don't use

943
00:40:58,650 --> 00:41:00,869
virustotal don't use any free online

944
00:41:00,869 --> 00:41:05,279
scanning platform I've seen people that

945
00:41:05,279 --> 00:41:06,809
have leaked their own company's

946
00:41:06,809 --> 00:41:08,430
intellectual property thinking it was

947
00:41:08,430 --> 00:41:10,769
malicious and uploaded a virus total and

948
00:41:10,769 --> 00:41:13,890
now their IP is out there that's fun

949
00:41:13,890 --> 00:41:17,549
don't use free tools isolate your

950
00:41:17,549 --> 00:41:20,160
network so if I use a VM if you're

951
00:41:20,160 --> 00:41:24,089
analyzing Windows malware use Linux

952
00:41:24,089 --> 00:41:26,359
because you can't really infect yourself

953
00:41:26,359 --> 00:41:28,920
if you want to use oli debug you can

954
00:41:28,920 --> 00:41:31,349
still use a emulator in Linux

955
00:41:31,349 --> 00:41:36,150
like whine to run oli debug also in the

956
00:41:36,150 --> 00:41:38,729
VM there's tools like I netsim that you

957
00:41:38,729 --> 00:41:41,729
can use to virtualize networks so if you

958
00:41:41,729 --> 00:41:44,249
want to you know fire up on executable

959
00:41:44,249 --> 00:41:46,469
or a binary or something your CEO or you

960
00:41:46,469 --> 00:41:48,869
know want to test some website how it's

961
00:41:48,869 --> 00:41:51,719
working you can just simulate google.com

962
00:41:51,719 --> 00:41:55,739
and you can fire things through it my VM

963
00:41:55,739 --> 00:41:58,430
that I used for for all my testing is

964
00:41:58,430 --> 00:42:00,479
always networking off

965
00:42:00,479 --> 00:42:04,829
it's just isolated completely so that's

966
00:42:04,829 --> 00:42:09,089
I have okay great

967
00:42:09,089 --> 00:42:11,219
Ian and I participated in a capture the

968
00:42:11,219 --> 00:42:13,799
flag a few years ago I was on defense

969
00:42:13,799 --> 00:42:16,349
and ian was on offense if you want to

970
00:42:16,349 --> 00:42:17,819
tell the story when we started the

971
00:42:17,819 --> 00:42:20,309
capture the flag of course I immediately

972
00:42:20,309 --> 00:42:22,859
dove into the data I wanted to see what

973
00:42:22,859 --> 00:42:24,660
Ian and his team were doing and I wanted

974
00:42:24,660 --> 00:42:28,049
to stop it Ian targeted my tool and I

975
00:42:28,049 --> 00:42:29,910
hadn't changed the root passwords of my

976
00:42:29,910 --> 00:42:31,589
defence tools I was using and he locked

977
00:42:31,589 --> 00:42:32,759
me out forever

978
00:42:32,759 --> 00:42:36,180
all of my tools and my only recourse was

979
00:42:36,180 --> 00:42:38,190
to DDoS the router he was attaching to

980
00:42:38,190 --> 00:42:39,690
so he couldn't perform any more

981
00:42:39,690 --> 00:42:45,869
activities anyways so services what to

982
00:42:45,869 --> 00:42:48,269
look for as he was saying focus on one

983
00:42:48,269 --> 00:42:52,319
service thanks Paul focus on one service

984
00:42:52,319 --> 00:42:55,979
at a time and define the normal traffic

985
00:42:55,979 --> 00:42:58,709
for that service on your network if that

986
00:42:58,709 --> 00:43:01,150
service is not on your network

987
00:43:01,150 --> 00:43:03,400
why is it there you know they should

988
00:43:03,400 --> 00:43:07,870
never see it right but you were asking

989
00:43:07,870 --> 00:43:11,140
about HTTP here are some things with

990
00:43:11,140 --> 00:43:15,850
HTTP that what to look for the first one

991
00:43:15,850 --> 00:43:17,830
if you see that that's pretty much an

992
00:43:17,830 --> 00:43:20,740
automated tool or a mobile app should

993
00:43:20,740 --> 00:43:24,610
never see in a web browser or our client

994
00:43:24,610 --> 00:43:27,220
come to your web server and just start

995
00:43:27,220 --> 00:43:29,620
with a post how does it know what form

996
00:43:29,620 --> 00:43:32,500
variables to post and then followed by a

997
00:43:32,500 --> 00:43:36,360
gap opposed to put no GATT example

998
00:43:36,360 --> 00:43:40,510
base64 I love this if you want to start

999
00:43:40,510 --> 00:43:43,060
out have some fun just look for clear

1000
00:43:43,060 --> 00:43:46,030
text HTTP or if you're doing SSL

1001
00:43:46,030 --> 00:43:51,760
decryption HTTP as well and look for

1002
00:43:51,760 --> 00:43:55,210
basic off because it's just a base64

1003
00:43:55,210 --> 00:43:57,040
string in there you can just decrypt it

1004
00:43:57,040 --> 00:43:58,420
and get the username and password and

1005
00:43:58,420 --> 00:44:00,220
then you can track that around your

1006
00:44:00,220 --> 00:44:04,960
network and then of course user agents

1007
00:44:04,960 --> 00:44:07,390
this is another quick filter that you

1008
00:44:07,390 --> 00:44:09,940
can do most web browsers send Mozilla

1009
00:44:09,940 --> 00:44:12,870
behind the scenes and the HTTP headers

1010
00:44:12,870 --> 00:44:15,430
you can just filter that out saying okay

1011
00:44:15,430 --> 00:44:18,070
filter out all commodity browsers now if

1012
00:44:18,070 --> 00:44:19,450
the malware is really good at all

1013
00:44:19,450 --> 00:44:21,070
spoof as one of those browsers but

1014
00:44:21,070 --> 00:44:24,520
you'll see things like curl W get auto

1015
00:44:24,520 --> 00:44:26,770
spider and the list goes on and on and

1016
00:44:26,770 --> 00:44:28,090
on and those are things you want to

1017
00:44:28,090 --> 00:44:30,400
start to dig into those are indicators

1018
00:44:30,400 --> 00:44:32,800
or missing header if you dig into the

1019
00:44:32,800 --> 00:44:37,090
RFC for HTTP it doesn't really say what

1020
00:44:37,090 --> 00:44:40,750
headers have to be there but there's a

1021
00:44:40,750 --> 00:44:44,380
couple ones that like length of the body

1022
00:44:44,380 --> 00:44:47,550
should be accurate so I've seen before

1023
00:44:47,550 --> 00:44:53,230
okay thank you I've seen before that the

1024
00:44:53,230 --> 00:44:56,890
length is zero but there's a body so

1025
00:44:56,890 --> 00:45:01,810
that's things to look at and then before

1026
00:45:01,810 --> 00:45:03,670
I get to the submarine Auslan is files

1027
00:45:03,670 --> 00:45:06,670
this is great just show a hands who here

1028
00:45:06,670 --> 00:45:10,140
does full packet capture

1029
00:45:12,280 --> 00:45:17,650
okay just a few people ah NetFlow okay

1030
00:45:17,650 --> 00:45:20,760
that's all the rest is log so yes okay

1031
00:45:20,760 --> 00:45:23,800
so one thing that's great about packet

1032
00:45:23,800 --> 00:45:26,950
captures you can kind of if you're doing

1033
00:45:26,950 --> 00:45:29,110
full packet capture raw you can just

1034
00:45:29,110 --> 00:45:30,790
remind the tape and you say well there

1035
00:45:30,790 --> 00:45:32,140
is an executable that flew over my

1036
00:45:32,140 --> 00:45:35,320
network to my endpoint execute on my now

1037
00:45:35,320 --> 00:45:38,260
endpoint but I need a copy of it I want

1038
00:45:38,260 --> 00:45:40,660
to see it actual copy what you can carve

1039
00:45:40,660 --> 00:45:42,910
it out so when you carve it out if you

1040
00:45:42,910 --> 00:45:45,070
look at the magic fingerprint or the

1041
00:45:45,070 --> 00:45:47,590
file and it's an executable but it's

1042
00:45:47,590 --> 00:45:50,380
renamed a JPEG to bypass some deal P

1043
00:45:50,380 --> 00:45:55,470
platform then that's kind of suspicious

1044
00:45:55,500 --> 00:46:01,420
the extension is not should be named off

1045
00:46:01,420 --> 00:46:04,230
and you want to add anything to that or

1046
00:46:04,230 --> 00:46:08,080
rar files that are have a password on

1047
00:46:08,080 --> 00:46:12,250
them small Java applets there's a couple

1048
00:46:12,250 --> 00:46:14,530
examples on the screen yeah any

1049
00:46:14,530 --> 00:46:24,070
questions about thought there we go

1050
00:46:24,070 --> 00:46:27,940
summary yeah so summary a few things to

1051
00:46:27,940 --> 00:46:30,760
take away just acknowledge there's a gap

1052
00:46:30,760 --> 00:46:33,040
so having a champion that believes in

1053
00:46:33,040 --> 00:46:34,360
the value of thread hunting and

1054
00:46:34,360 --> 00:46:35,710
acknowledging that it's valuable to

1055
00:46:35,710 --> 00:46:37,420
order your organization is really step

1056
00:46:37,420 --> 00:46:40,960
one enable the program so do you have

1057
00:46:40,960 --> 00:46:43,330
the data set that you need and then do

1058
00:46:43,330 --> 00:46:45,460
you have the people in place and I'll

1059
00:46:45,460 --> 00:46:48,040
argue that you know you don't need a

1060
00:46:48,040 --> 00:46:50,020
super experienced malware reverse

1061
00:46:50,020 --> 00:46:52,360
engineer to get started threat hunting I

1062
00:46:52,360 --> 00:46:55,140
would argue all you need is someone that

1063
00:46:55,140 --> 00:46:58,740
derives pleasure from this problem and

1064
00:46:58,740 --> 00:47:01,300
you know has some knowledge of your

1065
00:47:01,300 --> 00:47:03,460
network so it could be an IT admin could

1066
00:47:03,460 --> 00:47:04,690
be someone in dev ops could be a

1067
00:47:04,690 --> 00:47:06,700
security analyst so it's not reserved

1068
00:47:06,700 --> 00:47:08,680
for the chosen few anyone could get

1069
00:47:08,680 --> 00:47:11,560
started as a threat hunter I think one

1070
00:47:11,560 --> 00:47:12,820
of the our most successful threat

1071
00:47:12,820 --> 00:47:15,520
hunters on our corporate side his

1072
00:47:15,520 --> 00:47:18,010
background is a truck driver really it

1073
00:47:18,010 --> 00:47:21,490
can be anyone executing the program so I

1074
00:47:21,490 --> 00:47:23,080
we showed you a few examples of

1075
00:47:23,080 --> 00:47:25,320
downloading a framework to help you

1076
00:47:25,320 --> 00:47:27,060
document every

1077
00:47:27,060 --> 00:47:29,070
feed that back into your existing third

1078
00:47:29,070 --> 00:47:31,560
detection and response tools very

1079
00:47:31,560 --> 00:47:33,900
helpful and yeah measure your outputs

1080
00:47:33,900 --> 00:47:39,030
and try harder thank you

1081
00:47:39,030 --> 00:47:40,990
thanks everyone if there's questions

1082
00:47:40,990 --> 00:47:44,129
[Music]

1083
00:47:46,560 --> 00:47:56,969
[Music]

