1
00:00:00,350 --> 00:00:09,400
[Music]

2
00:00:11,630 --> 00:00:15,540
morning everyone thanks again to Micah

3
00:00:15,540 --> 00:00:17,609
and the organizers for having me here

4
00:00:17,609 --> 00:00:19,800
it's a great honor to be able to talk a

5
00:00:19,800 --> 00:00:23,160
bit about the work we have been doing in

6
00:00:23,160 --> 00:00:27,029
great at Kaspersky Lab for the past ten

7
00:00:27,029 --> 00:00:29,970
years so actually my team celebrates 10

8
00:00:29,970 --> 00:00:32,668
years of existence this year was just a

9
00:00:32,668 --> 00:00:35,670
few days ago we were looking back at

10
00:00:35,670 --> 00:00:38,219
some of the things we researched during

11
00:00:38,219 --> 00:00:43,579
the last 10 years while I was in great

12
00:00:43,579 --> 00:00:47,250
and we realized that there's like a lot

13
00:00:47,250 --> 00:00:48,719
of things out there there's a lot of

14
00:00:48,719 --> 00:00:51,090
threats sorry maybe some of the things

15
00:00:51,090 --> 00:00:54,059
that we talked about during the last

16
00:00:54,059 --> 00:00:56,879
year's I guess maybe I'm how many people

17
00:00:56,879 --> 00:01:00,800
are familiar let's say with the Stuxnet

18
00:01:00,890 --> 00:01:03,750
that's okay pretty much everybody but

19
00:01:03,750 --> 00:01:07,020
other things such as flame dooku net

20
00:01:07,020 --> 00:01:10,619
traveler Red October these are some of

21
00:01:10,619 --> 00:01:13,020
their let's say big research that we

22
00:01:13,020 --> 00:01:15,570
have been doing throughout the time and

23
00:01:15,570 --> 00:01:18,180
to be honest this hasn't been kind of

24
00:01:18,180 --> 00:01:20,970
risk-free so I do remember actually um

25
00:01:20,970 --> 00:01:25,920
it was in 2010 the virus bulletin

26
00:01:25,920 --> 00:01:28,350
conference took place here in Canada in

27
00:01:28,350 --> 00:01:30,900
Vancouver and I was invited to make a

28
00:01:30,900 --> 00:01:33,840
speech about Stuxnet actually one of my

29
00:01:33,840 --> 00:01:34,590
colleagues

30
00:01:34,590 --> 00:01:36,840
Alex Costa was originally invited to

31
00:01:36,840 --> 00:01:38,610
present there but he couldn't get the

32
00:01:38,610 --> 00:01:41,130
visa in time so he asked me to fill in

33
00:01:41,130 --> 00:01:43,710
for him so I said sure no problem

34
00:01:43,710 --> 00:01:46,649
I need to get myself familiar with

35
00:01:46,649 --> 00:01:48,869
Stuxnet first to be honest back then I

36
00:01:48,869 --> 00:01:51,119
was not paying a lot of attention to

37
00:01:51,119 --> 00:01:55,380
this big a PT's nation-state things so I

38
00:01:55,380 --> 00:01:58,020
got myself familiar with Stuxnet and I

39
00:01:58,020 --> 00:02:00,390
went to Canada and I the moment I you

40
00:02:00,390 --> 00:02:02,100
know I stepped on the stage and I

41
00:02:02,100 --> 00:02:04,200
noticed there was a kind of attention in

42
00:02:04,200 --> 00:02:07,439
the air and especially I noticed there

43
00:02:07,439 --> 00:02:09,449
were three guys sitting at the back of

44
00:02:09,449 --> 00:02:10,889
the room like everybody else was

45
00:02:10,889 --> 00:02:13,349
standing I was sitting but these three

46
00:02:13,349 --> 00:02:14,080
guys were actually

47
00:02:14,080 --> 00:02:16,210
standing and they didn't look very happy

48
00:02:16,210 --> 00:02:22,390
at all and obviously well there was

49
00:02:22,390 --> 00:02:25,330
something which kind of bothered them

50
00:02:25,330 --> 00:02:27,280
about these talks and presentation so

51
00:02:27,280 --> 00:02:29,680
later I went to the organizers and I

52
00:02:29,680 --> 00:02:31,120
asked them do you know who are these

53
00:02:31,120 --> 00:02:34,150
three guys who actually came just for my

54
00:02:34,150 --> 00:02:35,590
talk on Stuxnet and they left the

55
00:02:35,590 --> 00:02:37,780
conference afterwards so they say wow

56
00:02:37,780 --> 00:02:39,630
those are kind of strange guys they came

57
00:02:39,630 --> 00:02:43,720
they paid for the entrance with cash all

58
00:02:43,720 --> 00:02:44,170
right

59
00:02:44,170 --> 00:02:48,490
that's a good sign and I said okay so

60
00:02:48,490 --> 00:02:50,110
where are they from and they said well

61
00:02:50,110 --> 00:02:52,390
they put next to their company name they

62
00:02:52,390 --> 00:02:55,330
put GOI so I said what's GOI so like

63
00:02:55,330 --> 00:03:00,130
well government of something so I think

64
00:03:00,130 --> 00:03:02,320
that you know some of these things have

65
00:03:02,320 --> 00:03:05,380
been kind of tricky so after the

66
00:03:05,380 --> 00:03:07,720
conference actually I went back to

67
00:03:07,720 --> 00:03:09,820
Romania and the ball a month later I

68
00:03:09,820 --> 00:03:14,410
went back home and I got into my home

69
00:03:14,410 --> 00:03:17,740
and in the middle of the table in my

70
00:03:17,740 --> 00:03:20,980
dining room there is a Robert Cube with

71
00:03:20,980 --> 00:03:23,650
the message take a break so my wife

72
00:03:23,650 --> 00:03:25,360
looks at the QA says like why did you

73
00:03:25,360 --> 00:03:27,940
put this on the table and I'm like well

74
00:03:27,940 --> 00:03:31,060
I didn't put it on the table myself so

75
00:03:31,060 --> 00:03:33,989
she's like of course who put it so well

76
00:03:33,989 --> 00:03:37,750
not to scare my wife I did say that I

77
00:03:37,750 --> 00:03:39,940
put it later but I didn't put the cube

78
00:03:39,940 --> 00:03:43,720
on the table basically so you know doing

79
00:03:43,720 --> 00:03:46,260
this kind of research sign is not always

80
00:03:46,260 --> 00:03:49,030
risk-free I did take a break after

81
00:03:49,030 --> 00:03:51,610
finding the cube on my table in my

82
00:03:51,610 --> 00:03:53,800
dining room well but only for a few

83
00:03:53,800 --> 00:03:56,230
months and afterwards I realized that

84
00:03:56,230 --> 00:04:00,640
this is like not the right way so if you

85
00:04:00,640 --> 00:04:04,269
give up two fears then you will never be

86
00:04:04,269 --> 00:04:07,450
able to do important and big threat

87
00:04:07,450 --> 00:04:12,060
research but maybe a few words about

88
00:04:12,060 --> 00:04:14,140
maybe everybody's favorite subject

89
00:04:14,140 --> 00:04:19,930
nowadays fake news the 2016 USA

90
00:04:19,930 --> 00:04:23,260
elections I was in Barcelona with my

91
00:04:23,260 --> 00:04:27,520
team and one of my guys from the US I

92
00:04:27,520 --> 00:04:27,910
asked him

93
00:04:27,910 --> 00:04:29,620
who do you think is gonna win the

94
00:04:29,620 --> 00:04:31,630
election saying he said I'm confident

95
00:04:31,630 --> 00:04:34,180
it'll be Hillary say why well he said

96
00:04:34,180 --> 00:04:35,560
there's this guy who is doing

97
00:04:35,560 --> 00:04:37,480
predictions for the New York Times and

98
00:04:37,480 --> 00:04:39,580
he's got pretty much all the results

99
00:04:39,580 --> 00:04:43,180
correct for the past ten years or so so

100
00:04:43,180 --> 00:04:44,830
I said you're absolutely confident yeah

101
00:04:44,830 --> 00:04:47,440
so all right the election days come you

102
00:04:47,440 --> 00:04:49,480
know the next morning I wake up I go to

103
00:04:49,480 --> 00:04:51,750
Google and I google for elections and

104
00:04:51,750 --> 00:04:55,060
the like the first yet Google you know

105
00:04:55,060 --> 00:04:58,150
shows a photo of of a young lady

106
00:04:58,150 --> 00:05:02,800
something like this what's going on well

107
00:05:02,800 --> 00:05:04,810
everybody knows what was the result of

108
00:05:04,810 --> 00:05:08,260
the elections but this is a one of the

109
00:05:08,260 --> 00:05:10,840
few nice pictures where you can see both

110
00:05:10,840 --> 00:05:13,150
the candidates looking you know smiling

111
00:05:13,150 --> 00:05:15,940
and most of the other pictures they

112
00:05:15,940 --> 00:05:17,860
either look one of them looks bad and

113
00:05:17,860 --> 00:05:20,800
the other looks nice and so on but maybe

114
00:05:20,800 --> 00:05:23,110
not many people remember that before the

115
00:05:23,110 --> 00:05:27,010
elections there was a guy called Gucci

116
00:05:27,010 --> 00:05:27,460
fur

117
00:05:27,460 --> 00:05:30,010
and why is this important because Gucci

118
00:05:30,010 --> 00:05:32,320
fur was the first guy who claimed that

119
00:05:32,320 --> 00:05:34,830
he was able to break into Hillary's

120
00:05:34,830 --> 00:05:38,290
famous email server and he not only said

121
00:05:38,290 --> 00:05:40,150
he was able to break into the server but

122
00:05:40,150 --> 00:05:42,460
he said as like many other guys they're

123
00:05:42,460 --> 00:05:45,190
like it's me the Chinese Russians and so

124
00:05:45,190 --> 00:05:48,130
on so actually who was this guy well

125
00:05:48,130 --> 00:05:53,140
known by his full name marshal as

126
00:05:53,140 --> 00:05:55,990
earlier a romanian guy Gucci fur was

127
00:05:55,990 --> 00:05:58,990
actually a Romanian hacker and a taxi

128
00:05:58,990 --> 00:06:01,330
driver and the reason why he chose his

129
00:06:01,330 --> 00:06:03,820
name is because he said he combines a

130
00:06:03,820 --> 00:06:05,950
style of Gucci with the light of Lucifer

131
00:06:05,950 --> 00:06:07,960
it's kind of weird

132
00:06:07,960 --> 00:06:11,470
he's like probably got some issues up

133
00:06:11,470 --> 00:06:16,330
there what's amazing about Buchi fur is

134
00:06:16,330 --> 00:06:17,890
that he had no skills he had no

135
00:06:17,890 --> 00:06:20,410
knowledge except what he found on the

136
00:06:20,410 --> 00:06:22,420
internet so he was a self-taught hacker

137
00:06:22,420 --> 00:06:24,430
basically some people would call him

138
00:06:24,430 --> 00:06:27,480
maybe a script kiddie but nevertheless

139
00:06:27,480 --> 00:06:31,750
he was quite successful he was able to

140
00:06:31,750 --> 00:06:35,230
hack Colin Powell's email members of the

141
00:06:35,230 --> 00:06:37,780
Rockefeller family he was able to hack

142
00:06:37,780 --> 00:06:40,300
the emails of several FBI and US Secret

143
00:06:40,300 --> 00:06:41,479
Service agents

144
00:06:41,479 --> 00:06:43,939
he was able to hack or Enoch read Susy

145
00:06:43,939 --> 00:06:47,090
mail and Georgia mayor's email and of

146
00:06:47,090 --> 00:06:49,039
course many people wonder who are these

147
00:06:49,039 --> 00:06:50,240
like and why do we care

148
00:06:50,240 --> 00:06:52,759
well Carina Kratz who was actually a

149
00:06:52,759 --> 00:06:56,150
Romanian politician and it's quite

150
00:06:56,150 --> 00:06:58,669
interesting to know how he was able to

151
00:06:58,669 --> 00:07:03,770
hack into her email he got to her well

152
00:07:03,770 --> 00:07:06,770
he knew that she has a who account so he

153
00:07:06,770 --> 00:07:08,150
went there he tried to reset the

154
00:07:08,150 --> 00:07:10,430
password that one of the questions was

155
00:07:10,430 --> 00:07:12,289
the name of the city where she was born

156
00:07:12,289 --> 00:07:14,689
and because she's a politician everybody

157
00:07:14,689 --> 00:07:16,819
knows where she was born she's born in a

158
00:07:16,819 --> 00:07:19,669
city was born in a city called brayla so

159
00:07:19,669 --> 00:07:21,259
that's the first question the second

160
00:07:21,259 --> 00:07:22,879
question was the name of the street

161
00:07:22,879 --> 00:07:25,789
where she grew up so what he did was

162
00:07:25,789 --> 00:07:27,469
actually he tried all the street names

163
00:07:27,469 --> 00:07:30,560
in brayla until you know he got the

164
00:07:30,560 --> 00:07:32,779
right street name and that's how he was

165
00:07:32,779 --> 00:07:35,360
able to hack into her account now the

166
00:07:35,360 --> 00:07:38,559
more interesting guy is Georgia mayor

167
00:07:38,559 --> 00:07:42,289
well this was basically the top man in

168
00:07:42,289 --> 00:07:44,240
the Romanian intelligence he was a head

169
00:07:44,240 --> 00:07:46,819
of the Romanian intelligence service and

170
00:07:46,819 --> 00:07:48,770
he was able to hack into his email and

171
00:07:48,770 --> 00:07:50,599
not only that but he tried to blackmail

172
00:07:50,599 --> 00:07:54,649
him which is kind of funny of course he

173
00:07:54,649 --> 00:07:57,349
not called him he also tried to call him

174
00:07:57,349 --> 00:07:59,839
a skunk and he tried to get some money

175
00:07:59,839 --> 00:08:01,729
from him for not releasing the emails

176
00:08:01,729 --> 00:08:05,209
now while Gucci fur was hacking the

177
00:08:05,209 --> 00:08:07,879
emails of FBI agents Rockefeller and so

178
00:08:07,879 --> 00:08:08,120
on

179
00:08:08,120 --> 00:08:10,249
you know nobody pretty much killed in

180
00:08:10,249 --> 00:08:13,189
Romania I guess but when he hacked the

181
00:08:13,189 --> 00:08:14,749
top man into the Romanian

182
00:08:14,749 --> 00:08:17,749
intelligence well two weeks later he was

183
00:08:17,749 --> 00:08:21,580
arrested so he was put into jail

184
00:08:21,580 --> 00:08:25,069
basically and awaits extradition to the

185
00:08:25,069 --> 00:08:27,439
United States so that's the story of

186
00:08:27,439 --> 00:08:29,839
Gucci fur now why this is there like

187
00:08:29,839 --> 00:08:32,870
relevant to the elections everybody

188
00:08:32,870 --> 00:08:35,779
probably remembers the famous DNC hack

189
00:08:35,779 --> 00:08:40,578
and basically crawl strike which is a

190
00:08:40,578 --> 00:08:42,620
great company a lot of respect for them

191
00:08:42,620 --> 00:08:45,380
they were hired by the DNC to

192
00:08:45,380 --> 00:08:48,470
investigate a hack and after the

193
00:08:48,470 --> 00:08:50,720
investigation they wrote a blog post and

194
00:08:50,720 --> 00:08:53,480
they attributed the intrusions into the

195
00:08:53,480 --> 00:08:54,740
DNC to to

196
00:08:54,740 --> 00:08:56,930
in hacking groups one of them called

197
00:08:56,930 --> 00:08:59,360
fancy beer also known as sofa see were

198
00:08:59,360 --> 00:09:03,020
apt 28 bone storm it's our team many

199
00:09:03,020 --> 00:09:06,520
names the other one known as cozy bear

200
00:09:06,520 --> 00:09:09,800
why this was interesting because almost

201
00:09:09,800 --> 00:09:13,160
immediately a new guy appeared going by

202
00:09:13,160 --> 00:09:16,520
the alias Gucci 42.0 and he set up a

203
00:09:16,520 --> 00:09:19,760
blog post on blogspot in here you know

204
00:09:19,760 --> 00:09:22,220
what he said was you know cross track is

205
00:09:22,220 --> 00:09:24,399
trying to convince you guys was the

206
00:09:24,399 --> 00:09:26,600
Russian intelligence but actually

207
00:09:26,600 --> 00:09:28,880
there's none of the sorts it's just me

208
00:09:28,880 --> 00:09:30,140
alone a lonely hacker

209
00:09:30,140 --> 00:09:32,720
and actually I can prove it here's some

210
00:09:32,720 --> 00:09:34,760
documents which I took from the DNC

211
00:09:34,760 --> 00:09:38,149
never so like initially of course this

212
00:09:38,149 --> 00:09:40,690
was a huge blow and it's hard to

213
00:09:40,690 --> 00:09:42,740
sometimes it's hard to understand which

214
00:09:42,740 --> 00:09:45,589
one is right obviously we have no doubts

215
00:09:45,589 --> 00:09:48,589
that CrowdStrike was right and so fuzzy

216
00:09:48,589 --> 00:09:53,029
and cozy beer causative have actually

217
00:09:53,029 --> 00:09:54,980
been in the DNC Network but what was

218
00:09:54,980 --> 00:09:56,810
going on with Gucci fur and quite a few

219
00:09:56,810 --> 00:09:59,839
people actually try to talk a bit to him

220
00:09:59,839 --> 00:10:02,300
and see what's going on one of my

221
00:10:02,300 --> 00:10:04,520
friends Lauren so Francesca we arrived

222
00:10:04,520 --> 00:10:07,130
from motherboard he tried to interview

223
00:10:07,130 --> 00:10:09,890
Gucci for 2.0 and he has him worried

224
00:10:09,890 --> 00:10:13,029
from he said I'm from Romania and

225
00:10:13,029 --> 00:10:15,680
Lorenzo is Italian you know he tried to

226
00:10:15,680 --> 00:10:17,570
talk a bit with him in Romanian for

227
00:10:17,570 --> 00:10:20,440
instance asking this big Romanian sure

228
00:10:20,440 --> 00:10:23,839
where you put Russian metadata into the

229
00:10:23,839 --> 00:10:26,420
documents in he said well Esther

230
00:10:26,420 --> 00:10:28,850
filigrana old Mel which means it's my

231
00:10:28,850 --> 00:10:32,209
watermark and then he said this he

232
00:10:32,209 --> 00:10:35,930
repeats this word filigrana or filigrana

233
00:10:35,930 --> 00:10:38,329
he actually repeats this word a couple

234
00:10:38,329 --> 00:10:42,260
of times and now well any Romanian

235
00:10:42,260 --> 00:10:45,399
speakers in the audience Wow quite a few

236
00:10:45,399 --> 00:10:47,660
have you ever used this word before

237
00:10:47,660 --> 00:10:51,800
filly granny one guy interesting I think

238
00:10:51,800 --> 00:10:52,760
I have friends

239
00:10:52,760 --> 00:10:55,339
maybe my age who probably never used

240
00:10:55,339 --> 00:10:58,459
this word in their life unless you know

241
00:10:58,459 --> 00:11:00,350
maybe were you work in printing or

242
00:11:00,350 --> 00:11:02,000
something like this it's a very very

243
00:11:02,000 --> 00:11:02,850
unusual

244
00:11:02,850 --> 00:11:05,730
rare world and not only is that by Gucci

245
00:11:05,730 --> 00:11:08,339
fur 2.0 he was making quite a few

246
00:11:08,339 --> 00:11:12,089
mistakes when he was trying to talk in

247
00:11:12,089 --> 00:11:16,740
Romanian so obviously why was he doing

248
00:11:16,740 --> 00:11:18,930
all these mistakes so actually if you go

249
00:11:18,930 --> 00:11:21,300
to Google Translate and you know and do

250
00:11:21,300 --> 00:11:24,240
it's my watermark you get this esta

251
00:11:24,240 --> 00:11:26,490
filigrana lamelle I think that anybody

252
00:11:26,490 --> 00:11:31,800
in Romania they would say este watermark

253
00:11:31,800 --> 00:11:33,839
ago so we'll just use the English word

254
00:11:33,839 --> 00:11:36,079
for the same purpose nobody will use the

255
00:11:36,079 --> 00:11:38,730
like say dictionary translation of

256
00:11:38,730 --> 00:11:44,250
watermark so yeah that kind of gave a

257
00:11:44,250 --> 00:11:47,040
Gucci far away that he was and who he

258
00:11:47,040 --> 00:11:49,860
was claiming to me and it wasn't until

259
00:11:49,860 --> 00:11:53,639
recently when the Department of Justice

260
00:11:53,639 --> 00:11:56,910
indicted a couple of Russian officer

261
00:11:56,910 --> 00:11:59,910
intelligence officers for this hack and

262
00:11:59,910 --> 00:12:02,220
it's quite interesting they were able to

263
00:12:02,220 --> 00:12:06,120
pinpoint this Gucci fur identity to a

264
00:12:06,120 --> 00:12:09,000
couple of these guys and they say how do

265
00:12:09,000 --> 00:12:11,579
they know well they're quite confident

266
00:12:11,579 --> 00:12:14,819
it was this group behind the blog post

267
00:12:14,819 --> 00:12:17,939
because basically they were searching on

268
00:12:17,939 --> 00:12:20,910
the internet for some English terms just

269
00:12:20,910 --> 00:12:22,470
to make sure they use correct English

270
00:12:22,470 --> 00:12:26,029
such as some hundred sheets some

271
00:12:26,029 --> 00:12:30,029
hundreds of sheets like you know it's

272
00:12:30,029 --> 00:12:31,740
sometimes it's hard for non-native

273
00:12:31,740 --> 00:12:34,529
English speakers to find the plot plural

274
00:12:34,529 --> 00:12:36,750
of a hundred uses some hundred is some

275
00:12:36,750 --> 00:12:40,170
hundreds and so on and later they use

276
00:12:40,170 --> 00:12:43,680
these exact words into the blog post

277
00:12:43,680 --> 00:12:47,310
with a published on WordPress this is

278
00:12:47,310 --> 00:12:50,759
the copy of the blog post and the exact

279
00:12:50,759 --> 00:12:54,209
words they were searching on Twitter so

280
00:12:54,209 --> 00:12:59,189
he didn't like took long for the US

281
00:12:59,189 --> 00:13:01,620
intelligence to be able to point who was

282
00:13:01,620 --> 00:13:04,339
behind this attack and this

283
00:13:04,339 --> 00:13:08,160
disinformation campaign so it was quite

284
00:13:08,160 --> 00:13:10,079
interesting that there are still missing

285
00:13:10,079 --> 00:13:13,019
parts of the DNC story so not the let's

286
00:13:13,019 --> 00:13:16,120
say the entire story is clear variants

287
00:13:16,120 --> 00:13:19,209
there's been this indictment which deals

288
00:13:19,209 --> 00:13:21,910
with the hackers known as fancy bear

289
00:13:21,910 --> 00:13:24,699
actually it's amazing there's basically

290
00:13:24,699 --> 00:13:28,089
zero mentions at all in the indictment

291
00:13:28,089 --> 00:13:31,420
about the other hacking group this one

292
00:13:31,420 --> 00:13:34,240
cozy beer so actually it was a quite an

293
00:13:34,240 --> 00:13:35,829
unusual hacking group they were very

294
00:13:35,829 --> 00:13:38,980
dynamic they're very active back in two

295
00:13:38,980 --> 00:13:41,709
thousand fourteen fifteen sixteen and

296
00:13:41,709 --> 00:13:43,480
then at some point they just simply

297
00:13:43,480 --> 00:13:46,629
disappear so everybody lost track of the

298
00:13:46,629 --> 00:13:50,019
cozy beer we also call them the Dukes

299
00:13:50,019 --> 00:13:53,290
and my company we were the first to

300
00:13:53,290 --> 00:13:56,559
publish about them we in 2013 under the

301
00:13:56,559 --> 00:14:00,189
name mini do so at the moment like

302
00:14:00,189 --> 00:14:02,079
everybody's kind of wondering where are

303
00:14:02,079 --> 00:14:04,809
the Dukes so just one of the open

304
00:14:04,809 --> 00:14:07,959
questions in this whole hacking of the

305
00:14:07,959 --> 00:14:11,470
u.s. elections saga so the whole story

306
00:14:11,470 --> 00:14:14,319
about Buchi fir and his release a

307
00:14:14,319 --> 00:14:16,959
unusual use of usage of Romanian words

308
00:14:16,959 --> 00:14:19,480
it got me thinking and I was wondering

309
00:14:19,480 --> 00:14:23,249
can we find this kind of watermarks

310
00:14:23,249 --> 00:14:26,980
between different attacks and can we

311
00:14:26,980 --> 00:14:29,889
actually build some kind of a system

312
00:14:29,889 --> 00:14:31,929
which will allow us to pinpoint future

313
00:14:31,929 --> 00:14:34,509
attacks to previous incidents and to

314
00:14:34,509 --> 00:14:38,110
connect hacking incidents across the

315
00:14:38,110 --> 00:14:40,629
time so that's how I got you know I

316
00:14:40,629 --> 00:14:43,589
started thinking about code similarity

317
00:14:43,589 --> 00:14:47,319
and actually I remember very well what

318
00:14:47,319 --> 00:14:50,490
was happening on the morning of May 12

319
00:14:50,490 --> 00:14:55,449
2017 anybody remembers this date well I

320
00:14:55,449 --> 00:14:57,300
was in the office it was a Friday

321
00:14:57,300 --> 00:15:00,339
usually you want the Friday to be quite

322
00:15:00,339 --> 00:15:04,540
you know quiet you know peaceful so the

323
00:15:04,540 --> 00:15:06,220
last thing you want to hear on a Friday

324
00:15:06,220 --> 00:15:09,759
is for one of your guys to write you a

325
00:15:09,759 --> 00:15:11,889
message and say we have an emergency

326
00:15:11,889 --> 00:15:14,769
there's an outbreak and you look like a

327
00:15:14,769 --> 00:15:17,759
man it's a Friday it's like you know

328
00:15:17,759 --> 00:15:20,110
you don't want to look like who wants an

329
00:15:20,110 --> 00:15:21,910
outbreak on a Friday that's the best

330
00:15:21,910 --> 00:15:26,619
kind of a terrible thing and like slowly

331
00:15:26,619 --> 00:15:29,199
new started to appear this is how

332
00:15:29,199 --> 00:15:31,930
computers were looking like some of the

333
00:15:31,930 --> 00:15:35,649
computers in a industrial control center

334
00:15:35,649 --> 00:15:42,699
this is a dizzy wall a very posh closing

335
00:15:42,699 --> 00:15:46,660
brain from Spain Hotel Burbank which is

336
00:15:46,660 --> 00:15:49,240
a Russian bank got hit by the the

337
00:15:49,240 --> 00:15:53,110
transportation system in Frankfurt was

338
00:15:53,110 --> 00:15:57,449
also hit ATMs in Hong Kong and Singapore

339
00:15:57,449 --> 00:16:00,699
yeah you know pretty much wanna cry was

340
00:16:00,699 --> 00:16:03,100
kind of everywhere and that actually led

341
00:16:03,100 --> 00:16:07,600
people to make some funny versions of

342
00:16:07,600 --> 00:16:13,779
this attack so I hear Nokia is having a

343
00:16:13,779 --> 00:16:16,059
comeback with these old phones

344
00:16:16,059 --> 00:16:18,850
well like the battery lasts for one year

345
00:16:18,850 --> 00:16:21,759
or so it's you know not the usual stuff

346
00:16:21,759 --> 00:16:25,569
we have nowadays microwave ovens or she

347
00:16:25,569 --> 00:16:30,779
machines Google Glasses air conditioning

348
00:16:30,779 --> 00:16:33,370
smart well what a cry was you know

349
00:16:33,370 --> 00:16:40,689
pretty much everywhere in Nintendo yeah

350
00:16:40,689 --> 00:16:44,889
that one's my favorite yeah like you

351
00:16:44,889 --> 00:16:47,790
know the matrix was kind of owned by

352
00:16:47,790 --> 00:16:54,339
wanna crack you know as the story was

353
00:16:54,339 --> 00:16:56,110
unraveling I was in the office the

354
00:16:56,110 --> 00:16:58,420
family with was upset like why are you

355
00:16:58,420 --> 00:17:00,040
doing in the office through the weekend

356
00:17:00,040 --> 00:17:02,439
I'm having like outbreak and my wife

357
00:17:02,439 --> 00:17:04,119
asked who is responsible for this

358
00:17:04,119 --> 00:17:07,369
outbreak I want to punish them

359
00:17:07,369 --> 00:17:10,890
and I was like good question I don't

360
00:17:10,890 --> 00:17:15,319
know yeah and honestly it wasn't until

361
00:17:15,319 --> 00:17:19,400
Monday when Neil Metta who is the hizzy

362
00:17:19,400 --> 00:17:22,380
researcher working for Google he posted

363
00:17:22,380 --> 00:17:24,810
this message on Twitter and the moment

364
00:17:24,810 --> 00:17:27,750
that I saw the message I said damn he's

365
00:17:27,750 --> 00:17:30,870
right and of course a few other people

366
00:17:30,870 --> 00:17:33,750
asked what does it mean by this mass

367
00:17:33,750 --> 00:17:36,660
ejection is just a few numbers so if you

368
00:17:36,660 --> 00:17:39,630
look at the message actually it's pretty

369
00:17:39,630 --> 00:17:42,570
obvious for everybody I guess if not

370
00:17:42,570 --> 00:17:45,300
it's just what's what do we have here we

371
00:17:45,300 --> 00:17:47,820
have like actually it's two hashes so he

372
00:17:47,820 --> 00:17:49,920
means here's these two samples and

373
00:17:49,920 --> 00:17:53,190
here's two different offsets in these

374
00:17:53,190 --> 00:17:55,860
two different samples and that's like

375
00:17:55,860 --> 00:17:58,890
one equipped attribution so what do i do

376
00:17:58,890 --> 00:18:03,270
I open these two samples myself you have

377
00:18:03,270 --> 00:18:06,440
them here on the screen one of them is a

378
00:18:06,440 --> 00:18:10,110
version of wanna cry 1.0 that was

379
00:18:10,110 --> 00:18:12,270
originally used in March so we already

380
00:18:12,270 --> 00:18:15,890
may version wanna cry 2.0 but in March

381
00:18:15,890 --> 00:18:19,740
someone used this one a cry 1.0 to

382
00:18:19,740 --> 00:18:22,710
attack like a different number of

383
00:18:22,710 --> 00:18:24,720
companies not as many as one a cry to

384
00:18:24,720 --> 00:18:27,330
points here and the other one is a molar

385
00:18:27,330 --> 00:18:30,030
sample from a group known as Lazarus

386
00:18:30,030 --> 00:18:32,190
which has been previously associated

387
00:18:32,190 --> 00:18:37,530
with the North Korean hackers so what do

388
00:18:37,530 --> 00:18:39,510
we have here we have basically fragments

389
00:18:39,510 --> 00:18:42,060
of code which are the same across wanna

390
00:18:42,060 --> 00:18:47,070
cry and these older Lazarus samples that

391
00:18:47,070 --> 00:18:50,730
were used in the 2014 attack again the

392
00:18:50,730 --> 00:18:54,480
Sony Pictures Entertainment so he was

393
00:18:54,480 --> 00:18:57,210
like for me it was pretty obvious that

394
00:18:57,210 --> 00:18:59,510
this is like an amazing way of

395
00:18:59,510 --> 00:19:01,740
identifying you know new attacks and

396
00:19:01,740 --> 00:19:04,470
seeing who is behind them and it allows

397
00:19:04,470 --> 00:19:06,030
you to very quickly understand but

398
00:19:06,030 --> 00:19:08,990
actually how can you do something

399
00:19:08,990 --> 00:19:12,090
similar to what Google was able to do

400
00:19:12,090 --> 00:19:15,240
here and kneel make the rota bar so the

401
00:19:15,240 --> 00:19:16,320
full story is the following

402
00:19:16,320 --> 00:19:19,470
in 2011 Google water company called

403
00:19:19,470 --> 00:19:20,850
Dynamics

404
00:19:20,850 --> 00:19:22,860
and I had a meeting with the Google

405
00:19:22,860 --> 00:19:25,080
engineer in 2014 we were working

406
00:19:25,080 --> 00:19:29,970
together on a project and I asked him

407
00:19:29,970 --> 00:19:31,650
how can we search for other samples

408
00:19:31,650 --> 00:19:33,480
which are similar to this one he said

409
00:19:33,480 --> 00:19:36,059
you know it's easy man you just pin ten

410
00:19:36,059 --> 00:19:37,890
thousand machines and you do a string

411
00:19:37,890 --> 00:19:42,840
search in parallel so nice I went to my

412
00:19:42,840 --> 00:19:46,410
CTO and I said boss

413
00:19:46,410 --> 00:19:48,660
can we buy ten thousand machines for

414
00:19:48,660 --> 00:19:51,960
this task yeah well you guess the answer

415
00:19:51,960 --> 00:19:55,320
and then in 2017 Google was able to link

416
00:19:55,320 --> 00:19:57,809
one a cry to the Lazarus group what's

417
00:19:57,809 --> 00:19:59,700
interesting is that actually Google is

418
00:19:59,700 --> 00:20:01,350
not the only company which has such

419
00:20:01,350 --> 00:20:04,350
technology another company a Romanian

420
00:20:04,350 --> 00:20:06,840
company called binary they developed the

421
00:20:06,840 --> 00:20:08,790
same technology and later they were a

422
00:20:08,790 --> 00:20:11,870
crowd acquired by CrowdStrike and

423
00:20:11,870 --> 00:20:15,510
there's also an Israeli startup at the

424
00:20:15,510 --> 00:20:18,750
moment a called in desert which has

425
00:20:18,750 --> 00:20:22,140
pretty much the same capability so I

426
00:20:22,140 --> 00:20:24,150
thought that we this is something that

427
00:20:24,150 --> 00:20:26,880
in my opinion will kind of reshape the

428
00:20:26,880 --> 00:20:28,890
way we do threat intelligence so this is

429
00:20:28,890 --> 00:20:31,799
something that we need to have as well

430
00:20:31,799 --> 00:20:33,780
and probably every other company should

431
00:20:33,780 --> 00:20:37,049
have the same so the only question is

432
00:20:37,049 --> 00:20:39,510
how do you do that and you have to do it

433
00:20:39,510 --> 00:20:41,669
like at a huge scale you have to do it

434
00:20:41,669 --> 00:20:44,940
like with big data right and there isn't

435
00:20:44,940 --> 00:20:46,620
like the theory behind it the

436
00:20:46,620 --> 00:20:48,540
mathematics is not that hard you just

437
00:20:48,540 --> 00:20:50,790
generate let's say all the possible

438
00:20:50,790 --> 00:20:53,850
eight or up to 16 bytes of strings from

439
00:20:53,850 --> 00:20:56,160
the samples and then you just check for

440
00:20:56,160 --> 00:20:59,100
overlaps the only problem is that our

441
00:20:59,100 --> 00:21:01,410
Moloch collection is about 5 petabytes

442
00:21:01,410 --> 00:21:04,110
at the moment so doing something like a

443
00:21:04,110 --> 00:21:06,720
search across these 5 petabytes takes

444
00:21:06,720 --> 00:21:09,570
about 2 weeks and that we all have

445
00:21:09,570 --> 00:21:11,640
budget to purchase 10 thousand machines

446
00:21:11,640 --> 00:21:13,620
for this particular task

447
00:21:13,620 --> 00:21:16,260
our goal you know is to protect our

448
00:21:16,260 --> 00:21:19,290
users but this doesn't look like it's a

449
00:21:19,290 --> 00:21:22,080
very efficient way of doing it so one of

450
00:21:22,080 --> 00:21:23,760
the ways we thought we could actually

451
00:21:23,760 --> 00:21:28,169
use a tool called yarra for this how

452
00:21:28,169 --> 00:21:30,230
many people are familiar with the are

453
00:21:30,230 --> 00:21:32,660
excellent

454
00:21:32,660 --> 00:21:36,570
you're easy basically in a nutshell is a

455
00:21:36,570 --> 00:21:38,850
very nice tool created by Victor Manuel

456
00:21:38,850 --> 00:21:43,040
Alvarez also known as plastic he's a

457
00:21:43,040 --> 00:21:45,299
Cuban programmer who works for

458
00:21:45,299 --> 00:21:47,880
virustotal was purchased by Google and

459
00:21:47,880 --> 00:21:50,010
he created this language which allows

460
00:21:50,010 --> 00:21:52,970
you to search for interesting patterns

461
00:21:52,970 --> 00:21:56,340
across malware samples so he calls it

462
00:21:56,340 --> 00:21:58,380
actually the swiss knife for malware

463
00:21:58,380 --> 00:22:01,860
researchers so how can we let us say

464
00:22:01,860 --> 00:22:04,320
combine this with the big data and try

465
00:22:04,320 --> 00:22:06,419
to emulate what Google was doing well

466
00:22:06,419 --> 00:22:08,760
first of all the idea is not to use all

467
00:22:08,760 --> 00:22:10,590
the possible combination of strings from

468
00:22:10,590 --> 00:22:13,140
a file but may be first identified the

469
00:22:13,140 --> 00:22:16,650
relevant ones and you build a are a rule

470
00:22:16,650 --> 00:22:18,630
from the interesting strings in a sample

471
00:22:18,630 --> 00:22:20,480
and then you just use that the RR rule

472
00:22:20,480 --> 00:22:24,299
later across the collection now there's

473
00:22:24,299 --> 00:22:27,840
let's say a few drawbacks to this

474
00:22:27,840 --> 00:22:30,090
problem one of them being that the ha1

475
00:22:30,090 --> 00:22:31,950
let's say 100 keith well there's

476
00:22:31,950 --> 00:22:37,320
obviously 100,000 16 bytes of strings in

477
00:22:37,320 --> 00:22:39,480
that sample so even after you filter out

478
00:22:39,480 --> 00:22:42,240
the clean one and for that you need to

479
00:22:42,240 --> 00:22:44,790
have a very good clean collection so a

480
00:22:44,790 --> 00:22:47,580
set of clean files you take all the

481
00:22:47,580 --> 00:22:49,620
strings from the clean files you weed

482
00:22:49,620 --> 00:22:52,440
them out from the suspicious samples and

483
00:22:52,440 --> 00:22:55,740
you're still left with about 30,000

484
00:22:55,740 --> 00:22:56,190
strings

485
00:22:56,190 --> 00:22:58,350
based on our experience so how do you

486
00:22:58,350 --> 00:22:59,669
know let's say which ones are

487
00:22:59,669 --> 00:23:02,270
interesting and which ones are none

488
00:23:02,270 --> 00:23:05,669
here's a typical example like the string

489
00:23:05,669 --> 00:23:08,540
on the top is a quite interesting string

490
00:23:08,540 --> 00:23:12,390
it can be used for this kind of searches

491
00:23:12,390 --> 00:23:14,790
but the string at the bottom is not very

492
00:23:14,790 --> 00:23:17,640
useful even if it doesn't appear let's

493
00:23:17,640 --> 00:23:20,250
say in many clean samples as you can see

494
00:23:20,250 --> 00:23:24,090
this is full of cccc anybody any idea

495
00:23:24,090 --> 00:23:31,650
what CC means Intel x86 up codes well

496
00:23:31,650 --> 00:23:34,380
it's in three so it's a debug

497
00:23:34,380 --> 00:23:36,929
instruction so obviously anybody can

498
00:23:36,929 --> 00:23:38,940
have these debug instructions in their

499
00:23:38,940 --> 00:23:41,100
code so it's not necessarily interesting

500
00:23:41,100 --> 00:23:43,320
but if you extract the interesting ones

501
00:23:43,320 --> 00:23:45,120
and the idea how do you know which ones

502
00:23:45,120 --> 00:23:45,930
are it

503
00:23:45,930 --> 00:23:48,540
we built a basically machine learning

504
00:23:48,540 --> 00:23:51,570
system we trained it with these samples

505
00:23:51,570 --> 00:23:53,070
and we discovered the some of these

506
00:23:53,070 --> 00:23:56,160
strings based on Markov chains are

507
00:23:56,160 --> 00:23:58,620
actually more efficient at finding code

508
00:23:58,620 --> 00:24:01,740
the overlaps so here's an example this

509
00:24:01,740 --> 00:24:05,030
is a euro rule that our system built for

510
00:24:05,030 --> 00:24:07,530
something called shadow pet I'll mention

511
00:24:07,530 --> 00:24:09,660
it later so these are all shell code

512
00:24:09,660 --> 00:24:11,490
fragments which appear in this shell

513
00:24:11,490 --> 00:24:14,310
code in these shadow pet samples but

514
00:24:14,310 --> 00:24:16,830
they do not appear in any other clean or

515
00:24:16,830 --> 00:24:20,130
mauler samples so of course this system

516
00:24:20,130 --> 00:24:22,740
can be improved you can first test it

517
00:24:22,740 --> 00:24:25,700
across your big apt samples collection

518
00:24:25,700 --> 00:24:28,440
fine if it detects other apt is by

519
00:24:28,440 --> 00:24:31,350
common strings you modify the rule to

520
00:24:31,350 --> 00:24:34,530
keep only the strings which heat across

521
00:24:34,530 --> 00:24:36,570
different samples from the same thread

522
00:24:36,570 --> 00:24:39,210
actor and then you run it using some big

523
00:24:39,210 --> 00:24:41,970
data like VT Me's which is virustotal

524
00:24:41,970 --> 00:24:44,790
malware intelligence system or klara

525
00:24:44,790 --> 00:24:47,580
which is our own equivalent of that so

526
00:24:47,580 --> 00:24:49,980
just some numbers about this system we

527
00:24:49,980 --> 00:24:51,750
process about the quarter million

528
00:24:51,750 --> 00:24:54,500
samples per day with it it knows about

529
00:24:54,500 --> 00:24:57,840
56 million known clean samples so those

530
00:24:57,840 --> 00:25:00,180
are like notepad right from Windows they

531
00:25:00,180 --> 00:25:03,180
are not malicious from which we

532
00:25:03,180 --> 00:25:05,960
extracted about say 6 billion strings

533
00:25:05,960 --> 00:25:09,510
and it has about 10 billion of known

534
00:25:09,510 --> 00:25:12,960
good op codes so let's see actually what

535
00:25:12,960 --> 00:25:16,830
we can do with this amazing system all

536
00:25:16,830 --> 00:25:22,440
right so we had like a very interesting

537
00:25:22,440 --> 00:25:26,730
engagement I think it was around August

538
00:25:26,730 --> 00:25:31,320
2017 a bank called us and they said well

539
00:25:31,320 --> 00:25:33,780
we kind of think we're infected with

540
00:25:33,780 --> 00:25:37,200
some say but we can't find it so can you

541
00:25:37,200 --> 00:25:41,070
guys come over and take a look so sure

542
00:25:41,070 --> 00:25:44,280
well a guy from my team went to the bank

543
00:25:44,280 --> 00:25:46,620
and he said why do you think that you

544
00:25:46,620 --> 00:25:48,870
are infected and I said well in our

545
00:25:48,870 --> 00:25:51,900
network monitoring we observed a couple

546
00:25:51,900 --> 00:25:54,710
of DNS queries for a number of domains

547
00:25:54,710 --> 00:25:58,050
which result like in annex non-existent

548
00:25:58,050 --> 00:25:59,549
and they come from the

549
00:25:59,549 --> 00:26:01,259
system which we use to make the big

550
00:26:01,259 --> 00:26:03,299
payments so that's the system we use to

551
00:26:03,299 --> 00:26:06,950
transfer money across the Swift Network

552
00:26:06,950 --> 00:26:10,230
and we the only issue is we check the

553
00:26:10,230 --> 00:26:12,029
system and we can't find what's wrong

554
00:26:12,029 --> 00:26:14,309
with it like there's apparently nothing

555
00:26:14,309 --> 00:26:16,830
wrong there's no malware detected and we

556
00:26:16,830 --> 00:26:19,470
did our best looking for new files and

557
00:26:19,470 --> 00:26:22,200
any signs of something which could be

558
00:26:22,200 --> 00:26:24,480
wrong with the system but we can't find

559
00:26:24,480 --> 00:26:28,350
it so what my guys did they did a memory

560
00:26:28,350 --> 00:26:29,970
dump of the system and then they

561
00:26:29,970 --> 00:26:32,460
searched for those DNS names in memory

562
00:26:32,460 --> 00:26:34,529
they found a process which was issuing

563
00:26:34,529 --> 00:26:37,649
this DNS request and if I was actually a

564
00:26:37,649 --> 00:26:40,559
tool from a company called nets Arang it

565
00:26:40,559 --> 00:26:42,659
was a remote administration tool that

566
00:26:42,659 --> 00:26:45,419
the bank was using across all of their

567
00:26:45,419 --> 00:26:48,570
service and well the first thing they

568
00:26:48,570 --> 00:26:50,820
did they we took this tool we found it

569
00:26:50,820 --> 00:26:53,669
the code was issuing the DNS request was

570
00:26:53,669 --> 00:26:56,549
in a dll inside these nets around

571
00:26:56,549 --> 00:26:59,970
software so we looked and we are trying

572
00:26:59,970 --> 00:27:02,039
to understand why the software behaves

573
00:27:02,039 --> 00:27:05,009
in this way and there was a kind of a

574
00:27:05,009 --> 00:27:07,379
bailout that was encrypted so you were

575
00:27:07,379 --> 00:27:09,330
wondering if this like isn't maybe the

576
00:27:09,330 --> 00:27:11,399
normal behavior of the tool that it has

577
00:27:11,399 --> 00:27:14,309
this payload inside but later we

578
00:27:14,309 --> 00:27:17,700
discovered that this encrypted blob only

579
00:27:17,700 --> 00:27:19,919
appeared in the last version of nets

580
00:27:19,919 --> 00:27:21,840
around which the bank installed like a

581
00:27:21,840 --> 00:27:24,269
week ago so we got in touch with Nets

582
00:27:24,269 --> 00:27:26,489
Arang they discover that they have been

583
00:27:26,489 --> 00:27:28,739
compromised and they have been used in a

584
00:27:28,739 --> 00:27:31,590
supply chain attack and it's amazing you

585
00:27:31,590 --> 00:27:34,279
know how this offered which is used by

586
00:27:34,279 --> 00:27:38,249
fortune 500 companies was used as an you

587
00:27:38,249 --> 00:27:41,220
know entry vector into all these high

588
00:27:41,220 --> 00:27:42,720
profile entities like financial

589
00:27:42,720 --> 00:27:45,389
institutions and so on so we used our

590
00:27:45,389 --> 00:27:47,129
system we're trying to understand who

591
00:27:47,129 --> 00:27:48,509
was behind this attack

592
00:27:48,509 --> 00:27:51,059
so we used our system on the code from

593
00:27:51,059 --> 00:27:53,850
the Nets Arang incident and we actually

594
00:27:53,850 --> 00:27:56,309
discovered that it's similar to

595
00:27:56,309 --> 00:27:59,039
something called poison plug used by a

596
00:27:59,039 --> 00:28:04,289
Wynn nti subset group actually a few

597
00:28:04,289 --> 00:28:08,549
hackers from the Wynn nti apt how we

598
00:28:08,549 --> 00:28:11,100
call them in 2014 were just indictment

599
00:28:11,100 --> 00:28:12,809
indicted by the

600
00:28:12,809 --> 00:28:15,539
FBI I think maybe was just two days ago

601
00:28:15,539 --> 00:28:17,789
and it's funny that the names and the

602
00:28:17,789 --> 00:28:19,589
Alice's of one of the guys from the

603
00:28:19,589 --> 00:28:22,259
indictment appears in our research paper

604
00:28:22,259 --> 00:28:24,059
from 2014

605
00:28:24,059 --> 00:28:26,699
so our system like immediately found

606
00:28:26,699 --> 00:28:29,729
this overlap with the sample used by an

607
00:28:29,729 --> 00:28:33,059
apt known as barium if you google barium

608
00:28:33,059 --> 00:28:36,089
you'll find a few mentions of them like

609
00:28:36,089 --> 00:28:38,849
they've been responsible for a number of

610
00:28:38,849 --> 00:28:42,149
high-profile breaches into one of them

611
00:28:42,149 --> 00:28:45,359
which is maybe more known publicly was

612
00:28:45,359 --> 00:28:48,299
the breach in two T's and croup where

613
00:28:48,299 --> 00:28:50,869
they tried to steal some submarine

614
00:28:50,869 --> 00:28:53,369
schematics so if you're wondering

615
00:28:53,369 --> 00:28:56,399
exactly what the code does it's actually

616
00:28:56,399 --> 00:28:58,799
a function they used to calculate hashes

617
00:28:58,799 --> 00:29:04,559
of api's so we immediately assume that

618
00:29:04,559 --> 00:29:06,839
this shadow parenting was related to

619
00:29:06,839 --> 00:29:10,949
these guys another interesting case was

620
00:29:10,949 --> 00:29:13,709
the ccleaner incident which was another

621
00:29:13,709 --> 00:29:15,659
very big supply chain attack actually it

622
00:29:15,659 --> 00:29:17,669
was much bigger than the net sarang

623
00:29:17,669 --> 00:29:20,519
compromised because there's about 20

624
00:29:20,519 --> 00:29:23,159
million users of ccleaner so like one

625
00:29:23,159 --> 00:29:27,089
day a piece of code appears in ccleaner

626
00:29:27,089 --> 00:29:29,339
you know magically which does the kind

627
00:29:29,339 --> 00:29:31,409
of shady things and all the people who

628
00:29:31,409 --> 00:29:33,359
have sickling are installed they get the

629
00:29:33,359 --> 00:29:35,659
update and the malicious code obviously

630
00:29:35,659 --> 00:29:39,449
reaches out to the cnc and tries to do

631
00:29:39,449 --> 00:29:40,199
bad things

632
00:29:40,199 --> 00:29:42,389
so again we use our system to check

633
00:29:42,389 --> 00:29:44,999
what's that and we immediately found a

634
00:29:44,999 --> 00:29:48,569
custom base64 encoding subroutine inside

635
00:29:48,569 --> 00:29:52,069
the ccleaner code and an older sample

636
00:29:52,069 --> 00:29:55,859
called a knight known as missile from an

637
00:29:55,859 --> 00:29:59,279
apt group known as a PT 17 I guess the

638
00:29:59,279 --> 00:30:02,399
most significant attack from a PT 17 is

639
00:30:02,399 --> 00:30:06,179
your aura hack which I think it made

640
00:30:06,179 --> 00:30:08,069
Google pull out of China a couple of

641
00:30:08,069 --> 00:30:11,969
years ago here now they're going back so

642
00:30:11,969 --> 00:30:13,529
I immediately you know I put it on

643
00:30:13,529 --> 00:30:14,940
Twitter that we think that this is

644
00:30:14,940 --> 00:30:18,359
related to this axiom apt and it's quite

645
00:30:18,359 --> 00:30:20,309
interesting that in taser the Israeli

646
00:30:20,309 --> 00:30:22,469
company I mentioned they immediately

647
00:30:22,469 --> 00:30:24,959
posted pretty much the same thing that

648
00:30:24,959 --> 00:30:25,770
their technology

649
00:30:25,770 --> 00:30:30,110
also thinks that it's related to a PT 17

650
00:30:30,110 --> 00:30:34,680
so what we did actually using this yarra

651
00:30:34,680 --> 00:30:37,200
rule generated from the ccleaner we ran

652
00:30:37,200 --> 00:30:40,050
it on our collection and it fit it hit

653
00:30:40,050 --> 00:30:42,410
the number of samples known as missile

654
00:30:42,410 --> 00:30:46,740
socks PNG and hiked it so as we were

655
00:30:46,740 --> 00:30:48,750
looking at this we are quite familiar

656
00:30:48,750 --> 00:30:52,080
with all these samples and actually

657
00:30:52,080 --> 00:30:55,110
there's an amazing presentation about

658
00:30:55,110 --> 00:30:58,050
this missile and actually missile is a

659
00:30:58,050 --> 00:31:00,060
hacker name is a hacker alias

660
00:31:00,060 --> 00:31:05,910
and this guy missile well there's a very

661
00:31:05,910 --> 00:31:08,100
very good presentation now from Chris

662
00:31:08,100 --> 00:31:10,830
McConkey at PwC you can find it on

663
00:31:10,830 --> 00:31:14,370
YouTube and he talks like about the

664
00:31:14,370 --> 00:31:17,250
methods he used to identify this guy so

665
00:31:17,250 --> 00:31:19,230
he was able to find his name pretty much

666
00:31:19,230 --> 00:31:19,890
everything

667
00:31:19,890 --> 00:31:24,600
and if we look into the Nevada report on

668
00:31:24,600 --> 00:31:27,720
this group and Nevada published one of

669
00:31:27,720 --> 00:31:30,270
the best reports about this apt group

670
00:31:30,270 --> 00:31:32,310
they actually said that some of the

671
00:31:32,310 --> 00:31:36,450
tools such as Docs PNG Grasim and hi

672
00:31:36,450 --> 00:31:38,610
Keith they're actually only used by

673
00:31:38,610 --> 00:31:44,910
axiom and our belief was actually the

674
00:31:44,910 --> 00:31:48,210
guy who build these tools for axiom is

675
00:31:48,210 --> 00:31:50,520
also somehow connected to the ccleaner

676
00:31:50,520 --> 00:31:53,130
incident and later we were even able to

677
00:31:53,130 --> 00:31:55,410
connect the ccleaner and the shadow per

678
00:31:55,410 --> 00:31:57,720
incidence together suggesting that the

679
00:31:57,720 --> 00:32:01,080
same group was responsible for both this

680
00:32:01,080 --> 00:32:04,950
supply chain attacks so here's another

681
00:32:04,950 --> 00:32:08,040
example when actually this fails it's

682
00:32:08,040 --> 00:32:10,620
very nice when it works out but what do

683
00:32:10,620 --> 00:32:15,150
we do when it feels so the olympic

684
00:32:15,150 --> 00:32:17,160
destroyer attack which i guess some

685
00:32:17,160 --> 00:32:20,460
people remember at the during the

686
00:32:20,460 --> 00:32:23,940
Olympic Games in Pyeongchang in South

687
00:32:23,940 --> 00:32:26,580
Korea there was like a significant

688
00:32:26,580 --> 00:32:29,040
destructive attack which took down like

689
00:32:29,040 --> 00:32:30,780
some of the infrastructure they were

690
00:32:30,780 --> 00:32:35,280
using and the first thing that we saw in

691
00:32:35,280 --> 00:32:37,530
taser the same company they published a

692
00:32:37,530 --> 00:32:39,450
blog and they said they found

693
00:32:39,450 --> 00:32:41,519
similarities between Olympic destroyer

694
00:32:41,519 --> 00:32:44,789
and apt tan which is a Chinese apt group

695
00:32:44,789 --> 00:32:48,840
apt 3 which is another Chinese apt group

696
00:32:48,840 --> 00:32:52,320
an apt 12 another Chinese apt group so

697
00:32:52,320 --> 00:32:54,539
people immediately assume all right so

698
00:32:54,539 --> 00:32:57,779
probably the Chinese again but then

699
00:32:57,779 --> 00:33:01,159
recorded future which is another company

700
00:33:01,159 --> 00:33:03,690
working on this kind of code similarity

701
00:33:03,690 --> 00:33:06,389
technologies they posted quite a large

702
00:33:06,389 --> 00:33:09,539
analysis of that and this that it's

703
00:33:09,539 --> 00:33:11,760
actually similar to Lazarus Lazarus

704
00:33:11,760 --> 00:33:15,299
being a North Korean apt so we have one

705
00:33:15,299 --> 00:33:16,710
company saying is Chinese we have

706
00:33:16,710 --> 00:33:18,630
another company saying it's North Korean

707
00:33:18,630 --> 00:33:22,380
so what is it so actually if we look at

708
00:33:22,380 --> 00:33:26,820
the code and we have a la Souris blue

709
00:33:26,820 --> 00:33:28,950
nor of tool on the left side on the

710
00:33:28,950 --> 00:33:31,769
right side we have a olympic destroyer -

711
00:33:31,769 --> 00:33:35,820
there's actually some similarity they're

712
00:33:35,820 --> 00:33:39,059
not identical but there's for sure like

713
00:33:39,059 --> 00:33:41,700
a similarity in the code so nobody can

714
00:33:41,700 --> 00:33:45,330
actually contest that they are similar

715
00:33:45,330 --> 00:33:48,899
in a way so what we did when we saw this

716
00:33:48,899 --> 00:33:50,789
we ran our code the similarity

717
00:33:50,789 --> 00:33:52,559
technology and we're very disappointed

718
00:33:52,559 --> 00:33:55,169
that it didn't find similarities with

719
00:33:55,169 --> 00:33:58,529
Chinese groups it didn't find any code

720
00:33:58,529 --> 00:34:00,539
similarities with North Korean groups

721
00:34:00,539 --> 00:34:04,380
however it was quite interesting that it

722
00:34:04,380 --> 00:34:07,470
was able to find a small tiny similarity

723
00:34:07,470 --> 00:34:11,730
with a Lazarus apt sample that was used

724
00:34:11,730 --> 00:34:15,449
during the Bangladesh bank heist so how

725
00:34:15,449 --> 00:34:16,829
many people are familiar with the

726
00:34:16,829 --> 00:34:20,760
bangladesh bank heist alright so this

727
00:34:20,760 --> 00:34:23,879
sample actually had a and our system

728
00:34:23,879 --> 00:34:25,500
pointed out that there is like this

729
00:34:25,500 --> 00:34:28,379
fragment which is exactly the same

730
00:34:28,379 --> 00:34:31,280
between the olympic destroyer and this

731
00:34:31,280 --> 00:34:35,300
bangladesh bank heist attack and the

732
00:34:35,300 --> 00:34:38,159
code sequence there well it's not

733
00:34:38,159 --> 00:34:39,810
actually a code sequence but the byte

734
00:34:39,810 --> 00:34:42,349
sequence is exactly that one there so

735
00:34:42,349 --> 00:34:45,389
what is it there is actually the so

736
00:34:45,389 --> 00:34:47,429
called the rich header so whenever you

737
00:34:47,429 --> 00:34:50,099
compile a file using visual studio they

738
00:34:50,099 --> 00:34:52,300
embed like watermark

739
00:34:52,300 --> 00:34:56,080
right a Philly grin of the compiler and

740
00:34:56,080 --> 00:34:58,870
the tools which are used to build that

741
00:34:58,870 --> 00:35:02,740
sample into the header so when we saw

742
00:35:02,740 --> 00:35:04,930
this like what's the chance that across

743
00:35:04,930 --> 00:35:08,140
the several billion samples that we have

744
00:35:08,140 --> 00:35:11,230
we have only two with this unique

745
00:35:11,230 --> 00:35:13,920
combination and one of them is from the

746
00:35:13,920 --> 00:35:16,180
olympic destroyer attack the other one

747
00:35:16,180 --> 00:35:17,380
was in bangladesh

748
00:35:17,380 --> 00:35:20,470
so like the probability is absolutely

749
00:35:20,470 --> 00:35:23,260
huge that the same guys are behind the

750
00:35:23,260 --> 00:35:26,020
attack however something didn't kind of

751
00:35:26,020 --> 00:35:29,170
you know pan out and the trick here was

752
00:35:29,170 --> 00:35:31,060
when we started looking in depth at

753
00:35:31,060 --> 00:35:33,730
olympic destroyer we realized that the

754
00:35:33,730 --> 00:35:36,370
rich header didn't actually match the

755
00:35:36,370 --> 00:35:39,250
version of the compiler based on the

756
00:35:39,250 --> 00:35:41,530
code in the sample so it almost looked

757
00:35:41,530 --> 00:35:43,630
like someone actually copied the rich

758
00:35:43,630 --> 00:35:46,750
header from the bangladesh bank heist

759
00:35:46,750 --> 00:35:49,060
attack and put it into these new samples

760
00:35:49,060 --> 00:35:54,220
as a very elaborate false flag so what's

761
00:35:54,220 --> 00:35:55,600
interesting is that our technology

762
00:35:55,600 --> 00:35:57,850
didn't find any similarities but it did

763
00:35:57,850 --> 00:36:03,400
spot this header you know false flag and

764
00:36:03,400 --> 00:36:05,440
we are now actually confident that the

765
00:36:05,440 --> 00:36:07,930
olympic destroyer was not related to

766
00:36:07,930 --> 00:36:09,880
lazarus and was not related to any

767
00:36:09,880 --> 00:36:12,100
chinese apt was related to a

768
00:36:12,100 --> 00:36:14,440
russian-speaking hacker group we call

769
00:36:14,440 --> 00:36:18,910
hades the same group believed to be

770
00:36:18,910 --> 00:36:21,820
responsible for the not petia bed rabbit

771
00:36:21,820 --> 00:36:25,120
and ukraine power outages a couple of

772
00:36:25,120 --> 00:36:28,720
years ago so a few other examples here's

773
00:36:28,720 --> 00:36:32,020
a wanna cry rule a yarra rule that you

774
00:36:32,020 --> 00:36:33,610
build on wanna cry we built on you honor

775
00:36:33,610 --> 00:36:36,190
on wanna cry using our system it's just

776
00:36:36,190 --> 00:36:38,710
five strings it's like oh all that is to

777
00:36:38,710 --> 00:36:40,450
the rule just five sequence of lights

778
00:36:40,450 --> 00:36:43,450
but it actually catches blue nor off the

779
00:36:43,450 --> 00:36:45,820
malware used in the bangladesh bank

780
00:36:45,820 --> 00:36:47,700
heist manuscript which is another

781
00:36:47,700 --> 00:36:50,500
malware used by the lazarus group to

782
00:36:50,500 --> 00:36:52,990
hack into banks and de cafe which is a

783
00:36:52,990 --> 00:36:55,660
keylogger that was also used by the

784
00:36:55,660 --> 00:36:58,090
lazarus apt group so it's like a very

785
00:36:58,090 --> 00:37:02,050
you know strong link now we can actually

786
00:37:02,050 --> 00:37:04,859
link wanna cry with all these other two

787
00:37:04,859 --> 00:37:08,700
as well so this actually makes me

788
00:37:08,700 --> 00:37:10,979
believe that probably we are kind of

789
00:37:10,979 --> 00:37:13,859
reaching a point where we can start

790
00:37:13,859 --> 00:37:15,859
talking about the so called attribution

791
00:37:15,859 --> 00:37:18,359
2.0 so what does it mean

792
00:37:18,359 --> 00:37:24,289
well I think that tasks which took

793
00:37:24,289 --> 00:37:28,019
months before or years can now actually

794
00:37:28,019 --> 00:37:30,869
be done in minutes so in the past it

795
00:37:30,869 --> 00:37:32,459
used you know to take us a couple of

796
00:37:32,459 --> 00:37:35,519
months to be able to say which apt group

797
00:37:35,519 --> 00:37:38,369
is behind which attack and all this you

798
00:37:38,369 --> 00:37:41,819
know can now be automated I believe that

799
00:37:41,819 --> 00:37:43,890
this technology actually you know it

800
00:37:43,890 --> 00:37:45,900
will become ubiquitous in a couple of

801
00:37:45,900 --> 00:37:48,599
years everybody will have it for sure so

802
00:37:48,599 --> 00:37:52,440
what that means is that at least some

803
00:37:52,440 --> 00:37:56,249
part of the attribution of attacks can

804
00:37:56,249 --> 00:37:59,249
now be automated so it can give us like

805
00:37:59,249 --> 00:38:01,170
if you need to look into this direction

806
00:38:01,170 --> 00:38:03,569
so that's like some new incident with

807
00:38:03,569 --> 00:38:05,789
malware and this is like especially

808
00:38:05,789 --> 00:38:07,859
interesting for companies when you let's

809
00:38:07,859 --> 00:38:10,019
say you catch an email and you know this

810
00:38:10,019 --> 00:38:12,630
email drop some hour is it targeted is

811
00:38:12,630 --> 00:38:14,849
it an apt group is it for you

812
00:38:14,849 --> 00:38:15,839
specifically

813
00:38:15,839 --> 00:38:18,329
or is it like maybe for 5,000 other

814
00:38:18,329 --> 00:38:20,789
companies are you the only target of

815
00:38:20,789 --> 00:38:22,859
that attack so this can be of course

816
00:38:22,859 --> 00:38:24,989
partly automated with the right

817
00:38:24,989 --> 00:38:27,359
technology on the other hand I think

818
00:38:27,359 --> 00:38:30,119
this as an effect will have you know

819
00:38:30,119 --> 00:38:32,339
we'll go we'll have to see more

820
00:38:32,339 --> 00:38:34,440
false-flag so think about this

821
00:38:34,440 --> 00:38:37,140
Lazarus malware it was quite interesting

822
00:38:37,140 --> 00:38:41,660
that after the Bangladesh Bank heist and

823
00:38:41,660 --> 00:38:46,410
I think it was around April of 2017 the

824
00:38:46,410 --> 00:38:50,459
NSA made a statement saying that they

825
00:38:50,459 --> 00:38:54,180
believe that the Lazarus apt group is

826
00:38:54,180 --> 00:38:57,739
behind the bangladesh bank heist and

827
00:38:57,739 --> 00:39:01,019
almost immediately the Lazarus guys they

828
00:39:01,019 --> 00:39:03,509
started including Russian keywords in

829
00:39:03,509 --> 00:39:05,609
their malware you know just because I

830
00:39:05,609 --> 00:39:08,009
guess it's fashionable to blame Russia

831
00:39:08,009 --> 00:39:11,699
for hacks nowadays you obviously didn't

832
00:39:11,699 --> 00:39:14,009
fool anyone like just having some poorly

833
00:39:14,009 --> 00:39:15,420
written Russian words in the malware

834
00:39:15,420 --> 00:39:17,799
dozen full people

835
00:39:17,799 --> 00:39:21,049
this can be you know it can lead to more

836
00:39:21,049 --> 00:39:23,390
sophisticated kind of false flex like we

837
00:39:23,390 --> 00:39:25,670
have seen in the Olympic destroyer where

838
00:39:25,670 --> 00:39:27,650
they try to copy the rich header and

839
00:39:27,650 --> 00:39:29,539
there aren't many companies which

840
00:39:29,539 --> 00:39:32,210
actually can support this kind of false

841
00:39:32,210 --> 00:39:34,400
Flags remember people have said that

842
00:39:34,400 --> 00:39:36,500
it's maybe China it's maybe North

843
00:39:36,500 --> 00:39:40,609
Koreans and you know so on so I think as

844
00:39:40,609 --> 00:39:43,690
an effect also we're gonna see more

845
00:39:43,690 --> 00:39:46,190
reliance on open source tools and this

846
00:39:46,190 --> 00:39:48,559
is like kind of a nightmare when all the

847
00:39:48,559 --> 00:39:50,390
hackers they start using you know power

848
00:39:50,390 --> 00:39:54,289
sploit COBOL strike Metasploit like good

849
00:39:54,289 --> 00:39:56,599
luck determining who is behind that

850
00:39:56,599 --> 00:39:58,970
because being just open source tools it

851
00:39:58,970 --> 00:40:00,769
means that you cannot attribute it by

852
00:40:00,769 --> 00:40:04,160
code to any specific apt group it will

853
00:40:04,160 --> 00:40:05,900
be you know pretty much it can be used

854
00:40:05,900 --> 00:40:08,539
by by anyone so that is when things will

855
00:40:08,539 --> 00:40:10,960
get complicated and you'll have to use

856
00:40:10,960 --> 00:40:15,289
stuff such as I guess the network

857
00:40:15,289 --> 00:40:16,759
infrastructure command and control

858
00:40:16,759 --> 00:40:19,640
servers to find connections between the

859
00:40:19,640 --> 00:40:26,059
groups so I think that you know one last

860
00:40:26,059 --> 00:40:28,549
thing which I wanted to mention I think

861
00:40:28,549 --> 00:40:32,480
that actually we as a security community

862
00:40:32,480 --> 00:40:35,569
we're doing quite a good job looking

863
00:40:35,569 --> 00:40:38,630
into cyber espionage campaigns caching

864
00:40:38,630 --> 00:40:41,319
apt groups we're pretty good actually

865
00:40:41,319 --> 00:40:44,630
with cyber sabotage destructive attacks

866
00:40:44,630 --> 00:40:47,180
because both of them they rely on

867
00:40:47,180 --> 00:40:47,900
malware

868
00:40:47,900 --> 00:40:50,119
however there's probably another

869
00:40:50,119 --> 00:40:53,329
dimension to this problem like Dean for

870
00:40:53,329 --> 00:40:55,819
the information war and I guess that

871
00:40:55,819 --> 00:41:00,140
problem is mass opinion manipulation we

872
00:41:00,140 --> 00:41:03,170
are not very good at spotting preventing

873
00:41:03,170 --> 00:41:05,299
and teaching people on how to recognize

874
00:41:05,299 --> 00:41:08,299
mass opinion manipulation and here I

875
00:41:08,299 --> 00:41:10,940
think that we as a community can do more

876
00:41:10,940 --> 00:41:13,910
we can try to use our skills and

877
00:41:13,910 --> 00:41:16,640
knowledge in order to fight this kind of

878
00:41:16,640 --> 00:41:20,170
attacks and to make people aware of

879
00:41:20,170 --> 00:41:22,369
manipulation basically and the fact that

880
00:41:22,369 --> 00:41:24,500
they are being used one of the most

881
00:41:24,500 --> 00:41:26,990
common question is you know from my

882
00:41:26,990 --> 00:41:28,549
friend they say I have nothing on my

883
00:41:28,549 --> 00:41:30,930
computer I just use Facebook

884
00:41:30,930 --> 00:41:32,819
even if I get hit by malware there's

885
00:41:32,819 --> 00:41:35,460
nothing you know they can't steal

886
00:41:35,460 --> 00:41:37,380
anything from my computer but

887
00:41:37,380 --> 00:41:39,839
information you know things the way you

888
00:41:39,839 --> 00:41:42,900
think the way you know you behave all

889
00:41:42,900 --> 00:41:44,869
this information it can actually be

890
00:41:44,869 --> 00:41:47,359
profiled and then it can be used to

891
00:41:47,359 --> 00:41:50,280
manipulate you so I think that if we

892
00:41:50,280 --> 00:41:53,880
fail to do that it can actually cost us

893
00:41:53,880 --> 00:41:57,359
our democracy and eventually it can cost

894
00:41:57,359 --> 00:42:01,050
us our freedom so leave you with that

895
00:42:01,050 --> 00:42:04,020
thought thank you very much I hope this

896
00:42:04,020 --> 00:42:05,140
was interesting

897
00:42:05,140 --> 00:42:07,770
[Applause]

898
00:42:07,770 --> 00:42:21,729
[Music]

