1
00:00:00,000 --> 00:00:06,240
cool cool tests shiny all right so this

2
00:00:04,290 --> 00:00:08,220
item sells color creme strike is a

3
00:00:06,240 --> 00:00:10,019
senior security researcher now share

4
00:00:08,220 --> 00:00:11,460
which is a public alternative in

5
00:00:10,019 --> 00:00:14,790
virustotal which is free for people who

6
00:00:11,460 --> 00:00:17,010
do Mauer analysis and project 25 for 99

7
00:00:14,790 --> 00:00:19,680
and the RIT own a project my contact

8
00:00:17,010 --> 00:00:20,699
information is below and before we get

9
00:00:19,680 --> 00:00:24,090
started I'm actually going to make a

10
00:00:20,699 --> 00:00:25,170
quick note about attribution just

11
00:00:24,090 --> 00:00:26,730
because the term is been slightly

12
00:00:25,170 --> 00:00:28,859
misused lately and I just want to

13
00:00:26,730 --> 00:00:30,390
clarify before I get started and just

14
00:00:28,859 --> 00:00:31,470
write this plate on professionalist of

15
00:00:30,390 --> 00:00:33,630
it I'm actually gonna directly quote

16
00:00:31,470 --> 00:00:34,800
Wikipedia on this in social psychology

17
00:00:33,630 --> 00:00:36,270
attributions the process by which

18
00:00:34,800 --> 00:00:38,760
individuals explain the causes and

19
00:00:36,270 --> 00:00:41,010
behavior of events the causes and

20
00:00:38,760 --> 00:00:42,570
behavior of events attribution theory is

21
00:00:41,010 --> 00:00:45,149
the study of models to explain these

22
00:00:42,570 --> 00:00:46,379
processes so when I mentioned something

23
00:00:45,149 --> 00:00:48,660
some things today and if I say something

24
00:00:46,379 --> 00:00:51,390
is from China it's not necessarily to

25
00:00:48,660 --> 00:00:53,578
say a boogeyman in a corner it's to say

26
00:00:51,390 --> 00:00:55,620
based on the things we see and the

27
00:00:53,579 --> 00:00:57,420
motivation that we believe is behind

28
00:00:55,620 --> 00:00:59,788
something we attribute you to this

29
00:00:57,420 --> 00:01:01,770
country and things like that as well so

30
00:00:59,789 --> 00:01:05,309
and by understanding to who we can

31
00:01:01,770 --> 00:01:06,570
understand the why and vice versa so as

32
00:01:05,309 --> 00:01:09,298
well if you have any questions feel free

33
00:01:06,570 --> 00:01:11,658
to shout out I talk fast and if I skip

34
00:01:09,299 --> 00:01:14,340
over something please let me know so

35
00:01:11,659 --> 00:01:15,540
today we're talking about an adversary

36
00:01:14,340 --> 00:01:19,110
that Craig has been tracking for some

37
00:01:15,540 --> 00:01:20,280
time that we call Gotha panda is

38
00:01:19,110 --> 00:01:22,500
definitely one of the more advanced

39
00:01:20,280 --> 00:01:25,170
adversaries that we track we believe

40
00:01:22,500 --> 00:01:26,880
they're Chinese in origin the big

41
00:01:25,170 --> 00:01:28,680
hallmark that we've seen with them is a

42
00:01:26,880 --> 00:01:31,798
piece of malware or remote access trojan

43
00:01:28,680 --> 00:01:33,390
that we call purpie in any of the cases

44
00:01:31,799 --> 00:01:35,520
that we've seen purpo used it usually is

45
00:01:33,390 --> 00:01:37,860
predicated by the use of zero-day

46
00:01:35,520 --> 00:01:39,560
exploits in an Internet Explorer usually

47
00:01:37,860 --> 00:01:41,820
these are use after free vulnerabilities

48
00:01:39,560 --> 00:01:44,070
taking advantage of sort of deprecated

49
00:01:41,820 --> 00:01:46,320
scripting languages that Microsoft is

50
00:01:44,070 --> 00:01:47,490
phasing out and this group has been seen

51
00:01:46,320 --> 00:01:50,220
hitting everybody from governments

52
00:01:47,490 --> 00:01:53,579
financial organizations research groups

53
00:01:50,220 --> 00:01:54,929
higher education and some of the other

54
00:01:53,579 --> 00:01:57,000
researchers track this group as

55
00:01:54,930 --> 00:01:58,070
clandestine Fox which I believe is

56
00:01:57,000 --> 00:02:01,829
fireEye

57
00:01:58,070 --> 00:02:07,919
ups / P team and Dell SecureWorks tracks

58
00:02:01,829 --> 00:02:09,000
it is T G 0 1 1 0 so in order to

59
00:02:07,920 --> 00:02:10,590
understand the group starting from an

60
00:02:09,000 --> 00:02:12,720
external perspective it's always good to

61
00:02:10,590 --> 00:02:13,879
look at the malware first so the marker

62
00:02:12,720 --> 00:02:16,140
P

63
00:02:13,879 --> 00:02:18,569
Microsoft if you go by the generic TV

64
00:02:16,140 --> 00:02:22,379
name it's you know win32 per P gen a and

65
00:02:18,569 --> 00:02:25,018
there's gen a through D this is a little

66
00:02:22,379 --> 00:02:27,780
tough for read Sarita is a severe piece

67
00:02:25,019 --> 00:02:31,200
of malware they say it was first seen on

68
00:02:27,780 --> 00:02:33,629
you know tax day of 2011 from my

69
00:02:31,200 --> 00:02:36,359
research it dates back to 2009 in its

70
00:02:33,629 --> 00:02:37,980
first usages and even possibly before

71
00:02:36,360 --> 00:02:39,860
that based on another piece of malware

72
00:02:37,980 --> 00:02:42,149
which I'm gonna cover in a minute

73
00:02:39,860 --> 00:02:44,549
there's some speculative reports that

74
00:02:42,150 --> 00:02:48,209
say goes back to 2006 2005 but that's

75
00:02:44,549 --> 00:02:50,010
unsubstantiated at this time since it's

76
00:02:48,209 --> 00:02:51,690
used in 2009 it's gone undergone

77
00:02:50,010 --> 00:02:55,019
numerous changes to both control

78
00:02:51,690 --> 00:02:57,709
protocols analysis or anti analysis

79
00:02:55,019 --> 00:02:59,849
features and some functionality as well

80
00:02:57,709 --> 00:03:02,310
it communicates with control servers

81
00:02:59,849 --> 00:03:05,459
through HTTP requests so standard no web

82
00:03:02,310 --> 00:03:07,049
protocols and one of the most key

83
00:03:05,459 --> 00:03:08,400
characteristics that people focus on and

84
00:03:07,049 --> 00:03:10,409
I've always looked at for what I'm

85
00:03:08,400 --> 00:03:12,180
looking at slower is a unique string

86
00:03:10,409 --> 00:03:14,069
encryption methodology that it uses in

87
00:03:12,180 --> 00:03:16,230
order to to hide sensitive information

88
00:03:14,069 --> 00:03:20,369
so when they have things like control

89
00:03:16,230 --> 00:03:22,078
servers and esperan paths these are

90
00:03:20,370 --> 00:03:28,169
actually encrypted and retrieved using a

91
00:03:22,079 --> 00:03:30,540
string index identifier so when I said

92
00:03:28,169 --> 00:03:32,099
that malware goes back to 2007 it's

93
00:03:30,540 --> 00:03:34,078
based on a malware called dream click or

94
00:03:32,099 --> 00:03:37,108
dream on is something aged again for the

95
00:03:34,079 --> 00:03:40,440
antivirus vendors call it Chinese ever

96
00:03:37,109 --> 00:03:42,690
malware when when you're infected with

97
00:03:40,440 --> 00:03:44,760
it what happens is an area Explorer it

98
00:03:42,690 --> 00:03:47,280
will inject JavaScript into each of the

99
00:03:44,760 --> 00:03:49,260
pages you visit ideally this is probably

100
00:03:47,280 --> 00:03:52,160
to do something like push pop-ups on

101
00:03:49,260 --> 00:03:54,328
people or redirect them to other sites

102
00:03:52,160 --> 00:03:55,500
not necessarily the type of thing you'd

103
00:03:54,329 --> 00:03:58,680
see in sort of a you know a targeted

104
00:03:55,500 --> 00:04:00,060
espionage campaign a very limited sample

105
00:03:58,680 --> 00:04:02,400
base there was I think I've only ever

106
00:04:00,060 --> 00:04:05,549
found four samples of it and even there

107
00:04:02,400 --> 00:04:07,319
I found four control servers just like

108
00:04:05,549 --> 00:04:10,169
Burpee communicates using HTTP requests

109
00:04:07,319 --> 00:04:13,138
and the biggest overlap the two overlaps

110
00:04:10,169 --> 00:04:14,340
are is the OS fingerprinting which if

111
00:04:13,139 --> 00:04:16,228
you look at it denied of Pro it's

112
00:04:14,340 --> 00:04:17,430
one-to-one identical there's no actual

113
00:04:16,228 --> 00:04:19,589
difference but I felt like it was kind

114
00:04:17,430 --> 00:04:21,449
of a weak link but the strong link is

115
00:04:19,589 --> 00:04:24,409
this this really unique string encoding

116
00:04:21,449 --> 00:04:27,170
methodology as I said before

117
00:04:24,409 --> 00:04:28,700
fairly limited samples I only found

118
00:04:27,170 --> 00:04:29,780
three or four control domains and when I

119
00:04:28,700 --> 00:04:32,570
actually started looking at this I think

120
00:04:29,780 --> 00:04:34,340
in 2013 all of the domains had expired

121
00:04:32,570 --> 00:04:35,780
so somebody had you know been running

122
00:04:34,340 --> 00:04:37,280
this this malware for a while

123
00:04:35,780 --> 00:04:38,989
decided that they didn't feel like

124
00:04:37,280 --> 00:04:41,030
paying the bills anymore to the hosting

125
00:04:38,990 --> 00:04:45,410
or the domain registrar and loved the

126
00:04:41,030 --> 00:04:47,539
remaining expire so like any rational

127
00:04:45,410 --> 00:04:52,730
person I've registered the domains and

128
00:04:47,540 --> 00:04:54,230
sync hold them in the time that I think

129
00:04:52,730 --> 00:04:54,590
the year or two years which I owned the

130
00:04:54,230 --> 00:04:57,200
domains

131
00:04:54,590 --> 00:04:59,510
I only saw about 50 unique victims that

132
00:04:57,200 --> 00:05:01,219
were total plenty of malware sandbox is

133
00:04:59,510 --> 00:05:03,380
running the samples just seeing what the

134
00:05:01,220 --> 00:05:05,030
malware does but it was only about 50

135
00:05:03,380 --> 00:05:06,860
infected hosts which when you're looking

136
00:05:05,030 --> 00:05:08,270
in the scale like targeted campaigns 50

137
00:05:06,860 --> 00:05:11,480
is an OK number because you know that's

138
00:05:08,270 --> 00:05:13,130
a pretty small base when you look at

139
00:05:11,480 --> 00:05:15,410
like criminal malware in a sinkhole you

140
00:05:13,130 --> 00:05:16,430
see thousands of victims but so 50 was

141
00:05:15,410 --> 00:05:17,720
like okay maybe this is something

142
00:05:16,430 --> 00:05:19,280
targeted but when you start looking at

143
00:05:17,720 --> 00:05:21,680
the victims at the you know individual

144
00:05:19,280 --> 00:05:25,520
level these are residential IP addresses

145
00:05:21,680 --> 00:05:27,350
small companies not something you'd be

146
00:05:25,520 --> 00:05:28,490
expecting so I've generally come to the

147
00:05:27,350 --> 00:05:29,870
conclusion that this is something kind

148
00:05:28,490 --> 00:05:33,020
of criminal in nature and not

149
00:05:29,870 --> 00:05:37,070
necessarily a the full-featured you know

150
00:05:33,020 --> 00:05:39,349
espionage malware that at purpie is so

151
00:05:37,070 --> 00:05:41,150
over time this malware if we start with

152
00:05:39,350 --> 00:05:43,160
dream on as the original code base for

153
00:05:41,150 --> 00:05:45,440
it evolved into what I call per P

154
00:05:43,160 --> 00:05:48,230
classic which is a the general road

155
00:05:45,440 --> 00:05:50,360
access trojan from there there was a

156
00:05:48,230 --> 00:05:53,420
lite version which acts as a dropper for

157
00:05:50,360 --> 00:05:55,340
it and then there's newer versions which

158
00:05:53,420 --> 00:05:57,700
started appearing in 2013 which include

159
00:05:55,340 --> 00:06:00,020
/ p2 which has updated control protocols

160
00:05:57,700 --> 00:06:02,860
/ P CLI which I'm gonna talk about a

161
00:06:00,020 --> 00:06:05,750
minute and in recent months there's been

162
00:06:02,860 --> 00:06:08,090
perfect 3 which has additional more anti

163
00:06:05,750 --> 00:06:09,410
debugging anti analysis stuff as well as

164
00:06:08,090 --> 00:06:11,599
some post exploitation tools and the

165
00:06:09,410 --> 00:06:13,790
biggest thing with all of this is they

166
00:06:11,600 --> 00:06:15,140
all share several code overlaps in the

167
00:06:13,790 --> 00:06:18,890
most important one being this string

168
00:06:15,140 --> 00:06:19,969
encryption methodology here's the

169
00:06:18,890 --> 00:06:21,560
breakdown of what I just said

170
00:06:19,970 --> 00:06:24,170
so purview light usually acts as a

171
00:06:21,560 --> 00:06:25,730
dropper but the one I'm talking about

172
00:06:24,170 --> 00:06:28,700
quickly is the post exploitation tools

173
00:06:25,730 --> 00:06:31,280
so I've been told actually mini cats has

174
00:06:28,700 --> 00:06:35,450
been packaged by this group into its own

175
00:06:31,280 --> 00:06:37,099
custom little PE file still same PE same

176
00:06:35,450 --> 00:06:40,150
string encryption is used to to hide

177
00:06:37,100 --> 00:06:40,150
sensitive strings

178
00:06:41,710 --> 00:06:46,010
you think so when should thousand in one

179
00:06:45,020 --> 00:06:47,840
of the campaign's that they were running

180
00:06:46,010 --> 00:06:50,420
in which they were leveraging a inter

181
00:06:47,840 --> 00:06:52,400
Explorer zero day when you actually were

182
00:06:50,420 --> 00:06:54,860
infected by and exploited by the

183
00:06:52,400 --> 00:06:57,140
vulnerability you'd see purpie light

184
00:06:54,860 --> 00:06:58,490
dropped which would then unpack her pv2

185
00:06:57,140 --> 00:07:00,740
and perfect classic and the idea behind

186
00:06:58,490 --> 00:07:02,360
this was it was likely so that if one of

187
00:07:00,740 --> 00:07:04,670
the implants failed to run or was

188
00:07:02,360 --> 00:07:07,490
detected by a V they'd be guaranteed a

189
00:07:04,670 --> 00:07:10,070
foothold initially because of one of the

190
00:07:07,490 --> 00:07:11,210
implants and both of these were

191
00:07:10,070 --> 00:07:13,700
configured with different control

192
00:07:11,210 --> 00:07:14,900
servers so that so that even if network

193
00:07:13,700 --> 00:07:17,440
controls were blocking it they'd still

194
00:07:14,900 --> 00:07:21,260
have a better chance of gaining access

195
00:07:17,440 --> 00:07:23,150
so for PC Li or command line or face I

196
00:07:21,260 --> 00:07:24,800
really really like this is a really

197
00:07:23,150 --> 00:07:26,330
nifty tool it's generally the same

198
00:07:24,800 --> 00:07:28,160
malware there's not a lot of changes but

199
00:07:26,330 --> 00:07:29,960
what they did was instead of embedding

200
00:07:28,160 --> 00:07:32,660
control information so if you've done

201
00:07:29,960 --> 00:07:33,890
our analysis before you'll know that you

202
00:07:32,660 --> 00:07:35,780
know somewhere within the file will be

203
00:07:33,890 --> 00:07:38,150
you know the domain or the IP address

204
00:07:35,780 --> 00:07:39,409
and I was going to connect out to so

205
00:07:38,150 --> 00:07:41,840
rather than doing that they changed the

206
00:07:39,410 --> 00:07:43,130
idea so instead of working like that in

207
00:07:41,840 --> 00:07:46,429
order to run the power you actually have

208
00:07:43,130 --> 00:07:47,570
to statically say here's the IP address

209
00:07:46,430 --> 00:07:50,480
you're going to connect to here's the

210
00:07:47,570 --> 00:07:51,560
port and here's the c2 key or the key

211
00:07:50,480 --> 00:07:54,800
that you need to be able to authenticate

212
00:07:51,560 --> 00:07:57,020
with the control server and this

213
00:07:54,800 --> 00:07:58,850
actually makes analysis much more

214
00:07:57,020 --> 00:08:01,130
difficult to a degree for researchers

215
00:07:58,850 --> 00:08:05,240
because control server information isn't

216
00:08:01,130 --> 00:08:07,070
isn't embedded in the file so when

217
00:08:05,240 --> 00:08:09,050
you're doing instant response and you

218
00:08:07,070 --> 00:08:11,360
find the file running and you pull it

219
00:08:09,050 --> 00:08:13,580
off great but you still don't have

220
00:08:11,360 --> 00:08:15,620
things like domains IP addresses that

221
00:08:13,580 --> 00:08:18,020
are being to active server keys and

222
00:08:15,620 --> 00:08:20,540
things like that so a lot of information

223
00:08:18,020 --> 00:08:25,789
is lost by simply shifting the where

224
00:08:20,540 --> 00:08:27,260
that control information is placed one

225
00:08:25,790 --> 00:08:28,370
of the other advantages to this as well

226
00:08:27,260 --> 00:08:29,900
as I've started believing that this is

227
00:08:28,370 --> 00:08:31,190
being used once in average the adversary

228
00:08:29,900 --> 00:08:32,840
is actually in the network so he's

229
00:08:31,190 --> 00:08:34,730
actually already begun post exploitation

230
00:08:32,840 --> 00:08:37,460
is already pivoting through the network

231
00:08:34,730 --> 00:08:38,870
and has anybody ever tried to already

232
00:08:37,460 --> 00:08:40,340
been like four or five hosts into like a

233
00:08:38,870 --> 00:08:44,030
pen test say and had to push down a new

234
00:08:40,340 --> 00:08:45,140
like PE file it's fairly difficult it's

235
00:08:44,030 --> 00:08:48,380
not something you can just copy and

236
00:08:45,140 --> 00:08:49,670
paste in most cases so what happens is

237
00:08:48,380 --> 00:08:52,350
if they're there within a network it can

238
00:08:49,670 --> 00:08:54,030
be speculated that if during their post

239
00:08:52,350 --> 00:08:55,560
exploitation they encounter you know say

240
00:08:54,030 --> 00:08:57,480
situation which they're being blocked

241
00:08:55,560 --> 00:08:58,890
maybe the domain gets blocked they're

242
00:08:57,480 --> 00:09:01,290
connecting to an IP address is blocked

243
00:08:58,890 --> 00:09:03,270
by a firewall rather than recompile a

244
00:09:01,290 --> 00:09:05,280
new binary they can simply remove the

245
00:09:03,270 --> 00:09:07,020
configuration push a new one down and

246
00:09:05,280 --> 00:09:11,220
have a better chance of being able to

247
00:09:07,020 --> 00:09:12,090
expel data from the network moving a

248
00:09:11,220 --> 00:09:18,120
little quickly example have any

249
00:09:12,090 --> 00:09:19,860
questions all right so April 2014 was

250
00:09:18,120 --> 00:09:25,260
sort of the the last massive campaign

251
00:09:19,860 --> 00:09:26,850
that people saw publicly I mentioned to

252
00:09:25,260 --> 00:09:29,010
you before the the phishing email that

253
00:09:26,850 --> 00:09:30,410
they had this was a phishing message

254
00:09:29,010 --> 00:09:33,170
that was actually sent out to a

255
00:09:30,410 --> 00:09:37,110
non-government organization mailing list

256
00:09:33,170 --> 00:09:38,610
very clean very professional and a lot

257
00:09:37,110 --> 00:09:40,710
of sort of clunky phishing messages that

258
00:09:38,610 --> 00:09:41,910
everybody gets you know there's there's

259
00:09:40,710 --> 00:09:45,630
blatant things that you can look for

260
00:09:41,910 --> 00:09:46,860
their spelling errors there's there's

261
00:09:45,630 --> 00:09:49,410
time frames that don't make any sense

262
00:09:46,860 --> 00:09:54,570
poor as this one was sent out on April

263
00:09:49,410 --> 00:09:56,640
25th of 2014 calendar invitations for an

264
00:09:54,570 --> 00:09:59,060
event on May 18 so it's timely it's

265
00:09:56,640 --> 00:09:59,060
relevant

266
00:10:00,380 --> 00:10:04,500
it doesn't share a lot of the hallmarks

267
00:10:02,580 --> 00:10:06,120
of traditional fishing so it's something

268
00:10:04,500 --> 00:10:09,660
in EVE despite its simplistic nature

269
00:10:06,120 --> 00:10:10,890
it's well crafted and and the tells

270
00:10:09,660 --> 00:10:14,400
users you know previous submit a

271
00:10:10,890 --> 00:10:16,350
calendar entry here's a link submit them

272
00:10:14,400 --> 00:10:17,699
on this webpage and actually for being a

273
00:10:16,350 --> 00:10:19,530
calendar submission the domain they used

274
00:10:17,700 --> 00:10:23,120
with Sweeney photos so it's even

275
00:10:19,530 --> 00:10:26,130
relevant at the at the domain level so

276
00:10:23,120 --> 00:10:28,380
this was sent out April 25th

277
00:10:26,130 --> 00:10:32,400
it triggers a vulnerability for CVE 2014

278
00:10:28,380 --> 00:10:34,020
1776 and actually the following week

279
00:10:32,400 --> 00:10:34,980
Microsoft issued a patch for out-of-band

280
00:10:34,020 --> 00:10:38,699
because it was such a severe

281
00:10:34,980 --> 00:10:40,650
vulnerability so the domain I mentioned

282
00:10:38,700 --> 00:10:42,630
Sweeney Sweeney photos com is actually

283
00:10:40,650 --> 00:10:43,949
out of Pennsylvania I called the guy up

284
00:10:42,630 --> 00:10:45,480
who's in the Whois information and asked

285
00:10:43,950 --> 00:10:46,950
him and he said you know hey I'd like to

286
00:10:45,480 --> 00:10:48,450
talk to about your domain yeah you know

287
00:10:46,950 --> 00:10:49,770
explain the situation to him said hey

288
00:10:48,450 --> 00:10:51,630
I'm saying this used in you know a

289
00:10:49,770 --> 00:10:52,470
series of phishing campaigns and I'd

290
00:10:51,630 --> 00:10:54,660
like to talk to him gets more

291
00:10:52,470 --> 00:10:57,330
information so I gave him what I had and

292
00:10:54,660 --> 00:10:58,560
I never heard back unfortunately like

293
00:10:57,330 --> 00:10:59,850
I'd really love to have seen some of the

294
00:10:58,560 --> 00:11:01,170
stuff he has on the site to see if he

295
00:10:59,850 --> 00:11:03,090
had any files left over from the

296
00:11:01,170 --> 00:11:03,620
adversary but it looks like at this time

297
00:11:03,090 --> 00:11:05,240
that's passed

298
00:11:03,620 --> 00:11:06,470
but what we can learn for this is that

299
00:11:05,240 --> 00:11:07,820
they're probably using compromised

300
00:11:06,470 --> 00:11:10,460
infrastructures so when they're running

301
00:11:07,820 --> 00:11:11,720
a campaign there's probably a period of

302
00:11:10,460 --> 00:11:15,110
time beforehand in which they're popping

303
00:11:11,720 --> 00:11:16,160
boxes that they know likely are related

304
00:11:15,110 --> 00:11:18,860
to what they're gonna run the campaign

305
00:11:16,160 --> 00:11:20,390
about targeting infrastructure within

306
00:11:18,860 --> 00:11:21,470
the u.s. that way if you're blocking

307
00:11:20,390 --> 00:11:23,600
saying you know I'm gonna block

308
00:11:21,470 --> 00:11:26,750
everything problem you know country X Y

309
00:11:23,600 --> 00:11:33,050
Z it's likely you're still gonna trust

310
00:11:26,750 --> 00:11:34,310
that host in the US so CB 2014 1776 the

311
00:11:33,050 --> 00:11:36,500
way they have it set up is that when a

312
00:11:34,310 --> 00:11:38,959
user hits the landing page loads a

313
00:11:36,500 --> 00:11:40,190
javascript file which does a check for

314
00:11:38,960 --> 00:11:41,180
an internet explorer because if you're

315
00:11:40,190 --> 00:11:43,250
not running into Explorer you're not

316
00:11:41,180 --> 00:11:45,529
gonna be vulnerable it then opens up a

317
00:11:43,250 --> 00:11:47,660
flash file flash file does another check

318
00:11:45,529 --> 00:11:49,939
for Internet explorer hands control back

319
00:11:47,660 --> 00:11:52,069
to the javascript file which does a heap

320
00:11:49,940 --> 00:11:53,660
spray and then returns control of the

321
00:11:52,070 --> 00:11:55,820
flash file which sets up the conditions

322
00:11:53,660 --> 00:11:59,779
for actual exploitation it delivers the

323
00:11:55,820 --> 00:12:01,190
final shellcode payload what was

324
00:11:59,779 --> 00:12:02,779
interesting is the versions of ie

325
00:12:01,190 --> 00:12:05,510
they're checked are actually different

326
00:12:02,779 --> 00:12:07,250
so what's been happening is in the 2013

327
00:12:05,510 --> 00:12:09,170
campaign that they ran they were

328
00:12:07,250 --> 00:12:10,550
actually using the same files but

329
00:12:09,170 --> 00:12:13,969
they've just slightly modified them for

330
00:12:10,550 --> 00:12:16,939
2014 so the important thing with this is

331
00:12:13,970 --> 00:12:18,529
it's likely that they're the reason the

332
00:12:16,940 --> 00:12:24,920
same tool set if probably because they

333
00:12:18,529 --> 00:12:26,570
it's a small well-crafted group and

334
00:12:24,920 --> 00:12:29,990
actually the the final payload that's

335
00:12:26,570 --> 00:12:33,920
delivered from them from the exploit is

336
00:12:29,990 --> 00:12:36,800
actually just a Jif file does anybody

337
00:12:33,920 --> 00:12:40,010
play half-life Gordon Freeman alright

338
00:12:36,800 --> 00:12:43,099
yeah so it's just a simple chip file but

339
00:12:40,010 --> 00:12:44,420
when you apply a hex 75 X or encoding

340
00:12:43,100 --> 00:12:46,640
you find that there's actually a full PE

341
00:12:44,420 --> 00:12:48,199
file within the legit file which is

342
00:12:46,640 --> 00:12:50,600
what's deployed and that's actually a

343
00:12:48,200 --> 00:12:52,430
copy of per p3 which is sort of the

344
00:12:50,600 --> 00:12:57,200
latest version that's been deployed as a

345
00:12:52,430 --> 00:12:59,120
first stage implant by this group so

346
00:12:57,200 --> 00:13:00,350
let's talk about attribution and what we

347
00:12:59,120 --> 00:13:04,900
actually think about this group and we

348
00:13:00,350 --> 00:13:04,900
believe it is behind this group

349
00:13:05,170 --> 00:13:09,449
so generally we consider this an

350
00:13:07,660 --> 00:13:14,049
advanced adversary and this is based on

351
00:13:09,449 --> 00:13:15,719
use of zero day exploits if you're if

352
00:13:14,049 --> 00:13:18,160
you're running a say a commodity

353
00:13:15,720 --> 00:13:19,809
criminal enterprise with a one of the

354
00:13:18,160 --> 00:13:21,309
common exploit kits you're not

355
00:13:19,809 --> 00:13:23,499
necessarily developing your own exploits

356
00:13:21,309 --> 00:13:24,790
you're you're providing it using things

357
00:13:23,499 --> 00:13:26,709
that are already out there already

358
00:13:24,790 --> 00:13:28,389
possibly commercially available I mean

359
00:13:26,709 --> 00:13:30,099
maybe even in some cases privately

360
00:13:28,389 --> 00:13:31,959
available but for this group

361
00:13:30,100 --> 00:13:33,519
these are exploits that are likely

362
00:13:31,959 --> 00:13:36,219
develop either in-house or purchased

363
00:13:33,519 --> 00:13:38,999
prior of usage and are not known before

364
00:13:36,220 --> 00:13:41,019
the campaigns

365
00:13:38,999 --> 00:13:42,970
additionally they use a unique piece of

366
00:13:41,019 --> 00:13:45,339
malware this isn't used anywhere else

367
00:13:42,970 --> 00:13:46,749
things like Zeus you can go out and pick

368
00:13:45,339 --> 00:13:48,209
up on github actually now I think

369
00:13:46,749 --> 00:13:50,230
there's a copy floating around on there

370
00:13:48,209 --> 00:13:51,309
so there's actually a skill level

371
00:13:50,230 --> 00:13:54,759
required so they have to have both

372
00:13:51,309 --> 00:13:57,579
development of our development skills

373
00:13:54,759 --> 00:13:58,749
they have exploit development skills and

374
00:13:57,579 --> 00:14:00,128
over time they've even made it so that

375
00:13:58,749 --> 00:14:02,980
the malware is even more difficult to

376
00:14:00,129 --> 00:14:04,689
analyze so in cases there's some in the

377
00:14:02,980 --> 00:14:06,399
early versions there's very basic things

378
00:14:04,689 --> 00:14:08,079
so for people who've done Bower

379
00:14:06,399 --> 00:14:09,939
sandboxing and behavioral analysis

380
00:14:08,079 --> 00:14:11,829
usually what happens is you'll run a

381
00:14:09,939 --> 00:14:13,269
piece of Bower and a safe environment or

382
00:14:11,829 --> 00:14:15,279
say for about five minutes and record

383
00:14:13,269 --> 00:14:17,230
any changes so to evade this they

384
00:14:15,279 --> 00:14:17,769
started including things like sleep for

385
00:14:17,230 --> 00:14:20,470
thirty minutes

386
00:14:17,769 --> 00:14:21,999
well that may seem really basic it makes

387
00:14:20,470 --> 00:14:23,410
it so that for the for the bulk

388
00:14:21,999 --> 00:14:26,139
processing of malware that a lot of

389
00:14:23,410 --> 00:14:28,360
people do you miss this and it's just a

390
00:14:26,139 --> 00:14:30,879
file that you know it ran but it didn't

391
00:14:28,360 --> 00:14:32,019
do anything so over time though they've

392
00:14:30,879 --> 00:14:36,879
said it so that they'll do things like

393
00:14:32,019 --> 00:14:38,589
basic VM detection and things so that if

394
00:14:36,879 --> 00:14:40,749
you will put it in in tools like Ida Pro

395
00:14:38,589 --> 00:14:42,009
or Olli debug it's just gonna make your

396
00:14:40,749 --> 00:14:44,230
life incredibly difficult to pick

397
00:14:42,009 --> 00:14:45,579
through it and as well the things like

398
00:14:44,230 --> 00:14:48,329
the string encoding make it so that just

399
00:14:45,579 --> 00:14:50,559
basic tools like strings don't produce

400
00:14:48,329 --> 00:14:52,089
really unique things that you can pull

401
00:14:50,559 --> 00:14:58,809
out without doing full fledged our

402
00:14:52,089 --> 00:15:00,669
analysis on it the the big bear in the

403
00:14:58,809 --> 00:15:02,709
corner of this being it's likely Chinese

404
00:15:00,669 --> 00:15:05,189
in origin and and I say this kind of

405
00:15:02,709 --> 00:15:07,118
slightly when you look at cream click

406
00:15:05,189 --> 00:15:09,099
definitely Chinese piece of malware all

407
00:15:07,119 --> 00:15:10,959
the control domains are with Whois

408
00:15:09,100 --> 00:15:14,189
information they all link to a location

409
00:15:10,959 --> 00:15:14,189
in the financial district of beijing

410
00:15:14,699 --> 00:15:18,209
mainly the victims are Chinese so it was

411
00:15:17,110 --> 00:15:21,480
likely you know

412
00:15:18,209 --> 00:15:22,979
criminal group in China doing this when

413
00:15:21,480 --> 00:15:24,499
you could be the PE you language

414
00:15:22,980 --> 00:15:26,730
resources as well they're all Chinese

415
00:15:24,499 --> 00:15:28,410
with purpie there's still a couple that

416
00:15:26,730 --> 00:15:30,509
have that that Chinese language that

417
00:15:28,410 --> 00:15:31,980
first that says you know the person that

418
00:15:30,509 --> 00:15:35,309
compiled this file is using the Chinese

419
00:15:31,980 --> 00:15:36,600
language set if you also look at the

420
00:15:35,309 --> 00:15:41,269
phishing messages they all have a

421
00:15:36,600 --> 00:15:43,889
timestamp for the the timezone offset is

422
00:15:41,269 --> 00:15:47,129
Chinese Standard Time as well so these

423
00:15:43,889 --> 00:15:48,749
are your not conclusive links but they

424
00:15:47,129 --> 00:15:50,670
are things that paint a picture of it

425
00:15:48,749 --> 00:15:56,519
likely being an adversary based in the

426
00:15:50,670 --> 00:15:58,378
the People's Republic of China so the

427
00:15:56,519 --> 00:16:00,119
one of the big conclusions that I have

428
00:15:58,379 --> 00:16:00,990
definitely have about this group is I

429
00:16:00,119 --> 00:16:03,119
actually believe they're working as a

430
00:16:00,990 --> 00:16:05,100
contract service so if people who study

431
00:16:03,119 --> 00:16:07,170
Chinese intelligence in the past it's

432
00:16:05,100 --> 00:16:08,339
not quite how it works in the u.s. it's

433
00:16:07,170 --> 00:16:09,959
a little bit more outsourced there's a

434
00:16:08,339 --> 00:16:12,899
lot of different groups doing this on

435
00:16:09,959 --> 00:16:15,540
behalf of the Chinese government with

436
00:16:12,899 --> 00:16:16,829
this group if dreamin was an adware

437
00:16:15,540 --> 00:16:19,230
malware that they were selling for ad

438
00:16:16,829 --> 00:16:21,540
clicking or pop-up banner or affiliate

439
00:16:19,230 --> 00:16:23,730
programs it's usually the financially

440
00:16:21,540 --> 00:16:25,889
driven thing and seeing that now or

441
00:16:23,730 --> 00:16:28,559
evolved from seeing the malware they're

442
00:16:25,889 --> 00:16:32,699
using evolved from a simple ad worm hour

443
00:16:28,559 --> 00:16:34,679
to an espionage tool it's likely that

444
00:16:32,699 --> 00:16:36,118
while the the tools to may have changed

445
00:16:34,679 --> 00:16:37,829
the actual motivations may have stayed

446
00:16:36,119 --> 00:16:40,679
the same and they may be operating this

447
00:16:37,829 --> 00:16:42,329
this as a financial thing as well when

448
00:16:40,679 --> 00:16:43,980
you start to see really broad targeting

449
00:16:42,329 --> 00:16:46,888
of things like governments and higher

450
00:16:43,980 --> 00:16:49,799
education banking activists things like

451
00:16:46,889 --> 00:16:52,559
that it's definitely possible that

452
00:16:49,799 --> 00:16:53,999
they're they're they're soliciting their

453
00:16:52,559 --> 00:16:55,649
services to people who are willing to

454
00:16:53,999 --> 00:16:59,100
say you know we need information on

455
00:16:55,649 --> 00:17:00,389
these groups and performing that I also

456
00:16:59,100 --> 00:17:02,069
believe it's a fairly small group of

457
00:17:00,389 --> 00:17:04,559
people I don't believe that it's a large

458
00:17:02,069 --> 00:17:07,740
team originally I believe it was one

459
00:17:04,559 --> 00:17:09,049
person and I have a quick anecdotal

460
00:17:07,740 --> 00:17:11,010
story about that in a second

461
00:17:09,049 --> 00:17:12,750
when I originally researched I thought

462
00:17:11,010 --> 00:17:14,549
it was one person I believe that the

463
00:17:12,750 --> 00:17:16,230
development and it all kind of fit that

464
00:17:14,549 --> 00:17:18,480
it might be a single person who's cared

465
00:17:16,230 --> 00:17:19,799
for this now over time another thing

466
00:17:18,480 --> 00:17:21,270
that they have is sort of what I

467
00:17:19,799 --> 00:17:24,000
consider like a unique knowledge

468
00:17:21,270 --> 00:17:25,079
management system so that from some of

469
00:17:24,000 --> 00:17:26,970
the stories that I've been told by

470
00:17:25,079 --> 00:17:27,990
instant responders is that when they've

471
00:17:26,970 --> 00:17:29,430
been in a network and they've been

472
00:17:27,990 --> 00:17:31,320
pushed off and they come back

473
00:17:29,430 --> 00:17:32,910
even a year later they'll try and do

474
00:17:31,320 --> 00:17:34,080
ping checks for hosts that they know

475
00:17:32,910 --> 00:17:35,970
about on the network without doing any

476
00:17:34,080 --> 00:17:37,679
you know and map scanning or some of the

477
00:17:35,970 --> 00:17:39,630
the wide and constants that they deduce

478
00:17:37,680 --> 00:17:41,310
they know even a year out you know we

479
00:17:39,630 --> 00:17:43,020
know that we touched this host last time

480
00:17:41,310 --> 00:17:44,850
I want to see if that's online I mean

481
00:17:43,020 --> 00:17:46,980
this could be basic checking to say you

482
00:17:44,850 --> 00:17:48,840
know where am I on the network or am I

483
00:17:46,980 --> 00:17:52,410
in some sort of sandbox so they do those

484
00:17:48,840 --> 00:17:53,490
checks back to the single operator 30

485
00:17:52,410 --> 00:17:55,710
per second there was a story I heard

486
00:17:53,490 --> 00:17:58,470
from a fellow researcher who told me

487
00:17:55,710 --> 00:18:00,300
that when they were dealing with the

488
00:17:58,470 --> 00:18:01,620
adversary or if they were doing a

489
00:18:00,300 --> 00:18:04,370
man-in-the-middle screen capture and

490
00:18:01,620 --> 00:18:07,110
there's a fantastic presentation from

491
00:18:04,370 --> 00:18:08,340
context IQ I think it is where they do a

492
00:18:07,110 --> 00:18:09,659
presentation to show how they were

493
00:18:08,340 --> 00:18:11,330
actually man in the middling the remote

494
00:18:09,660 --> 00:18:13,200
desktop session for the SATA cursory

495
00:18:11,330 --> 00:18:15,179
highly recommended it's a black hat

496
00:18:13,200 --> 00:18:16,860
video and what happens is when you watch

497
00:18:15,180 --> 00:18:18,690
the adversary work on a system that they

498
00:18:16,860 --> 00:18:19,979
have access to it's incredibly clean

499
00:18:18,690 --> 00:18:22,650
they know what they're doing

500
00:18:19,980 --> 00:18:24,360
there this is something they've done

501
00:18:22,650 --> 00:18:27,120
numerous times and when they make a

502
00:18:24,360 --> 00:18:28,919
mistake and one of the screen casts they

503
00:18:27,120 --> 00:18:30,719
showed the adversary triggered something

504
00:18:28,920 --> 00:18:32,490
which instantly said that you know pop

505
00:18:30,720 --> 00:18:33,510
up with such a popped up a message and

506
00:18:32,490 --> 00:18:35,280
said you know system needs to reboot

507
00:18:33,510 --> 00:18:37,020
there's been a critical error didn't

508
00:18:35,280 --> 00:18:38,610
panic they remove the tools that they

509
00:18:37,020 --> 00:18:40,170
had they removed the configurations they

510
00:18:38,610 --> 00:18:41,969
remove there but other back doors and

511
00:18:40,170 --> 00:18:45,210
they rebooted the box they didn't panic

512
00:18:41,970 --> 00:18:46,500
they were very Swift about it there was

513
00:18:45,210 --> 00:18:48,690
a counter story I heard that a few

514
00:18:46,500 --> 00:18:50,130
months ago where the adversary was on

515
00:18:48,690 --> 00:18:52,050
the network and they were bumbling the

516
00:18:50,130 --> 00:18:54,270
usage of their tool they couldn't get

517
00:18:52,050 --> 00:18:54,810
the command-line syntax right for per PC

518
00:18:54,270 --> 00:18:57,360
Li

519
00:18:54,810 --> 00:18:59,760
they were they were miss clicking files

520
00:18:57,360 --> 00:19:02,699
and it just wasn't the wasn't what they

521
00:18:59,760 --> 00:19:04,890
people have come to expect and the exact

522
00:19:02,700 --> 00:19:07,050
line that they used was come on man

523
00:19:04,890 --> 00:19:08,310
you're better than this you're better

524
00:19:07,050 --> 00:19:09,540
than this and for what an incident

525
00:19:08,310 --> 00:19:13,830
responder says that I just couldn't help

526
00:19:09,540 --> 00:19:16,200
but laugh about it and finally they've

527
00:19:13,830 --> 00:19:17,580
got a very static modulus operon D there

528
00:19:16,200 --> 00:19:19,080
they're always using the same tools

529
00:19:17,580 --> 00:19:21,210
they've reused things they've evolved

530
00:19:19,080 --> 00:19:22,770
things over time which almost seems like

531
00:19:21,210 --> 00:19:25,980
they have maybe even a limited or set of

532
00:19:22,770 --> 00:19:27,240
resources so they're not they're not

533
00:19:25,980 --> 00:19:29,730
going out they're not buying new pieces

534
00:19:27,240 --> 00:19:31,110
of malware than up not buying five or

535
00:19:29,730 --> 00:19:33,360
six different exploits at a time for

536
00:19:31,110 --> 00:19:35,070
these things it's very singular in

537
00:19:33,360 --> 00:19:36,810
operations they one run kit one campaign

538
00:19:35,070 --> 00:19:39,350
at a time and they're pretty consistent

539
00:19:36,810 --> 00:19:39,350
about that

540
00:19:40,000 --> 00:20:01,220
questions I know I'm a fairly fast

541
00:19:42,740 --> 00:20:02,960
talker yes so the theory that I was

542
00:20:01,220 --> 00:20:04,580
coming down to was that it's possible

543
00:20:02,960 --> 00:20:08,030
that this started as a single person or

544
00:20:04,580 --> 00:20:10,250
a very small team and as they've gotten

545
00:20:08,030 --> 00:20:11,780
larger and as I guess the the industry

546
00:20:10,250 --> 00:20:13,910
has evolved even here in the US with our

547
00:20:11,780 --> 00:20:15,440
security company is getting larger it's

548
00:20:13,910 --> 00:20:17,540
possible they're hiring people now and

549
00:20:15,440 --> 00:20:20,000
they're bringing in new talent and and

550
00:20:17,540 --> 00:20:21,530
putting them into act as operators as

551
00:20:20,000 --> 00:20:23,060
well so that they've got multiple people

552
00:20:21,530 --> 00:20:24,530
and can actually start eventually doing

553
00:20:23,060 --> 00:20:27,409
you know multiple campaigns at the same

554
00:20:24,530 --> 00:20:32,090
time and it's possible that this was a

555
00:20:27,410 --> 00:20:33,590
junior level person as Paul a Dorian

556
00:20:32,090 --> 00:20:34,939
says in the beginning of his podcast you

557
00:20:33,590 --> 00:20:37,310
know give the intern control of the

558
00:20:34,940 --> 00:20:52,160
botnet so that's that's generally my

559
00:20:37,310 --> 00:20:54,080
theory on it any other questions yes so

560
00:20:52,160 --> 00:20:55,640
in an adversary like this there's a lot

561
00:20:54,080 --> 00:20:57,470
of challenges even some of the best

562
00:20:55,640 --> 00:20:58,760
companies that are out there and ones

563
00:20:57,470 --> 00:21:00,470
that have extremely high security

564
00:20:58,760 --> 00:21:05,690
budgets are having problems with this

565
00:21:00,470 --> 00:21:06,980
adversary a lot of times actually in the

566
00:21:05,690 --> 00:21:09,860
things I'm recommending these days are

567
00:21:06,980 --> 00:21:11,450
going back down to or the base because

568
00:21:09,860 --> 00:21:15,290
it's in some cases definitely parameter

569
00:21:11,450 --> 00:21:16,490
controls so the adversary one of the

570
00:21:15,290 --> 00:21:18,620
things that they've implemented since

571
00:21:16,490 --> 00:21:20,060
the very earliest beginning is they can

572
00:21:18,620 --> 00:21:22,070
actually use proxy authentication and

573
00:21:20,060 --> 00:21:23,270
they can meet or basic proxies and proxy

574
00:21:22,070 --> 00:21:25,220
authentication so if you're doing things

575
00:21:23,270 --> 00:21:26,810
like running a network proxy which

576
00:21:25,220 --> 00:21:28,280
requires on education for all your users

577
00:21:26,810 --> 00:21:29,990
you still need to be doing things like

578
00:21:28,280 --> 00:21:32,090
deep packet inspection and analysis of

579
00:21:29,990 --> 00:21:36,590
that traffic despite the the

580
00:21:32,090 --> 00:21:38,649
sophistication of the tool all of the

581
00:21:36,590 --> 00:21:41,480
variants are using things like the HTTP

582
00:21:38,650 --> 00:21:42,500
HTTP protocol so there's still distinct

583
00:21:41,480 --> 00:21:43,700
addition or detection on that and

584
00:21:42,500 --> 00:21:46,970
despite people saying signature section

585
00:21:43,700 --> 00:21:48,800
is dead it still will catch this with

586
00:21:46,970 --> 00:21:50,870
the binary protocol they're using

587
00:21:48,800 --> 00:21:51,889
they've started wrapping it in SSL to

588
00:21:50,870 --> 00:21:52,850
try and block that but if you're doing

589
00:21:51,890 --> 00:21:54,230
things like SSL

590
00:21:52,850 --> 00:21:56,480
affection and SSL termination and

591
00:21:54,230 --> 00:21:58,040
checking this you're gonna catch it as

592
00:21:56,480 --> 00:22:00,740
well so despite a sophistication of

593
00:21:58,040 --> 00:22:02,270
tools they're still using that so I

594
00:22:00,740 --> 00:22:04,910
definitely remember firm definitely

595
00:22:02,270 --> 00:22:06,620
recommend perimeter control and as well

596
00:22:04,910 --> 00:22:08,120
like I said the adversary is fairly

597
00:22:06,620 --> 00:22:10,370
fast-moving they will they run a

598
00:22:08,120 --> 00:22:11,689
campaign the campaign is going to get

599
00:22:10,370 --> 00:22:16,489
caught if it's using one unique enough

600
00:22:11,690 --> 00:22:19,010
exploit so being on top of things when

601
00:22:16,490 --> 00:22:20,300
the new campaign comes out I'm not going

602
00:22:19,010 --> 00:22:21,770
to suggest patching because everybody

603
00:22:20,300 --> 00:22:24,350
knows about patching and it's not

604
00:22:21,770 --> 00:22:25,460
necessarily something that it's not

605
00:22:24,350 --> 00:22:26,540
something possible in this case because

606
00:22:25,460 --> 00:22:29,090
if you're using an exploit that's not

607
00:22:26,540 --> 00:22:31,280
publicly known in Microsoft hasn't even

608
00:22:29,090 --> 00:22:32,870
patched it yet you've got to have ways

609
00:22:31,280 --> 00:22:36,320
to fix that and deal with that so

610
00:22:32,870 --> 00:22:37,790
perimeter controls are always and then

611
00:22:36,320 --> 00:22:40,939
like you could always go with the basics

612
00:22:37,790 --> 00:22:42,590
as well fishing in this case is always

613
00:22:40,940 --> 00:22:51,770
is always something that's gonna happen

614
00:22:42,590 --> 00:22:52,939
so any other questions yes yes

615
00:22:51,770 --> 00:22:55,430
so the exploits that they're using are

616
00:22:52,940 --> 00:22:57,740
only ie so I mean if you're if you're

617
00:22:55,430 --> 00:23:00,110
company-wide not using Internet Explorer

618
00:22:57,740 --> 00:23:01,400
and that's your standard it's going to

619
00:23:00,110 --> 00:23:02,810
negate a bunch of these things

620
00:23:01,400 --> 00:23:05,270
or at the very least it's gonna force

621
00:23:02,810 --> 00:23:06,379
them to do something different and like

622
00:23:05,270 --> 00:23:08,480
I said they've got a fairly static

623
00:23:06,380 --> 00:23:10,220
modulus operon D if you force them to do

624
00:23:08,480 --> 00:23:11,750
something different that's a good chance

625
00:23:10,220 --> 00:23:13,220
for them to make mistakes it's a good

626
00:23:11,750 --> 00:23:15,080
chance for anyone to make mistakes if

627
00:23:13,220 --> 00:23:16,340
you've gotta do something new it's a way

628
00:23:15,080 --> 00:23:18,560
to open them up to do something in which

629
00:23:16,340 --> 00:23:20,600
they can be detected or it's a way for

630
00:23:18,560 --> 00:23:21,980
them to to allude to another ability

631
00:23:20,600 --> 00:23:23,300
that they may have so if they start

632
00:23:21,980 --> 00:23:25,610
saying using like an actual a kid

633
00:23:23,300 --> 00:23:26,990
something like scan box that's another

634
00:23:25,610 --> 00:23:28,340
way you can start detecting them is if

635
00:23:26,990 --> 00:23:33,920
you if you force them to do something

636
00:23:28,340 --> 00:23:47,179
out of their ordinary Hales oh yes

637
00:23:33,920 --> 00:23:48,140
all right absolutely that's what I

638
00:23:47,180 --> 00:23:51,290
suspect as well

639
00:23:48,140 --> 00:23:52,730
and if you've got a manually configured

640
00:23:51,290 --> 00:23:54,710
on the command line you're gonna have to

641
00:23:52,730 --> 00:23:57,200
be able to it's also implying that

642
00:23:54,710 --> 00:23:58,850
they've they've got a let me start over

643
00:23:57,200 --> 00:23:59,810
on that so it's possible that what's

644
00:23:58,850 --> 00:24:01,939
gonna happen is they're gonna have to

645
00:23:59,810 --> 00:24:03,320
start splitting out teams right like any

646
00:24:01,940 --> 00:24:04,550
organization once you start to get big

647
00:24:03,320 --> 00:24:06,290
enough you have to break down into teams

648
00:24:04,550 --> 00:24:08,060
so we may start to see a time in which

649
00:24:06,290 --> 00:24:10,070
they're using a group of people

650
00:24:08,060 --> 00:24:11,210
dedicated for initial intrusion and then

651
00:24:10,070 --> 00:24:13,220
you start to have other people that are

652
00:24:11,210 --> 00:24:14,930
operating ads as for post exploitation

653
00:24:13,220 --> 00:24:16,250
and doing this post exploitation and

654
00:24:14,930 --> 00:24:20,060
they may be the ones mainly using the

655
00:24:16,250 --> 00:24:23,240
CLI variant with that case where they

656
00:24:20,060 --> 00:24:24,770
were fairly sloppy it was it was such an

657
00:24:23,240 --> 00:24:26,810
absolute difference I highly recommend

658
00:24:24,770 --> 00:24:28,760
the video from magpie because one of the

659
00:24:26,810 --> 00:24:30,950
things they did was they had to move a

660
00:24:28,760 --> 00:24:32,300
PE file across the network which is kind

661
00:24:30,950 --> 00:24:34,210
of a daunting task so what they did was

662
00:24:32,300 --> 00:24:39,800
they basics T 4 encoded the entire thing

663
00:24:34,210 --> 00:24:42,020
pasted it into Outlook Express save it

664
00:24:39,800 --> 00:24:43,700
as like a ML file open it up and then

665
00:24:42,020 --> 00:24:46,190
just save the attachment off of it and

666
00:24:43,700 --> 00:24:47,750
that was the the back door they used so

667
00:24:46,190 --> 00:24:50,660
I mean that's it's a pretty nifty

668
00:24:47,750 --> 00:24:51,800
technique but it's possible that as they

669
00:24:50,660 --> 00:24:53,630
start bringing you new people some of

670
00:24:51,800 --> 00:25:03,370
those techniques may be lost or they may

671
00:24:53,630 --> 00:25:03,370
start to develop new ones so yes sure

672
00:25:12,279 --> 00:25:16,099
so so it's very interesting because

673
00:25:14,779 --> 00:25:18,950
there's a lot of operators who do

674
00:25:16,099 --> 00:25:20,809
operate on a script and it's been seen

675
00:25:18,950 --> 00:25:21,950
pretty regularly where some of the some

676
00:25:20,809 --> 00:25:23,239
of the other adversary groups like they

677
00:25:21,950 --> 00:25:25,459
clearly run through the following steps

678
00:25:23,239 --> 00:25:26,809
in that case in the case of that

679
00:25:25,459 --> 00:25:28,639
operator it seemed a little bit like

680
00:25:26,809 --> 00:25:30,168
they were told what they were supposed

681
00:25:28,639 --> 00:25:31,699
to be doing but it seemed like it wasn't

682
00:25:30,169 --> 00:25:34,190
completely crystal clear and it wasn't

683
00:25:31,700 --> 00:25:35,239
line for line verbatim so a lot of

684
00:25:34,190 --> 00:25:37,339
things with this group have never

685
00:25:35,239 --> 00:25:38,629
appeared that way there have been some

686
00:25:37,339 --> 00:25:40,849
things it looks like they may have some

687
00:25:38,629 --> 00:25:42,589
automated stuff so that once they once

688
00:25:40,849 --> 00:25:43,908
they do land a box they may have a set

689
00:25:42,589 --> 00:25:45,950
of scripts they run just to do like a

690
00:25:43,909 --> 00:25:47,479
quick profile system but once you're in

691
00:25:45,950 --> 00:25:48,589
the post exploitation phase it doesn't

692
00:25:47,479 --> 00:25:50,139
look like that's really an automated

693
00:25:48,589 --> 00:25:57,729
things and it looks like it's almost a

694
00:25:50,139 --> 00:26:00,079
very hands-on approach hey Bo

695
00:25:57,729 --> 00:26:03,279
all right I guess that's it for today

696
00:26:00,079 --> 00:26:03,279
thank you everyone

