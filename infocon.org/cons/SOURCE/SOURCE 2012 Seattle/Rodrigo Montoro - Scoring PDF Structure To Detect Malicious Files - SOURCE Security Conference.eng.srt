1
00:00:06,770 --> 00:00:11,030
and so that's my motivation like

2
00:00:08,780 --> 00:00:12,980
JavaScript was my biggest problem so

3
00:00:11,030 --> 00:00:14,920
that sometimes why it's good to when you

4
00:00:12,980 --> 00:00:17,620
have some crowd

5
00:00:14,920 --> 00:00:21,880
another agent to fix that and so our

6
00:00:17,620 --> 00:00:26,680
agenda here why people use PDF as a

7
00:00:21,880 --> 00:00:28,570
attack vector it's a basic the basic PDF

8
00:00:26,680 --> 00:00:30,400
structure only to point like if you

9
00:00:28,570 --> 00:00:32,680
never see a PDF structure I just try to

10
00:00:30,400 --> 00:00:37,360
show like the basics I'm not going to

11
00:00:32,680 --> 00:00:39,010
get in there and how PDF Oh just point

12
00:00:37,360 --> 00:00:41,980
some tools that we were going to reuse

13
00:00:39,010 --> 00:00:44,769
like to analyze PDF and daily base test

14
00:00:41,980 --> 00:00:47,769
and so here how we score in some

15
00:00:44,769 --> 00:00:53,140
statistic that I have and some place we

16
00:00:47,769 --> 00:00:55,809
could put this research to work so PDF

17
00:00:53,140 --> 00:00:58,390
as attack vector so Adobe header is

18
00:00:55,809 --> 00:01:01,690
everywhere so that's the points like

19
00:00:58,390 --> 00:01:03,250
it's easier to find a Adobe header than

20
00:01:01,690 --> 00:01:05,620
to find our Windows machine because

21
00:01:03,250 --> 00:01:08,560
other weather is Mac OS we have some

22
00:01:05,620 --> 00:01:10,600
header in Linux and all that stuff I

23
00:01:08,560 --> 00:01:12,460
don't know about numbers do you have

24
00:01:10,600 --> 00:01:20,079
numbers about how many millions people

25
00:01:12,460 --> 00:01:27,250
use a dog bill more than a million Wow

26
00:01:20,079 --> 00:01:30,038
so that's why okay so that's why it's

27
00:01:27,250 --> 00:01:33,280
that's a powerful vector like you

28
00:01:30,039 --> 00:01:38,920
probably if you send a PDF to somewhere

29
00:01:33,280 --> 00:01:43,929
it will work so different ways used so

30
00:01:38,920 --> 00:01:46,659
we could try to to to target some adopt

31
00:01:43,929 --> 00:01:48,369
flaws like some 0 days that they're

32
00:01:46,659 --> 00:01:52,119
talking about or some flawed because

33
00:01:48,369 --> 00:01:56,229
people the doesn't update you could use

34
00:01:52,119 --> 00:01:59,979
that a downloader so you have the the

35
00:01:56,229 --> 00:02:02,710
PDF but it has some code inside that

36
00:01:59,979 --> 00:02:06,158
will download the real Mauer so that's

37
00:02:02,710 --> 00:02:08,169
only to getting into the company and the

38
00:02:06,159 --> 00:02:09,640
easy swim able to bypass the first

39
00:02:08,169 --> 00:02:11,589
protection because like download

40
00:02:09,639 --> 00:02:14,640
something is not malicious probably the

41
00:02:11,590 --> 00:02:17,530
antivirus you're not alert for that and

42
00:02:14,640 --> 00:02:20,019
embedded files like Matt Floyd's use a

43
00:02:17,530 --> 00:02:22,170
lot like PDF with some embedded files

44
00:02:20,020 --> 00:02:25,629
like special for flash players

45
00:02:22,170 --> 00:02:28,899
vulnerability or maybe you want to

46
00:02:25,629 --> 00:02:32,500
create something because it's a powerful

47
00:02:28,900 --> 00:02:36,610
a powerful fire format so you could

48
00:02:32,500 --> 00:02:39,549
create a great stuff inside that so well

49
00:02:36,610 --> 00:02:42,970
that's not suppose that not good

50
00:02:39,549 --> 00:02:46,659
but here it's just a verse doto like if

51
00:02:42,970 --> 00:02:48,909
you look right here the PDF humph

52
00:02:46,659 --> 00:02:50,709
the amount of samples we sent to various

53
00:02:48,909 --> 00:02:55,810
Toto so we started to have a lot of

54
00:02:50,709 --> 00:02:59,620
samples those number is not about UNIX

55
00:02:55,810 --> 00:03:02,650
samples but a lot of simples PDF samples

56
00:02:59,620 --> 00:03:05,799
so everybody is trying to use PDF and

57
00:03:02,650 --> 00:03:08,200
PDF most of the time so in Sumer like

58
00:03:05,799 --> 00:03:11,230
just point like we have in our computers

59
00:03:08,200 --> 00:03:14,018
you have a heater probably everybody has

60
00:03:11,230 --> 00:03:17,709
one you could target other flaws as I

61
00:03:14,019 --> 00:03:19,930
told like embedded flash with targets a

62
00:03:17,709 --> 00:03:22,840
Flash Player flaw and some a dog flaws

63
00:03:19,930 --> 00:03:24,310
it's not all about flaws we could use as

64
00:03:22,840 --> 00:03:27,159
downloader you could have a JavaScript

65
00:03:24,310 --> 00:03:29,980
since I'd write all that stuff so that's

66
00:03:27,159 --> 00:03:34,179
the first step so the basic structure

67
00:03:29,980 --> 00:03:37,418
like that's how we we build and we saw

68
00:03:34,180 --> 00:03:39,430
it I'm not getting too much in details

69
00:03:37,419 --> 00:03:41,019
here because I will focus on the the

70
00:03:39,430 --> 00:03:45,579
research itself like I'm just pointing

71
00:03:41,019 --> 00:03:49,000
to the basics so Howard had her think it

72
00:03:45,579 --> 00:03:51,879
is like in summary you have this the

73
00:03:49,000 --> 00:03:54,730
heater you have a lot of objects we have

74
00:03:51,879 --> 00:03:57,280
the cross-reference table trailers and

75
00:03:54,730 --> 00:04:00,760
an end load file like in summary that's

76
00:03:57,280 --> 00:04:03,579
how the PDF things like for for a header

77
00:04:00,760 --> 00:04:06,790
and here is simple that I got from DDR

78
00:04:03,579 --> 00:04:07,660
Stevens website and so we have the

79
00:04:06,790 --> 00:04:11,168
handle

80
00:04:07,660 --> 00:04:13,448
very simple likes here you have some

81
00:04:11,169 --> 00:04:15,940
objects so you have the cross-reference

82
00:04:13,449 --> 00:04:19,380
that points to the offset where the

83
00:04:15,940 --> 00:04:22,780
information is and to keep the the

84
00:04:19,380 --> 00:04:25,630
header faster and that's it that's a

85
00:04:22,780 --> 00:04:28,330
very simple so it's a plain test could

86
00:04:25,630 --> 00:04:32,979
be a plain text file mostly like so

87
00:04:28,330 --> 00:04:36,729
that's a very simple PDF but how it

88
00:04:32,979 --> 00:04:40,090
really really is for malicious like

89
00:04:36,729 --> 00:04:43,000
probably with the F header in the first

90
00:04:40,090 --> 00:04:45,280
beginning finalized is a malicious type

91
00:04:43,000 --> 00:04:47,800
like they could like usually it's

92
00:04:45,280 --> 00:04:50,890
something like if you see here it's

93
00:04:47,800 --> 00:04:53,440
basically something like PDF - and the

94
00:04:50,890 --> 00:04:56,830
version mostly and they could write this

95
00:04:53,440 --> 00:04:59,980
wrong so that's one of the point that I

96
00:04:56,830 --> 00:05:02,440
show that I'm going to score so the PDF

97
00:04:59,980 --> 00:05:07,350
is the malicious type because they could

98
00:05:02,440 --> 00:05:10,810
not type PDF - 1.1 1.0 are not safe here

99
00:05:07,350 --> 00:05:13,330
is a maori library like a province right

100
00:05:10,810 --> 00:05:15,580
here inside the objects you have a lot

101
00:05:13,330 --> 00:05:18,880
of potential ways to do something

102
00:05:15,580 --> 00:05:21,099
malicious but that's how the mowers and

103
00:05:18,880 --> 00:05:22,690
here more typos because mostly they

104
00:05:21,100 --> 00:05:24,790
don't need those information they're

105
00:05:22,690 --> 00:05:26,860
like it will work if you create the

106
00:05:24,790 --> 00:05:31,840
objects in the right way is to mostly be

107
00:05:26,860 --> 00:05:33,580
handled by the adobe so here's the same

108
00:05:31,840 --> 00:05:37,000
like here is nothing he's probably

109
00:05:33,580 --> 00:05:41,550
problem plus a javascript api we have a

110
00:05:37,000 --> 00:05:45,040
JavaScript API inside the PDF so that's

111
00:05:41,550 --> 00:05:47,500
that's why another reason that they use

112
00:05:45,040 --> 00:05:50,440
too much the PDF and here it's not

113
00:05:47,500 --> 00:05:53,080
financed to nothing like for malicious

114
00:05:50,440 --> 00:05:57,400
propose and so how we analyze PDFs today

115
00:05:53,080 --> 00:05:59,380
so yeah a bunch of tools do you guys

116
00:05:57,400 --> 00:06:02,880
work with PDF daily and others do you

117
00:05:59,380 --> 00:06:07,300
reward you analyzed malicious PDF or not

118
00:06:02,880 --> 00:06:10,300
no that's okay so I have PDF ad in PDF

119
00:06:07,300 --> 00:06:12,910
parser we have the organ PDF framework

120
00:06:10,300 --> 00:06:15,970
it's Ruby if you are web developer you

121
00:06:12,910 --> 00:06:21,040
could use to render two-hander and parse

122
00:06:15,970 --> 00:06:22,540
PDFs help it PDF JSF back online and the

123
00:06:21,040 --> 00:06:26,740
comment line version and have some

124
00:06:22,540 --> 00:06:28,660
online tools like we check PDF x-ray we

125
00:06:26,740 --> 00:06:30,880
have a Razorback that they have some

126
00:06:28,660 --> 00:06:33,640
they do some analysis from source file

127
00:06:30,880 --> 00:06:36,820
it's and we have a lot of others to

128
00:06:33,640 --> 00:06:40,539
light so here here we're start my

129
00:06:36,820 --> 00:06:44,320
research with the PDF ID like when you

130
00:06:40,540 --> 00:06:48,250
you type PDF ID it's a it's a tool from

131
00:06:44,320 --> 00:06:50,500
the Jerry Steven against a PDF file it

132
00:06:48,250 --> 00:06:53,320
will print something like this basic

133
00:06:50,500 --> 00:06:56,050
like if you have the same numbers of

134
00:06:53,320 --> 00:06:56,620
objects and and objects if you have

135
00:06:56,050 --> 00:06:59,320
string

136
00:06:56,620 --> 00:07:02,620
answering like if you're building a a

137
00:06:59,320 --> 00:07:06,460
PDF if you start object you need to have

138
00:07:02,620 --> 00:07:08,950
an end object right in each clause so I

139
00:07:06,460 --> 00:07:12,250
have cross reference so we have a number

140
00:07:08,950 --> 00:07:15,960
of page if they are using Krypton object

141
00:07:12,250 --> 00:07:19,510
string JavaScript JavaScript open action

142
00:07:15,960 --> 00:07:21,219
Aquafarm J big to the cold rich media

143
00:07:19,510 --> 00:07:23,860
like if you have flash player embedded

144
00:07:21,220 --> 00:07:28,150
to have rich media if you haven't batted

145
00:07:23,860 --> 00:07:31,630
files like it could have a PDF with off

146
00:07:28,150 --> 00:07:36,609
the document embedded and so to chop to

147
00:07:31,630 --> 00:07:39,700
target off the floor not the so embed a

148
00:07:36,610 --> 00:07:42,880
file you are trying to bypass protection

149
00:07:39,700 --> 00:07:45,729
because if the the protection does open

150
00:07:42,880 --> 00:07:48,540
the PDF and hander the embedded file

151
00:07:45,730 --> 00:07:52,720
chew and analyze both separate like

152
00:07:48,540 --> 00:07:56,560
looking all the PDFs not malicious so

153
00:07:52,720 --> 00:08:00,460
that's a bunch information so man that's

154
00:07:56,560 --> 00:08:04,450
well that's unreadable anyway right so

155
00:08:00,460 --> 00:08:07,060
this PDF parser and he's this stuff like

156
00:08:04,450 --> 00:08:10,479
you probably could not read but anyway

157
00:08:07,060 --> 00:08:13,750
you not going to read it's the gem

158
00:08:10,480 --> 00:08:15,910
script a piece of JavaScript like that's

159
00:08:13,750 --> 00:08:20,500
something insane all right you cannot

160
00:08:15,910 --> 00:08:21,910
read that so when I first start my

161
00:08:20,500 --> 00:08:25,240
research and my problem

162
00:08:21,910 --> 00:08:27,130
I try to to get this out of the PDF and

163
00:08:25,240 --> 00:08:31,030
try to parse and analyze to see what's

164
00:08:27,130 --> 00:08:32,860
going on and this is not the most

165
00:08:31,030 --> 00:08:37,390
complete like you could break in

166
00:08:32,860 --> 00:08:41,500
different objects and handling and this

167
00:08:37,390 --> 00:08:44,710
the Oregon the image so bad sorry there

168
00:08:41,500 --> 00:08:47,530
organ PD framework is the same as the

169
00:08:44,710 --> 00:08:49,480
PDF ID like the full version that you

170
00:08:47,530 --> 00:08:50,530
have PDFs can like it will show like

171
00:08:49,480 --> 00:08:54,520
what you have you have a black screen

172
00:08:50,530 --> 00:08:56,949
and objects string some parameters here

173
00:08:54,520 --> 00:09:01,060
so you just show the structure of the

174
00:08:56,950 --> 00:09:02,860
file is not show the payload so problems

175
00:09:01,060 --> 00:09:06,910
that you have analyzed PDF if those

176
00:09:02,860 --> 00:09:08,950
tools mostly are manual analysis so like

177
00:09:06,910 --> 00:09:10,329
when you're talking about a lot of

178
00:09:08,950 --> 00:09:13,269
samples and

179
00:09:10,329 --> 00:09:16,359
probably get thousands of samples per

180
00:09:13,269 --> 00:09:19,660
week that's not going to work unless you

181
00:09:16,360 --> 00:09:22,209
have like thousands of security research

182
00:09:19,660 --> 00:09:25,660
research so that JavaScript it's a pain

183
00:09:22,209 --> 00:09:29,258
so that embedded file must be analyzed

184
00:09:25,660 --> 00:09:32,019
to doesn't mean like if you have a PDF

185
00:09:29,259 --> 00:09:35,139
file with and bedded file doesn't mean

186
00:09:32,019 --> 00:09:38,769
that's malicious like good they have the

187
00:09:35,139 --> 00:09:40,779
the the function to embed files for for

188
00:09:38,769 --> 00:09:42,519
good purpose not for malicious that's

189
00:09:40,779 --> 00:09:45,369
they are using for malicious

190
00:09:42,519 --> 00:09:47,230
we have the rich media so if you have a

191
00:09:45,369 --> 00:09:49,839
flash inside and a channel ID like the

192
00:09:47,230 --> 00:09:53,290
PDF and the flash for example we have a

193
00:09:49,839 --> 00:09:56,049
bit occasion and mostly our signature

194
00:09:53,290 --> 00:09:58,179
base so signature is like you need to

195
00:09:56,049 --> 00:10:00,459
know to protect so that's a kind of

196
00:09:58,179 --> 00:10:02,470
problem especially when you're talking

197
00:10:00,459 --> 00:10:05,888
about something that could be encoded

198
00:10:02,470 --> 00:10:10,980
and like and a lot of publication has

199
00:10:05,889 --> 00:10:10,980
javascript so that's some problems

200
00:10:11,999 --> 00:10:20,259
another primer like you could have an

201
00:10:14,889 --> 00:10:23,919
object with no encoding so it could add

202
00:10:20,259 --> 00:10:26,410
a future and have encode so it will look

203
00:10:23,919 --> 00:10:28,749
like this and so what's the problem here

204
00:10:26,410 --> 00:10:30,759
like the protection should know how to

205
00:10:28,749 --> 00:10:34,029
decode that to see if there is something

206
00:10:30,759 --> 00:10:36,999
malicious but you can't have they encode

207
00:10:34,029 --> 00:10:39,879
of the encoded so the protection must

208
00:10:36,999 --> 00:10:42,999
open and so see no it's too encoded and

209
00:10:39,879 --> 00:10:44,499
open again for example like like this is

210
00:10:42,999 --> 00:10:47,290
to the collide and don't for a

211
00:10:44,499 --> 00:10:51,009
protection side of you it's pretty

212
00:10:47,290 --> 00:10:54,040
complex that like how are you handle

213
00:10:51,009 --> 00:10:55,899
that if and if I put like a lot of

214
00:10:54,040 --> 00:10:58,660
encodes inside I don't know how many

215
00:10:55,899 --> 00:11:01,779
codes it could have like if there is

216
00:10:58,660 --> 00:11:03,819
some limit or not I'm good forever so

217
00:11:01,779 --> 00:11:06,819
like image if I put like a hundred

218
00:11:03,819 --> 00:11:08,349
encodes here like I will then I have

219
00:11:06,819 --> 00:11:11,649
served the protection if the protection

220
00:11:08,350 --> 00:11:14,799
try to open out in code so that's

221
00:11:11,649 --> 00:11:18,970
another vector of obfuscation

222
00:11:14,799 --> 00:11:20,619
that the the malicious guys could use

223
00:11:18,970 --> 00:11:22,569
and that's another problem to the

224
00:11:20,619 --> 00:11:23,920
research we need to analyze that so you

225
00:11:22,569 --> 00:11:26,680
need to open out

226
00:11:23,920 --> 00:11:29,740
encoding and analyze and so imagine like

227
00:11:26,680 --> 00:11:31,209
you have like pain encoding and so

228
00:11:29,740 --> 00:11:34,089
inside that thing called you have a

229
00:11:31,209 --> 00:11:35,920
variable skating JavaScript and so need

230
00:11:34,089 --> 00:11:38,920
to double skated javascript and work on

231
00:11:35,920 --> 00:11:47,500
that so that's something great like you

232
00:11:38,920 --> 00:11:50,380
analyze like one PDF for week maybe so

233
00:11:47,500 --> 00:11:52,839
that's kind of Jas impact signature like

234
00:11:50,380 --> 00:11:56,019
if you try to look for something like

235
00:11:52,839 --> 00:11:58,680
for media dot new player and so it

236
00:11:56,019 --> 00:12:02,079
triggered a possibility you have days

237
00:11:58,680 --> 00:12:04,930
CVE inside this PDF so that's a kind of

238
00:12:02,079 --> 00:12:08,430
simple and pretty easy to encode and

239
00:12:04,930 --> 00:12:13,420
bypass but this so like signature base

240
00:12:08,430 --> 00:12:15,579
and so based on all this stuff that I

241
00:12:13,420 --> 00:12:17,560
targeted and talk and talk and complain

242
00:12:15,579 --> 00:12:20,229
and say that's not that good

243
00:12:17,560 --> 00:12:24,550
sure that we need that how does man

244
00:12:20,230 --> 00:12:27,399
wanna listen I think I I was frustrate

245
00:12:24,550 --> 00:12:29,709
that I cannot first the JavaScript and

246
00:12:27,399 --> 00:12:32,380
all that stuff and I try to see a

247
00:12:29,709 --> 00:12:40,329
different way to detect the malicious

248
00:12:32,380 --> 00:12:43,470
video so I start true to analyze PDF so

249
00:12:40,329 --> 00:12:47,380
I analyze thousands of malicious PDF

250
00:12:43,470 --> 00:12:51,490
like I think I analyzed something

251
00:12:47,380 --> 00:12:54,220
analyzed with the day structure I didn't

252
00:12:51,490 --> 00:12:56,560
take care about the the pillows because

253
00:12:54,220 --> 00:12:58,690
if I need to look into all payloads it I

254
00:12:56,560 --> 00:13:00,969
mean still researching about that so

255
00:12:58,690 --> 00:13:05,170
something around 20,000 malicious PDF

256
00:13:00,970 --> 00:13:07,269
analyzed so it's a good number a lot of

257
00:13:05,170 --> 00:13:10,029
regular files like in the beginning I

258
00:13:07,269 --> 00:13:14,800
just grabbed a couple something but

259
00:13:10,029 --> 00:13:18,399
currently we have this this is coring

260
00:13:14,800 --> 00:13:23,410
running our mail server so we receive a

261
00:13:18,399 --> 00:13:26,110
burnt of PDF so we have a good research

262
00:13:23,410 --> 00:13:29,079
research like to see when you have some

263
00:13:26,110 --> 00:13:31,899
false positives and I use are you talk

264
00:13:29,079 --> 00:13:34,510
and after by the end of the talk like

265
00:13:31,899 --> 00:13:37,120
some problems that you have like one of

266
00:13:34,510 --> 00:13:37,720
the problems you have like any notes

267
00:13:37,120 --> 00:13:40,300
like

268
00:13:37,720 --> 00:13:42,940
when we're talking about buffer

269
00:13:40,300 --> 00:13:47,439
overflows like the exploitation about

270
00:13:42,940 --> 00:13:52,030
some headers problem like the they

271
00:13:47,440 --> 00:13:55,320
showed like the tree the u3d to two

272
00:13:52,030 --> 00:13:59,410
different exploit and the the top and

273
00:13:55,320 --> 00:14:01,930
one they just change a bit the the

274
00:13:59,410 --> 00:14:04,510
function like so they don't doesn't

275
00:14:01,930 --> 00:14:06,609
change the structure so if you don't

276
00:14:04,510 --> 00:14:10,450
change this church sure I am NOT

277
00:14:06,610 --> 00:14:13,600
attacked so that's the bad side for us

278
00:14:10,450 --> 00:14:16,750
but when I talk about sprite kids that

279
00:14:13,600 --> 00:14:18,550
mostly what's arrived it for us they use

280
00:14:16,750 --> 00:14:23,770
it to change a lotta structure so that's

281
00:14:18,550 --> 00:14:27,250
a good the good news and so we have

282
00:14:23,770 --> 00:14:30,370
another point we have symbols from 2007

283
00:14:27,250 --> 00:14:35,200
make my think we have some from 2006 but

284
00:14:30,370 --> 00:14:38,440
and so that's the big true like the

285
00:14:35,200 --> 00:14:41,590
payloads change it a lot but if you look

286
00:14:38,440 --> 00:14:44,770
this structure are mostly the same so

287
00:14:41,590 --> 00:14:47,050
that's that's the trick like analyzing a

288
00:14:44,770 --> 00:14:48,910
lot of samples you saw that the

289
00:14:47,050 --> 00:14:50,050
malicious PDF it's supposed to have

290
00:14:48,910 --> 00:14:52,630
those two if you like

291
00:14:50,050 --> 00:14:56,050
if you run PDF ad you to have some like

292
00:14:52,630 --> 00:14:58,060
one page is Europe AG that you have like

293
00:14:56,050 --> 00:14:59,740
some JavaScript they have a passion they

294
00:14:58,060 --> 00:15:03,040
have you have some combination of that

295
00:14:59,740 --> 00:15:08,170
and so it will point that malicious or

296
00:15:03,040 --> 00:15:11,290
not and so here's some functions that we

297
00:15:08,170 --> 00:15:14,530
detect like analyzing like the malicious

298
00:15:11,290 --> 00:15:19,089
sample so what what how I started I

299
00:15:14,530 --> 00:15:21,699
start with c55 functions like what I saw

300
00:15:19,090 --> 00:15:25,270
like JavaScript and open action and one

301
00:15:21,700 --> 00:15:27,940
page and basically I ran the the PDF

302
00:15:25,270 --> 00:15:31,420
ready for example and if you have one

303
00:15:27,940 --> 00:15:34,210
page in JavaScript I will score one if I

304
00:15:31,420 --> 00:15:37,990
have JavaScript I score close one so

305
00:15:34,210 --> 00:15:40,240
it's it's part of the PDF ID I was

306
00:15:37,990 --> 00:15:42,730
caught something and so like my very

307
00:15:40,240 --> 00:15:46,060
first version it was five things like if

308
00:15:42,730 --> 00:15:49,839
it was disc or a bigger or equal three

309
00:15:46,060 --> 00:15:51,619
its reelect so I just ran against the

310
00:15:49,839 --> 00:15:53,810
merit work it

311
00:15:51,620 --> 00:15:55,850
to enter one against the irregular I

312
00:15:53,810 --> 00:16:00,290
hope it work it's you like everything of

313
00:15:55,850 --> 00:16:02,990
Malaysia so that's not okay so I figure

314
00:16:00,290 --> 00:16:05,510
out okay I need to improve that but the

315
00:16:02,990 --> 00:16:09,260
good side last I could the text I know

316
00:16:05,510 --> 00:16:11,150
that we have a behavior here like so why

317
00:16:09,260 --> 00:16:14,720
do I figure out like okay I will run

318
00:16:11,150 --> 00:16:17,810
against the malicious and against the

319
00:16:14,720 --> 00:16:22,130
regular files and I will try to find

320
00:16:17,810 --> 00:16:24,310
more and more functions let's call

321
00:16:22,130 --> 00:16:27,710
functions everything is a function so

322
00:16:24,310 --> 00:16:31,189
basically now we have we analyze more

323
00:16:27,710 --> 00:16:34,760
than 20 functions to an output different

324
00:16:31,190 --> 00:16:39,880
output and we analyze some combination

325
00:16:34,760 --> 00:16:45,770
of that output and so for example I some

326
00:16:39,880 --> 00:16:49,010
some behaviors adds like something 1.5

327
00:16:45,770 --> 00:16:51,529
something for example and some we

328
00:16:49,010 --> 00:16:53,600
decrease the score so it could have a

329
00:16:51,529 --> 00:16:56,450
balance for regular files and non

330
00:16:53,600 --> 00:16:58,790
regular files and so that's the trick

331
00:16:56,450 --> 00:17:02,209
like the mix of combination of scoring

332
00:16:58,790 --> 00:17:04,399
light is a bit similar like and span

333
00:17:02,209 --> 00:17:08,000
like at span we got like if you have

334
00:17:04,400 --> 00:17:10,309
reverse if you have something relative

335
00:17:08,000 --> 00:17:11,390
IP reputation if you have this to be

336
00:17:10,309 --> 00:17:13,879
checked if have that

337
00:17:11,390 --> 00:17:16,520
oh it's score more than might Rashad so

338
00:17:13,880 --> 00:17:19,160
it's malicious and so that's how I pick

339
00:17:16,520 --> 00:17:22,359
that and so we look for a JavaScript

340
00:17:19,160 --> 00:17:26,600
stuff JavaScript you could see like

341
00:17:22,359 --> 00:17:29,689
around 75% of the malicious file have

342
00:17:26,599 --> 00:17:33,439
JavaScript so that's a good vector like

343
00:17:29,690 --> 00:17:36,890
if you have JavaScript and if you have

344
00:17:33,440 --> 00:17:39,580
flat the code that's most common in code

345
00:17:36,890 --> 00:17:42,800
that they use it's colored flat the code

346
00:17:39,580 --> 00:17:44,659
and if you have one page you only it's

347
00:17:42,800 --> 00:17:48,500
pretty common that the malicious PDF has

348
00:17:44,660 --> 00:17:51,320
one page shown so and so like you could

349
00:17:48,500 --> 00:17:54,500
say that okay so if I have those four

350
00:17:51,320 --> 00:17:59,120
it's malicious no it doesn't work that's

351
00:17:54,500 --> 00:18:03,620
that's the problem because we have a big

352
00:17:59,120 --> 00:18:05,239
problem and that's where I I work more I

353
00:18:03,620 --> 00:18:07,779
spend more of my time turning

354
00:18:05,240 --> 00:18:12,070
there's those numbers of this Corinne is

355
00:18:07,779 --> 00:18:14,870
the deforms when you have a PDF with

356
00:18:12,070 --> 00:18:16,928
working as a form they have JavaScript

357
00:18:14,870 --> 00:18:20,449
inside they probably could have some

358
00:18:16,929 --> 00:18:22,940
embedded file that's crazy and so that's

359
00:18:20,450 --> 00:18:25,220
where we need to find some gaps and some

360
00:18:22,940 --> 00:18:29,570
more points to score and decrease

361
00:18:25,220 --> 00:18:32,510
increase the score if if you ask me like

362
00:18:29,570 --> 00:18:35,870
how you choose this course that we're

363
00:18:32,510 --> 00:18:39,529
talking here I show more but it's try an

364
00:18:35,870 --> 00:18:41,959
error that's how it's work it like we

365
00:18:39,529 --> 00:18:44,740
are going to improve that because like I

366
00:18:41,960 --> 00:18:48,260
work as research and this start as my

367
00:18:44,740 --> 00:18:50,440
free time stuff like I'm doing nothing

368
00:18:48,260 --> 00:18:55,309
now I try to do something different and

369
00:18:50,440 --> 00:18:57,399
until you prove that it really works the

370
00:18:55,309 --> 00:19:00,139
company does not really care about that

371
00:18:57,399 --> 00:19:02,840
because they will not put money and say

372
00:19:00,140 --> 00:19:05,649
oh no here is a cup of machines build

373
00:19:02,840 --> 00:19:07,970
the lab and something more more

374
00:19:05,649 --> 00:19:13,610
intelligent and oh no that doesn't work

375
00:19:07,970 --> 00:19:15,860
right so now it's working so but this is

376
00:19:13,610 --> 00:19:19,158
HAP something like like I say like I

377
00:19:15,860 --> 00:19:23,418
think it's for 1.5 just something that

378
00:19:19,159 --> 00:19:27,529
we decrease the road dot five but it's

379
00:19:23,419 --> 00:19:31,279
something like we have some 0.73 five at

380
00:19:27,529 --> 00:19:33,919
score that's not a learning machine it's

381
00:19:31,279 --> 00:19:35,990
my brain machine like let's try this and

382
00:19:33,919 --> 00:19:39,529
so try again and try again try again

383
00:19:35,990 --> 00:19:42,770
that that's hard and it's working and so

384
00:19:39,529 --> 00:19:47,750
as I told we compared like so let's

385
00:19:42,770 --> 00:19:51,889
compare the same functions in red it's a

386
00:19:47,750 --> 00:19:54,529
malicious and green is the regular right

387
00:19:51,890 --> 00:19:57,110
and so it starts compare log if you look

388
00:19:54,529 --> 00:20:01,610
on the irregular files only a couple

389
00:19:57,110 --> 00:20:05,178
have JavaScript so okay so when you saw

390
00:20:01,610 --> 00:20:08,389
this JavaScript functions it could score

391
00:20:05,179 --> 00:20:10,309
more but itself doesn't mean that

392
00:20:08,390 --> 00:20:14,750
malicious but you could add a bigger

393
00:20:10,309 --> 00:20:17,059
score then something that it's pretty

394
00:20:14,750 --> 00:20:19,040
common lot so I think like so that's

395
00:20:17,059 --> 00:20:21,889
interesting like one page PDF

396
00:20:19,040 --> 00:20:24,129
so in simple that I analyze that's

397
00:20:21,890 --> 00:20:26,900
pretty common to have only one page PDF

398
00:20:24,130 --> 00:20:30,860
so like it's pretty eco so I could not

399
00:20:26,900 --> 00:20:33,280
add a lot of score because and so here

400
00:20:30,860 --> 00:20:36,409
you have the the biggest difference like

401
00:20:33,280 --> 00:20:38,780
JavaScript is pretty unique if you get

402
00:20:36,410 --> 00:20:42,500
like a curve form is most common in

403
00:20:38,780 --> 00:20:46,129
malicious files if you get like action

404
00:20:42,500 --> 00:20:48,920
and a a that's the kind of action it's

405
00:20:46,130 --> 00:20:50,930
most common in malicious file open

406
00:20:48,920 --> 00:20:53,720
action it's not most common malicious

407
00:20:50,930 --> 00:20:58,220
file so I add a little bit more of score

408
00:20:53,720 --> 00:21:02,120
so that's how and but here that's

409
00:20:58,220 --> 00:21:04,610
something crazy because the I when I

410
00:21:02,120 --> 00:21:07,729
started I supposed a cross-table that

411
00:21:04,610 --> 00:21:10,639
end object and start objects that need

412
00:21:07,730 --> 00:21:12,740
to be the same numbers will be most

413
00:21:10,640 --> 00:21:14,840
incorrect in mauers but they work fast

414
00:21:12,740 --> 00:21:19,940
they're more common I don't know why

415
00:21:14,840 --> 00:21:26,620
they and so like the J big the code like

416
00:21:19,940 --> 00:21:29,690
it's more common in regular files so

417
00:21:26,620 --> 00:21:31,550
working with this information we start

418
00:21:29,690 --> 00:21:35,030
to point this Cora like and so like if

419
00:21:31,550 --> 00:21:37,399
you have these will increase the score

420
00:21:35,030 --> 00:21:40,000
like if you have that where you decrease

421
00:21:37,400 --> 00:21:44,210
the score so we start to balance and

422
00:21:40,000 --> 00:21:48,440
another point is the file size that's

423
00:21:44,210 --> 00:21:50,210
that's the interesting part let me see

424
00:21:48,440 --> 00:21:54,950
the time that's the interesting part

425
00:21:50,210 --> 00:21:57,170
when are talking about about behavior if

426
00:21:54,950 --> 00:21:59,090
you look doesn't matter where in the

427
00:21:57,170 --> 00:22:01,640
fire or somewhere you'll always find

428
00:21:59,090 --> 00:22:05,300
some big difference in somewhere like

429
00:22:01,640 --> 00:22:10,850
here and the file size are mostly the

430
00:22:05,300 --> 00:22:16,040
same but in this 11 K to 3rd case file

431
00:22:10,850 --> 00:22:20,270
size it's very like almost 45% of the

432
00:22:16,040 --> 00:22:24,580
malicious samples sit so I could based

433
00:22:20,270 --> 00:22:27,200
on the size at some culture because like

434
00:22:24,580 --> 00:22:31,220
there is you supposed to be smaller

435
00:22:27,200 --> 00:22:31,700
especially because PDF could be and it

436
00:22:31,220 --> 00:22:33,830
is

437
00:22:31,700 --> 00:22:36,260
almost a plaintiff's file with a lot of

438
00:22:33,830 --> 00:22:39,500
functions and when it's handler they are

439
00:22:36,260 --> 00:22:42,769
beautiful but and if we're doing

440
00:22:39,500 --> 00:22:44,750
something malicious it just put a bunch

441
00:22:42,769 --> 00:22:49,250
of information that I need to be a big

442
00:22:44,750 --> 00:22:52,940
file line and so here you have some some

443
00:22:49,250 --> 00:22:54,950
some parts that it's almost equal like

444
00:22:52,940 --> 00:22:56,840
it's not a big difference that I could

445
00:22:54,950 --> 00:22:59,840
say now I could add some score here or

446
00:22:56,840 --> 00:23:04,158
not and that's one that you have very

447
00:22:59,840 --> 00:23:06,049
very big file probably there is a there

448
00:23:04,159 --> 00:23:07,909
is some files that have like ten and

449
00:23:06,049 --> 00:23:11,000
bedded files and that's creative things

450
00:23:07,909 --> 00:23:14,029
and they are not malicious I don't know

451
00:23:11,000 --> 00:23:17,419
why they need too much files and and I

452
00:23:14,029 --> 00:23:18,860
think there is a book that they call PDF

453
00:23:17,419 --> 00:23:20,960
hacking or something like this but not

454
00:23:18,860 --> 00:23:23,600
be def hacking for malicious about the

455
00:23:20,960 --> 00:23:28,330
Deaf hacking to create good PDF is

456
00:23:23,600 --> 00:23:31,178
smaller with well and so the file size

457
00:23:28,330 --> 00:23:39,408
besides all that function is another

458
00:23:31,179 --> 00:23:43,220
vector and so that's bad after doing all

459
00:23:39,409 --> 00:23:46,370
that based on that statistic analysis

460
00:23:43,220 --> 00:23:50,299
and create this coin we run all the

461
00:23:46,370 --> 00:23:54,018
samples against various Toto and against

462
00:23:50,299 --> 00:23:56,779
PDF score that has the KO what the first

463
00:23:54,019 --> 00:24:00,580
what surprised me a lot GData is the

464
00:23:56,779 --> 00:24:03,320
best antivirus ever for PDF I don't know

465
00:24:00,580 --> 00:24:08,090
because I don't know nobody that used G

466
00:24:03,320 --> 00:24:10,490
data but here really good I don't know

467
00:24:08,090 --> 00:24:12,980
if I could see here you did it they have

468
00:24:10,490 --> 00:24:14,830
something around 95 percent detection

469
00:24:12,980 --> 00:24:18,860
that's insane

470
00:24:14,830 --> 00:24:21,080
so PDF score was the second like when I

471
00:24:18,860 --> 00:24:23,269
start the research PDF score was better

472
00:24:21,080 --> 00:24:25,730
than G data now they are better than us

473
00:24:23,269 --> 00:24:28,429
so I get a little first data I need to

474
00:24:25,730 --> 00:24:31,669
improve my research but we are detect

475
00:24:28,429 --> 00:24:34,190
something around 92 to 93 percent what's

476
00:24:31,669 --> 00:24:37,490
awesome because we are not looking for

477
00:24:34,190 --> 00:24:40,700
payload and like if you'd a really some

478
00:24:37,490 --> 00:24:43,610
new PDF we will detect unless they start

479
00:24:40,700 --> 00:24:45,110
to change how they you write the PDF but

480
00:24:43,610 --> 00:24:45,439
they need to use the functions and

481
00:24:45,110 --> 00:24:47,090
something

482
00:24:45,440 --> 00:24:50,090
we'll be somewhere and they need to

483
00:24:47,090 --> 00:24:55,428
print and so like the third one was a

484
00:24:50,090 --> 00:24:58,600
vast sophist kaspersky in here I don't

485
00:24:55,429 --> 00:25:01,159
know what is that a square squared I

486
00:24:58,600 --> 00:25:08,570
never heard about but it's the Tecla

487
00:25:01,159 --> 00:25:10,159
like 0.1 percent of the sample that know

488
00:25:08,570 --> 00:25:12,080
it probably probably the possible

489
00:25:10,159 --> 00:25:17,720
Sevilla probably is not they were there

490
00:25:12,080 --> 00:25:22,340
only like and some antivirus like I

491
00:25:17,720 --> 00:25:25,429
thought that nod32 was good they are not

492
00:25:22,340 --> 00:25:28,158
good as I suppose panda I get like

493
00:25:25,429 --> 00:25:30,830
little surprise they are very bad with

494
00:25:28,159 --> 00:25:33,019
PDF at least right those tests are

495
00:25:30,830 --> 00:25:38,509
related with the PDF samples that I test

496
00:25:33,019 --> 00:25:42,980
only like not related about and so like

497
00:25:38,509 --> 00:25:45,679
we have those so so we are the second

498
00:25:42,980 --> 00:25:49,759
now like we got more than 90% what is a

499
00:25:45,679 --> 00:25:52,039
very nice detection rate and especially

500
00:25:49,759 --> 00:25:54,529
because we are running in the real

501
00:25:52,039 --> 00:25:57,740
server a real world like we have in

502
00:25:54,529 --> 00:26:00,860
production so we really care about false

503
00:25:57,740 --> 00:26:02,419
positives because our customer doesn't

504
00:26:00,860 --> 00:26:05,719
like when you block a foreign light

505
00:26:02,419 --> 00:26:08,450
because usually something for it like

506
00:26:05,720 --> 00:26:13,909
and that's one like because our engine

507
00:26:08,450 --> 00:26:16,460
it's run after the H virus no after yeah

508
00:26:13,909 --> 00:26:20,600
after the inspires and we are detecting

509
00:26:16,460 --> 00:26:25,250
and walking around a thousand samples

510
00:26:20,600 --> 00:26:27,080
today so you could see like I'm not

511
00:26:25,250 --> 00:26:31,399
going to say the name that inspires our

512
00:26:27,080 --> 00:26:37,039
youth but yes they are not not doing

513
00:26:31,399 --> 00:26:42,649
very well and basically what we scored

514
00:26:37,039 --> 00:26:46,730
like currently twenty more functions

515
00:26:42,649 --> 00:26:48,408
like and I'm working on more research to

516
00:26:46,730 --> 00:26:51,049
improve in the next months like I'm

517
00:26:48,409 --> 00:26:54,649
working like I noticed that we have some

518
00:26:51,049 --> 00:26:56,450
very uncommon when you run PDF ID to

519
00:26:54,649 --> 00:26:57,309
output everything you have some crazy

520
00:26:56,450 --> 00:26:59,830
names and some

521
00:26:57,309 --> 00:27:02,918
long names that are in the malicious

522
00:26:59,830 --> 00:27:07,149
files that I am getting to add to this

523
00:27:02,919 --> 00:27:09,759
and probably will help more I'm looking

524
00:27:07,149 --> 00:27:13,418
again for a new features that I could

525
00:27:09,759 --> 00:27:15,460
try to print and create that kind of

526
00:27:13,419 --> 00:27:17,769
comparison like oh here the regular

527
00:27:15,460 --> 00:27:20,710
here's a malicious oh here is there a

528
00:27:17,769 --> 00:27:24,519
big gap so here's I put more and less

529
00:27:20,710 --> 00:27:28,529
point we have some combinations flag

530
00:27:24,519 --> 00:27:32,019
like we have a flag that I call the

531
00:27:28,529 --> 00:27:35,200
magic combination that when you have

532
00:27:32,019 --> 00:27:38,889
something that as an open action or

533
00:27:35,200 --> 00:27:41,470
something that will make something open

534
00:27:38,889 --> 00:27:43,539
when you open a file combined with

535
00:27:41,470 --> 00:27:47,259
something that could be malicious as and

536
00:27:43,539 --> 00:27:49,809
valid file a JavaScript file and I don't

537
00:27:47,259 --> 00:27:56,200
know I I don't think I should but if you

538
00:27:49,809 --> 00:27:58,539
came here where is it that's the big

539
00:27:56,200 --> 00:28:00,490
difference to you see like the match

540
00:27:58,539 --> 00:28:04,749
combination that's something action but

541
00:28:00,490 --> 00:28:08,049
a malicious it's mostly happen only on

542
00:28:04,749 --> 00:28:10,830
the the malicious samples and that's a

543
00:28:08,049 --> 00:28:14,320
trick like where you get something that

544
00:28:10,830 --> 00:28:19,379
really related with the militias only so

545
00:28:14,320 --> 00:28:19,379
you try to see different behaviors and

546
00:28:20,190 --> 00:28:25,419
we work with a threshold like that's a

547
00:28:22,990 --> 00:28:29,080
good size right if they change that the

548
00:28:25,419 --> 00:28:30,970
the how they write malicious PDF we

549
00:28:29,080 --> 00:28:34,600
could decrease or increase the threshold

550
00:28:30,970 --> 00:28:36,940
and so we have like some good results

551
00:28:34,600 --> 00:28:39,459
like we will keep improving that and we

552
00:28:36,940 --> 00:28:41,860
could try to see what the is going on

553
00:28:39,460 --> 00:28:45,009
maybe need to do everything again and

554
00:28:41,860 --> 00:28:51,610
create some status but basically it's

555
00:28:45,009 --> 00:28:55,749
how it works and to see like how this is

556
00:28:51,610 --> 00:29:01,090
dynamic and different like this we got

557
00:28:55,749 --> 00:29:02,379
almost a hundred different score so it's

558
00:29:01,090 --> 00:29:05,230
quite a lot of things and different

559
00:29:02,379 --> 00:29:08,469
rates like so the most common square was

560
00:29:05,230 --> 00:29:09,090
this number I'm bad with number so I'm

561
00:29:08,470 --> 00:29:14,320
not

562
00:29:09,090 --> 00:29:16,570
at 6.8 something I get confused and so

563
00:29:14,320 --> 00:29:19,090
like the truth show that we're using now

564
00:29:16,570 --> 00:29:21,490
is true like so so any score bigger than

565
00:29:19,090 --> 00:29:23,169
true it's malicious and so like we have

566
00:29:21,490 --> 00:29:25,000
like some crazy numbers like you could

567
00:29:23,170 --> 00:29:28,360
see like the number that I'm using

568
00:29:25,000 --> 00:29:34,680
because right we have seven one seven

569
00:29:28,360 --> 00:29:40,780
five eyes it's out different numbers and

570
00:29:34,680 --> 00:29:42,910
one of the points it's a bigger result

571
00:29:40,780 --> 00:29:44,920
it doesn't mean that it's more malicious

572
00:29:42,910 --> 00:29:48,700
like it's just a combination of stuff

573
00:29:44,920 --> 00:29:52,750
like let me like if this is 4.5 and the

574
00:29:48,700 --> 00:29:55,960
other is 10 doesn't mean that the other

575
00:29:52,750 --> 00:29:58,240
is more dangerous or these last

576
00:29:55,960 --> 00:30:00,460
dangerous so that's the way you do

577
00:29:58,240 --> 00:30:02,440
something like you have one page so we

578
00:30:00,460 --> 00:30:04,840
detects to have the JavaScript stuff we

579
00:30:02,440 --> 00:30:07,090
have open action we have AK reform have

580
00:30:04,840 --> 00:30:09,340
action so we have open action action and

581
00:30:07,090 --> 00:30:12,639
JavaScript so we have the match

582
00:30:09,340 --> 00:30:18,129
combination like and so I don't remember

583
00:30:12,640 --> 00:30:19,690
the voucher by hand but we get this Plus

584
00:30:18,130 --> 00:30:24,010
this Plus this Plus this Plus this Plus

585
00:30:19,690 --> 00:30:26,980
this you get the square of 4.5 and so it

586
00:30:24,010 --> 00:30:28,300
turned out this is malicious why because

587
00:30:26,980 --> 00:30:29,920
it's bigger than true and these

588
00:30:28,300 --> 00:30:33,639
combinations point your something

589
00:30:29,920 --> 00:30:37,420
malicious and so it's it's something

590
00:30:33,640 --> 00:30:40,360
like I'm doing something very simple I'm

591
00:30:37,420 --> 00:30:43,270
doing probably the opposite that at most

592
00:30:40,360 --> 00:30:46,270
people try to do like they look and and

593
00:30:43,270 --> 00:30:50,490
try the complex stuff I'm just looking

594
00:30:46,270 --> 00:30:50,490
to the basics like this structure

595
00:30:52,520 --> 00:31:00,050
and false positive as I told you we are

596
00:30:55,370 --> 00:31:04,340
running our mail service so we test a

597
00:31:00,050 --> 00:31:10,460
lot so and we have a lot of ideas

598
00:31:04,340 --> 00:31:13,639
improve that and one of my my days to

599
00:31:10,460 --> 00:31:17,120
release the code about this corn stuff I

600
00:31:13,640 --> 00:31:21,050
cannot release so far but I hope I could

601
00:31:17,120 --> 00:31:22,489
release in future especially because I

602
00:31:21,050 --> 00:31:25,340
need to improve and the funnest part

603
00:31:22,490 --> 00:31:28,400
like my proof of concept it's a per

604
00:31:25,340 --> 00:31:31,939
script that I did what's mean that it's

605
00:31:28,400 --> 00:31:35,900
not good but work it's something around

606
00:31:31,940 --> 00:31:39,100
200 lines it's nothing compared with and

607
00:31:35,900 --> 00:31:41,920
an antivirus solution or something a

608
00:31:39,100 --> 00:31:44,740
protection it's nothing and you got like

609
00:31:41,920 --> 00:31:48,260
something around 93 percent detection

610
00:31:44,740 --> 00:31:51,770
that's crazy and if you look at the same

611
00:31:48,260 --> 00:31:54,350
approach that you look in the structure

612
00:31:51,770 --> 00:31:57,440
and behavior I don't know if if you saw

613
00:31:54,350 --> 00:32:02,090
the another hotel ago it spoke at

614
00:31:57,440 --> 00:32:04,460
blackhat it works for qualies and he did

615
00:32:02,090 --> 00:32:08,050
the same approach for detection binaries

616
00:32:04,460 --> 00:32:11,150
malicious binaries but like if you have

617
00:32:08,050 --> 00:32:13,190
pecker you if you have and debugging if

618
00:32:11,150 --> 00:32:15,050
you have something so this is malicious

619
00:32:13,190 --> 00:32:22,280
because it's had that a regular software

620
00:32:15,050 --> 00:32:24,889
doesn't have besides skype so another

621
00:32:22,280 --> 00:32:28,399
point like is this files malicious like

622
00:32:24,890 --> 00:32:30,020
you have bad cross-reference a table it

623
00:32:28,400 --> 00:32:31,429
has zero page that's great sometimes

624
00:32:30,020 --> 00:32:34,910
it's points like zero page

625
00:32:31,429 --> 00:32:39,050
well my power has zero patience they

626
00:32:34,910 --> 00:32:42,200
have open action they have action and so

627
00:32:39,050 --> 00:32:46,309
this is malicious no this is not

628
00:32:42,200 --> 00:32:48,350
malicious right that's claim or it's a

629
00:32:46,309 --> 00:32:52,010
big false negative for other English

630
00:32:48,350 --> 00:32:54,949
life and PDF scar but what what what's

631
00:32:52,010 --> 00:32:57,500
the trick here like if you look you

632
00:32:54,950 --> 00:32:59,750
don't have like the malicious stuff like

633
00:32:57,500 --> 00:33:01,669
you don't have JavaScript you don't have

634
00:32:59,750 --> 00:33:03,890
embedded file you don't have something

635
00:33:01,669 --> 00:33:06,350
that could hurt doesn't matter that you

636
00:33:03,890 --> 00:33:10,059
have a an action for example that we

637
00:33:06,350 --> 00:33:18,309
do some something when you open a file

638
00:33:10,059 --> 00:33:23,320
so it's not malicious time on time so

639
00:33:18,309 --> 00:33:23,320
any question about the research itself

640
00:33:30,400 --> 00:33:43,360
I compare it like I used whoops impede

641
00:33:38,950 --> 00:33:46,330
any PDF I have access so I got a little

642
00:33:43,360 --> 00:33:49,389
bit paranoid like and I run again

643
00:33:46,330 --> 00:33:52,149
against PDF score alike and as I told

644
00:33:49,390 --> 00:33:54,370
like they change mostly the payload but

645
00:33:52,150 --> 00:33:56,850
they always keep the same structure they

646
00:33:54,370 --> 00:33:59,739
don't care yet about that because the

647
00:33:56,850 --> 00:34:01,419
the protection companies they're a

648
00:33:59,740 --> 00:34:04,600
diverse company they don't look for that

649
00:34:01,420 --> 00:34:07,540
so why they are going to change like it

650
00:34:04,600 --> 00:34:10,239
is the same as Brazilian ours if you

651
00:34:07,540 --> 00:34:13,449
look the code it's the true it's a piece

652
00:34:10,239 --> 00:34:16,658
of it's if I already download a

653
00:34:13,449 --> 00:34:19,870
file malicious Brazilian banker with 37

654
00:34:16,659 --> 00:34:24,310
megabytes but it works so why do you do

655
00:34:19,870 --> 00:34:29,380
something better and so nope

656
00:34:24,310 --> 00:34:33,159
and so I think I think that they didn't

657
00:34:29,380 --> 00:34:36,190
care about the structure at all so as I

658
00:34:33,159 --> 00:34:39,070
told let they change the they in turn

659
00:34:36,190 --> 00:34:40,870
the internal payload the JavaScript or

660
00:34:39,070 --> 00:34:42,130
and where they're targeting but they

661
00:34:40,870 --> 00:34:43,630
need the JavaScript they need some

662
00:34:42,130 --> 00:34:45,399
opening action because they need to when

663
00:34:43,630 --> 00:34:48,820
you open the file they need to run

664
00:34:45,399 --> 00:34:52,089
something and so it's mostly the same I

665
00:34:48,820 --> 00:34:56,820
don't know if there is some way to avoid

666
00:34:52,090 --> 00:34:59,140
this and have the same success rate

667
00:34:56,820 --> 00:35:01,480
because maybe they you try to do some

668
00:34:59,140 --> 00:35:04,150
interaction with the user click here to

669
00:35:01,480 --> 00:35:06,430
run this and so I don't know maybe it's

670
00:35:04,150 --> 00:35:07,840
not going to work because like it's

671
00:35:06,430 --> 00:35:10,270
pretty common like we want to get inside

672
00:35:07,840 --> 00:35:14,950
the company as like you put invalid file

673
00:35:10,270 --> 00:35:18,160
and PDF and send to the human research

674
00:35:14,950 --> 00:35:20,649
like oh here my resume take a look and

675
00:35:18,160 --> 00:35:23,319
Sochi will click something you run the

676
00:35:20,650 --> 00:35:26,100
background you never know and you yeah

677
00:35:23,320 --> 00:35:28,780
you probably will be inside the company

678
00:35:26,100 --> 00:35:31,540
so that's how it works

679
00:35:28,780 --> 00:35:34,600
and so what you use it some ideas like

680
00:35:31,540 --> 00:35:37,509
to using some oil dication Faro like so

681
00:35:34,600 --> 00:35:40,150
you could avoid the malicious guide to

682
00:35:37,510 --> 00:35:42,910
hosts malicious content in your server

683
00:35:40,150 --> 00:35:44,349
so that could be a good point specially

684
00:35:42,910 --> 00:35:47,710
if you get

685
00:35:44,349 --> 00:35:50,799
the big content provider as Amazon and

686
00:35:47,710 --> 00:35:54,789
Google they they have a bunch of samples

687
00:35:50,799 --> 00:35:57,279
malicious being hosted some content

688
00:35:54,789 --> 00:35:59,079
filtering like you could like avoid if

689
00:35:57,279 --> 00:36:02,559
the user trying to click in some fishing

690
00:35:59,079 --> 00:36:07,180
link we could try to protect maybe with

691
00:36:02,559 --> 00:36:08,979
this coin and so but in real time it's I

692
00:36:07,180 --> 00:36:11,379
don't know exact like in the mail server

693
00:36:08,979 --> 00:36:13,149
like if you have like one second delay

694
00:36:11,380 --> 00:36:17,559
like analyze my phone it's not a big

695
00:36:13,150 --> 00:36:20,559
deal but on the on the real real time

696
00:36:17,559 --> 00:36:23,529
like content filtering but it's only

697
00:36:20,559 --> 00:36:29,589
about the PDF so maybe it's not a big

698
00:36:23,529 --> 00:36:33,160
problem running with the AV agent for AV

699
00:36:29,589 --> 00:36:35,380
may be difficult because like some it's

700
00:36:33,160 --> 00:36:38,920
true generic like they were alert for

701
00:36:35,380 --> 00:36:41,739
something like unknown or so may may be

702
00:36:38,920 --> 00:36:45,039
that you don't like that idea you could

703
00:36:41,739 --> 00:36:48,789
use some script to try to find some

704
00:36:45,039 --> 00:36:53,499
something in them it could do something

705
00:36:48,789 --> 00:36:55,960
in the header integration like analyzing

706
00:36:53,499 --> 00:36:57,729
much more simple lies probably have

707
00:36:55,960 --> 00:37:01,930
million of samples that you could have

708
00:36:57,729 --> 00:37:04,598
access create a very good score and when

709
00:37:01,930 --> 00:37:07,569
a user opens something that seems to be

710
00:37:04,599 --> 00:37:07,989
malicious like based on the score just a

711
00:37:07,569 --> 00:37:10,779
word

712
00:37:07,989 --> 00:37:13,719
you're not going to block just let it as

713
00:37:10,779 --> 00:37:14,410
as Microsoft with if you have markers

714
00:37:13,719 --> 00:37:18,069
inside

715
00:37:14,410 --> 00:37:20,469
oh this file contains macros do really

716
00:37:18,069 --> 00:37:24,630
want to read and maybe could do the same

717
00:37:20,469 --> 00:37:28,239
like this as you did with the u3d like

718
00:37:24,630 --> 00:37:31,029
this file contains these since malicious

719
00:37:28,239 --> 00:37:33,579
do want to open or do want to open

720
00:37:31,029 --> 00:37:36,460
without JavaScript or maybe you want to

721
00:37:33,579 --> 00:37:39,539
open or an hour just closed so that

722
00:37:36,460 --> 00:37:43,119
could be I think here is the place

723
00:37:39,539 --> 00:37:46,839
because you teach the user to click in

724
00:37:43,119 --> 00:37:51,489
their correct stuff but doesn't depend

725
00:37:46,839 --> 00:37:53,890
on mere hour maybe some in the not ideas

726
00:37:51,489 --> 00:37:55,690
integration by itself because it's hard

727
00:37:53,890 --> 00:37:57,680
to put this and the real-time traffic

728
00:37:55,690 --> 00:38:00,260
but hater back it's a

729
00:37:57,680 --> 00:38:02,240
almost real-time and Alice that it's

730
00:38:00,260 --> 00:38:04,700
sand and analyze and so generate alert

731
00:38:02,240 --> 00:38:06,950
that could be a good place that's some

732
00:38:04,700 --> 00:38:12,890
ideas and at Mayo server as I told her

733
00:38:06,950 --> 00:38:15,799
ready like like some research we have a

734
00:38:12,890 --> 00:38:18,529
blog blog about spider labs we have the

735
00:38:15,800 --> 00:38:20,150
global security report that has a bunch

736
00:38:18,530 --> 00:38:24,020
of information that holding for me to

737
00:38:20,150 --> 00:38:27,550
handle the spider labs Twitter and my

738
00:38:24,020 --> 00:38:33,370
Twitter is a kind of similar double labs

739
00:38:27,550 --> 00:38:33,370
and questions speak slowly please

740
00:38:45,150 --> 00:38:51,960
well somebody I read asking this

741
00:38:48,359 --> 00:38:55,769
question like in and my answer is like I

742
00:38:51,960 --> 00:38:58,109
really don't care about the heater

743
00:38:55,769 --> 00:39:02,249
because I just received the PDF and the

744
00:38:58,109 --> 00:39:04,589
PDF is my playground like I don't know

745
00:39:02,249 --> 00:39:10,649
if the PDF is trying to do something for

746
00:39:04,589 --> 00:39:14,308
Acrobat 6 7 8 9 10 or if you if you're

747
00:39:10,650 --> 00:39:16,650
going to work on Linux or Mac OS so only

748
00:39:14,309 --> 00:39:18,749
or maybe that's something that I never

749
00:39:16,650 --> 00:39:21,210
pay attention because I'm only looking

750
00:39:18,749 --> 00:39:22,950
destructuring and if I need to look and

751
00:39:21,210 --> 00:39:25,410
now that information

752
00:39:22,950 --> 00:39:27,960
what's target or what's the target the

753
00:39:25,410 --> 00:39:30,019
real target I probably spend too much

754
00:39:27,960 --> 00:39:30,019
time

755
00:39:38,870 --> 00:39:45,950
or did you actually

756
00:39:42,600 --> 00:39:45,950
yes was targeted

757
00:39:48,740 --> 00:39:55,080
well when I start the research like I

758
00:39:52,230 --> 00:39:59,310
talked to the first five guys the VRT

759
00:39:55,080 --> 00:40:01,980
the they have their clinic Navy and they

760
00:39:59,310 --> 00:40:04,200
shared a lot of samples with me and say

761
00:40:01,980 --> 00:40:08,340
those are malicious here we go

762
00:40:04,200 --> 00:40:08,939
and they are public so I sent you virus

763
00:40:08,340 --> 00:40:10,920
toto

764
00:40:08,940 --> 00:40:13,740
just to make sure and see the detection

765
00:40:10,920 --> 00:40:15,060
rates because I want to compare I could

766
00:40:13,740 --> 00:40:17,759
try to figure out where it's going to

767
00:40:15,060 --> 00:40:22,140
where it's supposed to hit because some

768
00:40:17,760 --> 00:40:27,030
some various Toto will show a good name

769
00:40:22,140 --> 00:40:30,230
and say oh this is CV 2011 something and

770
00:40:27,030 --> 00:40:35,700
so you know that all this target the

771
00:40:30,230 --> 00:40:37,590
Adobe version blood but I never I never

772
00:40:35,700 --> 00:40:42,149
do that if one if you own a good shirt

773
00:40:37,590 --> 00:40:44,220
they have the whole the whole various

774
00:40:42,150 --> 00:40:46,230
total results right there is no secret

775
00:40:44,220 --> 00:40:49,290
it's probably it's a text file with

776
00:40:46,230 --> 00:40:58,850
other result is a rib script that go and

777
00:40:49,290 --> 00:40:58,850
it took forever because it yeah

778
00:40:59,579 --> 00:41:06,359
okay but no no I my my only goal was to

779
00:41:03,420 --> 00:41:11,069
detect the militias when and doesn't

780
00:41:06,359 --> 00:41:15,239
matter which one's the target any

781
00:41:11,069 --> 00:41:17,749
questions more questions all right so

782
00:41:15,239 --> 00:41:17,749
thank you

783
00:41:17,780 --> 00:41:22,659
[Applause]

