1
00:00:00,640 --> 00:00:05,220
there um hello and welcome to my talk
next generation mobile rootkits

2
00:00:05,220 --> 00:00:09,480
I'm my nemesis Thomas Roth I do embedded
security

3
00:00:09,480 --> 00:00:13,929
like a king payment terminals I do but
i've distributed computing

4
00:00:13,929 --> 00:00:20,230
and many breaking and webster you can
find me on the internet on Twitter at

5
00:00:20,230 --> 00:00:21,119
stake smashing

6
00:00:21,119 --> 00:00:25,390
I'm no hope you enjoyed so

7
00:00:25,390 --> 00:00:29,840
let's thought was a short introduction
into the world of motherhood kits and

8
00:00:29,840 --> 00:00:33,510
on trust them in so when

9
00:00:33,510 --> 00:00:36,730
what are we protecting on the modern
mobile phone

10
00:00:36,730 --> 00:00:40,430
now we have our communication doesn't
matter if it's

11
00:00:40,430 --> 00:00:43,690
actually calling if it's frightening SMS
or

12
00:00:43,690 --> 00:00:48,420
what's up for some was so it's I'm even
if its real life communication because

13
00:00:48,420 --> 00:00:50,850
if I can use your phone as a Bach

14
00:00:50,850 --> 00:00:56,399
that's the problem we are protecting
data and like a lot of people have fun

15
00:00:56,399 --> 00:00:59,480
documents on the phone from their
businesses

16
00:00:59,480 --> 00:01:03,340
our presentations and so on we're
protecting credentials

17
00:01:03,340 --> 00:01:08,090
like you can keys your are all likely
your email password is also the password

18
00:01:08,090 --> 00:01:08,810
you're using

19
00:01:08,810 --> 00:01:12,479
slow come to your network canceled now
we have payment

20
00:01:12,479 --> 00:01:16,950
like and that's the payment with Google
Wallet with mastercard and my sis

21
00:01:16,950 --> 00:01:22,040
papers and position better because if I
can rootkit your mobile phone

22
00:01:22,040 --> 00:01:26,390
I can track you her

23
00:01:26,390 --> 00:01:30,530
arm what kinda more I'll rootkits

24
00:01:30,530 --> 00:01:34,290
I have foreseen and wild that was the
famous Carrier IQ

25
00:01:34,290 --> 00:01:38,659
which was used for up usage statistics
officially

26
00:01:38,659 --> 00:01:44,450
on which interesting didn't only height
in the CPU but also in the basement for

27
00:01:44,450 --> 00:01:45,189
some lenders

28
00:01:45,189 --> 00:01:48,399
then there's than Fisher up for

29
00:01:48,399 --> 00:01:52,430
some although which is government to
Seville surveillance arm

30
00:01:52,430 --> 00:01:57,079
and there's loco which is a very
interesting research paper

31
00:01:57,079 --> 00:02:04,079
about I'm its where would I hide the
rootkit

32
00:02:04,509 --> 00:02:09,569
and on a moment from I've actually two
choicest there's the CPU

33
00:02:09,569 --> 00:02:12,790
which on a dust-up duce everything

34
00:02:12,790 --> 00:02:16,849
that has to do with the operating system
everything but you actually see

35
00:02:16,849 --> 00:02:19,860
and then there's the basement the
baseband is the

36
00:02:19,860 --> 00:02:23,560
communication shifted inferences 3G
atoms demand

37
00:02:23,560 --> 00:02:28,020
implement sexual calling and so on an
interesting new york on most opera

38
00:02:28,020 --> 00:02:28,739
platforms

39
00:02:28,739 --> 00:02:32,620
the baseband and the CPU both tough full
memory access

40
00:02:32,620 --> 00:02:36,920
safe you can own the baseband you own
the device

41
00:02:36,920 --> 00:02:40,590
in this talk we are going to focus

42
00:02:40,590 --> 00:02:44,510
on small arm hop trip

43
00:02:44,510 --> 00:02:47,920
how to addition by I'm colds

44
00:02:47,920 --> 00:02:51,930
trust 7 trusts own is basically a secure

45
00:02:51,930 --> 00:02:55,030
ship in your I'm proceso

46
00:02:55,030 --> 00:02:58,530
and yep it's quite interesting who a few

47
00:02:58,530 --> 00:03:01,800
house absolutely no idea of I'm procesos

48
00:03:01,800 --> 00:03:05,260
like co-processor bills and so on I

49
00:03:05,260 --> 00:03:09,349
Creek things um yet then a shot I'm
intro

50
00:03:09,349 --> 00:03:12,720
I I miss is such a two bit RISC
architecture

51
00:03:12,720 --> 00:03:17,239
risk reduced instruction set so you have
a small setup instructions that a simple

52
00:03:17,239 --> 00:03:20,819
but can be executed relatively fast I'm

53
00:03:20,819 --> 00:03:25,209
new thirty two-bit I'm on x86 you
instructions

54
00:03:25,209 --> 00:03:29,940
can be I cannot are different lengths
like you can have

55
00:03:29,940 --> 00:03:34,459
as we've seen early in the
virtualization talk 15 by construction

56
00:03:34,459 --> 00:03:38,489
on ARM on instructions on a 32-bit long

57
00:03:38,489 --> 00:03:42,040
except in the so-called some mode which
is a moat

58
00:03:42,040 --> 00:03:45,620
for extra small instructions

59
00:03:45,620 --> 00:03:49,610
normally only generated by compiler
which only 16

60
00:03:49,610 --> 00:03:53,239
long and there's some too but that's a
good different story

61
00:03:53,239 --> 00:03:56,730
on arm peripherals like BIOS

62
00:03:56,730 --> 00:04:00,409
like maybe just your frame before maybe
some some

63
00:04:00,409 --> 00:04:03,989
keys on your mobile.phone on that into
memory so

64
00:04:03,989 --> 00:04:07,849
if you if you boot up your device and
without sucking up the

65
00:04:07,849 --> 00:04:11,299
memory protection on management unit I'm

66
00:04:11,299 --> 00:04:15,280
and you right at some addresses maybe
some LED lights up

67
00:04:15,280 --> 00:04:18,579
or you can check whether a key is
pressed and so on

68
00:04:18,579 --> 00:04:22,360
also to a Co process also

69
00:04:22,360 --> 00:04:26,190
play a very important role on on ARM
processors on

70
00:04:26,190 --> 00:04:31,020
very famous one Mississippi 15
co-processor which is available on Aug

71
00:04:31,020 --> 00:04:31,580
more than

72
00:04:31,580 --> 00:04:34,910
I am procesos it's called the system
control cope

73
00:04:34,910 --> 00:04:38,430
co-processor you can do things like up

74
00:04:38,430 --> 00:04:41,470
configure the AM and new country Europe
for saving

75
00:04:41,470 --> 00:04:45,710
I set up a cashless ceta where the TLD

76
00:04:45,710 --> 00:04:51,100
I'll will recite and so on and so on so

77
00:04:51,100 --> 00:04:55,560
what about on trust sound I'm trusts own
basically allows the process up to

78
00:04:55,560 --> 00:04:56,440
switch into

79
00:04:56,440 --> 00:05:00,770
secure mode which it can at hopefully
will only

80
00:05:00,770 --> 00:05:04,100
execute a trusted instructions

81
00:05:04,100 --> 00:05:09,199
some great feeling about trust some
compared to having a smart card or

82
00:05:09,199 --> 00:05:11,699
something similar on your mobile phone
is that

83
00:05:11,699 --> 00:05:15,000
trust some kind of access to screen to
the keyboard

84
00:05:15,000 --> 00:05:18,240
and so on so you have secret input and
secure output

85
00:05:18,240 --> 00:05:21,740
which is normally considered a problem
because if you have a a smart card in

86
00:05:21,740 --> 00:05:22,500
your phone

87
00:05:22,500 --> 00:05:26,199
and you enter the PIN just on the
display in your Android

88
00:05:26,199 --> 00:05:29,350
or whatever in theory

89
00:05:29,350 --> 00:05:32,400
um nowhere could crept

90
00:05:32,400 --> 00:05:36,300
the pin and talk to the smart card
themselves

91
00:05:36,300 --> 00:05:41,250
is not the case was trust them because
that France on CPU and can do everything

92
00:05:41,250 --> 00:05:48,250
up I'm in officially protects against
malware Trojans and rootkits

93
00:05:48,460 --> 00:05:52,169
and so-called trusted execution
environments which are basically small

94
00:05:52,169 --> 00:05:54,449
operating systems for running it

95
00:05:54,449 --> 00:05:58,050
and it's available since arm 36

96
00:05:58,050 --> 00:06:01,130
is that woods yup with

97
00:06:01,130 --> 00:06:04,720
basically on modern I'm see views

98
00:06:04,720 --> 00:06:07,860
yeah we will get to the irony of the
rootkit thing

99
00:06:07,860 --> 00:06:11,360
later

100
00:06:11,360 --> 00:06:16,449
um officially the I'm trust soon split
the CPU into two worlds

101
00:06:16,449 --> 00:06:20,350
I'm that's the official terminological
terminology you have to seek your world

102
00:06:20,350 --> 00:06:23,900
in which only trust that code runs and
you have the normal world in which your

103
00:06:23,900 --> 00:06:25,449
Windows Phone your Android

104
00:06:25,449 --> 00:06:28,699
your BlackBerry OS all whatever we're on

105
00:06:28,699 --> 00:06:32,580
on the communication between both worlds
is class have memory map

106
00:06:32,580 --> 00:06:36,940
say you're if you wan't who have trusts
and do something

107
00:06:36,940 --> 00:06:40,840
you put it into a mat memory area

108
00:06:40,840 --> 00:06:45,380
going to trust their own and trust and
we'll work on that memory

109
00:06:45,380 --> 00:06:50,199
and give back information be another
ship mapping

110
00:06:50,199 --> 00:06:54,280
on another cool thing is that the
current CPU status indicated Cooper

111
00:06:54,280 --> 00:06:55,199
flows

112
00:06:55,199 --> 00:06:59,259
on the on the internal process of the
CPU so you can have

113
00:06:59,259 --> 00:07:02,789
up like special memory does only
available

114
00:07:02,789 --> 00:07:06,110
and trust so a lot of mobile phones to
that was there

115
00:07:06,110 --> 00:07:10,250
integrated MMC card so they have a
partition that is only available in

116
00:07:10,250 --> 00:07:13,910
trust so

117
00:07:13,910 --> 00:07:18,330
me arm trusted execution Wyman's us up
they are basically

118
00:07:18,330 --> 00:07:22,050
small operating systems I'm providing
services to the

119
00:07:22,050 --> 00:07:25,319
normal world and you've right small

120
00:07:25,319 --> 00:07:28,590
apps for them like for instance your
yeah and driver

121
00:07:28,590 --> 00:07:33,099
you movie encoder whatever and pay
somebody I try to find out who have to

122
00:07:33,099 --> 00:07:36,470
paid or to actually get in STK oh to be
allowed

123
00:07:36,470 --> 00:07:41,259
to react to write such an app for the a
trust execution environment

124
00:07:41,259 --> 00:07:45,599
but nobody well was able to give me an
answer because I'm just the small

125
00:07:45,599 --> 00:07:46,370
company

126
00:07:46,370 --> 00:07:49,449
and so on that if you have any idea who

127
00:07:49,449 --> 00:07:53,970
what would be a good way to approach a
lender please contact them

128
00:07:53,970 --> 00:07:59,349
and you use em in your operating system
by a driver for instance on

129
00:07:59,349 --> 00:08:02,610
something devices you have us less steps
left

130
00:08:02,610 --> 00:08:06,419
she said I C which is a a small trusts
own driver

131
00:08:06,419 --> 00:08:11,560
and they often open source for instance
the official more like farm

132
00:08:11,560 --> 00:08:15,750
help drivers themselves and if you take
a look at it to me find some interesting

133
00:08:15,750 --> 00:08:18,780
thinks into if you revert

134
00:08:18,780 --> 00:08:22,879
example arm in the USA Netflix is very
common

135
00:08:22,879 --> 00:08:26,740
and they also wanted to go on mobile
devices Netflix's

136
00:08:26,740 --> 00:08:31,349
movie and TV shows streaming and if you
want the low quality videos on your

137
00:08:31,349 --> 00:08:33,000
device you have to get

138
00:08:33,000 --> 00:08:36,529
certified by Netflix for the low quality
videos you just

139
00:08:36,529 --> 00:08:40,479
you to show a key or devices fast enough
and we can really stream video in real

140
00:08:40,479 --> 00:08:42,180
time

141
00:08:42,180 --> 00:08:46,740
but for HD the beak movie labels week
why and 20 a.m.

142
00:08:46,740 --> 00:08:51,120
so Netflix have to come up come up for
something that

143
00:08:51,120 --> 00:08:56,160
ensures that no one is able to just
screen crapped the movie from the 80

144
00:08:56,160 --> 00:08:57,279
Feiss

145
00:08:57,279 --> 00:09:00,589
and what they do is basically they the
up

146
00:09:00,589 --> 00:09:06,120
dole chunks of to be do you put into
trust sewn into a trust soon

147
00:09:06,120 --> 00:09:10,630
young and the cryptid and displayed on
the screen so you conscious

148
00:09:10,630 --> 00:09:17,170
recalled the framebuffer on Android
because it's rendered in trust them

149
00:09:17,170 --> 00:09:21,140
yeah would what does it protect against
well

150
00:09:21,140 --> 00:09:25,000
first of trust so it's not only about
protecting the user

151
00:09:25,000 --> 00:09:29,200
but it's mostly bought protecting
against the device on a

152
00:09:29,200 --> 00:09:34,260
arm in cases of year the trust to
protect against No west so that

153
00:09:34,260 --> 00:09:37,540
your credit card via Google Wallet and
so on

154
00:09:37,540 --> 00:09:41,589
isn't really easily stole from the
device and it's hump his

155
00:09:41,589 --> 00:09:46,350
it protects against freedom because even
if you unlock your device and everything

156
00:09:46,350 --> 00:09:49,220
the trust thing called will still be
there and you will have no idea what it

157
00:09:49,220 --> 00:09:49,709
is.

158
00:09:49,709 --> 00:09:54,580
can do anything for instance the rootkit

159
00:09:54,580 --> 00:09:57,690
there so how does it work and the

160
00:09:57,690 --> 00:10:02,750
the official documentation I'll
describes it as a second registers have

161
00:10:02,750 --> 00:10:03,570
to see if you

162
00:10:03,570 --> 00:10:06,839
for so yeah it's basically you you
switch into

163
00:10:06,839 --> 00:10:10,529
the to seek your world and it feels like
you're

164
00:10:10,529 --> 00:10:13,899
your own up oMG for but actually your

165
00:10:13,899 --> 00:10:17,120
you're sharing it with said with you
know lmao

166
00:10:17,120 --> 00:10:20,940
was seen on the work call

167
00:10:20,940 --> 00:10:24,920
the mode switch from the normal world
into the secure World can be easily done

168
00:10:24,920 --> 00:10:25,470
by

169
00:10:25,470 --> 00:10:30,130
so-called Secure money talk all all my
heart exceptions for instance if you if

170
00:10:30,130 --> 00:10:31,560
the button is pressed or

171
00:10:31,560 --> 00:10:35,120
the NFC devices like 288 the

172
00:10:35,120 --> 00:10:38,470
the hard-working automatically switching
to CQ world

173
00:10:38,470 --> 00:10:43,089
there are also special in traffic
controllers available from them

174
00:10:43,089 --> 00:10:46,959
um on the internal buses tears the an
ass but which indicates the occurrence

175
00:10:46,959 --> 00:10:52,029
your state to all peripherals like
screen and so on

176
00:10:52,029 --> 00:10:55,339
so it looks basically like that you have
fewer

177
00:10:55,339 --> 00:10:58,470
normal world with all the privileged and
use a Moz

178
00:10:58,470 --> 00:11:01,750
is switching to GV to seek your world

179
00:11:01,750 --> 00:11:05,820
um which is you switch for some twists
more money to come out

180
00:11:05,820 --> 00:11:09,019
a small kobe's you look at it later

181
00:11:09,019 --> 00:11:12,410
and then into to seek your world where
you can have privilege modes and use

182
00:11:12,410 --> 00:11:16,019
them out so if you fight an app for
trusted execution environment

183
00:11:16,019 --> 00:11:19,370
it can actually run like a like an
application

184
00:11:19,370 --> 00:11:25,500
abstracted from the kind that doesn't
have hold the rights the courthouse

185
00:11:25,500 --> 00:11:28,800
so how doesn't actually work I'm you

186
00:11:28,800 --> 00:11:31,899
only have is one CPU core and

187
00:11:31,899 --> 00:11:37,459
do you doing you do call into the money
Tomo project for this and see mode here

188
00:11:37,459 --> 00:11:41,670
and the essence you know basically
stores on current registers

189
00:11:41,670 --> 00:11:46,200
turns on DNS bit and then gets packed
the

190
00:11:46,200 --> 00:11:50,730
execution through the to the standard
CPU but this time with the enabled and

191
00:11:50,730 --> 00:11:52,510
the spit on the on the bus and

192
00:11:52,510 --> 00:11:58,709
so it feels like but it's actually true
course but it's only one

193
00:11:58,709 --> 00:12:02,240
no and so the some steam ok basically

194
00:12:02,240 --> 00:12:05,389
has to detect okay

195
00:12:05,389 --> 00:12:08,899
secord request coming from the normal
world secure world

196
00:12:08,899 --> 00:12:12,269
and depending on that he's a star stuck
rent which the

197
00:12:12,269 --> 00:12:15,519
the richest those of the current world
both registers of the

198
00:12:15,519 --> 00:12:21,019
new world targets CNS but and kits
execution back

199
00:12:21,019 --> 00:12:25,100
on norian trust so nice of you have to
normal and to seek you out and you need

200
00:12:25,100 --> 00:12:26,380
a way to

201
00:12:26,380 --> 00:12:31,620
to separate memory areas so that your
number word

202
00:12:31,620 --> 00:12:35,360
contest access to memory of the secured

203
00:12:35,360 --> 00:12:38,720
and that's why on trust a neighbor
platforms you have the

204
00:12:38,720 --> 00:12:43,389
trust soon and then you a way you can
configure that

205
00:12:43,389 --> 00:12:47,579
cause some certain memory areas of only
available to your

206
00:12:47,579 --> 00:12:52,040
to secure world some shared for instance
only readable by the normal world

207
00:12:52,040 --> 00:12:55,680
on you write a book by Dan on the word
oppose

208
00:12:55,680 --> 00:12:59,459
and up %um than you have sonoma what
memory

209
00:12:59,459 --> 00:13:04,370
and the CQ what connects this on earth

210
00:13:04,370 --> 00:13:08,350
and %um I guess you see whites
handicraft that

211
00:13:08,350 --> 00:13:12,480
if you're writing a rootkit

212
00:13:12,480 --> 00:13:16,139
on before we can come to the interesting
stuff we have to talk about the boot

213
00:13:16,139 --> 00:13:17,260
process

214
00:13:17,260 --> 00:13:20,600
just sad companies like

215
00:13:20,600 --> 00:13:23,779
some song and Swan invest a lot of money
into securing

216
00:13:23,779 --> 00:13:29,570
who process of the devices on when you
start up the device you first have for

217
00:13:29,570 --> 00:13:32,839
arm very simple bootloader in the

218
00:13:32,839 --> 00:13:37,440
chip itself from the read-only memory
which Lowes some basic opera obstruction

219
00:13:37,440 --> 00:13:41,769
and then doesn't have reef integrity
verification of the 2nd stage Bangalore

220
00:13:41,769 --> 00:13:45,550
using for two keys start somewhere I

221
00:13:45,550 --> 00:13:49,639
not available to visit to Manama code

222
00:13:49,639 --> 00:13:53,110
then the second stage below deck it's
loaded from flash

223
00:13:53,110 --> 00:13:56,199
initialize the trust someone enters
trust some color

224
00:13:56,199 --> 00:14:00,470
looks down the device and than starts up
the operating system

225
00:14:00,470 --> 00:14:04,339
and its very important for for trusts
own system to work that

226
00:14:04,339 --> 00:14:08,019
both these on this page is in the
process

227
00:14:08,019 --> 00:14:11,570
I trusted I'm there on special trusted

228
00:14:11,570 --> 00:14:14,820
food up things available for noms

229
00:14:14,820 --> 00:14:18,490
and yeah if if you tried to really
unlike modern device you will see that

230
00:14:18,490 --> 00:14:20,810
they have quite good at it

231
00:14:20,810 --> 00:14:25,790
and and yet but as soon as one of the
pieces in this chain is broken trust

232
00:14:25,790 --> 00:14:27,000
Sonus program

233
00:14:27,000 --> 00:14:30,180
and so you could 10 readout secret keys

234
00:14:30,180 --> 00:14:34,139
and so on by the way if you go to

235
00:14:34,139 --> 00:14:37,380
HTC are similar companies and

236
00:14:37,380 --> 00:14:41,490
unlock your bootloader you are not
actual the unlock your bootloader

237
00:14:41,490 --> 00:14:44,510
they are unlocking the operating system
load up for you

238
00:14:44,510 --> 00:14:49,329
but all the destatis we we saw here
where the initialization of the Trust's

239
00:14:49,329 --> 00:14:52,579
own takes place on Sun where the real
bootloader is sides

240
00:14:52,579 --> 00:14:55,850
it's the luck locked up all

241
00:14:55,850 --> 00:14:58,949
so yeah your you will stay all are

242
00:14:58,949 --> 00:15:02,720
out of trusts and and your device were
running on the word for

243
00:15:02,720 --> 00:15:06,470
ever from

244
00:15:06,470 --> 00:15:10,670
I'm let's talk about how to support is
basically on Almaden CPU's

245
00:15:10,670 --> 00:15:14,139
essence teams including the the for

246
00:15:14,139 --> 00:15:17,810
a procesos home where Conley working
with some

247
00:15:17,810 --> 00:15:21,269
Americans on finding out more about that
I'm

248
00:15:21,269 --> 00:15:27,139
yeah so basically the No distorts the
small operating system somewhere on the

249
00:15:27,139 --> 00:15:29,959
CPU where you can control it where you
con

250
00:15:29,959 --> 00:15:33,709
just stop it like not it's not like a
small lightening

251
00:15:33,709 --> 00:15:37,269
task item which you which you can stuff
from the trading system but it will stay

252
00:15:37,269 --> 00:15:37,910
there

253
00:15:37,910 --> 00:15:42,470
you have no idea what it does and this
small operating system can do

254
00:15:42,470 --> 00:15:45,980
every fing and said party apps from

255
00:15:45,980 --> 00:15:49,630
untrusted and those from my side under
what's that

256
00:15:49,630 --> 00:15:53,399
on start int what could possibly go from

257
00:15:53,399 --> 00:15:56,540
we all know that they aren't going to
write very secure coat

258
00:15:56,540 --> 00:15:59,990
ride so

259
00:15:59,990 --> 00:16:03,550
yep let's talk about building an act for
rootkit

260
00:16:03,550 --> 00:16:08,360
interest here

261
00:16:08,360 --> 00:16:12,519
what a super small rockets at is a run
some trusts own

262
00:16:12,519 --> 00:16:15,990
and now even entirely

263
00:16:15,990 --> 00:16:20,070
in the money to promote if you lead
after all the features

264
00:16:20,070 --> 00:16:24,769
it's the first Russian rootkit and its
implemented entirely in Sumter because

265
00:16:24,769 --> 00:16:28,850
yeah compilers of producers

266
00:16:28,850 --> 00:16:33,089
yeah why would you do that for stuff

267
00:16:33,089 --> 00:16:36,360
it's fun it's it's really interesting
you will learn a lot of

268
00:16:36,360 --> 00:16:41,449
a lot about on procesos a a lot about

269
00:16:41,449 --> 00:16:44,550
what companies that implement such stuff

270
00:16:44,550 --> 00:16:47,880
do wrong and what they do right

271
00:16:47,880 --> 00:16:53,100
I'm all to people weren't talking about
ross own it felt like everyone knows

272
00:16:53,100 --> 00:16:53,870
that senator

273
00:16:53,870 --> 00:16:58,259
but no one actually tries to find out
what

274
00:16:58,259 --> 00:17:03,410
what are they doing there and to really
want for a sonar devices

275
00:17:03,410 --> 00:17:06,860
and can we use trust 74 on process like

276
00:17:06,860 --> 00:17:11,150
I don't know do our TPG may know
whatever their

277
00:17:11,150 --> 00:17:14,970
and also to if we are talking about
trusted computing

278
00:17:14,970 --> 00:17:19,140
the trust that is not only about the use
a trusting the hardware it's also part

279
00:17:19,140 --> 00:17:20,160
thereof and/or

280
00:17:20,160 --> 00:17:24,390
not trusting the user

281
00:17:24,390 --> 00:17:29,260
and mmm and some cases it's a bit about
stopping block because

282
00:17:29,260 --> 00:17:32,360
I'm not and an open-source at it when it
comes to that

283
00:17:32,360 --> 00:17:35,380
on I would like to at least be able to
disable it

284
00:17:35,380 --> 00:17:39,330
right now it's like you always have to
say this lot there with us

285
00:17:39,330 --> 00:17:44,280
whatever and I don't like that

286
00:17:44,280 --> 00:17:48,020
your ice trust in such a cool place a
sub

287
00:17:48,020 --> 00:17:52,850
the operating system come find you once
you're there the operating system

288
00:17:52,850 --> 00:17:56,919
main knows that something is interesting
but it has no idea was that city a.m.

289
00:17:56,919 --> 00:17:59,120
implementation whether it's

290
00:17:59,120 --> 00:18:02,120
I dunno GP gmail or a rootkit

291
00:18:02,120 --> 00:18:05,860
even boot loader love a memory an Asus
can't find it

292
00:18:05,860 --> 00:18:12,179
as long as the what HTC gives us. the
unlocked bootloader

293
00:18:12,179 --> 00:18:15,429
executes in the normal world and of them
there

294
00:18:15,429 --> 00:18:18,700
even special storage facility that you
can use to you

295
00:18:18,700 --> 00:18:23,049
lakh data and get away some or later on

296
00:18:23,049 --> 00:18:26,940
and AMD is building it into that just a
process also

297
00:18:26,940 --> 00:18:31,419
if we're lucky we can even with kids
duster PCs using in

298
00:18:31,419 --> 00:18:35,640
I'm rootkit it would be quite cool

299
00:18:35,640 --> 00:18:41,730
on the first problem I had when wanted
to try and solve was

300
00:18:41,730 --> 00:18:45,070
how do I test it I don't really like
only two

301
00:18:45,070 --> 00:18:48,480
doing something and softer because it
tends to to

302
00:18:48,480 --> 00:18:52,520
be different to the real world like if
you tried in chemo

303
00:18:52,520 --> 00:18:56,590
it will be different so I tried together
a deft bought

304
00:18:56,590 --> 00:18:59,700
the tea at Texas Instruments all map

305
00:18:59,700 --> 00:19:03,360
they all have trust them but they have
two versions sissy

306
00:19:03,360 --> 00:19:06,390
to HS like this that stands for a
high-security

307
00:19:06,390 --> 00:19:10,620
version and the general purpose version
if you buy a bigger boat

308
00:19:10,620 --> 00:19:14,030
everything runs in on what the the
Trust's onus

309
00:19:14,030 --> 00:19:17,230
completely locked down and you have no
idea what happens there

310
00:19:17,230 --> 00:19:21,870
and they they're really good at locking
it down so you can just

311
00:19:21,870 --> 00:19:25,210
exploitable from quite difficult as it
seems

312
00:19:25,210 --> 00:19:28,320
I haven't tried it myself but

313
00:19:28,320 --> 00:19:31,720
then there's software emulation three
months apart arm

314
00:19:31,720 --> 00:19:35,510
and so what's a very good paper about up

315
00:19:35,510 --> 00:19:38,730
about and suffer development for trust
so

316
00:19:38,730 --> 00:19:42,010
and they actually built chemo trust so
much

317
00:19:42,010 --> 00:19:46,039
does a good job at and emulating trust
so and until

318
00:19:46,039 --> 00:19:49,590
from three months ago that was the only
way for me to test and then look the

319
00:19:49,590 --> 00:19:50,690
whole thing

320
00:19:50,690 --> 00:19:54,070
I'm to them I'll we

321
00:19:54,070 --> 00:19:59,929
we found a heart for heck for certain
devices for certain class of devices

322
00:19:59,929 --> 00:20:03,539
to execute code interesting but it's a
bit ugly because you have to

323
00:20:03,539 --> 00:20:07,330
the soldier around with very very small
recess to some stuff

324
00:20:07,330 --> 00:20:10,950
and and also I i really wanted to do
this

325
00:20:10,950 --> 00:20:15,990
to do this I wanted to hack into a
trusted execution alignment

326
00:20:15,990 --> 00:20:20,210
helm the whole thing isn't really set
the whole

327
00:20:20,210 --> 00:20:24,510
X a exploits for trusted execution women
since on there will be released later

328
00:20:24,510 --> 00:20:25,490
this year

329
00:20:25,490 --> 00:20:28,730
so I will only cover a small overview

330
00:20:28,730 --> 00:20:32,140
um the first that for for

331
00:20:32,140 --> 00:20:35,549
getting to to work on a real device was
so I want to trek into a trusted

332
00:20:35,549 --> 00:20:37,240
execution environment

333
00:20:37,240 --> 00:20:40,900
growth and I could proof that my idea
works are really more by phone and that

334
00:20:40,900 --> 00:20:41,929
it's a real problem

335
00:20:41,929 --> 00:20:46,720
and so on and their first that was
getting a binary image of a trust

336
00:20:46,720 --> 00:20:49,840
execution environment unfortunately
they're not open source

337
00:20:49,840 --> 00:20:54,919
now there's one open source but thats ok
it was sexually open so they just put it

338
00:20:54,919 --> 00:20:55,730
down

339
00:20:55,730 --> 00:20:59,470
yeah firmware updates for most Android
devices

340
00:20:59,470 --> 00:21:03,030
are only signed but not encrypt it so
you can just

341
00:21:03,030 --> 00:21:07,039
download user triste by tone-loc by
sniffing

342
00:21:07,039 --> 00:21:10,600
are downloaded from the vendors

343
00:21:10,600 --> 00:21:15,350
in FTP service you can google for them
in with a to pee and then a nameless

344
00:21:15,350 --> 00:21:20,000
quite successful and yep you can just
download them from the

345
00:21:20,000 --> 00:21:24,929
from the net and try to split them apart
because they also contain your Android

346
00:21:24,929 --> 00:21:28,850
stuff application stuff and so on

347
00:21:28,850 --> 00:21:32,919
the basic workflow for that is the to
disassemble the bootloader

348
00:21:32,919 --> 00:21:36,080
unfortunately when you start to analyze
the bootloader

349
00:21:36,080 --> 00:21:40,870
something similar it's not like a stand
up in those executed over to load into

350
00:21:40,870 --> 00:21:42,260
either and it will

351
00:21:42,260 --> 00:21:45,299
automatically ya this coat their state
to

352
00:21:45,299 --> 00:21:49,390
I'm because it's it's not and and
execute will file format it's really

353
00:21:49,390 --> 00:21:52,299
just instructions and the daytime extend
your

354
00:21:52,299 --> 00:21:56,320
have to find out a like 50

355
00:21:56,320 --> 00:22:00,909
if the process all switches the state
from sucky to bid to 16 that something

356
00:22:00,909 --> 00:22:02,380
structions and back

357
00:22:02,380 --> 00:22:05,820
know you have to find us all and

358
00:22:05,820 --> 00:22:09,570
yup this is wanted first look like when
I loaded

359
00:22:09,570 --> 00:22:13,809
in and run some auto analyst with he

360
00:22:13,809 --> 00:22:17,970
is this a yellow I guess this yellow
stuff is

361
00:22:17,970 --> 00:22:23,600
I have no idea what what recite Surah
and to do stuff artful instructions

362
00:22:23,600 --> 00:22:27,809
and this is after I was finished with
that the specific image

363
00:22:27,809 --> 00:22:31,299
and this is all up the code

364
00:22:31,299 --> 00:22:34,850
K and yup

365
00:22:34,850 --> 00:22:38,330
if you if you see boot up the device and

366
00:22:38,330 --> 00:22:43,010
execute some code it make on furious the
a menu and the whole memory mapping

367
00:22:43,010 --> 00:22:43,860
stuff

368
00:22:43,860 --> 00:22:46,860
you have to find out which address are

369
00:22:46,860 --> 00:22:50,270
issue food you're actually running at
which address your trust some code

370
00:22:50,270 --> 00:22:51,120
running

371
00:22:51,120 --> 00:22:55,450
and if you if you are really unlucky you
will have to analyze a lot of core

372
00:22:55,450 --> 00:22:57,610
processor instructions by hand

373
00:22:57,610 --> 00:23:02,450
a till you find out how it works

374
00:23:02,450 --> 00:23:06,440
but then I started looking for a
runtime: medications like

375
00:23:06,440 --> 00:23:11,900
adult space layout randomization & Co in
the trust execution in layman's

376
00:23:11,900 --> 00:23:17,740
and help I was really wondering whether
they are

377
00:23:17,740 --> 00:23:21,750
ferry very good implemented I just not
there and that

378
00:23:21,750 --> 00:23:26,090
that tensile no address space layout
randomization no

379
00:23:26,090 --> 00:23:30,250
update Execution Prevention I an expert

380
00:23:30,250 --> 00:23:34,710
execute with you spectator everything
ads

381
00:23:34,710 --> 00:23:41,710
basically exploiting like it's 1999

382
00:23:42,309 --> 00:23:47,150
I'm justices suggest some suggest

383
00:23:47,150 --> 00:23:52,740
yep just the tip a

384
00:23:52,740 --> 00:23:55,820
its mmm the PE is lot

385
00:23:55,820 --> 00:23:59,500
as easy as it seems I'm if you use

386
00:23:59,500 --> 00:24:03,409
a strong cup you too to copy a string
from one befriends another

387
00:24:03,409 --> 00:24:06,700
and you give the destination move size
and

388
00:24:06,700 --> 00:24:11,070
you're just saw stuff 6 likely as large
as the destination size

389
00:24:11,070 --> 00:24:16,230
string Cup you won't know terminate have

390
00:24:16,230 --> 00:24:20,870
please use the compy which is that use
the

391
00:24:20,870 --> 00:24:23,929
iced aspirin copy function and also to

392
00:24:23,929 --> 00:24:27,750
I do code review so if you have problems
with such stuff

393
00:24:27,750 --> 00:24:31,590
hate and the yet they're still

394
00:24:31,590 --> 00:24:35,690
of me pretty hard to exploit but in this
case it was very easy because

395
00:24:35,690 --> 00:24:40,640
immediately after the the so stuff like
him as a buffer

396
00:24:40,640 --> 00:24:43,970
where could put data and it was really
easy to exploit

397
00:24:43,970 --> 00:24:48,460
your find more about that later this
year

398
00:24:48,460 --> 00:24:51,960
so yeah we now have for ways to

399
00:24:51,960 --> 00:24:57,860
as three ways to actually test but for
at the rootkit and

400
00:24:57,860 --> 00:25:02,760
it's quite awesome the first thing you
have to think about

401
00:25:02,760 --> 00:25:06,440
is how will I get my own kid to execute
regularly

402
00:25:06,440 --> 00:25:10,169
because if if you're just put into trust
them it will be there

403
00:25:10,169 --> 00:25:14,390
it will be in Rome but how do we get
them to see if you to actually executed

404
00:25:14,390 --> 00:25:15,730
in regular intervals

405
00:25:15,730 --> 00:25:19,230
because I conscious pregnant or driver
caused

406
00:25:19,230 --> 00:25:25,049
who'd kid schedule that targets every
100 milliseconds also

407
00:25:25,049 --> 00:25:28,630
and young so

408
00:25:28,630 --> 00:25:34,150
also the latency that is induced by the
by the use of the rootkit must be very

409
00:25:34,150 --> 00:25:36,370
very low to the fugue

410
00:25:36,370 --> 00:25:40,679
comes just analyze to the latency
between certain clothes

411
00:25:40,679 --> 00:25:44,230
and see oh yeah it now takes like

412
00:25:44,230 --> 00:25:47,299
one milliseconds to you to something
called so do you

413
00:25:47,299 --> 00:25:50,440
software interrupts there's something
happening there

414
00:25:50,440 --> 00:25:54,020
um yet

415
00:25:54,020 --> 00:25:57,460
to to make them more clear if you for
instance you can

416
00:25:57,460 --> 00:26:01,620
something trips to immediately jumped
into the secure World

417
00:26:01,620 --> 00:26:06,620
so does the sum for you so you still
substandard soft interrupts

418
00:26:06,620 --> 00:26:09,970
so that as soon as interrupt accuses
refuse

419
00:26:09,970 --> 00:26:14,789
changes in to seek him out and when you
took ok it's executed my rude kid gets

420
00:26:14,789 --> 00:26:15,799
executed for

421
00:26:15,799 --> 00:26:19,730
for small-time and then it switches back
into the money to a coat and back to

422
00:26:19,730 --> 00:26:20,900
normal well

423
00:26:20,900 --> 00:26:24,520
I'm the pot I'm Octorara to: will

424
00:26:24,520 --> 00:26:28,140
will be latency you have to make all
this

425
00:26:28,140 --> 00:26:32,760
as fast as possible so if you look at
his company a lot of state head to the

426
00:26:32,760 --> 00:26:34,710
integrated MMC

427
00:26:34,710 --> 00:26:40,620
you may not want to be do 1 gigabyte
transfer at once on the softer entrapped

428
00:26:40,620 --> 00:26:45,049
up keep you will notice

429
00:26:45,049 --> 00:26:49,669
but luckily I'm gives gifts even some
tips on how to

430
00:26:49,669 --> 00:26:54,169
invisibly runs slow once once a

431
00:26:54,169 --> 00:26:57,210
here code in entrusting

432
00:26:57,210 --> 00:27:00,740
I'm because you can day they

433
00:27:00,740 --> 00:27:04,299
a suggests that you obfuscate interrupt
timing

434
00:27:04,299 --> 00:27:08,830
and try to to make it a bit fuzzy is
that you contest medal

435
00:27:08,830 --> 00:27:13,080
whether they would kid is executing or
not so even if you're idk it has nothing

436
00:27:13,080 --> 00:27:14,289
to do

437
00:27:14,289 --> 00:27:18,210
you still want to waste time on n on a
soft interrupt so that

438
00:27:18,210 --> 00:27:22,200
com PD determine whether to is doing
something or not

439
00:27:22,200 --> 00:27:25,360
you can use the performance contest to
measure the

440
00:27:25,360 --> 00:27:28,669
the time the virtualization talk today

441
00:27:28,669 --> 00:27:32,630
sure it's really a have some similar
analysis to find out was that you're

442
00:27:32,630 --> 00:27:33,110
running

443
00:27:33,110 --> 00:27:36,779
on virtualized environment and it's
basically the same problem

444
00:27:36,779 --> 00:27:41,580
I'm yep

445
00:27:41,580 --> 00:27:44,610
so I I already talked about

446
00:27:44,610 --> 00:27:47,860
using interrupts to transfer the country
road to the

447
00:27:47,860 --> 00:27:50,860
arms as he came out um

448
00:27:50,860 --> 00:27:54,149
there are two kinds of contracts on on
this the

449
00:27:54,149 --> 00:27:57,480
if I Q the fast interrupt and then there
is the enormous

450
00:27:57,480 --> 00:28:02,230
slow interrupt I'm the fast interrupt
can be

451
00:28:02,230 --> 00:28:07,149
put a can be locked down so that it can
be masked by in on the world say

452
00:28:07,149 --> 00:28:10,440
for fast track to cures it will always
land

453
00:28:10,440 --> 00:28:14,600
and see mode and it will always execute
Norman trucks coming months so that they

454
00:28:14,600 --> 00:28:16,700
don't interrupt for instance if a if I
have

455
00:28:16,700 --> 00:28:20,919
very time-sensitive part of code I will
disable interrupts

456
00:28:20,919 --> 00:28:26,750
to that can make sure that the code
executes very fast

457
00:28:26,750 --> 00:28:31,070
on then there's the external abort
interrupts like if you if you do it

458
00:28:31,070 --> 00:28:32,640
invalid memory access

459
00:28:32,640 --> 00:28:36,460
I'm you can really use that to go to
into the secure because a

460
00:28:36,460 --> 00:28:40,520
you can't predict when they will happen
you don't know with that will happen a

461
00:28:40,520 --> 00:28:41,149
lot of

462
00:28:41,149 --> 00:28:45,230
sometimes and so on I'm

463
00:28:45,230 --> 00:28:48,520
you could overwrite the interrupt vector
so good

464
00:28:48,520 --> 00:28:51,669
if you decide that the normal world will
handle all interrupts you can just

465
00:28:51,669 --> 00:28:53,330
alright interrupt vector

466
00:28:53,330 --> 00:28:57,260
on the research firm IDC IDC look at the
thought the such a very good

467
00:28:57,260 --> 00:29:01,610
I'm and there are even special trust in
traffic controller switch

468
00:29:01,610 --> 00:29:05,659
could be you spend it's difficult to
find documentation about them because

469
00:29:05,659 --> 00:29:06,779
every vendor

470
00:29:06,779 --> 00:29:11,940
make changes some things interface and
so on

471
00:29:11,940 --> 00:29:15,299
yep to to get better picture about up

472
00:29:15,299 --> 00:29:18,620
HQ interception I'm assume

473
00:29:18,620 --> 00:29:22,020
my phones notices

474
00:29:22,020 --> 00:29:25,590
works um a cynicism as a soft instruct

475
00:29:25,590 --> 00:29:28,740
obscures the money to a safe the state
of the normal world

476
00:29:28,740 --> 00:29:31,909
executes a small slice of the rootkit

477
00:29:31,909 --> 00:29:35,730
resource the state and the real
interrupt handlers called

478
00:29:35,730 --> 00:29:38,820
and s at this is what the what the late
what

479
00:29:38,820 --> 00:29:45,669
generates latency and we have to be very
very very fast

480
00:29:45,669 --> 00:29:49,440
so yup I after finding all this

481
00:29:49,440 --> 00:29:53,799
scheduling stuff and testing it a lot
said to fine or is it really works

482
00:29:53,799 --> 00:29:55,320
because there are some

483
00:29:55,320 --> 00:29:58,580
differences 3 to you cute simply

484
00:29:58,580 --> 00:30:03,210
a bit between the emulation and three
words

485
00:30:03,210 --> 00:30:07,679
and yup the basic will process thoughts
were susceptible to seek you out

486
00:30:07,679 --> 00:30:11,100
business basically fought off the a

487
00:30:11,100 --> 00:30:14,700
the from bootloader into your own would
lower

488
00:30:14,700 --> 00:30:19,779
and the first thing you have to do is
set up memory you will have to

489
00:30:19,779 --> 00:30:23,630
to turn on the MM you tell domu hey

490
00:30:23,630 --> 00:30:27,600
I'm trust them give me to Syria and make
sure that no matter what connects this

491
00:30:27,600 --> 00:30:28,570
kid

492
00:30:28,570 --> 00:30:32,240
country a stack create a page tabor and

493
00:30:32,240 --> 00:30:36,570
I would suggest a few yeah if you didn't

494
00:30:36,570 --> 00:30:40,980
try if there's no trust execution away
I'm normally installed on your device

495
00:30:40,980 --> 00:30:45,710
put the rootkit into an address space
next to a hot from Appling

496
00:30:45,710 --> 00:30:48,710
or autumn as a mapping so that someone
who

497
00:30:48,710 --> 00:30:53,120
tries to implement something will only
thing all the documentation is

498
00:30:53,120 --> 00:30:58,149
from the pub for of the devices sexual
lot or something similar

499
00:30:58,149 --> 00:31:01,880
I'm yet um the utilization

500
00:31:01,880 --> 00:31:06,179
I'm I try to make my where it could as
enterprise the

501
00:31:06,179 --> 00:31:09,779
as possible to you can actually install
absent my rooted

502
00:31:09,779 --> 00:31:14,059
a and as the system boots you

503
00:31:14,059 --> 00:31:18,279
you will have to insert initialize truth
is that you can set up its memory

504
00:31:18,279 --> 00:31:21,279
soda it its mature threats con furore

505
00:31:21,279 --> 00:31:24,450
a small system called facilities to I

506
00:31:24,450 --> 00:31:28,200
implemented a small facility which with
which you can store stuff on the

507
00:31:28,200 --> 00:31:31,350
integrated MMC and so on and it loads

508
00:31:31,350 --> 00:31:36,850
much you it's if markets are configured

509
00:31:36,850 --> 00:31:41,299
I'm this scheduler is the time up a
slice scheduler

510
00:31:41,299 --> 00:31:45,070
I am and in the on the actual heart for
I you see

511
00:31:45,070 --> 00:31:48,100
X external interrupt controller to make
sure that my

512
00:31:48,100 --> 00:31:52,710
could only executes for very small time
until it gets back

513
00:31:52,710 --> 00:31:57,460
I'm I'm yeah and I store files and
secure storage

514
00:31:57,460 --> 00:32:01,419
if available this is quite difficult
because fining

515
00:32:01,419 --> 00:32:05,350
out which part of TLC or of the
peripherals

516
00:32:05,350 --> 00:32:09,429
are actually only available in the
secure World

517
00:32:09,429 --> 00:32:13,500
yen you won't find any documentation on
that for a moment

518
00:32:13,500 --> 00:32:16,539
mobile phones

519
00:32:16,539 --> 00:32:20,279
the seconds to is a setting up the money
trail code

520
00:32:20,279 --> 00:32:25,250
which was started progression between
the normandy you want him back

521
00:32:25,250 --> 00:32:28,890
I'm such as well star to register banks

522
00:32:28,890 --> 00:32:34,760
turn on the NS that execute a rootkit
scan you look code

523
00:32:34,760 --> 00:32:40,539
restart the media ought register banks
and turn off the NS but

524
00:32:40,539 --> 00:32:43,720
yet this is the actual assembly code
it's it's I

525
00:32:43,720 --> 00:32:47,110
very very easy to write monitor code you

526
00:32:47,110 --> 00:32:50,200
here you just get the current state of
to see of the

527
00:32:50,200 --> 00:32:53,740
and asked that from the co-processor 15

528
00:32:53,740 --> 00:32:56,820
you test whether it's a

529
00:32:56,820 --> 00:33:00,279
it's you or not and depending on true or
not

530
00:33:00,279 --> 00:33:06,130
you will see you whether you're coming
from Nov from secure

531
00:33:06,130 --> 00:33:09,539
after that you will have to solve it
just the bank's

532
00:33:09,539 --> 00:33:13,590
this is an instruction on arm which just
saw Steve

533
00:33:13,590 --> 00:33:17,210
at the congress just us Hummel to a
certain

534
00:33:17,210 --> 00:33:21,059
no code is forty whatever

535
00:33:21,059 --> 00:33:26,549
to memory and and you switch to all see
few mods and to the same for faulty view

536
00:33:26,549 --> 00:33:27,380
modes

537
00:33:27,380 --> 00:33:33,559
says that you want to affect anything
and vice versa if you are restoring them

538
00:33:33,559 --> 00:33:36,850
um an important thing to keep track of

539
00:33:36,850 --> 00:33:41,419
is cash and type long stuff because if
you if your car for a few

540
00:33:41,419 --> 00:33:44,440
26 memory accesses in the secure World

541
00:33:44,440 --> 00:33:48,049
and they're still in cash and you switch
back to normal world the normal what

542
00:33:48,049 --> 00:33:51,330
might be able to retrieve to catch
contents

543
00:33:51,330 --> 00:33:54,730
be sure to if you catch configuration
right and use pipeline flush

544
00:33:54,730 --> 00:33:56,620
instructions because if you're

545
00:33:56,620 --> 00:34:03,029
seeker if you're ton of TNS but while
being in this secure world

546
00:34:03,029 --> 00:34:06,260
maybe some instructions of your secure
code

547
00:34:06,260 --> 00:34:09,599
was the in a pipeline and execute

548
00:34:09,599 --> 00:34:12,690
I'm yep another thing as

549
00:34:12,690 --> 00:34:16,030
a wrong what I did for latency reduction
assistant for the

550
00:34:16,030 --> 00:34:20,270
for the whole starring register banks
and so on I use tightly coupled memory

551
00:34:20,270 --> 00:34:24,639
I'm but this memories is very very fast
Texas on the CPU

552
00:34:24,639 --> 00:34:30,000
a and that massively reduced the time I
spent in the morning to remote

553
00:34:30,000 --> 00:34:34,329
when benchmarking and as more time as i
safe there

554
00:34:34,329 --> 00:34:39,359
as more have that will I have to execute
my rooted

555
00:34:39,359 --> 00:34:43,560
the next fing what's that there's a
secure configuration just on the

556
00:34:43,560 --> 00:34:45,710
co-processor which I use to

557
00:34:45,710 --> 00:34:49,599
to use up the IAC you to always some
into CQ world

558
00:34:49,599 --> 00:34:53,770
you can actually tell the co-processor
to make sure that the normal world

559
00:34:53,770 --> 00:34:55,050
country

560
00:34:55,050 --> 00:34:58,420
the state of those registers to the
normal world won't even know was that

561
00:34:58,420 --> 00:34:59,240
the

562
00:34:59,240 --> 00:35:03,500
up whether interrupts jumping into the
normal or insecure world

563
00:35:03,500 --> 00:35:10,260
which comes in quite handy handy for
executing invisibly

564
00:35:10,260 --> 00:35:13,390
did next up is a lockdown of the trust
so

565
00:35:13,390 --> 00:35:17,200
him um which is basically

566
00:35:17,200 --> 00:35:20,930
disable the modification of certain that
Sonic co-processor

567
00:35:20,930 --> 00:35:24,760
set up the world's and disable DNS but
so that your run

568
00:35:24,760 --> 00:35:29,820
and normal this is just a sample
configuration if you play was a

569
00:35:29,820 --> 00:35:33,810
through you can get the slides online
and yet it will help you

570
00:35:33,810 --> 00:35:37,170
take this ok and

571
00:35:37,170 --> 00:35:40,589
I decided you can is able

572
00:35:40,589 --> 00:35:44,310
that the normal work can mask disable
interrupts

573
00:35:44,310 --> 00:35:47,460
but I decided to not do it because a

574
00:35:47,460 --> 00:35:52,109
yet it will be suspicious if if the
hardware is not able to you

575
00:35:52,109 --> 00:35:58,940
disable interrupts why would somebody do
that

576
00:35:58,940 --> 00:36:02,540
now also depending on which part for
your running on you may need to calm

577
00:36:02,540 --> 00:36:04,440
fears some other peripherals

578
00:36:04,440 --> 00:36:09,440
I exxon a storage Mary crests a special
configuration to make sure that a normal

579
00:36:09,440 --> 00:36:10,390
work found

580
00:36:10,390 --> 00:36:13,540
X a certain a partitions and so on

581
00:36:13,540 --> 00:36:16,589
and those trusts own protection
controller

582
00:36:16,589 --> 00:36:20,540
which also just some 13 had checked to
make sure that

583
00:36:20,540 --> 00:36:23,740
you stay invisible yet enough

584
00:36:23,740 --> 00:36:26,940
that you just RT normal operating system

585
00:36:26,940 --> 00:36:30,530
are operating system load up have

586
00:36:30,530 --> 00:36:34,630
set the trusts and his computer the
operating system starts entirely on

587
00:36:34,630 --> 00:36:38,750
modified he don't need to touch anything
not even the operating system lower

588
00:36:38,750 --> 00:36:42,190
are you can actually booed boat after

589
00:36:42,190 --> 00:36:45,859
the whole configuration thing and
nothing to see here for the operating

590
00:36:45,859 --> 00:36:47,579
system

591
00:36:47,579 --> 00:36:50,810
yep River problems up

592
00:36:50,810 --> 00:36:54,079
i'd a I try to do it on a

593
00:36:54,079 --> 00:36:59,170
certainly vice first and I couldn't get
it to work at all I was sure that

594
00:36:59,170 --> 00:37:02,780
I was a doing everything rights
otherwise and the nine

595
00:37:02,780 --> 00:37:06,540
I started to reverse engineering their
original trussing code

596
00:37:06,540 --> 00:37:12,900
and as it turns out they yeah actually
do some complicated par management setup

597
00:37:12,900 --> 00:37:16,770
in trust them so I had to integrate the
vendor blog

598
00:37:16,770 --> 00:37:20,820
into this image and I twice

599
00:37:20,820 --> 00:37:23,970
terror

600
00:37:23,970 --> 00:37:29,420
yet it boots up what do we do know

601
00:37:29,420 --> 00:37:32,680
we have an execution environment that is
entirely separated

602
00:37:32,680 --> 00:37:36,240
from from the known as: I am

603
00:37:36,240 --> 00:37:39,240
we have configured to CPU and all the
perfect stride

604
00:37:39,240 --> 00:37:43,579
all traces of what we are doing and we
get control of to see if you regularly

605
00:37:43,579 --> 00:37:44,280
because

606
00:37:44,280 --> 00:37:48,250
suffering through ups I used a lot by
operating systems

607
00:37:48,250 --> 00:37:51,609
and yeah

608
00:37:51,609 --> 00:37:56,400
weekend X's all user data and doesn't
matter if it's the integrated

609
00:37:56,400 --> 00:38:01,450
SD card if it's something else we can
manipulate memory of everything

610
00:38:01,450 --> 00:38:04,859
actually use trust 72 some

611
00:38:04,859 --> 00:38:09,440
lockdown Android versions on certain
devices so that I can

612
00:38:09,440 --> 00:38:13,920
take a look at what the Android stewing
I what they're trying to hide

613
00:38:13,920 --> 00:38:18,070
and we can communicate and the software
want to talk

614
00:38:18,070 --> 00:38:21,780
yep yet but communication

615
00:38:21,780 --> 00:38:26,119
is quite hot because you're as you can
imagine you you can't just send it out

616
00:38:26,119 --> 00:38:28,619
by not for because he you're not running
and metrics

617
00:38:28,619 --> 00:38:31,940
like on trust so has a few words and

618
00:38:31,940 --> 00:38:35,190
normal operating system couldn't use
that trick anymore

619
00:38:35,190 --> 00:38:38,820
um was quite difficult to find a
solution for that

620
00:38:38,820 --> 00:38:42,730
um you can either talk to the basement
directly

621
00:38:42,730 --> 00:38:48,050
up like reset the heart and and tell it
to you

622
00:38:48,050 --> 00:38:51,950
connect to you and yes and just send it
out for you and just

623
00:38:51,950 --> 00:38:56,020
which at least for a normal person is
very difficult to sniff

624
00:38:56,020 --> 00:38:59,660
I'll but its really

625
00:38:59,660 --> 00:39:02,790
a a pain in the ass to implement

626
00:39:02,790 --> 00:39:06,710
and does also just suggests said axis
Justin by

627
00:39:06,710 --> 00:39:09,829
bike loca I'm that we

628
00:39:09,829 --> 00:39:14,020
talk directly to network hardware but
the problem is a

629
00:39:14,020 --> 00:39:18,650
yup you will notice if your phone sends
out eight er

630
00:39:18,650 --> 00:39:23,070
are a few if you have a good network
administrator and so on

631
00:39:23,070 --> 00:39:26,640
it's very suspicious and very easy to
detect

632
00:39:26,640 --> 00:39:30,650
so yeah communication a squid

633
00:39:30,650 --> 00:39:34,119
what else can we do there's quite some
secret stuff away little

634
00:39:34,119 --> 00:39:38,109
once you break into running trusted
execution alignment

635
00:39:38,109 --> 00:39:42,579
you will find interesting keys you will
find interesting

636
00:39:42,579 --> 00:39:46,920
papers fighter and

637
00:39:46,920 --> 00:39:50,690
it's interesting but I won't go into too
much details year until

638
00:39:50,690 --> 00:39:54,650
every few three soft

639
00:39:54,650 --> 00:39:58,579
from yeah how can we install it and wild
we can

640
00:39:58,579 --> 00:40:02,320
use a on Android app to exploit the

641
00:40:02,320 --> 00:40:07,710
the BAPI week and have to vendo deliver
it like in

642
00:40:07,710 --> 00:40:12,200
Wis Carrier IQ and so on Aug by a
firmware update if

643
00:40:12,200 --> 00:40:16,829
like if your government organization I
would guess that

644
00:40:16,829 --> 00:40:20,290
vendors would would sign

645
00:40:20,290 --> 00:40:23,339
your custom boot loader with special
features for you

646
00:40:23,339 --> 00:40:28,720
or you can use a basement attack and to
it from there

647
00:40:28,720 --> 00:40:32,250
I'm yeah I back to be a bit quick

648
00:40:32,250 --> 00:40:35,540
I'm intro interoperability

649
00:40:35,540 --> 00:40:39,430
ports in your heart for a very easy to
do because that's almost the same

650
00:40:39,430 --> 00:40:43,329
on all hot how to platform so soon as s
you get your coat into trusts on

651
00:40:43,329 --> 00:40:44,930
everything is cool

652
00:40:44,930 --> 00:40:48,089
and only some her for a little

653
00:40:48,089 --> 00:40:52,109
and memory stuff def us and Jermaine
missing some

654
00:40:52,109 --> 00:40:56,869
some chips which not have to week on
Flickr 10

655
00:40:56,869 --> 00:41:01,750
I also started binary patching a trusted
execution Oh I meant to actually contain

656
00:41:01,750 --> 00:41:02,430
my rootkit

657
00:41:02,430 --> 00:41:06,890
just for demonstration purposes I'm I'm
not using it for

658
00:41:06,890 --> 00:41:11,300
work it's just them funnies from
informal so

659
00:41:11,300 --> 00:41:15,119
if your device gets owned I'm not at
fault

660
00:41:15,119 --> 00:41:20,040
and get this an open-source I'll TV
which is quite interesting to look at

661
00:41:20,040 --> 00:41:24,500
and I in to rate my code into it and
through and planning to use it

662
00:41:24,500 --> 00:41:28,530
open source later this year here

663
00:41:28,530 --> 00:41:33,780
um yet detection methods a sub the main
detection method would be latency

664
00:41:33,780 --> 00:41:38,109
on if you're stupid at communicating

665
00:41:38,109 --> 00:41:42,579
um and the only way to avoid having a
phone

666
00:41:42,579 --> 00:41:46,079
having a blob and trust in His to

667
00:41:46,079 --> 00:41:49,490
use phones that don't have trust them
but good luck was finding

668
00:41:49,490 --> 00:41:52,940
and your so

669
00:41:52,940 --> 00:41:56,180
thank you and any questions

670
00:41:56,180 --> 00:42:03,180
here

671
00:42:03,460 --> 00:42:05,289
the slight so online

672
00:42:05,289 --> 00:42:08,890
any questions no

673
00:42:08,890 --> 00:42:11,990
but them thank you very much

