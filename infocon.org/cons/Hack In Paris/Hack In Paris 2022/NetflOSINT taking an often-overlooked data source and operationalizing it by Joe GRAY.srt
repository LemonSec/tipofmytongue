1
00:00:01,920 --> 00:00:05,839
so uh thanks for attending netflow sent

2
00:00:05,839 --> 00:00:08,800
this is taking an often overlooked

3
00:00:08,800 --> 00:00:12,880
data source and operationalizing it so

4
00:00:12,880 --> 00:00:15,599
we're gonna we're gonna explore things

5
00:00:15,599 --> 00:00:17,119
from

6
00:00:17,119 --> 00:00:18,080
to

7
00:00:18,080 --> 00:00:20,320
to a certain level kind of like beginner

8
00:00:20,320 --> 00:00:23,279
network forensics or

9
00:00:23,279 --> 00:00:25,439
maybe network engineering

10
00:00:25,439 --> 00:00:27,439
and go through an odyssey of what we

11
00:00:27,439 --> 00:00:30,880
could do with that that we could run

12
00:00:30,880 --> 00:00:34,239
into possible osen scenarios

13
00:00:34,239 --> 00:00:34,960
so

14
00:00:34,960 --> 00:00:36,000
about me

15
00:00:36,000 --> 00:00:37,520
i'm the founder principal instructor

16
00:00:37,520 --> 00:00:40,160
content developer at the ascension

17
00:00:40,160 --> 00:00:42,640
i also work in threat hunt and threat

18
00:00:42,640 --> 00:00:44,719
intelligence at murcari

19
00:00:44,719 --> 00:00:46,640
i wrote a book practical social

20
00:00:46,640 --> 00:00:50,160
engineering i have a few copies for sale

21
00:00:50,160 --> 00:00:51,840
out in the

22
00:00:51,840 --> 00:00:53,920
coffee area after the presentation i'll

23
00:00:53,920 --> 00:00:56,960
also have a coupon code for you

24
00:00:56,960 --> 00:00:59,120
beyond that i've got some certifications

25
00:00:59,120 --> 00:01:01,199
i like to do research and i've been

26
00:01:01,199 --> 00:01:03,840
awarded two black badges from trace labs

27
00:01:03,840 --> 00:01:05,040
and one

28
00:01:05,040 --> 00:01:05,920
for

29
00:01:05,920 --> 00:01:08,159
winning the 2017 social engineering

30
00:01:08,159 --> 00:01:10,640
capture the flag at derby con

31
00:01:10,640 --> 00:01:12,560
so why this talk

32
00:01:12,560 --> 00:01:14,320
well

33
00:01:14,320 --> 00:01:15,680
beyond what

34
00:01:15,680 --> 00:01:18,640
those words on the slide say

35
00:01:18,640 --> 00:01:20,320
why this talk

36
00:01:20,320 --> 00:01:23,680
i lost my job in december of last year

37
00:01:23,680 --> 00:01:27,680
and i was unemployed for a few months

38
00:01:27,680 --> 00:01:30,000
the ocean well kind of dried up pretty

39
00:01:30,000 --> 00:01:32,880
quickly uh because i mean people just

40
00:01:32,880 --> 00:01:35,280
weren't hiring remote ocean work at

41
00:01:35,280 --> 00:01:37,360
least in the u.s

42
00:01:37,360 --> 00:01:38,079
so

43
00:01:38,079 --> 00:01:40,000
that forced me to kind of pivot into

44
00:01:40,000 --> 00:01:42,479
something else so how do i go about this

45
00:01:42,479 --> 00:01:44,240
well i immediately looked at threat

46
00:01:44,240 --> 00:01:47,360
intelligence and other forms of dfir

47
00:01:47,360 --> 00:01:49,520
with that in some of the interview

48
00:01:49,520 --> 00:01:52,560
processes that i did i had to do

49
00:01:52,560 --> 00:01:55,119
a technical assessment and a report

50
00:01:55,119 --> 00:01:56,799
there was a common theme that i saw

51
00:01:56,799 --> 00:01:58,079
there

52
00:01:58,079 --> 00:01:59,759
the common theme was

53
00:01:59,759 --> 00:02:01,840
they're giving me a bunch of passive dns

54
00:02:01,840 --> 00:02:03,040
data which

55
00:02:03,040 --> 00:02:04,560
if you do ocean you know that that's a

56
00:02:04,560 --> 00:02:07,200
treasure trove and lots of fun is to be

57
00:02:07,200 --> 00:02:09,520
had there but then they also would hand

58
00:02:09,520 --> 00:02:11,760
me a csv of netflow data and say make

59
00:02:11,760 --> 00:02:13,840
sense of this

60
00:02:13,840 --> 00:02:15,040
well

61
00:02:15,040 --> 00:02:17,360
how do i make sense of this

62
00:02:17,360 --> 00:02:19,760
this is kind of the culmination of

63
00:02:19,760 --> 00:02:22,879
working through those steps and that

64
00:02:22,879 --> 00:02:24,080
research

65
00:02:24,080 --> 00:02:25,520
to be able to

66
00:02:25,520 --> 00:02:27,920
progress in the interview process that's

67
00:02:27,920 --> 00:02:29,440
in full disclosure that's what this is

68
00:02:29,440 --> 00:02:30,480
coming from

69
00:02:30,480 --> 00:02:32,800
but with this as well you know when we

70
00:02:32,800 --> 00:02:34,720
think about network forensics we

71
00:02:34,720 --> 00:02:37,360
immediately think pcaps because

72
00:02:37,360 --> 00:02:38,959
you know what's how's the phrase go

73
00:02:38,959 --> 00:02:42,080
pcaps or it

74
00:02:42,080 --> 00:02:43,680
didn't happen

75
00:02:43,680 --> 00:02:45,120
right

76
00:02:45,120 --> 00:02:48,840
that's true we may also think about logs

77
00:02:48,840 --> 00:02:50,720
but

78
00:02:50,720 --> 00:02:53,680
each of those have their own merits but

79
00:02:53,680 --> 00:02:55,280
none of them

80
00:02:55,280 --> 00:02:56,319
provide

81
00:02:56,319 --> 00:02:57,200
a

82
00:02:57,200 --> 00:02:58,239
singular

83
00:02:58,239 --> 00:03:00,800
solution across the board

84
00:03:00,800 --> 00:03:03,280
so you know i'm not going to tell you

85
00:03:03,280 --> 00:03:05,599
that logs are garbage

86
00:03:05,599 --> 00:03:08,159
what i will tell you is they can be

87
00:03:08,159 --> 00:03:09,440
they can be corrupted they can be

88
00:03:09,440 --> 00:03:11,440
overwritten they can be time stomped

89
00:03:11,440 --> 00:03:13,120
they can be misconfigured if even

90
00:03:13,120 --> 00:03:14,640
configured

91
00:03:14,640 --> 00:03:17,200
and so on with pcaps

92
00:03:17,200 --> 00:03:18,720
i really don't have a debate against

93
00:03:18,720 --> 00:03:19,920
pcapps

94
00:03:19,920 --> 00:03:22,000
aside from sometimes those file sizes

95
00:03:22,000 --> 00:03:24,560
can get really big really quick

96
00:03:24,560 --> 00:03:27,120
but you know with that

97
00:03:27,120 --> 00:03:29,440
how many devices

98
00:03:29,440 --> 00:03:34,959
can natively generate netflow or ipfix

99
00:03:34,959 --> 00:03:36,799
but we never really use it

100
00:03:36,799 --> 00:03:38,879
right it you see it sometimes in

101
00:03:38,879 --> 00:03:40,720
marketing materials but that's about it

102
00:03:40,720 --> 00:03:43,519
you like show of hands who in here

103
00:03:43,519 --> 00:03:46,000
actually routinely makes use of netflow

104
00:03:46,000 --> 00:03:49,280
data as part of your blue team

105
00:03:49,280 --> 00:03:52,879
or blue team adjacent position

106
00:03:54,239 --> 00:03:55,760
okay we've got a few

107
00:03:55,760 --> 00:03:58,239
waves of the hand so they kind of do

108
00:03:58,239 --> 00:03:59,760
so not many

109
00:03:59,760 --> 00:04:00,560
so

110
00:04:00,560 --> 00:04:01,519
hopefully

111
00:04:01,519 --> 00:04:03,439
this can change some

112
00:04:03,439 --> 00:04:06,080
thought processes with that so the

113
00:04:06,080 --> 00:04:07,680
agenda for this i'm going to start out

114
00:04:07,680 --> 00:04:11,040
with a very rudimentary basics of

115
00:04:11,040 --> 00:04:12,879
network forensics then we're going to

116
00:04:12,879 --> 00:04:15,760
talk about what is netflow we'll compare

117
00:04:15,760 --> 00:04:18,079
pcapps to netflow

118
00:04:18,079 --> 00:04:19,680
we're going to

119
00:04:19,680 --> 00:04:22,079
i i struggle with whether the correct

120
00:04:22,079 --> 00:04:24,160
word would be extract

121
00:04:24,160 --> 00:04:26,320
i i'm starting to think the better word

122
00:04:26,320 --> 00:04:30,400
might be infer netflow from pcaps

123
00:04:30,400 --> 00:04:32,080
then we'll go into analysis and then

124
00:04:32,080 --> 00:04:33,759
i'll talk about logical next steps and

125
00:04:33,759 --> 00:04:35,759
that's where the ocean perspective comes

126
00:04:35,759 --> 00:04:37,440
into play

127
00:04:37,440 --> 00:04:39,600
so starting out with network forensics

128
00:04:39,600 --> 00:04:41,040
when we talk about network forensics

129
00:04:41,040 --> 00:04:44,080
again that's logs pcaps

130
00:04:44,080 --> 00:04:45,600
and netflow

131
00:04:45,600 --> 00:04:46,560
so

132
00:04:46,560 --> 00:04:48,160
definitions here i'm not going to read

133
00:04:48,160 --> 00:04:50,960
the definitions but basically

134
00:04:50,960 --> 00:04:53,120
in that regard logs

135
00:04:53,120 --> 00:04:54,320
are

136
00:04:54,320 --> 00:04:56,479
a data source

137
00:04:56,479 --> 00:04:59,759
they provide us a data point looking at

138
00:04:59,759 --> 00:05:01,759
the evolution between data information

139
00:05:01,759 --> 00:05:05,440
and intelligence data is an irrefutable

140
00:05:05,440 --> 00:05:07,440
fact or statistic

141
00:05:07,440 --> 00:05:09,600
it is a chronicle of an event having

142
00:05:09,600 --> 00:05:11,120
occurred

143
00:05:11,120 --> 00:05:13,440
can we all agree that that that's what a

144
00:05:13,440 --> 00:05:15,919
log is

145
00:05:16,000 --> 00:05:19,440
i might disagree on the word irrefutable

146
00:05:19,440 --> 00:05:22,800
unless you want to use blockchain

147
00:05:23,440 --> 00:05:25,840
anybody that's got their buzzword bingos

148
00:05:25,840 --> 00:05:27,120
i hope you're not playing a drinking

149
00:05:27,120 --> 00:05:28,960
game

150
00:05:28,960 --> 00:05:29,919
anyway

151
00:05:29,919 --> 00:05:32,080
that being said

152
00:05:32,080 --> 00:05:34,560
for the most part logs are irrefutable

153
00:05:34,560 --> 00:05:36,720
so it is

154
00:05:36,720 --> 00:05:38,960
it is a memorialization of an event that

155
00:05:38,960 --> 00:05:41,680
occurred at a particular time and there

156
00:05:41,680 --> 00:05:43,919
are things that could happen that could

157
00:05:43,919 --> 00:05:46,000
affect that packet capture that's the

158
00:05:46,000 --> 00:05:48,560
collection of all the network data of a

159
00:05:48,560 --> 00:05:51,360
particular time period or transaction or

160
00:05:51,360 --> 00:05:53,440
whatever to that effect

161
00:05:53,440 --> 00:05:56,000
and then netflow that's metadata in the

162
00:05:56,000 --> 00:05:56,960
us

163
00:05:56,960 --> 00:05:58,800
when people especially outside this

164
00:05:58,800 --> 00:06:00,479
industry hear the word metadata they

165
00:06:00,479 --> 00:06:04,479
immediately think nsa and edward snowden

166
00:06:05,759 --> 00:06:07,680
metadata is data about the data it's

167
00:06:07,680 --> 00:06:10,960
data that describes the data

168
00:06:10,960 --> 00:06:13,600
right and basically it's going to help

169
00:06:13,600 --> 00:06:15,840
us to understand what the data is

170
00:06:15,840 --> 00:06:17,280
already telling us

171
00:06:17,280 --> 00:06:18,880
when we talk about images we've got

172
00:06:18,880 --> 00:06:20,400
metadata that tells us

173
00:06:20,400 --> 00:06:23,680
gps location altitude that kind of stuff

174
00:06:23,680 --> 00:06:26,319
if we're talking about like exif right

175
00:06:26,319 --> 00:06:27,919
so this is really no different except

176
00:06:27,919 --> 00:06:29,360
you're not going to get a latin long out

177
00:06:29,360 --> 00:06:31,520
of this you're going to need some api

178
00:06:31,520 --> 00:06:34,240
connectivity for that but you know with

179
00:06:34,240 --> 00:06:36,240
netflow it gives us a really good

180
00:06:36,240 --> 00:06:38,080
vantage point to

181
00:06:38,080 --> 00:06:40,719
examine

182
00:06:41,199 --> 00:06:43,520
east-west transactions which would be

183
00:06:43,520 --> 00:06:45,039
lateral movement

184
00:06:45,039 --> 00:06:47,280
within a network or north and south

185
00:06:47,280 --> 00:06:49,599
which would be your ingress in egress

186
00:06:49,599 --> 00:06:50,800
so that would be

187
00:06:50,800 --> 00:06:55,280
something coming in or data exfiltration

188
00:06:55,919 --> 00:06:58,400
so pros and cons with this

189
00:06:58,400 --> 00:07:00,800
logs are great

190
00:07:00,800 --> 00:07:02,400
until they aren't

191
00:07:02,400 --> 00:07:04,000
and that speaks to

192
00:07:04,000 --> 00:07:06,160
not configured misconfigured

193
00:07:06,160 --> 00:07:08,319
uh could be deletion

194
00:07:08,319 --> 00:07:10,160
or corruption

195
00:07:10,160 --> 00:07:12,639
it could involve time stomping

196
00:07:12,639 --> 00:07:13,759
it could

197
00:07:13,759 --> 00:07:16,160
they're gonna vary in file size right

198
00:07:16,160 --> 00:07:18,000
because something i tell students in the

199
00:07:18,000 --> 00:07:20,000
ocean world is if you collect it you're

200
00:07:20,000 --> 00:07:22,479
obligated to secure it

201
00:07:22,479 --> 00:07:24,880
and while you may think you've got a

202
00:07:24,880 --> 00:07:26,720
massive external hard drive i mean i've

203
00:07:26,720 --> 00:07:28,240
got a four terabyte hard drive right

204
00:07:28,240 --> 00:07:29,280
here

205
00:07:29,280 --> 00:07:32,080
but with a few pcaps i can fill that up

206
00:07:32,080 --> 00:07:33,280
right

207
00:07:33,280 --> 00:07:34,639
same thing with logs it would take a lot

208
00:07:34,639 --> 00:07:36,800
longer with logs but

209
00:07:36,800 --> 00:07:39,919
storage is at a premium and within this

210
00:07:39,919 --> 00:07:42,400
industry we tend to hoard things all the

211
00:07:42,400 --> 00:07:43,520
time

212
00:07:43,520 --> 00:07:45,120
don't even get me started about ocean

213
00:07:45,120 --> 00:07:46,560
hoarding the people who want to collect

214
00:07:46,560 --> 00:07:48,000
everything about everyone all the time

215
00:07:48,000 --> 00:07:50,240
and keep it forever

216
00:07:50,240 --> 00:07:52,240
they're really good if they're really

217
00:07:52,240 --> 00:07:54,080
good to know if you're in the middle of

218
00:07:54,080 --> 00:07:55,759
an investigation in a pinch and you need

219
00:07:55,759 --> 00:07:57,360
some additional data

220
00:07:57,360 --> 00:07:58,400
but

221
00:07:58,400 --> 00:08:00,479
the liability that comes with that and i

222
00:08:00,479 --> 00:08:01,840
mean

223
00:08:01,840 --> 00:08:02,560
for

224
00:08:02,560 --> 00:08:06,000
for people in more executive positions

225
00:08:06,000 --> 00:08:08,400
that i mean even in the us the four

226
00:08:08,400 --> 00:08:11,440
letters of gdpr still terrify us

227
00:08:11,440 --> 00:08:13,280
because i mean it can hit us where it

228
00:08:13,280 --> 00:08:14,560
hurts right in the right in the

229
00:08:14,560 --> 00:08:16,080
checkbook

230
00:08:16,080 --> 00:08:17,599
so

231
00:08:17,599 --> 00:08:19,199
with that

232
00:08:19,199 --> 00:08:21,280
the the file size the variance and then

233
00:08:21,280 --> 00:08:22,800
i mean they're all they can be in

234
00:08:22,800 --> 00:08:24,800
different formats if only there were a

235
00:08:24,800 --> 00:08:28,000
unified format for logs to be stored in

236
00:08:28,000 --> 00:08:30,000
with like a set of fields that

237
00:08:30,000 --> 00:08:32,240
everything could use and we would never

238
00:08:32,240 --> 00:08:34,080
have to write another regular expression

239
00:08:34,080 --> 00:08:36,399
again

240
00:08:36,559 --> 00:08:37,519
boy

241
00:08:37,519 --> 00:08:40,799
you talk about utopian dreams

242
00:08:40,799 --> 00:08:41,839
anyway

243
00:08:41,839 --> 00:08:45,200
p caps they are excellent and they are

244
00:08:45,200 --> 00:08:47,519
also considered universal truths because

245
00:08:47,519 --> 00:08:50,000
p caps are it didn't happen

246
00:08:50,000 --> 00:08:52,959
they do show the complete picture

247
00:08:52,959 --> 00:08:55,519
with exceptions

248
00:08:55,519 --> 00:08:58,000
encrypted protocols

249
00:08:58,000 --> 00:08:59,839
can be that exception

250
00:08:59,839 --> 00:09:01,760
if you don't have the means to decrypt

251
00:09:01,760 --> 00:09:03,680
that stream

252
00:09:03,680 --> 00:09:05,680
you can see this host is talking over

253
00:09:05,680 --> 00:09:09,200
https but if you cannot

254
00:09:09,200 --> 00:09:12,000
decrypt that stream

255
00:09:12,000 --> 00:09:14,320
you are basically in a foreign country

256
00:09:14,320 --> 00:09:17,760
with no idea of the language

257
00:09:17,760 --> 00:09:19,680
you are sitting there listening to

258
00:09:19,680 --> 00:09:24,000
adults talk on the peanuts

259
00:09:24,800 --> 00:09:26,399
that's what you're hearing

260
00:09:26,399 --> 00:09:28,000
nothing can be

261
00:09:28,000 --> 00:09:30,399
assembled from that

262
00:09:30,399 --> 00:09:32,240
also with pcaps you have the larger file

263
00:09:32,240 --> 00:09:34,000
size

264
00:09:34,000 --> 00:09:34,839
if

265
00:09:34,839 --> 00:09:38,000
someone moves a

266
00:09:38,000 --> 00:09:40,080
three gigabyte file

267
00:09:40,080 --> 00:09:42,240
guess what your pcap is at least going

268
00:09:42,240 --> 00:09:44,320
to be that size

269
00:09:44,320 --> 00:09:46,320
you might get some compression but not a

270
00:09:46,320 --> 00:09:47,519
lot

271
00:09:47,519 --> 00:09:49,200
and honestly

272
00:09:49,200 --> 00:09:50,640
something i picked up on it with the

273
00:09:50,640 --> 00:09:53,760
pcapp it is difficult to

274
00:09:53,760 --> 00:09:56,000
natively and efficiently perform

275
00:09:56,000 --> 00:09:58,640
statistic analysis like you've got cool

276
00:09:58,640 --> 00:10:01,200
things like follow stream you've got all

277
00:10:01,200 --> 00:10:03,279
the filters within wireshark like by no

278
00:10:03,279 --> 00:10:05,440
means am i saying don't use pcaps i'm

279
00:10:05,440 --> 00:10:07,519
not saying don't use wireshark they are

280
00:10:07,519 --> 00:10:08,880
both great

281
00:10:08,880 --> 00:10:11,440
but you can amplify it

282
00:10:11,440 --> 00:10:12,240
right

283
00:10:12,240 --> 00:10:15,200
so with netflow netflow also in some

284
00:10:15,200 --> 00:10:16,240
cases

285
00:10:16,240 --> 00:10:18,720
adjacent to that would be ipfix

286
00:10:18,720 --> 00:10:20,720
it's already native to many routing

287
00:10:20,720 --> 00:10:22,880
devices it's already there

288
00:10:22,880 --> 00:10:25,680
uh it's not used in favor of logs or

289
00:10:25,680 --> 00:10:28,240
pcaps you know decision makers will say

290
00:10:28,240 --> 00:10:29,920
we don't need netflow because we're

291
00:10:29,920 --> 00:10:31,360
already logging this and we're storing

292
00:10:31,360 --> 00:10:34,880
pcaps if it meets this criteria

293
00:10:34,880 --> 00:10:36,800
in comparison it's a smaller file size

294
00:10:36,800 --> 00:10:38,399
to pcaps

295
00:10:38,399 --> 00:10:40,000
in some cases it may even be smaller

296
00:10:40,000 --> 00:10:42,240
than a log

297
00:10:42,240 --> 00:10:45,120
you do have less visibility

298
00:10:45,120 --> 00:10:47,120
i'll admit that 100

299
00:10:47,120 --> 00:10:49,360
but it is easy

300
00:10:49,360 --> 00:10:51,200
to analyze and perform that statistic

301
00:10:51,200 --> 00:10:53,040
analysis that's where it's coming into

302
00:10:53,040 --> 00:10:54,000
play

303
00:10:54,000 --> 00:10:56,240
so we'll talk a bit about netflow what

304
00:10:56,240 --> 00:10:57,360
is it

305
00:10:57,360 --> 00:10:59,440
it was made for troubleshooting

306
00:10:59,440 --> 00:11:02,720
originally designed by cisco

307
00:11:02,720 --> 00:11:05,519
and with that it requires an exporter a

308
00:11:05,519 --> 00:11:07,839
collector and the means of storage

309
00:11:07,839 --> 00:11:08,800
so

310
00:11:08,800 --> 00:11:11,120
big surprise there there are a variety

311
00:11:11,120 --> 00:11:13,360
of versions of netflow as you can see

312
00:11:13,360 --> 00:11:16,000
one five seven nine

313
00:11:16,000 --> 00:11:17,519
five is the most common nine is the

314
00:11:17,519 --> 00:11:20,800
second most common technically

315
00:11:20,800 --> 00:11:24,000
technically ipfix is called i is

316
00:11:24,000 --> 00:11:26,320
is called netflow version 10

317
00:11:26,320 --> 00:11:28,480
but it really has nothing to do with

318
00:11:28,480 --> 00:11:30,480
netflow

319
00:11:30,480 --> 00:11:31,279
so

320
00:11:31,279 --> 00:11:34,000
some typical fields of netflow

321
00:11:34,000 --> 00:11:35,920
if you're familiar with pcapps this

322
00:11:35,920 --> 00:11:38,000
really shouldn't look that foreign to

323
00:11:38,000 --> 00:11:41,279
you right so time source and destination

324
00:11:41,279 --> 00:11:43,600
port and ip

325
00:11:43,600 --> 00:11:46,160
protocol

326
00:11:46,399 --> 00:11:49,120
type of service and bytes you may also

327
00:11:49,120 --> 00:11:49,920
see

328
00:11:49,920 --> 00:11:51,120
octets

329
00:11:51,120 --> 00:11:53,200
you may also see packets

330
00:11:53,200 --> 00:11:55,200
and that will be sent and received

331
00:11:55,200 --> 00:11:58,000
so the same fields you see in

332
00:11:58,000 --> 00:12:00,320
a pcap really

333
00:12:00,320 --> 00:12:01,760
so

334
00:12:01,760 --> 00:12:03,360
with it

335
00:12:03,360 --> 00:12:04,959
this is basically

336
00:12:04,959 --> 00:12:06,480
the same thing that i said before but

337
00:12:06,480 --> 00:12:08,560
it's taking it a step further

338
00:12:08,560 --> 00:12:11,120
in the united states we have a brand of

339
00:12:11,120 --> 00:12:14,800
facial tissue called kleenex

340
00:12:14,800 --> 00:12:16,800
and

341
00:12:16,800 --> 00:12:19,200
you don't like if you need one typically

342
00:12:19,200 --> 00:12:20,639
you don't say

343
00:12:20,639 --> 00:12:22,320
could i have a facial tissue you say hey

344
00:12:22,320 --> 00:12:23,920
could you pass me the kleenexes it

345
00:12:23,920 --> 00:12:26,160
doesn't matter what brand

346
00:12:26,160 --> 00:12:26,959
right

347
00:12:26,959 --> 00:12:30,160
it's like soda

348
00:12:30,160 --> 00:12:32,240
give me a coca-cola

349
00:12:32,240 --> 00:12:33,760
most of the time even if it's pepsi

350
00:12:33,760 --> 00:12:35,519
they're gonna hand you a pepsi and you

351
00:12:35,519 --> 00:12:37,519
know they know what you're asking for

352
00:12:37,519 --> 00:12:40,079
right so it's kind of like a brand name

353
00:12:40,079 --> 00:12:42,320
associated with it there are similar

354
00:12:42,320 --> 00:12:44,480
products that just have different names

355
00:12:44,480 --> 00:12:47,200
but they accomplish the same thing

356
00:12:47,200 --> 00:12:50,720
and ipfix the dev the acronym is ipflow

357
00:12:50,720 --> 00:12:53,200
information export and it's got its own

358
00:12:53,200 --> 00:12:55,920
rfc if anyone in here has insomnia and

359
00:12:55,920 --> 00:12:57,360
the need to

360
00:12:57,360 --> 00:12:59,440
read rfcs

361
00:12:59,440 --> 00:13:01,040
if if that doesn't put you to sleep

362
00:13:01,040 --> 00:13:03,440
might i recommend the rfcs associated

363
00:13:03,440 --> 00:13:07,040
with spf dkim and dmarc

364
00:13:07,040 --> 00:13:10,719
they have saved me many a nights

365
00:13:10,959 --> 00:13:13,680
bimmy's another good one

366
00:13:13,680 --> 00:13:18,000
so comparing pcaps to netflow

367
00:13:18,000 --> 00:13:21,360
netflow abbreviates the story netflow is

368
00:13:21,360 --> 00:13:23,200
the tldr

369
00:13:23,200 --> 00:13:25,440
it is think of it like

370
00:13:25,440 --> 00:13:27,680
in the terms of report writing

371
00:13:27,680 --> 00:13:31,200
netflow is kind of the executive summary

372
00:13:31,200 --> 00:13:32,959
you're in a very small building with an

373
00:13:32,959 --> 00:13:34,240
executive and they're trapped in the

374
00:13:34,240 --> 00:13:35,680
elevator with you what can you tell them

375
00:13:35,680 --> 00:13:38,160
before the doors open the next time

376
00:13:38,160 --> 00:13:41,600
that's what netflow can accomplish

377
00:13:42,320 --> 00:13:46,800
pcaps are akin to jrr token books

378
00:13:46,800 --> 00:13:48,480
they're going to spend 30 pages telling

379
00:13:48,480 --> 00:13:52,000
you what the trees smell like

380
00:13:52,000 --> 00:13:54,800
followed by about another 90 pages of

381
00:13:54,800 --> 00:13:56,480
short people walking around in middle

382
00:13:56,480 --> 00:13:58,000
earth

383
00:13:58,000 --> 00:14:00,079
i'm not a big token fan

384
00:14:00,079 --> 00:14:01,519
sorry

385
00:14:01,519 --> 00:14:03,040
but with netflow you have the smaller

386
00:14:03,040 --> 00:14:05,120
file sizes so

387
00:14:05,120 --> 00:14:08,079
if we were making movies about netflow

388
00:14:08,079 --> 00:14:11,360
we are not going to have

389
00:14:11,360 --> 00:14:13,600
everything broken down into three books

390
00:14:13,600 --> 00:14:15,440
we're not going to have

391
00:14:15,440 --> 00:14:18,079
a three-hour movie per book and then the

392
00:14:18,079 --> 00:14:19,920
final book split into two different

393
00:14:19,920 --> 00:14:21,760
three-hour movies

394
00:14:21,760 --> 00:14:23,600
we can probably watch it on youtube in

395
00:14:23,600 --> 00:14:25,839
25 minutes or less

396
00:14:25,839 --> 00:14:28,000
right keeping with my

397
00:14:28,000 --> 00:14:30,480
quasi hatred of lord of the rings

398
00:14:30,480 --> 00:14:32,560
so with that the smaller file sizes

399
00:14:32,560 --> 00:14:34,240
means it's more manageable it's going to

400
00:14:34,240 --> 00:14:36,639
take up less space you can more quickly

401
00:14:36,639 --> 00:14:39,519
react to it and make a decision

402
00:14:39,519 --> 00:14:42,000
uh you can very easily import it into

403
00:14:42,000 --> 00:14:46,720
your sim uh or i mean even a csv and if

404
00:14:46,720 --> 00:14:49,199
it goes into a csv format there's a lot

405
00:14:49,199 --> 00:14:51,519
of fun things you can do with that

406
00:14:51,519 --> 00:14:52,800
anyone here

407
00:14:52,800 --> 00:14:54,079
kind of uh

408
00:14:54,079 --> 00:14:56,160
interested in data science at all

409
00:14:56,160 --> 00:14:57,680
playing with like jupiter notebook type

410
00:14:57,680 --> 00:14:59,839
stuff

411
00:15:00,079 --> 00:15:02,560
so when i hear csv

412
00:15:02,560 --> 00:15:04,720
i think pandas

413
00:15:04,720 --> 00:15:07,519
because what can i do with pandas

414
00:15:07,519 --> 00:15:08,320
and

415
00:15:08,320 --> 00:15:10,079
but it doesn't include the packet

416
00:15:10,079 --> 00:15:12,880
contents whereas the pcap it's going to

417
00:15:12,880 --> 00:15:15,199
have everything you can do file carving

418
00:15:15,199 --> 00:15:18,079
from it if if i transfer a file to you

419
00:15:18,079 --> 00:15:22,480
via ftp or http you can carve that out

420
00:15:22,480 --> 00:15:24,480
if you are able to decrypt it doesn't

421
00:15:24,480 --> 00:15:26,800
matter if it's https you can do the same

422
00:15:26,800 --> 00:15:27,839
thing

423
00:15:27,839 --> 00:15:29,519
right

424
00:15:29,519 --> 00:15:32,240
which is useful the the stream filtering

425
00:15:32,240 --> 00:15:34,639
is very useful as well

426
00:15:34,639 --> 00:15:36,480
but when you've got

427
00:15:36,480 --> 00:15:38,880
100 hosts on the network and they're all

428
00:15:38,880 --> 00:15:40,639
very chatty

429
00:15:40,639 --> 00:15:42,800
and you've got three days worth of

430
00:15:42,800 --> 00:15:45,600
capture in a single file

431
00:15:45,600 --> 00:15:48,639
how do you know where to start

432
00:15:49,360 --> 00:15:51,680
you might have some indication but

433
00:15:51,680 --> 00:15:52,880
what if you're just doing this as a

434
00:15:52,880 --> 00:15:54,880
blind hunt

435
00:15:54,880 --> 00:15:56,720
you have no indication of

436
00:15:56,720 --> 00:15:58,079
normality

437
00:15:58,079 --> 00:15:59,759
right especially if you're a consultant

438
00:15:59,759 --> 00:16:00,880
if you're a consultant and you just

439
00:16:00,880 --> 00:16:02,399
walked in the door

440
00:16:02,399 --> 00:16:04,399
the only thing you have to base what is

441
00:16:04,399 --> 00:16:06,240
considered normal on

442
00:16:06,240 --> 00:16:08,000
that's based on the truthfulness of your

443
00:16:08,000 --> 00:16:09,519
client

444
00:16:09,519 --> 00:16:11,440
and i like to think that clients are

445
00:16:11,440 --> 00:16:12,800
usually truthful

446
00:16:12,800 --> 00:16:14,399
but if it's going to make them look bad

447
00:16:14,399 --> 00:16:16,000
i've learned that oftentimes that's not

448
00:16:16,000 --> 00:16:18,720
always the case

449
00:16:18,959 --> 00:16:20,240
just saying

450
00:16:20,240 --> 00:16:21,839
and then you've got the larger file size

451
00:16:21,839 --> 00:16:22,880
thing

452
00:16:22,880 --> 00:16:25,600
so let's talk about how we can

453
00:16:25,600 --> 00:16:28,399
extract or infer

454
00:16:28,399 --> 00:16:30,800
netflow from a pcap in terms of tools

455
00:16:30,800 --> 00:16:32,880
and scripts does anyone have any ideas

456
00:16:32,880 --> 00:16:34,639
of how this can be accomplished

457
00:16:34,639 --> 00:16:37,839
just off the bat

458
00:16:39,040 --> 00:16:40,959
no

459
00:16:40,959 --> 00:16:42,079
so

460
00:16:42,079 --> 00:16:43,519
we'll get to it

461
00:16:43,519 --> 00:16:46,160
what we need we need a p cap right

462
00:16:46,160 --> 00:16:47,440
because again

463
00:16:47,440 --> 00:16:50,560
it didn't happen if there's no p cap

464
00:16:50,560 --> 00:16:51,839
i would like to know about all the p

465
00:16:51,839 --> 00:16:52,800
caps

466
00:16:52,800 --> 00:16:54,320
associated with trees falling in the

467
00:16:54,320 --> 00:16:56,320
forest

468
00:16:56,320 --> 00:16:58,079
but anyway

469
00:16:58,079 --> 00:17:01,519
we also need a linux host with silk

470
00:17:01,519 --> 00:17:04,400
that's what we're going to use

471
00:17:04,400 --> 00:17:07,039
optionally you might need excel

472
00:17:07,039 --> 00:17:09,359
openoffice libreoffice something to that

473
00:17:09,359 --> 00:17:11,280
effect something you can read csvs or

474
00:17:11,280 --> 00:17:13,439
spreadsheets with

475
00:17:13,439 --> 00:17:16,079
you could use a sim as well

476
00:17:16,079 --> 00:17:17,839
for the demonstration i'm going to show

477
00:17:17,839 --> 00:17:19,679
you using elk

478
00:17:19,679 --> 00:17:21,359
uh but admittedly i'm not the biggest

479
00:17:21,359 --> 00:17:24,079
fan of elk elk was just the right price

480
00:17:24,079 --> 00:17:25,760
on a 14 day free trial for me to

481
00:17:25,760 --> 00:17:28,559
accomplish this

482
00:17:28,640 --> 00:17:29,520
or

483
00:17:29,520 --> 00:17:31,679
you can go my personal favorite route

484
00:17:31,679 --> 00:17:35,679
and use jupiter notebook with pandas

485
00:17:35,679 --> 00:17:36,480
so

486
00:17:36,480 --> 00:17:38,880
to start i'm gonna i'm gonna talk you

487
00:17:38,880 --> 00:17:40,240
through this and then i've got a video

488
00:17:40,240 --> 00:17:41,360
to show you

489
00:17:41,360 --> 00:17:43,520
that'll make a little bit more sense of

490
00:17:43,520 --> 00:17:45,200
it but basically you go to your

491
00:17:45,200 --> 00:17:47,679
directory where you have the pcap

492
00:17:47,679 --> 00:17:49,200
and you execute

493
00:17:49,200 --> 00:17:52,080
rwp to flow the path

494
00:17:52,080 --> 00:17:54,160
and then flow out you tell it where you

495
00:17:54,160 --> 00:17:55,280
want it to go

496
00:17:55,280 --> 00:17:56,559
the full path

497
00:17:56,559 --> 00:17:58,000
and then

498
00:17:58,000 --> 00:18:01,280
there's your path csv filename.csv

499
00:18:01,280 --> 00:18:03,360
there you go

500
00:18:03,360 --> 00:18:04,720
from there

501
00:18:04,720 --> 00:18:07,039
um i'm sorry it's the flow out and then

502
00:18:07,039 --> 00:18:10,000
the other one's rw cut delimited with a

503
00:18:10,000 --> 00:18:12,320
comma and you feed it all the stuff with

504
00:18:12,320 --> 00:18:15,200
an rw file from there that's going to

505
00:18:15,200 --> 00:18:17,919
generate the csv so the first one is

506
00:18:17,919 --> 00:18:20,400
going to go from pcap to

507
00:18:20,400 --> 00:18:23,360
rw file type the second command will

508
00:18:23,360 --> 00:18:26,720
take you from rw to csv

509
00:18:26,720 --> 00:18:29,120
then from the csv you put it wherever

510
00:18:29,120 --> 00:18:32,559
you need to go whether it be excel

511
00:18:32,559 --> 00:18:33,679
splunk

512
00:18:33,679 --> 00:18:34,880
elk

513
00:18:34,880 --> 00:18:36,320
qradar

514
00:18:36,320 --> 00:18:38,960
i think alienvault will even do it

515
00:18:38,960 --> 00:18:40,880
or jupiter

516
00:18:40,880 --> 00:18:43,840
whatever you choose

517
00:18:45,200 --> 00:18:48,320
so here's a populated example so with

518
00:18:48,320 --> 00:18:51,039
this i'm in my source directory and i'm

519
00:18:51,039 --> 00:18:53,440
going into the subdirectory pcaps

520
00:18:53,440 --> 00:18:54,880
and i'll tell you

521
00:18:54,880 --> 00:18:56,640
if you want to play with this if you go

522
00:18:56,640 --> 00:18:58,799
to active counter measures website so

523
00:18:58,799 --> 00:19:00,559
black hills information security's

524
00:19:00,559 --> 00:19:02,160
sibling company

525
00:19:02,160 --> 00:19:03,600
if you go to active counter measures

526
00:19:03,600 --> 00:19:05,360
website they have a thing called malware

527
00:19:05,360 --> 00:19:06,960
of the day

528
00:19:06,960 --> 00:19:09,120
you can download pcaps from there that's

529
00:19:09,120 --> 00:19:09,840
where

530
00:19:09,840 --> 00:19:12,880
this sample pcap actually came from

531
00:19:12,880 --> 00:19:14,880
so it doesn't matter you could collect

532
00:19:14,880 --> 00:19:17,760
it yourself but this is associated with

533
00:19:17,760 --> 00:19:20,559
a particular threat actor so

534
00:19:20,559 --> 00:19:22,799
with this we give it the flow out i put

535
00:19:22,799 --> 00:19:25,280
it in that particular directory it says

536
00:19:25,280 --> 00:19:28,799
an rw file then i run rw cut

537
00:19:28,799 --> 00:19:30,400
with the delimited

538
00:19:30,400 --> 00:19:32,880
timestamp format iso

539
00:19:32,880 --> 00:19:35,760
output path and there we have the csv

540
00:19:35,760 --> 00:19:36,960
and then

541
00:19:36,960 --> 00:19:38,720
we're good to go

542
00:19:38,720 --> 00:19:43,880
and on that let's take a look

543
00:19:54,320 --> 00:19:57,679
so this is a pretty short

544
00:19:57,679 --> 00:20:01,520
video like to the tune of 23 seconds

545
00:20:01,520 --> 00:20:03,280
so as you can see i'm in the malware of

546
00:20:03,280 --> 00:20:04,840
the day

547
00:20:04,840 --> 00:20:07,919
directory there's your initial command

548
00:20:07,919 --> 00:20:10,640
so rwp to flow

549
00:20:10,640 --> 00:20:11,919
and then we see

550
00:20:11,919 --> 00:20:14,000
right here flow out

551
00:20:14,000 --> 00:20:17,039
and the dot rw file

552
00:20:17,039 --> 00:20:19,280
it'll take a moment there we go

553
00:20:19,280 --> 00:20:20,960
and then

554
00:20:20,960 --> 00:20:23,360
i i flubbed up the command but

555
00:20:23,360 --> 00:20:25,120
it's one of those i'm not worried about

556
00:20:25,120 --> 00:20:26,640
perfection because we all make these

557
00:20:26,640 --> 00:20:28,640
mistakes

558
00:20:28,640 --> 00:20:30,640
so really even though this is a 23

559
00:20:30,640 --> 00:20:33,200
second video you can accomplish this in

560
00:20:33,200 --> 00:20:34,480
little to no time

561
00:20:34,480 --> 00:20:37,360
i would say less than five seconds

562
00:20:37,360 --> 00:20:39,919
because if we go back here

563
00:20:39,919 --> 00:20:41,520
here's where i've successfully ran the

564
00:20:41,520 --> 00:20:43,200
command

565
00:20:43,200 --> 00:20:45,120
so we have it and then at that point

566
00:20:45,120 --> 00:20:48,400
that's when i do the ls and we have evil

567
00:20:48,400 --> 00:20:52,159
os 10 underscore one dot csv

568
00:20:52,159 --> 00:20:54,640
so we we've already this is the

569
00:20:54,640 --> 00:20:57,039
inference the inference is complete at

570
00:20:57,039 --> 00:21:00,080
this rate we have inferred net flow from

571
00:21:00,080 --> 00:21:01,679
a pcap

572
00:21:01,679 --> 00:21:03,840
so that's really all we have to

573
00:21:03,840 --> 00:21:05,679
accomplish there's there's really

574
00:21:05,679 --> 00:21:08,240
nothing more to it

575
00:21:08,240 --> 00:21:09,440
so

576
00:21:09,440 --> 00:21:10,640
it's

577
00:21:10,640 --> 00:21:12,400
it's a very easy

578
00:21:12,400 --> 00:21:14,559
process to do

579
00:21:14,559 --> 00:21:17,200
i i'll say in many cases the hardest

580
00:21:17,200 --> 00:21:18,799
part is actually

581
00:21:18,799 --> 00:21:22,159
uh getting silk installed that's that

582
00:21:22,159 --> 00:21:25,280
was kind of a pain in the neck

583
00:21:25,280 --> 00:21:26,720
so now

584
00:21:26,720 --> 00:21:28,320
at this rate

585
00:21:28,320 --> 00:21:30,159
we'll talk a little bit about the

586
00:21:30,159 --> 00:21:32,159
analysis methods

587
00:21:32,159 --> 00:21:34,720
uh to this end

588
00:21:34,720 --> 00:21:35,520
and

589
00:21:35,520 --> 00:21:37,679
with this you probably already have

590
00:21:37,679 --> 00:21:40,799
excel or some equivalent right whether

591
00:21:40,799 --> 00:21:42,159
it be

592
00:21:42,159 --> 00:21:44,080
the mac equivalent open office

593
00:21:44,080 --> 00:21:46,080
libreoffice

594
00:21:46,080 --> 00:21:47,039
i mean

595
00:21:47,039 --> 00:21:49,120
you might be a glutton for punishment

596
00:21:49,120 --> 00:21:54,080
like greg over here and open csvs and vi

597
00:21:54,080 --> 00:21:56,320
i mean

598
00:21:56,960 --> 00:21:59,120
i mean mad respect for that

599
00:21:59,120 --> 00:22:01,280
but it's kind of hard to be like an

600
00:22:01,280 --> 00:22:03,520
infosec graybeard and not use vi in a

601
00:22:03,520 --> 00:22:06,240
typewriter

602
00:22:07,120 --> 00:22:09,520
i mean i grew up on vi my linux

603
00:22:09,520 --> 00:22:10,880
professor if she caught us using

604
00:22:10,880 --> 00:22:12,559
anything besides vi she'd kick you out

605
00:22:12,559 --> 00:22:15,039
of class for the day

606
00:22:15,039 --> 00:22:18,158
so i was like whoa

607
00:22:18,720 --> 00:22:20,159
with elk

608
00:22:20,159 --> 00:22:24,320
elk is elasticsearch logstash and cabana

609
00:22:24,320 --> 00:22:26,559
it's an open source sim there's a few

610
00:22:26,559 --> 00:22:28,320
ways you can go about it

611
00:22:28,320 --> 00:22:30,159
you can install it on your own host with

612
00:22:30,159 --> 00:22:33,200
docker you can install it manually

613
00:22:33,200 --> 00:22:36,880
uh 10 of 10 do not recommend

614
00:22:36,880 --> 00:22:38,640
you can also

615
00:22:38,640 --> 00:22:41,200
do the free trial which is what i did

616
00:22:41,200 --> 00:22:44,640
which would be hosted by elastic

617
00:22:44,640 --> 00:22:46,400
i will caution you with that though

618
00:22:46,400 --> 00:22:48,080
after you're out of that free trial

619
00:22:48,080 --> 00:22:49,679
period

620
00:22:49,679 --> 00:22:52,480
if you ingest a lot of data to it like i

621
00:22:52,480 --> 00:22:55,280
don't know a couple dozen honey pots on

622
00:22:55,280 --> 00:22:57,200
the public internet

623
00:22:57,200 --> 00:22:59,280
uh even though it's only supposed to

624
00:22:59,280 --> 00:23:01,520
cost you 50 a month

625
00:23:01,520 --> 00:23:03,440
by the 13th of the month it may cost you

626
00:23:03,440 --> 00:23:05,679
3.75

627
00:23:05,679 --> 00:23:08,559
be cautious of that or just don't

628
00:23:08,559 --> 00:23:10,559
connect honey pots to elk that's

629
00:23:10,559 --> 00:23:12,320
probably a better idea

630
00:23:12,320 --> 00:23:13,520
or at least one that you're getting

631
00:23:13,520 --> 00:23:15,600
charged for

632
00:23:15,600 --> 00:23:16,480
so

633
00:23:16,480 --> 00:23:18,559
that's one thing you do want to be

634
00:23:18,559 --> 00:23:21,360
a bit uh cautious of when it comes to

635
00:23:21,360 --> 00:23:24,400
elk with elk though i mean

636
00:23:24,400 --> 00:23:27,440
it can integrate with other event data

637
00:23:27,440 --> 00:23:29,280
as any other sim can because you can

638
00:23:29,280 --> 00:23:30,960
ingest log data

639
00:23:30,960 --> 00:23:33,039
you can ingest data from other sensors

640
00:23:33,039 --> 00:23:35,360
so you're getting it from

641
00:23:35,360 --> 00:23:36,799
hosts you're getting it from servers

642
00:23:36,799 --> 00:23:39,120
you're getting it from network devices

643
00:23:39,120 --> 00:23:40,880
uh and then you've got all of this on

644
00:23:40,880 --> 00:23:43,120
top of that so you can look at it from a

645
00:23:43,120 --> 00:23:45,039
multi-layered approach depending on the

646
00:23:45,039 --> 00:23:47,120
filters that you set up

647
00:23:47,120 --> 00:23:50,480
within your analysis method a lot of

648
00:23:50,480 --> 00:23:51,840
things

649
00:23:51,840 --> 00:23:54,240
a lot of other tools work with elk i

650
00:23:54,240 --> 00:23:56,559
mean you can dump elk stuff directly

651
00:23:56,559 --> 00:23:59,440
into misp into open cti you can use the

652
00:23:59,440 --> 00:24:01,360
hive cortex

653
00:24:01,360 --> 00:24:02,960
all sorts of other things if you want to

654
00:24:02,960 --> 00:24:04,480
do more of the threat intel threat

655
00:24:04,480 --> 00:24:06,240
hunting stuff

656
00:24:06,240 --> 00:24:07,840
elk's not bad

657
00:24:07,840 --> 00:24:09,840
but you know i'm not going to tell you

658
00:24:09,840 --> 00:24:11,600
that it is the absolute solution that

659
00:24:11,600 --> 00:24:14,159
you must use it if you if in your

660
00:24:14,159 --> 00:24:16,400
professional environment you use qradar

661
00:24:16,400 --> 00:24:20,320
great use splunk sweet graylog have at

662
00:24:20,320 --> 00:24:21,679
it

663
00:24:21,679 --> 00:24:24,559
you don't use anything

664
00:24:25,360 --> 00:24:27,919
no comment

665
00:24:27,919 --> 00:24:29,919
you use something built in-house

666
00:24:29,919 --> 00:24:31,600
go for it

667
00:24:31,600 --> 00:24:33,279
so

668
00:24:33,279 --> 00:24:35,919
finally we have jupiter

669
00:24:35,919 --> 00:24:37,919
jupiter notebook

670
00:24:37,919 --> 00:24:41,200
uh basically the term jupiter

671
00:24:41,200 --> 00:24:42,159
is

672
00:24:42,159 --> 00:24:45,440
a portmanteau of julia python

673
00:24:45,440 --> 00:24:46,960
and r

674
00:24:46,960 --> 00:24:47,840
so

675
00:24:47,840 --> 00:24:49,679
those are three languages commonly used

676
00:24:49,679 --> 00:24:52,480
in data science right data scientists

677
00:24:52,480 --> 00:24:54,799
love using jupiter i'm not a data

678
00:24:54,799 --> 00:24:57,360
scientist but i also love using jupiter

679
00:24:57,360 --> 00:24:59,360
because when i write stuff in python if

680
00:24:59,360 --> 00:25:00,799
i do it in jupyter i can get that

681
00:25:00,799 --> 00:25:03,039
immediate gratification and i if i'm

682
00:25:03,039 --> 00:25:04,559
trying to debug something it just

683
00:25:04,559 --> 00:25:07,520
immediately tells me it's in cell three

684
00:25:07,520 --> 00:25:09,919
line two as opposed to me having to put

685
00:25:09,919 --> 00:25:12,400
a bunch of print it works number one it

686
00:25:12,400 --> 00:25:14,240
works number two it works number three

687
00:25:14,240 --> 00:25:17,440
to find out where something breaks

688
00:25:18,000 --> 00:25:19,840
it also works because you can also set

689
00:25:19,840 --> 00:25:20,960
it up and multiple people can

690
00:25:20,960 --> 00:25:22,480
collaborate on the same notebook at the

691
00:25:22,480 --> 00:25:24,159
same time because you're doing it from

692
00:25:24,159 --> 00:25:25,679
the browser as opposed to from the

693
00:25:25,679 --> 00:25:27,039
command line

694
00:25:27,039 --> 00:25:30,000
so that works out as well you can also

695
00:25:30,000 --> 00:25:31,279
bring in

696
00:25:31,279 --> 00:25:35,039
various libraries things like matplot

697
00:25:35,039 --> 00:25:37,520
seaborn and other

698
00:25:37,520 --> 00:25:39,600
well-known libraries to be able to

699
00:25:39,600 --> 00:25:41,520
create pretty graphs

700
00:25:41,520 --> 00:25:43,679
and uh do other

701
00:25:43,679 --> 00:25:45,840
things that may enhance your reporting

702
00:25:45,840 --> 00:25:47,840
because at the end of the day when it

703
00:25:47,840 --> 00:25:49,760
comes to anything right

704
00:25:49,760 --> 00:25:51,600
whether we like it or not

705
00:25:51,600 --> 00:25:54,000
working in information security at the

706
00:25:54,000 --> 00:25:57,919
end of the day we work in intelligence

707
00:25:57,919 --> 00:25:59,760
some of us are in ocean some of us are

708
00:25:59,760 --> 00:26:02,799
inhumane some of us are in

709
00:26:02,799 --> 00:26:05,120
i don't agree with this acronym but tech

710
00:26:05,120 --> 00:26:07,360
int i guess

711
00:26:07,360 --> 00:26:09,440
it's a formally recognized one but i

712
00:26:09,440 --> 00:26:11,279
don't necessarily agree if you're on the

713
00:26:11,279 --> 00:26:13,760
red team you're probably into i would

714
00:26:13,760 --> 00:26:15,679
say some sigint

715
00:26:15,679 --> 00:26:17,760
we all do intelligence the purpose of

716
00:26:17,760 --> 00:26:20,400
intelligence is to assist in decision

717
00:26:20,400 --> 00:26:22,159
making

718
00:26:22,159 --> 00:26:23,919
how do we do that looking at the

719
00:26:23,919 --> 00:26:26,799
intelligence cycle it is through report

720
00:26:26,799 --> 00:26:29,440
dissemination everything we do we need

721
00:26:29,440 --> 00:26:33,120
to do with the purpose of at some in

722
00:26:33,120 --> 00:26:35,760
some way shape or form it being put into

723
00:26:35,760 --> 00:26:37,840
a report it could be a formal written

724
00:26:37,840 --> 00:26:39,679
report could be a verbal report might

725
00:26:39,679 --> 00:26:42,320
even just be a jira ticket

726
00:26:42,320 --> 00:26:44,480
it may be a hey greg the boss come over

727
00:26:44,480 --> 00:26:46,240
here take a look at this

728
00:26:46,240 --> 00:26:47,520
right

729
00:26:47,520 --> 00:26:51,200
oh i said the boss in here comes when

730
00:26:51,279 --> 00:26:53,919
spoken like a true manager

731
00:26:53,919 --> 00:26:56,480
but anyway

732
00:26:56,960 --> 00:26:59,440
it will be reported to someone for the

733
00:26:59,440 --> 00:27:01,679
purpose of decision making

734
00:27:01,679 --> 00:27:02,559
right

735
00:27:02,559 --> 00:27:03,919
and this is a little bit of the social

736
00:27:03,919 --> 00:27:06,799
engineer in me speaking but some people

737
00:27:06,799 --> 00:27:09,360
learn by seeing some by hearing

738
00:27:09,360 --> 00:27:10,559
some by

739
00:27:10,559 --> 00:27:13,679
reading and some by doing

740
00:27:13,679 --> 00:27:16,880
with our reports we can accomplish

741
00:27:16,880 --> 00:27:18,320
two of those

742
00:27:18,320 --> 00:27:20,080
right

743
00:27:20,080 --> 00:27:22,159
by reading and by seeing

744
00:27:22,159 --> 00:27:23,039
so

745
00:27:23,039 --> 00:27:24,960
using something like jupiter same thing

746
00:27:24,960 --> 00:27:26,480
with elk

747
00:27:26,480 --> 00:27:28,640
it can create some really pretty

748
00:27:28,640 --> 00:27:31,520
graphics that we can put into our report

749
00:27:31,520 --> 00:27:36,159
and look like graphic design uh

750
00:27:36,159 --> 00:27:40,000
maybe opening acts for rock stars

751
00:27:40,320 --> 00:27:41,840
i i don't know if i would go like rock

752
00:27:41,840 --> 00:27:43,679
star level

753
00:27:43,679 --> 00:27:46,720
i i mean i don't know how many of you

754
00:27:46,720 --> 00:27:48,399
are like into

755
00:27:48,399 --> 00:27:49,760
hard rock and metal i don't know if i'd

756
00:27:49,760 --> 00:27:51,120
put them on the same stage as like maybe

757
00:27:51,120 --> 00:27:52,320
gojira

758
00:27:52,320 --> 00:27:55,360
you know french band

759
00:27:55,360 --> 00:27:56,799
but yeah

760
00:27:56,799 --> 00:27:58,080
either way

761
00:27:58,080 --> 00:27:58,880
so

762
00:27:58,880 --> 00:28:01,440
to that end the other thing with

763
00:28:01,440 --> 00:28:04,399
jupiter is you can reuse the same

764
00:28:04,399 --> 00:28:07,840
notebook so you have the same csv in

765
00:28:07,840 --> 00:28:09,440
you say i want to look at this ip

766
00:28:09,440 --> 00:28:11,520
address you go through you can have all

767
00:28:11,520 --> 00:28:14,720
your queries pre-built

768
00:28:14,799 --> 00:28:16,799
play button play play play play play

769
00:28:16,799 --> 00:28:19,039
play here's all the data extract it put

770
00:28:19,039 --> 00:28:22,240
it in your report oh here's this other

771
00:28:22,240 --> 00:28:24,480
here's this other ip address play play

772
00:28:24,480 --> 00:28:26,399
play play play play

773
00:28:26,399 --> 00:28:28,880
oh well i want to get some statistics

774
00:28:28,880 --> 00:28:31,440
uh change it to this i mean standard

775
00:28:31,440 --> 00:28:34,720
deviation max mean minimum

776
00:28:34,720 --> 00:28:35,760
whatever

777
00:28:35,760 --> 00:28:37,760
uh number of occurrences whatever you

778
00:28:37,760 --> 00:28:40,000
want you can get all of that out of

779
00:28:40,000 --> 00:28:42,000
there and just continue to replay it

780
00:28:42,000 --> 00:28:44,799
over and over and over again

781
00:28:44,799 --> 00:28:47,279
i mean can you do the same at elk yeah

782
00:28:47,279 --> 00:28:48,799
it's a little bit more tedious but you

783
00:28:48,799 --> 00:28:50,080
can do it

784
00:28:50,080 --> 00:28:51,760
could you do the same thing in excel

785
00:28:51,760 --> 00:28:53,200
absolutely

786
00:28:53,200 --> 00:28:56,159
can you make pretty graphics in excel

787
00:28:56,159 --> 00:28:57,679
absolutely

788
00:28:57,679 --> 00:28:59,840
should you not use excel i'm not telling

789
00:28:59,840 --> 00:29:01,520
you what you should or shouldn't use i'm

790
00:29:01,520 --> 00:29:02,960
just trying to tell you these are the

791
00:29:02,960 --> 00:29:05,679
things that are on the table and

792
00:29:05,679 --> 00:29:07,440
i'm openly

793
00:29:07,440 --> 00:29:11,600
um admitting that i i personally have a

794
00:29:11,600 --> 00:29:14,480
favor for uh jupiter but i know that's

795
00:29:14,480 --> 00:29:15,919
not for everyone

796
00:29:15,919 --> 00:29:18,480
so let's take a look at how this kind of

797
00:29:18,480 --> 00:29:22,640
would uh gel together

798
00:29:23,120 --> 00:29:25,840
so i've got

799
00:29:25,840 --> 00:29:28,880
another recorded demo here

800
00:29:28,880 --> 00:29:32,000
so this is starting with

801
00:29:32,000 --> 00:29:33,120
elk

802
00:29:33,120 --> 00:29:35,039
so this is

803
00:29:35,039 --> 00:29:35,760
the

804
00:29:35,760 --> 00:29:38,480
my part of my at the time 14 day free

805
00:29:38,480 --> 00:29:41,360
trial of elk so you see i say upload a

806
00:29:41,360 --> 00:29:42,320
file

807
00:29:42,320 --> 00:29:46,639
so i'll drag and drop a file there we go

808
00:29:46,880 --> 00:29:49,039
so it's just showing it to us as we

809
00:29:49,039 --> 00:29:51,039
scroll down we see everything's going

810
00:29:51,039 --> 00:29:52,720
through we see the number

811
00:29:52,720 --> 00:29:54,080
we tell it to import we have to give it

812
00:29:54,080 --> 00:29:56,799
an index name in this case we need to

813
00:29:56,799 --> 00:30:00,080
give it like netflow hyphen something

814
00:30:00,080 --> 00:30:04,000
um anyone in here familiar with uh the

815
00:30:04,000 --> 00:30:07,279
sans vm called soft elk

816
00:30:07,279 --> 00:30:09,120
at all

817
00:30:09,120 --> 00:30:10,240
a couple

818
00:30:10,240 --> 00:30:12,159
so soft elk r

819
00:30:12,159 --> 00:30:14,320
it's a sans

820
00:30:14,320 --> 00:30:16,960
forensics vm running elk

821
00:30:16,960 --> 00:30:18,399
the only thing is

822
00:30:18,399 --> 00:30:19,360
uh

823
00:30:19,360 --> 00:30:21,360
it's not particularly a big fan of you

824
00:30:21,360 --> 00:30:24,320
just uploading a csv as netflow it wants

825
00:30:24,320 --> 00:30:26,960
you to send it to it from another host

826
00:30:26,960 --> 00:30:28,399
through the official

827
00:30:28,399 --> 00:30:29,360
way

828
00:30:29,360 --> 00:30:31,520
so that's the reason i didn't use soft

829
00:30:31,520 --> 00:30:33,840
elk but you could use that in a

830
00:30:33,840 --> 00:30:35,679
production environment if you're so

831
00:30:35,679 --> 00:30:37,840
comfortable

832
00:30:38,000 --> 00:30:39,440
so we're just waiting for the data to

833
00:30:39,440 --> 00:30:41,840
upload

834
00:30:43,760 --> 00:30:47,200
should be relatively quick

835
00:30:47,279 --> 00:30:49,679
so now it's creating the data view

836
00:30:49,679 --> 00:30:52,320
and now we can actually take a look at

837
00:30:52,320 --> 00:30:53,919
it

838
00:30:53,919 --> 00:30:57,279
so as we go through

839
00:30:59,440 --> 00:31:01,519
this is going to show us all the data so

840
00:31:01,519 --> 00:31:03,039
as we look at that

841
00:31:03,039 --> 00:31:05,840
i mean

842
00:31:06,399 --> 00:31:07,840
do you all agree this looks just like

843
00:31:07,840 --> 00:31:11,279
the headers of a pcap i mean aside from

844
00:31:11,279 --> 00:31:13,360
the actual content

845
00:31:13,360 --> 00:31:15,039
whether it be

846
00:31:15,039 --> 00:31:19,600
decoded decrypted or just displayed

847
00:31:19,600 --> 00:31:21,360
i mean it just doesn't have the payload

848
00:31:21,360 --> 00:31:24,000
right that's more or less what it is

849
00:31:24,000 --> 00:31:26,159
so this is what we have to operate off

850
00:31:26,159 --> 00:31:28,080
of

851
00:31:28,080 --> 00:31:30,399
so as we go through this though we can

852
00:31:30,399 --> 00:31:32,559
go here and start building dashboards

853
00:31:32,559 --> 00:31:35,519
and managers love dashboards

854
00:31:35,519 --> 00:31:38,320
don't you win management

855
00:31:38,320 --> 00:31:40,559
yes

856
00:31:41,840 --> 00:31:43,919
so right here we can say

857
00:31:43,919 --> 00:31:47,200
how many top values do we want to see

858
00:31:47,200 --> 00:31:49,200
and then i always cut the other out

859
00:31:49,200 --> 00:31:50,399
because it

860
00:31:50,399 --> 00:31:52,159
it changes the inflation it creates an

861
00:31:52,159 --> 00:31:56,559
artificial skew so right here

862
00:31:57,200 --> 00:31:59,519
if you were doing a thread hunt

863
00:31:59,519 --> 00:32:01,679
of these hosts which one would you be

864
00:32:01,679 --> 00:32:05,519
the most interested in taking a look at

865
00:32:08,159 --> 00:32:10,080
would you even have to ask your client

866
00:32:10,080 --> 00:32:13,879
what is considered normal

867
00:32:15,120 --> 00:32:18,799
obviously some exceptions do apply

868
00:32:18,799 --> 00:32:19,919
this

869
00:32:19,919 --> 00:32:22,240
this was the malicious host

870
00:32:22,240 --> 00:32:23,840
but

871
00:32:23,840 --> 00:32:26,000
there are situations where it could have

872
00:32:26,000 --> 00:32:27,440
been

873
00:32:27,440 --> 00:32:31,440
it's supposed to be the chattiest host

874
00:32:31,440 --> 00:32:33,600
so we've got that one here comes another

875
00:32:33,600 --> 00:32:35,279
one

876
00:32:35,279 --> 00:32:36,559
so now we're going to find out the top

877
00:32:36,559 --> 00:32:38,559
destinations that was the top sources so

878
00:32:38,559 --> 00:32:40,720
that's that's who's uh

879
00:32:40,720 --> 00:32:42,640
initiating all the conversations i guess

880
00:32:42,640 --> 00:32:44,320
that's the joe gray of everything the

881
00:32:44,320 --> 00:32:47,519
the host that never shuts up

882
00:32:47,519 --> 00:32:50,640
i mean i own it

883
00:32:50,640 --> 00:32:52,880
so now we can find out about ports i'll

884
00:32:52,880 --> 00:32:55,600
say that in here doing the ports

885
00:32:55,600 --> 00:32:57,039
that kind of gets a little tricky

886
00:32:57,039 --> 00:32:58,640
because it tries to add up all the port

887
00:32:58,640 --> 00:33:01,360
numbers together

888
00:33:01,440 --> 00:33:02,399
and

889
00:33:02,399 --> 00:33:05,200
um you know to drop a borat reference

890
00:33:05,200 --> 00:33:09,799
that's uh not very nice

891
00:33:10,240 --> 00:33:14,320
so here we can see oh this is a good one

892
00:33:14,320 --> 00:33:16,799
you know that data exfiltration of a

893
00:33:16,799 --> 00:33:18,480
large file

894
00:33:18,480 --> 00:33:20,000
or

895
00:33:20,000 --> 00:33:22,720
you know that that occurred or you know

896
00:33:22,720 --> 00:33:24,799
that someone downloaded

897
00:33:24,799 --> 00:33:26,640
a large piece of malware and it is

898
00:33:26,640 --> 00:33:28,159
moving through your network and you want

899
00:33:28,159 --> 00:33:31,360
to find out who patient zero is

900
00:33:31,360 --> 00:33:33,600
right

901
00:33:33,679 --> 00:33:35,840
what we see right here the number of

902
00:33:35,840 --> 00:33:37,519
octets

903
00:33:37,519 --> 00:33:39,760
that is the file size that's the size of

904
00:33:39,760 --> 00:33:41,279
your transactions

905
00:33:41,279 --> 00:33:43,039
right

906
00:33:43,039 --> 00:33:45,679
so with this if we know that the average

907
00:33:45,679 --> 00:33:47,600
is 114

908
00:33:47,600 --> 00:33:49,918
000

909
00:33:50,080 --> 00:33:52,559
reasonably speaking if we're dealing

910
00:33:52,559 --> 00:33:55,600
with a large file being exfiltrated or a

911
00:33:55,600 --> 00:33:58,000
relatively large malware file being

912
00:33:58,000 --> 00:34:00,000
downloaded

913
00:34:00,000 --> 00:34:03,600
you know it's probably not 114 000

914
00:34:03,600 --> 00:34:05,519
bytes

915
00:34:05,519 --> 00:34:07,039
that's a pretty safe assumption wouldn't

916
00:34:07,039 --> 00:34:09,199
you think

917
00:34:09,199 --> 00:34:12,319
so continuing

918
00:34:17,599 --> 00:34:19,918
so we've got all these like cool charts

919
00:34:19,918 --> 00:34:22,800
and stuff that we can look at you know

920
00:34:22,800 --> 00:34:25,918
management likes it

921
00:34:25,918 --> 00:34:28,399
oh now we're to to jupiter

922
00:34:28,399 --> 00:34:29,599
so

923
00:34:29,599 --> 00:34:32,000
that's pretty much elk um

924
00:34:32,000 --> 00:34:33,199
what i might recommend is if you're

925
00:34:33,199 --> 00:34:35,520
running your own elk instance you might

926
00:34:35,520 --> 00:34:37,440
want to go and take a look at soft elk

927
00:34:37,440 --> 00:34:39,280
and see what dashboards they have and

928
00:34:39,280 --> 00:34:41,119
work to recreate them

929
00:34:41,119 --> 00:34:42,239
uh the

930
00:34:42,239 --> 00:34:43,440
the

931
00:34:43,440 --> 00:34:45,679
field names in

932
00:34:45,679 --> 00:34:48,399
from silk do not match

933
00:34:48,399 --> 00:34:50,560
traditional netflow

934
00:34:50,560 --> 00:34:53,679
field names and do not match those that

935
00:34:53,679 --> 00:34:55,440
sof elk would recognize you would need

936
00:34:55,440 --> 00:34:57,359
to go into the csv and manually edit

937
00:34:57,359 --> 00:34:58,400
that

938
00:34:58,400 --> 00:35:00,960
but that's a relatively easy thing to do

939
00:35:00,960 --> 00:35:02,880
that's you do it once and then copy and

940
00:35:02,880 --> 00:35:05,680
paste it from there you're good

941
00:35:05,680 --> 00:35:08,640
but uh from that lens

942
00:35:08,640 --> 00:35:10,000
that's the one thing you would need to

943
00:35:10,000 --> 00:35:11,040
do

944
00:35:11,040 --> 00:35:12,320
but again

945
00:35:12,320 --> 00:35:14,320
splunk other platforms you can do the

946
00:35:14,320 --> 00:35:16,880
same thing it doesn't have to be elk

947
00:35:16,880 --> 00:35:18,720
it's just it was the right price at the

948
00:35:18,720 --> 00:35:20,400
right time for me

949
00:35:20,400 --> 00:35:22,720
but that's something you could do with

950
00:35:22,720 --> 00:35:24,560
jupiter

951
00:35:24,560 --> 00:35:26,160
i'll show you

952
00:35:26,160 --> 00:35:28,880
the the actual demo piece

953
00:35:28,880 --> 00:35:30,400
and then i've actually got a live

954
00:35:30,400 --> 00:35:32,560
jupiter instance running with everything

955
00:35:32,560 --> 00:35:34,240
loaded so this is basically what it

956
00:35:34,240 --> 00:35:35,520
looks like

957
00:35:35,520 --> 00:35:36,960
so like right here

958
00:35:36,960 --> 00:35:41,280
uh we can see that like right here

959
00:35:41,280 --> 00:35:44,960
the destinationip address.unique.com

960
00:35:44,960 --> 00:35:48,079
that's going to tell us the four

961
00:35:48,079 --> 00:35:48,960
most

962
00:35:48,960 --> 00:35:50,480
talkative

963
00:35:50,480 --> 00:35:54,400
hosts destination hosts

964
00:35:55,200 --> 00:35:56,880
you remember when i was comparing with

965
00:35:56,880 --> 00:35:59,119
pcapp and i said it's hard to perform

966
00:35:59,119 --> 00:36:00,800
statistic analysis and find out who your

967
00:36:00,800 --> 00:36:03,119
top talkers are

968
00:36:03,119 --> 00:36:04,960
this is a lot easier than trying to

969
00:36:04,960 --> 00:36:06,240
count on your fingers and toes in

970
00:36:06,240 --> 00:36:09,200
wireshark isn't it

971
00:36:09,760 --> 00:36:11,839
and it takes you i mean to accomplish

972
00:36:11,839 --> 00:36:13,200
this

973
00:36:13,200 --> 00:36:15,839
counting the rw commands

974
00:36:15,839 --> 00:36:17,760
i think we might be maybe

975
00:36:17,760 --> 00:36:19,440
six minutes of time

976
00:36:19,440 --> 00:36:21,359
expended for this

977
00:36:21,359 --> 00:36:22,480
so

978
00:36:22,480 --> 00:36:24,079
you're probably good to go

979
00:36:24,079 --> 00:36:26,800
so we know the top talkers right here we

980
00:36:26,800 --> 00:36:28,320
can see

981
00:36:28,320 --> 00:36:30,640
i mean from a statistic perspective

982
00:36:30,640 --> 00:36:32,800
we know that

983
00:36:32,800 --> 00:36:33,599
the

984
00:36:33,599 --> 00:36:35,440
um

985
00:36:35,440 --> 00:36:38,240
mean number of octets in this one is

986
00:36:38,240 --> 00:36:41,359
uh this incredibly large number

987
00:36:41,359 --> 00:36:42,560
right

988
00:36:42,560 --> 00:36:44,640
so that gives us an indication of what

989
00:36:44,640 --> 00:36:47,200
we should be uh looking for in terms of

990
00:36:47,200 --> 00:36:49,680
deviation from that uh

991
00:36:49,680 --> 00:36:52,560
this is a time that if you think back to

992
00:36:52,560 --> 00:36:55,119
like high school level math compare the

993
00:36:55,119 --> 00:36:57,119
median to the mean

994
00:36:57,119 --> 00:36:58,720
and then also factor in the standard

995
00:36:58,720 --> 00:37:01,599
deviation as well that's going to speak

996
00:37:01,599 --> 00:37:05,599
to how much variation exists

997
00:37:06,320 --> 00:37:08,480
from here you've got your value counts

998
00:37:08,480 --> 00:37:11,040
so this is your frequency analysis this

999
00:37:11,040 --> 00:37:13,200
tells you how many

1000
00:37:13,200 --> 00:37:16,960
transactions occurred with each host so

1001
00:37:16,960 --> 00:37:18,800
that whole level of determining what is

1002
00:37:18,800 --> 00:37:20,640
considered normal

1003
00:37:20,640 --> 00:37:23,839
this is it

1004
00:37:24,720 --> 00:37:26,400
and then going back you know just

1005
00:37:26,400 --> 00:37:28,880
playing with it this is showing

1006
00:37:28,880 --> 00:37:31,440
going back to elk

1007
00:37:31,440 --> 00:37:33,680
so there's your average there's your

1008
00:37:33,680 --> 00:37:36,240
median um

1009
00:37:36,240 --> 00:37:38,880
seeing it seeing that level of disparity

1010
00:37:38,880 --> 00:37:41,680
between an average and a median

1011
00:37:41,680 --> 00:37:44,160
what are two things that come to mind

1012
00:37:44,160 --> 00:37:46,000
in terms of why those numbers would

1013
00:37:46,000 --> 00:37:49,599
would be that variable

1014
00:37:49,680 --> 00:37:52,319
any ideas

1015
00:37:58,560 --> 00:38:01,359
here's two things come to mind for me

1016
00:38:01,359 --> 00:38:03,359
something's probably very aggressively

1017
00:38:03,359 --> 00:38:05,280
beaconing or pinging something across

1018
00:38:05,280 --> 00:38:07,839
that network creating very small file

1019
00:38:07,839 --> 00:38:11,440
sizes to get a median

1020
00:38:12,079 --> 00:38:13,760
but then you've also on the opposite end

1021
00:38:13,760 --> 00:38:15,520
of the spectrum you've got something

1022
00:38:15,520 --> 00:38:18,560
large being moved around as well that's

1023
00:38:18,560 --> 00:38:19,760
why you're going to have that level of

1024
00:38:19,760 --> 00:38:22,160
disparity

1025
00:38:22,160 --> 00:38:22,960
so

1026
00:38:22,960 --> 00:38:25,920
that's more or less

1027
00:38:25,920 --> 00:38:27,440
like the type of analysis you could

1028
00:38:27,440 --> 00:38:29,280
perform here this right here is just

1029
00:38:29,280 --> 00:38:30,720
your standard

1030
00:38:30,720 --> 00:38:33,359
this is the same jupiter notebook and

1031
00:38:33,359 --> 00:38:36,000
with this you know i've got it to where

1032
00:38:36,000 --> 00:38:38,800
we have the value counts so i've already

1033
00:38:38,800 --> 00:38:41,119
pressed play right here run on

1034
00:38:41,119 --> 00:38:42,320
everything so

1035
00:38:42,320 --> 00:38:44,560
i don't have to run it again but this

1036
00:38:44,560 --> 00:38:47,119
can tell us you know how many

1037
00:38:47,119 --> 00:38:48,800
how many of everything

1038
00:38:48,800 --> 00:38:50,960
uh exists so in this case i'm going to

1039
00:38:50,960 --> 00:38:52,480
change it

1040
00:38:52,480 --> 00:38:53,840
unique to

1041
00:38:53,840 --> 00:38:54,880
[Music]

1042
00:38:54,880 --> 00:38:57,040
four again

1043
00:38:57,040 --> 00:39:00,680
and just press play

1044
00:39:03,040 --> 00:39:05,520
so we have four oh

1045
00:39:05,520 --> 00:39:07,359
your manager was impressed they want to

1046
00:39:07,359 --> 00:39:09,760
know the top 10 now

1047
00:39:09,760 --> 00:39:10,800
cool

1048
00:39:10,800 --> 00:39:12,800
i got you boo

1049
00:39:12,800 --> 00:39:15,119
that's all it takes

1050
00:39:15,119 --> 00:39:17,599
standard deviation well you can also go

1051
00:39:17,599 --> 00:39:20,240
a little bit further than that right

1052
00:39:20,240 --> 00:39:21,680
oh

1053
00:39:21,680 --> 00:39:25,960
well yeah i know that's how you paste

1054
00:39:48,320 --> 00:39:49,839
so now we've got all of these

1055
00:39:49,839 --> 00:39:51,359
measurements that we can take a look at

1056
00:39:51,359 --> 00:39:52,480
as well

1057
00:39:52,480 --> 00:39:54,640
and it's only showing us one

1058
00:39:54,640 --> 00:39:57,359
thanks buddy but

1059
00:39:57,359 --> 00:39:59,280
the point still stands you could use any

1060
00:39:59,280 --> 00:40:00,400
of these

1061
00:40:00,400 --> 00:40:02,720
uh with it there's your value accounts

1062
00:40:02,720 --> 00:40:04,400
again

1063
00:40:04,400 --> 00:40:07,280
hey there's your ports um value counts

1064
00:40:07,280 --> 00:40:09,119
on ports

1065
00:40:09,119 --> 00:40:12,000
443 is the top one does that surprise

1066
00:40:12,000 --> 00:40:14,079
anyone

1067
00:40:14,079 --> 00:40:15,440
shouldn't

1068
00:40:15,440 --> 00:40:19,280
ooh 500 that is number two though

1069
00:40:19,280 --> 00:40:22,400
should that be surprising

1070
00:40:23,680 --> 00:40:25,760
if you would have asked me before

1071
00:40:25,760 --> 00:40:28,880
march 1st of 2020

1072
00:40:28,880 --> 00:40:30,560
i would have said

1073
00:40:30,560 --> 00:40:33,599
yes this is very surprising

1074
00:40:33,599 --> 00:40:34,800
right

1075
00:40:34,800 --> 00:40:38,079
depending on your architecture port 500

1076
00:40:38,079 --> 00:40:40,880
vpn right that's what i'm getting at

1077
00:40:40,880 --> 00:40:41,920
so

1078
00:40:41,920 --> 00:40:44,720
pre-coved the use of vpns was pretty

1079
00:40:44,720 --> 00:40:46,319
much restricted to

1080
00:40:46,319 --> 00:40:48,480
certain hosts and people that may have

1081
00:40:48,480 --> 00:40:50,839
had a telework agreement

1082
00:40:50,839 --> 00:40:54,400
postcoved it's a lot more common

1083
00:40:54,400 --> 00:40:55,920
but

1084
00:40:55,920 --> 00:40:58,160
even with that you know what vpn

1085
00:40:58,160 --> 00:41:00,560
implementation do you have are you using

1086
00:41:00,560 --> 00:41:04,480
uh are you using https vpn or a tls vpn

1087
00:41:04,480 --> 00:41:08,480
or isa kmp you know whatever so

1088
00:41:08,480 --> 00:41:10,319
the fact that it's number two

1089
00:41:10,319 --> 00:41:11,680
uh

1090
00:41:11,680 --> 00:41:13,119
that could be telling it may not it

1091
00:41:13,119 --> 00:41:15,760
depends on again what is considered

1092
00:41:15,760 --> 00:41:17,040
normal

1093
00:41:17,040 --> 00:41:18,560
so

1094
00:41:18,560 --> 00:41:21,680
with that being said uh to

1095
00:41:21,680 --> 00:41:23,599
round out the

1096
00:41:23,599 --> 00:41:25,839
uh conversation here

1097
00:41:25,839 --> 00:41:27,440
from here because you've already got

1098
00:41:27,440 --> 00:41:29,520
that jupiter notebook you can just

1099
00:41:29,520 --> 00:41:32,400
immediately drag and drop or import your

1100
00:41:32,400 --> 00:41:34,880
other tool you can import your script

1101
00:41:34,880 --> 00:41:38,240
for showed in you could import your

1102
00:41:38,240 --> 00:41:42,720
api key for census or

1103
00:41:43,440 --> 00:41:46,480
dump things out into a csv or a json

1104
00:41:46,480 --> 00:41:48,480
file and drop it in recon ng or

1105
00:41:48,480 --> 00:41:50,800
spiderfoot or multigo

1106
00:41:50,800 --> 00:41:52,480
you've got things you've got the ability

1107
00:41:52,480 --> 00:41:54,160
to create those graphics for thread

1108
00:41:54,160 --> 00:41:56,640
until reports you have actionable stuff

1109
00:41:56,640 --> 00:41:57,680
that you can pass to a threat

1110
00:41:57,680 --> 00:42:00,640
intelligence team beyond hey it's this

1111
00:42:00,640 --> 00:42:02,400
ip and this port

1112
00:42:02,400 --> 00:42:04,400
that's great but i need some context

1113
00:42:04,400 --> 00:42:07,440
could i have a chrome of context sir

1114
00:42:07,440 --> 00:42:09,520
right goes into your reports and it's

1115
00:42:09,520 --> 00:42:11,599
going to help you look like a rock star

1116
00:42:11,599 --> 00:42:14,920
messy buku

1117
00:42:18,880 --> 00:42:20,960
you

