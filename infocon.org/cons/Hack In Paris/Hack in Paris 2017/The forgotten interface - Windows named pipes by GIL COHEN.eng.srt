1
00:00:09,170 --> 00:00:15,080
good morning<font color="#E5E5E5"> Paris no it's not no</font><font color="#CCCCCC"> it's</font>

2
00:00:12,420 --> 00:00:20,720
<font color="#CCCCCC">not morning when</font><font color="#E5E5E5"> we are nothing</font>

3
00:00:15,080 --> 00:00:23,840
<font color="#CCCCCC">to say that my</font><font color="#E5E5E5"> name is Gil and I'm the</font>

4
00:00:20,720 --> 00:00:25,640
CTO<font color="#CCCCCC"> of comms</font><font color="#E5E5E5"> a global and complex is an</font>

5
00:00:23,840 --> 00:00:27,550
Israeli company<font color="#CCCCCC"> the most</font><font color="#E5E5E5"> veteran and the</font>

6
00:00:25,640 --> 00:00:31,100
<font color="#E5E5E5">most the</font><font color="#CCCCCC"> biggest company is Israel</font><font color="#E5E5E5"> of</font>

7
00:00:27,550 --> 00:00:34,370
information<font color="#E5E5E5"> security I started my career</font>

8
00:00:31,100 --> 00:00:37,280
<font color="#E5E5E5">as a military hacker and</font><font color="#CCCCCC"> ster</font><font color="#E5E5E5"> first I</font>

9
00:00:34,370 --> 00:00:39,890
was a programmer a.net developer<font color="#E5E5E5"> and</font>

10
00:00:37,280 --> 00:00:42,680
then<font color="#E5E5E5"> I became a military hacker in the</font>

11
00:00:39,890 --> 00:00:44,000
IDF I cannot<font color="#E5E5E5"> tell</font><font color="#CCCCCC"> you where because then</font>

12
00:00:42,680 --> 00:00:45,739
I have<font color="#CCCCCC"> to kill</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> your lots of</font>

13
00:00:44,000 --> 00:00:48,019
people<font color="#E5E5E5"> and I cannot cope with each and</font>

14
00:00:45,739 --> 00:00:52,489
<font color="#E5E5E5">every</font><font color="#CCCCCC"> one of you</font><font color="#E5E5E5"> but so I'll just</font>

15
00:00:48,019 --> 00:00:54,979
spare the<font color="#E5E5E5"> details so I've been a hacker</font>

16
00:00:52,489 --> 00:00:58,370
for<font color="#E5E5E5"> 12 years now I started my career as</font>

17
00:00:54,979 --> 00:01:00,860
a application and<font color="#CCCCCC"> pin</font><font color="#E5E5E5"> penetration tester</font>

18
00:00:58,370 --> 00:01:04,009
<font color="#E5E5E5">now I any hack pretty much everything or</font>

19
00:01:00,860 --> 00:01:05,780
most<font color="#E5E5E5"> of the things and I'm the lead</font>

20
00:01:04,010 --> 00:01:10,100
hacker as<font color="#CCCCCC"> the chief</font><font color="#E5E5E5"> technology officer</font>

21
00:01:05,780 --> 00:01:12,890
<font color="#CCCCCC">of complex</font><font color="#E5E5E5"> and we have we</font><font color="#CCCCCC"> are a medium</font>

22
00:01:10,100 --> 00:01:16,460
company<font color="#E5E5E5"> where</font><font color="#CCCCCC"> 150 consultants 600</font>

23
00:01:12,890 --> 00:01:24,800
<font color="#CCCCCC">clients in 22 countries</font><font color="#E5E5E5"> and we do a lot</font>

24
00:01:16,460 --> 00:01:28,429
<font color="#CCCCCC">of interesting stuff</font><font color="#E5E5E5"> and second we do a</font>

25
00:01:24,800 --> 00:01:30,200
lot<font color="#CCCCCC"> of interesting stuff is such as the</font>

26
00:01:28,430 --> 00:01:35,030
<font color="#E5E5E5">penetration test security</font><font color="#CCCCCC"> development</font>

27
00:01:30,200 --> 00:01:38,740
<font color="#E5E5E5">lifecycle</font><font color="#CCCCCC"> in compliance</font><font color="#E5E5E5"> either a PCI DSS</font>

28
00:01:35,030 --> 00:01:43,400
<font color="#E5E5E5">and</font><font color="#CCCCCC"> also some advanced services</font><font color="#E5E5E5"> such as</font>

29
00:01:38,740 --> 00:01:45,890
<font color="#E5E5E5">red teaming and ethical hacking and we</font>

30
00:01:43,400 --> 00:01:47,810
have some guys from<font color="#CCCCCC"> a concert here raise</font>

31
00:01:45,890 --> 00:01:52,250
<font color="#E5E5E5">your hand so if you want to ask them</font>

32
00:01:47,810 --> 00:01:53,860
<font color="#E5E5E5">questions later on please do</font><font color="#CCCCCC"> and among</font>

33
00:01:52,250 --> 00:01:57,110
the other<font color="#CCCCCC"> things</font><font color="#E5E5E5"> that we do we do</font>

34
00:01:53,860 --> 00:01:59,990
occasionally<font color="#E5E5E5"> we come up with something</font>

35
00:01:57,110 --> 00:02:02,300
interesting<font color="#CCCCCC"> and we move on</font><font color="#E5E5E5"> with research</font>

36
00:01:59,990 --> 00:02:03,740
and this<font color="#E5E5E5"> was the case with the next</font>

37
00:02:02,300 --> 00:02:06,440
<font color="#CCCCCC">presentation I'm going to</font><font color="#E5E5E5"> show you about</font>

38
00:02:03,740 --> 00:02:10,449
<font color="#E5E5E5">Windows named fight so this is something</font>

39
00:02:06,440 --> 00:02:12,950
<font color="#CCCCCC">that we came</font><font color="#E5E5E5"> up</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> in one of our</font>

40
00:02:10,449 --> 00:02:15,319
<font color="#E5E5E5">clients and when you furthering</font><font color="#CCCCCC"> that</font>

41
00:02:12,950 --> 00:02:18,079
investigated it we saw that nobody<font color="#E5E5E5"> is</font>

42
00:02:15,319 --> 00:02:20,450
aware<font color="#E5E5E5"> that there is such an interfacing</font>

43
00:02:18,080 --> 00:02:22,940
this is why I<font color="#E5E5E5"> called this presentation</font>

44
00:02:20,450 --> 00:02:25,640
<font color="#CCCCCC">but</font><font color="#E5E5E5"> forgotten</font><font color="#CCCCCC"> in the face and nobody</font>

45
00:02:22,940 --> 00:02:27,430
<font color="#E5E5E5">knows that it actually exists and now</font>

46
00:02:25,640 --> 00:02:31,988
I'm<font color="#E5E5E5"> going to tell you about</font>

47
00:02:27,430 --> 00:02:36,159
so let's start<font color="#E5E5E5"> with so some key term</font>

48
00:02:31,989 --> 00:02:38,480
<font color="#E5E5E5">inter-process communication this is a</font>

49
00:02:36,159 --> 00:02:41,239
process or interface that allows you

50
00:02:38,480 --> 00:02:43,280
allows the multiple processes to

51
00:02:41,239 --> 00:02:45,950
communicate<font color="#CCCCCC"> you can do it in multiple</font>

52
00:02:43,280 --> 00:02:49,610
<font color="#CCCCCC">ways you</font><font color="#E5E5E5"> can do it using sockets playing</font>

53
00:02:45,950 --> 00:02:51,619
<font color="#CCCCCC">an IPM port</font><font color="#E5E5E5"> you can do it with files</font>

54
00:02:49,610 --> 00:02:53,410
databases<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you can also do it with</font>

55
00:02:51,620 --> 00:02:57,530
<font color="#E5E5E5">interest process communication</font>

56
00:02:53,410 --> 00:03:00,489
<font color="#E5E5E5">interfaces and inter process</font>

57
00:02:57,530 --> 00:03:03,470
communication and it categorizes

58
00:03:00,489 --> 00:03:06,980
<font color="#E5E5E5">different users</font><font color="#CCCCCC"> to clients and</font><font color="#E5E5E5"> servers</font>

59
00:03:03,470 --> 00:03:10,519
but most<font color="#E5E5E5"> of the times they</font><font color="#CCCCCC"> are both so a</font>

60
00:03:06,980 --> 00:03:12,548
process can do can be both an<font color="#E5E5E5"> IPC client</font>

61
00:03:10,519 --> 00:03:15,670
and an IPC server that serves

62
00:03:12,549 --> 00:03:18,590
information to other processes<font color="#CCCCCC"> and one</font>

63
00:03:15,670 --> 00:03:21,200
<font color="#E5E5E5">IPC inter-process communication</font>

64
00:03:18,590 --> 00:03:23,660
implementation is called<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> named</font>

65
00:03:21,200 --> 00:03:28,190
pipe<font color="#E5E5E5"> who is familiar with Windows</font><font color="#CCCCCC"> Mail</font>

66
00:03:23,660 --> 00:03:30,200
<font color="#CCCCCC">pipe raise your hand not many this is</font>

67
00:03:28,190 --> 00:03:32,630
<font color="#E5E5E5">exactly what I</font><font color="#CCCCCC"> witnessed when</font><font color="#E5E5E5"> I started</font>

68
00:03:30,200 --> 00:03:36,349
this research<font color="#E5E5E5"> and even if you know</font>

69
00:03:32,630 --> 00:03:37,730
windows<font color="#CCCCCC"> made pipes</font><font color="#E5E5E5"> you won't know what</font>

70
00:03:36,349 --> 00:03:40,250
I'm going to<font color="#E5E5E5"> show you later on</font>

71
00:03:37,730 --> 00:03:43,130
<font color="#E5E5E5">so nine types is an interface</font><font color="#CCCCCC"> that</font>

72
00:03:40,250 --> 00:03:46,459
allows a<font color="#E5E5E5"> processes to communicate it can</font>

73
00:03:43,130 --> 00:03:49,250
be one-way or duplex<font color="#CCCCCC"> half a half duplex</font>

74
00:03:46,459 --> 00:03:53,000
or full duplex<font color="#CCCCCC"> and it utilizes a unique</font>

75
00:03:49,250 --> 00:03:56,359
<font color="#E5E5E5">file system</font><font color="#CCCCCC"> that is called</font><font color="#E5E5E5"> a NTFS name</font>

76
00:03:53,000 --> 00:03:58,370
type file system and<font color="#E5E5E5"> it allows in the</font>

77
00:03:56,359 --> 00:04:01,549
default configuration<font color="#E5E5E5"> of it it is</font><font color="#CCCCCC"> that</font>

78
00:03:58,370 --> 00:04:04,790
<font color="#E5E5E5">is</font><font color="#CCCCCC"> that any process</font><font color="#E5E5E5"> can access any name</font>

79
00:04:01,549 --> 00:04:09,200
pipe this<font color="#E5E5E5"> is the default configuration</font>

80
00:04:04,790 --> 00:04:12,440
<font color="#E5E5E5">and all instances of the</font><font color="#CCCCCC"> name pipe share</font>

81
00:04:09,200 --> 00:04:15,649
the same pipe name<font color="#E5E5E5"> each process has</font><font color="#CCCCCC"> a</font>

82
00:04:12,440 --> 00:04:18,260
pipe and if this is the pipe server<font color="#CCCCCC"> and</font>

83
00:04:15,650 --> 00:04:21,228
multiple other processes can connect to

84
00:04:18,260 --> 00:04:23,539
<font color="#E5E5E5">it just like socket and this is called</font>

85
00:04:21,228 --> 00:04:27,180
the pipe instance and they all share<font color="#CCCCCC"> the</font>

86
00:04:23,539 --> 00:04:30,070
<font color="#CCCCCC">same name</font><font color="#E5E5E5"> similar</font><font color="#CCCCCC"> to socket</font>

87
00:04:27,180 --> 00:04:32,590
and so you have half duplex or full

88
00:04:30,070 --> 00:04:38,380
duplex<font color="#CCCCCC"> you have byte-oriented or packet</font>

89
00:04:32,590 --> 00:04:40,960
oriented local or network<font color="#CCCCCC"> windows</font><font color="#E5E5E5"> night</font>

90
00:04:38,380 --> 00:04:45,219
pipes<font color="#CCCCCC"> is accessible through network with</font>

91
00:04:40,960 --> 00:04:48,940
some<font color="#CCCCCC"> preconditions and this is something</font>

92
00:04:45,220 --> 00:04:52,900
<font color="#CCCCCC">that</font><font color="#E5E5E5"> almost nobody knows when I first</font>

93
00:04:48,940 --> 00:04:54,910
started this research<font color="#E5E5E5"> I found that some</font>

94
00:04:52,900 --> 00:04:56,289
<font color="#E5E5E5">people know what name pipes are but they</font>

95
00:04:54,910 --> 00:04:59,860
also<font color="#CCCCCC"> think that inter process</font>

96
00:04:56,290 --> 00:05:02,530
communication<font color="#CCCCCC"> is local only</font><font color="#E5E5E5"> and I found</font>

97
00:04:59,860 --> 00:05:06,010
out that this is<font color="#CCCCCC"> not the case you can</font>

98
00:05:02,530 --> 00:05:09,489
actually<font color="#E5E5E5"> access link pipes remotely how</font>

99
00:05:06,010 --> 00:05:12,909
using a one of these two services<font color="#E5E5E5"> SMB</font>

100
00:05:09,490 --> 00:05:19,690
port number<font color="#E5E5E5"> four</font><font color="#CCCCCC"> four</font><font color="#E5E5E5"> five or our PC</font>

101
00:05:12,910 --> 00:05:21,460
port 135<font color="#CCCCCC"> RPC</font><font color="#E5E5E5"> if you don't know what it</font>

102
00:05:19,690 --> 00:05:23,260
is is a remote procedure call this is

103
00:05:21,460 --> 00:05:25,599
<font color="#E5E5E5">the standard protocol or in Windows that</font>

104
00:05:23,260 --> 00:05:28,960
<font color="#CCCCCC">allows a one program to invoke a service</font>

105
00:05:25,600 --> 00:05:33,220
in another program and<font color="#CCCCCC"> it utilizes</font><font color="#E5E5E5"> the</font>

106
00:05:28,960 --> 00:05:36,070
port number 135<font color="#E5E5E5"> TCP</font><font color="#CCCCCC"> or UDP</font><font color="#E5E5E5"> and DC RPC</font>

107
00:05:33,220 --> 00:05:38,140
this is a variant<font color="#E5E5E5"> of RPC distributed</font>

108
00:05:36,070 --> 00:05:40,360
<font color="#CCCCCC">computing</font><font color="#E5E5E5"> in a computing environment</font>

109
00:05:38,140 --> 00:05:42,610
remote possible call<font color="#E5E5E5"> and this is</font>

110
00:05:40,360 --> 00:05:45,580
actually<font color="#E5E5E5"> let the programmer think that</font>

111
00:05:42,610 --> 00:05:49,110
the procedure or<font color="#CCCCCC"> the service is local</font>

112
00:05:45,580 --> 00:05:54,180
<font color="#E5E5E5">when it actually it is a remote service</font>

113
00:05:49,110 --> 00:05:56,500
<font color="#E5E5E5">so this is just a variant of RPC SMB</font>

114
00:05:54,180 --> 00:06:00,130
server method block

115
00:05:56,500 --> 00:06:02,830
probably most of you<font color="#E5E5E5"> know it with file</font>

116
00:06:00,130 --> 00:06:06,520
<font color="#E5E5E5">shares you can see the different file</font>

117
00:06:02,830 --> 00:06:10,539
<font color="#CCCCCC">shares</font><font color="#E5E5E5"> so if you have any open SMB port</font>

118
00:06:06,520 --> 00:06:13,000
or<font color="#E5E5E5"> a file share and</font><font color="#CCCCCC"> like--see dollar</font><font color="#E5E5E5"> for</font>

119
00:06:10,540 --> 00:06:21,280
example then<font color="#CCCCCC"> theoretically you can use</font>

120
00:06:13,000 --> 00:06:24,370
it also to connect to<font color="#E5E5E5"> name pipe so there</font>

121
00:06:21,280 --> 00:06:26,739
<font color="#E5E5E5">are actually two</font><font color="#CCCCCC"> types</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> name pipes</font><font color="#E5E5E5"> one</font>

122
00:06:24,370 --> 00:06:29,500
is named pipes that has<font color="#E5E5E5"> specific names</font>

123
00:06:26,740 --> 00:06:32,020
the<font color="#E5E5E5"> other is unnamed</font><font color="#CCCCCC"> or anonymous pipes</font>

124
00:06:29,500 --> 00:06:34,990
not the anonymous<font color="#CCCCCC"> with this small icon</font>

125
00:06:32,020 --> 00:06:38,260
there but<font color="#E5E5E5"> just general</font><font color="#CCCCCC"> allowing spikes</font>

126
00:06:34,990 --> 00:06:39,879
and this is actually nine types that are

127
00:06:38,260 --> 00:06:41,889
unnamed

128
00:06:39,879 --> 00:06:44,439
and when you<font color="#E5E5E5"> open it you doesn't assign</font>

129
00:06:41,889 --> 00:06:49,240
<font color="#CCCCCC">you don't assign the</font><font color="#E5E5E5"> name to it and</font><font color="#CCCCCC"> it</font>

130
00:06:44,439 --> 00:06:51,429
closes<font color="#E5E5E5"> one once the process is over and</font>

131
00:06:49,240 --> 00:07:02,830
but<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> actually it is implemented</font>

132
00:06:51,429 --> 00:07:05,020
<font color="#E5E5E5">using random names</font><font color="#CCCCCC"> we always kill</font>

133
00:07:02,830 --> 00:07:07,109
message in the<font color="#E5E5E5"> potatoes</font><font color="#CCCCCC"> exclusion</font>

134
00:07:05,020 --> 00:07:12,969
<font color="#CCCCCC">shocked</font><font color="#E5E5E5"> by download</font><font color="#CCCCCC"> own</font><font color="#E5E5E5"> assistance</font>

135
00:07:07,110 --> 00:07:14,800
<font color="#CCCCCC">georgian choppa Britney I'm okay so</font>

136
00:07:12,969 --> 00:07:16,509
there<font color="#E5E5E5"> are two types main types and are</font>

137
00:07:14,800 --> 00:07:18,580
main types that I'm going to<font color="#E5E5E5"> focus</font><font color="#CCCCCC"> now</font>

138
00:07:16,509 --> 00:07:20,319
only<font color="#CCCCCC"> on the name pipes</font><font color="#E5E5E5"> because this is</font>

139
00:07:18,580 --> 00:07:24,698
what we<font color="#E5E5E5"> find interesting</font><font color="#CCCCCC"> the unning</font>

140
00:07:20,319 --> 00:07:26,769
pipes the anonymous pipes<font color="#E5E5E5"> cannot be you</font>

141
00:07:24,699 --> 00:07:29,559
cannot<font color="#E5E5E5"> communicate</font><font color="#CCCCCC"> with it remotely</font><font color="#E5E5E5"> only</font>

142
00:07:26,769 --> 00:07:32,649
locally and we is research<font color="#CCCCCC"> then a</font>

143
00:07:29,559 --> 00:07:34,929
regular<font color="#E5E5E5"> name</font><font color="#CCCCCC"> type the one that</font><font color="#E5E5E5"> has name</font>

144
00:07:32,649 --> 00:07:39,039
because you<font color="#E5E5E5"> can connect</font><font color="#CCCCCC"> it you can</font>

145
00:07:34,929 --> 00:07:41,138
connect remotely<font color="#E5E5E5"> to it so how can you</font>

146
00:07:39,039 --> 00:07:44,919
connect to an empty pipe let's see some

147
00:07:41,139 --> 00:07:48,189
interesting utilities<font color="#CCCCCC"> first you use NPS</font>

148
00:07:44,919 --> 00:07:51,099
s95<font color="#E5E5E5"> file system and you cannot mount it</font>

149
00:07:48,189 --> 00:07:55,240
using a regular<font color="#E5E5E5"> SMB connection you can</font>

150
00:07:51,099 --> 00:07:56,740
just write down<font color="#E5E5E5"> / / IP address / pipe</font>

151
00:07:55,240 --> 00:07:58,689
and pipe name this is<font color="#CCCCCC"> the way you</font>

152
00:07:56,740 --> 00:08:02,800
connect to a pipe but<font color="#E5E5E5"> you cannot do it</font>

153
00:07:58,689 --> 00:08:06,129
in your<font color="#CCCCCC"> Windows run</font><font color="#E5E5E5"> in your regular</font><font color="#CCCCCC"> use</font>

154
00:08:02,800 --> 00:08:08,469
via<font color="#E5E5E5"> Windows command or mount you need to</font>

155
00:08:06,129 --> 00:08:11,589
do it using an either programmatically

156
00:08:08,469 --> 00:08:14,229
<font color="#E5E5E5">or dedicated tools that allows you to</font>

157
00:08:11,589 --> 00:08:19,119
talk to<font color="#CCCCCC"> name pipes and I'm going</font><font color="#E5E5E5"> to show</font>

158
00:08:14,229 --> 00:08:21,099
you<font color="#E5E5E5"> a very nice one and this is the tool</font>

159
00:08:19,119 --> 00:08:25,269
<font color="#CCCCCC">that we were using this</font><font color="#E5E5E5"> is called IO</font>

160
00:08:21,099 --> 00:08:28,509
ninja<font color="#CCCCCC"> input/output ninja</font><font color="#E5E5E5"> this is the</font>

161
00:08:25,269 --> 00:08:31,869
Swiss<font color="#E5E5E5"> Army knife</font><font color="#CCCCCC"> for communication of</font>

162
00:08:28,509 --> 00:08:34,959
all kind you can also use it<font color="#E5E5E5"> socket</font>

163
00:08:31,869 --> 00:08:38,469
communication tool just<font color="#E5E5E5"> a plain socket</font>

164
00:08:34,958 --> 00:08:40,809
or file but the<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> really makes</font>

165
00:08:38,469 --> 00:08:43,290
this tool very unique<font color="#E5E5E5"> and strong is its</font>

166
00:08:40,809 --> 00:08:47,979
ability to<font color="#E5E5E5"> communicate to</font><font color="#CCCCCC"> 9/5 and also</font>

167
00:08:43,289 --> 00:08:50,439
<font color="#E5E5E5">to</font><font color="#CCCCCC"> sniff named pipes content so this</font><font color="#E5E5E5"> is</font>

168
00:08:47,980 --> 00:08:55,610
how it looks<font color="#E5E5E5"> like</font>

169
00:08:50,439 --> 00:08:57,370
and this is how<font color="#CCCCCC"> a communication</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> name</font>

170
00:08:55,610 --> 00:09:00,410
pipes look like you can see that<font color="#CCCCCC"> it is</font>

171
00:08:57,370 --> 00:09:03,230
unencrypted<font color="#E5E5E5"> obviously SMB an RPC are</font>

172
00:09:00,410 --> 00:09:05,899
unencrypted<font color="#CCCCCC"> so you can see that the</font><font color="#E5E5E5"> name</font>

173
00:09:03,230 --> 00:09:11,480
<font color="#CCCCCC">time communication</font><font color="#E5E5E5"> looks like SMB when</font>

174
00:09:05,899 --> 00:09:13,220
you look at it at Wireshark but what are

175
00:09:11,480 --> 00:09:17,870
the restrictions of<font color="#E5E5E5"> names</font><font color="#CCCCCC"> live</font>

176
00:09:13,220 --> 00:09:22,519
communication so there<font color="#E5E5E5"> are two main</font>

177
00:09:17,870 --> 00:09:26,209
restrictions<font color="#E5E5E5"> one is</font><font color="#CCCCCC"> ACLs just regular</font>

178
00:09:22,519 --> 00:09:29,689
access control<font color="#CCCCCC"> is like you using</font><font color="#E5E5E5"> files</font>

179
00:09:26,209 --> 00:09:31,969
<font color="#CCCCCC">this is the reason that it uses</font><font color="#E5E5E5"> this ACL</font>

180
00:09:29,689 --> 00:09:35,930
is that it actually<font color="#CCCCCC"> uses the same</font>

181
00:09:31,970 --> 00:09:38,779
security descriptors in<font color="#E5E5E5"> Windows and</font><font color="#CCCCCC"> you</font>

182
00:09:35,930 --> 00:09:43,219
can assign a specific ACLs for specific

183
00:09:38,779 --> 00:09:44,629
<font color="#E5E5E5">users to a specific name pipe but again</font>

184
00:09:43,220 --> 00:09:46,639
the default<font color="#CCCCCC"> configuration of an</font>

185
00:09:44,629 --> 00:09:49,370
<font color="#CCCCCC">eight-five</font><font color="#E5E5E5"> is that if you are</font><font color="#CCCCCC"> if you</font>

186
00:09:46,639 --> 00:09:54,040
<font color="#E5E5E5">don't decide a default ACL a specific</font>

187
00:09:49,370 --> 00:09:54,040
ACL for specific user anyone can connect

188
00:09:55,360 --> 00:10:03,980
and anonymously very nice for hackers

189
00:10:00,139 --> 00:10:06,559
<font color="#E5E5E5">and if you want to enumerate the</font>

190
00:10:03,980 --> 00:10:08,540
specific name<font color="#CCCCCC"> pipe ACL</font><font color="#E5E5E5"> this is how it</font>

191
00:10:06,559 --> 00:10:11,899
looks<font color="#CCCCCC"> like</font><font color="#E5E5E5"> you can see that in this</font>

192
00:10:08,540 --> 00:10:13,670
specific name pipe in it shut down<font color="#CCCCCC"> it's</font>

193
00:10:11,899 --> 00:10:15,110
called this<font color="#E5E5E5"> is a</font><font color="#CCCCCC"> Windows name pipe you</font>

194
00:10:13,670 --> 00:10:21,050
can<font color="#E5E5E5"> see that everyone can connect</font>

195
00:10:15,110 --> 00:10:24,069
anonymously there are other tools<font color="#E5E5E5"> as</font>

196
00:10:21,050 --> 00:10:27,709
well<font color="#E5E5E5"> third-party tools this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the</font>

197
00:10:24,069 --> 00:10:30,949
obsolete<font color="#CCCCCC"> in abundant utility that</font><font color="#E5E5E5"> is</font>

198
00:10:27,709 --> 00:10:34,040
<font color="#E5E5E5">called beyond</font><font color="#CCCCCC"> Security pipe security</font>

199
00:10:30,949 --> 00:10:35,990
editor it used to work<font color="#E5E5E5"> in Windows XP</font><font color="#CCCCCC"> but</font>

200
00:10:34,040 --> 00:10:38,389
it's not<font color="#E5E5E5"> relevant anymore unless you use</font>

201
00:10:35,990 --> 00:10:43,459
<font color="#E5E5E5">Windows XP</font><font color="#CCCCCC"> and then it's not good for</font>

202
00:10:38,389 --> 00:10:47,209
<font color="#E5E5E5">you and another limitation of main pipes</font>

203
00:10:43,459 --> 00:10:49,399
unlike sockets<font color="#E5E5E5"> and any other interface</font>

204
00:10:47,209 --> 00:10:51,949
you are<font color="#CCCCCC"> familiar</font><font color="#E5E5E5"> with is maximum</font>

205
00:10:49,399 --> 00:10:54,860
instances each<font color="#CCCCCC"> connection to an end pipe</font>

206
00:10:51,949 --> 00:10:56,990
is called a named pipe instance and when

207
00:10:54,860 --> 00:10:59,839
a client connects<font color="#CCCCCC"> to a named pipe it</font>

208
00:10:56,990 --> 00:11:02,870
actually increases a counter<font color="#E5E5E5"> that can</font>

209
00:10:59,839 --> 00:11:04,730
limit<font color="#E5E5E5"> the number</font><font color="#CCCCCC"> of maximum instances</font>

210
00:11:02,870 --> 00:11:07,220
so here you can<font color="#CCCCCC"> see the different name</font>

211
00:11:04,730 --> 00:11:10,430
pipes on<font color="#CCCCCC"> the left and on the right you</font>

212
00:11:07,220 --> 00:11:12,980
can<font color="#E5E5E5"> see the</font><font color="#CCCCCC"> maximum number of</font><font color="#E5E5E5"> entities</font><font color="#CCCCCC"> -</font>

213
00:11:10,430 --> 00:11:17,120
<font color="#CCCCCC">one means no limitation</font><font color="#E5E5E5"> but if there is</font>

214
00:11:12,980 --> 00:11:20,930
a limitation then once the number<font color="#E5E5E5"> of</font>

215
00:11:17,120 --> 00:11:23,180
instances in<font color="#CCCCCC"> which it reaches the number</font>

216
00:11:20,930 --> 00:11:24,709
of instances<font color="#E5E5E5"> it won't let you connect to</font>

217
00:11:23,180 --> 00:11:27,380
this<font color="#E5E5E5"> name pipe so this is something</font>

218
00:11:24,710 --> 00:11:31,790
<font color="#E5E5E5">unique to name pipes in connection</font>

219
00:11:27,380 --> 00:11:34,300
limitations or instances limitations so

220
00:11:31,790 --> 00:11:37,640
how can<font color="#E5E5E5"> you enumerate and name pipe</font>

221
00:11:34,300 --> 00:11:40,430
<font color="#E5E5E5">there are several tools most of them by</font>

222
00:11:37,640 --> 00:11:43,069
the<font color="#E5E5E5"> way are</font><font color="#CCCCCC"> these internal utilities so</font>

223
00:11:40,430 --> 00:11:46,160
here you can see this is the the most

224
00:11:43,070 --> 00:11:48,710
<font color="#E5E5E5">cute tool in for</font><font color="#CCCCCC"> name pipes</font>

225
00:11:46,160 --> 00:11:51,319
this is called a pipe list and you can

226
00:11:48,710 --> 00:11:53,060
<font color="#CCCCCC">see that this utility just enumerate the</font>

227
00:11:51,320 --> 00:11:57,650
<font color="#E5E5E5">different</font><font color="#CCCCCC"> name pipes there are instances</font>

228
00:11:53,060 --> 00:12:00,050
<font color="#E5E5E5">and max instances so the Princeton I was</font>

229
00:11:57,650 --> 00:12:03,829
showing<font color="#E5E5E5"> you was actually the</font><font color="#CCCCCC"> output of</font>

230
00:12:00,050 --> 00:12:06,410
this utility<font color="#E5E5E5"> pipe list another useful</font>

231
00:12:03,830 --> 00:12:08,600
utility is called<font color="#CCCCCC"> pipe ACL this is also</font>

232
00:12:06,410 --> 00:12:12,829
<font color="#E5E5E5">from</font><font color="#CCCCCC"> this internal</font><font color="#E5E5E5"> and this shows you</font>

233
00:12:08,600 --> 00:12:14,900
the permission<font color="#E5E5E5"> so the the permissions I</font>

234
00:12:12,830 --> 00:12:21,380
showed you<font color="#CCCCCC"> earlier this is actually this</font>

235
00:12:14,900 --> 00:12:25,069
<font color="#E5E5E5">utilities output and there are other</font>

236
00:12:21,380 --> 00:12:27,230
utilities as<font color="#CCCCCC"> well in Metasploit when we</font>

237
00:12:25,070 --> 00:12:29,420
first started research we<font color="#CCCCCC"> searched for</font>

238
00:12:27,230 --> 00:12:33,790
information<font color="#E5E5E5"> about named pipes and we</font>

239
00:12:29,420 --> 00:12:37,069
found<font color="#CCCCCC"> almost nothing except for a small</font>

240
00:12:33,790 --> 00:12:39,980
plug in in<font color="#CCCCCC"> Metasploit that is called</font>

241
00:12:37,070 --> 00:12:43,100
<font color="#E5E5E5">pipe</font><font color="#CCCCCC"> auditor there are actually two</font>

242
00:12:39,980 --> 00:12:45,560
plugins<font color="#E5E5E5"> pipe auditor and pipe</font><font color="#CCCCCC"> DC</font><font color="#E5E5E5"> RPC</font>

243
00:12:43,100 --> 00:12:47,830
auditor the SMB version is pipe auditor

244
00:12:45,560 --> 00:12:51,199
and<font color="#CCCCCC"> the RPC</font><font color="#E5E5E5"> version in the other one</font>

245
00:12:47,830 --> 00:12:54,380
that allows you to<font color="#CCCCCC"> remotely enumerate</font>

246
00:12:51,200 --> 00:12:59,710
for nine pipes but it is largely<font color="#E5E5E5"> unused</font>

247
00:12:54,380 --> 00:13:03,320
<font color="#E5E5E5">and not that familiar it's pretty small</font>

248
00:12:59,710 --> 00:13:05,410
utility<font color="#E5E5E5"> that I never heard of and we use</font>

249
00:13:03,320 --> 00:13:07,910
<font color="#CCCCCC">Metasploit in context obviously but</font>

250
00:13:05,410 --> 00:13:09,829
people<font color="#E5E5E5"> don't know that the name pot</font>

251
00:13:07,910 --> 00:13:12,079
exists and they don't know<font color="#E5E5E5"> that it can</font>

252
00:13:09,830 --> 00:13:14,360
<font color="#CCCCCC">be connected remotely</font><font color="#E5E5E5"> and enumerated so</font>

253
00:13:12,080 --> 00:13:16,660
obviously then<font color="#CCCCCC"> no-one</font><font color="#E5E5E5"> searches for this</font>

254
00:13:14,360 --> 00:13:21,579
<font color="#CCCCCC">tool but we find</font><font color="#E5E5E5"> it</font>

255
00:13:16,660 --> 00:13:24,699
pretty pretty useful so how can you

256
00:13:21,579 --> 00:13:27,699
<font color="#CCCCCC">sniff</font><font color="#E5E5E5"> name</font><font color="#CCCCCC"> type content</font><font color="#E5E5E5"> yet again</font><font color="#CCCCCC"> I Oh</font>

257
00:13:24,699 --> 00:13:31,319
ninja<font color="#CCCCCC"> iron engine and they have a pretty</font>

258
00:13:27,699 --> 00:13:34,750
new module that<font color="#CCCCCC"> allows you to actually</font>

259
00:13:31,319 --> 00:13:38,439
activate it like Wireshark<font color="#CCCCCC"> for nine</font>

260
00:13:34,750 --> 00:13:41,019
<font color="#CCCCCC">types so you activate</font><font color="#E5E5E5"> my own ninja as an</font>

261
00:13:38,439 --> 00:13:45,160
administrator<font color="#E5E5E5"> and then you start it</font><font color="#CCCCCC"> you</font>

262
00:13:41,019 --> 00:13:48,040
can see<font color="#E5E5E5"> that I assign the star filter</font>

263
00:13:45,160 --> 00:13:49,750
<font color="#E5E5E5">which means just get everything for all</font>

264
00:13:48,040 --> 00:13:52,509
of the name types that<font color="#E5E5E5"> you can read and</font>

265
00:13:49,750 --> 00:13:56,399
<font color="#CCCCCC">then I immediately start to see some</font>

266
00:13:52,509 --> 00:14:03,699
information<font color="#E5E5E5"> about these named pipes</font>

267
00:13:56,399 --> 00:14:06,009
request and response and and<font color="#CCCCCC"> here is</font>

268
00:14:03,699 --> 00:14:09,420
another bigger example you can see the

269
00:14:06,009 --> 00:14:16,149
<font color="#CCCCCC">actual content</font><font color="#E5E5E5"> which is obviously not</font>

270
00:14:09,420 --> 00:14:19,180
<font color="#E5E5E5">encrypted and once you we have this nice</font>

271
00:14:16,149 --> 00:14:21,189
interface<font color="#E5E5E5"> that no one is aware of the</font>

272
00:14:19,180 --> 00:14:24,758
logical thing<font color="#CCCCCC"> to do and what we started</font>

273
00:14:21,189 --> 00:14:26,829
<font color="#E5E5E5">to do in our research is to fuzz it and</font>

274
00:14:24,759 --> 00:14:29,470
if you don't know what was<font color="#E5E5E5"> in it fuzzing</font>

275
00:14:26,829 --> 00:14:31,060
is<font color="#E5E5E5"> fuzzing is fast testing this is an</font>

276
00:14:29,470 --> 00:14:32,680
automated software testing technique

277
00:14:31,060 --> 00:14:35,649
that involves providing<font color="#E5E5E5"> invalid</font>

278
00:14:32,680 --> 00:14:37,899
unexpected or random data to input to

279
00:14:35,649 --> 00:14:41,620
computer programs<font color="#E5E5E5"> it sounds a little bit</font>

280
00:14:37,899 --> 00:14:44,949
like you a but<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> actually doing is</font>

281
00:14:41,620 --> 00:14:46,839
doing some different<font color="#E5E5E5"> tests and</font><font color="#CCCCCC"> different</font>

282
00:14:44,949 --> 00:14:49,060
techniques<font color="#CCCCCC"> that allows you to find</font>

283
00:14:46,839 --> 00:14:52,949
vulnerabilities in bugs that cannot<font color="#E5E5E5"> be</font>

284
00:14:49,060 --> 00:14:56,258
<font color="#CCCCCC">found in other ways</font><font color="#E5E5E5"> so usually you</font>

285
00:14:52,949 --> 00:14:58,899
perform<font color="#E5E5E5"> a fighting with</font><font color="#CCCCCC"> fibers which is</font>

286
00:14:56,259 --> 00:15:00,490
automatic<font color="#E5E5E5"> cutting tools and if you have</font>

287
00:14:58,899 --> 00:15:03,040
an iPhone for<font color="#CCCCCC"> example in if you</font>

288
00:15:00,490 --> 00:15:05,620
jailbroken it most chances are that the

289
00:15:03,040 --> 00:15:08,589
bug and<font color="#E5E5E5"> the viability that allowed</font>

290
00:15:05,620 --> 00:15:13,809
jailbreaking<font color="#E5E5E5"> it was found using faulty</font>

291
00:15:08,589 --> 00:15:17,740
<font color="#E5E5E5">utilities and there are two types of</font>

292
00:15:13,809 --> 00:15:19,839
fuzzing dump or<font color="#E5E5E5"> blackbox</font><font color="#CCCCCC"> fading when you</font>

293
00:15:17,740 --> 00:15:22,209
just bombard the interface<font color="#E5E5E5"> without</font>

294
00:15:19,839 --> 00:15:25,689
knowing<font color="#CCCCCC"> almost anything about this</font>

295
00:15:22,209 --> 00:15:29,050
interface just<font color="#E5E5E5"> send random strings and</font>

296
00:15:25,689 --> 00:15:30,459
random numbers and<font color="#E5E5E5"> bytes etc and smart</font>

297
00:15:29,050 --> 00:15:33,280
fuzz in which we actually

298
00:15:30,460 --> 00:15:36,700
understand the expected input and the

299
00:15:33,280 --> 00:15:40,270
purpose of each field<font color="#CCCCCC"> and you start to</font>

300
00:15:36,700 --> 00:15:42,580
analyze<font color="#E5E5E5"> it during our research we only</font>

301
00:15:40,270 --> 00:15:44,800
performed on fuzzing<font color="#E5E5E5"> and we were able</font><font color="#CCCCCC"> to</font>

302
00:15:42,580 --> 00:15:48,610
find<font color="#CCCCCC"> very nice them</font><font color="#E5E5E5"> I'm going to show</font>

303
00:15:44,800 --> 00:15:51,219
<font color="#E5E5E5">you in a short while using only</font><font color="#CCCCCC"> dump</font>

304
00:15:48,610 --> 00:15:53,260
<font color="#CCCCCC">files so imagine what you could do</font><font color="#E5E5E5"> with</font>

305
00:15:51,220 --> 00:15:55,420
<font color="#E5E5E5">smart fighting and especially if you</font>

306
00:15:53,260 --> 00:15:58,630
connect it to<font color="#CCCCCC"> a word well-known files in</font>

307
00:15:55,420 --> 00:16:03,520
frameworks like peach this is something

308
00:15:58,630 --> 00:16:05,560
we haven't<font color="#CCCCCC"> done</font><font color="#E5E5E5"> yet</font><font color="#CCCCCC"> so what what we the</font>

309
00:16:03,520 --> 00:16:07,750
utility<font color="#E5E5E5"> that we used is just</font><font color="#CCCCCC"> a small</font>

310
00:16:05,560 --> 00:16:10,839
photo tool that we found<font color="#E5E5E5"> this is the</font>

311
00:16:07,750 --> 00:16:14,800
tool it<font color="#CCCCCC"> it is written</font><font color="#E5E5E5"> more</font><font color="#CCCCCC"> than 10 years</font>

312
00:16:10,840 --> 00:16:17,800
<font color="#CCCCCC">ago</font><font color="#E5E5E5"> and a programmer actually wrote it</font>

313
00:16:14,800 --> 00:16:22,990
as a<font color="#E5E5E5"> local father</font><font color="#CCCCCC"> only because he also</font>

314
00:16:17,800 --> 00:16:25,479
didn't know<font color="#E5E5E5"> that</font><font color="#CCCCCC"> it is it is possible to</font>

315
00:16:22,990 --> 00:16:27,670
<font color="#E5E5E5">connect to a named pipe remotely so we</font>

316
00:16:25,480 --> 00:16:30,070
slightly<font color="#E5E5E5"> modified it and we start</font>

317
00:16:27,670 --> 00:16:32,469
<font color="#CCCCCC">fasting using this nice utility</font><font color="#E5E5E5"> and soon</font>

318
00:16:30,070 --> 00:16:34,240
after just a few days after<font color="#CCCCCC"> we</font><font color="#E5E5E5"> found</font>

319
00:16:32,470 --> 00:16:40,390
this one and one ability<font color="#E5E5E5"> that I'm going</font>

320
00:16:34,240 --> 00:16:43,740
to<font color="#E5E5E5"> show you in delight it so what is the</font>

321
00:16:40,390 --> 00:16:48,310
actually the<font color="#E5E5E5"> the actual impact of this</font>

322
00:16:43,740 --> 00:16:50,680
interface<font color="#CCCCCC"> so many pieces</font><font color="#E5E5E5"> of software</font>

323
00:16:48,310 --> 00:16:54,310
work with<font color="#CCCCCC"> hidden on ardan documented API</font>

324
00:16:50,680 --> 00:16:56,589
and<font color="#E5E5E5"> named</font><font color="#CCCCCC"> pipes is one of them and the</font>

325
00:16:54,310 --> 00:16:58,329
<font color="#E5E5E5">forgotten nature of</font><font color="#CCCCCC"> named pipes</font><font color="#E5E5E5"> when I</font>

326
00:16:56,590 --> 00:17:01,030
asked you you<font color="#CCCCCC"> who knows the name types</font>

327
00:16:58,330 --> 00:17:03,070
just few I saw just a<font color="#CCCCCC"> few hands going</font>

328
00:17:01,030 --> 00:17:06,069
and going up so obviously this is<font color="#E5E5E5"> a</font>

329
00:17:03,070 --> 00:17:08,800
forgotten interface it gives you an

330
00:17:06,069 --> 00:17:10,540
uncharted territory of socket like

331
00:17:08,800 --> 00:17:12,849
interface that<font color="#E5E5E5"> can contain</font>

332
00:17:10,540 --> 00:17:15,909
vulnerabilities any vulnerability that

333
00:17:12,849 --> 00:17:18,040
can be found<font color="#E5E5E5"> in a socket remote code</font>

334
00:17:15,910 --> 00:17:21,610
execution buffer overflow the amount<font color="#E5E5E5"> of</font>

335
00:17:18,040 --> 00:17:23,440
service<font color="#E5E5E5"> or injections even can be found</font>

336
00:17:21,609 --> 00:17:25,599
in any pipes as<font color="#CCCCCC"> well because you</font><font color="#E5E5E5"> can do</font>

337
00:17:23,440 --> 00:17:29,110
pretty<font color="#E5E5E5"> much whatever you want in an end</font>

338
00:17:25,599 --> 00:17:31,330
pipe you<font color="#CCCCCC"> can for example</font><font color="#E5E5E5"> create a XML</font>

339
00:17:29,110 --> 00:17:34,330
like<font color="#CCCCCC"> a web service like name pipe and</font>

340
00:17:31,330 --> 00:17:35,980
then any application a regular

341
00:17:34,330 --> 00:17:39,699
application<font color="#E5E5E5"> vulnerability can be</font>

342
00:17:35,980 --> 00:17:42,250
relevant to<font color="#E5E5E5"> name pipe as</font><font color="#CCCCCC"> well but the</font>

343
00:17:39,700 --> 00:17:43,860
<font color="#E5E5E5">most common more common our severe one</font>

344
00:17:42,250 --> 00:17:45,960
is buffer overflow denial

345
00:17:43,860 --> 00:17:50,459
service and in some cases<font color="#E5E5E5"> remote code</font>

346
00:17:45,960 --> 00:17:53,670
execution<font color="#E5E5E5"> so if a named pipe allows</font>

347
00:17:50,460 --> 00:17:54,990
remote<font color="#E5E5E5"> access you can</font><font color="#CCCCCC"> have a remote in a</font>

348
00:17:53,670 --> 00:17:58,620
lot of<font color="#E5E5E5"> service or remote code execution</font>

349
00:17:54,990 --> 00:18:00,900
<font color="#E5E5E5">and if this is not a</font><font color="#CCCCCC"> well-known or there</font>

350
00:17:58,620 --> 00:18:03,030
is no patch you can have<font color="#E5E5E5"> zero data stone</font>

351
00:18:00,900 --> 00:18:06,179
abilities<font color="#E5E5E5"> have you heard of the recent</font>

352
00:18:03,030 --> 00:18:09,510
one cry just a month ago<font color="#E5E5E5"> so imagine that</font>

353
00:18:06,179 --> 00:18:11,790
someone would find<font color="#CCCCCC"> a vulnerability</font><font color="#E5E5E5"> in a</font>

354
00:18:09,510 --> 00:18:15,720
<font color="#E5E5E5">Windows</font><font color="#CCCCCC"> 9 pipe that would allow anyone</font>

355
00:18:11,790 --> 00:18:20,220
to remotely execute commands<font color="#CCCCCC"> in Windows</font>

356
00:18:15,720 --> 00:18:26,970
<font color="#E5E5E5">so you would have a</font><font color="#CCCCCC"> 1</font><font color="#E5E5E5"> Cry 2 version that</font>

357
00:18:20,220 --> 00:18:32,240
utilizes<font color="#CCCCCC"> name</font><font color="#E5E5E5"> pipes or nobility game</font>

358
00:18:26,970 --> 00:18:32,240
<font color="#E5E5E5">over remote code execution or remote</font><font color="#CCCCCC"> DOS</font>

359
00:18:33,559 --> 00:18:41,190
so let's see a case study of two small

360
00:18:38,460 --> 00:18:45,299
utilities that<font color="#E5E5E5"> we found vulnerable to</font>

361
00:18:41,190 --> 00:18:48,720
the remote remote denial of service and

362
00:18:45,299 --> 00:18:53,850
even<font color="#E5E5E5"> remote command injection using</font><font color="#CCCCCC"> name</font>

363
00:18:48,720 --> 00:18:56,040
<font color="#E5E5E5">pipes so we found the two programs</font><font color="#CCCCCC"> were</font>

364
00:18:53,850 --> 00:18:58,350
vulnerable<font color="#CCCCCC"> one is Q bittern it is a</font>

365
00:18:56,040 --> 00:19:00,750
<font color="#E5E5E5">cross-platform client for</font><font color="#CCCCCC"> a BitTorrent</font>

366
00:18:58,350 --> 00:19:03,120
protocol<font color="#E5E5E5"> it's open source and written in</font>

367
00:19:00,750 --> 00:19:05,970
<font color="#E5E5E5">C++ which hackers like because there is</font>

368
00:19:03,120 --> 00:19:08,750
buffer overflow<font color="#E5E5E5"> in C++ and the other one</font>

369
00:19:05,970 --> 00:19:11,730
is<font color="#CCCCCC"> sugarsync this is a cloud service</font>

370
00:19:08,750 --> 00:19:14,720
<font color="#CCCCCC">that allows the synchronizing files and</font>

371
00:19:11,730 --> 00:19:17,809
this is the client<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this cloud service</font>

372
00:19:14,720 --> 00:19:21,240
<font color="#CCCCCC">used for backups cetera there are many</font>

373
00:19:17,809 --> 00:19:23,850
similar services as well and this is

374
00:19:21,240 --> 00:19:25,980
<font color="#E5E5E5">cross-platform but we only focus on the</font>

375
00:19:23,850 --> 00:19:28,409
<font color="#CCCCCC">Windows version because obviously</font>

376
00:19:25,980 --> 00:19:33,299
<font color="#CCCCCC">Windows named pipes exists only on</font>

377
00:19:28,410 --> 00:19:35,669
<font color="#CCCCCC">Windows so both applications</font><font color="#E5E5E5"> uses</font>

378
00:19:33,299 --> 00:19:38,010
something that is called<font color="#CCCCCC"> Qt framework</font>

379
00:19:35,669 --> 00:19:42,179
<font color="#E5E5E5">and this form this is a cross-platform</font>

380
00:19:38,010 --> 00:19:44,910
<font color="#E5E5E5">framework for developers and it is</font>

381
00:19:42,179 --> 00:19:48,480
<font color="#E5E5E5">embedded in many applications</font><font color="#CCCCCC"> including</font>

382
00:19:44,910 --> 00:19:50,669
<font color="#E5E5E5">mobiles and</font><font color="#CCCCCC"> Windows applications and we</font>

383
00:19:48,480 --> 00:19:52,470
found<font color="#E5E5E5"> that both application uses</font>

384
00:19:50,669 --> 00:19:55,050
something that is<font color="#CCCCCC"> killed is called QT</font>

385
00:19:52,470 --> 00:19:57,270
single app that this is<font color="#E5E5E5"> probably for</font>

386
00:19:55,050 --> 00:19:58,000
making sure that<font color="#CCCCCC"> there is</font><font color="#E5E5E5"> only one</font>

387
00:19:57,270 --> 00:20:01,510
instance

388
00:19:58,000 --> 00:20:03,370
of this application<font color="#CCCCCC"> running</font><font color="#E5E5E5"> and we fast</font>

389
00:20:01,510 --> 00:20:06,100
it<font color="#E5E5E5"> using the script I</font><font color="#CCCCCC"> was showing you</font>

390
00:20:03,370 --> 00:20:09,610
and then we managed to remotely crush

391
00:20:06,100 --> 00:20:11,949
the program and in Cuba torrent<font color="#E5E5E5"> there is</font>

392
00:20:09,610 --> 00:20:18,429
also a possibility<font color="#E5E5E5"> of remote command</font>

393
00:20:11,950 --> 00:20:25,470
injection<font color="#E5E5E5"> so let's see a live demo I'm</font>

394
00:20:18,430 --> 00:20:25,470
now silently praying to the Democrats<font color="#E5E5E5"> so</font>

395
00:20:28,110 --> 00:20:38,979
so this<font color="#CCCCCC"> is my virtual machine you can</font>

396
00:20:33,250 --> 00:20:49,560
see that this is my IP address and now

397
00:20:38,980 --> 00:20:52,510
I'm going<font color="#E5E5E5"> to activate Cuba torrent and</font>

398
00:20:49,560 --> 00:20:57,460
after<font color="#E5E5E5"> activating Cuba torrent</font><font color="#CCCCCC"> you can</font>

399
00:20:52,510 --> 00:21:01,480
see that I have this<font color="#CCCCCC"> name 5qt</font><font color="#E5E5E5"> single app</font>

400
00:20:57,460 --> 00:21:05,020
qubit<font color="#E5E5E5"> oh and some something</font><font color="#CCCCCC"> that looks</font>

401
00:21:01,480 --> 00:21:07,720
<font color="#E5E5E5">like a random</font><font color="#CCCCCC"> number</font><font color="#E5E5E5"> so this is the name</font>

402
00:21:05,020 --> 00:21:13,389
type that I'm going to remotely connect

403
00:21:07,720 --> 00:21:17,890
to and I'm going<font color="#E5E5E5"> to to do it using</font><font color="#CCCCCC"> io</font>

404
00:21:13,390 --> 00:21:21,400
ninja so here I will<font color="#E5E5E5"> create a file</font>

405
00:21:17,890 --> 00:21:23,860
stream that allows you to<font color="#E5E5E5"> connect to</font>

406
00:21:21,400 --> 00:21:25,570
name pipes<font color="#E5E5E5"> the name is a little</font><font color="#CCCCCC"> bit a</font>

407
00:21:23,860 --> 00:21:28,570
little bit a little<font color="#E5E5E5"> bit confusing but</font>

408
00:21:25,570 --> 00:21:32,169
this is<font color="#E5E5E5"> actually used for name pipes so</font>

409
00:21:28,570 --> 00:21:35,500
here you<font color="#E5E5E5"> can see that I put putting</font><font color="#CCCCCC"> the</font>

410
00:21:32,170 --> 00:21:38,440
IP address of<font color="#E5E5E5"> the machine</font><font color="#CCCCCC"> and a pipe</font>

411
00:21:35,500 --> 00:21:41,080
<font color="#E5E5E5">slash pipe name and this specific name</font>

412
00:21:38,440 --> 00:21:43,300
pipe<font color="#E5E5E5"> you need the general domain</font>

413
00:21:41,080 --> 00:21:45,429
<font color="#E5E5E5">permission so you need to be a member of</font>

414
00:21:43,300 --> 00:21:47,020
<font color="#E5E5E5">the domain but this is pretty</font><font color="#CCCCCC"> much it if</font>

415
00:21:45,430 --> 00:21:49,780
you have domain<font color="#E5E5E5"> permissions you can</font>

416
00:21:47,020 --> 00:21:54,460
<font color="#E5E5E5">connect to it</font><font color="#CCCCCC"> and you can see that once</font>

417
00:21:49,780 --> 00:21:58,620
I connect<font color="#CCCCCC"> to it if I just</font><font color="#E5E5E5"> send a single</font>

418
00:21:54,460 --> 00:22:03,420
character when I<font color="#E5E5E5"> get back to the machine</font>

419
00:21:58,620 --> 00:22:03,419
<font color="#E5E5E5">the program is not responding</font>

420
00:22:05,850 --> 00:22:15,280
and thank the same thing goes for<font color="#E5E5E5"> sugar</font>

421
00:22:09,490 --> 00:22:17,530
<font color="#CCCCCC">same sink</font><font color="#E5E5E5"> let's do it once again this</font>

422
00:22:15,280 --> 00:22:21,928
<font color="#E5E5E5">time I'm</font><font color="#CCCCCC"> going to</font><font color="#E5E5E5"> show it to</font><font color="#CCCCCC"> show you</font>

423
00:22:17,530 --> 00:22:21,928
how this<font color="#E5E5E5"> can be</font><font color="#CCCCCC"> done using fading</font>

424
00:22:35,900 --> 00:22:49,190
you need internet<font color="#CCCCCC"> connection for</font><font color="#E5E5E5"> this</font>

425
00:22:39,350 --> 00:22:49,189
obviously a cloud service<font color="#CCCCCC"> okay</font>

426
00:22:50,840 --> 00:23:02,669
demo<font color="#E5E5E5"> code almost</font><font color="#CCCCCC"> had me</font><font color="#E5E5E5"> so here is named</font>

427
00:22:56,910 --> 00:23:06,540
pipes<font color="#E5E5E5"> of</font><font color="#CCCCCC"> sugar sink and now I'm</font><font color="#E5E5E5"> going to</font>

428
00:23:02,670 --> 00:23:08,930
activate this advanced utility just<font color="#E5E5E5"> a</font>

429
00:23:06,540 --> 00:23:08,930
second

430
00:23:27,530 --> 00:23:34,040
so I'm putting<font color="#E5E5E5"> the same IP address slash</font>

431
00:23:30,870 --> 00:23:37,110
pipe slash<font color="#CCCCCC"> this time the SugarSync pipe</font>

432
00:23:34,040 --> 00:23:40,730
and you can see that<font color="#CCCCCC"> only</font><font color="#E5E5E5"> after two</font>

433
00:23:37,110 --> 00:23:48,360
iterations<font color="#E5E5E5"> two iterations only and</font>

434
00:23:40,730 --> 00:23:51,570
program is crushed<font color="#E5E5E5"> and the last</font>

435
00:23:48,360 --> 00:23:55,979
interesting<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> that we</font><font color="#E5E5E5"> found is that</font>

436
00:23:51,570 --> 00:23:58,168
we can actually try to<font color="#CCCCCC"> inject commands</font>

437
00:23:55,980 --> 00:24:00,600
to the<font color="#E5E5E5"> BitTorrent named pipes directly</font>

438
00:23:58,169 --> 00:24:06,290
<font color="#E5E5E5">connect to it once</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> but instead</font><font color="#CCCCCC"> of</font>

439
00:24:00,600 --> 00:24:06,290
a<font color="#E5E5E5"> single character now I'm going to put</font>

440
00:24:06,470 --> 00:24:19,400
<font color="#CCCCCC">ego</font><font color="#E5E5E5"> hacking Paris 17</font><font color="#CCCCCC"> two words / space</font>

441
00:24:12,660 --> 00:24:22,370
<font color="#E5E5E5">and I'm going to send it torrent file</font>

442
00:24:19,400 --> 00:24:25,440
hacking Paris 17 does not exist<font color="#E5E5E5"> so</font>

443
00:24:22,370 --> 00:24:29,610
<font color="#CCCCCC">actually you can</font><font color="#E5E5E5"> you can see that my</font>

444
00:24:25,440 --> 00:24:33,710
input is processed and<font color="#E5E5E5"> in this example</font>

445
00:24:29,610 --> 00:24:36,689
you<font color="#CCCCCC"> can see that I can try to remotely</font>

446
00:24:33,710 --> 00:24:39,299
inject<font color="#E5E5E5"> the download command to</font><font color="#CCCCCC"> this</font>

447
00:24:36,690 --> 00:24:42,320
<font color="#CCCCCC">queue</font><font color="#E5E5E5"> a cute BitTorrent client</font><font color="#CCCCCC"> I can</font>

448
00:24:39,299 --> 00:24:44,549
tell him which<font color="#E5E5E5"> turned to go and download</font>

449
00:24:42,320 --> 00:24:47,330
<font color="#E5E5E5">so this is becoming even more</font>

450
00:24:44,549 --> 00:24:47,330
interesting

451
00:24:56,659 --> 00:25:04,409
so let's move on to<font color="#CCCCCC"> the mitigation and</font>

452
00:25:00,419 --> 00:25:07,770
<font color="#E5E5E5">defenses</font><font color="#CCCCCC"> so the developers point of view</font>

453
00:25:04,409 --> 00:25:10,710
<font color="#E5E5E5">just know the risk if you use open</font>

454
00:25:07,770 --> 00:25:15,110
<font color="#E5E5E5">source frameworks or like</font><font color="#CCCCCC"> Qt framework</font>

455
00:25:10,710 --> 00:25:17,429
<font color="#E5E5E5">or others</font><font color="#CCCCCC"> if you use name pipes</font><font color="#E5E5E5"> in your</font>

456
00:25:15,110 --> 00:25:19,500
application<font color="#E5E5E5"> windows application just</font>

457
00:25:17,429 --> 00:25:22,260
<font color="#E5E5E5">know that name pipes can become</font>

458
00:25:19,500 --> 00:25:25,559
connected<font color="#CCCCCC"> remotely and don't treat it</font><font color="#E5E5E5"> as</font>

459
00:25:22,260 --> 00:25:28,408
an<font color="#E5E5E5"> internal only interface and neglect</font>

460
00:25:25,559 --> 00:25:29,820
security always<font color="#E5E5E5"> follow</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> lead</font>

461
00:25:28,409 --> 00:25:31,400
<font color="#E5E5E5">privilege approach and assign</font>

462
00:25:29,820 --> 00:25:33,928
appropriate<font color="#E5E5E5"> ACLs</font>

463
00:25:31,400 --> 00:25:36,570
never just open the name pipe

464
00:25:33,929 --> 00:25:39,450
anonymously<font color="#E5E5E5"> and to everyone to connect</font>

465
00:25:36,570 --> 00:25:41,610
to and<font color="#E5E5E5"> possibly if possible just limit</font>

466
00:25:39,450 --> 00:25:44,429
the<font color="#E5E5E5"> maximum number of instances as</font><font color="#CCCCCC"> well</font>

467
00:25:41,610 --> 00:25:46,289
if you only need one instance for

468
00:25:44,429 --> 00:25:47,490
<font color="#CCCCCC">example you need one process of your</font>

469
00:25:46,289 --> 00:25:51,110
application<font color="#CCCCCC"> to connect to another</font>

470
00:25:47,490 --> 00:25:53,970
process just put one maximum instance

471
00:25:51,110 --> 00:25:56,399
the users or third-party<font color="#E5E5E5"> software</font>

472
00:25:53,970 --> 00:25:59,100
clients<font color="#E5E5E5"> point of view also know the risk</font>

473
00:25:56,400 --> 00:26:02,280
<font color="#CCCCCC">block all unnecessary SMB and RPC</font>

474
00:25:59,100 --> 00:26:05,340
services if<font color="#E5E5E5"> you don't need it just block</font>

475
00:26:02,280 --> 00:26:07,200
it<font color="#E5E5E5"> segment your network so at least if</font>

476
00:26:05,340 --> 00:26:10,820
you cannot connect<font color="#E5E5E5"> to each and every</font>

477
00:26:07,200 --> 00:26:13,559
station in your network and<font color="#E5E5E5"> try</font><font color="#CCCCCC"> to</font>

478
00:26:10,820 --> 00:26:15,720
exploit vulnerabilities in<font color="#CCCCCC"> 9/5 and</font>

479
00:26:13,559 --> 00:26:20,030
always install latest software<font color="#CCCCCC"> security</font>

480
00:26:15,720 --> 00:26:24,840
updates the hackers point of view<font color="#CCCCCC"> will</font>

481
00:26:20,030 --> 00:26:28,678
hack have fun this<font color="#E5E5E5"> is something that</font><font color="#CCCCCC"> is</font>

482
00:26:24,840 --> 00:26:30,178
largely unexplored<font color="#E5E5E5"> so try to perform</font>

483
00:26:28,679 --> 00:26:35,669
remote<font color="#E5E5E5"> code execution in denial of</font>

484
00:26:30,179 --> 00:26:37,799
service in multiple interfaces so to sum

485
00:26:35,669 --> 00:26:39,870
up<font color="#CCCCCC"> my presentation Windows named pipes</font>

486
00:26:37,799 --> 00:26:42,860
are forgotten<font color="#E5E5E5"> remotely accessible</font>

487
00:26:39,870 --> 00:26:45,330
sockets like in the face a whole new<font color="#CCCCCC"> Lee</font>

488
00:26:42,860 --> 00:26:47,189
<font color="#CCCCCC">rediscovered potential world of</font><font color="#E5E5E5"> local</font>

489
00:26:45,330 --> 00:26:49,320
and remote vulnerabilities because no

490
00:26:47,190 --> 00:26:51,330
one just knows<font color="#CCCCCC"> that there</font><font color="#E5E5E5"> exists and if</font>

491
00:26:49,320 --> 00:26:53,879
you do know it you<font color="#E5E5E5"> don't care because</font>

492
00:26:51,330 --> 00:26:55,770
you<font color="#E5E5E5"> thought that is local only so don't</font>

493
00:26:53,880 --> 00:26:59,780
<font color="#E5E5E5">ignore name pipes in your Windows</font>

494
00:26:55,770 --> 00:27:03,139
desktop application<font color="#E5E5E5"> and stay safe you</font>

495
00:26:59,780 --> 00:27:05,200
<font color="#CCCCCC">have</font><font color="#E5E5E5"> any questions</font>

496
00:27:03,140 --> 00:27:05,200
<font color="#E5E5E5">you</font>

