1
00:00:00,010 --> 00:00:03,330
is becoming our presentation is plunder
pillage

2
00:00:03,330 --> 00:00:06,549
imprint the art luxury leveraging

3
00:00:06,549 --> 00:00:11,000
multi-function printers tree a
penetration test my name is Pete

4
00:00:11,000 --> 00:00:14,910
there'll we work at rapid7 and ya
penetration team

5
00:00:14,910 --> 00:00:18,539
where we do pen test they were from one
application to network

6
00:00:18,539 --> 00:00:22,100
I sell penetration tests we work
together for the last four or five years

7
00:00:22,100 --> 00:00:22,939
or so

8
00:00:22,939 --> 00:00:27,390
the agenda for talk is first win

9
00:00:27,390 --> 00:00:31,000
discuss the multi printer attack vector
kinda

10
00:00:31,000 --> 00:00:34,700
what it is why we chose it will give
examples of the attacks

11
00:00:34,700 --> 00:00:38,790
along with power on me these attacks and
then we'll wrap up with how we can

12
00:00:38,790 --> 00:00:40,260
reduce the risk of these attacks

13
00:00:40,260 --> 00:00:43,590
my hand it over to deal here to talk
about why we chose multi-function

14
00:00:43,590 --> 00:00:44,129
printers

15
00:00:44,129 --> 00:00:47,930
things be so a couple quick questions

16
00:00:47,930 --> 00:00:51,190
how many people in here or actual
printers

17
00:00:51,190 --> 00:00:54,640
security okay so how many people here

18
00:00:54,640 --> 00:00:58,570
protect networks responsible protect you
networks

19
00:00:58,570 --> 00:01:02,160
good so we're gonna give you up to this
is we're going to get the pen testers

20
00:01:02,160 --> 00:01:03,690
really show you how

21
00:01:03,690 --> 00:01:07,170
to extract data from multifunction
printers that should be able to give you

22
00:01:07,170 --> 00:01:08,119
access

23
00:01:08,119 --> 00:01:11,900
to Active Directory that seems to be the
predominant

24
00:01:11,900 --> 00:01:15,710
environment we gain access using these
attack methods

25
00:01:15,710 --> 00:01:19,000
in for those who actually does working
on

26
00:01:19,000 --> 00:01:23,420
protecting their environments we would
give the information to stop us

27
00:01:23,420 --> 00:01:29,070
from doing these evil things your
network so what is this all about what

28
00:01:29,070 --> 00:01:29,590
is

29
00:01:29,590 --> 00:01:34,299
what are we trying to accomplish your
start with what we're after is

30
00:01:34,299 --> 00:01:37,810
user names passwords

31
00:01:37,810 --> 00:01:40,850
in a course purpose that is to gain show

32
00:01:40,850 --> 00:01:44,899
is it that were open testers one right
to show

33
00:01:44,899 --> 00:01:48,560
yeah that's what we want is what we live
for long and show we're like not happy

34
00:01:48,560 --> 00:01:53,759
so we're after shell so let's go ahead
look it is a little bit

35
00:01:53,759 --> 00:01:58,869
from a historical standpoint so maybe
started doing is back in 2010

36
00:01:58,869 --> 00:02:03,009
developing these methods these attacked
actors to start leveraging

37
00:02:03,009 --> 00:02:06,180
as part of her job back then

38
00:02:06,180 --> 00:02:11,069
we were able to gain access
approximately 10 to 15 person the time

39
00:02:11,069 --> 00:02:12,940
when I mean access we were able to

40
00:02:12,940 --> 00:02:17,190
extract user names and passwords
multifunction printers

41
00:02:17,190 --> 00:02:20,870
that we used to gain access to Active
Directory environments

42
00:02:20,870 --> 00:02:24,580
seles jump or 2014

43
00:02:24,580 --> 00:02:29,540
change the law now this attack vector
works forty

44
00:02:29,540 --> 00:02:33,090
250 persons time so why does it work for
you

45
00:02:33,090 --> 00:02:36,540
the person the time so company goes out
there by

46
00:02:36,540 --> 00:02:39,650
himself a multifunction printer
inexpensive you know aid

47
00:02:39,650 --> 00:02:43,230
ten twelve thousand dollars even some
the Xerox ColorQube

48
00:02:43,230 --> 00:02:47,760
run upwards of twenty thousand dollars
in back in 2010

49
00:02:47,760 --> 00:02:51,489
companies were doing this and they were
used in the print with they were using

50
00:02:51,489 --> 00:02:51,890
all

51
00:02:51,890 --> 00:02:56,480
added functionality and features exist
on these multifunction printers

52
00:02:56,480 --> 00:02:59,830
those days is changed 2014

53
00:02:59,830 --> 00:03:03,420
customer companies are actually
leveraging the features and functions on

54
00:03:03,420 --> 00:03:04,250
these printers

55
00:03:04,250 --> 00:03:09,110
to to that level ther integrating all
these different functions

56
00:03:09,110 --> 00:03:12,700
the problem is they have an action
change the security

57
00:03:12,700 --> 00:03:16,120
so since the Securities never change now

58
00:03:16,120 --> 00:03:20,569
were able to you levered integrating
these into their business environment to

59
00:03:20,569 --> 00:03:22,060
extract his credentials

60
00:03:22,060 --> 00:03:26,769
forty to 50 person the time so why
multifunction printer

61
00:03:26,769 --> 00:03:30,269
house is possible well multifunction
printers contains interesting

62
00:03:30,269 --> 00:03:31,500
information

63
00:03:31,500 --> 00:03:34,549
an example the continues in the
information

64
00:03:34,549 --> 00:03:37,849
so if you look at color printers they
have a law collar law

65
00:03:37,849 --> 00:03:41,849
this is typically used for chargebacks
functionalities if

66
00:03:41,849 --> 00:03:45,830
if department will be charged back for
the usage of color so they contain any

67
00:03:45,830 --> 00:03:46,659
information

68
00:03:46,659 --> 00:03:50,690
we also have this function is called ski
in the email your plea wats up to

69
00:03:50,690 --> 00:03:52,140
multifunction printer now

70
00:03:52,140 --> 00:03:56,220
he can actually log on the multifunction
printer keeping himself then

71
00:03:56,220 --> 00:04:00,010
indian dude skin job and send it to the
email because that

72
00:04:00,010 --> 00:04:03,510
these devices have to be able to
integrate your email systems

73
00:04:03,510 --> 00:04:06,870
what about skin the power function now
same

74
00:04:06,870 --> 00:04:11,150
use once even copy or something he can
stand alone as Bernard

75
00:04:11,150 --> 00:04:14,540
have received his laptop his desktop

76
00:04:14,540 --> 00:04:20,269
a file server those type of services in
a course for him to any case itself to

77
00:04:20,269 --> 00:04:21,250
these devices

78
00:04:21,250 --> 00:04:25,620
these devices must be able to integrate
with update Sorkin

79
00:04:25,620 --> 00:04:30,310
el DEP informations to contain on your
in the course last ones were more

80
00:04:30,310 --> 00:04:31,030
aggressive

81
00:04:31,030 --> 00:04:35,259
remote firmware upgrades there's been a
lot of fines or less

82
00:04:35,259 --> 00:04:39,240
number years up attacks the in the
firmware upgrades really talking about

83
00:04:39,240 --> 00:04:40,190
that also

84
00:04:40,190 --> 00:04:44,080
so at this point

85
00:04:44,080 --> 00:04:47,550
you know it's kinda game over we're
gonna gave axes

86
00:04:47,550 --> 00:04:51,639
devices were extracted and hopefully
we're gonna show you how to do that

87
00:04:51,639 --> 00:04:55,100
so moving from here return is a repeat
he's going to talk to you about

88
00:04:55,100 --> 00:04:56,990
plundering printers

89
00:04:56,990 --> 00:05:02,090
think they're so plunder what we plan to
add a printer what type of information

90
00:05:02,090 --> 00:05:06,979
can we gather that would help us on an
assessment looking kinda plan user data

91
00:05:06,979 --> 00:05:11,820
information we're looking for usernames
applications that users may be using

92
00:05:11,820 --> 00:05:15,610
along with the host names that maybe
ombre

93
00:05:15,610 --> 00:05:19,940
given up by the printer some examples

94
00:05:19,940 --> 00:05:24,060
Dell printers you later you know give up
user names application hostnames all

95
00:05:24,060 --> 00:05:24,610
these

96
00:05:24,610 --> 00:05:28,580
can become very valuable to us during
the assessment iraq's

97
00:05:28,580 --> 00:05:31,889
HP devices just give you the application
user names

98
00:05:31,889 --> 00:05:35,960
let's take a look at a couple these
examples for example here

99
00:05:35,960 --> 00:05:40,310
is over del printer the first column the
jobname

100
00:05:40,310 --> 00:05:43,199
give us a good indication when
applications users may be running an

101
00:05:43,199 --> 00:05:44,190
environment

102
00:05:44,190 --> 00:05:47,699
here we see the first was microsoft also
a commitment in a memo

103
00:05:47,699 --> 00:05:50,919
the second one is is kinda very
intriguing when they give this some good

104
00:05:50,919 --> 00:05:52,860
information about the operating system

105
00:05:52,860 --> 00:05:56,680
we can see with the user's path is
anybody know what operating system uses

106
00:05:56,680 --> 00:05:57,580
the user's

107
00:05:57,580 --> 00:06:01,840
per pack yet windows 7 higher

108
00:06:01,840 --> 00:06:06,520
at least 107 higher now we can target
attacks against an environment where we

109
00:06:06,520 --> 00:06:07,669
know they're using

110
00:06:07,669 --> 00:06:11,710
office products such as Outlook and Word
we can also target

111
00:06:11,710 --> 00:06:15,729
the operating system which is Windows
seven

112
00:06:15,729 --> 00:06:20,199
now we look over at the or the column we
can see the user name here

113
00:06:20,199 --> 00:06:23,819
not only do we have 3 valid users that
we may be able used to

114
00:06:23,819 --> 00:06:27,900
for brute force attack we also see the
name structure that these to create a

115
00:06:27,900 --> 00:06:28,840
user names

116
00:06:28,840 --> 00:06:31,870
this case we see the first name for the
first initial the first name

117
00:06:31,870 --> 00:06:35,870
followed by the last name now we can do
is differences take

118
00:06:35,870 --> 00:06:39,470
the top 100 first names in the top 1000
last names and all the list that would

119
00:06:39,470 --> 00:06:40,130
be

120
00:06:40,130 --> 00:06:43,729
we can I use to attack after directly to
see if there's any weak passwords such

121
00:06:43,729 --> 00:06:45,810
as seen on summer 2014 your

122
00:06:45,810 --> 00:06:49,509
or something to that effect so another
key bid information that we can gather

123
00:06:49,509 --> 00:06:50,509
to help us

124
00:06:50,509 --> 00:06:55,120
attacking environment the last column
here's the hostname

125
00:06:55,120 --> 00:06:57,979
and some organizations they're very
specific with the whole thing to give us

126
00:06:57,979 --> 00:07:00,020
a good idea what that host does

127
00:07:00,020 --> 00:07:04,740
in this case arm the three jobs urs
limited by what looks like a printer

128
00:07:04,740 --> 00:07:08,630
be appearing team azeris are one okay to
prince or so

129
00:07:08,630 --> 00:07:11,770
we can can to get an idea that appeared
again 11 label

130
00:07:11,770 --> 00:07:15,039
third place is based on its
functionality and some cases

131
00:07:15,039 --> 00:07:18,470
we may see horsely on take for instance
the first words as

132
00:07:18,470 --> 00:07:23,020
Embleton dash laptop like is this lady
that this may be a more user

133
00:07:23,020 --> 00:07:27,300
great what mobile users usually do they
have some sort of remote access

134
00:07:27,300 --> 00:07:30,889
to be great for a phishing attack where
we can say he look we have a new VPN

135
00:07:30,889 --> 00:07:32,130
that we're settin up

136
00:07:32,130 --> 00:07:35,250
login here to test it out make sure
everything's great well we have a fake

137
00:07:35,250 --> 00:07:37,840
site this is harvesting those
credentials

138
00:07:37,840 --> 00:07:42,500
so this one basic functional printer
retrieval together a lot information the

139
00:07:42,500 --> 00:07:43,849
whole dinner attacks

140
00:07:43,849 --> 00:07:47,650
or by the way all this is done
anonymously and

141
00:07:47,650 --> 00:07:51,440
usually flight in the radar have any
ideas IPS monitor systems all we're

142
00:07:51,440 --> 00:07:53,550
doing is making a normal SP request

143
00:07:53,550 --> 00:07:57,169
we're not authenticating third night in
feel login attempts to be monitored

144
00:07:57,169 --> 00:08:04,169
all we're doing is a simple web request
looking at this job information

145
00:08:04,190 --> 00:08:07,520
example is other Xerox printer we get
the same text

146
00:08:07,520 --> 00:08:11,930
reformation -2 Hoth so you can see in
this organization a reason Chris reports

147
00:08:11,930 --> 00:08:16,009
again another attack vector we can
leverage on the kinds client-side

148
00:08:16,009 --> 00:08:20,979
we also see you know Microsoft Word lot
organizations use word

149
00:08:20,979 --> 00:08:24,870
use Windows operating systems it gives
us a better idea what they have

150
00:08:24,870 --> 00:08:27,479
environments we can hold in our attacks

151
00:08:27,479 --> 00:08:31,190
and we also get username information in
this case he's in a different format to

152
00:08:31,190 --> 00:08:33,089
use in the first name followed by the

153
00:08:33,089 --> 00:08:37,240
first initial last name we have four
felony counts are the cats mid

154
00:08:37,240 --> 00:08:41,070
attacks against and we also know with
the formatter

155
00:08:41,070 --> 00:08:44,870
using for their usernames weakens create
our own list

156
00:08:44,870 --> 00:08:48,040
traditional brute force attacks

157
00:08:48,040 --> 00:08:51,070
lax is ample I want to cover here's an
HP this is

158
00:08:51,070 --> 00:08:54,800
I'll this example actually comes from
assess and I did where

159
00:08:54,800 --> 00:08:59,529
it was a being institution that had a
pre lockdown environment

160
00:08:59,529 --> 00:09:03,279
what I did end up going through all
their color printers in the Raiders

161
00:09:03,279 --> 00:09:07,220
with all that user me information and
then submit those users using

162
00:09:07,220 --> 00:09:10,630
some basic bad pass for taking a passer
wine

163
00:09:10,630 --> 00:09:13,899
name the season followed by the year and
I was able to gain access to the

164
00:09:13,899 --> 00:09:16,959
Bobby foothold in environments looking
for me

165
00:09:16,959 --> 00:09:20,550
that all the users were part of the
local admin group so once I was able to

166
00:09:20,550 --> 00:09:21,630
get that your car

167
00:09:21,630 --> 00:09:25,170
you know the exit able to access all the
systems and then once I was able to

168
00:09:25,170 --> 00:09:28,000
access all systems it's just a matter of
time before you find that

169
00:09:28,000 --> 00:09:32,350
you know the main talking later on here
or people's domain users login he's many

170
00:09:32,350 --> 00:09:33,240
cast dumpty

171
00:09:33,240 --> 00:09:37,480
clear text password but an HP we see the
same type of things we see the

172
00:09:37,480 --> 00:09:41,410
users use radio here and the format to
using

173
00:09:41,410 --> 00:09:46,089
along with the applications and in this
case PDF stands out to me

174
00:09:46,089 --> 00:09:49,839
likable arm it shows that they're using

175
00:09:49,839 --> 00:09:52,860
either some sort of Acrobat Reader which
is

176
00:09:52,860 --> 00:09:56,290
notorious for remote exploit tax stuff
or they're using

177
00:09:56,290 --> 00:09:59,390
maybe some other third-party Acrobat

178
00:09:59,390 --> 00:10:03,000
or a PDF format really like factor some
which also has

179
00:10:03,000 --> 00:10:06,920
vulnerabilities associated with it so
based on all this information we will

180
00:10:06,920 --> 00:10:09,510
together in a printer we get a pretty
good idea what the environment looks

181
00:10:09,510 --> 00:10:11,630
like to get a good idea of what attacks

182
00:10:11,630 --> 00:10:15,420
are going to have better success rate
another tax

183
00:10:15,420 --> 00:10:18,550
know it's populated how we can pillage
printers on my hands over their own

184
00:10:18,550 --> 00:10:19,829
style

185
00:10:19,829 --> 00:10:23,440
thanks be so pillage now that we've gone
through

186
00:10:23,440 --> 00:10:28,500
basic plundering give we should you more
ways to get username information

187
00:10:28,500 --> 00:10:32,050
application information we can read
about the attacks little bit

188
00:10:32,050 --> 00:10:36,660
Minister do some vicious pillaging which
is always fun

189
00:10:36,660 --> 00:10:39,829
so we'll start off with an address book
attacks

190
00:10:39,829 --> 00:10:44,690
you know extract crude information from
multifunction printer address books

191
00:10:44,690 --> 00:10:47,890
typically multifunction printer address
books

192
00:10:47,890 --> 00:10:52,269
and we all understand they probably
contain what user names

193
00:10:52,269 --> 00:10:56,170
email address and stuff like that but
the one key thing is

194
00:10:56,170 --> 00:10:59,730
they contain passwords there's a number
products that actually will store

195
00:10:59,730 --> 00:11:00,680
passwords

196
00:11:00,680 --> 00:11:04,870
in the actual address books a couple
wouldn't talk about here is a Konica

197
00:11:04,870 --> 00:11:05,990
Minolta

198
00:11:05,990 --> 00:11:09,300
in the Canon imageRUNNER ADVANCE
versions

199
00:11:09,300 --> 00:11:13,399
now course the keenan image runners that

200
00:11:13,399 --> 00:11:17,860
predated is also had a similar problem
so does baseball the cannons

201
00:11:17,860 --> 00:11:21,140
to start off with the key image Canon
imageRUNNER

202
00:11:21,140 --> 00:11:25,950
it turns out these particular device is
the newer in the advanced versions

203
00:11:25,950 --> 00:11:30,670
the only way to get the passwords out a
bit have to tell the printer to do this

204
00:11:30,670 --> 00:11:34,860
there's a special setting up to 100 said
to tell it to give us

205
00:11:34,860 --> 00:11:38,390
the actual passwords also once you store

206
00:11:38,390 --> 00:11:42,680
exporting the password is gonna prompt
you for we start exporting

207
00:11:42,680 --> 00:11:46,870
the address book is gonna prompt you to
actually enter a password in this

208
00:11:46,870 --> 00:11:49,209
morning Creek d

209
00:11:49,209 --> 00:11:53,360
so it's gonna give us the password is
going to be a cryptid

210
00:11:53,360 --> 00:11:57,130
well fortunately for us the way they
designed this

211
00:11:57,130 --> 00:12:01,800
is the heat control that encryption is
at the user's level

212
00:12:01,800 --> 00:12:06,829
so it's more that blows process to make
this request we can alter some settings

213
00:12:06,829 --> 00:12:09,980
that will give us the ability to you
extract passwords

214
00:12:09,980 --> 00:12:14,089
in plain text so let's start with the
first example

215
00:12:14,089 --> 00:12:18,519
as we see here with the key in an
advanced version we have a sitting right

216
00:12:18,519 --> 00:12:21,350
here include passwords when exporting
address books

217
00:12:21,350 --> 00:12:25,630
getting a bill that so we turn that i
won we go ahead and click OK

218
00:12:25,630 --> 00:12:29,160
we move on would you rate extract the
address books

219
00:12:29,160 --> 00:12:33,290
gonna prompt just put a password in
there we're going into this password as

220
00:12:33,290 --> 00:12:34,120
were used

221
00:12:34,120 --> 00:12:37,600
as part of the encryption mechanism
encrypt the password

222
00:12:37,600 --> 00:12:41,700
so we go ahead and start the export in
Ensley were able to dump the address

223
00:12:41,700 --> 00:12:42,310
books

224
00:12:42,310 --> 00:12:45,940
and as you see the passwords in cryptid

225
00:12:45,940 --> 00:12:49,470
this is actually a base64 love the
actual

226
00:12:49,470 --> 00:12:54,360
binary recruited password course is
basically forces be transferred

227
00:12:54,360 --> 00:12:59,880
text file so we step back and go okay
well

228
00:12:59,880 --> 00:13:03,029
this encryption doesn't do me any good
in pursuing

229
00:13:03,029 --> 00:13:06,310
release think that the crypt stuff so

230
00:13:06,310 --> 00:13:10,389
up dug in a little more lookin

231
00:13:10,389 --> 00:13:14,329
so it turns out there in his post
process it has the city

232
00:13:14,329 --> 00:13:18,160
call Ian C mode so what do you think
that means

233
00:13:18,160 --> 00:13:22,579
about encrypt mode so what happens we
change the secret no

234
00:13:22,579 --> 00:13:26,310
0 was realized it gives us what we want

235
00:13:26,310 --> 00:13:30,720
in plain text

236
00:13:30,720 --> 00:13:33,889
and not only that I mean let's take a
look at this

237
00:13:33,889 --> 00:13:38,850
we pound 'em what we have is we have a
system server name

238
00:13:38,850 --> 00:13:42,079
location this year the entire path

239
00:13:42,079 --> 00:13:45,889
the domain name the username in the text

240
00:13:45,889 --> 00:13:50,980
a password in plain text now we're were
actually in the domain as some

241
00:13:50,980 --> 00:13:56,820
level user now this can vary from just
the individual user's account

242
00:13:56,820 --> 00:14:01,529
all the way to something is elevated has
access to a lot of different settings

243
00:14:01,529 --> 00:14:05,740
were in some rare cases may actually be
it to me admin account which

244
00:14:05,740 --> 00:14:09,420
we do encounter a little more frequently
than

245
00:14:09,420 --> 00:14:12,820
what you would expect

246
00:14:12,820 --> 00:14:16,709
let's move on to the next one the Konica
Minolta business case here

247
00:14:16,709 --> 00:14:20,220
we're not really extracting the full
address books were word

248
00:14:20,220 --> 00:14:24,029
extracting certain aspects love that
scene

249
00:14:24,029 --> 00:14:27,529
area data Mr Parsons and I'll better

250
00:14:27,529 --> 00:14:32,000
so here can export the address book or
the information out of the address book

251
00:14:32,000 --> 00:14:34,779
associated with the specific password

252
00:14:34,779 --> 00:14:38,120
in which we found this is kinda
interests if you go into the web

253
00:14:38,120 --> 00:14:39,360
interface on this device

254
00:14:39,360 --> 00:14:42,690
more find anything really useful that we
can extract

255
00:14:42,690 --> 00:14:46,560
one of the guys on the previous team I
was on Jul was playing around with one

256
00:14:46,560 --> 00:14:47,579
of these

257
00:14:47,579 --> 00:14:51,670
anything down down the Konica has some
management tools management applications

258
00:14:51,670 --> 00:14:53,690
that you can download of their site

259
00:14:53,690 --> 00:14:57,670
imagines the manage all other products
and you can plug into those

260
00:14:57,670 --> 00:15:02,560
to manage every different version love
Konica Minolta vice

261
00:15:02,560 --> 00:15:06,930
what he did was reply to this day the
Bourbon captured all the date in San of

262
00:15:06,930 --> 00:15:07,740
to me

263
00:15:07,740 --> 00:15:12,120
and it turns out was doing all this
through so those do so message jeans

264
00:15:12,120 --> 00:15:17,860
making request getting replies back and
it was doing is over Port 50001

265
00:15:17,860 --> 00:15:22,139
fifty thousand three 50,000 3 be in the
SSL

266
00:15:22,139 --> 00:15:28,550
actual ESO por in so let's look at the
SOAP messages associated with this

267
00:15:28,550 --> 00:15:32,540
start by getting my head I'll so we look
at this

268
00:15:32,540 --> 00:15:36,050
message clearly you take this message
right here and play this right against

269
00:15:36,050 --> 00:15:37,540
Konica printers

270
00:15:37,540 --> 00:15:42,050
in what is doing is due in carrying out
an occasion we had the admin

271
00:15:42,050 --> 00:15:47,940
and then the password 1234 5678 which is
common for a large number the models

272
00:15:47,940 --> 00:15:52,240
you what this does it's actually going
to give us was known is a session key

273
00:15:52,240 --> 00:15:57,940
are all key so we sin is off to the
Konica printer port 50001

274
00:15:57,940 --> 00:16:01,110
in replies back with the SOAP response
any guesses

275
00:16:01,110 --> 00:16:04,820
of key which basically is functioning as
a session cookie

276
00:16:04,820 --> 00:16:09,100
for no better terms so we take that

277
00:16:09,100 --> 00:16:13,070
and then we can play that back against
the system with another so message

278
00:16:13,070 --> 00:16:17,779
in this is under operator in Provo and
previous condition

279
00:16:17,779 --> 00:16:21,470
and what we do is we path that of key
back to the device we also want to make

280
00:16:21,470 --> 00:16:24,940
sure our major minor versions are active
because the Seas be

281
00:16:24,940 --> 00:16:28,230
based on the patch level different
printers that does change so we have to

282
00:16:28,230 --> 00:16:28,779
you

283
00:16:28,779 --> 00:16:32,839
get a response back from the printer
make sure we match those up practically

284
00:16:32,839 --> 00:16:36,880
but if we send its ok message of to the
printer its gonna respond back

285
00:16:36,880 --> 00:16:39,970
with this information here in this case
here

286
00:16:39,970 --> 00:16:43,079
it's an SBA so it's amber so windows

287
00:16:43,079 --> 00:16:46,940
connection is the hostname is this the
user

288
00:16:46,940 --> 00:16:50,720
name is this the password in plain text

289
00:16:50,720 --> 00:16:54,699
in the actual folder the information is
termed within this

290
00:16:54,699 --> 00:16:58,380
as so message is going to be SMTP SMTP

291
00:16:58,380 --> 00:17:02,110
for skinny more functionality is being
utilized

292
00:17:02,110 --> 00:17:07,270
SMB a somber in all also FTP service is
so again

293
00:17:07,270 --> 00:17:12,799
we quickly able opponent environment by
just requesting the information

294
00:17:12,799 --> 00:17:16,870
so you see so for the the key indicator
this whole thing

295
00:17:16,870 --> 00:17:20,660
is we haven't really done any serious
issues tacky

296
00:17:20,660 --> 00:17:24,199
we just been nice enough to ask for a
ride

297
00:17:24,199 --> 00:17:28,110
pretty simple you know so if he asks the
printers right

298
00:17:28,110 --> 00:17:31,520
they're nice enough to give you all the
information you need

299
00:17:31,520 --> 00:17:35,020
in what's intercourse get the key
indicators haven't noticed

300
00:17:35,020 --> 00:17:40,320
we have been using default passwords so
that makes be one ask one question here

301
00:17:40,320 --> 00:17:44,590
how many people in here as a requirement
that your business environment before

302
00:17:44,590 --> 00:17:47,950
any multifunction printers deployed into
your environment

303
00:17:47,950 --> 00:17:52,309
that the default factory passwords are
changed

304
00:17:52,309 --> 00:17:56,890
okay that's pretty good everyone look
around look at the hands are

305
00:17:56,890 --> 00:18:00,669
okay that seems to be the bout the right
number you know it's a very small

306
00:18:00,669 --> 00:18:02,760
percentage we're not doing that

307
00:18:02,760 --> 00:18:07,620
in when you don't do that people like us

308
00:18:07,620 --> 00:18:12,250
hopefully it's people like us to be able
to pull this data in your system's

309
00:18:12,250 --> 00:18:15,870
or to be some believe more EMU has more
evil intent

310
00:18:15,870 --> 00:18:19,710
people that day so be thinking about
that movie for when you go to secure

311
00:18:19,710 --> 00:18:20,840
environment

312
00:18:20,840 --> 00:18:24,690
so moving from here I'm gonna turn this
over to pee he's going to talk to you

313
00:18:24,690 --> 00:18:28,870
about it attack we use quite really
known as a pass back attack

314
00:18:28,870 --> 00:18:32,780
so another take that we use to pillage
printers is called up aspect attack

315
00:18:32,780 --> 00:18:37,309
the past back attack does that are
targets authentication services

316
00:18:37,309 --> 00:18:41,090
other printer like there was talking
about we have held that which is used to

317
00:18:41,090 --> 00:18:44,350
sink to know that Sir Paul you letters
and such

318
00:18:44,350 --> 00:18:47,919
we have FTP Windows file sharing

319
00:18:47,919 --> 00:18:52,309
and SMTP let's break down kinda polyp
aspect it works

320
00:18:52,309 --> 00:18:55,750
and how you can use it to get
information we ever

321
00:18:55,750 --> 00:18:59,740
are more multi-function printer here it
set up to authenticate you know that's a

322
00:18:59,740 --> 00:19:03,020
reply email address information

323
00:19:03,020 --> 00:19:06,169
so we have is we have it IP address for
the lesser

324
00:19:06,169 --> 00:19:09,210
we also have credentials
username/password it's able to query the

325
00:19:09,210 --> 00:19:10,100
Active Directory

326
00:19:10,100 --> 00:19:13,690
in this case we use Active Directory to
Corey actor-director

327
00:19:13,690 --> 00:19:17,990
and get users information once the
printer I think it's the other server

328
00:19:17,990 --> 00:19:21,890
the letter that okay get a values email
password here's my data

329
00:19:21,890 --> 00:19:25,950
great Peter populated stuff moves on
does its business

330
00:19:25,950 --> 00:19:30,010
how can we take a ranger this how can we
interceptors credentials and get access

331
00:19:30,010 --> 00:19:33,309
those credentials pretty simple

332
00:19:33,309 --> 00:19:36,380
only did you log into the management
interface

333
00:19:36,380 --> 00:19:40,340
final that sir saying Jan 22 Arceus

334
00:19:40,340 --> 00:19:44,340
then we do is use a printer will search
for this add to see if you can find

335
00:19:44,340 --> 00:19:47,720
email address I can send this document
the paper says alright

336
00:19:47,720 --> 00:19:51,520
was to it then send me the credentials
in clear text

337
00:19:51,520 --> 00:19:55,780
let's walk to the example here on a
xerox device on the reason why

338
00:19:55,780 --> 00:20:00,020
we pic I'll that is because it's the
most common functionality we see

339
00:20:00,020 --> 00:20:00,730
configured

340
00:20:00,730 --> 00:20:04,220
in most environments and usually has a
significant

341
00:20:04,220 --> 00:20:07,789
level up religiously can you use it to
you anne-marie users

342
00:20:07,789 --> 00:20:12,010
and in some cases actually has access to
systems within the organization

343
00:20:12,010 --> 00:20:15,590
the first example you're gonna cover by
Xerox ColorQube

344
00:20:15,590 --> 00:20:18,820
first thing we want to do is login is
admin usually

345
00:20:18,820 --> 00:20:22,530
the four passes for once and if you
can't get that the full path ready for

346
00:20:22,530 --> 00:20:23,659
pastor doesn't work

347
00:20:23,659 --> 00:20:26,820
we get we get a free yes next to you on

348
00:20:26,820 --> 00:20:31,020
change deal that settings we point deal
that's over to us

349
00:20:31,020 --> 00:20:34,169
we set up in a catalyst in our system
and then we issue a search

350
00:20:34,169 --> 00:20:37,640
other user mapping function here the
screenshots

351
00:20:37,640 --> 00:20:41,230
sure we're all these sitting there set
up

352
00:20:41,230 --> 00:20:44,530
I know left here will seal their
figuration

353
00:20:44,530 --> 00:20:47,909
click here you actually feel that's
going any

354
00:20:47,909 --> 00:20:52,870
the elder screen see the IP address this
is what we want to change a point to us

355
00:20:52,870 --> 00:20:56,840
and underneath it hear the crazy want to
get in this case

356
00:20:56,840 --> 00:21:02,200
we can see the user's SPC Xerox really
good label

357
00:21:02,200 --> 00:21:05,929
now we should open a cat listener
machine getting ready to listen for this

358
00:21:05,929 --> 00:21:06,980
connection

359
00:21:06,980 --> 00:21:10,320
what we do is an idiot you met him which
is here

360
00:21:10,320 --> 00:21:13,870
use the search functionality and we say
hey look at these are few the printer

361
00:21:13,870 --> 00:21:14,260
says

362
00:21:14,260 --> 00:21:17,750
K I don't know who that is let me go
find out all he I see this all that

363
00:21:17,750 --> 00:21:19,419
sorry let me go talk to it

364
00:21:19,419 --> 00:21:23,880
and when we see BAM we now get the
username and password sent to us or in

365
00:21:23,880 --> 00:21:25,870
clear text

366
00:21:25,870 --> 00:21:29,220
thank you very much is the real thing
yes nicely activity

367
00:21:29,220 --> 00:21:33,429
and other stuff I mean it's not gonna be
seen it doesn't look like it's malicious

368
00:21:33,429 --> 00:21:36,980
this is normal traffic to happen during
the day no printer is gonna be

369
00:21:36,980 --> 00:21:40,240
talk to know that sir your way we can

370
00:21:40,240 --> 00:21:44,030
kinda find information if we dictate
user observers

371
00:21:44,030 --> 00:21:48,559
this is the only server these picture
should be talking to and such

372
00:21:48,559 --> 00:21:52,270
the next attacker to talk about is on a
shirt device thing Tom

373
00:21:52,270 --> 00:21:56,940
tape attack over attacking the level of
education system

374
00:21:56,940 --> 00:22:00,299
login as administrator user most cases
just am in a min

375
00:22:00,299 --> 00:22:03,940
and like with other is a hands most
people don't change that

376
00:22:03,940 --> 00:22:08,720
we access the lab settings cheesy APA
dah sing in the point to us

377
00:22:08,720 --> 00:22:13,990
separate cat listener an issue it has
connection

378
00:22:13,990 --> 00:22:17,730
what's your login as admin you'll see
this dropped off a ramp

379
00:22:17,730 --> 00:22:20,890
and if you go underneath the system
settings there's an option to access the

380
00:22:20,890 --> 00:22:23,020
internet settings

381
00:22:23,020 --> 00:22:27,500
a deal that settings here's IP address
real that sir

382
00:22:27,500 --> 00:22:31,150
if you noticed the difference between a
sharp and with the HP

383
00:22:31,150 --> 00:22:34,710
or the rocks is that we only have one al
decir

384
00:22:34,710 --> 00:22:38,370
throughout had a backup to lesser
happens as if the first one feels

385
00:22:38,370 --> 00:22:39,110
communicate

386
00:22:39,110 --> 00:22:43,850
pills or a secondary your the trenches
you want to capture

387
00:22:43,850 --> 00:22:48,299
another new feature the shop is this
test connection

388
00:22:48,299 --> 00:22:51,360
so once we execute it s connection it's
in the trenches

389
00:22:51,360 --> 00:22:54,630
the nice thing about the test connection
is it just goes to verify that it can

390
00:22:54,630 --> 00:22:56,200
actually talk to the device

391
00:22:56,200 --> 00:22:59,710
know the changes that we have made are
permanent

392
00:22:59,710 --> 00:23:03,179
doing to make it permanent by clicking
on the submit button down there

393
00:23:03,179 --> 00:23:06,820
and a xerox to get to work we actually
Smith those changes so once

394
00:23:06,820 --> 00:23:11,059
you initiate a pass back taken directly
yet to go back through clean it up with

395
00:23:11,059 --> 00:23:12,159
your IP address in

396
00:23:12,159 --> 00:23:16,650
clean up the tracks so once we hit this
execute what you think should happen

397
00:23:16,650 --> 00:23:19,960
to produce gonna say hey are you doing
you're my credentials

398
00:23:19,960 --> 00:23:23,380
as we see here you get the message id:
and we get the password

399
00:23:23,380 --> 00:23:27,470
the question mark and there'll be I just
actual binary data to get sent along

400
00:23:27,470 --> 00:23:30,049
with the shark

401
00:23:30,049 --> 00:23:33,360
now that we've discussed how to you
pillage

402
00:23:33,360 --> 00:23:37,970
let's talk about how to print XP

403
00:23:37,970 --> 00:23:41,919
so deal with bringing so what we're
talking about here is

404
00:23:41,919 --> 00:23:46,130
I is pretty straightforward you know we
wanted an attack that

405
00:23:46,130 --> 00:23:49,309
course presentations about plunder
pillage imprint so

406
00:23:49,309 --> 00:23:53,130
wonder is evil pillage was evil how can
we make print evil

407
00:23:53,130 --> 00:23:56,360
were goal here is actually be able to
create

408
00:23:56,360 --> 00:24:01,150
for were nowhere purposes a print
function or be able to send something

409
00:24:01,150 --> 00:24:03,140
the port 9100

410
00:24:03,140 --> 00:24:06,360
and Ashley take over the printer

411
00:24:06,360 --> 00:24:09,850
so we're going to do what's known as a
xerox works in true

412
00:24:09,850 --> 00:24:13,270
firmer attack was was kinda been arrests

413
00:24:13,270 --> 00:24:16,400
start of rain here so if you go out to
Xerox

414
00:24:16,400 --> 00:24:20,409
and story goes on in the whole story
what I did

415
00:24:20,409 --> 00:24:25,690
so I would help the Xerox and I
downloaded a firmware package from xerox

416
00:24:25,690 --> 00:24:29,640
if you get a firmware package from xerox
in you open up

417
00:24:29,640 --> 00:24:32,799
you'll see this header starts with XRX
begin goes

418
00:24:32,799 --> 00:24:36,020
XRX and if you remove that

419
00:24:36,020 --> 00:24:39,390
the firmware packages nothing but the
horrible

420
00:24:39,390 --> 00:24:42,470
okay see you can complete and horrible

421
00:24:42,470 --> 00:24:48,919
time so once you want or that you start
looking in there you find some

422
00:24:48,919 --> 00:24:53,799
interesting information the firmware
packages for one thing or

423
00:24:53,799 --> 00:24:58,039
earners dealings dynamically loadable
modules

424
00:24:58,039 --> 00:25:02,270
is dynamically loadable modules

425
00:25:02,270 --> 00:25:06,950
in we open it up strip the header of we
hunt for it

426
00:25:06,950 --> 00:25:10,250
and we find this folder called in C
dealin'

427
00:25:10,250 --> 00:25:13,900
toolkit an insight into

428
00:25:13,900 --> 00:25:17,289
kid he finds me interesting miles about
the deal

429
00:25:17,289 --> 00:25:21,400
maker deal in stripper the stripper
actually stirs

430
00:25:21,400 --> 00:25:25,400
header off and what about key files

431
00:25:25,400 --> 00:25:28,720
so the whole signing process for a deal
with them

432
00:25:28,720 --> 00:25:34,600
dynamically loadable module one large
series Xerox WorkCentre is up in 2008

433
00:25:34,600 --> 00:25:37,740
told them about how I did this was

434
00:25:37,740 --> 00:25:42,400
synchronous keys mister a cig skis
there's no public/private key pair

435
00:25:42,400 --> 00:25:45,419
was a single key and that was used to
you sign

436
00:25:45,419 --> 00:25:48,460
invalidate signatures also

437
00:25:48,460 --> 00:25:52,120
so if we take that deal im

438
00:25:52,120 --> 00:25:56,110
maker in actually run it

439
00:25:56,110 --> 00:26:00,740
we actually get the command structure so
we got so far so

440
00:26:00,740 --> 00:26:04,260
we know Xerox firmwares

441
00:26:04,260 --> 00:26:07,400
use dynamically loadable modules we know

442
00:26:07,400 --> 00:26:11,429
Xerox firm worst contain dealin' maker

443
00:26:11,429 --> 00:26:16,120
in all the signature keys for signee
firmware packages

444
00:26:16,120 --> 00:26:20,210
in also all the instructions to help you
build your own

445
00:26:20,210 --> 00:26:24,710
firmware package so it's pretty
straightforward in pretty

446
00:26:24,710 --> 00:26:28,470
pretty vicious you he can wonder wise
and stuff in there

447
00:26:28,470 --> 00:26:32,940
will one of the key reasons while other
stuff in there is the cloning function

448
00:26:32,940 --> 00:26:36,740
so xerox Printers was known as the
cloning function

449
00:26:36,740 --> 00:26:40,400
cloning punch makes it possible for you
to make a copy of one printers

450
00:26:40,400 --> 00:26:41,510
configuration

451
00:26:41,510 --> 00:26:45,070
take it to another Xerox printer
installed

452
00:26:45,070 --> 00:26:49,620
so you can generate a clone take that
insanity printer port 9100 in election

453
00:26:49,620 --> 00:26:51,179
reconfigure printer so meet

454
00:26:51,179 --> 00:26:55,299
management on a large scale xerox
Printers very easy

455
00:26:55,299 --> 00:26:59,940
the problem was the single sign in
certificate for signing these things

456
00:26:59,940 --> 00:27:04,360
up that was the failure there and that's
where the contains of work as they had

457
00:27:04,360 --> 00:27:06,440
to be able to build a deal

458
00:27:06,440 --> 00:27:10,669
and also extracted doin

459
00:27:10,669 --> 00:27:17,669
so we're going to do is we get a demo

460
00:27:19,350 --> 00:27:26,350
on

461
00:27:29,140 --> 00:27:30,930
so you're a video demo here

462
00:27:30,930 --> 00:27:34,610
be nice it done this live dats not
always doable

463
00:27:34,610 --> 00:27:38,150
I have trouble getting people lemme

464
00:27:38,150 --> 00:27:41,170
fifteen thousand dollar printers wonder
why

465
00:27:41,170 --> 00:27:48,170
so we start here

466
00:27:48,570 --> 00:27:53,290
we got we got several key pieces here we
have the actual printer server log on to

467
00:27:53,290 --> 00:27:54,310
the web console

468
00:27:54,310 --> 00:27:59,400
love a work center 5740 right here
pretty straightforward

469
00:27:59,400 --> 00:28:03,970
so we can see the job coming in we go to
Windows appear we're gonna open up neck

470
00:28:03,970 --> 00:28:05,210
at listener

471
00:28:05,210 --> 00:28:11,430
home port 8686 in the here we're gonna
send your own personal firmware package

472
00:28:11,430 --> 00:28:17,300
over here to port 9100 using netcat is a
redirect import 9100

473
00:28:17,300 --> 00:28:20,360
pauses for second poor

474
00:28:20,360 --> 00:28:24,580
9100 obviously is a standard Jetdirect
printer

475
00:28:24,580 --> 00:28:29,930
port so there's no authentication so we
get we're we're getting multiple

476
00:28:29,930 --> 00:28:30,770
failures here

477
00:28:30,770 --> 00:28:35,200
won a game either for more bill Kidd
they give me the keys to sign your own

478
00:28:35,200 --> 00:28:36,190
firmware

479
00:28:36,190 --> 00:28:39,870
in they gave me away delivered to the
printer without ever happen

480
00:28:39,870 --> 00:28:43,510
syndicate so is definitely total failure
here

481
00:28:43,510 --> 00:28:48,210
another piece information is the
firmware packages when you install

482
00:28:48,210 --> 00:28:51,670
firmware package on a printer what it
does is the entire firmer package

483
00:28:51,670 --> 00:28:55,350
its port 9100 in a validator signature

484
00:28:55,350 --> 00:28:59,800
general exploded off on the printer and
mineral kick off a bootstrap program the

485
00:28:59,800 --> 00:29:02,660
beach trip programs nothing but a shell
script the .se

486
00:29:02,660 --> 00:29:06,890
shell script so we did was we create a
room for more package

487
00:29:06,890 --> 00:29:11,830
with just shell script in this case we
created the firmware package with the

488
00:29:11,830 --> 00:29:12,790
bash shell

489
00:29:12,790 --> 00:29:19,540
in the shell script and as we were able
to you

490
00:29:19,540 --> 00:29:26,160
were route

491
00:29:26,160 --> 00:29:30,670
as you can see were able to gain root
access if we look at the

492
00:29:30,670 --> 00:29:36,890
print job on the actual printer or show
up in shows up as a decomposing printer

493
00:29:36,890 --> 00:29:43,890
print job so that were attached to the
printer

494
00:29:55,570 --> 00:29:59,360
and a couple other interesting things on
here so if we if we look at this data we

495
00:29:59,360 --> 00:30:02,640
can we quickly see what operating system
that the printer is running

496
00:30:02,640 --> 00:30:06,670
in this case it's running Olympics the
2.6

497
00:30:06,670 --> 00:30:10,590
this happens to be run on the power PC
the Linux version happens to be a win

498
00:30:10,590 --> 00:30:12,059
River Linux version

499
00:30:12,059 --> 00:30:17,090
so Freeport the CPU information we can
see in this case that it's a PowerPC

500
00:30:17,090 --> 00:30:24,090
as you see there

501
00:30:24,340 --> 00:30:28,400
the 500 be to PowerPC processor

502
00:30:28,400 --> 00:30:35,390
but the other most critical item here
don't talk about here will stop this is

503
00:30:35,390 --> 00:30:36,320
this comes up

504
00:30:36,320 --> 00:30:39,960
okay this particular for a year

505
00:30:39,960 --> 00:30:44,900
so we look at cat boroff in C can take
secured CFG

506
00:30:44,900 --> 00:30:48,429
so we have this pass back attack which P
talked about

507
00:30:48,429 --> 00:30:53,280
where we can actually yet held absentees
somber settings and stuff just by

508
00:30:53,280 --> 00:30:57,100
telling the printer to connect us versus
normal source

509
00:30:57,100 --> 00:31:00,179
win capture them plain Texans P
mentioned

510
00:31:00,179 --> 00:31:06,820
there is so much change the password so
1111 you know and then 1111 is not

511
00:31:06,820 --> 00:31:08,290
working on the printer

512
00:31:08,290 --> 00:31:12,880
how do we get the password so we come
back to this attack here and now I'm

513
00:31:12,880 --> 00:31:13,410
rude

514
00:31:13,410 --> 00:31:16,900
on the actual printer so it's definitely
failing form

515
00:31:16,900 --> 00:31:19,990
really bad it turns out that

516
00:31:19,990 --> 00:31:24,630
all the other passwords the elder the
somber all the stuff that used to

517
00:31:24,630 --> 00:31:26,160
authenticate the devices

518
00:31:26,160 --> 00:31:30,059
is encrypted in storage and

519
00:31:30,059 --> 00:31:34,320
I haven't had the time or access to be
able to figure out the D Christian

520
00:31:34,320 --> 00:31:38,640
but in this case why should we have to
to the old that works fine

521
00:31:38,640 --> 00:31:42,670
you know we just ask if he gives it to
us plain text we do the past back it s

522
00:31:42,670 --> 00:31:46,000
but there is one password is not encrypt
it

523
00:31:46,000 --> 00:31:50,700
and that is the admin console password
and Adams be store right here

524
00:31:50,700 --> 00:31:54,280
in this file on them on the printer

525
00:31:54,280 --> 00:31:57,450
so we speed this along right here

526
00:31:57,450 --> 00:32:01,170
open up the file and we see right there
it is

527
00:32:01,170 --> 00:32:05,870
in this case Adams be the default but
yet we can paul the plaintext password

528
00:32:05,870 --> 00:32:07,330
for the administrative console

529
00:32:07,330 --> 00:32:12,919
and then we can use the pass back attack
to launch further attacks against the

530
00:32:12,919 --> 00:32:14,210
system to Paul

531
00:32:14,210 --> 00:32:18,590
el DEP cities are some a sentence or
SMTP settings

532
00:32:18,590 --> 00:32:25,590
get today in plain text

533
00:32:35,650 --> 00:32:42,650
K

534
00:32:49,910 --> 00:32:51,920
you

535
00:32:51,920 --> 00:32:55,080
so if you're interested in further
details

536
00:32:55,080 --> 00:32:58,290
on that for more attacked his where you
get away paper

537
00:32:58,290 --> 00:33:01,380
this way people will give you all the
details the

538
00:33:01,380 --> 00:33:05,500
you actually do all this stuff we'll
tell you where you get the right deal

539
00:33:05,500 --> 00:33:10,260
them dealin' download I'll tell you had
extracted

540
00:33:10,260 --> 00:33:13,640
occurs there certain deliverance if you
download

541
00:33:13,640 --> 00:33:18,950
in the system has to be a PowerPC then
you can have that power PC running

542
00:33:18,950 --> 00:33:22,070
good it turns out that there're some

543
00:33:22,070 --> 00:33:25,540
x86-based xeroxed places

544
00:33:25,540 --> 00:33:29,160
they were able to pull down in this code
which is run

545
00:33:29,160 --> 00:33:32,440
bounty system without a proper Debian
system

546
00:33:32,440 --> 00:33:37,470
deal-maker that any problems near the
systems that we validated

547
00:33:37,470 --> 00:33:41,850
I think both these are actually formal
to this attack which is quite a few

548
00:33:41,850 --> 00:33:43,910
other man I haven't tested all along

549
00:33:43,910 --> 00:33:46,910
but the there that's definitely

550
00:33:46,910 --> 00:33:51,190
this the stuff to check out right there
so moving from there

551
00:33:51,190 --> 00:33:54,530
let's go ahead and talk about how we
gonna meet at this is talk about the

552
00:33:54,530 --> 00:33:55,430
prayer to

553
00:33:55,430 --> 00:33:59,700
the Metasploit and what we're coming up
with in the future

554
00:33:59,700 --> 00:34:03,460
4p so just before I switched my there
were two gether

555
00:34:03,460 --> 00:34:06,790
picture that fine they mean it again

556
00:34:06,790 --> 00:34:12,070
awesome another we talked about all
these different ways to

557
00:34:12,070 --> 00:34:15,830
launches attacks as he saw their lot
with manual Sophie Evans

558
00:34:15,830 --> 00:34:20,010
environment with hundreds printers it
does become very time consuming to go

559
00:34:20,010 --> 00:34:21,590
through each printer to try to find

560
00:34:21,590 --> 00:34:25,410
what information or which printer has to
get information you're looking for

561
00:34:25,410 --> 00:34:30,270
those were prayed it was born frida is
an embedded device her thing to what it

562
00:34:30,270 --> 00:34:30,800
does

563
00:34:30,800 --> 00:34:33,850
is it a new rates devices based on a
fingerprint

564
00:34:33,850 --> 00:34:37,410
the fingerprint is based off love a
title page on the web server

565
00:34:37,410 --> 00:34:42,280
the web server type and S&P information
therapy to work

566
00:34:42,280 --> 00:34:46,770
well firstly run your default MS can see
figure out what's in the environment

567
00:34:46,770 --> 00:34:50,950
you take the information is free and the
Prado paid also supports the Center

568
00:34:50,950 --> 00:34:53,600
notation with IP addresses and port and
such

569
00:34:53,600 --> 00:34:58,470
to uproot as the cause of scans network
it's been happening these devices based

570
00:34:58,470 --> 00:35:01,620
on the information as an MP server type

571
00:35:01,620 --> 00:35:07,180
a header fields that a pistol what
defines a major fingerprint

572
00:35:07,180 --> 00:35:11,030
so as an example it's a this is the
takeover HP

573
00:35:11,030 --> 00:35:15,390
desktop printer we know that we can you
braid user names from it

574
00:35:15,390 --> 00:35:19,670
their corresponding modules that have
the way to actually make that

575
00:35:19,670 --> 00:35:20,610
information out

576
00:35:20,610 --> 00:35:24,200
so pretty said looking at the
fingerprint I know is that module

577
00:35:24,200 --> 00:35:27,250
knowledge from this module but starr
getting that information

578
00:35:27,250 --> 00:35:30,490
so goes on gathers information for us be
at the

579
00:35:30,490 --> 00:35:33,760
user names passwords address book
extractions all that the tax

580
00:35:33,760 --> 00:35:37,840
whatever whichever the module says ago
do because it does it

581
00:35:37,840 --> 00:35:40,850
gather that data than larger for us for
future use

582
00:35:40,850 --> 00:35:45,330
so how do we use preyed on assessment as
the real thing

583
00:35:45,330 --> 00:35:50,240
it when the first told everyone the
reason for it is because we have a

584
00:35:50,240 --> 00:35:52,010
pretty darn good success rate with it

585
00:35:52,010 --> 00:35:55,240
we're getting anywhere between nowadays
forty to fifty percent

586
00:35:55,240 --> 00:35:58,810
successful actually get credentials that
he was foothold the environment

587
00:35:58,810 --> 00:36:03,430
reason to harvest the data and get that
football so once we get a foothold

588
00:36:03,430 --> 00:36:06,680
I mean it's part that's the first
problem we always run into his pen test

589
00:36:06,680 --> 00:36:09,430
how do we get to the environment once
you get an environment that is just a

590
00:36:09,430 --> 00:36:11,380
matter of time before we get to the
elevated

591
00:36:11,380 --> 00:36:17,280
credentials so after talking to do for a
while like

592
00:36:17,280 --> 00:36:20,890
what can we do to make create a better
how can we be fed up faster

593
00:36:20,890 --> 00:36:24,840
make it easier for people that were work
with I get more people contribute to it

594
00:36:24,840 --> 00:36:28,830
we started talking about integrating
into medicine wat here some the reasons

595
00:36:28,830 --> 00:36:30,420
why we chose integrated

596
00:36:30,420 --> 00:36:34,780
for smaller its easier to maintain in
minutes played and it left the palace is

597
00:36:34,780 --> 00:36:35,390
a deal with

598
00:36:35,390 --> 00:36:38,200
the current version approved as written
in Perl so there's a lot of times we

599
00:36:38,200 --> 00:36:38,720
have the

600
00:36:38,720 --> 00:36:42,710
install see pan you C payne install
modules sometimes

601
00:36:42,710 --> 00:36:47,110
the models don't work in such arm his
letter dependency issues at

602
00:36:47,110 --> 00:36:50,260
happened sometime between certain things
that are going to verses a Mac

603
00:36:50,260 --> 00:36:54,490
purses Windows all that stuff with mess
with laser deal with

604
00:36:54,490 --> 00:36:57,630
all the required libraries are usually
packaged with Ms plate

605
00:36:57,630 --> 00:37:00,870
we also have the ability to access lot
the Mets body PI's

606
00:37:00,870 --> 00:37:04,320
so other things that are difficult to do
you like ham reading

607
00:37:04,320 --> 00:37:07,450
soap interaction now becomes more easy
air becomes easier

608
00:37:07,450 --> 00:37:10,590
with mostly because they had levels API
functionality that we can use the call

609
00:37:10,590 --> 00:37:11,140
out

610
00:37:11,140 --> 00:37:14,530
another great reason is once we capture
data

611
00:37:14,530 --> 00:37:17,940
we can store within minutes late we
can't look at story into the credit

612
00:37:17,940 --> 00:37:18,760
database or

613
00:37:18,760 --> 00:37:22,600
give this advantage of being able to you
users reporting find out

614
00:37:22,600 --> 00:37:26,460
you know which Chris we have find out
what systems am kicked out the customers

615
00:37:26,460 --> 00:37:27,160
a look

616
00:37:27,160 --> 00:37:30,320
here's our system change a lethal
passage nothing

617
00:37:30,320 --> 00:37:34,270
think the keys is reused those
credentials use it for PSX or some other

618
00:37:34,270 --> 00:37:37,650
former to force against different system
the environment

619
00:37:37,650 --> 00:37:41,030
and one or the other huge tremendously
huge

620
00:37:41,030 --> 00:37:45,360
reasons look at Miss what is the large
screen TVs people like out here

621
00:37:45,360 --> 00:37:50,840
who here hadn't heard a medically okay
with 234 hands

622
00:37:50,840 --> 00:37:53,870
by Hans when the bank up

623
00:37:53,870 --> 00:37:57,060
I mean ever most everybody knows about
us what is most everybody is seen it

624
00:37:57,060 --> 00:37:59,230
used at work with its very simple tool

625
00:37:59,230 --> 00:38:02,360
the framework are mostly pro the gooey
interface

626
00:38:02,360 --> 00:38:06,480
on very easy to use as lot it easier for

627
00:38:06,480 --> 00:38:09,500
the community took to be back printer
models

628
00:38:09,500 --> 00:38:13,370
makes it easy with the API calls went to
see the modules on that we're gonna show

629
00:38:13,370 --> 00:38:14,290
here

630
00:38:14,290 --> 00:38:17,140
it's easy if you take that as a
framework and then add your own Models

631
00:38:17,140 --> 00:38:17,590
Inc

632
00:38:17,590 --> 00:38:21,310
market should be back to the framework

633
00:38:21,310 --> 00:38:24,340
to a deal I did is we created great
display it's the mesh

634
00:38:24,340 --> 00:38:28,080
both prey to ms Bligh we started
developing

635
00:38:28,080 --> 00:38:32,010
be two modules that I at the and the
slide you see I get hungry boy can

636
00:38:32,010 --> 00:38:33,760
download will start esta Mart

637
00:38:33,760 --> 00:38:36,920
on they are in the betas or so going
through some air handling and and some

638
00:38:36,920 --> 00:38:37,850
those checks

639
00:38:37,850 --> 00:38:41,130
apparently we have model that will do
the all that bad pass back attack

640
00:38:41,130 --> 00:38:44,350
on Xerox extract the Canon are the

641
00:38:44,350 --> 00:38:47,570
Konica address book and we also have
models I go through in

642
00:38:47,570 --> 00:38:51,210
enumerate users from Dell and HP devices
in the clinton also

643
00:38:51,210 --> 00:38:55,150
uncanny in total we have about seven
modules that are out there

644
00:38:55,150 --> 00:39:01,080
that will be all ready for use let's
take a look at a couple these modules

645
00:39:01,080 --> 00:39:05,400
first model here's a very simple one
just extract user names other printer

646
00:39:05,400 --> 00:39:09,110
and displays in TN season of the file
this way makes life easy read article

647
00:39:09,110 --> 00:39:10,420
rate these are my hand

648
00:39:10,420 --> 00:39:14,320
you start talon is up and then kept the
files and using those files for a force

649
00:39:14,320 --> 00:39:16,820
attack

650
00:39:16,820 --> 00:39:20,730
next match was the cannon were able to
extract the address book information get

651
00:39:20,730 --> 00:39:21,890
those credentials

652
00:39:21,890 --> 00:39:25,660
here we have these new password in file
share that has access to you

653
00:39:25,660 --> 00:39:28,690
and we also see the entire address book
I'll to file for

654
00:39:28,690 --> 00:39:32,180
any other type of information apply
their accusers

655
00:39:32,180 --> 00:39:35,810
email addresses or anything like that

656
00:39:35,810 --> 00:39:40,070
the kinda go on this is a this was a fun
one

657
00:39:40,070 --> 00:39:43,630
really well so fun as we took I'll have
that soap interaction that you have to

658
00:39:43,630 --> 00:39:46,790
sit there for the way it makes you get a
virgin Drake Passage rake

659
00:39:46,790 --> 00:39:50,090
form the message correctly no it's not
yeah let's not deal with that's what we

660
00:39:50,090 --> 00:39:52,310
did is we automated all it's all in
there so it

661
00:39:52,310 --> 00:39:55,880
able to go in final version numbers
populated correctly

662
00:39:55,880 --> 00:39:58,650
put in whatever passwords be in use
either the default one which is

663
00:39:58,650 --> 00:39:59,450
pre-populated

664
00:39:59,450 --> 00:40:02,890
or another one if you're able to before
said and that makes also

665
00:40:02,890 --> 00:40:08,150
messages for you you have to go through
an right to burp or any other tools

666
00:40:08,150 --> 00:40:11,500
are able to extract information from the
address the address book

667
00:40:11,500 --> 00:40:15,820
3 will get the username the password and
what shares a machine that has access to

668
00:40:15,820 --> 00:40:19,480
me at the Penn tests is tremendous had
this information readily available to me

669
00:40:19,480 --> 00:40:20,140
sir gangster

670
00:40:20,140 --> 00:40:23,260
using the system look what information
early

671
00:40:23,260 --> 00:40:26,680
expose any system is you know FTP server
they have since their formation

672
00:40:26,680 --> 00:40:32,010
can also use a condom other systems in
areas Asian

673
00:40:32,010 --> 00:40:35,520
the last thing you want to talk about is
the one word aerial with

674
00:40:35,520 --> 00:40:39,110
showed up on the screen the firmware
attack we're able to create custom

675
00:40:39,110 --> 00:40:41,150
firmware job because

676
00:40:41,150 --> 00:40:44,410
finds out that password and then let us
know

677
00:40:44,410 --> 00:40:49,290
so we run this job to get the system it
automatically has a packager inside it

678
00:40:49,290 --> 00:40:52,580
because the place in the system searches

679
00:40:52,580 --> 00:40:56,360
that Federation felder pointed out and
pulls out that admin password and gets

680
00:40:56,360 --> 00:40:57,250
to us

681
00:40:57,250 --> 00:41:00,920
now that we have the enhancer device can
go back now and when the Xerox

682
00:41:00,920 --> 00:41:07,220
al Dept module and get those all that
gradually gain access

683
00:41:07,220 --> 00:41:10,770
so what's the future what every gonna do
with greatest player

684
00:41:10,770 --> 00:41:13,910
well obviously we're gonna keep adding
additional models recovered allow the

685
00:41:13,910 --> 00:41:14,800
curb

686
00:41:14,800 --> 00:41:18,670
preteen models over interpreters play
rawson be developing new models as we

687
00:41:18,670 --> 00:41:19,890
see new printers new front

688
00:41:19,890 --> 00:41:23,480
failure we can take advantage of Rihanna
develop those and get those into the

689
00:41:23,480 --> 00:41:27,060
the framework we're gonna take created

690
00:41:27,060 --> 00:41:31,560
at itself kinda strip of summer the
export functionality

691
00:41:31,560 --> 00:41:34,600
and just have it as an embedded device
skeins

692
00:41:34,600 --> 00:41:37,830
engine so it's gonna do is a go through
the whole grain scan for embedded

693
00:41:37,830 --> 00:41:39,360
devices not only printers

694
00:41:39,360 --> 00:41:42,840
but also the devices like f5 devices
that may have

695
00:41:42,840 --> 00:41:46,670
pass from the kids vs S&P or I am

696
00:41:46,670 --> 00:41:51,190
ABC devices other system the very that
may give us additional access

697
00:41:51,190 --> 00:41:54,700
and what we're also looking to do is
have it

698
00:41:54,700 --> 00:41:58,740
set up in a way that has a billy club to
mess with you not having to go through

699
00:41:58,740 --> 00:42:02,020
a text file and say okay need to do
these modules one by one

700
00:42:02,020 --> 00:42:05,690
hopefully will be able to get it is to
the point where

701
00:42:05,690 --> 00:42:08,990
Prater runs find everything inserts
launching all these models for you

702
00:42:08,990 --> 00:42:12,970
said general several minutes or whatever
family where it is

703
00:42:12,970 --> 00:42:18,570
you now have all this information you
can leverage in use

704
00:42:18,570 --> 00:42:22,180
now we've kinda talked about how to go
through and you know pillage

705
00:42:22,180 --> 00:42:25,520
and pony environment get all this
information you know what what can you

706
00:42:25,520 --> 00:42:27,340
guys do to protect environment

707
00:42:27,340 --> 00:42:30,340
what options were Federation settings
with the best way to deal with this

708
00:42:30,340 --> 00:42:36,080
stuff

709
00:42:36,080 --> 00:42:39,910
so we ask yourself are you can about
skews

710
00:42:39,910 --> 00:42:43,590
I think some of the most critical things
we've talked about his past its

711
00:42:43,590 --> 00:42:47,980
we have a number way of getting around
passwords on several different printers

712
00:42:47,980 --> 00:42:51,840
I don't think we mention them all here
obviously the big one is

713
00:42:51,840 --> 00:42:55,350
Xerox use a firmer attack on large
number Xerox

714
00:42:55,350 --> 00:42:59,510
and I know there's a number other firmer
taxes xeroxed some other

715
00:42:59,510 --> 00:43:02,550
printer types they can give you that
level access

716
00:43:02,550 --> 00:43:07,100
this is not the only one here probably
will the big things is

717
00:43:07,100 --> 00:43:12,840
actually disabled for more rates if your
printer allows remote firmware upgrades

718
00:43:12,840 --> 00:43:16,780
disable that function now and then
change the password

719
00:43:16,780 --> 00:43:20,280
those things two things combined
probably security in the case

720
00:43:20,280 --> 00:43:24,150
special xeroxed maybe some other brands
but is was critical

721
00:43:24,150 --> 00:43:27,760
that your default passwords are changed

722
00:43:27,760 --> 00:43:30,840
I've been doing this long enough I
probably got

723
00:43:30,840 --> 00:43:34,090
three quarters over memorize I'm look my
anymore I just

724
00:43:34,090 --> 00:43:37,210
log in your printer steal the date

725
00:43:37,210 --> 00:43:40,500
the other things one look at or patch
management

726
00:43:40,500 --> 00:43:43,880
over the years like is that the peace
been doing this since

727
00:43:43,880 --> 00:43:47,450
2010 and I by and we haven't talked
about

728
00:43:47,450 --> 00:43:51,710
any the vulnerabilities anymore believed
we've discovered probably half dozen

729
00:43:51,710 --> 00:43:53,230
different phone buildings

730
00:43:53,230 --> 00:43:56,400
in various printers that we've leveraged

731
00:43:56,400 --> 00:44:00,290
to steal data some others are actually
built into the two

732
00:44:00,290 --> 00:44:04,900
Prado automatically done in a
steelworker where these two were

733
00:44:04,900 --> 00:44:08,100
I actively disclose stuff to the vendors
in a bit

734
00:44:08,100 --> 00:44:12,330
texted the problem is you have been
patched it

735
00:44:12,330 --> 00:44:17,480
and that's what's going on in also don't
exposed to the internet so many people

736
00:44:17,480 --> 00:44:18,150
exposed

737
00:44:18,150 --> 00:44:23,510
readers to the Internet you'd be amazed
to see how my pretties expose be assured

738
00:44:23,510 --> 00:44:24,090
him

739
00:44:24,090 --> 00:44:27,290
anyone here worked for university

740
00:44:27,290 --> 00:44:31,590
to you exposure printers the United

741
00:44:31,590 --> 00:44:36,040
you may know mint min universities are
horrible

742
00:44:36,040 --> 00:44:39,200
exposing their printers to the Internet

743
00:44:39,200 --> 00:44:44,680
so it's gonna be easy another cool thing
is functional isolationists a big thing

744
00:44:44,680 --> 00:44:46,290
I like to talk to you

745
00:44:46,290 --> 00:44:50,230
customers about if you have
multifunction printers that are used

746
00:44:50,230 --> 00:44:50,590
like

747
00:44:50,590 --> 00:44:55,120
a chore here all let's isolate these

748
00:44:55,120 --> 00:44:58,650
okay because we know what you're
printing on them

749
00:44:58,650 --> 00:45:02,530
we know the kind data and we will talk
about stealing credit as we have talked

750
00:45:02,530 --> 00:45:03,300
about stealing

751
00:45:03,300 --> 00:45:08,950
data so if you have these printers HR
and payroll they should be isolated

752
00:45:08,950 --> 00:45:12,140
so that people that are payroll or

753
00:45:12,140 --> 00:45:17,200
HR authorized cannot get access to the
management consoles in these devices

754
00:45:17,200 --> 00:45:21,970
because there are ways printers the
redirect print jobs the place

755
00:45:21,970 --> 00:45:25,750
so you can log on and set up runners say
hey I want you to sit in this print job

756
00:45:25,750 --> 00:45:26,650
to you

757
00:45:26,650 --> 00:45:31,630
I don't know pick a country raw
attacking each other so

758
00:45:31,630 --> 00:45:35,910
you know French or send it to the US

759
00:45:35,910 --> 00:45:40,080
Chinese Arsenal rush the russians or
send it to the French I'll

760
00:45:40,080 --> 00:45:43,800
those going all over the place but was
actually isolate these

761
00:45:43,800 --> 00:45:48,410
so that stuff doesn't take place

762
00:45:48,410 --> 00:45:51,570
anything else that p on in make sure

763
00:45:51,570 --> 00:45:54,920
if you possible disable them and your
face or

764
00:45:54,920 --> 00:46:01,920
play CL so that only initiators of those
devices can access it

765
00:46:02,590 --> 00:46:06,490
questions so we have any questions here

766
00:46:06,490 --> 00:46:12,580
yessir

767
00:46:12,580 --> 00:46:15,980
with the Xerox heck what is the state
the printer

768
00:46:15,980 --> 00:46:19,970
doing this actually I actually did this
hack

769
00:46:19,970 --> 00:46:23,290
while my companies use your printer De
know I was doing it that's

770
00:46:23,290 --> 00:46:27,070
all the stuff was developed corporate
runner

771
00:46:27,070 --> 00:46:30,570
in the printer keeps working that out
now

772
00:46:30,570 --> 00:46:33,860
if you if you look at actually firmware
package

773
00:46:33,860 --> 00:46:37,390
and you re what xeroxes firmware

774
00:46:37,390 --> 00:46:41,280
block everyone out lock everyone now

775
00:46:41,280 --> 00:46:46,330
and in all 43 booty and nestle for
firmware and then there's one that's

776
00:46:46,330 --> 00:46:46,650
just

777
00:46:46,650 --> 00:46:49,660
patch walk anyone out in

778
00:46:49,660 --> 00:46:53,860
do and then there's there several
versions there isn't a single version

779
00:46:53,860 --> 00:46:57,330
for more the truth is that's all part of
the next unique

780
00:46:57,330 --> 00:47:01,580
where the people get locked up we're not
executing code the basic bootstrap

781
00:47:01,580 --> 00:47:07,680
skip law so just shows up as a print job
sport in the printer and continues run

782
00:47:07,680 --> 00:47:11,410
and the medically model that we
naturally be created all wanted

783
00:47:11,410 --> 00:47:14,820
applies the firmware patch got the
credentials a go through remove their

784
00:47:14,820 --> 00:47:15,690
past so its

785
00:47:15,690 --> 00:47:18,940
just like the printer was before even
touched it

786
00:47:18,940 --> 00:47:23,410
any other questions

787
00:47:23,410 --> 00:47:26,790
lot of the stuff for you mentioned seem
to be like

788
00:47:26,790 --> 00:47:31,560
functionality yet so much for that did
get patched

789
00:47:31,560 --> 00:47:34,790
functionality never dispatched

790
00:47:34,790 --> 00:47:38,350
its functionality now now remember
remember we said

791
00:47:38,350 --> 00:47:42,020
this only works 50 person the time your
the word

792
00:47:42,020 --> 00:47:45,940
to me the worst part is is the company
who's just been

793
00:47:45,940 --> 00:47:49,840
fifteen thousand dollars per prendere in
the only thing they do for his

794
00:47:49,840 --> 00:47:54,900
rent so where you think the biggest
travesty is there

795
00:47:54,900 --> 00:47:58,470
to me that's insane so the whole idea is
a secure the printer so those functions

796
00:47:58,470 --> 00:48:00,330
can be used clearly

797
00:48:00,330 --> 00:48:03,730
in its all they're all the methods are
there to secure these printers

798
00:48:03,730 --> 00:48:08,410
affectively other than my own abilities
if it's a true vulnerability that exist

799
00:48:08,410 --> 00:48:12,760
that's where patrons gonna come in and
we know everything's cool

800
00:48:12,760 --> 00:48:15,090
and there's always going to be more
buildings we don't need to worry of

801
00:48:15,090 --> 00:48:19,270
stuff about that we just need to use the
security that comes with the device

802
00:48:19,270 --> 00:48:22,640
even fall in some other vendors
recommendations for secure and

803
00:48:22,640 --> 00:48:26,920
in the in the device is secure and then
you can use all these massive features

804
00:48:26,920 --> 00:48:32,480
in functions without any major touristic
placement

805
00:48:32,480 --> 00:48:37,500
any other questions

806
00:48:37,500 --> 00:48:40,780
I did you try that acts remotely on

807
00:48:40,780 --> 00:48:44,300
was onside all the Xerox yeah

808
00:48:44,300 --> 00:48:48,960
I've a with Xerox they've actually if I
can get access to

809
00:48:48,960 --> 00:48:52,210
port 9102 matter where the devices

810
00:48:52,210 --> 00:48:57,400
I can get the show back the cool thing
is and I know this is this is doable

811
00:48:57,400 --> 00:49:01,110
I'm done enough research it is possible
to embed this

812
00:49:01,110 --> 00:49:04,400
into potentially bed is into a print job

813
00:49:04,400 --> 00:49:07,700
so someone to take time to develop that
you can't

814
00:49:07,700 --> 00:49:12,550
put into a branch outlets it's a coupon
for a free sandwich at a local sub shop

815
00:49:12,550 --> 00:49:17,710
email it to everyone in the company in
ever who prints into a formal Xerox have

816
00:49:17,710 --> 00:49:18,350
a kicker

817
00:49:18,350 --> 00:49:21,550
show back out over the Internet and
actually headed

818
00:49:21,550 --> 00:49:24,830
I've actually done that actually make
sure he can I get out all but

819
00:49:24,830 --> 00:49:29,400
egress filters you know the printer
wakes up runs the job in of it goes is

820
00:49:29,400 --> 00:49:31,060
going to connect and I've connect back

821
00:49:31,060 --> 00:49:34,370
across the Internet with this before and
I've connected to multi

822
00:49:34,370 --> 00:49:38,580
I've connected to Xerox's there were
exposed to the Internet to retest were

823
00:49:38,580 --> 00:49:40,530
had access to the device

824
00:49:40,530 --> 00:49:44,480
because it poor +91 sanitary kick me
show back and I was

825
00:49:44,480 --> 00:49:51,220
into the internal network through the
Xerox it is doable

826
00:49:51,220 --> 00:49:54,830
cool if there's any other questions are
there and I'll be around all afternoon

827
00:49:54,830 --> 00:50:00,640
excellent he

