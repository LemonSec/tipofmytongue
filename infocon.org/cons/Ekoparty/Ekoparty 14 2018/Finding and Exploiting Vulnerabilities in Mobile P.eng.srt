1
00:00:03,010 --> 00:00:08,710
good morning everybody<font color="#CCCCCC"> it's very dark</font>

2
00:00:06,310 --> 00:00:12,070
and smoky up here on the stage so we

3
00:00:08,710 --> 00:00:14,080
can't<font color="#E5E5E5"> actually see everybody</font><font color="#CCCCCC"> it's a</font>

4
00:00:12,070 --> 00:00:15,429
little bit mysterious<font color="#CCCCCC"> so thank you very</font>

5
00:00:14,080 --> 00:00:17,500
much for getting<font color="#E5E5E5"> up this morning</font><font color="#CCCCCC"> and</font>

6
00:00:15,429 --> 00:00:20,830
coming<font color="#E5E5E5"> to listen to our talk about</font>

7
00:00:17,500 --> 00:00:23,770
mobile<font color="#E5E5E5"> point-of-sale terminals so like</font>

8
00:00:20,830 --> 00:00:26,439
<font color="#E5E5E5">everyone in the audience we interact</font>

9
00:00:23,770 --> 00:00:30,130
<font color="#E5E5E5">with payment technologies every day but</font>

10
00:00:26,440 --> 00:00:32,770
we're<font color="#E5E5E5"> specifically interested in</font><font color="#CCCCCC"> certain</font>

11
00:00:30,130 --> 00:00:34,180
types of my point payment<font color="#CCCCCC"> technologies</font>

12
00:00:32,770 --> 00:00:35,950
so today we're going to be<font color="#CCCCCC"> talking to</font>

13
00:00:34,180 --> 00:00:39,519
you about the vulnerabilities in mobile

14
00:00:35,950 --> 00:00:41,350
point-of-sale terminals so mobile

15
00:00:39,520 --> 00:00:43,540
point-of-sale terminals<font color="#CCCCCC"> has seen a huge</font>

16
00:00:41,350 --> 00:00:45,520
<font color="#CCCCCC">growth</font><font color="#E5E5E5"> over the last few years</font><font color="#CCCCCC"> we've</font>

17
00:00:43,540 --> 00:00:47,710
moved from a single vendor dominating

18
00:00:45,520 --> 00:00:49,120
the<font color="#CCCCCC"> marketplace which</font><font color="#E5E5E5"> is square</font><font color="#CCCCCC"> they</font>

19
00:00:47,710 --> 00:00:51,160
were the first vendors in this

20
00:00:49,120 --> 00:00:54,309
marketplace<font color="#E5E5E5"> and now there's several</font>

21
00:00:51,160 --> 00:00:57,010
<font color="#E5E5E5">different vendors so we've also moved</font>

22
00:00:54,310 --> 00:01:00,370
from a very simplistic device to now

23
00:00:57,010 --> 00:01:02,410
<font color="#E5E5E5">incredibly sophisticated devices you can</font>

24
00:01:00,370 --> 00:01:04,929
get<font color="#E5E5E5"> hold of a card reader for less than</font>

25
00:01:02,410 --> 00:01:08,950
<font color="#E5E5E5">$50 and typically the</font><font color="#CCCCCC"> sign-up process</font>

26
00:01:04,930 --> 00:01:10,929
takes less<font color="#E5E5E5"> than five minutes so for</font>

27
00:01:08,950 --> 00:01:13,619
these reasons these devices have become

28
00:01:10,929 --> 00:01:15,460
incredibly<font color="#E5E5E5"> popular and you can find them</font>

29
00:01:13,619 --> 00:01:17,530
<font color="#E5E5E5">predominantly in places</font><font color="#CCCCCC"> like North</font>

30
00:01:15,460 --> 00:01:19,119
America and in Europe you can<font color="#E5E5E5"> find them</font>

31
00:01:17,530 --> 00:01:23,229
<font color="#CCCCCC">pretty much everywhere so you can</font><font color="#E5E5E5"> see</font>

32
00:01:19,119 --> 00:01:25,270
examples<font color="#E5E5E5"> of taxi and a cafe and that's</font>

33
00:01:23,229 --> 00:01:28,389
also<font color="#CCCCCC"> a gym that I've</font><font color="#E5E5E5"> been to that has a</font>

34
00:01:25,270 --> 00:01:29,920
mobile point-of-sale terminal so for

35
00:01:28,389 --> 00:01:31,749
these reasons they're also very<font color="#CCCCCC"> popular</font>

36
00:01:29,920 --> 00:01:33,759
with criminals both for the testing<font color="#E5E5E5"> of</font>

37
00:01:31,749 --> 00:01:36,969
cards and for the movement of fraudulent

38
00:01:33,759 --> 00:01:38,590
money but we weren't<font color="#E5E5E5"> the</font><font color="#CCCCCC"> first to</font>

39
00:01:36,969 --> 00:01:43,270
<font color="#E5E5E5">investigate mobile point-of-sale</font>

40
00:01:38,590 --> 00:01:45,340
<font color="#E5E5E5">terminals in 2014 researchers from</font><font color="#CCCCCC"> MWR</font>

41
00:01:43,270 --> 00:01:48,369
labs presented their findings<font color="#CCCCCC"> that black</font>

42
00:01:45,340 --> 00:01:50,380
hats<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> Mura shuttle reader</font><font color="#E5E5E5"> so at</font>

43
00:01:48,369 --> 00:01:52,240
the time this reader was being white

44
00:01:50,380 --> 00:01:54,279
labeled and used by a<font color="#CCCCCC"> number of</font>

45
00:01:52,240 --> 00:01:56,529
<font color="#E5E5E5">different vendors</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> this kind of</font>

46
00:01:54,279 --> 00:01:59,590
practice<font color="#CCCCCC"> is still commonplace</font><font color="#E5E5E5"> today in</font>

47
00:01:56,529 --> 00:02:02,408
their presentation they noted a<font color="#CCCCCC"> number</font>

48
00:01:59,590 --> 00:02:04,539
of different vulnerabilities<font color="#E5E5E5"> associated</font>

49
00:02:02,409 --> 00:02:07,689
with the<font color="#CCCCCC"> Mura</font><font color="#E5E5E5"> shuttle reader of which</font>

50
00:02:04,539 --> 00:02:10,720
they shared very many common issues with

51
00:02:07,689 --> 00:02:12,189
traditional<font color="#CCCCCC"> point-of-sale terminals then</font>

52
00:02:10,720 --> 00:02:14,140
in 2015

53
00:02:12,189 --> 00:02:15,730
three undergraduate<font color="#E5E5E5"> students from the</font>

54
00:02:14,140 --> 00:02:18,220
<font color="#CCCCCC">university of boston present</font>

55
00:02:15,730 --> 00:02:20,590
their findings on the square mag stripe

56
00:02:18,220 --> 00:02:22,750
reader<font color="#E5E5E5"> so we felt that both of these</font>

57
00:02:20,590 --> 00:02:24,640
projects were really interesting in

58
00:02:22,750 --> 00:02:26,739
significant contributions to<font color="#E5E5E5"> this area</font>

59
00:02:24,640 --> 00:02:28,750
<font color="#E5E5E5">but we didn't feel</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> they dealt with</font>

60
00:02:26,739 --> 00:02:31,450
<font color="#E5E5E5">the more</font><font color="#CCCCCC"> contemporary issues associated</font>

61
00:02:28,750 --> 00:02:33,610
with<font color="#E5E5E5"> these devices many of</font><font color="#CCCCCC"> these devices</font>

62
00:02:31,450 --> 00:02:36,609
<font color="#E5E5E5">are much more sophisticated than three</font>

63
00:02:33,610 --> 00:02:38,170
years<font color="#E5E5E5"> ago and there's a lot</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> options</font>

64
00:02:36,610 --> 00:02:40,150
in the<font color="#CCCCCC"> marketplace</font><font color="#E5E5E5"> we have many more</font>

65
00:02:38,170 --> 00:02:47,738
<font color="#E5E5E5">more vendors and many different</font><font color="#CCCCCC"> types of</font>

66
00:02:40,150 --> 00:02:49,569
<font color="#E5E5E5">card readers that we can now get at the</font>

67
00:02:47,739 --> 00:02:51,220
beginning<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this project we</font><font color="#CCCCCC"> started</font>

68
00:02:49,569 --> 00:02:54,310
with<font color="#CCCCCC"> just</font><font color="#E5E5E5"> two card readers</font><font color="#CCCCCC"> and two</font>

69
00:02:51,220 --> 00:02:56,530
<font color="#E5E5E5">vendors but this quickly grew into</font><font color="#CCCCCC"> a</font>

70
00:02:54,310 --> 00:02:59,230
large project encompassing seven card

71
00:02:56,530 --> 00:03:04,260
readers for different vendors<font color="#E5E5E5"> and over</font>

72
00:02:59,230 --> 00:03:06,548
two continents so we set out to<font color="#CCCCCC"> look and</font>

73
00:03:04,260 --> 00:03:08,440
assess the most popular devices

74
00:03:06,549 --> 00:03:11,590
<font color="#E5E5E5">initially</font><font color="#CCCCCC"> in Europe and</font><font color="#E5E5E5"> North America</font>

75
00:03:08,440 --> 00:03:15,879
<font color="#CCCCCC">but this is now grown to</font><font color="#E5E5E5"> encompass a few</font>

76
00:03:11,590 --> 00:03:18,910
other areas<font color="#E5E5E5"> as well so we chose to</font>

77
00:03:15,879 --> 00:03:21,370
<font color="#E5E5E5">assess</font><font color="#CCCCCC"> PayPal</font><font color="#E5E5E5"> square eyes at</font><font color="#CCCCCC"> all and</font><font color="#E5E5E5"> sum</font>

78
00:03:18,910 --> 00:03:23,859
up<font color="#E5E5E5"> now some of these providers operate</font>

79
00:03:21,370 --> 00:03:26,590
in<font color="#E5E5E5"> different locations</font><font color="#CCCCCC"> and where</font>

80
00:03:23,859 --> 00:03:28,750
possible<font color="#CCCCCC"> we chose to obtain accounts and</font>

81
00:03:26,590 --> 00:03:31,150
readers in both geographic locations

82
00:03:28,750 --> 00:03:33,190
that's<font color="#E5E5E5"> because there's some significant</font>

83
00:03:31,150 --> 00:03:34,930
differences<font color="#CCCCCC"> between the processes</font><font color="#E5E5E5"> and</font>

84
00:03:33,190 --> 00:03:37,510
applications<font color="#E5E5E5"> depending on the region</font>

85
00:03:34,930 --> 00:03:39,069
<font color="#E5E5E5">that you're operating in at the</font>

86
00:03:37,510 --> 00:03:40,840
<font color="#E5E5E5">beginning of</font><font color="#CCCCCC"> this project we had a</font>

87
00:03:39,069 --> 00:03:42,668
fairly<font color="#E5E5E5"> good idea of the</font><font color="#CCCCCC"> kind of attack</font>

88
00:03:40,840 --> 00:03:44,440
vectors<font color="#E5E5E5"> that these devices will</font>

89
00:03:42,669 --> 00:03:46,480
vulnerable to but we wanted<font color="#E5E5E5"> to</font>

90
00:03:44,440 --> 00:03:49,810
understand how probable these attacks

91
00:03:46,480 --> 00:03:51,940
were in<font color="#E5E5E5"> practice still we kept coming</font>

92
00:03:49,810 --> 00:03:54,519
<font color="#CCCCCC">back</font><font color="#E5E5E5"> to this very simple</font><font color="#CCCCCC"> question</font><font color="#E5E5E5"> which</font>

93
00:03:51,940 --> 00:03:59,500
is how<font color="#E5E5E5"> much security can</font><font color="#CCCCCC"> be embedded</font><font color="#E5E5E5"> in</font>

94
00:03:54,519 --> 00:04:01,419
a device that's effectively free we

95
00:03:59,500 --> 00:04:04,000
chose to assess five different<font color="#E5E5E5"> areas</font><font color="#CCCCCC"> of</font>

96
00:04:01,419 --> 00:04:06,129
the payment ecosystem so the first is

97
00:04:04,000 --> 00:04:07,840
the communication<font color="#CCCCCC"> between the</font><font color="#E5E5E5"> phone</font><font color="#CCCCCC"> and</font>

98
00:04:06,129 --> 00:04:09,879
<font color="#CCCCCC">the payment server</font><font color="#E5E5E5"> then we have</font>

99
00:04:07,840 --> 00:04:11,829
communication<font color="#E5E5E5"> between the device</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> the</font>

100
00:04:09,879 --> 00:04:14,290
phone then we have the mobile

101
00:04:11,829 --> 00:04:17,349
application and<font color="#E5E5E5"> associated mobile</font>

102
00:04:14,290 --> 00:04:19,659
ecosystem<font color="#E5E5E5"> then we have the hardware and</font>

103
00:04:17,349 --> 00:04:21,820
the physical security<font color="#E5E5E5"> mechanisms within</font>

104
00:04:19,660 --> 00:04:23,139
the<font color="#E5E5E5"> hardware itself and then we have an</font>

105
00:04:21,820 --> 00:04:26,050
<font color="#E5E5E5">area that we're calling secondary</font>

106
00:04:23,139 --> 00:04:27,789
factors so this is<font color="#E5E5E5"> different mechanisms</font>

107
00:04:26,050 --> 00:04:29,480
that<font color="#E5E5E5"> occur during the process such as</font>

108
00:04:27,789 --> 00:04:30,890
<font color="#E5E5E5">the anti-fraud mechanisms</font>

109
00:04:29,480 --> 00:04:33,140
<font color="#CCCCCC">all the checks that</font><font color="#E5E5E5"> are carried out</font>

110
00:04:30,890 --> 00:04:35,570
during<font color="#E5E5E5"> the enrollment process and they</font>

111
00:04:33,140 --> 00:04:39,229
affect the<font color="#CCCCCC"> overall security and risk</font><font color="#E5E5E5"> of</font>

112
00:04:35,570 --> 00:04:40,610
the ecosystem but before we progress<font color="#E5E5E5"> any</font>

113
00:04:39,230 --> 00:04:42,560
<font color="#CCCCCC">further I just want to give everyone a</font>

114
00:04:40,610 --> 00:04:44,390
bit of background<font color="#E5E5E5"> as to how payments</font>

115
00:04:42,560 --> 00:04:46,040
traditionally work and how mobile

116
00:04:44,390 --> 00:04:48,770
point-of-sale terminals fit into this

117
00:04:46,040 --> 00:04:51,230
process<font color="#CCCCCC"> so normally when</font><font color="#E5E5E5"> you go to pay</font>

118
00:04:48,770 --> 00:04:53,870
for<font color="#CCCCCC"> something</font><font color="#E5E5E5"> in a shop</font><font color="#CCCCCC"> say services or</font>

119
00:04:51,230 --> 00:04:56,960
<font color="#E5E5E5">goods you're either hand your card</font><font color="#CCCCCC"> over</font>

120
00:04:53,870 --> 00:04:59,690
<font color="#CCCCCC">to the</font><font color="#E5E5E5"> merchant or</font><font color="#CCCCCC"> you're interact with</font>

121
00:04:56,960 --> 00:05:01,940
the terminal yourself directly<font color="#E5E5E5"> so once</font>

122
00:04:59,690 --> 00:05:04,280
your card<font color="#E5E5E5"> information has been read this</font>

123
00:05:01,940 --> 00:05:06,530
will be sent to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> acquiring bank or</font>

124
00:05:04,280 --> 00:05:07,729
that's<font color="#CCCCCC"> merchants</font><font color="#E5E5E5"> but at this point they</font>

125
00:05:06,530 --> 00:05:10,250
don't actually know who you're issuing

126
00:05:07,730 --> 00:05:12,440
<font color="#CCCCCC">bank is so they'll ask the</font><font color="#E5E5E5"> car brands</font>

127
00:05:10,250 --> 00:05:14,690
<font color="#E5E5E5">such as</font><font color="#CCCCCC"> Visa and MasterCard to determine</font>

128
00:05:12,440 --> 00:05:16,640
<font color="#CCCCCC">this information this will be sent</font><font color="#E5E5E5"> to</font>

129
00:05:14,690 --> 00:05:18,680
your issuing<font color="#E5E5E5"> bank and they'll check that</font>

130
00:05:16,640 --> 00:05:20,780
you<font color="#CCCCCC"> have</font><font color="#E5E5E5"> the necessary funds to</font><font color="#CCCCCC"> complete</font>

131
00:05:18,680 --> 00:05:22,100
the<font color="#CCCCCC"> transaction</font><font color="#E5E5E5"> and that</font><font color="#CCCCCC"> they're happy</font>

132
00:05:20,780 --> 00:05:24,770
for<font color="#CCCCCC"> you to</font><font color="#E5E5E5"> go ahead and make the</font>

133
00:05:22,100 --> 00:05:26,420
transaction<font color="#CCCCCC"> so once they have decided</font>

134
00:05:24,770 --> 00:05:28,099
<font color="#E5E5E5">that they're happy for</font><font color="#CCCCCC"> you to do</font><font color="#E5E5E5"> that</font>

135
00:05:26,420 --> 00:05:30,290
<font color="#E5E5E5">they'll send the response back along the</font>

136
00:05:28,100 --> 00:05:33,590
chain and you'll be able to complete the

137
00:05:30,290 --> 00:05:34,970
payment<font color="#E5E5E5"> if we take a look at what this</font>

138
00:05:33,590 --> 00:05:37,130
looks<font color="#E5E5E5"> like for mobile point-of-sale</font>

139
00:05:34,970 --> 00:05:39,200
terminals you can see that the key

140
00:05:37,130 --> 00:05:41,540
difference is that<font color="#CCCCCC"> the</font><font color="#E5E5E5"> merchant no</font>

141
00:05:39,200 --> 00:05:44,300
longer has a direct relationship<font color="#CCCCCC"> with</font>

142
00:05:41,540 --> 00:05:46,790
<font color="#E5E5E5">the acquiring bank instead the mobile</font>

143
00:05:44,300 --> 00:05:49,850
<font color="#CCCCCC">point-of-sale</font><font color="#E5E5E5"> terminal provider acts as</font>

144
00:05:46,790 --> 00:05:52,340
an aggregator<font color="#CCCCCC"> so this means that</font><font color="#E5E5E5"> they</font>

145
00:05:49,850 --> 00:05:54,290
<font color="#CCCCCC">will or won't</font><font color="#E5E5E5"> assess risk at the same</font>

146
00:05:52,340 --> 00:05:56,390
level as a traditional acquiring<font color="#CCCCCC"> bank</font>

147
00:05:54,290 --> 00:05:58,130
<font color="#E5E5E5">and sometimes they choose to mitigate</font>

148
00:05:56,390 --> 00:06:01,370
<font color="#CCCCCC">some of that risk in other ways for</font>

149
00:05:58,130 --> 00:06:03,290
example contractually but it's the key

150
00:06:01,370 --> 00:06:05,690
point is<font color="#CCCCCC"> that here what we have is</font><font color="#E5E5E5"> two</font>

151
00:06:03,290 --> 00:06:07,370
merchants<font color="#E5E5E5"> in this model so the mobile</font>

152
00:06:05,690 --> 00:06:09,590
<font color="#E5E5E5">point-of-sale terminal provider is</font>

153
00:06:07,370 --> 00:06:13,940
themselves<font color="#E5E5E5"> are themselves a merchant as</font>

154
00:06:09,590 --> 00:06:17,419
well next when you<font color="#E5E5E5"> go to make a payment</font>

155
00:06:13,940 --> 00:06:19,310
<font color="#CCCCCC">there are lists which describe the type</font>

156
00:06:17,420 --> 00:06:21,310
<font color="#CCCCCC">of operations that</font><font color="#E5E5E5"> you can actually make</font>

157
00:06:19,310 --> 00:06:24,740
with your card and with the terminal

158
00:06:21,310 --> 00:06:28,730
<font color="#E5E5E5">broadly speaking these go in order of</font>

159
00:06:24,740 --> 00:06:30,680
<font color="#CCCCCC">most</font><font color="#E5E5E5"> secure</font><font color="#CCCCCC"> - least secure so we can</font>

160
00:06:28,730 --> 00:06:32,600
understand generally speaking<font color="#E5E5E5"> that</font>

161
00:06:30,680 --> 00:06:33,830
certain types of payments are more

162
00:06:32,600 --> 00:06:36,440
secure<font color="#CCCCCC"> than others for</font><font color="#E5E5E5"> example</font>

163
00:06:33,830 --> 00:06:38,930
<font color="#CCCCCC">chip-and-pin</font><font color="#E5E5E5"> is considered high in its</font>

164
00:06:36,440 --> 00:06:40,280
level of security<font color="#E5E5E5"> because there's a high</font>

165
00:06:38,930 --> 00:06:42,500
level<font color="#E5E5E5"> of assurance that the cardholder</font>

166
00:06:40,280 --> 00:06:44,239
<font color="#E5E5E5">was present during the transaction</font>

167
00:06:42,500 --> 00:06:46,100
and there's signing of the transaction

168
00:06:44,240 --> 00:06:48,410
so<font color="#CCCCCC"> there's a cryptogram associated with</font>

169
00:06:46,100 --> 00:06:49,970
the transaction<font color="#CCCCCC"> itself if we</font><font color="#E5E5E5"> compare</font>

170
00:06:48,410 --> 00:06:51,950
that<font color="#CCCCCC"> to something like magstripe</font>

171
00:06:49,970 --> 00:06:54,230
this is considered low<font color="#CCCCCC"> very</font><font color="#E5E5E5"> low</font><font color="#CCCCCC"> in its</font>

172
00:06:51,950 --> 00:06:56,150
level of<font color="#CCCCCC"> security and that's because I</font>

173
00:06:54,230 --> 00:06:58,010
<font color="#CCCCCC">think</font><font color="#E5E5E5"> most of us know that</font><font color="#CCCCCC"> the data on</font>

174
00:06:56,150 --> 00:07:00,979
the magnetic<font color="#E5E5E5"> stripe of the card can be</font>

175
00:06:58,010 --> 00:07:02,270
<font color="#E5E5E5">cloned</font><font color="#CCCCCC"> and the thing</font><font color="#E5E5E5"> that provides the</font>

176
00:07:00,980 --> 00:07:04,040
assurance<font color="#E5E5E5"> that the cardholder was</font>

177
00:07:02,270 --> 00:07:05,990
present during the transaction<font color="#CCCCCC"> the</font>

178
00:07:04,040 --> 00:07:07,910
signature can be<font color="#E5E5E5"> forged relatively</font>

179
00:07:05,990 --> 00:07:14,660
easily<font color="#E5E5E5"> and there's no</font><font color="#CCCCCC"> cryptogram sorts</font>

180
00:07:07,910 --> 00:07:17,180
<font color="#E5E5E5">this is not a modern protocol next we</font>

181
00:07:14,660 --> 00:07:19,190
<font color="#CCCCCC">need to understand</font><font color="#E5E5E5"> that while adoption</font>

182
00:07:17,180 --> 00:07:21,050
of<font color="#E5E5E5"> EMV</font><font color="#CCCCCC"> or chip has been incredibly</font>

183
00:07:19,190 --> 00:07:23,390
<font color="#CCCCCC">successful in some areas of</font><font color="#E5E5E5"> the world</font>

184
00:07:21,050 --> 00:07:26,419
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> actually been a bit slower in some</font>

185
00:07:23,390 --> 00:07:27,020
parts so for<font color="#E5E5E5"> example if we look at North</font>

186
00:07:26,419 --> 00:07:28,760
<font color="#E5E5E5">America</font>

187
00:07:27,020 --> 00:07:31,669
<font color="#E5E5E5">actually the</font><font color="#CCCCCC"> rollout of</font><font color="#E5E5E5"> chip has been</font>

188
00:07:28,760 --> 00:07:33,860
<font color="#E5E5E5">incredibly slow and this is in part due</font>

189
00:07:31,669 --> 00:07:35,390
<font color="#CCCCCC">to</font><font color="#E5E5E5"> the number</font><font color="#CCCCCC"> of parties involved in</font><font color="#E5E5E5"> the</font>

190
00:07:33,860 --> 00:07:38,930
rollout process<font color="#E5E5E5"> so there's a large</font>

191
00:07:35,390 --> 00:07:41,360
<font color="#E5E5E5">number of different banks</font><font color="#CCCCCC"> and it's just</font>

192
00:07:38,930 --> 00:07:43,250
<font color="#E5E5E5">taken a bit longer for</font><font color="#CCCCCC"> that reason but</font>

193
00:07:41,360 --> 00:07:45,200
the benefit of understanding this

194
00:07:43,250 --> 00:07:47,780
information is<font color="#E5E5E5"> that we can look</font><font color="#CCCCCC"> to other</font>

195
00:07:45,200 --> 00:07:49,820
parts of<font color="#E5E5E5"> the world so we can look to</font>

196
00:07:47,780 --> 00:07:51,799
South America<font color="#E5E5E5"> and</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> can look at Europe</font>

197
00:07:49,820 --> 00:07:53,990
and we can see what<font color="#CCCCCC"> kind of attack</font>

198
00:07:51,800 --> 00:07:56,270
vectors have happened<font color="#CCCCCC"> historically</font><font color="#E5E5E5"> and</font>

199
00:07:53,990 --> 00:08:00,729
also use those as a good predictor<font color="#CCCCCC"> of</font>

200
00:07:56,270 --> 00:08:02,900
what might take place<font color="#E5E5E5"> in North America</font>

201
00:08:00,729 --> 00:08:05,450
<font color="#E5E5E5">so if we look at this picture in a bit</font>

202
00:08:02,900 --> 00:08:08,270
more detail<font color="#CCCCCC"> you can see in North America</font>

203
00:08:05,450 --> 00:08:10,550
<font color="#E5E5E5">that EMV has actually been adopted quite</font>

204
00:08:08,270 --> 00:08:12,890
<font color="#E5E5E5">widely in terms</font><font color="#CCCCCC"> of credit cards but less</font>

205
00:08:10,550 --> 00:08:15,020
<font color="#CCCCCC">than 50%</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> any transactions are</font>

206
00:08:12,890 --> 00:08:16,400
actually made using a chip<font color="#E5E5E5"> and that's</font>

207
00:08:15,020 --> 00:08:19,430
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> even worse when we look at</font>

208
00:08:16,400 --> 00:08:21,560
debit cards<font color="#E5E5E5"> less than 25% of any</font>

209
00:08:19,430 --> 00:08:26,330
transactions are actually made using a

210
00:08:21,560 --> 00:08:28,190
chip and finally it's<font color="#E5E5E5"> really incredible</font>

211
00:08:26,330 --> 00:08:30,260
to<font color="#E5E5E5"> see only within a couple of years</font>

212
00:08:28,190 --> 00:08:32,088
<font color="#CCCCCC">that in this marketplace with mobile</font>

213
00:08:30,260 --> 00:08:35,299
<font color="#CCCCCC">point-of-sale</font><font color="#E5E5E5"> terminals there's been a</font>

214
00:08:32,089 --> 00:08:38,810
huge<font color="#CCCCCC"> growth</font><font color="#E5E5E5"> so by 2019 we can expect</font>

215
00:08:35,299 --> 00:08:41,718
<font color="#E5E5E5">that almost 50% of all transactions made</font>

216
00:08:38,809 --> 00:08:46,430
via a terminal<font color="#E5E5E5"> will actually be made via</font>

217
00:08:41,719 --> 00:08:48,650
a mobile<font color="#E5E5E5"> point-of-sales terminal so this</font>

218
00:08:46,430 --> 00:08:50,030
schematic overview represents how each

219
00:08:48,650 --> 00:08:52,699
of<font color="#CCCCCC"> the components in the</font><font color="#E5E5E5"> system</font>

220
00:08:50,030 --> 00:08:55,520
<font color="#E5E5E5">communicate with each other so we have</font>

221
00:08:52,700 --> 00:08:56,560
the mobile<font color="#CCCCCC"> point of sales terminal which</font>

222
00:08:55,520 --> 00:08:58,779
communicates

223
00:08:56,560 --> 00:09:01,569
<font color="#E5E5E5">Bluetooth or the audio jack to</font><font color="#CCCCCC"> the phone</font>

224
00:08:58,779 --> 00:09:04,209
and<font color="#E5E5E5"> this in turn communicates via Wi-Fi</font>

225
00:09:01,569 --> 00:09:06,479
<font color="#E5E5E5">or over a network connection to the</font>

226
00:09:04,209 --> 00:09:08,649
mobile<font color="#CCCCCC"> point-of-sales terminal provider</font>

227
00:09:06,480 --> 00:09:10,839
so now that we<font color="#E5E5E5"> have a broad</font>

228
00:09:08,649 --> 00:09:12,819
understanding of how payments work and

229
00:09:10,839 --> 00:09:15,100
how mobile point-of-sale terminals fit

230
00:09:12,819 --> 00:09:17,469
into this process<font color="#CCCCCC"> we can</font><font color="#E5E5E5"> begin to</font>

231
00:09:15,100 --> 00:09:18,699
<font color="#CCCCCC">discuss the findings</font><font color="#E5E5E5"> so we're going to</font>

232
00:09:17,470 --> 00:09:21,220
be talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> the sending of</font>

233
00:09:18,699 --> 00:09:23,559
arbitrary commands<font color="#E5E5E5"> this allows us</font><font color="#CCCCCC"> to</font>

234
00:09:21,220 --> 00:09:25,860
socially engineer<font color="#CCCCCC"> a cardholder to do</font>

235
00:09:23,559 --> 00:09:28,839
things like downgrade the attack from

236
00:09:25,860 --> 00:09:30,999
downgrade<font color="#E5E5E5"> the transaction method from</font>

237
00:09:28,839 --> 00:09:34,540
something like<font color="#E5E5E5"> Chip and PIN to magstripe</font>

238
00:09:30,999 --> 00:09:36,459
and we can also use<font color="#CCCCCC"> it to</font><font color="#E5E5E5"> interact</font><font color="#CCCCCC"> with</font>

239
00:09:34,540 --> 00:09:38,139
the payment process<font color="#CCCCCC"> so for</font><font color="#E5E5E5"> example we</font>

240
00:09:36,459 --> 00:09:40,268
can display a message<font color="#E5E5E5"> such as</font><font color="#CCCCCC"> payment</font>

241
00:09:38,139 --> 00:09:42,129
declined or payment<font color="#CCCCCC"> cancelled</font><font color="#E5E5E5"> and we can</font>

242
00:09:40,269 --> 00:09:44,860
force the card holders to carry<font color="#E5E5E5"> out an</font>

243
00:09:42,129 --> 00:09:46,449
additional transaction then we'll be

244
00:09:44,860 --> 00:09:47,949
talking<font color="#E5E5E5"> about how for some of the</font>

245
00:09:46,449 --> 00:09:51,160
<font color="#E5E5E5">readers we looked at we were</font><font color="#CCCCCC"> able to</font>

246
00:09:47,949 --> 00:09:53,199
modify<font color="#E5E5E5"> the amounts so this means that we</font>

247
00:09:51,160 --> 00:09:55,660
<font color="#CCCCCC">can display</font><font color="#E5E5E5"> a much lower value on the</font>

248
00:09:53,199 --> 00:09:57,878
terminal<font color="#E5E5E5"> and force a</font><font color="#CCCCCC"> cardholder</font><font color="#E5E5E5"> to carry</font>

249
00:09:55,660 --> 00:10:00,730
out a much higher value transaction

250
00:09:57,879 --> 00:10:02,019
without<font color="#E5E5E5"> actually realizing</font><font color="#CCCCCC"> this we're</font>

251
00:10:00,730 --> 00:10:04,779
going<font color="#E5E5E5"> to talk about how we obtained</font>

252
00:10:02,019 --> 00:10:06,910
<font color="#E5E5E5">remote code execution on the mirror</font><font color="#CCCCCC"> m0</font>

253
00:10:04,779 --> 00:10:08,620
<font color="#CCCCCC">ten</font><font color="#E5E5E5"> reader</font><font color="#CCCCCC"> and this is available through</font>

254
00:10:06,910 --> 00:10:10,809
a number<font color="#E5E5E5"> of the vendors we looked at for</font>

255
00:10:08,620 --> 00:10:12,490
example Square and PayPal and this

256
00:10:10,809 --> 00:10:14,620
allows you<font color="#E5E5E5"> to have full access</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font>

257
00:10:12,490 --> 00:10:16,569
operating<font color="#E5E5E5"> system</font><font color="#CCCCCC"> so once you have</font><font color="#E5E5E5"> full</font>

258
00:10:14,620 --> 00:10:18,279
access<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the operating system</font><font color="#CCCCCC"> this</font>

259
00:10:16,569 --> 00:10:19,870
<font color="#E5E5E5">means we can do things like intercept</font>

260
00:10:18,279 --> 00:10:22,240
<font color="#E5E5E5">track to information before it's</font>

261
00:10:19,870 --> 00:10:24,610
<font color="#E5E5E5">actually encrypted and we can</font><font color="#CCCCCC"> enable</font><font color="#E5E5E5"> the</font>

262
00:10:22,240 --> 00:10:26,500
<font color="#CCCCCC">plaintext mode on the PIN pad of the</font>

263
00:10:24,610 --> 00:10:29,110
device so<font color="#CCCCCC"> we can start collecting pin</font>

264
00:10:26,500 --> 00:10:31,389
codes as well<font color="#E5E5E5"> then we'll talk about</font><font color="#CCCCCC"> the</font>

265
00:10:29,110 --> 00:10:33,069
physical security<font color="#E5E5E5"> mechanisms in these</font>

266
00:10:31,389 --> 00:10:36,490
devices<font color="#CCCCCC"> and then finally we'll talk</font>

267
00:10:33,069 --> 00:10:37,959
<font color="#CCCCCC">about</font><font color="#E5E5E5"> these secondary factors so</font>

268
00:10:36,490 --> 00:10:39,819
<font color="#E5E5E5">Bluetooth is the main form of</font>

269
00:10:37,959 --> 00:10:41,829
<font color="#CCCCCC">communication between</font><font color="#E5E5E5"> the device</font><font color="#CCCCCC"> and the</font>

270
00:10:39,819 --> 00:10:43,599
phone<font color="#E5E5E5"> so therefore it's important for us</font>

271
00:10:41,829 --> 00:10:46,508
<font color="#E5E5E5">to</font><font color="#CCCCCC"> have a</font><font color="#E5E5E5"> understanding of how this</font>

272
00:10:43,600 --> 00:10:48,189
protocol<font color="#E5E5E5"> works so Bluetooth can be</font>

273
00:10:46,509 --> 00:10:50,860
roughly divided into the<font color="#E5E5E5"> host and</font>

274
00:10:48,189 --> 00:10:52,839
controller layers so<font color="#CCCCCC"> the Bluetooth</font>

275
00:10:50,860 --> 00:10:54,269
profiles and GATT and<font color="#CCCCCC"> apps</font><font color="#E5E5E5"> they deal</font>

276
00:10:52,839 --> 00:10:57,420
with<font color="#CCCCCC"> the</font><font color="#E5E5E5"> actual transfer</font><font color="#CCCCCC"> of information</font>

277
00:10:54,269 --> 00:11:00,879
<font color="#E5E5E5">then we have</font><font color="#CCCCCC"> LT cap and that deals with</font>

278
00:10:57,420 --> 00:11:03,069
<font color="#E5E5E5">the segmentation of the packets then we</font>

279
00:11:00,879 --> 00:11:05,319
have the<font color="#CCCCCC"> coast controller interface</font><font color="#E5E5E5"> and</font>

280
00:11:03,069 --> 00:11:06,819
many of us<font color="#CCCCCC"> actually have worked with the</font>

281
00:11:05,319 --> 00:11:08,790
host<font color="#E5E5E5"> controller interface this is</font>

282
00:11:06,819 --> 00:11:10,349
<font color="#CCCCCC">commonly used for debugging</font><font color="#E5E5E5"> so</font>

283
00:11:08,790 --> 00:11:12,510
<font color="#CCCCCC">this is the lowest layer that we can</font>

284
00:11:10,350 --> 00:11:15,690
directly interact without specialist

285
00:11:12,510 --> 00:11:17,460
equipment<font color="#E5E5E5"> then we have the link manager</font>

286
00:11:15,690 --> 00:11:20,190
protocol and this deals<font color="#E5E5E5"> with the pairing</font>

287
00:11:17,460 --> 00:11:22,050
negotiation and encryption<font color="#E5E5E5"> and we have</font>

288
00:11:20,190 --> 00:11:26,310
<font color="#CCCCCC">baseband</font><font color="#E5E5E5"> which is the final layer</font><font color="#CCCCCC"> of</font>

289
00:11:22,050 --> 00:11:27,719
framing before<font color="#E5E5E5"> Bluetooth radio itself so</font>

290
00:11:26,310 --> 00:11:29,369
when we talk about<font color="#E5E5E5"> Bluetooth were</font>

291
00:11:27,720 --> 00:11:31,650
actually talking<font color="#CCCCCC"> about two distinct</font>

292
00:11:29,370 --> 00:11:33,780
protocols<font color="#CCCCCC"> the first is Bluetooth classic</font>

293
00:11:31,650 --> 00:11:36,689
and then we have Bluetooth Low<font color="#E5E5E5"> Energy</font>

294
00:11:33,780 --> 00:11:38,069
<font color="#E5E5E5">so how these communicates to devices or</font>

295
00:11:36,690 --> 00:11:39,150
<font color="#E5E5E5">between the phone and</font><font color="#CCCCCC"> the device is</font>

296
00:11:38,070 --> 00:11:41,700
quite<font color="#E5E5E5"> different</font>

297
00:11:39,150 --> 00:11:43,980
so with Bluetooth classic all of the

298
00:11:41,700 --> 00:11:46,380
terminals that<font color="#E5E5E5"> we looked at they use RF</font>

299
00:11:43,980 --> 00:11:48,030
comm for communication so what this

300
00:11:46,380 --> 00:11:50,250
means<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that you can initiate a</font>

301
00:11:48,030 --> 00:11:52,920
connection<font color="#CCCCCC"> from the phone</font><font color="#E5E5E5"> to the device</font>

302
00:11:50,250 --> 00:11:55,080
and<font color="#CCCCCC"> you simulate a serial port this</font>

303
00:11:52,920 --> 00:11:57,719
<font color="#E5E5E5">means that we</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> send a large stream of</font>

304
00:11:55,080 --> 00:11:59,850
<font color="#E5E5E5">data to the device on the other hand</font>

305
00:11:57,720 --> 00:12:01,740
when we<font color="#E5E5E5"> look at Bluetooth Low Energy</font><font color="#CCCCCC"> the</font>

306
00:11:59,850 --> 00:12:03,570
<font color="#CCCCCC">structure of sending</font><font color="#E5E5E5"> data is quite</font>

307
00:12:01,740 --> 00:12:05,790
<font color="#CCCCCC">different so it has a hierarchical</font>

308
00:12:03,570 --> 00:12:07,980
structure under<font color="#E5E5E5"> which services and</font>

309
00:12:05,790 --> 00:12:10,469
characteristics are<font color="#CCCCCC"> defined and then we</font>

310
00:12:07,980 --> 00:12:12,060
have values for each<font color="#E5E5E5"> characteristic and</font>

311
00:12:10,470 --> 00:12:15,420
that<font color="#CCCCCC"> also has some properties such as</font>

312
00:12:12,060 --> 00:12:17,550
read wrote<font color="#CCCCCC"> right and notifying the main</font>

313
00:12:15,420 --> 00:12:19,740
difference<font color="#E5E5E5"> with Bluetooth Low</font><font color="#CCCCCC"> Energy and</font>

314
00:12:17,550 --> 00:12:22,260
Bluetooth<font color="#CCCCCC"> classic is that the data size</font>

315
00:12:19,740 --> 00:12:23,910
is<font color="#E5E5E5"> quite restricted so for Bluetooth Low</font>

316
00:12:22,260 --> 00:12:26,490
<font color="#E5E5E5">Energy</font><font color="#CCCCCC"> once you've taken away</font><font color="#E5E5E5"> the</font>

317
00:12:23,910 --> 00:12:30,209
<font color="#E5E5E5">headers you have about 20 bytes</font><font color="#CCCCCC"> that you</font>

318
00:12:26,490 --> 00:12:32,220
can<font color="#CCCCCC"> actually send information for now in</font>

319
00:12:30,210 --> 00:12:33,720
order<font color="#E5E5E5"> to attack a Bluetooth device we</font>

320
00:12:32,220 --> 00:12:36,090
actually need<font color="#E5E5E5"> to know what</font><font color="#CCCCCC"> its addresses</font>

321
00:12:33,720 --> 00:12:38,370
the<font color="#E5E5E5"> address is made up of three</font><font color="#CCCCCC"> main</font>

322
00:12:36,090 --> 00:12:40,320
parts<font color="#E5E5E5"> so we have the non significant</font>

323
00:12:38,370 --> 00:12:42,450
address part<font color="#E5E5E5"> which isn't significant for</font>

324
00:12:40,320 --> 00:12:44,070
any features of functions<font color="#E5E5E5"> then we have</font>

325
00:12:42,450 --> 00:12:46,530
the upper address part and the lower

326
00:12:44,070 --> 00:12:49,500
address part so<font color="#CCCCCC"> the</font><font color="#E5E5E5"> lower address part</font>

327
00:12:46,530 --> 00:12:51,270
that's unique<font color="#CCCCCC"> to every</font><font color="#E5E5E5"> device and this</font>

328
00:12:49,500 --> 00:12:54,090
is present in every<font color="#E5E5E5"> faint frame of</font>

329
00:12:51,270 --> 00:12:55,949
communication the non significant

330
00:12:54,090 --> 00:12:58,170
address bar and upper address part are

331
00:12:55,950 --> 00:13:01,380
what is known<font color="#E5E5E5"> as the organizationally</font>

332
00:12:58,170 --> 00:13:03,180
unique identifier or oh you I so if

333
00:13:01,380 --> 00:13:05,880
you're an attacker<font color="#E5E5E5"> and you know what the</font>

334
00:13:03,180 --> 00:13:07,469
<font color="#CCCCCC">Oh UI is for a</font><font color="#E5E5E5"> given device</font><font color="#CCCCCC"> so each</font>

335
00:13:05,880 --> 00:13:09,720
vendor has assigned a range of oh you

336
00:13:07,470 --> 00:13:12,780
eyes so if you know what the<font color="#CCCCCC"> Oh UI is</font>

337
00:13:09,720 --> 00:13:14,280
for a specific<font color="#CCCCCC"> terminal</font><font color="#E5E5E5"> this means that</font>

338
00:13:12,780 --> 00:13:16,380
you could go<font color="#CCCCCC"> and sit in a public</font><font color="#E5E5E5"> place</font>

339
00:13:14,280 --> 00:13:19,740
and you could identify<font color="#E5E5E5"> potentially</font>

340
00:13:16,380 --> 00:13:21,269
vulnerable terminals so there's<font color="#CCCCCC"> many</font>

341
00:13:19,740 --> 00:13:23,069
<font color="#E5E5E5">different Bluetooth attack factor</font>

342
00:13:21,269 --> 00:13:25,920
but we're just<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to be focusing on</font>

343
00:13:23,069 --> 00:13:28,769
<font color="#E5E5E5">two so the first is eavesdropping or</font>

344
00:13:25,920 --> 00:13:30,029
<font color="#CCCCCC">man-in-the-middle and the idea is here</font>

345
00:13:28,769 --> 00:13:31,559
<font color="#CCCCCC">that you're trying</font><font color="#E5E5E5"> to intercept</font>

346
00:13:30,029 --> 00:13:34,649
connection between the master and<font color="#E5E5E5"> the</font>

347
00:13:31,559 --> 00:13:35,879
slave in the network<font color="#E5E5E5"> and the second</font>

348
00:13:34,649 --> 00:13:38,339
attack<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> be talking about is</font>

349
00:13:35,879 --> 00:13:40,110
malicious device manipulation<font color="#E5E5E5"> so with</font>

350
00:13:38,339 --> 00:13:42,149
this you're<font color="#CCCCCC"> just connecting</font><font color="#E5E5E5"> directly to</font>

351
00:13:40,110 --> 00:13:44,429
<font color="#CCCCCC">the</font><font color="#E5E5E5"> device and you're trying to get it</font>

352
00:13:42,149 --> 00:13:46,410
to do some things so it might<font color="#E5E5E5"> be</font><font color="#CCCCCC"> that</font>

353
00:13:44,429 --> 00:13:49,139
<font color="#CCCCCC">some of these functions are intended by</font>

354
00:13:46,410 --> 00:13:50,490
design or<font color="#E5E5E5"> it may</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> that you're trying</font>

355
00:13:49,139 --> 00:13:54,779
to<font color="#E5E5E5"> get it to do</font><font color="#CCCCCC"> something that's quite</font>

356
00:13:50,490 --> 00:13:56,309
outside its intended<font color="#E5E5E5"> design so with a</font>

357
00:13:54,779 --> 00:13:58,199
man-in-the-middle attack what you're

358
00:13:56,309 --> 00:14:00,868
trying<font color="#E5E5E5"> to do is follow the connection</font>

359
00:13:58,199 --> 00:14:02,758
between the master<font color="#E5E5E5"> and slave and collect</font>

360
00:14:00,869 --> 00:14:05,639
enough information<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you can decrypt</font>

361
00:14:02,759 --> 00:14:07,529
the communication now how you carry out

362
00:14:05,639 --> 00:14:10,579
this attack<font color="#E5E5E5"> depends on the Bluetooth</font>

363
00:14:07,529 --> 00:14:13,259
communication<font color="#CCCCCC"> type so if it's Bluetooth</font>

364
00:14:10,579 --> 00:14:15,599
<font color="#CCCCCC">classic if it's a device that's</font>

365
00:14:13,259 --> 00:14:17,610
reasonably sophisticated<font color="#CCCCCC"> chances are</font>

366
00:14:15,600 --> 00:14:19,740
it's using something called<font color="#E5E5E5"> an enhanced</font>

367
00:14:17,610 --> 00:14:22,019
data<font color="#CCCCCC"> rates</font><font color="#E5E5E5"> now the problem with this</font>

368
00:14:19,740 --> 00:14:24,300
from<font color="#E5E5E5"> the attackers</font><font color="#CCCCCC"> perspective or if</font>

369
00:14:22,019 --> 00:14:26,819
you're a security<font color="#E5E5E5"> researcher</font><font color="#CCCCCC"> is that it</font>

370
00:14:24,300 --> 00:14:28,769
requires<font color="#E5E5E5"> dedicated equipment to actually</font>

371
00:14:26,819 --> 00:14:31,319
carry out<font color="#E5E5E5"> a man-in-the-middle attack for</font>

372
00:14:28,769 --> 00:14:32,939
this type of device<font color="#E5E5E5"> so typically this</font>

373
00:14:31,319 --> 00:14:34,439
equipment retails for<font color="#E5E5E5"> about twenty</font>

374
00:14:32,939 --> 00:14:37,139
<font color="#E5E5E5">thousand dollars so you can see the</font>

375
00:14:34,439 --> 00:14:38,969
front line<font color="#CCCCCC"> BPA 600 there which means</font>

376
00:14:37,139 --> 00:14:41,970
<font color="#E5E5E5">that this kind of attack vector isn't</font>

377
00:14:38,970 --> 00:14:43,920
very viable<font color="#E5E5E5"> for most of us for Bluetooth</font>

378
00:14:41,970 --> 00:14:47,009
classic<font color="#E5E5E5"> for Bluetooth Low</font><font color="#CCCCCC"> Energy on the</font>

379
00:14:43,920 --> 00:14:48,899
other hand it's much more it's<font color="#E5E5E5"> much</font>

380
00:14:47,009 --> 00:14:51,179
easier for<font color="#CCCCCC"> us to find</font><font color="#E5E5E5"> equipment that we</font>

381
00:14:48,899 --> 00:14:52,949
can<font color="#CCCCCC"> use so we can use something</font><font color="#E5E5E5"> like</font>

382
00:14:51,179 --> 00:14:56,429
<font color="#E5E5E5">that uber tooth one or there's also the</font>

383
00:14:52,949 --> 00:14:59,429
Texas Instruments<font color="#CCCCCC"> CC</font><font color="#E5E5E5"> 25 40 dev kit which</font>

384
00:14:56,429 --> 00:15:00,899
is<font color="#E5E5E5"> also available and that's around</font><font color="#CCCCCC"> 50</font>

385
00:14:59,429 --> 00:15:02,910
<font color="#CCCCCC">dollars so it's pretty cheap</font><font color="#E5E5E5"> but</font>

386
00:15:00,899 --> 00:15:04,799
<font color="#E5E5E5">carrying out these kind of</font><font color="#CCCCCC"> attacks</font><font color="#E5E5E5"> are</font>

387
00:15:02,910 --> 00:15:06,809
quite difficult if you've had any

388
00:15:04,799 --> 00:15:09,689
experience<font color="#E5E5E5"> with</font><font color="#CCCCCC"> them and there's a</font><font color="#E5E5E5"> lot</font>

389
00:15:06,809 --> 00:15:10,379
<font color="#CCCCCC">of room for</font><font color="#E5E5E5"> error also</font><font color="#CCCCCC"> keep</font><font color="#E5E5E5"> in mind when</font>

390
00:15:09,689 --> 00:15:12,449
you're<font color="#CCCCCC"> thinking about a</font>

391
00:15:10,379 --> 00:15:14,790
man-in-the-middle attack<font color="#E5E5E5"> we're talking</font>

392
00:15:12,449 --> 00:15:16,559
about payment terminals<font color="#E5E5E5"> so a lot of the</font>

393
00:15:14,790 --> 00:15:18,779
<font color="#E5E5E5">pertinent</font><font color="#CCCCCC"> information is going</font><font color="#E5E5E5"> to be</font>

394
00:15:16,559 --> 00:15:21,868
encrypted from the terminal all the way

395
00:15:18,779 --> 00:15:23,549
<font color="#E5E5E5">through to the payment server so for us</font>

396
00:15:21,869 --> 00:15:25,679
when we<font color="#E5E5E5"> were looking</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> these devices</font>

397
00:15:23,549 --> 00:15:29,120
and trying to carry<font color="#CCCCCC"> out these kind of</font>

398
00:15:25,679 --> 00:15:32,040
<font color="#E5E5E5">attacks it wasn't a viable attack vector</font>

399
00:15:29,120 --> 00:15:33,360
just a quick note<font color="#E5E5E5"> on</font><font color="#CCCCCC"> enhance data rates</font>

400
00:15:32,040 --> 00:15:34,689
because there<font color="#E5E5E5"> isn't that much</font>

401
00:15:33,360 --> 00:15:36,759
<font color="#E5E5E5">information</font>

402
00:15:34,690 --> 00:15:39,040
available to find out if a device is

403
00:15:36,759 --> 00:15:40,629
<font color="#CCCCCC">using an enhanced eight ring</font><font color="#E5E5E5"> so how do</font>

404
00:15:39,040 --> 00:15:42,490
you confirm<font color="#CCCCCC"> that your device is using an</font>

405
00:15:40,629 --> 00:15:43,629
enhanced data rate and therefore you

406
00:15:42,490 --> 00:15:45,699
<font color="#CCCCCC">probably can't carry</font><font color="#E5E5E5"> out a</font>

407
00:15:43,629 --> 00:15:47,620
man-in-the-middle attack so you do two

408
00:15:45,699 --> 00:15:49,300
<font color="#E5E5E5">things the first is you run a</font>

409
00:15:47,620 --> 00:15:52,120
reconnaissance scan against the device

410
00:15:49,300 --> 00:15:54,008
using something like<font color="#E5E5E5"> HDI tool and you'll</font>

411
00:15:52,120 --> 00:15:56,319
see<font color="#E5E5E5"> that EDR is actually listed</font><font color="#CCCCCC"> as a</font>

412
00:15:54,009 --> 00:15:57,819
supported feature for the device<font color="#CCCCCC"> and the</font>

413
00:15:56,319 --> 00:15:59,259
second<font color="#E5E5E5"> thing is you can use</font><font color="#CCCCCC"> a tool like</font>

414
00:15:57,819 --> 00:16:01,389
uber tooth to collect some<font color="#CCCCCC"> of the</font>

415
00:15:59,259 --> 00:16:03,069
packets<font color="#E5E5E5"> and you'll</font><font color="#CCCCCC"> notice that you're</font>

416
00:16:01,389 --> 00:16:07,180
only<font color="#E5E5E5"> actually collecting the headers and</font>

417
00:16:03,069 --> 00:16:08,769
<font color="#CCCCCC">there's no data payloads</font><font color="#E5E5E5"> so this brings</font>

418
00:16:07,180 --> 00:16:10,569
<font color="#E5E5E5">us</font><font color="#CCCCCC"> onto</font><font color="#E5E5E5"> our first finding which</font><font color="#CCCCCC"> is the</font>

419
00:16:08,769 --> 00:16:13,089
sending of<font color="#E5E5E5"> arbitrary</font><font color="#CCCCCC"> commands which as</font><font color="#E5E5E5"> I</font>

420
00:16:10,569 --> 00:16:15,219
mentioned<font color="#CCCCCC"> we can use this to our</font>

421
00:16:13,089 --> 00:16:19,839
<font color="#E5E5E5">advantage by actually socially</font>

422
00:16:15,220 --> 00:16:22,480
<font color="#E5E5E5">engineering the</font><font color="#CCCCCC"> cardholder so how do we</font>

423
00:16:19,839 --> 00:16:24,279
<font color="#E5E5E5">carry out this kind of attack well the</font>

424
00:16:22,480 --> 00:16:27,160
<font color="#E5E5E5">first thing that we need</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> do is we</font>

425
00:16:24,279 --> 00:16:28,810
need<font color="#CCCCCC"> to connect to</font><font color="#E5E5E5"> the device and we</font>

426
00:16:27,160 --> 00:16:30,699
need to understand how the device that

427
00:16:28,810 --> 00:16:32,378
<font color="#E5E5E5">you work so what each of the functions</font>

428
00:16:30,699 --> 00:16:34,689
are responsible for and how<font color="#E5E5E5"> we</font>

429
00:16:32,379 --> 00:16:37,449
<font color="#CCCCCC">communicate and initiate those functions</font>

430
00:16:34,689 --> 00:16:39,849
<font color="#E5E5E5">we also might need to understand how the</font>

431
00:16:37,449 --> 00:16:41,709
pairing<font color="#CCCCCC"> process works</font><font color="#E5E5E5"> for example for</font>

432
00:16:39,850 --> 00:16:43,870
some terminals you might have to have

433
00:16:41,709 --> 00:16:45,758
<font color="#CCCCCC">some physical</font><font color="#E5E5E5"> interaction to initiate</font>

434
00:16:43,870 --> 00:16:48,779
the pairing<font color="#CCCCCC"> process in order</font><font color="#E5E5E5"> to connect</font>

435
00:16:45,759 --> 00:16:51,759
so we need to<font color="#E5E5E5"> keep that in mind as well</font>

436
00:16:48,779 --> 00:16:53,889
so before you<font color="#E5E5E5"> carry out this attack you</font>

437
00:16:51,759 --> 00:16:57,370
need to carry<font color="#E5E5E5"> out some prerequisite work</font>

438
00:16:53,889 --> 00:16:59,199
<font color="#CCCCCC">which you'll need a mobile</font><font color="#E5E5E5"> phone and</font>

439
00:16:57,370 --> 00:17:01,540
you'll need access<font color="#E5E5E5"> to something like</font>

440
00:16:59,199 --> 00:17:03,790
developers options to enable<font color="#CCCCCC"> the</font><font color="#E5E5E5"> HCI</font>

441
00:17:01,540 --> 00:17:05,438
logging this<font color="#E5E5E5"> is going to give us a lot</font>

442
00:17:03,790 --> 00:17:07,629
of<font color="#E5E5E5"> information</font><font color="#CCCCCC"> about the communication</font>

443
00:17:05,439 --> 00:17:08,949
between<font color="#E5E5E5"> the phone and</font><font color="#CCCCCC"> the terminal then</font>

444
00:17:07,630 --> 00:17:11,079
you'll need<font color="#CCCCCC"> access to the mobile</font>

445
00:17:08,949 --> 00:17:14,439
<font color="#E5E5E5">application and the terminal that you're</font>

446
00:17:11,079 --> 00:17:16,899
intending<font color="#CCCCCC"> to tap</font><font color="#E5E5E5"> or to attack so now we</font>

447
00:17:14,439 --> 00:17:19,240
want to carry<font color="#E5E5E5"> out a sample of</font>

448
00:17:16,900 --> 00:17:22,059
transactions<font color="#E5E5E5"> and this is so that</font><font color="#CCCCCC"> we can</font>

449
00:17:19,240 --> 00:17:25,480
<font color="#CCCCCC">get an idea of</font><font color="#E5E5E5"> how each of</font><font color="#CCCCCC"> the functions</font>

450
00:17:22,059 --> 00:17:27,879
work<font color="#E5E5E5"> so here you can see I've imported</font>

451
00:17:25,480 --> 00:17:30,130
the<font color="#CCCCCC"> HDI</font><font color="#E5E5E5"> log into Wireshark and for this</font>

452
00:17:27,880 --> 00:17:32,470
specific device we<font color="#E5E5E5"> can see the sending</font>

453
00:17:30,130 --> 00:17:37,330
<font color="#E5E5E5">of the message insert or swipe card</font><font color="#CCCCCC"> to</font>

454
00:17:32,470 --> 00:17:39,370
the device<font color="#E5E5E5"> so here's another example so</font>

455
00:17:37,330 --> 00:17:41,559
what I've done is<font color="#CCCCCC"> I've inserted my</font><font color="#E5E5E5"> chip</font>

456
00:17:39,370 --> 00:17:43,570
card<font color="#E5E5E5"> incorrectly into the terminal and</font>

457
00:17:41,559 --> 00:17:47,049
it's produced a message that says please

458
00:17:43,570 --> 00:17:48,070
remove card<font color="#E5E5E5"> so here we can see</font><font color="#CCCCCC"> that</font>

459
00:17:47,049 --> 00:17:49,629
there's actually<font color="#CCCCCC"> two pack</font>

460
00:17:48,070 --> 00:17:51,370
it's responsible<font color="#CCCCCC"> for the sending</font><font color="#E5E5E5"> of this</font>

461
00:17:49,630 --> 00:17:52,960
<font color="#CCCCCC">information and that's</font><font color="#E5E5E5"> because this</font>

462
00:17:51,370 --> 00:17:55,689
<font color="#CCCCCC">terminal is</font><font color="#E5E5E5"> using</font><font color="#CCCCCC"> Bluetooth class</font>

463
00:17:52,960 --> 00:17:58,270
<font color="#E5E5E5">Bluetooth Low</font><font color="#CCCCCC"> Energy we can also see the</font>

464
00:17:55,690 --> 00:18:00,610
UUID value responsible for it<font color="#E5E5E5"> and the</font>

465
00:17:58,270 --> 00:18:02,740
value<font color="#E5E5E5"> itself so we need to know this</font>

466
00:18:00,610 --> 00:18:06,699
information<font color="#E5E5E5"> in order to communicate</font><font color="#CCCCCC"> with</font>

467
00:18:02,740 --> 00:18:08,560
the<font color="#E5E5E5"> the device so we use this</font>

468
00:18:06,700 --> 00:18:10,030
information<font color="#E5E5E5"> along</font><font color="#CCCCCC"> with the information</font>

469
00:18:08,560 --> 00:18:11,830
<font color="#CCCCCC">that</font><font color="#E5E5E5"> we can obtain</font><font color="#CCCCCC"> in the mobile</font>

470
00:18:10,030 --> 00:18:13,330
application<font color="#CCCCCC"> and it means that we can</font>

471
00:18:11,830 --> 00:18:16,480
actually<font color="#E5E5E5"> work out</font><font color="#CCCCCC"> what the message</font>

472
00:18:13,330 --> 00:18:18,280
consists of so it consists of five main

473
00:18:16,480 --> 00:18:21,370
<font color="#E5E5E5">parts so we have the leading part and</font>

474
00:18:18,280 --> 00:18:23,800
<font color="#E5E5E5">this contains a counter a command ID and</font>

475
00:18:21,370 --> 00:18:25,629
the intended payload size<font color="#E5E5E5"> then</font><font color="#CCCCCC"> we have</font>

476
00:18:23,800 --> 00:18:28,000
the message which is please remove card

477
00:18:25,630 --> 00:18:29,320
and that's<font color="#E5E5E5"> an ASCII text and we have a</font>

478
00:18:28,000 --> 00:18:31,990
<font color="#E5E5E5">training value which is always</font>

479
00:18:29,320 --> 00:18:34,120
consistent<font color="#CCCCCC"> a checksum which</font><font color="#E5E5E5"> is in Ex</font>

480
00:18:31,990 --> 00:18:37,510
modem and then the end value<font color="#CCCCCC"> is</font><font color="#E5E5E5"> also</font>

481
00:18:34,120 --> 00:18:40,030
always consistent so what can<font color="#CCCCCC"> you do</font>

482
00:18:37,510 --> 00:18:41,920
with this kind<font color="#CCCCCC"> of information so as I</font>

483
00:18:40,030 --> 00:18:43,570
mentioned you can<font color="#E5E5E5"> force a</font><font color="#CCCCCC"> cardholder</font><font color="#E5E5E5"> to</font>

484
00:18:41,920 --> 00:18:45,550
actually carry<font color="#CCCCCC"> out a</font><font color="#E5E5E5"> more vulnerable</font>

485
00:18:43,570 --> 00:18:48,250
<font color="#E5E5E5">payment methods such as</font><font color="#CCCCCC"> magstripe</font>

486
00:18:45,550 --> 00:18:50,080
and we can also interrupt the payment

487
00:18:48,250 --> 00:18:52,120
process so we can<font color="#E5E5E5"> display a message</font><font color="#CCCCCC"> as</font>

488
00:18:50,080 --> 00:18:54,820
as payment<font color="#E5E5E5"> cancelled even though the</font>

489
00:18:52,120 --> 00:18:56,860
payment is going<font color="#E5E5E5"> to go through so let's</font>

490
00:18:54,820 --> 00:18:58,810
take a look<font color="#E5E5E5"> at this in action</font><font color="#CCCCCC"> so here</font>

491
00:18:56,860 --> 00:19:00,550
I've got a<font color="#CCCCCC"> terminal that</font><font color="#E5E5E5"> I'm going to</font>

492
00:18:58,810 --> 00:19:02,200
connect<font color="#CCCCCC"> to and I'm</font><font color="#E5E5E5"> first of all I'm</font>

493
00:19:00,550 --> 00:19:05,590
going to<font color="#E5E5E5"> ask the cardholder to insert</font>

494
00:19:02,200 --> 00:19:09,330
their card<font color="#CCCCCC"> and then I'm going</font><font color="#E5E5E5"> to ask</font>

495
00:19:05,590 --> 00:19:09,330
them<font color="#E5E5E5"> to swipe the card instead</font>

496
00:19:22,040 --> 00:19:26,690
<font color="#E5E5E5">okay so here's a another</font><font color="#CCCCCC"> example you can</font>

497
00:19:25,310 --> 00:19:28,340
see that<font color="#CCCCCC"> this</font><font color="#E5E5E5"> looks a bit different</font>

498
00:19:26,690 --> 00:19:30,020
<font color="#CCCCCC">that's just because</font><font color="#E5E5E5"> this terminal is</font>

499
00:19:28,340 --> 00:19:33,100
using<font color="#E5E5E5"> Bluetooth classic</font><font color="#CCCCCC"> so we can see</font>

500
00:19:30,020 --> 00:19:36,650
all<font color="#CCCCCC"> the data has been sent</font><font color="#E5E5E5"> in one long</font>

501
00:19:33,100 --> 00:19:38,750
packet<font color="#CCCCCC"> so here we can see the sending of</font>

502
00:19:36,650 --> 00:19:40,730
<font color="#CCCCCC">the message insert or swiped card</font><font color="#E5E5E5"> to the</font>

503
00:19:38,750 --> 00:19:42,620
display<font color="#E5E5E5"> of this device and</font><font color="#CCCCCC"> again what we</font>

504
00:19:40,730 --> 00:19:44,330
can do if we deconstruct the message

505
00:19:42,620 --> 00:19:46,340
<font color="#E5E5E5">it's quite similar to the</font><font color="#CCCCCC"> previous</font>

506
00:19:44,330 --> 00:19:48,770
example<font color="#CCCCCC"> so we have a</font><font color="#E5E5E5"> leading part this</font>

507
00:19:46,340 --> 00:19:50,990
<font color="#E5E5E5">contains</font><font color="#CCCCCC"> a command ID</font><font color="#E5E5E5"> the payload size</font>

508
00:19:48,770 --> 00:19:53,120
<font color="#CCCCCC">and a counter</font><font color="#E5E5E5"> there we have the message</font>

509
00:19:50,990 --> 00:19:55,490
which is<font color="#E5E5E5"> in ASCII</font><font color="#CCCCCC"> which is insert or</font>

510
00:19:53,120 --> 00:19:58,600
swipe card and then we have a checksum

511
00:19:55,490 --> 00:20:00,380
which<font color="#E5E5E5"> is just a simple</font><font color="#CCCCCC"> XOR calculation</font>

512
00:19:58,600 --> 00:20:02,000
so what we're going<font color="#E5E5E5"> to do with this</font>

513
00:20:00,380 --> 00:20:04,970
examples we're going to interrupt<font color="#CCCCCC"> the</font>

514
00:20:02,000 --> 00:20:06,680
<font color="#E5E5E5">payment process</font><font color="#CCCCCC"> so here the</font><font color="#E5E5E5"> card</font><font color="#CCCCCC"> holder</font>

515
00:20:04,970 --> 00:20:09,350
is carrying out a contactless payment

516
00:20:06,680 --> 00:20:10,340
for<font color="#E5E5E5"> one pound</font><font color="#CCCCCC"> but what we're going to do</font>

517
00:20:09,350 --> 00:20:11,629
is we're<font color="#E5E5E5"> going to connect to the</font>

518
00:20:10,340 --> 00:20:14,959
terminal<font color="#E5E5E5"> and we're going to say actually</font>

519
00:20:11,630 --> 00:20:16,520
<font color="#CCCCCC">this payment isn't going through so</font>

520
00:20:14,960 --> 00:20:21,440
you'll see in a moment<font color="#E5E5E5"> that it's going</font>

521
00:20:16,520 --> 00:20:23,360
<font color="#E5E5E5">to say payment</font><font color="#CCCCCC"> cancelled but</font><font color="#E5E5E5"> in fact</font>

522
00:20:21,440 --> 00:20:24,980
this<font color="#E5E5E5"> payment has</font><font color="#CCCCCC"> been authorized which</font>

523
00:20:23,360 --> 00:20:27,800
<font color="#E5E5E5">we'll see on the phone there's going to</font>

524
00:20:24,980 --> 00:20:29,120
be a text message that<font color="#E5E5E5"> the card</font><font color="#CCCCCC"> holder</font>

525
00:20:27,800 --> 00:20:31,330
receives for the value of<font color="#E5E5E5"> the</font>

526
00:20:29,120 --> 00:20:31,330
transaction

527
00:20:35,280 --> 00:20:39,330
so unless<font color="#E5E5E5"> you</font><font color="#CCCCCC"> have this kind of alerting</font>

528
00:20:37,650 --> 00:20:40,890
<font color="#E5E5E5">enabled through your bank account you</font>

529
00:20:39,330 --> 00:20:53,639
wouldn't actually know that<font color="#E5E5E5"> the payment</font>

530
00:20:40,890 --> 00:20:55,590
has<font color="#CCCCCC"> been authorized so what what</font><font color="#E5E5E5"> else</font>

531
00:20:53,640 --> 00:20:57,660
you can do with<font color="#CCCCCC"> this kind</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> information</font>

532
00:20:55,590 --> 00:21:00,209
is we<font color="#E5E5E5"> realize that we can actually use</font>

533
00:20:57,660 --> 00:21:03,000
this to<font color="#E5E5E5"> fuzz for different kind of</font>

534
00:21:00,210 --> 00:21:04,770
vulnerabilities<font color="#E5E5E5"> so you do this by</font>

535
00:21:03,000 --> 00:21:07,950
connecting<font color="#E5E5E5"> to a potentially vulnerable</font>

536
00:21:04,770 --> 00:21:10,020
terminal<font color="#E5E5E5"> and then you send an increasing</font>

537
00:21:07,950 --> 00:21:12,330
<font color="#CCCCCC">number of characteristics</font><font color="#E5E5E5"> to that value</font>

538
00:21:10,020 --> 00:21:14,810
<font color="#CCCCCC">that we identified which causes the</font>

539
00:21:12,330 --> 00:21:19,379
terminal to do things like restart<font color="#E5E5E5"> or</font>

540
00:21:14,810 --> 00:21:21,450
crash<font color="#E5E5E5"> so what we decided to do is we</font>

541
00:21:19,380 --> 00:21:24,270
decided<font color="#E5E5E5"> to implement this using</font><font color="#CCCCCC"> a very</font>

542
00:21:21,450 --> 00:21:26,160
<font color="#E5E5E5">simple program on the ESP 32 which is</font><font color="#CCCCCC"> a</font>

543
00:21:24,270 --> 00:21:29,850
really<font color="#E5E5E5"> cheap device that you can get for</font>

544
00:21:26,160 --> 00:21:30,600
less than $15 and it's very compact and

545
00:21:29,850 --> 00:21:32,790
<font color="#CCCCCC">low-power</font>

546
00:21:30,600 --> 00:21:36,149
and it supports<font color="#CCCCCC"> both Bluetooth classic</font>

547
00:21:32,790 --> 00:21:37,440
<font color="#CCCCCC">and Bluetooth</font><font color="#E5E5E5"> Low</font><font color="#CCCCCC"> Energy</font><font color="#E5E5E5"> so here you can</font>

548
00:21:36,150 --> 00:21:40,440
see in this example<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to see on the</font>

549
00:21:37,440 --> 00:21:43,440
left hand side is<font color="#CCCCCC"> the output</font><font color="#E5E5E5"> from the</font>

550
00:21:40,440 --> 00:21:45,150
ESP 32 and we're sending you<font color="#E5E5E5"> can see the</font>

551
00:21:43,440 --> 00:21:46,260
little<font color="#E5E5E5"> bunny on the terminal we're</font>

552
00:21:45,150 --> 00:21:48,210
sending increasing number of

553
00:21:46,260 --> 00:21:50,010
<font color="#E5E5E5">characteristics</font><font color="#CCCCCC"> we're going to hit</font>

554
00:21:48,210 --> 00:21:51,260
<font color="#E5E5E5">thirty two thousand seven</font><font color="#CCCCCC"> hundred</font><font color="#E5E5E5"> and</font>

555
00:21:50,010 --> 00:21:54,390
<font color="#E5E5E5">seventy-six</font>

556
00:21:51,260 --> 00:21:56,310
characters<font color="#E5E5E5"> and then it disconnects so</font>

557
00:21:54,390 --> 00:21:58,350
you can use this as a<font color="#E5E5E5"> method</font><font color="#CCCCCC"> for</font>

558
00:21:56,310 --> 00:22:05,550
identifying<font color="#E5E5E5"> other vulnerabilities in the</font>

559
00:21:58,350 --> 00:22:07,830
terminal so this brings us<font color="#E5E5E5"> on</font><font color="#CCCCCC"> to our</font>

560
00:22:05,550 --> 00:22:10,470
next finding which is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> sendee</font>

561
00:22:07,830 --> 00:22:15,179
modification of a amount which<font color="#CCCCCC"> Tim's</font>

562
00:22:10,470 --> 00:22:18,810
<font color="#E5E5E5">gonna talk to us about yeah thanks</font><font color="#CCCCCC"> yeah</font>

563
00:22:15,180 --> 00:22:21,720
now let's try to intercept modify

564
00:22:18,810 --> 00:22:24,780
payment process<font color="#E5E5E5"> so there are</font><font color="#CCCCCC"> actually</font>

565
00:22:21,720 --> 00:22:26,880
many ways to intercept payment comments

566
00:22:24,780 --> 00:22:28,920
as well<font color="#E5E5E5"> as other comments to the reader</font>

567
00:22:26,880 --> 00:22:31,830
<font color="#CCCCCC">first of</font><font color="#E5E5E5"> all most of them are</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> from</font>

568
00:22:28,920 --> 00:22:33,900
a server<font color="#E5E5E5"> side which means that we can</font>

569
00:22:31,830 --> 00:22:35,790
intercept<font color="#E5E5E5"> them via HTTP main in the</font>

570
00:22:33,900 --> 00:22:38,610
middle<font color="#E5E5E5"> and for this purpose you need to</font>

571
00:22:35,790 --> 00:22:40,620
bypass<font color="#E5E5E5"> SSL</font><font color="#CCCCCC"> pinyin somehow but if it is</font>

572
00:22:38,610 --> 00:22:44,100
your device and<font color="#CCCCCC"> especially if it's</font>

573
00:22:40,620 --> 00:22:46,080
<font color="#E5E5E5">rooted it's not a big deal</font><font color="#CCCCCC"> next method</font>

574
00:22:44,100 --> 00:22:48,928
was already<font color="#E5E5E5"> mentioned</font><font color="#CCCCCC"> is just to enable</font>

575
00:22:46,080 --> 00:22:51,350
a child login on<font color="#CCCCCC"> the device</font>

576
00:22:48,929 --> 00:22:53,580
collect<font color="#CCCCCC"> data and read it while Wireshark</font>

577
00:22:51,350 --> 00:22:55,559
<font color="#E5E5E5">also what else you can do you can</font>

578
00:22:53,580 --> 00:22:57,869
rebuild an application and enable

579
00:22:55,559 --> 00:23:00,330
debugging messages and then get<font color="#CCCCCC"> access</font>

580
00:22:57,869 --> 00:23:02,580
to them via Android<font color="#E5E5E5"> debug</font><font color="#CCCCCC"> and bridge as</font>

581
00:23:00,330 --> 00:23:04,019
well as reverse engineering of

582
00:23:02,580 --> 00:23:05,939
application is quite<font color="#E5E5E5"> useful to</font>

583
00:23:04,019 --> 00:23:08,669
understand<font color="#E5E5E5"> the structure of comments get</font>

584
00:23:05,940 --> 00:23:11,159
<font color="#E5E5E5">example of different example and</font>

585
00:23:08,669 --> 00:23:13,950
<font color="#E5E5E5">descriptions of every other comments and</font>

586
00:23:11,159 --> 00:23:16,169
so on and finally<font color="#E5E5E5"> if you don't have any</font>

587
00:23:13,950 --> 00:23:19,169
<font color="#E5E5E5">other options</font><font color="#CCCCCC"> you still can use</font><font color="#E5E5E5"> some</font>

588
00:23:16,169 --> 00:23:21,809
<font color="#E5E5E5">external device</font><font color="#CCCCCC"> such</font><font color="#E5E5E5"> liberties to get</font>

589
00:23:19,169 --> 00:23:24,929
<font color="#E5E5E5">access to the traffic so here are two</font>

590
00:23:21,809 --> 00:23:28,230
examples of intercepted payment comments

591
00:23:24,929 --> 00:23:32,340
from two different<font color="#E5E5E5"> readers and for each</font>

592
00:23:28,230 --> 00:23:34,649
<font color="#CCCCCC">example we used two different</font><font color="#E5E5E5"> channels</font>

593
00:23:32,340 --> 00:23:38,100
<font color="#E5E5E5">of interception just to correlate the</font>

594
00:23:34,649 --> 00:23:40,439
information and in the first<font color="#E5E5E5"> case we</font>

595
00:23:38,100 --> 00:23:45,480
rebuilt an application and we also

596
00:23:40,440 --> 00:23:49,159
enabled<font color="#CCCCCC"> excel</font><font color="#E5E5E5"> login and as you can see</font>

597
00:23:45,480 --> 00:23:52,889
<font color="#E5E5E5">we</font><font color="#CCCCCC"> made a payment</font><font color="#E5E5E5"> for 750 dollars and</font>

598
00:23:49,159 --> 00:23:55,919
<font color="#E5E5E5">amount was actually sent in hex so</font><font color="#CCCCCC"> 0-2</font>

599
00:23:52,889 --> 00:23:58,830
EE<font color="#E5E5E5"> and then second case we also built an</font>

600
00:23:55,919 --> 00:24:01,950
application<font color="#CCCCCC"> and enabled</font><font color="#E5E5E5"> HTTP min in the</font>

601
00:23:58,830 --> 00:24:04,918
middle and in that case<font color="#CCCCCC"> amount for</font>

602
00:24:01,950 --> 00:24:07,499
payment was<font color="#CCCCCC"> sent in</font><font color="#E5E5E5"> plain</font><font color="#CCCCCC"> text so</font><font color="#E5E5E5"> 0 1 0</font>

603
00:24:04,919 --> 00:24:10,519
0<font color="#CCCCCC"> and as you can</font><font color="#E5E5E5"> imagine in both cases</font>

604
00:24:07,499 --> 00:24:14,100
just<font color="#E5E5E5"> to change</font><font color="#CCCCCC"> any amount to a this</font>

605
00:24:10,519 --> 00:24:16,739
amount to any amount<font color="#CCCCCC"> e1 you just need to</font>

606
00:24:14,100 --> 00:24:20,449
change<font color="#CCCCCC"> these bytes and replace it</font>

607
00:24:16,739 --> 00:24:24,509
checksum<font color="#CCCCCC"> so what actually</font><font color="#E5E5E5"> will happen if</font>

608
00:24:20,450 --> 00:24:27,389
fraudulent<font color="#CCCCCC"> merchants</font><font color="#E5E5E5"> change tamper</font><font color="#CCCCCC"> the</font>

609
00:24:24,509 --> 00:24:30,090
amount between reader and the phone<font color="#E5E5E5"> it</font>

610
00:24:27,389 --> 00:24:32,449
will<font color="#E5E5E5"> be possible</font><font color="#CCCCCC"> for him to force</font>

611
00:24:30,090 --> 00:24:35,999
customer to make<font color="#CCCCCC"> a high-value</font>

612
00:24:32,450 --> 00:24:38,519
transaction by showing lower value

613
00:24:35,999 --> 00:24:41,070
amount on the reader and on the phone

614
00:24:38,519 --> 00:24:44,609
<font color="#E5E5E5">but actually sending higher value</font><font color="#CCCCCC"> to a</font>

615
00:24:41,070 --> 00:24:48,059
server<font color="#E5E5E5"> site so that's actually what we</font>

616
00:24:44,609 --> 00:24:51,090
did so<font color="#E5E5E5"> we sent one pound</font><font color="#CCCCCC"> 23 pens</font><font color="#E5E5E5"> to a</font>

617
00:24:48,059 --> 00:24:54,230
server but customer actually<font color="#E5E5E5"> sees and</font>

618
00:24:51,090 --> 00:24:57,090
confirms only<font color="#E5E5E5"> one pound transaction and</font>

619
00:24:54,230 --> 00:25:00,090
as you can imagine we<font color="#E5E5E5"> don't even need to</font>

620
00:24:57,090 --> 00:25:03,590
<font color="#E5E5E5">forge a signature because customer</font>

621
00:25:00,090 --> 00:25:03,590
relief his<font color="#E5E5E5"> own genuine one</font>

622
00:25:05,140 --> 00:25:11,230
so<font color="#CCCCCC"> this type of fraud fraudulent</font>

623
00:25:08,470 --> 00:25:14,140
payments will work at least<font color="#E5E5E5"> for</font><font color="#CCCCCC"> chip</font><font color="#E5E5E5"> for</font>

624
00:25:11,230 --> 00:25:16,270
<font color="#CCCCCC">Mac</font><font color="#E5E5E5"> stripe why</font><font color="#CCCCCC"> we'll simply because</font>

625
00:25:14,140 --> 00:25:19,000
during the<font color="#E5E5E5"> max type transactions reader</font>

626
00:25:16,270 --> 00:25:21,730
will not send<font color="#CCCCCC"> anything except track 2</font>

627
00:25:19,000 --> 00:25:24,760
data<font color="#E5E5E5"> encrypted track 2 data when for</font>

628
00:25:21,730 --> 00:25:27,480
example<font color="#E5E5E5"> for</font><font color="#CCCCCC"> Chip</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> PIN transactions</font><font color="#E5E5E5"> an</font>

629
00:25:24,760 --> 00:25:30,430
actual amount that was signed and

630
00:25:27,480 --> 00:25:34,810
currency<font color="#E5E5E5"> that was signed will be sent in</font>

631
00:25:30,430 --> 00:25:36,490
<font color="#CCCCCC">the cryptogram in these terms</font>

632
00:25:34,810 --> 00:25:37,990
contactless transactions are very

633
00:25:36,490 --> 00:25:41,170
interesting<font color="#E5E5E5"> because there are certain</font>

634
00:25:37,990 --> 00:25:46,140
modes<font color="#E5E5E5"> legacy modes which also allow to</font>

635
00:25:41,170 --> 00:25:49,180
send data<font color="#E5E5E5"> and will not send amount and</font>

636
00:25:46,140 --> 00:25:54,180
currency and these types of transactions

637
00:25:49,180 --> 00:25:57,130
also can be<font color="#E5E5E5"> affected and finally the</font>

638
00:25:54,180 --> 00:25:59,260
limits for every<font color="#E5E5E5"> kind of transaction for</font>

639
00:25:57,130 --> 00:26:01,840
payment providers are absolutely<font color="#E5E5E5"> insane</font>

640
00:25:59,260 --> 00:26:04,629
for like up to<font color="#CCCCCC"> 50,000</font><font color="#E5E5E5"> dollars or pounds</font>

641
00:26:01,840 --> 00:26:07,419
depending<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the region</font><font color="#E5E5E5"> which means</font><font color="#CCCCCC"> that</font>

642
00:26:04,630 --> 00:26:09,820
service providers rely only on issuing

643
00:26:07,420 --> 00:26:13,870
and acquiring<font color="#E5E5E5"> bank in terms of blocking</font>

644
00:26:09,820 --> 00:26:16,689
of<font color="#CCCCCC"> fraud Ferland transactions so let's</font>

645
00:26:13,870 --> 00:26:18,310
<font color="#E5E5E5">imagine ourselves we can open a merchant</font>

646
00:26:16,690 --> 00:26:22,000
account in less<font color="#E5E5E5"> than</font><font color="#CCCCCC"> 5</font><font color="#E5E5E5"> minutes</font>

647
00:26:18,310 --> 00:26:25,600
then we can force customer to use less

648
00:26:22,000 --> 00:26:27,970
secure form<font color="#E5E5E5"> of payments for example like</font>

649
00:26:25,600 --> 00:26:30,070
stripe instead of<font color="#E5E5E5"> chip and pin then we</font>

650
00:26:27,970 --> 00:26:32,320
can show absolutely<font color="#CCCCCC"> a</font><font color="#E5E5E5"> random amount on</font>

651
00:26:30,070 --> 00:26:34,990
the screen of a reader and<font color="#E5E5E5"> on the phone</font>

652
00:26:32,320 --> 00:26:36,939
like<font color="#CCCCCC"> one dollar for example</font><font color="#E5E5E5"> but actually</font>

653
00:26:34,990 --> 00:26:39,190
it will<font color="#E5E5E5"> be possible for</font><font color="#CCCCCC"> us to carry out</font>

654
00:26:36,940 --> 00:26:42,310
transaction<font color="#E5E5E5"> for up to fifty thousand</font>

655
00:26:39,190 --> 00:26:44,440
<font color="#E5E5E5">dollars a time and the last problem is</font>

656
00:26:42,310 --> 00:26:46,300
that for some readers<font color="#E5E5E5"> it's even possible</font>

657
00:26:44,440 --> 00:26:49,060
<font color="#E5E5E5">to make this transaction with some</font>

658
00:26:46,300 --> 00:26:51,970
significant delay for example 10 minutes

659
00:26:49,060 --> 00:26:53,620
<font color="#E5E5E5">after customer has already swiped guard</font>

660
00:26:51,970 --> 00:26:56,970
and has already left the<font color="#E5E5E5"> building which</font>

661
00:26:53,620 --> 00:27:02,139
is quite useful<font color="#CCCCCC"> for fraudulent merchants</font>

662
00:26:56,970 --> 00:27:03,400
as we mentioned<font color="#E5E5E5"> in Latin America there</font>

663
00:27:02,140 --> 00:27:07,420
are<font color="#CCCCCC"> a lot of different about</font>

664
00:27:03,400 --> 00:27:10,270
<font color="#E5E5E5">point-of-sale vendors like some up or I</font>

665
00:27:07,420 --> 00:27:12,250
<font color="#E5E5E5">settle but we just decided to find some</font>

666
00:27:10,270 --> 00:27:15,639
really local vendor and that's how we

667
00:27:12,250 --> 00:27:19,290
found clip which operates in Mexico

668
00:27:15,640 --> 00:27:22,660
<font color="#E5E5E5">two different readers and we actually</font>

669
00:27:19,290 --> 00:27:25,210
<font color="#E5E5E5">wasn't able to obtain an actual account</font>

670
00:27:22,660 --> 00:27:28,450
<font color="#E5E5E5">because</font><font color="#CCCCCC"> we had to</font><font color="#E5E5E5"> find</font><font color="#CCCCCC"> the local</font><font color="#E5E5E5"> phone</font>

671
00:27:25,210 --> 00:27:31,030
and banking account<font color="#E5E5E5"> but what we found we</font>

672
00:27:28,450 --> 00:27:34,450
<font color="#CCCCCC">found a debugging</font><font color="#E5E5E5"> application from the</font>

673
00:27:31,030 --> 00:27:36,730
vendor<font color="#E5E5E5"> and by design</font><font color="#CCCCCC"> it is quite</font>

674
00:27:34,450 --> 00:27:38,800
interesting<font color="#CCCCCC"> by design</font><font color="#E5E5E5"> and it should work</font>

675
00:27:36,730 --> 00:27:40,630
<font color="#E5E5E5">with chip and pin Mac stripe and</font>

676
00:27:38,800 --> 00:27:42,430
contactless transactions<font color="#E5E5E5"> but</font>

677
00:27:40,630 --> 00:27:44,290
<font color="#E5E5E5">surprisingly it's actually doesn't work</font>

678
00:27:42,430 --> 00:27:46,840
<font color="#E5E5E5">with contactless transactions at all</font>

679
00:27:44,290 --> 00:27:49,000
<font color="#E5E5E5">because it says that it should work with</font>

680
00:27:46,840 --> 00:27:52,330
<font color="#CCCCCC">Samsung pay only and when you actually</font>

681
00:27:49,000 --> 00:27:56,290
tap your<font color="#CCCCCC"> Samsung pay</font><font color="#E5E5E5"> it works as Mac</font>

682
00:27:52,330 --> 00:28:00,970
stripe<font color="#E5E5E5"> emulation so actually NFC reader</font>

683
00:27:56,290 --> 00:28:03,220
<font color="#E5E5E5">doesn't work in this reader Cyril so as</font>

684
00:28:00,970 --> 00:28:06,910
you can<font color="#E5E5E5"> see here is a disparate</font><font color="#CCCCCC"> queue</font>

685
00:28:03,220 --> 00:28:10,300
<font color="#CCCCCC">post mini reader</font><font color="#E5E5E5"> manufactured by Chinese</font>

686
00:28:06,910 --> 00:28:12,370
company disparate and they have a demo

687
00:28:10,300 --> 00:28:14,860
application<font color="#E5E5E5"> which you can download and</font>

688
00:28:12,370 --> 00:28:18,129
<font color="#CCCCCC">use for debugging information</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> very</font>

689
00:28:14,860 --> 00:28:20,350
useful<font color="#CCCCCC"> to get formative messages that's</font>

690
00:28:18,130 --> 00:28:23,170
how we with this<font color="#E5E5E5"> application we</font><font color="#CCCCCC"> realized</font>

691
00:28:20,350 --> 00:28:26,250
<font color="#E5E5E5">that encryption works with algorithm</font>

692
00:28:23,170 --> 00:28:30,220
which calls that BT which<font color="#E5E5E5"> is kind of</font>

693
00:28:26,250 --> 00:28:34,000
basic standard for sending of payment

694
00:28:30,220 --> 00:28:36,400
information<font color="#CCCCCC"> in encrypted way and after</font>

695
00:28:34,000 --> 00:28:39,400
<font color="#CCCCCC">intercepting</font><font color="#E5E5E5"> of sending of payment</font>

696
00:28:36,400 --> 00:28:41,980
comments we also<font color="#E5E5E5"> made kind of reverse</font>

697
00:28:39,400 --> 00:28:44,850
<font color="#CCCCCC">engineering of structure and you</font><font color="#E5E5E5"> can see</font>

698
00:28:41,980 --> 00:28:48,600
<font color="#CCCCCC">legion part which also will contain size</font>

699
00:28:44,850 --> 00:28:50,889
counter<font color="#E5E5E5"> type of comment then we have</font>

700
00:28:48,600 --> 00:28:53,290
payment information<font color="#E5E5E5"> itself which will</font>

701
00:28:50,890 --> 00:28:55,150
<font color="#E5E5E5">contain a my own currency</font><font color="#CCCCCC"> timestamp</font><font color="#E5E5E5"> some</font>

702
00:28:53,290 --> 00:28:57,370
additional information<font color="#CCCCCC"> such as type of</font>

703
00:28:55,150 --> 00:29:00,250
transactions and<font color="#CCCCCC"> so on and some</font><font color="#E5E5E5"> training</font>

704
00:28:57,370 --> 00:29:03,010
part which also will contain some

705
00:29:00,250 --> 00:29:06,510
<font color="#CCCCCC">checksum</font><font color="#E5E5E5"> which we didn't reverse yet but</font>

706
00:29:03,010 --> 00:29:08,920
what we actually found is that<font color="#CCCCCC"> for</font>

707
00:29:06,510 --> 00:29:10,690
creating a payment comment<font color="#E5E5E5"> you didn't</font>

708
00:29:08,920 --> 00:29:13,500
need to connect to<font color="#E5E5E5"> the server</font><font color="#CCCCCC"> at all</font>

709
00:29:10,690 --> 00:29:16,030
which<font color="#E5E5E5"> means you can create your own</font>

710
00:29:13,500 --> 00:29:18,810
payment comments if you will be a

711
00:29:16,030 --> 00:29:21,520
fraudulent merchant<font color="#E5E5E5"> and send it to</font>

712
00:29:18,810 --> 00:29:25,810
<font color="#E5E5E5">device pretty much the same way as we</font>

713
00:29:21,520 --> 00:29:28,900
shown before<font color="#E5E5E5"> and because there is no</font>

714
00:29:25,810 --> 00:29:32,350
signs of what actual

715
00:29:28,900 --> 00:29:34,990
payment was the<font color="#E5E5E5"> amount for payment that</font>

716
00:29:32,350 --> 00:29:37,179
was made for max<font color="#E5E5E5"> type transactions you</font>

717
00:29:34,990 --> 00:29:41,500
<font color="#E5E5E5">can see this basically this reader will</font>

718
00:29:37,180 --> 00:29:44,020
<font color="#CCCCCC">affect by our findings as well so what</font>

719
00:29:41,500 --> 00:29:46,630
actually<font color="#E5E5E5"> will do with all of</font><font color="#CCCCCC"> this first</font>

720
00:29:44,020 --> 00:29:49,450
<font color="#E5E5E5">of all we</font><font color="#CCCCCC"> obviously</font><font color="#E5E5E5"> recommend that if</font>

721
00:29:46,630 --> 00:29:53,530
you as a service provider<font color="#E5E5E5"> won't be able</font>

722
00:29:49,450 --> 00:29:55,450
<font color="#CCCCCC">to change</font><font color="#E5E5E5"> specification of communication</font>

723
00:29:53,530 --> 00:29:57,820
between reader in<font color="#E5E5E5"> the phone if you don't</font>

724
00:29:55,450 --> 00:30:00,220
<font color="#CCCCCC">have a film where for a reader</font><font color="#E5E5E5"> you still</font>

725
00:29:57,820 --> 00:30:03,189
can mitigate<font color="#CCCCCC"> these risks it's quite</font>

726
00:30:00,220 --> 00:30:05,320
central to control your mobile ecosystem

727
00:30:03,190 --> 00:30:07,420
<font color="#E5E5E5">and should not allow to use rooted</font>

728
00:30:05,320 --> 00:30:11,010
<font color="#E5E5E5">devices because rooted devices is a just</font>

729
00:30:07,420 --> 00:30:14,110
direct way<font color="#E5E5E5"> to reverse engineer the</font>

730
00:30:11,010 --> 00:30:16,360
structure of Commons and tamper any data

731
00:30:14,110 --> 00:30:19,719
a fraudulent will decide

732
00:30:16,360 --> 00:30:22,270
<font color="#E5E5E5">Vergil merchants will decide to make for</font>

733
00:30:19,720 --> 00:30:26,470
customers recommendations is much easier

734
00:30:22,270 --> 00:30:29,920
<font color="#E5E5E5">just do not use my stripe</font><font color="#CCCCCC"> what else you</font>

735
00:30:26,470 --> 00:30:33,070
found<font color="#CCCCCC"> is that sometimes it's much easier</font>

736
00:30:29,920 --> 00:30:35,230
<font color="#CCCCCC">for hackers</font><font color="#E5E5E5"> to get a full access to a</font>

737
00:30:33,070 --> 00:30:37,899
mobile point-of-sale reader than to

738
00:30:35,230 --> 00:30:40,300
traditional terminals<font color="#E5E5E5"> so all you need</font>

739
00:30:37,900 --> 00:30:43,090
<font color="#E5E5E5">for this is</font><font color="#CCCCCC"> just to get</font><font color="#E5E5E5"> a good reverser</font>

740
00:30:40,300 --> 00:30:46,629
which surprisingly works in our<font color="#CCCCCC"> company</font>

741
00:30:43,090 --> 00:30:49,090
<font color="#E5E5E5">and get an encrypted firmware so let's</font>

742
00:30:46,630 --> 00:30:52,600
briefly describe how can we're updating

743
00:30:49,090 --> 00:30:54,550
<font color="#E5E5E5">process work in the readers</font><font color="#CCCCCC"> depending</font><font color="#E5E5E5"> on</font>

744
00:30:52,600 --> 00:30:57,699
readers depending on companies there<font color="#CCCCCC"> are</font>

745
00:30:54,550 --> 00:31:00,760
many ways<font color="#CCCCCC"> to deliver updates on a device</font>

746
00:30:57,700 --> 00:31:03,160
<font color="#CCCCCC">some companies send updates</font><font color="#E5E5E5"> as a set of</font>

747
00:31:00,760 --> 00:31:05,560
encrypted<font color="#CCCCCC"> commands</font><font color="#E5E5E5"> which are then</font>

748
00:31:03,160 --> 00:31:08,620
<font color="#E5E5E5">translate in via bluetooth some of them</font>

749
00:31:05,560 --> 00:31:11,169
sending updates<font color="#E5E5E5"> as a links to encrypted</font>

750
00:31:08,620 --> 00:31:13,510
firmware as you can see on the<font color="#CCCCCC"> slide</font><font color="#E5E5E5"> and</font>

751
00:31:11,170 --> 00:31:15,730
in this case you can<font color="#E5E5E5"> try to enumerate</font>

752
00:31:13,510 --> 00:31:18,129
and obtain some<font color="#E5E5E5"> older</font><font color="#CCCCCC"> versions of a</font>

753
00:31:15,730 --> 00:31:21,400
firmware<font color="#E5E5E5"> or some debugging versions on</font>

754
00:31:18,130 --> 00:31:24,490
<font color="#E5E5E5">the</font><font color="#CCCCCC"> firmware</font><font color="#E5E5E5"> as you can see we did found</font>

755
00:31:21,400 --> 00:31:26,260
like previous version but<font color="#CCCCCC"> sometimes you</font>

756
00:31:24,490 --> 00:31:28,900
don't even<font color="#E5E5E5"> need this you didn't need</font>

757
00:31:26,260 --> 00:31:30,700
even<font color="#CCCCCC"> to open them on an account</font><font color="#E5E5E5"> having</font>

758
00:31:28,900 --> 00:31:33,850
the reader or anything like<font color="#E5E5E5"> that so all</font>

759
00:31:30,700 --> 00:31:36,180
<font color="#E5E5E5">we need</font><font color="#CCCCCC"> to just use Google</font><font color="#E5E5E5"> and find some</font>

760
00:31:33,850 --> 00:31:40,870
repositories which will lead you to

761
00:31:36,180 --> 00:31:42,700
<font color="#E5E5E5">unencrypted firmware</font><font color="#CCCCCC"> so why it's so</font>

762
00:31:40,870 --> 00:31:45,070
<font color="#E5E5E5">interesting in water and encrypted</font>

763
00:31:42,700 --> 00:31:47,380
<font color="#E5E5E5">where will contain well first of all it</font>

764
00:31:45,070 --> 00:31:50,290
is<font color="#CCCCCC"> a whole set of all configuration</font>

765
00:31:47,380 --> 00:31:52,120
files which say what type of messages

766
00:31:50,290 --> 00:31:53,470
<font color="#E5E5E5">should be displayed what messages will</font>

767
00:31:52,120 --> 00:31:56,739
be displayed what type of operations

768
00:31:53,470 --> 00:31:58,510
should<font color="#E5E5E5"> be supported</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> means that if</font>

769
00:31:56,740 --> 00:32:00,510
you<font color="#E5E5E5"> change this configuration files you</font>

770
00:31:58,510 --> 00:32:02,830
can disable chip-and-pin for example<font color="#E5E5E5"> and</font>

771
00:32:00,510 --> 00:32:05,430
finally it<font color="#E5E5E5"> is a whole set of binary</font>

772
00:32:02,830 --> 00:32:08,379
<font color="#E5E5E5">files which</font><font color="#CCCCCC"> is which are responsible for</font>

773
00:32:05,430 --> 00:32:12,010
<font color="#CCCCCC">handing</font><font color="#E5E5E5"> information and in them you can</font>

774
00:32:08,380 --> 00:32:13,810
<font color="#CCCCCC">find remote vulnerabilities as we did so</font>

775
00:32:12,010 --> 00:32:16,420
<font color="#E5E5E5">in the end</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> found the remote code</font>

776
00:32:13,810 --> 00:32:19,060
execution via<font color="#CCCCCC"> bluetooth which gave us</font>

777
00:32:16,420 --> 00:32:21,310
<font color="#E5E5E5">full root access on the reader which is</font>

778
00:32:19,060 --> 00:32:24,909
quite<font color="#CCCCCC"> good because initially</font><font color="#E5E5E5"> we didn't</font>

779
00:32:21,310 --> 00:32:27,780
expect anything<font color="#E5E5E5"> like that so why it is</font>

780
00:32:24,910 --> 00:32:30,760
so important<font color="#E5E5E5"> to get a fully compromised</font>

781
00:32:27,780 --> 00:32:33,220
<font color="#E5E5E5">mobile point-of-sale terminal one of my</font>

782
00:32:30,760 --> 00:32:36,150
<font color="#E5E5E5">favorite case happened here in</font><font color="#CCCCCC"> Latin</font>

783
00:32:33,220 --> 00:32:40,120
<font color="#CCCCCC">America when in 2014</font>

784
00:32:36,150 --> 00:32:42,910
hackers made fraudulent payments for

785
00:32:40,120 --> 00:32:46,030
thousands thousands of dollars<font color="#CCCCCC"> using</font>

786
00:32:42,910 --> 00:32:48,160
stolen<font color="#CCCCCC"> tractor data the problem</font><font color="#E5E5E5"> was that</font>

787
00:32:46,030 --> 00:32:50,710
they used<font color="#CCCCCC"> mobile point-of-sale terminal</font>

788
00:32:48,160 --> 00:32:53,260
<font color="#CCCCCC">infected probably the same way as we</font>

789
00:32:50,710 --> 00:32:56,500
described<font color="#CCCCCC"> before and they carried out</font>

790
00:32:53,260 --> 00:32:59,530
the fraudulent transactions<font color="#E5E5E5"> with stolen</font>

791
00:32:56,500 --> 00:33:01,930
<font color="#E5E5E5">thread</font><font color="#CCCCCC"> to data</font><font color="#E5E5E5"> the problem was that they</font>

792
00:32:59,530 --> 00:33:04,210
were<font color="#E5E5E5"> trying</font><font color="#CCCCCC"> to convince the issuing bank</font>

793
00:33:01,930 --> 00:33:08,890
that<font color="#CCCCCC"> turns that transactions were Chip</font>

794
00:33:04,210 --> 00:33:12,160
<font color="#CCCCCC">and PIN</font><font color="#E5E5E5"> and the most curious thing is</font>

795
00:33:08,890 --> 00:33:14,950
<font color="#E5E5E5">that original cards didn't even have</font>

796
00:33:12,160 --> 00:33:17,290
chip on<font color="#CCCCCC"> board</font><font color="#E5E5E5"> so that's how basically</font>

797
00:33:14,950 --> 00:33:23,230
<font color="#E5E5E5">acquiring</font><font color="#CCCCCC"> Bank</font><font color="#E5E5E5"> and then found out that</font>

798
00:33:17,290 --> 00:33:26,830
that was just type of unusual fraud next

799
00:33:23,230 --> 00:33:29,290
the first thing<font color="#E5E5E5"> that pops up in in our</font>

800
00:33:26,830 --> 00:33:32,080
hat is<font color="#CCCCCC"> just to</font><font color="#E5E5E5"> try to collect track</font><font color="#CCCCCC"> to</font>

801
00:33:29,290 --> 00:33:34,810
data before it<font color="#E5E5E5"> will</font><font color="#CCCCCC"> be encrypted</font><font color="#E5E5E5"> and try</font>

802
00:33:32,080 --> 00:33:38,230
to collect an encrypted<font color="#CCCCCC"> pin codes so as</font>

803
00:33:34,810 --> 00:33:40,659
we<font color="#E5E5E5"> found out the impose</font><font color="#CCCCCC"> work pretty</font><font color="#E5E5E5"> much</font>

804
00:33:38,230 --> 00:33:43,570
<font color="#CCCCCC">the same way as traditional terminals</font><font color="#E5E5E5"> or</font>

805
00:33:40,660 --> 00:33:44,020
traditional ATMs so<font color="#CCCCCC"> PIN pad has two</font>

806
00:33:43,570 --> 00:33:47,290
modes

807
00:33:44,020 --> 00:33:50,560
it has encrypted mode for entering pin

808
00:33:47,290 --> 00:33:51,750
code and has an plaintext mode for

809
00:33:50,560 --> 00:33:54,879
entering some additional information

810
00:33:51,750 --> 00:33:56,090
<font color="#CCCCCC">yeah and if you dare if</font><font color="#E5E5E5"> you have access</font>

811
00:33:54,880 --> 00:33:57,710
to<font color="#CCCCCC"> a binary file which</font>

812
00:33:56,090 --> 00:33:59,330
responsible<font color="#CCCCCC"> for switching between these</font>

813
00:33:57,710 --> 00:34:01,909
two modes<font color="#E5E5E5"> you can manipulate this</font>

814
00:33:59,330 --> 00:34:05,210
information and force customer to enter

815
00:34:01,909 --> 00:34:08,330
<font color="#CCCCCC">PIN</font><font color="#E5E5E5"> code and encrypted and finally this</font>

816
00:34:05,210 --> 00:34:11,389
small piece of hardware is<font color="#E5E5E5"> very useful</font>

817
00:34:08,330 --> 00:34:15,348
<font color="#CCCCCC">to understand how payments work in</font>

818
00:34:11,389 --> 00:34:17,300
general<font color="#E5E5E5"> how payment researchers were</font>

819
00:34:15,349 --> 00:34:19,940
working on their<font color="#CCCCCC"> project before and</font>

820
00:34:17,300 --> 00:34:24,230
create your<font color="#CCCCCC"> own security</font><font color="#E5E5E5"> research</font>

821
00:34:19,940 --> 00:34:27,320
<font color="#E5E5E5">basically as we did last problem is that</font>

822
00:34:24,230 --> 00:34:29,839
we need<font color="#CCCCCC"> to keep as it's a persistence on</font>

823
00:34:27,320 --> 00:34:33,770
<font color="#CCCCCC">the device because device potentially</font>

824
00:34:29,839 --> 00:34:36,349
have two<font color="#E5E5E5"> problems first is that it</font>

825
00:34:33,770 --> 00:34:40,310
controls its own<font color="#CCCCCC"> integrity after</font><font color="#E5E5E5"> each</font>

826
00:34:36,349 --> 00:34:43,460
rebooting<font color="#E5E5E5"> and with digital signatures</font><font color="#CCCCCC"> we</font>

827
00:34:40,310 --> 00:34:46,520
need to substitute<font color="#E5E5E5"> our digital signal</font>

828
00:34:43,460 --> 00:34:49,119
our signatures for changed files<font color="#E5E5E5"> and we</font>

829
00:34:46,520 --> 00:34:51,770
were<font color="#CCCCCC"> able to do this by just changing</font>

830
00:34:49,119 --> 00:34:54,440
<font color="#E5E5E5">these signatures because it's allowed</font><font color="#CCCCCC"> to</font>

831
00:34:51,770 --> 00:34:56,629
use self-signed certificates<font color="#E5E5E5"> and finally</font>

832
00:34:54,440 --> 00:34:58,609
mobile application also<font color="#E5E5E5"> has to check out</font>

833
00:34:56,629 --> 00:35:02,270
of<font color="#CCCCCC"> date silver and</font><font color="#E5E5E5"> not allow to use</font>

834
00:34:58,609 --> 00:35:04,730
<font color="#CCCCCC">out-of-date firmware and all you had to</font>

835
00:35:02,270 --> 00:35:06,920
bypass<font color="#CCCCCC"> this check is just to drop</font><font color="#E5E5E5"> a</font>

836
00:35:04,730 --> 00:35:09,890
packet with request or response for a

837
00:35:06,920 --> 00:35:12,170
server<font color="#E5E5E5"> and mobile application took like</font>

838
00:35:09,890 --> 00:35:14,390
a couple seconds<font color="#CCCCCC"> and after</font><font color="#E5E5E5"> timeout came</font>

839
00:35:12,170 --> 00:35:16,849
back<font color="#E5E5E5"> to you by saying</font><font color="#CCCCCC"> ok I don't care</font>

840
00:35:14,390 --> 00:35:20,660
what firmware version<font color="#E5E5E5"> ISM I'm ready to</font>

841
00:35:16,849 --> 00:35:23,000
work so in this case imagine<font color="#E5E5E5"> that you as</font>

842
00:35:20,660 --> 00:35:26,240
a fraudulent customer can get<font color="#CCCCCC"> access to</font>

843
00:35:23,000 --> 00:35:28,220
<font color="#E5E5E5">a device for couple seconds switch on</font>

844
00:35:26,240 --> 00:35:31,848
the pairing mode<font color="#E5E5E5"> connect your</font><font color="#CCCCCC"> own</font>

845
00:35:28,220 --> 00:35:34,250
malicious device and send<font color="#E5E5E5"> an exploit and</font>

846
00:35:31,849 --> 00:35:37,040
get a remote code execution on device

847
00:35:34,250 --> 00:35:39,260
then<font color="#E5E5E5"> you can bypass updating</font><font color="#CCCCCC"> process and</font>

848
00:35:37,040 --> 00:35:41,930
start to collect track<font color="#CCCCCC"> 2 data</font><font color="#E5E5E5"> and</font>

849
00:35:39,260 --> 00:35:43,089
encrypted<font color="#E5E5E5"> pinkos and</font><font color="#CCCCCC"> send it to</font><font color="#E5E5E5"> your own</font>

850
00:35:41,930 --> 00:35:46,669
<font color="#E5E5E5">server</font>

851
00:35:43,089 --> 00:35:49,490
so for these<font color="#E5E5E5"> problems we recommend</font>

852
00:35:46,670 --> 00:35:52,010
obviously not allow your<font color="#CCCCCC"> customers as a</font>

853
00:35:49,490 --> 00:35:54,259
server as<font color="#CCCCCC"> a merchant to</font><font color="#E5E5E5"> use out-of-date</font>

854
00:35:52,010 --> 00:35:55,700
film<font color="#CCCCCC"> where and especially downgrade</font>

855
00:35:54,260 --> 00:35:59,240
firmware because<font color="#E5E5E5"> this is completely</font>

856
00:35:55,700 --> 00:36:01,669
unnecessary<font color="#CCCCCC"> and we obviously</font><font color="#E5E5E5"> decided</font>

857
00:35:59,240 --> 00:36:04,250
<font color="#CCCCCC">this as soon</font><font color="#E5E5E5"> as we get a remote code</font>

858
00:36:01,670 --> 00:36:07,060
execution<font color="#CCCCCC"> to put more</font><font color="#E5E5E5"> cats on the</font>

859
00:36:04,250 --> 00:36:09,980
<font color="#CCCCCC">Internet and that was the moment</font><font color="#E5E5E5"> when</font>

860
00:36:07,060 --> 00:36:14,540
smoke should appear but<font color="#CCCCCC"> I'm</font>

861
00:36:09,980 --> 00:36:16,850
sorry<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> so I am finally</font><font color="#E5E5E5"> speaking</font>

862
00:36:14,540 --> 00:36:19,340
about<font color="#E5E5E5"> hardware yeah surprisingly was</font>

863
00:36:16,850 --> 00:36:21,618
this small and<font color="#E5E5E5"> cheap $50 devices</font>

864
00:36:19,340 --> 00:36:24,170
<font color="#CCCCCC">hardware protection in most of them are</font>

865
00:36:21,619 --> 00:36:26,210
quite<font color="#CCCCCC"> good</font><font color="#E5E5E5"> so most of them has I'm</font>

866
00:36:24,170 --> 00:36:27,950
tampering mechanisms such as anti

867
00:36:26,210 --> 00:36:30,650
tampering foil circuit protection

868
00:36:27,950 --> 00:36:33,529
<font color="#E5E5E5">against</font><font color="#CCCCCC"> raylene opening sometimes even</font>

869
00:36:30,650 --> 00:36:34,970
pressure sensors<font color="#CCCCCC"> and the</font><font color="#E5E5E5"> last problem is</font>

870
00:36:33,530 --> 00:36:37,520
that even<font color="#E5E5E5"> if you will get access to</font>

871
00:36:34,970 --> 00:36:39,560
internals<font color="#E5E5E5"> without alerting</font><font color="#CCCCCC"> engine</font>

872
00:36:37,520 --> 00:36:42,020
tampering mechanisms<font color="#E5E5E5"> all you will</font><font color="#CCCCCC"> find</font>

873
00:36:39,560 --> 00:36:44,690
on these set of proprietary protocols

874
00:36:42,020 --> 00:36:46,609
<font color="#E5E5E5">sometimes no</font><font color="#CCCCCC"> GTECH which means that</font>

875
00:36:44,690 --> 00:36:48,920
without<font color="#CCCCCC"> developers documentation without</font>

876
00:36:46,609 --> 00:36:58,730
developer certificates<font color="#E5E5E5"> you hardly will</font>

877
00:36:48,920 --> 00:37:01,760
get anything so this brings us on to<font color="#E5E5E5"> our</font>

878
00:36:58,730 --> 00:37:04,700
<font color="#E5E5E5">secretary factors so as we</font><font color="#CCCCCC"> mentioned at</font>

879
00:37:01,760 --> 00:37:07,160
the<font color="#CCCCCC"> beginning there are quite</font>

880
00:37:04,700 --> 00:37:09,560
significant differences depending<font color="#E5E5E5"> on the</font>

881
00:37:07,160 --> 00:37:11,509
vendors so we found<font color="#E5E5E5"> that actually the</font>

882
00:37:09,560 --> 00:37:13,609
level of<font color="#CCCCCC"> maturity in the</font><font color="#E5E5E5"> marketplace</font>

883
00:37:11,510 --> 00:37:16,310
isn't<font color="#CCCCCC"> that sophisticated when you</font>

884
00:37:13,609 --> 00:37:17,900
compare<font color="#E5E5E5"> it to traditional</font><font color="#CCCCCC"> bangs</font><font color="#E5E5E5"> so if</font>

885
00:37:16,310 --> 00:37:20,270
you look at the kind of checks that<font color="#CCCCCC"> are</font>

886
00:37:17,900 --> 00:37:22,300
<font color="#E5E5E5">carried out during the</font><font color="#CCCCCC"> enrollment</font>

887
00:37:20,270 --> 00:37:24,440
process<font color="#CCCCCC"> versus the</font><font color="#E5E5E5"> kind of</font>

888
00:37:22,300 --> 00:37:26,390
sophistication<font color="#E5E5E5"> that you have to go</font>

889
00:37:24,440 --> 00:37:28,790
through<font color="#E5E5E5"> with</font><font color="#CCCCCC"> a normal Bank</font><font color="#E5E5E5"> it's very</font>

890
00:37:26,390 --> 00:37:31,040
very different<font color="#E5E5E5"> also</font><font color="#CCCCCC"> when it comes to</font>

891
00:37:28,790 --> 00:37:33,259
things like<font color="#E5E5E5"> transaction monitoring we</font>

892
00:37:31,040 --> 00:37:35,540
found that most of<font color="#E5E5E5"> the vendors were very</font>

893
00:37:33,260 --> 00:37:37,850
simplistic<font color="#CCCCCC"> as to how they look at the</font>

894
00:37:35,540 --> 00:37:39,950
transactions<font color="#E5E5E5"> so they typically only look</font>

895
00:37:37,850 --> 00:37:43,250
at a small portion a<font color="#E5E5E5"> small sample of</font>

896
00:37:39,950 --> 00:37:44,868
transactions for<font color="#CCCCCC"> the own overall volume</font>

897
00:37:43,250 --> 00:37:47,619
<font color="#E5E5E5">of transactions that you're making</font><font color="#CCCCCC"> and</font>

898
00:37:44,869 --> 00:37:50,510
they only<font color="#E5E5E5"> look at very simplistic</font>

899
00:37:47,619 --> 00:37:52,580
measurements of fraud<font color="#E5E5E5"> we did find that</font>

900
00:37:50,510 --> 00:37:55,040
one specific vendor was quite

901
00:37:52,580 --> 00:37:56,569
sophisticated<font color="#CCCCCC"> in this area so not</font>

902
00:37:55,040 --> 00:37:58,850
surprisingly<font color="#CCCCCC"> Square are quite</font>

903
00:37:56,570 --> 00:38:01,400
<font color="#E5E5E5">sophisticated</font><font color="#CCCCCC"> but that's because</font><font color="#E5E5E5"> they've</font>

904
00:37:58,850 --> 00:38:03,290
<font color="#CCCCCC">been</font><font color="#E5E5E5"> around for a long</font><font color="#CCCCCC"> time so they</font>

905
00:38:01,400 --> 00:38:05,570
started<font color="#E5E5E5"> out they were the first vendors</font>

906
00:38:03,290 --> 00:38:09,320
in this area and in addition<font color="#CCCCCC"> to</font><font color="#E5E5E5"> that</font>

907
00:38:05,570 --> 00:38:10,820
they<font color="#CCCCCC"> also had for example they had a lot</font>

908
00:38:09,320 --> 00:38:14,180
<font color="#E5E5E5">of publicity around some</font><font color="#CCCCCC"> of the findings</font>

909
00:38:10,820 --> 00:38:17,150
<font color="#E5E5E5">for example the students who presented</font>

910
00:38:14,180 --> 00:38:20,118
their findings<font color="#E5E5E5"> on the mag</font><font color="#CCCCCC"> stripe</font><font color="#E5E5E5"> reader</font>

911
00:38:17,150 --> 00:38:22,310
<font color="#E5E5E5">and because of that they decided to</font><font color="#CCCCCC"> open</font>

912
00:38:20,119 --> 00:38:23,380
a bug<font color="#E5E5E5"> bounty program and we think</font><font color="#CCCCCC"> that</font>

913
00:38:22,310 --> 00:38:26,240
because<font color="#CCCCCC"> of these</font>

914
00:38:23,380 --> 00:38:27,890
<font color="#CCCCCC">they're quite sophisticated</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> terms of</font>

915
00:38:26,240 --> 00:38:29,089
how they approach security<font color="#E5E5E5"> and</font>

916
00:38:27,890 --> 00:38:31,370
transaction monitoring

917
00:38:29,090 --> 00:38:33,110
so they actually<font color="#E5E5E5"> correlate on a vast</font>

918
00:38:31,370 --> 00:38:35,779
<font color="#E5E5E5">number of different data</font><font color="#CCCCCC"> points which</font>

919
00:38:33,110 --> 00:38:38,330
means that it's quite<font color="#CCCCCC"> hard to</font><font color="#E5E5E5"> be a</font>

920
00:38:35,780 --> 00:38:40,400
fraudulent<font color="#CCCCCC"> merchant</font><font color="#E5E5E5"> or to do anything</font>

921
00:38:38,330 --> 00:38:42,049
really<font color="#E5E5E5"> suspicious with an accounts even</font>

922
00:38:40,400 --> 00:38:44,090
<font color="#CCCCCC">if you then move to a different</font><font color="#E5E5E5"> device</font>

923
00:38:42,050 --> 00:38:46,250
or you<font color="#E5E5E5"> create a new</font><font color="#CCCCCC"> accounts they're</font>

924
00:38:44,090 --> 00:38:50,120
very very good<font color="#CCCCCC"> at actually identifying</font>

925
00:38:46,250 --> 00:38:51,830
<font color="#E5E5E5">suspicious accounts and as I mentioned</font>

926
00:38:50,120 --> 00:38:53,990
there are<font color="#E5E5E5"> some differences depending on</font>

927
00:38:51,830 --> 00:38:55,850
<font color="#E5E5E5">the geographic</font><font color="#CCCCCC"> location so generally</font>

928
00:38:53,990 --> 00:38:58,250
speaking<font color="#E5E5E5"> we found that devices and</font>

929
00:38:55,850 --> 00:39:01,279
readers<font color="#CCCCCC"> in Europe were far more</font>

930
00:38:58,250 --> 00:39:03,410
<font color="#CCCCCC">restrictive</font><font color="#E5E5E5"> than those elsewhere so for</font>

931
00:39:01,280 --> 00:39:05,930
<font color="#E5E5E5">example in the</font><font color="#CCCCCC"> u.s. you</font><font color="#E5E5E5"> can carry out</font>

932
00:39:03,410 --> 00:39:08,990
<font color="#E5E5E5">offline processing offline transactions</font>

933
00:39:05,930 --> 00:39:11,560
and<font color="#E5E5E5"> MST transactions and we can't carry</font>

934
00:39:08,990 --> 00:39:14,629
<font color="#CCCCCC">out</font><font color="#E5E5E5"> these kind of transactions in Europe</font>

935
00:39:11,560 --> 00:39:16,640
<font color="#E5E5E5">we also noticed</font><font color="#CCCCCC"> that for most of</font><font color="#E5E5E5"> the</font>

936
00:39:14,630 --> 00:39:19,250
vendors<font color="#CCCCCC"> they weren't protecting the</font>

937
00:39:16,640 --> 00:39:21,799
mobile ecosystem<font color="#E5E5E5"> so this is what allowed</font>

938
00:39:19,250 --> 00:39:23,720
us<font color="#E5E5E5"> to get access</font><font color="#CCCCCC"> to things like</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> HCI</font>

939
00:39:21,800 --> 00:39:25,640
logging which provided<font color="#E5E5E5"> us with a whole</font>

940
00:39:23,720 --> 00:39:28,850
bunch of<font color="#CCCCCC"> information</font><font color="#E5E5E5"> that we</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> then</font>

941
00:39:25,640 --> 00:39:30,170
correlate with the mobile application so

942
00:39:28,850 --> 00:39:32,900
when<font color="#CCCCCC"> we spoke</font><font color="#E5E5E5"> to many of the vendors</font>

943
00:39:30,170 --> 00:39:34,850
<font color="#E5E5E5">what they said is</font><font color="#CCCCCC"> that we</font><font color="#E5E5E5"> consider the</font>

944
00:39:32,900 --> 00:39:37,010
phone to<font color="#E5E5E5"> be already compromised</font><font color="#CCCCCC"> of</font>

945
00:39:34,850 --> 00:39:39,500
<font color="#CCCCCC">course the problem with</font><font color="#E5E5E5"> this approach is</font>

946
00:39:37,010 --> 00:39:41,000
<font color="#CCCCCC">that if you</font><font color="#E5E5E5"> consider the phone to be</font>

947
00:39:39,500 --> 00:39:43,040
<font color="#E5E5E5">already compromised and you don't want</font>

948
00:39:41,000 --> 00:39:45,530
<font color="#E5E5E5">to implement any security mechanisms is</font>

949
00:39:43,040 --> 00:39:49,310
that anyone can reverse the structure of

950
00:39:45,530 --> 00:39:51,170
<font color="#CCCCCC">your device which isn't</font><font color="#E5E5E5"> very</font><font color="#CCCCCC"> good</font><font color="#E5E5E5"> so</font>

951
00:39:49,310 --> 00:39:54,529
this table<font color="#E5E5E5"> represents a broad overview</font>

952
00:39:51,170 --> 00:39:57,080
<font color="#CCCCCC">of all the different devices</font><font color="#E5E5E5"> vendors</font>

953
00:39:54,530 --> 00:39:58,640
manufacturers that we looked at<font color="#E5E5E5"> and all</font>

954
00:39:57,080 --> 00:40:02,270
the different<font color="#CCCCCC"> areas of assessment that</font>

955
00:39:58,640 --> 00:40:05,089
<font color="#E5E5E5">we carried out so as is probably</font><font color="#CCCCCC"> quite</font>

956
00:40:02,270 --> 00:40:08,000
obvious to<font color="#CCCCCC"> everyone the marketplace</font>

957
00:40:05,090 --> 00:40:09,650
places an emphasis on<font color="#CCCCCC"> usability and this</font>

958
00:40:08,000 --> 00:40:12,410
is because they're<font color="#E5E5E5"> trying to get as many</font>

959
00:40:09,650 --> 00:40:14,690
<font color="#CCCCCC">customers</font><font color="#E5E5E5"> as they possibly can the only</font>

960
00:40:12,410 --> 00:40:16,850
issue with this is that<font color="#E5E5E5"> most of the</font>

961
00:40:14,690 --> 00:40:18,560
vendors<font color="#E5E5E5"> so almost all of them don't</font>

962
00:40:16,850 --> 00:40:21,100
<font color="#E5E5E5">actually have very high security</font>

963
00:40:18,560 --> 00:40:23,540
<font color="#CCCCCC">standards which they should in fact have</font>

964
00:40:21,100 --> 00:40:25,910
<font color="#E5E5E5">because if you lower the entry barriers</font>

965
00:40:23,540 --> 00:40:27,920
to your<font color="#E5E5E5"> payment ecosystem you should in</font>

966
00:40:25,910 --> 00:40:29,450
fact have<font color="#CCCCCC"> very</font><font color="#E5E5E5"> high security mechanisms</font>

967
00:40:27,920 --> 00:40:32,120
<font color="#E5E5E5">to counteract the fact that you're</font>

968
00:40:29,450 --> 00:40:35,810
letting everybody<font color="#E5E5E5"> in which</font><font color="#CCCCCC"> isn't the</font>

969
00:40:32,120 --> 00:40:37,328
<font color="#E5E5E5">case so during this project when</font><font color="#CCCCCC"> we</font>

970
00:40:35,810 --> 00:40:40,779
looked at<font color="#E5E5E5"> our findings we</font>

971
00:40:37,329 --> 00:40:42,339
that<font color="#E5E5E5"> almost all</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the vendors that</font><font color="#CCCCCC"> we</font>

972
00:40:40,779 --> 00:40:44,890
looked at<font color="#E5E5E5"> were actually</font><font color="#CCCCCC"> affected by the</font>

973
00:40:42,339 --> 00:40:46,569
findings<font color="#E5E5E5"> and more than half of the</font>

974
00:40:44,890 --> 00:40:47,709
readers<font color="#CCCCCC"> that we looked</font><font color="#E5E5E5"> at were affected</font>

975
00:40:46,569 --> 00:40:49,690
by the vulnerabilities that<font color="#E5E5E5"> we</font>

976
00:40:47,709 --> 00:40:53,919
identified<font color="#E5E5E5"> so they were quite</font>

977
00:40:49,690 --> 00:40:56,769
<font color="#CCCCCC">far-reaching</font><font color="#E5E5E5"> findings so what does this</font>

978
00:40:53,920 --> 00:40:58,809
mean<font color="#CCCCCC"> broadly speaking for</font><font color="#E5E5E5"> looking at</font>

979
00:40:56,769 --> 00:41:01,149
risk<font color="#CCCCCC"> so it means</font><font color="#E5E5E5"> that if you're a</font>

980
00:40:58,809 --> 00:41:04,209
merchant<font color="#E5E5E5"> and you actually process card</font>

981
00:41:01,150 --> 00:41:06,219
transactions<font color="#E5E5E5"> you shouldn't use magstripe</font>

982
00:41:04,209 --> 00:41:08,440
<font color="#CCCCCC">and it's not just</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> of the</font>

983
00:41:06,219 --> 00:41:10,630
vulnerabilities we identified within

984
00:41:08,440 --> 00:41:11,920
mobile<font color="#CCCCCC"> point-of-sale</font><font color="#E5E5E5"> terminals but it's</font>

985
00:41:10,630 --> 00:41:13,869
because this protocol<font color="#CCCCCC"> is</font><font color="#E5E5E5"> actually</font>

986
00:41:11,920 --> 00:41:16,420
deprecated so as I mentioned at the

987
00:41:13,869 --> 00:41:18,039
start<font color="#E5E5E5"> there they're relatively easy it's</font>

988
00:41:16,420 --> 00:41:20,769
relatively easy<font color="#E5E5E5"> to clone the magstripe</font>

989
00:41:18,039 --> 00:41:22,180
from the back of the card you<font color="#CCCCCC"> can forge</font>

990
00:41:20,769 --> 00:41:23,738
a signature relatively easily and

991
00:41:22,180 --> 00:41:26,109
<font color="#E5E5E5">there's no signing of the transaction</font>

992
00:41:23,739 --> 00:41:28,690
<font color="#E5E5E5">and</font><font color="#CCCCCC"> if you look at how liability sits</font>

993
00:41:26,109 --> 00:41:31,180
for this kind<font color="#E5E5E5"> of model we find that</font>

994
00:41:28,690 --> 00:41:33,489
actually<font color="#E5E5E5"> merchants inherits all</font><font color="#CCCCCC"> of the</font>

995
00:41:31,180 --> 00:41:34,660
<font color="#CCCCCC">liability for a transaction so it means</font>

996
00:41:33,489 --> 00:41:37,749
if you're a merchant<font color="#E5E5E5"> and you're</font>

997
00:41:34,660 --> 00:41:40,239
processing<font color="#E5E5E5"> magstripe transactions</font><font color="#CCCCCC"> it</font>

998
00:41:37,749 --> 00:41:42,999
means that if<font color="#E5E5E5"> anything bad happens and</font>

999
00:41:40,239 --> 00:41:44,979
the mobile<font color="#E5E5E5"> point of sales terminal</font>

1000
00:41:42,999 --> 00:41:46,569
provider or the<font color="#E5E5E5"> bank identifies an issue</font>

1001
00:41:44,979 --> 00:41:48,609
<font color="#CCCCCC">it means that you'll</font><font color="#E5E5E5"> get something</font>

1002
00:41:46,569 --> 00:41:52,119
<font color="#E5E5E5">called a</font><font color="#CCCCCC"> chargeback so</font><font color="#E5E5E5"> ultimately all</font>

1003
00:41:48,609 --> 00:41:54,130
<font color="#E5E5E5">liability associated with magstripe</font>

1004
00:41:52,119 --> 00:41:56,319
<font color="#CCCCCC">sits with a</font><font color="#E5E5E5"> merchant</font><font color="#CCCCCC"> which isn't very</font>

1005
00:41:54,130 --> 00:41:58,509
good<font color="#CCCCCC"> so as a result</font><font color="#E5E5E5"> we recommend that</font>

1006
00:41:56,319 --> 00:42:01,719
<font color="#E5E5E5">everyone just uses chip as this is a</font>

1007
00:41:58,509 --> 00:42:03,729
good<font color="#E5E5E5"> way</font><font color="#CCCCCC"> to protect</font><font color="#E5E5E5"> yourself but more</font>

1008
00:42:01,719 --> 00:42:05,499
<font color="#E5E5E5">broadly speaking when</font><font color="#CCCCCC"> we think</font><font color="#E5E5E5"> about the</font>

1009
00:42:03,729 --> 00:42:08,499
kind of issues that<font color="#E5E5E5"> we're seeing with</font>

1010
00:42:05,499 --> 00:42:10,629
this marketplace<font color="#E5E5E5"> it actually applies to</font>

1011
00:42:08,499 --> 00:42:12,519
many different<font color="#CCCCCC"> areas of business so</font>

1012
00:42:10,630 --> 00:42:14,709
we've seen<font color="#E5E5E5"> a huge</font><font color="#CCCCCC"> growth in embedded</font>

1013
00:42:12,519 --> 00:42:17,399
<font color="#E5E5E5">systems</font><font color="#CCCCCC"> being used for</font><font color="#E5E5E5"> both consumer</font>

1014
00:42:14,709 --> 00:42:20,379
products and<font color="#E5E5E5"> products</font><font color="#CCCCCC"> that have been</font>

1015
00:42:17,400 --> 00:42:22,509
<font color="#E5E5E5">integrated into businesses but</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> think</font>

1016
00:42:20,380 --> 00:42:24,160
we all need<font color="#E5E5E5"> to keep in mind that most of</font>

1017
00:42:22,509 --> 00:42:27,309
<font color="#E5E5E5">these vendors have only been around</font><font color="#CCCCCC"> for</font>

1018
00:42:24,160 --> 00:42:29,410
a<font color="#CCCCCC"> few years so what this means</font><font color="#E5E5E5"> is that</font>

1019
00:42:27,309 --> 00:42:31,180
the product is<font color="#CCCCCC"> probably not going to</font><font color="#E5E5E5"> be</font>

1020
00:42:29,410 --> 00:42:35,259
as developed as something<font color="#E5E5E5"> that</font>

1021
00:42:31,180 --> 00:42:38,379
<font color="#E5E5E5">specifically developed for a corporate</font>

1022
00:42:35,259 --> 00:42:40,150
organization<font color="#E5E5E5"> so we found</font><font color="#CCCCCC"> that many of</font>

1023
00:42:38,380 --> 00:42:41,829
<font color="#E5E5E5">the products that we looked at the</font>

1024
00:42:40,150 --> 00:42:43,749
<font color="#E5E5E5">security mechanisms weren't very</font>

1025
00:42:41,829 --> 00:42:45,430
<font color="#E5E5E5">sophisticated</font><font color="#CCCCCC"> which is what you would</font>

1026
00:42:43,749 --> 00:42:47,169
<font color="#E5E5E5">expect but I don't think many of us</font>

1027
00:42:45,430 --> 00:42:50,589
<font color="#CCCCCC">consider that</font><font color="#E5E5E5"> when we're integrating</font>

1028
00:42:47,170 --> 00:42:52,750
these products<font color="#E5E5E5"> into</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> businesses</font>

1029
00:42:50,590 --> 00:42:55,810
so this brings<font color="#E5E5E5"> us on to our conclusions</font>

1030
00:42:52,750 --> 00:42:57,940
<font color="#E5E5E5">so for manufacturers we recommend that</font>

1031
00:42:55,810 --> 00:42:59,529
you implement control mechanisms over

1032
00:42:57,940 --> 00:43:01,660
firmware so that's encrypting and

1033
00:42:59,530 --> 00:43:03,040
<font color="#E5E5E5">signing firmware this helps to prevent</font>

1034
00:43:01,660 --> 00:43:06,670
against the modification<font color="#CCCCCC"> and</font>

1035
00:43:03,040 --> 00:43:08,770
interception<font color="#E5E5E5"> of firmware via sniffing we</font>

1036
00:43:06,670 --> 00:43:10,570
also recommend that<font color="#E5E5E5"> you use</font><font color="#CCCCCC"> a Bluetooth</font>

1037
00:43:08,770 --> 00:43:12,340
method that visually confirms the

1038
00:43:10,570 --> 00:43:14,530
pairing<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the intended device and the</font>

1039
00:43:12,340 --> 00:43:17,170
phone<font color="#CCCCCC"> and that's because many</font><font color="#E5E5E5"> of the</font>

1040
00:43:14,530 --> 00:43:18,880
issues<font color="#E5E5E5"> that we</font><font color="#CCCCCC"> identified involves some</font>

1041
00:43:17,170 --> 00:43:20,920
level<font color="#CCCCCC"> of physical proximity to</font>

1042
00:43:18,880 --> 00:43:23,770
communicate with the device so it's a

1043
00:43:20,920 --> 00:43:25,480
good<font color="#CCCCCC"> idea to</font><font color="#E5E5E5"> implement mechanisms which</font>

1044
00:43:23,770 --> 00:43:28,990
confirm that you<font color="#E5E5E5"> want</font><font color="#CCCCCC"> to pair the</font>

1045
00:43:25,480 --> 00:43:31,960
intended device<font color="#E5E5E5"> we did see good evidence</font>

1046
00:43:28,990 --> 00:43:34,660
<font color="#E5E5E5">of security mechanisms in the physical</font>

1047
00:43:31,960 --> 00:43:37,360
<font color="#E5E5E5">security but we didn't see good evidence</font>

1048
00:43:34,660 --> 00:43:41,649
<font color="#E5E5E5">of security being looked at overall in</font>

1049
00:43:37,360 --> 00:43:44,560
the entire<font color="#CCCCCC"> ecosystem for vendors we</font>

1050
00:43:41,650 --> 00:43:46,450
recommend that you support<font color="#CCCCCC"> deprecated</font>

1051
00:43:44,560 --> 00:43:48,509
protocols like<font color="#CCCCCC"> magstripe and you can do</font>

1052
00:43:46,450 --> 00:43:50,620
this by implementing some<font color="#E5E5E5"> sort of</font>

1053
00:43:48,510 --> 00:43:53,770
signing on<font color="#CCCCCC"> the</font><font color="#E5E5E5"> server side for example</font>

1054
00:43:50,620 --> 00:43:56,460
<font color="#CCCCCC">or</font><font color="#E5E5E5"> you can offer the ability</font><font color="#CCCCCC"> not to</font>

1055
00:43:53,770 --> 00:43:59,259
actually<font color="#E5E5E5"> take micro transactions at all</font>

1056
00:43:56,460 --> 00:44:01,570
we also<font color="#CCCCCC"> recommend that</font><font color="#E5E5E5"> you use very good</font>

1057
00:43:59,260 --> 00:44:04,240
strong<font color="#CCCCCC"> preventative monitoring practices</font>

1058
00:44:01,570 --> 00:44:05,710
<font color="#CCCCCC">so this looks like</font><font color="#E5E5E5"> correlating on vast</font>

1059
00:44:04,240 --> 00:44:07,660
different points which is<font color="#CCCCCC"> a very</font>

1060
00:44:05,710 --> 00:44:09,850
effective<font color="#CCCCCC"> way of</font><font color="#E5E5E5"> identifying fraudulent</font>

1061
00:44:07,660 --> 00:44:11,740
merchants<font color="#E5E5E5"> so instead</font><font color="#CCCCCC"> of just</font><font color="#E5E5E5"> looking at</font>

1062
00:44:09,850 --> 00:44:14,230
specifically looking at<font color="#E5E5E5"> the transactions</font>

1063
00:44:11,740 --> 00:44:16,600
and whether they look suspicious<font color="#CCCCCC"> also</font>

1064
00:44:14,230 --> 00:44:18,790
looking at what kind<font color="#E5E5E5"> of account activity</font>

1065
00:44:16,600 --> 00:44:20,890
looks like over overall where the

1066
00:44:18,790 --> 00:44:23,550
location of the device<font color="#E5E5E5"> is is</font><font color="#CCCCCC"> that a</font>

1067
00:44:20,890 --> 00:44:28,049
rooted device<font color="#E5E5E5"> have they got developers</font>

1068
00:44:23,550 --> 00:44:31,870
options enabled those kind of mechanisms

1069
00:44:28,050 --> 00:44:34,690
<font color="#CCCCCC">we also we also recommend that again</font><font color="#E5E5E5"> you</font>

1070
00:44:31,870 --> 00:44:37,299
protect the use of<font color="#CCCCCC"> firmware so that</font>

1071
00:44:34,690 --> 00:44:39,400
means that you should<font color="#E5E5E5"> control the</font>

1072
00:44:37,300 --> 00:44:41,260
versions of firmware<font color="#E5E5E5"> so as we found that</font>

1073
00:44:39,400 --> 00:44:43,030
there was<font color="#E5E5E5"> a</font><font color="#CCCCCC"> version</font><font color="#E5E5E5"> of the paypal</font>

1074
00:44:41,260 --> 00:44:45,040
firmware<font color="#E5E5E5"> and out graded vulnerable</font>

1075
00:44:43,030 --> 00:44:46,750
version<font color="#CCCCCC"> available online</font><font color="#E5E5E5"> it's a pretty</font>

1076
00:44:45,040 --> 00:44:48,910
bad<font color="#CCCCCC"> idea to do that kind of thing</font><font color="#E5E5E5"> so</font>

1077
00:44:46,750 --> 00:44:52,540
it's really important<font color="#E5E5E5"> to implement good</font>

1078
00:44:48,910 --> 00:44:54,100
practices<font color="#CCCCCC"> around that</font><font color="#E5E5E5"> and of course you</font>

1079
00:44:52,540 --> 00:44:55,720
<font color="#CCCCCC">should place more emphasis on enrollment</font>

1080
00:44:54,100 --> 00:44:58,630
checks that's<font color="#E5E5E5"> because this is</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> the</font>

1081
00:44:55,720 --> 00:45:01,299
first the<font color="#E5E5E5"> Gateway to the mobile</font><font color="#CCCCCC"> point of</font>

1082
00:44:58,630 --> 00:45:03,100
<font color="#CCCCCC">sales terminal ecosystem such really</font>

1083
00:45:01,300 --> 00:45:03,599
important to carry out very good<font color="#E5E5E5"> checks</font>

1084
00:45:03,100 --> 00:45:05,578
you

1085
00:45:03,599 --> 00:45:07,589
the enrollment<font color="#CCCCCC"> process such as carrying</font>

1086
00:45:05,579 --> 00:45:11,400
out fraud checks and running a credit

1087
00:45:07,589 --> 00:45:13,949
<font color="#CCCCCC">check as well</font><font color="#E5E5E5"> for merchants it's fairly</font>

1088
00:45:11,400 --> 00:45:16,079
<font color="#CCCCCC">simple so we recommend</font><font color="#E5E5E5"> that you don't</font>

1089
00:45:13,949 --> 00:45:19,170
actually<font color="#E5E5E5"> process magstripe transactions</font>

1090
00:45:16,079 --> 00:45:20,940
<font color="#E5E5E5">and that you control physical access</font><font color="#CCCCCC"> to</font>

1091
00:45:19,170 --> 00:45:23,489
devices<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that you can prevent things</font>

1092
00:45:20,940 --> 00:45:25,289
like modification and as we mentioned

1093
00:45:23,489 --> 00:45:27,839
<font color="#E5E5E5">many</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> attacks involves some level</font>

1094
00:45:25,289 --> 00:45:30,150
<font color="#CCCCCC">of physical</font><font color="#E5E5E5"> proximity initially to carry</font>

1095
00:45:27,839 --> 00:45:32,069
out the attack<font color="#CCCCCC"> and if you are a large</font>

1096
00:45:30,150 --> 00:45:34,499
<font color="#CCCCCC">merchant so some merchants do have a</font>

1097
00:45:32,069 --> 00:45:36,239
large<font color="#E5E5E5"> number of these terminals</font><font color="#CCCCCC"> it's a</font>

1098
00:45:34,499 --> 00:45:40,169
good<font color="#E5E5E5"> idea to</font><font color="#CCCCCC"> actually carry out an</font>

1099
00:45:36,239 --> 00:45:41,940
<font color="#E5E5E5">assessment of the environment so</font><font color="#CCCCCC"> that</font>

1100
00:45:40,170 --> 00:45:43,589
concludes<font color="#E5E5E5"> the presentation of our</font>

1101
00:45:41,940 --> 00:45:45,029
findings and I just want to<font color="#E5E5E5"> thank you</font>

1102
00:45:43,589 --> 00:45:47,069
<font color="#CCCCCC">very much for</font><font color="#E5E5E5"> listening to</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> this</font>

1103
00:45:45,029 --> 00:45:49,709
morning<font color="#CCCCCC"> and also</font><font color="#E5E5E5"> just mention</font><font color="#CCCCCC"> a couple</font>

1104
00:45:47,069 --> 00:45:53,130
<font color="#E5E5E5">of</font><font color="#CCCCCC"> our colleagues who helped us</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> Artem</font>

1105
00:45:49,709 --> 00:45:56,669
<font color="#E5E5E5">did a huge</font><font color="#CCCCCC"> amount of work reversing the</font>

1106
00:45:53,130 --> 00:45:58,859
<font color="#CCCCCC">Mura m0</font><font color="#E5E5E5"> 10 firmware and then also</font>

1107
00:45:56,670 --> 00:45:59,880
<font color="#CCCCCC">mentioned to Alexei</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> Mark who helped</font>

1108
00:45:58,859 --> 00:46:02,069
us<font color="#E5E5E5"> look at the physical security</font>

1109
00:45:59,880 --> 00:46:03,449
mechanisms within<font color="#E5E5E5"> the hardware itself</font><font color="#CCCCCC"> so</font>

1110
00:46:02,069 --> 00:46:05,400
if you have any questions let us<font color="#E5E5E5"> know</font>

1111
00:46:03,449 --> 00:46:16,479
<font color="#CCCCCC">and thank</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> very much</font>

1112
00:46:05,400 --> 00:46:16,479
[Applause]

