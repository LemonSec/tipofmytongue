1
00:00:00,060 --> 00:00:06,540
[Music]

2
00:00:21,030 --> 00:00:29,470
 very good afternoon everyone for me it is very pleasant to share with you this day the

3
00:00:29,470 --> 00:00:36,339
 invitation precisely that was made by the people of the air because they made me

4
00:00:36,340 --> 00:00:40,440
 to share this again

5
00:00:41,050 --> 00:00:50,470
 workshop I am taking just a lot a lot of the feedback I received during

6
00:00:50,470 --> 00:00:56,019
 these days after the workshop that was given

7
00:00:56,020 --> 00:01:02,790
 in the one of com and the idea is that it is and workshop is a little more interactive the

8
00:01:02,790 --> 00:01:09,030
 idea please ask all the questions through the chat that germán fernández us

9
00:01:09,030 --> 00:01:13,910
 is supporting with all their questions the idea is that they will moderate the questions

10
00:01:13,910 --> 00:01:20,759
 out there to organize ourselves but the idea is that all the questions that

11
00:01:20,760 --> 00:01:26,850
 you have in front of the subjects that we are going to treat are at least we can

12
00:01:26,850 --> 00:01:31,890
 give them an answer and if we cannot give them an answer, failing that, guide them

13
00:01:31,890 --> 00:01:37,140
 somehow for you to get the answer and many of the things that

14
00:01:37,140 --> 00:01:41,990
 Let's see, here they are part of what it is, I have been studying

15
00:01:41,990 --> 00:01:48,300
 close to reverse engineering malware analysis and there are many things that

16
00:01:48,300 --> 00:01:52,470
 They are also experience tricks that I want to share with you then

17
00:01:52,470 --> 00:01:58,590
 again I hope you enjoy it ask all the questions it will be a session

18
00:01:58,590 --> 00:02:02,720
 long but it will be divided into two stages

19
00:02:02,720 --> 00:02:09,199
 the first stage we are going to focus on everything that is packer analysis and

20
00:02:09,199 --> 00:02:15,369
 some strategies to unpack and on the other hand once we finish the

21
00:02:15,370 --> 00:02:18,790
 part of packers let's take a little

22
00:02:18,790 --> 00:02:24,220
 break and the idea is that they leave as something is released, the break would be around

23
00:02:24,220 --> 00:02:29,830
 15 minutes and we continue in the reverse engineering part, remember in

24
00:02:29,830 --> 00:02:35,230
 first stage is packers second stage reverse engineering can do all

25
00:02:35,230 --> 00:02:38,980
 the questions the idea is that it be interactive that they take advantage of this

26
00:02:38,980 --> 00:02:46,590
 opportunity and on the other hand I do not know if they saw on the question channel d

27
00:02:46,590 --> 00:02:52,980
 associated disc are the blog sommer workshops published their things and for a

28
00:02:52,980 --> 00:02:59,310
 side we have the virtual machine the image of the rap of the word state and on the other

29
00:02:59,310 --> 00:03:04,080
 side there is a yep I hope you download both things during

30
00:03:04,080 --> 00:03:08,489
 this little introduction I want you to download the two things you have

31
00:03:08,489 --> 00:03:16,319
 list your virtual machine and let the cid pass it enter it to the virtual machine

32
00:03:16,319 --> 00:03:22,738
 I'll show you how in a moment, but the idea is that in addition to the sample

33
00:03:22,739 --> 00:03:28,140
 malware that we analyzed in the last echo we are going to add another one as there is

34
00:03:28,140 --> 00:03:35,129
 a little more variety and really see how things go then now if

35
00:03:35,129 --> 00:03:42,328
 no longer being I wait and start

36
00:03:44,560 --> 00:03:49,770
 yes I'm already sharing screen without seeing my screen

37
00:03:50,860 --> 00:03:56,849
 [Music]

38
00:03:57,760 --> 00:03:59,849
 ah

39
00:04:03,520 --> 00:04:05,730
 ah

40
00:04:06,870 --> 00:04:09,870
 or

41
00:04:10,050 --> 00:04:29,550
 [Music]

42
00:04:31,810 --> 00:04:34,169
 two

43
00:04:36,110 --> 00:04:39,860
 [Music] no

44
00:04:39,860 --> 00:04:45,150
 [Music] or

45
00:04:45,150 --> 00:04:54,919
 [Music]

46
00:05:02,920 --> 00:05:05,989
 [Music]

47
00:05:13,630 --> 00:05:18,530
 ready perfect again we already have the camera

48
00:05:18,530 --> 00:05:23,698
 while the guard was vice the interest of greater analysis guy

49
00:05:23,699 --> 00:05:29,400
 the specific idea is to show you how through malware analysis

50
00:05:29,400 --> 00:05:34,799
 we can generate tools that allow us to potentiate our

51
00:05:34,800 --> 00:05:41,690
 intelligence capabilities at the level that continue in Haiti decompress

52
00:05:42,240 --> 00:05:49,419
 So basically, who am I? Who am I going to be with this talk?

53
00:05:49,419 --> 00:05:53,409
 felipe duarte i am passionate about reverse engineering i love to share

54
00:05:53,410 --> 00:05:58,240
 with you tell you a little about my experiences of my sufferings of my

55
00:05:58,240 --> 00:06:02,099
 you struggle with this reverse engineering is not

56
00:06:02,099 --> 00:06:06,920
 easy but it's something I like to share

57
00:06:06,920 --> 00:06:11,540
 I am sanctified if I have or I have greim I do not have any more but well

58
00:06:11,540 --> 00:06:15,710
 for me to get good was something supremely important and something from which

59
00:06:15,710 --> 00:06:19,900
 I am proud and it would be very good if Latin America

60
00:06:19,900 --> 00:06:24,330
 many more of us have that certification

61
00:06:24,749 --> 00:06:30,669
 again starting many times I do not know if they have seen reports of

62
00:06:30,669 --> 00:06:36,310
 malware analysis is very very very

63
00:06:36,310 --> 00:06:43,400
 named the fact of the cem and the true sometimes if they see a report of what

64
00:06:43,400 --> 00:06:47,568
 is what a malware is doing in many in many of those reports it is

65
00:06:47,569 --> 00:06:52,219
 they mention the centrals are the air code lines but they show a screenshot

66
00:06:52,219 --> 00:06:56,379
 screen with which you are at this moment

67
00:06:57,940 --> 00:07:02,100
 everyone stays as a god that is

68
00:07:02,169 --> 00:07:08,498
 This is where you start and sometimes it happens that in the eagerness we in that eagerness to

69
00:07:08,499 --> 00:07:15,430
 start analyzing manguán the first thing we want to do is analyze and

70
00:07:15,430 --> 00:07:20,229
 we think that is the most important thing about malware analysis and not really

71
00:07:20,229 --> 00:07:26,469
 it is before we sit down to analyze assembler we have to look at something and it is

72
00:07:26,469 --> 00:07:30,770
 what motivates us behind seeing that code

73
00:07:30,770 --> 00:07:36,318
 what we are looking for as well as in some cases who do exploits

74
00:07:36,319 --> 00:07:42,110
 they also look at assembler but I look at him looking for vulnerabilities we

75
00:07:42,110 --> 00:07:47,539
 we look to keep looking for that precisely that looking for what it is that I

76
00:07:47,539 --> 00:07:53,000
 I want to show you I want that in this workshop we are all clear about what it is

77
00:07:53,000 --> 00:07:57,050
 what motivates us or from the malware analysis part that pays off

78
00:07:57,050 --> 00:08:05,280
 look at this for that again we are going to get a

79
00:08:05,280 --> 00:08:11,520
 little here in couple philosophical things say out there not to your enemy and get to know yourself

80
00:08:11,520 --> 00:08:17,729
 yourself and you will come out victorious a thousand battles because that even though it was a

81
00:08:17,730 --> 00:08:21,110
 country phrase

82
00:08:21,460 --> 00:08:26,919
 precisely in the art of war and works for real battles with rifles

83
00:08:26,919 --> 00:08:34,588
 Shotguns work and it also works a bit for us in the cyber world

84
00:08:34,589 --> 00:08:40,169
 because because we are also in a war there are also enemies

85
00:08:40,169 --> 00:08:46,290
 in which you want to defend and always every day if you

86
00:08:46,290 --> 00:08:52,620
 They work in a show if they are from the blue team it will be a battle they will always be

87
00:08:52,620 --> 00:08:59,730
 in that index hand to hand trying to beat the enemy and many times

88
00:08:59,730 --> 00:09:06,779
 defending is much more complicated than attacking so something that I think is worth the

89
00:09:06,779 --> 00:09:11,430
 It is worth mentioning is that we know who against whom we face, we know

90
00:09:11,430 --> 00:09:17,888
 what tools do we have from the defense part in the cyber world that

91
00:09:17,889 --> 00:09:23,529
 skins we require and let's see if we can apply that in this

92
00:09:23,529 --> 00:09:29,020
 cybernetic world to see if suddenly we can win

93
00:09:29,020 --> 00:09:34,300
 just mentioning in this city war there are enemies as he mentions

94
00:09:34,300 --> 00:09:39,640
 these enemies and use tools and these tools can be in hotel

95
00:09:39,640 --> 00:09:44,560
 tryp book can be gregor run software there

96
00:09:44,560 --> 00:09:49,800
 many are bloggers you can even like in strike

97
00:09:49,800 --> 00:09:55,260
 one of these tools is part of that war and our enemy as such

98
00:09:55,260 --> 00:09:59,550
 If they have it clear, they know what their tools do, they use them

99
00:09:59,550 --> 00:10:05,969
 in a certain way precisely to win because they will have a motivation in many

100
00:10:05,970 --> 00:10:11,990
 cases it is the monetary component but it can also be a political component

101
00:10:11,990 --> 00:10:17,579
 there is a motivation behind them if they are clear about that motivation and therefore

102
00:10:17,579 --> 00:10:24,959
 they know what they do now how we are defending ourselves true how we are

103
00:10:24,959 --> 00:10:33,510
 doing things then many times we see our friend the coyote and

104
00:10:33,510 --> 00:10:38,689
 we just have an infinite set of tools worth millions

105
00:10:38,690 --> 00:10:44,279
 and they are not even Argentine pesos and Colombian companies are millions of

106
00:10:44,279 --> 00:10:46,699
 Dollars

107
00:10:47,800 --> 00:10:53,399
 we are always living behind it is very common if we find the lists of

108
00:10:53,399 --> 00:10:58,890
 blocking some firewalls can be seen very old with ancient gods

109
00:10:58,890 --> 00:11:03,310
 that are there and we are always

110
00:11:03,310 --> 00:11:09,209
 as behind, that is, we realize once we realize an attack

111
00:11:09,209 --> 00:11:14,920
 We added all that but the attack has already passed, it has already been done and now that then

112
00:11:14,920 --> 00:11:18,399
 we're always like with seven million dollar tools like

113
00:11:18,399 --> 00:11:23,529
 acme brand color an awesome thing but we are always behind

114
00:11:23,529 --> 00:11:30,069
 always and sometimes we also start to believe a little in things like that it is not

115
00:11:30,069 --> 00:11:34,540
 that if we do not see an attack, it is because it does not exist, you do not see that it does

116
00:11:34,540 --> 00:11:40,420
 eliminated the threat the spam arrived or a machine was infected form we have the

117
00:11:40,420 --> 00:11:47,800
 disk that's enough and let's hope for a new day really not that kind of

118
00:11:47,800 --> 00:11:52,839
 focus what it is doing is putting out a fire and here it is

119
00:11:52,840 --> 00:11:58,180
 where I come from and if I like it a lot and they will quote touring because the cryptographer

120
00:11:58,180 --> 00:12:03,589
 he was in the second world war and he is known because he

121
00:12:03,590 --> 00:12:07,610
 and his team managed to break a cryptographic scheme of a machine that

122
00:12:07,610 --> 00:12:12,310
 used by the Nazis the machine was a tool used by the Nazis

123
00:12:12,310 --> 00:12:19,579
 precisely to encrypt their communication all the messages were going to

124
00:12:19,580 --> 00:12:26,330
 through that of that machine now the issue is that the fact of being in

125
00:12:26,330 --> 00:12:29,660
 Turin he wasn't shooting he was in a

126
00:12:29,660 --> 00:12:36,290
 office he was analyzing this machine he managed to save about 14

127
00:12:36,290 --> 00:12:41,000
 20 million people because he managed to reduce the war from two to three years and

128
00:12:41,000 --> 00:12:45,950
 this was achieved because they have the allies once deciphering the code could know

129
00:12:45,950 --> 00:12:51,980
 where the nazis were going to attack and prepare for it or take people out

130
00:12:51,980 --> 00:12:56,600
 and they took certain actions and that seems important to me because we are

131
00:12:56,600 --> 00:13:01,610
 saying in our cyber war that happens many times we do not know where

132
00:13:01,610 --> 00:13:07,840
 what will be the next if we could know that because we would be

133
00:13:07,840 --> 00:13:14,000
 in an advantage that is why I like to make this comparison and I

134
00:13:14,000 --> 00:13:18,710
 like you to think that every malware sample every attack that

135
00:13:18,710 --> 00:13:26,600
 you get every phishing campaign that's like an enigma machine because

136
00:13:26,600 --> 00:13:34,520
 because it is a tool that allows the enemy to make his raise when

137
00:13:34,520 --> 00:13:38,510
 we have to reach its final end which may be or steal money steal your

138
00:13:38,510 --> 00:13:43,910
 account or it can even reach things because a little darker does not

139
00:13:43,910 --> 00:13:48,890
 we know he will have his intentions but that is the manual is a machine

140
00:13:48,890 --> 00:13:53,060
 that's a tool that helps them achieve their goals that's why it's

141
00:13:53,060 --> 00:13:58,310
 that there is a similarity now the issue is that it would pass 100 as he did tours and he

142
00:13:58,310 --> 00:14:03,410
 sat down to analyze the machine until it broke and once he broke it he took out

143
00:14:03,410 --> 00:14:06,980
 I would like to see what would happen if we did exactly the same thing, we sat down and

144
00:14:06,980 --> 00:14:10,819
 we received an attack we analyzed this sample we broke it and we looked

145
00:14:10,819 --> 00:14:18,349
 What we can get out of that is what I want us to do in this 8 then

146
00:14:18,350 --> 00:14:26,320
 Bearing this in mind now, we are going to what concerns us

147
00:14:27,379 --> 00:14:32,689
 Fernández tells me, you can decide at any time if there is any doubt in

148
00:14:32,689 --> 00:14:36,449
 the chat but what I would like please

149
00:14:36,450 --> 00:14:41,340
 confirm now we are going to open our workstation

150
00:14:41,340 --> 00:14:46,210
 in virtual box box the one that I told you to download

151
00:14:46,210 --> 00:14:51,590
 only the main screen as I have it here

152
00:14:51,590 --> 00:14:57,440
 we are going to download the zip that contains the malware samples the samples

153
00:14:57,440 --> 00:15:05,480
 points and 2 and we are going to pass it from the host to the east for that then and we go here

154
00:15:05,480 --> 00:15:15,100
 to drag and drop we give it to be bidirectional and we place ourselves exactly

155
00:15:15,100 --> 00:15:23,050
 where are the files that would be this samples and we move it from our face to

156
00:15:23,050 --> 00:15:27,849
 our view what I want is that in our virtual machine we have two

157
00:15:27,850 --> 00:15:34,260
 things we will have 17 samples points and 17

158
00:15:34,260 --> 00:15:40,610
 sighs points please confirm german let me know

159
00:15:40,610 --> 00:15:48,160
 if there are two but confirm as soon as we are we have this

160
00:15:51,440 --> 00:15:54,010
 two

161
00:16:00,240 --> 00:16:07,440
 and I'm happy waiting for someone to confirm that we are

162
00:16:07,440 --> 00:16:12,870
 at least with the machine already installed and waiting for more people to confirm as well

163
00:16:12,870 --> 00:16:19,560
 stop here so that we can give you ready please if you can confirm it would be

164
00:16:19,560 --> 00:16:25,729
 great I want us all to be at the same point we watch about two more minutes and

165
00:16:25,730 --> 00:16:31,010
 we start as such in addition to that

166
00:16:31,209 --> 00:16:39,479
 in this chat in the chat of the echo here I put a 7

167
00:16:40,640 --> 00:16:43,660
 with check list

168
00:16:44,460 --> 00:16:48,710
 the link is ready

169
00:16:48,710 --> 00:16:55,170
 are these two links are in it in the chat

170
00:16:55,170 --> 00:16:58,500
 disk

171
00:17:04,179 --> 00:17:11,439
 of evils two mythical I want we are going to go slowly calm but if I want

172
00:17:11,439 --> 00:17:15,179
 that we are all

173
00:17:22,179 --> 00:17:27,519
 and send again in any case the links 1 are the malware samples that are going to

174
00:17:27,519 --> 00:17:32,679
 review and the other is the virtual machine as such that has the tools and

175
00:17:32,679 --> 00:17:38,019
 Everything that Felipe will show in the presentation is exactly this

176
00:17:38,019 --> 00:17:41,519
 'champions' are ours

177
00:17:42,460 --> 00:17:47,620
 the machine with the tools there can take a moment unloading

178
00:17:47,620 --> 00:17:53,709
 but let's go slowly so I want us all to be in German with the

179
00:17:53,710 --> 00:17:57,960
 ask why is that

180
00:17:58,820 --> 00:18:01,820
 x

181
00:18:03,789 --> 00:18:11,470
 I do not know if those of the people who are seeing through tweets have access

182
00:18:11,470 --> 00:18:16,059
 to those links suddenly if you could confirm us so that we are all in the

183
00:18:16,059 --> 00:18:18,450
 same page

184
00:18:21,870 --> 00:18:24,379
 or not

185
00:18:29,080 --> 00:18:37,120
 We also need four people to confirm that you are ready

186
00:18:41,780 --> 00:18:44,990
 and that's it

187
00:18:45,779 --> 00:18:50,740
 remember to pass it to where our frequent samples

188
00:18:50,740 --> 00:18:53,580
 two

189
00:18:58,630 --> 00:19:08,510
 it is little unloading the cement machine before in the meantime so as not to go

190
00:19:08,510 --> 00:19:12,800
 wasting time what I'm going to show you is a little bit of what I'm going to present to you

191
00:19:12,800 --> 00:19:18,649
 the virtual machine that we have I am going to show you what tools I installed

192
00:19:18,650 --> 00:19:24,070
 more can be installed but they are some of the ones that I like to review

193
00:19:24,070 --> 00:19:31,189
 punctually good we have a normal exa editor and it is worth who

194
00:19:31,190 --> 00:19:38,120
 have one because in some houses see the data without any type of format

195
00:19:38,120 --> 00:19:43,870
 the processing will help us a lot to sustain the present

196
00:19:43,870 --> 00:19:52,979
 I have from here and yes and from here and if it is a software that allows us to take or

197
00:19:52,980 --> 00:19:58,450
 identify certain patterns certain signatures in files

198
00:19:58,450 --> 00:20:04,110
 punctually from packers then from you if he can tell you

199
00:20:04,110 --> 00:20:08,040
 if a file is probably packed or you don't remember it says here

200
00:20:08,040 --> 00:20:12,750
 It is like the first analysis for the part of determining if it is for which it is not

201
00:20:12,750 --> 00:20:19,950
 when do I have to study is like basically

202
00:20:19,950 --> 00:20:25,740
 study to be the py format is presented in a very organized way

203
00:20:25,740 --> 00:20:31,230
 you can see the libraries that matter where strings can see

204
00:20:31,230 --> 00:20:38,120
 enough interesting things and this one is also worth it we will not use

205
00:20:38,120 --> 00:20:48,050
 cf efe explorer this I like I am going to show you a trick to skip the ace

206
00:20:48,050 --> 00:20:52,320
 it's the slr sl

207
00:20:52,320 --> 00:20:57,220
 [Music] and the protection that windows implements

208
00:20:57,220 --> 00:21:03,059
 so that it is not so simple

209
00:21:03,250 --> 00:21:08,290
 good to load team to load moria of him I hope it was changed in

210
00:21:08,290 --> 00:21:12,100
 different directions that allows it not to be so easy

211
00:21:12,100 --> 00:21:19,379
 for example because they don't really know where his

212
00:21:19,380 --> 00:21:25,130
 it was loaded then it is a protection out there this can help us

213
00:21:25,130 --> 00:21:28,340
 fix that

214
00:21:29,460 --> 00:21:37,500
 then we must give this and see this does a lot of interesting things but one of

215
00:21:37,500 --> 00:21:40,760
 the most important

216
00:21:40,999 --> 00:21:46,240
 in some houses we can arrange [Music]

217
00:21:46,240 --> 00:21:53,520
 Although an executable that we extracted from memory then it could serve us but

218
00:21:53,520 --> 00:22:00,720
 is very good

219
00:22:01,990 --> 00:22:07,120
 process hacker this also helps them to see what processes we have open

220
00:22:07,120 --> 00:22:13,389
 some of the services that are working

221
00:22:13,389 --> 00:22:19,779
 process monitor that basically gives us details of the processes

222
00:22:19,779 --> 00:22:24,720
 auto rooms in case the malware generates any

223
00:22:24,720 --> 00:22:29,280
 persistence in auto rom we can see what the existence was by following a

224
00:22:29,280 --> 00:22:35,550
 service if you suddenly used the registry already some of

225
00:22:35,550 --> 00:22:40,649
 that style how to do i'm a free

226
00:22:40,650 --> 00:22:47,400
 and we are going to use this one I like it more personally I really like the

227
00:22:47,400 --> 00:22:51,920
 aida air interface is very expensive

228
00:22:51,920 --> 00:22:59,310
 a high license is around and in dollars maybe it is quite expensive

229
00:22:59,310 --> 00:23:07,110
 So for people who are starting up to now, it is not as simple for

230
00:23:07,110 --> 00:23:13,580
 that this tour so you also need to choose out there

231
00:23:14,380 --> 00:23:22,679
 this the interesting thing is that the compiler mountain then we will see both

232
00:23:22,679 --> 00:23:26,999
 assembler as compiled code for you to see in some cases at

233
00:23:26,999 --> 00:23:31,470
 Although you think that everything is more patience to compile and in some

234
00:23:31,470 --> 00:23:34,940
 cases it is easier to do it

235
00:23:37,530 --> 00:23:41,100
 we also have cider very good ideas if you want to make some kind of

236
00:23:41,100 --> 00:23:46,080
 automation with python to extract information also automatically

237
00:23:46,080 --> 00:23:51,360
 samples when they are parsing them in that space is a de vogue compiler

238
00:23:51,360 --> 00:23:58,189
 for point net there we have

239
00:23:58,510 --> 00:24:05,870
 x32 let your new open version 32 64 if you have a binary 32 se

240
00:24:05,870 --> 00:24:10,580
 use use this notice more more if you want

241
00:24:10,580 --> 00:24:14,889
 take note and pai sant community edition

242
00:24:14,950 --> 00:24:19,900
 I have it installed because there I like to program in python

243
00:24:19,900 --> 00:24:24,590
 this is where we are going to do our little automation and

244
00:24:24,590 --> 00:24:29,870
 it already has as such if you open it there is already a project called ravines and

245
00:24:29,870 --> 00:24:35,928
 that project already contains a base code that will help us to do the

246
00:24:35,929 --> 00:24:41,480
 extraction of the configuration of this Trojan this keep it out there present

247
00:24:41,480 --> 00:24:48,289
 from there it is ready to me you are going to use any other video but now

248
00:24:48,289 --> 00:24:52,419
 yes germán confirm when we launch

249
00:24:52,460 --> 00:24:57,790
 nobody is there yet, nobody has warned that they already have it

250
00:24:57,790 --> 00:25:00,830
 installed let's see an address

251
00:25:00,830 --> 00:25:04,020
 [Music]

252
00:25:04,480 --> 00:25:07,950
 against the laws like that

253
00:25:08,770 --> 00:25:13,820
 [Music] is the idea

254
00:25:14,600 --> 00:25:20,668
 without password we pass it to the virtual machine if five to three years have to

255
00:25:20,669 --> 00:25:25,259
 be here remember the drag and drop of which to put

256
00:25:25,259 --> 00:25:31,420
 address of host would have and they call it, I want it to be

257
00:25:31,420 --> 00:25:40,960
 now it's jazz and they have it there they can extract it and to extract it then

258
00:25:40,960 --> 00:25:45,810
 is co i

259
00:25:48,160 --> 00:25:55,090
 place again will be written then if extract

260
00:25:55,090 --> 00:25:57,810
 there are things

261
00:26:00,130 --> 00:26:02,820
 existed

262
00:26:04,780 --> 00:26:10,670
 2 on the floor

263
00:26:10,670 --> 00:26:14,680
 run exercise infected

264
00:26:21,690 --> 00:26:28,169
 someone seen here

265
00:26:28,170 --> 00:26:31,170
 infect

266
00:26:31,860 --> 00:26:38,639
 that's the password and no

267
00:26:38,640 --> 00:26:47,860
 with that they would already have the manual samples and now

268
00:26:47,870 --> 00:26:52,620
 you may wonder we have

269
00:26:52,620 --> 00:26:57,479
 Pérez files that are suspicious

270
00:26:57,480 --> 00:27:04,860
 when the 22 floors later and so those are the ones that have these packaged

271
00:27:04,860 --> 00:27:08,540
 options these suspicious everyone has a cowboy

272
00:27:08,540 --> 00:27:13,720
 and these are the malware samples associated with that

273
00:27:13,720 --> 00:27:20,000
 let's see how but it's already packed before we do anything

274
00:27:20,000 --> 00:27:28,120
 before we get a little crazy and remember that when the machine

275
00:27:28,120 --> 00:27:33,169
 virtual is working then we go

276
00:27:33,170 --> 00:27:38,660
 virtualbox and we're going to take a snapshot that's so in case something

277
00:27:38,660 --> 00:27:44,120
 go wrong we backtrack and we don't have to start over if we're going to

278
00:27:44,120 --> 00:27:51,709
 save the snapshot and we are going to click it at that moment we are clean by

279
00:27:51,710 --> 00:27:58,070
 please everyone save the snapshot open machine unzip the two

280
00:27:58,070 --> 00:28:04,360
 files and we take the snapshot and that's our safe self

281
00:28:05,049 --> 00:28:11,200
 while the malware samples that we are going to use confirm us, one was the

282
00:28:11,200 --> 00:28:16,310
 same as the one of ccoo that was ranges but I want to show you another

283
00:28:16,310 --> 00:28:22,149
 is this and that's why I tell you be very careful

284
00:28:22,149 --> 00:28:27,439
 where are you going to run this because if you get to run some of

285
00:28:27,440 --> 00:28:36,179
 these at least this one and this one will see what has happened

286
00:28:36,179 --> 00:28:42,950
 So be careful we're talking and that's how they realized that here I must

287
00:28:42,950 --> 00:28:46,050
 make suddenly [Music]

288
00:28:46,050 --> 00:28:55,820
 suddenly we have weird extensions suddenly we have a network very soon

289
00:28:55,910 --> 00:29:02,210
 who knows that is I am noc and we will see it working but here is a run

290
00:29:02,210 --> 00:29:08,080
 fully functional software then please keep

291
00:29:11,030 --> 00:29:13,540
 ah

292
00:29:13,910 --> 00:29:17,790
 how German tell me how things are going for

293
00:29:17,790 --> 00:29:23,779
 there we have a confirmation with the lips machine and fernando

294
00:29:23,779 --> 00:29:27,309
 ready is ready

295
00:29:28,150 --> 00:29:31,920
 hopefully there are others

296
00:29:33,710 --> 00:29:40,360
 [Music] and now for example in this case and

297
00:29:40,360 --> 00:29:44,629
 our virtual machine that the virtual machine files have been

298
00:29:44,630 --> 00:29:50,870
 encrypted seen bad that is why it is something we did not want then we closed

299
00:29:50,870 --> 00:29:54,820
 virtual machine does not matter I close

300
00:29:54,820 --> 00:30:02,310
 I go to virtual box and I return to this clean state today

301
00:30:02,310 --> 00:30:08,889
 restore rest and no need to create a restore option

302
00:30:08,890 --> 00:30:12,850
 and again l

303
00:30:12,850 --> 00:30:17,709
 and I give start we start with the clean machine

304
00:30:17,710 --> 00:30:23,980
 then remember to take the snapshot because that will save you

305
00:30:23,980 --> 00:30:29,289
 long time ready we started with our machine

306
00:30:29,289 --> 00:30:33,629
 clean without ransomware nothing linking

307
00:30:45,670 --> 00:30:51,519
 but who we already started

308
00:30:51,580 --> 00:30:57,340
 please ask all questions if you can't follow us then anyway

309
00:30:57,340 --> 00:31:01,820
 they can ask the questions if they have any doubts

310
00:31:01,820 --> 00:31:13,230
 well the first thing I always do when I face malware

311
00:31:13,230 --> 00:31:15,500
 it is

312
00:31:15,580 --> 00:31:21,919
 basically answer me these six questions always as I said in

313
00:31:21,920 --> 00:31:27,260
 some cases for the people who have not worked much with analysis of

314
00:31:27,260 --> 00:31:33,980
 malware or until now it is starting they think that from an arrival and without

315
00:31:33,980 --> 00:31:40,789
 get into the cell phone and already like in the false belief and that is

316
00:31:40,789 --> 00:31:46,340
 It is important to know assembler if it is very good to know assembler but I comment

317
00:31:46,340 --> 00:31:53,149
 one thing I do not program in assembler I played the females in some

318
00:31:53,150 --> 00:31:58,070
 cases but does not interpret it more easily than by the context in which

319
00:31:58,070 --> 00:32:03,678
 is the code and this is where one of the most important tasks if you

320
00:32:03,679 --> 00:32:09,679
 they are going to analyze more web is learn to filter code learn to obtain that

321
00:32:09,679 --> 00:32:14,419
 context of the code that you need or that the code that you

322
00:32:14,419 --> 00:32:21,770
 are interested and then look at the cell why why

323
00:32:21,770 --> 00:32:27,440
 analyze 10,000 assembler lines that can do anything from

324
00:32:27,440 --> 00:32:31,030
 save to log connect to internet

325
00:32:31,030 --> 00:32:36,600
 and unzip a file analyze 10,000 lines of code is

326
00:32:36,600 --> 00:32:42,480
 much more complicated than analyzing 100 that we know specifically extract

327
00:32:42,480 --> 00:32:47,610
 an internet component unzip it and put it save it in

328
00:32:47,610 --> 00:32:52,889
 archives and we know exactly what portion of code it does

329
00:32:52,890 --> 00:32:57,870
 that is easier to orient yourself it is easier to understand what is happening than

330
00:32:57,870 --> 00:33:01,739
 otherwise they are just lines and lines and lines and sure that you are going to

331
00:33:01,740 --> 00:33:08,160
 sit down and they will get lost then so they don't get lost just I have this

332
00:33:08,160 --> 00:33:13,290
 list whenever I feel like analyzing

333
00:33:13,290 --> 00:33:16,110
 malware first is good motivation because

334
00:33:16,110 --> 00:33:22,590
 I am going to analyze my language it may be that either light had or existed or

335
00:33:22,590 --> 00:33:28,560
 next in the organization or suddenly you see that evil for that family

336
00:33:28,560 --> 00:33:33,600
 manual can affect your organization example a ransomware that ransomware

337
00:33:33,600 --> 00:33:38,490
 be attacking companies in the health sector and you work a hospital in

338
00:33:38,490 --> 00:33:44,460
 Santiago the sample affects the business if it could affect it then it is worth it

339
00:33:44,460 --> 00:33:48,810
 analyze headquarters first half but once I receive the file I already have the last name

340
00:33:48,810 --> 00:33:54,450
 how are the files that are here what are these the question is good for

341
00:33:54,450 --> 00:34:00,240
 where do i start as achievements i find the single most important

342
00:34:00,240 --> 00:34:07,760
 and that is precisely what we are going to begin to analyze the first part is

343
00:34:07,760 --> 00:34:14,418
 ask us is the file we are seeing is packaged or not

344
00:34:14,418 --> 00:34:23,359
 for those who have no experience in the part of malware or protection of

345
00:34:23,359 --> 00:34:28,040
 binaries because packers are also used for code other than

346
00:34:28,040 --> 00:34:34,770
 malicious a pack that is like an onion

347
00:34:34,770 --> 00:34:40,149
 in the center the real program but the layers that are

348
00:34:40,149 --> 00:34:44,859
 put on the outside are simply layers that change the

349
00:34:44,859 --> 00:34:51,159
 appearance but functionality are always starting then the part

350
00:34:51,159 --> 00:34:59,730
 external that appearance and many times we are deceived if a role can easily

351
00:34:59,730 --> 00:35:06,220
 evade antivirus signatures there are packers who are by computer then to

352
00:35:06,220 --> 00:35:11,919
 each file has that the package will vary and therefore it is very easy to general

353
00:35:11,920 --> 00:35:19,119
 we go phases and this could evade systems that have to validate their

354
00:35:19,119 --> 00:35:25,050
 security by hashes heard a little further and even

355
00:35:25,050 --> 00:35:29,970
 bypass detectors by signatures as such by code sections and paking

356
00:35:29,970 --> 00:35:34,169
 mountain psycho and that can happen then from which you want to start that

357
00:35:34,170 --> 00:35:39,330
 outer layer of the onion that we have to remove and because I do

358
00:35:39,330 --> 00:35:43,410
 so much emphasis and in this workshop we are going to place so much emphasis on packers

359
00:35:43,410 --> 00:35:46,859
 because if you don't pass a toilet, forget you're going to do engineering

360
00:35:46,860 --> 00:35:53,460
 reverse the pack you are the first part of an attack almost the greatest most of

361
00:35:53,460 --> 00:35:58,230
 attacks that I have seen have to make it simple or more complicated almost

362
00:35:58,230 --> 00:36:01,339
 they are always packed

363
00:36:01,490 --> 00:36:07,100
 the bayern in addition to confusing it to protect the code makes us lose the

364
00:36:07,100 --> 00:36:11,170
 time and what we have to do is optimize time then

365
00:36:11,170 --> 00:36:17,030
 Now we start with the first question, how do we detect and pack it?

366
00:36:17,030 --> 00:36:22,209
 a file is packed let's start let's make a

367
00:36:22,209 --> 00:36:28,839
 comparison we are only going to get the suspicious 1 and in a package

368
00:36:28,839 --> 00:36:33,839
 and this if you realize are files that

369
00:36:34,109 --> 00:36:39,269
 and we are going to make a contrast between the two files first we go

370
00:36:39,269 --> 00:36:43,589
 to go to the static analysis then we are going to go to the dynamic analysis and we

371
00:36:43,589 --> 00:36:47,580
 let's see what happens the static analysis we are going to do it

372
00:36:47,580 --> 00:36:52,890
 with these tools first from telehit and if your vices one

373
00:36:52,890 --> 00:37:01,519
 It appears to me immediately wants tekis and found that there is a margin of x

374
00:37:01,519 --> 00:37:05,899
 from here difficult so that unknown he is going to give you the name in

375
00:37:05,899 --> 00:37:09,769
 some cases depending on the mar word family there is no known tie is a

376
00:37:09,769 --> 00:37:13,968
 packet generated by the attackers themselves or by the same group then

377
00:37:13,969 --> 00:37:19,309
 does not have a known signature for this software so I would not give you

378
00:37:19,309 --> 00:37:24,150
 for sure they will see with high veracity that

379
00:37:24,150 --> 00:37:31,319
 value but in this case if nothing says that I knew x a px precisely if you are

380
00:37:31,319 --> 00:37:39,569
 something malicious if you enter px poker is an executable hacker open

381
00:37:39,569 --> 00:37:41,700
 source you cannot download and can

382
00:37:41,700 --> 00:37:45,749
 doing their own tests is one of the simplest because they that was

383
00:37:45,749 --> 00:37:50,218
 then a tool for packaging and with that same tool bridges and

384
00:37:50,219 --> 00:37:56,999
 then pack in cases where you see files with a good px

385
00:37:56,999 --> 00:38:02,069
 advice and unpack without any problem but here we will understand a

386
00:38:02,069 --> 00:38:05,230
 little in the structure the functioning of the

387
00:38:05,230 --> 00:38:09,070
 paper and then we are going to use that knowledge to unpack another

388
00:38:09,070 --> 00:38:15,170
 type of files then as we said good in the case

389
00:38:15,170 --> 00:38:20,740
 from suspicious which is the packed file we know what

390
00:38:22,890 --> 00:38:26,150
 during years

391
00:38:30,960 --> 00:38:36,760
 this place arenys and a second

392
00:38:48,580 --> 00:38:51,750
 peter sainz

393
00:38:54,000 --> 00:38:57,630
 125 grams

394
00:38:58,990 --> 00:39:02,640
 in this work

395
00:39:04,010 --> 00:39:07,789
 windows

396
00:39:08,690 --> 00:39:14,300
 according to the machine it went bad

397
00:39:14,640 --> 00:39:18,690
 no more

398
00:39:19,850 --> 00:39:24,910
 and this good enter again

399
00:39:24,910 --> 00:39:31,029
 here they are we are going to pay their [ __ ] here there it is supremely big and

400
00:39:31,030 --> 00:39:38,100
 seen then waste already tells us this has vers

401
00:39:38,100 --> 00:39:44,529
 if we pass in a package also here and if he tells us no

402
00:39:44,530 --> 00:39:49,170
 package then by that in that order of ideas we could say that indeed

403
00:39:49,170 --> 00:39:54,190
 suspicious one is a file so you are while you want your knives the

404
00:39:54,190 --> 00:40:00,550
 tie because indeed it is not packaged something that I want to compare is

405
00:40:00,550 --> 00:40:05,590
 something that also serves as this measurement entropy so look at something

406
00:40:05,590 --> 00:40:09,490
 curious we already know that there is a scam that is already why not if you

407
00:40:09,490 --> 00:40:13,990
 look at the entropy of the packed file is a high entropy the

408
00:40:13,990 --> 00:40:18,330
 entropy what he means is how random in this information

409
00:40:18,330 --> 00:40:27,009
 presented in the file if you make a code and imagine that you are

410
00:40:27,010 --> 00:40:32,260
 programming if you do a code 15 impact and you do things

411
00:40:32,260 --> 00:40:36,910
 random you will not be able to understand them you need to give

412
00:40:36,910 --> 00:40:40,690
 names to variables that have an order

413
00:40:40,690 --> 00:40:46,990
 and we need that or else we would not understand now what the goal is

414
00:40:46,990 --> 00:40:55,270
 of that generally the files that have high entropy go or have some

415
00:40:55,270 --> 00:41:01,089
 enrollment routine that protects that information then we return

416
00:41:01,089 --> 00:41:07,750
 this is the entropy of chivas packages now let's look at the entropy of chivas that

417
00:41:07,750 --> 00:41:14,440
 It is not packaged if you realize it is much less it does not reach 8 it is more

418
00:41:14,440 --> 00:41:20,319
 starts here is not related the contrast that of packaging 8 is almost

419
00:41:20,319 --> 00:41:24,220
 flat i.e. there are very random values

420
00:41:24,220 --> 00:41:29,700
 and in this no that is not 8 it is lower and it is not

421
00:41:29,700 --> 00:41:36,240
 flat like the previous one if there is enough we are then this is also another

422
00:41:36,240 --> 00:41:41,100
 indicated when you look at a file with the high entropy money that we

423
00:41:41,100 --> 00:41:46,089
 can generate a hypothesis and that hypothesis is

424
00:41:46,090 --> 00:41:52,869
 the file is probably packed that is one of the analyzes that we can

425
00:41:52,869 --> 00:41:57,789
 do to determine if it is packaged 4 analyzes that we can do

426
00:41:57,789 --> 00:42:08,190
 is to go on foot study then we take we are going to take the suspicious point excel

427
00:42:08,190 --> 00:42:14,810
 and we are going to look at him we are going to look at them and sting

428
00:42:14,810 --> 00:42:19,060
 and we are going to do the same but with Beijing

429
00:42:19,240 --> 00:42:23,629
 now we are going to do a string comparison

430
00:42:23,630 --> 00:42:31,310
 I want them to see how to be a file whatever the unpacking is for

431
00:42:31,310 --> 00:42:38,259
 look at the amount of information that create object w scripts the rom has

432
00:42:38,260 --> 00:42:44,450
 [Music] explorer already except audio program there

433
00:42:44,450 --> 00:42:50,019
 a lot of interesting information since registers have out there a

434
00:42:50,019 --> 00:42:56,569
 web page a txt point go slowly and go to

435
00:42:56,570 --> 00:43:02,600
 begin to see that there is information that really has value information that

436
00:43:02,600 --> 00:43:07,370
 Yes, it would give us an idea of ​​what to do, that's why static analysis is

437
00:43:07,370 --> 00:43:13,009
 important because at least it starts him a way of telling what it is that

438
00:43:13,010 --> 00:43:17,590
 is happening or what are we dealing with

439
00:43:17,690 --> 00:43:21,620
 with the unpacked file we can see that this has camera access

440
00:43:21,620 --> 00:43:26,190
 we can see that you can upload files to the server

441
00:43:26,190 --> 00:43:32,000
 troll command delete files files download files simply by reading

442
00:43:32,000 --> 00:43:37,890
 it is very very difficult this here is a keylogger

443
00:43:37,890 --> 00:43:45,420
 in this way that keyloggers use and it is more if you have the other like this

444
00:43:45,420 --> 00:43:49,890
 you see a file with wallpaper they don't realize it has a lot of information who

445
00:43:49,890 --> 00:43:55,910
 develops use carries out its activity

446
00:43:55,910 --> 00:43:59,890
 now let's see that same file but packed

447
00:43:59,890 --> 00:44:05,650
 Let's see if there is any relevant information for us

448
00:44:05,650 --> 00:44:11,349
 relevant I insist is that which gives us the context of what we are analyzing

449
00:44:11,349 --> 00:44:20,650
 then we were talking about registry keys kilo and depending on the day

450
00:44:21,490 --> 00:44:28,848
 there are some things out there like this play sound but from everything we had seen

451
00:44:28,849 --> 00:44:33,240
 in the unpacked archive you really hardly see anything here

452
00:44:33,240 --> 00:44:39,618
 that's one of the reasons we use in patios and this then

453
00:44:39,619 --> 00:44:47,220
 now we come back here to point if I have an action and I do not see much information

454
00:44:47,220 --> 00:44:53,868
 relevant well I don't see as much as so much information

455
00:44:54,289 --> 00:44:59,220
 How is it that I gave myself how that context is

456
00:44:59,220 --> 00:45:06,069
 possible I insist it is easy about this it is not possible that we are facing

457
00:45:06,070 --> 00:45:14,440
 and we close the last thing that is super important since it was shown to everyone

458
00:45:14,440 --> 00:45:21,120
 the penalties manifested the third is let's run the file and see what

459
00:45:21,120 --> 00:45:24,600
 pass let's contrast the information on disk

460
00:45:24,600 --> 00:45:30,630
 memory and with that we can know if it is packaged or not here I mean

461
00:45:30,630 --> 00:45:34,890
 with this and finally yes

462
00:45:34,890 --> 00:45:41,700
 let us return to the analogy of the onion if in the center where the malicious and

463
00:45:41,700 --> 00:45:48,029
 the pac you are a mat so at some point that race has to disappear

464
00:45:48,029 --> 00:45:54,420
 externally, or else the malicious thing would not be executed, it would not work and always the

465
00:45:54,420 --> 00:45:58,200
 packers do this and memory so if you guys run a

466
00:45:58,200 --> 00:46:02,669
 packed file the content in memory at one point will be

467
00:46:02,670 --> 00:46:06,740
 automatically unpacked and let's do that

468
00:46:06,740 --> 00:46:11,930
 we are going to open for what to take out

469
00:46:12,349 --> 00:46:16,190
 and 1

470
00:46:16,190 --> 00:46:23,820
 let's run your floors I double click

471
00:46:24,160 --> 00:46:30,069
 is running we have a while and hopefully we know that in the meantime

472
00:46:30,069 --> 00:46:37,049
 any question is there something someone wants to make a comment

473
00:46:37,270 --> 00:46:40,020
 felipe

474
00:46:40,900 --> 00:46:47,900
 and says yes yes you can quickly repeat the packaging sample actually

475
00:46:47,900 --> 00:46:52,220
 the comparison you did at the beginning at the beginning that they just installed the

476
00:46:52,220 --> 00:46:56,040
 machine then you took a sample that is the

477
00:46:56,040 --> 00:47:00,720
 suspect 1 you took her to the detective is uncertain

478
00:47:00,720 --> 00:47:06,390
 if here is one and trust shocking

479
00:47:06,390 --> 00:47:13,200
 and compare them ready the analysis of the two analyzes that we did was on the one hand

480
00:47:13,200 --> 00:47:18,000
 We see if there is any signature to pack the suspicious, which is the one

481
00:47:18,000 --> 00:47:22,500
 section effectively matches a signature of upe x the one that is

482
00:47:22,500 --> 00:47:26,460
 unpacked not but beyond the importance of electricity was the

483
00:47:26,460 --> 00:47:31,680
 entropy so I click here a right part says entropy terms

484
00:47:31,680 --> 00:47:39,390
 I click entropy and see the entropy see the numbers entropy 7.68 this

485
00:47:39,390 --> 00:47:45,900
 bar is always 96 packed see the income graph

486
00:47:45,900 --> 00:47:52,170
 close to 8, the maximum entropy is 8 that is, it contains data very

487
00:47:52,170 --> 00:47:55,380
 random let's go here

488
00:47:55,380 --> 00:48:02,220
 If we do that same analysis, backup the unpacking, they will realize the

489
00:48:02,220 --> 00:48:08,220
 number that in this case was almost 7 points 6 here is 6 much lower

490
00:48:08,220 --> 00:48:14,640
 75 percent and not 96 and from tekit and if you tell us it is not packaged in this

491
00:48:14,640 --> 00:48:18,640
 case is packed now see the graph is

492
00:48:18,640 --> 00:48:24,170
 as more is not our flat has softens

493
00:48:24,170 --> 00:48:30,230
 keep in mind so that they get the idea and that's it

494
00:48:30,230 --> 00:48:35,440
 I think with that that was the analysis

495
00:48:39,700 --> 00:48:43,109
 Any other question

496
00:48:43,780 --> 00:48:51,880
 if adrenaline is asking if you tweet experience with packers bm

497
00:48:51,880 --> 00:48:58,319
 protect or if you were able to unpack in any of your battles

498
00:48:58,319 --> 00:49:03,600
 good to protect is that annoying is terrible

499
00:49:03,600 --> 00:49:09,220
 It depends on there are some some versions of good because if they are left but about

500
00:49:09,220 --> 00:49:15,470
 all yes and vélez

501
00:49:15,670 --> 00:49:25,280
 at the sight of brazil basically in some cases so let's say fine

502
00:49:25,280 --> 00:49:32,720
 Protect is an example but what I'm talking about

503
00:49:32,720 --> 00:49:39,500
 the files have some sections this is seen in sections they have these

504
00:49:39,500 --> 00:49:47,570
 made well sprout has several sections is much longer and if there is the

505
00:49:47,570 --> 00:49:53,470
 section of text then if they are velez me out there

506
00:49:53,910 --> 00:49:57,868
 Just in those of Brazil one works what he does is put a break point

507
00:49:57,869 --> 00:50:04,410
 in the text section and the air when catching leave secret code but it is very

508
00:50:04,410 --> 00:50:09,058
 punctual in the part of Brazil that I have managed to do that

509
00:50:09,059 --> 00:50:15,339
 but this is very [ __ ] up and because something that is [ __ ] well protected what it is about

510
00:50:15,339 --> 00:50:20,080
 to do the common of the cases is to generate

511
00:50:20,080 --> 00:50:26,680
 a virtual machine then is to generate another x86 assembler but an ascend in

512
00:50:26,680 --> 00:50:31,960
 a different virtual machine and the executable to expect

513
00:50:31,960 --> 00:50:37,170
 has the interpreter for that so to extract the code you have to

514
00:50:37,170 --> 00:50:44,680
 reverse the code to interpret the simple ones of well protect and later

515
00:50:44,680 --> 00:50:53,279
 yes and extract the code in the code behave that code to ekiza

516
00:50:53,280 --> 00:50:57,880
 but for me it is to say that they say well, it generally protects if it is with a break

517
00:50:57,880 --> 00:51:03,310
 point is curious it is curious I do not know if it is that in those of brazil maybe something that is

518
00:51:03,310 --> 00:51:07,750
 it seemed ok protect because i really tried here and if the doc takes as good

519
00:51:07,750 --> 00:51:13,420
 protex but one of by name put point in text section and he has

520
00:51:13,420 --> 00:51:18,920
 left of the coi not of rest like this if it is not terrible

521
00:51:18,920 --> 00:51:23,720
 complicated it had also has that same problem it is supremely difficult

522
00:51:23,720 --> 00:51:28,770
 then in those cases where one definitely cannot what

523
00:51:28,770 --> 00:51:33,460
 I recommend is to have a machine that is not detectable

524
00:51:33,460 --> 00:51:39,030
 easily in running on the sample and make it a

525
00:51:39,480 --> 00:51:43,910
 download the memory with

526
00:51:44,270 --> 00:51:49,570
 for ram memory for analyst and this was also can work

527
00:51:49,570 --> 00:51:53,500
 that like the alternatives that I used but actually well

528
00:51:53,500 --> 00:51:56,340
 protect this rich

529
00:52:00,130 --> 00:52:05,100
 any other questions out there I expect aggressors and I do not doubt

530
00:52:15,200 --> 00:52:18,439
 and bolt

531
00:52:18,960 --> 00:52:25,080
 ready ready perfect as he said we execute we launch the suspicious excel

532
00:52:25,080 --> 00:52:30,119
 and the process is here and what we are going to do is a comparison in which there is in

533
00:52:30,119 --> 00:52:33,750
 willing and what is in memory we are going to finish what is in memory click

534
00:52:33,750 --> 00:52:38,120
 property rights always I do not focus on the part of

535
00:52:38,120 --> 00:52:45,290
 strings click memory memory strings and I give it back to me

536
00:52:45,290 --> 00:52:52,740
 I go to the process right click itself is strings ok

537
00:52:52,740 --> 00:52:58,509
 and start looking inside these strings first I see an ip

538
00:52:58,510 --> 00:53:03,870
 I don't know why they have an idea and let's continue

539
00:53:04,440 --> 00:53:10,210
 and if not going down like this it goes down there the issue continues to appear

540
00:53:10,210 --> 00:53:15,950
 [Music] going down munícipes more and fish

541
00:53:18,020 --> 00:53:24,200
 then corner exe password

542
00:53:26,560 --> 00:53:29,929
 [Music]

543
00:53:30,099 --> 00:53:33,099
 interesting

544
00:53:33,790 --> 00:53:39,250
 there are things you are doing in these you are superiors will consist of reading from

545
00:53:39,250 --> 00:53:46,300
 I have the memory of them open but not wanting en bloc what I want to say

546
00:53:46,300 --> 00:53:51,580
 It is like that in memory it requires information that was not in the disk because I never

547
00:53:51,580 --> 00:53:57,810
 there was on disk this information was software

548
00:53:59,340 --> 00:54:01,619
 and music]

549
00:54:01,619 --> 00:54:08,549
 yes then what do I want I want to compare to almost I run something and see

550
00:54:08,549 --> 00:54:13,259
 what memory is happening things that did not happen on the disk something something is

551
00:54:13,259 --> 00:54:19,740
 there is something strange and something that can probably be us

552
00:54:19,740 --> 00:54:24,750
 hiding the information I want to run it again

553
00:54:24,750 --> 00:54:30,610
 and it seems to me that how we left it so long

554
00:54:30,610 --> 00:54:36,240
 waiting erased the part of memory

555
00:54:36,460 --> 00:54:41,500
 because he should get more information and that information should be similar to

556
00:54:41,500 --> 00:54:45,450
 the one we saw in the unpacked file

557
00:54:48,410 --> 00:54:56,069
 of post analysis let's go through that memory

558
00:54:56,069 --> 00:55:00,420
 a little bit to see if we go to the students something

559
00:55:00,420 --> 00:55:02,840
 interesting

560
00:55:03,920 --> 00:55:10,110
 this type of analysis the idea is that they are super fast because what we have

561
00:55:10,110 --> 00:55:13,430
 that starting is like filtering

562
00:55:13,950 --> 00:55:18,759
 [Music] vivox service

563
00:55:18,850 --> 00:55:21,839
 tourism

564
00:55:21,870 --> 00:55:25,750
 [Music]

565
00:55:35,600 --> 00:55:40,799
 but no this no does not work for me

566
00:55:40,800 --> 00:55:46,830
 right now let's see why but it's how I know they stay there our no

567
00:55:46,830 --> 00:55:52,350
 I was finishing everything but hey this is the other type of analysis

568
00:55:52,350 --> 00:55:55,830
 basically we look at what is in memory to see if there is a disk and we look

569
00:55:55,830 --> 00:56:00,330
 towards the end incongruities and what we see is different at least what we saw

570
00:56:00,330 --> 00:56:05,640
 here they wrote and pp and it is the good one it was the same and there is something that is already

571
00:56:05,640 --> 00:56:09,589
 protected now yes

572
00:56:09,860 --> 00:56:15,170
 I think we are all ready now to start talking about that so what

573
00:56:15,170 --> 00:56:20,339
 it is also there since we know that this sample is

574
00:56:20,339 --> 00:56:24,960
 packaging the technique and sinama said but also for the analysis of

575
00:56:24,960 --> 00:56:30,220
 entropy we determine it let's go to the obvious one

576
00:56:30,220 --> 00:56:37,850
 quickly and we will try to understand what is wrong

577
00:56:37,850 --> 00:56:44,770
 and then i opened the suspicious file one remember your floors

578
00:56:44,770 --> 00:56:50,750
 I must see once at home I'm going to click where are these little people

579
00:56:50,750 --> 00:56:55,880
 is what it will do to me is that it will send me the code it will stop me

580
00:56:55,880 --> 00:56:59,810
 code in the inti put the entry point that point where it starts

581
00:56:59,810 --> 00:57:08,630
 the list execution we stay there right now then

582
00:57:08,630 --> 00:57:13,670
 we will try to understand what is happening

583
00:57:13,670 --> 00:57:18,940
 pretend we have our onion the onion is what

584
00:57:18,940 --> 00:57:24,970
 that it is always the outer layer what we need is what is in

585
00:57:24,970 --> 00:57:27,450
 the center

586
00:57:27,610 --> 00:57:34,330
 how are we going to get there we have to avoid the package code as much as possible

587
00:57:34,330 --> 00:57:39,450
 of the code that is in that onion we have to avoid it as much as we can

588
00:57:39,450 --> 00:57:45,210
 try to capture the execution of the malware from the code at the moment

589
00:57:45,210 --> 00:57:52,290
 The mind starts out is where it really is in the center in the event of a

590
00:57:52,290 --> 00:57:57,540
 x is super easy and I want them to learn something and it is the taylor whenever

591
00:57:57,540 --> 00:58:02,540
 you look for or try to talk about marc you are going to

592
00:58:02,540 --> 00:58:07,759
 find what's called neil young the tail jump and the easiest way to

593
00:58:07,760 --> 00:58:14,060
 understand it is with vx if you realize or px starts with an instruction

594
00:58:14,060 --> 00:58:18,799
 to expel but if you start and go down it only wins towards

595
00:58:18,800 --> 00:58:21,859
 down much much much much much much

596
00:58:21,859 --> 00:58:28,660
 down they'll find out here at the end before the zeros start

597
00:58:28,660 --> 00:58:35,290
 from here are the arcs these are the zeros that is, there is no more code there

598
00:58:35,290 --> 00:58:41,440
 hay young that's the jump of the tail and a paper

599
00:58:41,440 --> 00:58:47,440
 it always executes the code of the pattern and when it has finished its execution it does

600
00:58:47,440 --> 00:58:53,799
 the queue jump so what's the point of unpacking is to skip to

601
00:58:53,799 --> 00:58:59,319
 all the code of the yard and find as quickly as possible the jump of the queue

602
00:58:59,319 --> 00:59:06,080
 again we start and go here

603
00:59:06,080 --> 00:59:11,640
 We started on this tour and here is the entry point is the code for

604
00:59:11,640 --> 00:59:16,680
 that all this is the park running all this is the functional homeland we have

605
00:59:16,680 --> 00:59:22,230
 to take the run on the tail jump

606
00:59:22,230 --> 00:59:26,479
 please confirm [Music]

607
00:59:33,009 --> 00:59:38,030
 maybe the first month and they are there if

608
00:59:38,030 --> 00:59:41,140
 they found the jump

609
00:59:52,740 --> 00:59:55,368
 something

610
00:59:57,880 --> 01:00:00,660
 and follow

611
01:00:00,970 --> 01:00:07,959
 yes yes there they are confirming a perfect felipe then remember the balance in

612
01:00:07,960 --> 01:00:15,660
 the s bayern ends his execution and par

613
01:00:15,660 --> 01:00:21,470
 execution and the original code what we are going to do is put

614
01:00:21,470 --> 01:00:28,520
 a break point here for that efe 2 r2 in the jump in this exact of

615
01:00:28,520 --> 01:00:33,240
 the tail and that will put this red box on us

616
01:00:33,240 --> 01:00:38,950
 now and we put the break point and we are going to execute that is going to be a we are going to give

617
01:00:38,950 --> 01:00:48,100
 control or f9 and you will realize that I already do here at this moment in this

618
01:00:48,100 --> 01:00:52,930
 right now he has already executed all the code of the whole package

619
01:00:52,930 --> 01:00:57,470
 we are not really interested in understanding the patio unless you

620
01:00:57,470 --> 01:01:03,319
 want to make a tool that wants packages automatically but in the

621
01:01:03,319 --> 01:01:07,880
 common of the cases yes because the packers are of the parts

622
01:01:07,880 --> 01:01:13,010
 code that changes the most because the first part that is protected then

623
01:01:13,010 --> 01:01:18,619
 What we are going to do is simply let's give it a step

624
01:01:18,619 --> 01:01:22,040
 eaton that's what he's going to do is let's

625
01:01:22,040 --> 01:01:27,690
 jump and this is the one in tripoli known as

626
01:01:27,690 --> 01:01:34,160
 oh piqué or the pp originally point that is the

627
01:01:34,160 --> 01:01:42,170
 original code of the binary this is the code that really is that package to

628
01:01:42,170 --> 01:01:47,370
 times the center remember again what we have to

629
01:01:47,370 --> 01:01:51,509
 to do is search within the code for the queue to jump after

630
01:01:51,510 --> 01:01:57,870
 from the jump of the tail we follow him and it is what he is going to take us is lori the ipi who

631
01:01:57,870 --> 01:02:03,839
 It is the original entry point the subject here is good I already have it I do not have

632
01:02:03,840 --> 01:02:08,400
 memory you already debug how we can know that he

633
01:02:08,400 --> 01:02:14,400
 it is also unpacked in our de bouwer right click search for curran

634
01:02:14,400 --> 01:02:21,349
 rision string reference only right click any part of the sescam

635
01:02:21,349 --> 01:02:28,940
 search for your own 36 gain account that in the strings already begin to exist

636
01:02:28,940 --> 01:02:33,529
 information that was what we saw in the unpacked table then

637
01:02:33,529 --> 01:02:38,660
 we are indeed in an unpacking section

638
01:02:38,660 --> 01:02:47,009
 but the matter is good good I have how I get the content of that pack

639
01:02:47,010 --> 01:02:55,290
 promptly right click on plugins joined x and we will hit the process lo

640
01:02:55,290 --> 01:02:58,130
 what are we going to tell them

641
01:02:58,170 --> 01:03:05,710
 first click on get and I saw from that thing which is translation

642
01:03:05,710 --> 01:03:10,770
 y y haiti is the extended instructions

643
01:03:10,770 --> 01:03:17,490
 pointer is the axis basically in the current direction that the processor is

644
01:03:17,490 --> 01:03:22,979
 executing and extending pointer statement and that in our case is where

645
01:03:22,980 --> 01:03:29,010
 is the black line and state then where is the black line is the same

646
01:03:29,010 --> 01:03:34,200
 value of that register and we know that this is the entry pong the ibi that

647
01:03:34,200 --> 01:03:38,279
 it would be the original 20 bridge that is to say what I was telling you is the new and

648
01:03:38,280 --> 01:03:43,770
 stable that we are going to extract from memory is going to have as in tripoli this

649
01:03:43,770 --> 01:03:47,970
 address which is the address of the executable

650
01:03:47,970 --> 01:03:54,459
 If you have any questions please let me know but

651
01:03:54,460 --> 01:03:59,170
 but that's what to do here we don't do anything else

652
01:03:59,170 --> 01:04:02,700
 we give you virtual offset fix

653
01:04:02,890 --> 01:04:08,520
 and the august and now we are going to save to save

654
01:04:08,520 --> 01:04:12,130
 [Music] period

655
01:04:12,130 --> 01:04:18,220
 well that what generates us is a new file here but there is something with this

656
01:04:18,220 --> 01:04:24,700
 action if I executed it bringing it does not work for me, that is, the executable

657
01:04:24,700 --> 01:04:34,240
 It is unpacked but I don't know why what happens is that when windows loads

658
01:04:34,240 --> 01:04:40,200
 executable memory in what it basically does is

659
01:04:41,250 --> 01:04:50,130
 in the memory of the process to copy and paste the libraries that it requires is

660
01:04:50,130 --> 01:04:55,920
 say on disk he has a table that tells windows it needs a library

661
01:04:55,920 --> 01:04:58,660
 loses taylor

662
01:04:58,660 --> 01:05:01,750
 [Music]

663
01:05:02,400 --> 01:05:07,630
 I need the dx digital libraries that are started by windows windows when

664
01:05:07,630 --> 01:05:14,350
 it loads it in what it does is in memory copy the libraries his is like

665
01:05:14,350 --> 01:05:17,660
 so that means what a strange place

666
01:05:17,660 --> 01:05:24,319
 memory I no longer have that table of imports does not exist what you can

667
01:05:24,319 --> 01:05:29,180
 tell windows which of the stje because windows does not load from your windows what

668
01:05:29,180 --> 01:05:33,499
 load are his, it is as such that is precisely why this does not work that

669
01:05:33,499 --> 01:05:37,640
 does not have the duties does not have the table of imports is called or by air

670
01:05:37,640 --> 01:05:43,150
 andrés table and you care father stein what we have to do is fix

671
01:05:43,150 --> 01:05:51,670
 How to fix it, we click in line, we click on hijate auto search

672
01:05:51,670 --> 01:05:57,079
 basically this tells the software we are going to automatically search the table

673
01:05:57,079 --> 01:06:04,599
 of imports of the file when I give it here I put no

674
01:06:04,599 --> 01:06:10,910
 the month here the baker imports action addresses and these are the imports

675
01:06:10,910 --> 01:06:16,939
 real that they use now I already have the amounts to use this portal is

676
01:06:16,939 --> 01:06:23,209
 packaging only build the original run the one that breaks masters and for that you

677
01:06:23,209 --> 01:06:28,370
 we give the fix town I look for it

678
01:06:28,380 --> 01:06:35,700
 what would this be where ok and if you do that you will end up on the album with

679
01:06:35,700 --> 01:06:42,750
 another file the difference is that it has if they execute it if I run

680
01:06:42,750 --> 01:06:54,650
 this is that is a way that in this one it was already effectively done like all the

681
01:06:54,650 --> 01:07:01,380
 procedure but this one already saw the file completely extracted from my

682
01:07:01,380 --> 01:07:06,320
 memory I don't know if you have any questions

683
01:07:09,079 --> 01:07:15,180
 felipe look here ignacio 138 says i didn't understand what he would be

684
01:07:15,180 --> 01:07:21,089
 I jump the tail and this quickly

685
01:07:21,440 --> 01:07:26,590
 same again we are here

686
01:07:26,590 --> 01:07:32,830
 e the entry point of the patio this is code

687
01:07:32,830 --> 01:07:39,100
 from paquera seen the bayern code is going to be executed it is going to remove all this

688
01:07:39,100 --> 01:07:44,150
 it's going to be yard code all of this is hang up for the jump

689
01:07:44,150 --> 01:07:49,789
 of the queue tells the instant in which the paper code is abandoned and is given

690
01:07:49,789 --> 01:07:56,230
 control to the original code because it is the highest in the queue because it is

691
01:07:57,310 --> 01:08:03,340
 to cease to exist as to want to already give it execution of the code

692
01:08:03,340 --> 01:08:07,760
 original confirms me cinema yes it was clear or not

693
01:08:07,760 --> 01:08:10,360
 understood

694
01:08:27,460 --> 01:08:30,270
 Sure

695
01:08:32,279 --> 01:08:38,809
 of the same I think so

696
01:08:41,050 --> 01:08:47,760
 if still lose lic now the question is why am I

697
01:08:47,760 --> 01:08:56,290
 unpacking vx well what happens is that vx we can certain things and that is

698
01:08:56,290 --> 01:09:04,240
 and finally, there are different types of packers but I would say they are

699
01:09:04,240 --> 01:09:11,589
 comfortable let's say that everything would be divided into two specific classes the packers that

700
01:09:11,589 --> 01:09:18,939
 they inject code into external processes for example in an explorer point or generate

701
01:09:18,939 --> 01:09:22,589
 a new instance of himself direct into him

702
01:09:22,589 --> 01:09:28,889
 in itself that also later has happened or there are packers that what they do is

703
01:09:28,889 --> 01:09:35,488
 rewrite your code in memory that is, windows loads the code as it was

704
01:09:35,488 --> 01:09:40,709
 on disk they remain in memory the paper is executed we are going to execute what is going to

705
01:09:40,710 --> 01:09:46,790
 to do is rewrite it in memory then basically it is erased and

706
01:09:46,790 --> 01:09:52,528
 write the code again but already the code unpacked

707
01:09:52,529 --> 01:09:57,679
 understand which type of any we are dealing with allows to know the api

708
01:09:57,679 --> 01:10:04,230
 of windows that we are going to follow and this why because for example if we are going to

709
01:10:04,230 --> 01:10:08,549
 we're dealing with a yard that rewrites itself what we should

710
01:10:08,550 --> 01:10:15,320
 search is an app that allows a process to rewrite the

711
01:10:15,320 --> 01:10:21,269
 the permissions in memory yes because when windows +

712
01:10:21,270 --> 01:10:27,380
 load the load this section will only be for him

713
01:10:27,470 --> 01:10:34,400
 for example reading now if the biker needs to rewrite the need

714
01:10:34,400 --> 01:10:42,710
 reassign those permissions put write on all and let's say rewrite

715
01:10:42,710 --> 01:10:47,510
 your code and later if executing in that order of ideas there is an api that is

716
01:10:47,510 --> 01:10:50,990
 super important that is virtual prophetic

717
01:10:50,990 --> 01:10:58,160
 millward protect allows you to change the protection options for a section of

718
01:10:58,160 --> 01:11:00,610
 memory

719
01:11:01,440 --> 01:11:06,150
 to an executable here if the documentation or tax is called

720
01:11:06,150 --> 01:11:10,320
 basically receives a size an address to which it is going to do the

721
01:11:10,320 --> 01:11:17,190
 change and in the new ones the new one with the new flags that you will use to

722
01:11:17,190 --> 01:11:22,889
 so that for that section then if you go here to efe l

723
01:11:22,890 --> 01:11:28,040
 and it will be a constant protection they will realize

724
01:11:28,040 --> 01:11:34,420
 what would be the constants that can be written

725
01:11:34,420 --> 01:11:39,530
 well they can be assigned to a memory section in a read execution merge

726
01:11:39,530 --> 01:11:43,190
 execution read and write and so on

727
01:11:43,190 --> 01:11:47,929
 now returning to what interests us our packers we know that it is rewritten

728
01:11:47,930 --> 01:11:53,739
 that is to say that it is written well our country is rewritten and

729
01:11:53,739 --> 01:11:58,808
 rewrite which address the own address where it was loaded in execute

730
01:11:58,809 --> 01:12:03,630
 the paper then that is a good indication if a

731
01:12:03,630 --> 01:12:09,150
 process is that it uses virtual protect and applies to itself

732
01:12:09,150 --> 01:12:14,160
 likewise the same memory space where the I will execute was loaded wants

733
01:12:14,160 --> 01:12:19,440
 say who is going to make some changes at the level either in the protections

734
01:12:19,440 --> 01:12:24,929
 so it's probably going to rewrite something it's going to be with that that's a good

735
01:12:24,930 --> 01:12:31,650
 indication that the package is working and it is exactly what I want

736
01:12:31,650 --> 01:12:36,789
 let them see the team with him

737
01:12:36,789 --> 01:12:40,949
 but what we are going to do is

738
01:12:41,860 --> 01:12:49,190
 and here on the track in this one what it does is reload it and I give it here to break the

739
01:12:49,190 --> 01:12:54,489
 fence we are back in tripoli and now what we are going to do is

740
01:12:54,489 --> 01:13:03,110
 put a break point in virtual thanks as I put previous control more than that

741
01:13:03,110 --> 01:13:10,630
 this comes out is this painting and here I go for virtual

742
01:13:11,770 --> 01:13:19,670
 I give it ok and I'm going to put a break point control

743
01:13:21,610 --> 01:13:29,999
 and execute and at this moment the code is

744
01:13:30,460 --> 01:13:35,590
 it stopped in virtual protect that is, our dvx packer is doing some

745
01:13:35,590 --> 01:13:39,890
 modification let's see what station modification

746
01:13:39,890 --> 01:13:45,210
 we are going to make a comparison then the first parameter is the direction in

747
01:13:45,210 --> 01:13:51,210
 which address is going to apply the change in address 400.000 now let's look at a

748
01:13:51,210 --> 01:13:56,420
 thing let's follow that address which is the map in the memory map the address

749
01:13:56,420 --> 01:14:04,350
 400,000 is where the same executable was loaded, that is, it will make changes to

750
01:14:04,350 --> 01:14:09,440
 the permissions in his own memory space at the site where he was uploaded

751
01:14:09,440 --> 01:14:14,639
 curious let's see what changes a field makes is going to be

752
01:14:14,640 --> 01:14:19,500
 this is the length of the change and this is the permission that you are going to put and we are going to

753
01:14:19,500 --> 01:14:28,220
 look for the 04 that would be that appears here 0 4 wright com

754
01:14:28,850 --> 01:14:32,820
 then and here what would allow us is how

755
01:14:32,820 --> 01:14:37,070
 write he will try

756
01:14:37,560 --> 01:14:43,420
 writing in this section rides something that really that section is not going to

757
01:14:43,420 --> 01:14:45,930
 to admit

758
01:14:46,980 --> 01:14:53,650
 that is, of that section 400,000 writing, reading and writing

759
01:14:53,650 --> 01:14:58,820
 packer will write interesting but then

760
01:14:58,820 --> 01:15:03,710
 this I am here is what I want you to keep in mind is writing in your

761
01:15:03,710 --> 01:15:07,280
 same base and it will write and it will change the permissions to read and

762
01:15:07,280 --> 01:15:12,309
 written ready because that's important let's

763
01:15:12,310 --> 01:15:14,760
 remove [Music]

764
01:15:14,760 --> 01:15:21,520
 we are going to compress from this little arrow point an arrow and 6 walton if you click there

765
01:15:21,520 --> 01:15:27,700
 it reaches this part where they matter and now we are going to press

766
01:15:27,700 --> 01:15:37,599
 step out of 8 now see where we are at this moment we are we just

767
01:15:37,600 --> 01:15:43,050
 leave a virtual a vile protect see what

768
01:15:43,050 --> 01:15:47,790
 so close is the virtual tail jump protector is pretty close

769
01:15:47,790 --> 01:15:51,650
 it really is very close they don't have to go down that much

770
01:15:51,650 --> 01:15:57,080
 that's exactly what I wanted, that's why we started with a px and we already changed

771
01:15:57,080 --> 01:16:00,380
 paper if you make a break point in

772
01:16:00,380 --> 01:16:06,290
 virtual protect later they see that virtual protects here in that break away and

773
01:16:06,290 --> 01:16:12,590
 the file is rewriting its image in the space where it was initially

774
01:16:12,590 --> 01:16:18,110
 loaded if you give back again code as we did and

775
01:16:18,110 --> 01:16:22,309
 go down a little they will find the famous jump of the tail

776
01:16:22,310 --> 01:16:27,260
 that in vx are not really needed but I'm going to show you why in

777
01:16:27,260 --> 01:16:32,710
 other packers yes yes I understand this logic well

778
01:16:32,710 --> 01:16:36,710
 please if you have questions ask the jons

779
01:16:36,710 --> 01:16:40,640
 where we are going to apply is precisely this but more difficult a little more more

780
01:16:40,640 --> 01:16:44,530
 complicated but it's exactly this same light

781
01:16:44,530 --> 01:16:47,608
 [Music]

782
01:16:48,909 --> 01:16:51,929
 there is a question

783
01:16:59,970 --> 01:17:07,829
 apparently very a text so that means that it is all

784
01:17:07,829 --> 01:17:15,358
 and remember what I told you virtual nursery respond virtual protect let's go

785
01:17:15,359 --> 01:17:20,010
 to verify that virtual protect rewrites its own image

786
01:17:20,010 --> 01:17:23,320
 that is, generally the base where it was loaded

787
01:17:23,320 --> 01:17:29,920
 s 400,000 we see that that number is out there and we return to the code of the

788
01:17:29,920 --> 01:17:36,130
 park and we look in the code for the jump of the queue then we will

789
01:17:36,130 --> 01:17:41,199
 save these files we are going to put aside these two we were going to take our

790
01:17:41,199 --> 01:17:44,669
 second file that is

791
01:17:45,610 --> 01:17:50,630
 your titles 2 this is the package file

792
01:17:50,630 --> 01:17:53,560
 However

793
01:17:53,940 --> 01:17:59,549
 the logic that I tell you is exact from the same dvx to untie the web but

794
01:17:59,550 --> 01:18:05,680
 now change many things then and we charge with vertigo that we go

795
01:18:05,680 --> 01:18:08,700
 Aron

796
01:18:09,130 --> 01:18:12,989
 we had the code this is the code on paper

797
01:18:12,989 --> 01:18:17,308
 and in this code the role if we start to go down is not easy

798
01:18:17,309 --> 01:18:24,830
 tail jump no it's not so trivial what are we going to do

799
01:18:24,830 --> 01:18:31,450
 to be safe we ​​are going to do what we did in the previous break point

800
01:18:31,450 --> 01:18:34,530
 and the protector

801
01:18:35,920 --> 01:18:40,050
 lijo we are going to put our king can invite

802
01:18:40,050 --> 01:18:46,980
 Today's protector play dropped the project however

803
01:18:46,980 --> 01:18:53,849
 if they realize it is not rewriting the site where it was originally uploaded

804
01:18:53,850 --> 01:18:58,800
 that would be the 4 and suspicious point s that was the one we loaded is in the direction

805
01:18:58,800 --> 01:19:05,150
 400,000 but permits are being given to another section

806
01:19:05,150 --> 01:19:10,509
 And precisely what permission this time is giving 40 let's look here at 40 which is

807
01:19:10,510 --> 01:19:17,429
 reading writing and execution that is very curious then how I am

808
01:19:17,429 --> 01:19:21,540
 curious to right click and I'll just give windows

809
01:19:21,540 --> 01:19:27,360
 see this this is the section to which this executable intends to give permissions

810
01:19:27,360 --> 01:19:29,750
 of electro

811
01:19:31,790 --> 01:19:36,980
 Yes normally play but that change again we returned

812
01:19:36,980 --> 01:19:45,459
 to be determined and this virtual protect if it is going to be a change over 400,000

813
01:19:45,460 --> 01:19:52,600
 Now what I want to show you is that this coast is here, I'm here, yes

814
01:19:52,600 --> 01:19:58,470
 you recognize a little the eyes this is simple

815
01:19:58,470 --> 01:20:04,260
 and you can see it is in index form I sowed I am here in the initial section of the

816
01:20:04,260 --> 01:20:10,380
 first virtual protector is to say the manual 'la loca' a new

817
01:20:10,380 --> 01:20:16,650
 section is unzip the court and executed this is that fence is that

818
01:20:16,650 --> 01:20:20,820
 However, this is the effect that is part of the paper process, that is, it is

819
01:20:20,820 --> 01:20:27,570
 much more complex than vx this is what you have if you need to analyze the

820
01:20:27,570 --> 01:20:32,280
 logic of the pack in you should be to analyze this calculation that good equals

821
01:20:32,280 --> 01:20:37,240
 precisely to this but we are not interested in us

822
01:20:37,240 --> 01:20:42,250
 what we want is to understand when it is in the jump of the tail

823
01:20:42,250 --> 01:20:46,440
 so we go back and say this

824
01:20:48,570 --> 01:20:56,230
 we return to the point where we were here in the second virtual protec the set that yes

825
01:20:56,230 --> 01:21:00,309
 is rewriting wrong we are going to do the same as we did with

826
01:21:00,310 --> 01:21:07,280
 a 3 px demand of the vector let's see later

827
01:21:07,280 --> 01:21:14,150
 this power and we are in this code this code is also part of the fence

828
01:21:14,150 --> 01:21:20,150
 so we keep going down and down like I told you after the package

829
01:21:20,150 --> 01:21:26,240
 start doing the virtual protect we start to go down and the idea is to find

830
01:21:26,240 --> 01:21:30,179
 jong but then there are jones that we don't

831
01:21:30,179 --> 01:21:36,090
 They serve for example station is a yong is more right here is telling us the

832
01:21:36,090 --> 01:21:41,100
 jump from here here does not serve me conditional jon neither does this serve me

833
01:21:41,100 --> 01:21:46,110
 job is part of a what does not serve me either I keep giving this one you do not see

834
01:21:46,110 --> 01:21:49,749
 it is not a question of going down there for a moment

835
01:21:49,749 --> 01:21:54,110
 we don't have to go down to find a union either

836
01:21:54,110 --> 01:22:01,139
 different the famous jump of the tail is that is what we have to

837
01:22:01,139 --> 01:22:07,489
 find we keep wandering and this is the last me is what me

838
01:22:07,489 --> 01:22:14,119
 The attention of that self is that it is a union to a value that dynamically leaves

839
01:22:14,119 --> 01:22:19,780
 to load in the x if you execute that

840
01:22:19,780 --> 01:22:25,250
 we put the common and fierce break point of both play

841
01:22:25,250 --> 01:22:30,910
 and see that this name [Music]

842
01:22:30,910 --> 01:22:39,680
 xx is an address in your virus well your visits inside the let's say that

843
01:22:39,680 --> 01:22:45,250
 the range of addresses that are within 400,000 that is, this is the famous

844
01:22:45,660 --> 01:22:55,650
 if I give it eight hours and this would be the entity more complex than vx if total but

845
01:22:55,650 --> 01:23:00,679
 it is exactly the same procedure because of the same

846
01:23:00,710 --> 01:23:03,550
 we load

847
01:23:04,160 --> 01:23:07,420
 wine protect

848
01:23:08,000 --> 01:23:11,560
 so that is how fast is peter protect I have the project

849
01:23:11,560 --> 01:23:14,770
 [Music] the first

850
01:23:14,770 --> 01:23:18,510
 the first one he does it with

851
01:23:19,090 --> 01:23:25,930
 the 300,000 and 400,000 just the cable base address was loaded as

852
01:23:25,930 --> 01:23:29,950
 ninth is running is making changes in that section because I do not

853
01:23:29,950 --> 01:23:34,440
 I am interested in doing it again and now if you are making changes to that

854
01:23:34,440 --> 01:23:38,910
 in this section that is to say, he is going to start rewriting this part as already

855
01:23:38,910 --> 01:23:44,479
 start writing and then now is where we really go

856
01:23:44,479 --> 01:23:49,880
 to see the code that is going to save the legitimate code the plan

857
01:23:49,880 --> 01:23:56,690
 we click on issue and it returned again now an excel power is done

858
01:23:56,690 --> 01:24:02,700
 we started to go down looking as such by the tail we go to santo de la stream

859
01:24:02,700 --> 01:24:08,940
 the rope makes a jump that is not to this same section if the direction above

860
01:24:08,940 --> 01:24:14,440
 400,000 is the last round that last jump

861
01:24:14,440 --> 01:24:17,730
 in this point

862
01:24:18,020 --> 01:24:23,160
 ran up to that point and now i make the jump

863
01:24:23,160 --> 01:24:28,559
 when the jump I am already on the site and now it is exactly the same as you see x

864
01:24:28,560 --> 01:24:32,570
 we give plugins we leave solid with process

865
01:24:32,570 --> 01:24:37,690
 and there are days here

866
01:24:37,760 --> 01:24:42,440
 the same thing we did with x exactly the same I'm not doing anything weird

867
01:24:42,440 --> 01:24:46,989
 I give this car search

868
01:24:48,340 --> 01:24:53,230
 and this

869
01:24:53,699 --> 01:25:00,750
 executable is in package how to beat packers there are two

870
01:25:00,750 --> 01:25:07,620
 and basically from in the case of vx and how we can use the same logic

871
01:25:07,620 --> 01:25:11,790
 of a px for other patios that is a little more complicated yes but it is

872
01:25:11,790 --> 01:25:14,600
 exactly the smallest

873
01:25:15,780 --> 01:25:19,219
 questions questions

874
01:25:28,900 --> 01:25:31,650
 1

875
01:25:36,460 --> 01:25:39,150
 and ready

876
01:25:41,389 --> 01:25:46,840
 any questions out there all clear fine

877
01:25:52,119 --> 01:26:03,268
 apparently everything is fine we are following you and with that we would have

878
01:26:03,750 --> 01:26:11,390
 only on my machine the tiebreaker but only on my machine no

879
01:26:11,390 --> 01:26:17,910
 they would have to restore the image then of today double click to effectively

880
01:26:17,910 --> 01:26:23,849
 verify that what you just unpacked works as double click

881
01:26:23,850 --> 01:26:27,240
 here it already came out here online that is

882
01:26:27,240 --> 01:26:31,830
 this ransomware is running however to it that package more than run

883
01:26:31,830 --> 01:26:38,030
 shadow if we give it a little more time

884
01:26:39,139 --> 01:26:44,060
 but more things started to come out, the tics no longer exist

885
01:26:44,060 --> 01:26:48,179
 [Music] that is to say and if not the task without law but

886
01:26:48,179 --> 01:26:55,510
 if she too there we are then two cases two scenarios

887
01:26:55,510 --> 01:26:59,679
 and how to apply logic to unpack without you losing the

888
01:26:59,679 --> 01:27:06,090
 head now there it is and does not want to work

889
01:27:06,090 --> 01:27:10,340
 again then I'm going to close this

890
01:27:10,760 --> 01:27:17,250
 boyacá I'm going to clean restored

891
01:27:17,340 --> 01:27:21,440
 and will learn

892
01:27:25,330 --> 01:27:32,559
 case number 3 case number 3 is already injected case

893
01:27:32,560 --> 01:27:38,780
 external process that is already the one we live in lay and ready

894
01:27:38,780 --> 01:27:44,929
 I'm going to spend it a little faster so we have a little time for him

895
01:27:44,929 --> 01:27:48,090
 break and later if we are going to open

896
01:27:48,090 --> 01:27:54,130
 so what I want in this first part is a pattern

897
01:27:54,130 --> 01:28:02,180
 then case number 3 case number 33 we are going to open this tool

898
01:28:02,180 --> 01:28:05,860
 monitor let's open

899
01:28:07,900 --> 01:28:12,219
 but guys that work

900
01:28:14,830 --> 01:28:19,120
 are you ready we have monitor and plot processes

901
01:28:19,120 --> 01:28:26,239
 and we are going to run your floors 3 that's the one I'm going to find

902
01:28:26,239 --> 01:28:32,059
 the avoidable click run ripped from the oaka here we are taking

903
01:28:32,060 --> 01:28:38,120
 just note what is happening I will not look at anything else I want to see and there

904
01:28:38,120 --> 01:28:42,040
 I'm going to change the resolution for you

905
01:28:44,369 --> 01:28:48,660
 ah display

906
01:28:51,920 --> 01:28:58,410
 and see what is happening

907
01:28:59,809 --> 01:29:06,039
 it's running it's running over like a stranger

908
01:29:10,400 --> 01:29:15,830
 If I understand what just happened, if they still saw what happened, there is peace.

909
01:29:15,830 --> 01:29:22,969
 fast and that's why we need this tool to see that on camera

910
01:29:22,969 --> 01:29:28,880
 slowly we are going to give him in beautiful phrases and we are going to prost street again

911
01:29:28,880 --> 01:29:33,080
 process monitor we go to process tools

912
01:29:33,080 --> 01:29:39,559
 If you see the process tree, you will see what happened in time

913
01:29:39,560 --> 01:29:44,180
 we had a suspicious process three excel this is that here at this moment

914
01:29:44,180 --> 01:29:48,439
 I start lived up to this moment they spent some

915
01:29:48,439 --> 01:29:54,590
 couple of things and that process ceased to exist however in an instance of

916
01:29:54,590 --> 01:29:58,820
 that myth exists right now right now

917
01:29:58,820 --> 01:30:05,420
 exists in memory is running and was a child of the original then have

918
01:30:05,420 --> 01:30:12,510
 that as as present when they are analyzing manual and another in what

919
01:30:12,510 --> 01:30:20,160
 a process started instantly generates an instance a process and if it does not exist

920
01:30:20,160 --> 01:30:26,190
 the father then is likely to have made some sort of direction is

921
01:30:26,190 --> 01:30:30,580
 can happen here in this case is an injection of

922
01:30:30,580 --> 01:30:36,040
 Cordoba and that injection of game does it in his

923
01:30:36,040 --> 01:30:43,360
 same process there was not even an ex the audio of your same process but it can

924
01:30:43,360 --> 01:30:47,230
 pass on can be more sophisticated can open an explored another explorer

925
01:30:47,230 --> 01:30:53,928
 point elections vice host whatever you want that really no no no

926
01:30:53,929 --> 01:30:59,840
 matter internet explorer anything can happen as long as anything

927
01:30:59,840 --> 01:31:05,300
 any process the attacker to do this but what i want the most

928
01:31:05,300 --> 01:31:11,210
 important here is that it is to understand what the flow is as it looks like a

929
01:31:11,210 --> 01:31:15,710
 coi injection and a parent process action code injection left

930
01:31:15,710 --> 01:31:23,389
 exist then that stops the process seen why that does not work then we go

931
01:31:23,389 --> 01:31:29,000
 Let's go to miter let's go here we go to people rice us

932
01:31:29,000 --> 01:31:40,080
 we are going to injection of the code that happened injection we go here and there when server

933
01:31:40,080 --> 01:31:45,800
 that kind of behavior with which I described you a little while ago

934
01:31:45,800 --> 01:31:49,160
 and they start to think it's code injection when it's code injection

935
01:31:49,160 --> 01:31:53,540
 what are the strategies that are used and what are they then there is already

936
01:31:53,540 --> 01:31:59,450
 I start to see what are the shapis that these types of strategies are used

937
01:31:59,450 --> 01:32:04,429
 In this case I do not want to delve much but we are not going to say basically

938
01:32:04,430 --> 01:32:10,460
 what it uses in this case is process is not the only one there is more but in this case

939
01:32:10,460 --> 01:32:12,310
 it's process [Music]

940
01:32:12,310 --> 01:32:18,510
 without bad let's go while we are going to see punctually what the apis are

941
01:32:20,660 --> 01:32:27,080
 [Music] is in these two can be concepts

942
01:32:28,780 --> 01:32:31,830
 [Music]

943
01:32:34,200 --> 01:32:40,599
 in our case the most important of all those is raid

944
01:32:40,600 --> 01:32:43,590
 press memory because that is when

945
01:32:43,590 --> 01:32:50,610
 is going to write the code of or the code that they do then inject

946
01:32:50,610 --> 01:32:54,870
 the break because we are going to put it is a process

947
01:32:54,870 --> 01:32:59,519
 all and analysis that we did is just that it was to remove the skin

948
01:32:59,520 --> 01:33:03,890
 we need the process

949
01:33:03,900 --> 01:33:06,990
 yes and I hope

950
01:33:06,990 --> 01:33:10,969
 be clear because we are going to put

951
01:33:12,110 --> 01:33:15,110
 only

952
01:33:16,650 --> 01:33:19,519
 then

953
01:33:19,620 --> 01:33:28,240
 and the charges I put wright ok

954
01:33:28,240 --> 01:33:35,690
 with will break point remember with efe bear and leigh blake he gives me a tenth

955
01:33:35,690 --> 01:33:41,030
 with these exceptions because during normal program execution there is a

956
01:33:41,030 --> 01:33:46,360
 exception and since we are in a vogel, the first thing the return does is

957
01:33:46,360 --> 01:33:53,000
 capture the ascent before you give permission to the program that handles and

958
01:33:53,000 --> 01:33:59,300
 its own section if we don't want it to happen is then we give it shift and f9 and

959
01:33:59,300 --> 01:34:05,140
 With that we say the exception the capture of the software not us

960
01:34:06,460 --> 01:34:09,460
 remember

961
01:34:11,060 --> 01:34:13,900
 questions

962
01:34:16,620 --> 01:34:19,309
 or not

963
01:34:22,390 --> 01:34:27,989
 [Music] let me know if they follow me here we are

964
01:34:27,989 --> 01:34:32,539
 because the software

965
01:34:39,540 --> 01:34:45,519
 is present so this is where it gets

966
01:34:45,520 --> 01:34:52,260
 interesting and always documentation

967
01:34:54,980 --> 01:35:00,370
 If you have noticed all the analysis I would tell you at the beginning even though

968
01:35:00,370 --> 01:35:05,900
 We are currently watching assembler I have never told them it is not

969
01:35:05,900 --> 01:35:10,360
 that this is the prologue of the function and this one is not

970
01:35:10,420 --> 01:35:16,130
 it's just the weirdest thing I've ever said to you with breathing about that is things

971
01:35:16,130 --> 01:35:21,110
 like the yacht the extended instruction pointer the wifi

972
01:35:21,110 --> 01:35:26,630
 things of that style but at this moment you have not done any and do the

973
01:35:26,630 --> 01:35:31,160
 The only thing we have done is applied the break points yonhap and kohl's

974
01:35:31,160 --> 01:35:36,740
 understand only how I can extract the information but you have not been

975
01:35:36,740 --> 01:35:42,260
 You have not done anything if crazy as I tell you it is and if it is

976
01:35:42,260 --> 01:35:47,660
 important to know they make you look but one can analyze malware without being a

977
01:35:47,660 --> 01:35:53,660
 programmer in assimilating is simply knowing and determining how to get to

978
01:35:53,660 --> 01:35:59,030
 the important parts and this keep in mind

979
01:35:59,030 --> 01:36:05,389
 and then again in the documentation in the raid process

980
01:36:05,389 --> 01:36:10,369
 memory if they realize and receive some parameters first parameter is the

981
01:36:10,369 --> 01:36:14,949
 process handball the handball is an object that contains the characteristics

982
01:36:14,949 --> 01:36:24,739
 of an element to which we are going to see that it has processed modified if the

983
01:36:24,739 --> 01:36:32,450
 kiss with handball may be there may be two files below

984
01:36:32,450 --> 01:36:37,660
 up to network connections to processes then someone is an object that

985
01:36:37,660 --> 01:36:41,080
 represents as

986
01:36:41,460 --> 01:36:48,640
 we have the address where the walk will be written see it as the process

987
01:36:48,640 --> 01:36:55,240
 the address where we are going to write the buffer is what we are going to write to it and

988
01:36:55,240 --> 01:36:59,769
 the size is how big is the strongest thing about this, what makes me feel the most

989
01:36:59,770 --> 01:37:06,540
 Interesting is that these three then first in which the process we go

990
01:37:06,540 --> 01:37:11,310
 to write which is alejandro for that we create to look is the first parameter

991
01:37:11,310 --> 01:37:16,520
 four times this is the jandro as charity

992
01:37:16,520 --> 01:37:22,790
 s jandro then basically let's follow our process see that here is a

993
01:37:22,790 --> 01:37:28,100
 suspended process here we have the child process but the one that is doing

994
01:37:28,100 --> 01:37:31,820
 at this moment for the operations it is his father's then we are going to do

995
01:37:31,820 --> 01:37:36,920
 right click on the parent process we go to properties we go to

996
01:37:36,920 --> 01:37:43,989
 jan dolls and we are going to look for the handball that has 4 times

997
01:37:44,760 --> 01:37:52,810
 40 is a hands on to the suspicious excel process but in comb that process is 61

998
01:37:52,810 --> 01:38:03,070
 66 61 96 is to say that we are going to write we are going to write in the process and that's it

999
01:38:03,070 --> 01:38:06,570
 We already know where we are going to write the process

1000
01:38:06,570 --> 01:38:11,519
 in which process choice did you say in the 400

1001
01:38:11,520 --> 01:38:15,930
 Who are we going to write to this is the buffer then we right click

1002
01:38:15,930 --> 01:38:21,510
 I want to see in the buffer then right click here on this in the address of the

1003
01:38:21,510 --> 01:38:26,350
 buffer and I give it follow and top when that happens

1004
01:38:26,350 --> 01:38:30,640
 equal to this is what we are going to give you this what we are going to write you

1005
01:38:30,640 --> 01:38:38,180
 We are going to write the new executable and this world is the one that I bring from

1006
01:38:38,180 --> 01:38:42,200
 memory in this specific case by is by the form

1007
01:38:42,200 --> 01:38:45,970
 how do you work in the yard

1008
01:38:46,270 --> 01:38:51,730
 what this parker is going to try is to do the same as a

1009
01:38:51,730 --> 01:38:56,669
 what does the windows author do then he has it

1010
01:38:56,900 --> 01:39:02,610
 executable here in memory in this offer pérez lópez to copy the sections by

1011
01:39:02,610 --> 01:39:08,130
 section and that because I already know at the moment they will realize that the

1012
01:39:08,130 --> 01:39:15,520
 finally if he is copying ameal's idea

1013
01:39:15,520 --> 01:39:20,290
 in bytes so he is copying section x is being loaded as is

1014
01:39:20,290 --> 01:39:27,400
 What does windows do? The advantage of that is that here my memory

1015
01:39:27,400 --> 01:39:31,999
 elementals has nothing to import is corrupt because

1016
01:39:31,999 --> 01:39:36,709
 as the one so that what you have to do is load it in pieces is such a base

1017
01:39:36,709 --> 01:39:40,879
 windows here we have the unpacked file and we would not have that is

1018
01:39:40,879 --> 01:39:45,229
 a correction the important thing is to extract to extract it

1019
01:39:45,229 --> 01:39:52,609
 and I right click then I'm here in right click format I'm going to

1020
01:39:52,609 --> 01:39:58,750
 follow and memory map I would be this which is the region

1021
01:39:58,750 --> 01:40:06,670
 shaded then see that 37 the shadow region is about in the same range

1022
01:40:06,670 --> 01:40:12,960
 I right click it and give it what I am downloading

1023
01:40:12,960 --> 01:40:20,520
 waiting for that process and this is because they

1024
01:40:20,520 --> 01:40:27,960
 said that it is important editors because I want to look at what data there is in

1025
01:40:27,960 --> 01:40:34,110
 that I download without any format if then if you realize this yet

1026
01:40:34,110 --> 01:40:39,179
 It is not a windows executable because they do not have the windows headers without

1027
01:40:39,179 --> 01:40:45,890
 However we know that here there is such is why because if I look for remise it is

1028
01:40:47,360 --> 01:40:53,790
 and I start to go down for example this since this is a

1029
01:40:53,790 --> 01:41:01,100
 a section is from this if it is an example and in my z program where sometimes it is a

1030
01:41:01,100 --> 01:41:03,880
 windows description

1031
01:41:04,360 --> 01:41:10,880
 that is, in this they adapt that we download from memory there is to execute them we have to

1032
01:41:10,880 --> 01:41:17,020
 extract the easiest way then is to enter the console

1033
01:41:17,020 --> 01:41:19,890
 and no

1034
01:41:21,500 --> 01:41:28,170
 [Music] let's do this

1035
01:41:28,170 --> 01:41:35,569
 and abbas to shape it and drag this file and the listener

1036
01:41:37,600 --> 01:41:43,450
 in a new folder in that epic load we will have where are the

1037
01:41:43,450 --> 01:41:49,309
 executables and effectively from memory we extracted two stable

1038
01:41:49,310 --> 01:41:55,910
 the first executable we already knew that the one with the icon is the living corner and

1039
01:41:55,910 --> 01:42:04,610
 because that one that is rain cost because first we saw it in the second if you, if not

1040
01:42:04,610 --> 01:42:09,110
 was in this workshop and the strings are going to stay at some point he says

1041
01:42:09,110 --> 01:42:14,660
 ring then there will be the first executable know what you are seeing is a

1042
01:42:14,660 --> 01:42:19,269
 for a while but there it says ranges

1043
01:42:20,010 --> 01:42:25,889
 rehn cosmetics this is answer version 2.51

1044
01:42:25,889 --> 01:42:30,929
 ready tiebreaker is there already in queen

1045
01:42:30,929 --> 01:42:36,599
 is from here is another executable that is inside memory

1046
01:42:36,599 --> 01:42:44,059
 and this is already the net product then this wish executable

1047
01:42:45,940 --> 01:42:51,040
 It has interesting things that we could look at but that score went as well

1048
01:42:51,040 --> 01:42:56,760
 that's the only thing to understand where it's worth

1049
01:43:11,400 --> 01:43:15,320
 they are all there in daylight

1050
01:43:19,790 --> 01:43:24,569
 no no [Music]

1051
01:43:26,280 --> 01:43:33,469
 Like everyone it seems that to the day Felipe also has no consultation so far

1052
01:43:34,700 --> 01:43:40,250
 let's see then

1053
01:43:41,100 --> 01:43:47,169
 until there we are, I'm going to teach you just I'm not going to go in

1054
01:43:47,169 --> 01:43:52,430
 much we have time for the break but

1055
01:43:52,430 --> 01:43:58,239
 promptly I will show you something with this point net

1056
01:43:58,239 --> 01:44:03,218
 as I know that it is clearly the fault of Beijing and stable

1057
01:44:03,219 --> 01:44:09,530
 donnet i put this executable in benin si spain

1058
01:44:09,530 --> 01:44:13,580
 dns spain as i told you is a [ __ ] disassemble

1059
01:44:13,580 --> 01:44:20,370
 compiler net during compile however

1060
01:44:20,370 --> 01:44:24,920
 is protected then

1061
01:44:26,480 --> 01:44:33,169
 for that what we are going to do and who I am showing is another other

1062
01:44:33,170 --> 01:44:40,340
 tip beyond is what i'm going to do is fort hood as dislocation for

1063
01:44:40,340 --> 01:44:42,880
 point net

1064
01:44:43,040 --> 01:44:46,570
 In Internet

1065
01:44:46,689 --> 01:44:53,440
 you already have that tool there but it works for francisco

1066
01:44:53,440 --> 01:44:57,419
 francis de forma

1067
01:44:58,520 --> 01:45:02,410
 and you drag

1068
01:45:05,650 --> 01:45:10,849
 He accepted me perfectly and I already get a clean version of that version

1069
01:45:10,850 --> 01:45:13,889
 [Music]

1070
01:45:13,950 --> 01:45:23,070
 and already the compiled code and then they are already going to start to see with the

1071
01:45:23,070 --> 01:45:29,700
 interesting which are interesting things that I think you find the

1072
01:45:29,700 --> 01:45:36,349
 things fast and it is that they do not know sometimes but it is what

1073
01:45:36,349 --> 01:45:38,710
 look then what are interesting things

1074
01:45:38,710 --> 01:45:47,179
 already from registry file urls pads and references to for example this this

1075
01:45:47,179 --> 01:45:55,699
 refers to sam vokes these this is like to me it seems like a routine that

1076
01:45:55,699 --> 01:46:01,249
 allows to detect if this is running and we do not use and if it is running a

1077
01:46:01,249 --> 01:46:05,989
 sandbox then avoid running forward this would be an anti scan for example

1078
01:46:05,989 --> 01:46:10,249
 that is something interesting this is another then this would already be an anti good

1079
01:46:10,249 --> 01:46:16,820
 because because he's trying to find his one box and it's okay to play for him

1080
01:46:16,820 --> 01:46:20,749
 rest is something important and interesting seen before keep in mind

1081
01:46:20,749 --> 01:46:27,099
 that is surprise that something else may be interesting for example

1082
01:46:27,210 --> 01:46:32,740
 [Music] we'll say class by class there quickly

1083
01:46:32,740 --> 01:46:35,889
 class 2

1084
01:46:35,990 --> 01:46:41,840
 and from here I am going through that fast looking for that interesting and even

1085
01:46:41,840 --> 01:46:49,199
 99 ist is interesting so this class for example

1086
01:46:49,199 --> 01:46:54,750
 is here for an approach not giving value either this can

1087
01:46:54,750 --> 01:47:00,760
 We work from encrypting the information, yes, but well, I don't want to

1088
01:47:00,760 --> 01:47:06,030
 understand that then I don't want to understand that well for kilo by kilo

1089
01:47:06,690 --> 01:47:11,400
 and he does not want to understand this here

1090
01:47:11,400 --> 01:47:15,018
 for example well if there is something interesting then

1091
01:47:15,019 --> 01:47:18,410
 for example see that he is creating here

1092
01:47:18,410 --> 01:47:24,269
 it seems that he thinks a task is not the best it is interesting he is creating a

1093
01:47:24,270 --> 01:47:29,300
 homework and we have the copp and what else seems interesting to me

1094
01:47:29,300 --> 01:47:32,530
 then they remember no

1095
01:47:32,850 --> 01:47:39,840
 the process halloween and between the wellness process create process is a

1096
01:47:39,840 --> 01:47:47,070
 mapping section after that is virtual to the ex raid process memory se

1097
01:47:47,070 --> 01:47:53,040
 try context and racing fred well, here are the racisme rooms itself

1098
01:47:53,040 --> 01:48:02,850
 obsession set 3 virtual context or ex recent that is to say here if

1099
01:48:02,850 --> 01:48:06,090
 you look at this is the code that is responsible for making the process what it is

1100
01:48:06,090 --> 01:48:11,219
 want to implement process on point is not you could copy and paste this and

1101
01:48:11,219 --> 01:48:19,590
 That is a process that will work, what I told them happens at least in

1102
01:48:19,590 --> 01:48:25,820
 this package that accommodates more than half pieces see

1103
01:48:25,820 --> 01:48:33,610
 that the white process memory is inside a forum

1104
01:48:34,710 --> 01:48:38,460
 that is to say the bread what is going to start is to collect handles

1105
01:48:38,460 --> 01:48:44,969
 and when he copies that, he is going to pay like windows does, or this is right here

1106
01:48:44,969 --> 01:48:49,620
 It would be a loading routine that the windows loader does when you

1107
01:48:49,620 --> 01:48:53,400
 do double but this is important to me but if you suddenly

1108
01:48:53,400 --> 01:48:58,070
 want to understand a little more of the process just came code level

1109
01:48:59,650 --> 01:49:05,540
 suddenly here then see that he is like generating a file about how

1110
01:49:05,540 --> 01:49:11,800
 create a new file and it will do it in the data

1111
01:49:11,800 --> 01:49:16,080
 copy the file just do a falköping

1112
01:49:16,080 --> 01:49:21,620
 [Music] and so on shenzhou before is

1113
01:49:21,620 --> 01:49:28,640
 interesting that we find in our analysis but let's say that we go

1114
01:49:28,640 --> 01:49:32,420
 beyond that it comes out like the scop of what I wanted in this first boat only of a

1115
01:49:32,420 --> 01:49:38,950
 pack and if you have any questions please ask and now

1116
01:49:38,950 --> 01:49:46,220
 we would enter with a period of 15 minutes of break and we continue for the next

1117
01:49:46,220 --> 01:49:51,250
 part starts like this it would be for the river to be ready

1118
01:49:53,870 --> 01:50:01,610
 1 [Music]

1119
01:50:03,580 --> 01:50:06,330
 and ready

1120
01:50:06,720 --> 01:50:14,060
 well maybe good afternoon but have enjoyed your break

1121
01:50:14,060 --> 01:50:18,020
 and let's continue then he recapped

1122
01:50:18,020 --> 01:50:23,340
 So he recapitulated what was going like I told you

1123
01:50:23,340 --> 01:50:29,520
 well we focus a lot is the packaging the reason for this is

1124
01:50:29,520 --> 01:50:34,889
 because if you fail to unpack a sample it will be very

1125
01:50:34,889 --> 01:50:41,489
 difficult reversal the first the first part of that of that analysis is to try

1126
01:50:41,489 --> 01:50:47,519
 to discern if the sample is packed then going back to the

1127
01:50:47,520 --> 01:50:54,530
 checklist I showed you how some strategies to stop me

1128
01:50:54,530 --> 01:51:00,830
 what is the first question remember we used dt kim and own analysis and

1129
01:51:00,830 --> 01:51:05,570
 a comparison of the strings with p study of what is in memory and what

1130
01:51:05,570 --> 01:51:10,330
 what would be like the two strategies

1131
01:51:11,530 --> 01:51:18,170
 Later, as the package is, I showed you two strategies and these two

1132
01:51:18,170 --> 01:51:25,340
 strategies the first is the case in the cases in which any rewrites

1133
01:51:25,340 --> 01:51:31,309
 also the code in memory then remember well the virtual break point

1134
01:51:31,309 --> 01:51:38,349
 protect seek the instant in which they can also rewrite the

1135
01:51:38,349 --> 01:51:45,260
 usually the address 400,000 but it will not always happen if the total is

1136
01:51:45,260 --> 01:51:51,139
 loaded with in another direction so I'm not going to show you how obviously that

1137
01:51:51,139 --> 01:51:56,389
 like in what case would it happen then let's assume we already have this

1138
01:51:56,389 --> 01:51:59,139
 file

1139
01:51:59,340 --> 01:52:02,840
 and I'm going to show you an era

1140
01:52:03,300 --> 01:52:10,970
 then if you are thirsty the cfr scanned and file area to cap heretic

1141
01:52:10,970 --> 01:52:16,289
 the executable the partial sva however that option to see

1142
01:52:16,289 --> 01:52:23,309
 we are going to see the characteristic is called realizing that the first is the

1143
01:52:23,309 --> 01:52:28,720
 dvd can be moved or not if it is enabled what will happen is

1144
01:52:28,720 --> 01:52:32,380
 he to that read

1145
01:52:32,380 --> 01:52:40,979
 on that side basically the protection is located in those of the exhibitions

1146
01:52:40,979 --> 01:52:45,510
 random or sectors in which it goes through memory to make it more

1147
01:52:45,510 --> 01:52:50,729
 difficult to rotate some vulnerability is enabled then there is

1148
01:52:50,729 --> 01:52:58,810
 some in such that and that happens and then what is going to happen

1149
01:52:58,810 --> 01:53:05,230
 and it is that every time we change our file, it will be loaded into a

1150
01:53:05,230 --> 01:53:09,259
 different direction I'll show you quickly

1151
01:53:09,260 --> 01:53:17,050
 this file see what it has and here we are going to do it

1152
01:53:17,050 --> 01:53:21,930
 it was also mild the first time you have it

1153
01:53:21,930 --> 01:53:29,190
 it is charging at night it is running new now I know it will prevail in the 4

1154
01:53:29,190 --> 01:53:34,830
 totally changed then this does not want what what it does in comparison

1155
01:53:34,830 --> 01:53:37,699
 with the

1156
01:53:37,970 --> 01:53:46,880
 original executable that I did not have and that characteristic is that they see that he

1157
01:53:46,880 --> 01:53:51,090
 the one who didn't have the one who couldn't move

1158
01:53:51,090 --> 01:54:01,340
 and the other in the direction that windows 8 that because I say it because in this case

1159
01:54:01,340 --> 01:54:07,139
 in this one in which they load a lot when the call is made which protects

1160
01:54:07,139 --> 01:54:11,400
 the address you have to refer to for

1161
01:54:11,400 --> 01:54:18,989
 determine if you are rewriting that position young and 846 only to have it

1162
01:54:18,989 --> 01:54:23,989
 be clear but normally this is a type of pact

1163
01:54:23,989 --> 01:54:29,030
 and if they detail a little more

1164
01:54:34,380 --> 01:54:40,620
 but that kind of for what for what errors and its is rewritten in memory

1165
01:54:40,620 --> 01:54:45,360
 and country number 2 is injected with code from our process, we have already seen the

1166
01:54:45,360 --> 01:54:50,830
 strategies to unpack both I think there was a question for the remote

1167
01:54:50,830 --> 01:54:55,250
 I remember yes correct

1168
01:54:55,250 --> 01:55:01,220
 look and ask us if there is any way to automate the extraction of

1169
01:55:01,220 --> 01:55:05,450
 the interesting premieres you mentioned just when I was

1170
01:55:05,450 --> 01:55:11,849
 analyzing the sample in net point and condemn that space

1171
01:55:11,850 --> 01:55:18,690
 a way to extract that string that could indicate something interesting from the

1172
01:55:18,690 --> 01:55:23,469
 manual really look who you are

1173
01:55:23,469 --> 01:55:27,550
 that question is the one that many are passing insan

1174
01:55:27,550 --> 01:55:33,610
 to solve by itself and extract the conventional strips all the strings

1175
01:55:33,610 --> 01:55:39,519
 It is the simplest command but that is where it is worth starting to

1176
01:55:39,520 --> 01:55:45,250
 implement in a killer ning type of model something that allows you to do that up to the

1177
01:55:45,250 --> 01:55:50,139
 At the moment I do not know what there was of that may exist but I am not clear about it

1178
01:55:50,139 --> 01:55:57,210
 and if you are suddenly more and artificial I think it would be worth it

1179
01:55:57,210 --> 01:56:02,310
 that they create a model that wants that is it would be like a good tool that

1180
01:56:02,310 --> 01:56:09,110
 it would be worth doing I think it's a good necessity

1181
01:56:11,140 --> 01:56:17,050
 Felipe and us for example with a rule

1182
01:56:17,050 --> 01:56:21,210
 you will find that you search for words such as or

1183
01:56:21,210 --> 01:56:27,780
 that are intended for the function of anti well anti virtual machine

1184
01:56:27,780 --> 01:56:34,490
 and search for keywords such as virtualbox bingo etc.

1185
01:56:35,850 --> 01:56:43,570
 if exactly the reason with a rat pod

1186
01:56:44,060 --> 01:56:48,650
 what are the interesting words in that order of ideas

1187
01:56:48,650 --> 01:56:54,469
 If you go for the fix part, you define the rule and for you

1188
01:56:54,470 --> 01:57:00,380
 They are interesting found as a sandbox like the ones we saw in who

1189
01:57:00,380 --> 01:57:06,150
 you have there right you would have to do like him

1190
01:57:06,150 --> 01:57:11,429
 the logic behind that so one expensive rule is several however there are

1191
01:57:11,429 --> 01:57:14,150
 cases in which

1192
01:57:15,100 --> 01:57:19,200
 and then they can exist as

1193
01:57:19,270 --> 01:57:25,700
 interesting words that are going to be outside those rules then on net

1194
01:57:25,700 --> 01:57:31,870
 where I see moving machine learning is also worth a try

1195
01:57:31,870 --> 01:57:37,830
 it is like this it can be by the part of rules or reused

1196
01:57:38,400 --> 01:57:42,299
 and now it can be a strategy

1197
01:57:45,790 --> 01:57:50,160
 I don't know if you have any other questions and

1198
01:57:52,060 --> 01:57:58,120
 Not for now, but there we are attentive Felipe to the consultations, here is a

1199
01:57:58,120 --> 01:58:03,910
 question ok links there is a question nothing that says as it is normally done

1200
01:58:03,910 --> 01:58:09,840
 finger mapping and take control of them

1201
01:58:09,930 --> 01:58:13,039
 [Music]

1202
01:58:13,260 --> 01:58:20,270
 I have a question that I don't quite understand what you mean by mateo

1203
01:58:20,270 --> 01:58:28,000
 what do you mean to mix the concept

1204
01:58:28,800 --> 01:58:35,670
 and I could give you more and more good than links

1205
01:58:35,670 --> 01:58:42,390
 but I think it must be how to detect or how to extract the fingers of a malware

1206
01:58:42,390 --> 01:58:48,320
 Maybe it was pointing radial, but let's hope that the links say

1207
01:58:49,840 --> 01:58:54,739
 let's wait because the gene is indeed strong

1208
01:58:54,739 --> 01:58:59,928
 try to identify can be done different can be used

1209
01:58:59,929 --> 01:59:07,320
 strategies but to clarify what it is rather and with that continues

1210
01:59:07,320 --> 01:59:14,530
 ready then and the two of us are through

1211
01:59:15,290 --> 01:59:18,519
 the file is packed

1212
01:59:18,910 --> 01:59:24,760
 now the third item that is the most interesting of the file I insist

1213
01:59:24,760 --> 01:59:30,690
 what we have to do is not analyze

1214
01:59:30,690 --> 01:59:36,849
 crazy oil lines of 50,000 inés from hunger nor accept what

1215
01:59:36,850 --> 01:59:39,150
 speaks

1216
01:59:39,160 --> 01:59:45,130
 the idea is within those 50,000 steel lines have the most relevant to the

1217
01:59:45,130 --> 01:59:49,429
 I study what I am doing and based on that

1218
01:59:49,429 --> 01:59:54,289
 continue with my analysis and thus sit down and this top coat

1219
01:59:54,289 --> 02:00:01,639
 the instructions so singing then one of the characteristics of a

1220
02:00:01,639 --> 02:00:08,030
 avant-garde analyst who has to filter within week of assembly

1221
02:00:08,030 --> 02:00:13,509
 or what is the most interesting company and that

1222
02:00:13,510 --> 02:00:19,450
 appreciation to ask supremely trivial but the answer is not

1223
02:00:19,450 --> 02:00:24,650
 then the answer depends on you looking for

1224
02:00:24,650 --> 02:00:29,990
 ej and you are trying to make a

1225
02:00:29,990 --> 02:00:35,110
 signature detection of this trojan then what

1226
02:00:35,110 --> 02:00:39,610
 is the most interesting of the file the most interesting of the file for detection

1227
02:00:39,610 --> 02:00:44,699
 are the unique patterns of the file

1228
02:00:45,530 --> 02:00:50,670
 however now there is another horse we are trying to stop

1229
02:00:50,670 --> 02:00:57,210
 and infrastructure of this attack, which is the most interesting thing about the file,

1230
02:00:57,210 --> 02:01:03,070
 routines related to infrastructure communications with the server

1231
02:01:03,070 --> 02:01:08,049
 3 I'm trying the automatic timeline

1232
02:01:08,050 --> 02:01:16,580
 malware analysis in the clip I give it a file and hope that my

1233
02:01:16,580 --> 02:01:24,059
 system bring me the program settings what it does is both or sam

1234
02:01:24,060 --> 02:01:28,070
 vokes or trias then the most interesting is the

1235
02:01:28,070 --> 02:01:32,900
 we caught related settings

1236
02:01:32,950 --> 02:01:36,030
 I am analyzing

1237
02:01:38,200 --> 02:01:43,269
 what is the most interesting to know if the code that the software uses to give

1238
02:01:43,270 --> 02:01:47,760
 can be reversed in some way

1239
02:01:47,950 --> 02:01:51,929
 this chair of some protest

1240
02:01:52,140 --> 02:01:56,820
 in that code or if they just put the key

1241
02:01:56,820 --> 02:02:04,059
 you can easily extract it if you know that you are

1242
02:02:04,570 --> 02:02:11,030
 It depends, it is more interesting, it depends precisely on the use case for which

1243
02:02:11,030 --> 02:02:17,920
 you are analyzing I like it and that is why it is the name of the talk

1244
02:02:18,210 --> 02:02:22,219
 I like to analyze maturing a new place

1245
02:02:23,290 --> 02:02:31,420
 that is to say, this drone little thing but so that the next time we see it

1246
02:02:31,420 --> 02:02:38,050
 we can detect and we can know if the servers are

1247
02:02:38,050 --> 02:02:48,369
 ranking and, on the other hand, facilitate incident response operations in

1248
02:02:48,369 --> 02:02:52,058
 future events if the same piece of manual

1249
02:02:52,059 --> 02:02:57,160
 so I am interested in patterns like the file

1250
02:02:57,160 --> 02:03:02,059
 and extraction automation and

1251
02:03:02,060 --> 02:03:07,340
 the part of the network which is interaction with the servers

1252
02:03:07,340 --> 02:03:11,690
 command and control to keep track of the forms those are the three things

1253
02:03:11,690 --> 02:03:17,558
 that I personally like as a team and that's it

1254
02:03:17,559 --> 02:03:22,109
 also that is what basically I also use because at work to

1255
02:03:22,109 --> 02:03:28,629
 generate three minter jens but those questions that serve me are the ones that

1256
02:03:28,629 --> 02:03:32,409
 allow me to resolve what is the most interesting in this case the approach

1257
02:03:32,409 --> 02:03:39,650
 that we are going to do that is promptly to the configuration extraction already

1258
02:03:39,650 --> 02:03:43,690
 [Music] file pattern recognition

1259
02:03:43,690 --> 02:03:48,308
 to generate a list that is the most interesting then

1260
02:03:48,309 --> 02:03:52,300
 our analysis will focus on

1261
02:03:56,250 --> 02:04:02,000
 so far any questions

1262
02:04:07,530 --> 02:04:11,960
 I do not know between tips here by the channel

1263
02:04:12,320 --> 02:04:15,309
 and perform

1264
02:04:26,470 --> 02:04:33,070
 meanwhile I see I see here one that says

1265
02:04:33,130 --> 02:04:39,370
 in what context does it indicate that she tells us that we are

1266
02:04:39,370 --> 02:04:42,120
 in front of a place

1267
02:04:42,580 --> 02:04:45,850
 that question

1268
02:04:46,040 --> 02:04:49,850
 because so much we have to get into the females depends on what you are

1269
02:04:49,850 --> 02:04:54,110
 looking if we just wanted to know what it was

1270
02:04:54,110 --> 02:05:01,540
 the manual of the affections already punctually because of sanz so that we can and that's it

1271
02:05:01,540 --> 02:05:04,840
 be the end of the story I think we are doing a lot but if we

1272
02:05:04,840 --> 02:05:07,800
 we want to use

1273
02:05:08,950 --> 02:05:13,460
 for example with command and control servers to extract

1274
02:05:13,460 --> 02:05:18,680
 direct information actors or to generate a rule and at the same time

1275
02:05:18,680 --> 02:05:22,580
 next time we can easily detect it or stop here if we see

1276
02:05:22,580 --> 02:05:26,570
 I know again but we can no longer figure it out if necessary then

1277
02:05:26,570 --> 02:05:31,940
 Remember, it is worth going into if we are going to generate something that can

1278
02:05:31,940 --> 02:05:35,739
 facilitate future life of return

1279
02:05:40,250 --> 02:05:43,780
 and I put it

1280
02:05:47,700 --> 02:05:53,960
 it makes no sense to do that, I have used it in air

1281
02:05:55,000 --> 02:06:02,550
 and really that because they are different things the original in tea point

1282
02:06:02,800 --> 02:06:06,910
 in many cases they exist after the sea

1283
02:06:06,910 --> 02:06:11,769
 that is, it is executed at a point is the salvation static analysis unless

1284
02:06:11,770 --> 02:06:16,000
 that they are in the vogue but in both cases they will happen is that you

1285
02:06:16,000 --> 02:06:20,610
 have to wait for the handle to pack

1286
02:06:27,090 --> 02:06:33,940
 the excel file the configuration for effects the configuration and the patterns

1287
02:06:33,940 --> 02:06:39,330
 and own the file then we go first with the patterns

1288
02:06:39,519 --> 02:06:47,110
 the proper patterns in front and then we go to the streams first

1289
02:06:47,110 --> 02:06:50,469
 they look for patterns in strings if they do not find a pattern it is in strings

1290
02:06:50,469 --> 02:06:54,380
 relevant already

1291
02:06:54,380 --> 02:07:03,870
 but it is very good then we are marking the code they string I follow and

1292
02:07:03,870 --> 02:07:08,809
 there are strings that are very relevant then for example

1293
02:07:11,380 --> 02:07:18,139
 if we pass rap and nook nook is something that

1294
02:07:18,139 --> 02:07:25,539
 if we look for a corner

1295
02:07:30,540 --> 02:07:34,980
 white in this case is a pattern that seems to me

1296
02:07:34,980 --> 02:07:42,410
 there are more things but suddenly the version is what it is also good for

1297
02:07:42,410 --> 02:07:48,660
 soon some of these commands but always pay attention to what things you have

1298
02:07:48,660 --> 02:07:55,260
 previously seen and that or that they have never seen and that could allow them to detect

1299
02:07:55,260 --> 02:07:58,949
 the sample in this case I think hostage with that

1300
02:07:58,949 --> 02:08:05,049
 very important indicator is something that wants who barça that marks com

1301
02:08:05,050 --> 02:08:07,650
 and art

1302
02:08:07,790 --> 02:08:13,280
 suddenly the function for which it is worth doing this

1303
02:08:13,280 --> 02:08:18,230
 analysis because we are going to use that information to generate a rule and

1304
02:08:18,230 --> 02:08:24,469
 first rule and the most is using this streams and we are going to make a

1305
02:08:24,470 --> 02:08:29,870
 but these parties the first thing they do is during come strings stand out

1306
02:08:29,870 --> 02:08:34,460
 that steins you have never seen in another show and let's use strings to

1307
02:08:34,460 --> 02:08:41,450
 generate a signature we already do that the second way is using gina but

1308
02:08:41,450 --> 02:08:48,250
 this and what this function is going to do or in cases in which web

1309
02:08:48,250 --> 02:08:51,800
 punctual inscription to that inscription of

1310
02:08:51,800 --> 02:08:57,850
 information and those routines are society to this bad family

1311
02:08:57,850 --> 02:09:03,150
 warentest the way how certain forms encrypt

1312
02:09:03,370 --> 02:09:08,620
 is typical of that family then we can that algorithm as signature as

1313
02:09:08,620 --> 02:09:14,620
 I would do that quickly we open a new project

1314
02:09:14,620 --> 02:09:19,920
 next from here ranges

1315
02:09:21,630 --> 02:09:26,880
 finish and voila and let's import a

1316
02:09:26,880 --> 02:09:32,230
 the file that we are going to import before unpacking

1317
02:09:32,230 --> 02:09:38,639
 the selected ones we do not import would be around here is importing

1318
02:09:38,640 --> 02:09:41,640
 okay

1319
02:09:42,840 --> 02:09:47,540
 we let the little dragon do his work

1320
02:09:48,590 --> 02:09:52,090
 sing walking

1321
02:09:55,880 --> 02:10:00,520
 in a moment while while the Chinese dragon

1322
02:10:00,520 --> 02:10:03,570
 now while

1323
02:10:05,540 --> 02:10:12,080
 we will use what I learned what seems important to generate a network

1324
02:10:12,080 --> 02:10:20,780
 then the rules always start the name that would be meeting

1325
02:10:21,700 --> 02:10:25,950
 at one point you are on another keyboard

1326
02:10:31,000 --> 02:10:35,140
 [Music] in sight

1327
02:10:35,140 --> 02:10:38,140
 to

1328
02:10:41,170 --> 02:10:49,440
 It has two important parts, the first one is the strings

1329
02:10:49,570 --> 02:10:53,070
 and the second

1330
02:10:53,710 --> 02:11:00,150
 the strings in the first case that we are going to start

1331
02:11:00,680 --> 02:11:05,230
 we will use nothing else then

1332
02:11:07,100 --> 02:11:14,100
 and what we are going to do is string 1

1333
02:11:14,100 --> 02:11:18,170
 it will be the same and we will put

1334
02:11:19,400 --> 02:11:27,820
 It already smells and rhythms that were ranges we have to tell them to say

1335
02:11:28,520 --> 02:11:33,989
 we were string 2

1336
02:11:33,989 --> 02:11:41,820
 whatever I am going to leave the rules whatever you want to show them

1337
02:11:41,820 --> 02:11:50,570
 It can be generated in corner 6 I will not bring more details

1338
02:11:50,570 --> 02:11:55,429
 more things I am not going to give us and this what I am going to do is put the

1339
02:11:55,429 --> 02:12:01,790
 condition I need all files that contain both strings or that contain

1340
02:12:01,790 --> 02:12:06,949
 this is where i can put a little i can create and here so really say

1341
02:12:06,949 --> 02:12:14,230
 to create the rule or do all the strings for example

1342
02:12:14,230 --> 02:12:17,040
 1

1343
02:12:21,370 --> 02:12:24,370
 d

1344
02:12:24,840 --> 02:12:29,770
 ie I am looking for a file that contains this view no more

1345
02:12:29,770 --> 02:12:36,780
 what I do is put and keep her in this kind of resentment

1346
02:12:38,510 --> 02:12:44,980
 the better they do this rule because the fewer false positives they will have

1347
02:12:45,890 --> 02:12:51,479
 of [Music] benefit

1348
02:12:54,759 --> 02:13:00,459
 then show them how holy it works

1349
02:13:02,000 --> 02:13:08,770
 I give it since they have installed for people

1350
02:13:09,680 --> 02:13:15,659
 i then now in the notti

1351
02:13:15,659 --> 02:13:22,728
 we must use and now we have the options we give the rule that I want and

1352
02:13:22,729 --> 02:13:26,199
 that then in this case I want to do now

1353
02:13:26,199 --> 02:13:32,039
 I don't want the dot to make it recursive so that

1354
02:13:32,039 --> 02:13:36,949
 It would be rm which rule you want to use

1355
02:13:38,380 --> 02:13:41,760
 repeat the extension

1356
02:13:42,800 --> 02:13:45,800
 3

1357
02:13:45,920 --> 02:13:52,060
 if you want to use this and find that I want it

1358
02:13:52,889 --> 02:13:56,300
 in this directory

1359
02:13:58,000 --> 02:14:04,919
 [Music] if he played it he realizes that already

1360
02:14:05,490 --> 02:14:10,530
 fired, that is, these files contain the two words that were

1361
02:14:10,530 --> 02:14:16,290
 looking then that that works that the better you make the rule the better

1362
02:14:16,290 --> 02:14:19,340
 choose those systems

1363
02:14:19,429 --> 02:14:25,050
 Well, better every day, keep it in mind, it is a way of

1364
02:14:25,050 --> 02:14:30,210
 generate film and you have here it is good to expose many more conditions if

1365
02:14:30,210 --> 02:14:36,770
 has this is the file size things desist if it starts with mz for

1366
02:14:36,770 --> 02:14:44,880
 tablet windows things like that but strategy number two is from

1367
02:14:44,880 --> 02:14:49,710
 the path is loaded in air already in Iran when they already have load action turns

1368
02:14:49,710 --> 02:14:55,530
 double click and with that we enter the very racing part of the code I tell you that

1369
02:14:55,530 --> 02:15:02,870
 If I want you to analyze it, analyze it with everything so far I nothing strange

1370
02:15:03,969 --> 02:15:11,030
 we wait here and we are going to use a plugin from leader

1371
02:15:11,030 --> 02:15:16,599
 although since it can generate rules already to match

1372
02:15:17,150 --> 02:15:21,580
 and we wait for them to change and pick a setting

1373
02:15:22,740 --> 02:15:28,639
 also a tree in strategy so far questions

1374
02:15:30,860 --> 02:15:35,269
 [Music]

1375
02:15:36,530 --> 02:15:39,280
 well

1376
02:15:42,150 --> 02:15:46,740
 I do not

1377
02:15:46,829 --> 02:15:55,559
 At the moment there is no question for him because of the joke so I think that already

1378
02:15:55,560 --> 02:16:00,300
 we are almost here, what he's doing to me is

1379
02:16:00,300 --> 02:16:06,700
 straight and I'm going to show you that I don't

1380
02:16:07,070 --> 02:16:10,860
 in some others it is easier to analyze for example

1381
02:16:10,860 --> 02:16:17,070
 It depends on why in females lament ages he is

1382
02:16:17,070 --> 02:16:24,389
 more graphic the one of compilation is to read france to touch sometimes it is more beautiful and more

1383
02:16:24,390 --> 02:16:30,690
 quick to understand the graph to read we already looked at that but I wanted to show you the

1384
02:16:30,690 --> 02:16:34,558
 data strategies to create [Music]

1385
02:16:34,558 --> 02:16:39,198
 the signatures ready the first is by sting

1386
02:16:39,648 --> 02:16:43,538
 and code structure

1387
02:16:43,978 --> 02:16:48,648
 then also that it has to fulfill well

1388
02:16:52,799 --> 02:16:55,939
 [Music]

1389
02:16:59,239 --> 02:17:02,239
 9

1390
02:17:03,700 --> 02:17:06,270
 not

1391
02:17:07,790 --> 02:17:11,770
 I tell you that

1392
02:17:14,240 --> 02:17:19,459
 if they have the license to them of an excellent strategy if they do not have the

1393
02:17:19,459 --> 02:17:26,189
 license that will go are good and has many many many good things

1394
02:17:26,190 --> 02:17:30,379
 they can also do compact automations

1395
02:17:30,379 --> 02:17:40,580
 has has many things I am starting now, it is not what

1396
02:17:40,580 --> 02:17:44,030
 we are going to do is look for any function

1397
02:17:44,030 --> 02:17:51,160
 any functions implemented by him by the attacker and still

1398
02:17:51,330 --> 02:17:55,700
 They are the ones with the funk name or any time if they realize the

1399
02:17:55,700 --> 02:18:02,610
 yaqui about a month ago in a compilation is if you are suddenly

1400
02:18:02,610 --> 02:18:06,270
 they want to understand a little of what is happening in cee there it is if they want

1401
02:18:06,270 --> 02:18:12,880
 understand it in doing but let us assume that this function we assume

1402
02:18:12,880 --> 02:18:18,340
 more than this function is very particular to Trojan then you already what

1403
02:18:18,341 --> 02:18:24,049
 do is select it, you are this code

1404
02:18:24,049 --> 02:18:33,478
 and from there the work is very characteristic but let's no longer say what we are going to do

1405
02:18:33,478 --> 02:18:36,079
 is we go

1406
02:18:38,030 --> 02:18:46,209
 at that moment display we go here to this

1407
02:18:46,209 --> 02:18:52,320
 I click and I get this list, sorry because it doesn't look big

1408
02:18:52,639 --> 02:18:59,058
 like this, well, that's it

1409
02:18:59,370 --> 02:19:05,760
 I'm just going to look for them and now and here is what does the one that works for me

1410
02:19:05,760 --> 02:19:15,049
 make the rules so what I do is double click and that takes me out

1411
02:19:15,049 --> 02:19:22,160
 precisely this screen in what you tell me we are going to create a rule already at

1412
02:19:22,160 --> 02:19:26,929
 from those eyes of those instructions then you define

1413
02:19:26,929 --> 02:19:33,260
 which are to change well yes yes I do it does not also mean that it is going to

1414
02:19:33,260 --> 02:19:38,090
 have if it is enabled something that is not to say in some value samples by

1415
02:19:38,090 --> 02:19:47,019
 example makes puig first and I said no x in some in others with gps

1416
02:19:47,019 --> 02:19:50,729
 and I don't really care

1417
02:19:51,060 --> 02:19:57,609
 but if life is relevant in which that difference in the rule

1418
02:19:57,610 --> 02:20:03,521
 little path see says 53 if it is not important leaves it as an unknown that really

1419
02:20:03,521 --> 02:20:10,841
 3 you play like this, they put away and finally here in the lower part they have

1420
02:20:10,841 --> 02:20:16,860
 a network the face that it generates from the code

1421
02:20:16,860 --> 02:20:24,000
 source the code after compiled from the application then it is a rule will be a

1422
02:20:24,000 --> 02:20:29,800
 little more and from there comes s xxi

1423
02:20:29,800 --> 02:20:35,279
 number 2 then we already know the two strategies for

1424
02:20:35,280 --> 02:20:41,879
 and that the most interesting and that then we already responded through the

1425
02:20:41,879 --> 02:20:45,800
 cool stuff from the file like

1426
02:20:46,989 --> 02:20:50,948
 so far you have doubts

1427
02:20:53,370 --> 02:20:59,311
 Felipe see here the link that is the one in the previous question, the one of the mapping of the

1428
02:20:59,311 --> 02:21:04,351
 pigs tells us that of course his question was directed at strategies to

1429
02:21:04,351 --> 02:21:08,700
 find the command control servers or nodes with which it is

1430
02:21:08,700 --> 02:21:11,780
 communicates the common framework

1431
02:21:14,610 --> 02:21:21,520
 well then that there are many is you can say to free services to

1432
02:21:21,520 --> 02:21:23,970
 to download

1433
02:21:24,210 --> 02:21:28,410
 and build an automation for the extraction of configuration of those

1434
02:21:28,410 --> 02:21:33,750
 demand samples and the extraction to configuration of those samples from manual

1435
02:21:33,750 --> 02:21:37,800
 and with that you have command and control servers strategy number one

1436
02:21:37,800 --> 02:21:41,820
 then we are following dri decks you know how to extract the servers from

1437
02:21:41,820 --> 02:21:45,260
 command then you are going to see our such you are going

1438
02:21:45,260 --> 02:21:50,870
 to pumps and start downloading from there samples of direct parents for their

1439
02:21:50,870 --> 02:21:56,330
 automation and now you have a feed of gods ix from eating centers

1440
02:21:56,330 --> 02:22:04,820
 control and its number however if you do not have access to that type of files it

1441
02:22:04,820 --> 02:22:09,619
 you can do for example with services like chat then what you have to

1442
02:22:09,620 --> 02:22:14,710
 do now what are the features do

1443
02:22:14,710 --> 02:22:17,770
 basically a record you have to find what are the

1444
02:22:17,771 --> 02:22:21,930
 character those that have the servants of life

1445
02:22:21,930 --> 02:22:27,540
 what doors are open generally min what protocol they speak and the idea is

1446
02:22:27,540 --> 02:22:33,300
 press on it to serve in communion with it

1447
02:22:33,300 --> 02:22:38,789
 and you with a forty-year-old can take out the command and control servers

1448
02:22:38,790 --> 02:22:45,021
 directly you have in the form you generate from the files to be

1449
02:22:45,021 --> 02:22:49,990
 command and control servers like me feel to get the

1450
02:22:49,990 --> 02:22:53,100
 servers ready

1451
02:22:54,970 --> 02:22:58,858
 in both cases in terminations

1452
02:22:59,650 --> 02:23:06,810
 characteristic is that it is what makes those servers differentiate

1453
02:23:06,810 --> 02:23:12,500
 or those file files

1454
02:23:12,860 --> 02:23:18,101
 perfect, I think we are there, I hope

1455
02:23:18,939 --> 02:23:23,189
 felipe excuse me

1456
02:23:23,860 --> 02:23:28,870
 could serve first

1457
02:23:28,880 --> 02:23:35,149
 Felipe could also serve to run the sample straight

1458
02:23:35,149 --> 02:23:39,979
 while network traffic is being analyzed as true it could be a third

1459
02:23:39,979 --> 02:23:44,210
 approach certain always always true to

1460
02:23:44,210 --> 02:23:48,311
 wellness version of some houses too

1461
02:23:48,420 --> 02:23:54,290
 they had a little machine out there that infects her on purpose and

1462
02:23:54,290 --> 02:23:59,979
 they let run quite a lot and just monitor they have it there too from that

1463
02:23:59,979 --> 02:24:03,840
 so we get infected on purpose for what

1464
02:24:03,840 --> 02:24:08,859
 malware connects to users and updates as they have

1465
02:24:08,859 --> 02:24:14,359
 access to that information and it would also work

1466
02:24:14,359 --> 02:24:20,119
 well there are several several things there is also another way that in some cases

1467
02:24:20,119 --> 02:24:25,750
 connect to services and know what protocol you use and edges

1468
02:24:25,750 --> 02:24:29,260
 updated command and control servers from the botnet as

1469
02:24:29,260 --> 02:24:35,439
 such the case serves here for example pivot also have handle this type

1470
02:24:35,439 --> 02:24:42,120
 of things then but let's say you are

1471
02:24:44,600 --> 02:24:49,430
 but it's worth having them for him

1472
02:24:52,680 --> 02:24:59,199
 and this then if it came with another question

1473
02:24:59,319 --> 02:25:04,939
 I already told you how using interesting parts of the

1474
02:25:04,939 --> 02:25:11,629
 file we become interesting at the part level that are unique that characterize the

1475
02:25:11,629 --> 02:25:16,200
 file how to generate signatures that allow us to detect

1476
02:25:16,200 --> 02:25:21,229
 We already know how to put in now we are going to little what is the most

1477
02:25:21,229 --> 02:25:23,499
 interesting

1478
02:25:24,440 --> 02:25:28,940
 we want to unpack it does not disappear we want to bring the information automatically

1479
02:25:28,940 --> 02:25:35,181
 the configuration so that if we see this sample again we do not have to

1480
02:25:35,181 --> 02:25:40,610
 believe me again the sentence will simply run a script and

1481
02:25:40,610 --> 02:25:47,171
 extract the information in that order in that order of ideas first

1482
02:25:48,011 --> 02:25:51,661
 in that order of ideas

1483
02:25:52,330 --> 02:25:59,319
 let's go there to try to find what the configuration is like where

1484
02:25:59,319 --> 02:26:05,461
 one of the things is how more interesting I will keep as

1485
02:26:05,461 --> 02:26:10,711
 the hotties where they put the webb ellis where they put three of the servers

1486
02:26:10,711 --> 02:26:15,999
 command and control so that you can generally connect

1487
02:26:15,999 --> 02:26:21,289
 have been heard of good practices arco

1488
02:26:21,290 --> 02:26:27,500
 The idea is to use, for example, things like inheritance per floor, things like

1489
02:26:27,500 --> 02:26:36,161
 allow you to start reusing as much as so that you don't

1490
02:26:36,161 --> 02:26:42,189
 you have to rewrite rest when you develop it yourself

1491
02:26:42,189 --> 02:26:47,920
 used on attackers it would not make sense that for every attack someone

1492
02:26:47,920 --> 02:26:54,130
 dance and have to compile again

1493
02:26:54,391 --> 02:27:02,940
 just to change one thing you have now we have the server 13 135 and have o

1494
02:27:02,940 --> 02:27:08,160
 recompile everything no they try to reuse things so it tastes good

1495
02:27:08,160 --> 02:27:14,070
 It is easy as we conventional developers do it.

1496
02:27:14,070 --> 02:27:21,541
 what it does is that generally the handle uses as a base code that

1497
02:27:21,541 --> 02:27:27,590
 that safe immutable code and a configuration

1498
02:27:27,600 --> 02:27:32,119
 in case they touch to update it

1499
02:27:32,610 --> 02:27:37,021
 but we change the configuration that allows is that if we

1500
02:27:37,021 --> 02:27:42,640
 we found here and we understand how it is saved with we could

1501
02:27:42,640 --> 02:27:46,960
 [Music] generalize that to any sample

1502
02:27:46,960 --> 02:27:54,099
 from that same family is what we are going to do in the case of resentment if we

1503
02:27:54,100 --> 02:27:56,520
 we enter

1504
02:27:57,110 --> 02:28:02,460
 strange remember that I used in strings a stream called settings

1505
02:28:02,460 --> 02:28:09,750
 being unfair is configuration then normality from there

1506
02:28:09,750 --> 02:28:14,841
 The word series is striking, it is like today here and here you can save

1507
02:28:14,841 --> 02:28:20,920
 something that interests us then just for that

1508
02:28:20,920 --> 02:28:24,689
 I no longer bring

1509
02:28:25,359 --> 02:28:31,009
 characteristic of this sample how they can extract the information and when

1510
02:28:31,009 --> 02:28:36,720
 I saw they were told and that's why my analysis

1511
02:28:36,720 --> 02:28:42,300
 from here onwards it will start from 6 in this

1512
02:28:42,300 --> 02:28:45,170
 moment for me the most

1513
02:28:45,330 --> 02:28:53,440
 let's see what he does with this, where do we find 6 then let's do it

1514
02:28:53,440 --> 02:28:59,750
 for two parts we are going to close

1515
02:29:00,529 --> 02:29:05,190
 and I no longer need any of that we saw all this

1516
02:29:05,190 --> 02:29:08,269
 [Music]

1517
02:29:14,610 --> 02:29:21,390
 the pod for you to see

1518
02:29:22,470 --> 02:29:26,810
 how can it be done then

1519
02:29:28,470 --> 02:29:32,960
 we find the paper file

1520
02:29:35,460 --> 02:29:41,199
 and the air but one does not carry

1521
02:29:41,200 --> 02:29:48,040
 graphically I like it and I am much more laid

1522
02:29:48,600 --> 02:29:52,410
 it seems easier to me

1523
02:29:55,979 --> 02:30:01,720
 If we go with life then but what are we going to do is control shift

1524
02:30:01,720 --> 02:30:04,140
 efe

1525
02:30:07,470 --> 02:30:11,279
 with 15

1526
02:30:11,620 --> 02:30:18,040
 If you fire, I know what will happen, let's go to the strings section.

1527
02:30:18,040 --> 02:30:23,020
 within strings we were interested in just one

1528
02:30:23,020 --> 02:30:25,920
 and series

1529
02:30:26,620 --> 02:30:33,460
 I double click on settings and it takes me to the string where it appears

1530
02:30:33,460 --> 02:30:40,310
 something just a click and x uses x

1531
02:30:40,590 --> 02:30:49,320
 Oscar in whom beings exist in places of the code and then he tells me

1532
02:30:49,560 --> 02:30:55,740
 I click and here I have a subtle settings

1533
02:30:55,740 --> 02:31:04,060
 talks about the kings after the achievements and shorts saiz aprista that is

1534
02:31:04,060 --> 02:31:08,640
 well I insist I'm still not well I'm not well

1535
02:31:08,640 --> 02:31:15,380
 I'm just watching and that's why I tell you

1536
02:31:15,380 --> 02:31:20,958
 is the analysis of the relevant pop is to understand that it is

1537
02:31:20,959 --> 02:31:23,169
 relevant

1538
02:31:25,250 --> 02:31:29,690
 that will help them a lot and instead of leaving in amazement when they already try

1539
02:31:29,690 --> 02:31:34,090
 what is the important part worth analyzing there is shield

1540
02:31:34,090 --> 02:31:40,240
 but what he means here is that the setting exists and they are looking for it

1541
02:31:40,240 --> 02:31:49,740
 like a resort which is a section in the binary that microsoft gives you

1542
02:31:50,220 --> 02:31:55,789
 put there as elements suddenly music images something that they are going to use

1543
02:31:55,790 --> 02:32:02,630
 initially and days to see the bones we are going to take out

1544
02:32:02,630 --> 02:32:08,699
 and we will go through the folders if they realize there is one

1545
02:32:08,700 --> 02:32:15,291
 crisis folder and in selling there is information but that information does not

1546
02:32:15,291 --> 02:32:21,189
 it has a clear format if it does not have a clear format it seems to me

1547
02:32:21,190 --> 02:32:24,910
 important because why

1548
02:32:24,910 --> 02:32:27,969
 [Music]

1549
02:32:28,100 --> 02:32:34,340
 it is something they say settings and addition to the one that says settings not

1550
02:32:34,340 --> 02:32:39,409
 It is an apparently involved text plan setup and is on click

1551
02:32:39,409 --> 02:32:44,350
 It is important of the rest they would have left it

1552
02:32:44,351 --> 02:32:50,440
 any developer and it is more if you are protecting

1553
02:32:52,899 --> 02:32:59,050
 of the users you would not leave that as well as you protect what you

1554
02:32:59,050 --> 02:33:04,390
 attackers matter, so do they, so how we are is snooping at

1555
02:33:04,390 --> 02:33:08,979
 see what interests them because for me it already has a great

1556
02:33:08,979 --> 02:33:11,278
 relevance

1557
02:33:11,510 --> 02:33:20,279
 then in the ceim see that at 16 because apparently they are hiding

1558
02:33:20,279 --> 02:33:23,749
 so far they have any doubts

1559
02:33:24,609 --> 02:33:29,159
 that would be like in the approach from haina

1560
02:33:29,159 --> 02:33:39,049
 in counterpart of the code in aida vila search for strings

1561
02:33:40,640 --> 02:33:43,999
 and here

1562
02:33:45,480 --> 02:33:52,761
 and two appear today we are going to click on the first one double click

1563
02:34:00,711 --> 02:34:06,250
 and it will be double click and if they notice in my position

1564
02:34:06,250 --> 02:34:11,830
 in the code and in the place where series is found, the cross references it

1565
02:34:11,830 --> 02:34:17,289
 makes triple Xs and not simply here the function appears if I give it

1566
02:34:17,290 --> 02:34:22,270
 double click I get the ac milan this is the example and if we compare it with that of

1567
02:34:22,270 --> 02:34:28,300
 the idea is that of saint georges the shorts investor is urged the resorts

1568
02:34:28,300 --> 02:34:33,920
 but the most interesting thing to follow could be what it is

1569
02:34:33,920 --> 02:34:40,490
 that is to say the here he indeed we are going to look

1570
02:34:40,490 --> 02:34:46,250
 one called 6 let's load it is there we can

1571
02:34:46,250 --> 02:34:52,690
 seemingly understand what returns here is like a sweet but

1572
02:34:52,860 --> 02:34:56,391
 and here we have how

1573
02:34:57,840 --> 02:35:01,520
 in the ceim blair what is happening

1574
02:35:03,061 --> 02:35:06,561
 so far you ask

1575
02:35:17,181 --> 02:35:21,771
 no questions are seen yet happy

1576
02:35:23,811 --> 02:35:35,230
 then and well it happens that it is quite hope they are following me then what

1577
02:35:35,230 --> 02:35:41,439
 What we are going to do here is the matter as in reverse but little by little then already

1578
02:35:41,440 --> 02:35:46,210
 we know what is responsible for loading them this is like taking

1579
02:35:46,210 --> 02:35:55,279
 services and apparently they return it as in a buffer 9

1580
02:35:55,329 --> 02:36:00,710
 look at everything that is there but the idea with insurance that today the basic idea

1581
02:36:00,710 --> 02:36:07,179
 is that this soft of floors [Music]

1582
02:36:07,180 --> 02:36:16,899
 in the function change it manual and I will put

1583
02:36:18,971 --> 02:36:22,910
 that is, this is the code that is in charge of

1584
02:36:22,910 --> 02:36:29,890
 now let's start from there to back I want to know where that cut is used

1585
02:36:29,890 --> 02:36:33,899
 today x to get a cross reference from me

1586
02:36:33,899 --> 02:36:40,499
 out sets function and double click on the code between go to this site in

1587
02:36:40,499 --> 02:36:42,590
 this site [Music]

1588
02:36:42,590 --> 02:36:49,040
 is where that acz happens and this is where you have to apply a little

1589
02:36:49,040 --> 02:36:53,770
 well of logic we know that beings were loaded here

1590
02:36:53,770 --> 02:37:02,489
 we see that the injured have a format that is not plain text

1591
02:37:02,489 --> 02:37:09,659
 closed then all processing afterwards would sometimes be worth it

1592
02:37:09,659 --> 02:37:16,319
 look and that where it happens I was looking for functions everything that she with but what

1593
02:37:16,319 --> 02:37:22,979
 arrives with and you are not recognized by him by air in this case then we will not

1594
02:37:22,979 --> 02:37:29,449
 find me this and is and this if you do not have to do with functions and

1595
02:37:29,450 --> 02:37:37,721
 how is your routines ready these two are act block

1596
02:37:37,721 --> 02:37:43,240
 and it is their routines that the developer of el mangal implemented then in this

1597
02:37:43,240 --> 02:37:48,850
 case is worth if I enter now it would be worth it

1598
02:37:48,850 --> 02:37:55,740
 review two little things that let's say we look at the analogy of

1599
02:37:55,930 --> 02:38:03,069
 on tour we have our loris function here to change the name we are going to

1600
02:38:03,069 --> 02:38:10,320
 put it and say malware I know

1601
02:38:15,069 --> 02:38:19,609
 view in this case and now we are going to do a

1602
02:38:19,610 --> 02:38:25,221
 cross referent then for that what you have to go necessary to use from here

1603
02:38:25,221 --> 02:38:31,939
 and look at the cross reference where it happens here it says ex reference for that

1604
02:38:31,940 --> 02:38:37,340
 side leads me to the same as this welcome

1605
02:38:37,340 --> 02:38:45,000
 and as I tell you in this section what interests us are both are the

1606
02:38:45,000 --> 02:38:52,500
 with functions that are not recognized but belong to the code

1607
02:38:52,500 --> 02:38:59,161
 developer that I know this would be code 15 of those two

1608
02:38:59,161 --> 02:39:04,281
 functions already if you like it more

1609
02:39:07,030 --> 02:39:12,570
 It depends seen then here so far we go in the same

1610
02:39:12,570 --> 02:39:17,061
 as in china the advantage of using

1611
02:39:17,440 --> 02:39:25,110
 in the compiled code as well in case any questions are required

1612
02:39:35,680 --> 02:39:41,050
 well then

1613
02:39:41,050 --> 02:39:47,519
 we continue in our curiosity this is the first function that

1614
02:39:47,520 --> 02:39:53,149
 I'm going to double click it if they realize it's a function

1615
02:39:54,310 --> 02:40:01,721
 that have the arguments already there but all it does is take and

1616
02:40:01,721 --> 02:40:06,270
 and they are sent to another function that is inside that is, it is like a wrap

1617
02:40:06,270 --> 02:40:14,101
 it is not your logic the only thing it does is fix everything to call another function

1618
02:40:14,101 --> 02:40:20,631
 double click and this is where there is something interesting

1619
02:40:21,311 --> 02:40:27,431
 whenever we are talking about obfuscation or inscription it is common

1620
02:40:27,431 --> 02:40:34,150
 Finding the forums and a forum in Jaén makes English because it would look like this

1621
02:40:34,150 --> 02:40:38,369
 more as long as this is not fulfilled

1622
02:40:38,370 --> 02:40:45,030
 condition if the condition is met in this case

1623
02:40:45,170 --> 02:40:56,341
 the same here but the most relevant of this forum and that is why it is easier to understand

1624
02:40:56,341 --> 02:41:03,721
 so if you write h it is a forte 0 to 200

1625
02:41:03,721 --> 02:41:07,921
 this code here if you do the detailed analysis

1626
02:41:07,921 --> 02:41:13,951
 he is initializing from a count array where position 0 has values

1627
02:41:13,951 --> 02:41:16,160
 0

1628
02:41:17,770 --> 02:41:21,910
 e and that

1629
02:41:21,910 --> 02:41:26,039
 where that happens

1630
02:41:26,660 --> 02:41:30,430
 if you are looking for rc

1631
02:41:32,739 --> 02:41:35,279
 Y

1632
02:41:35,390 --> 02:41:39,399
 r 104 algorithm

1633
02:41:40,021 --> 02:41:50,840
 the first ace first thing for zero count and then this is where just

1634
02:41:53,629 --> 02:42:02,790
 cryptography to determine something the code algorithms like blood 4

1635
02:42:02,790 --> 02:42:08,181
 13 4 is very important very very very important

1636
02:42:08,181 --> 02:42:15,489
 but rc4 in ascend rc4 in sense should

1637
02:42:15,489 --> 02:42:22,590
 As I say, he is a rapper, this one deserves 4 and

1638
02:42:22,590 --> 02:42:28,811
 key then he effectively action

1639
02:42:29,000 --> 02:42:35,329
 from 0 to 100 in 200 and then the value

1640
02:42:35,329 --> 02:42:40,538
 and this is where this thing I like the most to see is full

1641
02:42:42,010 --> 02:42:49,040
 initial you are more days behind on the set and come I'm fine and see unfairly

1642
02:42:49,040 --> 02:42:53,170
 what you think of that straight from the set

1643
02:42:53,170 --> 02:42:58,250
 perfect okay then you could go this way this is what it is

1644
02:42:58,250 --> 02:43:03,740
 happening here then it starts at zero initially the value is

1645
02:43:03,740 --> 02:43:08,270
 zero after would be one after would be where

1646
02:43:08,270 --> 02:43:10,779
 d

1647
02:43:10,820 --> 02:43:13,301
 and

1648
02:43:13,359 --> 02:43:20,260
 but I occasionally like it graphic I like it that way simply because

1649
02:43:20,260 --> 02:43:28,359
 What when I go to look for a 256 deserves that there is a loop if there is a 256 and

1650
02:43:28,359 --> 02:43:35,199
 it is very highly probable that it is that when that is why I like it here however

1651
02:43:35,199 --> 02:43:37,439
 this

1652
02:43:38,180 --> 02:43:42,170
 I don't know here yes

1653
02:43:43,000 --> 02:43:49,040
 here from how to change it

1654
02:43:49,040 --> 02:43:54,110
 the tenth anxiety to think that you can not live the chance would be very good of

1655
02:43:54,110 --> 02:44:00,560
 otherwise I do not know but it should be possible to tell them I carry fish meal with

1656
02:44:00,560 --> 02:44:05,080
 cider pp has recently been seen so far we go

1657
02:44:05,380 --> 02:44:09,920
 Well finally in what you call what is the most

1658
02:44:09,920 --> 02:44:13,271
 interesting what were we looking for

1659
02:44:13,550 --> 02:44:19,099
 algorithm configuration uses we determine what it was when rc4

1660
02:44:19,100 --> 02:44:24,600
 well this part of how can I t and we already know also how to detect the

1661
02:44:24,600 --> 02:44:29,700
 file remember the 4 always started with

1662
02:44:29,700 --> 02:44:37,210
 a forte 0 255 whenever you see that think of c4

1663
02:44:37,210 --> 02:44:45,609
 after that we are going to automate then the interesting thing

1664
02:44:45,610 --> 02:44:49,840
 detect an algorithm when we talk about algorithm from

1665
02:44:49,840 --> 02:44:56,439
 algorithms we have to standard it in libraries that implement the algorithm

1666
02:44:56,439 --> 02:45:02,209
 in other languages ​​at least this is jogging because that is easy

1667
02:45:02,209 --> 02:45:05,891
 get it then

1668
02:45:05,891 --> 02:45:11,891
 to decrypt the information that the algorithm owes we need the

1669
02:45:11,891 --> 02:45:18,500
 encrypted information and we need the key, the only component that makes us

1670
02:45:18,500 --> 02:45:24,910
 so we need here to understand a little more about how this is happening

1671
02:45:24,910 --> 02:45:32,029
 we could make it static of like almost all of that but it would be more time consuming

1672
02:45:32,029 --> 02:45:36,880
 so this is where it pays to mix we sold

1673
02:45:36,880 --> 02:45:42,769
 as from what he learns what we are going to learn an enter

1674
02:45:42,770 --> 02:45:49,170
 and the most interesting thing about this we are going to give it a name here

1675
02:45:49,170 --> 02:45:59,220
 and this would be rc4 init because it is the inning because it is the look of 0 like this

1676
02:45:59,220 --> 02:46:03,410
 want the value of the array the value zero is

1677
02:46:03,410 --> 02:46:05,649
 zero

1678
02:46:05,670 --> 02:46:11,700
 this is he is the first part we return this is a rapper we said

1679
02:46:11,700 --> 02:46:15,351
 then malware [Music]

1680
02:46:15,351 --> 02:46:19,329
 rc four innings 4

1681
02:46:19,329 --> 02:46:23,219
 and we return again

1682
02:46:23,649 --> 02:46:34,740
 we can refer to various parts of the communication in the algorithm

1683
02:46:34,740 --> 02:46:42,539
 it is encrypted for example with rs 4 that is however in our in that

1684
02:46:43,359 --> 02:46:47,039
 what we want is the configuration

1685
02:46:48,300 --> 02:46:53,880
 after it is initialized, then

1686
02:46:53,880 --> 02:47:02,849
 in description light then finally the breaststroke and 4 what it does

1687
02:47:02,850 --> 02:47:09,239
 at the end and make an exhortation into account the annex I

1688
02:47:09,239 --> 02:47:12,380
 like more than 95

1689
02:47:13,830 --> 02:47:20,210
 in English you can see that it makes steps [Music]

1690
02:47:20,210 --> 02:47:24,180
 to guarantee the algorithm basically is

1691
02:47:24,181 --> 02:47:29,961
 the general of the matrix that is the one that I comment on this matrix is

1692
02:47:29,961 --> 02:47:36,689
 which is from 0 to 155 and at

1693
02:47:37,480 --> 02:47:45,660
 it is the latter makes a nexus between the affa with the key that with the time

1694
02:47:46,360 --> 02:47:55,330
 with the general cone with this pseudo random thing a red devils with a

1695
02:47:55,330 --> 02:48:00,039
 random byte array and already uses the characters from that array to do

1696
02:48:00,040 --> 02:48:05,970
 connection with the data text plan is to say the last thing

1697
02:48:05,970 --> 02:48:08,300
 does is

1698
02:48:08,931 --> 02:48:13,771
 and not following that logic if I go to the

1699
02:48:13,771 --> 02:48:20,709
 next function and in this next function that are fixed

1700
02:48:20,709 --> 02:48:27,229
 receives some data received and the one that uses another function in the middle, that is,

1701
02:48:27,229 --> 02:48:29,438
 it is like

1702
02:48:29,450 --> 02:48:37,250
 and returns I am interested in what is inside and here is another knot and in that place and

1703
02:48:37,250 --> 02:48:42,470
 nexus is to say that something catches my attention

1704
02:48:42,470 --> 02:48:49,710
 this apparently both the rc 4 act

1705
02:48:49,710 --> 02:48:57,919
 You are the 4t and I return and that is what

1706
02:48:59,590 --> 02:49:03,740
 that state the females that we are going to see the day

1707
02:49:03,740 --> 02:49:10,539
 madero deserves four scripts to break

1708
02:49:11,060 --> 02:49:15,109
 that how it looks here

1709
02:49:15,920 --> 02:49:22,220
 then this is the king that is the mistake if we are going to return I am not going to rename

1710
02:49:22,220 --> 02:49:27,149
 all this is the rocker who spoke to them

1711
02:49:27,149 --> 02:49:34,439
 and this is the function where the description is made, which is another work but this

1712
02:49:34,439 --> 02:49:39,641
 It is finally the one that makes the crypt and there must be a wine look

1713
02:49:39,641 --> 02:49:45,211
 and a look that makes an exhortation that makes

1714
02:49:45,430 --> 02:49:52,310
 then indeed out there it is for him it is like

1715
02:49:52,310 --> 02:49:56,990
 well I'm not going to review if you arm but simply

1716
02:49:56,990 --> 02:50:02,430
 is and the next thing I want to know

1717
02:50:02,430 --> 02:50:09,681
 [Music] like this how it's generating

1718
02:50:09,681 --> 02:50:13,161
 what is the logic behind that and for that

1719
02:50:13,161 --> 02:50:20,081
 it will simply follow the code but we are no longer going to put

1720
02:50:20,330 --> 02:50:23,530
 the breakdance

1721
02:50:24,209 --> 02:50:33,150
 once law is made at the time it is held 4 let's see

1722
02:50:33,150 --> 02:50:36,270
 and voila we capture the information that month

1723
02:50:36,270 --> 02:50:41,930
 lasts and with that we generate our automation to extract the list

1724
02:50:41,930 --> 02:50:48,439
 then space of prime space we can already see

1725
02:50:48,439 --> 02:50:57,589
 exactly the address where these routines are as is already the address

1726
02:50:58,181 --> 02:51:02,600
 that's why you need to know where to put them bacon

1727
02:51:02,600 --> 02:51:08,529
 and that's it, then I'll take the file from the block packaging

1728
02:51:08,529 --> 02:51:13,209
 and I put the break points where I am interested

1729
02:51:13,209 --> 02:51:16,350
 meanwhile you ask

1730
02:51:23,920 --> 02:51:27,270
 this is the first record

1731
02:51:36,420 --> 02:51:40,920
 Estimated innovation is an estimable treats of approx

1732
02:51:40,920 --> 02:51:47,910
 in some cases low in others not so much they will see things

1733
02:51:47,910 --> 02:51:52,920
 quite rare but it can give you an idea remember that all this is what

1734
02:51:52,920 --> 02:51:57,210
 that is doing the reconstruction that nobody the binary what he has are the

1735
02:51:57,210 --> 02:52:03,449
 autos de los colts passes to a compiler to make codes are assembler which is

1736
02:52:03,450 --> 02:52:09,000
 the closest and no more mind and xstrata interprets licenses in blair pop

1737
02:52:09,000 --> 02:52:12,460
 to make it a little easier in some fields

1738
02:52:12,460 --> 02:52:15,390
 but all

1739
02:52:23,160 --> 02:52:30,869
 I think you have to know how to learn, that is, in some cases if you

1740
02:52:30,870 --> 02:52:38,119
 They are looking at clothes to see if there is something that quickly

1741
02:52:38,119 --> 02:52:43,609
 read if you see the cce and do not have an idea look at the simple and put

1742
02:52:43,609 --> 02:52:49,760
 there as more in the story to see if indeed and if you can understand more

1743
02:52:49,760 --> 02:52:56,569
 but first go with the sen watched try to see if he suddenly understands

1744
02:52:56,569 --> 02:53:01,340
 but go to the companies that make you feel but you're going to delay taking

1745
02:53:01,340 --> 02:53:06,290
 civil and the issue is that the action must also understand global because in the

1746
02:53:06,290 --> 02:53:12,040
 de bouwer you only have ac mlr then you have to

1747
02:53:12,040 --> 02:53:20,260
 know how to start those two things but it is not nights in chapín saco

1748
02:53:20,260 --> 02:53:23,189
 compilers

1749
02:53:25,850 --> 02:53:30,850
 there is a question that you have for the most

1750
02:53:32,400 --> 02:53:35,730
 without passion

1751
02:53:35,801 --> 02:53:41,399
 no no no [Music]

1752
02:53:42,750 --> 02:53:48,750
 so she wants her sister is

1753
02:53:49,579 --> 02:53:53,800
 and that's it then what are we going to do

1754
02:53:53,800 --> 02:53:58,080
 that as I tell you I already put the sea

1755
02:53:58,550 --> 02:54:05,060
 what was the function who the rc 4 mimics all the part of race 4

1756
02:54:05,060 --> 02:54:13,670
 that after 6 suns and 50 years 1 garcía actions two are fast waves of

1757
02:54:13,670 --> 02:54:15,970
 roxette

1758
02:54:16,460 --> 02:54:24,740
 of the hundreds of functions that have thousands of assembly lines we have seen

1759
02:54:24,740 --> 02:54:31,250
 no more than 100 I don't think they are more than 100 good I insist a malware analyst

1760
02:54:31,250 --> 02:54:36,730
 does not have and understand that completely from the

1761
02:54:36,730 --> 02:54:41,230
 start to finish the Chinese manual must understand what the

1762
02:54:41,230 --> 02:54:44,750
 worth and is what is really worth is

1763
02:54:44,750 --> 02:54:52,959
 the use case of you for what did I already have the project so I'm going to

1764
02:54:52,959 --> 02:54:56,730
 put give the sample until it reaches this

1765
02:54:56,730 --> 02:55:05,150
 point 78 40 21 78 I give it play there we are

1766
02:55:05,150 --> 02:55:10,591
 let's see the follow-up then if I enter here

1767
02:55:10,591 --> 02:55:16,801
 this receives two parameters I want to know which parameter it receives then for

1768
02:55:16,801 --> 02:55:25,260
 I have two things here, take a good look here in this part in the east of the

1769
02:55:25,261 --> 02:55:31,400
 parameters the first if I follow it

1770
02:55:31,980 --> 02:55:36,189
 amen this is the stack these are two

1771
02:55:36,190 --> 02:55:39,580
 parameters what is

1772
02:55:39,580 --> 02:55:44,279
 then we enter the definition here we are going to alter

1773
02:55:44,279 --> 02:55:51,079
 with stable citation step and we will see that it is sent final

1774
02:55:53,120 --> 02:55:57,530
 we are entering the proper I want to see is initialist coke to see a little bit of

1775
02:55:57,530 --> 02:56:03,649
 13-4 when he makes the forum from scratch

1776
02:56:03,649 --> 02:56:10,038
 there is a part of that you have to use yes or yes and then and in what does the

1777
02:56:10,039 --> 02:56:15,859
 key module and the account then appears in a

1778
02:56:15,859 --> 02:56:19,720
 part of

1779
02:56:20,110 --> 02:56:28,051
 here someone in a viable moment rc4 the key let's see that winter

1780
02:56:28,051 --> 02:56:33,130
 Well, we are going to see which parameters to change are two when he does puig to the

1781
02:56:33,130 --> 02:56:40,420
 be these are two words or we are just going to run the track

1782
02:56:40,420 --> 02:56:45,640
 here they are waiting is for us these were the ones he sent

1783
02:56:45,640 --> 02:56:51,099
 if I click on it you can see here in the stack or you can see here the

1784
02:56:51,100 --> 02:56:56,939
 parameters by either of the two but something important is

1785
02:56:56,939 --> 02:57:01,540
 how to right click following long time

1786
02:57:01,540 --> 02:57:07,630
 7 and the other is af

1787
02:57:07,630 --> 02:57:12,990
 it's funny because and here you are and that's it

1788
02:57:13,040 --> 02:57:19,440
 Let's call him a lot and in a distance better days try

1789
02:57:19,440 --> 02:57:25,189
 of rollbacks the first time the first Trojan that network

1790
02:57:25,189 --> 02:57:32,351
 how full the answer to all our questions

1791
02:57:32,351 --> 02:57:36,331
 notice that there is a buffer

1792
02:57:36,400 --> 02:57:42,220
 and the resort has a 7 and 2 100 that's

1793
02:57:42,220 --> 02:57:47,529
 exactly what you need an effect and fps

1794
02:57:47,530 --> 02:57:51,450
 the first dance

1795
02:57:51,591 --> 02:57:57,950
 something makes me think it is always good to generate my ideas and

1796
02:57:57,950 --> 02:58:03,880
 that we are going to send to this function is a

1797
02:58:05,150 --> 02:58:12,609
 is the key and if 4 English have been reversed and now I am sending

1798
02:58:12,610 --> 02:58:18,670
 and a bit that apparently could be a length

1799
02:58:18,670 --> 02:58:23,989
 I could generate an effect that in this woman

1800
02:58:23,989 --> 02:58:30,770
 The first part, the key fight, they have those from Boyacá

1801
02:58:30,770 --> 02:58:33,339
 efe

1802
02:58:35,199 --> 02:58:40,271
 this would be the key is a theory that has been fulfilled

1803
02:58:40,271 --> 02:58:46,761
 really that's the way it is, we're going to vary it, but that may be a priority, we can

1804
02:58:46,761 --> 02:58:52,090
 enter the code and business but I do not want to eat

1805
02:58:53,770 --> 02:59:00,160
 but effectively it is as well as he or as valid that it is indeed so

1806
02:59:00,160 --> 02:59:09,950
 if in the design part with a part of the code that would be the exhortation that

1807
02:59:09,950 --> 02:59:14,910
 this would be the first exodus

1808
02:59:14,910 --> 02:59:20,101
 what they do is with the dance it means that we are at the top this is what

1809
02:59:20,101 --> 02:59:22,641
 what do you use

1810
02:59:24,840 --> 02:59:31,641
 from now on we are going to do the test and this as a doctor know as a theory

1811
02:59:31,641 --> 02:59:36,490
 we can effectively enter the cot [Music]

1812
02:59:36,490 --> 02:59:42,851
 but for the purpose of not being left as already as without time and it is also like a

1813
02:59:42,851 --> 02:59:48,160
 army more personal than anything else you look at feel try to

1814
02:59:48,160 --> 02:59:52,681
 analyze and also remember that not everything is

1815
02:59:52,811 --> 02:59:59,671
 it is simply with logic and this

1816
03:00:01,351 --> 03:00:07,141
 then we already know that the embi here then

1817
03:00:07,440 --> 03:00:15,480
 let's keep going back and we're going to continue with the second function what I tell you the

1818
03:00:15,480 --> 03:00:20,900
 rapper then this function

1819
03:00:21,489 --> 03:00:27,039
 and the one that interests us is that it is 13 4 click

1820
03:00:27,040 --> 03:00:30,630
 what would this be out

1821
03:00:31,830 --> 03:00:39,310
 I want to enter then I do this milestone and I will look for the exhortation then

1822
03:00:39,310 --> 03:00:45,670
 remember I'm looking for a sun what would this be

1823
03:00:47,770 --> 03:00:54,119
 and says the text now to corroborate that my theory

1824
03:00:59,200 --> 03:01:04,530
 bike that you have to do the exhortation which one you have to address to that

1825
03:01:04,530 --> 03:01:09,699
 then and we pay them out

1826
03:01:09,699 --> 03:01:15,869
 we put a break point we execute and validate what is k

1827
03:01:17,561 --> 03:01:21,130
 'we urge York

1828
03:01:21,551 --> 03:01:30,590
 and if we follow the second value in the second value is found

1829
03:01:31,070 --> 03:01:35,680
 the third and so simply is to say that home

1830
03:01:35,680 --> 03:01:41,710
 of the key we already have map everything and at least we can terminate the

1831
03:01:41,710 --> 03:01:48,369
 analysis at this level and that is what gives us to know that we learned from all this

1832
03:01:48,370 --> 03:01:52,109
 code is this

1833
03:01:54,760 --> 03:02:00,420
 I will not continue walking in that and here by car

1834
03:02:00,420 --> 03:02:06,870
 then now on click now no questions asked

1835
03:02:19,940 --> 03:02:28,261
 suggestions that we go there is a question from felippe

1836
03:02:29,790 --> 03:02:39,190
 it is not for this case it is for this case further reminds me of what I learned in

1837
03:02:39,190 --> 03:02:45,761
 This case is not that the first dance of the date is that new one is what we get

1838
03:02:45,761 --> 03:02:51,450
 from the network what we get is the structure of the resort and the first dance of the resort

1839
03:02:51,450 --> 03:02:59,131
 ravines is the length of the jac the next bytes are the flame

1840
03:02:59,131 --> 03:03:05,500
 after that the data will go so they can change it

1841
03:03:05,500 --> 03:03:09,030
 but it will always remain

1842
03:03:09,261 --> 03:03:19,370
 the key and that's what we learned from reversing rhythms

1843
03:03:19,460 --> 03:03:27,320
 and why is it worth it already here in this code

1844
03:03:28,409 --> 03:03:33,989
 extract the re source 6 is already automatically yutaka I just have to

1845
03:03:33,989 --> 03:03:38,159
 to do is they copied a file we are going to do it

1846
03:03:38,159 --> 03:03:42,139
 there radiant

1847
03:03:42,690 --> 03:03:48,841
 I'm going to copy this file I break

1848
03:03:51,391 --> 03:03:54,750
 I don't know he said

1849
03:03:54,750 --> 03:03:57,260
 your

1850
03:03:58,260 --> 03:04:01,860
 I have my art

1851
03:04:01,920 --> 03:04:05,270
 what I'm going to tell you is

1852
03:04:05,351 --> 03:04:13,021
 here we are going to load the spring that would be used this evolution is transversal

1853
03:04:13,440 --> 03:04:17,460
 [Music] but no

1854
03:04:17,460 --> 03:04:20,960
 extra courses

1855
03:04:22,250 --> 03:04:27,680
 seen and functional

1856
03:04:36,720 --> 03:04:43,608
 up there and let's look at space and it happened like

1857
03:04:46,440 --> 03:04:50,721
 I want to want to want to see how they look love

1858
03:04:50,950 --> 03:04:55,480
 I'm going to curate my country code

1859
03:05:01,470 --> 03:05:07,590
 at times as is as dt of 7

1860
03:05:07,590 --> 03:05:14,939
 besides the conversion like this but then basically 7b

1861
03:05:15,390 --> 03:05:20,399
 brackets subsequently actively whistled

1862
03:05:20,399 --> 03:05:30,869
 fv brackets of this we said the key is made

1863
03:05:31,670 --> 03:05:36,939
 anna tarres but from where to where

1864
03:05:37,301 --> 03:05:42,180
 in vain

1865
03:05:42,421 --> 03:05:51,781
 from the value 10 to the value this was going to

1866
03:05:51,781 --> 03:06:00,270
 understand until then it would be from 1 to research

1867
03:06:00,270 --> 03:06:04,569
 be if you want to make it a little more entel

1868
03:06:04,569 --> 03:06:10,288
 and the length of the key the principle of reason

1869
03:06:11,010 --> 03:06:15,229
 I start then

1870
03:06:15,530 --> 03:06:23,230
 of length and we know that the key starts from the length

1871
03:06:23,439 --> 03:06:28,560
 And that means

1872
03:06:30,270 --> 03:06:36,980
 ready the key of our calculations very easy

1873
03:06:38,279 --> 03:06:41,989
 the key would end

1874
03:06:44,130 --> 03:06:49,640
 it shouldn't be a quotation mark

1875
03:06:50,660 --> 03:06:56,660
 99 30 799 mail

1876
03:06:56,660 --> 03:07:01,330
 Let's see if we are [Music]

1877
03:07:01,330 --> 03:07:03,870
 Y

1878
03:07:04,701 --> 03:07:09,680
 I thought yes that before 90

1879
03:07:12,979 --> 03:07:16,878
 and we are finishing

1880
03:07:18,270 --> 03:07:22,399
 the quotes is because saving pressure

1881
03:07:24,189 --> 03:07:32,369
 they have to add one more from scratch and one more

1882
03:07:33,270 --> 03:07:36,319
 [Music]

1883
03:07:36,439 --> 03:07:44,030
 the important thing is that the key determined minimum and does not have

1884
03:07:44,490 --> 03:07:52,369
 then there will be 91 now this morning and we know the date

1885
03:07:55,250 --> 03:08:04,640
 equals resorts and from kiel in 1

1886
03:08:05,359 --> 03:08:13,180
 all the way the rest from the battery value

1887
03:08:17,260 --> 03:08:20,560
 we have

1888
03:08:21,460 --> 03:08:28,560
 the algorithm which in this case is rc4 to say that what we do is

1889
03:08:30,380 --> 03:08:35,859
 the c4 flu spot

1890
03:08:36,260 --> 03:08:39,819
 but then here this

1891
03:08:41,650 --> 03:08:50,960
 and we are going to decrypt the data and what we would have here would be the 26

1892
03:08:51,580 --> 03:08:54,000
 we give

1893
03:08:54,920 --> 03:08:57,729
 6

1894
03:08:58,420 --> 03:09:07,800
 if you look here the password forms things here that is

1895
03:09:07,800 --> 03:09:12,259
 what and allows us basically

1896
03:09:12,260 --> 03:09:17,960
 of them then how could implement this in pipeline of de

1897
03:09:17,960 --> 03:09:23,550
 real analysis and that's what things like for example triage do

1898
03:09:23,550 --> 03:09:27,619
 sandbox trias

1899
03:09:27,991 --> 03:09:36,430
 both analysts I am totally an analyst

1900
03:09:36,770 --> 03:09:41,460
 let's look here has been done

1901
03:09:41,460 --> 03:09:45,650
 family to see if they are with francs

1902
03:09:50,419 --> 03:09:53,419
 but

1903
03:09:53,620 --> 03:09:58,841
 I know my settings in this

1904
03:10:02,160 --> 03:10:04,789
 3

1905
03:10:04,920 --> 03:10:10,910
 [Music] this I am here in reaction malware that

1906
03:10:10,910 --> 03:10:14,960
 they took lies they did to extract the la

1907
03:10:14,960 --> 03:10:19,570
 information and how we extract

1908
03:10:19,650 --> 03:10:23,789
 extra automatic installs

1909
03:10:24,040 --> 03:10:28,920
 they do it so that's like the pavement of what you can do here is

1910
03:10:28,920 --> 03:10:33,540
 put this type of scripts in file analysis tools

1911
03:10:33,540 --> 03:10:39,100
 they can actually build automatic since they can be arranged to detect the

1912
03:10:39,100 --> 03:10:45,521
 files to know that if it is a corner you have to use this script and with

1913
03:10:45,521 --> 03:10:51,910
 that can be information another super important product that comes out with

1914
03:10:51,910 --> 03:11:01,080
 bases of punctually is radical there's they have many covers to extract

1915
03:11:01,080 --> 03:11:07,640
 extraction of information from rats including thus manu is in front and

1916
03:11:07,640 --> 03:11:12,920
 what we just did

1917
03:11:12,959 --> 03:11:21,239
 and they help us to start generating 30 per area and the sea

1918
03:11:21,239 --> 03:11:26,618
 for oracle and you [Music]

1919
03:11:26,619 --> 03:11:31,049
 conflict that is of being from japan

1920
03:11:32,200 --> 03:11:33,869
 and music]

1921
03:11:33,869 --> 03:11:39,939
 jing jing bad candy bad with fish for example

1922
03:11:39,939 --> 03:11:45,050
 precisely with base and allows you to extract

1923
03:11:45,050 --> 03:11:51,830
 info extract james settings this is the courage to take the

1924
03:11:51,830 --> 03:11:57,789
 time parse and extract get to a car

1925
03:11:57,940 --> 03:12:06,630
 in a simple way the configurations and this is case 1 I wanted to show you this

1926
03:12:06,630 --> 03:12:10,699
 is the case the corner is called to end wanted

1927
03:12:10,700 --> 03:12:14,471
 show him it was turn

1928
03:12:14,811 --> 03:12:20,921
 but we simply wanted to see that a sample of that patient

1929
03:12:22,210 --> 03:12:29,089
 in aida it also has a phase 4 I am

1930
03:12:29,090 --> 03:12:32,439
 this is what is more com

1931
03:12:36,050 --> 03:12:39,109
 [Music]

1932
03:12:41,690 --> 03:12:45,960
 and music]

1933
03:12:45,960 --> 03:12:48,919
 it is my madly

1934
03:12:49,180 --> 03:12:54,420
 if we get we will be in wine

1935
03:12:55,771 --> 03:12:58,341
 Y

1936
03:12:58,410 --> 03:13:00,990
 from the beginning [Music]

1937
03:13:00,990 --> 03:13:06,470
 and we are going to go step by step after the functions of which we find

1938
03:13:06,470 --> 03:13:10,910
 a grace and 4 in bed

1939
03:13:10,910 --> 03:13:16,119
 in this the first thing he does not always do

1940
03:13:18,679 --> 03:13:22,669
 interesting can be generated

1941
03:13:23,200 --> 03:13:26,880
 this type of analysis

1942
03:13:28,479 --> 03:13:32,010
 then and let's see

1943
03:13:32,011 --> 03:13:41,061
 Let's see if I find here it is a look from 0 to 7 and indeed

1944
03:13:42,229 --> 03:13:48,929
 I will use c4 for your healing so I don't know which is easier for you but

1945
03:13:48,930 --> 03:13:55,340
 see that generally the flow is like the same

1946
03:13:55,409 --> 03:14:01,119
 ah 56 and later there is another place

1947
03:14:01,120 --> 03:14:09,820
 also with 256 and in the next function I wanted him to and that's wrong

1948
03:14:09,820 --> 03:14:14,990
 dry, that's why I tell them they learn to be

1949
03:14:15,430 --> 03:14:21,920
 also if they want to analyze value and with that already finished

1950
03:14:21,920 --> 03:14:27,920
 Tallers then now all is question

1951
03:14:27,920 --> 03:14:31,790
 of claims and there they were, you can contact me by

1952
03:14:31,790 --> 03:14:37,570
 twitter and that's what I wanted to tell you

1953
03:14:46,931 --> 03:14:49,501
 but not

1954
03:14:50,880 --> 03:14:53,660
 knotted

1955
03:14:59,530 --> 03:15:05,380
 you hear me maybe

1956
03:15:06,681 --> 03:15:12,190
 yes yes yes with that she is ready

1957
03:15:12,630 --> 03:15:18,810
 I hope it has been from the ship all if you have more comments beyond the

1958
03:15:18,810 --> 03:15:21,050
 part

1959
03:15:21,311 --> 03:15:25,841
 show you the great things that can be done with ocean analysis

1960
03:15:25,841 --> 03:15:31,891
 Guarani leadership generation, look at that

1961
03:15:32,640 --> 03:15:35,330
 nerd

1962
03:15:44,190 --> 03:15:50,271
 Many thanks to Felipe for the excellent presentation

1963
03:15:51,420 --> 03:15:54,439
 there are the people

1964
03:16:01,890 --> 03:16:04,890
 as

1965
03:16:05,800 --> 03:16:11,750
 dark hope code and then as long as they can

1966
03:16:11,750 --> 03:16:14,050
 to collaborate

1967
03:16:14,629 --> 03:16:18,970
 oh with pleasure

1968
03:16:22,270 --> 03:16:25,050
 Thank you

1969
03:16:27,061 --> 03:16:30,061
 ah

