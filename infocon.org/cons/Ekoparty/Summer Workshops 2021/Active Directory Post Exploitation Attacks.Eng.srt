1
00:00:00,000 --> 00:00:03,909
yes [Music]

2
00:00:05,270 --> 00:00:10,670
 Now how are they doing? My name is Francisco Cantero and today we are going to be doing the

3
00:00:10,670 --> 00:00:14,000
 Héctor activity workshop and post exploitation attacks where we are

4
00:00:14,000 --> 00:00:16,940
 We are going to be seeing post-exploitation attacks that we can review at

5
00:00:16,940 --> 00:00:20,270
 displaying stories so that with a standard user with low privileges

6
00:00:20,270 --> 00:00:26,240
 we can get to get a dog and privileges of tomara min said this

7
00:00:26,240 --> 00:00:29,320
 let's go to the presentation

8
00:00:50,180 --> 00:00:55,450
 well well well first of all welcome to

9
00:00:55,450 --> 00:00:59,980
 everyone to this workshop thank you very much everyone for attending and thank you very much

10
00:00:59,980 --> 00:01:04,119
 It will be done for giving this space and welcome to everyone to what this is

11
00:01:04,120 --> 00:01:08,729
 summer work series re show share my name is francisco camps

12
00:01:08,729 --> 00:01:15,490
 I am currently a metrix engineer greetings to the team I am lazy antiphon

13
00:01:15,490 --> 00:01:20,649
 stamina and hunter in my spare time I like to look for balsillie and break things

14
00:01:20,650 --> 00:01:24,820
 I am part of the hospital staff in my free time I also like

15
00:01:24,820 --> 00:01:29,440
 Participating in sete efe is like boxing records and I am a founder and

16
00:01:29,440 --> 00:01:35,800
 community organizer and 404 we are and now let us introduce my

17
00:01:35,800 --> 00:01:42,490
 partner that rodrigo good morning i am rodrigo that laporta today

18
00:01:42,490 --> 00:01:47,199
 I'm going to be like enough from France for the question part

19
00:01:47,200 --> 00:01:51,520
 I am software the ginger in the main hall of nou technologies and also

20
00:01:51,520 --> 00:01:58,330
 accompanied him with the 404 community are the idea of ​​this do what good if

21
00:01:58,330 --> 00:02:02,920
 Someone has doubts or a question they want to ask, they can ask it through

22
00:02:02,920 --> 00:02:08,470
 of the question channel within the center of discord and pop art and so if

23
00:02:08,470 --> 00:02:13,420
 you have them there I am going to take them and when frank can we are going to ask

24
00:02:13,420 --> 00:02:18,899
 see what responses we get so celebrate

25
00:02:18,900 --> 00:02:23,730
 perfect good let's go over first with the agenda that we are going to be looking at

26
00:02:23,730 --> 00:02:28,018
 In this workshop, the first thing we are going to see is that the directory is activated.

27
00:02:28,019 --> 00:02:31,530
 see the important concepts that one has to take into account of you director

28
00:02:31,530 --> 00:02:34,769
 and we go to the authentication protocols with which active works

29
00:02:34,769 --> 00:02:38,970
 directory once seen this let's see how we can configure our first

30
00:02:38,970 --> 00:02:43,830
 in our own laboratory we will see what are post attacks

31
00:02:43,830 --> 00:02:48,630
 active directory exploits which is where we will see all these attacks

32
00:02:48,630 --> 00:02:54,079
 We will see separately kerberos which is an authentication protocol of also of

33
00:02:54,080 --> 00:02:58,530
 microsoft but we will see it separately because we will see very in detail and

34
00:02:58,530 --> 00:03:04,829
 we will see how to attack kerberos all the resources that are used this

35
00:03:04,829 --> 00:03:09,269
 workshop are in the following link as you can see they are in englishtown with

36
00:03:09,269 --> 00:03:13,430
 qr scan so don't worry yourself these

37
00:03:13,430 --> 00:03:18,230
 slides are found right away so nothing has so much resources

38
00:03:18,230 --> 00:03:22,170
 available for you to carry out the laboratory

39
00:03:22,170 --> 00:03:26,099
 well first of all what is active directory an active director and

40
00:03:26,099 --> 00:03:29,160
 basically it is a microsoft tool that provides services of

41
00:03:29,160 --> 00:03:33,270
 directory a directory service is an application that stores and organizes

42
00:03:33,270 --> 00:03:38,940
 information about users and other resources a network basically a service

43
00:03:38,940 --> 00:03:41,970
 directory what it does is that it allows administrators to manage access

44
00:03:41,970 --> 00:03:48,560
 of users to the resources of said network an interesting fact is that nowadays

45
00:03:48,560 --> 00:03:53,120
 more than 90 of the companies worldwide and 95 of the one south training

46
00:03:53,120 --> 00:03:58,910
 sound use direct acting and to manage their identity that is, it is very

47
00:03:58,910 --> 00:04:03,560
 interesting to have Héctor activity and as a target since 90 is 90 per

48
00:04:03,560 --> 00:04:08,690
 hundred of companies around the world use active

49
00:04:08,690 --> 00:04:10,750
 directory

50
00:04:11,090 --> 00:04:16,130
 alright lets go quick with the important active directory concepts

51
00:04:16,130 --> 00:04:21,260
 domain an active directory domain is basically a logical container that is

52
00:04:21,260 --> 00:04:25,789
 used to administer and manage users or that for user groups

53
00:04:25,790 --> 00:04:30,110
 computers among other objects ok now we are going to give this well in detail

54
00:04:30,110 --> 00:04:34,940
 definition of objects then we have what is a domain controller which is

55
00:04:34,940 --> 00:04:38,390
 basically a server that contains installed the active directory role does not

56
00:04:38,390 --> 00:04:43,380
 main services and has been promoted as a domain controller

57
00:04:43,380 --> 00:04:47,550
 This domain control is in charge of providing authentication and

58
00:04:47,550 --> 00:04:53,250
 use replicate changes with other domains and store a copy of

59
00:04:53,250 --> 00:04:57,789
 directory content objects an object with which

60
00:04:57,789 --> 00:05:01,960
 I just mentioned that the users were the groups, basically an object is the

61
00:05:01,960 --> 00:05:05,289
 generic name that we use to refer to any component

62
00:05:05,289 --> 00:05:08,318
 within a directory although there are within the objects we can find

63
00:05:08,319 --> 00:05:12,219
 as recently mentioned users that for example allow a user to access

64
00:05:12,219 --> 00:05:16,569
 a network resource we will find groups that are used to simplify

65
00:05:16,569 --> 00:05:20,349
 the administration of the permissions we can find the computers good

66
00:05:20,349 --> 00:05:23,199
 We can find and win these shares that we are going to be

67
00:05:23,199 --> 00:05:27,800
 speaking in more detail about them a little later

68
00:05:27,800 --> 00:05:32,509
 we also have organizational units an organizational unit is basically

69
00:05:32,509 --> 00:05:36,409
 a container that allows grouping the objects allows us to organize the

70
00:05:36,409 --> 00:05:42,889
 objects like printer printers users groups etc.

71
00:05:42,889 --> 00:05:46,430
 For example, we can draw a u called the sales team and put

72
00:05:46,430 --> 00:05:51,740
 there all our all our sales computers then have one u

73
00:05:51,740 --> 00:05:54,860
 that are sales user and group all users we create

74
00:05:54,860 --> 00:06:00,860
 inside sales saúde et cetera later we have what is called a tree

75
00:06:00,860 --> 00:06:05,180
 that a tree is basically a set of domains which depend on a

76
00:06:05,180 --> 00:06:10,350
 common root and are organized in a certain age hierarchy

77
00:06:10,350 --> 00:06:14,820
 basically they share the main domain name they can have their

78
00:06:14,820 --> 00:06:19,890
 domains and by default a transitive trust is created that now we will

79
00:06:19,890 --> 00:06:23,599
 to be watching later

80
00:06:23,790 --> 00:06:29,010
 Give me a second and I'm going to give you a touch again, I don't know if the

81
00:06:29,010 --> 00:06:33,909
 github link I want region to enter is the crux hub

82
00:06:33,910 --> 00:06:39,770
 dotcom frank 205 a from workshop to suddenly

83
00:06:39,770 --> 00:06:43,058
 a workshop and there they will be able to find

84
00:06:43,059 --> 00:06:49,870
 all the resources of this workshop well

85
00:06:49,870 --> 00:06:53,920
 then as I mentioned a tree is basically a set of domains

86
00:06:53,920 --> 00:06:59,980
 notice that it is formed by several domains one can have the domain for example

87
00:06:59,980 --> 00:07:04,150
 with all dot com and then we have one call and use dot driver dot like

88
00:07:04,150 --> 00:07:08,380
 china dot 4 about dot com and this transitive trust that I mentioned to you

89
00:07:08,380 --> 00:07:15,590
 He just mentioned to you, now we will be explaining it in a little bit more to the side

90
00:07:15,590 --> 00:07:19,190
 and then we have the forests which basically the forests is the collection

91
00:07:19,190 --> 00:07:22,520
 of one or more trees and what is interesting is that they share the groups

92
00:07:22,520 --> 00:07:29,479
 of enterprise admin system bits well as you just mentioned this of the

93
00:07:29,480 --> 00:07:34,770
 trust relationships over transitive trust good what's this a

94
00:07:34,770 --> 00:07:38,010
 trust relationship basically means that a domain control

95
00:07:38,010 --> 00:07:42,840
 trust the other this basically allows them to react and have

96
00:07:42,840 --> 00:07:46,200
 Users who can log in to both dressage in controls There are two types of

97
00:07:46,200 --> 00:07:50,010
 trust the transitive trust and the directional trust with function to this

98
00:07:50,010 --> 00:07:52,950
 we are going to explain it in a very simple concept

99
00:07:52,950 --> 00:07:57,000
 and that has nothing to do with activities but suppose I have a friend

100
00:07:57,000 --> 00:08:01,620
 for example in this case to rodrigo his bonus I have rodrigo and I trust

101
00:08:01,620 --> 00:08:05,040
 in him then I give him the key to my house and rodrigo also trusts me and

102
00:08:05,040 --> 00:08:08,760
 gives the key to his house then what happens we trust each other and

103
00:08:08,760 --> 00:08:11,849
 we give each other access to housing

104
00:08:11,850 --> 00:08:15,750
 ok that would be the transitive trust what would the directional trust be

105
00:08:15,750 --> 00:08:19,700
 Suppose the example that I

106
00:08:19,810 --> 00:08:24,990
 for example i trust rodrigo ok

107
00:08:25,100 --> 00:08:32,520
 and rodrigo will give me keys to his house then what happens I trust him but

108
00:08:32,520 --> 00:08:37,049
 He gives me the keys, I don't know if that definition is understood.

109
00:08:37,049 --> 00:08:42,359
 see it in an example in activity that happens in haiti director and us

110
00:08:42,360 --> 00:08:46,800
 we have two domains one is called victor play test and one is called si corp

111
00:08:46,800 --> 00:08:52,949
 seidou what happens the user seidou can as there is mutual trust and

112
00:08:52,950 --> 00:08:58,590
 mutual access user seidou can log in to this domain and the

113
00:08:58,590 --> 00:09:04,089
 test user can login to this domain in directional trust

114
00:09:04,089 --> 00:09:12,399
 domain and hacked trust this domain but this user can access

115
00:09:12,399 --> 00:09:18,630
 In this domain, that is, the users of the local point corp will be able to access the

116
00:09:18,630 --> 00:09:23,040
 to the domain of liquor flow but those of igor lah or not to the local liquor because

117
00:09:23,040 --> 00:09:31,640
 because the black editor did not give him access to his and corp well I do not know if there is here

118
00:09:31,640 --> 00:09:37,500
 any doubt to a short break for consultations

119
00:09:37,500 --> 00:09:44,730
 until now they only asked the unpublished nachito thickness step the link but nothing

120
00:09:44,730 --> 00:09:49,070
 perfect go ahead well in short this would be the

121
00:09:49,070 --> 00:09:53,870
 active directory hierarchy we can access users who are among the

122
00:09:53,870 --> 00:09:57,380
 users by the objects that are inside a unit

123
00:09:57,380 --> 00:10:02,210
 organizational we can see the domains we can see about the union the units

124
00:10:02,210 --> 00:10:05,990
 organizational are within the domain they belong to a tree

125
00:10:05,990 --> 00:10:11,290
 the tree is inside a forest as you can see in this diagram

126
00:10:11,290 --> 00:10:16,660
 another cool thing is the tory active directory activity datastore

127
00:10:16,660 --> 00:10:20,050
 basically uses a data store to store all the information of the

128
00:10:20,050 --> 00:10:25,060
 directory and this directory contains information about objects such as

129
00:10:25,060 --> 00:10:32,479
 users groups computers etc. contain the nt file of that point the

130
00:10:32,480 --> 00:10:36,440
 which is a database that stores data of the director and this even

131
00:10:36,440 --> 00:10:40,430
 information about user objects groups and chair groups something

132
00:10:40,430 --> 00:10:43,459
 interesting is that this file also includes the password aces for

133
00:10:43,460 --> 00:10:48,879
 all the users in the domain well let's go here with the protocols of

134
00:10:48,879 --> 00:10:54,020
 authentication the first of them is the motto or the

135
00:10:54,020 --> 00:10:59,990
 manager basically is a protocol that is an authentication protocol that

136
00:10:59,990 --> 00:11:04,520
 uses a particularly weak medical hash is a protocol too

137
00:11:04,520 --> 00:11:09,560
 adoptive are easy to encrypt and is disabled by default to

138
00:11:09,560 --> 00:11:13,349
 from windows vista windows server 2008

139
00:11:13,350 --> 00:11:19,650
 we have the skin protocol in which good is known cnt the sister since

140
00:11:19,650 --> 00:11:24,090
 It is known as on the ground that obviously this is seen because it was the

141
00:11:24,090 --> 00:11:29,850
 first to be used in windows nt and is an improvement over the protocol of

142
00:11:29,850 --> 00:11:33,890
 It's basically the way it is

143
00:11:33,890 --> 00:11:37,670
 passwords are released on modern windows systems and are obtainable

144
00:11:37,670 --> 00:11:41,870
 dumping the data to me using minimí cats which is a tool that we will now see

145
00:11:41,870 --> 00:11:45,920
 below good and also stored in domain controllers at

146
00:11:45,920 --> 00:11:50,579
 file in this ds the gases cnt lm can be also

147
00:11:50,580 --> 00:11:53,610
 used to attack peace let it be an attack we will be seeing

148
00:11:53,610 --> 00:11:58,630
 now shortly after version n trm version came out

149
00:11:58,630 --> 00:12:02,410
 in a version 2 that are challenge response protocols that are used

150
00:12:02,410 --> 00:12:05,760
 for authentication in windows environments

151
00:12:05,760 --> 00:12:09,600
 we use analytics in the algorithm which means it can be used to

152
00:12:09,600 --> 00:12:14,529
 recover password via brute force or dictionary attacks

153
00:12:14,529 --> 00:12:18,129
 well we have kerberos which is basically the default protocol

154
00:12:18,129 --> 00:12:22,990
 authentication on windows computers at 2000, 3, 2000 and xp that are members of

155
00:12:22,990 --> 00:12:26,740
 an active directory domain older windows systems are no longer

156
00:12:26,740 --> 00:12:29,670
 compatible with parker but if you are going to use one of the above

157
00:12:29,670 --> 00:12:36,680
 authentication ok any doubt no no

158
00:12:37,699 --> 00:12:43,399
 we are still going ahead with the laboratory assembly the requirements

159
00:12:43,399 --> 00:12:49,009
 minimums are basically a virtual machine with windows server 2019 a

160
00:12:49,009 --> 00:12:52,579
 virtual machine with windows 10 enterprise and a virtual machine with

161
00:12:52,579 --> 00:12:56,238
 karim and nux disk space approximately 50 gigabytes and a

162
00:12:56,239 --> 00:13:03,089
 8 gb ram memory is fine it is necessary that they have suárez you must

163
00:13:03,089 --> 00:13:07,380
 pass the recommended requirements are good is used more rami and

164
00:13:07,380 --> 00:13:11,490
 basically I will be a bm of windows 10 but it is not necessary that they have the

165
00:13:11,490 --> 00:13:15,779
 recommended requirements because all of this can be done with a

166
00:13:15,779 --> 00:13:19,079
 Serbian windows and a windows 10 machine in this case I am doing it with

167
00:13:19,079 --> 00:13:22,260
 two machines so that you can see how each of the attacks works and

168
00:13:22,260 --> 00:13:28,350
 you can see well how each flow of attacks is but it is not necessary

169
00:13:28,350 --> 00:13:34,560
 yes or yes they are two machines with windows 10 the same anyway what

170
00:13:34,560 --> 00:13:39,420
 can do is use cloud services cloud services

171
00:13:39,420 --> 00:13:44,599
 For example, in my case we are many asur what they can do is use the

172
00:13:44,600 --> 00:13:50,190
 slaps that allow them to manage the actor machines and for laboratories

173
00:13:50,190 --> 00:13:53,910
 punctual if they do not have a lot of experience, now I can do it is

174
00:13:53,910 --> 00:13:58,290
 create a resource pool throw three machines four virtual machines there

175
00:13:58,290 --> 00:14:02,699
 turn them off and when they are using us and that will decrease them a lot

176
00:14:02,699 --> 00:14:07,410
 cost was a good way to optimize costs and be able to test in the

177
00:14:07,410 --> 00:14:11,829
 laboratory without having to dispose of those of those

178
00:14:11,830 --> 00:14:14,100
 resources

179
00:14:14,190 --> 00:14:18,380
 well the lab diagram basically we have an attacker

180
00:14:18,380 --> 00:14:26,130
 ok which in this case this is raised all in a mister scenario

181
00:14:26,130 --> 00:14:29,870
 ministries series robot

182
00:14:30,030 --> 00:14:35,670
 After we have the ticket, the attacker will be elected later in

183
00:14:35,670 --> 00:14:42,360
 A pc that is called a pc which is the Álamos pc which would be a user's pc

184
00:14:42,360 --> 00:14:46,500
 standard of a person for example of sales etc. later we would have the pc

185
00:14:46,500 --> 00:14:51,600
 of tyler wall and that would be for example the company site ok and then we have

186
00:14:51,600 --> 00:14:57,200
 the domain controller that would be this editor and wherever

187
00:14:57,939 --> 00:15:04,430
 fine until there is any doubt for now no but I want to remind you

188
00:15:04,430 --> 00:15:08,420
 the people who are tweets that if they have any questions there

189
00:15:08,420 --> 00:15:13,490
 It would be one to go through the album and ask around why the ones we take

190
00:15:13,490 --> 00:15:19,360
 to put they are from that channel so nothing

191
00:15:20,310 --> 00:15:25,378
 give it perfect perfect yes or no more

192
00:15:25,379 --> 00:15:30,389
 well let's start like this to see the post exploitation attacks in writing

193
00:15:30,389 --> 00:15:35,729
 hector and good in the initial stage basically we managed to get

194
00:15:35,729 --> 00:15:40,619
 the password of the icor barra user we crave that he has the password is that that

195
00:15:40,619 --> 00:15:46,349
 password 1 which is a basically unprivileged domain user the one time

196
00:15:46,349 --> 00:15:51,929
 in which it can be achieved is in the fish that is yours and remember well

197
00:15:51,929 --> 00:15:56,800
 again this this diagram the first thing we are going to see is this

198
00:15:56,800 --> 00:16:02,599
 enumeration of user attributes basically the goal of this is to be able to

199
00:16:02,600 --> 00:16:06,920
 we list the attributes of users of a proxy list us

200
00:16:06,920 --> 00:16:11,150
 the attributes of the users of this director and we know how to list the

201
00:16:11,150 --> 00:16:13,850
 user attributes we can find the following attributes

202
00:16:13,850 --> 00:16:18,740
 real and relevant that are those of admin in says if the user in a moment

203
00:16:18,740 --> 00:16:22,730
 The password count was administrator, now let's see what they are for

204
00:16:22,730 --> 00:16:25,880
 these specific attributes are not the number of times the user and / or

205
00:16:25,880 --> 00:16:31,280
 you wrongly entered the member of in the key to find out which group it belongs to

206
00:16:31,280 --> 00:16:39,160
 and the description that is a free field that today we are going to go with this first demo

207
00:16:39,160 --> 00:16:44,649
 let's go this way well I'm here in the fishbowl we call

208
00:16:44,649 --> 00:16:48,010
 to show also the first thing I am going to do is try to rule on the pc

209
00:16:48,010 --> 00:16:55,450
 What is the one of the lic? Look how we are going keys

210
00:16:58,310 --> 00:17:01,150
 one day

211
00:17:04,780 --> 00:17:09,430
 notice that he tells me that he could not achieve this because he is totally

212
00:17:09,430 --> 00:17:14,530
 restricted to your user if we do not go here obviously we

213
00:17:14,530 --> 00:17:17,760
 we will be able to forget

214
00:17:18,709 --> 00:17:24,169
 Well the first thing I want to show you is a tool called the

215
00:17:24,169 --> 00:17:29,460
 explorer you are using the graphical interface but now let's see how to do it

216
00:17:29,460 --> 00:17:32,690
 this same by console

217
00:17:41,840 --> 00:17:45,789
 something that I will have already put something wrong

218
00:17:51,920 --> 00:17:57,920
 it got bad clarifies well notice that here we can list all the

219
00:17:57,920 --> 00:18:02,210
 directory structure and we can see we remove them for example that there is

220
00:18:02,210 --> 00:18:06,800
 one that is called and use si core where we can see the different users

221
00:18:06,800 --> 00:18:10,669
 created and that they have interesting this that we can see, look at all

222
00:18:10,670 --> 00:18:16,510
 the attributes if we want using the search tool

223
00:18:16,510 --> 00:18:21,070
 we can search for example

224
00:18:21,309 --> 00:18:25,279
 e what interesting values ​​that we are going to

225
00:18:25,279 --> 00:18:29,080
 find in the description because we talk about your tents

226
00:18:30,320 --> 00:18:39,259
 Well, as you can see, here is a user who has service calls and that

227
00:18:39,259 --> 00:18:45,110
 It has as a key my password one of which the description says that if it can be used

228
00:18:45,110 --> 00:18:50,809
 password is my password 1 well this is very common that they occur

229
00:18:50,809 --> 00:18:56,480
 multiple times found in in description fields that leave keys

230
00:18:56,480 --> 00:19:02,530
 and it is something that can happen in this case this is not the key

231
00:19:02,679 --> 00:19:09,420
 but it is something very interesting to show now well let's see how to do this

232
00:19:09,420 --> 00:19:13,690
 via console, that is, for example, if we had a

233
00:19:13,690 --> 00:19:21,840
 open metasploit session and let's move one tap to the presentation

234
00:19:22,250 --> 00:19:28,350
 we are here fine

235
00:19:31,520 --> 00:19:36,280
 well, we are going to use them, it is a tool called power exploit

236
00:19:36,280 --> 00:19:41,300
 this tool will allow us to do a lot of things not just the attack

237
00:19:41,300 --> 00:19:48,129
 this numbering of user attributes well let's go

238
00:20:00,429 --> 00:20:04,889
 we are going to open it directly from the folder

239
00:20:07,000 --> 00:20:10,170
 powers lloyd

240
00:20:11,570 --> 00:20:18,330
 hold the letter so that it is via let's increase the band

241
00:20:18,330 --> 00:20:26,689
 let's point to one thing a second and arango yes

242
00:20:26,690 --> 00:20:30,790
 it doesn't come out perfect

243
00:20:35,710 --> 00:20:41,990
 i'm half asleep porcel john key

244
00:20:41,990 --> 00:20:46,890
 what am i doing with this i am opening a powers window in the

245
00:20:46,890 --> 00:20:51,960
 what the bypass s what I am doing is emptying a restriction that has

246
00:20:51,960 --> 00:20:56,910
 dread shell so that it does not run in scripts is something typical of powers no longer

247
00:20:56,910 --> 00:21:00,380
 it's nothing at all weird

248
00:21:09,789 --> 00:21:12,749
 it matters to me

249
00:21:14,310 --> 00:21:17,389
 now for

250
00:21:21,410 --> 00:21:24,700
 well it may fail

251
00:21:26,480 --> 00:21:29,679
 of the sunken

252
00:21:45,500 --> 00:21:49,450
 well, what I'm doing is important

253
00:21:49,450 --> 00:21:54,750
 as the power exploit tool

254
00:21:55,680 --> 00:22:02,700
 and what we are going to do is use this tool to start listing

255
00:22:02,700 --> 00:22:06,690
 ok he is definitely not loving me today

256
00:22:06,690 --> 00:22:11,889
 help the demo and let's test

257
00:22:15,430 --> 00:22:19,890
 it is not importing well in the module

258
00:22:20,100 --> 00:22:23,449
 let's try again

259
00:22:43,430 --> 00:22:46,120
 it's okay

260
00:22:52,130 --> 00:22:55,000
 word

261
00:22:56,550 --> 00:23:00,200
 because it doesn't matter

262
00:23:04,650 --> 00:23:07,790
 they have passed that

263
00:23:09,400 --> 00:23:12,000
 speaker

264
00:23:13,030 --> 00:23:16,230
 no good leave me

265
00:23:27,450 --> 00:23:34,540
 follow the point ps1 very well but it is not

266
00:23:35,110 --> 00:23:40,519
 I am not taking it open

267
00:23:43,840 --> 00:23:46,470
 it was

268
00:23:49,210 --> 00:23:52,049
 this was

269
00:23:53,850 --> 00:23:57,260
 extra that the cdu no

270
00:23:58,630 --> 00:24:01,830
 well you can find

271
00:24:03,230 --> 00:24:05,799
 Amen

272
00:24:10,090 --> 00:24:16,600
 It is entering me now with pc of 1 number take

273
00:24:16,600 --> 00:24:26,428
 with p de m 1 name take good I failed the demo that could die

274
00:24:26,429 --> 00:24:31,039
 adhered said we see a milestone let's talk

275
00:24:33,940 --> 00:24:37,019
 let's see what's happening

276
00:24:59,470 --> 00:25:02,760
 I am an importan

277
00:25:14,780 --> 00:25:20,000
 and no number takes

278
00:25:20,380 --> 00:25:23,070
 well

279
00:25:23,570 --> 00:25:26,139
 Let's see

280
00:25:27,530 --> 00:25:33,690
 well let's do one thing since what number is taking

281
00:25:33,690 --> 00:25:39,929
 Let's do one thing, it's the first time we fail, let's give it this way, so how will they be?

282
00:25:39,929 --> 00:25:44,309
 idea do not go out perspiring what we are going to do is we go back to do a brief

283
00:25:44,309 --> 00:25:49,290
 pause i'll check this before i know

284
00:25:49,290 --> 00:25:56,540
 learn photos and we'll be back in less than 5 minutes if you feel like it

285
00:25:59,309 --> 00:26:06,960
 well here we came back possibly I do not know if it appeared but it would have to appear the

286
00:26:06,960 --> 00:26:12,870
 image that of technical difficult and the simpsons clearly the question of

287
00:26:12,870 --> 00:26:17,039
 million that we are all doing what was failing and the most

288
00:26:17,039 --> 00:26:22,889
 funny is that a human error of mine was obviously not the point ps1 as

289
00:26:22,889 --> 00:26:30,029
 Some said it was not the thing about the thing but what exactly is going to be

290
00:26:30,029 --> 00:26:35,230
 making a comment that hit him right in the chat what he was

291
00:26:35,230 --> 00:26:39,900
 failing that I realized the module is just importing more

292
00:26:39,900 --> 00:26:43,440
 what happened in import the power view module and is importing the 'power

293
00:26:43,440 --> 00:26:46,950
 cloud as a conclusion that we can learn from

294
00:26:46,950 --> 00:26:49,650
 This is that you do not have to drink beer before the talk

295
00:26:49,650 --> 00:26:54,800
 when you are watching yes but when we are going to give them not so much so well nothing

296
00:26:54,800 --> 00:27:01,750
 a data is very important to say they have told me this we are going to continue with

297
00:27:01,750 --> 00:27:05,980
 with the talk and let's see how we import the good module with

298
00:27:05,980 --> 00:27:10,380
 needs point point bar let's put power view

299
00:27:10,380 --> 00:27:14,440
 And see if please don't fail me now

300
00:27:14,440 --> 00:27:20,529
 and at this point one is persecuted I imagine that you will understand is

301
00:27:20,529 --> 00:27:29,860
 as you already warm a ls sink and it does not happen we can never get out 100%

302
00:27:29,860 --> 00:27:34,049
 you are and the demo does not fail this is nothing

303
00:27:36,040 --> 00:27:41,060
 the control data nothing like it showed them to lie to

304
00:27:41,060 --> 00:27:45,830
 the data did not find me I put the version of the server etc. we can

305
00:27:45,830 --> 00:27:53,260
 get the option of domain policy or more in policy

306
00:27:55,690 --> 00:28:00,789
 As you can see, we can have it, for example, the domain policies at

307
00:28:00,789 --> 00:28:06,240
 freighter policies etc. we can obtain for example

308
00:28:06,240 --> 00:28:09,240
 net

309
00:28:11,040 --> 00:28:14,100
 and look here we are seeing all the user attributes which

310
00:28:14,100 --> 00:28:19,510
 we just saw with the explore tool we

311
00:28:19,510 --> 00:28:23,900
 from here look for example we are with the sql

312
00:28:23,900 --> 00:28:26,410
 service

313
00:28:26,490 --> 00:28:31,040
 even the description of that can be encore

314
00:28:33,180 --> 00:28:38,900
 others I will play is for example the one of get net

315
00:28:39,710 --> 00:28:47,409
 net group and the ion name troupe

316
00:28:47,700 --> 00:28:50,419
 admin

317
00:28:52,240 --> 00:29:00,059
 This is what is showing us all the groups that have admin is in their name

318
00:29:00,280 --> 00:29:05,970
 etcetera well let's go back to the presentation

319
00:29:07,430 --> 00:29:14,540
 the question to see if charlie is on top, the same where is he with a domain friend and

320
00:29:14,540 --> 00:29:19,220
 blocked with a domain case user user domain trace reason

321
00:29:19,220 --> 00:29:24,050
 reason the user is more we will show it again just in case the

322
00:29:24,050 --> 00:29:27,379
 user look at the user who is read we get look at the user every

323
00:29:27,380 --> 00:29:31,810
 good time we crave is masters

324
00:29:32,070 --> 00:29:38,340
 good if we try to achieve in the tyler well machine and that would be

325
00:29:38,340 --> 00:29:43,820
 as the site of the company amos

326
00:29:46,580 --> 00:29:50,290
 you notice that tells us that we can not

327
00:29:50,290 --> 00:29:55,210
 achieve us because we do not have permission for these times so it is recontra

328
00:29:55,210 --> 00:29:59,710
 standard and also restricted for us they would do it other times

329
00:29:59,710 --> 00:30:02,309
 well

330
00:30:02,820 --> 00:30:08,399
 let's continue no more than against measures we can take with this we can review

331
00:30:08,399 --> 00:30:11,428
 user descriptions manually extract all

332
00:30:11,429 --> 00:30:14,490
 user descriptions and review them to see that there are no

333
00:30:14,490 --> 00:30:20,429
 rare value and set a user as with the key and set a user

334
00:30:20,429 --> 00:30:23,909
 promptly have the key in the description and keep the events of

335
00:30:23,909 --> 00:30:27,029
 this user so that we see that some user is

336
00:30:27,029 --> 00:30:32,039
 trying to achieve with this key we are not going to detect that they are

337
00:30:32,039 --> 00:30:38,750
 trying to attack well other things we could do is

338
00:30:38,750 --> 00:30:43,890
 see the shared resources of networks and this is very interesting for the 90% who

339
00:30:43,890 --> 00:30:48,540
 this basically this consists of listing the shared directories that

340
00:30:48,540 --> 00:30:51,450
 can be found in the patient network when listing the

341
00:30:51,450 --> 00:30:54,300
 resources found in comparative directories about us

342
00:30:54,300 --> 00:30:57,750
 we can find the following as the most relevant files good

343
00:30:57,750 --> 00:31:02,610
 point ps1 that can have for example a day can contain string like

344
00:31:02,610 --> 00:31:06,929
 convert string is created is circular connection the connection also the

345
00:31:06,930 --> 00:31:11,400
 sql point files that this is continuous is 30 kilometers of connection or connect

346
00:31:11,400 --> 00:31:20,000
 a txt that contains a text of that day wv of password and so on

347
00:31:21,830 --> 00:31:28,120
 well, is there any question this time

348
00:31:32,410 --> 00:31:39,700
 if you excuse me here you ask a question if the tool they are

349
00:31:39,700 --> 00:31:43,390
 using in the Angela profile you need administrator permission to be able to

350
00:31:43,390 --> 00:31:48,110
 run to I'm watching has no sexual reason no

351
00:31:48,110 --> 00:31:52,639
 you do not need permission just to be a user of me exactly with just being a user

352
00:31:52,640 --> 00:31:58,340
 domain we are literally with just that now and dance

353
00:31:58,340 --> 00:32:05,070
 from scratch good because I say there is this issue of resources

354
00:32:05,070 --> 00:32:08,429
 shared network is something very interesting I do not know if they remember a

355
00:32:08,430 --> 00:32:13,440
 In a short time, this document is also being given in the lay workshop that occurred from

356
00:32:13,440 --> 00:32:17,910
 migrations and the most logical thing is that it happened because they left things in folders

357
00:32:17,910 --> 00:32:21,270
 shared that everyone could access

358
00:32:21,270 --> 00:32:27,200
 and well, nothing happened, what happened, but well, let's see more in detail

359
00:32:27,200 --> 00:32:32,750
 how we can grab and search these shared folders then these

360
00:32:32,750 --> 00:32:35,740
 these commands

361
00:32:39,779 --> 00:32:42,289
 not

362
00:32:45,340 --> 00:32:48,780
 today trying to put

363
00:33:02,730 --> 00:33:07,140
 this command usually takes time so while executing another

364
00:33:07,140 --> 00:33:09,500
 command

365
00:33:10,140 --> 00:33:16,070
 6 - - mike is the one who takes his time if he wouldn't be sweating

366
00:33:16,740 --> 00:33:21,990
 It is a fairly important data of salt or poverty if not looking for the srs throughout the

367
00:33:21,990 --> 00:33:25,990
 network then take your time

368
00:33:25,990 --> 00:33:29,460
 we are going to do it here

369
00:33:46,119 --> 00:33:53,849
 stop workshop well headquarters the power

370
00:33:54,470 --> 00:33:59,210
 pretty delicious

371
00:34:01,630 --> 00:34:04,470
 for rafa

372
00:34:04,600 --> 00:34:07,649
 and accept to take out

373
00:34:25,800 --> 00:34:32,199
 we are going to do is with this command check promptly

374
00:34:32,199 --> 00:34:39,279
 the user geas in this case make the lakers that is to say the

375
00:34:39,280 --> 00:34:46,230
 the dogma in controlling there is a question has been if the letter can be enlarged

376
00:34:46,379 --> 00:34:52,580
 If we give it a second, yes, there is achieving

377
00:34:52,580 --> 00:34:59,160
 let's go there it will look good I don't know if a little more

378
00:34:59,160 --> 00:35:02,520
 a little more

379
00:35:04,850 --> 00:35:07,819
 hawaii payton

380
00:35:07,820 --> 00:35:13,090
 save and here we have and cut

381
00:35:13,090 --> 00:35:15,990
 and wherever

382
00:35:16,390 --> 00:35:21,839
 I have accessed 6

383
00:35:27,070 --> 00:35:32,560
 for how to put here while we wait for another command found several hearts

384
00:35:32,560 --> 00:35:37,410
 notice what it found and see what they say type been means do not require

385
00:35:37,410 --> 00:35:42,850
 authentication and end found for example announce calling scripts in the

386
00:35:42,850 --> 00:35:49,540
 domaine controller and found a being called and used in google and pc that

387
00:35:49,540 --> 00:35:56,230
 It can be anyone so what we are going to do is try to access

388
00:35:56,230 --> 00:36:00,430
 the scripts folder and we are going to execute a command that allows us to search between

389
00:36:00,430 --> 00:36:06,430
 all files that have a pattern in this case to the secure string pattern

390
00:36:06,430 --> 00:36:10,779
 because now as the bellowing there is only one file then for theoretical purposes

391
00:36:10,780 --> 00:36:15,760
 demonstrative fight is to show how we would search among a lot of

392
00:36:15,760 --> 00:36:21,550
 files a specific file we would search among lots of files a

393
00:36:21,550 --> 00:36:26,790
 string basically now let's see it well in detail

394
00:36:28,630 --> 00:36:34,230
 well let's do and chorus

395
00:36:41,840 --> 00:36:46,799
 what is we close the quotes

396
00:36:46,799 --> 00:36:51,830
 and there we connected yesterday as you can see it is as I told you

397
00:36:51,830 --> 00:36:56,390
 there is only one file, although here we could be a type and see

398
00:36:56,390 --> 00:36:59,900
 directly what you have suppose we have many files that we can

399
00:36:59,900 --> 00:37:05,680
 make known we are going to use the commands provided by power shell

400
00:37:05,880 --> 00:37:12,760
 in this case it is get chile and tam jump records

401
00:37:12,760 --> 00:37:19,599
 This is done by grabbing the files one by one and with select string

402
00:37:19,599 --> 00:37:24,720
 the selected files the beings rotate flat tings select

403
00:37:24,720 --> 00:37:31,240
 and string ah

404
00:37:35,430 --> 00:37:38,210
 stringer

405
00:37:39,500 --> 00:37:44,960
 and notice that the punctual string lists this inclusion in what

406
00:37:44,960 --> 00:37:52,760
 line this to sony to 1 that there is a serious string which contains this key ok yes

407
00:37:52,760 --> 00:37:57,230
 Well, this password is quite trivial, we know, we imagine which user

408
00:37:57,230 --> 00:38:04,190
 can belong we do not know the user belongs specifically then let's continue

409
00:38:04,190 --> 00:38:08,380
 next with the aic

410
00:38:11,890 --> 00:38:15,578
 well one of the countermeasures that can be done with this is basically

411
00:38:15,579 --> 00:38:20,260
 monitor traffic and identify the number of s & m connections in a short time

412
00:38:20,260 --> 00:38:23,680
 time to identify newly created files and the amount of

413
00:38:23,680 --> 00:38:28,269
 be that they were sent and well basically do not create is for everyone all

414
00:38:28,269 --> 00:38:32,308
 sides well before moving on so that there is some

415
00:38:32,309 --> 00:38:37,730
 doubt by chat for now but right from there they are

416
00:38:37,730 --> 00:38:45,170
 living some so there one says to monitor that with the employees the

417
00:38:45,170 --> 00:38:49,390
 channel events in windows stadium

418
00:38:49,390 --> 00:38:53,710
 we can identify different events that tell us when a

419
00:38:53,710 --> 00:38:57,820
 user is try to guide us through this then in this case it would be when

420
00:38:57,820 --> 00:39:02,340
 access a shared directory etc.

421
00:39:02,640 --> 00:39:09,779
 almost everything I put humanitarian from him selling windows

422
00:39:09,780 --> 00:39:13,460
 there too

423
00:39:14,660 --> 00:39:21,808
 German says good from his own foot to the two points between says the net bird

424
00:39:21,809 --> 00:39:30,039
 and they detect tulle or attack so well what a good question if they detect it

425
00:39:30,039 --> 00:39:33,400
 but how is the subject is more in fact this is not clarified by the principle pro

426
00:39:33,400 --> 00:39:37,920
 profit from the work above all the environment that we are using

427
00:39:37,920 --> 00:39:43,780
 Windows is disabled differently because because it detects it but something very

428
00:39:43,780 --> 00:39:47,470
 important to note is disabled for the simple fact that for

429
00:39:47,470 --> 00:39:50,770
 make the talk easier does not mean that you can not see patience no

430
00:39:50,770 --> 00:39:54,788
 because what happens we have the tools like good power light power view

431
00:39:54,789 --> 00:40:00,490
 mimic h etcetera that we have directly the source code we

432
00:40:00,490 --> 00:40:05,379
 if we wanted what we could do is start playing a few things is

433
00:40:05,380 --> 00:40:11,079
 look for the code and a few more things if we can evade it antivirus can

434
00:40:11,079 --> 00:40:14,869
 evade but already there we would have to start

435
00:40:14,869 --> 00:40:19,069
 modify it manually by basically doing a couple of functions

436
00:40:19,069 --> 00:40:22,400
 a couple of things to try to avoid being detected by antivirus and

437
00:40:22,400 --> 00:40:26,480
 obviously the same depending on the action that resists is the bird can detect it

438
00:40:26,480 --> 00:40:31,130
 by heuristics but for example in some cases because

439
00:40:31,130 --> 00:40:35,140
 it with mimicry does not detect it

440
00:40:35,510 --> 00:40:41,290
 then basically that if to make houses as well as to be to tools and

441
00:40:41,290 --> 00:40:46,490
 It detects it if one modifies the blue it does not detect it

442
00:40:46,490 --> 00:40:52,220
 in essence that is here our friend charly the question

443
00:40:52,220 --> 00:40:59,060
 Also if you will have the list of key events to take into account if not

444
00:40:59,060 --> 00:41:03,290
 I have here in the presentation or so I have a list of 10 I could upload it to the

445
00:41:03,290 --> 00:41:07,880
 I don't have a resource group uploaded but I do have a list

446
00:41:07,880 --> 00:41:14,270
 from there it is shared by the resource group there are some more doubts but layers we can

447
00:41:14,270 --> 00:41:21,190
 to advance a little more in the presentation and when

448
00:41:23,120 --> 00:41:29,740
 give it give it give it perfect well then the next the next

449
00:41:29,740 --> 00:41:33,250
 technique that we are going to see is that of power time which is basically a technique

450
00:41:33,250 --> 00:41:38,410
 which consists of trying to guess a password of an account basically what

451
00:41:38,410 --> 00:41:42,609
 It happens if we get the key directive and we have a

452
00:41:42,610 --> 00:41:45,760
 reduced number of keys to test we can try to perform a

453
00:41:45,760 --> 00:41:48,790
 kind of brute force attack with the key preventing the

454
00:41:48,790 --> 00:41:54,100
 users for example if we know that we can test three keys before

455
00:41:54,100 --> 00:41:57,910
 that it crashed and if we don't have to wait half an hour, what do we do?

456
00:41:57,910 --> 00:42:01,060
 we check the three keys we wait half an hour we try again

457
00:42:01,060 --> 00:42:05,770
 this keys we wait half an hour and thus we avoid that the good user is blocked

458
00:42:05,770 --> 00:42:09,490
 and another very interesting thing is that what we are going to think is that a

459
00:42:09,490 --> 00:42:12,970
 user has a password but a password can be had by many users how many

460
00:42:12,970 --> 00:42:17,118
 users in the world have the password one another and 450

461
00:42:17,119 --> 00:42:22,400
 and possibly a lot good let's see then we

462
00:42:22,400 --> 00:42:27,190
 we got a key what we are going to do is see what

463
00:42:27,190 --> 00:42:30,060
 users belong

464
00:42:33,310 --> 00:42:35,850
 add

465
00:42:47,579 --> 00:42:54,170
 let's go here the exceptional tool kléber spain

466
00:42:59,340 --> 00:43:02,479
 [Music]

467
00:43:04,880 --> 00:43:07,750
 now

468
00:43:08,520 --> 00:43:12,840
 what we are going to do is the following we are going to grab and we are going to get a

469
00:43:12,840 --> 00:43:19,360
 list of all domain users and what we are going to do is we are going to

470
00:43:19,360 --> 00:43:26,140
 the users that we are going to obtain will all be already sabritas, look at how

471
00:43:26,140 --> 00:43:32,900
 we make below that it does not mine and use list

472
00:43:32,900 --> 00:43:38,330
 we inhabit and then more

473
00:43:38,330 --> 00:43:43,808
 and fort rhythm

474
00:43:43,920 --> 00:43:46,520
 He says

475
00:43:51,079 --> 00:43:53,499
 out

476
00:43:55,430 --> 00:44:00,578
 in one with everything

477
00:44:01,210 --> 00:44:03,930
 So

478
00:44:15,740 --> 00:44:19,600
 what I let me program

479
00:44:34,990 --> 00:44:37,589
 okay

480
00:44:39,540 --> 00:44:46,370
 it's a season again to be

481
00:44:56,210 --> 00:44:59,210
 portion

482
00:45:01,300 --> 00:45:11,090
 I do not hate workshop to read I am

483
00:45:11,530 --> 00:45:18,180
 the bar teambox the spray

484
00:45:20,960 --> 00:45:24,139
 [Music]

485
00:45:26,180 --> 00:45:32,270
 take and use 7

486
00:45:34,220 --> 00:45:37,089
 being something wrong

487
00:45:37,620 --> 00:45:42,990
 everything that is import modules oim been days no I don't know why I wait

488
00:45:42,990 --> 00:45:48,240
 clearly and go

489
00:45:51,640 --> 00:45:54,509
 we'll see

490
00:45:58,460 --> 00:46:02,910
 1 we are going to review why they will not be

491
00:46:02,910 --> 00:46:06,859
 wanting good as they normally see when one

492
00:46:06,859 --> 00:46:14,230
 does these things it is like a lag, do not worry if it is false because it is

493
00:46:14,230 --> 00:46:19,240
 common is more tolerant when it makes us carry

494
00:46:19,240 --> 00:46:21,720
 safety

495
00:46:21,790 --> 00:46:30,130
 it can happen it never comes out so direct

496
00:46:30,770 --> 00:46:33,160
 I have

497
00:46:33,700 --> 00:46:37,259
 and I want to check something

498
00:46:38,030 --> 00:46:45,810
 great good how can I tell you what I have of these problems?

499
00:46:45,810 --> 00:46:51,270
 failures that you are seeing is called excess beer because because I come

500
00:46:51,270 --> 00:46:56,040
 confusing again which tool to import so back to guys who

501
00:46:56,040 --> 00:46:59,550
 They saw it to the green it is said if you take I do not drive if you are going to give a talk

502
00:46:59,550 --> 00:47:04,820
 I also did not take basically it is a very important data and

503
00:47:04,820 --> 00:47:11,780
 -6 looking with your eyes is a very interesting fact

504
00:47:12,010 --> 00:47:19,390
 now well let's go with the correct tool main à porter now yes now

505
00:47:19,390 --> 00:47:23,220
 what we are going to do is we are going to go with the command

506
00:47:23,220 --> 00:47:27,319
 that there will work what this command is doing like

507
00:47:27,320 --> 00:47:32,660
 I was commenting on them is that it grabs us users that it is going to grab us

508
00:47:32,660 --> 00:47:37,549
 all users of the domain to be deleted users who are

509
00:47:37,550 --> 00:47:41,680
 uninhabited and this is not going to enlist them and is going to address them in a

510
00:47:41,680 --> 00:47:46,180
 file that shelley uses point of txt notice that if we see the file

511
00:47:46,180 --> 00:47:51,069
 to use nothing contain the following naval users john feeley price

512
00:47:51,070 --> 00:47:57,480
 tehuel and unequal fields 0 and 7-5 well what we are going to do now is

513
00:47:57,480 --> 00:48:02,880
 try to grab and with these users we will try to test the key that

514
00:48:02,880 --> 00:48:09,569
 We find that is, the one of thai airways is if we to use the inbox domain

515
00:48:09,569 --> 00:48:16,489
 for word trade we are going to use list

516
00:48:16,760 --> 00:48:23,500
 users let's pass it like this

517
00:48:24,339 --> 00:48:29,650
 This is the password that is the key that we find not necessarily

518
00:48:29,650 --> 00:48:32,140
 that you have to do this with a password that we find but

519
00:48:32,140 --> 00:48:36,749
 well in this case it is to follow him

520
00:48:37,360 --> 00:48:43,290
 the path of attack that we are carrying out

521
00:48:43,390 --> 00:48:48,810
 2020 the key that we find [Music]

522
00:48:48,810 --> 00:48:54,910
 if everything goes well 10 notice that we found two users who

523
00:48:54,910 --> 00:48:59,350
 they have the key is one that is tyler ua lic

524
00:48:59,350 --> 00:49:04,420
 and another one that is the sql service ok

525
00:49:04,420 --> 00:49:08,080
 notice that it is very interesting because one can find further one

526
00:49:08,080 --> 00:49:13,450
 think that the user had the password, this could also be that being the

527
00:49:13,450 --> 00:49:19,919
 site configure sql development or sql service and assign the truth

528
00:49:20,490 --> 00:49:26,319
 it's good as an example let's go back to the presentation

529
00:49:26,320 --> 00:49:29,449
 [Music]

530
00:49:31,220 --> 00:49:34,959
 well obviously as a countermeasure to this monitor authentication

531
00:49:34,960 --> 00:49:39,260
 enable and configure multi-factor authentication correctly and do

532
00:49:39,260 --> 00:49:47,090
 comply with the use of strong passwords well I don't know if there are any questions in

533
00:49:47,090 --> 00:49:52,750
 chat and there we have a stack of questions we will continue to answer

534
00:49:52,750 --> 00:49:58,700
 some notes that have been left from the past payment question that brought them from

535
00:49:58,700 --> 00:50:03,620
 tweets from ncr tells you can be set up and direct somehow

536
00:50:03,620 --> 00:50:08,270
 to avoid that damage that we have to hide and that is to say that any

537
00:50:08,270 --> 00:50:11,810
 user who is in domain can not extract all the information all that

538
00:50:11,810 --> 00:50:14,770
 information no

539
00:50:15,269 --> 00:50:19,040
 e if after setting that dose to

540
00:50:19,040 --> 00:50:26,420
 expand the information that of active directory that I know no no no that's no

541
00:50:26,420 --> 00:50:31,240
 there is way to configure the best one can do is avoid what

542
00:50:31,240 --> 00:50:36,430
 leave for example relevant data fields in fields like description

543
00:50:36,430 --> 00:50:42,250
 etc. but no, it can't be joseba, at least no, it can't be deleted, I don't know

544
00:50:42,250 --> 00:50:49,390
 You can after that box and ask there is a document about the

545
00:50:49,390 --> 00:50:52,950
 good practices in we monitor

546
00:50:53,140 --> 00:50:57,879
 if there is real, all the documentation is on the official sites of

547
00:50:57,880 --> 00:51:02,579
 microsoft in microsoft in all the official sites greater find everything

548
00:51:02,579 --> 00:51:08,740
 more now later same to use a recommendation to countermeasures for a few

549
00:51:08,740 --> 00:51:13,538
 we will also use in everything that is from the official sites of greater other

550
00:51:13,539 --> 00:51:17,829
 country can find a lot of official information that you give later

551
00:51:17,829 --> 00:51:20,950
 help with the issue of monitoring today before we are using our own

552
00:51:20,950 --> 00:51:25,980
 tools provided by microsoft

553
00:51:26,299 --> 00:51:35,329
 later it is said that layer 8 total layer 8 that I have no doubt totally

554
00:51:35,329 --> 00:51:40,009
 years and here brings us more chicha will endure

555
00:51:40,009 --> 00:51:46,789
 Switch people bring us a little bomb that makes us Natalie de Natalia 16.080

556
00:51:46,789 --> 00:51:52,489
 of question when the attribute and use with control has the sac password that a

557
00:51:52,489 --> 00:51:57,140
 low it does not affect you there's active this being maybe with the policy that you have

558
00:51:57,140 --> 00:52:03,850
 configured when the garment attribute

559
00:52:04,710 --> 00:52:07,710
 totally

560
00:52:08,130 --> 00:52:13,930
 what a good question when the attribute y will use with control has frac

561
00:52:13,930 --> 00:52:17,669
 previous e

562
00:52:17,670 --> 00:52:24,799
 the truth is that i'm not sure and you killed me i'm not sure

563
00:52:25,370 --> 00:52:33,830
 for the jaguars and for the next one I will tell you that is how you killed me then later

564
00:52:33,830 --> 00:52:38,569
 about that and to be able to talk, you ask me, but hey, we will be both remember and

565
00:52:38,570 --> 00:52:42,740
 Any doubt they have questions they have to ask France they can come to the

566
00:52:42,740 --> 00:52:50,060
 Questions channel inside the disk to take care of you write them and answer well

567
00:52:50,060 --> 00:52:53,779
 Another important thing to clarify is at the end of this presentation

568
00:52:53,780 --> 00:52:57,260
 there will be my contact information so anyone send a message by

569
00:52:57,260 --> 00:53:02,360
 twitter facebook email and if they will continue from the question there is no drama I

570
00:53:02,360 --> 00:53:08,690
 I always answer no there is no problem well continuing with the presentation this is

571
00:53:08,690 --> 00:53:13,100
 one of my favorite attacks of my favorite attacks is the peace of hasi

572
00:53:13,100 --> 00:53:17,720
 password pass basically this attack uses a technique in which it consists

573
00:53:17,720 --> 00:53:20,060
 in which an attacker obtains the login credentials from the

574
00:53:20,060 --> 00:53:23,509
 system and use these captured credentials to syndicate

575
00:53:23,510 --> 00:53:29,450
 on other computers on the network ok fine

576
00:53:29,450 --> 00:53:33,259
 What happens is that what we are going to do paralyzes this attack as much

577
00:53:33,260 --> 00:53:35,810
 important one to use is that we already have to have local permissions

578
00:53:35,810 --> 00:53:40,420
 admin on the machine in this case good to the user to have the

579
00:53:40,420 --> 00:53:45,520
 lic is not member ways and has permission from miami on both machines is

580
00:53:45,520 --> 00:53:53,210
 say in the isolate and in the d the own of tyler ua lic

581
00:53:53,210 --> 00:53:57,310
 and what we are going to do is go testing throughout the network

582
00:53:57,310 --> 00:54:01,859
 and try to get into these machines for now on

583
00:54:01,859 --> 00:54:04,910
 which one have we done that, no

584
00:54:08,790 --> 00:54:14,390
 let's go for the attacker's machine

585
00:54:14,789 --> 00:54:18,929
 well here we are from the attacker's machine to everything we saw until

586
00:54:18,929 --> 00:54:22,199
 receive one, bring an attacker, remember that he could easily have done it

587
00:54:22,199 --> 00:54:26,459
 having a poke session but open an open ice could

588
00:54:26,459 --> 00:54:31,259
 quietly execute power code senate the other machine and it could operate

589
00:54:31,259 --> 00:54:35,369
 both so I made it simple from these local machines to make it more

590
00:54:35,369 --> 00:54:40,160
 easy to see but not good what we are going to do now

591
00:54:40,160 --> 00:54:50,450
 that we are going to try to grab and review this with the user and the user

592
00:54:50,450 --> 00:54:53,990
 de Teruel and that we already know its password, we are going to try rosell guide in several

593
00:54:53,990 --> 00:54:58,240
 machines for which we have track map access

594
00:54:58,240 --> 00:55:02,479
 xx this is

595
00:55:02,480 --> 00:55:05,619
 let me see the ip

596
00:55:06,200 --> 00:55:15,118
 [Music] 8.15 14 good

597
00:55:16,730 --> 00:55:25,560
 well that there and where and local court point

598
00:55:25,560 --> 00:55:28,549
 p

599
00:55:32,230 --> 00:55:36,650
 and point 2020

600
00:55:40,010 --> 00:55:46,070
 and what will start to do if not false is to start looking at the

601
00:55:46,070 --> 00:55:50,860
 red ok if i fail now i will r

602
00:55:51,569 --> 00:55:54,739
 although from r

603
00:55:54,789 --> 00:55:58,709
 and you are going to die the quotes in the key

604
00:55:58,789 --> 00:56:02,140
 let's check that

605
00:56:02,500 --> 00:56:05,070
 not

606
00:56:05,580 --> 00:56:08,180
 okay

607
00:56:10,980 --> 00:56:13,730
 okay

608
00:56:17,180 --> 00:56:23,609
 well today we see you tank m you hear me totally

609
00:56:23,610 --> 00:56:28,369
 the other bar is not the other bar is not

610
00:56:28,369 --> 00:56:31,150
 1

611
00:56:32,349 --> 00:56:37,710
 Let's see, let's take a second to hunt they are

612
00:56:37,710 --> 00:56:44,380
 praising your bottom to the bottom about you if I did the bottom to the harp I said

613
00:56:44,380 --> 00:56:47,589
 well if the monkey clap in the background is going to give for one of the two things it had

614
00:56:47,589 --> 00:56:52,490
 what to give - for that we are going to increase the letter a

615
00:56:52,490 --> 00:56:58,470
 we are if the failure of the workshop is not necessary

616
00:56:58,470 --> 00:57:06,009
 have them have faith hands to avargues pheasant bio

617
00:57:06,010 --> 00:57:12,310
 to see with this that I am eating and that action asking him the size of the

618
00:57:12,310 --> 00:57:17,529
 letter there yes there is increase more had increased

619
00:57:17,530 --> 00:57:22,280
 just but you know it appears that he was using another

620
00:57:22,280 --> 00:57:27,700
 version of crack not for that reason it did not fail

621
00:57:32,320 --> 00:57:37,520
 ok since I had another version to create and for

622
00:57:37,520 --> 00:57:39,759
 that

623
00:57:47,910 --> 00:57:52,259
 effectively for the bar

624
00:57:52,260 --> 00:57:55,340
 no this

625
00:57:55,680 --> 00:58:02,250
 Now, well, as you can see, it can fail and this is something that I also want

626
00:58:02,250 --> 00:58:06,089
 say the back the slow bar just as good as what was failing me

627
00:58:06,089 --> 00:58:09,990
 whole prison something else is something I love you I love you

628
00:58:09,990 --> 00:58:14,790
 share that it is always interesting whenever something fails them

629
00:58:14,790 --> 00:58:18,500
 go back to the documentation if I am surely going to carry the beams but

630
00:58:18,500 --> 00:58:24,690
 always go back and try to see what's up

631
00:58:24,690 --> 00:58:28,230
 can always save us in this case what happens to me is that again

632
00:58:28,230 --> 00:58:32,550
 you are using is the command that I had prepared was for another version of that

633
00:58:32,550 --> 00:58:35,660
 gay crack matic set in which you did not have one did not have to anticipate the

634
00:58:35,660 --> 00:58:42,870
 cmb parameter ok and that's why it was failing

635
00:58:42,870 --> 00:58:47,549
 [Music] what yes

636
00:58:47,550 --> 00:58:54,800
 I am not sure if I take the password correctly because it is not

637
00:58:54,800 --> 00:58:58,270
 showing how it should display the results

638
00:59:18,350 --> 00:59:23,799
 let's check one thing in the user

639
00:59:29,090 --> 00:59:35,320
 again the key that I had seems works are like for 85 user

640
00:59:35,320 --> 00:59:41,220
 there are 85 different keys as they are no longer mixed

641
01:00:01,160 --> 01:00:05,259
 we wave to drink something

642
01:00:05,260 --> 01:00:08,880
 what do I want to verify

643
01:00:19,420 --> 01:00:23,950
 it is not right and here what I am verifying if it is

644
01:00:23,950 --> 01:00:28,810
 network discovery active but not the case

645
01:00:28,810 --> 01:00:36,600
 this plan is forgetting happens to me I am giving something very fundamental no

646
01:00:37,349 --> 01:00:42,569
 what is to specify the user that is why it is failing me after the same failure

647
01:00:42,569 --> 01:00:47,180
 one thing begins to fail you everything and you begin to forget everything so nothing

648
01:00:47,180 --> 01:00:53,140
 I was missing users the amount of layer 8 errors that

649
01:00:53,140 --> 01:00:58,529
 I have been having today is is an animal well

650
01:00:58,530 --> 01:01:01,970
 look how now

651
01:01:02,570 --> 01:01:08,210
 we can start testing and we can see how the ipc could be achieved

652
01:01:08,210 --> 01:01:18,480
 we can see how it could be achieved and corp both pc and we know that already these hosts

653
01:01:18,480 --> 01:01:26,099
 this user has access to basically that

654
01:01:26,099 --> 01:01:30,440
 you will say the command is quite simple but hey when one is

655
01:01:30,440 --> 01:01:38,020
 misplaced it usually happens but in essence it was that to be able to show

656
01:01:38,020 --> 01:01:41,799
 how one can grab with a user can

657
01:01:41,799 --> 01:01:45,219
 It will arrive when you get access to several machines, we are here testing

658
01:01:45,219 --> 01:01:49,179
 with all the machines the domain and we managed to verify some have

659
01:01:49,179 --> 01:01:55,410
 access to three machines let's go back one touch for the presentation

660
01:01:56,760 --> 01:01:59,750
 to

661
01:02:01,870 --> 01:02:04,529
 over here

662
01:02:04,910 --> 01:02:08,690
 well let's go now with what is that is peace

663
01:02:08,690 --> 01:02:13,370
 of password with us we pass a key but of something called a

664
01:02:13,370 --> 01:02:18,020
 technique called peace leave ok in which it gets consists of theft and

665
01:02:18,020 --> 01:02:22,700
 reuse of basic credentials before this is divided into two stages:

666
01:02:22,700 --> 01:02:26,330
 first is that an attacker has to gain access as local admin at al

667
01:02:26,330 --> 01:02:30,650
 minus one from the computer and the seconds that the attacker does is

668
01:02:30,650 --> 01:02:35,000
 try to increase access to other computers on the network by using good

669
01:02:35,000 --> 01:02:38,420
 steal one or more authentication beliefs and use the

670
01:02:38,420 --> 01:02:44,240
 stolen passwords people stolen credentials how this works

671
01:02:44,240 --> 01:02:48,919
 in short basically we surely have three of said that we

672
01:02:48,920 --> 01:02:51,860
 we have different hashes with the imm etcetera

673
01:02:51,860 --> 01:02:56,570
 what we are going to be here is if we get one of those hashes that

674
01:02:56,570 --> 01:03:01,010
 It can be obtained in several ways now let's see one of them how

675
01:03:01,010 --> 01:03:07,040
 you use eyebrows to get into other machines ok basically it works like this

676
01:03:07,040 --> 01:03:11,090
 attack we are going to review normally the attacker wants to access a resource

677
01:03:11,090 --> 01:03:16,460
 ok the server then sent towards authentication the attacker provides

678
01:03:16,460 --> 01:03:21,830
 the proportional attacker hilux news ears and sends them from our tree and is

679
01:03:21,830 --> 01:03:25,580
 so the value of the hash against the expected value that in case of being

680
01:03:25,580 --> 01:03:31,880
 correct is grant him access to the atlante

681
01:03:31,880 --> 01:03:38,940
 well let's see how to do this, the first thing we are going to do is

682
01:03:38,940 --> 01:03:45,050
 next we are going to grab and we are going to clean the

683
01:03:45,050 --> 01:03:49,090
 gases found in tyler's machine smells like we're gonna do this

684
01:03:49,090 --> 01:03:53,690
 we are going to a tool but now we are going to clarify something surely it is

685
01:03:53,690 --> 01:03:57,020
 a lot of you already have experience with project goals you have used previously

686
01:03:57,020 --> 01:04:02,840
 metasploit and what one knows there are a couple of metasploit tools that

687
01:04:02,840 --> 01:04:07,480
 when one gets it is the one that allows one foot to garages but as it is, it fails

688
01:04:07,480 --> 01:04:11,630
 several options better for me this tool was used that I have shared

689
01:04:11,630 --> 01:04:17,140
 with you what is an impact & christmas secret stamp tool

690
01:04:18,160 --> 01:04:23,220
 although I'm only using is if you want

691
01:04:26,580 --> 01:04:32,759
 although now it is

692
01:04:35,150 --> 01:04:39,100
 and now if it's there

693
01:04:40,130 --> 01:04:44,410
 eri corp bar

694
01:04:45,180 --> 01:04:48,180
 lic

695
01:04:48,810 --> 01:04:53,609
 2 points tyrell

696
01:04:53,609 --> 01:04:57,319
 point 2020

697
01:05:00,619 --> 01:05:07,140
 8.1 15.5 this ip is the relic machine what we are going to do with this

698
01:05:07,140 --> 01:05:11,960
 tool is to magnify the gases found in the tyler week machine

699
01:05:11,960 --> 01:05:19,550
 and here I surely ate the quotes

700
01:05:30,800 --> 01:05:36,200
 there you go, look at how one starts to get

701
01:05:36,200 --> 01:05:43,830
 change the streets of who is in that machine

702
01:05:43,830 --> 01:05:48,250
 we here for example look we have zero streets of the account

703
01:05:48,250 --> 01:05:52,470
 administrator administrator and notice that I saw an account called admin and corp

704
01:05:52,470 --> 01:05:55,470
 okay

705
01:05:56,170 --> 01:06:02,200
 we have this hard it turns out that this account is an admin account that is

706
01:06:02,200 --> 01:06:08,740
 created by company policies on all company computers with

707
01:06:08,740 --> 01:06:15,979
 the same password then what happens to us to see the hash

708
01:06:15,980 --> 01:06:19,640
 what we will be able to do is enter all the real computers of the

709
01:06:19,640 --> 01:06:21,700
 business

710
01:06:24,330 --> 01:06:31,340
 let's go lit and this is very common to happen I have had

711
01:06:31,340 --> 01:06:35,240
 very fun experiences and not so

712
01:06:35,240 --> 01:06:42,470
 very on the edge of the legal, let's say there, well, much more in the destination but

713
01:06:42,470 --> 01:06:44,980
 can you say that

714
01:06:46,200 --> 01:06:48,899
 but it can be said that it is a very nice experience with this type of

715
01:06:48,900 --> 01:06:53,670
 things where when they realize they have the key all over the place it's like

716
01:06:53,670 --> 01:06:58,050
 which is basically an ace that fulfilled this knowledge is already there basically then

717
01:06:58,050 --> 01:07:03,100
 in access two sides even if you do not have access to the dogma

718
01:07:03,100 --> 01:07:06,230
 to control because many times it is not the

719
01:07:06,230 --> 01:07:12,560
 The same password, since the machines of a company have access to all this and it is

720
01:07:12,560 --> 01:07:18,360
 very interesting nobody sees how I commented but they argue

721
01:07:18,360 --> 01:07:22,260
 that is very important is not only to get dressage jamming permits but

722
01:07:22,260 --> 01:07:26,430
 base what is important is the impact it can generate because there are cases where

723
01:07:26,430 --> 01:07:30,690
 it generates more impact to leave a being shared with critical data than

724
01:07:30,690 --> 01:07:36,180
 get a friday morning and essentially what we gonna do now

725
01:07:36,180 --> 01:07:40,279
 search let's go to a diamond exploits module

726
01:07:40,280 --> 01:07:42,880
 but

727
01:07:46,160 --> 01:07:48,819
 to 10

728
01:07:53,690 --> 01:07:57,910
 good options

729
01:07:58,210 --> 01:08:01,080
 perfect

730
01:08:04,000 --> 01:08:07,380
 thirst what we are going to do is we are going to try

731
01:08:07,380 --> 01:08:14,510
 access the pc we are going to inter access the pc of tyrell huelin

732
01:08:14,510 --> 01:08:21,880
 with the hash of the user the new one that we get that of admin with ok

733
01:08:21,920 --> 01:08:27,750
 I would have also achieved this if I had done here

734
01:08:27,750 --> 01:08:33,930
 instead of com container ue lic if I had done this on the machine

735
01:08:33,930 --> 01:08:38,700
 de àngel amos would also have worked but with web users, for this

736
01:08:38,700 --> 01:08:45,750
 you need local services min you are wanted

737
01:08:48,130 --> 01:08:53,270
 let me ripert this is we are going to enter it and

738
01:08:53,270 --> 01:08:59,460
 60 cc 192 122 points

739
01:08:59,460 --> 01:09:09,399
 168 point 15 points 5 I will also be reports from essen

740
01:09:11,170 --> 01:09:14,249
 [Music]

741
01:09:14,649 --> 01:09:18,068
 lee corp

742
01:09:20,149 --> 01:09:25,089
 s peace and there what we are going to do is

743
01:09:25,089 --> 01:09:30,880
 we're going to nail the hash as it comes straight all the way and we're going to

744
01:09:30,880 --> 01:09:35,880
 put on that baby and wear

745
01:09:35,880 --> 01:09:39,799
 wei lin de

746
01:09:40,520 --> 01:09:44,890
 let's look at options to see if nothing will die

747
01:09:44,890 --> 01:09:54,380
 I think we weren't going to give it the exploit and that's where we crossed our fingers ok

748
01:09:54,660 --> 01:09:57,559
 let's give again

749
01:10:01,730 --> 01:10:04,599
 let's try

750
01:10:04,770 --> 01:10:07,940
 with the one we long for

751
01:10:15,750 --> 01:10:21,270
 sorry yes yes thanks to this injury the chat criticize more guys

752
01:10:21,270 --> 01:10:27,640
 the user misuses the user the user s

753
01:10:27,640 --> 01:10:34,500
 admin and court to domingo and korn

754
01:10:34,500 --> 01:10:37,500
 exactly

755
01:10:37,790 --> 01:10:42,100
 but let's go back to change this here

756
01:10:42,220 --> 01:10:47,760
 and the dream I do not know if the trick is discussed well

757
01:10:48,400 --> 01:10:56,570
 if the user is ok to check it admin and corp too

758
01:10:56,570 --> 01:11:00,349
 so [Music]

759
01:11:04,340 --> 01:11:08,469
 ok let's talk

760
01:11:08,809 --> 01:11:15,179
 Jones we are going to give because we lack mass of

761
01:11:15,179 --> 01:11:22,250
 cicop and well the progressive hash

762
01:11:25,230 --> 01:11:31,480
 and if then well it is that it is fine to me neither

763
01:11:31,480 --> 01:11:36,419
 court is fine be a payroll is fine

764
01:11:37,020 --> 01:11:39,710
 he doesn't love us

765
01:11:43,980 --> 01:11:46,969
 I do not know

766
01:11:48,180 --> 01:11:50,570
 101

767
01:11:53,380 --> 01:11:56,070
 well

768
01:11:56,080 --> 01:12:02,239
 that's if i'm pretty sure ah no

769
01:12:02,239 --> 01:12:08,009
 here not ok what happened good first I put in the

770
01:12:08,010 --> 01:12:12,449
 second user today I come has an amount of

771
01:12:12,449 --> 01:12:17,820
 third tremendous basket errors that we are using a domain user is a

772
01:12:17,820 --> 01:12:20,449
 local user

773
01:12:20,550 --> 01:12:28,080
 the ip not the base which is fine because in my hair squid s & p has to be to go with

774
01:12:28,080 --> 01:12:30,620
 he

775
01:12:30,960 --> 01:12:36,200
 wide jail lovers request some appear

776
01:12:36,250 --> 01:12:44,270
 if that's how it was harry well rodrigo knows go

777
01:12:44,270 --> 01:12:49,610
 having a very crazy week for cell phone a difficult week a week

778
01:12:49,610 --> 01:12:52,030
 hard

779
01:12:52,570 --> 01:13:00,559
 for we are approaching this with games the name of the pc

780
01:13:00,560 --> 01:13:05,590
 wellink and a pc close the lic

781
01:13:08,290 --> 01:13:13,950
 the same with the point I should take it, hug for example

782
01:13:15,290 --> 01:13:18,430
 point 5

783
01:13:23,190 --> 01:13:28,650
 come on come on let's open let's take in the little hand and chat and opened that his

784
01:13:28,650 --> 01:13:34,650
 art let's go to this edition to a beer that had

785
01:13:34,650 --> 01:13:42,940
 something else totally totally great passion of the brand brand

786
01:13:42,940 --> 01:13:47,719
 to share totally well as it has to be

787
01:13:47,720 --> 01:13:51,590
 Well we could have mind session squeeze

788
01:13:51,590 --> 01:13:57,060
 then notice how net system net authorizes in

789
01:13:57,060 --> 01:14:01,500
 you and authority system have to send the energy as totally if with the

790
01:14:01,500 --> 01:14:06,510
 little hands today in the chat with everything they saw that you can you can you have to be

791
01:14:06,510 --> 01:14:10,560
 five hours when one is half distracted who is 5 waiting for you but

792
01:14:10,560 --> 01:14:12,860
 It can

793
01:14:12,880 --> 01:14:19,090
 but well, well, as you saw with obtaining the user, we can

794
01:14:19,090 --> 01:14:25,840
 grab and we can enter the machine of others this is very very interesting in

795
01:14:25,840 --> 01:14:29,050
 especially because even in comparative environments and there are 28 other machines that

796
01:14:29,050 --> 01:14:31,840
 They all have the same admin user with the same password and if you can't

797
01:14:31,840 --> 01:14:36,940
 decipher the keys they grab the with the peace attack you leave in Pampan and start

798
01:14:36,940 --> 01:14:43,089
 To hit everywhere is great when you are not half burned great

799
01:14:43,090 --> 01:14:45,690
 totally

800
01:14:45,810 --> 01:14:50,180
 well let's go back here let's go back to the

801
01:14:50,180 --> 01:14:52,570
 presentation

802
01:14:56,300 --> 01:15:00,889
 well well countermeasures we can use against this attack and install and

803
01:15:00,889 --> 01:15:06,230
 configure lapse what administration password solution to restrict and protect

804
01:15:06,230 --> 01:15:09,079
 domain accounts that have local administrator privilege and

805
01:15:09,079 --> 01:15:12,710
 restrict and protect local administrator accounts, although these

806
01:15:12,710 --> 01:15:18,680
 250 of local administrators do not help us to function

807
01:15:18,680 --> 01:15:22,880
 well then we have the impersonation of

808
01:15:22,880 --> 01:15:27,050
 tokens that basically this is a technique to be used as an administrator

809
01:15:27,050 --> 01:15:31,260
 local to impersonate another user logged into a system

810
01:15:31,260 --> 01:15:35,969
 this is very useful in scenarios where you have permission

811
01:15:35,969 --> 01:15:39,300
 local administrator on a machine and you want to impersonate another user

812
01:15:39,300 --> 01:15:43,079
 connected for example a domain administrator that we

813
01:15:43,079 --> 01:15:45,840
 Bastian maybe we have a crazy administrator on the machine because with these

814
01:15:45,840 --> 01:15:50,969
 admin and corp and I find that there is a domain admin that has been praised and I

815
01:15:50,969 --> 01:15:56,250
 I want to pretend is another user basically that are these tokens

816
01:15:56,250 --> 01:16:00,570
 tokens are a temporary key that allow you to access the system and the network

817
01:16:00,570 --> 01:16:03,659
 without having to provide credentials each time a

818
01:16:03,659 --> 01:16:08,879
 file there are two types of tokens delegated tokens are created for startups

819
01:16:08,880 --> 01:16:12,630
 interactive sessions such as logging into or connecting to the machine

820
01:16:12,630 --> 01:16:17,460
 via remote desktop and spoofing touches are for sessions

821
01:16:17,460 --> 01:16:21,360
 of non-interactive e.g. attach a network drive

822
01:16:21,360 --> 01:16:25,320
 that is, for example an interactive touch when a user is

823
01:16:25,320 --> 01:16:30,030
 unlocks if, for example, in a jamming shot it is seen and this token is achieved

824
01:16:30,030 --> 01:16:35,849
 it was that interactive because delegate 11 what happens is plantation when not

825
01:16:35,850 --> 01:16:42,570
 whenever and well let's see how this works

826
01:16:42,570 --> 01:16:47,990
 well we are going to do it is a module called 5 minutes

827
01:16:48,010 --> 01:16:53,010
 let's come by the loft

828
01:16:55,170 --> 01:17:02,300
 5 nito ok something I'm going to do is us now

829
01:17:02,300 --> 01:17:07,059
 we are in the machine of teide llewellyn ok

830
01:17:07,429 --> 01:17:14,389
 let's guide us now with philip wright's account phillips price is the seal

831
01:17:14,389 --> 01:17:18,469
 of the company because he is the executive director of bar the key of philip

832
01:17:18,469 --> 01:17:23,769
 wright why no i'm not going to remember it to stick

833
01:17:24,190 --> 01:17:30,490
 notice it is a very secure password 2020 key with exclamation mark

834
01:17:30,490 --> 01:17:36,240
 obviously always with very secure and robust keys

835
01:17:36,990 --> 01:17:43,030
 then what happens what is what we are going to see here

836
01:17:43,030 --> 01:17:46,630
 I am not succeeding with these users and I am going to do is close the session.

837
01:17:46,630 --> 01:17:50,170
 been one I do not guide you because let's pretend that the been had to see something

838
01:17:50,170 --> 01:17:57,330
 On the site's computer it will be one day and he saw it, he came here, he decided

839
01:17:57,330 --> 01:18:04,690
 grab come here make a single and that's just that

840
01:18:04,690 --> 01:18:10,419
 happens there is a token is more hopefully it ends from home

841
01:18:10,420 --> 01:18:16,190
 as for them to remain calm that it is totally obvious, notice that already

842
01:18:16,190 --> 01:18:21,259
 It is the guided that has an open session outside the war, what we are going to do is

843
01:18:21,260 --> 01:18:25,160
 we are going to grab and we are going to list the tokens that are in this machine

844
01:18:25,160 --> 01:18:30,330
 list digesting in another list

845
01:18:30,330 --> 01:18:35,990
 under tokens I

846
01:18:37,500 --> 01:18:42,120
 and notice that we can the delegated touches that is the one of

847
01:18:42,120 --> 01:18:45,870
 and corp philip klais then what are we going to do

848
01:18:45,870 --> 01:18:51,059
 we are going to impress that one is ok ok how to do that we are going to use

849
01:18:51,060 --> 01:18:55,280
 impersonal person

850
01:18:55,280 --> 01:19:00,579
 and under top gun and corp

851
01:19:01,490 --> 01:19:04,490
 6

852
01:19:06,080 --> 01:19:11,830
 good and now what are we going to see

853
01:19:11,830 --> 01:19:21,210
 is the following, once we have done this, what we can take is answer

854
01:19:23,260 --> 01:19:28,730
 and we are going to see what we have we are like the user of feel price that is to say that

855
01:19:28,730 --> 01:19:34,348
 We successfully represent the user of feel price

856
01:19:34,349 --> 01:19:37,199
 and obviously we once we did this we could already execute

857
01:19:37,199 --> 01:19:41,030
 commands like philip price which is the biggest

858
01:19:41,030 --> 01:19:46,940
 and notice something very common in all these totals that many things can be

859
01:19:46,940 --> 01:19:49,659
 to mitigate

860
01:19:50,020 --> 01:19:57,850
 doing simple things like not leaving a lot of Miami everywhere

861
01:19:57,850 --> 01:20:03,250
 they can be thrown by the side not to be left arsenal hard easy keys are things

862
01:20:03,250 --> 01:20:09,469
 simple which cannot be solved but hey many times it does not happen to you

863
01:20:09,469 --> 01:20:14,360
 good as countermeasures to this attack limit the accesses of the accounts

864
01:20:14,360 --> 01:20:17,808
 only at their corresponding levels, for example the accounts

865
01:20:17,809 --> 01:20:21,349
 of domain greens and enterprise admin that only access something else in controls

866
01:20:21,349 --> 01:20:24,679
 that is to say that yes or yes he has permission from Miami and that he does not access the computer

867
01:20:24,679 --> 01:20:29,539
 of sites for example and restrict and control local administrators

868
01:20:29,539 --> 01:20:32,509
 that exist on the machines as well without local administrator permission

869
01:20:32,510 --> 01:20:35,940
 again this attack could not be carried out

870
01:20:35,940 --> 01:20:39,739
 well let's see another one that is told

871
01:20:39,739 --> 01:20:44,659
 zinc this attack consists of using the command of 10 and zinc inside mini cats

872
01:20:44,659 --> 01:20:51,860
 and allows to simulate the behavior of a 2 domain controller and well this

873
01:20:51,860 --> 01:20:54,860
 What it does is that it asks two more controls to pass them the data of

874
01:20:54,860 --> 01:20:58,880
 the user password attackers must compromise a

875
01:20:58,880 --> 01:21:04,040
 You have the rights to perform domain replication and once it is

876
01:21:04,040 --> 01:21:07,400
 get these proper privileges take advantage of the command a mini command

877
01:21:07,400 --> 01:21:11,690
 cats were interests had commented before that they used a lot of

878
01:21:11,690 --> 01:21:15,320
 things this tool is used to clean streets of local machines

879
01:21:15,320 --> 01:21:20,059
 even to extract passwords from the ram memory depending on the version of

880
01:21:20,060 --> 01:21:23,140
 windows in this case what it will do is

881
01:21:23,140 --> 01:21:27,070
 recovering the streets was when it shows the activity account

882
01:21:27,070 --> 01:21:32,280
 well let's see how to do this attack

883
01:21:35,179 --> 01:21:41,209
 let's go back to the machine but in this case we get a bit of what is

884
01:21:41,209 --> 01:21:46,010
 the root view panorama for this point task

885
01:21:46,010 --> 01:21:50,530
 We are going to use it, it is a user called that is 35

886
01:21:50,530 --> 01:21:55,710
 I put this attack on time because it is very common in companies that use

887
01:21:55,710 --> 01:22:02,140
 sharepoint for example that a sharepoint user ups them or profiles in

888
01:22:02,140 --> 01:22:06,850
 green section requires this specific permit and many companies if they are aware

889
01:22:06,850 --> 01:22:12,820
 Final have no idea and from my own experience I have seen that they leave this the key

890
01:22:12,820 --> 01:22:16,809
 in plain text like this

891
01:22:16,810 --> 01:22:21,550
 in one arrive and you don't even have the idea of ​​how important this user is because

892
01:22:21,550 --> 01:22:27,960
 Well obviously as I say and you have nothing to

893
01:22:27,960 --> 01:22:33,350
 let's see now you can do this attack let's go with him the attack

894
01:22:35,080 --> 01:22:40,530
 the key of the mind always very complex so step 1

895
01:22:45,040 --> 01:22:53,650
 Well, what we are going to do is a workshop, let's go to me and cats, so 64 let's go

896
01:22:53,650 --> 01:22:56,070
 to here

897
01:22:57,100 --> 01:23:03,450
 [Music] let's go from here to a consultation

898
01:23:03,450 --> 01:23:08,730
 daniel hundred english yes user if you changed the password the same will

899
01:23:08,730 --> 01:23:13,919
 being able to enter that is asking me with the investment touch axxion is a

900
01:23:13,920 --> 01:23:17,970
 good question the truth is that I was looking at the

901
01:23:17,970 --> 01:23:21,750
 official documentation and not the clear cause in the documentation is of the module

902
01:23:21,750 --> 01:23:27,210
 it does not succeed and personally I never tried it, it would have to be tried

903
01:23:27,210 --> 01:23:34,170
 I'm not sure I'm sure but I can't do it with honor

904
01:23:34,170 --> 01:23:37,650
 and in the documentation the documentation will be associated clarifies this that one is

905
01:23:37,650 --> 01:23:41,309
 can praise and stay and the doukas does not clarify the issue of whether a change of

906
01:23:41,310 --> 01:23:44,030
 key code

907
01:23:44,190 --> 01:23:48,179
 well if we say

908
01:23:48,520 --> 01:23:51,450
 with this

909
01:24:00,060 --> 01:24:05,700
 you can also try the first one it seems that not all 8 would not be one

910
01:24:05,700 --> 01:24:13,170
 good idea in this animal if they give us time if I know area with everything they have

911
01:24:13,170 --> 01:24:18,780
 The fact of the boys is that something else fails since it fails the least that makes it one

912
01:24:18,780 --> 01:24:21,710
 it stains the tiger more, no

913
01:24:23,560 --> 01:24:31,930
 and now we do it if we do it live

914
01:24:32,480 --> 01:24:40,660
 because those things are interesting it is interesting to try friends

915
01:24:41,040 --> 01:24:44,550
 you may be wondering since I am bad, good because in this virtual machine

916
01:24:44,550 --> 01:24:47,940
 I have the keyboard in the clear horizon year I have mine is in English

917
01:24:47,940 --> 01:24:52,110
 then and they do not know what it costs me to type well

918
01:24:52,110 --> 01:24:58,389
 How can we see here what we managed to do?

919
01:24:58,390 --> 01:25:05,470
 is to directly clean the hub in this case from the administrator account

920
01:25:05,470 --> 01:25:08,850
 domain notice

921
01:25:09,020 --> 01:25:14,560
 great second good here we have the jasen they have money

922
01:25:14,560 --> 01:25:19,510
 to each sun of their opinion they are allowed to have the administrator account of the

923
01:25:19,510 --> 01:25:22,020
 domain

924
01:25:22,610 --> 01:25:29,690
 as because it is not as we say we remember we emulate being a take on

925
01:25:29,690 --> 01:25:33,200
 against we ask the original found dogma to explain to us the

926
01:25:33,200 --> 01:25:36,599
 credentials won't replicate and we got the

927
01:25:36,600 --> 01:25:41,680
 administrator user credentials basically that

928
01:25:41,680 --> 01:25:45,400
 that against measures we can take against this good attack the best protection

929
01:25:45,400 --> 01:25:49,120
 against an attack of that zinc is to control domain permissions

930
01:25:49,120 --> 01:25:53,019
 responsible for controlling the permissions of domains responsible for allowing

931
01:25:53,020 --> 01:25:56,860
 accounts replicate changes inevitably today versus inevitably

932
01:25:56,860 --> 01:26:01,240
 some users will have this right and must be well protected and we will

933
01:26:01,240 --> 01:26:07,660
 let's do that test that was posing in the public we

934
01:26:07,660 --> 01:26:14,430
 what we were doing was let's use

935
01:26:15,040 --> 01:26:19,760
 your being and what I just did for those who don't

936
01:26:19,760 --> 01:26:26,600
 you know is to return to my previous privilege that I returned from phil and price to the privilege

937
01:26:26,600 --> 01:26:28,930
 previous

938
01:26:30,480 --> 01:26:34,889
 we are going to give the touches that we have although toukan of philip is still

939
01:26:34,890 --> 01:26:41,010
 price and what we are going to do is we are going to grab and we are going to change the password

940
01:26:41,010 --> 01:26:45,230
 we are going to change it will be from the domaine controller

941
01:26:45,420 --> 01:26:48,800
 because clearly this

942
01:26:56,880 --> 01:27:02,430
 we are going to reid seth password we are going to put

943
01:27:02,430 --> 01:27:06,480
 to know

944
01:27:06,480 --> 01:27:12,139
 word 30 21 exclamation mark

945
01:27:19,130 --> 01:27:23,350
 well there it was changed

946
01:27:24,100 --> 01:27:28,830
 well let's come back here and let's try

947
01:27:29,889 --> 01:27:33,539
 and let's say that in person

948
01:27:34,400 --> 01:27:42,759
 I there and apparently yes in people with which other tuna can be

949
01:27:42,760 --> 01:27:45,940
 Doing the impersonation of all looks of riding can also be done with

950
01:27:45,940 --> 01:27:51,679
 power plate tools yes yes not only with that it is easier but

951
01:27:51,680 --> 01:27:57,300
 it is ok from power point in fact it can be done

952
01:27:57,300 --> 01:28:01,260
 if not for this it is also good to clarify that for all that I am

953
01:28:01,260 --> 01:28:05,130
 doing now although I am using some tours it is not that they are the only ones

954
01:28:05,130 --> 01:28:10,380
 for example all impact suites & has a lot of tours that are

955
01:28:10,380 --> 01:28:15,630
 They recontra roses and they can follow them a lot, it kind of depends on the situation

956
01:28:15,630 --> 01:28:20,880
 one chooses the best tool there are not a lot of your to do the same it depends

957
01:28:20,880 --> 01:28:24,530
 of what you need an hour that is more comfortable for you

958
01:28:24,530 --> 01:28:28,719
 but hey there are several tools and regarding sewing

959
01:28:28,720 --> 01:28:35,780
 what I'm going to try to do is xx jude

960
01:28:35,780 --> 01:28:44,960
 john f cmd dot exe dash and dash

961
01:28:44,960 --> 01:28:52,620
 ok he didn't leave me if I can be

962
01:28:57,739 --> 01:29:01,480
 and now to see if I can do

963
01:29:04,780 --> 01:29:12,699
 slash and cor dash slash

964
01:29:12,699 --> 01:29:19,910
 rosso already with this we see what happens

965
01:29:19,929 --> 01:29:27,159
 I don't take it in a second if I'm not sure

966
01:29:27,159 --> 01:29:31,589
 say the results that appear there is why it was

967
01:29:41,989 --> 01:29:45,400
 if I put powers he

968
01:29:47,610 --> 01:29:50,659
 No means no

969
01:29:53,780 --> 01:29:57,969
 ok I am about to die the session of interpreting it

970
01:29:57,969 --> 01:30:00,960
 only me

971
01:30:01,730 --> 01:30:06,620
 well i'm not working because i threw it up and it takes it to get this

972
01:30:06,620 --> 01:30:11,900
 more I would have to see how it will happen to the grass is not taking me but beginning

973
01:30:11,900 --> 01:30:16,549
 answering the question that was out there on the chat I would say yes that

974
01:30:16,550 --> 01:30:22,050
 it works for me the problem I am having here is for now the goal

975
01:30:22,050 --> 01:30:26,980
 Something like this has happened to me other times with project goals, I would say yes

976
01:30:26,980 --> 01:30:31,940
 In short, I do not know if any other questions until now

977
01:30:31,940 --> 01:30:37,639
 I did not see that they were writing but it still follows us as soon as they fire

978
01:30:37,640 --> 01:30:43,000
 all ok well now what we are going to do is

979
01:30:43,000 --> 01:30:50,730
 let's make a short pause and then it's a pause of five

980
01:30:50,730 --> 01:30:54,780
 minutes to drink something stretches your legs relaxes your head a little

981
01:30:54,780 --> 01:30:59,309
 I imagine that they will all be burned, I also already realized

982
01:30:59,309 --> 01:31:04,520
 that some if thank you in 5 minutes we are

983
01:31:04,520 --> 01:31:08,500
 coming back here in ekoparty tweets

984
01:31:10,989 --> 01:31:16,299
 well here we are again we are going with the last part of this

985
01:31:16,300 --> 01:31:18,570
 workshop

986
01:31:19,260 --> 01:31:27,600
 and we will be looking at everything that is the kerberos protocol

987
01:31:27,600 --> 01:31:34,850
 and let's see how to attack this protocol

988
01:31:36,230 --> 01:31:41,269
 anything there is a question from daniel that exists to erase those

989
01:31:41,270 --> 01:31:45,010
 token with nowhere

990
01:31:47,330 --> 01:31:52,180
 let's give a second I'm checking something

991
01:31:55,600 --> 01:32:02,300
 because they always want to pass the others but that's where we are

992
01:32:02,300 --> 01:32:08,770
 securing the big one directly before re-assuring that

993
01:32:08,770 --> 01:32:12,969
 we do the same they will fail because that is how the demos work

994
01:32:12,969 --> 01:32:18,070
 well repeating the question told me if the

995
01:32:18,070 --> 01:32:23,139
 questions could be deleted those touch with some gp or

996
01:32:23,139 --> 01:32:29,409
 with any GP that I know of, not even though I don't know, there is no GP or that one

997
01:32:29,409 --> 01:32:33,719
 you can use to erase those touches

998
01:32:35,050 --> 01:32:42,760
 well one after another more not only very good that you have to light a candle for him

999
01:32:42,760 --> 01:32:48,579
 God of the demos and a lot of reason not just a candle to all has to

1000
01:32:48,579 --> 01:32:53,469
 learn a candle so wait yes yes yes we agree we totally

1001
01:32:53,469 --> 01:32:59,170
 Okay well let's go with this last segment of the workshop which is

1002
01:32:59,170 --> 01:33:02,679
 kerberos kerberos basically in director activity and we the

1003
01:33:02,679 --> 01:33:06,790
 authentication that root through iker see what this protocol is

1004
01:33:06,790 --> 01:33:10,000
 basically this is a protocol that your dreams are based on what

1005
01:33:10,000 --> 01:33:13,989
 they call tickets and this is presented to the different resources of the network to

1006
01:33:13,989 --> 01:33:18,218
 check your permissions kerberos is an authentication player but not

1007
01:33:18,219 --> 01:33:22,540
 authorization that we distinguish authentication from authorization auto is

1008
01:33:22,540 --> 01:33:27,250
 basically say kerberos is a protocol that said in a very crude way

1009
01:33:27,250 --> 01:33:32,920
 and direct and authentic to a person himself to say proof that such an identity is

1010
01:33:32,920 --> 01:33:36,670
 Who claims to be this means that the protocol is good

1011
01:33:36,670 --> 01:33:40,119
 It is not in charge, I am going to say that the protocol is in charge of identifying

1012
01:33:40,119 --> 01:33:44,440
 each user through an unknown password just for aesthetics but not

1013
01:33:44,440 --> 01:33:49,269
 determines what resources or services said user may or may not access even if

1014
01:33:49,270 --> 01:33:56,050
 let's take into account that authentication details not authorization well said

1015
01:33:56,050 --> 01:34:00,940
 this let's see the third party elements is the client machine where

1016
01:34:00,940 --> 01:34:04,900
 find the user you want who wants to access the service

1017
01:34:04,900 --> 01:34:08,559
 we have the machine that offers the service, that is, the system to which the

1018
01:34:08,560 --> 01:34:13,119
 user wants to access and we have the key distribution center which is a server

1019
01:34:13,119 --> 01:34:17,679
 central which is in charge of authenticating users and distributing among them

1020
01:34:17,679 --> 01:34:20,710
 tickets so they can be identified against other machines

1021
01:34:20,710 --> 01:34:25,840
 services in the case of a tories activity the one you want is installed in the

1022
01:34:25,840 --> 01:34:28,739
 same dressage in control

1023
01:34:28,910 --> 01:34:33,680
 and then there are these tickets that I was commenting on, of which there are two the

1024
01:34:33,680 --> 01:34:39,200
 service tickets or the tickets that are used to identify identify yourself

1025
01:34:39,200 --> 01:34:43,720
 against the services and two large ticket in tickets that are used to

1026
01:34:43,720 --> 01:34:47,660
 authenticate against the candy server and get them pgs to access

1027
01:34:47,660 --> 01:34:52,809
 to the different services well how does this work we are

1028
01:34:52,810 --> 01:34:56,980
 a users x can be any domain user

1029
01:34:56,980 --> 01:35:01,299
 we are going to go we are going to make a user of we isolate and we make a rich

1030
01:35:01,300 --> 01:35:05,920
 exterior to request a trinquet a granite ticket return us worthy is

1031
01:35:05,920 --> 01:35:11,110
 free ticket with this one we are going to make them dgt to make more enabled with this

1032
01:35:11,110 --> 01:35:17,049
 ticket we look again at the one who says that van baldom returns us in

1033
01:35:17,050 --> 01:35:21,730
 against returns the ts which contains the hash of the account

1034
01:35:21,730 --> 01:35:25,570
 services ok we send here with the hash

1035
01:35:25,570 --> 01:35:29,679
 ours and here it returns us with the hashtag of the service account that

1036
01:35:29,680 --> 01:35:33,400
 now we are going to see it well we are attacking and then well this we

1037
01:35:33,400 --> 01:35:39,429
 We send them to the service server which we want to access

1038
01:35:39,429 --> 01:35:43,620
 now that we are centering the kerberos part over our part

1039
01:35:43,620 --> 01:35:48,930
 more complicated workshop and more difficult to follow so with this already

1040
01:35:48,930 --> 01:35:51,110
 this

1041
01:35:52,380 --> 01:35:56,940
 or if they more or less hook those hands, we have just two tickets

1042
01:35:56,940 --> 01:36:01,888
 one that is the big ticket and ticket and then we have the landín ticket

1043
01:36:01,889 --> 01:36:04,739
 service which is with which we can access the service with the

1044
01:36:04,739 --> 01:36:08,190
 landi ticket ticket we access the big ticket and service and with the ticket

1045
01:36:08,190 --> 01:36:14,580
 during in service we access the service well before continuing

1046
01:36:14,580 --> 01:36:20,250
 I am going to explain something, it is called service principal names or the esp / n the esp not

1047
01:36:20,250 --> 01:36:23,100
 Service principal names are basically used to identify

1048
01:36:23,100 --> 01:36:27,510
 exclusively for each instance a service in windows

1049
01:36:27,510 --> 01:36:32,070
 to enable authentication kerberos requires that the cpn be associated

1050
01:36:32,070 --> 01:36:36,659
 with at least one account login service an account specifically

1051
01:36:36,659 --> 01:36:40,500
 in charge of executing an essential service sbn are used very commonly

1052
01:36:40,500 --> 01:36:44,280
 to secure services to manage applications such as make sure

1053
01:36:44,280 --> 01:36:48,750
 Álvaro óscar tells us well, let's see now how to attack

1054
01:36:48,750 --> 01:36:51,660
 kerberos and we are going to see if attacking that it is good can be understood more in

1055
01:36:51,660 --> 01:36:56,760
 depth how does it work we are going to give a specific attack which is the laker

1056
01:36:56,760 --> 01:37:01,230
 austin that is a task that what he does is try to use these services and kits

1057
01:37:01,230 --> 01:37:05,490
 to create user passwords offline

1058
01:37:05,490 --> 01:37:09,300
 this attack wanting browsing uses the passwords of services use the

1059
01:37:09,300 --> 01:37:13,110
 service accounts that leverage warrior serial authentications with

1060
01:37:13,110 --> 01:37:17,040
 the main names of services say the bronze team what it does is

1061
01:37:17,040 --> 01:37:21,390
 use service accounts that leverage camero authentication

1062
01:37:21,390 --> 01:37:28,740
 with the sps the service tickets as I mentioned come with the ntm hash of the

1063
01:37:28,740 --> 01:37:32,820
 domain account to the quality of the service that is, we are reviewing again

1064
01:37:32,820 --> 01:37:38,040
 when he returns here the ts returns with the hearts of the account that this society in

1065
01:37:38,040 --> 01:37:41,580
 in this case the account that is associated goes to a service in this case

1066
01:37:41,580 --> 01:37:48,180
 service to do the sql server ok wants to connect the account with sp esp

1067
01:37:48,180 --> 01:37:52,090
 n so if a user requests a tps

1068
01:37:52,090 --> 01:37:56,079
 of a service that is linked to a user once the tgss is obtained.

1069
01:37:56,079 --> 01:37:59,049
 can lead to work and find on your own machine trying to create the

1070
01:37:59,050 --> 01:38:04,280
 user password let's look at some important data to

1071
01:38:04,280 --> 01:38:08,210
 take into account how any user authenticated to you director and we can

1072
01:38:08,210 --> 01:38:12,320
 request a gs that is to say how am I going to use standard

1073
01:38:12,320 --> 01:38:17,269
 we scan active directory for user accounts with esp / n values

1074
01:38:17,270 --> 01:38:21,800
 established that is what we are going to use a tgc is requested to

1075
01:38:21,800 --> 01:38:24,929
 access a service by specifying its esp / n

1076
01:38:24,929 --> 01:38:29,459
 to you director and flight a ts containing the hash of the accounts

1077
01:38:29,459 --> 01:38:34,219
 associated with this service or that social service accounts with sst cpn

1078
01:38:34,219 --> 01:38:37,920
 we grab the cash what is left until we get the password of the account in

1079
01:38:37,920 --> 01:38:41,170
 plain text ok

1080
01:38:41,170 --> 01:38:45,190
 let's review the new one but in another way because I know you are half

1081
01:38:45,190 --> 01:38:49,839
 far-fetched and that it is 36 redundant but I prefer as means to explain it in

1082
01:38:49,840 --> 01:38:54,190
 different ways, it even came out a little, let's go again, what we do is scan

1083
01:38:54,190 --> 01:38:57,910
 active directory looking for user accounts with set cpn values

1084
01:38:57,910 --> 01:39:00,699
 ok we go we have to look for the

1085
01:39:00,699 --> 01:39:05,379
 user account have these values ​​that are those are have that are like aliases of

1086
01:39:05,380 --> 01:39:10,179
 cpn be well established we have to request the ticket of

1087
01:39:10,179 --> 01:39:16,119
 service in the d using cpn values ​​if we request with

1088
01:39:16,119 --> 01:39:20,440
 our grand ticket a service ticket we have to get the

1089
01:39:20,440 --> 01:39:24,848
 service tickets and save them to a file and good to create that ticket

1090
01:39:24,849 --> 01:39:32,490
 we will use brute force well and let's see how this is

1091
01:39:35,309 --> 01:39:40,780
 let's go so we can come back here fine

1092
01:39:40,780 --> 01:39:43,980
 what we are going to do

1093
01:39:46,370 --> 01:39:51,000
 it's gay ius art

1094
01:39:51,000 --> 01:39:55,310
 they fire and cut

1095
01:39:55,310 --> 01:40:01,360
 a local point

1096
01:40:01,710 --> 01:40:07,469
 a brown in this case so they see that we are using a

1097
01:40:07,469 --> 01:40:11,910
 user with few privileges we make this tool that we are using

1098
01:40:11,910 --> 01:40:17,130
 it is also part of the impact suite & ok this get and use the spy

1099
01:40:17,130 --> 01:40:22,290
 nothing like the one told them in packages like a huge monster that

1100
01:40:22,290 --> 01:40:27,480
 has beautiful tools no no we cannot see all of them because we

1101
01:40:27,480 --> 01:40:32,549
 It would take later to say that it must be another course for six there are things that if

1102
01:40:32,550 --> 01:40:37,850
 one gets to see in details are they are workshops apart for example what of

1103
01:40:37,850 --> 01:40:43,950
 antivirus evasion that these guys told you before about a total issue that

1104
01:40:43,950 --> 01:40:49,920
 you can do but it is totally apart I what I want to verify this ip ok is the

1105
01:40:49,920 --> 01:40:57,090
 ip of the domaine controller ok the 192 points hundreds of 8.4 and look at us

1106
01:40:57,090 --> 01:41:01,110
 Now what we are going to do is this and notice that we here have the

1107
01:41:01,110 --> 01:41:04,920
 ticket ok and now I'm good right here they have the

1108
01:41:04,920 --> 01:41:10,080
 piece of tickets we are going to delete the ticket that had already been created from

1109
01:41:10,080 --> 01:41:14,570
 from the previous bs workshop

1110
01:41:14,659 --> 01:41:20,299
 and what we are going to do and there where the controversial comes the controversial of the night

1111
01:41:20,300 --> 01:41:25,400
 and let's open a text editor that a lot of people look weird to open this

1112
01:41:25,400 --> 01:41:29,570
 text editor and that's where in the base tweet chat

1113
01:41:29,570 --> 01:41:34,188
 but as you can be using nothing, this should not be illegal as you can not

1114
01:41:34,189 --> 01:41:39,889
 to be using that well nothing I love to see these things is radio beat but yes

1115
01:41:39,889 --> 01:41:42,429
 not susana

1116
01:41:43,890 --> 01:41:57,249
 yes yes yes yes I know what we are going to do if we fail also call Susana I don't know anything

1117
01:41:57,249 --> 01:42:06,940
 of what exists, I already know, I know that entering here and streaming serna is not hey

1118
01:42:06,940 --> 01:42:12,769
 hey they already told me previous months

1119
01:42:12,770 --> 01:42:16,960
 is like saying that he wears white like that

1120
01:42:17,070 --> 01:42:24,239
 and well so those monies in those transfers of choosing you are opening

1121
01:42:24,239 --> 01:42:29,869
 debates that I think will be there in the chat pressure if long

1122
01:42:30,920 --> 01:42:37,599
 It does not matter the basis of the debate if the fight is the fight of the year

1123
01:42:37,599 --> 01:42:43,239
 and well nothing there what you are hash cut as you could see basically the

1124
01:42:43,239 --> 01:42:47,049
 Grab him, pass him the ticket he had obtained and notice that he kept the password

1125
01:42:47,050 --> 01:42:50,289
 that good in this case they were from the unit personally to dictionary the rope

1126
01:42:50,289 --> 01:42:55,780
 until 2020 it remembers that we had already obtained real through the method of

1127
01:42:55,780 --> 01:43:00,909
 hours time but hey the idea was to show how through this attack of

1128
01:43:00,909 --> 01:43:05,589
 bankrupt Austin we could get the key is staying in the

1129
01:43:05,590 --> 01:43:11,310
 good ticket as a countermeasure basically the

1130
01:43:11,310 --> 01:43:14,580
 best protection against a roasting goat attack is to ensure that the

1131
01:43:14,580 --> 01:43:18,870
 service accounts using kerberos with cpn values ​​have passwords

1132
01:43:18,870 --> 01:43:23,490
 long and complex and obviously if also if it is possible that these

1133
01:43:23,490 --> 01:43:28,830
 passwords are rotated regularly to detect an attack in progress

1134
01:43:28,830 --> 01:43:32,490
 What you have to do is control the normal use of the account.

1135
01:43:32,490 --> 01:43:36,780
 services must traditionally be used from the same systems of the same

1136
01:43:36,780 --> 01:43:41,910
 way so it is possible to detect authentication anomalies besides good

1137
01:43:41,910 --> 01:43:45,269
 you can monitor service ticket requests in the active

1138
01:43:45,270 --> 01:43:48,639
 directory to look for spikes in these requests

1139
01:43:48,639 --> 01:43:53,769
 Well now let's go with some final conclusions and some things I want to reject

1140
01:43:53,769 --> 01:43:56,829
 there are also other attacks of warriors as then authentic

1141
01:43:56,829 --> 01:44:01,940
 distinguish difficult vertical that we will not be mentioning in this talk

1142
01:44:01,940 --> 01:44:05,540
 I have dictated it in the previous workshop that was in the echo for good in this one

1143
01:44:05,540 --> 01:44:09,769
 for a matter of time, it will not be there and we will go directly to the

1144
01:44:09,770 --> 01:44:13,640
 final conclusions where I am going to be commenting a little about a

1145
01:44:13,640 --> 01:44:17,630
 tool called hawn blog and I'll be showing you a little bit and now

1146
01:44:17,630 --> 01:44:23,690
 with this we close which blog although it is an open source tool that

1147
01:44:23,690 --> 01:44:28,308
 basically allows us to automate the discovery of routes to be able to

1148
01:44:28,309 --> 01:44:33,719
 compromising an environment to you director and using several of these those attacks

1149
01:44:33,719 --> 01:44:38,880
 we saw this tool also graphical everything so it is beautiful when

1150
01:44:38,880 --> 01:44:45,710
 see them more to say it is excellent good and we will go to the last one

1151
01:44:45,710 --> 01:44:51,580
 of model of the night where what we are going to do is

1152
01:44:51,580 --> 01:44:57,040
 came why

1153
01:44:57,040 --> 01:45:03,260
 with sun what am I doing here if the database is working ok

1154
01:45:03,260 --> 01:45:09,170
 and a sharia cause exc

1155
01:45:11,470 --> 01:45:15,690
 and here we are going to blog

1156
01:45:20,869 --> 01:45:23,829
 and there he goes wanting

1157
01:45:24,350 --> 01:45:31,840
 What I'm going to show here is basically data that was imported

1158
01:45:32,420 --> 01:45:37,670
 we can execute a point line of ground power using a

1159
01:45:37,670 --> 01:45:42,440
 program we can create a kind of files and if I am not confused what

1160
01:45:42,440 --> 01:45:47,030
 now we verify that we then import it into this tool and we

1161
01:45:47,030 --> 01:45:52,179
 gives all these data that we previously listed and allows us

1162
01:45:52,179 --> 01:45:56,090
 graph everything and in case we have a web infrastructure it is

1163
01:45:56,090 --> 01:45:59,360
 all very nice with this demo that I'm doing with two machines but our

1164
01:45:59,360 --> 01:46:04,880
 Real structure we have 500 machines and it's crazy I'm going to do it here

1165
01:46:04,880 --> 01:46:12,880
 come good young people and a yep let's go to the radio ok

1166
01:46:14,410 --> 01:46:17,500
 [Music]

1167
01:46:17,900 --> 01:46:21,040
 we are going to go to

1168
01:46:24,660 --> 01:46:30,420
 dalí take note

1169
01:46:32,610 --> 01:46:36,949
 it did not matter well building the graph

1170
01:46:37,280 --> 01:46:43,200
 Now let's see how, look at me, it brings me both

1171
01:46:43,200 --> 01:46:48,210
 mindfulness that notice that for example goodbye to find all the tomatoes to me

1172
01:46:48,210 --> 01:46:53,450
 It does not tell me good 3 is the same service transfer and price you have the administrator

1173
01:46:53,450 --> 01:47:00,090
 and this is part of the group of this miami fixed today before all these colista

1174
01:47:00,090 --> 01:47:08,140
 back they are already presses made one could grab and could

1175
01:47:08,140 --> 01:47:14,290
 and doing your own ways now is obviously going to what you need

1176
01:47:14,290 --> 01:47:18,450
 each one grabs

1177
01:47:19,329 --> 01:47:22,379
 No return

1178
01:47:22,639 --> 01:47:25,329
 So

1179
01:47:25,530 --> 01:47:31,679
 Well let's look here here I managed to ask is that you tell me the main purpose sweet sixteen

1180
01:47:31,680 --> 01:47:37,350
 write notice that it appears from that zinc that belongs to the dot liquor domain

1181
01:47:37,350 --> 01:47:43,050
 local and notice how the root of all the connections with everything is as you can see is

1182
01:47:43,050 --> 01:47:48,710
 basically excellent automatically allows them to graph and

1183
01:47:48,710 --> 01:47:53,180
 obviously here look at the graph that is and we are talking about three machines

1184
01:47:53,180 --> 01:47:58,280
 used we have a server and two clients and fixed of all the buoyant

1185
01:47:58,280 --> 01:48:02,610
 there are only the machine there are the groups there are the users

1186
01:48:02,610 --> 01:48:05,480
 to everything

1187
01:48:07,210 --> 01:48:13,770
 to see if I do not know if it will seem that we do not depend on having

1188
01:48:14,270 --> 01:48:18,520
 if you find something like mai no

1189
01:48:19,590 --> 01:48:26,150
 look good that carver not this bag counts I think the second services

1190
01:48:26,150 --> 01:48:31,889
 well this is the account that erviti city is good we came to give for

1191
01:48:31,890 --> 01:48:36,750
 the own account that uses kerberos and the one of good the one of sql services that is

1192
01:48:36,750 --> 01:48:44,610
 an account that is not ready when I put it I put what list this account is

1193
01:48:44,610 --> 01:48:48,900
 and well nothing as you could see this was a to show you a little what it is about

1194
01:48:48,900 --> 01:48:54,480
 this tool can obviously be exploited much, much more but

1195
01:48:54,480 --> 01:49:01,280
 well it was like at least they know her and see what they think

1196
01:49:02,139 --> 01:49:08,519
 and well nothing with this we are already reaching the end of this workshop

1197
01:49:08,519 --> 01:49:13,209
 Thank you very much everyone for attending the truth, thank you also very much to

1198
01:49:13,209 --> 01:49:17,039
 the guys from the echo who recovered are always always supportive

1199
01:49:17,039 --> 01:49:21,459
 Thank you very much to the info community I know that the truth is that I do not know if you such

1200
01:49:21,459 --> 01:49:25,030
 time you are the first is that in a stream and the community was never at your

1201
01:49:25,030 --> 01:49:31,749
 message the community one does not realize me five years ago personally people

1202
01:49:31,749 --> 01:49:36,820
 Of course I do not remember how long ago nor did it occur to me that I could be here contributing my

1203
01:49:36,820 --> 01:49:39,849
 grain of sand to the community and tomorrow can obviously be you

1204
01:49:39,849 --> 01:49:44,639
 who are here contributing their grain of sand also to the community and

1205
01:49:44,639 --> 01:49:49,510
 sweating a lot because we fail them we give it like that, I don't know about you

1206
01:49:49,510 --> 01:49:52,630
 Rodríguez if you also want to add something I do not want to thank you

1207
01:49:52,630 --> 01:49:56,849
 all the boys of the eco send a greeting also to good

1208
01:49:56,970 --> 01:50:03,300
 from my team send a greeting to the layman boy and I am not walking in voice

1209
01:50:03,300 --> 01:50:06,300
 rodri

1210
01:50:06,840 --> 01:50:13,510
 adding everything that exists before nothing that I as a developer is

1211
01:50:13,510 --> 01:50:18,010
 communicating this avenue is very good for all those who have just been - all

1212
01:50:18,010 --> 01:50:23,680
 they fear and know the echo, I recommend that they join when they can

1213
01:50:23,680 --> 01:50:28,510
 do the lectures again go are incredible the people behind

1214
01:50:28,510 --> 01:50:34,889
 it is a mass so not wide angle sad and very

1215
01:50:34,889 --> 01:50:39,780
 proud also several years ago I go and there is always a new train and I

1216
01:50:39,780 --> 01:50:45,389
 They surprise every year so a hug from the team that is behind everything

1217
01:50:45,389 --> 01:50:50,789
 this and will give pride so he also imparts a greeting to all

1218
01:50:50,789 --> 01:50:55,829
 streaming studios hello guys have the chat guys that

1219
01:50:55,829 --> 01:51:01,768
 They study helping topics that I am with a couple of things and others so that it is not

1220
01:51:01,769 --> 01:51:07,739
 so nothing completed with that well I already bought the country closing again I leave you

1221
01:51:07,739 --> 01:51:12,808
 The resources are there the same, he left me there but if it falls, it could be the

1222
01:51:12,809 --> 01:51:15,659
 There are also resources, I think they have a form for you to give me your feedback

1223
01:51:15,659 --> 01:51:21,059
 what they liked in the ones that would improve or not

1224
01:51:21,060 --> 01:51:27,270
 Well, nothing said, I say goodbye and one more thing is that nothing is added to

1225
01:51:27,270 --> 01:51:31,410
 the conferences as Rodríguez said even if it is the first time if you don't

1226
01:51:31,410 --> 01:51:35,010
 be sure or think that it is not enough do not hesitate always go to

1227
01:51:35,010 --> 01:51:39,510
 conferences take that first step which is the most beautiful thing that can happen to you

1228
01:51:39,510 --> 01:51:44,220
 Well it happened to me today well here we are with demos that break but pass

1229
01:51:44,220 --> 01:51:48,420
 from the pump so good nothing people a big hug

1230
01:51:48,420 --> 01:51:53,820
 a huge greeting to all of you and see you in the next one and shared in the

1231
01:51:53,820 --> 01:51:58,700
 next workshop a big hug see you

1232
01:51:59,030 --> 01:52:11,750
 [Music]

1233
01:52:13,880 --> 01:52:18,570
 or or not

1234
01:52:18,570 --> 01:52:26,219
 [Music] how

1235
01:52:26,220 --> 01:52:42,300
 [Music]

1236
01:52:44,580 --> 01:52:48,330
 [Music] or not

1237
01:52:48,330 --> 01:52:53,610
 [Music] or

1238
01:52:53,610 --> 01:53:03,389
 [Music]

1239
01:53:11,390 --> 01:53:14,459
 [Music]

1240
01:53:20,680 --> 01:53:23,850
 [Music]

1241
01:53:27,290 --> 01:53:29,950
 well

1242
01:53:30,340 --> 01:53:39,689
 [Music]

1243
01:53:46,070 --> 01:53:52,049
 [Music]

1244
01:53:55,610 --> 01:53:57,759
 not

1245
01:53:58,560 --> 01:54:56,379
 [Music]

