1
00:00:15,139 --> 00:00:18,300
well we are going to introduce with a

2
00:00:18,300 --> 00:00:21,770
very loud clap to Tony lauro

3
00:00:21,770 --> 00:00:26,960
[Applause]

4
00:00:26,960 --> 00:00:29,400
thank you everyone I feel like that

5
00:00:29,400 --> 00:00:31,320
motivational speaker up here

6
00:00:31,320 --> 00:00:33,440
uh I'm going to start today

7
00:00:33,440 --> 00:00:35,219
you know

8
00:00:35,219 --> 00:00:37,500
so my name is Tony larum director of

9
00:00:37,500 --> 00:00:40,200
security strategy at Akamai uh I've been

10
00:00:40,200 --> 00:00:42,239
at optimize for about 10 years but I've

11
00:00:42,239 --> 00:00:45,719
been in infosec since the late 90s

12
00:00:45,719 --> 00:00:48,180
and what's interesting is every job I've

13
00:00:48,180 --> 00:00:50,820
worked for you know I'm securing systems

14
00:00:50,820 --> 00:00:52,200
I'm going through audits I'm doing

15
00:00:52,200 --> 00:00:54,420
whatever and you're kind of like waiting

16
00:00:54,420 --> 00:00:56,340
to be hacked you're waiting for the big

17
00:00:56,340 --> 00:00:58,500
event to happen but it doesn't always

18
00:00:58,500 --> 00:01:00,600
happen right not every company you work

19
00:01:00,600 --> 00:01:04,739
for gets hacked uh but when I came to

20
00:01:04,739 --> 00:01:06,720
Akamai 10 years ago you know we're

21
00:01:06,720 --> 00:01:08,400
sitting in front of the world's largest

22
00:01:08,400 --> 00:01:11,640
banks social media networks uh if you

23
00:01:11,640 --> 00:01:14,280
watch the FIFA World Cup uh streaming or

24
00:01:14,280 --> 00:01:15,960
the social Olympics that's all streaming

25
00:01:15,960 --> 00:01:18,479
through Akamai so we're seeing major

26
00:01:18,479 --> 00:01:22,080
major attacks uh all the time and that

27
00:01:22,080 --> 00:01:24,360
has really allowed me to get a really

28
00:01:24,360 --> 00:01:26,100
interesting Insight of what's happening

29
00:01:26,100 --> 00:01:28,979
on the internet what's bad you know what

30
00:01:28,979 --> 00:01:30,780
are we kind of told is bad what's not

31
00:01:30,780 --> 00:01:32,820
really happening that much

32
00:01:32,820 --> 00:01:34,740
um so I thought it would be cool to

33
00:01:34,740 --> 00:01:36,479
compile a list

34
00:01:36,479 --> 00:01:38,520
uh of some of the cool things that I've

35
00:01:38,520 --> 00:01:41,700
seen uh but I want to make a disclaimer

36
00:01:41,700 --> 00:01:44,820
so the first disclaimer let me first uh

37
00:01:44,820 --> 00:01:46,560
give you guys a little background about

38
00:01:46,560 --> 00:01:51,180
myself I uh I come from Dallas Texas so

39
00:01:51,180 --> 00:01:53,280
the flight was beautiful direct very

40
00:01:53,280 --> 00:01:54,540
nice

41
00:01:54,540 --> 00:01:56,579
um and I've got a family there I grew up

42
00:01:56,579 --> 00:01:58,680
wrestling and skateboarding doing

43
00:01:58,680 --> 00:02:01,259
Brazilian Jiu Jitsu so if you need

44
00:02:01,259 --> 00:02:03,180
physical security I can also help you

45
00:02:03,180 --> 00:02:05,340
with that so just if anyone feels unsafe

46
00:02:05,340 --> 00:02:06,719
you just let me know

47
00:02:06,719 --> 00:02:10,979
and this is my Twitter handle uh my

48
00:02:10,979 --> 00:02:13,080
handle that I got in the late 90s is Wu

49
00:02:13,080 --> 00:02:15,180
Ming which interestingly interestingly

50
00:02:15,180 --> 00:02:17,160
enough it means anonymous

51
00:02:17,160 --> 00:02:19,920
uh in Chinese so I was Anonymous before

52
00:02:19,920 --> 00:02:23,819
Anonymous was Anonymous that's I'm not

53
00:02:23,819 --> 00:02:26,040
sure that's that cool or not and this

54
00:02:26,040 --> 00:02:27,420
picture I don't know I might have to

55
00:02:27,420 --> 00:02:29,280
change that my head is huge

56
00:02:29,280 --> 00:02:32,160
uh so a little bit about Akamai we just

57
00:02:32,160 --> 00:02:34,020
hit a high water mark a traffic

58
00:02:34,020 --> 00:02:36,540
Watermark so you guys might know Akamai

59
00:02:36,540 --> 00:02:39,959
is a CDN Network so we deliver content

60
00:02:39,959 --> 00:02:42,720
uh and secure content for all these big

61
00:02:42,720 --> 00:02:44,940
organizations I told you about we

62
00:02:44,940 --> 00:02:46,680
recently reached a high water mark of

63
00:02:46,680 --> 00:02:49,620
250 terabits per second so we're an

64
00:02:49,620 --> 00:02:51,360
overlay on top of the internet to make

65
00:02:51,360 --> 00:02:53,040
the internet faster and more reliable

66
00:02:53,040 --> 00:02:55,860
and more secure so I was like 250

67
00:02:55,860 --> 00:02:58,260
terabytes terabits per second what does

68
00:02:58,260 --> 00:02:59,700
that look like

69
00:02:59,700 --> 00:03:00,360
um

70
00:03:00,360 --> 00:03:03,480
so we did a little infographic and the

71
00:03:03,480 --> 00:03:05,160
infographic looks like this it says if

72
00:03:05,160 --> 00:03:07,319
you wanted to watch every or download

73
00:03:07,319 --> 00:03:10,440
every movie that's ever been made

74
00:03:10,440 --> 00:03:12,599
um you could do that every movie that's

75
00:03:12,599 --> 00:03:14,760
ever been made every feature length

76
00:03:14,760 --> 00:03:17,940
movie which means 50 minutes and above

77
00:03:17,940 --> 00:03:21,720
you could download every movie in 37

78
00:03:21,720 --> 00:03:23,159
seconds

79
00:03:23,159 --> 00:03:25,319
that's the throughput on the platform

80
00:03:25,319 --> 00:03:27,659
and just you know in one single day one

81
00:03:27,659 --> 00:03:29,000
high Watermark

82
00:03:29,000 --> 00:03:32,819
as an engineer I said This is BS let me

83
00:03:32,819 --> 00:03:36,720
look into it so I went to uh IMDb and it

84
00:03:36,720 --> 00:03:39,000
says there's 500 000 feature-length

85
00:03:39,000 --> 00:03:41,340
films they're roughly about four

86
00:03:41,340 --> 00:03:44,640
gigabytes in size uh and then that did

87
00:03:44,640 --> 00:03:46,799
check out 37 seconds if you wanted to

88
00:03:46,799 --> 00:03:48,540
watch those movies it would take 51

89
00:03:48,540 --> 00:03:51,299
years of continuous viewing so how much

90
00:03:51,299 --> 00:03:53,519
how much time you got

91
00:03:53,519 --> 00:03:55,319
so we're going to talk about really cool

92
00:03:55,319 --> 00:03:58,319
hacking right and everyone thinks that

93
00:03:58,319 --> 00:04:00,299
hacking looks like this you know this

94
00:04:00,299 --> 00:04:03,599
guy is hacking Quantico uh I think he

95
00:04:03,599 --> 00:04:05,459
hacks the Statue of Liberty I'm not sure

96
00:04:05,459 --> 00:04:07,080
how that works

97
00:04:07,080 --> 00:04:09,420
um but this is what people perceive

98
00:04:09,420 --> 00:04:12,180
hacking as and some of it is some of

99
00:04:12,180 --> 00:04:14,879
it's super sexy you show up and you're

100
00:04:14,879 --> 00:04:16,798
like you know you rubber ducky into the

101
00:04:16,798 --> 00:04:18,000
computer as you're walking to the

102
00:04:18,000 --> 00:04:20,760
bathroom at the bank that's awesome

103
00:04:20,760 --> 00:04:22,740
but the hacking I'm going to be talking

104
00:04:22,740 --> 00:04:23,880
about

105
00:04:23,880 --> 00:04:27,540
um is uh pretty interesting because it

106
00:04:27,540 --> 00:04:30,419
happens where there's no there's no

107
00:04:30,419 --> 00:04:32,639
chance for you to turn off the attack or

108
00:04:32,639 --> 00:04:35,699
turn off the website or in this case uh

109
00:04:35,699 --> 00:04:37,500
cut the hard lines

110
00:04:37,500 --> 00:04:40,440
so this uh you guys have probably seen

111
00:04:40,440 --> 00:04:42,000
cut the hard line someone have to click

112
00:04:42,000 --> 00:04:44,300
on this

113
00:04:49,199 --> 00:04:51,259
please

114
00:04:51,259 --> 00:04:54,180
you know you have these cases where it's

115
00:04:54,180 --> 00:04:55,919
like hey something really bad is

116
00:04:55,919 --> 00:04:58,080
happening cut the hard line but you

117
00:04:58,080 --> 00:05:00,900
can't turn off Facebook you can't turn

118
00:05:00,900 --> 00:05:04,500
off amazon.com you can't turn off uh you

119
00:05:04,500 --> 00:05:06,900
know the biggest banks in the world

120
00:05:06,900 --> 00:05:09,660
um you could but it probably would not

121
00:05:09,660 --> 00:05:11,699
end well for somebody

122
00:05:11,699 --> 00:05:13,680
um so the attacks we're going to talk

123
00:05:13,680 --> 00:05:16,020
about today are really interesting

124
00:05:16,020 --> 00:05:18,240
because they're happening under the

125
00:05:18,240 --> 00:05:20,220
guise of I want this to look like normal

126
00:05:20,220 --> 00:05:23,520
user traffic and as an attacker if I can

127
00:05:23,520 --> 00:05:26,699
make my traffic blend in uh that's

128
00:05:26,699 --> 00:05:29,580
that's all the better for me right

129
00:05:29,580 --> 00:05:31,860
um so we'll go into a couple examples

130
00:05:31,860 --> 00:05:34,620
here I've roughly themed this with

131
00:05:34,620 --> 00:05:37,440
Wu-Tang references and Cat kung fu

132
00:05:37,440 --> 00:05:40,320
fighting so if you don't like cats

133
00:05:40,320 --> 00:05:42,000
that's not my fault but we're going to

134
00:05:42,000 --> 00:05:44,100
talk about the five uh common

135
00:05:44,100 --> 00:05:46,199
obfuscation techniques that we've seen

136
00:05:46,199 --> 00:05:48,840
in the wild all right you guys with me

137
00:05:48,840 --> 00:05:51,600
all right let's enter the futang

138
00:05:51,600 --> 00:05:53,940
the five chambers of the futang

139
00:05:53,940 --> 00:05:56,400
the first example this is impersonation

140
00:05:56,400 --> 00:05:59,039
technique and again these are Loosely

141
00:05:59,039 --> 00:06:00,240
coined

142
00:06:00,240 --> 00:06:00,840
um

143
00:06:00,840 --> 00:06:03,000
impersonation technique this happens a

144
00:06:03,000 --> 00:06:06,600
lot with bot traffic right so googlebot

145
00:06:06,600 --> 00:06:09,060
for instance googlebot wants to uh

146
00:06:09,060 --> 00:06:11,100
peruse the internet you as a site owner

147
00:06:11,100 --> 00:06:13,380
you're going to allow googlebot to come

148
00:06:13,380 --> 00:06:15,419
into your site and if you see the

149
00:06:15,419 --> 00:06:18,120
googlebot header uh you know the user

150
00:06:18,120 --> 00:06:19,680
agent and maybe you're doing some other

151
00:06:19,680 --> 00:06:21,840
identifiers you're going to say okay

152
00:06:21,840 --> 00:06:23,220
this is googlebot I'm going to get

153
00:06:23,220 --> 00:06:25,860
access uh you know give access to this

154
00:06:25,860 --> 00:06:27,840
bot so that I don't negatively affect

155
00:06:27,840 --> 00:06:30,840
SEO so I keep the site performance going

156
00:06:30,840 --> 00:06:31,979
Etc

157
00:06:31,979 --> 00:06:36,120
so attackers have found out that hey I

158
00:06:36,120 --> 00:06:38,580
can use Google Sheets you know the Excel

159
00:06:38,580 --> 00:06:40,919
of Google and I can start scripting

160
00:06:40,919 --> 00:06:43,199
requests I can script requests that come

161
00:06:43,199 --> 00:06:46,199
from Google Sheets and go into a trusted

162
00:06:46,199 --> 00:06:49,319
website that probably shouldn't let me

163
00:06:49,319 --> 00:06:51,620
index the entire website and search it

164
00:06:51,620 --> 00:06:54,900
but if I can make the request look

165
00:06:54,900 --> 00:06:57,720
enough like googlebot then maybe that

166
00:06:57,720 --> 00:06:59,759
website will let me

167
00:06:59,759 --> 00:07:01,860
so you as a Defender you're going to ask

168
00:07:01,860 --> 00:07:03,720
yourself this question is this googlebot

169
00:07:03,720 --> 00:07:07,380
right and uh there's a couple you know

170
00:07:07,380 --> 00:07:09,060
finite ways to be able to tell if this

171
00:07:09,060 --> 00:07:11,819
is googlebot so one is to look at the

172
00:07:11,819 --> 00:07:15,240
user agent uh itself very easy to spoof

173
00:07:15,240 --> 00:07:17,819
all of this obviously but a full user

174
00:07:17,819 --> 00:07:20,759
agent string that is uh kept up to date

175
00:07:20,759 --> 00:07:22,800
and there's an index that's sent out

176
00:07:22,800 --> 00:07:24,419
that says this is the latest googlebot

177
00:07:24,419 --> 00:07:25,800
revision

178
00:07:25,800 --> 00:07:29,099
um and then the as number and the domain

179
00:07:29,099 --> 00:07:31,440
being sent with it so you can see here

180
00:07:31,440 --> 00:07:34,259
that it's Google and the as number so

181
00:07:34,259 --> 00:07:35,880
that checks out right let's see what

182
00:07:35,880 --> 00:07:38,220
this impersonator bot looks like okay

183
00:07:38,220 --> 00:07:40,620
you're coming in you've got googlebot uh

184
00:07:40,620 --> 00:07:43,259
user agent uh full user agent string is

185
00:07:43,259 --> 00:07:46,440
correct as numbers correct but the

186
00:07:46,440 --> 00:07:48,660
domain the domain is Google user content

187
00:07:48,660 --> 00:07:51,000
that's a little bit different let's keep

188
00:07:51,000 --> 00:07:53,759
going let's look at the Domain and then

189
00:07:53,759 --> 00:07:56,280
also The Cider block assigned to Google

190
00:07:56,280 --> 00:07:58,139
user content although it's owned by

191
00:07:58,139 --> 00:08:01,319
Google it's not owned by googlebot it's

192
00:08:01,319 --> 00:08:03,780
not you know meant for that

193
00:08:03,780 --> 00:08:06,300
so you would have to say we're going to

194
00:08:06,300 --> 00:08:09,840
invalidate this in many cases uh people

195
00:08:09,840 --> 00:08:12,720
are desperate for uh SEO numbers and for

196
00:08:12,720 --> 00:08:15,900
good response from the search engines so

197
00:08:15,900 --> 00:08:19,319
they white list these search Bots very

198
00:08:19,319 --> 00:08:21,300
poorly so if you're to kind of break

199
00:08:21,300 --> 00:08:23,720
this down and look at

200
00:08:23,720 --> 00:08:27,660
the the who is info it says this IP

201
00:08:27,660 --> 00:08:30,360
address and org ID are used by Google

202
00:08:30,360 --> 00:08:32,399
Cloud customers why would you allow

203
00:08:32,399 --> 00:08:34,080
Google Cloud customers to index your

204
00:08:34,080 --> 00:08:36,559
site this is a very simple example

205
00:08:36,559 --> 00:08:39,719
there's also a lot of how to's right if

206
00:08:39,719 --> 00:08:41,760
you want to run a script you want to

207
00:08:41,760 --> 00:08:43,380
make it look like googlebot here's how

208
00:08:43,380 --> 00:08:45,060
you do it now where could this

209
00:08:45,060 --> 00:08:47,399
negatively come into play here's a

210
00:08:47,399 --> 00:08:50,820
customer of ours uh that was on Amazon

211
00:08:50,820 --> 00:08:53,220
but using Akamai on the front end to

212
00:08:53,220 --> 00:08:55,860
provide CDN services and they got hit

213
00:08:55,860 --> 00:08:58,320
with a get flood request and what is

214
00:08:58,320 --> 00:09:00,779
your CDN or your Cloud Waf provider do

215
00:09:00,779 --> 00:09:03,540
they're going to either serve their

216
00:09:03,540 --> 00:09:06,120
respect responses on your behalf or

217
00:09:06,120 --> 00:09:07,440
they're going to block the traffic in

218
00:09:07,440 --> 00:09:09,480
this particular case we serve the

219
00:09:09,480 --> 00:09:13,680
responses it drove the the users uh

220
00:09:13,680 --> 00:09:16,440
monthly billing up by a thousand percent

221
00:09:16,440 --> 00:09:18,180
this is called a leaky faucet attack

222
00:09:18,180 --> 00:09:21,180
where if you're using any cloud service

223
00:09:21,180 --> 00:09:24,360
I as an attacker I can look at you know

224
00:09:24,360 --> 00:09:27,420
uh the meter so to speak of how you're

225
00:09:27,420 --> 00:09:29,640
being charged and I can specifically

226
00:09:29,640 --> 00:09:32,519
attack your cloud provider to

227
00:09:32,519 --> 00:09:34,860
financially run your numbers up for that

228
00:09:34,860 --> 00:09:36,600
month so

229
00:09:36,600 --> 00:09:39,600
in this particular case uh if there's

230
00:09:39,600 --> 00:09:42,720
any type of overage that's caused by an

231
00:09:42,720 --> 00:09:45,480
attack we actually absorb that cost uh

232
00:09:45,480 --> 00:09:47,399
within within our company and don't

233
00:09:47,399 --> 00:09:49,440
charge it to the to the customer so I

234
00:09:49,440 --> 00:09:51,720
thought that was rather nice of us

235
00:09:51,720 --> 00:09:55,560
example two trusted site technique

236
00:09:55,560 --> 00:09:57,480
uh so this is something that comes up

237
00:09:57,480 --> 00:09:59,519
quite a bit we'll look at an example

238
00:09:59,519 --> 00:10:03,019
here uh from

239
00:10:03,019 --> 00:10:05,399
raw.githubusercontent.com and you'll see

240
00:10:05,399 --> 00:10:09,120
uh highlighted in in yellow is uh the

241
00:10:09,120 --> 00:10:12,140
path to this file VP scan

242
00:10:12,140 --> 00:10:15,480
and then circled in or squared up here

243
00:10:15,480 --> 00:10:18,420
in red is the part of the website that

244
00:10:18,420 --> 00:10:19,980
has a remote file inclusion

245
00:10:19,980 --> 00:10:21,899
vulnerability in it so it looks like

246
00:10:21,899 --> 00:10:26,399
it's WordPress plugin and it's a resize

247
00:10:26,399 --> 00:10:29,459
form it's a resize PHP form and then it

248
00:10:29,459 --> 00:10:31,920
says Source equals and that usually is

249
00:10:31,920 --> 00:10:34,500
Source equals the location of the file

250
00:10:34,500 --> 00:10:36,360
you just uploaded or maybe the location

251
00:10:36,360 --> 00:10:39,180
of the file you're uploading or even if

252
00:10:39,180 --> 00:10:41,160
it's on the Fly it's going to upload

253
00:10:41,160 --> 00:10:43,320
um it's going to do that that Telemetry

254
00:10:43,320 --> 00:10:46,079
from a site that exists on the internet

255
00:10:46,079 --> 00:10:48,540
but if there's no validation of where

256
00:10:48,540 --> 00:10:51,060
you're calling out to now you have a

257
00:10:51,060 --> 00:10:53,579
remote file inclusion vulnerability

258
00:10:53,579 --> 00:10:56,640
coupled with the ability to have the web

259
00:10:56,640 --> 00:10:59,120
server execute

260
00:10:59,120 --> 00:11:02,940
vpscan.php which if you know BP scan uh

261
00:11:02,940 --> 00:11:07,500
is a uh a reverse shell script so once

262
00:11:07,500 --> 00:11:10,440
the web server executes this based on

263
00:11:10,440 --> 00:11:12,060
the configuration of the attacker it's

264
00:11:12,060 --> 00:11:14,459
going to open up either an open port or

265
00:11:14,459 --> 00:11:16,019
it's going to call back to a specific

266
00:11:16,019 --> 00:11:17,160
location

267
00:11:17,160 --> 00:11:19,019
so why would

268
00:11:19,019 --> 00:11:21,899
someone get away with this right

269
00:11:21,899 --> 00:11:24,899
um in in the terms of mass exploitation

270
00:11:24,899 --> 00:11:27,779
campaigns what I found interesting is if

271
00:11:27,779 --> 00:11:29,160
I'm an attacker

272
00:11:29,160 --> 00:11:32,820
and here's where it gets less sexy and

273
00:11:32,820 --> 00:11:36,060
more like uh uh like the the

274
00:11:36,060 --> 00:11:39,420
law of large numbers if I'm sending a

275
00:11:39,420 --> 00:11:42,060
hundred thousand phishing emails with a

276
00:11:42,060 --> 00:11:45,300
payload link or malware with a a payload

277
00:11:45,300 --> 00:11:47,100
linked to a malware file I don't want

278
00:11:47,100 --> 00:11:49,620
those requests coming back to my server

279
00:11:49,620 --> 00:11:51,899
under my desk at home I don't want it

280
00:11:51,899 --> 00:11:55,500
going to digitalocean or or Amazon where

281
00:11:55,500 --> 00:11:57,720
you know I'm paying for for all this I'm

282
00:11:57,720 --> 00:12:00,480
going to put it onto a CDN or a site

283
00:12:00,480 --> 00:12:03,720
that has CDN for a few reasons

284
00:12:03,720 --> 00:12:06,120
so why would we execute this file

285
00:12:06,120 --> 00:12:08,100
directly from GitHub and why does this

286
00:12:08,100 --> 00:12:10,440
work so one

287
00:12:10,440 --> 00:12:12,060
um the attacker doesn't need to manage

288
00:12:12,060 --> 00:12:14,279
multiple copies of this file right so

289
00:12:14,279 --> 00:12:16,740
this is just uh a shell and it's going

290
00:12:16,740 --> 00:12:18,779
to listen on a certain port or maybe

291
00:12:18,779 --> 00:12:20,220
it's going to respond to a certain type

292
00:12:20,220 --> 00:12:22,560
of request when you send it in the HTTP

293
00:12:22,560 --> 00:12:23,820
header

294
00:12:23,820 --> 00:12:24,480
um

295
00:12:24,480 --> 00:12:27,180
I don't have to keep any infrastructure

296
00:12:27,180 --> 00:12:30,300
in in the game uh two there's little

297
00:12:30,300 --> 00:12:32,820
chance that any reputation service URL

298
00:12:32,820 --> 00:12:34,500
blocking anything like that is going to

299
00:12:34,500 --> 00:12:37,680
Blacklist github's domain

300
00:12:37,680 --> 00:12:40,260
uh three this makes it difficult to

301
00:12:40,260 --> 00:12:42,360
audit uh via system logs if you don't

302
00:12:42,360 --> 00:12:43,680
know that this has happened and you're

303
00:12:43,680 --> 00:12:46,740
going through and in an environment that

304
00:12:46,740 --> 00:12:48,899
already has GitHub being used quite a

305
00:12:48,899 --> 00:12:51,360
bit this probably wouldn't show up as

306
00:12:51,360 --> 00:12:53,940
anything peculiar unless of course

307
00:12:53,940 --> 00:12:57,000
you're looking for uh the types of files

308
00:12:57,000 --> 00:12:59,880
that are being executed and lastly this

309
00:12:59,880 --> 00:13:01,980
allows for a potential use of github's

310
00:13:01,980 --> 00:13:04,820
CDN services to utilize acceleration

311
00:13:04,820 --> 00:13:08,279
here's where it gets funny uh Akamai

312
00:13:08,279 --> 00:13:11,339
sits in front of GitHub and uh a few

313
00:13:11,339 --> 00:13:12,899
years ago they got hit with one of the

314
00:13:12,899 --> 00:13:16,680
largest DDOS attacks in history 1.3 uh

315
00:13:16,680 --> 00:13:19,680
terabits per second of attack traffic it

316
00:13:19,680 --> 00:13:22,860
looked like this coming into our sock

317
00:13:22,860 --> 00:13:25,680
this was an M Cassidy uh reflection

318
00:13:25,680 --> 00:13:27,060
attack if you guys are familiar with the

319
00:13:27,060 --> 00:13:29,579
service mcash d uh the attackers were

320
00:13:29,579 --> 00:13:31,500
basically leveraging

321
00:13:31,500 --> 00:13:34,740
um these these uh responders to uh

322
00:13:34,740 --> 00:13:36,720
basically trick all of them into sending

323
00:13:36,720 --> 00:13:39,300
requests back to the Target domain which

324
00:13:39,300 --> 00:13:43,620
was GitHub so uh if you've ever

325
00:13:43,620 --> 00:13:45,600
um if you've ever dealt with DDOS you're

326
00:13:45,600 --> 00:13:46,980
probably like

327
00:13:46,980 --> 00:13:48,899
you know hey well you know once we start

328
00:13:48,899 --> 00:13:51,000
seeing it then we can kind of work the

329
00:13:51,000 --> 00:13:54,000
work the magic right this came in within

330
00:13:54,000 --> 00:13:57,540
a few like within 60 seconds it was at

331
00:13:57,540 --> 00:14:00,120
full capacity so if you're at home and

332
00:14:00,120 --> 00:14:01,560
you're remoting in and you're trying to

333
00:14:01,560 --> 00:14:03,360
like configure a

334
00:14:03,360 --> 00:14:04,860
um a device

335
00:14:04,860 --> 00:14:06,839
you wouldn't be able to connect so

336
00:14:06,839 --> 00:14:09,240
that's that's a big problem

337
00:14:09,240 --> 00:14:11,220
all right example three we're going to

338
00:14:11,220 --> 00:14:13,320
call this human Ingenuity technique look

339
00:14:13,320 --> 00:14:15,899
at this little dumb cat how cute

340
00:14:15,899 --> 00:14:17,100
um I'm not even sure how that happened

341
00:14:17,100 --> 00:14:19,320
but actually the truth is I don't even

342
00:14:19,320 --> 00:14:21,899
like cats at all like I'm allergic to

343
00:14:21,899 --> 00:14:23,760
cats I think there might be a cat here

344
00:14:23,760 --> 00:14:26,459
because my nose is stuffed up but this

345
00:14:26,459 --> 00:14:28,800
is uh probably the most adorable picture

346
00:14:28,800 --> 00:14:30,899
of a cat I've ever seen so I had to put

347
00:14:30,899 --> 00:14:33,420
in here all right let's talk about Bots

348
00:14:33,420 --> 00:14:36,779
has anyone ever used a bot

349
00:14:36,779 --> 00:14:39,899
okay protecting yourselves from guilty

350
00:14:39,899 --> 00:14:42,180
conscience there uh has anyone ever

351
00:14:42,180 --> 00:14:43,800
wanted to buy a pair of shoes or

352
00:14:43,800 --> 00:14:45,180
something and then found out that it's

353
00:14:45,180 --> 00:14:49,139
sold out in like 0.5 seconds

354
00:14:49,139 --> 00:14:51,959
okay all right so every time I try to

355
00:14:51,959 --> 00:14:52,920
buy

356
00:14:52,920 --> 00:14:54,779
a pair of shoes or anything that's

357
00:14:54,779 --> 00:14:59,339
limited uh PS5 which my wife's like why

358
00:14:59,339 --> 00:15:00,839
do you why would you possibly need

359
00:15:00,839 --> 00:15:02,940
another gaming system that's not the

360
00:15:02,940 --> 00:15:05,339
point I say this to my wife very gently

361
00:15:05,339 --> 00:15:08,880
of course but Bots are used to make

362
00:15:08,880 --> 00:15:11,639
purchases into automated manner uh and

363
00:15:11,639 --> 00:15:13,199
there's a new breed of Bot which is

364
00:15:13,199 --> 00:15:15,899
called a human controlled bot so instead

365
00:15:15,899 --> 00:15:17,579
of you know scripting everything and

366
00:15:17,579 --> 00:15:19,199
kind of sending it off into the wind to

367
00:15:19,199 --> 00:15:20,699
do its bidding

368
00:15:20,699 --> 00:15:24,779
um in this particular case aiobots have

369
00:15:24,779 --> 00:15:27,300
users controlling the back end so let's

370
00:15:27,300 --> 00:15:29,639
look at a couple examples this is called

371
00:15:29,639 --> 00:15:32,639
cyber Soul this is a bot it retails for

372
00:15:32,639 --> 00:15:34,680
you know 300 bucks

373
00:15:34,680 --> 00:15:37,139
um they sell limited licenses because

374
00:15:37,139 --> 00:15:39,120
they're trying to uh you know kind of

375
00:15:39,120 --> 00:15:40,980
protect their uh their infrastructure

376
00:15:40,980 --> 00:15:43,560
and their usage but on the aftermarket

377
00:15:43,560 --> 00:15:45,720
it sells for like two to five thousand

378
00:15:45,720 --> 00:15:47,399
dollars

379
00:15:47,399 --> 00:15:49,320
um and it's typically targeting

380
00:15:49,320 --> 00:15:51,839
shoes games apparel if you've ever tried

381
00:15:51,839 --> 00:15:53,699
to buy a new game release that comes out

382
00:15:53,699 --> 00:15:55,800
this is where the attackers are are

383
00:15:55,800 --> 00:15:57,060
headed

384
00:15:57,060 --> 00:15:59,220
on the back end they have a ton of

385
00:15:59,220 --> 00:16:00,959
services you can call up for tech

386
00:16:00,959 --> 00:16:03,540
support uh in their config docs they say

387
00:16:03,540 --> 00:16:06,839
oh hey here's the um the mobile API to

388
00:16:06,839 --> 00:16:08,760
hit because it's much less protected

389
00:16:08,760 --> 00:16:11,880
than the than the store front end so hit

390
00:16:11,880 --> 00:16:15,180
this one keep your requests uh under

391
00:16:15,180 --> 00:16:18,240
these rate controls they're very uh you

392
00:16:18,240 --> 00:16:19,920
know this website is very strict about

393
00:16:19,920 --> 00:16:21,600
rate controls for this part of the site

394
00:16:21,600 --> 00:16:24,360
they share all this information which is

395
00:16:24,360 --> 00:16:25,560
awesome and the hacking Community

396
00:16:25,560 --> 00:16:29,339
sharing is like caring but when you're

397
00:16:29,339 --> 00:16:31,440
attacking a business it's uh becomes a

398
00:16:31,440 --> 00:16:33,180
little bit bigger of a problem

399
00:16:33,180 --> 00:16:37,019
so a couple of the iocs uh that you can

400
00:16:37,019 --> 00:16:38,940
tell if this is running now typically

401
00:16:38,940 --> 00:16:40,139
this wouldn't be running in your

402
00:16:40,139 --> 00:16:41,459
environment but I just pulled this up

403
00:16:41,459 --> 00:16:43,740
anyway it's making call outs to this

404
00:16:43,740 --> 00:16:46,199
redgate.com which is not like an attack

405
00:16:46,199 --> 00:16:47,699
website

406
00:16:47,699 --> 00:16:50,160
um and you see it uploads a report login

407
00:16:50,160 --> 00:16:52,620
information and Reporting information uh

408
00:16:52,620 --> 00:16:55,500
and that's hosted on Amazon so for this

409
00:16:55,500 --> 00:16:57,360
software to work it has to communicate

410
00:16:57,360 --> 00:17:01,079
to Amazon so maybe Amazon could do some

411
00:17:01,079 --> 00:17:03,120
protection here and say hey if there's

412
00:17:03,120 --> 00:17:05,240
services that are being used illegally

413
00:17:05,240 --> 00:17:07,500
to my knowledge in the United States

414
00:17:07,500 --> 00:17:10,799
only the state of California has it

415
00:17:10,799 --> 00:17:12,839
illegal to use automated Bots to buy

416
00:17:12,839 --> 00:17:15,419
Goods uh everywhere else it's just

417
00:17:15,419 --> 00:17:16,740
considered like

418
00:17:16,740 --> 00:17:18,959
I'm smarter than you you know

419
00:17:18,959 --> 00:17:21,240
uh so this is Redgate

420
00:17:21,240 --> 00:17:25,020
um another bot is called uh Dashi Dashi

421
00:17:25,020 --> 00:17:27,059
specifically made for any website that's

422
00:17:27,059 --> 00:17:28,799
on the Shopify platform you guys know

423
00:17:28,799 --> 00:17:32,580
Shopify Shopify platform very popular

424
00:17:32,580 --> 00:17:35,700
um Dashi also very popular uh and we'll

425
00:17:35,700 --> 00:17:37,700
go into one particular

426
00:17:37,700 --> 00:17:40,740
service I thought was cool it's this

427
00:17:40,740 --> 00:17:44,640
quick captcha solver and uh dashie's got

428
00:17:44,640 --> 00:17:46,500
you know forty five thousand followers

429
00:17:46,500 --> 00:17:48,780
and when you're inside of the Dashie

430
00:17:48,780 --> 00:17:50,520
configuration

431
00:17:50,520 --> 00:17:52,559
um there's a there's a drop down for

432
00:17:52,559 --> 00:17:55,679
what store you want to attack so these

433
00:17:55,679 --> 00:17:57,299
options are pre-configured they're part

434
00:17:57,299 --> 00:17:59,360
of all the supported stores that that

435
00:17:59,360 --> 00:18:03,059
Shopify has listed but you can select

436
00:18:03,059 --> 00:18:05,280
check out proxies so you can make sure

437
00:18:05,280 --> 00:18:07,559
you're proxing your traffic through home

438
00:18:07,559 --> 00:18:10,500
IP addresses right because if I'm buying

439
00:18:10,500 --> 00:18:13,620
product from Amazon as a Defender it's

440
00:18:13,620 --> 00:18:15,299
very easy to say yeah this is probably

441
00:18:15,299 --> 00:18:18,000
not good user traffic if it's coming

442
00:18:18,000 --> 00:18:21,299
from a cloud hosting provider so all the

443
00:18:21,299 --> 00:18:23,039
traffic is proxied through through home

444
00:18:23,039 --> 00:18:25,220
IP addresses

445
00:18:25,220 --> 00:18:27,179
different username and password

446
00:18:27,179 --> 00:18:29,340
configurations so this is when you talk

447
00:18:29,340 --> 00:18:30,720
about account takeover and the whole

448
00:18:30,720 --> 00:18:33,900
process of of basically identifying is

449
00:18:33,900 --> 00:18:35,700
the username and password that Tony used

450
00:18:35,700 --> 00:18:37,740
on LinkedIn when they had their big data

451
00:18:37,740 --> 00:18:40,320
breach does that work on some of these

452
00:18:40,320 --> 00:18:42,780
Shopify sites this is after that this is

453
00:18:42,780 --> 00:18:43,919
after they've already validated

454
00:18:43,919 --> 00:18:46,559
credentials they're going to use them or

455
00:18:46,559 --> 00:18:48,480
in many cases they're just creating new

456
00:18:48,480 --> 00:18:50,820
accounts so new account creation and all

457
00:18:50,820 --> 00:18:52,980
the techniques to prevent that

458
00:18:52,980 --> 00:18:55,080
um being you know being done by Bots is

459
00:18:55,080 --> 00:18:58,020
also very important but this this

460
00:18:58,020 --> 00:18:59,880
process makes it so much easier for the

461
00:18:59,880 --> 00:19:01,380
attacker and the last piece is the

462
00:19:01,380 --> 00:19:03,600
monitoring piece this allows you to

463
00:19:03,600 --> 00:19:05,580
monitor the responses so if you guys

464
00:19:05,580 --> 00:19:07,980
have ever used burp suite and you're

465
00:19:07,980 --> 00:19:09,840
using the scanner to interact with the

466
00:19:09,840 --> 00:19:12,299
site you're basically monitoring for you

467
00:19:12,299 --> 00:19:14,100
know you're getting all these

468
00:19:14,100 --> 00:19:16,020
um you know 404s you're getting all

469
00:19:16,020 --> 00:19:18,000
these uh different response codes once

470
00:19:18,000 --> 00:19:20,640
you get a 200 response okay with the

471
00:19:20,640 --> 00:19:23,820
word that says successful login now you

472
00:19:23,820 --> 00:19:27,480
know whatever you did worked right again

473
00:19:27,480 --> 00:19:30,419
not as sexy as actually knowing exactly

474
00:19:30,419 --> 00:19:33,900
how it worked but still very cool

475
00:19:33,900 --> 00:19:36,179
so this is what the interface looks like

476
00:19:36,179 --> 00:19:38,340
you have all these different profiles

477
00:19:38,340 --> 00:19:40,440
there's also different payment profiles

478
00:19:40,440 --> 00:19:42,299
so if one of your payment cards fails

479
00:19:42,299 --> 00:19:45,660
you can inject the other one and here's

480
00:19:45,660 --> 00:19:47,100
the cool thing so it has this little

481
00:19:47,100 --> 00:19:48,780
capture window in the bottom you bring

482
00:19:48,780 --> 00:19:50,940
it up and it says open YouTube

483
00:19:50,940 --> 00:19:53,220
so you open up YouTube you have to log

484
00:19:53,220 --> 00:19:55,880
in first right so you log in with Google

485
00:19:55,880 --> 00:19:58,320
and then there's a little check box that

486
00:19:58,320 --> 00:20:00,780
says I'm not a robot but then you get

487
00:20:00,780 --> 00:20:03,780
this this caption to solve right and you

488
00:20:03,780 --> 00:20:05,700
have these four boxes here this is where

489
00:20:05,700 --> 00:20:09,120
the sign is right so you select those

490
00:20:09,120 --> 00:20:10,980
and you're like

491
00:20:10,980 --> 00:20:13,500
wait a minute there's there's a little

492
00:20:13,500 --> 00:20:15,360
bit of a sign there do I click that or

493
00:20:15,360 --> 00:20:17,280
not right and this is the moment where

494
00:20:17,280 --> 00:20:19,799
you're like how good is this captcha uh

495
00:20:19,799 --> 00:20:21,780
so anyway you click through and now you

496
00:20:21,780 --> 00:20:23,460
get logged in once you're logged into

497
00:20:23,460 --> 00:20:25,020
YouTube and you start watching videos

498
00:20:25,020 --> 00:20:27,600
you get or what's called a user

499
00:20:27,600 --> 00:20:30,780
liveliness tokens and it basically tells

500
00:20:30,780 --> 00:20:32,820
the Google capture service that you're a

501
00:20:32,820 --> 00:20:36,000
real user with life right like you're

502
00:20:36,000 --> 00:20:38,940
actually engaging with the platform so

503
00:20:38,940 --> 00:20:42,299
uh I've seen this uh done screen

504
00:20:42,299 --> 00:20:44,280
captures of uh don't ask me how to do

505
00:20:44,280 --> 00:20:46,140
this screen captures of attackers using

506
00:20:46,140 --> 00:20:48,660
these Bots and they've got all these

507
00:20:48,660 --> 00:20:50,700
pop-ups all these capture responses from

508
00:20:50,700 --> 00:20:52,380
their sessions

509
00:20:52,380 --> 00:20:54,120
um they just click I'm not a robot I'm

510
00:20:54,120 --> 00:20:56,160
not a robot instead of having to solve a

511
00:20:56,160 --> 00:20:58,020
captcha so if you wonder oh well we'll

512
00:20:58,020 --> 00:20:59,640
just turn on captcha and block the

513
00:20:59,640 --> 00:21:01,620
attack it doesn't necessarily work that

514
00:21:01,620 --> 00:21:03,120
way

515
00:21:03,120 --> 00:21:05,580
uh there's also a lot of uh you know

516
00:21:05,580 --> 00:21:07,500
infighting in these groups you know I've

517
00:21:07,500 --> 00:21:10,200
hey I'm uh creating this cool tool I'm

518
00:21:10,200 --> 00:21:12,179
selling it but you pay me and that I

519
00:21:12,179 --> 00:21:14,039
never pay you back or I never give you

520
00:21:14,039 --> 00:21:16,020
the product that's that's a big problem

521
00:21:16,020 --> 00:21:18,360
as well so sometimes it's fun to see the

522
00:21:18,360 --> 00:21:20,640
scammers get scammed themselves

523
00:21:20,640 --> 00:21:22,620
uh example four do you guys remember

524
00:21:22,620 --> 00:21:24,360
this meme

525
00:21:24,360 --> 00:21:26,220
where the cat's walking that it jumps

526
00:21:26,220 --> 00:21:28,080
and like to its death it's kind of sad

527
00:21:28,080 --> 00:21:30,179
but also funny

528
00:21:30,179 --> 00:21:31,559
um this is called shot in the dark

529
00:21:31,559 --> 00:21:33,120
technique so this was an interesting

530
00:21:33,120 --> 00:21:36,840
case where uh an attacker tried to fish

531
00:21:36,840 --> 00:21:39,360
one of our security researchers and the

532
00:21:39,360 --> 00:21:41,460
security researcher's name is Larry uh

533
00:21:41,460 --> 00:21:43,679
Larry O on Twitter his real name is

534
00:21:43,679 --> 00:21:46,140
Larry cash dollar which is such an

535
00:21:46,140 --> 00:21:47,580
awesome name

536
00:21:47,580 --> 00:21:50,100
but he gets his email and then he's like

537
00:21:50,100 --> 00:21:51,900
okay something looks fishy right can you

538
00:21:51,900 --> 00:21:54,720
spot it well the email address is from

539
00:21:54,720 --> 00:21:58,200
Facebook underscore secure hotmail.com

540
00:21:58,200 --> 00:21:59,880
like this guy was really confused

541
00:21:59,880 --> 00:22:01,620
whoever sent this

542
00:22:01,620 --> 00:22:03,419
um but you know if if you were to get

543
00:22:03,419 --> 00:22:04,980
this email

544
00:22:04,980 --> 00:22:07,860
um you you would probably most

545
00:22:07,860 --> 00:22:09,120
definitely see if you're on a desktop

546
00:22:09,120 --> 00:22:10,559
browser you would see that and be like

547
00:22:10,559 --> 00:22:14,700
this is BS right but uh there's a couple

548
00:22:14,700 --> 00:22:16,140
of social engineering techniques that

549
00:22:16,140 --> 00:22:18,059
are in play here even before talking to

550
00:22:18,059 --> 00:22:22,080
anyone uh pre-texting and pre-texting is

551
00:22:22,080 --> 00:22:24,960
this looks legitimate it looks like it's

552
00:22:24,960 --> 00:22:26,580
coming from Google there's some kind of

553
00:22:26,580 --> 00:22:30,000
trust Factor here and then baiting uh

554
00:22:30,000 --> 00:22:31,440
baiting is hey there's something wrong

555
00:22:31,440 --> 00:22:33,960
with your account or hey quick the uh

556
00:22:33,960 --> 00:22:36,360
you know the deal expires at midnight

557
00:22:36,360 --> 00:22:38,039
whatever is going to get you to click on

558
00:22:38,039 --> 00:22:41,100
it so if you happen to click on that and

559
00:22:41,100 --> 00:22:44,340
this is my kitchen table at home uh it

560
00:22:44,340 --> 00:22:46,860
may not look so strange to click through

561
00:22:46,860 --> 00:22:48,720
and then see this on your mobile browser

562
00:22:48,720 --> 00:22:51,000
right and maybe you see a little bit of

563
00:22:51,000 --> 00:22:53,100
weird stuff up here but you know if you

564
00:22:53,100 --> 00:22:56,220
scroll up it looks just like a Gmail

565
00:22:56,220 --> 00:22:57,840
login

566
00:22:57,840 --> 00:23:00,059
so this is what happens

567
00:23:00,059 --> 00:23:03,480
um we had uh the uh Larry get this

568
00:23:03,480 --> 00:23:05,760
phishing email he clicked through and he

569
00:23:05,760 --> 00:23:08,880
noticed something interesting uh that it

570
00:23:08,880 --> 00:23:11,340
was actually even though there was the

571
00:23:11,340 --> 00:23:15,320
the green lock and it said google.com

572
00:23:16,320 --> 00:23:18,840
um sorry that was loud uh he noticed

573
00:23:18,840 --> 00:23:19,740
that it was going through Google

574
00:23:19,740 --> 00:23:22,200
translate so what the attacker was doing

575
00:23:22,200 --> 00:23:25,679
was taking his fake fishing page putting

576
00:23:25,679 --> 00:23:28,500
it through Google translate so that when

577
00:23:28,500 --> 00:23:29,880
you look from a certificate Services

578
00:23:29,880 --> 00:23:31,980
perspective on the front end you're

579
00:23:31,980 --> 00:23:33,720
communicating with Google you really are

580
00:23:33,720 --> 00:23:35,760
but the whole back-end phishing page

581
00:23:35,760 --> 00:23:38,880
exists at a different URL this media

582
00:23:38,880 --> 00:23:41,100
city.co

583
00:23:41,100 --> 00:23:44,280
I thought this was a a really

584
00:23:44,280 --> 00:23:47,039
interesting attack Vector uh mainly

585
00:23:47,039 --> 00:23:48,659
because

586
00:23:48,659 --> 00:23:51,299
um there's so many bad phishing pages in

587
00:23:51,299 --> 00:23:53,039
fact after you click through and log

588
00:23:53,039 --> 00:23:56,159
into Gmail here it pulls up this really

589
00:23:56,159 --> 00:23:58,880
crappy login to Facebook

590
00:23:58,880 --> 00:24:01,980
login page which does not look as cool

591
00:24:01,980 --> 00:24:04,620
or sexy so if you were to enter your

592
00:24:04,620 --> 00:24:07,080
information into both of these

593
00:24:07,080 --> 00:24:08,700
um this is what would happen so this is

594
00:24:08,700 --> 00:24:10,020
the script that's allowing this to

595
00:24:10,020 --> 00:24:12,120
happen the scammer's email address where

596
00:24:12,120 --> 00:24:14,580
all this gets sent to is up here

597
00:24:14,580 --> 00:24:16,740
um here's uh what's happening the

598
00:24:16,740 --> 00:24:21,000
scammer's name and tag and then the the

599
00:24:21,000 --> 00:24:24,539
credentials that get forwarded end up if

600
00:24:24,539 --> 00:24:26,940
if you just do a mail catcher end up

601
00:24:26,940 --> 00:24:28,740
looking like this you have email address

602
00:24:28,740 --> 00:24:31,799
password phone number if that's uh in a

603
00:24:31,799 --> 00:24:34,020
form field and that alternate email if

604
00:24:34,020 --> 00:24:35,220
that's also there

605
00:24:35,220 --> 00:24:37,020
also I thought it was interesting you

606
00:24:37,020 --> 00:24:40,500
get the user agent of the actual device

607
00:24:40,500 --> 00:24:42,600
that user was connecting from so if

608
00:24:42,600 --> 00:24:44,039
you're going to go forward and do man in

609
00:24:44,039 --> 00:24:45,840
the middle or do any kind of uh attack

610
00:24:45,840 --> 00:24:47,840
Vector you can look just like that user

611
00:24:47,840 --> 00:24:50,039
uh you can try to get as close as

612
00:24:50,039 --> 00:24:51,240
possible

613
00:24:51,240 --> 00:24:52,740
so I thought that was really interesting

614
00:24:52,740 --> 00:24:56,159
uh and I I um I wanted to break it down

615
00:24:56,159 --> 00:24:57,900
even further because after you click

616
00:24:57,900 --> 00:24:59,940
through this you see this Google user

617
00:24:59,940 --> 00:25:01,919
content and this is kind of that trusted

618
00:25:01,919 --> 00:25:03,740
site problem that we talked about before

619
00:25:03,740 --> 00:25:07,620
because Google user content is owned by

620
00:25:07,620 --> 00:25:09,600
Google there may be a trust relationship

621
00:25:09,600 --> 00:25:12,240
with Google but user content means users

622
00:25:12,240 --> 00:25:14,520
have submitted this data

623
00:25:14,520 --> 00:25:16,760
so I went to Google user con or

624
00:25:16,760 --> 00:25:19,919
translate.google user content because

625
00:25:19,919 --> 00:25:21,960
it's different from translate.google.com

626
00:25:21,960 --> 00:25:24,720
which other tools might use and I said

627
00:25:24,720 --> 00:25:26,220
let me let me look at some of the top

628
00:25:26,220 --> 00:25:27,779
hits here

629
00:25:27,779 --> 00:25:31,320
um so we had uh this file hash this was

630
00:25:31,320 --> 00:25:33,900
uploaded to um Alien Vault and I was

631
00:25:33,900 --> 00:25:36,059
like let me for Giggles let me just dig

632
00:25:36,059 --> 00:25:38,760
into this so I dug in it turns out it's

633
00:25:38,760 --> 00:25:42,419
this um this translation tool

634
00:25:42,419 --> 00:25:45,960
uh looks legit if you install this what

635
00:25:45,960 --> 00:25:49,559
is this translation tool going to do so

636
00:25:49,559 --> 00:25:51,539
I wrote down exactly what's happening

637
00:25:51,539 --> 00:25:54,360
and it looks like okay medium risk but

638
00:25:54,360 --> 00:25:56,640
icmp okay maybe it's doing a liveliness

639
00:25:56,640 --> 00:26:01,320
check uh uh you know uh anti-vm generic

640
00:26:01,320 --> 00:26:03,900
bios that's interesting why would why

641
00:26:03,900 --> 00:26:06,240
would this tool have to look for uh

642
00:26:06,240 --> 00:26:09,720
anti-vm or VMware instructions

643
00:26:09,720 --> 00:26:12,659
um Network HTTP dumped buffer there's a

644
00:26:12,659 --> 00:26:13,980
lot of things that this tool is doing

645
00:26:13,980 --> 00:26:16,080
that probably doesn't need to do I'm not

646
00:26:16,080 --> 00:26:17,820
saying this is bad whoever wrote this if

647
00:26:17,820 --> 00:26:19,080
you're in the audience I don't want to

648
00:26:19,080 --> 00:26:20,580
call you out

649
00:26:20,580 --> 00:26:23,580
um but but those um but those items are

650
00:26:23,580 --> 00:26:26,520
definitely listed as uh High severity in

651
00:26:26,520 --> 00:26:28,679
terms of the risk they might represent

652
00:26:28,679 --> 00:26:30,900
if this tool that you allowed to

653
00:26:30,900 --> 00:26:33,000
actually be installed is able to carry

654
00:26:33,000 --> 00:26:34,799
out its bidding

655
00:26:34,799 --> 00:26:37,080
all right final battle technique here's

656
00:26:37,080 --> 00:26:39,539
the part where uh you know Neo has to

657
00:26:39,539 --> 00:26:41,760
stop the bullets with Justice mind which

658
00:26:41,760 --> 00:26:44,640
is so cool did anybody like almost faint

659
00:26:44,640 --> 00:26:46,080
watching The Matrix for the first time

660
00:26:46,080 --> 00:26:48,860
just like crying so like cyber awesome

661
00:26:48,860 --> 00:26:51,779
uh I did and seeing this actually is

662
00:26:51,779 --> 00:26:53,340
scaring me a bit

663
00:26:53,340 --> 00:26:56,100
um PHP obfuscation this is something

664
00:26:56,100 --> 00:26:58,919
this is not new there's a lot of uh you

665
00:26:58,919 --> 00:27:01,500
know free online encoding tools but the

666
00:27:01,500 --> 00:27:04,860
idea here is again I don't want to

667
00:27:04,860 --> 00:27:06,360
trigger WAFF rules I don't want to

668
00:27:06,360 --> 00:27:08,880
trigger you know application

669
00:27:08,880 --> 00:27:11,039
um you know regex or anything that might

670
00:27:11,039 --> 00:27:14,279
might look like an attack but if I can

671
00:27:14,279 --> 00:27:16,980
use multiple levels of encoding or doing

672
00:27:16,980 --> 00:27:19,620
the right encoding in areas where maybe

673
00:27:19,620 --> 00:27:21,140
your wife is not breaking that down

674
00:27:21,140 --> 00:27:24,419
maybe I can get an attack through so we

675
00:27:24,419 --> 00:27:26,039
see this quite a bit here's an example

676
00:27:26,039 --> 00:27:29,340
of an RFI payload uh being obscured all

677
00:27:29,340 --> 00:27:30,840
this here

678
00:27:30,840 --> 00:27:34,279
um and the payload is using custom PHP

679
00:27:34,279 --> 00:27:36,659
functions to carry out a very specific

680
00:27:36,659 --> 00:27:40,080
task and I thought this was uh quite

681
00:27:40,080 --> 00:27:43,159
interesting this is what it looks like

682
00:27:43,159 --> 00:27:46,200
if you break down and see exactly what's

683
00:27:46,200 --> 00:27:48,779
happening you'll see this so you see

684
00:27:48,779 --> 00:27:51,960
this function is bought bot agents and

685
00:27:51,960 --> 00:27:53,520
then you have these different agent

686
00:27:53,520 --> 00:27:54,419
names

687
00:27:54,419 --> 00:27:56,360
a lot of them

688
00:27:56,360 --> 00:27:59,400
and then basically what you're looking

689
00:27:59,400 --> 00:28:02,820
at here is what happens when a user

690
00:28:02,820 --> 00:28:04,980
agent that hits this page that I'm

691
00:28:04,980 --> 00:28:07,260
injecting this code into what happens

692
00:28:07,260 --> 00:28:10,740
when one of those user agents hits this

693
00:28:10,740 --> 00:28:13,740
page in this particular case the

694
00:28:13,740 --> 00:28:16,200
attacker not saying it was a competitor

695
00:28:16,200 --> 00:28:18,659
of this company but

696
00:28:18,659 --> 00:28:20,100
uh

697
00:28:20,100 --> 00:28:23,820
when big corporations spend money all

698
00:28:23,820 --> 00:28:25,679
the eyeballs come to those pages right

699
00:28:25,679 --> 00:28:27,720
if you're watching the FIFA World Cup

700
00:28:27,720 --> 00:28:31,380
and there's a a commercial for Ford a

701
00:28:31,380 --> 00:28:33,179
new Ford car everybody goes to the Ford

702
00:28:33,179 --> 00:28:35,039
website right

703
00:28:35,039 --> 00:28:37,860
attackers use those moments uh and

704
00:28:37,860 --> 00:28:40,559
vulnerabilities in these websites to um

705
00:28:40,559 --> 00:28:43,260
to basically take advantage of these

706
00:28:43,260 --> 00:28:45,360
these large numbers in this particular

707
00:28:45,360 --> 00:28:47,220
case I'm going to drink a little bit of

708
00:28:47,220 --> 00:28:49,380
water in just a moment here in this

709
00:28:49,380 --> 00:28:51,179
particular case

710
00:28:51,179 --> 00:28:52,020
um

711
00:28:52,020 --> 00:28:55,159
the the RFI payload after injected into

712
00:28:55,159 --> 00:28:59,779
index.php it modifies the Joomla code

713
00:28:59,779 --> 00:29:03,419
to inject this this code and basically

714
00:29:03,419 --> 00:29:07,700
anytime that a uh a bot

715
00:29:07,700 --> 00:29:11,100
comes to the page it redirects it to

716
00:29:11,100 --> 00:29:13,679
this page here and if you actually look

717
00:29:13,679 --> 00:29:15,539
in what this actually is doing this is

718
00:29:15,539 --> 00:29:18,899
like an adult content website so here

719
00:29:18,899 --> 00:29:21,120
you have a very popular new site for

720
00:29:21,120 --> 00:29:23,820
instance and every time a bot hits that

721
00:29:23,820 --> 00:29:26,159
new site it pulls up this adult content

722
00:29:26,159 --> 00:29:29,100
website uh that's probably embarrassing

723
00:29:29,100 --> 00:29:32,159
one if you like search for uh you know

724
00:29:32,159 --> 00:29:35,100
New York Times and a porn website comes

725
00:29:35,100 --> 00:29:36,960
up and the search results probably not a

726
00:29:36,960 --> 00:29:38,520
good look

727
00:29:38,520 --> 00:29:41,340
but what's interesting here is this

728
00:29:41,340 --> 00:29:45,720
dramatically lowers your SEO results so

729
00:29:45,720 --> 00:29:47,520
if I'm a competitor

730
00:29:47,520 --> 00:29:49,380
it doesn't matter where I send you if

731
00:29:49,380 --> 00:29:51,659
I'm giving you content that you're not

732
00:29:51,659 --> 00:29:53,820
expecting as a bot from my site I could

733
00:29:53,820 --> 00:29:56,460
destroy your online presence uh so this

734
00:29:56,460 --> 00:29:58,940
attack has been used for SEO poisoning

735
00:29:58,940 --> 00:30:01,500
we've seen it in a couple other

736
00:30:01,500 --> 00:30:03,480
different ways as well

737
00:30:03,480 --> 00:30:05,520
not this particular attack but the idea

738
00:30:05,520 --> 00:30:08,100
of obfuscating code so if I'm an

739
00:30:08,100 --> 00:30:10,080
attacker and I know that you're using

740
00:30:10,080 --> 00:30:12,840
third or fourth party plugins what I

741
00:30:12,840 --> 00:30:14,580
want to do is you might have great

742
00:30:14,580 --> 00:30:16,620
security but those third and fourth

743
00:30:16,620 --> 00:30:18,659
party plugins and the JavaScript that

744
00:30:18,659 --> 00:30:21,059
they represent loads is part of your

745
00:30:21,059 --> 00:30:23,760
trusted page load right so in the case

746
00:30:23,760 --> 00:30:26,120
of magecard if you guys remember

747
00:30:26,120 --> 00:30:30,059
magecart it it uh it was a a group of

748
00:30:30,059 --> 00:30:32,279
about five or six loose Collective

749
00:30:32,279 --> 00:30:34,799
groups that were all attacking major

750
00:30:34,799 --> 00:30:39,440
banks in the United States and in Canada

751
00:30:39,840 --> 00:30:43,200
and um they they basically would

752
00:30:43,200 --> 00:30:46,620
uh take the this JavaScript that's being

753
00:30:46,620 --> 00:30:49,320
loaded from a third or fourth party

754
00:30:49,320 --> 00:30:52,380
um and manipulate it and now that that's

755
00:30:52,380 --> 00:30:54,240
being loaded you as a client of this

756
00:30:54,240 --> 00:30:57,360
Bank your browser is now interacting

757
00:30:57,360 --> 00:30:59,640
with this web page that everything that

758
00:30:59,640 --> 00:31:00,720
loads you know if you look at a

759
00:31:00,720 --> 00:31:02,340
waterfall everything that loads it's

760
00:31:02,340 --> 00:31:04,500
trusting that content like that's the

761
00:31:04,500 --> 00:31:05,820
relationship right you've got your

762
00:31:05,820 --> 00:31:08,039
little lock it's the right website not a

763
00:31:08,039 --> 00:31:11,279
phishing site not a scam site but as

764
00:31:11,279 --> 00:31:12,960
this content loads

765
00:31:12,960 --> 00:31:16,279
it's actually manipulating your browser

766
00:31:16,279 --> 00:31:19,559
uh view of the website so for instance

767
00:31:19,559 --> 00:31:21,960
uh you could do page skimming so as

768
00:31:21,960 --> 00:31:24,179
someone's typing in a username and

769
00:31:24,179 --> 00:31:26,820
password or credit card information that

770
00:31:26,820 --> 00:31:29,520
JavaScript is extracting that from your

771
00:31:29,520 --> 00:31:31,620
browser session and sending it off to

772
00:31:31,620 --> 00:31:32,899
someone else

773
00:31:32,899 --> 00:31:36,779
this is this is how magecard function

774
00:31:36,779 --> 00:31:37,620
um

775
00:31:37,620 --> 00:31:39,720
you know and I ask myself listen this

776
00:31:39,720 --> 00:31:42,380
same vulnerability exists uh still today

777
00:31:42,380 --> 00:31:45,000
where you have third and fourth party

778
00:31:45,000 --> 00:31:46,740
code if you're look to look at a spider

779
00:31:46,740 --> 00:31:49,640
chart of what your website calls out to

780
00:31:49,640 --> 00:31:52,260
it's it's insane there's so many

781
00:31:52,260 --> 00:31:54,360
different resources on the internet uh

782
00:31:54,360 --> 00:31:55,260
some of those you have direct

783
00:31:55,260 --> 00:31:57,539
relationships to but many of those are

784
00:31:57,539 --> 00:31:59,039
like connected via all these different

785
00:31:59,039 --> 00:32:02,399
spider fingers so why not inject

786
00:32:02,399 --> 00:32:05,159
um more malicious code like ransomware

787
00:32:05,159 --> 00:32:07,380
we already saw an attack at the

788
00:32:07,380 --> 00:32:10,320
beginning of uh last year uh where an

789
00:32:10,320 --> 00:32:12,539
actual ransomware droplet was installed

790
00:32:12,539 --> 00:32:16,559
via the same Mage card technique

791
00:32:16,559 --> 00:32:18,539
this this is something that's still

792
00:32:18,539 --> 00:32:21,299
emerging uh

793
00:32:21,299 --> 00:32:23,399
out of interest I'm thinking to myself

794
00:32:23,399 --> 00:32:25,440
well there's

795
00:32:25,440 --> 00:32:29,700
um a certain uh malware that does uh

796
00:32:29,700 --> 00:32:31,020
they've got several different modules

797
00:32:31,020 --> 00:32:34,380
one of them is called ghost DNS where uh

798
00:32:34,380 --> 00:32:37,020
if this malware executes it scans your

799
00:32:37,020 --> 00:32:39,659
internal Network it looks for your home

800
00:32:39,659 --> 00:32:40,740
router

801
00:32:40,740 --> 00:32:43,500
it tries to execute default credentials

802
00:32:43,500 --> 00:32:45,000
that it has for a bunch of these common

803
00:32:45,000 --> 00:32:48,240
home routers and then it changes your

804
00:32:48,240 --> 00:32:51,179
recursive DNS settings

805
00:32:51,179 --> 00:32:53,399
so every request now that goes through

806
00:32:53,399 --> 00:32:54,960
the internet is going through a

807
00:32:54,960 --> 00:32:56,700
recursive resolver that the attacker

808
00:32:56,700 --> 00:32:58,980
owns and they can manipulate so if you

809
00:32:58,980 --> 00:33:01,200
go to Facebook boom you get a perfectly

810
00:33:01,200 --> 00:33:03,960
positioned uh phishing copy of Facebook

811
00:33:03,960 --> 00:33:06,840
if you go to your bank it gives you that

812
00:33:06,840 --> 00:33:08,039
right

813
00:33:08,039 --> 00:33:09,960
um I think that's where this is going I

814
00:33:09,960 --> 00:33:11,399
don't totally know for sure but again

815
00:33:11,399 --> 00:33:13,080
these are things that are kind of

816
00:33:13,080 --> 00:33:14,580
evolving

817
00:33:14,580 --> 00:33:17,039
um so that's a little bit about uh about

818
00:33:17,039 --> 00:33:19,200
what we've seen there's a lot of really

819
00:33:19,200 --> 00:33:21,799
cool stuff I have some resources here

820
00:33:21,799 --> 00:33:24,960
our security research group uh some

821
00:33:24,960 --> 00:33:27,960
blogs about that and Akamai is always

822
00:33:27,960 --> 00:33:29,159
hiring

823
00:33:29,159 --> 00:33:31,679
um and uh that is it I hope you guys

824
00:33:31,679 --> 00:33:33,419
enjoyed this I hope it was entertaining

825
00:33:33,419 --> 00:33:38,000
and I will open it up for questions now

826
00:33:38,279 --> 00:33:41,279
foreign

827
00:33:50,000 --> 00:33:54,059
or pass to the middle to the ground

828
00:33:54,059 --> 00:33:56,340
and that's okay I mean I didn't really

829
00:33:56,340 --> 00:33:57,840
leave much room for questions because

830
00:33:57,840 --> 00:33:59,880
everything was kind of

831
00:33:59,880 --> 00:34:02,940
uh explained but have I been up on the

832
00:34:02,940 --> 00:34:04,500
screen like that this whole time

833
00:34:04,500 --> 00:34:07,500
that's scary no all right

834
00:34:07,500 --> 00:34:10,139
uh I will be around thank you guys for

835
00:34:10,139 --> 00:34:11,460
being here I really appreciate it talk

836
00:34:11,460 --> 00:34:12,370
to you later

837
00:34:12,370 --> 00:34:20,138
[Applause]

