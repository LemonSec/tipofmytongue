1
00:00:00,000 --> 00:00:02,760
listen we are going to start so hello

2
00:00:02,760 --> 00:00:04,009
to all

3
00:00:04,009 --> 00:00:06,960
thank you for your presence today

4
00:00:06,960 --> 00:00:09,840
so today with kevin we are going to

5
00:00:09,840 --> 00:00:11,190
tell you a little about our adventure at

6
00:00:11,190 --> 00:00:14,809
pwn2own that we did this winter in 2021

7
00:00:14,809 --> 00:00:18,000
in November or in fact  we

8
00:00:18,000 --> 00:00:20,480
tackled a netgear router

9
00:00:21,280 --> 00:00:22,840
and I find that in fact we thought of it

10
00:00:22,840 --> 00:00:24,310
from the one but in a

11
00:00:24,310 --> 00:00:25,780
somewhat man in the middle context so this

12
00:00:25,780 --> 00:00:27,010
presentation in fact will be oriented

13
00:00:27,010 --> 00:00:29,800
around this little adventure and we will

14
00:00:29,800 --> 00:00:31,690
explain to you a little about the concept of

15
00:00:31,690 --> 00:00:32,650
pauline touraine what is the

16
00:00:32,650 --> 00:00:35,170
print web competition and finally how to

17
00:00:35,170 --> 00:00:38,140
attack height what are the what

18
00:00:38,140 --> 00:00:40,090
is the attack surface how do

19
00:00:40,090 --> 00:00:42,000
we tackle this kind of thing

20
00:00:42,000 --> 00:00:45,220
so for  start we are research

21
00:00:45,220 --> 00:00:46,480
we are two active hassine researchers

22
00:00:46,480 --> 00:00:50,440
so mix or on my left and myself my

23
00:00:50,440 --> 00:00:52,750
work at the rivers pole active toxins I

24
00:00:52,750 --> 00:00:55,720
don't know if you know but did they

25
00:00:55,720 --> 00:00:57,790
leave an offensive security company

26
00:00:57,790 --> 00:00:59,110
and we are based almost everywhere  in France

27
00:00:59,110 --> 00:01:01,570
and  we are recruiting in various poles whether it

28
00:01:01,570 --> 00:01:03,460
is rivers pentest development

29
00:01:03,460 --> 00:01:05,379
response to an incident today here

30
00:01:05,379 --> 00:01:07,540
I want to emphasize it since it is

31
00:01:07,540 --> 00:01:08,530
true in the other conference that we

32
00:01:08,530 --> 00:01:10,330
were not clear enough on this subject there so

33
00:01:10,330 --> 00:01:11,760
here it is

34
00:01:11,760 --> 00:01:14,409
so today we're going to talk to you about

35
00:01:14,409 --> 00:01:16,720
what the pinto m6 competition is I didn't

36
00:01:16,720 --> 00:01:18,909
know you we're going to see the

37
00:01:18,909 --> 00:01:21,159
attack surface again to see how in the end

38
00:01:21,159 --> 00:01:23,290
we can find ourselves solving a little

39
00:01:23,290 --> 00:01:25,299
cat the 25 points its host but as we

40
00:01:25,299 --> 00:01:27,280
would do in the evening when we're a little

41
00:01:27,280 --> 00:01:29,350
tired at home we're going to see

42
00:01:29,350 --> 00:01:31,049
what

43
00:01:31,049 --> 00:01:33,909
remediation they have brought to this bug

44
00:01:33,909 --> 00:01:35,170
that we found quite good that we

45
00:01:35,170 --> 00:01:37,149
found and we will make a small conclusion

46
00:01:37,149 --> 00:01:39,820
in relation to that  and in the future because

47
00:01:39,820 --> 00:01:43,049
so there I saw it here is

48
00:01:43,049 --> 00:01:45,100
the little thing below the dax and

49
00:01:45,100 --> 00:01:47,140
christophe yeah but that's

50
00:01:47,140 --> 00:01:48,189
clearly what we're going to do we're going

51
00:01:48,189 --> 00:01:50,020
back to the 90s you'll

52
00:01:50,020 --> 00:01:52,810
see it's very funny  so tip one

53
00:01:52,810 --> 00:01:54,130
what is it is a contest

54
00:01:54,130 --> 00:01:58,840
organized by  native zdf

55
00:01:58,840 --> 00:02:00,969
which takes place two or three times a year and

56
00:02:00,969 --> 00:02:02,860
in fact they

57
00:02:02,860 --> 00:02:06,960
offer targets to attack to hack and

58
00:02:06,960 --> 00:02:08,639
it can be various targets including

59
00:02:08,639 --> 00:02:10,169
customers different types of competitions in

60
00:02:10,169 --> 00:02:11,880
competitions rather mobile oriented rather

61
00:02:11,880 --> 00:02:13,830
routers etc. they also have a  competition

62
00:02:13,830 --> 00:02:16,230
to renters industrial systems so

63
00:02:16,230 --> 00:02:19,500
it can be TVs roads to

64
00:02:19,500 --> 00:02:21,420
printers nas a role in many

65
00:02:21,420 --> 00:02:23,640
things and in fact the idea is that 30

66
00:02:23,640 --> 00:02:24,750
days before the start of the competition the

67
00:02:24,750 --> 00:02:27,000
announcements the targets with the rewards

68
00:02:27,000 --> 00:02:29,190
is in  you have 30 days to

69
00:02:29,190 --> 00:02:31,230
choose a bit of what you want and

70
00:02:31,230 --> 00:02:33,630
have some rehabilitated found and

71
00:02:33,630 --> 00:02:36,709
potentially participate in the competition

72
00:02:36,709 --> 00:02:38,880
the gills the manufacturers reserve

73
00:02:38,880 --> 00:02:40,590
the right to make patches until the

74
00:02:40,590 --> 00:02:41,970
day before the competition so if you have

75
00:02:41,970 --> 00:02:44,220
found a trick and  that one day before the

76
00:02:44,220 --> 00:02:45,630
start of the contest the guys have

77
00:02:45,630 --> 00:02:47,780
no home bath no pot

78
00:02:47,780 --> 00:02:49,920
the goal is to prove that we

79
00:02:49,920 --> 00:02:51,570
have code execution on the system that we

80
00:02:51,570 --> 00:02:52,489


81
00:02:52,489 --> 00:02:55,380
generally attack if we  can speak in shell mode

82
00:02:55,380 --> 00:02:57,900
it's enough however in fact there is

83
00:02:57,900 --> 00:02:59,910
a 20 minute slot which is reserved and

84
00:02:59,910 --> 00:03:01,620
in this lot he is entitled to make three

85
00:03:01,620 --> 00:03:03,180
attempts which last a maximum of five

86
00:03:03,180 --> 00:03:05,550
minutes so in fact that means that

87
00:03:05,550 --> 00:03:06,930
your exploit he can  not last more than

88
00:03:06,930 --> 00:03:08,370
five minutes and that means your

89
00:03:08,370 --> 00:03:09,750
achievement it must be relatively stable

90
00:03:09,750 --> 00:03:11,250
because in fact if you need

91
00:03:11,250 --> 00:03:13,290
to throw it four times but in fact it does

92
00:03:13,290 --> 00:03:14,280
not work because it is only three

93
00:03:14,280 --> 00:03:16,220
tries the

94
00:03:16,220 --> 00:03:19,050
same if you are  in remote

95
00:03:19,050 --> 00:03:20,760
you can't patch the export live

96
00:03:20,760 --> 00:03:22,110
so by the way you come with your pc and

97
00:03:22,110 --> 00:03:24,900
if the first time it doesn't work you

98
00:03:24,900 --> 00:03:26,610
can't modify your exploit

99
00:03:26,610 --> 00:03:28,560
because it's the guys who have it that they have

100
00:03:28,560 --> 00:03:30,240
under the  eyes and you don't have access to

101
00:03:30,240 --> 00:03:32,040
their keyboard but starting from when

102
00:03:32,040 --> 00:03:33,180
you are on site it is your machine

103
00:03:33,180 --> 00:03:34,410
you do what you want and therefore

104
00:03:34,410 --> 00:03:35,730
once you have won the concept

105
00:03:35,730 --> 00:03:37,380
it is for all of us and therefore in fact

106
00:03:37,380 --> 00:03:38,910
once you have thought of the device you

107
00:03:38,910 --> 00:03:41,370
win the  device and you also receive

108
00:03:41,370 --> 00:03:45,000
got rewards terms of money and the

109
00:03:45,000 --> 00:03:46,110
register in sion to do the registration

110
00:03:46,110 --> 00:03:47,880
is done a week before the contest

111
00:03:47,880 --> 00:03:49,710
so in fact you have 30 days

112
00:03:49,710 --> 00:03:50,850
to decide if you start doing

113
00:03:50,850 --> 00:03:51,980
your research

114
00:03:51,980 --> 00:03:53,850
a week before the start  of the contest

115
00:03:53,850 --> 00:03:55,560
you can say ok it's good I

116
00:03:55,560 --> 00:03:57,450
register seen attacking such target and

117
00:03:57,450 --> 00:03:58,490
it's gone

118
00:03:58,490 --> 00:04:00,630
what happens is that we can

119
00:04:00,630 --> 00:04:02,730
have several several accounts that

120
00:04:02,730 --> 00:04:05,040
competitor who register on the same

121
00:04:05,040 --> 00:04:07,260
target is  in fact what happens is

122
00:04:07,260 --> 00:04:09,510
that pwned karzaï they

123
00:04:09,510 --> 00:04:11,820
randomly choose the order of passage in

124
00:04:11,820 --> 00:04:13,170
which the teams which attack one

125
00:04:13,170 --> 00:04:15,630
if they are going to pass and there is a system of

126
00:04:15,630 --> 00:04:17,130
duplicating is in fact it is the first

127
00:04:17,130 --> 00:04:19,320
person who thinks  the device won the

128
00:04:19,320 --> 00:04:21,600
device equals the reward so if you

129
00:04:21,600 --> 00:04:23,940
go third and the person

130
00:04:23,940 --> 00:04:25,860
who goes first thinks the device

131
00:04:25,860 --> 00:04:28,260
you have a reduced reward or the

132
00:04:28,260 --> 00:04:30,260
same if on the other hand if you go

133
00:04:30,260 --> 00:04:32,430
fourth in our case and the

134
00:04:32,430 --> 00:04:34,020
three competitors before you pass

135
00:04:34,020 --> 00:04:36,240
but don't pass vettel various

136
00:04:36,240 --> 00:04:39,710
you obviously win the reward

137
00:04:39,710 --> 00:04:42,270
is where is so that's what i said

138
00:04:42,270 --> 00:04:44,850
here there's a cool thing you need to

139
00:04:44,850 --> 00:04:46,410
know is that's to say is  in

140
00:04:46,410 --> 00:04:48,360
fact in general they are super

141
00:04:48,360 --> 00:04:50,070
benevolent and they are really there

142
00:04:50,070 --> 00:04:52,380
so that you can so that you can

143
00:04:52,380 --> 00:04:54,150
win what they do everything to

144
00:04:54,150 --> 00:04:57,540
help you they are quite easy to reach

145
00:04:57,540 --> 00:04:59,910
to communicate with and for example in

146
00:04:59,910 --> 00:05:01,980
our case therefore in the title of the talk on

147
00:05:01,980 --> 00:05:04,740
mentioned man 2 will lead in fact we do

148
00:05:04,740 --> 00:05:06,210
n't really know where is man in the

149
00:05:06,210 --> 00:05:07,560
middle selected because in fact end

150
00:05:07,560 --> 00:05:09,960
are not hyper realistic man in the

151
00:05:09,960 --> 00:05:12,000
middle on a home router what is

152
00:05:12,000 --> 00:05:13,650
his visit you are a supplier

153
00:05:13,650 --> 00:05:15,060
of  internet access you are a

154
00:05:15,060 --> 00:05:16,770
government I don't know it did

155
00:05:16,770 --> 00:05:18,090
n't seem very realistic but

156
00:05:18,090 --> 00:05:19,740
they told us ok don't worry it

157
00:05:19,740 --> 00:05:20,790
fits the nails so you can

158
00:05:20,790 --> 00:05:21,800
play with it

159
00:05:21,800 --> 00:05:25,150
so there for example you showed a

160
00:05:25,150 --> 00:05:26,590
here it is  is the rules  of palm

161
00:05:26,590 --> 00:05:27,730
turn when you arrive 30 days

162
00:05:27,730 --> 00:05:29,560
before the competition tells you here for

163
00:05:29,560 --> 00:05:31,750
example if you have an rce from a

164
00:05:31,750 --> 00:05:32,730
browser

165
00:05:32,730 --> 00:05:34,990
for example on the samsung with the

166
00:05:34,990 --> 00:05:36,430
default browser you can win

167
00:05:36,430 --> 00:05:38,890
up to 50000 dollars via a point system

168
00:05:38,890 --> 00:05:40,840
also for these  people

169
00:05:40,840 --> 00:05:42,850
ranking is not in fact the tics who think the

170
00:05:42,850 --> 00:05:44,770
most things it's the team that brought

171
00:05:44,770 --> 00:05:46,650
back the most points what

172
00:05:46,650 --> 00:05:49,990
and therefore for example the router category

173
00:05:49,990 --> 00:05:51,550
so here there are several routers

174
00:05:51,550 --> 00:05:53,410
we notice a distinction between  if

175
00:05:53,410 --> 00:05:55,300
you attack it on the wan side or obviously

176
00:05:55,300 --> 00:05:56,920
you attack it from the internet it has a

177
00:05:56,920 --> 00:05:58,480
greater impact in terms of security

178
00:05:58,480 --> 00:06:00,880
or if you attack it on the lan side or there

179
00:06:00,880 --> 00:06:02,320
indeed it requires a

180
00:06:02,320 --> 00:06:05,800
close physical presence so it's me  is

181
00:06:05,800 --> 00:06:07,720
less important and so in our case

182
00:06:07,720 --> 00:06:09,610
we were interested this end last year

183
00:06:09,610 --> 00:06:11,530
in November we were interested in

184
00:06:11,530 --> 00:06:15,660
the netgear nike night raw router

185
00:06:15,660 --> 00:06:17,920
so if a little thingy that looks like

186
00:06:17,920 --> 00:06:20,050
that costs us a bit expensive jean 10  0 euros

187
00:06:20,050 --> 00:06:22,330
on amazon it's just a home router

188
00:06:22,330 --> 00:06:24,520
there's nothing special you

189
00:06:24,520 --> 00:06:26,200
connect to ethernet or by connecting

190
00:06:26,200 --> 00:06:28,630
to wifi there is a small web interface

191
00:06:28,630 --> 00:06:30,550
like almost all the authors you

192
00:06:30,550 --> 00:06:32,830
find today  and without

193
00:06:32,830 --> 00:06:35,970
an operating system it's a linux lite

194
00:06:35,970 --> 00:06:38,230
here we don't have shell access we do

195
00:06:38,230 --> 00:06:40,360
n't have serial access and on a console

196
00:06:40,360 --> 00:06:43,300
is nothing so here so now I

197
00:06:43,300 --> 00:06:45,370
'm going to give the floor to  kevin who is going

198
00:06:45,370 --> 00:06:46,510
to present to you a little more the surface

199
00:06:46,510 --> 00:06:48,810
of attack

200
00:06:49,530 --> 00:06:51,060
then

201
00:06:51,060 --> 00:06:53,770
as flooded roads said make

202
00:06:53,770 --> 00:06:55,240
a box a black box we do not have access

203
00:06:55,240 --> 00:06:56,530
we just have a small configuration web interface

204
00:06:56,530 --> 00:06:58,420
and we finally say to ourselves

205
00:06:58,420 --> 00:07:00,130
that if the question  the price of which the

206
00:07:00,130 --> 00:07:03,370
guts of this router and where I say

207
00:07:03,370 --> 00:07:04,660
how to know if there is in it so we

208
00:07:04,660 --> 00:07:06,010
can unsolder everything we can remove them

209
00:07:06,010 --> 00:07:08,020
to see them in there or jiwa already

210
00:07:08,020 --> 00:07:10,000
look at the manufacturer what is

211
00:07:10,000 --> 00:07:11,530
there we realize  that they provide

212
00:07:11,530 --> 00:07:13,930
update as a file and they are

213
00:07:13,930 --> 00:07:16,569
enough finally they are enough s  ympa

214
00:07:16,569 --> 00:07:18,990
the files are not encrypted

215
00:07:18,990 --> 00:07:21,520
josip which contains a son there is a

216
00:07:21,520 --> 00:07:24,699
chk extension we use I knew

217
00:07:24,699 --> 00:07:26,770
all been walk brewing so it's a

218
00:07:26,770 --> 00:07:29,020
tool that will be from the files

219
00:07:29,020 --> 00:07:30,249
to extract a little bit more who finds

220
00:07:30,249 --> 00:07:32,289
in it and he finds  indeed a

221
00:07:32,289 --> 00:07:34,240
squash and faith hill type file system

222
00:07:34,240 --> 00:07:36,159
where everything is in it and

223
00:07:36,159 --> 00:07:38,020
we actually besides that we could

224
00:07:38,020 --> 00:07:39,969
see the women if they are and we

225
00:07:39,969 --> 00:07:42,219
recover a tree structure that it is

226
00:07:42,219 --> 00:07:44,229
super classic we recover the kernel

227
00:07:44,229 --> 00:07:47,729
with it  is a very old linux notebook

228
00:07:47,729 --> 00:07:49,449
I forgot but I think it's due to

229
00:07:49,449 --> 00:07:52,300
2.4 it's a super old thing that's

230
00:07:52,300 --> 00:07:53,830
there and when you look a little bit

231
00:07:53,830 --> 00:07:55,089
quickly you realize there's a

232
00:07:55,089 --> 00:07:56,469
lot of open source stuff  which are

233
00:07:56,469 --> 00:07:58,180
known there are a few claude source binaries which are

234
00:07:58,180 --> 00:08:01,740
a little less known

235
00:08:01,740 --> 00:08:04,449
there the second thing that makes us

236
00:08:04,449 --> 00:08:06,219
happy when we want to analyze this kind

237
00:08:06,219 --> 00:08:07,479
of equipment, we may have root access to

238
00:08:07,479 --> 00:08:09,159
it because that allows us to have

239
00:08:09,159 --> 00:08:10,089
a  access say  ct

240
00:08:10,089 --> 00:08:12,789
we can watch live everything that

241
00:08:12,789 --> 00:08:15,009
happens on it and there the games we talk about it

242
00:08:15,009 --> 00:08:17,559
's hardly it's rather finally a mold

243
00:08:17,559 --> 00:08:19,689
which is quite nice from them even

244
00:08:19,689 --> 00:08:21,309
if there is no access on m6  has

245
00:08:21,309 --> 00:08:23,229
no console access even if for nothing there is one

246
00:08:23,229 --> 00:08:25,269
of the good ones who listens on port udp 23

247
00:08:25,269 --> 00:08:27,189
wanted to send a kind of easter is

248
00:08:27,189 --> 00:08:29,889
magic land ashley lots of stuff if

249
00:08:29,889 --> 00:08:31,809
you see the good package on 23

250
00:08:31,809 --> 00:08:33,429
lane side it opens its doors  she puts her

251
00:08:33,429 --> 00:08:36,698
hand aside this pack is magic it's

252
00:08:36,698 --> 00:08:39,130
not a backdoor it's planned paradox this

253
00:08:39,130 --> 00:08:41,828
h depends on the root admin password so

254
00:08:41,828 --> 00:08:42,969
if you don't have you can't be

255
00:08:42,969 --> 00:08:44,198
activated on the internet you can't

256
00:08:44,198 --> 00:08:46,569
do anything therefore from this  side there and no view

257
00:08:46,569 --> 00:08:48,459
that that's well done but we that's

258
00:08:48,459 --> 00:08:50,170
what it is it was super practical

259
00:08:50,170 --> 00:08:51,970
to analyze because on the one hand we have

260
00:08:51,970 --> 00:08:53,949
all the files that are available to the father

261
00:08:53,949 --> 00:08:56,319
of annie static  and we have root access

262
00:08:56,319 --> 00:08:59,380
on the on the router and therefore we can

263
00:08:59,380 --> 00:09:01,720
push a vest b we realize at the

264
00:09:01,720 --> 00:09:03,040
beginning a goal the box is not quite

265
00:09:03,040 --> 00:09:04,149
complete we push invisible hawks

266
00:09:04,149 --> 00:09:06,339
complete and suddenly we have everything they

267
00:09:06,339 --> 00:09:08,170
have everything we need to work

268
00:09:08,170 --> 00:09:09,250
quietly and

269
00:09:09,250 --> 00:09:12,720
quietly analyze this router

270
00:09:12,720 --> 00:09:15,529
as indicated

271
00:09:15,529 --> 00:09:17,260
whose

272
00:09:17,260 --> 00:09:19,150
in the pantone there are two ways

273
00:09:19,150 --> 00:09:21,220
to attack ships there is the  side there

274
00:09:21,220 --> 00:09:22,900
we side one so it's the routers

275
00:09:22,900 --> 00:09:24,160
that we could see are similar to that

276
00:09:24,160 --> 00:09:26,050
the paste or hans and those which

277
00:09:26,050 --> 00:09:27,850
actually connected me to your

278
00:09:27,850 --> 00:09:31,780
internet access and which shares the access to

279
00:09:31,780 --> 00:09:33,370
all the others and the side there  you

280
00:09:33,370 --> 00:09:35,080
can either use the small

281
00:09:35,080 --> 00:09:38,440
lan ports or the wifi and you choose

282
00:09:38,440 --> 00:09:41,790
which side you want to type on it

283
00:09:41,790 --> 00:09:45,340
at the beginning we say to ourselves good well we will

284
00:09:45,340 --> 00:09:47,620
look and on the lan side we look

285
00:09:47,620 --> 00:09:49,330
quickly obviously there is the web

286
00:09:49,330 --> 00:09:52,210
admin who talks about configuring we

287
00:09:52,210 --> 00:09:53,290
realizes that in the end a lot

288
00:09:53,290 --> 00:09:56,050
of things against fenty nmap we

289
00:09:56,050 --> 00:09:57,970
realize that there are plenty of tickets plenty

290
00:09:57,970 --> 00:10:00,310
of service points that respond

291
00:10:00,310 --> 00:10:02,230
we say to ourselves why not they think in

292
00:10:02,230 --> 00:10:03,580
five minutes where we say no  but after

293
00:10:03,580 --> 00:10:06,340
all all black style and it can be

294
00:10:06,340 --> 00:10:09,400
very practical when you google your services a bit

295
00:10:09,400 --> 00:10:10,480
you realize

296
00:10:10,480 --> 00:10:12,400
that saying they have already been good is

297
00:10:12,400 --> 00:10:14,140
because I have already had many many

298
00:10:14,140 --> 00:10:16,330
many views have  been found or

299
00:10:16,330 --> 00:10:17,530
Thursday anyway all the other

300
00:10:17,530 --> 00:10:19,840
teams will actually target you on this very

301
00:10:19,840 --> 00:10:21,940
side will sing something we

302
00:10:21,940 --> 00:10:24,340
risk being duplicated it's not going to be getting ready

303
00:10:24,340 --> 00:10:27,800
very very well my

304
00:10:27,800 --> 00:10:29,330
look suddenly we look quickly at the web

305
00:10:29,330 --> 00:10:31,790
admin good I think  corner of vulnerability

306
00:10:31,790 --> 00:10:33,230
that has been patched it's a brain is

307
00:10:33,230 --> 00:10:34,519
proprietary there was seen the cost is

308
00:10:34,519 --> 00:10:36,950
found in everything has been patched there is

309
00:10:36,950 --> 00:10:39,080
a system called let usb to

310
00:10:39,080 --> 00:10:41,870
do remote printing the same

311
00:10:41,870 --> 00:10:42,769
I have  had plenty of view we must have been

312
00:10:42,769 --> 00:10:44,810
patched there are afp file

313
00:10:44,810 --> 00:10:47,959
shares for apple there is snb which

314
00:10:47,959 --> 00:10:49,730
default package same thing point of view as

315
00:10:49,730 --> 00:10:51,050
the patches and then there are lots of

316
00:10:51,050 --> 00:10:52,820
owner stuff we say good we

317
00:10:52,820 --> 00:10:55,190
will maybe  don't look into it too much

318
00:10:55,190 --> 00:10:56,510
maybe  'we had to look because

319
00:10:56,510 --> 00:10:57,680
we realized that it's adele

320
00:10:57,680 --> 00:11:00,380
open to good the poor height he gets

321
00:11:00,380 --> 00:11:02,330
turned around there he had sights

322
00:11:02,330 --> 00:11:03,980
in all the protocols from everywhere

323
00:11:03,980 --> 00:11:05,870
maybe we should have passed a little

324
00:11:05,870 --> 00:11:08,540
more time but hey I say the lan drink

325
00:11:08,540 --> 00:11:10,040
before putting aside we're going to

326
00:11:10,040 --> 00:11:12,830
be really interested on the ouanna side

327
00:11:12,830 --> 00:11:17,360
and we say goals to each other on the one side we cry

328
00:11:17,360 --> 00:11:18,470
a little because your

329
00:11:18,470 --> 00:11:20,780
map sheet everything is closed security level it's

330
00:11:20,780 --> 00:11:23,150
very  well at least on the internet side

331
00:11:23,150 --> 00:11:25,640
which only tapped on it behind there is

332
00:11:25,640 --> 00:11:27,080
no dp either they listen to the same

333
00:11:27,080 --> 00:11:28,700
thing and nothing at all so again here we are

334
00:11:28,700 --> 00:11:31,670
going to start thinking a little and one

335
00:11:31,670 --> 00:11:33,050
of the first ideas that we  came

336
00:11:33,050 --> 00:11:35,450
it was even if there are no relatives of the

337
00:11:35,450 --> 00:11:36,710
two series cuts are listened to

338
00:11:36,710 --> 00:11:38,420
because of the drought of attac were able

339
00:11:38,420 --> 00:11:40,310
it's too much a city so perfect a

340
00:11:40,310 --> 00:11:43,690
view the kernel saw something like that

341
00:11:43,690 --> 00:11:45,470
but we s  is said it would still

342
00:11:45,470 --> 00:11:47,810
finally it's not trial vulnerabilities

343
00:11:47,810 --> 00:11:49,040
it asks when o  n talks about time to

344
00:11:49,040 --> 00:11:52,100
search and find even if the

345
00:11:52,100 --> 00:11:54,230
linux kernel is quite old we looked

346
00:11:54,230 --> 00:11:55,730
quickly sealed one day which could

347
00:11:55,730 --> 00:11:58,130
apply it did not work well and 7.10

348
00:11:58,130 --> 00:11:59,420
to talk about the one day they are not

349
00:11:59,420 --> 00:12:01,580
necessarily hot for that  'we use they

350
00:12:01,580 --> 00:12:03,130
want new vulnerabilities

351
00:12:03,130 --> 00:12:05,779
so we said good back

352
00:12:05,779 --> 00:12:06,980
we don't have much to do

353
00:12:06,980 --> 00:12:09,439
so a little bit by tapping on it

354
00:12:09,439 --> 00:12:12,170
suddenly we take another idea we say to ourselves

355
00:12:12,170 --> 00:12:14,180
but what is happening  pass if we

356
00:12:14,180 --> 00:12:16,339
were more of a man in the middle this

357
00:12:16,339 --> 00:12:17,810
router is fine to download

358
00:12:17,810 --> 00:12:19,550
stuff from the internet and where on Thursday he will

359
00:12:19,550 --> 00:12:22,309
download his satire the poison this after

360
00:12:22,309 --> 00:12:24,199
john peel is it to become infected on

361
00:12:24,199 --> 00:12:26,949
our own after good to win

362
00:12:26,949 --> 00:12:29,990
for that we  redo a little bit of

363
00:12:29,990 --> 00:12:32,180
danalysis a little bit dynamic a

364
00:12:32,180 --> 00:12:33,170
pin the counter we'll do a little tcpdump we'll do a little

365
00:12:33,170 --> 00:12:35,330
tcpdump we're lying gateway rouyn small

366
00:12:35,330 --> 00:12:37,130
men's cp veil that does without

367
00:12:37,130 --> 00:12:38,240
small lines which is snow

368
00:12:38,240 --> 00:12:40,370
little things in goblets or even a little

369
00:12:40,370 --> 00:12:42,140
know what there is if there is d  it's

370
00:12:42,140 --> 00:12:44,149
something known and we came across a

371
00:12:44,149 --> 00:12:46,550
blog post from a company called

372
00:12:46,550 --> 00:12:49,190
grimm, quite interesting, which seems

373
00:12:49,190 --> 00:12:50,750
to be variable on the one side, either it's

374
00:12:50,750 --> 00:12:52,370
saying so we say to ourselves, well, that's kind of what

375
00:12:52,370 --> 00:12:54,020
we're looking for  and he talks about a

376
00:12:54,020 --> 00:12:56,510
binary called circle des and they

377
00:12:56,510 --> 00:12:57,290
actually say that inert

378
00:12:57,290 --> 00:12:59,300
regularly download updates from the

379
00:12:59,300 --> 00:13:01,310
internet and above all it starts

380
00:13:01,310 --> 00:13:02,870
by default even if we didn't consider

381
00:13:02,870 --> 00:13:04,459
any of that to be released it is started

382
00:13:04,459 --> 00:13:06,649
been looking for the break here

383
00:13:06,649 --> 00:13:09,620
well well it's the kind of non-law where you

384
00:13:09,620 --> 00:13:11,510
want to find tithes hungary but

385
00:13:11,510 --> 00:13:12,830
they worked on it he enters at the beginning

386
00:13:12,830 --> 00:13:14,480
it was style and there are problems

387
00:13:14,480 --> 00:13:16,060
including the downloading of

388
00:13:16,060 --> 00:13:19,160
ddt gl de  update he had a remote

389
00:13:19,160 --> 00:13:21,380
exploit or thursday is it worth

390
00:13:21,380 --> 00:13:23,959
couple of years to analyze it or not

391
00:13:23,959 --> 00:13:27,430
spoiler knows

392
00:13:27,459 --> 00:13:30,260
how it works so when starting

393
00:13:30,260 --> 00:13:32,360
circle of islands and swamps it is a

394
00:13:32,360 --> 00:13:34,610
binary that allows to make lists

395
00:13:34,610 --> 00:13:36,860
parental controls you know these

396
00:13:36,860 --> 00:13:38,510
loads every sit  are all second

397
00:13:38,510 --> 00:13:42,589
line horn beer etc and after the you

398
00:13:42,589 --> 00:13:44,089
can configure by web interfaces I

399
00:13:44,089 --> 00:13:46,100
want to prohibit the consultation was

400
00:13:46,100 --> 00:13:48,770
the site etc us what interests us

401
00:13:48,770 --> 00:13:51,200
is that at startup and then

402
00:13:51,200 --> 00:13:52,880
every two hours they download

403
00:13:52,880 --> 00:13:54,860
updates is therefore  in detail the

404
00:13:54,860 --> 00:13:56,690
download is done in two steps it

405
00:13:56,690 --> 00:13:59,000
and charlie sheen index and it's index

406
00:13:59,000 --> 00:14:00,620
contains database version numbers

407
00:14:00,620 --> 00:14:02,839
and parental control engines

408
00:14:02,839 --> 00:14:05,029
and after depending on the case it is

409
00:14:05,029 --> 00:14:07,279
not up to date and and is looking for  to lisa day and

410
00:14:07,279 --> 00:14:09,120
the fun little thing is

411
00:14:09,120 --> 00:14:11,160
tales of grimm analyze that he was

412
00:14:11,160 --> 00:14:13,830
downloading to http and therefore ghrib were

413
00:14:13,830 --> 00:14:15,210
able to make a handsome man in the middle by

414
00:14:15,210 --> 00:14:16,890
breaking the connection and replacing

415
00:14:16,890 --> 00:14:18,779
the database to give theirs which

416
00:14:18,779 --> 00:14:21,290
was completely towards  the east

417
00:14:21,290 --> 00:14:24,570
now we have a beautiful the sediba a

418
00:14:24,570 --> 00:14:26,070
beautiful overview falcon is counting on

419
00:14:26,070 --> 00:14:27,089
certain faults that we will really have

420
00:14:27,089 --> 00:14:30,120
how it works and often the question

421
00:14:30,120 --> 00:14:31,680
we say to ourselves how really we will

422
00:14:31,680 --> 00:14:33,960
really attack  quer the search for sight

423
00:14:33,960 --> 00:14:36,120
there are not really magic methods

424
00:14:36,120 --> 00:14:37,740
for a sight each one does a little as

425
00:14:37,740 --> 00:14:40,770
he wants he looks a little bit as he

426
00:14:40,770 --> 00:14:42,660
can do there is no bad

427
00:14:42,660 --> 00:14:44,120
method no good method

428
00:14:44,120 --> 00:14:46,770
we live  going to do this step by step

429
00:14:46,770 --> 00:14:48,420
to actually reduce the life of this

430
00:14:48,420 --> 00:14:50,700
process is the first thing this

431
00:14:50,700 --> 00:14:52,080
process would be it

432
00:14:52,080 --> 00:14:54,360
actually downloads to file so you can

433
00:14:54,360 --> 00:14:56,070
see inflict is called circulating

434
00:14:56,070 --> 00:14:57,870
tip info and xt and so it contains the

435
00:14:57,870 --> 00:14:59,520
versions of data  base so each time

436
00:14:59,520 --> 00:15:02,010
it is the key word the version and which after

437
00:15:02,010 --> 00:15:03,420
the version number of the small

438
00:15:03,420 --> 00:15:04,740
sections to write that it works well

439
00:15:04,740 --> 00:15:07,920
on the back its texts quite basic quite

440
00:15:07,920 --> 00:15:09,470


441
00:15:09,470 --> 00:15:12,589
simple more interesting way this

442
00:15:12,589 --> 00:15:15,510
seminar circulates how

443
00:15:15,510 --> 00:15:18,029
it looks like c  it's a very small binary

444
00:15:18,029 --> 00:15:22,230
yes it's 50 50 k so we decide to

445
00:15:22,230 --> 00:15:23,910
say to ourselves maintain beats we're really going to feed

446
00:15:23,910 --> 00:15:25,050
in real life to do a real

447
00:15:25,050 --> 00:15:27,120
static analysis of sin see what it looks like

448
00:15:27,120 --> 00:15:29,670
we use toons o  n going to say in

449
00:15:29,670 --> 00:15:33,720
modern and practical to analyze it and

450
00:15:33,720 --> 00:15:35,970
therefore we use ida I think you

451
00:15:35,970 --> 00:15:37,850
all know ida

452
00:15:37,850 --> 00:15:40,500
it is one of the binary assemblers and

453
00:15:40,500 --> 00:15:43,040
it is also able to

454
00:15:43,040 --> 00:15:45,360
recover the source code of an assembly code

455
00:15:45,360 --> 00:15:46,370


456
00:15:46,370 --> 00:15:49,750
and suddenly  we have we

457
00:15:49,750 --> 00:15:53,770
can say it quasi source code reconstituted

458
00:15:53,770 --> 00:15:57,790
from the binary to compile and at the beginning

459
00:15:57,790 --> 00:15:59,320
where this debate holds since they download

460
00:15:59,320 --> 00:16:01,210
a text file we are interested in the

461
00:16:01,210 --> 00:16:03,280
way in which you download this

462
00:16:03,280 --> 00:16:05,350
text file we have given again functions

463
00:16:05,350 --> 00:16:08,040
order variables  and we see

464
00:16:08,040 --> 00:16:11,220
we called it teams data base they will

465
00:16:11,220 --> 00:16:12,660
use did not put everything because to

466
00:16:12,660 --> 00:16:14,009
function a little larger but

467
00:16:14,009 --> 00:16:15,029
overall they download

468
00:16:15,029 --> 00:16:17,850
files it the stock in tnp is what

469
00:16:17,850 --> 00:16:20,420
the swing do not send either it to

470
00:16:20,420 --> 00:16:22,100
to do

471
00:16:22,100 --> 00:16:25,920
there suddenly we see a fun 2 mp circuit

472
00:16:25,920 --> 00:16:28,040
of info and then afterwards he will pass his

473
00:16:28,040 --> 00:16:30,720
line after line he will

474
00:16:30,720 --> 00:16:32,940
actually look at the beginning for the datamatrix

475
00:16:32,940 --> 00:16:35,819
men with the value he has with a

476
00:16:35,819 --> 00:16:37,310
cnp locker room

477
00:16:37,310 --> 00:16:40,680
of his perhaps  talking about you counts

478
00:16:40,680 --> 00:16:42,910
already seen the city so

479
00:16:42,910 --> 00:16:46,780
how does it work it sucks they

480
00:16:46,780 --> 00:16:50,310
are doing something stupid is that the

481
00:16:50,310 --> 00:16:53,190
song because line by line in the

482
00:16:53,190 --> 00:16:56,410
in the variable lane so it does

483
00:16:56,410 --> 00:16:57,850
not 1020 how can everything indeed

484
00:16:57,850 --> 00:16:59,500
1024 put these ideas that end in

485
00:16:59,500 --> 00:17:02,680
terror  nor even at most 1024 in

486
00:17:02,680 --> 00:17:05,740
this variable and after the sk nef it will

487
00:17:05,740 --> 00:17:06,940
cut this barrier to find a

488
00:17:06,940 --> 00:17:08,560
space and it will store that in two

489
00:17:08,560 --> 00:17:11,470
variables which make 256 you can

490
00:17:11,470 --> 00:17:14,230
imagine 1024 mass is 156 long

491
00:17:14,230 --> 00:17:17,980
so it overflows so there is  way to

492
00:17:17,980 --> 00:17:22,210
break everything in addition it's on the stack and

493
00:17:22,210 --> 00:17:25,329
we say good we have a style of great it's

494
00:17:25,329 --> 00:17:28,480
won maybe thirty or forty

495
00:17:28,480 --> 00:17:30,550
years ago of his who owns write martin who is

496
00:17:30,550 --> 00:17:31,930
called this style match  on fun take

497
00:17:31,930 --> 00:17:34,210
advantage of it he said well here it is with a

498
00:17:34,210 --> 00:17:35,890
left stack we can finally become we

499
00:17:35,890 --> 00:17:37,300
can execute arbitrary code on the

500
00:17:37,300 --> 00:17:39,430
machines so at the beginning we see that we say

501
00:17:39,430 --> 00:17:40,510
go it's good it's winning but we

502
00:17:40,510 --> 00:17:43,360
say to ourselves anyway when  even at last

503
00:17:43,360 --> 00:17:46,060
anyway ausy first ci  rculate the info

504
00:17:46,060 --> 00:17:48,150
you saw it was loaded in https

505
00:17:48,150 --> 00:17:50,260
before the post of green and was loaded in

506
00:17:50,260 --> 00:17:54,310
http to place http coffee of the ssl bank

507
00:17:54,310 --> 00:17:57,700
was not done not we can not

508
00:17:57,700 --> 00:17:59,020
behind and like that in a trial way

509
00:17:59,020 --> 00:18:00,910
Thursday after the styles  left with a

510
00:18:00,910 --> 00:18:03,100
blurry or salty look compiles to the current ones they

511
00:18:03,100 --> 00:18:04,290
put canaries

512
00:18:04,290 --> 00:18:06,330
so all the same it's impossible a

513
00:18:06,330 --> 00:18:08,310
bump style we're going we're going to smash the

514
00:18:08,310 --> 00:18:10,350
canary the billiards he's going to die and we

515
00:18:10,350 --> 00:18:12,540
'll have won only dallas then there's

516
00:18:12,540 --> 00:18:13,560
bound to be defense in depth

517
00:18:13,560 --> 00:18:15,150
because the defense in depth

518
00:18:15,150 --> 00:18:16,860
today François several levels

519
00:18:16,860 --> 00:18:18,660
surely comes from the separation

520
00:18:18,660 --> 00:18:21,830
privilege because hanoi turn

521
00:18:21,830 --> 00:18:24,390
by turn is not going to do anything

522
00:18:24,390 --> 00:18:27,060
and and all that and all that and all that so

523
00:18:27,060 --> 00:18:28,320
we say good we can  -to be a bubble

524
00:18:28,320 --> 00:18:30,420
but in a good situation of his radio

525
00:18:30,420 --> 00:18:32,430
we have to look for but we say to ourselves all the

526
00:18:32,430 --> 00:18:34,770
same we are looking for a little better first the

527
00:18:34,770 --> 00:18:37,350
low https and their age it is a big

528
00:18:37,350 --> 00:18:39,390
big big fail because they use

529
00:18:39,390 --> 00:18:42,380
a  recurring system function - k so

530
00:18:42,380 --> 00:18:44,280
if you know a bit about

531
00:18:44,280 --> 00:18:46,590
girl options the least specific cases

532
00:18:46,590 --> 00:18:48,770
explicitly do not check certificate

533
00:18:48,770 --> 00:18:52,020
we will say you take an http s server

534
00:18:52,020 --> 00:18:53,250
whatever it is with any

535
00:18:53,250 --> 00:18:55,800
certificate and beats the daemon circulate

536
00:18:55,800 --> 00:18:58,980
therefore accepts that slbc is not very far

537
00:18:58,980 --> 00:19:02,400
the canaries there are others who compile

538
00:19:02,400 --> 00:19:04,830
their canary so we can do a little

539
00:19:04,830 --> 00:19:07,140
shake crushed the stac time that we

540
00:19:07,140 --> 00:19:09,090
hard at nothing at all we realize it

541
00:19:09,090 --> 00:19:10,980
when we look a little at the wages and

542
00:19:10,980 --> 00:19:12,840
partial has moreover  under linux there are

543
00:19:12,840 --> 00:19:15,330
three levels of dsr either not at

544
00:19:15,330 --> 00:19:16,940
all or partial or complete and partial

545
00:19:16,940 --> 00:19:19,590
the binary and papa eyes suddenly we will

546
00:19:19,590 --> 00:19:21,210
know exactly where is it in memory

547
00:19:21,210 --> 00:19:22,560
the ippon to sare exactly where is

548
00:19:22,560 --> 00:19:23,940
it in memory c  is always

549
00:19:23,940 --> 00:19:27,929
nice and in addition the demo it turns in

550
00:19:27,929 --> 00:19:30,360
it turns on the way so to the tifosi and

551
00:19:30,360 --> 00:19:32,009
already on the road there is no separation there

552
00:19:32,009 --> 00:19:35,100
is nothing at all so there suddenly it is the

553
00:19:35,100 --> 00:19:36,450
little emotional elevator where to find

554
00:19:36,450 --> 00:19:37,860
sight  the ousse of the woods it will never work

555
00:19:37,860 --> 00:19:39,259
and that it  a we go back in ten years

556
00:19:39,259 --> 00:19:42,389
finally it's great because we

557
00:19:42,389 --> 00:19:44,039
're pretty good in real life with

558
00:19:44,039 --> 00:19:46,940
one hand and

559
00:19:46,940 --> 00:19:49,360
that's what we call it finally

560
00:19:49,360 --> 00:19:52,040
it looks like little challenges

561
00:19:52,040 --> 00:19:53,540
that we find on the road or level  or

562
00:19:53,540 --> 00:19:56,960
elsewhere an intermediate level and the

563
00:19:56,960 --> 00:19:59,210
null is just mud and we will try

564
00:19:59,210 --> 00:20:01,970
to rewrite the return address and we can

565
00:20:01,970 --> 00:20:03,800
rewrite on arte with registers which

566
00:20:03,800 --> 00:20:05,240
are saved and see a little bit what

567
00:20:05,240 --> 00:20:07,030
we can do with it

568
00:20:07,030 --> 00:20:09,280
in the

569
00:20:09,280 --> 00:20:12,160
whose limitations like the string

570
00:20:12,160 --> 00:20:13,780
we use to crush a stack

571
00:20:13,780 --> 00:20:16,150
comes from a string we know that we ca

572
00:20:16,150 --> 00:20:18,700
n't use two bin 2 nulls in we

573
00:20:18,700 --> 00:20:20,550
can't only use a raid ritter

574
00:20:20,550 --> 00:20:22,840
and we can't use the space  since

575
00:20:22,840 --> 00:20:24,940
the space is the variable that will

576
00:20:24,940 --> 00:20:28,320
separate the two the party line

577
00:20:28,320 --> 00:20:31,360
the binary or when it has its address it

578
00:20:31,360 --> 00:20:34,360
is the water of the addresses 0000 a city it

579
00:20:34,360 --> 00:20:37,360
starts with two zero bytes there we say to

580
00:20:37,360 --> 00:20:39,190
ourselves blah if we want to do  rock this

581
00:20:39,190 --> 00:20:40,660
complicated because you have to write a lot

582
00:20:40,660 --> 00:20:42,280
of addresses in binary  which are all going to

583
00:20:42,280 --> 00:20:43,660
be everything starts with dummies

584
00:20:43,660 --> 00:20:45,700
byte it may not be easy but hey

585
00:20:45,700 --> 00:20:47,760
we'll see where

586
00:20:47,760 --> 00:20:50,800
it's nice to have it and it's that it's a test

587
00:20:50,800 --> 00:20:54,300
of little indian tears so we rewrite

588
00:20:54,300 --> 00:20:57,160
to say upside down  by the last bytes

589
00:20:57,160 --> 00:20:59,200
so suddenly even if the first two

590
00:20:59,200 --> 00:21:00,640
bytes and zeros in fact he finds himself

591
00:21:00,640 --> 00:21:01,930
at the end so in the process of writing the

592
00:21:01,930 --> 00:21:03,100
stack just stop at the right

593
00:21:03,100 --> 00:21:05,200
place and we can rewrite the 2 bytes

594
00:21:05,200 --> 00:21:07,390
that  we are interested in a hundred thousand bytes and we

595
00:21:07,390 --> 00:21:09,970
can call any address we

596
00:21:09,970 --> 00:21:11,170
can call any address

597
00:21:11,170 --> 00:21:12,940
in the binary and return anywhere

598
00:21:12,940 --> 00:21:15,720


599
00:21:17,160 --> 00:21:19,450
dominated suddenly we say to ourselves farc have found

600
00:21:19,450 --> 00:21:21,520
a strategy now to become

601
00:21:21,520 --> 00:21:24,040
August or Thursday either  we're trying to do

602
00:21:24,040 --> 00:21:26,119
something a little

603
00:21:26,119 --> 00:21:28,789
cui cui jian dirty we're trying to find

604
00:21:28,789 --> 00:21:30,949
a pledge studying who the gadget is he does

605
00:21:30,949 --> 00:21:32,299
that they give us root rights we

606
00:21:32,299 --> 00:21:33,289
do whatever we want and it's great

607
00:21:33,289 --> 00:21:34,819
when I say we  going to try to do

608
00:21:34,819 --> 00:21:36,949
something a little cleaner we're going to

609
00:21:36,949 --> 00:21:38,439
the gadgets

610
00:21:38,439 --> 00:21:41,539
with several skds there is no

611
00:21:41,539 --> 00:21:44,829
draw so i would like the function that he

612
00:21:44,829 --> 00:21:48,469
washed rally tcs at the beginning escanès so we

613
00:21:48,469 --> 00:21:49,849
say we say sedunois it is to be august

614
00:21:49,849 --> 00:21:52,579
but when when we look a little bit

615
00:21:52,579 --> 00:21:53,689
we  realizes in fact it is

616
00:21:53,689 --> 00:21:55,999
wrapped in a wild sawyer in fact

617
00:21:55,999 --> 00:21:57,739
each line of the file circulate the info is

618
00:21:57,739 --> 00:21:59,719
going to be parent it is by this function

619
00:21:59,719 --> 00:22:00,889
of a maples so in fact we can

620
00:22:00,889 --> 00:22:04,429
call the sk snow as many times cool

621
00:22:04,429 --> 00:22:06,229
so in  fact we can write we can

622
00:22:06,229 --> 00:22:07,489
rewrite the stac as many times as we

623
00:22:07,489 --> 00:22:08,839
want with as much ardor and what we

624
00:22:08,839 --> 00:22:10,699
want and as in addition an end of line

625
00:22:10,699 --> 00:22:12,259
a feint of stream years and there is a draw

626
00:22:12,259 --> 00:22:14,419
we can possibly write to  each

627
00:22:14,419 --> 00:22:16,219
time the first line a first draw the

628
00:22:16,219 --> 00:22:17,809
second line a second draw by

629
00:22:17,809 --> 00:22:20,329
stopping an extra step forward and it is

630
00:22:20,329 --> 00:22:22,279
from them that or was it said there

631
00:22:22,279 --> 00:22:24,169
is perhaps a way effectively by

632
00:22:24,169 --> 00:22:26,089
manipulating all the

633
00:22:26,089 --> 00:22:28,039
lines circulate art info write it

634
00:22:28,039 --> 00:22:29,269
all lille that we are a stack of

635
00:22:29,269 --> 00:22:32,900
doing  a rop pretty much our own mother

636
00:22:32,900 --> 00:22:35,270
but we were in the evening and we said

637
00:22:35,270 --> 00:22:36,830
to ourselves we're going to do something you quickly we don't

638
00:22:36,830 --> 00:22:38,480
want to complicate our lives so we're going

639
00:22:38,480 --> 00:22:39,830
to try to find the really the

640
00:22:39,830 --> 00:22:42,530
one gadgets rce on  we manage we

641
00:22:42,530 --> 00:22:43,850
rewrite once drg is back and

642
00:22:43,850 --> 00:22:46,420
then we have to win it will be

643
00:22:46,420 --> 00:22:48,380
you suddenly we are really interested in

644
00:22:48,380 --> 00:22:50,680
memory what is happening

645
00:22:50,680 --> 00:22:54,020
and we can see that fever actually because

646
00:22:54,020 --> 00:22:57,290
of this sk  nef which writes

647
00:22:57,290 --> 00:22:59,180
two variables close to statics and

648
00:22:59,180 --> 00:23:01,400
that we can smell flow in a single

649
00:23:01,400 --> 00:23:03,590
line of the file we can overwrite a

650
00:23:03,590 --> 00:23:06,440
stack of choices and so we say to ourselves it's

651
00:23:06,440 --> 00:23:07,790
nice because the first overflow we

652
00:23:07,790 --> 00:23:09,740
can rewrite return address

653
00:23:09,740 --> 00:23:11,180
there  is the second best blur we can

654
00:23:11,180 --> 00:23:13,790
rewrite register advice which may

655
00:23:13,790 --> 00:23:15,260
or may not be interesting and

656
00:23:15,260 --> 00:23:16,670
fill it we can put a null

657
00:23:16,670 --> 00:23:18,200
bike on it which will be added by order of the

658
00:23:18,200 --> 00:23:21,200
chain years and suddenly we do a

659
00:23:21,200 --> 00:23:23,150
test with finally a first test have  created

660
00:23:23,150 --> 00:23:25,220
a file to circulate the pointed info x t we

661
00:23:25,220 --> 00:23:26,210
put  to be full of rare isn't it this

662
00:23:26,210 --> 00:23:28,280
point of b we meet considering that

663
00:23:28,280 --> 00:23:29,510
it spits well as it should the

664
00:23:29,510 --> 00:23:31,670
registers moment there the value the desired value

665
00:23:31,670 --> 00:23:34,120


666
00:23:35,440 --> 00:23:39,140
and suddenly we are not looking for

667
00:23:39,140 --> 00:23:41,570
magic gadgets and we say to ourselves by magic

668
00:23:41,570 --> 00:23:44,450
simplest gadget to examine

669
00:23:44,450 --> 00:23:46,340
wise sap to interest us because we are

670
00:23:46,340 --> 00:23:48,230
in remote we will rather try to call

671
00:23:48,230 --> 00:23:51,290
the system function it is with a

672
00:23:51,290 --> 00:23:53,590
shell script mood that interests us

673
00:23:53,590 --> 00:23:56,150
the only thing we need is

674
00:23:56,150 --> 00:23:58,340
suddenly the school system function because

675
00:23:58,340 --> 00:24:00,170
it frees it it is charged not

676
00:24:00,170 --> 00:24:01,910
pay what exactly where can we

677
00:24:01,910 --> 00:24:03,560
call the function of the system and

678
00:24:03,560 --> 00:24:05,870
we wear money is that being

679
00:24:05,870 --> 00:24:07,580
an address in memory the  put in the

680
00:24:07,580 --> 00:24:11,080
register f0 swarm and it would be executed

681
00:24:11,080 --> 00:24:14,120
and we also know that the

682
00:24:14,120 --> 00:24:17,270
skf function always ends with m sooner or later

683
00:24:17,270 --> 00:24:19,670
whose processing the line the data

684
00:24:19,670 --> 00:24:22,280
of the line hold by sedan layman and

685
00:24:22,280 --> 00:24:23,180
we finally say to ourselves that's enough

686
00:24:23,180 --> 00:24:24,669
interesting because

687
00:24:24,669 --> 00:24:26,950
this long line blow  but if we

688
00:24:26,950 --> 00:24:28,330
put bits of shell script cabbage in the middle

689
00:24:28,330 --> 00:24:30,759
of teeth that went into the hip did not

690
00:24:30,759 --> 00:24:31,989
try to dresden live with

691
00:24:31,989 --> 00:24:35,019
data that we control everything sticks and if

692
00:24:35,019 --> 00:24:36,519
we type elsewhere in the hip everything crashes

693
00:24:36,519 --> 00:24:38,649
but united it  is nice they are

694
00:24:38,649 --> 00:24:40,450
almost crashes it restarts

695
00:24:40,450 --> 00:24:42,039
automatically it restarts and it

696
00:24:42,039 --> 00:24:44,139
starts again suddenly you have to download it

697
00:24:44,139 --> 00:24:47,909
spits out rhinoise address and that

698
00:24:47,909 --> 00:24:51,820
's the magic gadget we found

699
00:24:51,820 --> 00:24:54,429
it was this one at the celi that's

700
00:24:54,429 --> 00:24:57,580
really really  super interesting

701
00:24:57,580 --> 00:24:59,649
once we have taken the return address

702
00:24:59,649 --> 00:25:01,869
and restored the idiots to

703
00:25:01,869 --> 00:25:03,820
restore the roadies the registers we

704
00:25:03,820 --> 00:25:05,289
can try to type the address of his

705
00:25:05,289 --> 00:25:07,570
78 because he tried to sow in

706
00:25:07,570 --> 00:25:08,580
attack

707
00:25:08,580 --> 00:25:11,409
the value of register r2 which is a

708
00:25:11,409 --> 00:25:12,639
recognized value we know that we have

709
00:25:12,639 --> 00:25:14,289
crushed since we already have a frame

710
00:25:14,289 --> 00:25:16,119
below since tackle not mastered but in

711
00:25:16,119 --> 00:25:18,309
any case the value of register r2 is

712
00:25:18,309 --> 00:25:19,720
stable it is known we know what  that

713
00:25:19,720 --> 00:25:21,730
it is and after to this register r2 it

714
00:25:21,730 --> 00:25:23,350
adds air 4 e  t that's good because

715
00:25:23,350 --> 00:25:24,820
yesterday 4 it's a register that we overwritten

716
00:25:24,820 --> 00:25:26,470
by ourselves so its values its color

717
00:25:26,470 --> 00:25:30,279
that we provide and the resul

718
00:25:30,279 --> 00:25:31,629
are also 0 so say to ourselves we're

719
00:25:31,629 --> 00:25:32,289
just doing a little bit o

720
00:25:32,289 --> 00:25:34,809
arithmetic and r2 is known yesterday 4

721
00:25:34,809 --> 00:25:36,309
we put the value we want and have

722
00:25:36,309 --> 00:25:37,899
spun with a value of chosen hero

723
00:25:37,899 --> 00:25:39,340
and then it calls the system function

724
00:25:39,340 --> 00:25:41,440
and therefore it will call france russie m

725
00:25:41,440 --> 00:25:43,239
we hope there is a shell script to

726
00:25:43,239 --> 00:25:45,940
the address of m 0 you just have to

727
00:25:45,940 --> 00:25:47,440
avoid laughing at it 4 indeed there is no

728
00:25:47,440 --> 00:25:49,389
return there is no space and not two

729
00:25:49,389 --> 00:25:50,039
zeros

730
00:25:50,039 --> 00:25:53,619
or stop the constraints are

731
00:25:53,619 --> 00:25:55,029
weak enough for it to

732
00:25:55,029 --> 00:25:57,239
go well

733
00:25:58,230 --> 00:26:01,299
and suddenly  now if we on a pass

734
00:26:01,299 --> 00:26:03,580
everything we find exactly the same the

735
00:26:03,580 --> 00:26:05,049
same dog just now but where

736
00:26:05,049 --> 00:26:06,519
it's really good what we are going to do

737
00:26:06,519 --> 00:26:08,440
so whose first overflow lesson the

738
00:26:08,440 --> 00:26:10,029
blur we will actually put this

739
00:26:10,029 --> 00:26:11,919
script chain  shell with the correct

740
00:26:11,919 --> 00:26:13,690
addresses in r4 and the correct address

741
00:26:13,690 --> 00:26:16,330
in 7 pc and out of it  s of the

742
00:26:16,330 --> 00:26:18,059
master of the chain

743
00:26:18,059 --> 00:26:20,009
it

744
00:26:20,009 --> 00:26:23,679
worked suddenly I would only have antide who we

745
00:26:23,679 --> 00:26:25,029
can explain how we finish

746
00:26:25,029 --> 00:26:26,630
the feat

747
00:26:26,630 --> 00:26:30,020
so precisely as a duty we

748
00:26:30,020 --> 00:26:32,930
control our era 06 eur 0 years in

749
00:26:32,930 --> 00:26:35,810
the army finally more specifically under

750
00:26:35,810 --> 00:26:38,360
linux  it is the first argument that we

751
00:26:38,360 --> 00:26:40,370
pass to a function in fact so here

752
00:26:40,370 --> 00:26:41,810
in their 0 we seek to put

753
00:26:41,810 --> 00:26:44,030
the address to a character string

754
00:26:44,030 --> 00:26:45,830
that we control and therefore since we call

755
00:26:45,830 --> 00:26:47,720
the system function the first finally the

756
00:26:47,720 --> 00:26:49,460
only one  systems argument is a

757
00:26:49,460 --> 00:26:50,960
character string that corresponds to a

758
00:26:50,960 --> 00:26:53,300
shell script so what we want is

759
00:26:53,300 --> 00:26:55,550
that in their zero we put a pointer

760
00:26:55,550 --> 00:26:57,410
to a character string that

761
00:26:57,410 --> 00:26:59,380
contains

762
00:26:59,380 --> 00:27:01,270
a shell script that we can execute what

763
00:27:01,270 --> 00:27:03,610
so  There's a funny thing is that by

764
00:27:03,610 --> 00:27:05,050
doing a few tests we

765
00:27:05,050 --> 00:27:07,300
realize that in this hymn that which is

766
00:27:07,300 --> 00:27:08,830
static because the wages are

767
00:27:08,830 --> 00:27:09,810
partial

768
00:27:09,810 --> 00:27:12,780
and because paying is not activated

769
00:27:12,780 --> 00:27:16,000
we find in life des  pieces of

770
00:27:16,000 --> 00:27:17,860
our chain while as we have  seen

771
00:27:17,860 --> 00:27:19,510
in the code our stack overflow it is

772
00:27:19,510 --> 00:27:22,210
validated on the stac by definition and

773
00:27:22,210 --> 00:27:24,160
but despite everything we let go in the free

774
00:27:24,160 --> 00:27:25,360
a moment ago our string of

775
00:27:25,360 --> 00:27:27,220
characters which is found there so what

776
00:27:27,220 --> 00:27:28,420
we say is good instead  to

777
00:27:28,420 --> 00:27:31,510
put aces for bad is and how and to

778
00:27:31,510 --> 00:27:33,850
reach the fleet of 256 bytes to be

779
00:27:33,850 --> 00:27:35,620
able to make our property fuzzy yes but

780
00:27:35,620 --> 00:27:36,790
in fact it's just the perfect place

781
00:27:36,790 --> 00:27:38,950
to insert our our shell script there

782
00:27:38,950 --> 00:27:41,110
so the idea in fact is  that in our

783
00:27:41,110 --> 00:27:42,910
exploit in fact we are going to write

784
00:27:42,910 --> 00:27:45,220
a shell script without spaces obviously

785
00:27:45,220 --> 00:27:46,530
we will call it

786
00:27:46,530 --> 00:27:50,380
and have it done like that as

787
00:27:50,380 --> 00:27:52,390
kevin said on the other hand we are a little obliged to

788
00:27:52,390 --> 00:27:54,160
noise to force because according to

789
00:27:54,160 --> 00:27:55,630
how we taste  the router depending

790
00:27:55,630 --> 00:27:57,070
on the life that had a bit on the router

791
00:27:57,070 --> 00:27:58,450
this chain is not necessarily

792
00:27:58,450 --> 00:28:01,900
in the same place in the alp because

793
00:28:01,900 --> 00:28:03,160
there may have been allocations

794
00:28:03,160 --> 00:28:05,020
beforehand which caused the next

795
00:28:05,020 --> 00:28:06,760
allocation to be found  a little below

796
00:28:06,760 --> 00:28:09,490
and it is therefore a gross  e force a little

797
00:28:09,490 --> 00:28:13,000
it's not very clean but it works on the

798
00:28:13,000 --> 00:28:14,740
other hand there is something you should know

799
00:28:14,740 --> 00:28:15,720
is that

800
00:28:15,720 --> 00:28:17,370
in fact yes why at the end of force and

801
00:28:17,370 --> 00:28:18,990
s is not a problem the binary and

802
00:28:18,990 --> 00:28:20,700
crash well we we s  'don't care because in

803
00:28:20,700 --> 00:28:22,020
fact in binary it stands out on its own

804
00:28:22,020 --> 00:28:23,429
it really wants to have

805
00:28:23,429 --> 00:28:25,620
to update it which is a good thing so

806
00:28:25,620 --> 00:28:27,270
every time they spit they

807
00:28:27,270 --> 00:28:29,039
relaunch themselves they start downloading

808
00:28:29,039 --> 00:28:31,650
the files again all the stuff  and us in

809
00:28:31,650 --> 00:28:32,669
fact that's how we come to the end

810
00:28:32,669 --> 00:28:34,140
of our strength and choose to say thank you to him

811
00:28:34,140 --> 00:28:35,850
and this such address and the address at

812
00:28:35,850 --> 00:28:38,130
the address until it works, on the

813
00:28:38,130 --> 00:28:40,320
other hand, it takes time and the  time

814
00:28:40,320 --> 00:28:41,730
it takes to start the process they

815
00:28:41,730 --> 00:28:43,770
do a little bit of all this mess it takes

816
00:28:43,770 --> 00:28:46,320
about 20 seconds so

817
00:28:46,320 --> 00:28:47,450
in brentwood

818
00:28:47,450 --> 00:28:49,919
it can be a problem in the sense that

819
00:28:49,919 --> 00:28:51,780
our slots i meant at the start

820
00:28:51,780 --> 00:28:53,370
only lasts five minutes  so we have to take that

821
00:28:53,370 --> 00:28:55,230
into account we can't brute

822
00:28:55,230 --> 00:28:57,679
force all night either

823
00:28:57,679 --> 00:29:00,030
while in  a real case it could

824
00:29:00,030 --> 00:29:04,859
be ok so here's the idea it's actually

825
00:29:04,859 --> 00:29:07,299
to have more chances of

826
00:29:07,299 --> 00:29:09,489
falling properly on this congress

827
00:29:09,489 --> 00:29:10,450
of force address because we don't know exactly

828
00:29:10,450 --> 00:29:13,869
where it is and in fact we're just going to

829
00:29:13,869 --> 00:29:17,200
write  full of semicolon our

830
00:29:17,200 --> 00:29:19,899
shell script and there we overwrite the value

831
00:29:19,899 --> 00:29:22,149
of 7 pc we are a space for our

832
00:29:22,149 --> 00:29:24,429
second variable we are still full

833
00:29:24,429 --> 00:29:25,349
of to

834
00:29:25,349 --> 00:29:27,249
so that it corresponds to a

835
00:29:27,249 --> 00:29:28,960
shell command that does not exist semicolon

836
00:29:28,960 --> 00:29:31,570
our shell script and  we overwrite the

837
00:29:31,570 --> 00:29:33,599
value of r4

838
00:29:33,599 --> 00:29:35,499
so that actually allows us a

839
00:29:35,499 --> 00:29:37,539
lot of force and 256 bytes in

840
00:29:37,539 --> 00:29:39,820
256 bytes it's a completely

841
00:29:39,820 --> 00:29:41,259
arbitrary value because we found that it

842
00:29:41,259 --> 00:29:46,210
works much more twist on day 2

843
00:29:46,210 --> 00:29:49,360
of the pwn2own in  fact the guy started the

844
00:29:49,360 --> 00:29:50,440
engine is in fact it is

845
00:29:50,440 --> 00:29:52,120
exactly the same address as us

846
00:29:52,120 --> 00:29:53,190
we had in production

847
00:29:53,190 --> 00:29:56,290
so in fact it's nickel not even

848
00:29:56,290 --> 00:29:57,100
need of force and we would have

849
00:29:57,100 --> 00:29:59,200
more just to do a feat just I him

850
00:29:59,200 --> 00:30:00,820
give a pretext and I do vasilescu

851
00:30:00,820 --> 00:30:04,120
that  worked the same but here we are

852
00:30:04,120 --> 00:30:05,680
still a little conscientious it has to

853
00:30:05,680 --> 00:30:07,540
work we never know we are

854
00:30:07,540 --> 00:30:09,040
not immune which is a

855
00:30:09,040 --> 00:30:12,750
different behavior at home in the United States so

856
00:30:12,750 --> 00:30:14,650
here is the idea is that at  every time

857
00:30:14,650 --> 00:30:16,900
you jump on our obsolete

858
00:30:16,900 --> 00:30:18,100
we call it that it's a bit of an

859
00:30:18,100 --> 00:30:19,810
obsession if you do shell trading

860
00:30:19,810 --> 00:30:22,980
it's not notes but gave in to what

861
00:30:22,980 --> 00:30:25,390
little remark I was already told

862
00:30:25,390 --> 00:30:26,620
yeah why did you  not just put a lot

863
00:30:26,620 --> 00:30:28,360
of points given the Lyonnais carried out

864
00:30:28,360 --> 00:30:30,370
in fact. I the semicolon ambages

865
00:30:30,370 --> 00:30:31,660
it's a particular syntax so

866
00:30:31,660 --> 00:30:33,430
it just returns a syntax error

867
00:30:33,430 --> 00:30:34,750
so that's why I put a lot of

868
00:30:34,750 --> 00:30:36,940
manages to say or to your  command at 2,256

869
00:30:36,940 --> 00:30:39,220
characters commands not found it

870
00:30:39,220 --> 00:30:41,320
does not exist semicolon I execute the

871
00:30:41,320 --> 00:30:43,410
following is no problem

872
00:30:43,410 --> 00:30:46,960
here it is therefore it is not very clean but it

873
00:30:46,960 --> 00:30:49,060
works so the idea now is

874
00:30:49,060 --> 00:30:51,130
how to operate its tour

875
00:30:51,130 --> 00:30:52,750
in our scenario of man and the middle

876
00:30:52,750 --> 00:30:55,600
so we pop indie ban we branch it  he

877
00:30:55,600 --> 00:30:57,730
in the ass of the nose say on part one

878
00:30:57,730 --> 00:31:00,070
in the eu says malraux we are we from the

879
00:31:00,070 --> 00:31:02,320
hcp we fell to the dns we are we are

880
00:31:02,320 --> 00:31:04,900
all we do what we want so we

881
00:31:04,900 --> 00:31:06,160
taste the year of saying what is  what

882
00:31:06,160 --> 00:31:07,810
does he do not cell so I am

883
00:31:07,810 --> 00:31:09,940
connected to the internet on the wan what is

884
00:31:09,940 --> 00:31:12,190
my public ip address so bah

885
00:31:12,190 --> 00:31:14,200
tell us bah hold your ip address that's it it

886
00:31:14,200 --> 00:31:15,910
's ok cool now I'm going to

887
00:31:15,910 --> 00:31:18,070
update my services

888
00:31:18,070 --> 00:31:20,050
in  parental control etc. I need

889
00:31:20,050 --> 00:31:21,400
to access such a site what is

890
00:31:21,400 --> 00:31:22,690
the address of such sites so I follow a

891
00:31:22,690 --> 00:31:24,850
dns request they say the address of such

892
00:31:24,850 --> 00:31:27,580
sites is with us go ahead come on he will

893
00:31:27,580 --> 00:31:29,500
do  his request on an http s server

894
00:31:29,500 --> 00:31:31,750
but with the option to pull khaki simply

895
00:31:31,750 --> 00:31:34,270
say I don't know the certificate so we are

896
00:31:34,270 --> 00:31:35,890
giving him an http s server with a

897
00:31:35,890 --> 00:31:39,010
self-signed certificate he doesn't care

898
00:31:39,010 --> 00:31:43,270
he takes it and that's how I see it

899
00:31:43,270 --> 00:31:44,770
I said earlier we were

900
00:31:44,770 --> 00:31:46,390
doing me I was perplexed kevin a little

901
00:31:46,390 --> 00:31:47,710
less me I was perplexed in mode yeah

902
00:31:47,710 --> 00:31:49,030
finally frankly jam  but it's okay it's

903
00:31:49,030 --> 00:31:50,980
too big and we asked its media

904
00:31:50,980 --> 00:31:52,510
they made the web in fact there is

905
00:31:52,510 --> 00:31:56,050
no problem it's considered valid

906
00:31:56,050 --> 00:31:57,490
because they have a category really man

907
00:31:57,490 --> 00:31:58,990
in the middle apart from where there  it's

908
00:31:58,990 --> 00:32:01,300
really doing man in the middle on

909
00:32:01,300 --> 00:32:03,340
a connection someone who for example

910
00:32:03,340 --> 00:32:04,840
an admin who connects to a service

911
00:32:04,840 --> 00:32:06,760
really realized a real man in the

912
00:32:06,760 --> 00:32:09,340
middle kind of hijack the connection is

913
00:32:09,340 --> 00:32:11,170
sent to servers etc to steal

914
00:32:11,170 --> 00:32:12,880
decree of a  thing for example but here

915
00:32:12,880 --> 00:32:17,280
it didn't apply here and

916
00:32:17,580 --> 00:32:19,870
so what we're doing is just an

917
00:32:19,870 --> 00:32:22,540
http server with a flange in

918
00:32:22,540 --> 00:32:24,880
this case here we give it a route

919
00:32:24,880 --> 00:32:27,730
because what I'm guessing here is they

920
00:32:27,730 --> 00:32:28,900
had to make a  error in writing

921
00:32:28,900 --> 00:32:30,400
their software and sometimes there is a

922
00:32:30,400 --> 00:32:31,930
slash sometimes and slashes in the url

923
00:32:31,930 --> 00:32:35,080
so it doesn't matter but so we had to

924
00:32:35,080 --> 00:32:36,460
manage both cases it's simply what

925
00:32:36,460 --> 00:32:38,020
we do it's we generate after the aude

926
00:32:38,020 --> 00:32:41,980
au  start of the function and from time to

927
00:32:41,980 --> 00:32:44,380
time swings it with a more

928
00:32:44,380 --> 00:32:46,890
or less different address  ntes

929
00:32:47,850 --> 00:32:49,810
therefore that the function which generates the pays

930
00:32:49,810 --> 00:32:51,100
the water from here we start at the address of

931
00:32:51,100 --> 00:32:54,730
1,000 which is the beginning of the flu because

932
00:32:54,730 --> 00:32:57,130
it never moves and simply we will

933
00:32:57,130 --> 00:32:58,840
generate 1 p the other you see can  -be

934
00:32:58,840 --> 00:33:01,050
I passed

935
00:33:01,050 --> 00:33:04,480
no separable cursor my congeners

936
00:33:04,480 --> 00:33:05,920
the p l'aude which will be a heart the least

937
00:33:05,920 --> 00:33:09,160
case with the return address hartco

938
00:33:09,160 --> 00:33:11,230
exceeds that in a way it does not move here

939
00:33:11,230 --> 00:33:12,220
I read we are really in the

940
00:33:12,220 --> 00:33:14,950
90s the ja c'  is really road put 25

941
00:33:14,950 --> 00:33:17,710
points what do not hesitate tried at

942
00:33:17,710 --> 00:33:19,180
home and suddenly at the sas is our

943
00:33:19,180 --> 00:33:20,710
peace the aude at the end it is really an

944
00:33:20,710 --> 00:33:22,540
obsolete with characters in

945
00:33:22,540 --> 00:33:24,490
occurrence b and therefore in fact we only

946
00:33:24,490 --> 00:33:26,610
bout de force our string our pointer

947
00:33:26,610 --> 00:33:28,140
to the string it can

948
00:33:28,140 --> 00:33:29,580
fall anywhere in the middle of the berries

949
00:33:29,580 --> 00:33:32,159
it's ok we just notice we have a single

950
00:33:32,159 --> 00:33:34,409
space which is at the end of the first of the

951
00:33:34,409 --> 00:33:36,990
first curl which matches the  space

952
00:33:36,990 --> 00:33:38,029
needed

953
00:33:38,029 --> 00:33:40,200
to separate the two

954
00:33:40,200 --> 00:33:42,149
strings that go to blurry green and

955
00:33:42,149 --> 00:33:44,130
actually we can  see the xxi here it is the

956
00:33:44,130 --> 00:33:46,769
bytes and the low bytes of

957
00:33:46,769 --> 00:33:49,470
the value r4 that records when while

958
00:33:49,470 --> 00:33:51,899
we control and at the end we see an f

959
00:33:51,899 --> 00:33:53,519
then other non-

960
00:33:53,519 --> 00:33:54,750
printable characters but which corresponds to

961
00:33:54,750 --> 00:33:56,429
the  address of the returns that we

962
00:33:56,429 --> 00:33:59,340
also control here little brawl if you are going

963
00:33:59,340 --> 00:34:00,950
to play a little

964
00:34:00,950 --> 00:34:02,880
game not if you have already done a

965
00:34:02,880 --> 00:34:04,710
little command injection etc. often we have

966
00:34:04,710 --> 00:34:06,210
the case where we cannot inject a space

967
00:34:06,210 --> 00:34:08,399
here is our script which  does curl

968
00:34:08,399 --> 00:34:10,619
dollars the buttocks of wealth it is

969
00:34:10,619 --> 00:34:13,800
a variable the one that contains

970
00:34:13,800 --> 00:34:15,330
non-printable characters so here

971
00:34:15,330 --> 00:34:16,649
it allows us to lease past this

972
00:34:16,649 --> 00:34:18,449
constraint where we are not allowed to

973
00:34:18,449 --> 00:34:20,099
put spaces is what we do in  done

974
00:34:20,099 --> 00:34:21,510
it's instead of doing a

975
00:34:21,510 --> 00:34:24,418
complete peno because it's a bit long we make

976
00:34:24,418 --> 00:34:26,940
him download a hope on

977
00:34:26,940 --> 00:34:28,800
blog.com so such a request is there we

978
00:34:28,800 --> 00:34:29,879
are at home we say boby lapointe as

979
00:34:29,879 --> 00:34:32,280
it comes to us  and we pack it in the

980
00:34:32,280 --> 00:34:35,369
chain and runs we could have greatly

981
00:34:35,369 --> 00:34:37,339
reduced the  size

982
00:34:37,339 --> 00:34:41,839
of the pylon but the sector

983
00:34:41,839 --> 00:34:44,429
that's our sprite so what

984
00:34:44,429 --> 00:34:46,440
's been 12 years since we had no place

985
00:34:46,440 --> 00:34:47,879
in the debate at masi now

986
00:34:47,879 --> 00:34:49,770
download a saucats saucats if you do

987
00:34:49,770 --> 00:34:51,389
n't know it's a utility  linux

988
00:34:51,389 --> 00:34:53,489
which allows you to do a lot of

989
00:34:53,489 --> 00:34:56,190
things related to sockets and in

990
00:34:56,190 --> 00:34:57,900
this case allows us to pump

991
00:34:57,900 --> 00:35:00,930
a sky raid so here we make

992
00:35:00,930 --> 00:35:03,300
sure to run it socata line

993
00:35:03,300 --> 00:35:05,700
12 saying here you are every

994
00:35:05,700 --> 00:35:08,880
every connection  no, that reverses a

995
00:35:08,880 --> 00:35:10,320
virtual one so instead of said go you

996
00:35:10,320 --> 00:35:12,150
run business h and you will

997
00:35:12,150 --> 00:35:15,330
connect to tell tale attali peace and

998
00:35:15,330 --> 00:35:17,369
finally to put a little bit of

999
00:35:17,369 --> 00:35:19,740
spice for people on powerpoint word

1000
00:35:19,740 --> 00:35:22,260
on the spot in light the leds are the

1001
00:35:22,260 --> 00:35:24,510
infinity ponds and it's been a little

1002
00:35:24,510 --> 00:35:26,330
a little thing like that

1003
00:35:26,330 --> 00:35:28,530
so that's true that's the

1004
00:35:28,530 --> 00:35:29,970
organizers who took the video they

1005
00:35:29,970 --> 00:35:30,839
were all crazy they were in

1006
00:35:30,839 --> 00:35:33,119
pure mode and me because I don't know if I

1007
00:35:33,119 --> 00:35:34,140
say them but in fact you see there were

1008
00:35:34,140 --> 00:35:36,930
four participants  on the wan of this

1009
00:35:36,930 --> 00:35:39,210
is not to say is celebrating we we

1010
00:35:39,210 --> 00:35:40,890
went to fourth position it's pure

1011
00:35:40,890 --> 00:35:43,049
and 1 goes fourth frankly the

1012
00:35:43,049 --> 00:35:44,670
guys who go they go they go the pt

1013
00:35:44,670 --> 00:35:46,170
before us they have the same city as

1014
00:35:46,170 --> 00:35:47,819
us  we're not going to get the reward, it

1015
00:35:47,819 --> 00:35:49,770
's screwed and in fact I really do

1016
00:35:49,770 --> 00:35:52,049
n't know what happened but I

1017
00:35:52,049 --> 00:35:53,460
guess that the guys before him had

1018
00:35:53,460 --> 00:35:55,559
done their set up badly and that suddenly it's going to

1019
00:35:55,559 --> 00:35:58,559
work, but too bad, but so much the

1020
00:35:58,559 --> 00:36:00,799
better  for us

1021
00:36:00,799 --> 00:36:02,910
so now how they fixed that

1022
00:36:02,910 --> 00:36:05,700
so the obvious thing is to remove the

1023
00:36:05,700 --> 00:36:06,650
least k

1024
00:36:06,650 --> 00:36:08,910
way since now check the

1025
00:36:08,910 --> 00:36:10,589
certificates and now it even gives

1026
00:36:10,589 --> 00:36:13,380
a list of valid certificates so that

1027
00:36:13,380 --> 00:36:15,539
's good how do their flows correct well

1028
00:36:15,539 --> 00:36:18,230
we can add  in the in the

1029
00:36:18,230 --> 00:36:21,059
format of string % s we can

1030
00:36:21,059 --> 00:36:22,530
add to it the maximum number of characters

1031
00:36:22,530 --> 00:36:24,059
we want to read so here they said

1032
00:36:24,059 --> 00:36:26,160
here we read a maximum of 255 so we

1033
00:36:26,160 --> 00:36:27,170
are safe

1034
00:36:27,170 --> 00:36:29,490
255 because this case is not done add

1035
00:36:29,490 --> 00:36:33,030
a  last null bytes which corresponds  lays

1036
00:36:33,030 --> 00:36:35,569
the character string at the end, on the

1037
00:36:35,569 --> 00:36:38,339
other hand, we weren't expecting

1038
00:36:38,339 --> 00:36:39,930
miracles, the guys who are going to perfect

1039
00:36:39,930 --> 00:36:42,900
all their infra because of us, but there's

1040
00:36:42,900 --> 00:36:44,069
still no dunning art and

1041
00:36:44,069 --> 00:36:45,690
still no protection, the binaries

1042
00:36:45,690 --> 00:36:46,980
and still running  road there we are

1043
00:36:46,980 --> 00:36:49,940
still at home something a little

1044
00:36:49,940 --> 00:36:52,650
embarrassing is that we are in 2022

1045
00:36:52,650 --> 00:36:54,180
normally today you install

1046
00:36:54,180 --> 00:36:57,029
a linux your gcc by default it compiles

1047
00:36:57,029 --> 00:37:00,890
with canary support so if

1048
00:37:00,890 --> 00:37:02,910
there in this case it is  still no

1049
00:37:02,910 --> 00:37:04,440
canaille support and it's a bit

1050
00:37:04,440 --> 00:37:07,650
how I would say it's disturbing but

1051
00:37:07,650 --> 00:37:08,730
because that means that the

1052
00:37:08,730 --> 00:37:10,349
guys have explicitly deactivated

1053
00:37:10,349 --> 00:37:12,380
the canaries in which case too

1054
00:37:12,380 --> 00:37:15,569
bad either the guys compile with a

1055
00:37:15,569 --> 00:37:17,279
gcc which really dates it  a very

1056
00:37:17,279 --> 00:37:18,779
long time ago and in which case it's a little

1057
00:37:18,779 --> 00:37:20,390
worrying but it's not

1058
00:37:20,390 --> 00:37:23,130
fun fact when we tried to unlock

1059
00:37:23,130 --> 00:37:25,260
a loan our feat since even if

1060
00:37:25,260 --> 00:37:26,279
it's easy it's always nice

1061
00:37:26,279 --> 00:37:29,130
to have access to geneva and we have  since

1062
00:37:29,130 --> 00:37:30,869
there was a little  anti bugs in the

1063
00:37:30,869 --> 00:37:32,789
binary so here what do they have

1064
00:37:32,789 --> 00:37:35,670
as a technique for anti bugs low for

1065
00:37:35,670 --> 00:37:37,410
example they will look if we have the

1066
00:37:37,410 --> 00:37:38,940
environment variable cap or

1067
00:37:38,940 --> 00:37:41,099
lines I don't know if we have who see it

1068
00:37:41,099 --> 00:37:42,900
come but in fact that the oms and lines

1069
00:37:42,900 --> 00:37:45,480
when you launch a gdv gdb confusing

1070
00:37:45,480 --> 00:37:46,829
its environment to add these two

1071
00:37:46,829 --> 00:37:48,510
serious environment and say here is

1072
00:37:48,510 --> 00:37:50,130
your finished it does in 2 min in two

1073
00:37:50,130 --> 00:37:52,349
columns moreover that's often

1074
00:37:52,349 --> 00:37:53,700
why  when you launch a

1075
00:37:53,700 --> 00:37:55,200
danger bays sprite and after you

1076
00:37:55,200 --> 00:37:57,180
launch out of gdb if you go to

1077
00:37:57,180 --> 00:37:58,740
code addresses on the stac but in fact it

1078
00:37:58,740 --> 00:38:00,510
moves a little surely it's because of

1079
00:38:00,510 --> 00:38:03,000
these variables so here they

1080
00:38:03,000 --> 00:38:04,710
go  'anti bugs like that false identity

1081
00:38:04,710 --> 00:38:06,720
bug it checks that the name of the trial

1082
00:38:06,720 --> 00:38:08,520
what you launched its pages and

1083
00:38:08,520 --> 00:38:11,040
berries or and rhinestones or it traces bah

1084
00:38:11,040 --> 00:38:12,569
yeah ok that's cool but me eat

1085
00:38:12,569 --> 00:38:15,240
berries if I want them  call gta it

1086
00:38:15,240 --> 00:38:16,160
works

1087
00:38:16,160 --> 00:38:18,510
it also needs a check for

1088
00:38:18,510 --> 00:38:22,020
loading bi  library in hand

1089
00:38:22,020 --> 00:38:24,119
with ld preload if you do not know

1090
00:38:24,119 --> 00:38:25,140
the technique it is a technique which

1091
00:38:25,140 --> 00:38:26,490
allows you to tell the linkers when you

1092
00:38:26,490 --> 00:38:28,740
execute a binary to go to have

1093
00:38:28,740 --> 00:38:29,970
loaded a library that you

1094
00:38:29,970 --> 00:38:32,250
control then to execute the binary

1095
00:38:32,250 --> 00:38:33,690
which allows  in fact to do

1096
00:38:33,690 --> 00:38:35,460
function jogging for example so here he

1097
00:38:35,460 --> 00:38:37,670
founded detection like that

1098
00:38:37,670 --> 00:38:39,960
but why it's funny because

1099
00:38:39,960 --> 00:38:41,040
when I say it in fact the dishes

1100
00:38:41,040 --> 00:38:45,180
they saw there they did not activate kiso

1101
00:38:45,180 --> 00:38:47,940
not the measurements  basic that we

1102
00:38:47,940 --> 00:38:48,930
could have if only to let it

1103
00:38:48,930 --> 00:38:51,030
go again to install linux in slr complete

1104
00:38:51,030 --> 00:38:53,339
the basic that they do not have but on the

1105
00:38:53,339 --> 00:38:55,079
other hand they take time to

1106
00:38:55,079 --> 00:38:56,490
put blue lenses in place which in

1107
00:38:56,490 --> 00:38:59,609
l  This occurrence is rare for finally and

1108
00:38:59,609 --> 00:39:01,670
not very effective

1109
00:39:01,670 --> 00:39:05,400
so to complete our exploit is

1110
00:39:05,400 --> 00:39:07,880
available at this address on github

1111
00:39:07,880 --> 00:39:11,130
but what I mean is that we have been

1112
00:39:11,130 --> 00:39:13,049
able to show that in fact it is possible

1113
00:39:13,049 --> 00:39:14,880
to have the  'remote code execution

1114
00:39:14,880 --> 00:39:18,450
on a router ok ok I admit it  the case

1115
00:39:18,450 --> 00:39:19,920
is not super realistic in the sense that

1116
00:39:19,920 --> 00:39:21,690
you will not be able to think

1117
00:39:21,690 --> 00:39:23,520
up to someone else's level because there

1118
00:39:23,520 --> 00:39:25,500
is this notion of man and melodrama but

1119
00:39:25,500 --> 00:39:27,119
all the same here it

1120
00:39:27,119 --> 00:39:29,640
is things it is  possible thing in this case

1121
00:39:29,640 --> 00:39:31,579
we had two serious ones which were attributed

1122
00:39:31,579 --> 00:39:34,200
so not from your authors if you

1123
00:39:34,200 --> 00:39:37,410
have any and simply to finish I

1124
00:39:37,410 --> 00:39:39,210
wanted to say that to shoot in fact

1125
00:39:39,210 --> 00:39:41,520
it is a competition which perhaps

1126
00:39:41,520 --> 00:39:42,750
you already have some  heard about it and we

1127
00:39:42,750 --> 00:39:43,799
see guys who really do

1128
00:39:43,799 --> 00:39:46,410
crazy stuff but you have to remember that there

1129
00:39:46,410 --> 00:39:49,349
is stuff accessible everywhere no

1130
00:39:49,349 --> 00:39:51,869
matter when and frankly I

1131
00:39:51,869 --> 00:39:53,640
think it's worth watching here

1132
00:39:53,640 --> 00:39:55,559
you have 30 days if you're hot

1133
00:39:55,559 --> 00:39:57,240
can anticipate targets and

1134
00:39:57,240 --> 00:39:59,339
take more time but

1135
00:39:59,339 --> 00:40:01,700
here are accessible things

1136
00:40:01,700 --> 00:40:03,560
that are real targets that can be

1137
00:40:03,560 --> 00:40:06,320
found in real life often they

1138
00:40:06,320 --> 00:40:10,220
have huge attack surfaces and here I

1139
00:40:10,220 --> 00:40:11,240
invite you to try if that  you are

1140
00:40:11,240 --> 00:40:11,890
interested

1141
00:40:11,890 --> 00:40:13,850
in  there in this case for his assets

1142
00:40:13,850 --> 00:40:14,840
it's a very good year since we

1143
00:40:14,840 --> 00:40:16,760
were eleven people from the box to

1144
00:40:16,760 --> 00:40:19,490
participate in the contest and we were

1145
00:40:19,490 --> 00:40:21,470
the worst team which collected the most

1146
00:40:21,470 --> 00:40:23,710
points so here is rather gratifying

1147
00:40:23,710 --> 00:40:25,400
so I tell you  thank you for your attention

1148
00:40:25,400 --> 00:40:26,930
and now if you have any questions

1149
00:40:26,930 --> 00:40:28,550
do not hesitate I would be happy to

1150
00:40:28,550 --> 00:40:29,410
answer them thank you

1151
00:40:29,410 --> 00:40:38,420
[Applause] does

1152
00:40:38,420 --> 00:40:41,990
anyone have a question

1153
00:40:50,370 --> 00:40:52,230
so thank you for this

1154
00:40:52,230 --> 00:40:53,700
presentation me the question is more

1155
00:40:53,700 --> 00:40:55,290
surprising him-  even do you have

1156
00:40:55,290 --> 00:40:57,210
access to the devices suddenly for 30

1157
00:40:57,210 --> 00:40:59,180
days or not

1158
00:40:59,180 --> 00:41:02,520
well the case we did not

1159
00:41:02,520 --> 00:41:04,830
you have to belong to the tribe and suddenly you had to

1160
00:41:04,830 --> 00:41:06,030
buy a version of the router before

1161
00:41:06,030 --> 00:41:07,680
to be able to work on it and after

1162
00:41:07,680 --> 00:41:11,779
exactly  it works thank you

1163
00:41:19,170 --> 00:41:21,890
someone else

1164
00:41:26,470 --> 00:41:28,420
very well we will

1165
00:41:28,420 --> 00:41:31,000
warmly thank in title small and kévin

1166
00:41:31,000 --> 00:41:35,190
denis thanks to you become

1167
00:41:35,190 --> 00:41:38,760
tons than 20th game

