1
00:00:00,000 --> 00:00:03,110
well I'm going to talk about them and it pays off in

2
00:00:03,110 --> 00:00:05,460
particular for a rather

3
00:00:05,460 --> 00:00:07,259
special component called its focus and

4
00:00:07,259 --> 00:00:10,190
drone but not that you're going to see

5
00:00:10,190 --> 00:00:12,420
who say that dies there is no

6
00:00:12,420 --> 00:00:14,280
sand system that has been mistreated during its

7
00:00:14,280 --> 00:00:15,800
research

8
00:00:15,800 --> 00:00:18,090
so my name is yvan generate I

9
00:00:18,090 --> 00:00:19,590
work at in abscissa in abscissa

10
00:00:19,590 --> 00:00:20,970
and a company that

11
00:00:20,970 --> 00:00:23,699
specializes in security and rhdp in

12
00:00:23,699 --> 00:00:26,189
general and its particular pair my

13
00:00:26,189 --> 00:00:29,149
job is to find come true

14
00:00:29,149 --> 00:00:31,140
here I have already found some

15
00:00:31,140 --> 00:00:32,668
since  a few years in fact all that

16
00:00:32,668 --> 00:00:36,030
is only on sand here it is me

17
00:00:36,030 --> 00:00:38,550
I do I only do that so if you have

18
00:00:38,550 --> 00:00:40,489
any questions on that here

19
00:00:40,489 --> 00:00:42,449
it is the summary for today so

20
00:00:42,449 --> 00:00:43,500
very quickly I represented

21
00:00:43,500 --> 00:00:45,059
present what is its focus

22
00:00:45,059 --> 00:00:47,370
and run or is it actually presented

23
00:00:47,370 --> 00:00:49,170
in an environment and it pays

24
00:00:49,170 --> 00:00:50,909
what we found on it you

25
00:00:50,909 --> 00:00:54,119
will see it's not crazy but after  there

26
00:00:54,119 --> 00:00:55,320
is a third part in fact I will

27
00:00:55,320 --> 00:00:57,390
describe four truths that we have  found

28
00:00:57,390 --> 00:00:58,439
in recent years that they are not

29
00:00:58,439 --> 00:00:59,519
directly related to the soft which is

30
00:00:59,519 --> 00:01:01,350
funny but that you will understand

31
00:01:01,350 --> 00:01:03,059
why we can use them afterwards to

32
00:01:03,059 --> 00:01:04,140
understand that the know that his dreads

33
00:01:04,140 --> 00:01:06,390
in itself a small part sure we will

34
00:01:06,390 --> 00:01:09,180
list all the  all the patches and the

35
00:01:09,180 --> 00:01:11,009
work haroun that exist etc etc to

36
00:01:11,009 --> 00:01:12,960
try to secure all that and on the

37
00:01:12,960 --> 00:01:15,140
platinum gone

38
00:01:15,140 --> 00:01:17,009
since he has who don't know what it is

39
00:01:17,009 --> 00:01:20,540
and it pays to raise your hand to see

40
00:01:20,540 --> 00:01:23,150
two less and less

41
00:01:23,150 --> 00:01:26,159
good and that's it  in fact it's to run the

42
00:01:26,159 --> 00:01:27,570
world

43
00:01:27,570 --> 00:01:30,180
it's business management software packages

44
00:01:30,180 --> 00:01:32,159
so basically here you

45
00:01:32,159 --> 00:01:33,659
have your systems your databases

46
00:01:33,659 --> 00:01:34,830
there are apps above and when we

47
00:01:34,830 --> 00:01:36,180
talk about apps in fact the apps

48
00:01:36,180 --> 00:01:37,010
it's

49
00:01:37,010 --> 00:01:39,540
99% of the time it's sap basically all

50
00:01:39,540 --> 00:01:40,979
the cac40 uses them sand for

51
00:01:40,979 --> 00:01:43,650
example etc etc so in fact it's

52
00:01:43,650 --> 00:01:46,229
business apps and we call that

53
00:01:46,229 --> 00:01:47,900
business apps

54
00:01:47,900 --> 00:01:51,030
I'm not going to dwell on that

55
00:01:51,030 --> 00:01:52,530
what  i would like to show did it just

56
00:01:52,530 --> 00:01:53,610
for you mon  rer how

57
00:01:53,610 --> 00:01:55,410
very heterogeneous the systems are and it

58
00:01:55,410 --> 00:01:58,680
therefore pays for the [ __ ] mold and we have several we have

59
00:01:58,680 --> 00:01:59,940
a company we have several

60
00:01:59,940 --> 00:02:01,890
sap systems so there you go I took you over

61
00:02:01,890 --> 00:02:03,710
that's how it works on a

62
00:02:03,710 --> 00:02:06,450
lot of f  linux unites

63
00:02:06,450 --> 00:02:09,300
windows and so on when we talk about

64
00:02:09,300 --> 00:02:11,250
the east sap and there is always a base

65
00:02:11,250 --> 00:02:12,180
something called stats

66
00:02:12,180 --> 00:02:13,739
netweaver so there are two versions of

67
00:02:13,739 --> 00:02:15,420
sap netweaver sap netweaver I swallow that

68
00:02:15,420 --> 00:02:16,920
you won't find any  applaud estac beats

69
00:02:16,920 --> 00:02:18,690
it's the 2 at the same time and in fact we

70
00:02:18,690 --> 00:02:20,580
can present them like that on a

71
00:02:20,580 --> 00:02:22,200
system and it pays you have to imagine we have

72
00:02:22,200 --> 00:02:23,700
this base which is the same all the time

73
00:02:23,700 --> 00:02:26,790
and after above we will we will install

74
00:02:26,790 --> 00:02:30,150
or  in fact added products here and there

75
00:02:30,150 --> 00:02:33,530
we are going to talk about sap erp and crm

76
00:02:33,530 --> 00:02:36,269
mobileye etc and so that's where I

77
00:02:36,269 --> 00:02:37,980
tried again to represent

78
00:02:37,980 --> 00:02:40,200
what it can be in an

79
00:02:40,200 --> 00:02:41,730
environment with more business here

80
00:02:41,730 --> 00:02:43,440
we are  two the rp we had to crm we have

81
00:02:43,440 --> 00:02:45,810
things like that some of these systems

82
00:02:45,810 --> 00:02:47,640
like  the portal for example but in

83
00:02:47,640 --> 00:02:49,470
fact yielded sap systems and which are

84
00:02:49,470 --> 00:02:50,579
destined to be connected to the internet for

85
00:02:50,579 --> 00:02:53,070
example and other lows which will do

86
00:02:53,070 --> 00:02:56,000
more than stock management etc etc

87
00:02:56,000 --> 00:02:58,290
there I just represented for example the

88
00:02:58,290 --> 00:02:59,940
products you need  imagine that for each

89
00:02:59,940 --> 00:03:01,049
system but it pays you have

90
00:03:01,049 --> 00:03:02,790
the equivalent in dev in integration in

91
00:03:02,790 --> 00:03:04,650
pre prod and so on and so on so if

92
00:03:04,650 --> 00:03:05,910
you start to have several

93
00:03:05,910 --> 00:03:07,410
products and it pays you immediately have

94
00:03:07,410 --> 00:03:10,079
50 systems and sap and to manage it

95
00:03:10,079 --> 00:03:12,090
can be  quite complicated what is this case

96
00:03:12,090 --> 00:03:13,590
what is what has

97
00:03:13,590 --> 00:03:15,239
appeared quite a long time ago in fact it is

98
00:03:15,239 --> 00:03:16,739
the admins rather to connect to

99
00:03:16,739 --> 00:03:18,510
each system to be able to the

100
00:03:18,510 --> 00:03:19,739
administered have they will connect to

101
00:03:19,739 --> 00:03:22,440
a  only system that will be special

102
00:03:22,440 --> 00:03:24,299
is a little bit different and that makes it a

103
00:03:24,299 --> 00:03:25,489
system to be able

104
00:03:25,489 --> 00:03:27,540
to remotely administer all the other

105
00:03:27,540 --> 00:03:30,390
systems so it is this system it

106
00:03:30,390 --> 00:03:31,970
was called the solution manager stadium

107
00:03:31,970 --> 00:03:34,260
so it is a system that is

108
00:03:34,260 --> 00:03:36,390
j  did not find the date  of release but

109
00:03:36,390 --> 00:03:39,060
in the end it's in five years and so we

110
00:03:39,060 --> 00:03:40,140
could represent them like that so

111
00:03:40,140 --> 00:03:41,340
the simple solution manager is a

112
00:03:41,340 --> 00:03:43,680
sap system so it has a sap base

113
00:03:43,680 --> 00:03:46,230
netweaver adapted java and the admins

114
00:03:46,230 --> 00:03:47,849
will connect to its solution manager  to be

115
00:03:47,849 --> 00:03:48,840
able to carry out

116
00:03:48,840 --> 00:03:50,640
administration activities on all the other

117
00:03:50,640 --> 00:03:53,579
systems, create users, prepare two

118
00:03:53,579 --> 00:03:55,099
other aids, etc.,

119
00:03:55,099 --> 00:03:57,629
so we have already studied this sand

120
00:03:57,629 --> 00:03:59,220
solution manager two years ago.

121
00:03:59,220 --> 00:04:01,530


122
00:04:01,530 --> 00:04:03,720
to be

123
00:04:03,720 --> 00:04:05,939
authenticated we could attack this

124
00:04:05,939 --> 00:04:07,349
solution manager and execute

125
00:04:07,349 --> 00:04:09,299
os commands on all the sap systems

126
00:04:09,299 --> 00:04:12,780
of the landscape and after we had found

127
00:04:12,780 --> 00:04:14,760
alpes and harout also using

128
00:04:14,760 --> 00:04:17,279
agents of agents and it pays well it

129
00:04:17,279 --> 00:04:19,910
had broken that's good

130
00:04:19,910 --> 00:04:23,060
for  that we are

131
00:04:23,060 --> 00:04:26,699
working on it in 2020 so s ab has

132
00:04:26,699 --> 00:04:27,690
released a new product

133
00:04:27,690 --> 00:04:29,940
called soft focus and drains know that these

134
00:04:29,940 --> 00:04:30,889
drones

135
00:04:30,889 --> 00:04:33,860
roughly speaking it can be the replacement

136
00:04:33,860 --> 00:04:37,289
for du  hot sand and its manager so we

137
00:04:37,289 --> 00:04:38,520
find out a little bit quickly

138
00:04:38,520 --> 00:04:39,810
so that's what we're going to talk about

139
00:04:39,810 --> 00:04:40,800
today that's why they were

140
00:04:40,800 --> 00:04:41,720
surrounded

141
00:04:41,720 --> 00:04:45,449
so it's a product that is young in the

142
00:04:45,449 --> 00:04:46,949
world of trees here are these releases in

143
00:04:46,949 --> 00:04:49,199
2020 there is none it's the top still

144
00:04:49,199 --> 00:04:51,870
there was only one goddess sncd sand

145
00:04:51,870 --> 00:04:53,310
security note therefore the

146
00:04:53,310 --> 00:04:55,560
undermining security patches and when we read a

147
00:04:55,560 --> 00:04:56,910
little bit the documentation below we

148
00:04:56,910 --> 00:04:59,039
understand that it's a list is a spin

149
00:04:59,039 --> 00:04:59,900
off

150
00:04:59,900 --> 00:05:02,430
du du sap manager solution so we

151
00:05:02,430 --> 00:05:04,050
imagine it's a bit like sand

152
00:05:04,050 --> 00:05:05,910
manager solution it's going to be a

153
00:05:05,910 --> 00:05:09,349
system it's going to be a system

154
00:05:09,349 --> 00:05:11,220
what we call a

155
00:05:11,220 --> 00:05:12,570
technical system so there's no business

156
00:05:12,570 --> 00:05:14,910
in it though  bas made a system

157
00:05:14,910 --> 00:05:16,590
where the administrators will see them

158
00:05:16,590 --> 00:05:18,539
using this sap system to be able to

159
00:05:18,539 --> 00:05:19,409
manage all the others so

160
00:05:19,409 --> 00:05:22,590
potentially these systems like the

161
00:05:22,590 --> 00:05:24,090
pop star a new coronation from his manager

162
00:05:24,090 --> 00:05:26,430
they have high rights on all the

163
00:05:26,430 --> 00:05:27,860
other systems

164
00:05:27,860 --> 00:05:30,090
then low in the doc  here it was said

165
00:05:30,090 --> 00:05:32,030
that there was a small

166
00:05:32,030 --> 00:05:33,850
level of security

167
00:05:33,850 --> 00:05:35,840
important so it was important to

168
00:05:35,840 --> 00:05:39,160
look suddenly we looked

169
00:05:39,160 --> 00:05:40,940
we still found a few little

170
00:05:40,940 --> 00:05:42,040
things otherwise I wouldn't be there I think

171
00:05:42,040 --> 00:05:44,480
so after his resemblance connect here

172
00:05:44,480 --> 00:05:46,280
it looks like that  so there this nice one we have

173
00:05:46,280 --> 00:05:47,690
a small admin portal we can do a

174
00:05:47,690 --> 00:05:49,010
lot of things we realize that

175
00:05:49,010 --> 00:05:50,230
really

176
00:05:50,230 --> 00:05:52,190
we had already worked on sap solution

177
00:05:52,190 --> 00:05:53,660
manager so it still looks like a

178
00:05:53,660 --> 00:05:54,610
lot

179
00:05:54,610 --> 00:05:58,010
and quite quickly we understand one thing in

180
00:05:58,010 --> 00:05:59,270
fact it is that  it is much

181
00:05:59,270 --> 00:06:00,770
simpler so its focus and drone is

182
00:06:00,770 --> 00:06:02,240
much simpler than the ground

183
00:06:02,240 --> 00:06:04,460
manager solution there is not the whole

184
00:06:04,460 --> 00:06:06,410
java layer that saab on the high-speed line is the only

185
00:06:06,410 --> 00:06:08,650
manager solution he

186
00:06:08,650 --> 00:06:11,750
adds little bits of vw and that  is all that

187
00:06:11,750 --> 00:06:13,160
there is more it is really much

188
00:06:13,160 --> 00:06:15,740
simpler communication also the only

189
00:06:15,740 --> 00:06:17,060
solution manager and that he used

190
00:06:17,060 --> 00:06:18,950
something called the sapeur fc there is

191
00:06:18,950 --> 00:06:20,390
no more there is no longer the pkk who could do

192
00:06:20,390 --> 00:06:22,540
everything  that suddenly there

193
00:06:22,540 --> 00:06:24,530
the surface datta k  hey and it's

194
00:06:24,530 --> 00:06:28,480
really really well reduced and

195
00:06:28,480 --> 00:06:31,580
that's not so bad it's the

196
00:06:31,580 --> 00:06:32,870
system still seems a little more robust

197
00:06:32,870 --> 00:06:34,850
when I say basically reduced that's it

198
00:06:34,850 --> 00:06:37,130
so if we activate all the services that

199
00:06:37,130 --> 00:06:38,990
are in  related to its focus and run

200
00:06:38,990 --> 00:06:41,000
on the machine we get about 130

201
00:06:41,000 --> 00:06:43,730
urls that we can attack

202
00:06:43,730 --> 00:06:45,320
there is no sense of service is as we

203
00:06:45,320 --> 00:06:46,370
could find on the sand worrying

204
00:06:46,370 --> 00:06:49,520
manager or there were  full etc etc and

205
00:06:49,520 --> 00:06:54,200
everything 99 9% is authenticated we

206
00:06:54,200 --> 00:06:56,630
tested everything we all looked we did

207
00:06:56,630 --> 00:06:57,400


208
00:06:57,400 --> 00:07:00,310
n't find much not really found much

209
00:07:00,310 --> 00:07:03,020
at work or even several a good

210
00:07:03,020 --> 00:07:05,570
time on it and the mini first blood is

211
00:07:05,570 --> 00:07:08,300
a  small xss must be authenticated it

212
00:07:08,300 --> 00:07:11,350
is in post mode so good luck

213
00:07:11,350 --> 00:07:13,490
you continue to search a little bit

214
00:07:13,490 --> 00:07:15,560
in fact we still find an xss so

215
00:07:15,560 --> 00:07:17,120
this one has a little more serious that's what

216
00:07:17,120 --> 00:07:19,090
we call us eh

217
00:07:19,090 --> 00:07:19,800
to

218
00:07:19,800 --> 00:07:22,360
a pity  collateral because in fact

219
00:07:22,360 --> 00:07:24,000
it is an excess ceases in the fiori sand

220
00:07:24,000 --> 00:07:26,940
so its fury is the

221
00:07:26,940 --> 00:07:29,860
html5 interface  Undermining the pretty interface is

222
00:07:29,860 --> 00:07:31,030
therefore in fact we were looking in the soft

223
00:07:31,030 --> 00:07:32,380
focus and drone and we found an excess

224
00:07:32,380 --> 00:07:34,150
ceases in the fury bag suddenly the impact

225
00:07:34,150 --> 00:07:36,400
is not that foxes and that is not its

226
00:07:36,400 --> 00:07:38,199
focus and drugs  it's really all those

227
00:07:38,199 --> 00:07:39,490
who use his fury, that is to say almost

228
00:07:39,490 --> 00:07:42,580
all sap systems and after several

229
00:07:42,580 --> 00:07:44,050
weeks that's about all we have

230
00:07:44,050 --> 00:07:46,120
n't found much has still two or

231
00:07:46,120 --> 00:07:47,050
three other things but really

232
00:07:47,050 --> 00:07:48,490
really don't see anything d  interesting

233
00:07:48,490 --> 00:07:51,340
so very we are quite surprised by the

234
00:07:51,340 --> 00:07:53,470
level of security in fact of this

235
00:07:53,470 --> 00:07:55,650
focus and run it is rather rather

236
00:07:55,650 --> 00:07:58,600
high suddenly we are not discouraged but we say

237
00:07:58,600 --> 00:08:00,280
well now we are going to be interested in

238
00:08:00,280 --> 00:08:01,780
communication that is what had  is

239
00:08:01,780 --> 00:08:03,790
lacking in any case previously on the

240
00:08:03,790 --> 00:08:05,620
sand solution manager among others so

241
00:08:05,620 --> 00:08:08,410
we will say to ourselves well here is how do you know

242
00:08:08,410 --> 00:08:10,479
how he manages to do all that there on

243
00:08:10,479 --> 00:08:11,740
the systems because in fact his

244
00:08:11,740 --> 00:08:13,690
focus and drones we can we can have a

245
00:08:13,690 --> 00:08:16,080
lot  info about the

246
00:08:16,080 --> 00:08:18,880
machines the ma  chines sap snowdrifts etc

247
00:08:18,880 --> 00:08:21,550
etc so I'm simplifying the starting diagram a bit

248
00:08:21,550 --> 00:08:22,870
what we don't need

249
00:08:22,870 --> 00:08:25,870
all that we read the doc and the doc tells us well

250
00:08:25,870 --> 00:08:27,700
in fact we have to install an

251
00:08:27,700 --> 00:08:29,139
agent called the steeplechase

252
00:08:29,139 --> 00:08:30,660
diagnostic agent

253
00:08:30,660 --> 00:08:33,159
you have to install this agent everywhere

254
00:08:33,159 --> 00:08:35,080
on the systems you want to manage

255
00:08:35,080 --> 00:08:38,469
with its focus and drone very well we

256
00:08:38,469 --> 00:08:39,789
go where I go but in fact on

257
00:08:39,789 --> 00:08:41,950
two out of two machines once again

258
00:08:41,950 --> 00:08:43,390
to simplify and we will look at it

259
00:08:43,390 --> 00:08:45,730
what is this agent so here I leave its

260
00:08:45,730 --> 00:08:47,440
focus and drone on the server itself

261
00:08:47,440 --> 00:08:49,060
and we're going to watch this agent running

262
00:08:49,060 --> 00:08:51,209
without

263
00:08:51,209 --> 00:08:54,070
so we look quickly so it's

264
00:08:54,070 --> 00:08:55,209
installed in something called that

265
00:08:55,209 --> 00:08:57,400
I'm sr slash aux  checks very well

266
00:08:57,400 --> 00:08:59,200
so that in all instances and it

267
00:08:59,200 --> 00:09:00,459
pays they are installed in those

268
00:09:00,459 --> 00:09:03,940
I'm sure tried and that's when

269
00:09:03,940 --> 00:09:05,620
we check that it tilts us a

270
00:09:05,620 --> 00:09:07,540
little so their check is it's a

271
00:09:07,540 --> 00:09:09,490
component of sap that  we had already studied

272
00:09:09,490 --> 00:09:10,810
two years ago and in this one  that we in

273
00:09:10,810 --> 00:09:12,640
particular we had found anpe you

274
00:09:12,640 --> 00:09:14,980
can run from the commander route I

275
00:09:14,980 --> 00:09:15,910
'm a little parenthesis on lost

276
00:09:15,910 --> 00:09:18,089
control of control so it's

277
00:09:18,089 --> 00:09:20,740
it's a piece it's a component that

278
00:09:20,740 --> 00:09:22,420
exists in all sap systems all

279
00:09:22,420 --> 00:09:23,709
sap systems they  have to control themselves

280
00:09:23,709 --> 00:09:27,820
and lost control he is there to do what

281
00:09:27,820 --> 00:09:29,290
we call therefore all

282
00:09:29,290 --> 00:09:31,270
barcelos admin activities control

283
00:09:31,270 --> 00:09:33,080
the opposite clause be able to stop and

284
00:09:33,080 --> 00:09:34,190
start and sap and we will be able to

285
00:09:34,190 --> 00:09:35,690
monitor the database we will be

286
00:09:35,690 --> 00:09:38,210
able to prepare  notebook shelters etc

287
00:09:38,210 --> 00:09:40,790
etc so installed by default and

288
00:09:40,790 --> 00:09:42,610
it is mandatory because it uses

289
00:09:42,610 --> 00:09:45,980
its independent os it works everywhere and

290
00:09:45,980 --> 00:09:48,050
it listens on two ports the 1128 issued

291
00:09:48,050 --> 00:09:50,830
in nine games tp https

292
00:09:50,830 --> 00:09:53,990
I will come back to it later so there  I

293
00:09:53,990 --> 00:09:55,460
close the parenthesis and we dive back a

294
00:09:55,460 --> 00:09:57,140
bit there high level s to find out

295
00:09:57,140 --> 00:10:00,400
what is in this agent

296
00:10:00,400 --> 00:10:02,420
there are directories we could be a bit

297
00:10:02,420 --> 00:10:03,620
classic because we have directories

298
00:10:03,620 --> 00:10:05,720
configuration of log management am

299
00:10:05,720 --> 00:10:07,010
behind so we com  takes that it's a

300
00:10:07,010 --> 00:10:10,600
c it's a java engine etc etc in

301
00:10:10,600 --> 00:10:13,910
particular we find so in there so

302
00:10:13,910 --> 00:10:16,160
there we are in slash withers the afssaps

303
00:10:16,160 --> 00:10:19,010
this control default configuration etc we

304
00:10:19,010 --> 00:10:21,470
have a directory per application posted

305
00:10:21,470 --> 00:10:25,370
by by the agent is in  there are

306
00:10:25,370 --> 00:10:27,130
two types of

307
00:10:27,130 --> 00:10:29,300
properties files so the custom deep parties

308
00:10:29,300 --> 00:10:31,610
and let cook 2 properties there are

309
00:10:31,610 --> 00:10:33,230
about 40 configuration files

310
00:10:33,230 --> 00:10:36,190
roughly 20 custom and vinvin secure

311
00:10:36,190 --> 00:10:38,920
so in kingston it looks like

312
00:10:38,920 --> 00:10:41,260
that basically we have two teeth

313
00:10:41,260 --> 00:10:45,080
there this is an example  the aoc in clear does

314
00:10:45,080 --> 00:10:47,420
not get tired of encryption and we have for example

315
00:10:47,420 --> 00:10:50,150
all the logins the

316
00:10:50,150 --> 00:10:51,740
logging information for example to connect to

317
00:10:51,740 --> 00:10:54,560
the sap machine above the agent not

318
00:10:54,560 --> 00:10:56,120
the foxy these drugs but here we are talking about the

319
00:10:56,120 --> 00:10:57,500
machine at sap on which

320
00:10:57,500 --> 00:10:59,870
the agent is installed so we went the lever we were

321
00:10:59,870 --> 00:11:01,160
going we have ports we have stuff

322
00:11:01,160 --> 00:11:02,320
like that

323
00:11:02,320 --> 00:11:04,250
we don't have smugglers since

324
00:11:04,250 --> 00:11:05,150
colanders ten years in this

325
00:11:05,150 --> 00:11:06,680
sector other properties secure to

326
00:11:06,680 --> 00:11:08,890
prophesy looks like that

327
00:11:08,890 --> 00:11:11,420
don  that's where I can already hear one who has

328
00:11:11,420 --> 00:11:14,170
seen the taste there

329
00:11:14,170 --> 00:11:18,020
so that's the syntax it's

330
00:11:18,020 --> 00:11:19,400
a bit a bit particular but above all

331
00:11:19,400 --> 00:11:21,020
we if we jump to the eye it's well we

332
00:11:21,020 --> 00:11:23,420
have two it's a number it  there is a figure

333
00:11:23,420 --> 00:11:24,280


334
00:11:24,280 --> 00:11:27,770
in the parameters there is a bottom 64

335
00:11:27,770 --> 00:11:30,350
is in fact behind it is therefore encrypted

336
00:11:30,350 --> 00:11:33,590
and we have an algo so those who

337
00:11:33,590 --> 00:11:34,760
know me and we do the cetef with

338
00:11:34,760 --> 00:11:35,720
me they know very well that crypto

339
00:11:35,720 --> 00:11:37,490
it's not our thing that's good so

340
00:11:37,490 --> 00:11:38,600
we're going to talk about stuff that is old

341
00:11:38,600 --> 00:11:40,940
game not even how many years but

342
00:11:40,940 --> 00:11:42,220
old enough to

343
00:11:42,220 --> 00:11:44,320
understand the key as well so there we have everything

344
00:11:44,320 --> 00:11:45,280
we need we just miss the  key

345
00:11:45,280 --> 00:11:47,200
is the key is not far the key it

346
00:11:47,200 --> 00:11:48,520
is in the configuration of the money

347
00:11:48,520 --> 00:11:49,900
so always in the same place we are on

348
00:11:49,900 --> 00:11:51,250
the system there is a thing called

349
00:11:51,250 --> 00:11:53,700
master 2 strings password

350
00:11:53,700 --> 00:11:56,410
good there in 4 00 there is only sap  adm

351
00:11:56,410 --> 00:11:58,210
the user his pdm you can read that do

352
00:11:58,210 --> 00:12:01,060
n't like them it's the admin user of the

353
00:12:01,060 --> 00:12:03,010
machine so if one day you make

354
00:12:03,010 --> 00:12:04,990
pnt s  if you are his pdm normally

355
00:12:04,990 --> 00:12:07,000
it's game over and the key looks like this

356
00:12:07,000 --> 00:12:09,450
of its 205 256 characters

357
00:12:09,450 --> 00:12:12,360
a resource is going to be complicated but hey

358
00:12:12,360 --> 00:12:14,890
we do a little bit of rivers to

359
00:12:14,890 --> 00:12:16,210
understand what is the syntax a

360
00:12:16,210 --> 00:12:18,130
little sauce and  secure date properties we

361
00:12:18,130 --> 00:12:20,020
quickly understand we also find

362
00:12:20,020 --> 00:12:22,800
there to calculate the

363
00:12:22,800 --> 00:12:25,630
to calculate the to calculate the calculates a key

364
00:12:25,630 --> 00:12:26,700
derivatives according

365
00:12:26,700 --> 00:12:29,350
to the album unclassified purchases 10th not

366
00:12:29,350 --> 00:12:30,790
release by default but we had to

367
00:12:30,790 --> 00:12:33,460
force noise and therefore the

368
00:12:33,460 --> 00:12:35,110
dance and curdin parameters  property the parameter it

369
00:12:35,110 --> 00:12:36,220
was like that so we apparently you

370
00:12:36,220 --> 00:12:39,700
don't like followed by heidi modules the string

371
00:12:39,700 --> 00:12:42,670
anti flash lite lille assault and

372
00:12:42,670 --> 00:12:45,100
finally encrypt it if I go back to my

373
00:12:45,100 --> 00:12:46,480
example basically we are we have stuff like that

374
00:12:46,480 --> 00:12:47,740
so what interests us  above all

375
00:12:47,740 --> 00:12:49,480
it's going to be the balance of course and to

376
00:12:49,480 --> 00:12:51,310
encrypt and life is not because

377
00:12:51,310 --> 00:12:53,770
it allows us to check if we have done

378
00:12:53,770 --> 00:12:56,620
everything right we decipher everything

379
00:12:56,620 --> 00:12:58,750
here so as I said we had 40

380
00:12:58,750 --> 00:13:01,600
files roughly  pr  ès properties and we end

381
00:13:01,600 --> 00:13:04,720
up with 11 11 login and password we

382
00:13:04,720 --> 00:13:06,280
have login and password with

383
00:13:06,280 --> 00:13:09,699
fairly high privileges on

384
00:13:09,699 --> 00:13:11,679
the sap system on the case there is the agent

385
00:13:11,679 --> 00:13:13,149
but also on the sa focus and drones

386
00:13:13,149 --> 00:13:14,279
itself

387
00:13:14,279 --> 00:13:17,079
good ok  great but there you still had to

388
00:13:17,079 --> 00:13:19,269
be sap adm to be able to all

389
00:13:19,269 --> 00:13:21,850
the numbers and so it's still

390
00:13:21,850 --> 00:13:24,429
not obvious that's where we actually

391
00:13:24,429 --> 00:13:26,470
found a little thing but suddenly it's

392
00:13:26,470 --> 00:13:29,290
important so I'll come back to the

393
00:13:29,290 --> 00:13:31,419
communication between the sa focus and run

394
00:13:31,419 --> 00:13:32,669
and the agent

395
00:13:32,669 --> 00:13:34,569
is in fact it is not for nothing that it

396
00:13:34,569 --> 00:13:35,649
is installed in lost control it is

397
00:13:35,649 --> 00:13:37,389
because in fact it will use

398
00:13:37,389 --> 00:13:39,069
the voice control inputs to be able to

399
00:13:39,069 --> 00:13:40,480
communicate so how  it happens in

400
00:13:40,480 --> 00:13:43,899
fact the sd to he listens on port 3005

401
00:13:43,899 --> 00:13:46,299
on the local interface some veils

402
00:13:46,299 --> 00:13:47,769
then local os we can communicate

403
00:13:47,769 --> 00:13:49,929
only with local on the 3000 5 for the sdf

404
00:13:49,929 --> 00:13:51,790
is in fact when we too it will be

405
00:13:51,790 --> 00:13:53,529
fountain of  that klaus the focus is

406
00:13:53,529 --> 00:13:55,689
funny he will send http requests os

407
00:13:55,689 --> 00:13:57,249
control the to  this control in fact after

408
00:13:57,249 --> 00:13:58,839
it will just do forward os des aces

409
00:13:58,839 --> 00:14:01,290
the sdk which will do what we ask of it

410
00:14:01,290 --> 00:14:04,540
so we sniff everything a little bit and then

411
00:14:04,540 --> 00:14:06,189
there I put an example of requests so

412
00:14:06,189 --> 00:14:07,540
at the top this is what happens  on the

413
00:14:07,540 --> 00:14:08,949
control on the port one thousand one hundred and twenty

414
00:14:08,949 --> 00:14:10,299
nine and at the bottom this is what happens on

415
00:14:10,299 --> 00:14:12,129
the letting say there is a part of the url

416
00:14:12,129 --> 00:14:15,339
which is which is fired meba above all there is

417
00:14:15,339 --> 00:14:16,439
a trick

418
00:14:16,439 --> 00:14:21,389
it is could the leader authorization  for the bottom

419
00:14:21,390 --> 00:14:22,620
what does it mean that

420
00:14:22,620 --> 00:14:25,200
any user locally without any

421
00:14:25,200 --> 00:14:28,170
particular place he can communicate

422
00:14:28,170 --> 00:14:30,960
with the sdk can make requests and

423
00:14:30,960 --> 00:14:32,730
therefore can do all the activities that

424
00:14:32,730 --> 00:14:35,190
I can do the agent as sap

425
00:14:35,190 --> 00:14:37,250
adm

426
00:14:37,250 --> 00:14:40,230
so what can we do also I

427
00:14:40,230 --> 00:14:41,190
think it's very good but it does

428
00:14:41,190 --> 00:14:42,450
n't matter let's skip the details are

429
00:14:42,450 --> 00:14:43,800
available that basically we can

430
00:14:43,800 --> 00:14:45,330
list directories list the contents of

431
00:14:45,330 --> 00:14:46,190
files

432
00:14:46,190 --> 00:14:48,300
display the configuration change  the

433
00:14:48,300 --> 00:14:50,340
configuration of the agent etc etc we can

434
00:14:50,340 --> 00:14:53,240
stop the agent and

435
00:14:53,420 --> 00:14:56,100
so it's been patched now we ca

436
00:14:56,100 --> 00:14:56,900
n't do it anymore

437
00:14:56,900 --> 00:14:58,980
I put the times theme it's quite rare

438
00:14:58,980 --> 00:15:00,420
that I put it but I put it wholesale

439
00:15:00,420 --> 00:15:01,500
they took a little over a

440
00:15:01,500 --> 00:15:02,970
month to patch  it's just to say

441
00:15:02,970 --> 00:15:04,290
those who work with his 10 s battery

442
00:15:04,290 --> 00:15:07,170
support m 2 years to patch there for this one

443
00:15:07,170 --> 00:15:08,660
it was not true

444
00:15:08,660 --> 00:15:13,040
so I have a little demo if it works

445
00:15:13,040 --> 00:15:16,140
so at the top I'm connected so on

446
00:15:16,140 --> 00:15:18,680
the system  and it pays as yvan

447
00:15:18,680 --> 00:15:20,880
I don't have any particular rights I'm

448
00:15:20,880 --> 00:15:23,820
not part of the saab 6 group etc. I'm going to

449
00:15:23,820 --> 00:15:25,590
try to list and therefore the master our

450
00:15:25,590 --> 00:15:27,180
passport debates it doesn't work I do

451
00:15:27,180 --> 00:15:28,650
n't have the rights if one is well

452
00:15:28,650 --> 00:15:30,690
configured  and so suddenly what I

453
00:15:30,690 --> 00:15:31,890
can do is make local requests

454
00:15:31,890 --> 00:15:33,960
on port 3005 and there I asked him

455
00:15:33,960 --> 00:15:36,240
to display the content of the master password

456
00:15:36,240 --> 00:15:37,950
there it tells me no no no the master

457
00:15:37,950 --> 00:15:39,600
password you're nice he  is not where

458
00:15:39,600 --> 00:15:41,820
bomb is listed no problem we will take

459
00:15:41,820 --> 00:15:44,340
out the conf so we can also take

460
00:15:44,340 --> 00:15:47,190
out the configuration of the agent  we

461
00:15:47,190 --> 00:15:48,660
see that there is something called fault

462
00:15:48,660 --> 00:15:50,970
list with in fact if noah a list of

463
00:15:50,970 --> 00:15:54,210
everything that is allowed to list we are going to

464
00:15:54,210 --> 00:15:56,070
add we can modify the

465
00:15:56,070 --> 00:15:57,330
configuration so there we are going to make

466
00:15:57,330 --> 00:15:58,770
yet another request on the

467
00:15:58,770 --> 00:16:01,290
3500 bench this  times this added a parameter

468
00:16:01,290 --> 00:16:02,520
and we add what are we going to add

469
00:16:02,520 --> 00:16:03,750
as parameters we are going to add a

470
00:16:03,750 --> 00:16:06,060
second list this one it is empty,

471
00:16:06,060 --> 00:16:07,200
that is to say that in fact it accepts

472
00:16:07,200 --> 00:16:12,100
everything so we are going to relaunch

473
00:16:12,100 --> 00:16:13,870
our quest for  display content

474
00:16:13,870 --> 00:16:16,170
remains convinced this time we have it

475
00:16:16,170 --> 00:16:19,170
I'm going to put that in a file

476
00:16:19,170 --> 00:16:22,389
is there after I'm going to be able to launch a

477
00:16:22,389 --> 00:16:24,790
last request is in fact this

478
00:16:24,790 --> 00:16:27,490
request it's going to be from download is in

479
00:16:27,490 --> 00:16:29,050
fact the entire configuration of the

480
00:16:29,050 --> 00:16:31,420
sd to in principle it can do that

481
00:16:31,420 --> 00:16:34,240
too so that's rather practical so

482
00:16:34,240 --> 00:16:38,470
there I put in a zip point and after

483
00:16:38,470 --> 00:16:39,550
what I'm going to do so there it's a little

484
00:16:39,550 --> 00:16:42,190
yes after the fact I need python 3

485
00:16:42,190 --> 00:16:43,360
on  the machine did not have python 3

486
00:16:43,360 --> 00:16:44,500
so suddenly I transfer it  e all that

487
00:16:44,500 --> 00:16:48,870
locally and and after so we

488
00:16:48,870 --> 00:16:51,130
have everything we need in fact we have the key

489
00:16:51,130 --> 00:16:52,660
in the vip corner we all left Kurdish

490
00:16:52,660 --> 00:16:54,670
other properties and so that's where I'm going to

491
00:16:54,670 --> 00:16:56,680
run a script so we're going to ip it

492
00:16:56,680 --> 00:16:58,810
principle before we could see there

493
00:16:58,810 --> 00:17:00,910
we have all about partys well and so I

494
00:17:00,910 --> 00:17:02,920
'm going to run a script that will therefore

495
00:17:02,920 --> 00:17:04,990
numbers and using the master as the

496
00:17:04,990 --> 00:17:07,510
master password and and all the to of the

497
00:17:07,510 --> 00:17:09,400
secure files of property I  am going to

498
00:17:09,400 --> 00:17:11,619
make a loop which will in fact just

499
00:17:11,619 --> 00:17:13,119
decipher all the sectors in your

500
00:17:13,119 --> 00:17:14,619
parties and also display the custom for

501
00:17:14,619 --> 00:17:16,599
part history to have all the information

502
00:17:16,599 --> 00:17:19,559
and therefore there in fact locally

503
00:17:19,559 --> 00:17:22,089
on the machine as with a

504
00:17:22,089 --> 00:17:24,039
user without rights I recover  so

505
00:17:24,039 --> 00:17:26,470
about ten credentials on the

506
00:17:26,470 --> 00:17:28,990
sap systems on the server but also

507
00:17:28,990 --> 00:17:30,690
on the soft focus and run

508
00:17:30,690 --> 00:17:33,730
and cdd credential with dédé offered

509
00:17:33,730 --> 00:17:35,970
village

510
00:17:41,220 --> 00:17:42,890
so basically

511
00:17:42,890 --> 00:17:45,000
that's the thing we found on his

512
00:17:45,000 --> 00:17:46,230
focus and drone it's in  fact we

513
00:17:46,230 --> 00:17:47,429
found a generalization on the agents

514
00:17:47,429 --> 00:17:51,480
of agreement the  thing is the agents they

515
00:17:51,480 --> 00:17:54,750
are installed everywhere on all the

516
00:17:54,750 --> 00:17:56,490
systems that we want to manage so basically

517
00:17:56,490 --> 00:17:58,409
an admin he will make the request finally

518
00:17:58,409 --> 00:17:59,909
yes well himself install the agents

519
00:17:59,909 --> 00:18:03,690
everywhere suddenly the security in fact

520
00:18:03,690 --> 00:18:06,150
of the synphot qc drunk was  quite enough the

521
00:18:06,150 --> 00:18:07,470
attacking surface was still very

522
00:18:07,470 --> 00:18:09,750
limited at the start in fact it

523
00:18:09,750 --> 00:18:11,549
becomes absolutely huge because in

524
00:18:11,549 --> 00:18:13,200
fact it will depend on the security of

525
00:18:13,200 --> 00:18:15,900
each system all the systems and it

526
00:18:15,900 --> 00:18:17,290
pays

527
00:18:17,290 --> 00:18:19,900
and why I only say

528
00:18:19,900 --> 00:18:22,000
enough is in  done there I'm going to view

529
00:18:22,000 --> 00:18:23,860
we can ask ourselves the question yeah ok

530
00:18:23,860 --> 00:18:25,830
but is it so easy

531
00:18:25,830 --> 00:18:28,750
to attack a system and it pays and to be

532
00:18:28,750 --> 00:18:30,430
able to execute a request locally

533
00:18:30,430 --> 00:18:32,290
on port 3005 to be able to decipher

534
00:18:32,290 --> 00:18:34,260
the sdf

535
00:18:34,260 --> 00:18:37,750
easy or not  to spend sure but

536
00:18:37,750 --> 00:18:39,070
it is above all that in fact and it pays

537
00:18:39,070 --> 00:18:41,770
it is very very heterogeneous there is everything

538
00:18:41,770 --> 00:18:43,870
I mean there are old

539
00:18:43,870 --> 00:18:45,070
systems new systems there are systems

540
00:18:45,070 --> 00:18:47,080
exposed there are others not there  to whom

541
00:18:47,080 --> 00:18:48,370
is anything but that you are  you'll see badge

542
00:18:48,370 --> 00:18:49,600
with his lands will accept so there's

543
00:18:49,600 --> 00:18:51,700
really everything so here I'm going to

544
00:18:51,700 --> 00:18:53,230
present four truths that we found

545
00:18:53,230 --> 00:18:58,410
when I say we're our 9.6 team

546
00:18:58,410 --> 00:19:01,090
so that's not directly related to the

547
00:19:01,090 --> 00:19:03,340
focus May 7

548
00:19:03,340 --> 00:19:05,260
its  beginnings only stopped once

549
00:19:05,260 --> 00:19:07,210
we exploited them we can we can

550
00:19:07,210 --> 00:19:08,830
compromise the system and

551
00:19:08,830 --> 00:19:10,840
what can we do after ben decipher

552
00:19:10,840 --> 00:19:13,090
usd attacked the sa focus and run and

553
00:19:13,090 --> 00:19:15,480
bounce after on the set  of the park

554
00:19:15,480 --> 00:19:18,430
so the first is this one so

555
00:19:18,430 --> 00:19:19,720
they announce that they gave a

556
00:19:19,720 --> 00:19:22,080
number here it can be their icon ok

557
00:19:22,080 --> 00:19:24,280
so it's a truth that we found in

558
00:19:24,280 --> 00:19:26,410
2020 it's pablo who clicks it to

559
00:19:26,410 --> 00:19:27,580
work on it so  it's an order

560
00:19:27,580 --> 00:19:29,860
in fact it concerns the sap netweaver

561
00:19:29,860 --> 00:19:32,590
java so the java base of a lot of

562
00:19:32,590 --> 00:19:34,390
systems so everything we base it

563
00:19:34,390 --> 00:19:37,960
with the sap netweaver java system are

564
00:19:37,960 --> 00:19:40,930
vulnerable to this attack the tax is

565
00:19:40,930 --> 00:19:43,000
what in fact what is  what he saw so

566
00:19:43,000 --> 00:19:44,410
he sought to try to have a little

567
00:19:44,410 --> 00:19:45,940
all all the entry points all

568
00:19:45,940 --> 00:19:47,080
the w  eb services iis which were

569
00:19:47,080 --> 00:19:48,940
available accessible on the

570
00:19:48,940 --> 00:19:51,310
java sand and he notably found that one

571
00:19:51,310 --> 00:19:54,420
is so this is the ctc where to observe 6 and 6

572
00:19:54,420 --> 00:19:56,950
and what he saw was that and is

573
00:19:56,950 --> 00:19:59,440
accessible without being authenticated its

574
00:19:59,440 --> 00:20:00,520
cost  didn't really know if it was a big

575
00:20:00,520 --> 00:20:02,920
deal so they're a bit interested

576
00:20:02,920 --> 00:20:04,990
in all that and in fact he realizes

577
00:20:04,990 --> 00:20:06,670
that this web services with this name a

578
00:20:06,670 --> 00:20:08,770
little a little bit opening the ctc

579
00:20:08,770 --> 00:20:11,470
web services iis thingy in fact  this is the

580
00:20:11,470 --> 00:20:13,540
service that is behind a milk

581
00:20:13,540 --> 00:20:15,040
so called weezer configurations

582
00:20:15,040 --> 00:20:17,680
so the c1 of the screenshots this is

583
00:20:17,680 --> 00:20:20,110
where the admin panel from 10 to jabba

584
00:20:20,110 --> 00:20:22,300
netweaver ok i admit are admin you

585
00:20:22,300 --> 00:20:22,930
they had in  their configuration

586
00:20:22,930 --> 00:20:24,970
scenario you have to be slender in fact

587
00:20:24,970 --> 00:20:26,140
wizzards so in fact it's a list of

588
00:20:26,140 --> 00:20:28,840
tasks that will do things a wizard

589
00:20:28,840 --> 00:20:31,210
is so you know that this is the only

590
00:20:31,210 --> 00:20:33,370
scenario where you want and you are going to

591
00:20:33,370 --> 00:20:34,420
do things including  it can be

592
00:20:34,420 --> 00:20:35,800
bernadotte style it can be creating

593
00:20:35,800 --> 00:20:37,930
users it can be fa  ire of the

594
00:20:37,930 --> 00:20:40,300
post office once we have installed

595
00:20:40,300 --> 00:20:43,270
do things post installations launch

596
00:20:43,270 --> 00:20:45,910
jobs etc etc when we do the hand we

597
00:20:45,910 --> 00:20:48,790
see we have we have an opinion with a task in

598
00:20:48,790 --> 00:20:51,010
progress and it is therefore he looked a

599
00:20:51,010 --> 00:20:52,600
little bit  this web service is in fact

600
00:20:52,600 --> 00:20:54,270
he found how

601
00:20:54,270 --> 00:20:56,200
directly we could discuss with the

602
00:20:56,200 --> 00:20:57,640
webservice hoist so at the top left

603
00:20:57,640 --> 00:21:00,700
there is what we actually see in

604
00:21:00,700 --> 00:21:02,650
web services he with the syntax so

605
00:21:02,650 --> 00:21:03,790
cedus as much behind so c  it's from

606
00:21:03,790 --> 00:21:05,890
dixinn she's on the right it's

607
00:21:05,890 --> 00:21:08,230
giving up received it in fact he too he

608
00:21:08,230 --> 00:21:11,350
received it I told him so it's pretty

609
00:21:11,350 --> 00:21:13,540
cool it works after you had to

610
00:21:13,540 --> 00:21:15,290
know what can you do with that too

611
00:21:15,290 --> 00:21:16,520
so that  can we therefore make

612
00:21:16,520 --> 00:21:19,160
a parameter called paf is in it

613
00:21:19,160 --> 00:21:20,780
in fact we specify the pope of a file

614
00:21:20,780 --> 00:21:23,720
and it is files point ceproc so

615
00:21:23,720 --> 00:21:26,560
there in this example csps

616
00:21:26,560 --> 00:21:29,690
user management but here he looked

617
00:21:29,690 --> 00:21:31,250
a little bit it turns out that actually on

618
00:21:31,250 --> 00:21:33,830
the default sap machine with sap

619
00:21:33,830 --> 00:21:36,410
netweaver java you have more than  500

620
00:21:36,410 --> 00:21:38,750
ceproc files

621
00:21:38,750 --> 00:21:40,520
i.e. what i.e. remotely without being

622
00:21:40,520 --> 00:21:42,680
authenticated you have access to five hundred

623
00:21:42,680 --> 00:21:44,390
scenarios which are normally dedicated

624
00:21:44,390 --> 00:21:47,260
to admins 500 configuration of with a

625
00:21:47,260 --> 00:21:49,460
not necessarily we find one which is

626
00:21:49,460 --> 00:21:51,170
interesting which is  call creator of

627
00:21:51,170 --> 00:21:53,780
the user you provide the

628
00:21:53,780 --> 00:21:55,010
user name you provide the

629
00:21:55,010 --> 00:21:56,420
password and you tell him what role he

630
00:21:56,420 --> 00:21:57,850
has

631
00:21:57,850 --> 00:22:00,980
oa zar administrators as role and well

632
00:22:00,980 --> 00:22:03,760
all that without being authenticated

633
00:22:03,760 --> 00:22:07,370
it has been corrected there were

634
00:22:07,370 --> 00:22:08,720
also things on it what is  interesting

635
00:22:08,720 --> 00:22:11,180
finally a month or two after the rate that

636
00:22:11,180 --> 00:22:12,440
has so exploits on that they came

637
00:22:12,440 --> 00:22:14,420
out so you search for a google

638
00:22:14,420 --> 00:22:16,310
recon and you have to exploit this case

639
00:22:16,310 --> 00:22:17,360
it's funny that they were

640
00:22:17,360 --> 00:22:19,100
n't using the same  its own in the hope

641
00:22:19,100 --> 00:22:20,600
they used of 1 to create two

642
00:22:20,600 --> 00:22:22,450
hours and one to assign roles

643
00:22:22,450 --> 00:22:26,180
so there remote you create looser

644
00:22:26,180 --> 00:22:27,680
admin you are admin so on the

645
00:22:27,680 --> 00:22:28,910
system in question you

646
00:22:28,910 --> 00:22:30,710
compromised you can use too

647
00:22:30,710 --> 00:22:32,300
another small generality that allows you

648
00:22:32,300 --> 00:22:33,950
to execute os commands if you are

649
00:22:33,950 --> 00:22:34,870
admin

650
00:22:34,870 --> 00:22:37,100
is in fact that it commands you to

651
00:22:37,100 --> 00:22:39,440
execute them you to execute them the

652
00:22:39,440 --> 00:22:41,090
queries on the 3000 5 to recover the

653
00:22:41,090 --> 00:22:42,680
sd to decrypt the sd eye attacks that

654
00:22:42,680 --> 00:22:43,340
they  either I have to try to

655
00:22:43,340 --> 00:22:44,170
reindeer

656
00:22:44,170 --> 00:22:46,540
for example

657
00:22:46,540 --> 00:22:48,850
another one

658
00:22:48,850 --> 00:22:53,080
so that's because we call it willy

659
00:22:53,080 --> 00:22:55,400
so it's better to stop on something

660
00:22:55,400 --> 00:22:58,300
called willy it's too

661
00:22:58,300 --> 00:23:00,620
late price manager I'm going  to get

662
00:23:00,620 --> 00:23:02,660
there so there it's a bit special as

663
00:23:02,660 --> 00:23:04,190
you want to see there is no

664
00:23:04,190 --> 00:23:06,410
netweaver base in fact there is not even a base

665
00:23:06,410 --> 00:23:09,080
at all the muli between the scop it

666
00:23:09,080 --> 00:23:10,490
's something that is provided by and it

667
00:23:10,490 --> 00:23:11,620
pays  if an application

668
00:23:11,620 --> 00:23:13,910
but it's also part of the

669
00:23:13,910 --> 00:23:15,290
world of saab if it's not just the

670
00:23:15,290 --> 00:23:17,030
big systems of the big sap netweaver the things

671
00:23:17,030 --> 00:23:18,380
there are also sometimes small

672
00:23:18,380 --> 00:23:21,080
apps like that and it pays here is the

673
00:23:21,080 --> 00:23:23,000
orsois buying them back

674
00:23:23,000 --> 00:23:25,040
and suppliers be create

675
00:23:25,040 --> 00:23:26,510
them themselves and so where it says what is

676
00:23:26,510 --> 00:23:27,860
it f  ait willy in fact he is there

677
00:23:27,860 --> 00:23:30,080
normally to monitor in

678
00:23:30,080 --> 00:23:32,540
fact other java applications so yes

679
00:23:32,540 --> 00:23:33,560
lille is able to make pretty

680
00:23:33,560 --> 00:23:35,780
graphics etc it does it does

681
00:23:35,780 --> 00:23:36,580
pretty things

682
00:23:36,580 --> 00:23:38,570
so what I am going to show in fact

683
00:23:38,570 --> 00:23:40,240
it is a truth that  I found in

684
00:23:40,240 --> 00:23:43,300
France 1h30

685
00:23:43,300 --> 00:23:46,670
so we can access it via web plays very

686
00:23:46,670 --> 00:23:49,040
well and in fact when we stay with a

687
00:23:49,040 --> 00:23:51,170
12 p.m. at 12 p.m. at 12 p.m.

688
00:23:51,170 --> 00:23:52,730
correct we receive like a year is

689
00:23:52,730 --> 00:23:54,650
the equivalent of a cookie session there  which is

690
00:23:54,650 --> 00:23:55,760
called it's to willy there in the

691
00:23:55,760 --> 00:23:58,119
cookies and that they start with

692
00:23:58,119 --> 00:24:01,329
f0 something so that those who

693
00:24:01,329 --> 00:24:02,859
know a little bit in fact it's

694
00:24:02,859 --> 00:24:06,249
the ba 64 of a jab to

695
00:24:06,249 --> 00:24:10,089
java sterilizations is in fact this  suddenly that was the

696
00:24:10,089 --> 00:24:12,039
entry point for a java injection

697
00:24:12,039 --> 00:24:15,519
where we could make them attacks

698
00:24:15,519 --> 00:24:18,039
by series reading the front in

699
00:24:18,039 --> 00:24:19,239
quotes the advantage that the java

700
00:24:19,239 --> 00:24:20,709
behind it is not specific and its

701
00:24:20,709 --> 00:24:23,919
pc standard  and this session cookie if

702
00:24:23,919 --> 00:24:25,449
you provide so login password

703
00:24:25,449 --> 00:24:26,889
session scam these co  okies session that

704
00:24:26,889 --> 00:24:28,599
she checks first you

705
00:24:28,599 --> 00:24:30,099
can put it blabla and blue blue hole

706
00:24:30,099 --> 00:24:31,299
olimpa so it's still a

707
00:24:31,299 --> 00:24:34,239
contribution that is going to be who m who is going to

708
00:24:34,239 --> 00:24:36,699
manage and suddenly they raise ayral who is

709
00:24:36,699 --> 00:24:39,699
going to kraft is actually helping them  po2 it

710
00:24:39,699 --> 00:24:42,159
works great so that I have a demo

711
00:24:42,159 --> 00:24:44,759
also continue

712
00:24:45,810 --> 00:24:48,780
yes so bottom left is the wild

713
00:24:48,780 --> 00:24:50,280
between scop so we can access it

714
00:24:50,280 --> 00:24:52,650
via port 80 80 I feel web bio we

715
00:24:52,650 --> 00:24:55,200
see we have good  we have the

716
00:24:55,200 --> 00:24:57,630
logging interface and it's perfect so at the top

717
00:24:57,630 --> 00:24:59,910
I saw crafting a game cookie seen

718
00:24:59,910 --> 00:25:02,010
what's inside and in fact

719
00:25:02,010 --> 00:25:03,030
what's inside it's actually a rider

720
00:25:03,030 --> 00:25:04,890
shell  towards the attack machine are the

721
00:25:04,890 --> 00:25:07,560
port 5 5 bags here here is the nc thing

722
00:25:07,560 --> 00:25:08,930
blabla

723
00:25:08,930 --> 00:25:12,900
I'm going to launch honor slides and there I

724
00:25:12,900 --> 00:25:14,160
'm just going to execute registered who will make

725
00:25:14,160 --> 00:25:15,270
an attempt to connect by

726
00:25:15,270 --> 00:25:17,680
providing a login password who

727
00:25:17,680 --> 00:25:20,200
cares and above all he's going  provide 1

728
00:25:20,200 --> 00:25:22,660
the cookie session with our period of

729
00:25:22,660 --> 00:25:24,180
teeth

730
00:25:24,180 --> 00:25:26,350
so there we suddenly execute our body

731
00:25:26,350 --> 00:25:27,490
our island of  e research we have

732
00:25:27,490 --> 00:25:29,650
remote access etc etc it's quite fast good

733
00:25:29,650 --> 00:25:31,290
there I'm on the road

734
00:25:31,290 --> 00:25:33,850
it's a bit there it was a mistake of

735
00:25:33,850 --> 00:25:35,260
our admins well in fact we are going to have

736
00:25:35,260 --> 00:25:36,670
fun at wasmes and often louis lions

737
00:25:36,670 --> 00:25:37,930
the stall on the way  because otherwise it's

738
00:25:37,930 --> 00:25:40,410
complicated and it's a shame

739
00:25:40,410 --> 00:25:44,970
but it's not it's not the norm

740
00:25:45,700 --> 00:25:47,350
so that again of course it

741
00:25:47,350 --> 00:25:48,519
was not from Honda we were quite

742
00:25:48,519 --> 00:25:51,809
effective during their girlfriends

743
00:25:51,809 --> 00:25:54,580
so there again  once we have access to the

744
00:25:54,580 --> 00:25:57,490
machine we can we can we can thank you

745
00:25:57,490 --> 00:25:59,610
if we are on the road does not even need

746
00:25:59,610 --> 00:26:01,630
to attack the ace of aces but if we are a

747
00:26:01,630 --> 00:26:03,639
parent or if we are assaulted adm we can

748
00:26:03,639 --> 00:26:06,279
still do exactly  the same thing

749
00:26:06,279 --> 00:26:07,960
so recover the receivables there was going to

750
00:26:07,960 --> 00:26:10,799
access the base of tron like that so th

751
00:26:10,799 --> 00:26:13,120
re I showed an attack on the sap n

752
00:26:13,120 --> 00:26:14,620
tweaver java we will say somet

753
00:26:14,620 --> 00:26:15,850
ing that is accessible a bit a power

754
00:26:15,850 --> 00:26:17,169
to rent another often a small

755
00:26:17,169 --> 00:26:19,240
app which is  not necessarily very well

756
00:26:19,240 --> 00:26:21,010
known but which is quite present it is

757
00:26:21,010 --> 00:26:22,809
the widi and there it will be at  tre thing again

758
00:26:22,809 --> 00:26:25,690
so there the target is still the sap

759
00:26:25,690 --> 00:26:28,169
netweaver java but

760
00:26:28,169 --> 00:26:31,080
it is a bit particular so basically

761
00:26:31,080 --> 00:26:32,820
the

762
00:26:32,820 --> 00:26:35,260
sap netweaver jada it actually uses what

763
00:26:35,260 --> 00:26:37,149
it calls it java clusters so

764
00:26:37,149 --> 00:26:38,200
in fact you have to imagine it's  several

765
00:26:38,200 --> 00:26:40,510
java processes and while placing them it's

766
00:26:40,510 --> 00:26:43,240
called servers 0 servers etc etc and

767
00:26:43,240 --> 00:26:44,380
in fact for they need to

768
00:26:44,380 --> 00:26:45,909
communicate with each other they need and

769
00:26:45,909 --> 00:26:47,230
here they need to chat to me

770
00:26:47,230 --> 00:26:48,190
I feel like doing six matches

771
00:26:48,190 --> 00:26:50,950
doing  his thing away wait and to

772
00:26:50,950 --> 00:26:52,950
communicate so in the sap netweaver

773
00:26:52,950 --> 00:26:55,330
javad provided by wife uses something

774
00:26:55,330 --> 00:26:57,029
called cluster manager communication

775
00:26:57,029 --> 00:27:01,179
and that's it so it's quite ignacious okaka

776
00:27:01,179 --> 00:27:03,970
found it is in fact it turns out that the

777
00:27:03,970 --> 00:27:06,240
port it has a bit  the

778
00:27:06,240 --> 00:27:09,410
pattern of the port is a little particular but in fact

779
00:27:09,410 --> 00:27:11,510
this cluster manager communication it

780
00:27:11,510 --> 00:27:13,400
also listens especially the soups the

781
00:27:13,400 --> 00:27:15,320
interfaces not only the lost case and

782
00:27:15,320 --> 00:27:17,270
therefore we can access it what

783
00:27:17,270 --> 00:27:18,950
found it he found it was dumb

784
00:27:18,950 --> 00:27:20,420
specific and  paid for the shot there so he must have

785
00:27:20,420 --> 00:27:22,370
dreamed a little about these protocols etc. I'm not going

786
00:27:22,370 --> 00:27:23,420
to go into too much detail

787
00:27:23,420 --> 00:27:26,660
because otherwise we weren't finished but basically

788
00:27:26,660 --> 00:27:29,030
he could remotely without there was

789
00:27:29,030 --> 00:27:30,110
no process

790
00:27:30,110 --> 00:27:32,150
remote authentication they could interact with

791
00:27:32,150 --> 00:27:34,400
his processes and he could do a lot of

792
00:27:34,400 --> 00:27:35,690
things so he found a lot

793
00:27:35,690 --> 00:27:39,650
of dose backs sorry is in fact he also

794
00:27:39,650 --> 00:27:42,170
found a way to do a

795
00:27:42,170 --> 00:27:44,660
rather special attack so he found a

796
00:27:44,660 --> 00:27:45,740
way to  'access a service

797
00:27:45,740 --> 00:27:47,060
called gm he shakes which offered a

798
00:27:47,060 --> 00:27:50,300
method is the sejil 2 e sso 2

799
00:27:50,300 --> 00:27:52,820
management method when you log on a sap

800
00:27:52,820 --> 00:27:55,490
netweaver java in fact only once you

801
00:27:55,490 --> 00:27:56,780
are long and the cookie session that  'we

802
00:27:56,780 --> 00:28:00,290
recover it is called corn apc so2 and in

803
00:28:00,290 --> 00:28:04,040
fact this gie 2nd test co2 management in

804
00:28:04,040 --> 00:28:07,300
fact it allows to add a

805
00:28:07,300 --> 00:28:10,760
trust system for the management of these

806
00:28:10,760 --> 00:28:13,280
cookies sso basically what does it mean that

807
00:28:13,280 --> 00:28:15,080
is to say a  attacker it communicates

808
00:28:15,080 --> 00:28:16,730
with the cluster manager and 10th to

809
00:28:16,730 --> 00:28:17,810
attacker machine  from now on she has

810
00:28:17,810 --> 00:28:20,780
the right to create cookies these floors

811
00:28:20,780 --> 00:28:21,850
with my signature

812
00:28:21,850 --> 00:28:25,430
there the system relies says yeah ok

813
00:28:25,430 --> 00:28:26,690
and suddenly now from the

814
00:28:26,690 --> 00:28:28,460
attacker machine we can kraft and the cookie

815
00:28:28,460 --> 00:28:30,530
using a default administrator user

816
00:28:30,530 --> 00:28:32,090
for example and we can

817
00:28:32,090 --> 00:28:33,770
spit out a sso cookie which will be valid

818
00:28:33,770 --> 00:28:35,660
because it was towed on a

819
00:28:35,660 --> 00:28:37,760
machine that and undermine cross in its

820
00:28:37,760 --> 00:28:40,730
circle in its circus cost is therefore there

821
00:28:40,730 --> 00:28:42,410
we cannot create a user on the other hand with

822
00:28:42,410 --> 00:28:44,060
jacques any any any

823
00:28:44,060 --> 00:28:44,890
user

824
00:28:44,890 --> 00:28:47,620
so it's been patched too

825
00:28:47,620 --> 00:28:50,000
is so there it's a bit the same we can

826
00:28:50,000 --> 00:28:51,710
therefore create we take control of a

827
00:28:51,710 --> 00:28:54,050
user the user we can

828
00:28:54,050 --> 00:28:56,330
execute commands os the commandos

829
00:28:56,330 --> 00:28:59,860
s we only attack his focus be

830
00:28:59,920 --> 00:29:02,200
a  last

831
00:29:02,200 --> 00:29:05,110
so that's on the portal

832
00:29:05,110 --> 00:29:09,800
so there it's a small carpet app

833
00:29:09,800 --> 00:29:10,820
in quotes the portal but

834
00:29:10,820 --> 00:29:13,340
I liked it because the presentation how we

835
00:29:13,340 --> 00:29:15,530
walk on the internet we don't

836
00:29:15,530 --> 00:29:17,570
necessarily see because it's not marked his

837
00:29:17,570 --> 00:29:18,890
version  thing blabla but t  from time to

838
00:29:18,890 --> 00:29:20,240
time we are dealing with portals and it

839
00:29:20,240 --> 00:29:20,960
pays

840
00:29:20,960 --> 00:29:23,029
either that or the companies sometimes he

841
00:29:23,029 --> 00:29:24,470
uses the portal is zapped so that

842
00:29:24,470 --> 00:29:26,000
their employees no longer access it remotely

843
00:29:26,000 --> 00:29:27,980
or anywhere to be able to manage I

844
00:29:27,980 --> 00:29:30,409
don't know their day off  and it's that

845
00:29:30,409 --> 00:29:31,899
it happens

846
00:29:31,899 --> 00:29:33,919
so the portal it looks like it's

847
00:29:33,919 --> 00:29:36,440
called the sap enterprise portal here it is

848
00:29:36,440 --> 00:29:38,169
back and its fury

849
00:29:38,169 --> 00:29:39,340
I remembered what we saw on

850
00:29:39,340 --> 00:29:40,559
the free site

851
00:29:40,559 --> 00:29:44,279
is in fact the portal in it  uses in

852
00:29:44,279 --> 00:29:46,330
particular does a lot of things and in

853
00:29:46,330 --> 00:29:48,669
particular its interests it is therefore to os

854
00:29:48,669 --> 00:29:51,190
x and filth transformation so in

855
00:29:51,190 --> 00:29:53,350
fact what is xslt very quickly so

856
00:29:53,350 --> 00:29:55,480
we provide an xml file and in fact there

857
00:29:55,480 --> 00:29:56,429
is an

858
00:29:56,429 --> 00:29:58,840
xslt engine which will transform into  makes this

859
00:29:58,840 --> 00:30:00,340
xml file and who will create another

860
00:30:00,340 --> 00:30:04,179
file it can be a html pdf etc

861
00:30:04,179 --> 00:30:05,409
is actually the configuration of this

862
00:30:05,409 --> 00:30:07,090
transformation is the data via a

863
00:30:07,090 --> 00:30:08,830
style sheet so a file which for

864
00:30:08,830 --> 00:30:11,619
sure and it's actually this style sheet

865
00:30:11,619 --> 00:30:13,960
who will say well game that you create in html

866
00:30:13,960 --> 00:30:16,139
or not

867
00:30:16,139 --> 00:30:18,159
so we look a little in the portal

868
00:30:18,159 --> 00:30:20,590
is in fact we suspect that there is this

869
00:30:20,590 --> 00:30:22,419
xslt thing why because in fact at some

870
00:30:22,419 --> 00:30:23,830
point we click will be a

871
00:30:23,830 --> 00:30:25,230
file called point archives log

872
00:30:25,230 --> 00:30:27,399
behind we know that it  is xml and in

873
00:30:27,399 --> 00:30:28,600
fact it made us make a very nice

874
00:30:28,600 --> 00:30:30,399
html so in the configuration it

875
00:30:30,399 --> 00:30:32,289
looks like that so for that says what

876
00:30:32,289 --> 00:30:33,429
it says for everything called

877
00:30:33,429 --> 00:30:34,720
point archives the ofppt something well

878
00:30:34,720 --> 00:30:35,980
in fact you go  use the style

879
00:30:35,980 --> 00:30:39,039
sheet there during tc filter xml archives

880
00:30:39,039 --> 00:30:41,519
log to be able to transform it and

881
00:30:41,519 --> 00:30:44,320
so we do a little toy with

882
00:30:44,320 --> 00:30:46,119
this style sheet file it turns out that in

883
00:30:46,119 --> 00:30:48,399
fact we manage to find 1 us command

884
00:30:48,399 --> 00:30:51,489
injection in the style file  chic and

885
00:30:51,489 --> 00:30:53,139
so one can execute commands

886
00:30:53,139 --> 00:30:57,039
as saidi dna on the system

887
00:30:57,039 --> 00:30:58,720
so gosh the payload it has quite simple

888
00:30:58,720 --> 00:30:59,830
it's longer than normal java that

889
00:30:59,830 --> 00:31:01,239
you copy paste that you can

890
00:31:01,239 --> 00:31:04,389
find just about anywhere and so

891
00:31:04,389 --> 00:31:06,460
so it's been patched so it's no

892
00:31:06,460 --> 00:31:08,499
longer possible  ble to do that but the little

893
00:31:08,499 --> 00:31:09,820
thing is that there we were admin all the

894
00:31:09,820 --> 00:31:11,019
same finally here we are an administrator

895
00:31:11,019 --> 00:31:12,580
we have access to the configuration we change

896
00:31:12,580 --> 00:31:13,929
the configuration we put our

897
00:31:13,929 --> 00:31:15,309
injection between rigor the good thing

898
00:31:15,309 --> 00:31:18,129
it's a bit it's  a bit cumbersome we have

899
00:31:18,129 --> 00:31:20,379
actually found a way to do their part

900
00:31:20,379 --> 00:31:22,539
any user is actually

901
00:31:22,539 --> 00:31:23,830
why because in fact in the

902
00:31:23,830 --> 00:31:25,629
configuration so by default of the

903
00:31:25,629 --> 00:31:28,920
portal sand there are

904
00:31:28,920 --> 00:31:31,630
ddd files so if it is called the

905
00:31:31,630 --> 00:31:33,070
points only at a university where pointent only at m

906
00:31:33,070 --> 00:31:34,420
uses so in fact it is

907
00:31:34,420 --> 00:31:36,700
transformations that are active but where

908
00:31:36,700 --> 00:31:39,400
the style sheet does not exist I do not know

909
00:31:39,400 --> 00:31:41,620
why and always is it that well

910
00:31:41,620 --> 00:31:43,300
suddenly like the stif it does not  does not exist we

911
00:31:43,300 --> 00:31:45,880
can create this style sheet after we create

912
00:31:45,880 --> 00:31:48,160
a toto for a case a university we

913
00:31:48,160 --> 00:31:49,750
accept ours cocaine totals crack and saâd

914
00:31:49,750 --> 00:31:51,730
rigor the binarity we did several

915
00:31:51,730 --> 00:31:53,050
tests to find out which right we needed

916
00:31:53,050 --> 00:31:54,280
in fact the rights we need  it's

917
00:31:54,280 --> 00:31:55,720
the minimum rights we actually need

918
00:31:55,720 --> 00:31:57,640
these g  roupes series one and

919
00:31:57,640 --> 00:31:59,140
authentic ati to user it is really

920
00:31:59,140 --> 00:32:01,150
the smallest rights that are needed and

921
00:32:01,150 --> 00:32:02,710
of course on the cists on the portals

922
00:32:02,710 --> 00:32:04,210
to be undermined so such as you have already seen

923
00:32:04,210 --> 00:32:07,450
this green screen a little and well in fact we

924
00:32:07,450 --> 00:32:08,980
can  recording our sweat is not

925
00:32:08,980 --> 00:32:10,120
necessarily it's not one of the pits we

926
00:32:10,120 --> 00:32:11,620
had for versions but there it is

927
00:32:11,620 --> 00:32:14,260
we can record for user so

928
00:32:14,260 --> 00:32:15,280
recorded for user i.e. we

929
00:32:15,280 --> 00:32:17,309
could record for user and

930
00:32:17,309 --> 00:32:20,080
and that's rigor the  minority so there

931
00:32:20,080 --> 00:32:21,630
so the portal world it's on the right

932
00:32:21,630 --> 00:32:23,790
I'm trying to get up with a loser

933
00:32:23,790 --> 00:32:26,130
miyazaki why

934
00:32:26,130 --> 00:32:29,830
doesn't it work I'm going to create that this is where

935
00:32:29,830 --> 00:32:31,330
the creation form it can be

936
00:32:31,330 --> 00:32:32,679
more complicated than that we can provide an

937
00:32:32,679 --> 00:32:34,420
email  they send us the password

938
00:32:34,420 --> 00:32:36,160
by email etc its strength to have a

939
00:32:36,160 --> 00:32:38,500
valid email good who cares so there I create

940
00:32:38,500 --> 00:32:41,710
I give I put the names of the things an

941
00:32:41,710 --> 00:32:44,800
email the password I ask to create

942
00:32:44,800 --> 00:32:46,570
his viewfinder it happens c  it's in the

943
00:32:46,570 --> 00:32:48,910
portals we have a duty to create its

944
00:32:48,910 --> 00:32:50,830
user it happens  so this time

945
00:32:50,830 --> 00:32:51,910
it works and in fact I'm going to have

946
00:32:51,910 --> 00:32:53,380
an error because in fact I have no

947
00:32:53,380 --> 00:32:55,480
role I really have the minimum rights

948
00:32:55,480 --> 00:32:56,679
so I even seem

949
00:32:56,679 --> 00:33:00,309
to display the content of the portal but in

950
00:33:00,309 --> 00:33:01,300
does not mean that I

951
00:33:01,300 --> 00:33:03,370
seem to access it directly via the urls

952
00:33:03,370 --> 00:33:04,630
and little of the two but files etc

953
00:33:04,630 --> 00:33:06,940
so largely according to the mover

954
00:33:06,940 --> 00:33:08,980
on port 1 2 3 4 and I will launch a

955
00:33:08,980 --> 00:33:10,179
script in fact that it  will make several

956
00:33:10,179 --> 00:33:12,670
requests and who will therefore upload and the

957
00:33:12,670 --> 00:33:14,740
stic file which does not exist or little of

958
00:33:14,740 --> 00:33:17,679
a file points only to a physiotherapist who

959
00:33:17,679 --> 00:33:20,170
was not present access this point

960
00:33:20,170 --> 00:33:22,330
pm fac trigger the vulgarity which will

961
00:33:22,330 --> 00:33:23,530
execute commands  yeah it's true

962
00:33:23,530 --> 00:33:26,399
recover my boss

963
00:33:31,980 --> 00:33:34,420
so there again we are we come

964
00:33:34,420 --> 00:33:36,790
from the internet we are remote we have pre

965
00:33:36,790 --> 00:33:38,530
history a user or we

966
00:33:38,530 --> 00:33:39,940
already had access with a dictator with

967
00:33:39,940 --> 00:33:41,770
fairly low privileges and we were able to

968
00:33:41,770 --> 00:33:44,470
execute code  retrieve the sd to decipher the

969
00:33:44,470 --> 00:33:48,060
config access the fake asses and

970
00:33:48,930 --> 00:33:51,610
so that's where I  I just tried to list

971
00:33:51,610 --> 00:33:52,780
and a little either the truths that we

972
00:33:52,780 --> 00:33:54,790
found the pages that are associated and if

973
00:33:54,790 --> 00:33:56,020
possible if there are works aaron et

974
00:33:56,020 --> 00:33:58,380
cetera so and also the scores next

975
00:33:58,380 --> 00:34:00,640
so that's on his focus  and drone what

976
00:34:00,640 --> 00:34:02,470
we found don't have much

977
00:34:02,470 --> 00:34:04,420
apart from the first thing about the fact that we

978
00:34:04,420 --> 00:34:07,900
could access the sdf that's for sure the

979
00:34:07,900 --> 00:34:10,690
sap netweaver abap so it's more the

980
00:34:10,690 --> 00:34:12,219
side effects we weren't looking for anything  on the

981
00:34:12,219 --> 00:34:13,389
bac but we found stuff because

982
00:34:13,389 --> 00:34:14,280
we were

983
00:34:14,280 --> 00:34:16,300
working on it know that it's

984
00:34:16,300 --> 00:34:17,100
funny

985
00:34:17,100 --> 00:34:19,540
that's for sure the java so the jaguars

986
00:34:19,540 --> 00:34:21,850
our a lot of things in recent

987
00:34:21,850 --> 00:34:23,590
years so the first one there is the one where

988
00:34:23,590 --> 00:34:25,360
we  could create our admin user

989
00:34:25,360 --> 00:34:26,800
remotely because we had access

990
00:34:26,800 --> 00:34:29,070
to the wizard services

991
00:34:29,070 --> 00:34:30,989
that one there is

992
00:34:30,989 --> 00:34:33,159
we call it a dead single parent because we

993
00:34:33,159 --> 00:34:35,100
in fact it is in fact we will be able

994
00:34:35,100 --> 00:34:38,230
to years he can access the web

995
00:34:38,230 --> 00:34:40,480
services  and check the box am here I

996
00:34:40,480 --> 00:34:42,250
want them to be authenticated it avoids being

997
00:34:42,250 --> 00:34:44,260
able to access them without being

998
00:34:44,260 --> 00:34:46,540
authenticated  fié becomes internet it's

999
00:34:46,540 --> 00:34:47,440
also possible to completely

1000
00:34:47,440 --> 00:34:49,810
deactivate the wizzards configuration we do

1001
00:34:49,810 --> 00:34:51,940
n't know if we knew that your friends

1002
00:34:51,940 --> 00:34:53,710
don't use them well you can also

1003
00:34:53,710 --> 00:34:56,230
deactivate the second place and on the

1004
00:34:56,230 --> 00:34:59,260
cluster management it's the one where we

1005
00:34:59,260 --> 00:35:01,930
could we  could add our our

1006
00:35:01,930 --> 00:35:03,250
system as a trustee to be able to

1007
00:35:03,250 --> 00:35:05,650
manage the sso tickets in fact also the

1008
00:35:05,650 --> 00:35:07,350
sq is possible it is once again

1009
00:35:07,350 --> 00:35:09,310
temporary or partial added

1010
00:35:09,310 --> 00:35:11,560
we re a route a rule sorry which

1011
00:35:11,560 --> 00:35:14,350
says well I do not expose  port 5 in

1012
00:35:14,350 --> 00:35:16,600
2020 everyone be careful if you

1013
00:35:16,600 --> 00:35:17,830
do this what sometimes the systems

1014
00:35:17,830 --> 00:35:19,300
and it pays they have several servers

1015
00:35:19,300 --> 00:35:21,460
for a single system and sometimes it's

1016
00:35:21,460 --> 00:35:23,860
normal for the servers to chat via this

1017
00:35:23,860 --> 00:35:26,280
port you still have to be careful

1018
00:35:26,280 --> 00:35:28,930
for the willy where it was the java of

1019
00:35:28,930 --> 00:35:30,310
the reading series there is no miracle

1020
00:35:30,310 --> 00:35:31,830
false papers

1021
00:35:31,830 --> 00:35:34,650
for the land top race portal the

1022
00:35:34,650 --> 00:35:36,900
same so with a smile we could

1023
00:35:36,900 --> 00:35:39,059
execute codes with a looser abba

1024
00:35:39,059 --> 00:35:42,869
privilege this one para us  was

1025
00:35:42,869 --> 00:35:45,720
partial so it does not remove the bug that we

1026
00:35:45,720 --> 00:35:48,119
can execute code in the

1027
00:35:48,119 --> 00:35:49,740
xslt engine but on the other hand if you

1028
00:35:49,740 --> 00:35:53,819
already deactivate all had all the films all the

1029
00:35:53,819 --> 00:35:55,710
transformations sorry who do not have a

1030
00:35:55,710 --> 00:35:57,450
configuration file beats you already

1031
00:35:57,450 --> 00:35:58,680
remove the fact  that any

1032
00:35:58,680 --> 00:36:00,299
user can trigger the binarity there

1033
00:36:00,299 --> 00:36:02,460
will be an administrator already it's a little

1034
00:36:02,460 --> 00:36:06,799
a little a little more a little more his

1035
00:36:06,799 --> 00:36:12,440
friends go to what I wanted to show

1036
00:36:12,440 --> 00:36:14,609
ok I showed minorities hockey

1037
00:36:14,609 --> 00:36:15,869
what  we found on the know that these

1038
00:36:15,869 --> 00:36:17,339
rights don't know it's not

1039
00:36:17,339 --> 00:36:20,039
extraordinary but because I

1040
00:36:20,039 --> 00:36:21,510
really wanted to show it's that a this

1041
00:36:21,510 --> 00:36:24,420
had zapped complex it's very

1042
00:36:24,420 --> 00:36:26,279
heterogeneous in terms of system in

1043
00:36:26,279 --> 00:36:28,020
terms also of type become  stopped there

1044
00:36:28,020 --> 00:36:30,960
really is everything and above all you must not

1045
00:36:30,960 --> 00:36:34,619
concentrate on the big production which

1046
00:36:34,619 --> 00:36:36,990
makes 50 teras kiffer and which brews

1047
00:36:36,990 --> 00:36:39,329
millions per hour that one it is

1048
00:36:39,329 --> 00:36:42,450
armored thing blah blah it is also necessary and

1049
00:36:42,450 --> 00:36:44,549
it is very important to look at what  we are

1050
00:36:44,549 --> 00:36:46,079
called  the technical systems

1051
00:36:46,079 --> 00:36:48,059
whose class with its focus and drone

1052
00:36:48,059 --> 00:36:50,430
can be the sap solution manager there

1053
00:36:50,430 --> 00:36:52,319
is for example also the grc sand or this

1054
00:36:52,319 --> 00:36:54,510
kind of thing these are systems where

1055
00:36:54,510 --> 00:36:55,950
there is no business data but which

1056
00:36:55,950 --> 00:36:57,839
are used by  the admins and who

1057
00:36:57,839 --> 00:36:59,540
have rights

1058
00:36:59,540 --> 00:37:00,830
finally who have connections and

1059
00:37:00,830 --> 00:37:02,600
rights everywhere on all the other

1060
00:37:02,600 --> 00:37:05,840
systems and it is as if you are doing

1061
00:37:05,840 --> 00:37:07,280
a test you know that there are fifty

1062
00:37:07,280 --> 00:37:08,510
systems and you are told to scope

1063
00:37:08,510 --> 00:37:10,340
it  is that you just have two

1064
00:37:10,340 --> 00:37:11,740
bottom systems ok i

1065
00:37:11,740 --> 00:37:13,910
didn't find anything but it might

1066
00:37:13,910 --> 00:37:15,470
not be relevant to all

1067
00:37:15,470 --> 00:37:18,550
of everything you have and of course

1068
00:37:18,550 --> 00:37:20,900
the problem anyway we saw on

1069
00:37:20,900 --> 00:37:22,130
know it that it's funny it's

1070
00:37:22,130 --> 00:37:23,390
quite recurrent in sand it's that

1071
00:37:23,390 --> 00:37:26,540
it's very linked sap sometimes it's normal

1072
00:37:26,540 --> 00:37:27,800
that two sap systems communicate with

1073
00:37:27,800 --> 00:37:31,100
each other ok and there because of that that the

1074
00:37:31,100 --> 00:37:33,230
drones of its manager solution etc and well

1075
00:37:33,230 --> 00:37:35,210
in fact if we manage to break or

1076
00:37:35,210 --> 00:37:37,700
compromise a single one of the systems we

1077
00:37:37,700 --> 00:37:39,710
can then do since lateral

1078
00:37:39,710 --> 00:37:41,390
movement super easily and we

1079
00:37:41,390 --> 00:37:44,060
compromise the whole landscape in no

1080
00:37:44,060 --> 00:37:46,150
time

1081
00:37:46,270 --> 00:37:48,890
so to come back to it would have been itself

1082
00:37:48,890 --> 00:37:51,560
there has been great progress made on it

1083
00:37:51,560 --> 00:37:53,840
compared to the ca / manager or know we had f

1084
00:37:53,840 --> 00:37:56,240
und as a way 12 generalities  I

1085
00:37:56,240 --> 00:37:58,820
think there we didn't have it all the same it was

1086
00:37:58,820 --> 00:38:01,280
more difficult if we attacked it

1087
00:38:01,280 --> 00:38:02,840
frontally finally I mean the system

1088
00:38:02,840 --> 00:38:04,100
itself here we were ready didn't

1089
00:38:04,100 --> 00:38:05,450
find much because we found

1090
00:38:05,450 --> 00:38:08,420
it  was on the agent so suddenly the

1091
00:38:08,420 --> 00:38:09,710
attacked surface increased a lot

1092
00:38:09,710 --> 00:38:10,790
because the agents are installed

1093
00:38:10,790 --> 00:38:15,130
everywhere but that's what

1094
00:38:15,130 --> 00:38:17,930
and well that's it for me so

1095
00:38:17,930 --> 00:38:19,780
not just thank you

1096
00:38:19,780 --> 00:38:22,160
pablo and ignace haut for allowing me

1097
00:38:22,160 --> 00:38:24,920
to  also present to them come as

1098
00:38:24,920 --> 00:38:26,210
soon as possible we talk a lot a lot

1099
00:38:26,210 --> 00:38:27,230
with sap and we work a lot

1100
00:38:27,230 --> 00:38:31,850
together and so here it is and thank you

1101
00:38:31,850 --> 00:38:33,880
very much

1102
00:38:39,840 --> 00:38:42,550
ladies and gentlemen they will get in the way and

1103
00:38:42,550 --> 00:38:44,220
thank you very much

1104
00:38:44,220 --> 00:38:46,930
we will do a little

1105
00:38:46,930 --> 00:38:48,820
question and answer session if you have  z

1106
00:38:48,820 --> 00:38:51,000
questions

1107
00:38:51,000 --> 00:38:57,000
like what it is that you spi that

1108
00:38:57,750 --> 00:39:00,480
lascaux

1109
00:39:00,480 --> 00:39:03,030
ok comes out

1110
00:39:03,030 --> 00:39:06,450
so we go

1111
00:39:07,770 --> 00:39:11,190
then yes I have a small

1112
00:39:11,190 --> 00:39:13,690
question all the vulnerabilities it's

1113
00:39:13,690 --> 00:39:15,310
finally there it's still quite

1114
00:39:15,310 --> 00:39:17,470
substantial it can be asked

1115
00:39:17,470 --> 00:39:18,660
how long to  work

1116
00:39:18,660 --> 00:39:21,640
I'm leaving in the day finally just units

1117
00:39:21,640 --> 00:39:23,940
history

1118
00:39:24,380 --> 00:39:28,020
so there there there I can on his focus and

1119
00:39:28,020 --> 00:39:31,080
run me I worked roughly

1120
00:39:31,080 --> 00:39:33,530
speaking four weeks on it

1121
00:39:33,530 --> 00:39:36,150
where I ran well on the

1122
00:39:36,150 --> 00:39:37,440
sand focus and run in him-  even and after

1123
00:39:37,440 --> 00:39:38,820
when I looked at the agent has it on the

1124
00:39:38,820 --> 00:39:40,790
other hand everything and go much faster

1125
00:39:40,790 --> 00:39:42,440
after

1126
00:39:42,440 --> 00:39:44,370
me I can say on mine so

1127
00:39:44,370 --> 00:39:46,530
on everything that is on the portal the

1128
00:39:46,530 --> 00:39:47,970
porting believe that I worked the same

1129
00:39:47,970 --> 00:39:49,140
I  I had to work a month a month and a

1130
00:39:49,140 --> 00:39:52,560
half and the willis a yeah it was quickly

1131
00:39:52,560 --> 00:39:55,340
done in fact in a corner it's not too much

1132
00:39:55,340 --> 00:39:58,320
on the other hand I know it was it's what

1133
00:39:58,320 --> 00:40:00,030
's called recon the culprit at and

1134
00:40:00,030 --> 00:40:01,110
look at it there on the other hand he

1135
00:40:01,110 --> 00:40:04,170
looked more longer it's a

1136
00:40:04,170 --> 00:40:05,460
given moment we worked  it on his

1137
00:40:05,460 --> 00:40:08,160
absolute focus on manager at 2 he found this

1138
00:40:08,160 --> 00:40:10,950
truth and we saw that it was not specific

1139
00:40:10,950 --> 00:40:12,690
to the sands on manager was in fact the

1140
00:40:12,690 --> 00:40:15,930
whole base here but it is the order

1141
00:40:15,930 --> 00:40:18,060
of magnitude it is a  a little bit after that

1142
00:40:18,060 --> 00:40:20,430
we don't just water do pnt

1143
00:40:20,430 --> 00:40:21,510
are done incident response have

1144
00:40:21,510 --> 00:40:22,860
done stuff but basically

1145
00:40:22,860 --> 00:40:25,040
here's

1146
00:40:33,609 --> 00:40:36,630
not what

1147
00:40:40,440 --> 00:40:44,420
yes hello thank you for the press and

1148
00:40:44,420 --> 00:40:46,310
I have a question how is it

1149
00:40:46,310 --> 00:40:47,900
you set up the

1150
00:40:47,900 --> 00:40:50,090
test and poke environments for the views

1151
00:40:50,090 --> 00:40:51,770
are born ap is what it pays that

1152
00:40:51,770 --> 00:40:53,620
provides you

1153
00:40:53,620 --> 00:40:55,790
so it was the day before question basque

1154
00:40:55,790 --> 00:40:58,460
queries so so me in abscissa my

1155
00:40:58,460 --> 00:41:00,290
box it is in partnership with sap

1156
00:41:00,290 --> 00:41:02,720
is  one of the big advantages that I

1157
00:41:02,720 --> 00:41:03,710
have as a researcher is that I don't

1158
00:41:03,710 --> 00:41:05,900
take care of that anymore, in fact we named

1159
00:41:05,900 --> 00:41:08,120
in real life we have a lab there is me I make a ticke

1160
00:41:08,120 --> 00:41:09,380
saying I need such 

1161
00:41:09,380 --> 00:41:11,810
systems such version and three days

1162
00:41:11,810 --> 00:41:13,160
later I receive the ticket it is done

1163
00:41:13,160 --> 00:41:14,600
here is a road sieve and

1164
00:41:14,600 --> 00:41:16,400
m  achins and manage you what so

1165
00:41:16,400 --> 00:41:18,620
it's as a researcher it's it's

1166
00:41:18,620 --> 00:41:20,840
really priceless but I know that after

1167
00:41:20,840 --> 00:41:22,640
we have I couldn't say exactly

1168
00:41:22,640 --> 00:41:23,990
but I know that in fact as we are

1169
00:41:23,990 --> 00:41:25,550
partners we can install

1170
00:41:25,550 --> 00:41:27,740
versions we can thing but but here you go

1171
00:41:27,740 --> 00:41:30,140
after there are i think there are

1172
00:41:30,140 --> 00:41:32,150
developer versions they call

1173
00:41:32,150 --> 00:41:33,860
it and it pays i think you can

1174
00:41:33,860 --> 00:41:35,960
download but you won't get you will get

1175
00:41:35,960 --> 00:41:37,190
a version so i think it's

1176
00:41:37,190 --> 00:41:38,870
tonight anna  now or a version of

1177
00:41:38,870 --> 00:41:40,580
sap netweaver adhap but you will not have

1178
00:41:40,580 --> 00:41:42,170
for example the lehouillier portal the

1179
00:41:42,170 --> 00:41:43,400
sap solution manager all that you

1180
00:41:43,400 --> 00:41:45,490
call them

1181
00:41:54,410 --> 00:41:56,329
hello as you reminded it so

1182
00:41:56,329 --> 00:41:58,250
fap went to a lot

1183
00:41:58,250 --> 00:42:00,530
of companies in the world so we

1184
00:42:00,530 --> 00:42:03,250
explained to you that  'there have been so few cities

1185
00:42:03,250 --> 00:42:06,400
detected since

1186
00:42:06,700 --> 00:42:10,670
so few vulnerabilities find there are

1187
00:42:10,670 --> 00:42:12,309
not many to do so I'm leaving to

1188
00:42:12,309 --> 00:42:14,210
settle in many

1189
00:42:14,210 --> 00:42:15,859
many companies in the world that are

1190
00:42:15,859 --> 00:42:19,039
regular targets of attack why

1191
00:42:19,039 --> 00:42:20,150
is it  e that we don't see more attacks

1192
00:42:20,150 --> 00:42:22,130
on his macha lawn because it's

1193
00:42:22,130 --> 00:42:26,530
quite discreet I think but there are some

1194
00:42:26,740 --> 00:42:28,760
but it doesn't make the headlines it

1195
00:42:28,760 --> 00:42:31,010
's not unless there were a few

1196
00:42:31,010 --> 00:42:32,630
million  stealing or stuff like that

1197
00:42:32,630 --> 00:42:34,579
but there the last case made the

1198
00:42:34,579 --> 00:42:36,200
headlines it was still necessary for those who

1199
00:42:36,200 --> 00:42:37,369
knew a little about the world of sand

1200
00:42:37,369 --> 00:42:39,740
it was last January

1201
00:42:39,740 --> 00:42:41,270
a South American company which

1202
00:42:41,270 --> 00:42:42,680
made itself think for two years  they are

1203
00:42:42,680 --> 00:42:45,410
robbed 33 million the point

1204
00:42:45,410 --> 00:42:46,849
of entry it was a simple truth that

1205
00:42:46,849 --> 00:42:49,240
was 12 years old

1206
00:42:49,990 --> 00:42:52,130
they stayed a long time and with

1207
00:42:52,130 --> 00:42:53,780
several teams a cellar a caf and the

1208
00:42:53,780 --> 00:42:55,819
penetration a coffee after cases studied

1209
00:42:55,819 --> 00:42:58,390
etc etc

1210
00:43:12,470 --> 00:43:13,869
otherwise

1211
00:43:13,869 --> 00:43:17,150
and a small applause s'  please

1212
00:43:17,150 --> 00:43:17,530


1213
00:43:17,530 --> 00:43:22,469
[applause]

