1
00:00:00,480 --> 00:00:03,679
uh thank you for you to join here uh for

2
00:00:03,679 --> 00:00:06,560
the conference uh it's been it's my

3
00:00:06,560 --> 00:00:09,360
second time here so uh let's jump right

4
00:00:09,360 --> 00:00:10,960
into it it's supposed to be a two

5
00:00:10,960 --> 00:00:13,599
speaker talk but my speaker didn't get

6
00:00:13,599 --> 00:00:16,239
the my co-speaker didn't get a visa so

7
00:00:16,239 --> 00:00:18,880
here we are

8
00:00:18,880 --> 00:00:21,840
so uh let's get right into it right uh

9
00:00:21,840 --> 00:00:24,480
my name is aman and i'll start with a

10
00:00:24,480 --> 00:00:26,080
bit of an introduction

11
00:00:26,080 --> 00:00:28,000
uh i've been into

12
00:00:28,000 --> 00:00:29,840
security for a very long time around

13
00:00:29,840 --> 00:00:32,880
nine ten years now started really young

14
00:00:32,880 --> 00:00:34,719
and uh

15
00:00:34,719 --> 00:00:36,640
basically i'm a hacker by profession but

16
00:00:36,640 --> 00:00:38,160
i'm a developer at heart because that's

17
00:00:38,160 --> 00:00:40,719
how i started and

18
00:00:40,719 --> 00:00:44,000
my daily job basically uh used to be red

19
00:00:44,000 --> 00:00:46,160
team and black hat and all that stuff uh

20
00:00:46,160 --> 00:00:47,600
offensive penetration testing and

21
00:00:47,600 --> 00:00:49,280
simulation basically

22
00:00:49,280 --> 00:00:50,879
uh then i switched into social

23
00:00:50,879 --> 00:00:52,640
engineering and uh

24
00:00:52,640 --> 00:00:55,199
phishing simulation and that part of the

25
00:00:55,199 --> 00:00:57,680
red team and now i'm working at vmware

26
00:00:57,680 --> 00:01:00,320
as a security engineer so now i'm on on

27
00:01:00,320 --> 00:01:02,960
the defensive side uh working on uh

28
00:01:02,960 --> 00:01:05,438
trying to get a more get more visibility

29
00:01:05,438 --> 00:01:08,240
as to how the big corporate tech works

30
00:01:08,240 --> 00:01:10,159
you know the bleeding edge how do that

31
00:01:10,159 --> 00:01:12,320
how does that work so i'm doing that

32
00:01:12,320 --> 00:01:14,960
right now and uh basically i talk

33
00:01:14,960 --> 00:01:16,960
security work security and of course i

34
00:01:16,960 --> 00:01:19,280
eat security as you can see so there's

35
00:01:19,280 --> 00:01:20,320
that

36
00:01:20,320 --> 00:01:22,640
and that's what i do uh breathe breathe

37
00:01:22,640 --> 00:01:24,000
this all the time

38
00:01:24,000 --> 00:01:26,560
so uh to give you an idea when when we

39
00:01:26,560 --> 00:01:29,280
used to do red teaming exercises it's

40
00:01:29,280 --> 00:01:31,439
not a standard red teaming exercise that

41
00:01:31,439 --> 00:01:33,600
you might assume where you know the hack

42
00:01:33,600 --> 00:01:35,920
the hack the red team is already inside

43
00:01:35,920 --> 00:01:38,320
and there's an assumed breach scenario

44
00:01:38,320 --> 00:01:39,360
and

45
00:01:39,360 --> 00:01:40,880
there's a blue team involved and they

46
00:01:40,880 --> 00:01:42,320
are you know

47
00:01:42,320 --> 00:01:44,479
the team has an idea of what is the

48
00:01:44,479 --> 00:01:46,399
internal architecture and things like

49
00:01:46,399 --> 00:01:48,000
that but

50
00:01:48,000 --> 00:01:50,479
uh we don't do red team like that

51
00:01:50,479 --> 00:01:51,600
the

52
00:01:51,600 --> 00:01:54,399
agenda is more of an external red team

53
00:01:54,399 --> 00:01:56,799
wherein we simulate a real hack so what

54
00:01:56,799 --> 00:01:58,799
would happen if an organization is

55
00:01:58,799 --> 00:02:01,520
breached right if if a hacker sets his

56
00:02:01,520 --> 00:02:03,680
mind to it uh what could he or she

57
00:02:03,680 --> 00:02:05,600
achieve right what what is the depth

58
00:02:05,600 --> 00:02:07,600
what is the outcome they can achieve so

59
00:02:07,600 --> 00:02:11,120
that's why we don't get uh you know any

60
00:02:11,120 --> 00:02:13,440
some team that comes to us says test my

61
00:02:13,440 --> 00:02:17,280
product instead uh i generally get we we

62
00:02:17,280 --> 00:02:20,400
used to get projects where a cso or even

63
00:02:20,400 --> 00:02:22,640
an investor would come and say okay i

64
00:02:22,640 --> 00:02:24,239
have 20 companies that i have invested

65
00:02:24,239 --> 00:02:26,560
in go show me what you can do what would

66
00:02:26,560 --> 00:02:28,560
happen if somebody tries to breach in

67
00:02:28,560 --> 00:02:31,760
right so this is the case where uh we

68
00:02:31,760 --> 00:02:33,040
were invited

69
00:02:33,040 --> 00:02:36,319
by we actually wanted their project we

70
00:02:36,319 --> 00:02:37,840
were invited by this billion dollar

71
00:02:37,840 --> 00:02:40,800
pharmaceutical company uh which is in in

72
00:02:40,800 --> 00:02:42,560
one of the largest in asia

73
00:02:42,560 --> 00:02:44,640
so they invited us and obviously this

74
00:02:44,640 --> 00:02:47,200
was a big project for a startup and uh

75
00:02:47,200 --> 00:02:49,760
we had to impress them and they said

76
00:02:49,760 --> 00:02:51,920
for projects like us they just give us

77
00:02:51,920 --> 00:02:53,360
the name of the company that's it we

78
00:02:53,360 --> 00:02:56,160
don't get any other information right so

79
00:02:56,160 --> 00:02:57,519
that's that's what happened they gave us

80
00:02:57,519 --> 00:02:59,680
the name of the company and they said uh

81
00:02:59,680 --> 00:03:01,519
get inside i want to see if you can

82
00:03:01,519 --> 00:03:03,680
breach inside the corp network from the

83
00:03:03,680 --> 00:03:05,519
external just the digital perimeter

84
00:03:05,519 --> 00:03:07,920
nothing else and that's how the story

85
00:03:07,920 --> 00:03:10,640
started right and the target was pretty

86
00:03:10,640 --> 00:03:12,400
simple all the web applications the

87
00:03:12,400 --> 00:03:14,720
networks the servers whatever is there

88
00:03:14,720 --> 00:03:17,200
on the internet we were to breach that

89
00:03:17,200 --> 00:03:19,360
we modified that concept of what is a

90
00:03:19,360 --> 00:03:20,879
digital perimeter

91
00:03:20,879 --> 00:03:23,599
which i'll discuss in a moment so uh

92
00:03:23,599 --> 00:03:25,840
that's the objective intra internet to

93
00:03:25,840 --> 00:03:26,879
internet

94
00:03:26,879 --> 00:03:28,879
and you know everybody knows the story

95
00:03:28,879 --> 00:03:31,760
how it goes uh in this type of scenario

96
00:03:31,760 --> 00:03:33,680
you do basic your reconnaissance you

97
00:03:33,680 --> 00:03:36,080
discover the assets the web applications

98
00:03:36,080 --> 00:03:38,640
servers cloud applications uh internal

99
00:03:38,640 --> 00:03:40,640
employee portals which are accessible

100
00:03:40,640 --> 00:03:42,000
information about the employees and

101
00:03:42,000 --> 00:03:44,400
stuff like that and we did that uh we

102
00:03:44,400 --> 00:03:47,200
found uh your standard case of bugs like

103
00:03:47,200 --> 00:03:50,560
sql injections some rces uh some cvs

104
00:03:50,560 --> 00:03:52,239
that were exploited for some information

105
00:03:52,239 --> 00:03:55,040
disclosure and uh some one of the

106
00:03:55,040 --> 00:03:56,640
vulnerable services and misconfigured

107
00:03:56,640 --> 00:03:58,799
services this is your standard uh pen

108
00:03:58,799 --> 00:04:01,519
test outcome right at least for us

109
00:04:01,519 --> 00:04:03,920
so uh this was the

110
00:04:03,920 --> 00:04:07,120
let's have a look at some examples so uh

111
00:04:07,120 --> 00:04:09,360
this was one of kentico cms was one of

112
00:04:09,360 --> 00:04:12,400
the cms that these guys were using and

113
00:04:12,400 --> 00:04:15,120
uh basically this had an sql injection

114
00:04:15,120 --> 00:04:16,320
uh and

115
00:04:16,320 --> 00:04:19,199
dba was true so a strange story there to

116
00:04:19,199 --> 00:04:21,600
an rce but interestingly what we did

117
00:04:21,600 --> 00:04:24,000
inside was as this uh

118
00:04:24,000 --> 00:04:25,600
cms had the

119
00:04:25,600 --> 00:04:27,280
option to send emails

120
00:04:27,280 --> 00:04:29,440
we dug the smtp auth and it had a no

121
00:04:29,440 --> 00:04:31,840
reply at the red company name uh email

122
00:04:31,840 --> 00:04:34,080
address with the password and of course

123
00:04:34,080 --> 00:04:36,400
uh the next step was to you know start

124
00:04:36,400 --> 00:04:38,800
logging in and see what's what's there

125
00:04:38,800 --> 00:04:39,520
so

126
00:04:39,520 --> 00:04:41,040
other than that it had some sap

127
00:04:41,040 --> 00:04:43,440
functionalities which we exploited uh

128
00:04:43,440 --> 00:04:45,520
there were there was a wildcard search

129
00:04:45,520 --> 00:04:48,240
uh in sap which we were able to exploit

130
00:04:48,240 --> 00:04:50,880
and uh from here on we started digging

131
00:04:50,880 --> 00:04:52,720
into finding information about the

132
00:04:52,720 --> 00:04:54,639
employees of the company

133
00:04:54,639 --> 00:04:56,960
to understand what exactly uh which

134
00:04:56,960 --> 00:04:58,479
employee is doing what what kind of

135
00:04:58,479 --> 00:05:01,440
access they might have and uh

136
00:05:01,440 --> 00:05:04,000
other than that there was this air watch

137
00:05:04,000 --> 00:05:06,800
installation which we found uh airwatch

138
00:05:06,800 --> 00:05:09,440
uh i i assume a lot of you already know

139
00:05:09,440 --> 00:05:11,520
isn't a is a mobile device management

140
00:05:11,520 --> 00:05:14,000
solution uh companies have these two uh

141
00:05:14,000 --> 00:05:16,880
to manage employee mobile devices and of

142
00:05:16,880 --> 00:05:19,520
course it has a big ton of feature a lot

143
00:05:19,520 --> 00:05:21,840
of features like installing digital

144
00:05:21,840 --> 00:05:23,759
certificates installing applications

145
00:05:23,759 --> 00:05:25,440
changing wi-fi settings and stuff like

146
00:05:25,440 --> 00:05:26,320
that

147
00:05:26,320 --> 00:05:29,600
and uh this was a test installation

148
00:05:29,600 --> 00:05:31,520
that's what they claimed that this is a

149
00:05:31,520 --> 00:05:34,080
test installation uh and obviously it

150
00:05:34,080 --> 00:05:36,240
was set up we logged in we broke for

151
00:05:36,240 --> 00:05:38,240
some credentials of the employees and it

152
00:05:38,240 --> 00:05:40,560
said your password has expired please

153
00:05:40,560 --> 00:05:43,120
reset so we said gladly so we did reset

154
00:05:43,120 --> 00:05:46,160
the password got inside and uh basically

155
00:05:46,160 --> 00:05:49,440
we had access to around 100

156
00:05:49,440 --> 00:05:51,199
employees

157
00:05:51,199 --> 00:05:54,080
which the application was installed it

158
00:05:54,080 --> 00:05:56,160
was pushed to those phones

159
00:05:56,160 --> 00:05:58,560
as part of a test group but never

160
00:05:58,560 --> 00:06:00,800
removed so they stopped using airwatch

161
00:06:00,800 --> 00:06:02,800
but the payload was still there in the

162
00:06:02,800 --> 00:06:05,759
mobile devices and we reactivated the

163
00:06:05,759 --> 00:06:08,080
airwatch from here and we started you

164
00:06:08,080 --> 00:06:09,680
know getting inside uh the mobile

165
00:06:09,680 --> 00:06:11,360
devices uh

166
00:06:11,360 --> 00:06:13,840
once you are in with an mdma solution uh

167
00:06:13,840 --> 00:06:16,800
sorry uh mobile mdm solution you get

168
00:06:16,800 --> 00:06:19,039
inside and you change you can do a lot

169
00:06:19,039 --> 00:06:21,919
of stuff so we change the wi-fi settings

170
00:06:21,919 --> 00:06:24,960
install uh uh add a phone ap and go to

171
00:06:24,960 --> 00:06:27,039
the campus have the victim connect to

172
00:06:27,039 --> 00:06:29,199
your fake hotspot install your digital

173
00:06:29,199 --> 00:06:31,840
signatures https signatures ssl

174
00:06:31,840 --> 00:06:32,960
signatures

175
00:06:32,960 --> 00:06:34,160
so that once they connect to your

176
00:06:34,160 --> 00:06:36,160
hotspot you get their traffic right we

177
00:06:36,160 --> 00:06:38,160
did that we even did uh use this

178
00:06:38,160 --> 00:06:40,080
information carried out some phishing

179
00:06:40,080 --> 00:06:42,560
attacks uh although even if they were

180
00:06:42,560 --> 00:06:44,560
protected with two-factor authentication

181
00:06:44,560 --> 00:06:48,080
but evil zinc's uh two very tool

182
00:06:48,080 --> 00:06:49,520
i suppose a lot of you might know about

183
00:06:49,520 --> 00:06:52,080
it uh helps you fish two fa credentials

184
00:06:52,080 --> 00:06:53,680
too by uh

185
00:06:53,680 --> 00:06:55,919
by some neat tricks uh which i won't be

186
00:06:55,919 --> 00:06:58,560
able to begin right now but yeah the

187
00:06:58,560 --> 00:07:00,479
once that was done we were able to gain

188
00:07:00,479 --> 00:07:02,560
access to the email accounts of 10

189
00:07:02,560 --> 00:07:04,720
employees out of 100

190
00:07:04,720 --> 00:07:06,720
which was a fair deal

191
00:07:06,720 --> 00:07:07,520
and

192
00:07:07,520 --> 00:07:10,160
meanwhile uh let's let's have a look at

193
00:07:10,160 --> 00:07:11,360
some other

194
00:07:11,360 --> 00:07:14,000
uh os n that we did so when we look at a

195
00:07:14,000 --> 00:07:16,639
standard approach of trying to attack

196
00:07:16,639 --> 00:07:19,520
these uh employees you look for deep web

197
00:07:19,520 --> 00:07:22,880
credentials telegram bots and online

198
00:07:22,880 --> 00:07:25,520
deep web leaks public leaks all of that

199
00:07:25,520 --> 00:07:26,240
we

200
00:07:26,240 --> 00:07:28,960
as me as retima and my colleagues we

201
00:07:28,960 --> 00:07:31,599
keep on dumping these leaks uh at a

202
00:07:31,599 --> 00:07:33,919
constant on mega and stuff like that

203
00:07:33,919 --> 00:07:36,240
huge massive databases and we keep

204
00:07:36,240 --> 00:07:37,919
indexing them so that

205
00:07:37,919 --> 00:07:39,520
whatever kind of data leak is there

206
00:07:39,520 --> 00:07:41,199
regardless whether it is a password or

207
00:07:41,199 --> 00:07:42,880
it's just emails or it's just mobile

208
00:07:42,880 --> 00:07:45,360
phones mobile numbers or stuff like that

209
00:07:45,360 --> 00:07:48,160
we keep uh collecting these dumps right

210
00:07:48,160 --> 00:07:50,560
and uh this is uh this is the standard

211
00:07:50,560 --> 00:07:53,680
approach but we take it another step we

212
00:07:53,680 --> 00:07:56,080
stalk those people stalk the employees

213
00:07:56,080 --> 00:07:57,599
we go through their facebook instagram

214
00:07:57,599 --> 00:07:59,360
and stuff linkedin

215
00:07:59,360 --> 00:08:01,840
send them invites have a chat with them

216
00:08:01,840 --> 00:08:04,319
uh trying to get more information and

217
00:08:04,319 --> 00:08:06,479
then we even try to look uh we attack

218
00:08:06,479 --> 00:08:07,280
this

219
00:08:07,280 --> 00:08:09,039
once we get more information about the

220
00:08:09,039 --> 00:08:11,280
kind of employees so a developer would

221
00:08:11,280 --> 00:08:13,680
have access to more information uh hr

222
00:08:13,680 --> 00:08:15,440
would have access to lms system right

223
00:08:15,440 --> 00:08:18,080
stuff like that so we categorize these

224
00:08:18,080 --> 00:08:20,160
employees and we target them right we

225
00:08:20,160 --> 00:08:22,400
try to find stuff like slack github

226
00:08:22,400 --> 00:08:24,240
accounts azure

227
00:08:24,240 --> 00:08:28,000
and these things g suit o365 and we also

228
00:08:28,000 --> 00:08:30,160
then try to map these employees to their

229
00:08:30,160 --> 00:08:32,159
personal accounts or see if these

230
00:08:32,159 --> 00:08:34,799
employees are using their uh

231
00:08:34,799 --> 00:08:37,279
employee email addresses company emails

232
00:08:37,279 --> 00:08:38,240
on

233
00:08:38,240 --> 00:08:40,559
non-standard websites i've seen people

234
00:08:40,559 --> 00:08:42,399
using company email addresses on food

235
00:08:42,399 --> 00:08:44,240
delivery websites travel websites even

236
00:08:44,240 --> 00:08:45,360
dating websites i don't know what

237
00:08:45,360 --> 00:08:47,200
they're doing finding someone for their

238
00:08:47,200 --> 00:08:48,320
hr

239
00:08:48,320 --> 00:08:49,519
but

240
00:08:49,519 --> 00:08:51,760
that's there so once we get into these

241
00:08:51,760 --> 00:08:53,839
accounts which are informal accounts you

242
00:08:53,839 --> 00:08:56,880
get a lot of internal uh working of the

243
00:08:56,880 --> 00:08:59,120
person uh which we are trying to attack

244
00:08:59,120 --> 00:09:01,760
right so uh this you you can refer to

245
00:09:01,760 --> 00:09:02,880
awesome os

246
00:09:02,880 --> 00:09:05,120
for more information but yeah once we

247
00:09:05,120 --> 00:09:07,120
started doing that uh we were able to

248
00:09:07,120 --> 00:09:08,560
get inside the business management

249
00:09:08,560 --> 00:09:10,399
portal uh with the credentials that we

250
00:09:10,399 --> 00:09:12,000
had accessed before

251
00:09:12,000 --> 00:09:13,839
and you know

252
00:09:13,839 --> 00:09:15,760
but we hit the roadblock

253
00:09:15,760 --> 00:09:18,880
once we had these 10 employees

254
00:09:18,880 --> 00:09:21,279
we got this message that says

255
00:09:21,279 --> 00:09:24,480
otp is required when accessing the panel

256
00:09:24,480 --> 00:09:26,800
from an untrusted network so we had the

257
00:09:26,800 --> 00:09:29,120
passwords it was built on ruby on rails

258
00:09:29,120 --> 00:09:31,040
only a login page not much functionality

259
00:09:31,040 --> 00:09:34,000
we weren't able to breach it so uh but

260
00:09:34,000 --> 00:09:36,399
so we stopped here now this is a poc

261
00:09:36,399 --> 00:09:38,399
right we are doing this to impress the

262
00:09:38,399 --> 00:09:41,200
cso uh and tell him that yes we can get

263
00:09:41,200 --> 00:09:43,279
in if you give us the full project and

264
00:09:43,279 --> 00:09:45,440
the story so far is we did gain access

265
00:09:45,440 --> 00:09:48,160
to some employee accounts we had rce on

266
00:09:48,160 --> 00:09:49,680
a couple of servers

267
00:09:49,680 --> 00:09:51,600
cloud servers and one of the internal

268
00:09:51,600 --> 00:09:53,360
servers as well so we could say we are

269
00:09:53,360 --> 00:09:55,200
in the co-op uh

270
00:09:55,200 --> 00:09:57,040
we had access to ton of customer data

271
00:09:57,040 --> 00:09:58,399
because we had access to some sap

272
00:09:58,399 --> 00:10:00,880
instances and a lot of business logic

273
00:10:00,880 --> 00:10:03,120
issues some idols and stuff so we had

274
00:10:03,120 --> 00:10:04,640
access to their medical records and

275
00:10:04,640 --> 00:10:06,959
stuff which this company does by the way

276
00:10:06,959 --> 00:10:09,200
to give you a quick overview they make

277
00:10:09,200 --> 00:10:11,360
they make medicines they experiment on

278
00:10:11,360 --> 00:10:13,440
medicines they

279
00:10:13,440 --> 00:10:14,880
sell formulas

280
00:10:14,880 --> 00:10:17,360
they they do bottling packaging labeling

281
00:10:17,360 --> 00:10:20,079
of medicines so everything they they

282
00:10:20,079 --> 00:10:21,600
you can hire them they will come to your

283
00:10:21,600 --> 00:10:23,360
house collect your samples give you a

284
00:10:23,360 --> 00:10:25,600
blood test so this is they do everything

285
00:10:25,600 --> 00:10:26,480
right

286
00:10:26,480 --> 00:10:27,279
and

287
00:10:27,279 --> 00:10:30,240
the crown jewels uh is what we got to

288
00:10:30,240 --> 00:10:32,720
next so at this point

289
00:10:32,720 --> 00:10:34,640
uh we could have concluded the activity

290
00:10:34,640 --> 00:10:36,560
could have concluded the poc and told

291
00:10:36,560 --> 00:10:38,480
them see we already have a bit of access

292
00:10:38,480 --> 00:10:40,959
now give us the full project but uh i

293
00:10:40,959 --> 00:10:42,720
really had this thing at the back of my

294
00:10:42,720 --> 00:10:44,560
head now we have to get inside this

295
00:10:44,560 --> 00:10:47,120
employee panel and that's why i decided

296
00:10:47,120 --> 00:10:48,880
to do something interesting

297
00:10:48,880 --> 00:10:51,600
uh we decided to go war driving right

298
00:10:51,600 --> 00:10:55,120
now imagine this is a massive uh campus

299
00:10:55,120 --> 00:10:57,440
uh thousands of square kilometers so

300
00:10:57,440 --> 00:10:59,440
there are factories inside there are

301
00:10:59,440 --> 00:11:01,519
scada systems there are employees

302
00:11:01,519 --> 00:11:03,040
working there there are scientists

303
00:11:03,040 --> 00:11:04,240
working there

304
00:11:04,240 --> 00:11:06,000
everything is inside it's a massive

305
00:11:06,000 --> 00:11:08,399
campus we are there and this is for

306
00:11:08,399 --> 00:11:11,519
dramatization but yeah this is me in the

307
00:11:11,519 --> 00:11:13,839
front seat my co-speaker in the back

308
00:11:13,839 --> 00:11:16,399
seat our bonnets open at the middle of

309
00:11:16,399 --> 00:11:18,800
the night in front of the campus uh

310
00:11:18,800 --> 00:11:20,480
showing we have opened the laptop right

311
00:11:20,480 --> 00:11:22,079
now for the

312
00:11:22,079 --> 00:11:23,920
uh for the purpose of the picture but

313
00:11:23,920 --> 00:11:26,160
yeah it was not this glowy and uh

314
00:11:26,160 --> 00:11:28,640
basically what we did over here is we

315
00:11:28,640 --> 00:11:30,560
parked our cars we were war driving we

316
00:11:30,560 --> 00:11:32,160
tried to see what kind of wi-fi signals

317
00:11:32,160 --> 00:11:35,079
we were able to capture uh mostly it was

318
00:11:35,079 --> 00:11:38,640
802.1x uh wpa2 enterprise uh

319
00:11:38,640 --> 00:11:40,800
and there was some open guest wi-fi's

320
00:11:40,800 --> 00:11:42,720
right and when you have guest wi-fi's

321
00:11:42,720 --> 00:11:44,240
you know what you do of course they were

322
00:11:44,240 --> 00:11:46,079
dmz'ed and all uh all of that were

323
00:11:46,079 --> 00:11:47,680
present but

324
00:11:47,680 --> 00:11:49,680
basically we tried the next objective

325
00:11:49,680 --> 00:11:51,920
was to militarize the dmz right

326
00:11:51,920 --> 00:11:53,839
so we parked our vehicle on the roadside

327
00:11:53,839 --> 00:11:55,600
and we started to trying to bypass this

328
00:11:55,600 --> 00:11:56,480
dmc

329
00:11:56,480 --> 00:11:58,399
and after a bit of recon we found a

330
00:11:58,399 --> 00:12:01,760
redundant switch a cisco switch uh

331
00:12:01,760 --> 00:12:06,079
which had uh 2801 cisco ios281 which had

332
00:12:06,079 --> 00:12:08,880
an rce so we gained root access and we

333
00:12:08,880 --> 00:12:11,360
added a simple rule in the dmz to allow

334
00:12:11,360 --> 00:12:13,760
us to get inside the network now if you

335
00:12:13,760 --> 00:12:15,839
remember the

336
00:12:15,839 --> 00:12:18,000
if you remember the last problem we had

337
00:12:18,000 --> 00:12:20,000
the error message on the employee login

338
00:12:20,000 --> 00:12:22,880
panel said uh you need an otp if you're

339
00:12:22,880 --> 00:12:25,040
logging from an untrusted network but

340
00:12:25,040 --> 00:12:26,880
hey we're trying to get inside a trusted

341
00:12:26,880 --> 00:12:29,200
network so it's the standard story once

342
00:12:29,200 --> 00:12:32,880
we get a shell it's standard your uh

343
00:12:32,880 --> 00:12:34,639
random stuff you run responder you run

344
00:12:34,639 --> 00:12:36,160
some partial scripts

345
00:12:36,160 --> 00:12:39,200
you run your cobalt strike c2 and

346
00:12:39,200 --> 00:12:41,279
obviously windows machines are there uh

347
00:12:41,279 --> 00:12:42,959
there are most of the times they are

348
00:12:42,959 --> 00:12:44,720
misconfigured and i'll tell you why they

349
00:12:44,720 --> 00:12:46,399
were misconfigured in this organization

350
00:12:46,399 --> 00:12:48,639
a lot which we'll come to later but we

351
00:12:48,639 --> 00:12:50,639
started getting uh ntlm hashes in

352
00:12:50,639 --> 00:12:52,560
responder and then we were able to get

353
00:12:52,560 --> 00:12:53,360
uh

354
00:12:53,360 --> 00:12:55,680
with the c3 uh we were able to get a

355
00:12:55,680 --> 00:12:57,200
persistent access

356
00:12:57,200 --> 00:12:59,120
and this is a responder in action we

357
00:12:59,120 --> 00:13:01,440
gained an access on powershell scripts

358
00:13:01,440 --> 00:13:03,839
with cobalt strike and then finally we

359
00:13:03,839 --> 00:13:05,360
gained access to one of the machines

360
00:13:05,360 --> 00:13:08,079
which was part of the secured network

361
00:13:08,079 --> 00:13:09,600
and voila

362
00:13:09,600 --> 00:13:11,040
no more otp

363
00:13:11,040 --> 00:13:13,519
right this is the same employee panel

364
00:13:13,519 --> 00:13:15,680
which has no otp now and now we can

365
00:13:15,680 --> 00:13:17,440
finally log in

366
00:13:17,440 --> 00:13:19,279
using the credentials of the

367
00:13:19,279 --> 00:13:21,120
employees which we found before

368
00:13:21,120 --> 00:13:22,480
so at this point

369
00:13:22,480 --> 00:13:24,560
we concluded the poc the client was

370
00:13:24,560 --> 00:13:27,040
pretty impressed and he gave us a go

371
00:13:27,040 --> 00:13:29,920
that okay you can now go and you know

372
00:13:29,920 --> 00:13:32,000
come into our campus do a proper

373
00:13:32,000 --> 00:13:34,959
internal rec team uh in an assumed

374
00:13:34,959 --> 00:13:36,240
breach scenario

375
00:13:36,240 --> 00:13:38,000
of course we could have shown him that

376
00:13:38,000 --> 00:13:40,160
we can now escalate inside into the corp

377
00:13:40,160 --> 00:13:42,000
network find some servers stuff like

378
00:13:42,000 --> 00:13:45,040
that he didn't uh we didn't entertain

379
00:13:45,040 --> 00:13:47,120
that he simply called us to the campus

380
00:13:47,120 --> 00:13:49,600
for a one and a half month uh red team

381
00:13:49,600 --> 00:13:52,639
exercise and we flew there

382
00:13:52,639 --> 00:13:54,800
inside this massive campus which had

383
00:13:54,800 --> 00:13:56,800
really strict rules like rules to which

384
00:13:56,800 --> 00:13:58,000
side of the road you are supposed to

385
00:13:58,000 --> 00:14:00,639
walk on and not crossing the road this

386
00:14:00,639 --> 00:14:02,160
is an internal campus right internal

387
00:14:02,160 --> 00:14:04,480
roads with very strict rules and bad

388
00:14:04,480 --> 00:14:05,440
food

389
00:14:05,440 --> 00:14:08,639
but yeah so we reached there and now the

390
00:14:08,639 --> 00:14:11,839
objective was to pivot avoid the sock

391
00:14:11,839 --> 00:14:13,440
which is there obviously

392
00:14:13,440 --> 00:14:15,120
they didn't have a proper blue team but

393
00:14:15,120 --> 00:14:17,920
they had a stock of sorts and the agenda

394
00:14:17,920 --> 00:14:20,959
was to exfil uh data right so we have

395
00:14:20,959 --> 00:14:23,199
already discussed the environment it's a

396
00:14:23,199 --> 00:14:24,959
pharmaceutical brand campus multiple

397
00:14:24,959 --> 00:14:27,839
buildings the network security team uh

398
00:14:27,839 --> 00:14:32,160
were very boasty they were like yeah

399
00:14:32,320 --> 00:14:33,199
we we

400
00:14:33,199 --> 00:14:35,199
have not been hacked and stuff and they

401
00:14:35,199 --> 00:14:37,120
were very qualified i wouldn't say they

402
00:14:37,120 --> 00:14:38,480
were very

403
00:14:38,480 --> 00:14:39,920
i wouldn't want to say they were very

404
00:14:39,920 --> 00:14:41,760
good but they were very qualified as in

405
00:14:41,760 --> 00:14:44,240
they had several phds and stuff but i

406
00:14:44,240 --> 00:14:45,760
don't know if i'll call them good after

407
00:14:45,760 --> 00:14:48,000
the exercise but

408
00:14:48,000 --> 00:14:49,519
the network security team was yeah

409
00:14:49,519 --> 00:14:52,160
pretty pretty boosty and they had of

410
00:14:52,160 --> 00:14:54,880
course all the uh internal firewalls

411
00:14:54,880 --> 00:14:57,279
nating and dlps and vlans set up

412
00:14:57,279 --> 00:15:00,079
properly uh of course we try to find

413
00:15:00,079 --> 00:15:02,560
ways into that but yeah uh other than

414
00:15:02,560 --> 00:15:04,240
that as i told you there was strict

415
00:15:04,240 --> 00:15:06,320
compliance and access control rules uh

416
00:15:06,320 --> 00:15:08,880
physically so that you couldn't tailgate

417
00:15:08,880 --> 00:15:10,480
very easily so

418
00:15:10,480 --> 00:15:11,760
that's our standard approach but we

419
00:15:11,760 --> 00:15:13,120
didn't do that here

420
00:15:13,120 --> 00:15:15,839
so once we are inside uh generally of

421
00:15:15,839 --> 00:15:17,600
course in a standard red team activity

422
00:15:17,600 --> 00:15:19,839
you go and have a meeting with the uh

423
00:15:19,839 --> 00:15:21,760
the top people and you ask them what

424
00:15:21,760 --> 00:15:23,680
exactly are your crown jewels so that's

425
00:15:23,680 --> 00:15:26,560
what we did so in this case scenario uh

426
00:15:26,560 --> 00:15:28,880
we basically had the ics systems there

427
00:15:28,880 --> 00:15:30,560
there was scada for all the machines

428
00:15:30,560 --> 00:15:32,240
that were doing all the bottling

429
00:15:32,240 --> 00:15:34,880
labeling stuff uh then the most

430
00:15:34,880 --> 00:15:36,320
important crown jewels were the

431
00:15:36,320 --> 00:15:38,160
scientific data and the medicine

432
00:15:38,160 --> 00:15:40,560
formulas so as i told you there were

433
00:15:40,560 --> 00:15:42,399
experimental chambers where there were

434
00:15:42,399 --> 00:15:44,480
people in lab coats doing their

435
00:15:44,480 --> 00:15:47,680
experiments so they have their notes

436
00:15:47,680 --> 00:15:49,360
they write down their notes they have

437
00:15:49,360 --> 00:15:51,839
sensors uh that measure temperature and

438
00:15:51,839 --> 00:15:53,839
all of all of the other readings so for

439
00:15:53,839 --> 00:15:56,079
us it was very fascinating right me

440
00:15:56,079 --> 00:15:57,839
particularly i'm a very massive science

441
00:15:57,839 --> 00:15:59,680
enthusiast not as a hacker but i was

442
00:15:59,680 --> 00:16:00,959
very

443
00:16:00,959 --> 00:16:03,199
very excited to see all of that that on

444
00:16:03,199 --> 00:16:05,040
one side of the room there are people

445
00:16:05,040 --> 00:16:06,320
sitting in

446
00:16:06,320 --> 00:16:09,120
like casuals and on uh like working on

447
00:16:09,120 --> 00:16:11,120
hr and on the other side of the wall

448
00:16:11,120 --> 00:16:13,040
there are scientists working with cool

449
00:16:13,040 --> 00:16:14,399
technology right so it was very

450
00:16:14,399 --> 00:16:16,320
fascinating for me personally uh but

451
00:16:16,320 --> 00:16:17,839
yeah so these were the crown jewels

452
00:16:17,839 --> 00:16:20,079
right the central medicinal database the

453
00:16:20,079 --> 00:16:22,079
notes that these

454
00:16:22,079 --> 00:16:24,639
scientists were taking and these sensors

455
00:16:24,639 --> 00:16:26,240
which are there right which are doing

456
00:16:26,240 --> 00:16:27,600
all of that stuff and of course there

457
00:16:27,600 --> 00:16:29,519
are other stuff which we'll get into

458
00:16:29,519 --> 00:16:31,759
so and coming to the access that we were

459
00:16:31,759 --> 00:16:32,880
provided

460
00:16:32,880 --> 00:16:35,600
we got a simple standard employee lan

461
00:16:35,600 --> 00:16:36,800
access

462
00:16:36,800 --> 00:16:39,360
uh they gave us a laptop uh

463
00:16:39,360 --> 00:16:41,759
and they said okay we have whitelisted

464
00:16:41,759 --> 00:16:44,959
your mac uh two laptops only connect it

465
00:16:44,959 --> 00:16:47,600
and this is uh obviously this was a vlan

466
00:16:47,600 --> 00:16:50,160
with very limited access and uh of

467
00:16:50,160 --> 00:16:50,959
course

468
00:16:50,959 --> 00:16:53,600
as part of the crown jewels we did ask

469
00:16:53,600 --> 00:16:55,920
for a detailed list of all critical

470
00:16:55,920 --> 00:16:58,720
servers all critical wi-fi networks and

471
00:16:58,720 --> 00:17:01,199
uh all the vlans and their restrictions

472
00:17:01,199 --> 00:17:03,040
so that we don't have to map that out we

473
00:17:03,040 --> 00:17:04,880
did that as part because we impressed

474
00:17:04,880 --> 00:17:06,480
them they were able to in the first

475
00:17:06,480 --> 00:17:08,079
exercise they were able to give us this

476
00:17:08,079 --> 00:17:09,839
information in detail so this is the

477
00:17:09,839 --> 00:17:11,280
kind of access we proved we were

478
00:17:11,280 --> 00:17:13,520
provided and we jumped into the standard

479
00:17:13,520 --> 00:17:15,520
approach uh everybody is from familiar

480
00:17:15,520 --> 00:17:18,160
with this skip out the external recon

481
00:17:18,160 --> 00:17:20,880
and external compromise uh as in an

482
00:17:20,880 --> 00:17:22,640
assumed brief scenario you find

483
00:17:22,640 --> 00:17:24,559
footholds you try to escalate to a

484
00:17:24,559 --> 00:17:26,319
higher privilege you then you do

485
00:17:26,319 --> 00:17:28,160
internal recon into that network do

486
00:17:28,160 --> 00:17:30,320
lateral movement and keep doing the

487
00:17:30,320 --> 00:17:32,400
repeating the cycle till you get in uh

488
00:17:32,400 --> 00:17:34,320
your crown jewels

489
00:17:34,320 --> 00:17:36,720
but first things first uh what do you do

490
00:17:36,720 --> 00:17:38,720
when your nmap scan is running we had to

491
00:17:38,720 --> 00:17:40,160
play pubg or

492
00:17:40,160 --> 00:17:41,919
modern warfare or something

493
00:17:41,919 --> 00:17:43,760
but they didn't have access to they

494
00:17:43,760 --> 00:17:47,280
didn't give us access to wi-fi so

495
00:17:47,280 --> 00:17:50,000
because we are hackers so called uh we

496
00:17:50,000 --> 00:17:52,400
created a lan hotspot with our wi-fi

497
00:17:52,400 --> 00:17:54,000
with our laptops to

498
00:17:54,000 --> 00:17:56,880
play pubg but yeah there's that uh phase

499
00:17:56,880 --> 00:17:59,440
two now gaining access pivoting and

500
00:17:59,440 --> 00:18:01,520
escalating now this is where we try to

501
00:18:01,520 --> 00:18:02,960
start digging in

502
00:18:02,960 --> 00:18:05,039
inside the network and see what's

503
00:18:05,039 --> 00:18:07,520
happening so again standard approach you

504
00:18:07,520 --> 00:18:10,320
do recon you do port scan service scans

505
00:18:10,320 --> 00:18:12,640
you see what vlan you are able to access

506
00:18:12,640 --> 00:18:14,720
create a map of sorts uh do some

507
00:18:14,720 --> 00:18:17,280
sniffing responder again comes to rescue

508
00:18:17,280 --> 00:18:18,960
uh you do the ada enumeration of course

509
00:18:18,960 --> 00:18:20,160
find what kind of active directory

510
00:18:20,160 --> 00:18:22,000
environment you are in how many forests

511
00:18:22,000 --> 00:18:24,240
are there or of that information which

512
00:18:24,240 --> 00:18:26,799
i'm sure you all are familiar with uh

513
00:18:26,799 --> 00:18:29,919
we even uh do internal phishing uh and

514
00:18:29,919 --> 00:18:32,160
by internal phishing i wouldn't uh

515
00:18:32,160 --> 00:18:34,720
actually like not only sending emails

516
00:18:34,720 --> 00:18:37,280
but i uh like to go to the extent of

517
00:18:37,280 --> 00:18:40,000
wherever i find uh a internal web server

518
00:18:40,000 --> 00:18:42,480
which has some login panel i'll i'll

519
00:18:42,480 --> 00:18:44,000
hijack the login panel so that it is

520
00:18:44,000 --> 00:18:46,480
sending me credentials i'll hijack

521
00:18:46,480 --> 00:18:48,080
internal applications instead of

522
00:18:48,080 --> 00:18:50,160
phishing them i'll just poison uh the

523
00:18:50,160 --> 00:18:51,440
applications which i have access to

524
00:18:51,440 --> 00:18:54,240
right so that i get credentials so uh

525
00:18:54,240 --> 00:18:55,840
yeah there's that then of course

526
00:18:55,840 --> 00:18:57,440
bloodhound death star stuff like that

527
00:18:57,440 --> 00:19:00,160
for uh creating a map about the

528
00:19:00,160 --> 00:19:01,919
active directory network and the acl

529
00:19:01,919 --> 00:19:04,559
enumeration now from this standard stuff

530
00:19:04,559 --> 00:19:06,480
port scanning and all of that stuff uh

531
00:19:06,480 --> 00:19:08,240
we got access to something called hp

532
00:19:08,240 --> 00:19:10,160
data protect sp data protect is

533
00:19:10,160 --> 00:19:11,280
basically

534
00:19:11,280 --> 00:19:14,480
a backup management software and

535
00:19:14,480 --> 00:19:16,400
it was a very old version again i'll

536
00:19:16,400 --> 00:19:19,360
come to this why but this had an rc in

537
00:19:19,360 --> 00:19:20,720
the main

538
00:19:20,720 --> 00:19:23,520
just had an rc and because the backup

539
00:19:23,520 --> 00:19:25,679
provider has to be connected to multiple

540
00:19:25,679 --> 00:19:28,160
vlans it has to be connected to employee

541
00:19:28,160 --> 00:19:30,559
machines as well as the main machines uh

542
00:19:30,559 --> 00:19:32,559
once we had an rc on the hp data protect

543
00:19:32,559 --> 00:19:34,799
server uh we were able to gain access to

544
00:19:34,799 --> 00:19:36,160
the main network we jumped from the

545
00:19:36,160 --> 00:19:38,240
employee network to the internal network

546
00:19:38,240 --> 00:19:40,160
right and

547
00:19:40,160 --> 00:19:42,559
once we did that we i found uh there

548
00:19:42,559 --> 00:19:44,559
were some internal applications running

549
00:19:44,559 --> 00:19:46,559
and again when pen testing internal

550
00:19:46,559 --> 00:19:49,280
applications i found an adminer instance

551
00:19:49,280 --> 00:19:52,160
uh and let's look at that so this is

552
00:19:52,160 --> 00:19:53,520
actually data protect of course it runs

553
00:19:53,520 --> 00:19:55,600
as anti-authority system so once there

554
00:19:55,600 --> 00:19:58,160
was an rce we owned the system and from

555
00:19:58,160 --> 00:20:00,000
there on of course mimi cards and stuff

556
00:20:00,000 --> 00:20:01,840
like that of course uh you do this in

557
00:20:01,840 --> 00:20:05,039
memory to avoid uh dlps and stuff uh and

558
00:20:05,039 --> 00:20:06,480
the introducing introducing detection

559
00:20:06,480 --> 00:20:08,000
systems and avs

560
00:20:08,000 --> 00:20:09,280
uh you do

561
00:20:09,280 --> 00:20:11,039
cobalt strike is very very powerful with

562
00:20:11,039 --> 00:20:13,679
that in memory injection and uh

563
00:20:13,679 --> 00:20:15,039
so that these

564
00:20:15,039 --> 00:20:16,880
signature based and behavioral base are

565
00:20:16,880 --> 00:20:18,960
not able to capture it uh but yeah not

566
00:20:18,960 --> 00:20:20,640
getting deep into that but we were able

567
00:20:20,640 --> 00:20:23,360
to extract credentials and as i told you

568
00:20:23,360 --> 00:20:25,919
uh i found a adminer instance uh which

569
00:20:25,919 --> 00:20:27,679
was running slightly older version had

570
00:20:27,679 --> 00:20:30,159
an ssrf not very not not a lot of

571
00:20:30,159 --> 00:20:32,400
exploits on this but yeah there was a

572
00:20:32,400 --> 00:20:33,919
way where you can where you could set up

573
00:20:33,919 --> 00:20:35,840
a custom mysql server and the

574
00:20:35,840 --> 00:20:38,960
vulnerability basically allowed you to

575
00:20:38,960 --> 00:20:41,440
connect to an external server but still

576
00:20:41,440 --> 00:20:44,480
use the mysql instance to get the files

577
00:20:44,480 --> 00:20:46,400
of the addminer instance so this is a

578
00:20:46,400 --> 00:20:48,320
very interesting issue uh that was there

579
00:20:48,320 --> 00:20:50,640
in adminer uh which allowed me to do a

580
00:20:50,640 --> 00:20:53,600
local infile uh command with mysql and

581
00:20:53,600 --> 00:20:56,480
get the uh critical files of the adminer

582
00:20:56,480 --> 00:20:58,880
instance right so uh

583
00:20:58,880 --> 00:21:00,880
basically once i was able to get inside

584
00:21:00,880 --> 00:21:03,440
the adminer i ran some local n-file to

585
00:21:03,440 --> 00:21:05,360
this is an example poc to get the etc

586
00:21:05,360 --> 00:21:07,360
password but later on we got more

587
00:21:07,360 --> 00:21:10,000
information and uh obviously as this was

588
00:21:10,000 --> 00:21:11,679
this was some kind of a blog internal

589
00:21:11,679 --> 00:21:14,240
blog that was there

590
00:21:14,240 --> 00:21:15,600
and it was running on wordpress so

591
00:21:15,600 --> 00:21:17,440
obviously the first thing that you do is

592
00:21:17,440 --> 00:21:20,080
read the wp config and that's what i did

593
00:21:20,080 --> 00:21:21,600
gain access to the

594
00:21:21,600 --> 00:21:24,240
database uh credentials and as we were

595
00:21:24,240 --> 00:21:26,159
already had an adminer gain access to

596
00:21:26,159 --> 00:21:28,720
the database itself right uh logged in

597
00:21:28,720 --> 00:21:30,480
as admin to wordpress once we had access

598
00:21:30,480 --> 00:21:32,159
to adminer changed the wordpress

599
00:21:32,159 --> 00:21:34,880
password hash i got access to wordpress

600
00:21:34,880 --> 00:21:37,760
uh uploaded a shell and uh owned that

601
00:21:37,760 --> 00:21:40,559
server right uh so there was that uh we

602
00:21:40,559 --> 00:21:43,120
were other than that we started recon on

603
00:21:43,120 --> 00:21:44,880
other servers because this was one of

604
00:21:44,880 --> 00:21:47,039
the dev machine the dev was working on

605
00:21:47,039 --> 00:21:49,440
uh this blog website uh it was part of

606
00:21:49,440 --> 00:21:51,200
the dev network the it was a test

607
00:21:51,200 --> 00:21:53,360
environment but the dev had access to it

608
00:21:53,360 --> 00:21:56,559
right so we had to poison it and in the

609
00:21:56,559 --> 00:21:58,240
dev network there were other interesting

610
00:21:58,240 --> 00:22:00,640
things because these uh developers were

611
00:22:00,640 --> 00:22:02,960
hosting applications very poorly there

612
00:22:02,960 --> 00:22:03,919
were

613
00:22:03,919 --> 00:22:06,080
rmi instances running so we created

614
00:22:06,080 --> 00:22:09,760
custom beans uh with s-jet uh which uh i

615
00:22:09,760 --> 00:22:11,840
assume you are aware of but if not

616
00:22:11,840 --> 00:22:13,679
search it out it's a it's pretty neat

617
00:22:13,679 --> 00:22:14,480
tool

618
00:22:14,480 --> 00:22:16,559
to create custom beans and exploit

619
00:22:16,559 --> 00:22:19,039
vulnerable rmi instances so there was

620
00:22:19,039 --> 00:22:21,520
that uh with the sj we were able to gain

621
00:22:21,520 --> 00:22:24,240
access to one of the servers

622
00:22:24,240 --> 00:22:26,640
and then one of the credentials uh with

623
00:22:26,640 --> 00:22:28,320
with one of the credentials we gained

624
00:22:28,320 --> 00:22:30,400
access to a dev dev system which was

625
00:22:30,400 --> 00:22:32,720
running in oracle db now when we come to

626
00:22:32,720 --> 00:22:35,679
this oracle db uh this database was very

627
00:22:35,679 --> 00:22:38,080
critical but the problem was

628
00:22:38,080 --> 00:22:40,480
uh even if we have access to this

629
00:22:40,480 --> 00:22:43,679
database it won't help a lot why because

630
00:22:43,679 --> 00:22:45,840
all of the information like all of the

631
00:22:45,840 --> 00:22:48,559
scientists notes all of the formulas all

632
00:22:48,559 --> 00:22:51,039
of that stuff is encrypted completely

633
00:22:51,039 --> 00:22:52,960
right in transit and even when it is

634
00:22:52,960 --> 00:22:54,960
stored in the database right but uh

635
00:22:54,960 --> 00:22:57,280
basically what we did over here is uh

636
00:22:57,280 --> 00:22:59,679
once we were inside the dev network we

637
00:22:59,679 --> 00:23:01,600
did some password spraying we did some

638
00:23:01,600 --> 00:23:03,520
brute forcing uh

639
00:23:03,520 --> 00:23:05,760
and we were able to gain access to uh

640
00:23:05,760 --> 00:23:07,679
some of the internal employees from all

641
00:23:07,679 --> 00:23:09,919
of this action that we did we were able

642
00:23:09,919 --> 00:23:11,919
to capture some uh email addresses and

643
00:23:11,919 --> 00:23:14,240
passwords from a lot of places password

644
00:23:14,240 --> 00:23:16,640
reuse and stuff once we did an internal

645
00:23:16,640 --> 00:23:19,280
spray we gained access to around 15 more

646
00:23:19,280 --> 00:23:22,080
employees and all of us know which is a

647
00:23:22,080 --> 00:23:24,720
bad practice but everybody does is

648
00:23:24,720 --> 00:23:26,799
sending passwords and critical

649
00:23:26,799 --> 00:23:30,159
information in email right uh so at the

650
00:23:30,159 --> 00:23:32,880
moment we gain access to uh any email

651
00:23:32,880 --> 00:23:35,039
especially interesting email we just

652
00:23:35,039 --> 00:23:38,000
search password ssh vpn stuff like that

653
00:23:38,000 --> 00:23:39,440
and generally gives out a lot of stuff

654
00:23:39,440 --> 00:23:42,000
right so this is o 365 and

655
00:23:42,000 --> 00:23:44,320
all of that but at this point we still

656
00:23:44,320 --> 00:23:46,080
needed access to the scientific data

657
00:23:46,080 --> 00:23:49,120
management system the sdms eln eln is

658
00:23:49,120 --> 00:23:50,960
electronic lab notebooks this is what

659
00:23:50,960 --> 00:23:52,720
scientists are using to write their

660
00:23:52,720 --> 00:23:55,360
notes and scada devices and the medical

661
00:23:55,360 --> 00:23:58,080
sensors so here comes the second

662
00:23:58,080 --> 00:24:00,159
compromise flow now

663
00:24:00,159 --> 00:24:02,400
uh the electronic lab notebooks and the

664
00:24:02,400 --> 00:24:04,720
sdms we had no idea what these things

665
00:24:04,720 --> 00:24:07,200
are right we had no idea how they work

666
00:24:07,200 --> 00:24:09,360
we have no idea what's inside what are

667
00:24:09,360 --> 00:24:11,520
the privileges uh we didn't even know

668
00:24:11,520 --> 00:24:13,120
that the data would be encrypted inside

669
00:24:13,120 --> 00:24:16,640
right so basically what we did was uh we

670
00:24:16,640 --> 00:24:19,440
started reading the big chunks of

671
00:24:19,440 --> 00:24:21,440
manuals and this is where

672
00:24:21,440 --> 00:24:23,679
misconfiguration came in the problem

673
00:24:23,679 --> 00:24:26,559
with this organization was because these

674
00:24:26,559 --> 00:24:29,120
electronic sensors and uh

675
00:24:29,120 --> 00:24:31,840
all of the elect the sensors the note

676
00:24:31,840 --> 00:24:34,000
making machines uh all of this

677
00:24:34,000 --> 00:24:36,880
infrastructure was very very niche so

678
00:24:36,880 --> 00:24:39,039
the software required to access it was

679
00:24:39,039 --> 00:24:41,279
also niche produced by very a small

680
00:24:41,279 --> 00:24:44,080
subset of organization and once these

681
00:24:44,080 --> 00:24:46,159
people they had the vendors of these

682
00:24:46,159 --> 00:24:47,679
organization

683
00:24:47,679 --> 00:24:50,240
for every single update that they had to

684
00:24:50,240 --> 00:24:52,640
push in on the servers they need to they

685
00:24:52,640 --> 00:24:54,640
need to call ship a person from the

686
00:24:54,640 --> 00:24:56,880
vendor this is a machine they will come

687
00:24:56,880 --> 00:24:59,520
they will do a six month

688
00:24:59,520 --> 00:25:01,440
check whether it's failing or not there

689
00:25:01,440 --> 00:25:03,360
was a law it was a very very long

690
00:25:03,360 --> 00:25:05,919
process so this is where we found one

691
00:25:05,919 --> 00:25:08,320
business critic business logic issue

692
00:25:08,320 --> 00:25:10,000
basically how the company was doing

693
00:25:10,000 --> 00:25:12,559
business that had a flaw due to which

694
00:25:12,559 --> 00:25:14,159
they were not able to keep their systems

695
00:25:14,159 --> 00:25:16,400
updated that's why a lot of machines

696
00:25:16,400 --> 00:25:18,480
that were connected to the

697
00:25:18,480 --> 00:25:20,400
scientific data management systems they

698
00:25:20,400 --> 00:25:22,559
were they had a lot of legacy software

699
00:25:22,559 --> 00:25:24,159
in that right

700
00:25:24,159 --> 00:25:26,799
so old old os versions and all uh they

701
00:25:26,799 --> 00:25:29,840
were kept keeping it there and uh

702
00:25:29,840 --> 00:25:32,960
basically vendors uh they they as their

703
00:25:32,960 --> 00:25:35,360
vendors but they do not that the

704
00:25:35,360 --> 00:25:37,279
security rules don't apply to them a lot

705
00:25:37,279 --> 00:25:38,799
and they are using default passwords or

706
00:25:38,799 --> 00:25:40,640
weak passwords and stuff like that

707
00:25:40,640 --> 00:25:42,480
and from here on we started reading the

708
00:25:42,480 --> 00:25:46,240
manufacturing dot docs and uh

709
00:25:46,240 --> 00:25:48,400
the dock was pretty big didn't get a lot

710
00:25:48,400 --> 00:25:50,000
of information from it but yes there was

711
00:25:50,000 --> 00:25:51,919
a two hour long

712
00:25:51,919 --> 00:25:53,919
youtube video that explained how to

713
00:25:53,919 --> 00:25:56,640
operate these softwares and

714
00:25:56,640 --> 00:25:58,559
sadly i had to sit through the entire

715
00:25:58,559 --> 00:26:00,799
two two hours to find interesting

716
00:26:00,799 --> 00:26:03,200
information and once i did that i was

717
00:26:03,200 --> 00:26:04,480
able to

718
00:26:04,480 --> 00:26:06,880
once the demo person was showing the

719
00:26:06,880 --> 00:26:09,919
demo i was able to spot internal uh

720
00:26:09,919 --> 00:26:12,159
directories i was able to see the length

721
00:26:12,159 --> 00:26:14,240
of the default passwords uh the length

722
00:26:14,240 --> 00:26:15,600
of the passwords that the person was

723
00:26:15,600 --> 00:26:18,000
entering and some default passwords that

724
00:26:18,000 --> 00:26:20,080
the person was talking about so from

725
00:26:20,080 --> 00:26:22,240
these demos we then started digging in

726
00:26:22,240 --> 00:26:24,400
and trying to compromise these

727
00:26:24,400 --> 00:26:27,360
uh systems so uh we found some default

728
00:26:27,360 --> 00:26:28,799
passwords and some passwords we were

729
00:26:28,799 --> 00:26:30,240
able to brute force we found some

730
00:26:30,240 --> 00:26:31,919
internal directories which had we had

731
00:26:31,919 --> 00:26:33,600
some vulnerabilities which we were able

732
00:26:33,600 --> 00:26:35,840
to exploit and get some more information

733
00:26:35,840 --> 00:26:39,279
but yeah for the eln which is electronic

734
00:26:39,279 --> 00:26:41,919
lab notebooks the company is empower

735
00:26:41,919 --> 00:26:43,760
of course now it's all passed and stuff

736
00:26:43,760 --> 00:26:45,840
but this was their vendor which had the

737
00:26:45,840 --> 00:26:48,640
eln and we were able to gain access to

738
00:26:48,640 --> 00:26:50,880
the electronic lab notebooks so now as

739
00:26:50,880 --> 00:26:53,360
you can see uh on the left side each

740
00:26:53,360 --> 00:26:56,799
scientist has their own notebook and if

741
00:26:56,799 --> 00:26:58,880
i click on it there are actually notes

742
00:26:58,880 --> 00:27:00,480
that they are making every day about the

743
00:27:00,480 --> 00:27:02,080
experiments that they are creating so

744
00:27:02,080 --> 00:27:03,760
this was a big win for us right we

745
00:27:03,760 --> 00:27:05,279
gained access to this was one of the

746
00:27:05,279 --> 00:27:06,799
crown jewels

747
00:27:06,799 --> 00:27:10,000
but we still needed access to uh sdms

748
00:27:10,000 --> 00:27:11,440
and meanwhile

749
00:27:11,440 --> 00:27:12,880
once we were already on the dev

750
00:27:12,880 --> 00:27:15,440
workstation uh what we did was again set

751
00:27:15,440 --> 00:27:18,080
up the responder there uh look for ntm

752
00:27:18,080 --> 00:27:21,360
hashes in around two days we got a hit

753
00:27:21,360 --> 00:27:23,200
to one of the dev workstations which had

754
00:27:23,200 --> 00:27:24,480
oracle

755
00:27:24,480 --> 00:27:26,480
and there was enterprise manager running

756
00:27:26,480 --> 00:27:28,799
as the local instance and we simply did

757
00:27:28,799 --> 00:27:30,640
a man in the browser attack this is very

758
00:27:30,640 --> 00:27:31,679
interesting

759
00:27:31,679 --> 00:27:33,279
for people who might not know about man

760
00:27:33,279 --> 00:27:36,320
in the browser it simply injects

761
00:27:36,320 --> 00:27:39,520
your pivot inside the browser

762
00:27:39,520 --> 00:27:41,360
one of the ways is to do it is via a

763
00:27:41,360 --> 00:27:44,399
proxy and basically whenever the

764
00:27:44,399 --> 00:27:47,200
victim comes in enters their passwords

765
00:27:47,200 --> 00:27:49,120
they get in and because this was an

766
00:27:49,120 --> 00:27:51,039
oracle enterprise manager management

767
00:27:51,039 --> 00:27:53,679
server uh the browse the only browser

768
00:27:53,679 --> 00:27:55,520
that was there was internet explorer

769
00:27:55,520 --> 00:27:57,760
right so it was easy to

770
00:27:57,760 --> 00:28:00,320
bypass the ssl stuff over there so we

771
00:28:00,320 --> 00:28:02,159
injected our pivot this is again a

772
00:28:02,159 --> 00:28:04,000
feature of cobalt strike man in the

773
00:28:04,000 --> 00:28:05,120
browser

774
00:28:05,120 --> 00:28:07,600
if after two or three days a developer

775
00:28:07,600 --> 00:28:09,440
actually came in to his browser logged

776
00:28:09,440 --> 00:28:12,399
into the uh enterprise manager

777
00:28:12,399 --> 00:28:14,559
and uh we gained access to it now this

778
00:28:14,559 --> 00:28:17,200
oracle enterprise manager had a lot of

779
00:28:17,200 --> 00:28:20,399
juicy uh databases and credentials uh

780
00:28:20,399 --> 00:28:21,919
because this was a central stuff right

781
00:28:21,919 --> 00:28:24,240
this was uh connected to a lot of tech

782
00:28:24,240 --> 00:28:27,200
and uh from here on out even though as i

783
00:28:27,200 --> 00:28:30,880
told you i had access to the credentials

784
00:28:30,880 --> 00:28:32,559
it wouldn't help like i had access to

785
00:28:32,559 --> 00:28:34,159
the database it wouldn't help because

786
00:28:34,159 --> 00:28:36,640
all of the data is encrypted and unless

787
00:28:36,640 --> 00:28:38,720
the application the sdms actually

788
00:28:38,720 --> 00:28:40,799
fetches information from the

789
00:28:40,799 --> 00:28:43,520
database it won't be decrypted so

790
00:28:43,520 --> 00:28:44,960
from here on out

791
00:28:44,960 --> 00:28:46,960
basically oracle enterprise manager has

792
00:28:46,960 --> 00:28:49,760
scheduled jobs so i created a simple uh

793
00:28:49,760 --> 00:28:50,799
script

794
00:28:50,799 --> 00:28:52,080
oracle script

795
00:28:52,080 --> 00:28:52,960
to

796
00:28:52,960 --> 00:28:54,960
create a scheduled task that

797
00:28:54,960 --> 00:28:56,799
gives me a reverse shell this gave me

798
00:28:56,799 --> 00:28:58,159
access to the enterprise management

799
00:28:58,159 --> 00:29:00,399
server and from here on out i started

800
00:29:00,399 --> 00:29:02,399
reading log files uh there were some

801
00:29:02,399 --> 00:29:04,080
custom log files there were some

802
00:29:04,080 --> 00:29:06,399
standard log files and as you would

803
00:29:06,399 --> 00:29:08,880
guess uh there were

804
00:29:08,880 --> 00:29:12,080
files like password.txt and do not

805
00:29:12,080 --> 00:29:13,840
delete.txt which contained other

806
00:29:13,840 --> 00:29:15,840
sensitive information and stuff like

807
00:29:15,840 --> 00:29:18,240
that so there were some sometimes juicy

808
00:29:18,240 --> 00:29:20,240
information sitting right on the desktop

809
00:29:20,240 --> 00:29:22,640
because the developer is assuming nobody

810
00:29:22,640 --> 00:29:24,559
connects to these machines

811
00:29:24,559 --> 00:29:26,559
the password is not known this is a

812
00:29:26,559 --> 00:29:28,159
personal machine or it's managed by a

813
00:29:28,159 --> 00:29:30,480
very limited set of people and to ease

814
00:29:30,480 --> 00:29:32,240
out the access they keep these

815
00:29:32,240 --> 00:29:33,679
credentials it's just like putting a

816
00:29:33,679 --> 00:29:35,120
sticky note with a password on the

817
00:29:35,120 --> 00:29:37,120
monitor and we started reading these

818
00:29:37,120 --> 00:29:39,520
logs files and these text files and we

819
00:29:39,520 --> 00:29:40,960
gain access to the default

820
00:29:40,960 --> 00:29:43,600
configurations so one of the sdms we

821
00:29:43,600 --> 00:29:46,240
gained access to finally and i don't

822
00:29:46,240 --> 00:29:48,000
know if you can see this

823
00:29:48,000 --> 00:29:49,520
but uh

824
00:29:49,520 --> 00:29:52,000
honestly even i cannot but

825
00:29:52,000 --> 00:29:54,159
believe me yeah this did contain

826
00:29:54,159 --> 00:29:56,080
scientific data management system this

827
00:29:56,080 --> 00:29:58,240
did contain the formulas

828
00:29:58,240 --> 00:30:01,600
uh and all of your uh the pills that

829
00:30:01,600 --> 00:30:03,440
they were making all of the chemical

830
00:30:03,440 --> 00:30:04,960
formulas for that

831
00:30:04,960 --> 00:30:06,720
we finally gained access and because we

832
00:30:06,720 --> 00:30:09,440
had a password uh even if we had the

833
00:30:09,440 --> 00:30:10,880
database access and the data was

834
00:30:10,880 --> 00:30:12,960
encrypted because we had a password now

835
00:30:12,960 --> 00:30:14,880
for this application we were actually

836
00:30:14,880 --> 00:30:17,760
able to decrypt that data and uh here on

837
00:30:17,760 --> 00:30:20,320
out it was game over not really but yeah

838
00:30:20,320 --> 00:30:22,080
we did have read and write access to the

839
00:30:22,080 --> 00:30:24,880
lab notebooks we did we could control

840
00:30:24,880 --> 00:30:26,960
the form medicinal formulas so change

841
00:30:26,960 --> 00:30:29,440
your paracetamol to mdma and happy pills

842
00:30:29,440 --> 00:30:32,399
right so uh there was that we didn't do

843
00:30:32,399 --> 00:30:35,600
it but yeah it sounds nice so uh we

844
00:30:35,600 --> 00:30:38,000
could actually control the printing

845
00:30:38,000 --> 00:30:41,200
labeling and uh we needed access to the

846
00:30:41,200 --> 00:30:42,799
printing bottling and labeling machines

847
00:30:42,799 --> 00:30:44,480
that was the only thing left the scada

848
00:30:44,480 --> 00:30:46,960
devices right uh but we had access to

849
00:30:46,960 --> 00:30:49,440
all the proprietary formulas and imagine

850
00:30:49,440 --> 00:30:51,760
uh if you talk about business impact

851
00:30:51,760 --> 00:30:53,279
imagine changing the parasitic mold to

852
00:30:53,279 --> 00:30:55,600
mdma and short the stock

853
00:30:55,600 --> 00:30:58,320
or imagine logging into xp data protect

854
00:30:58,320 --> 00:31:00,399
short the stock delete all the backups

855
00:31:00,399 --> 00:31:01,919
stuff like that that was spinning around

856
00:31:01,919 --> 00:31:04,159
my head didn't do it tried to keep my

857
00:31:04,159 --> 00:31:05,039
calm

858
00:31:05,039 --> 00:31:06,320
but

859
00:31:06,320 --> 00:31:07,200
yeah

860
00:31:07,200 --> 00:31:09,200
the final step over here our final

861
00:31:09,200 --> 00:31:11,840
compromise flow was the ims this is

862
00:31:11,840 --> 00:31:13,519
inventory management system this is

863
00:31:13,519 --> 00:31:15,519
where your medicines are packed inside

864
00:31:15,519 --> 00:31:17,200
bottles labeled and stuff

865
00:31:17,200 --> 00:31:21,039
so uh for that uh interestingly so while

866
00:31:21,039 --> 00:31:22,399
we are doing these kind of red team

867
00:31:22,399 --> 00:31:24,640
exercises we found for example we found

868
00:31:24,640 --> 00:31:26,159
uh vulnerabilities in

869
00:31:26,159 --> 00:31:27,840
the lab notebook softwares we found

870
00:31:27,840 --> 00:31:30,480
vulnerabilities in the sdms software

871
00:31:30,480 --> 00:31:32,399
similarly we find these kind of zero

872
00:31:32,399 --> 00:31:34,880
days in a lot of softwares uh sometimes

873
00:31:34,880 --> 00:31:36,960
we have them reported a lot of times we

874
00:31:36,960 --> 00:31:38,640
cannot publicly report it but we have

875
00:31:38,640 --> 00:31:40,080
them patched but

876
00:31:40,080 --> 00:31:41,760
that gives us a benefit that we

877
00:31:41,760 --> 00:31:44,080
generally have a lot of uh we have a

878
00:31:44,080 --> 00:31:46,880
good chunk of zero days with us right uh

879
00:31:46,880 --> 00:31:48,399
during this without without of this

880
00:31:48,399 --> 00:31:50,799
process so uh

881
00:31:50,799 --> 00:31:52,720
in the inventory to access the inventory

882
00:31:52,720 --> 00:31:54,399
management system we basically

883
00:31:54,399 --> 00:31:56,720
compromised the entire forest the domain

884
00:31:56,720 --> 00:32:00,080
forest how they were using the uh

885
00:32:00,080 --> 00:32:02,720
inventory management system

886
00:32:02,720 --> 00:32:04,480
which which had a zero day and the zero

887
00:32:04,480 --> 00:32:06,640
day was an sqli rc which is again we

888
00:32:06,640 --> 00:32:08,240
found this during another exercise we

889
00:32:08,240 --> 00:32:09,919
were doing for another company they were

890
00:32:09,919 --> 00:32:13,279
using the same old version of the uh ims

891
00:32:13,279 --> 00:32:16,720
software and ims is basically ims is

892
00:32:16,720 --> 00:32:18,559
used to uh

893
00:32:18,559 --> 00:32:20,080
control the

894
00:32:20,080 --> 00:32:22,880
laptops and servers and desktops of the

895
00:32:22,880 --> 00:32:25,440
people manage the ad and stuff like that

896
00:32:25,440 --> 00:32:28,799
so once we use the rc uh sqli the sqli

897
00:32:28,799 --> 00:32:30,480
was basically an on uh unauthenticated

898
00:32:30,480 --> 00:32:33,039
sqli so we used an authenticated sqli on

899
00:32:33,039 --> 00:32:34,960
the inventory management system uh to

900
00:32:34,960 --> 00:32:36,880
get the password of the admin and then

901
00:32:36,880 --> 00:32:38,559
we basically gained access to the

902
00:32:38,559 --> 00:32:40,080
inventory management system which

903
00:32:40,080 --> 00:32:43,200
contained our entire ad configuration

904
00:32:43,200 --> 00:32:45,360
and from here on we could like literally

905
00:32:45,360 --> 00:32:47,519
schedule a job deploy a zip file deploy

906
00:32:47,519 --> 00:32:49,760
an exe file so you understand that

907
00:32:49,760 --> 00:32:50,960
inventory management systems are

908
00:32:50,960 --> 00:32:53,440
basically used to deploy software deploy

909
00:32:53,440 --> 00:32:56,799
patches so we deployed a simple uh

910
00:32:56,799 --> 00:32:59,519
vulnerable like uh obviously obfuscated

911
00:32:59,519 --> 00:33:00,640
and made

912
00:33:00,640 --> 00:33:02,320
av proof uh

913
00:33:02,320 --> 00:33:06,000
payload on the domain admin and uh once

914
00:33:06,000 --> 00:33:09,120
that executed we gained access to

915
00:33:09,120 --> 00:33:11,600
the dc and it was came over from there

916
00:33:11,600 --> 00:33:14,159
once we were in the dc uh i tried to

917
00:33:14,159 --> 00:33:16,080
find out where are the printing

918
00:33:16,080 --> 00:33:18,240
packaging bottling labeling systems and

919
00:33:18,240 --> 00:33:20,559
this was the exact scene in my head

920
00:33:20,559 --> 00:33:22,799
while i was controlling the scada and

921
00:33:22,799 --> 00:33:24,720
because i had access to it i could

922
00:33:24,720 --> 00:33:26,640
actually uh i gained access to this

923
00:33:26,640 --> 00:33:29,200
device which uh does cotton printing

924
00:33:29,200 --> 00:33:30,960
case packaging pharmaceutical bottling

925
00:33:30,960 --> 00:33:33,360
labeling and uh i don't even know what

926
00:33:33,360 --> 00:33:35,919
this is but yeah some conveyor system

927
00:33:35,919 --> 00:33:38,640
so yeah uh this is where

928
00:33:38,640 --> 00:33:40,399
we finally gained access to the database

929
00:33:40,399 --> 00:33:42,640
credentials of retrac retract was one of

930
00:33:42,640 --> 00:33:44,480
the scada devices which did the bottling

931
00:33:44,480 --> 00:33:46,720
and labeling and uh that was mission

932
00:33:46,720 --> 00:33:50,080
accomplished we took access to uh like

933
00:33:50,080 --> 00:33:52,080
all of the

934
00:33:52,080 --> 00:33:53,679
all of the crown jewels i would say we

935
00:33:53,679 --> 00:33:55,360
gained access to databases we gained

936
00:33:55,360 --> 00:33:57,279
access to sdms we gained access to scada

937
00:33:57,279 --> 00:34:00,000
devices we gained access to uh eln and

938
00:34:00,000 --> 00:34:02,960
we could really uh literally wreck havoc

939
00:34:02,960 --> 00:34:05,200
and uh go down a billion dollars but

940
00:34:05,200 --> 00:34:08,079
that's a different talk uh

941
00:34:08,079 --> 00:34:10,960
key takeaways so uh this is again i'll

942
00:34:10,960 --> 00:34:12,800
skim through it uh

943
00:34:12,800 --> 00:34:14,719
but yeah uh

944
00:34:14,719 --> 00:34:17,440
external recon when we do uh not only

945
00:34:17,440 --> 00:34:19,199
sub domain enumeration and all that is

946
00:34:19,199 --> 00:34:21,839
fine right everybody does that but what

947
00:34:21,839 --> 00:34:24,719
we see literally helps us a lot is

948
00:34:24,719 --> 00:34:27,440
constant monitoring right uh

949
00:34:27,440 --> 00:34:29,440
like we when once when we are red

950
00:34:29,440 --> 00:34:32,639
teaming we keep an eye out and make sure

951
00:34:32,639 --> 00:34:35,520
that we are always listening for new uh

952
00:34:35,520 --> 00:34:38,239
i.t on the network on the internet so we

953
00:34:38,239 --> 00:34:39,839
are listening we are scanning the js

954
00:34:39,839 --> 00:34:41,199
files we are scanning the api

955
00:34:41,199 --> 00:34:43,280
documentations we are scanning we are

956
00:34:43,280 --> 00:34:45,119
scanning the brute forcing the

957
00:34:45,119 --> 00:34:47,440
subdomains every day to find out if

958
00:34:47,440 --> 00:34:49,599
there are new assets once there are new

959
00:34:49,599 --> 00:34:51,359
assets that means

960
00:34:51,359 --> 00:34:53,599
they are not audited properly at least

961
00:34:53,599 --> 00:34:55,520
not externally or

962
00:34:55,520 --> 00:34:58,240
they it has there are higher chances

963
00:34:58,240 --> 00:34:59,839
that these new assets would be would be

964
00:34:59,839 --> 00:35:03,280
vulnerable right so uh that's there

965
00:35:03,280 --> 00:35:05,599
reverse who is again helps a lot full

966
00:35:05,599 --> 00:35:08,480
port scans uh showdown helps census and

967
00:35:08,480 --> 00:35:11,680
all that uh js analysis as i mentioned

968
00:35:11,680 --> 00:35:14,240
uh we have an internal engine that does

969
00:35:14,240 --> 00:35:16,880
js analysis find internal assets and

970
00:35:16,880 --> 00:35:18,480
keeps uh

971
00:35:18,480 --> 00:35:21,359
keeps a change log of sorts and tells us

972
00:35:21,359 --> 00:35:23,359
if there are new apis introduced

973
00:35:23,359 --> 00:35:25,760
via js and other front-end frameworks so

974
00:35:25,760 --> 00:35:28,000
that is really helpful when discovering

975
00:35:28,000 --> 00:35:30,240
vulnerabilities uh parameter and header

976
00:35:30,240 --> 00:35:32,160
brute forcing of course you are aware of

977
00:35:32,160 --> 00:35:35,359
it it is really helpful and uh cache

978
00:35:35,359 --> 00:35:38,000
urls from web archive uh i am sure all

979
00:35:38,000 --> 00:35:41,040
of you are already uh doing this and

980
00:35:41,040 --> 00:35:43,119
then employee os is something which

981
00:35:43,119 --> 00:35:46,480
really helps uh leaked credentials uh

982
00:35:46,480 --> 00:35:49,119
and ostent from for employees actually

983
00:35:49,119 --> 00:35:51,920
works right it's not that it's not uh

984
00:35:51,920 --> 00:35:55,200
there is not only shiverboard or uh what

985
00:35:55,200 --> 00:35:56,960
what what are what is your

986
00:35:56,960 --> 00:35:59,040
leaks the standard leaks it's not just

987
00:35:59,040 --> 00:36:01,920
that if you have a good database of

988
00:36:01,920 --> 00:36:04,640
leaks passwords you would really be able

989
00:36:04,640 --> 00:36:06,560
to gain access to a lot of employee

990
00:36:06,560 --> 00:36:09,200
stuff given the recon on that employee

991
00:36:09,200 --> 00:36:13,839
is nice okay uh just a sec

992
00:36:17,280 --> 00:36:19,839
yeah moving on internal recon of course

993
00:36:19,839 --> 00:36:21,680
everybody does full port scans automated

994
00:36:21,680 --> 00:36:24,320
scanning was nessus and stuff but yeah

995
00:36:24,320 --> 00:36:26,880
uh inside vm uh we found pretty helpful

996
00:36:26,880 --> 00:36:29,599
in this case uh once we when we were not

997
00:36:29,599 --> 00:36:31,760
on our workstations uh

998
00:36:31,760 --> 00:36:33,599
went for lunch we generally ran inside

999
00:36:33,599 --> 00:36:36,720
vm uh this was a this gave us better

1000
00:36:36,720 --> 00:36:38,560
results than necess interestingly we

1001
00:36:38,560 --> 00:36:40,800
don't generally use so i'm not super

1002
00:36:40,800 --> 00:36:42,880
versed with uh these automated 1b

1003
00:36:42,880 --> 00:36:44,560
assessment tools because we

1004
00:36:44,560 --> 00:36:45,920
avoid using them because they're very

1005
00:36:45,920 --> 00:36:49,680
noisy uh but yeah inside vm once we did

1006
00:36:49,680 --> 00:36:51,920
this entire activity uh we did run

1007
00:36:51,920 --> 00:36:54,480
proper internal scan to ensure there are

1008
00:36:54,480 --> 00:36:56,240
not any other

1009
00:36:56,240 --> 00:36:58,960
things like hp data protect and stuff

1010
00:36:58,960 --> 00:37:01,520
inside vm pretty helpful

1011
00:37:01,520 --> 00:37:04,000
uh vlan testing sniffing responder stuff

1012
00:37:04,000 --> 00:37:06,800
ada enumeration uh internal phishing and

1013
00:37:06,800 --> 00:37:09,680
as i mentioned uh once you gain access

1014
00:37:09,680 --> 00:37:12,400
to an internal page try modifying try

1015
00:37:12,400 --> 00:37:14,240
modifying it right change the password

1016
00:37:14,240 --> 00:37:16,560
uh change the login file add a backdoor

1017
00:37:16,560 --> 00:37:19,119
in that so that you receive passwords

1018
00:37:19,119 --> 00:37:21,440
in all as many portals as you can so

1019
00:37:21,440 --> 00:37:23,520
yeah internal recon read the api

1020
00:37:23,520 --> 00:37:27,040
documentation as much as possible and

1021
00:37:27,040 --> 00:37:29,599
coming to footholds and exploitation uh

1022
00:37:29,599 --> 00:37:32,000
there are a lot of uh

1023
00:37:32,000 --> 00:37:35,119
nice c2s that you can utilize uh cobalt

1024
00:37:35,119 --> 00:37:38,320
strike everybody is aware of but uh

1025
00:37:38,320 --> 00:37:40,800
try try looking at kuwaiti try looking

1026
00:37:40,800 --> 00:37:42,720
at empire try looking at powershell

1027
00:37:42,720 --> 00:37:45,760
empire armitage teams is very nice

1028
00:37:45,760 --> 00:37:48,560
covenant is also very very good c2 these

1029
00:37:48,560 --> 00:37:50,400
are some c2s which are sparsely used we

1030
00:37:50,400 --> 00:37:52,240
don't see them being used a lot cobalt

1031
00:37:52,240 --> 00:37:55,599
strike is used a lot uh because of uh

1032
00:37:55,599 --> 00:37:58,400
good documentation and you can actually

1033
00:37:58,400 --> 00:38:00,720
write your custom beacons uh so that

1034
00:38:00,720 --> 00:38:02,240
functionality is really phenomenal with

1035
00:38:02,240 --> 00:38:05,040
google strike but yeah a lot of times uh

1036
00:38:05,040 --> 00:38:07,040
these signatures might get detected and

1037
00:38:07,040 --> 00:38:09,440
some other c2s like kuwaitic and

1038
00:38:09,440 --> 00:38:11,839
covenant these will uh help out in

1039
00:38:11,839 --> 00:38:14,240
scenarios where you want to run a c2 on

1040
00:38:14,240 --> 00:38:15,920
a linux environment or a mac environment

1041
00:38:15,920 --> 00:38:18,400
maybe right so in those cases try out

1042
00:38:18,400 --> 00:38:21,040
other c2s and c3s

1043
00:38:21,040 --> 00:38:21,920
then

1044
00:38:21,920 --> 00:38:24,000
third-party vendors and portals is a big

1045
00:38:24,000 --> 00:38:27,359
target for us uh we target them a lot uh

1046
00:38:27,359 --> 00:38:30,160
again comparing git diffs uh whenever

1047
00:38:30,160 --> 00:38:32,079
there is an internal patch a lot of like

1048
00:38:32,079 --> 00:38:34,480
companies especially oracle and stuff uh

1049
00:38:34,480 --> 00:38:36,640
drupal for example they release internal

1050
00:38:36,640 --> 00:38:38,960
patches there is no documentation on the

1051
00:38:38,960 --> 00:38:41,440
exploitation so you can easily obviously

1052
00:38:41,440 --> 00:38:43,839
anybody can go uh check out the diff

1053
00:38:43,839 --> 00:38:45,839
find out what part of code they changed

1054
00:38:45,839 --> 00:38:47,839
and try to figure out why why did this

1055
00:38:47,839 --> 00:38:49,839
patch if this was the patch what would

1056
00:38:49,839 --> 00:38:51,359
be the vulnerability if this is the

1057
00:38:51,359 --> 00:38:53,440
vulnerability how would we enter it so

1058
00:38:53,440 --> 00:38:54,960
this was we did this for one of the

1059
00:38:54,960 --> 00:38:57,280
deserialization issues in drupal a

1060
00:38:57,280 --> 00:38:59,520
couple of years back but yeah comparing

1061
00:38:59,520 --> 00:39:02,160
git divs for public applications really

1062
00:39:02,160 --> 00:39:05,040
helps uh reverse engineering mobile and

1063
00:39:05,040 --> 00:39:07,119
desktop applications once you find them

1064
00:39:07,119 --> 00:39:09,920
internal applications can lead you it

1065
00:39:09,920 --> 00:39:11,200
does help us

1066
00:39:11,200 --> 00:39:13,839
it leads us to internal assets

1067
00:39:13,839 --> 00:39:16,320
developer consoles which functionality

1068
00:39:16,320 --> 00:39:18,079
which is disabled in the client

1069
00:39:18,079 --> 00:39:19,920
application but if you reverse engineer

1070
00:39:19,920 --> 00:39:22,000
these applications uh you will be able

1071
00:39:22,000 --> 00:39:23,760
to find out a lot of stuff inside them

1072
00:39:23,760 --> 00:39:24,800
so

1073
00:39:24,800 --> 00:39:26,240
yeah

1074
00:39:26,240 --> 00:39:27,920
of course you have to customize the

1075
00:39:27,920 --> 00:39:29,200
payloads because

1076
00:39:29,200 --> 00:39:30,320
av is

1077
00:39:30,320 --> 00:39:32,960
paid in the ass a lot of times but yeah

1078
00:39:32,960 --> 00:39:35,200
uh av evasions there are a lot of

1079
00:39:35,200 --> 00:39:37,920
techniques you can find uh but yeah the

1080
00:39:37,920 --> 00:39:41,280
main idea is to make custom stuff to

1081
00:39:41,280 --> 00:39:44,320
make custom beacons uh which

1082
00:39:44,320 --> 00:39:45,920
do stuff in memory

1083
00:39:45,920 --> 00:39:46,960
find

1084
00:39:46,960 --> 00:39:49,280
ways to execute payloads from trusted

1085
00:39:49,280 --> 00:39:50,560
sources

1086
00:39:50,560 --> 00:39:53,760
so you a token impersonation there you

1087
00:39:53,760 --> 00:39:55,440
can execute payloads by group policy

1088
00:39:55,440 --> 00:39:58,000
modifications uh

1089
00:39:58,000 --> 00:40:00,400
we we had cases where we were able to

1090
00:40:00,400 --> 00:40:02,560
pivot to mcafee

1091
00:40:02,560 --> 00:40:04,960
the agent itself once we compromised and

1092
00:40:04,960 --> 00:40:06,480
because it had a lot of access and it

1093
00:40:06,480 --> 00:40:07,680
was a trusted

1094
00:40:07,680 --> 00:40:09,280
binary

1095
00:40:09,280 --> 00:40:12,000
it was working so yeah uh obfuscated

1096
00:40:12,000 --> 00:40:14,160
payloads and stuff in memory injection

1097
00:40:14,160 --> 00:40:15,200
file

1098
00:40:15,200 --> 00:40:17,359
interesting very old technique that

1099
00:40:17,359 --> 00:40:20,800
still works at a lot of places is uh

1100
00:40:20,800 --> 00:40:23,040
like you might a lot of a lot of times

1101
00:40:23,040 --> 00:40:24,800
signed binaries are not allowed unsigned

1102
00:40:24,800 --> 00:40:27,119
binaries are not allowed to execute but

1103
00:40:27,119 --> 00:40:29,680
iexpress which is theirs i don't know

1104
00:40:29,680 --> 00:40:32,319
internet explorer is a packaging tool is

1105
00:40:32,319 --> 00:40:33,200
a

1106
00:40:33,200 --> 00:40:35,839
is a msi creation tool which you can use

1107
00:40:35,839 --> 00:40:37,920
to create setup and in the setup at the

1108
00:40:37,920 --> 00:40:39,359
end this is a functionality provided by

1109
00:40:39,359 --> 00:40:41,599
windows itself there is an option to

1110
00:40:41,599 --> 00:40:43,040
actually

1111
00:40:43,040 --> 00:40:45,200
add a completion command and that

1112
00:40:45,200 --> 00:40:47,119
becomes a signed microsoft binary so

1113
00:40:47,119 --> 00:40:48,160
this

1114
00:40:48,160 --> 00:40:50,160
used to help us a lot

1115
00:40:50,160 --> 00:40:51,760
at least uh

1116
00:40:51,760 --> 00:40:54,240
at least till uh last year this was

1117
00:40:54,240 --> 00:40:56,640
working malleable c2 cobalt strike if

1118
00:40:56,640 --> 00:40:58,640
you aren't using that please go ahead

1119
00:40:58,640 --> 00:41:00,560
research about it it's it's it's

1120
00:41:00,560 --> 00:41:04,880
phenomenal uh really i back that

1121
00:41:04,880 --> 00:41:06,400
if only they bring the price down but

1122
00:41:06,400 --> 00:41:07,920
yeah to make it accessible to normal

1123
00:41:07,920 --> 00:41:09,920
people but yeah

1124
00:41:09,920 --> 00:41:12,640
uh post exploitations obviously we are

1125
00:41:12,640 --> 00:41:14,800
aware of the common ad exploitation and

1126
00:41:14,800 --> 00:41:17,520
ad enumeration tools uh stuff like power

1127
00:41:17,520 --> 00:41:18,800
up nishang

1128
00:41:18,800 --> 00:41:21,440
responder mimikatz mimikittens and mimi

1129
00:41:21,440 --> 00:41:22,480
penguin

1130
00:41:22,480 --> 00:41:24,240
these are the

1131
00:41:24,240 --> 00:41:26,640
mac and linux alternatives

1132
00:41:26,640 --> 00:41:29,200
browser harvesting man in the browser

1133
00:41:29,200 --> 00:41:31,040
and you know as i mentioned read the

1134
00:41:31,040 --> 00:41:33,680
source code read the log files uh try to

1135
00:41:33,680 --> 00:41:36,079
find something interesting there uh

1136
00:41:36,079 --> 00:41:38,079
browser pivoting again in cobalt strike

1137
00:41:38,079 --> 00:41:41,760
a very good feature uh that helps and

1138
00:41:41,760 --> 00:41:43,920
a very uh very very helpful tool that

1139
00:41:43,920 --> 00:41:46,160
helps us in getting reverse shells in

1140
00:41:46,160 --> 00:41:48,640
office in very very marginal

1141
00:41:48,640 --> 00:41:50,000
environments environments which are

1142
00:41:50,000 --> 00:41:52,560
protected is something called abpts i'm

1143
00:41:52,560 --> 00:41:53,920
sure a lot of you would have heard about

1144
00:41:53,920 --> 00:41:56,240
this this it's a black path towards the

1145
00:41:56,240 --> 00:41:57,760
sun weird name but

1146
00:41:57,760 --> 00:42:00,240
this basically helps you to create a

1147
00:42:00,240 --> 00:42:03,119
reverse http tunnel uh you would be

1148
00:42:03,119 --> 00:42:05,599
aware of reverse ssh tunnel but this but

1149
00:42:05,599 --> 00:42:07,680
this basically gives you a reverse http

1150
00:42:07,680 --> 00:42:10,720
tunnel uh a very very helpful tool uh

1151
00:42:10,720 --> 00:42:12,880
one if if there is a

1152
00:42:12,880 --> 00:42:14,640
there is a web application and you want

1153
00:42:14,640 --> 00:42:16,160
a reverse shell but all outgoing

1154
00:42:16,160 --> 00:42:17,920
connection is uh

1155
00:42:17,920 --> 00:42:21,119
like not allowed you can create an http

1156
00:42:21,119 --> 00:42:23,520
uh tunnel uh host it on a particular

1157
00:42:23,520 --> 00:42:25,440
endpoint on that application if you have

1158
00:42:25,440 --> 00:42:27,839
access to that and then using your

1159
00:42:27,839 --> 00:42:29,440
cobalt strike or whatever c2 you are

1160
00:42:29,440 --> 00:42:32,079
using you can connect to that with abpts

1161
00:42:32,079 --> 00:42:35,040
and it will all be https tunneled and

1162
00:42:35,040 --> 00:42:37,440
what we like to do is once we make the

1163
00:42:37,440 --> 00:42:40,720
c2 we generally download the http dssl

1164
00:42:40,720 --> 00:42:43,200
signature and sign all our requests with

1165
00:42:43,200 --> 00:42:45,680
that encrypted with their own signature

1166
00:42:45,680 --> 00:42:48,079
to their own certificates which uh helps

1167
00:42:48,079 --> 00:42:50,720
a lot in uh going through the different

1168
00:42:50,720 --> 00:42:53,359
kind of dlps that are there right

1169
00:42:53,359 --> 00:42:56,319
uh meterpreter we've stopped using uh

1170
00:42:56,319 --> 00:42:58,160
since we started the cobalt strike and

1171
00:42:58,160 --> 00:43:00,800
stuff but yeah sometimes it's helpful uh

1172
00:43:00,800 --> 00:43:02,560
multi-level pivot in meterpreter is

1173
00:43:02,560 --> 00:43:04,640
pretty helpful and

1174
00:43:04,640 --> 00:43:07,440
now coming to staying under the radar uh

1175
00:43:07,440 --> 00:43:10,160
onedrive and dropbox exfiltration is

1176
00:43:10,160 --> 00:43:12,400
really really impressive especially from

1177
00:43:12,400 --> 00:43:14,240
normal employee machines

1178
00:43:14,240 --> 00:43:16,480
so generally when we try to exfiltrate

1179
00:43:16,480 --> 00:43:18,640
we don't generally take some out of the

1180
00:43:18,640 --> 00:43:20,640
box tool to do it we try to first

1181
00:43:20,640 --> 00:43:23,599
identify uh what kind of systems uh what

1182
00:43:23,599 --> 00:43:25,280
kind of

1183
00:43:25,280 --> 00:43:28,000
party services is that employee using

1184
00:43:28,000 --> 00:43:30,560
and then we try to hide our traffic with

1185
00:43:30,560 --> 00:43:33,200
that so uh we generally try to

1186
00:43:33,200 --> 00:43:36,240
exfiltrate data with onedrive

1187
00:43:36,240 --> 00:43:38,720
uh without 365 or dropbox if they're

1188
00:43:38,720 --> 00:43:40,560
using that or google drive there are

1189
00:43:40,560 --> 00:43:42,480
tools uh that you can use that will

1190
00:43:42,480 --> 00:43:45,520
automatically exfiltrate your data uh

1191
00:43:45,520 --> 00:43:47,599
and of course if you done your if you've

1192
00:43:47,599 --> 00:43:48,960
done your browser pivoting well if

1193
00:43:48,960 --> 00:43:50,400
you've done your man in the browser

1194
00:43:50,400 --> 00:43:52,400
properly you can actually do that from

1195
00:43:52,400 --> 00:43:54,480
the employees credentials and you don't

1196
00:43:54,480 --> 00:43:56,640
have to host it to your

1197
00:43:56,640 --> 00:43:58,240
drive you can host it to their drive and

1198
00:43:58,240 --> 00:44:00,960
delete it stuff like that so

1199
00:44:00,960 --> 00:44:03,200
then ssl impersonation as i mentioned

1200
00:44:03,200 --> 00:44:04,800
all of the payloads all of the traffic

1201
00:44:04,800 --> 00:44:06,880
the moment we find an internal uh

1202
00:44:06,880 --> 00:44:09,280
private key we sign everything with that

1203
00:44:09,280 --> 00:44:11,520
we sign our binaries uh

1204
00:44:11,520 --> 00:44:14,480
we sign our ssl traffic whatever we're

1205
00:44:14,480 --> 00:44:16,480
doing communication that is happening we

1206
00:44:16,480 --> 00:44:18,160
do it with the company's

1207
00:44:18,160 --> 00:44:20,960
signatures there with their keys so that

1208
00:44:20,960 --> 00:44:23,680
helps in do uh hiding a lot of traffic

1209
00:44:23,680 --> 00:44:24,560
then

1210
00:44:24,560 --> 00:44:26,319
in memory execution of course wherever

1211
00:44:26,319 --> 00:44:28,640
possible this helps a lot and finding

1212
00:44:28,640 --> 00:44:33,040
ways uh to execute uh your payloads from

1213
00:44:33,040 --> 00:44:35,520
trusted stuff like run dll and

1214
00:44:35,520 --> 00:44:38,400
regex sorry registry and group policy

1215
00:44:38,400 --> 00:44:41,839
executions and stuff like that uh we

1216
00:44:41,839 --> 00:44:44,640
we have seen it uh very effective and

1217
00:44:44,640 --> 00:44:47,359
impersonation is very important which uh

1218
00:44:47,359 --> 00:44:49,440
i personally with a lot of experience

1219
00:44:49,440 --> 00:44:51,200
that i have with creating fishing

1220
00:44:51,200 --> 00:44:53,839
campaigns for a big part of the middle

1221
00:44:53,839 --> 00:44:56,640
east and the uk and the southeast uh

1222
00:44:56,640 --> 00:44:59,599
southeast asian continent uh

1223
00:44:59,599 --> 00:45:01,280
impersonation is something i take pride

1224
00:45:01,280 --> 00:45:02,960
upon and

1225
00:45:02,960 --> 00:45:06,560
because you know uh good at stalking so

1226
00:45:06,560 --> 00:45:08,240
i stalk internal employees and then

1227
00:45:08,240 --> 00:45:10,160
impersonate them uh

1228
00:45:10,160 --> 00:45:12,160
you you might have heard about that case

1229
00:45:12,160 --> 00:45:15,680
where uh the slack was sold on deep web

1230
00:45:15,680 --> 00:45:17,440
uh developers slack account and this

1231
00:45:17,440 --> 00:45:20,560
person was able to get a lot of internal

1232
00:45:20,560 --> 00:45:22,560
data default passwords

1233
00:45:22,560 --> 00:45:24,800
current passwords installations on all

1234
00:45:24,800 --> 00:45:26,720
of that by sending sms from that

1235
00:45:26,720 --> 00:45:30,240
employee slack slack cookie right so

1236
00:45:30,240 --> 00:45:33,280
domains uh accounts certificates

1237
00:45:33,280 --> 00:45:35,520
applications impersonate everything

1238
00:45:35,520 --> 00:45:38,960
right uh finally exfiltration uh

1239
00:45:38,960 --> 00:45:41,359
clockify factory uh is a very good

1240
00:45:41,359 --> 00:45:44,000
text-to-text uh exfiltration tool which

1241
00:45:44,000 --> 00:45:47,119
we uh use a lot text to text you you

1242
00:45:47,119 --> 00:45:48,640
would have heard about

1243
00:45:48,640 --> 00:45:50,240
exfiltrating

1244
00:45:50,240 --> 00:45:52,720
uh in music files or image files and

1245
00:45:52,720 --> 00:45:55,280
stuff like that cloakify does a text to

1246
00:45:55,280 --> 00:45:57,040
text so it will

1247
00:45:57,040 --> 00:45:58,720
let's say you have an etc password file

1248
00:45:58,720 --> 00:46:01,440
to export it will create a long story

1249
00:46:01,440 --> 00:46:03,119
about some random village with some

1250
00:46:03,119 --> 00:46:05,599
random farmer and the htc password file

1251
00:46:05,599 --> 00:46:07,920
will be there inside if you read it it's

1252
00:46:07,920 --> 00:46:11,520
a story so that's clockify factory uh

1253
00:46:11,520 --> 00:46:13,520
bind sales over http proxies this is

1254
00:46:13,520 --> 00:46:16,800
abpts dns exfiltration uh

1255
00:46:16,800 --> 00:46:19,760
i icmp exfiltration and

1256
00:46:19,760 --> 00:46:20,800
empire

1257
00:46:20,800 --> 00:46:23,280
by the way has the dropbox exfiltration

1258
00:46:23,280 --> 00:46:26,319
by default empire the c2 so that there's

1259
00:46:26,319 --> 00:46:28,400
that so that

1260
00:46:28,400 --> 00:46:30,079
sums it up

1261
00:46:30,079 --> 00:46:33,440
and yeah i think that's it i can take

1262
00:46:33,440 --> 00:46:36,160
some questions now but yeah for more

1263
00:46:36,160 --> 00:46:38,800
questions you can reach out to me on

1264
00:46:38,800 --> 00:46:41,440
twitter or facebook or linkedin or

1265
00:46:41,440 --> 00:46:43,680
whatever you feel like

1266
00:46:43,680 --> 00:46:46,560
but yeah there's that i can now take

1267
00:46:46,560 --> 00:46:47,839
questions but

1268
00:46:47,839 --> 00:46:50,260
that's the end of slides thank you

1269
00:46:50,260 --> 00:46:58,770
[Applause]

1270
00:46:58,770 --> 00:47:01,940
[Music]

1271
00:47:03,839 --> 00:47:06,839
foreign

1272
00:47:15,040 --> 00:47:18,240
hello thank you for your talk first

1273
00:47:18,240 --> 00:47:20,400
my question is about your stock evasion

1274
00:47:20,400 --> 00:47:21,119
you

1275
00:47:21,119 --> 00:47:23,280
talked that

1276
00:47:23,280 --> 00:47:27,520
sock team but you didn't uh

1277
00:47:27,520 --> 00:47:29,920
present how you escaped them and if they

1278
00:47:29,920 --> 00:47:31,680
found you at some time and how you came

1279
00:47:31,680 --> 00:47:34,160
back if you if they were farm

1280
00:47:34,160 --> 00:47:36,319
okay so uh if i understood understand

1281
00:47:36,319 --> 00:47:38,000
your question correctly uh you're

1282
00:47:38,000 --> 00:47:39,520
talking about the sock team whether they

1283
00:47:39,520 --> 00:47:41,520
found us how did they find us how are we

1284
00:47:41,520 --> 00:47:43,680
able to evade so

1285
00:47:43,680 --> 00:47:45,520
uh we were

1286
00:47:45,520 --> 00:47:47,119
caught

1287
00:47:47,119 --> 00:47:48,559
it was not the sock team it was the

1288
00:47:48,559 --> 00:47:50,559
physical security team i was roaming

1289
00:47:50,559 --> 00:47:53,920
around the campus with my laptop and an

1290
00:47:53,920 --> 00:47:55,839
alpha card stuck to it and walking like

1291
00:47:55,839 --> 00:47:58,079
this and he caught me what are you doing

1292
00:47:58,079 --> 00:48:00,000
and i said i'm the i.t engineer i'm

1293
00:48:00,000 --> 00:48:01,520
checking the strength of the wi-fi so

1294
00:48:01,520 --> 00:48:03,040
he's like okay

1295
00:48:03,040 --> 00:48:06,480
but yeah sock team uh they were able to

1296
00:48:06,480 --> 00:48:08,640
identify some uh

1297
00:48:08,640 --> 00:48:11,520
a lot of traffic because one of our uh

1298
00:48:11,520 --> 00:48:14,640
one of our scripts uh went a bit

1299
00:48:14,640 --> 00:48:17,280
it had a bug or sort uh it poisoned a

1300
00:48:17,280 --> 00:48:20,240
lot of stuff and did a lot of

1301
00:48:20,240 --> 00:48:23,040
noise and we were caught there uh but

1302
00:48:23,040 --> 00:48:25,520
yeah we we recovered uh because we had

1303
00:48:25,520 --> 00:48:27,440
access to a lot of systems what we did

1304
00:48:27,440 --> 00:48:29,920
was create a lot of uh white noise we

1305
00:48:29,920 --> 00:48:31,280
started creating noise from all the

1306
00:48:31,280 --> 00:48:34,640
machines and uh that you know uh masked

1307
00:48:34,640 --> 00:48:37,359
r noise so that's how that's few of the

1308
00:48:37,359 --> 00:48:40,240
cases but because they i i wouldn't take

1309
00:48:40,240 --> 00:48:42,079
pride upon the evasion of stock team in

1310
00:48:42,079 --> 00:48:43,920
this exercise because i would say they

1311
00:48:43,920 --> 00:48:47,040
weren't that good uh they weren't super

1312
00:48:47,040 --> 00:48:50,000
extreme uh they are not your uh

1313
00:48:50,000 --> 00:48:51,599
state-of-the-art blue teams they were

1314
00:48:51,599 --> 00:48:54,000
not that uh but yeah they were doing

1315
00:48:54,000 --> 00:48:56,160
something and this is again legacy stuff

1316
00:48:56,160 --> 00:48:58,720
right imagine uh putting a dlp on a

1317
00:48:58,720 --> 00:49:00,640
scientific data management system it's a

1318
00:49:00,640 --> 00:49:03,839
nightmare for the cso the implementation

1319
00:49:03,839 --> 00:49:06,079
itself is extremely difficult so yeah

1320
00:49:06,079 --> 00:49:07,920
that's why it's not that these people

1321
00:49:07,920 --> 00:49:09,200
were not skilled or didn't have the

1322
00:49:09,200 --> 00:49:11,440
budget to deploy the state-of-the-art

1323
00:49:11,440 --> 00:49:13,680
technology it's just that their

1324
00:49:13,680 --> 00:49:15,520
dependency was so

1325
00:49:15,520 --> 00:49:17,920
back dated they couldn't deploy a lot of

1326
00:49:17,920 --> 00:49:20,160
modern solutions

1327
00:49:20,160 --> 00:49:21,680
yeah

1328
00:49:21,680 --> 00:49:24,319
next question

1329
00:49:24,400 --> 00:49:29,000
can we hand a mic to this gentleman

1330
00:49:35,920 --> 00:49:38,160
thank you for the presentation

1331
00:49:38,160 --> 00:49:40,559
mine was pretty same the

1332
00:49:40,559 --> 00:49:42,880
the question of the sock team

1333
00:49:42,880 --> 00:49:46,160
and what about that their dev uh

1334
00:49:46,160 --> 00:49:48,640
environment did the sock

1335
00:49:48,640 --> 00:49:51,440
was monitoring this part of uh

1336
00:49:51,440 --> 00:49:52,720
monitoring world

1337
00:49:52,720 --> 00:49:55,839
so the dev the dev the development

1338
00:49:55,839 --> 00:49:56,880
network

1339
00:49:56,880 --> 00:49:58,720
that you were talking about

1340
00:49:58,720 --> 00:50:00,720
it was being monitored but then again

1341
00:50:00,720 --> 00:50:03,040
dev do a lot of stuff right uh we had

1342
00:50:03,040 --> 00:50:05,599
this case interesting case where we were

1343
00:50:05,599 --> 00:50:07,359
assisting a blue team so i'll give you

1344
00:50:07,359 --> 00:50:08,800
an example we were assisting a blue team

1345
00:50:08,800 --> 00:50:10,960
giving them some tips

1346
00:50:10,960 --> 00:50:13,599
there was a case where this hr was using

1347
00:50:13,599 --> 00:50:14,800
powershell

1348
00:50:14,800 --> 00:50:16,160
we flagged it right of course why would

1349
00:50:16,160 --> 00:50:18,480
an hr use powershell like not not

1350
00:50:18,480 --> 00:50:21,599
belittling any hr's uh you can go to uh

1351
00:50:21,599 --> 00:50:24,400
powershell but no uh

1352
00:50:24,400 --> 00:50:26,160
i would not expect an hr to run

1353
00:50:26,160 --> 00:50:29,040
powershell uh but devs you expect a lot

1354
00:50:29,040 --> 00:50:30,559
of them a lot of things from them and

1355
00:50:30,559 --> 00:50:33,280
that's where the lack of expected

1356
00:50:33,280 --> 00:50:34,400
behavior

1357
00:50:34,400 --> 00:50:36,880
is a problem right that's why i preach

1358
00:50:36,880 --> 00:50:39,040
upon anomaly detection systems instead

1359
00:50:39,040 --> 00:50:41,119
of behavioral analysis look for

1360
00:50:41,119 --> 00:50:43,200
anomalies as the blue team you should

1361
00:50:43,200 --> 00:50:45,760
know i would say detecting anomalies is

1362
00:50:45,760 --> 00:50:47,920
what helps in our case the devs were

1363
00:50:47,920 --> 00:50:49,680
being monitored but because we were

1364
00:50:49,680 --> 00:50:51,920
masking our traffic because we were

1365
00:50:51,920 --> 00:50:54,240
impersonating devs themselves we were

1366
00:50:54,240 --> 00:50:56,240
not using any kind of

1367
00:50:56,240 --> 00:50:58,720
you know uh some some meter pattern

1368
00:50:58,720 --> 00:51:01,359
noisy uh hail mary attack or on

1369
00:51:01,359 --> 00:51:03,359
hermitage and stuff like that so we were

1370
00:51:03,359 --> 00:51:05,760
masking things because we were aware of

1371
00:51:05,760 --> 00:51:07,680
the blue team practices

1372
00:51:07,680 --> 00:51:08,960
we

1373
00:51:08,960 --> 00:51:10,960
note them down we tried to

1374
00:51:10,960 --> 00:51:12,160
skim through

1375
00:51:12,160 --> 00:51:14,720
between the ridges so that's

1376
00:51:14,720 --> 00:51:17,040
i would say 90 of it

1377
00:51:17,040 --> 00:51:19,760
went through they didn't even notice

1378
00:51:19,760 --> 00:51:21,680
okay thank you

1379
00:51:21,680 --> 00:51:25,279
okay do we have any other questions

1380
00:51:28,880 --> 00:51:30,079
all right

1381
00:51:30,079 --> 00:51:32,079
uh for anything else i'll be outside

1382
00:51:32,079 --> 00:51:34,640
most probably today

1383
00:51:34,640 --> 00:51:36,319
if you want to grab a beer i'm always

1384
00:51:36,319 --> 00:51:37,760
here

1385
00:51:37,760 --> 00:51:38,730
thank you man

1386
00:51:38,730 --> 00:51:38,920
[Applause]

1387
00:51:38,920 --> 00:51:40,559
[Music]

1388
00:51:40,559 --> 00:51:44,119
thank you very much

1389
00:51:54,160 --> 00:51:56,240
you

