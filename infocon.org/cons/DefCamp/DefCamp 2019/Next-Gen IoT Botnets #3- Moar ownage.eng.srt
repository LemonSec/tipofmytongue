1
00:00:00,030 --> 00:00:12,030
good morning def cam so happy to see so

2
00:00:09,630 --> 00:00:16,170
many of you this morning I had such low

3
00:00:12,030 --> 00:00:17,850
expectations honestly I mean we all know

4
00:00:16,170 --> 00:00:20,160
what happens in the first night of a

5
00:00:17,850 --> 00:00:21,990
conference that's literally when

6
00:00:20,160 --> 00:00:25,109
everything happens so seeing so many of

7
00:00:21,990 --> 00:00:41,390
you so early thank you

8
00:00:25,109 --> 00:00:44,579
so before I begin yeah and on that note

9
00:00:41,390 --> 00:00:46,379
a subject that's very dear to me and I

10
00:00:44,579 --> 00:00:48,450
apologize for being just a little bit of

11
00:00:46,379 --> 00:00:50,640
topic but I feel that this is important

12
00:00:48,450 --> 00:00:52,710
is mind

13
00:00:50,640 --> 00:00:55,199
the journalists mind the news and mind

14
00:00:52,710 --> 00:00:57,980
the way the journalists screw up the

15
00:00:55,199 --> 00:01:01,890
news there's a million ways they do that

16
00:00:57,980 --> 00:01:03,930
sometimes they outright lie however

17
00:01:01,890 --> 00:01:06,060
there's many situations when you cannot

18
00:01:03,930 --> 00:01:09,570
do fact checking and they present some

19
00:01:06,060 --> 00:01:12,150
information as being true and it may be

20
00:01:09,570 --> 00:01:15,839
true but taken out of context and I'm

21
00:01:12,150 --> 00:01:17,610
just gonna give you an example 300

22
00:01:15,840 --> 00:01:21,960
server's belonging to security company

23
00:01:17,610 --> 00:01:23,880
BitDefender were had on in September so

24
00:01:21,960 --> 00:01:26,089
friends who believe that this news is

25
00:01:23,880 --> 00:01:26,089
fake

26
00:01:29,920 --> 00:01:43,880
cool well because because it was because

27
00:01:40,700 --> 00:01:45,800
Ronny Kwok's we have like thousands of

28
00:01:43,880 --> 00:01:50,000
honey pots honey pots our servers the

29
00:01:45,800 --> 00:01:52,820
right so technically a journalist can

30
00:01:50,000 --> 00:01:57,380
make the goddamn argument that this is

31
00:01:52,820 --> 00:01:58,940
effing truth so be mindful of how you

32
00:01:57,380 --> 00:02:00,800
read the news and how you're being

33
00:01:58,940 --> 00:02:03,770
presented the news especially during

34
00:02:00,800 --> 00:02:06,470
this completely useless election period

35
00:02:03,770 --> 00:02:09,310
I mean the election is okay but we know

36
00:02:06,470 --> 00:02:12,080
all know what's gonna happen

37
00:02:09,310 --> 00:02:13,760
they're also fresh from last night I'm

38
00:02:12,080 --> 00:02:20,630
very proud to say that we product a new

39
00:02:13,760 --> 00:02:25,700
a new research paper about ring doorbell

40
00:02:20,630 --> 00:02:28,490
and it was instantly covered by almost

41
00:02:25,700 --> 00:02:30,820
everybody who is anybody which was kind

42
00:02:28,490 --> 00:02:34,400
of cold but this all happened last night

43
00:02:30,820 --> 00:02:37,329
so yeah and the paper is available on

44
00:02:34,400 --> 00:02:40,190
our website you can read it it's yeah

45
00:02:37,330 --> 00:02:42,740
and I would like to emphasize the fact

46
00:02:40,190 --> 00:02:47,570
that the journalists loved it because it

47
00:02:42,740 --> 00:02:49,370
was it had the Amazon logo on it I mean

48
00:02:47,570 --> 00:02:51,230
I was talking to Lu Chen earlier we've

49
00:02:49,370 --> 00:02:52,880
put up research much cooler than this

50
00:02:51,230 --> 00:02:54,799
about you know hacking millions of

51
00:02:52,880 --> 00:02:58,160
devices and doing all kinds of crazy

52
00:02:54,800 --> 00:03:00,680
stuff with a real impact on the on the

53
00:02:58,160 --> 00:03:03,290
world wide web and it received

54
00:03:00,680 --> 00:03:05,510
significantly less coverage than during

55
00:03:03,290 --> 00:03:07,190
doorbell which is essentially the whole

56
00:03:05,510 --> 00:03:09,079
thing is that you can steal somebody's

57
00:03:07,190 --> 00:03:11,239
Wi-Fi password right if they have a

58
00:03:09,080 --> 00:03:12,739
Ringo though which is cool but it's not

59
00:03:11,239 --> 00:03:15,110
as full as tracking millions of devices

60
00:03:12,739 --> 00:03:17,360
however this having the Amazon tag on it

61
00:03:15,110 --> 00:03:24,110
TechCrunch seen it is more or everybody

62
00:03:17,360 --> 00:03:27,050
it's like so to the topical hand we have

63
00:03:24,110 --> 00:03:31,850
been doing IT security research for the

64
00:03:27,050 --> 00:03:34,480
past five six years and as of like three

65
00:03:31,850 --> 00:03:37,890
years ago we started to focus a lot on

66
00:03:34,480 --> 00:03:39,959
cloud implementations in IOT

67
00:03:37,890 --> 00:03:42,720
we published papers with send

68
00:03:39,960 --> 00:03:44,820
notifications and just as the first joke

69
00:03:42,720 --> 00:03:46,740
of the day this is kind of what we

70
00:03:44,820 --> 00:03:48,660
imagined happened at vendor HQ when we

71
00:03:46,740 --> 00:03:50,970
send our notifications because this is

72
00:03:48,660 --> 00:04:01,769
literally the kind of feeling that we

73
00:03:50,970 --> 00:04:03,030
got from the replies no sound well

74
00:04:01,770 --> 00:04:06,060
essentially the guy says do you know the

75
00:04:03,030 --> 00:04:10,170
cloud and she says oh and the guy says

76
00:04:06,060 --> 00:04:12,690
nobody understands the cloud yeah it's

77
00:04:10,170 --> 00:04:14,970
because again apparently many people

78
00:04:12,690 --> 00:04:17,040
love the cloud they love AWS and the

79
00:04:14,970 --> 00:04:18,899
love is 3 and they love I don't know

80
00:04:17,040 --> 00:04:21,150
different type of cloud platforms and

81
00:04:18,899 --> 00:04:26,489
they're pretty much ok but when it comes

82
00:04:21,149 --> 00:04:29,940
to implementing them not that much so

83
00:04:26,490 --> 00:04:31,770
this is a slide that I I'm gonna we have

84
00:04:29,940 --> 00:04:35,010
a lot of content I have a lot of content

85
00:04:31,770 --> 00:04:36,260
in these talks I apologize for skipping

86
00:04:35,010 --> 00:04:38,730
kind of through some of the things

87
00:04:36,260 --> 00:04:40,260
mostly theory on how to start with

88
00:04:38,730 --> 00:04:42,090
hardware hacking in the upcoming slides

89
00:04:40,260 --> 00:04:43,770
you're gonna have the slide deck

90
00:04:42,090 --> 00:04:47,099
available on the death camp website so

91
00:04:43,770 --> 00:04:48,450
be warned that some of the information

92
00:04:47,100 --> 00:04:50,580
here I'm just gonna go through really

93
00:04:48,450 --> 00:04:55,020
really quick so I can focus on what's

94
00:04:50,580 --> 00:04:57,659
hot and cool so some of you have maybe

95
00:04:55,020 --> 00:05:02,340
seen this like this day slide before

96
00:04:57,660 --> 00:05:07,020
what if I told you that IO T's are like

97
00:05:02,340 --> 00:05:09,299
a wordpress website can anybody in the

98
00:05:07,020 --> 00:05:11,099
room raise their hand if they see the

99
00:05:09,300 --> 00:05:15,090
connection between an IOT and a

100
00:05:11,100 --> 00:05:20,640
WordPress website we have one brave and

101
00:05:15,090 --> 00:05:22,890
intelligent sir here great so before I

102
00:05:20,640 --> 00:05:24,510
give the answer to this puzzle I'm

103
00:05:22,890 --> 00:05:29,070
presenting you with this stack for those

104
00:05:24,510 --> 00:05:31,440
of you who are old enough RedHat 6.2 we

105
00:05:29,070 --> 00:05:34,950
have a stack hardware that had 6.2 and

106
00:05:31,440 --> 00:05:39,030
vu FTP d anybody here remember of FTP D

107
00:05:34,950 --> 00:05:41,250
from like 25 years ago it was known to

108
00:05:39,030 --> 00:05:46,979
provide remote or access to any Linux

109
00:05:41,250 --> 00:05:50,509
server reliably right you have Hardware

110
00:05:46,979 --> 00:05:53,880
a Windows platform in iOS 5.0

111
00:05:50,509 --> 00:05:56,490
there was the infamous is for 4.0 and

112
00:05:53,880 --> 00:05:57,930
5.0 which had like exploits you could

113
00:05:56,490 --> 00:06:01,110
you could you could access the file

114
00:05:57,930 --> 00:06:04,139
system on those servers from as an irony

115
00:06:01,110 --> 00:06:05,699
internet explorer because of some

116
00:06:04,139 --> 00:06:07,680
directory traversals and some other

117
00:06:05,699 --> 00:06:09,630
vulnerabilities so you have this other

118
00:06:07,680 --> 00:06:13,560
stack bite hardware operating system and

119
00:06:09,630 --> 00:06:17,909
then and then is 5.0 also Hardware

120
00:06:13,560 --> 00:06:22,520
windows and RDP Hardware windows

121
00:06:17,910 --> 00:06:25,020
hardware actually in whatever and Joomla

122
00:06:22,520 --> 00:06:27,659
this is the stack of venality

123
00:06:25,020 --> 00:06:31,380
it's hardware busybox in I represent of

124
00:06:27,660 --> 00:06:33,210
the cases and an application layer so in

125
00:06:31,380 --> 00:06:34,710
the case of IOT we have like hardware

126
00:06:33,210 --> 00:06:37,409
operating system and an application

127
00:06:34,710 --> 00:06:41,190
layer much like the case of these other

128
00:06:37,410 --> 00:06:45,780
stacks the Edition for it is that you

129
00:06:41,190 --> 00:06:48,509
also have cloud and the mobile app which

130
00:06:45,780 --> 00:06:51,000
essentially extend the attack surface

131
00:06:48,509 --> 00:06:53,190
for in a 102 vulnerability research to

132
00:06:51,000 --> 00:06:55,169
these other components as well so you'll

133
00:06:53,190 --> 00:06:57,300
have not only have the application layer

134
00:06:55,169 --> 00:06:58,650
here maybe busybox is okay let's just

135
00:06:57,300 --> 00:07:00,780
for the sake of argument setup busybox

136
00:06:58,650 --> 00:07:02,638
is okay the application layer is not

137
00:07:00,780 --> 00:07:04,020
always okay that can be a mobile app and

138
00:07:02,639 --> 00:07:06,300
the way it communicates is not always

139
00:07:04,020 --> 00:07:10,469
okay and the cloud is definitely not

140
00:07:06,300 --> 00:07:13,949
always okay I studied I mean you're

141
00:07:10,470 --> 00:07:16,560
gonna see actually so essentially IOT is

142
00:07:13,949 --> 00:07:17,729
are just websites anybody that

143
00:07:16,560 --> 00:07:20,699
contradicts me on this

144
00:07:17,729 --> 00:07:22,409
they're just web sites web services all

145
00:07:20,699 --> 00:07:24,479
of them if evil Roomba runs the web

146
00:07:22,409 --> 00:07:26,729
server there was no Sam at some point

147
00:07:24,479 --> 00:07:29,400
they tweet about somebody saying if I

148
00:07:26,729 --> 00:07:32,669
send them a malformed package to my room

149
00:07:29,400 --> 00:07:34,620
bus HTTP endpoint it crashes and

150
00:07:32,669 --> 00:07:37,948
somebody made a joke saying if only dogs

151
00:07:34,620 --> 00:07:39,330
have that intel dogs being afraid of

152
00:07:37,949 --> 00:07:41,400
vacuum cleaners and all that stuff so

153
00:07:39,330 --> 00:07:43,500
yeah ire keys are just websites running

154
00:07:41,400 --> 00:07:46,799
Linux but with a significantly bigger

155
00:07:43,500 --> 00:07:48,389
attack surface now this is the part

156
00:07:46,800 --> 00:07:51,720
where I'm gonna just skim through if you

157
00:07:48,389 --> 00:07:53,610
want to get into IT hacking look for

158
00:07:51,720 --> 00:07:55,860
open services there's a lot of command

159
00:07:53,610 --> 00:07:59,250
injection a special mention to buffer

160
00:07:55,860 --> 00:08:03,910
overflows who here is familiar with the

161
00:07:59,250 --> 00:08:07,030
code with a compiled flat PI P ie

162
00:08:03,910 --> 00:08:09,460
position independent executable right P

163
00:08:07,030 --> 00:08:11,289
ie as a flag is used to allow the binary

164
00:08:09,460 --> 00:08:14,560
to remove the different memory addresses

165
00:08:11,290 --> 00:08:16,120
in order to enable a SLR to function so

166
00:08:14,560 --> 00:08:18,100
essentially if you're able to get a

167
00:08:16,120 --> 00:08:19,960
buffer overflow in a binary you're not

168
00:08:18,100 --> 00:08:21,220
able to get an RC and command execution

169
00:08:19,960 --> 00:08:23,650
in it because you're not going to know

170
00:08:21,220 --> 00:08:30,820
the memory address of the function that

171
00:08:23,650 --> 00:08:33,069
crashed in IOT there is no pi there is

172
00:08:30,820 --> 00:08:35,860
no penalty simply because no vendor

173
00:08:33,070 --> 00:08:37,840
enables pi at compile time because it

174
00:08:35,860 --> 00:08:39,940
uses too much CPU cycles so essentially

175
00:08:37,840 --> 00:08:42,610
if you get a buffer overflow in an IOT

176
00:08:39,940 --> 00:08:45,490
you have a reliable in 99.9 percent of

177
00:08:42,610 --> 00:08:46,930
the cases remote code execution which is

178
00:08:45,490 --> 00:08:49,660
kind of cool so it's worth worth

179
00:08:46,930 --> 00:08:52,329
remembering that also worth mentioning

180
00:08:49,660 --> 00:08:54,219
there's a lot of charge code at some

181
00:08:52,330 --> 00:08:56,350
point we did a research on it on a

182
00:08:54,220 --> 00:08:59,070
device and then we found the same

183
00:08:56,350 --> 00:09:02,290
vulnerability in like 12 other brands

184
00:08:59,070 --> 00:09:04,270
different brands because as it turns out

185
00:09:02,290 --> 00:09:08,730
they were using the same core SDK for

186
00:09:04,270 --> 00:09:10,810
the for the former okay

187
00:09:08,730 --> 00:09:13,810
also worth mentioning that you can

188
00:09:10,810 --> 00:09:15,369
hijack the bootloader all varieties you

189
00:09:13,810 --> 00:09:18,569
hook up to the serial interface you're

190
00:09:15,370 --> 00:09:20,470
going to be prompted with a login shell

191
00:09:18,570 --> 00:09:23,140
arguably you're not gonna know the

192
00:09:20,470 --> 00:09:26,290
credentials to log on I mean of course

193
00:09:23,140 --> 00:09:29,770
they're going to be root and 1 2 3 4 in

194
00:09:26,290 --> 00:09:31,540
many cases but for the sake of argument

195
00:09:29,770 --> 00:09:32,760
and academic purposes let's say that

196
00:09:31,540 --> 00:09:34,839
it's a bit more difficult than that

197
00:09:32,760 --> 00:09:36,610
you're going to be able to hijack the

198
00:09:34,840 --> 00:09:39,670
bootloader much like you would do on a

199
00:09:36,610 --> 00:09:42,250
Linux machine you just pause it you just

200
00:09:39,670 --> 00:09:44,589
can't be very quick at pausing it and

201
00:09:42,250 --> 00:09:48,010
then you just pass arguments to in it

202
00:09:44,590 --> 00:09:51,250
and then and then yeah you're going to

203
00:09:48,010 --> 00:09:52,240
be dropped into a shell and exactly like

204
00:09:51,250 --> 00:09:54,450
you would do when you want to recover

205
00:09:52,240 --> 00:09:56,950
your root password on a little machine

206
00:09:54,450 --> 00:09:59,410
so you can do this with IOT quite

207
00:09:56,950 --> 00:10:01,810
reliably like the majority of the more

208
00:09:59,410 --> 00:10:04,030
than 60 or 70% of the is that we've

209
00:10:01,810 --> 00:10:06,520
analysed had a serial interface that we

210
00:10:04,030 --> 00:10:08,050
could find and do this so then you get

211
00:10:06,520 --> 00:10:09,819
access to the filesystem and it you have

212
00:10:08,050 --> 00:10:11,770
an easier time doing vulnerability

213
00:10:09,820 --> 00:10:13,800
research with access to all the files on

214
00:10:11,770 --> 00:10:16,800
that peyote

215
00:10:13,800 --> 00:10:16,800
now

216
00:11:05,610 --> 00:11:15,720
operate with monitoring right now

217
00:11:09,090 --> 00:11:15,720
families coming up to about 300 in total

218
00:11:16,230 --> 00:11:22,610
both for dealers and their correlation

219
00:11:20,560 --> 00:11:25,010
the functionality is

220
00:11:22,610 --> 00:11:27,440
infiltrate that right so we have honey

221
00:11:25,010 --> 00:11:29,899
pots we get the binaries and we pretend

222
00:11:27,440 --> 00:11:31,399
to be infected so and without executing

223
00:11:29,899 --> 00:11:36,200
their permits we are receiving their

224
00:11:31,399 --> 00:11:38,149
commands right understand a correlation

225
00:11:36,200 --> 00:11:40,790
between the commands and the functions

226
00:11:38,149 --> 00:11:42,890
available apartments and the websites

227
00:11:40,790 --> 00:11:47,089
that you see that offer special services

228
00:11:42,890 --> 00:11:52,430
and services the same function systemic

229
00:11:47,089 --> 00:11:56,290
relation between trivia so this is

230
00:11:52,430 --> 00:11:56,290
peripheral one to test people it will be

231
00:11:57,459 --> 00:12:05,510
moved to the one because it's more

232
00:12:02,690 --> 00:12:07,579
secure you don't need to open up the IRP

233
00:12:05,510 --> 00:12:10,069
in the England beat only to do port

234
00:12:07,579 --> 00:12:12,019
forwarding anymore everything is really

235
00:12:10,070 --> 00:12:15,310
quite about there's no direction direct

236
00:12:12,019 --> 00:12:15,310
connection to the enemies with the

237
00:12:15,940 --> 00:12:32,600
option and the thing is this first of

238
00:12:30,470 --> 00:12:35,480
all what architecture most of the

239
00:12:32,600 --> 00:12:39,310
platforms are provided to the IOT is a

240
00:12:35,480 --> 00:12:40,699
third party company including my own

241
00:12:39,310 --> 00:12:43,279
vacuum cleaner

242
00:12:40,699 --> 00:12:46,459
I don't do clouds on by the cloud

243
00:12:43,279 --> 00:12:49,250
platform from under X vendor X provide

244
00:12:46,459 --> 00:12:53,619
over the binary binary in mind

245
00:12:49,250 --> 00:12:56,620
piety and everything works you know

246
00:12:53,620 --> 00:12:56,620
insolence

247
00:13:08,029 --> 00:14:26,160
which is so as I was saying that much it

248
00:14:16,919 --> 00:14:27,600
is the only authentication that's the

249
00:14:26,160 --> 00:14:30,900
big problem is we're going to say that

250
00:14:27,600 --> 00:14:38,790
some members in the

251
00:14:30,900 --> 00:14:41,470
but they had them so they receive the

252
00:14:38,790 --> 00:14:43,569
implementation of the curriculum it's

253
00:14:41,470 --> 00:14:44,800
not enough today what would improve into

254
00:14:43,570 --> 00:14:49,590
themselves to having no experience

255
00:14:44,800 --> 00:14:49,589
account about worse at home worst this

256
00:14:55,710 --> 00:15:04,170
so if you were to astrabacus so in many

257
00:15:01,660 --> 00:15:09,790
cases this three pockets work like this

258
00:15:04,170 --> 00:15:12,329
I'm storing a file in this path and that

259
00:15:09,790 --> 00:15:14,560
path is related whatever device

260
00:15:12,330 --> 00:15:16,390
generates the facts we say about

261
00:15:14,560 --> 00:15:18,849
recording camera and I'm storing the

262
00:15:16,390 --> 00:15:20,500
recordings of a mystery bucket I know

263
00:15:18,850 --> 00:15:25,420
the path and then relate the information

264
00:15:20,500 --> 00:15:26,110
to cloud and that has to be the

265
00:15:25,420 --> 00:15:29,740
recording

266
00:15:26,110 --> 00:15:32,770
you cannot go up one level in feeling in

267
00:15:29,740 --> 00:15:34,930
a mystery box get the path in your file

268
00:15:32,770 --> 00:15:37,000
and if you know that path then you can

269
00:15:34,930 --> 00:15:43,449
read that file that's kind of how the

270
00:15:37,000 --> 00:15:46,240
security of history works and it should

271
00:15:43,450 --> 00:15:49,600
be allowed to see other files in the

272
00:15:46,240 --> 00:15:51,220
mystery bucket unfortunately if you want

273
00:15:49,600 --> 00:15:54,820
to look at the common for our

274
00:15:51,220 --> 00:15:58,800
municipalities a lot of implementations

275
00:15:54,820 --> 00:15:58,800
for long history pockets

276
00:15:59,030 --> 00:16:02,100
[Music]

277
00:16:30,689 --> 00:16:34,740
with the s3 buckets unsecured people can

278
00:16:32,970 --> 00:16:36,929
access those recordings and they can

279
00:16:34,740 --> 00:16:38,519
hear ambiental audio around the camera

280
00:16:36,929 --> 00:16:40,800
and all of these things and it's kind of

281
00:16:38,519 --> 00:16:43,199
really really screwed up and we've seen

282
00:16:40,800 --> 00:16:47,069
a lot unfortunately of this happening

283
00:16:43,199 --> 00:16:50,969
now mqtt infinity is a new management

284
00:16:47,069 --> 00:16:52,050
system known as rly new essentially the

285
00:16:50,970 --> 00:16:55,290
way it works is that the device

286
00:16:52,050 --> 00:16:56,878
registered to an MQTT controller and

287
00:16:55,290 --> 00:17:01,410
it's also something like a tree

288
00:16:56,879 --> 00:17:03,059
architecture a tree design and while you

289
00:17:01,410 --> 00:17:05,730
register to slash vendor slash device

290
00:17:03,059 --> 00:17:07,859
IDs slash topic we're topic is I'm

291
00:17:05,730 --> 00:17:11,669
online I'm offline I'm doing this I'm

292
00:17:07,859 --> 00:17:14,250
doing that and these topics are known by

293
00:17:11,669 --> 00:17:15,839
the mobile app so the mobile app knows I

294
00:17:14,250 --> 00:17:19,260
can register to slice vendor slash

295
00:17:15,839 --> 00:17:20,760
device ID slash online so I can get

296
00:17:19,260 --> 00:17:22,829
notifications when the device is online

297
00:17:20,760 --> 00:17:26,669
I can get notifications when the device

298
00:17:22,829 --> 00:17:29,700
is offline ideally I wouldn't know other

299
00:17:26,669 --> 00:17:36,799
device IDs so I wouldn't be able to read

300
00:17:29,700 --> 00:17:40,649
other people's statuses on entity so

301
00:17:36,799 --> 00:17:42,360
unfortunately as we've seen in some

302
00:17:40,649 --> 00:17:47,370
implementations rank EDD you can

303
00:17:42,360 --> 00:17:49,979
register to slash and get the statuses

304
00:17:47,370 --> 00:17:54,449
and configs of all the devices using

305
00:17:49,980 --> 00:17:55,799
that mqtt platform and with that

306
00:17:54,450 --> 00:17:57,929
information and get people's email

307
00:17:55,799 --> 00:18:00,960
addresses you get people's device there

308
00:17:57,929 --> 00:18:03,630
is a lot of useful information and also

309
00:18:00,960 --> 00:18:05,640
device ID so a hypothetical scenario

310
00:18:03,630 --> 00:18:08,039
when you would want to target somebody

311
00:18:05,640 --> 00:18:11,460
and get their recordings is that you

312
00:18:08,039 --> 00:18:13,590
would register to slash vendors MQTT get

313
00:18:11,460 --> 00:18:15,240
all the notifications from already

314
00:18:13,590 --> 00:18:19,530
until you see that person's email

315
00:18:15,240 --> 00:18:21,900
address with our email address you would

316
00:18:19,530 --> 00:18:23,750
see their device ID and with the device

317
00:18:21,900 --> 00:18:26,790
that you would go to the s3 bucket and

318
00:18:23,750 --> 00:18:29,070
list the recordings uniquely the

319
00:18:26,790 --> 00:18:30,840
recordings and of course this is a

320
00:18:29,070 --> 00:18:35,939
purely hypothetical scenario I don't

321
00:18:30,840 --> 00:18:39,179
know anybody that has done this of

322
00:18:35,940 --> 00:18:41,700
course so but I encourage you if you're

323
00:18:39,180 --> 00:18:43,950
into this kind of research to do it as

324
00:18:41,700 --> 00:18:45,690
well because we're going to talk about

325
00:18:43,950 --> 00:18:49,770
some legal issues at some point in this

326
00:18:45,690 --> 00:18:52,520
talk towards the end yes

327
00:18:49,770 --> 00:18:55,590
now some other things that we've done

328
00:18:52,520 --> 00:18:57,450
the infamous I've done presentations

329
00:18:55,590 --> 00:18:59,760
with this power outlet for about a year

330
00:18:57,450 --> 00:19:02,840
and a half at least at least 2000

331
00:18:59,760 --> 00:19:05,460
conferences was our first big

332
00:19:02,840 --> 00:19:07,199
presentation about how to hack get the

333
00:19:05,460 --> 00:19:09,630
root connect back shell on a power

334
00:19:07,200 --> 00:19:12,450
outlet on a device by exploiting the

335
00:19:09,630 --> 00:19:13,890
cloud essentially they had a command

336
00:19:12,450 --> 00:19:16,380
injection vulnerability and their

337
00:19:13,890 --> 00:19:19,560
authentication was the MAC address so if

338
00:19:16,380 --> 00:19:23,010
you send a request to their cloud saying

339
00:19:19,560 --> 00:19:25,800
tell this MAC address to turn off that's

340
00:19:23,010 --> 00:19:27,390
all it would turn off and then you would

341
00:19:25,800 --> 00:19:29,760
send a request to the cloud tell these

342
00:19:27,390 --> 00:19:32,430
MAC address to update the password to

343
00:19:29,760 --> 00:19:35,730
this other password and they would

344
00:19:32,430 --> 00:19:39,810
actually use the system command the

345
00:19:35,730 --> 00:19:41,370
passwd right so just say my column

346
00:19:39,810 --> 00:19:43,200
whatever set of password to stay my

347
00:19:41,370 --> 00:19:44,729
column whatever and then yeah BAM you

348
00:19:43,200 --> 00:19:48,930
get you get command execution connect

349
00:19:44,730 --> 00:19:52,080
back shell and there you go so we get to

350
00:19:48,930 --> 00:19:57,960
the topic of today this is actually the

351
00:19:52,080 --> 00:19:59,730
I've built up for half an hour for this

352
00:19:57,960 --> 00:20:01,770
so the Darjeeling small security camera

353
00:19:59,730 --> 00:20:04,770
the reason I'm doing this talk is that

354
00:20:01,770 --> 00:20:06,360
it's very very explicit and it really

355
00:20:04,770 --> 00:20:08,820
really explains why cloud

356
00:20:06,360 --> 00:20:11,070
implementations are bad and why when the

357
00:20:08,820 --> 00:20:13,320
replies are bad and sometimes why not

358
00:20:11,070 --> 00:20:14,550
picking the proper pen testing company

359
00:20:13,320 --> 00:20:18,810
when you're doing pen testing

360
00:20:14,550 --> 00:20:21,570
assessments is really really bad so a

361
00:20:18,810 --> 00:20:24,919
little bit of background and at this

362
00:20:21,570 --> 00:20:29,490
point call

363
00:20:24,920 --> 00:20:31,110
nice just checking so now we're there

364
00:20:29,490 --> 00:20:32,670
our initial analysis obviously the first

365
00:20:31,110 --> 00:20:34,800
thing that you start with you see how

366
00:20:32,670 --> 00:20:35,940
the app communicates with them device

367
00:20:34,800 --> 00:20:38,550
and you see how the app communicates

368
00:20:35,940 --> 00:20:42,060
with the cloud they have an API at apps

369
00:20:38,550 --> 00:20:44,100
that barceló calm and after the initial

370
00:20:42,060 --> 00:20:48,990
account registration the app receives a

371
00:20:44,100 --> 00:20:52,260
six digit long user ID gesture of

372
00:20:48,990 --> 00:21:00,000
curiosity anybody sees a problem just in

373
00:20:52,260 --> 00:21:03,570
this light no you already know it okay

374
00:21:00,000 --> 00:21:07,260
movie not movie no movie no that user ID

375
00:21:03,570 --> 00:21:13,500
cannot be changed and it's incremented

376
00:21:07,260 --> 00:21:15,060
by one for each new account and ours if

377
00:21:13,500 --> 00:21:18,960
you wanna have fun with it it's 4:08

378
00:21:15,060 --> 00:21:21,540
three one one and obviously you're not

379
00:21:18,960 --> 00:21:24,210
allowed but I've heard that at this

380
00:21:21,540 --> 00:21:28,200
point it got up to about five hundred

381
00:21:24,210 --> 00:21:30,720
and ninety thousand user IDs so cool

382
00:21:28,200 --> 00:21:32,760
stuff and more than that each user ID

383
00:21:30,720 --> 00:21:34,920
has more than one device associated with

384
00:21:32,760 --> 00:21:36,450
it because this is the kind of thing

385
00:21:34,920 --> 00:21:38,280
that Godzilla did so they took the

386
00:21:36,450 --> 00:21:41,130
device ID architecture and they said but

387
00:21:38,280 --> 00:21:42,389
we want a user ID ID as well in order to

388
00:21:41,130 --> 00:21:44,940
allow people to have more than one

389
00:21:42,390 --> 00:21:47,160
camera associated with their account so

390
00:21:44,940 --> 00:21:50,070
they've implemented this thing called a

391
00:21:47,160 --> 00:21:53,010
client ID which is a six digit string

392
00:21:50,070 --> 00:21:54,899
obviously predictable and as we're going

393
00:21:53,010 --> 00:21:58,440
to see really really stupid

394
00:21:54,900 --> 00:22:00,750
implementation so the way the mobile app

395
00:21:58,440 --> 00:22:05,520
behaves is that they send a post to the

396
00:22:00,750 --> 00:22:07,410
API with these details which would be a

397
00:22:05,520 --> 00:22:11,180
user ID guardzilla password a

398
00:22:07,410 --> 00:22:18,300
complicated password and that user ID

399
00:22:11,180 --> 00:22:19,590
but yeah so so these already in

400
00:22:18,300 --> 00:22:21,210
passwords are hard-coded so these are

401
00:22:19,590 --> 00:22:22,949
going to be always the same is are these

402
00:22:21,210 --> 00:22:27,840
in passwords for all guardzilla clients

403
00:22:22,950 --> 00:22:33,780
so the only thing that changes is user

404
00:22:27,840 --> 00:22:37,439
ID so uhm the poster encrypted way the

405
00:22:33,780 --> 00:22:38,040
AES 256 cbc mode bar the encryption key

406
00:22:37,440 --> 00:22:41,100
and the in

407
00:22:38,040 --> 00:22:43,230
halation Victoria hardcore India which

408
00:22:41,100 --> 00:22:46,169
obviously enabled us to create a small

409
00:22:43,230 --> 00:22:54,090
script that emulates the app for any

410
00:22:46,170 --> 00:22:57,900
guardzilla client and this is how a

411
00:22:54,090 --> 00:23:00,629
request looks like and we're actually

412
00:22:57,900 --> 00:23:01,890
gonna play with it now because I love I

413
00:23:00,630 --> 00:23:04,830
don't know if you know some of you know

414
00:23:01,890 --> 00:23:06,450
this about me I love live demos because

415
00:23:04,830 --> 00:23:08,490
what's life without a little adventure I

416
00:23:06,450 --> 00:23:12,180
have a success rate of over 60 percent

417
00:23:08,490 --> 00:23:16,200
right in live demos which is trust me

418
00:23:12,180 --> 00:23:18,180
it's like insanely well so I have a

419
00:23:16,200 --> 00:23:20,940
camera set up in my house pointing

420
00:23:18,180 --> 00:23:22,470
towards the street so what I'm going to

421
00:23:20,940 --> 00:23:25,110
do now is query the guardzilla cloud

422
00:23:22,470 --> 00:23:27,180
about the status of my client ID I'm

423
00:23:25,110 --> 00:23:30,419
gonna do this from a remote machine in

424
00:23:27,180 --> 00:23:33,740
Canada there so nothing up my sleeves

425
00:23:30,420 --> 00:23:33,740
and all that stuff and hopefully

426
00:23:42,580 --> 00:23:47,100
by the way do not type password type in

427
00:23:45,130 --> 00:23:49,690
passwords it's always bad

428
00:23:47,100 --> 00:23:53,370
anybody contradict me on that do not

429
00:23:49,690 --> 00:24:00,790
fight passwords so with the research

430
00:23:53,370 --> 00:24:03,399
words alone we're gonna use bash history

431
00:24:00,790 --> 00:24:05,350
because why not so we've created a

432
00:24:03,400 --> 00:24:07,240
script in Python that essentially does

433
00:24:05,350 --> 00:24:09,250
the same thing as the mobile app but

434
00:24:07,240 --> 00:24:12,070
generically so you can just change any

435
00:24:09,250 --> 00:24:15,520
kind of client ID you want I've added

436
00:24:12,070 --> 00:24:17,080
tail - 1 + JQ because this is how it

437
00:24:15,520 --> 00:24:24,490
looks and it looks ugly and we want it

438
00:24:17,080 --> 00:24:26,649
look pretty so I told the guerilla cloud

439
00:24:24,490 --> 00:24:28,720
to give me the details of that client ID

440
00:24:26,650 --> 00:24:31,990
for away 3 1 1 our client ID because

441
00:24:28,720 --> 00:24:34,420
obviously we wouldn't dare touch another

442
00:24:31,990 --> 00:24:37,360
person's client ID and he gave me back

443
00:24:34,420 --> 00:24:42,490
the device ID for camera is called bug

444
00:24:37,360 --> 00:24:44,050
boy with the password admin and I have a

445
00:24:42,490 --> 00:24:46,000
second camera which is actually not

446
00:24:44,050 --> 00:24:52,210
online right now the with the device ID

447
00:24:46,000 --> 00:24:59,590
tiny bugs and password and first demo

448
00:24:52,210 --> 00:25:01,890
work worth mentioning that the users can

449
00:24:59,590 --> 00:25:04,600
change the passwords for their cameras

450
00:25:01,890 --> 00:25:06,070
however since when clearing the

451
00:25:04,600 --> 00:25:08,560
guardzilla cloud you get back the

452
00:25:06,070 --> 00:25:10,240
password set for the camera you can set

453
00:25:08,560 --> 00:25:12,700
it to a hundred and twenty eight

454
00:25:10,240 --> 00:25:14,620
characters spaces and hashes and you

455
00:25:12,700 --> 00:25:16,660
know whatever commas in exclamation

456
00:25:14,620 --> 00:25:23,260
marks the gorilla cloud is going to tell

457
00:25:16,660 --> 00:25:24,430
it anyway so you can go full account

458
00:25:23,260 --> 00:25:26,290
takeover so there's a number of

459
00:25:24,430 --> 00:25:28,540
functions available in their API one of

460
00:25:26,290 --> 00:25:32,260
them is changing all the settings of the

461
00:25:28,540 --> 00:25:35,860
account there's no confirmation sent to

462
00:25:32,260 --> 00:25:39,790
the customer we just change the data and

463
00:25:35,860 --> 00:25:41,620
they do it it's like that and the

464
00:25:39,790 --> 00:25:43,270
alterations will be invalidated but we

465
00:25:41,620 --> 00:25:45,610
did not want to do this for the demo

466
00:25:43,270 --> 00:25:47,440
because we we felt that

467
00:25:45,610 --> 00:25:49,870
you know we want to do something cooler

468
00:25:47,440 --> 00:25:55,240
so we built a client that emulates the

469
00:25:49,870 --> 00:26:00,129
app and do not install updates by the

470
00:25:55,240 --> 00:26:02,260
way when you drink demos words of the

471
00:26:00,130 --> 00:26:03,750
wise trust me I've been burned a few

472
00:26:02,260 --> 00:26:12,820
times

473
00:26:03,750 --> 00:26:14,559
so essentially what it does it talks to

474
00:26:12,820 --> 00:26:16,210
the guardzilla cloud and tells it to

475
00:26:14,559 --> 00:26:18,720
pipe the faith and we're creating a

476
00:26:16,210 --> 00:26:18,720
local pipe

477
00:26:36,560 --> 00:26:42,200
oh wait wait wait wait wait wait wait

478
00:26:38,210 --> 00:26:45,550
sorry sorry sorry so you see no you

479
00:26:42,200 --> 00:26:45,550
don't want to know what I just did okay

480
00:26:47,290 --> 00:27:05,050
it was the wrong device ID these are not

481
00:26:53,930 --> 00:27:07,910
the droids you're looking for see as a

482
00:27:05,050 --> 00:27:09,550
not very dear friend of myself more

483
00:27:07,910 --> 00:27:14,350
better

484
00:27:09,550 --> 00:27:14,350
so we pipe it to VLC

485
00:27:23,520 --> 00:27:31,139
I don't remember all of these things by

486
00:27:26,309 --> 00:27:35,160
hand my art so yeah it's not foolproof

487
00:27:31,140 --> 00:27:38,360
it's kind of buggy but it works so yeah

488
00:27:35,160 --> 00:27:38,360
their demo number one thank you

489
00:27:38,390 --> 00:27:48,230
[Applause]

490
00:27:43,330 --> 00:27:50,750
now for my next trick we found out that

491
00:27:48,230 --> 00:27:52,700
we did all that work we actually wrote a

492
00:27:50,750 --> 00:27:53,750
client that connects the RAM and we

493
00:27:52,700 --> 00:27:57,850
found that there's an easy way because

494
00:27:53,750 --> 00:28:00,170
they have an API that's false and invite

495
00:27:57,850 --> 00:28:02,120
that only requires a user ID and the

496
00:28:00,170 --> 00:28:04,550
device ID which we obtained earlier and

497
00:28:02,120 --> 00:28:07,489
it can be used to forge an invitation to

498
00:28:04,550 --> 00:28:11,060
allow somebody to view your camera and

499
00:28:07,490 --> 00:28:14,510
very very funny the owner has no idea

500
00:28:11,060 --> 00:28:16,840
that this is happening so for my next

501
00:28:14,510 --> 00:28:16,840
trick

502
00:28:33,340 --> 00:28:36,090
cool

503
00:28:37,020 --> 00:28:50,500
I'm gonna send an invite to my phone I

504
00:28:40,660 --> 00:28:53,220
have Godzilla installed here yeah so two

505
00:28:50,500 --> 00:28:53,220
to two

506
00:28:56,400 --> 00:29:05,220
so this is what's gonna be displayed on

507
00:28:58,590 --> 00:29:07,409
the attackers phone hang on somebody

508
00:29:05,220 --> 00:29:10,380
invited you to view their webcam and

509
00:29:07,410 --> 00:29:13,440
again there is an absolutely no

510
00:29:10,380 --> 00:29:15,870
notification on the owners interface

511
00:29:13,440 --> 00:29:18,540
dashboard email whatever so somebody can

512
00:29:15,870 --> 00:29:20,340
just send a request to the API invite

513
00:29:18,540 --> 00:29:21,600
themselves to be the webcam and the

514
00:29:20,340 --> 00:29:26,909
owner of the webcam would have no idea

515
00:29:21,600 --> 00:29:31,230
that that happens and we accept and

516
00:29:26,910 --> 00:29:35,480
we're going to have the camera disarmed

517
00:29:31,230 --> 00:29:35,480
and much better quality

518
00:29:39,580 --> 00:29:43,699
[Applause]

519
00:29:43,970 --> 00:29:50,210
so that's with viewing the video feed

520
00:29:54,860 --> 00:29:58,830
but you know I promise you guys next gen

521
00:29:57,840 --> 00:30:02,070
hype ordinance

522
00:29:58,830 --> 00:30:05,070
so that means remote shelves right so

523
00:30:02,070 --> 00:30:07,710
poppin root on the device so a few

524
00:30:05,070 --> 00:30:10,230
technical information as I saying the

525
00:30:07,710 --> 00:30:13,140
cloud platform usually gives a binary to

526
00:30:10,230 --> 00:30:16,500
the to the vendor and that binary is

527
00:30:13,140 --> 00:30:20,670
just dumped on the file system their

528
00:30:16,500 --> 00:30:25,140
binary is called main dot v5 one for

529
00:30:20,670 --> 00:30:29,340
that exe because I know why not it's a

530
00:30:25,140 --> 00:30:31,320
Linux system of the road and the way the

531
00:30:29,340 --> 00:30:34,139
way it's used is that it provides a

532
00:30:31,320 --> 00:30:36,330
relay of p2p servers to bypass not

533
00:30:34,140 --> 00:30:41,220
essentially so to allow somebody to view

534
00:30:36,330 --> 00:30:42,810
the video field and when looking at the

535
00:30:41,220 --> 00:30:45,960
way the binary works we put it in either

536
00:30:42,810 --> 00:30:47,730
and we see if we notice the function T

537
00:30:45,960 --> 00:30:50,730
case the device not only to handle blah

538
00:30:47,730 --> 00:30:53,910
blah blah essentially a specially

539
00:30:50,730 --> 00:30:56,540
crafted buffer sent over the cloud will

540
00:30:53,910 --> 00:31:01,640
overflow a few functions in that

541
00:30:56,540 --> 00:31:05,430
function you see string copy 29 and 28

542
00:31:01,640 --> 00:31:07,620
we overflow 28 beginning get into 29 and

543
00:31:05,430 --> 00:31:08,910
then we'll get to the return address in

544
00:31:07,620 --> 00:31:14,219
the stack frame and essentially after

545
00:31:08,910 --> 00:31:18,980
that we have system so when it's a

546
00:31:14,220 --> 00:31:18,980
simple with a simple overflow and then

547
00:31:19,310 --> 00:31:25,740
it's a simple this is the entire exploit

548
00:31:22,370 --> 00:31:27,629
the main body is going to crash but it's

549
00:31:25,740 --> 00:31:28,860
gonna stay alive as long as we're

550
00:31:27,630 --> 00:31:31,020
connected to it if you're familiar with

551
00:31:28,860 --> 00:31:32,790
the way buffer overflows work this is

552
00:31:31,020 --> 00:31:33,660
how it works in in most cases the binder

553
00:31:32,790 --> 00:31:39,810
is gonna stay alive

554
00:31:33,660 --> 00:31:44,490
as long as we are using it and we're

555
00:31:39,810 --> 00:31:48,540
gonna try that now so we have gonna open

556
00:31:44,490 --> 00:31:52,700
up another shell on that server I do not

557
00:31:48,540 --> 00:31:52,700
try to hack the camera in my house

558
00:31:53,580 --> 00:32:08,749
so set up a listener and proper yes

559
00:32:13,890 --> 00:32:23,460
and there we go we have a shell in my

560
00:32:16,080 --> 00:32:26,059
house yeah I D I have roots on the

561
00:32:23,460 --> 00:32:26,059
camera in my house

562
00:32:27,919 --> 00:32:32,130
so the reason I set it up like this is

563
00:32:31,019 --> 00:32:35,519
just to show you guys that it's

564
00:32:32,130 --> 00:32:38,250
completely fully remote with no direct

565
00:32:35,519 --> 00:32:41,399
access there's no open ports there's no

566
00:32:38,250 --> 00:32:43,230
you know direct connection or exploiting

567
00:32:41,399 --> 00:32:45,840
the service like a tone that or initiate

568
00:32:43,230 --> 00:32:47,760
be the server or whatever FTP server DNS

569
00:32:45,840 --> 00:32:50,610
server what there's nothing like that

570
00:32:47,760 --> 00:32:53,129
it's just exploiting a binary on the

571
00:32:50,610 --> 00:32:56,549
file system that runs that has input

572
00:32:53,130 --> 00:33:00,029
sent to it relayed by the cloud and this

573
00:32:56,549 --> 00:33:02,429
is a on attack vector that's not that

574
00:33:00,029 --> 00:33:05,100
difficult to analyze actually it's not a

575
00:33:02,429 --> 00:33:09,090
difficult to find and it's present in oh

576
00:33:05,100 --> 00:33:12,449
my god so many devices and if anybody

577
00:33:09,090 --> 00:33:16,789
wants to run in it any commands this is

578
00:33:12,450 --> 00:33:16,789
the kernel version it's sun block block

579
00:33:17,840 --> 00:33:32,000
is the CPU and this is a PS and this is

580
00:33:27,570 --> 00:33:36,809
my show okay

581
00:33:32,000 --> 00:33:37,789
onwards very quickly through this well

582
00:33:36,809 --> 00:33:42,090
so far I found the command injection

583
00:33:37,789 --> 00:33:43,559
essentially when you send a sent again

584
00:33:42,090 --> 00:33:45,090
through the cloud you tell the device

585
00:33:43,559 --> 00:33:47,940
that it has an update and that update is

586
00:33:45,090 --> 00:33:50,010
available at one location is gonna try

587
00:33:47,940 --> 00:33:52,799
to download something from the location

588
00:33:50,010 --> 00:33:54,990
by using a system command using tar one

589
00:33:52,799 --> 00:33:56,970
packet it's going to be the system tar

590
00:33:54,990 --> 00:33:59,010
so you should pass it something that has

591
00:33:56,970 --> 00:34:01,880
the same I column in it is gonna end the

592
00:33:59,010 --> 00:34:07,529
third command and then execute your code

593
00:34:01,880 --> 00:34:09,200
because why not okay as a bonus a funny

594
00:34:07,529 --> 00:34:13,230
story I was doing this talk it derbycon

595
00:34:09,199 --> 00:34:15,949
and then another story about the

596
00:34:13,230 --> 00:34:20,460
guardzilla paper is that some guys

597
00:34:15,949 --> 00:34:22,230
published about the able AWS doc bucket

598
00:34:20,460 --> 00:34:24,869
axis so especially they had all these

599
00:34:22,230 --> 00:34:26,730
vulnerabilities and also an open AWS s3

600
00:34:24,869 --> 00:34:27,119
bucket with all the files and all the

601
00:34:26,730 --> 00:34:29,998
record

602
00:34:27,119 --> 00:34:32,519
all that stuff and then some guys

603
00:34:29,998 --> 00:34:33,959
published that we saw it on reddit so

604
00:34:32,518 --> 00:34:35,808
that kind of forced our hand to publish

605
00:34:33,960 --> 00:34:38,069
all our research in our entire paper

606
00:34:35,809 --> 00:34:39,869
fast forward we believe that they at

607
00:34:38,069 --> 00:34:43,379
least closed the s3 bucket

608
00:34:39,869 --> 00:34:47,099
I presented derbycon and I said bonus

609
00:34:43,379 --> 00:34:49,348
AWS bucket access and fixed and because

610
00:34:47,099 --> 00:34:54,690
it's a small world two guys in the back

611
00:34:49,349 --> 00:34:57,450
of the room like no it's not that was

612
00:34:54,690 --> 00:34:59,759
you guys yeah and apparently the guys

613
00:34:57,450 --> 00:35:01,769
that published on reddit the other thing

614
00:34:59,759 --> 00:35:04,140
about the AWS bucket were in the room so

615
00:35:01,769 --> 00:35:08,419
on stage I just paused opened and

616
00:35:04,140 --> 00:35:11,328
deleted the fixed part so it's not fixed

617
00:35:08,420 --> 00:35:15,119
yeah

618
00:35:11,329 --> 00:35:17,819
so to sum up your unit is just that in

619
00:35:15,119 --> 00:35:20,450
that initial user ID which is a six

620
00:35:17,819 --> 00:35:23,089
digit string completely predictable

621
00:35:20,450 --> 00:35:25,649
incremented by one for each customer

622
00:35:23,089 --> 00:35:28,319
there is about almost six hundred

623
00:35:25,650 --> 00:35:29,910
thousand client IDs at this point and

624
00:35:28,319 --> 00:35:32,249
each one of them has at least one camera

625
00:35:29,910 --> 00:35:33,899
many of them have two three five so that

626
00:35:32,249 --> 00:35:37,578
sums it up to probably millions of

627
00:35:33,900 --> 00:35:40,920
devices that are affected by this and

628
00:35:37,579 --> 00:35:42,539
you can get both you can both pop

629
00:35:40,920 --> 00:35:44,910
shelves on them connect back shows and

630
00:35:42,539 --> 00:35:49,859
you can also get unauthenticated access

631
00:35:44,910 --> 00:35:52,470
to the video streams as takeaways RIT is

632
00:35:49,859 --> 00:35:55,499
a huge attack surface and doing IT

633
00:35:52,470 --> 00:35:58,649
security research is fun and it's easy

634
00:35:55,499 --> 00:36:01,799
and this is more of an enterprise

635
00:35:58,650 --> 00:36:03,569
message that says you know the guys from

636
00:36:01,799 --> 00:36:05,339
guardzilla actually called me so I got a

637
00:36:03,569 --> 00:36:07,799
call from our OEM team saying you know

638
00:36:05,339 --> 00:36:08,940
hey J some guy from guardzilla wants to

639
00:36:07,799 --> 00:36:11,640
get in touch with you they want to talk

640
00:36:08,940 --> 00:36:13,559
to them and I'm like sure and the guy

641
00:36:11,640 --> 00:36:16,529
calls me and says why didn't you tell us

642
00:36:13,559 --> 00:36:18,029
these are the six seven emails that we'd

643
00:36:16,529 --> 00:36:20,640
sent to all of these email address that

644
00:36:18,029 --> 00:36:22,910
we could find on both LinkedIn and

645
00:36:20,640 --> 00:36:25,348
contact on your website nobody replied

646
00:36:22,910 --> 00:36:28,410
maybe you don't know what pgps or maybe

647
00:36:25,349 --> 00:36:30,359
you're afraid aren't and then I asked

648
00:36:28,410 --> 00:36:32,519
him so didn't you pen test your product

649
00:36:30,359 --> 00:36:35,848
before putting into the market and he

650
00:36:32,519 --> 00:36:38,549
said I did and how did you do it we

651
00:36:35,849 --> 00:36:39,340
hired a company to do it and you paid

652
00:36:38,549 --> 00:36:42,759
them money

653
00:36:39,340 --> 00:36:45,270
I actually honestly asked him that

654
00:36:42,760 --> 00:36:48,250
question because to see that there's a

655
00:36:45,270 --> 00:36:49,840
six-digit client I'd incremented by one

656
00:36:48,250 --> 00:36:51,910
and that all you need to interact with

657
00:36:49,840 --> 00:36:55,240
the cloud is that six digit client ID

658
00:36:51,910 --> 00:36:57,580
incremented by one took us three minutes

659
00:36:55,240 --> 00:36:59,169
I mean it took us longer to set up the

660
00:36:57,580 --> 00:37:03,610
device than it was they told us to see

661
00:36:59,170 --> 00:37:04,960
this right so if you if you're doing pen

662
00:37:03,610 --> 00:37:08,050
testing with a company make sure that

663
00:37:04,960 --> 00:37:11,860
that company is a good company also it's

664
00:37:08,050 --> 00:37:15,070
trivial to find our seasonality it's so

665
00:37:11,860 --> 00:37:16,330
I just wanted to close by talking

666
00:37:15,070 --> 00:37:19,150
remember I was saying something about

667
00:37:16,330 --> 00:37:21,819
legal and I wanted to touch about on

668
00:37:19,150 --> 00:37:25,810
this subject with you guys so just sort

669
00:37:21,820 --> 00:37:29,020
of curiosity how many of you work for a

670
00:37:25,810 --> 00:37:31,299
company okay no no no no no no I don't

671
00:37:29,020 --> 00:37:33,550
want to be scared about the forest of

672
00:37:31,300 --> 00:37:36,670
hands how many here how many of you here

673
00:37:33,550 --> 00:37:42,870
are independent researchers so not

674
00:37:36,670 --> 00:37:49,650
working for Big Brother one two three

675
00:37:42,870 --> 00:37:51,790
four so the reason I'm asking is we have

676
00:37:49,650 --> 00:37:56,220
only a fraction of our research

677
00:37:51,790 --> 00:37:56,220
published because of legal reasons

678
00:37:56,250 --> 00:38:01,390
because some of the research that we're

679
00:37:58,840 --> 00:38:03,550
doing because it's a bit frustrating for

680
00:38:01,390 --> 00:38:05,319
us that independent researchers have a

681
00:38:03,550 --> 00:38:11,110
bit more freedom into publishing stuff

682
00:38:05,320 --> 00:38:13,810
than we do the thing about MQTT and s3

683
00:38:11,110 --> 00:38:15,490
earlier in a hypothetical completely

684
00:38:13,810 --> 00:38:16,720
hypothetical scenario let's say that

685
00:38:15,490 --> 00:38:19,390
somebody discovered the smaller

686
00:38:16,720 --> 00:38:22,180
abilities by the only way to talk about

687
00:38:19,390 --> 00:38:25,089
them the only way to expose them right

688
00:38:22,180 --> 00:38:27,640
is to say that they've tried it right

689
00:38:25,090 --> 00:38:29,380
because you cannot say that that is

690
00:38:27,640 --> 00:38:31,029
three bucket is vulnerable until you've

691
00:38:29,380 --> 00:38:32,860
seen that it's vulnerable you cannot say

692
00:38:31,030 --> 00:38:35,310
that that MQTT implementation is bad

693
00:38:32,860 --> 00:38:39,580
until you've seen that you can actually

694
00:38:35,310 --> 00:38:44,680
register to that root in the tree of the

695
00:38:39,580 --> 00:38:47,830
design so if you're an independent and

696
00:38:44,680 --> 00:38:49,750
you want to do research in IOT we are

697
00:38:47,830 --> 00:38:51,670
willing to help you do that and we are

698
00:38:49,750 --> 00:38:53,320
willing to share our research with you

699
00:38:51,670 --> 00:38:56,170
and allow you to take the credit for

700
00:38:53,320 --> 00:38:58,840
some of the stuff that we did there's a

701
00:38:56,170 --> 00:39:02,260
case in particular where we really want

702
00:38:58,840 --> 00:39:04,060
it published for the sake of a lot of

703
00:39:02,260 --> 00:39:05,410
people there's a lot of a lot of people

704
00:39:04,060 --> 00:39:07,420
affected we were talking about it

705
00:39:05,410 --> 00:39:09,640
yesterday evening and we cannot publish

706
00:39:07,420 --> 00:39:11,830
it and it's frustrating because we want

707
00:39:09,640 --> 00:39:16,540
it fixed more than we want the glory and

708
00:39:11,830 --> 00:39:18,100
the fame for that point so yeah we are

709
00:39:16,540 --> 00:39:20,300
happy to help and feel free to reach out

710
00:39:18,100 --> 00:39:22,569
thank you so much

711
00:39:20,300 --> 00:39:25,749
[Applause]

712
00:39:22,570 --> 00:39:25,749
[Music]

713
00:39:25,849 --> 00:39:32,029
Oh another awesome talk Thank You Jay so

714
00:39:29,599 --> 00:39:34,309
much love the demos and I think I'm not

715
00:39:32,029 --> 00:39:37,400
the only one we can take two questions

716
00:39:34,309 --> 00:39:40,519
before going to the next stop we have

717
00:39:37,400 --> 00:39:46,459
one over here and the mic is coming to

718
00:39:40,519 --> 00:39:51,379
you soon the mic here okay you can talk

719
00:39:46,459 --> 00:40:03,769
into my mic what is your percentage of

720
00:39:51,380 --> 00:40:09,819
successful IOT devices for vendors that

721
00:40:03,769 --> 00:40:13,519
are not hard-coding their credentials

722
00:40:09,819 --> 00:40:15,380
thank you let me see if I got a question

723
00:40:13,519 --> 00:40:17,618
the best success story in terms of the

724
00:40:15,380 --> 00:40:22,009
relationship with the vendor no

725
00:40:17,619 --> 00:40:24,619
percentage like I tested 20 devices of

726
00:40:22,009 --> 00:40:28,130
those who are not with credentials

727
00:40:24,619 --> 00:40:31,420
hard-coded I successfully breached to

728
00:40:28,130 --> 00:40:35,359
three okay % let me answer it like this

729
00:40:31,420 --> 00:40:37,549
we are our we've researched about 60

730
00:40:35,359 --> 00:40:42,170
devices and we were successful in

731
00:40:37,549 --> 00:40:46,969
finding vulnerabilities in 54 and from

732
00:40:42,170 --> 00:40:48,769
those how many were we had coded it's

733
00:40:46,969 --> 00:40:50,359
just not now maybe we're going to be

734
00:40:48,769 --> 00:40:53,390
successful later for example there's the

735
00:40:50,359 --> 00:40:54,890
ring thing right initially we didn't

736
00:40:53,390 --> 00:40:57,379
think about looking at that particular

737
00:40:54,890 --> 00:40:58,910
vector of attack but then which was like

738
00:40:57,380 --> 00:41:01,130
last year when we initially looked at

739
00:40:58,910 --> 00:41:03,199
ring but then somebody came you know

740
00:41:01,130 --> 00:41:04,999
let's look at that and we looked at it

741
00:41:03,199 --> 00:41:07,219
now it wasn't default credentials it

742
00:41:04,999 --> 00:41:08,718
wasn't anything hard-coded but as far as

743
00:41:07,219 --> 00:41:10,339
vulnerabilities go everything is

744
00:41:08,719 --> 00:41:12,199
vulnerable and absolutely everything

745
00:41:10,339 --> 00:41:14,239
it's just the vulnerabilities that you

746
00:41:12,199 --> 00:41:17,839
haven't found yet the default

747
00:41:14,239 --> 00:41:20,059
credentials hard-coded is bad but I

748
00:41:17,839 --> 00:41:22,339
wouldn't phrase it as you know how many

749
00:41:20,059 --> 00:41:25,039
did we exploit and how many had before

750
00:41:22,339 --> 00:41:26,660
we exploited almost all of them but not

751
00:41:25,039 --> 00:41:28,130
all of them had default credentials only

752
00:41:26,660 --> 00:41:29,719
a few of them had default credentials

753
00:41:28,130 --> 00:41:33,769
actually so that's a good thing

754
00:41:29,719 --> 00:41:37,729
we carry phrase like trivial something

755
00:41:33,769 --> 00:41:38,399
well yeah but yeah your protection just

756
00:41:37,729 --> 00:41:40,589
for the

757
00:41:38,400 --> 00:41:44,069
let's say you know the picture with the

758
00:41:40,589 --> 00:41:45,509
door that has no friends around let's

759
00:41:44,069 --> 00:41:48,270
take this afterwards because there's one

760
00:41:45,510 --> 00:41:51,770
more question thank you so much we're

761
00:41:48,270 --> 00:41:56,220
take gonna take just one more question

762
00:41:51,770 --> 00:41:58,440
hi since you started reporting

763
00:41:56,220 --> 00:42:00,328
vulnerabilities in IOT devices have you

764
00:41:58,440 --> 00:42:05,069
noticed any improvement in vendor

765
00:42:00,329 --> 00:42:07,230
responses no it's always the same

766
00:42:05,069 --> 00:42:08,670
vendors that have decent responses and

767
00:42:07,230 --> 00:42:11,130
it's always the same vendors that have

768
00:42:08,670 --> 00:42:13,260
shitty responses so it's like if it's

769
00:42:11,130 --> 00:42:16,079
Google it's cool if it's Amazon it's

770
00:42:13,260 --> 00:42:18,660
cool even if it's er me it's cool if

771
00:42:16,079 --> 00:42:21,150
it's like a brand that's responsible for

772
00:42:18,660 --> 00:42:26,250
something call if it's edimax

773
00:42:21,150 --> 00:42:31,020
it's decent not cool not quaver how is

774
00:42:26,250 --> 00:42:32,670
it like not great factorable and yeah so

775
00:42:31,020 --> 00:42:35,369
it's about the size of the company so

776
00:42:32,670 --> 00:42:37,619
more more popular vendors respond

777
00:42:35,369 --> 00:42:39,329
quicker or it's wrong it's because of

778
00:42:37,619 --> 00:42:40,349
you guys is because of the journalist

779
00:42:39,329 --> 00:42:43,950
because you they're in the spotlight

780
00:42:40,349 --> 00:42:48,390
more and they don't want they feel

781
00:42:43,950 --> 00:42:51,529
responsible yes thanks cool thank you so

782
00:42:48,390 --> 00:42:51,529
much once again

