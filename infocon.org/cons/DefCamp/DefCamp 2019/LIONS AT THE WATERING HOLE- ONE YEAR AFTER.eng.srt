1
00:00:00,030 --> 00:00:07,109
hello guys thank your for for being here

2
00:00:04,350 --> 00:00:12,059
this late on the last day of deaf camp

3
00:00:07,109 --> 00:00:15,740
it's great to see you again some of you

4
00:00:12,059 --> 00:00:24,150
been here at my previous presentations

5
00:00:15,740 --> 00:00:25,380
my startup is called the can s it sites

6
00:00:24,150 --> 00:00:27,919
all the lines at the watering hole

7
00:00:25,380 --> 00:00:32,339
because there are a few similarities in

8
00:00:27,920 --> 00:00:34,860
types of attack my startup the detects

9
00:00:32,340 --> 00:00:38,160
with the watering hole and the predators

10
00:00:34,860 --> 00:00:41,670
in the in the real life I'm a simple

11
00:00:38,160 --> 00:00:44,309
security researcher I'm I wrote my first

12
00:00:41,670 --> 00:00:47,610
time antivirus in 1990 two years old

13
00:00:44,309 --> 00:00:49,620
kind of old I'm a private security

14
00:00:47,610 --> 00:00:55,730
consultant but also I'm a consultant for

15
00:00:49,620 --> 00:00:59,910
the Romanian national cert and last year

16
00:00:55,730 --> 00:01:05,220
exactly one year ago well in October

17
00:00:59,910 --> 00:01:08,490
2018 I I founded my my company and it

18
00:01:05,220 --> 00:01:14,158
became a part of orange fab accelerator

19
00:01:08,490 --> 00:01:17,759
in as soon as I as I founded it it was

20
00:01:14,159 --> 00:01:20,310
in stealth mode not going public this is

21
00:01:17,759 --> 00:01:27,330
what stealth mode means from October

22
00:01:20,310 --> 00:01:30,780
2018 until May 2019 right now I will

23
00:01:27,330 --> 00:01:36,360
present you one eye one year of activity

24
00:01:30,780 --> 00:01:39,979
of the Kenna's the scope of the chaos is

25
00:01:36,360 --> 00:01:44,220
to to find the methods of detecting

26
00:01:39,979 --> 00:01:45,780
previously unknown browser attacks

27
00:01:44,220 --> 00:01:48,090
including watering hole

28
00:01:45,780 --> 00:01:50,640
rabbi exploitation client exploitation

29
00:01:48,090 --> 00:01:55,259
or crypto jacking in legitimate websites

30
00:01:50,640 --> 00:01:59,640
but in a proactive way before the attack

31
00:01:55,259 --> 00:02:02,689
actually happens browser attacks are the

32
00:01:59,640 --> 00:02:07,079
most elusive and hard to detect types of

33
00:02:02,689 --> 00:02:13,180
attacks and this fact is only because of

34
00:02:07,079 --> 00:02:18,180
some HTTP particularities one of them

35
00:02:13,180 --> 00:02:21,700
is the fact that the HTTP was

36
00:02:18,180 --> 00:02:25,569
standardized as a as a protocol over a

37
00:02:21,700 --> 00:02:28,720
period of four years starting 1995 to

38
00:02:25,569 --> 00:02:33,399
1999 but the problem is that the first

39
00:02:28,720 --> 00:02:35,230
browser actually appeared in 1990s some

40
00:02:33,400 --> 00:02:38,799
of them appeared a little bit later

41
00:02:35,230 --> 00:02:40,230
there were a plethora of browsers back

42
00:02:38,799 --> 00:02:44,160
then

43
00:02:40,230 --> 00:02:47,129
Internet Explorer appeared in 1995 and

44
00:02:44,160 --> 00:02:50,349
you can imagine that not being

45
00:02:47,129 --> 00:02:53,858
correlated the unified standard to

46
00:02:50,349 --> 00:02:57,310
implement HTTP everybody implemented

47
00:02:53,859 --> 00:03:01,170
more or less their own versions of HTTP

48
00:02:57,310 --> 00:03:06,450
which later became unified in a standard

49
00:03:01,170 --> 00:03:09,899
the problem is that browser engines

50
00:03:06,450 --> 00:03:13,298
already had their core developed and

51
00:03:09,900 --> 00:03:15,730
they didn't want to to adhere it was to

52
00:03:13,299 --> 00:03:19,269
a single to a single standard so

53
00:03:15,730 --> 00:03:22,660
basically this is why one website looks

54
00:03:19,269 --> 00:03:26,200
different on Firefox and the Internet

55
00:03:22,660 --> 00:03:28,900
Explorer or or Chrome or why of course I

56
00:03:26,200 --> 00:03:31,418
scripting only works on Internet

57
00:03:28,900 --> 00:03:35,859
Explorer and doesn't work on any other

58
00:03:31,419 --> 00:03:40,959
browsers because every browser decided

59
00:03:35,859 --> 00:03:44,440
to implement its own vision of HTTP the

60
00:03:40,959 --> 00:03:47,650
other problem is the fact that HTTP is a

61
00:03:44,440 --> 00:03:54,489
very complex protocol and it basically

62
00:03:47,650 --> 00:03:58,810
unites some of other protocols and this

63
00:03:54,489 --> 00:04:01,930
this point create a weird situation in

64
00:03:58,810 --> 00:04:05,069
where there are certain gray areas which

65
00:04:01,930 --> 00:04:08,889
are interpreted differently by different

66
00:04:05,069 --> 00:04:11,250
browsers which are interpreted

67
00:04:08,889 --> 00:04:14,210
differently by different firewalls or

68
00:04:11,250 --> 00:04:15,620
anti viruses

69
00:04:14,210 --> 00:04:18,930
[Music]

70
00:04:15,620 --> 00:04:24,509
another problem is the fact that in the

71
00:04:18,930 --> 00:04:27,030
recent years JavaScript allowed the

72
00:04:24,509 --> 00:04:31,470
creation and the developed development

73
00:04:27,030 --> 00:04:35,729
of dynamic pages this created the

74
00:04:31,470 --> 00:04:38,849
premises for self-modifying code another

75
00:04:35,729 --> 00:04:43,130
problem is the fact that most of these

76
00:04:38,849 --> 00:04:45,810
communications is performed on HTTP and

77
00:04:43,130 --> 00:04:48,169
HTTPS has has a feature called the

78
00:04:45,810 --> 00:04:52,729
certificate pinning which makes

79
00:04:48,169 --> 00:04:58,740
interception rather impossible these

80
00:04:52,729 --> 00:05:03,090
specifics create a very fertile land for

81
00:04:58,740 --> 00:05:09,240
development of of web attacks these web

82
00:05:03,090 --> 00:05:13,560
attacks are very hard to detect and one

83
00:05:09,240 --> 00:05:16,169
of the few solutions to detect a web

84
00:05:13,560 --> 00:05:18,690
attack is to start a client-side

85
00:05:16,169 --> 00:05:22,650
honeypot own instrumented browser that

86
00:05:18,690 --> 00:05:26,340
visits a webpage and ways to be infected

87
00:05:22,650 --> 00:05:29,130
or not but this approach is very

88
00:05:26,340 --> 00:05:33,590
time-consuming because there are some

89
00:05:29,130 --> 00:05:36,630
techniques used by you by attackers that

90
00:05:33,590 --> 00:05:39,859
for instance only certain browsers are

91
00:05:36,630 --> 00:05:44,130
attacked only browsers with certain

92
00:05:39,860 --> 00:05:48,000
technologies are attacked or the fact

93
00:05:44,130 --> 00:05:52,080
that some some malware decides to delay

94
00:05:48,000 --> 00:05:54,750
the execution for one minute or two and

95
00:05:52,080 --> 00:05:58,130
if you start the sandbox analyzing that

96
00:05:54,750 --> 00:06:01,830
the sample that sample might never get

97
00:05:58,130 --> 00:06:06,060
actually analyzed because it will launch

98
00:06:01,830 --> 00:06:10,740
much later than the allowed time for for

99
00:06:06,060 --> 00:06:13,860
execution these problems generated one

100
00:06:10,740 --> 00:06:16,800
of the most dangerous attacks in today's

101
00:06:13,860 --> 00:06:20,550
security environment it's called

102
00:06:16,800 --> 00:06:22,620
watering hole attack his name is as I

103
00:06:20,550 --> 00:06:25,650
already said is derived from from nature

104
00:06:22,620 --> 00:06:27,160
when predators lurk in the bushes while

105
00:06:25,650 --> 00:06:29,849
prey comes to

106
00:06:27,160 --> 00:06:32,110
to drink water in the in the Savannah

107
00:06:29,850 --> 00:06:34,420
basically it's a computer attack

108
00:06:32,110 --> 00:06:38,020
strategy in which the victim is a

109
00:06:34,420 --> 00:06:43,300
particular group or organization or an

110
00:06:38,020 --> 00:06:46,780
individual and in this attack the the

111
00:06:43,300 --> 00:06:50,500
attacker knows observes or by any other

112
00:06:46,780 --> 00:06:57,599
means has an idea of certain websites

113
00:06:50,500 --> 00:07:01,060
that the target is usually visiting and

114
00:06:57,600 --> 00:07:03,180
decides to use an exploit to to take

115
00:07:01,060 --> 00:07:08,770
control of those those websites and

116
00:07:03,180 --> 00:07:11,830
infect them with with malware sometimes

117
00:07:08,770 --> 00:07:14,859
as I as I said earlier these attacks are

118
00:07:11,830 --> 00:07:18,729
undone discriminant they simply attack

119
00:07:14,860 --> 00:07:21,220
everyone some other times they look for

120
00:07:18,730 --> 00:07:23,470
specific IP ranges some other times they

121
00:07:21,220 --> 00:07:26,200
look for specific technologies some

122
00:07:23,470 --> 00:07:28,720
other time they have other specifics

123
00:07:26,200 --> 00:07:35,770
they they are interested in in before

124
00:07:28,720 --> 00:07:38,680
attacking a victim these specifics make

125
00:07:35,770 --> 00:07:40,900
the attack very hard to analyze by you

126
00:07:38,680 --> 00:07:46,510
by researchers because you can imagine

127
00:07:40,900 --> 00:07:50,940
that if the attacker attacker wants to

128
00:07:46,510 --> 00:07:50,940
target specific IP addresses and

129
00:07:51,629 --> 00:08:00,490
researcher uses a different IP address

130
00:07:54,190 --> 00:08:03,039
maybe more for sure his his he will

131
00:08:00,490 --> 00:08:05,729
never get get in fact that this fact

132
00:08:03,039 --> 00:08:09,490
makes the the analyze is very very hard

133
00:08:05,729 --> 00:08:13,300
for instance I will talk a little bit

134
00:08:09,490 --> 00:08:15,550
later about a very interesting attack an

135
00:08:13,300 --> 00:08:20,050
attack that I independently discovered

136
00:08:15,550 --> 00:08:24,789
with Google Google tag which only

137
00:08:20,050 --> 00:08:30,400
targeted the users who had Turkish

138
00:08:24,789 --> 00:08:33,729
language in their browser the watering

139
00:08:30,400 --> 00:08:38,049
hole attack phases can be like four or

140
00:08:33,729 --> 00:08:40,930
five phases the first phase is the phase

141
00:08:38,049 --> 00:08:43,449
where the victims are attracted to the

142
00:08:40,929 --> 00:08:46,270
to the website either bar by your

143
00:08:43,450 --> 00:08:49,240
regular browsing or by your spear

144
00:08:46,270 --> 00:08:52,209
phishing or any other any other method

145
00:08:49,240 --> 00:08:56,260
that would would get a victim to to to

146
00:08:52,209 --> 00:08:58,420
enter the the website the victim is

147
00:08:56,260 --> 00:09:02,589
fingerprinted as I used to say earlier

148
00:08:58,420 --> 00:09:06,189
based on IP or browser technologies and

149
00:09:02,589 --> 00:09:09,190
the attacker makes a list decision if

150
00:09:06,190 --> 00:09:13,470
they decide to attack the the victim or

151
00:09:09,190 --> 00:09:16,510
simply bled it past and do nothing

152
00:09:13,470 --> 00:09:18,579
victims of interested of interest are

153
00:09:16,510 --> 00:09:23,230
redirected to an at one exploitation

154
00:09:18,579 --> 00:09:25,120
server where usually they host an

155
00:09:23,230 --> 00:09:29,700
exploit kit which has different

156
00:09:25,120 --> 00:09:31,990
different exploits and in the case of

157
00:09:29,700 --> 00:09:34,750
not interesting victims they are

158
00:09:31,990 --> 00:09:38,920
redirected to the legitimate website

159
00:09:34,750 --> 00:09:42,579
with with no overhead and no problem no

160
00:09:38,920 --> 00:09:46,120
stress this is another representation of

161
00:09:42,579 --> 00:09:48,729
the browser attack at a anatomy you have

162
00:09:46,120 --> 00:09:53,020
one in the first in the first panel you

163
00:09:48,730 --> 00:09:56,380
have the multiple ways of of contact the

164
00:09:53,020 --> 00:09:58,930
way they attract attract visitors either

165
00:09:56,380 --> 00:10:01,899
through a normal website hosting a

166
00:09:58,930 --> 00:10:04,430
malicious advertisement as was the case

167
00:10:01,899 --> 00:10:06,620
with another campaign we

168
00:10:04,430 --> 00:10:09,800
if I'd then we will discuss later the

169
00:10:06,620 --> 00:10:13,480
mage cart campaign either to a

170
00:10:09,800 --> 00:10:17,569
compromised website or a spammed link

171
00:10:13,480 --> 00:10:20,660
the victims who get to the website by

172
00:10:17,570 --> 00:10:24,620
any any of these methods get redirected

173
00:10:20,660 --> 00:10:27,920
to the exploit it which in turn our

174
00:10:24,620 --> 00:10:31,720
after exploitation in fact the victim

175
00:10:27,920 --> 00:10:38,089
with either ransomware banking Trojans

176
00:10:31,720 --> 00:10:43,850
malware or crypto jackin basically this

177
00:10:38,089 --> 00:10:47,149
type of attack is impossible to do to

178
00:10:43,850 --> 00:10:50,149
blame on someone because for instance in

179
00:10:47,149 --> 00:10:54,110
case of spearfishing you can you can say

180
00:10:50,149 --> 00:10:58,580
that the the user was not careful enough

181
00:10:54,110 --> 00:11:02,060
he didn't have good security practices

182
00:10:58,580 --> 00:11:06,220
and he looked a link but in this case

183
00:11:02,060 --> 00:11:09,290
you simply walk into a website which is

184
00:11:06,220 --> 00:11:12,500
legitimate looking but it has been

185
00:11:09,290 --> 00:11:15,439
previously infected without anybody

186
00:11:12,500 --> 00:11:18,290
knowing for instance in the in the case

187
00:11:15,440 --> 00:11:21,140
of the Google of the attack discovered

188
00:11:18,290 --> 00:11:24,199
by by Google tag which will detail a

189
00:11:21,140 --> 00:11:27,380
little bit later the campaign lasted for

190
00:11:24,200 --> 00:11:31,459
two years for two years everybody who

191
00:11:27,380 --> 00:11:36,830
entered a certain web site and it had

192
00:11:31,459 --> 00:11:41,390
the Turkish as language was infected the

193
00:11:36,830 --> 00:11:44,660
idea is that the community considers web

194
00:11:41,390 --> 00:11:49,579
browser attacks as very dangerous but

195
00:11:44,660 --> 00:11:52,520
they are not so common and my idea is

196
00:11:49,579 --> 00:11:55,069
that they are not so uncommon but rather

197
00:11:52,520 --> 00:11:58,240
they are very hard to detect and this is

198
00:11:55,070 --> 00:12:02,360
the reason why we see an increase in

199
00:11:58,240 --> 00:12:06,620
complex watering hole attacks in the in

200
00:12:02,360 --> 00:12:09,200
the recent years mainly because of the

201
00:12:06,620 --> 00:12:11,089
fact that most of the victims don't

202
00:12:09,200 --> 00:12:14,060
realize they have been they have been

203
00:12:11,089 --> 00:12:16,850
compromised there is no obvious

204
00:12:14,060 --> 00:12:17,609
infection vector such as in the case of

205
00:12:16,850 --> 00:12:25,370
spirit

206
00:12:17,610 --> 00:12:29,339
so say putting my consultant hat I

207
00:12:25,370 --> 00:12:36,149
identified during my my investigations

208
00:12:29,339 --> 00:12:39,810
for investigations like seven out of ten

209
00:12:36,149 --> 00:12:43,380
cases where watering hole was used as

210
00:12:39,810 --> 00:12:47,250
the initial attack vector

211
00:12:43,380 --> 00:12:51,899
yet this type of attack is not as known

212
00:12:47,250 --> 00:12:54,540
as it should be most of the time the

213
00:12:51,899 --> 00:12:57,899
victims had state-of-the-art security in

214
00:12:54,540 --> 00:13:01,380
place there were no average Joes there

215
00:12:57,899 --> 00:13:04,459
were most of them were either security

216
00:13:01,380 --> 00:13:06,870
professionals journalists politicians

217
00:13:04,459 --> 00:13:12,479
people who were working in the

218
00:13:06,870 --> 00:13:15,529
intelligence community etc and the the

219
00:13:12,480 --> 00:13:18,240
reason why these people could have been

220
00:13:15,529 --> 00:13:19,920
infected in the first place is the fact

221
00:13:18,240 --> 00:13:23,850
that this attack is very hard to

222
00:13:19,920 --> 00:13:27,199
identify on the fly motive most of the

223
00:13:23,850 --> 00:13:29,670
solutions existing they're already

224
00:13:27,199 --> 00:13:34,290
employing traditional detection methods

225
00:13:29,670 --> 00:13:37,380
simply try to story simply try to catch

226
00:13:34,290 --> 00:13:40,760
the aftermath of the exploitation when

227
00:13:37,380 --> 00:13:43,769
the exploitation kit server tries to

228
00:13:40,760 --> 00:13:47,370
exploit the browser or a later phase

229
00:13:43,769 --> 00:13:51,300
when the attacker tries to contact the

230
00:13:47,370 --> 00:13:54,839
command and control server in order to

231
00:13:51,300 --> 00:13:59,670
give access to the to the attacker the

232
00:13:54,839 --> 00:14:02,480
problem is that in case of exploits most

233
00:13:59,670 --> 00:14:05,219
of the times are used zero-day exploit

234
00:14:02,480 --> 00:14:08,399
which means there are no signatures to

235
00:14:05,220 --> 00:14:11,459
be to be triggered and in the case of

236
00:14:08,399 --> 00:14:15,149
command and control server most of the

237
00:14:11,459 --> 00:14:18,869
times there are legitimate websites used

238
00:14:15,149 --> 00:14:21,779
as a command and control or simply fresh

239
00:14:18,870 --> 00:14:24,750
new fresh new IP addresses that haven't

240
00:14:21,779 --> 00:14:27,000
been involved in any type of illegal

241
00:14:24,750 --> 00:14:29,970
activities in the in the past so

242
00:14:27,000 --> 00:14:30,990
basically if you have a threat Intel

243
00:14:29,970 --> 00:14:34,889
feed and

244
00:14:30,990 --> 00:14:36,809
it's up-to-date you still can be can be

245
00:14:34,889 --> 00:14:40,680
attacked by your you still can be a

246
00:14:36,809 --> 00:14:44,189
victim of this this type of attack um I

247
00:14:40,680 --> 00:14:48,599
will have a few titles from the from the

248
00:14:44,189 --> 00:14:51,719
news to just to understand the the

249
00:14:48,600 --> 00:14:53,220
damage that was done and the victims the

250
00:14:51,720 --> 00:14:56,220
the magnitude of the of this type of

251
00:14:53,220 --> 00:14:58,139
attack we can see that Apple confirmed

252
00:14:56,220 --> 00:15:04,230
being hit in a recent watering hole

253
00:14:58,139 --> 00:15:06,209
attack if you see is from 2013 um I was

254
00:15:04,230 --> 00:15:09,769
developer site at core of Facebook Apple

255
00:15:06,209 --> 00:15:12,420
was hit by a watering hole attack

256
00:15:09,769 --> 00:15:15,119
Chinese attackers hacked Forbes website

257
00:15:12,420 --> 00:15:18,479
in watering hole attack the victims were

258
00:15:15,119 --> 00:15:21,360
in financial services or defense

259
00:15:18,480 --> 00:15:26,309
industry or intelligence community or

260
00:15:21,360 --> 00:15:29,129
even diplomats try to imagine the number

261
00:15:26,309 --> 00:15:32,339
of people visiting Forbes website try to

262
00:15:29,129 --> 00:15:36,089
imagine that what kind of people visit

263
00:15:32,339 --> 00:15:37,970
Forbes website these people had been

264
00:15:36,089 --> 00:15:41,040
attacked and had been targeted by

265
00:15:37,970 --> 00:15:46,079
unknown apt group in order to be to be

266
00:15:41,040 --> 00:15:50,009
compromised these news is from 2015 we

267
00:15:46,079 --> 00:15:52,410
see here that in this is the same news

268
00:15:50,009 --> 00:15:55,350
with watering hole that attacked

269
00:15:52,410 --> 00:15:58,769
Facebook Twitter and Apple you can

270
00:15:55,350 --> 00:16:01,470
imagine that all of these Facebook

271
00:15:58,769 --> 00:16:04,589
Twitter Apple Google Microsoft all other

272
00:16:01,470 --> 00:16:07,920
with victims had really tight security

273
00:16:04,589 --> 00:16:10,199
in place but the problem is that this

274
00:16:07,920 --> 00:16:12,929
type of attack doesn't focus on

275
00:16:10,199 --> 00:16:15,120
attacking the the server directly or the

276
00:16:12,929 --> 00:16:19,920
infrastructure directly but instead

277
00:16:15,120 --> 00:16:22,559
attacks the employees and employees have

278
00:16:19,920 --> 00:16:25,079
a lot of access if you know which

279
00:16:22,559 --> 00:16:28,559
employees to attack basically you have

280
00:16:25,079 --> 00:16:33,449
the the key to the kingdom in the case

281
00:16:28,559 --> 00:16:35,069
of the site that was used in the in the

282
00:16:33,449 --> 00:16:38,069
attack that compromised Facebook Apple

283
00:16:35,069 --> 00:16:41,579
and and Twitter and Twitter guys it was

284
00:16:38,069 --> 00:16:43,059
an iOS developer forum it was a very

285
00:16:41,579 --> 00:16:46,089
esteemed forum

286
00:16:43,059 --> 00:16:48,999
a lot of people were joining that forum

287
00:16:46,089 --> 00:16:52,479
regularly with different different

288
00:16:48,999 --> 00:16:56,019
problems and helping others with

289
00:16:52,479 --> 00:16:59,829
solutions it was a very very skilled and

290
00:16:56,019 --> 00:17:01,659
the quantitive community the attackers

291
00:16:59,829 --> 00:17:05,609
me exactly what they wanted when they

292
00:17:01,659 --> 00:17:12,009
decided to to compromise that this forum

293
00:17:05,609 --> 00:17:15,638
in 2017 it happened in 2016 later 2000

294
00:17:12,009 --> 00:17:18,128
2016 but the news appeared in 2017 we

295
00:17:15,638 --> 00:17:21,039
have banks around the world targeted in

296
00:17:18,128 --> 00:17:24,969
a watering hole attacks this story is

297
00:17:21,039 --> 00:17:28,720
very interesting because the actual

298
00:17:24,970 --> 00:17:35,730
attack had been identified by your pure

299
00:17:28,720 --> 00:17:39,190
luck as it's the the case with most of

300
00:17:35,730 --> 00:17:44,049
these these attacks detected in the in

301
00:17:39,190 --> 00:17:48,690
the world like 13 banks third 30 banks

302
00:17:44,049 --> 00:17:53,200
in Poland and more than 300 employees

303
00:17:48,690 --> 00:17:57,190
had been compromised through mar were

304
00:17:53,200 --> 00:18:00,580
planted in Polish Financial Supervision

305
00:17:57,190 --> 00:18:04,389
Authority this Financial Supervision

306
00:18:00,580 --> 00:18:07,980
Authority was giving regular updates on

307
00:18:04,389 --> 00:18:13,619
for the banking community they were

308
00:18:07,980 --> 00:18:13,619
regularly browsing that that that page

309
00:18:14,009 --> 00:18:19,419
more than 300 people had been

310
00:18:16,840 --> 00:18:24,639
compromised but but the attack was

311
00:18:19,419 --> 00:18:29,279
discovered by a guy who used to run all

312
00:18:24,639 --> 00:18:33,369
his stuff in a virtual machine that was

313
00:18:29,279 --> 00:18:36,279
monitored permanently and he realized

314
00:18:33,369 --> 00:18:39,720
the second day he he he got the job he

315
00:18:36,279 --> 00:18:43,240
realized that his virtual machine

316
00:18:39,720 --> 00:18:46,210
performed some activities in the

317
00:18:43,240 --> 00:18:48,999
previous night at 2:00 a.m. and he

318
00:18:46,210 --> 00:18:52,269
decided to go to let his boss now and

319
00:18:48,999 --> 00:18:56,330
they contacted the security company

320
00:18:52,269 --> 00:19:00,620
which he performed the forensics in the

321
00:18:56,330 --> 00:19:04,360
education with the extracted indicators

322
00:19:00,620 --> 00:19:08,809
of compromise they managed to identify

323
00:19:04,360 --> 00:19:11,740
not only the 30 banks in in Poland but

324
00:19:08,809 --> 00:19:16,039
also banks all over the world including

325
00:19:11,740 --> 00:19:21,320
Mexico including Portugal France or

326
00:19:16,039 --> 00:19:22,580
Germany we have another another news how

327
00:19:21,320 --> 00:19:24,428
watering hole attacks target the

328
00:19:22,580 --> 00:19:29,029
financial sector and government agencies

329
00:19:24,429 --> 00:19:29,750
just to understand the the type of the

330
00:19:29,029 --> 00:19:34,630
targets

331
00:19:29,750 --> 00:19:39,399
most of these attackers are looking for

332
00:19:34,630 --> 00:19:42,889
we have another example of a Trojan that

333
00:19:39,399 --> 00:19:46,459
was planted in a news website and simply

334
00:19:42,889 --> 00:19:51,860
attacked everybody who visited that

335
00:19:46,460 --> 00:19:55,399
website totally and discriminant we have

336
00:19:51,860 --> 00:19:58,250
here the content of the of the of the

337
00:19:55,399 --> 00:20:03,678
article that disappeared based on on

338
00:19:58,250 --> 00:20:08,210
this incident it's I I put it here just

339
00:20:03,679 --> 00:20:11,000
to just to point the fact that all the

340
00:20:08,210 --> 00:20:14,419
victims had been attacked not only

341
00:20:11,000 --> 00:20:16,610
government people or intelligence

342
00:20:14,419 --> 00:20:21,799
community you don't have to be special

343
00:20:16,610 --> 00:20:24,678
to be a target the main purpose of the

344
00:20:21,799 --> 00:20:28,730
attacker attackers is not only to to

345
00:20:24,679 --> 00:20:32,210
steal informations or get access but

346
00:20:28,730 --> 00:20:37,279
also to mine crack cryptocurrency is on

347
00:20:32,210 --> 00:20:43,700
on your device or even steal your crypto

348
00:20:37,279 --> 00:20:47,590
wallet or still your credit card etc we

349
00:20:43,700 --> 00:20:54,470
have here this is very recent it's from

350
00:20:47,590 --> 00:20:57,408
two months ago it's linked to the attack

351
00:20:54,470 --> 00:21:05,169
that we and the campaign we we also

352
00:20:57,409 --> 00:21:08,419
discovered sorry what did I do okay

353
00:21:05,169 --> 00:21:09,830
VRS watering hole vulnerability Google's

354
00:21:08,419 --> 00:21:12,110
Project zero team of security experts

355
00:21:09,830 --> 00:21:15,710
proactive research previously unknown

356
00:21:12,110 --> 00:21:19,059
vulnerabilities the internal threat

357
00:21:15,710 --> 00:21:22,909
analysis group find from the website and

358
00:21:19,059 --> 00:21:27,519
then they extrapolated and found many

359
00:21:22,909 --> 00:21:31,009
more that was targeting a particular

360
00:21:27,519 --> 00:21:32,960
minority in China I'm not saying it was

361
00:21:31,009 --> 00:21:34,220
the Chinese government or anything I'm

362
00:21:32,960 --> 00:21:38,350
just saying they targeted that

363
00:21:34,220 --> 00:21:45,110
particular minority or ethnic group that

364
00:21:38,350 --> 00:21:49,580
is that they used an iOS zero-day are

365
00:21:45,110 --> 00:21:55,189
zero days usually have been considered

366
00:21:49,580 --> 00:21:57,080
as something only available and that can

367
00:21:55,190 --> 00:22:01,190
only be used by your state

368
00:21:57,080 --> 00:22:04,369
state-sponsored attackers this is not

369
00:22:01,190 --> 00:22:07,999
exclusive cyber criminal groups have

370
00:22:04,369 --> 00:22:16,279
access to this type of this type of

371
00:22:07,999 --> 00:22:19,279
resources as well what is very

372
00:22:16,279 --> 00:22:21,740
interesting is the fact that the last

373
00:22:19,279 --> 00:22:24,200
paragraph we have here is given the

374
00:22:21,740 --> 00:22:26,679
exploit chains in place researchers

375
00:22:24,200 --> 00:22:30,139
estimated the left sites have been

376
00:22:26,679 --> 00:22:34,399
quietly hacking visitors with Apple

377
00:22:30,139 --> 00:22:38,330
devices for as much as two years for two

378
00:22:34,399 --> 00:22:44,029
years that certain website was attacking

379
00:22:38,330 --> 00:22:46,220
its users and nobody noticed you can

380
00:22:44,029 --> 00:22:50,360
imagine that at least a part of those

381
00:22:46,220 --> 00:22:53,570
users had anti viruses at least a part

382
00:22:50,360 --> 00:22:55,998
of those users were coming from a

383
00:22:53,570 --> 00:22:59,139
corporate network and they were

384
00:22:55,999 --> 00:22:59,139
protected by firewalls

385
00:22:59,950 --> 00:23:09,129
nobody discovered this attack until

386
00:23:03,200 --> 00:23:09,129
Google did and they can ask in parallel

387
00:23:09,700 --> 00:23:17,119
another title as you can see the date is

388
00:23:13,309 --> 00:23:18,710
from thirty thirty or thirty of August

389
00:23:17,119 --> 00:23:24,370
2019

390
00:23:18,710 --> 00:23:30,860
like two month ago we have a report from

391
00:23:24,370 --> 00:23:32,889
Kaspersky which identified one known apt

392
00:23:30,860 --> 00:23:35,959
group using a chrome zero-day exploit

393
00:23:32,890 --> 00:23:40,010
how many of you used Chrome for for web

394
00:23:35,960 --> 00:23:43,570
browsing okay I use Chrome too so

395
00:23:40,010 --> 00:23:47,240
basically if you entered a certain

396
00:23:43,570 --> 00:23:50,629
Korean news site you would have been

397
00:23:47,240 --> 00:23:54,050
exploited and you would have had no idea

398
00:23:50,630 --> 00:23:59,720
that your device had been had been

399
00:23:54,050 --> 00:24:02,510
compromised we have another new or

400
00:23:59,720 --> 00:24:04,340
another title over 18,000 web sites

401
00:24:02,510 --> 00:24:10,360
infested with mage card card skimming

402
00:24:04,340 --> 00:24:13,280
malware we see here that mage card

403
00:24:10,360 --> 00:24:17,000
attacked British Airways Newegg

404
00:24:13,280 --> 00:24:20,090
Ticketmaster baseball hall-of-fame a lot

405
00:24:17,000 --> 00:24:23,230
of places which are very interesting

406
00:24:20,090 --> 00:24:26,990
from the point of view of cyber criminal

407
00:24:23,230 --> 00:24:31,550
places where people actually have credit

408
00:24:26,990 --> 00:24:34,090
cards they did not they don't focus only

409
00:24:31,550 --> 00:24:39,350
on high-profile websites they also

410
00:24:34,090 --> 00:24:44,629
compromised small shops we actually

411
00:24:39,350 --> 00:24:53,240
caught a shop in UK not very big which

412
00:24:44,630 --> 00:24:59,270
was implanted with mage cards tools so

413
00:24:53,240 --> 00:25:03,230
to say as you can see the the victims

414
00:24:59,270 --> 00:25:06,520
are from Facebook Microsoft Google Apple

415
00:25:03,230 --> 00:25:09,170
Twitter Forbes countless banks

416
00:25:06,520 --> 00:25:12,910
telecommunication companies intelligence

417
00:25:09,170 --> 00:25:15,770
services military etc even a candy maker

418
00:25:12,910 --> 00:25:20,990
why would you hack a candy maker but

419
00:25:15,770 --> 00:25:23,420
okay in most of the cases the result of

420
00:25:20,990 --> 00:25:26,590
these these attacks are the full

421
00:25:23,420 --> 00:25:30,260
compromised of the of the of the device

422
00:25:26,590 --> 00:25:32,549
in 99% of the cases they use zero day

423
00:25:30,260 --> 00:25:35,099
vulnerabilities so basically

424
00:25:32,549 --> 00:25:38,849
you're totally unprotected because that

425
00:25:35,099 --> 00:25:41,879
vulnerability have was wasn't known at

426
00:25:38,849 --> 00:25:43,109
the moment the attack happened there was

427
00:25:41,879 --> 00:25:45,809
no signature for it

428
00:25:43,109 --> 00:25:47,639
there was no IOC's there was nothing so

429
00:25:45,809 --> 00:25:51,950
basically you could have had no idea

430
00:25:47,639 --> 00:25:55,379
that someone was going to attack you as

431
00:25:51,950 --> 00:25:57,809
a noob God said he's the CEO and founder

432
00:25:55,379 --> 00:26:01,218
of in Vincey a company they were

433
00:25:57,809 --> 00:26:04,469
involved in a watering hole incident

434
00:26:01,219 --> 00:26:06,509
analysis how can we train employees to

435
00:26:04,469 --> 00:26:08,429
be worried of watering hole sites it

436
00:26:06,509 --> 00:26:09,809
doesn't make any sense and I can just

437
00:26:08,429 --> 00:26:12,989
see why some CIA stones are getting

438
00:26:09,809 --> 00:26:16,408
frustrated at least as I was saying

439
00:26:12,989 --> 00:26:18,599
earlier with spear fishing you can blame

440
00:26:16,409 --> 00:26:21,149
the user even if it's not their fault

441
00:26:18,599 --> 00:26:22,708
with watering holes they can always say

442
00:26:21,149 --> 00:26:26,309
I had to go there for work

443
00:26:22,709 --> 00:26:28,919
I mean imagine the case with with with

444
00:26:26,309 --> 00:26:32,299
the Polish banks those people who were

445
00:26:28,919 --> 00:26:37,009
attacked who who became victims visited

446
00:26:32,299 --> 00:26:40,320
the governmental side of Polish

447
00:26:37,009 --> 00:26:43,169
Financial Supervision Authority they had

448
00:26:40,320 --> 00:26:44,908
to do that for their work and they

449
00:26:43,169 --> 00:26:49,039
became victims by doing that you can

450
00:26:44,909 --> 00:26:51,079
blame them why does this happen though

451
00:26:49,039 --> 00:26:53,549
the current situation is that

452
00:26:51,079 --> 00:26:57,389
traditional detection mechanisms either

453
00:26:53,549 --> 00:26:59,190
fail to detect the the attacks or they

454
00:26:57,389 --> 00:27:00,559
are too time-consuming to be to be

455
00:26:59,190 --> 00:27:08,219
feasible

456
00:27:00,559 --> 00:27:12,799
starting with 2015 2016 there was a need

457
00:27:08,219 --> 00:27:15,690
to extrapolate so to say the the

458
00:27:12,799 --> 00:27:18,299
signatures of the or the footprints of

459
00:27:15,690 --> 00:27:22,950
the attacks as traditional signature

460
00:27:18,299 --> 00:27:24,658
scanning was was insufficient so machine

461
00:27:22,950 --> 00:27:28,200
learning was used to to place to

462
00:27:24,659 --> 00:27:32,609
classify HTML elements as suspicious or

463
00:27:28,200 --> 00:27:36,509
not suspicious a few engines emerged one

464
00:27:32,609 --> 00:27:40,349
from Google one from Kaspersky one from

465
00:27:36,509 --> 00:27:42,059
the Kas us one from B defender maybe

466
00:27:40,349 --> 00:27:44,849
there are some others but I don't know

467
00:27:42,059 --> 00:27:46,020
of them the only difference between the

468
00:27:44,849 --> 00:27:50,100
Kenneth and the

469
00:27:46,020 --> 00:27:53,639
these other engines is the fact that the

470
00:27:50,100 --> 00:27:57,919
canis is not private the canals is not

471
00:27:53,640 --> 00:28:02,730
reserved to a few select number of

472
00:27:57,920 --> 00:28:06,000
researchers who can identify a watering

473
00:28:02,730 --> 00:28:09,540
hole and just let it be for a period of

474
00:28:06,000 --> 00:28:11,970
time just to perform their analysis the

475
00:28:09,540 --> 00:28:15,629
KS is accessible to anyone who is

476
00:28:11,970 --> 00:28:20,460
interested in knowing the websites he

477
00:28:15,630 --> 00:28:22,590
visits who needs to know if a certain

478
00:28:20,460 --> 00:28:27,590
website will attack him before he

479
00:28:22,590 --> 00:28:29,970
actually visits the website our

480
00:28:27,590 --> 00:28:33,810
detection approach as I was saying

481
00:28:29,970 --> 00:28:37,260
earlier is based on machine learning we

482
00:28:33,810 --> 00:28:43,129
classify HTML elements as suspicious or

483
00:28:37,260 --> 00:28:47,120
benig how did we compile the data set we

484
00:28:43,130 --> 00:28:51,300
we have a data set of 40-plus features

485
00:28:47,120 --> 00:28:55,409
they totally describe malicious HTML

486
00:28:51,300 --> 00:28:58,050
element amongst these features but not

487
00:28:55,410 --> 00:29:02,940
limited to this there are common

488
00:28:58,050 --> 00:29:05,520
instructions using using marker some

489
00:29:02,940 --> 00:29:10,350
specific code constructions which are

490
00:29:05,520 --> 00:29:14,160
used in malware and not in normal HTML

491
00:29:10,350 --> 00:29:19,050
elements or JavaScript programming

492
00:29:14,160 --> 00:29:23,550
styles and relations amongst all these

493
00:29:19,050 --> 00:29:27,300
together basically give you an exact

494
00:29:23,550 --> 00:29:33,270
idea if the HTML element you are

495
00:29:27,300 --> 00:29:36,270
analyzing is suspicious or is is safe we

496
00:29:33,270 --> 00:29:40,129
train the machine learning engine using

497
00:29:36,270 --> 00:29:43,440
a simple of 30,000 the HTML elements and

498
00:29:40,130 --> 00:29:47,370
we tested the machine learning algorithm

499
00:29:43,440 --> 00:29:52,680
with the remaining 10,000 10,000

500
00:29:47,370 --> 00:29:58,320
elements we had very very low false

501
00:29:52,680 --> 00:29:59,490
positives we had no false negatives the

502
00:29:58,320 --> 00:30:03,030
false positives were

503
00:29:59,490 --> 00:30:06,990
generated by the fact that some website

504
00:30:03,030 --> 00:30:12,960
programmers for reasons beyond me decide

505
00:30:06,990 --> 00:30:15,120
to use Marvel coding techniques and

506
00:30:12,960 --> 00:30:21,179
styles in order to perform more

507
00:30:15,120 --> 00:30:24,030
legitimate activities even if this

508
00:30:21,179 --> 00:30:28,080
happens they can as machine learning

509
00:30:24,030 --> 00:30:31,470
algorithm is backed by a series of sand

510
00:30:28,080 --> 00:30:34,020
boxes who work in parallel one of the

511
00:30:31,470 --> 00:30:36,030
sand boxes is based on node.js so

512
00:30:34,020 --> 00:30:39,270
basically it tries to interpret the

513
00:30:36,030 --> 00:30:42,510
actual JavaScript the other one is a

514
00:30:39,270 --> 00:30:47,010
high interactivity client-side honeypot

515
00:30:42,510 --> 00:30:50,360
is basically various browsers are are

516
00:30:47,010 --> 00:30:53,760
launched on on a work on the suspect

517
00:30:50,360 --> 00:30:56,189
website and they try to understand what

518
00:30:53,760 --> 00:31:00,510
is what is happening if the website is

519
00:30:56,190 --> 00:31:02,610
actually attacking or not the results of

520
00:31:00,510 --> 00:31:05,400
the machine learning by one hand and the

521
00:31:02,610 --> 00:31:08,850
sandboxes by the other hand are compared

522
00:31:05,400 --> 00:31:11,240
and if they are coherent the report is

523
00:31:08,850 --> 00:31:14,189
generated if they are not current and

524
00:31:11,240 --> 00:31:18,030
there are some discrepancies between

525
00:31:14,190 --> 00:31:22,620
between them that suspicious HTML

526
00:31:18,030 --> 00:31:26,820
element is forwarded to human analysts

527
00:31:22,620 --> 00:31:29,479
who can decide if the respective script

528
00:31:26,820 --> 00:31:31,830
is something malicious or not and

529
00:31:29,480 --> 00:31:35,340
according to to the results of the

530
00:31:31,830 --> 00:31:37,620
analysis the machine learning algorithm

531
00:31:35,340 --> 00:31:44,250
is retrained according to the new

532
00:31:37,620 --> 00:31:47,580
environment was founded in October 2018

533
00:31:44,250 --> 00:31:50,730
as I was saying earlier and in during

534
00:31:47,580 --> 00:31:53,210
this one year period we scanned a number

535
00:31:50,730 --> 00:32:00,210
of 6000 websites

536
00:31:53,210 --> 00:32:04,340
among these they were like 740 crypto

537
00:32:00,210 --> 00:32:08,270
checking websites websites that would

538
00:32:04,340 --> 00:32:11,100
perform mining activities in their

539
00:32:08,270 --> 00:32:12,639
visitors browsers without the users

540
00:32:11,100 --> 00:32:15,250
knowing this

541
00:32:12,640 --> 00:32:18,400
we found this free cyber criminal groups

542
00:32:15,250 --> 00:32:20,530
and the to apt groups partially possibly

543
00:32:18,400 --> 00:32:25,900
nation state I don't know I don't do

544
00:32:20,530 --> 00:32:27,010
what tribution so the first case study

545
00:32:25,900 --> 00:32:30,580
is called

546
00:32:27,010 --> 00:32:39,420
one website in Southeast Asia we have

547
00:32:30,580 --> 00:32:42,850
here the actual report from Project zero

548
00:32:39,420 --> 00:32:45,670
they they explained that the the that

549
00:32:42,850 --> 00:32:48,939
website was attacking the user using one

550
00:32:45,670 --> 00:32:51,790
iphone zero day in fact there were more

551
00:32:48,940 --> 00:32:58,300
iPhone zero days Android zero days and

552
00:32:51,790 --> 00:32:59,680
windows Internet Explorer zero days they

553
00:32:58,300 --> 00:33:02,680
also said there was no target

554
00:32:59,680 --> 00:33:08,020
discrimination but as you will see they

555
00:33:02,680 --> 00:33:13,270
were only focused on a certain language

556
00:33:08,020 --> 00:33:19,180
speaking group of people so it happened

557
00:33:13,270 --> 00:33:21,580
back in February or January 2018 one of

558
00:33:19,180 --> 00:33:24,100
our users browse the website in

559
00:33:21,580 --> 00:33:25,810
Southeast Asia doesn't matter which

560
00:33:24,100 --> 00:33:30,820
country but we all know which country it

561
00:33:25,810 --> 00:33:35,520
is one particular JavaScript triggered

562
00:33:30,820 --> 00:33:38,649
that they can si engine so basically I

563
00:33:35,520 --> 00:33:42,790
try to analyze that the JavaScript

564
00:33:38,650 --> 00:33:46,180
because it wasn't quite

565
00:33:42,790 --> 00:33:46,180
[Music]

566
00:33:46,540 --> 00:33:54,950
normal to see that type of activity when

567
00:33:51,860 --> 00:33:58,129
we analyze the JavaScript we realized it

568
00:33:54,950 --> 00:34:00,910
was jQuery jQuery is a very known and

569
00:33:58,130 --> 00:34:04,610
the widespread the JavaScript library

570
00:34:00,910 --> 00:34:11,020
but at the end of the library there was

571
00:34:04,610 --> 00:34:19,130
this little code this code here looks

572
00:34:11,020 --> 00:34:22,580
totally weird because his hex encoded no

573
00:34:19,130 --> 00:34:25,810
signature scanning could could see

574
00:34:22,580 --> 00:34:31,489
anything wrong with this piece of code

575
00:34:25,810 --> 00:34:35,120
but we actually managed to trigger a few

576
00:34:31,489 --> 00:34:38,569
features we actually saw that the code

577
00:34:35,120 --> 00:34:43,520
was obfuscated we saw that extra decimal

578
00:34:38,570 --> 00:34:46,070
right was used also we saw that

579
00:34:43,520 --> 00:34:48,860
hexadecimal right was used in abundance

580
00:34:46,070 --> 00:34:53,690
there was a lot of hexadecimal

581
00:34:48,860 --> 00:34:58,730
characters we also saw the window

582
00:34:53,690 --> 00:35:01,430
operator which is one of our features we

583
00:34:58,730 --> 00:35:04,460
we saw that the script was trying to

584
00:35:01,430 --> 00:35:07,940
fingerprint the the users as you see

585
00:35:04,460 --> 00:35:11,420
there is a navigator right at the book

586
00:35:07,940 --> 00:35:14,500
at the beginning of of the script the

587
00:35:11,420 --> 00:35:17,750
the Navigator tag player basically

588
00:35:14,500 --> 00:35:19,900
contains the language of the of the

589
00:35:17,750 --> 00:35:24,230
browser so they were focused on a

590
00:35:19,900 --> 00:35:28,880
certain group of people speaking a

591
00:35:24,230 --> 00:35:34,210
certain language we also noticed that

592
00:35:28,880 --> 00:35:40,430
they were some large and awkward looking

593
00:35:34,210 --> 00:35:43,040
variables used there so after the

594
00:35:40,430 --> 00:35:46,580
obfuscating and executing the suspicious

595
00:35:43,040 --> 00:35:51,170
javascript we we managed to get to this

596
00:35:46,580 --> 00:35:54,650
form this form which we see clearly now

597
00:35:51,170 --> 00:35:56,960
that they they check for a certain a

598
00:35:54,650 --> 00:35:59,839
certain language and

599
00:35:56,960 --> 00:36:00,920
if if the dead language is that

600
00:35:59,839 --> 00:36:05,440
condition is met

601
00:36:00,920 --> 00:36:09,079
they simply create a new a new throw a

602
00:36:05,440 --> 00:36:12,500
new script in the in the Dom and the

603
00:36:09,079 --> 00:36:16,930
dead script gets redirected to something

604
00:36:12,500 --> 00:36:24,460
that looks like the the beef framework

605
00:36:16,930 --> 00:36:24,460
everybody knows will be framework okay

606
00:36:25,300 --> 00:36:31,970
the only difference is that the

607
00:36:29,569 --> 00:36:37,700
framework the beef framework wasn't

608
00:36:31,970 --> 00:36:40,879
serving the regular exploits which are

609
00:36:37,700 --> 00:36:45,500
known by everybody but they had an

610
00:36:40,880 --> 00:36:49,089
iPhone exploit when I began analyzing

611
00:36:45,500 --> 00:36:53,780
the the the payload of the exploit I

612
00:36:49,089 --> 00:36:57,290
realized it might have been unknown at

613
00:36:53,780 --> 00:37:00,170
the moment of my analysis I started to

614
00:36:57,290 --> 00:37:05,240
ask some friends if they know something

615
00:37:00,170 --> 00:37:07,970
about this and they they told me that

616
00:37:05,240 --> 00:37:11,569
Google a threat analysis group is

617
00:37:07,970 --> 00:37:16,520
already monitoring that website and a

618
00:37:11,569 --> 00:37:21,720
few others and as a result I decided to

619
00:37:16,520 --> 00:37:23,410
keep my my findings private basically

620
00:37:21,720 --> 00:37:28,129
[Music]

621
00:37:23,410 --> 00:37:32,020
the another interesting case we had in

622
00:37:28,130 --> 00:37:36,170
the past past year was an encounter with

623
00:37:32,020 --> 00:37:38,690
with mage cart this happened while one

624
00:37:36,170 --> 00:37:41,809
of our users brought the non-line shop

625
00:37:38,690 --> 00:37:45,140
in the United Kingdom it was a rather

626
00:37:41,809 --> 00:37:50,780
small shop with something like a few

627
00:37:45,140 --> 00:37:54,650
thousand visitors per per day but still

628
00:37:50,780 --> 00:37:59,290
it was deemed as a good target for the

629
00:37:54,650 --> 00:38:02,480
the attackers one particular script

630
00:37:59,290 --> 00:38:05,440
included from a remote resources trigger

631
00:38:02,480 --> 00:38:08,569
that can ask the machine learning engine

632
00:38:05,440 --> 00:38:10,700
the remote resource had the whole name

633
00:38:08,569 --> 00:38:13,400
similar to legitimate content

634
00:38:10,700 --> 00:38:18,160
delivery in order to mask their their

635
00:38:13,400 --> 00:38:23,060
presence in the in the HTML page for the

636
00:38:18,160 --> 00:38:25,520
unwittingly eyes further analysis on the

637
00:38:23,060 --> 00:38:28,460
remotely included script revealed a few

638
00:38:25,520 --> 00:38:30,770
interesting aspects that the script was

639
00:38:28,460 --> 00:38:34,579
collecting credit card information which

640
00:38:30,770 --> 00:38:37,640
we already assumed but the interesting

641
00:38:34,579 --> 00:38:40,540
part was that like other MH card

642
00:38:37,640 --> 00:38:43,609
campaigns we encountered they actually

643
00:38:40,540 --> 00:38:45,980
used exploits from a public exploit

644
00:38:43,609 --> 00:38:49,609
repository repository to attack the the

645
00:38:45,980 --> 00:38:55,329
visitors so they were using not zero

646
00:38:49,609 --> 00:38:58,250
days but rather no recent exploit and

647
00:38:55,329 --> 00:39:04,010
the most interesting fact was that the

648
00:38:58,250 --> 00:39:08,510
server was located in in Romania at this

649
00:39:04,010 --> 00:39:14,480
moment I removed my decane ass head and

650
00:39:08,510 --> 00:39:18,770
put my search hat on we we get in

651
00:39:14,480 --> 00:39:21,710
contact with the Romanian police and we

652
00:39:18,770 --> 00:39:25,730
provided them with all our all our

653
00:39:21,710 --> 00:39:28,099
findings and they perform the takedown

654
00:39:25,730 --> 00:39:32,030
for the for the command and control

655
00:39:28,099 --> 00:39:34,849
server and we are currently

656
00:39:32,030 --> 00:39:39,400
investigating and it will be concluded

657
00:39:34,849 --> 00:39:41,869
in in a report this was my presentation

658
00:39:39,400 --> 00:39:45,250
thank you very much for being here I

659
00:39:41,869 --> 00:39:45,250
hope I didn't bore you very hard

660
00:39:47,440 --> 00:39:51,960
[Applause]

661
00:39:49,700 --> 00:40:04,980
and I don't know if you have any

662
00:39:51,960 --> 00:40:07,940
questions or you mentioned something

663
00:40:04,980 --> 00:40:09,420
about the sandbox in the earlier

664
00:40:07,940 --> 00:40:12,420
presentation

665
00:40:09,420 --> 00:40:16,200
I was curious the sandbox honeypot right

666
00:40:12,420 --> 00:40:19,620
yeah so do you emulate any specific

667
00:40:16,200 --> 00:40:22,339
browser in that sandbox or multiple

668
00:40:19,620 --> 00:40:25,859
browsers I try to I try to emulate

669
00:40:22,340 --> 00:40:29,280
Internet Explorer Firefox and Chrome in

670
00:40:25,860 --> 00:40:34,370
this order I never emulate links or

671
00:40:29,280 --> 00:40:37,710
something from text not window because

672
00:40:34,370 --> 00:40:39,509
in the context of any only only certain

673
00:40:37,710 --> 00:40:40,830
types of browsers can be exploited with

674
00:40:39,510 --> 00:40:44,310
different types of exploits right I'm

675
00:40:40,830 --> 00:40:48,450
using Internet Explorer 7 and Internet

676
00:40:44,310 --> 00:40:50,640
Explorer 8 not very old but not very

677
00:40:48,450 --> 00:40:53,669
recent either and just to follow up

678
00:40:50,640 --> 00:40:55,830
sorry justjust as far and do they treat

679
00:40:53,670 --> 00:41:00,270
her like just browser exploit or also

680
00:40:55,830 --> 00:41:04,230
PDF Java and if they are through the web

681
00:41:00,270 --> 00:41:06,360
they also go through so it's just like

682
00:41:04,230 --> 00:41:13,920
PDF exploits job yeah yeah yeah yeah

683
00:41:06,360 --> 00:41:16,560
yeah yeah yeah thank you thank you hello

684
00:41:13,920 --> 00:41:18,660
how are you in your opinion the best

685
00:41:16,560 --> 00:41:21,270
method or the good methods to protect

686
00:41:18,660 --> 00:41:28,589
against this type of attacks or to

687
00:41:21,270 --> 00:41:32,750
mitigate risk maybe the best method is

688
00:41:28,590 --> 00:41:35,610
to be able to parse the the page and

689
00:41:32,750 --> 00:41:38,850
understand that there is a malware or

690
00:41:35,610 --> 00:41:41,040
not unfortunately except the canals I

691
00:41:38,850 --> 00:41:45,240
don't know of any other public solutions

692
00:41:41,040 --> 00:41:49,259
that does this all similar projects are

693
00:41:45,240 --> 00:41:53,339
used internally by you Google Facebook

694
00:41:49,260 --> 00:41:56,190
possibly or Kaspersky to further their

695
00:41:53,340 --> 00:41:59,090
own analysis but they don't give this as

696
00:41:56,190 --> 00:42:01,590
a service to the to the public because

697
00:41:59,090 --> 00:42:03,060
most of the times you find the 0 days

698
00:42:01,590 --> 00:42:06,000
and the

699
00:42:03,060 --> 00:42:09,630
zero days are very juicy information

700
00:42:06,000 --> 00:42:13,550
then they are deemed too important to be

701
00:42:09,630 --> 00:42:16,910
made public until it's not too late

702
00:42:13,550 --> 00:42:16,910
thank you very much

703
00:42:28,400 --> 00:42:33,180
like a browser plugin is it a client app

704
00:42:31,290 --> 00:42:35,340
that we installed on or do you have to

705
00:42:33,180 --> 00:42:37,919
input on URL and then get the report

706
00:42:35,340 --> 00:42:40,170
like any any sandbox because and I'm

707
00:42:37,920 --> 00:42:42,660
asking this because you said like one of

708
00:42:40,170 --> 00:42:43,920
our customers visited a website in this

709
00:42:42,660 --> 00:42:46,470
triggered something

710
00:42:43,920 --> 00:42:50,310
is it an on premise well filtering

711
00:42:46,470 --> 00:42:53,040
solution yeah I have a few a few

712
00:42:50,310 --> 00:42:57,600
approaches one of them and the easiest

713
00:42:53,040 --> 00:43:01,250
is to list your websites in in the can s

714
00:42:57,600 --> 00:43:04,950
and tell that can have to perform either

715
00:43:01,250 --> 00:43:08,460
weekly daily or monthly scans on the on

716
00:43:04,950 --> 00:43:12,240
the websites I also have a few products

717
00:43:08,460 --> 00:43:14,190
who integrate the chaos engine so that

718
00:43:12,240 --> 00:43:17,910
you don't have to type the the websites

719
00:43:14,190 --> 00:43:20,760
manually but when you browse a certain

720
00:43:17,910 --> 00:43:24,930
website it gets analyzed by you by the

721
00:43:20,760 --> 00:43:28,520
chaos on the fly this is a virtual

722
00:43:24,930 --> 00:43:28,520
appliance but also hardware appliers

723
00:43:30,530 --> 00:43:37,770
multiple icing for example it's not it

724
00:43:34,800 --> 00:43:40,650
makes it makes it hard to know a

725
00:43:37,770 --> 00:43:44,070
particular website I'm going to visit

726
00:43:40,650 --> 00:43:46,290
right and enticing and through supply

727
00:43:44,070 --> 00:43:48,720
chain attacks or third-party script

728
00:43:46,290 --> 00:43:52,080
attacks right if I use an analytic

729
00:43:48,720 --> 00:43:53,939
service as a website owner service and

730
00:43:52,080 --> 00:43:56,100
that analytic service gets compromised

731
00:43:53,940 --> 00:44:00,260
and they inject into my website that way

732
00:43:56,100 --> 00:44:03,330
I mean as a visitor I have no idea what

733
00:44:00,260 --> 00:44:05,520
that's any of them put get some

734
00:44:03,330 --> 00:44:07,549
malicious advertisement or an injected

735
00:44:05,520 --> 00:44:15,300
script

736
00:44:07,550 --> 00:44:16,150
well the to follow all the Java scripts

737
00:44:15,300 --> 00:44:20,319
in the

738
00:44:16,150 --> 00:44:24,510
all the remotely included resources and

739
00:44:20,319 --> 00:44:27,819
when we present the report we we showed

740
00:44:24,510 --> 00:44:30,220
the script that we suspect is is

741
00:44:27,819 --> 00:44:34,720
malicious also the remote resource when

742
00:44:30,220 --> 00:44:37,480
where from where this JavaScript was was

743
00:44:34,720 --> 00:44:39,689
included and also the page in the web

744
00:44:37,480 --> 00:44:43,480
site that you visited where this

745
00:44:39,690 --> 00:44:49,660
JavaScript was what included thank you

746
00:44:43,480 --> 00:44:51,910
very much this is the first time for me

747
00:44:49,660 --> 00:44:54,490
hearing about this type of attack so you

748
00:44:51,910 --> 00:44:56,649
say the Kenya's is not a private tool so

749
00:44:54,490 --> 00:45:00,788
is it available for your everyday person

750
00:44:56,650 --> 00:45:02,829
yeah it's the canal calm okay and iOS

751
00:45:00,789 --> 00:45:05,920
came into discussion multiple times

752
00:45:02,829 --> 00:45:10,539
would you say they have more flows than

753
00:45:05,920 --> 00:45:12,700
for example Android or no no no no both

754
00:45:10,539 --> 00:45:16,660
iOS and Android are just as vulnerable

755
00:45:12,700 --> 00:45:19,538
the only difference is that Android

756
00:45:16,660 --> 00:45:22,720
being sort of open source because it's

757
00:45:19,539 --> 00:45:26,859
not fully open source it's under much

758
00:45:22,720 --> 00:45:27,910
more scrutiny usually people who find

759
00:45:26,859 --> 00:45:32,710
the z-rotation

760
00:45:27,910 --> 00:45:37,649
iPhones rather have them sold to

761
00:45:32,710 --> 00:45:41,170
different companies who are interested

762
00:45:37,650 --> 00:45:43,920
the price for a full exploitation chain

763
00:45:41,170 --> 00:45:47,170
on iris for instance can reach up to

764
00:45:43,920 --> 00:45:50,109
four million dollars and you know you

765
00:45:47,170 --> 00:45:50,920
can imagine people would rather keep

766
00:45:50,109 --> 00:45:55,299
this private

767
00:45:50,920 --> 00:46:01,000
then then make it public but in the past

768
00:45:55,299 --> 00:46:04,680
years there were no no to none

769
00:46:01,000 --> 00:46:07,480
III OS zero day vulnerabilities

770
00:46:04,680 --> 00:46:10,839
exploited in the wild and there were

771
00:46:07,480 --> 00:46:13,420
very very few I Oh s vulnerabilities

772
00:46:10,839 --> 00:46:15,940
that were patched and identified by

773
00:46:13,420 --> 00:46:18,240
security teams okay thank you thank you

774
00:46:15,940 --> 00:46:18,240
very much

775
00:46:24,539 --> 00:46:37,799
can create an exploit that specifically

776
00:46:27,900 --> 00:46:41,009
bypass the key knows that malware or an

777
00:46:37,799 --> 00:46:44,249
exploit to be an exploit has to have

778
00:46:41,009 --> 00:46:46,529
certain features for instance in case of

779
00:46:44,249 --> 00:46:51,558
Java exploits you have to perform some

780
00:46:46,529 --> 00:46:54,569
sort of keep spraying there are certain

781
00:46:51,559 --> 00:46:57,959
feature I cannot get in very much detail

782
00:46:54,569 --> 00:47:01,739
in this because trade secrets but there

783
00:46:57,959 --> 00:47:03,779
are certain features that make malware

784
00:47:01,739 --> 00:47:07,589
or an exploit to be a model or an

785
00:47:03,779 --> 00:47:11,669
exploit and we identified the at least

786
00:47:07,589 --> 00:47:14,699
some of those features and we we monitor

787
00:47:11,669 --> 00:47:18,989
for those features that's why we don't

788
00:47:14,699 --> 00:47:21,179
have very very much false negatives we

789
00:47:18,989 --> 00:47:25,709
have almost non zero for negative

790
00:47:21,179 --> 00:47:28,439
because basically amar where this type

791
00:47:25,709 --> 00:47:31,379
of malware has to first of all redirect

792
00:47:28,439 --> 00:47:34,049
the the user has to fingerprint the user

793
00:47:31,380 --> 00:47:36,979
so they know which are we they are

794
00:47:34,049 --> 00:47:41,130
taking they need to perform some sort of

795
00:47:36,979 --> 00:47:45,439
code of obfuscation to conceal their

796
00:47:41,130 --> 00:47:48,959
intentions by against anti viruses etc

797
00:47:45,439 --> 00:47:51,390
and some other things all these things

798
00:47:48,959 --> 00:47:55,078
combined give us the information that

799
00:47:51,390 --> 00:47:58,098
that malware is that JavaScript is a

800
00:47:55,079 --> 00:48:01,380
marker this is why I said earlier that

801
00:47:58,099 --> 00:48:05,219
some of the false positives I had came

802
00:48:01,380 --> 00:48:07,949
from the fact that some legitimate code

803
00:48:05,219 --> 00:48:11,369
developers use the malware techniques

804
00:48:07,949 --> 00:48:14,250
for their for their java scripts they

805
00:48:11,369 --> 00:48:15,589
didn't drop anything they were not

806
00:48:14,250 --> 00:48:18,569
[Music]

807
00:48:15,589 --> 00:48:19,229
actual implants resurrecting to are no

808
00:48:18,569 --> 00:48:22,979
resources

809
00:48:19,229 --> 00:48:27,178
it was everything cool and this is how

810
00:48:22,979 --> 00:48:34,100
they decided to implement okay thank you

811
00:48:27,179 --> 00:48:36,920
thank you very much the idea

812
00:48:34,100 --> 00:48:38,839
attacks not to go into the network and

813
00:48:36,920 --> 00:48:42,260
start pulling data through the network

814
00:48:38,840 --> 00:48:44,180
correct yeah yeah in the event that you

815
00:48:42,260 --> 00:48:47,300
don't have administrative permissions on

816
00:48:44,180 --> 00:48:49,669
that specific computer it is reliant on

817
00:48:47,300 --> 00:48:54,890
the user who logs in for their data to

818
00:48:49,670 --> 00:48:58,880
be transmitted out with the users

819
00:48:54,890 --> 00:49:01,700
personal devices the personal device is

820
00:48:58,880 --> 00:49:05,140
much less secure than work computer

821
00:49:01,700 --> 00:49:08,689
but people reuse passwords people

822
00:49:05,140 --> 00:49:11,830
sometimes use their personal devices to

823
00:49:08,690 --> 00:49:15,850
join the corporate network or sometimes

824
00:49:11,830 --> 00:49:20,200
they have very lacks security on

825
00:49:15,850 --> 00:49:23,270
corporate devices because they are very

826
00:49:20,200 --> 00:49:27,890
confident in the million-dollars

827
00:49:23,270 --> 00:49:33,520
security products they buy I have seen a

828
00:49:27,890 --> 00:49:36,830
few banks which had like million dollars

829
00:49:33,520 --> 00:49:39,009
security measures in place and they were

830
00:49:36,830 --> 00:49:42,110
still compromised with watering holes

831
00:49:39,010 --> 00:49:44,150
this is only because the fact that the

832
00:49:42,110 --> 00:49:47,930
watering hole is not targeting the

833
00:49:44,150 --> 00:49:53,210
network but rather the human resource so

834
00:49:47,930 --> 00:49:55,850
it's something where their information

835
00:49:53,210 --> 00:49:58,340
will be going out to the attacker not

836
00:49:55,850 --> 00:50:00,920
necessarily coming into the machine no

837
00:49:58,340 --> 00:50:03,290
they actually use an exploit to gain

838
00:50:00,920 --> 00:50:06,560
full full control on the on the machine

839
00:50:03,290 --> 00:50:09,470
it's zero zero clicks zero user

840
00:50:06,560 --> 00:50:11,120
interactivity you basically don't have

841
00:50:09,470 --> 00:50:13,370
to click anything you just browse the

842
00:50:11,120 --> 00:50:19,520
website visit the web site and you are

843
00:50:13,370 --> 00:50:21,850
getting compromised thank you thank you

844
00:50:19,520 --> 00:50:21,850
very much

