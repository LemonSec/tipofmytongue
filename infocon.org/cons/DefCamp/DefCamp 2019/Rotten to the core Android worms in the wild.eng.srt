1
00:00:00,030 --> 00:00:10,799
hello guys I'm Gabby

2
00:00:05,520 --> 00:00:13,049
I'm gonna be talking today about what it

3
00:00:10,800 --> 00:00:18,119
means to have a device that's vulnerable

4
00:00:13,049 --> 00:00:19,050
by design and kind of go into great

5
00:00:18,119 --> 00:00:21,990
minds about that

6
00:00:19,050 --> 00:00:24,330
I'm just gonna do a short intro about

7
00:00:21,990 --> 00:00:28,528
myself and about my brainchild in the

8
00:00:24,330 --> 00:00:31,470
latest year for those of you who don't

9
00:00:28,529 --> 00:00:34,019
know me some people call me the Polish

10
00:00:31,470 --> 00:00:37,260
Transportation hacker that's because at

11
00:00:34,020 --> 00:00:42,950
some point in my past I managed to do a

12
00:00:37,260 --> 00:00:45,030
simple me fare hack hard to talk about

13
00:00:42,950 --> 00:00:47,210
black hat I think about the

14
00:00:45,030 --> 00:00:50,600
vulnerability of me fair classic hearts

15
00:00:47,210 --> 00:00:55,260
decided to apply it and did a

16
00:00:50,600 --> 00:00:58,289
responsible disclosure to the sort in

17
00:00:55,260 --> 00:00:59,608
Romania and to the guys that were

18
00:00:58,289 --> 00:01:01,109
responsible for implementing the system

19
00:00:59,609 --> 00:01:04,409
and it turned out to be a really

20
00:01:01,109 --> 00:01:08,070
successful story after that they patched

21
00:01:04,409 --> 00:01:09,689
the system and I found out that I

22
00:01:08,070 --> 00:01:12,889
couldn't get any more free travel

23
00:01:09,689 --> 00:01:15,720
anywhere so I decided to hack my car

24
00:01:12,890 --> 00:01:19,140
unfortunately I wasn't able to make it

25
00:01:15,720 --> 00:01:22,860
run for free just by pouring water into

26
00:01:19,140 --> 00:01:26,369
it I found out though that it knew a lot

27
00:01:22,860 --> 00:01:30,900
more about me then I actually knew about

28
00:01:26,369 --> 00:01:36,119
myself as a human so that turned out to

29
00:01:30,900 --> 00:01:38,009
be a pretty cool stunts while explore

30
00:01:36,119 --> 00:01:42,780
exploring the security field being quite

31
00:01:38,009 --> 00:01:46,140
a newbie I decided to go around and try

32
00:01:42,780 --> 00:01:47,880
to just give back to the community as I

33
00:01:46,140 --> 00:01:52,409
was learning more and more interesting

34
00:01:47,880 --> 00:01:55,439
stuff that's when I decided to just make

35
00:01:52,409 --> 00:01:57,869
the internet more secure and do that

36
00:01:55,439 --> 00:02:02,880
more explicitly explicitly by hunting

37
00:01:57,869 --> 00:02:05,700
for bots in general I mean not everybody

38
00:02:02,880 --> 00:02:09,568
in Romania gets really proud about

39
00:02:05,700 --> 00:02:11,790
making robots you know that's when I

40
00:02:09,568 --> 00:02:15,480
hired I got heard that white ops

41
00:02:11,790 --> 00:02:20,730
and we decided to go full-throttle into

42
00:02:15,480 --> 00:02:23,548
our both hunting ordeal and the easiest

43
00:02:20,730 --> 00:02:26,099
way to do that because both don't really

44
00:02:23,549 --> 00:02:29,190
get the chance to profile their target

45
00:02:26,099 --> 00:02:31,920
would be just to sprinkle around honey

46
00:02:29,190 --> 00:02:35,670
pots in various places around the

47
00:02:31,920 --> 00:02:39,899
internet and just hope that they launch

48
00:02:35,670 --> 00:02:44,220
their payloads to you as well as their

49
00:02:39,900 --> 00:02:48,390
vulnerable victims and I mean I needed

50
00:02:44,220 --> 00:02:54,030
to hunt for a platform that had readily

51
00:02:48,390 --> 00:02:56,638
available devices that would allow that

52
00:02:54,030 --> 00:02:59,579
would run an operating system on

53
00:02:56,639 --> 00:03:03,000
anything so even if your you have like

54
00:02:59,579 --> 00:03:06,329
15 and 12 megabytes of RAM or something

55
00:03:03,000 --> 00:03:07,829
like that or two gigabytes of RAM you

56
00:03:06,329 --> 00:03:10,560
would be able to run that operating

57
00:03:07,829 --> 00:03:13,170
system and that operating system turned

58
00:03:10,560 --> 00:03:17,669
out to be one that's deployed on Smart

59
00:03:13,170 --> 00:03:20,910
TVs smart fridges smart toasters smart

60
00:03:17,669 --> 00:03:26,099
cars and even smarter toasters let's

61
00:03:20,910 --> 00:03:29,760
hope that we won't get there and it's

62
00:03:26,099 --> 00:03:32,190
called Android we have more and more and

63
00:03:29,760 --> 00:03:35,220
more Android devices that are being used

64
00:03:32,190 --> 00:03:39,599
in ways that Android shouldn't be used I

65
00:03:35,220 --> 00:03:44,910
guess and two years ago Kevin bomber

66
00:03:39,599 --> 00:03:48,839
made a really cool story about how a lot

67
00:03:44,910 --> 00:03:51,840
of these devices had a certain port open

68
00:03:48,840 --> 00:03:55,409
on the Internet now who around here is

69
00:03:51,840 --> 00:03:58,409
an Android developer or at least

70
00:03:55,409 --> 00:04:04,290
compiled some Android code at some point

71
00:03:58,409 --> 00:04:10,680
in their life okay who uses Android all

72
00:04:04,290 --> 00:04:16,279
right represent so the trouble is that

73
00:04:10,680 --> 00:04:20,400
Android has a certain port that can be

74
00:04:16,279 --> 00:04:21,208
exposed by just running a simple command

75
00:04:20,399 --> 00:04:23,880
via USB

76
00:04:21,209 --> 00:04:25,909
it has authentication initially when you

77
00:04:23,880 --> 00:04:30,259
launch it via

78
00:04:25,909 --> 00:04:32,490
but that's when things get really messy

79
00:04:30,259 --> 00:04:35,849
so I just started working around

80
00:04:32,490 --> 00:04:38,939
tinkering trying to get the creative

81
00:04:35,849 --> 00:04:41,069
juices flowing I wanted to build a

82
00:04:38,939 --> 00:04:48,300
simple honeypot that would allow me to

83
00:04:41,069 --> 00:04:50,759
connect the device to emulate pushing

84
00:04:48,300 --> 00:04:53,430
binaries to the device so an attacker

85
00:04:50,759 --> 00:04:56,819
would be able to send his payload to me

86
00:04:53,430 --> 00:05:00,180
and me to be able to analyze the set

87
00:04:56,819 --> 00:05:02,340
payload just in order to do some simple

88
00:05:00,180 --> 00:05:05,069
reversing and stuff like that and most

89
00:05:02,340 --> 00:05:07,318
importantly to get any shell commands

90
00:05:05,069 --> 00:05:09,689
being sent my way because this is the

91
00:05:07,319 --> 00:05:15,689
main attack vector that we see nowadays

92
00:05:09,689 --> 00:05:17,909
you just have for example I don't know

93
00:05:15,689 --> 00:05:20,909
but there were a bunch of botanist that

94
00:05:17,909 --> 00:05:23,400
you just connect to any SSH enable

95
00:05:20,909 --> 00:05:26,310
device with default credentials and just

96
00:05:23,400 --> 00:05:28,830
spray commands and just have its way

97
00:05:26,310 --> 00:05:32,550
after that because it just had admin

98
00:05:28,830 --> 00:05:34,770
access there's a lot of documentation I

99
00:05:32,550 --> 00:05:40,639
won't go into any more detail about that

100
00:05:34,770 --> 00:05:45,359
the problem is that most of it is not

101
00:05:40,639 --> 00:05:49,610
up-to-date adb was initially designed as

102
00:05:45,360 --> 00:05:52,319
a simple protocol to just multiplex

103
00:05:49,610 --> 00:05:55,259
streams so you would be able to open a

104
00:05:52,319 --> 00:05:58,409
shell stream and send commands and you

105
00:05:55,259 --> 00:06:00,479
would be able to do more and more to

106
00:05:58,409 --> 00:06:02,400
connect more devices and they did more

107
00:06:00,479 --> 00:06:04,710
streams and they they want it will also

108
00:06:02,400 --> 00:06:08,159
be able to push files so that it they

109
00:06:04,710 --> 00:06:10,859
just bolted on more stuff onto it and it

110
00:06:08,159 --> 00:06:13,919
got to a certain point where you can't

111
00:06:10,860 --> 00:06:19,139
get really solid documentation about

112
00:06:13,919 --> 00:06:21,120
that it has a few interesting details I

113
00:06:19,139 --> 00:06:23,580
can find the Internet initially you can

114
00:06:21,120 --> 00:06:24,960
just send a command you'd have two

115
00:06:23,580 --> 00:06:28,289
arguments to the command that you can

116
00:06:24,960 --> 00:06:30,060
use some extra staff stuff that you

117
00:06:28,289 --> 00:06:33,120
would that would be used to check the

118
00:06:30,060 --> 00:06:34,680
value integrity of the packet the

119
00:06:33,120 --> 00:06:37,039
commands would be really simple to

120
00:06:34,680 --> 00:06:38,410
interpret we've got a sink connect

121
00:06:37,039 --> 00:06:41,620
authenticate

122
00:06:38,410 --> 00:06:48,640
open okay close right anyway boring

123
00:06:41,620 --> 00:06:50,920
stuff I mean and there was a bit of

124
00:06:48,640 --> 00:06:54,610
different research done by my previous

125
00:06:50,920 --> 00:06:56,860
peers behind before basically if you

126
00:06:54,610 --> 00:07:03,330
want to open like a shell stream to your

127
00:06:56,860 --> 00:07:06,610
device you just have to do send an open

128
00:07:03,330 --> 00:07:09,430
you would get an okay and then you'd get

129
00:07:06,610 --> 00:07:13,240
a ripe with the results of that command

130
00:07:09,430 --> 00:07:15,010
so initially it was pretty simple and I

131
00:07:13,240 --> 00:07:16,680
said oh yeah I can definitely do that

132
00:07:15,010 --> 00:07:22,270
let's give it a shot

133
00:07:16,680 --> 00:07:24,130
and it didn't work I mean that's all my

134
00:07:22,270 --> 00:07:26,979
cat she's awesome

135
00:07:24,130 --> 00:07:29,440
she's part of the reason I'm here

136
00:07:26,980 --> 00:07:31,210
nowadays because I wouldn't be able to

137
00:07:29,440 --> 00:07:34,060
just reverse engineer the protocol

138
00:07:31,210 --> 00:07:37,599
without the friend the help from her and

139
00:07:34,060 --> 00:07:39,910
my girlfriend as well who just supported

140
00:07:37,600 --> 00:07:42,340
me in these endless nights of just

141
00:07:39,910 --> 00:07:44,200
bashing around and just brute forcing my

142
00:07:42,340 --> 00:07:45,900
way around that so let's give them a

143
00:07:44,200 --> 00:07:52,690
round of applause please

144
00:07:45,900 --> 00:07:57,000
all right and that's when things got

145
00:07:52,690 --> 00:07:59,230
really nasty it wasn't a simple CRC

146
00:07:57,000 --> 00:08:00,970
fortunately I found some guys that are

147
00:07:59,230 --> 00:08:04,960
way smarter than me and if worse

148
00:08:00,970 --> 00:08:07,180
engineer that there's also some data

149
00:08:04,960 --> 00:08:09,340
packet that gets appended to the end of

150
00:08:07,180 --> 00:08:14,470
the packet and I found out that that was

151
00:08:09,340 --> 00:08:17,739
a industry standard no matter how hard

152
00:08:14,470 --> 00:08:21,670
that would be to document I don't know

153
00:08:17,740 --> 00:08:24,010
why that happened it's just by design as

154
00:08:21,670 --> 00:08:26,700
I've said I guess I did bet ten pounds

155
00:08:24,010 --> 00:08:29,200
of the Queen's finest that just a

156
00:08:26,700 --> 00:08:31,719
project manager came in one day hey guys

157
00:08:29,200 --> 00:08:34,419
we really really really really really

158
00:08:31,720 --> 00:08:36,550
need to get this feature working so

159
00:08:34,419 --> 00:08:38,199
let's get to work and of course you know

160
00:08:36,549 --> 00:08:39,909
what the first thing that you sacrifice

161
00:08:38,200 --> 00:08:42,340
when you're out of time and money is

162
00:08:39,909 --> 00:08:47,439
security so yeah you've got the aliens

163
00:08:42,340 --> 00:08:50,700
back loading us these is the same

164
00:08:47,440 --> 00:08:56,760
command being sent

165
00:08:50,700 --> 00:08:58,890
three times notice the differences it's

166
00:08:56,760 --> 00:09:01,280
literally the same command the same

167
00:08:58,890 --> 00:09:03,990
network connectivity features everything

168
00:09:01,280 --> 00:09:06,180
but I would be getting different

169
00:09:03,990 --> 00:09:07,440
responses every time so initially I

170
00:09:06,180 --> 00:09:09,900
would implement it in certain way

171
00:09:07,440 --> 00:09:12,840
discover that it would work and they oh

172
00:09:09,900 --> 00:09:14,520
yeah I fix it and then the next day it I

173
00:09:12,840 --> 00:09:17,580
would get a totally different network

174
00:09:14,520 --> 00:09:19,740
flow and then I would say oh yeah I'm so

175
00:09:17,580 --> 00:09:21,540
dumb I didn't I

176
00:09:19,740 --> 00:09:23,940
why didn't I do it like this the first

177
00:09:21,540 --> 00:09:26,160
time and I would implement it using the

178
00:09:23,940 --> 00:09:29,250
second flow but it no longer worked for

179
00:09:26,160 --> 00:09:33,030
the first flow so I would basically just

180
00:09:29,250 --> 00:09:34,620
have to map everything down this is

181
00:09:33,030 --> 00:09:36,660
gonna be I'm not gonna go into plans

182
00:09:34,620 --> 00:09:38,670
about that if you want to do your own

183
00:09:36,660 --> 00:09:40,800
implementation feel free to do it the

184
00:09:38,670 --> 00:09:43,800
this part that list of the slides are

185
00:09:40,800 --> 00:09:45,930
going to be available online after that

186
00:09:43,800 --> 00:09:48,000
you can already find this version of the

187
00:09:45,930 --> 00:09:50,040
slides somewhere on the internet so

188
00:09:48,000 --> 00:09:52,410
don't worry about it you don't have to

189
00:09:50,040 --> 00:09:55,020
take any pictures especially like unless

190
00:09:52,410 --> 00:09:58,610
you have a hallway those go like zoom so

191
00:09:55,020 --> 00:09:58,610
much they're designed for surveillance

192
00:09:59,060 --> 00:10:07,469
so yeah so just map the flows one by one

193
00:10:04,890 --> 00:10:11,960
using a piece of paper and a pen just

194
00:10:07,470 --> 00:10:18,300
like wall times and it still didn't work

195
00:10:11,960 --> 00:10:21,980
it was so weird I had to get a lot of

196
00:10:18,300 --> 00:10:25,170
help from the open-source community into

197
00:10:21,980 --> 00:10:27,930
getting the packet structure nailed down

198
00:10:25,170 --> 00:10:31,880
into just experimenting over and over

199
00:10:27,930 --> 00:10:31,880
wielding various Network topologies and

200
00:10:32,180 --> 00:10:40,620
just brute force it there's no easy

201
00:10:36,540 --> 00:10:44,490
answer there is no shortcut to just hard

202
00:10:40,620 --> 00:10:47,100
work and just mindlessly dwelling into a

203
00:10:44,490 --> 00:10:50,630
rabbit hole in the house that you're

204
00:10:47,100 --> 00:10:53,700
gonna fix it because it's just face that

205
00:10:50,630 --> 00:10:57,810
kill you at the end of the day and it

206
00:10:53,700 --> 00:10:59,190
worked I was able to connect to the

207
00:10:57,810 --> 00:11:01,349
device and all of the stuff that

208
00:10:59,190 --> 00:11:03,600
remember that I set as my goals

209
00:11:01,350 --> 00:11:05,550
initially

210
00:11:03,600 --> 00:11:07,830
and we cannot we'll actually have a live

211
00:11:05,550 --> 00:11:19,800
demo right now to just illustrate the

212
00:11:07,830 --> 00:11:25,110
whole point so you have the honeypot no

213
00:11:19,800 --> 00:11:27,530
you don't have the honeypot and on a

214
00:11:25,110 --> 00:11:27,530
second

215
00:12:04,210 --> 00:12:16,050
there we go so we've got the honeypot

216
00:12:07,810 --> 00:12:24,729
running right now and let's connect with

217
00:12:16,050 --> 00:12:27,160
look at the connection a we can push a

218
00:12:24,730 --> 00:12:30,310
file and we have it right here

219
00:12:27,160 --> 00:12:32,620
just hatched everything there was a lot

220
00:12:30,310 --> 00:12:35,079
of work being done by third party by lot

221
00:12:32,620 --> 00:12:37,779
by some other researchers that were so

222
00:12:35,080 --> 00:12:40,600
kind to me - just fix a lot of the bugs

223
00:12:37,779 --> 00:12:42,939
that I introduced and give it docker

224
00:12:40,600 --> 00:12:45,670
support Python free support and all that

225
00:12:42,940 --> 00:12:48,279
so kudos to them thank you guys

226
00:12:45,670 --> 00:12:50,110
you've been really kind let's keep it

227
00:12:48,279 --> 00:12:52,120
going and just let's just make the

228
00:12:50,110 --> 00:12:54,130
internet a safer place and what's really

229
00:12:52,120 --> 00:13:00,310
cool is that you can actually do any

230
00:12:54,130 --> 00:13:02,529
kind of shell command and the shell

231
00:13:00,310 --> 00:13:05,589
command is right here BAM it's been

232
00:13:02,529 --> 00:13:08,290
caught successfully so now I have a

233
00:13:05,589 --> 00:13:13,510
fahadh what do we do with it

234
00:13:08,290 --> 00:13:14,650
well we catch malware and this is going

235
00:13:13,510 --> 00:13:17,020
to be the second part of the

236
00:13:14,650 --> 00:13:20,410
presentation which will go in through

237
00:13:17,020 --> 00:13:22,779
into all of the strains of malware that

238
00:13:20,410 --> 00:13:27,130
I have discovered over the last past

239
00:13:22,779 --> 00:13:30,070
year and the first one that killed my

240
00:13:27,130 --> 00:13:34,779
honey pot in short it was a good

241
00:13:30,070 --> 00:13:39,640
Samaritan that would just kill all of

242
00:13:34,779 --> 00:13:40,470
the other BOTS and hopefully leave it

243
00:13:39,640 --> 00:13:44,949
like that

244
00:13:40,470 --> 00:13:47,500
except it didn't it would also push its

245
00:13:44,950 --> 00:13:51,610
own apk that would start mining on your

246
00:13:47,500 --> 00:13:53,500
own device so you know she was just

247
00:13:51,610 --> 00:13:57,209
basically undercutting his competition

248
00:13:53,500 --> 00:13:59,500
trying to get more CPU cycles going now

249
00:13:57,209 --> 00:14:01,989
this guy was a visionary who was the

250
00:13:59,500 --> 00:14:04,089
first one to actually do this kind of

251
00:14:01,990 --> 00:14:08,500
stuff on ADB just kill off the

252
00:14:04,089 --> 00:14:10,000
competition try to run now to more

253
00:14:08,500 --> 00:14:12,820
emerging threats were really cool

254
00:14:10,000 --> 00:14:15,760
because they actually ended up competing

255
00:14:12,820 --> 00:14:17,379
with each other and there was actually a

256
00:14:15,760 --> 00:14:20,889
story about it and

257
00:14:17,379 --> 00:14:26,949
first one is Trinity Trinity was

258
00:14:20,889 --> 00:14:29,049
composed of a three-part payload the

259
00:14:26,949 --> 00:14:34,868
first part of the payload was just being

260
00:14:29,049 --> 00:14:38,309
sent via adb shell as bootstrapping the

261
00:14:34,869 --> 00:14:43,899
other parts it would sent an apk that

262
00:14:38,309 --> 00:14:47,319
would do mining inside the APK it would

263
00:14:43,899 --> 00:14:50,949
send and after that it would send a

264
00:14:47,319 --> 00:14:52,959
binary that would be do the warming part

265
00:14:50,949 --> 00:14:57,419
so it's basically just a worm that would

266
00:14:52,959 --> 00:15:00,159
propagate around the internet freely and

267
00:14:57,419 --> 00:15:02,949
when is assembling the apk it was done

268
00:15:00,159 --> 00:15:04,869
using GX by the way I definitely

269
00:15:02,949 --> 00:15:07,508
recommend it to some to anybody who

270
00:15:04,869 --> 00:15:09,609
wants to do reverse engineering into

271
00:15:07,509 --> 00:15:13,059
Android it's a really free open-source

272
00:15:09,609 --> 00:15:15,909
tool very cool well maintained and it

273
00:15:13,059 --> 00:15:18,909
gets you readable code so especially if

274
00:15:15,909 --> 00:15:21,669
you've done a bit of Android let's call

275
00:15:18,909 --> 00:15:24,579
it hacking because I'm not a developer

276
00:15:21,669 --> 00:15:26,949
I'm a very bad developer to be honest it

277
00:15:24,579 --> 00:15:28,569
gets you to the point where you don't

278
00:15:26,949 --> 00:15:31,839
read any kind of byte code and you can

279
00:15:28,569 --> 00:15:34,469
read code and if you look at it this

280
00:15:31,839 --> 00:15:37,659
would instantiate the webview it would

281
00:15:34,470 --> 00:15:40,389
in the webview it would loan load an

282
00:15:37,659 --> 00:15:43,019
HTML file and inside the HTML file it

283
00:15:40,389 --> 00:15:45,999
would just parse some coin hive

284
00:15:43,019 --> 00:15:48,519
JavaScript and just call it a day you

285
00:15:45,999 --> 00:15:50,949
know you've got mining but this only

286
00:15:48,519 --> 00:15:54,159
works for one device how do you

287
00:15:50,949 --> 00:15:56,829
propagate to all of the other devices

288
00:15:54,159 --> 00:16:00,819
and that's where when the worm come in

289
00:15:56,829 --> 00:16:04,809
comes in the worm was a binary that run

290
00:16:00,819 --> 00:16:08,349
explicitly on Amazon fire TVs it would

291
00:16:04,809 --> 00:16:11,199
scan over the internet and then check if

292
00:16:08,350 --> 00:16:13,739
it was up like every part of itself the

293
00:16:11,199 --> 00:16:17,649
were mobile part and the mining part and

294
00:16:13,739 --> 00:16:22,539
restart or we push the binary and so on

295
00:16:17,649 --> 00:16:25,899
and so forth so this guy was pretty well

296
00:16:22,539 --> 00:16:29,049
off he would he had a stable botnet

297
00:16:25,899 --> 00:16:30,310
running I think it had like a 10%

298
00:16:29,049 --> 00:16:37,899
infection rate

299
00:16:30,310 --> 00:16:39,849
out of a 550 thousand devices pull so

300
00:16:37,899 --> 00:16:41,680
like five thousand devices just running

301
00:16:39,850 --> 00:16:44,370
for him just mining for him at some

302
00:16:41,680 --> 00:16:49,120
point some really easy cashed raking

303
00:16:44,370 --> 00:16:51,370
until F God came in and F what was a

304
00:16:49,120 --> 00:16:55,360
really cool piece of work

305
00:16:51,370 --> 00:16:57,790
it just started as a shell payload that

306
00:16:55,360 --> 00:17:01,930
would download the second stages and it

307
00:16:57,790 --> 00:17:04,240
actually had a blockchain DNS system

308
00:17:01,930 --> 00:17:06,760
like you know the bad guys are learning

309
00:17:04,240 --> 00:17:08,709
all of the buzzwords soon enough they're

310
00:17:06,760 --> 00:17:14,289
gonna do like machine learning as well

311
00:17:08,709 --> 00:17:16,270
and other stuff and this is part of the

312
00:17:14,289 --> 00:17:19,709
of the second stage of the payload very

313
00:17:16,270 --> 00:17:22,839
to download the binary and of course

314
00:17:19,709 --> 00:17:28,209
uninstall the competition v Trinity by

315
00:17:22,839 --> 00:17:31,178
the way and they actually ended up being

316
00:17:28,209 --> 00:17:34,330
the biggest competitors on the market

317
00:17:31,179 --> 00:17:36,640
and I do not recall the name

318
00:17:34,330 --> 00:17:40,418
unfortunately but somebody did a really

319
00:17:36,640 --> 00:17:43,200
cool job on just documenting this

320
00:17:40,419 --> 00:17:46,059
constant shift of power between the two

321
00:17:43,200 --> 00:17:51,070
but the two botanist fighting with each

322
00:17:46,059 --> 00:17:52,990
other now there are also some small-time

323
00:17:51,070 --> 00:17:56,908
guys that I've only seen just a couple

324
00:17:52,990 --> 00:18:00,520
of times this guy was really interesting

325
00:17:56,909 --> 00:18:02,230
he I guess he just finished some kind of

326
00:18:00,520 --> 00:18:04,780
tutorial on the internet about how you

327
00:18:02,230 --> 00:18:07,899
can encode payloads and he he figured

328
00:18:04,780 --> 00:18:10,030
out oh yeah we can do this except you

329
00:18:07,899 --> 00:18:11,918
can't because ADB is very bad and

330
00:18:10,030 --> 00:18:14,530
sometimes you'd end up with the

331
00:18:11,919 --> 00:18:18,990
instructions getting out of order and

332
00:18:14,530 --> 00:18:23,260
just screw up the payload basically

333
00:18:18,990 --> 00:18:28,780
you've also got or not this guy put in

334
00:18:23,260 --> 00:18:30,850
helper I can't I don't know if you guys

335
00:18:28,780 --> 00:18:32,080
can read but it actually ran that it's a

336
00:18:30,850 --> 00:18:35,020
DVR

337
00:18:32,080 --> 00:18:37,480
it's a botnet that was exploiting the VR

338
00:18:35,020 --> 00:18:41,559
devices it was called put in helper by

339
00:18:37,480 --> 00:18:44,200
some reason I don't know that would also

340
00:18:41,559 --> 00:18:48,879
do mining because this seems to be the

341
00:18:44,200 --> 00:18:54,070
goldmine of the malware guys are

342
00:18:48,879 --> 00:18:57,248
exploiting nowadays and the last one and

343
00:18:54,070 --> 00:18:59,799
the funniest one and was found by a

344
00:18:57,249 --> 00:19:06,009
really good friend of mine Stefan and I

345
00:18:59,799 --> 00:19:09,730
say he actually apologizes for mining on

346
00:19:06,009 --> 00:19:11,950
the device I mean let's not feel sorry

347
00:19:09,730 --> 00:19:13,960
for him but it's so hard though for

348
00:19:11,950 --> 00:19:15,850
whoever can read that I'm sorry but I'm

349
00:19:13,960 --> 00:19:19,779
mining on your device not because I want

350
00:19:15,850 --> 00:19:22,988
but because I need the cash I'm truly

351
00:19:19,779 --> 00:19:25,899
sorry but currently I can't find or get

352
00:19:22,989 --> 00:19:28,299
any jobs I have to resort to my black

353
00:19:25,899 --> 00:19:32,258
hat way in order to survive so she

354
00:19:28,299 --> 00:19:34,989
actually get asked for a position and he

355
00:19:32,259 --> 00:19:38,159
can provide you as a CV and you'll end

356
00:19:34,989 --> 00:19:41,259
up in a quite an exclusive club where

357
00:19:38,159 --> 00:19:44,679
you get to be whitelisted and she'll no

358
00:19:41,259 --> 00:19:46,899
longer be mining on your device so yeah

359
00:19:44,679 --> 00:19:49,539
I'm funny for him I mean it sucks to be

360
00:19:46,899 --> 00:19:51,809
him but you know you have no excuse in

361
00:19:49,539 --> 00:19:55,749
doing this kind of stuff you know and

362
00:19:51,809 --> 00:19:59,499
now the really really really really bad

363
00:19:55,749 --> 00:20:02,590
part of this whole story comes in I'm

364
00:19:59,499 --> 00:20:06,999
gonna please ask you not to take photos

365
00:20:02,590 --> 00:20:10,209
of any IPS or any real humans that are

366
00:20:06,999 --> 00:20:15,989
gonna be shown in this in the next

367
00:20:10,210 --> 00:20:22,769
slides because most of them were IPS

368
00:20:15,989 --> 00:20:28,299
from South Korea Taiwan and Hong Kong

369
00:20:22,769 --> 00:20:31,600
China's neighbors you know and they seem

370
00:20:28,299 --> 00:20:34,269
to be like actual people no TVs no

371
00:20:31,600 --> 00:20:37,719
nothing just found that at some point

372
00:20:34,269 --> 00:20:45,669
were compromised and somebody was just

373
00:20:37,720 --> 00:20:48,309
watching over them this is a huge list

374
00:20:45,669 --> 00:20:50,590
the list goes on over and over and over

375
00:20:48,309 --> 00:20:52,749
again about the versions that are

376
00:20:50,590 --> 00:20:56,369
available for exploitation over there

377
00:20:52,749 --> 00:20:58,179
and I would get into this huge debate

378
00:20:56,369 --> 00:21:00,970
when I would show

379
00:20:58,179 --> 00:21:01,299
this lies in other conferences about the

380
00:21:00,970 --> 00:21:03,009
fact

381
00:21:01,299 --> 00:21:06,340
oh no man you can if you connect your

382
00:21:03,009 --> 00:21:09,070
USB cable it asks you for a

383
00:21:06,340 --> 00:21:12,699
sterilization and I guess it's the same

384
00:21:09,070 --> 00:21:14,980
if you do adb tcp/ip no it's not this is

385
00:21:12,700 --> 00:21:17,429
like you've got even Android 9 that's

386
00:21:14,980 --> 00:21:20,950
being exploited out in the wild and

387
00:21:17,429 --> 00:21:23,799
there is no authorization whatsoever

388
00:21:20,950 --> 00:21:26,889
when it comes to doing adb tcp/ip

389
00:21:23,799 --> 00:21:28,090
connections to a device so this is out

390
00:21:26,889 --> 00:21:32,039
there it's in the world

391
00:21:28,090 --> 00:21:34,990
anybody can exploit them please don't

392
00:21:32,039 --> 00:21:39,610
because you end up with really serious

393
00:21:34,990 --> 00:21:42,639
consequences and I let's say that I had

394
00:21:39,610 --> 00:21:47,168
some sources that were able to do a bit

395
00:21:42,639 --> 00:21:49,418
of recon and you can easily connect you

396
00:21:47,169 --> 00:21:54,399
would find all of the bad guys that I'm

397
00:21:49,419 --> 00:22:01,450
telling you about Trinity some random

398
00:21:54,399 --> 00:22:06,969
miner the eff bought stuff Android 6 so

399
00:22:01,450 --> 00:22:09,879
it's or 5.2 I can't recall and I some

400
00:22:06,970 --> 00:22:13,149
add some other device that had Android 7

401
00:22:09,879 --> 00:22:16,059
so this is being exploited in the wild

402
00:22:13,149 --> 00:22:17,289
and people are building botanists of it

403
00:22:16,059 --> 00:22:23,649
as we speak

404
00:22:17,289 --> 00:22:27,029
in the wild and from now then we're

405
00:22:23,649 --> 00:22:31,498
gonna see some pictures of real humans

406
00:22:27,029 --> 00:22:34,769
so no pictures that include view that

407
00:22:31,499 --> 00:22:34,769
thank you

408
00:22:35,100 --> 00:22:48,309
so let's go this is a guy from the air

409
00:22:42,909 --> 00:22:51,429
force system in Taiwan that had live TV

410
00:22:48,309 --> 00:22:53,619
with an exposed interface I can imagine

411
00:22:51,429 --> 00:22:55,389
a five-star general five-star general

412
00:22:53,619 --> 00:22:59,619
just watching his porn over there and

413
00:22:55,389 --> 00:23:04,019
some other guy spying on him fortunately

414
00:22:59,619 --> 00:23:07,509
in Russia they got it nailed down oh

415
00:23:04,019 --> 00:23:09,669
 Skynet is learning a lot of new

416
00:23:07,509 --> 00:23:11,720
stuff we don't want it to run in Russia

417
00:23:09,669 --> 00:23:14,390
so let's see

418
00:23:11,720 --> 00:23:16,220
and we add white ops

419
00:23:14,390 --> 00:23:20,450
usually play a certain game called but

420
00:23:16,220 --> 00:23:24,830
or not that we just look at metadata

421
00:23:20,450 --> 00:23:27,110
about certain I don't know interesting

422
00:23:24,830 --> 00:23:29,449
artifacts and try to decide if it's a

423
00:23:27,110 --> 00:23:31,939
bad or if it's a human that is doing

424
00:23:29,450 --> 00:23:34,159
that now I'm gonna do it interactively

425
00:23:31,940 --> 00:23:36,890
with you guys and we're gonna pay the

426
00:23:34,159 --> 00:23:40,820
playback door and just make the world a

427
00:23:36,890 --> 00:23:43,789
safer place so this is what I did I open

428
00:23:40,820 --> 00:23:45,590
source everything and God means in

429
00:23:43,789 --> 00:23:47,570
exchange these are mine these were made

430
00:23:45,590 --> 00:23:52,490
by some really cool Bulgarian guy who

431
00:23:47,570 --> 00:23:55,450
contributed a lot the honeypot the

432
00:23:52,490 --> 00:23:59,240
amount of vulnerable devices dropped

433
00:23:55,450 --> 00:24:03,679
from 50k when I started doing it till

434
00:23:59,240 --> 00:24:06,649
about 10k then two eight seven but

435
00:24:03,679 --> 00:24:12,919
recently it started going back up to

436
00:24:06,649 --> 00:24:15,080
12,000 so I give those engineers somehow

437
00:24:12,919 --> 00:24:20,000
said you know what it's way easier to

438
00:24:15,080 --> 00:24:22,490
just open that part up and automatically

439
00:24:20,000 --> 00:24:27,669
test all of our devices that we ship on

440
00:24:22,490 --> 00:24:30,529
the factory and this kind of reflects in

441
00:24:27,669 --> 00:24:32,360
the stats that I've been getting I don't

442
00:24:30,529 --> 00:24:36,559
know about you guys I'm not that much of

443
00:24:32,360 --> 00:24:38,899
a statistics guy but when the graph is

444
00:24:36,559 --> 00:24:40,789
like this it's not it's boring but when

445
00:24:38,899 --> 00:24:43,820
it's like this it starts getting really

446
00:24:40,789 --> 00:24:46,279
interesting and I started in him down a

447
00:24:43,820 --> 00:24:54,889
bit more and let's see if we can spot

448
00:24:46,279 --> 00:24:58,220
the anomaly somebody was pushing a lot

449
00:24:54,889 --> 00:25:02,539
of uploads and building a botnet just

450
00:24:58,220 --> 00:25:06,649
here somewhere in June and I dug a bit

451
00:25:02,539 --> 00:25:09,320
more into this and I discovered that

452
00:25:06,649 --> 00:25:12,649
after the community pushed back a bit

453
00:25:09,320 --> 00:25:15,200
kinda reap related and he decided to

454
00:25:12,649 --> 00:25:17,408
just use one big data center but he

455
00:25:15,200 --> 00:25:23,809
would just burn from now and then and

456
00:25:17,409 --> 00:25:28,669
just sent shell commands to mine because

457
00:25:23,809 --> 00:25:33,139
this is the nowadays goldmine that

458
00:25:28,669 --> 00:25:34,940
everybody's exploiting and you're doing

459
00:25:33,139 --> 00:25:37,449
exactly the same thing as everybody else

460
00:25:34,940 --> 00:25:40,879
spraying over the Internet

461
00:25:37,450 --> 00:25:43,279
fortunately he got a lot of abuses from

462
00:25:40,879 --> 00:25:46,580
the from other researchers reporting

463
00:25:43,279 --> 00:25:48,919
this and going around hey man that's bad

464
00:25:46,580 --> 00:25:52,340
subduing that you're bad you shouldn't

465
00:25:48,919 --> 00:25:56,960
be doing that and she just she was taken

466
00:25:52,340 --> 00:25:57,639
down very fast very very very fast the

467
00:25:56,960 --> 00:26:02,809
honeypot

468
00:25:57,639 --> 00:26:06,218
got added to the teapot project again by

469
00:26:02,809 --> 00:26:09,049
some really cool dudes

470
00:26:06,219 --> 00:26:11,570
everybody can who runs teapot right now

471
00:26:09,049 --> 00:26:13,908
can get it working really fast you can

472
00:26:11,570 --> 00:26:14,658
even get it right running just by

473
00:26:13,909 --> 00:26:18,409
yourself

474
00:26:14,659 --> 00:26:23,210
by just getting the docker if you're

475
00:26:18,409 --> 00:26:29,109
that kind of guy and pushing it over

476
00:26:23,210 --> 00:26:32,059
there every feature is it just works you

477
00:26:29,109 --> 00:26:35,960
can I'm still pushing more and more

478
00:26:32,059 --> 00:26:37,580
stuff to it just go to my github you're

479
00:26:35,960 --> 00:26:39,589
gonna find it there you're gonna find

480
00:26:37,580 --> 00:26:41,749
all of the documentation there I'm gonna

481
00:26:39,589 --> 00:26:43,309
do the Python 3 integration these days

482
00:26:41,749 --> 00:26:47,200
I've already got the poor requests

483
00:26:43,309 --> 00:26:47,200
checked it everything he's done

484
00:26:47,289 --> 00:26:53,779
I'm validating it as we speak I'm like

485
00:26:50,929 --> 00:26:56,739
95% done I just need to do like one

486
00:26:53,779 --> 00:26:58,789
minor fix but check it out on github and

487
00:26:56,739 --> 00:27:01,129
checking check me on Twitter as well

488
00:26:58,789 --> 00:27:06,739
because that's where I post all of the

489
00:27:01,129 --> 00:27:10,009
cool memes as well and I don't know I

490
00:27:06,739 --> 00:27:12,649
guess looking back at the other slides I

491
00:27:10,009 --> 00:27:16,460
guess it's just our duty as researchers

492
00:27:12,649 --> 00:27:18,949
to do the right thing and push back

493
00:27:16,460 --> 00:27:21,919
whenever we find any kind of threat and

494
00:27:18,950 --> 00:27:27,469
not just whine around that hey man this

495
00:27:21,919 --> 00:27:30,219
is bad so thank you and keep the

496
00:27:27,469 --> 00:27:30,219
internet human

497
00:27:35,950 --> 00:27:53,030
are there any questions keep your hand

498
00:27:41,660 --> 00:27:55,610
up I've seen that some of the devices

499
00:27:53,030 --> 00:28:00,129
that you present and on the slides I'm

500
00:27:55,610 --> 00:28:04,129
mostly located in Asia places are not

501
00:28:00,130 --> 00:28:06,200
common at least in Hong Kongers as far

502
00:28:04,130 --> 00:28:09,020
as I know how many of the devices which

503
00:28:06,200 --> 00:28:13,130
you presented do you expect have passed

504
00:28:09,020 --> 00:28:16,160
the Google CTS the Google for the

505
00:28:13,130 --> 00:28:20,660
compatibility test suite which also has

506
00:28:16,160 --> 00:28:25,760
some security required I think that not

507
00:28:20,660 --> 00:28:28,340
a lot of them that whole part of the

508
00:28:25,760 --> 00:28:31,300
world is just one special snowflake

509
00:28:28,340 --> 00:28:35,899
that's kind of more like the Wild West

510
00:28:31,300 --> 00:28:39,020
so I don't think that there had any kind

511
00:28:35,900 --> 00:28:42,230
of intersection when any with everything

512
00:28:39,020 --> 00:28:43,970
anything that Google represents so yeah

513
00:28:42,230 --> 00:28:46,940
I would give that the compatibility test

514
00:28:43,970 --> 00:28:49,220
would go really well what I can say is

515
00:28:46,940 --> 00:28:54,050
that there are a lot of older devices

516
00:28:49,220 --> 00:28:56,180
that have all of the hackers best tools

517
00:28:54,050 --> 00:28:57,500
we've got nethack you've got double you

518
00:28:56,180 --> 00:28:59,840
get you've got curl you've got

519
00:28:57,500 --> 00:29:02,980
everything pre-installed on them I guess

520
00:28:59,840 --> 00:29:05,870
for testing purposes and they just

521
00:29:02,980 --> 00:29:09,320
forget or they manufacturers didn't

522
00:29:05,870 --> 00:29:11,060
bother in removing the staging bill the

523
00:29:09,320 --> 00:29:15,290
test build and just putting a production

524
00:29:11,060 --> 00:29:23,149
build on there more questions on that

525
00:29:15,290 --> 00:29:28,850
side it works ok so at some point you

526
00:29:23,150 --> 00:29:31,880
presented the list of IPs saying here's

527
00:29:28,850 --> 00:29:34,040
their stuns of them I'm thinking they're

528
00:29:31,880 --> 00:29:37,040
still open I guess anybody can find that

529
00:29:34,040 --> 00:29:40,250
out but you said at some point that some

530
00:29:37,040 --> 00:29:41,230
of the malware tried to kill about other

531
00:29:40,250 --> 00:29:43,960
malware

532
00:29:41,230 --> 00:29:46,810
it's already installed I assume they

533
00:29:43,960 --> 00:29:50,680
already have root on that device even if

534
00:29:46,810 --> 00:29:53,050
they get a DB on Oh have you ever met a

535
00:29:50,680 --> 00:29:56,410
malware that tries to fix the issue and

536
00:29:53,050 --> 00:29:58,419
only allow itself well no I haven't seen

537
00:29:56,410 --> 00:29:59,770
any kind of malware that would try to

538
00:29:58,420 --> 00:30:01,750
just fix the issue

539
00:29:59,770 --> 00:30:03,820
mostly because even if you try to fix

540
00:30:01,750 --> 00:30:06,280
the issue you have to shut down ADB and

541
00:30:03,820 --> 00:30:09,850
you can shut down ADB with some kind of

542
00:30:06,280 --> 00:30:11,920
exploit as well and that's a big I mean

543
00:30:09,850 --> 00:30:13,899
it's not that hard most of them are all

544
00:30:11,920 --> 00:30:18,360
the Android devices and there's a lot of

545
00:30:13,900 --> 00:30:21,040
root kids that just work out of the box

546
00:30:18,360 --> 00:30:22,899
but it's a bit more effort than just

547
00:30:21,040 --> 00:30:24,340
going around killing them and closing

548
00:30:22,900 --> 00:30:26,500
the port as you would have with other

549
00:30:24,340 --> 00:30:29,919
botanist for example like Mirai and

550
00:30:26,500 --> 00:30:32,730
stuff like that all right

551
00:30:29,920 --> 00:30:32,730
any more questions

552
00:30:37,799 --> 00:30:43,799
in order for you to have access to ADB

553
00:30:40,349 --> 00:30:48,450
shouldn't you enable the debugging you

554
00:30:43,799 --> 00:30:52,830
know so most of these devices already

555
00:30:48,450 --> 00:30:57,119
have debugging on are you yes they are

556
00:30:52,830 --> 00:31:00,658
vulnerable by design design they come

557
00:30:57,119 --> 00:31:02,129
with debugging off so no because it's

558
00:31:00,659 --> 00:31:05,219
the manufacturer who implements the

559
00:31:02,129 --> 00:31:09,529
design Android by default has ADB off

560
00:31:05,219 --> 00:31:12,989
right so I figure that there's somehow

561
00:31:09,529 --> 00:31:15,570
some test lead that just figured out

562
00:31:12,989 --> 00:31:20,279
that you can just ship the bill with ADB

563
00:31:15,570 --> 00:31:23,908
open connect the TV or whatever to the

564
00:31:20,279 --> 00:31:28,109
wife go to the test Wi-Fi push all of

565
00:31:23,909 --> 00:31:30,719
the test apk is to the device and just

566
00:31:28,109 --> 00:31:34,468
get a cool panel like to detect dead

567
00:31:30,719 --> 00:31:35,969
pixels or it's just one speculation but

568
00:31:34,469 --> 00:31:37,889
this is what I think that they're doing

569
00:31:35,969 --> 00:31:44,519
what would be your recommendation for us

570
00:31:37,889 --> 00:31:47,129
to do well check if adb is open that's

571
00:31:44,519 --> 00:31:48,809
it it's Android is fairly transparent

572
00:31:47,129 --> 00:31:51,238
when it comes to that you can check it

573
00:31:48,809 --> 00:31:53,639
really easily just go like in developer

574
00:31:51,239 --> 00:31:57,089
options and check if it's open if it's

575
00:31:53,639 --> 00:31:58,289
not open then most probably you don't

576
00:31:57,089 --> 00:32:04,428
have anything to worry about

577
00:31:58,289 --> 00:32:04,429
alright thank you for the presentation

578
00:32:05,570 --> 00:32:11,009
that was present within the Android

579
00:32:08,219 --> 00:32:12,450
system so even if the adb is open if you

580
00:32:11,009 --> 00:32:17,279
don't have the root privilege you can't

581
00:32:12,450 --> 00:32:18,749
access the other resources so the ADB is

582
00:32:17,279 --> 00:32:22,919
open and you can escalate your privilege

583
00:32:18,749 --> 00:32:25,049
to access those resources like the ADB

584
00:32:22,919 --> 00:32:31,049
is open and you can escalate the

585
00:32:25,049 --> 00:32:33,269
privilege and again yeah yeah there were

586
00:32:31,049 --> 00:32:37,219
some devices that came out reroute it I

587
00:32:33,269 --> 00:32:40,919
don't know why I guess is your testing

588
00:32:37,219 --> 00:32:43,649
but most of them were locked down

589
00:32:40,919 --> 00:32:45,839
there's also a bunch of emulators out

590
00:32:43,649 --> 00:32:48,389
there and a lot of the honey pots

591
00:32:45,839 --> 00:32:49,270
deployed by those really awesome guys

592
00:32:48,389 --> 00:32:54,939
who

593
00:32:49,270 --> 00:32:58,620
of cutting for this thank you all right

594
00:32:54,940 --> 00:32:58,620
Thank You Gabby thank you

