1
00:00:00,560 --> 00:00:04,460
welcome to the second day

2
00:00:04,460 --> 00:00:09,540
my name is Serene and for the last seven

3
00:00:09,540 --> 00:00:13,440
years I've been part of identity Adobe

4
00:00:13,440 --> 00:00:17,220
identity security Squad my team among

5
00:00:17,220 --> 00:00:18,480
other things

6
00:00:18,480 --> 00:00:20,840
was stacked with

7
00:00:20,840 --> 00:00:23,720
protecting the login flows against

8
00:00:23,720 --> 00:00:27,720
malicious automated attempts to gain

9
00:00:27,720 --> 00:00:30,480
access to users accounts

10
00:00:30,480 --> 00:00:31,800
during the

11
00:00:31,800 --> 00:00:33,540
next minute

12
00:00:33,540 --> 00:00:37,200
I want to tell you the story of the

13
00:00:37,200 --> 00:00:41,540
first time we have encountered

14
00:00:41,540 --> 00:00:44,160
botnet powered credential Staffing

15
00:00:44,160 --> 00:00:45,780
attack

16
00:00:45,780 --> 00:00:47,820
these attacks

17
00:00:47,820 --> 00:00:50,660
are one of the most tough challenges

18
00:00:50,660 --> 00:00:54,739
that we have faced so far

19
00:00:57,120 --> 00:00:58,920
what botnets are

20
00:00:58,920 --> 00:01:00,360
you may ask

21
00:01:00,360 --> 00:01:02,399
most of you already know I'm gonna tell

22
00:01:02,399 --> 00:01:04,440
you anyway

23
00:01:04,440 --> 00:01:06,479
um is a set of Internet connecting

24
00:01:06,479 --> 00:01:09,420
devices running one or more Bots

25
00:01:09,420 --> 00:01:12,780
Bots are malicious programs which allow

26
00:01:12,780 --> 00:01:16,020
the device to be remotely controlled by

27
00:01:16,020 --> 00:01:17,400
an operator

28
00:01:17,400 --> 00:01:20,759
botnet are

29
00:01:20,759 --> 00:01:23,040
every board that's any respectable

30
00:01:23,040 --> 00:01:27,000
botnet must have widely distributed set

31
00:01:27,000 --> 00:01:30,200
of bots across the geography for example

32
00:01:30,200 --> 00:01:33,119
botnet employed against adobe's login

33
00:01:33,119 --> 00:01:34,080
page

34
00:01:34,080 --> 00:01:35,759
have had

35
00:01:35,759 --> 00:01:39,780
Bots from almost all continents I know

36
00:01:39,780 --> 00:01:41,880
that because I've specifically looked

37
00:01:41,880 --> 00:01:43,500
for Antarctica

38
00:01:43,500 --> 00:01:46,500
and it looks like we haven't been been

39
00:01:46,500 --> 00:01:50,360
attacked by Antarctica just yet

40
00:01:50,820 --> 00:01:53,939
um a decade ago botnets were mainly used

41
00:01:53,939 --> 00:01:56,939
in distributed denial of service attacks

42
00:01:56,939 --> 00:01:58,740
or DDOS

43
00:01:58,740 --> 00:02:00,780
these attacks

44
00:02:00,780 --> 00:02:05,240
while a very powerful

45
00:02:05,240 --> 00:02:08,758
they were taking down servers with

46
00:02:08,758 --> 00:02:11,459
Superfluous requests

47
00:02:11,459 --> 00:02:14,280
uh but it turns out that they weren't

48
00:02:14,280 --> 00:02:17,819
very cost efficient for the attackers

49
00:02:17,819 --> 00:02:21,360
on top of that companies have become

50
00:02:21,360 --> 00:02:25,020
more and more Adept at stopping them so

51
00:02:25,020 --> 00:02:28,140
botnets must be increasingly larger to

52
00:02:28,140 --> 00:02:30,660
be effective

53
00:02:30,660 --> 00:02:33,959
so should we just wait for cloud

54
00:02:33,959 --> 00:02:36,780
providers to make botnet attacks

55
00:02:36,780 --> 00:02:38,940
obsolete

56
00:02:38,940 --> 00:02:41,940
not really even though we have a lot of

57
00:02:41,940 --> 00:02:45,959
uh successful and nice stories about the

58
00:02:45,959 --> 00:02:49,920
cloud companies stopping some very big

59
00:02:49,920 --> 00:02:51,599
and scary

60
00:02:51,599 --> 00:02:54,599
um botnet denial distributed denial of

61
00:02:54,599 --> 00:02:55,980
service attacks

62
00:02:55,980 --> 00:03:00,120
turns out that botnets are also evolving

63
00:03:00,120 --> 00:03:02,700
and they are diversifying

64
00:03:02,700 --> 00:03:07,200
their expansion is being fueled by The

65
00:03:07,200 --> 00:03:09,720
Internet of Things phenomenon so

66
00:03:09,720 --> 00:03:10,800
nowadays

67
00:03:10,800 --> 00:03:14,640
botnets are being employed in

68
00:03:14,640 --> 00:03:18,360
as HTTP proxies credential Staffing

69
00:03:18,360 --> 00:03:21,840
attacks for review manipulation for spam

70
00:03:21,840 --> 00:03:25,879
advertising bank fraud and click fraud

71
00:03:25,879 --> 00:03:29,879
each of these is increasingly more cost

72
00:03:29,879 --> 00:03:31,459
efficient

73
00:03:31,459 --> 00:03:34,319
for an attacker

74
00:03:34,319 --> 00:03:36,360
so

75
00:03:36,360 --> 00:03:40,200
does it take digital expertise

76
00:03:40,200 --> 00:03:43,920
to use a botnet

77
00:03:43,920 --> 00:03:46,440
not really right now

78
00:03:46,440 --> 00:03:50,819
we can actually talk about malware as a

79
00:03:50,819 --> 00:03:52,379
service industry

80
00:03:52,379 --> 00:03:53,819
this

81
00:03:53,819 --> 00:03:55,500
industry

82
00:03:55,500 --> 00:03:58,620
enables almost anyone with a few dollars

83
00:03:58,620 --> 00:04:02,280
in their pockets some spare time and

84
00:04:02,280 --> 00:04:06,060
some very basic computer knowledge to

85
00:04:06,060 --> 00:04:08,280
become a cyber Criminal

86
00:04:08,280 --> 00:04:11,159
and as more and more Our Lives happen

87
00:04:11,159 --> 00:04:14,040
online the incentive for folks to become

88
00:04:14,040 --> 00:04:18,560
cyber criminals will only increase

89
00:04:19,798 --> 00:04:23,400
so by now you probably are curious how

90
00:04:23,400 --> 00:04:26,820
do you rent a botnet

91
00:04:26,820 --> 00:04:27,419
um

92
00:04:27,419 --> 00:04:29,460
I'm just kidding and I'm gonna tell you

93
00:04:29,460 --> 00:04:30,840
that

94
00:04:30,840 --> 00:04:33,000
some of you folks look like you're in

95
00:04:33,000 --> 00:04:34,460
you know

96
00:04:34,460 --> 00:04:38,639
but instead let's talk about credential

97
00:04:38,639 --> 00:04:43,400
Staffing my area of expertise

98
00:04:43,620 --> 00:04:45,620
um

99
00:04:45,840 --> 00:04:48,300
sorry

100
00:04:48,300 --> 00:04:51,180
um so you may have heard about the

101
00:04:51,180 --> 00:04:53,520
credential cracking

102
00:04:53,520 --> 00:04:56,220
credential stuffing is different while

103
00:04:56,220 --> 00:04:59,820
credential cracking will use brute force

104
00:04:59,820 --> 00:05:04,380
to crack any password giving enough time

105
00:05:04,380 --> 00:05:06,479
and the compute power credential

106
00:05:06,479 --> 00:05:09,000
Staffing is a different Beast it will

107
00:05:09,000 --> 00:05:12,600
take already liquid credentials and they

108
00:05:12,600 --> 00:05:15,900
will the attackers will try them on

109
00:05:15,900 --> 00:05:19,460
various login pages

110
00:05:20,220 --> 00:05:23,460
the expected success rate that is the

111
00:05:23,460 --> 00:05:26,340
percentage of logins that are expected

112
00:05:26,340 --> 00:05:29,820
to succeed given uh a batch of

113
00:05:29,820 --> 00:05:33,300
credentials is relatively low it's

114
00:05:33,300 --> 00:05:37,979
somewhere under one percent but this is

115
00:05:37,979 --> 00:05:41,699
relative because there is no shortage of

116
00:05:41,699 --> 00:05:45,180
this leaked credentials past data leaks

117
00:05:45,180 --> 00:05:48,240
have made sure of this

118
00:05:48,240 --> 00:05:49,039
um

119
00:05:49,039 --> 00:05:51,199
there are even

120
00:05:51,199 --> 00:05:56,039
compilations of leaks so the not so

121
00:05:56,039 --> 00:05:59,100
original name come or combination of

122
00:05:59,100 --> 00:06:01,440
many breaches

123
00:06:01,440 --> 00:06:02,960
has more than

124
00:06:02,960 --> 00:06:06,800
3.2 billion credentials

125
00:06:06,800 --> 00:06:10,259
you can do the math one percent of 3.2

126
00:06:10,259 --> 00:06:12,960
billions probably is more than the total

127
00:06:12,960 --> 00:06:15,180
number of users that most applications

128
00:06:15,180 --> 00:06:17,539
have

129
00:06:17,820 --> 00:06:19,740
um it's available on torrent sites for

130
00:06:19,740 --> 00:06:23,840
free don't ask me how I know this

131
00:06:24,300 --> 00:06:27,479
um and five years ago

132
00:06:27,479 --> 00:06:30,180
while we were defending Adobe against

133
00:06:30,180 --> 00:06:32,880
the first credentials uh Staffing

134
00:06:32,880 --> 00:06:34,979
attacks credential Staffing attacks that

135
00:06:34,979 --> 00:06:37,620
weren't using botnets just yet we

136
00:06:37,620 --> 00:06:40,020
noticed that there were some IDs that

137
00:06:40,020 --> 00:06:43,080
kept appearing in our logs

138
00:06:43,080 --> 00:06:46,680
we had no idea what they meant so what

139
00:06:46,680 --> 00:06:49,440
you do well when you're out of ideas you

140
00:06:49,440 --> 00:06:52,560
just put the ID in Google search box and

141
00:06:52,560 --> 00:06:56,280
hit enter and to our surprise

142
00:06:56,280 --> 00:06:59,220
we had a result we found something that

143
00:06:59,220 --> 00:07:01,680
looked like a configuration file

144
00:07:01,680 --> 00:07:07,259
which was designed to hack adobe's users

145
00:07:07,259 --> 00:07:08,880
we searched further and we actually

146
00:07:08,880 --> 00:07:11,880
found the tool that used that

147
00:07:11,880 --> 00:07:15,240
configuration file it was called Sentry

148
00:07:15,240 --> 00:07:20,039
MBA and right now our well at that time

149
00:07:20,039 --> 00:07:22,800
we realized that these folks have proper

150
00:07:22,800 --> 00:07:25,919
tools they weren't just script kitties

151
00:07:25,919 --> 00:07:28,698
so

152
00:07:29,960 --> 00:07:32,699
downloaded the application and found out

153
00:07:32,699 --> 00:07:36,680
that it has native support for proxies

154
00:07:36,680 --> 00:07:40,860
it allows attackers to spoof user agents

155
00:07:40,860 --> 00:07:42,360
and

156
00:07:42,360 --> 00:07:44,160
there are even detailed tutorials

157
00:07:44,160 --> 00:07:48,479
available on YouTube for free I've

158
00:07:48,479 --> 00:07:50,759
included such a tutorial please don't

159
00:07:50,759 --> 00:07:53,360
use it

160
00:07:55,160 --> 00:07:59,039
so how do you stop such an attack

161
00:07:59,039 --> 00:08:02,759
the best way is to ask users not to use

162
00:08:02,759 --> 00:08:06,300
their passwords across websites

163
00:08:06,300 --> 00:08:07,139
um

164
00:08:07,139 --> 00:08:09,120
password managers can can help you with

165
00:08:09,120 --> 00:08:09,860
that

166
00:08:09,860 --> 00:08:13,560
but most likely password use would be a

167
00:08:13,560 --> 00:08:15,720
problem as long as we're going to use

168
00:08:15,720 --> 00:08:18,120
passwords for Authentication

169
00:08:18,120 --> 00:08:20,599
and just look at the statistics

170
00:08:20,599 --> 00:08:24,479
more than 80 percent of users myself

171
00:08:24,479 --> 00:08:27,539
included have reused password that lists

172
00:08:27,539 --> 00:08:29,900
once

173
00:08:30,120 --> 00:08:34,260
and I personally believe that the

174
00:08:34,260 --> 00:08:36,140
percent is higher

175
00:08:36,140 --> 00:08:42,120
and 25 percent uh do that on almost all

176
00:08:42,120 --> 00:08:45,080
their accounts

177
00:08:46,440 --> 00:08:49,019
but we have another approach enabling

178
00:08:49,019 --> 00:08:51,060
two-factor authentication unfortunately

179
00:08:51,060 --> 00:08:53,700
two-factor authentication is a hassle

180
00:08:53,700 --> 00:08:57,899
and companies don't want to force it to

181
00:08:57,899 --> 00:09:01,140
their users Adobe does the same and

182
00:09:01,140 --> 00:09:04,080
because of that only 13 percent of our

183
00:09:04,080 --> 00:09:07,320
logins are 2fa enabled and this is not

184
00:09:07,320 --> 00:09:09,300
nearly enough to deter credential

185
00:09:09,300 --> 00:09:12,000
Staffing attacks

186
00:09:12,000 --> 00:09:14,839
um and well the third

187
00:09:14,839 --> 00:09:18,720
option is to detect and stop malicious

188
00:09:18,720 --> 00:09:22,200
login attempts I know this is a lot

189
00:09:22,200 --> 00:09:25,140
easier said than done but buried me just

190
00:09:25,140 --> 00:09:27,180
imagine that we have such a magical

191
00:09:27,180 --> 00:09:28,440
service

192
00:09:28,440 --> 00:09:32,880
that we can uh that will spot us our

193
00:09:32,880 --> 00:09:35,519
malicious looking attempts what can we

194
00:09:35,519 --> 00:09:39,080
do well you'll say

195
00:09:39,320 --> 00:09:42,120
not so fast because Bots are becoming

196
00:09:42,120 --> 00:09:47,120
more and more Adept at solving capture

197
00:09:47,880 --> 00:09:49,740
on the average I believe that they do

198
00:09:49,740 --> 00:09:53,880
better than humans also

199
00:09:54,420 --> 00:09:58,080
um we can just block the login but you

200
00:09:58,080 --> 00:10:00,060
have to make sure that your magic

201
00:10:00,060 --> 00:10:03,779
service is 100 sure otherwise you'll

202
00:10:03,779 --> 00:10:07,860
upset a lot of folks

203
00:10:07,860 --> 00:10:09,980
um

204
00:10:10,680 --> 00:10:12,120
what

205
00:10:12,120 --> 00:10:15,360
uh we ended up doing at Adobe is to

206
00:10:15,360 --> 00:10:19,019
Forest to fa on those logins that we

207
00:10:19,019 --> 00:10:22,860
flag as malicious but even here there is

208
00:10:22,860 --> 00:10:26,040
the catch you can't do that

209
00:10:26,040 --> 00:10:30,839
you can't just do that like you have to

210
00:10:30,839 --> 00:10:31,380
um

211
00:10:31,380 --> 00:10:35,640
challenge the login with the 2fa

212
00:10:35,640 --> 00:10:36,540
um

213
00:10:36,540 --> 00:10:39,500
code before asking the user for password

214
00:10:39,500 --> 00:10:42,300
because if you're asking for password

215
00:10:42,300 --> 00:10:44,579
first after the user enter the email or

216
00:10:44,579 --> 00:10:47,160
username then an attacker will just know

217
00:10:47,160 --> 00:10:51,540
that they found the correct password and

218
00:10:51,540 --> 00:10:53,760
I don't know we'll try tomorrow probably

219
00:10:53,760 --> 00:10:55,860
your magic server will will not work

220
00:10:55,860 --> 00:10:58,100
tomorrow

221
00:11:00,300 --> 00:11:03,300
foreign

222
00:11:05,540 --> 00:11:09,360
so far we talked about

223
00:11:09,360 --> 00:11:11,640
attackers

224
00:11:11,640 --> 00:11:12,959
um

225
00:11:12,959 --> 00:11:16,800
tools we have our own and it's called a

226
00:11:16,800 --> 00:11:20,519
risk assessment service Aura and this is

227
00:11:20,519 --> 00:11:23,579
our magical service which uses a rule

228
00:11:23,579 --> 00:11:24,420
engine

229
00:11:24,420 --> 00:11:27,240
to detect

230
00:11:27,240 --> 00:11:31,019
possibly malicious login attempts and it

231
00:11:31,019 --> 00:11:35,339
it has rules such as consider high risk

232
00:11:35,339 --> 00:11:38,040
any login attempt that comes from an IP

233
00:11:38,040 --> 00:11:40,560
which in the last five minutes have more

234
00:11:40,560 --> 00:11:44,839
than 10 fail logins

235
00:11:44,839 --> 00:11:48,180
we have this is just an example we have

236
00:11:48,180 --> 00:11:50,880
multiple such such rules

237
00:11:50,880 --> 00:11:54,360
and we also keep statistics for the last

238
00:11:54,360 --> 00:11:58,860
hour the last day in the last 30 days

239
00:11:58,860 --> 00:12:01,040
foreign

240
00:12:02,720 --> 00:12:05,579
breakfast so

241
00:12:05,579 --> 00:12:09,060
um doesn't this cupcake look delicious

242
00:12:09,060 --> 00:12:11,700
uh if Adobe were in a bakery business

243
00:12:11,700 --> 00:12:15,440
that would be a welcome site however

244
00:12:15,440 --> 00:12:18,959
we are using cupcakes as code words for

245
00:12:18,959 --> 00:12:21,079
security incidents

246
00:12:21,079 --> 00:12:23,519
I don't know why

247
00:12:23,519 --> 00:12:24,300
um

248
00:12:24,300 --> 00:12:27,899
so prior to 2019 we were on a diet we

249
00:12:27,899 --> 00:12:31,320
didn't have many cupcakes

250
00:12:31,320 --> 00:12:34,279
um and things worked well for us

251
00:12:34,279 --> 00:12:37,980
but in October 2019

252
00:12:37,980 --> 00:12:40,620
some alerts started to fire there were

253
00:12:40,620 --> 00:12:43,860
fail login alerts that we put in place

254
00:12:43,860 --> 00:12:46,800
some time ago to

255
00:12:46,800 --> 00:12:47,519
um

256
00:12:47,519 --> 00:12:50,519
detect uh login attempts fraudulent

257
00:12:50,519 --> 00:12:54,000
possibly fraudulent login attempts that

258
00:12:54,000 --> 00:12:57,860
were bypassing a risk assessment

259
00:12:58,139 --> 00:12:58,980
um

260
00:12:58,980 --> 00:13:01,620
but up until now

261
00:13:01,620 --> 00:13:05,220
we would have been able to detect one IP

262
00:13:05,220 --> 00:13:09,000
or user region or something like this to

263
00:13:09,000 --> 00:13:09,779
um

264
00:13:09,779 --> 00:13:14,300
as a marker of the attack this time

265
00:13:14,880 --> 00:13:17,940
login failure seem to come from IPS with

266
00:13:17,940 --> 00:13:21,240
very low passed login failures we were

267
00:13:21,240 --> 00:13:23,839
both

268
00:13:23,899 --> 00:13:26,839
troubled and puzzled

269
00:13:26,839 --> 00:13:30,240
what the heck is going on it was just

270
00:13:30,240 --> 00:13:31,019
like

271
00:13:31,019 --> 00:13:33,600
almost all of users have been hit by

272
00:13:33,600 --> 00:13:35,880
Amnesia so

273
00:13:35,880 --> 00:13:37,760
uh our

274
00:13:37,760 --> 00:13:44,160
IP statistics became useless overnight

275
00:13:44,160 --> 00:13:46,920
later we found that the login failures

276
00:13:46,920 --> 00:13:50,220
were distributed among many IPS more

277
00:13:50,220 --> 00:13:52,200
than 10 000.

278
00:13:52,200 --> 00:13:55,500
but because we couldn't find the actual

279
00:13:55,500 --> 00:13:58,920
marker we ended up enabling 2fa for

280
00:13:58,920 --> 00:14:00,000
everyone

281
00:14:00,000 --> 00:14:02,399
we know we knew at the time that it was

282
00:14:02,399 --> 00:14:04,079
a temporary

283
00:14:04,079 --> 00:14:07,560
solution because the business was just

284
00:14:07,560 --> 00:14:09,600
around the corner

285
00:14:09,600 --> 00:14:14,040
asking why the logins have dropped

286
00:14:14,040 --> 00:14:16,139
after the attack

287
00:14:16,139 --> 00:14:19,200
there is a standard practice to reset

288
00:14:19,200 --> 00:14:22,560
the passwords for all the affected users

289
00:14:22,560 --> 00:14:25,980
but because we do we didn't know which

290
00:14:25,980 --> 00:14:29,220
were the actual affected users

291
00:14:29,220 --> 00:14:30,420
um we

292
00:14:30,420 --> 00:14:32,459
ended up resetting passwords for

293
00:14:32,459 --> 00:14:35,519
everyone logging in during the attack

294
00:14:35,519 --> 00:14:37,560
window

295
00:14:37,560 --> 00:14:40,079
um and when we are resetting a password

296
00:14:40,079 --> 00:14:42,000
we're actually sending an email to the

297
00:14:42,000 --> 00:14:45,480
user trying to explain them as calmly as

298
00:14:45,480 --> 00:14:48,899
possible what's happening but we didn't

299
00:14:48,899 --> 00:14:50,880
know what was happening so the message

300
00:14:50,880 --> 00:14:52,740
wasn't very clear and you can imagine

301
00:14:52,740 --> 00:14:56,339
the wave of confusion that followed

302
00:14:56,339 --> 00:14:59,060
uh our

303
00:14:59,060 --> 00:15:03,839
after we reset those emails and yeah you

304
00:15:03,839 --> 00:15:05,880
can see that the user experience was

305
00:15:05,880 --> 00:15:07,860
pretty bad but that would be a huge

306
00:15:07,860 --> 00:15:09,660
understatement

307
00:15:09,660 --> 00:15:11,399
on top of this

308
00:15:11,399 --> 00:15:14,519
uh there are states that have

309
00:15:14,519 --> 00:15:16,380
legislation that requires Adobe to

310
00:15:16,380 --> 00:15:19,560
report such attacks if the number of

311
00:15:19,560 --> 00:15:22,980
affected users goes beyond a threshold

312
00:15:22,980 --> 00:15:26,040
we didn't have to do that but we were

313
00:15:26,040 --> 00:15:30,300
pretty close I've Been Told

314
00:15:30,300 --> 00:15:34,199
um after we dealt with the Fallout

315
00:15:34,199 --> 00:15:36,779
we went back to audit logs trying to

316
00:15:36,779 --> 00:15:39,000
figure out what happened

317
00:15:39,000 --> 00:15:41,120
our first

318
00:15:41,120 --> 00:15:44,699
clue came from the fact that they were a

319
00:15:44,699 --> 00:15:45,600
lot

320
00:15:45,600 --> 00:15:47,040
of

321
00:15:47,040 --> 00:15:48,000
um

322
00:15:48,000 --> 00:15:51,180
unique IPS that were used during the

323
00:15:51,180 --> 00:15:52,980
attack window so the number of unique

324
00:15:52,980 --> 00:15:57,199
IPS raised sharply this hinted us that

325
00:15:57,199 --> 00:16:02,479
there might be a botnet at Play

326
00:16:03,420 --> 00:16:05,579
um the puzzle was complete when we

327
00:16:05,579 --> 00:16:09,060
actually saw that the users were also

328
00:16:09,060 --> 00:16:12,000
logging in successfully or not many

329
00:16:12,000 --> 00:16:14,639
times and this was odd because we're

330
00:16:14,639 --> 00:16:16,500
trying to get users through the login

331
00:16:16,500 --> 00:16:19,380
page only once and they also

332
00:16:19,380 --> 00:16:21,000
help us with that they don't want to log

333
00:16:21,000 --> 00:16:22,160
in

334
00:16:22,160 --> 00:16:25,079
and users that don't remember their

335
00:16:25,079 --> 00:16:27,120
password they try one two three times

336
00:16:27,120 --> 00:16:29,940
and then they gonna go to password

337
00:16:29,940 --> 00:16:35,180
recovery flow those users didn't do that

338
00:16:35,399 --> 00:16:38,459
um our Erica moment came when we put

339
00:16:38,459 --> 00:16:40,620
those two pieces together and we

340
00:16:40,620 --> 00:16:42,060
realized that

341
00:16:42,060 --> 00:16:45,720
attackers that use botnets which depend

342
00:16:45,720 --> 00:16:47,820
on iot devices

343
00:16:47,820 --> 00:16:50,880
they have to give the same batch of

344
00:16:50,880 --> 00:16:53,100
credentials to multiple Bots because

345
00:16:53,100 --> 00:16:55,259
they are not very reliable

346
00:16:55,259 --> 00:16:59,880
and this was leaving some marks in our

347
00:16:59,880 --> 00:17:04,260
laws but just about now we learned how

348
00:17:04,260 --> 00:17:06,240
to spot them

349
00:17:06,240 --> 00:17:10,799
so suppose that we have

350
00:17:10,799 --> 00:17:14,220
a pair of users and the IP they use to

351
00:17:14,220 --> 00:17:18,119
log in we can say that red and orange

352
00:17:18,119 --> 00:17:22,020
are related because user 1 uses them and

353
00:17:22,020 --> 00:17:24,079
orange and

354
00:17:24,079 --> 00:17:26,699
yellow IPR related

355
00:17:26,699 --> 00:17:29,820
but you can go a step further further

356
00:17:29,820 --> 00:17:33,480
and consider all trees all three IP

357
00:17:33,480 --> 00:17:37,380
related because orange is actually a

358
00:17:37,380 --> 00:17:40,860
bridge between the two

359
00:17:40,860 --> 00:17:43,799
um the two other IPS so what happens

360
00:17:43,799 --> 00:17:47,400
when we apply this algorithm to the data

361
00:17:47,400 --> 00:17:49,860
extracted during the attack

362
00:17:49,860 --> 00:17:52,260
well

363
00:17:52,260 --> 00:17:54,900
we found that legitimate users do not

364
00:17:54,900 --> 00:17:56,880
have many IPS in common so for them we

365
00:17:56,880 --> 00:18:00,140
would find a very small family of ips

366
00:18:00,140 --> 00:18:03,120
but fortunately this wasn't the case for

367
00:18:03,120 --> 00:18:06,660
botnet so we identified the family that

368
00:18:06,660 --> 00:18:08,940
had more than

369
00:18:08,940 --> 00:18:12,900
uh 10 000 IPS so we were actually after

370
00:18:12,900 --> 00:18:15,059
the algorithm finish we were looking our

371
00:18:15,059 --> 00:18:18,240
first botnet we were having a piece for

372
00:18:18,240 --> 00:18:20,220
of the first botnet

373
00:18:20,220 --> 00:18:21,559
and

374
00:18:21,559 --> 00:18:25,440
what about vpns you may ask and yeah

375
00:18:25,440 --> 00:18:27,120
it's a good question

376
00:18:27,120 --> 00:18:30,320
the again fortunately

377
00:18:30,320 --> 00:18:36,200
I users using vpns are also do not share

378
00:18:36,200 --> 00:18:41,419
large enough set of of ips to

379
00:18:41,419 --> 00:18:45,720
demonstrate the botnate behavior

380
00:18:45,720 --> 00:18:49,100
so times of the essence

381
00:18:49,100 --> 00:18:51,539
the winter holidays were approaching

382
00:18:51,539 --> 00:18:54,440
fast and we didn't want to spend them

383
00:18:54,440 --> 00:18:57,059
resetting users passwords probably they

384
00:18:57,059 --> 00:18:59,760
didn't want to receive our emails also

385
00:18:59,760 --> 00:19:04,020
so we patched up the quickest thing that

386
00:19:04,020 --> 00:19:08,419
we could we've implemented the

387
00:19:08,419 --> 00:19:12,299
algorithm as a Jenkins job every 15

388
00:19:12,299 --> 00:19:16,020
minutes we would download the past two

389
00:19:16,020 --> 00:19:18,179
hours of logging data we'll try to find

390
00:19:18,179 --> 00:19:22,760
the Clusters and big clusters we would

391
00:19:22,760 --> 00:19:26,600
feed back into the risk assessment

392
00:19:26,600 --> 00:19:30,059
service every login for the next few

393
00:19:30,059 --> 00:19:32,039
hours coming from those IPS would have

394
00:19:32,039 --> 00:19:34,260
been automatically challenged by 2fa

395
00:19:34,260 --> 00:19:37,140
before asking the users for for

396
00:19:37,140 --> 00:19:38,460
passwords

397
00:19:38,460 --> 00:19:40,260
to our surprise

398
00:19:40,260 --> 00:19:44,039
the attacks didn't stop once we employed

399
00:19:44,039 --> 00:19:46,280
the defense

400
00:19:46,280 --> 00:19:49,080
well probably attackers also have a day

401
00:19:49,080 --> 00:19:51,960
job so they left the attack running

402
00:19:51,960 --> 00:19:56,400
overnight and even an even bigger botnet

403
00:19:56,400 --> 00:20:02,340
has been used it had like 17

404
00:20:02,340 --> 00:20:07,260
000 IPS we stopped that too and in fact

405
00:20:07,260 --> 00:20:11,640
the bigger the botnet is the easier is

406
00:20:11,640 --> 00:20:17,240
for our algorithm to detect and stop it

407
00:20:17,580 --> 00:20:20,700
but of course we had folks that didn't

408
00:20:20,700 --> 00:20:22,740
believe in our algorithm and they were

409
00:20:22,740 --> 00:20:24,960
asking how do you know that it really

410
00:20:24,960 --> 00:20:28,260
works and I ended up showing them the

411
00:20:28,260 --> 00:20:31,980
same picture I'm showing you

412
00:20:31,980 --> 00:20:33,419
um you may

413
00:20:33,419 --> 00:20:38,220
observe in the low part the traffic that

414
00:20:38,220 --> 00:20:41,280
we are marking as low risk and it looks

415
00:20:41,280 --> 00:20:43,860
like a wave it's hell it's natural it's

416
00:20:43,860 --> 00:20:46,980
boring and we like boring and it's in

417
00:20:46,980 --> 00:20:52,020
stark contrast with blue and green which

418
00:20:52,020 --> 00:20:54,440
they look like a tsunami so this is

419
00:20:54,440 --> 00:20:58,820
botnet traffic that we had to to stop

420
00:20:58,820 --> 00:21:02,940
and to be fair if you look closely we

421
00:21:02,940 --> 00:21:04,860
still have some spikes

422
00:21:04,860 --> 00:21:09,020
of low risk traffic that

423
00:21:09,020 --> 00:21:11,940
means that our algorithm is not a

424
00:21:11,940 --> 00:21:14,400
hundred percent

425
00:21:14,400 --> 00:21:17,179
accurate

426
00:21:17,640 --> 00:21:20,400
looking at the bigger picture we can see

427
00:21:20,400 --> 00:21:23,460
that in

428
00:21:23,460 --> 00:21:26,000
uh before the

429
00:21:26,000 --> 00:21:30,419
detector was deployed we have a big

430
00:21:30,419 --> 00:21:33,120
number of compromised accounts that we

431
00:21:33,120 --> 00:21:35,240
had to reset

432
00:21:35,240 --> 00:21:38,520
and the numbers dropped significantly

433
00:21:38,520 --> 00:21:43,140
like almost an order of magnitude and it

434
00:21:43,140 --> 00:21:48,539
continued to drop into 2021 but I can't

435
00:21:48,539 --> 00:21:52,460
boast about it because pandemic probably

436
00:21:52,460 --> 00:21:55,620
left some more opportunities for for

437
00:21:55,620 --> 00:21:58,200
botnets to be to be used instead of

438
00:21:58,200 --> 00:22:01,340
credential Staffing

439
00:22:02,539 --> 00:22:05,440
the system as you have already

440
00:22:05,440 --> 00:22:08,460
[Music]

441
00:22:08,460 --> 00:22:11,400
seen has its limitations the algorithm

442
00:22:11,400 --> 00:22:15,240
needs a warm up so it has to leave some

443
00:22:15,240 --> 00:22:19,760
some malicious traffic through before

444
00:22:19,760 --> 00:22:23,220
it detects the attack

445
00:22:23,220 --> 00:22:25,860
and the algorithm is also inefficient

446
00:22:25,860 --> 00:22:29,400
against small-scale botnets because they

447
00:22:29,400 --> 00:22:33,539
have the same IP set patterns as large

448
00:22:33,539 --> 00:22:38,039
organizations and users using vpns but

449
00:22:38,039 --> 00:22:40,860
for those cases we still have our tried

450
00:22:40,860 --> 00:22:45,260
and tested IP based rules

451
00:22:46,140 --> 00:22:49,440
um also we had problems we distributed

452
00:22:49,440 --> 00:22:51,659
the monitoring system our colleagues in

453
00:22:51,659 --> 00:22:54,780
Adobe like monitoring their applications

454
00:22:54,780 --> 00:22:57,480
to see if they are working properly and

455
00:22:57,480 --> 00:22:59,100
they have to go through the login page

456
00:22:59,100 --> 00:23:02,159
and our botnet detected them Solutions

457
00:23:02,159 --> 00:23:06,539
like neurology synthetics had to be uh

458
00:23:06,539 --> 00:23:09,179
allow listed so they can continue with

459
00:23:09,179 --> 00:23:11,960
with their job

460
00:23:12,960 --> 00:23:15,179
um and um

461
00:23:15,179 --> 00:23:17,700
the algorithm has been designed for

462
00:23:17,700 --> 00:23:21,320
credential Staffing it's not

463
00:23:21,320 --> 00:23:25,100
applicable to other types of

464
00:23:25,100 --> 00:23:29,240
botnet enabled uh

465
00:23:29,360 --> 00:23:33,360
threads that I have shown before but the

466
00:23:33,360 --> 00:23:36,960
idea behind it that all these botnets

467
00:23:36,960 --> 00:23:40,500
must make use of iot devices which are

468
00:23:40,500 --> 00:23:43,080
not very reliable can be used against

469
00:23:43,080 --> 00:23:44,039
them

470
00:23:44,039 --> 00:23:47,658
in other scenarios

471
00:23:48,299 --> 00:23:50,580
um what I want folks to take with them

472
00:23:50,580 --> 00:23:54,360
home is that don't reuse passwords

473
00:23:54,360 --> 00:23:56,820
and probably this is not enough you

474
00:23:56,820 --> 00:23:58,799
should also tell your friends not Real's

475
00:23:58,799 --> 00:24:00,659
passwords

476
00:24:00,659 --> 00:24:01,320
um

477
00:24:01,320 --> 00:24:03,299
well you can show the password online if

478
00:24:03,299 --> 00:24:04,980
you

479
00:24:04,980 --> 00:24:07,559
if they don't believe you

480
00:24:07,559 --> 00:24:09,240
um

481
00:24:09,240 --> 00:24:12,780
for us on the server side logging is the

482
00:24:12,780 --> 00:24:15,659
key it might be hard to do it right it

483
00:24:15,659 --> 00:24:19,320
may be expensive but in the end without

484
00:24:19,320 --> 00:24:21,059
logging we wouldn't have been able to

485
00:24:21,059 --> 00:24:25,340
respond to to this threat

486
00:24:25,340 --> 00:24:28,559
and while there is no perfect solution

487
00:24:28,559 --> 00:24:32,120
to fighting botnet

488
00:24:32,240 --> 00:24:36,360
the good news is that you don't need one

489
00:24:36,360 --> 00:24:39,419
because there are no perfect botnet

490
00:24:39,419 --> 00:24:41,460
attacks either

491
00:24:41,460 --> 00:24:44,220
so I'm studying and I'm wishing you all

492
00:24:44,220 --> 00:24:46,799
uh botnet free day

493
00:24:46,799 --> 00:24:49,860
and Christmas they tend to happen during

494
00:24:49,860 --> 00:24:52,300
Christmas thank you

495
00:24:52,300 --> 00:24:56,730
[Applause]

496
00:24:57,140 --> 00:25:00,059
all right thank you sorry it is now time

497
00:25:00,059 --> 00:25:02,159
for questions keep in mind that the

498
00:25:02,159 --> 00:25:04,020
first three questions are going to get a

499
00:25:04,020 --> 00:25:06,299
hat so please look out for my colleagues

500
00:25:06,299 --> 00:25:07,260
that are going to pass through the

501
00:25:07,260 --> 00:25:09,559
microphone

502
00:25:09,659 --> 00:25:11,840
foreign

503
00:25:14,000 --> 00:25:16,860
there is a trend about passwordless

504
00:25:16,860 --> 00:25:22,080
being more secure than passwords and

505
00:25:22,080 --> 00:25:24,720
when can we see it put in practice like

506
00:25:24,720 --> 00:25:27,900
Drop password based Authentication

507
00:25:27,900 --> 00:25:30,980
once and for all

508
00:25:31,320 --> 00:25:33,900
or can we you see

509
00:25:33,900 --> 00:25:37,140
that's a very good question and I'm

510
00:25:37,140 --> 00:25:39,600
gonna ignore that you're gonna you wish

511
00:25:39,600 --> 00:25:42,600
for me to go out of job

512
00:25:42,600 --> 00:25:45,120
yeah

513
00:25:45,120 --> 00:25:49,200
I so um web often

514
00:25:49,200 --> 00:25:51,779
I think that's it's called a standard

515
00:25:51,779 --> 00:25:55,980
it's the the password killer however it

516
00:25:55,980 --> 00:26:00,320
it hasn't been implemented by all of uh

517
00:26:00,320 --> 00:26:04,620
big players and I'm looking at Apple

518
00:26:04,620 --> 00:26:06,720
probably they they needed some time to

519
00:26:06,720 --> 00:26:08,820
to to find a good name for it it's

520
00:26:08,820 --> 00:26:11,400
called they call it past keys

521
00:26:11,400 --> 00:26:13,799
uh it's their name so I believe yeah

522
00:26:13,799 --> 00:26:16,500
that now the road is open and probably

523
00:26:16,500 --> 00:26:19,620
in a few years uh we're gonna have to

524
00:26:19,620 --> 00:26:22,200
remove all our combination of many

525
00:26:22,200 --> 00:26:24,179
breaches

526
00:26:24,179 --> 00:26:26,640
because they'll be useful

527
00:26:26,640 --> 00:26:29,779
useless sorry

528
00:26:32,580 --> 00:26:36,419
hello thank you for your presentation uh

529
00:26:36,419 --> 00:26:39,620
I have one question uh you talked about

530
00:26:39,620 --> 00:26:41,700
internal processes

531
00:26:41,700 --> 00:26:44,220
and I would like to know if you share

532
00:26:44,220 --> 00:26:47,039
this uh information of this analysis

533
00:26:47,039 --> 00:26:49,980
with your partners with your clients or

534
00:26:49,980 --> 00:26:53,880
is it only internal process

535
00:26:53,880 --> 00:26:56,640
um we only share it internally

536
00:26:56,640 --> 00:26:59,880
uh the idea is that

537
00:26:59,880 --> 00:27:01,740
I'm

538
00:27:01,740 --> 00:27:05,460
I'm probably the information was shared

539
00:27:05,460 --> 00:27:07,860
with other patent partners because Adobe

540
00:27:07,860 --> 00:27:10,400
is in partnership with other

541
00:27:10,400 --> 00:27:14,700
players in the in the region uh mostly

542
00:27:14,700 --> 00:27:16,799
in the software industry so I don't

543
00:27:16,799 --> 00:27:19,980
expect Adobe to share it with folks from

544
00:27:19,980 --> 00:27:22,039
the energy sector or things like this

545
00:27:22,039 --> 00:27:25,679
but I personally wasn't involved in this

546
00:27:25,679 --> 00:27:29,279
I'm not in the team that will the

547
00:27:29,279 --> 00:27:30,059
um

548
00:27:30,059 --> 00:27:32,279
uh do such thing I don't have the

549
00:27:32,279 --> 00:27:34,799
relation so I I can only speculate that

550
00:27:34,799 --> 00:27:37,620
the information was shared but by now

551
00:27:37,620 --> 00:27:41,700
when we found that there was tons of uh

552
00:27:41,700 --> 00:27:44,640
for free it means that probably for a

553
00:27:44,640 --> 00:27:46,740
year the

554
00:27:46,740 --> 00:27:49,140
um those credentials were already on the

555
00:27:49,140 --> 00:27:51,960
dark internet and most people that were

556
00:27:51,960 --> 00:27:53,279
interested they

557
00:27:53,279 --> 00:27:56,279
already knew it

558
00:27:56,279 --> 00:27:59,419
so yeah

559
00:28:01,799 --> 00:28:04,039
foreign

560
00:28:06,620 --> 00:28:09,779
how do you differentiate here

561
00:28:09,779 --> 00:28:12,600
how do you differentiate the requests

562
00:28:12,600 --> 00:28:14,520
from Bots from the real traffic because

563
00:28:14,520 --> 00:28:17,220
lately uh in the wild I'm seeing pretty

564
00:28:17,220 --> 00:28:20,360
good botnets I mean even J Street

565
00:28:20,360 --> 00:28:23,279
fingerprints and all those blanked with

566
00:28:23,279 --> 00:28:24,500
the real traffic

567
00:28:24,500 --> 00:28:27,960
I'm talking about bothness that in every

568
00:28:27,960 --> 00:28:31,919
20 to 30 requests are changing IPS uh

569
00:28:31,919 --> 00:28:34,740
headers and everything they really look

570
00:28:34,740 --> 00:28:36,419
pretty legit

571
00:28:36,419 --> 00:28:37,980
uh yeah

572
00:28:37,980 --> 00:28:40,279
thank you very good question

573
00:28:40,279 --> 00:28:42,960
because your algorithm is pretty cool

574
00:28:42,960 --> 00:28:44,880
buzzwords but can you give us some

575
00:28:44,880 --> 00:28:46,740
details

576
00:28:46,740 --> 00:28:51,240
um yeah so the main idea is that uh we

577
00:28:51,240 --> 00:28:54,480
try to to look for uh

578
00:28:54,480 --> 00:28:56,820
the algorithm I just think it's a

579
00:28:56,820 --> 00:28:59,700
connected it's called connected uh

580
00:28:59,700 --> 00:29:03,140
graphs in a b part it

581
00:29:03,140 --> 00:29:07,500
if you probably didn't want a more

582
00:29:07,500 --> 00:29:10,020
buzzwords but the idea is that

583
00:29:10,020 --> 00:29:13,640
if we could draw a line between

584
00:29:13,640 --> 00:29:17,100
IPS and users we would go as much as

585
00:29:17,100 --> 00:29:19,380
possible in our algorithm and we'd

586
00:29:19,380 --> 00:29:23,279
consider all the I all the IPS uh caught

587
00:29:23,279 --> 00:29:27,840
in that line as being part of something

588
00:29:27,840 --> 00:29:31,260
and then if the set is big enough we

589
00:29:31,260 --> 00:29:33,600
just consider it as that's something

590
00:29:33,600 --> 00:29:36,299
being a botnet because on the on the

591
00:29:36,299 --> 00:29:39,179
lower end that something can mean a big

592
00:29:39,179 --> 00:29:42,200
company and we have troubles with

593
00:29:42,200 --> 00:29:45,000
universities for example they start a

594
00:29:45,000 --> 00:29:48,419
lab they give the wrong password to all

595
00:29:48,419 --> 00:29:52,740
the students our alerts fire up so at

596
00:29:52,740 --> 00:29:53,760
that level

597
00:29:53,760 --> 00:29:57,179
and we are talking about hundreds of ips

598
00:29:57,179 --> 00:30:00,779
uh when we are talking of thousands

599
00:30:00,779 --> 00:30:04,140
then we can say with certain that this

600
00:30:04,140 --> 00:30:07,440
is button Behavior but to be fair

601
00:30:07,440 --> 00:30:10,980
between hundreds and thousands is a

602
00:30:10,980 --> 00:30:12,659
great area where

603
00:30:12,659 --> 00:30:15,600
I'm not sure and because I'm not sure I

604
00:30:15,600 --> 00:30:17,760
can't use the hammer to just block the

605
00:30:17,760 --> 00:30:20,520
login what I'll do I'll hinder the user

606
00:30:20,520 --> 00:30:24,000
and throw a 2fa because I I can do that

607
00:30:24,000 --> 00:30:26,460
that's the the

608
00:30:26,460 --> 00:30:29,279
the advantage of

609
00:30:29,279 --> 00:30:33,200
being the owner of the application

610
00:30:33,600 --> 00:30:37,699
all right thank you so much serene

