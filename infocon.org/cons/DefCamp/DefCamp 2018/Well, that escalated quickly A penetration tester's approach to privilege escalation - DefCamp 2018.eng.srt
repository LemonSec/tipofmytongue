1
00:00:00,030 --> 00:00:03,780
have you ever<font color="#E5E5E5"> been in this situation</font>

2
00:00:01,399 --> 00:00:07,020
<font color="#CCCCCC">that you</font><font color="#E5E5E5"> want to perform a certain</font>

3
00:00:03,780 --> 00:00:10,559
action<font color="#CCCCCC"> that you want to</font><font color="#E5E5E5"> execute a file</font>

4
00:00:07,020 --> 00:00:13,018
or change a setting<font color="#E5E5E5"> and you just got the</font>

5
00:00:10,559 --> 00:00:15,750
error message<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> not allowed to do</font>

6
00:00:13,019 --> 00:00:18,840
this action<font color="#CCCCCC"> you're not authorized</font><font color="#E5E5E5"> to</font>

7
00:00:15,750 --> 00:00:20,970
execute execute this<font color="#E5E5E5"> file or you are not</font>

8
00:00:18,840 --> 00:00:24,750
you<font color="#E5E5E5"> don't have the permission</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> change</font>

9
00:00:20,970 --> 00:00:27,000
this<font color="#E5E5E5"> configuration yes did you</font><font color="#CCCCCC"> get angry</font>

10
00:00:24,750 --> 00:00:30,810
<font color="#CCCCCC">and this is exactly the</font><font color="#E5E5E5"> talk for you</font>

11
00:00:27,000 --> 00:00:32,759
<font color="#E5E5E5">welcome to well that</font><font color="#CCCCCC"> escalated</font><font color="#E5E5E5"> quickly</font><font color="#CCCCCC"> a</font>

12
00:00:30,810 --> 00:00:36,449
penetration<font color="#E5E5E5"> testers approach to</font>

13
00:00:32,759 --> 00:00:38,760
<font color="#E5E5E5">privilege escalation but before diving</font>

14
00:00:36,450 --> 00:00:41,790
<font color="#E5E5E5">into</font><font color="#CCCCCC"> the topic I would</font><font color="#E5E5E5"> like to know a</font>

15
00:00:38,760 --> 00:00:44,610
<font color="#E5E5E5">little bit more</font><font color="#CCCCCC"> about you guys</font><font color="#E5E5E5"> who of</font>

16
00:00:41,790 --> 00:00:51,360
you is a penetration<font color="#E5E5E5"> tester please raise</font>

17
00:00:44,610 --> 00:00:57,420
their<font color="#CCCCCC"> hand</font><font color="#E5E5E5"> okay some not that many do</font><font color="#CCCCCC"> we</font>

18
00:00:51,360 --> 00:00:59,660
<font color="#CCCCCC">have security</font><font color="#E5E5E5"> researchers all right do</font>

19
00:00:57,420 --> 00:01:06,500
we<font color="#CCCCCC"> have system or network</font>

20
00:00:59,660 --> 00:01:09,869
<font color="#CCCCCC">administrator's some of you great</font>

21
00:01:06,500 --> 00:01:12,510
another question<font color="#E5E5E5"> how many of you guys</font>

22
00:01:09,869 --> 00:01:19,920
use<font color="#CCCCCC"> a disk encryption tool like</font>

23
00:01:12,510 --> 00:01:21,990
BitLocker not all<font color="#CCCCCC"> okay and a few</font><font color="#E5E5E5"> guys</font>

24
00:01:19,920 --> 00:01:27,299
how many<font color="#E5E5E5"> have to enter their password</font>

25
00:01:21,990 --> 00:01:28,679
<font color="#E5E5E5">every time they put their PC</font><font color="#CCCCCC"> ok that's</font>

26
00:01:27,299 --> 00:01:33,630
good<font color="#E5E5E5"> because it's going</font><font color="#CCCCCC"> to be</font>

27
00:01:28,680 --> 00:01:36,960
interesting<font color="#CCCCCC"> later on</font><font color="#E5E5E5"> so as a penetration</font>

28
00:01:33,630 --> 00:01:42,780
tester<font color="#E5E5E5"> sometimes during our assessments</font>

29
00:01:36,960 --> 00:01:46,320
we get access<font color="#CCCCCC"> to a system</font><font color="#E5E5E5"> however only</font>

30
00:01:42,780 --> 00:01:48,299
<font color="#E5E5E5">with a low privileged user but we want</font>

31
00:01:46,320 --> 00:01:50,158
to do<font color="#E5E5E5"> everything that we</font><font color="#CCCCCC"> want we want</font><font color="#E5E5E5"> to</font>

32
00:01:48,299 --> 00:01:52,860
execute<font color="#E5E5E5"> any file we</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> to change any</font>

33
00:01:50,159 --> 00:01:55,140
configuration<font color="#E5E5E5"> file you want to intercept</font>

34
00:01:52,860 --> 00:01:57,840
the network traffic<font color="#E5E5E5"> but we cannot do</font>

35
00:01:55,140 --> 00:02:00,390
<font color="#E5E5E5">this with our low</font><font color="#CCCCCC"> privileged user and</font>

36
00:01:57,840 --> 00:02:02,909
that's exactly<font color="#E5E5E5"> why we need to escalate</font>

37
00:02:00,390 --> 00:02:06,689
our privileges<font color="#E5E5E5"> we want to escalate our</font>

38
00:02:02,909 --> 00:02:10,830
privileges<font color="#E5E5E5"> to be fully operative so it</font>

39
00:02:06,689 --> 00:02:13,380
is a very important task in<font color="#CCCCCC"> a in an</font>

40
00:02:10,830 --> 00:02:16,620
assessment within<font color="#E5E5E5"> a penetration test</font>

41
00:02:13,380 --> 00:02:19,320
but sometimes it gets<font color="#CCCCCC"> really complex</font><font color="#E5E5E5"> and</font>

42
00:02:16,620 --> 00:02:22,860
complicated<font color="#CCCCCC"> it's not</font><font color="#E5E5E5"> always an easy task</font>

43
00:02:19,320 --> 00:02:26,130
<font color="#CCCCCC">sometimes it might be but it does not</font>

44
00:02:22,860 --> 00:02:28,650
necessarily<font color="#E5E5E5"> have</font><font color="#CCCCCC"> to be so</font><font color="#E5E5E5"> that's why we</font>

45
00:02:26,130 --> 00:02:31,740
want to<font color="#E5E5E5"> know</font><font color="#CCCCCC"> more about</font><font color="#E5E5E5"> privilege</font>

46
00:02:28,650 --> 00:02:34,190
escalation<font color="#E5E5E5"> and if you search in</font><font color="#CCCCCC"> the</font>

47
00:02:31,740 --> 00:02:36,870
<font color="#CCCCCC">internet for</font><font color="#E5E5E5"> privilege escalation</font>

48
00:02:34,190 --> 00:02:39,390
articles and tutorials<font color="#CCCCCC"> you</font><font color="#E5E5E5"> will find</font>

49
00:02:36,870 --> 00:02:42,870
some things you<font color="#E5E5E5"> will</font><font color="#CCCCCC"> find some very</font>

50
00:02:39,390 --> 00:02:45,920
specific tutorials or articles and some

51
00:02:42,870 --> 00:02:48,510
that<font color="#E5E5E5"> are written in a more general way</font>

52
00:02:45,920 --> 00:02:53,100
<font color="#CCCCCC">however there is not really</font><font color="#E5E5E5"> a</font>

53
00:02:48,510 --> 00:02:55,200
comprehensive<font color="#CCCCCC"> and profound</font><font color="#E5E5E5"> literature</font>

54
00:02:53,100 --> 00:02:59,760
that<font color="#E5E5E5"> deals with this topic and that's</font>

55
00:02:55,200 --> 00:03:02,100
<font color="#E5E5E5">why I chose to research this</font><font color="#CCCCCC"> topic so</font>

56
00:02:59,760 --> 00:03:04,920
what do<font color="#CCCCCC"> we</font><font color="#E5E5E5"> want to achieve</font><font color="#CCCCCC"> we want to</font>

57
00:03:02,100 --> 00:03:07,530
learn<font color="#E5E5E5"> the theory and the practice</font><font color="#CCCCCC"> of</font>

58
00:03:04,920 --> 00:03:10,829
privilege escalation attack attacks<font color="#E5E5E5"> so</font>

59
00:03:07,530 --> 00:03:14,090
<font color="#E5E5E5">that we can use it in our</font><font color="#CCCCCC"> daily life</font>

60
00:03:10,830 --> 00:03:16,890
<font color="#E5E5E5">whether we are a penetration tester and</font>

61
00:03:14,090 --> 00:03:19,200
attack we are<font color="#E5E5E5"> attacking a system or</font>

62
00:03:16,890 --> 00:03:23,100
whether we are<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> other side and</font>

63
00:03:19,200 --> 00:03:25,320
<font color="#E5E5E5">trying to defend our systems and at the</font>

64
00:03:23,100 --> 00:03:28,470
end of the talk we want to have a

65
00:03:25,320 --> 00:03:30,690
practical<font color="#E5E5E5"> and systematic approach for</font>

66
00:03:28,470 --> 00:03:34,320
every one of us who wants to escalate

67
00:03:30,690 --> 00:03:39,210
his privileges in this talk I am going

68
00:03:34,320 --> 00:03:41,010
<font color="#CCCCCC">to focus on</font><font color="#E5E5E5"> Windows systems but the</font>

69
00:03:39,210 --> 00:03:43,860
concepts that<font color="#E5E5E5"> you're going to</font><font color="#CCCCCC"> learn our</font>

70
00:03:41,010 --> 00:03:46,440
<font color="#CCCCCC">are can be used for</font><font color="#E5E5E5"> other operating</font>

71
00:03:43,860 --> 00:03:51,690
systems or even<font color="#CCCCCC"> other systems or</font>

72
00:03:46,440 --> 00:03:53,940
applications<font color="#E5E5E5"> so we have to talk</font><font color="#CCCCCC"> a little</font>

73
00:03:51,690 --> 00:04:00,000
<font color="#E5E5E5">bit</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> Windows and its basic</font>

74
00:03:53,940 --> 00:04:05,100
<font color="#CCCCCC">components Windows is the</font><font color="#E5E5E5"> de</font><font color="#CCCCCC"> facto</font>

75
00:04:00,000 --> 00:04:07,740
<font color="#CCCCCC">standard</font><font color="#E5E5E5"> in the company networks most</font>

76
00:04:05,100 --> 00:04:10,829
companies most big companies most banks

77
00:04:07,740 --> 00:04:14,180
use<font color="#E5E5E5"> Windows as a operating system for</font>

78
00:04:10,830 --> 00:04:17,430
their employees computers laptops<font color="#CCCCCC"> and</font>

79
00:04:14,180 --> 00:04:21,630
workstations<font color="#E5E5E5"> it holds a market value of</font>

80
00:04:17,430 --> 00:04:25,620
<font color="#E5E5E5">over</font><font color="#CCCCCC"> 80%</font><font color="#E5E5E5"> so it's the dominant</font><font color="#CCCCCC"> operating</font>

81
00:04:21,630 --> 00:04:26,700
system and<font color="#E5E5E5"> also in company networks we</font>

82
00:04:25,620 --> 00:04:31,110
find

83
00:04:26,700 --> 00:04:33,210
<font color="#E5E5E5">more and more</font><font color="#CCCCCC"> Windows servers</font><font color="#E5E5E5"> windows</font>

84
00:04:31,110 --> 00:04:37,280
itself<font color="#E5E5E5"> is complex</font>

85
00:04:33,210 --> 00:04:41,190
<font color="#E5E5E5">so</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> opera an operating system</font><font color="#CCCCCC"> that's</font>

86
00:04:37,280 --> 00:04:43,440
old<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> long on the market</font><font color="#E5E5E5"> many</font>

87
00:04:41,190 --> 00:04:45,060
<font color="#E5E5E5">vulnerabilities have been found and what</font>

88
00:04:43,440 --> 00:04:47,430
many vulnerabilities<font color="#CCCCCC"> have</font><font color="#E5E5E5"> been patched</font>

89
00:04:45,060 --> 00:04:50,210
<font color="#E5E5E5">and this altogether</font><font color="#CCCCCC"> adds</font><font color="#E5E5E5"> into the</font>

90
00:04:47,430 --> 00:04:53,310
complexity of Windows systems and

91
00:04:50,210 --> 00:04:55,200
obviously what we always<font color="#E5E5E5"> want</font><font color="#CCCCCC"> to achieve</font>

92
00:04:53,310 --> 00:04:57,990
<font color="#E5E5E5">on a Windows system is to get</font>

93
00:04:55,200 --> 00:05:00,030
administrator<font color="#E5E5E5"> or system privileges which</font>

94
00:04:57,990 --> 00:05:02,370
are the highest privileges<font color="#E5E5E5"> in Windows</font>

95
00:05:00,030 --> 00:05:07,229
systems<font color="#E5E5E5"> the equivalent to the root</font>

96
00:05:02,370 --> 00:05:11,730
account<font color="#CCCCCC"> in</font><font color="#E5E5E5"> Linux so one of the most</font>

97
00:05:07,230 --> 00:05:16,860
important components<font color="#CCCCCC"> of Windows is the</font>

98
00:05:11,730 --> 00:05:19,050
registry the<font color="#CCCCCC"> registry is built in a tree</font>

99
00:05:16,860 --> 00:05:21,690
structure where you have a root key<font color="#E5E5E5"> at</font>

100
00:05:19,050 --> 00:05:24,660
the<font color="#E5E5E5"> top the highest level keys are</font>

101
00:05:21,690 --> 00:05:28,920
called<font color="#CCCCCC"> root</font><font color="#E5E5E5"> keys and it consists of keys</font>

102
00:05:24,660 --> 00:05:32,340
and values<font color="#E5E5E5"> and every key that has</font>

103
00:05:28,920 --> 00:05:36,000
<font color="#E5E5E5">another key or every key that is under</font>

104
00:05:32,340 --> 00:05:38,489
another key is called<font color="#E5E5E5"> sub key so as you</font>

105
00:05:36,000 --> 00:05:41,820
<font color="#E5E5E5">can</font><font color="#CCCCCC"> see on the right side of the slide</font>

106
00:05:38,490 --> 00:05:45,060
we have the<font color="#E5E5E5"> different the five root keys</font>

107
00:05:41,820 --> 00:05:47,550
of a Windows<font color="#E5E5E5"> system what does the</font>

108
00:05:45,060 --> 00:05:49,440
registry store amongst other things<font color="#CCCCCC"> it's</font>

109
00:05:47,550 --> 00:05:53,310
lost<font color="#E5E5E5"> system-wide software settings</font>

110
00:05:49,440 --> 00:05:55,650
<font color="#E5E5E5">it contains the</font><font color="#CCCCCC"> security</font><font color="#E5E5E5"> database so all</font>

111
00:05:53,310 --> 00:05:58,680
the users passwords<font color="#E5E5E5"> all the user</font>

112
00:05:55,650 --> 00:06:00,239
passwords are stored in the registry not

113
00:05:58,680 --> 00:06:02,910
everyone<font color="#E5E5E5"> can access it you can only</font>

114
00:06:00,240 --> 00:06:05,430
exist it with system privileges but<font color="#E5E5E5"> this</font>

115
00:06:02,910 --> 00:06:08,250
is where it is<font color="#CCCCCC"> dot</font><font color="#E5E5E5"> and also it contains</font>

116
00:06:05,430 --> 00:06:11,100
<font color="#E5E5E5">per user configuration settings so if</font>

117
00:06:08,250 --> 00:06:13,740
you have more than one user or<font color="#CCCCCC"> even if</font>

118
00:06:11,100 --> 00:06:15,750
you have<font color="#E5E5E5"> only one user the settings that</font>

119
00:06:13,740 --> 00:06:19,140
are specific to<font color="#E5E5E5"> this user are also</font>

120
00:06:15,750 --> 00:06:22,560
stored in the registry<font color="#E5E5E5"> the</font><font color="#CCCCCC"> registry</font>

121
00:06:19,140 --> 00:06:25,080
<font color="#E5E5E5">itself is protected</font><font color="#CCCCCC"> by an access control</font>

122
00:06:22,560 --> 00:06:30,960
<font color="#CCCCCC">list so for every key you can have a</font>

123
00:06:25,080 --> 00:06:34,190
<font color="#E5E5E5">different ACL another important</font><font color="#CCCCCC"> aspect</font>

124
00:06:30,960 --> 00:06:38,880
<font color="#E5E5E5">of Windows systems are processes a</font>

125
00:06:34,190 --> 00:06:40,599
process in simple terms<font color="#E5E5E5"> consists of a</font>

126
00:06:38,880 --> 00:06:43,599
process ID

127
00:06:40,599 --> 00:06:47,860
an executable program<font color="#CCCCCC"> and the security</font>

128
00:06:43,599 --> 00:06:50,919
context<font color="#E5E5E5"> so</font><font color="#CCCCCC"> a security security context</font>

129
00:06:47,860 --> 00:06:53,020
<font color="#CCCCCC">are mainly</font><font color="#E5E5E5"> security tokens also called</font>

130
00:06:50,919 --> 00:06:56,229
access tokens<font color="#E5E5E5"> and it contains</font>

131
00:06:53,020 --> 00:07:00,719
information about<font color="#E5E5E5"> the user the security</font>

132
00:06:56,229 --> 00:07:00,719
group and the privileges of<font color="#CCCCCC"> the process</font>

133
00:07:01,169 --> 00:07:06,248
now that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> know more about processes</font>

134
00:07:03,909 --> 00:07:10,360
<font color="#E5E5E5">what our jobs and threats to</font><font color="#CCCCCC"> them</font><font color="#E5E5E5"> job</font>

135
00:07:06,249 --> 00:07:11,919
<font color="#E5E5E5">jobs are simply groups of processes</font><font color="#CCCCCC"> so</font>

136
00:07:10,360 --> 00:07:14,979
as you can<font color="#CCCCCC"> see on the screen you have</font>

137
00:07:11,919 --> 00:07:16,959
the<font color="#E5E5E5"> process CMD dot X</font><font color="#CCCCCC"> ax and this</font>

138
00:07:14,979 --> 00:07:20,080
<font color="#E5E5E5">process again contains two other</font>

139
00:07:16,959 --> 00:07:24,309
processes<font color="#E5E5E5"> Khan hosted X and notepad or</font>

140
00:07:20,080 --> 00:07:29,219
Tex<font color="#E5E5E5"> and threads are entities within a</font>

141
00:07:24,309 --> 00:07:29,219
<font color="#E5E5E5">process that are computed by the CPU</font>

142
00:07:32,339 --> 00:07:37,360
services is another very important

143
00:07:34,749 --> 00:07:41,949
component<font color="#CCCCCC"> of Windows what our services</font>

144
00:07:37,360 --> 00:07:47,379
services are processes that<font color="#CCCCCC"> are that</font>

145
00:07:41,949 --> 00:07:50,469
start at system startup<font color="#E5E5E5"> so every time</font>

146
00:07:47,379 --> 00:07:53,860
you boot your PC different services are

147
00:07:50,469 --> 00:07:58,019
started and these<font color="#E5E5E5"> against that load</font>

148
00:07:53,860 --> 00:08:00,729
processes which again container

149
00:07:58,019 --> 00:08:04,119
<font color="#E5E5E5">executable file so every service also</font>

150
00:08:00,729 --> 00:08:07,119
<font color="#E5E5E5">has a executable file and these services</font>

151
00:08:04,119 --> 00:08:12,159
<font color="#E5E5E5">run under us in the context of a certain</font>

152
00:08:07,119 --> 00:08:17,529
<font color="#E5E5E5">user meaning that every service can have</font>

153
00:08:12,159 --> 00:08:19,688
a certain<font color="#E5E5E5"> user in which the this with</font>

154
00:08:17,529 --> 00:08:23,680
the privileges of<font color="#E5E5E5"> a certain user which</font>

155
00:08:19,689 --> 00:08:25,389
the service can use most of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> accounts</font>

156
00:08:23,680 --> 00:08:28,269
that are<font color="#E5E5E5"> used for services are non</font>

157
00:08:25,389 --> 00:08:30,039
<font color="#E5E5E5">interactive accounts</font><font color="#CCCCCC"> so-called</font><font color="#E5E5E5"> service</font>

158
00:08:28,269 --> 00:08:37,179
accounts which we'll talk about shortly

159
00:08:30,039 --> 00:08:40,149
<font color="#CCCCCC">and normally or most services only</font><font color="#E5E5E5"> just</font>

160
00:08:37,179 --> 00:08:43,359
run in the in the context<font color="#E5E5E5"> of a system</font>

161
00:08:40,149 --> 00:08:47,529
user so with the highest privileges<font color="#E5E5E5"> in</font>

162
00:08:43,360 --> 00:08:49,990
the system<font color="#E5E5E5"> Windows offers three</font>

163
00:08:47,529 --> 00:08:52,510
different service accounts first<font color="#E5E5E5"> of all</font>

164
00:08:49,990 --> 00:08:54,400
the<font color="#E5E5E5"> local system account which is the</font>

165
00:08:52,510 --> 00:08:57,550
<font color="#CCCCCC">which is</font><font color="#E5E5E5"> also called</font>

166
00:08:54,400 --> 00:08:59,410
the system account<font color="#CCCCCC"> as we said it has the</font>

167
00:08:57,550 --> 00:09:01,740
highest<font color="#E5E5E5"> privileges on</font><font color="#CCCCCC"> the system</font><font color="#E5E5E5"> and you</font>

168
00:08:59,410 --> 00:09:05,050
<font color="#E5E5E5">can do everything with this account</font>

169
00:09:01,740 --> 00:09:08,020
<font color="#E5E5E5">although</font><font color="#CCCCCC"> some privileges are not</font><font color="#E5E5E5"> enabled</font>

170
00:09:05,050 --> 00:09:09,939
<font color="#CCCCCC">by default for the system</font><font color="#E5E5E5"> account or the</font>

171
00:09:08,020 --> 00:09:13,529
local system account<font color="#E5E5E5"> you have the</font>

172
00:09:09,940 --> 00:09:16,600
<font color="#E5E5E5">privilege to enable other privileges so</font>

173
00:09:13,529 --> 00:09:20,500
eventually<font color="#E5E5E5"> you can have every privilege</font>

174
00:09:16,600 --> 00:09:23,160
<font color="#CCCCCC">out there</font><font color="#E5E5E5"> and yeah most core windows</font>

175
00:09:20,500 --> 00:09:26,230
components run under the system<font color="#E5E5E5"> account</font>

176
00:09:23,160 --> 00:09:28,510
so if you would find a vulnerability<font color="#E5E5E5"> in</font>

177
00:09:26,230 --> 00:09:32,890
<font color="#E5E5E5">such a</font><font color="#CCCCCC"> Windows component then you will</font>

178
00:09:28,510 --> 00:09:35,260
directly have system privileges the

179
00:09:32,890 --> 00:09:38,350
second account is the network service

180
00:09:35,260 --> 00:09:40,779
account<font color="#E5E5E5"> this also contains high</font>

181
00:09:38,350 --> 00:09:43,930
privileges<font color="#E5E5E5"> less than the system account</font>

182
00:09:40,779 --> 00:09:45,760
<font color="#E5E5E5">but still high privileges and what the</font>

183
00:09:43,930 --> 00:09:49,660
network service account is<font color="#E5E5E5"> used for is</font>

184
00:09:45,760 --> 00:09:53,200
<font color="#CCCCCC">to authenticate against other network</font>

185
00:09:49,660 --> 00:09:55,240
services<font color="#E5E5E5"> and then last</font><font color="#CCCCCC"> but not least we</font>

186
00:09:53,200 --> 00:09:58,120
have<font color="#E5E5E5"> the local service account</font><font color="#CCCCCC"> which has</font>

187
00:09:55,240 --> 00:10:00,370
<font color="#E5E5E5">the same privileges as the network</font>

188
00:09:58,120 --> 00:10:03,459
service account except<font color="#E5E5E5"> that you cannot</font>

189
00:10:00,370 --> 00:10:09,550
use<font color="#CCCCCC"> it for network for</font><font color="#E5E5E5"> authenticating to</font>

190
00:10:03,459 --> 00:10:12,099
other network services and the last two

191
00:10:09,550 --> 00:10:15,160
<font color="#E5E5E5">things that are important are startup</font>

192
00:10:12,100 --> 00:10:17,200
programs and scheduler tasks so<font color="#CCCCCC"> that our</font>

193
00:10:15,160 --> 00:10:20,260
programs<font color="#E5E5E5"> and scheduled tasks are very</font>

194
00:10:17,200 --> 00:10:22,779
similar<font color="#E5E5E5"> to services the difference</font>

195
00:10:20,260 --> 00:10:25,600
between<font color="#CCCCCC"> sada programs and services is</font>

196
00:10:22,779 --> 00:10:28,560
that services<font color="#E5E5E5"> are managed by the service</font>

197
00:10:25,600 --> 00:10:33,459
manager<font color="#E5E5E5"> whereas other programs are not</font>

198
00:10:28,560 --> 00:10:37,390
and scheduler tasks are processes<font color="#CCCCCC"> that</font>

199
00:10:33,459 --> 00:10:41,109
run at a certain<font color="#E5E5E5"> time</font><font color="#CCCCCC"> or after</font><font color="#E5E5E5"> a certain</font>

200
00:10:37,390 --> 00:10:43,209
period of<font color="#CCCCCC"> time yeah and both</font><font color="#E5E5E5"> of these</font>

201
00:10:41,110 --> 00:10:46,209
run under again in the context of<font color="#E5E5E5"> a</font>

202
00:10:43,209 --> 00:10:49,979
certain user<font color="#E5E5E5"> so what we want to do in</font>

203
00:10:46,209 --> 00:10:53,469
the later stages we will find out more

204
00:10:49,980 --> 00:10:56,110
we want to<font color="#E5E5E5"> attack those</font><font color="#CCCCCC"> SATA</font><font color="#E5E5E5"> programs</font>

205
00:10:53,470 --> 00:11:00,180
and those scheduled tasks that<font color="#E5E5E5"> run in</font>

206
00:10:56,110 --> 00:11:00,180
the context of<font color="#E5E5E5"> a high privileged user</font>

207
00:11:00,990 --> 00:11:07,570
that's it about<font color="#E5E5E5"> the windows components</font>

208
00:11:04,930 --> 00:11:09,040
let's dive into the<font color="#E5E5E5"> different</font>

209
00:11:07,570 --> 00:11:14,560
<font color="#E5E5E5">privilege escalation methods and</font>

210
00:11:09,040 --> 00:11:17,140
techniques<font color="#CCCCCC"> so just as an overview</font><font color="#E5E5E5"> there</font>

211
00:11:14,560 --> 00:11:20,109
<font color="#E5E5E5">as we said there are things in Windows</font>

212
00:11:17,140 --> 00:11:21,580
<font color="#CCCCCC">that are similar to</font><font color="#E5E5E5"> other things there</font>

213
00:11:20,110 --> 00:11:24,610
are components that<font color="#E5E5E5"> are similar to other</font>

214
00:11:21,580 --> 00:11:26,740
components<font color="#CCCCCC"> and</font><font color="#E5E5E5"> that's why some attacks</font>

215
00:11:24,610 --> 00:11:30,450
<font color="#CCCCCC">and some</font><font color="#E5E5E5"> methods may be used</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> only</font>

216
00:11:26,740 --> 00:11:33,670
<font color="#CCCCCC">for one</font><font color="#E5E5E5"> component but for several and</font>

217
00:11:30,450 --> 00:11:37,270
what<font color="#E5E5E5"> I did is</font><font color="#CCCCCC"> to create attack trees</font>

218
00:11:33,670 --> 00:11:40,719
these it attack trees<font color="#E5E5E5"> can give an</font>

219
00:11:37,270 --> 00:11:44,410
overview<font color="#E5E5E5"> to you on which attacks you can</font>

220
00:11:40,720 --> 00:11:48,730
perform<font color="#E5E5E5"> and which different conditions</font>

221
00:11:44,410 --> 00:11:51,250
have to be met<font color="#E5E5E5"> so the first big attack</font>

222
00:11:48,730 --> 00:11:54,580
tree and you have to imagine this is the

223
00:11:51,250 --> 00:11:58,150
<font color="#E5E5E5">part of a very big attack tree is</font>

224
00:11:54,580 --> 00:12:00,340
<font color="#CCCCCC">unsecure services</font><font color="#E5E5E5"> so in this part of the</font>

225
00:11:58,150 --> 00:12:03,790
attack tree we want to attack insecure

226
00:12:00,340 --> 00:12:06,610
<font color="#E5E5E5">or miss configurated services and as you</font>

227
00:12:03,790 --> 00:12:10,060
can<font color="#E5E5E5"> see</font><font color="#CCCCCC"> in the second row we have</font><font color="#E5E5E5"> five</font>

228
00:12:06,610 --> 00:12:11,830
five<font color="#CCCCCC"> different techniques</font><font color="#E5E5E5"> the first</font><font color="#CCCCCC"> one</font>

229
00:12:10,060 --> 00:12:14,619
is<font color="#E5E5E5"> weak service executable or</font>

230
00:12:11,830 --> 00:12:17,230
configuration<font color="#E5E5E5"> file permissions</font><font color="#CCCCCC"> unquoted</font>

231
00:12:14,620 --> 00:12:20,980
service paths<font color="#E5E5E5"> weak service permissions</font>

232
00:12:17,230 --> 00:12:25,690
<font color="#E5E5E5">the</font><font color="#CCCCCC"> ad</font><font color="#E5E5E5"> l hijacking and weak registry key</font>

233
00:12:20,980 --> 00:12:28,180
permissions as you can see in the third

234
00:12:25,690 --> 00:12:30,880
row<font color="#E5E5E5"> for instance for</font><font color="#CCCCCC"> uncoated services</font>

235
00:12:28,180 --> 00:12:33,280
path service paths<font color="#E5E5E5"> we have again two</font>

236
00:12:30,880 --> 00:12:40,180
<font color="#E5E5E5">conditions and we</font><font color="#CCCCCC"> will talk</font><font color="#E5E5E5"> about it in</font>

237
00:12:33,280 --> 00:12:43,300
the<font color="#CCCCCC"> next slides so the first method or</font>

238
00:12:40,180 --> 00:12:46,209
technique is the weak executable file

239
00:12:43,300 --> 00:12:49,719
permissions<font color="#E5E5E5"> so as we said every service</font>

240
00:12:46,210 --> 00:12:52,960
has executable file that it runs what we

241
00:12:49,720 --> 00:12:55,990
could try to<font color="#E5E5E5"> search for</font><font color="#CCCCCC"> is to find a</font>

242
00:12:52,960 --> 00:13:00,970
executable<font color="#CCCCCC"> file that runs in a high</font>

243
00:12:55,990 --> 00:13:04,480
privileged service<font color="#E5E5E5"> that we can</font><font color="#CCCCCC"> modify so</font>

244
00:13:00,970 --> 00:13:08,530
as you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> see in the blue figure we the</font>

245
00:13:04,480 --> 00:13:12,970
<font color="#E5E5E5">the service is called waves waves this</font>

246
00:13:08,530 --> 00:13:17,079
<font color="#E5E5E5">SVC which is a</font><font color="#CCCCCC"> soundmanager</font><font color="#E5E5E5"> tool for</font>

247
00:13:12,970 --> 00:13:19,120
their laptops and it it<font color="#E5E5E5"> runs under</font><font color="#CCCCCC"> the</font>

248
00:13:17,080 --> 00:13:19,960
local system account so the<font color="#E5E5E5"> highest</font>

249
00:13:19,120 --> 00:13:22,510
privilege

250
00:13:19,960 --> 00:13:25,930
<font color="#CCCCCC">I don't really</font><font color="#E5E5E5"> know why a sound manager</font>

251
00:13:22,510 --> 00:13:29,830
to<font color="#E5E5E5"> need system privileges but hey it's</font>

252
00:13:25,930 --> 00:13:32,819
good for<font color="#E5E5E5"> us and in the fourth row you</font>

253
00:13:29,830 --> 00:13:36,580
can<font color="#CCCCCC"> see we have the right attributes and</font>

254
00:13:32,820 --> 00:13:40,870
every user of<font color="#E5E5E5"> the group built-in users</font>

255
00:13:36,580 --> 00:13:43,840
<font color="#E5E5E5">can modify the file so we with</font><font color="#CCCCCC"> our low</font>

256
00:13:40,870 --> 00:13:47,860
<font color="#E5E5E5">privilege user can go ahead and just</font>

257
00:13:43,840 --> 00:13:51,340
<font color="#CCCCCC">modify or replace the file and put in</font>

258
00:13:47,860 --> 00:13:54,910
our malicious code the next time this

259
00:13:51,340 --> 00:13:57,160
service is started<font color="#E5E5E5"> the our malicious</font>

260
00:13:54,910 --> 00:14:01,959
payload will be executed with system

261
00:13:57,160 --> 00:14:06,339
privileges how do<font color="#E5E5E5"> we restart</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> service</font>

262
00:14:01,960 --> 00:14:09,130
<font color="#E5E5E5">we could either reboot the system or we</font>

263
00:14:06,340 --> 00:14:15,300
could if we<font color="#CCCCCC"> have the privileges use the</font>

264
00:14:09,130 --> 00:14:18,460
SC tool to<font color="#E5E5E5"> restart the service another</font>

265
00:14:15,300 --> 00:14:21,699
interesting method the unquoted service

266
00:14:18,460 --> 00:14:24,700
path method for the<font color="#E5E5E5"> uncoated service</font>

267
00:14:21,700 --> 00:14:29,350
path method<font color="#E5E5E5"> what you need our services</font>

268
00:14:24,700 --> 00:14:31,810
that<font color="#CCCCCC"> have that user file path which does</font>

269
00:14:29,350 --> 00:14:33,400
not contain<font color="#CCCCCC"> a double quote so now no</font>

270
00:14:31,810 --> 00:14:36,969
double<font color="#E5E5E5"> quotes at the beginning and at</font>

271
00:14:33,400 --> 00:14:39,490
<font color="#CCCCCC">the end and that</font><font color="#E5E5E5"> contain a white space</font>

272
00:14:36,970 --> 00:14:42,760
somewhere in the file path<font color="#E5E5E5"> so as an</font>

273
00:14:39,490 --> 00:14:48,040
example we<font color="#CCCCCC"> have</font><font color="#E5E5E5"> C backslash program</font>

274
00:14:42,760 --> 00:14:51,030
<font color="#E5E5E5">white space files backslash waves</font><font color="#CCCCCC"> etc so</font>

275
00:14:48,040 --> 00:14:53,439
both<font color="#E5E5E5"> conditions are met in this example</font>

276
00:14:51,030 --> 00:14:55,839
what does<font color="#E5E5E5"> Windows do and this is</font>

277
00:14:53,440 --> 00:14:59,440
something<font color="#CCCCCC"> very weird I don't really know</font>

278
00:14:55,840 --> 00:15:02,440
why it<font color="#E5E5E5"> does it but</font><font color="#CCCCCC"> it is how it</font><font color="#E5E5E5"> works it</font>

279
00:14:59,440 --> 00:15:06,760
tries to execute<font color="#CCCCCC"> the file</font><font color="#E5E5E5"> C backslash</font>

280
00:15:02,440 --> 00:15:07,120
program dot<font color="#E5E5E5"> Excel what does this mean</font>

281
00:15:06,760 --> 00:15:09,819
for<font color="#E5E5E5"> us</font>

282
00:15:07,120 --> 00:15:12,250
<font color="#CCCCCC">it means if we have</font><font color="#E5E5E5"> write permissions to</font>

283
00:15:09,820 --> 00:15:14,830
<font color="#CCCCCC">the C directory</font><font color="#E5E5E5"> we could just create our</font>

284
00:15:12,250 --> 00:15:16,680
own program dot excel file<font color="#E5E5E5"> and then the</font>

285
00:15:14,830 --> 00:15:19,540
next time the file is the<font color="#E5E5E5"> services</font>

286
00:15:16,680 --> 00:15:22,900
loaded our malicious file will<font color="#CCCCCC"> be</font>

287
00:15:19,540 --> 00:15:27,910
executed instead of the file that<font color="#CCCCCC"> is</font>

288
00:15:22,900 --> 00:15:29,680
defined in the file path and I was kind

289
00:15:27,910 --> 00:15:32,420
of shocked when I noticed<font color="#CCCCCC"> that</font><font color="#E5E5E5"> my</font>

290
00:15:29,680 --> 00:15:35,660
previous<font color="#CCCCCC"> Dell</font><font color="#E5E5E5"> laptop that I got</font>

291
00:15:32,420 --> 00:15:38,300
had exactly<font color="#E5E5E5"> this vulnerability in it so</font>

292
00:15:35,660 --> 00:15:41,870
this<font color="#E5E5E5"> is how I got it from Dell and it</font>

293
00:15:38,300 --> 00:15:45,229
contains a service for<font color="#E5E5E5"> this wave Syst</font>

294
00:15:41,870 --> 00:15:47,330
SVC service which is also<font color="#E5E5E5"> a sound which</font>

295
00:15:45,230 --> 00:15:50,690
is a sound manager<font color="#CCCCCC"> tool and it didn't</font>

296
00:15:47,330 --> 00:15:52,940
contain<font color="#E5E5E5"> any quote any any quotes at the</font>

297
00:15:50,690 --> 00:15:55,070
beginning and at the<font color="#E5E5E5"> end and the same</font>

298
00:15:52,940 --> 00:15:57,710
applies for Lenovo<font color="#E5E5E5"> and think that some</font>

299
00:15:55,070 --> 00:16:05,240
<font color="#E5E5E5">years ago</font><font color="#CCCCCC"> there they had</font><font color="#E5E5E5"> this</font>

300
00:15:57,710 --> 00:16:07,430
vulnerability<font color="#E5E5E5"> another very</font><font color="#CCCCCC"> interesting</font>

301
00:16:05,240 --> 00:16:11,350
but a<font color="#E5E5E5"> little bit complex attack and</font>

302
00:16:07,430 --> 00:16:14,420
technique is called DLL hijacking<font color="#E5E5E5"> so</font>

303
00:16:11,350 --> 00:16:18,800
applications that are started normally

304
00:16:14,420 --> 00:16:22,490
try to run<font color="#CCCCCC"> DLL files at runtime</font><font color="#E5E5E5"> or load</font>

305
00:16:18,800 --> 00:16:25,339
DLL files at runtime<font color="#CCCCCC"> if the DLL file is</font>

306
00:16:22,490 --> 00:16:29,000
missing<font color="#CCCCCC"> meaning it tries to</font><font color="#E5E5E5"> load the</font><font color="#CCCCCC"> DFA</font>

307
00:16:25,340 --> 00:16:31,430
that does not exist<font color="#E5E5E5"> and it</font><font color="#CCCCCC"> uses</font><font color="#E5E5E5"> a</font>

308
00:16:29,000 --> 00:16:35,390
relative path<font color="#E5E5E5"> and not an absolute path</font>

309
00:16:31,430 --> 00:16:37,939
then we<font color="#CCCCCC"> might have a vulnerability</font><font color="#E5E5E5"> so</font>

310
00:16:35,390 --> 00:16:40,910
what does Windows<font color="#E5E5E5"> do if a</font><font color="#CCCCCC"> dll file is</font>

311
00:16:37,940 --> 00:16:43,790
missing<font color="#CCCCCC"> it tries to search for the DLL</font>

312
00:16:40,910 --> 00:16:47,449
<font color="#E5E5E5">in certain folders it starts with the</font>

313
00:16:43,790 --> 00:16:51,530
<font color="#CCCCCC">Applications folder</font><font color="#E5E5E5"> then goes</font><font color="#CCCCCC"> to see</font>

314
00:16:47,450 --> 00:16:53,720
windows system32<font color="#E5E5E5"> see windows system see</font>

315
00:16:51,530 --> 00:16:56,780
windows and then the current working

316
00:16:53,720 --> 00:16:59,360
directory<font color="#E5E5E5"> and after that it searches for</font>

317
00:16:56,780 --> 00:17:04,660
<font color="#E5E5E5">the</font><font color="#CCCCCC"> DLL file in all the</font><font color="#E5E5E5"> directories that</font>

318
00:16:59,360 --> 00:17:07,250
<font color="#E5E5E5">are in the</font><font color="#CCCCCC"> system path variable so and</font>

319
00:17:04,660 --> 00:17:09,320
this<font color="#CCCCCC"> is exactly where we could try to</font>

320
00:17:07,250 --> 00:17:13,040
<font color="#E5E5E5">find</font><font color="#CCCCCC"> a bypass or where we could try</font><font color="#E5E5E5"> to</font>

321
00:17:09,319 --> 00:17:15,708
<font color="#E5E5E5">find and exploit</font><font color="#CCCCCC"> if we go through all</font>

322
00:17:13,040 --> 00:17:18,579
<font color="#E5E5E5">the directories that that are defined in</font>

323
00:17:15,709 --> 00:17:21,079
<font color="#CCCCCC">the system</font><font color="#E5E5E5"> path variable and we find the</font>

324
00:17:18,579 --> 00:17:23,419
directory where<font color="#CCCCCC"> we have right</font><font color="#E5E5E5"> access to</font>

325
00:17:21,079 --> 00:17:26,750
then we can just write our own file<font color="#CCCCCC"> name</font>

326
00:17:23,420 --> 00:17:29,510
<font color="#E5E5E5">our own</font><font color="#CCCCCC"> DLL file into the directory and</font>

327
00:17:26,750 --> 00:17:35,620
the next time<font color="#E5E5E5"> the program is started it</font>

328
00:17:29,510 --> 00:17:35,620
will it will<font color="#E5E5E5"> load our malicious DLL file</font>

329
00:17:39,210 --> 00:17:45,360
that's it about services<font color="#E5E5E5"> just a quick</font>

330
00:17:42,850 --> 00:17:47,860
glimpse into<font color="#E5E5E5"> start-up programs</font>

331
00:17:45,360 --> 00:17:50,020
<font color="#CCCCCC">Sutter programs as we said are similar</font>

332
00:17:47,860 --> 00:17:52,810
to services and that's<font color="#E5E5E5"> why we have three</font>

333
00:17:50,020 --> 00:17:57,129
techniques<font color="#E5E5E5"> that</font><font color="#CCCCCC"> also apply for unsecure</font>

334
00:17:52,810 --> 00:18:01,750
services and the same applies for

335
00:17:57,130 --> 00:18:05,700
scheduler tasks for scheduler tasks<font color="#E5E5E5"> as</font>

336
00:18:01,750 --> 00:18:09,220
we all<font color="#E5E5E5"> know a certain time period has to</font>

337
00:18:05,700 --> 00:18:11,280
<font color="#E5E5E5">pass by or a certain time our scheduler</font>

338
00:18:09,220 --> 00:18:15,100
tasks are executed at a certain time

339
00:18:11,280 --> 00:18:20,290
<font color="#E5E5E5">what can we do if this do we have to</font>

340
00:18:15,100 --> 00:18:22,990
wait<font color="#CCCCCC"> until this time really</font><font color="#E5E5E5"> and until</font>

341
00:18:20,290 --> 00:18:26,770
this time happens or until<font color="#E5E5E5"> this until</font>

342
00:18:22,990 --> 00:18:28,930
this time comes<font color="#E5E5E5"> no we probably don't</font>

343
00:18:26,770 --> 00:18:31,720
<font color="#E5E5E5">have to do which</font><font color="#CCCCCC"> you could try is to</font>

344
00:18:28,930 --> 00:18:34,420
just change the system time<font color="#E5E5E5"> if you have</font>

345
00:18:31,720 --> 00:18:37,300
the privilege<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do that so you would</font>

346
00:18:34,420 --> 00:18:39,550
change<font color="#E5E5E5"> the system time to the time the</font>

347
00:18:37,300 --> 00:18:44,919
scheduler task will be executed<font color="#E5E5E5"> and then</font>

348
00:18:39,550 --> 00:18:48,870
it will be<font color="#E5E5E5"> executed immediately one very</font>

349
00:18:44,920 --> 00:18:52,240
<font color="#CCCCCC">obvious but probably very successful</font>

350
00:18:48,870 --> 00:18:55,840
method is to exploit outdated<font color="#CCCCCC"> software</font>

351
00:18:52,240 --> 00:18:57,880
so<font color="#CCCCCC"> we you have to kind of software that</font>

352
00:18:55,840 --> 00:19:00,100
<font color="#E5E5E5">you would want to exploit first of all</font>

353
00:18:57,880 --> 00:19:03,760
you want to exploit software or

354
00:19:00,100 --> 00:19:07,570
vulnerable software that runs with high

355
00:19:03,760 --> 00:19:09,460
privileges<font color="#E5E5E5"> and you want to execute and</font>

356
00:19:07,570 --> 00:19:11,439
you<font color="#E5E5E5"> want to exploit would not the</font>

357
00:19:09,460 --> 00:19:13,330
<font color="#CCCCCC">windows</font><font color="#E5E5E5"> kernel if possible why the</font>

358
00:19:11,440 --> 00:19:14,890
<font color="#CCCCCC">windows kernel</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> if you exploit</font>

359
00:19:13,330 --> 00:19:19,629
the<font color="#E5E5E5"> windows kernel you will have system</font>

360
00:19:14,890 --> 00:19:22,720
privileges right away why is this very

361
00:19:19,630 --> 00:19:25,240
successful because<font color="#E5E5E5"> companies mostly are</font>

362
00:19:22,720 --> 00:19:27,430
very slow in<font color="#CCCCCC"> deploying patches maybe</font>

363
00:19:25,240 --> 00:19:30,600
<font color="#E5E5E5">because they have many different</font><font color="#CCCCCC"> systems</font>

364
00:19:27,430 --> 00:19:36,190
<font color="#E5E5E5">or maybe they have very critical systems</font>

365
00:19:30,600 --> 00:19:37,990
<font color="#E5E5E5">that</font><font color="#CCCCCC"> need many that need to be tested or</font>

366
00:19:36,190 --> 00:19:39,820
where the patches<font color="#CCCCCC"> have to be</font><font color="#E5E5E5"> tested</font>

367
00:19:37,990 --> 00:19:42,580
before<font color="#E5E5E5"> they</font><font color="#CCCCCC"> are deployed into production</font>

368
00:19:39,820 --> 00:19:45,450
<font color="#CCCCCC">and</font><font color="#E5E5E5"> that this opens the gap for us</font>

369
00:19:42,580 --> 00:19:45,449
<font color="#E5E5E5">attackers</font>

370
00:19:48,059 --> 00:19:54,269
also very obvious weak passwords but<font color="#E5E5E5"> I</font>

371
00:19:50,159 --> 00:19:56,940
will tell<font color="#CCCCCC"> you a story</font><font color="#E5E5E5"> shortly so</font><font color="#CCCCCC"> which</font>

372
00:19:54,269 --> 00:19:59,039
<font color="#E5E5E5">you could have you could find the act</font>

373
00:19:56,940 --> 00:20:02,129
you<font color="#E5E5E5"> would you will gain access</font><font color="#CCCCCC"> to a</font>

374
00:19:59,039 --> 00:20:04,649
system which<font color="#E5E5E5"> has</font><font color="#CCCCCC"> a web server and this</font>

375
00:20:02,129 --> 00:20:07,199
web server connects to a database<font color="#E5E5E5"> so</font>

376
00:20:04,649 --> 00:20:09,658
what you will do is to search<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> web</font>

377
00:20:07,200 --> 00:20:11,849
server directories for the password<font color="#CCCCCC"> of</font>

378
00:20:09,659 --> 00:20:15,330
the database for<font color="#E5E5E5"> the user password and</font>

379
00:20:11,849 --> 00:20:18,090
some administrators<font color="#E5E5E5"> use the same</font>

380
00:20:15,330 --> 00:20:21,478
password for<font color="#E5E5E5"> everything they do so this</font>

381
00:20:18,090 --> 00:20:24,509
would be a<font color="#E5E5E5"> very simple technique to just</font>

382
00:20:21,479 --> 00:20:26,460
try this<font color="#E5E5E5"> - just take the password and</font>

383
00:20:24,509 --> 00:20:28,710
try it<font color="#E5E5E5"> for the login of the</font>

384
00:20:26,460 --> 00:20:31,519
administrator account<font color="#CCCCCC"> other specific</font>

385
00:20:28,710 --> 00:20:34,529
admit yes specific administrator account

386
00:20:31,519 --> 00:20:38,669
<font color="#E5E5E5">also</font><font color="#CCCCCC"> you could try</font><font color="#E5E5E5"> wordless attacks or</font>

387
00:20:34,529 --> 00:20:42,049
<font color="#E5E5E5">brute force attacks as we all know what</font>

388
00:20:38,669 --> 00:20:44,820
sometimes happens is that<font color="#E5E5E5"> besides the</font>

389
00:20:42,049 --> 00:20:47,158
database<font color="#E5E5E5"> configuration file</font><font color="#CCCCCC"> that you</font>

390
00:20:44,820 --> 00:20:50,309
will find plaintext password passwords

391
00:20:47,159 --> 00:20:52,139
in<font color="#CCCCCC"> Windows configuration files or in</font>

392
00:20:50,309 --> 00:20:54,690
<font color="#E5E5E5">Windows XML files</font>

393
00:20:52,139 --> 00:20:57,539
so these are some paths<font color="#E5E5E5"> where you would</font>

394
00:20:54,690 --> 00:21:00,210
probably make where<font color="#E5E5E5"> you might might find</font>

395
00:20:57,539 --> 00:21:04,379
a password<font color="#CCCCCC"> and once I was</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> a</font>

396
00:21:00,210 --> 00:21:05,519
assessment for a big<font color="#E5E5E5"> German bank and I</font>

397
00:21:04,379 --> 00:21:08,549
had<font color="#E5E5E5"> the test</font>

398
00:21:05,519 --> 00:21:10,499
<font color="#E5E5E5">I got an employee laptop and I had the</font>

399
00:21:08,549 --> 00:21:13,320
test<font color="#E5E5E5"> to find a way to escalate my</font>

400
00:21:10,499 --> 00:21:15,450
privileges<font color="#E5E5E5"> so I tried all the hard stuff</font>

401
00:21:13,320 --> 00:21:17,639
I tried it<font color="#E5E5E5"> with this</font><font color="#CCCCCC"> the DLL hijacking</font>

402
00:21:15,450 --> 00:21:19,739
<font color="#CCCCCC">unquote the services pass and I tried</font>

403
00:21:17,639 --> 00:21:21,359
many different<font color="#E5E5E5"> things</font><font color="#CCCCCC"> but I didn't</font>

404
00:21:19,739 --> 00:21:25,229
<font color="#E5E5E5">really find a way to escalate my</font>

405
00:21:21,359 --> 00:21:27,779
privileges<font color="#E5E5E5"> so what I thought is maybe</font>

406
00:21:25,229 --> 00:21:29,759
I'll try<font color="#CCCCCC"> just</font><font color="#E5E5E5"> the easy things and I</font>

407
00:21:27,779 --> 00:21:30,809
<font color="#E5E5E5">searched for</font><font color="#CCCCCC"> a plaintext passwords and</font>

408
00:21:29,759 --> 00:21:34,169
tada

409
00:21:30,809 --> 00:21:38,070
<font color="#CCCCCC">I found a password and this</font><font color="#E5E5E5"> password was</font>

410
00:21:34,169 --> 00:21:41,129
not<font color="#E5E5E5"> only used for</font><font color="#CCCCCC"> a local</font><font color="#E5E5E5"> user or local</font>

411
00:21:38,070 --> 00:21:46,349
administrator it was used for<font color="#E5E5E5"> the domain</font>

412
00:21:41,129 --> 00:21:49,139
admin that means with this password<font color="#CCCCCC"> that</font>

413
00:21:46,349 --> 00:21:52,168
every<font color="#CCCCCC"> employee of</font><font color="#E5E5E5"> the bank has</font><font color="#CCCCCC"> on his</font>

414
00:21:49,139 --> 00:21:53,789
laptop<font color="#CCCCCC"> he could directly access the CEOs</font>

415
00:21:52,169 --> 00:21:56,339
laptop you could<font color="#E5E5E5"> access the</font>

416
00:21:53,789 --> 00:22:00,540
administrator laptops until it is a very

417
00:21:56,339 --> 00:22:03,030
very low hanging fruit so yeah<font color="#E5E5E5"> such</font>

418
00:22:00,540 --> 00:22:04,800
stuff happens so<font color="#E5E5E5"> don't only only go for</font>

419
00:22:03,030 --> 00:22:07,950
<font color="#CCCCCC">the</font><font color="#E5E5E5"> complex things also go for the low</font>

420
00:22:04,800 --> 00:22:09,659
hanging fruits<font color="#E5E5E5"> and besides files you</font>

421
00:22:07,950 --> 00:22:12,030
could also find passwords<font color="#CCCCCC"> in the</font>

422
00:22:09,660 --> 00:22:14,430
registry<font color="#CCCCCC"> so for instance if auto log-in</font>

423
00:22:12,030 --> 00:22:20,460
is enabled<font color="#E5E5E5"> in Windows</font><font color="#CCCCCC"> you might find</font>

424
00:22:14,430 --> 00:22:23,760
passwords<font color="#E5E5E5"> there also another</font><font color="#CCCCCC"> possibility</font>

425
00:22:20,460 --> 00:22:27,060
<font color="#CCCCCC">is if we have</font><font color="#E5E5E5"> physical access</font><font color="#CCCCCC"> to a</font>

426
00:22:23,760 --> 00:22:29,940
machine<font color="#CCCCCC"> be it a laptop</font><font color="#E5E5E5"> computer</font><font color="#CCCCCC"> or a</font>

427
00:22:27,060 --> 00:22:34,290
server<font color="#E5E5E5"> then we could try other attacks</font>

428
00:22:29,940 --> 00:22:36,420
<font color="#E5E5E5">so first of all all</font><font color="#CCCCCC"> those of you who do</font>

429
00:22:34,290 --> 00:22:39,570
not use disk encryption<font color="#E5E5E5"> use this</font>

430
00:22:36,420 --> 00:22:41,910
encryption<font color="#E5E5E5"> why because if I get access</font>

431
00:22:39,570 --> 00:22:46,980
to your laptop<font color="#CCCCCC"> I</font><font color="#E5E5E5"> can just put</font><font color="#CCCCCC"> my own</font>

432
00:22:41,910 --> 00:22:49,950
<font color="#CCCCCC">Windows CD replace some files in your</font>

433
00:22:46,980 --> 00:22:52,080
<font color="#E5E5E5">file system and the next time I'll boot</font>

434
00:22:49,950 --> 00:22:53,640
up your machine I<font color="#E5E5E5"> will have system</font>

435
00:22:52,080 --> 00:22:56,520
<font color="#E5E5E5">privileges and have access</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> your</font>

436
00:22:53,640 --> 00:23:02,940
machine<font color="#E5E5E5"> so it's a very easy</font><font color="#CCCCCC"> thing and</font>

437
00:22:56,520 --> 00:23:06,050
it's widely<font color="#E5E5E5"> known however if you use</font>

438
00:23:02,940 --> 00:23:08,070
<font color="#E5E5E5">this encryption but you do not have</font>

439
00:23:06,050 --> 00:23:10,680
pre-boot authentication

440
00:23:08,070 --> 00:23:12,750
<font color="#CCCCCC">what is pre-boot authentication pre-boot</font>

441
00:23:10,680 --> 00:23:16,140
authentication means<font color="#E5E5E5"> that whenever you</font>

442
00:23:12,750 --> 00:23:19,920
start your laptop that<font color="#CCCCCC"> you have to</font><font color="#E5E5E5"> enter</font>

443
00:23:16,140 --> 00:23:23,190
your<font color="#CCCCCC"> password - which is used</font><font color="#E5E5E5"> for the</font>

444
00:23:19,920 --> 00:23:27,660
decryption<font color="#E5E5E5"> of the volume if you do not</font>

445
00:23:23,190 --> 00:23:29,370
use this meaning<font color="#E5E5E5"> that the decryption key</font>

446
00:23:27,660 --> 00:23:32,550
is thought somewhere on the motherboard

447
00:23:29,370 --> 00:23:35,340
<font color="#E5E5E5">and is loaded into the memory when</font>

448
00:23:32,550 --> 00:23:37,230
starting the machine<font color="#E5E5E5"> this means that an</font>

449
00:23:35,340 --> 00:23:40,409
attacker could try to extract the

450
00:23:37,230 --> 00:23:42,540
decryption key<font color="#CCCCCC"> from</font><font color="#E5E5E5"> the memory</font><font color="#CCCCCC"> and there</font>

451
00:23:40,410 --> 00:23:47,070
are many attacks that were performed

452
00:23:42,540 --> 00:23:50,190
within in in some research in some

453
00:23:47,070 --> 00:23:52,710
research universities and they were<font color="#E5E5E5"> able</font>

454
00:23:50,190 --> 00:23:54,720
to successfully<font color="#E5E5E5"> dump the memory and</font>

455
00:23:52,710 --> 00:23:56,550
extract the decryption key<font color="#E5E5E5"> and then</font>

456
00:23:54,720 --> 00:23:58,740
access your machine<font color="#E5E5E5"> and if you have the</font>

457
00:23:56,550 --> 00:24:01,470
decryption<font color="#E5E5E5"> key</font><font color="#CCCCCC"> I can again do the same</font>

458
00:23:58,740 --> 00:24:03,060
technique<font color="#CCCCCC"> I can just replace some files</font>

459
00:24:01,470 --> 00:24:07,650
<font color="#E5E5E5">on your machine and</font><font color="#CCCCCC"> then have system</font>

460
00:24:03,060 --> 00:24:10,639
privileges another thing a possibility

461
00:24:07,650 --> 00:24:13,260
would be<font color="#E5E5E5"> attacks against CPU</font>

462
00:24:10,640 --> 00:24:14,370
microcontrollers<font color="#E5E5E5"> we all heard of</font><font color="#CCCCCC"> Specter</font>

463
00:24:13,260 --> 00:24:17,730
we all heard

464
00:24:14,370 --> 00:24:19,770
meltdown<font color="#CCCCCC"> and although no proof of</font>

465
00:24:17,730 --> 00:24:21,510
concept was published<font color="#E5E5E5"> it might be</font>

466
00:24:19,770 --> 00:24:26,059
possible<font color="#CCCCCC"> that out there in the wild</font>

467
00:24:21,510 --> 00:24:29,190
someone has some exploit which which

468
00:24:26,059 --> 00:24:35,160
which executes some malicious code<font color="#E5E5E5"> on</font>

469
00:24:29,190 --> 00:24:37,170
your<font color="#E5E5E5"> Intel or AMD microcontroller so in</font>

470
00:24:35,160 --> 00:24:41,070
the beginning I asked you how a few<font color="#CCCCCC"> uses</font>

471
00:24:37,170 --> 00:24:43,650
disk encryption<font color="#CCCCCC"> hope uses a password</font><font color="#E5E5E5"> if</font>

472
00:24:41,070 --> 00:24:46,350
you use a<font color="#CCCCCC"> password that's</font><font color="#E5E5E5"> already very</font>

473
00:24:43,650 --> 00:24:49,050
good<font color="#E5E5E5"> but nevertheless if you use disk</font>

474
00:24:46,350 --> 00:24:51,689
encryption<font color="#E5E5E5"> three days ago there was a</font>

475
00:24:49,050 --> 00:24:55,309
new<font color="#E5E5E5"> research published by a Dutch</font>

476
00:24:51,690 --> 00:24:58,350
<font color="#CCCCCC">university which showed that many</font>

477
00:24:55,309 --> 00:25:03,240
<font color="#CCCCCC">hardware encrypted devices are</font>

478
00:24:58,350 --> 00:25:05,100
vulnerable that's why if you<font color="#CCCCCC"> go home</font><font color="#E5E5E5"> try</font>

479
00:25:03,240 --> 00:25:09,000
this<font color="#E5E5E5"> command with administrator</font><font color="#CCCCCC"> rights</font>

480
00:25:05,100 --> 00:25:11,219
<font color="#E5E5E5">and check whether you</font><font color="#CCCCCC"> have a software</font>

481
00:25:09,000 --> 00:25:12,720
encryption<font color="#CCCCCC"> or whether you have a</font>

482
00:25:11,220 --> 00:25:14,700
hardware encryption<font color="#CCCCCC"> if you have a</font>

483
00:25:12,720 --> 00:25:17,929
hardware encryption<font color="#CCCCCC"> it might be possible</font>

484
00:25:14,700 --> 00:25:17,929
that<font color="#CCCCCC"> you are vulnerable</font>

485
00:25:19,400 --> 00:25:24,360
so we learnt a little<font color="#E5E5E5"> bit some</font>

486
00:25:22,650 --> 00:25:27,240
techniques and<font color="#E5E5E5"> methods there are many</font>

487
00:25:24,360 --> 00:25:30,020
more out<font color="#E5E5E5"> there if you're interested</font><font color="#CCCCCC"> come</font>

488
00:25:27,240 --> 00:25:33,450
<font color="#E5E5E5">to me after the talk</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> we can talk but</font>

489
00:25:30,020 --> 00:25:35,370
one very<font color="#E5E5E5"> important thing is I know there</font>

490
00:25:33,450 --> 00:25:38,400
are so many different<font color="#CCCCCC"> methods and</font><font color="#E5E5E5"> so</font>

491
00:25:35,370 --> 00:25:40,320
many techniques<font color="#CCCCCC"> how do I apply them how</font>

492
00:25:38,400 --> 00:25:43,440
<font color="#E5E5E5">can I have a structured and practical</font>

493
00:25:40,320 --> 00:25:45,830
way to<font color="#CCCCCC"> use them in an</font><font color="#E5E5E5"> assessment for</font>

494
00:25:43,440 --> 00:25:50,130
instance and that's why we need a

495
00:25:45,830 --> 00:25:52,530
practical<font color="#E5E5E5"> and systematic approach this</font>

496
00:25:50,130 --> 00:25:54,900
is how the approach looks like we have

497
00:25:52,530 --> 00:25:57,030
<font color="#CCCCCC">three different</font><font color="#E5E5E5"> phases the first phase</font>

498
00:25:54,900 --> 00:26:00,090
<font color="#E5E5E5">is the general information</font><font color="#CCCCCC"> gathering</font>

499
00:25:57,030 --> 00:26:03,300
phase<font color="#E5E5E5"> the second phase is</font><font color="#CCCCCC"> the method and</font>

500
00:26:00,090 --> 00:26:06,000
technique<font color="#E5E5E5"> iteration where we again have</font>

501
00:26:03,300 --> 00:26:10,260
four different<font color="#E5E5E5"> steps and as you can see</font>

502
00:26:06,000 --> 00:26:11,910
<font color="#CCCCCC">we stay in the in Phase two</font><font color="#E5E5E5"> because we</font>

503
00:26:10,260 --> 00:26:14,340
iterate through the<font color="#E5E5E5"> different methods</font>

504
00:26:11,910 --> 00:26:18,240
<font color="#CCCCCC">we'll talk about</font><font color="#E5E5E5"> it shortly</font><font color="#CCCCCC"> and then</font>

505
00:26:14,340 --> 00:26:20,070
phase 3<font color="#E5E5E5"> we have the reporting phase so</font>

506
00:26:18,240 --> 00:26:22,620
in phase<font color="#E5E5E5"> one what we really want to</font>

507
00:26:20,070 --> 00:26:25,889
<font color="#E5E5E5">achieve is to get a good overview of the</font>

508
00:26:22,620 --> 00:26:27,469
<font color="#CCCCCC">system we</font><font color="#E5E5E5"> want to know which we know sir</font>

509
00:26:25,890 --> 00:26:30,289
which<font color="#CCCCCC"> Windows version</font>

510
00:26:27,470 --> 00:26:32,270
is it we<font color="#E5E5E5"> want to know which</font><font color="#CCCCCC"> cpu</font>

511
00:26:30,289 --> 00:26:34,250
architecture is<font color="#CCCCCC"> used</font><font color="#E5E5E5"> we want to know</font>

512
00:26:32,270 --> 00:26:36,168
which service pack is<font color="#CCCCCC"> used</font><font color="#E5E5E5"> we want to</font>

513
00:26:34,250 --> 00:26:39,289
know about network devices<font color="#E5E5E5"> and</font>

514
00:26:36,169 --> 00:26:41,240
interfaces and<font color="#E5E5E5"> so</font><font color="#CCCCCC"> on and so forth so we</font>

515
00:26:39,289 --> 00:26:48,620
want to learn<font color="#E5E5E5"> more</font><font color="#CCCCCC"> about the system</font><font color="#E5E5E5"> in</font>

516
00:26:41,240 --> 00:26:52,789
<font color="#CCCCCC">general after that we will</font><font color="#E5E5E5"> go</font><font color="#CCCCCC"> into phase</font>

517
00:26:48,620 --> 00:26:54,439
<font color="#CCCCCC">2 in phase 2 as I just said</font><font color="#E5E5E5"> we will</font>

518
00:26:52,789 --> 00:26:59,690
iterate through the<font color="#E5E5E5"> different techniques</font>

519
00:26:54,440 --> 00:27:02,330
and methods and you can choose<font color="#E5E5E5"> the</font>

520
00:26:59,690 --> 00:27:03,919
techniques and<font color="#CCCCCC"> methods</font><font color="#E5E5E5"> according to your</font>

521
00:27:02,330 --> 00:27:06,439
goal<font color="#E5E5E5"> for instance if you have an</font>

522
00:27:03,919 --> 00:27:09,530
<font color="#CCCCCC">assessment where the goal</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> to find as</font>

523
00:27:06,440 --> 00:27:12,280
many<font color="#E5E5E5"> privilege escalation possibilities</font>

524
00:27:09,530 --> 00:27:17,059
as possible then<font color="#E5E5E5"> you could start</font><font color="#CCCCCC"> with</font>

525
00:27:12,280 --> 00:27:19,820
more complex<font color="#E5E5E5"> ones if you</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> the goal</font>

526
00:27:17,059 --> 00:27:22,280
<font color="#CCCCCC">to just get to escalate your</font><font color="#E5E5E5"> privileges</font>

527
00:27:19,820 --> 00:27:24,250
<font color="#E5E5E5">and then attack other systems you could</font>

528
00:27:22,280 --> 00:27:27,610
choose<font color="#CCCCCC"> the most easiest one</font><font color="#E5E5E5"> of the most</font>

529
00:27:24,250 --> 00:27:30,830
<font color="#E5E5E5">probably</font><font color="#CCCCCC"> the most successful ones and</font>

530
00:27:27,610 --> 00:27:34,010
yeah as<font color="#CCCCCC"> we said every iteration</font><font color="#E5E5E5"> consists</font>

531
00:27:30,830 --> 00:27:36,740
of<font color="#E5E5E5"> four different step in step one we</font>

532
00:27:34,010 --> 00:27:39,830
<font color="#E5E5E5">have again a small information gathering</font>

533
00:27:36,740 --> 00:27:42,230
phase or as information gathering step

534
00:27:39,830 --> 00:27:45,379
<font color="#E5E5E5">what we want to achieve here is to find</font>

535
00:27:42,230 --> 00:27:48,080
<font color="#E5E5E5">out is the system vulnerable against the</font>

536
00:27:45,380 --> 00:27:49,460
technique that<font color="#CCCCCC"> I want to use for</font>

537
00:27:48,080 --> 00:27:51,649
instance if you want<font color="#E5E5E5"> to check</font><font color="#CCCCCC"> for</font>

538
00:27:49,460 --> 00:27:53,450
<font color="#E5E5E5">uncoated service paths then we will</font>

539
00:27:51,650 --> 00:27:57,799
check every service for our uncoated

540
00:27:53,450 --> 00:28:02,059
service path if the system is<font color="#CCCCCC"> vulnerable</font>

541
00:27:57,799 --> 00:28:04,668
we will go to<font color="#CCCCCC"> step two</font><font color="#E5E5E5"> in step two</font><font color="#CCCCCC"> we</font>

542
00:28:02,059 --> 00:28:07,460
will conduct our research<font color="#E5E5E5"> and we will</font>

543
00:28:04,669 --> 00:28:08,600
<font color="#CCCCCC">develop our exploit</font><font color="#E5E5E5"> so we want for</font>

544
00:28:07,460 --> 00:28:11,450
<font color="#CCCCCC">instance if there is</font><font color="#E5E5E5"> an outdated</font>

545
00:28:08,600 --> 00:28:14,299
software<font color="#E5E5E5"> we want to</font><font color="#CCCCCC"> gather everything</font>

546
00:28:11,450 --> 00:28:16,309
<font color="#E5E5E5">about the system</font><font color="#CCCCCC"> we want to know</font><font color="#E5E5E5"> more</font>

547
00:28:14,299 --> 00:28:19,070
<font color="#CCCCCC">about the exploit understand the exploit</font>

548
00:28:16,309 --> 00:28:21,950
and then maybe customize our exploits

549
00:28:19,070 --> 00:28:23,750
<font color="#E5E5E5">according to our a system so we have</font><font color="#CCCCCC"> to</font>

550
00:28:21,950 --> 00:28:26,179
know<font color="#E5E5E5"> which architecture is</font><font color="#CCCCCC"> used and</font>

551
00:28:23,750 --> 00:28:30,830
which service pack and so on and so

552
00:28:26,179 --> 00:28:33,860
forth<font color="#E5E5E5"> sometimes</font><font color="#CCCCCC"> it is necessary</font><font color="#E5E5E5"> to set</font>

553
00:28:30,830 --> 00:28:36,799
up a test environment<font color="#CCCCCC"> why because some</font>

554
00:28:33,860 --> 00:28:39,080
<font color="#E5E5E5">services can</font><font color="#CCCCCC"> be exploited only once</font><font color="#E5E5E5"> and</font>

555
00:28:36,799 --> 00:28:42,350
if they exploit fails<font color="#E5E5E5"> the system</font>

556
00:28:39,080 --> 00:28:45,080
<font color="#CCCCCC">fresh</font><font color="#E5E5E5"> so you want to be sure that you</font>

557
00:28:42,350 --> 00:28:47,000
exploit<font color="#E5E5E5"> works and that's why it would</font><font color="#CCCCCC"> be</font>

558
00:28:45,080 --> 00:28:49,668
<font color="#E5E5E5">good to set up a test environment that</font>

559
00:28:47,000 --> 00:28:53,059
is very<font color="#E5E5E5"> like this is very</font><font color="#CCCCCC"> similar</font><font color="#E5E5E5"> to the</font>

560
00:28:49,669 --> 00:28:55,130
target system that you're attacking also

561
00:28:53,059 --> 00:28:58,940
you should consider possible<font color="#CCCCCC"> security</font>

562
00:28:55,130 --> 00:29:01,640
mechanisms<font color="#E5E5E5"> so let's say is there an</font>

563
00:28:58,940 --> 00:29:03,950
<font color="#CCCCCC">antivirus</font><font color="#E5E5E5"> software and the PC if there</font>

564
00:29:01,640 --> 00:29:07,399
is an<font color="#E5E5E5"> anti-virus software</font><font color="#CCCCCC"> then we have</font>

565
00:29:03,950 --> 00:29:10,059
to apply<font color="#E5E5E5"> different</font><font color="#CCCCCC"> evasion techniques</font>

566
00:29:07,399 --> 00:29:12,918
<font color="#E5E5E5">and modify I hope our payload so that</font>

567
00:29:10,059 --> 00:29:17,480
the antivirus system does not<font color="#E5E5E5"> detect it</font>

568
00:29:12,919 --> 00:29:20,840
<font color="#E5E5E5">also</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> want to then if we</font><font color="#E5E5E5"> use a</font>

569
00:29:17,480 --> 00:29:23,840
payload<font color="#E5E5E5"> that builds a reverse TCP shell</font>

570
00:29:20,840 --> 00:29:26,840
<font color="#E5E5E5">do they use a firewall and if they use a</font>

571
00:29:23,840 --> 00:29:29,510
firewall<font color="#E5E5E5"> which</font><font color="#CCCCCC"> pots are</font><font color="#E5E5E5"> most likely to</font>

572
00:29:26,840 --> 00:29:32,658
be open what<font color="#CCCCCC"> four four three</font>

573
00:29:29,510 --> 00:29:35,809
so<font color="#E5E5E5"> these things are</font><font color="#CCCCCC"> part</font><font color="#E5E5E5"> eighty</font><font color="#CCCCCC"> so these</font>

574
00:29:32,659 --> 00:29:38,840
things are dependent<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> environment</font>

575
00:29:35,809 --> 00:29:42,620
so these<font color="#E5E5E5"> things are should be considered</font>

576
00:29:38,840 --> 00:29:45,830
when<font color="#CCCCCC"> you develop your exploit in step</font>

577
00:29:42,620 --> 00:29:48,820
<font color="#CCCCCC">three</font><font color="#E5E5E5"> we want to exploit our we want to</font>

578
00:29:45,830 --> 00:29:51,439
test our exploit so we use our exploit

579
00:29:48,820 --> 00:29:54,379
sometimes it works right<font color="#E5E5E5"> it works right</font>

580
00:29:51,440 --> 00:29:57,710
<font color="#E5E5E5">away but in most cases you will have to</font>

581
00:29:54,380 --> 00:29:59,690
go back<font color="#E5E5E5"> and see what failed</font><font color="#CCCCCC"> check</font><font color="#E5E5E5"> again</font>

582
00:29:57,710 --> 00:30:02,000
rebuild your exploit and then explode

583
00:29:59,690 --> 00:30:05,210
test again<font color="#CCCCCC"> to exploit until eventually</font>

584
00:30:02,000 --> 00:30:07,760
it<font color="#E5E5E5"> will hopefully work</font><font color="#CCCCCC"> and in the post</font>

585
00:30:05,210 --> 00:30:11,330
exploitation phase of every technique

586
00:30:07,760 --> 00:30:15,260
<font color="#E5E5E5">you</font><font color="#CCCCCC"> should document every step and every</font>

587
00:30:11,330 --> 00:30:17,449
result<font color="#E5E5E5"> and also you could check with</font>

588
00:30:15,260 --> 00:30:20,510
<font color="#E5E5E5">system administrators or network</font>

589
00:30:17,450 --> 00:30:22,519
<font color="#E5E5E5">administrator's hey I just escalated my</font>

590
00:30:20,510 --> 00:30:24,950
privileges<font color="#E5E5E5"> did you notice anything</font>

591
00:30:22,519 --> 00:30:27,399
<font color="#E5E5E5">because this is very valuable for</font>

592
00:30:24,950 --> 00:30:31,429
companies sometimes<font color="#E5E5E5"> companies pay</font>

593
00:30:27,399 --> 00:30:35,418
millions for different yeah

594
00:30:31,429 --> 00:30:37,250
security software systems<font color="#E5E5E5"> and in the end</font>

595
00:30:35,419 --> 00:30:40,789
they don't<font color="#E5E5E5"> even</font><font color="#CCCCCC"> work</font><font color="#E5E5E5"> and this is</font>

596
00:30:37,250 --> 00:30:45,080
valuable<font color="#E5E5E5"> information for them so yeah we</font>

597
00:30:40,789 --> 00:30:49,520
go through every technique<font color="#E5E5E5"> and every</font>

598
00:30:45,080 --> 00:30:52,428
<font color="#E5E5E5">method that there is and in step in</font>

599
00:30:49,520 --> 00:30:52,929
<font color="#CCCCCC">Phase</font><font color="#E5E5E5"> three</font><font color="#CCCCCC"> the reporting phase as in</font>

600
00:30:52,429 --> 00:30:55,690
every

601
00:30:52,929 --> 00:30:58,059
<font color="#E5E5E5">penetration test</font><font color="#CCCCCC"> any vulnerability</font>

602
00:30:55,690 --> 00:31:00,369
should be reported independently on

603
00:30:58,059 --> 00:31:03,249
whether it worked<font color="#E5E5E5"> or it didn't work</font>

604
00:31:00,369 --> 00:31:05,799
sometimes you<font color="#E5E5E5"> have a vulnerable service</font>

605
00:31:03,249 --> 00:31:07,869
but<font color="#E5E5E5"> you cannot exploit it because you</font>

606
00:31:05,799 --> 00:31:10,089
<font color="#E5E5E5">don't have the time or because</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> other</font>

607
00:31:07,869 --> 00:31:12,189
things<font color="#CCCCCC"> nevertheless you should</font><font color="#E5E5E5"> report it</font>

608
00:31:10,089 --> 00:31:17,049
<font color="#CCCCCC">you could should document it</font><font color="#E5E5E5"> so that the</font>

609
00:31:12,190 --> 00:31:20,499
customer can<font color="#CCCCCC"> patch or fix the</font>

610
00:31:17,049 --> 00:31:21,940
vulnerability also passwords and

611
00:31:20,499 --> 00:31:24,009
sensitive later should always be

612
00:31:21,940 --> 00:31:27,159
censored<font color="#E5E5E5"> so you don't know who will get</font>

613
00:31:24,009 --> 00:31:29,169
access to the report<font color="#CCCCCC"> so and you</font><font color="#E5E5E5"> don't</font>

614
00:31:27,159 --> 00:31:31,619
want the<font color="#E5E5E5"> domain admin password to be</font>

615
00:31:29,169 --> 00:31:34,149
known<font color="#E5E5E5"> to everyone right</font>

616
00:31:31,619 --> 00:31:36,759
also<font color="#E5E5E5"> sometimes what could happen is that</font>

617
00:31:34,149 --> 00:31:38,949
<font color="#E5E5E5">you get</font><font color="#CCCCCC"> access to</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> system and notice</font>

618
00:31:36,759 --> 00:31:41,169
<font color="#E5E5E5">hey someone else was already on</font><font color="#CCCCCC"> this</font>

619
00:31:38,950 --> 00:31:43,749
system<font color="#CCCCCC"> like there was another exploit</font>

620
00:31:41,169 --> 00:31:44,469
already in the in some folder or

621
00:31:43,749 --> 00:31:46,859
something like<font color="#E5E5E5"> that</font>

622
00:31:44,469 --> 00:31:49,450
and if this is<font color="#E5E5E5"> the case you should</font>

623
00:31:46,859 --> 00:31:52,960
immediately<font color="#CCCCCC"> contact the customer and</font>

624
00:31:49,450 --> 00:31:55,389
then discuss how<font color="#CCCCCC"> to go with it</font><font color="#E5E5E5"> and also</font>

625
00:31:52,960 --> 00:31:57,789
<font color="#E5E5E5">always document all the exploits that</font>

626
00:31:55,389 --> 00:32:00,399
<font color="#E5E5E5">you</font><font color="#CCCCCC"> used and the users that you edit</font>

627
00:31:57,789 --> 00:32:02,049
because<font color="#E5E5E5"> they should be removed and if</font>

628
00:32:00,399 --> 00:32:06,428
you can remove them yourself then this

629
00:32:02,049 --> 00:32:09,729
would be<font color="#E5E5E5"> the best case so this is the</font>

630
00:32:06,429 --> 00:32:16,710
approach there<font color="#CCCCCC"> are</font><font color="#E5E5E5"> some tools which we</font>

631
00:32:09,729 --> 00:32:20,409
can use<font color="#E5E5E5"> to simplify the approach so we</font>

632
00:32:16,710 --> 00:32:23,559
<font color="#CCCCCC">have I have</font><font color="#E5E5E5"> men I mentioned for tools</font>

633
00:32:20,409 --> 00:32:26,259
there are<font color="#E5E5E5"> many more out there but you</font>

634
00:32:23,559 --> 00:32:30,190
could conduct your own<font color="#CCCCCC"> research and try</font>

635
00:32:26,259 --> 00:32:33,820
them out<font color="#E5E5E5"> I found these four very useful</font>

636
00:32:30,190 --> 00:32:35,409
in my<font color="#CCCCCC"> from my</font><font color="#E5E5E5"> experience but yeah</font><font color="#CCCCCC"> just</font>

637
00:32:33,820 --> 00:32:37,418
<font color="#E5E5E5">try them out and check whether they are</font>

638
00:32:35,409 --> 00:32:39,999
good for you or not<font color="#CCCCCC"> so the</font><font color="#E5E5E5"> first one is</font>

639
00:32:37,419 --> 00:32:45,429
obviously<font color="#CCCCCC"> Metasploit Metasploit comes</font>

640
00:32:39,999 --> 00:32:47,229
with a lot of enumeration<font color="#CCCCCC"> tools and yeah</font>

641
00:32:45,429 --> 00:32:51,249
methods which you could use<font color="#CCCCCC"> in a Windows</font>

642
00:32:47,229 --> 00:32:54,639
<font color="#CCCCCC">environment</font><font color="#E5E5E5"> also another very powerful</font>

643
00:32:51,249 --> 00:32:58,749
<font color="#E5E5E5">tool is power sploit so let's say</font>

644
00:32:54,639 --> 00:33:00,668
unquoted services path or the<font color="#CCCCCC"> week</font>

645
00:32:58,749 --> 00:33:03,789
service executable file permissions

646
00:33:00,669 --> 00:33:05,320
there are scripts<font color="#E5E5E5"> which do the research</font>

647
00:33:03,789 --> 00:33:07,120
<font color="#E5E5E5">for you so you don't have to do it</font>

648
00:33:05,320 --> 00:33:10,100
<font color="#E5E5E5">yourself</font>

649
00:33:07,120 --> 00:33:12,020
also there is<font color="#CCCCCC"> a tool called B</font><font color="#E5E5E5"> root which</font>

650
00:33:10,100 --> 00:33:14,510
<font color="#CCCCCC">is similar to power sploit not that</font>

651
00:33:12,020 --> 00:33:16,940
<font color="#CCCCCC">powerful but also fulfills its purpose</font>

652
00:33:14,510 --> 00:33:21,950
<font color="#CCCCCC">and you have the Windows</font><font color="#E5E5E5"> exploit</font>

653
00:33:16,940 --> 00:33:25,790
<font color="#E5E5E5">suggester which you can use to you you</font>

654
00:33:21,950 --> 00:33:28,340
will first dump the last applied patches

655
00:33:25,790 --> 00:33:30,260
on the system and then use the<font color="#CCCCCC"> Windows</font>

656
00:33:28,340 --> 00:33:32,360
exploit<font color="#CCCCCC"> suggester to find out whether</font>

657
00:33:30,260 --> 00:33:34,040
the latest patches<font color="#E5E5E5"> have been applied or</font>

658
00:33:32,360 --> 00:33:36,580
whether there are<font color="#CCCCCC"> patches missing on the</font>

659
00:33:34,040 --> 00:33:36,580
target system

660
00:33:36,640 --> 00:33:45,770
so to conclude what<font color="#E5E5E5"> we have just</font><font color="#CCCCCC"> learned</font>

661
00:33:44,000 --> 00:33:48,770
<font color="#E5E5E5">can not only be used by penetration</font>

662
00:33:45,770 --> 00:33:51,740
testers<font color="#E5E5E5"> but also by network or</font><font color="#CCCCCC"> system</font>

663
00:33:48,770 --> 00:33:56,270
administrators by architects who<font color="#CCCCCC"> build</font>

664
00:33:51,740 --> 00:33:59,419
<font color="#E5E5E5">Windows systems and generally</font><font color="#CCCCCC"> speaking</font>

665
00:33:56,270 --> 00:34:02,120
about Windows Windows<font color="#E5E5E5"> offers a great</font>

666
00:33:59,419 --> 00:34:04,580
number<font color="#CCCCCC"> of security mechanisms</font><font color="#E5E5E5"> so we have</font>

667
00:34:02,120 --> 00:34:07,668
<font color="#CCCCCC">different many different security tools</font>

668
00:34:04,580 --> 00:34:11,869
that you can use you have a very

669
00:34:07,669 --> 00:34:14,600
granular configuration of<font color="#CCCCCC"> accesses</font><font color="#E5E5E5"> and</font>

670
00:34:11,869 --> 00:34:17,480
privileges<font color="#E5E5E5"> as we just saw you could</font>

671
00:34:14,600 --> 00:34:21,710
apply an ACL for every<font color="#E5E5E5"> different for</font>

672
00:34:17,480 --> 00:34:24,560
every<font color="#E5E5E5"> single registry key and also in</font>

673
00:34:21,710 --> 00:34:27,199
most cases patches are deployed<font color="#E5E5E5"> in a</font>

674
00:34:24,560 --> 00:34:31,070
fast<font color="#CCCCCC"> manner</font><font color="#E5E5E5"> so it</font><font color="#CCCCCC"> doesn't take</font><font color="#E5E5E5"> windows</font>

675
00:34:27,199 --> 00:34:34,009
too long to publish exploits<font color="#CCCCCC"> I know</font>

676
00:34:31,070 --> 00:34:38,000
there are<font color="#CCCCCC"> exceptions but</font><font color="#E5E5E5"> this is the</font>

677
00:34:34,010 --> 00:34:40,790
normal case so hopefully<font color="#CCCCCC"> we have</font><font color="#E5E5E5"> learned</font>

678
00:34:38,000 --> 00:34:43,639
things<font color="#E5E5E5"> about Windows about</font><font color="#CCCCCC"> privilege</font>

679
00:34:40,790 --> 00:34:46,969
<font color="#E5E5E5">escalation methods and techniques about</font>

680
00:34:43,639 --> 00:34:50,600
an approach that<font color="#E5E5E5"> we can use during our</font>

681
00:34:46,969 --> 00:34:54,770
assessments and tools<font color="#E5E5E5"> that we can then</font>

682
00:34:50,600 --> 00:34:57,950
<font color="#CCCCCC">use and the next time</font><font color="#E5E5E5"> I'm sure this will</font>

683
00:34:54,770 --> 00:35:00,850
<font color="#CCCCCC">be you well that</font><font color="#E5E5E5"> escalated quickly</font>

684
00:34:57,950 --> 00:35:00,850
<font color="#E5E5E5">thank you everyone</font>

685
00:35:04,700 --> 00:35:14,930
<font color="#E5E5E5">all right thank</font><font color="#CCCCCC"> you so much Khalil</font><font color="#E5E5E5"> so we</font>

686
00:35:08,250 --> 00:35:16,829
have our first question<font color="#E5E5E5"> here's the first</font>

687
00:35:14,930 --> 00:35:21,480
<font color="#E5E5E5">ask two questions</font>

688
00:35:16,829 --> 00:35:22,470
sure so and exploit regarding the

689
00:35:21,480 --> 00:35:26,010
unquoted

690
00:35:22,470 --> 00:35:29,669
path<font color="#CCCCCC"> you said that Windows first looks</font>

691
00:35:26,010 --> 00:35:33,750
for<font color="#E5E5E5"> seed double dot slash slash program</font>

692
00:35:29,670 --> 00:35:38,599
taxi is that generally true or does it

693
00:35:33,750 --> 00:35:41,910
<font color="#E5E5E5">look</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> any kind of program after</font><font color="#CCCCCC"> this</font>

694
00:35:38,599 --> 00:35:46,260
<font color="#E5E5E5">before the first space like if we had C</font>

695
00:35:41,910 --> 00:35:48,690
dot dot slash slash<font color="#E5E5E5"> Facebook stuff does</font>

696
00:35:46,260 --> 00:35:50,460
it look for<font color="#E5E5E5"> Facebook exit</font><font color="#CCCCCC"> if there is a</font>

697
00:35:48,690 --> 00:35:52,470
white space<font color="#CCCCCC"> after it</font><font color="#E5E5E5"> it does</font><font color="#CCCCCC"> look for</font>

698
00:35:50,460 --> 00:35:54,240
Facebook<font color="#E5E5E5"> totally cool and the second</font>

699
00:35:52,470 --> 00:35:56,939
question<font color="#E5E5E5"> would be Windows comes with</font>

700
00:35:54,240 --> 00:35:59,250
some pre-loaded<font color="#E5E5E5"> and predefined services</font>

701
00:35:56,940 --> 00:36:02,609
you can't<font color="#E5E5E5"> really</font><font color="#CCCCCC"> stop if they don't</font>

702
00:35:59,250 --> 00:36:04,170
patch that service what do you do<font color="#CCCCCC"> I mean</font>

703
00:36:02,609 --> 00:36:06,029
there's gonna be an exploit in your

704
00:36:04,170 --> 00:36:09,000
system<font color="#CCCCCC"> that you're gonna know about</font><font color="#E5E5E5"> can</font>

705
00:36:06,029 --> 00:36:12,119
you<font color="#CCCCCC"> mitigate that oh that's</font><font color="#E5E5E5"> a tough</font>

706
00:36:09,000 --> 00:36:18,809
question<font color="#CCCCCC"> so from a defender point of</font>

707
00:36:12,119 --> 00:36:22,470
view you<font color="#E5E5E5"> would have to hope</font><font color="#CCCCCC"> for Windows</font>

708
00:36:18,809 --> 00:36:24,869
to patch the system that's if you cannot

709
00:36:22,470 --> 00:36:30,089
change the service<font color="#E5E5E5"> you cannot disable it</font>

710
00:36:24,869 --> 00:36:33,869
<font color="#E5E5E5">then very hard what you could try to do</font>

711
00:36:30,089 --> 00:36:35,250
is to find other security tools<font color="#E5E5E5"> or like</font>

712
00:36:33,869 --> 00:36:37,740
<font color="#E5E5E5">antivirus software or something</font><font color="#CCCCCC"> like</font>

713
00:36:35,250 --> 00:36:41,010
that<font color="#CCCCCC"> which explicitly it looks whether</font>

714
00:36:37,740 --> 00:36:43,319
this file is replace or whatever the

715
00:36:41,010 --> 00:36:45,270
attack is so this is<font color="#E5E5E5"> maybe something</font>

716
00:36:43,319 --> 00:36:48,450
<font color="#E5E5E5">that you could do on</font><font color="#CCCCCC"> another</font><font color="#E5E5E5"> layer so</font>

717
00:36:45,270 --> 00:36:51,750
<font color="#CCCCCC">you</font><font color="#E5E5E5"> just like virtually patch this</font>

718
00:36:48,450 --> 00:36:53,879
vulnerability<font color="#E5E5E5"> but to have a really to</font>

719
00:36:51,750 --> 00:36:57,000
really<font color="#E5E5E5"> fix the root cause you would have</font>

720
00:36:53,880 --> 00:36:59,599
<font color="#CCCCCC">to</font><font color="#E5E5E5"> wait</font><font color="#CCCCCC"> for Windows Update</font><font color="#E5E5E5"> but one</font><font color="#CCCCCC"> very</font>

721
00:36:57,000 --> 00:37:02,670
interesting<font color="#E5E5E5"> thing is that</font><font color="#CCCCCC"> attackers</font>

722
00:36:59,599 --> 00:37:04,980
<font color="#E5E5E5">normally not penetration testers</font><font color="#CCCCCC"> but</font>

723
00:37:02,670 --> 00:37:07,140
they could<font color="#E5E5E5"> just do if they have access</font>

724
00:37:04,980 --> 00:37:09,539
<font color="#CCCCCC">to a Windows system and they are</font><font color="#E5E5E5"> not</font>

725
00:37:07,140 --> 00:37:12,480
able<font color="#E5E5E5"> to escalate their privileges just</font>

726
00:37:09,539 --> 00:37:14,300
build a<font color="#E5E5E5"> backdoor connection and wait</font>

727
00:37:12,480 --> 00:37:17,390
some months because

728
00:37:14,300 --> 00:37:20,770
from time to<font color="#CCCCCC"> time colonel exploits</font><font color="#E5E5E5"> our</font>

729
00:37:17,390 --> 00:37:23,000
Explorer<font color="#E5E5E5"> are published and</font><font color="#CCCCCC"> companies</font>

730
00:37:20,770 --> 00:37:25,460
most companies<font color="#E5E5E5"> will not notice a</font>

731
00:37:23,000 --> 00:37:27,590
backdoor<font color="#E5E5E5"> into their system so</font><font color="#CCCCCC"> you just</font>

732
00:37:25,460 --> 00:37:28,820
wait<font color="#CCCCCC"> until the next</font><font color="#E5E5E5"> exploit comes out</font>

733
00:37:27,590 --> 00:37:35,240
and then you<font color="#E5E5E5"> can escalate your</font>

734
00:37:28,820 --> 00:37:38,360
privileges thank you thank<font color="#E5E5E5"> you sir</font>

735
00:37:35,240 --> 00:37:44,390
<font color="#E5E5E5">there's another one yeah there so he was</font>

736
00:37:38,360 --> 00:37:48,290
<font color="#E5E5E5">the second sorry sir please</font><font color="#CCCCCC"> this is</font><font color="#E5E5E5"> the</font>

737
00:37:44,390 --> 00:37:51,230
easy one<font color="#CCCCCC"> you can answer with yes or no</font>

738
00:37:48,290 --> 00:38:03,110
<font color="#CCCCCC">did</font><font color="#E5E5E5"> you find any way to exploit the</font>

739
00:37:51,230 --> 00:38:05,540
specter<font color="#CCCCCC"> of vulnerability no thanks I'd</font>

740
00:38:03,110 --> 00:38:08,320
like to know in real<font color="#CCCCCC"> life how long does</font>

741
00:38:05,540 --> 00:38:13,060
it take to go to the whole<font color="#E5E5E5"> process of</font>

742
00:38:08,320 --> 00:38:16,010
scanning<font color="#E5E5E5"> the</font><font color="#CCCCCC"> computer and including</font>

743
00:38:13,060 --> 00:38:18,590
extending<font color="#E5E5E5"> your exploits and customizing</font>

744
00:38:16,010 --> 00:38:20,960
them for the target<font color="#CCCCCC"> machine because in</font>

745
00:38:18,590 --> 00:38:23,840
real life once an<font color="#CCCCCC"> attacker has physical</font>

746
00:38:20,960 --> 00:38:24,830
or remote access to a computer<font color="#E5E5E5"> well</font><font color="#CCCCCC"> he</font>

747
00:38:23,840 --> 00:38:28,160
kind of<font color="#CCCCCC"> won already</font>

748
00:38:24,830 --> 00:38:33,020
I don't really<font color="#E5E5E5"> know where you</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> but ah</font>

749
00:38:28,160 --> 00:38:35,540
<font color="#E5E5E5">there are great great</font><font color="#CCCCCC"> service</font><font color="#E5E5E5"> how long</font>

750
00:38:33,020 --> 00:38:38,390
does it take<font color="#E5E5E5"> depends sometimes</font><font color="#CCCCCC"> it can</font>

751
00:38:35,540 --> 00:38:42,710
take<font color="#E5E5E5"> minutes hours or even</font><font color="#CCCCCC"> weeks</font>

752
00:38:38,390 --> 00:38:44,900
so those there of you that did the<font color="#E5E5E5"> OS CP</font>

753
00:38:42,710 --> 00:38:47,360
certificate or want<font color="#E5E5E5"> to do it you will</font>

754
00:38:44,900 --> 00:38:48,890
<font color="#E5E5E5">get to know what I mean sometimes</font><font color="#CCCCCC"> you'll</font>

755
00:38:47,360 --> 00:38:50,780
find it right<font color="#E5E5E5"> away</font><font color="#CCCCCC"> and sometimes</font><font color="#E5E5E5"> you</font>

756
00:38:48,890 --> 00:38:52,640
<font color="#E5E5E5">have to enumerate and enumerate you</font>

757
00:38:50,780 --> 00:38:55,430
don't find<font color="#CCCCCC"> anything and then you have to</font>

758
00:38:52,640 --> 00:38:57,440
take a step back and again<font color="#E5E5E5"> search</font>

759
00:38:55,430 --> 00:38:59,899
through the system<font color="#E5E5E5"> gather information</font>

760
00:38:57,440 --> 00:39:04,360
and<font color="#E5E5E5"> then hopefully eventually</font><font color="#CCCCCC"> we'll find</font>

761
00:38:59,900 --> 00:39:04,360
it thank you

762
00:39:13,240 --> 00:39:20,930
so how<font color="#E5E5E5"> common is the unquoted service</font>

763
00:39:18,529 --> 00:39:25,520
path vulnerability because<font color="#E5E5E5"> developers</font>

764
00:39:20,930 --> 00:39:27,109
<font color="#E5E5E5">I guess if they put uncoated paths they</font>

765
00:39:25,520 --> 00:39:30,890
should be able<font color="#E5E5E5"> to notice that their</font>

766
00:39:27,109 --> 00:39:31,700
service won't start<font color="#CCCCCC"> when testing now it</font>

767
00:39:30,890 --> 00:39:34,490
should start

768
00:39:31,700 --> 00:39:37,460
I mean unported service paths<font color="#CCCCCC"> the</font><font color="#E5E5E5"> only</font>

769
00:39:34,490 --> 00:39:40,848
means<font color="#CCCCCC"> that windows additionally to the</font>

770
00:39:37,460 --> 00:39:43,339
file<font color="#CCCCCC"> you have defined</font><font color="#E5E5E5"> tries to load</font>

771
00:39:40,849 --> 00:39:46,119
other files<font color="#E5E5E5"> where the white space is</font>

772
00:39:43,339 --> 00:39:48,799
located<font color="#E5E5E5"> so if there is not such a file</font>

773
00:39:46,119 --> 00:39:51,200
<font color="#E5E5E5">windows continues to go through</font><font color="#CCCCCC"> the path</font>

774
00:39:48,799 --> 00:39:53,450
every white space it finds it will try

775
00:39:51,200 --> 00:39:55,520
to<font color="#E5E5E5"> fight to execute the file but if</font>

776
00:39:53,450 --> 00:39:59,029
there are<font color="#CCCCCC"> no more white</font><font color="#E5E5E5"> spaces it will</font>

777
00:39:55,520 --> 00:40:01,009
execute the file<font color="#E5E5E5"> that you want to use</font><font color="#CCCCCC"> ok</font>

778
00:39:59,029 --> 00:40:02,599
so first<font color="#CCCCCC"> it tries till the first white</font>

779
00:40:01,010 --> 00:40:05,900
space it doesn't find anything<font color="#E5E5E5"> then it</font>

780
00:40:02,599 --> 00:40:09,500
exact<font color="#E5E5E5"> museum exactly yes</font><font color="#CCCCCC"> alright thank</font>

781
00:40:05,900 --> 00:40:11,089
you<font color="#CCCCCC"> so you might find not you might</font><font color="#E5E5E5"> find</font>

782
00:40:09,500 --> 00:40:14,260
the direct you might<font color="#E5E5E5"> find the white</font>

783
00:40:11,089 --> 00:40:16,670
space<font color="#E5E5E5"> or</font><font color="#CCCCCC"> you might find two white spaces</font>

784
00:40:14,260 --> 00:40:18,559
where you<font color="#E5E5E5"> at the first white space</font>

785
00:40:16,670 --> 00:40:21,609
cannot write<font color="#E5E5E5"> a file but at the second</font>

786
00:40:18,559 --> 00:40:24,109
white space<font color="#E5E5E5"> so</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is also possible</font>

787
00:40:21,609 --> 00:40:30,109
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> thanks</font>

788
00:40:24,109 --> 00:40:31,848
we have<font color="#E5E5E5"> another one</font><font color="#CCCCCC"> here one</font><font color="#E5E5E5"> question</font>

789
00:40:30,109 --> 00:40:33,589
about the<font color="#CCCCCC"> inception when you think that</font>

790
00:40:31,849 --> 00:40:37,430
<font color="#CCCCCC">Windows who saw this</font><font color="#E5E5E5"> problem and not</font>

791
00:40:33,589 --> 00:40:43,069
only<font color="#CCCCCC"> Windows that can use to escalate</font>

792
00:40:37,430 --> 00:40:47,950
privileges in Windows Mac OS<font color="#CCCCCC"> Unix</font>

793
00:40:43,069 --> 00:40:51,589
everyone<font color="#E5E5E5"> and I</font><font color="#CCCCCC"> even saw that lately</font>

794
00:40:47,950 --> 00:40:56,689
<font color="#CCCCCC">adopted</font><font color="#E5E5E5"> also one module from</font><font color="#CCCCCC"> Metasploit</font>

795
00:40:51,589 --> 00:41:01,788
instead of the inception<font color="#CCCCCC"> for can create</font>

796
00:40:56,690 --> 00:41:04,099
reverse vectors<font color="#CCCCCC"> for connect</font><font color="#E5E5E5"> thank you</font>

797
00:41:01,789 --> 00:41:06,440
sorry I didn't<font color="#E5E5E5"> get the question</font><font color="#CCCCCC"> what was</font>

798
00:41:04,099 --> 00:41:08,420
<font color="#CCCCCC">the story</font><font color="#E5E5E5"> when you think will be solved</font>

799
00:41:06,440 --> 00:41:11,720
this problem<font color="#CCCCCC"> or because it's</font><font color="#E5E5E5"> four years</font>

800
00:41:08,420 --> 00:41:14,150
<font color="#CCCCCC">small yeah I think it will be never</font>

801
00:41:11,720 --> 00:41:16,848
solved so it will be always a race

802
00:41:14,150 --> 00:41:18,680
between hackers and defenders<font color="#CCCCCC"> I mean you</font>

803
00:41:16,849 --> 00:41:20,420
have to imagine an operating system<font color="#E5E5E5"> is</font>

804
00:41:18,680 --> 00:41:22,839
<font color="#E5E5E5">not a small program it contains of</font>

805
00:41:20,420 --> 00:41:25,240
<font color="#E5E5E5">millions of lines of code</font>

806
00:41:22,840 --> 00:41:29,260
even much much more<font color="#CCCCCC"> and you cannot</font>

807
00:41:25,240 --> 00:41:33,160
<font color="#E5E5E5">ensure that every developer knows what</font>

808
00:41:29,260 --> 00:41:36,010
he does and does<font color="#CCCCCC"> not and does everything</font>

809
00:41:33,160 --> 00:41:38,140
in the correct<font color="#CCCCCC"> way</font><font color="#E5E5E5"> and sometimes</font><font color="#CCCCCC"> it's</font>

810
00:41:36,010 --> 00:41:40,450
not<font color="#CCCCCC"> even the windows developers</font><font color="#E5E5E5"> but it's</font>

811
00:41:38,140 --> 00:41:42,730
also<font color="#E5E5E5"> software that you as a company</font>

812
00:41:40,450 --> 00:41:48,129
install on your employees laptops<font color="#E5E5E5"> or a</font>

813
00:41:42,730 --> 00:42:00,400
<font color="#CCCCCC">Mis configuration so in my</font><font color="#E5E5E5"> opinion it</font>

814
00:41:48,130 --> 00:42:03,070
<font color="#E5E5E5">will never stop thank you yeah so I got</font>

815
00:42:00,400 --> 00:42:05,230
a question<font color="#CCCCCC"> regarding the password should</font>

816
00:42:03,070 --> 00:42:07,990
<font color="#CCCCCC">we use better passwords</font><font color="#E5E5E5"> or is there a</font>

817
00:42:05,230 --> 00:42:12,100
recipe<font color="#E5E5E5"> for how we can secure</font><font color="#CCCCCC"> our</font>

818
00:42:07,990 --> 00:42:14,740
networks or our computers yeah<font color="#CCCCCC"> by which</font>

819
00:42:12,100 --> 00:42:16,839
I mean you<font color="#E5E5E5"> say is there a clear recipe</font>

820
00:42:14,740 --> 00:42:18,640
that we can<font color="#E5E5E5"> apply on all machines that</font>

821
00:42:16,840 --> 00:42:21,070
we can<font color="#E5E5E5"> ensure that there's kind of</font><font color="#CCCCCC"> not</font>

822
00:42:18,640 --> 00:42:24,120
<font color="#E5E5E5">never</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> be a privilege</font><font color="#CCCCCC"> of escalation</font>

823
00:42:21,070 --> 00:42:27,340
<font color="#CCCCCC">or</font><font color="#E5E5E5"> a possibility of exploit you</font><font color="#CCCCCC"> object</font>

824
00:42:24,120 --> 00:42:30,009
<font color="#E5E5E5">so from a defender perspective there are</font>

825
00:42:27,340 --> 00:42:33,610
<font color="#E5E5E5">tools there is</font><font color="#CCCCCC"> a tool I</font><font color="#E5E5E5"> don't really</font>

826
00:42:30,010 --> 00:42:35,920
remember the<font color="#CCCCCC"> name but what it does it it</font>

827
00:42:33,610 --> 00:42:37,750
sets the local administrator<font color="#E5E5E5"> passwords</font>

828
00:42:35,920 --> 00:42:39,610
on the laptops and it<font color="#E5E5E5"> changes it every</font>

829
00:42:37,750 --> 00:42:41,380
<font color="#E5E5E5">90</font><font color="#CCCCCC"> days or something</font><font color="#E5E5E5"> like that</font><font color="#CCCCCC"> and</font>

830
00:42:39,610 --> 00:42:44,590
generally<font color="#E5E5E5"> speaking you should always use</font>

831
00:42:41,380 --> 00:42:47,590
a password manager<font color="#E5E5E5"> and use complex</font>

832
00:42:44,590 --> 00:42:49,990
passwords<font color="#E5E5E5"> which you and only use one</font>

833
00:42:47,590 --> 00:42:52,240
password<font color="#CCCCCC"> for only one user</font><font color="#E5E5E5"> and not for</font>

834
00:42:49,990 --> 00:42:55,450
<font color="#E5E5E5">several users there are many guides out</font>

835
00:42:52,240 --> 00:42:58,299
there which<font color="#CCCCCC"> you could apply or ya</font>

836
00:42:55,450 --> 00:43:01,990
implement in<font color="#E5E5E5"> your group policies also as</font>

837
00:42:58,300 --> 00:43:03,970
Windows administrator so to say yeah

838
00:43:01,990 --> 00:43:06,339
this way you can ensure generally good

839
00:43:03,970 --> 00:43:12,669
<font color="#E5E5E5">OPSEC operational security for the</font>

840
00:43:06,340 --> 00:43:16,680
computers<font color="#E5E5E5"> yeah thank you do we have</font>

841
00:43:12,670 --> 00:43:20,710
others was there at a certain<font color="#E5E5E5"> point time</font>

842
00:43:16,680 --> 00:43:22,390
<font color="#CCCCCC">default service</font><font color="#E5E5E5"> vulnerability in Windows</font>

843
00:43:20,710 --> 00:43:24,070
<font color="#E5E5E5">that</font><font color="#CCCCCC"> could've been</font><font color="#E5E5E5"> exploited to take</font>

844
00:43:22,390 --> 00:43:27,370
control of the computers on the whole

845
00:43:24,070 --> 00:43:30,010
<font color="#E5E5E5">domain not just the local PC you mean a</font>

846
00:43:27,370 --> 00:43:34,359
service in a local PC<font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> you could use</font>

847
00:43:30,010 --> 00:43:35,640
to exploit<font color="#E5E5E5"> good question so I'm sure</font>

848
00:43:34,360 --> 00:43:46,500
<font color="#E5E5E5">they were</font>

849
00:43:35,640 --> 00:43:49,850
services<font color="#E5E5E5"> 100% I mean what you what you</font>

850
00:43:46,500 --> 00:43:52,620
could have is you have<font color="#CCCCCC"> a service that</font>

851
00:43:49,850 --> 00:43:55,319
<font color="#CCCCCC">that you can exploit and then you get</font>

852
00:43:52,620 --> 00:43:57,299
system privileges<font color="#E5E5E5"> and</font><font color="#CCCCCC"> with the system</font>

853
00:43:55,320 --> 00:44:01,140
<font color="#E5E5E5">privileges you could use tools</font><font color="#CCCCCC"> like mini</font>

854
00:43:57,300 --> 00:44:04,470
<font color="#E5E5E5">cuts to get all the password hashes of</font>

855
00:44:01,140 --> 00:44:06,720
users that<font color="#CCCCCC"> log in to your machine</font><font color="#E5E5E5"> and if</font>

856
00:44:04,470 --> 00:44:08,700
there is a<font color="#E5E5E5"> domain admin</font><font color="#CCCCCC"> connects to</font><font color="#E5E5E5"> your</font>

857
00:44:06,720 --> 00:44:11,540
machine you<font color="#CCCCCC"> can then extract his</font>

858
00:44:08,700 --> 00:44:15,689
password and use the<font color="#CCCCCC"> pass the hash</font>

859
00:44:11,540 --> 00:44:18,750
<font color="#E5E5E5">attack to connect to the domain</font>

860
00:44:15,690 --> 00:44:21,350
controller or other machines so this is

861
00:44:18,750 --> 00:44:24,510
a way<font color="#CCCCCC"> that I could imagine you could</font>

862
00:44:21,350 --> 00:44:27,720
<font color="#E5E5E5">exploit</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> escalate your privileges to</font>

863
00:44:24,510 --> 00:44:32,570
a domain<font color="#E5E5E5"> admin but directly from the</font>

864
00:44:27,720 --> 00:44:32,569
service itself<font color="#CCCCCC"> I do not know any case</font>

865
00:44:33,440 --> 00:44:42,240
regarding the missing<font color="#E5E5E5"> dll exploit yes</font>

866
00:44:38,210 --> 00:44:48,540
since the<font color="#E5E5E5"> DLL file is missing</font><font color="#CCCCCC"> should in</font>

867
00:44:42,240 --> 00:44:52,859
the app be able to start anyway so would

868
00:44:48,540 --> 00:44:56,040
a user<font color="#CCCCCC"> keep still keep an app on</font><font color="#E5E5E5"> its</font>

869
00:44:52,860 --> 00:45:01,680
laptop or desktop<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is not able</font><font color="#E5E5E5"> to</font>

870
00:44:56,040 --> 00:45:05,670
<font color="#E5E5E5">start and if the DLL is erased by you as</font>

871
00:45:01,680 --> 00:45:08,580
a hacker<font color="#CCCCCC"> shouldn't you already</font><font color="#E5E5E5"> have</font>

872
00:45:05,670 --> 00:45:12,270
privileges to exploit or directly modify

873
00:45:08,580 --> 00:45:16,710
<font color="#E5E5E5">the earlier five</font><font color="#CCCCCC"> okay good</font><font color="#E5E5E5"> question</font><font color="#CCCCCC"> so</font>

874
00:45:12,270 --> 00:45:19,710
regarding programs so windows all the

875
00:45:16,710 --> 00:45:21,720
windows applications<font color="#E5E5E5"> load</font><font color="#CCCCCC"> dll files</font><font color="#E5E5E5"> at</font>

876
00:45:19,710 --> 00:45:23,730
runtime<font color="#CCCCCC"> and if they don't</font><font color="#E5E5E5"> find that the</font>

877
00:45:21,720 --> 00:45:25,620
<font color="#CCCCCC">ll file</font><font color="#E5E5E5"> it does not necessarily mean</font>

878
00:45:23,730 --> 00:45:28,380
that<font color="#CCCCCC"> the application crashes</font><font color="#E5E5E5"> sometimes</font>

879
00:45:25,620 --> 00:45:31,290
it does but<font color="#CCCCCC"> not every</font><font color="#E5E5E5"> DLL is necessary</font>

880
00:45:28,380 --> 00:45:33,240
for the<font color="#CCCCCC"> application to run</font><font color="#E5E5E5"> so you might</font>

881
00:45:31,290 --> 00:45:35,160
have have an<font color="#CCCCCC"> app</font><font color="#E5E5E5"> you might have an</font>

882
00:45:33,240 --> 00:45:38,040
<font color="#E5E5E5">application or there are many</font>

883
00:45:35,160 --> 00:45:40,250
applications<font color="#CCCCCC"> that try</font><font color="#E5E5E5"> to load missing</font>

884
00:45:38,040 --> 00:45:42,900
the<font color="#E5E5E5"> other alphas but</font><font color="#CCCCCC"> are not able to</font>

885
00:45:40,250 --> 00:45:45,450
from<font color="#CCCCCC"> a</font><font color="#E5E5E5"> security perspective it would be</font>

886
00:45:42,900 --> 00:45:48,990
great if<font color="#CCCCCC"> you could remove such tools but</font>

887
00:45:45,450 --> 00:45:50,078
it will not always be<font color="#E5E5E5"> possible and your</font>

888
00:45:48,990 --> 00:45:52,839
second question

889
00:45:50,079 --> 00:45:55,720
if you are able<font color="#CCCCCC"> to place your own</font>

890
00:45:52,839 --> 00:45:58,058
malicious DLL file<font color="#E5E5E5"> does that this does</font>

891
00:45:55,720 --> 00:46:01,419
this not mean that<font color="#E5E5E5"> you don't already</font>

892
00:45:58,059 --> 00:46:03,849
have<font color="#CCCCCC"> high privileges</font><font color="#E5E5E5"> not necessarily so</font>

893
00:46:01,420 --> 00:46:08,250
in the first folders that<font color="#CCCCCC"> I showed</font>

894
00:46:03,849 --> 00:46:08,250
earlier on<font color="#CCCCCC"> I'll just open</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> again</font>

895
00:46:15,619 --> 00:46:21,109
so in the<font color="#E5E5E5"> first four or in the first</font>

896
00:46:18,710 --> 00:46:24,079
five folders<font color="#E5E5E5"> you will</font><font color="#CCCCCC"> probably not have</font>

897
00:46:21,109 --> 00:46:26,900
write<font color="#E5E5E5"> access</font><font color="#CCCCCC"> where where you could have</font>

898
00:46:24,079 --> 00:46:28,969
write access<font color="#E5E5E5"> is in a directory that is</font>

899
00:46:26,900 --> 00:46:30,829
<font color="#E5E5E5">defined in the system path environment</font>

900
00:46:28,969 --> 00:46:33,049
<font color="#E5E5E5">so in the system path</font><font color="#CCCCCC"> environment</font>

901
00:46:30,829 --> 00:46:37,579
<font color="#CCCCCC">sometimes</font><font color="#E5E5E5"> you have tools</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> C</font>

902
00:46:33,049 --> 00:46:39,920
backslash Python<font color="#E5E5E5"> and in Python</font><font color="#CCCCCC"> you I</font>

903
00:46:37,579 --> 00:46:41,809
think<font color="#E5E5E5"> by</font><font color="#CCCCCC"> default you</font><font color="#E5E5E5"> have write</font><font color="#CCCCCC"> access</font>

904
00:46:39,920 --> 00:46:44,450
<font color="#E5E5E5">and if you can write to</font><font color="#CCCCCC"> the Python</font>

905
00:46:41,809 --> 00:46:47,269
<font color="#E5E5E5">directory the</font><font color="#CCCCCC"> DLL if I will</font><font color="#E5E5E5"> be loaded</font>

906
00:46:44,450 --> 00:46:50,109
<font color="#CCCCCC">from there that's</font><font color="#E5E5E5"> how to exploit works</font>

907
00:46:47,269 --> 00:47:01,399
all<font color="#CCCCCC"> right thank you</font>

908
00:46:50,109 --> 00:47:04,400
<font color="#E5E5E5">thank you or any other questions no all</font>

909
00:47:01,400 --> 00:47:07,400
<font color="#E5E5E5">right so if you have further questions</font>

910
00:47:04,400 --> 00:47:11,119
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can always contact me via my email</font>

911
00:47:07,400 --> 00:47:12,710
or call<font color="#CCCCCC"> me directly</font><font color="#E5E5E5"> and also after the</font>

912
00:47:11,119 --> 00:47:14,960
talk I'm<font color="#CCCCCC"> going to be here and answer</font>

913
00:47:12,710 --> 00:47:18,349
your<font color="#E5E5E5"> questions</font><font color="#CCCCCC"> thank</font><font color="#E5E5E5"> you again for your</font>

914
00:47:14,960 --> 00:47:20,650
<font color="#E5E5E5">great questions and the discussion Thank</font>

915
00:47:18,349 --> 00:47:20,650
<font color="#E5E5E5">You Callie</font>

