1
00:00:00,539 --> 00:00:04,200
so in<font color="#E5E5E5"> this talk we will be talking about</font>

2
00:00:02,460 --> 00:00:08,639
reverse<font color="#E5E5E5"> engineering malware and</font>

3
00:00:04,200 --> 00:00:10,230
introduction<font color="#CCCCCC"> to it as a</font><font color="#E5E5E5"> very much</font><font color="#CCCCCC"> the</font>

4
00:00:08,639 --> 00:00:11,459
<font color="#E5E5E5">introduction to the</font><font color="#CCCCCC"> tooling the sandbox</font>

5
00:00:10,230 --> 00:00:14,070
saying the environment that<font color="#E5E5E5"> you need to</font>

6
00:00:11,460 --> 00:00:15,660
set up<font color="#E5E5E5"> this might this is not an</font>

7
00:00:14,070 --> 00:00:17,100
intermediate talk not advanced talk this

8
00:00:15,660 --> 00:00:19,859
<font color="#E5E5E5">is actually a very much a beginner talk</font>

9
00:00:17,100 --> 00:00:21,750
for starting security analysts and we're

10
00:00:19,859 --> 00:00:23,580
gonna go through<font color="#CCCCCC"> the basic steps on how</font>

11
00:00:21,750 --> 00:00:26,160
<font color="#CCCCCC">to reverse</font><font color="#E5E5E5"> engineer a Windows malware</font>

12
00:00:23,580 --> 00:00:28,288
<font color="#E5E5E5">very potent</font><font color="#CCCCCC"> Windows malware that</font>

13
00:00:26,160 --> 00:00:31,948
actually hit a large company<font color="#E5E5E5"> we will</font>

14
00:00:28,289 --> 00:00:34,200
<font color="#E5E5E5">talk about it</font><font color="#CCCCCC"> about ten months</font><font color="#E5E5E5"> ago it</font>

15
00:00:31,949 --> 00:00:36,090
was very<font color="#E5E5E5"> alive very potent it's the</font>

16
00:00:34,200 --> 00:00:37,739
<font color="#CCCCCC">servers are still</font><font color="#E5E5E5"> alive so if you want</font>

17
00:00:36,090 --> 00:00:39,780
<font color="#E5E5E5">to go ahead and</font><font color="#CCCCCC"> pen test it that's your</font>

18
00:00:37,739 --> 00:00:43,290
decision<font color="#CCCCCC"> okay</font>

19
00:00:39,780 --> 00:00:46,739
so hi<font color="#CCCCCC"> everybody my name is Abdullah as</font>

20
00:00:43,290 --> 00:00:49,110
the introducer already said<font color="#E5E5E5"> I work as a</font>

21
00:00:46,739 --> 00:00:51,269
security<font color="#E5E5E5"> analyst and mobile attribution</font>

22
00:00:49,110 --> 00:00:53,489
provider company and if that is too

23
00:00:51,270 --> 00:00:57,270
<font color="#CCCCCC">confusing it's basically we allow mobile</font>

24
00:00:53,489 --> 00:00:59,669
marketers to authenticate installs<font color="#E5E5E5"> that</font>

25
00:00:57,270 --> 00:01:01,800
<font color="#E5E5E5">are coming from their advertisements and</font>

26
00:00:59,670 --> 00:01:04,500
I work as<font color="#CCCCCC"> a security</font><font color="#E5E5E5"> analyst and the</font>

27
00:01:01,800 --> 00:01:06,990
fraud team<font color="#CCCCCC"> sre anti-fraud team of the</font>

28
00:01:04,500 --> 00:01:09,780
company and previously I worked<font color="#E5E5E5"> as a</font>

29
00:01:06,990 --> 00:01:11,449
<font color="#E5E5E5">software engineer</font><font color="#CCCCCC"> and here's my</font><font color="#E5E5E5"> twitter</font>

30
00:01:09,780 --> 00:01:14,760
<font color="#E5E5E5">handle so if you want to follow us</font>

31
00:01:11,450 --> 00:01:17,310
<font color="#E5E5E5">alright so first of all what is</font><font color="#CCCCCC"> malware</font>

32
00:01:14,760 --> 00:01:19,619
<font color="#E5E5E5">and this definition is not made</font><font color="#CCCCCC"> by me</font>

33
00:01:17,310 --> 00:01:23,310
this one is made by<font color="#CCCCCC"> a mr. Jake</font><font color="#E5E5E5"> Williams</font>

34
00:01:19,619 --> 00:01:25,320
from SANS Institute is a his<font color="#CCCCCC"> handles</font>

35
00:01:23,310 --> 00:01:27,350
<font color="#E5E5E5">malware Jake from Twitter he's one of</font>

36
00:01:25,320 --> 00:01:30,149
<font color="#E5E5E5">the most smartest people that</font><font color="#CCCCCC"> I know of</font>

37
00:01:27,350 --> 00:01:32,429
<font color="#E5E5E5">malware handling he's very dedicated</font>

38
00:01:30,150 --> 00:01:36,570
<font color="#E5E5E5">person malware is a</font><font color="#CCCCCC"> binary that does</font>

39
00:01:32,430 --> 00:01:39,509
something<font color="#CCCCCC"> someone wouldn't like</font><font color="#E5E5E5"> I hope</font>

40
00:01:36,570 --> 00:01:41,970
I'm paraphrasing<font color="#E5E5E5"> him right so it's not</font>

41
00:01:39,509 --> 00:01:44,369
about I will get to the demo in a minute

42
00:01:41,970 --> 00:01:45,509
it's not<font color="#CCCCCC"> about an exploit that's a</font>

43
00:01:44,369 --> 00:01:47,310
misconception

44
00:01:45,509 --> 00:01:48,979
<font color="#CCCCCC">not all the time malware will actually</font>

45
00:01:47,310 --> 00:01:52,740
contain an exploit that's only the

46
00:01:48,979 --> 00:01:54,658
<font color="#E5E5E5">really powerful very fancy ones most of</font>

47
00:01:52,740 --> 00:01:57,990
the time is actually<font color="#CCCCCC"> just</font><font color="#E5E5E5"> abusing the in</font>

48
00:01:54,659 --> 00:01:59,520
the<font color="#CCCCCC"> windows case that 132 api</font><font color="#E5E5E5"> in android</font>

49
00:01:57,990 --> 00:02:01,500
case it's the<font color="#E5E5E5"> Android ecosystem the</font>

50
00:01:59,520 --> 00:02:03,869
permission system<font color="#CCCCCC"> if you were in the my</font>

51
00:02:01,500 --> 00:02:05,340
first<font color="#E5E5E5"> talk you would see me give a talk</font>

52
00:02:03,869 --> 00:02:09,149
<font color="#CCCCCC">about how the Android ecosystem was</font>

53
00:02:05,340 --> 00:02:11,580
exploited in order to attack the<font color="#E5E5E5"> content</font>

54
00:02:09,149 --> 00:02:12,400
provider<font color="#CCCCCC"> that Google Play uses</font><font color="#E5E5E5"> it's not</font>

55
00:02:11,580 --> 00:02:15,420
an

56
00:02:12,400 --> 00:02:18,099
<font color="#E5E5E5">a technical exploit and the security</font>

57
00:02:15,420 --> 00:02:20,559
<font color="#CCCCCC">nomenclature</font><font color="#E5E5E5"> it's actually just an abuse</font>

58
00:02:18,099 --> 00:02:23,859
of the<font color="#CCCCCC"> already existing system</font><font color="#E5E5E5"> so more</font>

59
00:02:20,560 --> 00:02:25,840
or<font color="#CCCCCC"> less it's technically legal so we're</font>

60
00:02:23,860 --> 00:02:28,750
going<font color="#CCCCCC"> to go through a small demo right</font>

61
00:02:25,840 --> 00:02:30,879
<font color="#CCCCCC">now</font><font color="#E5E5E5"> about this you know the case about</font>

62
00:02:28,750 --> 00:02:33,760
the<font color="#E5E5E5"> demo</font><font color="#CCCCCC"> gods right</font><font color="#E5E5E5"> you know if the demo</font>

63
00:02:30,879 --> 00:02:35,920
works or not<font color="#E5E5E5"> here's a virtual machine</font>

64
00:02:33,760 --> 00:02:39,159
I'm running<font color="#E5E5E5"> Windows 10 and you see a</font>

65
00:02:35,920 --> 00:02:41,890
small<font color="#E5E5E5"> little exe that's called open me</font>

66
00:02:39,159 --> 00:02:43,540
dot exe<font color="#CCCCCC"> alright so a free hat goes to</font>

67
00:02:41,890 --> 00:02:45,420
<font color="#CCCCCC">whoever can tell me what should I do</font>

68
00:02:43,540 --> 00:02:52,000
with this<font color="#E5E5E5"> thing</font>

69
00:02:45,420 --> 00:02:55,060
thank you<font color="#E5E5E5"> all right so this</font><font color="#CCCCCC"> is gonna</font>

70
00:02:52,000 --> 00:02:57,700
<font color="#E5E5E5">take around I</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> 60 seconds or so so</font>

71
00:02:55,060 --> 00:03:02,889
I will<font color="#CCCCCC"> just go over here and</font><font color="#E5E5E5"> get back to</font>

72
00:02:57,700 --> 00:03:04,599
it<font color="#CCCCCC"> and in the next 60 seconds</font><font color="#E5E5E5"> so while</font>

73
00:03:02,889 --> 00:03:06,400
this<font color="#E5E5E5"> is actually working why bother with</font>

74
00:03:04,599 --> 00:03:09,189
analysis why do we need malware<font color="#E5E5E5"> analysis</font>

75
00:03:06,400 --> 00:03:13,180
<font color="#CCCCCC">in my</font><font color="#E5E5E5"> opinion malware analysis is</font>

76
00:03:09,189 --> 00:03:14,769
<font color="#E5E5E5">necessary not antivirus I'm not I'm not</font>

77
00:03:13,180 --> 00:03:16,810
here to trash talk about any antivirus

78
00:03:14,769 --> 00:03:19,120
<font color="#CCCCCC">I'm more or less</font><font color="#E5E5E5"> uh opinionated about it</font>

79
00:03:16,810 --> 00:03:20,530
but<font color="#E5E5E5"> it's necessary</font><font color="#CCCCCC"> to know that</font><font color="#E5E5E5"> there is</font>

80
00:03:19,120 --> 00:03:22,060
a difference between malware analysis

81
00:03:20,530 --> 00:03:24,400
and letting the antivirus people do

82
00:03:22,060 --> 00:03:27,280
their job it's<font color="#E5E5E5"> very different</font><font color="#CCCCCC"> a very big</font>

83
00:03:24,400 --> 00:03:29,079
difference<font color="#E5E5E5"> most malware is targeted to a</font>

84
00:03:27,280 --> 00:03:31,989
specific organization<font color="#E5E5E5"> to specific people</font>

85
00:03:29,079 --> 00:03:33,790
<font color="#CCCCCC">the specific infrastructure</font><font color="#E5E5E5"> and a</font>

86
00:03:31,989 --> 00:03:37,419
specific<font color="#E5E5E5"> target</font><font color="#CCCCCC"> it's actually has a</font>

87
00:03:33,790 --> 00:03:38,709
unique signature<font color="#E5E5E5"> and if the</font><font color="#CCCCCC"> molar</font><font color="#E5E5E5"> writer</font>

88
00:03:37,419 --> 00:03:40,510
knows what he's doing

89
00:03:38,709 --> 00:03:42,849
he's<font color="#E5E5E5"> not going to be he's</font><font color="#CCCCCC"> going to be</font>

90
00:03:40,510 --> 00:03:45,280
avoiding anti viruses<font color="#E5E5E5"> if any of you has</font>

91
00:03:42,849 --> 00:03:47,290
<font color="#CCCCCC">done o SCP</font><font color="#E5E5E5"> I think one of the main tasks</font>

92
00:03:45,280 --> 00:03:51,099
is that you have to<font color="#E5E5E5"> design an exploit</font>

93
00:03:47,290 --> 00:03:54,310
<font color="#E5E5E5">that avoids that</font><font color="#CCCCCC"> of AIT's</font><font color="#E5E5E5"> antivirus</font>

94
00:03:51,099 --> 00:03:57,099
programs so this<font color="#E5E5E5"> is why we mother with</font>

95
00:03:54,310 --> 00:03:59,109
analysis<font color="#E5E5E5"> because most automated tools</font>

96
00:03:57,099 --> 00:04:00,728
<font color="#E5E5E5">can't really catch it it's something</font>

97
00:03:59,109 --> 00:04:04,599
<font color="#CCCCCC">very targeted at something</font><font color="#E5E5E5"> very</font><font color="#CCCCCC"> unique</font>

98
00:04:00,729 --> 00:04:07,780
<font color="#E5E5E5">so simple hygiene I believe its proper</font>

99
00:04:04,599 --> 00:04:10,000
world is a very good good way<font color="#CCCCCC"> of</font>

100
00:04:07,780 --> 00:04:12,909
protecting<font color="#E5E5E5"> against such a thing</font><font color="#CCCCCC"> number</font>

101
00:04:10,000 --> 00:04:16,269
one rule<font color="#CCCCCC"> don't click on</font><font color="#E5E5E5"> exe that says</font>

102
00:04:12,909 --> 00:04:19,199
open<font color="#CCCCCC"> mean dot exe</font><font color="#E5E5E5"> all right let's get</font>

103
00:04:16,269 --> 00:04:22,620
<font color="#CCCCCC">back to a little virtual machine</font><font color="#E5E5E5"> lovely</font>

104
00:04:19,199 --> 00:04:22,620
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right</font>

105
00:04:22,800 --> 00:04:26,350
important information<font color="#E5E5E5"> all of your files</font>

106
00:04:24,820 --> 00:04:30,190
are encrypted with RSA 2000

107
00:04:26,350 --> 00:04:32,440
48 and<font color="#E5E5E5"> aes-128 ciphers right so that</font>

108
00:04:30,190 --> 00:04:33,940
sounds bad<font color="#CCCCCC"> decrypting</font><font color="#E5E5E5"> of your file is</font>

109
00:04:32,440 --> 00:04:35,800
only<font color="#E5E5E5"> possible with</font><font color="#CCCCCC"> the private key</font><font color="#E5E5E5"> and</font>

110
00:04:33,940 --> 00:04:39,160
decrypt program<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is my unique</font>

111
00:04:35,800 --> 00:04:43,240
personal identification ID and if I go

112
00:04:39,160 --> 00:04:47,160
<font color="#CCCCCC">to here my wallpaper has been replaced</font>

113
00:04:43,240 --> 00:04:49,680
<font color="#E5E5E5">and if you look in here</font>

114
00:04:47,160 --> 00:04:53,470
what is the<font color="#E5E5E5"> extension of this file</font>

115
00:04:49,680 --> 00:04:55,960
<font color="#E5E5E5">Osiris</font><font color="#CCCCCC"> wow that's</font><font color="#E5E5E5"> not a file I created</font>

116
00:04:53,470 --> 00:04:57,760
<font color="#E5E5E5">that's actually a txt file that I had</font>

117
00:04:55,960 --> 00:05:00,159
flying<font color="#E5E5E5"> around it had some input in there</font>

118
00:04:57,760 --> 00:05:03,159
and all my<font color="#E5E5E5"> files are right now encrypted</font>

119
00:05:00,160 --> 00:05:05,050
<font color="#E5E5E5">this is what's called ransomware it will</font>

120
00:05:03,160 --> 00:05:08,040
encrypt all your files all day necessary

121
00:05:05,050 --> 00:05:11,050
<font color="#E5E5E5">very crucial text files that you have</font>

122
00:05:08,040 --> 00:05:13,240
budgeting anything that you anything

123
00:05:11,050 --> 00:05:16,210
<font color="#CCCCCC">that you and your boss talked about all</font>

124
00:05:13,240 --> 00:05:18,670
encrypted<font color="#E5E5E5"> with a dot</font><font color="#CCCCCC"> or in this case dot</font>

125
00:05:16,210 --> 00:05:20,289
<font color="#E5E5E5">Osiris extension and you can't do</font>

126
00:05:18,670 --> 00:05:23,410
<font color="#E5E5E5">anything about it this is unreadable</font><font color="#CCCCCC"> if</font>

127
00:05:20,290 --> 00:05:25,390
you go into notepad<font color="#E5E5E5"> this was a txt file</font>

128
00:05:23,410 --> 00:05:27,370
<font color="#E5E5E5">it didn't even have a magic</font><font color="#CCCCCC"> number it</font>

129
00:05:25,390 --> 00:05:29,080
had nothing it's just<font color="#E5E5E5"> a pure txt file</font>

130
00:05:27,370 --> 00:05:33,400
<font color="#E5E5E5">right now it's encrypted this is what</font>

131
00:05:29,080 --> 00:05:35,200
ransomware does and if we can<font color="#E5E5E5"> revert</font>

132
00:05:33,400 --> 00:05:38,229
back to<font color="#E5E5E5"> my virtual machine</font><font color="#CCCCCC"> I will</font><font color="#E5E5E5"> get</font>

133
00:05:35,200 --> 00:05:39,370
back<font color="#CCCCCC"> to it</font><font color="#E5E5E5"> right right at the end we</font>

134
00:05:38,230 --> 00:05:42,370
will do a small experimentation

135
00:05:39,370 --> 00:05:45,370
afterwards so we're gonna deal<font color="#E5E5E5"> today</font>

136
00:05:42,370 --> 00:05:47,710
<font color="#CCCCCC">with a small ransomware before I go and</font>

137
00:05:45,370 --> 00:05:52,300
into this into the analysis there is

138
00:05:47,710 --> 00:05:54,820
<font color="#E5E5E5">something about AV vendors by I think</font>

139
00:05:52,300 --> 00:05:57,580
the the name of the<font color="#CCCCCC"> person is</font><font color="#E5E5E5"> Brian</font>

140
00:05:54,820 --> 00:05:59,890
Welton from<font color="#E5E5E5"> blank Black Hills</font>

141
00:05:57,580 --> 00:06:03,219
<font color="#E5E5E5">information</font><font color="#CCCCCC"> security yes I remember they</font>

142
00:05:59,890 --> 00:06:06,130
made this thing<font color="#CCCCCC"> this event</font><font color="#E5E5E5"> and they keep</font>

143
00:06:03,220 --> 00:06:07,930
<font color="#E5E5E5">doing it every RSA and it's amazing and</font>

144
00:06:06,130 --> 00:06:09,610
they actually<font color="#E5E5E5"> have it as a webinar</font><font color="#CCCCCC"> so</font>

145
00:06:07,930 --> 00:06:12,010
what they do is that<font color="#CCCCCC"> they have</font><font color="#E5E5E5"> a small</font>

146
00:06:09,610 --> 00:06:14,110
booth they set it<font color="#E5E5E5"> up using usual an RSA</font>

147
00:06:12,010 --> 00:06:16,240
conferences or a black hat and<font color="#E5E5E5"> they</font>

148
00:06:14,110 --> 00:06:19,140
literally<font color="#E5E5E5"> attack and the virus vendors</font>

149
00:06:16,240 --> 00:06:22,510
live they say<font color="#E5E5E5"> download the latest</font>

150
00:06:19,140 --> 00:06:26,050
<font color="#E5E5E5">version of the antivirus whether it's I</font>

151
00:06:22,510 --> 00:06:28,180
don't<font color="#CCCCCC"> know I'm</font><font color="#E5E5E5"> not gonna name names but</font>

152
00:06:26,050 --> 00:06:29,620
they have a list of<font color="#E5E5E5"> AV vendors they go</font>

153
00:06:28,180 --> 00:06:32,020
through it every<font color="#E5E5E5"> year</font><font color="#CCCCCC"> and they basically</font>

154
00:06:29,620 --> 00:06:33,670
<font color="#E5E5E5">attack it they have a small malware they</font>

155
00:06:32,020 --> 00:06:36,010
keep changing<font color="#E5E5E5"> the signature</font><font color="#CCCCCC"> of it and</font>

156
00:06:33,670 --> 00:06:39,580
the a pipe ass every single<font color="#E5E5E5"> antivirus</font>

157
00:06:36,010 --> 00:06:40,060
program out there<font color="#CCCCCC"> and I as I said I'm</font>

158
00:06:39,580 --> 00:06:41,530
very<font color="#CCCCCC"> on</font>

159
00:06:40,060 --> 00:06:43,960
<font color="#CCCCCC">been</font><font color="#E5E5E5"> United about antiviruses but the</font>

160
00:06:41,530 --> 00:06:47,229
thing is they are<font color="#E5E5E5"> not made for</font>

161
00:06:43,960 --> 00:06:48,638
protection against directed<font color="#E5E5E5"> attacks you</font>

162
00:06:47,230 --> 00:06:50,919
can't protect against<font color="#E5E5E5"> us</font>

163
00:06:48,639 --> 00:06:53,650
there is no<font color="#E5E5E5"> antivirus that could have</font>

164
00:06:50,919 --> 00:06:58,030
protected against Stuxnet<font color="#E5E5E5"> that's that</font>

165
00:06:53,650 --> 00:07:00,929
wouldn't have existed<font color="#E5E5E5"> and moving on so</font>

166
00:06:58,030 --> 00:07:04,719
analyzing<font color="#E5E5E5"> a ransomware the name of this</font>

167
00:07:00,930 --> 00:07:06,520
<font color="#E5E5E5">the</font><font color="#CCCCCC"> codename that hybrid analysis gave</font>

168
00:07:04,720 --> 00:07:10,030
is open me dot exe that's the name that

169
00:07:06,520 --> 00:07:12,099
<font color="#CCCCCC">it was that the large organization</font><font color="#E5E5E5"> that</font>

170
00:07:10,030 --> 00:07:14,650
in fact<font color="#E5E5E5"> that was infected by this</font>

171
00:07:12,100 --> 00:07:17,200
ransomware<font color="#CCCCCC"> that's the name of</font><font color="#E5E5E5"> the X part</font>

172
00:07:14,650 --> 00:07:18,638
<font color="#E5E5E5">of the exe file open</font><font color="#CCCCCC"> me dot exe</font><font color="#E5E5E5"> if you</font>

173
00:07:17,200 --> 00:07:20,409
go to the top right<font color="#CCCCCC"> corner you can</font><font color="#E5E5E5"> see</font>

174
00:07:18,639 --> 00:07:22,720
<font color="#E5E5E5">threat score of hundred and that's</font>

175
00:07:20,410 --> 00:07:24,669
something<font color="#E5E5E5"> from not automated analysis</font>

176
00:07:22,720 --> 00:07:26,580
tool so we<font color="#CCCCCC"> can see that there is a lot</font>

177
00:07:24,669 --> 00:07:31,930
of<font color="#E5E5E5"> fun geeky where it's happening and</font>

178
00:07:26,580 --> 00:07:34,120
the e AV detection rate is 76%<font color="#CCCCCC"> but not</font>

179
00:07:31,930 --> 00:07:36,880
hundred percent<font color="#E5E5E5"> nothing can be caught</font><font color="#CCCCCC"> 1%</font>

180
00:07:34,120 --> 00:07:38,650
so this one was it has a<font color="#CCCCCC"> lot of</font>

181
00:07:36,880 --> 00:07:42,070
interesting signatures that do resemble

182
00:07:38,650 --> 00:07:43,960
Antivirus Pro do resemble<font color="#E5E5E5"> malware like</font>

183
00:07:42,070 --> 00:07:47,050
<font color="#E5E5E5">crypt encrypt the use of crypt encrypt</font>

184
00:07:43,960 --> 00:07:51,340
function for 132 API for<font color="#E5E5E5"> ransom wires</font>

185
00:07:47,050 --> 00:07:52,660
<font color="#E5E5E5">which we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> go</font><font color="#CCCCCC"> over later</font><font color="#E5E5E5"> and the</font>

186
00:07:51,340 --> 00:07:54,940
steps<font color="#E5E5E5"> that</font><font color="#CCCCCC"> were going</font><font color="#E5E5E5"> to follow right</font>

187
00:07:52,660 --> 00:07:57,970
now with the analysis is very much a

188
00:07:54,940 --> 00:08:00,280
surgical approach<font color="#E5E5E5"> we're not here to do</font>

189
00:07:57,970 --> 00:08:02,260
an entire analysis or a dissection<font color="#CCCCCC"> of</font>

190
00:08:00,280 --> 00:08:04,419
<font color="#E5E5E5">the malware</font><font color="#CCCCCC"> I don't care about what sort</font>

191
00:08:02,260 --> 00:08:05,469
of SQLite database libraries that<font color="#E5E5E5"> they</font>

192
00:08:04,419 --> 00:08:07,240
<font color="#CCCCCC">imported I don't care about the</font>

193
00:08:05,470 --> 00:08:09,669
versioning<font color="#CCCCCC"> I only care about a very</font>

194
00:08:07,240 --> 00:08:13,630
specific thing I need to know<font color="#E5E5E5"> if</font><font color="#CCCCCC"> this</font>

195
00:08:09,669 --> 00:08:16,419
<font color="#CCCCCC">exe</font><font color="#E5E5E5"> is safe or not</font><font color="#CCCCCC"> and assuming that</font><font color="#E5E5E5"> the</font>

196
00:08:13,630 --> 00:08:19,570
person<font color="#CCCCCC"> actually doesn't open</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> before</font>

197
00:08:16,419 --> 00:08:22,359
he<font color="#E5E5E5"> send it to me so we're going to</font>

198
00:08:19,570 --> 00:08:24,039
follow a small methodology of analyzing

199
00:08:22,360 --> 00:08:25,690
this ransomware<font color="#E5E5E5"> the first one is that</font>

200
00:08:24,039 --> 00:08:27,639
we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to go with static analysis</font>

201
00:08:25,690 --> 00:08:28,930
<font color="#E5E5E5">not reverse engineering that's a</font>

202
00:08:27,639 --> 00:08:30,360
different step<font color="#CCCCCC"> that's static</font><font color="#E5E5E5"> code</font>

203
00:08:28,930 --> 00:08:33,330
analysis<font color="#E5E5E5"> right now we're just going</font><font color="#CCCCCC"> to</font>

204
00:08:30,360 --> 00:08:34,900
<font color="#E5E5E5">see what the properties of exe is</font>

205
00:08:33,330 --> 00:08:36,640
<font color="#E5E5E5">afterwards we're going to</font><font color="#CCCCCC"> go with</font>

206
00:08:34,900 --> 00:08:38,770
behavioral analysis some people call it

207
00:08:36,640 --> 00:08:40,929
<font color="#CCCCCC">dynamic analysis</font><font color="#E5E5E5"> we're going</font><font color="#CCCCCC"> to run it</font>

208
00:08:38,770 --> 00:08:43,329
see what's the inputs and<font color="#E5E5E5"> the outputs</font>

209
00:08:40,929 --> 00:08:46,270
and afterwards we're<font color="#CCCCCC"> going to open</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> up</font>

210
00:08:43,330 --> 00:08:49,540
<font color="#E5E5E5">with</font><font color="#CCCCCC"> either pro or radare or pick your</font>

211
00:08:46,270 --> 00:08:53,380
<font color="#CCCCCC">own disassembler</font><font color="#E5E5E5"> the thing is a lot of</font>

212
00:08:49,540 --> 00:08:55,750
since this talk is aimed very much at

213
00:08:53,380 --> 00:08:59,740
the<font color="#CCCCCC"> uninitiated and the malware analysis</font>

214
00:08:55,750 --> 00:09:01,480
<font color="#E5E5E5">never ever open</font><font color="#CCCCCC"> a malware or an exe file</font>

215
00:08:59,740 --> 00:09:03,190
directly into either<font color="#CCCCCC"> without knowing</font>

216
00:09:01,480 --> 00:09:05,800
what you're doing<font color="#E5E5E5"> you're gonna be</font>

217
00:09:03,190 --> 00:09:08,230
bombarded<font color="#CCCCCC"> by</font><font color="#E5E5E5"> a libraries that you're not</font>

218
00:09:05,800 --> 00:09:09,849
that you<font color="#E5E5E5"> don't know about and you don't</font>

219
00:09:08,230 --> 00:09:11,860
need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> about you need to have a</font>

220
00:09:09,850 --> 00:09:13,990
theory<font color="#CCCCCC"> before you actually go on to an</font>

221
00:09:11,860 --> 00:09:17,529
analysis that's what the<font color="#E5E5E5"> job</font><font color="#CCCCCC"> of a</font>

222
00:09:13,990 --> 00:09:19,810
malware<font color="#E5E5E5"> analyst is and either</font><font color="#CCCCCC"> stands for</font>

223
00:09:17,529 --> 00:09:22,930
interactive disassembler<font color="#E5E5E5"> so the</font>

224
00:09:19,810 --> 00:09:25,329
interactive part<font color="#E5E5E5"> is you static analysis</font>

225
00:09:22,930 --> 00:09:28,000
<font color="#CCCCCC">the format of</font><font color="#E5E5E5"> this presentation will</font><font color="#CCCCCC"> be</font>

226
00:09:25,329 --> 00:09:31,239
that<font color="#E5E5E5"> I'm using</font><font color="#CCCCCC"> small sandbox environment</font>

227
00:09:28,000 --> 00:09:34,269
of two virtual machines<font color="#CCCCCC"> UNIX system and</font>

228
00:09:31,240 --> 00:09:35,949
a Windows<font color="#E5E5E5"> system which is the victim</font>

229
00:09:34,269 --> 00:09:38,920
system and one is the analysis system

230
00:09:35,949 --> 00:09:41,019
for the windows for<font color="#E5E5E5"> the both systems</font>

231
00:09:38,920 --> 00:09:43,839
<font color="#CCCCCC">you're going to see the either</font><font color="#E5E5E5"> UNIX or</font>

232
00:09:41,019 --> 00:09:46,149
Windows<font color="#CCCCCC"> :</font><font color="#E5E5E5"> and then the command</font><font color="#CCCCCC"> that I'm</font>

233
00:09:43,839 --> 00:09:47,050
executing<font color="#CCCCCC"> if it's a Windows GUI program</font>

234
00:09:46,149 --> 00:09:49,209
you're<font color="#E5E5E5"> going to see the name of the</font>

235
00:09:47,050 --> 00:09:50,769
program<font color="#E5E5E5"> I'm doing this</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> that later on</font>

236
00:09:49,209 --> 00:09:52,388
<font color="#CCCCCC">if</font><font color="#E5E5E5"> you actually want to do this thing by</font>

237
00:09:50,769 --> 00:09:54,910
yourself<font color="#CCCCCC"> you can download open me dot</font>

238
00:09:52,389 --> 00:09:56,170
exe<font color="#E5E5E5"> it's and I github repo which I have</font>

239
00:09:54,910 --> 00:09:59,769
the link to<font color="#E5E5E5"> at the end it's called the</font>

240
00:09:56,170 --> 00:10:01,479
<font color="#E5E5E5">zoo it has a pretty big diverse range of</font>

241
00:09:59,769 --> 00:10:03,220
<font color="#CCCCCC">malware's</font><font color="#E5E5E5"> for you to</font><font color="#CCCCCC"> analyze and</font><font color="#E5E5E5"> have</font>

242
00:10:01,480 --> 00:10:04,540
fun<font color="#E5E5E5"> with</font><font color="#CCCCCC"> and you can execute these</font>

243
00:10:03,220 --> 00:10:06,550
commands<font color="#E5E5E5"> to follow</font><font color="#CCCCCC"> exactly what I just</font>

244
00:10:04,540 --> 00:10:09,279
<font color="#E5E5E5">did and you</font><font color="#CCCCCC"> can reach your own</font>

245
00:10:06,550 --> 00:10:12,609
conclusions afterwards so in here we're

246
00:10:09,279 --> 00:10:14,560
running strings<font color="#E5E5E5"> it's basic</font><font color="#CCCCCC"> UNIX command</font>

247
00:10:12,610 --> 00:10:17,440
<font color="#E5E5E5">that actually just dumps all the strings</font>

248
00:10:14,560 --> 00:10:21,849
that<font color="#CCCCCC"> are there in</font><font color="#E5E5E5"> the exe file and as we</font>

249
00:10:17,440 --> 00:10:22,410
<font color="#E5E5E5">can</font><font color="#CCCCCC"> see in here to me</font><font color="#E5E5E5"> none of this makes</font>

250
00:10:21,850 --> 00:10:25,779
sense

251
00:10:22,410 --> 00:10:28,079
none of<font color="#E5E5E5"> this is relevant</font><font color="#CCCCCC"> by the way the</font>

252
00:10:25,779 --> 00:10:31,060
cover story of<font color="#E5E5E5"> the exe</font><font color="#CCCCCC"> file that the</font>

253
00:10:28,079 --> 00:10:35,019
infrastructure of the company found was

254
00:10:31,060 --> 00:10:37,149
<font color="#CCCCCC">that it's a paint replacement program ok</font>

255
00:10:35,019 --> 00:10:38,620
so that's what if you're a<font color="#E5E5E5"> male or</font>

256
00:10:37,149 --> 00:10:39,939
<font color="#CCCCCC">analyst</font><font color="#E5E5E5"> this is the cover story that</font>

257
00:10:38,620 --> 00:10:42,040
<font color="#E5E5E5">you're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> receive</font><font color="#CCCCCC"> it's like hey I</font>

258
00:10:39,939 --> 00:10:44,050
would just receive this email<font color="#E5E5E5"> and it had</font>

259
00:10:42,040 --> 00:10:46,689
an exe file that says this<font color="#CCCCCC"> is a better</font>

260
00:10:44,050 --> 00:10:49,060
paint program<font color="#E5E5E5"> so how about you go</font><font color="#CCCCCC"> ahead</font>

261
00:10:46,689 --> 00:10:50,259
<font color="#E5E5E5">and tell me if it's real or</font><font color="#CCCCCC"> not so what</font>

262
00:10:49,060 --> 00:10:54,239
<font color="#E5E5E5">we're looking</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> right now</font><font color="#CCCCCC"> are</font>

263
00:10:50,259 --> 00:10:56,740
signatures for drawing GUI<font color="#CCCCCC"> drawings so</font>

264
00:10:54,240 --> 00:11:00,100
to me<font color="#E5E5E5"> none of this makes sense</font>

265
00:10:56,740 --> 00:11:02,769
what is constructions<font color="#E5E5E5"> strike</font><font color="#CCCCCC"> Banner</font>

266
00:11:00,100 --> 00:11:05,560
Chinese medium somebody can<font color="#CCCCCC"> explain to</font>

267
00:11:02,769 --> 00:11:07,509
me<font color="#E5E5E5"> this he gets a free hat so</font>

268
00:11:05,560 --> 00:11:11,498
yeah<font color="#CCCCCC"> strings</font><font color="#E5E5E5"> didn't give me any useful</font>

269
00:11:07,509 --> 00:11:13,870
<font color="#CCCCCC">input</font><font color="#E5E5E5"> right now this is the next</font><font color="#CCCCCC"> page of</font>

270
00:11:11,499 --> 00:11:15,519
string<font color="#CCCCCC"> I like this one Astro burn light</font>

271
00:11:13,870 --> 00:11:17,560
is not installed<font color="#CCCCCC"> do you want to download</font>

272
00:11:15,519 --> 00:11:19,540
<font color="#E5E5E5">Astro burn light</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> actually search for</font>

273
00:11:17,560 --> 00:11:21,430
Astro burn<font color="#CCCCCC"> light on</font><font color="#E5E5E5"> Google</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> have no</font>

274
00:11:19,540 --> 00:11:24,579
idea what this<font color="#E5E5E5"> is it's it's it's not a</font>

275
00:11:21,430 --> 00:11:26,439
real software<font color="#E5E5E5"> so when you receive</font><font color="#CCCCCC"> a</font>

276
00:11:24,579 --> 00:11:28,660
software like this and it<font color="#E5E5E5"> has a it says</font>

277
00:11:26,439 --> 00:11:31,300
it's a paint<font color="#CCCCCC"> program</font><font color="#E5E5E5"> just run strings on</font>

278
00:11:28,660 --> 00:11:34,449
it<font color="#E5E5E5"> and see if it</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> is trying to</font>

279
00:11:31,300 --> 00:11:36,490
do what it<font color="#E5E5E5"> says it's doing</font><font color="#CCCCCC"> okay next</font>

280
00:11:34,449 --> 00:11:38,199
step<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that we're still on the static</font>

281
00:11:36,490 --> 00:11:41,499
analysis part we need to know what<font color="#E5E5E5"> the</font>

282
00:11:38,199 --> 00:11:43,449
<font color="#E5E5E5">CXC looks like</font><font color="#CCCCCC"> Wow</font><font color="#E5E5E5"> what's the</font><font color="#CCCCCC"> imports</font>

283
00:11:41,499 --> 00:11:44,860
what's the exports but what's the

284
00:11:43,449 --> 00:11:47,019
libraries<font color="#E5E5E5"> it's using what's the</font><font color="#CCCCCC"> DLL</font>

285
00:11:44,860 --> 00:11:49,990
stuff like that<font color="#E5E5E5"> so we run it through a</font>

286
00:11:47,019 --> 00:11:51,279
<font color="#E5E5E5">small program called P studio I really</font>

287
00:11:49,990 --> 00:11:54,850
can't believe this program<font color="#CCCCCC"> is</font><font color="#E5E5E5"> free</font><font color="#CCCCCC"> it's</font>

288
00:11:51,279 --> 00:11:56,439
amazing if<font color="#CCCCCC"> you have five minutes</font><font color="#E5E5E5"> and you</font>

289
00:11:54,850 --> 00:11:57,850
<font color="#E5E5E5">just your boss tells you it's like</font><font color="#CCCCCC"> ok I</font>

290
00:11:56,439 --> 00:12:01,170
need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> know what</font><font color="#E5E5E5"> this malware does like</font>

291
00:11:57,850 --> 00:12:03,430
now<font color="#CCCCCC"> just throw it into PE</font><font color="#E5E5E5"> studio it's</font>

292
00:12:01,170 --> 00:12:04,748
beautiful<font color="#CCCCCC"> it gives you</font><font color="#E5E5E5"> all the imports</font>

293
00:12:03,430 --> 00:12:08,050
<font color="#E5E5E5">that you need gives you all the</font>

294
00:12:04,749 --> 00:12:09,819
blacklisted keywords<font color="#E5E5E5"> and highlights them</font>

295
00:12:08,050 --> 00:12:12,670
on the left side what you're gonna see

296
00:12:09,819 --> 00:12:14,860
in a minute<font color="#E5E5E5"> and tells you basically</font><font color="#CCCCCC"> a</font>

297
00:12:12,670 --> 00:12:18,459
small summary<font color="#E5E5E5"> of what it thinks this</font>

298
00:12:14,860 --> 00:12:20,319
program does<font color="#E5E5E5"> now that's a summary of an</font>

299
00:12:18,459 --> 00:12:22,930
automated tool so just<font color="#E5E5E5"> be aware what</font>

300
00:12:20,319 --> 00:12:24,699
<font color="#E5E5E5">you're trying to do so it's actually</font>

301
00:12:22,930 --> 00:12:27,638
<font color="#E5E5E5">from what we can see in here it</font><font color="#CCCCCC"> actually</font>

302
00:12:24,699 --> 00:12:30,910
<font color="#E5E5E5">has some paint properties set</font><font color="#CCCCCC"> pixel I</font>

303
00:12:27,639 --> 00:12:32,709
can see in here<font color="#E5E5E5"> Phil rgn I'm guessing</font>

304
00:12:30,910 --> 00:12:36,009
that's<font color="#E5E5E5"> some sort of something relating</font>

305
00:12:32,709 --> 00:12:39,369
to paint programs rectangle set brush<font color="#E5E5E5"> or</font>

306
00:12:36,009 --> 00:12:41,110
<font color="#CCCCCC">GX</font><font color="#E5E5E5"> create pen there's some interesting</font>

307
00:12:39,370 --> 00:12:43,930
signatures that do<font color="#E5E5E5"> actually resemble</font>

308
00:12:41,110 --> 00:12:45,970
paint programs so it could fool the eyes

309
00:12:43,930 --> 00:12:48,279
so but let's keep going let's let's keep

310
00:12:45,970 --> 00:12:49,839
<font color="#CCCCCC">asking questions</font><font color="#E5E5E5"> I said about the</font><font color="#CCCCCC"> PE</font>

311
00:12:48,279 --> 00:12:51,939
<font color="#E5E5E5">stood here the strings the blacklisted</font>

312
00:12:49,839 --> 00:12:54,069
strings it's right here highlighted<font color="#CCCCCC"> in</font>

313
00:12:51,939 --> 00:12:55,509
<font color="#CCCCCC">red and there is the indicators above it</font>

314
00:12:54,069 --> 00:12:59,709
will tell you a small<font color="#E5E5E5"> summary of what's</font>

315
00:12:55,509 --> 00:13:02,379
what it thinks<font color="#E5E5E5"> it could be doing and in</font>

316
00:12:59,709 --> 00:13:05,559
here I do see some<font color="#CCCCCC"> interesting stuff</font><font color="#E5E5E5"> if</font>

317
00:13:02,379 --> 00:13:08,170
you're<font color="#E5E5E5"> if you may close attention you're</font>

318
00:13:05,559 --> 00:13:12,189
gonna see two very important<font color="#CCCCCC"> things in</font>

319
00:13:08,170 --> 00:13:15,389
here TLS<font color="#CCCCCC"> okay anybody knows what TLS</font>

320
00:13:12,189 --> 00:13:15,389
stands for<font color="#CCCCCC"> in</font><font color="#E5E5E5"> 132 API</font>

321
00:13:18,590 --> 00:13:24,180
thread-local storage<font color="#E5E5E5"> not transport layer</font>

322
00:13:21,540 --> 00:13:27,510
security<font color="#CCCCCC"> it's it's a weird thing in</font>

323
00:13:24,180 --> 00:13:30,900
win32<font color="#E5E5E5"> api it's basically a very niche</font>

324
00:13:27,510 --> 00:13:32,880
weird<font color="#E5E5E5"> little thing that</font><font color="#CCCCCC"> Microsoft did</font>

325
00:13:30,900 --> 00:13:36,090
which is<font color="#E5E5E5"> basically having the ability to</font>

326
00:13:32,880 --> 00:13:38,640
<font color="#E5E5E5">store variables that is on the threat</font>

327
00:13:36,090 --> 00:13:40,680
itself<font color="#CCCCCC"> and you can transport it for</font>

328
00:13:38,640 --> 00:13:42,810
multi-threaded applications for malware

329
00:13:40,680 --> 00:13:45,359
analysis there is<font color="#CCCCCC"> a side effect</font><font color="#E5E5E5"> for it</font>

330
00:13:42,810 --> 00:13:47,599
<font color="#E5E5E5">for a</font><font color="#CCCCCC"> malware author</font><font color="#E5E5E5"> excuse me you can</font>

331
00:13:45,360 --> 00:13:50,280
execute a program<font color="#CCCCCC"> before the entry</font>

332
00:13:47,600 --> 00:13:53,160
before<font color="#E5E5E5"> the</font><font color="#CCCCCC"> actual entry point</font><font color="#E5E5E5"> the one</font>

333
00:13:50,280 --> 00:13:56,400
main function<font color="#E5E5E5"> you can execute whatever</font>

334
00:13:53,160 --> 00:14:00,089
<font color="#CCCCCC">it is that you want before it when you</font>

335
00:13:56,400 --> 00:14:02,010
see something<font color="#CCCCCC"> as that says TLS 99% of</font>

336
00:14:00,090 --> 00:14:04,440
the<font color="#E5E5E5"> time it will</font><font color="#CCCCCC"> be doing</font><font color="#E5E5E5"> something</font>

337
00:14:02,010 --> 00:14:06,870
malicious<font color="#E5E5E5"> why would you if you're a real</font>

338
00:14:04,440 --> 00:14:08,160
program or<font color="#CCCCCC"> an actual binary why would</font>

339
00:14:06,870 --> 00:14:10,140
you want<font color="#E5E5E5"> to execute something before the</font>

340
00:14:08,160 --> 00:14:12,780
<font color="#E5E5E5">execution of the program to fool the</font>

341
00:14:10,140 --> 00:14:16,110
analyst so if you see something<font color="#E5E5E5"> with TLS</font>

342
00:14:12,780 --> 00:14:19,560
that's already a red flag<font color="#E5E5E5"> all right so</font>

343
00:14:16,110 --> 00:14:21,150
we have<font color="#CCCCCC"> an here terminate process why</font>

344
00:14:19,560 --> 00:14:25,640
would a paint program want to<font color="#E5E5E5"> terminate</font>

345
00:14:21,150 --> 00:14:29,310
the process<font color="#E5E5E5"> of another programs we have</font>

346
00:14:25,640 --> 00:14:31,410
is debugger present<font color="#E5E5E5"> why is</font><font color="#CCCCCC"> the paint</font>

347
00:14:29,310 --> 00:14:32,969
program<font color="#E5E5E5"> trying to detect if a debugger</font>

348
00:14:31,410 --> 00:14:34,439
is present<font color="#CCCCCC"> you see this is only some</font>

349
00:14:32,970 --> 00:14:35,880
like gang signs in here<font color="#E5E5E5"> that you can</font>

350
00:14:34,440 --> 00:14:37,350
detect for malware<font color="#CCCCCC"> when you see</font>

351
00:14:35,880 --> 00:14:38,490
<font color="#E5E5E5">something like this</font><font color="#CCCCCC"> just to keep doing</font>

352
00:14:37,350 --> 00:14:40,620
some analysis you're gonna find some

353
00:14:38,490 --> 00:14:43,710
<font color="#CCCCCC">interesting stuff right now we're gonna</font>

354
00:14:40,620 --> 00:14:47,190
go<font color="#E5E5E5"> for dynamic analysis what I'm gonna</font>

355
00:14:43,710 --> 00:14:49,350
do is that<font color="#CCCCCC"> basically have the Windows</font>

356
00:14:47,190 --> 00:14:51,000
victim machine<font color="#E5E5E5"> which is the virtual</font>

357
00:14:49,350 --> 00:14:54,480
machine that<font color="#E5E5E5"> you just saw it will be</font>

358
00:14:51,000 --> 00:14:58,080
running<font color="#E5E5E5"> it's connected through it's</font>

359
00:14:54,480 --> 00:15:00,300
connected through an IP<font color="#E5E5E5"> ipv4 proxy to my</font>

360
00:14:58,080 --> 00:15:02,880
analysis machine<font color="#E5E5E5"> the Ubuntu machine and</font>

361
00:15:00,300 --> 00:15:05,189
the<font color="#CCCCCC"> Boonta machine is running</font><font color="#E5E5E5"> some just</font>

362
00:15:02,880 --> 00:15:06,660
basically<font color="#E5E5E5"> some traffic analysis to see</font>

363
00:15:05,190 --> 00:15:09,960
what's<font color="#E5E5E5"> going in what's going out what's</font>

364
00:15:06,660 --> 00:15:11,610
the DNS requests<font color="#E5E5E5"> what's happening when</font>

365
00:15:09,960 --> 00:15:12,960
when I click the button

366
00:15:11,610 --> 00:15:16,589
<font color="#E5E5E5">what's the requests that</font><font color="#CCCCCC"> are being</font><font color="#E5E5E5"> made</font>

367
00:15:12,960 --> 00:15:19,110
and there's a small<font color="#E5E5E5"> Python script called</font>

368
00:15:16,589 --> 00:15:21,750
fake DNS<font color="#CCCCCC"> the pie it's uh has a big hub</font>

369
00:15:19,110 --> 00:15:23,040
big github repository<font color="#E5E5E5"> basically what it</font>

370
00:15:21,750 --> 00:15:26,310
does<font color="#E5E5E5"> is that it captures all</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> DNS</font>

371
00:15:23,040 --> 00:15:28,230
requests<font color="#E5E5E5"> and show it to you in here it's</font>

372
00:15:26,310 --> 00:15:29,489
kind of<font color="#E5E5E5"> like running Wireshark or burp</font>

373
00:15:28,230 --> 00:15:30,899
<font color="#E5E5E5">or whatever it is that you want but this</font>

374
00:15:29,490 --> 00:15:32,100
<font color="#CCCCCC">is just</font><font color="#E5E5E5"> for DNS it's</font>

375
00:15:30,899 --> 00:15:34,410
little bit easier if you want to just

376
00:15:32,100 --> 00:15:36,660
know what<font color="#E5E5E5"> you're exactly</font><font color="#CCCCCC"> something</font>

377
00:15:34,410 --> 00:15:41,009
specific what you<font color="#E5E5E5"> need and I seen here</font>

378
00:15:36,660 --> 00:15:42,930
some when<font color="#CCCCCC"> 10</font><font color="#E5E5E5"> API</font><font color="#CCCCCC"> went to an FBI request</font>

379
00:15:41,009 --> 00:15:44,059
and I see something<font color="#CCCCCC"> in here BRB the 3d</font>

380
00:15:42,930 --> 00:15:47,819
touch<font color="#CCCCCC"> that'd be why</font>

381
00:15:44,059 --> 00:15:50,490
what does<font color="#E5E5E5"> which be why domain name</font>

382
00:15:47,819 --> 00:15:50,868
<font color="#E5E5E5">country which country code does it stand</font>

383
00:15:50,490 --> 00:15:55,009
for

384
00:15:50,869 --> 00:15:59,220
anybody it's<font color="#E5E5E5"> not so far away</font><font color="#CCCCCC"> from here</font>

385
00:15:55,009 --> 00:16:01,470
Belarus thank you so and there is a

386
00:15:59,220 --> 00:16:04,110
paint program<font color="#CCCCCC"> that is connecting that</font>

387
00:16:01,470 --> 00:16:06,420
has trying<font color="#E5E5E5"> to connect</font><font color="#CCCCCC"> Belarusians server</font>

388
00:16:04,110 --> 00:16:12,809
it's not from Belarus the paint program

389
00:16:06,420 --> 00:16:14,459
<font color="#E5E5E5">so let's continue on so we running</font>

390
00:16:12,809 --> 00:16:16,589
another tool right<font color="#CCCCCC"> now we're gonna</font><font color="#E5E5E5"> have</font>

391
00:16:14,459 --> 00:16:19,399
a list<font color="#E5E5E5"> of tools at the end of the</font><font color="#CCCCCC"> slide</font>

392
00:16:16,589 --> 00:16:21,629
<font color="#E5E5E5">so don't</font><font color="#CCCCCC"> worry if you miss one of</font><font color="#E5E5E5"> them</font>

393
00:16:19,399 --> 00:16:23,189
<font color="#CCCCCC">this tool is called I need sim</font>

394
00:16:21,629 --> 00:16:26,550
it's<font color="#E5E5E5"> basically what it</font><font color="#CCCCCC"> does is that</font><font color="#E5E5E5"> when</font>

395
00:16:23,189 --> 00:16:29,939
you<font color="#E5E5E5"> are throwing PHP requests it will</font>

396
00:16:26,550 --> 00:16:34,410
reply back<font color="#CCCCCC"> with a small PHP header with</font>

397
00:16:29,939 --> 00:16:36,629
a small PHP page<font color="#E5E5E5"> add fake</font><font color="#CCCCCC"> made PHP page</font>

398
00:16:34,410 --> 00:16:38,579
when you're asking if the victim<font color="#CCCCCC"> machine</font>

399
00:16:36,629 --> 00:16:40,559
is asking<font color="#CCCCCC"> for</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> jpeg it will reply back</font>

400
00:16:38,579 --> 00:16:42,179
<font color="#CCCCCC">with a</font><font color="#E5E5E5"> JPEG</font><font color="#CCCCCC"> it's basically there just to</font>

401
00:16:40,559 --> 00:16:44,370
continue<font color="#E5E5E5"> the analysis it's like</font><font color="#CCCCCC"> okay</font>

402
00:16:42,179 --> 00:16:46,170
we're throwing a request<font color="#E5E5E5"> the victim</font>

403
00:16:44,370 --> 00:16:47,910
<font color="#E5E5E5">machine is still waiting trying to get</font>

404
00:16:46,170 --> 00:16:49,589
<font color="#E5E5E5">something back it will throw it</font>

405
00:16:47,910 --> 00:16:51,600
something back<font color="#E5E5E5"> it's it's just throwing</font>

406
00:16:49,589 --> 00:16:53,129
back a dummy request but it's nice<font color="#CCCCCC"> to</font>

407
00:16:51,600 --> 00:16:55,439
<font color="#CCCCCC">just continue the analysis just</font><font color="#E5E5E5"> to see</font>

408
00:16:53,129 --> 00:16:58,129
how the execution of the ransomware just

409
00:16:55,439 --> 00:17:03,240
goes how far will it go<font color="#E5E5E5"> and it actually</font>

410
00:16:58,129 --> 00:17:07,049
got fooled the the<font color="#CCCCCC"> BRB the 3d</font><font color="#E5E5E5"> touch dot</font>

411
00:17:03,240 --> 00:17:10,230
py had a slash<font color="#E5E5E5"> ads but PHP</font><font color="#CCCCCC"> request</font><font color="#E5E5E5"> and</font>

412
00:17:07,049 --> 00:17:13,829
the victim machine<font color="#CCCCCC"> through a payload</font><font color="#E5E5E5"> all</font>

413
00:17:10,230 --> 00:17:16,949
of this payload through it with to the

414
00:17:13,829 --> 00:17:20,428
host<font color="#E5E5E5"> BRB</font><font color="#CCCCCC"> the 3d totes</font><font color="#E5E5E5"> and I received it</font>

415
00:17:16,949 --> 00:17:22,649
<font color="#E5E5E5">in my analysis machine and at the end of</font>

416
00:17:20,429 --> 00:17:24,899
<font color="#E5E5E5">the presentation we're gonna know what</font>

417
00:17:22,648 --> 00:17:26,760
<font color="#CCCCCC">the hell is happening in</font><font color="#E5E5E5"> here the first</font>

418
00:17:24,898 --> 00:17:27,119
one is<font color="#CCCCCC"> I</font><font color="#E5E5E5"> think pretty easy it's an IP</font>

419
00:17:26,760 --> 00:17:29,908
address

420
00:17:27,119 --> 00:17:31,408
it's my IP address it's my local I'm

421
00:17:29,909 --> 00:17:35,490
using VirtualBox so it's my local

422
00:17:31,409 --> 00:17:38,520
internal torques IP address<font color="#E5E5E5"> static IP</font><font color="#CCCCCC"> I</font>

423
00:17:35,490 --> 00:17:41,700
<font color="#CCCCCC">see in here C equals desktop</font><font color="#E5E5E5"> whatever</font>

424
00:17:38,520 --> 00:17:43,360
<font color="#E5E5E5">that's my computer name and then we see</font>

425
00:17:41,700 --> 00:17:48,100
<font color="#CCCCCC">P equals</font>

426
00:17:43,360 --> 00:17:49,270
huge payload<font color="#E5E5E5"> looks encrypted we're gonna</font>

427
00:17:48,100 --> 00:17:50,439
get to<font color="#E5E5E5"> it later</font><font color="#CCCCCC"> and we're gonna know</font>

428
00:17:49,270 --> 00:17:52,960
what's happening<font color="#CCCCCC"> right now right now we</font>

429
00:17:50,440 --> 00:17:54,520
have we have<font color="#CCCCCC"> an more or</font><font color="#E5E5E5"> less</font>

430
00:17:52,960 --> 00:17:55,780
confirmation that whatever it is<font color="#CCCCCC"> that's</font>

431
00:17:54,520 --> 00:17:57,790
happening<font color="#CCCCCC"> in here</font><font color="#E5E5E5"> it's not a paint</font>

432
00:17:55,780 --> 00:17:59,080
program<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> we still didn't see any</font>

433
00:17:57,790 --> 00:18:03,100
gooeys we're still gonna see<font color="#CCCCCC"> anything</font>

434
00:17:59,080 --> 00:18:05,860
it's connected to<font color="#CCCCCC"> a</font><font color="#E5E5E5"> pollution server so</font>

435
00:18:03,100 --> 00:18:07,510
at this<font color="#E5E5E5"> point you can more or less stop</font>

436
00:18:05,860 --> 00:18:10,439
the analysis until the person<font color="#CCCCCC"> who sent</font>

437
00:18:07,510 --> 00:18:12,580
you<font color="#E5E5E5"> this file don't open it so an</font>

438
00:18:10,440 --> 00:18:13,780
encrypted post request<font color="#E5E5E5"> this is what we</font>

439
00:18:12,580 --> 00:18:15,699
<font color="#E5E5E5">note is the summary of what's happening</font>

440
00:18:13,780 --> 00:18:17,799
we have an encrypted<font color="#E5E5E5"> post request we</font>

441
00:18:15,700 --> 00:18:20,200
have<font color="#E5E5E5"> a</font><font color="#CCCCCC"> reference to</font><font color="#E5E5E5"> PR</font><font color="#CCCCCC"> bit of 3d totes</font>

442
00:18:17,799 --> 00:18:24,040
<font color="#CCCCCC">that be</font><font color="#E5E5E5"> wine there is an interesting</font>

443
00:18:20,200 --> 00:18:25,570
<font color="#E5E5E5">quote is that</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> I can't remember who</font>

444
00:18:24,040 --> 00:18:27,850
<font color="#CCCCCC">said it but in communication it's not</font>

445
00:18:25,570 --> 00:18:32,590
what is being said it's what's not being

446
00:18:27,850 --> 00:18:34,689
said what did I not see in the<font color="#CCCCCC"> list</font><font color="#E5E5E5"> of</font>

447
00:18:32,590 --> 00:18:37,899
imports in here I see a lot of function

448
00:18:34,690 --> 00:18:40,809
names<font color="#E5E5E5"> what am I not</font><font color="#CCCCCC"> saying</font><font color="#E5E5E5"> there is the</font>

449
00:18:37,900 --> 00:18:43,750
<font color="#E5E5E5">internet</font><font color="#CCCCCC"> functions the HTTP requests</font>

450
00:18:40,809 --> 00:18:46,120
<font color="#E5E5E5">that made this where is it it has to be</font>

451
00:18:43,750 --> 00:18:48,610
<font color="#E5E5E5">made through an import through a when I</font>

452
00:18:46,120 --> 00:18:50,918
net dot<font color="#CCCCCC"> dll import to be specific</font>

453
00:18:48,610 --> 00:18:53,290
that's the<font color="#CCCCCC"> DLL library for win32 api</font>

454
00:18:50,919 --> 00:18:56,049
<font color="#E5E5E5">that's responsible for</font><font color="#CCCCCC"> handling</font><font color="#E5E5E5"> network</font>

455
00:18:53,290 --> 00:19:01,149
requests<font color="#E5E5E5"> I didn't see it it's not there</font>

456
00:18:56,049 --> 00:19:04,809
so there is no cryptography imports<font color="#E5E5E5"> none</font>

457
00:19:01,150 --> 00:19:05,410
actually<font color="#E5E5E5"> I just got infected by</font>

458
00:19:04,809 --> 00:19:08,020
ransomware

459
00:19:05,410 --> 00:19:10,240
<font color="#E5E5E5">so I'm</font><font color="#CCCCCC"> expecting that</font><font color="#E5E5E5"> the library that</font>

460
00:19:08,020 --> 00:19:12,970
if every binary<font color="#E5E5E5"> that infected me could</font>

461
00:19:10,240 --> 00:19:15,640
have some cryptographic functions like

462
00:19:12,970 --> 00:19:17,080
crept encrypt that's the number<font color="#E5E5E5"> one</font>

463
00:19:15,640 --> 00:19:19,270
cryptographic functions that you<font color="#E5E5E5"> need to</font>

464
00:19:17,080 --> 00:19:21,100
actually<font color="#E5E5E5"> encrypt stuff in 132 API</font>

465
00:19:19,270 --> 00:19:25,059
<font color="#CCCCCC">krypton crap it's not there it's</font><font color="#E5E5E5"> not</font>

466
00:19:21,100 --> 00:19:26,530
<font color="#E5E5E5">done a list of imports so moving on with</font>

467
00:19:25,059 --> 00:19:28,240
the analysis<font color="#E5E5E5"> we're done with the dynamic</font>

468
00:19:26,530 --> 00:19:29,950
analysis by the<font color="#E5E5E5"> way we know that it's</font>

469
00:19:28,240 --> 00:19:32,919
doing something funky<font color="#E5E5E5"> we know that we</font>

470
00:19:29,950 --> 00:19:35,740
need<font color="#CCCCCC"> to go further let's actually</font><font color="#E5E5E5"> start</font>

471
00:19:32,919 --> 00:19:37,690
having<font color="#E5E5E5"> a preparation for</font><font color="#CCCCCC"> the static code</font>

472
00:19:35,740 --> 00:19:41,440
analysis for actually attaching a

473
00:19:37,690 --> 00:19:43,030
debugger or disassembler for<font color="#E5E5E5"> radar or</font>

474
00:19:41,440 --> 00:19:45,280
either pro or whatever it<font color="#E5E5E5"> is that you</font>

475
00:19:43,030 --> 00:19:47,559
want and<font color="#CCCCCC"> we can</font><font color="#E5E5E5"> start</font><font color="#CCCCCC"> getting prepared</font>

476
00:19:45,280 --> 00:19:49,990
<font color="#E5E5E5">for that part to do that we need to</font>

477
00:19:47,559 --> 00:19:52,870
check for<font color="#E5E5E5"> Packers</font><font color="#CCCCCC"> as in a small</font>

478
00:19:49,990 --> 00:19:54,310
<font color="#E5E5E5">one-liner a packer</font><font color="#CCCCCC"> is usually a program</font>

479
00:19:52,870 --> 00:19:58,840
that is

480
00:19:54,310 --> 00:20:01,870
encrypting the program<font color="#E5E5E5"> it's a V a</font><font color="#CCCCCC"> Packer</font>

481
00:19:58,840 --> 00:20:04,659
<font color="#E5E5E5">is a wrapper around the program that is</font>

482
00:20:01,870 --> 00:20:06,310
encrypting the real<font color="#E5E5E5"> program the child</font>

483
00:20:04,660 --> 00:20:06,520
binary the one that's actually<font color="#E5E5E5"> doing the</font>

484
00:20:06,310 --> 00:20:08,830
work

485
00:20:06,520 --> 00:20:11,920
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> encrypting it and once you click</font>

486
00:20:08,830 --> 00:20:15,070
<font color="#E5E5E5">the executable and</font><font color="#CCCCCC"> actual try</font><font color="#E5E5E5"> to execute</font>

487
00:20:11,920 --> 00:20:18,370
<font color="#E5E5E5">it it will unpack it and you will have</font>

488
00:20:15,070 --> 00:20:20,439
the real binary<font color="#E5E5E5"> why does it put a small</font>

489
00:20:18,370 --> 00:20:22,229
binary into a box close it and gives<font color="#E5E5E5"> it</font>

490
00:20:20,440 --> 00:20:24,820
<font color="#CCCCCC">to</font><font color="#E5E5E5"> the client why is it doing it this</font>

491
00:20:22,230 --> 00:20:27,820
application it's basically<font color="#E5E5E5"> trying to</font>

492
00:20:24,820 --> 00:20:30,340
<font color="#E5E5E5">hide itself from the analysis either an</font>

493
00:20:27,820 --> 00:20:32,950
automated<font color="#E5E5E5"> mail and a scanner or an</font>

494
00:20:30,340 --> 00:20:35,260
<font color="#E5E5E5">anti-virus or me the analyst it's right</font>

495
00:20:32,950 --> 00:20:36,850
it's trying to hide itself<font color="#E5E5E5"> and we have</font>

496
00:20:35,260 --> 00:20:39,070
some tools<font color="#E5E5E5"> in here to</font><font color="#CCCCCC"> actually check for</font>

497
00:20:36,850 --> 00:20:41,260
Packers at some online tools we can

498
00:20:39,070 --> 00:20:43,300
check it out in here<font color="#CCCCCC"> exe m4 detects it</font>

499
00:20:41,260 --> 00:20:45,070
easy<font color="#E5E5E5"> none</font><font color="#CCCCCC"> of them actually detected a</font>

500
00:20:43,300 --> 00:20:50,110
<font color="#CCCCCC">packet as you can see in</font><font color="#E5E5E5"> here it says</font>

501
00:20:45,070 --> 00:20:52,870
not packed the<font color="#E5E5E5"> this tool which is the</font>

502
00:20:50,110 --> 00:20:54,280
CLI version of this tool it's different

503
00:20:52,870 --> 00:20:54,820
ports<font color="#E5E5E5"> that's actually doing something</font>

504
00:20:54,280 --> 00:20:57,760
different

505
00:20:54,820 --> 00:21:00,070
it says not packet has anti debug so

506
00:20:57,760 --> 00:21:01,480
it's definitely<font color="#E5E5E5"> doing something funny</font><font color="#CCCCCC"> we</font>

507
00:21:00,070 --> 00:21:03,460
didn't detect<font color="#CCCCCC"> the packer but we didn't</font>

508
00:21:01,480 --> 00:21:04,780
<font color="#CCCCCC">detect any Internet functionality we</font>

509
00:21:03,460 --> 00:21:06,850
didn't affect any cryptographic methods

510
00:21:04,780 --> 00:21:11,800
<font color="#E5E5E5">so we still</font><font color="#CCCCCC"> need to go</font><font color="#E5E5E5"> through with the</font>

511
00:21:06,850 --> 00:21:14,800
analysis theory we<font color="#E5E5E5"> have two theories now</font>

512
00:21:11,800 --> 00:21:18,250
the binary is protected with<font color="#E5E5E5"> a packet</font>

513
00:21:14,800 --> 00:21:19,960
it's it's a protected with a packer<font color="#E5E5E5"> the</font>

514
00:21:18,250 --> 00:21:22,060
second one is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> crypt encrypt is used</font>

515
00:21:19,960 --> 00:21:24,580
somewhere<font color="#E5E5E5"> crypt encrypt as I said before</font>

516
00:21:22,060 --> 00:21:27,129
is the<font color="#E5E5E5"> cryptographic function that is</font>

517
00:21:24,580 --> 00:21:29,260
necessary for encrypting<font color="#CCCCCC"> a section of</font>

518
00:21:27,130 --> 00:21:31,330
<font color="#E5E5E5">plaintext</font><font color="#CCCCCC"> that's if you're writing</font>

519
00:21:29,260 --> 00:21:32,740
around somewhere<font color="#CCCCCC"> you will have to use</font>

520
00:21:31,330 --> 00:21:35,439
this<font color="#CCCCCC"> function or you have to</font><font color="#E5E5E5"> make your</font>

521
00:21:32,740 --> 00:21:37,030
<font color="#CCCCCC">own</font><font color="#E5E5E5"> cryptographic methods so I'm gonna</font>

522
00:21:35,440 --> 00:21:38,590
go with the Occam's razor with the

523
00:21:37,030 --> 00:21:40,810
<font color="#E5E5E5">easiest path is a</font><font color="#CCCCCC"> straight forward path</font>

524
00:21:38,590 --> 00:21:42,879
so I'm just gonna go to assume as a

525
00:21:40,810 --> 00:21:45,340
theory<font color="#CCCCCC"> that</font><font color="#E5E5E5"> crypt encrypt will be used</font>

526
00:21:42,880 --> 00:21:48,490
so<font color="#CCCCCC"> I need to know where is it</font><font color="#E5E5E5"> being</font><font color="#CCCCCC"> used</font>

527
00:21:45,340 --> 00:21:50,800
how and<font color="#E5E5E5"> the first theory is that this</font>

528
00:21:48,490 --> 00:21:52,960
<font color="#CCCCCC">binary is encrypted</font><font color="#E5E5E5"> somewhere somehow</font><font color="#CCCCCC"> I</font>

529
00:21:50,800 --> 00:21:55,930
<font color="#E5E5E5">don't know why I don't</font><font color="#CCCCCC"> know how but I'm</font>

530
00:21:52,960 --> 00:21:58,360
just<font color="#E5E5E5"> assuming virtual protect is the</font>

531
00:21:55,930 --> 00:22:00,280
method<font color="#E5E5E5"> that is</font><font color="#CCCCCC"> being used to actually</font>

532
00:21:58,360 --> 00:22:02,679
<font color="#E5E5E5">change the protection of a region of</font>

533
00:22:00,280 --> 00:22:06,399
<font color="#E5E5E5">memory into</font><font color="#CCCCCC"> writable or readable</font><font color="#E5E5E5"> or</font>

534
00:22:02,680 --> 00:22:08,169
executable<font color="#E5E5E5"> so if I'm a packer and I want</font>

535
00:22:06,400 --> 00:22:09,639
to<font color="#E5E5E5"> unpack my child binary</font>

536
00:22:08,169 --> 00:22:11,739
we'll have to use this function<font color="#CCCCCC"> to map</font>

537
00:22:09,639 --> 00:22:15,219
out a section of<font color="#E5E5E5"> memory</font><font color="#CCCCCC"> that I can</font>

538
00:22:11,739 --> 00:22:16,989
<font color="#CCCCCC">unpack it in</font><font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can do this in</font>

539
00:22:15,220 --> 00:22:19,539
<font color="#CCCCCC">different methods of course there's ten</font>

540
00:22:16,989 --> 00:22:21,039
ways<font color="#CCCCCC"> to do this thing but this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> just</font>

541
00:22:19,539 --> 00:22:22,600
<font color="#CCCCCC">one of the most famous ones and I'm</font>

542
00:22:21,039 --> 00:22:26,320
going with<font color="#CCCCCC"> the</font><font color="#E5E5E5"> theory in here I'm gonna</font>

543
00:22:22,600 --> 00:22:28,869
see how this<font color="#E5E5E5"> theory holds up so I'm</font>

544
00:22:26,320 --> 00:22:32,320
attaching a small debugger in here it's

545
00:22:28,869 --> 00:22:35,439
I'm using<font color="#E5E5E5"> x32 debug</font><font color="#CCCCCC"> it's one of the</font>

546
00:22:32,320 --> 00:22:36,730
<font color="#E5E5E5">variations of x64 debug project and in</font>

547
00:22:35,440 --> 00:22:38,649
my opinion<font color="#CCCCCC"> it's a great open source</font>

548
00:22:36,730 --> 00:22:41,409
<font color="#E5E5E5">project if you're using</font><font color="#CCCCCC"> community or</font>

549
00:22:38,649 --> 00:22:44,018
<font color="#E5E5E5">something</font><font color="#CCCCCC"> I use</font><font color="#E5E5E5"> immunity it's amazing</font>

550
00:22:41,409 --> 00:22:45,549
but this one<font color="#CCCCCC"> I</font><font color="#E5E5E5"> really like it it's</font><font color="#CCCCCC"> very</font>

551
00:22:44,019 --> 00:22:47,230
<font color="#E5E5E5">good it has all the features that</font><font color="#CCCCCC"> you</font>

552
00:22:45,549 --> 00:22:51,009
need<font color="#E5E5E5"> and the GUI is actually</font>

553
00:22:47,230 --> 00:22:53,470
<font color="#CCCCCC">nice-looking so</font><font color="#E5E5E5"> so I'm attaching this</font>

554
00:22:51,009 --> 00:22:55,600
binary into a debugger<font color="#E5E5E5"> and I'm running</font>

555
00:22:53,470 --> 00:23:01,210
<font color="#E5E5E5">virtual protect on it by the way how am</font>

556
00:22:55,600 --> 00:23:04,269
i doing<font color="#E5E5E5"> in time so basically we're</font>

557
00:23:01,210 --> 00:23:06,749
<font color="#E5E5E5">attaching a debugger in here attaching a</font>

558
00:23:04,269 --> 00:23:09,480
breakpoint<font color="#E5E5E5"> on virtual protect and</font>

559
00:23:06,749 --> 00:23:11,619
running the executable<font color="#CCCCCC"> and it hit</font>

560
00:23:09,480 --> 00:23:16,269
virtual protect was not in the imports

561
00:23:11,619 --> 00:23:21,730
list<font color="#E5E5E5"> but it hit I see it how is this</font>

562
00:23:16,269 --> 00:23:23,200
happening we check<font color="#CCCCCC"> that will answer</font><font color="#E5E5E5"> how</font>

563
00:23:21,730 --> 00:23:24,789
is it happening<font color="#CCCCCC"> later</font><font color="#E5E5E5"> right now</font><font color="#CCCCCC"> we</font>

564
00:23:23,200 --> 00:23:27,429
actually know that<font color="#E5E5E5"> virtual protect</font><font color="#CCCCCC"> is</font>

565
00:23:24,789 --> 00:23:33,309
doing is<font color="#E5E5E5"> reserving a section of</font><font color="#CCCCCC"> memory</font>

566
00:23:27,429 --> 00:23:36,429
with<font color="#CCCCCC"> er</font><font color="#E5E5E5"> w ER</font><font color="#CCCCCC"> w means execute</font><font color="#E5E5E5"> read write</font>

567
00:23:33,309 --> 00:23:38,379
a paint<font color="#E5E5E5"> program has just used virtual</font>

568
00:23:36,429 --> 00:23:41,859
protect on an import that's not listed

569
00:23:38,379 --> 00:23:44,408
<font color="#E5E5E5">it's hidden and it's mapped out a</font>

570
00:23:41,859 --> 00:23:47,918
section of<font color="#E5E5E5"> memory with</font><font color="#CCCCCC"> er W execute</font>

571
00:23:44,409 --> 00:23:49,389
<font color="#CCCCCC">read/write so if you ask me this</font><font color="#E5E5E5"> is</font>

572
00:23:47,919 --> 00:23:52,960
happening because it's<font color="#E5E5E5"> trying to unpack</font>

573
00:23:49,389 --> 00:23:54,668
the binary theory<font color="#CCCCCC"> number one was correct</font>

574
00:23:52,960 --> 00:23:56,259
<font color="#E5E5E5">we know how it's working</font><font color="#CCCCCC"> right now we</font>

575
00:23:54,669 --> 00:23:58,720
know the debugger is actually present

576
00:23:56,259 --> 00:24:00,460
<font color="#CCCCCC">and</font><font color="#E5E5E5"> it's we know that the virtual</font>

577
00:23:58,720 --> 00:24:01,690
protect is present and<font color="#E5E5E5"> it is mapping a</font>

578
00:24:00,460 --> 00:24:03,879
section of memory<font color="#CCCCCC"> with execute</font>

579
00:24:01,690 --> 00:24:05,470
<font color="#CCCCCC">read/write we</font><font color="#E5E5E5"> can go on</font><font color="#CCCCCC"> we may be</font>

580
00:24:03,879 --> 00:24:07,389
available<font color="#E5E5E5"> to</font><font color="#CCCCCC"> actually get the decryption</font>

581
00:24:05,470 --> 00:24:08,769
<font color="#E5E5E5">keys which this might be</font><font color="#CCCCCC"> helpful</font><font color="#E5E5E5"> for</font>

582
00:24:07,389 --> 00:24:12,039
anybody who fell for this

583
00:24:08,769 --> 00:24:16,690
so we attach<font color="#CCCCCC"> another</font><font color="#E5E5E5"> breakpoint</font><font color="#CCCCCC"> set BBX</font>

584
00:24:12,039 --> 00:24:20,679
crypt encrypt and decrypt encrypted

585
00:24:16,690 --> 00:24:22,029
scription<font color="#CCCCCC"> and it hits again the</font><font color="#E5E5E5"> binary</font>

586
00:24:20,679 --> 00:24:24,700
is being unpacked

587
00:24:22,029 --> 00:24:27,039
through a custom<font color="#CCCCCC"> Packer</font><font color="#E5E5E5"> not listed not</font>

588
00:24:24,700 --> 00:24:29,109
known not<font color="#E5E5E5"> upx not something that any of</font>

589
00:24:27,039 --> 00:24:31,330
<font color="#E5E5E5">the</font><font color="#CCCCCC"> three tools that I ran were able to</font>

590
00:24:29,109 --> 00:24:33,759
figure<font color="#E5E5E5"> it</font><font color="#CCCCCC"> out and</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> just hit two</font>

591
00:24:31,330 --> 00:24:38,139
imports not listed and I just hit<font color="#CCCCCC"> script</font>

592
00:24:33,759 --> 00:24:39,849
encrypt we will be able<font color="#E5E5E5"> to if we</font>

593
00:24:38,139 --> 00:24:42,908
actually<font color="#E5E5E5"> see what's the section of</font>

594
00:24:39,849 --> 00:24:44,168
memory<font color="#E5E5E5"> that's being decrypted right and</font>

595
00:24:42,909 --> 00:24:46,899
not decrypted the section of<font color="#CCCCCC"> memory</font>

596
00:24:44,169 --> 00:24:50,460
that's<font color="#E5E5E5"> being used that is coming</font><font color="#CCCCCC"> from</font>

597
00:24:46,899 --> 00:24:53,949
Krypton crypt it's here<font color="#CCCCCC"> all four two</font>

598
00:24:50,460 --> 00:24:57,070
three eight the entire<font color="#CCCCCC"> oh four</font><font color="#E5E5E5"> two</font><font color="#CCCCCC"> three</font>

599
00:24:53,950 --> 00:24:58,330
<font color="#E5E5E5">zero memory section is the section</font><font color="#CCCCCC"> that</font>

600
00:24:57,070 --> 00:25:01,658
was unpacked

601
00:24:58,330 --> 00:25:08,349
it's the<font color="#E5E5E5"> erw section and I see right</font>

602
00:25:01,659 --> 00:25:11,169
here<font color="#E5E5E5"> MZ what does MZ mean folks exactly</font>

603
00:25:08,349 --> 00:25:12,939
<font color="#E5E5E5">executable M G stands for mr. marks</font>

604
00:25:11,169 --> 00:25:14,859
<font color="#E5E5E5">Barsky</font><font color="#CCCCCC"> if I'm</font><font color="#E5E5E5"> saying his name right he's</font>

605
00:25:12,940 --> 00:25:16,749
the<font color="#E5E5E5"> creator of PE</font><font color="#CCCCCC"> he's the creator of</font>

606
00:25:14,859 --> 00:25:18,279
the executable file<font color="#E5E5E5"> just kudos to him</font>

607
00:25:16,749 --> 00:25:19,839
<font color="#E5E5E5">because he</font><font color="#CCCCCC"> actually from what I</font><font color="#E5E5E5"> heard</font>

608
00:25:18,279 --> 00:25:22,479
that a lot<font color="#CCCCCC"> of lawsuits because every</font>

609
00:25:19,839 --> 00:25:23,889
time somebody<font color="#E5E5E5"> say sees an MZ they call</font>

610
00:25:22,479 --> 00:25:31,899
him and they say oh my<font color="#CCCCCC"> god you just</font>

611
00:25:23,889 --> 00:25:36,248
created<font color="#E5E5E5"> a malware</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so we just</font>

612
00:25:31,899 --> 00:25:39,099
proved the two<font color="#CCCCCC"> Theory's correct and we</font>

613
00:25:36,249 --> 00:25:41,109
were<font color="#CCCCCC"> able to</font><font color="#E5E5E5"> extract after we took this</font>

614
00:25:39,099 --> 00:25:43,658
executable<font color="#E5E5E5"> read</font><font color="#CCCCCC"> write section of memory</font>

615
00:25:41,109 --> 00:25:46,570
<font color="#CCCCCC">we were able to go</font><font color="#E5E5E5"> ahead and see the</font>

616
00:25:43,659 --> 00:25:50,289
entire real<font color="#CCCCCC"> binary the unpacked binary</font>

617
00:25:46,570 --> 00:25:52,658
which does have and this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the name of</font>

618
00:25:50,289 --> 00:25:54,669
<font color="#E5E5E5">the</font><font color="#CCCCCC"> unpacked binary dumped bin this</font>

619
00:25:52,659 --> 00:25:56,589
executable<font color="#CCCCCC"> readwrite section of memory</font>

620
00:25:54,669 --> 00:25:59,080
<font color="#CCCCCC">it's actually a small PE file</font><font color="#E5E5E5"> it's a</font>

621
00:25:56,589 --> 00:26:01,239
small executable and we unpacked it<font color="#E5E5E5"> and</font>

622
00:25:59,080 --> 00:26:03,099
we did see cryptographic<font color="#E5E5E5"> imports right</font>

623
00:26:01,239 --> 00:26:05,349
here and strings we didn't even have<font color="#E5E5E5"> to</font>

624
00:26:03,099 --> 00:26:07,269
go through<font color="#CCCCCC"> PE studio</font><font color="#E5E5E5"> crypt encrypt crypt</font>

625
00:26:05,349 --> 00:26:09,339
<font color="#CCCCCC">acquire context script derive key</font>

626
00:26:07,269 --> 00:26:10,869
<font color="#E5E5E5">everything in here destroy key which is</font>

627
00:26:09,339 --> 00:26:13,178
not so good<font color="#CCCCCC"> for the people</font><font color="#E5E5E5"> who actually</font>

628
00:26:10,869 --> 00:26:15,070
<font color="#E5E5E5">just</font><font color="#CCCCCC"> cut their files encrypted so you're</font>

629
00:26:13,179 --> 00:26:16,889
kind of<font color="#E5E5E5"> like locking</font><font color="#CCCCCC"> the key and then</font>

630
00:26:15,070 --> 00:26:19,989
just destroying<font color="#E5E5E5"> it</font><font color="#CCCCCC"> so that's not funny</font>

631
00:26:16,889 --> 00:26:22,748
but it's doing a request and<font color="#E5E5E5"> it is</font>

632
00:26:19,989 --> 00:26:24,519
sending a small payload that<font color="#E5E5E5"> I'm just</font>

633
00:26:22,749 --> 00:26:27,639
assuming here<font color="#E5E5E5"> contains the encryption</font>

634
00:26:24,519 --> 00:26:30,820
keys or not you know the attacker could

635
00:26:27,639 --> 00:26:32,199
be just sending encrypted blob of data

636
00:26:30,820 --> 00:26:34,250
<font color="#E5E5E5">that doesn't have anything you send</font>

637
00:26:32,200 --> 00:26:36,340
<font color="#E5E5E5">money to him and then he's like help</font>

638
00:26:34,250 --> 00:26:42,670
<font color="#CCCCCC">I don't have</font><font color="#E5E5E5"> a case oh you have the kid</font>

639
00:26:36,340 --> 00:26:44,720
<font color="#E5E5E5">so and this</font><font color="#CCCCCC"> is more or less the entire</font>

640
00:26:42,670 --> 00:26:45,620
analysis that we need to<font color="#E5E5E5"> continue that's</font>

641
00:26:44,720 --> 00:26:47,690
<font color="#CCCCCC">the a full-circle</font>

642
00:26:45,620 --> 00:26:49,070
static<font color="#E5E5E5"> analysis dynamic analysis we know</font>

643
00:26:47,690 --> 00:26:52,130
the properties we know everything what's

644
00:26:49,070 --> 00:26:54,560
happening right now<font color="#CCCCCC"> and further analysis</font>

645
00:26:52,130 --> 00:26:56,330
if you<font color="#E5E5E5"> continue going</font><font color="#CCCCCC"> through this thing</font>

646
00:26:54,560 --> 00:26:58,129
with<font color="#E5E5E5"> ida pro or rad re or something</font>

647
00:26:56,330 --> 00:26:59,810
<font color="#E5E5E5">which by the way if you notice i still</font>

648
00:26:58,130 --> 00:27:01,190
<font color="#E5E5E5">haven't used</font><font color="#CCCCCC"> i did more</font><font color="#E5E5E5"> or less</font>

649
00:26:59,810 --> 00:27:03,620
everything<font color="#E5E5E5"> with just</font><font color="#CCCCCC"> using a debugger</font>

650
00:27:01,190 --> 00:27:05,090
<font color="#CCCCCC">you don't need to know assembly to do</font>

651
00:27:03,620 --> 00:27:06,709
malware analysis<font color="#E5E5E5"> that's something</font>

652
00:27:05,090 --> 00:27:08,929
important<font color="#E5E5E5"> it's good that you know it's</font>

653
00:27:06,710 --> 00:27:11,480
necessary<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you know it but it's not</font>

654
00:27:08,930 --> 00:27:13,160
<font color="#E5E5E5">hundred-percent required you</font><font color="#CCCCCC"> can still</font>

655
00:27:11,480 --> 00:27:14,600
know what you need to do if you know how

656
00:27:13,160 --> 00:27:17,210
<font color="#E5E5E5">to use the tooling and you know how to</font>

657
00:27:14,600 --> 00:27:19,459
use the methodology<font color="#CCCCCC"> behind it as we said</font>

658
00:27:17,210 --> 00:27:22,580
<font color="#E5E5E5">before surgical approach</font><font color="#CCCCCC"> i think i'm</font>

659
00:27:19,460 --> 00:27:25,940
closing<font color="#E5E5E5"> in on time so um more or less</font>

660
00:27:22,580 --> 00:27:27,800
done<font color="#E5E5E5"> that's the conclusion</font><font color="#CCCCCC"> and what</font><font color="#E5E5E5"> i</font>

661
00:27:25,940 --> 00:27:29,750
want<font color="#E5E5E5"> to take out of this</font><font color="#CCCCCC"> is that if</font>

662
00:27:27,800 --> 00:27:31,639
you're a starting malware analyst<font color="#E5E5E5"> or you</font>

663
00:27:29,750 --> 00:27:34,820
just<font color="#E5E5E5"> are interested with this thing go</font>

664
00:27:31,640 --> 00:27:37,220
and<font color="#E5E5E5"> take a small malware from the zoo</font>

665
00:27:34,820 --> 00:27:39,379
maybe the github<font color="#CCCCCC"> repo that</font><font color="#E5E5E5"> i mention or</font>

666
00:27:37,220 --> 00:27:42,440
from anywhere you want from your friends

667
00:27:39,380 --> 00:27:43,670
honeypot and try to<font color="#E5E5E5"> analyze it try to</font>

668
00:27:42,440 --> 00:27:45,170
see how it<font color="#CCCCCC"> goes</font><font color="#E5E5E5"> this one was a little</font>

669
00:27:43,670 --> 00:27:47,480
<font color="#E5E5E5">bit complex actually</font><font color="#CCCCCC"> this one will has a</font>

670
00:27:45,170 --> 00:27:49,400
custom<font color="#CCCCCC"> Packer not every</font><font color="#E5E5E5"> binaries has a</font>

671
00:27:47,480 --> 00:27:51,200
custom<font color="#CCCCCC"> Packer that's</font><font color="#E5E5E5"> pretty unique thing</font>

672
00:27:49,400 --> 00:27:53,480
<font color="#CCCCCC">actually pretty hard process</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> write</font>

673
00:27:51,200 --> 00:27:54,830
your own<font color="#E5E5E5"> alpha scalar and a</font><font color="#CCCCCC"> packer</font><font color="#E5E5E5"> you</font>

674
00:27:53,480 --> 00:27:56,900
can go ahead<font color="#CCCCCC"> and do it</font><font color="#E5E5E5"> put it on</font><font color="#CCCCCC"> a</font>

675
00:27:54,830 --> 00:27:59,330
virtual<font color="#E5E5E5"> machine connected through an</font>

676
00:27:56,900 --> 00:28:02,540
analysis<font color="#CCCCCC"> machine run the tools that we</font>

677
00:27:59,330 --> 00:28:04,449
just saw fake<font color="#CCCCCC"> DNS and I netsim see the</font>

678
00:28:02,540 --> 00:28:07,310
requests that<font color="#CCCCCC"> are</font><font color="#E5E5E5"> going in and out and</font>

679
00:28:04,450 --> 00:28:08,780
maybe you can actually<font color="#E5E5E5"> know what is</font>

680
00:28:07,310 --> 00:28:10,159
happening the<font color="#CCCCCC"> entire walk through the</font>

681
00:28:08,780 --> 00:28:11,690
entire<font color="#E5E5E5"> cycle and you'll be able</font><font color="#CCCCCC"> to at</font>

682
00:28:10,160 --> 00:28:13,550
<font color="#CCCCCC">least write a report and</font><font color="#E5E5E5"> say oh this</font>

683
00:28:11,690 --> 00:28:14,840
malware<font color="#E5E5E5"> does</font><font color="#CCCCCC"> one two three</font><font color="#E5E5E5"> because of</font>

684
00:28:13,550 --> 00:28:17,450
this imports<font color="#E5E5E5"> because of that</font><font color="#CCCCCC"> packer</font>

685
00:28:14,840 --> 00:28:19,730
because of this and that<font color="#CCCCCC"> and you will</font><font color="#E5E5E5"> be</font>

686
00:28:17,450 --> 00:28:21,020
able if you're working for an IP as

687
00:28:19,730 --> 00:28:23,360
you'll<font color="#CCCCCC"> be able to extract signatures</font>

688
00:28:21,020 --> 00:28:25,340
maybe you can put it<font color="#CCCCCC"> into</font><font color="#E5E5E5"> your networks</font>

689
00:28:23,360 --> 00:28:30,340
<font color="#CCCCCC">IPS so that it can detect such a thing</font>

690
00:28:25,340 --> 00:28:30,340
and thank you<font color="#E5E5E5"> so</font><font color="#CCCCCC"> much</font><font color="#E5E5E5"> for listening</font>

691
00:28:35,770 --> 00:28:42,200
thank you so<font color="#CCCCCC"> much of</font><font color="#E5E5E5"> loss</font><font color="#CCCCCC"> oh I bet we</font>

692
00:28:38,570 --> 00:28:52,639
have some questions<font color="#CCCCCC"> here's the first</font><font color="#E5E5E5"> one</font>

693
00:28:42,200 --> 00:28:54,110
<font color="#E5E5E5">please the third you know left it</font><font color="#CCCCCC"> so</font>

694
00:28:52,640 --> 00:28:56,510
thank<font color="#E5E5E5"> you</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> first of all for the</font>

695
00:28:54,110 --> 00:28:59,419
wonderful<font color="#CCCCCC"> presentation</font><font color="#E5E5E5"> and very</font>

696
00:28:56,510 --> 00:29:01,460
interesting<font color="#E5E5E5"> so when the malware</font><font color="#CCCCCC"> no you</font>

697
00:28:59,420 --> 00:29:03,320
<font color="#E5E5E5">caught it you missed it and it encrypted</font>

698
00:29:01,460 --> 00:29:06,230
all your files yes

699
00:29:03,320 --> 00:29:10,010
so<font color="#E5E5E5"> they exist also the descriptors of</font>

700
00:29:06,230 --> 00:29:12,710
<font color="#E5E5E5">the old one CS of the old</font><font color="#CCCCCC"> malware's I</font>

701
00:29:10,010 --> 00:29:15,860
didn't understand I'm<font color="#E5E5E5"> sorry so when your</font>

702
00:29:12,710 --> 00:29:18,020
information is encrypted yes<font color="#E5E5E5"> and you</font>

703
00:29:15,860 --> 00:29:21,770
cannot decrypt it without<font color="#CCCCCC"> a</font><font color="#E5E5E5"> key but as I</font>

704
00:29:18,020 --> 00:29:24,760
know they exist<font color="#E5E5E5"> some descriptors for</font>

705
00:29:21,770 --> 00:29:27,440
malware that were<font color="#E5E5E5"> used before yes</font>

706
00:29:24,760 --> 00:29:28,610
they're good<font color="#CCCCCC"> people to think is what</font>

707
00:29:27,440 --> 00:29:30,950
<font color="#E5E5E5">this malware does is that</font><font color="#CCCCCC"> it's</font>

708
00:29:28,610 --> 00:29:32,570
encrypting<font color="#E5E5E5"> it with RSA and a yes with</font>

709
00:29:30,950 --> 00:29:34,940
that<font color="#E5E5E5"> from what I understand</font><font color="#CCCCCC"> are not</font><font color="#E5E5E5"> a</font>

710
00:29:32,570 --> 00:29:36,919
cryptographer<font color="#CCCCCC"> but you need the</font>

711
00:29:34,940 --> 00:29:39,980
decryption key for that<font color="#CCCCCC"> yes for such a</font>

712
00:29:36,920 --> 00:29:42,560
thing<font color="#CCCCCC"> there are</font><font color="#E5E5E5"> the right equation is</font>

713
00:29:39,980 --> 00:29:44,440
the Decrypter that exists<font color="#E5E5E5"> so probably</font>

714
00:29:42,560 --> 00:29:47,389
they have the key yes

715
00:29:44,440 --> 00:29:50,840
depends on the malware<font color="#E5E5E5"> if the malware</font>

716
00:29:47,390 --> 00:29:52,610
generates a random key because of it I

717
00:29:50,840 --> 00:29:54,500
<font color="#E5E5E5">asked so it generates</font><font color="#CCCCCC"> a random key yes</font>

718
00:29:52,610 --> 00:29:56,479
<font color="#CCCCCC">further analysis could show you that</font>

719
00:29:54,500 --> 00:29:58,520
<font color="#CCCCCC">there is a hard-coded</font><font color="#E5E5E5"> encryption key and</font>

720
00:29:56,480 --> 00:30:00,560
<font color="#CCCCCC">there then there</font><font color="#E5E5E5"> will be a decryption</font>

721
00:29:58,520 --> 00:30:03,050
<font color="#CCCCCC">key that's also static and constant</font>

722
00:30:00,560 --> 00:30:04,790
across all but it could be random<font color="#CCCCCC"> I</font>

723
00:30:03,050 --> 00:30:06,350
actually didn't do enough analysis on

724
00:30:04,790 --> 00:30:08,870
this<font color="#E5E5E5"> one to know if it's random</font><font color="#CCCCCC"> or just</font>

725
00:30:06,350 --> 00:30:11,050
a static one<font color="#E5E5E5"> mm-hm</font><font color="#CCCCCC"> okay thank you very</font>

726
00:30:08,870 --> 00:30:11,050
much

727
00:30:15,929 --> 00:30:25,960
so we have a mic there<font color="#E5E5E5"> okay so you</font>

728
00:30:21,090 --> 00:30:28,750
<font color="#CCCCCC">alright so yes in your opinion what</font>

729
00:30:25,960 --> 00:30:32,309
<font color="#CCCCCC">makes a malware</font><font color="#E5E5E5"> almost impossible or</font>

730
00:30:28,750 --> 00:30:38,140
actually impossible<font color="#CCCCCC"> to reverse</font>

731
00:30:32,309 --> 00:30:40,720
<font color="#E5E5E5">impossible to reverse yes</font><font color="#CCCCCC"> I don't when</font>

732
00:30:38,140 --> 00:30:43,480
you're attaching a debugger to<font color="#CCCCCC"> um any</font>

733
00:30:40,720 --> 00:30:43,899
binary<font color="#E5E5E5"> you're entering</font><font color="#CCCCCC"> God mode</font><font color="#E5E5E5"> right</font>

734
00:30:43,480 --> 00:30:46,600
<font color="#E5E5E5">now</font>

735
00:30:43,899 --> 00:30:49,360
you're basically can do<font color="#E5E5E5"> anything</font><font color="#CCCCCC"> that</font>

736
00:30:46,600 --> 00:30:51,309
<font color="#E5E5E5">you</font><font color="#CCCCCC"> want you</font><font color="#E5E5E5"> can have the binary execute</font>

737
00:30:49,360 --> 00:30:54,729
a Swiss that never even<font color="#CCCCCC"> existed in the</font>

738
00:30:51,309 --> 00:30:56,379
<font color="#E5E5E5">codebase</font><font color="#CCCCCC"> I think the only limitation is</font>

739
00:30:54,730 --> 00:30:58,960
<font color="#CCCCCC">your knowledge</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> should be able</font><font color="#E5E5E5"> to</font>

740
00:30:56,380 --> 00:31:01,779
<font color="#E5E5E5">understand the enough imports and the</font>

741
00:30:58,960 --> 00:31:03,789
<font color="#E5E5E5">libraries and you will you will</font><font color="#CCCCCC"> be able</font>

742
00:31:01,779 --> 00:31:05,740
without<font color="#E5E5E5"> question to do much of anything</font>

743
00:31:03,789 --> 00:31:07,658
<font color="#CCCCCC">that you want that's why a</font><font color="#E5E5E5"> lot of real</font>

744
00:31:05,740 --> 00:31:10,659
<font color="#CCCCCC">malware's</font><font color="#E5E5E5"> follow multiple</font><font color="#CCCCCC"> layers of</font>

745
00:31:07,659 --> 00:31:13,149
<font color="#CCCCCC">obfuscation</font><font color="#E5E5E5"> it will give sometimes a</font>

746
00:31:10,659 --> 00:31:14,559
fake sense of conclusion it's like oh

747
00:31:13,149 --> 00:31:15,939
this is the end<font color="#E5E5E5"> of the malware</font><font color="#CCCCCC"> no no</font>

748
00:31:14,559 --> 00:31:17,440
keep<font color="#CCCCCC"> looking for there maybe</font><font color="#E5E5E5"> there is an</font>

749
00:31:15,940 --> 00:31:20,200
encrypted binary that's<font color="#E5E5E5"> actually doing</font>

750
00:31:17,440 --> 00:31:22,000
the real work<font color="#CCCCCC"> so in my opinion no there</font>

751
00:31:20,200 --> 00:31:24,460
isn't<font color="#E5E5E5"> any limitation</font><font color="#CCCCCC"> that anybody</font><font color="#E5E5E5"> can</font>

752
00:31:22,000 --> 00:31:27,700
<font color="#E5E5E5">come up with that could stop an analyst</font>

753
00:31:24,460 --> 00:31:34,299
<font color="#E5E5E5">from concluding the analysis so thank</font>

754
00:31:27,700 --> 00:31:38,710
you<font color="#E5E5E5"> for you</font><font color="#CCCCCC"> know first if you want</font><font color="#E5E5E5"> let's</font>

755
00:31:34,299 --> 00:31:40,840
go ahead<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so you spoke about how you</font>

756
00:31:38,710 --> 00:31:44,080
importing the encrypt decrypt function

757
00:31:40,840 --> 00:31:45,668
could be generally<font color="#E5E5E5"> custom-made as</font>

758
00:31:44,080 --> 00:31:48,129
opposed to<font color="#E5E5E5"> actually doing it where it</font>

759
00:31:45,669 --> 00:31:50,740
<font color="#E5E5E5">would be blatant have you ever had</font><font color="#CCCCCC"> cases</font>

760
00:31:48,130 --> 00:31:53,279
<font color="#CCCCCC">where it would be</font><font color="#E5E5E5"> so custom that it</font>

761
00:31:50,740 --> 00:31:55,779
would generally bypass most analysts

762
00:31:53,279 --> 00:31:56,980
analysis and it would be really<font color="#E5E5E5"> hard</font><font color="#CCCCCC"> to</font>

763
00:31:55,779 --> 00:32:01,480
detect because it would seem<font color="#CCCCCC"> like a</font>

764
00:31:56,980 --> 00:32:03,940
genuine<font color="#CCCCCC"> I will tell you</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> I haven't</font>

765
00:32:01,480 --> 00:32:05,350
caught something that is just<font color="#E5E5E5"> bypassing</font>

766
00:32:03,940 --> 00:32:06,940
any analyst<font color="#CCCCCC"> because usually if you're</font>

767
00:32:05,350 --> 00:32:08,709
following<font color="#E5E5E5"> the</font><font color="#CCCCCC"> proper pathways of</font><font color="#E5E5E5"> the</font>

768
00:32:06,940 --> 00:32:10,630
execution of the<font color="#CCCCCC"> binary you will be able</font>

769
00:32:08,710 --> 00:32:12,820
<font color="#E5E5E5">to know something</font><font color="#CCCCCC"> the thing is this is</font>

770
00:32:10,630 --> 00:32:14,890
more like a road stop<font color="#CCCCCC"> the crypt encrypt</font>

771
00:32:12,820 --> 00:32:17,020
we know the name<font color="#CCCCCC"> of the road stop if</font>

772
00:32:14,890 --> 00:32:18,610
you're like<font color="#E5E5E5"> going from I don't</font><font color="#CCCCCC"> know like</font>

773
00:32:17,020 --> 00:32:20,860
through Europe you're<font color="#E5E5E5"> going to stop</font>

774
00:32:18,610 --> 00:32:22,918
through a city or one city<font color="#CCCCCC"> or</font><font color="#E5E5E5"> something</font>

775
00:32:20,860 --> 00:32:25,809
you can<font color="#CCCCCC"> just go into</font><font color="#E5E5E5"> a null space and</font>

776
00:32:22,919 --> 00:32:28,000
you will have to you will<font color="#E5E5E5"> have to stop</font>

777
00:32:25,809 --> 00:32:28,840
<font color="#E5E5E5">into some road</font><font color="#CCCCCC"> signs</font><font color="#E5E5E5"> and if somebody is</font>

778
00:32:28,000 --> 00:32:30,190
<font color="#E5E5E5">trying to</font>

779
00:32:28,840 --> 00:32:31,720
<font color="#E5E5E5">tract you he will follow those road</font>

780
00:32:30,190 --> 00:32:33,460
<font color="#E5E5E5">signs there is a possibility</font><font color="#CCCCCC"> that it</font>

781
00:32:31,720 --> 00:32:36,070
could be<font color="#CCCCCC"> a custom function I</font><font color="#E5E5E5"> am one time</font>

782
00:32:33,460 --> 00:32:39,010
<font color="#CCCCCC">wrote</font><font color="#E5E5E5"> a CTF just for a small meter that</font>

783
00:32:36,070 --> 00:32:39,460
used an<font color="#CCCCCC"> XOR basically and</font><font color="#E5E5E5"> it's XOR in</font>

784
00:32:39,010 --> 00:32:42,250
<font color="#CCCCCC">width</font>

785
00:32:39,460 --> 00:32:44,140
I believe it was<font color="#CCCCCC"> Oh X</font><font color="#E5E5E5"> and not dead beef</font>

786
00:32:42,250 --> 00:32:46,690
it was like something something cute

787
00:32:44,140 --> 00:32:51,669
with hexadecimal characters<font color="#CCCCCC"> and it was</font>

788
00:32:46,690 --> 00:32:55,779
just horrible made by me<font color="#E5E5E5"> it was</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> win</font>

789
00:32:51,669 --> 00:32:57,400
<font color="#CCCCCC">main and in that CTF only like five</font>

790
00:32:55,779 --> 00:33:01,000
<font color="#E5E5E5">people out of 30 were able to get it</font>

791
00:32:57,400 --> 00:33:03,159
they really could not understand that<font color="#E5E5E5"> it</font>

792
00:33:01,000 --> 00:33:04,600
was as simple<font color="#E5E5E5"> as an XOR</font><font color="#CCCCCC"> there is nothing</font>

793
00:33:03,159 --> 00:33:06,340
to it it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> Krypton crib</font><font color="#E5E5E5"> there is</font>

794
00:33:04,600 --> 00:33:07,629
nothing in<font color="#E5E5E5"> there and they</font><font color="#CCCCCC"> finished the</font>

795
00:33:06,340 --> 00:33:09,520
entire<font color="#CCCCCC"> thing but</font><font color="#E5E5E5"> three</font><font color="#CCCCCC"> different ways</font>

796
00:33:07,630 --> 00:33:11,080
<font color="#E5E5E5">but nobody got the decryption keys they</font>

797
00:33:09,520 --> 00:33:12,220
were able to<font color="#E5E5E5"> decrypt everything else but</font>

798
00:33:11,080 --> 00:33:13,960
they didn't<font color="#E5E5E5"> get the decryption key just</font>

799
00:33:12,220 --> 00:33:17,110
because it was so<font color="#E5E5E5"> simple so you can make</font>

800
00:33:13,960 --> 00:33:18,490
your own custom functions and it is very

801
00:33:17,110 --> 00:33:21,789
much<font color="#CCCCCC"> possible it's</font><font color="#E5E5E5"> very much out there</font>

802
00:33:18,490 --> 00:33:38,610
but in my way if you're<font color="#E5E5E5"> just going</font>

803
00:33:21,789 --> 00:33:38,610
through a theory out<font color="#CCCCCC"> there alright okay</font>

804
00:33:52,080 --> 00:34:01,418
so<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> a good</font><font color="#CCCCCC"> tool light from so either</font>

805
00:33:56,620 --> 00:34:02,918
<font color="#E5E5E5">is disassembler</font><font color="#CCCCCC"> it's one</font><font color="#E5E5E5"> of the most</font>

806
00:34:01,419 --> 00:34:06,039
<font color="#E5E5E5">famous disassemblers it's one of the</font>

807
00:34:02,919 --> 00:34:08,260
most<font color="#E5E5E5"> expensive</font><font color="#CCCCCC"> this assemblers</font><font color="#E5E5E5"> - so it</font>

808
00:34:06,039 --> 00:34:11,020
<font color="#E5E5E5">is what it does is static code analysis</font>

809
00:34:08,260 --> 00:34:13,480
that it's basically dekum disassembling

810
00:34:11,020 --> 00:34:14,969
<font color="#CCCCCC">your code your binary</font><font color="#E5E5E5"> code into assembly</font>

811
00:34:13,480 --> 00:34:17,349
language into machine language and

812
00:34:14,969 --> 00:34:19,598
that's<font color="#E5E5E5"> something very</font><font color="#CCCCCC"> ok but the</font><font color="#E5E5E5"> thing</font>

813
00:34:17,349 --> 00:34:22,210
is all<font color="#CCCCCC"> over</font><font color="#E5E5E5"> I did right</font><font color="#CCCCCC"> now I try</font><font color="#E5E5E5"> to</font>

814
00:34:19,599 --> 00:34:25,179
<font color="#CCCCCC">avoid using that</font><font color="#E5E5E5"> because the assembly</font><font color="#CCCCCC"> if</font>

815
00:34:22,210 --> 00:34:27,190
you've ever read it it's very<font color="#E5E5E5"> very hard</font>

816
00:34:25,179 --> 00:34:38,500
<font color="#E5E5E5">to understand</font><font color="#CCCCCC"> and it's usually for</font>

817
00:34:27,190 --> 00:34:40,089
everybody who wants<font color="#CCCCCC"> to start out you can</font>

818
00:34:38,500 --> 00:34:42,369
see<font color="#E5E5E5"> it like a programmer what is</font>

819
00:34:40,089 --> 00:34:45,409
happening in the

820
00:34:42,369 --> 00:34:47,419
that's very good<font color="#CCCCCC"> but so you</font><font color="#E5E5E5"> can see the</font>

821
00:34:45,409 --> 00:34:50,500
<font color="#E5E5E5">function that</font><font color="#CCCCCC"> I imported you can</font><font color="#E5E5E5"> run it</font>

822
00:34:47,418 --> 00:34:56,929
<font color="#E5E5E5">with a do different kind of</font><font color="#CCCCCC"> attach</font>

823
00:34:50,500 --> 00:34:59,510
<font color="#E5E5E5">extended I hear you</font>

824
00:34:56,929 --> 00:35:01,579
so<font color="#E5E5E5"> radar a is another disassembler it</font>

825
00:34:59,510 --> 00:35:03,380
also has<font color="#E5E5E5"> pseudocode generation</font>

826
00:35:01,579 --> 00:35:05,900
hopper another<font color="#E5E5E5"> this assembler it also</font>

827
00:35:03,380 --> 00:35:09,319
has it it's<font color="#E5E5E5"> very good that</font><font color="#CCCCCC"> you can read</font>

828
00:35:05,900 --> 00:35:11,210
<font color="#CCCCCC">C code but in my opinion if you want to</font>

829
00:35:09,319 --> 00:35:14,299
throw if you want to<font color="#E5E5E5"> follow a mess</font>

830
00:35:11,210 --> 00:35:16,309
<font color="#E5E5E5">Adamas article approach it's better not</font>

831
00:35:14,299 --> 00:35:18,259
<font color="#E5E5E5">to</font><font color="#CCCCCC"> look at code</font><font color="#E5E5E5"> it's better to see her</font>

832
00:35:16,309 --> 00:35:20,359
eyes what the app is<font color="#CCCCCC"> doing what the</font>

833
00:35:18,260 --> 00:35:22,069
binary is doing and try to follow the

834
00:35:20,359 --> 00:35:24,799
tracing and thereby executing the code

835
00:35:22,069 --> 00:35:27,410
<font color="#E5E5E5">not by trying to look at the analysis if</font>

836
00:35:24,799 --> 00:35:30,319
I was writing<font color="#E5E5E5"> an office cater to deter</font>

837
00:35:27,410 --> 00:35:32,660
an analyst<font color="#E5E5E5"> from doing their job</font><font color="#CCCCCC"> I will</font>

838
00:35:30,319 --> 00:35:36,710
throw flashes in<font color="#CCCCCC"> the middle of the code</font>

839
00:35:32,660 --> 00:35:40,460
<font color="#E5E5E5">flash is basically trying to do getting</font>

840
00:35:36,710 --> 00:35:42,109
some factorization for for whatever<font color="#E5E5E5"> for</font>

841
00:35:40,460 --> 00:35:44,210
no<font color="#E5E5E5"> purpose just to throw away the</font>

842
00:35:42,109 --> 00:35:45,410
analyst<font color="#E5E5E5"> so in my opinion</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> look at</font>

843
00:35:44,210 --> 00:35:46,819
the assembly don't<font color="#E5E5E5"> look at the source</font>

844
00:35:45,410 --> 00:35:50,660
code<font color="#E5E5E5"> even if you have something like I</font>

845
00:35:46,819 --> 00:35:52,700
don't follow<font color="#E5E5E5"> something</font><font color="#CCCCCC"> like this dynamic</font>

846
00:35:50,660 --> 00:35:54,558
analysis execute it and see what's the

847
00:35:52,700 --> 00:35:56,348
<font color="#E5E5E5">input and</font><font color="#CCCCCC"> output and then maybe after</font>

848
00:35:54,559 --> 00:35:58,279
<font color="#E5E5E5">that you can run it</font><font color="#CCCCCC"> for a debugger</font><font color="#E5E5E5"> and</font>

849
00:35:56,349 --> 00:36:00,829
afterwards if you really want to<font color="#E5E5E5"> know</font>

850
00:35:58,279 --> 00:36:02,809
what's happening go for<font color="#E5E5E5"> either do the</font>

851
00:36:00,829 --> 00:36:05,210
<font color="#CCCCCC">pseudocode summary</font><font color="#E5E5E5"> which in my opinion</font>

852
00:36:02,809 --> 00:36:06,859
<font color="#E5E5E5">is amazing it's</font><font color="#CCCCCC"> really good and it's not</font>

853
00:36:05,210 --> 00:36:08,630
all the<font color="#CCCCCC"> time accurate but it's very good</font>

854
00:36:06,859 --> 00:36:10,730
and then afterwards you<font color="#CCCCCC"> can have a more</font>

855
00:36:08,630 --> 00:36:13,010
<font color="#E5E5E5">conclusive opinion but the first</font>

856
00:36:10,730 --> 00:36:15,170
approach<font color="#E5E5E5"> is to always follow a dynamic</font>

857
00:36:13,010 --> 00:36:19,099
analysis approach that's<font color="#E5E5E5"> my opinion</font><font color="#CCCCCC"> okay</font>

858
00:36:15,170 --> 00:36:22,430
<font color="#CCCCCC">thank you of course okay thank you</font><font color="#E5E5E5"> so</font>

859
00:36:19,099 --> 00:36:23,779
much<font color="#CCCCCC"> think</font><font color="#E5E5E5"> he'll do</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> so if you have</font>

860
00:36:22,430 --> 00:36:25,549
other<font color="#E5E5E5"> questions please approach</font><font color="#CCCCCC"> of the</font>

861
00:36:23,779 --> 00:36:28,659
<font color="#CCCCCC">login break right apples</font>

862
00:36:25,550 --> 00:36:28,659
[Applause]

