1
00:00:00,030 --> 00:00:04,650
can you hear me<font color="#CCCCCC"> okay perfect okay so</font>

2
00:00:03,240 --> 00:00:06,600
there's a lot<font color="#E5E5E5"> of you here I wasn't</font>

3
00:00:04,650 --> 00:00:07,799
<font color="#E5E5E5">expecting this big of an audience at</font>

4
00:00:06,600 --> 00:00:11,190
this time but we're really glad that

5
00:00:07,799 --> 00:00:13,650
<font color="#E5E5E5">you're</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> we're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> today</font>

6
00:00:11,190 --> 00:00:17,970
about some<font color="#CCCCCC"> unique behaviors that we</font>

7
00:00:13,650 --> 00:00:19,980
found exhibited by malware<font color="#CCCCCC"> a little bit</font>

8
00:00:17,970 --> 00:00:22,020
<font color="#E5E5E5">so first of all my</font><font color="#CCCCCC"> name is Mattias</font>

9
00:00:19,980 --> 00:00:25,019
he's your notes and<font color="#CCCCCC"> a little bit about</font>

10
00:00:22,020 --> 00:00:28,109
myself<font color="#E5E5E5"> I'm a threat hunter at</font>

11
00:00:25,019 --> 00:00:30,390
<font color="#CCCCCC">CrowdStrike</font><font color="#E5E5E5"> I've been in the IT industry</font>

12
00:00:28,109 --> 00:00:32,189
for over seven years now<font color="#E5E5E5"> with the last</font>

13
00:00:30,390 --> 00:00:35,130
four<font color="#CCCCCC"> years focused on security</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> Kraus</font>

14
00:00:32,189 --> 00:00:37,800
<font color="#CCCCCC">record at a</font><font color="#E5E5E5"> veera I'm a food and travel</font>

15
00:00:35,130 --> 00:00:41,219
enthusiast<font color="#CCCCCC"> I like food a lot</font><font color="#E5E5E5"> I know you</font>

16
00:00:37,800 --> 00:00:44,419
can't tell but still<font color="#E5E5E5"> I like it</font><font color="#CCCCCC"> I'm going</font>

17
00:00:41,219 --> 00:00:44,420
<font color="#CCCCCC">with</font><font color="#E5E5E5"> my colleague introduce himself</font>

18
00:00:45,350 --> 00:00:51,809
hello my name<font color="#CCCCCC"> is Ronnie apple also</font><font color="#E5E5E5"> known</font>

19
00:00:48,899 --> 00:00:52,949
as your notes for my friends I'm<font color="#CCCCCC"> afraid</font>

20
00:00:51,809 --> 00:00:56,129
I'm<font color="#E5E5E5"> a</font><font color="#CCCCCC"> lizard CrowdStrike</font>

21
00:00:52,949 --> 00:00:58,829
I'm working in the right<font color="#E5E5E5"> to secure</font>

22
00:00:56,129 --> 00:01:01,379
industry for five years now<font color="#CCCCCC"> previously</font>

23
00:00:58,829 --> 00:01:04,019
<font color="#CCCCCC">with a Europe</font>

24
00:01:01,379 --> 00:01:08,100
I consider myself<font color="#CCCCCC"> or in person here</font><font color="#E5E5E5"> and</font>

25
00:01:04,019 --> 00:01:10,080
it's don't<font color="#CCCCCC"> forget to assess and i'd like</font>

26
00:01:08,100 --> 00:01:12,750
to<font color="#CCCCCC"> 'participate</font><font color="#E5E5E5"> density of challenges</font>

27
00:01:10,080 --> 00:01:15,179
speaking of city city of challenges<font color="#CCCCCC"> I</font>

28
00:01:12,750 --> 00:01:18,450
invite<font color="#CCCCCC"> you</font><font color="#E5E5E5"> to participate on our</font>

29
00:01:15,180 --> 00:01:20,880
challenge named<font color="#E5E5E5"> down the rabbit hole</font><font color="#CCCCCC"> you</font>

30
00:01:18,450 --> 00:01:23,729
can go and talk to<font color="#CCCCCC"> our colleague chippy</font>

31
00:01:20,880 --> 00:01:25,679
<font color="#E5E5E5">on about that and</font><font color="#CCCCCC"> we our prize me so I'm</font>

32
00:01:23,729 --> 00:01:30,658
gonna let Marva<font color="#E5E5E5"> sue the first half of</font>

33
00:01:25,680 --> 00:01:32,549
the presentation please<font color="#E5E5E5"> yeah so we</font>

34
00:01:30,659 --> 00:01:35,930
divided<font color="#E5E5E5"> this presentation into four big</font>

35
00:01:32,549 --> 00:01:39,329
topics<font color="#E5E5E5"> it's what we do on a daily basis</font>

36
00:01:35,930 --> 00:01:41,909
<font color="#CCCCCC">we're</font><font color="#E5E5E5"> gonna show you three what we found</font>

37
00:01:39,329 --> 00:01:44,008
<font color="#E5E5E5">to be odd infection techniques we can</font>

38
00:01:41,909 --> 00:01:47,430
<font color="#CCCCCC">also show you some quirky but still</font>

39
00:01:44,009 --> 00:01:48,930
legitimate behavior that we've seen and

40
00:01:47,430 --> 00:01:50,549
we have<font color="#E5E5E5"> 15</font><font color="#CCCCCC"> minutes at the end for</font>

41
00:01:48,930 --> 00:01:52,170
questions and<font color="#CCCCCC"> answers so if you have any</font>

42
00:01:50,549 --> 00:01:54,090
questions just<font color="#E5E5E5"> write them down and we'll</font>

43
00:01:52,170 --> 00:01:56,640
<font color="#CCCCCC">have a</font><font color="#E5E5E5"> 15 minute</font><font color="#CCCCCC"> sessions at the end and</font>

44
00:01:54,090 --> 00:01:59,369
we<font color="#CCCCCC"> can discuss about those</font><font color="#E5E5E5"> okay so let's</font>

45
00:01:56,640 --> 00:02:02,130
<font color="#E5E5E5">dive into what we do so we do our</font>

46
00:01:59,369 --> 00:02:05,479
<font color="#E5E5E5">hunting with the reverse engineering and</font>

47
00:02:02,130 --> 00:02:05,479
we write detection

48
00:02:06,570 --> 00:02:13,209
we're actually<font color="#E5E5E5"> two groups the one I'm in</font>

49
00:02:10,739 --> 00:02:14,830
focused on malware hunting and on

50
00:02:13,209 --> 00:02:16,750
writing detections and<font color="#CCCCCC"> your notes over</font>

51
00:02:14,830 --> 00:02:20,170
<font color="#CCCCCC">here is the one</font><font color="#E5E5E5"> that does reverse</font>

52
00:02:16,750 --> 00:02:21,810
engineering<font color="#CCCCCC"> so let's go</font><font color="#E5E5E5"> into malware</font>

53
00:02:20,170 --> 00:02:24,129
hunting what<font color="#E5E5E5"> does</font><font color="#CCCCCC"> mallory hunting mean</font>

54
00:02:21,810 --> 00:02:26,950
well for me it's finding the unknown

55
00:02:24,129 --> 00:02:28,298
basically you have to find something

56
00:02:26,950 --> 00:02:30,190
<font color="#E5E5E5">that you've</font><font color="#CCCCCC"> never seen before something</font>

57
00:02:28,299 --> 00:02:34,120
<font color="#E5E5E5">unique in behavior something unique in</font>

58
00:02:30,190 --> 00:02:37,599
the<font color="#E5E5E5"> weight the way it behaves on a</font>

59
00:02:34,120 --> 00:02:39,430
computer<font color="#E5E5E5"> so how we do it well we have</font>

60
00:02:37,599 --> 00:02:41,828
multiple techniques<font color="#E5E5E5"> that we use</font>

61
00:02:39,430 --> 00:02:45,280
techniques workflows<font color="#E5E5E5"> first of all we</font>

62
00:02:41,829 --> 00:02:46,860
used<font color="#CCCCCC"> yara rules in Mal query Mallory is</font>

63
00:02:45,280 --> 00:02:48,010
a commercial product which is all by

64
00:02:46,860 --> 00:02:51,010
CrowdStrike

65
00:02:48,010 --> 00:02:54,730
and it's basically a search engine<font color="#CCCCCC"> for</font>

66
00:02:51,010 --> 00:02:57,220
<font color="#E5E5E5">binary files right it indexes all of the</font>

67
00:02:54,730 --> 00:02:59,018
files and then you<font color="#E5E5E5"> can run right here</font>

68
00:02:57,220 --> 00:03:01,630
<font color="#E5E5E5">our rules against it and find samples of</font>

69
00:02:59,019 --> 00:03:05,620
interest<font color="#E5E5E5"> if you want to analyze or find</font>

70
00:03:01,630 --> 00:03:09,069
similar samples of something<font color="#E5E5E5"> we do use</font>

71
00:03:05,620 --> 00:03:10,750
some overwatch patterns<font color="#CCCCCC"> also in Harrier</font>

72
00:03:09,069 --> 00:03:13,238
this is an internal<font color="#E5E5E5"> system that we use</font>

73
00:03:10,750 --> 00:03:15,400
so these are very<font color="#E5E5E5"> very generic patterns</font>

74
00:03:13,239 --> 00:03:18,250
we're<font color="#E5E5E5"> gonna speak about them a little</font>

75
00:03:15,400 --> 00:03:20,560
<font color="#CCCCCC">bit</font><font color="#E5E5E5"> later in the presentation</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> course</font>

76
00:03:18,250 --> 00:03:24,220
we use virustotal<font color="#E5E5E5"> who uses virustotal</font>

77
00:03:20,560 --> 00:03:30,609
here<font color="#CCCCCC"> ok so a big chunk of</font><font color="#E5E5E5"> users virus so</font>

78
00:03:24,220 --> 00:03:32,620
this is our open<font color="#E5E5E5"> source in feed if I can</font>

79
00:03:30,609 --> 00:03:35,319
<font color="#CCCCCC">put</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> that so we do VT queries to</font>

80
00:03:32,620 --> 00:03:38,079
find<font color="#E5E5E5"> interesting stuff in there</font><font color="#CCCCCC"> we also</font>

81
00:03:35,319 --> 00:03:40,030
look for infection vectors<font color="#E5E5E5"> really</font>

82
00:03:38,079 --> 00:03:42,579
important why because<font color="#E5E5E5"> we need to find</font>

83
00:03:40,030 --> 00:03:45,730
<font color="#E5E5E5">the kill chain as higher up in the tree</font>

84
00:03:42,579 --> 00:03:49,180
as possible<font color="#E5E5E5"> and we also search for</font>

85
00:03:45,730 --> 00:03:53,619
infections if we in<font color="#E5E5E5"> our</font><font color="#CCCCCC"> met customers</font>

86
00:03:49,180 --> 00:03:57,430
right<font color="#E5E5E5"> now hunting would be</font><font color="#CCCCCC"> are our rules</font>

87
00:03:53,620 --> 00:04:01,620
<font color="#E5E5E5">in mark query</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is basically a simple</font>

88
00:03:57,430 --> 00:04:04,000
<font color="#CCCCCC">yarra rule that I use to catch like</font>

89
00:04:01,620 --> 00:04:07,000
interesting stuff<font color="#CCCCCC"> so for</font><font color="#E5E5E5"> example this</font>

90
00:04:04,000 --> 00:04:09,280
one it's a possible<font color="#CCCCCC"> LNK link download</font>

91
00:04:07,000 --> 00:04:11,020
area I'm looking<font color="#CCCCCC"> for link files I'm</font>

92
00:04:09,280 --> 00:04:14,410
basically looking<font color="#E5E5E5"> at</font>

93
00:04:11,020 --> 00:04:22,270
the magic of the the link file and then

94
00:04:14,410 --> 00:04:25,270
I use the HTTP white token<font color="#CCCCCC"> why use</font><font color="#E5E5E5"> link</font>

95
00:04:22,270 --> 00:04:27,940
file is because lately I've seen a<font color="#CCCCCC"> peak</font>

96
00:04:25,270 --> 00:04:31,659
in the wild with<font color="#CCCCCC"> linked files that you</font>

97
00:04:27,940 --> 00:04:34,030
do all<font color="#CCCCCC"> kinds of crazy stuff from crazy</font>

98
00:04:31,660 --> 00:04:36,910
<font color="#CCCCCC">powershell one-liners abusing mists</font>

99
00:04:34,030 --> 00:04:41,409
abusing<font color="#CCCCCC"> WMI and a lot of</font><font color="#E5E5E5"> nasty</font><font color="#CCCCCC"> things</font>

100
00:04:36,910 --> 00:04:42,550
that<font color="#CCCCCC"> are used with link files and the</font>

101
00:04:41,410 --> 00:04:45,010
funny<font color="#CCCCCC"> thing about Lincoln's it's not</font>

102
00:04:42,550 --> 00:04:47,860
funny<font color="#CCCCCC"> the best thing about link files is</font>

103
00:04:45,010 --> 00:04:50,520
you cannot give<font color="#E5E5E5"> it a context right so if</font>

104
00:04:47,860 --> 00:04:53,830
you think<font color="#E5E5E5"> about the</font><font color="#CCCCCC"> process tree that</font>

105
00:04:50,520 --> 00:04:56,020
<font color="#CCCCCC">follows the execution of</font><font color="#E5E5E5"> a link file you</font>

106
00:04:53,830 --> 00:04:57,789
will see Explorer that<font color="#E5E5E5"> spawns whatever</font>

107
00:04:56,020 --> 00:04:59,469
is on<font color="#CCCCCC"> that link file</font><font color="#E5E5E5"> right so you can</font>

108
00:04:57,790 --> 00:05:01,000
give it<font color="#E5E5E5"> context you can give it context</font>

109
00:04:59,470 --> 00:05:02,710
like when you have a<font color="#E5E5E5"> powershell</font>

110
00:05:01,000 --> 00:05:04,090
downloader in a<font color="#E5E5E5"> windward right</font>

111
00:05:02,710 --> 00:05:06,789
you see powershell on the windward

112
00:05:04,090 --> 00:05:10,289
<font color="#E5E5E5">that's easy right</font><font color="#CCCCCC"> but when you have link</font>

113
00:05:06,790 --> 00:05:12,820
files the context<font color="#E5E5E5"> to give context to to</font>

114
00:05:10,290 --> 00:05:15,910
<font color="#CCCCCC">do that execution</font><font color="#E5E5E5"> is it's it's pretty</font>

115
00:05:12,820 --> 00:05:19,330
hard<font color="#E5E5E5"> so again a possible link</font><font color="#CCCCCC"> download</font>

116
00:05:15,910 --> 00:05:22,120
or a simple<font color="#CCCCCC"> yara rule which returns like</font>

117
00:05:19,330 --> 00:05:25,750
in the last<font color="#E5E5E5"> two weeks 66 malware link</font>

118
00:05:22,120 --> 00:05:28,240
files<font color="#CCCCCC"> five clean and two one</font><font color="#E5E5E5"> okay so</font>

119
00:05:25,750 --> 00:05:31,390
this is like<font color="#CCCCCC"> mal query as i told you</font>

120
00:05:28,240 --> 00:05:33,940
it's an<font color="#E5E5E5"> internal</font><font color="#CCCCCC"> to overwatch patterns</font>

121
00:05:31,390 --> 00:05:36,510
<font color="#E5E5E5">we use this</font><font color="#CCCCCC"> also a lot but they're</font>

122
00:05:33,940 --> 00:05:38,740
mostly used<font color="#CCCCCC"> for</font><font color="#E5E5E5"> hunting targeted</font>

123
00:05:36,510 --> 00:05:41,140
activity and sophisticated attacks

124
00:05:38,740 --> 00:05:44,560
<font color="#E5E5E5">they're very generic so for example you</font>

125
00:05:41,140 --> 00:05:46,900
can use a pattern<font color="#E5E5E5"> that's just not use</font>

126
00:05:44,560 --> 00:05:48,100
right<font color="#CCCCCC"> nate use is</font><font color="#E5E5E5"> like a legitimate</font>

127
00:05:46,900 --> 00:05:50,859
command that is<font color="#CCCCCC"> used by system</font>

128
00:05:48,100 --> 00:05:53,620
<font color="#E5E5E5">administrator</font><font color="#CCCCCC"> right but we've seen it</font>

129
00:05:50,860 --> 00:05:55,750
used a<font color="#CCCCCC"> lot by attackers</font><font color="#E5E5E5"> in like if you</font>

130
00:05:53,620 --> 00:05:58,180
want to<font color="#CCCCCC"> move laterally</font><font color="#E5E5E5"> or or stuff like</font>

131
00:05:55,750 --> 00:06:02,650
<font color="#CCCCCC">that</font><font color="#E5E5E5"> another thing another one could be</font>

132
00:05:58,180 --> 00:06:03,810
wmic and HTTP<font color="#CCCCCC"> we have an</font><font color="#E5E5E5"> example</font>

133
00:06:02,650 --> 00:06:06,190
actually with<font color="#E5E5E5"> wmic</font>

134
00:06:03,810 --> 00:06:07,540
<font color="#CCCCCC">you I'm</font><font color="#E5E5E5"> just gonna speak about it this</font>

135
00:06:06,190 --> 00:06:10,040
<font color="#E5E5E5">could be another pattern it could I mean</font>

136
00:06:07,540 --> 00:06:13,580
<font color="#CCCCCC">it's very generic</font><font color="#E5E5E5"> again</font>

137
00:06:10,040 --> 00:06:18,770
and you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> just block</font><font color="#CCCCCC"> everything that</font>

138
00:06:13,580 --> 00:06:20,000
<font color="#E5E5E5">uses wmic and HTTP right</font><font color="#CCCCCC"> what we found</font>

139
00:06:18,770 --> 00:06:22,070
interesting<font color="#E5E5E5"> though</font><font color="#CCCCCC"> is that by</font>

140
00:06:20,000 --> 00:06:24,200
correlating<font color="#E5E5E5"> three or more of these</font>

141
00:06:22,070 --> 00:06:25,640
patterns together<font color="#E5E5E5"> it gives us a good</font>

142
00:06:24,200 --> 00:06:27,349
indicator<font color="#CCCCCC"> that something's</font><font color="#E5E5E5"> happening on</font>

143
00:06:25,640 --> 00:06:28,610
<font color="#E5E5E5">that end point on that machine right and</font>

144
00:06:27,350 --> 00:06:30,320
somebody<font color="#CCCCCC"> should</font><font color="#E5E5E5"> take a look and</font>

145
00:06:28,610 --> 00:06:32,830
<font color="#E5E5E5">investigate what's</font><font color="#CCCCCC"> going on right so</font>

146
00:06:30,320 --> 00:06:34,790
<font color="#E5E5E5">three or more patterns it's that's</font>

147
00:06:32,830 --> 00:06:38,419
basically<font color="#CCCCCC"> that means</font><font color="#E5E5E5"> that something's</font>

148
00:06:34,790 --> 00:06:39,860
wrong there<font color="#CCCCCC"> I was</font><font color="#E5E5E5"> telling you also about</font>

149
00:06:38,420 --> 00:06:42,140
virustotal<font color="#E5E5E5"> right</font>

150
00:06:39,860 --> 00:06:43,820
a lot of<font color="#CCCCCC"> you use it a lot</font><font color="#E5E5E5"> of you</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't</font>

151
00:06:42,140 --> 00:06:49,969
know how you use it I use<font color="#CCCCCC"> it mostly</font><font color="#E5E5E5"> to</font>

152
00:06:43,820 --> 00:06:51,380
<font color="#CCCCCC">find if you find new things that</font><font color="#E5E5E5"> are</font>

153
00:06:49,970 --> 00:06:54,850
running<font color="#E5E5E5"> in the wild so for example in</font>

154
00:06:51,380 --> 00:06:57,350
this query I'm looking for emails

155
00:06:54,850 --> 00:06:59,480
<font color="#E5E5E5">luckily I know if I could put it luckily</font>

156
00:06:57,350 --> 00:07:01,160
or not but it's luckily for us we<font color="#CCCCCC"> still</font>

157
00:06:59,480 --> 00:07:04,040
see emails<font color="#E5E5E5"> on</font><font color="#CCCCCC"> virus though for some</font>

158
00:07:01,160 --> 00:07:06,290
<font color="#E5E5E5">reason which is good for us</font><font color="#CCCCCC"> so you</font><font color="#E5E5E5"> have</font>

159
00:07:04,040 --> 00:07:09,680
emails<font color="#CCCCCC"> positive three or more why use</font>

160
00:07:06,290 --> 00:07:11,870
three it's<font color="#CCCCCC"> arbitrary it's just a</font><font color="#E5E5E5"> number</font>

161
00:07:09,680 --> 00:07:13,990
I choose to like exclude a lot<font color="#CCCCCC"> of false</font>

162
00:07:11,870 --> 00:07:16,310
positives<font color="#CCCCCC"> right so if</font><font color="#E5E5E5"> it's three or</font><font color="#CCCCCC"> more</font>

163
00:07:13,990 --> 00:07:17,480
positives for the email then it's

164
00:07:16,310 --> 00:07:19,570
probably<font color="#E5E5E5"> something wrong with</font><font color="#CCCCCC"> that email</font>

165
00:07:17,480 --> 00:07:22,550
<font color="#E5E5E5">and I should probably take a look</font><font color="#CCCCCC"> at it</font>

166
00:07:19,570 --> 00:07:24,800
I'm excluding some I don't know some<font color="#E5E5E5"> CV</font>

167
00:07:22,550 --> 00:07:26,660
some vulnerabilities or<font color="#E5E5E5"> not that I'm not</font>

168
00:07:24,800 --> 00:07:29,330
interested<font color="#CCCCCC"> in</font><font color="#E5E5E5"> and I get a little fascist</font>

169
00:07:26,660 --> 00:07:30,800
<font color="#E5E5E5">right with this list of</font><font color="#CCCCCC"> hashes I'm gonna</font>

170
00:07:29,330 --> 00:07:33,710
tell you at the<font color="#E5E5E5"> end what I'm gonna do</font>

171
00:07:30,800 --> 00:07:36,680
with all<font color="#CCCCCC"> of those hashes</font><font color="#E5E5E5"> another</font><font color="#CCCCCC"> example</font>

172
00:07:33,710 --> 00:07:39,620
is this one<font color="#E5E5E5"> the query for zip files I</font>

173
00:07:36,680 --> 00:07:43,240
found again very<font color="#E5E5E5"> interesting stuff using</font>

174
00:07:39,620 --> 00:07:46,940
querying<font color="#CCCCCC"> VT for zip files that contain</font>

175
00:07:43,240 --> 00:07:47,620
this<font color="#CCCCCC"> these</font><font color="#E5E5E5"> extensions it's these file</font>

176
00:07:46,940 --> 00:07:50,480
extensions

177
00:07:47,620 --> 00:07:54,500
these are javascript jscript<font color="#E5E5E5"> jscript</font>

178
00:07:50,480 --> 00:07:57,470
encoded<font color="#E5E5E5"> vbscript</font><font color="#CCCCCC"> I also use windows</font>

179
00:07:54,500 --> 00:07:59,840
script host<font color="#CCCCCC"> windows script</font><font color="#E5E5E5"> file I also</font>

180
00:07:57,470 --> 00:08:01,370
use<font color="#CCCCCC"> a nankai files over here to look to</font>

181
00:07:59,840 --> 00:08:05,359
search and I just download<font color="#E5E5E5"> them all and</font>

182
00:08:01,370 --> 00:08:07,010
make a small collection daily<font color="#E5E5E5"> out of</font>

183
00:08:05,360 --> 00:08:09,950
everything<font color="#E5E5E5"> that I showed you</font><font color="#CCCCCC"> so</font>

184
00:08:07,010 --> 00:08:11,210
<font color="#CCCCCC">virustotal mercury</font><font color="#E5E5E5"> and also from the</font>

185
00:08:09,950 --> 00:08:14,390
overwatch patterns<font color="#E5E5E5"> I take all of those</font>

186
00:08:11,210 --> 00:08:16,609
<font color="#CCCCCC">hashes and detonate them how I detonate</font>

187
00:08:14,390 --> 00:08:19,789
them I have a VM

188
00:08:16,610 --> 00:08:21,939
that has<font color="#E5E5E5"> our product</font><font color="#CCCCCC"> installed on it and</font>

189
00:08:19,789 --> 00:08:28,250
<font color="#E5E5E5">I get all</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> information back I get</font>

190
00:08:21,939 --> 00:08:31,729
telemetry back from from<font color="#E5E5E5"> that via</font><font color="#CCCCCC"> oh so</font>

191
00:08:28,250 --> 00:08:33,529
after I get<font color="#E5E5E5"> I find something interesting</font>

192
00:08:31,729 --> 00:08:38,510
<font color="#CCCCCC">like</font><font color="#E5E5E5"> the needle in the</font><font color="#CCCCCC"> haystack</font>

193
00:08:33,529 --> 00:08:41,059
I basically hand it over to my colleague

194
00:08:38,510 --> 00:08:43,849
over<font color="#E5E5E5"> here who does the who does the</font>

195
00:08:41,059 --> 00:08:45,410
reverse<font color="#CCCCCC"> engineering part</font><font color="#E5E5E5"> and at the end</font>

196
00:08:43,849 --> 00:08:48,350
he's gonna give me he's<font color="#E5E5E5"> gonna provide</font><font color="#CCCCCC"> me</font>

197
00:08:45,410 --> 00:08:50,180
with a report<font color="#E5E5E5"> of what happened</font><font color="#CCCCCC"> what does</font>

198
00:08:48,350 --> 00:08:51,769
that<font color="#E5E5E5"> file to you and she's gonna show</font>

199
00:08:50,180 --> 00:08:53,029
you more but<font color="#E5E5E5"> that makes me</font><font color="#CCCCCC"> feel like I'm</font>

200
00:08:51,769 --> 00:08:54,170
<font color="#CCCCCC">his boss sometimes because</font><font color="#E5E5E5"> you know I</font>

201
00:08:53,029 --> 00:08:56,899
give you something<font color="#CCCCCC"> and you give</font><font color="#E5E5E5"> me</font>

202
00:08:54,170 --> 00:08:59,510
something<font color="#E5E5E5"> back as a report</font><font color="#CCCCCC"> what if some</font>

203
00:08:56,899 --> 00:09:02,060
<font color="#CCCCCC">day</font><font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so I'm</font><font color="#CCCCCC"> gonna hand</font><font color="#E5E5E5"> it over</font>

204
00:08:59,510 --> 00:09:06,920
<font color="#E5E5E5">to him for</font><font color="#CCCCCC"> the reversing part</font><font color="#E5E5E5"> Thank You</font>

205
00:09:02,060 --> 00:09:11,390
Martha for the introduction so when my

206
00:09:06,920 --> 00:09:14,719
response new collections of files<font color="#E5E5E5"> that</font>

207
00:09:11,390 --> 00:09:18,019
you want to analyze<font color="#E5E5E5"> he handles them to</font>

208
00:09:14,720 --> 00:09:20,170
me or other guys from<font color="#E5E5E5"> the team so we</font>

209
00:09:18,019 --> 00:09:24,260
<font color="#E5E5E5">start</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> during policing process on it</font>

210
00:09:20,170 --> 00:09:26,719
I'm not<font color="#E5E5E5"> necessarily interested in what</font>

211
00:09:24,260 --> 00:09:28,339
<font color="#CCCCCC">that mother</font><font color="#E5E5E5"> does whether it's a</font><font color="#CCCCCC"> but</font>

212
00:09:26,720 --> 00:09:30,470
whether it's around somewhere

213
00:09:28,339 --> 00:09:33,949
I just people I<font color="#CCCCCC"> just care what it does</font>

214
00:09:30,470 --> 00:09:37,459
<font color="#CCCCCC">in the</font><font color="#E5E5E5"> system like if it's injecting</font>

215
00:09:33,949 --> 00:09:42,620
processes for example that's projecting

216
00:09:37,459 --> 00:09:44,479
code in<font color="#E5E5E5"> other processes sorry</font><font color="#CCCCCC"> basically</font>

217
00:09:42,620 --> 00:09:46,550
<font color="#CCCCCC">for events that are</font><font color="#E5E5E5"> not seen</font><font color="#CCCCCC"> in</font>

218
00:09:44,480 --> 00:09:49,550
conventional<font color="#E5E5E5"> tools so one of them as I</font>

219
00:09:46,550 --> 00:09:52,069
showed as I said<font color="#CCCCCC"> previously is process</font>

220
00:09:49,550 --> 00:09:54,949
injection<font color="#E5E5E5"> another thing</font><font color="#CCCCCC"> that we like to</font>

221
00:09:52,070 --> 00:09:57,890
<font color="#CCCCCC">look for is malicious call stabs</font><font color="#E5E5E5"> remove</font>

222
00:09:54,949 --> 00:10:00,800
procedure calls<font color="#CCCCCC"> via my I'm going</font><font color="#E5E5E5"> to talk</font>

223
00:09:57,890 --> 00:10:03,270
<font color="#E5E5E5">about via my later for those that are</font>

224
00:10:00,800 --> 00:10:06,290
not familiar<font color="#E5E5E5"> familiar</font>

225
00:10:03,270 --> 00:10:08,880
this technology<font color="#CCCCCC"> privileged escalation</font>

226
00:10:06,290 --> 00:10:10,319
<font color="#CCCCCC">credential dumping the</font><font color="#E5E5E5"> rot of tools out</font>

227
00:10:08,880 --> 00:10:12,240
<font color="#CCCCCC">there</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> mallar that want to do</font>

228
00:10:10,320 --> 00:10:17,430
credential<font color="#CCCCCC"> without dumping</font><font color="#E5E5E5"> and do</font>

229
00:10:12,240 --> 00:10:20,250
<font color="#E5E5E5">lateral movement</font><font color="#CCCCCC"> also we look for some</font>

230
00:10:17,430 --> 00:10:24,150
exploitation techniques<font color="#E5E5E5"> we have quite a</font>

231
00:10:20,250 --> 00:10:24,810
<font color="#CCCCCC">few but these are some of them deb SLR</font><font color="#E5E5E5"> i</font>

232
00:10:24,150 --> 00:10:31,050
<font color="#E5E5E5">pass</font>

233
00:10:24,810 --> 00:10:33,540
keep spraying<font color="#CCCCCC"> excetera</font><font color="#E5E5E5"> another step that</font>

234
00:10:31,050 --> 00:10:36,390
<font color="#E5E5E5">can be done before</font><font color="#CCCCCC"> or after the analysis</font>

235
00:10:33,540 --> 00:10:41,310
<font color="#CCCCCC">i look for</font><font color="#E5E5E5"> other similar samples or</font>

236
00:10:36,390 --> 00:10:44,460
other binaries other PE files that are

237
00:10:41,310 --> 00:10:49,040
from<font color="#E5E5E5"> the same family so that</font><font color="#CCCCCC"> i can be</font>

238
00:10:44,460 --> 00:10:53,850
<font color="#CCCCCC">sure that</font><font color="#E5E5E5"> my findings are correct and</font>

239
00:10:49,040 --> 00:10:56,689
accurate as<font color="#CCCCCC"> possible so</font><font color="#E5E5E5"> i'm going to</font>

240
00:10:53,850 --> 00:11:00,660
<font color="#E5E5E5">work with you through three different</font>

241
00:10:56,690 --> 00:11:06,240
<font color="#CCCCCC">model samples</font><font color="#E5E5E5"> i'm gonna talk about their</font>

242
00:11:00,660 --> 00:11:07,949
infection<font color="#CCCCCC"> how the infection works so the</font>

243
00:11:06,240 --> 00:11:12,450
first one<font color="#CCCCCC"> is a</font><font color="#E5E5E5"> malicious document that</font>

244
00:11:07,950 --> 00:11:15,930
<font color="#E5E5E5">abuses</font><font color="#CCCCCC"> am</font><font color="#E5E5E5"> excite sec to drop</font><font color="#CCCCCC"> Delphic</font>

245
00:11:12,450 --> 00:11:19,920
<font color="#E5E5E5">compiled Mulder</font><font color="#CCCCCC"> onto the</font><font color="#E5E5E5"> victim machine</font>

246
00:11:15,930 --> 00:11:22,170
<font color="#CCCCCC">also this binary</font><font color="#E5E5E5"> is digitally</font><font color="#CCCCCC"> signed and</font>

247
00:11:19,920 --> 00:11:25,610
that<font color="#E5E5E5"> signature is still valid by today</font>

248
00:11:22,170 --> 00:11:28,589
which<font color="#CCCCCC"> is interesting</font>

249
00:11:25,610 --> 00:11:30,900
<font color="#CCCCCC">i'm</font><font color="#E5E5E5"> going to talk</font><font color="#CCCCCC"> about emi</font><font color="#E5E5E5"> and how it</font>

250
00:11:28,590 --> 00:11:33,840
can be abused<font color="#E5E5E5"> to inject a dotnet binary</font>

251
00:11:30,900 --> 00:11:35,880
into a<font color="#E5E5E5"> legitimate windows process this</font>

252
00:11:33,840 --> 00:11:37,830
technique over<font color="#E5E5E5"> here is also known as</font>

253
00:11:35,880 --> 00:11:40,980
people<font color="#CCCCCC"> e to you can</font><font color="#E5E5E5"> google</font><font color="#CCCCCC"> that if</font><font color="#E5E5E5"> you</font>

254
00:11:37,830 --> 00:11:44,040
want to<font color="#CCCCCC"> learn</font><font color="#E5E5E5"> more about about this and</font>

255
00:11:40,980 --> 00:11:46,170
then if<font color="#E5E5E5"> i know the example and the most</font>

256
00:11:44,040 --> 00:11:49,170
<font color="#E5E5E5">interesting from my point of view it's</font>

257
00:11:46,170 --> 00:11:54,110
an excel spreadsheet that uses a

258
00:11:49,170 --> 00:11:56,219
steganography to infect its victim so

259
00:11:54,110 --> 00:11:57,990
let's dive into the first<font color="#CCCCCC"> one the</font>

260
00:11:56,220 --> 00:12:03,209
malicious document that uses

261
00:11:57,990 --> 00:12:05,760
<font color="#E5E5E5">I'm excited this document was found in</font>

262
00:12:03,209 --> 00:12:12,119
the<font color="#CCCCCC"> wild you can see a</font><font color="#E5E5E5"> prince</font><font color="#CCCCCC"> Prince</font>

263
00:12:05,760 --> 00:12:15,149
<font color="#CCCCCC">piano in the right corner it</font><font color="#E5E5E5"> has by now</font>

264
00:12:12,120 --> 00:12:18,680
<font color="#CCCCCC">a</font><font color="#E5E5E5"> industry standard social engineering</font>

265
00:12:15,149 --> 00:12:21,240
message<font color="#CCCCCC"> trying to convince the user that</font>

266
00:12:18,680 --> 00:12:23,310
he has to enable the contents even

267
00:12:21,240 --> 00:12:25,860
<font color="#E5E5E5">though it's under a security warning but</font>

268
00:12:23,310 --> 00:12:29,369
who won't click that button<font color="#E5E5E5"> everybody</font>

269
00:12:25,860 --> 00:12:32,700
<font color="#CCCCCC">does</font><font color="#E5E5E5"> so let's see what it does</font><font color="#CCCCCC"> this is a</font>

270
00:12:29,370 --> 00:12:34,920
<font color="#E5E5E5">screenshot from Falcon UI we can see</font>

271
00:12:32,700 --> 00:12:38,580
here the Windward process which<font color="#CCCCCC"> opened</font>

272
00:12:34,920 --> 00:12:42,569
that<font color="#CCCCCC"> document and we see that it created</font>

273
00:12:38,580 --> 00:12:45,600
<font color="#E5E5E5">another process under it from update a</font>

274
00:12:42,570 --> 00:12:49,589
local temp and it has an<font color="#CCCCCC"> interesting</font>

275
00:12:45,600 --> 00:12:54,089
<font color="#E5E5E5">common</font><font color="#CCCCCC"> line the file</font><font color="#E5E5E5"> name is</font><font color="#CCCCCC"> stable dot</font>

276
00:12:49,589 --> 00:12:58,170
exe<font color="#E5E5E5"> and has a common line with a URL at</font>

277
00:12:54,089 --> 00:13:00,750
the<font color="#E5E5E5"> end so what's with this URL over</font>

278
00:12:58,170 --> 00:13:02,790
here<font color="#E5E5E5"> if you</font><font color="#CCCCCC"> go and</font><font color="#E5E5E5"> download the sample</font>

279
00:13:00,750 --> 00:13:04,980
calculate the<font color="#E5E5E5"> hashing search it on</font>

280
00:13:02,790 --> 00:13:09,750
reverse total<font color="#E5E5E5"> for example you'll</font><font color="#CCCCCC"> see</font>

281
00:13:04,980 --> 00:13:13,890
<font color="#E5E5E5">that it's a Windows installer next</font><font color="#CCCCCC"> so</font>

282
00:13:09,750 --> 00:13:16,589
<font color="#CCCCCC">Windows</font><font color="#E5E5E5"> installer and has</font><font color="#CCCCCC"> three</font>

283
00:13:13,890 --> 00:13:19,649
detections on<font color="#E5E5E5"> one virustotal</font>

284
00:13:16,589 --> 00:13:23,970
which makes me<font color="#CCCCCC"> think that it's smaller</font>

285
00:13:19,649 --> 00:13:27,360
so<font color="#E5E5E5"> let's look a bit into it a little bit</font>

286
00:13:23,970 --> 00:13:30,440
<font color="#E5E5E5">more looking into process</font><font color="#CCCCCC"> Explorer the</font>

287
00:13:27,360 --> 00:13:35,600
one from sysinternals you'll see that

288
00:13:30,440 --> 00:13:38,430
after<font color="#CCCCCC"> Windows starts</font><font color="#E5E5E5"> this table dot exe</font>

289
00:13:35,600 --> 00:13:40,709
another two processes appear within<font color="#E5E5E5"> the</font>

290
00:13:38,430 --> 00:13:44,399
operating<font color="#E5E5E5"> system the first one is</font><font color="#CCCCCC"> mxi</font>

291
00:13:40,709 --> 00:13:49,579
exec from<font color="#E5E5E5"> the Windows operating system</font>

292
00:13:44,399 --> 00:13:55,500
<font color="#E5E5E5">under services and that one starts</font>

293
00:13:49,580 --> 00:13:58,770
and<font color="#E5E5E5"> si host file if you remember this</font>

294
00:13:55,500 --> 00:14:01,980
<font color="#E5E5E5">MSI</font><font color="#CCCCCC"> file at the top</font><font color="#E5E5E5"> previously it has</font>

295
00:13:58,770 --> 00:14:05,699
another<font color="#E5E5E5"> P file embedded within it so if</font>

296
00:14:01,980 --> 00:14:07,740
you unpack the code and drop the second

297
00:14:05,700 --> 00:14:11,400
stage<font color="#CCCCCC"> sample</font><font color="#E5E5E5"> you'll end up with that</font>

298
00:14:07,740 --> 00:14:14,160
<font color="#CCCCCC">Delfy binary that</font><font color="#E5E5E5"> I said</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> its sign and</font>

299
00:14:11,400 --> 00:14:17,100
<font color="#E5E5E5">our signature is still valid and the</font>

300
00:14:14,160 --> 00:14:21,180
detection ratio virustotal<font color="#E5E5E5"> increases</font>

301
00:14:17,100 --> 00:14:23,130
each day so let's put a bit at the

302
00:14:21,180 --> 00:14:25,920
<font color="#E5E5E5">interesting part of this infection</font>

303
00:14:23,130 --> 00:14:30,180
scenario<font color="#E5E5E5"> I think</font><font color="#CCCCCC"> I should go over</font><font color="#E5E5E5"> here</font>

304
00:14:25,920 --> 00:14:34,170
so that<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can see the code better if</font>

305
00:14:30,180 --> 00:14:36,709
you open the word document<font color="#CCCCCC"> and extract</font>

306
00:14:34,170 --> 00:14:38,880
the<font color="#CCCCCC"> PPA</font><font color="#E5E5E5"> script you'll end up</font><font color="#CCCCCC"> with this</font>

307
00:14:36,710 --> 00:14:41,880
<font color="#E5E5E5">from my point of view it's a pretty</font>

308
00:14:38,880 --> 00:14:43,290
small piece of<font color="#E5E5E5"> code</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> think that</font>

309
00:14:41,880 --> 00:14:45,660
it's<font color="#E5E5E5"> interesting over here even</font><font color="#CCCCCC"> though</font>

310
00:14:43,290 --> 00:14:48,329
it's<font color="#E5E5E5"> pretty small it has also some junk</font>

311
00:14:45,660 --> 00:14:49,920
code<font color="#E5E5E5"> in it you can see some variables</font>

312
00:14:48,330 --> 00:14:52,610
over<font color="#CCCCCC"> here some objects</font><font color="#E5E5E5"> being declared</font>

313
00:14:49,920 --> 00:14:55,170
<font color="#E5E5E5">but they're never used anywhere so</font>

314
00:14:52,610 --> 00:15:02,100
looking<font color="#CCCCCC"> through the code I see this</font>

315
00:14:55,170 --> 00:15:05,280
table<font color="#E5E5E5"> dot exe further down I see file</font>

316
00:15:02,100 --> 00:15:08,040
copy<font color="#E5E5E5"> and this file copy receives two</font>

317
00:15:05,280 --> 00:15:11,400
arguments<font color="#CCCCCC"> the first one is</font><font color="#E5E5E5"> frm that</font>

318
00:15:08,040 --> 00:15:13,680
label on<font color="#E5E5E5"> the tag which it's a variable</font>

319
00:15:11,400 --> 00:15:16,380
that<font color="#E5E5E5"> I don't know what it where it's</font>

320
00:15:13,680 --> 00:15:21,979
being declared as let's know we're<font color="#E5E5E5"> over</font>

321
00:15:16,380 --> 00:15:26,370
here and the second one<font color="#E5E5E5"> that calls the</font>

322
00:15:21,980 --> 00:15:28,780
path to table dot exe the second

323
00:15:26,370 --> 00:15:31,220
instruction that catches my<font color="#CCCCCC"> attention</font><font color="#E5E5E5"> is</font>

324
00:15:28,780 --> 00:15:37,010
[Music]

325
00:15:31,220 --> 00:15:40,620
is this one down so this basically

326
00:15:37,010 --> 00:15:44,189
concatenates<font color="#E5E5E5"> to two variables using that</font>

327
00:15:40,620 --> 00:15:46,140
<font color="#E5E5E5">app and then creates a new process this</font>

328
00:15:44,190 --> 00:15:48,690
creates a process<font color="#E5E5E5"> with</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> command</font><font color="#CCCCCC"> line</font>

329
00:15:46,140 --> 00:15:53,010
and<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> see how that's being</font>

330
00:15:48,690 --> 00:15:55,640
achieved<font color="#E5E5E5"> looking more into the into the</font>

331
00:15:53,010 --> 00:15:58,670
VBA script of the word<font color="#E5E5E5"> document</font>

332
00:15:55,640 --> 00:16:00,560
see that it has an<font color="#E5E5E5"> embedded</font><font color="#CCCCCC"> win form in</font>

333
00:15:58,670 --> 00:16:03,290
it<font color="#E5E5E5"> which has never been displayed for</font>

334
00:16:00,560 --> 00:16:06,319
<font color="#CCCCCC">the for the user</font><font color="#E5E5E5"> it has multiple objects</font>

335
00:16:03,290 --> 00:16:10,760
in it<font color="#CCCCCC"> so the main window and</font><font color="#E5E5E5"> some labels</font>

336
00:16:06,320 --> 00:16:14,510
over here<font color="#CCCCCC"> so if you start debugging</font><font color="#E5E5E5"> this</font>

337
00:16:10,760 --> 00:16:17,750
script and go<font color="#E5E5E5"> to here at this file copy</font>

338
00:16:14,510 --> 00:16:22,010
<font color="#CCCCCC">you will see that frm</font><font color="#E5E5E5"> that label 1 dot</font>

339
00:16:17,750 --> 00:16:25,700
<font color="#CCCCCC">tech contains this path over here</font><font color="#E5E5E5"> the</font>

340
00:16:22,010 --> 00:16:29,540
path<font color="#E5E5E5"> to</font><font color="#CCCCCC"> MSI offset which is a windows</font>

341
00:16:25,700 --> 00:16:32,600
binary<font color="#E5E5E5"> legit 100% clean code from the</font>

342
00:16:29,540 --> 00:16:37,459
operating system<font color="#E5E5E5"> and it's being used to</font>

343
00:16:32,600 --> 00:16:41,360
<font color="#E5E5E5">copy it to cable not easy and of course</font>

344
00:16:37,459 --> 00:16:43,699
we<font color="#E5E5E5"> need to devote table dot exe so where</font>

345
00:16:41,360 --> 00:16:47,000
do these variables<font color="#CCCCCC"> where are these</font>

346
00:16:43,700 --> 00:16:50,649
<font color="#E5E5E5">variables declared these objects over</font>

347
00:16:47,000 --> 00:16:53,480
<font color="#E5E5E5">here from we forms have some controls so</font>

348
00:16:50,649 --> 00:16:56,510
if you look<font color="#E5E5E5"> at the controls for</font><font color="#CCCCCC"> each of</font>

349
00:16:53,480 --> 00:17:00,230
these objects<font color="#E5E5E5"> down at the bottom you'll</font>

350
00:16:56,510 --> 00:17:04,459
see a small<font color="#E5E5E5"> property named tag so that</font>

351
00:17:00,230 --> 00:17:07,990
<font color="#E5E5E5">tag over there has the path to that URL</font>

352
00:17:04,459 --> 00:17:12,770
<font color="#E5E5E5">that I am told one from the command line</font>

353
00:17:07,990 --> 00:17:14,689
<font color="#E5E5E5">so if you have security</font><font color="#CCCCCC"> products on</font><font color="#E5E5E5"> your</font>

354
00:17:12,770 --> 00:17:17,150
machine<font color="#CCCCCC"> where you</font><font color="#E5E5E5"> want to do some</font>

355
00:17:14,689 --> 00:17:20,030
forensics where you have some cool

356
00:17:17,150 --> 00:17:22,790
script that autumn<font color="#CCCCCC"> eise's</font><font color="#E5E5E5"> the analysis</font>

357
00:17:20,030 --> 00:17:27,020
of<font color="#E5E5E5"> word document of</font><font color="#CCCCCC"> work of Office</font>

358
00:17:22,790 --> 00:17:29,210
documents most of them dumped the<font color="#E5E5E5"> VBA</font>

359
00:17:27,020 --> 00:17:31,010
script<font color="#CCCCCC"> do some analysis over it they can</font>

360
00:17:29,210 --> 00:17:33,730
apply<font color="#E5E5E5"> some</font><font color="#CCCCCC"> error</font><font color="#E5E5E5"> rules they can</font><font color="#CCCCCC"> look for</font>

361
00:17:31,010 --> 00:17:38,360
<font color="#E5E5E5">strings</font><font color="#CCCCCC"> occur for PowerShell encoded</font>

362
00:17:33,730 --> 00:17:40,600
<font color="#E5E5E5">commands like base64 but apply some ml</font>

363
00:17:38,360 --> 00:17:42,678
<font color="#E5E5E5">on it maybe I don't know where any other</font>

364
00:17:40,600 --> 00:17:44,959
interesting technology that they may

365
00:17:42,679 --> 00:17:47,210
have<font color="#E5E5E5"> but you don't find</font><font color="#CCCCCC"> anything here</font>

366
00:17:44,960 --> 00:17:50,780
<font color="#E5E5E5">because all of the malicious part it's</font>

367
00:17:47,210 --> 00:17:52,160
being hidden in the in the controls of

368
00:17:50,780 --> 00:17:54,980
the

369
00:17:52,160 --> 00:17:56,410
<font color="#CCCCCC">before</font><font color="#E5E5E5"> so I don't want to keep your</font>

370
00:17:54,980 --> 00:17:59,090
ideas<font color="#E5E5E5"> because I know you have something</font>

371
00:17:56,410 --> 00:18:02,030
you are<font color="#E5E5E5"> some</font><font color="#CCCCCC"> test pen testers over here</font>

372
00:17:59,090 --> 00:18:03,669
but instead<font color="#CCCCCC"> of using MSI</font><font color="#E5E5E5"> exec you can</font>

373
00:18:02,030 --> 00:18:06,320
use PowerShell and<font color="#E5E5E5"> instead of having</font>

374
00:18:03,670 --> 00:18:09,800
that URL<font color="#E5E5E5"> over there you can use</font><font color="#CCCCCC"> an</font>

375
00:18:06,320 --> 00:18:13,370
<font color="#CCCCCC">encoded command and you don't see</font>

376
00:18:09,800 --> 00:18:16,070
PowerShell being started by<font color="#CCCCCC"> Windward</font>

377
00:18:13,370 --> 00:18:19,129
you'll see a little<font color="#E5E5E5"> table not easy or</font>

378
00:18:16,070 --> 00:18:25,820
whatever not easy<font color="#E5E5E5"> with very long string</font>

379
00:18:19,130 --> 00:18:29,480
at the<font color="#CCCCCC"> end not many red flags are raised</font>

380
00:18:25,820 --> 00:18:33,110
because<font color="#E5E5E5"> of that but they should so this</font>

381
00:18:29,480 --> 00:18:35,230
was the<font color="#E5E5E5"> first example I'm</font><font color="#CCCCCC"> going to go</font>

382
00:18:33,110 --> 00:18:38,750
<font color="#CCCCCC">down to the next</font><font color="#E5E5E5"> one</font>

383
00:18:35,230 --> 00:18:41,060
I'm going to talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> VMI</font><font color="#CCCCCC"> and how it</font>

384
00:18:38,750 --> 00:18:43,760
can be used to inject it into other

385
00:18:41,060 --> 00:18:48,649
binaries<font color="#E5E5E5"> the technique that</font><font color="#CCCCCC"> I said that</font>

386
00:18:43,760 --> 00:18:51,050
it's called feebly to also some people

387
00:18:48,650 --> 00:18:53,510
like to<font color="#E5E5E5"> talk about this technique and</font>

388
00:18:51,050 --> 00:18:57,399
say that<font color="#E5E5E5"> it's file is smaller but it's</font>

389
00:18:53,510 --> 00:18:57,400
not really<font color="#CCCCCC"> fast and</font><font color="#E5E5E5"> we're gonna see why</font>

390
00:18:58,030 --> 00:19:07,070
this is a<font color="#E5E5E5"> spring spring from Falcon</font><font color="#CCCCCC"> ey</font>

391
00:19:00,800 --> 00:19:09,230
again<font color="#CCCCCC"> on the left here we</font><font color="#E5E5E5"> see VMI for</font>

392
00:19:07,070 --> 00:19:11,240
those that don't<font color="#E5E5E5"> know what VMI is it's a</font>

393
00:19:09,230 --> 00:19:14,030
technology<font color="#E5E5E5"> embedded within the operating</font>

394
00:19:11,240 --> 00:19:15,350
system<font color="#E5E5E5"> Windows operating system since</font>

395
00:19:14,030 --> 00:19:19,430
<font color="#E5E5E5">Windows</font><font color="#CCCCCC"> 95</font>

396
00:19:15,350 --> 00:19:22,550
it enables you to create<font color="#CCCCCC"> sql-like</font>

397
00:19:19,430 --> 00:19:24,680
queries to<font color="#CCCCCC"> the operating</font><font color="#E5E5E5"> system</font><font color="#CCCCCC"> you can</font>

398
00:19:22,550 --> 00:19:26,270
<font color="#CCCCCC">create files you can create processes</font>

399
00:19:24,680 --> 00:19:28,010
you<font color="#CCCCCC"> can delete registries you can do</font>

400
00:19:26,270 --> 00:19:31,730
whatever you want it's<font color="#E5E5E5"> a tool that it</font>

401
00:19:28,010 --> 00:19:33,230
was and still is<font color="#E5E5E5"> very popular among IT</font>

402
00:19:31,730 --> 00:19:35,960
administrators<font color="#CCCCCC"> among network</font>

403
00:19:33,230 --> 00:19:38,330
<font color="#E5E5E5">administrators to be able to deploy</font>

404
00:19:35,960 --> 00:19:43,160
different kind of scripts within their

405
00:19:38,330 --> 00:19:45,740
their<font color="#CCCCCC"> networks</font><font color="#E5E5E5"> but recently modern</font>

406
00:19:43,160 --> 00:19:51,110
developers started to understand<font color="#E5E5E5"> this</font>

407
00:19:45,740 --> 00:19:53,630
<font color="#CCCCCC">technology and</font><font color="#E5E5E5"> to leverage its powers so</font>

408
00:19:51,110 --> 00:19:56,540
why is this am i important if you look

409
00:19:53,630 --> 00:19:58,040
over here<font color="#E5E5E5"> on the right side we</font><font color="#CCCCCC"> have a</font>

410
00:19:56,540 --> 00:20:03,170
common line which is being highlighted

411
00:19:58,040 --> 00:20:04,820
here we see that<font color="#CCCCCC"> VMI</font><font color="#E5E5E5"> has a very</font>

412
00:20:03,170 --> 00:20:10,310
interesting command line printer get

413
00:20:04,820 --> 00:20:16,240
device ID format<font color="#E5E5E5"> then again</font><font color="#CCCCCC"> a URL to</font>

414
00:20:10,310 --> 00:20:18,379
<font color="#CCCCCC">some form /</font><font color="#E5E5E5"> H forms so what about this</font>

415
00:20:16,240 --> 00:20:20,780
this URL over here

416
00:20:18,380 --> 00:20:23,150
<font color="#CCCCCC">VMI will go to this address</font><font color="#E5E5E5"> will</font>

417
00:20:20,780 --> 00:20:26,960
download the content and if the contents

418
00:20:23,150 --> 00:20:29,200
are according to<font color="#CCCCCC"> a standard the standard</font>

419
00:20:26,960 --> 00:20:34,640
<font color="#E5E5E5">is called extensible stylesheet language</font>

420
00:20:29,200 --> 00:20:37,030
<font color="#E5E5E5">it will execute those those instructions</font>

421
00:20:34,640 --> 00:20:41,980
where<font color="#CCCCCC"> a what whatever</font><font color="#E5E5E5"> it finds over here</font>

422
00:20:37,030 --> 00:20:47,660
so let's see what's happening<font color="#CCCCCC"> in that</font>

423
00:20:41,980 --> 00:20:48,890
extensible stylesheet<font color="#CCCCCC"> sorry</font><font color="#E5E5E5"> so if you</font>

424
00:20:47,660 --> 00:20:51,320
don't know the contents you'll end up

425
00:20:48,890 --> 00:20:55,100
with<font color="#E5E5E5"> this file over</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> well think</font>

426
00:20:51,320 --> 00:20:58,370
about extensible stylesheet has a

427
00:20:55,100 --> 00:21:01,969
wrapper<font color="#CCCCCC"> for jscript</font>

428
00:20:58,370 --> 00:21:03,350
<font color="#E5E5E5">or VPS in this case the code the</font>

429
00:21:01,970 --> 00:21:05,560
programming language that<font color="#E5E5E5"> is</font><font color="#CCCCCC"> being used</font>

430
00:21:03,350 --> 00:21:08,330
is<font color="#CCCCCC"> VBS</font>

431
00:21:05,560 --> 00:21:10,580
so let's<font color="#E5E5E5"> comment</font><font color="#CCCCCC"> a bit</font><font color="#E5E5E5"> about on the code</font>

432
00:21:08,330 --> 00:21:13,669
<font color="#E5E5E5">the first thing</font><font color="#CCCCCC"> that catches</font><font color="#E5E5E5"> my</font>

433
00:21:10,580 --> 00:21:15,620
attention<font color="#E5E5E5"> it's this function over here</font>

434
00:21:13,670 --> 00:21:18,800
<font color="#E5E5E5">which is being collapsed not to buy a</font>

435
00:21:15,620 --> 00:21:21,110
lot<font color="#E5E5E5"> of space on the on the</font><font color="#CCCCCC"> screen this</font><font color="#E5E5E5"> I</font>

436
00:21:18,800 --> 00:21:24,379
<font color="#E5E5E5">think you already know does some base64</font>

437
00:21:21,110 --> 00:21:27,080
decoding down we see some declarations

438
00:21:24,380 --> 00:21:30,440
<font color="#CCCCCC">of some variables and there you have</font>

439
00:21:27,080 --> 00:21:34,020
<font color="#E5E5E5">assigned some different strings like</font>

440
00:21:30,440 --> 00:21:38,120
<font color="#E5E5E5">xcms build a path to an interesting file</font>

441
00:21:34,020 --> 00:21:42,110
<font color="#E5E5E5">name see versions dot 0 dot</font><font color="#CCCCCC"> DP and</font>

442
00:21:38,120 --> 00:21:45,810
microsoft.net framework before<font color="#E5E5E5"> and other</font>

443
00:21:42,110 --> 00:21:50,100
numbers over here<font color="#E5E5E5"> looking down into</font><font color="#CCCCCC"> the</font>

444
00:21:45,810 --> 00:21:51,929
code we'll see that this function over

445
00:21:50,100 --> 00:21:54,929
<font color="#CCCCCC">here</font><font color="#E5E5E5"> is being used to decode it</font><font color="#CCCCCC"> this</font>

446
00:21:51,930 --> 00:21:58,230
<font color="#E5E5E5">very long string and assign</font><font color="#CCCCCC"> it to</font><font color="#E5E5E5"> the</font>

447
00:21:54,930 --> 00:22:01,680
variable named<font color="#CCCCCC"> frog</font><font color="#E5E5E5"> the contents of this</font>

448
00:21:58,230 --> 00:22:04,080
very variable<font color="#E5E5E5"> are then dumped into a</font>

449
00:22:01,680 --> 00:22:06,900
file on<font color="#CCCCCC"> disk using Create file and</font><font color="#E5E5E5"> write</font>

450
00:22:04,080 --> 00:22:10,139
line into this<font color="#CCCCCC"> sea variable subversions</font>

451
00:22:06,900 --> 00:22:14,820
<font color="#E5E5E5">over here so this is the first file that</font>

452
00:22:10,140 --> 00:22:18,540
that touches the disk<font color="#E5E5E5"> right now and if</font>

453
00:22:14,820 --> 00:22:20,070
you decode the<font color="#CCCCCC"> the</font><font color="#E5E5E5"> long basic step or</font>

454
00:22:18,540 --> 00:22:23,490
<font color="#E5E5E5">the string you will end up with</font><font color="#CCCCCC"> some</font>

455
00:22:20,070 --> 00:22:26,639
c-sharp code<font color="#E5E5E5"> so what does this script do</font>

456
00:22:23,490 --> 00:22:29,850
its completes creating a very long

457
00:22:26,640 --> 00:22:32,340
comment line over here<font color="#CCCCCC"> by concatenating</font>

458
00:22:29,850 --> 00:22:36,389
these strings up top<font color="#E5E5E5"> and it's using</font>

459
00:22:32,340 --> 00:22:40,580
msbuild to compile dynamically some

460
00:22:36,390 --> 00:22:44,760
c-sharp code<font color="#E5E5E5"> that's the main reason why</font>

461
00:22:40,580 --> 00:22:49,550
<font color="#CCCCCC">msbuild is over here</font><font color="#E5E5E5"> to compile C sharp</font>

462
00:22:44,760 --> 00:22:52,530
<font color="#E5E5E5">and then of course it's being</font><font color="#CCCCCC"> ran next</font>

463
00:22:49,550 --> 00:22:54,540
<font color="#E5E5E5">yeah</font><font color="#CCCCCC"> this is the common line catenate</font>

464
00:22:52,530 --> 00:22:58,340
the see<font color="#E5E5E5"> windows microsoft.net framework</font>

465
00:22:54,540 --> 00:22:59,690
before<font color="#CCCCCC"> name</font><font color="#E5E5E5"> is Bill and the path to that</font>

466
00:22:58,340 --> 00:23:03,139
[Music]

467
00:22:59,690 --> 00:23:03,140
file<font color="#CCCCCC"> over there</font>

468
00:23:06,180 --> 00:23:11,290
okay this is the c-sharp code<font color="#E5E5E5"> this is</font>

469
00:23:09,070 --> 00:23:15,330
the main function but you can't see it

470
00:23:11,290 --> 00:23:15,330
very well<font color="#CCCCCC"> it's pretty</font><font color="#E5E5E5"> short function</font>

471
00:23:15,960 --> 00:23:20,040
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is the code</font><font color="#CCCCCC"> that will be compiled</font>

472
00:23:18,280 --> 00:23:24,460
<font color="#CCCCCC">and executed by msbuild</font>

473
00:23:20,040 --> 00:23:26,770
so up<font color="#E5E5E5"> top we see again</font><font color="#CCCCCC"> another base64</font>

474
00:23:24,460 --> 00:23:29,620
encoded string<font color="#E5E5E5"> decoding the string will</font>

475
00:23:26,770 --> 00:23:32,410
end up with<font color="#E5E5E5"> P binary we can see the</font>

476
00:23:29,620 --> 00:23:35,290
first<font color="#E5E5E5"> two bytes over here I am set and</font>

477
00:23:32,410 --> 00:23:39,190
then<font color="#E5E5E5"> the P</font><font color="#CCCCCC"> here which are which is</font><font color="#E5E5E5"> being</font>

478
00:23:35,290 --> 00:23:42,700
highlighted<font color="#E5E5E5"> and then several api's are</font>

479
00:23:39,190 --> 00:23:45,370
used to create a new process out<font color="#CCCCCC"> of C</font>

480
00:23:42,700 --> 00:23:48,820
windows system32<font color="#E5E5E5"> ICS and at theta dot</font>

481
00:23:45,370 --> 00:23:51,100
exe<font color="#E5E5E5"> which is a legitimate file between</font>

482
00:23:48,820 --> 00:23:54,730
the<font color="#E5E5E5"> operating system it creates the</font>

483
00:23:51,100 --> 00:23:57,040
process with a suspended flag<font color="#E5E5E5"> allocate</font>

484
00:23:54,730 --> 00:24:00,040
some memory write some code into<font color="#CCCCCC"> that</font>

485
00:23:57,040 --> 00:24:02,440
newly<font color="#E5E5E5"> created process gets a handle to</font>

486
00:24:00,040 --> 00:24:06,070
the<font color="#CCCCCC"> fret</font><font color="#E5E5E5"> creates on a synchronous</font>

487
00:24:02,440 --> 00:24:08,670
procedure call and then<font color="#E5E5E5"> resumes the</font>

488
00:24:06,070 --> 00:24:12,100
<font color="#CCCCCC">friend's execution by ten days it's</font>

489
00:24:08,670 --> 00:24:15,660
starting<font color="#E5E5E5"> a new process it empties it out</font>

490
00:24:12,100 --> 00:24:20,280
and then inject malicious code<font color="#E5E5E5"> into it</font>

491
00:24:15,660 --> 00:24:25,840
so this<font color="#E5E5E5"> is the entire functionality of</font>

492
00:24:20,280 --> 00:24:31,060
<font color="#E5E5E5">this c-sharp over here but as I said</font>

493
00:24:25,840 --> 00:24:33,159
<font color="#CCCCCC">this is</font><font color="#E5E5E5"> considered far less but it's not</font>

494
00:24:31,060 --> 00:24:36,730
actually<font color="#CCCCCC"> the case because when</font><font color="#E5E5E5"> M is</font>

495
00:24:33,160 --> 00:24:40,860
<font color="#E5E5E5">built over</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> starts the compilation</font>

496
00:24:36,730 --> 00:24:43,810
<font color="#E5E5E5">it will write</font><font color="#CCCCCC"> a DLL want to the</font><font color="#E5E5E5"> disk</font>

497
00:24:40,860 --> 00:24:47,290
into the temp directory with random name

498
00:24:43,810 --> 00:24:54,550
slash the dot<font color="#E5E5E5"> DLL</font><font color="#CCCCCC"> and this</font><font color="#E5E5E5"> DLL will be</font>

499
00:24:47,290 --> 00:24:56,620
loaded<font color="#E5E5E5"> and executed by msbuild so this</font>

500
00:24:54,550 --> 00:24:59,700
is why I'm saying that<font color="#E5E5E5"> it's not true</font>

501
00:24:56,620 --> 00:25:02,770
<font color="#CCCCCC">fallas file</font><font color="#E5E5E5"> true fallacy infection story</font>

502
00:24:59,700 --> 00:25:06,460
<font color="#E5E5E5">because by now every</font><font color="#CCCCCC"> forensic tool out</font>

503
00:25:02,770 --> 00:25:08,379
there<font color="#E5E5E5"> will be able to get this far</font><font color="#CCCCCC"> over</font>

504
00:25:06,460 --> 00:25:11,620
here you can compute the hash can

505
00:25:08,380 --> 00:25:12,180
download it save it<font color="#E5E5E5"> to cloud apply again</font>

506
00:25:11,620 --> 00:25:14,790
some

507
00:25:12,180 --> 00:25:20,700
<font color="#CCCCCC">Maloney</font><font color="#E5E5E5"> do some static analysis or</font>

508
00:25:14,790 --> 00:25:22,740
whatever<font color="#E5E5E5"> so it's not very good</font><font color="#CCCCCC"> I see you</font>

509
00:25:20,700 --> 00:25:28,230
had<font color="#E5E5E5"> to use</font><font color="#CCCCCC"> ms building</font><font color="#E5E5E5"> this scenario</font>

510
00:25:22,740 --> 00:25:32,640
<font color="#E5E5E5">because you're not using</font><font color="#CCCCCC"> the true file</font>

511
00:25:28,230 --> 00:25:38,400
this infection technique so by now since

512
00:25:32,640 --> 00:25:44,520
<font color="#CCCCCC">M is built</font><font color="#E5E5E5"> compiled that</font><font color="#CCCCCC"> c-sharp</font><font color="#E5E5E5"> and ran</font>

513
00:25:38,400 --> 00:25:49,020
it<font color="#CCCCCC"> the previous</font><font color="#E5E5E5"> file over</font><font color="#CCCCCC"> here which</font><font color="#E5E5E5"> is</font>

514
00:25:44,520 --> 00:25:51,840
which<font color="#CCCCCC"> can be some</font><font color="#E5E5E5"> back door apart</font><font color="#CCCCCC"> it can</font>

515
00:25:49,020 --> 00:25:54,720
<font color="#CCCCCC">be a ransomware</font><font color="#E5E5E5"> is now running within</font>

516
00:25:51,840 --> 00:25:57,480
your operating system as ICS unattended

517
00:25:54,720 --> 00:26:00,420
<font color="#CCCCCC">so if you open up task manager you don't</font>

518
00:25:57,480 --> 00:26:03,060
find anything over there you'll just<font color="#E5E5E5"> see</font>

519
00:26:00,420 --> 00:26:05,850
a file residing in system<font color="#CCCCCC"> 40</font><font color="#E5E5E5"> to go</font>

520
00:26:03,060 --> 00:26:08,190
process<font color="#E5E5E5"> with the file path residing in</font>

521
00:26:05,850 --> 00:26:10,050
system<font color="#E5E5E5"> 42 if you compute</font><font color="#CCCCCC"> the half of</font>

522
00:26:08,190 --> 00:26:14,270
this file you'll see<font color="#CCCCCC"> that it's clean</font>

523
00:26:10,050 --> 00:26:16,860
what in<font color="#E5E5E5"> fact it has running</font><font color="#CCCCCC"> Mahler in it</font>

524
00:26:14,270 --> 00:26:23,610
so let's move on to the third and<font color="#CCCCCC"> last</font>

525
00:26:16,860 --> 00:26:29,820
<font color="#E5E5E5">example please work the one recording</font>

526
00:26:23,610 --> 00:26:33,560
steganography<font color="#CCCCCC"> again typical social</font>

527
00:26:29,820 --> 00:26:36,240
engineering message with the macro on it

528
00:26:33,560 --> 00:26:38,490
<font color="#CCCCCC">this</font><font color="#E5E5E5"> one over</font><font color="#CCCCCC"> here has</font><font color="#E5E5E5"> a message in</font>

529
00:26:36,240 --> 00:26:40,370
<font color="#CCCCCC">italian convincing you to</font><font color="#E5E5E5"> click</font><font color="#CCCCCC"> that to</font>

530
00:26:38,490 --> 00:26:42,890
a<font color="#E5E5E5"> bottom where there and we'll see why</font>

531
00:26:40,370 --> 00:26:47,060
<font color="#E5E5E5">the message is in</font><font color="#CCCCCC"> italian</font><font color="#E5E5E5"> and not</font>

532
00:26:42,890 --> 00:26:49,160
or other language<font color="#CCCCCC"> in</font><font color="#E5E5E5"> this case I'm not</font>

533
00:26:47,060 --> 00:26:52,370
interested<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> VBA script</font>

534
00:26:49,160 --> 00:26:55,790
I'm just interesting<font color="#E5E5E5"> how it's being used</font>

535
00:26:52,370 --> 00:26:58,550
<font color="#E5E5E5">to to infect a machine in this</font><font color="#CCCCCC"> Fred</font>

536
00:26:55,790 --> 00:27:02,240
graph over here<font color="#E5E5E5"> how we like</font><font color="#CCCCCC"> to call this</font>

537
00:26:58,550 --> 00:27:05,899
nice<font color="#E5E5E5"> picture over here we see that Excel</font>

538
00:27:02,240 --> 00:27:08,750
creates<font color="#CCCCCC"> CMD</font><font color="#E5E5E5"> dot exe process which spawns</font>

539
00:27:05,900 --> 00:27:13,970
other processes one<font color="#CCCCCC"> CMP you another CMD</font>

540
00:27:08,750 --> 00:27:17,600
<font color="#E5E5E5">a</font><font color="#CCCCCC"> clipper</font><font color="#E5E5E5"> exe clip let's the windows</font>

541
00:27:13,970 --> 00:27:20,350
<font color="#E5E5E5">tool that copies whatever you put on the</font>

542
00:27:17,600 --> 00:27:22,929
command<font color="#CCCCCC"> line and it will</font><font color="#E5E5E5"> be copied to</font>

543
00:27:20,350 --> 00:27:28,639
the clipboard of the operating<font color="#E5E5E5"> system</font>

544
00:27:22,930 --> 00:27:31,040
then we see<font color="#CCCCCC"> PowerShell being being</font>

545
00:27:28,640 --> 00:27:32,990
started and<font color="#E5E5E5"> we should have seen another</font>

546
00:27:31,040 --> 00:27:35,899
process over here but<font color="#E5E5E5"> we're gonna get in</font>

547
00:27:32,990 --> 00:27:40,460
that details a bit later<font color="#E5E5E5"> so let's look</font>

548
00:27:35,900 --> 00:27:43,460
at the command line over there next this

549
00:27:40,460 --> 00:27:46,150
<font color="#CCCCCC">is it</font><font color="#E5E5E5"> it's pretty office kata</font><font color="#CCCCCC"> Tjuta you</font>

550
00:27:43,460 --> 00:27:49,160
can't<font color="#CCCCCC"> read a lot of</font><font color="#E5E5E5"> things out</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> this</font>

551
00:27:46,150 --> 00:27:53,000
but if you look<font color="#CCCCCC"> closely right</font><font color="#E5E5E5"> in the</font>

552
00:27:49,160 --> 00:27:55,970
<font color="#E5E5E5">middle you'll see URL string pointing to</font>

553
00:27:53,000 --> 00:27:58,550
a randomly named image<font color="#CCCCCC"> randomly</font><font color="#E5E5E5"> named</font>

554
00:27:55,970 --> 00:28:02,750
file which has<font color="#CCCCCC"> a</font><font color="#E5E5E5"> PNG extension so at</font>

555
00:27:58,550 --> 00:28:05,450
this point I said<font color="#E5E5E5"> that so why bothering</font>

556
00:28:02,750 --> 00:28:07,610
to rename<font color="#CCCCCC"> your executable as as a PNG</font>

557
00:28:05,450 --> 00:28:09,320
<font color="#E5E5E5">file of course</font><font color="#CCCCCC"> it's not</font><font color="#E5E5E5"> executable let's</font>

558
00:28:07,610 --> 00:28:14,510
download it and see what it<font color="#CCCCCC"> does and</font>

559
00:28:09,320 --> 00:28:16,220
look at at the<font color="#E5E5E5"> file now I can fall and</font>

560
00:28:14,510 --> 00:28:20,030
<font color="#CCCCCC">look I'm looking at the head header</font>

561
00:28:16,220 --> 00:28:25,070
<font color="#E5E5E5">you'll see the magic Vice over here for</font>

562
00:28:20,030 --> 00:28:27,110
for the PNG<font color="#E5E5E5"> file so this is a</font><font color="#CCCCCC"> 100%</font><font color="#E5E5E5"> image</font>

563
00:28:25,070 --> 00:28:29,060
file and if you open<font color="#CCCCCC"> it you'll see a</font>

564
00:28:27,110 --> 00:28:33,830
cute<font color="#E5E5E5"> little green team over here</font>

565
00:28:29,060 --> 00:28:37,070
<font color="#CCCCCC">free sorry okay so what's the point of</font>

566
00:28:33,830 --> 00:28:40,939
this why is it using a PNG file in

567
00:28:37,070 --> 00:28:43,909
the<font color="#E5E5E5"> mother infection process going back</font>

568
00:28:40,940 --> 00:28:48,590
<font color="#E5E5E5">to the code</font><font color="#CCCCCC"> this common line over here</font>

569
00:28:43,910 --> 00:28:51,410
<font color="#CCCCCC">is being composed of two two parts</font><font color="#E5E5E5"> the</font>

570
00:28:48,590 --> 00:28:53,149
first<font color="#E5E5E5"> one just echoes</font><font color="#CCCCCC"> a very big string</font>

571
00:28:51,410 --> 00:28:56,150
to click on<font color="#CCCCCC"> txz</font>

572
00:28:53,150 --> 00:28:59,360
using<font color="#E5E5E5"> this pipe over here this cop is</font>

573
00:28:56,150 --> 00:29:01,430
the<font color="#CCCCCC"> code to the clipboard</font><font color="#E5E5E5"> and then</font>

574
00:28:59,360 --> 00:29:04,429
another<font color="#E5E5E5"> partial commercial command is</font>

575
00:29:01,430 --> 00:29:07,420
being<font color="#E5E5E5"> around let's look at this second</font>

576
00:29:04,430 --> 00:29:07,420
part over here right now

577
00:29:08,650 --> 00:29:13,940
this is the code again<font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit off</font>

578
00:29:11,330 --> 00:29:17,090
<font color="#E5E5E5">escape it but if you use</font><font color="#CCCCCC"> the magic and</font>

579
00:29:13,940 --> 00:29:19,490
the<font color="#E5E5E5"> obfuscated</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> will see that it</font>

580
00:29:17,090 --> 00:29:22,639
creates a<font color="#CCCCCC"> win</font><font color="#E5E5E5"> form object and using</font><font color="#CCCCCC"> the</font>

581
00:29:19,490 --> 00:29:25,850
clipboard class it will<font color="#E5E5E5"> involve the get</font>

582
00:29:22,640 --> 00:29:28,310
text<font color="#CCCCCC"> method to get a Content</font><font color="#E5E5E5"> to get the</font>

583
00:29:25,850 --> 00:29:31,669
content out<font color="#E5E5E5"> of that clipboard</font><font color="#CCCCCC"> of the</font>

584
00:29:28,310 --> 00:29:35,179
operating system<font color="#E5E5E5"> and by doing that it</font>

585
00:29:31,670 --> 00:29:37,580
wipes out the content of<font color="#E5E5E5"> of the</font>

586
00:29:35,180 --> 00:29:39,950
<font color="#E5E5E5">clipboard</font><font color="#CCCCCC"> to invoke expression</font><font color="#E5E5E5"> revoke</font>

587
00:29:37,580 --> 00:29:43,669
expression for<font color="#E5E5E5"> though the dot for those</font>

588
00:29:39,950 --> 00:29:46,820
that<font color="#E5E5E5"> don't know</font><font color="#CCCCCC"> PowerShell it's like</font><font color="#E5E5E5"> if</font>

589
00:29:43,670 --> 00:29:49,810
<font color="#E5E5E5">L from JavaScript you just give it a</font>

590
00:29:46,820 --> 00:29:53,210
string and<font color="#E5E5E5"> it will execute it happily</font>

591
00:29:49,810 --> 00:29:56,480
<font color="#CCCCCC">and the last line over here just to</font>

592
00:29:53,210 --> 00:29:58,580
remove the<font color="#CCCCCC"> traces</font><font color="#E5E5E5"> clears up</font><font color="#CCCCCC"> the clip</font>

593
00:29:56,480 --> 00:30:01,190
were not not for you to find any

594
00:29:58,580 --> 00:30:03,379
interesting<font color="#E5E5E5"> garbage in it for whatever</font>

595
00:30:01,190 --> 00:30:07,010
reason<font color="#CCCCCC"> so</font><font color="#E5E5E5"> let's go to the first part</font>

596
00:30:03,380 --> 00:30:12,830
back again this is the office<font color="#CCCCCC"> fitted</font>

597
00:30:07,010 --> 00:30:14,600
code<font color="#E5E5E5"> if we add some new lines the code</font>

598
00:30:12,830 --> 00:30:16,310
will look<font color="#E5E5E5"> something like this it now</font>

599
00:30:14,600 --> 00:30:18,679
starts<font color="#CCCCCC"> to make some sense you can see</font>

600
00:30:16,310 --> 00:30:22,010
some strings now we can see some<font color="#E5E5E5"> coding</font>

601
00:30:18,680 --> 00:30:23,929
over<font color="#E5E5E5"> here</font><font color="#CCCCCC"> new object you can</font><font color="#E5E5E5"> see bitmap</font>

602
00:30:22,010 --> 00:30:26,570
you can see<font color="#E5E5E5"> those</font>

603
00:30:23,929 --> 00:30:31,100
that we previously talked about we can

604
00:30:26,570 --> 00:30:32,960
see a<font color="#CCCCCC"> furlough</font><font color="#E5E5E5"> we can see even invoke</font>

605
00:30:31,100 --> 00:30:36,529
expression over here<font color="#CCCCCC"> the shorthand</font>

606
00:30:32,960 --> 00:30:38,870
notation<font color="#CCCCCC"> but it's</font><font color="#E5E5E5"> pretty messed up you</font>

607
00:30:36,529 --> 00:30:40,539
can't understand the logic of<font color="#E5E5E5"> this code</font>

608
00:30:38,870 --> 00:30:43,158
[Music]

609
00:30:40,539 --> 00:30:46,269
<font color="#E5E5E5">if you do office Kate it's a bit more</font>

610
00:30:43,159 --> 00:30:48,950
<font color="#CCCCCC">you'll end up</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> a pretty nice</font>

611
00:30:46,269 --> 00:30:50,690
<font color="#CCCCCC">powershell script over here and you can</font>

612
00:30:48,950 --> 00:30:53,450
<font color="#E5E5E5">now understand what what it's doing</font>

613
00:30:50,690 --> 00:30:56,749
under the hood<font color="#CCCCCC"> so it's downloading the</font>

614
00:30:53,450 --> 00:31:00,919
contents of this PNG file into an object

615
00:30:56,749 --> 00:31:05,649
<font color="#E5E5E5">of type bitmap</font><font color="#CCCCCC"> it then</font><font color="#E5E5E5"> creates a buffer</font>

616
00:31:00,919 --> 00:31:08,779
over here of<font color="#CCCCCC"> 428 bytes</font>

617
00:31:05,649 --> 00:31:10,969
using<font color="#CCCCCC"> the for for loop it iterates</font>

618
00:31:08,779 --> 00:31:14,389
through the first<font color="#E5E5E5"> column of that PNG</font>

619
00:31:10,970 --> 00:31:17,330
file applies a mathematical operation<font color="#E5E5E5"> on</font>

620
00:31:14,389 --> 00:31:19,699
them and decode some data out<font color="#CCCCCC"> of those</font>

621
00:31:17,330 --> 00:31:23,629
pixels<font color="#CCCCCC"> so this is basically</font><font color="#E5E5E5"> second</font>

622
00:31:19,700 --> 00:31:28,929
ography by abetting<font color="#E5E5E5"> information into an</font>

623
00:31:23,629 --> 00:31:32,149
image so the map of<font color="#E5E5E5"> this example is</font>

624
00:31:28,929 --> 00:31:34,879
quite<font color="#E5E5E5"> simple I</font><font color="#CCCCCC"> would say</font><font color="#E5E5E5"> you take the</font>

625
00:31:32,149 --> 00:31:37,518
blue pixel<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it with 15 the result of</font>

626
00:31:34,879 --> 00:31:40,850
this is being<font color="#E5E5E5"> multiplied with 16 the</font>

627
00:31:37,519 --> 00:31:43,759
green pixel it ended with 15<font color="#E5E5E5"> and result</font>

628
00:31:40,850 --> 00:31:48,408
of this<font color="#E5E5E5"> it's being worked with the</font>

629
00:31:43,759 --> 00:31:51,549
previous with the previous mathematical

630
00:31:48,409 --> 00:31:55,129
operation and then all of this is<font color="#E5E5E5"> being</font>

631
00:31:51,549 --> 00:31:58,100
assigned to to this output buffer over

632
00:31:55,129 --> 00:32:02,990
here after<font color="#CCCCCC"> that</font><font color="#E5E5E5"> this buffer is being</font>

633
00:31:58,100 --> 00:32:05,840
converted to<font color="#E5E5E5"> a string and then is being</font>

634
00:32:02,990 --> 00:32:08,809
executed<font color="#E5E5E5"> by invoking expression so</font><font color="#CCCCCC"> if I</font>

635
00:32:05,840 --> 00:32:11,959
now<font color="#E5E5E5"> expect that I'll have another power</font>

636
00:32:08,809 --> 00:32:16,908
<font color="#E5E5E5">source code that will be executed by by</font>

637
00:32:11,960 --> 00:32:20,909
<font color="#E5E5E5">our mother so let's look at that as well</font>

638
00:32:16,909 --> 00:32:24,629
<font color="#E5E5E5">this is the last power</font><font color="#CCCCCC"> shell that</font>

639
00:32:20,909 --> 00:32:27,739
was in this<font color="#E5E5E5"> infection routine or chain</font>

640
00:32:24,629 --> 00:32:32,119
<font color="#CCCCCC">call it what</font><font color="#E5E5E5"> you may like we see up top</font>

641
00:32:27,739 --> 00:32:34,200
<font color="#E5E5E5">URL to IP for that</font><font color="#CCCCCC"> I useless JSON</font>

642
00:32:32,119 --> 00:32:36,869
downloading the contents of<font color="#E5E5E5"> that file</font>

643
00:32:34,200 --> 00:32:39,419
<font color="#CCCCCC">we'll end up with the</font><font color="#E5E5E5"> JSON that splits</font>

644
00:32:36,869 --> 00:32:42,199
out<font color="#E5E5E5"> spits out</font><font color="#CCCCCC"> information about</font><font color="#E5E5E5"> your IP</font>

645
00:32:39,419 --> 00:32:46,889
address<font color="#E5E5E5"> including your country over here</font>

646
00:32:42,200 --> 00:32:49,349
so we see an if statement and<font color="#E5E5E5"> it checks</font>

647
00:32:46,889 --> 00:32:51,658
whether it if you are from Italy<font color="#E5E5E5"> if</font>

648
00:32:49,349 --> 00:32:55,609
you're not<font color="#E5E5E5"> from Italy you're safe so</font>

649
00:32:51,659 --> 00:32:59,940
it's good<font color="#CCCCCC"> if you're from Italy</font><font color="#E5E5E5"> then</font>

650
00:32:55,609 --> 00:33:05,070
downloads<font color="#CCCCCC"> another field over</font><font color="#E5E5E5"> here using</font>

651
00:32:59,940 --> 00:33:07,259
the download<font color="#E5E5E5"> file method saves it depend</font>

652
00:33:05,070 --> 00:33:12,139
on<font color="#E5E5E5"> app ain't got your exe and</font><font color="#CCCCCC"> there</font>

653
00:33:07,259 --> 00:33:15,659
starts<font color="#CCCCCC"> process at this</font><font color="#E5E5E5"> point I see</font><font color="#CCCCCC"> okay</font>

654
00:33:12,139 --> 00:33:18,178
someone went through<font color="#E5E5E5"> the hassle of doing</font>

655
00:33:15,659 --> 00:33:20,099
steganography and hiding its code<font color="#E5E5E5"> as</font>

656
00:33:18,179 --> 00:33:23,099
much as he can<font color="#E5E5E5"> and</font><font color="#CCCCCC"> doing some</font>

657
00:33:20,099 --> 00:33:25,678
interesting things<font color="#E5E5E5"> over here but in the</font>

658
00:33:23,099 --> 00:33:27,960
end<font color="#E5E5E5"> it</font><font color="#CCCCCC"> downs of downloads a</font><font color="#E5E5E5"> PE file and</font>

659
00:33:25,679 --> 00:33:31,590
write to the disk<font color="#E5E5E5"> why do you do that</font><font color="#CCCCCC"> I</font>

660
00:33:27,960 --> 00:33:33,509
don't<font color="#CCCCCC"> know but I think this is</font><font color="#E5E5E5"> a this</font><font color="#CCCCCC"> is</font>

661
00:33:31,590 --> 00:33:37,590
some sort of mosquito mistake that they

662
00:33:33,509 --> 00:33:42,570
that they didn't<font color="#E5E5E5"> realize about that and</font>

663
00:33:37,590 --> 00:33:45,029
that's it I'm gonna handle the rest of

664
00:33:42,570 --> 00:33:50,869
<font color="#E5E5E5">the presentation back to Mario's</font><font color="#CCCCCC"> oh I</font>

665
00:33:45,029 --> 00:33:54,179
forgot<font color="#CCCCCC"> about this slide yeah this is the</font>

666
00:33:50,869 --> 00:33:56,939
results of<font color="#CCCCCC"> Devi engines on virustotal</font>

667
00:33:54,179 --> 00:34:03,149
regarding that paint

668
00:33:56,940 --> 00:34:04,979
<font color="#CCCCCC">PFL over here</font><font color="#E5E5E5"> it had six detections when</font>

669
00:34:03,149 --> 00:34:06,619
it was<font color="#E5E5E5"> first seen and then it rose to</font>

670
00:34:04,979 --> 00:34:11,210
<font color="#CCCCCC">almost 40</font>

671
00:34:06,619 --> 00:34:14,520
so please Marcus<font color="#E5E5E5"> thank you man</font>

672
00:34:11,210 --> 00:34:15,780
yeah so about<font color="#E5E5E5"> this last example funny</font>

673
00:34:14,520 --> 00:34:17,429
it's<font color="#E5E5E5"> not funny</font>

674
00:34:15,780 --> 00:34:19,650
the thing is<font color="#E5E5E5"> that when we first thought</font>

675
00:34:17,429 --> 00:34:22,440
<font color="#E5E5E5">is about two months ago</font><font color="#CCCCCC"> it was targeting</font>

676
00:34:19,650 --> 00:34:23,520
Italy<font color="#CCCCCC"> we've seen it like a month ago</font>

677
00:34:22,440 --> 00:34:26,850
there was another wave<font color="#CCCCCC"> that was</font>

678
00:34:23,520 --> 00:34:28,830
targeting Japan<font color="#CCCCCC"> and then like a week</font><font color="#E5E5E5"> ago</font>

679
00:34:26,850 --> 00:34:31,469
we found another wave that<font color="#CCCCCC"> was targeting</font>

680
00:34:28,830 --> 00:34:34,679
China so<font color="#CCCCCC"> they target countries I don't</font>

681
00:34:31,469 --> 00:34:37,409
know<font color="#E5E5E5"> one at a time probably</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> yeah</font>

682
00:34:34,679 --> 00:34:38,850
that's interesting<font color="#CCCCCC"> okay so after</font><font color="#E5E5E5"> I get</font>

683
00:34:37,409 --> 00:34:40,739
<font color="#E5E5E5">the</font><font color="#CCCCCC"> report from from my colleague over</font>

684
00:34:38,850 --> 00:34:42,810
<font color="#E5E5E5">here we basically have to write</font>

685
00:34:40,739 --> 00:34:45,000
detection rules<font color="#E5E5E5"> we need</font><font color="#CCCCCC"> to as I told you</font>

686
00:34:42,810 --> 00:34:46,290
the beginning<font color="#E5E5E5"> I know if you remember we</font>

687
00:34:45,000 --> 00:34:47,940
<font color="#CCCCCC">need to find</font><font color="#E5E5E5"> the kill chain as soon as</font>

688
00:34:46,290 --> 00:34:49,830
possible in the in the life of an

689
00:34:47,940 --> 00:34:51,929
infection right<font color="#E5E5E5"> so even</font><font color="#CCCCCC"> if we kill</font><font color="#E5E5E5"> it</font>

690
00:34:49,830 --> 00:34:53,279
<font color="#E5E5E5">like at the last stage it's okay but it</font>

691
00:34:51,929 --> 00:34:56,549
would be a lot better<font color="#CCCCCC"> if you could kill</font>

692
00:34:53,280 --> 00:34:59,370
<font color="#E5E5E5">it later on in the life of the life of</font>

693
00:34:56,550 --> 00:35:01,110
the infection so what I do is I

694
00:34:59,370 --> 00:35:03,960
basically write some detections<font color="#E5E5E5"> some</font>

695
00:35:01,110 --> 00:35:05,790
detection rules by using multiple

696
00:35:03,960 --> 00:35:08,070
technologies that we have<font color="#E5E5E5"> available</font><font color="#CCCCCC"> and</font>

697
00:35:05,790 --> 00:35:09,420
<font color="#CCCCCC">the product these are strictly related</font>

698
00:35:08,070 --> 00:35:11,010
<font color="#E5E5E5">to the product</font><font color="#CCCCCC"> I'm not gonna go into</font>

699
00:35:09,420 --> 00:35:12,750
details<font color="#E5E5E5"> I'm just enumerated some like</font>

700
00:35:11,010 --> 00:35:14,340
<font color="#CCCCCC">caustic analysis process injection</font>

701
00:35:12,750 --> 00:35:16,740
<font color="#E5E5E5">remote procedure calls process freeze</font>

702
00:35:14,340 --> 00:35:20,040
control<font color="#E5E5E5"> there's a lot of them that we</font>

703
00:35:16,740 --> 00:35:21,930
can<font color="#CCCCCC"> use to to write detection</font><font color="#E5E5E5"> so what I</font>

704
00:35:20,040 --> 00:35:24,690
<font color="#E5E5E5">did is I got a report</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> my colleague</font>

705
00:35:21,930 --> 00:35:26,339
over<font color="#E5E5E5"> here and</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> using some of those</font>

706
00:35:24,690 --> 00:35:27,930
technologies<font color="#E5E5E5"> we wrote like three</font>

707
00:35:26,340 --> 00:35:30,330
detections for each and one of them so

708
00:35:27,930 --> 00:35:32,460
for the first<font color="#CCCCCC"> two use for example one</font>

709
00:35:30,330 --> 00:35:34,049
<font color="#CCCCCC">and three we used Iowa s</font><font color="#E5E5E5"> Iowa is we call</font>

710
00:35:32,460 --> 00:35:37,860
them indicators of attack

711
00:35:34,050 --> 00:35:39,810
they're basically<font color="#E5E5E5"> indicators of some</font>

712
00:35:37,860 --> 00:35:41,640
things<font color="#E5E5E5"> that happened</font><font color="#CCCCCC"> during</font><font color="#E5E5E5"> that</font>

713
00:35:39,810 --> 00:35:42,810
infection<font color="#CCCCCC"> didn't into that process it</font>

714
00:35:41,640 --> 00:35:44,190
could be a command line it could<font color="#E5E5E5"> be a</font>

715
00:35:42,810 --> 00:35:47,549
process injection it could be multiple

716
00:35:44,190 --> 00:35:50,180
<font color="#CCCCCC">things right for the second example we</font>

717
00:35:47,550 --> 00:35:52,890
only<font color="#CCCCCC"> use inflection in injection Flags</font>

718
00:35:50,180 --> 00:35:54,149
process injection flags and we got

719
00:35:52,890 --> 00:36:03,210
<font color="#E5E5E5">actually pretty good results with those</font>

720
00:35:54,150 --> 00:36:05,610
those detection so we saw malware but

721
00:36:03,210 --> 00:36:08,100
we're also<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> see like legitimate</font>

722
00:36:05,610 --> 00:36:09,450
stuff that shouldn't<font color="#E5E5E5"> happen right so</font><font color="#CCCCCC"> I</font>

723
00:36:08,100 --> 00:36:11,370
<font color="#CCCCCC">have a</font><font color="#E5E5E5"> saying</font><font color="#CCCCCC"> just because</font><font color="#E5E5E5"> you can</font>

724
00:36:09,450 --> 00:36:12,930
<font color="#E5E5E5">doesn't mean you should</font><font color="#CCCCCC"> just because you</font>

725
00:36:11,370 --> 00:36:16,500
can<font color="#E5E5E5"> use crazy powershell one-liner</font>

726
00:36:12,930 --> 00:36:19,589
encoded downloading stuff using crazy

727
00:36:16,500 --> 00:36:20,850
<font color="#CCCCCC">api is crazy functions</font><font color="#E5E5E5"> doesn't mean you</font>

728
00:36:19,590 --> 00:36:24,060
<font color="#CCCCCC">actually should</font><font color="#E5E5E5"> because it creates</font>

729
00:36:20,850 --> 00:36:25,680
<font color="#CCCCCC">basically a door to your breach to your</font>

730
00:36:24,060 --> 00:36:28,500
<font color="#E5E5E5">security right and there's a lot of</font>

731
00:36:25,680 --> 00:36:30,180
<font color="#E5E5E5">people who do I mean this is their way</font>

732
00:36:28,500 --> 00:36:32,760
of<font color="#CCCCCC"> doing things</font><font color="#E5E5E5"> it's pretty</font><font color="#CCCCCC"> hard to</font>

733
00:36:30,180 --> 00:36:34,109
<font color="#E5E5E5">change this mentality but as an industry</font>

734
00:36:32,760 --> 00:36:40,040
standard<font color="#E5E5E5"> is the best practice</font><font color="#CCCCCC"> you</font>

735
00:36:34,110 --> 00:36:44,790
shouldn't do write a custom<font color="#E5E5E5"> win logon</font>

736
00:36:40,040 --> 00:36:47,759
into program data and then run it<font color="#E5E5E5"> under</font>

737
00:36:44,790 --> 00:36:50,400
<font color="#E5E5E5">SVC host and then spawn another win log</font>

738
00:36:47,760 --> 00:36:51,960
on<font color="#E5E5E5"> from there right so but again this</font>

739
00:36:50,400 --> 00:36:54,150
was something<font color="#CCCCCC"> custom-made for them it</font>

740
00:36:51,960 --> 00:36:56,730
worked in their environment<font color="#E5E5E5"> we were</font>

741
00:36:54,150 --> 00:37:00,060
looking<font color="#E5E5E5"> and said okay it's good that you</font>

742
00:36:56,730 --> 00:37:04,320
do this but maybe<font color="#E5E5E5"> you shouldn't but</font>

743
00:37:00,060 --> 00:37:05,549
after all it's clean right<font color="#E5E5E5"> this is</font>

744
00:37:04,320 --> 00:37:07,710
another one that<font color="#E5E5E5"> was actually really</font>

745
00:37:05,550 --> 00:37:09,710
<font color="#CCCCCC">interesting if you take a look over</font><font color="#E5E5E5"> here</font>

746
00:37:07,710 --> 00:37:12,090
<font color="#CCCCCC">this is</font><font color="#E5E5E5"> your typical this</font><font color="#CCCCCC"> is again of</font>

747
00:37:09,710 --> 00:37:14,370
<font color="#CCCCCC">screenshot from Falcon</font><font color="#E5E5E5"> UI this is your</font>

748
00:37:12,090 --> 00:37:16,020
typical fishing<font color="#E5E5E5"> tree right so you</font>

749
00:37:14,370 --> 00:37:19,560
receive an email right it's some

750
00:37:16,020 --> 00:37:22,710
attachment<font color="#E5E5E5"> win document that has some</font><font color="#CCCCCC"> VB</font>

751
00:37:19,560 --> 00:37:24,120
a script<font color="#E5E5E5"> with it that launches some</font>

752
00:37:22,710 --> 00:37:26,910
<font color="#E5E5E5">PowerShell command line right so this is</font>

753
00:37:24,120 --> 00:37:29,400
<font color="#CCCCCC">your typical</font><font color="#E5E5E5"> fishing tree that you see</font>

754
00:37:26,910 --> 00:37:31,620
on a<font color="#CCCCCC"> daily basis if you</font><font color="#E5E5E5"> download an</font>

755
00:37:29,400 --> 00:37:34,140
email from<font color="#E5E5E5"> VT today now you'll find this</font>

756
00:37:31,620 --> 00:37:37,230
fishing tree<font color="#E5E5E5"> but this was also a</font>

757
00:37:34,140 --> 00:37:39,150
legitimate<font color="#E5E5E5"> thing they did this in their</font>

758
00:37:37,230 --> 00:37:43,050
network in<font color="#E5E5E5"> their environment this is the</font>

759
00:37:39,150 --> 00:37:44,940
way that<font color="#E5E5E5"> they did things so we can't</font>

760
00:37:43,050 --> 00:37:45,930
<font color="#E5E5E5">just go</font><font color="#CCCCCC"> ahead and block everything</font><font color="#E5E5E5"> and</font>

761
00:37:44,940 --> 00:37:48,510
hope<font color="#E5E5E5"> for</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> best</font>

762
00:37:45,930 --> 00:37:50,310
that's not the solution<font color="#CCCCCC"> we need to</font>

763
00:37:48,510 --> 00:37:51,990
distinguish the bad from<font color="#E5E5E5"> the good the</font>

764
00:37:50,310 --> 00:37:53,520
<font color="#CCCCCC">thing the good</font><font color="#E5E5E5"> thing is that we managed</font>

765
00:37:51,990 --> 00:37:57,180
<font color="#E5E5E5">to distinguish the bat from the good so</font>

766
00:37:53,520 --> 00:37:59,460
we were<font color="#CCCCCC"> able to fix this</font><font color="#E5E5E5"> another one</font>

767
00:37:57,180 --> 00:38:02,490
<font color="#E5E5E5">that I</font><font color="#CCCCCC"> like very much is this one over</font>

768
00:37:59,460 --> 00:38:05,010
here<font color="#E5E5E5"> again</font><font color="#CCCCCC"> your typical</font><font color="#E5E5E5"> fishing tree you</font>

769
00:38:02,490 --> 00:38:07,049
receive an email<font color="#CCCCCC"> have an</font><font color="#E5E5E5"> URL there you</font>

770
00:38:05,010 --> 00:38:08,730
link<font color="#E5E5E5"> or you click on your URL</font><font color="#CCCCCC"> chrome</font>

771
00:38:07,050 --> 00:38:09,090
opens up you download the file that<font color="#E5E5E5"> has</font>

772
00:38:08,730 --> 00:38:11,820
<font color="#E5E5E5">this</font>

773
00:38:09,090 --> 00:38:16,890
extension right<font color="#E5E5E5"> here PDF dot zip</font><font color="#CCCCCC"> Tod exe</font>

774
00:38:11,820 --> 00:38:18,390
<font color="#E5E5E5">which is yeah which is PDF that zip dot</font>

775
00:38:16,890 --> 00:38:21,240
exe<font color="#E5E5E5"> but again this was something</font>

776
00:38:18,390 --> 00:38:22,980
<font color="#E5E5E5">legitimate they I mean they were</font><font color="#CCCCCC"> doing</font>

777
00:38:21,240 --> 00:38:25,470
they were using<font color="#CCCCCC"> some</font><font color="#E5E5E5"> kind of encryption</font>

778
00:38:22,980 --> 00:38:26,880
software<font color="#E5E5E5"> that they used on files so they</font>

779
00:38:25,470 --> 00:38:29,640
send files encrypted over the network

780
00:38:26,880 --> 00:38:30,780
<font color="#E5E5E5">via email to each other so they when</font>

781
00:38:29,640 --> 00:38:33,420
they typed in the password<font color="#CCCCCC"> they could</font>

782
00:38:30,780 --> 00:38:39,200
decrypt the file and look at the content

783
00:38:33,420 --> 00:38:42,540
of it<font color="#CCCCCC"> right</font><font color="#E5E5E5"> so again I have to mention</font>

784
00:38:39,200 --> 00:38:44,009
<font color="#CCCCCC">we can't go and</font><font color="#E5E5E5"> block everything right</font>

785
00:38:42,540 --> 00:38:46,230
<font color="#E5E5E5">because there are people who do this</font>

786
00:38:44,010 --> 00:38:48,300
like<font color="#E5E5E5"> this is normal business business as</font>

787
00:38:46,230 --> 00:38:50,940
usual<font color="#CCCCCC"> for</font><font color="#E5E5E5"> them even if it's abused my</font>

788
00:38:48,300 --> 00:38:52,440
attackers even if it's used by Malory it

789
00:38:50,940 --> 00:38:57,180
not doesn't necessarily mean it's it's

790
00:38:52,440 --> 00:39:01,050
malicious<font color="#E5E5E5"> in certain scenarios</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so as</font>

791
00:38:57,180 --> 00:39:01,980
some closing remarks<font color="#CCCCCC"> we've seen that I</font>

792
00:39:01,050 --> 00:39:04,560
mean at least<font color="#E5E5E5"> I've seen that</font>

793
00:39:01,980 --> 00:39:07,200
productivity<font color="#CCCCCC"> is still a big thing in the</font>

794
00:39:04,560 --> 00:39:09,000
wild<font color="#E5E5E5"> and</font><font color="#CCCCCC"> their uses initial infection</font>

795
00:39:07,200 --> 00:39:15,140
vectors why because it's really<font color="#CCCCCC"> easy to</font>

796
00:39:09,000 --> 00:39:18,600
<font color="#E5E5E5">to bypass a spam email solution by just</font>

797
00:39:15,140 --> 00:39:20,220
attaching a document right<font color="#E5E5E5"> and then that</font>

798
00:39:18,600 --> 00:39:22,400
document does some crazy<font color="#E5E5E5"> stuff and to</font>

799
00:39:20,220 --> 00:39:26,970
<font color="#E5E5E5">come some crazy stuff and then you get</font>

800
00:39:22,400 --> 00:39:28,350
<font color="#E5E5E5">access to or to someone's network</font><font color="#CCCCCC"> quirky</font>

801
00:39:26,970 --> 00:39:32,279
infection techniques are seen<font color="#CCCCCC"> more and</font>

802
00:39:28,350 --> 00:39:34,140
<font color="#CCCCCC">more often</font><font color="#E5E5E5"> attackers use</font><font color="#CCCCCC"> Windows</font>

803
00:39:32,280 --> 00:39:36,630
legitimate binaries<font color="#E5E5E5"> as you've seen they</font>

804
00:39:34,140 --> 00:39:38,910
use<font color="#E5E5E5"> msi exact they renamed it they use</font>

805
00:39:36,630 --> 00:39:40,740
<font color="#CCCCCC">WM i which</font><font color="#E5E5E5"> is again legitimate and used</font>

806
00:39:38,910 --> 00:39:45,089
by a lot of<font color="#E5E5E5"> a lot of system</font>

807
00:39:40,740 --> 00:39:46,560
administrators again<font color="#E5E5E5"> we can't just</font>

808
00:39:45,090 --> 00:39:50,070
blacklist<font color="#E5E5E5"> and hope for</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> best</font><font color="#CCCCCC"> right</font>

809
00:39:46,560 --> 00:39:52,770
<font color="#E5E5E5">and as my colleague said adversaries do</font>

810
00:39:50,070 --> 00:39:55,890
try to<font color="#CCCCCC"> migrate to fireless infections</font>

811
00:39:52,770 --> 00:39:59,600
but at some point<font color="#E5E5E5"> in this infection they</font>

812
00:39:55,890 --> 00:40:03,540
they do drop some files on disk<font color="#CCCCCC"> so</font>

813
00:39:59,600 --> 00:40:05,490
<font color="#CCCCCC">that's it for us</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> we have</font><font color="#CCCCCC"> five</font>

814
00:40:03,540 --> 00:40:08,480
<font color="#E5E5E5">minutes more for questions</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> we're</font>

815
00:40:05,490 --> 00:40:08,479
out of<font color="#E5E5E5"> time</font>

816
00:40:10,080 --> 00:40:15,609
[Music]

817
00:40:12,609 --> 00:40:15,609
just

818
00:40:16,920 --> 00:40:26,820
anyone here in<font color="#E5E5E5"> the earth until that</font>

819
00:40:19,230 --> 00:40:29,390
there's yep and then the second row

820
00:40:26,820 --> 00:40:29,390
there right

821
00:40:35,060 --> 00:40:38,430
first of all thank you for<font color="#CCCCCC"> the</font>

822
00:40:36,900 --> 00:40:41,850
<font color="#E5E5E5">presentation it was great</font>

823
00:40:38,430 --> 00:40:44,730
I was just wondering<font color="#CCCCCC"> because of the many</font>

824
00:40:41,850 --> 00:40:47,790
<font color="#E5E5E5">bad pieces of code that are written for</font>

825
00:40:44,730 --> 00:40:50,220
legitimate purposes<font color="#CCCCCC"> how do you</font><font color="#E5E5E5"> decide</font>

826
00:40:47,790 --> 00:40:52,440
how soon they decide<font color="#CCCCCC"> that you're on a</font>

827
00:40:50,220 --> 00:40:54,990
false-positive track<font color="#E5E5E5"> and that you should</font>

828
00:40:52,440 --> 00:40:58,800
give up or<font color="#E5E5E5"> you just keep on</font>

829
00:40:54,990 --> 00:41:04,200
investigating until<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> 100%</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> just</font>

830
00:40:58,800 --> 00:41:05,820
bad code or bad practice well<font color="#E5E5E5"> it's kind</font>

831
00:41:04,200 --> 00:41:10,020
of<font color="#E5E5E5"> hard because our product that doesn't</font>

832
00:41:05,820 --> 00:41:12,000
<font color="#E5E5E5">send data into the cloud it only sends</font>

833
00:41:10,020 --> 00:41:13,470
metadata<font color="#CCCCCC"> so when you have a file like</font>

834
00:41:12,000 --> 00:41:15,450
the last one that<font color="#E5E5E5"> I showed</font><font color="#CCCCCC"> you like</font><font color="#E5E5E5"> this</font>

835
00:41:13,470 --> 00:41:17,939
one<font color="#E5E5E5"> over here it's pretty hard to decide</font>

836
00:41:15,450 --> 00:41:20,339
but<font color="#CCCCCC"> this one was actually kind of easy</font>

837
00:41:17,940 --> 00:41:22,380
<font color="#E5E5E5">because we saw it was lying there on a</font>

838
00:41:20,340 --> 00:41:25,380
shared<font color="#CCCCCC"> drive you know in some</font><font color="#E5E5E5"> network</font><font color="#CCCCCC"> on</font>

839
00:41:22,380 --> 00:41:29,340
the network and we said<font color="#E5E5E5"> okay this</font><font color="#CCCCCC"> might</font>

840
00:41:25,380 --> 00:41:33,359
be this might be<font color="#CCCCCC"> legitimate but</font><font color="#E5E5E5"> you need</font>

841
00:41:29,340 --> 00:41:35,430
more information<font color="#CCCCCC"> yes yes yes</font>

842
00:41:33,359 --> 00:41:36,600
usually they contact<font color="#E5E5E5"> us when they see</font>

843
00:41:35,430 --> 00:41:38,339
<font color="#E5E5E5">something like this like a false</font>

844
00:41:36,600 --> 00:41:39,900
positive<font color="#CCCCCC"> and then they say</font><font color="#E5E5E5"> okay this is</font>

845
00:41:38,340 --> 00:41:55,460
false positive so you<font color="#CCCCCC"> have to</font><font color="#E5E5E5"> fix it</font>

846
00:41:39,900 --> 00:41:58,800
okay thank<font color="#CCCCCC"> you so I have two questions</font>

847
00:41:55,460 --> 00:42:02,130
<font color="#CCCCCC">the</font><font color="#E5E5E5"> first one is do</font><font color="#CCCCCC"> you do any file</font>

848
00:41:58,800 --> 00:42:04,020
based detection<font color="#CCCCCC"> soar just behavior based</font>

849
00:42:02,130 --> 00:42:06,330
<font color="#E5E5E5">I mean just like an</font><font color="#CCCCCC"> anti-virus or just</font>

850
00:42:04,020 --> 00:42:09,090
based on behavior<font color="#CCCCCC"> oh the sensor</font><font color="#E5E5E5"> has two</font>

851
00:42:06,330 --> 00:42:11,910
components<font color="#E5E5E5"> it has</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> AV component which</font>

852
00:42:09,090 --> 00:42:14,250
is<font color="#CCCCCC"> only machine learning</font><font color="#E5E5E5"> based and looks</font>

853
00:42:11,910 --> 00:42:16,319
at P files<font color="#E5E5E5"> and then there is the</font>

854
00:42:14,250 --> 00:42:20,460
behavioral<font color="#CCCCCC"> component so we also look at</font>

855
00:42:16,320 --> 00:42:23,369
static statically at files<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> and the</font>

856
00:42:20,460 --> 00:42:24,869
second question<font color="#E5E5E5"> is when</font><font color="#CCCCCC"> you see all the</font>

857
00:42:23,369 --> 00:42:27,900
<font color="#E5E5E5">t's like these in your customer</font>

858
00:42:24,869 --> 00:42:31,619
environment<font color="#E5E5E5"> it's actually two questions</font>

859
00:42:27,900 --> 00:42:33,930
<font color="#CCCCCC">do you</font><font color="#E5E5E5"> do you do you make suggestions</font>

860
00:42:31,619 --> 00:42:35,910
<font color="#E5E5E5">that they shouldn't be</font><font color="#CCCCCC"> using these types</font>

861
00:42:33,930 --> 00:42:38,700
of yes I<font color="#E5E5E5"> mean I mean I assume they</font>

862
00:42:35,910 --> 00:42:40,109
trigger a lot of alarms<font color="#E5E5E5"> in your yes we</font>

863
00:42:38,700 --> 00:42:41,700
do that there<font color="#E5E5E5"> are actually some sales</font>

864
00:42:40,109 --> 00:42:43,500
engineers that<font color="#E5E5E5"> take care of those</font>

865
00:42:41,700 --> 00:42:45,960
customers<font color="#E5E5E5"> and we</font><font color="#CCCCCC"> form that hey they got</font>

866
00:42:43,500 --> 00:42:47,370
this maybe you should talk them<font color="#E5E5E5"> into</font>

867
00:42:45,960 --> 00:42:50,520
changing<font color="#E5E5E5"> this</font>

868
00:42:47,370 --> 00:42:52,710
they don't always do it<font color="#E5E5E5"> but</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> try</font>

869
00:42:50,520 --> 00:42:55,050
<font color="#E5E5E5">the second thing is I wanted to know if</font>

870
00:42:52,710 --> 00:42:56,880
you get any pushback on this<font color="#E5E5E5"> this yes I</font>

871
00:42:55,050 --> 00:43:10,970
do this my own<font color="#CCCCCC"> way</font><font color="#E5E5E5"> and I don't care</font>

872
00:42:56,880 --> 00:43:10,970
<font color="#CCCCCC">suggest yes thank you</font><font color="#E5E5E5"> okay</font>

873
00:43:16,250 --> 00:43:24,530
in the first<font color="#E5E5E5"> few slides</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> specifically</font>

874
00:43:19,900 --> 00:43:28,130
discussed about<font color="#E5E5E5"> detection</font><font color="#CCCCCC"> I wonder if he</font>

875
00:43:24,530 --> 00:43:31,730
made some profiling<font color="#CCCCCC"> in order to figure</font>

876
00:43:28,130 --> 00:43:35,770
<font color="#E5E5E5">out whether your model could be could be</font>

877
00:43:31,730 --> 00:43:44,180
<font color="#E5E5E5">applied to real-time detection of larger</font>

878
00:43:35,770 --> 00:43:46,160
throughput<font color="#E5E5E5"> data we do that we do that in</font>

879
00:43:44,180 --> 00:43:48,710
the<font color="#E5E5E5"> cloud</font><font color="#CCCCCC"> there are some plans of doing</font>

880
00:43:46,160 --> 00:43:52,339
that for behaviors<font color="#E5E5E5"> but right now we</font>

881
00:43:48,710 --> 00:43:54,650
<font color="#E5E5E5">don't so we're planning on</font><font color="#CCCCCC"> doing it</font><font color="#E5E5E5"> but</font>

882
00:43:52,339 --> 00:43:56,569
it's not<font color="#E5E5E5"> this model does</font><font color="#CCCCCC"> not this</font><font color="#E5E5E5"> ml</font>

883
00:43:54,650 --> 00:43:58,550
model<font color="#CCCCCC"> it's a different one this</font><font color="#E5E5E5"> one only</font>

884
00:43:56,569 --> 00:44:00,759
I mean<font color="#E5E5E5"> ml model</font><font color="#CCCCCC"> I think I got your</font>

885
00:43:58,550 --> 00:44:04,790
<font color="#E5E5E5">question right if not stop me and see</font>

886
00:44:00,760 --> 00:44:07,550
Europe<font color="#CCCCCC"> so it seems that</font><font color="#E5E5E5"> it has</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> very</font>

887
00:44:04,790 --> 00:44:10,579
good potential for application<font color="#E5E5E5"> to</font>

888
00:44:07,550 --> 00:44:13,339
<font color="#E5E5E5">real-time detection of it is this is all</font>

889
00:44:10,579 --> 00:44:16,790
real time<font color="#CCCCCC"> yeah this is all detection and</font>

890
00:44:13,339 --> 00:44:19,869
<font color="#CCCCCC">prevention real time</font><font color="#E5E5E5"> yeah yeah</font><font color="#CCCCCC"> okay</font>

891
00:44:16,790 --> 00:44:19,869
thanks<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> welcome</font>

892
00:44:19,930 --> 00:44:24,279
[Music]

893
00:44:21,760 --> 00:44:29,320
the middle and will be after that<font color="#E5E5E5"> one</font>

894
00:44:24,280 --> 00:44:31,570
more question<font color="#E5E5E5"> so one final question</font>

895
00:44:29,320 --> 00:44:34,020
after this one here in the<font color="#CCCCCC"> front</font><font color="#E5E5E5"> row</font>

896
00:44:31,570 --> 00:44:38,350
<font color="#E5E5E5">okay thank you</font>

897
00:44:34,020 --> 00:44:40,660
hi<font color="#E5E5E5"> did you saw any campaign or fishing</font>

898
00:44:38,350 --> 00:44:43,299
for example with legitimate the files

899
00:44:40,660 --> 00:44:46,899
<font color="#E5E5E5">only to get you into the wrong</font><font color="#CCCCCC"> direction</font>

900
00:44:43,300 --> 00:44:49,390
or something<font color="#CCCCCC"> like this not sure I</font>

901
00:44:46,900 --> 00:44:52,270
understand so legitimate files that yes

902
00:44:49,390 --> 00:44:54,759
<font color="#CCCCCC">like to send you a</font><font color="#E5E5E5"> fishing to your</font>

903
00:44:52,270 --> 00:44:57,340
clients<font color="#CCCCCC"> fishing emails but actually the</font>

904
00:44:54,760 --> 00:44:59,850
files<font color="#E5E5E5"> inside to be legitimate well there</font>

905
00:44:57,340 --> 00:45:01,900
is a funny thing<font color="#CCCCCC"> and maybe next</font>

906
00:44:59,850 --> 00:45:03,730
following an attack or something<font color="#CCCCCC"> like</font>

907
00:45:01,900 --> 00:45:05,890
this a funny thing<font color="#E5E5E5"> when I worked out of</font>

908
00:45:03,730 --> 00:45:07,300
<font color="#E5E5E5">your funny thing happened there was a</font>

909
00:45:05,890 --> 00:45:10,359
phishing campaign that was<font color="#E5E5E5"> running in a</font>

910
00:45:07,300 --> 00:45:14,280
<font color="#CCCCCC">while and somebody hacked</font><font color="#E5E5E5"> the Packers</font>

911
00:45:10,359 --> 00:45:16,750
<font color="#CCCCCC">situ and instead of delivering malware</font>

912
00:45:14,280 --> 00:45:18,730
<font color="#E5E5E5">there was a jscript the jscript actually</font>

913
00:45:16,750 --> 00:45:20,820
delivered the AV antivirus they have

914
00:45:18,730 --> 00:45:24,100
your antivirus and we were like what

915
00:45:20,820 --> 00:45:26,260
<font color="#CCCCCC">okay that's good</font><font color="#E5E5E5"> and that</font><font color="#CCCCCC"> at that</font><font color="#E5E5E5"> point</font>

916
00:45:24,100 --> 00:45:30,900
<font color="#CCCCCC">that</font><font color="#E5E5E5"> was a pretty good</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> first it</font>

917
00:45:26,260 --> 00:45:30,900
was free marketing free free commercial

918
00:45:32,970 --> 00:45:39,879
hello yes Alec and what do you want<font color="#E5E5E5"> and</font>

919
00:45:37,060 --> 00:45:41,770
for<font color="#E5E5E5"> the non P files for example for</font>

920
00:45:39,880 --> 00:45:46,060
<font color="#E5E5E5">Android and Mac do you have also</font>

921
00:45:41,770 --> 00:45:49,890
<font color="#E5E5E5">behavioral machines to watch over the</font>

922
00:45:46,060 --> 00:45:56,790
<font color="#E5E5E5">for Mac applications and Android also</font>

923
00:45:49,890 --> 00:46:01,680
for<font color="#CCCCCC"> men we also have a</font><font color="#E5E5E5"> ml model</font><font color="#CCCCCC"> for Mac</font>

924
00:45:56,790 --> 00:46:06,190
and we also do behavior for<font color="#CCCCCC"> for Mac</font><font color="#E5E5E5"> also</font>

925
00:46:01,680 --> 00:46:07,270
enter<font color="#E5E5E5"> Android not yet it's probably</font><font color="#CCCCCC"> in</font>

926
00:46:06,190 --> 00:46:09,220
the working<font color="#CCCCCC"> something's</font><font color="#E5E5E5"> gonna be</font>

927
00:46:07,270 --> 00:46:11,280
something real<font color="#E5E5E5"> soon</font><font color="#CCCCCC"> okay thank you</font>

928
00:46:09,220 --> 00:46:14,169
<font color="#E5E5E5">you're welcome</font>

929
00:46:11,280 --> 00:46:16,530
you are and Marcus from CrowdStrike

930
00:46:14,170 --> 00:46:20,379
thank you very much<font color="#CCCCCC"> yes thank you</font><font color="#E5E5E5"> guys</font>

931
00:46:16,530 --> 00:46:20,379
[Applause]

