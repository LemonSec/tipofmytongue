1
00:00:00,000 --> 00:00:07,580
hello everyone<font color="#CCCCCC"> thank you for the kind</font>

2
00:00:03,060 --> 00:00:10,559
introduction<font color="#CCCCCC"> so my presentation today is</font>

3
00:00:07,580 --> 00:00:14,370
named<font color="#CCCCCC"> burping</font><font color="#E5E5E5"> for your cryptography</font>

4
00:00:10,559 --> 00:00:19,880
shield<font color="#CCCCCC"> let's see what that is but at</font>

5
00:00:14,370 --> 00:00:24,840
<font color="#E5E5E5">first a little stuff about me Who</font><font color="#CCCCCC"> am I</font>

6
00:00:19,880 --> 00:00:28,890
<font color="#CCCCCC">I'm not I'm neither root nor</font><font color="#E5E5E5"> GID UID 0</font>

7
00:00:24,840 --> 00:00:31,769
I work as a pen tester at a<font color="#E5E5E5"> toss who</font>

8
00:00:28,890 --> 00:00:34,800
here<font color="#CCCCCC"> knows who a toss is besides a</font>

9
00:00:31,769 --> 00:00:37,680
<font color="#CCCCCC">Silver Sponsor</font><font color="#E5E5E5"> at death camp</font><font color="#CCCCCC"> the next</font>

10
00:00:34,800 --> 00:00:39,718
time you watch the Olympics<font color="#CCCCCC"> watch the</font>

11
00:00:37,680 --> 00:00:43,079
sidelines<font color="#CCCCCC"> or the commercials you will</font>

12
00:00:39,719 --> 00:00:46,559
see<font color="#CCCCCC"> a</font><font color="#E5E5E5"> toss there where a provider for</font>

13
00:00:43,079 --> 00:00:49,170
<font color="#E5E5E5">them</font><font color="#CCCCCC"> I have a Bachelor of engineering at</font>

14
00:00:46,559 --> 00:00:51,539
the<font color="#E5E5E5"> Polytechnic University a</font><font color="#CCCCCC"> master's of</font>

15
00:00:49,170 --> 00:00:54,960
<font color="#CCCCCC">engineering and the</font><font color="#E5E5E5"> master of Sciences</font>

16
00:00:51,539 --> 00:00:57,930
<font color="#CCCCCC">ongoing I'm a member of the Romanian</font>

17
00:00:54,960 --> 00:01:01,500
security team community I'm a previous

18
00:00:57,930 --> 00:01:04,860
speaker<font color="#CCCCCC"> at Def camp</font><font color="#E5E5E5"> last year at wasp</font>

19
00:01:01,500 --> 00:01:08,159
<font color="#E5E5E5">this year I'm</font><font color="#CCCCCC"> a certified ethical hacker</font>

20
00:01:04,860 --> 00:01:10,650
<font color="#E5E5E5">and my main interests are a web app</font>

21
00:01:08,159 --> 00:01:15,000
<font color="#E5E5E5">security infrastructure security</font><font color="#CCCCCC"> and</font>

22
00:01:10,650 --> 00:01:16,830
also<font color="#E5E5E5"> IOT devices and their security you</font>

23
00:01:15,000 --> 00:01:22,500
can contact<font color="#E5E5E5"> me on Twitter that's my</font>

24
00:01:16,830 --> 00:01:27,630
handle<font color="#E5E5E5"> and</font><font color="#CCCCCC"> let's have</font><font color="#E5E5E5"> a quick round of</font>

25
00:01:22,500 --> 00:01:33,320
questions<font color="#E5E5E5"> who here is a developer great</font>

26
00:01:27,630 --> 00:01:35,789
<font color="#E5E5E5">who here is a penetration tester</font><font color="#CCCCCC"> ok so</font>

27
00:01:33,320 --> 00:01:40,699
you're<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> learn a few stuff today</font>

28
00:01:35,790 --> 00:01:43,770
<font color="#E5E5E5">what's burping so as per Wikipedia</font>

29
00:01:40,700 --> 00:01:47,159
<font color="#E5E5E5">burping is the release of gas from the</font>

30
00:01:43,770 --> 00:01:49,770
digestive<font color="#E5E5E5"> tract through the mouth of</font>

31
00:01:47,159 --> 00:01:57,509
<font color="#E5E5E5">course but we're not here to speak about</font>

32
00:01:49,770 --> 00:02:00,658
this<font color="#E5E5E5"> I kid</font><font color="#CCCCCC"> okay burp soot is the</font><font color="#E5E5E5"> leading</font>

33
00:01:57,509 --> 00:02:02,219
software<font color="#E5E5E5"> for web security testing this</font>

34
00:02:00,659 --> 00:02:05,759
actually is a print screen on their

35
00:02:02,219 --> 00:02:10,019
<font color="#E5E5E5">website is that so</font><font color="#CCCCCC"> I don't know whether</font>

36
00:02:05,759 --> 00:02:11,600
we shall see<font color="#CCCCCC"> we're going to talk also</font>

37
00:02:10,020 --> 00:02:15,290
<font color="#E5E5E5">both</font><font color="#CCCCCC"> the thick lines</font>

38
00:02:11,600 --> 00:02:18,670
a little bit<font color="#CCCCCC"> today</font><font color="#E5E5E5"> on the short line</font>

39
00:02:15,290 --> 00:02:21,590
thick lines are a client<font color="#E5E5E5"> server database</font>

40
00:02:18,670 --> 00:02:23,809
type of<font color="#CCCCCC"> setup for the</font><font color="#E5E5E5"> application</font>

41
00:02:21,590 --> 00:02:27,100
architecture where a lot of the

42
00:02:23,810 --> 00:02:29,420
application logic is done on the client

43
00:02:27,100 --> 00:02:34,790
<font color="#E5E5E5">but it also</font><font color="#CCCCCC"> communicates with the server</font>

44
00:02:29,420 --> 00:02:38,089
<font color="#E5E5E5">a little bit</font><font color="#CCCCCC"> okay so what was the</font>

45
00:02:34,790 --> 00:02:42,440
problem<font color="#CCCCCC"> that I encountered</font><font color="#E5E5E5"> that led me</font>

46
00:02:38,090 --> 00:02:43,400
<font color="#E5E5E5">to</font><font color="#CCCCCC"> make this presentation</font><font color="#E5E5E5"> I was on a pen</font>

47
00:02:42,440 --> 00:02:46,270
test assignment

48
00:02:43,400 --> 00:02:50,540
I had a thick client<font color="#E5E5E5"> in</font><font color="#CCCCCC"> front of me I</font>

49
00:02:46,270 --> 00:02:53,990
managed<font color="#E5E5E5"> to set up burp burp is a system</font>

50
00:02:50,540 --> 00:02:56,060
proxy is a proxy<font color="#CCCCCC"> a web proxy actually</font>

51
00:02:53,990 --> 00:02:58,850
<font color="#E5E5E5">and I set it</font><font color="#CCCCCC"> up as a system box in order</font>

52
00:02:56,060 --> 00:03:00,800
<font color="#CCCCCC">to intercept the requests made by</font><font color="#E5E5E5"> the</font>

53
00:02:58,850 --> 00:03:03,850
thick line to the server<font color="#E5E5E5"> to see if</font>

54
00:03:00,800 --> 00:03:07,460
anything funny goes on that application

55
00:03:03,850 --> 00:03:10,760
I finally managed<font color="#CCCCCC"> to</font><font color="#E5E5E5"> intercept the</font>

56
00:03:07,460 --> 00:03:13,700
requests<font color="#CCCCCC"> and what I saw some sub</font>

57
00:03:10,760 --> 00:03:17,470
requests cool<font color="#E5E5E5"> the only problem was that</font>

58
00:03:13,700 --> 00:03:20,959
<font color="#E5E5E5">the data there was complete gibberish</font>

59
00:03:17,470 --> 00:03:24,290
<font color="#E5E5E5">encrypted or encoded stuff I</font><font color="#CCCCCC"> didn't know</font>

60
00:03:20,960 --> 00:03:25,880
at the<font color="#CCCCCC"> time</font><font color="#E5E5E5"> and as a model</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> this</font>

61
00:03:24,290 --> 00:03:30,530
presentation<font color="#E5E5E5"> thick line penetration</font>

62
00:03:25,880 --> 00:03:34,160
tests are always fun<font color="#E5E5E5"> so that's me</font>

63
00:03:30,530 --> 00:03:37,610
I look<font color="#E5E5E5"> like a cuddly bear don't I and I</font>

64
00:03:34,160 --> 00:03:40,220
was stuck the<font color="#E5E5E5"> first step I took was</font>

65
00:03:37,610 --> 00:03:42,020
decompiling<font color="#E5E5E5"> the.net application</font><font color="#CCCCCC"> I'm</font>

66
00:03:40,220 --> 00:03:43,550
warning<font color="#E5E5E5"> you those are not real</font>

67
00:03:42,020 --> 00:03:46,130
screenshots of the application

68
00:03:43,550 --> 00:03:47,510
you wouldn't understand anything anyway

69
00:03:46,130 --> 00:03:51,470
the resolution is horrible

70
00:03:47,510 --> 00:03:54,320
<font color="#E5E5E5">okay so</font><font color="#CCCCCC"> ID compile the application using</font>

71
00:03:51,470 --> 00:03:56,660
dotnet<font color="#CCCCCC"> peek don't know if you</font><font color="#E5E5E5"> know the</font>

72
00:03:54,320 --> 00:03:59,540
software it's a free<font color="#CCCCCC"> dog net the</font>

73
00:03:56,660 --> 00:04:03,980
compiler and assembly browser<font color="#E5E5E5"> made</font><font color="#CCCCCC"> by</font>

74
00:03:59,540 --> 00:04:06,070
the guys that<font color="#E5E5E5"> do all</font><font color="#CCCCCC"> the cool tools out</font>

75
00:04:03,980 --> 00:04:11,000
there<font color="#E5E5E5"> for software programmers like</font>

76
00:04:06,070 --> 00:04:15,019
IntelliJ I think yeah<font color="#E5E5E5"> so I used that to</font>

77
00:04:11,000 --> 00:04:17,120
the compiled application and<font color="#CCCCCC"> yay and</font>

78
00:04:15,020 --> 00:04:20,840
behold I found<font color="#CCCCCC"> the encryption class</font>

79
00:04:17,120 --> 00:04:23,860
method that was<font color="#CCCCCC"> used and I found the</font>

80
00:04:20,839 --> 00:04:25,669
<font color="#E5E5E5">issue here</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> issue that I</font><font color="#CCCCCC"> would like</font><font color="#E5E5E5"> to</font>

81
00:04:23,860 --> 00:04:27,170
tell you<font color="#E5E5E5"> about</font>

82
00:04:25,670 --> 00:04:30,200
why it's never<font color="#E5E5E5"> a good idea to you</font>

83
00:04:27,170 --> 00:04:32,690
implement<font color="#E5E5E5"> your own crypto or if you do</font>

84
00:04:30,200 --> 00:04:36,200
do<font color="#E5E5E5"> it the proper way</font>

85
00:04:32,690 --> 00:04:39,290
the developer of the application managed

86
00:04:36,200 --> 00:04:45,229
<font color="#E5E5E5">to</font><font color="#CCCCCC"> hard-code</font><font color="#E5E5E5"> the IV in the client the</font>

87
00:04:39,290 --> 00:04:48,800
injection vector<font color="#CCCCCC"> I for the first thing I</font>

88
00:04:45,230 --> 00:04:52,760
discovered<font color="#E5E5E5"> it was using is to</font><font color="#CCCCCC"> fill 256</font>

89
00:04:48,800 --> 00:04:55,850
<font color="#E5E5E5">and create encryption and the developer</font>

90
00:04:52,760 --> 00:04:59,480
managed to have<font color="#CCCCCC"> the</font><font color="#E5E5E5"> IV not a real</font>

91
00:04:55,850 --> 00:05:03,620
spaceship to have the IV hard-coded<font color="#E5E5E5"> and</font>

92
00:04:59,480 --> 00:05:09,460
the key the key<font color="#E5E5E5"> generation method was</font>

93
00:05:03,620 --> 00:05:11,210
also<font color="#CCCCCC"> there</font><font color="#E5E5E5"> on the</font><font color="#CCCCCC"> time the thing i did</font><font color="#E5E5E5"> i</font>

94
00:05:09,460 --> 00:05:13,880
generated my key

95
00:05:11,210 --> 00:05:14,539
also it<font color="#E5E5E5"> was</font><font color="#CCCCCC"> the thing he as</font><font color="#E5E5E5"> the</font>

96
00:05:13,880 --> 00:05:19,730
application

97
00:05:14,540 --> 00:05:23,680
I had the IV and I used this cool little

98
00:05:19,730 --> 00:05:28,850
tool called cyber<font color="#E5E5E5"> chef to test it out</font>

99
00:05:23,680 --> 00:05:32,930
the right hands<font color="#CCCCCC"> upper the input was the</font>

100
00:05:28,850 --> 00:05:35,810
encrypted<font color="#E5E5E5"> text and the output which you</font>

101
00:05:32,930 --> 00:05:38,480
<font color="#E5E5E5">cannot see was the decoded output</font>

102
00:05:35,810 --> 00:05:42,770
because I had the key<font color="#CCCCCC"> and</font><font color="#E5E5E5"> IV was using</font>

103
00:05:38,480 --> 00:05:46,070
as 256 with CBC<font color="#CCCCCC"> mode on and I had the</font>

104
00:05:42,770 --> 00:05:47,960
decryption<font color="#E5E5E5"> what was the problem because</font>

105
00:05:46,070 --> 00:05:49,370
we<font color="#CCCCCC"> are</font><font color="#E5E5E5"> starting to get there now we have</font>

106
00:05:47,960 --> 00:05:52,880
the request<font color="#E5E5E5"> we can see them we</font><font color="#CCCCCC"> can</font>

107
00:05:49,370 --> 00:05:55,610
decrypt them which is cool but<font color="#E5E5E5"> the</font>

108
00:05:52,880 --> 00:05:57,290
<font color="#CCCCCC">problem is decrypting decoding</font><font color="#E5E5E5"> modifying</font>

109
00:05:55,610 --> 00:06:00,020
the parameters<font color="#CCCCCC"> Rhian</font><font color="#E5E5E5"> coding we</font>

110
00:05:57,290 --> 00:06:03,830
encrypting for each request and<font color="#CCCCCC"> for each</font>

111
00:06:00,020 --> 00:06:05,780
<font color="#E5E5E5">modified parameter would have took a lot</font>

112
00:06:03,830 --> 00:06:10,310
more<font color="#CCCCCC"> time than than assigned time for</font>

113
00:06:05,780 --> 00:06:13,460
the pen test so I have burp here giving

114
00:06:10,310 --> 00:06:17,210
a hand<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> remember the name of the</font>

115
00:06:13,460 --> 00:06:21,680
little<font color="#E5E5E5"> child in the cartoon but that's</font>

116
00:06:17,210 --> 00:06:24,560
burp now<font color="#CCCCCC"> we're at least I thought so</font><font color="#E5E5E5"> my</font>

117
00:06:21,680 --> 00:06:27,740
<font color="#CCCCCC">Google food</font><font color="#E5E5E5"> wasn't providing</font><font color="#CCCCCC"> I first</font>

118
00:06:24,560 --> 00:06:31,390
wanted<font color="#CCCCCC"> to use a macro uber macro to</font>

119
00:06:27,740 --> 00:06:34,910
decrypt<font color="#CCCCCC"> the content but it didn't</font><font color="#E5E5E5"> work</font>

120
00:06:31,390 --> 00:06:38,240
<font color="#E5E5E5">I've wasted half</font><font color="#CCCCCC"> a day is doing</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> I</font>

121
00:06:34,910 --> 00:06:41,790
was<font color="#E5E5E5"> literally stuck again</font>

122
00:06:38,240 --> 00:06:46,710
but then the offensive<font color="#CCCCCC"> security model</font>

123
00:06:41,790 --> 00:06:48,090
try harder came into my<font color="#E5E5E5"> mind and I</font>

124
00:06:46,710 --> 00:06:51,109
thought<font color="#E5E5E5"> about why not write a burp</font>

125
00:06:48,090 --> 00:06:53,489
extension<font color="#E5E5E5"> that</font><font color="#CCCCCC"> does what I needed to do</font>

126
00:06:51,110 --> 00:06:56,760
it's the easy way to example<font color="#E5E5E5"> feature</font>

127
00:06:53,490 --> 00:06:59,250
<font color="#E5E5E5">isn't it that's what they say that's</font><font color="#CCCCCC"> the</font>

128
00:06:56,760 --> 00:07:01,620
<font color="#E5E5E5">landing page when you click</font><font color="#CCCCCC"> the first</font>

129
00:06:59,250 --> 00:07:06,420
<font color="#CCCCCC">result on Google about extending birth</font>

130
00:07:01,620 --> 00:07:09,180
with an extension<font color="#E5E5E5"> and that's what you</font>

131
00:07:06,420 --> 00:07:15,120
get<font color="#E5E5E5"> this example does nothing at all</font>

132
00:07:09,180 --> 00:07:18,750
<font color="#E5E5E5">it's written down there</font><font color="#CCCCCC"> yeah I never</font>

133
00:07:15,120 --> 00:07:21,540
wrote<font color="#E5E5E5"> burp extension before I just used</font>

134
00:07:18,750 --> 00:07:25,430
them the ones provided by the<font color="#E5E5E5"> almighty</font>

135
00:07:21,540 --> 00:07:30,660
<font color="#CCCCCC">albino wax or whoever develops them and</font>

136
00:07:25,430 --> 00:07:34,650
I was stuck again<font color="#CCCCCC"> I went</font><font color="#E5E5E5"> on Google</font><font color="#CCCCCC"> I</font>

137
00:07:30,660 --> 00:07:38,400
research a lot more I thought they have

138
00:07:34,650 --> 00:07:43,560
some sample extensions<font color="#CCCCCC"> I looked at them</font>

139
00:07:38,400 --> 00:07:45,630
I studied them and<font color="#E5E5E5"> then I was stuck with</font>

140
00:07:43,560 --> 00:07:49,050
<font color="#CCCCCC">a decision again</font><font color="#E5E5E5"> what language to use</font>

141
00:07:45,630 --> 00:07:54,270
<font color="#E5E5E5">because burp as a solution supports</font>

142
00:07:49,050 --> 00:07:57,720
<font color="#E5E5E5">extending it with free languages or one</font>

143
00:07:54,270 --> 00:08:00,289
language<font color="#CCCCCC"> but to other rappers</font><font color="#E5E5E5"> the main</font>

144
00:07:57,720 --> 00:08:05,030
language the tool is written in Java<font color="#CCCCCC"> and</font>

145
00:08:00,290 --> 00:08:10,200
it can<font color="#CCCCCC"> use Python or Ruby</font><font color="#E5E5E5"> to be extended</font>

146
00:08:05,030 --> 00:08:13,919
<font color="#E5E5E5">we're actually</font><font color="#CCCCCC"> Jade on and JRuby those</font>

147
00:08:10,200 --> 00:08:20,580
are wrappers of Python<font color="#E5E5E5"> and will be over</font>

148
00:08:13,920 --> 00:08:24,330
Java<font color="#CCCCCC"> ok Java I don't like Ruby I don't</font>

149
00:08:20,580 --> 00:08:31,770
know<font color="#E5E5E5"> so the solution was simple</font><font color="#CCCCCC"> Jade on</font>

150
00:08:24,330 --> 00:08:35,280
it is so we we went on with Japan and I

151
00:08:31,770 --> 00:08:38,669
found<font color="#E5E5E5"> something on the Block on port</font>

152
00:08:35,280 --> 00:08:41,549
sugar<font color="#E5E5E5"> the developers of</font><font color="#CCCCCC"> verb suit they</font>

153
00:08:38,669 --> 00:08:46,920
had an extension written that did

154
00:08:41,549 --> 00:08:49,439
nothing<font color="#CCCCCC"> but added</font><font color="#E5E5E5"> custom editor tab to</font>

155
00:08:46,920 --> 00:08:50,740
the intercept which<font color="#CCCCCC"> is what I wanted</font><font color="#E5E5E5"> to</font>

156
00:08:49,440 --> 00:08:56,689
do

157
00:08:50,740 --> 00:08:57,589
basically<font color="#E5E5E5"> I got that extension</font><font color="#CCCCCC"> I started</font>

158
00:08:56,689 --> 00:09:00,230
to<font color="#E5E5E5"> look for it</font>

159
00:08:57,589 --> 00:09:03,470
they provided in Java and<font color="#E5E5E5"> Jaden also</font>

160
00:09:00,230 --> 00:09:07,670
which is great<font color="#E5E5E5"> because I don't like Java</font>

161
00:09:03,470 --> 00:09:11,029
<font color="#CCCCCC">and I started writing it what was the</font>

162
00:09:07,670 --> 00:09:13,519
<font color="#CCCCCC">first thing</font><font color="#E5E5E5"> I had to do I didn't tell</font>

163
00:09:11,029 --> 00:09:15,439
<font color="#E5E5E5">you that earlier</font><font color="#CCCCCC"> but the they thought</font>

164
00:09:13,519 --> 00:09:20,360
the<font color="#E5E5E5"> encrypted values were sent in sub</font>

165
00:09:15,439 --> 00:09:24,469
requests to the server under<font color="#CCCCCC"> two XML</font>

166
00:09:20,360 --> 00:09:26,660
tags<font color="#E5E5E5"> right</font><font color="#CCCCCC"> object and read object where</font>

167
00:09:24,470 --> 00:09:31,029
at the first step that<font color="#E5E5E5"> I took was to</font>

168
00:09:26,660 --> 00:09:31,029
<font color="#E5E5E5">look</font><font color="#CCCCCC"> for those</font><font color="#E5E5E5"> patterns using a regex</font>

169
00:09:31,329 --> 00:09:37,998
<font color="#CCCCCC">for the end and close</font><font color="#E5E5E5"> tags</font><font color="#CCCCCC"> I was</font>

170
00:09:35,240 --> 00:09:41,329
thinking when the when burp<font color="#E5E5E5"> catches this</font>

171
00:09:37,999 --> 00:09:47,749
request<font color="#CCCCCC"> it should launch the the new tab</font>

172
00:09:41,329 --> 00:09:52,029
<font color="#E5E5E5">in intercept so I started to decrypt the</font>

173
00:09:47,749 --> 00:09:54,740
payload but<font color="#CCCCCC"> I stumbled</font><font color="#E5E5E5"> onto a problem</font>

174
00:09:52,029 --> 00:09:58,819
everyone knows the famous PI crypto

175
00:09:54,740 --> 00:10:01,790
implementation library in Python<font color="#CCCCCC"> it was</font>

176
00:09:58,819 --> 00:10:03,378
is<font color="#E5E5E5"> colony shouldn't have a</font><font color="#CCCCCC"> problem</font><font color="#E5E5E5"> it</font>

177
00:10:01,790 --> 00:10:06,679
wasn't<font color="#E5E5E5"> working</font>

178
00:10:03,379 --> 00:10:09,249
why because I'm<font color="#E5E5E5"> not using by them I'm</font>

179
00:10:06,679 --> 00:10:09,249
using<font color="#CCCCCC"> jython</font>

180
00:10:10,029 --> 00:10:16,339
so don't be that fast<font color="#CCCCCC"> Mike if that</font>

181
00:10:12,679 --> 00:10:19,279
doesn't<font color="#E5E5E5"> work in</font><font color="#CCCCCC"> j.don</font><font color="#E5E5E5"> fortunately after</font>

182
00:10:16,339 --> 00:10:23,779
<font color="#CCCCCC">my heart was broken I found my super</font>

183
00:10:19,279 --> 00:10:27,410
<font color="#CCCCCC">hero this guy wrote the</font><font color="#E5E5E5"> wrapper for pi</font>

184
00:10:23,779 --> 00:10:30,019
crypto API<font color="#CCCCCC"> but for Chaya</font>

185
00:10:27,410 --> 00:10:31,969
he was my<font color="#CCCCCC"> super hero</font><font color="#E5E5E5"> that day after</font>

186
00:10:30,019 --> 00:10:34,670
losing about<font color="#E5E5E5"> three hours debugging the</font>

187
00:10:31,970 --> 00:10:36,860
problem<font color="#E5E5E5"> you'll see in the</font><font color="#CCCCCC"> end slides why</font>

188
00:10:34,670 --> 00:10:41,899
the buggin is an issue in<font color="#CCCCCC"> verb while</font>

189
00:10:36,860 --> 00:10:46,220
extending<font color="#E5E5E5"> it this guy was my hero after</font>

190
00:10:41,899 --> 00:10:51,139
<font color="#CCCCCC">using the</font><font color="#E5E5E5"> J crypto</font><font color="#CCCCCC"> very plantation</font><font color="#E5E5E5"> of my</font>

191
00:10:46,220 --> 00:10:54,589
crypto the decryption worked<font color="#E5E5E5"> by magic</font><font color="#CCCCCC"> ok</font>

192
00:10:51,139 --> 00:10:56,600
<font color="#E5E5E5">so I wrote the encrypt and decrypt why'd</font>

193
00:10:54,589 --> 00:11:01,069
they encrypt<font color="#E5E5E5"> also because I wanted</font><font color="#CCCCCC"> to</font>

194
00:10:56,600 --> 00:11:03,230
modify<font color="#E5E5E5"> the parameters and we encrypt the</font>

195
00:11:01,069 --> 00:11:05,630
values and send them to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> server we</font>

196
00:11:03,230 --> 00:11:10,490
as the communication wouldn't work

197
00:11:05,630 --> 00:11:14,950
otherwise but I was stuck<font color="#E5E5E5"> after</font><font color="#CCCCCC"> the</font>

198
00:11:10,490 --> 00:11:20,150
decryption with.net<font color="#E5E5E5"> sterilized objects</font>

199
00:11:14,950 --> 00:11:24,220
which are cool objects<font color="#E5E5E5"> not and the</font>

200
00:11:20,150 --> 00:11:28,699
struggle with<font color="#CCCCCC"> google fling begins again</font>

201
00:11:24,220 --> 00:11:31,010
this guy is my second<font color="#CCCCCC"> superhero</font><font color="#E5E5E5"> he's the</font>

202
00:11:28,700 --> 00:11:33,830
only<font color="#CCCCCC"> guy that</font><font color="#E5E5E5"> thought about writing</font>

203
00:11:31,010 --> 00:11:37,160
<font color="#CCCCCC">admit binary format</font><font color="#E5E5E5"> their pastor in</font>

204
00:11:33,830 --> 00:11:41,330
Python<font color="#E5E5E5"> it's the only</font><font color="#CCCCCC"> rapper and github</font>

205
00:11:37,160 --> 00:11:45,530
<font color="#E5E5E5">and I wouldn't want</font><font color="#CCCCCC"> to do that by hand</font>

206
00:11:41,330 --> 00:11:48,980
never<font color="#E5E5E5"> there are other this does them to</font>

207
00:11:45,530 --> 00:11:52,250
JSON<font color="#E5E5E5"> it translates them to JSON there</font>

208
00:11:48,980 --> 00:11:55,610
were others that<font color="#E5E5E5"> did XML but</font><font color="#CCCCCC"> I had</font>

209
00:11:52,250 --> 00:12:00,800
issues<font color="#CCCCCC"> with them a jaques</font><font color="#E5E5E5"> wherever you</font>

210
00:11:55,610 --> 00:12:05,290
are<font color="#E5E5E5"> bro you saved my life and after that</font>

211
00:12:00,800 --> 00:12:09,290
I went on with writing the extension

212
00:12:05,290 --> 00:12:11,480
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is the method to set the</font><font color="#CCCCCC"> message</font>

213
00:12:09,290 --> 00:12:15,050
when<font color="#CCCCCC"> it finds the</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> object</font><font color="#E5E5E5"> of the</font>

214
00:12:11,480 --> 00:12:22,340
ridge I read object pattern<font color="#E5E5E5"> it checks if</font>

215
00:12:15,050 --> 00:12:30,380
it is a request<font color="#E5E5E5"> if it is it</font><font color="#CCCCCC"> decrypted</font><font color="#E5E5E5"> it</font>

216
00:12:22,340 --> 00:12:35,660
decodes it and it prints<font color="#CCCCCC"> it out and if I</font>

217
00:12:30,380 --> 00:12:39,470
modify<font color="#CCCCCC"> it it redoes the</font><font color="#E5E5E5"> same thing but</font>

218
00:12:35,660 --> 00:12:42,620
in Reverse<font color="#E5E5E5"> it encodes it to.net binary</font>

219
00:12:39,470 --> 00:12:44,630
for<font color="#CCCCCC"> add</font><font color="#E5E5E5"> a serialized object</font><font color="#CCCCCC"> it then</font>

220
00:12:42,620 --> 00:12:46,730
encrypts it<font color="#E5E5E5"> with a key in</font><font color="#CCCCCC"> the IV and</font>

221
00:12:44,630 --> 00:12:47,240
then packs the message and<font color="#E5E5E5"> sends it to</font>

222
00:12:46,730 --> 00:12:51,200
<font color="#CCCCCC">the server</font>

223
00:12:47,240 --> 00:12:55,550
<font color="#CCCCCC">I told you earlier that</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> had big</font>

224
00:12:51,200 --> 00:12:59,390
problems<font color="#E5E5E5"> debugging</font><font color="#CCCCCC"> burp because the Java</font>

225
00:12:55,550 --> 00:13:01,569
stack trace in burp doesn't provide any

226
00:12:59,390 --> 00:13:06,290
<font color="#E5E5E5">clues when using jython</font>

227
00:13:01,570 --> 00:13:08,870
it provides the<font color="#E5E5E5"> same error every time it</font>

228
00:13:06,290 --> 00:13:13,610
doesn't<font color="#CCCCCC"> matter what you do the solution</font>

229
00:13:08,870 --> 00:13:15,950
was adding this library<font color="#E5E5E5"> security and</font>

230
00:13:13,610 --> 00:13:18,950
<font color="#E5E5E5">being from security</font><font color="#CCCCCC"> and being perfect</font>

231
00:13:15,950 --> 00:13:20,960
sections and putting in<font color="#CCCCCC"> your project</font>

232
00:13:18,950 --> 00:13:22,820
<font color="#E5E5E5">folder importing it in your code and</font>

233
00:13:20,960 --> 00:13:26,120
just calling it at the end

234
00:13:22,820 --> 00:13:28,580
yeah and behold now<font color="#E5E5E5"> any Python exception</font>

235
00:13:26,120 --> 00:13:32,270
is thrown in the extended output tab and

236
00:13:28,580 --> 00:13:38,590
you<font color="#CCCCCC"> can debug</font><font color="#E5E5E5"> your code which is cool</font>

237
00:13:32,270 --> 00:13:43,880
and<font color="#E5E5E5"> everyone please drum roll sounds yay</font>

238
00:13:38,590 --> 00:13:48,440
that is<font color="#E5E5E5"> the Crypt app appears after I</font>

239
00:13:43,880 --> 00:13:53,210
<font color="#E5E5E5">think two</font><font color="#CCCCCC"> days of work</font><font color="#E5E5E5"> this works and I</font>

240
00:13:48,440 --> 00:13:56,300
<font color="#CCCCCC">can pentas the solution now that was my</font>

241
00:13:53,210 --> 00:13:59,210
presentation<font color="#CCCCCC"> I know</font><font color="#E5E5E5"> I went a</font><font color="#CCCCCC"> bit fast</font>

242
00:13:56,300 --> 00:14:02,150
<font color="#E5E5E5">through it but we</font><font color="#CCCCCC"> didn't</font><font color="#E5E5E5"> have a lot of</font>

243
00:13:59,210 --> 00:14:05,150
time and I hope<font color="#E5E5E5"> you</font><font color="#CCCCCC"> guys have some</font>

244
00:14:02,150 --> 00:14:08,480
<font color="#E5E5E5">questions</font><font color="#CCCCCC"> if you do there are some bolts</font>

245
00:14:05,150 --> 00:14:13,069
here for you and<font color="#E5E5E5"> some hats I guess and I</font>

246
00:14:08,480 --> 00:14:14,510
hope I<font color="#E5E5E5"> can</font><font color="#CCCCCC"> provide some answers thank</font>

247
00:14:13,070 --> 00:14:18,380
<font color="#CCCCCC">you so much cuz means so yes we</font><font color="#E5E5E5"> are</font>

248
00:14:14,510 --> 00:14:28,670
<font color="#CCCCCC">waiting for questions first three</font>

249
00:14:18,380 --> 00:14:31,010
questions<font color="#CCCCCC"> will win</font><font color="#E5E5E5"> hats so yes hello</font><font color="#CCCCCC"> Hey</font>

250
00:14:28,670 --> 00:14:33,500
<font color="#E5E5E5">the key was actually her code it what</font>

251
00:14:31,010 --> 00:14:35,300
where it was the generated based on some

252
00:14:33,500 --> 00:14:41,750
hardware stamp or something like<font color="#E5E5E5"> this</font>

253
00:14:35,300 --> 00:14:46,609
the<font color="#E5E5E5"> key was generated using</font><font color="#CCCCCC"> a built-in</font>

254
00:14:41,750 --> 00:14:49,370
method I don't know exactly<font color="#E5E5E5"> but</font><font color="#CCCCCC"> it was</font>

255
00:14:46,610 --> 00:14:51,740
very<font color="#E5E5E5"> easy</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> read through the steps to</font>

256
00:14:49,370 --> 00:14:56,470
just<font color="#CCCCCC"> hold the method and I got</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> same</font>

257
00:14:51,740 --> 00:15:00,190
<font color="#CCCCCC">key</font><font color="#E5E5E5"> but IV was hard coded okay so how</font>

258
00:14:56,470 --> 00:15:06,440
did send the symmetric key to the server

259
00:15:00,190 --> 00:15:08,150
being<font color="#CCCCCC"> they use the same data on the</font>

260
00:15:06,440 --> 00:15:10,460
client<font color="#E5E5E5"> and on the server to</font><font color="#CCCCCC"> generate</font><font color="#E5E5E5"> the</font>

261
00:15:08,150 --> 00:15:12,230
same<font color="#E5E5E5"> key pair the thing keys okay this</font>

262
00:15:10,460 --> 00:15:14,860
<font color="#E5E5E5">is that's why I never write your own</font>

263
00:15:12,230 --> 00:15:17,780
crypto or if you do do<font color="#CCCCCC"> it the</font><font color="#E5E5E5"> proper way</font>

264
00:15:14,860 --> 00:15:20,570
<font color="#E5E5E5">okay thank you that's the</font><font color="#CCCCCC"> poll for you</font>

265
00:15:17,780 --> 00:15:26,770
<font color="#E5E5E5">please</font><font color="#CCCCCC"> give it</font><font color="#E5E5E5"> to him if you want one</font>

266
00:15:20,570 --> 00:15:26,770
ask a question<font color="#E5E5E5"> you I have blue balls</font>

267
00:15:27,690 --> 00:15:42,519
who wants one<font color="#CCCCCC"> next question</font><font color="#E5E5E5"> okay you</font>

268
00:15:37,870 --> 00:15:44,470
want one<font color="#CCCCCC"> yeah I saw in the Python</font>

269
00:15:42,519 --> 00:15:48,339
<font color="#E5E5E5">implementation that you hard-coded</font><font color="#CCCCCC"> the</font>

270
00:15:44,470 --> 00:15:50,500
key and the IV<font color="#E5E5E5"> so I guess you can take</font>

271
00:15:48,339 --> 00:15:52,509
it even further right and develop it<font color="#CCCCCC"> so</font>

272
00:15:50,500 --> 00:15:55,269
yeah further because this way<font color="#CCCCCC"> it only</font>

273
00:15:52,509 --> 00:15:59,680
works in this situation<font color="#E5E5E5"> yeah the thing</font>

274
00:15:55,269 --> 00:16:02,680
<font color="#E5E5E5">is this is a very specific case what the</font>

275
00:15:59,680 --> 00:16:05,560
message I want<font color="#E5E5E5"> to transmit here is that</font>

276
00:16:02,680 --> 00:16:08,939
when you're stuck<font color="#CCCCCC"> I'll get on stuck</font>

277
00:16:05,560 --> 00:16:11,560
<font color="#CCCCCC">yours for yourself</font><font color="#E5E5E5"> I'm not</font><font color="#CCCCCC"> a programmer</font>

278
00:16:08,940 --> 00:16:16,180
<font color="#E5E5E5">I'm a shitty programmer if I'm a</font>

279
00:16:11,560 --> 00:16:18,459
programmer<font color="#CCCCCC"> and I couldn't find a</font>

280
00:16:16,180 --> 00:16:21,609
solution<font color="#E5E5E5"> on Google so I decided to build</font>

281
00:16:18,459 --> 00:16:24,000
<font color="#E5E5E5">my own the thing is this</font><font color="#CCCCCC"> this was the</font>

282
00:16:21,610 --> 00:16:27,970
first<font color="#E5E5E5"> time when I encountered this</font>

283
00:16:24,000 --> 00:16:32,410
encryption<font color="#CCCCCC"> not the problem with the</font><font color="#E5E5E5"> key</font>

284
00:16:27,970 --> 00:16:34,899
<font color="#E5E5E5">on the client</font><font color="#CCCCCC"> side and yeah further</font>

285
00:16:32,410 --> 00:16:37,719
development<font color="#E5E5E5"> yeah it would be cute</font><font color="#CCCCCC"> to add</font>

286
00:16:34,899 --> 00:16:41,550
the<font color="#E5E5E5"> input field for the IV and the key</font>

287
00:16:37,720 --> 00:16:46,269
to do it on the fly but<font color="#CCCCCC"> you can always</font>

288
00:16:41,550 --> 00:16:52,719
change the<font color="#E5E5E5"> Python code and change the ID</font>

289
00:16:46,269 --> 00:16:55,380
<font color="#E5E5E5">and the key here</font><font color="#CCCCCC"> you go</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> we have a</font>

290
00:16:52,720 --> 00:16:55,380
question<font color="#E5E5E5"> there</font>

291
00:16:58,540 --> 00:17:04,520
it's not the<font color="#E5E5E5"> next</font><font color="#CCCCCC"> straight</font><font color="#E5E5E5"> actually the</font>

292
00:17:00,740 --> 00:17:06,140
thing<font color="#CCCCCC"> is</font><font color="#E5E5E5"> I was on a pen test and I</font>

293
00:17:04,520 --> 00:17:08,480
couldn't<font color="#E5E5E5"> test the application</font><font color="#CCCCCC"> because</font>

294
00:17:06,140 --> 00:17:15,020
<font color="#CCCCCC">the developers</font><font color="#E5E5E5"> yeah they encrypted the</font>

295
00:17:08,480 --> 00:17:17,049
payload the parameter the data if you

296
00:17:15,020 --> 00:17:21,679
can see after<font color="#CCCCCC"> the</font><font color="#E5E5E5"> yeah you cannot see</font>

297
00:17:17,049 --> 00:17:24,349
after the decrypting it<font color="#CCCCCC"> I I could</font><font color="#E5E5E5"> alter</font>

298
00:17:21,679 --> 00:17:30,919
and that parameters<font color="#CCCCCC"> well like</font><font color="#E5E5E5"> test the</font>

299
00:17:24,349 --> 00:17:32,658
way I'm used<font color="#E5E5E5"> to test yeah the practical</font>

300
00:17:30,919 --> 00:17:36,070
approach was<font color="#CCCCCC"> that I could do my job</font><font color="#E5E5E5"> and</font>

301
00:17:32,659 --> 00:17:42,400
the customer could get something<font color="#CCCCCC"> out of</font>

302
00:17:36,070 --> 00:17:49,428
paying me to do my job<font color="#CCCCCC"> I have more balls</font>

303
00:17:42,400 --> 00:17:57,409
blue also come on<font color="#E5E5E5"> don't be shy</font><font color="#CCCCCC"> we have</font>

304
00:17:49,429 --> 00:17:58,760
<font color="#CCCCCC">on</font><font color="#E5E5E5"> there thank you for your very</font>

305
00:17:57,409 --> 00:18:01,669
interesting<font color="#E5E5E5"> presentation</font>

306
00:17:58,760 --> 00:18:06,250
the only thing what I didn't get how

307
00:18:01,669 --> 00:18:09,890
could you restore<font color="#CCCCCC"> the key</font><font color="#E5E5E5"> the how you</font>

308
00:18:06,250 --> 00:18:13,030
<font color="#CCCCCC">generated</font><font color="#E5E5E5"> the same</font><font color="#CCCCCC"> one I get I got the</font>

309
00:18:09,890 --> 00:18:16,010
method<font color="#CCCCCC"> from the client which I</font>

310
00:18:13,030 --> 00:18:18,770
disassembled and I used the same method

311
00:18:16,010 --> 00:18:20,629
they use and I could<font color="#E5E5E5"> create my own key</font>

312
00:18:18,770 --> 00:18:24,289
<font color="#E5E5E5">the IV was</font><font color="#CCCCCC"> hard-coded and the key</font>

313
00:18:20,630 --> 00:18:29,870
generation<font color="#E5E5E5"> was based on an insecure</font>

314
00:18:24,289 --> 00:18:32,690
method<font color="#E5E5E5"> and I got the same key so that</font>

315
00:18:29,870 --> 00:18:35,389
one was saved<font color="#CCCCCC"> okay yes</font><font color="#E5E5E5"> as I understand</font>

316
00:18:32,690 --> 00:18:38,030
<font color="#E5E5E5">so the</font><font color="#CCCCCC"> observed</font><font color="#E5E5E5"> or randomness</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> mean</font>

317
00:18:35,390 --> 00:18:40,880
was weak yes extremely<font color="#E5E5E5"> weak it was based</font>

318
00:18:38,030 --> 00:18:43,700
<font color="#E5E5E5">on the current date</font><font color="#CCCCCC"> a hash okay I</font><font color="#E5E5E5"> say</font>

319
00:18:40,880 --> 00:18:46,480
thank<font color="#E5E5E5"> you I don't want to give out too</font>

320
00:18:43,700 --> 00:18:54,460
<font color="#CCCCCC">much details</font><font color="#E5E5E5"> but yeah the date was the</font>

321
00:18:46,480 --> 00:18:54,460
<font color="#CCCCCC">nice</font><font color="#E5E5E5"> shot any other questions</font>

322
00:18:58,440 --> 00:19:07,390
so we have one<font color="#CCCCCC"> question here hi thank</font>

323
00:19:05,590 --> 00:19:09,189
<font color="#CCCCCC">you for the</font><font color="#E5E5E5"> presentation have you tried</font>

324
00:19:07,390 --> 00:19:10,600
the pro<font color="#CCCCCC"> version because because it will</font>

325
00:19:09,190 --> 00:19:13,539
save you<font color="#E5E5E5"> time and</font><font color="#CCCCCC"> money</font><font color="#E5E5E5"> in the future</font>

326
00:19:10,600 --> 00:19:17,199
<font color="#CCCCCC">the pro version of burp I was using</font><font color="#E5E5E5"> the</font>

327
00:19:13,539 --> 00:19:20,140
pro<font color="#CCCCCC"> version of burp actually but it</font>

328
00:19:17,200 --> 00:19:21,490
didn't give out much help in this

329
00:19:20,140 --> 00:19:23,679
situation

330
00:19:21,490 --> 00:19:26,650
yeah I recommend to everyone<font color="#E5E5E5"> use the pro</font>

331
00:19:23,679 --> 00:19:31,049
version<font color="#E5E5E5"> it's quite cheap and the best</font>

332
00:19:26,650 --> 00:19:35,260
school out<font color="#CCCCCC"> there for pen testers sorry I</font>

333
00:19:31,049 --> 00:19:39,010
think<font color="#CCCCCC"> I have two more</font><font color="#E5E5E5"> yeah so we have a</font>

334
00:19:35,260 --> 00:19:42,279
question<font color="#E5E5E5"> here</font><font color="#CCCCCC"> and the last one</font><font color="#E5E5E5"> hi</font><font color="#CCCCCC"> Cosmin</font>

335
00:19:39,010 --> 00:19:45,010
<font color="#CCCCCC">I think it's a fair</font><font color="#E5E5E5"> question to ask if</font>

336
00:19:42,279 --> 00:19:48,850
<font color="#E5E5E5">you you have used</font><font color="#CCCCCC"> java instead of python</font>

337
00:19:45,010 --> 00:19:52,840
you could have gotten a result<font color="#CCCCCC"> earlier</font>

338
00:19:48,850 --> 00:19:57,100
right<font color="#CCCCCC"> if i sure you have had gone with</font>

339
00:19:52,840 --> 00:20:04,600
java for<font color="#E5E5E5"> my</font><font color="#CCCCCC"> implementation it would have</font>

340
00:19:57,100 --> 00:20:08,199
been so so much easier<font color="#E5E5E5"> but remember</font><font color="#CCCCCC"> I</font>

341
00:20:04,600 --> 00:20:14,740
<font color="#E5E5E5">hate Java</font><font color="#CCCCCC"> ok we</font><font color="#E5E5E5"> have the last question</font>

342
00:20:08,200 --> 00:20:16,960
<font color="#CCCCCC">there why do I hate Java ok the honest</font>

343
00:20:14,740 --> 00:20:23,649
answer<font color="#E5E5E5"> is because I don't know it really</font>

344
00:20:16,960 --> 00:20:26,350
well<font color="#E5E5E5"> and typecasting sucks ok everyone</font>

345
00:20:23,649 --> 00:20:29,789
<font color="#E5E5E5">thank you and have a nice day at</font><font color="#CCCCCC"> deaf</font>

346
00:20:26,350 --> 00:20:35,050
camp<font color="#E5E5E5"> and maybe see you next year</font>

347
00:20:29,789 --> 00:20:36,410
<font color="#E5E5E5">yeah</font><font color="#CCCCCC"> I have another</font><font color="#E5E5E5"> slide here Thanks</font>

348
00:20:35,050 --> 00:20:41,099
[Laughter]

349
00:20:36,410 --> 00:20:41,099
[Applause]

