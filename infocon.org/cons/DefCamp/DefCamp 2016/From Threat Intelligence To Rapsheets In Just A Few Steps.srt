1
00:00:00,000 --> 00:00:05,549
together with my colleague<font color="#E5E5E5"> here</font><font color="#CCCCCC"> of AGN</font>

2
00:00:02,190 --> 00:00:09,630
<font color="#CCCCCC">oh we're going to tell you a tale about</font>

3
00:00:05,549 --> 00:00:12,150
basically how we build our own<font color="#E5E5E5"> threat</font>

4
00:00:09,630 --> 00:00:15,179
intelligence system from scratch and

5
00:00:12,150 --> 00:00:18,240
kind of what tools we used and what was

6
00:00:15,179 --> 00:00:20,490
<font color="#E5E5E5">your experience</font><font color="#CCCCCC"> doing that so you're</font>

7
00:00:18,240 --> 00:00:21,750
probably wondering right now<font color="#CCCCCC"> worry</font><font color="#E5E5E5"> there</font>

8
00:00:20,490 --> 00:00:23,909
are<font color="#E5E5E5"> two of us</font>

9
00:00:21,750 --> 00:00:26,849
so in order to build a<font color="#CCCCCC"> friend</font>

10
00:00:23,910 --> 00:00:28,980
intelligence system<font color="#CCCCCC"> you need</font><font color="#E5E5E5"> two parts</font>

11
00:00:26,849 --> 00:00:32,040
you need<font color="#E5E5E5"> engineering and</font><font color="#CCCCCC"> unique security</font>

12
00:00:28,980 --> 00:00:34,829
<font color="#E5E5E5">research as you can probably read</font><font color="#CCCCCC"> I'm</font>

13
00:00:32,040 --> 00:00:37,290
the engineering guide and<font color="#CCCCCC"> adrian is of</font>

14
00:00:34,829 --> 00:00:40,200
course the security researcher guide<font color="#CCCCCC"> so</font>

15
00:00:37,290 --> 00:00:42,329
this<font color="#E5E5E5"> is a security conference</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> that</font>

16
00:00:40,200 --> 00:00:43,350
<font color="#CCCCCC">Adrian go first and tell you about our</font>

17
00:00:42,329 --> 00:00:49,530
system

18
00:00:43,350 --> 00:00:51,149
thank you so first of all a quick

19
00:00:49,530 --> 00:00:52,920
overview of our agenda

20
00:00:51,149 --> 00:00:55,079
first we'll talk about<font color="#E5E5E5"> whether actually</font>

21
00:00:52,920 --> 00:00:56,280
is what we understand by the term since

22
00:00:55,079 --> 00:00:59,609
it's something we've been using

23
00:00:56,280 --> 00:01:02,730
internally<font color="#E5E5E5"> then</font><font color="#CCCCCC"> i'll explain how we do</font>

24
00:00:59,609 --> 00:01:04,589
<font color="#CCCCCC">thread and education for database and</font>

25
00:01:02,730 --> 00:01:06,689
drugs will walk you a bit through the

26
00:01:04,589 --> 00:01:11,130
engineering part and<font color="#E5E5E5"> in the end we will</font>

27
00:01:06,689 --> 00:01:13,679
present some stats<font color="#E5E5E5"> quick disclaimer</font>

28
00:01:11,130 --> 00:01:15,960
<font color="#CCCCCC">we're not present presenting a product</font>

29
00:01:13,680 --> 00:01:17,640
or anything here so all we want to do is

30
00:01:15,960 --> 00:01:19,229
present<font color="#E5E5E5"> our experience building the</font>

31
00:01:17,640 --> 00:01:25,080
threat intelligence system from scratch

32
00:01:19,229 --> 00:01:27,720
some lessons learned and similar<font color="#CCCCCC"> ok so</font>

33
00:01:25,080 --> 00:01:29,009
first<font color="#E5E5E5"> of all what's a rap sheet you have</font>

34
00:01:27,720 --> 00:01:31,259
some dictionary definitions if you

35
00:01:29,009 --> 00:01:34,049
prefer those if not<font color="#CCCCCC"> i'll tell you it's a</font>

36
00:01:31,259 --> 00:01:36,210
record the police keeps on everything

37
00:01:34,049 --> 00:01:38,159
bad they know someone<font color="#E5E5E5"> ever did right</font><font color="#CCCCCC"> so</font>

38
00:01:36,210 --> 00:01:40,500
you have al<font color="#E5E5E5"> capone's rap sheet as an</font>

39
00:01:38,159 --> 00:01:42,060
example over there with a lot of stuff

40
00:01:40,500 --> 00:01:45,270
with his criminal history

41
00:01:42,060 --> 00:01:48,270
what we did was<font color="#E5E5E5"> take this idea and</font>

42
00:01:45,270 --> 00:01:50,460
expand upon it by tracking<font color="#E5E5E5"> or malicious</font>

43
00:01:48,270 --> 00:01:53,100
<font color="#CCCCCC">ip's</font><font color="#E5E5E5"> on the internet</font><font color="#CCCCCC"> over time</font>

44
00:01:50,460 --> 00:01:54,298
<font color="#CCCCCC">ok you might</font><font color="#E5E5E5"> ask why we want to do</font>

45
00:01:53,100 --> 00:01:56,039
something like this

46
00:01:54,299 --> 00:01:57,390
the reason is we are using this system

47
00:01:56,040 --> 00:01:59,670
life

48
00:01:57,390 --> 00:02:02,219
<font color="#E5E5E5">we're generating the</font><font color="#CCCCCC"> databases of</font>

49
00:01:59,670 --> 00:02:06,240
intelligence<font color="#CCCCCC"> over tax which</font><font color="#E5E5E5"> were using</font>

50
00:02:02,219 --> 00:02:08,549
in our<font color="#E5E5E5"> product you have an example or</font>

51
00:02:06,240 --> 00:02:10,978
rap sheet over here so this is a view

52
00:02:08,550 --> 00:02:12,870
from our internal dashboard

53
00:02:10,979 --> 00:02:15,480
you can see there's a screenshot of

54
00:02:12,870 --> 00:02:17,099
<font color="#CCCCCC">Barclays phishing page being served by a</font>

55
00:02:15,480 --> 00:02:21,209
website from<font color="#CCCCCC"> Australia</font>

56
00:02:17,099 --> 00:02:23,310
<font color="#E5E5E5">ok so just summarize a rap sheet is</font>

57
00:02:21,209 --> 00:02:26,340
information related to an IP address or

58
00:02:23,310 --> 00:02:28,200
domain which contains proof of

59
00:02:26,340 --> 00:02:30,299
maliciousness and different moments in

60
00:02:28,200 --> 00:02:32,040
time and for which we<font color="#E5E5E5"> are</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> one</font>

61
00:02:30,299 --> 00:02:33,569
<font color="#CCCCCC">hundred</font><font color="#E5E5E5"> percent certainty</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is an</font>

62
00:02:32,040 --> 00:02:35,970
internal objective that we have to

63
00:02:33,569 --> 00:02:38,250
respect all the time<font color="#E5E5E5"> you have another</font>

64
00:02:35,970 --> 00:02:40,409
example rap sheet<font color="#E5E5E5"> it's an IP address we</font>

65
00:02:38,250 --> 00:02:42,780
<font color="#E5E5E5">start to connect one of our</font><font color="#CCCCCC"> SH honey</font>

66
00:02:40,409 --> 00:02:45,629
<font color="#E5E5E5">pots using a</font><font color="#CCCCCC"> commonly-used credentials</font>

67
00:02:42,780 --> 00:02:47,519
<font color="#E5E5E5">one thing to understand we're not doing</font>

68
00:02:45,629 --> 00:02:51,179
any sort of moral<font color="#E5E5E5"> judgment when talking</font>

69
00:02:47,519 --> 00:02:53,489
about maliciousness<font color="#E5E5E5"> so to exemplify</font><font color="#CCCCCC"> I'll</font>

70
00:02:51,180 --> 00:02:55,470
tell you<font color="#E5E5E5"> that we consider malware</font>

71
00:02:53,489 --> 00:02:57,989
exploit kits<font color="#E5E5E5"> but exploiting</font>

72
00:02:55,470 --> 00:03:00,720
vulnerabilities to be dirty<font color="#E5E5E5"> fishing is</font>

73
00:02:57,989 --> 00:03:03,930
dirty but spam important<font color="#CCCCCC"> would</font><font color="#E5E5E5"> consider</font>

74
00:03:00,720 --> 00:03:05,700
to be clean<font color="#E5E5E5"> so with porn for example</font>

75
00:03:03,930 --> 00:03:08,099
it's clearly a matter of morality

76
00:03:05,700 --> 00:03:09,810
whether you like it or not<font color="#E5E5E5"> but you might</font>

77
00:03:08,099 --> 00:03:11,970
say<font color="#E5E5E5"> hey</font><font color="#CCCCCC"> it's time</font><font color="#E5E5E5"> is being used a lot of</font>

78
00:03:09,810 --> 00:03:15,959
propagating<font color="#CCCCCC"> text why are you actually</font>

79
00:03:11,970 --> 00:03:18,690
using<font color="#E5E5E5"> naming it as clean so the reason</font>

80
00:03:15,959 --> 00:03:21,150
is there might be legitimate<font color="#E5E5E5"> services</font>

81
00:03:18,690 --> 00:03:23,040
advertising services out there which are

82
00:03:21,150 --> 00:03:25,349
being abused<font color="#E5E5E5"> to send out malicious</font>

83
00:03:23,040 --> 00:03:27,269
<font color="#CCCCCC">e-mails and</font><font color="#E5E5E5"> we do not want to block</font>

84
00:03:25,349 --> 00:03:29,369
<font color="#E5E5E5">those</font><font color="#CCCCCC"> whether</font><font color="#E5E5E5"> or not they should be</font>

85
00:03:27,269 --> 00:03:31,560
filtering the stuff they send out is

86
00:03:29,370 --> 00:03:39,930
again a discussion of morality

87
00:03:31,560 --> 00:03:41,400
<font color="#CCCCCC">ok so on 23 identification</font><font color="#E5E5E5"> the easiest</font>

88
00:03:39,930 --> 00:03:43,139
way you might have seen if you've ever

89
00:03:41,400 --> 00:03:44,549
looked at presentations about building

90
00:03:43,139 --> 00:03:47,160
<font color="#E5E5E5">through</font><font color="#CCCCCC"> intelligence system is to do</font>

91
00:03:44,549 --> 00:03:50,609
<font color="#E5E5E5">virus scanning</font><font color="#CCCCCC"> so you grab a couple of</font>

92
00:03:47,160 --> 00:03:53,250
80 products you start to collecting some

93
00:03:50,609 --> 00:03:55,680
<font color="#CCCCCC">three</font><font color="#E5E5E5"> intelligence feeds</font><font color="#CCCCCC"> federal urls</font>

94
00:03:53,250 --> 00:03:59,790
and scandium<font color="#E5E5E5"> you will soon start having</font>

95
00:03:55,680 --> 00:04:02,609
detection<font color="#E5E5E5"> as an added part we also have</font>

96
00:03:59,790 --> 00:04:05,608
to do some sort of<font color="#E5E5E5"> detection threshold</font>

97
00:04:02,609 --> 00:04:07,169
<font color="#E5E5E5">so we need</font><font color="#CCCCCC"> at least nav</font><font color="#E5E5E5"> products to</font>

98
00:04:05,609 --> 00:04:09,419
agree before saying that something is

99
00:04:07,169 --> 00:04:10,949
malicious<font color="#CCCCCC"> this is again to lower the</font>

100
00:04:09,419 --> 00:04:13,290
<font color="#E5E5E5">chance of false positives</font>

101
00:04:10,949 --> 00:04:16,769
<font color="#E5E5E5">this is the easiest way to do it and</font>

102
00:04:13,290 --> 00:04:18,690
<font color="#E5E5E5">what we started out doing</font><font color="#CCCCCC"> but it has a</font>

103
00:04:16,769 --> 00:04:20,430
downside<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> basically relying on</font>

104
00:04:18,690 --> 00:04:23,900
someone else's judgment

105
00:04:20,430 --> 00:04:26,360
<font color="#E5E5E5">ideally we wouldn't want to do that</font>

106
00:04:23,900 --> 00:04:30,590
<font color="#E5E5E5">so we have to do some work of our own</font>

107
00:04:26,360 --> 00:04:32,120
part of this is done by static analysis

108
00:04:30,590 --> 00:04:34,130
if you're<font color="#E5E5E5"> unfamiliar with it static</font>

109
00:04:32,120 --> 00:04:37,039
analysis because<font color="#E5E5E5"> we're not executing</font>

110
00:04:34,130 --> 00:04:39,080
malware<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> simply looking at it as a</font>

111
00:04:37,039 --> 00:04:41,000
long byte<font color="#CCCCCC"> strings</font><font color="#E5E5E5"> and trying to search</font>

112
00:04:39,080 --> 00:04:43,460
for interesting artifacts<font color="#CCCCCC"> ok so we have</font>

113
00:04:41,000 --> 00:04:45,320
<font color="#E5E5E5">a function</font><font color="#CCCCCC"> named sections and 2p</font>

114
00:04:43,460 --> 00:04:48,258
certificates all sorts of stuff

115
00:04:45,320 --> 00:04:49,940
interesting strings<font color="#CCCCCC"> so if I</font><font color="#E5E5E5"> find the</font>

116
00:04:48,259 --> 00:04:51,680
children's game and find the string

117
00:04:49,940 --> 00:04:52,789
<font color="#CCCCCC">maquettes</font><font color="#E5E5E5"> inside</font><font color="#CCCCCC"> they want to swim is</font>

118
00:04:51,680 --> 00:04:55,340
the name of a character in the game

119
00:04:52,789 --> 00:04:58,280
right<font color="#E5E5E5"> and he tried to gather as much</font>

120
00:04:55,340 --> 00:04:59,719
Intel in the binary<font color="#E5E5E5"> some examples on the</font>

121
00:04:58,280 --> 00:05:02,690
slide you can see the first one that

122
00:04:59,720 --> 00:05:04,699
says<font color="#E5E5E5"> extra strings so those are names of</font>

123
00:05:02,690 --> 00:05:06,860
<font color="#CCCCCC">windows cryptography functions which</font>

124
00:05:04,699 --> 00:05:10,850
have been<font color="#E5E5E5"> obfuscating using</font><font color="#CCCCCC"> X or</font>

125
00:05:06,860 --> 00:05:13,250
encryption so that's<font color="#CCCCCC"> shady at least the</font>

126
00:05:10,850 --> 00:05:15,860
other<font color="#CCCCCC"> one says ni hav so it's searching</font>

127
00:05:13,250 --> 00:05:17,870
for commonly known<font color="#CCCCCC"> as security products</font>

128
00:05:15,860 --> 00:05:22,130
probably<font color="#CCCCCC"> to disable or bypass we don't</font>

129
00:05:17,870 --> 00:05:24,410
get to know and the third rectangle is a

130
00:05:22,130 --> 00:05:27,500
part of<font color="#CCCCCC"> an enforced dealer</font><font color="#E5E5E5"> which is</font>

131
00:05:24,410 --> 00:05:28,910
trying to harvest credentials from the

132
00:05:27,500 --> 00:05:32,660
four major browser right

133
00:05:28,910 --> 00:05:34,699
<font color="#CCCCCC">mozilla</font><font color="#E5E5E5"> chrome</font><font color="#CCCCCC"> they're all in</font><font color="#E5E5E5"> there now</font>

134
00:05:32,660 --> 00:05:36,860
we know they're showing<font color="#E5E5E5"> interest for the</font>

135
00:05:34,699 --> 00:05:38,599
<font color="#E5E5E5">these things using static analysis but</font>

136
00:05:36,860 --> 00:05:41,630
we don't have<font color="#E5E5E5"> one</font><font color="#CCCCCC"> hundred percent proof</font>

137
00:05:38,599 --> 00:05:44,060
<font color="#E5E5E5">so to do that we have to do dynamic</font>

138
00:05:41,630 --> 00:05:47,539
analysis actually executing the binary

139
00:05:44,060 --> 00:05:49,669
<font color="#E5E5E5">in a</font><font color="#CCCCCC"> sin</font><font color="#E5E5E5"> but we used</font><font color="#CCCCCC"> cool sandbox to set</font>

140
00:05:47,539 --> 00:05:51,860
things up<font color="#CCCCCC"> when it's a great project</font><font color="#E5E5E5"> it's</font>

141
00:05:49,669 --> 00:05:53,000
<font color="#CCCCCC">open source i highly</font><font color="#E5E5E5"> recommend you try</font>

142
00:05:51,860 --> 00:05:54,889
it if you want to do something

143
00:05:53,000 --> 00:05:59,720
intelligence research of your own<font color="#E5E5E5"> and</font>

144
00:05:54,889 --> 00:06:02,120
<font color="#E5E5E5">sandboxing you we quickly learned that</font>

145
00:05:59,720 --> 00:06:04,430
you have to do some sort of<font color="#CCCCCC"> EMR</font><font color="#E5E5E5"> sandbox</font>

146
00:06:02,120 --> 00:06:07,159
hardening<font color="#CCCCCC"> so</font><font color="#E5E5E5"> it's not hardening as in</font>

147
00:06:04,430 --> 00:06:09,979
protecting against exploits with<font color="#CCCCCC"> hurling</font>

148
00:06:07,159 --> 00:06:12,110
it against the malware which tries to

149
00:06:09,979 --> 00:06:14,360
detect<font color="#CCCCCC"> its being analyzed and</font><font color="#E5E5E5"> stop its</font>

150
00:06:12,110 --> 00:06:15,860
execution<font color="#CCCCCC"> so you have to convince it is</font>

151
00:06:14,360 --> 00:06:16,789
running in a real environment and not

152
00:06:15,860 --> 00:06:19,520
analysis

153
00:06:16,789 --> 00:06:19,969
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> cool does that some of this work for</font>

154
00:06:19,520 --> 00:06:21,289
you

155
00:06:19,970 --> 00:06:23,389
you also have to do some of your own

156
00:06:21,289 --> 00:06:26,990
because<font color="#E5E5E5"> malware creators know about cool</font>

157
00:06:23,389 --> 00:06:28,729
you<font color="#E5E5E5"> want to ask why use</font><font color="#CCCCCC"> vm</font><font color="#E5E5E5"> if they're</font>

158
00:06:26,990 --> 00:06:30,320
easy to spot<font color="#E5E5E5"> the reason is that they're</font>

159
00:06:28,729 --> 00:06:32,779
also easy to<font color="#CCCCCC"> riverton we use</font>

160
00:06:30,320 --> 00:06:34,969
<font color="#E5E5E5">alternatively you could execute on</font><font color="#CCCCCC"> bare</font>

161
00:06:32,779 --> 00:06:37,030
<font color="#CCCCCC">bones hardware</font><font color="#E5E5E5"> but you would have very</font>

162
00:06:34,969 --> 00:06:39,430
slow<font color="#CCCCCC"> cleanup so</font><font color="#E5E5E5"> it's not</font>

163
00:06:37,030 --> 00:06:41,530
<font color="#E5E5E5">magnitude of</font><font color="#CCCCCC"> hours like cleaning up</font>

164
00:06:39,430 --> 00:06:44,200
windows experience to be when you<font color="#CCCCCC"> had vs</font>

165
00:06:41,530 --> 00:06:47,859
<font color="#E5E5E5">but it's</font><font color="#CCCCCC"> still</font><font color="#E5E5E5"> too slow for an automated</font>

166
00:06:44,200 --> 00:06:50,260
environment<font color="#E5E5E5"> so we have execution we</font>

167
00:06:47,860 --> 00:06:52,660
started analyzing<font color="#E5E5E5"> behavior to give them</font>

168
00:06:50,260 --> 00:06:54,909
our helping hand you also want to add

169
00:06:52,660 --> 00:06:57,400
some honey on your machine

170
00:06:54,910 --> 00:07:00,220
<font color="#CCCCCC">ok by installing</font><font color="#E5E5E5"> applications may be</font>

171
00:06:57,400 --> 00:07:02,530
vulnerable versions of applications by

172
00:07:00,220 --> 00:07:04,390
leaving some fake documents lying around

173
00:07:02,530 --> 00:07:07,270
<font color="#CCCCCC">take financials anything they might be</font>

174
00:07:04,390 --> 00:07:09,190
interesting in exfiltrating<font color="#E5E5E5"> then you</font>

175
00:07:07,270 --> 00:07:10,659
start grabbing<font color="#CCCCCC"> Intel and you will find a</font>

176
00:07:09,190 --> 00:07:13,120
lot of<font color="#CCCCCC"> attention</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> will find</font><font color="#E5E5E5"> drop</font>

177
00:07:10,660 --> 00:07:16,210
files you will find the<font color="#CCCCCC"> ip's</font><font color="#E5E5E5"> contacted</font>

178
00:07:13,120 --> 00:07:20,050
<font color="#CCCCCC">ip's botnet cnc</font><font color="#E5E5E5"> and all the actions that</font>

179
00:07:16,210 --> 00:07:22,180
<font color="#CCCCCC">took</font><font color="#E5E5E5"> so as you might imagine dynamic</font>

180
00:07:20,050 --> 00:07:24,400
analysis offers great power<font color="#E5E5E5"> when doing</font>

181
00:07:22,180 --> 00:07:26,440
this<font color="#E5E5E5"> and as the old saying goes with</font>

182
00:07:24,400 --> 00:07:30,219
great<font color="#E5E5E5"> powers come</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> responsibilities</font>

183
00:07:26,440 --> 00:07:31,930
right because you are executing<font color="#E5E5E5"> malware</font>

184
00:07:30,220 --> 00:07:34,240
and<font color="#E5E5E5"> you would like to prevent something</font>

185
00:07:31,930 --> 00:07:36,340
from happening so it's nice not to spend

186
00:07:34,240 --> 00:07:38,560
<font color="#CCCCCC">mothers</font><font color="#E5E5E5"> because overloading the internet</font>

187
00:07:36,340 --> 00:07:40,210
is not very nice<font color="#E5E5E5"> if you don't care about</font>

188
00:07:38,560 --> 00:07:41,920
the<font color="#CCCCCC"> niceness</font><font color="#E5E5E5"> thing just think that</font>

189
00:07:40,210 --> 00:07:43,390
gathering spam is useful for<font color="#CCCCCC"> three</font>

190
00:07:41,920 --> 00:07:45,730
<font color="#E5E5E5">intelligence it</font><font color="#CCCCCC"> cannot for a lot of</font>

191
00:07:43,390 --> 00:07:48,280
insight<font color="#E5E5E5"> you also don't want to</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> the</font>

192
00:07:45,730 --> 00:07:50,470
<font color="#CCCCCC">OS others</font><font color="#E5E5E5"> so some people might say hey</font>

193
00:07:48,280 --> 00:07:52,359
<font color="#E5E5E5">I'm just</font><font color="#CCCCCC"> going to buy 1000</font><font color="#E5E5E5"> IOT devices</font>

194
00:07:50,470 --> 00:07:53,530
<font color="#E5E5E5">hook them up to the</font><font color="#CCCCCC"> internet run malware</font>

195
00:07:52,360 --> 00:07:55,120
and see what happens

196
00:07:53,530 --> 00:07:56,590
<font color="#E5E5E5">and the next time</font><font color="#CCCCCC"> the country gets</font>

197
00:07:55,120 --> 00:07:59,230
knocked<font color="#CCCCCC"> off the internet you know</font><font color="#E5E5E5"> who's</font>

198
00:07:56,590 --> 00:08:01,090
<font color="#E5E5E5">to blame you also don't want to</font>

199
00:07:59,230 --> 00:08:03,520
<font color="#CCCCCC">brute-force credentials for other</font>

200
00:08:01,090 --> 00:08:05,200
websites infect other people and this is

201
00:08:03,520 --> 00:08:08,620
all<font color="#E5E5E5"> sometimes easier said than done</font>

202
00:08:05,200 --> 00:08:10,300
because<font color="#E5E5E5"> you need to build</font><font color="#CCCCCC"> the large cage</font>

203
00:08:08,620 --> 00:08:11,860
around<font color="#CCCCCC"> your</font><font color="#E5E5E5"> environment to block these</font>

204
00:08:10,300 --> 00:08:13,810
things but you also want to create

205
00:08:11,860 --> 00:08:15,700
something like<font color="#E5E5E5"> a cozy home for malware</font>

206
00:08:13,810 --> 00:08:18,910
to feel safe and<font color="#CCCCCC"> they're all it's</font>

207
00:08:15,700 --> 00:08:21,310
malicious<font color="#CCCCCC"> building right so this</font><font color="#E5E5E5"> is an</font>

208
00:08:18,910 --> 00:08:25,570
ongoing process that requires a lot of

209
00:08:21,310 --> 00:08:27,550
constant monitoring and evaluation<font color="#E5E5E5"> so</font>

210
00:08:25,570 --> 00:08:29,740
this was talking about the<font color="#CCCCCC"> client-side</font>

211
00:08:27,550 --> 00:08:32,650
<font color="#CCCCCC">we also have a the servers that</font>

212
00:08:29,740 --> 00:08:34,900
<font color="#CCCCCC">public-facing</font><font color="#E5E5E5"> services to consider and</font>

213
00:08:32,650 --> 00:08:36,579
for those we<font color="#CCCCCC"> use honey pots</font><font color="#E5E5E5"> probably</font>

214
00:08:34,900 --> 00:08:38,260
<font color="#E5E5E5">people have heard of</font><font color="#CCCCCC"> annika honey pots</font>

215
00:08:36,580 --> 00:08:41,410
<font color="#CCCCCC">were</font><font color="#E5E5E5"> using low interaction honey pots</font>

216
00:08:38,260 --> 00:08:44,710
which mimic<font color="#E5E5E5"> legitimate services such as</font>

217
00:08:41,409 --> 00:08:47,920
diarrhea which is an SMB SQL<font color="#CCCCCC"> ftp and</font>

218
00:08:44,710 --> 00:08:50,070
multiple services<font color="#CCCCCC"> we part keeper and</font>

219
00:08:47,920 --> 00:08:52,290
curry<font color="#CCCCCC"> 4s agent telnet to</font><font color="#E5E5E5"> go</font>

220
00:08:50,070 --> 00:08:54,210
stop<font color="#E5E5E5"> here for web exploits and others</font>

221
00:08:52,290 --> 00:08:56,939
<font color="#CCCCCC">lot of great projects i don't have</font>

222
00:08:54,210 --> 00:08:59,340
enough time to name<font color="#E5E5E5"> the mall and ideally</font>

223
00:08:56,940 --> 00:09:00,930
the best way to<font color="#CCCCCC"> get as much intelligence</font>

224
00:08:59,340 --> 00:09:02,790
<font color="#E5E5E5">as possible you want to do some</font>

225
00:09:00,930 --> 00:09:04,260
<font color="#CCCCCC">globe-trotting want to deploy on</font>

226
00:09:02,790 --> 00:09:05,849
different continents<font color="#CCCCCC"> in different</font>

227
00:09:04,260 --> 00:09:07,590
countries<font color="#E5E5E5"> and a lot of different</font>

228
00:09:05,850 --> 00:09:10,230
providers and you will quickly learn

229
00:09:07,590 --> 00:09:12,180
that this becomes<font color="#E5E5E5"> her to administer</font>

230
00:09:10,230 --> 00:09:15,090
because everyone is using a different

231
00:09:12,180 --> 00:09:16,650
sort of the<font color="#CCCCCC"> end template different basic</font>

232
00:09:15,090 --> 00:09:20,550
operating system and you start having

233
00:09:16,650 --> 00:09:22,680
issues<font color="#CCCCCC"> deploying your system</font><font color="#E5E5E5"> so to solve</font>

234
00:09:20,550 --> 00:09:25,410
this we<font color="#E5E5E5"> take a page from the</font><font color="#CCCCCC"> enemy's</font>

235
00:09:22,680 --> 00:09:28,170
playbook<font color="#E5E5E5"> and we said hey if they can</font>

236
00:09:25,410 --> 00:09:30,060
<font color="#CCCCCC">fast flux their CNC servers we should</font>

237
00:09:28,170 --> 00:09:32,579
<font color="#E5E5E5">definitely be able to process your honey</font>

238
00:09:30,060 --> 00:09:34,290
pots so<font color="#E5E5E5"> processing machines as we call</font>

239
00:09:32,580 --> 00:09:36,810
them are likely to machines which only

240
00:09:34,290 --> 00:09:39,180
do<font color="#E5E5E5"> traffic redirection towards the real</font>

241
00:09:36,810 --> 00:09:41,160
honey pots<font color="#E5E5E5"> in the back</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> they're easy</font>

242
00:09:39,180 --> 00:09:43,050
<font color="#E5E5E5">to deploy very fast they don't have</font>

243
00:09:41,160 --> 00:09:45,030
dependency<font color="#CCCCCC"> always issues they're just</font>

244
00:09:43,050 --> 00:09:47,339
<font color="#E5E5E5">firewall rules right</font>

245
00:09:45,030 --> 00:09:50,040
also on the<font color="#CCCCCC"> easy to deploy bar just</font>

246
00:09:47,340 --> 00:09:52,110
<font color="#CCCCCC">bring</font><font color="#E5E5E5"> iptables and that's it</font>

247
00:09:50,040 --> 00:09:55,680
<font color="#E5E5E5">yeah that's the main thing they're doing</font>

248
00:09:52,110 --> 00:09:57,840
<font color="#E5E5E5">this also solves another issue of</font>

249
00:09:55,680 --> 00:09:59,699
<font color="#CCCCCC">honeypot blacklisting so if at one point</font>

250
00:09:57,840 --> 00:10:01,740
you see you don't have any more traffic

251
00:09:59,700 --> 00:10:03,780
on one box because<font color="#E5E5E5"> it's been black</font>

252
00:10:01,740 --> 00:10:05,370
listed as a<font color="#E5E5E5"> honeypot</font><font color="#CCCCCC"> you just</font><font color="#E5E5E5"> take it</font>

253
00:10:03,780 --> 00:10:06,750
quickly<font color="#E5E5E5"> deploy another part of the</font>

254
00:10:05,370 --> 00:10:09,660
<font color="#E5E5E5">internet and you're done</font>

255
00:10:06,750 --> 00:10:10,980
so you're using just one jar which is

256
00:10:09,660 --> 00:10:13,860
easy to administer<font color="#CCCCCC"> right the catcher</font>

257
00:10:10,980 --> 00:10:16,470
whole lot of flies and dumping data to

258
00:10:13,860 --> 00:10:18,450
<font color="#CCCCCC">go central</font><font color="#E5E5E5"> repository and</font><font color="#CCCCCC"> our kids will</font>

259
00:10:16,470 --> 00:10:21,030
<font color="#E5E5E5">also have one more issue to consider</font><font color="#CCCCCC"> and</font>

260
00:10:18,450 --> 00:10:23,730
that is false positives because<font color="#E5E5E5"> internet</font>

261
00:10:21,030 --> 00:10:25,890
traffic you know will consist of a lot

262
00:10:23,730 --> 00:10:28,500
of scanners<font color="#CCCCCC"> so</font><font color="#E5E5E5"> we consider scanners to</font>

263
00:10:25,890 --> 00:10:30,150
be malicious or not<font color="#CCCCCC"> everything is not</font>

264
00:10:28,500 --> 00:10:31,710
because the if they're not actively

265
00:10:30,150 --> 00:10:33,449
exploited a vulnerability and just

266
00:10:31,710 --> 00:10:36,960
checking for it they're not<font color="#CCCCCC"> necessarily</font>

267
00:10:33,450 --> 00:10:38,580
<font color="#E5E5E5">malicious you have indexing</font><font color="#CCCCCC"> bots</font><font color="#E5E5E5"> real or</font>

268
00:10:36,960 --> 00:10:40,440
<font color="#E5E5E5">fake sometimes you will find the real</font>

269
00:10:38,580 --> 00:10:42,900
<font color="#CCCCCC">google bot sometimes you will find</font>

270
00:10:40,440 --> 00:10:44,640
someone impersonating it again if it's

271
00:10:42,900 --> 00:10:47,069
not doing any active exploitation we can

272
00:10:44,640 --> 00:10:49,410
see it<font color="#CCCCCC"> the it to be non-malicious we</font>

273
00:10:47,070 --> 00:10:51,570
only want to identify attacks and the

274
00:10:49,410 --> 00:10:53,730
best<font color="#E5E5E5"> we found so far is to actually</font>

275
00:10:51,570 --> 00:10:57,130
<font color="#E5E5E5">create signatures for those</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> that's so</font>

276
00:10:53,730 --> 00:10:59,620
more signature work

277
00:10:57,130 --> 00:11:02,290
<font color="#E5E5E5">ok one more</font><font color="#CCCCCC"> thread like</font><font color="#E5E5E5"> to talk about is</font>

278
00:10:59,620 --> 00:11:04,420
<font color="#E5E5E5">fishing</font><font color="#CCCCCC"> your fishing comes in all sizes</font>

279
00:11:02,290 --> 00:11:06,550
flavors colors<font color="#CCCCCC"> whatever you want to</font><font color="#E5E5E5"> call</font>

280
00:11:04,420 --> 00:11:08,020
<font color="#E5E5E5">them whenever there's some sort of major</font>

281
00:11:06,550 --> 00:11:10,870
<font color="#E5E5E5">breach somewhere it started with</font><font color="#CCCCCC"> a</font>

282
00:11:08,020 --> 00:11:12,550
fishing<font color="#E5E5E5"> game so we try our hand at</font>

283
00:11:10,870 --> 00:11:15,370
fishing detection<font color="#E5E5E5"> even though it's a</font>

284
00:11:12,550 --> 00:11:17,349
very difficult problem<font color="#E5E5E5"> and one way to do</font>

285
00:11:15,370 --> 00:11:20,020
it is using static signatures for the

286
00:11:17,350 --> 00:11:23,740
larger targets<font color="#CCCCCC"> out the internet</font><font color="#E5E5E5"> but this</font>

287
00:11:20,020 --> 00:11:25,150
quickly becomes infeasible because there

288
00:11:23,740 --> 00:11:26,980
<font color="#E5E5E5">are a lot of challenges</font><font color="#CCCCCC"> so you have</font>

289
00:11:25,150 --> 00:11:29,140
signature<font color="#E5E5E5"> development first and foremost</font>

290
00:11:26,980 --> 00:11:30,910
you have to create a signature<font color="#E5E5E5"> then you</font>

291
00:11:29,140 --> 00:11:32,230
don't want to have any false positives

292
00:11:30,910 --> 00:11:35,350
which might be a problem because

293
00:11:32,230 --> 00:11:37,450
sometimes you will have<font color="#E5E5E5"> because you will</font>

294
00:11:35,350 --> 00:11:39,970
always match the original page right so

295
00:11:37,450 --> 00:11:41,500
the<font color="#CCCCCC"> patient</font><font color="#E5E5E5"> being cloned sometimes</font><font color="#CCCCCC"> it's</font>

296
00:11:39,970 --> 00:11:43,840
<font color="#E5E5E5">not an issue because we actually found</font>

297
00:11:41,500 --> 00:11:45,280
<font color="#CCCCCC">from</font><font color="#E5E5E5"> people</font><font color="#CCCCCC"> fishing</font><font color="#E5E5E5"> pages of fishing so</font>

298
00:11:43,840 --> 00:11:46,480
they just<font color="#E5E5E5"> closed the</font><font color="#CCCCCC"> phishing page and i</font>

299
00:11:45,280 --> 00:11:48,730
can only<font color="#E5E5E5"> assume the chain goes on</font>

300
00:11:46,480 --> 00:11:51,400
forever<font color="#CCCCCC"> you have</font><font color="#E5E5E5"> to redo them</font>

301
00:11:48,730 --> 00:11:54,580
periodically because the original page

302
00:11:51,400 --> 00:11:56,470
will change from time to time<font color="#E5E5E5"> and you</font>

303
00:11:54,580 --> 00:11:58,870
also have limited detection<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> very</font>

304
00:11:56,470 --> 00:12:01,690
easy to bypass<font color="#CCCCCC"> so it's a page only has</font>

305
00:11:58,870 --> 00:12:03,460
to look<font color="#CCCCCC"> facebook google</font><font color="#E5E5E5"> ish enough to</font>

306
00:12:01,690 --> 00:12:06,340
<font color="#CCCCCC">follow</font><font color="#E5E5E5"> user into inserting his or her</font>

307
00:12:03,460 --> 00:12:08,350
credentials<font color="#E5E5E5"> right or one way of</font><font color="#CCCCCC"> ip's</font>

308
00:12:06,340 --> 00:12:10,840
<font color="#CCCCCC">bypassing them directly just do a</font>

309
00:12:08,350 --> 00:12:12,940
<font color="#E5E5E5">screenshot</font><font color="#CCCCCC"> of the actual pages post</font><font color="#E5E5E5"> an</font>

310
00:12:10,840 --> 00:12:14,080
image there<font color="#CCCCCC"> that will you</font><font color="#E5E5E5"> actually saw</font>

311
00:12:12,940 --> 00:12:18,550
that<font color="#CCCCCC"> in action</font>

312
00:12:14,080 --> 00:12:20,140
one<font color="#E5E5E5"> patient</font><font color="#CCCCCC"> 1414 the side</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> our other</font>

313
00:12:18,550 --> 00:12:22,060
alternative was to create a<font color="#E5E5E5"> generic</font>

314
00:12:20,140 --> 00:12:24,010
method we tried our hand at creating a

315
00:12:22,060 --> 00:12:26,500
machine learning-based<font color="#E5E5E5"> detection</font>

316
00:12:24,010 --> 00:12:28,780
approach we have a framework which

317
00:12:26,500 --> 00:12:30,430
accesses<font color="#E5E5E5"> websites processes the HTML</font>

318
00:12:28,780 --> 00:12:33,910
code and then tries to classify

319
00:12:30,430 --> 00:12:35,949
<font color="#E5E5E5">correctly as fishing</font><font color="#CCCCCC"> or not</font><font color="#E5E5E5"> fishing</font><font color="#CCCCCC"> it</font>

320
00:12:33,910 --> 00:12:37,870
works a better than signature<font color="#CCCCCC"> then</font>

321
00:12:35,950 --> 00:12:40,300
signature-based detection of course but

322
00:12:37,870 --> 00:12:42,880
it also has a problem<font color="#CCCCCC"> false-positive so</font>

323
00:12:40,300 --> 00:12:44,109
it requires a lot of monitoring and we

324
00:12:42,880 --> 00:12:46,150
generally rely on a second opinion

325
00:12:44,110 --> 00:12:46,780
before saying that<font color="#CCCCCC"> our</font><font color="#E5E5E5"> pages</font><font color="#CCCCCC"> fishing or</font>

326
00:12:46,150 --> 00:12:49,360
not

327
00:12:46,780 --> 00:12:52,510
also while<font color="#E5E5E5"> training the fishing engine</font>

328
00:12:49,360 --> 00:12:55,120
we managed to block google access for

329
00:12:52,510 --> 00:12:58,120
the whole<font color="#E5E5E5"> of</font><font color="#CCCCCC"> weeks yet</font><font color="#E5E5E5"> because you need</font>

330
00:12:55,120 --> 00:12:58,930
some<font color="#E5E5E5"> false positives in your training</font>

331
00:12:58,120 --> 00:13:01,360
set

332
00:12:58,930 --> 00:13:03,819
so what better way to get them then

333
00:13:01,360 --> 00:13:07,760
<font color="#CCCCCC">crawled the first 10</font><font color="#E5E5E5"> pages of</font><font color="#CCCCCC"> google for</font>

334
00:13:03,820 --> 00:13:10,190
some search terms

335
00:13:07,760 --> 00:13:12,110
<font color="#CCCCCC">ok so that's about it for the threats we</font>

336
00:13:10,190 --> 00:13:13,490
have more stuff that<font color="#E5E5E5"> we're doing but not</font>

337
00:13:12,110 --> 00:13:15,500
<font color="#CCCCCC">enough time</font><font color="#E5E5E5"> to cover them all</font>

338
00:13:13,490 --> 00:13:17,930
<font color="#E5E5E5">I'd like to talk about one more useful</font>

339
00:13:15,500 --> 00:13:20,510
tool in that is<font color="#E5E5E5"> passive DNS</font><font color="#CCCCCC"> so if you're</font>

340
00:13:17,930 --> 00:13:22,640
familiar with it<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> unfamiliar with</font>

341
00:13:20,510 --> 00:13:24,710
<font color="#E5E5E5">its the</font><font color="#CCCCCC"> passage</font><font color="#E5E5E5"> everything of</font><font color="#CCCCCC"> dns</font>

342
00:13:22,640 --> 00:13:26,540
related data<font color="#E5E5E5"> we could have used the</font>

343
00:13:24,710 --> 00:13:28,700
provider but we decided to build our own

344
00:13:26,540 --> 00:13:31,010
<font color="#E5E5E5">database</font><font color="#CCCCCC"> since we're actually crawling a</font>

345
00:13:28,700 --> 00:13:33,200
whole lot of the internet<font color="#E5E5E5"> so we're</font>

346
00:13:31,010 --> 00:13:35,270
tracking or<font color="#E5E5E5"> hosting</font><font color="#CCCCCC"> is the</font><font color="#E5E5E5"> main IP</font>

347
00:13:33,200 --> 00:13:36,800
<font color="#E5E5E5">address and we found this to be valuable</font>

348
00:13:35,270 --> 00:13:39,650
information that people could probably

349
00:13:36,800 --> 00:13:41,719
use in a<font color="#E5E5E5"> whole lot of different</font>

350
00:13:39,650 --> 00:13:43,490
scenarios<font color="#E5E5E5"> so for example you can do some</font>

351
00:13:41,720 --> 00:13:45,230
sort of<font color="#E5E5E5"> whitelisting since people use</font>

352
00:13:43,490 --> 00:13:47,810
their intelligence to blacklist stuff

353
00:13:45,230 --> 00:13:49,910
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> you might say this has been a</font>

354
00:13:47,810 --> 00:13:51,229
<font color="#E5E5E5">google</font><font color="#CCCCCC"> ID for the</font><font color="#E5E5E5"> past two years I don't</font>

355
00:13:49,910 --> 00:13:53,540
want to risk blocking it because it

356
00:13:51,230 --> 00:13:55,670
appears to be a false positive<font color="#E5E5E5"> you will</font>

357
00:13:53,540 --> 00:13:58,280
have<font color="#E5E5E5"> reoccurrences and</font><font color="#CCCCCC"> the occurrences a</font>

358
00:13:55,670 --> 00:13:59,990
lot of times are caused by having a<font color="#CCCCCC"> for</font>

359
00:13:58,280 --> 00:14:02,449
<font color="#CCCCCC">ladies infected website so they</font><font color="#E5E5E5"> were</font>

360
00:13:59,990 --> 00:14:05,060
<font color="#CCCCCC">there's a malicious I frame it gets</font>

361
00:14:02,450 --> 00:14:07,880
removed<font color="#CCCCCC"> get sad</font><font color="#E5E5E5"> again</font><font color="#CCCCCC"> get some</font><font color="#E5E5E5"> because</font>

362
00:14:05,060 --> 00:14:10,550
<font color="#E5E5E5">people don't always fix the underlying</font>

363
00:14:07,880 --> 00:14:13,640
vulnerabilities<font color="#CCCCCC"> so the website is still</font>

364
00:14:10,550 --> 00:14:15,589
<font color="#CCCCCC">easy to compromise</font><font color="#E5E5E5"> one more thing which</font>

365
00:14:13,640 --> 00:14:17,120
we don't necessarily do but there's a

366
00:14:15,590 --> 00:14:19,010
lot of<font color="#E5E5E5"> interest in</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> think there's</font>

367
00:14:17,120 --> 00:14:21,350
another talking the other track about

368
00:14:19,010 --> 00:14:23,000
this is mapping<font color="#CCCCCC"> threat actors</font><font color="#E5E5E5"> so you can</font>

369
00:14:21,350 --> 00:14:25,580
use all of this data you can also

370
00:14:23,000 --> 00:14:27,860
correlate with binary information with

371
00:14:25,580 --> 00:14:30,080
the public information and then you can

372
00:14:27,860 --> 00:14:32,330
find information about the<font color="#CCCCCC"> thread actor</font>

373
00:14:30,080 --> 00:14:34,670
<font color="#CCCCCC">who is trying to compromise your network</font>

374
00:14:32,330 --> 00:14:37,640
of course you can also use<font color="#E5E5E5"> passive DNS</font>

375
00:14:34,670 --> 00:14:42,410
to find<font color="#CCCCCC"> the new domains to crawl and</font>

376
00:14:37,640 --> 00:14:44,930
scan as well for the system so<font color="#CCCCCC"> okay so</font>

377
00:14:42,410 --> 00:14:47,150
<font color="#E5E5E5">that's about it</font><font color="#CCCCCC"> for me</font><font color="#E5E5E5"> as you might</font>

378
00:14:44,930 --> 00:14:49,790
imagine the system has a lot of moving

379
00:14:47,150 --> 00:14:50,840
components that gathers<font color="#CCCCCC"> out of data this</font>

380
00:14:49,790 --> 00:14:52,969
reason some interesting engineering

381
00:14:50,840 --> 00:14:54,320
challenges which my colleague<font color="#CCCCCC"> drugs will</font>

382
00:14:52,970 --> 00:14:57,530
talk about<font color="#CCCCCC"> next</font>

383
00:14:54,320 --> 00:15:02,540
<font color="#CCCCCC">ok so</font><font color="#E5E5E5"> engineering is up next</font>

384
00:14:57,530 --> 00:15:05,300
let's see so if you take a look of our

385
00:15:02,540 --> 00:15:08,209
system from<font color="#CCCCCC"> our 10,000 miles</font><font color="#E5E5E5"> view</font><font color="#CCCCCC"> you</font>

386
00:15:05,300 --> 00:15:12,589
see that it basically takes in<font color="#CCCCCC"> URLs</font>

387
00:15:08,210 --> 00:15:15,020
<font color="#E5E5E5">binaries and</font><font color="#CCCCCC"> honey pot attacks</font><font color="#E5E5E5"> processes</font>

388
00:15:12,590 --> 00:15:17,810
them<font color="#CCCCCC"> through multiple nodes in the</font>

389
00:15:15,020 --> 00:15:20,300
system and then produces at the end<font color="#E5E5E5"> rap</font>

390
00:15:17,810 --> 00:15:21,180
sheets as well as tracking information

391
00:15:20,300 --> 00:15:23,310
from

392
00:15:21,180 --> 00:15:26,609
<font color="#CCCCCC">four different entities or items within</font>

393
00:15:23,310 --> 00:15:30,810
our system so we track a lot of binary

394
00:15:26,610 --> 00:15:35,280
<font color="#E5E5E5">hashes in the form of</font><font color="#CCCCCC"> sha-256 hashes</font>

395
00:15:30,810 --> 00:15:37,589
<font color="#E5E5E5">domains</font><font color="#CCCCCC"> eye peas and urls and based on</font>

396
00:15:35,280 --> 00:15:39,540
the information we gather on those for

397
00:15:37,590 --> 00:15:41,640
example for sure we might gather the

398
00:15:39,540 --> 00:15:43,500
detection<font color="#CCCCCC"> is or</font><font color="#E5E5E5"> the static analysis</font>

399
00:15:41,640 --> 00:15:46,680
information<font color="#E5E5E5"> or the dynamic analysis</font>

400
00:15:43,500 --> 00:15:48,690
information or for<font color="#CCCCCC"> domain we might</font>

401
00:15:46,680 --> 00:15:50,310
gather all<font color="#E5E5E5"> of the related</font><font color="#CCCCCC"> eye peas and</font>

402
00:15:48,690 --> 00:15:52,560
other information like that

403
00:15:50,310 --> 00:15:54,329
using this information we create what's

404
00:15:52,560 --> 00:15:56,339
called a rap sheet and you saw an

405
00:15:54,330 --> 00:15:59,910
example earlier<font color="#E5E5E5"> the</font><font color="#CCCCCC"> rap sheet is</font>

406
00:15:56,340 --> 00:16:03,090
basically proof that we have legitimate

407
00:15:59,910 --> 00:16:08,069
reasons to block an IP<font color="#CCCCCC"> okay over</font><font color="#E5E5E5"> there</font>

408
00:16:03,090 --> 00:16:11,550
<font color="#CCCCCC">so the system itself is organized as a</font>

409
00:16:08,070 --> 00:16:14,370
graph of connected nodes where each<font color="#CCCCCC"> note</font>

410
00:16:11,550 --> 00:16:17,130
in the system does one small and

411
00:16:14,370 --> 00:16:20,580
specific thing to analyze what's coming

412
00:16:17,130 --> 00:16:22,680
in so you can think for example as<font color="#E5E5E5"> as an</font>

413
00:16:20,580 --> 00:16:25,140
example of a note<font color="#E5E5E5"> you have the future</font>

414
00:16:22,680 --> 00:16:28,050
<font color="#E5E5E5">which basically takes in the URL and</font>

415
00:16:25,140 --> 00:16:31,680
using<font color="#E5E5E5"> a headless browser</font><font color="#CCCCCC"> I fact is</font>

416
00:16:28,050 --> 00:16:34,800
actually actually<font color="#E5E5E5"> accesses that URL and</font>

417
00:16:31,680 --> 00:16:37,709
retrieves the contents of it and stores

418
00:16:34,800 --> 00:16:42,569
that for later scanning<font color="#E5E5E5"> so we</font>

419
00:16:37,710 --> 00:16:44,610
periodically<font color="#CCCCCC"> a</font><font color="#E5E5E5"> crawl different</font><font color="#CCCCCC"> French</font>

420
00:16:42,570 --> 00:16:47,580
intelligence<font color="#E5E5E5"> feeds both private private</font>

421
00:16:44,610 --> 00:16:51,150
public and our own feeds<font color="#CCCCCC"> gather from</font>

422
00:16:47,580 --> 00:16:53,250
spam and using those<font color="#CCCCCC"> URLs you will fetch</font>

423
00:16:51,150 --> 00:16:56,040
<font color="#E5E5E5">them we store their contents and then</font>

424
00:16:53,250 --> 00:16:58,290
<font color="#CCCCCC">analyze them using Navy's dynamic</font>

425
00:16:56,040 --> 00:17:00,959
analysis static analysis<font color="#E5E5E5"> fishing</font>

426
00:16:58,290 --> 00:17:04,020
scanners as<font color="#CCCCCC"> Adrian stock as well as a</font>

427
00:17:00,960 --> 00:17:05,790
whole host of other<font color="#E5E5E5"> component and all of</font>

428
00:17:04,020 --> 00:17:09,480
these components are tied together in

429
00:17:05,790 --> 00:17:11,730
<font color="#CCCCCC">the graph</font><font color="#E5E5E5"> each component does its own</font>

430
00:17:09,480 --> 00:17:14,730
specific thing it takes<font color="#CCCCCC"> some</font><font color="#E5E5E5"> input and</font>

431
00:17:11,730 --> 00:17:17,910
produces some output<font color="#E5E5E5"> so some facts about</font>

432
00:17:14,730 --> 00:17:20,250
our system for one<font color="#E5E5E5"> it's a</font><font color="#CCCCCC"> real time</font>

433
00:17:17,910 --> 00:17:22,380
system so as soon as we have enough

434
00:17:20,250 --> 00:17:24,810
information to build a rap sheet we

435
00:17:22,380 --> 00:17:26,790
actually build it and publish it and

436
00:17:24,810 --> 00:17:30,780
this information with the rap sheets

437
00:17:26,790 --> 00:17:33,129
<font color="#E5E5E5">goes into our</font><font color="#CCCCCC"> 4th Armored device for now</font>

438
00:17:30,780 --> 00:17:36,220
and<font color="#CCCCCC"> are</font>

439
00:17:33,130 --> 00:17:38,680
<font color="#E5E5E5">basically clients get protected as soon</font>

440
00:17:36,220 --> 00:17:41,620
as we have information about malicious

441
00:17:38,680 --> 00:17:42,430
<font color="#E5E5E5">IP</font><font color="#CCCCCC"> so the whole system is if you're</font>

442
00:17:41,620 --> 00:17:45,010
familiar

443
00:17:42,430 --> 00:17:48,940
raise your hand if<font color="#E5E5E5"> you're not</font><font color="#CCCCCC"> is based</font>

444
00:17:45,010 --> 00:17:50,980
on the data flow model<font color="#CCCCCC"> so in that each</font>

445
00:17:48,940 --> 00:17:52,720
<font color="#E5E5E5">note as</font><font color="#CCCCCC"> I've said</font><font color="#E5E5E5"> received some input</font>

446
00:17:50,980 --> 00:17:55,120
and produces<font color="#E5E5E5"> an output for example the</font>

447
00:17:52,720 --> 00:17:57,820
<font color="#E5E5E5">fetcher receives URL fetch and produces</font>

448
00:17:55,120 --> 00:18:00,399
<font color="#E5E5E5">fish contents</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> notes themselves are</font>

449
00:17:57,820 --> 00:18:02,560
connected in topology<font color="#CCCCCC"> you can rearrange</font>

450
00:18:00,400 --> 00:18:05,440
<font color="#E5E5E5">the topology</font><font color="#CCCCCC"> however you want you can</font>

451
00:18:02,560 --> 00:18:07,990
reuse the notes however you want<font color="#E5E5E5"> the</font>

452
00:18:05,440 --> 00:18:11,800
notes can also interact with external

453
00:18:07,990 --> 00:18:14,230
services like<font color="#E5E5E5"> databases</font><font color="#CCCCCC"> storage systems</font>

454
00:18:11,800 --> 00:18:16,210
<font color="#E5E5E5">sandbox execution for example we have</font>

455
00:18:14,230 --> 00:18:18,940
something called the sandbox analysis

456
00:18:16,210 --> 00:18:23,440
component which based on information

457
00:18:18,940 --> 00:18:25,540
about the binary<font color="#CCCCCC"> will choose which p.m.</font>

458
00:18:23,440 --> 00:18:30,190
in the sandbox<font color="#E5E5E5"> submitted to</font><font color="#CCCCCC"> so for</font>

459
00:18:25,540 --> 00:18:35,050
example if the file is an android<font color="#CCCCCC"> APK</font><font color="#E5E5E5"> it</font>

460
00:18:30,190 --> 00:18:37,570
will choose a vm for<font color="#CCCCCC"> android or if the</font>

461
00:18:35,050 --> 00:18:40,120
if we've determined by static analysis

462
00:18:37,570 --> 00:18:42,879
that<font color="#E5E5E5"> it's using some specific</font><font color="#CCCCCC"> windows</font>

463
00:18:40,120 --> 00:18:45,760
functions<font color="#E5E5E5"> we will submit</font><font color="#CCCCCC"> that to</font><font color="#E5E5E5"> a vm</font>

464
00:18:42,880 --> 00:18:48,700
running the windows at the specific

465
00:18:45,760 --> 00:18:51,820
version required for those functions

466
00:18:48,700 --> 00:18:53,650
that it's using<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> one more thing to</font>

467
00:18:51,820 --> 00:18:55,360
note you can also have special<font color="#CCCCCC"> notes in</font>

468
00:18:53,650 --> 00:18:57,880
the system<font color="#E5E5E5"> these are knows that</font>

469
00:18:55,360 --> 00:18:59,320
basically<font color="#E5E5E5"> produced only output</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> such</font>

470
00:18:57,880 --> 00:19:02,770
note<font color="#E5E5E5"> in our system is called the</font>

471
00:18:59,320 --> 00:19:04,600
collector which periodically scans of

472
00:19:02,770 --> 00:19:07,930
threat intelligence<font color="#CCCCCC"> speeds for urls and</font>

473
00:19:04,600 --> 00:19:09,939
binaries and pushes them through the

474
00:19:07,930 --> 00:19:13,840
system for scanning<font color="#E5E5E5"> another type of</font>

475
00:19:09,940 --> 00:19:17,440
special note is one that only produces

476
00:19:13,840 --> 00:19:20,020
only receives input<font color="#CCCCCC"> so you can think of</font>

477
00:19:17,440 --> 00:19:22,360
this at the end note that once it has

478
00:19:20,020 --> 00:19:25,840
all the information it aggregates<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the</font>

479
00:19:22,360 --> 00:19:29,590
<font color="#E5E5E5">DB and populates all of our nice little</font>

480
00:19:25,840 --> 00:19:34,360
entities like<font color="#CCCCCC"> IP chars</font><font color="#E5E5E5"> URLs or in</font>

481
00:19:29,590 --> 00:19:36,459
domains<font color="#E5E5E5"> so you might wonder why choose</font>

482
00:19:34,360 --> 00:19:37,479
this specific model in order to build

483
00:19:36,460 --> 00:19:41,860
our system

484
00:19:37,480 --> 00:19:45,190
well for once<font color="#CCCCCC"> arm as I've</font><font color="#E5E5E5"> said each node</font>

485
00:19:41,860 --> 00:19:46,300
does one tiny little thing<font color="#CCCCCC"> so because of</font>

486
00:19:45,190 --> 00:19:48,610
that<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> you</font>

487
00:19:46,300 --> 00:19:51,430
easy to develop and test and iterate

488
00:19:48,610 --> 00:19:53,590
through it<font color="#CCCCCC"> it's also easy to</font><font color="#E5E5E5"> reuse you</font>

489
00:19:51,430 --> 00:19:55,930
can connect the same<font color="#E5E5E5"> note in multiple</font>

490
00:19:53,590 --> 00:19:58,270
places in your system<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it's also</font>

491
00:19:55,930 --> 00:20:00,520
really easy to reason about at the<font color="#E5E5E5"> node</font>

492
00:19:58,270 --> 00:20:02,440
level<font color="#CCCCCC"> it's easy to understand it is</font><font color="#E5E5E5"> its</font>

493
00:20:00,520 --> 00:20:04,060
interaction and when you look at the

494
00:20:02,440 --> 00:20:05,830
whole system apology

495
00:20:04,060 --> 00:20:09,370
<font color="#CCCCCC">you'll understand how the flow of</font>

496
00:20:05,830 --> 00:20:12,370
information works through it and<font color="#E5E5E5"> one</font>

497
00:20:09,370 --> 00:20:14,560
that benefit to this<font color="#E5E5E5"> weekend also auto</font>

498
00:20:12,370 --> 00:20:16,570
document the system so when you look at

499
00:20:14,560 --> 00:20:20,740
the apology you have instant system

500
00:20:16,570 --> 00:20:21,939
documentation<font color="#CCCCCC"> ok arm as i said the</font><font color="#E5E5E5"> notes</font>

501
00:20:20,740 --> 00:20:24,760
<font color="#E5E5E5">can</font><font color="#CCCCCC"> be combined in different ways of</font>

502
00:20:21,940 --> 00:20:26,830
apology 01<font color="#E5E5E5"> more important things is</font>

503
00:20:24,760 --> 00:20:30,250
things are separated like<font color="#E5E5E5"> the</font>

504
00:20:26,830 --> 00:20:32,800
<font color="#E5E5E5">microservices architecture you can scale</font>

505
00:20:30,250 --> 00:20:35,020
<font color="#E5E5E5">notes individually so if you need more</font>

506
00:20:32,800 --> 00:20:37,360
processing power for example for a

507
00:20:35,020 --> 00:20:39,040
detection<font color="#CCCCCC"> for so or for the sandbox you</font>

508
00:20:37,360 --> 00:20:41,080
can just kill that part you don't need

509
00:20:39,040 --> 00:20:44,770
to touch the other parts of the system

510
00:20:41,080 --> 00:20:47,980
<font color="#E5E5E5">since</font><font color="#CCCCCC"> it's a topology</font><font color="#E5E5E5"> new notes can</font>

511
00:20:44,770 --> 00:20:51,700
easily be added<font color="#CCCCCC"> wherever</font><font color="#E5E5E5"> you need them</font>

512
00:20:47,980 --> 00:20:53,980
in<font color="#E5E5E5"> topology and each note can be updated</font>

513
00:20:51,700 --> 00:20:55,750
individually so if you just need to

514
00:20:53,980 --> 00:20:57,280
change something in the future<font color="#E5E5E5"> and the</font>

515
00:20:55,750 --> 00:21:00,880
way<font color="#CCCCCC"> you're fetching</font><font color="#E5E5E5"> girls for example</font>

516
00:20:57,280 --> 00:21:02,710
<font color="#CCCCCC">add a new user</font><font color="#E5E5E5"> agent or a support in the</font>

517
00:21:00,880 --> 00:21:07,120
<font color="#CCCCCC">headers</font><font color="#E5E5E5"> process or something you just</font>

518
00:21:02,710 --> 00:21:09,010
<font color="#E5E5E5">update that specific note</font><font color="#CCCCCC"> so you don't</font>

519
00:21:07,120 --> 00:21:13,449
need to touch<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Otherworld the system</font>

520
00:21:09,010 --> 00:21:16,120
is running<font color="#CCCCCC"> ok so not now that i've</font>

521
00:21:13,450 --> 00:21:19,330
talked about how the system is organized

522
00:21:16,120 --> 00:21:22,389
let's see how we actually store the<font color="#CCCCCC"> our</font>

523
00:21:19,330 --> 00:21:24,429
data so we have two types of data in our

524
00:21:22,390 --> 00:21:27,640
system<font color="#E5E5E5"> one is</font><font color="#CCCCCC"> dog</font><font color="#E5E5E5"> data you can think of</font>

525
00:21:24,430 --> 00:21:29,470
it as the contents of which<font color="#E5E5E5"> URLs packet</font>

526
00:21:27,640 --> 00:21:32,170
capture<font color="#E5E5E5"> dropped files and sandbox</font>

527
00:21:29,470 --> 00:21:35,410
analysis results generated by google

528
00:21:32,170 --> 00:21:37,660
sandbox<font color="#CCCCCC"> screenshots as</font><font color="#E5E5E5"> well as other</font>

529
00:21:35,410 --> 00:21:41,230
types of binary<font color="#E5E5E5"> day that we that flow</font>

530
00:21:37,660 --> 00:21:43,270
for our system for this we use a cloud

531
00:21:41,230 --> 00:21:45,700
storage system currently we're using

532
00:21:43,270 --> 00:21:47,650
<font color="#CCCCCC">Amazon is free but we've also attracted</font>

533
00:21:45,700 --> 00:21:49,360
so that we can easily move to something

534
00:21:47,650 --> 00:21:52,270
else if the need arises

535
00:21:49,360 --> 00:21:54,399
<font color="#E5E5E5">now the other more important part is the</font>

536
00:21:52,270 --> 00:21:56,470
way we store<font color="#CCCCCC"> structure</font><font color="#E5E5E5"> data so for</font>

537
00:21:54,400 --> 00:21:59,620
structured data<font color="#CCCCCC"> this is</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> actual DB</font>

538
00:21:56,470 --> 00:22:02,559
<font color="#E5E5E5">and we're using another sequel</font>

539
00:21:59,620 --> 00:22:06,939
<font color="#CCCCCC">Multi multi be called Durango</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> why</font>

540
00:22:02,559 --> 00:22:09,430
multi-model<font color="#E5E5E5"> it's pretty easy</font><font color="#CCCCCC"> to for it</font>

541
00:22:06,940 --> 00:22:11,890
to<font color="#CCCCCC"> ingest information so you can store</font>

542
00:22:09,430 --> 00:22:14,680
<font color="#CCCCCC">key value pairs can store documents</font>

543
00:22:11,890 --> 00:22:17,800
<font color="#CCCCCC">objects and one more important thing</font>

544
00:22:14,680 --> 00:22:20,620
<font color="#E5E5E5">we're using right now you can have graph</font>

545
00:22:17,800 --> 00:22:22,930
database<font color="#E5E5E5"> graph database basically means</font>

546
00:22:20,620 --> 00:22:25,600
that you can have relationships between

547
00:22:22,930 --> 00:22:27,580
entities in your database and we'll take

548
00:22:25,600 --> 00:22:32,980
a look at our that data model on the

549
00:22:27,580 --> 00:22:35,439
next<font color="#CCCCCC"> slide but for</font><font color="#E5E5E5"> now the main</font>

550
00:22:32,980 --> 00:22:38,290
advantage over angle is that it's really

551
00:22:35,440 --> 00:22:42,790
really flexible so you<font color="#E5E5E5"> it's no</font><font color="#CCCCCC"> sequel</font>

552
00:22:38,290 --> 00:22:45,250
based<font color="#E5E5E5"> you have a stimulus architecture</font>

553
00:22:42,790 --> 00:22:47,230
for it<font color="#E5E5E5"> can just post</font><font color="#CCCCCC"> JSON objects and it</font>

554
00:22:45,250 --> 00:22:50,950
will store them without any hesitation

555
00:22:47,230 --> 00:22:53,679
<font color="#E5E5E5">and this makes it easy to add new fields</font>

556
00:22:50,950 --> 00:22:55,630
and information as you're going on in

557
00:22:53,679 --> 00:23:00,040
developing adding more and more to your

558
00:22:55,630 --> 00:23:03,100
system<font color="#E5E5E5"> and finally you also get the</font>

559
00:23:00,040 --> 00:23:05,530
world of sequel databases so you get a

560
00:23:03,100 --> 00:23:07,600
query language it<font color="#CCCCCC"> in</font><font color="#E5E5E5"> this case it's</font>

561
00:23:05,530 --> 00:23:11,290
called<font color="#CCCCCC"> aql</font><font color="#E5E5E5"> former angle query language</font>

562
00:23:07,600 --> 00:23:16,449
<font color="#CCCCCC">get transactions indexes and joins as</font>

563
00:23:11,290 --> 00:23:19,960
you do<font color="#E5E5E5"> get in a normal</font><font color="#CCCCCC"> DB so as I've</font>

564
00:23:16,450 --> 00:23:23,230
said<font color="#E5E5E5"> we also have our specific data</font><font color="#CCCCCC"> malo</font>

565
00:23:19,960 --> 00:23:26,440
<font color="#E5E5E5">for storing stuff</font><font color="#CCCCCC"> in our DB</font><font color="#E5E5E5"> this is a</font>

566
00:23:23,230 --> 00:23:27,850
<font color="#E5E5E5">high-level overview of</font><font color="#CCCCCC"> vet of</font><font color="#E5E5E5"> course</font>

567
00:23:26,440 --> 00:23:29,980
there are many more entities and

568
00:23:27,850 --> 00:23:33,159
relationships in the database but to get

569
00:23:29,980 --> 00:23:36,610
a picture of how the graph works<font color="#CCCCCC"> we have</font>

570
00:23:33,160 --> 00:23:39,309
four main that these domains<font color="#E5E5E5"> ip's chars</font>

571
00:23:36,610 --> 00:23:42,280
and<font color="#CCCCCC"> urls</font><font color="#E5E5E5"> and we have different</font>

572
00:23:39,309 --> 00:23:44,889
relationships between them<font color="#CCCCCC"> for example a</font>

573
00:23:42,280 --> 00:23:47,230
domain<font color="#E5E5E5"> results</font><font color="#CCCCCC"> in IP</font><font color="#E5E5E5"> right this is one</font>

574
00:23:44,890 --> 00:23:50,740
relationship and this basic relationship

575
00:23:47,230 --> 00:23:54,490
together with a domain is connected to

576
00:23:50,740 --> 00:23:59,050
another domain<font color="#E5E5E5"> for example via and</font><font color="#CCCCCC"> temps</font>

577
00:23:54,490 --> 00:24:01,960
<font color="#CCCCCC">amex or cname</font><font color="#E5E5E5"> entry these two</font>

578
00:23:59,050 --> 00:24:05,110
relationships help<font color="#CCCCCC"> former are passive</font>

579
00:24:01,960 --> 00:24:07,810
DNS system<font color="#E5E5E5"> so you just have</font><font color="#CCCCCC"> to</font>

580
00:24:05,110 --> 00:24:11,500
relationships for every<font color="#E5E5E5"> passive DNS</font>

581
00:24:07,810 --> 00:24:12,850
query you need to answer<font color="#CCCCCC"> our</font><font color="#E5E5E5"> another</font>

582
00:24:11,500 --> 00:24:16,300
relationship of course

583
00:24:12,850 --> 00:24:17,830
is URL fetches to shop<font color="#CCCCCC"> so using this</font>

584
00:24:16,300 --> 00:24:20,680
relationship for example we can

585
00:24:17,830 --> 00:24:23,439
determine all that<font color="#CCCCCC"> URLs that</font><font color="#E5E5E5"> fish</font><font color="#CCCCCC"> was</font>

586
00:24:20,680 --> 00:24:26,770
<font color="#E5E5E5">the particular</font><font color="#CCCCCC"> sharp as well as all of</font>

587
00:24:23,440 --> 00:24:30,280
the<font color="#CCCCCC"> chars generated by</font><font color="#E5E5E5"> an URL</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> also</font>

588
00:24:26,770 --> 00:24:32,800
have<font color="#CCCCCC"> URL redirects to another URL</font><font color="#E5E5E5"> we can</font>

589
00:24:30,280 --> 00:24:34,810
use and<font color="#CCCCCC"> we're currently</font><font color="#E5E5E5"> using this type</font>

590
00:24:32,800 --> 00:24:39,340
of relationship in order to track<font color="#E5E5E5"> URL</font>

591
00:24:34,810 --> 00:24:42,460
redirect<font color="#E5E5E5"> chains to see how</font><font color="#CCCCCC"> you are</font><font color="#E5E5E5"> was</font>

592
00:24:39,340 --> 00:24:46,840
<font color="#CCCCCC">fashioned</font><font color="#E5E5E5"> through what other hearts</font><font color="#CCCCCC"> it</font>

593
00:24:42,460 --> 00:24:48,940
went<font color="#E5E5E5"> through and</font><font color="#CCCCCC"> oh of course between</font>

594
00:24:46,840 --> 00:24:53,350
URL and domain we have the basic

595
00:24:48,940 --> 00:24:56,350
hostname<font color="#E5E5E5"> relationship which you can use</font>

596
00:24:53,350 --> 00:24:59,230
to see for example<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> URLs that were</font>

597
00:24:56,350 --> 00:25:01,959
<font color="#E5E5E5">are known for a specific domain</font>

598
00:24:59,230 --> 00:25:05,770
<font color="#CCCCCC">ok so this is a basic overview of</font><font color="#E5E5E5"> our</font>

599
00:25:01,960 --> 00:25:08,290
main data model looks like<font color="#CCCCCC"> our system</font>

600
00:25:05,770 --> 00:25:10,870
and<font color="#CCCCCC"> its</font><font color="#E5E5E5"> as you can see it's pretty easy</font>

601
00:25:08,290 --> 00:25:13,540
<font color="#CCCCCC">from a</font><font color="#E5E5E5"> security researcher perspective</font>

602
00:25:10,870 --> 00:25:17,290
to understand that right

603
00:25:13,540 --> 00:25:19,540
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> so why choose this particular way of</font>

604
00:25:17,290 --> 00:25:22,000
storing it in the graph for one thing

605
00:25:19,540 --> 00:25:24,310
the graph<font color="#CCCCCC"> maps</font><font color="#E5E5E5"> normal learning problem</font>

606
00:25:22,000 --> 00:25:29,500
domain which of course is the<font color="#E5E5E5"> internet</font>

607
00:25:24,310 --> 00:25:32,500
so if what we're trying to achieve is<font color="#E5E5E5"> a</font>

608
00:25:29,500 --> 00:25:35,740
graph<font color="#CCCCCC"> y not models</font><font color="#E5E5E5"> as a graph so this</font>

609
00:25:32,500 --> 00:25:38,890
<font color="#CCCCCC">let's do a lot of interesting</font><font color="#E5E5E5"> queries</font>

610
00:25:35,740 --> 00:25:40,900
like for example one particular one is

611
00:25:38,890 --> 00:25:44,830
<font color="#CCCCCC">finding your IP is</font><font color="#E5E5E5"> the server specific</font>

612
00:25:40,900 --> 00:25:47,890
shop<font color="#CCCCCC"> so if i have a shy mind which has a</font>

613
00:25:44,830 --> 00:25:50,470
specification<font color="#E5E5E5"> like</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> unknown malware</font>

614
00:25:47,890 --> 00:25:53,680
<font color="#CCCCCC">then i can find all</font><font color="#E5E5E5"> of the</font><font color="#CCCCCC"> eye peas</font><font color="#E5E5E5"> that</font>

615
00:25:50,470 --> 00:25:55,510
<font color="#E5E5E5">are serving it in our database finding</font>

616
00:25:53,680 --> 00:25:58,120
another queries of course finding

617
00:25:55,510 --> 00:26:00,760
<font color="#CCCCCC">redirected domains and for that matter</font>

618
00:25:58,120 --> 00:26:05,139
<font color="#CCCCCC">you are shortening services so we found</font>

619
00:26:00,760 --> 00:26:07,990
that experimentally if for example<font color="#CCCCCC"> arm a</font>

620
00:26:05,140 --> 00:26:10,150
domain has a lot of<font color="#CCCCCC"> URLs that are this</font>

621
00:26:07,990 --> 00:26:13,060
themselves redirecting<font color="#E5E5E5"> to other URLs</font>

622
00:26:10,150 --> 00:26:16,300
<font color="#E5E5E5">then most likely that is an URL</font>

623
00:26:13,060 --> 00:26:18,399
shortening service or it can also be a

624
00:26:16,300 --> 00:26:21,490
compromised<font color="#E5E5E5"> domain</font>

625
00:26:18,400 --> 00:26:24,519
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> another query is finding other</font>

626
00:26:21,490 --> 00:26:28,779
<font color="#CCCCCC">domains sharing the same NS mix</font>

627
00:26:24,519 --> 00:26:31,089
<font color="#E5E5E5">servers and this relates to</font><font color="#CCCCCC"> pasadena</font>

628
00:26:28,779 --> 00:26:33,070
<font color="#CCCCCC">unless</font><font color="#E5E5E5"> of course</font><font color="#CCCCCC"> you can also do the</font>

629
00:26:31,089 --> 00:26:36,070
<font color="#CCCCCC">Pasadena squeeze like finding all the</font>

630
00:26:33,070 --> 00:26:39,249
domains that are hosted on IP and all of

631
00:26:36,070 --> 00:26:41,080
the<font color="#CCCCCC"> ip's connected to a domain so you</font>

632
00:26:39,249 --> 00:26:44,889
can do both queries pretty easy in the

633
00:26:41,080 --> 00:26:48,489
graph and one complicated query and i'll

634
00:26:44,889 --> 00:26:51,070
let you digest this finding<font color="#CCCCCC"> ip's</font><font color="#E5E5E5"> and</font>

635
00:26:48,489 --> 00:26:53,589
domains which served jars which were

636
00:26:51,070 --> 00:26:56,918
dropped by the network analysis by

637
00:26:53,589 --> 00:26:59,918
<font color="#CCCCCC">shards coming from a specific IP so this</font>

638
00:26:56,919 --> 00:27:02,139
<font color="#E5E5E5">is kind of the power</font><font color="#CCCCCC"> get by using</font><font color="#E5E5E5"> a</font>

639
00:26:59,919 --> 00:27:05,499
graph database<font color="#CCCCCC"> at these for Fred</font>

640
00:27:02,139 --> 00:27:06,820
intelligence<font color="#E5E5E5"> and a final reason for</font>

641
00:27:05,499 --> 00:27:09,489
using this model is of course

642
00:27:06,820 --> 00:27:12,249
flexibility you can easily<font color="#CCCCCC"> back on</font><font color="#E5E5E5"> you</font>

643
00:27:09,489 --> 00:27:14,079
information<font color="#E5E5E5"> as well as new entities as</font>

644
00:27:12,249 --> 00:27:19,239
you're developing your<font color="#CCCCCC"> friend</font>

645
00:27:14,079 --> 00:27:22,269
<font color="#E5E5E5">intelligence system</font><font color="#CCCCCC"> 800 weather thing i</font>

646
00:27:19,239 --> 00:27:24,940
would<font color="#E5E5E5"> like to talk about</font><font color="#CCCCCC"> are the way</font>

647
00:27:22,269 --> 00:27:28,299
we're scaling it up<font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is a work in</font>

648
00:27:24,940 --> 00:27:30,669
progress right now<font color="#CCCCCC"> we decided to use</font>

649
00:27:28,299 --> 00:27:31,779
something like data<font color="#E5E5E5"> center OS and the</font>

650
00:27:30,669 --> 00:27:35,649
<font color="#CCCCCC">patching muscles</font>

651
00:27:31,779 --> 00:27:38,200
this lets us<font color="#E5E5E5"> deploy a lot of useful</font>

652
00:27:35,649 --> 00:27:42,158
distributed<font color="#E5E5E5"> services quickly and scale</font>

653
00:27:38,200 --> 00:27:45,339
<font color="#E5E5E5">up our processing quickly so arm every</font>

654
00:27:42,159 --> 00:27:47,469
service in<font color="#CCCCCC"> messages</font><font color="#E5E5E5"> and data</font><font color="#CCCCCC"> centers</font>

655
00:27:45,339 --> 00:27:49,989
gets its own container and you can

656
00:27:47,469 --> 00:27:53,259
easily scale services by defining how

657
00:27:49,989 --> 00:27:57,519
many instances<font color="#E5E5E5"> you'd like to run</font><font color="#CCCCCC"> up that</font>

658
00:27:53,259 --> 00:27:59,649
<font color="#CCCCCC">at of that service and each service each</font>

659
00:27:57,519 --> 00:28:04,089
major service like<font color="#CCCCCC"> read this plastic</font>

660
00:27:59,649 --> 00:28:04,928
surgery<font color="#CCCCCC"> rabbitmq arango BB storm has its</font>

661
00:28:04,089 --> 00:28:08,049
own

662
00:28:04,929 --> 00:28:10,119
let's say monitor for that<font color="#CCCCCC"> diffuse</font>

663
00:28:08,049 --> 00:28:12,158
<font color="#CCCCCC">through service so if an instance of</font>

664
00:28:10,119 --> 00:28:13,958
that service goes down<font color="#E5E5E5"> the monitor will</font>

665
00:28:12,159 --> 00:28:15,669
automatically start a new instance on

666
00:28:13,959 --> 00:28:17,619
the different<font color="#CCCCCC"> Apache message was not</font>

667
00:28:15,669 --> 00:28:21,459
armed

668
00:28:17,619 --> 00:28:23,259
this in order to run on<font color="#E5E5E5"> messages and</font>

669
00:28:21,459 --> 00:28:25,570
<font color="#E5E5E5">data</font><font color="#CCCCCC"> center is</font><font color="#E5E5E5"> you also need to contain</font>

670
00:28:23,259 --> 00:28:27,669
her eyes<font color="#CCCCCC"> you're different components and</font>

671
00:28:25,570 --> 00:28:30,399
right now we have containers for the

672
00:28:27,669 --> 00:28:32,889
fishing<font color="#E5E5E5"> engine the static analysis part</font>

673
00:28:30,399 --> 00:28:35,219
and different other things that we have

674
00:28:32,889 --> 00:28:39,629
in our system or<font color="#E5E5E5"> and</font>

675
00:28:35,220 --> 00:28:40,799
also for the actual graph with the<font color="#CCCCCC"> rated</font>

676
00:28:39,630 --> 00:28:43,919
notes in it

677
00:28:40,799 --> 00:28:46,918
we're planning on using<font color="#E5E5E5"> apache storm so</font>

678
00:28:43,919 --> 00:28:49,890
the<font color="#CCCCCC"> Apache storm framework lets you</font>

679
00:28:46,919 --> 00:28:52,470
specify<font color="#E5E5E5"> that apology directly and you</font>

680
00:28:49,890 --> 00:28:56,190
also get a lot of nice features like

681
00:28:52,470 --> 00:28:59,610
tracking of which<font color="#CCCCCC"> notes in the system</font><font color="#E5E5E5"> a</font>

682
00:28:56,190 --> 00:29:01,770
message went through while processing as

683
00:28:59,610 --> 00:29:04,408
well as for example automatically

684
00:29:01,770 --> 00:29:07,799
<font color="#CCCCCC">retrying processing for a failed message</font>

685
00:29:04,409 --> 00:29:10,169
and other interesting stuff like that

686
00:29:07,799 --> 00:29:11,250
now while developing our system and

687
00:29:10,169 --> 00:29:14,580
scale it up

688
00:29:11,250 --> 00:29:18,480
we found<font color="#CCCCCC"> a lot of interesting principal</font>

689
00:29:14,580 --> 00:29:21,270
<font color="#CCCCCC">SI</font><font color="#E5E5E5"> one of them that was really useful</font>

690
00:29:18,480 --> 00:29:24,090
was putting up the<font color="#CCCCCC"> components so if</font>

691
00:29:21,270 --> 00:29:27,870
you're developing such a system<font color="#CCCCCC"> try</font><font color="#E5E5E5"> and</font>

692
00:29:24,090 --> 00:29:30,928
split<font color="#E5E5E5"> them</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the components</font><font color="#CCCCCC"> of what at</font>

693
00:29:27,870 --> 00:29:33,360
<font color="#E5E5E5">the start</font><font color="#CCCCCC"> so this way you don't end up</font>

694
00:29:30,929 --> 00:29:37,080
with a big<font color="#CCCCCC"> monolith</font><font color="#E5E5E5"> that does everything</font>

695
00:29:33,360 --> 00:29:40,379
<font color="#E5E5E5">and that's really easy really hard to</font>

696
00:29:37,080 --> 00:29:42,330
upgrade update and upgrade<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> another</font>

697
00:29:40,380 --> 00:29:44,520
<font color="#E5E5E5">principle is when you're doing the</font>

698
00:29:42,330 --> 00:29:47,340
components but also split your data

699
00:29:44,520 --> 00:29:50,250
this lets you scale the database for

700
00:29:47,340 --> 00:29:54,899
each component individually for your

701
00:29:50,250 --> 00:29:56,460
needs are<font color="#E5E5E5"> another principle is</font><font color="#CCCCCC"> use a</font>

702
00:29:54,900 --> 00:30:00,090
common<font color="#E5E5E5"> and battle-hardened</font>

703
00:29:56,460 --> 00:30:01,110
infrastructure components of across your

704
00:30:00,090 --> 00:30:06,090
whole system

705
00:30:01,110 --> 00:30:11,639
this means common logging<font color="#E5E5E5"> common or</font>

706
00:30:06,090 --> 00:30:13,408
<font color="#CCCCCC">caching are common message to you so</font>

707
00:30:11,640 --> 00:30:16,620
we're in our system right now we're

708
00:30:13,409 --> 00:30:20,010
using<font color="#CCCCCC"> rabbitmq as a message broker and</font>

709
00:30:16,620 --> 00:30:22,289
let's just say that<font color="#E5E5E5"> at the start of our</font>

710
00:30:20,010 --> 00:30:24,150
system when we were developing<font color="#CCCCCC"> it we had</font>

711
00:30:22,289 --> 00:30:27,210
a lot of<font color="#CCCCCC"> fruits of proof of concept</font>

712
00:30:24,150 --> 00:30:28,980
components that<font color="#CCCCCC"> we're using</font><font color="#E5E5E5"> it in a</font>

713
00:30:27,210 --> 00:30:31,350
slightly different ways and you get

714
00:30:28,980 --> 00:30:32,789
crashes and other stuff by not having

715
00:30:31,350 --> 00:30:37,889
everything<font color="#E5E5E5"> common eyes</font>

716
00:30:32,789 --> 00:30:40,320
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> of the final principle is</font><font color="#CCCCCC"> 0 also</font><font color="#E5E5E5"> when</font>

717
00:30:37,890 --> 00:30:42,960
you're standing up and you have a lot of

718
00:30:40,320 --> 00:30:45,330
things to process is to move the<font color="#E5E5E5"> code</font>

719
00:30:42,960 --> 00:30:47,910
where you have your data<font color="#CCCCCC"> so this was</font>

720
00:30:45,330 --> 00:30:51,449
really apparent in our<font color="#CCCCCC"> past the NSS</font>

721
00:30:47,910 --> 00:30:54,660
some were a lot of<font color="#CCCCCC"> Records come in for</font>

722
00:30:51,450 --> 00:30:57,330
storing the<font color="#E5E5E5"> in a in DB and it's much</font>

723
00:30:54,660 --> 00:31:00,030
more efficient to do batch processing of

724
00:30:57,330 --> 00:31:02,399
them so instead of doing a thousand

725
00:31:00,030 --> 00:31:05,639
insert operations against<font color="#CCCCCC"> the bu just do</font>

726
00:31:02,400 --> 00:31:07,470
one operation and have all<font color="#CCCCCC"> of the</font>

727
00:31:05,640 --> 00:31:11,250
<font color="#E5E5E5">records to be inserted in that specific</font>

728
00:31:07,470 --> 00:31:13,770
operation and then apply the actual<font color="#E5E5E5"> DP</font>

729
00:31:11,250 --> 00:31:16,410
operations and have<font color="#CCCCCC"> them run inside the</font>

730
00:31:13,770 --> 00:31:19,950
DB server

731
00:31:16,410 --> 00:31:22,500
<font color="#CCCCCC">ok so this was it from the injury site</font>

732
00:31:19,950 --> 00:31:26,190
now we're going to take a look at a few

733
00:31:22,500 --> 00:31:28,860
steps we've seen in our system so one

734
00:31:26,190 --> 00:31:32,850
particular start over here is the number

735
00:31:28,860 --> 00:31:35,189
of active rap<font color="#E5E5E5"> sheets still considered</font>

736
00:31:32,850 --> 00:31:40,139
<font color="#E5E5E5">the</font><font color="#CCCCCC"> malicious</font><font color="#E5E5E5"> by H this is basically a</font>

737
00:31:35,190 --> 00:31:44,340
histogram showing how old<font color="#CCCCCC"> r our ip's in</font>

738
00:31:40,140 --> 00:31:47,310
the database right now<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I said active</font>

739
00:31:44,340 --> 00:31:50,490
because we also have a rescan process so

740
00:31:47,310 --> 00:31:54,750
if something is considered malicious

741
00:31:50,490 --> 00:31:58,050
<font color="#CCCCCC">it's kept in the DB and checked daily</font><font color="#E5E5E5"> if</font>

742
00:31:54,750 --> 00:32:00,180
after<font color="#E5E5E5"> one day nothing no new</font><font color="#CCCCCC"> malicious</font>

743
00:31:58,050 --> 00:32:02,250
results come back<font color="#CCCCCC"> it's checked after</font><font color="#E5E5E5"> two</font>

744
00:32:00,180 --> 00:32:06,150
<font color="#E5E5E5">days and then after four and then</font>

745
00:32:02,250 --> 00:32:08,970
finally gets removed from the<font color="#E5E5E5"> DB so this</font>

746
00:32:06,150 --> 00:32:12,990
basically is a histogram of the age of

747
00:32:08,970 --> 00:32:15,390
our active<font color="#E5E5E5"> malicious</font><font color="#CCCCCC"> ip's in the</font>

748
00:32:12,990 --> 00:32:17,670
database<font color="#E5E5E5"> you can see there are a lot of</font>

749
00:32:15,390 --> 00:32:21,750
spice over there<font color="#E5E5E5"> most of them</font>

750
00:32:17,670 --> 00:32:25,080
corresponding to a moment in time where

751
00:32:21,750 --> 00:32:26,460
there was a specific campaign so as you

752
00:32:25,080 --> 00:32:29,550
can see<font color="#E5E5E5"> there are also a lot of</font><font color="#CCCCCC"> VIPs</font>

753
00:32:26,460 --> 00:32:32,940
<font color="#CCCCCC">that</font><font color="#E5E5E5"> our purposes persistent</font><font color="#CCCCCC"> overtime</font><font color="#E5E5E5"> so</font>

754
00:32:29,550 --> 00:32:36,210
we launched our system or<font color="#CCCCCC"> a year and a</font>

755
00:32:32,940 --> 00:32:39,810
half<font color="#CCCCCC"> ago</font><font color="#E5E5E5"> and as you can see we also we</font>

756
00:32:36,210 --> 00:32:43,710
have a few<font color="#CCCCCC"> I peas that</font><font color="#E5E5E5"> are more than 270</font>

757
00:32:39,810 --> 00:32:46,110
days also these<font color="#E5E5E5"> the</font><font color="#CCCCCC"> URLs associated with</font>

758
00:32:43,710 --> 00:32:53,610
those ip's<font color="#CCCCCC"> rate rarely get cleaned up</font>

759
00:32:46,110 --> 00:32:56,340
<font color="#E5E5E5">another step over here is</font><font color="#CCCCCC"> our the listed</font>

760
00:32:53,610 --> 00:32:59,310
<font color="#E5E5E5">iph distribution</font><font color="#CCCCCC"> so these are basically</font>

761
00:32:56,340 --> 00:33:00,840
<font color="#CCCCCC">IPS which</font><font color="#E5E5E5"> were active at one point in</font>

762
00:32:59,310 --> 00:33:04,830
time and then

763
00:33:00,840 --> 00:33:07,049
<font color="#CCCCCC">they became inactive</font><font color="#E5E5E5"> they're not</font><font color="#CCCCCC"> there's</font>

764
00:33:04,830 --> 00:33:09,059
nothing malicious there<font color="#E5E5E5"> anymore</font><font color="#CCCCCC"> as you</font>

765
00:33:07,049 --> 00:33:14,460
<font color="#E5E5E5">can see most of them tend to get the</font>

766
00:33:09,059 --> 00:33:16,710
listed after around 30 days and

767
00:33:14,460 --> 00:33:19,770
afterwards you have a pretty long tail

768
00:33:16,710 --> 00:33:23,309
so as<font color="#E5E5E5"> I as you can see from the previous</font>

769
00:33:19,770 --> 00:33:27,090
graph<font color="#E5E5E5"> we also have</font><font color="#CCCCCC"> ip's</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> it got</font><font color="#E5E5E5"> the</font>

770
00:33:23,309 --> 00:33:31,289
listed as<font color="#E5E5E5"> after 250 days for example</font>

771
00:33:27,090 --> 00:33:33,658
<font color="#CCCCCC">ok so most of them</font><font color="#E5E5E5"> and this makes it a</font>

772
00:33:31,289 --> 00:33:35,940
really dynamic system get listed after

773
00:33:33,659 --> 00:33:42,360
30 days

774
00:33:35,940 --> 00:33:46,110
okay one final<font color="#E5E5E5"> step</font><font color="#CCCCCC"> and that is the</font>

775
00:33:42,360 --> 00:33:48,750
malicious IP addresses<font color="#CCCCCC"> by country so you</font>

776
00:33:46,110 --> 00:33:50,789
most likely recognize this<font color="#CCCCCC"> we have the</font>

777
00:33:48,750 --> 00:33:53,340
usual suspect this is based on the top

778
00:33:50,789 --> 00:33:55,980
<font color="#E5E5E5">20 countries in our database</font><font color="#CCCCCC"> so the</font>

779
00:33:53,340 --> 00:33:58,709
usual suspects are<font color="#CCCCCC"> US China Germany and</font>

780
00:33:55,980 --> 00:34:00,510
you<font color="#E5E5E5"> as you'd</font><font color="#CCCCCC"> expect that because</font><font color="#E5E5E5"> the</font>

781
00:33:58,710 --> 00:34:03,059
<font color="#CCCCCC">these are the</font><font color="#E5E5E5"> countries that also have</font>

782
00:34:00,510 --> 00:34:06,510
the most IP ranges<font color="#E5E5E5"> associated with them</font>

783
00:34:03,059 --> 00:34:08,969
so it's<font color="#E5E5E5"> normal that attackers will use</font>

784
00:34:06,510 --> 00:34:11,219
<font color="#CCCCCC">iips from though lot of VIPs</font><font color="#E5E5E5"> from those</font>

785
00:34:08,969 --> 00:34:15,089
<font color="#E5E5E5">but we also get some surprising results</font>

786
00:34:11,219 --> 00:34:18,779
in the form of<font color="#E5E5E5"> Vietnam</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> Indonesia</font>

787
00:34:15,089 --> 00:34:22,560
which have<font color="#CCCCCC"> few IP ranges but</font><font color="#E5E5E5"> continued</font>

788
00:34:18,780 --> 00:34:27,659
<font color="#E5E5E5">quite a bit of but most of quite a lot</font>

789
00:34:22,560 --> 00:34:31,290
of them are malicious<font color="#CCCCCC"> ok so that was</font>

790
00:34:27,659 --> 00:34:32,730
<font color="#CCCCCC">that if you guys have any questions or</font>

791
00:34:31,290 --> 00:34:41,980
comments for us

792
00:34:32,730 --> 00:34:45,699
related to<font color="#CCCCCC"> ok</font>

793
00:34:41,980 --> 00:34:48,040
<font color="#E5E5E5">thank you very much have a question when</font>

794
00:34:45,699 --> 00:34:50,678
you say malicious<font color="#CCCCCC"> IP</font><font color="#E5E5E5"> is what what are</font>

795
00:34:48,040 --> 00:34:53,560
they like sandbox<font color="#E5E5E5"> things that are in</font>

796
00:34:50,679 --> 00:34:55,750
<font color="#CCCCCC">Stokes or malicious</font><font color="#E5E5E5"> basically means we</font>

797
00:34:53,560 --> 00:34:57,940
have proof they<font color="#E5E5E5"> that they're</font>

798
00:34:55,750 --> 00:35:00,760
<font color="#E5E5E5">entertaining most effective for example</font>

799
00:34:57,940 --> 00:35:03,040
<font color="#E5E5E5">they're serving</font><font color="#CCCCCC"> URLs with</font><font color="#E5E5E5"> malware on</font>

800
00:35:00,760 --> 00:35:05,470
them or<font color="#CCCCCC"> their part</font><font color="#E5E5E5"> of a botnet or</font>

801
00:35:03,040 --> 00:35:07,390
they're serving phishing pages<font color="#E5E5E5"> or</font>

802
00:35:05,470 --> 00:35:09,819
<font color="#E5E5E5">they're trying to actively</font><font color="#CCCCCC"> exploited</font>

803
00:35:07,390 --> 00:35:10,990
<font color="#E5E5E5">servers yeah like touching honey pots</font>

804
00:35:09,820 --> 00:35:23,430
with malicious behavior

805
00:35:10,990 --> 00:35:27,000
let me just<font color="#CCCCCC"> get to</font><font color="#E5E5E5"> the slide on that</font>

806
00:35:23,430 --> 00:35:29,190
<font color="#E5E5E5">so this is what we consider malicious so</font>

807
00:35:27,000 --> 00:35:31,589
if they're serving more than their

808
00:35:29,190 --> 00:35:33,900
malicious<font color="#E5E5E5"> if a</font><font color="#CCCCCC"> honey pot</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> ours</font>

809
00:35:31,589 --> 00:35:36,960
<font color="#CCCCCC">received the</font><font color="#E5E5E5"> next play from them then</font>

810
00:35:33,900 --> 00:35:40,859
those<font color="#CCCCCC"> ip's</font><font color="#E5E5E5"> our missions as well</font><font color="#CCCCCC"> if a</font>

811
00:35:36,960 --> 00:35:42,780
botnet samples tried from within our

812
00:35:40,859 --> 00:35:45,058
<font color="#E5E5E5">sandbox to communicate with them using</font>

813
00:35:42,780 --> 00:35:48,059
the<font color="#CCCCCC"> botnets CSE protocol then they're</font>

814
00:35:45,059 --> 00:35:50,490
considered<font color="#E5E5E5"> malicious and if they served</font>

815
00:35:48,059 --> 00:35:52,410
<font color="#E5E5E5">phishing pages then</font><font color="#CCCCCC"> their presentations</font>

816
00:35:50,490 --> 00:35:56,009
as well<font color="#CCCCCC"> so we have four main categories</font>

817
00:35:52,410 --> 00:35:58,170
right now we can also add<font color="#CCCCCC"> a fifth one</font>

818
00:35:56,010 --> 00:35:59,490
for example if they redirect to a

819
00:35:58,170 --> 00:36:02,819
malicious URL

820
00:35:59,490 --> 00:36:06,808
<font color="#E5E5E5">yes we have another question which is</font>

821
00:36:02,819 --> 00:36:09,420
how<font color="#E5E5E5"> to handle alone malicious</font><font color="#CCCCCC"> eye peas</font>

822
00:36:06,809 --> 00:36:12,510
<font color="#CCCCCC">are compromised</font><font color="#E5E5E5"> you consider them</font>

823
00:36:09,420 --> 00:36:15,750
infected or clean or do have a<font color="#CCCCCC"> sport so</font>

824
00:36:12,510 --> 00:36:18,540
if that particular<font color="#E5E5E5"> IP is compromised</font>

825
00:36:15,750 --> 00:36:22,109
then we consider that infected<font color="#CCCCCC"> but you</font>

826
00:36:18,540 --> 00:36:24,869
can also have the scenario in which you

827
00:36:22,109 --> 00:36:28,470
have multiple domains on a specific IP

828
00:36:24,869 --> 00:36:31,890
<font color="#E5E5E5">in that particular case we only consider</font>

829
00:36:28,470 --> 00:36:34,589
the<font color="#E5E5E5"> militias domains to be blocked so in</font>

830
00:36:31,890 --> 00:36:38,129
the actual device<font color="#E5E5E5"> that's using all of</font>

831
00:36:34,589 --> 00:36:39,690
this data were collecting the decision

832
00:36:38,130 --> 00:36:42,210
is made

833
00:36:39,690 --> 00:36:44,760
first on the IP and if the IP host

834
00:36:42,210 --> 00:36:47,849
multiple domain of thing which we<font color="#E5E5E5"> are</font>

835
00:36:44,760 --> 00:36:51,240
<font color="#E5E5E5">generally</font><font color="#CCCCCC"> deduct by using passive DNS</font>

836
00:36:47,849 --> 00:36:54,390
<font color="#E5E5E5">then we only block the</font><font color="#CCCCCC"> militias</font><font color="#E5E5E5"> domains</font>

837
00:36:51,240 --> 00:36:56,729
so we at the the device that<font color="#E5E5E5"> then</font>

838
00:36:54,390 --> 00:37:00,210
actually does the packet inspection and

839
00:36:56,730 --> 00:37:08,790
looks at the<font color="#E5E5E5"> hostname any other</font>

840
00:37:00,210 --> 00:37:13,800
questions

841
00:37:08,790 --> 00:37:15,600
<font color="#E5E5E5">so</font><font color="#CCCCCC"> okay I</font><font color="#E5E5E5"> have heard so if we share the</font>

842
00:37:13,800 --> 00:37:18,360
information right<font color="#E5E5E5"> so</font>

843
00:37:15,600 --> 00:37:20,880
<font color="#E5E5E5">oh yes</font><font color="#CCCCCC"> we're trying to build</font>

844
00:37:18,360 --> 00:37:24,240
collaborations for example with

845
00:37:20,880 --> 00:37:27,870
<font color="#E5E5E5">virustotal or reversing labs and</font>

846
00:37:24,240 --> 00:37:33,419
<font color="#CCCCCC">exchange militias</font><font color="#E5E5E5"> binaries with them as</font>

847
00:37:27,870 --> 00:37:35,549
well as<font color="#CCCCCC"> URLs</font><font color="#E5E5E5"> ip's domains</font><font color="#CCCCCC"> so basically</font>

848
00:37:33,420 --> 00:37:37,440
it's an exchange of information

849
00:37:35,550 --> 00:37:41,460
the main difference<font color="#CCCCCC"> here is that we</font>

850
00:37:37,440 --> 00:37:45,780
actually do the work for proving that

851
00:37:41,460 --> 00:37:47,730
those<font color="#CCCCCC"> URLs are malicious</font><font color="#E5E5E5"> not just take</font>

852
00:37:45,780 --> 00:37:48,870
them from someone else and just put them

853
00:37:47,730 --> 00:37:56,490
in the database

854
00:37:48,870 --> 00:37:58,500
any other questions if you have any more

855
00:37:56,490 --> 00:38:02,939
<font color="#E5E5E5">detailed questions you can also find us</font>

856
00:37:58,500 --> 00:38:04,290
<font color="#CCCCCC">us</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> our stand</font><font color="#E5E5E5"> and you can also try the</font>

857
00:38:02,940 --> 00:38:05,220
actual product that's using this

858
00:38:04,290 --> 00:38:09,630
information

859
00:38:05,220 --> 00:38:12,419
did you consider any legal aspects the

860
00:38:09,630 --> 00:38:14,880
legal aspects in<font color="#CCCCCC"> Watsons when</font><font color="#E5E5E5"> you</font>

861
00:38:12,420 --> 00:38:18,030
publish publishing an IP and you

862
00:38:14,880 --> 00:38:24,150
<font color="#E5E5E5">declared it malicious</font><font color="#CCCCCC"> ok so</font>

863
00:38:18,030 --> 00:38:26,310
oh we didn't consider any legal aspects

864
00:38:24,150 --> 00:38:29,760
right now it's up to the clients that

865
00:38:26,310 --> 00:38:34,410
you that<font color="#E5E5E5"> use our red armor device to</font>

866
00:38:29,760 --> 00:38:36,630
decide whether a VIP<font color="#E5E5E5"> should be blocked</font>

867
00:38:34,410 --> 00:38:39,240
or<font color="#E5E5E5"> allow so the actual device</font><font color="#CCCCCC"> even</font>

868
00:38:36,630 --> 00:38:41,460
<font color="#E5E5E5">though we're</font><font color="#CCCCCC"> market</font><font color="#E5E5E5"> that it as</font><font color="#CCCCCC"> malicious</font>

869
00:38:39,240 --> 00:38:44,310
<font color="#E5E5E5">the client</font><font color="#CCCCCC"> can decide to allow access to</font>

870
00:38:41,460 --> 00:38:49,940
it or<font color="#CCCCCC"> bad</font><font color="#E5E5E5"> it or let it be banned</font>

871
00:38:44,310 --> 00:38:49,940
<font color="#E5E5E5">actually</font>

