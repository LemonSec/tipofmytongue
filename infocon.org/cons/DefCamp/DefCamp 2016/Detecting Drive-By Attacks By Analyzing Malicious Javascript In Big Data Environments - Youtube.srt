1
00:00:00,000 --> 00:00:06,870
<font color="#E5E5E5">hello everyone we have now here</font><font color="#CCCCCC"> on stage</font>

2
00:00:03,449 --> 00:00:09,120
and rainbows<font color="#CCCCCC"> E&O from chair throw and he</font>

3
00:00:06,870 --> 00:00:11,639
will speak about detecting drive-by

4
00:00:09,120 --> 00:00:14,489
attacks by<font color="#E5E5E5"> analyzing</font><font color="#CCCCCC"> malicious</font>

5
00:00:11,639 --> 00:00:17,520
javascript in<font color="#CCCCCC"> big data environment</font>

6
00:00:14,490 --> 00:00:24,779
<font color="#E5E5E5">thank you let's welcome him</font><font color="#CCCCCC"> onstage</font>

7
00:00:17,520 --> 00:00:26,759
thank<font color="#E5E5E5"> you</font><font color="#CCCCCC"> guys</font><font color="#E5E5E5"> how I will get straight</font>

8
00:00:24,779 --> 00:00:31,140
to the presentation<font color="#CCCCCC"> I'm not released to</font>

9
00:00:26,760 --> 00:00:33,480
make presentations<font color="#E5E5E5"> but the</font><font color="#CCCCCC"> who I am</font><font color="#E5E5E5"> I</font>

10
00:00:31,140 --> 00:00:34,829
<font color="#E5E5E5">let me introduce myself</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> was able to</font>

11
00:00:33,480 --> 00:00:36,989
separate security researcher for

12
00:00:34,829 --> 00:00:41,430
<font color="#CCCCCC">imagination center</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> cyber security</font>

13
00:00:36,989 --> 00:00:43,800
<font color="#E5E5E5">incident response</font><font color="#CCCCCC"> i have almost 25 years</font>

14
00:00:41,430 --> 00:00:45,780
of experience in<font color="#CCCCCC"> the security</font>

15
00:00:43,800 --> 00:00:49,769
<font color="#CCCCCC">I'm a computer free from the days when</font>

16
00:00:45,780 --> 00:00:53,969
<font color="#E5E5E5">or there was no www</font><font color="#CCCCCC"> no world-wide-web</font>

17
00:00:49,770 --> 00:00:56,550
<font color="#CCCCCC">just the</font><font color="#E5E5E5"> BBS and the modern devices and</font>

18
00:00:53,969 --> 00:00:58,199
the<font color="#E5E5E5"> anti-malware techniques were was one</font>

19
00:00:56,550 --> 00:01:02,640
of the<font color="#E5E5E5"> my first hobbies</font>

20
00:00:58,199 --> 00:01:06,360
it all started when my friends and me

21
00:01:02,640 --> 00:01:11,220
included the encounter<font color="#E5E5E5"> the virus</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> back</font>

22
00:01:06,360 --> 00:01:13,950
in<font color="#CCCCCC"> 1992</font><font color="#E5E5E5"> many of you might remember it</font>

23
00:01:11,220 --> 00:01:19,289
but it was a simple<font color="#CCCCCC"> do nothing virus</font>

24
00:01:13,950 --> 00:01:22,170
<font color="#CCCCCC">appending it's</font><font color="#E5E5E5"> goto.com files there was</font>

25
00:01:19,290 --> 00:01:27,210
<font color="#CCCCCC">no-one antivirus so i had to make</font><font color="#E5E5E5"> myself</font>

26
00:01:22,170 --> 00:01:30,420
<font color="#CCCCCC">this</font><font color="#E5E5E5"> actually open the test taste for</font>

27
00:01:27,210 --> 00:01:31,649
<font color="#CCCCCC">measuring devices</font><font color="#E5E5E5"> but then I found the</font>

28
00:01:30,420 --> 00:01:34,560
polymorphic virus

29
00:01:31,650 --> 00:01:37,290
what is<font color="#E5E5E5"> a polymorphic virus every of</font>

30
00:01:34,560 --> 00:01:40,439
offspring<font color="#CCCCCC"> every generation of this virus</font>

31
00:01:37,290 --> 00:01:44,520
is<font color="#CCCCCC"> encrypted</font><font color="#E5E5E5"> using</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> new key</font>

32
00:01:40,439 --> 00:01:46,380
<font color="#E5E5E5">therefore the code of the every new</font>

33
00:01:44,520 --> 00:01:51,179
generation is completely different<font color="#CCCCCC"> for</font>

34
00:01:46,380 --> 00:01:54,570
<font color="#CCCCCC">more</font><font color="#E5E5E5"> or the parents</font><font color="#CCCCCC"> so to say this</font><font color="#E5E5E5"> means</font>

35
00:01:51,180 --> 00:01:58,320
that extracting a signature is rather

36
00:01:54,570 --> 00:02:00,869
impossible<font color="#E5E5E5"> the only constant thing in a</font>

37
00:01:58,320 --> 00:02:04,619
polymorphic virus is the<font color="#CCCCCC"> description</font>

38
00:02:00,869 --> 00:02:07,170
routine but<font color="#E5E5E5"> is too small to extract</font>

39
00:02:04,619 --> 00:02:09,710
<font color="#CCCCCC">their signature sometimes</font><font color="#E5E5E5"> even</font><font color="#CCCCCC"> the</font>

40
00:02:07,170 --> 00:02:12,260
<font color="#CCCCCC">bigger</font><font color="#E5E5E5"> description routine is</font>

41
00:02:09,710 --> 00:02:16,550
obvious<font color="#E5E5E5"> cated so that it was the first</font>

42
00:02:12,260 --> 00:02:20,209
<font color="#E5E5E5">from one generation to another</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> still</font>

43
00:02:16,550 --> 00:02:23,300
there is a way<font color="#E5E5E5"> here is the</font><font color="#CCCCCC"> candle Isis</font>

44
00:02:20,210 --> 00:02:26,780
basically<font color="#E5E5E5"> relies on the fact that even</font>

45
00:02:23,300 --> 00:02:28,970
<font color="#E5E5E5">though</font><font color="#CCCCCC"> a signature cannot be extracted a</font>

46
00:02:26,780 --> 00:02:32,270
polymorphic virus has a certain features

47
00:02:28,970 --> 00:02:34,880
like searching for certain files

48
00:02:32,270 --> 00:02:37,490
<font color="#E5E5E5">searching for certain processes to do in</font>

49
00:02:34,880 --> 00:02:40,640
fact<font color="#E5E5E5"> trying to open</font><font color="#CCCCCC"> circle file scope</font>

50
00:02:37,490 --> 00:02:45,950
<font color="#CCCCCC">itself</font><font color="#E5E5E5"> etc</font><font color="#CCCCCC"> for accessing</font><font color="#E5E5E5"> some system</font>

51
00:02:40,640 --> 00:02:48,859
functions<font color="#E5E5E5"> the</font><font color="#CCCCCC"> description routine</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font>

52
00:02:45,950 --> 00:02:52,429
polymorphic<font color="#E5E5E5"> virus is in fact</font><font color="#CCCCCC"> it's</font>

53
00:02:48,860 --> 00:02:55,220
Achilles heel<font color="#E5E5E5"> because this portion of</font>

54
00:02:52,430 --> 00:02:57,830
code is never encrypted<font color="#E5E5E5"> only</font><font color="#CCCCCC"> obfuscating</font>

55
00:02:55,220 --> 00:02:59,900
<font color="#E5E5E5">this means that the code is there but</font>

56
00:02:57,830 --> 00:03:03,020
you have the<font color="#E5E5E5"> tools to understand what is</font>

57
00:02:59,900 --> 00:03:05,270
what is happening<font color="#CCCCCC"> so basically it's</font>

58
00:03:03,020 --> 00:03:08,660
considered suspicious behavior if

59
00:03:05,270 --> 00:03:11,990
<font color="#CCCCCC">process</font><font color="#E5E5E5"> cycles through large chunks of</font>

60
00:03:08,660 --> 00:03:17,000
data<font color="#CCCCCC"> the price transformation on data</font>

61
00:03:11,990 --> 00:03:19,820
<font color="#E5E5E5">read like</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> decryption function and</font>

62
00:03:17,000 --> 00:03:23,870
then<font color="#E5E5E5"> tries to execute the data that that</font>

63
00:03:19,820 --> 00:03:25,489
<font color="#CCCCCC">bread when I speak about viruses my</font>

64
00:03:23,870 --> 00:03:29,570
presentation is about<font color="#CCCCCC"> require</font>

65
00:03:25,490 --> 00:03:31,340
<font color="#E5E5E5">exploitation because there are quite a</font>

66
00:03:29,570 --> 00:03:35,540
few similarities between polymorphic

67
00:03:31,340 --> 00:03:37,160
viruses and<font color="#CCCCCC"> malicious javascript virus</font>

68
00:03:35,540 --> 00:03:38,929
needs to encrypt its own body in order

69
00:03:37,160 --> 00:03:41,780
to avoid detection by<font color="#CCCCCC"> your antivirus</font>

70
00:03:38,930 --> 00:03:43,340
<font color="#E5E5E5">signatures scanning</font><font color="#CCCCCC"> javascript is</font><font color="#E5E5E5"> to</font>

71
00:03:41,780 --> 00:03:45,680
obfuscate its own code to avoid

72
00:03:43,340 --> 00:03:50,090
detection by<font color="#E5E5E5"> next-generation firewalls</font>

73
00:03:45,680 --> 00:03:51,890
uTM's<font color="#E5E5E5"> antivirus scanners etc to achieve</font>

74
00:03:50,090 --> 00:03:54,740
more<font color="#E5E5E5"> execution of polymorphic virus has</font>

75
00:03:51,890 --> 00:03:56,809
<font color="#CCCCCC">to decrypt</font><font color="#E5E5E5"> its own body therefore cycle</font>

76
00:03:54,740 --> 00:03:59,750
through the encrypted code<font color="#CCCCCC"> the price</font>

77
00:03:56,810 --> 00:04:03,680
transformations<font color="#E5E5E5"> to that code execute</font>

78
00:03:59,750 --> 00:04:05,780
that code<font color="#CCCCCC"> infected user and detected a</font>

79
00:04:03,680 --> 00:04:06,470
<font color="#E5E5E5">cloud web exploit</font><font color="#CCCCCC"> his supposed to do the</font>

80
00:04:05,780 --> 00:04:10,010
same

81
00:04:06,470 --> 00:04:11,930
<font color="#E5E5E5">what is the web exploit kit</font><font color="#CCCCCC"> it's a</font>

82
00:04:10,010 --> 00:04:14,120
<font color="#CCCCCC">donkey</font><font color="#E5E5E5"> that automates the exploitation</font>

83
00:04:11,930 --> 00:04:16,100
<font color="#E5E5E5">of client-side vulnerabilities</font><font color="#CCCCCC"> usually</font>

84
00:04:14,120 --> 00:04:19,548
targeting browsers and programs that<font color="#E5E5E5"> are</font>

85
00:04:16,100 --> 00:04:22,930
<font color="#E5E5E5">web second</font><font color="#CCCCCC"> vote for the browser you can</font>

86
00:04:19,548 --> 00:04:25,570
usually<font color="#E5E5E5"> it gathers information on the</font>

87
00:04:22,930 --> 00:04:27,729
<font color="#CCCCCC">the Machine</font><font color="#E5E5E5"> find the vulnerabilities and</font>

88
00:04:25,570 --> 00:04:30,849
determines the appropriate to exploit

89
00:04:27,729 --> 00:04:33,820
<font color="#CCCCCC">delivered exploit which typically</font>

90
00:04:30,850 --> 00:04:37,030
typically<font color="#CCCCCC"> silently</font><font color="#E5E5E5"> drive drive by</font>

91
00:04:33,820 --> 00:04:40,240
<font color="#CCCCCC">installed Donald installs and</font><font color="#E5E5E5"> execute</font>

92
00:04:37,030 --> 00:04:42,940
<font color="#E5E5E5">smaller more than seventy percent of</font>

93
00:04:40,240 --> 00:04:44,680
ransomware and banking<font color="#CCCCCC"> Trojans</font><font color="#E5E5E5"> is</font>

94
00:04:42,940 --> 00:04:48,669
delivered either by<font color="#E5E5E5"> phishing email</font>

95
00:04:44,680 --> 00:04:50,979
containing a link to<font color="#CCCCCC"> one URL with</font>

96
00:04:48,669 --> 00:04:53,889
malicious<font color="#CCCCCC"> javascript or when a user</font>

97
00:04:50,979 --> 00:04:56,620
success on<font color="#E5E5E5"> URL containing</font><font color="#CCCCCC"> the militia</font>

98
00:04:53,889 --> 00:04:58,509
<font color="#E5E5E5">javascript in a legitimate website or</font>

99
00:04:56,620 --> 00:05:02,259
served by a third party advertisement

100
00:04:58,509 --> 00:05:05,289
<font color="#CCCCCC">usually there are four stages we</font>

101
00:05:02,259 --> 00:05:07,599
identified four stages in a drive-by

102
00:05:05,289 --> 00:05:11,169
<font color="#E5E5E5">exploitation</font><font color="#CCCCCC"> the first</font><font color="#E5E5E5"> stage is that is</font>

103
00:05:07,599 --> 00:05:13,719
<font color="#E5E5E5">the contact face</font><font color="#CCCCCC"> where the user accesses</font>

104
00:05:11,169 --> 00:05:17,979
<font color="#E5E5E5">a</font><font color="#CCCCCC"> compromise website access</font><font color="#E5E5E5"> the spam</font>

105
00:05:13,720 --> 00:05:20,020
link or even a compromise the<font color="#E5E5E5"> ad might</font>

106
00:05:17,979 --> 00:05:23,229
<font color="#CCCCCC">might do the same</font><font color="#E5E5E5"> with the same</font><font color="#CCCCCC"> effect</font>

107
00:05:20,020 --> 00:05:26,889
<font color="#E5E5E5">the</font><font color="#CCCCCC"> resurrection face which is the</font>

108
00:05:23,229 --> 00:05:29,080
second<font color="#CCCCCC"> phase the user is actually read</font>

109
00:05:26,889 --> 00:05:32,919
<font color="#CCCCCC">directed to the appropriate</font><font color="#E5E5E5"> exploitation</font>

110
00:05:29,080 --> 00:05:38,169
server<font color="#CCCCCC"> according</font><font color="#E5E5E5"> to his own type of</font><font color="#CCCCCC"> a</font>

111
00:05:32,919 --> 00:05:41,020
<font color="#E5E5E5">browser version etc in the exploitation</font>

112
00:05:38,169 --> 00:05:45,250
<font color="#E5E5E5">face the actual expert takes place and</font>

113
00:05:41,020 --> 00:05:47,620
the<font color="#E5E5E5"> control or no victims computer is</font>

114
00:05:45,250 --> 00:05:51,340
taken by you by the attacker<font color="#E5E5E5"> which</font>

115
00:05:47,620 --> 00:05:56,860
normally in the infection phase starts

116
00:05:51,340 --> 00:06:09,489
to install<font color="#E5E5E5"> banking</font><font color="#CCCCCC"> Trojans</font><font color="#E5E5E5"> ransomware</font>

117
00:05:56,860 --> 00:06:13,449
<font color="#E5E5E5">etc this is our</font><font color="#CCCCCC"> how it looked like</font><font color="#E5E5E5"> sorry</font>

118
00:06:09,490 --> 00:06:15,910
<font color="#E5E5E5">here is the contact</font><font color="#CCCCCC"> face</font><font color="#E5E5E5"> you see a</font>

119
00:06:13,449 --> 00:06:18,340
normal<font color="#E5E5E5"> normal website with</font><font color="#CCCCCC"> the militias</font>

120
00:06:15,910 --> 00:06:22,960
<font color="#CCCCCC">the advertisement</font><font color="#E5E5E5"> for a compromise</font>

121
00:06:18,340 --> 00:06:25,719
website<font color="#E5E5E5"> or spam link all</font><font color="#CCCCCC"> resurrect</font><font color="#E5E5E5"> the</font>

122
00:06:22,960 --> 00:06:28,690
user to<font color="#CCCCCC"> traffic direction system which</font>

123
00:06:25,720 --> 00:06:32,500
<font color="#CCCCCC">are then</font><font color="#E5E5E5"> the sensing to an</font><font color="#CCCCCC"> expert</font>

124
00:06:28,690 --> 00:06:35,469
<font color="#E5E5E5">circuit which then installs ransomware</font>

125
00:06:32,500 --> 00:06:40,120
<font color="#E5E5E5">banging progeny or other kind of</font><font color="#CCCCCC"> model</font>

126
00:06:35,470 --> 00:06:43,509
<font color="#CCCCCC">our</font><font color="#E5E5E5"> focus is to detect the attacks in</font>

127
00:06:40,120 --> 00:06:46,120
the contact<font color="#E5E5E5"> face the</font><font color="#CCCCCC"> techs are performed</font>

128
00:06:43,509 --> 00:06:49,000
usually by inserting<font color="#CCCCCC"> militias resurrect</font>

129
00:06:46,120 --> 00:06:53,349
<font color="#E5E5E5">which could be</font><font color="#CCCCCC"> javascript direct</font>

130
00:06:49,000 --> 00:06:57,099
<font color="#CCCCCC">military fresh</font><font color="#E5E5E5"> eggs</font><font color="#CCCCCC"> I frames etc in the</font>

131
00:06:53,349 --> 00:07:01,270
<font color="#CCCCCC">p sorry</font><font color="#E5E5E5"> in the HTML code or of the page</font>

132
00:06:57,099 --> 00:07:03,219
these are examples how it can be done

133
00:07:01,270 --> 00:07:06,909
with the<font color="#CCCCCC"> JavaScript with</font><font color="#E5E5E5"> the matter</font>

134
00:07:03,220 --> 00:07:10,720
<font color="#E5E5E5">afresh or how</font><font color="#CCCCCC"> can I frame</font><font color="#E5E5E5"> or would</font><font color="#CCCCCC"> look</font>

135
00:07:06,909 --> 00:07:14,320
like but<font color="#E5E5E5"> signature scaling</font><font color="#CCCCCC"> easily detect</font>

136
00:07:10,720 --> 00:07:18,219
malicious<font color="#CCCCCC"> resurrect several criminals</font>

137
00:07:14,320 --> 00:07:23,590
<font color="#E5E5E5">came with a solution meaning</font><font color="#CCCCCC"> javascript</font>

138
00:07:18,219 --> 00:07:27,430
<font color="#CCCCCC">on</font><font color="#E5E5E5"> Fisk obfuscation how</font><font color="#CCCCCC"> would the norm</font>

139
00:07:23,590 --> 00:07:29,619
or confiscated<font color="#CCCCCC"> javascript</font><font color="#E5E5E5"> look</font><font color="#CCCCCC"> I don't</font>

140
00:07:27,430 --> 00:07:34,509
<font color="#CCCCCC">skate looks like this</font><font color="#E5E5E5"> so it's pretty</font>

141
00:07:29,620 --> 00:07:38,440
<font color="#E5E5E5">readable the office</font><font color="#CCCCCC"> Kate version i don't</font>

142
00:07:34,509 --> 00:07:40,900
<font color="#CCCCCC">know if you can see it here looks</font>

143
00:07:38,440 --> 00:07:45,310
nothing like this

144
00:07:40,900 --> 00:07:48,099
therefore<font color="#CCCCCC"> it's very</font><font color="#E5E5E5"> hard to extract</font><font color="#CCCCCC"> the</font>

145
00:07:45,310 --> 00:07:52,840
signature from more from this<font color="#CCCCCC"> office</font>

146
00:07:48,099 --> 00:07:55,000
obfuscated code<font color="#CCCCCC"> i'll show you a real</font>

147
00:07:52,840 --> 00:07:56,919
<font color="#E5E5E5">life example</font><font color="#CCCCCC"> of obfuscate the JavaScript</font>

148
00:07:55,000 --> 00:08:02,830
which<font color="#CCCCCC"> year we found in the wild</font>

149
00:07:56,919 --> 00:08:06,969
<font color="#CCCCCC">Oh as you can see there is nothing that</font>

150
00:08:02,830 --> 00:08:10,030
you can decide for certain that the

151
00:08:06,969 --> 00:08:16,719
<font color="#E5E5E5">there is a malicious resurrect going on</font>

152
00:08:10,030 --> 00:08:22,029
here but<font color="#E5E5E5"> but as soon as we be obfuscated</font>

153
00:08:16,719 --> 00:08:22,510
this code<font color="#E5E5E5"> we can clearly see very normal</font>

154
00:08:22,029 --> 00:08:25,570
looking

155
00:08:22,510 --> 00:08:28,480
<font color="#E5E5E5">javascript code this portion which I</font>

156
00:08:25,570 --> 00:08:31,990
highlighted here is where the actual

157
00:08:28,480 --> 00:08:34,900
<font color="#CCCCCC">resurrect takes place namely</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> creates</font>

158
00:08:31,990 --> 00:08:40,539
an element in the HTML page<font color="#CCCCCC"> an iframe</font>

159
00:08:34,900 --> 00:08:44,500
<font color="#CCCCCC">who's the size is</font><font color="#E5E5E5"> one pixel</font><font color="#CCCCCC"> display is</font>

160
00:08:40,539 --> 00:08:48,730
now and<font color="#E5E5E5"> the source is an external link</font>

161
00:08:44,500 --> 00:08:52,300
<font color="#E5E5E5">this means that when someone will access</font>

162
00:08:48,730 --> 00:08:55,210
this page containing this<font color="#CCCCCC"> this code will</font>

163
00:08:52,300 --> 00:08:58,780
<font color="#CCCCCC">resurrect will get redirected to this</font>

164
00:08:55,210 --> 00:09:03,910
link which is a<font color="#E5E5E5"> unexplored side</font>

165
00:08:58,780 --> 00:09:06,970
expecting the the signature becomes an

166
00:09:03,910 --> 00:09:10,900
impossible task<font color="#CCCCCC"> as you</font><font color="#E5E5E5"> can see the the</font>

167
00:09:06,970 --> 00:09:13,750
code is a very hard to read<font color="#E5E5E5"> already</font>

168
00:09:10,900 --> 00:09:16,480
wrecked<font color="#E5E5E5"> are created on the fly while the</font>

169
00:09:13,750 --> 00:09:20,170
HTML is rendered in your browser

170
00:09:16,480 --> 00:09:22,990
<font color="#E5E5E5">malicious behavior can only be</font>

171
00:09:20,170 --> 00:09:24,339
determined by emulating the code<font color="#E5E5E5"> but</font>

172
00:09:22,990 --> 00:09:28,090
this process is<font color="#CCCCCC"> really time consuming</font>

173
00:09:24,340 --> 00:09:32,080
<font color="#E5E5E5">and not always reliable emulating the</font>

174
00:09:28,090 --> 00:09:35,080
code can sometimes trigger<font color="#E5E5E5"> booby traps</font>

175
00:09:32,080 --> 00:09:38,350
which are put in place by the attacker

176
00:09:35,080 --> 00:09:42,790
<font color="#E5E5E5">especially to deter the the the analyzes</font>

177
00:09:38,350 --> 00:09:45,370
<font color="#CCCCCC">well for instance</font><font color="#E5E5E5"> how are the obvious</font>

178
00:09:42,790 --> 00:09:48,640
<font color="#CCCCCC">stated this</font><font color="#E5E5E5"> this code it was rather</font>

179
00:09:45,370 --> 00:09:51,820
simple as you can see it's calling<font color="#E5E5E5"> an</font>

180
00:09:48,640 --> 00:09:55,449
<font color="#CCCCCC">even</font><font color="#E5E5E5"> function here which</font><font color="#CCCCCC"> i replaced with</font>

181
00:09:51,820 --> 00:09:58,480
the print with the print function which

182
00:09:55,450 --> 00:10:00,610
you simply display the code for me<font color="#CCCCCC"> but</font>

183
00:09:58,480 --> 00:10:03,310
there are some attackers who can

184
00:10:00,610 --> 00:10:05,740
redefine the print function inside their

185
00:10:03,310 --> 00:10:07,599
script<font color="#E5E5E5"> so when you were calling the</font>

186
00:10:05,740 --> 00:10:10,660
print function to display the<font color="#E5E5E5"> the</font>

187
00:10:07,600 --> 00:10:14,170
obfuscated code<font color="#E5E5E5"> it might to call their</font>

188
00:10:10,660 --> 00:10:21,069
own function which can<font color="#CCCCCC"> I don't know do</font>

189
00:10:14,170 --> 00:10:23,530
some damage depending<font color="#E5E5E5"> on the attacker so</font>

190
00:10:21,070 --> 00:10:26,470
the challenge at the<font color="#CCCCCC"> Romanian national</font>

191
00:10:23,530 --> 00:10:28,750
<font color="#E5E5E5">center for</font><font color="#CCCCCC"> several</font><font color="#E5E5E5"> security</font><font color="#CCCCCC"> incident</font><font color="#E5E5E5"> we</font>

192
00:10:26,470 --> 00:10:31,900
want to continuously monitor the

193
00:10:28,750 --> 00:10:34,460
security level of<font color="#CCCCCC"> romanian</font><font color="#E5E5E5"> websites from</font>

194
00:10:31,900 --> 00:10:37,910
the perspective of drive-by attacks

195
00:10:34,460 --> 00:10:40,820
<font color="#E5E5E5">but there are overset 372 thousand</font>

196
00:10:37,910 --> 00:10:42,949
<font color="#E5E5E5">websites needing to be more toward and</font>

197
00:10:40,820 --> 00:10:44,780
<font color="#E5E5E5">ransomware campaigns are at an all-time</font>

198
00:10:42,950 --> 00:10:47,090
high

199
00:10:44,780 --> 00:10:51,500
we need very small rates for false

200
00:10:47,090 --> 00:10:55,460
negatives and the<font color="#E5E5E5"> we need to be very</font>

201
00:10:51,500 --> 00:10:58,400
careful with<font color="#CCCCCC"> you</font><font color="#E5E5E5"> with this because false</font>

202
00:10:55,460 --> 00:11:01,910
negatives<font color="#E5E5E5"> mean that</font><font color="#CCCCCC"> Romanian users are</font>

203
00:10:58,400 --> 00:11:04,610
exposed to various types of<font color="#CCCCCC"> words right</font>

204
00:11:01,910 --> 00:11:08,300
by your attacks<font color="#CCCCCC"> we need to be accurate</font>

205
00:11:04,610 --> 00:11:12,320
<font color="#CCCCCC">clean and fast the problems we have</font>

206
00:11:08,300 --> 00:11:17,689
though is that we have a number of

207
00:11:12,320 --> 00:11:21,710
websites<font color="#E5E5E5"> a number of website pages and</font>

208
00:11:17,690 --> 00:11:23,540
then<font color="#CCCCCC"> analyze this time which to us in</font>

209
00:11:21,710 --> 00:11:30,170
our circumstances translates to roughly

210
00:11:23,540 --> 00:11:32,089
<font color="#E5E5E5">over</font><font color="#CCCCCC"> 20</font><font color="#E5E5E5"> to 20,000 hours of analyzes if</font>

211
00:11:30,170 --> 00:11:34,280
you<font color="#CCCCCC"> hadn't every response time</font><font color="#E5E5E5"> for page</font>

212
00:11:32,090 --> 00:11:39,170
for like<font color="#E5E5E5"> three seconds you get the like</font>

213
00:11:34,280 --> 00:11:40,880
<font color="#E5E5E5">51,000 the hours of analyzes if you were</font>

214
00:11:39,170 --> 00:11:42,380
to analyze every page in the<font color="#E5E5E5"> honey</font>

215
00:11:40,880 --> 00:11:46,040
client<font color="#E5E5E5"> we should be analyzing</font>

216
00:11:42,380 --> 00:11:48,500
continuously for like five years<font color="#E5E5E5"> in 89</font>

217
00:11:46,040 --> 00:11:52,099
<font color="#E5E5E5">something like this almost</font><font color="#CCCCCC"> six six</font><font color="#E5E5E5"> years</font>

218
00:11:48,500 --> 00:11:55,370
and<font color="#E5E5E5"> most websites have more than just</font>

219
00:11:52,100 --> 00:11:57,890
<font color="#CCCCCC">100 pages and the most of</font><font color="#E5E5E5"> websites have</font>

220
00:11:55,370 --> 00:12:00,800
higher response response times

221
00:11:57,890 --> 00:12:03,439
therefore the total duration of our

222
00:12:00,800 --> 00:12:05,300
analyzes could<font color="#CCCCCC"> take much more longer</font>

223
00:12:03,440 --> 00:12:09,620
than we<font color="#CCCCCC"> then we expected</font>

224
00:12:05,300 --> 00:12:11,660
<font color="#CCCCCC">Plus most most exposed kids use</font>

225
00:12:09,620 --> 00:12:14,180
<font color="#CCCCCC">JavaScript obfuscation</font><font color="#E5E5E5"> which means that</font>

226
00:12:11,660 --> 00:12:16,370
signature scanning fails<font color="#E5E5E5"> which means</font>

227
00:12:14,180 --> 00:12:20,839
your<font color="#E5E5E5"> favorite next-generation firewall</font>

228
00:12:16,370 --> 00:12:23,270
will not detect them<font color="#E5E5E5"> even if your</font>

229
00:12:20,840 --> 00:12:27,920
browser is<font color="#CCCCCC"> up-to-date you are still</font>

230
00:12:23,270 --> 00:12:29,930
exposed<font color="#CCCCCC"> 20 there Tex what is</font><font color="#E5E5E5"> a honey</font>

231
00:12:27,920 --> 00:12:32,599
client<font color="#CCCCCC"> i was talking about honey clients</font>

232
00:12:29,930 --> 00:12:35,449
<font color="#CCCCCC">have any client is a full-featured web</font>

233
00:12:32,600 --> 00:12:38,390
browser to visit potentially malicious

234
00:12:35,450 --> 00:12:40,940
web pages<font color="#CCCCCC"> the environment in which the</font>

235
00:12:38,390 --> 00:12:43,400
browser runs is monitored to determine

236
00:12:40,940 --> 00:12:45,930
if the visit resulted in the system

237
00:12:43,400 --> 00:12:47,939
being being compromised

238
00:12:45,930 --> 00:12:49,770
basically it<font color="#E5E5E5"> records all the</font>

239
00:12:47,940 --> 00:12:51,870
modifications that<font color="#E5E5E5"> are called during the</font>

240
00:12:49,770 --> 00:12:54,449
visit of a page such as<font color="#CCCCCC"> files created</font>

241
00:12:51,870 --> 00:13:00,210
<font color="#CCCCCC">the</font><font color="#E5E5E5"> or deleted the</font><font color="#CCCCCC"> register Keys</font>

242
00:12:54,450 --> 00:13:02,370
<font color="#CCCCCC">newly-created processes etc if any and</font>

243
00:13:00,210 --> 00:13:04,560
expected modification occur<font color="#E5E5E5"> this is</font>

244
00:13:02,370 --> 00:13:07,080
<font color="#CCCCCC">consider is manifestly manifestation of</font>

245
00:13:04,560 --> 00:13:10,680
an attack<font color="#E5E5E5"> and the corresponding pages</font>

246
00:13:07,080 --> 00:13:12,510
<font color="#CCCCCC">collective malicious interaction client</font>

247
00:13:10,680 --> 00:13:14,729
<font color="#CCCCCC">honey client seems to be the solution</font>

248
00:13:12,510 --> 00:13:17,399
but<font color="#CCCCCC"> it's not because they are very</font>

249
00:13:14,730 --> 00:13:20,610
<font color="#E5E5E5">time-consuming firing</font><font color="#CCCCCC"> the single</font>

250
00:13:17,399 --> 00:13:24,750
instance could add<font color="#E5E5E5"> three seconds</font><font color="#CCCCCC"> two</font>

251
00:13:20,610 --> 00:13:27,630
<font color="#CCCCCC">three four seconds to every URL we we</font>

252
00:13:24,750 --> 00:13:30,240
<font color="#CCCCCC">analyzed but</font><font color="#E5E5E5"> also which is very very</font>

253
00:13:27,630 --> 00:13:37,470
important they are detectable<font color="#CCCCCC"> in</font>

254
00:13:30,240 --> 00:13:40,200
<font color="#E5E5E5">defeatable even from</font><font color="#CCCCCC"> JavaScript we</font><font color="#E5E5E5"> we</font>

255
00:13:37,470 --> 00:13:48,779
have found some<font color="#E5E5E5"> some examples of</font>

256
00:13:40,200 --> 00:13:52,050
JavaScript code<font color="#E5E5E5"> aimed of detecting if</font>

257
00:13:48,779 --> 00:13:57,180
the code is analyzing the sent box or in

258
00:13:52,050 --> 00:13:59,310
a virtual machine<font color="#E5E5E5"> basically there are</font>

259
00:13:57,180 --> 00:14:03,779
two types of a very fine if you know

260
00:13:59,310 --> 00:14:06,569
<font color="#E5E5E5">analyzing environment first you detect</font>

261
00:14:03,779 --> 00:14:10,740
the monitoring environment either by you

262
00:14:06,570 --> 00:14:12,360
<font color="#CCCCCC">are no</font><font color="#E5E5E5"> mac address or</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> certain files or</font>

263
00:14:10,740 --> 00:14:16,440
other science

264
00:14:12,360 --> 00:14:19,440
secondly there is<font color="#E5E5E5"> did detection evasion</font>

265
00:14:16,440 --> 00:14:22,500
<font color="#CCCCCC">I</font><font color="#E5E5E5"> would start with the detection of</font>

266
00:14:19,440 --> 00:14:26,310
monitoring environment<font color="#CCCCCC"> i found in the</font>

267
00:14:22,500 --> 00:14:30,990
<font color="#CCCCCC">internet the no explorer a very</font><font color="#E5E5E5"> nicely</font>

268
00:14:26,310 --> 00:14:34,140
<font color="#CCCCCC">but that would allow the hacker to read</font>

269
00:14:30,990 --> 00:14:38,700
the the market rest of the<font color="#CCCCCC"> client</font>

270
00:14:34,140 --> 00:14:41,160
machine or the<font color="#E5E5E5"> code does this because it</font>

271
00:14:38,700 --> 00:14:45,839
<font color="#CCCCCC">to</font><font color="#E5E5E5"> use the Kinect server method of the</font>

272
00:14:41,160 --> 00:14:50,310
<font color="#CCCCCC">su</font><font color="#E5E5E5"> dubbed out this wbbm locator to get</font><font color="#CCCCCC"> s</font>

273
00:14:45,839 --> 00:14:53,520
<font color="#CCCCCC">wbm</font><font color="#E5E5E5"> services</font><font color="#CCCCCC"> exemplary method it carries</font>

274
00:14:50,310 --> 00:14:55,829
the world network adapter configuration

275
00:14:53,520 --> 00:14:58,170
<font color="#E5E5E5">the class</font><font color="#CCCCCC"> return the properties of</font><font color="#E5E5E5"> the</font>

276
00:14:55,829 --> 00:14:59,410
network adapters on the honor system and

277
00:14:58,170 --> 00:15:01,930
simply<font color="#CCCCCC"> iterate</font><font color="#E5E5E5"> through the</font><font color="#CCCCCC"> valley</font>

278
00:14:59,410 --> 00:15:06,969
use<font color="#CCCCCC"> under t</font><font color="#E5E5E5"> for any values matches the</font>

279
00:15:01,930 --> 00:15:10,180
<font color="#E5E5E5">the</font><font color="#CCCCCC"> vmware</font><font color="#E5E5E5"> ouy another method of</font>

280
00:15:06,970 --> 00:15:14,649
detecting the<font color="#CCCCCC"> analyzes</font><font color="#E5E5E5"> environment is a</font>

281
00:15:10,180 --> 00:15:20,620
<font color="#CCCCCC">light</font><font color="#E5E5E5"> on the fact that the most</font><font color="#CCCCCC"> two of</font>

282
00:15:14,649 --> 00:15:23,649
the<font color="#CCCCCC"> Shelf</font><font color="#E5E5E5"> sandboxes or</font><font color="#CCCCCC"> honey client</font><font color="#E5E5E5"> have</font>

283
00:15:20,620 --> 00:15:28,689
<font color="#CCCCCC">a standard the screen</font><font color="#E5E5E5"> screen resolutions</font>

284
00:15:23,649 --> 00:15:31,509
<font color="#E5E5E5">this can be easily verified in the in</font>

285
00:15:28,689 --> 00:15:36,040
<font color="#CCCCCC">JavaScript</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> the small snippet of</font>

286
00:15:31,509 --> 00:15:39,310
<font color="#E5E5E5">work of cold</font><font color="#CCCCCC"> and so there</font><font color="#E5E5E5"> is a</font>

287
00:15:36,040 --> 00:15:40,810
<font color="#CCCCCC">possibility of were detecting the the</font>

288
00:15:39,310 --> 00:15:45,310
honey<font color="#CCCCCC"> client searching for</font><font color="#E5E5E5"> specific</font>

289
00:15:40,810 --> 00:15:46,989
specific<font color="#E5E5E5"> file names here if</font><font color="#CCCCCC"> they request</font>

290
00:15:45,310 --> 00:15:48,339
<font color="#CCCCCC">the JavaScript</font><font color="#E5E5E5"> engine</font><font color="#CCCCCC"> load the source</font>

291
00:15:46,990 --> 00:15:51,339
<font color="#E5E5E5">clip from the</font><font color="#CCCCCC"> client</font><font color="#E5E5E5"> local filesystem</font>

292
00:15:48,339 --> 00:15:53,410
<font color="#CCCCCC">javascript the</font><font color="#E5E5E5"> did not perform any</font>

293
00:15:51,339 --> 00:15:56,620
<font color="#CCCCCC">checks to see the fireworks</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> actually</font>

294
00:15:53,410 --> 00:15:58,029
<font color="#CCCCCC">as</font><font color="#E5E5E5"> JavaScript source file if the file is</font>

295
00:15:56,620 --> 00:15:59,920
nothing that we expect the<font color="#CCCCCC"> JavaScript</font>

296
00:15:58,029 --> 00:16:04,899
<font color="#E5E5E5">formatted throw or JavaScript runtime</font>

297
00:15:59,920 --> 00:16:08,259
error<font color="#CCCCCC"> the script can be used even to to</font>

298
00:16:04,899 --> 00:16:11,889
detect<font color="#CCCCCC"> vmware tools</font>

299
00:16:08,259 --> 00:16:14,709
the second method of attacking the

300
00:16:11,889 --> 00:16:17,529
<font color="#CCCCCC">analyzes environment is delayed</font>

301
00:16:14,709 --> 00:16:21,880
exploitation and this can be achieved

302
00:16:17,529 --> 00:16:25,660
the<font color="#E5E5E5"> through</font><font color="#CCCCCC"> even triggered exploitation</font>

303
00:16:21,880 --> 00:16:29,500
<font color="#E5E5E5">like using the certain</font><font color="#CCCCCC"> javascript</font>

304
00:16:25,660 --> 00:16:34,269
methods that would require a certain<font color="#E5E5E5"> in</font>

305
00:16:29,500 --> 00:16:37,360
<font color="#E5E5E5">environment for instance if you put the</font>

306
00:16:34,269 --> 00:16:39,579
the most<font color="#E5E5E5"> prompter in a certain area of</font>

307
00:16:37,360 --> 00:16:43,569
the screen or if you click on<font color="#E5E5E5"> that</font>

308
00:16:39,579 --> 00:16:45,189
<font color="#E5E5E5">certain</font><font color="#CCCCCC"> certain area of the screen or if</font>

309
00:16:43,569 --> 00:16:51,339
<font color="#E5E5E5">you believe that certain area of the</font>

310
00:16:45,189 --> 00:16:52,990
screen<font color="#CCCCCC"> also there is a method that that</font>

311
00:16:51,339 --> 00:16:58,990
<font color="#CCCCCC">add some more sleep time before</font>

312
00:16:52,990 --> 00:17:01,509
<font color="#E5E5E5">exploitation as most to send boxes and</font>

313
00:16:58,990 --> 00:17:05,049
the<font color="#E5E5E5"> honey clients have a limited the</font>

314
00:17:01,509 --> 00:17:06,760
time for<font color="#E5E5E5"> analyzes like a few seconds if</font>

315
00:17:05,049 --> 00:17:10,809
nothing happens<font color="#CCCCCC"> the year</font><font color="#E5E5E5"> they say</font>

316
00:17:06,760 --> 00:17:15,520
everything is<font color="#E5E5E5"> ok but in fact this code</font>

317
00:17:10,809 --> 00:17:20,770
weights more than<font color="#E5E5E5"> the</font><font color="#CCCCCC"> sent box two</font><font color="#E5E5E5"> weeks</font>

318
00:17:15,520 --> 00:17:23,349
<font color="#CCCCCC">a</font><font color="#E5E5E5"> executed it small and payload</font><font color="#CCCCCC"> also</font>

319
00:17:20,770 --> 00:17:28,209
there is something<font color="#CCCCCC"> where I called</font>

320
00:17:23,349 --> 00:17:32,080
selective exploitation<font color="#CCCCCC"> the attacker</font>

321
00:17:28,209 --> 00:17:36,429
decides to only target the certain

322
00:17:32,080 --> 00:17:39,490
certain versions of browsers<font color="#CCCCCC"> or certain</font>

323
00:17:36,429 --> 00:17:43,450
types<font color="#CCCCCC"> of browsers or operating systems</font>

324
00:17:39,490 --> 00:17:46,720
<font color="#E5E5E5">also there is what i call the referral</font>

325
00:17:43,450 --> 00:17:49,059
attack which means the exploits are only

326
00:17:46,720 --> 00:17:52,090
<font color="#CCCCCC">serve to request that originated from</font>

327
00:17:49,059 --> 00:17:56,830
one of the infected websites<font color="#E5E5E5"> so if you</font>

328
00:17:52,090 --> 00:17:58,449
directly<font color="#CCCCCC"> analyze it will do nothing</font>

329
00:17:56,830 --> 00:18:00,908
only if you come from one of the

330
00:17:58,450 --> 00:18:04,450
infected<font color="#CCCCCC"> website they know they they</font>

331
00:18:00,909 --> 00:18:07,419
have<font color="#CCCCCC"> found</font><font color="#E5E5E5"> so there are some more</font>

332
00:18:04,450 --> 00:18:10,630
<font color="#E5E5E5">real-life examples when the the attacker</font>

333
00:18:07,419 --> 00:18:14,049
doesn't<font color="#E5E5E5"> to target the user the first</font>

334
00:18:10,630 --> 00:18:16,899
time<font color="#CCCCCC"> or he he accesses the page</font><font color="#E5E5E5"> but</font>

335
00:18:14,049 --> 00:18:20,889
rather it will not attack him on

336
00:18:16,899 --> 00:18:23,500
revisiting<font color="#E5E5E5"> like</font><font color="#CCCCCC"> a cookie or when he</font>

337
00:18:20,890 --> 00:18:28,840
opens<font color="#CCCCCC"> a link on</font><font color="#E5E5E5"> a secondary page of the</font>

338
00:18:23,500 --> 00:18:31,929
website etc so<font color="#E5E5E5"> we're not using an</font>

339
00:18:28,840 --> 00:18:34,090
existing solution<font color="#E5E5E5"> existing solutions</font><font color="#CCCCCC"> to</font>

340
00:18:31,929 --> 00:18:36,700
make<font color="#CCCCCC"> make use of honey clients but</font>

341
00:18:34,090 --> 00:18:40,240
<font color="#CCCCCC">feeling every URL to</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> funny client is</font>

342
00:18:36,700 --> 00:18:43,000
very<font color="#E5E5E5"> time-consuming</font><font color="#CCCCCC"> we restore howhow</font>

343
00:18:40,240 --> 00:18:46,450
<font color="#E5E5E5">longer it would take us</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> to do this</font>

344
00:18:43,000 --> 00:18:49,990
publicly available<font color="#E5E5E5"> honey client</font><font color="#CCCCCC"> as you</font>

345
00:18:46,450 --> 00:18:52,840
<font color="#E5E5E5">have seen before</font><font color="#CCCCCC"> have no</font><font color="#E5E5E5"> fingerprint</font>

346
00:18:49,990 --> 00:18:55,299
which could lead to<font color="#CCCCCC"> two detection</font>

347
00:18:52,840 --> 00:18:58,178
<font color="#E5E5E5">evasion or by the</font>

348
00:18:55,299 --> 00:19:02,080
<font color="#CCCCCC">by the attacker by the militias</font>

349
00:18:58,179 --> 00:19:05,590
<font color="#CCCCCC">javascript</font><font color="#E5E5E5"> also we</font><font color="#CCCCCC"> are solution has to</font>

350
00:19:02,080 --> 00:19:08,289
be quite scalable quite large<font color="#CCCCCC"> because</font><font color="#E5E5E5"> we</font>

351
00:19:05,590 --> 00:19:10,178
have a lot of data to process and

352
00:19:08,289 --> 00:19:14,230
<font color="#CCCCCC">nowhere publicly available solution</font><font color="#E5E5E5"> can</font>

353
00:19:10,179 --> 00:19:16,929
<font color="#E5E5E5">can scalp or needs this means that we</font>

354
00:19:14,230 --> 00:19:21,190
have to distinguish clearly between

355
00:19:16,929 --> 00:19:26,169
<font color="#CCCCCC">banning</font><font color="#E5E5E5"> and mailing</font><font color="#CCCCCC"> URLs three</font><font color="#E5E5E5"> sandbox</font>

356
00:19:21,190 --> 00:19:28,419
<font color="#CCCCCC">analyzes</font><font color="#E5E5E5"> so the first step we took was</font>

357
00:19:26,169 --> 00:19:31,419
to understand the inner<font color="#E5E5E5"> works and</font>

358
00:19:28,419 --> 00:19:33,850
dynamics of<font color="#CCCCCC"> militias javascript so we</font>

359
00:19:31,419 --> 00:19:36,070
<font color="#CCCCCC">analyze like forty different models</font>

360
00:19:33,850 --> 00:19:42,100
<font color="#CCCCCC">javascript symbols found in the wild</font>

361
00:19:36,070 --> 00:19:45,999
sorry<font color="#E5E5E5"> we</font><font color="#CCCCCC"> found</font><font color="#E5E5E5"> that they share a certain</font>

362
00:19:42,100 --> 00:19:49,330
set of common features so we were able

363
00:19:45,999 --> 00:19:52,090
to compile heuristic<font color="#E5E5E5"> set from the</font>

364
00:19:49,330 --> 00:19:54,549
<font color="#CCCCCC">expected features then we created</font><font color="#E5E5E5"> an</font>

365
00:19:52,090 --> 00:19:56,439
artificial intelligence model using the

366
00:19:54,549 --> 00:19:59,739
<font color="#CCCCCC">curious</font><font color="#E5E5E5"> except</font><font color="#CCCCCC"> to be using the</font><font color="#E5E5E5"> normal</font>

367
00:19:56,440 --> 00:20:05,889
detection engine<font color="#CCCCCC"> could</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> this is</font><font color="#E5E5E5"> the</font>

368
00:19:59,739 --> 00:20:09,039
solution<font color="#E5E5E5"> here you have the internet this</font>

369
00:20:05,889 --> 00:20:13,959
is<font color="#E5E5E5"> the least or database feeding the</font>

370
00:20:09,039 --> 00:20:18,220
<font color="#CCCCCC">website who</font><font color="#E5E5E5"> our our agents</font><font color="#CCCCCC"> the agents</font>

371
00:20:13,960 --> 00:20:21,609
call the the<font color="#E5E5E5"> internet and the</font><font color="#CCCCCC"> for every</font>

372
00:20:18,220 --> 00:20:25,929
every website<font color="#CCCCCC"> they analyzed every page</font>

373
00:20:21,609 --> 00:20:28,869
every script to see certain<font color="#CCCCCC"> certain</font>

374
00:20:25,929 --> 00:20:31,600
features or everything is a central

375
00:20:28,869 --> 00:20:35,678
message broker which<font color="#CCCCCC"> you send everything</font>

376
00:20:31,600 --> 00:20:40,119
to<font color="#CCCCCC"> an anomaly detection engine which</font>

377
00:20:35,679 --> 00:20:43,600
then sends the militia<font color="#E5E5E5"> see flag the</font><font color="#CCCCCC"> urls</font>

378
00:20:40,119 --> 00:20:46,720
to one of our<font color="#CCCCCC"> two sandboxes one it's a</font>

379
00:20:43,600 --> 00:20:49,658
<font color="#CCCCCC">no GS sandbox or the other one it's a</font>

380
00:20:46,720 --> 00:20:56,619
<font color="#CCCCCC">user's the intel vt-x the equalization</font>

381
00:20:49,659 --> 00:20:59,499
<font color="#E5E5E5">method</font><font color="#CCCCCC"> this is the reporting</font><font color="#E5E5E5"> part where</font>

382
00:20:56,619 --> 00:21:02,230
the the analyzes and the<font color="#E5E5E5"> all the results</font>

383
00:20:59,499 --> 00:21:05,649
are correlated<font color="#E5E5E5"> before there is a problem</font>

384
00:21:02,230 --> 00:21:07,040
or with the<font color="#E5E5E5"> any any discrepancies or</font>

385
00:21:05,649 --> 00:21:11,120
stuff like this

386
00:21:07,040 --> 00:21:17,030
<font color="#E5E5E5">all the</font><font color="#CCCCCC"> URLs are submitted for manual</font>

387
00:21:11,120 --> 00:21:19,310
<font color="#E5E5E5">analyzes so basically our</font><font color="#CCCCCC"> militias jay</font>

388
00:21:17,030 --> 00:21:22,340
<font color="#CCCCCC">johnson detection engine was written in</font>

389
00:21:19,310 --> 00:21:24,200
c and the<font color="#E5E5E5"> assembly it was</font><font color="#CCCCCC"> multi-threaded</font>

390
00:21:22,340 --> 00:21:27,470
analyzes because we have to be very very

391
00:21:24,200 --> 00:21:29,330
fast<font color="#CCCCCC"> or it grows a list of websites</font>

392
00:21:27,470 --> 00:21:32,450
analyzing every script<font color="#CCCCCC"> found on every</font>

393
00:21:29,330 --> 00:21:34,639
page using curious techniques<font color="#CCCCCC"> it</font>

394
00:21:32,450 --> 00:21:36,710
<font color="#E5E5E5">searches the HTML code for the species</font>

395
00:21:34,640 --> 00:21:37,760
<font color="#CCCCCC">javascript methods and correlations</font>

396
00:21:36,710 --> 00:21:41,450
between them

397
00:21:37,760 --> 00:21:43,580
<font color="#E5E5E5">we call them features and also we look</font>

398
00:21:41,450 --> 00:21:46,490
for different evasion techniques inside

399
00:21:43,580 --> 00:21:50,240
the script<font color="#CCCCCC"> code</font><font color="#E5E5E5"> because sometimes there</font>

400
00:21:46,490 --> 00:21:52,610
are certain scripts or who are

401
00:21:50,240 --> 00:21:54,740
interpreted in one way by one browser

402
00:21:52,610 --> 00:21:57,379
and totally different<font color="#CCCCCC"> by you by</font>

403
00:21:54,740 --> 00:22:01,220
<font color="#E5E5E5">different</font><font color="#CCCCCC"> by different browser so</font>

404
00:21:57,380 --> 00:22:04,790
basically if they were to target the

405
00:22:01,220 --> 00:22:06,860
single type of browsers<font color="#E5E5E5"> they would</font>

406
00:22:04,790 --> 00:22:09,409
choose to only make code that would

407
00:22:06,860 --> 00:22:13,669
<font color="#CCCCCC">execute for that the certain type of</font>

408
00:22:09,410 --> 00:22:16,850
<font color="#E5E5E5">browser</font><font color="#CCCCCC"> we have a smart scoring system</font>

409
00:22:13,670 --> 00:22:20,000
in the in the way that we contextualize

410
00:22:16,850 --> 00:22:22,010
the the code for instance the same

411
00:22:20,000 --> 00:22:23,930
method is getting scored differently

412
00:22:22,010 --> 00:22:29,300
depending how it is correlated with the

413
00:22:23,930 --> 00:22:32,030
rest of the code<font color="#CCCCCC"> he</font><font color="#E5E5E5"> so basically there</font>

414
00:22:29,300 --> 00:22:34,760
are these are the set of work of

415
00:22:32,030 --> 00:22:37,910
features<font color="#CCCCCC"> militias</font><font color="#E5E5E5"> javascript</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> shares</font>

416
00:22:34,760 --> 00:22:41,060
<font color="#E5E5E5">this is the first the most important it</font>

417
00:22:37,910 --> 00:22:43,880
has<font color="#E5E5E5"> to silently</font><font color="#CCCCCC"> resurrect the the the</font>

418
00:22:41,060 --> 00:22:46,460
user to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> export side</font>

419
00:22:43,880 --> 00:22:48,440
the second thing<font color="#E5E5E5"> is obfuscation in order</font>

420
00:22:46,460 --> 00:22:51,650
to<font color="#E5E5E5"> evade signature detection of the</font>

421
00:22:48,440 --> 00:22:54,650
attack<font color="#E5E5E5"> select you selectively execution</font>

422
00:22:51,650 --> 00:22:58,880
is the third feature the<font color="#E5E5E5"> late execution</font>

423
00:22:54,650 --> 00:23:01,910
is the fourth feature and<font color="#CCCCCC"> here there</font>

424
00:22:58,880 --> 00:23:03,530
<font color="#E5E5E5">what is obvious</font><font color="#CCCCCC"> creation of education is</font>

425
00:23:01,910 --> 00:23:05,390
obscuring of<font color="#CCCCCC"> intended meaning in</font>

426
00:23:03,530 --> 00:23:08,000
communication<font color="#E5E5E5"> making the message</font>

427
00:23:05,390 --> 00:23:11,360
confusing<font color="#E5E5E5"> willfully ambiguous or harder</font>

428
00:23:08,000 --> 00:23:14,390
to understand this<font color="#E5E5E5"> is again our example</font>

429
00:23:11,360 --> 00:23:17,719
of<font color="#CCCCCC"> woe of the skate with code this</font><font color="#E5E5E5"> is</font>

430
00:23:14,390 --> 00:23:18,500
how it looks totally offer but we can

431
00:23:17,720 --> 00:23:20,180
extract

432
00:23:18,500 --> 00:23:25,460
<font color="#CCCCCC">some very important snippets of</font>

433
00:23:20,180 --> 00:23:29,300
information from this when we<font color="#CCCCCC"> the</font>

434
00:23:25,460 --> 00:23:33,110
<font color="#E5E5E5">confiscated</font><font color="#CCCCCC"> is disco'd</font><font color="#E5E5E5"> we see that the</font>

435
00:23:29,300 --> 00:23:37,639
<font color="#E5E5E5">the year they create the the silent</font>

436
00:23:33,110 --> 00:23:42,469
<font color="#E5E5E5">direction in this part they have the</font>

437
00:23:37,640 --> 00:23:45,350
<font color="#CCCCCC">user-agent</font><font color="#E5E5E5"> check here so only if it's an</font>

438
00:23:42,470 --> 00:23:50,630
<font color="#CCCCCC">Internet Explorer</font><font color="#E5E5E5"> Oprah with TV or</font>

439
00:23:45,350 --> 00:23:54,139
<font color="#CCCCCC">Windows it will be exploited here we</font>

440
00:23:50,630 --> 00:23:57,380
have the<font color="#E5E5E5"> delay</font><font color="#CCCCCC"> the execution method that</font>

441
00:23:54,140 --> 00:24:00,590
was a<font color="#E5E5E5"> mentioning earlier</font><font color="#CCCCCC"> you see</font><font color="#E5E5E5"> the</font>

442
00:23:57,380 --> 00:24:05,960
<font color="#E5E5E5">Creator the</font><font color="#CCCCCC"> greater function that gets</font>

443
00:24:00,590 --> 00:24:10,370
executed after<font color="#CCCCCC"> oh one second so that</font>

444
00:24:05,960 --> 00:24:14,960
<font color="#E5E5E5">maybe to deter the analyzes by your</font>

445
00:24:10,370 --> 00:24:17,540
<font color="#CCCCCC">bison</font><font color="#E5E5E5"> boxes that you decided to execute</font>

446
00:24:14,960 --> 00:24:24,950
<font color="#CCCCCC">two</font><font color="#E5E5E5"> after one second</font>

447
00:24:17,540 --> 00:24:28,639
so our feature set basically<font color="#E5E5E5"> consists of</font>

448
00:24:24,950 --> 00:24:31,370
<font color="#E5E5E5">sense of obfuscation</font><font color="#CCCCCC"> which can be second</font>

449
00:24:28,640 --> 00:24:34,640
features like<font color="#E5E5E5"> instructions like a while</font>

450
00:24:31,370 --> 00:24:38,899
or for transformation features inside

451
00:24:34,640 --> 00:24:43,880
and<font color="#E5E5E5"> outside cycles like replace parts</font>

452
00:24:38,900 --> 00:24:46,490
into from charcoal an<font color="#E5E5E5"> escape etc and</font>

453
00:24:43,880 --> 00:24:49,400
execution features<font color="#CCCCCC"> name</font><font color="#E5E5E5"> namely evolved</font>

454
00:24:46,490 --> 00:24:53,750
<font color="#E5E5E5">also</font><font color="#CCCCCC"> we're looking for</font><font color="#E5E5E5"> direction</font>

455
00:24:49,400 --> 00:24:57,680
features like HTML elements<font color="#E5E5E5"> metal direct</font>

456
00:24:53,750 --> 00:24:58,970
<font color="#CCCCCC">x java</font><font color="#E5E5E5"> iframe</font><font color="#CCCCCC"> javascript set right at</font>

457
00:24:57,680 --> 00:25:02,180
<font color="#E5E5E5">the</font><font color="#CCCCCC"> restaurant</font><font color="#E5E5E5"> is a whole lot of</font>

458
00:24:58,970 --> 00:25:04,040
<font color="#CCCCCC">production features we are analyzing for</font>

459
00:25:02,180 --> 00:25:07,670
looking in

460
00:25:04,040 --> 00:25:10,700
<font color="#E5E5E5">also we're looking for unusually large</font>

461
00:25:07,670 --> 00:25:13,250
variable content<font color="#E5E5E5"> unusually large</font><font color="#CCCCCC"> ever</font>

462
00:25:10,700 --> 00:25:15,920
content<font color="#E5E5E5"> unusually large an</font><font color="#CCCCCC"> escape</font>

463
00:25:13,250 --> 00:25:18,920
content<font color="#E5E5E5"> delay the execution instructions</font>

464
00:25:15,920 --> 00:25:23,480
<font color="#CCCCCC">documents</font><font color="#E5E5E5"> of white spaces inside script</font>

465
00:25:18,920 --> 00:25:25,520
<font color="#E5E5E5">code because most namely all the</font>

466
00:25:23,480 --> 00:25:29,179
JavaScript<font color="#CCCCCC"> Marshall javascript samples</font>

467
00:25:25,520 --> 00:25:30,750
we<font color="#CCCCCC"> analyze or contain</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> 20 white</font>

468
00:25:29,179 --> 00:25:33,150
<font color="#E5E5E5">spaces</font>

469
00:25:30,750 --> 00:25:36,060
<font color="#E5E5E5">guys were</font><font color="#CCCCCC"> I guess</font><font color="#E5E5E5"> what they were trying</font>

470
00:25:33,150 --> 00:25:38,460
to save space<font color="#E5E5E5"> i don't know but this is</font>

471
00:25:36,060 --> 00:25:41,970
the fact that use very little<font color="#E5E5E5"> white</font>

472
00:25:38,460 --> 00:25:45,780
spaces<font color="#CCCCCC"> know so we're looking for signs</font>

473
00:25:41,970 --> 00:25:49,860
of<font color="#E5E5E5"> concatenations which we considered to</font>

474
00:25:45,780 --> 00:25:55,980
<font color="#E5E5E5">be like more than to last science in</font>

475
00:25:49,860 --> 00:26:00,510
close vicinity<font color="#E5E5E5"> so we ran</font><font color="#CCCCCC"> a benning's</font>

476
00:25:55,980 --> 00:26:03,060
<font color="#CCCCCC">been scraped through our system</font><font color="#E5E5E5"> this is</font>

477
00:26:00,510 --> 00:26:06,390
<font color="#E5E5E5">the square root</font><font color="#CCCCCC"> it got</font><font color="#E5E5E5"> as you can see</font>

478
00:26:03,060 --> 00:26:08,850
here it have<font color="#E5E5E5"> recycling features we have</font>

479
00:26:06,390 --> 00:26:11,730
<font color="#CCCCCC">transformation features</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> zero</font>

480
00:26:08,850 --> 00:26:15,659
execution features<font color="#E5E5E5"> 0</font><font color="#CCCCCC"> direction</font><font color="#E5E5E5"> features</font>

481
00:26:11,730 --> 00:26:19,950
it has white<font color="#E5E5E5"> faces so this would not</font>

482
00:26:15,660 --> 00:26:23,760
raise any alarms<font color="#CCCCCC"> but as soon as we feed</font>

483
00:26:19,950 --> 00:26:25,680
our<font color="#E5E5E5"> obfuscate the sample</font><font color="#CCCCCC"> of code</font><font color="#E5E5E5"> we see</font>

484
00:26:23,760 --> 00:26:29,310
that<font color="#E5E5E5"> second features are</font><font color="#CCCCCC"> 40</font>

485
00:26:25,680 --> 00:26:31,590
<font color="#E5E5E5">transformation features are 100 110 we</font>

486
00:26:29,310 --> 00:26:34,020
have execution features we have

487
00:26:31,590 --> 00:26:40,560
<font color="#CCCCCC">resurrection features we have delayed</font>

488
00:26:34,020 --> 00:26:47,670
execution and no<font color="#E5E5E5"> white</font><font color="#CCCCCC"> spaces 08 places</font>

489
00:26:40,560 --> 00:26:49,950
<font color="#CCCCCC">to</font><font color="#E5E5E5"> signs of concatenation here if you</font>

490
00:26:47,670 --> 00:26:53,250
can see we have the<font color="#CCCCCC"> resurrection feature</font>

491
00:26:49,950 --> 00:26:58,260
which is<font color="#E5E5E5"> a the</font><font color="#CCCCCC"> world I frame inside</font><font color="#E5E5E5"> the</font>

492
00:26:53,250 --> 00:27:03,780
<font color="#CCCCCC">script code which is</font><font color="#E5E5E5"> a very</font><font color="#CCCCCC"> were</font>

493
00:26:58,260 --> 00:27:08,910
alarming<font color="#CCCCCC"> side of say we also see the set</font>

494
00:27:03,780 --> 00:27:12,480
<font color="#CCCCCC">timeout here highlighted which enables</font>

495
00:27:08,910 --> 00:27:15,660
the the<font color="#CCCCCC"> code to be ran</font><font color="#E5E5E5"> after or waiting</font>

496
00:27:12,480 --> 00:27:19,950
a certain period of time<font color="#CCCCCC"> where we</font><font color="#E5E5E5"> have</font>

497
00:27:15,660 --> 00:27:25,169
10<font color="#CCCCCC"> will our large viral content</font><font color="#E5E5E5"> insider</font>

498
00:27:19,950 --> 00:27:29,250
<font color="#E5E5E5">this script code</font><font color="#CCCCCC"> so the big data</font>

499
00:27:25,169 --> 00:27:33,240
processing<font color="#CCCCCC"> for for the can as the the</font>

500
00:27:29,250 --> 00:27:36,899
name of<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> two we</font><font color="#CCCCCC"> develop</font><font color="#E5E5E5"> basically</font>

501
00:27:33,240 --> 00:27:40,710
starts a multiple agents to<font color="#E5E5E5"> analyze the</font>

502
00:27:36,899 --> 00:27:42,928
least given a list of<font color="#CCCCCC"> websites the agent</font>

503
00:27:40,710 --> 00:27:45,960
calls the the website and analyzes every

504
00:27:42,929 --> 00:27:48,480
URL found<font color="#E5E5E5"> it</font><font color="#CCCCCC"> seemed containing the URL</font>

505
00:27:45,960 --> 00:27:50,039
name and the score for each URL found on

506
00:27:48,480 --> 00:27:52,769
our website is sent to a message broker

507
00:27:50,039 --> 00:27:55,710
<font color="#E5E5E5">the message broker</font><font color="#CCCCCC"> send data</font><font color="#E5E5E5"> streams</font><font color="#CCCCCC"> for</font>

508
00:27:52,769 --> 00:27:57,990
<font color="#CCCCCC">normally that the detection</font><font color="#E5E5E5"> engine the</font>

509
00:27:55,710 --> 00:28:01,440
anomaly detection and<font color="#CCCCCC"> uses random forest</font>

510
00:27:57,990 --> 00:28:04,380
machine<font color="#E5E5E5"> learning algorithm for my</font>

511
00:28:01,440 --> 00:28:07,110
detection<font color="#E5E5E5"> engine season normally the URL</font>

512
00:28:04,380 --> 00:28:12,090
who triggered it<font color="#CCCCCC"> is sent to</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> OGS nvm</font>

513
00:28:07,110 --> 00:28:13,949
<font color="#E5E5E5">sandboxes in parallel</font><font color="#CCCCCC"> formerly detection</font>

514
00:28:12,090 --> 00:28:16,590
was<font color="#CCCCCC"> bigger than either samples reported</font>

515
00:28:13,950 --> 00:28:18,480
suspicious<font color="#CCCCCC"> behavior</font><font color="#E5E5E5"> HTML page along with</font>

516
00:28:16,590 --> 00:28:21,209
<font color="#CCCCCC">effective</font><font color="#E5E5E5"> script</font><font color="#CCCCCC"> are submitted for</font>

517
00:28:18,480 --> 00:28:24,899
<font color="#CCCCCC">manual analyzes</font><font color="#E5E5E5"> because we want no false</font>

518
00:28:21,210 --> 00:28:29,880
positives and false negatives<font color="#E5E5E5"> all the</font>

519
00:28:24,899 --> 00:28:33,629
results are<font color="#E5E5E5"> all</font><font color="#CCCCCC"> were</font><font color="#E5E5E5"> no SQL database so</font>

520
00:28:29,880 --> 00:28:35,669
our<font color="#E5E5E5"> anomaly detection</font><font color="#CCCCCC"> engine</font><font color="#E5E5E5"> uses</font><font color="#CCCCCC"> a</font>

521
00:28:33,630 --> 00:28:38,100
<font color="#E5E5E5">random</font><font color="#CCCCCC"> forest the regression algorithm</font>

522
00:28:35,669 --> 00:28:40,200
<font color="#E5E5E5">random forests are one of the most</font>

523
00:28:38,100 --> 00:28:42,719
successful watching learning models for

524
00:28:40,200 --> 00:28:44,460
classification and regression<font color="#CCCCCC"> because</font>

525
00:28:42,720 --> 00:28:47,010
they combine many<font color="#E5E5E5"> decision trees in</font>

526
00:28:44,460 --> 00:28:49,649
<font color="#E5E5E5">order to reduce the risk of overfitting</font>

527
00:28:47,010 --> 00:28:53,250
<font color="#CCCCCC">so they do not require feature scaling</font>

528
00:28:49,649 --> 00:28:55,649
<font color="#E5E5E5">this means that we can add the</font><font color="#CCCCCC"> on</font>

529
00:28:53,250 --> 00:29:00,299
<font color="#E5E5E5">limited set of</font><font color="#CCCCCC"> four</font><font color="#E5E5E5"> of features to our</font>

530
00:28:55,649 --> 00:29:04,799
<font color="#E5E5E5">anomaly detection at engine and the</font>

531
00:29:00,299 --> 00:29:05,789
<font color="#CCCCCC">iight</font><font color="#E5E5E5"> model also do which is very</font>

532
00:29:04,799 --> 00:29:07,889
important

533
00:29:05,789 --> 00:29:12,120
<font color="#E5E5E5">they're able to capture nonlinearities</font>

534
00:29:07,889 --> 00:29:18,418
<font color="#CCCCCC">and feature interactions like how these</font>

535
00:29:12,120 --> 00:29:22,289
a these features<font color="#CCCCCC"> arm</font><font color="#E5E5E5"> react in the in the</font>

536
00:29:18,419 --> 00:29:25,299
context of similar or presented features

537
00:29:22,289 --> 00:29:31,690
in the<font color="#CCCCCC"> button</font>

538
00:29:25,299 --> 00:29:33,549
we in the<font color="#E5E5E5"> analyzed</font><font color="#CCCCCC"> so see also there are</font>

539
00:29:31,690 --> 00:29:35,559
<font color="#CCCCCC">unfortunate set of the</font><font color="#E5E5E5"> decision</font><font color="#CCCCCC"> tree</font>

540
00:29:33,549 --> 00:29:38,499
<font color="#E5E5E5">separately so the training can be done</font>

541
00:29:35,559 --> 00:29:40,539
in parallel<font color="#E5E5E5"> for</font><font color="#CCCCCC"> for added speed or the</font>

542
00:29:38,499 --> 00:29:42,190
algorithm<font color="#CCCCCC"> injects randomness into the</font>

543
00:29:40,539 --> 00:29:43,809
training process<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> easy decision</font>

544
00:29:42,190 --> 00:29:45,460
<font color="#CCCCCC">three is a bit different</font>

545
00:29:43,809 --> 00:29:48,009
combining the<font color="#E5E5E5"> bird predictions from</font>

546
00:29:45,460 --> 00:29:50,440
<font color="#E5E5E5">history reduces the variance of the</font>

547
00:29:48,009 --> 00:29:55,090
predictions improving the performance on

548
00:29:50,440 --> 00:29:58,809
the<font color="#CCCCCC"> test</font><font color="#E5E5E5"> data</font><font color="#CCCCCC"> 100gsm sandbox we crafted</font>

549
00:29:55,090 --> 00:30:01,299
<font color="#CCCCCC">it very carefully it's a its</font><font color="#E5E5E5"> runs in</font><font color="#CCCCCC"> a</font>

550
00:29:58,809 --> 00:30:03,369
<font color="#E5E5E5">containment environment</font><font color="#CCCCCC"> it perform</font>

551
00:30:01,299 --> 00:30:06,820
static and dynamic analyzes of emulated

552
00:30:03,369 --> 00:30:09,309
code<font color="#E5E5E5"> it is</font><font color="#CCCCCC"> the obvious k 2 co 2 2nd as</font>

553
00:30:06,820 --> 00:30:13,299
malicious<font color="#CCCCCC"> GS detection scoring system</font>

554
00:30:09,309 --> 00:30:18,580
<font color="#CCCCCC">execute</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> JavaScript taking care of</font>

555
00:30:13,299 --> 00:30:20,739
certain anti anti<font color="#CCCCCC"> analyzes tricks and</font>

556
00:30:18,580 --> 00:30:24,279
follow<font color="#E5E5E5"> the directions</font><font color="#CCCCCC"> it rested on the</font>

557
00:30:20,739 --> 00:30:28,899
binary and from this point we perform or

558
00:30:24,279 --> 00:30:31,179
we can<font color="#CCCCCC"> safely say there are enough</font>

559
00:30:28,899 --> 00:30:34,449
science<font color="#E5E5E5"> to</font><font color="#CCCCCC"> it was</font><font color="#E5E5E5"> a drive-by attack and</font>

560
00:30:31,179 --> 00:30:37,840
the<font color="#E5E5E5"> download</font><font color="#CCCCCC"> the binary can be further</font>

561
00:30:34,450 --> 00:30:39,159
analyzed by your<font color="#CCCCCC"> own Emmanuel analyst or</font>

562
00:30:37,840 --> 00:30:39,789
human<font color="#CCCCCC"> and released or something like</font>

563
00:30:39,159 --> 00:30:46,450
this

564
00:30:39,789 --> 00:30:51,669
<font color="#CCCCCC">ok the vtx</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> box makes use of integral</font>

565
00:30:46,450 --> 00:30:56,350
<font color="#CCCCCC">equation</font><font color="#E5E5E5"> technology</font><font color="#CCCCCC"> it's something done</font>

566
00:30:51,669 --> 00:31:00,970
from scratch<font color="#E5E5E5"> each URL is analyzed by</font>

567
00:30:56,350 --> 00:31:04,090
your multiple<font color="#E5E5E5"> vm in parallel</font><font color="#CCCCCC"> each your</font>

568
00:31:00,970 --> 00:31:06,220
<font color="#E5E5E5">machine running the different versions</font>

569
00:31:04,090 --> 00:31:09,399
of browsers and different type of

570
00:31:06,220 --> 00:31:11,889
browsers and the different type of

571
00:31:09,399 --> 00:31:17,168
operating systems or in order<font color="#E5E5E5"> to</font>

572
00:31:11,889 --> 00:31:20,529
understand how the the the code is a

573
00:31:17,169 --> 00:31:25,389
reacting<font color="#CCCCCC"> according</font><font color="#E5E5E5"> to the to the changes</font>

574
00:31:20,529 --> 00:31:31,570
in<font color="#CCCCCC"> there</font><font color="#E5E5E5"> maybe what browsers</font><font color="#CCCCCC"> it to end</font>

575
00:31:25,389 --> 00:31:34,269
<font color="#E5E5E5">the operating system</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> target</font><font color="#CCCCCC"> so every</font>

576
00:31:31,570 --> 00:31:35,679
every instance uses custom screen sizes

577
00:31:34,269 --> 00:31:39,550
<font color="#E5E5E5">generated the</font>

578
00:31:35,680 --> 00:31:44,410
randomly<font color="#CCCCCC"> randomly</font><font color="#E5E5E5"> on the on the fly</font><font color="#CCCCCC"> em</font>

579
00:31:39,550 --> 00:31:47,290
<font color="#E5E5E5">so that the</font><font color="#CCCCCC"> the attacker doesn't see</font>

580
00:31:44,410 --> 00:31:51,430
that we have<font color="#CCCCCC"> predefined</font><font color="#E5E5E5"> the screen sizes</font>

581
00:31:47,290 --> 00:31:54,280
<font color="#E5E5E5">so they don't know if you are a human</font>

582
00:31:51,430 --> 00:31:59,200
operator<font color="#CCCCCC"> or a little</font><font color="#E5E5E5"> machine analyzing</font>

583
00:31:54,280 --> 00:32:03,220
the<font color="#CCCCCC"> the code</font><font color="#E5E5E5"> so it was for</font><font color="#CCCCCC"> animal's</font>

584
00:31:59,200 --> 00:32:05,770
<font color="#E5E5E5">behavior</font><font color="#CCCCCC"> longer than 1 120 seconds</font><font color="#E5E5E5"> we</font>

585
00:32:03,220 --> 00:32:08,740
have<font color="#E5E5E5"> 22 minutes when we wait for her to</font>

586
00:32:05,770 --> 00:32:11,139
see the<font color="#CCCCCC"> the code</font><font color="#E5E5E5"> does something</font>

587
00:32:08,740 --> 00:32:15,910
malicious or not

588
00:32:11,140 --> 00:32:20,830
also it emulates<font color="#CCCCCC"> most movement and the</font>

589
00:32:15,910 --> 00:32:23,920
<font color="#E5E5E5">and clicks in order to defeat the</font>

590
00:32:20,830 --> 00:32:28,120
evasion techniques presented the

591
00:32:23,920 --> 00:32:32,860
presented earlier and<font color="#CCCCCC"> more tours all the</font>

592
00:32:28,120 --> 00:32:37,750
system functions<font color="#E5E5E5"> not only some</font><font color="#CCCCCC"> or</font>

593
00:32:32,860 --> 00:32:39,699
everything<font color="#E5E5E5"> or the the everything that is</font>

594
00:32:37,750 --> 00:32:43,540
happening go in the operating system

595
00:32:39,700 --> 00:32:47,350
after<font color="#E5E5E5"> the URL is</font><font color="#CCCCCC"> success including</font><font color="#E5E5E5"> all</font>

596
00:32:43,540 --> 00:32:51,070
the functions success are<font color="#E5E5E5"> re reported</font>

597
00:32:47,350 --> 00:32:55,719
and they try to understand the for the

598
00:32:51,070 --> 00:32:58,419
the<font color="#E5E5E5"> behavior was the malicious or or</font>

599
00:32:55,720 --> 00:33:03,190
<font color="#CCCCCC">equals false alarms or it needs to be</font>

600
00:32:58,420 --> 00:33:06,580
manually<font color="#CCCCCC"> analyzed</font><font color="#E5E5E5"> putin also</font><font color="#CCCCCC"> it the</font>

601
00:33:03,190 --> 00:33:12,700
tracks changes in<font color="#CCCCCC"> the webpages</font><font color="#E5E5E5"> analyzed</font>

602
00:33:06,580 --> 00:33:16,629
to<font color="#E5E5E5"> see differences made by you by the</font>

603
00:33:12,700 --> 00:33:19,690
attacker to extract the new technologies

604
00:33:16,630 --> 00:33:22,360
of<font color="#CCCCCC"> of attack and the methods used the</font>

605
00:33:19,690 --> 00:33:28,690
<font color="#E5E5E5">currently in the in the</font><font color="#CCCCCC"> wild to</font><font color="#E5E5E5"> infect</font>

606
00:33:22,360 --> 00:33:34,679
the unsuspecting users<font color="#CCCCCC"> this was my</font>

607
00:33:28,690 --> 00:33:49,090
presentation<font color="#E5E5E5"> thank you all</font>

608
00:33:34,680 --> 00:33:54,640
<font color="#CCCCCC">thank you</font>

609
00:33:49,090 --> 00:33:58,840
<font color="#E5E5E5">how do you find the</font><font color="#CCCCCC"> URLs</font><font color="#E5E5E5"> of the websites</font>

610
00:33:54,640 --> 00:34:00,310
that<font color="#E5E5E5"> you didn't otherwise</font><font color="#CCCCCC"> we have we</font>

611
00:33:58,840 --> 00:34:04,570
have a<font color="#CCCCCC"> feed do we have a partnership</font>

612
00:34:00,310 --> 00:34:08,679
with the<font color="#CCCCCC"> Romanian organization that</font>

613
00:34:04,570 --> 00:34:12,850
gives the<font color="#CCCCCC"> URLs and takers of domain name</font>

614
00:34:08,679 --> 00:34:17,020
is etc and we will partnership with them

615
00:34:12,850 --> 00:34:19,719
<font color="#E5E5E5">thank you</font><font color="#CCCCCC"> know i am curious about the</font>

616
00:34:17,020 --> 00:34:21,040
precision recall score<font color="#CCCCCC"> you imagine</font><font color="#E5E5E5"> that</font>

617
00:34:19,719 --> 00:34:23,589
you have an anomaly detection module

618
00:34:21,040 --> 00:34:26,170
there and<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> trained to meet around</font>

619
00:34:23,590 --> 00:34:29,320
<font color="#CCCCCC">the</font><font color="#E5E5E5"> forests and press about the score of</font>

620
00:34:26,170 --> 00:34:33,430
precision recall<font color="#E5E5E5"> sorry about this corner</font>

621
00:34:29,320 --> 00:34:38,410
of precision recall her scoring position

622
00:34:33,429 --> 00:34:41,230
is a continuously<font color="#CCCCCC"> analyze we normally we</font>

623
00:34:38,409 --> 00:34:45,219
don't have<font color="#E5E5E5"> false negatives</font><font color="#CCCCCC"> everyone from</font>

624
00:34:41,230 --> 00:34:47,560
our<font color="#E5E5E5"> test the</font><font color="#CCCCCC"> star so to say but we're</font>

625
00:34:45,219 --> 00:34:55,899
constantly upgrading<font color="#CCCCCC"> and updating our</font>

626
00:34:47,560 --> 00:34:58,630
our engine<font color="#E5E5E5"> so there will be certain</font>

627
00:34:55,900 --> 00:35:01,510
situations when we need to adjust the

628
00:34:58,630 --> 00:35:06,190
the scoring system according to new

629
00:35:01,510 --> 00:35:08,740
challenges<font color="#E5E5E5"> and another question</font><font color="#CCCCCC"> i'm</font>

630
00:35:06,190 --> 00:35:12,340
<font color="#E5E5E5">curious about if you tried</font><font color="#CCCCCC"> svm or</font><font color="#E5E5E5"> a</font>

631
00:35:08,740 --> 00:35:14,649
<font color="#CCCCCC">night</font><font color="#E5E5E5"> bias approach</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> offer a</font>

632
00:35:12,340 --> 00:35:16,660
random<font color="#CCCCCC"> forest</font><font color="#E5E5E5"> or why why choose</font><font color="#CCCCCC"> random</font>

633
00:35:14,650 --> 00:35:20,410
<font color="#CCCCCC">forest</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> I choose to run upwards</font>

634
00:35:16,660 --> 00:35:26,080
<font color="#CCCCCC">because</font><font color="#E5E5E5"> the who it was a</font><font color="#CCCCCC"> what I needed</font>

635
00:35:20,410 --> 00:35:30,310
for regression<font color="#CCCCCC"> are you didn't need any I</font>

636
00:35:26,080 --> 00:35:31,569
<font color="#E5E5E5">don't</font><font color="#CCCCCC"> know world or fancy analyze stuff</font>

637
00:35:30,310 --> 00:35:35,560
<font color="#E5E5E5">for stuff like this</font>

638
00:35:31,570 --> 00:35:37,990
<font color="#CCCCCC">oh I was only needed to see if we</font>

639
00:35:35,560 --> 00:35:40,540
certain methods are are called<font color="#CCCCCC"> know</font>

640
00:35:37,990 --> 00:35:43,270
inside<font color="#E5E5E5"> the</font><font color="#CCCCCC"> JavaScript and</font><font color="#E5E5E5"> the random</font>

641
00:35:40,540 --> 00:35:47,029
forest it<font color="#E5E5E5"> was precisely what was needed</font>

642
00:35:43,270 --> 00:35:51,320
thank you<font color="#E5E5E5"> think mama</font>

643
00:35:47,030 --> 00:35:53,240
<font color="#E5E5E5">also the common frameworks</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> new one</font>

644
00:35:51,320 --> 00:35:54,170
the new ones especially angular and

645
00:35:53,240 --> 00:35:56,029
react

646
00:35:54,170 --> 00:35:58,250
<font color="#E5E5E5">they're basically all of them</font>

647
00:35:56,030 --> 00:36:02,720
<font color="#CCCCCC">obfuscating you actually scan all that</font>

648
00:35:58,250 --> 00:36:05,180
office<font color="#CCCCCC"> key code</font><font color="#E5E5E5"> to see</font><font color="#CCCCCC"> ya</font><font color="#E5E5E5"> we analyze the</font>

649
00:36:02,720 --> 00:36:08,299
obfuscated code and we apply a scoring

650
00:36:05,180 --> 00:36:11,930
system<font color="#CCCCCC"> those</font><font color="#E5E5E5"> frameworks you you</font>

651
00:36:08,300 --> 00:36:18,770
mentioned or based<font color="#E5E5E5"> on</font><font color="#CCCCCC"> oh yes</font><font color="#E5E5E5"> they don't</font>

652
00:36:11,930 --> 00:36:31,589
fall on our alerts on<font color="#E5E5E5"> on anomaly</font>

653
00:36:18,770 --> 00:36:38,309
detection or on our scoring system<font color="#CCCCCC"> sorry</font>

654
00:36:31,589 --> 00:36:44,460
<font color="#CCCCCC">yeah we</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> analyzed</font><font color="#E5E5E5"> the base64 and the</font>

655
00:36:38,309 --> 00:36:47,219
<font color="#E5E5E5">also or we will do</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> step</font><font color="#CCCCCC"> the the</font>

656
00:36:44,460 --> 00:36:50,609
product<font color="#E5E5E5"> is in the continuous development</font>

657
00:36:47,219 --> 00:36:58,319
<font color="#E5E5E5">yeah</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> having every every minute</font><font color="#CCCCCC"> so</font>

658
00:36:50,609 --> 00:37:02,759
<font color="#CCCCCC">see dude know what do</font><font color="#E5E5E5"> you do with all</font>

659
00:36:58,319 --> 00:37:04,558
the malicious urls that you find<font color="#CCCCCC"> how do</font>

660
00:37:02,759 --> 00:37:06,420
<font color="#E5E5E5">you how do you protect people are you</font>

661
00:37:04,559 --> 00:37:09,119
<font color="#CCCCCC">okay you identify all</font><font color="#E5E5E5"> these malicious</font>

662
00:37:06,420 --> 00:37:21,479
urls what<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do with them</font><font color="#CCCCCC"> we call</font>

663
00:37:09,119 --> 00:37:23,609
<font color="#CCCCCC">kaspersky on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> telephone rings the</font>

664
00:37:21,479 --> 00:37:25,049
next question<font color="#E5E5E5"> are you using any kind of</font>

665
00:37:23,609 --> 00:37:30,029
<font color="#E5E5E5">white last thing</font>

666
00:37:25,049 --> 00:37:34,769
no not<font color="#E5E5E5"> awkward listing</font><font color="#CCCCCC"> we focus on</font>

667
00:37:30,029 --> 00:37:37,349
finding the<font color="#CCCCCC"> set of methods that are</font>

668
00:37:34,769 --> 00:37:41,218
commonly used inside the militias

669
00:37:37,349 --> 00:37:46,680
<font color="#CCCCCC">javascript</font><font color="#E5E5E5"> and the also correlations</font>

670
00:37:41,219 --> 00:37:52,469
between those methods for instance if we

671
00:37:46,680 --> 00:37:54,930
<font color="#E5E5E5">are you have were</font><font color="#CCCCCC"> a coat that the</font><font color="#E5E5E5"> has to</font>

672
00:37:52,469 --> 00:37:58,650
be deciphered the<font color="#CCCCCC"> obfuscate the</font>

673
00:37:54,930 --> 00:38:01,890
<font color="#E5E5E5">unencrypted etc it has to run a few</font>

674
00:37:58,650 --> 00:38:06,960
cycles and transformations on that code

675
00:38:01,890 --> 00:38:09,029
even<font color="#E5E5E5"> though</font><font color="#CCCCCC"> normal-looking normal</font>

676
00:38:06,960 --> 00:38:12,989
<font color="#E5E5E5">looking good scripts might have this</font>

677
00:38:09,029 --> 00:38:16,859
<font color="#E5E5E5">this kind of behavior or they do not</font>

678
00:38:12,989 --> 00:38:17,819
share the<font color="#CCCCCC"> resurrection of features or</font>

679
00:38:16,859 --> 00:38:23,160
the

680
00:38:17,819 --> 00:38:24,839
<font color="#CCCCCC">evolve features and the</font><font color="#E5E5E5"> stuff like this</font>

681
00:38:23,160 --> 00:38:29,308
we don't need to<font color="#E5E5E5"> do</font><font color="#CCCCCC"> weightlifting</font>

682
00:38:24,839 --> 00:38:32,969
<font color="#CCCCCC">because at some point somebody could</font>

683
00:38:29,309 --> 00:38:37,829
identify our<font color="#E5E5E5"> white least substrate and</font>

684
00:38:32,969 --> 00:38:42,479
the<font color="#CCCCCC"> either a bypass it or</font><font color="#E5E5E5"> or contrary we</font>

685
00:38:37,829 --> 00:38:45,329
can block or<font color="#CCCCCC"> miss</font><font color="#E5E5E5"> identify</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> college</font>

686
00:38:42,479 --> 00:38:48,629
<font color="#E5E5E5">teammate to script to as being girl</font>

687
00:38:45,329 --> 00:38:50,369
malicious<font color="#CCCCCC"> yes I was rather</font><font color="#E5E5E5"> thinking</font>

688
00:38:48,630 --> 00:38:53,069
about the scenario where the<font color="#E5E5E5"> teachers</font>

689
00:38:50,369 --> 00:38:54,809
<font color="#E5E5E5">can my website you'll find a</font><font color="#CCCCCC"> confiscated</font>

690
00:38:53,069 --> 00:38:56,459
<font color="#CCCCCC">javascript over there you have a manual</font>

691
00:38:54,809 --> 00:38:58,440
analyst to look at it

692
00:38:56,459 --> 00:39:01,078
so basically<font color="#CCCCCC"> you're kind of spending</font>

693
00:38:58,440 --> 00:39:03,569
money on me<font color="#E5E5E5"> and at the end you determine</font>

694
00:39:01,079 --> 00:39:05,400
that this particular script is clean

695
00:39:03,569 --> 00:39:09,569
wouldn't it be more feasible to let's

696
00:39:05,400 --> 00:39:12,209
say take the<font color="#CCCCCC"> SHA</font><font color="#E5E5E5"> hash of the file</font><font color="#CCCCCC"> into</font>

697
00:39:09,569 --> 00:39:14,430
put in a<font color="#CCCCCC"> whitelist</font><font color="#E5E5E5"> the table since</font>

698
00:39:12,209 --> 00:39:16,709
you're going with big data on the the

699
00:39:14,430 --> 00:39:19,499
database would be<font color="#E5E5E5"> rather huge because</font>

700
00:39:16,709 --> 00:39:24,029
making making a hash of each legitimate

701
00:39:19,499 --> 00:39:26,879
the script<font color="#E5E5E5"> the with the</font><font color="#CCCCCC"> throw</font><font color="#E5E5E5"> lots</font><font color="#CCCCCC"> of</font>

702
00:39:24,029 --> 00:39:30,749
<font color="#E5E5E5">lots of scripts from google facebook</font>

703
00:39:26,880 --> 00:39:32,969
<font color="#CCCCCC">Carol but we think</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> all the</font>

704
00:39:30,749 --> 00:39:36,448
<font color="#CCCCCC">scripts is a an</font><font color="#E5E5E5"> approach</font><font color="#CCCCCC"> i will I</font>

705
00:39:32,969 --> 00:39:39,449
wouldn't take<font color="#CCCCCC"> I rather try to see the</font>

706
00:39:36,449 --> 00:39:44,849
behavior of the certain<font color="#CCCCCC"> scripts you know</font>

707
00:39:39,449 --> 00:39:45,839
what<font color="#CCCCCC"> I mean</font><font color="#E5E5E5"> because the</font><font color="#CCCCCC"> I never like</font>

708
00:39:44,849 --> 00:39:53,269
we're<font color="#E5E5E5"> listening</font>

709
00:39:45,839 --> 00:39:53,269
<font color="#CCCCCC">ok thanks</font>

