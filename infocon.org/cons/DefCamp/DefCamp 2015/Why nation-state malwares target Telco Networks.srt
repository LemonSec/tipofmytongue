1
00:00:00,140 --> 00:00:06,370
good morning hi my name is former thank
you very much for coming out to listen

2
00:00:06,370 --> 00:00:12,670
my talk today I'm gonna presented an
offensive network security research

3
00:00:12,670 --> 00:00:22,169
related to the nation state attacks
targeting telecommunication networks I

4
00:00:22,169 --> 00:00:26,849
just briefly what we are going to cover
his introduction to the Talca network

5
00:00:26,849 --> 00:00:32,349
architecture network protocol that are
being highly targeted such as Jerry

6
00:00:32,348 --> 00:00:38,148
network architecture unnecessarily
protocol and the main concern of this

7
00:00:38,149 --> 00:00:43,640
talk is one of the most credited
government implants region malware

8
00:00:43,640 --> 00:00:50,010
before delving into it its capability I
will try to briefly remind to a rootkit

9
00:00:50,010 --> 00:00:54,890
techniques as region is a mouth
competent long-term

10
00:00:54,890 --> 00:01:00,539
intelligence-gathering rootkit after
retrieval browse through the region

11
00:01:00,539 --> 00:01:11,450
capabilities and alive how it could be
weaponized in an offensive GSM network

12
00:01:11,450 --> 00:01:18,130
and recently there are more technically
complex implants discovered by the

13
00:01:18,130 --> 00:01:23,829
researchers single briefly make a
comparison and finally I will present

14
00:01:23,829 --> 00:01:29,570
you a demo show how some of the
techniques employed by the region

15
00:01:29,570 --> 00:01:34,460
implant could be implemented by a
high-level programming language such as

16
00:01:34,460 --> 00:01:45,380
Windows driver kit and API programming
so my academic background in computer

17
00:01:45,380 --> 00:01:45,990
science

18
00:01:45,990 --> 00:01:51,759
I currently I'm currently working for
the KPN telecom is red team I used to

19
00:01:51,759 --> 00:01:59,109
work for companies like Verizon and IBM
ISS I perform security assessments on my

20
00:01:59,109 --> 00:02:03,669
day today and I'm very interested in
malware analysis

21
00:02:03,670 --> 00:02:12,000
rootkit techniques and programming
development team we are based in

22
00:02:12,000 --> 00:02:23,780
Amsterdam and it is only six minute ride
from the understand I'm center what

23
00:02:23,780 --> 00:02:28,470
inspired after carry out this research
was to analyze and deterministic

24
00:02:28,470 --> 00:02:32,580
surfaces of the GSM enn Energy senator

25
00:02:32,580 --> 00:02:41,100
governments not alleging deer on
students but higher on each other by

26
00:02:41,100 --> 00:02:46,350
collor taking corporations with tools
like origin and still while their

27
00:02:46,350 --> 00:02:54,680
perilous programs reach a greater level
recent leaks country and data network

28
00:02:54,680 --> 00:03:00,720
devices telecom networks are the victims
for two contributors off to such

29
00:03:00,720 --> 00:03:07,530
programs once Legion he can campaign
revealed but it might each and every

30
00:03:07,530 --> 00:03:13,660
telecommunication company got four on it
and try to make sure that they haven't

31
00:03:13,660 --> 00:03:20,760
been affected to the same or similar
attack route case required a lot to

32
00:03:20,760 --> 00:03:26,070
learn about still especially the
operating system internals turnover

33
00:03:26,070 --> 00:03:31,430
working principles and computer
architecture I'm sure not only

34
00:03:31,430 --> 00:03:38,190
understanding the incident but also to
be able to reproduce and simulate the

35
00:03:38,190 --> 00:03:47,329
attack would mean alot to deduce whose
dated a rakish to brake systems

36
00:03:47,330 --> 00:03:55,100
architecture is very complex however
little less less trials to break down

37
00:03:55,100 --> 00:04:04,200
under the following core elements GPRS
is an extension of GSM network that

38
00:04:04,200 --> 00:04:12,260
provides mobile wireless and data
communications UMTS universal mobile

39
00:04:12,260 --> 00:04:19,988
telecommunications system an extension
of GPRS networks that most of us all IP

40
00:04:19,988 --> 00:04:23,729
network by delivering broadband
information including commerce

41
00:04:23,730 --> 00:04:30,710
entertainment services to mobile users
yr fixed wireless and satellite networks

42
00:04:30,710 --> 00:04:40,599
unts defines interfaces for the radio
network controllers

43
00:04:40,600 --> 00:04:46,500
senator consists of the following
natural company's mobile station base

44
00:04:46,500 --> 00:04:53,290
transceiver station base station
controller base station subsystem mobile

45
00:04:53,290 --> 00:04:58,890
switching center court on two occasions
Center home location register and

46
00:04:58,890 --> 00:05:07,719
visitor location register from a
security perspective the following

47
00:05:07,720 --> 00:05:13,210
companies are important to the Red
Shirts mobile switching centers

48
00:05:13,210 --> 00:05:19,880
democracy which incidentally the digital
ist and HDFS up to connection other

49
00:05:19,880 --> 00:05:27,990
mobile switching centers to the base
station controller scientists from the

50
00:05:27,990 --> 00:05:33,440
wired fixture back of the GSM network
that can streets closed to the public

51
00:05:33,440 --> 00:05:41,160
and suits its telecommunication networks
known and PSTN Equipment Identity

52
00:05:41,160 --> 00:05:48,410
register is a database that stores
International Mobile Equipment Identity

53
00:05:48,410 --> 00:05:54,950
is known as in May or off tomorrow by
stations Netra the image is the

54
00:05:54,950 --> 00:05:59,200
Equipment Identity identifier assigned
by the manufacturer roster

55
00:05:59,200 --> 00:06:03,030
mobile stations

56
00:06:03,030 --> 00:06:08,440
Equipment Identity register pro I
security features such as blocking calls

57
00:06:08,440 --> 00:06:16,390
from and sense that have been stolen and
another important component is the home

58
00:06:16,390 --> 00:06:22,340
location register is the central
database for all users to register GSM

59
00:06:22,340 --> 00:06:29,150
network storage static information about
subscriber such as international mobile

60
00:06:29,150 --> 00:06:35,950
subscriber identity subscribed services
and a key for a ton to creating

61
00:06:35,950 --> 00:06:43,710
subscribers the a tell-all stores
dynamic subscriber information such as

62
00:06:43,710 --> 00:06:50,039
current location of the mobile
subscriber content Kitchen Center on the

63
00:06:50,040 --> 00:06:56,070
other hand associated with the home
location register and authentication

64
00:06:56,070 --> 00:06:59,909
server is the database contains all gore
attempts to return to creating trust

65
00:06:59,910 --> 00:07:08,330
drivers and the necessary keys for
encryption to cart user input for the

66
00:07:08,330 --> 00:07:16,659
authentication visitor location register
known as the a liar is a distributed

67
00:07:16,660 --> 00:07:21,550
database also and temporarily stirs
information by a station that are active

68
00:07:21,550 --> 00:07:27,590
in geographic area for each via larry is
responsible for every hilarious

69
00:07:27,590 --> 00:07:35,159
tritiated each mobile switching center
in the network engineer subscriber runs

70
00:07:35,160 --> 00:07:41,070
into your location area the VLR is
responsible for copying subscriber

71
00:07:41,070 --> 00:07:49,960
information from a chill out to the
local dayton is very simple very VLR is

72
00:07:49,960 --> 00:07:56,880
your database that stores your
information at your home country and

73
00:07:56,880 --> 00:08:02,600
Rachel are responsible for DS and Wii
larry is the responsible of copying your

74
00:08:02,600 --> 00:08:08,990
data for example then you visit a
brought six into the Roman

75
00:08:08,990 --> 00:08:15,550
so it needs to copy this information and
regardless of your location your phone

76
00:08:15,550 --> 00:08:22,180
is always working and generating signal
so these databases are responsible for

77
00:08:22,180 --> 00:08:34,280
this communication and authentication
system uses various interfaces for

78
00:08:34,280 --> 00:08:40,159
communications and it is natural Clemens
communications also cheer or the

79
00:08:40,159 --> 00:08:45,589
interfaces management databases database
each other we allow identification

80
00:08:45,590 --> 00:08:51,340
center and equipment identity register
the communication my travels multiple

81
00:08:51,340 --> 00:08:58,940
switching centers but ultimately must
reach the gate three known as GMAC a

82
00:08:58,940 --> 00:09:04,880
separate interfaith texts between each
peer Carolina's its interface repair all

83
00:09:04,880 --> 00:09:12,900
set of protocols the network switching
subsystem known as an SMS is the heart

84
00:09:12,900 --> 00:09:18,540
of the GSM system it connects wireless
network to do stand-up wired network and

85
00:09:18,540 --> 00:09:27,380
it is responsible for the social
cultural one BSS to another two performs

86
00:09:27,380 --> 00:09:35,670
services such as charging accounting and
the roaming different signaling

87
00:09:35,670 --> 00:09:41,250
protocols are using two faces some NSS
interfaces involve only controlling

88
00:09:41,250 --> 00:09:47,340
signaling protocol with no traffic for
example no traffic generated on the

89
00:09:47,340 --> 00:09:53,400
difference between GMAC a challenge we
allow these interfaces carry only

90
00:09:53,400 --> 00:10:05,110
signaling using the mobile application
part known as Met Office System Protocol

91
00:10:05,110 --> 00:10:10,600
so how these are related to do our
research there are regional area

92
00:10:10,600 --> 00:10:16,560
specifically targeted to GSM networks
and anti-virus companies say that the

93
00:10:16,560 --> 00:10:23,140
region has been designed to be a low key
type of malware that can potentially be

94
00:10:23,140 --> 00:10:31,240
used and beyond its campaigns lasting
several years since 2008 the antivirus

95
00:10:31,240 --> 00:10:40,620
companies that analyzed a sample and its
actions after decrypted sample files

96
00:10:40,620 --> 00:10:47,100
discovering that actions are
particularly difficult to decipher

97
00:10:47,100 --> 00:10:55,620
antivirus company contracted this high
profile attacking and the region related

98
00:10:55,620 --> 00:10:59,779
still trucking companies are also
confirmed by the recent leaks that hit

99
00:10:59,779 --> 00:11:07,160
the media the following picture was
taken in Germany a group of activists

100
00:11:07,160 --> 00:11:13,939
protesting against GCHQ and an essay to
get their data removed from their

101
00:11:13,940 --> 00:11:26,449
databases until now no one has real and
clear idea how the targeted GSM and

102
00:11:26,449 --> 00:11:34,969
other institutions there hecht so we try
to determine attack attack possibility

103
00:11:34,970 --> 00:11:41,220
scenarios and attic church since our
competitors our high-profile

104
00:11:41,220 --> 00:11:46,410
organizations are approached pretty nice
look like similar to the all-school

105
00:11:46,410 --> 00:11:57,390
techniques of North Korea to bring them
knees so in order to determine potential

106
00:11:57,390 --> 00:12:03,079
attack scenarios we decided to perform
large-scale sure assimilation from the

107
00:12:03,079 --> 00:12:10,130
base stations for these reasons we have
passively top two GSM communication from

108
00:12:10,130 --> 00:12:16,920
the base station and we greatly is my
clothes my knees and

109
00:12:16,920 --> 00:12:28,199
network tapping cutie in our research we
try to collect as much information as

110
00:12:28,200 --> 00:12:36,990
possible from different endpoints of the
two G 3G and LTE communication it also

111
00:12:36,990 --> 00:12:41,029
included the possible management
services that very chill from the base

112
00:12:41,029 --> 00:12:53,560
station from the network switches and
our research revealed that the following

113
00:12:53,560 --> 00:12:59,989
issues within the best day since the
absence of the physical intrusion

114
00:12:59,990 --> 00:13:06,639
detection systems such as signaling
intrusion whether wiretapping happens or

115
00:13:06,639 --> 00:13:13,730
not and devices can be altered or
changed and most companies don't even

116
00:13:13,730 --> 00:13:22,110
take the take possibility of it into
account and vulnerable services running

117
00:13:22,110 --> 00:13:27,399
accessible from the base stations BTS
reachable from reachable management

118
00:13:27,399 --> 00:13:34,529
interfaces lead if all passwords public
private keys and absence of the time

119
00:13:34,529 --> 00:13:41,060
presence and unauthorized access
protection held in a church parking

120
00:13:41,060 --> 00:13:48,810
shouldn't have possible otherwise and
improper network segmentation in turn on

121
00:13:48,810 --> 00:13:53,529
there are a couple segments of the telco
company was a critical during the time I

122
00:13:53,529 --> 00:14:00,730
was performing research and court GPRS
network and network subsystem could be

123
00:14:00,730 --> 00:14:05,430
exploited

124
00:14:05,430 --> 00:14:12,370
I think space stations are one of the
most outrageous I'm not sure company

125
00:14:12,370 --> 00:14:15,930
entry would like to see whether it is
possible to attack other in their

126
00:14:15,930 --> 00:14:24,209
competence so that Georgia's information
such as authentication Center home

127
00:14:24,209 --> 00:14:30,890
location register and mister location
register if you have a pair from similar

128
00:14:30,890 --> 00:14:36,660
assessment you would be surprised where
you can get in GSM network from the

129
00:14:36,660 --> 00:14:42,319
radio stations especially if the
segmentation are not correctly

130
00:14:42,320 --> 00:14:48,580
implemented let's take a look on the
network companies that could be targeted

131
00:14:48,580 --> 00:14:59,870
locally and remotely GPRS roaming
exchange acts as a harp for GPRS

132
00:14:59,870 --> 00:15:07,480
connections from rooming uses removing
Smith of this skated link between egypt

133
00:15:07,480 --> 00:15:13,410
ers service provider is senator consists
of peering interconnect the mainsheet

134
00:15:13,410 --> 00:15:16,600
Purex gateways are located for you

135
00:15:16,600 --> 00:15:22,880
Europe United States for Asia in
Singapore

136
00:15:22,880 --> 00:15:27,570
essentially when you travel abroad to
your phone works and communicated

137
00:15:27,570 --> 00:15:40,990
through these your provider at home and
through these infrastructure

138
00:15:40,990 --> 00:15:48,170
GPRS roaming exchanged interconnect
networks your local GSM provider

139
00:15:48,170 --> 00:15:55,219
approach is the trustees and highly
interconnected natural made for Internet

140
00:15:55,220 --> 00:16:00,450
Sharing and their failure of or
malicious activity would affect multiple

141
00:16:00,450 --> 00:16:07,120
connected machines multiple at a quick
shower possible not limited to the

142
00:16:07,120 --> 00:16:21,440
particular segment very are organizing
from GPRS tunneling protocol DTP the

143
00:16:21,440 --> 00:16:28,230
group of ip-based communication protocol
used to Cherry General Packet Radio

144
00:16:28,230 --> 00:16:39,670
Service GPRS within the GSM UMTS and LTE
networks GTP can be decomposed into such

145
00:16:39,670 --> 00:16:48,420
companies such as GE TPC GDP and GTP
prime GPC used within the GPS

146
00:16:48,420 --> 00:16:55,300
coordinates search for signaling between
gates phase of GPRS support to not known

147
00:16:55,300 --> 00:17:03,560
as GGSN and GPU you is used for carrying
userdata in the GPS core network and

148
00:17:03,560 --> 00:17:09,099
between the radio access network to
coordinator GDP GDP Prime is uses the

149
00:17:09,099 --> 00:17:15,928
same message structure such as DTP see
and GTP you but it has a new independent

150
00:17:15,929 --> 00:17:29,429
function GTP can be used with either UDP
or TCP UDP is either recommended or

151
00:17:29,429 --> 00:17:34,740
mandatory

152
00:17:34,740 --> 00:17:45,970
one of the most important feature GDP
tunnel is that DNS on GTG re used for

153
00:17:45,970 --> 00:17:58,920
resolving ApS APS Access Point name is
the name of the gate for GPRS 3G and 4G

154
00:17:58,920 --> 00:18:13,260
mobile network and another computer
network access for the public Internet

155
00:18:13,260 --> 00:18:18,840
gather told information over the GRE
tunnels in the following network capture

156
00:18:18,840 --> 00:18:27,840
is a standard GTP packet that trust me a
lot of TLC information such as increased

157
00:18:27,840 --> 00:18:34,750
subscriber not sure and tunnel endpoint
information these might also be used to

158
00:18:34,750 --> 00:18:42,000
correlate a person is activity to the
rest of the road if you have enough

159
00:18:42,000 --> 00:18:55,800
information and then there is Teide
eternal and for an identifier is the

160
00:18:55,800 --> 00:18:57,120
field

161
00:18:57,120 --> 00:19:03,659
president in DTP see Heather and it is
used for the tunnel identification known

162
00:19:03,660 --> 00:19:10,840
as fully qualified tunnel endpoint
identifier if you're not familiar with

163
00:19:10,840 --> 00:19:16,889
all these generation network and
principles you can imagine is if you're

164
00:19:16,890 --> 00:19:22,309
carries carry reached the settings on
your cell phone that does stink like

165
00:19:22,309 --> 00:19:27,800
determine the correct IP address to
connect you to correct Secure Gateway

166
00:19:27,800 --> 00:19:37,399
see if you need a private network likely
peon

167
00:19:37,400 --> 00:19:45,490
according to the former head of the
National Security Agency Michael Hayden

168
00:19:45,490 --> 00:19:52,650
he agreed to the idea that the metadata
the information collected by the NSA and

169
00:19:52,650 --> 00:20:00,930
about to shower and other communications
that doesn't include actual content can

170
00:20:00,930 --> 00:20:06,290
tell the government pretty much
everything about anyone they are

171
00:20:06,290 --> 00:20:11,920
targeting for the surveillance of makes
the actual content of the communication

172
00:20:11,920 --> 00:20:18,660
unnecessary this is issued by the
advances in machine learning an

173
00:20:18,660 --> 00:20:25,550
artificial intelligence make it possible
to predict human behavior

174
00:20:25,550 --> 00:20:38,350
information enough information is
provided

175
00:20:38,350 --> 00:20:44,959
assessed aaron is a common signaling
system for the transport it has 7

176
00:20:44,960 --> 00:20:50,650
messages of her death has seven nature
which is due locked in back in Altai

177
00:20:50,650 --> 00:20:57,270
17th and did it introduced a new
security feature back then and there is

178
00:20:57,270 --> 00:21:02,789
also seek trans sector and is a set of
protocols and extension of assessment

179
00:21:02,789 --> 00:21:20,490
protocol defined to transport a system
and messages over IP matter and i seven

180
00:21:20,490 --> 00:21:28,390
introduced following procedures such as
user identification rotting billion can

181
00:21:28,390 --> 00:21:36,200
call management system consists of
following part message transfer part

182
00:21:36,200 --> 00:21:45,080
empty p1 and p2 and 34 the physical part
of the protocol and signaling content

183
00:21:45,080 --> 00:21:53,780
control part known as a CCP transaction
capabilities application part no nasty

184
00:21:53,780 --> 00:22:07,090
cap telephony user part tup and ISDN
user part no less ISUP

185
00:22:07,090 --> 00:22:14,720
some of the system features include flow
and control of transmitted information

186
00:22:14,720 --> 00:22:22,919
traffic congestion control PRI dentist
today action traffic monitoring and

187
00:22:22,919 --> 00:22:28,230
monitoring measurement

188
00:22:28,230 --> 00:22:34,990
I seventy the threat of global
telecommunication protocol standards

189
00:22:34,990 --> 00:22:41,820
that define prestigious private
misleading the public switched telephone

190
00:22:41,820 --> 00:22:49,290
network exchange control information
over digital signal exp train for

191
00:22:49,290 --> 00:23:00,980
setting up managing and treating
wireline and wireless calls since it's a

192
00:23:00,980 --> 00:23:06,660
taiwanese not application-specific and
works over IP it enables multiple

193
00:23:06,660 --> 00:23:13,630
network elements to work together such
as a sec more than voice telephony

194
00:23:13,630 --> 00:23:24,730
devices altogether various ready to use
tools available for a system

195
00:23:24,730 --> 00:23:40,500
experimentations one of them is called
47 analysis tool as part of the region

196
00:23:40,500 --> 00:23:46,750
Malir turkey service research be
performed network traffic analysis over

197
00:23:46,750 --> 00:23:55,330
SSL protocol has railed experimentation
revealed that it is possible to actual

198
00:23:55,330 --> 00:23:57,899
trade many so to say

199
00:23:57,900 --> 00:24:03,669
called juice information such as color
Norco lino information related to the

200
00:24:03,669 --> 00:24:12,500
their activities there call such as call
duration call start and end times and

201
00:24:12,500 --> 00:24:17,250
the cult status

202
00:24:17,250 --> 00:24:24,460
and please also remember that these are
all information so-called metadata

203
00:24:24,460 --> 00:24:42,150
information for rich people are being
killed less processed through the summer

204
00:24:42,150 --> 00:24:54,020
attack scenarios over SSL protocol
intercepting subscriber cause then when

205
00:24:54,020 --> 00:25:00,940
i subscribe or register honestly hate
this subscriber profile is copied from a

206
00:25:00,940 --> 00:25:05,460
challenge to the validated this home
location register to the visitor

207
00:25:05,460 --> 00:25:10,890
location register database so assuming
an attacker managed to make changes in

208
00:25:10,890 --> 00:25:18,970
visitor location register he can he can
change parameters and sex subscriber

209
00:25:18,970 --> 00:25:26,870
info so that victims can be redirected
to into a conference call to call it

210
00:25:26,870 --> 00:25:33,540
each time a conference call is made so
the attackers can listen to the

211
00:25:33,540 --> 00:25:40,500
conference call to assimilate wild
victim and victim's are thinking that

212
00:25:40,500 --> 00:25:44,850
they are communicating to talking to the
each other while you trade conference

213
00:25:44,850 --> 00:25:56,159
call and there is there can be one or
multiple outsider listening to call

214
00:25:56,160 --> 00:26:07,460
subscribers service change attacks by
introducing a decoy BLR visitor location

215
00:26:07,460 --> 00:26:15,290
register unit today at seven at church
an attacker can intercept SMS messages

216
00:26:15,290 --> 00:26:22,830
sent order up confirmation that message
was received by the recipient and if the

217
00:26:22,830 --> 00:26:28,490
victim is a global mobile banking or any
other shortlisted use one-time SMS cat

218
00:26:28,490 --> 00:26:35,610
then he can recover or still possible to
make money transfer or take over victim

219
00:26:35,610 --> 00:26:49,510
accounts in a mass scale furthermore the
following attacks on areas are also

220
00:26:49,510 --> 00:26:57,410
possible by the manipulation of visitor
location register and home location

221
00:26:57,410 --> 00:27:04,180
register Eunice Lee didn't necessarily
networks interception of SMS messages

222
00:27:04,180 --> 00:27:12,150
perception of outgoing calls redirection
of incoming and outgoing calls making

223
00:27:12,150 --> 00:27:24,300
changes of use abuse and balance so
recently researchers discovered that it

224
00:27:24,300 --> 00:27:32,669
is possible to unblock stolen cellphones
by exploiting our trash relationship

225
00:27:32,670 --> 00:27:39,780
between May and emcee for equipment
identity register access it is not

226
00:27:39,780 --> 00:27:44,740
applicable for order GSM providers but
for instance some of the GSM providers

227
00:27:44,740 --> 00:27:54,720
down some of the stolen by looking into
their number and it's not possible to

228
00:27:54,720 --> 00:28:00,160
use the form for this particular GSM
provider and it has to be done by the

229
00:28:00,160 --> 00:28:04,540
GSM provider

230
00:28:04,540 --> 00:28:12,500
so Equipment Identity register simply
checks whether more by switching

231
00:28:12,500 --> 00:28:21,360
sentence return 0 in equipment in the
message called map check email message

232
00:28:21,360 --> 00:28:29,120
than 33 this phone is whitelisted its
damage communications so it

233
00:28:29,120 --> 00:28:36,929
graphs database from location register
Equipment Identity things ok while it

234
00:28:36,930 --> 00:28:42,560
for me to master because nobody reported
this fall with particular a main number

235
00:28:42,560 --> 00:28:50,700
is stolen so you can read more about
this attack scenario since this research

236
00:28:50,700 --> 00:29:04,290
related published and paper is on the
internet and available for free so an

237
00:29:04,290 --> 00:29:12,129
interesting maalox want on the WikiLeaks
revealed that a Kings team an Italian

238
00:29:12,130 --> 00:29:18,450
company which is known for selling repin
highest surveillance to tools to the

239
00:29:18,450 --> 00:29:27,070
oppressive governments are also
interested in exploiting a 74 user

240
00:29:27,070 --> 00:29:34,220
location tracking and it is technically
true that location of the mobile cell

241
00:29:34,220 --> 00:29:40,640
phone could be obtained

242
00:29:40,640 --> 00:29:48,190
so kids can be analyzed into two
categories such as kernel and user

243
00:29:48,190 --> 00:29:55,170
untruth case let me say user land
ordering through to keep referring

244
00:29:55,170 --> 00:30:02,450
executables that require at least user
privileges however the kernel rootkits

245
00:30:02,450 --> 00:30:11,930
another 30 rootkit run on high level of
operating system but these are also

246
00:30:11,930 --> 00:30:26,180
known as device drivers take me for
hodges' hijacking a function or a system

247
00:30:26,180 --> 00:30:32,250
call or changing execution flow in a way
that attacker can modify change or

248
00:30:32,250 --> 00:30:39,240
obtain what is being said and we think
that we can think that is if like

249
00:30:39,240 --> 00:30:46,320
pirates hijacked ships but they can
still trade and then led to ship to

250
00:30:46,320 --> 00:30:58,270
continue to destination if they wish to
technique used by malicious applications

251
00:30:58,270 --> 00:31:05,150
to monitor user X actions or application
behavior as well as legitimate

252
00:31:05,150 --> 00:31:12,360
applications for the same purpose for
instance antivirus applications youth

253
00:31:12,360 --> 00:31:17,830
who can take needs to take malicious
behavior in the system such as she

254
00:31:17,830 --> 00:31:25,960
logging back to an extra suitcase also
use these techniques for malicious or

255
00:31:25,960 --> 00:31:34,780
hiding their activities within the
system they affected most commonly known

256
00:31:34,780 --> 00:31:41,660
technique for user land applications are
i-eighty who can import address table

257
00:31:41,660 --> 00:31:47,520
who can dl injections and in-line
hooking

258
00:31:47,520 --> 00:31:53,820
most advanced journal level of the user
either system service dispatch table who

259
00:31:53,820 --> 00:32:01,370
can I R P input output register journal
or the structures interrupt address

260
00:32:01,370 --> 00:32:06,300
table descriptor global address global
table descriptor and efficient routing

261
00:32:06,300 --> 00:32:12,440
techniques since these techniques are
widely documented available on internet

262
00:32:12,440 --> 00:32:25,280
will not delve into details but I advise
you to take a look on this region is

263
00:32:25,280 --> 00:32:36,510
very complex multi-platform rootkit
frame that consisted of proper more jail

264
00:32:36,510 --> 00:32:39,810
and multi-state user internal level

265
00:32:39,810 --> 00:32:48,000
multi-state user and kernel level
company so each level seem to be a

266
00:32:48,000 --> 00:32:52,890
responsible of decrypting and lauding
modules into the memory and executing

267
00:32:52,890 --> 00:32:59,170
them the most interesting feature of the
region platform while each

268
00:32:59,170 --> 00:33:07,280
orchestrator did was very new to the
researchers until the discovery it can

269
00:33:07,280 --> 00:33:15,160
be taught as like RPC calls to specific
kernel driver to enable and activate

270
00:33:15,160 --> 00:33:18,030
them and then palos

271
00:33:18,030 --> 00:33:26,100
you twice or actually performing
malicious actions in the system can be

272
00:33:26,100 --> 00:33:32,980
activated for example one of the most
interesting all issues

273
00:33:32,980 --> 00:33:39,270
ability of the region while there must
be able to monitor GSM network base

274
00:33:39,270 --> 00:33:44,330
station commands

275
00:33:44,330 --> 00:33:52,678
so what challenges of the disease
research and no one had to drop from my

276
00:33:52,679 --> 00:34:04,169
gmail module family started analysis I'm
reassuring dropper by infection metal

277
00:34:04,169 --> 00:34:11,359
and it is a multi-state an encrypted
framers structure highly complex

278
00:34:11,359 --> 00:34:19,739
modulation are invoked by a sore a
fractured by the flame malware date are

279
00:34:19,739 --> 00:34:27,408
stored in in try to chill file system
and also the encryption type files are

280
00:34:27,409 --> 00:34:32,980
actually five so it was not come listen
in Mali implementation until their time

281
00:34:32,980 --> 00:34:41,030
and resources and her kid no indication
of compromise which was good for us for

282
00:34:41,030 --> 00:34:50,940
me but it makes it difficult to make
further analysis so I worked cooperated

283
00:34:50,940 --> 00:35:04,470
with the couple different GSM providers
for further research the coalition to

284
00:35:04,470 --> 00:35:09,700
best way to analyze whether to reverse
engineer engineer the encryption brain

285
00:35:09,700 --> 00:35:19,700
drain of the frame to orchestrate apart
than a company of the infected system

286
00:35:19,700 --> 00:35:28,750
and instrument caution that do dynamic
analysis in that way so we can simply

287
00:35:28,750 --> 00:35:33,530
simulate original kernel modules within
the system that we implemented using

288
00:35:33,530 --> 00:35:40,940
Windows driver kit programming and
similar research

289
00:35:40,940 --> 00:35:45,660
has done by a security researcher from
Russia it has more detailed explanation

290
00:35:45,660 --> 00:36:00,940
and they approach you can take a look on
and delete law 3 platform lowered surely

291
00:36:00,940 --> 00:36:11,380
responsible of the decree decryption of
the preceding stages

292
00:36:11,380 --> 00:36:18,130
page one is simply prepared execution of
state to which is developed as kernel

293
00:36:18,130 --> 00:36:26,579
module in the snippet won the simply use
memory kernel level cost allocate memory

294
00:36:26,579 --> 00:36:35,029
cool for the stage to and consequently
it makes sense to proceed next module is

295
00:36:35,029 --> 00:36:46,349
a kernel driver stage to head
conflagration block that contains names

296
00:36:46,349 --> 00:36:56,279
of the two system directories that Holt
encrypted take hard in their extended

297
00:36:56,279 --> 00:37:03,829
attributes so if the first eight
stations that signal they treat aged 22

298
00:37:03,829 --> 00:37:17,079
late start of code of the region while
they're also create market filed it can

299
00:37:17,079 --> 00:37:23,539
be used to identify infected machine it
simply cleans the previous page and

300
00:37:23,539 --> 00:37:36,680
create encrypted file system that is
used for kernel level pay lots three is

301
00:37:36,680 --> 00:37:42,000
kernel driver manager and stage for the
brain of origin framework that

302
00:37:42,000 --> 00:37:51,700
orchestrate terrorist possible of
loading kernel modules

303
00:37:51,700 --> 00:38:01,310
and taste attack process and interesting
mean API call that routine attaches

304
00:38:01,310 --> 00:38:08,710
current threat to do address state of
target process that is found in sample

305
00:38:08,710 --> 00:38:19,550
set our goal is to reproduce and the
simulator region functionalities and

306
00:38:19,550 --> 00:38:26,040
instrument payloads to see you like
dynamically analyzed the mall there I

307
00:38:26,040 --> 00:38:30,490
created a simple return they're simply
attaches an application and intercept

308
00:38:30,490 --> 00:38:35,910
system cause and changes them in a way
and i also analyzed to restore somalia

309
00:38:35,910 --> 00:38:42,879
has different kernel modules and
implemented and instrumented companies

310
00:38:42,880 --> 00:38:52,710
in the same way very simple chords
showing how to obtain process

311
00:38:52,710 --> 00:38:58,339
environment look of a process and then
obtained pace for the rest of the

312
00:38:58,339 --> 00:39:14,270
modules and I think attaching a process
simply execute full to eat of two most

313
00:39:14,270 --> 00:39:21,329
high-profile case known as your average
region and to go to do it too seems to

314
00:39:21,329 --> 00:39:29,310
be most complex should be discovered
until now and also modules and approach

315
00:39:29,310 --> 00:39:35,880
how to operate malicious actions on the
targeted system change or the time for

316
00:39:35,880 --> 00:39:49,829
instance you was by pissing match cards
by Verner ability but raging and do good

317
00:39:49,829 --> 00:39:57,140
rather used stolen or legitimate set to
execute on the system on 64 bit systems

318
00:39:57,140 --> 00:40:07,779
so in order to simulate the region
behavior I created a small framework

319
00:40:07,779 --> 00:40:15,259
consisting of just two modules journal
entry level job

320
00:40:15,259 --> 00:40:22,700
similarly to orchestrate their behavior
that is in plan implanted in the region

321
00:40:22,700 --> 00:40:32,129
platform and the features of the
simulator include coward date exultation

322
00:40:32,130 --> 00:40:39,729
the threat of the legitimate application
is address space and totally invisible

323
00:40:39,729 --> 00:40:50,129
to the user's orchestrator simulated and
partial SOA calls monitoring costs file

324
00:40:50,130 --> 00:40:58,849
system registry and not nature calls who
came back to a logging module some of

325
00:40:58,849 --> 00:41:36,220
the malicious behavior that you can
perform on the affected system

326
00:41:36,220 --> 00:41:56,020
than here

327
00:41:56,020 --> 00:42:06,220
driver module device driver and this is
a simple manual infections key so I

328
00:42:06,220 --> 00:42:11,279
haven't weaponized for the sake of
simplicity and for understanding to

329
00:42:11,280 --> 00:42:20,619
presentation better this is a batch file
it simply works the system driver on the

330
00:42:20,619 --> 00:42:37,470
system kernel driver on the system file
system driver and then its stars service

331
00:42:37,470 --> 00:42:46,990
on the system and then execute
user-level complement of malware and

332
00:42:46,990 --> 00:42:54,169
then if an attacker context is machine
it creates an encrypted channel and then

333
00:42:54,170 --> 00:43:01,000
I take it can use the system as a
command and control service so since the

334
00:43:01,000 --> 00:43:23,780
truth it is not recognized

335
00:43:23,780 --> 00:43:28,220
I will just drop these three to the
directory because I hard code it

336
00:43:28,220 --> 00:43:40,560
executable in this batch file does it
does not happen eyes and then I start

337
00:43:40,560 --> 00:43:49,970
the file on the system it is not
exploiting system for privilege

338
00:43:49,970 --> 00:44:07,589
escalation the file now I'm executing
infecting the system so it creates the

339
00:44:07,590 --> 00:44:12,880
driver on the system executed and I
started this executable on the system

340
00:44:12,880 --> 00:44:28,790
and now it is the system is infected

341
00:44:28,790 --> 00:44:35,350
I implemented with simple assisted table
descriptive talking about this is a

342
00:44:35,350 --> 00:44:41,430
utility that you can scan the route on
your system so it took some of the costs

343
00:44:41,430 --> 00:44:48,009
in the system protects finally handle
height malicious activities on your

344
00:44:48,010 --> 00:44:54,150
system so as you can see system is
infected and it rides are militias

345
00:44:54,150 --> 00:45:06,380
system driver on the system and its
users

346
00:45:06,380 --> 00:45:32,059
some of the cooking techniques on the
system including the registry who king

347
00:45:32,059 --> 00:45:45,480
client you can simply connect

348
00:45:45,480 --> 00:45:57,040
for the sake of simplicity I'm running
on the same system to show you and then

349
00:45:57,040 --> 00:46:07,150
some of the militias activities that the
simulation system application activity

350
00:46:07,150 --> 00:46:13,640
is like and comment on the system
executes URL including system like a

351
00:46:13,640 --> 00:46:18,868
creeper local and other system and
destroy the system for example around

352
00:46:18,869 --> 00:46:36,630
comment on the system for example these
OpenURL on the system

353
00:46:36,630 --> 00:46:46,840
for example if you wanted late this
system will complain that it is not

354
00:46:46,840 --> 00:46:54,490
farmed but let's say there is try to
enter as filed at that exit exit on the

355
00:46:54,490 --> 00:47:06,319
system couldn't find them but it is
running on the system where each sample

356
00:47:06,320 --> 00:47:20,410
so we can for example for the sake of
simplicity you can enter moshus command

357
00:47:20,410 --> 00:47:30,549
sites like fuel system so the hard disk
is overwritten

358
00:47:30,550 --> 00:47:59,780
than the victim restart his computer

359
00:47:59,780 --> 00:48:08,960
should be able to find operating system
because the start of cash portion of the

360
00:48:08,960 --> 00:48:16,500
operating system is all return all the
data is destroyed the american planes on

361
00:48:16,500 --> 00:48:25,400
that it couldn't find an operating
system on the executing machine like

362
00:48:25,400 --> 00:48:27,230
this year

363
00:48:27,230 --> 00:48:47,180
dark but operating system is not found

364
00:48:47,180 --> 00:48:51,529
time for questions

365
00:48:51,530 --> 00:49:02,849
exploring the possibility of creating
your own company just for the purpose of

366
00:49:02,849 --> 00:49:09,300
gaining access to assess 7 thinking
about Detroit provider

367
00:49:09,300 --> 00:49:15,240
you have almost nothing and you have
access to the system which truck drivers

368
00:49:15,240 --> 00:49:25,990
look what you need to have in order to
you know connected global network

369
00:49:25,990 --> 00:49:33,299
actually I created this to use my red
team exercises so I was able to reach

370
00:49:33,300 --> 00:49:40,600
the internet works of the protocol from
the base stations so I was able to reach

371
00:49:40,600 --> 00:49:46,620
very nervous system of the GSM networks
I was able to infect assistance without

372
00:49:46,620 --> 00:49:51,220
noticing it into our system doesn't see
it so I was able to collect pretty much

373
00:49:51,220 --> 00:49:59,270
any sort of data traffic and also has
different modules that I implement in

374
00:49:59,270 --> 00:49:59,759
the way

375
00:49:59,760 --> 00:50:04,780
region work so I can capture some of the
trustees including a 70 related traffic

376
00:50:04,780 --> 00:50:06,570
and I can't figure it out

377
00:50:06,570 --> 00:50:14,780
cars apart it correlated some of the p2p
networks and find the right of different

378
00:50:14,780 --> 00:50:22,560
truck traffic Israel were you able to
get access to keys there are currently

379
00:50:22,560 --> 00:50:30,880
used on the tears well it is not
something to do with the region while

380
00:50:30,880 --> 00:50:37,570
there however it is the failure of GSM
network so I saw some of the key private

381
00:50:37,570 --> 00:50:43,110
and public is wrongly used
interchangeably use Institute of Public

382
00:50:43,110 --> 00:50:50,099
they use privacy I was able to collect
and store them you were able

383
00:50:50,099 --> 00:50:56,239
at some point you are able to gain
access to all currently use keys from

384
00:50:56,239 --> 00:51:03,460
the yes ok written about important we
have more streak

385
00:51:03,460 --> 00:51:12,160
law European Union pretending to date
our attention and we don't own store

386
00:51:12,160 --> 00:51:18,620
information when and where the
connection was started and when its end

387
00:51:18,620 --> 00:51:25,589
but we also store information between if
you are driving a car and you are

388
00:51:25,590 --> 00:51:35,980
switching during the way it is also
locked if you are in a room you I saw

389
00:51:35,980 --> 00:51:41,980
this innocent 70 presentation do you
have a special

390
00:51:41,980 --> 00:51:45,280
by that

391
00:51:45,280 --> 00:51:52,800
allow you to ask their foreign operator
also gather this information to store it

392
00:51:52,800 --> 00:52:01,830
and to send it to you well as I
mentioned when you travel abroad or

393
00:52:01,830 --> 00:52:09,650
register database City real are so it's
takes information and it is like all

394
00:52:09,650 --> 00:52:15,300
like if these identities correct so it
can I wouldn't get this who is the owner

395
00:52:15,300 --> 00:52:26,970
of this and it in this way so eventually
your provider is responsible of whatever

396
00:52:26,970 --> 00:52:31,049
kind of what kind of data is used to be
transmitted to the forum

397
00:52:31,050 --> 00:52:33,160
GSM

398
00:52:33,160 --> 00:52:39,288
company but of course it is limit
limited to the subscales so there is not

399
00:52:39,289 --> 00:52:44,970
much information can be disclosed such
as like your location and personal data

400
00:52:44,970 --> 00:52:53,078
critical for information etc but its
rolls up to you how it is being used by

401
00:52:53,079 --> 00:53:01,170
data is being exchanged to the shore and
GSM providers to be absolutely clear can

402
00:53:01,170 --> 00:53:09,940
being our polish operator and I asked
remaining operator for every be tears

403
00:53:09,940 --> 00:53:17,740
that I was locked during a particle
called no because it is for writing each

404
00:53:17,740 --> 00:53:22,779
other to another on and then takes
information for your location for your

405
00:53:22,780 --> 00:53:27,349
provider and details but you cannot open
all the information and the location of

406
00:53:27,349 --> 00:53:38,289
the North ok thank you any other
questions

407
00:53:38,289 --> 00:53:46,369
you were showing the GTP communication
that you use dropped and what was

408
00:53:46,369 --> 00:53:55,969
interesting there you show some DNS
names who was it useful for your value

409
00:53:55,969 --> 00:54:02,329
on the GDX notoriety brought you are
simply using DNS names to resolve some

410
00:54:02,329 --> 00:54:08,349
website right for the public network so
it can be changed and you cannot be

411
00:54:08,349 --> 00:54:18,279
trusted and regarding a seven you should
some analysis and they will call logs

412
00:54:18,279 --> 00:54:20,579
can this be done

413
00:54:20,579 --> 00:54:25,910
retrospectively or is it the current
communication that you kiss the radio

414
00:54:25,910 --> 00:54:31,819
station using well it is simply a
similar to do wash our traffic down

415
00:54:31,819 --> 00:54:41,799
someone does who want to get to the past
information like it was in the protest

416
00:54:41,799 --> 00:54:50,699
like delete my data is this data was
stored securely or can be obtained for

417
00:54:50,699 --> 00:54:59,140
either GCHQ your MSS I cannot say
anything about this thanks

418
00:54:59,140 --> 00:55:06,620
other questions thank you so much for
presentation

