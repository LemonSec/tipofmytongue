1
00:00:00,170 --> 00:00:06,840
appreciate everyone stick around and
certainly talk on Paul Coghlan from the

2
00:00:06,840 --> 00:00:10,660
USS typically live in Alabama back in
the States

3
00:00:10,660 --> 00:00:16,190
number security architect will focus on
offensive and defensive methods for

4
00:00:16,190 --> 00:00:21,430
network infrastructure focus on the
later one through four with OSI model is

5
00:00:21,430 --> 00:00:27,160
where I try to stay in my work but i
wanna go over first there are some ideas

6
00:00:27,160 --> 00:00:31,289
on what to do with network
infrastructure if you working on a

7
00:00:31,289 --> 00:00:35,499
penetration testing regime he founded
you're getting access to network

8
00:00:35,499 --> 00:00:39,789
infrastructure won't throw some ideas
that you what you need to do is say the

9
00:00:39,789 --> 00:00:46,909
Cisco routers at your end up getting
access to and also go into some ideas on

10
00:00:46,909 --> 00:00:51,998
some things are now being looked at at
the macro later in the way in Pacifica

11
00:00:51,999 --> 00:00:58,699
Lee BGP in most Pacific MPLS but people
are talking about BGP hijacking these

12
00:00:58,699 --> 00:01:03,979
days but nobody's talking about him pls
that is probably being hijacked as well

13
00:01:03,979 --> 00:01:09,829
just like BGP but people are now looking
at her talking about it so how we're

14
00:01:09,829 --> 00:01:15,408
going to get that initial access into
someone's targeted routers one of the

15
00:01:15,409 --> 00:01:20,689
ways we may go and gain initial access
is do something similar to what we have

16
00:01:20,689 --> 00:01:25,619
a pond on the screen where we've got
some recon Smith tell that tells us what

17
00:01:25,619 --> 00:01:31,299
the network management system is for the
customer's network maybe they're running

18
00:01:31,299 --> 00:01:36,039
HP OpenView CiscoWorks solar winds may
be some open source tools as you see

19
00:01:36,039 --> 00:01:39,979
over in the bottom right hand corner and
that system has got a trusted up he

20
00:01:39,979 --> 00:01:43,170
addressed the routers have been locked
down so that only the IP addresses that

21
00:01:43,170 --> 00:01:47,380
trusted device in the right corner is
able to go into network management of

22
00:01:47,380 --> 00:01:51,429
the network on the road but maybe
through doing a really good job and

23
00:01:51,429 --> 00:01:56,469
recon until we're able to come up with
build a custom S&P dictionary community

24
00:01:56,469 --> 00:02:02,669
strings cause they're still doing S&P be
one the two and combine that with with

25
00:02:02,670 --> 00:02:08,020
some spoofing using that S&P below
script we have shown there that you can

26
00:02:08,020 --> 00:02:13,030
download it may we combine the
dictionary with the spoofing attack and

27
00:02:13,030 --> 00:02:13,610
were able to

28
00:02:13,610 --> 00:02:18,080
to brute-force dictionary attacks this
AP community string and gain access to

29
00:02:18,080 --> 00:02:21,850
the routers and switches cause when
Creek community string as guests it's

30
00:02:21,850 --> 00:02:26,750
gonna download the router switch config
to us whatever targeting and then we're

31
00:02:26,750 --> 00:02:31,320
going to be able to get all of their
Intel their triple-a the RADIUS server

32
00:02:31,320 --> 00:02:35,670
information username passwords to the
routers access control us we're going to

33
00:02:35,670 --> 00:02:39,780
get all the good Intel out of that
network device in this may be one method

34
00:02:39,780 --> 00:02:43,350
that would get you that initial access
to the routers typically what's gonna

35
00:02:43,350 --> 00:02:47,570
happen is you're going to end up getting
access through some other means maybe do

36
00:02:47,570 --> 00:02:51,700
some web exploits in your gonna get onto
a system is going on how've router

37
00:02:51,700 --> 00:02:55,570
configs and you're going to be able to
go and get username password but what I

38
00:02:55,570 --> 00:03:01,100
see is during Pinterest engagements the
pen testers are leaving the network

39
00:03:01,100 --> 00:03:05,100
infrastructures they're not digging into
it they just document that they found

40
00:03:05,100 --> 00:03:08,120
they got access to routers and switches
and they leave it at that moment you

41
00:03:08,120 --> 00:03:11,750
some ideas of what you can do to
escalate your privilege on the network

42
00:03:11,750 --> 00:03:17,360
once you get access to the routers and
switches one thing to do is with in the

43
00:03:17,360 --> 00:03:23,049
Cisco world there's a concept called
rail mounts for a policy routing where

44
00:03:23,049 --> 00:03:27,160
we can use access control is to define
the traffic that is of interest to us

45
00:03:27,160 --> 00:03:32,130
think of access control list maybe if
you're not a router person as a firewall

46
00:03:32,130 --> 00:03:36,420
ruleset create an access control list is
going to find the traffic that is of

47
00:03:36,420 --> 00:03:37,070
interest to us

48
00:03:37,070 --> 00:03:42,019
source destination IP addresses port
services and then we can combine that

49
00:03:42,019 --> 00:03:48,000
with a rail mount in that realm out we
can do policy routing there even though

50
00:03:48,000 --> 00:03:52,220
the routing table static leaders through
dynamic routes tells us to send traffic

51
00:03:52,220 --> 00:03:57,519
say to a specific destination east in
the network we can use policy routing to

52
00:03:57,519 --> 00:04:02,420
override the routing table to describe
based on the description we've given of

53
00:04:02,420 --> 00:04:05,988
traffic of interest with access control
list Tuesday be sent to traffic north or

54
00:04:05,989 --> 00:04:11,170
west or south into the network can
override that routing table specifically

55
00:04:11,170 --> 00:04:14,670
for the traffic that is of interest to
us and what that could end up happening

56
00:04:14,670 --> 00:04:18,060
is if it would have been shown in the
drawing here in the center of the draw

57
00:04:18,060 --> 00:04:21,608
maybe we're going get access to their
course which maybe we can override the

58
00:04:21,608 --> 00:04:23,919
routing table into a layer three men in
the military

59
00:04:23,919 --> 00:04:27,909
everyone's familiar with doing the layer
to mandela tax what about doing it

60
00:04:27,910 --> 00:04:32,640
intervale and not the old school in
travail am without car poisoning some of

61
00:04:32,640 --> 00:04:35,180
the other layer to attacks but what
about doing it later three we could do

62
00:04:35,180 --> 00:04:40,099
that with the route map or possibly go
in force traffic that is of interest to

63
00:04:40,099 --> 00:04:45,360
go out of a back door may be out of 3G
4G connection and send the traffic that

64
00:04:45,360 --> 00:04:50,330
is interest out a specific back door so
they will avoid the perimeter security

65
00:04:50,330 --> 00:04:55,010
because most of the network monitoring
us to deploy is at the perimeter well

66
00:04:55,010 --> 00:04:59,539
maybe we can bypass the perimeter
security and go out debris out a back

67
00:04:59,539 --> 00:05:05,210
door through the 4G modem we have a more
advanced the time I meet someone up in

68
00:05:05,210 --> 00:05:09,400
the service about around the over/under
traffic and trying to for traffic at a

69
00:05:09,400 --> 00:05:10,289
different path

70
00:05:10,289 --> 00:05:15,490
use this method another day another
technique that you might not be aware of

71
00:05:15,490 --> 00:05:20,060
it or not I no school router got it

72
00:05:20,060 --> 00:05:25,250
pen tester user's capability we used to
use in the old days of using Jerry

73
00:05:25,250 --> 00:05:32,430
tolling to total non-operating protocols
like Doug Jackson as AppleTalk the novel

74
00:05:32,430 --> 00:05:37,090
stuff you can still use the jury today
for towing a peu pres the internet but I

75
00:05:37,090 --> 00:05:43,260
cut my teeth doing anything but I P over
GRE across water and what we can do is

76
00:05:43,260 --> 00:05:47,030
we can build his jury tunnels we could
total traffic between a router that

77
00:05:47,030 --> 00:05:51,320
we've hiked into a router that we own
that we have under our control somewhere

78
00:05:51,320 --> 00:05:52,620
out on the Internet

79
00:05:52,620 --> 00:05:57,250
build a tunnel in using that technique
of route map so we just discussed we

80
00:05:57,250 --> 00:06:02,220
could use that right now technique to
forward to force traffic to override the

81
00:06:02,220 --> 00:06:07,520
routing table to go over that tunnel so
that we could sniff traffic into packet

82
00:06:07,520 --> 00:06:12,409
analysis remotely across the water in
network so it's a technique might be

83
00:06:12,409 --> 00:06:14,650
able to use

84
00:06:14,650 --> 00:06:21,620
similarly if you end up finding your
original tend to forget your pop in your

85
00:06:21,620 --> 00:06:27,210
getting access to routers are getting
into switches could be another technique

86
00:06:27,210 --> 00:06:32,409
a lot of the guys are not familiar with
yet they know about doing SPAN port

87
00:06:32,410 --> 00:06:37,090
local port mirroring on a switch or
maybe doing our Spain where you can

88
00:06:37,090 --> 00:06:41,289
mirror switch to switch to do packet
capture well there's a technique that we

89
00:06:41,289 --> 00:06:45,550
could use to call Dr span will be can
specify the IP address that is of

90
00:06:45,550 --> 00:06:50,130
interest to us in major traffic out
across the network to a specific IP

91
00:06:50,130 --> 00:06:55,090
address of a newer devices of interest
to us so that we can mirror traffic

92
00:06:55,090 --> 00:06:58,900
across the wider in a technique and met
that we might use during a Pinterest

93
00:06:58,900 --> 00:07:07,049
engagement to escalate privilege across
a network both technique ran across that

94
00:07:07,050 --> 00:07:12,199
wasn't documented if you were you could
use you get yourself into around her

95
00:07:12,199 --> 00:07:17,300
that still got the feature set maybe
it's got a really robust Cisco router

96
00:07:17,300 --> 00:07:22,160
feature set their supports the deal is w
commands were dealing W if you're not

97
00:07:22,160 --> 00:07:28,099
familiar with is a is a method for
tunneling S&A and SDLC protocols mode

98
00:07:28,099 --> 00:07:35,060
IBM protocols across an IP backbone so
we can if we have the features there on

99
00:07:35,060 --> 00:07:40,050
the routers we've compromised we might
be to turn on dealings W and Enbridge

100
00:07:40,050 --> 00:07:45,940
ipv6 across the IP backbone where they
might not be turned on be running ipv6

101
00:07:45,940 --> 00:07:51,090
will we can just go in total the ipv6
across the ipv4 network using deal is w

102
00:07:51,090 --> 00:07:59,359
possibly as a way to launch ipv6 attacks
across the water in network no technique

103
00:07:59,360 --> 00:08:05,289
if you don't work in the in the service
of outer space is a technique that you

104
00:08:05,289 --> 00:08:08,530
could use on the routers if you find
that you've gained access called El to

105
00:08:08,530 --> 00:08:15,679
TPB III with LTE v3 what we can do is we
can create a logical pseudowire where

106
00:08:15,680 --> 00:08:16,560
you can log

107
00:08:16,560 --> 00:08:22,380
have been able to logically drag-n-drop
a VLAN a wire across a wide area network

108
00:08:22,380 --> 00:08:23,449
across the whole internet

109
00:08:23,449 --> 00:08:31,259
and connects a year VLAN 10 to VLAN 10
from plant in south of South America to

110
00:08:31,259 --> 00:08:37,229
VLAN 10 somewhere here in Europe Ltd v
three you can drag and drop a pseudowire

111
00:08:37,229 --> 00:08:42,409
across the Internet and Bridget traffic
all across the network and you basically

112
00:08:42,409 --> 00:08:46,290
connected your two layer 2 network
domains so all those old-school air to

113
00:08:46,290 --> 00:08:51,599
attacks you could possibly use across
the water in network using ltp v3 this

114
00:08:51,600 --> 00:08:55,070
is another technique that you might use
you know if you get access to the

115
00:08:55,070 --> 00:08:58,880
routers they're never going to see this
stuff coming if you get when you get

116
00:08:58,880 --> 00:09:01,610
access to some techniques which might be
to use that you're going to have a

117
00:09:01,610 --> 00:09:03,269
feature set to support it

118
00:09:03,269 --> 00:09:09,209
no technique to beware of if you're out
popping shells on routers getting

119
00:09:09,209 --> 00:09:15,369
getting enable access from Cisco boxes
if you if they've got the feature set on

120
00:09:15,370 --> 00:09:19,930
the routers and if they don't know if
it's inside your rules of engagement you

121
00:09:19,930 --> 00:09:23,849
might go and upgrade their router coach
forum as if you can access the public

122
00:09:23,850 --> 00:09:29,630
not going no you've gotten access in the
rules of engagement they got the memory

123
00:09:29,630 --> 00:09:33,279
supported by now go and upgrade their
coach forum so that you can get the

124
00:09:33,279 --> 00:09:36,750
pictures that you need you want the
project so maybe one of the features

125
00:09:36,750 --> 00:09:39,690
that you might add to the network of it
doesn't already exist is lawful

126
00:09:39,690 --> 00:09:42,899
intercept or lawful intercept is the
capability that law enforcement

127
00:09:42,899 --> 00:09:48,420
typically uses to do an ip-based wiretap
where you got two entities that are

128
00:09:48,420 --> 00:09:52,839
talking there is a Ventura state law
enforcement will they can go in to find

129
00:09:52,839 --> 00:09:56,930
the traffic that is of interest in the
service provider has gotta be support in

130
00:09:56,930 --> 00:10:01,089
the us- we call it a war in every day
that say a service provider cannot

131
00:10:01,089 --> 00:10:05,649
provide this capability where a 42 in
two days are talking in the law

132
00:10:05,649 --> 00:10:08,899
enforcement wants a copy of that traffic
where they get a copy of everything has

133
00:10:08,899 --> 00:10:13,889
been said it's a $10,000 a day fine so
they have this capability in the cloud

134
00:10:13,889 --> 00:10:18,540
well what if this is in the network
infrastructure if we're out there hiking

135
00:10:18,540 --> 00:10:22,449
network infrastructure walking we take
advantage of this if we're going get

136
00:10:22,449 --> 00:10:26,649
access to some network infrastructure
that has a lawful intercept or fits in

137
00:10:26,649 --> 00:10:31,850
our rules of engagement we can turn on
the features added at the features

138
00:10:31,850 --> 00:10:38,779
why can we not go use that password how
can you go and do the unexpected so we

139
00:10:38,779 --> 00:10:43,630
could possibly go in and hiked their
router and all the traffic that is of

140
00:10:43,630 --> 00:10:46,870
interest to us we could define with an
access control lists and maybe get a

141
00:10:46,870 --> 00:10:51,180
copy of it maybe we can go and get it to
credentials that we need to escalate our

142
00:10:51,180 --> 00:10:54,660
access on the network infrastructure to
something to consider

143
00:10:54,660 --> 00:10:59,219
and of course the box and you know our
system is going to be captured all that

144
00:10:59,220 --> 00:11:03,699
traffic where we can sniff it somewhat
interesting traffic we're getting there

145
00:11:03,699 --> 00:11:09,269
is a technique would run across what's
happening here is you have a service

146
00:11:09,269 --> 00:11:16,380
provider they've gotten into the cable
TV business IPTV their streaming their

147
00:11:16,380 --> 00:11:20,709
streaming multicast traffic from a
third-party service provider that is got

148
00:11:20,709 --> 00:11:27,410
ahead and where they sale IPTV services
across their fiber network they may have

149
00:11:27,410 --> 00:11:33,399
a big large when they provide
centralized IPTV streaming services to

150
00:11:33,399 --> 00:11:37,230
numerous smaller service of others and
so they're gonna bring their connection

151
00:11:37,230 --> 00:11:41,439
in in what's what you're gonna have a
school come into that network over on

152
00:11:41,439 --> 00:11:45,069
the road will call ahead Ian and the
total world like all of the central

153
00:11:45,069 --> 00:11:49,160
office enterprise will call it a data
sooner in the in the cable TV world

154
00:11:49,160 --> 00:11:52,959
ecology ahead and so you're going to
strain traffic from that managed service

155
00:11:52,959 --> 00:11:57,709
provider up in the upper left-hand
corner over 22 that cable hit TV headend

156
00:11:57,709 --> 00:12:00,869
on the rot it typically that cable TV
heading and is gonna be full of a bunch

157
00:12:00,870 --> 00:12:06,470
of Solaris boxes you guys had been pen
testing for a long time been doing it

158
00:12:06,470 --> 00:12:10,529
for no school Solaris guy like I am you
know there's some there's some rich old

159
00:12:10,529 --> 00:12:14,290
school vulnerabilities in Solaris box as
you get in these networks they don't

160
00:12:14,290 --> 00:12:18,730
give patch they don't get upgraded to
get this stuff working nobody touches

161
00:12:18,730 --> 00:12:23,850
anything to get stolen forklift upgraded
or somebody dies or retires you don't

162
00:12:23,850 --> 00:12:28,160
touch the stuff because it's working and
its makin money you don't screw up the

163
00:12:28,160 --> 00:12:33,380
TV when the Gaza City home flicking
channels it better be working so this

164
00:12:33,380 --> 00:12:36,709
stuff gets ploy to secure going to start
packing their stuff if it's an

165
00:12:36,709 --> 00:12:40,550
engagement is gonna be a really rich
environment for popping shells on

166
00:12:40,550 --> 00:12:43,949
Solaris boxes but the problem we have is

167
00:12:43,950 --> 00:12:48,080
with multicast with multicast routing

168
00:12:48,080 --> 00:12:52,510
stream these servers that are over in
the right-hand corner in the cable TV

169
00:12:52,510 --> 00:12:58,370
heading to for them to forward the
multicast traffic they have to have a

170
00:12:58,370 --> 00:13:04,450
route pointed back to the source network
so these devices on the right hand side

171
00:13:04,450 --> 00:13:09,110
most of those systems are involved with
the multicast IPTV are going to have

172
00:13:09,110 --> 00:13:12,240
their default routes in most case
pointed by toward that cable TV had in

173
00:13:12,240 --> 00:13:16,680
his so what we what happened in
engagement will get access to the router

174
00:13:16,680 --> 00:13:21,500
is down at the bottom center that head
around it we knew that there is a ridge

175
00:13:21,500 --> 00:13:25,330
target environment we could not get a
connectivity going and what we've

176
00:13:25,330 --> 00:13:29,650
discovered is obviously because of a
multicast routing works at Triton the

177
00:13:29,650 --> 00:13:33,280
the servers can I get a two-way
connection cuz they did not have a route

178
00:13:33,280 --> 00:13:37,290
out to the internet so will be
discovered a technique that you might

179
00:13:37,290 --> 00:13:40,230
use if you find yourself in a similar
situation where you got on the router

180
00:13:40,230 --> 00:13:43,730
and you're looking at the archives and
you see the mappings are there you know

181
00:13:43,730 --> 00:13:47,510
you got host at your apartment you can
get that to a connection will be

182
00:13:47,510 --> 00:13:48,390
discovered

183
00:13:48,390 --> 00:13:52,960
internal net turned on that on an
external interface set up some static

184
00:13:52,960 --> 00:13:57,060
NAT translations and the router will
proxy that connection you can get a

185
00:13:57,060 --> 00:14:03,030
two-way connection and you start poppin
popping shells and start pivoting

186
00:14:03,030 --> 00:14:09,319
depending on what would your rules of
engagement permit this is everywhere

187
00:14:09,320 --> 00:14:15,520
this is get this type of this type of
protocol problems are ours on Pinterest

188
00:14:15,520 --> 00:14:22,610
engagement not too long ago in a found
like six to eight protocol problems of a

189
00:14:22,610 --> 00:14:27,940
similar nature of this always pick up
his first job redundancy protocols BRP

190
00:14:27,940 --> 00:14:33,400
HSRP numerous protocols were there just
multicast on the wire the pin test team

191
00:14:33,400 --> 00:14:40,400
was raided two to call it a day they
were done everything was done as when in

192
00:14:40,400 --> 00:14:44,650
when into this network that had been
told he tested just call it is far to

193
00:14:44,650 --> 00:14:48,750
wash our confounds like six to eight Mon
ability just as fast as I could took

194
00:14:48,750 --> 00:14:51,950
longer to pull up bar shorter than it
did to get six to eight cat 11 abilities

195
00:14:51,950 --> 00:14:56,240
so what's gonna happen here is you don't
pull up short in a lot of these networks

196
00:14:56,240 --> 00:14:57,120
specifically in the

197
00:14:57,120 --> 00:15:03,180
surprises in to go see the OSPF EIGRP
you still can see some rip out there

198
00:15:03,180 --> 00:15:10,199
there's a I do run into rip occasionally
still reversion to in in in G four b6

199
00:15:10,200 --> 00:15:16,860
and what's happened is most typically
they're not going to be running any kind

200
00:15:16,860 --> 00:15:21,730
of indication though they can run a hash
authentication between the routers

201
00:15:21,730 --> 00:15:25,570
they're not gonna be running at the
typical will not be doing that if

202
00:15:25,570 --> 00:15:28,940
they're running authentication is gonna
be clear texted indication so you don't

203
00:15:28,940 --> 00:15:32,580
have to worry about cracking the Indy
500 sure and I like that cuz its tip if

204
00:15:32,580 --> 00:15:37,540
they're doing it it's going to be open
the other than others but most likely

205
00:15:37,540 --> 00:15:40,270
what you're going to see is no
authentication at all this is going to

206
00:15:40,270 --> 00:15:44,630
be out in the open in traffic should not
be dropped into the veal and begin with

207
00:15:44,630 --> 00:15:49,010
the end users should not be seen that
OSPF traffic should be passive so that

208
00:15:49,010 --> 00:15:53,650
the routers only advertising networks
but for the VLANs but the end users

209
00:15:53,650 --> 00:15:58,740
should not be able to see that traffic
so what you can do is visit your rules

210
00:15:58,740 --> 00:16:04,240
of engagement brother doing on Pinterest
red team engagement why not go if their

211
00:16:04,240 --> 00:16:09,570
advertising and OSPF and EIGRP the rip
out into that deal and that you've

212
00:16:09,570 --> 00:16:13,240
gotten access to why not take advantage
of it in fire up your own router

213
00:16:13,240 --> 00:16:19,070
enjoying their routed network and start
advertising rules would be interesting

214
00:16:19,070 --> 00:16:22,370
if you're good you're in an engagement
suicide your rules of engagement you

215
00:16:22,370 --> 00:16:27,250
fire up some kind of a router and you
start advertising networks for say

216
00:16:27,250 --> 00:16:28,630
interpol

217
00:16:28,630 --> 00:16:35,529
NSA Microsoft Google advertises routes
into their internal network in their

218
00:16:35,529 --> 00:16:39,310
source your attacks your PIN 10 whatever
you're doing your pen testing source

219
00:16:39,310 --> 00:16:44,029
source your traffic from copies of those
blocks your film if they start somebody

220
00:16:44,029 --> 00:16:46,689
gets Mar start looking at the logs
they're going to see attacks from

221
00:16:46,690 --> 00:16:50,860
somewhere out in the world you really
only inside your gonna be like keystone

222
00:16:50,860 --> 00:16:54,660
cops watching them go out into who is
resolved looking at these IP addresses

223
00:16:54,660 --> 00:16:57,949
for organizations are out there
somewhere in the world but you're

224
00:16:57,950 --> 00:17:01,510
actually on the inside injecting the
routes into their network how we

225
00:17:01,510 --> 00:17:08,079
probably do that is using something like
walking on your Linux box or are using

226
00:17:08,079 --> 00:17:10,470
the NRL core if you go out to the Naval

227
00:17:10,470 --> 00:17:16,100
search lab they have a tool called core
routers to really network simulation

228
00:17:16,099 --> 00:17:21,079
environment if you don't know about the
NRL core unity will check that out maybe

229
00:17:21,079 --> 00:17:26,918
we go and fire up GSN three down you
know we've got a copy of OS or Juno else

230
00:17:26,919 --> 00:17:32,750
or something we fire up a router and
Jason three enjoying their network start

231
00:17:32,750 --> 00:17:42,140
advertising routes no BGP has been in
the news a whole lot here lately if you

232
00:17:42,140 --> 00:17:46,549
follow and especially on Twitter and
large animal lot of the threads are

233
00:17:46,549 --> 00:17:51,740
following there's been lots of attacks
where IP addresses are being hijacked if

234
00:17:51,740 --> 00:17:54,450
you if you don't follow it on Twitter
for on Twitter you need to be following

235
00:17:54,450 --> 00:18:00,210
BGP strain in there's like daily updates
tweets coming out where IP networks are

236
00:18:00,210 --> 00:18:03,549
being hijacked the people are not
looking for in this is this is happening

237
00:18:03,549 --> 00:18:07,250
like crazy it's hard to keep this up
today positions more and more data

238
00:18:07,250 --> 00:18:11,520
coming up on networks are being hijacked
in Mexico what happens with the BGP

239
00:18:11,520 --> 00:18:15,100
hijacking years and if you're not
familiar with BGP is the protocol that

240
00:18:15,100 --> 00:18:19,789
runs the global internet if you're not
running BGP Europe string service

241
00:18:19,789 --> 00:18:24,669
providers are running BGP for you your
typical if you're near project run BGP

242
00:18:24,669 --> 00:18:27,530
if you have multiple connections to the
global internet and you have the ability

243
00:18:27,530 --> 00:18:31,250
to fell over between connections you're
not gonna be running BGP if you got like

244
00:18:31,250 --> 00:18:35,760
redundant DSL cable connections is gonna
be big pops in the internet typical

245
00:18:35,760 --> 00:18:39,419
enterprise or service about who's gonna
be running BGP

246
00:18:39,419 --> 00:18:44,370
have an alias number of your gonna get
safe from Aaron here in Europe and North

247
00:18:44,370 --> 00:18:48,250
America wrap here in Europe and they
give you his number you're gonna have

248
00:18:48,250 --> 00:18:52,669
your IP space that you got from baby
ipv4 and ipv6 and there's an implicit

249
00:18:52,669 --> 00:18:56,250
trust relationship out there between
these s numbers and there's nothing to

250
00:18:56,250 --> 00:19:02,130
stop someone from accidentally it's
always an accident is always an accident

251
00:19:02,130 --> 00:19:10,510
if I did he would be an accident but
somebody's going to accidentally start

252
00:19:10,510 --> 00:19:14,520
advertising your IP addresses as Thurs
and what could happen if they're not

253
00:19:14,520 --> 00:19:17,429
gonna get all of your traffic but
traffic that has got a more preferred

254
00:19:17,429 --> 00:19:22,149
metric to whatever network is hijacking
your IP addresses his golf swing over

255
00:19:22,149 --> 00:19:23,010
toward them

256
00:19:23,010 --> 00:19:26,629
in there they're going dropped her
traffic in the bitbucket or they can go

257
00:19:26,630 --> 00:19:32,000
and captures traffic and poured it on or
maybe capture traffic and defined

258
00:19:32,000 --> 00:19:33,910
traffic that is of interest

259
00:19:33,910 --> 00:19:38,630
capture it modify and rebuild the check
summary fired on two hits in destination

260
00:19:38,630 --> 00:19:43,190
possibly pins on what their motive is
that this is happening like crazy in

261
00:19:43,190 --> 00:19:49,140
yorba following BGP stream on Twitter if
you're not already to see how bad this

262
00:19:49,140 --> 00:19:56,270
problem is crazy but here's my question
to you guys have run him pls or have

263
00:19:56,270 --> 00:20:01,420
customers running MPLS if you're if
you're not if you're running in pillows

264
00:20:01,420 --> 00:20:07,540
are you monitoring your MPLS VPNs to see
if there's new networks being injected

265
00:20:07,540 --> 00:20:13,129
into your private MPLS VPN are you
running some kind of encrypted VPN

266
00:20:13,130 --> 00:20:19,670
across it just because VPN is used in
the terminology in MPLS does not mean

267
00:20:19,670 --> 00:20:25,670
it's encrypted are our terminology is
being hijacked in one of the key

268
00:20:25,670 --> 00:20:31,450
examples is VPN VPN virtual private
network does not imply encryption as you

269
00:20:31,450 --> 00:20:38,320
see here in this diagram a deal and is a
VPN the open new Frame Relay ATM PVCs X

270
00:20:38,320 --> 00:20:44,570
225 circuits those are all examples of
BPM ends they're not encrypted why do we

271
00:20:44,570 --> 00:20:48,800
want to assume that an MPLS VPN is
encrypted cuz they're not we do not have

272
00:20:48,800 --> 00:20:55,030
encryption into we overlay encryption
across the MPLS network know what I want

273
00:20:55,030 --> 00:21:00,340
you to get out of this this piece of the
talk is if if if BGP is being hijacked

274
00:21:00,340 --> 00:21:05,280
your IP networks in the public Internet
are being hijacked why would a bad guy

275
00:21:05,280 --> 00:21:09,940
why would a criminal nation state
organization not be also hijacking the

276
00:21:09,940 --> 00:21:14,420
MPLS networks if they have this router
axis I'll build the service provider

277
00:21:14,420 --> 00:21:17,720
networks are living when I'm not out
doing security work I'll build service

278
00:21:17,720 --> 00:21:21,450
service about her telco critical
infrastructure networks and we put him

279
00:21:21,450 --> 00:21:24,890
be a far as big freaking routers you
know where your server guys are

280
00:21:24,890 --> 00:21:29,710
virtualizing servers will the router
guys like me were virtual routers with

281
00:21:29,710 --> 00:21:35,900
MPLS and we all just put in one big
rounded big as a door into the

282
00:21:35,900 --> 00:21:40,630
Philip Iraq in a gas card up in with get
your internet we got all the different

283
00:21:40,630 --> 00:21:45,540
customers internet all the different
MPLS VPNs IPTV all the voice over IP

284
00:21:45,540 --> 00:21:49,690
services are all one run across one big
rather than install carbon virtually

285
00:21:49,690 --> 00:21:56,590
with MPLS in most cases and so whoever
is doing the BGP hijacking most likely

286
00:21:56,590 --> 00:22:02,449
has access to a lot of customers MPLS
networks linking the criminal counts if

287
00:22:02,450 --> 00:22:05,710
I ever go criminal I'm going over all
the money I'm not going to a little bit

288
00:22:05,710 --> 00:22:12,550
I'm going to think about this so here's
what's going on with him pls for you

289
00:22:12,550 --> 00:22:14,190
guys and those are not familiar with it

290
00:22:14,190 --> 00:22:19,200
give you a real quick overview MPLS
works at layer 2 Dodge Viper there was a

291
00:22:19,200 --> 00:22:25,230
model it works as a sham between the
data link and network layers as well as

292
00:22:25,230 --> 00:22:30,840
shown here you're seeing this this slide
a packet capture between the Ethernet

293
00:22:30,840 --> 00:22:35,790
header in the IP header we have the MPLS
labels and you're gonna be available for

294
00:22:35,790 --> 00:22:39,389
download so you can look at this offline
but you'll see there's three different

295
00:22:39,390 --> 00:22:44,150
MPLS labels injected therefore the MPLS
VPN MPLS traffic engineering etc

296
00:22:44,150 --> 00:22:49,650
although that you can look at and here's
how the MPLS network is architected and

297
00:22:49,650 --> 00:22:52,470
the core of the service about it has
what they call PE routers and they're

298
00:22:52,470 --> 00:22:56,980
doing speeds and feeds these are the big
routers that are just pushing major pop

299
00:22:56,980 --> 00:23:01,230
that's where your FortiGate 100 gig
traffic is being where is being put in

300
00:23:01,230 --> 00:23:05,500
first in the networks as they upgrade
and then you get out to the edge with

301
00:23:05,500 --> 00:23:08,860
the provider edge and that's where
they're aggregating all the customer

302
00:23:08,860 --> 00:23:12,780
traffic is almost PE routers the PE
routers is where the magic happen with

303
00:23:12,780 --> 00:23:17,100
the BGP hijacking and that's where all
so that's where your Internet traffic is

304
00:23:17,100 --> 00:23:21,149
being aggregated that's where you and
pls bpm your Metro Ethernet all those

305
00:23:21,150 --> 00:23:25,100
services your voice over IP yourself
services all of that is coming from

306
00:23:25,100 --> 00:23:28,209
those PE routers from outer edge and
then you get out there to the edge to

307
00:23:28,210 --> 00:23:31,540
the Seas which is the customer edge
routers which is whatever type of

308
00:23:31,540 --> 00:23:34,260
routers services that you have about it

309
00:23:34,260 --> 00:23:39,400
your customers and what happens is we
gon car these networks up with MPLS VPNs

310
00:23:39,400 --> 00:23:43,200
it's going to carve out these networks
so that we can have redundant IP

311
00:23:43,200 --> 00:23:46,950
addresses and things like that all the
networks because

312
00:23:46,950 --> 00:23:51,190
we don't see each other because they're
all in MPLS VPNs

313
00:23:51,190 --> 00:23:55,950
like ships in the night here's an
example of the config there's his house

314
00:23:55,950 --> 00:24:00,590
and get accidentally mess up your the
router configs on a provider edge router

315
00:24:00,590 --> 00:24:06,929
and start injecting routes into your
network or possibly bleeding routes out

316
00:24:06,930 --> 00:24:12,390
of your network into somebody else's
MPLS VPN in and basically what you're

317
00:24:12,390 --> 00:24:18,480
doing what they do their create a verse
to talk to create a coach purse for each

318
00:24:18,480 --> 00:24:22,400
customer VPN to create a route
descriptor to find that bpm and then

319
00:24:22,400 --> 00:24:27,080
you're going to create a route target
statement that's going to imply the

320
00:24:27,080 --> 00:24:31,990
policy for importing and exporting bpm
routes and that import export is where

321
00:24:31,990 --> 00:24:37,010
the magic happens of pulling routes in
and out and so if somebody accidentally

322
00:24:37,010 --> 00:24:41,800
fat fingers down that route target
statement they could pull networks into

323
00:24:41,800 --> 00:24:45,700
your network or bleeding bleed traffic
out of your network into somebody else's

324
00:24:45,700 --> 00:24:55,480
it is just how simple and easy it is and
this is what it's gonna like you guys in

325
00:24:55,480 --> 00:24:58,820
our program routers maybe an enterprise
you haven't dealt with the MPLS you're

326
00:24:58,820 --> 00:25:02,409
simply familiar with doing show up here
outs are you see your global routing

327
00:25:02,410 --> 00:25:05,800
table when you gonna start turning on
the MPLS what's gonna happen is you

328
00:25:05,800 --> 00:25:10,620
going to show up here out into space
fiber fan you might specify the customer

329
00:25:10,620 --> 00:25:14,540
bpm the MPLS VPN and you're interested
in and then you will only see those

330
00:25:14,540 --> 00:25:17,920
routes because we're like ships in the
night in the router now we got were

331
00:25:17,920 --> 00:25:22,170
showing 3 router tables were on the same
pop on the same router running across

332
00:25:22,170 --> 00:25:25,340
the same bomber but we don't see each
other

333
00:25:25,340 --> 00:25:33,620
ships in the night contest concept and
this is what it looks like from the

334
00:25:33,620 --> 00:25:37,770
provider aged provider edge with BGP
community strings because those provider

335
00:25:37,770 --> 00:25:41,910
edge routers as PE routers are going run
BGP between them across the core network

336
00:25:41,910 --> 00:25:46,650
in they're going to advertise the MPLS
circus this is just a pcap that you can

337
00:25:46,650 --> 00:25:52,850
look at awful I'm so how does a service
provider network get compromised let's

338
00:25:52,850 --> 00:25:57,500
assume that there's no insider threat
that's too big or around when you goin

339
00:25:57,500 --> 00:26:03,970
to Pinterest there's no insider threat
so maybe this going this goes from the

340
00:26:03,970 --> 00:26:07,330
standpoint that every ball the threats
are outsiders how's the trip going to

341
00:26:07,330 --> 00:26:11,129
get access to this network when I come
in and I'll look at a look at the trust

342
00:26:11,130 --> 00:26:14,560
relationships I go and get all the Intel
I can about the organization where

343
00:26:14,560 --> 00:26:17,970
they've leaked out lots of good
information their press releases

344
00:26:17,970 --> 00:26:21,830
bragging about the infrastructure that
are running LinkedIn etc and we're gonna

345
00:26:21,830 --> 00:26:27,679
go and analyze the trust relationships
the network management system the

346
00:26:27,680 --> 00:26:31,290
business systems the web apps accepted
that they're running the different

347
00:26:31,290 --> 00:26:37,220
vendors it make up that system is one
thing about vendors there consistent in

348
00:26:37,220 --> 00:26:40,620
their gonna roll out everybody's network
assistance so when the field engineers

349
00:26:40,620 --> 00:26:45,439
go out and work on the new work they get
called in on side to help you fix it or

350
00:26:45,440 --> 00:26:50,340
you call in to the help desk for remote
support they know what they're dealing

351
00:26:50,340 --> 00:26:53,889
with so they would come up with template
architectures and we're all things out

352
00:26:53,890 --> 00:26:58,230
pretty consistent in so if you can go
and get that kind of Intel

353
00:26:58,230 --> 00:27:02,880
gonna help you come up with a strategy
and what I like to do is develop attack

354
00:27:02,880 --> 00:27:06,570
trees when I get together all this
information I go and develop attack

355
00:27:06,570 --> 00:27:09,970
trees at rule that I recommend you look
at using for developing your own attack

356
00:27:09,970 --> 00:27:15,590
trees it cranks it up a notch his mount
my ex mind use X mind to develop your

357
00:27:15,590 --> 00:27:20,050
own attack trees the documentary
strategy in flow-through in how you may

358
00:27:20,050 --> 00:27:24,300
go after that organization's network one
of those vectors of you do a good job

359
00:27:24,300 --> 00:27:30,760
you're gonna find a way so that we have
here is a single source about a network

360
00:27:30,760 --> 00:27:33,900
architecture this is a single service
provider

361
00:27:33,900 --> 00:27:39,700
they got there are top of their internet
connections out to the core global

362
00:27:39,700 --> 00:27:43,720
Internet you brought drop into their
core Internet architecture in your drop

363
00:27:43,720 --> 00:27:48,330
down into their MPLS network and the
bottom you should I show where their

364
00:27:48,330 --> 00:27:55,230
aggregating different customer services
when I first created this tall can I not

365
00:27:55,230 --> 00:28:01,270
presented yet I talked to be sides and
was talking about that I was working on

366
00:28:01,270 --> 00:28:06,830
this presentation the gentleman came up
to me after the b-sides conference we

367
00:28:06,830 --> 00:28:10,679
were at the at the party after the
conference he said people better listen

368
00:28:10,680 --> 00:28:16,020
to the team pls conversation you haven't
because I kalt traffic from another

369
00:28:16,020 --> 00:28:21,830
country coming from MPLS network same
architecture single service provider

370
00:28:21,830 --> 00:28:28,970
MPLS network regional MPLS network only
one serves about her involved he called

371
00:28:28,970 --> 00:28:34,500
traffic coming from another country from
his MPLS VPN back out his firewall it

372
00:28:34,500 --> 00:28:37,930
wasn't the service provider called him
and told him that they've been hiked in

373
00:28:37,930 --> 00:28:44,380
as a result he had traffic coming in
from hit into his private MPLS VPN 12

374
00:28:44,380 --> 00:28:49,500
telco he founded in his own firewall
logs and he tried he traced it back to

375
00:28:49,500 --> 00:28:55,710
another country and so this is a real
this is the real deal story so what

376
00:28:55,710 --> 00:28:59,860
would you do if they break into the
network using the methodology we just

377
00:28:59,860 --> 00:29:02,610
looked at on the attack tree or
forgotten insider threat maybe they do

378
00:29:02,610 --> 00:29:06,080
some of those techniques that we just
talked about the lawful intercept maybe

379
00:29:06,080 --> 00:29:11,000
the ltp v3 they are span of the GRE
tunnel maybe they go and create a GRE

380
00:29:11,000 --> 00:29:15,610
tunnel to the router elsewhere on the
internet and add that tunnel to the MPLS

381
00:29:15,610 --> 00:29:21,110
network and join join your private MPLS
wide area network maybe you end up with

382
00:29:21,110 --> 00:29:25,360
a whole new side on your network and
their injector routes into your profit

383
00:29:25,360 --> 00:29:30,090
network for your institution my question
is if someone has joined your MPLS

384
00:29:30,090 --> 00:29:34,370
private know where can you detected do
you know if they're running MPLS VPNs

385
00:29:34,370 --> 00:29:38,320
now do you know that you have that
visibility are you doing that level of

386
00:29:38,320 --> 00:29:42,360
monitoring most of the networks people I
talk to you they have no clue the only

387
00:29:42,360 --> 00:29:46,379
ones that are really protected or the
ones that have an overlay encrypted VPN

388
00:29:46,380 --> 00:29:47,270
across it

389
00:29:47,270 --> 00:29:58,340
so here's a an attack vector were
someone may go in getting to a telco may

390
00:29:58,340 --> 00:30:02,260
walk into this is a real world story
with all the details removed to keep me

391
00:30:02,260 --> 00:30:10,740
out from being sued prosecuted but
Israel I came across a network customer

392
00:30:10,740 --> 00:30:16,820
was moving from one telco to a second
telco the first telco they had the

393
00:30:16,820 --> 00:30:22,379
customer had like 60 + circuits with the
first telco and they were moving to the

394
00:30:22,380 --> 00:30:26,380
second telco they've been the contract
had been in place for a very long time

395
00:30:26,380 --> 00:30:33,630
the Toco decided that you know what this
since we're losing the contract it's

396
00:30:33,630 --> 00:30:37,240
going to cost us more money than the
equipment's work the ship it back and

397
00:30:37,240 --> 00:30:41,360
his men do something with it they just
abandon it in place they've been in all

398
00:30:41,360 --> 00:30:43,000
the equipment in place

399
00:30:43,000 --> 00:30:46,840
my customer through merger and
acquisition doubled in size very rapidly

400
00:30:46,840 --> 00:30:53,120
and he's like I do appreciate you know
you're so male the 60 plus routers for

401
00:30:53,120 --> 00:30:57,469
the first project now we just doubled in
size and we're going to need sixty to

402
00:30:57,470 --> 00:31:01,260
eighty more routers but guess what they
abandon all that equipment we're going

403
00:31:01,260 --> 00:31:04,430
to use that equipment they got abandoned
customers started doing password

404
00:31:04,430 --> 00:31:08,050
recoveries and guess what was on that
information about right hand corner

405
00:31:08,050 --> 00:31:11,950
their usernames passwords all the
routing information there SNMP community

406
00:31:11,950 --> 00:31:18,430
strings their access control dust for
their security policies you name it it

407
00:31:18,430 --> 00:31:22,830
was in there the keys to the kingdom was
laid out there it was beautiful and

408
00:31:22,830 --> 00:31:25,800
around Gaza it was the tightest
routerconfig was a beautiful daughter

409
00:31:25,800 --> 00:31:30,530
can fix it was nearly perfect a separate
they left the routers out there for

410
00:31:30,530 --> 00:31:35,590
somebody password recovery in and so
what did you do with that simple this is

411
00:31:35,590 --> 00:31:39,510
just one example us all you hear that
you know the cliched a lot about

412
00:31:39,510 --> 00:31:43,040
everybody go out on eBay and buy
equipment and you can find similar

413
00:31:43,040 --> 00:31:46,420
information will this happen real world
for me

414
00:31:46,420 --> 00:31:52,590
information is is all the information is
all the keys you need attributes for a

415
00:31:52,590 --> 00:31:55,820
pair of the top with the network if you
go in

416
00:31:55,820 --> 00:31:59,750
and get on LinkedIn going to find out
who the network guys are into a social

417
00:31:59,750 --> 00:32:04,090
engineering attacks maybe do some
fishing attacks in get access to to the

418
00:32:04,090 --> 00:32:09,600
right network guys home computer or
laptop you can go turnaround in bpm

419
00:32:09,600 --> 00:32:15,030
piggyback on that gentleman who are
mighty river to get into that network

420
00:32:15,030 --> 00:32:19,480
and you're going to know exactly what
systems to go target now as you've got

421
00:32:19,480 --> 00:32:22,370
all the information out there
routerconfig you know what IP address if

422
00:32:22,370 --> 00:32:25,870
you don't have to go to any screening
you know I'm going to a surgical attack

423
00:32:25,870 --> 00:32:29,159
against their network infrastructure and
oh by the way you get the username

424
00:32:29,160 --> 00:32:33,340
password in most likely all things mean
consistent you're going to get into

425
00:32:33,340 --> 00:32:38,030
their optical infrastructure go down to
like later 0 maybe they're DWD a.m.

426
00:32:38,030 --> 00:32:43,010
network where their multiplexing optical
wavelengths over their fiber nowhere

427
00:32:43,010 --> 00:32:46,410
maybe you give your able to go and
that's your privilege into their song it

428
00:32:46,410 --> 00:32:52,040
tedium SDH network all the way up into
the router switch networked maybe

429
00:32:52,040 --> 00:32:56,710
further up the stack into the servers
that information to the dominoes are

430
00:32:56,710 --> 00:33:03,680
going to fall there's a way that the
network would be taken over told her

431
00:33:03,680 --> 00:33:07,410
something to think about for the
organizations that are running in pls

432
00:33:07,410 --> 00:33:12,760
globally maybe you got em pillo circuits
going from South America to Europe you

433
00:33:12,760 --> 00:33:17,110
know Europe to Asia the parts of the
world when you're out there by noon pls

434
00:33:17,110 --> 00:33:24,110
circuits you might help one bill for all
your circuits have couple hundred MPLS

435
00:33:24,110 --> 00:33:28,889
circuits you got to get one throat to
choke you got one telco to provide your

436
00:33:28,890 --> 00:33:32,920
billing for you that you buy your appeal
a circus for what I want you to get out

437
00:33:32,920 --> 00:33:37,070
of this is they don't own the telco
services the infrastructure for the

438
00:33:37,070 --> 00:33:40,780
whole world they have peering agreements
just like we do in BGP internetworld

439
00:33:40,780 --> 00:33:47,010
they haven't for the private networks as
well have peering points cross connects

440
00:33:47,010 --> 00:33:52,270
where where MPLS networks together and
as soon as you leave your service

441
00:33:52,270 --> 00:33:56,230
provider in your home country you start
going outside the country you're getting

442
00:33:56,230 --> 00:33:59,780
published on multiple different service
providers networks you're inheriting a

443
00:33:59,780 --> 00:34:03,370
trust relationship with all the
criminals in nation states in between

444
00:34:03,370 --> 00:34:07,260
point A to point B that your circle
circuits are terminating with

445
00:34:07,260 --> 00:34:14,540
this is going to reinforce to you the
most likely what's happening if because

446
00:34:14,540 --> 00:34:19,310
it's happening with BGP on the public
Internet why would anyone is doing this

447
00:34:19,310 --> 00:34:21,699
not due to the MPLS circuits as well

448
00:34:21,699 --> 00:34:25,819
less bad guys have changed the criminals
that I know they're going after all the

449
00:34:25,820 --> 00:34:29,870
money I know how to do they know what
they have access to the BGP routers they

450
00:34:29,870 --> 00:34:35,790
know BGP they know MPLS as well and
there probably are taking advantage of

451
00:34:35,790 --> 00:34:44,040
this so not all bad news here's what you
should be doing on the BGP side if

452
00:34:44,040 --> 00:34:48,120
you're not already monitoring your IP
prefixes Mb proactively alerted when

453
00:34:48,120 --> 00:34:53,210
there's an issue where should be go out
check out something like BGP Mon

454
00:34:53,210 --> 00:34:58,290
BGP mom who got bought by OpenDNS who
will buy Cisco recently they offer a

455
00:34:58,290 --> 00:35:02,340
service where you can give him your IP
prefixes and they will proactively alert

456
00:35:02,340 --> 00:35:08,040
you whenever your IP addresses have been
hijacked you can go and check out BGP

457
00:35:08,040 --> 00:35:12,380
stream on Twitter they have a service
where they're tweeting out IP networks

458
00:35:12,380 --> 00:35:18,940
as they get hijacked I prefer the BGP
market it's all automated for me and I

459
00:35:18,940 --> 00:35:22,090
know exactly what's happening with my IP
addresses all my customers IP addresses

460
00:35:22,090 --> 00:35:27,360
another thing I would look at is why not
go ahead and look at your PC industry

461
00:35:27,360 --> 00:35:31,750
peers maybe your suppliers that hoe
trust relationship you have in the

462
00:35:31,750 --> 00:35:32,730
industry

463
00:35:32,730 --> 00:35:38,300
whoever you know maybe you're doing your
contractors are there providing services

464
00:35:38,300 --> 00:35:44,950
why not going monitor people in your
chain of trust their IP prefixes to see

465
00:35:44,950 --> 00:35:49,710
if they're being hijacked in your
competitors why not going monitors the

466
00:35:49,710 --> 00:35:53,740
IP prefixes of your competitors and see
if they're being hijacked it may give

467
00:35:53,740 --> 00:35:57,700
you an early warning that your next if
they're interested in your competition

468
00:35:57,700 --> 00:35:59,960
they're interested in your suppliers

469
00:35:59,960 --> 00:36:02,660
maybe they're interested in you as well
maybe they're going to get off of them

470
00:36:02,660 --> 00:36:09,710
off the information that you don't know
for non-monetary on the MPLS standpoint

471
00:36:09,710 --> 00:36:17,930
research voter you're going to go look
at doing MPLS across your core

472
00:36:17,930 --> 00:36:20,609
infrastructure most most do not I've
never seen one

473
00:36:20,610 --> 00:36:28,070
voters do IPSec encryption across our
core networks but as an enterprise you

474
00:36:28,070 --> 00:36:34,320
should be overlaying encryption across
MPLS VPNs if you're not it could very

475
00:36:34,320 --> 00:36:40,280
well could be fined that you've got the
MPLS VPNs got routes being injected into

476
00:36:40,280 --> 00:36:45,730
it and if that's the case that you're
not going over land cryptid bpm across

477
00:36:45,730 --> 00:36:50,480
Europe MPLS VPN then you really need to
be looking at your router logs and

478
00:36:50,480 --> 00:36:56,030
monitoring for unrecognized routes being
injected into your routing tables

479
00:36:56,030 --> 00:37:01,270
the other thing I'd recommend his go-to
two-factor authentication you don't want

480
00:37:01,270 --> 00:37:05,420
to use the static passwords can survive
on my way into your wherever your server

481
00:37:05,420 --> 00:37:11,230
where your router configs archiving if I
get in if I get into the those configs

482
00:37:11,230 --> 00:37:16,230
are you using static passwords I'm gonna
eat at network alive if I'm gonna do it

483
00:37:16,230 --> 00:37:19,190
who wasn't somebody is really
sophisticated no telling what they're

484
00:37:19,190 --> 00:37:23,960
going to do with this is with this is
what we're seeing is when is from the

485
00:37:23,960 --> 00:37:26,910
forensic tents respond standpoint but
he's beaten up the Microsoft governor

486
00:37:26,910 --> 00:37:32,089
but he's joking on the Microsoft but how
many networks used the same username

487
00:37:32,090 --> 00:37:36,920
password scheme for their network
infrastructure as they do on the window

488
00:37:36,920 --> 00:37:41,390
systems but nobody's challenging the
network guys they go in and do forensic

489
00:37:41,390 --> 00:37:45,109
state's response not gonna do in a full
wins in response against the routers and

490
00:37:45,110 --> 00:37:48,120
switches make sure they have been
compromised as well

491
00:37:48,120 --> 00:37:55,069
1904 recommended we talked a lot about
application whitelisting why not gonna

492
00:37:55,070 --> 00:37:58,250
implement nowhere base while listing we
should know where our trip we should

493
00:37:58,250 --> 00:38:02,210
build a traffic matrix of who's talking
to who where when and how much

494
00:38:02,210 --> 00:38:05,870
instead of waiting to get budget to roll
out some application while listing tool

495
00:38:05,870 --> 00:38:11,609
and disrupting the end user base why not
go in implementing go into a traffic

496
00:38:11,610 --> 00:38:15,540
matrix using NetFlow and I get a
baseline of what's normal for our

497
00:38:15,540 --> 00:38:20,150
network you should be talking to and
then implement a policy in our access

498
00:38:20,150 --> 00:38:26,260
control us to lock down the trust
relationships and our routing tables on

499
00:38:26,260 --> 00:38:29,970
our routers so that only the networks
that should be talking to each other can

500
00:38:29,970 --> 00:38:32,569
talk to each other anything about that

501
00:38:32,570 --> 00:38:36,630
flag it maybe if we came blocking
because because we don't have the

502
00:38:36,630 --> 00:38:40,960
confidence that we don't want to
possibly disrupt never traveled one are

503
00:38:40,960 --> 00:38:45,520
going put some logs in on it and just
log anything to just curious that we

504
00:38:45,520 --> 00:38:46,930
think that is unexpected

505
00:38:46,930 --> 00:38:50,859
if we don't wanna go block it in England
investigated and identify why are these

506
00:38:50,860 --> 00:38:54,510
networks talking to each other when they
shouldn't be on the internal network now

507
00:38:54,510 --> 00:39:01,410
just at the perimeter so here's some
references that you may want to check

508
00:39:01,410 --> 00:39:04,970
out all the city slides are gonna be
available here's a bunch of references

509
00:39:04,970 --> 00:39:10,310
both papers you can go back and look at
if you want to dig into this further one

510
00:39:10,310 --> 00:39:11,630
of the best sources out there

511
00:39:11,630 --> 00:39:18,950
the ER in W guys Germany they're also
their publishes the more the top network

512
00:39:18,950 --> 00:39:24,180
security firms in the world in my
opinion they do a really deep dive in

513
00:39:24,180 --> 00:39:27,819
network infrastructure so I recommend
you go check out the R&W in a lot of

514
00:39:27,820 --> 00:39:34,660
papers that they published on MPLS layer
to layer 3 security ipv6 came

515
00:39:34,660 --> 00:39:38,399
recommittal came recommended you go look
at their their papers strongly enough

516
00:39:38,400 --> 00:39:44,130
and Yvonne that right there below the
R&W link their check out of bonds

517
00:39:44,130 --> 00:39:49,820
references he's got a Blogspot he's also
always comes out on Twitter go check out

518
00:39:49,820 --> 00:39:53,960
his resources he does he goes far beyond
what I've grown in these slides between

519
00:39:53,960 --> 00:39:58,950
your in W Devon UK wealth of information
and also affects if you don't know where

520
00:39:58,950 --> 00:40:03,680
you got to go do again to have access
information just a wealth of wealth of

521
00:40:03,680 --> 00:40:14,259
information out there so that's why I
had questions and questions

522
00:40:14,260 --> 00:40:20,300
appreciate everyone's time sticking
women this afternoon coming out here

523
00:40:20,300 --> 00:40:24,980
much thank you for up before I quit
unrelated think death count for limit

524
00:40:24,980 --> 00:40:31,320
come to Romania in the tradition had a
wonderful wonderful time here Romania

525
00:40:31,320 --> 00:40:37,290
can't wait to go and see more of the
country but a lot of great people liked

526
00:40:37,290 --> 00:40:37,700
it so much

