1
00:00:00,080 --> 00:00:02,480
it is my great pleasure to um invite

2
00:00:02,480 --> 00:00:04,880
lucas defanco on stage he's a senior

3
00:00:04,880 --> 00:00:07,759
malware researcher at eset in slovakia

4
00:00:07,759 --> 00:00:10,400
home of some of the coolest video games

5
00:00:10,400 --> 00:00:13,360
written during the 1980s lucas tackles a

6
00:00:13,360 --> 00:00:15,839
topic we don't talk enough about he will

7
00:00:15,839 --> 00:00:17,840
describe some of the vulnerabilities he

8
00:00:17,840 --> 00:00:21,039
discovered in android soccer apps lucas

9
00:00:21,039 --> 00:00:22,880
the floor is yours

10
00:00:22,880 --> 00:00:26,080
so hello everybody again

11
00:00:26,080 --> 00:00:27,279
um

12
00:00:27,279 --> 00:00:29,679
today right now i would like to share

13
00:00:29,679 --> 00:00:31,920
with you our research about

14
00:00:31,920 --> 00:00:33,680
vulnerabilities and privacy issues

15
00:00:33,680 --> 00:00:36,000
discovered in android stalker

16
00:00:36,000 --> 00:00:38,559
applications

17
00:00:38,559 --> 00:00:40,399
if you thought that social media knows

18
00:00:40,399 --> 00:00:42,480
everything about you you were right

19
00:00:42,480 --> 00:00:45,039
however today i will tell you that there

20
00:00:45,039 --> 00:00:47,760
are apps that know even more would you

21
00:00:47,760 --> 00:00:49,600
like to know more

22
00:00:49,600 --> 00:00:51,600
have you ever been feeling like spied

23
00:00:51,600 --> 00:00:54,160
upon have you ever encountered strange

24
00:00:54,160 --> 00:00:56,480
behavior of your smartphone have you

25
00:00:56,480 --> 00:00:59,199
ever had a feeling that you know that

26
00:00:59,199 --> 00:01:00,960
somebody knows but you don't know how

27
00:01:00,960 --> 00:01:02,079
they know

28
00:01:02,079 --> 00:01:04,879
they might know because they installed

29
00:01:04,879 --> 00:01:08,880
style career software in your smartphone

30
00:01:08,880 --> 00:01:09,680
so

31
00:01:09,680 --> 00:01:12,320
what is stalker work simply put it's a

32
00:01:12,320 --> 00:01:15,280
spying app stalker needs to have

33
00:01:15,280 --> 00:01:17,200
physical access to your smartphone this

34
00:01:17,200 --> 00:01:20,320
cannot be done remotely unlock it

35
00:01:20,320 --> 00:01:22,400
sideload the application

36
00:01:22,400 --> 00:01:24,799
enable all the necessary permissions and

37
00:01:24,799 --> 00:01:27,360
well based on these permissions we can

38
00:01:27,360 --> 00:01:29,840
tell what are the capabilities of the

39
00:01:29,840 --> 00:01:32,159
software application is then hidden from

40
00:01:32,159 --> 00:01:34,320
the victim's view and it might

41
00:01:34,320 --> 00:01:37,360
impersonate or masquerade as for example

42
00:01:37,360 --> 00:01:39,360
settings application

43
00:01:39,360 --> 00:01:40,960
where these apps could be downloaded

44
00:01:40,960 --> 00:01:41,759
from

45
00:01:41,759 --> 00:01:44,560
besides shady sites they were available

46
00:01:44,560 --> 00:01:46,720
even on google play store

47
00:01:46,720 --> 00:01:50,880
posing as hit or employees pies

48
00:01:50,880 --> 00:01:53,200
resulting in fact that it wasn't that

49
00:01:53,200 --> 00:01:55,759
difficult to install these apps

50
00:01:55,759 --> 00:01:58,159
whatsoever precisely they were installed

51
00:01:58,159 --> 00:02:03,119
over 140 000 times from play store alone

52
00:02:03,119 --> 00:02:05,680
based on our data from our android

53
00:02:05,680 --> 00:02:07,439
client devices as you can see in the

54
00:02:07,439 --> 00:02:08,560
slides now

55
00:02:08,560 --> 00:02:10,800
these apps have become more and more

56
00:02:10,800 --> 00:02:13,200
popular in the last couple of years in

57
00:02:13,200 --> 00:02:17,200
2019 we detected five times more

58
00:02:17,200 --> 00:02:20,239
installs as in previous year last year

59
00:02:20,239 --> 00:02:23,599
detection increase up to 48

60
00:02:23,599 --> 00:02:25,680
we see the popularity is still on the

61
00:02:25,680 --> 00:02:28,000
rise

62
00:02:28,080 --> 00:02:31,120
so how can we make sure no one is

63
00:02:31,120 --> 00:02:33,040
looking over our shoulder

64
00:02:33,040 --> 00:02:35,440
this problem has been discussed and

65
00:02:35,440 --> 00:02:38,800
luckily for us it has been solved how by

66
00:02:38,800 --> 00:02:41,840
either manually or automatically using

67
00:02:41,840 --> 00:02:44,640
trustworthy software that detects

68
00:02:44,640 --> 00:02:48,840
informs and removes our uninvited

69
00:02:48,840 --> 00:02:52,480
cast however its enormous popularity

70
00:02:52,480 --> 00:02:56,239
made us wonder and worry about one more

71
00:02:56,239 --> 00:02:58,319
problem

72
00:02:58,319 --> 00:03:01,040
who else might be watching

73
00:03:01,040 --> 00:03:04,319
since stalker ware gathers more private

74
00:03:04,319 --> 00:03:06,879
data about their victims than any other

75
00:03:06,879 --> 00:03:08,560
app you have installed in your

76
00:03:08,560 --> 00:03:10,400
smartphone right now

77
00:03:10,400 --> 00:03:12,720
and i'm talking about the privacy and

78
00:03:12,720 --> 00:03:15,360
security of victim information that

79
00:03:15,360 --> 00:03:19,280
might be at risk since such software can

80
00:03:19,280 --> 00:03:22,159
access almost all the sensitive user

81
00:03:22,159 --> 00:03:24,400
data

82
00:03:24,400 --> 00:03:26,720
when we picked one of the most popular

83
00:03:26,720 --> 00:03:28,480
social media application and compared

84
00:03:28,480 --> 00:03:32,799
with stalker it's important to to say

85
00:03:32,799 --> 00:03:35,599
that this app requests permissions only

86
00:03:35,599 --> 00:03:38,000
when necessary for example when user

87
00:03:38,000 --> 00:03:39,280
wants to take a picture there is a

88
00:03:39,280 --> 00:03:41,360
request to give a permission either one

89
00:03:41,360 --> 00:03:44,080
time or during using the application

90
00:03:44,080 --> 00:03:47,760
contrary stalker wear in order to work

91
00:03:47,760 --> 00:03:49,440
properly

92
00:03:49,440 --> 00:03:51,760
all the permissions needs to be checked

93
00:03:51,760 --> 00:03:55,519
as a result the stalker has full access

94
00:03:55,519 --> 00:03:58,000
all the time

95
00:03:58,000 --> 00:03:59,599
let's take a look

96
00:03:59,599 --> 00:04:01,519
the phone on the right belongs to the

97
00:04:01,519 --> 00:04:03,040
attacker

98
00:04:03,040 --> 00:04:05,280
the attacker is another stalker and

99
00:04:05,280 --> 00:04:08,400
abuser it's a person that misuses

100
00:04:08,400 --> 00:04:10,319
security issues found install quest

101
00:04:10,319 --> 00:04:12,959
software the victim and the stalker are

102
00:04:12,959 --> 00:04:15,200
not aware of the attacker or these

103
00:04:15,200 --> 00:04:16,639
actions

104
00:04:16,639 --> 00:04:18,880
the phone on the left belongs to victim

105
00:04:18,880 --> 00:04:21,358
where application is already set up so

106
00:04:21,358 --> 00:04:23,520
the attacker sends text message to a

107
00:04:23,520 --> 00:04:25,919
victim's smartphone

108
00:04:25,919 --> 00:04:28,800
the app would process the text message

109
00:04:28,800 --> 00:04:32,000
and trigger a phone call back to the

110
00:04:32,000 --> 00:04:36,080
attacker or back to whoever

111
00:04:36,080 --> 00:04:39,759
sent the text message instantly opening

112
00:04:39,759 --> 00:04:43,840
microphone spying opportunities

113
00:04:45,280 --> 00:04:47,600
please pay attention to upcoming slides

114
00:04:47,600 --> 00:04:49,680
where we will deep type and share with

115
00:04:49,680 --> 00:04:52,080
you our research where we focus on

116
00:04:52,080 --> 00:04:54,639
privacy and security issues discovered

117
00:04:54,639 --> 00:04:57,360
in android stalker and will close all

118
00:04:57,360 --> 00:04:59,840
that with responsible disclosure to

119
00:04:59,840 --> 00:05:02,880
affected vendors

120
00:05:02,880 --> 00:05:05,759
first things first i'm aware from we get

121
00:05:05,759 --> 00:05:07,440
these applications there were various

122
00:05:07,440 --> 00:05:10,400
sources starting with stalker indicators

123
00:05:10,400 --> 00:05:12,320
of compromise that were available or

124
00:05:12,320 --> 00:05:14,800
still are on github at that time there

125
00:05:14,800 --> 00:05:19,440
was around 40 45 applications

126
00:05:19,440 --> 00:05:21,520
then based on top

127
00:05:21,520 --> 00:05:24,560
most popular detected stalker apps from

128
00:05:24,560 --> 00:05:27,280
our database that were used in a 20-year

129
00:05:27,280 --> 00:05:28,880
2020

130
00:05:28,880 --> 00:05:31,680
paid advertisement pr articles top

131
00:05:31,680 --> 00:05:33,039
google search

132
00:05:33,039 --> 00:05:36,080
because of that we gathered information

133
00:05:36,080 --> 00:05:39,440
about 86 different mobile style cover

134
00:05:39,440 --> 00:05:41,120
vendors

135
00:05:41,120 --> 00:05:43,360
however mobile style cover is divided

136
00:05:43,360 --> 00:05:45,280
into two main platforms

137
00:05:45,280 --> 00:05:47,039
android and ios

138
00:05:47,039 --> 00:05:49,919
we focused only on android the reason is

139
00:05:49,919 --> 00:05:50,880
simple

140
00:05:50,880 --> 00:05:54,000
the market share over 70 percent

141
00:05:54,000 --> 00:05:56,000
and the easiness of side loading

142
00:05:56,000 --> 00:05:58,160
third-party applications

143
00:05:58,160 --> 00:06:00,960
comparing to ios based on the websites

144
00:06:00,960 --> 00:06:03,520
and tutorials how to set up the stalker

145
00:06:03,520 --> 00:06:04,800
where

146
00:06:04,800 --> 00:06:07,120
stalker needs to either jailbroke a

147
00:06:07,120 --> 00:06:10,639
smartphone before or already have icloud

148
00:06:10,639 --> 00:06:13,280
credentials and there is one more reason

149
00:06:13,280 --> 00:06:16,960
why we decided to focus only on android

150
00:06:16,960 --> 00:06:20,160
and that's from all analyzer vendors all

151
00:06:20,160 --> 00:06:22,800
of them provided android solution

152
00:06:22,800 --> 00:06:26,479
but only something over 37 percent ios

153
00:06:26,479 --> 00:06:28,880
as well

154
00:06:29,360 --> 00:06:31,440
so what was our plan and what we did we

155
00:06:31,440 --> 00:06:34,319
analyzed 86 different vendors providing

156
00:06:34,319 --> 00:06:37,919
stalker wear by analyzing

157
00:06:37,919 --> 00:06:39,919
86 different

158
00:06:39,919 --> 00:06:42,880
android style applications using a

159
00:06:42,880 --> 00:06:45,600
manual static and dynamic analysis to

160
00:06:45,600 --> 00:06:48,479
observe its behavior and capabilities

161
00:06:48,479 --> 00:06:50,479
we'd also like to state the fact that

162
00:06:50,479 --> 00:06:52,720
this was another full penetration test

163
00:06:52,720 --> 00:06:54,160
we focused

164
00:06:54,160 --> 00:06:57,199
only on privacy and security issues with

165
00:06:57,199 --> 00:07:00,479
serious impact on their clients

166
00:07:00,479 --> 00:07:03,199
victims or a company

167
00:07:03,199 --> 00:07:06,240
however the matter is really serious

168
00:07:06,240 --> 00:07:07,759
there were some limitations i would like

169
00:07:07,759 --> 00:07:10,319
to go through them first

170
00:07:10,319 --> 00:07:12,240
because we haven't paid for any of the

171
00:07:12,240 --> 00:07:14,479
software we didn't want to support them

172
00:07:14,479 --> 00:07:16,240
we were limited by the provided

173
00:07:16,240 --> 00:07:18,800
functionality of the application and the

174
00:07:18,800 --> 00:07:20,880
admin panel which is responsible for

175
00:07:20,880 --> 00:07:23,120
sending commands receiving data and

176
00:07:23,120 --> 00:07:26,319
storing them on server

177
00:07:28,080 --> 00:07:31,280
still we were able to fully test 72

178
00:07:31,280 --> 00:07:34,000
applications out of 86 where 14 were

179
00:07:34,000 --> 00:07:37,280
limited to static analysis only

180
00:07:37,280 --> 00:07:39,360
what were our results

181
00:07:39,360 --> 00:07:42,080
from these 86 apps we identified

182
00:07:42,080 --> 00:07:45,440
security issues with serious impact in

183
00:07:45,440 --> 00:07:49,520
67 percent of these apps 33

184
00:07:49,520 --> 00:07:52,560
were bid out serious security or privacy

185
00:07:52,560 --> 00:07:54,400
issue discovered by us

186
00:07:54,400 --> 00:07:58,080
all together we identified 158

187
00:07:58,080 --> 00:08:02,318
exploitable problems in these apps

188
00:08:02,879 --> 00:08:06,879
now we'll jump into particular problems

189
00:08:06,879 --> 00:08:08,960
even because of limitations we were able

190
00:08:08,960 --> 00:08:12,879
to discover 158 problems such as leaks

191
00:08:12,879 --> 00:08:14,240
on the network

192
00:08:14,240 --> 00:08:17,599
a possibility to frame a person

193
00:08:17,599 --> 00:08:19,919
control remotely through text message

194
00:08:19,919 --> 00:08:22,639
open directory account takeover

195
00:08:22,639 --> 00:08:24,840
possibility to live stream from

196
00:08:24,840 --> 00:08:28,240
smartphone i prepared two more video

197
00:08:28,240 --> 00:08:31,039
demonstrations of exploiting

198
00:08:31,039 --> 00:08:33,120
some vulnerabilities i will go through

199
00:08:33,120 --> 00:08:35,440
them briefly now i will go through some

200
00:08:35,440 --> 00:08:38,880
of the most serious ones

201
00:08:39,679 --> 00:08:42,880
starting with http leak since many of

202
00:08:42,880 --> 00:08:45,279
these apps used for communication app

203
00:08:45,279 --> 00:08:48,160
and a server not secured not anyhow or

204
00:08:48,160 --> 00:08:51,600
additionally protected http protocol to

205
00:08:51,600 --> 00:08:55,360
explain when a user installs stalker in

206
00:08:55,360 --> 00:08:58,240
smartphone first it needs to be set up

207
00:08:58,240 --> 00:09:01,279
which means either create account or log

208
00:09:01,279 --> 00:09:03,680
into account to sync smartphone and the

209
00:09:03,680 --> 00:09:06,160
admin panel which is controlled by the

210
00:09:06,160 --> 00:09:07,839
user

211
00:09:07,839 --> 00:09:10,959
however for 22 apps stealth aware would

212
00:09:10,959 --> 00:09:14,240
send credentials to server through http

213
00:09:14,240 --> 00:09:17,040
but anyhow protect it it means that the

214
00:09:17,040 --> 00:09:19,600
attacker on the network using mad in the

215
00:09:19,600 --> 00:09:21,279
middle technique could intercept the

216
00:09:21,279 --> 00:09:22,480
communication

217
00:09:22,480 --> 00:09:25,360
steal the credentials take over account

218
00:09:25,360 --> 00:09:26,959
of the

219
00:09:26,959 --> 00:09:29,839
stalker and remotely control victims

220
00:09:29,839 --> 00:09:32,160
smart

221
00:09:32,160 --> 00:09:34,240
besides credentials being transferred

222
00:09:34,240 --> 00:09:36,399
over http

223
00:09:36,399 --> 00:09:39,200
stalkerwear also downloads additional

224
00:09:39,200 --> 00:09:42,880
binaries or updates of itself

225
00:09:42,880 --> 00:09:44,640
which are then either installed or

226
00:09:44,640 --> 00:09:47,040
dynamically loaded however there is a

227
00:09:47,040 --> 00:09:50,080
missing integrity check because of that

228
00:09:50,080 --> 00:09:52,320
the attacker on the same network against

229
00:09:52,320 --> 00:09:54,640
through men in the middle technique in

230
00:09:54,640 --> 00:09:56,480
the middle technique

231
00:09:56,480 --> 00:09:58,160
could replace the binaries for the

232
00:09:58,160 --> 00:10:00,320
malicious ones and trigger code

233
00:10:00,320 --> 00:10:04,120
execution on a smartphone

234
00:10:04,480 --> 00:10:07,920
the most common issue was actual leak of

235
00:10:07,920 --> 00:10:10,560
all the extracted data from smartphone

236
00:10:10,560 --> 00:10:13,440
that are being sent to the server again

237
00:10:13,440 --> 00:10:15,519
we found this

238
00:10:15,519 --> 00:10:18,560
vulnerability in 22 applications now

239
00:10:18,560 --> 00:10:20,800
from a leak on the network a move to the

240
00:10:20,800 --> 00:10:24,479
leak on the smartphone

241
00:10:26,800 --> 00:10:28,600
which is a leak of a personally

242
00:10:28,600 --> 00:10:31,839
identifiable information

243
00:10:31,839 --> 00:10:34,399
where these data are stored

244
00:10:34,399 --> 00:10:37,120
gather data are stored on external

245
00:10:37,120 --> 00:10:38,959
shared media

246
00:10:38,959 --> 00:10:42,079
which means these data are accessible to

247
00:10:42,079 --> 00:10:44,399
other third-party apps installed on a

248
00:10:44,399 --> 00:10:46,720
smartphone with the read storage

249
00:10:46,720 --> 00:10:49,839
permission in one case we found

250
00:10:49,839 --> 00:10:51,360
that

251
00:10:51,360 --> 00:10:55,440
stalkerware stored admin token

252
00:10:55,440 --> 00:10:57,120
on the shared media which means

253
00:10:57,120 --> 00:10:59,279
third-party apps could access and take

254
00:10:59,279 --> 00:11:03,120
over account of the abuser

255
00:11:03,519 --> 00:11:05,680
some of them also provided key logger

256
00:11:05,680 --> 00:11:07,200
functionality

257
00:11:07,200 --> 00:11:09,600
meaning they could lock all user input

258
00:11:09,600 --> 00:11:11,519
from all applications

259
00:11:11,519 --> 00:11:14,560
these key locks were not protected and

260
00:11:14,560 --> 00:11:17,760
accessible to other applications

261
00:11:17,760 --> 00:11:20,000
they actually lock all sensitive

262
00:11:20,000 --> 00:11:23,200
information including the password as

263
00:11:23,200 --> 00:11:25,680
you can see from paypal as well which

264
00:11:25,680 --> 00:11:28,320
means that third-party apps installed on

265
00:11:28,320 --> 00:11:30,880
the same smartphone could access this

266
00:11:30,880 --> 00:11:31,920
file

267
00:11:31,920 --> 00:11:34,160
and take over other accounts not just

268
00:11:34,160 --> 00:11:36,800
stalkers

269
00:11:38,000 --> 00:11:41,120
the most frequently seen device leak was

270
00:11:41,120 --> 00:11:43,519
unprotectedly storing this extracted

271
00:11:43,519 --> 00:11:46,320
data such as recorded phone calls taken

272
00:11:46,320 --> 00:11:49,360
photos screenshots in some cases even

273
00:11:49,360 --> 00:11:52,240
calendar events browsing history contact

274
00:11:52,240 --> 00:11:55,120
list phone number etc

275
00:11:55,120 --> 00:11:57,200
from the leak on the network

276
00:11:57,200 --> 00:11:59,200
through leak on a smartphone i went

277
00:11:59,200 --> 00:12:01,760
right now moved to the leak on the

278
00:12:01,760 --> 00:12:04,000
server

279
00:12:04,000 --> 00:12:06,720
user data leaks to open directories

280
00:12:06,720 --> 00:12:09,519
there were available data such as

281
00:12:09,519 --> 00:12:12,480
victims photos recorded phone calls

282
00:12:12,480 --> 00:12:15,360
details about the person such as names

283
00:12:15,360 --> 00:12:18,480
physical addresses text messages social

284
00:12:18,480 --> 00:12:21,360
media messages email addresses these

285
00:12:21,360 --> 00:12:23,600
data were accessible without any

286
00:12:23,600 --> 00:12:27,360
authentication for anyone

287
00:12:29,680 --> 00:12:31,760
victim data forgery during analysis we

288
00:12:31,760 --> 00:12:34,800
discovered and tested that manipulating

289
00:12:34,800 --> 00:12:37,920
with the victims data wasn't a problem

290
00:12:37,920 --> 00:12:41,120
many apps used for pairing device and

291
00:12:41,120 --> 00:12:42,560
the server

292
00:12:42,560 --> 00:12:45,600
unique device id such as email or

293
00:12:45,600 --> 00:12:48,639
android id instead of using server

294
00:12:48,639 --> 00:12:50,839
generated token

295
00:12:50,839 --> 00:12:54,959
however these ids are easily obtainable

296
00:12:54,959 --> 00:12:56,800
by third-party apps

297
00:12:56,800 --> 00:12:58,959
that are installed on the smartphone

298
00:12:58,959 --> 00:13:01,120
there are two impacts or two scenarios

299
00:13:01,120 --> 00:13:04,560
how this can be misused the first one

300
00:13:04,560 --> 00:13:06,720
the application is using not secured

301
00:13:06,720 --> 00:13:09,040
http protocol to communicate with the

302
00:13:09,040 --> 00:13:11,279
server it is possible for the attacker

303
00:13:11,279 --> 00:13:13,360
on the same network to intercept the

304
00:13:13,360 --> 00:13:14,800
communication

305
00:13:14,800 --> 00:13:18,320
and forge any data frame person to make

306
00:13:18,320 --> 00:13:21,200
her life a bit more difficult difficult

307
00:13:21,200 --> 00:13:23,920
which means uploading custom photos

308
00:13:23,920 --> 00:13:27,440
videos receive the messages etc

309
00:13:27,440 --> 00:13:30,079
second case scenario third party apps on

310
00:13:30,079 --> 00:13:33,200
a smartphone could obtain the device ids

311
00:13:33,200 --> 00:13:36,720
and upload make post request custom data

312
00:13:36,720 --> 00:13:38,000
to frame

313
00:13:38,000 --> 00:13:40,639
to frame a person upload fabricated

314
00:13:40,639 --> 00:13:42,880
fabricated information which could be

315
00:13:42,880 --> 00:13:47,040
then even blackmail the victim

316
00:13:47,760 --> 00:13:50,160
in the case of no internet connection

317
00:13:50,160 --> 00:13:52,639
some of the apps provided ability to

318
00:13:52,639 --> 00:13:56,480
receive text messages commands however

319
00:13:56,480 --> 00:13:59,440
not all of them verify if commands

320
00:13:59,440 --> 00:14:02,560
are received from abuser and because of

321
00:14:02,560 --> 00:14:05,440
that anyone could remotely control

322
00:14:05,440 --> 00:14:07,120
victim's smartphone

323
00:14:07,120 --> 00:14:09,680
by sms commands there are two things

324
00:14:09,680 --> 00:14:13,120
necessary the first are sms commands

325
00:14:13,120 --> 00:14:15,199
these commands are available on the

326
00:14:15,199 --> 00:14:16,399
websites

327
00:14:16,399 --> 00:14:18,639
of the provider of the application and

328
00:14:18,639 --> 00:14:21,279
the second is a phone number of the

329
00:14:21,279 --> 00:14:23,440
victim which is already

330
00:14:23,440 --> 00:14:26,480
either known to the attacker or it could

331
00:14:26,480 --> 00:14:27,600
be

332
00:14:27,600 --> 00:14:29,680
found extracted for example from social

333
00:14:29,680 --> 00:14:30,880
media

334
00:14:30,880 --> 00:14:32,959
i prepared a demonstration for for this

335
00:14:32,959 --> 00:14:33,760
one

336
00:14:33,760 --> 00:14:35,760
similar as the one you see before so

337
00:14:35,760 --> 00:14:38,079
before the phone on the right belongs to

338
00:14:38,079 --> 00:14:40,000
the attacker

339
00:14:40,000 --> 00:14:41,600
the phone on the left belongs to a

340
00:14:41,600 --> 00:14:43,839
victim where a stalker is already

341
00:14:43,839 --> 00:14:46,079
installed the attacker sends text

342
00:14:46,079 --> 00:14:47,839
message with the command down on the

343
00:14:47,839 --> 00:14:50,320
website of the stalker where

344
00:14:50,320 --> 00:14:52,079
victim receives the message app would

345
00:14:52,079 --> 00:14:54,720
process that and it would trigger

346
00:14:54,720 --> 00:14:57,680
immediate sharing gps location

347
00:14:57,680 --> 00:15:00,240
to or send the gps location to anyone

348
00:15:00,240 --> 00:15:02,320
who sent a text message in this case

349
00:15:02,320 --> 00:15:04,800
attacker

350
00:15:07,199 --> 00:15:10,000
because of unprotected exported

351
00:15:10,000 --> 00:15:12,480
components of the style carver it is

352
00:15:12,480 --> 00:15:14,959
possible to trigger restricted stall

353
00:15:14,959 --> 00:15:17,519
cover functionality

354
00:15:17,519 --> 00:15:18,800
as a result

355
00:15:18,800 --> 00:15:20,320
any applications installed on a

356
00:15:20,320 --> 00:15:23,360
smartphone could through stall crew app

357
00:15:23,360 --> 00:15:25,120
without permission

358
00:15:25,120 --> 00:15:26,639
take pictures

359
00:15:26,639 --> 00:15:29,279
record calls record surrounding audio

360
00:15:29,279 --> 00:15:32,000
take screenshots wipe data enable

361
00:15:32,000 --> 00:15:36,000
disable gps reboot etc and afterwards

362
00:15:36,000 --> 00:15:39,040
gather these files these data scenes

363
00:15:39,040 --> 00:15:41,680
they are stored again on shared external

364
00:15:41,680 --> 00:15:44,079
media

365
00:15:44,240 --> 00:15:47,360
what happens when spying ends

366
00:15:47,360 --> 00:15:48,639
this

367
00:15:48,639 --> 00:15:52,000
this is a photo taken by a stalker of my

368
00:15:52,000 --> 00:15:53,120
ceiling

369
00:15:53,120 --> 00:15:56,880
while it was lying next to me

370
00:15:56,880 --> 00:15:58,160
even though

371
00:15:58,160 --> 00:16:00,800
this photo is still accessible on their

372
00:16:00,800 --> 00:16:02,399
server even though

373
00:16:02,399 --> 00:16:04,639
me as a stalker

374
00:16:04,639 --> 00:16:07,279
i remote the account i unlink the

375
00:16:07,279 --> 00:16:08,480
smartphone

376
00:16:08,480 --> 00:16:10,959
and removes all the data logs

377
00:16:10,959 --> 00:16:14,320
unfortunately this photo is still there

378
00:16:14,320 --> 00:16:17,040
besides all the taken photos there are

379
00:16:17,040 --> 00:16:20,959
to this day available my call logs and

380
00:16:20,959 --> 00:16:23,360
my text messages on their server

381
00:16:23,360 --> 00:16:25,360
available to anyone without any

382
00:16:25,360 --> 00:16:26,800
authentication

383
00:16:26,800 --> 00:16:29,759
in other cases of these apps these data

384
00:16:29,759 --> 00:16:31,759
are not removed immediately when

385
00:16:31,759 --> 00:16:35,040
requested but rather it takes 90 extra

386
00:16:35,040 --> 00:16:37,839
days to be deleted

387
00:16:39,120 --> 00:16:41,839
hard-coded secrets found in stock web

388
00:16:41,839 --> 00:16:43,120
apps

389
00:16:43,120 --> 00:16:45,839
this is not about a token or password as

390
00:16:45,839 --> 00:16:48,560
you might expect but rather just

391
00:16:48,560 --> 00:16:52,000
three server links that are responsible

392
00:16:52,000 --> 00:16:54,560
for triggering live stream

393
00:16:54,560 --> 00:16:56,720
what this is all about

394
00:16:56,720 --> 00:16:58,639
in the app are hard-coded links that

395
00:16:58,639 --> 00:17:01,920
could through server trigger live stream

396
00:17:01,920 --> 00:17:04,240
from a particular smartphone the only

397
00:17:04,240 --> 00:17:07,119
thing that's necessary is device id of

398
00:17:07,119 --> 00:17:10,000
the smartphone however the stalkerware

399
00:17:10,000 --> 00:17:10,959
app

400
00:17:10,959 --> 00:17:14,079
stores the id on external shared media

401
00:17:14,079 --> 00:17:16,319
which means this is accessible to

402
00:17:16,319 --> 00:17:18,480
third-party applications that have great

403
00:17:18,480 --> 00:17:21,199
storage permission

404
00:17:21,199 --> 00:17:23,359
i prepared video demonstration for this

405
00:17:23,359 --> 00:17:25,599
one

406
00:17:26,400 --> 00:17:28,640
so on the left side we have a smartphone

407
00:17:28,640 --> 00:17:30,640
of the victim and the three windows the

408
00:17:30,640 --> 00:17:33,120
first one is a notepad that contains the

409
00:17:33,120 --> 00:17:36,240
hard-coded link with appended id

410
00:17:36,240 --> 00:17:38,559
then we have a browser and a vlc where

411
00:17:38,559 --> 00:17:41,840
we just tried to watch a stream

412
00:17:41,840 --> 00:17:43,840
from a victim's smartphone since the

413
00:17:43,840 --> 00:17:46,880
link was in apk however the stream is

414
00:17:46,880 --> 00:17:49,440
not enabled first the attacker needs to

415
00:17:49,440 --> 00:17:52,480
make two get requests to our browser to

416
00:17:52,480 --> 00:17:54,000
server

417
00:17:54,000 --> 00:17:57,360
and server of the stalker would enable a

418
00:17:57,360 --> 00:17:58,720
live stream

419
00:17:58,720 --> 00:18:00,799
from that particular smartphone without

420
00:18:00,799 --> 00:18:02,960
any authentication to anyone and a

421
00:18:02,960 --> 00:18:05,919
victim cannot see anything being done or

422
00:18:05,919 --> 00:18:10,000
happening on their smartphone

423
00:18:12,240 --> 00:18:14,240
these were the most prevalent issues

424
00:18:14,240 --> 00:18:16,880
found in these apps after we identified

425
00:18:16,880 --> 00:18:18,240
these problems

426
00:18:18,240 --> 00:18:22,000
we reported them to affected vendors we

427
00:18:22,000 --> 00:18:25,280
follow 90-day disclosure practice which

428
00:18:25,280 --> 00:18:28,240
means contacting the vendors up to three

429
00:18:28,240 --> 00:18:29,600
times

430
00:18:29,600 --> 00:18:31,520
either through mail order supports

431
00:18:31,520 --> 00:18:34,160
ticket and then making the phone calls

432
00:18:34,160 --> 00:18:37,200
if possible in two cases we were not

433
00:18:37,200 --> 00:18:40,559
successful reaching to the vendors

434
00:18:40,559 --> 00:18:43,120
the first case was as it appeared a full

435
00:18:43,120 --> 00:18:46,799
inbox updates and the second case um it

436
00:18:46,799 --> 00:18:48,799
was not possible to create a support

437
00:18:48,799 --> 00:18:50,880
ticket it always returned through

438
00:18:50,880 --> 00:18:54,400
after various attempts

439
00:18:55,039 --> 00:18:57,200
with the result of a response

440
00:18:57,200 --> 00:18:59,200
responsible disclosure

441
00:18:59,200 --> 00:19:00,160
10

442
00:19:00,160 --> 00:19:02,320
of affected vendors

443
00:19:02,320 --> 00:19:04,480
communicated with us and fixed the

444
00:19:04,480 --> 00:19:08,080
problems within 90 disclosure day period

445
00:19:08,080 --> 00:19:11,520
12 of the vendors communicated with us

446
00:19:11,520 --> 00:19:13,600
and promised us to fix what it takes the

447
00:19:13,600 --> 00:19:15,679
patch was not delivered within the 90

448
00:19:15,679 --> 00:19:16,880
days period

449
00:19:16,880 --> 00:19:20,640
and 78 of them did not replied back nor

450
00:19:20,640 --> 00:19:22,640
fixed the problem

451
00:19:22,640 --> 00:19:26,480
which means that 90 of affected vendors

452
00:19:26,480 --> 00:19:29,280
have still these vulnerabilities and

453
00:19:29,280 --> 00:19:30,640
this is the reason

454
00:19:30,640 --> 00:19:33,760
why we decide not to publish a full list

455
00:19:33,760 --> 00:19:36,640
of apps and connect them with actual

456
00:19:36,640 --> 00:19:38,799
particular problems being discovered in

457
00:19:38,799 --> 00:19:41,039
them

458
00:19:41,919 --> 00:19:44,480
now before summary let's quickly go

459
00:19:44,480 --> 00:19:46,480
through a compromise scenario and a

460
00:19:46,480 --> 00:19:48,240
couple of prevention tips let's talk

461
00:19:48,240 --> 00:19:49,200
about it

462
00:19:49,200 --> 00:19:51,840
so how it looks like from the attacker

463
00:19:51,840 --> 00:19:54,799
or stalker's perspective

464
00:19:54,799 --> 00:19:56,880
stalker needs a physical access to

465
00:19:56,880 --> 00:19:59,039
smartphone again this cannot be done

466
00:19:59,039 --> 00:20:00,240
remotely

467
00:20:00,240 --> 00:20:01,600
since

468
00:20:01,600 --> 00:20:04,159
stalker needs to set up account which

469
00:20:04,159 --> 00:20:06,640
means unlock a smartphone no pain or

470
00:20:06,640 --> 00:20:08,240
password pattern

471
00:20:08,240 --> 00:20:11,039
side load the application that's it it

472
00:20:11,039 --> 00:20:13,200
takes two um

473
00:20:13,200 --> 00:20:15,679
two three minutes to set it up after

474
00:20:15,679 --> 00:20:17,440
which app is hidden from the victim's

475
00:20:17,440 --> 00:20:19,039
view

476
00:20:19,039 --> 00:20:20,480
what to do

477
00:20:20,480 --> 00:20:21,760
make sure

478
00:20:21,760 --> 00:20:23,840
from the victim's perspective make sure

479
00:20:23,840 --> 00:20:27,280
to have enable lock screen protection

480
00:20:27,280 --> 00:20:28,880
the best way is a pin

481
00:20:28,880 --> 00:20:32,080
not easy not trivial not easy to guess

482
00:20:32,080 --> 00:20:34,000
and if you believe don't share it and if

483
00:20:34,000 --> 00:20:36,000
you believe someone knows it or accepts

484
00:20:36,000 --> 00:20:38,480
your device make sure to scan it with a

485
00:20:38,480 --> 00:20:41,200
trustworthy security software that would

486
00:20:41,200 --> 00:20:42,480
identify

487
00:20:42,480 --> 00:20:46,159
such apps being installed

488
00:20:46,400 --> 00:20:48,400
what are the compromised signs of

489
00:20:48,400 --> 00:20:50,880
stalker being being installed in your

490
00:20:50,880 --> 00:20:52,400
device there's

491
00:20:52,400 --> 00:20:54,159
a higher

492
00:20:54,159 --> 00:20:56,640
or better drain faster i would say since

493
00:20:56,640 --> 00:20:59,200
it's running 24 7.

494
00:20:59,200 --> 00:21:02,080
it has to communicate with the server by

495
00:21:02,080 --> 00:21:04,559
sending data receiving commands sending

496
00:21:04,559 --> 00:21:07,600
pictures etc which means higher internet

497
00:21:07,600 --> 00:21:08,960
consumption

498
00:21:08,960 --> 00:21:13,039
gps wi-fi or mobile data might be

499
00:21:13,039 --> 00:21:16,640
enabled or disabled by itself without

500
00:21:16,640 --> 00:21:19,120
user interaction

501
00:21:19,120 --> 00:21:21,360
there might be a suspicious persistent

502
00:21:21,360 --> 00:21:24,320
notification notification bar bar that

503
00:21:24,320 --> 00:21:27,840
was not there before

504
00:21:27,840 --> 00:21:30,960
photos screenshots all your recording

505
00:21:30,960 --> 00:21:32,240
recordings

506
00:21:32,240 --> 00:21:34,320
stored in your smartphone that was not

507
00:21:34,320 --> 00:21:35,679
done by you

508
00:21:35,679 --> 00:21:38,080
which means which is a result of

509
00:21:38,080 --> 00:21:40,400
extracting data and storing them on

510
00:21:40,400 --> 00:21:41,679
shared media

511
00:21:41,679 --> 00:21:44,240
and then for example receiving or found

512
00:21:44,240 --> 00:21:46,720
received questionable text messages

513
00:21:46,720 --> 00:21:51,360
which might be commands from abuser

514
00:21:52,960 --> 00:21:55,760
to summarize a number of

515
00:21:55,760 --> 00:21:58,240
detected style cover has been increasing

516
00:21:58,240 --> 00:22:00,880
as you saw based on our data

517
00:22:00,880 --> 00:22:03,679
in the year 2020 we see the increase of

518
00:22:03,679 --> 00:22:08,159
detection on client devices up to 48

519
00:22:08,159 --> 00:22:10,320
problem is that these applications

520
00:22:10,320 --> 00:22:13,280
getters process send

521
00:22:13,280 --> 00:22:15,840
more provided information about their

522
00:22:15,840 --> 00:22:17,919
users about their victims than any app

523
00:22:17,919 --> 00:22:19,760
you have in your smartphone

524
00:22:19,760 --> 00:22:22,400
right now

525
00:22:22,400 --> 00:22:24,000
another problem is that these apps

526
00:22:24,000 --> 00:22:26,159
contain a lot of security issues that

527
00:22:26,159 --> 00:22:30,400
have actual impact on these users

528
00:22:30,400 --> 00:22:32,000
and

529
00:22:32,000 --> 00:22:34,320
based on our experience the vendors

530
00:22:34,320 --> 00:22:36,159
don't really care about their clients

531
00:22:36,159 --> 00:22:37,760
since these products or many of these

532
00:22:37,760 --> 00:22:40,880
products are not free and they are paid

533
00:22:40,880 --> 00:22:42,880
or they have subscription they are not

534
00:22:42,880 --> 00:22:44,640
willing to to fix them or even

535
00:22:44,640 --> 00:22:48,320
communicate with us back

536
00:22:48,640 --> 00:22:52,400
we would also like to appeal to anyone

537
00:22:52,400 --> 00:22:54,559
who might be thinking of using such

538
00:22:54,559 --> 00:22:57,280
software to reconsider it

539
00:22:57,280 --> 00:22:59,520
using stalkerware

540
00:22:59,520 --> 00:23:02,159
to spy on your spouses it's not just

541
00:23:02,159 --> 00:23:05,679
unethical but it also reveals private

542
00:23:05,679 --> 00:23:08,159
and intimate information about them but

543
00:23:08,159 --> 00:23:09,919
also about those

544
00:23:09,919 --> 00:23:12,799
who installed it and want to spy on

545
00:23:12,799 --> 00:23:15,679
their close ones

546
00:23:16,000 --> 00:23:18,640
thank you very much for your attention

547
00:23:18,640 --> 00:23:21,280
thank you very much for your attention

548
00:23:21,280 --> 00:23:23,520
if you have any questions feel free to

549
00:23:23,520 --> 00:23:25,520
ask

550
00:23:25,520 --> 00:23:27,360
thank you so much lucas this has been a

551
00:23:27,360 --> 00:23:29,440
stellar presentation and i'm glad that

552
00:23:29,440 --> 00:23:31,600
here at get deaf camp or are talking

553
00:23:31,600 --> 00:23:33,679
about these kind of issues that i think

554
00:23:33,679 --> 00:23:35,039
should be addressed more within the

555
00:23:35,039 --> 00:23:38,000
cyber security community um

556
00:23:38,000 --> 00:23:40,159
and kudos for all the ethical

557
00:23:40,159 --> 00:23:42,159
considerations

558
00:23:42,159 --> 00:23:44,799
that were involved in in this particular

559
00:23:44,799 --> 00:23:47,840
research i was wondering um

560
00:23:47,840 --> 00:23:51,360
if there was any memorable exchange that

561
00:23:51,360 --> 00:23:55,840
you had with these um app vendors

562
00:23:56,159 --> 00:23:57,760
there were a couple of them

563
00:23:57,760 --> 00:23:58,720
okay

564
00:23:58,720 --> 00:24:00,880
i would say

565
00:24:00,880 --> 00:24:04,159
i was surprised when

566
00:24:04,159 --> 00:24:06,000
in actually two cases

567
00:24:06,000 --> 00:24:08,240
they appreciated

568
00:24:08,240 --> 00:24:10,400
that we reached to them that we tried to

569
00:24:10,400 --> 00:24:12,640
fix the issues that they even wanted to

570
00:24:12,640 --> 00:24:15,120
publish their own blog post

571
00:24:15,120 --> 00:24:17,440
of course this never happened but i

572
00:24:17,440 --> 00:24:19,440
appreciate the attitude and in other

573
00:24:19,440 --> 00:24:20,400
case

574
00:24:20,400 --> 00:24:21,120
the

575
00:24:21,120 --> 00:24:23,679
one of the vendor did not like that we

576
00:24:23,679 --> 00:24:25,360
are trying to

577
00:24:25,360 --> 00:24:28,400
snoop on their application

578
00:24:28,400 --> 00:24:30,799
it was he was threatening us with a bit

579
00:24:30,799 --> 00:24:33,679
of the law um affected

580
00:24:33,679 --> 00:24:36,159
by the law effective way so

581
00:24:36,159 --> 00:24:39,039
we tried to figure out how to deliver

582
00:24:39,039 --> 00:24:40,799
the patch as soon as possible and

583
00:24:40,799 --> 00:24:43,360
afterwards a couple of nails that were

584
00:24:43,360 --> 00:24:45,600
exchanged with the vendor or the

585
00:24:45,600 --> 00:24:48,400
developer we we found a way we found the

586
00:24:48,400 --> 00:24:51,840
consensus and they actually appreciated

587
00:24:51,840 --> 00:24:53,760
that they found the issues and it fixed

588
00:24:53,760 --> 00:24:55,840
them

589
00:24:55,840 --> 00:24:58,720
was there anything interesting that you

590
00:24:58,720 --> 00:25:00,320
left out when you build this

591
00:25:00,320 --> 00:25:03,120
presentation is there anything else that

592
00:25:03,120 --> 00:25:06,479
um you want us to know

593
00:25:06,720 --> 00:25:09,840
let me quickly recall

594
00:25:09,840 --> 00:25:11,760
i believe i tried to include all the

595
00:25:11,760 --> 00:25:13,600
important and also interesting

596
00:25:13,600 --> 00:25:15,919
information in here so i would say

597
00:25:15,919 --> 00:25:18,400
probably probably not

598
00:25:18,400 --> 00:25:20,480
that's good to know thank you thank you

599
00:25:20,480 --> 00:25:23,120
again for this this has been amazing and

600
00:25:23,120 --> 00:25:26,080
i'm glad that um we were able to host

601
00:25:26,080 --> 00:25:28,799
you today

