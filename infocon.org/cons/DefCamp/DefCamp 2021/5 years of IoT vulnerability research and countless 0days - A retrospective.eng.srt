1
00:00:00,080 --> 00:00:02,960
alex j ballan i'm sure that many of you

2
00:00:02,960 --> 00:00:04,720
are familiar with him

3
00:00:04,720 --> 00:00:08,000
um i know that people around here mostly

4
00:00:08,000 --> 00:00:11,040
buy iot devices for research purposes

5
00:00:11,040 --> 00:00:15,360
because uh these are not that secure um

6
00:00:15,360 --> 00:00:17,760
alex has spent the past five years

7
00:00:17,760 --> 00:00:20,080
looking at iot devices his team at

8
00:00:20,080 --> 00:00:23,279
bitdefender found many zero days in um

9
00:00:23,279 --> 00:00:26,240
smart light bulbs webcams and uh

10
00:00:26,240 --> 00:00:29,199
doorbell and we're going to learn more

11
00:00:29,199 --> 00:00:32,399
about his his research but first i want

12
00:00:32,399 --> 00:00:35,200
to um show you my smart watch can i do

13
00:00:35,200 --> 00:00:36,160
that

14
00:00:36,160 --> 00:00:38,480
alex

15
00:00:38,480 --> 00:00:41,520
oh that is so cool

16
00:00:41,520 --> 00:00:44,879
i'm glad you like it

17
00:00:44,879 --> 00:00:46,719
so how were these uh

18
00:00:46,719 --> 00:00:49,200
past five years for you

19
00:00:49,200 --> 00:00:51,039
well i mean

20
00:00:51,039 --> 00:00:53,520
the uh

21
00:00:54,160 --> 00:00:54,879
the

22
00:00:54,879 --> 00:00:56,800
it's easy

23
00:00:56,800 --> 00:00:59,199
to hack smart devices so we we i have to

24
00:00:59,199 --> 00:01:01,280
we need that we went into a field where

25
00:01:01,280 --> 00:01:04,000
the the bar was set very very low

26
00:01:04,000 --> 00:01:05,119
you know

27
00:01:05,119 --> 00:01:06,000
so

28
00:01:06,000 --> 00:01:09,040
a lot of low hanging fruits a lot of low

29
00:01:09,040 --> 00:01:12,159
hanging fruits i mean virtually like

30
00:01:12,159 --> 00:01:14,000
eighty percent of all the things that we

31
00:01:14,000 --> 00:01:16,640
research in eighty percent we found uh

32
00:01:16,640 --> 00:01:19,680
stuff with cvss core eight plus

33
00:01:19,680 --> 00:01:21,920
right so stuff that you have like remote

34
00:01:21,920 --> 00:01:23,280
command execution without any

35
00:01:23,280 --> 00:01:24,799
authentication

36
00:01:24,799 --> 00:01:27,040
device takeover account takeovers

37
00:01:27,040 --> 00:01:29,680
without any any kind of uh

38
00:01:29,680 --> 00:01:32,159
authentication or prerequisites and all

39
00:01:32,159 --> 00:01:34,640
of them like trivially easy uh

40
00:01:34,640 --> 00:01:36,880
unfortunately i mean some of the some of

41
00:01:36,880 --> 00:01:38,400
the most common

42
00:01:38,400 --> 00:01:40,079
attack vectors i'm gonna i'm gonna talk

43
00:01:40,079 --> 00:01:42,240
about them in the slides today in the in

44
00:01:42,240 --> 00:01:44,159
this today's presentation

45
00:01:44,159 --> 00:01:47,040
um but yeah it's been fun we've uh

46
00:01:47,040 --> 00:01:51,439
researched i think about 40 devices

47
00:01:51,439 --> 00:01:52,320
ish

48
00:01:52,320 --> 00:01:54,920
so quite quite a lot um

49
00:01:54,920 --> 00:01:57,439
unfortunately the the one challenge that

50
00:01:57,439 --> 00:02:00,399
we faced was as as lucas said the

51
00:02:00,399 --> 00:02:02,960
interaction with the vendors yeah so the

52
00:02:02,960 --> 00:02:04,240
interaction with the vendors was a

53
00:02:04,240 --> 00:02:07,119
disaster they're like not a handful like

54
00:02:07,119 --> 00:02:09,440
three or five vendors which actually

55
00:02:09,440 --> 00:02:12,239
were very okay in the communication

56
00:02:12,239 --> 00:02:14,720
uh but the vast majority

57
00:02:14,720 --> 00:02:17,360
didn't know what pgp was didn't know

58
00:02:17,360 --> 00:02:20,959
what how to communicate encrypted

59
00:02:20,959 --> 00:02:22,560
they would default us to the support

60
00:02:22,560 --> 00:02:24,720
department or stuff like that so

61
00:02:24,720 --> 00:02:26,239
why do you think this is happening and

62
00:02:26,239 --> 00:02:28,080
then we can go

63
00:02:28,080 --> 00:02:31,280
and and watch the presentation

64
00:02:31,280 --> 00:02:33,760
it's it's the lack of education i don't

65
00:02:33,760 --> 00:02:36,000
think that they mean bad i don't think

66
00:02:36,000 --> 00:02:37,840
that they uh

67
00:02:37,840 --> 00:02:40,000
they are ill intended so to speak i

68
00:02:40,000 --> 00:02:42,879
think that they simply know how to build

69
00:02:42,879 --> 00:02:44,959
that particular device and they don't

70
00:02:44,959 --> 00:02:46,959
know that much about how to handle

71
00:02:46,959 --> 00:02:49,120
security or to have an open channel with

72
00:02:49,120 --> 00:02:51,200
security researchers i think that

73
00:02:51,200 --> 00:02:53,519
unfortunately the vast majority of

74
00:02:53,519 --> 00:02:55,519
companies not just in the iot space but

75
00:02:55,519 --> 00:02:56,720
everywhere the vast majority of

76
00:02:56,720 --> 00:02:59,120
companies don't have that channel open

77
00:02:59,120 --> 00:03:01,519
to internet and security researchers and

78
00:03:01,519 --> 00:03:03,760
if anything i would want to raise an

79
00:03:03,760 --> 00:03:05,519
alarm about that you know

80
00:03:05,519 --> 00:03:07,519
all companies should have a channel open

81
00:03:07,519 --> 00:03:09,440
to security researchers it's only going

82
00:03:09,440 --> 00:03:11,760
to going to make them more resilient

83
00:03:11,760 --> 00:03:13,840
but telling telling companies that you

84
00:03:13,840 --> 00:03:15,920
know let us hack you and tell you about

85
00:03:15,920 --> 00:03:19,040
it just doesn't have that ring that you

86
00:03:19,040 --> 00:03:20,480
know it just doesn't

87
00:03:20,480 --> 00:03:23,120
fit well with their mindset

88
00:03:23,120 --> 00:03:23,920
okay

89
00:03:23,920 --> 00:03:26,159
um wonderful intro

90
00:03:26,159 --> 00:03:29,599
um are you ready to share your screen

91
00:03:29,599 --> 00:03:31,040
let's see

92
00:03:31,040 --> 00:03:32,879
break a leg

93
00:03:32,879 --> 00:03:34,860
let's break some legs

94
00:03:34,860 --> 00:03:36,000
[Music]

95
00:03:36,000 --> 00:03:38,319
so good morning death camp

96
00:03:38,319 --> 00:03:40,080
it's so good to

97
00:03:40,080 --> 00:03:42,640
see you again i guess i just realized

98
00:03:42,640 --> 00:03:45,200
that this is the usual intro and i

99
00:03:45,200 --> 00:03:47,120
usually say it's so good to see you but

100
00:03:47,120 --> 00:03:50,400
um yeah i miss you guys i miss you it's

101
00:03:50,400 --> 00:03:52,400
been like two years

102
00:03:52,400 --> 00:03:54,879
since we've been face to face

103
00:03:54,879 --> 00:03:57,360
it was the 20

104
00:03:57,360 --> 00:03:59,760
2019 edition when it was the last time

105
00:03:59,760 --> 00:04:02,799
we we saw each other so yeah

106
00:04:02,799 --> 00:04:05,519
um so let's dive into it because we have

107
00:04:05,519 --> 00:04:07,120
a lot of content i don't think we have

108
00:04:07,120 --> 00:04:08,640
sufficient time i'm going to try to kind

109
00:04:08,640 --> 00:04:10,480
of squeeze it in

110
00:04:10,480 --> 00:04:13,680
this presentation is about a summary of

111
00:04:13,680 --> 00:04:15,519
the most relevant things we uncovered in

112
00:04:15,519 --> 00:04:17,120
the past five years

113
00:04:17,120 --> 00:04:19,600
and uh also some new stuff that we

114
00:04:19,600 --> 00:04:22,799
published this year

115
00:04:23,680 --> 00:04:25,199
so about me

116
00:04:25,199 --> 00:04:27,240
igbo defender in

117
00:04:27,240 --> 00:04:28,960
2004

118
00:04:28,960 --> 00:04:30,960
you can talk to me about vulnerability

119
00:04:30,960 --> 00:04:33,280
research we have a lot of focus solarity

120
00:04:33,280 --> 00:04:34,720
but we can talk about vulnerability

121
00:04:34,720 --> 00:04:37,759
research in other areas as well

122
00:04:37,759 --> 00:04:41,040
um i'm currently running an almost rock

123
00:04:41,040 --> 00:04:42,800
pen testing team within bit defender

124
00:04:42,800 --> 00:04:45,040
which is kind of cool um

125
00:04:45,040 --> 00:04:47,360
essentially the way i i got them to join

126
00:04:47,360 --> 00:04:48,560
was

127
00:04:48,560 --> 00:04:52,160
i told them that they can blow stuff up

128
00:04:52,160 --> 00:04:52,880
so

129
00:04:52,880 --> 00:04:54,639
they're like really we can blow stuff

130
00:04:54,639 --> 00:04:56,560
exactly like the madagascar penguin

131
00:04:56,560 --> 00:05:00,080
kaboom yes kaboom blow stuff up and they

132
00:05:00,080 --> 00:05:01,600
were like so happy in the start they

133
00:05:01,600 --> 00:05:03,440
started blowing stuff up and it was

134
00:05:03,440 --> 00:05:04,960
great

135
00:05:04,960 --> 00:05:05,919
um

136
00:05:05,919 --> 00:05:07,360
i'm running the defenders back bounty

137
00:05:07,360 --> 00:05:09,440
program if you want to hack us you can

138
00:05:09,440 --> 00:05:10,800
you should

139
00:05:10,800 --> 00:05:14,880
try it the attack surface is huge

140
00:05:14,880 --> 00:05:16,560
at bitdefender

141
00:05:16,560 --> 00:05:17,840
so um

142
00:05:17,840 --> 00:05:18,639
yeah

143
00:05:18,639 --> 00:05:21,520
you should have a look at it run your

144
00:05:21,520 --> 00:05:25,039
passive scans recons active scans and

145
00:05:25,039 --> 00:05:26,880
and talk to us

146
00:05:26,880 --> 00:05:28,800
um the bug bounty program if you want

147
00:05:28,800 --> 00:05:31,360
it's on backroad and we also have a

148
00:05:31,360 --> 00:05:33,440
separate one running on our website if

149
00:05:33,440 --> 00:05:35,039
you do not want to interact with bug

150
00:05:35,039 --> 00:05:37,360
crowd

151
00:05:37,360 --> 00:05:41,039
hang on sorry sorry sorry

152
00:05:41,039 --> 00:05:42,560
okay

153
00:05:42,560 --> 00:05:45,199
um i'm also deeply involved in the

154
00:05:45,199 --> 00:05:47,199
vulnerability management process so all

155
00:05:47,199 --> 00:05:49,919
the vulnerabilities that uh we identify

156
00:05:49,919 --> 00:05:51,520
either in the pen testing team or in the

157
00:05:51,520 --> 00:05:53,440
background program have to go through a

158
00:05:53,440 --> 00:05:56,319
vulnerability management process

159
00:05:56,319 --> 00:05:57,280
and

160
00:05:57,280 --> 00:05:58,800
[Music]

161
00:05:58,800 --> 00:06:00,000
i also

162
00:06:00,000 --> 00:06:02,800
just re-watched cowboy bebop awesome if

163
00:06:02,800 --> 00:06:05,600
you didn't say it strongly recommend

164
00:06:05,600 --> 00:06:08,880
and also i'm a proud def can dinosaur

165
00:06:08,880 --> 00:06:11,840
my first death camp presentation was i

166
00:06:11,840 --> 00:06:13,280
don't know when

167
00:06:13,280 --> 00:06:14,880
i don't remember but i remember there

168
00:06:14,880 --> 00:06:17,360
were like 80 people in total

169
00:06:17,360 --> 00:06:21,280
that were present at the conference

170
00:06:21,280 --> 00:06:23,199
about b defenders vulnerability research

171
00:06:23,199 --> 00:06:24,960
team we started doing vulnerability

172
00:06:24,960 --> 00:06:28,240
research in 2016.

173
00:06:28,240 --> 00:06:31,360
we found vulnerabilities with eight plus

174
00:06:31,360 --> 00:06:34,960
vss score in more than 20 brands so i i

175
00:06:34,960 --> 00:06:37,039
as i was telling andrada earlier

176
00:06:37,039 --> 00:06:38,000
we

177
00:06:38,000 --> 00:06:40,639
researched about 40 devices

178
00:06:40,639 --> 00:06:44,240
um and we found

179
00:06:44,240 --> 00:06:47,280
so eight plus on the cvs core is bad

180
00:06:47,280 --> 00:06:49,199
it's like really really bad it is remote

181
00:06:49,199 --> 00:06:50,639
command execution without any

182
00:06:50,639 --> 00:06:52,720
prerequisites bad

183
00:06:52,720 --> 00:06:54,400
or but can't take over without any

184
00:06:54,400 --> 00:06:56,400
prerequisites back

185
00:06:56,400 --> 00:06:57,199
so

186
00:06:57,199 --> 00:06:59,199
this is the fun part but the not so fun

187
00:06:59,199 --> 00:07:02,400
part is that we only published 12 papers

188
00:07:02,400 --> 00:07:04,240
which amount to like a very very small

189
00:07:04,240 --> 00:07:06,080
fraction of

190
00:07:06,080 --> 00:07:08,319
our total findings

191
00:07:08,319 --> 00:07:10,400
uh in other words

192
00:07:10,400 --> 00:07:11,520
we have

193
00:07:11,520 --> 00:07:14,000
a ton of papers that we're sitting on

194
00:07:14,000 --> 00:07:17,759
and we cannot publish them

195
00:07:17,759 --> 00:07:20,319
because of poor or no reply from vendors

196
00:07:20,319 --> 00:07:22,720
the thing is um some of the things that

197
00:07:22,720 --> 00:07:24,479
we found can be used for mass

198
00:07:24,479 --> 00:07:26,639
exploitation and

199
00:07:26,639 --> 00:07:27,520
um

200
00:07:27,520 --> 00:07:29,840
while i know some of you will say that

201
00:07:29,840 --> 00:07:31,919
just give them the the 60 days and then

202
00:07:31,919 --> 00:07:33,280
publish it because that's going to force

203
00:07:33,280 --> 00:07:35,280
their hand

204
00:07:35,280 --> 00:07:37,599
it's really not that

205
00:07:37,599 --> 00:07:40,000
it's really not the case in iot

206
00:07:40,000 --> 00:07:41,840
in some cases the vendors if you even if

207
00:07:41,840 --> 00:07:43,680
you do publish

208
00:07:43,680 --> 00:07:45,280
they won't patch it

209
00:07:45,280 --> 00:07:46,879
and then that's going to put some people

210
00:07:46,879 --> 00:07:49,280
at risk so we're still trying to kind of

211
00:07:49,280 --> 00:07:52,080
balance that out

212
00:07:52,639 --> 00:07:54,400
and also very important four years ago

213
00:07:54,400 --> 00:07:56,160
we started to focus a lot on iot cloud

214
00:07:56,160 --> 00:07:58,879
platforms and there's a reason for that

215
00:07:58,879 --> 00:07:59,200
um

216
00:07:59,200 --> 00:08:00,720
[Music]

217
00:08:00,720 --> 00:08:03,520
nowadays most iots are starting to move

218
00:08:03,520 --> 00:08:06,240
away from port forwarding so in the old

219
00:08:06,240 --> 00:08:07,840
days you would have a

220
00:08:07,840 --> 00:08:10,400
security camera or a thermostat or

221
00:08:10,400 --> 00:08:12,160
an electrical control system or

222
00:08:12,160 --> 00:08:13,520
something like that

223
00:08:13,520 --> 00:08:16,160
and you would port forward it

224
00:08:16,160 --> 00:08:17,759
uh so you could access it from the

225
00:08:17,759 --> 00:08:20,639
internet now that's thankfully not the

226
00:08:20,639 --> 00:08:23,199
case anymore and most smart devices are

227
00:08:23,199 --> 00:08:25,120
just cloud relayed

228
00:08:25,120 --> 00:08:27,199
have cloud related communication

229
00:08:27,199 --> 00:08:28,240
so

230
00:08:28,240 --> 00:08:30,479
with that in mind we obviously started

231
00:08:30,479 --> 00:08:32,000
to look at how those cloud

232
00:08:32,000 --> 00:08:34,958
implementations work

233
00:08:34,958 --> 00:08:36,320
we published

234
00:08:36,320 --> 00:08:37,760
a lot

235
00:08:37,760 --> 00:08:39,440
thankfully so we managed to publish for

236
00:08:39,440 --> 00:08:40,640
example

237
00:08:40,640 --> 00:08:42,559
we had a very good

238
00:08:42,559 --> 00:08:44,720
communication with august smartlav or

239
00:08:44,720 --> 00:08:46,160
with ring doorbell

240
00:08:46,160 --> 00:08:49,120
when we found when we reported our

241
00:08:49,120 --> 00:08:51,040
findings to them they replied almost

242
00:08:51,040 --> 00:08:54,160
instantly and they patched uh their

243
00:08:54,160 --> 00:08:56,720
entire user base in under a month and

244
00:08:56,720 --> 00:08:58,720
that's that's a very good metric

245
00:08:58,720 --> 00:09:01,200
unfortunately with most others they

246
00:09:01,200 --> 00:09:03,519
didn't

247
00:09:04,560 --> 00:09:06,880
now the first chapter is reusable attack

248
00:09:06,880 --> 00:09:08,640
vectors and common vulnerabilities so

249
00:09:08,640 --> 00:09:11,440
this is stuff that's present in the vast

250
00:09:11,440 --> 00:09:14,800
majority of smart devices

251
00:09:15,279 --> 00:09:19,040
wi-fi password hijack so

252
00:09:19,040 --> 00:09:20,720
this is an attack which enables you to

253
00:09:20,720 --> 00:09:23,200
steal a victim's wifi password if they

254
00:09:23,200 --> 00:09:25,040
have a smart device and the way this

255
00:09:25,040 --> 00:09:27,040
goes is like this

256
00:09:27,040 --> 00:09:29,040
when you initially set up a device the

257
00:09:29,040 --> 00:09:31,920
process this is a description of how

258
00:09:31,920 --> 00:09:34,240
the process looks from uh under the

259
00:09:34,240 --> 00:09:35,920
standpoint when you initially set up a

260
00:09:35,920 --> 00:09:38,800
smart device so step one

261
00:09:38,800 --> 00:09:40,720
i'm sorry i should have put step zero

262
00:09:40,720 --> 00:09:42,399
you plug it in

263
00:09:42,399 --> 00:09:44,640
so step one after you've plugged it in

264
00:09:44,640 --> 00:09:47,279
it boots and then it creates a uh a

265
00:09:47,279 --> 00:09:49,920
hotspot and the manual says you install

266
00:09:49,920 --> 00:09:52,240
the application the setup application

267
00:09:52,240 --> 00:09:54,320
and then it says okay connect to the

268
00:09:54,320 --> 00:09:55,680
wi-fi

269
00:09:55,680 --> 00:09:59,519
hotspot created by the smart device

270
00:09:59,519 --> 00:10:00,720
step two

271
00:10:00,720 --> 00:10:02,480
after you've connected to that smart

272
00:10:02,480 --> 00:10:04,160
device it tells you okay i'm

273
00:10:04,160 --> 00:10:05,360
successfully connected to the smart

274
00:10:05,360 --> 00:10:07,200
device now i want you to select your

275
00:10:07,200 --> 00:10:08,880
home wi-fi

276
00:10:08,880 --> 00:10:11,279
from this list

277
00:10:11,279 --> 00:10:14,880
and enter your wi-fi password

278
00:10:15,920 --> 00:10:17,760
after that there's several other

279
00:10:17,760 --> 00:10:19,360
settings you can set up notifications

280
00:10:19,360 --> 00:10:21,120
whatever the device supports

281
00:10:21,120 --> 00:10:24,079
you know various devices support various

282
00:10:24,079 --> 00:10:26,160
features

283
00:10:26,160 --> 00:10:29,279
and then it goes in configuring mode

284
00:10:29,279 --> 00:10:33,040
and then usually it stucks and then it

285
00:10:33,040 --> 00:10:34,240
fails

286
00:10:34,240 --> 00:10:36,399
i've seen this so many times

287
00:10:36,399 --> 00:10:40,480
and then you try again and it works

288
00:10:40,480 --> 00:10:43,120
now what happens when you're doing that

289
00:10:43,120 --> 00:10:46,320
in that configuration stage is that

290
00:10:46,320 --> 00:10:47,680
everything that you've set up in the

291
00:10:47,680 --> 00:10:50,000
mobile app gets packaged into a json

292
00:10:50,000 --> 00:10:52,800
file or an xml file or a text file why

293
00:10:52,800 --> 00:10:53,760
not

294
00:10:53,760 --> 00:10:56,399
which gets sent to the device well while

295
00:10:56,399 --> 00:10:57,839
your mobile application is still

296
00:10:57,839 --> 00:10:59,360
connected to that

297
00:10:59,360 --> 00:11:01,440
wi-fi network

298
00:11:01,440 --> 00:11:04,399
the device stores that and reboots using

299
00:11:04,399 --> 00:11:05,920
that configuration

300
00:11:05,920 --> 00:11:07,920
part of that configuration is

301
00:11:07,920 --> 00:11:09,839
connect to this wi-fi network with this

302
00:11:09,839 --> 00:11:11,440
password

303
00:11:11,440 --> 00:11:12,839
and the other

304
00:11:12,839 --> 00:11:16,720
settings now the one thing that

305
00:11:16,720 --> 00:11:18,720
happens is that that

306
00:11:18,720 --> 00:11:21,120
access point created by the

307
00:11:21,120 --> 00:11:22,640
smart device is

308
00:11:22,640 --> 00:11:24,000
usually open

309
00:11:24,000 --> 00:11:26,880
it doesn't have a password in 99 of the

310
00:11:26,880 --> 00:11:30,160
cases and little known fact about wi-fi

311
00:11:30,160 --> 00:11:33,200
is that on uh open access point so

312
00:11:33,200 --> 00:11:34,560
access points that do not have a

313
00:11:34,560 --> 00:11:35,760
password

314
00:11:35,760 --> 00:11:37,120
there's also no encryption on that

315
00:11:37,120 --> 00:11:39,760
channel and you can monitor the channel

316
00:11:39,760 --> 00:11:41,760
and see the traffic on that channel

317
00:11:41,760 --> 00:11:44,320
without being associated with that

318
00:11:44,320 --> 00:11:45,839
channel

319
00:11:45,839 --> 00:11:47,839
so you can actually see that file going

320
00:11:47,839 --> 00:11:49,760
from the mobile phone to the smart

321
00:11:49,760 --> 00:11:53,120
device and capture it

322
00:11:55,440 --> 00:11:58,000
in some implementations

323
00:11:58,000 --> 00:11:59,920
that config file is encrypted and

324
00:11:59,920 --> 00:12:00,720
there's

325
00:12:00,720 --> 00:12:02,480
some sort of key exchange between the

326
00:12:02,480 --> 00:12:04,800
smart device and the mobile app but in

327
00:12:04,800 --> 00:12:07,120
most cases it's plain text so the attack

328
00:12:07,120 --> 00:12:09,440
moment is when that exchange happens and

329
00:12:09,440 --> 00:12:11,040
you can steal it

330
00:12:11,040 --> 00:12:12,800
and if you're wondering

331
00:12:12,800 --> 00:12:14,480
about the vulnerability window being

332
00:12:14,480 --> 00:12:16,399
only in setup mode

333
00:12:16,399 --> 00:12:18,639
well

334
00:12:22,959 --> 00:12:25,440
hang on

335
00:12:25,440 --> 00:12:27,040
the way this works involves a little bit

336
00:12:27,040 --> 00:12:29,279
of social engineering as well uh you

337
00:12:29,279 --> 00:12:32,399
simply knock the device out

338
00:12:32,399 --> 00:12:34,160
of the network with the authentication

339
00:12:34,160 --> 00:12:36,160
packets

340
00:12:36,160 --> 00:12:38,720
it's trivial to do so for those of you

341
00:12:38,720 --> 00:12:40,079
who don't know what the authentication

342
00:12:40,079 --> 00:12:42,399
packets are essentially it's a feature

343
00:12:42,399 --> 00:12:45,360
in the wi-fi implementation that enables

344
00:12:45,360 --> 00:12:47,279
somebody from outside of the wi-fi

345
00:12:47,279 --> 00:12:48,240
network

346
00:12:48,240 --> 00:12:50,480
to disconnect a device from the wi-fi

347
00:12:50,480 --> 00:12:52,880
network so you simply keep flooding that

348
00:12:52,880 --> 00:12:54,560
device with the authentication packets

349
00:12:54,560 --> 00:12:56,880
and brick it which will force the user

350
00:12:56,880 --> 00:12:59,120
to reconfigure it

351
00:12:59,120 --> 00:13:00,800
and then you have your windows

352
00:13:00,800 --> 00:13:02,079
vulnerability to steal the wi-fi

353
00:13:02,079 --> 00:13:05,440
password so for today's presentation

354
00:13:05,440 --> 00:13:07,200
we're gonna show you

355
00:13:07,200 --> 00:13:08,240
um

356
00:13:08,240 --> 00:13:09,760
what we did with august log because

357
00:13:09,760 --> 00:13:11,360
august lock is definitely better

358
00:13:11,360 --> 00:13:13,600
implemented than most other devices they

359
00:13:13,600 --> 00:13:15,680
were actually encrypted encrypting that

360
00:13:15,680 --> 00:13:17,279
package

361
00:13:17,279 --> 00:13:19,760
unfortunately the encryption key was

362
00:13:19,760 --> 00:13:21,200
hard coded and it was the same

363
00:13:21,200 --> 00:13:23,440
encryption key for all devices so when

364
00:13:23,440 --> 00:13:25,360
we extracted our decryption key we

365
00:13:25,360 --> 00:13:28,480
purchased another lock just to see if we

366
00:13:28,480 --> 00:13:32,160
can reuse it and we could

367
00:13:32,160 --> 00:13:35,160
so

368
00:13:36,000 --> 00:13:38,320
this is how the attack looked against

369
00:13:38,320 --> 00:13:40,959
august log

370
00:13:41,760 --> 00:13:44,240
you start scanning the wi-fi spectrum

371
00:13:44,240 --> 00:13:45,600
i'm going to fast forward because we

372
00:13:45,600 --> 00:13:46,959
don't have a lot of time we see the

373
00:13:46,959 --> 00:13:48,880
wi-fi network

374
00:13:48,880 --> 00:13:52,720
the aphrodite beauty salon

375
00:13:54,160 --> 00:13:55,760
then we start monitoring that wi-fi

376
00:13:55,760 --> 00:13:58,160
network to catch the mac address of our

377
00:13:58,160 --> 00:14:01,560
victim device

378
00:14:05,600 --> 00:14:06,880
as you can see there's no need to

379
00:14:06,880 --> 00:14:09,279
authenticate or or use that wi-fi

380
00:14:09,279 --> 00:14:12,279
network

381
00:14:16,320 --> 00:14:18,000
so we have the mac address of our victim

382
00:14:18,000 --> 00:14:20,480
device and now we are going to

383
00:14:20,480 --> 00:14:23,040
to kick it off the network

384
00:14:23,040 --> 00:14:24,880
and i know that this

385
00:14:24,880 --> 00:14:27,279
is basic stuff for most of you what i'm

386
00:14:27,279 --> 00:14:28,399
trying to outline here is not

387
00:14:28,399 --> 00:14:29,600
necessarily the fact that you can kick

388
00:14:29,600 --> 00:14:30,800
off the network device with your

389
00:14:30,800 --> 00:14:33,680
authentication packets but the fact that

390
00:14:33,680 --> 00:14:35,519
there's that vulnerability window that

391
00:14:35,519 --> 00:14:37,760
you can actually info

392
00:14:37,760 --> 00:14:40,560
get again from the user you know that

393
00:14:40,560 --> 00:14:42,160
setup moment

394
00:14:42,160 --> 00:14:44,959
so you kick it off and then at some

395
00:14:44,959 --> 00:14:46,720
point we're going to see

396
00:14:46,720 --> 00:14:48,160
uh

397
00:14:48,160 --> 00:14:49,760
there's a reconfiguring the device that

398
00:14:49,760 --> 00:14:50,880
we're gonna we're gonna we're going to

399
00:14:50,880 --> 00:14:53,040
see the hotspot created by the august

400
00:14:53,040 --> 00:14:54,399
the by the

401
00:14:54,399 --> 00:14:58,040
by the smart clock

402
00:14:59,040 --> 00:15:00,320
let's follow it fast forward fast

403
00:15:00,320 --> 00:15:01,279
forward

404
00:15:01,279 --> 00:15:03,839
and there we have it august lock dash

405
00:15:03,839 --> 00:15:06,839
c5wi

406
00:15:08,079 --> 00:15:10,079
now what we're doing we're sniffing and

407
00:15:10,079 --> 00:15:11,360
we're gonna

408
00:15:11,360 --> 00:15:13,199
switch to wireshark to see the packets

409
00:15:13,199 --> 00:15:16,639
exchanged with that

410
00:15:17,120 --> 00:15:20,519
access point

411
00:15:26,959 --> 00:15:29,920
hang on and there we have the file which

412
00:15:29,920 --> 00:15:33,040
is currently encrypted

413
00:15:34,800 --> 00:15:38,000
so all we gotta do is just use the key

414
00:15:38,000 --> 00:15:38,839
to

415
00:15:38,839 --> 00:15:41,440
decrypt so we have this small python

416
00:15:41,440 --> 00:15:43,279
script that is able to decrypt and then

417
00:15:43,279 --> 00:15:44,240
we have

418
00:15:44,240 --> 00:15:46,639
the wi-fi password

419
00:15:46,639 --> 00:15:49,199
for a wrinkle stand so pantone 10 for

420
00:15:49,199 --> 00:15:51,680
adidas

421
00:15:51,839 --> 00:15:53,920
so that's the that's the wi-fi hijacked

422
00:15:53,920 --> 00:15:56,560
password for iot so again 99 of all

423
00:15:56,560 --> 00:15:58,560
smart devices will create that hotspot

424
00:15:58,560 --> 00:16:00,320
all you got to do is just string the 3d

425
00:16:00,320 --> 00:16:02,800
user into reconfiguring the device

426
00:16:02,800 --> 00:16:05,279
capture that configuration file file

427
00:16:05,279 --> 00:16:08,000
being sent over and you have the device

428
00:16:08,000 --> 00:16:09,759
configuration which includes the wi-fi

429
00:16:09,759 --> 00:16:11,759
password

430
00:16:11,759 --> 00:16:13,680
now we come to the cool part because you

431
00:16:13,680 --> 00:16:15,199
know um

432
00:16:15,199 --> 00:16:16,959
getting the wi-fi password requires

433
00:16:16,959 --> 00:16:18,720
proximity

434
00:16:18,720 --> 00:16:19,839
so

435
00:16:19,839 --> 00:16:22,079
you cannot really do it against millions

436
00:16:22,079 --> 00:16:23,519
and millions of devices so we get to the

437
00:16:23,519 --> 00:16:25,759
cool park uh computing cloud

438
00:16:25,759 --> 00:16:27,120
implementations

439
00:16:27,120 --> 00:16:28,639
so

440
00:16:28,639 --> 00:16:30,240
an example of abusing clone

441
00:16:30,240 --> 00:16:32,120
implementation is going to be the um

442
00:16:32,120 --> 00:16:33,839
[Music]

443
00:16:33,839 --> 00:16:36,959
edimax smart power outlet so here's how

444
00:16:36,959 --> 00:16:39,519
cloud works in iot

445
00:16:39,519 --> 00:16:40,320
um

446
00:16:40,320 --> 00:16:42,000
on the mobile phone we say we want to

447
00:16:42,000 --> 00:16:43,519
control something about the device we

448
00:16:43,519 --> 00:16:45,360
want to tell the vacuum cleaner to start

449
00:16:45,360 --> 00:16:47,759
cleaning or we want to tell the

450
00:16:47,759 --> 00:16:49,839
the power outlet to tell us to give us

451
00:16:49,839 --> 00:16:52,160
notifications when we're using too much

452
00:16:52,160 --> 00:16:54,639
power and whatever interaction we want

453
00:16:54,639 --> 00:16:56,560
to have with the smart device that's

454
00:16:56,560 --> 00:16:58,160
inside our house

455
00:16:58,160 --> 00:17:00,320
and we are gone you know we are outside

456
00:17:00,320 --> 00:17:01,839
of the house we are in another country

457
00:17:01,839 --> 00:17:02,959
maybe

458
00:17:02,959 --> 00:17:06,400
and the cloud talks the smart device in

459
00:17:06,400 --> 00:17:08,000
our house talks to the cloud and our

460
00:17:08,000 --> 00:17:10,160
mobile device talks to the cloud

461
00:17:10,160 --> 00:17:12,400
and the cloud we relay

462
00:17:12,400 --> 00:17:15,760
our interactions with the smart device

463
00:17:15,760 --> 00:17:17,280
um

464
00:17:17,280 --> 00:17:21,439
and it facilitate that communication

465
00:17:21,439 --> 00:17:23,280
but the thing is whatever is being

466
00:17:23,280 --> 00:17:25,520
relayed by the cloud is essentially

467
00:17:25,520 --> 00:17:27,599
input right so i'm telling the cloud

468
00:17:27,599 --> 00:17:30,480
abcd the cloud will say will tell the

469
00:17:30,480 --> 00:17:32,480
smart device okay that guy just said

470
00:17:32,480 --> 00:17:35,280
abcd and that abcd is going to be parsed

471
00:17:35,280 --> 00:17:37,200
by code on the smart device and that

472
00:17:37,200 --> 00:17:38,400
code

473
00:17:38,400 --> 00:17:41,520
may be and very often is vulnerable to

474
00:17:41,520 --> 00:17:44,960
buffer overflows command ejection

475
00:17:44,960 --> 00:17:47,840
various types of you know parsing

476
00:17:47,840 --> 00:17:50,240
uh parsing vulnerabilities

477
00:17:50,240 --> 00:17:52,880
maybe miss tragic uh maybe any kind of

478
00:17:52,880 --> 00:17:55,520
other partial vulnerability so it's

479
00:17:55,520 --> 00:17:57,360
really cool because

480
00:17:57,360 --> 00:18:00,000
this is a very uh this is not very

481
00:18:00,000 --> 00:18:01,600
researched there's not a lot of research

482
00:18:01,600 --> 00:18:03,280
done in this direction

483
00:18:03,280 --> 00:18:05,120
and a lot of the code on the smart

484
00:18:05,120 --> 00:18:08,240
devices is insanely vulnerable and also

485
00:18:08,240 --> 00:18:10,480
there is no aslr on smart device so if

486
00:18:10,480 --> 00:18:12,240
you find a buffer overflow

487
00:18:12,240 --> 00:18:13,760
you have a very good chance of getting

488
00:18:13,760 --> 00:18:16,480
predictable remote map execution

489
00:18:16,480 --> 00:18:19,440
so yes most smart devices

490
00:18:19,440 --> 00:18:21,919
have slr enabled but it's not used

491
00:18:21,919 --> 00:18:24,160
because the binaries in in iot are

492
00:18:24,160 --> 00:18:26,559
compiled without pi without position

493
00:18:26,559 --> 00:18:29,760
independent executable

494
00:18:29,760 --> 00:18:30,710
so um

495
00:18:30,710 --> 00:18:32,320
[Music]

496
00:18:32,320 --> 00:18:33,520
we

497
00:18:33,520 --> 00:18:36,240
we have two papers we have a few up more

498
00:18:36,240 --> 00:18:37,280
actually but

499
00:18:37,280 --> 00:18:39,600
for the sake of today the edimax smart

500
00:18:39,600 --> 00:18:40,880
power outlet

501
00:18:40,880 --> 00:18:42,960
had a command injection

502
00:18:42,960 --> 00:18:45,120
so

503
00:18:45,760 --> 00:18:48,720
here's how that worked

504
00:18:52,880 --> 00:18:54,720
wait

505
00:18:54,720 --> 00:18:57,840
so first of all

506
00:18:57,919 --> 00:18:59,919
we set up at least normal test so what

507
00:18:59,919 --> 00:19:02,080
we want to do is we want to tell the

508
00:19:02,080 --> 00:19:04,320
cloud to tell the power outlet

509
00:19:04,320 --> 00:19:05,600
um

510
00:19:05,600 --> 00:19:07,679
about the commands that we want to send

511
00:19:07,679 --> 00:19:09,760
about an information and we want to

512
00:19:09,760 --> 00:19:11,600
trigger a connect back shell from the

513
00:19:11,600 --> 00:19:13,280
power outlet right because it's behind

514
00:19:13,280 --> 00:19:14,720
that it's behind maybe three four

515
00:19:14,720 --> 00:19:16,720
firewalls in this case it was actually

516
00:19:16,720 --> 00:19:19,520
in our offices in cluj

517
00:19:19,520 --> 00:19:22,400
so um we wanted to trigger the power

518
00:19:22,400 --> 00:19:24,000
outlet to send the connect back shell to

519
00:19:24,000 --> 00:19:26,160
us so we set up a listener you know

520
00:19:26,160 --> 00:19:27,919
on a vps i think it was somewhere in

521
00:19:27,919 --> 00:19:30,240
canada

522
00:19:30,240 --> 00:19:33,280
as you can see it's mips little indian

523
00:19:33,280 --> 00:19:35,120
and

524
00:19:35,120 --> 00:19:36,160
this is

525
00:19:36,160 --> 00:19:40,480
our payload our payload is is base64 in

526
00:19:40,480 --> 00:19:41,919
semicolon

527
00:19:41,919 --> 00:19:46,080
go to tmp and get our second stage

528
00:19:46,080 --> 00:19:47,280
payload

529
00:19:47,280 --> 00:19:50,080
and execute it

530
00:19:50,320 --> 00:19:52,400
it was a command injection i'm not going

531
00:19:52,400 --> 00:19:55,200
to detail it now the the paper on

532
00:19:55,200 --> 00:19:56,960
document ejection and how it works is on

533
00:19:56,960 --> 00:19:58,400
our website

534
00:19:58,400 --> 00:20:00,080
but as you can see

535
00:20:00,080 --> 00:20:03,200
we sent it and by the way i forgot to

536
00:20:03,200 --> 00:20:05,840
mention the only uh requirement for

537
00:20:05,840 --> 00:20:08,000
exploiting is the is the mac address of

538
00:20:08,000 --> 00:20:12,080
the power outlet uh fun fact

539
00:20:12,080 --> 00:20:14,640
a lot of researchers after i initially

540
00:20:14,640 --> 00:20:16,320
did a presentation on the rmax smart

541
00:20:16,320 --> 00:20:18,960
power outlet a lot of the researchers

542
00:20:18,960 --> 00:20:20,400
said that they're going to use this in

543
00:20:20,400 --> 00:20:22,400
the red team engagements so essentially

544
00:20:22,400 --> 00:20:24,320
what they were going to do and i think

545
00:20:24,320 --> 00:20:26,559
that what they're actually doing is they

546
00:20:26,559 --> 00:20:28,640
purchase the smart power outlet copy the

547
00:20:28,640 --> 00:20:30,159
mac address from the box because it's

548
00:20:30,159 --> 00:20:32,000
visible on the box and then they just

549
00:20:32,000 --> 00:20:34,880
gift it to their targets and the moment

550
00:20:34,880 --> 00:20:37,360
the target sets it up the attacker has a

551
00:20:37,360 --> 00:20:39,679
foothold in the in the target's home

552
00:20:39,679 --> 00:20:42,240
network it's pretty cool so again the

553
00:20:42,240 --> 00:20:43,440
only thing that you need is the mac

554
00:20:43,440 --> 00:20:45,679
address

555
00:20:45,679 --> 00:20:48,240
you tell the cloud to relay your payload

556
00:20:48,240 --> 00:20:51,600
and then you can see that

557
00:20:51,919 --> 00:20:53,919
the payload was executed it got the

558
00:20:53,919 --> 00:20:56,320
second stage

559
00:20:56,320 --> 00:21:01,399
and then you have a shell session open

560
00:21:02,159 --> 00:21:04,000
and obviously this is just on some stuff

561
00:21:04,000 --> 00:21:05,760
that you can do

562
00:21:05,760 --> 00:21:06,640
on

563
00:21:06,640 --> 00:21:08,320
while you have access on the power

564
00:21:08,320 --> 00:21:10,240
outlet like get the wi-fi password or

565
00:21:10,240 --> 00:21:12,240
use it to pivot and detect the rest of

566
00:21:12,240 --> 00:21:15,400
the network

567
00:21:18,400 --> 00:21:21,280
third thing is mqtt so

568
00:21:21,280 --> 00:21:23,120
for those of you who don't know mqtt is

569
00:21:23,120 --> 00:21:24,080
a

570
00:21:24,080 --> 00:21:26,400
messaging service if you will

571
00:21:26,400 --> 00:21:28,320
that enables quick messaging and

572
00:21:28,320 --> 00:21:30,720
notifications and commands between the

573
00:21:30,720 --> 00:21:33,039
mobile app and the device

574
00:21:33,039 --> 00:21:34,880
so the device can say

575
00:21:34,880 --> 00:21:37,120
i'm on i'm off uh i've just seen

576
00:21:37,120 --> 00:21:38,799
somebody at the door

577
00:21:38,799 --> 00:21:41,440
i've just started vacuuming

578
00:21:41,440 --> 00:21:43,760
i have too much beer in the fridge

579
00:21:43,760 --> 00:21:45,039
whatever

580
00:21:45,039 --> 00:21:46,720
and these are like short messages that

581
00:21:46,720 --> 00:21:48,559
are relayed to the mobile app so you get

582
00:21:48,559 --> 00:21:50,080
that notification on the mobile app that

583
00:21:50,080 --> 00:21:51,919
says there's too much beer in the fridge

584
00:21:51,919 --> 00:21:53,600
there's not enough beer in the fridge

585
00:21:53,600 --> 00:21:56,080
and so on and so forth

586
00:21:56,080 --> 00:21:58,480
so the way mqtt works is that it has a

587
00:21:58,480 --> 00:22:00,400
tree structure

588
00:22:00,400 --> 00:22:03,200
uh you have like slash root slash device

589
00:22:03,200 --> 00:22:05,679
id slash topic but the topic is one of

590
00:22:05,679 --> 00:22:07,120
these events

591
00:22:07,120 --> 00:22:08,799
now ideally you should only be able to

592
00:22:08,799 --> 00:22:10,880
register to your own devices so when you

593
00:22:10,880 --> 00:22:12,880
configure your device

594
00:22:12,880 --> 00:22:14,799
you establish this initial protocol okay

595
00:22:14,799 --> 00:22:16,720
this is the device id from the device

596
00:22:16,720 --> 00:22:18,240
that i own

597
00:22:18,240 --> 00:22:19,760
and then

598
00:22:19,760 --> 00:22:21,679
the mobile app will know that it's going

599
00:22:21,679 --> 00:22:23,840
to register to slash root slash device

600
00:22:23,840 --> 00:22:25,679
id and it's going to be able to access

601
00:22:25,679 --> 00:22:27,200
all the topics and notifications from

602
00:22:27,200 --> 00:22:29,200
that device id

603
00:22:29,200 --> 00:22:31,840
a common mistake that manufacturers make

604
00:22:31,840 --> 00:22:33,679
is that so when we initially saw this

605
00:22:33,679 --> 00:22:36,240
implementation we thought okay why what

606
00:22:36,240 --> 00:22:39,360
if we tried to access the root

607
00:22:39,360 --> 00:22:40,880
uh

608
00:22:40,880 --> 00:22:43,360
what's going to happen then and bam when

609
00:22:43,360 --> 00:22:45,760
we tried that in some cases we started

610
00:22:45,760 --> 00:22:47,520
to see the notifications of all the

611
00:22:47,520 --> 00:22:48,880
devices

612
00:22:48,880 --> 00:22:52,000
made by that vendor

613
00:22:52,400 --> 00:22:56,159
and pretty much the same thing with s3

614
00:22:56,159 --> 00:22:58,400
s3 as most of you probably know is that

615
00:22:58,400 --> 00:23:00,799
storage service from amazon

616
00:23:00,799 --> 00:23:02,559
uh and uh

617
00:23:02,559 --> 00:23:04,559
one of the most common flaws is that

618
00:23:04,559 --> 00:23:06,240
they have something like directory index

619
00:23:06,240 --> 00:23:07,520
of web servers

620
00:23:07,520 --> 00:23:09,840
activated and when that's activated

621
00:23:09,840 --> 00:23:11,360
you can access

622
00:23:11,360 --> 00:23:13,840
all the data from a particular vendor

623
00:23:13,840 --> 00:23:17,200
that uses that s3 bucket so normally

624
00:23:17,200 --> 00:23:20,080
when when you see that a vendor uses s3

625
00:23:20,080 --> 00:23:21,919
you can do this by monitoring what the

626
00:23:21,919 --> 00:23:24,000
mobile application does it's going to

627
00:23:24,000 --> 00:23:26,960
start accessing files in an s3 bucket

628
00:23:26,960 --> 00:23:29,120
a very simple thing that you can try

629
00:23:29,120 --> 00:23:31,120
is okay

630
00:23:31,120 --> 00:23:33,440
can i try and access all the files in

631
00:23:33,440 --> 00:23:34,960
that bucket

632
00:23:34,960 --> 00:23:36,559
and unfortunately in some cases it's

633
00:23:36,559 --> 00:23:38,880
going to work

634
00:23:38,880 --> 00:23:41,039
and this was actually the root cause of

635
00:23:41,039 --> 00:23:44,400
many hacks in the past if you google

636
00:23:44,400 --> 00:23:46,799
s3 bucket

637
00:23:46,799 --> 00:23:49,200
database dump or s3 bucket database

638
00:23:49,200 --> 00:23:51,919
click or s3 bucket company hacked you're

639
00:23:51,919 --> 00:23:55,520
gonna see unfortunately a lot of news

640
00:23:55,520 --> 00:23:57,679
about companies getting hacked simply by

641
00:23:57,679 --> 00:24:02,000
having a an exposed s3 bucket

642
00:24:02,840 --> 00:24:06,559
so moving to today's uh presentation i'm

643
00:24:06,559 --> 00:24:09,520
gonna skip the

644
00:24:09,520 --> 00:24:11,039
description of the product it's just a

645
00:24:11,039 --> 00:24:14,799
baby monitor so mqtt uh the first thing

646
00:24:14,799 --> 00:24:16,640
that we noticed was an unauthenticated

647
00:24:16,640 --> 00:24:18,080
mqtt information link they have their

648
00:24:18,080 --> 00:24:20,320
own mqtt relay server which is publicly

649
00:24:20,320 --> 00:24:22,320
exposed in the internet

650
00:24:22,320 --> 00:24:25,360
uh all you have to do is just um

651
00:24:25,360 --> 00:24:27,919
register to it and you're gonna see the

652
00:24:27,919 --> 00:24:31,840
ids of all the devices that come online

653
00:24:31,840 --> 00:24:33,840
unfortunately unfortunately there's no

654
00:24:33,840 --> 00:24:36,320
authentication necessary and this is how

655
00:24:36,320 --> 00:24:38,480
it looks like there's a tool called

656
00:24:38,480 --> 00:24:40,320
called mosquito

657
00:24:40,320 --> 00:24:42,320
you just use it register

658
00:24:42,320 --> 00:24:44,000
and then bam you're gonna start seeing

659
00:24:44,000 --> 00:24:46,640
events from uh

660
00:24:46,640 --> 00:24:48,960
from that device or from that vendor and

661
00:24:48,960 --> 00:24:51,600
those events include this device id

662
00:24:51,600 --> 00:24:54,159
uh in in most cloud implementations in

663
00:24:54,159 --> 00:24:57,200
iot by the way that cloud id that device

664
00:24:57,200 --> 00:24:59,679
id is the only form of authentication if

665
00:24:59,679 --> 00:25:01,760
you have access to that device id

666
00:25:01,760 --> 00:25:03,520
effectively from that point onwards you

667
00:25:03,520 --> 00:25:05,360
can interact with the device without

668
00:25:05,360 --> 00:25:07,120
having to use any other username and

669
00:25:07,120 --> 00:25:08,480
password

670
00:25:08,480 --> 00:25:10,799
and this this counts for a lot of

671
00:25:10,799 --> 00:25:12,400
implementation of the implementation

672
00:25:12,400 --> 00:25:14,960
that we've seen so far so if you manage

673
00:25:14,960 --> 00:25:16,880
to get that particular information the

674
00:25:16,880 --> 00:25:19,039
device id

675
00:25:19,039 --> 00:25:20,640
it's usually not predictable but for

676
00:25:20,640 --> 00:25:22,400
example with an exploit like the mqtt

677
00:25:22,400 --> 00:25:25,919
leak you can just get access to it

678
00:25:26,880 --> 00:25:28,240
the second thing that we wanted to do is

679
00:25:28,240 --> 00:25:31,279
getting video feeds through um

680
00:25:31,279 --> 00:25:32,880
rstps

681
00:25:32,880 --> 00:25:36,320
so rstp is that that protocol uh that

682
00:25:36,320 --> 00:25:38,640
enables you to you know that facilitates

683
00:25:38,640 --> 00:25:41,039
video streaming rstps is a secure

684
00:25:41,039 --> 00:25:42,480
implementation of that

685
00:25:42,480 --> 00:25:44,960
we notice that in

686
00:25:44,960 --> 00:25:46,240
normal

687
00:25:46,240 --> 00:25:48,880
behavior the camera says i'm upload i'm

688
00:25:48,880 --> 00:25:53,120
uploading my feed to this web location

689
00:25:53,120 --> 00:25:54,480
and then the cloud is going to tell the

690
00:25:54,480 --> 00:25:56,640
mobile app hey you can see the video of

691
00:25:56,640 --> 00:25:58,480
it at this location

692
00:25:58,480 --> 00:26:00,400
and this is how your mobile app is able

693
00:26:00,400 --> 00:26:02,799
to access the video feed of the baby

694
00:26:02,799 --> 00:26:03,840
monitor

695
00:26:03,840 --> 00:26:05,520
however what we discover is that the

696
00:26:05,520 --> 00:26:09,600
mqtt implementation supported a

697
00:26:09,600 --> 00:26:10,400
command

698
00:26:10,400 --> 00:26:12,320
named command

699
00:26:12,320 --> 00:26:15,120
so if you tell slash device slash device

700
00:26:15,120 --> 00:26:16,080
id

701
00:26:16,080 --> 00:26:18,640
slash cmd

702
00:26:18,640 --> 00:26:20,880
you can tell it to change that upload

703
00:26:20,880 --> 00:26:23,679
location to a different location so

704
00:26:23,679 --> 00:26:25,360
essentially you connect to the mqtt

705
00:26:25,360 --> 00:26:27,440
server and you tell a device somebody

706
00:26:27,440 --> 00:26:29,200
else's device

707
00:26:29,200 --> 00:26:31,200
start uploading your video feed to my

708
00:26:31,200 --> 00:26:33,360
location

709
00:26:33,360 --> 00:26:34,799
and

710
00:26:34,799 --> 00:26:38,440
this is how it looks

711
00:26:40,480 --> 00:26:44,240
we set up initially a listener

712
00:26:44,240 --> 00:26:46,640
and then we tell musk we tell the mqtt

713
00:26:46,640 --> 00:26:48,080
stream to

714
00:26:48,080 --> 00:26:50,559
and let me pause it

715
00:26:50,559 --> 00:26:52,960
to send the rstp stream to our rogue

716
00:26:52,960 --> 00:26:56,400
server in our case it's 1001 uh slash

717
00:26:56,400 --> 00:26:58,799
media

718
00:26:58,880 --> 00:27:01,440
and we're gonna we see client connected

719
00:27:01,440 --> 00:27:03,600
and we start getting a video feed so

720
00:27:03,600 --> 00:27:05,039
what we're gonna do with this we're just

721
00:27:05,039 --> 00:27:09,120
going to pipe it to vlc

722
00:27:14,720 --> 00:27:16,720
and this is the other http hijack so

723
00:27:16,720 --> 00:27:19,279
what what we learned here is that that

724
00:27:19,279 --> 00:27:21,520
mqtt was actually the initial problem

725
00:27:21,520 --> 00:27:23,520
the fact that the device ids were

726
00:27:23,520 --> 00:27:25,919
exposed and the fact that it had that

727
00:27:25,919 --> 00:27:27,760
additional feature called cmd which

728
00:27:27,760 --> 00:27:30,480
enabled us anybody to change the

729
00:27:30,480 --> 00:27:32,559
location of the video stream it wasn't

730
00:27:32,559 --> 00:27:34,960
necessary it wasn't needed it was just

731
00:27:34,960 --> 00:27:36,399
there and probably they forgot to take

732
00:27:36,399 --> 00:27:38,559
it out

733
00:27:38,559 --> 00:27:41,120
and there's a buffer overflow

734
00:27:41,120 --> 00:27:42,080
uh

735
00:27:42,080 --> 00:27:45,120
in in the power outlet sorry in the in

736
00:27:45,120 --> 00:27:46,960
the baby monitor

737
00:27:46,960 --> 00:27:49,360
which we also are going to explode uh

738
00:27:49,360 --> 00:27:51,520
through mqtt it just gives us the

739
00:27:51,520 --> 00:27:53,919
possibility to give it input and that

740
00:27:53,919 --> 00:27:55,840
url change uh

741
00:27:55,840 --> 00:27:58,000
command that we sent earlier

742
00:27:58,000 --> 00:28:00,000
the particular code that parses that new

743
00:28:00,000 --> 00:28:01,919
url is also

744
00:28:01,919 --> 00:28:03,760
vulnerable to a stack based buffer

745
00:28:03,760 --> 00:28:06,320
overflow

746
00:28:08,960 --> 00:28:11,120
rc

747
00:28:11,120 --> 00:28:14,080
so we're setting up a listener

748
00:28:14,080 --> 00:28:16,880
and we're creating the payload

749
00:28:16,880 --> 00:28:19,600
the payload is going to be essentially

750
00:28:19,600 --> 00:28:21,039
net cut

751
00:28:21,039 --> 00:28:23,919
with a shell to our attacker ip address

752
00:28:23,919 --> 00:28:25,679
and of course the buffer overflow

753
00:28:25,679 --> 00:28:28,679
payload

754
00:28:35,679 --> 00:28:38,399
and we got a shell on the

755
00:28:38,399 --> 00:28:41,600
on the on the baby monitor so again as

756
00:28:41,600 --> 00:28:42,799
you can see this whole thing is

757
00:28:42,799 --> 00:28:45,440
completely remote completely without any

758
00:28:45,440 --> 00:28:47,440
form of authentication

759
00:28:47,440 --> 00:28:50,240
you can do it behind four firewalls just

760
00:28:50,240 --> 00:28:52,960
by having a vps with publicly accessible

761
00:28:52,960 --> 00:28:56,320
vps that can get a connect back shell

762
00:28:56,320 --> 00:28:57,440
so

763
00:28:57,440 --> 00:28:59,279
as end nodes cloud related attacks

764
00:28:59,279 --> 00:29:01,440
against iots will bypass any counter

765
00:29:01,440 --> 00:29:03,360
measures they're very difficult to to

766
00:29:03,360 --> 00:29:04,240
block

767
00:29:04,240 --> 00:29:06,559
because the communication is encrypted

768
00:29:06,559 --> 00:29:08,159
usually smart devices will talk

769
00:29:08,159 --> 00:29:09,840
encrypted with their cloud the

770
00:29:09,840 --> 00:29:11,760
communication looks legitimate because

771
00:29:11,760 --> 00:29:14,320
it's a communication with the cloud the

772
00:29:14,320 --> 00:29:15,840
only thing that's going to kind of fall

773
00:29:15,840 --> 00:29:18,000
out of place is that connect back shell

774
00:29:18,000 --> 00:29:19,360
that you get

775
00:29:19,360 --> 00:29:21,039
but you may want to run other commands

776
00:29:21,039 --> 00:29:22,799
you may want to drop

777
00:29:22,799 --> 00:29:24,080
an apt

778
00:29:24,080 --> 00:29:27,360
that just periodically checks with the

779
00:29:27,360 --> 00:29:29,520
with the command control server that's

780
00:29:29,520 --> 00:29:31,120
and snoops on the internal

781
00:29:31,120 --> 00:29:33,679
infrastructure and so on and so forth

782
00:29:33,679 --> 00:29:34,880
so

783
00:29:34,880 --> 00:29:36,799
you cannot do the packet inspection and

784
00:29:36,799 --> 00:29:38,320
decrypt the traffic because you usually

785
00:29:38,320 --> 00:29:39,760
cannot drop

786
00:29:39,760 --> 00:29:42,240
your own certificate authority to to

787
00:29:42,240 --> 00:29:44,799
decrypt the traffic

788
00:29:44,799 --> 00:29:47,039
so

789
00:29:47,200 --> 00:29:49,600
i strongly advise that any smart device

790
00:29:49,600 --> 00:29:51,919
that you get that's not from a reputable

791
00:29:51,919 --> 00:29:54,960
brand as i was saying august were great

792
00:29:54,960 --> 00:29:57,440
they patched their stuff instantly we

793
00:29:57,440 --> 00:29:59,840
have we allocated a cv they were okay

794
00:29:59,840 --> 00:30:02,159
with that we just had a small struggle

795
00:30:02,159 --> 00:30:04,240
in negotiating the cvss score they

796
00:30:04,240 --> 00:30:06,559
didn't agree with us initially

797
00:30:06,559 --> 00:30:08,640
but they replied instantly and they had

798
00:30:08,640 --> 00:30:10,399
this very well

799
00:30:10,399 --> 00:30:11,520
uh

800
00:30:11,520 --> 00:30:14,159
you know handle on things they it it

801
00:30:14,159 --> 00:30:15,440
showed that they have the experience to

802
00:30:15,440 --> 00:30:17,440
handle this the same thing with ring

803
00:30:17,440 --> 00:30:19,600
doorbell and anything that we found from

804
00:30:19,600 --> 00:30:21,760
a high-profile company

805
00:30:21,760 --> 00:30:23,520
the moment the device started to become

806
00:30:23,520 --> 00:30:25,360
cheaper so to speak

807
00:30:25,360 --> 00:30:27,840
that that was when the companies don't

808
00:30:27,840 --> 00:30:29,520
reply to the emails they just sent us to

809
00:30:29,520 --> 00:30:32,240
the support department in one case

810
00:30:32,240 --> 00:30:34,480
a company wanted to offer us a discount

811
00:30:34,480 --> 00:30:36,480
for their products they said we are we

812
00:30:36,480 --> 00:30:38,159
are sorry that you are unhappy with our

813
00:30:38,159 --> 00:30:41,520
product we can offer you a 50 discount

814
00:30:41,520 --> 00:30:43,440
guys you don't get it that's not why we

815
00:30:43,440 --> 00:30:45,279
call we don't care about buying your

816
00:30:45,279 --> 00:30:47,919
products we already have it so

817
00:30:47,919 --> 00:30:48,960
uh

818
00:30:48,960 --> 00:30:50,880
military grade encryption provides zero

819
00:30:50,880 --> 00:30:52,559
security against most common attacks

820
00:30:52,559 --> 00:30:55,200
today i just wanted to say this

821
00:30:55,200 --> 00:30:56,080
and

822
00:30:56,080 --> 00:30:58,480
a tricky thing about smart device

823
00:30:58,480 --> 00:31:00,880
vulnerabilities that does not track the

824
00:31:00,880 --> 00:31:03,840
way we're used to in software so

825
00:31:03,840 --> 00:31:06,320
when you have a vulnerability an apache

826
00:31:06,320 --> 00:31:08,320
or a vulnerability in in an unpacked

827
00:31:08,320 --> 00:31:10,720
like winrar or our

828
00:31:10,720 --> 00:31:13,600
labs or a vulnerability in some parser

829
00:31:13,600 --> 00:31:16,559
or in some libraries like image magic

830
00:31:16,559 --> 00:31:18,240
these are tracked by cve so you can

831
00:31:18,240 --> 00:31:19,679
reference them you can use them they're

832
00:31:19,679 --> 00:31:22,480
documented in in smart device world it's

833
00:31:22,480 --> 00:31:24,240
very rarely the case we started

834
00:31:24,240 --> 00:31:27,039
allocating cves for some vulnerabilities

835
00:31:27,039 --> 00:31:30,000
so there's no centralized inventory of

836
00:31:30,000 --> 00:31:32,000
vulnerabilities for iot which

837
00:31:32,000 --> 00:31:34,000
essentially means

838
00:31:34,000 --> 00:31:37,200
that only a fraction of the published

839
00:31:37,200 --> 00:31:39,679
vulnerabilities are known

840
00:31:39,679 --> 00:31:41,600
because some guy publishes a narrative

841
00:31:41,600 --> 00:31:44,080
vulnerability on their blog in some in

842
00:31:44,080 --> 00:31:46,080
some place and some guy publishes on

843
00:31:46,080 --> 00:31:48,080
another blog in some other place but

844
00:31:48,080 --> 00:31:50,640
they're not aggregated at mitre for

845
00:31:50,640 --> 00:31:54,159
example so you have on on the one hand

846
00:31:54,159 --> 00:31:56,559
we only published a fraction of the

847
00:31:56,559 --> 00:31:58,159
papers that we have

848
00:31:58,159 --> 00:31:59,279
because

849
00:31:59,279 --> 00:32:01,760
a defender didn't reply and out of those

850
00:32:01,760 --> 00:32:04,320
papers the visibility that they got was

851
00:32:04,320 --> 00:32:05,760
also limited because they're not

852
00:32:05,760 --> 00:32:07,279
centralized in a

853
00:32:07,279 --> 00:32:11,039
centralized vulnerability repository

854
00:32:13,360 --> 00:32:14,880
and that's about it

855
00:32:14,880 --> 00:32:17,279
thank you alex i was thinking a lot

856
00:32:17,279 --> 00:32:20,080
about what you said and both what uh

857
00:32:20,080 --> 00:32:22,640
lucas said earlier um and i was

858
00:32:22,640 --> 00:32:24,240
wondering whether

859
00:32:24,240 --> 00:32:25,840
you think that there could be some

860
00:32:25,840 --> 00:32:29,279
policy changes that could be enforced in

861
00:32:29,279 --> 00:32:31,840
order for these vendors to listen to you

862
00:32:31,840 --> 00:32:32,960
guys

863
00:32:32,960 --> 00:32:35,360
do you think this could help

864
00:32:35,360 --> 00:32:38,080
i mean i know it's gonna sound

865
00:32:38,080 --> 00:32:41,279
tough but i would make it a requirement

866
00:32:41,279 --> 00:32:43,039
to operate

867
00:32:43,039 --> 00:32:45,120
i would make having a communication

868
00:32:45,120 --> 00:32:46,799
channel with security researchers i

869
00:32:46,799 --> 00:32:48,640
would definitely make it a mandatory

870
00:32:48,640 --> 00:32:50,960
requirement to be able to operate having

871
00:32:50,960 --> 00:32:53,120
that security contact and making sure

872
00:32:53,120 --> 00:32:55,519
that you manage 24 7

873
00:32:55,519 --> 00:32:57,279
because you have a responsibility to

874
00:32:57,279 --> 00:32:59,120
your users and you have a responsibility

875
00:32:59,120 --> 00:33:01,120
to dress up the world let's not forget

876
00:33:01,120 --> 00:33:03,760
that the mirai botnet because of some

877
00:33:03,760 --> 00:33:06,640
telnet open with root and one two three

878
00:33:06,640 --> 00:33:08,320
four s password

879
00:33:08,320 --> 00:33:10,000
or some hard coded password in the

880
00:33:10,000 --> 00:33:13,120
firmware that that was reusable across

881
00:33:13,120 --> 00:33:15,519
hundreds of thousands of devices

882
00:33:15,519 --> 00:33:17,440
caused an attack that amounted to about

883
00:33:17,440 --> 00:33:20,640
650 gigabits per second

884
00:33:20,640 --> 00:33:23,120
so yeah there's this

885
00:33:23,120 --> 00:33:25,120
responsibility that that companies need

886
00:33:25,120 --> 00:33:27,760
to have you have for example a user base

887
00:33:27,760 --> 00:33:29,840
you have a few hundred thousand users

888
00:33:29,840 --> 00:33:31,919
and then somebody finds that that

889
00:33:31,919 --> 00:33:33,600
there's a sql injection that enables

890
00:33:33,600 --> 00:33:35,600
them to kind of pull all the data out of

891
00:33:35,600 --> 00:33:37,440
that database and then they try

892
00:33:37,440 --> 00:33:38,880
contacting and there's no security

893
00:33:38,880 --> 00:33:40,720
contact that's a big deal that the

894
00:33:40,720 --> 00:33:43,120
privacy of the data of those users

895
00:33:43,120 --> 00:33:45,440
is important and it should be

896
00:33:45,440 --> 00:33:46,960
nobody expects you to have perfect

897
00:33:46,960 --> 00:33:48,960
security we don't i mean this is why

898
00:33:48,960 --> 00:33:50,880
we're running the bug bounty program to

899
00:33:50,880 --> 00:33:52,320
have access to all the potential

900
00:33:52,320 --> 00:33:54,000
vulnerabilities that we may have

901
00:33:54,000 --> 00:33:56,080
unfortunately there's only a handful of

902
00:33:56,080 --> 00:33:58,240
companies that do the same thing

903
00:33:58,240 --> 00:33:59,919
so yeah i would make it mandatory to

904
00:33:59,919 --> 00:34:02,320
have a security contact

905
00:34:02,320 --> 00:34:07,000
for being able to operate customer data

906
00:34:07,679 --> 00:34:09,280
and do you think that

907
00:34:09,280 --> 00:34:11,040
perhaps um

908
00:34:11,040 --> 00:34:12,879
international bodies should have

909
00:34:12,879 --> 00:34:15,599
something to say about it such as the eu

910
00:34:15,599 --> 00:34:18,079
or where where do you see um these

911
00:34:18,079 --> 00:34:19,359
changes

912
00:34:19,359 --> 00:34:20,719
well yeah

913
00:34:20,719 --> 00:34:22,159
unfortunately

914
00:34:22,159 --> 00:34:25,918
even ethical hacking is outlawed in most

915
00:34:25,918 --> 00:34:27,918
countries you know

916
00:34:27,918 --> 00:34:30,320
so this effectively gives an edge to the

917
00:34:30,320 --> 00:34:31,760
bad guys because they don't care about

918
00:34:31,760 --> 00:34:33,280
the laws they're just going to switch to

919
00:34:33,280 --> 00:34:35,199
some territory that where nobody can

920
00:34:35,199 --> 00:34:36,960
touch them and just you know

921
00:34:36,960 --> 00:34:38,399
have at it

922
00:34:38,399 --> 00:34:40,800
so i would i would definitely see some

923
00:34:40,800 --> 00:34:42,480
legislature being changed towards

924
00:34:42,480 --> 00:34:43,839
facilitating

925
00:34:43,839 --> 00:34:45,679
grounds for ethical hackers to be able

926
00:34:45,679 --> 00:34:47,839
to you know tamper with critical

927
00:34:47,839 --> 00:34:49,599
infrastructure for example

928
00:34:49,599 --> 00:34:52,159
i'm afraid to look at the critical

929
00:34:52,159 --> 00:34:54,000
infrastructure in romania

930
00:34:54,000 --> 00:34:56,000
because of the law you know the law says

931
00:34:56,000 --> 00:34:57,119
that you're not allowed to do that

932
00:34:57,119 --> 00:34:59,119
however some other guy from another

933
00:34:59,119 --> 00:35:00,960
country is not afraid to do that and

934
00:35:00,960 --> 00:35:02,560
they may find something that i could

935
00:35:02,560 --> 00:35:04,640
have found earlier early on and tell

936
00:35:04,640 --> 00:35:06,480
them about it and i could have fixed it

937
00:35:06,480 --> 00:35:08,480
so yeah i would want to see legislature

938
00:35:08,480 --> 00:35:10,079
kind of facilitating more things for

939
00:35:10,079 --> 00:35:11,680
ethical hackers

940
00:35:11,680 --> 00:35:12,720
and

941
00:35:12,720 --> 00:35:15,280
compelling companies to have a security

942
00:35:15,280 --> 00:35:17,839
contact

943
00:35:17,920 --> 00:35:19,680
so this in this presentation you

944
00:35:19,680 --> 00:35:22,720
basically looked at the last five years

945
00:35:22,720 --> 00:35:25,599
of your work yeah do you think that if

946
00:35:25,599 --> 00:35:26,640
we meet

947
00:35:26,640 --> 00:35:28,720
five years from now

948
00:35:28,720 --> 00:35:30,720
things are going to be different or

949
00:35:30,720 --> 00:35:34,800
we're going to be stuck in this paradigm

950
00:35:34,800 --> 00:35:36,720
you see

951
00:35:36,720 --> 00:35:38,160
many people

952
00:35:38,160 --> 00:35:40,480
are against monopolies

953
00:35:40,480 --> 00:35:41,520
um

954
00:35:41,520 --> 00:35:43,599
for many reasons and the reason i'm

955
00:35:43,599 --> 00:35:45,599
bringing this up is that

956
00:35:45,599 --> 00:35:47,280
one of the problems with iot is

957
00:35:47,280 --> 00:35:49,520
diversity

958
00:35:49,520 --> 00:35:51,520
there's such a big diversity of devices

959
00:35:51,520 --> 00:35:53,280
there's such a big diversity of cloud

960
00:35:53,280 --> 00:35:56,079
implementations there's such a

961
00:35:56,079 --> 00:35:58,720
plethora of companies that provide cloud

962
00:35:58,720 --> 00:36:02,640
support for iot iot platform uh firmware

963
00:36:02,640 --> 00:36:05,359
that's oem for iot and because they're

964
00:36:05,359 --> 00:36:07,280
such a big diversity and not that not

965
00:36:07,280 --> 00:36:09,359
not those many golden standards

966
00:36:09,359 --> 00:36:11,280
and even if they work for the standards

967
00:36:11,280 --> 00:36:12,800
many of these companies don't follow

968
00:36:12,800 --> 00:36:14,640
them then this is going to be an open

969
00:36:14,640 --> 00:36:17,680
case forever

970
00:36:20,000 --> 00:36:21,760
i think you're a mute

971
00:36:21,760 --> 00:36:23,839
yeah hopefully things are going to

972
00:36:23,839 --> 00:36:26,400
change for the better allow me to be an

973
00:36:26,400 --> 00:36:28,960
optimist right now because um everyone

974
00:36:28,960 --> 00:36:31,040
is going through a lot and we don't want

975
00:36:31,040 --> 00:36:33,280
to um

976
00:36:33,280 --> 00:36:35,200
say depressing things at the end of a

977
00:36:35,200 --> 00:36:37,040
depressing presentation

978
00:36:37,040 --> 00:36:39,599
i mean let me let me let me tell you

979
00:36:39,599 --> 00:36:42,000
something else if they let us if they

980
00:36:42,000 --> 00:36:44,320
let us find those vulnerabilities and

981
00:36:44,320 --> 00:36:46,000
they patch them then things are

982
00:36:46,000 --> 00:36:48,000
definitely going to be better this is

983
00:36:48,000 --> 00:36:50,320
the way it works everywhere else you

984
00:36:50,320 --> 00:36:52,320
know um

985
00:36:52,320 --> 00:36:54,880
our infrastructure in our company and

986
00:36:54,880 --> 00:36:57,200
our products are definitely better

987
00:36:57,200 --> 00:36:59,359
because of the contributions

988
00:36:59,359 --> 00:37:00,880
the valuable contribution of security

989
00:37:00,880 --> 00:37:03,119
researchers and we once again thank them

990
00:37:03,119 --> 00:37:06,240
for that all all the companies all the

991
00:37:06,240 --> 00:37:08,480
legislature need to do is facilitate

992
00:37:08,480 --> 00:37:11,440
us with the you know the legislature to

993
00:37:11,440 --> 00:37:13,280
allow us to hack

994
00:37:13,280 --> 00:37:15,599
white uh to do ethical hacking and if

995
00:37:15,599 --> 00:37:17,520
that happens then things are gonna be

996
00:37:17,520 --> 00:37:19,440
substantially better because we're going

997
00:37:19,440 --> 00:37:23,839
to force everybody to patch their stuff

998
00:37:24,079 --> 00:37:25,680
yeah

999
00:37:25,680 --> 00:37:28,960
thank you so much

