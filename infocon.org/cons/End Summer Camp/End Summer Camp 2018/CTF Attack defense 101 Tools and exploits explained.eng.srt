1
00:00:00,000 --> 00:00:02,280
i am niccolò i am here with simone today

2
00:00:02,280 --> 00:00:04,410
we will talk to you about the ctf attack and defense

3
00:00:04,410 --> 00:00:06,450
first of all some of you have already

4
00:00:06,450 --> 00:00:10,469
heard about it on your hands because

5
00:00:10,469 --> 00:00:14,190
some of you have already taken part in it ok

6
00:00:14,190 --> 00:00:17,250
then first let's talk about the first

7
00:00:17,250 --> 00:00:18,480
problem we had with this

8
00:00:18,480 --> 00:00:20,789
presentation  which was to

9
00:00:20,789 --> 00:00:22,380
find a title because they

10
00:00:22,380 --> 00:00:28,199
all seemed too trivial so

11
00:00:28,199 --> 00:00:31,439
we were undecided between a

12
00:00:31,439 --> 00:00:34,170
serious title and a title a little more click bait and

13
00:00:34,170 --> 00:00:36,630
among the titles that could be proposed there were these

14
00:00:36,630 --> 00:00:39,469
that you can see some are very

15
00:00:39,469 --> 00:00:42,899
humorous but perhaps all have  a

16
00:00:42,899 --> 00:00:45,239
reality below in my opinion some of these

17
00:00:45,239 --> 00:00:46,739
are for example the connection between

18
00:00:46,739 --> 00:00:50,610
city is made defense in sex that then

19
00:00:50,610 --> 00:00:52,379
this is the ca foscari team

20
00:00:52,379 --> 00:00:54,449
that took part in a competition that took place

21
00:00:54,449 --> 00:00:56,100
here in italy between the various

22
00:00:56,100 --> 00:00:59,850
universities is called  cyber challenge the

23
00:00:59,850 --> 00:01:02,910
final competition of this project

24
00:01:02,910 --> 00:01:04,979
was a ctf attack defense held in

25
00:01:04,979 --> 00:01:08,070
rome with the best four people of

26
00:01:08,070 --> 00:01:12,320
each a  Italian university eight universities

27
00:01:12,320 --> 00:01:17,150
then this is us during the ctf

28
00:01:17,150 --> 00:01:19,830
the space was very little what you

29
00:01:19,830 --> 00:01:22,140
can see behind in a ranking and

30
00:01:22,140 --> 00:01:26,280
we are there intent on playing it is

31
00:01:26,280 --> 00:01:28,680
however not too obvious it is

32
00:01:28,680 --> 00:01:30,840
what these ctf attack and defense are

33
00:01:30,840 --> 00:01:32,939
I remember the  first time I

34
00:01:32,939 --> 00:01:36,090
heard about them from Marco among other things and

35
00:01:36,090 --> 00:01:37,650
after half an hour that he was talking about them I

36
00:01:37,650 --> 00:01:39,270
still had to understand what they were because

37
00:01:39,270 --> 00:01:41,610
I had never heard but in the midst of

38
00:01:41,610 --> 00:01:44,700
people you meet and no it means that they are

39
00:01:44,700 --> 00:01:46,530
only taken for granted  that in short it

40
00:01:46,530 --> 00:01:48,659
seemed that everyone was behind everyone

41
00:01:48,659 --> 00:01:51,299
said I participate in these ctf jobs

42
00:01:51,299 --> 00:01:53,939
after a while I understood what they were then

43
00:01:53,939 --> 00:01:55,549
first of all there are two types of ctf

44
00:01:55,549 --> 00:01:58,170
the most traditional and easy to

45
00:01:58,170 --> 00:01:59,850
organize probably which are the geo

46
00:01:59,850 --> 00:02:02,610
pardi which consist of a set of

47
00:02:02,610 --> 00:02:04,140
problems  to solve

48
00:02:04,140 --> 00:02:06,030
the group or individual depends on the ct

49
00:02:06,030 --> 00:02:08,128
f and then the defense attacks which as they

50
00:02:08,128 --> 00:02:09,110
can

51
00:02:09,110 --> 00:02:12,400
show for man estimates are much more

52
00:02:12,400 --> 00:02:15,440
compelling, difficult and totally

53
00:02:15,440 --> 00:02:18,170
different that consist of

54
00:02:18,170 --> 00:02:19,730
something else from simply solving

55
00:02:19,730 --> 00:02:22,280
problems practically the

56
00:02:22,280 --> 00:02:24,110
general architecture is this there is a central check system

57
00:02:24,110 --> 00:02:26,270
this we can see it as a

58
00:02:26,270 --> 00:02:28,850
server and the different teams each team

59
00:02:28,850 --> 00:02:30,650
their laptops and their own

60
00:02:30,650 --> 00:02:33,650
virtual machine generally the machines  virtual

61
00:02:33,650 --> 00:02:36,860
and follow different services we can

62
00:02:36,860 --> 00:02:39,160
see them as websites or

63
00:02:39,160 --> 00:02:41,540
services that control

64
00:02:41,540 --> 00:02:44,090
nuclear power plants or things of this type

65
00:02:44,090 --> 00:02:47,000
the thing that unites all the services that

66
00:02:47,000 --> 00:02:48,860
have vulnerabilities

67
00:02:48,860 --> 00:02:50,510
the services are set up by the

68
00:02:50,510 --> 00:02:53,330
organizers so the organizers

69
00:02:53,330 --> 00:02:57,050
in short put voluntarily sometimes

70
00:02:57,050 --> 00:02:58,370
unwillingly some  vulnerabilities

71
00:02:58,370 --> 00:03:01,250
in these services through these

72
00:03:01,250 --> 00:03:03,890
vulnerabilities the teams can steal

73
00:03:03,890 --> 00:03:06,709
secrets from each other here you can see that

74
00:03:06,709 --> 00:03:09,050
each team has ladybugs that

75
00:03:09,050 --> 00:03:11,720
represent bugs and flags

76
00:03:11,720 --> 00:03:13,700
that represent their secrets to

77
00:03:13,700 --> 00:03:16,010
protect it is just like

78
00:03:16,010 --> 00:03:17,750
the flag stealing game you have to steal the flags

79
00:03:17,750 --> 00:03:20,780
others to win p  To steal the

80
00:03:20,780 --> 00:03:21,860
flags of others, it is necessary to

81
00:03:21,860 --> 00:03:23,989
exploit vulnerabilities that are

82
00:03:23,989 --> 00:03:25,090
present in the site

83
00:03:25,090 --> 00:03:27,560
then in the bosom of the service site

84
00:03:27,560 --> 00:03:33,860
more generally here it seems an easy thing

85
00:03:33,860 --> 00:03:38,090
but it is really a mess because you

86
00:03:38,090 --> 00:03:40,070
find yourself with vulnerable services but

87
00:03:40,070 --> 00:03:41,840
you do not know the vulnerabilities present

88
00:03:41,840 --> 00:03:44,209
but  you know that the other teams

89
00:03:44,209 --> 00:03:46,790
are exploiting them in some way and the

90
00:03:46,790 --> 00:03:49,100
stressful situation that occurs is

91
00:03:49,100 --> 00:03:51,530
really an impressive thing because

92
00:03:51,530 --> 00:03:54,590
in short you are under attack but you do not know

93
00:03:54,590 --> 00:03:56,020
how to defend yourself

94
00:03:56,020 --> 00:03:57,790
the pressure increases there are all who

95
00:03:57,790 --> 00:04:00,040
ask you for things and therefore this

96
00:04:00,040 --> 00:04:03,760
really represents  well during a ctf

97
00:04:03,760 --> 00:04:05,590
attack defense the situation there are the

98
00:04:05,590 --> 00:04:06,880
organizers who are there all

99
00:04:06,880 --> 00:04:08,530
quiet who sometimes

100
00:04:08,530 --> 00:04:10,060
even laugh because they can see

101
00:04:10,060 --> 00:04:11,830
everyone's traffic and see our

102
00:04:11,830 --> 00:04:13,810
explorers what they do and maybe the mistakes

103
00:04:13,810 --> 00:04:16,000
they have and we who are there  inside that

104
00:04:16,000 --> 00:04:17,980
we try to go out that we try to

105
00:04:17,980 --> 00:04:19,290
put out the fire

106
00:04:19,290 --> 00:04:23,320
here is the score in these types of ctf

107
00:04:23,320 --> 00:04:26,290
depends d  to various aspects mainly

108
00:04:26,290 --> 00:04:29,170
the main thing is precisely the mobility

109
00:04:29,170 --> 00:04:31,150
of the service that is if the service is up

110
00:04:31,150 --> 00:04:32,170
down

111
00:04:32,170 --> 00:04:34,720
if the service is down you really lose a

112
00:04:34,720 --> 00:04:36,610
lot of service points down it is like saying

113
00:04:36,610 --> 00:04:40,210
that you go to wikipedia it is here from 4 0 4

114
00:04:40,210 --> 00:04:42,700
that there is no  nothing and this determines a

115
00:04:42,700 --> 00:04:46,780
lot then two other

116
00:04:46,780 --> 00:04:49,090
determining factors are the stolen flags that is

117
00:04:49,090 --> 00:04:50,860
these secrets these flags that

118
00:04:50,860 --> 00:04:53,650
have the different services and the flags that

119
00:04:53,650 --> 00:04:56,440
have been stolen from the team you are

120
00:04:56,440 --> 00:04:57,480
part of

121
00:04:57,480 --> 00:05:01,840
here is when the ctf starts and after the

122
00:05:01,840 --> 00:05:04,210
changes that have been  made some

123
00:05:04,210 --> 00:05:06,280
service and down the situation in a more

124
00:05:06,280 --> 00:05:07,810
dramatic way than that represented by

125
00:05:07,810 --> 00:05:10,420
this mehman because you really don't know

126
00:05:10,420 --> 00:05:12,430
what to do because usually the first hour

127
00:05:12,430 --> 00:05:14,810
of friends tf is used

128
00:05:14,810 --> 00:05:16,090
[Music]

129
00:05:16,090 --> 00:05:18,820
a maintenance without the

130
00:05:18,820 --> 00:05:21,400
virtual machine being connected with other machines

131
00:05:21,400 --> 00:05:23,260
and then you make changes of all

132
00:05:23,260 --> 00:05:25,570
kinds you try to fix bugs that

133
00:05:25,570 --> 00:05:28,570
are assumed to be such and sometimes it happens

134
00:05:28,570 --> 00:05:30,370
as it happened to us to fix them

135
00:05:30,370 --> 00:05:31,810
in the sba way  gliato and in such a way as to

136
00:05:31,810 --> 00:05:33,699
throw down the whole service but it happens

137
00:05:33,699 --> 00:05:35,500
in general to everyone it is very very

138
00:05:35,500 --> 00:05:39,040
simple ok now let's talk for a moment about the

139
00:05:39,040 --> 00:05:40,810
tools that are used for this type

140
00:05:40,810 --> 00:05:43,150
of competitions especially the tours

141
00:05:43,150 --> 00:05:46,120
that we created ad hoc to

142
00:05:46,120 --> 00:05:48,070
be able to survive in that

143
00:05:48,070 --> 00:05:51,910
jungle then let's repeat for a moment how

144
00:05:51,910 --> 00:05:53,979
the architecture we have the various teams

145
00:05:53,979 --> 00:05:56,380
each team once it finds a

146
00:05:56,380 --> 00:05:58,180
vulnerability on its services which

147
00:05:58,180 --> 00:06:01,600
are generally the same as all the teams tries

148
00:06:01,600 --> 00:06:04,210
to write a freud that is try to

149
00:06:04,210 --> 00:06:06,220
exploit it and through a script that

150
00:06:06,220 --> 00:06:09,490
automatically goes  do what you have to

151
00:06:09,490 --> 00:06:13,479
do and pull out the flag that to do

152
00:06:13,479 --> 00:06:15,010
this you need a program I do

153
00:06:15,010 --> 00:06:17,050
it automatically it is unthinkable once the

154
00:06:17,050 --> 00:06:19,150
team is 100 years old to put a

155
00:06:19,150 --> 00:06:22,030
person to execute exploro.it towards each

156
00:06:22,030 --> 00:06:24,820
ip and therefore what we have done

157
00:06:24,820 --> 00:06:26,740
which is generally done is to build an

158
00:06:26,740 --> 00:06:29,260
attack script in which

159
00:06:29,260 --> 00:06:31,990
all targets are specified executes the

160
00:06:31,990 --> 00:06:34,030
same ex fi of the same script in

161
00:06:34,030 --> 00:06:36,700
this case in  python to all the

162
00:06:36,700 --> 00:06:40,030
other rubale flags once stolen

163
00:06:40,030 --> 00:06:42,280
adds a database and yet another service

164
00:06:42,280 --> 00:06:45,050
the truck

165
00:06:45,050 --> 00:06:52,110
we can call it the submit to the server

166
00:06:52,110 --> 00:06:53,310
that from the score

167
00:06:53,310 --> 00:06:56,400
once the server receives the flag

168
00:06:56,400 --> 00:07:00,060
knows who it is ati adds score here

169
00:07:00,060 --> 00:07:02,120
we had some problems  with

170
00:07:02,120 --> 00:07:05,010
this he will attack at the beginning and this is

171
00:07:05,010 --> 00:07:07,290
an excellent image of me trying to

172
00:07:07,290 --> 00:07:10,100
solve problems during the ctf

173
00:07:10,100 --> 00:07:12,930
we move on to the second tool which is the

174
00:07:12,930 --> 00:07:14,520
main one that allowed us to

175
00:07:14,520 --> 00:07:17,580
reach third place in rome

176
00:07:17,580 --> 00:07:19,440
without this we would not be able to  do a

177
00:07:19,440 --> 00:07:21,900
lot that is called flowers

178
00:07:21,900 --> 00:07:24,900
it is a graphical interface in

179
00:07:24,900 --> 00:07:27,540
this football is the one shown with

180
00:07:27,540 --> 00:07:28,560
different functionalities below

181
00:07:28,560 --> 00:07:30,270
mainly to analyze the

182
00:07:30,270 --> 00:07:34,260
traffic and reconstruct the flows in

183
00:07:34,260 --> 00:07:36,990
such a way as to realize very quickly

184
00:07:36,990 --> 00:07:40,470
how the other teams attacked us and in

185
00:07:40,470 --> 00:07:43,260
turn steal  exploits

186
00:07:43,260 --> 00:07:45,090
very simply what happened

187
00:07:45,090 --> 00:07:48,030
once a team ran scripts against

188
00:07:48,030 --> 00:07:49,830
our machines no  i could analyze

189
00:07:49,830 --> 00:07:51,780
the traffic to see exactly the

190
00:07:51,780 --> 00:07:54,390
requests that were made and from these

191
00:07:54,390 --> 00:07:56,729
beautiful requests

192
00:07:56,729 --> 00:07:58,229
I don't know how the service works but

193
00:07:58,229 --> 00:08:00,060
I can replicate the same attack

194
00:08:00,060 --> 00:08:02,700
against others without really knowing anything about the

195
00:08:02,700 --> 00:08:05,910
service here in this small demo in

196
00:08:05,910 --> 00:08:08,040
this gif we can see a  right a

197
00:08:08,040 --> 00:08:10,680
flow in the center a list of

198
00:08:10,680 --> 00:08:12,960
selectable flows above there is the

199
00:08:12,960 --> 00:08:15,630
service selector which is served in this case e

200
00:08:15,630 --> 00:08:17,940
mail which was one of the many have a

201
00:08:17,940 --> 00:08:21,330
website you could set a flow as a

202
00:08:21,330 --> 00:08:23,640
favorite and on the right to see well the

203
00:08:23,640 --> 00:08:26,190
communications between  client server and there was

204
00:08:26,190 --> 00:08:27,480
also the

205
00:08:27,480 --> 00:08:31,560
ex function plus which showed things like this

206
00:08:31,560 --> 00:08:33,990
here so with binaries when you

207
00:08:33,990 --> 00:08:36,240
have non-printable characters it was very

208
00:08:36,240 --> 00:08:38,340
very handy and the flags were highlighted

209
00:08:38,340 --> 00:08:40,280
in red

210
00:08:40,280 --> 00:08:43,950
here is a very very trivial flow example

211
00:08:43,950 --> 00:08:48,360
if it had  with a service that

212
00:08:48,360 --> 00:08:50,340
offered an interface of this type

213
00:08:50,340 --> 00:08:52,500
as if it were a terminal interface it

214
00:08:52,500 --> 00:08:55,740
is trivial through in short

215
00:08:55,740 --> 00:08:56,970
via the network

216
00:08:56,970 --> 00:08:58,860
here  we can see just what

217
00:08:58,860 --> 00:09:02,040
server client says in this case I don't know

218
00:09:02,040 --> 00:09:03,660
if you can read but

219
00:09:03,660 --> 00:09:05,280
a question was asked which menu you want to

220
00:09:05,280 --> 00:09:06,450
enter etcetera etcetera

221
00:09:06,450 --> 00:09:09,480
and here you can see just

222
00:09:09,480 --> 00:09:12,180
the flag server undergoes which inserts

223
00:09:12,180 --> 00:09:15,389
a flag inside because the flags  they are

224
00:09:15,389 --> 00:09:17,550
inserted by the central server

225
00:09:17,550 --> 00:09:19,620
and then the others must steal in this

226
00:09:19,620 --> 00:09:21,720
case through this flow

227
00:09:21,720 --> 00:09:23,070
a flag is inserted that the sort

228
00:09:23,070 --> 00:09:26,699
highlighted in red instead a very

229
00:09:26,699 --> 00:09:28,860
simple http request like the

230
00:09:28,860 --> 00:09:30,600
one you can do to a site when you go

231
00:09:30,600 --> 00:09:32,370
to google on wikipedia any other

232
00:09:32,370 --> 00:09:34,560
site  it is seen in this way by flowers

233
00:09:34,560 --> 00:09:39,440
trivially there was also an html rendering

234
00:09:39,440 --> 00:09:42,839
probably it is vulnerable but we have

235
00:09:42,839 --> 00:09:45,720
done a lot of health the various self-books but

236
00:09:45,720 --> 00:09:49,199
in short surely vulnerable below

237
00:09:49,199 --> 00:09:52,230
as done flowers the front end is done

238
00:09:52,230 --> 00:09:56,100
with rec js we have the back end done with

239
00:09:56,100 --> 00:09:59,000
branches in  really minimal python that

240
00:09:59,000 --> 00:10:01,230
just puts the

241
00:10:01,230 --> 00:10:04,339
world of b into practically communication

242
00:10:04,339 --> 00:10:07,100
with the front end practically  then and

243
00:10:07,100 --> 00:10:09,699
we use limits to reconstruct the flows

244
00:10:09,699 --> 00:10:13,819
the strip teases ip and then racing to

245
00:10:13,819 --> 00:10:15,889
download the individual pick ups for those who do not

246
00:10:15,889 --> 00:10:18,589
know how to pick up the packets are the

247
00:10:18,589 --> 00:10:20,749
recordings of the network traffic and

248
00:10:20,749 --> 00:10:22,819
putting them inside the machine that runs

249
00:10:22,819 --> 00:10:25,699
flower was a bit of a choice

250
00:10:25,699 --> 00:10:27,379
risky to create this tool because

251
00:10:27,379 --> 00:10:29,959
essentially before starting it I

252
00:10:29,959 --> 00:10:31,819
had very little experience in

253
00:10:31,819 --> 00:10:34,819
python reakt and gs I had never used

254
00:10:34,819 --> 00:10:36,709
I had only used what is quite

255
00:10:36,709 --> 00:10:39,740
similar between scanu I had never used tcp

256
00:10:39,740 --> 00:10:41,689
dump either that is I had not used

257
00:10:41,689 --> 00:10:43,850
practically anything before starting and

258
00:10:43,850 --> 00:10:45,740
therefore I have  had to learn everything in two

259
00:10:45,740 --> 00:10:47,629
weeks because we had two

260
00:10:47,629 --> 00:10:50,360
weeks from when we knew we had

261
00:10:50,360 --> 00:10:52,309
gone through this final competition to

262
00:10:52,309 --> 00:10:54,170
when we actually did

263
00:10:54,170 --> 00:10:56,559
so our strategy after

264
00:10:56,559 --> 00:10:59,629
doing this tour was to wait for

265
00:10:59,629 --> 00:11:02,259
one of our strategies obviously we

266
00:11:02,259 --> 00:11:04,850
watched them state services  wait to

267
00:11:04,850 --> 00:11:08,449
receive attacks and make them turn

268
00:11:08,449 --> 00:11:10,939
against those who have them  tell yourself and it was

269
00:11:10,939 --> 00:11:13,370
a beautiful thing because the first

270
00:11:13,370 --> 00:11:16,759
time the first attack we have that

271
00:11:16,759 --> 00:11:19,670
we managed to really steal it

272
00:11:19,670 --> 00:11:20,870
was a service that we have

273
00:11:20,870 --> 00:11:24,800
not even opened and after having managed to

274
00:11:24,800 --> 00:11:27,259
steal the first explore we felt

275
00:11:27,259 --> 00:11:29,980
good or bad like this and I'm not  exaggerating

276
00:11:29,980 --> 00:11:31,759
during the eight hours of competition

277
00:11:31,759 --> 00:11:34,899
we managed to make 45 gb of data

278
00:11:34,899 --> 00:11:37,519
which is really a lot I had only

279
00:11:37,519 --> 00:11:39,679
five more laps in the disc after which

280
00:11:39,679 --> 00:11:42,110
we went out of bounds and now let's move on

281
00:11:42,110 --> 00:11:43,699
to the second part of this

282
00:11:43,699 --> 00:11:45,079
presentation in which we show an

283
00:11:45,079 --> 00:11:47,959
example of vulnerability  that is, several

284
00:11:47,959 --> 00:11:49,579
examples of vulnerabilities

285
00:11:49,579 --> 00:11:52,129
the first in particular was not in the

286
00:11:52,129 --> 00:11:53,800
final ctf but

287
00:11:53,800 --> 00:11:55,450
in the previous race which was a

288
00:11:55,450 --> 00:11:57,519
jeopardy ctf that is as we said before

289
00:11:57,519 --> 00:12:00,610
with different problems to be solved

290
00:12:00,610 --> 00:12:03,130
let's say or different sites with vulnerabilities to

291
00:12:03,130 --> 00:12:04,870
be exploited to reach a single

292
00:12:04,870 --> 00:12:08,800
final flag here in this  site there was

293
00:12:08,800 --> 00:12:10,750
a temptation based on the

294
00:12:10,750 --> 00:12:12,850
geographic location of the device

295
00:12:12,850 --> 00:12:15,850
now as you all know the bro  wser can

296
00:12:15,850 --> 00:12:17,529
access your position

297
00:12:17,529 --> 00:12:19,750
if you give it permission this site in

298
00:12:19,750 --> 00:12:21,400
particular

299
00:12:21,400 --> 00:12:23,830
took the position and gave only

300
00:12:23,830 --> 00:12:25,540
two types of answers

301
00:12:25,540 --> 00:12:27,940
you are too far from the point that you do not

302
00:12:27,940 --> 00:12:30,670
know what it is or 6n kilometers

303
00:12:30,670 --> 00:12:32,470
away from the target point

304
00:12:32,470 --> 00:12:35,110
here is this interface seen at the beginning

305
00:12:35,110 --> 00:12:36,670
what you can think that if we are in

306
00:12:36,670 --> 00:12:38,410
the target point we can

307
00:12:38,410 --> 00:12:41,380
actually enter like this was here is a

308
00:12:41,380 --> 00:12:43,870
trivial way to solve it and try

309
00:12:43,870 --> 00:12:45,640
all the points on earth however it was

310
00:12:45,640 --> 00:12:47,020
long enough even if what

311
00:12:47,020 --> 00:12:49,089
during the competition I did a

312
00:12:49,089 --> 00:12:51,040
clever way to solve it was to use

313
00:12:51,040 --> 00:12:52,930
the triangulation that is once we

314
00:12:52,930 --> 00:12:55,839
find three points and the distance between

315
00:12:55,839 --> 00:12:58,779
these three points and our target

316
00:12:58,779 --> 00:13:01,690
trivially the intersection between the three

317
00:13:01,690 --> 00:13:04,000
circles we see is the designated point

318
00:13:04,000 --> 00:13:06,190
and this was the let's say right way to

319
00:13:06,190 --> 00:13:08,220
solve it you can see how there was

320
00:13:08,220 --> 00:13:11,050
that  infinity underwater near the

321
00:13:11,050 --> 00:13:15,670
target is very strange and nice now I

322
00:13:15,670 --> 00:13:17,650
pass the word simone who speaks to you of

323
00:13:17,650 --> 00:13:20,200
another ser  vice that there was the

324
00:13:20,200 --> 00:13:23,050
final ctf attack defense in rome very very

325
00:13:23,050 --> 00:13:27,900
interesting yes the service you are

326
00:13:27,900 --> 00:13:31,660
talking about here I will talk about me and star

327
00:13:31,660 --> 00:13:32,170
cesar

328
00:13:32,170 --> 00:13:34,870
what is star chaser the best way I have

329
00:13:34,870 --> 00:13:38,560
found to describe this service is

330
00:13:38,560 --> 00:13:41,320
a starry night  because it was just

331
00:13:41,320 --> 00:13:44,560
this there was a sky where you can

332
00:13:44,560 --> 00:13:47,589
express your wishes

333
00:13:47,589 --> 00:13:50,140
you can put a title and a

334
00:13:50,140 --> 00:13:53,620
description the title is public there and

335
00:13:53,620 --> 00:13:56,920
the other is private i.e. you can only read it in theory

336
00:13:56,920 --> 00:13:57,970


337
00:13:57,970 --> 00:14:00,540


338
00:14:01,150 --> 00:14:05,529
ok let's move on to a couple of debugs  which

339
00:14:05,529 --> 00:14:08,200
were that there were in this service

340
00:14:08,200 --> 00:14:12,940
the first was a sql command which

341
00:14:12,940 --> 00:14:15,370
was basically sent from the client to the server

342
00:14:15,370 --> 00:14:19,930
and the server was executing so as you can

343
00:14:19,930 --> 00:14:22,600
see above which is sent and below

344
00:14:22,600 --> 00:14:26,410
which is executed this is not good

345
00:14:26,410 --> 00:14:28,480
because the client po person  can

346
00:14:28,480 --> 00:14:31,390
customize this this command and

347
00:14:31,390 --> 00:14:36,850
essentially download the

348
00:14:36,850 --> 00:14:38,890
descriptions of other users as well

349
00:14:38,890 --> 00:14:40,630
which it shouldn't do and

350
00:14:40,630 --> 00:14:43,209
that's where there were those flags that

351
00:14:43,209 --> 00:14:47,020
were needed to get  the score how to

352
00:14:47,020 --> 00:14:50,470
solve it if this is what he did

353
00:14:50,470 --> 00:14:52,329
before that is he took from the client and the

354
00:14:52,329 --> 00:14:54,550
command and executed it what

355
00:14:54,550 --> 00:14:55,690
we have to do is simply

356
00:14:55,690 --> 00:14:56,769
write

357
00:14:56,769 --> 00:15:00,009
directly to the server because there

358
00:15:00,009 --> 00:15:03,879
is no reason that

359
00:15:03,879 --> 00:15:09,399
another bug is different xss what it is  we write a

360
00:15:09,399 --> 00:15:13,119
command in javascript inside the

361
00:15:13,119 --> 00:15:14,980
forms and as we can see it is

362
00:15:14,980 --> 00:15:17,110
executed this is not good because we

363
00:15:17,110 --> 00:15:21,429
can put some code that the

364
00:15:21,429 --> 00:15:23,679
browser of other users will then execute nor

365
00:15:23,679 --> 00:15:26,049
can we in this way steal the

366
00:15:26,049 --> 00:15:28,540
information that just years years

367
00:15:28,540 --> 00:15:30,129
are needed in  detail of the flag that

368
00:15:30,129 --> 00:15:33,100
precisely make us take points

369
00:15:33,100 --> 00:15:36,790
how to solve a mitigation

370
00:15:36,790 --> 00:15:38,980
there is something that somehow

371
00:15:38,980 --> 00:15:41,679
limits or makes it more complicated to exploit

372
00:15:41,679 --> 00:15:44,559
this vulnerability is to set

373
00:15:44,559 --> 00:15:48,399
cookies in particular that of

374
00:15:48,399 --> 00:15:50,980
http oil session there is to make it into practice

375
00:15:50,980 --> 00:15:54,279
impossible to read it with the

376
00:15:54,279 --> 00:15:56,559
javascript call is a mitigation because in

377
00:15:56,559 --> 00:15:58,540
any case you can get around and get the

378
00:15:58,540 --> 00:16:00,610
flags and in some alt  ro way and the way

379
00:16:00,610 --> 00:16:03,699
in my opinion is simpler to solve

380
00:16:03,699 --> 00:16:09,629
this let you join an escape

381
00:16:09,629 --> 00:16:14,160
of the text that should display

382
00:16:14,160 --> 00:16:18,730
precisely it is the place of those characters

383
00:16:18,730 --> 00:16:25,839
of the html put more last

384
00:16:25,839 --> 00:16:28,199
what I liked most sincerely

385
00:16:28,199 --> 00:16:31,480
this do this example a command  and it

386
00:16:31,480 --> 00:16:33,759
puts as a password and it does it in

387
00:16:33,759 --> 00:16:36,999
a bit strange way to clear the password

388
00:16:36,999 --> 00:16:39,129
before putting it in the sql command that is

389
00:16:39,129 --> 00:16:42,249
basically it removes everything that are not

390
00:16:42,249 --> 00:16:48,069
letters or numbers apparently it might

391
00:16:48,069 --> 00:16:50,379
seem safe even if it is not the way

392
00:16:50,379 --> 00:16:52,449
you usually use it  because in fact

393
00:16:52,449 --> 00:16:54,459
only one cannot put it only in

394
00:16:54,459 --> 00:16:56,619
letters or numbers he may think that it is

395
00:16:56,619 --> 00:16:58,059
safe

396
00:16:58,059 --> 00:17:00,040
and instead no because there is one thing that

397
00:17:00,040 --> 00:17:02,759
I did not tell you this service used

398
00:17:02,759 --> 00:17:04,148
sequel aids

399
00:17:04,148 --> 00:17:06,880
well yes because if that it

400
00:17:06,880 --> 00:17:08,560
is quite nice from this point

401
00:17:08,560 --> 00:17:10,869
of view because because this command

402
00:17:10,869 --> 00:17:12,910
here that is we putting as password

403
00:17:12,910 --> 00:17:15,459
the written password this would be the

404
00:17:15,459 --> 00:17:18,520
command that would execute that is

405
00:17:18,520 --> 00:17:20,800
we would expect c  he if the

406
00:17:20,800 --> 00:17:23,859
password field is the same as the written password

407
00:17:23,859 --> 00:17:26,260
which is almost never the case because

408
00:17:26,260 --> 00:17:31,420
in that case no password

409
00:17:31,420 --> 00:17:33,370
was just a password, we would expect

410
00:17:33,370 --> 00:17:38,260
it to be false and therefore to find

411
00:17:38,260 --> 00:17:40,360
no user who never matches

412
00:17:40,360 --> 00:17:43,030
instead there is  a beautiful feature said

413
00:17:43,030 --> 00:17:45,400
that it that practices is like writing

414
00:17:45,400 --> 00:17:50,440
this that is he password password

415
00:17:50,440 --> 00:17:54,520
sees it as the password field and then

416
00:17:54,520 --> 00:17:57,400
replaces the password written by the

417
00:17:57,400 --> 00:17:58,870
user's password so it is like

418
00:17:58,870 --> 00:18:02,050
writing the sentence below when password

419
00:18:02,050 --> 00:18:03,790
and password wars always then in

420
00:18:03,790 --> 00:18:05,650
practice we  writing password as a

421
00:18:05,650 --> 00:18:07,330
password could mental in the profile of

422
00:18:07,330 --> 00:18:11,980
these yes very nice user as it

423
00:18:11,980 --> 00:18:14,230
can be solved by simply putting

424
00:18:14,230 --> 00:18:15,700
a single quote in place of double

425
00:18:15,700 --> 00:18:19,870
quotes is simple but if

426
00:18:19,870 --> 00:18:23,740
one does not expect him to actually

427
00:18:23,740 --> 00:18:26,860
do this sequel light that is he may

428
00:18:26,860 --> 00:18:30,580
not understand why he does this  in fact

429
00:18:30,580 --> 00:18:32,500
sequel haiti is the only one that does such a

430
00:18:32,500 --> 00:18:34,480
thing sincerely that I know  or

431
00:18:34,480 --> 00:18:37,600
at least ok now little thing

432
00:18:37,600 --> 00:18:39,490
now we have seen from the point of view

433
00:18:39,490 --> 00:18:42,370
of us attacking the other teams

434
00:18:42,370 --> 00:18:43,660
we see that a bit and if we do not

435
00:18:43,660 --> 00:18:46,450
want to look for bugs and remember

436
00:18:46,450 --> 00:18:48,670
flowers the first one is very simple

437
00:18:48,670 --> 00:18:51,700
below we have the link of our

438
00:18:51,700 --> 00:18:54,490
key a few lines above  the how he

439
00:18:54,490 --> 00:18:57,610
did it in 5 seconds

440
00:18:57,610 --> 00:19:00,640
we have already stolen an attack thanks if

441
00:19:00,640 --> 00:19:02,910
you have any questions

442
00:19:04,760 --> 00:19:08,250
[Applause]

443
00:19:24,230 --> 00:19:28,110
there was an image on an image and you didn't

444
00:19:28,110 --> 00:19:30,030
specify it so I normally ask you

445
00:19:30,030 --> 00:19:31,980
to watch

446
00:19:31,980 --> 00:19:34,950
network traffic 11 use tools like wireshark or

447
00:19:34,950 --> 00:19:36,780
otherwise take  he opens the capture files

448
00:19:36,780 --> 00:19:39,120
with wireshark looks at all the data

449
00:19:39,120 --> 00:19:41,820
ok I have them why make an ad hoc

450
00:19:41,820 --> 00:19:44,760
tool what changes what's the difference ok the

451
00:19:44,760 --> 00:19:46,140
problem we had because

452
00:19:46,140 --> 00:19:48,000
at the beginning we tested wireshark which

453
00:19:48,000 --> 00:19:50,700
was the most obvious choice is  that to do

454
00:19:50,700 --> 00:19:53,010
the same thing that is to switch from one stream

455
00:19:53,010 --> 00:19:55,830
to another it took something like 5

456
00:19:55,830 --> 00:19:58,560
clicks and a lot of time while in flowers

457
00:19:58,560 --> 00:20:00,780
we also implemented the

458
00:20:00,780 --> 00:20:02,790
binding of wim so it uses  ndo

459
00:20:02,790 --> 00:20:05,670
simply ge that we could go from

460
00:20:05,670 --> 00:20:07,380
one place to another really

461
00:20:07,380 --> 00:20:08,580
fast

462
00:20:08,580 --> 00:20:11,370
then another thing was the highlighting

463
00:20:11,370 --> 00:20:14,220
of the flags also in the list that is, in

464
00:20:14,220 --> 00:20:18,090
each flow it appeared red if

465
00:20:18,090 --> 00:20:19,620
inside they must flags so we can

466
00:20:19,620 --> 00:20:22,110
immediately understand in which flows we  they were

467
00:20:22,110 --> 00:20:24,420
stealing something and what other flows

468
00:20:24,420 --> 00:20:27,900
were just tests then we could

469
00:20:27,900 --> 00:20:29,430
divide things by services in a

470
00:20:29,430 --> 00:20:31,710
simple way to do quiri and without knowing the

471
00:20:31,710 --> 00:20:33,630
syntax of wired which for heaven's sake

472
00:20:33,630 --> 00:20:35,490
not at all difficult but when you are there

473
00:20:35,490 --> 00:20:38,430
under pressure it is a lot of stuff to be able to have

474
00:20:38,430 --> 00:20:39,510
a  'graphical interface in which to

475
00:20:39,510 --> 00:20:41,450
select things in a banal way

476
00:20:41,450 --> 00:20:44,960
mainly for this

477
00:20:45,150 --> 00:20:47,950
and because there are also other solutions

478
00:20:47,950 --> 00:20:50,770
made on purpose but none that fit

479
00:20:50,770 --> 00:20:53,520
exactly the scenario we were in

480
00:20:53,520 --> 00:20:56,470
having a tour so written ad hoc that

481
00:20:56,470 --> 00:20:58,090
did exactly what we needed

482
00:20:58,090 --> 00:21:00,250
was  decisive in my opinion no

483
00:21:00,250 --> 00:21:01,840
other tool would have allowed us to do

484
00:21:01,840 --> 00:21:03,820
this because there are many other

485
00:21:03,820 --> 00:21:07,000
open source solutions  you around but

486
00:21:07,000 --> 00:21:09,040
not exactly for these purposes

487
00:21:09,040 --> 00:21:20,370
here are other questions ok thanks to all

