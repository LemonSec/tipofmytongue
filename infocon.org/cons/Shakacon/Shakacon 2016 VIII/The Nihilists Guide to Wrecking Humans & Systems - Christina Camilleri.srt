1
00:00:01,460 --> 00:00:15,268
hi hmm who else has been playing pokemon

2
00:00:07,710 --> 00:00:18,170
go recently yeah okay I guess I'll get

3
00:00:15,269 --> 00:00:20,460
started<font color="#CCCCCC"> if everyone's ready to listen</font>

4
00:00:18,170 --> 00:00:23,070
thanks for<font color="#E5E5E5"> coming to my talk today and</font>

5
00:00:20,460 --> 00:00:24,930
special thanks to all the organizers and

6
00:00:23,070 --> 00:00:27,090
crew at Chaka Khan really appreciate

7
00:00:24,930 --> 00:00:30,900
<font color="#CCCCCC">being able to talk in such a beautiful</font>

8
00:00:27,090 --> 00:00:33,899
place I promised myself I'd get<font color="#CCCCCC"> out more</font>

9
00:00:30,900 --> 00:00:37,019
when I was in Hawaii but so far my trip

10
00:00:33,899 --> 00:00:39,809
has been playing video games and playing

11
00:00:37,020 --> 00:00:45,000
pokemon go I mean Pokemon go is outside

12
00:00:39,809 --> 00:00:47,669
still so it still counts but ok so to my

13
00:00:45,000 --> 00:00:49,800
talk my talk for today the Nilus guide

14
00:00:47,670 --> 00:00:52,410
to wrecking humans and systems we going

15
00:00:49,800 --> 00:00:54,328
off we'll be<font color="#E5E5E5"> going over some fun attack</font>

16
00:00:52,410 --> 00:00:57,718
training by combining social engineering

17
00:00:54,329 --> 00:00:59,430
and attack sorry combining social

18
00:00:57,719 --> 00:01:01,109
engineering and technical attacks and it

19
00:00:59,430 --> 00:01:03,840
will be also looking at the problems on

20
00:01:01,109 --> 00:01:06,630
focusing on technical attacks and social

21
00:01:03,840 --> 00:01:09,150
engineering as separate risks also be

22
00:01:06,630 --> 00:01:14,339
telling some personal war stories about

23
00:01:09,150 --> 00:01:15,630
how security went very wrong<font color="#CCCCCC"> ok but</font>

24
00:01:14,340 --> 00:01:19,799
<font color="#E5E5E5">before I start some of you probably</font>

25
00:01:15,630 --> 00:01:22,830
wondering about<font color="#E5E5E5"> who i am i'm</font><font color="#CCCCCC"> christina</font>

26
00:01:19,799 --> 00:01:25,650
i'm from australia currently in<font color="#CCCCCC"> Chicago</font>

27
00:01:22,830 --> 00:01:28,500
and I do mostly pen testing and social

28
00:01:25,650 --> 00:01:32,520
engineering I really like cats and

29
00:01:28,500 --> 00:01:35,280
whiskey I<font color="#E5E5E5"> usually do</font><font color="#CCCCCC"> this talk with my</font>

30
00:01:32,520 --> 00:01:36,929
coworker shops and we go<font color="#CCCCCC"> back and forth</font>

31
00:01:35,280 --> 00:01:38,460
with the stories that<font color="#E5E5E5"> we tell however it</font>

32
00:01:36,930 --> 00:01:42,899
will just be me today<font color="#CCCCCC"> that you need to</font>

33
00:01:38,460 --> 00:01:45,539
put up<font color="#E5E5E5"> with subs likes absinthe</font><font color="#CCCCCC"> okay</font>

34
00:01:42,899 --> 00:01:49,439
let's get<font color="#CCCCCC"> our hands dirty first let's</font>

35
00:01:45,540 --> 00:01:53,579
talk about humans and computers when I

36
00:01:49,439 --> 00:01:56,100
<font color="#E5E5E5">think about computers I</font><font color="#CCCCCC"> usually go what</font>

37
00:01:53,579 --> 00:01:57,869
are you and sorry when I think about

38
00:01:56,100 --> 00:02:00,089
humans not computers and the human

39
00:01:57,869 --> 00:02:03,899
usually says I am a strong independent

40
00:02:00,090 --> 00:02:05,880
being and I have him feelings I have

41
00:02:03,899 --> 00:02:07,710
emotions I can talk<font color="#E5E5E5"> to</font><font color="#CCCCCC"> people and I can</font>

42
00:02:05,880 --> 00:02:10,049
relate<font color="#CCCCCC"> to people and I have once and</font>

43
00:02:07,710 --> 00:02:11,670
needs that require interactions and I

44
00:02:10,050 --> 00:02:13,440
like<font color="#E5E5E5"> stuff and things and I like to feel</font>

45
00:02:11,670 --> 00:02:16,829
like I have<font color="#E5E5E5"> control over</font>

46
00:02:13,440 --> 00:02:20,700
but when we asked the same question<font color="#E5E5E5"> to</font>

47
00:02:16,830 --> 00:02:22,830
computers sorry basically a human is

48
00:02:20,700 --> 00:02:24,989
someone that is capable<font color="#E5E5E5"> of making</font>

49
00:02:22,830 --> 00:02:27,600
judgment calls<font color="#E5E5E5"> and when we asked the</font>

50
00:02:24,990 --> 00:02:29,760
same question to computers the computer

51
00:02:27,600 --> 00:02:33,329
says I can follow instructions good and

52
00:02:29,760 --> 00:02:37,470
I it has no emotion and it is not

53
00:02:33,330 --> 00:02:40,140
capable of making judgment calls so it's

54
00:02:37,470 --> 00:02:42,300
just a bunch<font color="#E5E5E5"> of binary and when we think</font>

55
00:02:40,140 --> 00:02:44,640
about them together from a risk

56
00:02:42,300 --> 00:02:46,350
standpoint we're at a stage in infosec

57
00:02:44,640 --> 00:02:48,000
where we're doing a pretty<font color="#CCCCCC"> okay job at</font>

58
00:02:46,350 --> 00:02:49,739
assessing the vulnerabilities in each

59
00:02:48,000 --> 00:02:51,420
computers are scanned in their

60
00:02:49,740 --> 00:02:52,920
penetration tested and they're audited

61
00:02:51,420 --> 00:02:55,320
and they're reviewed and they secured

62
00:02:52,920 --> 00:02:57,239
and similarly with humans they're

63
00:02:55,320 --> 00:03:01,560
trained audited monitored and

64
00:02:57,240 --> 00:03:04,380
disciplined and while that may<font color="#E5E5E5"> all sound</font>

65
00:03:01,560 --> 00:03:07,740
<font color="#CCCCCC">okay we're forgetting about one simple</font>

66
00:03:04,380 --> 00:03:09,720
but important but important fact we're

67
00:03:07,740 --> 00:03:11,760
putting something that can make<font color="#E5E5E5"> judgment</font>

68
00:03:09,720 --> 00:03:13,740
calls something that is capable<font color="#E5E5E5"> of</font>

69
00:03:11,760 --> 00:03:15,450
feeling emotions in<font color="#CCCCCC"> front of a machine</font>

70
00:03:13,740 --> 00:03:19,739
that is<font color="#E5E5E5"> only capable of following</font>

71
00:03:15,450 --> 00:03:21,839
instructions and has no emotion so when

72
00:03:19,739 --> 00:03:23,790
human and computer come together we

73
00:03:21,840 --> 00:03:25,980
realize that we can coerce humans in

74
00:03:23,790 --> 00:03:28,920
front of these<font color="#CCCCCC"> machines to do things for</font>

75
00:03:25,980 --> 00:03:31,560
us instructions<font color="#CCCCCC"> are given out</font><font color="#E5E5E5"> by people</font>

76
00:03:28,920 --> 00:03:34,429
and<font color="#E5E5E5"> all the computer knows is to follow</font>

77
00:03:31,560 --> 00:03:36,780
these instructions that we give it

78
00:03:34,430 --> 00:03:38,670
effectively<font color="#E5E5E5"> this means that</font><font color="#CCCCCC"> we can make</font>

79
00:03:36,780 --> 00:03:41,250
other people's computers or other

80
00:03:38,670 --> 00:03:43,738
people's machines do things that we the

81
00:03:41,250 --> 00:03:46,980
attackers want because there is a<font color="#E5E5E5"> person</font>

82
00:03:43,739 --> 00:03:49,410
in front of that computer and while that

83
00:03:46,980 --> 00:03:51,959
in a creative sense is an amazing

84
00:03:49,410 --> 00:03:53,880
achievement in the world and has led and

85
00:03:51,959 --> 00:03:56,780
has resulted in balance of amazing

86
00:03:53,880 --> 00:03:58,829
achievements and both of our

87
00:03:56,780 --> 00:04:00,959
insecurities it's<font color="#E5E5E5"> a fundamental flaw</font>

88
00:03:58,830 --> 00:04:03,209
we're putting in motion in front of an

89
00:04:00,959 --> 00:04:08,250
emotionless system that is<font color="#E5E5E5"> responsible</font>

90
00:04:03,209 --> 00:04:11,250
for securing your data so now that<font color="#CCCCCC"> we</font>

91
00:04:08,250 --> 00:04:13,769
have that out<font color="#CCCCCC"> of the way what exactly is</font>

92
00:04:11,250 --> 00:04:16,560
<font color="#CCCCCC">the problem</font><font color="#E5E5E5"> here the problem is that</font>

93
00:04:13,769 --> 00:04:18,840
<font color="#CCCCCC">we're focusing on these risks separately</font>

94
00:04:16,560 --> 00:04:21,570
we're in we're assessing human and

95
00:04:18,839 --> 00:04:22,859
technical risks risks separately where

96
00:04:21,570 --> 00:04:25,469
we should be assessing them as a

97
00:04:22,860 --> 00:04:27,750
collective issue

98
00:04:25,470 --> 00:04:29,610
and we're giving humans access to break

99
00:04:27,750 --> 00:04:38,370
the rules<font color="#CCCCCC"> that we set on computers in</font>

100
00:04:29,610 --> 00:04:41,040
the first place<font color="#E5E5E5"> okay okay with that let</font>

101
00:04:38,370 --> 00:04:43,230
me now tell you a story about<font color="#E5E5E5"> a recent</font>

102
00:04:41,040 --> 00:04:45,000
engagement that I worked on through the

103
00:04:43,230 --> 00:04:46,710
talk i'll be going through some will our

104
00:04:45,000 --> 00:04:49,320
real world war stories with real

105
00:04:46,710 --> 00:04:50,880
screenshots and we'll explore what went

106
00:04:49,320 --> 00:04:55,349
wrong from a technical and social

107
00:04:50,880 --> 00:04:57,180
standpoint so with this<font color="#E5E5E5"> company</font><font color="#CCCCCC"> i had</font>

108
00:04:55,350 --> 00:04:59,460
<font color="#E5E5E5">started with an email the email was</font>

109
00:04:57,180 --> 00:05:01,170
targeted to be sent to a large<font color="#E5E5E5"> sample</font>

110
00:04:59,460 --> 00:05:02,760
size of employees and<font color="#CCCCCC"> i was</font>

111
00:05:01,170 --> 00:05:05,010
impersonating their<font color="#CCCCCC"> healthcare</font><font color="#E5E5E5"> benefits</font>

112
00:05:02,760 --> 00:05:08,700
team something that most of<font color="#E5E5E5"> us in the</font>

113
00:05:05,010 --> 00:05:11,400
audience probably care about and when<font color="#CCCCCC"> i</font>

114
00:05:08,700 --> 00:05:13,289
thought about how to make this scenario

115
00:05:11,400 --> 00:05:15,750
i thought about<font color="#CCCCCC"> how was specially</font>

116
00:05:13,290 --> 00:05:18,930
crafted bad email<font color="#E5E5E5"> could result in a much</font>

117
00:05:15,750 --> 00:05:20,850
<font color="#CCCCCC">more sophisticated attack tune I so I</font>

118
00:05:18,930 --> 00:05:23,370
started by spoofing an email from their

119
00:05:20,850 --> 00:05:26,790
<font color="#CCCCCC">healthcare</font><font color="#E5E5E5"> benefits team and the email</font>

120
00:05:23,370 --> 00:05:28,440
said in short hi due to a recent change

121
00:05:26,790 --> 00:05:29,940
in our<font color="#E5E5E5"> health care benefits provider</font>

122
00:05:28,440 --> 00:05:32,490
it's time for you to update<font color="#E5E5E5"> your details</font>

123
00:05:29,940 --> 00:05:35,850
please login<font color="#E5E5E5"> to the portal in the URL</font>

124
00:05:32,490 --> 00:05:37,620
you can find below now this scenario

125
00:05:35,850 --> 00:05:38,880
worked particularly well because the

126
00:05:37,620 --> 00:05:42,060
company was<font color="#CCCCCC"> actually going through</font>

127
00:05:38,880 --> 00:05:44,880
health care benefits provided change at

128
00:05:42,060 --> 00:05:46,140
the time so which I found<font color="#E5E5E5"> out by recent</font>

129
00:05:44,880 --> 00:05:48,600
articles that had been published<font color="#CCCCCC"> online</font>

130
00:05:46,140 --> 00:05:52,110
so I specifically chose this scenario to

131
00:05:48,600 --> 00:05:55,650
match to match real world<font color="#CCCCCC"> to too</font><font color="#E5E5E5"> much</font><font color="#CCCCCC"> a</font>

132
00:05:52,110 --> 00:05:58,710
real<font color="#E5E5E5"> world scenario and the URL in this</font>

133
00:05:55,650 --> 00:06:00,210
email a link to website that<font color="#E5E5E5"> I had</font>

134
00:05:58,710 --> 00:06:02,010
cloned from their real health<font color="#CCCCCC"> care</font>

135
00:06:00,210 --> 00:06:04,859
benefits portal but<font color="#E5E5E5"> with some minor</font>

136
00:06:02,010 --> 00:06:06,450
details changed and once logged in we

137
00:06:04,860 --> 00:06:08,640
<font color="#CCCCCC">decided to leave the</font><font color="#E5E5E5"> user at a blank</font>

138
00:06:06,450 --> 00:06:11,130
page because our job for<font color="#CCCCCC"> phase one was</font>

139
00:06:08,640 --> 00:06:15,810
done we had the that we had the users

140
00:06:11,130 --> 00:06:17,520
credentials and as expected<font color="#E5E5E5"> after a day</font>

141
00:06:15,810 --> 00:06:19,320
or so people started becoming a little

142
00:06:17,520 --> 00:06:21,630
<font color="#E5E5E5">confused about why they couldn't login</font>

143
00:06:19,320 --> 00:06:24,120
and replied to the spoofed email that I

144
00:06:21,630 --> 00:06:26,760
had sent asking what was wrong at this

145
00:06:24,120 --> 00:06:29,190
stage<font color="#E5E5E5"> we had</font><font color="#CCCCCC"> access to several users</font>

146
00:06:26,760 --> 00:06:32,820
email accounts so we could monitor what

147
00:06:29,190 --> 00:06:34,820
was going on in real time one user said

148
00:06:32,820 --> 00:06:37,880
in<font color="#E5E5E5"> particular in</font>

149
00:06:34,820 --> 00:06:39,770
sands I followed the instructions and

150
00:06:37,880 --> 00:06:43,219
what not and was not able to<font color="#E5E5E5"> login</font>

151
00:06:39,770 --> 00:06:44,960
<font color="#E5E5E5">please advise and soon after the real</font>

152
00:06:43,220 --> 00:06:47,360
benefits team realized that they did<font color="#E5E5E5"> not</font>

153
00:06:44,960 --> 00:06:49,940
send this email and promptly replied

154
00:06:47,360 --> 00:06:51,890
with this is not a<font color="#CCCCCC"> legitimate email from</font>

155
00:06:49,940 --> 00:06:54,560
the benefits<font color="#E5E5E5"> department do not do</font>

156
00:06:51,890 --> 00:06:56,510
anything and at this stage I was

157
00:06:54,560 --> 00:06:57,790
starting<font color="#E5E5E5"> to think well this might be at</font>

158
00:06:56,510 --> 00:07:01,909
this might be the end<font color="#E5E5E5"> of the engagement</font>

159
00:06:57,790 --> 00:07:03,740
<font color="#E5E5E5">but one day later when I still had</font>

160
00:07:01,910 --> 00:07:06,950
access to all these users email accounts

161
00:07:03,740 --> 00:07:09,500
a company-wide email was sent titled

162
00:07:06,950 --> 00:07:11,479
hackers gonna hack or at least try to

163
00:07:09,500 --> 00:07:13,400
and I thought<font color="#E5E5E5"> this was a little bit</font>

164
00:07:11,480 --> 00:07:15,440
funny because I was reading this email

165
00:07:13,400 --> 00:07:18,950
<font color="#CCCCCC">from an employee's email account I had</font>

166
00:07:15,440 --> 00:07:21,500
<font color="#E5E5E5">access to at this stage even though they</font>

167
00:07:18,950 --> 00:07:23,240
identified that this email was a threat

168
00:07:21,500 --> 00:07:24,770
they did<font color="#E5E5E5"> not do anything about it they</font>

169
00:07:23,240 --> 00:07:26,480
did not block the email they did<font color="#E5E5E5"> not</font>

170
00:07:24,770 --> 00:07:30,140
reset use of passwords and i still had

171
00:07:26,480 --> 00:07:31,670
access to their email accounts and in

172
00:07:30,140 --> 00:07:33,469
that<font color="#E5E5E5"> email they attached a screenshot of</font>

173
00:07:31,670 --> 00:07:35,450
my phishing email and asked everyone not

174
00:07:33,470 --> 00:07:37,790
to click or to respond to it<font color="#E5E5E5"> and</font>

175
00:07:35,450 --> 00:07:40,219
following<font color="#E5E5E5"> that they signed with their</font>

176
00:07:37,790 --> 00:07:44,780
security department email<font color="#E5E5E5"> info SEC</font>

177
00:07:40,220 --> 00:07:50,030
operations at blog com and ended the

178
00:07:44,780 --> 00:07:51,890
<font color="#E5E5E5">email with warm regards when and at this</font>

179
00:07:50,030 --> 00:07:54,229
stage I'm thinking well great I can now

180
00:07:51,890 --> 00:07:55,789
execute part<font color="#CCCCCC"> two of my attack they</font>

181
00:07:54,230 --> 00:07:58,330
hadn't blocked the website<font color="#E5E5E5"> and all they</font>

182
00:07:55,790 --> 00:08:01,310
nor had they issued password resets and

183
00:07:58,330 --> 00:08:04,430
now that I know<font color="#CCCCCC"> that Gwen works in the</font>

184
00:08:01,310 --> 00:08:06,440
<font color="#CCCCCC">info SEC operations department and I can</font>

185
00:08:04,430 --> 00:08:09,050
now make phone calls on the department's

186
00:08:06,440 --> 00:08:12,350
hard on the department's behalf to all

187
00:08:09,050 --> 00:08:13,940
affected users essentially<font color="#E5E5E5"> now I am</font>

188
00:08:12,350 --> 00:08:17,060
pretending to play the<font color="#E5E5E5"> role of the good</font>

189
00:08:13,940 --> 00:08:19,190
guy Gwen so along comes Gwen which is me

190
00:08:17,060 --> 00:08:21,020
and I say on<font color="#CCCCCC"> the phone to an</font>

191
00:08:19,190 --> 00:08:23,150
unsuspecting person so I'm now making

192
00:08:21,020 --> 00:08:26,270
phone calls to the affected users that

193
00:08:23,150 --> 00:08:29,539
were targeted by my phishing email and I

194
00:08:26,270 --> 00:08:31,580
say on<font color="#E5E5E5"> the phone to them hey I'm Gwen to</font>

195
00:08:29,540 --> 00:08:33,800
take<font color="#CCCCCC"> precautions from the recent health</font>

196
00:08:31,580 --> 00:08:37,000
benefits cam could you please<font color="#CCCCCC"> visit this</font>

197
00:08:33,799 --> 00:08:40,010
website and download the security patch

198
00:08:37,000 --> 00:08:41,960
but of course<font color="#E5E5E5"> the security patch was an</font>

199
00:08:40,010 --> 00:08:43,780
executable<font color="#CCCCCC"> metasploit payload that</font><font color="#E5E5E5"> gave</font>

200
00:08:41,960 --> 00:08:46,040
me<font color="#E5E5E5"> access to their personal machine</font>

201
00:08:43,780 --> 00:08:50,069
Thank<font color="#E5E5E5"> You Gwen</font>

202
00:08:46,040 --> 00:08:52,980
okay so now<font color="#CCCCCC"> that we have</font><font color="#E5E5E5"> access to an</font>

203
00:08:50,070 --> 00:08:55,860
employee's machine and thanks<font color="#E5E5E5"> to the</font>

204
00:08:52,980 --> 00:08:58,460
social engineering and we now<font color="#CCCCCC"> have</font>

205
00:08:55,860 --> 00:09:01,230
access to multiple employees machines

206
00:08:58,460 --> 00:09:02,880
through remote desktop in this part<font color="#E5E5E5"> of</font>

207
00:09:01,230 --> 00:09:04,320
an<font color="#CCCCCC"> engagement it was now up to us to</font>

208
00:09:02,880 --> 00:09:06,330
<font color="#CCCCCC">find every nook and cranny in their</font>

209
00:09:04,320 --> 00:09:08,760
network which included their web look a

210
00:09:06,330 --> 00:09:14,520
web application services natural network

211
00:09:08,760 --> 00:09:17,700
shares and more the first thing that

212
00:09:14,520 --> 00:09:21,060
<font color="#E5E5E5">caught our attention before we even ran</font>

213
00:09:17,700 --> 00:09:23,640
any network scans on the<font color="#E5E5E5"> company was a</font>

214
00:09:21,060 --> 00:09:28,439
presence of a web spew<font color="#E5E5E5"> WebSphere MQ</font>

215
00:09:23,640 --> 00:09:30,900
client on a network<font color="#CCCCCC"> share for those who</font>

216
00:09:28,440 --> 00:09:32,910
<font color="#E5E5E5">don't know WebSphere MQ is just a queue</font>

217
00:09:30,900 --> 00:09:34,980
manager often bundled with<font color="#E5E5E5"> IBM's web</font>

218
00:09:32,910 --> 00:09:37,500
application server called WebSphere and

219
00:09:34,980 --> 00:09:40,470
it's primarily used to send messages

220
00:09:37,500 --> 00:09:43,110
across multiple platforms something that

221
00:09:40,470 --> 00:09:46,710
we really<font color="#E5E5E5"> shouldn't have access to as a</font>

222
00:09:43,110 --> 00:09:48,450
lower level staff member once opened

223
00:09:46,710 --> 00:09:50,730
represented with a bundle<font color="#E5E5E5"> of</font><font color="#CCCCCC"> save</font>

224
00:09:48,450 --> 00:09:54,450
servers mostly on<font color="#E5E5E5"> these corporations uat</font>

225
00:09:50,730 --> 00:09:58,530
testing environment one of the<font color="#E5E5E5"> features</font>

226
00:09:54,450 --> 00:10:01,830
that web cmq servers have is the ability

227
00:09:58,530 --> 00:10:03,780
to run scheduled services and these

228
00:10:01,830 --> 00:10:06,120
services let you call arbitrary binary

229
00:10:03,780 --> 00:10:09,120
<font color="#CCCCCC">zhan the server being able</font><font color="#E5E5E5"> to provide a</font>

230
00:10:06,120 --> 00:10:12,240
single starting argument surprisingly

231
00:10:09,120 --> 00:10:14,880
even with the ability to call sprite to

232
00:10:12,240 --> 00:10:18,330
call arbitrary binary we ran into a

233
00:10:14,880 --> 00:10:21,060
slight complication in that it had<font color="#E5E5E5"> very</font>

234
00:10:18,330 --> 00:10:23,370
strict it had a very<font color="#E5E5E5"> strict restriction</font>

235
00:10:21,060 --> 00:10:25,680
where no shell control characters<font color="#E5E5E5"> could</font>

236
00:10:23,370 --> 00:10:29,130
be used in the commands you asked it to

237
00:10:25,680 --> 00:10:32,250
execute so this included semicolons

238
00:10:29,130 --> 00:10:35,130
pipes angle brackets etc<font color="#E5E5E5"> our solution</font>

239
00:10:32,250 --> 00:10:37,380
around<font color="#CCCCCC"> this problem was to</font><font color="#E5E5E5"> run a</font>

240
00:10:35,130 --> 00:10:39,240
modified Python reverse shell without

241
00:10:37,380 --> 00:10:41,040
any control characters in their

242
00:10:39,240 --> 00:10:44,240
blacklist in this case we're all

243
00:10:41,040 --> 00:10:46,439
semicolons were replaced with<font color="#E5E5E5"> new lines</font>

244
00:10:44,240 --> 00:10:48,330
alternatively<font color="#E5E5E5"> in</font><font color="#CCCCCC"> Windows we could have</font>

245
00:10:46,440 --> 00:10:50,520
just used a file in the SMB network

246
00:10:48,330 --> 00:10:52,320
share to get<font color="#E5E5E5"> our CA by</font><font color="#CCCCCC"> wesley and cue</font>

247
00:10:50,520 --> 00:10:55,709
instead of the complex single line

248
00:10:52,320 --> 00:10:56,780
<font color="#CCCCCC">python command but python is always more</font>

249
00:10:55,709 --> 00:10:59,420
fun

250
00:10:56,780 --> 00:11:01,160
okay at<font color="#E5E5E5"> this</font><font color="#CCCCCC"> point we're able to get a</font>

251
00:10:59,420 --> 00:11:04,849
reverse shell on each of that WebSphere

252
00:11:01,160 --> 00:11:06,770
MQ servers and we found four unique mq

253
00:11:04,850 --> 00:11:10,210
servers and we're able to earn them all

254
00:11:06,770 --> 00:11:13,069
so we've now multiplied of machines

255
00:11:10,210 --> 00:11:17,630
compromised from one to four sorry

256
00:11:13,070 --> 00:11:19,190
compromised by<font color="#E5E5E5"> four when we took a quick</font>

257
00:11:17,630 --> 00:11:22,189
look at some<font color="#CCCCCC"> of the freshly compromised</font>

258
00:11:19,190 --> 00:11:25,240
WebSphere MQ servers we found<font color="#E5E5E5"> a maven</font>

259
00:11:22,190 --> 00:11:28,700
repository we found maven repository

260
00:11:25,240 --> 00:11:31,270
posit reconfigurations I'm not doing

261
00:11:28,700 --> 00:11:34,010
good at talking today maven repository

262
00:11:31,270 --> 00:11:36,319
configuration files there we go and in

263
00:11:34,010 --> 00:11:39,410
<font color="#E5E5E5">these files an internal server is</font>

264
00:11:36,320 --> 00:11:42,200
reference 10 1 1099 which is not a real

265
00:11:39,410 --> 00:11:45,380
IP address by<font color="#CCCCCC"> the way and</font><font color="#E5E5E5"> using the west</font>

266
00:11:42,200 --> 00:11:47,870
v mq server as a proxy we then visit the

267
00:11:45,380 --> 00:11:49,460
maven reaper manager to find a trove of

268
00:11:47,870 --> 00:11:51,730
confidential company source code

269
00:11:49,460 --> 00:11:56,630
accessible<font color="#E5E5E5"> without any authentication</font>

270
00:11:51,730 --> 00:12:01,190
here for us to steal so we can<font color="#E5E5E5"> has the</font>

271
00:11:56,630 --> 00:12:04,460
network and considering<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the maven</font>

272
00:12:01,190 --> 00:12:06,770
repository was the 10 10 10 9 dot<font color="#E5E5E5"> 0</font>

273
00:12:04,460 --> 00:12:08,570
subnet we run an nmap scan to see if

274
00:12:06,770 --> 00:12:13,490
there's any other applications that we

275
00:12:08,570 --> 00:12:15,830
can access and after the nmap scan was

276
00:12:13,490 --> 00:12:17,990
finished we had realized<font color="#E5E5E5"> that not only</font>

277
00:12:15,830 --> 00:12:19,520
did<font color="#E5E5E5"> we</font><font color="#CCCCCC"> have access to a large number of</font>

278
00:12:17,990 --> 00:12:22,250
source code repositories through the

279
00:12:19,520 --> 00:12:24,650
three applications such as fish fish<font color="#CCCCCC"> eye</font>

280
00:12:22,250 --> 00:12:28,370
and<font color="#CCCCCC"> nexus</font><font color="#E5E5E5"> no no type but we also had</font>

281
00:12:24,650 --> 00:12:30,260
access to a<font color="#CCCCCC"> machine sorry add access to</font>

282
00:12:28,370 --> 00:12:32,210
<font color="#E5E5E5">three</font><font color="#CCCCCC"> Jenkins servers that we're pushing</font>

283
00:12:30,260 --> 00:12:35,060
code to a large number<font color="#CCCCCC"> of production</font>

284
00:12:32,210 --> 00:12:37,370
systems and to make west north

285
00:12:35,060 --> 00:12:41,599
indication was required for<font color="#E5E5E5"> any of the</font>

286
00:12:37,370 --> 00:12:45,170
<font color="#CCCCCC">junkin instances that we encountered and</font>

287
00:12:41,600 --> 00:12:47,090
to conclude this story let's look at a

288
00:12:45,170 --> 00:12:49,250
quick recap<font color="#CCCCCC"> of the entire attack</font>

289
00:12:47,090 --> 00:12:51,080
scenario presented here serve we went

290
00:12:49,250 --> 00:12:55,790
<font color="#E5E5E5">from having access I have a laser</font>

291
00:12:51,080 --> 00:12:58,310
pointer from one employee machine so

292
00:12:55,790 --> 00:13:00,740
from<font color="#E5E5E5"> zero access to remote command</font>

293
00:12:58,310 --> 00:13:03,130
execution on production assets in just a

294
00:13:00,740 --> 00:13:03,130
few<font color="#E5E5E5"> days</font>

295
00:13:07,019 --> 00:13:16,630
thank you for supposed to play but it's

296
00:13:10,269 --> 00:13:30,370
<font color="#E5E5E5">not playing there we go it's a bit late</font>

297
00:13:16,630 --> 00:13:32,620
now but this<font color="#E5E5E5"> is my</font><font color="#CCCCCC"> favorite episode okay</font>

298
00:13:30,370 --> 00:13:34,959
you got the point so the company has now

299
00:13:32,620 --> 00:13:37,029
<font color="#E5E5E5">lost a majority of cisco's its source</font>

300
00:13:34,959 --> 00:13:38,319
code to an attacker they have<font color="#E5E5E5"> production</font>

301
00:13:37,029 --> 00:13:40,329
assets that are just waiting to be

302
00:13:38,319 --> 00:13:42,279
<font color="#CCCCCC">earned and all of this activity sprouted</font>

303
00:13:40,329 --> 00:13:46,630
by gaining access<font color="#E5E5E5"> to a single employee</font>

304
00:13:42,279 --> 00:13:50,250
machine by using social engineering<font color="#CCCCCC"> okay</font>

305
00:13:46,630 --> 00:13:52,449
enough for about what went wrong and

306
00:13:50,250 --> 00:13:56,019
enough about the story<font color="#CCCCCC"> and now to talk</font>

307
00:13:52,449 --> 00:14:01,060
<font color="#CCCCCC">about what went wrong in this case we</font>

308
00:13:56,019 --> 00:14:03,370
assume trust in in this story trust was

309
00:14:01,060 --> 00:14:05,800
assumed with all the affected users to

310
00:14:03,370 --> 00:14:08,439
report that if they had<font color="#CCCCCC"> been targeted by</font>

311
00:14:05,800 --> 00:14:10,359
the email and<font color="#CCCCCC"> Trust was also assumed for</font>

312
00:14:08,439 --> 00:14:13,569
the users not to visit<font color="#E5E5E5"> the website</font><font color="#CCCCCC"> after</font>

313
00:14:10,360 --> 00:14:16,269
the<font color="#E5E5E5"> email was sent this is</font><font color="#CCCCCC"> absolutely</font>

314
00:14:13,569 --> 00:14:18,160
not<font color="#E5E5E5"> the right way to go about it after</font>

315
00:14:16,269 --> 00:14:19,990
the engagement was over several users

316
00:14:18,160 --> 00:14:22,449
kept trying<font color="#E5E5E5"> to log in and there was even</font>

317
00:14:19,990 --> 00:14:25,209
one user in particular which happened to

318
00:14:22,449 --> 00:14:26,859
be the CFO of the company<font color="#E5E5E5"> that tried</font><font color="#CCCCCC"> to</font>

319
00:14:25,209 --> 00:14:28,750
<font color="#E5E5E5">login over and over again with different</font>

320
00:14:26,860 --> 00:14:33,329
sets of credentials this shouldn't

321
00:14:28,750 --> 00:14:33,329
happen after a threat is identified

322
00:14:33,389 --> 00:14:38,529
additionally we're only protecting the

323
00:14:36,550 --> 00:14:41,199
outer barriers while not paying enough

324
00:14:38,529 --> 00:14:43,269
attention to<font color="#E5E5E5"> the inside there was no</font>

325
00:14:41,199 --> 00:14:45,699
proper<font color="#CCCCCC"> Network segregation between the</font>

326
00:14:43,269 --> 00:14:47,500
production and dev environment we need

327
00:14:45,699 --> 00:14:49,899
to<font color="#E5E5E5"> start thinking as they found volume</font>

328
00:14:47,500 --> 00:14:54,610
and is already compromised and go from

329
00:14:49,899 --> 00:14:56,769
there<font color="#E5E5E5"> so don't assume trust humans are</font>

330
00:14:54,610 --> 00:14:58,360
bad at trust we're about<font color="#CCCCCC"> at trust the</font>

331
00:14:56,769 --> 00:15:00,370
site should have been blocked as soon as

332
00:14:58,360 --> 00:15:01,959
it was identified<font color="#CCCCCC"> and password</font><font color="#E5E5E5"> resets</font>

333
00:15:00,370 --> 00:15:04,930
should have been issued to everyone who

334
00:15:01,959 --> 00:15:08,109
received the email<font color="#E5E5E5"> I continuous access</font>

335
00:15:04,930 --> 00:15:10,089
to all affected target emails meaning I

336
00:15:08,110 --> 00:15:12,250
was able to<font color="#E5E5E5"> still monitor everything</font>

337
00:15:10,089 --> 00:15:13,959
that was happening in real<font color="#CCCCCC"> time this</font>

338
00:15:12,250 --> 00:15:16,329
also gives me a lot of information to

339
00:15:13,959 --> 00:15:18,599
<font color="#E5E5E5">cross to craft future attacks with the</font>

340
00:15:16,329 --> 00:15:21,040
company

341
00:15:18,600 --> 00:15:23,320
so this means that we<font color="#CCCCCC"> need to start</font>

342
00:15:21,040 --> 00:15:25,630
protecting the outer and<font color="#E5E5E5"> inner barriers</font>

343
00:15:23,320 --> 00:15:27,430
like it just said while making sure we

344
00:15:25,630 --> 00:15:29,680
take<font color="#E5E5E5"> a proactive approach to security</font>

345
00:15:27,430 --> 00:15:31,870
and ensure barriers are secured before

346
00:15:29,680 --> 00:15:36,040
something goes wrong not a reactive

347
00:15:31,870 --> 00:15:38,589
approach when it's already too late so

348
00:15:36,040 --> 00:15:40,449
with another recent engagement I was

349
00:15:38,589 --> 00:15:43,360
this one was a<font color="#CCCCCC"> little different</font><font color="#E5E5E5"> in that</font>

350
00:15:40,450 --> 00:15:47,440
again this time<font color="#E5E5E5"> I was posing as an</font>

351
00:15:43,360 --> 00:15:49,690
<font color="#E5E5E5">internal employer for a big company the</font>

352
00:15:47,440 --> 00:15:51,250
person i picked sorry an internal

353
00:15:49,690 --> 00:15:54,060
employee for a company the person i

354
00:15:51,250 --> 00:15:56,170
picked had also been named christina

355
00:15:54,060 --> 00:15:57,899
which<font color="#E5E5E5"> i picked because i thought was</font>

356
00:15:56,170 --> 00:15:59,890
funny it was a<font color="#E5E5E5"> very large company with</font>

357
00:15:57,899 --> 00:16:03,310
thousands<font color="#E5E5E5"> of employees so</font><font color="#CCCCCC"> i picked</font>

358
00:15:59,890 --> 00:16:05,170
someone if this same name as me so the

359
00:16:03,310 --> 00:16:07,569
<font color="#E5E5E5">christina that I had made up to pretend</font>

360
00:16:05,170 --> 00:16:10,420
the real christina was a<font color="#E5E5E5"> gorgeous lady</font>

361
00:16:07,570 --> 00:16:13,060
that was not good at computers I mean

362
00:16:10,420 --> 00:16:14,740
she was terrible at computers she was

363
00:16:13,060 --> 00:16:17,410
really did see didn't have it together

364
00:16:14,740 --> 00:16:21,310
<font color="#E5E5E5">and of course Christina had forgotten</font>

365
00:16:17,410 --> 00:16:23,469
her password so on the phone to an

366
00:16:21,310 --> 00:16:25,689
<font color="#E5E5E5">internal employee helpline assistant and</font>

367
00:16:23,470 --> 00:16:27,790
his job<font color="#CCCCCC"> was to help employees internal</font>

368
00:16:25,690 --> 00:16:29,200
employees of this company to walk them

369
00:16:27,790 --> 00:16:30,399
through doing password resets or any

370
00:16:29,200 --> 00:16:32,950
technical problems that<font color="#E5E5E5"> you might be</font>

371
00:16:30,399 --> 00:16:37,360
<font color="#CCCCCC">facing with their laptop and on the</font>

372
00:16:32,950 --> 00:16:39,910
phone I said hey I'm Christina I forgot

373
00:16:37,360 --> 00:16:42,010
my password and I don't have my laptop

374
00:16:39,910 --> 00:16:43,779
because I'm traveling right now and I

375
00:16:42,010 --> 00:16:46,540
really<font color="#E5E5E5"> really need access to my account</font>

376
00:16:43,779 --> 00:16:50,380
to access a document can<font color="#CCCCCC"> you please help</font>

377
00:16:46,540 --> 00:16:52,329
<font color="#CCCCCC">please and of course the person over the</font>

378
00:16:50,380 --> 00:16:55,870
phone and<font color="#E5E5E5"> said yeah sure it's my job to</font>

379
00:16:52,329 --> 00:16:58,569
<font color="#CCCCCC">help you Christina and he sent me to the</font>

380
00:16:55,870 --> 00:17:01,660
website<font color="#E5E5E5"> they're self-serve</font><font color="#CCCCCC"> passer</font><font color="#E5E5E5"> reset</font>

381
00:16:58,570 --> 00:17:03,610
website and to reset my password however

382
00:17:01,660 --> 00:17:05,409
<font color="#E5E5E5">I was pretending to have so many</font>

383
00:17:03,610 --> 00:17:07,059
problems with accessing the website and

384
00:17:05,410 --> 00:17:10,800
figuring how to do this myself that he

385
00:17:07,059 --> 00:17:14,649
said<font color="#E5E5E5"> to me word for word okay Christina</font>

386
00:17:10,800 --> 00:17:16,780
listen to me carefully you gotta go<font color="#E5E5E5"> to</font>

387
00:17:14,650 --> 00:17:18,490
<font color="#E5E5E5">that bar at the top of your browser you</font>

388
00:17:16,780 --> 00:17:21,270
see that<font color="#CCCCCC"> thing where you</font><font color="#E5E5E5"> type words in</font>

389
00:17:18,490 --> 00:17:23,870
<font color="#E5E5E5">to go there and type in the following</font>

390
00:17:21,270 --> 00:17:27,170
h/t t

391
00:17:23,869 --> 00:17:30,939
he s don't forget the<font color="#CCCCCC"> S Christina cuz</font>

392
00:17:27,170 --> 00:17:36,680
asses for secure colon forward slash

393
00:17:30,940 --> 00:17:38,809
forward slash www and he proceeded to

394
00:17:36,680 --> 00:17:40,370
read out the entire rail to me like I

395
00:17:38,809 --> 00:17:43,820
was a four-year-old which is exactly

396
00:17:40,370 --> 00:17:47,689
what<font color="#E5E5E5"> I wanted eventually we got</font><font color="#CCCCCC"> to the</font>

397
00:17:43,820 --> 00:17:50,389
<font color="#CCCCCC">pasture reset form except we ran into a</font>

398
00:17:47,690 --> 00:17:52,370
couple problems problem one was that I

399
00:17:50,390 --> 00:17:54,440
didn't have<font color="#E5E5E5"> access to</font><font color="#CCCCCC"> christinas email</font>

400
00:17:52,370 --> 00:17:56,270
to<font color="#E5E5E5"> get the password so even though if we</font>

401
00:17:54,440 --> 00:17:57,590
happen to<font color="#E5E5E5"> got the password reset I</font>

402
00:17:56,270 --> 00:17:59,450
couldn't<font color="#E5E5E5"> have seen that password because</font>

403
00:17:57,590 --> 00:18:02,149
I didn't have access to<font color="#CCCCCC"> christinas email</font>

404
00:17:59,450 --> 00:18:04,160
the<font color="#E5E5E5"> solution</font><font color="#CCCCCC"> was I was pretending</font><font color="#E5E5E5"> to</font>

405
00:18:02,150 --> 00:18:06,050
have so many<font color="#E5E5E5"> issues with the reset form</font>

406
00:18:04,160 --> 00:18:07,730
that he eventually just did it for<font color="#CCCCCC"> me</font>

407
00:18:06,050 --> 00:18:11,360
and read the password to me over the

408
00:18:07,730 --> 00:18:14,120
phone but we ran into a second problem

409
00:18:11,360 --> 00:18:16,189
and this<font color="#E5E5E5"> one was tricky they were using</font>

410
00:18:14,120 --> 00:18:18,559
a good technical technical defense in

411
00:18:16,190 --> 00:18:20,420
that they<font color="#E5E5E5"> were they were using to FA</font>

412
00:18:18,559 --> 00:18:22,100
tokens so even though I could log into

413
00:18:20,420 --> 00:18:26,210
her account I couldn't get past the two

414
00:18:22,100 --> 00:18:28,669
of a prompt and they were<font color="#E5E5E5"> using a to f a</font>

415
00:18:26,210 --> 00:18:32,290
token application installed on users

416
00:18:28,670 --> 00:18:34,700
phones but I got around this by saying I

417
00:18:32,290 --> 00:18:37,700
accidentally erased my iphone while i

418
00:18:34,700 --> 00:18:41,030
was on holidays and the solution<font color="#E5E5E5"> to that</font>

419
00:18:37,700 --> 00:18:43,190
was<font color="#E5E5E5"> he said that's</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> Christina let me</font>

420
00:18:41,030 --> 00:18:45,678
see what I can do and after a big back

421
00:18:43,190 --> 00:18:48,530
and<font color="#CCCCCC"> forth I miraculously had a four-day</font>

422
00:18:45,679 --> 00:18:51,740
hard to f a token to use and abuse which

423
00:18:48,530 --> 00:18:52,970
completely defeated the reason which

424
00:18:51,740 --> 00:18:55,600
completely defeated the purpose of

425
00:18:52,970 --> 00:18:58,700
having a<font color="#CCCCCC"> 2 if a token in the first place</font>

426
00:18:55,600 --> 00:19:00,580
meaning that<font color="#E5E5E5"> this helpdesk customer</font>

427
00:18:58,700 --> 00:19:03,440
support agent was able to bypass

428
00:19:00,580 --> 00:19:06,139
hardtack a good hard technical controls

429
00:19:03,440 --> 00:19:08,030
that were put in place and was able to

430
00:19:06,140 --> 00:19:12,350
<font color="#E5E5E5">bypass it to the point of giving me a</font>

431
00:19:08,030 --> 00:19:15,470
hard<font color="#CCCCCC"> turcan so now with my newfound</font>

432
00:19:12,350 --> 00:19:17,480
password my newfound TFA token<font color="#E5E5E5"> I had</font>

433
00:19:15,470 --> 00:19:19,760
access<font color="#CCCCCC"> to their VPN which meant i had</font>

434
00:19:17,480 --> 00:19:21,230
access to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> citrix rdp application</font>

435
00:19:19,760 --> 00:19:27,250
which meant i had access to the internal

436
00:19:21,230 --> 00:19:27,250
network<font color="#CCCCCC"> ok sir from there</font>

437
00:19:29,370 --> 00:19:33,040
taking<font color="#E5E5E5"> over from the</font><font color="#CCCCCC"> level of access we</font>

438
00:19:31,780 --> 00:19:35,350
were able to<font color="#E5E5E5"> gain from social</font>

439
00:19:33,040 --> 00:19:37,510
engineering this particular<font color="#E5E5E5"> corporation</font>

440
00:19:35,350 --> 00:19:41,139
was a little bit trickier than the one I

441
00:19:37,510 --> 00:19:43,480
had presented about before so once we

442
00:19:41,140 --> 00:19:45,580
were on their internal network we

443
00:19:43,480 --> 00:19:48,040
weren't<font color="#CCCCCC"> able to find</font><font color="#E5E5E5"> many internal hosts</font>

444
00:19:45,580 --> 00:19:51,010
or applications by simply scanning their

445
00:19:48,040 --> 00:19:53,860
internal IP ranges with a tool like and

446
00:19:51,010 --> 00:19:56,980
map before I found<font color="#E5E5E5"> this a bit odd and</font>

447
00:19:53,860 --> 00:19:58,990
decided to<font color="#E5E5E5"> revamp our recon game to see</font>

448
00:19:56,980 --> 00:20:02,230
if internal applications were being

449
00:19:58,990 --> 00:20:03,700
hosted elsewhere for this application it

450
00:20:02,230 --> 00:20:05,920
turns out that this big corporation

451
00:20:03,700 --> 00:20:08,350
decided to<font color="#E5E5E5"> hurst all of the internal and</font>

452
00:20:05,920 --> 00:20:10,360
development boxes in the cloud where

453
00:20:08,350 --> 00:20:13,510
access was limited to only those who

454
00:20:10,360 --> 00:20:16,330
were whitelisted IP dress wise so

455
00:20:13,510 --> 00:20:18,820
naturally<font color="#CCCCCC"> now that we had over 1,000</font>

456
00:20:16,330 --> 00:20:20,350
potential hosts to scour through i went

457
00:20:18,820 --> 00:20:23,169
through most of them<font color="#CCCCCC"> and picked the</font>

458
00:20:20,350 --> 00:20:26,590
low-hanging fruit so to do this we used

459
00:20:23,170 --> 00:20:28,150
a combination of sorry dns scanners we

460
00:20:26,590 --> 00:20:29,889
use sub<font color="#E5E5E5"> route which is like a</font>

461
00:20:28,150 --> 00:20:33,430
multi-threaded subdomain brute forces

462
00:20:29,890 --> 00:20:38,140
that utilizes open dns resolvers<font color="#CCCCCC"> dns</font>

463
00:20:33,430 --> 00:20:40,110
dumpster uses data from<font color="#E5E5E5"> scans</font><font color="#CCCCCC"> tire</font><font color="#E5E5E5"> and</font>

464
00:20:38,140 --> 00:20:43,600
<font color="#E5E5E5">internet scans to find subdomains</font>

465
00:20:40,110 --> 00:20:47,320
passively census io scans<font color="#CCCCCC"> Ian's net</font><font color="#E5E5E5"> very</font>

466
00:20:43,600 --> 00:20:49,120
often about once a week or so to<font color="#E5E5E5"> n</font>

467
00:20:47,320 --> 00:20:51,730
<font color="#E5E5E5">catalogs all ssl certificates and other</font>

468
00:20:49,120 --> 00:20:53,800
important metadata usually including

469
00:20:51,730 --> 00:20:56,200
subdomains which is also passive and

470
00:20:53,800 --> 00:20:58,510
scans or IO which dumps<font color="#CCCCCC"> our raw active</font>

471
00:20:56,200 --> 00:21:01,510
scans of the<font color="#CCCCCC"> internet which is</font><font color="#E5E5E5"> also</font>

472
00:20:58,510 --> 00:21:03,850
hosted by sensors so using all these

473
00:21:01,510 --> 00:21:08,050
<font color="#E5E5E5">four tools we got an incredibly large</font>

474
00:21:03,850 --> 00:21:09,820
list of domains and even<font color="#E5E5E5"> after years of</font>

475
00:21:08,050 --> 00:21:14,250
pen testing<font color="#CCCCCC"> I'm still pleasantly</font>

476
00:21:09,820 --> 00:21:16,360
surprised when I see stuff like this<font color="#E5E5E5"> I</font>

477
00:21:14,250 --> 00:21:18,510
remember seeing tom cat boxes with

478
00:21:16,360 --> 00:21:25,360
default creds when<font color="#E5E5E5"> I was 13 and it's now</font>

479
00:21:18,510 --> 00:21:27,790
2016 and this shit's still here through

480
00:21:25,360 --> 00:21:30,100
tom cat boxes alone<font color="#CCCCCC"> i was able to</font><font color="#E5E5E5"> get</font>

481
00:21:27,790 --> 00:21:32,230
gain shell on 12 boxes throughout this

482
00:21:30,100 --> 00:21:34,679
corporations network by simply compiling

483
00:21:32,230 --> 00:21:37,600
a reverse shell in a war format through

484
00:21:34,680 --> 00:21:38,230
<font color="#CCCCCC">metasploit or similar then uploading it</font>

485
00:21:37,600 --> 00:21:43,260
through

486
00:21:38,230 --> 00:21:45,730
the panel and<font color="#CCCCCC"> Princeton repeat</font><font color="#E5E5E5"> 12 times</font>

487
00:21:43,260 --> 00:21:48,520
from there it didn't take long for us to

488
00:21:45,730 --> 00:21:51,070
locate their core development boxes and

489
00:21:48,520 --> 00:21:53,530
these development boxes were gold mines

490
00:21:51,070 --> 00:21:54,909
all three core development boxes that we

491
00:21:53,530 --> 00:21:57,668
were able to<font color="#E5E5E5"> access have the same</font>

492
00:21:54,910 --> 00:21:59,919
default username and password<font color="#E5E5E5"> and after</font>

493
00:21:57,669 --> 00:22:03,549
a bit<font color="#E5E5E5"> of searching with the within the</font>

494
00:21:59,919 --> 00:22:06,340
Drupal administration panel I realized

495
00:22:03,549 --> 00:22:09,070
<font color="#E5E5E5">that the devil dot module was enabled</font>

496
00:22:06,340 --> 00:22:11,860
meaning out of the box arbitrary PHP

497
00:22:09,070 --> 00:22:15,700
execution because<font color="#E5E5E5"> it provides a large</font>

498
00:22:11,860 --> 00:22:19,780
text area for entering PHP code into so

499
00:22:15,700 --> 00:22:22,210
it was just<font color="#E5E5E5"> there for us but</font>

500
00:22:19,780 --> 00:22:25,240
surprisingly this<font color="#CCCCCC"> pig corporation was</font>

501
00:22:22,210 --> 00:22:27,250
copying direct backups of the production

502
00:22:25,240 --> 00:22:30,040
<font color="#CCCCCC">environment and using them on their</font>

503
00:22:27,250 --> 00:22:32,230
development environments this included

504
00:22:30,040 --> 00:22:35,950
all<font color="#CCCCCC"> the data all</font><font color="#E5E5E5"> the data within their</font>

505
00:22:32,230 --> 00:22:37,960
databases as well and as per the dates<font color="#E5E5E5"> I</font>

506
00:22:35,950 --> 00:22:39,940
<font color="#E5E5E5">obtained it seems like a weekly or</font>

507
00:22:37,960 --> 00:22:41,950
<font color="#E5E5E5">bi-weekly process that you're coughing</font>

508
00:22:39,940 --> 00:22:44,440
that they were copying fraud to death

509
00:22:41,950 --> 00:22:46,870
and at this point we had<font color="#E5E5E5"> found a</font><font color="#CCCCCC"> total</font>

510
00:22:44,440 --> 00:22:51,640
<font color="#E5E5E5">of three Drupal administration panels</font>

511
00:22:46,870 --> 00:22:53,500
and we could then take those credentials

512
00:22:51,640 --> 00:22:58,049
and log<font color="#E5E5E5"> into their my sequel server to</font>

513
00:22:53,500 --> 00:23:00,520
get production<font color="#E5E5E5"> database data which had</font>

514
00:22:58,049 --> 00:23:02,710
each database had their<font color="#E5E5E5"> own Twitter</font>

515
00:23:00,520 --> 00:23:06,010
account some had to some had obviously

516
00:23:02,710 --> 00:23:10,510
200,000 followers and every database we

517
00:23:06,010 --> 00:23:12,070
found contained active user data on this

518
00:23:10,510 --> 00:23:13,690
year's we also found plain text

519
00:23:12,070 --> 00:23:15,520
documents filled with passwords and

520
00:23:13,690 --> 00:23:18,790
various other environments as<font color="#CCCCCC"> well as</font>

521
00:23:15,520 --> 00:23:20,740
well as unprotected NDA documents just

522
00:23:18,790 --> 00:23:25,510
floating around for every user in his

523
00:23:20,740 --> 00:23:28,990
company to see<font color="#E5E5E5"> okay what went wrong</font><font color="#CCCCCC"> this</font>

524
00:23:25,510 --> 00:23:32,350
time in this<font color="#E5E5E5"> case it really only took</font>

525
00:23:28,990 --> 00:23:34,090
one person the person over the phone

526
00:23:32,350 --> 00:23:36,520
<font color="#CCCCCC">that was trying to</font><font color="#E5E5E5"> help me reset my</font>

527
00:23:34,090 --> 00:23:38,470
password should not have had access<font color="#E5E5E5"> to</font>

528
00:23:36,520 --> 00:23:42,040
bypass hard technical controls that were

529
00:23:38,470 --> 00:23:43,990
<font color="#E5E5E5">put in</font><font color="#CCCCCC"> place for a reason he was a lower</font>

530
00:23:42,040 --> 00:23:46,780
level customer<font color="#CCCCCC"> support agent that was</font>

531
00:23:43,990 --> 00:23:49,090
<font color="#E5E5E5">able to bypass a2f a mechanism that</font><font color="#CCCCCC"> was</font>

532
00:23:46,780 --> 00:23:51,299
put in place<font color="#E5E5E5"> for exactly this reason and</font>

533
00:23:49,090 --> 00:23:53,070
to reiterate

534
00:23:51,299 --> 00:23:55,379
this was not a fancy or complicated

535
00:23:53,070 --> 00:23:57,899
attack it came down to the simple reason

536
00:23:55,379 --> 00:24:00,149
that we do not enforce the same<font color="#E5E5E5"> level of</font>

537
00:23:57,899 --> 00:24:05,820
security on humans compared<font color="#E5E5E5"> to the</font>

538
00:24:00,149 --> 00:24:10,110
systems that<font color="#E5E5E5"> they control so to sum up</font>

539
00:24:05,820 --> 00:24:12,418
this talk just as there are security

540
00:24:10,110 --> 00:24:17,248
roles in systems the same role system

541
00:24:12,419 --> 00:24:19,049
should apply<font color="#E5E5E5"> to humans am i running a</font>

542
00:24:17,249 --> 00:24:20,549
little<font color="#CCCCCC"> early answer k if a person</font>

543
00:24:19,049 --> 00:24:22,830
doesn't absolutely need to<font color="#CCCCCC"> have access</font>

544
00:24:20,549 --> 00:24:25,379
<font color="#E5E5E5">to a share a piece of information do not</font>

545
00:24:22,830 --> 00:24:29,539
grant it well this achieves is creating

546
00:24:25,379 --> 00:24:29,539
a larger<font color="#E5E5E5"> surface area for future attacks</font>

547
00:24:30,169 --> 00:24:34,499
so yes we need to conform to a

548
00:24:32,850 --> 00:24:36,209
permissions model for or assets

549
00:24:34,499 --> 00:24:37,649
information on a need-to-know basis if

550
00:24:36,210 --> 00:24:39,059
someone does not need to<font color="#CCCCCC"> have access</font><font color="#E5E5E5"> to</font>

551
00:24:37,649 --> 00:24:42,899
a piece of information do not grant it

552
00:24:39,059 --> 00:24:45,690
<font color="#CCCCCC">to them and to sum this all up assume</font>

553
00:24:42,899 --> 00:24:47,668
humans will make<font color="#E5E5E5"> mistakes be paranoid</font>

554
00:24:45,690 --> 00:24:51,509
assume<font color="#CCCCCC"> your environment is already owned</font>

555
00:24:47,669 --> 00:24:52,830
do not reply rely on users to report if

556
00:24:51,509 --> 00:24:56,549
they've been earned or if they've done

557
00:24:52,830 --> 00:24:59,908
<font color="#CCCCCC">something</font><font color="#E5E5E5"> wrong six simple steps I like</font>

558
00:24:56,549 --> 00:25:02,820
<font color="#E5E5E5">to go through that will reduce some of</font>

559
00:24:59,909 --> 00:25:05,820
these<font color="#CCCCCC"> attacks happening is implement</font>

560
00:25:02,820 --> 00:25:08,129
anti spoofing<font color="#CCCCCC"> DSP FDA md marker there</font>

561
00:25:05,820 --> 00:25:09,809
for a reason sandbox your browser and

562
00:25:08,129 --> 00:25:10,980
email clients or even if you use it does

563
00:25:09,809 --> 00:25:12,269
<font color="#E5E5E5">something wrong or downloads and</font>

564
00:25:10,980 --> 00:25:14,429
executable<font color="#CCCCCC"> or</font><font color="#E5E5E5"> download something</font>

565
00:25:12,269 --> 00:25:17,460
malicious at<font color="#E5E5E5"> least those environments to</font>

566
00:25:14,429 --> 00:25:20,309
sandboxed use browser plugins such as no

567
00:25:17,460 --> 00:25:22,499
scripts or there's a bunch moment<font color="#CCCCCC"> I</font>

568
00:25:20,309 --> 00:25:25,769
can't think of<font color="#CCCCCC"> right</font><font color="#E5E5E5"> now to reduce the</font>

569
00:25:22,499 --> 00:25:28,470
risk of a user doing something wrong one

570
00:25:25,769 --> 00:25:30,840
thing I've seen some clients do which is

571
00:25:28,470 --> 00:25:32,999
<font color="#E5E5E5">really</font><font color="#CCCCCC"> interesting is they alert on</font>

572
00:25:30,840 --> 00:25:34,980
similar fishing domains so when I

573
00:25:32,999 --> 00:25:37,109
typically start up a social engineering

574
00:25:34,980 --> 00:25:39,359
campaign I will register domains that

575
00:25:37,109 --> 00:25:43,289
look visually similar to whoever the

576
00:25:39,359 --> 00:25:45,449
target company<font color="#CCCCCC"> I'm targeting is and a</font>

577
00:25:43,289 --> 00:25:47,999
lot of compass sorry so some companies

578
00:25:45,450 --> 00:25:49,739
these days are alerting on any similar

579
00:25:47,999 --> 00:25:51,480
domain name registrations using

580
00:25:49,739 --> 00:25:53,279
something like URL crazy and then going

581
00:25:51,480 --> 00:25:56,639
<font color="#E5E5E5">through all of those similar domain name</font>

582
00:25:53,279 --> 00:26:00,149
domain names so learning on those could

583
00:25:56,639 --> 00:26:03,389
be handy five is whitelist your

584
00:26:00,149 --> 00:26:05,699
applications and specific IPS as well

585
00:26:03,389 --> 00:26:09,809
six use a VPN but I think everyone does

586
00:26:05,700 --> 00:26:13,109
that<font color="#E5E5E5"> these days and before we end this</font>

587
00:26:09,809 --> 00:26:15,209
talk I found this amazing video from

588
00:26:13,109 --> 00:26:18,178
probably<font color="#CCCCCC"> before we were before I was</font>

589
00:26:15,209 --> 00:26:30,779
born that sums up this talk pretty

590
00:26:18,179 --> 00:26:32,429
perfectly<font color="#CCCCCC"> alright got it okay you might</font>

591
00:26:30,779 --> 00:26:35,959
as<font color="#CCCCCC"> well give me the keys to the front</font>

592
00:26:32,429 --> 00:26:39,679
door I'm going<font color="#CCCCCC"> to get into your system</font>

593
00:26:35,959 --> 00:26:42,239
I'm going<font color="#E5E5E5"> to get my hands on your dad</font>

594
00:26:39,679 --> 00:26:44,639
I'll probably have more access to<font color="#E5E5E5"> more</font>

595
00:26:42,239 --> 00:26:49,739
areas of<font color="#E5E5E5"> your computer network than most</font>

596
00:26:44,639 --> 00:26:52,199
employees and trust me i'm<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to take</font>

597
00:26:49,739 --> 00:26:54,359
advantage<font color="#CCCCCC"> of it someone got my password</font>

598
00:26:52,200 --> 00:26:58,469
and used it to break him to the network

599
00:26:54,359 --> 00:26:59,759
well he he even had a toolbox I didn't

600
00:26:58,469 --> 00:27:02,159
think<font color="#E5E5E5"> anything of it when I saw</font><font color="#CCCCCC"> that guy</font>

601
00:26:59,759 --> 00:27:06,570
digging through the dumpster so I gave

602
00:27:02,159 --> 00:27:08,479
her<font color="#CCCCCC"> the information she needed how was I</font>

603
00:27:06,570 --> 00:27:11,249
supposed to know she was a hacker

604
00:27:08,479 --> 00:27:13,469
sometimes when I'm targeting a company

605
00:27:11,249 --> 00:27:16,529
I'm<font color="#E5E5E5"> looking for something very specific</font>

606
00:27:13,469 --> 00:27:19,339
and at other times it's a fishing

607
00:27:16,529 --> 00:27:21,899
<font color="#E5E5E5">expedition I never know what a minimum</font>

608
00:27:19,339 --> 00:27:23,849
usually when you think hackers you think

609
00:27:21,899 --> 00:27:26,189
computers and the data stored in those

610
00:27:23,849 --> 00:27:28,799
computers but hackers also try<font color="#E5E5E5"> to get</font>

611
00:27:26,190 --> 00:27:30,690
their hands on data kept on paper or in

612
00:27:28,799 --> 00:27:33,989
our heads most of you make it pretty

613
00:27:30,690 --> 00:27:36,329
easy do you know<font color="#E5E5E5"> that it took</font><font color="#CCCCCC"> me less</font>

614
00:27:33,989 --> 00:27:43,549
than a minute to install<font color="#CCCCCC"> it on the guy's</font>

615
00:27:36,329 --> 00:27:47,129
computer love money a sex curse words

616
00:27:43,549 --> 00:27:49,229
hacking is easy it's<font color="#E5E5E5"> really no challenge</font>

617
00:27:47,129 --> 00:27:52,289
at all to break in when you use names

618
00:27:49,229 --> 00:27:55,259
for passwords and I'm into your system

619
00:27:52,289 --> 00:27:59,279
heck I've even seen people who leave the

620
00:27:55,259 --> 00:28:01,950
password section blank like a weekend in

621
00:27:59,279 --> 00:28:04,639
one letter are five letters in a row on

622
00:28:01,950 --> 00:28:04,639
<font color="#CCCCCC">the keyboard</font>

623
00:28:05,319 --> 00:28:09,949
why don't you just go<font color="#E5E5E5"> ahead and go in</font>

624
00:28:07,879 --> 00:28:12,589
<font color="#CCCCCC">okay and have one</font><font color="#E5E5E5"> of the computer guys</font>

625
00:28:09,949 --> 00:28:14,029
vouch for you that's great thanks a<font color="#E5E5E5"> lot</font>

626
00:28:12,589 --> 00:28:17,418
it's nice to have somebody<font color="#E5E5E5"> help me make</font>

627
00:28:14,029 --> 00:28:19,399
my job easy don't do this computer

628
00:28:17,419 --> 00:28:22,009
services Bob speaker yeah hi Bob this<font color="#E5E5E5"> is</font>

629
00:28:19,399 --> 00:28:24,079
<font color="#E5E5E5">david michaels from marketing operations</font>

630
00:28:22,009 --> 00:28:26,719
this is Barbara yeah hi Barbara this is

631
00:28:24,079 --> 00:28:28,908
Bob Kendall from network services I know

632
00:28:26,719 --> 00:28:34,189
this sounds silly my<font color="#E5E5E5"> password was</font>

633
00:28:28,909 --> 00:28:37,309
password<font color="#E5E5E5"> okay a computer and password</font>

634
00:28:34,189 --> 00:28:40,729
all right you<font color="#CCCCCC"> are sorry thanks a lot you</font>

635
00:28:37,309 --> 00:28:45,949
<font color="#E5E5E5">have a good one oh my god that was so</font>

636
00:28:40,729 --> 00:28:48,799
<font color="#CCCCCC">easy thanks from me and the kids you're</font>

637
00:28:45,949 --> 00:28:51,259
welcome what just<font color="#E5E5E5"> happened</font><font color="#CCCCCC"> I was</font>

638
00:28:48,799 --> 00:28:53,629
<font color="#CCCCCC">thinking it's nice to do a good deed the</font>

639
00:28:51,259 --> 00:28:56,059
lane the hacker is thinking<font color="#E5E5E5"> gotcha you'd</font>

640
00:28:53,629 --> 00:28:58,579
be amazed at how quickly a password gets

641
00:28:56,059 --> 00:29:01,219
passed around once it leaves the safety

642
00:28:58,579 --> 00:29:06,789
of your memory there's no telling where

643
00:29:01,219 --> 00:29:06,789
it might end up<font color="#E5E5E5"> okay thank you</font>

644
00:29:12,529 --> 00:29:31,649
questions oh come<font color="#CCCCCC"> on yes no next no</font>

645
00:29:27,509 --> 00:29:32,999
questions not at all okay if anyone

646
00:29:31,649 --> 00:29:35,279
<font color="#E5E5E5">decides they have questions I'll be</font>

647
00:29:32,999 --> 00:29:38,779
around<font color="#E5E5E5"> all day and all night and</font>

648
00:29:35,279 --> 00:29:38,779
tomorrow thank you

