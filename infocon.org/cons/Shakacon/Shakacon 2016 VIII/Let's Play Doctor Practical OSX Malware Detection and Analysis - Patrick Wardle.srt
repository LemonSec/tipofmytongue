1
00:00:00,000 --> 00:00:04,380
<font color="#E5E5E5">how's</font><font color="#CCCCCC"> it guys before I start I just</font>

2
00:00:02,460 --> 00:00:06,660
wanna say<font color="#E5E5E5"> big Mahalo to Chaka Khan and</font>

3
00:00:04,380 --> 00:00:07,410
all of you<font color="#E5E5E5"> for</font><font color="#CCCCCC"> attending this</font><font color="#E5E5E5"> is</font>

4
00:00:06,660 --> 00:00:09,480
definitely<font color="#E5E5E5"> one of my favorite</font>

5
00:00:07,410 --> 00:00:12,599
conferences<font color="#E5E5E5"> get to</font><font color="#CCCCCC"> rock slippers hang</font>

6
00:00:09,480 --> 00:00:15,000
out and you<font color="#E5E5E5"> know Oahu</font><font color="#CCCCCC"> so pretty cool all</font>

7
00:00:12,599 --> 00:00:18,509
<font color="#E5E5E5">right</font><font color="#CCCCCC"> so today let's talk about</font><font color="#E5E5E5"> playing</font>

8
00:00:15,000 --> 00:00:20,698
doctor so my name<font color="#CCCCCC"> is Patrick</font><font color="#E5E5E5"> Wardle I've</font>

9
00:00:18,510 --> 00:00:22,890
worked at a bunch<font color="#CCCCCC"> of acronyms places</font>

10
00:00:20,699 --> 00:00:24,480
including the NSA which I always<font color="#E5E5E5"> joke is</font>

11
00:00:22,890 --> 00:00:29,730
the only<font color="#E5E5E5"> government agency</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> actually</font>

12
00:00:24,480 --> 00:00:32,040
listens yeah yeah I know<font color="#CCCCCC"> so now I'm</font><font color="#E5E5E5"> the</font>

13
00:00:29,730 --> 00:00:33,989
director of<font color="#CCCCCC"> R&D at Cenac</font><font color="#E5E5E5"> so Cenac does</font>

14
00:00:32,040 --> 00:00:36,450
<font color="#E5E5E5">crowd-sourced vulnerability discovery</font>

15
00:00:33,989 --> 00:00:38,339
<font color="#E5E5E5">currently we think that humans in</font>

16
00:00:36,450 --> 00:00:40,379
conjunction with machines and<font color="#E5E5E5"> software</font>

17
00:00:38,340 --> 00:00:42,120
<font color="#CCCCCC">the best</font><font color="#E5E5E5"> way at finding security</font>

18
00:00:40,379 --> 00:00:44,519
vulnerabilities<font color="#E5E5E5"> so in a secure</font>

19
00:00:42,120 --> 00:00:46,500
<font color="#CCCCCC">environment we crowdsource</font><font color="#E5E5E5"> bug finding</font>

20
00:00:44,520 --> 00:00:47,940
<font color="#E5E5E5">with pretty good results</font><font color="#CCCCCC"> so if you're a</font>

21
00:00:46,500 --> 00:00:49,469
<font color="#E5E5E5">company</font><font color="#CCCCCC"> and you're interested in kind</font><font color="#E5E5E5"> of</font>

22
00:00:47,940 --> 00:00:51,718
having a bug<font color="#E5E5E5"> bounty program check us out</font>

23
00:00:49,469 --> 00:00:53,370
if you're a hacker<font color="#CCCCCC"> or researcher and</font>

24
00:00:51,719 --> 00:00:55,440
want to<font color="#E5E5E5"> get paid to legally find</font>

25
00:00:53,370 --> 00:00:57,089
<font color="#E5E5E5">vulnerabilities in our customer software</font>

26
00:00:55,440 --> 00:00:59,608
which is really<font color="#E5E5E5"> bad</font>

27
00:00:57,090 --> 00:01:01,530
definitely check<font color="#E5E5E5"> us out as well now the</font>

28
00:00:59,609 --> 00:01:03,629
internal<font color="#E5E5E5"> R&D team does meet</font>

29
00:01:01,530 --> 00:01:05,700
<font color="#E5E5E5">cybersecurity</font><font color="#CCCCCC"> research on current</font>

30
00:01:03,629 --> 00:01:09,298
threats such as OSX malware which is

31
00:01:05,700 --> 00:01:11,040
what I will<font color="#E5E5E5"> be talking about today all</font>

32
00:01:09,299 --> 00:01:13,110
<font color="#E5E5E5">right so the goal</font><font color="#CCCCCC"> of today's talk is to</font>

33
00:01:11,040 --> 00:01:16,530
provide<font color="#E5E5E5"> a practical overview of how to</font>

34
00:01:13,110 --> 00:01:18,840
detect and perform malware analysis<font color="#E5E5E5"> for</font>

35
00:01:16,530 --> 00:01:20,960
<font color="#CCCCCC">example on your personal Mac so I'm</font>

36
00:01:18,840 --> 00:01:23,640
assuming most<font color="#E5E5E5"> of</font><font color="#CCCCCC"> you guys</font><font color="#E5E5E5"> and girls are</font>

37
00:01:20,960 --> 00:01:25,080
computer people<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> know we all have</font>

38
00:01:23,640 --> 00:01:27,060
friends<font color="#E5E5E5"> and parents</font><font color="#CCCCCC"> and relatives</font><font color="#E5E5E5"> and</font>

39
00:01:25,080 --> 00:01:29,460
<font color="#E5E5E5">what do they always ask us one can you</font>

40
00:01:27,060 --> 00:01:31,259
<font color="#CCCCCC">build us a website or an app</font><font color="#E5E5E5"> - I think</font>

41
00:01:29,460 --> 00:01:33,360
<font color="#E5E5E5">my computer is infected</font><font color="#CCCCCC"> you know please</font>

42
00:01:31,259 --> 00:01:35,100
please fix it and<font color="#E5E5E5"> this is exactly what</font>

43
00:01:33,360 --> 00:01:36,840
happened to me about<font color="#CCCCCC"> a year two ago</font>

44
00:01:35,100 --> 00:01:39,030
except my<font color="#E5E5E5"> friend had a Mac computer he</font>

45
00:01:36,840 --> 00:01:41,159
said hey I think<font color="#E5E5E5"> it's infected</font><font color="#CCCCCC"> can you</font>

46
00:01:39,030 --> 00:01:42,390
call him look at it<font color="#CCCCCC"> and he shaped</font>

47
00:01:41,159 --> 00:01:44,240
surfboards<font color="#CCCCCC"> and said he'd give me</font><font color="#E5E5E5"> a</font>

48
00:01:42,390 --> 00:01:46,530
discount<font color="#E5E5E5"> on a board so I said totally</font>

49
00:01:44,240 --> 00:01:48,059
<font color="#E5E5E5">but the problem was my background was in</font>

50
00:01:46,530 --> 00:01:50,130
<font color="#E5E5E5">Windows I've done a lot of</font><font color="#CCCCCC"> Windows</font>

51
00:01:48,060 --> 00:01:52,170
malware analysis<font color="#E5E5E5"> windows exploitation</font>

52
00:01:50,130 --> 00:01:54,030
<font color="#CCCCCC">windows forensics</font><font color="#E5E5E5"> but Mac was kind of</font>

53
00:01:52,170 --> 00:01:57,630
all<font color="#E5E5E5"> all new to me so I really</font><font color="#CCCCCC"> had kind</font>

54
00:01:54,030 --> 00:01:59,340
<font color="#CCCCCC">of no idea what to do so</font><font color="#E5E5E5"> today's talk is</font>

55
00:01:57,630 --> 00:02:00,839
kind<font color="#E5E5E5"> of a knowledge dump of what I've</font>

56
00:01:59,340 --> 00:02:03,810
<font color="#E5E5E5">learned</font><font color="#CCCCCC"> over the last</font><font color="#E5E5E5"> few years</font>

57
00:02:00,840 --> 00:02:05,430
<font color="#E5E5E5">basically</font><font color="#CCCCCC"> it's what I wish I had the</font>

58
00:02:03,810 --> 00:02:07,770
knowledge I had when I started<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> Mac</font>

59
00:02:05,430 --> 00:02:09,090
malware analysis a few years ago so

60
00:02:07,770 --> 00:02:11,670
today's<font color="#E5E5E5"> talk is going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be broken down</font>

61
00:02:09,090 --> 00:02:13,740
into five parts<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going to start with</font>

62
00:02:11,670 --> 00:02:16,440
a brief technical<font color="#CCCCCC"> overview of Rhys</font>

63
00:02:13,740 --> 00:02:18,750
OS<font color="#E5E5E5"> X and our threats outbreaks and</font>

64
00:02:16,440 --> 00:02:20,490
infections<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> then going to study and</font>

65
00:02:18,750 --> 00:02:24,240
discuss<font color="#CCCCCC"> some</font><font color="#E5E5E5"> of the commonalities and</font>

66
00:02:20,490 --> 00:02:25,980
trends we see<font color="#E5E5E5"> in this OSX malware part 3</font>

67
00:02:24,240 --> 00:02:29,100
we're<font color="#E5E5E5"> gonna talk</font><font color="#CCCCCC"> about how</font><font color="#E5E5E5"> to diagnose a</font>

68
00:02:25,980 --> 00:02:31,230
suspected infection<font color="#E5E5E5"> before we</font><font color="#CCCCCC"> go talk</font>

69
00:02:29,100 --> 00:02:32,730
about<font color="#CCCCCC"> how to analyze</font><font color="#E5E5E5"> files if you think</font>

70
00:02:31,230 --> 00:02:34,350
<font color="#E5E5E5">perhaps they are malware or are</font>

71
00:02:32,730 --> 00:02:36,420
malicious<font color="#E5E5E5"> and then finally we're</font><font color="#CCCCCC"> going</font>

72
00:02:34,350 --> 00:02:37,859
to<font color="#E5E5E5"> talk about some suggestions about you</font>

73
00:02:36,420 --> 00:02:41,280
know good practices how to keep your

74
00:02:37,860 --> 00:02:43,110
Apple or Mac computer secure<font color="#CCCCCC"> alright so</font>

75
00:02:41,280 --> 00:02:45,630
let's start<font color="#E5E5E5"> by looking at several recent</font>

76
00:02:43,110 --> 00:02:47,730
OSX malware specimens<font color="#CCCCCC"> this will give us</font>

77
00:02:45,630 --> 00:02:50,100
a good idea<font color="#E5E5E5"> kind of the current threat</font>

78
00:02:47,730 --> 00:02:52,260
<font color="#E5E5E5">you know the threat landscape what what</font>

79
00:02:50,100 --> 00:02:53,280
Mac Bower looks at these days and then

80
00:02:52,260 --> 00:02:54,510
<font color="#E5E5E5">we'll be able to reference this malware</font>

81
00:02:53,280 --> 00:02:56,460
throughout the rest of<font color="#E5E5E5"> the presentation</font>

82
00:02:54,510 --> 00:02:58,290
<font color="#CCCCCC">when we</font><font color="#E5E5E5"> talk about specific techniques</font>

83
00:02:56,460 --> 00:03:02,430
<font color="#E5E5E5">so kind of give us a good practical</font>

84
00:02:58,290 --> 00:03:05,100
<font color="#E5E5E5">hands-on feel now</font><font color="#CCCCCC"> Apple tells us they</font>

85
00:03:02,430 --> 00:03:06,960
dearly care about our<font color="#E5E5E5"> security and</font>

86
00:03:05,100 --> 00:03:09,090
privacy<font color="#CCCCCC"> but that kind of beg to</font><font color="#E5E5E5"> differ I</font>

87
00:03:06,960 --> 00:03:12,180
think this is mostly marketing<font color="#E5E5E5"> so yes</font>

88
00:03:09,090 --> 00:03:14,790
max<font color="#E5E5E5"> do get malware and Mac Bower is</font>

89
00:03:12,180 --> 00:03:17,040
actually becoming<font color="#CCCCCC"> a growing</font><font color="#E5E5E5"> problem also</font>

90
00:03:14,790 --> 00:03:19,320
<font color="#CCCCCC">as</font><font color="#E5E5E5"> the Mac</font><font color="#CCCCCC"> security researcher</font><font color="#E5E5E5"> slash</font>

91
00:03:17,040 --> 00:03:21,450
hacker<font color="#CCCCCC"> you know if</font><font color="#E5E5E5"> I'm targeting a</font>

92
00:03:19,320 --> 00:03:24,120
network or a company<font color="#E5E5E5"> I'm gonna go after</font>

93
00:03:21,450 --> 00:03:25,500
the Mac computers first<font color="#E5E5E5"> recent versions</font>

94
00:03:24,120 --> 00:03:26,760
<font color="#E5E5E5">of Windows is actually pretty secure</font>

95
00:03:25,500 --> 00:03:28,650
Microsoft has done<font color="#CCCCCC"> a really good</font><font color="#E5E5E5"> job</font>

96
00:03:26,760 --> 00:03:30,450
<font color="#E5E5E5">with</font><font color="#CCCCCC"> a lot of pretty good</font><font color="#E5E5E5"> anti</font>

97
00:03:28,650 --> 00:03:32,700
exploitation mitigations hardening the

98
00:03:30,450 --> 00:03:35,459
operating system<font color="#E5E5E5"> Apple really hasn't</font>

99
00:03:32,700 --> 00:03:36,899
<font color="#E5E5E5">done quite as good of a</font><font color="#CCCCCC"> job or</font><font color="#E5E5E5"> they lag</font>

100
00:03:35,460 --> 00:03:38,550
a little<font color="#CCCCCC"> bit so Mac's are actually a</font>

101
00:03:36,900 --> 00:03:41,970
very<font color="#E5E5E5"> very soft target especially</font><font color="#CCCCCC"> when</font>

102
00:03:38,550 --> 00:03:43,860
compared to Windows<font color="#CCCCCC"> and Linux alright so</font>

103
00:03:41,970 --> 00:03:46,380
the first<font color="#CCCCCC"> Mac malware specimen</font><font color="#E5E5E5"> I want to</font>

104
00:03:43,860 --> 00:03:48,390
talk about is<font color="#CCCCCC"> eye worm</font><font color="#E5E5E5"> now contrary</font><font color="#CCCCCC"> to</font>

105
00:03:46,380 --> 00:03:50,820
its name<font color="#CCCCCC"> it is</font><font color="#E5E5E5"> not a worm at all it is</font>

106
00:03:48,390 --> 00:03:53,820
simply<font color="#CCCCCC"> a</font><font color="#E5E5E5"> Trojan backdoor it was</font>

107
00:03:50,820 --> 00:03:56,280
discovered late 2014<font color="#E5E5E5"> and it spread via</font>

108
00:03:53,820 --> 00:03:58,829
infected applications<font color="#CCCCCC"> basically a hacker</font>

109
00:03:56,280 --> 00:04:01,380
got<font color="#E5E5E5"> a bunch of popular applications such</font>

110
00:03:58,830 --> 00:04:02,760
as Photoshop<font color="#CCCCCC"> crack them</font><font color="#E5E5E5"> infected them</font>

111
00:04:01,380 --> 00:04:05,070
<font color="#CCCCCC">with this malware and then put him on</font>

112
00:04:02,760 --> 00:04:06,690
<font color="#E5E5E5">Pirate Bay so unsuspecting users who</font>

113
00:04:05,070 --> 00:04:09,269
wanted a free copy of<font color="#E5E5E5"> Photoshop would go</font>

114
00:04:06,690 --> 00:04:10,410
to<font color="#E5E5E5"> Pirate Bay download and execute what</font>

115
00:04:09,270 --> 00:04:13,590
they thought was<font color="#E5E5E5"> Photoshop and</font>

116
00:04:10,410 --> 00:04:14,910
inadvertently infected themselves<font color="#E5E5E5"> so</font>

117
00:04:13,590 --> 00:04:17,430
this piece of malware persists as a

118
00:04:14,910 --> 00:04:19,350
<font color="#E5E5E5">launch daemon launch demons are similar</font>

119
00:04:17,430 --> 00:04:21,630
to services on the<font color="#CCCCCC"> windows side of the</font>

120
00:04:19,350 --> 00:04:23,910
house and in terms of functionality<font color="#CCCCCC"> it</font>

121
00:04:21,630 --> 00:04:26,490
was a basic<font color="#CCCCCC"> back door so it could survey</font>

122
00:04:23,910 --> 00:04:27,460
the<font color="#CCCCCC"> Box</font><font color="#E5E5E5"> provide the attacker the ability</font>

123
00:04:26,490 --> 00:04:29,440
<font color="#CCCCCC">to download an exit</font>

124
00:04:27,460 --> 00:04:31,210
other code<font color="#E5E5E5"> really nothing amazing but</font>

125
00:04:29,440 --> 00:04:33,840
did<font color="#CCCCCC"> allow the attacker</font><font color="#E5E5E5"> to build a botnet</font>

126
00:04:31,210 --> 00:04:36,698
of about<font color="#CCCCCC"> 20,000 computers</font>

127
00:04:33,840 --> 00:04:39,219
next we've got hacking teams persistent

128
00:04:36,699 --> 00:04:41,590
<font color="#CCCCCC">Mac implant</font><font color="#E5E5E5"> and it was nice to analyze</font>

129
00:04:39,220 --> 00:04:43,360
this<font color="#E5E5E5"> because hacking team got hacked and</font>

130
00:04:41,590 --> 00:04:45,489
all the source<font color="#CCCCCC"> code for their tools and</font>

131
00:04:43,360 --> 00:04:46,870
<font color="#E5E5E5">their implant</font><font color="#CCCCCC"> scott released or leaked</font>

132
00:04:45,490 --> 00:04:48,699
on<font color="#E5E5E5"> the internet which</font><font color="#CCCCCC"> is nice</font><font color="#E5E5E5"> because</font>

133
00:04:46,870 --> 00:04:50,860
when we're normally analyzing malware we

134
00:04:48,699 --> 00:04:52,419
don't have source code so if we look at

135
00:04:50,860 --> 00:04:54,550
<font color="#CCCCCC">some of the source</font><font color="#E5E5E5"> code we can</font><font color="#CCCCCC"> see that</font>

136
00:04:52,419 --> 00:04:56,590
it supports a myriad of features for

137
00:04:54,550 --> 00:05:00,039
gathering intelligence<font color="#E5E5E5"> it's really all</font>

138
00:04:56,590 --> 00:05:02,169
about<font color="#E5E5E5"> surveillance</font><font color="#CCCCCC"> this piece</font><font color="#E5E5E5"> of malware</font>

139
00:05:00,039 --> 00:05:03,940
persists as a<font color="#E5E5E5"> launch agent which is</font>

140
00:05:02,169 --> 00:05:06,008
<font color="#E5E5E5">again similar</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> a launch daemon which</font>

141
00:05:03,940 --> 00:05:06,820
<font color="#E5E5E5">is again similar</font><font color="#CCCCCC"> to a service on the</font>

142
00:05:06,009 --> 00:05:09,009
<font color="#E5E5E5">Windows platform</font>

143
00:05:06,820 --> 00:05:10,479
and you know like as mentioned it had

144
00:05:09,009 --> 00:05:12,699
some interesting<font color="#CCCCCC"> things for gathering</font>

145
00:05:10,479 --> 00:05:14,080
intelligence so audio keylogging stuff

146
00:05:12,699 --> 00:05:15,820
like that<font color="#E5E5E5"> it also had a rootkit</font>

147
00:05:14,080 --> 00:05:19,889
component which is<font color="#E5E5E5"> something we really</font>

148
00:05:15,820 --> 00:05:22,539
<font color="#CCCCCC">don't</font><font color="#E5E5E5"> see that much on in</font><font color="#CCCCCC"> mac malware</font>

149
00:05:19,889 --> 00:05:24,880
another piece of OSX malware from 2015

150
00:05:22,539 --> 00:05:26,169
<font color="#E5E5E5">is</font><font color="#CCCCCC"> Xcode</font><font color="#E5E5E5"> ghost and cloud talked about</font>

151
00:05:24,880 --> 00:05:27,880
this yesterday went into a lot<font color="#CCCCCC"> of</font>

152
00:05:26,169 --> 00:05:30,549
details<font color="#CCCCCC"> and he was actually</font><font color="#E5E5E5"> the one</font><font color="#CCCCCC"> that</font>

153
00:05:27,880 --> 00:05:31,810
discovered<font color="#E5E5E5"> it so kudos</font><font color="#CCCCCC"> to him</font><font color="#E5E5E5"> and it's</font>

154
00:05:30,550 --> 00:05:33,699
you<font color="#E5E5E5"> know as</font><font color="#CCCCCC"> he</font><font color="#E5E5E5"> mentioned yesterday it's</font>

155
00:05:31,810 --> 00:05:35,289
a kind of<font color="#E5E5E5"> intriguing piece of malware</font>

156
00:05:33,699 --> 00:05:37,780
because<font color="#E5E5E5"> its goal is actually infect</font>

157
00:05:35,289 --> 00:05:39,729
<font color="#E5E5E5">illegitimate applications so a developer</font>

158
00:05:37,780 --> 00:05:41,138
as cloud mentioned will<font color="#E5E5E5"> download an</font>

159
00:05:39,729 --> 00:05:43,659
infected version of Xcode<font color="#E5E5E5"> and</font>

160
00:05:41,139 --> 00:05:45,880
<font color="#E5E5E5">inadvertently when they go to build a</font>

161
00:05:43,659 --> 00:05:47,949
legitimate application Xcode ghost will

162
00:05:45,880 --> 00:05:49,570
inject malicious code into<font color="#E5E5E5"> that once</font>

163
00:05:47,949 --> 00:05:52,030
those applications get submitted<font color="#E5E5E5"> to the</font>

164
00:05:49,570 --> 00:05:53,680
Apple App Store<font color="#CCCCCC"> they bypassed apples</font>

165
00:05:52,030 --> 00:05:55,539
security checks and made it into

166
00:05:53,680 --> 00:05:57,219
legitimate iOS<font color="#CCCCCC"> app store so then users</font>

167
00:05:55,539 --> 00:05:58,990
would<font color="#CCCCCC"> download these legitimate</font>

168
00:05:57,219 --> 00:06:00,280
applications that were infected and

169
00:05:58,990 --> 00:06:04,780
thereby the malware would get on

170
00:06:00,280 --> 00:06:07,448
<font color="#E5E5E5">end-users phone adware is also becoming</font>

171
00:06:04,780 --> 00:06:10,210
<font color="#E5E5E5">pretty common on on Mac and</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> are the</font>

172
00:06:07,449 --> 00:06:12,909
more<font color="#E5E5E5"> prolific OSX adware families is</font>

173
00:06:10,210 --> 00:06:15,460
called<font color="#CCCCCC"> genie o jr. relies on user</font>

174
00:06:12,909 --> 00:06:17,110
interaction<font color="#E5E5E5"> as its infection vector</font><font color="#CCCCCC"> so</font>

175
00:06:15,460 --> 00:06:19,120
<font color="#E5E5E5">basically the user has to be tricked</font>

176
00:06:17,110 --> 00:06:21,099
into downloading<font color="#E5E5E5"> and running it and once</font>

177
00:06:19,120 --> 00:06:22,990
installed<font color="#E5E5E5"> it will persist as a browser</font>

178
00:06:21,099 --> 00:06:24,430
extension and I'm sure we're all<font color="#E5E5E5"> kind of</font>

179
00:06:22,990 --> 00:06:26,229
familiar with<font color="#E5E5E5"> these you know once you</font>

180
00:06:24,430 --> 00:06:29,080
<font color="#E5E5E5">get adware on your computer there's</font>

181
00:06:26,229 --> 00:06:31,180
<font color="#E5E5E5">things like</font><font color="#CCCCCC"> pop-ups hijacks search</font>

182
00:06:29,080 --> 00:06:32,770
results basically<font color="#E5E5E5"> anything to try to get</font>

183
00:06:31,180 --> 00:06:37,089
the user to<font color="#CCCCCC"> click on things</font><font color="#E5E5E5"> or download</font>

184
00:06:32,770 --> 00:06:38,289
<font color="#E5E5E5">more software so this next sample is</font>

185
00:06:37,089 --> 00:06:39,840
it's kind of interesting<font color="#CCCCCC"> it has the</font>

186
00:06:38,289 --> 00:06:41,520
mundane name

187
00:06:39,840 --> 00:06:43,080
<font color="#E5E5E5">sex backdoor was never really fully</font>

188
00:06:41,520 --> 00:06:45,510
named<font color="#E5E5E5"> but it has a very interesting</font>

189
00:06:43,080 --> 00:06:48,060
infection vector<font color="#E5E5E5"> so there's this piece</font>

190
00:06:45,510 --> 00:06:51,389
of adware called<font color="#CCCCCC"> Mack</font><font color="#E5E5E5"> keeper and mat</font>

191
00:06:48,060 --> 00:06:52,710
keeper<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> is installed on a bunch</font>

192
00:06:51,389 --> 00:06:54,389
of users<font color="#E5E5E5"> computers it's kind of this</font>

193
00:06:52,710 --> 00:06:56,159
<font color="#E5E5E5">like shady advertising company it's not</font>

194
00:06:54,389 --> 00:06:58,350
really mad<font color="#CCCCCC"> with malware but it's</font>

195
00:06:56,160 --> 00:06:59,550
definitely adware anyways a security

196
00:06:58,350 --> 00:07:01,860
researcher<font color="#CCCCCC"> found out that there was a</font>

197
00:06:59,550 --> 00:07:04,470
remotely exploitable vulnerability in

198
00:07:01,860 --> 00:07:06,210
this<font color="#E5E5E5"> mackeeper</font><font color="#CCCCCC"> adware</font><font color="#E5E5E5"> so he reported it</font>

199
00:07:04,470 --> 00:07:08,460
<font color="#CCCCCC">to</font><font color="#E5E5E5"> mat keeper they have like an email</font>

200
00:07:06,210 --> 00:07:10,109
<font color="#E5E5E5">address</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> send</font><font color="#CCCCCC"> a bug reports</font><font color="#E5E5E5"> to I</font>

201
00:07:08,460 --> 00:07:12,239
guess and they fixed it but hackers

202
00:07:10,110 --> 00:07:13,919
actually noticed<font color="#E5E5E5"> this as</font><font color="#CCCCCC"> well and</font><font color="#E5E5E5"> design</font>

203
00:07:12,240 --> 00:07:15,870
some new malware<font color="#E5E5E5"> that was able</font><font color="#CCCCCC"> to</font>

204
00:07:13,919 --> 00:07:18,150
<font color="#CCCCCC">remotely infect computers that had this</font>

205
00:07:15,870 --> 00:07:19,620
mackeeper software installed<font color="#E5E5E5"> so that's</font>

206
00:07:18,150 --> 00:07:22,289
kind of neat<font color="#CCCCCC"> because mostly</font><font color="#E5E5E5"> we don't see</font>

207
00:07:19,620 --> 00:07:24,360
<font color="#E5E5E5">Mac malware that you know has remote</font>

208
00:07:22,290 --> 00:07:25,590
exploitation capabilities but<font color="#E5E5E5"> to me it</font>

209
00:07:24,360 --> 00:07:27,000
<font color="#CCCCCC">definitely shows that the attackers</font><font color="#E5E5E5"> are</font>

210
00:07:25,590 --> 00:07:28,679
out there and they<font color="#CCCCCC"> have the skills and</font>

211
00:07:27,000 --> 00:07:30,210
when the opportunity<font color="#CCCCCC"> arises they'll be</font>

212
00:07:28,680 --> 00:07:32,729
able to create<font color="#E5E5E5"> interesting Mac malware</font>

213
00:07:30,210 --> 00:07:35,340
in terms of its capabilities again it

214
00:07:32,729 --> 00:07:36,990
persists<font color="#E5E5E5"> as a launch agent and again</font>

215
00:07:35,340 --> 00:07:39,090
basic functionalities<font color="#E5E5E5"> survey the Box</font>

216
00:07:36,990 --> 00:07:42,479
<font color="#E5E5E5">download and execute kind of standard</font>

217
00:07:39,090 --> 00:07:45,060
stuff next<font color="#CCCCCC"> we've got key ranger</font><font color="#E5E5E5"> this was</font>

218
00:07:42,479 --> 00:07:47,010
also<font color="#E5E5E5"> discovered by cloud and it was the</font>

219
00:07:45,060 --> 00:07:49,410
first<font color="#E5E5E5"> fully functional in the wild piece</font>

220
00:07:47,010 --> 00:07:52,469
of<font color="#E5E5E5"> Mac ransomware</font><font color="#CCCCCC"> so yes there is</font>

221
00:07:49,410 --> 00:07:53,400
ransomware<font color="#E5E5E5"> on the Mac platform</font><font color="#CCCCCC"> so it</font>

222
00:07:52,470 --> 00:07:55,110
<font color="#CCCCCC">also had kind of an</font><font color="#E5E5E5"> interesting</font>

223
00:07:53,400 --> 00:07:56,760
infection vector so what the hackers

224
00:07:55,110 --> 00:07:59,250
<font color="#CCCCCC">were able to do was they were able to</font>

225
00:07:56,760 --> 00:08:01,440
<font color="#CCCCCC">infect</font><font color="#E5E5E5"> a legitimate website that had a</font>

226
00:07:59,250 --> 00:08:04,080
legitimate<font color="#E5E5E5"> BitTorrent</font><font color="#CCCCCC"> application called</font>

227
00:08:01,440 --> 00:08:06,030
<font color="#CCCCCC">transmission and so what they did</font><font color="#E5E5E5"> was</font>

228
00:08:04,080 --> 00:08:08,010
they injected<font color="#E5E5E5"> their malware into the</font>

229
00:08:06,030 --> 00:08:10,260
otherwise legitimate<font color="#E5E5E5"> transmission</font>

230
00:08:08,010 --> 00:08:11,789
application and then when users<font color="#E5E5E5"> came to</font>

231
00:08:10,260 --> 00:08:13,260
again the legitimate website to download

232
00:08:11,789 --> 00:08:15,539
<font color="#CCCCCC">what they thought was</font><font color="#E5E5E5"> the legitimate</font>

233
00:08:13,260 --> 00:08:20,370
software<font color="#E5E5E5"> they would get this</font><font color="#CCCCCC"> infected</font>

234
00:08:15,539 --> 00:08:22,550
copy of the<font color="#E5E5E5"> transmission client and also</font>

235
00:08:20,370 --> 00:08:24,720
<font color="#E5E5E5">the attackers had access to a fraudulent</font>

236
00:08:22,550 --> 00:08:26,700
<font color="#CCCCCC">Apple</font><font color="#E5E5E5"> developer ID that</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> either</font>

237
00:08:24,720 --> 00:08:28,889
<font color="#E5E5E5">bought or stolen so they were actually</font>

238
00:08:26,700 --> 00:08:30,510
<font color="#E5E5E5">able to sign this an hour</font><font color="#CCCCCC"> so even if the</font>

239
00:08:28,889 --> 00:08:32,279
user had gatekeeper enabled<font color="#E5E5E5"> and other</font>

240
00:08:30,510 --> 00:08:33,450
security mitigations<font color="#E5E5E5"> because it was</font>

241
00:08:32,279 --> 00:08:36,179
<font color="#E5E5E5">signed it was allowed to</font><font color="#CCCCCC"> run on their</font>

242
00:08:33,450 --> 00:08:37,800
computer<font color="#E5E5E5"> and when it ran it slept for a</font>

243
00:08:36,179 --> 00:08:40,409
few<font color="#CCCCCC"> days and then</font><font color="#E5E5E5"> and started crypting</font>

244
00:08:37,799 --> 00:08:42,390
the users files<font color="#E5E5E5"> luckily since cloud</font>

245
00:08:40,409 --> 00:08:44,520
detected it so quick<font color="#E5E5E5"> and word got out</font>

246
00:08:42,390 --> 00:08:45,689
<font color="#E5E5E5">and antivirus signatures were created</font><font color="#CCCCCC"> I</font>

247
00:08:44,520 --> 00:08:47,130
don't<font color="#E5E5E5"> think there was a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> victims</font>

248
00:08:45,690 --> 00:08:48,720
<font color="#CCCCCC">but</font><font color="#E5E5E5"> again this was interesting because</font>

249
00:08:47,130 --> 00:08:50,640
<font color="#E5E5E5">it showed a decent level of</font>

250
00:08:48,720 --> 00:08:53,140
<font color="#CCCCCC">sophistication by malicious adversaries</font>

251
00:08:50,640 --> 00:08:55,610
targeting Mac users

252
00:08:53,140 --> 00:08:57,830
the last sample<font color="#E5E5E5"> I want to talk</font><font color="#CCCCCC"> about is</font>

253
00:08:55,610 --> 00:08:59,480
called careto<font color="#E5E5E5"> and was identified</font><font color="#CCCCCC"> by</font>

254
00:08:57,830 --> 00:09:02,420
<font color="#CCCCCC">kaspersky and they classified it as</font><font color="#E5E5E5"> a</font>

255
00:08:59,480 --> 00:09:04,010
cyber espionage backdoor<font color="#CCCCCC"> I didn't it's</font>

256
00:09:02,420 --> 00:09:06,110
infection vectors via phishing and

257
00:09:04,010 --> 00:09:08,720
exploits<font color="#E5E5E5"> and it's kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> similar to</font>

258
00:09:06,110 --> 00:09:10,550
<font color="#E5E5E5">other OSX malware samples persists as</font>

259
00:09:08,720 --> 00:09:12,710
the launch<font color="#E5E5E5"> agent but it was a little</font>

260
00:09:10,550 --> 00:09:14,469
<font color="#CCCCCC">more sophisticated so in the</font><font color="#E5E5E5"> slide for</font>

261
00:09:12,710 --> 00:09:16,700
example<font color="#E5E5E5"> we can see in the disassembly</font>

262
00:09:14,470 --> 00:09:18,560
<font color="#CCCCCC">there's a command control server but the</font>

263
00:09:16,700 --> 00:09:20,570
<font color="#CCCCCC">URL for</font><font color="#E5E5E5"> the command and control server</font>

264
00:09:18,560 --> 00:09:22,010
is actually obfuscated<font color="#E5E5E5"> so if you just</font>

265
00:09:20,570 --> 00:09:23,660
look at<font color="#CCCCCC"> the binary</font><font color="#E5E5E5"> you're not gonna be</font>

266
00:09:22,010 --> 00:09:24,950
<font color="#CCCCCC">able</font><font color="#E5E5E5"> to see it</font><font color="#CCCCCC"> however you step through</font>

267
00:09:23,660 --> 00:09:28,310
a debugger you<font color="#E5E5E5"> can watch the malware</font>

268
00:09:24,950 --> 00:09:30,080
decode or decrypt that<font color="#E5E5E5"> that URL</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> then</font>

269
00:09:28,310 --> 00:09:33,020
we can get access<font color="#CCCCCC"> to the command and</font>

270
00:09:30,080 --> 00:09:34,880
<font color="#E5E5E5">control servers address but again kind</font>

271
00:09:33,020 --> 00:09:37,010
<font color="#E5E5E5">of interesting and you know a little</font>

272
00:09:34,880 --> 00:09:38,630
<font color="#E5E5E5">more sophisticated and</font><font color="#CCCCCC"> Kaspersky fairly</font>

273
00:09:37,010 --> 00:09:40,670
confidently tied this<font color="#E5E5E5"> to some</font>

274
00:09:38,630 --> 00:09:42,320
nation-state activity so again the shows

275
00:09:40,670 --> 00:09:43,370
that besides just cyber criminal

276
00:09:42,320 --> 00:09:45,710
activities there's definitely

277
00:09:43,370 --> 00:09:49,730
nation-states developing<font color="#CCCCCC"> OSX</font>

278
00:09:45,710 --> 00:09:52,160
implants in malware<font color="#CCCCCC"> alright so</font><font color="#E5E5E5"> that</font>

279
00:09:49,730 --> 00:09:55,130
<font color="#E5E5E5">concludes our tour</font><font color="#CCCCCC"> of several of the</font>

280
00:09:52,160 --> 00:09:57,500
most<font color="#CCCCCC"> OSX</font><font color="#E5E5E5"> recent OSX malware specimens</font>

281
00:09:55,130 --> 00:09:59,450
so<font color="#E5E5E5"> let's now briefly kind of summarize</font>

282
00:09:57,500 --> 00:10:01,250
some of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> commonalities</font><font color="#CCCCCC"> of this</font>

283
00:09:59,450 --> 00:10:04,010
malware<font color="#E5E5E5"> and this will give us a good</font>

284
00:10:01,250 --> 00:10:05,990
<font color="#CCCCCC">understanding of what OSX malware looks</font>

285
00:10:04,010 --> 00:10:08,510
like today and then this knowledge can

286
00:10:05,990 --> 00:10:10,220
<font color="#E5E5E5">aid us in generic detection help us</font>

287
00:10:08,510 --> 00:10:12,770
perform<font color="#CCCCCC"> analysis</font><font color="#E5E5E5"> and maybe even come up</font>

288
00:10:10,220 --> 00:10:14,870
<font color="#E5E5E5">with</font><font color="#CCCCCC"> some ideas for generic detection</font>

289
00:10:12,770 --> 00:10:16,819
mechanisms<font color="#E5E5E5"> basically it will tell us</font>

290
00:10:14,870 --> 00:10:18,680
what we<font color="#E5E5E5"> can look for kind of moving</font>

291
00:10:16,820 --> 00:10:20,090
<font color="#CCCCCC">forward now I do</font><font color="#E5E5E5"> want to caveat</font><font color="#CCCCCC"> that</font>

292
00:10:18,680 --> 00:10:21,949
obviously<font color="#E5E5E5"> there are known unknowns</font>

293
00:10:20,090 --> 00:10:23,270
<font color="#CCCCCC">there's probably some advanced Mac</font>

294
00:10:21,950 --> 00:10:25,550
malware out<font color="#E5E5E5"> there that looks nothing</font>

295
00:10:23,270 --> 00:10:27,800
like any of<font color="#CCCCCC"> these samples I talked</font><font color="#E5E5E5"> about</font>

296
00:10:25,550 --> 00:10:29,390
but as we saw<font color="#E5E5E5"> a lot of samples that we</font>

297
00:10:27,800 --> 00:10:31,189
just<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of covered even though</font><font color="#E5E5E5"> they</font>

298
00:10:29,390 --> 00:10:32,750
were<font color="#E5E5E5"> completely unrelated they had a lot</font>

299
00:10:31,190 --> 00:10:34,700
<font color="#E5E5E5">of commonalities for example a lot</font>

300
00:10:32,750 --> 00:10:35,990
persisted as launch agents so if we can

301
00:10:34,700 --> 00:10:38,210
<font color="#E5E5E5">identify some of those commonalities</font>

302
00:10:35,990 --> 00:10:40,310
<font color="#E5E5E5">it's likely</font><font color="#CCCCCC"> that we might be</font><font color="#E5E5E5"> able to</font>

303
00:10:38,210 --> 00:10:43,550
<font color="#E5E5E5">detect</font><font color="#CCCCCC"> some new malware</font><font color="#E5E5E5"> samples moving</font>

304
00:10:40,310 --> 00:10:46,010
forward<font color="#CCCCCC"> all right so first</font><font color="#E5E5E5"> let's talk</font>

305
00:10:43,550 --> 00:10:47,870
about infection<font color="#CCCCCC"> factors</font><font color="#E5E5E5"> now as I</font>

306
00:10:46,010 --> 00:10:51,050
mentioned most current Mac malware

307
00:10:47,870 --> 00:10:53,000
relies<font color="#CCCCCC"> on user interaction to get on the</font>

308
00:10:51,050 --> 00:10:54,859
<font color="#E5E5E5">box</font><font color="#CCCCCC"> so basically the hackers need the</font>

309
00:10:53,000 --> 00:10:57,200
users to click<font color="#E5E5E5"> and</font><font color="#CCCCCC"> download something to</font>

310
00:10:54,860 --> 00:10:58,910
infect themselves<font color="#CCCCCC"> there's a great quote</font>

311
00:10:57,200 --> 00:11:00,740
<font color="#E5E5E5">in</font><font color="#CCCCCC"> cybersecurity</font><font color="#E5E5E5"> that I always mentioned</font>

312
00:10:58,910 --> 00:11:02,660
<font color="#CCCCCC">it's there is</font><font color="#E5E5E5"> no patch for human</font>

313
00:11:00,740 --> 00:11:04,460
stupidity<font color="#CCCCCC"> so you can have the most</font>

314
00:11:02,660 --> 00:11:05,670
lockdown<font color="#E5E5E5"> system but if users are</font><font color="#CCCCCC"> being</font>

315
00:11:04,460 --> 00:11:07,500
tricked<font color="#E5E5E5"> into</font>

316
00:11:05,670 --> 00:11:10,199
downloading and running executable code

317
00:11:07,500 --> 00:11:12,540
<font color="#CCCCCC">ie there's really not that</font><font color="#E5E5E5"> much you can</font>

318
00:11:10,200 --> 00:11:13,980
do so how do hackers do this<font color="#E5E5E5"> well they</font>

319
00:11:12,540 --> 00:11:16,050
use a lot of techniques<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> similar</font>

320
00:11:13,980 --> 00:11:18,600
<font color="#CCCCCC">to the</font><font color="#E5E5E5"> windows side of the house for</font>

321
00:11:16,050 --> 00:11:20,250
<font color="#E5E5E5">example they might infect a website with</font>

322
00:11:18,600 --> 00:11:22,950
a rogue<font color="#CCCCCC"> AV product and then when the</font>

323
00:11:20,250 --> 00:11:24,870
user<font color="#E5E5E5"> comes to that website</font><font color="#CCCCCC"> it'll pop up</font>

324
00:11:22,950 --> 00:11:27,090
<font color="#CCCCCC">and it'll look like their Mac desktop</font>

325
00:11:24,870 --> 00:11:29,670
and it says<font color="#E5E5E5"> I'm scanning I found all</font>

326
00:11:27,090 --> 00:11:31,470
these you know<font color="#E5E5E5"> malware samples please</font>

327
00:11:29,670 --> 00:11:33,839
<font color="#CCCCCC">download this you know application to</font>

328
00:11:31,470 --> 00:11:36,210
disinfect<font color="#E5E5E5"> yourself and a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> users</font>

329
00:11:33,840 --> 00:11:37,740
you know our parents<font color="#E5E5E5"> grandparents might</font>

330
00:11:36,210 --> 00:11:40,110
you know fall for that<font color="#E5E5E5"> and</font><font color="#CCCCCC"> download that</font>

331
00:11:37,740 --> 00:11:41,310
<font color="#E5E5E5">application</font><font color="#CCCCCC"> obviously that application</font>

332
00:11:40,110 --> 00:11:43,290
is the actual malware

333
00:11:41,310 --> 00:11:45,930
another technique somewhat similar fake

334
00:11:43,290 --> 00:11:47,640
installers you know<font color="#CCCCCC"> flash</font><font color="#E5E5E5"> update is kind</font>

335
00:11:45,930 --> 00:11:49,140
of<font color="#E5E5E5"> the common one users again are</font>

336
00:11:47,640 --> 00:11:50,850
tricked into going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> malicious</font>

337
00:11:49,140 --> 00:11:52,710
<font color="#E5E5E5">website or a legitimate website</font><font color="#CCCCCC"> that has</font>

338
00:11:50,850 --> 00:11:54,780
been compromised<font color="#E5E5E5"> perhaps has a malicious</font>

339
00:11:52,710 --> 00:11:56,520
<font color="#CCCCCC">ad</font><font color="#E5E5E5"> and it'll pop up and say hey please</font>

340
00:11:54,780 --> 00:11:58,770
install this<font color="#CCCCCC"> Flash Player in order to</font>

341
00:11:56,520 --> 00:12:01,650
view content<font color="#E5E5E5"> obviously</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> not really</font>

342
00:11:58,770 --> 00:12:03,870
<font color="#E5E5E5">flash</font><font color="#CCCCCC"> it's malware infected torrents</font><font color="#E5E5E5"> and</font>

343
00:12:01,650 --> 00:12:07,050
other kind<font color="#E5E5E5"> of way hackers get</font><font color="#CCCCCC"> malware</font>

344
00:12:03,870 --> 00:12:08,550
onto<font color="#E5E5E5"> Mac computers you know if users are</font>

345
00:12:07,050 --> 00:12:10,140
<font color="#CCCCCC">downloading pirated crap crack</font>

346
00:12:08,550 --> 00:12:12,120
applications a lot<font color="#CCCCCC"> of times there's</font>

347
00:12:10,140 --> 00:12:13,740
gonna be malware<font color="#E5E5E5"> in there and the</font>

348
00:12:12,120 --> 00:12:15,870
finally fake<font color="#CCCCCC"> codecs is a similar to</font>

349
00:12:13,740 --> 00:12:19,110
updates<font color="#E5E5E5"> a lot of adult websites might</font>

350
00:12:15,870 --> 00:12:21,840
say hey in order<font color="#E5E5E5"> to view content please</font>

351
00:12:19,110 --> 00:12:23,550
install<font color="#E5E5E5"> this HD codec and you know a lot</font>

352
00:12:21,840 --> 00:12:24,120
<font color="#CCCCCC">of users</font><font color="#E5E5E5"> really want to see adult</font>

353
00:12:23,550 --> 00:12:26,520
content

354
00:12:24,120 --> 00:12:28,620
apparently so they will install the<font color="#CCCCCC"> the</font>

355
00:12:26,520 --> 00:12:30,360
codec which is obviously<font color="#E5E5E5"> kind of malware</font>

356
00:12:28,620 --> 00:12:32,160
<font color="#E5E5E5">so again it's important to note</font><font color="#CCCCCC"> that</font>

357
00:12:30,360 --> 00:12:35,130
users<font color="#E5E5E5"> are essentially having to infect</font>

358
00:12:32,160 --> 00:12:37,380
themselves<font color="#E5E5E5"> of course more advanced</font>

359
00:12:35,130 --> 00:12:39,510
adversaries for example nation-states

360
00:12:37,380 --> 00:12:41,790
are<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> use remote exploits which</font>

361
00:12:39,510 --> 00:12:43,770
aren't gonna<font color="#E5E5E5"> require user interaction so</font>

362
00:12:41,790 --> 00:12:44,579
they're gonna<font color="#CCCCCC"> have things like exploits</font>

363
00:12:43,770 --> 00:12:47,970
for<font color="#E5E5E5"> Safari</font>

364
00:12:44,580 --> 00:12:49,830
maybe Java<font color="#E5E5E5"> flash you know we see this</font>

365
00:12:47,970 --> 00:12:51,150
happen on the windows<font color="#E5E5E5"> side so there's no</font>

366
00:12:49,830 --> 00:12:53,220
reason to<font color="#CCCCCC"> think that it's</font><font color="#E5E5E5"> not happening</font>

367
00:12:51,150 --> 00:12:54,720
<font color="#E5E5E5">on the Mac side now these attacks are</font>

368
00:12:53,220 --> 00:12:57,600
very very stealthy<font color="#E5E5E5"> and don't require</font>

369
00:12:54,720 --> 00:12:58,740
<font color="#E5E5E5">user interaction so we don't really hear</font>

370
00:12:57,600 --> 00:13:00,420
about<font color="#E5E5E5"> them as much so a lot of people</font>

371
00:12:58,740 --> 00:13:02,310
<font color="#CCCCCC">think they're</font><font color="#E5E5E5"> not that common</font><font color="#CCCCCC"> and they</font>

372
00:13:00,420 --> 00:13:03,839
might not<font color="#E5E5E5"> be that common but in my</font>

373
00:13:02,310 --> 00:13:05,550
professional<font color="#CCCCCC"> opinion I think they're</font>

374
00:13:03,840 --> 00:13:07,490
probably<font color="#E5E5E5"> happening</font><font color="#CCCCCC"> more than we'd like</font>

375
00:13:05,550 --> 00:13:11,699
to<font color="#CCCCCC"> admit and we're just not</font>

376
00:13:07,490 --> 00:13:13,710
<font color="#E5E5E5">unfortunately detecting them all right</font>

377
00:13:11,700 --> 00:13:16,080
so let's talk<font color="#E5E5E5"> about persistence</font><font color="#CCCCCC"> so first</font>

378
00:13:13,710 --> 00:13:17,820
what is persistence<font color="#E5E5E5"> well in the context</font>

379
00:13:16,080 --> 00:13:19,230
<font color="#E5E5E5">of this presentation</font><font color="#CCCCCC"> persistence</font><font color="#E5E5E5"> is</font>

380
00:13:17,820 --> 00:13:20,880
anything that<font color="#CCCCCC"> in</font>

381
00:13:19,230 --> 00:13:23,430
code for example<font color="#E5E5E5"> malware is</font>

382
00:13:20,880 --> 00:13:25,680
automatically re-execute<font color="#CCCCCC"> 'add</font><font color="#E5E5E5"> every time</font>

383
00:13:23,430 --> 00:13:27,060
the operating<font color="#E5E5E5"> system is</font><font color="#CCCCCC"> restarted now</font>

384
00:13:25,680 --> 00:13:29,189
this is something<font color="#CCCCCC"> obviously all</font>

385
00:13:27,060 --> 00:13:31,290
essentially<font color="#CCCCCC"> All MAC malware strives for</font>

386
00:13:29,190 --> 00:13:33,060
<font color="#E5E5E5">because otherwise if it didn't persist</font>

387
00:13:31,290 --> 00:13:34,740
<font color="#E5E5E5">and you shut down</font><font color="#CCCCCC"> your computer</font><font color="#E5E5E5"> and</font>

388
00:13:33,060 --> 00:13:36,479
<font color="#E5E5E5">restarted it the malware didn't have a</font>

389
00:13:34,740 --> 00:13:37,980
way<font color="#CCCCCC"> to be automatically restarted it</font>

390
00:13:36,480 --> 00:13:39,600
wouldn't get<font color="#E5E5E5"> run again so basically you</font>

391
00:13:37,980 --> 00:13:41,670
<font color="#E5E5E5">would have just disinfected yourself by</font>

392
00:13:39,600 --> 00:13:43,500
<font color="#E5E5E5">restarting your computer so again most</font>

393
00:13:41,670 --> 00:13:46,349
<font color="#E5E5E5">malware if not all strives for some</font>

394
00:13:43,500 --> 00:13:48,870
persistence mechanism so in the wild<font color="#CCCCCC"> we</font>

395
00:13:46,350 --> 00:13:50,130
see<font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot rather just a few techniques</font>

396
00:13:48,870 --> 00:13:52,260
<font color="#E5E5E5">that are used</font><font color="#CCCCCC"> over and</font><font color="#E5E5E5"> over</font><font color="#CCCCCC"> and over</font>

397
00:13:50,130 --> 00:13:54,060
again<font color="#CCCCCC"> so the</font><font color="#E5E5E5"> most</font><font color="#CCCCCC"> common is</font><font color="#E5E5E5"> launch</font>

398
00:13:52,260 --> 00:13:56,460
<font color="#CCCCCC">Damons and agents</font><font color="#E5E5E5"> now these are</font>

399
00:13:54,060 --> 00:13:58,199
legitimate<font color="#E5E5E5"> components of the operating</font>

400
00:13:56,460 --> 00:13:59,730
system this is how<font color="#CCCCCC"> Apple says</font><font color="#E5E5E5"> persist</font>

401
00:13:58,200 --> 00:14:02,040
software<font color="#E5E5E5"> but there's nothing to say that</font>

402
00:13:59,730 --> 00:14:04,620
<font color="#CCCCCC">malicious malware can abuse these</font>

403
00:14:02,040 --> 00:14:06,959
techniques as well another common way is

404
00:14:04,620 --> 00:14:09,210
user login<font color="#CCCCCC"> items again</font><font color="#E5E5E5"> this is how Apple</font>

405
00:14:06,960 --> 00:14:11,460
suggests applications<font color="#CCCCCC"> persist themselves</font>

406
00:14:09,210 --> 00:14:13,350
<font color="#E5E5E5">and if you persist yourself as a</font><font color="#CCCCCC"> login</font>

407
00:14:11,460 --> 00:14:14,820
item you will show up in the UI<font color="#E5E5E5"> but</font>

408
00:14:13,350 --> 00:14:16,440
every time the<font color="#E5E5E5"> user</font><font color="#CCCCCC"> logs in and</font><font color="#E5E5E5"> the</font>

409
00:14:14,820 --> 00:14:18,330
desktop<font color="#E5E5E5"> is shown that code or whatever</font>

410
00:14:16,440 --> 00:14:19,890
<font color="#E5E5E5">was registered will be automatically run</font>

411
00:14:18,330 --> 00:14:21,570
by the operating<font color="#E5E5E5"> system</font><font color="#CCCCCC"> so if</font><font color="#E5E5E5"> this is</font>

412
00:14:19,890 --> 00:14:23,069
now where provides a great<font color="#CCCCCC"> way for</font><font color="#E5E5E5"> that</font>

413
00:14:21,570 --> 00:14:25,890
malware<font color="#E5E5E5"> to get</font><font color="#CCCCCC"> automatically kicked off</font>

414
00:14:23,070 --> 00:14:28,470
<font color="#E5E5E5">third is browser browser extensions and</font>

415
00:14:25,890 --> 00:14:30,689
plugins<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is mostly what adware does</font>

416
00:14:28,470 --> 00:14:32,520
<font color="#E5E5E5">again they register themselves as a</font>

417
00:14:30,690 --> 00:14:34,590
malicious browser extension or<font color="#CCCCCC"> plug-in</font>

418
00:14:32,520 --> 00:14:36,600
<font color="#CCCCCC">and then every time</font><font color="#E5E5E5"> the browser is</font>

419
00:14:34,590 --> 00:14:37,980
started they get<font color="#CCCCCC"> loaded into</font><font color="#E5E5E5"> the context</font>

420
00:14:36,600 --> 00:14:40,320
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the browser where they can hijack</font>

421
00:14:37,980 --> 00:14:43,170
search results display ads that kind<font color="#E5E5E5"> of</font>

422
00:14:40,320 --> 00:14:44,460
stuff<font color="#CCCCCC"> I</font><font color="#E5E5E5"> gave it talk about about all</font>

423
00:14:43,170 --> 00:14:46,740
these techniques and<font color="#E5E5E5"> there's actually</font>

424
00:14:44,460 --> 00:14:50,070
20-plus different ways you can persist

425
00:14:46,740 --> 00:14:51,840
<font color="#E5E5E5">on a Mac at</font><font color="#CCCCCC"> RSA last year but again</font>

426
00:14:50,070 --> 00:14:53,490
<font color="#E5E5E5">adversaries are kind of only using</font><font color="#CCCCCC"> these</font>

427
00:14:51,840 --> 00:14:55,050
three common ones<font color="#E5E5E5"> but we'll probably see</font>

428
00:14:53,490 --> 00:14:58,620
more<font color="#CCCCCC"> advanced more stealthy techniques</font>

429
00:14:55,050 --> 00:15:00,930
in the future so what features<font color="#CCCCCC"> are</font>

430
00:14:58,620 --> 00:15:02,640
common<font color="#E5E5E5"> in OSX malware well it really</font>

431
00:15:00,930 --> 00:15:05,040
kind of<font color="#E5E5E5"> depends on</font><font color="#CCCCCC"> what the goal of the</font>

432
00:15:02,640 --> 00:15:07,530
<font color="#CCCCCC">malware</font><font color="#E5E5E5"> is so there's basically two</font>

433
00:15:05,040 --> 00:15:09,630
classifications or two types of<font color="#E5E5E5"> malware</font>

434
00:15:07,530 --> 00:15:11,130
there's cybercrime or cyber criminal

435
00:15:09,630 --> 00:15:14,070
malware and then there's nation-state

436
00:15:11,130 --> 00:15:15,420
surveillance espionage type malware<font color="#E5E5E5"> so</font>

437
00:15:14,070 --> 00:15:17,160
for<font color="#E5E5E5"> a criminal</font><font color="#CCCCCC"> it's all gonna be it's</font>

438
00:15:15,420 --> 00:15:19,020
all about you<font color="#E5E5E5"> know making money</font><font color="#CCCCCC"> so</font>

439
00:15:17,160 --> 00:15:21,810
that's<font color="#E5E5E5"> showing ads getting users</font><font color="#CCCCCC"> to</font>

440
00:15:19,020 --> 00:15:23,400
click<font color="#E5E5E5"> on things you know hijacking</font>

441
00:15:21,810 --> 00:15:25,770
search results<font color="#CCCCCC"> that kind of stuff</font>

442
00:15:23,400 --> 00:15:28,350
whereas espionage nation-states<font color="#E5E5E5"> type</font>

443
00:15:25,770 --> 00:15:29,880
stuff is all about data<font color="#CCCCCC"> collection so</font>

444
00:15:28,350 --> 00:15:33,509
nation-state malware is gonna have

445
00:15:29,880 --> 00:15:35,129
things<font color="#E5E5E5"> like audio capture video capture</font>

446
00:15:33,509 --> 00:15:37,229
you know that kind of stuff maybe a

447
00:15:35,129 --> 00:15:38,609
remote interactive<font color="#CCCCCC"> show</font><font color="#E5E5E5"> now there is</font>

448
00:15:37,229 --> 00:15:39,209
gonna<font color="#E5E5E5"> be some</font><font color="#CCCCCC"> overlap for example</font>

449
00:15:38,609 --> 00:15:41,729
<font color="#E5E5E5">keyloggers</font>

450
00:15:39,209 --> 00:15:43,738
the<font color="#E5E5E5"> cybercrime guys probably interested</font>

451
00:15:41,729 --> 00:15:44,699
in you know<font color="#E5E5E5"> your bank password so when</font>

452
00:15:43,739 --> 00:15:47,669
you<font color="#E5E5E5"> type that in they want to grab</font><font color="#CCCCCC"> that</font>

453
00:15:44,699 --> 00:15:50,519
<font color="#E5E5E5">whereas the nation-state adversaries the</font>

454
00:15:47,669 --> 00:15:51,689
espionage cyber<font color="#E5E5E5"> backdoors are gonna want</font>

455
00:15:50,519 --> 00:15:53,039
to<font color="#E5E5E5"> know what you're saying and who</font>

456
00:15:51,689 --> 00:15:56,779
you're talking to so there's likely

457
00:15:53,039 --> 00:15:59,789
<font color="#CCCCCC">gonna be</font><font color="#E5E5E5"> key logger components in both</font>

458
00:15:56,779 --> 00:16:01,619
<font color="#E5E5E5">okay so after</font><font color="#CCCCCC"> looking at these various</font>

459
00:15:59,789 --> 00:16:03,959
OSX malware specimens and briefly

460
00:16:01,619 --> 00:16:06,419
studying their commonalities<font color="#E5E5E5"> we can kind</font>

461
00:16:03,959 --> 00:16:08,699
<font color="#E5E5E5">of make some general summaries or</font>

462
00:16:06,419 --> 00:16:10,559
conclusions about<font color="#E5E5E5"> it all so again in</font>

463
00:16:08,699 --> 00:16:13,108
<font color="#E5E5E5">terms of infection most require user</font>

464
00:16:10,559 --> 00:16:14,848
interaction<font color="#E5E5E5"> so Trojans phishing but</font>

465
00:16:13,109 --> 00:16:17,819
there are some remote exploits out there

466
00:16:14,849 --> 00:16:19,859
terms of persistence most use<font color="#E5E5E5"> well-known</font>

467
00:16:17,819 --> 00:16:21,809
methods<font color="#E5E5E5"> the majority of those being</font>

468
00:16:19,859 --> 00:16:23,819
<font color="#CCCCCC">launch items so</font><font color="#E5E5E5"> launch</font><font color="#CCCCCC"> agent sir</font><font color="#E5E5E5"> Damon's</font>

469
00:16:21,809 --> 00:16:26,579
<font color="#CCCCCC">in terms of self</font><font color="#E5E5E5"> defense we see some</font>

470
00:16:23,819 --> 00:16:27,988
minimal obfuscation<font color="#CCCCCC"> but really</font><font color="#E5E5E5"> not a lot</font>

471
00:16:26,579 --> 00:16:31,108
<font color="#E5E5E5">which makes them our pretty easy to</font>

472
00:16:27,989 --> 00:16:32,819
detect and remove terms of stealth<font color="#E5E5E5"> both</font>

473
00:16:31,109 --> 00:16:34,529
just try to hide in plain<font color="#CCCCCC"> sight they</font>

474
00:16:32,819 --> 00:16:36,299
<font color="#E5E5E5">name themselves or something</font><font color="#CCCCCC"> or other</font>

475
00:16:34,529 --> 00:16:38,579
<font color="#CCCCCC">and just</font><font color="#E5E5E5"> try to blend in the noise of</font>

476
00:16:36,299 --> 00:16:39,959
<font color="#E5E5E5">the operating system rootkit components</font>

477
00:16:38,579 --> 00:16:42,508
you know one or two samples<font color="#CCCCCC"> might have</font>

478
00:16:39,959 --> 00:16:44,039
this but really<font color="#E5E5E5"> not that common terms of</font>

479
00:16:42,509 --> 00:16:46,709
features a lot of<font color="#CCCCCC"> the features are</font>

480
00:16:44,039 --> 00:16:48,899
implemented<font color="#E5E5E5"> not that sophisticated or</font>

481
00:16:46,709 --> 00:16:50,459
stealthy<font color="#E5E5E5"> but they do provide remote</font>

482
00:16:48,899 --> 00:16:51,779
adversaries complete<font color="#E5E5E5"> command control</font>

483
00:16:50,459 --> 00:16:54,118
over a computer<font color="#E5E5E5"> so even if they're not</font>

484
00:16:51,779 --> 00:16:56,159
the<font color="#E5E5E5"> most elegantly implemented it's</font>

485
00:16:54,119 --> 00:16:58,049
sufficient for<font color="#CCCCCC"> the job and then in</font><font color="#E5E5E5"> terms</font>

486
00:16:56,159 --> 00:17:00,509
of<font color="#E5E5E5"> bypassing antivirus products and</font>

487
00:16:58,049 --> 00:17:02,069
firewalls<font color="#E5E5E5"> we really don't see much and</font>

488
00:17:00,509 --> 00:17:04,679
that's<font color="#E5E5E5"> probably</font><font color="#CCCCCC"> because there's not as</font>

489
00:17:02,069 --> 00:17:07,678
many<font color="#E5E5E5"> antivirus or security products on</font>

490
00:17:04,679 --> 00:17:09,059
Mac compared to Windows<font color="#E5E5E5"> and also the Mac</font>

491
00:17:07,679 --> 00:17:10,829
malware is really often<font color="#E5E5E5"> not as</font>

492
00:17:09,059 --> 00:17:14,519
sophisticated<font color="#E5E5E5"> as on the windows side of</font>

493
00:17:10,829 --> 00:17:17,549
house<font color="#CCCCCC"> ok so now we have hopefully a</font>

494
00:17:14,519 --> 00:17:18,899
solid understanding of what OSX malware

495
00:17:17,549 --> 00:17:20,970
looks like you know what it<font color="#CCCCCC"> kind of</font>

496
00:17:18,898 --> 00:17:23,368
smells like<font color="#E5E5E5"> so let's talk about how you</font>

497
00:17:20,970 --> 00:17:25,618
can hopefully generically determine if

498
00:17:23,368 --> 00:17:27,599
you've infected<font color="#CCCCCC"> so this is kind of time</font>

499
00:17:25,618 --> 00:17:29,759
to play doctor and again this is what I

500
00:17:27,599 --> 00:17:32,428
do when<font color="#CCCCCC"> I get a computer</font><font color="#E5E5E5"> from a friend</font>

501
00:17:29,759 --> 00:17:33,960
relative<font color="#E5E5E5"> that thinks it might</font><font color="#CCCCCC"> be</font>

502
00:17:32,429 --> 00:17:35,759
infected<font color="#E5E5E5"> they say hey it's acting weird</font>

503
00:17:33,960 --> 00:17:37,769
I think<font color="#CCCCCC"> I have malware on it</font><font color="#E5E5E5"> Patrick</font><font color="#CCCCCC"> can</font>

504
00:17:35,759 --> 00:17:39,509
you can you look at it<font color="#CCCCCC"> now I do want to</font>

505
00:17:37,769 --> 00:17:41,309
<font color="#E5E5E5">make</font><font color="#CCCCCC"> one caveat before</font><font color="#E5E5E5"> jumping in and</font>

506
00:17:39,509 --> 00:17:43,350
that is if you<font color="#CCCCCC"> are if you suspect</font>

507
00:17:41,309 --> 00:17:44,908
perhaps<font color="#E5E5E5"> you know an enterprise server is</font>

508
00:17:43,350 --> 00:17:46,629
infected you know you should really<font color="#CCCCCC"> do</font>

509
00:17:44,909 --> 00:17:48,250
the more responsible friends

510
00:17:46,630 --> 00:17:50,670
you know grab a memory dump<font color="#CCCCCC"> take it</font>

511
00:17:48,250 --> 00:17:53,050
offline you know analyze it in a lab

512
00:17:50,670 --> 00:17:55,330
<font color="#CCCCCC">this talk we're talking about practical</font>

513
00:17:53,050 --> 00:17:56,350
<font color="#CCCCCC">you</font><font color="#E5E5E5"> know personal analysis of that you</font>

514
00:17:55,330 --> 00:17:57,669
know you're<font color="#CCCCCC"> not gonna go to your friend</font>

515
00:17:56,350 --> 00:17:59,169
and be like okay I need<font color="#E5E5E5"> to image your</font>

516
00:17:57,670 --> 00:18:00,850
<font color="#E5E5E5">drive and</font><font color="#CCCCCC"> pull out</font><font color="#E5E5E5"> your hard drive I</font>

517
00:17:59,170 --> 00:18:04,840
mean<font color="#E5E5E5"> you might but that's kind of</font>

518
00:18:00,850 --> 00:18:06,870
difficult<font color="#CCCCCC"> okay so the first</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> to</font>

519
00:18:04,840 --> 00:18:09,459
observe any visual observable indicators

520
00:18:06,870 --> 00:18:11,530
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is important</font><font color="#CCCCCC"> because Mac malware</font>

521
00:18:09,460 --> 00:18:14,170
yes it exists but it's really<font color="#E5E5E5"> not</font><font color="#CCCCCC"> that</font>

522
00:18:11,530 --> 00:18:15,790
common<font color="#CCCCCC"> so a lot of</font><font color="#E5E5E5"> times if someone says</font>

523
00:18:14,170 --> 00:18:17,560
their computer is acting<font color="#E5E5E5"> slow or buggy</font>

524
00:18:15,790 --> 00:18:19,810
<font color="#CCCCCC">or odd it's probably not gonna</font><font color="#E5E5E5"> be</font>

525
00:18:17,560 --> 00:18:22,480
malware<font color="#CCCCCC"> so if they say hey my computer</font>

526
00:18:19,810 --> 00:18:24,370
is running slow<font color="#CCCCCC"> you know keeps crashing</font>

527
00:18:22,480 --> 00:18:25,540
there's so many processes<font color="#CCCCCC"> you know this</font>

528
00:18:24,370 --> 00:18:28,179
is<font color="#CCCCCC"> probably just</font><font color="#E5E5E5"> Apple screwing up</font>

529
00:18:25,540 --> 00:18:29,470
something<font color="#CCCCCC"> for</font><font color="#E5E5E5"> example they blacklisted</font>

530
00:18:28,180 --> 00:18:31,240
their<font color="#E5E5E5"> Ethernet driver at one point</font>

531
00:18:29,470 --> 00:18:32,980
<font color="#E5E5E5">meaning that their</font><font color="#CCCCCC"> Ethernet driver</font>

532
00:18:31,240 --> 00:18:34,240
couldn't<font color="#E5E5E5"> work so their internet just</font>

533
00:18:32,980 --> 00:18:35,920
stopped working<font color="#CCCCCC"> so kind</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> Apple</font>

534
00:18:34,240 --> 00:18:37,150
sometimes<font color="#E5E5E5"> this</font><font color="#CCCCCC"> stuff like that</font><font color="#E5E5E5"> or</font>

535
00:18:35,920 --> 00:18:40,210
there's a<font color="#E5E5E5"> lot of buggy third party code</font>

536
00:18:37,150 --> 00:18:42,580
out<font color="#CCCCCC"> there however there</font><font color="#E5E5E5"> are some</font><font color="#CCCCCC"> visual</font>

537
00:18:40,210 --> 00:18:44,620
indicators that<font color="#CCCCCC"> might you</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> mean the</font>

538
00:18:42,580 --> 00:18:46,840
system is<font color="#E5E5E5"> infected for example adware if</font>

539
00:18:44,620 --> 00:18:48,760
you're<font color="#E5E5E5"> getting</font><font color="#CCCCCC"> pop-ups</font><font color="#E5E5E5"> home pages are</font>

540
00:18:46,840 --> 00:18:52,449
hijacked<font color="#E5E5E5"> weird search results probably</font>

541
00:18:48,760 --> 00:18:54,580
<font color="#E5E5E5">indicative of adware however though most</font>

542
00:18:52,450 --> 00:18:55,870
malware tries not to<font color="#E5E5E5"> be overt right and</font>

543
00:18:54,580 --> 00:18:56,919
wants<font color="#CCCCCC"> to stay on</font><font color="#E5E5E5"> your computer so</font>

544
00:18:55,870 --> 00:19:00,850
<font color="#E5E5E5">there's</font><font color="#CCCCCC"> probably not gonna be a lot of</font>

545
00:18:56,920 --> 00:19:02,350
<font color="#E5E5E5">easily observable indicators another</font>

546
00:19:00,850 --> 00:19:04,060
thing is if you do<font color="#E5E5E5"> have security tools</font>

547
00:19:02,350 --> 00:19:05,889
installed it's important to observe

548
00:19:04,060 --> 00:19:08,350
<font color="#E5E5E5">their warnings so we'll</font><font color="#CCCCCC"> talk about these</font>

549
00:19:05,890 --> 00:19:09,940
<font color="#CCCCCC">specific tools later</font><font color="#E5E5E5"> but basically if</font>

550
00:19:08,350 --> 00:19:12,010
there's odd things that are connecting

551
00:19:09,940 --> 00:19:15,010
to<font color="#E5E5E5"> the internet</font><font color="#CCCCCC"> or persisting this might</font>

552
00:19:12,010 --> 00:19:16,600
be indicative of a<font color="#E5E5E5"> connection or a</font>

553
00:19:15,010 --> 00:19:18,220
malware infection because<font color="#E5E5E5"> these tools</font>

554
00:19:16,600 --> 00:19:21,100
specifically don't<font color="#E5E5E5"> look for malware per</font>

555
00:19:18,220 --> 00:19:22,810
se they more<font color="#CCCCCC"> observed behaviors so if</font>

556
00:19:21,100 --> 00:19:24,280
you see odd things going on<font color="#E5E5E5"> you know we</font>

557
00:19:22,810 --> 00:19:27,250
might<font color="#CCCCCC"> want to poke around and dig a</font>

558
00:19:24,280 --> 00:19:28,720
little deeper so the first thing I do

559
00:19:27,250 --> 00:19:30,400
once I get<font color="#CCCCCC"> a</font><font color="#E5E5E5"> system that I</font><font color="#CCCCCC"> think is</font>

560
00:19:28,720 --> 00:19:32,290
infected<font color="#E5E5E5"> or if I think</font><font color="#CCCCCC"> I've infected</font>

561
00:19:30,400 --> 00:19:34,450
myself<font color="#CCCCCC"> is to see if there's any known</font>

562
00:19:32,290 --> 00:19:36,070
malware<font color="#CCCCCC"> on the system this</font><font color="#E5E5E5"> is pretty</font>

563
00:19:34,450 --> 00:19:38,020
<font color="#E5E5E5">easy and conclusive because if you find</font>

564
00:19:36,070 --> 00:19:39,250
<font color="#E5E5E5">something you know hey this is a known</font>

565
00:19:38,020 --> 00:19:40,840
piece of malware there's probably a

566
00:19:39,250 --> 00:19:42,400
write up about<font color="#E5E5E5"> it</font><font color="#CCCCCC"> on the Internet like</font>

567
00:19:40,840 --> 00:19:43,480
how it persists<font color="#E5E5E5"> and how to disinfect</font>

568
00:19:42,400 --> 00:19:45,940
yourself<font color="#CCCCCC"> and stuff like</font><font color="#E5E5E5"> that</font>

569
00:19:43,480 --> 00:19:47,110
so you could use a single<font color="#E5E5E5"> antivirus tool</font>

570
00:19:45,940 --> 00:19:48,730
you know you could<font color="#E5E5E5"> download and run your</font>

571
00:19:47,110 --> 00:19:50,649
<font color="#CCCCCC">system but a lot of antivirus tools</font>

572
00:19:48,730 --> 00:19:52,360
might miss certain<font color="#E5E5E5"> things</font><font color="#CCCCCC"> so I think</font>

573
00:19:50,650 --> 00:19:54,640
<font color="#CCCCCC">it's always better to use a</font><font color="#E5E5E5"> service such</font>

574
00:19:52,360 --> 00:19:56,979
<font color="#E5E5E5">as</font><font color="#CCCCCC"> virustotal virustotal</font><font color="#E5E5E5"> is a</font>

575
00:19:54,640 --> 00:19:58,690
cloud-based service<font color="#E5E5E5"> that basically has</font>

576
00:19:56,980 --> 00:20:00,610
50 or so antivirus<font color="#E5E5E5"> engine</font>

577
00:19:58,690 --> 00:20:02,410
and you can<font color="#E5E5E5"> submit a file or hash and</font>

578
00:20:00,610 --> 00:20:03,909
it'll scan that file with all 50

579
00:20:02,410 --> 00:20:06,760
antivirus<font color="#E5E5E5"> engines so it's kind of like</font>

580
00:20:03,910 --> 00:20:09,460
you know<font color="#CCCCCC"> defense-in-depth</font><font color="#E5E5E5"> so what I</font><font color="#CCCCCC"> did</font>

581
00:20:06,760 --> 00:20:10,930
<font color="#E5E5E5">was I wrote a free tool that</font><font color="#CCCCCC"> enumerates</font>

582
00:20:09,460 --> 00:20:13,090
everything on your system it's called

583
00:20:10,930 --> 00:20:15,040
<font color="#CCCCCC">tasks Explorer</font><font color="#E5E5E5"> and if you're familiar</font>

584
00:20:13,090 --> 00:20:16,780
with sysinternals tools on<font color="#CCCCCC"> Windows this</font>

585
00:20:15,040 --> 00:20:19,030
is very similar to process Explorer on

586
00:20:16,780 --> 00:20:21,399
Windows<font color="#E5E5E5"> so shows all running processes</font>

587
00:20:19,030 --> 00:20:24,129
all running tasks all<font color="#E5E5E5"> loaded libraries</font>

588
00:20:21,400 --> 00:20:26,020
<font color="#E5E5E5">open files network connections and stuff</font>

589
00:20:24,130 --> 00:20:28,210
<font color="#CCCCCC">like that</font><font color="#E5E5E5"> but it also has virustotal</font>

590
00:20:26,020 --> 00:20:29,980
integration<font color="#E5E5E5"> so for every loaded dynamic</font>

591
00:20:28,210 --> 00:20:31,930
library every process<font color="#E5E5E5"> that's running</font>

592
00:20:29,980 --> 00:20:33,550
it'll send the hash<font color="#CCCCCC"> to virustotal and if</font>

593
00:20:31,930 --> 00:20:35,680
it's<font color="#CCCCCC"> a known piece</font><font color="#E5E5E5"> of malware</font><font color="#CCCCCC"> it will</font>

594
00:20:33,550 --> 00:20:37,870
pop up and<font color="#CCCCCC"> tell you hey I found some</font>

595
00:20:35,680 --> 00:20:39,340
malware<font color="#E5E5E5"> on</font><font color="#CCCCCC"> your system so again this is</font>

596
00:20:37,870 --> 00:20:40,929
kind<font color="#E5E5E5"> of nice I always run this first and</font>

597
00:20:39,340 --> 00:20:42,970
<font color="#E5E5E5">you know a lot</font><font color="#CCCCCC"> of times if there is</font>

598
00:20:40,930 --> 00:20:44,980
malware on a person's computer<font color="#E5E5E5"> it's</font>

599
00:20:42,970 --> 00:20:48,250
probably some known adware or something

600
00:20:44,980 --> 00:20:50,260
else<font color="#E5E5E5"> now assuming task Explorer doesn't</font>

601
00:20:48,250 --> 00:20:51,730
show anything<font color="#E5E5E5"> says hey there's no known</font>

602
00:20:50,260 --> 00:20:53,680
malware<font color="#E5E5E5"> on here but I</font><font color="#CCCCCC"> really think</font><font color="#E5E5E5"> the</font>

603
00:20:51,730 --> 00:20:57,040
computer<font color="#E5E5E5"> is</font><font color="#CCCCCC"> still infected what I do is</font>

604
00:20:53,680 --> 00:20:58,120
I try to look<font color="#E5E5E5"> for suspicious files so</font>

605
00:20:57,040 --> 00:20:59,379
we'll talk<font color="#CCCCCC"> about this a little more</font><font color="#E5E5E5"> but</font>

606
00:20:58,120 --> 00:21:01,030
<font color="#CCCCCC">basically the goal here is to find a</font>

607
00:20:59,380 --> 00:21:02,920
subset of files that<font color="#E5E5E5"> you think might be</font>

608
00:21:01,030 --> 00:21:04,780
malware by looking for<font color="#E5E5E5"> kind of weird</font>

609
00:21:02,920 --> 00:21:06,970
things and then we'll<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> how</font><font color="#CCCCCC"> to</font>

610
00:21:04,780 --> 00:21:08,500
<font color="#CCCCCC">analyze that hopefully very small subset</font>

611
00:21:06,970 --> 00:21:11,380
<font color="#CCCCCC">of</font><font color="#E5E5E5"> files to</font><font color="#CCCCCC"> determine if there are</font>

612
00:21:08,500 --> 00:21:13,120
malicious<font color="#E5E5E5"> or not so task Explorer</font><font color="#CCCCCC"> again</font>

613
00:21:11,380 --> 00:21:15,190
has some<font color="#CCCCCC"> nice features you can say</font>

614
00:21:13,120 --> 00:21:16,810
something<font color="#CCCCCC"> like</font><font color="#E5E5E5"> hash tag unsigned and</font>

615
00:21:15,190 --> 00:21:18,520
<font color="#E5E5E5">I'll show you everything that's running</font>

616
00:21:16,810 --> 00:21:20,950
<font color="#E5E5E5">or loaded on</font><font color="#CCCCCC"> your system that is</font>

617
00:21:18,520 --> 00:21:22,930
unsigned<font color="#E5E5E5"> on Macs these days pretty much</font>

618
00:21:20,950 --> 00:21:24,820
most things should be<font color="#E5E5E5"> signed all Apple</font>

619
00:21:22,930 --> 00:21:26,980
<font color="#CCCCCC">software's</font><font color="#E5E5E5"> obviously signed by Apple</font>

620
00:21:24,820 --> 00:21:29,620
proper and most if not all<font color="#E5E5E5"> third party</font>

621
00:21:26,980 --> 00:21:31,060
<font color="#E5E5E5">applications are signed as</font><font color="#CCCCCC"> well so you</font>

622
00:21:29,620 --> 00:21:32,500
know I<font color="#E5E5E5"> always start by kind</font><font color="#CCCCCC"> of looking</font>

623
00:21:31,060 --> 00:21:34,120
<font color="#E5E5E5">what's unsigned because the majority of</font>

624
00:21:32,500 --> 00:21:36,970
Mac malware is actually currently

625
00:21:34,120 --> 00:21:38,409
unsigned<font color="#E5E5E5"> you can also say hashtag</font><font color="#CCCCCC"> non</font>

626
00:21:36,970 --> 00:21:40,210
<font color="#CCCCCC">apple and</font><font color="#E5E5E5"> this will show</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> all thirty</font>

627
00:21:38,410 --> 00:21:41,800
third party code that's<font color="#E5E5E5"> running on your</font>

628
00:21:40,210 --> 00:21:43,270
<font color="#E5E5E5">system</font><font color="#CCCCCC"> so again I basically filters out</font>

629
00:21:41,800 --> 00:21:45,220
everything that's loaded and all

630
00:21:43,270 --> 00:21:46,660
processes<font color="#E5E5E5"> that belong to Apple proper by</font>

631
00:21:45,220 --> 00:21:48,700
checking their cryptographic signature

632
00:21:46,660 --> 00:21:50,440
so this will give you a nice list<font color="#E5E5E5"> of you</font>

633
00:21:48,700 --> 00:21:52,120
<font color="#E5E5E5">know third party software that you might</font>

634
00:21:50,440 --> 00:21:54,670
want to<font color="#E5E5E5"> look into because there are or</font>

635
00:21:52,120 --> 00:21:58,270
have<font color="#E5E5E5"> been some</font><font color="#CCCCCC"> instances of Mac malware</font>

636
00:21:54,670 --> 00:21:59,680
<font color="#E5E5E5">that's signed so now yes even though</font>

637
00:21:58,270 --> 00:22:01,840
<font color="#CCCCCC">task</font><font color="#E5E5E5"> Explorer</font><font color="#CCCCCC"> can help you probably</font>

638
00:21:59,680 --> 00:22:03,220
<font color="#E5E5E5">still have a decent list of files you</font>

639
00:22:01,840 --> 00:22:05,800
know if you're<font color="#E5E5E5"> grabbing all third party</font>

640
00:22:03,220 --> 00:22:07,810
software that might be you know<font color="#E5E5E5"> 10 20 30</font>

641
00:22:05,800 --> 00:22:10,659
50<font color="#E5E5E5"> different files analyzed which is</font>

642
00:22:07,810 --> 00:22:12,580
kind of a<font color="#E5E5E5"> subset so what I do next is I</font>

643
00:22:10,660 --> 00:22:13,659
try to whittle<font color="#E5E5E5"> this down by look</font>

644
00:22:12,580 --> 00:22:15,730
which one of those<font color="#CCCCCC"> are actually</font>

645
00:22:13,659 --> 00:22:18,399
persisting and the<font color="#E5E5E5"> assumption here</font><font color="#CCCCCC"> is</font>

646
00:22:15,730 --> 00:22:20,440
most if not all<font color="#E5E5E5"> Mac malware needs to</font>

647
00:22:18,399 --> 00:22:22,330
persist in some manner<font color="#CCCCCC"> you know if</font>

648
00:22:20,440 --> 00:22:24,519
there's some crazy resident type memory

649
00:22:22,330 --> 00:22:26,110
<font color="#E5E5E5">only malware that's you know maybe</font><font color="#CCCCCC"> maybe</font>

650
00:22:24,519 --> 00:22:28,330
a thing but again<font color="#E5E5E5"> the majority</font><font color="#CCCCCC"> of Mac</font>

651
00:22:26,110 --> 00:22:29,559
malware is gonna<font color="#E5E5E5"> persist in some way so</font>

652
00:22:28,330 --> 00:22:31,840
I wrote<font color="#E5E5E5"> another free tool called knock</font>

653
00:22:29,559 --> 00:22:33,850
<font color="#E5E5E5">knock again very similar to</font><font color="#CCCCCC"> Auto runs on</font>

654
00:22:31,840 --> 00:22:35,500
<font color="#E5E5E5">Windows and it simply shows all software</font>

655
00:22:33,850 --> 00:22:37,809
that's persisting<font color="#E5E5E5"> on your system</font>

656
00:22:35,500 --> 00:22:39,760
so obviously legitimate<font color="#CCCCCC"> software is</font>

657
00:22:37,809 --> 00:22:41,730
<font color="#CCCCCC">gonna persist</font><font color="#E5E5E5"> to but we can look for</font>

658
00:22:39,760 --> 00:22:43,690
<font color="#E5E5E5">things that perhaps are unsigned</font>

659
00:22:41,730 --> 00:22:45,669
<font color="#E5E5E5">unrecognized by virustotal</font>

660
00:22:43,690 --> 00:22:47,919
you know might<font color="#E5E5E5"> claim to be from Apple</font>

661
00:22:45,669 --> 00:22:49,960
<font color="#E5E5E5">even though it's you</font><font color="#CCCCCC"> know not not Apple</font>

662
00:22:47,919 --> 00:22:52,090
<font color="#E5E5E5">so for example in in this slide we can</font>

663
00:22:49,960 --> 00:22:54,220
<font color="#E5E5E5">see</font><font color="#CCCCCC"> that there's a bunch of launch items</font>

664
00:22:52,090 --> 00:22:55,870
<font color="#E5E5E5">we</font><font color="#CCCCCC"> can see there's some VMware tools</font>

665
00:22:54,220 --> 00:22:57,940
installed in my VM so I know<font color="#CCCCCC"> there's a</font>

666
00:22:55,870 --> 00:23:00,158
legit<font color="#CCCCCC"> signed by</font><font color="#E5E5E5"> VMware but then there's</font>

667
00:22:57,940 --> 00:23:02,019
an unsigned binary called<font color="#CCCCCC"> Apple updater</font>

668
00:23:00,159 --> 00:23:03,340
<font color="#CCCCCC">so like that's</font><font color="#E5E5E5"> super shady even though</font>

669
00:23:02,019 --> 00:23:05,260
virustotal doesn't know<font color="#CCCCCC"> about it it's</font>

670
00:23:03,340 --> 00:23:06,610
unsigned and it's persisting<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it</font>

671
00:23:05,260 --> 00:23:10,269
<font color="#CCCCCC">claims to be something with Apple</font><font color="#E5E5E5"> like</font>

672
00:23:06,610 --> 00:23:11,590
that's a<font color="#CCCCCC"> huge</font><font color="#E5E5E5"> red flag another good</font>

673
00:23:10,269 --> 00:23:14,200
thing<font color="#E5E5E5"> to look for is any odd or</font>

674
00:23:11,590 --> 00:23:15,610
suspicious<font color="#CCCCCC"> Network</font><font color="#E5E5E5"> IO because most if</font>

675
00:23:14,200 --> 00:23:17,500
not all malware wants to talk to<font color="#CCCCCC"> a</font>

676
00:23:15,610 --> 00:23:18,879
<font color="#CCCCCC">command-and-control</font><font color="#E5E5E5"> server so again you</font>

677
00:23:17,500 --> 00:23:21,039
<font color="#E5E5E5">can use task Explorer to look for</font>

678
00:23:18,880 --> 00:23:23,620
established or connecting<font color="#E5E5E5"> connected</font>

679
00:23:21,039 --> 00:23:25,210
sessions here we can see<font color="#E5E5E5"> I worm at open</font>

680
00:23:23,620 --> 00:23:26,559
<font color="#CCCCCC">support a</font><font color="#E5E5E5"> remote port to listen for an</font>

681
00:23:25,210 --> 00:23:28,299
attacker to connect in gives them an

682
00:23:26,559 --> 00:23:29,950
interactive<font color="#E5E5E5"> shell you can</font><font color="#CCCCCC"> also use</font>

683
00:23:28,299 --> 00:23:32,320
<font color="#E5E5E5">command line tools that are built into</font>

684
00:23:29,950 --> 00:23:33,760
Apple for example<font color="#CCCCCC"> LS Oh F and</font><font color="#E5E5E5"> this will</font>

685
00:23:32,320 --> 00:23:35,559
<font color="#CCCCCC">show you for example establish</font>

686
00:23:33,760 --> 00:23:38,559
connections so again here<font color="#CCCCCC"> we can see I</font>

687
00:23:35,559 --> 00:23:39,850
<font color="#CCCCCC">am</font><font color="#E5E5E5"> connecting to the the adversary</font>

688
00:23:38,559 --> 00:23:43,059
they've opened up a session<font color="#E5E5E5"> and they're</font>

689
00:23:39,850 --> 00:23:44,740
talking<font color="#CCCCCC"> back and forth of course there's</font>

690
00:23:43,059 --> 00:23:47,139
countless<font color="#E5E5E5"> other things to</font><font color="#CCCCCC"> look for I</font>

691
00:23:44,740 --> 00:23:48,460
also look at loaded kernel<font color="#CCCCCC"> extensions so</font>

692
00:23:47,139 --> 00:23:50,168
I wrote another free<font color="#E5E5E5"> tool called text</font>

693
00:23:48,460 --> 00:23:52,630
<font color="#E5E5E5">viewer basically shows</font><font color="#CCCCCC"> you all the</font>

694
00:23:50,169 --> 00:23:55,210
<font color="#E5E5E5">kernel extensions that are</font><font color="#CCCCCC"> loaded in in</font>

695
00:23:52,630 --> 00:23:57,070
the kernel again integrated virustotal

696
00:23:55,210 --> 00:23:59,139
so again if something<font color="#CCCCCC"> isn't recognized</font>

697
00:23:57,070 --> 00:24:01,000
by virustotal<font color="#E5E5E5"> or claims to be like some</font>

698
00:23:59,139 --> 00:24:04,240
<font color="#E5E5E5">Apple Thunderbolt adapter but it's not</font>

699
00:24:01,000 --> 00:24:06,850
signed by Apple<font color="#E5E5E5"> super-shady</font><font color="#CCCCCC"> I also look</font>

700
00:24:04,240 --> 00:24:08,980
for hijack dynamic libraries<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

701
00:24:06,850 --> 00:24:10,809
similar to DLL hijacks<font color="#E5E5E5"> on Windows you</font>

702
00:24:08,980 --> 00:24:12,370
<font color="#CCCCCC">can kind of</font><font color="#E5E5E5"> do the same attack on Mac so</font>

703
00:24:10,809 --> 00:24:14,350
again it's a stealthy way that<font color="#E5E5E5"> malware</font>

704
00:24:12,370 --> 00:24:16,479
could persist or kind of<font color="#E5E5E5"> get on a system</font>

705
00:24:14,350 --> 00:24:18,309
so I kind of<font color="#E5E5E5"> just run these various</font>

706
00:24:16,480 --> 00:24:21,460
tools<font color="#E5E5E5"> and poke around</font><font color="#CCCCCC"> and see what I</font>

707
00:24:18,309 --> 00:24:24,039
have<font color="#E5E5E5"> so now let's assume</font><font color="#CCCCCC"> that we've</font>

708
00:24:21,460 --> 00:24:25,929
found or<font color="#E5E5E5"> identified some interesting or</font>

709
00:24:24,039 --> 00:24:26,440
suspicious files basically<font color="#E5E5E5"> things we</font>

710
00:24:25,929 --> 00:24:28,180
don't reckon

711
00:24:26,440 --> 00:24:29,890
things that might be<font color="#E5E5E5"> persisting</font>

712
00:24:28,180 --> 00:24:31,360
basically things that<font color="#CCCCCC"> no could be</font>

713
00:24:29,890 --> 00:24:33,400
<font color="#E5E5E5">malware if we think the system is</font>

714
00:24:31,360 --> 00:24:35,169
<font color="#CCCCCC">infected</font><font color="#E5E5E5"> so now we have a simple goal</font>

715
00:24:33,400 --> 00:24:37,900
and that's<font color="#E5E5E5"> the determine if these files</font>

716
00:24:35,170 --> 00:24:40,060
are malicious<font color="#CCCCCC"> or equally important</font><font color="#E5E5E5"> if</font>

717
00:24:37,900 --> 00:24:41,590
they are not and I<font color="#CCCCCC"> think it's important</font>

718
00:24:40,060 --> 00:24:43,570
to<font color="#CCCCCC"> realize that</font><font color="#E5E5E5"> I would</font><font color="#CCCCCC"> say about 95</font>

719
00:24:41,590 --> 00:24:46,810
percent<font color="#CCCCCC"> or so of</font><font color="#E5E5E5"> these files are either</font>

720
00:24:43,570 --> 00:24:49,149
gonna be known malware<font color="#E5E5E5"> or not malicious</font>

721
00:24:46,810 --> 00:24:51,820
<font color="#CCCCCC">it's very rare that</font><font color="#E5E5E5"> you're gonna have a</font>

722
00:24:49,150 --> 00:24:53,800
completely unknown Mac malware sample on

723
00:24:51,820 --> 00:24:56,830
your system if you do please<font color="#E5E5E5"> tell</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> cuz</font>

724
00:24:53,800 --> 00:24:58,629
<font color="#E5E5E5">I really nerd out</font><font color="#CCCCCC"> on this stuff</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> if</font>

725
00:24:56,830 --> 00:25:00,159
<font color="#E5E5E5">we talk about some dynamic analysis you</font>

726
00:24:58,630 --> 00:25:02,650
know<font color="#E5E5E5"> make sure you do this in a virtual</font>

727
00:25:00,160 --> 00:25:05,230
<font color="#CCCCCC">machine so you</font><font color="#E5E5E5"> don't infect your your</font>

728
00:25:02,650 --> 00:25:06,640
box<font color="#E5E5E5"> so the first thing I do again I have</font>

729
00:25:05,230 --> 00:25:09,430
this<font color="#E5E5E5"> list the files that I think are odd</font>

730
00:25:06,640 --> 00:25:10,810
<font color="#CCCCCC">or suspicious</font><font color="#E5E5E5"> I I kind</font><font color="#CCCCCC"> of do a bunch of</font>

731
00:25:09,430 --> 00:25:12,640
steps<font color="#E5E5E5"> to figure out you know</font><font color="#CCCCCC"> if they</font>

732
00:25:10,810 --> 00:25:14,919
<font color="#CCCCCC">really</font><font color="#E5E5E5"> are so one of the first things I</font>

733
00:25:12,640 --> 00:25:16,870
do<font color="#E5E5E5"> is I</font><font color="#CCCCCC"> check the signing certificate</font>

734
00:25:14,920 --> 00:25:18,430
for it assuming<font color="#E5E5E5"> the file is signed this</font>

735
00:25:16,870 --> 00:25:20,320
<font color="#E5E5E5">is a great way to determine who wrote</font>

736
00:25:18,430 --> 00:25:22,450
the<font color="#CCCCCC"> software and for</font><font color="#E5E5E5"> example if it's a</font>

737
00:25:20,320 --> 00:25:24,490
false<font color="#CCCCCC"> positive so there's a few</font>

738
00:25:22,450 --> 00:25:27,130
antivirus products that flag this file

739
00:25:24,490 --> 00:25:28,840
called<font color="#E5E5E5"> Lib tidy and if you look at the</font>

740
00:25:27,130 --> 00:25:31,480
digital signature for Lib<font color="#E5E5E5"> tidy you can</font>

741
00:25:28,840 --> 00:25:33,360
use the code sign command you<font color="#E5E5E5"> can see</font>

742
00:25:31,480 --> 00:25:35,920
that it's signed by<font color="#CCCCCC"> Apple proper</font>

743
00:25:33,360 --> 00:25:37,600
obviously<font color="#E5E5E5"> a piece of software that</font><font color="#CCCCCC"> comes</font>

744
00:25:35,920 --> 00:25:40,210
from<font color="#E5E5E5"> Apple proper is not going to be</font>

745
00:25:37,600 --> 00:25:41,350
malicious<font color="#E5E5E5"> unless like the FBI gets their</font>

746
00:25:40,210 --> 00:25:43,960
private signing<font color="#E5E5E5"> key and then we have</font>

747
00:25:41,350 --> 00:25:45,340
bigger<font color="#E5E5E5"> problems</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> worry about</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> other</font>

748
00:25:43,960 --> 00:25:47,500
thing though is<font color="#CCCCCC"> most Mac malware is</font>

749
00:25:45,340 --> 00:25:48,909
unsigned<font color="#CCCCCC"> I would say the majority so</font>

750
00:25:47,500 --> 00:25:50,620
again if there's a suspicious file you

751
00:25:48,910 --> 00:25:52,390
have it it's<font color="#E5E5E5"> not signed</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> again</font>

752
00:25:50,620 --> 00:25:54,219
kind of<font color="#E5E5E5"> a reg red flag</font><font color="#CCCCCC"> that you should</font>

753
00:25:52,390 --> 00:25:57,610
<font color="#E5E5E5">probably look at that file deeper or</font>

754
00:25:54,220 --> 00:26:00,070
closer the next thing I do<font color="#CCCCCC"> is I simply</font>

755
00:25:57,610 --> 00:26:02,500
<font color="#CCCCCC">Google the hash or look up the</font><font color="#E5E5E5"> file in</font>

756
00:26:00,070 --> 00:26:04,570
virustotal<font color="#E5E5E5"> and then this can quickly</font>

757
00:26:02,500 --> 00:26:07,990
<font color="#E5E5E5">tell you is this</font><font color="#CCCCCC"> a known file</font><font color="#E5E5E5"> is it</font>

758
00:26:04,570 --> 00:26:09,820
unknown file or is it known<font color="#CCCCCC"> malware you</font>

759
00:26:07,990 --> 00:26:11,500
know again this can say something<font color="#E5E5E5"> like</font>

760
00:26:09,820 --> 00:26:14,139
hey you know this file is persisting but

761
00:26:11,500 --> 00:26:16,090
it's part<font color="#E5E5E5"> of you know some Adobe</font>

762
00:26:14,140 --> 00:26:17,830
installer and you know here's<font color="#E5E5E5"> the Adobe</font>

763
00:26:16,090 --> 00:26:20,260
<font color="#E5E5E5">Staller installer it's the legitimate</font>

764
00:26:17,830 --> 00:26:21,850
one yes it's unsigned but<font color="#CCCCCC"> no W just</font>

765
00:26:20,260 --> 00:26:24,160
<font color="#E5E5E5">forgot</font><font color="#CCCCCC"> to sign it so it kind of quickly</font>

766
00:26:21,850 --> 00:26:25,510
<font color="#E5E5E5">tell you different things about that now</font>

767
00:26:24,160 --> 00:26:27,360
it's important to<font color="#E5E5E5"> note two things</font><font color="#CCCCCC"> though</font>

768
00:26:25,510 --> 00:26:29,770
there can<font color="#CCCCCC"> be legitimate</font><font color="#E5E5E5"> third-party</font>

769
00:26:27,360 --> 00:26:31,540
<font color="#E5E5E5">binaries that just the hashes haven't</font>

770
00:26:29,770 --> 00:26:33,490
been<font color="#E5E5E5"> indexed by Google or anyone else</font><font color="#CCCCCC"> so</font>

771
00:26:31,540 --> 00:26:35,170
you might get<font color="#CCCCCC"> zero hits and also if</font>

772
00:26:33,490 --> 00:26:37,240
there<font color="#CCCCCC"> are</font><font color="#E5E5E5"> zero detection</font><font color="#CCCCCC"> zhan virus</font><font color="#E5E5E5"> hole</font>

773
00:26:35,170 --> 00:26:38,690
that doesn't mean it's not our most Mac

774
00:26:37,240 --> 00:26:40,580
now or when it comes out

775
00:26:38,690 --> 00:26:41,809
there's no<font color="#CCCCCC"> virustotal signatures</font><font color="#E5E5E5"> for</font>

776
00:26:40,580 --> 00:26:44,149
this so again if you're one of<font color="#E5E5E5"> the</font>

777
00:26:41,809 --> 00:26:46,690
unlucky<font color="#CCCCCC"> few that gets</font><font color="#E5E5E5"> infected earlier</font>

778
00:26:44,149 --> 00:26:48,469
<font color="#E5E5E5">or you know you're being targeted by</font>

779
00:26:46,690 --> 00:26:50,479
<font color="#E5E5E5">nation-state adversaries or something</font>

780
00:26:48,470 --> 00:26:52,399
virustotal might not flag the file<font color="#E5E5E5"> so</font>

781
00:26:50,479 --> 00:26:56,090
<font color="#E5E5E5">zero detection does not necessarily mean</font>

782
00:26:52,399 --> 00:26:57,738
it's it's not<font color="#CCCCCC"> Mauer so if I'm still</font>

783
00:26:56,090 --> 00:26:59,720
<font color="#E5E5E5">unsure about that the next</font><font color="#CCCCCC"> thing I do</font><font color="#E5E5E5"> is</font>

784
00:26:57,739 --> 00:27:01,399
I run strings so strings as its name

785
00:26:59,720 --> 00:27:03,799
suggests will<font color="#E5E5E5"> tell you all the strings</font>

786
00:27:01,399 --> 00:27:05,330
that<font color="#CCCCCC"> are</font><font color="#E5E5E5"> in a binary so it's a good way</font>

787
00:27:03,799 --> 00:27:06,950
<font color="#CCCCCC">to really</font><font color="#E5E5E5"> get a</font><font color="#CCCCCC"> feel for</font><font color="#E5E5E5"> the binary</font>

788
00:27:05,330 --> 00:27:10,220
<font color="#E5E5E5">without having to do a lot of</font><font color="#CCCCCC"> low-level</font>

789
00:27:06,950 --> 00:27:12,080
<font color="#E5E5E5">reverse engineering so here we see OSX</font>

790
00:27:10,220 --> 00:27:13,999
<font color="#E5E5E5">careto again this was a cyber espionage</font>

791
00:27:12,080 --> 00:27:15,678
backdoor that<font color="#E5E5E5"> was attributed</font><font color="#CCCCCC"> to a</font>

792
00:27:13,999 --> 00:27:17,809
<font color="#E5E5E5">nation-state</font><font color="#CCCCCC"> so pretty decent</font>

793
00:27:15,679 --> 00:27:19,340
sophisticated piece of<font color="#CCCCCC"> malware and we</font>

794
00:27:17,809 --> 00:27:21,379
can see<font color="#E5E5E5"> that running strings we can see</font>

795
00:27:19,340 --> 00:27:22,908
some some<font color="#E5E5E5"> some interesting network and</font>

796
00:27:21,379 --> 00:27:25,309
an execution logic so things like

797
00:27:22,909 --> 00:27:27,109
reverse lookup executing you know

798
00:27:25,309 --> 00:27:30,349
<font color="#CCCCCC">percent ass and then there's also some</font>

799
00:27:27,109 --> 00:27:32,029
encoded strings<font color="#CCCCCC"> so again if you see a</font>

800
00:27:30,349 --> 00:27:33,619
binary<font color="#CCCCCC"> that's persisting that's unsigned</font>

801
00:27:32,029 --> 00:27:35,389
that you don't<font color="#E5E5E5"> recognize</font><font color="#CCCCCC"> that has these</font>

802
00:27:33,619 --> 00:27:37,789
strings in it like<font color="#E5E5E5"> this is probably</font>

803
00:27:35,389 --> 00:27:39,889
<font color="#CCCCCC">malware right at the bottom you can see</font>

804
00:27:37,789 --> 00:27:41,149
<font color="#CCCCCC">I</font><font color="#E5E5E5"> worm and we can see by running strings</font>

805
00:27:39,889 --> 00:27:43,399
we can quickly<font color="#E5E5E5"> determine that it's</font>

806
00:27:41,149 --> 00:27:44,539
packed<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> that's kind of an</font><font color="#CCCCCC"> usual</font>

807
00:27:43,399 --> 00:27:47,209
thing there's<font color="#E5E5E5"> not a lot of packed</font>

808
00:27:44,539 --> 00:27:48,769
<font color="#CCCCCC">binaries on on Mac another</font><font color="#E5E5E5"> thing to do</font>

809
00:27:47,210 --> 00:27:50,779
is<font color="#CCCCCC"> google any interesting strings</font>

810
00:27:48,769 --> 00:27:52,909
because<font color="#E5E5E5"> you might have a piece of</font>

811
00:27:50,779 --> 00:27:54,470
malware that's<font color="#E5E5E5"> a known but it's</font><font color="#CCCCCC"> just a</font>

812
00:27:52,909 --> 00:27:55,970
new variant<font color="#E5E5E5"> like maybe the attackers</font>

813
00:27:54,470 --> 00:27:56,629
recompiled it or packed it<font color="#CCCCCC"> with</font>

814
00:27:55,970 --> 00:27:58,669
something else

815
00:27:56,629 --> 00:28:00,498
so maybe<font color="#CCCCCC"> virustotal doesn't know about</font>

816
00:27:58,669 --> 00:28:02,359
<font color="#E5E5E5">it</font><font color="#CCCCCC"> yet but otherwise it's essentially a</font>

817
00:28:00,499 --> 00:28:04,039
known piece of malware<font color="#CCCCCC"> so what I'll do</font>

818
00:28:02,359 --> 00:28:06,019
is<font color="#CCCCCC"> I'll look for you know misspellings</font>

819
00:28:04,039 --> 00:28:07,639
weird<font color="#E5E5E5"> error messages and then I'll</font>

820
00:28:06,019 --> 00:28:09,409
<font color="#CCCCCC">google</font><font color="#E5E5E5"> those because often that's a</font>

821
00:28:07,639 --> 00:28:11,238
commonality<font color="#E5E5E5"> that can tie you to a known</font>

822
00:28:09,409 --> 00:28:13,279
piece of malware or I can<font color="#E5E5E5"> point you to</font>

823
00:28:11,239 --> 00:28:14,690
you<font color="#E5E5E5"> know a legitimate piece of software</font>

824
00:28:13,279 --> 00:28:17,029
<font color="#E5E5E5">so again we're</font><font color="#CCCCCC"> just kind of looking</font><font color="#E5E5E5"> for</font>

825
00:28:14,690 --> 00:28:18,559
tips or<font color="#CCCCCC"> things that can indicate if</font>

826
00:28:17,029 --> 00:28:21,769
<font color="#E5E5E5">something is malicious or if it's a</font>

827
00:28:18,559 --> 00:28:24,408
known piece of software another<font color="#CCCCCC"> thing I</font>

828
00:28:21,769 --> 00:28:27,289
look for<font color="#CCCCCC"> is is the binary</font><font color="#E5E5E5"> encrypted so</font>

829
00:28:24,409 --> 00:28:29,869
<font color="#E5E5E5">OSX natively supports a custom Apple</font>

830
00:28:27,289 --> 00:28:32,570
proprietary<font color="#E5E5E5"> undocumented encryption</font>

831
00:28:29,869 --> 00:28:34,939
scheme and<font color="#E5E5E5"> Apple uses it to protect some</font>

832
00:28:32,570 --> 00:28:37,759
of<font color="#E5E5E5"> their applications such as finder and</font>

833
00:28:34,940 --> 00:28:39,169
<font color="#E5E5E5">I think the doc now I talked to blackhat</font>

834
00:28:37,759 --> 00:28:41,539
last year about how<font color="#E5E5E5"> malware could</font>

835
00:28:39,169 --> 00:28:43,639
<font color="#E5E5E5">leverage this encryption capability to</font>

836
00:28:41,539 --> 00:28:45,080
basically<font color="#E5E5E5"> protect itself</font><font color="#CCCCCC"> and I wrote a</font>

837
00:28:43,639 --> 00:28:47,089
simple<font color="#E5E5E5"> tool that takes an arbitrary</font>

838
00:28:45,080 --> 00:28:48,889
<font color="#E5E5E5">binary so for example</font><font color="#CCCCCC"> an own piece of</font>

839
00:28:47,089 --> 00:28:50,809
<font color="#E5E5E5">Mac malware and encrypts it with this</font>

840
00:28:48,889 --> 00:28:52,519
Apple specific encryption scheme and

841
00:28:50,809 --> 00:28:54,678
then I reapplied<font color="#E5E5E5"> that file to by</font>

842
00:28:52,519 --> 00:28:56,330
total and it got about<font color="#E5E5E5"> a 50% detection</font>

843
00:28:54,679 --> 00:28:57,859
<font color="#CCCCCC">dropping</font><font color="#E5E5E5"> obviously if there's an</font>

844
00:28:56,330 --> 00:28:59,509
<font color="#CCCCCC">applesauce</font>

845
00:28:57,859 --> 00:29:00,830
if there's a binary<font color="#E5E5E5"> that's not signed by</font>

846
00:28:59,509 --> 00:29:02,979
Apple<font color="#E5E5E5"> that's using that encryption</font>

847
00:29:00,830 --> 00:29:05,629
scheme that's that's really really<font color="#CCCCCC"> shady</font>

848
00:29:02,979 --> 00:29:06,529
<font color="#E5E5E5">so how can you tell if a binary is</font>

849
00:29:05,629 --> 00:29:08,208
encrypted

850
00:29:06,529 --> 00:29:10,489
well programmatically you basically

851
00:29:08,209 --> 00:29:12,320
parse the binaries<font color="#E5E5E5"> mock</font><font color="#CCCCCC"> oh header and</font>

852
00:29:10,489 --> 00:29:14,809
<font color="#E5E5E5">you look for a special flag in the text</font>

853
00:29:12,320 --> 00:29:17,658
segment<font color="#E5E5E5"> that tells the operating system</font>

854
00:29:14,809 --> 00:29:19,399
hey I'm encrypted but you can also<font color="#E5E5E5"> use a</font>

855
00:29:17,659 --> 00:29:22,549
tool<font color="#CCCCCC"> like task Explorer which has the</font>

856
00:29:19,399 --> 00:29:24,199
<font color="#E5E5E5">hash tag encrypted search component and</font>

857
00:29:22,549 --> 00:29:26,479
it will show you<font color="#E5E5E5"> everything on your</font>

858
00:29:24,200 --> 00:29:28,789
system that is<font color="#CCCCCC"> encrypted using this</font>

859
00:29:26,479 --> 00:29:30,829
technique so<font color="#CCCCCC"> we can see there's four</font>

860
00:29:28,789 --> 00:29:32,719
<font color="#E5E5E5">files on this virtual machine three of</font>

861
00:29:30,829 --> 00:29:34,639
them belong to<font color="#E5E5E5"> Apple a green lock means</font>

862
00:29:32,719 --> 00:29:36,829
it's signed by Apple proper and then the

863
00:29:34,639 --> 00:29:39,019
bottom<font color="#CCCCCC"> one is unsigned</font><font color="#E5E5E5"> and but it's</font>

864
00:29:36,829 --> 00:29:40,879
using this<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> closed source Apple</font>

865
00:29:39,019 --> 00:29:43,249
proprietary encryption scheme<font color="#E5E5E5"> like</font>

866
00:29:40,879 --> 00:29:45,168
that's super<font color="#CCCCCC"> shady</font><font color="#E5E5E5"> so when I wrote task</font>

867
00:29:43,249 --> 00:29:46,609
<font color="#E5E5E5">Explorer</font><font color="#CCCCCC"> I was like I</font><font color="#E5E5E5"> don't know if</font>

868
00:29:45,169 --> 00:29:48,139
there's an even gonna<font color="#E5E5E5"> be</font><font color="#CCCCCC"> any malware</font>

869
00:29:46,609 --> 00:29:49,668
that<font color="#CCCCCC"> out</font><font color="#E5E5E5"> that uses this encryption</font>

870
00:29:48,139 --> 00:29:51,049
scheme but<font color="#E5E5E5"> it'd be cool to find that</font><font color="#CCCCCC"> and</font>

871
00:29:49,669 --> 00:29:52,549
<font color="#CCCCCC">then about a week later</font><font color="#E5E5E5"> hacking team</font>

872
00:29:51,049 --> 00:29:54,769
<font color="#E5E5E5">actually came out with</font><font color="#CCCCCC"> a new version of</font>

873
00:29:52,549 --> 00:29:56,690
their<font color="#E5E5E5"> implant installer that used this</font>

874
00:29:54,769 --> 00:29:58,429
<font color="#E5E5E5">encryption scheme so even though no</font>

875
00:29:56,690 --> 00:30:00,169
other antivirus<font color="#E5E5E5"> products were flagging</font>

876
00:29:58,429 --> 00:30:02,539
this if you had got infected with

877
00:30:00,169 --> 00:30:04,609
<font color="#CCCCCC">hacking teams</font><font color="#E5E5E5"> persistent implant and you</font>

878
00:30:02,539 --> 00:30:06,589
<font color="#E5E5E5">ran a tool like task Explorer it would</font>

879
00:30:04,609 --> 00:30:08,869
have showed<font color="#E5E5E5"> a suspicious file being</font>

880
00:30:06,589 --> 00:30:11,629
<font color="#E5E5E5">unsigned but yet encrypted with apples</font>

881
00:30:08,869 --> 00:30:13,668
proprietary encryption technology so

882
00:30:11,629 --> 00:30:17,178
again that's gonna be<font color="#E5E5E5"> something really</font>

883
00:30:13,669 --> 00:30:19,279
<font color="#CCCCCC">suspicious something to</font><font color="#E5E5E5"> look for</font><font color="#CCCCCC"> alright</font>

884
00:30:17,179 --> 00:30:21,799
so let's talk<font color="#CCCCCC"> about pact</font><font color="#E5E5E5"> stuff so on</font>

885
00:30:19,279 --> 00:30:23,239
<font color="#E5E5E5">Windows the majority of Mac sorry the</font>

886
00:30:21,799 --> 00:30:25,039
majority<font color="#CCCCCC"> of malware is going to be</font>

887
00:30:23,239 --> 00:30:28,009
packed<font color="#E5E5E5"> right hackers do this to</font>

888
00:30:25,039 --> 00:30:29,869
complicate you know analysis make the

889
00:30:28,009 --> 00:30:32,629
file size<font color="#CCCCCC"> smaller bypass</font><font color="#E5E5E5"> signature based</font>

890
00:30:29,869 --> 00:30:34,728
antivirus products so on and so<font color="#CCCCCC"> on</font><font color="#E5E5E5"> now</font>

891
00:30:32,629 --> 00:30:37,248
legit software can<font color="#CCCCCC"> be packed</font><font color="#E5E5E5"> too but on</font>

892
00:30:34,729 --> 00:30:39,139
Mac we really<font color="#E5E5E5"> don't see a lot of pact</font>

893
00:30:37,249 --> 00:30:40,609
<font color="#E5E5E5">software there's maybe</font><font color="#CCCCCC"> one or two</font>

894
00:30:39,139 --> 00:30:42,529
<font color="#E5E5E5">samples out there but they're often</font>

895
00:30:40,609 --> 00:30:45,109
<font color="#E5E5E5">signed you know like by Adobe or</font>

896
00:30:42,529 --> 00:30:46,669
something so looking or determining if a

897
00:30:45,109 --> 00:30:48,799
file is<font color="#E5E5E5"> packed is a really good way</font><font color="#CCCCCC"> to</font>

898
00:30:46,669 --> 00:30:51,229
determine<font color="#CCCCCC"> if a file might be</font><font color="#E5E5E5"> malicious</font>

899
00:30:48,799 --> 00:30:53,929
or is suspicious<font color="#E5E5E5"> so how can we determine</font>

900
00:30:51,229 --> 00:30:56,659
<font color="#CCCCCC">if a</font><font color="#E5E5E5"> binary is packed so we can look for</font>

901
00:30:53,929 --> 00:30:58,820
<font color="#CCCCCC">Packers specific strings for example upx</font>

902
00:30:56,659 --> 00:31:00,950
has some certain segment names so we<font color="#E5E5E5"> can</font>

903
00:30:58,820 --> 00:31:03,049
<font color="#E5E5E5">look for</font><font color="#CCCCCC"> that or more generically we can</font>

904
00:31:00,950 --> 00:31:04,669
just<font color="#CCCCCC"> calculate the</font><font color="#E5E5E5"> entropy of a file and</font>

905
00:31:03,049 --> 00:31:06,740
for<font color="#E5E5E5"> packed files it's going to have a</font>

906
00:31:04,669 --> 00:31:09,350
very high entropy<font color="#CCCCCC"> so entropy</font><font color="#E5E5E5"> is based</font>

907
00:31:06,740 --> 00:31:11,600
<font color="#E5E5E5">a calculation of the number of unique</font>

908
00:31:09,350 --> 00:31:13,159
<font color="#E5E5E5">bytes in the</font><font color="#CCCCCC"> file and some distribution</font>

909
00:31:11,600 --> 00:31:14,300
type stuff<font color="#CCCCCC"> and when a file is packed</font>

910
00:31:13,160 --> 00:31:16,340
that's gonna<font color="#E5E5E5"> be really really high</font>

911
00:31:14,300 --> 00:31:18,770
<font color="#CCCCCC">whereas unpack files that's</font><font color="#E5E5E5"> gonna be</font>

912
00:31:16,340 --> 00:31:20,720
<font color="#E5E5E5">really low so again task</font><font color="#CCCCCC"> Explorer can</font>

913
00:31:18,770 --> 00:31:22,610
tell you or<font color="#CCCCCC"> show you all packed files</font>

914
00:31:20,720 --> 00:31:24,230
you just<font color="#CCCCCC"> say hash tag packed and I'll</font>

915
00:31:22,610 --> 00:31:25,760
show<font color="#E5E5E5"> you all dynamic libraries or</font>

916
00:31:24,230 --> 00:31:28,429
processes that<font color="#CCCCCC"> are</font><font color="#E5E5E5"> running on</font><font color="#CCCCCC"> your</font>

917
00:31:25,760 --> 00:31:30,800
system<font color="#E5E5E5"> that are packed so</font><font color="#CCCCCC"> here we can</font>

918
00:31:28,429 --> 00:31:32,960
see Java W this<font color="#CCCCCC"> is AI worm and again</font>

919
00:31:30,800 --> 00:31:34,760
when I<font color="#E5E5E5"> arm out there was no antivirus</font>

920
00:31:32,960 --> 00:31:36,830
signatures for this<font color="#E5E5E5"> but again it was</font>

921
00:31:34,760 --> 00:31:39,050
packed with<font color="#CCCCCC"> upx so if you had this</font><font color="#E5E5E5"> on</font>

922
00:31:36,830 --> 00:31:41,540
your system and<font color="#E5E5E5"> you used a tool such</font><font color="#CCCCCC"> as</font>

923
00:31:39,050 --> 00:31:42,950
task Explorer and you know<font color="#E5E5E5"> said show me</font>

924
00:31:41,540 --> 00:31:44,570
<font color="#E5E5E5">all the packed files you would see this</font>

925
00:31:42,950 --> 00:31:46,070
running process on your<font color="#CCCCCC"> system that was</font>

926
00:31:44,570 --> 00:31:48,260
packed which would be a good indicate

927
00:31:46,070 --> 00:31:49,790
indication that this files<font color="#E5E5E5"> suspicious</font>

928
00:31:48,260 --> 00:31:53,629
<font color="#E5E5E5">and in this case it was it was</font><font color="#CCCCCC"> actually</font>

929
00:31:49,790 --> 00:31:56,590
malware<font color="#E5E5E5"> all right so another useful</font><font color="#CCCCCC"> OSX</font>

930
00:31:53,630 --> 00:31:58,160
specific<font color="#E5E5E5"> dual tool is class dump so</font>

931
00:31:56,590 --> 00:32:00,800
<font color="#E5E5E5">applications that are</font><font color="#CCCCCC"> written in</font>

932
00:31:58,160 --> 00:32:02,480
<font color="#CCCCCC">objective-c which is Apple's</font><font color="#E5E5E5"> primary</font>

933
00:32:00,800 --> 00:32:04,879
programming<font color="#E5E5E5"> language at least for</font>

934
00:32:02,480 --> 00:32:06,260
operating system<font color="#E5E5E5"> type stuff container</font>

935
00:32:04,880 --> 00:32:08,179
contains a lot of runtime<font color="#E5E5E5"> information</font>

936
00:32:06,260 --> 00:32:10,520
<font color="#E5E5E5">that's actually embedded in the</font><font color="#CCCCCC"> binary</font>

937
00:32:08,179 --> 00:32:12,080
so class<font color="#E5E5E5"> class them can extract this so</font>

938
00:32:10,520 --> 00:32:14,929
it can<font color="#E5E5E5"> distract extract things like</font>

939
00:32:12,080 --> 00:32:17,389
method names<font color="#E5E5E5"> variable names and and</font>

940
00:32:14,929 --> 00:32:18,740
whatnot<font color="#CCCCCC"> so you can run this on a binary</font>

941
00:32:17,390 --> 00:32:20,809
<font color="#E5E5E5">that you think is suspicious and get a</font>

942
00:32:18,740 --> 00:32:23,600
decent feel what this<font color="#CCCCCC"> binary is actually</font>

943
00:32:20,809 --> 00:32:25,399
doing so I ran it first<font color="#CCCCCC"> on crisis which</font>

944
00:32:23,600 --> 00:32:26,659
<font color="#E5E5E5">is hacking teams malware and you can see</font>

945
00:32:25,400 --> 00:32:29,450
there's some really interesting method

946
00:32:26,660 --> 00:32:31,130
names like rename backdoor and relaunch

947
00:32:29,450 --> 00:32:32,540
again if you're looking<font color="#CCCCCC"> at a file and</font>

948
00:32:31,130 --> 00:32:34,370
you<font color="#E5E5E5"> think it's suspicious and you see a</font>

949
00:32:32,540 --> 00:32:36,260
method name like this<font color="#E5E5E5"> very good</font>

950
00:32:34,370 --> 00:32:37,850
<font color="#E5E5E5">indication that this is malware similar</font>

951
00:32:36,260 --> 00:32:39,260
we have<font color="#CCCCCC"> an adware installer and again</font>

952
00:32:37,850 --> 00:32:40,699
it's<font color="#E5E5E5"> got some interesting strings about</font>

953
00:32:39,260 --> 00:32:42,950
downloading<font color="#E5E5E5"> and running in encrypted</font>

954
00:32:40,700 --> 00:32:44,750
<font color="#E5E5E5">files</font><font color="#CCCCCC"> so yeah this is</font><font color="#E5E5E5"> just kind of a</font>

955
00:32:42,950 --> 00:32:48,350
good<font color="#CCCCCC"> way to get an</font><font color="#E5E5E5"> understanding of what</font>

956
00:32:44,750 --> 00:32:50,540
the<font color="#CCCCCC"> the</font><font color="#E5E5E5"> malware might be doing another</font>

957
00:32:48,350 --> 00:32:53,120
<font color="#E5E5E5">OSX specific tool that I always run is</font>

958
00:32:50,540 --> 00:32:56,840
FS usage<font color="#E5E5E5"> and you can think of this as a</font>

959
00:32:53,120 --> 00:32:59,899
command<font color="#E5E5E5"> line version of file Mon pom on</font>

960
00:32:56,840 --> 00:33:02,419
on<font color="#CCCCCC"> windows</font><font color="#E5E5E5"> right so here</font><font color="#CCCCCC"> we run it on</font>

961
00:32:59,900 --> 00:33:03,620
the<font color="#CCCCCC"> Malheur sample</font><font color="#E5E5E5"> that targeted or</font>

962
00:33:02,420 --> 00:33:05,750
<font color="#E5E5E5">exploited mackeeper</font>

963
00:33:03,620 --> 00:33:07,100
and very easily we can<font color="#E5E5E5"> see it does three</font>

964
00:33:05,750 --> 00:33:09,500
<font color="#CCCCCC">things which gives us</font><font color="#E5E5E5"> a really good</font>

965
00:33:07,100 --> 00:33:10,730
<font color="#CCCCCC">understanding what this binary does so</font>

966
00:33:09,500 --> 00:33:12,770
if we didn't know what this binary does

967
00:33:10,730 --> 00:33:14,179
once we run<font color="#E5E5E5"> it through FS usage we can</font>

968
00:33:12,770 --> 00:33:17,230
quickly see three things<font color="#CCCCCC"> we can see</font>

969
00:33:14,179 --> 00:33:19,600
first<font color="#E5E5E5"> its persisting as a launch agent</font>

970
00:33:17,230 --> 00:33:22,330
it's installing itself to slash users

971
00:33:19,600 --> 00:33:25,090
slash<font color="#E5E5E5"> shared and then third it's self</font>

972
00:33:22,330 --> 00:33:27,070
deleting when it exits<font color="#E5E5E5"> so again these</font>

973
00:33:25,090 --> 00:33:29,290
<font color="#CCCCCC">are kind of all very malware like</font>

974
00:33:27,070 --> 00:33:30,879
activities that we could<font color="#CCCCCC"> quickly very</font>

975
00:33:29,290 --> 00:33:32,260
easily<font color="#E5E5E5"> see by</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> running this</font><font color="#CCCCCC"> command</font>

976
00:33:30,880 --> 00:33:33,970
line tool again we didn't have to dive

977
00:33:32,260 --> 00:33:35,770
into this assembly<font color="#E5E5E5"> and if we didn't know</font>

978
00:33:33,970 --> 00:33:37,150
what<font color="#E5E5E5"> this file was now we have some more</font>

979
00:33:35,770 --> 00:33:38,500
interesting<font color="#E5E5E5"> things that we can Google</font>

980
00:33:37,150 --> 00:33:41,290
<font color="#E5E5E5">for example the name of that launch</font>

981
00:33:38,500 --> 00:33:44,919
<font color="#E5E5E5">agent or again</font><font color="#CCCCCC"> just indicators</font><font color="#E5E5E5"> that yes</font>

982
00:33:41,290 --> 00:33:46,990
this<font color="#E5E5E5"> is probably malware now the</font>

983
00:33:44,919 --> 00:33:49,000
majority<font color="#E5E5E5"> as I mentioned of Mac malware</font>

984
00:33:46,990 --> 00:33:51,309
has<font color="#E5E5E5"> some networking component so I often</font>

985
00:33:49,000 --> 00:33:52,750
look at the network traffic<font color="#CCCCCC"> you know run</font>

986
00:33:51,309 --> 00:33:54,100
<font color="#E5E5E5">it in a virtual machine</font><font color="#CCCCCC"> and see you know</font>

987
00:33:52,750 --> 00:33:56,049
does it<font color="#E5E5E5"> talk out and what is what is</font>

988
00:33:54,100 --> 00:33:57,939
<font color="#E5E5E5">it's doing so I looked like</font><font color="#CCCCCC"> things I</font>

989
00:33:56,049 --> 00:33:59,860
look for things<font color="#CCCCCC"> like does it contain or</font>

990
00:33:57,940 --> 00:34:02,980
is it requesting to talk to you know odd

991
00:33:59,860 --> 00:34:05,260
<font color="#E5E5E5">or weird looking URLs or endpoints</font><font color="#CCCCCC"> so</font>

992
00:34:02,980 --> 00:34:08,440
for<font color="#E5E5E5"> example is it talking to like</font><font color="#CCCCCC"> iTunes</font>

993
00:34:05,260 --> 00:34:09,668
<font color="#E5E5E5">two</font><font color="#CCCCCC"> one two old</font><font color="#E5E5E5"> update three</font><font color="#CCCCCC"> comm or</font>

994
00:34:08,440 --> 00:34:11,230
something<font color="#E5E5E5"> right</font><font color="#CCCCCC"> something that's kind of</font>

995
00:34:09,668 --> 00:34:13,989
trying<font color="#E5E5E5"> to blend in but obviously is</font>

996
00:34:11,230 --> 00:34:15,639
probably suspicious also then<font color="#CCCCCC"> Google</font>

997
00:34:13,989 --> 00:34:17,560
those IP<font color="#CCCCCC"> addresses are those URLs</font>

998
00:34:15,639 --> 00:34:21,100
because<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> times adversaries will</font>

999
00:34:17,560 --> 00:34:23,049
use the same IP or URL in the same

1000
00:34:21,100 --> 00:34:25,060
infrastructure<font color="#E5E5E5"> across multiple malware</font>

1001
00:34:23,050 --> 00:34:27,639
so we've seen<font color="#E5E5E5"> instances where Windows</font>

1002
00:34:25,060 --> 00:34:29,379
malware<font color="#CCCCCC"> has been ported to Mac it hasn't</font>

1003
00:34:27,639 --> 00:34:31,359
been detected yet on Mac<font color="#E5E5E5"> but both the</font>

1004
00:34:29,379 --> 00:34:33,129
Windows and Mac versions<font color="#E5E5E5"> will talk to</font>

1005
00:34:31,359 --> 00:34:35,440
the same end<font color="#CCCCCC"> point and that end</font><font color="#E5E5E5"> point or</font>

1006
00:34:33,129 --> 00:34:37,299
URL has been blacklisted or<font color="#E5E5E5"> known</font><font color="#CCCCCC"> to be</font>

1007
00:34:35,440 --> 00:34:39,190
malicious<font color="#CCCCCC"> because of the analysis</font><font color="#E5E5E5"> done</font>

1008
00:34:37,300 --> 00:34:41,290
on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> windows an hour which is detected</font>

1009
00:34:39,190 --> 00:34:44,260
so thereby we<font color="#CCCCCC"> can say hey look if this</font>

1010
00:34:41,290 --> 00:34:46,090
unknown weird<font color="#CCCCCC"> Mac</font><font color="#E5E5E5"> piece of software is</font>

1011
00:34:44,260 --> 00:34:48,760
talking to the same malicious<font color="#E5E5E5"> end point</font>

1012
00:34:46,090 --> 00:34:51,669
<font color="#E5E5E5">it's probably gonna be malware I also</font>

1013
00:34:48,760 --> 00:34:53,740
see if it periodically<font color="#E5E5E5"> beacons</font><font color="#CCCCCC"> or does</font>

1014
00:34:51,668 --> 00:34:57,460
it<font color="#E5E5E5"> for example</font><font color="#CCCCCC"> will send</font><font color="#E5E5E5"> encrypted data</font>

1015
00:34:53,739 --> 00:34:59,919
over<font color="#CCCCCC"> HTTP as opposed to HTTPS so we see</font>

1016
00:34:57,460 --> 00:35:02,380
Mac malware sometimes<font color="#CCCCCC"> X touring payloads</font>

1017
00:34:59,920 --> 00:35:04,240
and<font color="#E5E5E5"> then sending it over HTTP which you</font>

1018
00:35:02,380 --> 00:35:07,750
know generally legitimate applications

1019
00:35:04,240 --> 00:35:09,279
don't<font color="#E5E5E5"> do that kind</font><font color="#CCCCCC"> of stuff it's another</font>

1020
00:35:07,750 --> 00:35:10,980
tool or rather service<font color="#E5E5E5"> I use when</font>

1021
00:35:09,280 --> 00:35:13,720
performing<font color="#E5E5E5"> analysis</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> virustotal</font>

1022
00:35:10,980 --> 00:35:15,250
sandbox<font color="#E5E5E5"> and this is a fairly</font><font color="#CCCCCC"> recent</font><font color="#E5E5E5"> tool</font>

1023
00:35:13,720 --> 00:35:17,770
that they released<font color="#E5E5E5"> basically you can</font>

1024
00:35:15,250 --> 00:35:20,260
upload<font color="#E5E5E5"> any file and it will run it in a</font>

1025
00:35:17,770 --> 00:35:22,990
instrument<font color="#CCCCCC"> in Mac sandbox</font><font color="#E5E5E5"> and give you a</font>

1026
00:35:20,260 --> 00:35:26,530
nice report of what exactly<font color="#E5E5E5"> is going on</font>

1027
00:35:22,990 --> 00:35:27,970
so<font color="#CCCCCC"> I uploaded I worm and I could see</font>

1028
00:35:26,530 --> 00:35:30,010
very<font color="#E5E5E5"> quickly once I got the report back</font>

1029
00:35:27,970 --> 00:35:30,939
<font color="#CCCCCC">the name of the</font><font color="#E5E5E5"> file it installed itself</font>

1030
00:35:30,010 --> 00:35:33,520
<font color="#CCCCCC">to how it</font>

1031
00:35:30,940 --> 00:35:34,900
persisted and what<font color="#CCCCCC"> URLs it was talking</font>

1032
00:35:33,520 --> 00:35:37,030
<font color="#CCCCCC">to</font><font color="#E5E5E5"> and in this case is actually talked</font>

1033
00:35:34,900 --> 00:35:39,609
to<font color="#E5E5E5"> reddit which is how it did its</font>

1034
00:35:37,030 --> 00:35:40,960
command and<font color="#E5E5E5"> control and tasking so again</font>

1035
00:35:39,609 --> 00:35:42,310
if you<font color="#CCCCCC"> have an</font><font color="#E5E5E5"> unknown binary that's</font>

1036
00:35:40,960 --> 00:35:43,720
unsigned that's packed

1037
00:35:42,310 --> 00:35:47,099
that's persisting that's talking to

1038
00:35:43,720 --> 00:35:49,450
<font color="#CCCCCC">reddit</font><font color="#E5E5E5"> like yeah it's gonna be malware</font>

1039
00:35:47,099 --> 00:35:51,819
all<font color="#E5E5E5"> right</font><font color="#CCCCCC"> now sometimes</font><font color="#E5E5E5"> you do have</font><font color="#CCCCCC"> to</font>

1040
00:35:49,450 --> 00:35:53,259
<font color="#CCCCCC">get down</font><font color="#E5E5E5"> and dirty and jump into a</font>

1041
00:35:51,819 --> 00:35:55,029
disassembler and do some reverse

1042
00:35:53,260 --> 00:35:57,790
engineering but it turns out if you know

1043
00:35:55,030 --> 00:36:01,480
a few basic<font color="#CCCCCC"> things</font><font color="#E5E5E5"> you can kind</font><font color="#CCCCCC"> of you</font>

1044
00:35:57,790 --> 00:36:03,430
know do<font color="#CCCCCC"> 8090</font><font color="#E5E5E5"> percent of this</font><font color="#CCCCCC"> so it's</font>

1045
00:36:01,480 --> 00:36:05,290
<font color="#E5E5E5">really not too</font><font color="#CCCCCC"> bad if you know</font><font color="#E5E5E5"> a few</font>

1046
00:36:03,430 --> 00:36:06,790
<font color="#CCCCCC">basic things so most malware is gonna be</font>

1047
00:36:05,290 --> 00:36:08,980
written or currently is written in

1048
00:36:06,790 --> 00:36:10,540
<font color="#E5E5E5">Objective C I'm not aware of any Swift</font>

1049
00:36:08,980 --> 00:36:13,930
malware yet but there's still some

1050
00:36:10,540 --> 00:36:15,849
commonalities<font color="#E5E5E5"> so malware or legitimate</font>

1051
00:36:13,930 --> 00:36:18,310
software<font color="#E5E5E5"> that's written in Objective C</font>

1052
00:36:15,849 --> 00:36:20,050
<font color="#E5E5E5">any time it makes a class method call</font>

1053
00:36:18,310 --> 00:36:23,410
<font color="#E5E5E5">it's gonna go through a function called</font>

1054
00:36:20,050 --> 00:36:25,240
<font color="#E5E5E5">obscene send message and this is</font>

1055
00:36:23,410 --> 00:36:27,250
documented<font color="#E5E5E5"> by Apple and it has it's</font>

1056
00:36:25,240 --> 00:36:29,589
calling convention<font color="#E5E5E5"> so you can see for</font>

1057
00:36:27,250 --> 00:36:31,869
<font color="#CCCCCC">example the first</font><font color="#E5E5E5"> argument is</font><font color="#CCCCCC"> the class</font>

1058
00:36:29,589 --> 00:36:36,130
<font color="#CCCCCC">the second one is the method name and</font>

1059
00:36:31,869 --> 00:36:38,650
then any arguments so here you can see

1060
00:36:36,130 --> 00:36:41,020
<font color="#E5E5E5">you know if you don't want to do that</font>

1061
00:36:38,650 --> 00:36:43,960
<font color="#E5E5E5">low-level disassembly you can also use a</font>

1062
00:36:41,020 --> 00:36:45,579
<font color="#E5E5E5">decompile addy compiler app and this</font><font color="#CCCCCC"> is</font>

1063
00:36:43,960 --> 00:36:46,720
kind of nice<font color="#E5E5E5"> there's actually</font><font color="#CCCCCC"> one called</font>

1064
00:36:45,579 --> 00:36:48,460
hopper that<font color="#CCCCCC"> I think there's only</font><font color="#E5E5E5"> like</font>

1065
00:36:46,720 --> 00:36:51,368
<font color="#E5E5E5">$30 if you don't want to buy the more</font>

1066
00:36:48,460 --> 00:36:53,410
expensive<font color="#CCCCCC"> one</font><font color="#E5E5E5"> from from Ida</font><font color="#CCCCCC"> and you can</font>

1067
00:36:51,369 --> 00:36:55,000
see in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> gray there's the disassembly</font>

1068
00:36:53,410 --> 00:36:57,129
which is kind<font color="#E5E5E5"> of hard to read but then</font>

1069
00:36:55,000 --> 00:36:59,680
the decompile<font color="#CCCCCC"> the compilation is</font>

1070
00:36:57,130 --> 00:37:00,760
actually pretty<font color="#E5E5E5"> easy to see so here you</font>

1071
00:36:59,680 --> 00:37:03,490
can see there's a method<font color="#CCCCCC"> called</font>

1072
00:37:00,760 --> 00:37:06,520
connected to internet<font color="#E5E5E5"> and we can see</font>

1073
00:37:03,490 --> 00:37:09,009
<font color="#E5E5E5">that it's building</font><font color="#CCCCCC"> a string google</font><font color="#E5E5E5"> comm</font>

1074
00:37:06,520 --> 00:37:10,900
<font color="#E5E5E5">and then it calls NS data data with</font>

1075
00:37:09,010 --> 00:37:13,030
contents of URL and we can see it

1076
00:37:10,900 --> 00:37:16,569
returns a true and false<font color="#CCCCCC"> if it was</font><font color="#E5E5E5"> able</font>

1077
00:37:13,030 --> 00:37:18,099
to<font color="#E5E5E5"> load this so this is how this malware</font>

1078
00:37:16,569 --> 00:37:20,200
<font color="#E5E5E5">is checking if it's</font><font color="#CCCCCC"> connected to</font><font color="#E5E5E5"> the</font>

1079
00:37:18,099 --> 00:37:21,849
<font color="#CCCCCC">Internet so again like if you understand</font>

1080
00:37:20,200 --> 00:37:23,348
how<font color="#CCCCCC"> to read</font><font color="#E5E5E5"> C or you've done some</font>

1081
00:37:21,849 --> 00:37:25,420
programming<font color="#E5E5E5"> you know this is the</font><font color="#CCCCCC"> output</font>

1082
00:37:23,349 --> 00:37:27,040
<font color="#E5E5E5">from the D compiler</font><font color="#CCCCCC"> or like that's not</font>

1083
00:37:25,420 --> 00:37:28,599
too complicated<font color="#CCCCCC"> to understand what's</font>

1084
00:37:27,040 --> 00:37:30,220
going<font color="#CCCCCC"> on so talk a lot of people that</font>

1085
00:37:28,599 --> 00:37:31,750
<font color="#E5E5E5">kind of a little wary of kind of getting</font>

1086
00:37:30,220 --> 00:37:32,828
<font color="#E5E5E5">into</font><font color="#CCCCCC"> the little level details and yeah</font>

1087
00:37:31,750 --> 00:37:35,170
it's<font color="#E5E5E5"> very easy to</font><font color="#CCCCCC"> go down the rabbit</font>

1088
00:37:32,829 --> 00:37:36,760
<font color="#CCCCCC">hole of reversing it Ida but</font><font color="#E5E5E5"> using a</font><font color="#CCCCCC"> D</font>

1089
00:37:35,170 --> 00:37:38,050
compiler or something a<font color="#E5E5E5"> lot of times you</font>

1090
00:37:36,760 --> 00:37:42,099
can<font color="#E5E5E5"> get a pretty good</font><font color="#CCCCCC"> understanding of</font>

1091
00:37:38,050 --> 00:37:44,170
<font color="#E5E5E5">exactly</font><font color="#CCCCCC"> what the</font><font color="#E5E5E5"> Mauer is doing now</font>

1092
00:37:42,099 --> 00:37:44,920
<font color="#E5E5E5">sometimes it's easier to do some dynamic</font>

1093
00:37:44,170 --> 00:37:47,590
<font color="#E5E5E5">debug</font>

1094
00:37:44,920 --> 00:37:49,060
again debugging can be complicated<font color="#E5E5E5"> but</font>

1095
00:37:47,590 --> 00:37:52,330
<font color="#E5E5E5">again there's a few things you can do</font>

1096
00:37:49,060 --> 00:37:55,240
that<font color="#CCCCCC"> make it a lot</font><font color="#E5E5E5"> easier so</font><font color="#CCCCCC"> lld b is</font>

1097
00:37:52,330 --> 00:37:57,100
the debugger that<font color="#E5E5E5"> ships with apple</font><font color="#CCCCCC"> it's</font>

1098
00:37:55,240 --> 00:37:59,290
<font color="#E5E5E5">command line base which</font><font color="#CCCCCC"> isn't ideal but</font>

1099
00:37:57,100 --> 00:38:02,470
<font color="#CCCCCC">it works and</font><font color="#E5E5E5"> there's a few commands that</font>

1100
00:37:59,290 --> 00:38:04,690
<font color="#E5E5E5">I use and</font><font color="#CCCCCC"> that gets you like 95%</font><font color="#E5E5E5"> of the</font>

1101
00:38:02,470 --> 00:38:06,339
way there<font color="#CCCCCC"> so you know they're pretty</font>

1102
00:38:04,690 --> 00:38:08,140
<font color="#E5E5E5">self-explanatory</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can set break point</font>

1103
00:38:06,340 --> 00:38:09,850
<font color="#E5E5E5">on functions break point on memory</font>

1104
00:38:08,140 --> 00:38:11,770
addresses<font color="#E5E5E5"> but what I like the</font><font color="#CCCCCC"> best is</font>

1105
00:38:09,850 --> 00:38:13,420
<font color="#E5E5E5">the PIO command and the PIO command</font>

1106
00:38:11,770 --> 00:38:14,920
stands for print objects<font color="#E5E5E5"> and if you give</font>

1107
00:38:13,420 --> 00:38:16,840
<font color="#E5E5E5">it a memory address and it's an</font>

1108
00:38:14,920 --> 00:38:18,430
objective-c object<font color="#E5E5E5"> it's smart enough</font><font color="#CCCCCC"> to</font>

1109
00:38:16,840 --> 00:38:21,100
figure<font color="#E5E5E5"> out what it</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> and will nicely</font>

1110
00:38:18,430 --> 00:38:23,350
display it for<font color="#CCCCCC"> you so if</font><font color="#E5E5E5"> the malware for</font>

1111
00:38:21,100 --> 00:38:25,600
example is downloading<font color="#E5E5E5"> you know a blob</font>

1112
00:38:23,350 --> 00:38:28,540
of data or it's loading some<font color="#CCCCCC"> pea list</font><font color="#E5E5E5"> or</font>

1113
00:38:25,600 --> 00:38:30,069
a<font color="#E5E5E5"> dictionary or array you can type</font><font color="#CCCCCC"> P o</font>

1114
00:38:28,540 --> 00:38:31,600
and then<font color="#E5E5E5"> put address of that array in</font>

1115
00:38:30,070 --> 00:38:33,880
dictionary<font color="#E5E5E5"> it'll actually show you all</font>

1116
00:38:31,600 --> 00:38:37,150
the contents of<font color="#CCCCCC"> that array so if it has</font>

1117
00:38:33,880 --> 00:38:38,500
like an array of<font color="#E5E5E5"> you know IP addresses</font>

1118
00:38:37,150 --> 00:38:40,360
of<font color="#CCCCCC"> the commanding</font><font color="#E5E5E5"> control server the</font>

1119
00:38:38,500 --> 00:38:43,030
debugger will nicely print that<font color="#CCCCCC"> out and</font>

1120
00:38:40,360 --> 00:38:44,260
<font color="#E5E5E5">even if those are for example obfuscated</font>

1121
00:38:43,030 --> 00:38:45,850
or encrypted<font color="#E5E5E5"> at some point in the</font>

1122
00:38:44,260 --> 00:38:46,930
malware<font color="#E5E5E5"> is gonna have to decrypt that so</font>

1123
00:38:45,850 --> 00:38:48,640
if you set the<font color="#E5E5E5"> breakpoint in the right</font>

1124
00:38:46,930 --> 00:38:50,799
place you<font color="#CCCCCC"> can nicely dump those and</font>

1125
00:38:48,640 --> 00:38:54,220
<font color="#E5E5E5">figure</font><font color="#CCCCCC"> out the addresses of</font><font color="#E5E5E5"> the command</font>

1126
00:38:50,800 --> 00:38:56,320
control server<font color="#E5E5E5"> okay so that wraps up the</font>

1127
00:38:54,220 --> 00:38:59,500
section on analysis hopefully if you use

1128
00:38:56,320 --> 00:39:00,370
those tools<font color="#E5E5E5"> and follow those steps you</font>

1129
00:38:59,500 --> 00:39:03,420
<font color="#CCCCCC">should be able</font><font color="#E5E5E5"> to figure out</font><font color="#CCCCCC"> if</font>

1130
00:39:00,370 --> 00:39:05,350
<font color="#CCCCCC">something</font><font color="#E5E5E5"> is you know malicious or not</font>

1131
00:39:03,420 --> 00:39:06,700
so hopefully<font color="#E5E5E5"> you already knew are now</font>

1132
00:39:05,350 --> 00:39:09,640
convinced that<font color="#CCCCCC"> Mac's</font>

1133
00:39:06,700 --> 00:39:11,770
can get malware pretty easily<font color="#E5E5E5"> so</font><font color="#CCCCCC"> people</font>

1134
00:39:09,640 --> 00:39:13,299
<font color="#E5E5E5">ask me you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> what do you do - you</font>

1135
00:39:11,770 --> 00:39:15,910
know<font color="#E5E5E5"> secure your macro you know what are</font>

1136
00:39:13,300 --> 00:39:17,920
best<font color="#CCCCCC"> practices to ensure that we don't</font>

1137
00:39:15,910 --> 00:39:21,009
<font color="#E5E5E5">get infected to begin with because you</font>

1138
00:39:17,920 --> 00:39:22,510
<font color="#E5E5E5">know getting infected</font><font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of sucks so</font>

1139
00:39:21,010 --> 00:39:24,430
<font color="#CCCCCC">at</font><font color="#E5E5E5"> first you know there's a lot of Mac</font>

1140
00:39:22,510 --> 00:39:26,950
users<font color="#CCCCCC"> out there</font><font color="#E5E5E5"> that now somewhat</font>

1141
00:39:24,430 --> 00:39:30,040
begrudgingly agree that yes<font color="#E5E5E5"> Mac's can</font>

1142
00:39:26,950 --> 00:39:31,779
get<font color="#CCCCCC"> malware they really have drank</font><font color="#E5E5E5"> the</font>

1143
00:39:30,040 --> 00:39:33,279
apple<font color="#E5E5E5"> juice and you know says</font><font color="#CCCCCC"> Apple has</font>

1144
00:39:31,780 --> 00:39:35,110
all these built-in security mechanisms

1145
00:39:33,280 --> 00:39:37,900
and it's<font color="#E5E5E5"> really hard to get back malware</font>

1146
00:39:35,110 --> 00:39:40,390
and that's not really<font color="#CCCCCC"> that true</font><font color="#E5E5E5"> Apple</font>

1147
00:39:37,900 --> 00:39:41,710
does thank us for<font color="#CCCCCC"> thinking that</font><font color="#E5E5E5"> but you</font>

1148
00:39:40,390 --> 00:39:42,910
know as with any<font color="#CCCCCC"> operating system</font>

1149
00:39:41,710 --> 00:39:45,190
there's gonna be ways to<font color="#CCCCCC"> get around</font>

1150
00:39:42,910 --> 00:39:47,529
<font color="#CCCCCC">these security mitigations</font><font color="#E5E5E5"> recently</font>

1151
00:39:45,190 --> 00:39:50,380
there's been<font color="#CCCCCC"> a</font><font color="#E5E5E5"> bunch of talks</font><font color="#CCCCCC"> that kind</font>

1152
00:39:47,530 --> 00:39:51,730
<font color="#E5E5E5">of show how easy it is to get around so</font>

1153
00:39:50,380 --> 00:39:54,520
you know for<font color="#CCCCCC"> example</font><font color="#E5E5E5"> how to exploit the</font>

1154
00:39:51,730 --> 00:39:56,680
kernel how to bypass gatekeeper how to

1155
00:39:54,520 --> 00:39:57,970
bypass<font color="#E5E5E5"> system integrity</font><font color="#CCCCCC"> protection</font><font color="#E5E5E5"> you</font>

1156
00:39:56,680 --> 00:39:58,600
know so most<font color="#E5E5E5"> of</font><font color="#CCCCCC"> apples current security</font>

1157
00:39:57,970 --> 00:40:00,790
mitigation

1158
00:39:58,600 --> 00:40:03,790
<font color="#E5E5E5">are unfortunately pretty easy to buy</font>

1159
00:40:00,790 --> 00:40:05,500
<font color="#CCCCCC">docile so I want to show a</font><font color="#E5E5E5"> video that</font>

1160
00:40:03,790 --> 00:40:07,330
kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> illustrates one of these</font>

1161
00:40:05,500 --> 00:40:09,370
bypasses<font color="#E5E5E5"> so this is gonna be</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> gate</font>

1162
00:40:07,330 --> 00:40:11,920
<font color="#E5E5E5">keeper bypass</font><font color="#CCCCCC"> now gate keeper is a</font>

1163
00:40:09,370 --> 00:40:13,480
built-in security<font color="#E5E5E5"> component of Mac OS X</font>

1164
00:40:11,920 --> 00:40:14,770
so it's<font color="#CCCCCC"> an all your Mac computers</font><font color="#E5E5E5"> and it</font>

1165
00:40:13,480 --> 00:40:16,750
has a<font color="#E5E5E5"> single goal and that is to block</font>

1166
00:40:14,770 --> 00:40:18,130
<font color="#E5E5E5">unsigned code from the</font><font color="#CCCCCC"> internet it's</font>

1167
00:40:16,750 --> 00:40:21,220
actually a really<font color="#E5E5E5"> good</font><font color="#CCCCCC"> idea</font><font color="#E5E5E5"> because the</font>

1168
00:40:18,130 --> 00:40:22,930
<font color="#CCCCCC">majority of Mac malware is unsigned</font><font color="#E5E5E5"> and</font>

1169
00:40:21,220 --> 00:40:25,720
the majority of it requires users to

1170
00:40:22,930 --> 00:40:27,310
basically<font color="#E5E5E5"> click on it themselves</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> gate</font>

1171
00:40:25,720 --> 00:40:29,259
<font color="#E5E5E5">keeper was designed to basically protect</font>

1172
00:40:27,310 --> 00:40:31,540
<font color="#E5E5E5">users from getting tricked into</font>

1173
00:40:29,260 --> 00:40:33,880
<font color="#E5E5E5">downloading that flash update player and</font>

1174
00:40:31,540 --> 00:40:35,380
then running it<font color="#E5E5E5"> so a few observations</font>

1175
00:40:33,880 --> 00:40:37,420
<font color="#E5E5E5">what we're gonna do is we're gonna</font>

1176
00:40:35,380 --> 00:40:40,150
remotely infect<font color="#CCCCCC"> this system by man in</font>

1177
00:40:37,420 --> 00:40:42,100
the<font color="#E5E5E5"> middling</font><font color="#CCCCCC"> a unsecured download so</font>

1178
00:40:40,150 --> 00:40:43,960
downloaded that's distributed<font color="#CCCCCC"> over HTTP</font>

1179
00:40:42,100 --> 00:40:47,529
<font color="#E5E5E5">now gate keeper</font><font color="#CCCCCC"> should block this</font>

1180
00:40:43,960 --> 00:40:48,820
because one we<font color="#E5E5E5"> are modifying some</font>

1181
00:40:47,530 --> 00:40:50,170
downloaded software<font color="#E5E5E5"> which is going to</font>

1182
00:40:48,820 --> 00:40:51,820
<font color="#E5E5E5">break the digital signature of that</font>

1183
00:40:50,170 --> 00:40:53,950
software<font color="#E5E5E5"> and two we're gonna inject some</font>

1184
00:40:51,820 --> 00:40:55,420
in unsigned code into that so<font color="#E5E5E5"> again even</font>

1185
00:40:53,950 --> 00:40:57,310
<font color="#E5E5E5">if gate keeper didn't detect that the</font>

1186
00:40:55,420 --> 00:40:59,080
<font color="#E5E5E5">software had been modified in transit</font><font color="#CCCCCC"> it</font>

1187
00:40:57,310 --> 00:41:01,750
should not allow the unsigned<font color="#E5E5E5"> code to</font>

1188
00:40:59,080 --> 00:41:04,569
<font color="#E5E5E5">run because that's gatekeepers only job</font>

1189
00:41:01,750 --> 00:41:07,450
we can see that this was a fully patched

1190
00:41:04,570 --> 00:41:09,520
<font color="#E5E5E5">OS X Box gatekeeper was enabled there's</font>

1191
00:41:07,450 --> 00:41:12,549
only<font color="#CCCCCC"> four</font><font color="#E5E5E5"> launch items and there's no</font>

1192
00:41:09,520 --> 00:41:14,620
processes called<font color="#E5E5E5"> Java running so let's</font>

1193
00:41:12,550 --> 00:41:16,240
see this<font color="#E5E5E5"> video so imagine the user has</font>

1194
00:41:14,620 --> 00:41:17,410
gone to a talk<font color="#E5E5E5"> about Mac malware</font><font color="#CCCCCC"> they</font>

1195
00:41:16,240 --> 00:41:18,640
were a little freaked out and<font color="#E5E5E5"> I say okay</font>

1196
00:41:17,410 --> 00:41:20,890
I should at least<font color="#E5E5E5"> stall an</font><font color="#CCCCCC"> anti-virus</font>

1197
00:41:18,640 --> 00:41:21,279
product on<font color="#E5E5E5"> my</font><font color="#CCCCCC"> website computer</font><font color="#E5E5E5"> not a bad</font>

1198
00:41:20,890 --> 00:41:23,109
<font color="#CCCCCC">idea</font>

1199
00:41:21,280 --> 00:41:24,820
so they Google Kaspersky<font color="#CCCCCC"> persky's</font>

1200
00:41:23,110 --> 00:41:27,400
<font color="#CCCCCC">well-known and they go to Kaspersky is</font>

1201
00:41:24,820 --> 00:41:28,720
legitimate website we're not doing

1202
00:41:27,400 --> 00:41:30,550
anything to this<font color="#E5E5E5"> connection yet it's</font>

1203
00:41:28,720 --> 00:41:32,109
<font color="#E5E5E5">just loading the website nothing</font>

1204
00:41:30,550 --> 00:41:34,420
suspicious going<font color="#CCCCCC"> on however when they</font>

1205
00:41:32,110 --> 00:41:36,940
click download that installer is

1206
00:41:34,420 --> 00:41:39,370
distributed over HTTP<font color="#E5E5E5"> let me repeat that</font>

1207
00:41:36,940 --> 00:41:40,780
<font color="#E5E5E5">Kaspersky Internet</font><font color="#CCCCCC"> security company</font>

1208
00:41:39,370 --> 00:41:43,690
antivirus company is<font color="#E5E5E5"> distributing this</font>

1209
00:41:40,780 --> 00:41:46,000
<font color="#E5E5E5">offer over HTTP right it's 2016 what are</font>

1210
00:41:43,690 --> 00:41:47,560
they thinking<font color="#E5E5E5"> anyways as it's being</font>

1211
00:41:46,000 --> 00:41:48,670
download we<font color="#CCCCCC"> can man in the</font><font color="#E5E5E5"> middle of</font>

1212
00:41:47,560 --> 00:41:50,200
this<font color="#E5E5E5"> connection if we have a network</font>

1213
00:41:48,670 --> 00:41:51,640
<font color="#E5E5E5">capability or we're</font><font color="#CCCCCC"> on the same</font><font color="#E5E5E5"> network</font>

1214
00:41:50,200 --> 00:41:54,160
<font color="#E5E5E5">so what we're gonna do is we're gonna</font>

1215
00:41:51,640 --> 00:41:56,470
inject<font color="#CCCCCC"> a</font><font color="#E5E5E5"> known unsigned piece of malware</font>

1216
00:41:54,160 --> 00:41:59,109
into<font color="#CCCCCC"> this download</font><font color="#E5E5E5"> again</font><font color="#CCCCCC"> this will break</font>

1217
00:41:56,470 --> 00:42:01,330
the<font color="#E5E5E5"> digital signature of that dmg</font>

1218
00:41:59,110 --> 00:42:04,000
package and it's also injecting unsigned

1219
00:42:01,330 --> 00:42:06,460
code<font color="#E5E5E5"> so when the user double clicks this</font>

1220
00:42:04,000 --> 00:42:08,110
download because<font color="#E5E5E5"> Persky installer is</font>

1221
00:42:06,460 --> 00:42:09,460
gonna pop<font color="#CCCCCC"> up</font><font color="#E5E5E5"> and when they click on</font><font color="#CCCCCC"> it</font>

1222
00:42:08,110 --> 00:42:10,510
we're gonna see a pop-up that<font color="#CCCCCC"> says hey</font>

1223
00:42:09,460 --> 00:42:11,560
are<font color="#E5E5E5"> you</font><font color="#CCCCCC"> sure you want to</font><font color="#E5E5E5"> run this this</font>

1224
00:42:10,510 --> 00:42:13,060
is from<font color="#CCCCCC"> the internet</font>

1225
00:42:11,560 --> 00:42:15,520
now this is not<font color="#E5E5E5"> gate keeper and this</font>

1226
00:42:13,060 --> 00:42:16,990
<font color="#CCCCCC">pop-up will be displayed for any</font>

1227
00:42:15,520 --> 00:42:18,340
software<font color="#E5E5E5"> you download</font><font color="#CCCCCC"> from the internet</font>

1228
00:42:16,990 --> 00:42:19,930
so even if we hadn't<font color="#E5E5E5"> man in the middle</font>

1229
00:42:18,340 --> 00:42:22,240
of this<font color="#E5E5E5"> connection that pop-up would</font>

1230
00:42:19,930 --> 00:42:24,700
would have<font color="#E5E5E5"> occurred so they run it they</font>

1231
00:42:22,240 --> 00:42:25,720
install Kaspersky they're all happy<font color="#E5E5E5"> you</font>

1232
00:42:24,700 --> 00:42:26,649
know life is<font color="#CCCCCC"> good they're</font><font color="#E5E5E5"> getting an</font>

1233
00:42:25,720 --> 00:42:28,720
<font color="#E5E5E5">anti-virus product they think they're</font>

1234
00:42:26,650 --> 00:42:30,700
<font color="#E5E5E5">all stoked however if we</font><font color="#CCCCCC"> look at the</font>

1235
00:42:28,720 --> 00:42:34,060
process listing we can see a new process

1236
00:42:30,700 --> 00:42:36,490
is running<font color="#E5E5E5"> kind of hard to see but it's</font>

1237
00:42:34,060 --> 00:42:39,490
called Java W and if we look at the code

1238
00:42:36,490 --> 00:42:41,470
signature of<font color="#E5E5E5"> this new process</font><font color="#CCCCCC"> you can</font>

1239
00:42:39,490 --> 00:42:43,270
use the code sign tool command line tool

1240
00:42:41,470 --> 00:42:46,060
comes<font color="#CCCCCC"> with apple we can see that</font><font color="#E5E5E5"> it's</font>

1241
00:42:43,270 --> 00:42:47,350
not<font color="#E5E5E5"> signed at all this is not good</font><font color="#CCCCCC"> right</font>

1242
00:42:46,060 --> 00:42:48,270
<font color="#E5E5E5">keep</font><font color="#CCCCCC"> you're supposed to block on the</font>

1243
00:42:47,350 --> 00:42:51,100
sign code<font color="#CCCCCC"> formatting</font>

1244
00:42:48,270 --> 00:42:53,470
then if we go back to<font color="#CCCCCC"> knock</font><font color="#E5E5E5"> knock we've</font>

1245
00:42:51,100 --> 00:42:54,460
renewed the login items<font color="#E5E5E5"> the launch</font><font color="#CCCCCC"> items</font>

1246
00:42:53,470 --> 00:42:56,169
that are there and<font color="#E5E5E5"> we can see</font><font color="#CCCCCC"> that</font>

1247
00:42:54,460 --> 00:42:58,270
there's a new one<font color="#CCCCCC"> so not</font><font color="#E5E5E5"> only was this</font>

1248
00:42:56,170 --> 00:43:01,420
unsigned piece of code able to run it

1249
00:42:58,270 --> 00:43:02,980
was able<font color="#CCCCCC"> to persist for illustrative</font>

1250
00:43:01,420 --> 00:43:05,620
purposes I used an own piece<font color="#CCCCCC"> of malware</font>

1251
00:43:02,980 --> 00:43:07,240
<font color="#CCCCCC">I worm</font><font color="#E5E5E5"> again showing kind of how easy</font>

1252
00:43:05,620 --> 00:43:09,130
this<font color="#E5E5E5"> would be to do even with existing</font>

1253
00:43:07,240 --> 00:43:11,290
Bower<font color="#E5E5E5"> you don't have to</font><font color="#CCCCCC"> write or create</font>

1254
00:43:09,130 --> 00:43:14,140
new<font color="#E5E5E5"> malware and since it's known you can</font>

1255
00:43:11,290 --> 00:43:15,759
you know via knock knock<font color="#E5E5E5"> open the</font><font color="#CCCCCC"> virus</font>

1256
00:43:14,140 --> 00:43:17,470
<font color="#CCCCCC">total page and get information</font><font color="#E5E5E5"> about</font>

1257
00:43:15,760 --> 00:43:19,000
<font color="#E5E5E5">this so again this hopefully just</font>

1258
00:43:17,470 --> 00:43:20,919
illustrates that<font color="#E5E5E5"> yes there</font><font color="#CCCCCC"> are these</font>

1259
00:43:19,000 --> 00:43:22,660
<font color="#E5E5E5">built-in security</font><font color="#CCCCCC"> mechanisms</font><font color="#E5E5E5"> that Apple</font>

1260
00:43:20,920 --> 00:43:25,120
touts<font color="#CCCCCC"> and you know like if</font><font color="#E5E5E5"> you go to</font>

1261
00:43:22,660 --> 00:43:26,589
apple.com slash security it's like one

1262
00:43:25,120 --> 00:43:28,720
<font color="#E5E5E5">of the top</font><font color="#CCCCCC"> items and tells you</font><font color="#E5E5E5"> how</font>

1263
00:43:26,590 --> 00:43:30,010
amazing<font color="#CCCCCC"> it is if you really</font><font color="#E5E5E5"> look</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> it</font>

1264
00:43:28,720 --> 00:43:31,419
<font color="#E5E5E5">these security mitigations are really</font>

1265
00:43:30,010 --> 00:43:34,810
easy<font color="#E5E5E5"> to get around so it's just</font>

1266
00:43:31,420 --> 00:43:36,760
something<font color="#CCCCCC"> to be aware of so yeah what do</font>

1267
00:43:34,810 --> 00:43:38,259
I then<font color="#E5E5E5"> do to keep my Mac secure because</font>

1268
00:43:36,760 --> 00:43:40,840
I love my Mac products<font color="#CCCCCC"> right I have</font>

1269
00:43:38,260 --> 00:43:43,990
iPhones and<font color="#CCCCCC"> Macs like I'm set on them</font>

1270
00:43:40,840 --> 00:43:46,120
right so I'm not not<font color="#E5E5E5"> gonna use them one</font>

1271
00:43:43,990 --> 00:43:46,779
way I do is I run<font color="#E5E5E5"> a tool called OSX</font>

1272
00:43:46,120 --> 00:43:48,549
<font color="#E5E5E5">lockdown</font>

1273
00:43:46,780 --> 00:43:50,620
one of my friends<font color="#E5E5E5"> actually wrote the</font>

1274
00:43:48,550 --> 00:43:53,650
core component<font color="#E5E5E5"> of this and basically</font>

1275
00:43:50,620 --> 00:43:56,620
<font color="#E5E5E5">what it is it's a tool that basically</font>

1276
00:43:53,650 --> 00:43:58,930
<font color="#E5E5E5">tries to audit and remediate security</font>

1277
00:43:56,620 --> 00:44:00,910
configurations so it takes everything

1278
00:43:58,930 --> 00:44:02,500
<font color="#E5E5E5">that's in those long like how to harden</font>

1279
00:44:00,910 --> 00:44:04,569
<font color="#E5E5E5">your Mac</font><font color="#CCCCCC"> computer and does it</font>

1280
00:44:02,500 --> 00:44:06,250
programmatically<font color="#E5E5E5"> now that we wrote was</font>

1281
00:44:04,570 --> 00:44:08,830
great but<font color="#E5E5E5"> it</font><font color="#CCCCCC"> was a command-line tool so</font>

1282
00:44:06,250 --> 00:44:10,780
most<font color="#CCCCCC"> people you know</font><font color="#E5E5E5"> like nice UI so I</font>

1283
00:44:08,830 --> 00:44:12,940
wrote a free UI wrapper<font color="#CCCCCC"> that sits on</font><font color="#E5E5E5"> top</font>

1284
00:44:10,780 --> 00:44:15,490
<font color="#CCCCCC">of it</font><font color="#E5E5E5"> the UI wrapper is nice you can</font>

1285
00:44:12,940 --> 00:44:17,170
toggle off<font color="#E5E5E5"> different commands and you</font>

1286
00:44:15,490 --> 00:44:19,509
can run<font color="#E5E5E5"> them and so it can do things</font>

1287
00:44:17,170 --> 00:44:20,980
like<font color="#E5E5E5"> turn off airdrop</font><font color="#CCCCCC"> you know make sure</font>

1288
00:44:19,510 --> 00:44:22,810
<font color="#E5E5E5">the firewall is enabled make sure</font>

1289
00:44:20,980 --> 00:44:24,740
<font color="#CCCCCC">gatekeeper set</font><font color="#E5E5E5"> so they're</font><font color="#CCCCCC"> just good way</font>

1290
00:44:22,810 --> 00:44:27,350
to<font color="#E5E5E5"> reduce the</font><font color="#CCCCCC"> attack surface of your</font><font color="#E5E5E5"> Mac</font>

1291
00:44:24,740 --> 00:44:29,509
<font color="#CCCCCC">I also run a firewall product and</font>

1292
00:44:27,350 --> 00:44:30,770
<font color="#E5E5E5">currently I use Little Snitch</font><font color="#CCCCCC"> firewalls</font>

1293
00:44:29,510 --> 00:44:32,150
are great you know if a piece of malware

1294
00:44:30,770 --> 00:44:34,009
does get<font color="#E5E5E5"> on your system</font><font color="#CCCCCC"> and try to</font>

1295
00:44:32,150 --> 00:44:36,560
connect out the the firewall<font color="#CCCCCC"> will</font>

1296
00:44:34,010 --> 00:44:38,660
probably pop up and say hey you know

1297
00:44:36,560 --> 00:44:40,190
there's this unknown process connecting

1298
00:44:38,660 --> 00:44:42,230
out and that's a good indicator<font color="#CCCCCC"> that</font>

1299
00:44:40,190 --> 00:44:44,750
maybe you've<font color="#E5E5E5"> been infected talking at</font>

1300
00:44:42,230 --> 00:44:46,430
<font color="#CCCCCC">DEFCON in a few weeks turns out that</font>

1301
00:44:44,750 --> 00:44:47,720
when I audited<font color="#E5E5E5"> the kernel component</font><font color="#CCCCCC"> of</font>

1302
00:44:46,430 --> 00:44:48,649
Little Snitch there was some exploitable

1303
00:44:47,720 --> 00:44:50,029
heap overflows

1304
00:44:48,650 --> 00:44:52,040
so actually installing<font color="#E5E5E5"> this on your</font>

1305
00:44:50,030 --> 00:44:53,780
system made it your system less secure

1306
00:44:52,040 --> 00:44:56,290
as we often<font color="#E5E5E5"> see with antivirus products</font>

1307
00:44:53,780 --> 00:44:59,090
so you know it's<font color="#E5E5E5"> like great thanks guys</font>

1308
00:44:56,290 --> 00:45:01,340
and also<font color="#E5E5E5"> it turns out that if you talk</font>

1309
00:44:59,090 --> 00:45:03,320
to the kernel extension you<font color="#CCCCCC"> can invoke a</font>

1310
00:45:01,340 --> 00:45:05,240
method and you<font color="#E5E5E5"> can tell it</font><font color="#CCCCCC"> zero</font><font color="#E5E5E5"> and</font>

1311
00:45:03,320 --> 00:45:07,130
it'll shut<font color="#E5E5E5"> off the firewall even though</font>

1312
00:45:05,240 --> 00:45:08,810
the GUI says it's still running<font color="#CCCCCC"> so again</font>

1313
00:45:07,130 --> 00:45:10,250
any malware<font color="#E5E5E5"> that really wanted a bypass</font>

1314
00:45:08,810 --> 00:45:13,430
<font color="#CCCCCC">little snitch could like do this</font>

1315
00:45:10,250 --> 00:45:15,350
incredibly easily<font color="#E5E5E5"> but currently most Mac</font>

1316
00:45:13,430 --> 00:45:16,819
malware<font color="#E5E5E5"> actually will bail with a</font>

1317
00:45:15,350 --> 00:45:18,589
<font color="#E5E5E5">seasonal snitch or will be generically</font>

1318
00:45:16,820 --> 00:45:21,950
detected by<font color="#CCCCCC"> will stench okay that's good</font>

1319
00:45:18,590 --> 00:45:22,850
<font color="#E5E5E5">not to get overly you know it's think</font>

1320
00:45:21,950 --> 00:45:24,109
that these<font color="#E5E5E5"> tools are really</font><font color="#CCCCCC"> gonna</font>

1321
00:45:22,850 --> 00:45:27,770
<font color="#E5E5E5">protect you because</font><font color="#CCCCCC"> a lot of them</font>

1322
00:45:24,110 --> 00:45:29,840
actually<font color="#CCCCCC"> have security</font><font color="#E5E5E5"> issues</font><font color="#CCCCCC"> okay so I</font>

1323
00:45:27,770 --> 00:45:33,109
mentioned<font color="#CCCCCC"> I love</font><font color="#E5E5E5"> Apple but I don't think</font>

1324
00:45:29,840 --> 00:45:34,940
they love<font color="#E5E5E5"> me I'm</font><font color="#CCCCCC"> okay with that but I</font>

1325
00:45:33,109 --> 00:45:36,200
don't really<font color="#E5E5E5"> feel that safe on my Mac I</font>

1326
00:45:34,940 --> 00:45:37,609
do a lot<font color="#CCCCCC"> of reverse engineering and I</font>

1327
00:45:36,200 --> 00:45:39,500
keep<font color="#E5E5E5"> finding these bugs that report them</font>

1328
00:45:37,609 --> 00:45:42,500
an<font color="#E5E5E5"> Apple Apple patches oh my look at the</font>

1329
00:45:39,500 --> 00:45:44,570
<font color="#E5E5E5">patch</font><font color="#CCCCCC"> the patch is worthless</font><font color="#E5E5E5"> and like</font>

1330
00:45:42,500 --> 00:45:45,770
it's just some like come<font color="#E5E5E5"> on Apple</font><font color="#CCCCCC"> you</font>

1331
00:45:44,570 --> 00:45:46,700
know<font color="#CCCCCC"> I think</font><font color="#E5E5E5"> they</font><font color="#CCCCCC"> are trending</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> the</font>

1332
00:45:45,770 --> 00:45:49,009
right direction<font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't want to knock</font>

1333
00:45:46,700 --> 00:45:51,319
them too much but I really<font color="#CCCCCC"> wanted to do</font>

1334
00:45:49,010 --> 00:45:53,030
a little more<font color="#E5E5E5"> to basically secure my Mac</font>

1335
00:45:51,320 --> 00:45:55,550
computer so I figured<font color="#CCCCCC"> that I should</font>

1336
00:45:53,030 --> 00:45:57,050
<font color="#E5E5E5">write some free security tools and to</font>

1337
00:45:55,550 --> 00:45:58,840
first protect my Mac and then make them

1338
00:45:57,050 --> 00:46:01,310
<font color="#CCCCCC">available to two other Mac users</font>

1339
00:45:58,840 --> 00:46:02,630
apparently that's like a novel or weird

1340
00:46:01,310 --> 00:46:04,490
concept<font color="#E5E5E5"> people</font><font color="#CCCCCC"> think like if you're</font>

1341
00:46:02,630 --> 00:46:06,109
giving free software away it's either

1342
00:46:04,490 --> 00:46:08,029
like<font color="#E5E5E5"> backdoored or you have some</font>

1343
00:46:06,109 --> 00:46:09,830
alternate agenda so I get<font color="#E5E5E5"> I got all</font>

1344
00:46:08,030 --> 00:46:13,160
<font color="#E5E5E5">these funny</font><font color="#CCCCCC"> emails about</font><font color="#E5E5E5"> it but you know</font>

1345
00:46:09,830 --> 00:46:15,740
<font color="#E5E5E5">is what it is so my side hobby is</font><font color="#CCCCCC"> to run</font>

1346
00:46:13,160 --> 00:46:17,600
a<font color="#E5E5E5"> Mac security website and write free</font>

1347
00:46:15,740 --> 00:46:19,970
Mac security<font color="#E5E5E5"> tools we've talked</font><font color="#CCCCCC"> about a</font>

1348
00:46:17,600 --> 00:46:22,279
lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> them in this presentation for</font>

1349
00:46:19,970 --> 00:46:24,140
<font color="#E5E5E5">example</font><font color="#CCCCCC"> tasks explore</font><font color="#E5E5E5"> knock-knock</font><font color="#CCCCCC"> lock</font>

1350
00:46:22,280 --> 00:46:26,930
lock is an<font color="#CCCCCC"> interesting tool it basically</font>

1351
00:46:24,140 --> 00:46:29,089
monitors persistence locations that<font color="#E5E5E5"> the</font>

1352
00:46:26,930 --> 00:46:30,830
ones<font color="#CCCCCC"> knock knock enumerates</font><font color="#E5E5E5"> so if</font>

1353
00:46:29,090 --> 00:46:33,170
<font color="#E5E5E5">anything tries to persist you'll get a</font>

1354
00:46:30,830 --> 00:46:35,330
<font color="#E5E5E5">pop-up saying hey process XYZ is trying</font>

1355
00:46:33,170 --> 00:46:37,130
to persistently install itself<font color="#E5E5E5"> and it's</font>

1356
00:46:35,330 --> 00:46:39,290
kind of cool<font color="#CCCCCC"> because I launched</font>

1357
00:46:37,130 --> 00:46:41,510
about a year<font color="#CCCCCC"> and a half ago</font><font color="#E5E5E5"> and every</font>

1358
00:46:39,290 --> 00:46:43,370
single<font color="#E5E5E5"> piece of publicly discovered Mac</font>

1359
00:46:41,510 --> 00:46:45,620
malware<font color="#E5E5E5"> that came out since that that's</font>

1360
00:46:43,370 --> 00:46:47,930
tried to persist<font color="#E5E5E5"> block block was</font>

1361
00:46:45,620 --> 00:46:49,460
generically able to pop up<font color="#E5E5E5"> now if users</font>

1362
00:46:47,930 --> 00:46:51,049
still click allow<font color="#CCCCCC"> you know there's</font>

1363
00:46:49,460 --> 00:46:53,000
always<font color="#CCCCCC"> that problem than that will will</font>

1364
00:46:51,050 --> 00:46:54,590
<font color="#E5E5E5">be able to persist but again for</font>

1365
00:46:53,000 --> 00:46:56,840
security conscious users it's kind<font color="#CCCCCC"> of a</font>

1366
00:46:54,590 --> 00:46:58,940
nice<font color="#CCCCCC"> thing to</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> text viewer shows you</font>

1367
00:46:56,840 --> 00:47:01,220
all loaded kernel extensions<font color="#E5E5E5"> hijack</font>

1368
00:46:58,940 --> 00:47:03,650
scanner shows you<font color="#E5E5E5"> dynamic libraries that</font>

1369
00:47:01,220 --> 00:47:04,939
<font color="#CCCCCC">have been hijacked asti</font><font color="#E5E5E5"> aureus is just a</font>

1370
00:47:03,650 --> 00:47:06,710
kernel extension to supplement

1371
00:47:04,940 --> 00:47:08,120
gatekeeper until<font color="#CCCCCC"> Apple fixes the</font>

1372
00:47:06,710 --> 00:47:10,670
fundamental underlying issues with

1373
00:47:08,120 --> 00:47:12,200
gatekeeper<font color="#E5E5E5"> and then ransomware is kind</font>

1374
00:47:10,670 --> 00:47:13,730
of<font color="#E5E5E5"> any tool that</font><font color="#CCCCCC"> I just released</font><font color="#E5E5E5"> and</font>

1375
00:47:12,200 --> 00:47:16,370
what it does is it monitors the<font color="#CCCCCC"> file</font>

1376
00:47:13,730 --> 00:47:19,010
<font color="#E5E5E5">system and looks for untrusted processes</font>

1377
00:47:16,370 --> 00:47:21,259
<font color="#E5E5E5">creating encrypted files which is what</font>

1378
00:47:19,010 --> 00:47:22,970
ransomware<font color="#E5E5E5"> does so it's kind of cool</font>

1379
00:47:21,260 --> 00:47:25,670
<font color="#CCCCCC">because as of</font><font color="#E5E5E5"> now it can generically</font>

1380
00:47:22,970 --> 00:47:28,959
detect all OSX ransomware<font color="#E5E5E5"> without any</font>

1381
00:47:25,670 --> 00:47:32,330
signatures<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so let's wrap this up</font>

1382
00:47:28,960 --> 00:47:35,600
<font color="#CCCCCC">pretty much out of time</font><font color="#E5E5E5"> but what we've</font>

1383
00:47:32,330 --> 00:47:37,430
<font color="#CCCCCC">learned is yes max get malware you know</font>

1384
00:47:35,600 --> 00:47:38,900
it's good<font color="#CCCCCC"> to realize</font><font color="#E5E5E5"> that but you know</font>

1385
00:47:37,430 --> 00:47:40,370
if we<font color="#CCCCCC"> use some of</font><font color="#E5E5E5"> the tools I discussed</font>

1386
00:47:38,900 --> 00:47:42,020
in the built-in<font color="#E5E5E5"> ones the ones that are</font>

1387
00:47:40,370 --> 00:47:43,700
freely<font color="#E5E5E5"> available online</font><font color="#CCCCCC"> we can get a</font>

1388
00:47:42,020 --> 00:47:46,250
<font color="#E5E5E5">pretty good</font><font color="#CCCCCC"> understanding</font><font color="#E5E5E5"> you know if</font>

1389
00:47:43,700 --> 00:47:48,980
the<font color="#E5E5E5"> system is infected and if it is what</font>

1390
00:47:46,250 --> 00:47:50,450
the malware<font color="#E5E5E5"> is actually doing</font><font color="#CCCCCC"> it's a</font>

1391
00:47:48,980 --> 00:47:52,340
good idea to scan<font color="#E5E5E5"> your computer install</font>

1392
00:47:50,450 --> 00:47:54,799
maybe a firewall product a little<font color="#CCCCCC"> since</font>

1393
00:47:52,340 --> 00:47:58,370
hopefully<font color="#E5E5E5"> is better than nothing</font><font color="#CCCCCC"> and</font>

1394
00:47:54,800 --> 00:48:01,040
some third-party tools so I<font color="#CCCCCC"> think I have</font>

1395
00:47:58,370 --> 00:48:02,930
a minute<font color="#E5E5E5"> or two maybe uh if there's any</font>

1396
00:48:01,040 --> 00:48:04,759
<font color="#CCCCCC">questions we can do that</font><font color="#E5E5E5"> now also I</font>

1397
00:48:02,930 --> 00:48:06,410
<font color="#CCCCCC">should be around</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> rest of</font><font color="#E5E5E5"> the day so</font>

1398
00:48:04,760 --> 00:48:10,370
thank<font color="#E5E5E5"> you for listening if you have any</font>

1399
00:48:06,410 --> 00:48:14,149
any<font color="#CCCCCC"> questions and if you just wanna get</font>

1400
00:48:10,370 --> 00:48:15,430
<font color="#E5E5E5">to lunch I understand that</font><font color="#CCCCCC"> - I'm right</font>

1401
00:48:14,150 --> 00:48:17,360
behind<font color="#E5E5E5"> you</font>

1402
00:48:15,430 --> 00:48:18,379
awesome well thanks again<font color="#E5E5E5"> feel free</font><font color="#CCCCCC"> to</font>

1403
00:48:17,360 --> 00:48:21,300
follow me<font color="#CCCCCC"> on Twitter or shoot me</font><font color="#E5E5E5"> an</font>

1404
00:48:18,380 --> 00:48:23,360
email<font color="#CCCCCC"> really appreciate</font><font color="#E5E5E5"> it</font>

1405
00:48:21,300 --> 00:48:23,360
you

