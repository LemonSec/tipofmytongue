1
00:00:00,110 --> 00:00:06,000
hi<font color="#E5E5E5"> so I'm really happy to be here</font><font color="#CCCCCC"> I'll</font>

2
00:00:03,600 --> 00:00:08,250
<font color="#CCCCCC">take</font><font color="#E5E5E5"> it but</font><font color="#CCCCCC"> I think I'm sure it might</font>

3
00:00:06,000 --> 00:00:10,260
<font color="#CCCCCC">set Chaka Khan</font><font color="#E5E5E5"> and every year it's</font>

4
00:00:08,250 --> 00:00:19,050
become<font color="#CCCCCC"> bigger and begun it's</font><font color="#E5E5E5"> really nice</font>

5
00:00:10,260 --> 00:00:21,509
<font color="#CCCCCC">to</font><font color="#E5E5E5"> me to be there so let's start so my</font>

6
00:00:19,050 --> 00:00:23,789
name<font color="#E5E5E5"> is Boris Kenya so for English</font>

7
00:00:21,510 --> 00:00:27,240
<font color="#E5E5E5">people it's not so easy</font><font color="#CCCCCC"> to pronounce</font><font color="#E5E5E5"> and</font>

8
00:00:23,789 --> 00:00:30,420
generate to be funny for<font color="#E5E5E5"> me and I'm from</font>

9
00:00:27,240 --> 00:00:32,879
<font color="#E5E5E5">France and I will use my best publish</font>

10
00:00:30,420 --> 00:00:36,030
for you today and I'm security

11
00:00:32,880 --> 00:00:38,550
researcher<font color="#CCCCCC"> at italo's and involved</font><font color="#E5E5E5"> in</font>

12
00:00:36,030 --> 00:00:41,450
<font color="#CCCCCC">malaria research</font><font color="#E5E5E5"> reverse engineering and</font>

13
00:00:38,550 --> 00:00:44,489
stuff<font color="#E5E5E5"> like that for seven years</font><font color="#CCCCCC"> so</font>

14
00:00:41,450 --> 00:00:47,129
additionally I'm one of the<font color="#CCCCCC"> organizer</font><font color="#E5E5E5"> of</font>

15
00:00:44,489 --> 00:00:49,288
<font color="#CCCCCC">boot camp</font><font color="#E5E5E5"> have conference located in</font>

16
00:00:47,129 --> 00:00:53,070
France and we are<font color="#CCCCCC"> looking for for</font>

17
00:00:49,289 --> 00:00:56,100
sponsor<font color="#E5E5E5"> of course and the CFP is still</font>

18
00:00:53,070 --> 00:00:59,160
open<font color="#CCCCCC"> it will be closed</font><font color="#E5E5E5"> on Saturday so if</font>

19
00:00:56,100 --> 00:01:01,739
you have research about but net<font color="#E5E5E5"> malware</font>

20
00:00:59,160 --> 00:01:03,718
<font color="#CCCCCC">incident</font><font color="#E5E5E5"> response all this kind of topic</font>

21
00:01:01,739 --> 00:01:09,270
we already interested and feel free to

22
00:01:03,719 --> 00:01:11,670
to reply to<font color="#CCCCCC"> the CFP so I didn't do</font><font color="#E5E5E5"> this</font>

23
00:01:09,270 --> 00:01:14,490
research<font color="#CCCCCC"> alone I work with the with a</font>

24
00:01:11,670 --> 00:01:20,520
colleague and I got<font color="#E5E5E5"> a bio for my</font>

25
00:01:14,490 --> 00:01:22,500
<font color="#CCCCCC">colleague to the</font><font color="#E5E5E5"> Warren so just for</font>

26
00:01:20,520 --> 00:01:25,408
information he doesn't know I've got

27
00:01:22,500 --> 00:01:29,250
this picture<font color="#E5E5E5"> of him so I really</font>

28
00:01:25,409 --> 00:01:32,119
<font color="#CCCCCC">recommend you</font><font color="#E5E5E5"> to take a picture</font><font color="#CCCCCC"> tweet to</font>

29
00:01:29,250 --> 00:01:35,700
him with the picture and add the hashtag

30
00:01:32,119 --> 00:01:37,770
cyber cowboy I think he's sleeping he

31
00:01:35,700 --> 00:01:39,329
will be really<font color="#E5E5E5"> happy to have this a lot</font>

32
00:01:37,770 --> 00:01:42,750
of<font color="#E5E5E5"> tweets like that tomorrow</font><font color="#CCCCCC"> morning</font>

33
00:01:39,329 --> 00:01:45,800
when when he<font color="#E5E5E5"> will wake up I think</font><font color="#CCCCCC"> it's</font>

34
00:01:42,750 --> 00:01:49,470
going<font color="#CCCCCC"> to be fun or</font><font color="#E5E5E5"> not I would say</font>

35
00:01:45,800 --> 00:01:51,929
so<font color="#CCCCCC"> Costco's</font><font color="#E5E5E5"> organized a conference</font><font color="#CCCCCC"> too</font>

36
00:01:49,470 --> 00:01:55,200
but it's in the island so it's raining

37
00:01:51,930 --> 00:01:56,730
<font color="#E5E5E5">it's blood</font><font color="#CCCCCC"> setup chip</font><font color="#E5E5E5"> so going friends</font>

38
00:01:55,200 --> 00:02:05,190
and don't go at this conference<font color="#CCCCCC"> of</font>

39
00:01:56,730 --> 00:02:08,490
course it's a second<font color="#E5E5E5"> point and yeah why</font>

40
00:02:05,190 --> 00:02:12,840
I'm here today<font color="#E5E5E5"> so I'm going to show you</font>

41
00:02:08,490 --> 00:02:16,770
how apt actors<font color="#CCCCCC"> is changing the way of</font>

42
00:02:12,840 --> 00:02:20,640
the use infection vector to<font color="#CCCCCC"> be a real</font>

43
00:02:16,770 --> 00:02:23,520
pain in<font color="#CCCCCC"> cs4 Marvel</font><font color="#E5E5E5"> analyzed they modify</font>

44
00:02:20,640 --> 00:02:25,559
some stuff to block us during<font color="#E5E5E5"> analysis</font>

45
00:02:23,520 --> 00:02:29,490
and I will show you five case studies

46
00:02:25,560 --> 00:02:33,200
where we had a lot<font color="#CCCCCC"> of parent to have a</font>

47
00:02:29,490 --> 00:02:36,060
big<font color="#CCCCCC"> picture of how</font><font color="#E5E5E5"> it works houses actor</font>

48
00:02:33,200 --> 00:02:41,310
<font color="#E5E5E5">compromised system because they start to</font>

49
00:02:36,060 --> 00:02:44,460
<font color="#CCCCCC">use</font><font color="#E5E5E5"> interesting tricks</font><font color="#CCCCCC"> I will mean</font>

50
00:02:41,310 --> 00:02:48,480
quickly speak about mitigation<font color="#CCCCCC"> and how</font>

51
00:02:44,460 --> 00:02:50,340
you can protect yourself<font color="#CCCCCC"> about this kind</font>

52
00:02:48,480 --> 00:02:53,640
of thing it's nothing<font color="#E5E5E5"> really new it's</font>

53
00:02:50,340 --> 00:02:56,400
it's common stuff so I won't take<font color="#E5E5E5"> too</font>

54
00:02:53,640 --> 00:02:58,559
much time on it<font color="#E5E5E5"> out of GN will you will</font>

55
00:02:56,400 --> 00:03:01,200
<font color="#E5E5E5">have a conclusion</font><font color="#CCCCCC"> and I decided to</font><font color="#E5E5E5"> add</font>

56
00:02:58,560 --> 00:03:03,209
the technical bonus if I not have too

57
00:03:01,200 --> 00:03:05,760
much question and<font color="#E5E5E5"> I've got that time so</font>

58
00:03:03,209 --> 00:03:08,850
I<font color="#E5E5E5"> really recommend</font><font color="#CCCCCC"> you to don't ask</font>

59
00:03:05,760 --> 00:03:11,070
question and we'll have time<font color="#CCCCCC"> to do</font>

60
00:03:08,850 --> 00:03:13,320
everything<font color="#E5E5E5"> and I'm here for words in</font>

61
00:03:11,070 --> 00:03:21,209
this so<font color="#E5E5E5"> you can ask me question after</font>

62
00:03:13,320 --> 00:03:26,820
it's<font color="#E5E5E5"> not a</font><font color="#CCCCCC"> program so what's new for AP</font>

63
00:03:21,209 --> 00:03:28,890
<font color="#CCCCCC">theatres the most</font><font color="#E5E5E5"> valuable part is the</font>

64
00:03:26,820 --> 00:03:31,920
complex remote administration tool all

65
00:03:28,890 --> 00:03:34,410
<font color="#E5E5E5">zero-day it's what cost a lot for for</font>

66
00:03:31,920 --> 00:03:37,708
this group<font color="#E5E5E5"> and of course that try to</font>

67
00:03:34,410 --> 00:03:39,859
keep this<font color="#E5E5E5"> information secret and of</font>

68
00:03:37,709 --> 00:03:43,440
course they try to don't give to

69
00:03:39,860 --> 00:03:49,620
<font color="#E5E5E5">marginalized security companies this</font>

70
00:03:43,440 --> 00:03:52,650
valuable<font color="#CCCCCC"> code and to do so since</font><font color="#E5E5E5"> few and</font>

71
00:03:49,620 --> 00:03:54,870
most years they are<font color="#E5E5E5"> trying to modify</font>

72
00:03:52,650 --> 00:03:56,760
infection vector to<font color="#CCCCCC"> be sure to</font><font color="#E5E5E5"> infect</font>

73
00:03:54,870 --> 00:03:58,830
the good people in

74
00:03:56,760 --> 00:04:00,000
affect the<font color="#CCCCCC"> Daggett</font><font color="#E5E5E5"> people and not in</font>

75
00:03:58,830 --> 00:04:03,900
fact<font color="#CCCCCC"> sandbox</font>

76
00:04:00,000 --> 00:04:05,970
or<font color="#CCCCCC"> a virtual machine</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> even if it's</font>

77
00:04:03,900 --> 00:04:09,360
physical<font color="#E5E5E5"> machine from from Mariana</font>

78
00:04:05,970 --> 00:04:12,569
<font color="#CCCCCC">rest's so I will show</font><font color="#E5E5E5"> you how the they</font>

79
00:04:09,360 --> 00:04:16,260
do and what kind<font color="#E5E5E5"> of modifications</font><font color="#CCCCCC"> they</font>

80
00:04:12,569 --> 00:04:20,880
did<font color="#E5E5E5"> so my first use case</font><font color="#CCCCCC"> I named it</font>

81
00:04:16,260 --> 00:04:23,940
<font color="#CCCCCC">NATO</font><font color="#E5E5E5"> simply</font><font color="#CCCCCC"> because the file</font><font color="#E5E5E5"> name of of</font>

82
00:04:20,880 --> 00:04:25,740
the malicious document was a<font color="#E5E5E5"> NATO</font>

83
00:04:23,940 --> 00:04:27,949
<font color="#E5E5E5">secretary meeting to go</font><font color="#CCCCCC"> to</font>

84
00:04:25,740 --> 00:04:30,539
<font color="#CCCCCC">Ashe if you want to play with</font><font color="#E5E5E5"> it and</font>

85
00:04:27,949 --> 00:04:32,400
<font color="#E5E5E5">it's kind of material shadows</font>

86
00:04:30,539 --> 00:04:37,440
<font color="#CCCCCC">recognizance framework from</font><font color="#E5E5E5"> my point of</font>

87
00:04:32,400 --> 00:04:43,169
view and here is the<font color="#CCCCCC"> document so it</font>

88
00:04:37,440 --> 00:04:45,830
contains<font color="#CCCCCC"> Flash object</font><font color="#E5E5E5"> and this</font>

89
00:04:43,169 --> 00:04:50,690
restoration object was ready<font color="#E5E5E5"> very</font>

90
00:04:45,830 --> 00:04:53,969
specific so first thing I don't<font color="#E5E5E5"> know if</font>

91
00:04:50,690 --> 00:04:55,979
yeah<font color="#E5E5E5"> he used capabilities service</font>

92
00:04:53,970 --> 00:05:01,010
<font color="#CCCCCC">strings</font><font color="#E5E5E5"> API so it's a legitimate API</font>

93
00:04:55,979 --> 00:05:03,930
from<font color="#E5E5E5"> Adobe straight and this API</font>

94
00:05:01,010 --> 00:05:07,590
<font color="#E5E5E5">generate automatically an HTML request</font>

95
00:05:03,930 --> 00:05:10,289
will all the configuration of the where

96
00:05:07,590 --> 00:05:16,198
is executed<font color="#E5E5E5"> the Java</font><font color="#CCCCCC"> is a flash object</font>

97
00:05:10,289 --> 00:05:18,930
<font color="#E5E5E5">so basically he sent to the CC the</font>

98
00:05:16,199 --> 00:05:21,300
version of<font color="#CCCCCC"> Windows so the attackers know</font>

99
00:05:18,930 --> 00:05:24,720
exactly which version<font color="#CCCCCC"> of Windows is</font>

100
00:05:21,300 --> 00:05:29,699
running<font color="#CCCCCC"> and something interesting is</font>

101
00:05:24,720 --> 00:05:33,000
activity<font color="#CCCCCC"> here so if the flash object is</font>

102
00:05:29,699 --> 00:05:36,240
executed inside of office<font color="#E5E5E5"> document you</font>

103
00:05:33,000 --> 00:05:39,030
have<font color="#E5E5E5"> ActiveX but if you extract the</font>

104
00:05:36,240 --> 00:05:43,530
<font color="#CCCCCC">flash object and you execute it</font><font color="#E5E5E5"> alone</font>

105
00:05:39,030 --> 00:05:46,500
<font color="#E5E5E5">without world behind you won't have</font>

106
00:05:43,530 --> 00:05:50,359
<font color="#CCCCCC">activity</font><font color="#E5E5E5"> here so thanks to this flag for</font>

107
00:05:46,500 --> 00:05:54,449
<font color="#E5E5E5">example the attacker is able to exactly</font>

108
00:05:50,360 --> 00:05:58,050
<font color="#E5E5E5">know if it</font><font color="#CCCCCC"> run on standard context</font>

109
00:05:54,449 --> 00:06:00,720
<font color="#E5E5E5">inside of</font><font color="#CCCCCC"> well document or if it's it</font>

110
00:05:58,050 --> 00:06:03,570
was extracted by an analyst and executed

111
00:06:00,720 --> 00:06:06,120
<font color="#CCCCCC">outside of</font><font color="#E5E5E5"> office so it's something</font>

112
00:06:03,570 --> 00:06:07,740
interesting<font color="#CCCCCC"> for for the attackers</font><font color="#E5E5E5"> and of</font>

113
00:06:06,120 --> 00:06:12,360
course you've got the

114
00:06:07,740 --> 00:06:12,870
<font color="#CCCCCC">flash version sent to the CC in this</font>

115
00:06:12,360 --> 00:06:15,870
case

116
00:06:12,870 --> 00:06:23,400
so everything was sent to<font color="#CCCCCC"> my rope II see</font>

117
00:06:15,870 --> 00:06:27,120
that<font color="#CCCCCC"> arc slash not the thing is if the</font>

118
00:06:23,400 --> 00:06:30,299
sent<font color="#CCCCCC"> information was correct form for</font>

119
00:06:27,120 --> 00:06:34,590
the attackers<font color="#E5E5E5"> point of view we received</font>

120
00:06:30,300 --> 00:06:37,490
a second flash document with additional

121
00:06:34,590 --> 00:06:43,070
<font color="#E5E5E5">data and this second flash document was</font>

122
00:06:37,490 --> 00:06:45,810
load on the fly and executed on<font color="#CCCCCC"> the</font>

123
00:06:43,070 --> 00:06:51,900
<font color="#E5E5E5">targeted system on the</font><font color="#CCCCCC"> inside of</font><font color="#E5E5E5"> the</font>

124
00:06:45,810 --> 00:06:55,110
office<font color="#E5E5E5"> document the thing is if the sent</font>

125
00:06:51,900 --> 00:06:56,880
data of the requester<font color="#CCCCCC"> aya I showed to</font>

126
00:06:55,110 --> 00:07:00,450
<font color="#E5E5E5">you was not</font><font color="#CCCCCC"> exactly</font><font color="#E5E5E5"> what the attacker</font>

127
00:06:56,880 --> 00:07:03,600
expect we never received the second

128
00:07:00,450 --> 00:07:06,599
flash object and it finished<font color="#E5E5E5"> we not have</font>

129
00:07:03,600 --> 00:07:09,630
the potential<font color="#E5E5E5"> zero day used by this</font>

130
00:07:06,600 --> 00:07:12,170
<font color="#E5E5E5">group if we not exactly send a good</font>

131
00:07:09,630 --> 00:07:16,890
information to<font color="#CCCCCC"> three attackers</font>

132
00:07:12,170 --> 00:07:21,750
additionally he use a<font color="#E5E5E5"> sh</font><font color="#CCCCCC"> via</font><font color="#E5E5E5"> Whitman</font>

133
00:07:16,890 --> 00:07:25,919
<font color="#CCCCCC">shellcode we we</font><font color="#E5E5E5"> assume and the second</font>

134
00:07:21,750 --> 00:07:32,460
flash object was executed<font color="#CCCCCC"> and in</font>

135
00:07:25,920 --> 00:07:34,070
argument we had<font color="#CCCCCC"> SH data sent by the CC</font>

136
00:07:32,460 --> 00:07:36,739
[Music]

137
00:07:34,070 --> 00:07:39,740
something fun concerning this campaign

138
00:07:36,740 --> 00:07:39,740
<font color="#CCCCCC">deck</font>

139
00:07:40,170 --> 00:07:46,830
on the end of the year so<font color="#CCCCCC"> it's an</font>

140
00:07:43,770 --> 00:07:49,650
extract from open genus<font color="#E5E5E5"> you can see at</font>

141
00:07:46,830 --> 00:07:53,250
the beginning<font color="#E5E5E5"> only few interaction on</font>

142
00:07:49,650 --> 00:07:57,359
<font color="#CCCCCC">the CC</font><font color="#E5E5E5"> so the company was very very low</font>

143
00:07:53,250 --> 00:07:59,970
and here it's when<font color="#E5E5E5"> security community</font>

144
00:07:57,360 --> 00:08:01,920
discovered the document so at this

145
00:07:59,970 --> 00:08:04,500
<font color="#E5E5E5">moment we can see we have a lot of</font><font color="#CCCCCC"> genus</font>

146
00:08:01,920 --> 00:08:06,690
<font color="#CCCCCC">request on this CC cause a lot</font><font color="#E5E5E5"> of</font>

147
00:08:04,500 --> 00:08:08,820
security researcher<font color="#E5E5E5"> try to connect the</font>

148
00:08:06,690 --> 00:08:10,350
CC<font color="#CCCCCC"> and gets information get the second</font>

149
00:08:08,820 --> 00:08:13,080
flash<font color="#E5E5E5"> object extra extra</font>

150
00:08:10,350 --> 00:08:16,590
so I generate a lot<font color="#CCCCCC"> of noise on how a</font>

151
00:08:13,080 --> 00:08:18,419
telemetry so if you don't have<font color="#E5E5E5"> the good</font>

152
00:08:16,590 --> 00:08:19,669
<font color="#E5E5E5">environment if you don't have the second</font>

153
00:08:18,420 --> 00:08:22,700
flash object

154
00:08:19,670 --> 00:08:26,330
you cannot analyze what they<font color="#E5E5E5"> subjected</font>

155
00:08:22,700 --> 00:08:28,960
this flash object<font color="#CCCCCC"> data on the</font><font color="#E5E5E5"> system so</font>

156
00:08:26,330 --> 00:08:31,280
you<font color="#CCCCCC"> cannot identify if it's a well-know</font>

157
00:08:28,960 --> 00:08:33,100
vulnerability if it's<font color="#CCCCCC"> zero there etc</font>

158
00:08:31,280 --> 00:08:36,730
<font color="#CCCCCC">you'd</font><font color="#E5E5E5"> not know anything</font>

159
00:08:33,100 --> 00:08:41,330
the second use case<font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> similar</font>

160
00:08:36,730 --> 00:08:43,820
<font color="#E5E5E5">is a</font><font color="#CCCCCC"> word document</font><font color="#E5E5E5"> named National Day</font>

161
00:08:41,330 --> 00:08:46,490
reception<font color="#E5E5E5"> dinner</font><font color="#CCCCCC"> machine Bozzio</font>

162
00:08:43,820 --> 00:08:52,670
ambassador secretary<font color="#CCCCCC"> that duck</font><font color="#E5E5E5"> and in</font>

163
00:08:46,490 --> 00:08:55,370
this case we found a<font color="#E5E5E5"> LinkedIn profile</font>

164
00:08:52,670 --> 00:09:00,920
about ambassador assistant at<font color="#E5E5E5"> Embassy of</font>

165
00:08:55,370 --> 00:09:05,050
<font color="#E5E5E5">Lebanon and we we</font><font color="#CCCCCC"> assume it's fake</font>

166
00:09:00,920 --> 00:09:09,500
<font color="#E5E5E5">LinkedIn profile cause she only has one</font>

167
00:09:05,050 --> 00:09:12,130
connection so I don't think this<font color="#CCCCCC"> kind of</font>

168
00:09:09,500 --> 00:09:15,860
profile profile<font color="#E5E5E5"> only have one connection</font>

169
00:09:12,130 --> 00:09:18,020
<font color="#E5E5E5">so same</font><font color="#CCCCCC"> thing it's a whole</font><font color="#E5E5E5"> fist document</font>

170
00:09:15,860 --> 00:09:22,130
and inside of<font color="#E5E5E5"> this office document you</font>

171
00:09:18,020 --> 00:09:26,120
have<font color="#CCCCCC"> a visual basic script</font><font color="#E5E5E5"> here is the</font>

172
00:09:22,130 --> 00:09:29,900
script<font color="#E5E5E5"> so at the top you can see</font><font color="#CCCCCC"> the</font>

173
00:09:26,120 --> 00:09:33,410
<font color="#CCCCCC">beginning of uncoded second stage</font><font color="#E5E5E5"> in</font>

174
00:09:29,900 --> 00:09:37,340
this case<font color="#E5E5E5"> it generates a JavaScript file</font>

175
00:09:33,410 --> 00:09:40,400
on<font color="#E5E5E5"> the system and something clever from</font>

176
00:09:37,340 --> 00:09:43,760
the attackers is the<font color="#CCCCCC"> JavaScript file</font><font color="#E5E5E5"> is</font>

177
00:09:40,400 --> 00:09:47,180
executed<font color="#E5E5E5"> with an argument this here and</font>

178
00:09:43,760 --> 00:09:51,290
this<font color="#E5E5E5"> argument is a key to decrypt</font><font color="#CCCCCC"> the</font>

179
00:09:47,180 --> 00:09:53,750
<font color="#CCCCCC">JavaScript file so typically if you send</font>

180
00:09:51,290 --> 00:09:55,790
this mail<font color="#E5E5E5"> from the GS and very subtle</font>

181
00:09:53,750 --> 00:09:58,850
<font color="#CCCCCC">and download it you cannot analyze it</font>

182
00:09:55,790 --> 00:10:02,060
<font color="#E5E5E5">you need the key here to</font><font color="#CCCCCC"> be able to</font>

183
00:09:58,850 --> 00:10:05,270
<font color="#CCCCCC">analyze</font><font color="#E5E5E5"> some JavaScript document so you</font>

184
00:10:02,060 --> 00:10:08,660
must have both to work on it<font color="#E5E5E5"> so you need</font>

185
00:10:05,270 --> 00:10:10,939
<font color="#E5E5E5">to have basically the document office</font>

186
00:10:08,660 --> 00:10:15,500
document to<font color="#E5E5E5"> be able to analyze the</font>

187
00:10:10,940 --> 00:10:18,170
<font color="#CCCCCC">JavaScript file here is the JavaScript</font>

188
00:10:15,500 --> 00:10:22,430
<font color="#E5E5E5">and</font><font color="#CCCCCC"> you can see here the ESC for</font>

189
00:10:18,170 --> 00:10:25,069
function and that this is a key of<font color="#E5E5E5"> the</font>

190
00:10:22,430 --> 00:10:28,180
<font color="#CCCCCC">DFC for function is the first argument I</font>

191
00:10:25,070 --> 00:10:28,180
showed you just<font color="#CCCCCC"> before</font>

192
00:10:28,190 --> 00:10:33,720
finally what was the purpose<font color="#E5E5E5"> of all this</font>

193
00:10:30,870 --> 00:10:36,270
stuff<font color="#CCCCCC"> just</font><font color="#E5E5E5"> to get some</font><font color="#CCCCCC"> information on</font>

194
00:10:33,720 --> 00:10:39,780
the infected<font color="#E5E5E5"> system or this information</font>

195
00:10:36,270 --> 00:10:42,390
was sent<font color="#E5E5E5"> to the CC and if it match</font>

196
00:10:39,780 --> 00:10:45,030
exactly<font color="#CCCCCC"> what the attacker</font><font color="#E5E5E5"> expect from</font>

197
00:10:42,390 --> 00:10:47,430
the targeted system<font color="#E5E5E5"> the remote and mr.</font>

198
00:10:45,030 --> 00:10:50,839
<font color="#CCCCCC">Shinto was sent to the victim and</font>

199
00:10:47,430 --> 00:10:55,140
executed on<font color="#CCCCCC"> the system if you</font><font color="#E5E5E5"> don't send</font>

200
00:10:50,840 --> 00:10:56,250
exactly<font color="#CCCCCC"> what the attackers expect</font><font color="#E5E5E5"> you</font>

201
00:10:55,140 --> 00:10:57,840
won't have anything<font color="#E5E5E5"> and your</font>

202
00:10:56,250 --> 00:11:00,390
investigation<font color="#E5E5E5"> is finished</font>

203
00:10:57,840 --> 00:11:02,870
<font color="#E5E5E5">you cannot go deeper and it's</font>

204
00:11:00,390 --> 00:11:02,870
frustrating

205
00:11:03,200 --> 00:11:10,760
yeah<font color="#CCCCCC"> in this</font><font color="#E5E5E5"> case it was</font><font color="#CCCCCC"> too compromised</font>

206
00:11:06,150 --> 00:11:15,300
<font color="#E5E5E5">CC so legit website and at the end</font>

207
00:11:10,760 --> 00:11:18,689
<font color="#E5E5E5">directly we have a new P file</font><font color="#CCCCCC"> name</font>

208
00:11:15,300 --> 00:11:22,709
<font color="#CCCCCC">malformed that beef like name form the</font>

209
00:11:18,690 --> 00:11:25,440
GS<font color="#E5E5E5"> previously and if you don't if your</font>

210
00:11:22,710 --> 00:11:29,130
system does that much expectation it's

211
00:11:25,440 --> 00:11:32,570
<font color="#E5E5E5">finished other example this time it's an</font>

212
00:11:29,130 --> 00:11:37,439
Excel document server<font color="#E5E5E5"> but access and</font>

213
00:11:32,570 --> 00:11:40,700
same thing<font color="#E5E5E5"> macro inside and this time</font>

214
00:11:37,440 --> 00:11:44,700
<font color="#CCCCCC">you</font><font color="#E5E5E5"> choose a scheduled task to</font><font color="#CCCCCC"> execute</font>

215
00:11:40,700 --> 00:11:49,220
the second stage<font color="#CCCCCC"> I think it's to not use</font>

216
00:11:44,700 --> 00:11:51,420
create process and you can see the<font color="#CCCCCC"> CC</font>

217
00:11:49,220 --> 00:11:53,460
something<font color="#E5E5E5"> interesting if you may indeed</font>

218
00:11:51,420 --> 00:11:57,329
<font color="#E5E5E5">incident response or monitor your log</font>

219
00:11:53,460 --> 00:12:02,340
<font color="#E5E5E5">it's the user</font><font color="#CCCCCC"> agent</font><font color="#E5E5E5"> bits Microsoft bit</font>

220
00:11:57,330 --> 00:12:05,540
and same thing he dropped a bad script

221
00:12:02,340 --> 00:12:08,460
<font color="#E5E5E5">on machine get</font><font color="#CCCCCC"> information typically</font>

222
00:12:05,540 --> 00:12:11,459
information about a<font color="#CCCCCC"> user name about</font>

223
00:12:08,460 --> 00:12:13,620
<font color="#CCCCCC">earth name about network configuration</font>

224
00:12:11,460 --> 00:12:16,800
<font color="#E5E5E5">domain configuration icon configuration</font>

225
00:12:13,620 --> 00:12:21,770
<font color="#CCCCCC">ixora send this information to the CC</font>

226
00:12:16,800 --> 00:12:25,859
and the CC decide if your machine<font color="#E5E5E5"> is a</font>

227
00:12:21,770 --> 00:12:33,060
good candidate for infection<font color="#E5E5E5"> on</font><font color="#CCCCCC"> earth so</font>

228
00:12:25,860 --> 00:12:36,889
<font color="#E5E5E5">I work on another case today</font><font color="#CCCCCC"> subtly more</font>

229
00:12:33,060 --> 00:12:40,488
<font color="#E5E5E5">less the</font><font color="#CCCCCC"> same thing is a campaign</font>

230
00:12:36,889 --> 00:12:42,529
against<font color="#E5E5E5"> South Korean user so I</font><font color="#CCCCCC"> think</font>

231
00:12:40,489 --> 00:12:46,129
everybody in the room speak Korean but<font color="#E5E5E5"> I</font>

232
00:12:42,529 --> 00:12:50,839
<font color="#CCCCCC">would</font><font color="#E5E5E5"> translate</font><font color="#CCCCCC"> if some people don't</font>

233
00:12:46,129 --> 00:12:53,839
it's a document<font color="#CCCCCC"> hwp yeah</font><font color="#E5E5E5"> in South Korea</font>

234
00:12:50,839 --> 00:12:57,009
they don't use office because they have

235
00:12:53,839 --> 00:12:59,779
their<font color="#CCCCCC"> own local office like</font><font color="#E5E5E5"> software</font>

236
00:12:57,009 --> 00:13:03,949
that perfectly she bought Korean

237
00:12:59,779 --> 00:13:06,350
<font color="#E5E5E5">characters it's angled on</font><font color="#CCCCCC"> google word</font>

238
00:13:03,949 --> 00:13:10,639
processing<font color="#E5E5E5"> processor and the extension</font>

239
00:13:06,350 --> 00:13:15,309
is<font color="#CCCCCC"> hwp</font><font color="#E5E5E5"> so if you saw on</font><font color="#CCCCCC"> vs. hwp it's</font>

240
00:13:10,639 --> 00:13:19,309
basically<font color="#CCCCCC"> South Korean office like</font>

241
00:13:15,309 --> 00:13:21,108
document in this<font color="#CCCCCC"> case here the logo</font><font color="#E5E5E5"> is</font>

242
00:13:19,309 --> 00:13:24,799
<font color="#E5E5E5">the logo of the Ministry of unification</font>

243
00:13:21,109 --> 00:13:28,309
<font color="#E5E5E5">the purpose of this ministry is</font><font color="#CCCCCC"> to one</font>

244
00:13:24,799 --> 00:13:32,199
day have<font color="#E5E5E5"> a kind of unique South and</font>

245
00:13:28,309 --> 00:13:41,118
North Korea<font color="#E5E5E5"> etc so a lot</font><font color="#CCCCCC"> of business</font><font color="#E5E5E5"> and</font>

246
00:13:32,199 --> 00:13:44,949
this document<font color="#CCCCCC"> is about how about</font><font color="#E5E5E5"> the</font>

247
00:13:41,119 --> 00:13:49,819
speech<font color="#E5E5E5"> performed by the North Korean</font>

248
00:13:44,949 --> 00:13:52,459
dictator and what kind of web features

249
00:13:49,819 --> 00:13:56,599
this year because<font color="#E5E5E5"> the naming is reborn</font>

250
00:13:52,459 --> 00:14:00,758
between when they have speech from from

251
00:13:56,600 --> 00:14:03,850
him inside<font color="#CCCCCC"> of the document you</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> two</font>

252
00:14:00,759 --> 00:14:06,889
embedded objects<font color="#CCCCCC"> under the document and</font>

253
00:14:03,850 --> 00:14:09,319
it's it's right to<font color="#CCCCCC"> have</font><font color="#E5E5E5"> additional</font>

254
00:14:06,889 --> 00:14:13,419
<font color="#E5E5E5">information you click on it if users</font>

255
00:14:09,319 --> 00:14:16,969
click on<font color="#E5E5E5"> it it will execute one</font><font color="#CCCCCC"> of this</font>

256
00:14:13,419 --> 00:14:22,220
olee object inside of the<font color="#CCCCCC"> hwp document</font>

257
00:14:16,970 --> 00:14:26,119
and in fact this olp object<font color="#E5E5E5"> are</font><font color="#CCCCCC"> P file</font>

258
00:14:22,220 --> 00:14:28,399
so if the users want<font color="#E5E5E5"> to see additional</font>

259
00:14:26,119 --> 00:14:31,069
<font color="#E5E5E5">information</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> must click on the link</font>

260
00:14:28,399 --> 00:14:35,149
if it<font color="#E5E5E5"> clicks on the link the binary are</font>

261
00:14:31,069 --> 00:14:38,929
drop and executed on<font color="#CCCCCC"> the system what is</font>

262
00:14:35,149 --> 00:14:41,029
the<font color="#E5E5E5"> purpose of this to binary first</font>

263
00:14:38,929 --> 00:14:43,249
<font color="#CCCCCC">thing</font><font color="#E5E5E5"> he</font><font color="#CCCCCC"> open the</font><font color="#E5E5E5"> decoy document</font><font color="#CCCCCC"> yeah</font>

264
00:14:41,029 --> 00:14:45,189
users<font color="#E5E5E5"> ask for additional information so</font>

265
00:14:43,249 --> 00:14:49,340
<font color="#E5E5E5">he has additional</font><font color="#CCCCCC"> information and</font>

266
00:14:45,189 --> 00:14:53,240
<font color="#E5E5E5">basically you've</font><font color="#CCCCCC"> got the world</font>

267
00:14:49,340 --> 00:14:56,870
during the speech in 2016 here and the

268
00:14:53,240 --> 00:14:58,760
<font color="#E5E5E5">world choose for speech in 2017 to see a</font>

269
00:14:56,870 --> 00:15:02,570
<font color="#E5E5E5">difference if it's more aggressive less</font>

270
00:14:58,760 --> 00:15:05,540
aggressive etc and behind the executable

271
00:15:02,570 --> 00:15:07,820
get information on the machine<font color="#CCCCCC"> so he get</font>

272
00:15:05,540 --> 00:15:12,380
the computer name<font color="#E5E5E5"> username execution</font>

273
00:15:07,820 --> 00:15:14,000
path of the binary<font color="#CCCCCC"> BIOS model thanks to</font>

274
00:15:12,380 --> 00:15:15,920
this<font color="#CCCCCC"> register key if you make some</font>

275
00:15:14,000 --> 00:15:19,700
<font color="#E5E5E5">search</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> Google is not very very well</font>

276
00:15:15,920 --> 00:15:24,199
use<font color="#CCCCCC"> British psyche</font><font color="#E5E5E5"> and the purpose is</font><font color="#CCCCCC"> to</font>

277
00:15:19,700 --> 00:15:26,870
<font color="#E5E5E5">detect if the target is suitable for the</font>

278
00:15:24,200 --> 00:15:30,470
attack<font color="#E5E5E5"> and detect of course virtual</font>

279
00:15:26,870 --> 00:15:33,440
machine if you for example<font color="#E5E5E5"> I took so</font>

280
00:15:30,470 --> 00:15:36,110
<font color="#CCCCCC">pickup generated by virus data once</font>

281
00:15:33,440 --> 00:15:38,960
decoded<font color="#CCCCCC"> you have all this information</font>

282
00:15:36,110 --> 00:15:42,740
tequila<font color="#E5E5E5"> boom-boom is a default hostname</font>

283
00:15:38,960 --> 00:15:44,930
<font color="#E5E5E5">on</font><font color="#CCCCCC"> virustotal</font><font color="#E5E5E5"> virtual machine Jeanette</font>

284
00:15:42,740 --> 00:15:46,790
is a<font color="#CCCCCC"> username here is an exaction</font><font color="#E5E5E5"> path</font>

285
00:15:44,930 --> 00:15:51,219
so virustotal

286
00:15:46,790 --> 00:15:56,030
put directly<font color="#E5E5E5"> in</font><font color="#CCCCCC"> c derive</font><font color="#E5E5E5"> so file with</font>

287
00:15:51,220 --> 00:15:58,640
ash as file name but normally on normal

288
00:15:56,030 --> 00:16:02,240
<font color="#CCCCCC">infection it should be this</font><font color="#E5E5E5"> pass and not</font>

289
00:15:58,640 --> 00:16:05,900
the the<font color="#CCCCCC"> other one</font><font color="#E5E5E5"> and finally you've</font><font color="#CCCCCC"> got</font>

290
00:16:02,240 --> 00:16:08,300
the<font color="#CCCCCC"> bios model in a deck VirtualBox so</font>

291
00:16:05,900 --> 00:16:10,790
thanks<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> bios model we know</font><font color="#E5E5E5"> it's</font>

292
00:16:08,300 --> 00:16:13,939
virtual machine and it's VirtualBox<font color="#E5E5E5"> used</font>

293
00:16:10,790 --> 00:16:16,459
by various data and thanks to all<font color="#E5E5E5"> this</font>

294
00:16:13,940 --> 00:16:20,810
<font color="#CCCCCC">information the attackers is able to</font>

295
00:16:16,460 --> 00:16:24,850
determine<font color="#CCCCCC"> if</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> sent the second binary so</font>

296
00:16:20,810 --> 00:16:28,300
remote administration tool or not to

297
00:16:24,850 --> 00:16:31,880
complexify a little bit the big picture

298
00:16:28,300 --> 00:16:34,490
the attackers compromised<font color="#E5E5E5"> legitimate</font>

299
00:16:31,880 --> 00:16:41,510
<font color="#CCCCCC">south korean governmental governmental</font>

300
00:16:34,490 --> 00:16:44,930
website<font color="#E5E5E5"> so it's</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> remember its leg</font>

301
00:16:41,510 --> 00:16:46,310
<font color="#CCCCCC">wall service</font><font color="#E5E5E5"> so you basically if you are</font>

302
00:16:44,930 --> 00:16:49,609
in South Korea you cannot block this

303
00:16:46,310 --> 00:16:52,880
this city<font color="#E5E5E5"> it's legitimate website</font><font color="#CCCCCC"> and if</font>

304
00:16:49,610 --> 00:16:58,400
the<font color="#E5E5E5"> information sent to index that</font><font color="#CCCCCC"> PHP</font>

305
00:16:52,880 --> 00:17:01,660
are<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> for the attackers</font><font color="#CCCCCC"> a JPEG file is</font>

306
00:16:58,400 --> 00:17:04,300
generated on<font color="#E5E5E5"> the CC with an ID</font><font color="#CCCCCC"> it's</font>

307
00:17:01,660 --> 00:17:09,790
the idea of<font color="#E5E5E5"> your mission if I Texas it's</font>

308
00:17:04,300 --> 00:17:12,099
this ID<font color="#E5E5E5"> and in fact this</font><font color="#CCCCCC"> JPEG it's a pre</font>

309
00:17:09,790 --> 00:17:14,649
<font color="#E5E5E5">file</font><font color="#CCCCCC"> uncoated so if you download it</font>

310
00:17:12,099 --> 00:17:18,869
<font color="#E5E5E5">decoded and executed on the machine but</font>

311
00:17:14,650 --> 00:17:22,080
<font color="#E5E5E5">this</font><font color="#CCCCCC"> JPEG file is only generated if your</font>

312
00:17:18,869 --> 00:17:24,849
machine<font color="#E5E5E5"> looks like some targeted machine</font>

313
00:17:22,079 --> 00:17:29,470
<font color="#E5E5E5">during</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> investigation we didn't find</font>

314
00:17:24,849 --> 00:17:32,050
a way<font color="#E5E5E5"> to get this executable here is the</font>

315
00:17:29,470 --> 00:17:34,030
global infrastructure<font color="#CCCCCC"> use</font><font color="#E5E5E5"> by</font><font color="#CCCCCC"> this guy</font><font color="#E5E5E5"> we</font>

316
00:17:32,050 --> 00:17:37,330
didn't find a way<font color="#CCCCCC"> to have this final</font>

317
00:17:34,030 --> 00:17:40,149
<font color="#E5E5E5">remote and recession tool but we had</font>

318
00:17:37,330 --> 00:17:43,090
more luck on the next<font color="#E5E5E5"> campaign because</font>

319
00:17:40,150 --> 00:17:47,980
the guy<font color="#E5E5E5"> is infrastructure they had</font>

320
00:17:43,090 --> 00:17:50,560
during few hours it doesn't<font color="#CCCCCC"> say hard</font>

321
00:17:47,980 --> 00:17:53,230
ring<font color="#E5E5E5"> there's all weeks so if you are not</font>

322
00:17:50,560 --> 00:17:56,889
<font color="#E5E5E5">really quick and if you don't try to get</font>

323
00:17:53,230 --> 00:18:00,360
the second executable<font color="#E5E5E5"> very quickly after</font>

324
00:17:56,890 --> 00:18:04,320
the spam campaign<font color="#E5E5E5"> you you won't have</font><font color="#CCCCCC"> it</font>

325
00:18:00,360 --> 00:18:09,820
we<font color="#CCCCCC"> have more chains on a second wave of</font>

326
00:18:04,320 --> 00:18:13,480
email<font color="#E5E5E5"> this one is an email sent</font><font color="#CCCCCC"> from the</font>

327
00:18:09,820 --> 00:18:16,450
<font color="#E5E5E5">organizer of Korean global</font><font color="#CCCCCC"> forum it's a</font>

328
00:18:13,480 --> 00:18:18,970
real forum and it's really made of the

329
00:18:16,450 --> 00:18:22,060
guy so the attackers first compromised

330
00:18:18,970 --> 00:18:27,510
the email of<font color="#CCCCCC"> the organizer of this forum</font>

331
00:18:22,060 --> 00:18:32,320
and sent email to the target and said

332
00:18:27,510 --> 00:18:37,720
<font color="#E5E5E5">ask for</font><font color="#CCCCCC"> fill forming attachment</font>

333
00:18:32,320 --> 00:18:40,540
concerning this even they use<font color="#E5E5E5"> another</font>

334
00:18:37,720 --> 00:18:43,120
kind<font color="#E5E5E5"> of campaign always with</font><font color="#CCCCCC"> hwp</font>

335
00:18:40,540 --> 00:18:45,790
<font color="#CCCCCC">fighting</font><font color="#E5E5E5"> attachment in this case he may</font>

336
00:18:43,120 --> 00:18:48,429
said I'm from North Korea<font color="#CCCCCC"> I'm looking</font>

337
00:18:45,790 --> 00:18:53,409
for a way<font color="#CCCCCC"> to go</font><font color="#E5E5E5"> into South Korea can you</font>

338
00:18:48,430 --> 00:18:55,150
help me extra extra<font color="#E5E5E5"> so and</font><font color="#CCCCCC"> the guy has</font>

339
00:18:53,410 --> 00:18:57,790
to<font color="#E5E5E5"> click on the attachment to have more</font>

340
00:18:55,150 --> 00:19:00,850
information about<font color="#E5E5E5"> its situation so</font>

341
00:18:57,790 --> 00:19:02,250
typically it works on on empathy in this

342
00:19:00,850 --> 00:19:05,260
in this campaign

343
00:19:02,250 --> 00:19:08,560
here<font color="#E5E5E5"> is a to document so the first one</font>

344
00:19:05,260 --> 00:19:11,860
here on on the left is a form to fill

345
00:19:08,560 --> 00:19:14,320
<font color="#CCCCCC">and the second documented explanation</font>

346
00:19:11,860 --> 00:19:19,169
about the guy directly

347
00:19:14,320 --> 00:19:24,090
in North Korea in this case the

348
00:19:19,170 --> 00:19:28,330
attackers included<font color="#CCCCCC"> in</font><font color="#E5E5E5"> that EPS so it's</font>

349
00:19:24,090 --> 00:19:33,100
restrict<font color="#E5E5E5"> object inside of the</font><font color="#CCCCCC"> hwp and</font>

350
00:19:28,330 --> 00:19:39,929
use a vulnerability<font color="#E5E5E5"> to drop and execute</font>

351
00:19:33,100 --> 00:19:39,929
malware on the targeted system yeah the

352
00:19:40,650 --> 00:19:47,530
<font color="#E5E5E5">the shell card and here you've got where</font>

353
00:19:43,330 --> 00:19:50,530
the second peds downloaded in the same

354
00:19:47,530 --> 00:19:54,149
pattern<font color="#CCCCCC"> jpg file</font><font color="#E5E5E5"> exactly as previously</font>

355
00:19:50,530 --> 00:19:57,700
<font color="#E5E5E5">so generate</font><font color="#CCCCCC"> jpeg file on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> known to</font>

356
00:19:54,150 --> 00:20:00,100
<font color="#CCCCCC">infect users</font><font color="#E5E5E5"> in this time we were more</font>

357
00:19:57,700 --> 00:20:02,770
rocky and rocky<font color="#CCCCCC"> and we</font><font color="#E5E5E5"> will find a</font><font color="#CCCCCC"> way</font>

358
00:20:00,100 --> 00:20:06,909
to<font color="#E5E5E5"> download</font><font color="#CCCCCC"> the remote and mission</font><font color="#E5E5E5"> tools</font>

359
00:20:02,770 --> 00:20:10,510
<font color="#CCCCCC">the finer</font><font color="#E5E5E5"> one we named</font><font color="#CCCCCC"> it retract</font><font color="#E5E5E5"> and I</font>

360
00:20:06,910 --> 00:20:13,390
will quickly<font color="#E5E5E5"> describe it because it's</font>

361
00:20:10,510 --> 00:20:16,210
great fun<font color="#E5E5E5"> the first thing is it does</font><font color="#CCCCCC"> not</font>

362
00:20:13,390 --> 00:20:18,640
<font color="#E5E5E5">work on Windows XP if</font><font color="#CCCCCC"> you execute it on</font>

363
00:20:16,210 --> 00:20:21,160
Windows<font color="#CCCCCC"> XP you you will be in</font><font color="#E5E5E5"> the</font>

364
00:20:18,640 --> 00:20:27,120
infinite loop of sleep<font color="#CCCCCC"> you do nothing</font>

365
00:20:21,160 --> 00:20:29,380
<font color="#E5E5E5">and basically it's for annoying</font><font color="#CCCCCC"> a</font>

366
00:20:27,120 --> 00:20:32,500
sandbox<font color="#E5E5E5"> systems that work on Windows XP</font>

367
00:20:29,380 --> 00:20:34,810
<font color="#CCCCCC">like cuoco sandbox a lot of people use</font>

368
00:20:32,500 --> 00:20:37,600
it on on Windows<font color="#E5E5E5"> XP so you will have an</font>

369
00:20:34,810 --> 00:20:39,909
empty report in this<font color="#CCCCCC"> case</font><font color="#E5E5E5"> even if you</font>

370
00:20:37,600 --> 00:20:45,490
end up<font color="#E5E5E5"> the sleep it's an infinite loop</font>

371
00:20:39,910 --> 00:20:48,400
so<font color="#E5E5E5"> it doesn't care</font><font color="#CCCCCC"> so second thing is</font>

372
00:20:45,490 --> 00:20:52,090
looking for holes running<font color="#E5E5E5"> processes and</font>

373
00:20:48,400 --> 00:20:55,120
if one<font color="#E5E5E5"> of the process is much analyst</font>

374
00:20:52,090 --> 00:20:58,030
tool or additional tools from<font color="#CCCCCC"> that from</font>

375
00:20:55,120 --> 00:21:00,429
new virtual machine<font color="#CCCCCC"> the malware will do</font>

376
00:20:58,030 --> 00:21:04,090
something<font color="#E5E5E5"> really fun</font><font color="#CCCCCC"> in fact he will go</font>

377
00:21:00,430 --> 00:21:06,550
on<font color="#E5E5E5"> internet and watch a TV show so it's</font>

378
00:21:04,090 --> 00:21:09,189
only on virtual machine or if you have

379
00:21:06,550 --> 00:21:11,980
<font color="#CCCCCC">analysis</font><font color="#E5E5E5"> analyzes tool running on the</font>

380
00:21:09,190 --> 00:21:13,840
<font color="#E5E5E5">system it will watch TV</font><font color="#CCCCCC"> show it's simply</font>

381
00:21:11,980 --> 00:21:15,940
to generate IOC I think simply to

382
00:21:13,840 --> 00:21:20,500
generate<font color="#CCCCCC"> Network on your report and</font>

383
00:21:15,940 --> 00:21:22,300
maybe to<font color="#E5E5E5"> to force you to last time to</font>

384
00:21:20,500 --> 00:21:23,680
understand what<font color="#E5E5E5"> the fuck is doing but</font>

385
00:21:22,300 --> 00:21:27,700
it's simply

386
00:21:23,680 --> 00:21:31,690
the<font color="#CCCCCC"> dicking you are here</font><font color="#E5E5E5"> if it's a run</font>

387
00:21:27,700 --> 00:21:33,910
<font color="#E5E5E5">on normal condition the first CC is a</font>

388
00:21:31,690 --> 00:21:38,950
Twitter<font color="#CCCCCC"> account so he directly</font>

389
00:21:33,910 --> 00:21:41,920
communicate through Twitter<font color="#CCCCCC"> and he has</font>

390
00:21:38,950 --> 00:21:44,680
seven different accurate accounts inside

391
00:21:41,920 --> 00:21:47,380
<font color="#E5E5E5">of the binary so it directly use this</font>

392
00:21:44,680 --> 00:21:49,480
account<font color="#E5E5E5"> and for internet response point</font>

393
00:21:47,380 --> 00:21:52,390
of view it's a little bit hard cause

394
00:21:49,480 --> 00:21:56,440
it's legitimate website<font color="#CCCCCC"> so</font><font color="#E5E5E5"> maybe you can</font>

395
00:21:52,390 --> 00:21:59,890
access Twitter but maybe not and it's

396
00:21:56,440 --> 00:22:02,500
<font color="#CCCCCC">HTTPS</font><font color="#E5E5E5"> so directly you cannot make money</font>

397
00:21:59,890 --> 00:22:05,500
<font color="#E5E5E5">in the middle</font><font color="#CCCCCC"> on HTTPS or</font><font color="#E5E5E5"> it's it's</font>

398
00:22:02,500 --> 00:22:07,900
<font color="#CCCCCC">complicated and</font><font color="#E5E5E5"> if it</font><font color="#CCCCCC"> doesn't work</font><font color="#E5E5E5"> or if</font>

399
00:22:05,500 --> 00:22:10,660
you decided to<font color="#CCCCCC"> block Twitter he switch</font>

400
00:22:07,900 --> 00:22:13,960
on the Yandex<font color="#E5E5E5"> so recent cloud platform</font>

401
00:22:10,660 --> 00:22:16,150
and with the same thing he has<font color="#E5E5E5"> for</font><font color="#CCCCCC"> our</font>

402
00:22:13,960 --> 00:22:18,790
<font color="#CCCCCC">colleague token inside of the binary</font><font color="#E5E5E5"> and</font>

403
00:22:16,150 --> 00:22:21,640
use Yandex to expedite document or

404
00:22:18,790 --> 00:22:23,860
download additional tools on the

405
00:22:21,640 --> 00:22:27,580
infected<font color="#CCCCCC"> machine same thing legitimate</font>

406
00:22:23,860 --> 00:22:31,209
website<font color="#E5E5E5"> HTTPS if it doesn't work she has</font>

407
00:22:27,580 --> 00:22:33,129
a<font color="#E5E5E5"> major fire</font><font color="#CCCCCC"> capability so he can use</font>

408
00:22:31,210 --> 00:22:36,460
major fire to do exactly<font color="#E5E5E5"> the same things</font>

409
00:22:33,130 --> 00:22:39,630
<font color="#E5E5E5">on Yandex</font><font color="#CCCCCC"> same thing legitimate website</font>

410
00:22:36,460 --> 00:22:43,610
<font color="#E5E5E5">HTTPS and maybe something used the</font>

411
00:22:39,630 --> 00:22:45,810
<font color="#CCCCCC">widget for for several</font><font color="#E5E5E5"> company or</font><font color="#CCCCCC"> entity</font>

412
00:22:43,610 --> 00:22:48,729
[Music]

413
00:22:45,810 --> 00:22:50,740
auditioning<font color="#CCCCCC"> he has some classical</font>

414
00:22:48,730 --> 00:22:55,330
feature for remote and mr. shamtoub such

415
00:22:50,740 --> 00:22:57,670
as a screenshot or<font color="#CCCCCC"> Quiroga</font><font color="#E5E5E5"> etc so he is</font>

416
00:22:55,330 --> 00:23:05,800
able to<font color="#CCCCCC"> to get what you are doing</font><font color="#E5E5E5"> on the</font>

417
00:22:57,670 --> 00:23:08,190
system so<font color="#CCCCCC"> to travel</font><font color="#E5E5E5"> summary the thing is</font>

418
00:23:05,800 --> 00:23:11,800
on all the case I present here

419
00:23:08,190 --> 00:23:15,360
everything start by the same thing<font color="#E5E5E5"> users</font>

420
00:23:11,800 --> 00:23:20,879
users open attachment users click on

421
00:23:15,360 --> 00:23:22,990
link inside of document and and yeah

422
00:23:20,880 --> 00:23:26,290
<font color="#E5E5E5">everything start by spearfishing</font>

423
00:23:22,990 --> 00:23:30,460
campaigns<font color="#E5E5E5"> or the example</font><font color="#CCCCCC"> I had here</font>

424
00:23:26,290 --> 00:23:31,860
start by an<font color="#E5E5E5"> email sometimes</font><font color="#CCCCCC"> it's a</font><font color="#E5E5E5"> bad</font>

425
00:23:30,460 --> 00:23:33,929
<font color="#E5E5E5">email</font>

426
00:23:31,860 --> 00:23:36,330
but looking he made but sometimes it's

427
00:23:33,929 --> 00:23:38,399
for<font color="#E5E5E5"> example if we look at the forum</font>

428
00:23:36,330 --> 00:23:41,039
<font color="#E5E5E5">email account it's a legitimate I can't</font>

429
00:23:38,399 --> 00:23:44,449
<font color="#E5E5E5">if you look on the either already come</font>

430
00:23:41,039 --> 00:23:47,970
from<font color="#CCCCCC"> University of</font><font color="#E5E5E5"> core of South sale in</font>

431
00:23:44,450 --> 00:23:49,919
South Korea<font color="#E5E5E5"> because the event</font>

432
00:23:47,970 --> 00:23:52,710
the<font color="#E5E5E5"> forum is organized by the University</font>

433
00:23:49,919 --> 00:23:56,880
<font color="#E5E5E5">and the account is compromised so even</font>

434
00:23:52,710 --> 00:24:00,600
if you look at the either<font color="#E5E5E5"> you cannot you</font>

435
00:23:56,880 --> 00:24:02,340
cannot identify it by email<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I I</font>

436
00:24:00,600 --> 00:24:05,699
<font color="#E5E5E5">don't have the information I</font><font color="#CCCCCC"> don't know</font>

437
00:24:02,340 --> 00:24:08,639
but maybe the targeted people was at

438
00:24:05,700 --> 00:24:10,350
this event<font color="#CCCCCC"> so in this case a guy was at</font>

439
00:24:08,639 --> 00:24:12,899
the event<font color="#E5E5E5"> and today after receive the</font>

440
00:24:10,350 --> 00:24:19,370
forum do you like the event<font color="#CCCCCC"> yes we open</font>

441
00:24:12,899 --> 00:24:24,629
it and and it's<font color="#E5E5E5"> finished</font><font color="#CCCCCC"> and yeah it's</font>

442
00:24:19,370 --> 00:24:28,110
and we we work on other case also<font color="#E5E5E5"> case I</font>

443
00:24:24,630 --> 00:24:34,169
presented you<font color="#E5E5E5"> are apt so targeted attack</font>

444
00:24:28,110 --> 00:24:37,229
and we we we can see on<font color="#E5E5E5"> crime well some</font>

445
00:24:34,169 --> 00:24:40,049
tricks<font color="#CCCCCC"> that can</font><font color="#E5E5E5"> be really useful</font><font color="#CCCCCC"> for for</font>

446
00:24:37,230 --> 00:24:44,700
<font color="#E5E5E5">apt actor and maybe I think will evolve</font>

447
00:24:40,049 --> 00:24:48,000
and they will take some<font color="#CCCCCC"> tricks form from</font>

448
00:24:44,700 --> 00:24:50,130
camera for<font color="#E5E5E5"> five hunter we work on a</font>

449
00:24:48,000 --> 00:24:51,659
publisher document so nobody use

450
00:24:50,130 --> 00:24:56,149
publisher but<font color="#CCCCCC"> its installed</font><font color="#E5E5E5"> by default</font>

451
00:24:51,659 --> 00:24:58,320
<font color="#CCCCCC">if you have office 365 or hunter and</font>

452
00:24:56,149 --> 00:25:02,250
something<font color="#CCCCCC"> interesting with</font><font color="#E5E5E5"> pretty sure</font>

453
00:24:58,320 --> 00:25:04,980
it's the olden so useless<font color="#E5E5E5"> that Microsoft</font>

454
00:25:02,250 --> 00:25:08,070
didn't implement protected view or on it

455
00:25:04,980 --> 00:25:10,710
so if you<font color="#E5E5E5"> have a GPO that block macro</font>

456
00:25:08,070 --> 00:25:14,970
<font color="#CCCCCC">Exeter extra on your infrastructure</font><font color="#E5E5E5"> but</font>

457
00:25:10,710 --> 00:25:17,549
if it's<font color="#E5E5E5"> a</font><font color="#CCCCCC"> trip</font><font color="#E5E5E5"> file</font><font color="#CCCCCC"> the publisher file</font>

458
00:25:14,970 --> 00:25:21,269
and user click on<font color="#E5E5E5"> it he will have</font><font color="#CCCCCC"> a</font>

459
00:25:17,549 --> 00:25:23,070
<font color="#E5E5E5">message enable content so it's not</font>

460
00:25:21,269 --> 00:25:26,460
automatically executed but you cannot

461
00:25:23,070 --> 00:25:28,830
block the message<font color="#E5E5E5"> if your GPS say I</font>

462
00:25:26,460 --> 00:25:30,720
don't want to<font color="#E5E5E5"> enable macro even if the</font>

463
00:25:28,830 --> 00:25:34,199
guy click on it it won't<font color="#E5E5E5"> work on</font>

464
00:25:30,720 --> 00:25:38,639
<font color="#CCCCCC">padishah</font><font color="#E5E5E5"> it's not</font><font color="#CCCCCC"> implemented</font><font color="#E5E5E5"> Kamisha in</font>

465
00:25:34,200 --> 00:25:43,320
your TP<font color="#E5E5E5"> OS and it's sometimes installed</font>

466
00:25:38,639 --> 00:25:45,580
<font color="#CCCCCC">by</font><font color="#E5E5E5"> by default so we may be in few times</font>

467
00:25:43,320 --> 00:25:48,700
they will switch on publishers

468
00:25:45,580 --> 00:25:50,830
for this kind<font color="#CCCCCC"> of campaign</font><font color="#E5E5E5"> yeah</font>

469
00:25:48,700 --> 00:25:52,720
each time I make presentation<font color="#CCCCCC"> I</font><font color="#E5E5E5"> got one</font>

470
00:25:50,830 --> 00:25:55,480
guy<font color="#CCCCCC"> that said to</font><font color="#E5E5E5"> me</font><font color="#CCCCCC"> yes but I</font><font color="#E5E5E5"> used Mac</font>

471
00:25:52,720 --> 00:25:57,869
OS blah blah blah<font color="#E5E5E5"> so I I dedicate this</font>

472
00:25:55,480 --> 00:26:04,409
<font color="#CCCCCC">slide for him in the room</font>

473
00:25:57,869 --> 00:26:08,230
so yeah you<font color="#E5E5E5"> are</font><font color="#CCCCCC"> safe so I choose and</font>

474
00:26:04,409 --> 00:26:11,379
more or less<font color="#E5E5E5"> by chance</font><font color="#CCCCCC"> office document</font>

475
00:26:08,230 --> 00:26:15,519
<font color="#E5E5E5">with VBA normal but the VBA is really</font>

476
00:26:11,379 --> 00:26:17,498
cool because it<font color="#E5E5E5"> supports likewise so</font>

477
00:26:15,519 --> 00:26:20,710
yeah you can use a visual script on Mac

478
00:26:17,499 --> 00:26:22,720
OS it works and what is the purpose is

479
00:26:20,710 --> 00:26:25,029
to drop<font color="#E5E5E5"> a</font><font color="#CCCCCC"> byte on</font><font color="#E5E5E5"> slide on your Mac OS</font>

480
00:26:22,720 --> 00:26:29,019
and execute the<font color="#E5E5E5"> Python file and it works</font>

481
00:26:25,029 --> 00:26:32,169
<font color="#CCCCCC">so this malicious documents you bought</font>

482
00:26:29,019 --> 00:26:34,960
Mac OS<font color="#CCCCCC"> and drop malware on Mac OS</font>

483
00:26:32,169 --> 00:26:37,899
without any problem<font color="#E5E5E5"> so</font><font color="#CCCCCC"> no you</font><font color="#E5E5E5"> are not</font>

484
00:26:34,960 --> 00:26:42,220
safe cause you're on<font color="#CCCCCC"> Mac</font><font color="#E5E5E5"> OS you can</font>

485
00:26:37,899 --> 00:26:43,418
<font color="#E5E5E5">enable macro and execute stuff yeah</font>

486
00:26:42,220 --> 00:26:47,470
let's<font color="#E5E5E5"> speak a little</font><font color="#CCCCCC"> bit about</font>

487
00:26:43,419 --> 00:26:49,330
<font color="#CCCCCC">mitigations it's</font><font color="#E5E5E5"> nothing really new I</font>

488
00:26:47,470 --> 00:26:53,289
<font color="#E5E5E5">don't have a magic method for you sir</font>

489
00:26:49,330 --> 00:26:57,759
again<font color="#CCCCCC"> testing</font><font color="#E5E5E5"> disable macro of course on</font>

490
00:26:53,289 --> 00:27:00,210
<font color="#E5E5E5">Windows on Microsoft Office 2016 they</font>

491
00:26:57,759 --> 00:27:06,519
add new feature to really be able<font color="#E5E5E5"> to</font>

492
00:27:00,210 --> 00:27:11,109
<font color="#E5E5E5">control macro to</font><font color="#CCCCCC"> block user even</font><font color="#E5E5E5"> if you</font>

493
00:27:06,519 --> 00:27:13,590
click<font color="#CCCCCC"> on this</font><font color="#E5E5E5"> button it</font><font color="#CCCCCC"> won't work we</font>

494
00:27:11,109 --> 00:27:16,418
have a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> case where portion is used</font>

495
00:27:13,590 --> 00:27:18,939
which speak more but<font color="#E5E5E5"> per shell after</font>

496
00:27:16,419 --> 00:27:22,539
that in this case<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> make some</font>

497
00:27:18,940 --> 00:27:27,309
policy to limit execution of<font color="#E5E5E5"> partial or</font>

498
00:27:22,539 --> 00:27:31,960
limit<font color="#E5E5E5"> execution via signatures</font><font color="#CCCCCC"> of street</font>

499
00:27:27,309 --> 00:27:35,980
<font color="#E5E5E5">etc</font><font color="#CCCCCC"> I know it can be bypassed I know we</font>

500
00:27:31,960 --> 00:27:37,330
can use<font color="#CCCCCC"> one-liner</font><font color="#E5E5E5"> partial straight to to</font>

501
00:27:35,980 --> 00:27:40,509
bypass this kind of thing but it's

502
00:27:37,330 --> 00:27:42,609
better than<font color="#E5E5E5"> nothing we had a lot of case</font>

503
00:27:40,509 --> 00:27:45,269
where<font color="#E5E5E5"> bad guys do</font><font color="#CCCCCC"> JavaScript because</font>

504
00:27:42,609 --> 00:27:48,939
<font color="#E5E5E5">it's here it works and in</font><font color="#CCCCCC"> it's</font>

505
00:27:45,269 --> 00:27:51,639
obfuscated by default so you can disable

506
00:27:48,940 --> 00:27:54,399
JavaScript if you wish<font color="#E5E5E5"> simply by</font>

507
00:27:51,639 --> 00:27:56,678
switching<font color="#CCCCCC"> a registry key normally</font>

508
00:27:54,399 --> 00:27:59,739
<font color="#CCCCCC">doesn't</font><font color="#E5E5E5"> break anything</font>

509
00:27:56,679 --> 00:28:01,720
except if you on<font color="#CCCCCC"> Misrata are a huge fan</font>

510
00:27:59,740 --> 00:28:05,169
of JavaScript and write everything in

511
00:28:01,720 --> 00:28:07,600
JavaScript and and yeah more generally

512
00:28:05,169 --> 00:28:09,519
you<font color="#CCCCCC"> can you must but your sister</font><font color="#E5E5E5"> an</font>

513
00:28:07,600 --> 00:28:14,320
extra extra<font color="#E5E5E5"> so it's nothing really</font>

514
00:28:09,519 --> 00:28:19,059
<font color="#CCCCCC">really new but yeah yeah for Mac OS I</font>

515
00:28:14,320 --> 00:28:23,678
don't have any mitigation so for to

516
00:28:19,059 --> 00:28:27,039
<font color="#E5E5E5">Concord on it what we saw is really</font><font color="#CCCCCC"> apt</font>

517
00:28:23,679 --> 00:28:29,860
<font color="#CCCCCC">actors we try</font><font color="#E5E5E5"> to protect valuable stuff</font>

518
00:28:27,039 --> 00:28:35,009
<font color="#E5E5E5">protect</font><font color="#CCCCCC"> zero-day protect exploit</font><font color="#E5E5E5"> even if</font>

519
00:28:29,860 --> 00:28:39,549
it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> a zero</font><font color="#E5E5E5"> day and protect complex</font>

520
00:28:35,009 --> 00:28:41,110
<font color="#E5E5E5">right framework</font><font color="#CCCCCC"> if it's a poison ivy</font>

521
00:28:39,549 --> 00:28:44,139
<font color="#E5E5E5">that not really</font><font color="#CCCCCC"> care</font><font color="#E5E5E5"> but if they</font>

522
00:28:41,110 --> 00:28:48,658
<font color="#E5E5E5">developed something</font><font color="#CCCCCC"> Kristin general is a</font>

523
00:28:44,139 --> 00:28:51,189
tech I<font color="#E5E5E5"> try to don't lose this code and</font>

524
00:28:48,659 --> 00:28:55,059
don't<font color="#E5E5E5"> finish on very subtle stuff like</font>

525
00:28:51,190 --> 00:28:58,289
that<font color="#E5E5E5"> and for my point of view as an ally</font>

526
00:28:55,059 --> 00:29:01,529
and analyst it's<font color="#CCCCCC"> really really</font>

527
00:28:58,289 --> 00:29:03,879
<font color="#E5E5E5">frustrating and boring to stop my</font>

528
00:29:01,529 --> 00:29:06,190
analyzes in the middle of something<font color="#CCCCCC"> I</font>

529
00:29:03,879 --> 00:29:08,590
don't<font color="#CCCCCC"> have the final period</font><font color="#E5E5E5"> I not have</font>

530
00:29:06,190 --> 00:29:12,759
the final remote administration today<font color="#E5E5E5"> I</font>

531
00:29:08,590 --> 00:29:19,509
messed up everything<font color="#E5E5E5"> and and and cry</font>

532
00:29:12,759 --> 00:29:22,929
alone on my office yeah<font color="#CCCCCC"> that's life what</font>

533
00:29:19,509 --> 00:29:24,940
we so<font color="#CCCCCC"> too is a legitimate</font><font color="#E5E5E5"> scripting</font>

534
00:29:22,929 --> 00:29:27,669
language<font color="#E5E5E5"> are more and more and</font><font color="#CCCCCC"> more use</font>

535
00:29:24,940 --> 00:29:30,970
<font color="#E5E5E5">soap over</font><font color="#CCCCCC"> shell script JavaScript batch</font>

536
00:29:27,669 --> 00:29:34,509
and stuff like that<font color="#E5E5E5"> it's here it works</font>

537
00:29:30,970 --> 00:29:37,749
<font color="#CCCCCC">widget</font><font color="#E5E5E5"> and generally it's not correctly</font>

538
00:29:34,509 --> 00:29:42,419
controlled by by company so<font color="#E5E5E5"> it's really</font>

539
00:29:37,749 --> 00:29:42,419
convenient for for<font color="#E5E5E5"> takers to to use them</font>

540
00:29:43,619 --> 00:29:50,590
another<font color="#E5E5E5"> point and it's due to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> fact</font>

541
00:29:47,019 --> 00:29:53,499
that some<font color="#E5E5E5"> hacker work since here</font>

542
00:29:50,590 --> 00:29:57,189
generally is a<font color="#E5E5E5"> perfectly know the target</font>

543
00:29:53,499 --> 00:30:00,190
infrastructure if they<font color="#E5E5E5"> compromised this</font>

544
00:29:57,190 --> 00:30:03,549
<font color="#E5E5E5">target in the past</font><font color="#CCCCCC"> they know the</font><font color="#E5E5E5"> domain</font>

545
00:30:00,190 --> 00:30:05,859
name they know the naming convention of

546
00:30:03,549 --> 00:30:09,450
the<font color="#E5E5E5"> machine they know the naming</font>

547
00:30:05,859 --> 00:30:12,799
convention of<font color="#CCCCCC"> the username as I know</font>

548
00:30:09,450 --> 00:30:15,779
<font color="#E5E5E5">Monet's your network IP address</font><font color="#CCCCCC"> ranch</font>

549
00:30:12,799 --> 00:30:17,519
<font color="#E5E5E5">they know everything and it's really</font>

550
00:30:15,779 --> 00:30:19,320
<font color="#E5E5E5">easy to check if it's a real mission or</font>

551
00:30:17,519 --> 00:30:22,139
<font color="#E5E5E5">not you can simply check if it's the</font>

552
00:30:19,320 --> 00:30:23,879
same<font color="#CCCCCC"> domain than two months ago or when</font>

553
00:30:22,139 --> 00:30:26,820
years ago<font color="#E5E5E5"> cause you don't change them in</font>

554
00:30:23,880 --> 00:30:28,889
name every day<font color="#E5E5E5"> directly</font><font color="#CCCCCC"> same thing</font><font color="#E5E5E5"> for</font>

555
00:30:26,820 --> 00:30:31,110
the name convention<font color="#E5E5E5"> if all your user</font>

556
00:30:28,889 --> 00:30:33,418
<font color="#E5E5E5">name have the same naming convention and</font>

557
00:30:31,110 --> 00:30:36,059
<font color="#E5E5E5">I think it's case it's really</font><font color="#CCCCCC"> easy for</font>

558
00:30:33,419 --> 00:30:41,850
<font color="#CCCCCC">attackers to detect if it's a real name</font>

559
00:30:36,059 --> 00:30:44,908
or user one this one sandbox<font color="#E5E5E5"> one etc so</font>

560
00:30:41,850 --> 00:30:46,799
generally is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> attackers know better</font>

561
00:30:44,909 --> 00:30:49,970
your infrastructure<font color="#E5E5E5"> than you it's bad</font>

562
00:30:46,799 --> 00:30:54,570
<font color="#CCCCCC">that it's like that and it's really help</font>

563
00:30:49,970 --> 00:30:56,820
<font color="#E5E5E5">bad guys to deliver final payload and</font>

564
00:30:54,570 --> 00:30:58,980
<font color="#E5E5E5">remote and missile share to on</font><font color="#CCCCCC"> 0 they</font>

565
00:30:56,820 --> 00:31:00,299
only<font color="#E5E5E5"> on on the good target and for</font>

566
00:30:58,980 --> 00:31:02,460
company it's complicated because<font color="#E5E5E5"> we</font>

567
00:31:00,299 --> 00:31:05,039
<font color="#E5E5E5">don't know which targeted we don't know</font>

568
00:31:02,460 --> 00:31:10,620
what the guy is expected extra<font color="#E5E5E5"> extra so</font>

569
00:31:05,039 --> 00:31:14,190
yeah yeah<font color="#E5E5E5"> concerning the first part of</font>

570
00:31:10,620 --> 00:31:18,559
the presentation<font color="#CCCCCC"> I'm say Morris</font>

571
00:31:14,190 --> 00:31:21,539
everything I got<font color="#CCCCCC"> 10 minutes so I won't</font>

572
00:31:18,559 --> 00:31:24,389
have any questions sorry<font color="#CCCCCC"> and I would</font>

573
00:31:21,539 --> 00:31:27,899
like<font color="#CCCCCC"> to present</font><font color="#E5E5E5"> you something we will</font>

574
00:31:24,389 --> 00:31:34,229
release next week<font color="#CCCCCC"> best that I've got a</font>

575
00:31:27,899 --> 00:31:40,709
first<font color="#E5E5E5"> question</font><font color="#CCCCCC"> who use windbg</font><font color="#E5E5E5"> to analyze</font>

576
00:31:34,230 --> 00:31:43,799
powershell script nobody so<font color="#E5E5E5"> I will</font>

577
00:31:40,710 --> 00:31:45,960
<font color="#E5E5E5">explain</font><font color="#CCCCCC"> you why it's useful</font><font color="#E5E5E5"> and how you</font>

578
00:31:43,799 --> 00:31:49,620
can do that because I'm<font color="#CCCCCC"> sure you open</font><font color="#E5E5E5"> it</font>

579
00:31:45,960 --> 00:31:53,970
on<font color="#CCCCCC"> blog nut and read the code but it's</font>

580
00:31:49,620 --> 00:31:56,668
too easy<font color="#CCCCCC"> I really</font><font color="#E5E5E5"> like windbg and I will</font>

581
00:31:53,970 --> 00:32:01,260
show you how you can do it on this

582
00:31:56,669 --> 00:32:04,769
<font color="#CCCCCC">Dibakar</font><font color="#E5E5E5"> and then why you you should do</font>

583
00:32:01,260 --> 00:32:09,480
that yeah<font color="#CCCCCC"> so for</font><font color="#E5E5E5"> people that don't know</font>

584
00:32:04,769 --> 00:32:12,299
<font color="#E5E5E5">windbg we are just here and it's a</font>

585
00:32:09,480 --> 00:32:13,380
<font color="#E5E5E5">Microsoft debugger for for Windows of</font>

586
00:32:12,299 --> 00:32:17,220
course

587
00:32:13,380 --> 00:32:18,930
and it it's<font color="#E5E5E5"> really great if you</font><font color="#CCCCCC"> if you</font>

588
00:32:17,220 --> 00:32:20,700
never<font color="#E5E5E5"> use it</font><font color="#CCCCCC"> I really recommend to</font>

589
00:32:18,930 --> 00:32:26,060
<font color="#CCCCCC">install it and try to</font><font color="#E5E5E5"> do something with</font>

590
00:32:20,700 --> 00:32:30,390
with it so<font color="#CCCCCC"> such thing</font><font color="#E5E5E5"> if you play</font><font color="#CCCCCC"> with a</font>

591
00:32:26,060 --> 00:32:32,370
whisper<font color="#E5E5E5"> ocean</font><font color="#CCCCCC"> malware of draught or</font>

592
00:32:30,390 --> 00:32:37,290
stuff like that<font color="#E5E5E5"> on portion you can</font>

593
00:32:32,370 --> 00:32:39,840
<font color="#E5E5E5">directly execute unmanage code so you</font>

594
00:32:37,290 --> 00:32:43,980
can directly execute load library

595
00:32:39,840 --> 00:32:46,409
<font color="#E5E5E5">virtual</font><font color="#CCCCCC"> illogic cetera</font><font color="#E5E5E5"> in this case you</font>

596
00:32:43,980 --> 00:32:48,510
can<font color="#CCCCCC"> simply develop as usual you put a</font>

597
00:32:46,410 --> 00:32:50,280
breakpoint on<font color="#E5E5E5"> vector</font><font color="#CCCCCC"> Alec and it's</font>

598
00:32:48,510 --> 00:32:53,310
<font color="#E5E5E5">finished</font><font color="#CCCCCC"> it's not this part that you're</font>

599
00:32:50,280 --> 00:32:57,570
really<font color="#CCCCCC"> interests me but you can you can</font>

600
00:32:53,310 --> 00:33:04,230
do it<font color="#E5E5E5"> in my case I'm more interested</font>

601
00:32:57,570 --> 00:33:07,830
about<font color="#E5E5E5"> coercion API such as</font><font color="#CCCCCC"> stub process</font>

602
00:33:04,230 --> 00:33:11,970
<font color="#E5E5E5">don't load file extra extra</font><font color="#CCCCCC"> often at the</font>

603
00:33:07,830 --> 00:33:14,720
end dropper<font color="#E5E5E5"> execute something so</font><font color="#CCCCCC"> that</font>

604
00:33:11,970 --> 00:33:17,190
you start process<font color="#CCCCCC"> for example</font><font color="#E5E5E5"> often</font>

605
00:33:14,720 --> 00:33:18,540
<font color="#CCCCCC">powershell script</font><font color="#E5E5E5"> download something on</font>

606
00:33:17,190 --> 00:33:24,570
the internet<font color="#CCCCCC"> on the previous</font>

607
00:33:18,540 --> 00:33:26,340
presentation<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know the bad guys</font><font color="#E5E5E5"> use</font>

608
00:33:24,570 --> 00:33:29,370
perversion and<font color="#CCCCCC"> dunno decide to</font><font color="#E5E5E5"> download</font>

609
00:33:26,340 --> 00:33:32,639
<font color="#E5E5E5">something on on a compromised website</font>

610
00:33:29,370 --> 00:33:41,429
and it's something we we<font color="#E5E5E5"> really have</font>

611
00:33:32,640 --> 00:33:43,140
often on marijuana right<font color="#E5E5E5"> so in fact when</font>

612
00:33:41,430 --> 00:33:47,430
you use portion something you probably

613
00:33:43,140 --> 00:33:52,230
not know you use the dotnet framework in

614
00:33:47,430 --> 00:33:55,280
fact portion you<font color="#E5E5E5"> know maybe I need</font><font color="#CCCCCC"> to</font>

615
00:33:52,230 --> 00:33:55,280
increase<font color="#CCCCCC"> the font</font>

616
00:33:56,270 --> 00:33:59,299
[Music]

617
00:34:05,280 --> 00:34:08,500
[Music]

618
00:34:14,260 --> 00:34:25,880
yeah yeah<font color="#CCCCCC"> did</font><font color="#E5E5E5"> something interesting</font><font color="#CCCCCC"> a</font>

619
00:34:22,190 --> 00:34:28,460
<font color="#CCCCCC">shit if you look on the PowerShell</font>

620
00:34:25,880 --> 00:34:31,780
binary<font color="#E5E5E5"> it's not developed in that net</font>

621
00:34:28,460 --> 00:34:34,880
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> C please please</font><font color="#E5E5E5"> it's not dotnet but</font>

622
00:34:31,780 --> 00:34:38,360
if you do that<font color="#E5E5E5"> on the next</font><font color="#CCCCCC"> slide</font><font color="#E5E5E5"> just</font>

623
00:34:34,880 --> 00:34:40,130
for<font color="#CCCCCC"> comparison you have windows / that</font>

624
00:34:38,360 --> 00:34:45,800
<font color="#E5E5E5">night that's why I know it's not the net</font>

625
00:34:40,130 --> 00:34:47,810
<font color="#CCCCCC">fight</font><font color="#E5E5E5"> yeah my craw crappy sorry it does</font>

626
00:34:45,800 --> 00:34:51,770
not it<font color="#E5E5E5"> not developed in that net but it</font>

627
00:34:47,810 --> 00:34:54,440
<font color="#E5E5E5">used behind net framework</font><font color="#CCCCCC"> so if you are</font>

628
00:34:51,770 --> 00:34:58,790
able to<font color="#E5E5E5"> debug dotnet code you are able</font>

629
00:34:54,440 --> 00:35:03,050
<font color="#CCCCCC">to debug PowerShell script so I will</font>

630
00:34:58,790 --> 00:35:08,779
show<font color="#E5E5E5"> you I think I will</font><font color="#CCCCCC"> have the same</font>

631
00:35:03,050 --> 00:35:14,690
<font color="#E5E5E5">program with the font size but here you</font>

632
00:35:08,780 --> 00:35:19,460
if you you have an<font color="#E5E5E5"> extension on on on</font>

633
00:35:14,690 --> 00:35:22,910
windbg<font color="#CCCCCC"> name</font><font color="#E5E5E5"> s OS and in fact it</font><font color="#CCCCCC"> adds a</font>

634
00:35:19,460 --> 00:35:27,650
support<font color="#E5E5E5"> of the net debugging so if you</font>

635
00:35:22,910 --> 00:35:29,540
load<font color="#E5E5E5"> this this</font><font color="#CCCCCC"> plugin</font><font color="#E5E5E5"> this extension</font><font color="#CCCCCC"> you</font>

636
00:35:27,650 --> 00:35:33,380
will be able<font color="#E5E5E5"> to generate breakpoint</font>

637
00:35:29,540 --> 00:35:37,430
directly on that<font color="#CCCCCC"> net</font><font color="#E5E5E5"> code so in this</font>

638
00:35:33,380 --> 00:35:45,700
case I<font color="#E5E5E5"> will add a breakpoint on process</font>

639
00:35:37,430 --> 00:35:45,700
<font color="#E5E5E5">start so I would increase the font first</font>

640
00:35:51,430 --> 00:35:54,430
so

641
00:36:06,520 --> 00:36:17,390
so yeah I<font color="#CCCCCC"> attach I attach my</font><font color="#E5E5E5"> debugger to</font>

642
00:36:11,930 --> 00:36:27,910
the<font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> and at this</font><font color="#E5E5E5"> time I'm</font>

643
00:36:17,390 --> 00:36:33,140
able<font color="#CCCCCC"> to load the s.o.s library</font><font color="#E5E5E5"> yep</font><font color="#CCCCCC"> and</font>

644
00:36:27,910 --> 00:36:40,490
I'm able to<font color="#E5E5E5"> put a breakpoint on start</font>

645
00:36:33,140 --> 00:36:42,620
process here like that yeah<font color="#E5E5E5"> yeah windbg</font>

646
00:36:40,490 --> 00:36:47,629
stop or<font color="#E5E5E5"> freeze that you must execute the</font>

647
00:36:42,620 --> 00:36:50,600
command<font color="#E5E5E5"> Weiss yeah it's true and here</font>

648
00:36:47,630 --> 00:36:55,610
here you can see that<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> know six</font>

649
00:36:50,600 --> 00:36:57,770
six<font color="#CCCCCC"> breakpoint was created because you</font>

650
00:36:55,610 --> 00:37:00,940
can have<font color="#E5E5E5"> the same function but with</font>

651
00:36:57,770 --> 00:37:03,950
different<font color="#E5E5E5"> kind of argument and you have</font>

652
00:37:00,940 --> 00:37:06,970
in this<font color="#E5E5E5"> case you can</font><font color="#CCCCCC"> put six different</font>

653
00:37:03,950 --> 00:37:10,220
kind<font color="#E5E5E5"> of arguments to process that and</font>

654
00:37:06,970 --> 00:37:16,600
you<font color="#E5E5E5"> that's why he will put breakpoint on</font>

655
00:37:10,220 --> 00:37:19,009
each one at this time I'll start<font color="#E5E5E5"> now I</font>

656
00:37:16,600 --> 00:37:19,640
<font color="#E5E5E5">say go because I'm stuck during</font>

657
00:37:19,010 --> 00:37:29,840
execution

658
00:37:19,640 --> 00:37:36,770
<font color="#E5E5E5">yep you can do start - I'm going to copy</font>

659
00:37:29,840 --> 00:37:43,280
this stop process I can<font color="#E5E5E5"> do start process</font>

660
00:37:36,770 --> 00:37:46,940
of not<font color="#E5E5E5"> fat for</font><font color="#CCCCCC"> example and my depa graph</font>

661
00:37:43,280 --> 00:37:53,090
will be<font color="#E5E5E5"> automatically blocked</font><font color="#CCCCCC"> stop the</font>

662
00:37:46,940 --> 00:37:55,940
<font color="#CCCCCC">execution</font><font color="#E5E5E5"> when process process that will</font>

663
00:37:53,090 --> 00:37:59,210
<font color="#E5E5E5">be</font><font color="#CCCCCC"> executive at this time I've got</font>

664
00:37:55,940 --> 00:38:01,310
<font color="#E5E5E5">specific command link to the SOS</font>

665
00:37:59,210 --> 00:38:06,350
extension that<font color="#E5E5E5"> allows me</font><font color="#CCCCCC"> to get</font>

666
00:38:01,310 --> 00:38:11,330
<font color="#E5E5E5">information from from the</font><font color="#CCCCCC"> netcode you</font>

667
00:38:06,350 --> 00:38:13,490
got for example<font color="#CCCCCC"> seller stack</font><font color="#E5E5E5"> -</font><font color="#CCCCCC"> P it</font><font color="#E5E5E5"> will</font>

668
00:38:11,330 --> 00:38:16,369
give you the stack<font color="#E5E5E5"> so</font>

669
00:38:13,490 --> 00:38:19,490
the same thing that the stack in<font color="#CCCCCC"> tsipras</font>

670
00:38:16,369 --> 00:38:23,210
<font color="#E5E5E5">press and</font><font color="#CCCCCC"> managed language but in this</font>

671
00:38:19,490 --> 00:38:27,828
case it's a<font color="#CCCCCC"> bit net view you will see</font><font color="#E5E5E5"> so</font>

672
00:38:23,210 --> 00:38:30,529
here if I go on<font color="#E5E5E5"> the top yeah here just</font>

673
00:38:27,829 --> 00:38:33,770
after<font color="#E5E5E5"> I can see my start</font><font color="#CCCCCC"> process my</font>

674
00:38:30,529 --> 00:38:38,390
process start here<font color="#E5E5E5"> and the argument is a</font>

675
00:38:33,770 --> 00:38:42,049
start info structure<font color="#E5E5E5"> you can click</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> it</font>

676
00:38:38,390 --> 00:38:45,200
and here you've got the structure<font color="#CCCCCC"> sort</font>

677
00:38:42,049 --> 00:38:48,799
of the<font color="#E5E5E5"> argument and the first</font><font color="#CCCCCC"> feel of</font>

678
00:38:45,200 --> 00:38:52,578
the structure here is<font color="#E5E5E5"> fine</font><font color="#CCCCCC"> you click</font><font color="#E5E5E5"> on</font>

679
00:38:48,799 --> 00:38:54,680
it simply<font color="#E5E5E5"> and it's a string and here</font>

680
00:38:52,579 --> 00:38:57,170
you've got the value so you are able to

681
00:38:54,680 --> 00:39:00,618
<font color="#E5E5E5">get the value</font><font color="#CCCCCC"> of start process inside</font><font color="#E5E5E5"> of</font>

682
00:38:57,170 --> 00:39:03,260
windbg<font color="#CCCCCC"> so basically you</font><font color="#E5E5E5"> can make script</font>

683
00:39:00,619 --> 00:39:08,480
to automatically get this value when

684
00:39:03,260 --> 00:39:28,220
start process is executed we can do

685
00:39:08,480 --> 00:39:32,589
something<font color="#CCCCCC"> else just here</font><font color="#E5E5E5"> we can make the</font>

686
00:39:28,220 --> 00:39:40,788
same thing I just<font color="#CCCCCC"> left my</font><font color="#E5E5E5"> mouse I</font>

687
00:39:32,589 --> 00:39:45,740
continue the execution and yeah I got<font color="#E5E5E5"> a</font>

688
00:39:40,789 --> 00:39:47,779
second track point yeah and<font color="#E5E5E5"> sure you've</font>

689
00:39:45,740 --> 00:39:51,200
got not bad executed between<font color="#E5E5E5"> my</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> may</font>

690
00:39:47,779 --> 00:39:53,779
describe something<font color="#E5E5E5"> else is exactly</font><font color="#CCCCCC"> what</font>

691
00:39:51,200 --> 00:39:58,509
was mentioned<font color="#CCCCCC"> or</font><font color="#E5E5E5"> previously I</font><font color="#CCCCCC"> would like</font>

692
00:39:53,779 --> 00:40:05,160
to<font color="#E5E5E5"> monitor</font><font color="#CCCCCC"> on that file</font><font color="#E5E5E5"> so yeah I just</font>

693
00:39:58,510 --> 00:40:12,599
need to kill<font color="#CCCCCC"> it and start it again</font><font color="#E5E5E5"> yeah</font>

694
00:40:05,160 --> 00:40:15,828
so<font color="#E5E5E5"> I</font><font color="#CCCCCC"> execute</font><font color="#E5E5E5"> my portion here I've</font><font color="#CCCCCC"> got a</font>

695
00:40:12,599 --> 00:40:26,029
second<font color="#E5E5E5"> the</font><font color="#CCCCCC"> burger</font><font color="#E5E5E5"> I just need to</font>

696
00:40:15,829 --> 00:40:26,029
increase the font<font color="#CCCCCC"> I attend to my portion</font>

697
00:40:27,289 --> 00:40:30,589
<font color="#CCCCCC">there we go</font>

698
00:40:31,670 --> 00:40:42,359
here is yep<font color="#CCCCCC"> okay so at this time I can</font>

699
00:40:39,329 --> 00:40:43,980
do exactly<font color="#E5E5E5"> the same thing by loading SOS</font>

700
00:40:42,359 --> 00:40:53,130
the library<font color="#CCCCCC"> I</font>

701
00:40:43,980 --> 00:41:00,059
<font color="#E5E5E5">I'm</font><font color="#CCCCCC"> ention</font><font color="#E5E5E5"> to you okay</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> our width</font>

702
00:40:53,130 --> 00:41:05,789
breakpoint<font color="#E5E5E5"> on download file so here I</font>

703
00:41:00,059 --> 00:41:09,509
click it twice<font color="#E5E5E5"> it works and I start the</font>

704
00:41:05,789 --> 00:41:14,160
<font color="#E5E5E5">execution</font><font color="#CCCCCC"> of my portion okay it's</font>

705
00:41:09,509 --> 00:41:19,140
executing and I create my web client

706
00:41:14,160 --> 00:41:21,690
object inside of the<font color="#E5E5E5"> portion okay</font><font color="#CCCCCC"> and I</font>

707
00:41:19,140 --> 00:41:27,690
try to<font color="#E5E5E5"> download something on the</font>

708
00:41:21,690 --> 00:41:31,109
<font color="#CCCCCC">internet here you cannot read it but</font>

709
00:41:27,690 --> 00:41:32,970
<font color="#E5E5E5">simply</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> on the time my debugger is</font>

710
00:41:31,109 --> 00:41:36,089
<font color="#E5E5E5">automatically stopped because I try to</font>

711
00:41:32,970 --> 00:41:43,558
do don't<font color="#CCCCCC"> know try and</font><font color="#E5E5E5"> this time instead</font>

712
00:41:36,089 --> 00:41:48,000
of using<font color="#CCCCCC"> looking for my</font><font color="#E5E5E5"> mouse instead of</font>

713
00:41:43,559 --> 00:41:51,119
using<font color="#E5E5E5"> celesta I can directly ask for in</font>

714
00:41:48,000 --> 00:41:53,130
the register and in<font color="#E5E5E5"> this case I got</font><font color="#CCCCCC"> the</font>

715
00:41:51,119 --> 00:41:57,710
<font color="#CCCCCC">URL directly direct the record directly</font>

716
00:41:53,130 --> 00:41:57,710
in memory so

717
00:41:58,050 --> 00:42:07,740
I'm going to show you finally because

718
00:42:02,760 --> 00:42:13,710
yeah it's nice<font color="#E5E5E5"> but it's not really it</font>

719
00:42:07,740 --> 00:42:16,680
<font color="#CCCCCC">Manuel I just</font><font color="#E5E5E5"> I created a Python script</font>

720
00:42:13,710 --> 00:42:21,330
<font color="#CCCCCC">to</font><font color="#E5E5E5"> automatically do this kind of thing</font>

721
00:42:16,680 --> 00:42:26,190
so<font color="#CCCCCC"> I use</font><font color="#E5E5E5"> PKD it's a</font><font color="#CCCCCC"> patent extension for</font>

722
00:42:21,330 --> 00:42:35,400
windbg<font color="#CCCCCC"> and I'm going</font><font color="#E5E5E5"> to execute my</font>

723
00:42:26,190 --> 00:42:39,420
script directly<font color="#E5E5E5"> on unmoving</font><font color="#CCCCCC"> dbj that's</font>

724
00:42:35,400 --> 00:42:41,640
nice and I'm going to<font color="#E5E5E5"> take exactly the</font>

725
00:42:39,420 --> 00:42:46,950
<font color="#E5E5E5">same</font><font color="#CCCCCC"> things that don't</font><font color="#E5E5E5"> fly</font><font color="#CCCCCC"> in blah blah</font>

726
00:42:41,640 --> 00:42:49,310
blah<font color="#CCCCCC"> and at this</font><font color="#E5E5E5"> time I will</font>

727
00:42:46,950 --> 00:42:57,439
automatically them everything in JSON

728
00:42:49,310 --> 00:43:00,330
here so I<font color="#CCCCCC"> I need to go in beginning</font>

729
00:42:57,440 --> 00:43:04,230
<font color="#E5E5E5">maybe it will be</font><font color="#CCCCCC"> easier in the screen</font>

730
00:43:00,330 --> 00:43:08,700
yeah<font color="#E5E5E5"> so here you can see the file name</font>

731
00:43:04,230 --> 00:43:10,950
<font color="#E5E5E5">is directly</font><font color="#CCCCCC"> jima dot txt so it's where I</font>

732
00:43:08,700 --> 00:43:16,220
want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> download file download the file</font>

733
00:43:10,950 --> 00:43:22,700
thanks to download<font color="#E5E5E5"> hi if I try to</font>

734
00:43:16,220 --> 00:43:26,220
execute<font color="#E5E5E5"> in this time not</font><font color="#CCCCCC"> by that exit I</font>

735
00:43:22,700 --> 00:43:30,600
<font color="#CCCCCC">got my didn't hear that part is executed</font>

736
00:43:26,220 --> 00:43:34,080
of course and if I look on<font color="#E5E5E5"> on my reason</font>

737
00:43:30,600 --> 00:43:36,630
I so I try to execute processor the

738
00:43:34,080 --> 00:43:39,180
first argument is<font color="#CCCCCC"> a string</font><font color="#E5E5E5"> it's not bad</font>

739
00:43:36,630 --> 00:43:42,240
second argument is a string in the

740
00:43:39,180 --> 00:43:45,839
directory or in fact<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> start</font>

741
00:43:42,240 --> 00:43:48,540
process<font color="#CCCCCC"> that objects</font><font color="#E5E5E5"> in dotnet second</font>

742
00:43:45,840 --> 00:43:52,770
field is<font color="#E5E5E5"> the directory whether is</font>

743
00:43:48,540 --> 00:43:54,509
executed the the process etc<font color="#E5E5E5"> so thanks</font>

744
00:43:52,770 --> 00:43:57,660
<font color="#CCCCCC">to the script you can directly dump in</font>

745
00:43:54,510 --> 00:44:05,280
<font color="#E5E5E5">JSON and easily manage it in</font><font color="#CCCCCC"> Python you</font>

746
00:43:57,660 --> 00:44:09,450
<font color="#E5E5E5">can you show strings and integral</font><font color="#CCCCCC"> double</font>

747
00:44:05,280 --> 00:44:11,760
Exeter extra so quickly in this case

748
00:44:09,450 --> 00:44:12,058
argument is empty<font color="#E5E5E5"> because I don't put</font>

749
00:44:11,760 --> 00:44:14,279
any

750
00:44:12,059 --> 00:44:16,709
argument in that<font color="#E5E5E5"> bad but if I want to</font>

751
00:44:14,279 --> 00:44:20,189
<font color="#CCCCCC">open a file you will have</font><font color="#E5E5E5"> so it's a</font><font color="#CCCCCC"> five</font>

752
00:44:16,709 --> 00:44:23,009
<font color="#CCCCCC">bath</font><font color="#E5E5E5"> extra</font><font color="#CCCCCC"> extra and if it's boolean</font>

753
00:44:20,189 --> 00:44:27,479
<font color="#CCCCCC">your word 0xo</font><font color="#E5E5E5"> so the code</font><font color="#CCCCCC"> will be</font>

754
00:44:23,009 --> 00:44:31,499
normally<font color="#E5E5E5"> next week on</font><font color="#CCCCCC"> Terios gita and</font>

755
00:44:27,479 --> 00:44:34,169
<font color="#E5E5E5">the thing is why</font><font color="#CCCCCC"> i simply</font><font color="#E5E5E5"> open my</font>

756
00:44:31,499 --> 00:44:36,509
portion on a notepad and<font color="#E5E5E5"> it works i</font><font color="#CCCCCC"> can</font>

757
00:44:34,170 --> 00:44:38,459
read the code for several rhythm

758
00:44:36,509 --> 00:44:42,569
the first one is imagine you have to

759
00:44:38,459 --> 00:44:45,089
<font color="#E5E5E5">analyze</font><font color="#CCCCCC"> 1000 powershell script</font><font color="#E5E5E5"> you can</font>

760
00:44:42,569 --> 00:44:47,089
<font color="#CCCCCC">append 1000 not</font><font color="#E5E5E5"> pad and read on it it</font>

761
00:44:45,089 --> 00:44:49,699
should<font color="#E5E5E5"> work</font><font color="#CCCCCC"> but it's going to take times</font>

762
00:44:47,089 --> 00:44:52,140
thanks<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> Python script you can</font>

763
00:44:49,699 --> 00:44:56,809
automatically and<font color="#E5E5E5"> the thousands of</font>

764
00:44:52,140 --> 00:45:05,368
<font color="#E5E5E5">scripts without any problem</font><font color="#CCCCCC"> other thing</font>

765
00:44:56,809 --> 00:45:07,289
is if if million<font color="#CCCCCC"> ah</font><font color="#E5E5E5"> I use it to for</font>

766
00:45:05,369 --> 00:45:08,189
example<font color="#E5E5E5"> automatically unpack that net</font>

767
00:45:07,289 --> 00:45:11,789
<font color="#CCCCCC">vaca</font>

768
00:45:08,189 --> 00:45:14,160
<font color="#E5E5E5">so on the code you</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> the possibility</font>

769
00:45:11,789 --> 00:45:17,819
to them byte array from memory

770
00:45:14,160 --> 00:45:19,890
<font color="#E5E5E5">so if on</font><font color="#CCCCCC"> one specific API you have a</font>

771
00:45:17,819 --> 00:45:22,650
byte<font color="#CCCCCC"> array</font><font color="#E5E5E5"> I directly dump it on the</font>

772
00:45:19,890 --> 00:45:24,989
file and it's<font color="#E5E5E5"> really useful because that</font>

773
00:45:22,650 --> 00:45:27,619
<font color="#CCCCCC">that bacteria usually use assembly or</font>

774
00:45:24,989 --> 00:45:30,449
stuff like<font color="#CCCCCC"> that and it's byte array and</font>

775
00:45:27,619 --> 00:45:33,739
thanks to this script you can execute

776
00:45:30,449 --> 00:45:37,650
your malware on the virtual machine<font color="#E5E5E5"> and</font>

777
00:45:33,739 --> 00:45:41,869
it will automatically them on your discs

778
00:45:37,650 --> 00:45:44,939
the vital reform in memory during API

779
00:45:41,869 --> 00:45:49,589
<font color="#E5E5E5">several</font><font color="#CCCCCC"> API</font><font color="#E5E5E5"> such as load assembly and</font>

780
00:45:44,939 --> 00:45:53,609
stuff stuff like that<font color="#E5E5E5"> the</font><font color="#CCCCCC"> syntax</font><font color="#E5E5E5"> is it's</font>

781
00:45:49,589 --> 00:45:56,369
a little bit small but you simply<font color="#E5E5E5"> have</font>

782
00:45:53,609 --> 00:45:58,979
<font color="#CCCCCC">to put the</font><font color="#E5E5E5"> function you want to</font><font color="#CCCCCC"> monitor</font>

783
00:45:56,369 --> 00:46:02,069
<font color="#CCCCCC">and it will automatically monitor them</font>

784
00:45:58,979 --> 00:46:08,160
so it's really really<font color="#CCCCCC"> easy</font><font color="#E5E5E5"> yes and I</font>

785
00:46:02,069 --> 00:46:11,429
like I love<font color="#CCCCCC"> pinky stuff and I come</font><font color="#E5E5E5"> back</font>

786
00:46:08,160 --> 00:46:13,469
quickly<font color="#E5E5E5"> on the sly yeah so</font><font color="#CCCCCC"> basically all</font>

787
00:46:11,429 --> 00:46:15,479
<font color="#E5E5E5">I</font><font color="#CCCCCC"> explain and show to you</font><font color="#E5E5E5"> on the slide I</font>

788
00:46:13,469 --> 00:46:18,019
<font color="#E5E5E5">will</font><font color="#CCCCCC"> show the slide with organizer so</font>

789
00:46:15,479 --> 00:46:22,529
you will have them on on the<font color="#E5E5E5"> website</font>

790
00:46:18,019 --> 00:46:25,459
black<font color="#E5E5E5"> point on process starts CLR stack</font>

791
00:46:22,529 --> 00:46:28,359
to get argument of<font color="#CCCCCC"> process</font>

792
00:46:25,460 --> 00:46:31,310
on process<font color="#CCCCCC"> dad in this case it's</font>

793
00:46:28,359 --> 00:46:32,900
starting for<font color="#CCCCCC"> structural good address you</font>

794
00:46:31,310 --> 00:46:34,520
can click on<font color="#CCCCCC"> it</font><font color="#E5E5E5"> you've got the</font><font color="#CCCCCC"> finance</font>

795
00:46:32,900 --> 00:46:38,420
and<font color="#E5E5E5"> if you click on find them you have</font>

796
00:46:34,520 --> 00:46:40,310
the exaction<font color="#CCCCCC"> pass of the binary</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font>

797
00:46:38,420 --> 00:46:41,960
directly get it from register if you

798
00:46:40,310 --> 00:46:44,210
<font color="#E5E5E5">like to</font><font color="#CCCCCC"> pay with register instead of</font>

799
00:46:41,960 --> 00:46:46,430
using<font color="#E5E5E5"> a</font><font color="#CCCCCC"> cell a stack and Street and</font>

800
00:46:44,210 --> 00:46:49,070
stuff like that<font color="#E5E5E5"> so the difficulties with</font>

801
00:46:46,430 --> 00:46:51,470
windbg<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the syntax is really hard to</font>

802
00:46:49,070 --> 00:46:56,690
pass that's why I<font color="#CCCCCC"> put a Python script to</font>

803
00:46:51,470 --> 00:46:58,220
pass each field correctly extra the same

804
00:46:56,690 --> 00:47:00,140
thing<font color="#E5E5E5"> from download file our</font><font color="#CCCCCC"> breakpoint</font>

805
00:46:58,220 --> 00:47:04,129
on<font color="#E5E5E5"> download file server breakpoint I</font>

806
00:47:00,140 --> 00:47:06,200
automatically created and<font color="#CCCCCC"> I get directly</font>

807
00:47:04,130 --> 00:47:09,710
from from registry the first argument<font color="#CCCCCC"> in</font>

808
00:47:06,200 --> 00:47:12,348
<font color="#CCCCCC">this second</font><font color="#E5E5E5"> document and I</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> manage</font>

809
00:47:09,710 --> 00:47:14,180
thousands of<font color="#CCCCCC"> street</font><font color="#E5E5E5"> really quickly on on</font>

810
00:47:12,349 --> 00:47:16,730
a virtual machine<font color="#E5E5E5"> it's not a problem</font>

811
00:47:14,180 --> 00:47:19,669
and for example<font color="#CCCCCC"> I can automatically save</font>

812
00:47:16,730 --> 00:47:22,310
the second<font color="#CCCCCC"> document so saves of</font>

813
00:47:19,670 --> 00:47:25,099
downloaded file and put<font color="#CCCCCC"> it on specific</font>

814
00:47:22,310 --> 00:47:29,330
directory and I've downloaded<font color="#E5E5E5"> once I</font>

815
00:47:25,099 --> 00:47:32,810
60,000<font color="#CCCCCC"> off script</font><font color="#E5E5E5"> it's not a problem so</font>

816
00:47:29,330 --> 00:47:36,490
if you<font color="#CCCCCC"> have question</font><font color="#E5E5E5"> our station was a</font>

817
00:47:32,810 --> 00:47:39,410
base or no problem and<font color="#CCCCCC"> I'd like to</font><font color="#E5E5E5"> thank</font>

818
00:47:36,490 --> 00:47:44,399
<font color="#E5E5E5">wine specially if you send a lot</font><font color="#CCCCCC"> of to</font>

819
00:47:39,410 --> 00:47:47,089
<font color="#CCCCCC">it and thank you</font><font color="#E5E5E5"> for for your attention</font>

820
00:47:44,400 --> 00:47:50,239
[Music]

821
00:47:47,090 --> 00:47:50,239
[Applause]

