1
00:00:00,030 --> 00:00:05,190
<font color="#E5E5E5">all right all right</font><font color="#CCCCCC"> good afternoon</font>

2
00:00:03,240 --> 00:00:06,270
everybody<font color="#CCCCCC"> thanks for coming to my talk</font>

3
00:00:05,190 --> 00:00:10,080
<font color="#E5E5E5">honey</font>

4
00:00:06,270 --> 00:00:13,170
I stole<font color="#CCCCCC"> your c2 server so my name</font><font color="#E5E5E5"> is</font>

5
00:00:10,080 --> 00:00:15,929
<font color="#E5E5E5">Andy rector consultant with</font><font color="#CCCCCC"> mandiant</font>

6
00:00:13,170 --> 00:00:18,539
based out of San<font color="#CCCCCC"> Francisco office I've</font>

7
00:00:15,929 --> 00:00:20,880
been with<font color="#CCCCCC"> Mangan for over</font><font color="#E5E5E5"> two years</font><font color="#CCCCCC"> my</font>

8
00:00:18,539 --> 00:00:23,850
primary focus<font color="#E5E5E5"> is digital forensics and</font>

9
00:00:20,880 --> 00:00:25,710
Incident Response during that time we've

10
00:00:23,850 --> 00:00:28,279
conducted several<font color="#CCCCCC"> enterprise</font>

11
00:00:25,710 --> 00:00:30,420
<font color="#CCCCCC">investigations</font><font color="#E5E5E5"> for fortune 500</font><font color="#CCCCCC"> companies</font>

12
00:00:28,279 --> 00:00:32,820
<font color="#E5E5E5">involving all</font><font color="#CCCCCC"> sorts of different</font>

13
00:00:30,420 --> 00:00:36,320
<font color="#E5E5E5">industries</font><font color="#CCCCCC"> high tech health care</font>

14
00:00:32,820 --> 00:00:38,399
financial you name it<font color="#E5E5E5"> all over the place</font>

15
00:00:36,320 --> 00:00:40,500
<font color="#E5E5E5">so what I'm going to talk to you guys</font>

16
00:00:38,399 --> 00:00:44,190
<font color="#E5E5E5">today about is an investigation that</font>

17
00:00:40,500 --> 00:00:45,180
<font color="#E5E5E5">mandiant did in 2016 late 2016</font>

18
00:00:44,190 --> 00:00:47,780
I'm going to give you a high-level

19
00:00:45,180 --> 00:00:51,090
overview of<font color="#E5E5E5"> how that investigation went</font>

20
00:00:47,780 --> 00:00:53,219
what kinds<font color="#E5E5E5"> of stuff we found and just</font>

21
00:00:51,090 --> 00:00:55,770
overall what what that investigation

22
00:00:53,219 --> 00:00:59,489
<font color="#E5E5E5">looked like and then I'm going to go</font>

23
00:00:55,770 --> 00:01:01,680
<font color="#E5E5E5">into the analysis of a c2 server so we</font>

24
00:00:59,489 --> 00:01:03,599
were able<font color="#CCCCCC"> to obtain</font><font color="#E5E5E5"> a c2 server</font><font color="#CCCCCC"> I'm</font>

25
00:01:01,680 --> 00:01:06,570
going to tell you about how<font color="#E5E5E5"> that whole</font>

26
00:01:03,600 --> 00:01:08,580
process worked and how rare and kind<font color="#E5E5E5"> of</font>

27
00:01:06,570 --> 00:01:10,729
exciting the analysis was and some

28
00:01:08,580 --> 00:01:13,890
<font color="#E5E5E5">interesting findings that came from</font>

29
00:01:10,729 --> 00:01:16,530
<font color="#CCCCCC">Postgres</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> Postgres database on the c2</font>

30
00:01:13,890 --> 00:01:20,490
server and then lastly I'm going to<font color="#E5E5E5"> talk</font>

31
00:01:16,530 --> 00:01:23,880
<font color="#CCCCCC">about post-rock</font><font color="#E5E5E5"> a Python program that I</font>

32
00:01:20,490 --> 00:01:31,820
paid<font color="#E5E5E5"> to carve</font><font color="#CCCCCC"> Postgres rose from a flat</font>

33
00:01:23,880 --> 00:01:35,369
binary file<font color="#CCCCCC"> ok so before we get into</font>

34
00:01:31,820 --> 00:01:37,139
what made this investigation so rare and

35
00:01:35,369 --> 00:01:40,350
<font color="#E5E5E5">exciting</font><font color="#CCCCCC"> you should understand what a</font>

36
00:01:37,140 --> 00:01:42,530
typical investigation looks like so what

37
00:01:40,350 --> 00:01:44,699
normally happens is a client calls us

38
00:01:42,530 --> 00:01:46,950
<font color="#E5E5E5">they've identified some malicious</font>

39
00:01:44,700 --> 00:01:48,899
activity in their environment<font color="#E5E5E5"> either by</font>

40
00:01:46,950 --> 00:01:52,020
themselves or<font color="#E5E5E5"> through some external</font>

41
00:01:48,899 --> 00:01:54,509
notification like law enforcement<font color="#CCCCCC"> or or</font>

42
00:01:52,020 --> 00:01:57,960
something else<font color="#CCCCCC"> so we have a scoping call</font>

43
00:01:54,509 --> 00:01:59,790
we decide to deploy<font color="#E5E5E5"> technology so we</font>

44
00:01:57,960 --> 00:02:02,610
deploy some network based technology

45
00:01:59,790 --> 00:02:03,990
it's an endpoint<font color="#E5E5E5"> based technology this</font>

46
00:02:02,610 --> 00:02:05,700
gives us full coverage<font color="#E5E5E5"> of their</font>

47
00:02:03,990 --> 00:02:08,758
<font color="#E5E5E5">environment or as close to full coverage</font>

48
00:02:05,700 --> 00:02:10,890
<font color="#E5E5E5">as we can possibly get and then we begin</font>

49
00:02:08,758 --> 00:02:14,250
<font color="#CCCCCC">the investigation</font><font color="#E5E5E5"> itself so this is</font>

50
00:02:10,889 --> 00:02:17,910
where we our<font color="#E5E5E5"> tagline find evil</font><font color="#CCCCCC"> solve</font>

51
00:02:14,250 --> 00:02:20,790
oh this<font color="#E5E5E5"> is kind</font><font color="#CCCCCC"> of a cyclic</font><font color="#E5E5E5"> cycle where</font>

52
00:02:17,910 --> 00:02:24,450
<font color="#E5E5E5">basically we search the environment for</font>

53
00:02:20,790 --> 00:02:26,609
indicators of malicious activity<font color="#E5E5E5"> up once</font>

54
00:02:24,450 --> 00:02:30,238
we<font color="#E5E5E5"> find something we perform analysis</font><font color="#CCCCCC"> on</font>

55
00:02:26,610 --> 00:02:33,750
the system<font color="#E5E5E5"> or whatever the source of</font>

56
00:02:30,239 --> 00:02:35,489
<font color="#CCCCCC">evidence is</font><font color="#E5E5E5"> that once we</font><font color="#CCCCCC"> find activity</font>

57
00:02:33,750 --> 00:02:38,849
there we continue searching the

58
00:02:35,489 --> 00:02:40,650
environment<font color="#E5E5E5"> and identify additional</font>

59
00:02:38,849 --> 00:02:42,750
<font color="#CCCCCC">evidence of activity</font><font color="#E5E5E5"> we keep pulling</font>

60
00:02:40,650 --> 00:02:46,170
<font color="#CCCCCC">those strings until there's nothing left</font>

61
00:02:42,750 --> 00:02:48,840
to find<font color="#E5E5E5"> once we were</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to completely</font>

62
00:02:46,170 --> 00:02:50,790
scope<font color="#E5E5E5"> the environment and get</font>

63
00:02:48,840 --> 00:02:53,099
<font color="#E5E5E5">comfortable</font><font color="#CCCCCC"> at a</font><font color="#E5E5E5"> comfortable</font><font color="#CCCCCC"> level that</font>

64
00:02:50,790 --> 00:02:56,640
we've identified as much of the activity

65
00:02:53,099 --> 00:02:59,069
<font color="#E5E5E5">as we can we perform in eradication</font>

66
00:02:56,640 --> 00:03:02,819
<font color="#E5E5E5">event or remediation event where we kick</font>

67
00:02:59,069 --> 00:03:05,220
out those<font color="#E5E5E5"> pesky attackers</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> also try</font>

68
00:03:02,819 --> 00:03:06,899
to improve<font color="#CCCCCC"> the security</font><font color="#E5E5E5"> posture of our</font>

69
00:03:05,220 --> 00:03:11,900
client<font color="#E5E5E5"> so this is where we do things</font>

70
00:03:06,900 --> 00:03:14,010
<font color="#E5E5E5">like blocking</font><font color="#CCCCCC"> see to rebuilding systems</font>

71
00:03:11,900 --> 00:03:15,630
<font color="#CCCCCC">and all the other things that</font><font color="#E5E5E5"> go</font><font color="#CCCCCC"> along</font>

72
00:03:14,010 --> 00:03:19,560
<font color="#CCCCCC">with I like passwords enterprise</font>

73
00:03:15,630 --> 00:03:21,420
password resets once<font color="#E5E5E5"> that's done we</font>

74
00:03:19,560 --> 00:03:23,069
perform some<font color="#CCCCCC"> post remediation monitoring</font>

75
00:03:21,420 --> 00:03:24,708
just to make<font color="#CCCCCC"> sure those pesky</font><font color="#E5E5E5"> attackers</font>

76
00:03:23,069 --> 00:03:27,149
don't come back into<font color="#CCCCCC"> your environment</font>

77
00:03:24,709 --> 00:03:29,579
<font color="#CCCCCC">that</font><font color="#E5E5E5"> usually</font><font color="#CCCCCC"> last anywhere from</font><font color="#E5E5E5"> two to</font>

78
00:03:27,150 --> 00:03:31,620
<font color="#CCCCCC">four weeks</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> to make sure that</font><font color="#E5E5E5"> that</font>

79
00:03:29,579 --> 00:03:34,650
everything's good<font color="#CCCCCC"> everything's</font><font color="#E5E5E5"> a tip-top</font>

80
00:03:31,620 --> 00:03:37,200
<font color="#CCCCCC">shape</font><font color="#E5E5E5"> once that process is</font><font color="#CCCCCC"> done that's</font>

81
00:03:34,650 --> 00:03:39,870
kind of the<font color="#E5E5E5"> end of our</font><font color="#CCCCCC"> involvement with</font>

82
00:03:37,200 --> 00:03:43,709
our<font color="#E5E5E5"> client and it passes</font><font color="#CCCCCC"> on to a</font>

83
00:03:39,870 --> 00:03:46,380
different<font color="#CCCCCC"> business unit</font><font color="#E5E5E5"> and so on so</font>

84
00:03:43,709 --> 00:03:48,690
<font color="#E5E5E5">this investigation actually kind of</font>

85
00:03:46,380 --> 00:03:51,859
started out<font color="#E5E5E5"> pretty pretty similar</font><font color="#CCCCCC"> to</font>

86
00:03:48,690 --> 00:03:55,220
<font color="#E5E5E5">everything else</font><font color="#CCCCCC"> so this is a fortune</font><font color="#E5E5E5"> 500</font>

87
00:03:51,859 --> 00:03:57,480
<font color="#E5E5E5">financial based client</font><font color="#CCCCCC"> and they were</font>

88
00:03:55,220 --> 00:04:00,599
aggregating<font color="#CCCCCC"> windows event logs into a</font>

89
00:03:57,480 --> 00:04:03,660
<font color="#CCCCCC">syn interface and they identified some</font>

90
00:04:00,599 --> 00:04:06,410
suspicious<font color="#E5E5E5"> service installations</font><font color="#CCCCCC"> and</font>

91
00:04:03,660 --> 00:04:10,079
this was existed in September of 2016<font color="#CCCCCC"> so</font>

92
00:04:06,410 --> 00:04:14,970
<font color="#CCCCCC">what did that</font><font color="#E5E5E5"> look</font><font color="#CCCCCC"> like something like</font>

93
00:04:10,079 --> 00:04:16,950
<font color="#CCCCCC">this</font><font color="#E5E5E5"> this big huge ugly</font><font color="#CCCCCC"> blob</font><font color="#E5E5E5"> just a show</font>

94
00:04:14,970 --> 00:04:21,269
<font color="#CCCCCC">of hands</font><font color="#E5E5E5"> has anybody ever seen something</font>

95
00:04:16,950 --> 00:04:24,150
<font color="#CCCCCC">like</font><font color="#E5E5E5"> this yeah</font><font color="#CCCCCC"> a couple of</font><font color="#E5E5E5"> people if</font>

96
00:04:21,269 --> 00:04:26,340
anybody knows maybe what made this or

97
00:04:24,150 --> 00:04:29,239
what<font color="#E5E5E5"> this is artifact based off of just</font>

98
00:04:26,340 --> 00:04:29,239
yell it<font color="#E5E5E5"> anybody</font>

99
00:04:29,389 --> 00:04:34,860
so<font color="#CCCCCC"> yet</font><font color="#E5E5E5"> our suede empire are very related</font>

100
00:04:33,270 --> 00:04:37,859
<font color="#E5E5E5">so this is actually an artifact of</font>

101
00:04:34,860 --> 00:04:40,139
<font color="#CCCCCC">Metasploit so those of</font><font color="#E5E5E5"> you guys that</font>

102
00:04:37,860 --> 00:04:42,599
<font color="#E5E5E5">don't know if</font><font color="#CCCCCC"> Metasploit is</font><font color="#E5E5E5"> medical</font><font color="#CCCCCC"> aid</font>

103
00:04:40,139 --> 00:04:44,240
<font color="#E5E5E5">is just a freely available exploitation</font>

104
00:04:42,599 --> 00:04:47,639
framework

105
00:04:44,240 --> 00:04:49,949
it's used by pen testers<font color="#E5E5E5"> but we also see</font>

106
00:04:47,639 --> 00:04:51,479
it<font color="#E5E5E5"> used by a number of different</font><font color="#CCCCCC"> threat</font>

107
00:04:49,949 --> 00:04:54,659
actors including financial base threat

108
00:04:51,479 --> 00:04:56,699
actors and<font color="#E5E5E5"> even some apt threat actors</font>

109
00:04:54,659 --> 00:04:59,759
so some of<font color="#E5E5E5"> the things</font><font color="#CCCCCC"> that kind of stand</font>

110
00:04:56,699 --> 00:05:01,379
out<font color="#E5E5E5"> about this</font><font color="#CCCCCC"> so it's a service</font>

111
00:04:59,759 --> 00:05:04,860
<font color="#CCCCCC">installation and the service</font>

112
00:05:01,379 --> 00:05:07,680
installation<font color="#CCCCCC"> is a 16 character really</font>

113
00:05:04,860 --> 00:05:11,370
random<font color="#E5E5E5"> name now maybe you</font><font color="#CCCCCC"> named your</font>

114
00:05:07,680 --> 00:05:13,289
services<font color="#CCCCCC"> super long 16 character random</font>

115
00:05:11,370 --> 00:05:15,300
names<font color="#E5E5E5"> but I don't and I don't think most</font>

116
00:05:13,289 --> 00:05:17,219
programmers<font color="#CCCCCC"> I'll name their services</font>

117
00:05:15,300 --> 00:05:18,810
<font color="#CCCCCC">that either</font><font color="#E5E5E5"> some of the other things</font>

118
00:05:17,219 --> 00:05:21,650
like<font color="#E5E5E5"> comm spec which is just an</font>

119
00:05:18,810 --> 00:05:24,240
environment variable for cmd.exe

120
00:05:21,650 --> 00:05:27,330
<font color="#CCCCCC">PowerShell being executed and then a</font>

121
00:05:24,240 --> 00:05:29,159
base64 string<font color="#E5E5E5"> honestly whenever you see</font>

122
00:05:27,330 --> 00:05:31,589
PowerShell being executed

123
00:05:29,159 --> 00:05:33,750
with a<font color="#E5E5E5"> basic 4 encoded string it's</font>

124
00:05:31,589 --> 00:05:35,879
<font color="#CCCCCC">always</font><font color="#E5E5E5"> something kind of interesting</font><font color="#CCCCCC"> and</font>

125
00:05:33,750 --> 00:05:38,539
<font color="#E5E5E5">something that</font><font color="#CCCCCC"> should be looked</font><font color="#E5E5E5"> at so</font>

126
00:05:35,879 --> 00:05:42,629
basically what this<font color="#CCCCCC"> resultant</font><font color="#E5E5E5"> is a</font>

127
00:05:38,539 --> 00:05:44,639
memory resident backdoor<font color="#E5E5E5"> so if anybody</font>

128
00:05:42,629 --> 00:05:46,259
<font color="#E5E5E5">is familiar with mature</font><font color="#CCCCCC"> printer this</font><font color="#E5E5E5"> is</font>

129
00:05:44,639 --> 00:05:51,779
what this<font color="#E5E5E5"> looks</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> this will result in</font>

130
00:05:46,259 --> 00:05:54,659
mature procession so we understand<font color="#CCCCCC"> that</font>

131
00:05:51,779 --> 00:05:56,069
this came from<font color="#CCCCCC"> Metasploit so we can use</font>

132
00:05:54,659 --> 00:05:58,529
what we<font color="#CCCCCC"> know about medically and the</font>

133
00:05:56,069 --> 00:06:00,149
<font color="#CCCCCC">artifacts that</font><font color="#E5E5E5"> it creates to do some</font>

134
00:05:58,529 --> 00:06:02,430
intelligent flood scoping it will also

135
00:06:00,149 --> 00:06:04,159
scope this<font color="#E5E5E5"> environment very quickly so</font>

136
00:06:02,430 --> 00:06:07,439
some of the things that<font color="#CCCCCC"> we look at are</font>

137
00:06:04,159 --> 00:06:10,529
these really<font color="#E5E5E5"> random</font><font color="#CCCCCC"> workstation names so</font>

138
00:06:07,439 --> 00:06:13,710
<font color="#CCCCCC">Metasploit actually implements their own</font>

139
00:06:10,529 --> 00:06:17,039
version of SMB the protocol<font color="#E5E5E5"> to connect</font>

140
00:06:13,710 --> 00:06:18,960
to other systems in environment<font color="#CCCCCC"> and so</font>

141
00:06:17,039 --> 00:06:21,438
when they do<font color="#E5E5E5"> that it is</font><font color="#CCCCCC"> cool</font><font color="#E5E5E5"> random</font>

142
00:06:18,960 --> 00:06:24,029
workstation names and these<font color="#E5E5E5"> works they</font>

143
00:06:21,439 --> 00:06:25,589
throw that field in without actually

144
00:06:24,029 --> 00:06:28,169
just pulling<font color="#CCCCCC"> into</font><font color="#E5E5E5"> legitimate</font><font color="#CCCCCC"> workstation</font>

145
00:06:25,589 --> 00:06:30,689
<font color="#E5E5E5">so we can do as investigators they</font>

146
00:06:28,169 --> 00:06:33,568
<font color="#E5E5E5">search security event logs for these</font>

147
00:06:30,689 --> 00:06:36,599
<font color="#CCCCCC">network logons involving</font><font color="#E5E5E5"> 16 character</font>

148
00:06:33,569 --> 00:06:37,949
workstation names so that's one way<font color="#CCCCCC"> we</font>

149
00:06:36,599 --> 00:06:40,709
<font color="#E5E5E5">can track lateral movement in</font>

150
00:06:37,949 --> 00:06:41,159
environment we also<font color="#E5E5E5"> search for service</font>

151
00:06:40,709 --> 00:06:45,089
and<font color="#E5E5E5"> slate</font>

152
00:06:41,159 --> 00:06:47,389
so these<font color="#E5E5E5"> 70 45 event log messages that</font>

153
00:06:45,089 --> 00:06:49,949
contain<font color="#CCCCCC"> comm spec</font><font color="#E5E5E5"> basically for encoding</font>

154
00:06:47,389 --> 00:06:55,199
<font color="#CCCCCC">PowerShell very much the type of</font><font color="#E5E5E5"> stuff</font>

155
00:06:49,949 --> 00:06:58,229
<font color="#CCCCCC">that you just saw the previous</font><font color="#E5E5E5"> slide so</font>

156
00:06:55,199 --> 00:07:01,439
72 long hours<font color="#CCCCCC"> anybody want to take</font><font color="#E5E5E5"> a</font>

157
00:06:58,229 --> 00:07:02,699
guess as to<font color="#E5E5E5"> what 72 hours that was if</font>

158
00:07:01,439 --> 00:07:05,339
you're thinking the weekend you probably

159
00:07:02,699 --> 00:07:08,029
<font color="#E5E5E5">work</font><font color="#CCCCCC"> an instant</font><font color="#E5E5E5"> response</font><font color="#CCCCCC"> because that's</font>

160
00:07:05,339 --> 00:07:11,580
exactly what<font color="#E5E5E5"> it</font><font color="#CCCCCC"> was so it's the weekend</font>

161
00:07:08,029 --> 00:07:13,979
<font color="#CCCCCC">we have to work it</font><font color="#E5E5E5"> and we are able to</font>

162
00:07:11,580 --> 00:07:16,679
quickly scope this environment<font color="#E5E5E5"> we</font>

163
00:07:13,979 --> 00:07:18,508
identified 129 systems that were

164
00:07:16,679 --> 00:07:20,339
compromised by the attacker<font color="#E5E5E5"> with</font>

165
00:07:18,509 --> 00:07:21,839
evidence such as<font color="#CCCCCC"> the stuff that we just</font>

166
00:07:20,339 --> 00:07:24,959
talked about the<font color="#CCCCCC"> server's installations</font>

167
00:07:21,839 --> 00:07:26,969
lateral movement activity 116

168
00:07:24,959 --> 00:07:28,559
compromised accounts just kind of

169
00:07:26,969 --> 00:07:31,800
cycling<font color="#E5E5E5"> through different credentials</font>

170
00:07:28,559 --> 00:07:35,069
<font color="#CCCCCC">single works and</font><font color="#E5E5E5"> also the initial attack</font>

171
00:07:31,800 --> 00:07:38,999
vector was able to<font color="#E5E5E5"> be identified</font><font color="#CCCCCC"> this</font>

172
00:07:35,069 --> 00:07:41,729
<font color="#E5E5E5">turned out to be a very simple poorly</font>

173
00:07:38,999 --> 00:07:43,499
configured<font color="#E5E5E5"> public web server in areas</font>

174
00:07:41,729 --> 00:07:45,748
the<font color="#CCCCCC"> client's environment they just</font>

175
00:07:43,499 --> 00:07:47,849
weren't paying attention<font color="#E5E5E5"> to so this was</font>

176
00:07:45,749 --> 00:07:49,949
a sequel<font color="#CCCCCC"> ejection that could have</font><font color="#E5E5E5"> been</font>

177
00:07:47,849 --> 00:07:51,659
easily avoided<font color="#E5E5E5"> but it just weren't</font>

178
00:07:49,949 --> 00:07:57,779
<font color="#E5E5E5">really aware</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the system and how</font><font color="#CCCCCC"> it</font>

179
00:07:51,659 --> 00:07:59,699
was<font color="#CCCCCC"> configured so now that</font><font color="#E5E5E5"> we have that</font>

180
00:07:57,779 --> 00:08:03,539
side of the investigation done<font color="#E5E5E5"> we can</font>

181
00:07:59,699 --> 00:08:07,409
talk about the<font color="#E5E5E5"> c2 server so in my</font><font color="#CCCCCC"> mine</font>

182
00:08:03,539 --> 00:08:10,019
<font color="#E5E5E5">when we we do investigations</font><font color="#CCCCCC"> we have a</font>

183
00:08:07,409 --> 00:08:12,779
<font color="#E5E5E5">two-sided perspective so the</font><font color="#CCCCCC"> perspective</font>

184
00:08:10,019 --> 00:08:14,639
from<font color="#E5E5E5"> the instant response investigation</font>

185
00:08:12,779 --> 00:08:16,679
or the<font color="#CCCCCC"> offender's the</font><font color="#E5E5E5"> enterprise</font>

186
00:08:14,639 --> 00:08:20,149
<font color="#E5E5E5">defenders we have that perspective</font><font color="#CCCCCC"> and</font>

187
00:08:16,679 --> 00:08:23,609
<font color="#E5E5E5">that perspective is really framed by the</font>

188
00:08:20,149 --> 00:08:27,209
the artifacts<font color="#E5E5E5"> and the technology we have</font>

189
00:08:23,610 --> 00:08:28,709
available<font color="#CCCCCC"> so we can</font><font color="#E5E5E5"> never be a hundred</font>

190
00:08:27,209 --> 00:08:30,360
<font color="#CCCCCC">percent</font><font color="#E5E5E5"> sure</font><font color="#CCCCCC"> that we've identified</font><font color="#E5E5E5"> every</font>

191
00:08:28,709 --> 00:08:32,669
<font color="#E5E5E5">single system for a number of different</font>

192
00:08:30,360 --> 00:08:34,620
reasons<font color="#E5E5E5"> whether it's our technologies</font>

193
00:08:32,669 --> 00:08:36,478
and deployed everywhere<font color="#CCCCCC"> or so every it's</font>

194
00:08:34,620 --> 00:08:39,568
not every system<font color="#CCCCCC"> has the artifact that</font>

195
00:08:36,479 --> 00:08:41,009
contains you know that gold piece of

196
00:08:39,568 --> 00:08:42,838
information<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> going to solve the</font>

197
00:08:41,009 --> 00:08:44,850
investigation we can do the best we can

198
00:08:42,839 --> 00:08:46,649
<font color="#CCCCCC">with the artifacts and technology we</font>

199
00:08:44,850 --> 00:08:48,149
have available<font color="#CCCCCC"> now if you've</font><font color="#E5E5E5"> ever</font>

200
00:08:46,649 --> 00:08:50,579
thought<font color="#E5E5E5"> for this</font><font color="#CCCCCC"> investigation</font><font color="#E5E5E5"> would be</font>

201
00:08:48,149 --> 00:08:52,380
<font color="#CCCCCC">a lot easier if</font><font color="#E5E5E5"> we had</font><font color="#CCCCCC"> a c2 server I</font>

202
00:08:50,579 --> 00:08:54,779
<font color="#CCCCCC">think that all the time</font><font color="#E5E5E5"> it'd be really</font>

203
00:08:52,380 --> 00:08:56,160
nice but<font color="#CCCCCC"> it's not</font><font color="#E5E5E5"> very easy</font><font color="#CCCCCC"> to get</font><font color="#E5E5E5"> you</font>

204
00:08:54,779 --> 00:08:59,759
<font color="#E5E5E5">to server</font><font color="#CCCCCC"> right there</font><font color="#E5E5E5"> not in our</font>

205
00:08:56,160 --> 00:09:04,889
possession<font color="#CCCCCC"> so if there a way to do that</font>

206
00:08:59,759 --> 00:09:07,499
well maybe for not in America but<font color="#E5E5E5"> the</font>

207
00:09:04,889 --> 00:09:10,680
attackers perspective<font color="#E5E5E5"> is something that</font>

208
00:09:07,499 --> 00:09:14,579
is would be really nice<font color="#E5E5E5"> to</font><font color="#CCCCCC"> have and</font>

209
00:09:10,680 --> 00:09:18,479
highly sought<font color="#CCCCCC"> after</font><font color="#E5E5E5"> so let's go back</font><font color="#CCCCCC"> to</font>

210
00:09:14,579 --> 00:09:20,790
<font color="#CCCCCC">that service installation</font><font color="#E5E5E5"> so this</font>

211
00:09:18,480 --> 00:09:24,089
service installation can actually be

212
00:09:20,790 --> 00:09:27,180
used to<font color="#CCCCCC"> extract the</font><font color="#E5E5E5"> c2 server the c2</font>

213
00:09:24,089 --> 00:09:29,100
server IP address so how this works<font color="#E5E5E5"> is</font>

214
00:09:27,180 --> 00:09:31,819
you identify<font color="#E5E5E5"> that basically</font><font color="#CCCCCC"> for encoded</font>

215
00:09:29,100 --> 00:09:37,350
data and the compression<font color="#E5E5E5"> screen scheme</font>

216
00:09:31,819 --> 00:09:39,059
so this<font color="#CCCCCC"> information</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> we have the</font>

217
00:09:37,350 --> 00:09:40,949
<font color="#E5E5E5">basic</font><font color="#CCCCCC"> form</font><font color="#E5E5E5"> credit scheme and then the</font>

218
00:09:39,059 --> 00:09:43,790
<font color="#E5E5E5">compression so in this case it's gzip</font>

219
00:09:40,949 --> 00:09:46,109
and some other cases it could be a

220
00:09:43,790 --> 00:09:48,809
different<font color="#E5E5E5"> compression scheme depending</font>

221
00:09:46,110 --> 00:09:51,079
on whatever the platform is<font color="#E5E5E5"> being used</font>

222
00:09:48,809 --> 00:09:52,769
coal strike uses a slightly different

223
00:09:51,079 --> 00:09:55,529
implementation of<font color="#E5E5E5"> this but it basically</font>

224
00:09:52,769 --> 00:09:58,860
<font color="#E5E5E5">results from the same sort of memory</font>

225
00:09:55,529 --> 00:10:02,480
resident<font color="#E5E5E5"> backdoor so once you do that</font>

226
00:09:58,860 --> 00:10:06,089
you get<font color="#E5E5E5"> a second basically an encoded</font>

227
00:10:02,480 --> 00:10:08,160
layer<font color="#E5E5E5"> to script right and this script</font>

228
00:10:06,089 --> 00:10:11,519
<font color="#E5E5E5">has a number of different</font><font color="#CCCCCC"> functions</font><font color="#E5E5E5"> it's</font>

229
00:10:08,160 --> 00:10:13,170
got some more<font color="#E5E5E5"> basically</font><font color="#CCCCCC"> four included</font>

230
00:10:11,519 --> 00:10:15,300
<font color="#E5E5E5">data so it need to be more basically</font>

231
00:10:13,170 --> 00:10:18,540
<font color="#E5E5E5">four encoded data why not just keep</font>

232
00:10:15,300 --> 00:10:23,000
decoding so we<font color="#E5E5E5"> decode this second layer</font>

233
00:10:18,540 --> 00:10:25,500
function<font color="#E5E5E5"> in this result and shell code</font>

234
00:10:23,000 --> 00:10:28,019
<font color="#E5E5E5">and I won't pretend</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be a shell code</font>

235
00:10:25,500 --> 00:10:29,550
expert but the way this works is

236
00:10:28,019 --> 00:10:31,769
basically adjusting this<font color="#E5E5E5"> assemble the</font>

237
00:10:29,550 --> 00:10:34,258
shell<font color="#E5E5E5"> code identify the appropriate</font>

238
00:10:31,769 --> 00:10:36,839
<font color="#CCCCCC">Network calls I want to identify</font><font color="#E5E5E5"> that</font>

239
00:10:34,259 --> 00:10:39,000
you can basically<font color="#E5E5E5"> reverse these are</font>

240
00:10:36,839 --> 00:10:40,860
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to be stored in a little endian</font>

241
00:10:39,000 --> 00:10:43,290
format so<font color="#E5E5E5"> you reverse the byte order and</font>

242
00:10:40,860 --> 00:10:45,990
you're able<font color="#CCCCCC"> to in convert</font><font color="#E5E5E5"> that to</font><font color="#CCCCCC"> ascii</font>

243
00:10:43,290 --> 00:10:50,269
and then you'll have the IP address<font color="#CCCCCC"> that</font>

244
00:10:45,990 --> 00:10:53,879
is configured<font color="#CCCCCC"> for this this</font><font color="#E5E5E5"> backdoor so</font>

245
00:10:50,269 --> 00:10:57,179
at this point we've identified the IP

246
00:10:53,879 --> 00:10:59,579
address that the<font color="#E5E5E5"> attacker is</font>

247
00:10:57,179 --> 00:11:02,519
communicating with we know the<font color="#E5E5E5"> IP</font>

248
00:10:59,579 --> 00:11:06,059
address of<font color="#E5E5E5"> their c2 sir so as part of a</font>

249
00:11:02,519 --> 00:11:08,579
a very routine<font color="#E5E5E5"> status update we provide</font>

250
00:11:06,059 --> 00:11:12,509
this decoded IP address

251
00:11:08,579 --> 00:11:14,670
to our client now this is a pretty

252
00:11:12,509 --> 00:11:16,649
<font color="#CCCCCC">normal thing we we</font><font color="#E5E5E5"> always like to be</font>

253
00:11:14,670 --> 00:11:18,118
<font color="#E5E5E5">very transparent</font><font color="#CCCCCC"> with our clients</font><font color="#E5E5E5"> and</font>

254
00:11:16,649 --> 00:11:20,189
give them as much information<font color="#E5E5E5"> as we're</font>

255
00:11:18,119 --> 00:11:21,839
<font color="#E5E5E5">finding as we're finding it as we</font>

256
00:11:20,189 --> 00:11:23,670
understand it<font color="#E5E5E5"> we provide that</font>

257
00:11:21,839 --> 00:11:26,100
information<font color="#E5E5E5"> to them so</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> can do</font>

258
00:11:23,670 --> 00:11:28,439
whatever<font color="#E5E5E5"> they want whether it's make a</font>

259
00:11:26,100 --> 00:11:30,540
business decision<font color="#E5E5E5"> or whether</font><font color="#CCCCCC"> they want</font>

260
00:11:28,439 --> 00:11:33,389
to<font color="#E5E5E5"> block right away</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> risk playing</font>

261
00:11:30,540 --> 00:11:35,189
<font color="#E5E5E5">like a whack-a-mole type game or whether</font>

262
00:11:33,389 --> 00:11:38,309
they just<font color="#E5E5E5"> want to use</font><font color="#CCCCCC"> it so they can do</font>

263
00:11:35,189 --> 00:11:42,360
<font color="#E5E5E5">their own monitoring as well so we</font>

264
00:11:38,309 --> 00:11:44,759
provided<font color="#E5E5E5"> the IP address and what we</font>

265
00:11:42,360 --> 00:11:49,110
discovered<font color="#E5E5E5"> is that the client actually</font>

266
00:11:44,759 --> 00:11:51,119
<font color="#E5E5E5">recognized the owner of the IP this is</font>

267
00:11:49,110 --> 00:11:53,279
going to be a bit<font color="#CCCCCC"> of a</font><font color="#E5E5E5"> wild ride here so</font>

268
00:11:51,119 --> 00:11:57,269
the client<font color="#E5E5E5"> actually just did a simple</font>

269
00:11:53,279 --> 00:12:00,329
who is on this<font color="#E5E5E5"> IP address identified</font>

270
00:11:57,269 --> 00:12:03,029
<font color="#E5E5E5">that this was a small-time competitor so</font>

271
00:12:00,329 --> 00:12:05,488
they actually had a<font color="#CCCCCC"> relationship with</font>

272
00:12:03,029 --> 00:12:09,269
<font color="#E5E5E5">the owner of this IP address</font><font color="#CCCCCC"> and it had</font>

273
00:12:05,489 --> 00:12:13,949
actually<font color="#CCCCCC"> just ended it</font><font color="#E5E5E5"> the week</font><font color="#CCCCCC"> before</font>

274
00:12:09,269 --> 00:12:15,499
this attack<font color="#E5E5E5"> began so let's all put</font><font color="#CCCCCC"> our</font>

275
00:12:13,949 --> 00:12:19,349
<font color="#E5E5E5">tinfoil hats on</font><font color="#CCCCCC"> and see where</font><font color="#E5E5E5"> this goes</font>

276
00:12:15,499 --> 00:12:20,309
<font color="#E5E5E5">so they had to they</font><font color="#CCCCCC"> had just basically</font>

277
00:12:19,350 --> 00:12:22,049
described this<font color="#CCCCCC"> as a</font><font color="#E5E5E5"> small-time</font>

278
00:12:20,309 --> 00:12:26,519
competitor they<font color="#E5E5E5"> recognized this IP</font>

279
00:12:22,049 --> 00:12:30,509
<font color="#CCCCCC">address so what</font><font color="#E5E5E5"> would you do well how</font>

280
00:12:26,519 --> 00:12:33,119
<font color="#E5E5E5">about you just ask just ask this third</font>

281
00:12:30,509 --> 00:12:36,360
party for their c2 server so the client

282
00:12:33,119 --> 00:12:38,879
<font color="#E5E5E5">called them up and said hey you have a</font>

283
00:12:36,360 --> 00:12:40,769
server that<font color="#CCCCCC"> is</font><font color="#E5E5E5"> interacting in a</font>

284
00:12:38,879 --> 00:12:42,569
malicious way<font color="#E5E5E5"> with our</font><font color="#CCCCCC"> environment we're</font>

285
00:12:40,769 --> 00:12:44,910
going to need<font color="#E5E5E5"> to just take</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> please</font>

286
00:12:42,569 --> 00:12:50,248
give us that server I'm not sure they

287
00:12:44,910 --> 00:12:52,110
said please to<font color="#E5E5E5"> be honest they well they</font>

288
00:12:50,249 --> 00:12:54,329
did<font color="#E5E5E5"> they just gave</font><font color="#CCCCCC"> it to it they gave</font>

289
00:12:52,110 --> 00:12:57,329
them<font color="#CCCCCC"> the entire server which is really</font>

290
00:12:54,329 --> 00:12:59,248
<font color="#E5E5E5">really strange and weird and if any of</font>

291
00:12:57,329 --> 00:13:01,019
you guys interact<font color="#E5E5E5"> with lawyers lawyers</font>

292
00:12:59,249 --> 00:13:05,459
<font color="#CCCCCC">probably</font><font color="#E5E5E5"> get really</font><font color="#CCCCCC"> screaming about this</font>

293
00:13:01,019 --> 00:13:07,499
<font color="#E5E5E5">I know our lawyers did like is there any</font>

294
00:13:05,459 --> 00:13:10,290
legal<font color="#E5E5E5"> ramifications to doing something</font>

295
00:13:07,499 --> 00:13:12,480
<font color="#CCCCCC">like this well if you</font><font color="#E5E5E5"> just freely give</font>

296
00:13:10,290 --> 00:13:16,889
things away it<font color="#E5E5E5"> turns out no not really</font>

297
00:13:12,480 --> 00:13:19,559
so during the next status update the

298
00:13:16,889 --> 00:13:22,400
<font color="#E5E5E5">client basically contacted us and said</font>

299
00:13:19,559 --> 00:13:25,370
<font color="#E5E5E5">hey proceeded to address you gave us</font>

300
00:13:22,400 --> 00:13:27,949
well we have the server now so I'm not

301
00:13:25,370 --> 00:13:30,590
<font color="#CCCCCC">the drunk</font><font color="#E5E5E5"> Mike but that would</font><font color="#CCCCCC"> be you</font>

302
00:13:27,950 --> 00:13:32,240
know<font color="#CCCCCC"> how their conversation which was</font>

303
00:13:30,590 --> 00:13:36,020
<font color="#E5E5E5">pretty</font><font color="#CCCCCC"> interesting so we're like okay</font>

304
00:13:32,240 --> 00:13:38,840
<font color="#CCCCCC">okay what</font><font color="#E5E5E5"> would we do here</font><font color="#CCCCCC"> so they said</font>

305
00:13:36,020 --> 00:13:41,270
well how would<font color="#E5E5E5"> you like</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> just image it</font>

306
00:13:38,840 --> 00:13:44,060
and do analysis on<font color="#E5E5E5"> it of course we're</font>

307
00:13:41,270 --> 00:13:48,530
all going<font color="#E5E5E5"> to be fighting to do that so</font>

308
00:13:44,060 --> 00:13:53,270
yes we did<font color="#CCCCCC"> we went</font><font color="#E5E5E5"> over and imaged the</font>

309
00:13:48,530 --> 00:13:55,370
system which is<font color="#CCCCCC"> pretty awesome and these</font>

310
00:13:53,270 --> 00:13:57,350
are real pictures<font color="#E5E5E5"> by the way of the c2</font>

311
00:13:55,370 --> 00:14:00,620
<font color="#E5E5E5">servers that are our analysts actually</font>

312
00:13:57,350 --> 00:14:03,890
took while imaging it<font color="#CCCCCC"> we were going to</font>

313
00:14:00,620 --> 00:14:05,810
document<font color="#CCCCCC"> the hell out of this so this</font><font color="#E5E5E5"> is</font>

314
00:14:03,890 --> 00:14:07,850
<font color="#E5E5E5">real pictures they just boot it they</font>

315
00:14:05,810 --> 00:14:11,150
just<font color="#E5E5E5"> you know this is an entire rack</font>

316
00:14:07,850 --> 00:14:13,790
mountable server that<font color="#E5E5E5"> was provided by</font>

317
00:14:11,150 --> 00:14:15,770
this third party to<font color="#CCCCCC"> our client so what</font>

318
00:14:13,790 --> 00:14:19,069
we did<font color="#E5E5E5"> is</font><font color="#CCCCCC"> just basically plug in a</font>

319
00:14:15,770 --> 00:14:23,750
keyboard a mouse<font color="#E5E5E5"> a monitor and conduct a</font>

320
00:14:19,070 --> 00:14:26,000
live forensic image of the server cool

321
00:14:23,750 --> 00:14:27,680
<font color="#E5E5E5">so now we have a 3-2 server we have an</font>

322
00:14:26,000 --> 00:14:29,030
image<font color="#E5E5E5"> of it let's put</font><font color="#CCCCCC"> this into our</font>

323
00:14:27,680 --> 00:14:31,160
forensic lab and start performing

324
00:14:29,030 --> 00:14:32,900
<font color="#CCCCCC">analysis</font><font color="#E5E5E5"> because this is really crazy</font>

325
00:14:31,160 --> 00:14:36,560
weird and we don't get<font color="#E5E5E5"> to do this very</font>

326
00:14:32,900 --> 00:14:38,360
often<font color="#CCCCCC"> so one of</font><font color="#E5E5E5"> the forensic analysis</font><font color="#CCCCCC"> of</font>

327
00:14:36,560 --> 00:14:41,449
this<font color="#CCCCCC"> looked</font><font color="#E5E5E5"> like well</font><font color="#CCCCCC"> this server was a</font>

328
00:14:38,360 --> 00:14:43,190
Windows Server 2008<font color="#E5E5E5"> what we identified</font>

329
00:14:41,450 --> 00:14:46,940
is that<font color="#E5E5E5"> the attacker had created their</font>

330
00:14:43,190 --> 00:14:48,770
own<font color="#CCCCCC"> account on</font><font color="#E5E5E5"> the system they had done</font>

331
00:14:46,940 --> 00:14:51,260
some<font color="#E5E5E5"> privilege escalation and a</font>

332
00:14:48,770 --> 00:14:53,930
credential harvesting techniques<font color="#CCCCCC"> so</font>

333
00:14:51,260 --> 00:14:58,400
<font color="#E5E5E5">basically a executed me me cats and got</font>

334
00:14:53,930 --> 00:15:00,620
creds<font color="#E5E5E5"> awesome it gets even better these</font>

335
00:14:58,400 --> 00:15:02,270
<font color="#E5E5E5">are some ballsy attackers so what they</font>

336
00:15:00,620 --> 00:15:04,490
did<font color="#E5E5E5"> is</font><font color="#CCCCCC"> they downloaded VMware</font>

337
00:15:02,270 --> 00:15:06,439
Workstation<font color="#CCCCCC"> on the server which is a</font>

338
00:15:04,490 --> 00:15:08,540
pretty<font color="#E5E5E5"> big program and then they</font>

339
00:15:06,440 --> 00:15:11,150
downloaded a Kali Linux ISO which is

340
00:15:08,540 --> 00:15:14,360
<font color="#CCCCCC">also</font><font color="#E5E5E5"> pretty big by</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> way so nobody is</font>

341
00:15:11,150 --> 00:15:18,829
looking<font color="#E5E5E5"> at that</font><font color="#CCCCCC"> network apparently</font><font color="#E5E5E5"> they</font>

342
00:15:14,360 --> 00:15:21,610
then installed a Kali VM<font color="#CCCCCC"> in July of 2016</font>

343
00:15:18,830 --> 00:15:26,630
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is keep in mind two months before</font>

344
00:15:21,610 --> 00:15:28,100
the attack<font color="#E5E5E5"> on</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> client began so this</font>

345
00:15:26,630 --> 00:15:29,840
is obviously<font color="#CCCCCC"> where the</font><font color="#E5E5E5"> really</font>

346
00:15:28,100 --> 00:15:32,270
interesting things are going to be we

347
00:15:29,840 --> 00:15:35,760
need to<font color="#CCCCCC"> go deeper</font><font color="#E5E5E5"> this is a little bit</font>

348
00:15:32,270 --> 00:15:36,930
of an investigation<font color="#CCCCCC"> inception</font>

349
00:15:35,760 --> 00:15:39,649
and we're also switching gears we're

350
00:15:36,930 --> 00:15:42,689
going from<font color="#CCCCCC"> Windows forensic</font><font color="#E5E5E5"> analysis to</font>

351
00:15:39,649 --> 00:15:44,250
Linux forensic analysis<font color="#E5E5E5"> so this is going</font>

352
00:15:42,690 --> 00:15:48,600
<font color="#E5E5E5">to be the</font><font color="#CCCCCC"> interesting stuff so we export</font>

353
00:15:44,250 --> 00:15:51,089
that VM<font color="#E5E5E5"> and begin the analysis</font><font color="#CCCCCC"> again so</font>

354
00:15:48,600 --> 00:15:52,579
switching gears<font color="#CCCCCC"> Linux forensics</font><font color="#E5E5E5"> let's</font>

355
00:15:51,089 --> 00:15:54,480
<font color="#E5E5E5">look at some of the interesting</font>

356
00:15:52,579 --> 00:15:57,839
artifacts that we have available<font color="#CCCCCC"> to us</font>

357
00:15:54,480 --> 00:16:00,089
<font color="#CCCCCC">so we</font><font color="#E5E5E5"> have some valuable secure logs</font>

358
00:15:57,839 --> 00:16:03,630
that basically showed that the attacker

359
00:16:00,089 --> 00:16:06,120
<font color="#E5E5E5">was connecting from a row reputa low</font>

360
00:16:03,630 --> 00:16:10,350
reputation<font color="#E5E5E5"> IP address something from</font>

361
00:16:06,120 --> 00:16:11,910
<font color="#CCCCCC">digitalocean we also</font><font color="#E5E5E5"> identified that it</font>

362
00:16:10,350 --> 00:16:15,240
was<font color="#CCCCCC"> being scanned</font><font color="#E5E5E5"> like crazy because</font>

363
00:16:11,910 --> 00:16:18,180
it's a<font color="#CCCCCC"> public-facing Cali server so okay</font>

364
00:16:15,240 --> 00:16:19,910
<font color="#E5E5E5">that was kind of fun</font><font color="#CCCCCC"> we also identified</font>

365
00:16:18,180 --> 00:16:23,310
<font color="#E5E5E5">a mature per configuration file</font>

366
00:16:19,910 --> 00:16:27,000
<font color="#E5E5E5">basically just the configuration file</font>

367
00:16:23,310 --> 00:16:30,569
for<font color="#CCCCCC"> there of the</font><font color="#E5E5E5"> TTP listener for when</font>

368
00:16:27,000 --> 00:16:33,360
<font color="#CCCCCC">they'd</font><font color="#E5E5E5"> the fact or made a connection</font>

369
00:16:30,570 --> 00:16:36,300
<font color="#E5E5E5">back to the c2 server</font><font color="#CCCCCC"> we identified</font><font color="#E5E5E5"> some</font>

370
00:16:33,360 --> 00:16:38,519
access<font color="#E5E5E5"> to some of the</font><font color="#CCCCCC"> up tools</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> are</font>

371
00:16:36,300 --> 00:16:41,219
already installed<font color="#E5E5E5"> on</font><font color="#CCCCCC"> Callie by default</font>

372
00:16:38,519 --> 00:16:45,060
so the<font color="#E5E5E5"> sequel map which like we said</font>

373
00:16:41,220 --> 00:16:47,250
<font color="#CCCCCC">before</font><font color="#E5E5E5"> they had used a sequel injection</font>

374
00:16:45,060 --> 00:16:49,229
technique to gain access to the

375
00:16:47,250 --> 00:16:52,769
environment in the first place so sequel

376
00:16:49,230 --> 00:16:54,389
map might have helped<font color="#CCCCCC"> identify that</font><font color="#E5E5E5"> we</font>

377
00:16:52,769 --> 00:16:56,550
<font color="#E5E5E5">always perform keyword searches when we</font>

378
00:16:54,389 --> 00:17:01,019
have a forensic<font color="#CCCCCC"> image</font><font color="#E5E5E5"> so some</font><font color="#CCCCCC"> of these</font>

379
00:16:56,550 --> 00:17:02,550
were<font color="#E5E5E5"> really revealing first</font><font color="#CCCCCC"> we ran</font>

380
00:17:01,019 --> 00:17:04,530
searches for some of the accounts that

381
00:17:02,550 --> 00:17:06,599
<font color="#E5E5E5">we saw the attacker used some</font><font color="#CCCCCC"> VIP</font>

382
00:17:04,530 --> 00:17:09,030
<font color="#E5E5E5">address some of the systems and</font>

383
00:17:06,599 --> 00:17:11,069
<font color="#E5E5E5">basically allowed us</font><font color="#CCCCCC"> to verify</font><font color="#E5E5E5"> that yes</font>

384
00:17:09,030 --> 00:17:12,959
this was certainly<font color="#E5E5E5"> the</font><font color="#CCCCCC"> system that</font><font color="#E5E5E5"> they</font>

385
00:17:11,069 --> 00:17:16,500
were using<font color="#E5E5E5"> we're seeing our clients data</font>

386
00:17:12,959 --> 00:17:18,780
on this system<font color="#CCCCCC"> this is pretty bad</font><font color="#E5E5E5"> news</font>

387
00:17:16,500 --> 00:17:21,869
<font color="#CCCCCC">so some of the stuff that was</font><font color="#E5E5E5"> really</font>

388
00:17:18,780 --> 00:17:25,109
<font color="#E5E5E5">exciting</font><font color="#CCCCCC"> actually was located</font><font color="#E5E5E5"> in not</font>

389
00:17:21,869 --> 00:17:27,809
<font color="#E5E5E5">only an allocated space but also in</font>

390
00:17:25,109 --> 00:17:31,260
Postgres<font color="#E5E5E5"> basically in Postgres files</font>

391
00:17:27,809 --> 00:17:34,620
so these<font color="#CCCCCC"> postgrads hits</font><font color="#E5E5E5"> kind of led</font><font color="#CCCCCC"> me</font>

392
00:17:31,260 --> 00:17:37,890
to<font color="#CCCCCC"> look at the Postgres history so this</font>

393
00:17:34,620 --> 00:17:39,209
tells us a bit<font color="#E5E5E5"> of a story so Postgres</font>

394
00:17:37,890 --> 00:17:42,030
history basically<font color="#E5E5E5"> showed us that they</font>

395
00:17:39,210 --> 00:17:44,159
had<font color="#CCCCCC"> created a database several</font>

396
00:17:42,030 --> 00:17:48,120
iterations of database actually<font color="#E5E5E5"> they had</font>

397
00:17:44,159 --> 00:17:49,830
connected using a couple usernames and

398
00:17:48,120 --> 00:17:53,008
passwords

399
00:17:49,830 --> 00:17:54,960
the thing is is that<font color="#E5E5E5"> Postgres is pretty</font>

400
00:17:53,009 --> 00:18:00,059
messy<font color="#E5E5E5"> it's not something</font><font color="#CCCCCC"> that you can</font>

401
00:17:54,960 --> 00:18:02,970
just just export a file and load it up

402
00:18:00,059 --> 00:18:04,740
<font color="#CCCCCC">into you know</font><font color="#E5E5E5"> Postgres</font><font color="#CCCCCC"> GXE and</font>

403
00:18:02,970 --> 00:18:06,509
<font color="#E5E5E5">everything's perfect just read it like a</font>

404
00:18:04,740 --> 00:18:09,419
<font color="#CCCCCC">sequel</font><font color="#E5E5E5"> like database it's actually a</font>

405
00:18:06,509 --> 00:18:12,000
collection<font color="#E5E5E5"> of files</font><font color="#CCCCCC"> they're all just</font>

406
00:18:09,419 --> 00:18:13,529
flat binary files or you know<font color="#E5E5E5"> depending</font>

407
00:18:12,000 --> 00:18:14,940
<font color="#CCCCCC">on</font><font color="#E5E5E5"> the size of the database</font><font color="#CCCCCC"> there could</font>

408
00:18:13,529 --> 00:18:17,850
be hundreds<font color="#E5E5E5"> of them</font>

409
00:18:14,940 --> 00:18:20,389
<font color="#E5E5E5">so</font><font color="#CCCCCC"> each</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> of these files kind</font><font color="#E5E5E5"> of</font>

410
00:18:17,850 --> 00:18:23,850
represents a table in the Postgres

411
00:18:20,389 --> 00:18:25,529
database itself<font color="#E5E5E5"> so wasn't</font><font color="#CCCCCC"> very easy</font><font color="#E5E5E5"> to</font>

412
00:18:23,850 --> 00:18:30,570
look at<font color="#E5E5E5"> it wasn't a publicly available</font>

413
00:18:25,529 --> 00:18:32,490
parser<font color="#CCCCCC"> but knowing that one</font><font color="#E5E5E5"> of the</font>

414
00:18:30,570 --> 00:18:35,100
things that you can do with<font color="#CCCCCC"> Metasploit</font>

415
00:18:32,490 --> 00:18:37,769
is<font color="#E5E5E5"> backup your information or save all</font>

416
00:18:35,100 --> 00:18:40,080
<font color="#E5E5E5">your information to a Postgres DB</font>

417
00:18:37,769 --> 00:18:42,720
<font color="#E5E5E5">something that you can do and that's</font>

418
00:18:40,080 --> 00:18:44,639
actually<font color="#E5E5E5"> kind of encouraged by</font>

419
00:18:42,720 --> 00:18:46,830
<font color="#CCCCCC">Metasploit by the</font><font color="#E5E5E5"> mostly developers as</font>

420
00:18:44,639 --> 00:18:48,418
well<font color="#E5E5E5"> attackers are - are people -</font>

421
00:18:46,830 --> 00:18:50,129
they're<font color="#E5E5E5"> probably not going to</font><font color="#CCCCCC"> remember</font>

422
00:18:48,419 --> 00:18:52,289
every<font color="#CCCCCC"> single credential they've sold</font><font color="#E5E5E5"> and</font>

423
00:18:50,129 --> 00:18:58,469
you'd have a way<font color="#CCCCCC"> to track all this</font>

424
00:18:52,289 --> 00:19:01,250
information<font color="#E5E5E5"> so and so it wasn't an easy</font>

425
00:18:58,470 --> 00:19:06,570
<font color="#E5E5E5">way to just</font><font color="#CCCCCC"> kind of</font><font color="#E5E5E5"> export the database</font>

426
00:19:01,250 --> 00:19:09,720
<font color="#E5E5E5">why not just boot up the</font><font color="#CCCCCC"> VM itself so I</font>

427
00:19:06,570 --> 00:19:12,029
just said<font color="#E5E5E5"> well I have VMware Workstation</font>

428
00:19:09,720 --> 00:19:14,610
to work well<font color="#E5E5E5"> for the attacker</font><font color="#CCCCCC"> I can do</font>

429
00:19:12,029 --> 00:19:16,860
that<font color="#E5E5E5"> so it turns out but as I glued this</font>

430
00:19:14,610 --> 00:19:19,469
thing up it was<font color="#CCCCCC"> password protected</font><font color="#E5E5E5"> also</font>

431
00:19:16,860 --> 00:19:21,529
not a big deal with Kali workstation so

432
00:19:19,470 --> 00:19:25,799
boot this thing up into<font color="#E5E5E5"> single user mode</font>

433
00:19:21,529 --> 00:19:29,490
<font color="#CCCCCC">and then basically</font><font color="#E5E5E5"> configure the grub</font>

434
00:19:25,799 --> 00:19:32,370
interface to execute a bash shell<font color="#E5E5E5"> so as</font>

435
00:19:29,490 --> 00:19:33,659
soon<font color="#E5E5E5"> as</font><font color="#CCCCCC"> a booted up it booted it loaded</font>

436
00:19:32,370 --> 00:19:35,668
a bash shell<font color="#E5E5E5"> and I can change the</font>

437
00:19:33,659 --> 00:19:40,139
<font color="#CCCCCC">password so I just changed the</font><font color="#E5E5E5"> users</font>

438
00:19:35,669 --> 00:19:45,149
password<font color="#CCCCCC"> and</font><font color="#E5E5E5"> now I had</font><font color="#CCCCCC"> access</font><font color="#E5E5E5"> to the</font>

439
00:19:40,139 --> 00:19:46,379
attacker system so I felt<font color="#E5E5E5"> really cool at</font>

440
00:19:45,149 --> 00:19:48,479
this point because<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> know about</font>

441
00:19:46,379 --> 00:19:51,080
<font color="#E5E5E5">you guys who do instant response I spend</font>

442
00:19:48,480 --> 00:19:54,269
way too much time<font color="#E5E5E5"> in Microsoft Excel</font>

443
00:19:51,080 --> 00:19:56,399
<font color="#CCCCCC">doing filters and tagging things red so</font>

444
00:19:54,269 --> 00:19:58,379
this was<font color="#E5E5E5"> really exciting</font><font color="#CCCCCC"> I felt like I</font>

445
00:19:56,399 --> 00:20:00,629
had just<font color="#E5E5E5"> like executed got system</font>

446
00:19:58,379 --> 00:20:03,120
impersonate attacker on<font color="#E5E5E5"> this entire</font>

447
00:20:00,629 --> 00:20:04,889
thing<font color="#CCCCCC"> so</font><font color="#E5E5E5"> this is really fun</font>

448
00:20:03,120 --> 00:20:07,409
really<font color="#E5E5E5"> cool</font><font color="#CCCCCC"> and nice change of pace</font><font color="#E5E5E5"> on</font>

449
00:20:04,890 --> 00:20:12,900
how you know how instant response

450
00:20:07,410 --> 00:20:15,630
typically runs<font color="#E5E5E5"> so you know</font><font color="#CCCCCC"> Metasploit is</font>

451
00:20:12,900 --> 00:20:18,540
used to attack things<font color="#E5E5E5"> I bet you</font><font color="#CCCCCC"> didn't</font>

452
00:20:15,630 --> 00:20:22,950
know<font color="#E5E5E5"> you could also use a</font><font color="#CCCCCC"> fur and it</font>

453
00:20:18,540 --> 00:20:24,990
<font color="#E5E5E5">responds</font><font color="#CCCCCC"> so in this case</font><font color="#E5E5E5"> basically I</font>

454
00:20:22,950 --> 00:20:27,360
could you<font color="#CCCCCC"> I could leverage the</font><font color="#E5E5E5"> Postgres</font>

455
00:20:24,990 --> 00:20:29,580
<font color="#CCCCCC">equal history to obtain critical</font>

456
00:20:27,360 --> 00:20:32,459
<font color="#CCCCCC">database information</font><font color="#E5E5E5"> so what does that</font>

457
00:20:29,580 --> 00:20:35,939
mean<font color="#E5E5E5"> well I know that they created a</font>

458
00:20:32,460 --> 00:20:40,050
user<font color="#CCCCCC"> MSF or they created a database</font><font color="#E5E5E5"> also</font>

459
00:20:35,940 --> 00:20:43,380
called MSF<font color="#E5E5E5"> also these things</font><font color="#CCCCCC"> contain the</font>

460
00:20:40,050 --> 00:20:45,928
user<font color="#CCCCCC"> empath</font><font color="#E5E5E5"> username password so MSF MSF</font>

461
00:20:43,380 --> 00:20:50,100
not a crazy password here<font color="#E5E5E5"> so actually</font>

462
00:20:45,929 --> 00:20:52,620
<font color="#CCCCCC">just use</font><font color="#E5E5E5"> the MSF console or a med</font>

463
00:20:50,100 --> 00:20:55,230
exploit console to connect to the

464
00:20:52,620 --> 00:20:56,580
database directly so I can are not

465
00:20:55,230 --> 00:20:58,770
connect<font color="#E5E5E5"> to the database directly but to</font>

466
00:20:56,580 --> 00:21:02,689
<font color="#E5E5E5">actually interact with the</font><font color="#CCCCCC"> post source</font>

467
00:20:58,770 --> 00:21:06,629
database lots of<font color="#CCCCCC"> really cool things so</font>

468
00:21:02,690 --> 00:21:09,690
what I could<font color="#E5E5E5"> do using Metasploit is</font>

469
00:21:06,630 --> 00:21:12,720
execute commands like creds<font color="#CCCCCC"> ho lubed</font>

470
00:21:09,690 --> 00:21:15,780
<font color="#E5E5E5">notes loop being particular interesting</font>

471
00:21:12,720 --> 00:21:18,330
<font color="#CCCCCC">as a kind of a sexy name but it also</font>

472
00:21:15,780 --> 00:21:20,250
shows us<font color="#CCCCCC"> the kind of post post</font>

473
00:21:18,330 --> 00:21:23,730
exploitation modules the attacker had

474
00:21:20,250 --> 00:21:24,780
executed<font color="#E5E5E5"> notes and services basically</font>

475
00:21:23,730 --> 00:21:27,330
just<font color="#E5E5E5"> showing us kind of the</font>

476
00:21:24,780 --> 00:21:30,330
reconnaissance<font color="#E5E5E5"> that the attacker has</font>

477
00:21:27,330 --> 00:21:31,949
done across<font color="#CCCCCC"> the environment</font><font color="#E5E5E5"> bones</font>

478
00:21:30,330 --> 00:21:34,139
<font color="#E5E5E5">whether they've identified any</font>

479
00:21:31,950 --> 00:21:35,790
vulnerabilities and systems and then

480
00:21:34,140 --> 00:21:37,260
whether or<font color="#CCCCCC"> not</font><font color="#E5E5E5"> they actually</font><font color="#CCCCCC"> exploited</font>

481
00:21:35,790 --> 00:21:39,360
those<font color="#E5E5E5"> vulnerabilities or status on it</font>

482
00:21:37,260 --> 00:21:43,230
<font color="#E5E5E5">this is really cool this</font><font color="#CCCCCC"> is a lot</font><font color="#E5E5E5"> of</font>

483
00:21:39,360 --> 00:21:45,990
really good information<font color="#CCCCCC"> but it</font><font color="#E5E5E5"> wasn't</font>

484
00:21:43,230 --> 00:21:49,770
perfect<font color="#E5E5E5"> not everything had timestamps</font>

485
00:21:45,990 --> 00:21:53,070
and for an instant responder timestamps

486
00:21:49,770 --> 00:21:55,559
are kind of everything<font color="#CCCCCC"> timestamps framed</font>

487
00:21:53,070 --> 00:21:59,280
the information that we<font color="#CCCCCC"> are gathering</font>

488
00:21:55,559 --> 00:22:01,678
<font color="#E5E5E5">and the artifacts that we found</font><font color="#CCCCCC"> into a</font>

489
00:21:59,280 --> 00:22:04,020
perspective<font color="#E5E5E5"> that we can basically show</font>

490
00:22:01,679 --> 00:22:06,020
<font color="#E5E5E5">the client and they can understand what</font>

491
00:22:04,020 --> 00:22:08,820
has happened<font color="#E5E5E5"> without those timestamps</font>

492
00:22:06,020 --> 00:22:12,060
<font color="#E5E5E5">the value of the</font><font color="#CCCCCC"> artefact</font><font color="#E5E5E5"> is this</font>

493
00:22:08,820 --> 00:22:15,149
lessened really it's good for obtaining

494
00:22:12,060 --> 00:22:16,980
<font color="#E5E5E5">indicators but less valuable for framing</font>

495
00:22:15,150 --> 00:22:20,549
<font color="#E5E5E5">where they occurred and be</font>

496
00:22:16,980 --> 00:22:22,770
<font color="#CCCCCC">HAC so I wanted more detail so I figured</font>

497
00:22:20,549 --> 00:22:24,870
<font color="#E5E5E5">okay well I use</font><font color="#CCCCCC"> Metasploit to interact</font>

498
00:22:22,770 --> 00:22:28,379
with<font color="#CCCCCC"> the database</font><font color="#E5E5E5"> why not just interact</font>

499
00:22:24,870 --> 00:22:30,090
with<font color="#CCCCCC"> the database directly</font><font color="#E5E5E5"> so using</font><font color="#CCCCCC"> T</font>

500
00:22:28,380 --> 00:22:33,360
sequel<font color="#CCCCCC"> I just connected</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> the database</font>

501
00:22:30,090 --> 00:22:35,909
<font color="#E5E5E5">directly this is awesome</font>

502
00:22:33,360 --> 00:22:39,389
so lots and lots of tables<font color="#CCCCCC"> as</font><font color="#E5E5E5"> you can</font>

503
00:22:35,910 --> 00:22:41,880
see some<font color="#CCCCCC"> of the cool things that I</font>

504
00:22:39,390 --> 00:22:43,500
really<font color="#E5E5E5"> like is like the Metasploit</font>

505
00:22:41,880 --> 00:22:45,720
credential<font color="#E5E5E5"> public so you can see a</font>

506
00:22:43,500 --> 00:22:47,940
<font color="#E5E5E5">couple of things like it's got created</font>

507
00:22:45,720 --> 00:22:50,760
<font color="#CCCCCC">timestamps it's got updated timestamps</font>

508
00:22:47,940 --> 00:22:53,160
it's got the actual user names these<font color="#CCCCCC"> are</font>

509
00:22:50,760 --> 00:22:55,470
like these<font color="#CCCCCC"> are the actual tables from</font>

510
00:22:53,160 --> 00:22:57,799
<font color="#E5E5E5">the</font><font color="#CCCCCC"> c2 server itself</font><font color="#E5E5E5"> so I can see the</font>

511
00:22:55,470 --> 00:23:00,870
different<font color="#E5E5E5"> accounts</font><font color="#CCCCCC"> that the attacker had</font>

512
00:22:57,799 --> 00:23:03,570
had actually identified and harvest

513
00:23:00,870 --> 00:23:05,639
credentials for this<font color="#E5E5E5"> is just a couple of</font>

514
00:23:03,570 --> 00:23:08,189
them<font color="#E5E5E5"> so credential realms so this is</font>

515
00:23:05,640 --> 00:23:11,370
<font color="#E5E5E5">going to be the domains</font><font color="#CCCCCC"> that the</font>

516
00:23:08,190 --> 00:23:14,010
attacker has enumerated<font color="#E5E5E5"> also</font><font color="#CCCCCC"> timestamps</font>

517
00:23:11,370 --> 00:23:15,870
everywhere sessions is going to be a

518
00:23:14,010 --> 00:23:18,540
little bit hard to see<font color="#CCCCCC"> but sessions</font>

519
00:23:15,870 --> 00:23:22,260
being<font color="#E5E5E5"> the most cool thing</font><font color="#CCCCCC"> you could</font>

520
00:23:18,540 --> 00:23:25,379
possibly<font color="#CCCCCC"> see in a</font><font color="#E5E5E5"> Postgres database that</font>

521
00:23:22,260 --> 00:23:27,929
is for<font color="#CCCCCC"> Metasploit and the reason it's so</font>

522
00:23:25,380 --> 00:23:32,240
cool<font color="#E5E5E5"> is because these like</font><font color="#CCCCCC"> big</font><font color="#E5E5E5"> old</font>

523
00:23:27,929 --> 00:23:35,220
basics before blobs<font color="#E5E5E5"> actually decode to</font>

524
00:23:32,240 --> 00:23:39,510
session<font color="#CCCCCC"> information</font><font color="#E5E5E5"> so this</font><font color="#CCCCCC"> is going</font><font color="#E5E5E5"> to</font>

525
00:23:35,220 --> 00:23:42,620
show us how how the attacker<font color="#E5E5E5"> actually</font>

526
00:23:39,510 --> 00:23:48,320
configured their payloads<font color="#E5E5E5"> so it shows us</font>

527
00:23:42,620 --> 00:23:51,090
<font color="#CCCCCC">username</font><font color="#E5E5E5"> password different the the</font>

528
00:23:48,320 --> 00:23:53,939
<font color="#CCCCCC">network that</font><font color="#E5E5E5"> they enumerated what they</font>

529
00:23:51,090 --> 00:23:57,209
were scanning<font color="#E5E5E5"> a lot of highly highly</font>

530
00:23:53,940 --> 00:24:00,600
detailed information the Postgres

531
00:23:57,210 --> 00:24:03,780
database stores entire meterpreter

532
00:24:00,600 --> 00:24:06,360
sessions and the configuration<font color="#CCCCCC"> that the</font>

533
00:24:03,780 --> 00:24:10,710
<font color="#E5E5E5">attacker used including every command</font>

534
00:24:06,360 --> 00:24:12,899
<font color="#CCCCCC">they executed within mature</font><font color="#E5E5E5"> pa'dar so if</font>

535
00:24:10,710 --> 00:24:15,450
they uploaded<font color="#E5E5E5"> a file</font><font color="#CCCCCC"> it's there they</font>

536
00:24:12,900 --> 00:24:17,130
downloaded a file it's there<font color="#E5E5E5"> if they</font>

537
00:24:15,450 --> 00:24:19,710
<font color="#E5E5E5">dropped into a shell and executed</font>

538
00:24:17,130 --> 00:24:22,640
commands<font color="#E5E5E5"> using a command shell it's</font>

539
00:24:19,710 --> 00:24:25,350
there and what<font color="#CCCCCC"> else is</font><font color="#E5E5E5"> there is output</font>

540
00:24:22,640 --> 00:24:28,110
<font color="#E5E5E5">so they execute net use you'll see the</font>

541
00:24:25,350 --> 00:24:30,389
output<font color="#E5E5E5"> the shell output stored in this</font>

542
00:24:28,110 --> 00:24:32,580
Postgres database entire

543
00:24:30,390 --> 00:24:34,740
<font color="#CCCCCC">recessions</font><font color="#E5E5E5"> there is nothing left to the</font>

544
00:24:32,580 --> 00:24:37,439
<font color="#CCCCCC">imagination as to</font><font color="#E5E5E5"> what the attacker did</font>

545
00:24:34,740 --> 00:24:39,450
in our environment<font color="#E5E5E5"> our</font><font color="#CCCCCC"> needs</font><font color="#E5E5E5"> clients</font>

546
00:24:37,440 --> 00:24:41,940
environment<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is really</font><font color="#E5E5E5"> really</font>

547
00:24:39,450 --> 00:24:43,950
powerful<font color="#E5E5E5"> great information and really</font>

548
00:24:41,940 --> 00:24:46,130
<font color="#E5E5E5">just paints a pretty</font><font color="#CCCCCC"> amazing picture</font>

549
00:24:43,950 --> 00:24:49,110
about what's happening<font color="#CCCCCC"> here</font>

550
00:24:46,130 --> 00:24:51,720
so at this point<font color="#E5E5E5"> case is solved right</font>

551
00:24:49,110 --> 00:24:53,850
the timeline<font color="#CCCCCC"> right itself I mean we have</font>

552
00:24:51,720 --> 00:24:55,880
the<font color="#CCCCCC"> perspective from</font><font color="#E5E5E5"> the incident</font>

553
00:24:53,850 --> 00:24:58,230
response<font color="#E5E5E5"> investigation that we can</font>

554
00:24:55,880 --> 00:25:00,270
compare<font color="#E5E5E5"> with the perspective</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we get</font>

555
00:24:58,230 --> 00:25:03,120
<font color="#E5E5E5">from the attackers situ investigation</font>

556
00:25:00,270 --> 00:25:05,520
it's all there<font color="#E5E5E5"> and it all overlaps and</font>

557
00:25:03,120 --> 00:25:08,479
it just meshes together<font color="#E5E5E5"> perfectly every</font>

558
00:25:05,520 --> 00:25:13,020
blank<font color="#E5E5E5"> was filled in from the attackers</font>

559
00:25:08,480 --> 00:25:15,750
from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> c2 investigation itself</font><font color="#E5E5E5"> so this</font>

560
00:25:13,020 --> 00:25:17,340
<font color="#CCCCCC">is awesome client loved it this</font><font color="#E5E5E5"> makes</font>

561
00:25:15,750 --> 00:25:20,180
for you know happy<font color="#E5E5E5"> client happy</font>

562
00:25:17,340 --> 00:25:27,990
consultant everybody's happy this<font color="#CCCCCC"> is a</font>

563
00:25:20,180 --> 00:25:30,840
big win for<font color="#E5E5E5"> us really so post got post</font>

564
00:25:27,990 --> 00:25:33,330
<font color="#CCCCCC">crack is a tool that I developed based</font>

565
00:25:30,840 --> 00:25:35,250
on this investigation<font color="#CCCCCC"> so some of</font><font color="#E5E5E5"> the</font>

566
00:25:33,330 --> 00:25:38,699
inspiration was identifying<font color="#E5E5E5"> additional</font>

567
00:25:35,250 --> 00:25:42,120
<font color="#E5E5E5">victims</font><font color="#CCCCCC"> so like I said the attacker had</font>

568
00:25:38,700 --> 00:25:45,390
access to<font color="#E5E5E5"> the system since the c2 server</font>

569
00:25:42,120 --> 00:25:48,000
itself since 2016 so July<font color="#E5E5E5"> of 2016</font><font color="#CCCCCC"> two</font>

570
00:25:45,390 --> 00:25:50,970
months<font color="#E5E5E5"> before we</font><font color="#CCCCCC"> even were contacted by</font>

571
00:25:48,000 --> 00:25:53,850
<font color="#CCCCCC">our client in the Postgres history</font>

572
00:25:50,970 --> 00:25:56,580
contained evidence<font color="#E5E5E5"> of prior deleted</font>

573
00:25:53,850 --> 00:25:58,889
databases so I wondered if there<font color="#CCCCCC"> was any</font>

574
00:25:56,580 --> 00:26:00,659
way to recover those databases<font color="#E5E5E5"> what kind</font>

575
00:25:58,890 --> 00:26:03,090
of information kind<font color="#E5E5E5"> of led me to even</font>

576
00:26:00,660 --> 00:26:06,150
believe<font color="#E5E5E5"> but there was something to</font>

577
00:26:03,090 --> 00:26:09,149
recover<font color="#E5E5E5"> so besides the Postgres history</font>

578
00:26:06,150 --> 00:26:11,760
itself<font color="#CCCCCC"> this could be verified</font><font color="#E5E5E5"> via</font>

579
00:26:09,150 --> 00:26:13,860
keyword searches<font color="#E5E5E5"> so in the same way</font><font color="#CCCCCC"> that</font>

580
00:26:11,760 --> 00:26:15,960
we<font color="#CCCCCC"> read keyword searches for our client</font>

581
00:26:13,860 --> 00:26:17,669
<font color="#E5E5E5">and client information</font><font color="#CCCCCC"> those keyword</font>

582
00:26:15,960 --> 00:26:19,770
searches you could also just search for

583
00:26:17,670 --> 00:26:22,350
<font color="#E5E5E5">some generic commands that the attacker</font>

584
00:26:19,770 --> 00:26:25,260
<font color="#E5E5E5">were</font><font color="#CCCCCC"> executing so if they were executing</font>

585
00:26:22,350 --> 00:26:28,199
net use a lot like a keyword search for

586
00:26:25,260 --> 00:26:30,840
every net<font color="#CCCCCC"> use and see in an allocated</font>

587
00:26:28,200 --> 00:26:34,260
space that there were hits that contain

588
00:26:30,840 --> 00:26:36,629
<font color="#E5E5E5">domain passwords that weren't</font><font color="#CCCCCC"> identified</font>

589
00:26:34,260 --> 00:26:38,420
in the resident ProQuest database so

590
00:26:36,630 --> 00:26:41,810
knew that there is additional

591
00:26:38,420 --> 00:26:44,070
<font color="#CCCCCC">information about</font><font color="#E5E5E5"> other victims on the</font>

592
00:26:41,810 --> 00:26:47,940
<font color="#CCCCCC">c2 server they had</font>

593
00:26:44,070 --> 00:26:49,620
<font color="#E5E5E5">just to it for at</font><font color="#CCCCCC"> least three months but</font>

594
00:26:47,940 --> 00:26:53,130
we only saw evidence of attack for<font color="#E5E5E5"> our</font>

595
00:26:49,620 --> 00:26:54,330
<font color="#CCCCCC">client</font><font color="#E5E5E5"> so I wondered if anybody had</font>

596
00:26:53,130 --> 00:26:57,030
tried<font color="#CCCCCC"> to do this</font><font color="#E5E5E5"> before</font>

597
00:26:54,330 --> 00:26:59,429
there wasn't anything obvious<font color="#E5E5E5"> there was</font>

598
00:26:57,030 --> 00:27:04,070
<font color="#CCCCCC">a tool</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> wasn't publicly publicly</font>

599
00:26:59,430 --> 00:27:06,210
<font color="#E5E5E5">available</font><font color="#CCCCCC"> that was capable of recovering</font>

600
00:27:04,070 --> 00:27:08,490
<font color="#E5E5E5">different artifacts and different</font>

601
00:27:06,210 --> 00:27:10,770
database management systems but the

602
00:27:08,490 --> 00:27:13,230
focus wasn't<font color="#CCCCCC"> Postgres</font><font color="#E5E5E5"> so I needed</font>

603
00:27:10,770 --> 00:27:15,210
<font color="#CCCCCC">something that was going to specifically</font>

604
00:27:13,230 --> 00:27:16,100
cater to the needs of<font color="#E5E5E5"> Postgres and what</font>

605
00:27:15,210 --> 00:27:21,150
I had in mind

606
00:27:16,100 --> 00:27:23,040
so I'm not a programming<font color="#E5E5E5"> genius</font><font color="#CCCCCC"> I don't</font>

607
00:27:21,150 --> 00:27:25,230
do a whole<font color="#CCCCCC"> lot of development developing</font>

608
00:27:23,040 --> 00:27:26,730
<font color="#E5E5E5">but when I have a chance I do like to</font>

609
00:27:25,230 --> 00:27:30,630
<font color="#CCCCCC">kind of like dabble in it a little bit</font>

610
00:27:26,730 --> 00:27:32,130
<font color="#E5E5E5">so a</font><font color="#CCCCCC"> Postgres sequel</font><font color="#E5E5E5"> is a open source</font>

611
00:27:30,630 --> 00:27:34,740
which is really nice<font color="#E5E5E5"> but it's all</font>

612
00:27:32,130 --> 00:27:37,050
written<font color="#CCCCCC"> see I don't have a strong</font>

613
00:27:34,740 --> 00:27:39,030
<font color="#CCCCCC">background</font><font color="#E5E5E5"> see so I didn't you know</font>

614
00:27:37,050 --> 00:27:40,440
<font color="#E5E5E5">immediately know how to read all this</font>

615
00:27:39,030 --> 00:27:43,440
information so<font color="#CCCCCC"> it was</font><font color="#E5E5E5"> kind of a fun</font>

616
00:27:40,440 --> 00:27:46,110
<font color="#E5E5E5">exercise</font><font color="#CCCCCC"> in in research</font><font color="#E5E5E5"> about a Postgres</font>

617
00:27:43,440 --> 00:27:50,370
work but also on the development<font color="#CCCCCC"> work</font>

618
00:27:46,110 --> 00:27:53,219
cycle<font color="#E5E5E5"> and how to even read you know code</font>

619
00:27:50,370 --> 00:27:54,659
from another language<font color="#E5E5E5"> luckily these guys</font>

620
00:27:53,220 --> 00:27:56,520
have a strong<font color="#CCCCCC"> development team behind</font>

621
00:27:54,660 --> 00:27:59,280
<font color="#E5E5E5">them and a lot of their code is</font>

622
00:27:56,520 --> 00:28:02,280
<font color="#E5E5E5">documented pretty well but still reading</font>

623
00:27:59,280 --> 00:28:04,590
<font color="#E5E5E5">see structures was a fun a fun ride to</font>

624
00:28:02,280 --> 00:28:07,710
say the least<font color="#CCCCCC"> so I created the tool</font>

625
00:28:04,590 --> 00:28:10,800
called<font color="#CCCCCC"> post rock to carve</font><font color="#E5E5E5"> all Postgres</font>

626
00:28:07,710 --> 00:28:13,320
equal rows<font color="#E5E5E5"> from</font><font color="#CCCCCC"> a flat binary file so</font>

627
00:28:10,800 --> 00:28:14,669
this<font color="#E5E5E5"> is something</font><font color="#CCCCCC"> like a raw image</font><font color="#E5E5E5"> so it</font>

628
00:28:13,320 --> 00:28:17,820
doesn't have to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> the raw image it</font>

629
00:28:14,670 --> 00:28:21,110
could be just the specific files located

630
00:28:17,820 --> 00:28:23,669
in the Postgres installation directory

631
00:28:21,110 --> 00:28:29,040
or it could be an entire forensic image

632
00:28:23,670 --> 00:28:31,350
that's collected so<font color="#E5E5E5"> I'm going to take a</font>

633
00:28:29,040 --> 00:28:34,950
little<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> of a deep dive</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> Postgres</font>

634
00:28:31,350 --> 00:28:36,629
and what that whole you know just what

635
00:28:34,950 --> 00:28:38,910
that<font color="#CCCCCC"> whole structure</font><font color="#E5E5E5"> really even looks</font>

636
00:28:36,630 --> 00:28:42,950
<font color="#E5E5E5">like</font><font color="#CCCCCC"> so</font>

637
00:28:38,910 --> 00:28:47,040
<font color="#E5E5E5">hopefully this doesn't get overly boring</font>

638
00:28:42,950 --> 00:28:49,100
<font color="#CCCCCC">so the anatomy of a Postgres database</font><font color="#E5E5E5"> so</font>

639
00:28:47,040 --> 00:28:52,530
a<font color="#E5E5E5"> couple of the terms and definitions to</font>

640
00:28:49,100 --> 00:28:55,080
understand so tables so<font color="#E5E5E5"> these are going</font>

641
00:28:52,530 --> 00:28:57,600
<font color="#E5E5E5">to be the actual physical files located</font>

642
00:28:55,080 --> 00:28:59,939
<font color="#E5E5E5">in the post guys installation directory</font>

643
00:28:57,600 --> 00:29:02,039
so each one should<font color="#E5E5E5"> be considered a table</font>

644
00:28:59,940 --> 00:29:05,730
now these tables<font color="#E5E5E5"> are going to be made up</font>

645
00:29:02,039 --> 00:29:08,520
of pages and so a table can have you

646
00:29:05,730 --> 00:29:10,470
<font color="#CCCCCC">know fifty to sixty or one or two tables</font>

647
00:29:08,520 --> 00:29:16,440
it really just depends<font color="#E5E5E5"> on the size of</font>

648
00:29:10,470 --> 00:29:18,600
the table<font color="#E5E5E5"> itself the within each page is</font>

649
00:29:16,440 --> 00:29:21,090
going to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> a real pointer free space</font>

650
00:29:18,600 --> 00:29:24,928
and a row entry<font color="#E5E5E5"> that contains the</font><font color="#CCCCCC"> row</font>

651
00:29:21,090 --> 00:29:27,559
data<font color="#E5E5E5"> itself so this is kind of a</font>

652
00:29:24,929 --> 00:29:30,090
visualization<font color="#CCCCCC"> of what this looks</font><font color="#E5E5E5"> like</font>

653
00:29:27,559 --> 00:29:32,730
<font color="#CCCCCC">you know the red being the</font><font color="#E5E5E5"> table header</font>

654
00:29:30,090 --> 00:29:34,230
itself<font color="#E5E5E5"> the blue being the row pointers</font>

655
00:29:32,730 --> 00:29:36,419
that<font color="#E5E5E5"> are going to tell us where our</font><font color="#CCCCCC"> road</font>

656
00:29:34,230 --> 00:29:39,000
data is located<font color="#CCCCCC"> and then the</font><font color="#E5E5E5"> yellow</font>

657
00:29:36,419 --> 00:29:41,880
stuff is null space which we'll talk a

658
00:29:39,000 --> 00:29:43,950
<font color="#E5E5E5">little bit about and then purple being</font>

659
00:29:41,880 --> 00:29:46,100
the road data itself so you can<font color="#CCCCCC"> kind of</font>

660
00:29:43,950 --> 00:29:48,539
see at the<font color="#E5E5E5"> bottom it's got some</font>

661
00:29:46,100 --> 00:29:50,580
<font color="#CCCCCC">information like</font><font color="#E5E5E5"> command</font><font color="#CCCCCC"> well</font><font color="#E5E5E5"> that's a</font>

662
00:29:48,539 --> 00:29:55,440
command that<font color="#E5E5E5"> was executed through the</font>

663
00:29:50,580 --> 00:29:57,629
trip<font color="#CCCCCC"> retur so the page header itself</font><font color="#E5E5E5"> so</font>

664
00:29:55,440 --> 00:30:00,809
the page header itself<font color="#E5E5E5"> is a 24 bytes</font>

665
00:29:57,630 --> 00:30:03,900
structure it's got some version info

666
00:30:00,809 --> 00:30:06,960
located in it<font color="#E5E5E5"> from this header what we</font>

667
00:30:03,900 --> 00:30:09,600
can gain is information about<font color="#E5E5E5"> the number</font>

668
00:30:06,960 --> 00:30:13,610
<font color="#CCCCCC">of rows we're going to find in this page</font>

669
00:30:09,600 --> 00:30:16,439
head in this<font color="#E5E5E5"> Postgres page itself</font><font color="#CCCCCC"> so</font>

670
00:30:13,610 --> 00:30:18,209
this is<font color="#E5E5E5"> helpful</font><font color="#CCCCCC"> for understanding how</font>

671
00:30:16,440 --> 00:30:20,030
many rows to expect in a page and how

672
00:30:18,210 --> 00:30:22,679
many rows we're going to need<font color="#E5E5E5"> to parse</font>

673
00:30:20,030 --> 00:30:25,260
<font color="#E5E5E5">this is part of also</font><font color="#CCCCCC"> what my tool does</font>

674
00:30:22,679 --> 00:30:28,039
is is<font color="#E5E5E5"> actually look for these types of</font>

675
00:30:25,260 --> 00:30:30,780
headers it's not an obvious header like

676
00:30:28,039 --> 00:30:33,870
<font color="#E5E5E5">NZ header that's going to give you</font><font color="#CCCCCC"> you</font>

677
00:30:30,780 --> 00:30:35,399
know<font color="#CCCCCC"> obviously this is a PE file so what</font>

678
00:30:33,870 --> 00:30:38,010
I had<font color="#E5E5E5"> to do</font><font color="#CCCCCC"> with this is kind of look</font>

679
00:30:35,400 --> 00:30:40,260
for this<font color="#CCCCCC"> this header</font><font color="#E5E5E5"> that looks like</font>

680
00:30:38,010 --> 00:30:42,809
this<font color="#E5E5E5"> using</font><font color="#CCCCCC"> some certain entropy checks</font>

681
00:30:40,260 --> 00:30:45,929
about you know what<font color="#E5E5E5"> what can't happen</font><font color="#CCCCCC"> in</font>

682
00:30:42,809 --> 00:30:48,408
this sequence<font color="#E5E5E5"> of bytes</font><font color="#CCCCCC"> and so far it's</font>

683
00:30:45,929 --> 00:30:53,370
been really<font color="#CCCCCC"> successful</font><font color="#E5E5E5"> with identifying</font>

684
00:30:48,409 --> 00:30:55,830
the start of a<font color="#E5E5E5"> Postgres page so the row</font>

685
00:30:53,370 --> 00:30:59,039
pointers itself<font color="#E5E5E5"> therefore by structures</font>

686
00:30:55,830 --> 00:31:02,520
very important for<font color="#E5E5E5"> Tongass a couple of</font>

687
00:30:59,039 --> 00:31:05,908
<font color="#E5E5E5">things where the data is located the</font>

688
00:31:02,520 --> 00:31:08,070
offset within the page itself<font color="#E5E5E5"> as well</font>

689
00:31:05,909 --> 00:31:10,200
<font color="#E5E5E5">the size of the row so the size of</font><font color="#CCCCCC"> the</font>

690
00:31:08,070 --> 00:31:10,530
<font color="#CCCCCC">rows and obediently</font><font color="#E5E5E5"> the entire row from</font>

691
00:31:10,200 --> 00:31:12,960
the

692
00:31:10,530 --> 00:31:17,540
a header<font color="#E5E5E5"> all the way to the end of it</font>

693
00:31:12,960 --> 00:31:21,060
itself<font color="#E5E5E5"> the end of the row</font><font color="#CCCCCC"> the road data</font>

694
00:31:17,540 --> 00:31:23,850
the free space<font color="#CCCCCC"> so free space is going</font><font color="#E5E5E5"> to</font>

695
00:31:21,060 --> 00:31:26,010
<font color="#CCCCCC">be</font><font color="#E5E5E5"> the section that follows those row</font>

696
00:31:23,850 --> 00:31:27,919
pointer<font color="#CCCCCC"> those</font><font color="#E5E5E5"> row pointers and what</font>

697
00:31:26,010 --> 00:31:32,730
<font color="#E5E5E5">basically can happen is that</font><font color="#CCCCCC"> as</font>

698
00:31:27,920 --> 00:31:34,860
additional<font color="#CCCCCC"> data is added to the page so</font>

699
00:31:32,730 --> 00:31:37,620
the row pointers will be added<font color="#CCCCCC"> from the</font>

700
00:31:34,860 --> 00:31:41,310
top and then<font color="#CCCCCC"> row data we added</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> the</font>

701
00:31:37,620 --> 00:31:44,489
bottom so in a<font color="#E5E5E5"> Postgres page that has a</font>

702
00:31:41,310 --> 00:31:46,230
lot<font color="#CCCCCC"> of rows in it</font><font color="#E5E5E5"> there may not be any</font>

703
00:31:44,490 --> 00:31:48,930
free space<font color="#CCCCCC"> so that's</font><font color="#E5E5E5"> something that also</font>

704
00:31:46,230 --> 00:31:52,830
had to be<font color="#E5E5E5"> account accounted for in this</font>

705
00:31:48,930 --> 00:31:55,500
tool post<font color="#CCCCCC"> crock so the row entry the row</font>

706
00:31:52,830 --> 00:31:58,080
entry is split between<font color="#E5E5E5"> two things so you</font>

707
00:31:55,500 --> 00:32:00,750
<font color="#E5E5E5">have a 24 by</font><font color="#CCCCCC"> Tedder that contains</font>

708
00:31:58,080 --> 00:32:02,699
information<font color="#CCCCCC"> about the row and</font><font color="#E5E5E5"> then it</font>

709
00:32:00,750 --> 00:32:04,310
also has<font color="#E5E5E5"> the road data itself this is</font>

710
00:32:02,700 --> 00:32:07,200
<font color="#E5E5E5">the type</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> data that you would see</font>

711
00:32:04,310 --> 00:32:10,500
displayed if you<font color="#CCCCCC"> ran</font><font color="#E5E5E5"> something like a</font>

712
00:32:07,200 --> 00:32:12,240
select star from table name that would

713
00:32:10,500 --> 00:32:15,170
be the data<font color="#E5E5E5"> this will be where this is</font>

714
00:32:12,240 --> 00:32:17,640
being pulled from so the row header<font color="#CCCCCC"> a</font>

715
00:32:15,170 --> 00:32:19,650
couple of things that<font color="#E5E5E5"> stick out just</font>

716
00:32:17,640 --> 00:32:23,220
like the row insertion ID and the

717
00:32:19,650 --> 00:32:26,640
deletion ID so when a row is<font color="#CCCCCC"> inserted</font>

718
00:32:23,220 --> 00:32:29,280
into a<font color="#CCCCCC"> Postgres page it gets assigned</font><font color="#E5E5E5"> an</font>

719
00:32:26,640 --> 00:32:32,130
ID for<font color="#E5E5E5"> when that occurred and then a</font>

720
00:32:29,280 --> 00:32:34,440
deletion I do<font color="#E5E5E5"> if the row is deleted so</font>

721
00:32:32,130 --> 00:32:36,360
when the row is deleted<font color="#E5E5E5"> doesn't actually</font>

722
00:32:34,440 --> 00:32:38,460
mean<font color="#CCCCCC"> that it's</font><font color="#E5E5E5"> deleted from the disk</font>

723
00:32:36,360 --> 00:32:41,219
<font color="#E5E5E5">it's just deleted from</font><font color="#CCCCCC"> Postgres file it</font>

724
00:32:38,460 --> 00:32:43,170
gets an ID<font color="#E5E5E5"> you can say that well I'm</font><font color="#CCCCCC"> not</font>

725
00:32:41,220 --> 00:32:47,750
going<font color="#E5E5E5"> to display this because it was</font>

726
00:32:43,170 --> 00:32:49,770
deleted<font color="#E5E5E5"> but it can still be recovered so</font>

727
00:32:47,750 --> 00:32:52,260
you can also get the number of

728
00:32:49,770 --> 00:32:55,470
<font color="#CCCCCC">attributes</font><font color="#E5E5E5"> so think of attributes as the</font>

729
00:32:52,260 --> 00:32:57,510
things that you would see as<font color="#E5E5E5"> columns so</font>

730
00:32:55,470 --> 00:33:00,450
these would be<font color="#E5E5E5"> the column headers so</font>

731
00:32:57,510 --> 00:33:04,470
each<font color="#E5E5E5"> one of those is an</font><font color="#CCCCCC"> attribute of the</font>

732
00:33:00,450 --> 00:33:07,140
table itself the offset to<font color="#CCCCCC"> the road data</font>

733
00:33:04,470 --> 00:33:09,300
is going<font color="#E5E5E5"> to show where the data actually</font>

734
00:33:07,140 --> 00:33:13,770
<font color="#CCCCCC">starts and</font><font color="#E5E5E5"> the reason this</font><font color="#CCCCCC"> is important</font>

735
00:33:09,300 --> 00:33:19,580
<font color="#E5E5E5">is because table and</font><font color="#CCCCCC"> are rows that have</font>

736
00:33:13,770 --> 00:33:22,908
lots of attributes or column headers

737
00:33:19,580 --> 00:33:25,129
<font color="#CCCCCC">this information</font><font color="#E5E5E5"> will basically track</font>

738
00:33:22,909 --> 00:33:27,619
<font color="#E5E5E5">which one of those are in use or not in</font>

739
00:33:25,129 --> 00:33:30,559
use<font color="#CCCCCC"> so you have to be able to understand</font>

740
00:33:27,619 --> 00:33:32,418
where this<font color="#E5E5E5"> data is going</font><font color="#CCCCCC"> to start so you</font>

741
00:33:30,559 --> 00:33:36,289
<font color="#CCCCCC">can track whether or not these columns</font>

742
00:33:32,419 --> 00:33:39,169
<font color="#E5E5E5">are</font><font color="#CCCCCC"> going to have data in it or</font><font color="#E5E5E5"> not so</font>

743
00:33:36,289 --> 00:33:40,460
the road data itself is<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to be kind</font>

744
00:33:39,169 --> 00:33:41,659
<font color="#CCCCCC">of the different</font><font color="#E5E5E5"> data</font><font color="#CCCCCC"> types that</font><font color="#E5E5E5"> you</font>

745
00:33:40,460 --> 00:33:44,899
would expect to<font color="#E5E5E5"> see</font>

746
00:33:41,659 --> 00:33:47,059
so integers<font color="#E5E5E5"> dates and times variable</font>

747
00:33:44,899 --> 00:33:50,840
length strings<font color="#CCCCCC"> this is where a lot of</font>

748
00:33:47,059 --> 00:33:52,340
the<font color="#CCCCCC"> the meat of the program live this is</font>

749
00:33:50,840 --> 00:33:55,209
kind of challenging<font color="#CCCCCC"> because there's not</font>

750
00:33:52,340 --> 00:33:58,369
an<font color="#CCCCCC"> obvious way to understand where</font>

751
00:33:55,210 --> 00:34:00,349
different attributes<font color="#E5E5E5"> begin and end and</font>

752
00:33:58,369 --> 00:34:03,830
so you just<font color="#E5E5E5"> have</font><font color="#CCCCCC"> to you have</font><font color="#E5E5E5"> to</font>

753
00:34:00,349 --> 00:34:05,509
basically look<font color="#E5E5E5"> for certain signifiers</font><font color="#CCCCCC"> of</font>

754
00:34:03,830 --> 00:34:07,519
say well this is<font color="#E5E5E5"> going to be a string</font>

755
00:34:05,509 --> 00:34:09,909
data and the string data is going<font color="#E5E5E5"> to be</font>

756
00:34:07,519 --> 00:34:12,469
this length and so there's a bit<font color="#CCCCCC"> of</font>

757
00:34:09,909 --> 00:34:18,319
guesswork<font color="#CCCCCC"> saz why this</font><font color="#E5E5E5"> is a really</font><font color="#CCCCCC"> a</font>

758
00:34:12,469 --> 00:34:20,598
carving utility so post-rock<font color="#E5E5E5"> and its</font>

759
00:34:18,319 --> 00:34:23,000
capabilities<font color="#CCCCCC"> so</font><font color="#E5E5E5"> you said this is a</font>

760
00:34:20,599 --> 00:34:26,419
Python tool that is<font color="#CCCCCC"> going to thoroughly</font>

761
00:34:23,000 --> 00:34:28,369
understand<font color="#E5E5E5"> Postgres sequel like main</font>

762
00:34:26,418 --> 00:34:33,859
capabilities being<font color="#CCCCCC"> medic and it's going</font>

763
00:34:28,369 --> 00:34:37,970
to carve<font color="#E5E5E5"> rows from a flat binary file</font><font color="#CCCCCC"> so</font>

764
00:34:33,859 --> 00:34:40,668
this<font color="#E5E5E5"> would be the</font><font color="#CCCCCC"> files located</font><font color="#E5E5E5"> in the</font>

765
00:34:37,969 --> 00:34:43,459
<font color="#CCCCCC">Postgres installation directory</font><font color="#E5E5E5"> or it</font>

766
00:34:40,668 --> 00:34:46,339
can also<font color="#E5E5E5"> be a forensic image you can</font>

767
00:34:43,460 --> 00:34:50,079
also do keyword searching with it so if

768
00:34:46,339 --> 00:34:52,639
I know that<font color="#E5E5E5"> I'm specifically</font><font color="#CCCCCC"> looking for</font>

769
00:34:50,079 --> 00:34:55,179
<font color="#CCCCCC">entries relating to a certain username</font>

770
00:34:52,639 --> 00:34:58,309
or I'm looking<font color="#E5E5E5"> for entries relating to</font>

771
00:34:55,179 --> 00:35:00,380
medical a public credentials<font color="#CCCCCC"> I can</font>

772
00:34:58,309 --> 00:35:04,609
search<font color="#E5E5E5"> for that and just get only that</font>

773
00:35:00,380 --> 00:35:08,660
type of<font color="#E5E5E5"> data you can export to</font><font color="#CCCCCC"> CSV</font><font color="#E5E5E5"> or</font>

774
00:35:04,609 --> 00:35:11,569
Excel access<font color="#E5E5E5"> Excel</font><font color="#CCCCCC"> and officially just</font>

775
00:35:08,660 --> 00:35:12,529
supporting version 9.5 of<font color="#E5E5E5"> Postgres right</font>

776
00:35:11,569 --> 00:35:15,200
now

777
00:35:12,529 --> 00:35:16,849
I suspected<font color="#E5E5E5"> it actually supports more</font>

778
00:35:15,200 --> 00:35:21,140
<font color="#CCCCCC">than that I</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> can get</font><font color="#E5E5E5"> continue to do</font>

779
00:35:16,849 --> 00:35:25,309
more<font color="#E5E5E5"> testing on this tool so it is on</font>

780
00:35:21,140 --> 00:35:27,650
<font color="#E5E5E5">github</font><font color="#CCCCCC"> so here if you to have a</font><font color="#E5E5E5"> c2</font>

781
00:35:25,309 --> 00:35:29,000
server that an attacker used to back up

782
00:35:27,650 --> 00:35:30,799
their entire<font color="#E5E5E5"> thing to a post-race</font>

783
00:35:29,000 --> 00:35:34,099
database<font color="#E5E5E5"> run this tool it'll probably</font>

784
00:35:30,799 --> 00:35:36,609
<font color="#CCCCCC">give you a lot</font><font color="#E5E5E5"> of data</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> it'd be pretty</font>

785
00:35:34,099 --> 00:35:36,609
exciting

786
00:35:36,770 --> 00:35:42,569
<font color="#E5E5E5">post</font><font color="#CCCCCC"> cock</font><font color="#E5E5E5"> findings so some of the cool</font>

787
00:35:39,690 --> 00:35:44,190
<font color="#CCCCCC">things that we were able</font><font color="#E5E5E5"> to find with it</font>

788
00:35:42,569 --> 00:35:47,279
<font color="#CCCCCC">is that there was full interpreter</font>

789
00:35:44,190 --> 00:35:49,109
sessions<font color="#E5E5E5"> occurring all three months that</font>

790
00:35:47,280 --> 00:35:51,359
<font color="#E5E5E5">this attack that the attacker had access</font>

791
00:35:49,109 --> 00:35:54,060
to<font color="#E5E5E5"> the system so in</font><font color="#CCCCCC"> july august</font>

792
00:35:51,359 --> 00:35:57,509
<font color="#CCCCCC">september everything over</font><font color="#E5E5E5"> fourteen</font>

793
00:35:54,060 --> 00:36:00,750
<font color="#E5E5E5">hundred compromised credentials over</font>

794
00:35:57,510 --> 00:36:03,180
<font color="#CCCCCC">forty eight enumerated domains a lot of</font>

795
00:36:00,750 --> 00:36:06,060
activity and some of the things<font color="#CCCCCC"> that</font>

796
00:36:03,180 --> 00:36:09,149
<font color="#E5E5E5">this look like</font><font color="#CCCCCC"> basically we could do</font>

797
00:36:06,060 --> 00:36:14,670
some heuristics<font color="#CCCCCC"> on the type of data so</font>

798
00:36:09,150 --> 00:36:17,040
as I said<font color="#E5E5E5"> before this this postcard</font>

799
00:36:14,670 --> 00:36:19,079
database is going<font color="#CCCCCC"> to store all</font><font color="#E5E5E5"> the</font>

800
00:36:17,040 --> 00:36:19,950
modules<font color="#CCCCCC"> we attack or executed so I</font>

801
00:36:19,079 --> 00:36:22,740
thought it was kind of<font color="#E5E5E5"> interesting to</font>

802
00:36:19,950 --> 00:36:25,230
see<font color="#CCCCCC"> if well let's see</font><font color="#E5E5E5"> what their most</font>

803
00:36:22,740 --> 00:36:29,609
popular post exploitation modules were

804
00:36:25,230 --> 00:36:31,890
so probably unsurprisingly this

805
00:36:29,609 --> 00:36:35,779
credentials episode looking for single

806
00:36:31,890 --> 00:36:38,848
sign-on credentials<font color="#CCCCCC"> from a system as</font>

807
00:36:35,780 --> 00:36:41,369
well as<font color="#CCCCCC"> ad computer is just a</font><font color="#E5E5E5"> new</font><font color="#CCCCCC"> brunet</font>

808
00:36:38,849 --> 00:36:44,099
<font color="#CCCCCC">DS smart hash thump</font><font color="#E5E5E5"> credential collector</font>

809
00:36:41,369 --> 00:36:47,150
a number<font color="#E5E5E5"> of different post exploitation</font>

810
00:36:44,099 --> 00:36:49,290
modules that<font color="#CCCCCC"> they basically</font><font color="#E5E5E5"> were running</font>

811
00:36:47,150 --> 00:36:50,730
<font color="#E5E5E5">almost every time they would</font><font color="#CCCCCC"> be on a</font>

812
00:36:49,290 --> 00:36:51,270
system<font color="#E5E5E5"> some of the ones that</font><font color="#CCCCCC"> were less</font>

813
00:36:50,730 --> 00:36:53,790
<font color="#E5E5E5">common</font>

814
00:36:51,270 --> 00:36:58,170
our application<font color="#CCCCCC"> specific ones like</font>

815
00:36:53,790 --> 00:37:00,450
tortoise SVN<font color="#E5E5E5"> or</font><font color="#CCCCCC"> Outlook so those</font><font color="#E5E5E5"> systems</font>

816
00:36:58,170 --> 00:37:02,520
<font color="#E5E5E5">I would consider</font><font color="#CCCCCC"> investigatively maybe</font>

817
00:37:00,450 --> 00:37:04,049
even<font color="#E5E5E5"> more interesting because</font><font color="#CCCCCC"> it seemed</font>

818
00:37:02,520 --> 00:37:06,119
<font color="#CCCCCC">like they were</font><font color="#E5E5E5"> searching for</font><font color="#CCCCCC"> something</font>

819
00:37:04,050 --> 00:37:08,099
and targeting an application

820
00:37:06,119 --> 00:37:09,810
specifically maybe because it<font color="#CCCCCC"> had</font>

821
00:37:08,099 --> 00:37:14,369
something<font color="#E5E5E5"> interesting on it that they</font>

822
00:37:09,810 --> 00:37:18,210
were<font color="#CCCCCC"> looking for so some of the things</font>

823
00:37:14,369 --> 00:37:21,359
<font color="#E5E5E5">that we found based on</font><font color="#CCCCCC"> post-rock and in</font>

824
00:37:18,210 --> 00:37:24,630
the mature processions<font color="#CCCCCC"> that were</font>

825
00:37:21,359 --> 00:37:27,690
<font color="#E5E5E5">extracted is that the attacker actually</font>

826
00:37:24,630 --> 00:37:29,670
<font color="#E5E5E5">added their user account</font><font color="#CCCCCC"> to victim</font>

827
00:37:27,690 --> 00:37:31,319
systems so we talked about how they did

828
00:37:29,670 --> 00:37:32,579
it on<font color="#E5E5E5"> the c2 server well this is</font>

829
00:37:31,319 --> 00:37:36,000
<font color="#E5E5E5">actually what it looks like and this is</font>

830
00:37:32,579 --> 00:37:39,599
what<font color="#CCCCCC"> post-rock would carve out basically</font>

831
00:37:36,000 --> 00:37:42,410
they add their user<font color="#CCCCCC"> maava to and that</font>

832
00:37:39,599 --> 00:37:46,800
really really<font color="#E5E5E5"> sophisticated password</font>

833
00:37:42,410 --> 00:37:48,990
that'll never delay it's not too bad

834
00:37:46,800 --> 00:37:49,380
so then<font color="#CCCCCC"> basically there's the output to</font>

835
00:37:48,990 --> 00:37:51,270
it as

836
00:37:49,380 --> 00:37:54,480
<font color="#CCCCCC">while you can see that it was successful</font>

837
00:37:51,270 --> 00:37:59,370
they were successfully able<font color="#E5E5E5"> to add their</font>

838
00:37:54,480 --> 00:38:00,660
user<font color="#E5E5E5"> a new user</font><font color="#CCCCCC"> to a system</font><font color="#E5E5E5"> some of the</font>

839
00:37:59,370 --> 00:38:04,259
other things<font color="#E5E5E5"> they did they were</font>

840
00:38:00,660 --> 00:38:06,359
uploading web shells<font color="#E5E5E5"> a lot so a lot</font><font color="#CCCCCC"> of</font>

841
00:38:04,260 --> 00:38:08,490
victims<font color="#E5E5E5"> got web shells everybody got a</font>

842
00:38:06,360 --> 00:38:10,620
shell<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is pretty fun</font><font color="#E5E5E5"> so they</font>

843
00:38:08,490 --> 00:38:14,549
uploaded something publicly available

844
00:38:10,620 --> 00:38:17,130
this NT<font color="#CCCCCC"> Daddy PHP also other shells</font>

845
00:38:14,550 --> 00:38:20,190
called command<font color="#CCCCCC"> dot PHP then you can see</font>

846
00:38:17,130 --> 00:38:22,890
they run you know they<font color="#E5E5E5"> always run like a</font>

847
00:38:20,190 --> 00:38:27,120
dir<font color="#E5E5E5"> LS command to basically see and</font>

848
00:38:22,890 --> 00:38:29,960
verify<font color="#E5E5E5"> that their uploads worked</font><font color="#CCCCCC"> so on</font>

849
00:38:27,120 --> 00:38:32,040
the server<font color="#E5E5E5"> you can see that they also</font>

850
00:38:29,960 --> 00:38:35,220
that<font color="#E5E5E5"> it</font><font color="#CCCCCC"> actually worked</font><font color="#E5E5E5"> it's on the</font>

851
00:38:32,040 --> 00:38:42,660
remote system<font color="#CCCCCC"> and it's called ode r0 ASP</font>

852
00:38:35,220 --> 00:38:44,040
or<font color="#E5E5E5"> 0.2 HP attacker data theft</font><font color="#CCCCCC"> so some of</font>

853
00:38:42,660 --> 00:38:47,390
<font color="#E5E5E5">the things that they were specifically</font>

854
00:38:44,040 --> 00:38:51,120
targeting outside of just<font color="#E5E5E5"> XLS documents</font>

855
00:38:47,390 --> 00:38:54,359
were web config files looking for

856
00:38:51,120 --> 00:38:57,000
different configuration files<font color="#E5E5E5"> for web</font>

857
00:38:54,360 --> 00:38:58,950
servers<font color="#CCCCCC"> said there</font><font color="#E5E5E5"> seemed to be an</font>

858
00:38:57,000 --> 00:39:01,680
<font color="#CCCCCC">obvious interest</font><font color="#E5E5E5"> in web servers and</font>

859
00:38:58,950 --> 00:39:02,939
<font color="#E5E5E5">uploading web shell C system</font><font color="#CCCCCC"> so some of</font>

860
00:39:01,680 --> 00:39:05,460
the<font color="#E5E5E5"> things that they downloaded though</font>

861
00:39:02,940 --> 00:39:10,680
outside<font color="#CCCCCC"> of</font><font color="#E5E5E5"> that on</font><font color="#CCCCCC"> users workstations</font>

862
00:39:05,460 --> 00:39:12,120
where things like Wi-Fi<font color="#CCCCCC"> pass</font><font color="#E5E5E5"> xlsx and we</font>

863
00:39:10,680 --> 00:39:14,129
saw this a<font color="#E5E5E5"> lot even</font><font color="#CCCCCC"> in our clients</font>

864
00:39:12,120 --> 00:39:17,850
environment<font color="#E5E5E5"> the attacker actually just</font>

865
00:39:14,130 --> 00:39:19,890
downloading passwords dot txt passwords

866
00:39:17,850 --> 00:39:21,870
that<font color="#E5E5E5"> Excel</font><font color="#CCCCCC"> xxxx wherever they were</font>

867
00:39:19,890 --> 00:39:23,310
<font color="#E5E5E5">sewing passwords these users were</font><font color="#CCCCCC"> suing</font>

868
00:39:21,870 --> 00:39:25,859
<font color="#CCCCCC">passwords on desktops or user</font>

869
00:39:23,310 --> 00:39:29,490
directories all over the place which is

870
00:39:25,860 --> 00:39:31,620
kind of<font color="#CCCCCC"> like</font><font color="#E5E5E5"> looking for</font><font color="#CCCCCC"> kind of just</font>

871
00:39:29,490 --> 00:39:34,589
lazy users storing passwords on their

872
00:39:31,620 --> 00:39:36,569
desktop common attacker things so we

873
00:39:34,590 --> 00:39:41,330
also see<font color="#CCCCCC"> that they view FileZilla</font>

874
00:39:36,570 --> 00:39:43,770
<font color="#CCCCCC">content</font><font color="#E5E5E5"> downloaded another excel file</font>

875
00:39:41,330 --> 00:39:47,279
some of the fun tradecraft that we saw

876
00:39:43,770 --> 00:39:49,710
so<font color="#E5E5E5"> they used PS exec it which is just a</font>

877
00:39:47,280 --> 00:39:53,330
common Microsoft utility you<font color="#E5E5E5"> can use her</font>

878
00:39:49,710 --> 00:39:56,190
lateral movement so they started a

879
00:39:53,330 --> 00:39:59,279
basically a<font color="#CCCCCC"> net cat shell</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> their</font><font color="#E5E5E5"> come</font>

880
00:39:56,190 --> 00:40:02,940
their<font color="#CCCCCC"> command-and-control</font><font color="#E5E5E5"> server using</font>

881
00:39:59,280 --> 00:40:05,220
PS exec and then we also see

882
00:40:02,940 --> 00:40:06,630
they have other<font color="#CCCCCC"> files so one of these</font>

883
00:40:05,220 --> 00:40:10,169
<font color="#E5E5E5">files that are pretty interesting</font><font color="#CCCCCC"> file</font>

884
00:40:06,630 --> 00:40:11,910
dot zip<font color="#E5E5E5"> they'll see NCW c PS</font><font color="#CCCCCC"> exec that</font>

885
00:40:10,170 --> 00:40:15,750
you can<font color="#E5E5E5"> be basically a stage a directory</font>

886
00:40:11,910 --> 00:40:19,859
for<font color="#CCCCCC"> this attacker so keep in mind file</font>

887
00:40:15,750 --> 00:40:23,690
dot zip we see is that<font color="#CCCCCC"> the attacker</font><font color="#E5E5E5"> then</font>

888
00:40:19,859 --> 00:40:26,279
<font color="#CCCCCC">tried to unzip their their archive write</font>

889
00:40:23,690 --> 00:40:29,099
<font color="#E5E5E5">file dot zip and they had a strong</font>

890
00:40:26,280 --> 00:40:30,960
password password of<font color="#CCCCCC"> b well actually no</font>

891
00:40:29,099 --> 00:40:32,670
not a<font color="#E5E5E5"> password of d they actually forgot</font>

892
00:40:30,960 --> 00:40:33,960
their password<font color="#E5E5E5"> and so the very next</font>

893
00:40:32,670 --> 00:40:35,880
<font color="#E5E5E5">command we see is it actually use</font>

894
00:40:33,960 --> 00:40:39,180
PowerShell<font color="#E5E5E5"> and grab it from another</font>

895
00:40:35,880 --> 00:40:42,240
<font color="#E5E5E5">victim</font><font color="#CCCCCC"> another victim system and just</font>

896
00:40:39,180 --> 00:40:44,910
download<font color="#E5E5E5"> this other</font><font color="#CCCCCC"> DLL right so file</font>

897
00:40:42,240 --> 00:40:48,029
new one DLL<font color="#E5E5E5"> so I thought that</font><font color="#CCCCCC"> was kind</font>

898
00:40:44,910 --> 00:40:49,828
<font color="#CCCCCC">of fun that they had a zip archive</font><font color="#E5E5E5"> had a</font>

899
00:40:48,030 --> 00:40:51,480
poor password for<font color="#E5E5E5"> it actually forgot</font>

900
00:40:49,829 --> 00:40:53,130
their poor password<font color="#E5E5E5"> for</font><font color="#CCCCCC"> it and then</font><font color="#E5E5E5"> just</font>

901
00:40:51,480 --> 00:40:57,540
use power shuttle download it from some

902
00:40:53,130 --> 00:41:01,050
other victim<font color="#E5E5E5"> self kind of fun so fun</font>

903
00:40:57,540 --> 00:41:03,000
tradecraft<font color="#E5E5E5"> nothing you know a lot of</font>

904
00:41:01,050 --> 00:41:04,800
their commands<font color="#CCCCCC"> weren't of</font><font color="#E5E5E5"> groundbreaking</font>

905
00:41:03,000 --> 00:41:06,810
but it was fun<font color="#E5E5E5"> to</font><font color="#CCCCCC"> see the way they</font>

906
00:41:04,800 --> 00:41:08,420
interact<font color="#E5E5E5"> with systems and how they were</font>

907
00:41:06,810 --> 00:41:12,779
very successful

908
00:41:08,420 --> 00:41:16,230
so in summary so Mandy<font color="#E5E5E5"> basically did an</font>

909
00:41:12,780 --> 00:41:16,800
investigation<font color="#E5E5E5"> last year for an unknown</font>

910
00:41:16,230 --> 00:41:20,180
attacker

911
00:41:16,800 --> 00:41:23,280
and a fortune<font color="#E5E5E5"> 500 financial environment</font>

912
00:41:20,180 --> 00:41:25,980
<font color="#CCCCCC">and then we were</font><font color="#E5E5E5"> able to obtain a</font><font color="#CCCCCC"> situ</font>

913
00:41:23,280 --> 00:41:27,630
server thanks to our client and<font color="#E5E5E5"> we</font><font color="#CCCCCC"> did</font>

914
00:41:25,980 --> 00:41:29,849
forensic analysis and a lot of<font color="#E5E5E5"> forensic</font>

915
00:41:27,630 --> 00:41:34,140
<font color="#E5E5E5">value came from a Postgres database</font>

916
00:41:29,849 --> 00:41:36,930
itself<font color="#E5E5E5"> so Postgres was really just a</font>

917
00:41:34,140 --> 00:41:40,140
<font color="#E5E5E5">gold mine for solving this case and also</font>

918
00:41:36,930 --> 00:41:41,868
looking for<font color="#E5E5E5"> additional information</font><font color="#CCCCCC"> and</font>

919
00:41:40,140 --> 00:41:45,540
finally<font color="#E5E5E5"> based on this investigation</font>

920
00:41:41,869 --> 00:41:50,130
<font color="#CCCCCC">develop a tool called post rock to carve</font>

921
00:41:45,540 --> 00:41:53,579
<font color="#E5E5E5">Postgres equal rows from a image file</font><font color="#CCCCCC"> so</font>

922
00:41:50,130 --> 00:41:55,380
<font color="#E5E5E5">just a couple of takeaways</font><font color="#CCCCCC"> one of the</font>

923
00:41:53,579 --> 00:41:56,910
things I like is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> Metasploit gets</font>

924
00:41:55,380 --> 00:41:58,829
the job done a lot of<font color="#E5E5E5"> times I've heard</font>

925
00:41:56,910 --> 00:42:01,230
you<font color="#E5E5E5"> know</font><font color="#CCCCCC"> medical aid isn't a tool that</font>

926
00:41:58,829 --> 00:42:03,510
<font color="#E5E5E5">you know real attackers use well</font>

927
00:42:01,230 --> 00:42:06,030
<font color="#E5E5E5">actually see real attackers use</font>

928
00:42:03,510 --> 00:42:07,890
<font color="#CCCCCC">Metasploit very frequently</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> they're</font>

929
00:42:06,030 --> 00:42:09,359
very successful<font color="#E5E5E5"> with it you know just</font>

930
00:42:07,890 --> 00:42:12,089
because you're not<font color="#CCCCCC"> making</font><font color="#E5E5E5"> your custom</font>

931
00:42:09,359 --> 00:42:13,710
these custom<font color="#E5E5E5"> malware custom utilities or</font>

932
00:42:12,089 --> 00:42:16,310
custom platforms that you're not

933
00:42:13,710 --> 00:42:17,720
<font color="#E5E5E5">successful</font>

934
00:42:16,310 --> 00:42:20,900
environments are still getting pwned

935
00:42:17,720 --> 00:42:22,879
from<font color="#CCCCCC"> Metasploit and people who can</font>

936
00:42:20,900 --> 00:42:28,250
<font color="#E5E5E5">really use</font><font color="#CCCCCC"> Metasploit very well</font><font color="#E5E5E5"> are very</font>

937
00:42:22,880 --> 00:42:31,520
<font color="#CCCCCC">successful operational security I'm kind</font>

938
00:42:28,250 --> 00:42:33,380
I thought it was kind of funny that it

939
00:42:31,520 --> 00:42:35,390
really had the attacker<font color="#E5E5E5"> just practice</font>

940
00:42:33,380 --> 00:42:36,920
some operational security<font color="#CCCCCC"> this would</font>

941
00:42:35,390 --> 00:42:39,410
<font color="#E5E5E5">have made this investigation kind of</font>

942
00:42:36,920 --> 00:42:41,330
obtaining<font color="#CCCCCC"> a c2 server</font><font color="#E5E5E5"> kind of</font>

943
00:42:39,410 --> 00:42:43,609
uninteresting what if they had used full

944
00:42:41,330 --> 00:42:46,400
disk encryption<font color="#E5E5E5"> and just encrypted their</font>

945
00:42:43,610 --> 00:42:48,560
entire VM<font color="#CCCCCC"> that would have kind of</font>

946
00:42:46,400 --> 00:42:50,510
hindered my investigation<font color="#E5E5E5"> what if they</font>

947
00:42:48,560 --> 00:42:52,970
had deleted<font color="#E5E5E5"> Postgres history post a</font>

948
00:42:50,510 --> 00:42:55,730
sequel<font color="#E5E5E5"> command history or use a</font>

949
00:42:52,970 --> 00:42:58,100
<font color="#E5E5E5">different database name or change their</font>

950
00:42:55,730 --> 00:43:01,100
password for the database<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font>

951
00:42:58,100 --> 00:43:02,420
something other than<font color="#E5E5E5"> MSF MSF just a</font>

952
00:43:01,100 --> 00:43:03,529
number<font color="#E5E5E5"> of</font><font color="#CCCCCC"> different things</font><font color="#E5E5E5"> that I</font><font color="#CCCCCC"> think</font>

953
00:43:02,420 --> 00:43:05,570
we've kind<font color="#CCCCCC"> of interesting</font><font color="#E5E5E5"> from an</font>

954
00:43:03,530 --> 00:43:07,450
operational security standpoint<font color="#E5E5E5"> they did</font>

955
00:43:05,570 --> 00:43:11,090
delete<font color="#E5E5E5"> a lot of stuff that</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> used on</font>

956
00:43:07,450 --> 00:43:13,430
the Kali VM<font color="#CCCCCC"> itself but</font><font color="#E5E5E5"> they just kind of</font>

957
00:43:11,090 --> 00:43:15,350
the Postgres database<font color="#CCCCCC"> that</font><font color="#E5E5E5"> they're mine</font>

958
00:43:13,430 --> 00:43:18,740
and<font color="#CCCCCC"> that turned</font><font color="#E5E5E5"> out to</font><font color="#CCCCCC"> be a huge</font>

959
00:43:15,350 --> 00:43:24,140
forensic way<font color="#CCCCCC"> and then lastly if you want</font>

960
00:43:18,740 --> 00:43:25,189
<font color="#CCCCCC">a</font><font color="#E5E5E5"> c2 server just ask what questions oh</font>

961
00:43:24,140 --> 00:43:36,049
<font color="#CCCCCC">jeez</font>

962
00:43:25,190 --> 00:43:38,770
yeah yeah so<font color="#E5E5E5"> the</font><font color="#CCCCCC"> question</font><font color="#E5E5E5"> was whether or</font>

963
00:43:36,050 --> 00:43:42,500
not it<font color="#CCCCCC"> affected the chain of custody</font>

964
00:43:38,770 --> 00:43:45,290
<font color="#CCCCCC">when they sent us a c2 server and the</font>

965
00:43:42,500 --> 00:43:48,470
answer was<font color="#E5E5E5"> no so the chain of custody</font>

966
00:43:45,290 --> 00:43:51,800
<font color="#E5E5E5">for</font><font color="#CCCCCC"> us started at</font><font color="#E5E5E5"> our client because</font><font color="#CCCCCC"> our</font>

967
00:43:48,470 --> 00:43:54,649
client had the c2 server so for<font color="#E5E5E5"> us it</font>

968
00:43:51,800 --> 00:43:57,290
was client gives us<font color="#CCCCCC"> C to server actually</font>

969
00:43:54,650 --> 00:43:59,570
<font color="#E5E5E5">not even necessarily gives us we went to</font>

970
00:43:57,290 --> 00:44:02,600
their site and imaged it so we never

971
00:43:59,570 --> 00:44:04,910
<font color="#E5E5E5">actually took the c2 server the physical</font>

972
00:44:02,600 --> 00:44:07,310
<font color="#E5E5E5">rack-mountable server itself we</font><font color="#CCCCCC"> just</font>

973
00:44:04,910 --> 00:44:08,870
took an image on their site location<font color="#E5E5E5"> so</font>

974
00:44:07,310 --> 00:44:11,509
chain of custody was really just

975
00:44:08,870 --> 00:44:15,980
starting<font color="#CCCCCC"> at</font><font color="#E5E5E5"> that location took image</font>

976
00:44:11,510 --> 00:44:17,940
took image to<font color="#CCCCCC"> our forensic lab good</font>

977
00:44:15,980 --> 00:44:25,410
question yeah

978
00:44:17,940 --> 00:44:27,930
<font color="#E5E5E5">a good question</font>

979
00:44:25,410 --> 00:44:31,200
so that was a bit<font color="#CCCCCC"> anti-climatic I'll be</font>

980
00:44:27,930 --> 00:44:33,899
honest<font color="#CCCCCC"> it turned out</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> not have any it</font>

981
00:44:31,200 --> 00:44:35,669
was really more opportunistic<font color="#CCCCCC"> I think if</font>

982
00:44:33,900 --> 00:44:39,680
I had to<font color="#CCCCCC"> take a guess the attacker maybe</font>

983
00:44:35,670 --> 00:44:41,609
understand do that there was already a

984
00:44:39,680 --> 00:44:43,348
relationship between<font color="#CCCCCC"> this third party</font>

985
00:44:41,609 --> 00:44:47,369
<font color="#E5E5E5">and the client so they probably</font>

986
00:44:43,349 --> 00:44:51,030
<font color="#CCCCCC">leveraged that a little bit but</font><font color="#E5E5E5"> overall</font>

987
00:44:47,369 --> 00:44:53,010
<font color="#E5E5E5">no they were not attacking them</font><font color="#CCCCCC"> for any</font>

988
00:44:51,030 --> 00:44:54,960
espionage gain or<font color="#CCCCCC"> anything or they</font>

989
00:44:53,010 --> 00:44:58,470
weren't<font color="#CCCCCC"> angry they ended the contract</font>

990
00:44:54,960 --> 00:45:05,010
you know yeah<font color="#CCCCCC"> anti-climactic unfortunate</font>

991
00:44:58,470 --> 00:45:08,180
<font color="#E5E5E5">good question any other questions</font><font color="#CCCCCC"> whoo</font>

992
00:45:05,010 --> 00:45:08,180
thank you guys

