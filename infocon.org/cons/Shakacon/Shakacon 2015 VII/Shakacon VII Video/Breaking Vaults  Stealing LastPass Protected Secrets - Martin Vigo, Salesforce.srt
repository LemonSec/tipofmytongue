1
00:00:02,750 --> 00:00:08,350
I'm very happy to introduce a good
friend of mine his name is martine he

2
00:00:08,350 --> 00:00:13,379
works for a really cool company I've
heard and he's done some really need

3
00:00:13,380 --> 00:00:19,270
research on stealing stuff out of last
pass last has anybody here use LastPass

4
00:00:19,270 --> 00:00:25,820
so you can put all of your passwords in
last mass and then martine can feel them

5
00:00:25,820 --> 00:00:30,460
out so it's pretty cool talk when we do
talks to kind of shake the nerds we like

6
00:00:30,460 --> 00:00:34,969
to play a drinking game and so what we
usually do is have the audience yell out

7
00:00:34,969 --> 00:00:38,980
a word that they think will say very
frequently during the talk and then if

8
00:00:38,980 --> 00:00:44,190
we say that word we all drink so being
that the stock is about last mass and

9
00:00:44,190 --> 00:00:47,349
stealing passwords out of last pass was
a word that you think we might say

10
00:00:47,350 --> 00:00:53,660
frequently I think I heard LastPass
alright okay so please give a warm

11
00:00:53,660 --> 00:01:04,628
welcome to Martine and Mahalo
appreciated by I love haha gone we got

12
00:01:04,629 --> 00:01:08,479
free publicity or so anyone that is
outside please go and join the talking

13
00:01:08,479 --> 00:01:17,430
would be fun so today we're going to be
talking about last by saying how alright

14
00:01:17,430 --> 00:01:20,720
I was just there so I gotta look for a
different word I'm going to just say I L

15
00:01:20,720 --> 00:01:30,908
P or something like that yeah alright
you know that this drink a lot

16
00:01:30,909 --> 00:01:37,240
ok first things first it was alright
three weeks ago there was a breach the

17
00:01:37,240 --> 00:01:43,979
stall everything from AP like cassius
all that he was not mean that is someone

18
00:01:43,979 --> 00:01:47,539
from Homeland Security I still wear my
green card so you wanna see me I meant

19
00:01:47,540 --> 00:01:48,640
it was not me

20
00:01:48,640 --> 00:01:54,490
ok now that I said that a mi my bro
security engineer at some stores where

21
00:01:54,490 --> 00:01:58,369
you can company I'm from spain has been
separated from God if you're just couple

22
00:01:58,369 --> 00:02:01,759
of facts we have the most beautiful
beach in the world not just me saying

23
00:02:01,759 --> 00:02:06,119
that is the Guardian that says it we
have really amazing seafood and Charlie

24
00:02:06,119 --> 00:02:10,860
Sheen's grandfather in was actually from
so I feel like good food the fact that

25
00:02:10,860 --> 00:02:13,350
people just come to life

26
00:02:13,350 --> 00:02:28,490
it's it's a good place it's a good place
ok so what is left by 12 lbs up anger

27
00:02:28,490 --> 00:02:31,820
management service which seeks to
resolve a password fatigue problem by

28
00:02:31,820 --> 00:02:36,790
centralizing user password management in
the cloud so I saw just couple hands

29
00:02:36,790 --> 00:02:45,230
saying that the user p but who uses a
password manager at all I assume their

30
00:02:45,230 --> 00:02:49,519
registry users are possible sorry you
change the last character and so you

31
00:02:49,520 --> 00:02:54,940
feel good about it i mean better
managers and a good thing and that is

32
00:02:54,940 --> 00:02:59,910
many many out there right now is not the
only one getting good at this

33
00:02:59,910 --> 00:03:03,549
we have we're well past where keep
saying basically all did you can

34
00:03:03,550 --> 00:03:08,450
grouping to into different groups right
the ones that are offline the ones that

35
00:03:08,450 --> 00:03:12,959
are online so if you feel more part are
you on your date adjusting your machine

36
00:03:12,960 --> 00:03:17,000
you will use the overlying wise if you
were to be able to seeing all your

37
00:03:17,000 --> 00:03:23,050
secrets across devices you will use them
so why targeting password managers I

38
00:03:23,050 --> 00:03:26,560
tells us we have a really outstanding
read taking a lot of them are here they

39
00:03:26,560 --> 00:03:30,520
are organized into ctfu guys should
check that out too and they they told me

40
00:03:30,520 --> 00:03:34,980
actually that would be really cool to
have a password manager hacked because

41
00:03:34,980 --> 00:03:39,010
everything they want this right there if
you think about it credentials for

42
00:03:39,010 --> 00:03:42,790
social network for bank accounts for
email accounts corporate credentials

43
00:03:42,790 --> 00:03:47,440
just one single place for password
manager said actually really high value

44
00:03:47,440 --> 00:03:53,160
target so now that we understand why we
want to hack password manager why last

45
00:03:53,160 --> 00:03:54,430
bus

46
00:03:54,430 --> 00:04:03,659
wow ok I think I'm gonna need a refill
ok first thing I saw it has an

47
00:04:03,659 --> 00:04:07,980
enterprise edition that's really cool
that means in this is words I think of

48
00:04:07,980 --> 00:04:13,250
some marketing person from AP more than
10,000 corporate customers ranging in

49
00:04:13,250 --> 00:04:20,488
size all the way up to Fortune 500 so
really big companies use and one of the

50
00:04:20,488 --> 00:04:24,280
other things that I really liked about
LPD is the fact that they don't only

51
00:04:24,280 --> 00:04:28,090
store credentials you can also store
credit card personal documentation

52
00:04:28,090 --> 00:04:31,830
private notes driver license social
security numbers and actually there is a

53
00:04:31,830 --> 00:04:36,270
specific form for the different
information so this is not anymore just

54
00:04:36,270 --> 00:04:41,849
about credentials is about all your
secrets I seeing SSH keys and things

55
00:04:41,849 --> 00:04:47,479
like that too and arguably the most
popular ones right so the first thing

56
00:04:47,479 --> 00:04:50,830
was for me to check that the state of
the art I basically wanted to see for

57
00:04:50,830 --> 00:04:55,008
ready there's a lot of smart people out
there checking and doing some research

58
00:04:55,009 --> 00:05:00,039
and I saw that a lot of 10 bilities was
disclosed and there was some really cool

59
00:05:00,039 --> 00:05:04,460
attacks and a couple of papers about the
NHL BOS shining and cross-site scripting

60
00:05:04,460 --> 00:05:09,169
doing some form injections so you would
you can lick credentials what I found

61
00:05:09,169 --> 00:05:13,419
was the fact that in order to reduce
credentials you will have to targeted

62
00:05:13,419 --> 00:05:17,440
meaning if you want to Facebook
passwords then you will have to get

63
00:05:17,440 --> 00:05:23,020
resemble an iframe to Facebook so there
is no there was no really way to

64
00:05:23,020 --> 00:05:27,099
actually say okay episode of a bullet
that if I do this thing I get all the

65
00:05:27,099 --> 00:05:32,300
ball so that was the gap that I saw them
was there so for me the target was the

66
00:05:32,300 --> 00:05:36,320
master password well it's pretty clear
if I get the master password I get

67
00:05:36,320 --> 00:05:40,000
everything I don't need to know anything
about the content of the boat I'm just

68
00:05:40,000 --> 00:05:43,870
gonna get it all again not only
credentials but I get all the things

69
00:05:43,870 --> 00:05:47,060
that you starting their credit cards and
stuff like that

70
00:05:47,060 --> 00:05:56,000
alright so i cant texture so not saying
country many many players right it comes

71
00:05:56,000 --> 00:06:00,380
as a browser extensions it comes as a
four-year do it for your mobile device

72
00:06:00,380 --> 00:06:05,200
it comes as a stand-alone stand-alone
versions too in a USB things like that

73
00:06:05,200 --> 00:06:07,070
and you basically talks to

74
00:06:07,070 --> 00:06:13,680
p backs who play games or or software on
your device's my focus was on browser

75
00:06:13,680 --> 00:06:19,310
plug and the recent gang it's I thought
it was the most popular part and yes I

76
00:06:19,310 --> 00:06:22,850
just wanted to talk about what I thought
everyone pretty much you see and in the

77
00:06:22,850 --> 00:06:29,320
end business lawyer gets pretty much the
same for everything so yeah ok so when I

78
00:06:29,320 --> 00:06:41,030
don't last post browser when I look at
their flagging it's written in

79
00:06:41,030 --> 00:06:45,179
JavaScript you say say say more young
policy forum

80
00:06:45,180 --> 00:06:55,390
boxing one of the things he does Jets
dating to the DOM

81
00:06:55,390 --> 00:07:00,890
security claims from El P they basically
tell you that they have no access to

82
00:07:00,890 --> 00:07:05,070
your data and that's the big marketing
say they don't want to know about your

83
00:07:05,070 --> 00:07:09,800
secrets they just story for you and they
do that by telling you that everything

84
00:07:09,800 --> 00:07:15,780
gets tripped and they'll tell you that
everything is security storage all your

85
00:07:15,780 --> 00:07:25,789
secrets everything last post a notice
this time and on the client side

86
00:07:25,790 --> 00:07:31,510
everything would be so let's check that
out so I just wanted to put this cave

87
00:07:31,510 --> 00:07:39,870
here because I think it's hilarious so
we wanted to reverse those plugins ok I

88
00:07:39,870 --> 00:07:44,140
want to give a shout out to my friend
Alberto Garcia get up get up come up

89
00:07:44,140 --> 00:07:50,200
yeah he he we both started the research
together and this was actually he say

90
00:07:50,200 --> 00:07:53,620
the app in order to start to do the
reverse amazingly well we did see some

91
00:07:53,620 --> 00:07:55,450
instrumentation

92
00:07:55,450 --> 00:08:00,030
we wrote that iPhone plugging the script
sorry the basic already does he was

93
00:08:00,030 --> 00:08:04,960
injecting a single function and they
will tell us it will basically printout

94
00:08:04,960 --> 00:08:09,539
which finally was located at the snippet
of code what was the name of the

95
00:08:09,540 --> 00:08:13,430
function in what was a valuable depart
mirrors that gives us a chronological

96
00:08:13,430 --> 00:08:16,790
order of all the functions that are
being called indicted very very valuable

97
00:08:16,790 --> 00:08:19,529
information specially with think about
that we then went

98
00:08:19,529 --> 00:08:25,719
house a little over skated JavaScript
right so these worshipers so again shut

99
00:08:25,719 --> 00:08:29,009
out to Alberto Garcia you guys can find
him on Twitter I think I don't end there

100
00:08:29,009 --> 00:08:32,999
to adjust my private Google Finance I
would have gone through in their two of

101
00:08:32,999 --> 00:08:40,180
its two of you that when I talk to him
so so what we got from it was the fact

102
00:08:40,179 --> 00:08:45,489
that we we got all the files I dot axis
right from the machine we started to

103
00:08:45,490 --> 00:08:51,970
play with it with a plugging all that
and so we were looking at Tres figured

104
00:08:51,970 --> 00:08:56,860
out some stuff again it's minimize that
has created a javascript we showed that

105
00:08:56,860 --> 00:09:04,689
the storage happens one of the things we
show is here outside of specific

106
00:09:04,689 --> 00:09:09,199
implementation I want to point this out
because in this case Firefox works quite

107
00:09:09,199 --> 00:09:13,998
different than the rest of the process
at least when it comes to the other

108
00:09:13,999 --> 00:09:19,170
people will figure out what all the
files were located how they StorageWorks

109
00:09:19,170 --> 00:09:26,459
we showed that they use a yes but they
implemented their own crypto not it's a

110
00:09:26,459 --> 00:09:33,069
yes but you shouldn't be doing that and
the area is based on open-source ok

111
00:09:33,069 --> 00:09:40,610
looking encryption encryption the USA a
256 bit AES what they don't tell you

112
00:09:40,610 --> 00:09:46,519
that the UCB seeing ECB and if you look
the best practices ECB should be you and

113
00:09:46,519 --> 00:09:52,129
you don't know why I go to Wikipedia
they will tell you and again they use

114
00:09:52,129 --> 00:09:57,920
their own implementation they also use
the password for a ski their vision

115
00:09:57,920 --> 00:10:02,149
functions basically two is trying to
strengthen your Yorkie

116
00:10:02,149 --> 00:10:05,910
they didn't tell you thatthe you say
only 500 rounds or five thousand rounds

117
00:10:05,910 --> 00:10:10,129
and the difference depends on how well
your county's I would say around

118
00:10:10,129 --> 00:10:16,129
accounts that are two years they still
use 500 rounds and for some reason they

119
00:10:16,129 --> 00:10:22,179
didn't react retroactive fully updated
that so I don't know why

120
00:10:22,179 --> 00:10:26,110
and again this is good but if you look
at best practices probably 500 is not

121
00:10:26,110 --> 00:10:30,910
enough nowadays this is putting like the
paranoia and

122
00:10:30,910 --> 00:10:36,170
just out of curiosity figuring out how
many iterations user House is announcing

123
00:10:36,170 --> 00:10:44,160
a decade or so let's get a little
reading to the interesting part so I was

124
00:10:44,160 --> 00:10:48,189
actually the encryption key generator
that is used to encrypt your boat into

125
00:10:48,190 --> 00:10:53,850
the Krypton well its derivation of you
using your master password together with

126
00:10:53,850 --> 00:11:00,190
a username receiver giving you such a
256 GB KDF to using us all your username

127
00:11:00,190 --> 00:11:05,020
candidate actually do they taste the
master password the number of iterations

128
00:11:05,020 --> 00:11:12,800
that you set up for the default
generation 32 going to quick let me know

129
00:11:12,800 --> 00:11:19,040
guys because so now that we know
encryption key for your world let's take

130
00:11:19,040 --> 00:11:25,860
a step back and look a little bit can
you guys in and tires so on the left

131
00:11:25,860 --> 00:11:30,000
side well we haven't the local part of
her show on your browser what happens he

132
00:11:30,000 --> 00:11:35,010
studied your vote gets encrypted and
decrypted so it's true everything from

133
00:11:35,010 --> 00:11:40,360
the client site so what is it actually
gets shared with LastPass so you know

134
00:11:40,360 --> 00:11:45,610
when I because you don't want to do that
with your encryption you don't want to

135
00:11:45,610 --> 00:11:48,510
do that with your master password
because they don't wanna know about it

136
00:11:48,510 --> 00:11:53,780
that you wanted to know about it so what
they do is they apply an extra round of

137
00:11:53,780 --> 00:11:59,459
PPK tf2 which sold as your master
password in cleartext candidate as the

138
00:11:59,460 --> 00:12:13,430
Christian and generates again a 32 and
$1.04 so what they claim they do is that

139
00:12:13,430 --> 00:12:21,359
they apply an additional hunt I forgot
about this

140
00:12:21,360 --> 00:12:34,899
here ok so I had a hundred thousand
extra rounds we gotta take the word for

141
00:12:34,899 --> 00:12:40,200
it right and Dave and the incredible get
stored there too

142
00:12:40,200 --> 00:12:53,089
ok so what does the last bus actually
see I don't

143
00:12:53,089 --> 00:13:04,910
and they see an additional round of PKD
of to shut 256 of your encryption key I

144
00:13:04,910 --> 00:13:10,730
put this year because when you go to the
page you see all about the killer vision

145
00:13:10,730 --> 00:13:15,829
and stuff but the truth is it's not
protecting your encryption key against

146
00:13:15,829 --> 00:13:20,359
me right because he just uses the next
round I i'm not saying that it's easy to

147
00:13:20,360 --> 00:13:24,920
reports that or it's doable or anything
I'm just pointing it out

148
00:13:24,920 --> 00:13:33,559
truth is it's no pkg of 2 between your
encryption key in last place I see you

149
00:13:33,559 --> 00:13:39,910
guys are starting to get bored of seeing
during this was a big save this country

150
00:13:39,910 --> 00:13:41,399
the next one

151
00:13:41,399 --> 00:13:47,439
alright so we have an understanding of
how it is we understand that the recent

152
00:13:47,439 --> 00:13:53,709
syndication has which is derived from
your encryption key so let's go still

153
00:13:53,709 --> 00:13:54,550
the master password

154
00:13:54,550 --> 00:14:01,300
that's what we are here so you can
remember your your your password right

155
00:14:01,300 --> 00:14:05,089
and that was the first thing I i wanted
to know if I can remember this news to

156
00:14:05,089 --> 00:14:09,449
get stored locally somehow I wanted to
know how I wanted to know if I can just

157
00:14:09,449 --> 00:14:15,959
get in clear text so it is indeed store
locally and its get starting school data

158
00:14:15,959 --> 00:14:20,349
base when you get starting price tag GIS
and here we come against what I

159
00:14:20,350 --> 00:14:23,629
mentioned before by your folks worst
differently than the rest of the

160
00:14:23,629 --> 00:14:28,740
browsers so in this case for Firefox you
get starting fresh vegies again to use

161
00:14:28,740 --> 00:14:35,079
ECB or CBC and basically you see here
two examples when it CBC you see that

162
00:14:35,079 --> 00:14:42,050
it's pretty obvious prepended ok so this
is just I just wanted to put this year

163
00:14:42,050 --> 00:14:46,339
so you guys have the information we're
all the firestorm located and they you

164
00:14:46,339 --> 00:14:49,870
may see their Internet Explorer is
missing and the truth is Internet

165
00:14:49,870 --> 00:14:53,270
Explorer is one of the savior of the
most safe

166
00:14:53,270 --> 00:14:58,030
process believe it or not because he
uses protected storage by default it

167
00:14:58,030 --> 00:15:07,480
doesn't mean that it can be accessed but
it's more difficult so where is the

168
00:15:07,480 --> 00:15:12,270
master password Store it's in this
school and life and you see that it

169
00:15:12,270 --> 00:15:13,569
tells you right away

170
00:15:13,570 --> 00:15:17,600
username and password in the Password if
you look at it looks exactly as I told

171
00:15:17,600 --> 00:15:22,490
you before us show you before its
specification in the column last past

172
00:15:22,490 --> 00:15:35,240
safety organs to but that was a longer
and say ok I guess accounts to thank you

173
00:15:35,240 --> 00:15:42,680
man that ok I can't really say anything
LLP save logging is two and a half hour

174
00:15:42,680 --> 00:15:49,660
LPC plugins which is not use I guess I
was just going to change that and there

175
00:15:49,660 --> 00:15:55,370
there is no root needed to access ok
that's very important how does it work

176
00:15:55,370 --> 00:16:02,780
in Firefox Firefox gets touring acts in
the present yes I mentioned before and

177
00:16:02,780 --> 00:16:07,850
you can look for extensions the RLP dog
logging users contains all the usernames

178
00:16:07,850 --> 00:16:14,150
and extensions or Elpida login password
which are encrypted password again no

179
00:16:14,150 --> 00:16:22,459
routinely offered is alright so
encryption so how is it actually

180
00:16:22,460 --> 00:16:26,870
encrypted because we know where you
store but it's still encrypted so it's a

181
00:16:26,870 --> 00:16:34,740
yes 256 uses around in the key he says
shuttle 56 of your username what I'm

182
00:16:34,740 --> 00:16:39,450
saying here is that the secret to the
crib your credentials is the user

183
00:16:39,450 --> 00:16:47,440
doesn't sound like a good secret right
so they double up and running I V maybe

184
00:16:47,440 --> 00:16:49,650
it's not supposed to be a secret so
that's fine

185
00:16:49,650 --> 00:16:54,870
use a separator in there you have to
data and the key is a shot 256 of your

186
00:16:54,870 --> 00:17:01,760
username that's only takes so we located
the files we know that Christian system

187
00:17:01,760 --> 00:17:05,629
we have today we have to keep we have to
data

188
00:17:05,630 --> 00:17:11,640
we have your credentials include tax
that is so and when we got to this

189
00:17:11,640 --> 00:17:19,010
Alberta me we actually wrote a blog post
and you gotta read it on that said you

190
00:17:19,010 --> 00:17:22,879
got a lot of you know reviews and all
that stuff and I and we thought it was

191
00:17:22,880 --> 00:17:24,500
very interesting was really cool

192
00:17:24,500 --> 00:17:33,740
feedback and all that but you know we
now have the resources to LPN and some

193
00:17:33,740 --> 00:17:38,200
other vulnerabilities that we found like
web stuff on the way we're doing this

194
00:17:38,200 --> 00:17:46,270
and all I got was a fucking teacher so
and I wanted to come to how I wanted to

195
00:17:46,270 --> 00:17:51,080
go into how I so I need enough content
to actually do the call for papers

196
00:17:51,080 --> 00:17:55,659
Alberta teach me to do some more
interesting staff and I just kept going

197
00:17:55,660 --> 00:17:59,180
so what about two factor authentication

198
00:17:59,180 --> 00:18:03,750
right okay we have their clear text
credentials but two factor

199
00:18:03,750 --> 00:18:11,940
authentication is actually there to
actually deal with the situation was ok

200
00:18:11,940 --> 00:18:17,330
bypassing two-factor authentication the
time

201
00:18:17,330 --> 00:18:23,370
alright so indication he looks like this
right when you get it supports the law

202
00:18:23,370 --> 00:18:26,879
of a lot of different two-factor
authentication methods

203
00:18:26,880 --> 00:18:32,980
syndication you became two-fer a lot of
them and I focused on Google's indicator

204
00:18:32,980 --> 00:18:36,750
but most of them were the same way again
because it's real I guess it's what

205
00:18:36,750 --> 00:18:43,090
everyone uses the most so the first
thing I did was ok let me look at what

206
00:18:43,090 --> 00:18:50,250
happens when I get prompted the two
factors Asian and what I saw a bunch of

207
00:18:50,250 --> 00:18:55,270
parameters question logging and I
started to play with this and I saw that

208
00:18:55,270 --> 00:19:02,590
UUID UUID was the one that when I was
removing it I will be prompted for

209
00:19:02,590 --> 00:19:06,899
two-factor authentication and when I
don't think I will not show you your

210
00:19:06,900 --> 00:19:11,410
ideas actually the trash-talking I was
like a story but what what it will use

211
00:19:11,410 --> 00:19:16,310
the cookie what is that supposed to be
used to trust the browser does he

212
00:19:16,310 --> 00:19:19,020
usually implement two-factor
authentication

213
00:19:19,020 --> 00:19:26,870
so I was like oK what's going on how is
this request will forge how is that UUID

214
00:19:26,870 --> 00:19:32,530
work how is the talking generators value
of the UUID premier how is it starting

215
00:19:32,530 --> 00:19:37,629
with its so the way the other questions
for you if you login over the side or

216
00:19:37,630 --> 00:19:42,990
whatever it said the talking sexual
injected into the dog you've and data

217
00:19:42,990 --> 00:19:49,170
one ok so getting ejected there's going
to be part of your post I was actually

218
00:19:49,170 --> 00:19:53,220
that talking generator well they
actually reviews what they use when you

219
00:19:53,220 --> 00:19:58,100
say ok generate a password for me around
and password so basically you can see it

220
00:19:58,100 --> 00:20:07,290
it took us around impossible that is 32
characters ok and one of the important

221
00:20:07,290 --> 00:20:11,820
things is it gets generated a plug-in
installation install the plugin targets

222
00:20:11,820 --> 00:20:16,189
that is generated and stored that is
very important in housing where recent

223
00:20:16,190 --> 00:20:22,970
story it's touring plain text in
Firefox's in the file is UID I guess as

224
00:20:22,970 --> 00:20:28,570
stands for Secure which is fucking not
true and for Chrome Safari it's in a

225
00:20:28,570 --> 00:20:35,230
locker storage SQL database so basically
and you may be wondering okay so what's

226
00:20:35,230 --> 00:20:36,730
the big deal with this right

227
00:20:36,730 --> 00:20:41,040
well the big deal is that don't think
rip locals tourists some of them in

228
00:20:41,040 --> 00:20:48,830
critical values of the cookies but they
don't do that with your stories are

229
00:20:48,830 --> 00:20:53,679
actually accessible in unencrypted
meaning no root neither the talking is

230
00:20:53,680 --> 00:20:55,130
stored in plain text

231
00:20:55,130 --> 00:20:58,420
the trucking sexual ejected into the
dorms sure you find some point that's

232
00:20:58,420 --> 00:21:01,100
you know that's the paranoia but if
there is a cross-site scripting you

233
00:21:01,100 --> 00:21:06,750
there's still that to our problems and
this is important the same talking is

234
00:21:06,750 --> 00:21:12,670
used for all the users of the processor
meaning several accounts for some people

235
00:21:12,670 --> 00:21:13,970
using the same browse it

236
00:21:13,970 --> 00:21:17,190
the talking with the same for them

237
00:21:17,190 --> 00:21:23,000
the talking will be always a center
during style

238
00:21:23,000 --> 00:21:28,550
a day which means that I'm trusting the
browser has actually no real effect the

239
00:21:28,550 --> 00:21:32,899
talking is still the same that means
that when you change your emergency

240
00:21:32,900 --> 00:21:48,870
situation unless you go to your friend
my last but you got to your friends of

241
00:21:48,870 --> 00:21:53,479
friends account was hacked and stuff
said you have two factor authentication

242
00:21:53,480 --> 00:21:58,170
oh ok then go and do it well

243
00:21:58,170 --> 00:22:07,410
fixation you can actually be proactive
about that you can actually still the

244
00:22:07,410 --> 00:22:11,980
talking today before he was he was say
before you actually activated two-factor

245
00:22:11,980 --> 00:22:17,210
authentication and when they friend of
the victim to arson going in activated

246
00:22:17,210 --> 00:22:24,470
two factor authentication it doesn't
matter I radio so I can still it today

247
00:22:24,470 --> 00:22:30,990
you can activate it tomorrow I'm going
to still be able to use it so we have to

248
00:22:30,990 --> 00:22:36,990
file we know the encryption we have the
data we have TV we have to keep it now

249
00:22:36,990 --> 00:22:41,270
we have the two-factor authentication so
we have the credentials and we can

250
00:22:41,270 --> 00:22:44,860
bypass it's not really bypassing because
you had actually given to last post what

251
00:22:44,860 --> 00:22:49,500
they are asking for the two-factor
authentication talking about 50 K

252
00:22:49,500 --> 00:23:00,040
when I tried this yesterday I was much
better that it only 35 times so ok I

253
00:23:00,040 --> 00:23:04,170
know what you guys are thinking ride in
the user to do some idiotic thing which

254
00:23:04,170 --> 00:23:08,820
is to remember the password so what
about you remember the password was not

255
00:23:08,820 --> 00:23:12,169
click there was no way to obtain the
two-factor authentication

256
00:23:12,170 --> 00:23:17,090
everything we talked about now that can
happen and I was wondering about that

257
00:23:17,090 --> 00:23:21,500
because he was still not enough to
convince people to get me here for free

258
00:23:21,500 --> 00:23:29,500
so I stumbled upon this recovery and
this was my face I was like wait a

259
00:23:29,500 --> 00:23:33,690
second how how how how is impossible

260
00:23:33,690 --> 00:23:35,500
last 10 my master password

261
00:23:35,500 --> 00:23:44,400
I'm gonna start cursing Spanish so the
worry about it okay how is it possible

262
00:23:44,400 --> 00:23:48,980
that somehow my master password my must
deposit is the only way to get the

263
00:23:48,980 --> 00:23:53,400
encryption key so how am I gonna recover
the account to be able to decrypt the

264
00:23:53,400 --> 00:23:58,930
data no one knows that and I don't know
if that's why I'm doing so I was like

265
00:23:58,930 --> 00:24:05,260
they way whereas you go to the UN
release basically P you know what I mean

266
00:24:05,260 --> 00:24:11,810
its large recover the PHP and you get
this to you put your amount you get a

267
00:24:11,810 --> 00:24:16,580
unique link in your email and suddenly
you see this again when you click on it

268
00:24:16,580 --> 00:24:21,560
and there's a big button that says
pressure to recover account I pressed on

269
00:24:21,560 --> 00:24:26,639
Adam Williams how many I was looking up
my both decrypted with all my secrets

270
00:24:26,640 --> 00:24:33,320
there and I was not starting my master
password and everything just like

271
00:24:33,320 --> 00:24:36,740
everything was there and the food was
also that I had two factor

272
00:24:36,740 --> 00:24:41,510
authentication enable and I never was
prompted free so I was like I don't

273
00:24:41,510 --> 00:24:47,670
understand why they just happen right so
I started to look into this I started

274
00:24:47,670 --> 00:24:52,570
from the email and I wanted to know what
was happening when you click on the

275
00:24:52,570 --> 00:24:59,669
unique link when you click on the unique
link outta responds with a 302 redirects

276
00:24:59,670 --> 00:25:06,020
you to this URL that contains 4
premieres time time hash user name and

277
00:25:06,020 --> 00:25:12,410
username hash and what this where we are
at the bottom when you click on the

278
00:25:12,410 --> 00:25:17,820
button then upon request is made to
slash OTP with a parameter that is

279
00:25:17,820 --> 00:25:18,980
change

280
00:25:18,980 --> 00:25:27,180
ok so the first thing I wanted to know
is ok can I generating the URL myself

281
00:25:27,180 --> 00:25:31,730
the URL that actually read the text me
once I click on the unique link why do I

282
00:25:31,730 --> 00:25:35,730
want to do that because i dont wanna
have to need access to the right i wanna

283
00:25:35,730 --> 00:25:45,420
know if I can directly do this so the
time timestamp from the moment you

284
00:25:45,420 --> 00:25:46,919
actually quick recovery that count

285
00:25:46,919 --> 00:25:51,350
you enter your email to press the button
that's the time the time her she's

286
00:25:51,350 --> 00:25:57,269
basically are salted hash of it and they
are the result of the user name of the

287
00:25:57,269 --> 00:26:02,980
user name is also get a shot and the way
I know it's called it is because I use

288
00:26:02,980 --> 00:26:07,049
one of the oldest techniques in hacking
which he said just ask politely to last

289
00:26:07,049 --> 00:26:13,330
year when there are you asking me how do
you guys do that in there would really

290
00:26:13,330 --> 00:26:18,199
cool they they actually make that clear
they work with me all the time they are

291
00:26:18,200 --> 00:26:24,999
really cool in fixing everything very
very fast ok so what was the challenges

292
00:26:24,999 --> 00:26:30,059
I knew what the premier was so I needed
to generate first of all it's lunchtime

293
00:26:30,059 --> 00:26:40,070
I need to be able to generate the hashes
and for that any the salt so because I

294
00:26:40,070 --> 00:26:45,480
didn't know how to do the hashes what I
did was ok I'm going to recover my own

295
00:26:45,480 --> 00:26:51,679
account and I'm gonna copy the timestamp
hash and the times to the victims you

296
00:26:51,679 --> 00:26:56,649
let's see if that works and it did work
and that tells me a couple things that

297
00:26:56,649 --> 00:27:01,729
has been used essential for all the
users because my heart was valid on the

298
00:27:01,730 --> 00:27:07,470
user in the victims so now I could
generate my own body touchdown and cash

299
00:27:07,470 --> 00:27:15,909
it because I couldn't see what I mean is
that also tells me that the link that's

300
00:27:15,909 --> 00:27:22,960
actually not sure expire only the tank
studies validated that means that even

301
00:27:22,960 --> 00:27:27,980
if you start to recover the account and
you want to use that link two years

302
00:27:27,980 --> 00:27:33,489
where the point is there is no flag on
the back and help you telling ok this

303
00:27:33,489 --> 00:27:37,739
expired the only thing to do is just a
check on the hash tag team matches the

304
00:27:37,739 --> 00:27:43,629
tanks and there is no need to request
account recovery because I was

305
00:27:43,629 --> 00:27:47,779
generating a valuer out so there is no
need to initiate our current recovery

306
00:27:47,779 --> 00:27:53,559
you can just generate of all your own
that show just saw this actually the

307
00:27:53,559 --> 00:27:54,850
secret

308
00:27:54,850 --> 00:28:00,840
but still the challenge was even the way
to reuse the times I couldn't reduced

309
00:28:00,840 --> 00:28:09,000
the user name because I need to put so I
was only missing the server solved to be

310
00:28:09,000 --> 00:28:13,720
able to generate the value over you are
out and the truth assaults are not meant

311
00:28:13,720 --> 00:28:20,070
to be a secret they are just meant to be
unique and random and three weeks ago

312
00:28:20,070 --> 00:28:25,080
when he got preached one of the things
they got was actually the salt and you

313
00:28:25,080 --> 00:28:29,840
may see their that it says server per
user salt but they changed that one side

314
00:28:29,840 --> 00:28:34,169
disclosed to them the fact that you
could really use the hashes so now it's

315
00:28:34,170 --> 00:28:39,510
a server per user salt but still if you
have it you could generate those who

316
00:28:39,510 --> 00:28:46,490
else but I didn't have anything had
houses so I needed to look for it so I

317
00:28:46,490 --> 00:28:50,090
went to the next request to remember now
we're talking about the request from

318
00:28:50,090 --> 00:28:55,129
when I click the button of recover my
account and the request looks like this

319
00:28:55,130 --> 00:29:07,630
so what has changed bTW it's a derive
disabled and I will explain what that is

320
00:29:07,630 --> 00:29:16,640
on ABC last but it turns out there's two
types for us best there is

321
00:29:16,640 --> 00:29:25,550
I don't even getting at some point you
know the types that is the true one time

322
00:29:25,550 --> 00:29:29,970
password anywhere you print them on your
sheet in that used to logging in on

323
00:29:29,970 --> 00:29:34,360
trusted computing technology using
one-time password and then they have

324
00:29:34,360 --> 00:29:43,330
what they called it is safe and we're
gonna call ed OTP okay from now so what

325
00:29:43,330 --> 00:29:47,510
do you say the same a one-time password
is used to recover the vault which

326
00:29:47,510 --> 00:29:53,879
ultimately means it's useful and it is
set by default so here is the difference

327
00:29:53,880 --> 00:29:59,540
with remember in the password one night
was telling the master password and be

328
00:29:59,540 --> 00:30:05,870
able to the crib to the world that I
need it the user to do I do now they are

329
00:30:05,870 --> 00:30:13,560
you so this is said by before but not
the encryption key I can use that is not

330
00:30:13,560 --> 00:30:20,159
encryption key but again he said by the
fall so how is that store it's protected

331
00:30:20,160 --> 00:30:26,310
in Firefox is starting a fire that he
shot a 56 of your username underscore FM

332
00:30:26,310 --> 00:30:33,340
OTP I guess stands for Secure does not
need the extra step for being too has

333
00:30:33,340 --> 00:30:40,699
thats fine in Chrome Safari operates is
still in the database under OTP

334
00:30:40,700 --> 00:30:45,900
confining so how is a request for
something he gets injected into the DOM

335
00:30:45,900 --> 00:30:54,760
and let's look at this so how do we get
from the disabled one-time password to

336
00:30:54,760 --> 00:30:57,640
get the ball and it looks like this

337
00:30:57,640 --> 00:31:04,460
the plugging asked local storage as I
mentioned before one-time password was

338
00:31:04,460 --> 00:31:09,090
it has the one-time password what the
plan will do is shuttle 56 of your

339
00:31:09,090 --> 00:31:14,050
username plastic binary version of the
disabled one-time password and they will

340
00:31:14,050 --> 00:31:21,139
rehash that again with a shot to fifty
six of their previous hash + minor

341
00:31:21,140 --> 00:31:26,759
version again he said but one that looks
like a pool remains very much

342
00:31:26,759 --> 00:31:32,259
so let's call that talking ok now .
talking is what it's used to recover

343
00:31:32,259 --> 00:31:37,159
your account together with your username
so what do I get when I take that token

344
00:31:37,159 --> 00:31:48,009
into the request I get this session
decision I do I get the password I get a

345
00:31:48,009 --> 00:31:54,989
parameter that is called PWD deck and
now because I have a budget session all

346
00:31:54,989 --> 00:32:04,999
I have to do that cokie to request that
counts three that PHP and I get think so

347
00:32:04,999 --> 00:32:11,879
but what is the premier what is PWD he
is still not it's not the key to decrypt

348
00:32:11,879 --> 00:32:18,738
any password is not is this seat to the
right of the key to the crib the balky

349
00:32:18,739 --> 00:32:23,719
ok I'm gonna repeat that again is the
seat to the right of the key to decrypt

350
00:32:23,719 --> 00:32:28,789
the balky so we have one encryption key
that is the one used to the crib your

351
00:32:28,789 --> 00:32:38,089
role in that he gets encrypted in your
story in the key to the crib that your

352
00:32:38,089 --> 00:32:47,809
fault he is touring last person that's
kind of what I let's look more than

353
00:32:47,809 --> 00:32:52,819
welcome to crystal passwords note saying
all that so what now what we have here

354
00:32:52,819 --> 00:33:02,589
is the encryption key and I'm gonna hold
key encryption key to your so what are

355
00:33:02,589 --> 00:33:06,099
these simple one time password is
actually a master password on steroids

356
00:33:06,099 --> 00:33:10,569
show with your master password if I
heard you must have box when i try to

357
00:33:10,569 --> 00:33:14,678
log in I'm gonna get prompt for
two-factor authentication if i get if i

358
00:33:14,679 --> 00:33:18,269
buy positive factor authentication there
are still other things like user alert

359
00:33:18,269 --> 00:33:23,239
or IP restrictions things like that that
doesn't happen with a one-time password

360
00:33:23,239 --> 00:33:28,310
I still get a session cooking I can do
everything by passing everything

361
00:33:28,310 --> 00:33:35,659
and this was funny because I was very
pissed because I Stanley the two queries

362
00:33:35,660 --> 00:33:44,530
LLP in order to get the PPW deck right I
still need to take the talking drive it

363
00:33:44,530 --> 00:33:48,389
and Creole P&I don't want to do that and
some of these three months later

364
00:33:48,390 --> 00:33:55,750
actually the disciple one-time password
is the PWD vicky is this I don't need to

365
00:33:55,750 --> 00:34:05,600
pee I already have so how does he think
Christian kid that how that's tacky

366
00:34:05,600 --> 00:34:12,489
equipped to take the disabled one-time
password talking which remember 56 of

367
00:34:12,489 --> 00:34:18,290
the username + the disabled one-time
password and then rehashed again you

368
00:34:18,290 --> 00:34:27,529
apply a shot 256 to it and you the
credible that is so now we need to know

369
00:34:27,530 --> 00:34:32,820
where actually their kid that the crips
your wall his store and its tour

370
00:34:32,820 --> 00:34:36,630
encrypted that's why we needed to the
cryptid in Firefox restoring the file

371
00:34:36,630 --> 00:34:41,830
shuttle 56 username underscore El Pollo
SLPs I guess I stands for Secure that's

372
00:34:41,830 --> 00:34:42,600
not true

373
00:34:42,600 --> 00:34:50,000
increase in Chrome Safari and operates
in a SQL database so there is no need

374
00:34:50,000 --> 00:35:00,570
support the last bus anymore I got it
from here because now from the disabled

375
00:35:00,570 --> 00:35:06,110
one-time password that is stored by
default on your machine I can get a key

376
00:35:06,110 --> 00:35:12,670
that the crips devote a story while I
still need to the crib the ball so I

377
00:35:12,670 --> 00:35:18,170
need to request a vault well-known the
ball is encrypted and stored locally she

378
00:35:18,170 --> 00:35:24,050
can sit down there and in Firefox is
starting to find shuttle 56 username

379
00:35:24,050 --> 00:35:26,480
underscore LPS thought accounts

380
00:35:26,480 --> 00:35:32,210
SXM oh I guess I stands for Secure
that's not fucking true and they're

381
00:35:32,210 --> 00:35:36,210
Chrome Safari Opera House brokers that
data bases

382
00:35:36,210 --> 00:35:42,320
awesome so we located the talking we
know how to have shit we get the wrong

383
00:35:42,320 --> 00:35:47,109
key decryption key then we get the ball
with a critic of all key in with a

384
00:35:47,109 --> 00:35:54,509
credible and this is all there already
is using to action either on the last on

385
00:35:54,510 --> 00:36:00,770
the client-side awesome so after all
this that I told you I did out to made

386
00:36:00,770 --> 00:36:06,500
at all for you so I wrote Metasploit
module and that's already pressing

387
00:36:06,500 --> 00:36:11,339
matters pro but just a part of the crips
the master password because that's the

388
00:36:11,339 --> 00:36:17,869
initial research that within right so
I'm still working on the rest I am gonna

389
00:36:17,869 --> 00:36:21,349
do with them now and I will be sometime
couple of weeks while recovering from

390
00:36:21,349 --> 00:36:25,010
the hangover of this week and all that I
will upload it there so you guys can

391
00:36:25,010 --> 00:36:28,010
check it out and play with it and
basically did not sit still to prove

392
00:36:28,010 --> 00:36:31,900
they must proposal for you it stays the
two-factor authentication talking it

393
00:36:31,900 --> 00:36:36,400
still think Christian key it across the
entire wall for you

394
00:36:36,400 --> 00:36:40,780
it supports Windows Mac UNIX a mode that
Internet Explorer is consuming all that

395
00:36:40,780 --> 00:36:51,800
so let's do a quick demo now for you
guys ok let's see if it works

396
00:36:51,800 --> 00:37:05,270
appreciate their ok so what we're going
to do I'm going to use of this already

397
00:37:05,270 --> 00:37:10,480
setup so basically for the dama what we
have is this we have Charlie Sheen with

398
00:37:10,480 --> 00:37:14,890
one machine and what he did in his
machine is he has his personal last bus

399
00:37:14,890 --> 00:37:20,379
account he has a corporate account set
up on his machine he has to last but

400
00:37:20,380 --> 00:37:23,230
then his grand party guy that was from
Galicia

401
00:37:23,230 --> 00:37:29,369
he wanted to use a computer to in check
out internet so he created an account on

402
00:37:29,369 --> 00:37:39,550
his machine so we have two accounts from
windows and then we have to last post a

403
00:37:39,550 --> 00:37:48,410
comment on Charlie Sheen's account and
last but not least five

404
00:37:48,410 --> 00:38:00,470
right okay with that said what a bit and
activities I sent to challenge me what

405
00:38:00,470 --> 00:38:04,680
can you say Charlie Sheen I guess three
Bri I sent him a phishing email for

406
00:38:04,680 --> 00:38:13,009
example I mean that guy in answer is
very busy I mean ok so let's say he

407
00:38:13,010 --> 00:38:40,920
executed I write you guys know how to
use this so I can get this setup ok ok

408
00:38:40,920 --> 00:38:46,510
so background so what do we want to do
we want to use the poster for the Asian

409
00:38:46,510 --> 00:38:50,720
model does that I wrote and for that we
are going to say we're going to use up

410
00:38:50,720 --> 00:38:53,290
posters for their show more

411
00:38:53,290 --> 00:38:59,190
that he works actually all platforms and
what he does is he gathers all the last

412
00:38:59,190 --> 00:39:12,850
bus data ok ok very get me feel so how
these modern look like always gotta

413
00:39:12,850 --> 00:39:16,330
provide a salad session that's all
that's all he needs and I will do

414
00:39:16,330 --> 00:39:25,799
everything for you so I got a US mission
7 set-ups are you guys ready for it and

415
00:39:25,800 --> 00:39:33,010
I conceive that so it's searching now
everywhere for the last by said that

416
00:39:33,010 --> 00:39:38,250
basis it found that amazing shows now
looking for credentials now it's

417
00:39:38,250 --> 00:39:49,440
extracting the two-factor authentication
tokens and 321 321 there you go guys

418
00:39:49,440 --> 00:40:11,220
Windows account and this is the username
of your account with his shin investors

419
00:40:11,220 --> 00:40:16,270
he didn't start the password because he
had underpriced account and easy then

420
00:40:16,270 --> 00:40:21,270
allowed to do that tomorrow because we
used to disable a one-time password to

421
00:40:21,270 --> 00:40:27,430
get the last bus encryption key might
mean the world and we also got for free

422
00:40:27,430 --> 00:40:31,368
the two-factor authentication for the
rest of what's even easier because they

423
00:40:31,369 --> 00:40:37,819
don't even need to use the disabled
one-time password I just use they clear

424
00:40:37,819 --> 00:40:42,770
thanks master password to the right
encryption key show these guess you

425
00:40:42,770 --> 00:40:46,390
everything you need to the crib the
vault and obviously gets you going bald

426
00:40:46,390 --> 00:40:56,379
us well awesome let's go back to the
presentation I guess I don't need to cry

427
00:40:56,380 --> 00:41:02,180
at night this guy this was the most
difficult / of all the talk you know why

428
00:41:02,180 --> 00:41:10,379
you know how difficult I mean why would
this guy cry yes the best life ever and

429
00:41:10,380 --> 00:41:21,510
I think he's actually laughing here
that's why I agree I agree so ok so just

430
00:41:21,510 --> 00:41:25,550
last one last thing I show you all of
this is really cool really cool but how

431
00:41:25,550 --> 00:41:29,640
about you know disabled want to work
there is no access to the machine there

432
00:41:29,640 --> 00:41:35,629
is no explode and there's absolutely
nothing but you still want passwords so

433
00:41:35,630 --> 00:41:40,190
you can use Google you get a password
you gave us when everyone gets a

434
00:41:40,190 --> 00:41:46,500
password remember when we talked about
Firefox remember impress the GOS the

435
00:41:46,500 --> 00:41:50,030
credential is where they Kripa
credentials which store the condenser

436
00:41:50,030 --> 00:41:56,790
that you now know how to decrypt it
turns out the people to the internet and

437
00:41:56,790 --> 00:42:00,440
they do that because they are stupid or
bars the break

438
00:42:00,440 --> 00:42:01,710
Firefox

439
00:42:01,710 --> 00:42:06,680
then they operate without to get help so
you only need to look for that you will

440
00:42:06,680 --> 00:42:21,348
find people are proposing that last post
credentials level is really the end I

441
00:42:21,349 --> 00:42:25,790
picked this Google door because he's the
one that has the least a result in most

442
00:42:25,790 --> 00:42:29,250
of them is on Windows using protective
storage so you can decrypt them but

443
00:42:29,250 --> 00:42:36,910
you'll still find ballot-stuffing I told
me to let the guys know they shouldn't

444
00:42:36,910 --> 00:42:43,970
be using personal GPS to store all the
information you need to the crib LPD

445
00:42:43,970 --> 00:42:48,390
because then this happens and from what
they told me they met next major release

446
00:42:48,390 --> 00:42:53,740
they will change that so what is my
camera stopped sharing your credentials

447
00:42:53,740 --> 00:42:59,379
with the rest of the world you don't
want to do that so just to finish to

448
00:42:59,380 --> 00:43:03,560
talk I wanted to give a little bit of
sense of what we can do to try to

449
00:43:03,560 --> 00:43:09,310
prevent stuff like that so that you can
do is very easy to use the final version

450
00:43:09,310 --> 00:43:12,700
of the plugin disorder what we do we go
to the chrome store things like that to

451
00:43:12,700 --> 00:43:26,950
install the plug-in for browsers you can
download a binary version of windows for

452
00:43:26,950 --> 00:43:32,629
all browsers Linux it won't use anything
do not start your master password pretty

453
00:43:32,630 --> 00:43:36,369
obvious disabled account recovery I mean
you guys are smart enough to remember

454
00:43:36,369 --> 00:43:40,740
your password so you don't need this and
you don't want to have that do not use

455
00:43:40,740 --> 00:43:41,819
password reminder

456
00:43:41,820 --> 00:43:47,460
activate two-factor authentication I
mean we just told you how to bypass it

457
00:43:47,460 --> 00:43:52,839
but still a good idea from master
password to make prosperous miserable

458
00:43:52,839 --> 00:43:55,820
and I'm highlighting here are some of
the things I maybe people are not aware

459
00:43:55,820 --> 00:44:00,520
of but if I loved your machine someone
just need to click on the planning and

460
00:44:00,520 --> 00:44:05,290
getting tired but you can have it still
prompt for the master password before

461
00:44:05,290 --> 00:44:09,270
showing the passwords right so that's
always a good idea and then you cannot

462
00:44:09,270 --> 00:44:12,500
come to restrictions if you just live in
the USA

463
00:44:12,500 --> 00:44:17,440
never trouble I didn't run to my apt
Katie of 22 ratio is this is getting

464
00:44:17,440 --> 00:44:20,790
very paranoid but it never hurts you
don't know if they have been for years

465
00:44:20,790 --> 00:44:29,920
doing ramble tables 1 500 rounds and
thus allow it or not and that's all I

466
00:44:29,920 --> 00:44:33,890
have Mahalo thanks a lot to Chaka Khan
this is awesome conference I really

467
00:44:33,890 --> 00:44:47,520
loved it and if you have any questions
to take them finish my drink any

468
00:44:47,520 --> 00:44:58,710
questions

469
00:44:58,710 --> 00:45:04,510
honestly if you have an encrypted USB
probably everything to the crib they

470
00:45:04,510 --> 00:45:09,640
will also be there so everything applies
in addition it's more likely to lose so

471
00:45:09,640 --> 00:45:14,750
what I will recommend is what I
mentioned the previous like I do I do

472
00:45:14,750 --> 00:45:27,730
use can I say now I did you suspect I
will continue using it so that's also

473
00:45:27,730 --> 00:45:30,930
another reason why I look at it and I
think it's it's a good idea we need a

474
00:45:30,930 --> 00:45:38,270
password managers you want to get a
little more security issues off like any

475
00:45:38,270 --> 00:45:39,060
other questions

476
00:45:39,060 --> 00:45:44,910
alright I guess I was information thank
you

