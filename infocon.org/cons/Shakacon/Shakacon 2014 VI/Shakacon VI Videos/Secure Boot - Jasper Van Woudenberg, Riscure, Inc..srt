1
00:00:03,999 --> 00:00:07,410
started again tight schedule so lets on

2
00:00:07,410 --> 00:00:11,349
so this is II yes for not gonna say last
name again

3
00:00:11,349 --> 00:00:15,120
his BSc tale North America for riskier
and

4
00:00:15,120 --> 00:00:19,769
really nice nice enough to step in had
presentations in his back pocket

5
00:00:19,769 --> 00:00:23,880
as indicated on about 30 minutes we have
30 minutes and five minutes for Q&A

6
00:00:23,880 --> 00:00:26,649
no go on to the next one like I said
I'll probably eat up a little bit a

7
00:00:26,649 --> 00:00:28,489
break and I have talked to Brian about

8
00:00:28,489 --> 00:00:31,380
starting his talk a little bit later I
think it would be well worth it so

9
00:00:31,380 --> 00:00:31,999
please help

10
00:00:31,999 --> 00:00:38,998
me give a warm welcome to ask for thank
you thank you he that so my name is

11
00:00:41,920 --> 00:00:44,700
actually pronounce just for fun car or

12
00:00:44,700 --> 00:00:49,140
I'm originally that so that Sam that's
the official pronunciation

13
00:00:49,140 --> 00:00:53,210
and yeah I had to cut on my talk a
little bit so originally it was twenty

14
00:00:53,210 --> 00:00:56,670
ways fast secure boot but I'm

15
00:00:56,670 --> 00:00:59,740
well just by the mighty hand of God I
made 10

16
00:00:59,740 --> 00:01:04,659
waste just magically disappear so

17
00:01:04,659 --> 00:01:09,119
will talk about anyways I'm pasa care
both so

18
00:01:09,119 --> 00:01:12,590
just an overview of my talk all I'm of
Earth give an introduction on what

19
00:01:12,590 --> 00:01:13,850
secure boot is

20
00:01:13,850 --> 00:01:17,280
I'm maybe prizes hands who knows what it
is

21
00:01:17,280 --> 00:01:21,880
secure boot who knows what it is but
then raises hand

22
00:01:21,880 --> 00:01:25,429
okay we've got a few and

23
00:01:25,429 --> 00:01:29,170
so I'll I'll split it up into two main
categories: one is the

24
00:01:29,170 --> 00:01:32,319
more logical threats which is the threat
you're probably more

25
00:01:32,319 --> 00:01:35,380
for Miller with and then I'll talk about
are correlated

26
00:01:35,380 --> 00:01:38,770
threats I'm so I work for a company
called

27
00:01:38,770 --> 00:01:42,109
risk here I'm in CT 0 for North American
office

28
00:01:42,109 --> 00:01:46,369
and we deal in a nutshell with embedded
security

29
00:01:46,369 --> 00:01:50,340
so what kind of threats the get
additionally when

30
00:01:50,340 --> 00:01:53,619
all of a sudden attacker can hold your
device in their hands

31
00:01:53,619 --> 00:01:57,159
and a lot of people think that security
completely break down at that point but

32
00:01:57,159 --> 00:02:02,560
I'm I would argue with that to act that
I've been testing all kinds of

33
00:02:02,560 --> 00:02:05,829
devices and list them out all I'm

34
00:02:05,829 --> 00:02:09,728
some originally from from Amsterdam
either background in

35
00:02:09,729 --> 00:02:13,920
ball pen testing but also computer
science and artificial intelligence

36
00:02:13,920 --> 00:02:18,540
I'm well

37
00:02:18,540 --> 00:02:22,000
let's get started so offer stock

38
00:02:22,000 --> 00:02:27,410
hopeful back to collect the

39
00:02:27,410 --> 00:02:30,760
so going to be talking about secure
boots

40
00:02:30,760 --> 00:02:34,579
I'm specifically in embedded devices
that the space that we operated

41
00:02:34,580 --> 00:02:38,590
I'm not specifically talking about the
UEFI are marked

42
00:02:38,590 --> 00:02:43,660
lockdown or things like that I'm but it
doesn't I mean that it doesn't apply

43
00:02:43,660 --> 00:02:47,290
so it's the same types mechanism that
are are being used their

44
00:02:47,290 --> 00:02:50,329
I'm and there's actually an interesting

45
00:02:50,330 --> 00:02:54,420
I'm parallel there decreasing in the PC
world

46
00:02:54,420 --> 00:02:57,929
have an open if you are I'm old enough
like me

47
00:02:57,930 --> 00:03:01,310
to all notice on

48
00:03:01,310 --> 00:03:05,500
to remember Dolce & boot sector virus
today

49
00:03:05,500 --> 00:03:08,780
so one of them

50
00:03:08,780 --> 00:03:12,520
the ideas behind a boot sector buyers as
you actually load yourself before the

51
00:03:12,520 --> 00:03:13,640
antivirus close

52
00:03:13,640 --> 00:03:17,399
so that way you can defeat any of the
mechanisms in there

53
00:03:17,400 --> 00:03:22,230
and that's actually I'm what I like to
call it ever raced to the start

54
00:03:22,230 --> 00:03:25,230
so you'll see that a lot in in

55
00:03:25,230 --> 00:03:29,510
in all embedded device but also on the
PC that if you're malware

56
00:03:29,510 --> 00:03:33,700
you wanna go to 48 fires your antivirus
gonna put before the mail works it is

57
00:03:33,700 --> 00:03:34,109
this

58
00:03:34,110 --> 00:03:37,510
race going to to the start I'm

59
00:03:37,510 --> 00:03:42,160
Sony PC world to seeing it lot of things
happening with walking down by else

60
00:03:42,160 --> 00:03:46,410
so it can be changed anymore signature
verification CUFI

61
00:03:46,410 --> 00:03:49,620
but I said I was going to talk about
that

62
00:03:49,620 --> 00:03:53,380
let's go to bed lights I'm it's actually

63
00:03:53,380 --> 00:03:57,980
pretty much in most consumer electronics
nowadays

64
00:03:57,980 --> 00:04:01,200
you'll see secure boot so you see it in
your game console

65
00:04:01,200 --> 00:04:04,760
sitting here mobile phone believe
unseating year

66
00:04:04,760 --> 00:04:08,399
that's a ECU on the bottom right there
I'm

67
00:04:08,400 --> 00:04:12,200
set a box for at this at the TV at

68
00:04:12,200 --> 00:04:15,069
all these devices have some kind of
security function that they're trying to

69
00:04:15,069 --> 00:04:15,709
protect

70
00:04:15,710 --> 00:04:20,340
and one of the mess mechanisms to do
that to prevent the Senate race 2 starts

71
00:04:20,339 --> 00:04:21,388
to make sure that

72
00:04:21,389 --> 00:04:24,840
at least you're booting authenticated
code

73
00:04:24,840 --> 00:04:28,150
so that way you can control what code is
on your platform

74
00:04:28,150 --> 00:04:32,349
a can I'm yep prevent harm

75
00:04:32,350 --> 00:04:35,450
against your security so

76
00:04:35,450 --> 00:04:38,479
who really wants this kinda secure boot
well

77
00:04:38,480 --> 00:04:41,980
it is kind of a double-edged sword
especially you guys are a bit from

78
00:04:41,980 --> 00:04:43,250
hacker community as well

79
00:04:43,250 --> 00:04:47,910
I'm you wanna run all your own code on
your device

80
00:04:47,910 --> 00:04:51,350
they want to be able to actually break
your booth load everything you want

81
00:04:51,350 --> 00:04:55,889
a there's a downside to that as well
though if you

82
00:04:55,889 --> 00:05:00,080
lose your phone you don't have something
like secured with and all the other

83
00:05:00,080 --> 00:05:01,159
security mechanisms

84
00:05:01,160 --> 00:05:05,870
I don't know what you guys might gmail
account and all that stuff is linked to

85
00:05:05,870 --> 00:05:06,840
my phone with

86
00:05:06,840 --> 00:05:11,690
could knows link up to all my password
recovery mechanisms

87
00:05:11,690 --> 00:05:15,660
I'm so it it is also there to protect
you

88
00:05:15,660 --> 00:05:19,060
at the same time it's also there to
protect a to

89
00:05:19,060 --> 00:05:22,540
business case for the appliance for the
device vendors they want to make sure

90
00:05:22,540 --> 00:05:24,840
that the IP is not stolen

91
00:05:24,840 --> 00:05:28,659
they want to make sure that only
authenticated code

92
00:05:28,660 --> 00:05:33,580
is running on their devices how to
implement things like anti roll back to

93
00:05:33,580 --> 00:05:38,150
pic only when the security patch comes
out only the referrals can be wrong

94
00:05:38,150 --> 00:05:41,810
so I don't get into a whole political
discussion but

95
00:05:41,810 --> 00:05:45,360
this on secure boot camp using

96
00:05:45,360 --> 00:05:50,389
in different ways

97
00:05:50,389 --> 00:05:53,620
so the idea behind it is that

98
00:05:53,620 --> 00:05:57,990
I'm we start off in when when a
processor comes up

99
00:05:57,990 --> 00:06:02,030
you start up in an environment that's
I'm really hard to change

100
00:06:02,030 --> 00:06:07,239
thoughts happen soon as a CPU comes up
like to start putting on coat first

101
00:06:07,240 --> 00:06:10,530
first thing that wrong as the nine name
implies

102
00:06:10,530 --> 00:06:14,460
read only memory was really hard to to
modify an issue

103
00:06:14,460 --> 00:06:19,270
get into the chip itself physically
start modifying data roam

104
00:06:19,270 --> 00:06:23,320
so you can be pretty well here that
that's

105
00:06:23,320 --> 00:06:29,000
at least against non-government I
Packers that that's pretty secure

106
00:06:29,000 --> 00:06:32,370
so that internal boo drum does its only
purpose in life

107
00:06:32,370 --> 00:06:35,690
is to load the external firmer from flat

108
00:06:35,690 --> 00:06:39,719
for UMC year what not and verified
digital signature

109
00:06:39,720 --> 00:06:42,760
at so I can make sure that the flash
estimate

110
00:06:42,760 --> 00:06:47,210
is authentic before it even runs that
cup

111
00:06:47,210 --> 00:06:51,760
I'm now for various reasons they're
hugely multiple stages of these

112
00:06:51,760 --> 00:06:56,099
the bootloaders and at some point the
light last bootloader is in charge of

113
00:06:56,100 --> 00:06:57,260
loading the

114
00:06:57,260 --> 00:07:02,030
I'm the OS 2008 as a charter loading
application so this whole

115
00:07:02,030 --> 00:07:05,859
sharing of trust that you can build this
way

116
00:07:05,860 --> 00:07:12,860
where one component just checked the
next two checks the next six the next

117
00:07:13,510 --> 00:07:16,760
that is one example a secure boot on a

118
00:07:16,760 --> 00:07:19,760
not common and work platforms so if you
have a

119
00:07:19,760 --> 00:07:23,880
phone or tablet in your pocket runs
Android you'll see something

120
00:07:23,880 --> 00:07:27,500
you could see something like this so

121
00:07:27,500 --> 00:07:30,790
for several internal good wrong loads
which flowed

122
00:07:30,790 --> 00:07:34,270
for statehood loader which typically
proprietary for

123
00:07:34,270 --> 00:07:37,810
whatever platform you have I'm

124
00:07:37,810 --> 00:07:40,830
somewhere down the line if they're using
u-boot

125
00:07:40,830 --> 00:07:45,080
know if you guys know you you put it
it's an open source

126
00:07:45,080 --> 00:07:48,349
bootloader for embedded devices I'm

127
00:07:48,350 --> 00:07:53,120
you can use that to larger and cruel

128
00:07:53,120 --> 00:07:57,139
another interesting thing here is that
not only is key to boot loader and

129
00:07:57,139 --> 00:07:57,630
charger

130
00:07:57,630 --> 00:08:02,940
loading in x1 what's actually also in
charge of walking on this earth

131
00:08:02,940 --> 00:08:07,650
so a lot of security features in
hardware and software are configured

132
00:08:07,650 --> 00:08:11,489
during boot so the first piece of code
that loads with all privileges on the

133
00:08:11,490 --> 00:08:12,699
entire pot for

134
00:08:12,699 --> 00:08:16,130
you can access all memory you can access
all

135
00:08:16,130 --> 00:08:20,630
hardware but somewhere down the line you
can outlaw about

136
00:08:20,630 --> 00:08:24,509
so you'll see that happening during
during good

137
00:08:24,509 --> 00:08:27,600
I'm who who knows

138
00:08:27,600 --> 00:08:32,599
press on it get blinded

139
00:08:32,599 --> 00:08:37,250
so trust someone is actually AM probably
in your pocket

140
00:08:37,250 --> 00:08:42,360
a lot of angered phones at least arm
platforms have this feature

141
00:08:42,360 --> 00:08:45,980
and it is a a heart were featured at
fertilizes

142
00:08:45,980 --> 00:08:50,940
one of the CPU's into a secure rolled
and a non-secure world

143
00:08:50,940 --> 00:08:54,380
and I can talk a lot about that as well
that's not what this talk is about

144
00:08:54,380 --> 00:08:58,529
a that keep in mind that this in the
secure World they're actually a

145
00:08:58,529 --> 00:08:59,589
completely

146
00:08:59,589 --> 00:09:04,300
a separate OS running their so there's
an OS that you're not gonna see

147
00:09:04,300 --> 00:09:07,899
that's running web sites and

148
00:09:07,899 --> 00:09:12,470
on and in the secure World you just have
a lot more privileges and

149
00:09:12,470 --> 00:09:15,850
in an oscar wilde that's what you get to
keep my pretty stock

150
00:09:15,850 --> 00:09:19,160
so the ideas you'll start of a secure
world

151
00:09:19,160 --> 00:09:23,579
mm month a once you're ready
initializing a locking down

152
00:09:23,580 --> 00:09:26,720
you load you vote or Android which will
then run into

153
00:09:26,720 --> 00:09:31,050
in the normal

154
00:09:31,050 --> 00:09:34,300
now have been talking about secure boot
dozen

155
00:09:34,300 --> 00:09:37,380
making sure to clear up indicated code

156
00:09:37,380 --> 00:09:40,860
which of course doesn't mean that the
authentic code is perfect

157
00:09:40,860 --> 00:09:45,100
so just having secure boot is not a
sufficient condition for having a secure

158
00:09:45,100 --> 00:09:46,330
platform

159
00:09:46,330 --> 00:09:49,740
but it's definitely a necessary
condition for having us platform so

160
00:09:49,740 --> 00:09:53,279
if somebody has an exploding usual and
they could still pop that and

161
00:09:53,279 --> 00:09:57,950
elevated privileges I'm it gets harder
when you have to

162
00:09:57,950 --> 00:10:01,130
circumvent heart security privileges so
it

163
00:10:01,130 --> 00:10:05,550
it might be easy to get from userspace
into kernel space by

164
00:10:05,550 --> 00:10:08,800
have been exploiting your in a kernel
driver but

165
00:10:08,800 --> 00:10:12,099
going from I'm in office

166
00:10:12,100 --> 00:10:15,330
from normal building trust onto secure
world

167
00:10:15,330 --> 00:10:18,550
that that's a bit harder you to do that
through

168
00:10:18,550 --> 00:10:22,810
heart exported anyway if he thinks pale

169
00:10:22,810 --> 00:10:26,130
I'm yup possibly

170
00:10:26,130 --> 00:10:30,730
arbitrary code execution sometimes
enough persistent attacks

171
00:10:30,730 --> 00:10:34,899
so Francis if I'm securing your bouquet

172
00:10:34,899 --> 00:10:38,330
a flash upgrade is locked out

173
00:10:38,330 --> 00:10:41,959
than normally down detain you can right
to flash anymore

174
00:10:41,959 --> 00:10:45,000
but if you can do that earlier on the
4th logged on you could have some our

175
00:10:45,000 --> 00:10:45,890
persistence

176
00:10:45,890 --> 00:10:51,010
who's there I'm and it's going to be a
stepping stone for terror attacks so

177
00:10:51,010 --> 00:10:54,510
if you're able to inject code may be
able to dump out

178
00:10:54,510 --> 00:11:01,510
on some previously inaccessible member
areas

179
00:11:01,540 --> 00:11:04,599
so let's go through to the logical for
its

180
00:11:04,600 --> 00:11:10,010
so one of the things and these are kinda
based on things that we see

181
00:11:10,010 --> 00:11:14,250
I'm in general what we're doing he's
going to be valuations of

182
00:11:14,250 --> 00:11:17,370
secure boot I'm at

183
00:11:17,370 --> 00:11:20,399
lot have a look here being able to
scratch out the 10

184
00:11:20,399 --> 00:11:24,790
least interesting ones my pings are we
get the ten best songs here

185
00:11:24,790 --> 00:11:28,160
I'm one other things is when you're
doing a

186
00:11:28,160 --> 00:11:32,350
for upgrade you gotta make sure you're
actually also doing this kind of

187
00:11:32,350 --> 00:11:33,920
signature verification of

188
00:11:33,920 --> 00:11:39,319
over to for rent not just on boat but
also when you doing upgraded

189
00:11:39,320 --> 00:11:43,589
I'm i've seen I'm

190
00:11:43,589 --> 00:11:47,660
i've seen issues in I'm the way that the
firmware was

191
00:11:47,660 --> 00:11:51,110
structured which parts were actually
signed

192
00:11:51,110 --> 00:11:55,880
and order differences Falcons a weird
stop

193
00:11:55,880 --> 00:11:59,510
it's something they really look at when
you're doing I'm I'm

194
00:11:59,510 --> 00:12:03,580
you know flashing code I'm

195
00:12:03,580 --> 00:12:06,850
one of the main things here soon you
wanna make sure if you don't put too

196
00:12:06,850 --> 00:12:08,010
much functionality

197
00:12:08,010 --> 00:12:13,680
here for for upgrade just make it down
that emitted your flat

198
00:12:13,680 --> 00:12:17,380
after doing a signature verification and
that's it

199
00:12:17,380 --> 00:12:22,779
on one thing to take into account of a
roll-back

200
00:12:22,779 --> 00:12:26,910
so rollback is the ideas you have and
authenticated firmware

201
00:12:26,910 --> 00:12:30,699
you find a bug in it so as a vendor you
want to I'm greater role to the new

202
00:12:30,700 --> 00:12:31,820
version

203
00:12:31,820 --> 00:12:35,850
by your attacker would like to use the
old version with the fuck did

204
00:12:35,850 --> 00:12:40,410
I'm so there are ways where you can make
sure that the only role

205
00:12:40,410 --> 00:12:43,709
forward to newer versions and never
backed it all versions

206
00:12:43,709 --> 00:12:47,819
even though did signatures still valid

207
00:12:47,820 --> 00:12:50,970
and nothing I'm

208
00:12:50,970 --> 00:12:56,140
that you want to take into account this
if you have debugging functionality

209
00:12:56,140 --> 00:13:00,459
pick you do not need in the field it's
actually useful to have

210
00:13:00,459 --> 00:13:04,500
all that stuff disabled in your
production build

211
00:13:04,500 --> 00:13:08,510
and have a separate you know internal
matter actor only

212
00:13:08,510 --> 00:13:11,839
field that is signed and that has to be
perfect

213
00:13:11,839 --> 00:13:15,390
building because and even if somebody
breaks security mechanism that can

214
00:13:15,390 --> 00:13:18,439
taxed those and people Peterson field

215
00:13:18,440 --> 00:13:23,589
still need to keep it be back for
internal of course

216
00:13:23,589 --> 00:13:27,890
I'm other things we've seen is them

217
00:13:27,890 --> 00:13:31,069
boot code is getting pretty bloated
nowadays

218
00:13:31,070 --> 00:13:35,310
so that more and more functionality is
added and what we are all aware

219
00:13:35,310 --> 00:13:39,599
security here more functionality is
means more probability they're gonna

220
00:13:39,600 --> 00:13:42,839
have a coating mistake somewhere I'm

221
00:13:42,839 --> 00:13:46,839
and there's actually there's a there's a
drive for this who want to boot from all

222
00:13:46,839 --> 00:13:48,950
kinds of different media

223
00:13:48,950 --> 00:13:52,970
don't have restore mechanisms fallback
mechanism

224
00:13:52,970 --> 00:13:57,140
for upgrade maker in the solvent built
into your book code

225
00:13:57,140 --> 00:14:01,689
I'm but you get the traditional logical
problems like

226
00:14:01,690 --> 00:14:05,170
buffer overflows I'm problems overflows

227
00:14:05,170 --> 00:14:08,540
etcetera and that I put a couple up

228
00:14:08,540 --> 00:14:12,449
links appear where you can find these
things

229
00:14:12,450 --> 00:14:16,600
I'm yesterday with the cases are also
the traditional ones we've had a

230
00:14:16,600 --> 00:14:21,160
a couple of interesting talks about
posing as into politics execution

231
00:14:21,160 --> 00:14:25,540
but also code review to you manana
inspection helps

232
00:14:25,540 --> 00:14:29,579
and of course trying to really limit the
functionality to what you need

233
00:14:29,579 --> 00:14:35,310
there's also a way to them get this

234
00:14:35,310 --> 00:14:39,518
I'm is one of my amp

235
00:14:39,519 --> 00:14:43,250
one of my favorite ones so

236
00:14:43,250 --> 00:14:49,380
like ripped out I'm other things that
people don't always realize that a few

237
00:14:49,380 --> 00:14:54,060
encrypt the firmware that doesn't mean
that its integrity protected

238
00:14:54,060 --> 00:14:58,540
just means that an attacker cannot
easily see what the code is

239
00:14:58,540 --> 00:15:02,930
but if he did flip a bit and encrypt it

240
00:15:02,930 --> 00:15:06,239
a firmware there may be a predictable
effect

241
00:15:06,240 --> 00:15:10,070
in the be corrected version prince is a
really

242
00:15:10,070 --> 00:15:13,200
I'm cool examples appear using

243
00:15:13,200 --> 00:15:17,040
ASA CBC mode I'm so it's just the way

244
00:15:17,040 --> 00:15:20,360
if you may be no estás texting 16 bytes

245
00:15:20,360 --> 00:15:25,760
encryption and output 16 bytes but I for
lesbian 16 bytes so we need to somehow

246
00:15:25,760 --> 00:15:28,390
apply a yes to the whole thing

247
00:15:28,390 --> 00:15:32,740
I'm tepid these different chaining mode
since CBC is one of them

248
00:15:32,740 --> 00:15:36,070
I'm at CBC actually has the property
that

249
00:15:36,070 --> 00:15:39,190
if I Indian cricket version

250
00:15:39,190 --> 00:15:42,370
that I you know supposedly I can read
what the actual

251
00:15:42,370 --> 00:15:46,970
code there's if I flip a bit there I'm
going to have

252
00:15:46,970 --> 00:15:51,320
in to be cryptic version I'm gonna
happen one block that's entirely garbled

253
00:15:51,320 --> 00:15:55,639
16 bytes will be garbled but in the next
block

254
00:15:55,639 --> 00:15:58,660
I'm gonna have exactly that same bit
flip the same

255
00:15:58,660 --> 00:16:02,230
in that that's a very predictable effect
in my

256
00:16:02,230 --> 00:16:07,130
I think this version and all the other
books are not affected

257
00:16:07,130 --> 00:16:10,839
so you can imagine if I now do that too

258
00:16:10,839 --> 00:16:14,730
but that's a 3some unexploited did
minutes get a dump of this

259
00:16:14,730 --> 00:16:18,209
this for so I can only read it

260
00:16:18,209 --> 00:16:22,910
and I can only write think that version
but now if i find some

261
00:16:22,910 --> 00:16:27,060
interesting security check security
checks always end with some traditional

262
00:16:27,060 --> 00:16:28,060
brands

263
00:16:28,060 --> 00:16:31,479
know it if been accepted into this

264
00:16:31,480 --> 00:16:36,829
or signature accepted it is otherwise
that that's a conditional instruction

265
00:16:36,829 --> 00:16:41,329
now I can start flipping bits in that
condition instruction

266
00:16:41,329 --> 00:16:45,888
very predictably my just saying
hypertext and I will garble 16 bytes

267
00:16:45,889 --> 00:16:46,970
before that

268
00:16:46,970 --> 00:16:50,050
but if that's in some different function
princess

269
00:16:50,050 --> 00:16:53,209
who cares so really

270
00:16:53,209 --> 00:16:57,719
I'm I'm bokep those hard

271
00:16:57,720 --> 00:17:00,930
you know and

272
00:17:00,930 --> 00:17:04,388
you really want to make sure it's also
do a I'm

273
00:17:04,388 --> 00:17:07,510
integrity check beyond your encryption

274
00:17:07,510 --> 00:17:11,059
so first verified the integrity of the
for

275
00:17:11,059 --> 00:17:14,559
in cryptic for and then the critics I'm

276
00:17:14,559 --> 00:17:18,928
you can also use different mods besides
CBS ABC like a

277
00:17:18,929 --> 00:17:22,500
TCM which is an authenticated cipher

278
00:17:22,500 --> 00:17:26,260
so it has authentication and encryption
built into

279
00:17:26,260 --> 00:17:30,809
into one

280
00:17:30,809 --> 00:17:34,910
trusting her is actually an interesting
one because

281
00:17:34,910 --> 00:17:38,809
your program it's gonna have some
structure with with headers and

282
00:17:38,809 --> 00:17:41,928
sizes blocks all those kinda things

283
00:17:41,929 --> 00:17:46,179
I'm usually does blocks for sign
individually

284
00:17:46,179 --> 00:17:50,320
fine I'm a problem with that is though
is that

285
00:17:50,320 --> 00:17:53,490
in order to parse those headers

286
00:17:53,490 --> 00:17:57,610
to find out what a signature is you need
to parse the head

287
00:17:57,610 --> 00:18:01,428
which is at that point still unverified
data you haven't verified the signature

288
00:18:01,429 --> 00:18:02,799
overdid

289
00:18:02,799 --> 00:18:07,010
is a bit of a chicken-and-egg problem
going on there a

290
00:18:07,010 --> 00:18:10,309
so you run a really make sure that you

291
00:18:10,309 --> 00:18:13,960
I'm before doing the signature check

292
00:18:13,960 --> 00:18:17,760
you are really sure it all the length
and all the pointers and stuff are

293
00:18:17,760 --> 00:18:18,730
within

294
00:18:18,730 --> 00:18:22,160
the bouncy you expect it to be so
there's no malicious input their

295
00:18:22,160 --> 00:18:26,130
because you cannot check the signature
on it yet you gotta do some extra

296
00:18:26,130 --> 00:18:32,040
verification that there's no malicious
stated

297
00:18:32,040 --> 00:18:35,409
sup let's move on to the hard related
threads

298
00:18:35,410 --> 00:18:40,440
they're getting more more interesting
earned a

299
00:18:40,440 --> 00:18:44,860
so water I'm

300
00:18:44,860 --> 00:18:47,540
things that people in sulfur don't
always realize is that there's no such

301
00:18:47,540 --> 00:18:50,190
thing as hardware debugging

302
00:18:50,190 --> 00:18:54,429
I'm date exactly standard for doing
hardcore debugging

303
00:18:54,429 --> 00:18:59,450
and it can allow for low-level control
your excuse

304
00:18:59,450 --> 00:19:02,080
just like they would have been like a
kernel debugger or something but

305
00:19:02,080 --> 00:19:04,668
actually it one step lower at the
hardware level

306
00:19:04,669 --> 00:19:08,010
so I can suspend the process second
singles

307
00:19:08,010 --> 00:19:12,260
bed I can actually scanned figure out
what all the states of that

308
00:19:12,260 --> 00:19:16,340
pains are on a tip as well so the lot of
them

309
00:19:16,340 --> 00:19:19,730
I'm control it to get with up with these

310
00:19:19,730 --> 00:19:22,780
that the hardware debugging mechanisms
I'm

311
00:19:22,780 --> 00:19:26,590
and their pretty much from every device
and

312
00:19:26,590 --> 00:19:30,159
so did difference things that
manufactures do our

313
00:19:30,160 --> 00:19:33,370
in low the worst things

314
00:19:33,370 --> 00:19:36,639
this leave the complete head around on
the peace be so honoured

315
00:19:36,640 --> 00:19:41,760
plug into it and they're done the next
step that I've seen as they remove the

316
00:19:41,760 --> 00:19:46,200
the header so we have to resort to
Heather of bernhard

317
00:19:46,200 --> 00:19:50,890
I'm gets a little bit harder when they
remove the PCB traces

318
00:19:50,890 --> 00:19:54,490
so gay sex are actually physical
paintings that are coming out of the

319
00:19:54,490 --> 00:19:58,830
the chip so one of the tricks

320
00:19:58,830 --> 00:20:03,110
and did this doesn't work always anymore
but and you can actually start

321
00:20:03,110 --> 00:20:06,889
we noted pins that there are now two
tickets are free soldering wires

322
00:20:06,890 --> 00:20:11,240
that's the works it to be a tipping all
the balls are at the bottom of the chip

323
00:20:11,240 --> 00:20:15,100
I'm we've had some success with guiding
wires

324
00:20:15,100 --> 00:20:19,980
between the ball trying to reconnect
with it gets hard at that point

325
00:20:19,980 --> 00:20:23,490
I'm anyway did

326
00:20:23,490 --> 00:20:27,730
that most important thing is to just
this able to get that on the CPU side

327
00:20:27,730 --> 00:20:31,880
so again that some flag somewhere early
in the CPU that they can set

328
00:20:31,880 --> 00:20:35,250
I'm some ships allow you to

329
00:20:35,250 --> 00:20:39,360
password-protected a text you cannot use
it until you've supplied a

330
00:20:39,360 --> 00:20:43,580
a certain magic magic string but of
course that's from

331
00:20:43,580 --> 00:20:47,289
and her date Hewitt leak that string I'm

332
00:20:47,289 --> 00:20:51,190
the solutions are are a bit too
dependent so it really depends on how to

333
00:20:51,190 --> 00:20:55,570
heart-to-heart ways implemented but the
lockdown

334
00:20:55,570 --> 00:20:58,750
can

335
00:20:58,750 --> 00:21:03,049
I'm also in

336
00:21:03,049 --> 00:21:06,879
related to GaTech you often see
debugging consoles and UART

337
00:21:06,880 --> 00:21:10,429
the basic serial ports were all the food

338
00:21:10,429 --> 00:21:15,200
flowers printed out you good has a
really nice interface as well

339
00:21:15,200 --> 00:21:18,760
to them that two serial I'm

340
00:21:18,760 --> 00:21:22,470
and actually found a a nice back here
into in the Nook

341
00:21:22,470 --> 00:21:28,410
couple years ago where you but was doing
a signature verification

342
00:21:28,410 --> 00:21:32,570
but on the I'm serial ports they
actually allowed

343
00:21:32,570 --> 00:21:35,750
you to interact with console you would

344
00:21:35,750 --> 00:21:39,500
and you would has a very nice I'm
feature

345
00:21:39,500 --> 00:21:43,490
you can I'm anarchic eyes to read it but
is

346
00:21:43,490 --> 00:21:46,590
MD which means maritime

347
00:21:46,590 --> 00:21:51,010
in this in MW memory right

348
00:21:51,010 --> 00:21:55,049
so somebody actually dumped out the
firmware figured out where the signature

349
00:21:55,049 --> 00:21:57,500
verification code was

350
00:21:57,500 --> 00:22:03,350
and then if you just overwrites that one
instruction again that makes a decision

351
00:22:03,350 --> 00:22:04,250
whether

352
00:22:04,250 --> 00:22:08,789
the signatures correct or not with 100
boom period

353
00:22:08,789 --> 00:22:11,789
so it's nice that they implement
signature verification

354
00:22:11,789 --> 00:22:14,940
but don't give the attacker console to

355
00:22:14,940 --> 00:22:21,940
we control all memory because then
things break down a good

356
00:22:23,110 --> 00:22:27,830
I'm there's an interesting thing on
ECU's some often you'll have different

357
00:22:27,830 --> 00:22:29,428
boot mode

358
00:22:29,429 --> 00:22:32,780
normal operational this boat I'm

359
00:22:32,780 --> 00:22:36,139
third so easy to use you guys in a
familiar doesn't it things that control

360
00:22:36,140 --> 00:22:37,309
your engines

361
00:22:37,309 --> 00:22:41,178
in cars their little embedded systems
with a very

362
00:22:41,179 --> 00:22:46,360
well specified functions I'm but they
often have to go into maintenance for

363
00:22:46,360 --> 00:22:50,059
firmware upgrade or for read out of the
engine

364
00:22:50,059 --> 00:22:53,299
I'm historical data I'm

365
00:22:53,299 --> 00:22:57,330
to text you have different food modes
depending on what kind of connector

366
00:22:57,330 --> 00:23:00,678
plug in there were kinda which is set to
work on a strap

367
00:23:00,679 --> 00:23:04,260
you clothes on their on the PCB

368
00:23:04,260 --> 00:23:10,530
and sometimes is actually disable mall
signature verification

369
00:23:10,530 --> 00:23:15,418
the ones who know how to I'm pretend to
be such a cable or if you know with

370
00:23:15,419 --> 00:23:16,570
strapped override

371
00:23:16,570 --> 00:23:20,379
you can just circumvent any kind

372
00:23:20,380 --> 00:23:25,360
secure body on that but firms so

373
00:23:25,360 --> 00:23:29,309
it's an engineering problem I understand
that but for security you don't want to

374
00:23:29,309 --> 00:23:30,190
have

375
00:23:30,190 --> 00:23:34,500
anyway to run on on authenticator code

376
00:23:34,500 --> 00:23:40,299
so I'm you need to check that

377
00:23:40,299 --> 00:23:44,179
then there's this nice talk to you

378
00:23:44,179 --> 00:23:47,230
time check time with news for their
abilities

379
00:23:47,230 --> 00:23:50,250
so that's a common term in security
where you

380
00:23:50,250 --> 00:23:53,640
check some kind of state first

381
00:23:53,640 --> 00:23:56,789
and then later you going to use that
state

382
00:23:56,789 --> 00:24:00,850
but that later implies there some attack
window for an attacker to

383
00:24:00,850 --> 00:24:04,000
do something to your system so

384
00:24:04,000 --> 00:24:09,400
you can imagine and this is especially
common in smaller embedded devices and

385
00:24:09,400 --> 00:24:10,280
more research

386
00:24:10,280 --> 00:24:15,360
constrained devices if you don't have a
lot of memory to copy your firmware

387
00:24:15,360 --> 00:24:20,189
I'm into some secure am you may actually
just do

388
00:24:20,190 --> 00:24:23,940
signature verification over your
firmware and then

389
00:24:23,940 --> 00:24:28,900
have the CPU directly execute
instructions from this for

390
00:24:28,900 --> 00:24:33,080
not doesn't seem like a problem cuz I'm
you've checked for resident can execute

391
00:24:33,080 --> 00:24:34,639
it right

392
00:24:34,640 --> 00:24:38,230
I'm the problem is that usually these

393
00:24:38,230 --> 00:24:41,280
the flash firmware is our separate chip
on a PCB

394
00:24:41,280 --> 00:24:44,559
with a nice bus going to the main CPU

395
00:24:44,559 --> 00:24:49,309
and this bus is actually something that
an attacker has pleased that the devices

396
00:24:49,309 --> 00:24:50,370
hands

397
00:24:50,370 --> 00:24:53,418
they can pro manipulate do whatever with
that

398
00:24:53,419 --> 00:24:57,130
with the bus lines I'm political attack

399
00:24:57,130 --> 00:25:00,880
I'm that we did already couple years ago

400
00:25:00,880 --> 00:25:05,340
we had an embedded device that had set a
signature verification over to flash

401
00:25:05,340 --> 00:25:08,610
I'm but actually the flash a

402
00:25:08,610 --> 00:25:11,799
was only used for about a third or
something

403
00:25:11,799 --> 00:25:16,879
so they actually put in a bigger
platform that was needed

404
00:25:16,880 --> 00:25:20,720
I'm but this gave us an interesting
loophole as well we did is we

405
00:25:20,720 --> 00:25:24,740
I'm to the top of the flash the talk
third or so

406
00:25:24,740 --> 00:25:28,169
what the actual device code with the
signature so

407
00:25:28,169 --> 00:25:31,580
that was what was checked and all the
rest wasn't checked it was

408
00:25:31,580 --> 00:25:35,139
you don't need to do that system space

409
00:25:35,140 --> 00:25:38,830
but we put our own code basically with a
huge knob sled

410
00:25:38,830 --> 00:25:42,980
all the way to the end in our are evil
code: at the end

411
00:25:42,980 --> 00:25:46,850
and now if you look at memory addressing
there's museum every bus

412
00:25:46,850 --> 00:25:51,168
in the database go to the plaque so what
we did is we intercepted

413
00:25:51,169 --> 00:25:56,120
one up the address lines actually one of
the high its me at Ursuline

414
00:25:56,120 --> 00:26:00,649
so we get physically move I'm

415
00:26:00,650 --> 00:26:03,780
the I'm

416
00:26:03,780 --> 00:26:07,240
the value of that her said it was there
are 1

417
00:26:07,240 --> 00:26:11,799
that actually happens it was executing
to talk checking the top

418
00:26:11,799 --> 00:26:14,929
and then as soon as it's done finishing
its signature verification

419
00:26:14,929 --> 00:26:18,380
we push that at Ursuline bit for the
high-value

420
00:26:18,380 --> 00:26:21,450
so the CPU things that still reading

421
00:26:21,450 --> 00:26:25,320
and executing from the top part but the
flash controller because that

422
00:26:25,320 --> 00:26:29,399
1 like it is now set the high is
actually reading from the high part

423
00:26:29,400 --> 00:26:32,600
which is what we have under control so

424
00:26:32,600 --> 00:26:37,629
obviously not good I'm it was actually
interesting is the timing was not very

425
00:26:37,630 --> 00:26:39,570
specific so we actually did it with the

426
00:26:39,570 --> 00:26:44,120
with the button that somebody Press so
we had games going on who could

427
00:26:44,120 --> 00:26:48,199
present at the right time to get our
code to execute it was actually

428
00:26:48,200 --> 00:26:51,470
was not as hard as we hoped it would be

429
00:26:51,470 --> 00:26:54,510
I'm so the check there's

430
00:26:54,510 --> 00:26:57,809
you ordered a way to fix it is you load
your code

431
00:26:57,809 --> 00:27:02,178
into some protected area and then
execute from there

432
00:27:02,179 --> 00:27:05,809
and that that depends on your platform
already have such a retard

433
00:27:05,809 --> 00:27:09,289
them it says the RAM here

434
00:27:09,289 --> 00:27:13,020
the RAM doesn't have to be internal
today to see either

435
00:27:13,020 --> 00:27:16,330
so it could be external as well but it
is a much faster bus

436
00:27:16,330 --> 00:27:19,639
but it's actually harder to do are great
acting as well

437
00:27:19,640 --> 00:27:23,610
but it's not a foolproof pics

438
00:27:23,610 --> 00:27:26,300
I'm

439
00:27:26,300 --> 00:27:27,780
timing attacks so

440
00:27:27,780 --> 00:27:30,810
I'm actually gonna go straight into

441
00:27:30,810 --> 00:27:35,490
example because here the next talks
likely being done by Darth Vader and

442
00:27:35,490 --> 00:27:38,130
thats not a guy I want to upset by going
over what time

443
00:27:38,130 --> 00:27:41,280
I'm the idea and

444
00:27:41,280 --> 00:27:45,440
is actually an example from the x-box
360 is republished attack

445
00:27:45,440 --> 00:27:48,900
day compared h-back

446
00:27:48,900 --> 00:27:52,250
which is a signature over I'm

447
00:27:52,250 --> 00:27:56,730
the actual for where to have one that
they've contributed internally

448
00:27:56,730 --> 00:28:01,430
and Nick checkered bye bye bye and
here's actually a site and/or attack

449
00:28:01,430 --> 00:28:02,100
were day

450
00:28:02,100 --> 00:28:05,969
where you can see just based on the time
it takes to

451
00:28:05,970 --> 00:28:09,430
checked the eight smack whether it's a
correct a

452
00:28:09,430 --> 00:28:12,790
sorry the time to check the eight

453
00:28:12,790 --> 00:28:15,790
Mac corresponds to the number of bytes
of the eight

454
00:28:15,790 --> 00:28:18,930
like that are equal SoCal

455
00:28:18,930 --> 00:28:23,280
I'm consider the password check that
will check the first bites see that's

456
00:28:23,280 --> 00:28:23,810
correct

457
00:28:23,810 --> 00:28:26,960
if it's not correct that terminates if
it is correct that goes

458
00:28:26,960 --> 00:28:32,410
the second one and then terminates so
this by measuring the time

459
00:28:32,410 --> 00:28:37,880
you can figure out which by is correct
or incorrect so this is not

460
00:28:37,880 --> 00:28:41,290
our work I'm but some guys made abort

461
00:28:41,290 --> 00:28:45,000
automate this on the x box and the idea
is

462
00:28:45,000 --> 00:28:49,540
that I'm putting our robot motor on the
x box

463
00:28:49,540 --> 00:28:54,800
so does age matter sector will fail but
I'm going to measure how long it takes

464
00:28:54,800 --> 00:28:58,850
to actually a report that failure

465
00:28:58,850 --> 00:29:04,230
now going to start with first having a

466
00:29:04,230 --> 00:29:08,120
age but tell you all zeros now just

467
00:29:08,120 --> 00:29:11,350
increase the first by 21 and two and
three

468
00:29:11,350 --> 00:29:14,629
in a poor Nikki for measuring the time
if at some point

469
00:29:14,630 --> 00:29:18,470
all of a sudden the time increases then
I know that first bite must've been

470
00:29:18,470 --> 00:29:21,050
corrected

471
00:29:21,050 --> 00:29:24,990
I could just been to repeat this attack
to find each by individually by

472
00:29:24,990 --> 00:29:30,120
I'm my pics few hours actually I'm
normally have two birds first 30

473
00:29:30,120 --> 00:29:34,330
anti-aids Mac I'm which is way too much

474
00:29:34,330 --> 00:29:38,179
but if you can do it bye bye bye it's
actually doable in a couple hours and is

475
00:29:38,180 --> 00:29:39,160
allowed to run

476
00:29:39,160 --> 00:29:45,160
arbitrary code on the on the export on

477
00:29:45,160 --> 00:29:48,440
the last one is I'm let's just be ready

478
00:29:48,440 --> 00:29:52,110
I'm on that at all course on on this
kinda stuff

479
00:29:52,110 --> 00:29:56,629
the idea is that with assuming you have
hardware access to a device you can also

480
00:29:56,630 --> 00:29:57,560
start

481
00:29:57,560 --> 00:30:01,710
affecting the way to execute
instructions you can actually introduced

482
00:30:01,710 --> 00:30:02,330
faults

483
00:30:02,330 --> 00:30:05,460
in 2008 and who isn't there execute
instructions

484
00:30:05,460 --> 00:30:10,130
21 ways to duplicating they actually
control the power supply to the device

485
00:30:10,130 --> 00:30:14,850
could drop it really quickly exactly at
the time that the instruction if you're

486
00:30:14,850 --> 00:30:16,360
interested in is executing

487
00:30:16,360 --> 00:30:19,860
and that may actually introduce fault

488
00:30:19,860 --> 00:30:23,590
and one of the polls we we we we see is
that you can

489
00:30:23,590 --> 00:30:28,699
make that instruction almost disappear
it's like it was taken to 100

490
00:30:28,700 --> 00:30:31,880
like this is happening right at the
moment when

491
00:30:31,880 --> 00:30:35,600
your boot code is checking a signature

492
00:30:35,600 --> 00:30:39,719
in and its deciding whether the
signatures correct Renault

493
00:30:39,720 --> 00:30:44,090
you may just bypass that skip entire I'm

494
00:30:44,090 --> 00:30:47,300
so there's a lot of both injection
literature out there

495
00:30:47,300 --> 00:30:51,629
as on it show you did

496
00:30:51,630 --> 00:30:54,870
ok six seconds gonna make it no

497
00:30:54,870 --> 00:30:59,300
I'm gonna the last lap

498
00:30:59,300 --> 00:31:02,320
so really

499
00:31:02,320 --> 00:31:05,770
on don't think that this is

500
00:31:05,770 --> 00:31:11,370
secure or insecure I'm it really depends
on what the function of your devices how

501
00:31:11,370 --> 00:31:13,479
many thirty feet if you want to
implement

502
00:31:13,480 --> 00:31:19,690
if you are I'm no getting access to your
bank account thing maybe have a couple

503
00:31:19,690 --> 00:31:21,250
thousand dollars in there

504
00:31:21,250 --> 00:31:24,700
I'm with stocks have somebody with would
get its but

505
00:31:24,700 --> 00:31:29,420
no nation status gonna spend millions
trying to get into your bank account

506
00:31:29,420 --> 00:31:33,600
if it is the nuclear launch codes it
gets a little different

507
00:31:33,600 --> 00:31:37,429
so really think about what what the
attacks are

508
00:31:37,430 --> 00:31:41,970
that are relevant to your device if you
want to implement countermeasures and if

509
00:31:41,970 --> 00:31:42,320
you

510
00:31:42,320 --> 00:31:46,520
if you have high security requirements
and all this kind of hardware mechanisms

511
00:31:46,520 --> 00:31:47,280
as well

512
00:31:47,280 --> 00:31:52,830
applies well I'm but just designing
things properly and not screwing up

513
00:31:52,830 --> 00:31:56,030
already makes a big difference so

514
00:31:56,030 --> 00:31:59,730
learn lessons from the past and pay
attention to detail

515
00:31:59,730 --> 00:32:02,090
I'm

516
00:32:02,090 --> 00:32:04,970
okay I just wanna wrap up by Dominic

517
00:32:04,970 --> 00:32:10,160
time after questions silence

518
00:32:10,160 --> 00:32:16,380
I have time okay I think dark was
already with compactor

519
00:32:16,380 --> 00:32:17,260
room

