1
00:00:00,260 --> 00:00:03,370
are you guys on joined today by is it
rough

2
00:00:03,370 --> 00:00:08,960
I hope route said easy a is the chief
scientist and have security for bromine

3
00:00:08,960 --> 00:00:12,580
I he let the McAfee vulnerability group
for

4
00:00:12,580 --> 00:00:16,240
number years at sure much pain give you
a broader introduction but

5
00:00:16,239 --> 00:00:19,279
it's a really cool talk I think you get
this at Black Hat year

6
00:00:19,279 --> 00:00:23,340
yen couple other places really need a
he's gonna show you what

7
00:00:23,340 --> 00:00:27,080
what's wrong with sandboxing many cases

8
00:00:27,080 --> 00:00:30,448
I given more around hospice

9
00:00:30,449 --> 00:00:35,630
thank you

10
00:00:35,630 --> 00:00:38,719
can you hear me okay

11
00:00:38,719 --> 00:00:42,510
great so hi everybody a are talking
about

12
00:00:42,510 --> 00:00:46,039
application sandboxing and I was

13
00:00:46,039 --> 00:00:49,079
want to talk a bit about how easy

14
00:00:49,079 --> 00:00:53,550
it is to record of most of the white you
send boxes

15
00:00:53,550 --> 00:00:56,730
with some life exploiting malls

16
00:00:56,730 --> 00:01:00,648
so to start of

17
00:01:00,649 --> 00:01:04,960
I'll up I I leave the security search at
Broome

18
00:01:04,959 --> 00:01:08,710
going to start a computer make to your
company

19
00:01:08,710 --> 00:01:12,929
dedicated for trustworthy computing you
can't find what about us

20
00:01:12,930 --> 00:01:17,369
I was no website immutable outside as up

21
00:01:17,369 --> 00:01:21,650
next article so what is a sandbox so

22
00:01:21,650 --> 00:01:25,670
a sandbox is basically an environment
design

23
00:01:25,670 --> 00:01:29,560
to run untrusted content which means
that

24
00:01:29,560 --> 00:01:33,350
anything inside a sandbox could be put
into the malicious

25
00:01:33,350 --> 00:01:36,539
right so a every effective sandboxes

26
00:01:36,540 --> 00:01:40,110
I'll and you know you have seen the
eyewear

27
00:01:40,110 --> 00:01:45,740
sandbox the Android sandbox be and
reassemble could always a sandbox right

28
00:01:45,740 --> 00:01:49,030
so for this talk I'll be focused on

29
00:01:49,030 --> 00:01:52,229
applications and boxes which are widely
deployed

30
00:01:52,229 --> 00:01:55,429
and a as you understand

31
00:01:55,430 --> 00:01:58,530
the aim of a sandbox is primarily to

32
00:01:58,530 --> 00:02:01,759
actually fix and and then I'll

33
00:02:01,759 --> 00:02:04,810
talk a bit about is it really a

34
00:02:04,810 --> 00:02:08,949
is it really a meaningful argument that
Sandbox is that really is relevant

35
00:02:08,949 --> 00:02:13,290
in the current more than sophisticated
attacks which are

36
00:02:13,290 --> 00:02:16,920
which be a thing in the world right now
so

37
00:02:16,920 --> 00:02:20,079
a to start of up for this talk I have
divided

38
00:02:20,080 --> 00:02:23,660
a sandbox into two categories: which is
a Type A and Type B

39
00:02:23,660 --> 00:02:27,819
a we just my own naming convention would
have been a type 1 or type 2

40
00:02:27,819 --> 00:02:31,790
let's go back so babies basically and

41
00:02:31,790 --> 00:02:35,299
with enhancement be sandbox some other
way

42
00:02:35,300 --> 00:02:38,440
you send boxes are Sandboxie offers on

43
00:02:38,440 --> 00:02:41,780
bro and there are several others up that
category

44
00:02:41,780 --> 00:02:45,530
anti be is must just leave more

45
00:02:45,530 --> 00:02:49,110
again this is my own terminology and
I'll explain about that and

46
00:02:49,110 --> 00:02:52,860
in a bit you'd like to add a weed eater
X the Chrome browser

47
00:02:52,860 --> 00:02:56,590
are the Korean project sobil basically

48
00:02:56,590 --> 00:03:00,450
decompose the school type so sandbox in
this presentation

49
00:03:00,450 --> 00:03:04,369
so moving to buy peace

50
00:03:04,370 --> 00:03:07,940
papers and boxes so what it what it is
is

51
00:03:07,940 --> 00:03:12,819
at babies have of is fundamentally a
custom kernel mode driver

52
00:03:12,819 --> 00:03:16,679
that modifies the windows shopping
system behavior

53
00:03:16,680 --> 00:03:20,260
fits that be protected compliments
inside

54
00:03:20,260 --> 00:03:23,760
the sandbox are protected basically an
isolated right

55
00:03:23,760 --> 00:03:26,980
so the most common use case

56
00:03:26,980 --> 00:03:31,950
is basically for control executioner
applications and the reason to use case

57
00:03:31,950 --> 00:03:32,690
has been

58
00:03:32,690 --> 00:03:36,099
safe browsing: people use Sandboxie for

59
00:03:36,099 --> 00:03:39,319
isolating your browser apps right and
also

60
00:03:39,319 --> 00:03:44,518
lot of people as use these devils and
boxes from our index is because

61
00:03:44,519 --> 00:03:47,569
getting it to see if contained
environment

62
00:03:47,569 --> 00:03:50,670
so there has been a trend where people
some amount of

63
00:03:50,670 --> 00:03:54,700
matter an elephant and the scope that
will send boxes by

64
00:03:54,700 --> 00:03:58,450
so up looking at an architecture from a

65
00:03:58,450 --> 00:04:01,619
I'm going to point of view 0

66
00:04:01,620 --> 00:04:04,629
we need to understand that diesel or of

67
00:04:04,629 --> 00:04:08,340
con interaction that happens a

68
00:04:08,340 --> 00:04:11,580
0 behind every sandbox so

69
00:04:11,580 --> 00:04:15,790
if you haven't applications running
inside an application sandbox

70
00:04:15,790 --> 00:04:19,630
it is interacting with the condo all the
time for it to function

71
00:04:19,630 --> 00:04:23,430
normally which means that a it relies

72
00:04:23,430 --> 00:04:26,910
on the fact that what's going on has not
been compromised

73
00:04:26,910 --> 00:04:30,790
right so does the design is them Shin of
in the sandbox

74
00:04:30,790 --> 00:04:35,050
any application sandbox right which also
means that

75
00:04:35,050 --> 00:04:38,410
the sandbox cannot protect against

76
00:04:38,410 --> 00:04:41,889
malicious come more mad rights with

77
00:04:41,889 --> 00:04:45,220
going to be an architectural
decompositions I

78
00:04:45,220 --> 00:04:48,800
talk about that why and how so

79
00:04:48,800 --> 00:04:52,460
if if you break this down a at an
architectural ever to do

80
00:04:52,460 --> 00:04:55,900
how an application sandbox like sandbox
evokes

81
00:04:55,900 --> 00:04:59,549
you have a use a more confident and you
have the sandbox

82
00:04:59,550 --> 00:05:03,590
gonna driver right and in the use a more
fun when you're typically run your

83
00:05:03,590 --> 00:05:04,560
browser

84
00:05:04,560 --> 00:05:08,030
your your word of command are you an
executable

85
00:05:08,030 --> 00:05:11,239
and asked several folks it's basically
monitor

86
00:05:11,240 --> 00:05:14,350
the behavior of the application and
what's happening

87
00:05:14,350 --> 00:05:17,419
and the car driver basically makes a
decision

88
00:05:17,419 --> 00:05:20,940
on should just be allowed was the

89
00:05:20,940 --> 00:05:24,690
not allowed on the quality factor right

90
00:05:24,690 --> 00:05:27,800
but is how pretty much every application
sandbox

91
00:05:27,800 --> 00:05:30,900
books right so 0

92
00:05:30,900 --> 00:05:34,448
so how does this to you look at the
condo rape so at a very high level this

93
00:05:34,449 --> 00:05:36,430
hard look like

94
00:05:36,430 --> 00:05:40,870
the the sandbox application bill make a
request for the kernel saying

95
00:05:40,870 --> 00:05:44,979
I want access to a fine so please open a
file for me

96
00:05:44,979 --> 00:05:48,979
right and this file name: is that
address X

97
00:05:48,979 --> 00:05:52,539
right and then the condo say save
exploring to

98
00:05:52,539 --> 00:05:56,430
the spring allowed kick-start file

99
00:05:56,430 --> 00:06:00,639
and then it was a fine has filehandle
for you

100
00:06:00,639 --> 00:06:05,590
and then the sandbox Africa some say ok
econo I want to open a file for

101
00:06:05,590 --> 00:06:08,609
for meat for me to execute a fight right
and the

102
00:06:08,610 --> 00:06:12,020
addresses that s why the caller

103
00:06:12,020 --> 00:06:15,039
pinpoint b.sc okay you this is the

104
00:06:15,039 --> 00:06:19,949
secret pics that fight is your and since
got a sandbox application

105
00:06:19,949 --> 00:06:24,160
I feel not let you access this fight
right so let me show you how did what's

106
00:06:24,160 --> 00:06:25,710
in real-world

107
00:06:25,710 --> 00:06:28,830
so this is my VM environment

108
00:06:28,830 --> 00:06:33,740
and I'm going to open a sandbox say
using Sandboxie

109
00:06:33,740 --> 00:06:38,650
right and this is my command prompt

110
00:06:38,650 --> 00:06:41,698
so this as you can see by the yellow

111
00:06:41,699 --> 00:06:44,720
a border this means that isn't a sandbox

112
00:06:44,720 --> 00:06:48,550
right so now if I open say

113
00:06:48,550 --> 00:06:51,819
nor bad this is dying fetus is

114
00:06:51,819 --> 00:06:55,419
on the horse this is not in the sandbox
outside the sandbox right

115
00:06:55,419 --> 00:07:02,419
so if I try to sick kids

116
00:07:03,389 --> 00:07:05,889
the North fat who say access is denied

117
00:07:05,889 --> 00:07:09,719
because I'm in say the sandbox and I am
NOT allowed

118
00:07:09,719 --> 00:07:13,009
to operate or interact applications out
to the sandbox

119
00:07:13,009 --> 00:07:16,650
right do how the sandbox the call with
intercepting this call ends

120
00:07:16,650 --> 00:07:21,370
and disavowing that right okay

121
00:07:21,370 --> 00:07:25,669
for now 0 now let's have some fun

122
00:07:25,669 --> 00:07:30,020
what I would do is that 0 what if

123
00:07:30,020 --> 00:07:33,180
I have a call when ability in the
opening system

124
00:07:33,180 --> 00:07:36,219
right I have gone one between the
opening system

125
00:07:36,219 --> 00:07:40,050
0 which means that I if I exploit

126
00:07:40,050 --> 00:07:43,569
by if ever to reach that goal call I can

127
00:07:43,569 --> 00:07:47,139
fundamental breach of a sandbox right a

128
00:07:47,139 --> 00:07:51,449
which means that a I will have higher
privilege of the same privilege as that

129
00:07:51,449 --> 00:07:53,370
of the sandbox college graduates have

130
00:07:53,370 --> 00:07:56,939
depending upon the nature of the one
ability right so

131
00:07:56,939 --> 00:08:00,349
and this is like a design flaw you you
cannot solve is no

132
00:08:00,349 --> 00:08:04,849
application sandbox and ever solve this
problem so

133
00:08:04,849 --> 00:08:08,169
are selects the way Demel

134
00:08:08,169 --> 00:08:11,529
what I've done is that so I'm going to
select

135
00:08:11,529 --> 00:08:15,120
a a list of 11 abilities these are the
Las

136
00:08:15,120 --> 00:08:18,699
a to use gonna put it on wanna be
dispatched

137
00:08:18,699 --> 00:08:22,539
by Microsoft always call and then I
would select

138
00:08:22,539 --> 00:08:26,349
CV 2012 021

139
00:08:26,349 --> 00:08:29,560
a 7 this one a body worthy to you

140
00:08:29,560 --> 00:08:32,979
discovered by Michalik and bringing laps

141
00:08:32,979 --> 00:08:36,510
well that's why this is one of my
favorite ago

142
00:08:36,510 --> 00:08:39,860
exploit Solis

143
00:08:39,860 --> 00:08:43,209
demonstrate how we can breach of the
same sandbox

144
00:08:43,208 --> 00:08:46,649
right so now I'm say that this
environment

145
00:08:46,649 --> 00:08:53,649
go to

146
00:08:55,490 --> 00:08:59,720
so when I have here is I have a dispose

147
00:08:59,720 --> 00:09:03,520
infamously known as the district 1
ability and

148
00:09:03,520 --> 00:09:06,589
this is a this can be exploited by

149
00:09:06,589 --> 00:09:09,690
there's no gonna so

150
00:09:09,690 --> 00:09:14,170
what I do now is 0 I will Ricciardo
sandbox

151
00:09:14,170 --> 00:09:17,550
and for beating out what I have done is
I've canada generic

152
00:09:17,550 --> 00:09:21,459
mechanism for providing on a sandbox in
general which can be

153
00:09:21,459 --> 00:09:24,800
leverage 0 basically

154
00:09:24,800 --> 00:09:28,709
used is explored against it any sandbox
this tight

155
00:09:28,709 --> 00:09:32,829
right so 110 and exploit a I have the
capability of

156
00:09:32,830 --> 00:09:36,800
you could be saving the sandbox driver
or run arbitrary code

157
00:09:36,800 --> 00:09:40,899
so in this case what happens after tito
bientot

158
00:09:40,899 --> 00:09:44,250
rating after exploring the corleone
ability I

159
00:09:44,250 --> 00:09:47,649
basically are the sandbox and I can get

160
00:09:47,649 --> 00:09:50,660
remote code execution before

161
00:09:50,660 --> 00:09:53,990
before I said and exploit want to make
sure that I

162
00:09:53,990 --> 00:09:57,620
still can articulate or never txt read

163
00:09:57,620 --> 00:10:04,620
because I don't have privilege so now
what are the ways

164
00:10:05,279 --> 00:10:08,939
I've been exploit the p80

165
00:10:08,940 --> 00:10:12,400
you open 398

166
00:10:12,400 --> 00:10:16,540
out to be more so I will Beaufort out of

167
00:10:16,540 --> 00:10:19,770
process by Michael a process called been

168
00:10:19,770 --> 00:10:23,829
in it which has a PhD of 384

169
00:10:23,830 --> 00:10:27,430
salt free it for

170
00:10:27,430 --> 00:10:30,560
and I run dis exploit right

171
00:10:30,560 --> 00:10:35,290
so now

172
00:10:35,290 --> 00:10:38,589
do is Rico

173
00:10:38,589 --> 00:10:43,450
or for

174
00:10:43,450 --> 00:10:48,260
9152 week

175
00:10:48,260 --> 00:10:55,260
the port and then I get a

176
00:10:56,070 --> 00:11:03,070
ship

177
00:11:41,910 --> 00:11:46,670
d

178
00:11:46,670 --> 00:11:52,589
three

179
00:11:52,589 --> 00:11:59,589
okay so

180
00:12:06,540 --> 00:12:11,430
so knife I do it Who Am I I'm system

181
00:12:11,430 --> 00:12:14,739
basically I have breach of the sandbox

182
00:12:14,740 --> 00:12:18,540
but the sandbox give pinks that I'm

183
00:12:18,540 --> 00:12:22,199
the sandbox right so before they call
exploit

184
00:12:22,199 --> 00:12:25,889
and I have return to the sandbox no I
system privileges

185
00:12:25,889 --> 00:12:32,889
so now let me try to kill done or bad
process which is laying out here

186
00:12:41,200 --> 00:12:44,730
so I was able to the north but process
so now the fourth

187
00:12:44,730 --> 00:12:48,010
I had full access to the host have
compromised the sandbox and I'm

188
00:12:48,010 --> 00:12:51,069
executing with system privileges on the
machine

189
00:12:51,070 --> 00:12:54,240
right for this was a

190
00:12:54,240 --> 00:12:57,300
its type 1 sandbox bypass

191
00:12:57,300 --> 00:13:01,589
so the Knicks

192
00:13:01,590 --> 00:13:04,730
up IPS a is far more popular

193
00:13:04,730 --> 00:13:08,450
it is the Google Chrome are forming
project and

194
00:13:08,450 --> 00:13:12,140
Adobe Reader X right so how this works
is that

195
00:13:12,140 --> 00:13:15,530
there are two processes in the stable
sandboxes one is though

196
00:13:15,530 --> 00:13:19,319
mosser and then the sleeve and it's all
over

197
00:13:19,320 --> 00:13:23,600
I PC tentative Andy communicate
basically where the channel

198
00:13:23,600 --> 00:13:27,200
so this lady is so fundamentally
confined to the

199
00:13:27,200 --> 00:13:30,790
with so access control for facilities
basically

200
00:13:30,790 --> 00:13:33,930
has balkans a and it has proven adept

201
00:13:33,930 --> 00:13:39,089
excesses which are limited and maas
immediate access to resources

202
00:13:39,090 --> 00:13:42,100
it has kind of a policy thinker Policy
Manager right

203
00:13:42,100 --> 00:13:45,440
and the again the use cases basically

204
00:13:45,440 --> 00:13:48,580
to protect the the sleeve

205
00:13:48,580 --> 00:13:51,650
from exploitation day in the case of

206
00:13:51,650 --> 00:13:55,520
will crumble over this claim is that
enter which has the biggest attack

207
00:13:55,520 --> 00:13:56,220
surface

208
00:13:56,220 --> 00:13:59,390
which have all the is to move by
processing and all of that right

209
00:13:59,390 --> 00:14:03,710
so a and as you know will chrome and it
will be there are

210
00:14:03,710 --> 00:14:06,990
pretty popular applications for weapon
part in bringing

211
00:14:06,990 --> 00:14:12,150
so up a little bit architecture how it
has been designed

212
00:14:12,150 --> 00:14:15,660
right so the Mosser of the Google Chrome
or

213
00:14:15,660 --> 00:14:19,469
form sandbox a has a smaller squad base

214
00:14:19,470 --> 00:14:23,920
the idea is that if you have a smoke or
base that back surface too small

215
00:14:23,920 --> 00:14:27,180
which means that be non-trivial to
exploit the master

216
00:14:27,180 --> 00:14:32,560
right and but by the same time sleeve
has the largest effect surface because

217
00:14:32,560 --> 00:14:36,859
it does all the processing all the
content rendering and so on

218
00:14:36,860 --> 00:14:40,320
but in this case the sleeve

219
00:14:40,320 --> 00:14:43,470
still has to interact with the corner
for certain that

220
00:14:43,470 --> 00:14:48,350
operations which it cannot ignore so
that would be on attack vector

221
00:14:48,350 --> 00:14:51,830
as you might have guessed so at a very
high level this is how it looks like

222
00:14:51,830 --> 00:14:55,090
you have a the sandbox process

223
00:14:55,090 --> 00:14:58,610
with minimal access rights and then you
have to master process

224
00:14:58,610 --> 00:15:02,870
and then you have the with interaction
right and the masa process basically

225
00:15:02,870 --> 00:15:03,480
makes

226
00:15:03,480 --> 00:15:08,660
all the key decisions of the sandbox and
all the local villages

227
00:15:08,660 --> 00:15:12,410
request are allowed directly from

228
00:15:12,410 --> 00:15:16,209
the sleeve protestant with as and when
needed right

229
00:15:16,210 --> 00:15:20,440
so some of the important aspects of the
columns and boxes that

230
00:15:20,440 --> 00:15:24,920
the sleeve runs with low privileges it
has

231
00:15:24,920 --> 00:15:28,800
which just means that it has the stupid
21 X is job optics

232
00:15:28,800 --> 00:15:32,290
stopped attending universities all
control in the chrome

233
00:15:32,290 --> 00:15:36,980
sandbox a as for the Queen project which
is open source

234
00:15:36,980 --> 00:15:40,780
a no there is no protection for

235
00:15:40,780 --> 00:15:44,730
mounted fact or factor to ones nor

236
00:15:44,730 --> 00:15:49,900
is dead any protection for the TCPIP so
that means that if you compromise though

237
00:15:49,900 --> 00:15:53,160
the vendor you basically could amount

238
00:15:53,160 --> 00:15:57,319
I victory fat partitions are you you can
have for TCP IP connectivity

239
00:15:57,320 --> 00:16:01,650
which means that I could potentially
have a PDF document

240
00:16:01,650 --> 00:16:05,230
it scans my novel and an approach for
them out now they're so

241
00:16:05,230 --> 00:16:09,020
right but a axis2

242
00:16:09,020 --> 00:16:13,670
most of the existing secure a bull
resources denied it fairly contained

243
00:16:13,670 --> 00:16:16,969
and and everybody would agree that this
is good enough

244
00:16:16,970 --> 00:16:20,400
as you mean that the kinda BS Creek
right

245
00:16:20,400 --> 00:16:23,510
so this is how it works a

246
00:16:23,510 --> 00:16:27,330
in real-world so in this case up if you
look at the PADD

247
00:16:27,330 --> 00:16:31,530
2856 is the sleeve and he's asking

248
00:16:31,530 --> 00:16:34,750
it's asking for access to a particular
fight

249
00:16:34,750 --> 00:16:38,560
and then if you see that began access
denied

250
00:16:38,560 --> 00:16:42,599
coming from the with because the sleeve
has two for Y at the Mosser

251
00:16:42,600 --> 00:16:46,300
right to to its you know it VAT is the
Mosser

252
00:16:46,300 --> 00:16:49,829
and and mosso sense all this is
happening when name

253
00:16:49,830 --> 00:16:53,120
fight so so Process Explorer doesn't
give it so

254
00:16:53,120 --> 00:16:56,400
the sleeve request the master saying
that I 1x

255
00:16:56,400 --> 00:16:59,970
with the source and in the process is OK
you can access this

256
00:16:59,970 --> 00:17:04,209
and once that access is granted though
the slave has access to that but it

257
00:17:04,209 --> 00:17:05,990
would be a little right to its all up

258
00:17:05,990 --> 00:17:10,120
being mediated from the Mosser so

259
00:17:10,119 --> 00:17:14,270
go for them most that is so if you see

260
00:17:14,270 --> 00:17:17,949
you have seen the we discount is for
Jeff which have been there to break out

261
00:17:17,949 --> 00:17:18,840
of and boxes

262
00:17:18,839 --> 00:17:22,698
a you know most authors have been
focused on

263
00:17:22,699 --> 00:17:26,040
how does this then is the Mosser
malicious p sleeve

264
00:17:26,040 --> 00:17:30,740
and that a is a is kind of a tough
battle to fight

265
00:17:30,740 --> 00:17:35,380
because a you know there's a lot of hard
work done

266
00:17:35,380 --> 00:17:38,530
there in the sandbox world to make sure
that you know

267
00:17:38,530 --> 00:17:42,770
maliciously this contain all the time
and that's a design of the sandbox right

268
00:17:42,770 --> 00:17:46,710
but how resistant is the operating
system

269
00:17:46,710 --> 00:17:50,620
maliciously services the aspect of this
before

270
00:17:50,620 --> 00:17:54,610
assault so up if you look at the

271
00:17:54,610 --> 00:17:59,020
0 must save face and body to open this
in their property section

272
00:17:59,020 --> 00:18:02,670
this is how it looks like a for Adobe
Reader

273
00:18:02,670 --> 00:18:06,090
you can see that it is no integrity
level

274
00:18:06,090 --> 00:18:09,669
which means that it has minimal a axis

275
00:18:09,670 --> 00:18:15,290
permissions to hutu activity for tests
network connectivity and so on

276
00:18:15,290 --> 00:18:20,200
it's fairly fairly can't constrained I
would say

277
00:18:20,200 --> 00:18:25,140
so for now up

278
00:18:25,140 --> 00:18:29,150
disperse for the direct I'm gonna a
discussion about to call me a sandbox

279
00:18:29,150 --> 00:18:30,100
knowledge gets

280
00:18:30,100 --> 00:18:33,429
specific about the Chrome browser right
so

281
00:18:33,430 --> 00:18:36,700
from rosa has is a little bit of a
brilliant

282
00:18:36,700 --> 00:18:39,930
from Generac chromium project

283
00:18:39,930 --> 00:18:43,470
so the with security obviously isn't
quite a bit of work

284
00:18:43,470 --> 00:18:47,560
to further enhance though the Chrome
browser

285
00:18:47,560 --> 00:18:52,690
which means that they have what what
they call s unquestioned integrity level

286
00:18:52,690 --> 00:18:58,460
and for Google Chrome though access to
factor to find system is denied

287
00:18:58,460 --> 00:19:01,690
so this is something which is not
documented

288
00:19:01,690 --> 00:19:05,550
in the public area available
documentation from San

289
00:19:05,550 --> 00:19:09,500
from chromium and we've got a bit of

290
00:19:09,500 --> 00:19:12,770
several contests like the point one on
this where

291
00:19:12,770 --> 00:19:16,620
successful attacks in the master have
been possible in the past

292
00:19:16,620 --> 00:19:19,870
which means that Massa is also
exploitable

293
00:19:19,870 --> 00:19:23,050
although it's a difficult one and its a

294
00:19:23,050 --> 00:19:26,730
it needs a lot of whatever if you if
anybody out here at the

295
00:19:26,730 --> 00:19:30,940
expert by Pinkie Pie it was a remarkable
feat I would say

296
00:19:30,940 --> 00:19:34,970
right because you have to jump through
various hoops and create conditions

297
00:19:34,970 --> 00:19:38,990
for you too bypass the sandbox reliably

298
00:19:38,990 --> 00:19:44,020
any today case ever see to levy bypass
those cases

299
00:19:44,020 --> 00:19:47,830
so go now that we know that the sleeve

300
00:19:47,830 --> 00:19:51,820
and still exploitable one ability a

301
00:19:51,820 --> 00:19:56,220
so someone embodies up ice but still not
be possible to be exploitable

302
00:19:56,220 --> 00:20:00,540
bite sleeve which means that if you need
to create a new process

303
00:20:00,540 --> 00:20:04,110
it would be denied if you need to order
specific

304
00:20:04,110 --> 00:20:07,350
locations in the registry would be
denied right

305
00:20:07,350 --> 00:20:10,560
a to this is kind of for the controls
additional controls

306
00:20:10,560 --> 00:20:14,659
added to the Google chrome browser
however

307
00:20:14,660 --> 00:20:18,480
winter took a DOCSIS over to the
important

308
00:20:18,480 --> 00:20:21,790
con more compliment is very much expose

309
00:20:21,790 --> 00:20:25,180
and a it was a pretty out there

310
00:20:25,180 --> 00:20:28,620
can be exploited at the browser level

311
00:20:28,620 --> 00:20:32,060
and giving full control over the machine

312
00:20:32,060 --> 00:20:35,889
without any a to no pity for execution

313
00:20:35,890 --> 00:20:39,530
in the them both laid upon contest

314
00:20:39,530 --> 00:20:43,120
so this was demonstrative in the lost .1
on pissed

315
00:20:43,120 --> 00:20:47,659
by the MWR labs research team so that on
the same time when I publish

316
00:20:47,660 --> 00:20:51,130
my people as well just to pick up our
embassy

317
00:20:51,130 --> 00:20:54,320
so where Vicky bypass the crumbs and
bought by

318
00:20:54,320 --> 00:20:57,689
morning when a burden that was kinda its
it's far more you people that know

319
00:20:57,690 --> 00:21:01,080
I would I would highly recommend that so

320
00:21:01,080 --> 00:21:04,480
a a little bit overheated process

321
00:21:04,480 --> 00:21:07,580
so everybody's also bees out of the
chromium

322
00:21:07,580 --> 00:21:10,720
project however a it is

323
00:21:10,720 --> 00:21:13,980
not it has hasn't been as tight and as
the

324
00:21:13,980 --> 00:21:17,370
Google Chrome browser for they were
pretty much a followed what was

325
00:21:17,370 --> 00:21:19,729
available in the cold wind project for
instance

326
00:21:19,730 --> 00:21:24,240
I that'll be reader still allows access
to TCP API can

327
00:21:24,240 --> 00:21:27,880
mount 55 system timing factor too hi fi
systems

328
00:21:27,880 --> 00:21:31,570
and so on and we know about

329
00:21:31,570 --> 00:21:35,460
enough about but do is be attacking the
Mosser

330
00:21:35,460 --> 00:21:38,740
of the Adobe Reader right and recently

331
00:21:38,740 --> 00:21:42,060
there was no matter where found in the
wind

332
00:21:42,060 --> 00:21:46,270
a x-force exploiting wanna bring the
muster

333
00:21:46,270 --> 00:21:50,929
in the Adobe Reader so accepting it's
got

334
00:21:50,929 --> 00:21:56,280
is also failing you and fabric on
putting it with discovered in the way

335
00:21:56,280 --> 00:21:59,470
right so up so now a

336
00:21:59,470 --> 00:22:02,640
for now if you want to exploit it
wonderfully be

337
00:22:02,640 --> 00:22:06,740
leveraging a call exploit in sick will
crawl

338
00:22:06,740 --> 00:22:09,770
or Adobe Reader holder

339
00:22:09,770 --> 00:22:13,040
look like right so in this case so

340
00:22:13,040 --> 00:22:16,100
a for instance we will use the phone

341
00:22:16,100 --> 00:22:19,550
boxing for some cute prison Windows Co

342
00:22:19,550 --> 00:22:23,139
basically does all the fun watching the
cause

343
00:22:23,140 --> 00:22:26,410
so so be but we've been off for point

344
00:22:26,410 --> 00:22:30,169
instance a call by phone stored at this
an appointment this

345
00:22:30,169 --> 00:22:33,580
X so sandbox application is a giclee
please

346
00:22:33,580 --> 00:22:37,020
draw law a text hello world and

347
00:22:37,020 --> 00:22:40,400
please use the Kobe phone store at this

348
00:22:40,400 --> 00:22:45,940
export doing this right so the call to
say okay US and both application but

349
00:22:45,940 --> 00:22:47,210
using the following

350
00:22:47,210 --> 00:22:52,410
is in normal 9 operation so what you
need to do to opt to operate

351
00:22:52,410 --> 00:22:55,860
no to operate and and function properly
so

352
00:22:55,860 --> 00:22:58,969
because it's okay I need to parse this
phone before I give

353
00:22:58,970 --> 00:23:02,660
you axis so while crossing the phone
mcconnell

354
00:23:02,660 --> 00:23:06,620
corrupt on memory because the possible
morning though

355
00:23:06,620 --> 00:23:11,290
in the car has one one ability and
because of this memory corruption

356
00:23:11,290 --> 00:23:14,770
because I executing court at the adverse
X

357
00:23:14,770 --> 00:23:17,770
which and allow up allowed to Apple

358
00:23:17,770 --> 00:23:21,668
anything it wants basically to this very
physically exploit wanna be

359
00:23:21,669 --> 00:23:25,020
right so

360
00:23:25,020 --> 00:23:28,530
I think ago you are all fully expecting

361
00:23:28,530 --> 00:23:31,870
that I record of cool or

362
00:23:31,870 --> 00:23:36,409
reader in the next level so let's do it
a bit differently this time

363
00:23:36,410 --> 00:23:40,240
so next let's think they're out of what
people

364
00:23:40,240 --> 00:23:43,500
Tom defense in depth right so let me

365
00:23:43,500 --> 00:23:46,990
run Feliz 2-1 abilities here and

366
00:23:46,990 --> 00:23:51,090
I was select the group phone boston won
ability

367
00:23:51,090 --> 00:23:54,199
and in this case a I will run

368
00:23:54,200 --> 00:23:57,740
the wonderbra be a bit differently yeah
I know to

369
00:23:57,740 --> 00:24:01,200
that I feel exploited so

370
00:24:01,200 --> 00:24:04,260
in this what I do I report Google kroll

371
00:24:04,260 --> 00:24:07,290
inside Sandboxie and bypass both the
sandbox

372
00:24:07,290 --> 00:24:14,290
right collect the whole difference in
the books

373
00:24:14,390 --> 00:24:21,390
so here we go

374
00:24:23,350 --> 00:24:30,350
I am inside the sandbox the beautiful in
a border

375
00:24:39,240 --> 00:24:44,220
chrome EXE chief executive committee
sexy inside the sandbox

376
00:24:44,220 --> 00:24:47,690
you see this also has a border and if I

377
00:24:47,690 --> 00:24:51,730
check from Process Explorer

378
00:24:51,730 --> 00:24:55,270
it fancy that chrome

379
00:24:55,270 --> 00:24:59,220
with ID it is untrusted untrusted

380
00:24:59,220 --> 00:25:02,470
integrity level which means that it is a
with police

381
00:25:02,470 --> 00:25:06,560
right and I am site a sandbox

382
00:25:06,560 --> 00:25:10,580
it has handbooks right so now

383
00:25:10,580 --> 00:25:17,580
its lonesome exploit

384
00:25:24,420 --> 00:25:27,490
school checked so whatever do is

385
00:25:27,490 --> 00:25:32,400
I take the p80 of to work with exploit
is

386
00:25:32,400 --> 00:25:35,630
Ivan inject into the

387
00:25:35,630 --> 00:25:39,290
the rendering process okie a browser

388
00:25:39,290 --> 00:25:43,610
right and then a assuming that the
interest compromise

389
00:25:43,610 --> 00:25:47,540
I record the sand with sandbox you know
with one ability

390
00:25:47,540 --> 00:25:52,500
to the Groupe 11 ability which was used
by the group you were more so by the way

391
00:25:52,500 --> 00:25:55,660
and 0 and then the two

392
00:25:55,660 --> 00:25:59,250
let's see how it looks like so inject

393
00:25:59,250 --> 00:26:02,590
pade this is 36

394
00:26:02,590 --> 00:26:06,899
to 6 and

395
00:26:06,900 --> 00:26:10,010
for the senator

396
00:26:10,010 --> 00:26:13,640
embed formed and expert

397
00:26:13,640 --> 00:26:18,160
up

398
00:26:18,160 --> 00:26:23,880
levity of ninety-five percent but

399
00:26:23,880 --> 00:26:29,270
when you're doing a live demo stupid

400
00:26:29,270 --> 00:26:32,860
its so

401
00:26:32,860 --> 00:26:39,860
school track

402
00:26:43,179 --> 00:26:50,179
its

403
00:27:10,890 --> 00:27:13,130
shit

404
00:27:13,130 --> 00:27:14,970
this time it's stand

405
00:27:14,970 --> 00:27:21,970
30

406
00:27:33,049 --> 00:27:34,179
okay

407
00:27:34,179 --> 00:27:39,290
i'd so this time I caught a I go any

408
00:27:39,290 --> 00:27:42,490
come on a calculator art of

409
00:27:42,490 --> 00:27:46,020
by after three attempts for them before
things about the

410
00:27:46,020 --> 00:27:50,650
though the payload is not person level
if you see that

411
00:27:50,650 --> 00:27:53,840
I from and after injecting into

412
00:27:53,840 --> 00:27:57,730
the batt is it was you know i horny
calculator

413
00:27:57,730 --> 00:28:01,480
which has which has medium integrity

414
00:28:01,480 --> 00:28:05,080
right from the and for us today was ever
elevator medium

415
00:28:05,080 --> 00:28:08,480
between I can do pretty much if you know
what so

416
00:28:08,480 --> 00:28:12,669
for just a démonstration of 0

417
00:28:12,669 --> 00:28:15,780
of hollow I was able to big auto

418
00:28:15,780 --> 00:28:18,928
chrome sandbox by exploiting your phone
wonderful day

419
00:28:18,929 --> 00:28:22,340
and it would make a good technical
knowledge get a

420
00:28:22,340 --> 00:28:26,230
you wish 0 it might show right so

421
00:28:26,230 --> 00:28:29,419
the same mechanism for I have a Terry it
worked

422
00:28:29,419 --> 00:28:33,610
let me pick up the port

423
00:28:33,610 --> 00:28:36,719
and if I do 44

424
00:28:36,720 --> 00:28:40,650
I

425
00:28:40,650 --> 00:28:43,980
know I have system privileges out of
will call

426
00:28:43,980 --> 00:28:50,230
so now I can say skin

427
00:28:50,230 --> 00:28:53,450
I can do

428
00:28:53,450 --> 00:28:57,600
anything i wud full control over cabinet
which I just created

429
00:28:57,600 --> 00:29:01,159
right so basically i've priest out of
Google Chrome

430
00:29:01,160 --> 00:29:04,900
so by explaining your phone want to
break into pieces and book

431
00:29:04,900 --> 00:29:09,880
p right so

432
00:29:09,880 --> 00:29:14,140
so then the question is

433
00:29:14,140 --> 00:29:18,000
is a problem so overdose

434
00:29:18,000 --> 00:29:21,390
to assess and what has been the most
when he came out because like almost

435
00:29:21,390 --> 00:29:21,780
like

436
00:29:21,780 --> 00:29:25,780
nineteen years back he's been there I
the quantum got popular

437
00:29:25,780 --> 00:29:28,850
so but think that change no

438
00:29:28,850 --> 00:29:31,799
though people are getting more
sophisticated attacks are getting more

439
00:29:31,799 --> 00:29:32,580
sophisticated

440
00:29:32,580 --> 00:29:36,689
we have book you kind of malware which
is packard with a cone

441
00:29:36,690 --> 00:29:40,460
and and stuff but there well that's a
different actor

442
00:29:40,460 --> 00:29:44,510
for in the last two years a class four
and a half years I would say

443
00:29:44,510 --> 00:29:48,669
25 go toward wanna but it is a fax from
by Microsoft

444
00:29:48,669 --> 00:29:52,370
in 2012 and 14 the last five months

445
00:29:52,370 --> 00:29:55,979
I i'm I know that in June there were few
more packages bit

446
00:29:55,980 --> 00:30:00,370
so as you can see two from me a
statistics point of view it's though

447
00:30:00,370 --> 00:30:03,399
close to a hundred-person Utah unify
unify

448
00:30:03,400 --> 00:30:07,290
growth to see wreck so call more
practice

449
00:30:07,290 --> 00:30:10,428
and wannabes are getting serious they
are going exploring and this

450
00:30:10,429 --> 00:30:13,870
is a serious problem right to you you
can totally expect

451
00:30:13,870 --> 00:30:17,250
matter where it is going to be are all
of this and boxes

452
00:30:17,250 --> 00:30:20,820
pretty song and it's offered is already
happening right because

453
00:30:20,820 --> 00:30:24,809
the fundamental architecture design
issues you just cannot do anything about

454
00:30:24,809 --> 00:30:25,270
them

455
00:30:25,270 --> 00:30:28,760
so a application sandbox

456
00:30:28,760 --> 00:30:31,830
some important points you're right so
for the fall

457
00:30:31,830 --> 00:30:36,340
ago applications handbook is a
fundamental fundamentally wonderful

458
00:30:36,340 --> 00:30:40,370
to cornerbacks period a

459
00:30:40,370 --> 00:30:44,520
and in this as the monstrous a by
putting some of the common me

460
00:30:44,520 --> 00:30:47,980
why use and boxes a the sandboxes

461
00:30:47,980 --> 00:30:51,010
completely breach got offended just
penetrate for the

462
00:30:51,010 --> 00:30:54,960
sandbox by hoping to some a system
causing on

463
00:30:54,960 --> 00:30:58,780
and as a demonstrative leading leading
off sandboxes

464
00:30:58,780 --> 00:31:02,908
is not really defense and that want any
protect you anymore than

465
00:31:02,909 --> 00:31:06,919
word from dis by one sandbox so

466
00:31:06,919 --> 00:31:10,530
a the the fundamental argument is this
the

467
00:31:10,530 --> 00:31:13,530
attack surface of the commodity

468
00:31:13,530 --> 00:31:17,710
operating system like Windows seven
Windows 8 a

469
00:31:17,710 --> 00:31:21,080
the college very large and that is no

470
00:31:21,080 --> 00:31:24,590
reasonable hope that know all this would
be secured right

471
00:31:24,590 --> 00:31:27,750
so as long as you have a one above
Connell

472
00:31:27,750 --> 00:31:31,140
always have a wonderful sandbox so be
just

473
00:31:31,140 --> 00:31:34,750
use console that right with a huge back
surface

474
00:31:34,750 --> 00:31:38,010
reading for you out there we preach
basically

475
00:31:38,010 --> 00:31:42,200
so so no comes a point of isolation so

476
00:31:42,200 --> 00:31:45,640
isolation is important sandboxing
differently go to some extent

477
00:31:45,640 --> 00:31:49,530
a good cannot cover all the fact that
this so if you are looking at

478
00:31:49,530 --> 00:31:52,760
isolation so what are the other
alternatives right

479
00:31:52,760 --> 00:31:58,419
so you could possibly that and operating
system in a sandbox was that

480
00:31:58,419 --> 00:32:01,780
though was wonderful to do you think the
con wannabes

481
00:32:01,780 --> 00:32:04,990
and so on are non-fatal which means that

482
00:32:04,990 --> 00:32:09,169
you could leverage a were too much skin
for instance 0

483
00:32:09,169 --> 00:32:12,500
and use that in Wyoming for doing your
mouth and MSS

484
00:32:12,500 --> 00:32:15,630
or your browsing and so on because a

485
00:32:15,630 --> 00:32:18,630
for that though management has to preach
out of

486
00:32:18,630 --> 00:32:22,429
the hypervisor which is far more
difficult than just a cool

487
00:32:22,429 --> 00:32:26,710
because the tax office is very small
although in in this approach the hyper

488
00:32:26,710 --> 00:32:28,510
was in the supporting environment would

489
00:32:28,510 --> 00:32:32,150
still be an attack vector because you
need to bring in my man phone at work

490
00:32:32,150 --> 00:32:36,190
right but it because I would be far
smaller

491
00:32:36,190 --> 00:32:39,409
and defensible compared to trying to
protect against

492
00:32:39,409 --> 00:32:43,450
every Wisco thats every one ability
right

493
00:32:43,450 --> 00:32:46,840
and for a bus a isolation you need to
select

494
00:32:46,840 --> 00:32:50,780
a security solution which has been
designed

495
00:32:50,780 --> 00:32:54,899
up security hyper ways in which has been
designed with security in mind

496
00:32:54,899 --> 00:32:58,580
and not just a general purpose
hypervisor

497
00:32:58,580 --> 00:33:02,000
like nope we invade or whatever

498
00:33:02,000 --> 00:33:05,470
right so because it has to be security
send pic so that

499
00:33:05,470 --> 00:33:08,880
its both part of an and implemented
right

500
00:33:08,880 --> 00:33:12,820
so up just to conclude 0 evaluate your

501
00:33:12,820 --> 00:33:15,939
defense in depth architecture
particularly how

502
00:33:15,940 --> 00:33:19,159
Brazilian it is to your the attacks

503
00:33:19,159 --> 00:33:22,520
remember that it is not feasible

504
00:33:22,520 --> 00:33:26,210
to defend against could more attacks
from within the con

505
00:33:26,210 --> 00:33:30,800
know when you have a sandbox from the
car it cannot defend the game attacks

506
00:33:30,800 --> 00:33:34,620
on the call a you know when I listen to
what we found

507
00:33:34,620 --> 00:33:37,800
type be were far more wonderful

508
00:33:37,800 --> 00:33:41,830
been I P mean that Sandboxie and was
gonna send boxes

509
00:33:41,830 --> 00:33:44,908
are are very easy to bypass and reach
out of because

510
00:33:44,909 --> 00:33:48,960
they have up they need to allow between
execution of

511
00:33:48,960 --> 00:33:55,260
programs and content so they need to be
far more relaxing Dec security controls

512
00:33:55,260 --> 00:33:59,710
and definitely avoid melvin alice is
inside applications and boxing

513
00:33:59,710 --> 00:34:03,110
you know it you asking for trouble if
you're doing that 'cause

514
00:34:03,110 --> 00:34:06,540
matter is getting very sophisticated and
of course

515
00:34:06,540 --> 00:34:09,730
a sandbox in a sandbox is not really
different and that

516
00:34:09,730 --> 00:34:13,109
doesn't it doesn't change much and

517
00:34:13,109 --> 00:34:16,889
yeah choose wisely and face a friend
some critics oh my

518
00:34:16,889 --> 00:34:21,210
political world me on this and sold the
pasta or

519
00:34:21,210 --> 00:34:25,070
resource on similar on some the topic

520
00:34:25,070 --> 00:34:32,070
and that's it thank you

521
00:34:35,190 --> 00:34:42,190
any questions

522
00:34:44,330 --> 00:34:46,918
liability I think it'll increase

523
00:34:46,918 --> 00:34:51,100
a up because if you look at

524
00:34:51,100 --> 00:34:54,130
the current the way things are

525
00:34:54,130 --> 00:34:58,530
in the industry right now on the user
mode is a lot of protection you have

526
00:34:58,530 --> 00:35:02,740
that DSLR so just to write a simple
expert for a browser

527
00:35:02,740 --> 00:35:06,089
do a lot of work but there's not much on
the corner space

528
00:35:06,090 --> 00:35:10,050
right so there have been some
enhancements like

529
00:35:10,050 --> 00:35:13,770
intel has come to come up with something
called S&P a

530
00:35:13,770 --> 00:35:17,940
which is which is for enabling mode some
animal products on the korean war

531
00:35:17,940 --> 00:35:19,070
exploits payloads

532
00:35:19,070 --> 00:35:23,270
although you can do Roop base gadgets to
bypass that it's been on

533
00:35:23,270 --> 00:35:26,660
so there have been some intent on the
hardware side

534
00:35:26,660 --> 00:35:30,080
and Windows 8 x3 leverages SMTP from
though

535
00:35:30,080 --> 00:35:34,650
from the CPU but a I think cuomo's going
to be

536
00:35:34,650 --> 00:35:37,700
something a which is very difficult to
detect point since

537
00:35:37,700 --> 00:35:41,210
every endpoint technology which is a
pretty much it cannot

538
00:35:41,210 --> 00:35:45,390
protect or defend against Collingwood
exploits because whatever your events on

539
00:35:45,390 --> 00:35:45,810
your

540
00:35:45,810 --> 00:35:49,810
with is relying on me call more making
it

541
00:35:49,810 --> 00:35:53,930
back in the cold very similar to
applications and boxes so any calm or

542
00:35:53,930 --> 00:35:54,660
exploit

543
00:35:54,660 --> 00:35:58,839
preach everything that you have when you
in point today so it's a it's a very

544
00:35:58,840 --> 00:36:02,770
I would say so lucrative attack richter
from an attack this point of view

545
00:36:02,770 --> 00:36:09,770
you can bypass punitive you

546
00:36:11,520 --> 00:36:16,160
yep

547
00:36:16,160 --> 00:36:21,100
fight

548
00:36:21,100 --> 00:36:26,410
you have to be a

549
00:36:26,410 --> 00:36:27,339
yeah

550
00:36:27,340 --> 00:36:30,080
any yeah so in this in this exploit

551
00:36:30,080 --> 00:36:33,810
I actually was a low prevalence user and
I

552
00:36:33,810 --> 00:36:37,299
exporting mcconnell in a slid my
privileges

553
00:36:37,300 --> 00:36:40,710
so it its this the attacks are
applicable for every

554
00:36:40,710 --> 00:36:44,550
user which is why it is so serious
because want to compromise the corn

555
00:36:44,550 --> 00:36:47,830
you have system it's going to set me
straight or

556
00:36:47,830 --> 00:36:51,060
its complete bypass began

557
00:36:51,060 --> 00:36:58,060
all

558
00:37:02,270 --> 00:37:09,270
brokering from moscow to sleep

559
00:37:10,040 --> 00:37:14,480
so to do very likely that more was
pretty well

560
00:37:14,480 --> 00:37:19,560
the brokering of the Mosin sleeve I
would say that's a pretty reasonable

561
00:37:19,560 --> 00:37:23,960
so with Martin forman applications and
book porn tube you

562
00:37:23,960 --> 00:37:27,070
and Google Chrome and will come as a No

563
00:37:27,070 --> 00:37:30,160
remarkable job of maintaining that more
and

564
00:37:30,160 --> 00:37:33,980
very defensible I would say but a but

565
00:37:33,980 --> 00:37:38,230
you cannot brought everything like for
instance their legitimate with

566
00:37:38,230 --> 00:37:42,890
right so if I'm requesting for iPhone
parts from the browser

567
00:37:42,890 --> 00:37:47,500
or from a Word document a the color
doesn't notice that would request that a

568
00:37:47,500 --> 00:37:47,920
bad

569
00:37:47,920 --> 00:37:50,950
with hassidic bus and that's the moment
when I

570
00:37:50,950 --> 00:37:55,790
biscuit bypass that restriction you
cannot

571
00:37:55,790 --> 00:37:59,570
there is no easy for you to figure out
of this you need to have signature-based

572
00:37:59,570 --> 00:38:00,270
detection

573
00:38:00,270 --> 00:38:03,380
something crazy like that or some kind
of sanity

574
00:38:03,380 --> 00:38:06,420
said edition of phone flies before you

575
00:38:06,420 --> 00:38:09,470
XQ good building on previous definitely

576
00:38:09,470 --> 00:38:16,470
to Texas

577
00:38:18,870 --> 00:38:21,990
alright

578
00:38:21,990 --> 00:38:22,939
okay then thank you very much

