1
00:00:00,320 --> 00:00:03,550
lol and my presentation is

2
00:00:03,550 --> 00:00:06,890
Rex versus the romance wrecked is one of
my docs

3
00:00:06,890 --> 00:00:12,429
the Romans their is i can't. and as you
can see they are fearless fighter is off

4
00:00:12,429 --> 00:00:13,330
the internet

5
00:00:13,330 --> 00:00:18,280
and so let's help them just a political
disclaimer

6
00:00:18,280 --> 00:00:22,170
air I'm not against them and this kind
of tools if they're

7
00:00:22,170 --> 00:00:26,740
correctly is to and the bad guys and the
problem is day it's

8
00:00:26,740 --> 00:00:31,680
we have no idea who is using these tools
so I'm against them by Principal

9
00:00:31,680 --> 00:00:36,780
on this on is three and tell Thursday
its power is abused and I'm

10
00:00:36,780 --> 00:00:40,579
you know the the rest of the story when
my

11
00:00:40,579 --> 00:00:45,579
I use it worked for Thomas Lee one of
these days I walk up in there

12
00:00:45,579 --> 00:00:50,140
a great idea I'm going to be a white X
boom

13
00:00:50,140 --> 00:00:54,769
stupid idea her from

14
00:00:54,769 --> 00:01:00,989
you're not leaving the country okay fire
I asked me if I wanted to work here so i

15
00:01:00,989 --> 00:01:01,260
cant

16
00:01:01,260 --> 00:01:04,409
its I'm OK don't you know I like
Singapore so

17
00:01:04,409 --> 00:01:07,579
okay so I'm showing tryin trying to make
your

18
00:01:07,579 --> 00:01:11,070
enterprise max Mar secure not law

19
00:01:11,070 --> 00:01:14,320
bunch of I'm not sure if this is going
to be possible

20
00:01:14,320 --> 00:01:17,979
and blah blah blah blah I already know
me hopefully so

21
00:01:17,979 --> 00:01:23,570
acting team for the fuck are you the
first votes send a ty havier

22
00:01:23,570 --> 00:01:27,700
it was a bit more aggressive I talked to
some people and it'll be okay toned down

23
00:01:27,700 --> 00:01:28,240
a bit

24
00:01:28,240 --> 00:01:31,280
I told them back no but

25
00:01:31,280 --> 00:01:34,890
I decided then to care few planes that
were

26
00:01:34,890 --> 00:01:39,719
a bit more aggressive and the last full
an hour to last

27
00:01:39,719 --> 00:01:42,250
than able they are near unable to write
a rootkit

28
00:01:42,250 --> 00:01:46,289
at least I never saw something useful
for from them

29
00:01:46,289 --> 00:01:51,360
and they are unable to write a packer I
was talking to Nick was blessed either

30
00:01:51,360 --> 00:01:55,579
awesome position its return and he told
me added that shit is

31
00:01:55,579 --> 00:01:59,500
back ship so of the both pretty sure

32
00:01:59,500 --> 00:02:03,439
an introduction to the dropper which is
better weekly

33
00:02:03,439 --> 00:02:06,560
what they him install after to exploit

34
00:02:06,560 --> 00:02:10,729
that some fun seeing at least a half
five or six samples

35
00:02:10,729 --> 00:02:14,590
they always install the binaries of the
back doors and

36
00:02:14,590 --> 00:02:19,069
into that folder easy to detect have no
idea why did they do this

37
00:02:19,069 --> 00:02:23,440
you can do in many different ways it's
delivered via exploits

38
00:02:23,440 --> 00:02:27,840
me know about plus works air some people
say about the

39
00:02:27,840 --> 00:02:31,250
those evil guys of who bear I have no
idea that's not my

40
00:02:31,250 --> 00:02:35,410
my area and I was to a blanket on their
time so I don't care

41
00:02:35,410 --> 00:02:40,000
the Sohae things usually less than one
megabyte so it's a very small

42
00:02:40,000 --> 00:02:43,600
the latest versions they decided to pack
these be

43
00:02:43,600 --> 00:02:46,970
embrace so you know what's

44
00:02:46,970 --> 00:02:50,380
I'm impressed this is my first

45
00:02:50,380 --> 00:02:54,220
I Coco a HAP ID say look a like me right
and I'm packer

46
00:02:54,220 --> 00:02:57,700
I just need to put the back toward their
and save

47
00:02:57,700 --> 00:03:01,190
dampen that's it there there goes the
protection of

48
00:03:01,190 --> 00:03:04,260
packer I have no idea why they be that
so let's

49
00:03:04,260 --> 00:03:08,709
10 the Romans the first one is
threatened BSD

50
00:03:08,709 --> 00:03:11,859
he's one of my favorites components in
Mac OS

51
00:03:11,859 --> 00:03:15,470
it's a mandatory access control it or at
origin

52
00:03:15,470 --> 00:03:18,639
am FreeBSD I

53
00:03:18,639 --> 00:03:22,030
is the base technology used by Epperson
box

54
00:03:22,030 --> 00:03:25,130
also I US Code Signing air

55
00:03:25,130 --> 00:03:28,930
basically it has many hooks installed in
very different places in the kernel

56
00:03:28,930 --> 00:03:32,549
it's very depressing we just need to
register to call backs

57
00:03:32,549 --> 00:03:36,280
and to get the data from the kernel into
your kernel extension

58
00:03:36,280 --> 00:03:39,880
its very first it's very stable it
doesn't require

59
00:03:39,880 --> 00:03:44,269
any hooking tricks anything and so it's
one of my favorite features of

60
00:03:44,269 --> 00:03:47,419
EPL I'm going to bash EPL at them
because they are

61
00:03:47,419 --> 00:03:52,310
they want to close this stuff one very
interesting Hokies deserve you know

62
00:03:52,310 --> 00:03:53,769
check is a kook

63
00:03:53,769 --> 00:03:56,959
it can allow you to to shake

64
00:03:56,959 --> 00:04:00,049
was going to execute so these before

65
00:04:00,049 --> 00:04:03,489
execution you want to execute a binary
Dizon oath

66
00:04:03,489 --> 00:04:07,790
at these hook is called and you can do
some stuff some interesting stuff

67
00:04:07,790 --> 00:04:10,850
is the one is for example why I US Code
Signing

68
00:04:10,850 --> 00:04:13,880
235 for binary is quotes I mean you want
to the

69
00:04:13,880 --> 00:04:17,669
these before execution else and bad
things can happen but

70
00:04:17,669 --> 00:04:21,540
they still happen air it's an
opportunity to observe what is going to

71
00:04:21,540 --> 00:04:21,910
be

72
00:04:21,910 --> 00:04:26,100
executed on the machine and optionally
you can make a decision

73
00:04:26,100 --> 00:04:29,259
to execute our to not execute if you
want to just observe

74
00:04:29,259 --> 00:04:32,419
you always say execute I don't care I
just want to

75
00:04:32,419 --> 00:04:36,340
take a peek of what's happening this is
then

76
00:04:36,340 --> 00:04:40,440
structure at the finish in the
definition the prototype of the function

77
00:04:40,440 --> 00:04:41,180
of this book

78
00:04:41,180 --> 00:04:45,350
am that field though VB is the
interesting one because it's the

79
00:04:45,350 --> 00:04:49,770
the note that is going to be executed
you can get the pass of the binary

80
00:04:49,770 --> 00:04:53,050
it just need to use that function there
you can do mainly

81
00:04:53,050 --> 00:04:56,800
reconstruct the Vino get everything
yourself or you can use this function

82
00:04:56,800 --> 00:05:01,070
succinct as some comments K

83
00:05:01,070 --> 00:05:07,350
not going to end well

84
00:05:07,350 --> 00:05:14,250
it I so

85
00:05:14,250 --> 00:05:17,780
if we find we when you want to execute a

86
00:05:17,780 --> 00:05:20,880
the binary we get the pass of the binary

87
00:05:20,880 --> 00:05:23,910
and if the sex ful the the sites fall

88
00:05:23,910 --> 00:05:29,500
and a the really

89
00:05:29,500 --> 00:05:32,699
I mp3

90
00:05:32,699 --> 00:05:36,840
have sorry for acting team is trying to
execute their baked or

91
00:05:36,840 --> 00:05:40,930
we just need to match to the pass and
lol

92
00:05:40,930 --> 00:05:44,530
its second team trying to install some
backdoor because a clean system

93
00:05:44,530 --> 00:05:48,850
doesn't run binaries from that's badass
and these weekly

94
00:05:48,850 --> 00:05:52,850
the trick that you used to bedecked in a
system that is already

95
00:05:52,850 --> 00:05:55,880
infected next one and okay

96
00:05:55,880 --> 00:06:00,220
is just a piece of coal tool get that
passed to the funeral just

97
00:06:00,220 --> 00:06:04,990
bullshit next feature chaos this is the
Kern authorization framework

98
00:06:04,990 --> 00:06:09,120
another feature of my quest that I
really like it it was introducing

99
00:06:09,120 --> 00:06:12,310
Tiger if I'm not mistaken you'll have
that technical note:

100
00:06:12,310 --> 00:06:15,710
and if you want to know more it's there

101
00:06:15,710 --> 00:06:19,490
mechanism that happens says if you want
to build the Navy

102
00:06:19,490 --> 00:06:22,670
do this just isn't a phrase they have

103
00:06:22,670 --> 00:06:26,190
for built-in scopes to get the
information they have the process

104
00:06:26,190 --> 00:06:30,090
which is basically useless the generic

105
00:06:30,090 --> 00:06:33,200
which is not even more useful and

106
00:06:33,200 --> 00:06:36,900
you have the final Britian which is good
for get notifications but it's not very

107
00:06:36,900 --> 00:06:38,050
powerful

108
00:06:38,050 --> 00:06:41,690
and if the north which is more powerful
but it does some problems

109
00:06:41,690 --> 00:06:45,730
about that lots and other stuff that
need to be careful

110
00:06:45,730 --> 00:06:49,040
just 32 the fermentation the technical
they specific fight

111
00:06:49,040 --> 00:06:53,380
that stuff for today air the file
operation scope is enough because I just

112
00:06:53,380 --> 00:06:55,340
want to get a notification of what

113
00:06:55,340 --> 00:06:59,570
is being written to the file system
there you have many different actions

114
00:06:59,570 --> 00:07:02,470
there is one which is the chaos file up

115
00:07:02,470 --> 00:07:06,360
close the in notifies you when the
filesystem

116
00:07:06,360 --> 00:07:09,720
when you get to a close on a filesystem
object

117
00:07:09,720 --> 00:07:13,210
may be here is to detect the exploits of

118
00:07:13,210 --> 00:07:16,340
the dropper of hacking team writing to
their to pass

119
00:07:16,340 --> 00:07:23,340
the binary nothing great complete

120
00:07:24,270 --> 00:07:26,520
me

121
00:07:26,520 --> 00:07:28,230
is not

122
00:07:28,230 --> 00:07:31,170
drinking water had hero

123
00:07:31,170 --> 00:07:34,290
react euros now you know resemblance

124
00:07:34,290 --> 00:07:40,710
K

125
00:07:40,710 --> 00:07:44,480
logged I

126
00:07:44,480 --> 00:07:49,750
the problem

127
00:07:49,750 --> 00:07:53,270
we've this hawk is that you get 95 about

128
00:07:53,270 --> 00:07:58,250
from all with I'll oppose abrasions this
generates too much rise because it

129
00:07:58,250 --> 00:07:58,880
doesn't mean

130
00:07:58,880 --> 00:08:04,110
and and a just open Andrea and closing
right and whatever

131
00:08:04,110 --> 00:08:08,590
we just want the ones related to rights
we want stuff to detect processes

132
00:08:08,590 --> 00:08:10,200
writing stuff to the filesystem

133
00:08:10,200 --> 00:08:13,350
EPL are nice guys and they have a flag

134
00:08:13,350 --> 00:08:17,740
dislike chaos file up-close modified
indictment

135
00:08:17,740 --> 00:08:22,330
it is set if the file modified the the
modified file

136
00:08:22,330 --> 00:08:26,560
is being close soaps if someone price
right something to the first system

137
00:08:26,560 --> 00:08:29,860
this flag is set: and we can detect this

138
00:08:29,860 --> 00:08:34,409
this is that prototype of this function
of the of a listener but I installed

139
00:08:34,409 --> 00:08:37,729
it's their arguments to where'd the flag
is

140
00:08:37,729 --> 00:08:41,669
so the idea as: we stole a file

141
00:08:41,669 --> 00:08:45,480
file listener we can are all the actions
we just want the polls action

142
00:08:45,480 --> 00:08:49,150
we analyze the ones that have that's
like set because it means it's

143
00:08:49,150 --> 00:08:53,200
rights then we can get the file size:
information from the

144
00:08:53,200 --> 00:08:57,040
you know because it contains that
information we can reap that information

145
00:08:57,040 --> 00:08:59,950
in the kernel just check my presentation
last year you'll

146
00:08:59,950 --> 00:09:03,140
out to relieve files from the kernel and
give

147
00:09:03,140 --> 00:09:08,190
weekend refight if it's a Mac whole file
because all kind of data is written to

148
00:09:08,190 --> 00:09:10,060
the file system but we just want

149
00:09:10,060 --> 00:09:14,660
binary smack or binders if it's a Mac or
binary

150
00:09:14,660 --> 00:09:18,180
it just need to check again to pass if
it matches US

151
00:09:18,180 --> 00:09:22,600
users livor users whatever username
you're using library preferences

152
00:09:22,600 --> 00:09:26,570
this is some be difficult to get the
information

153
00:09:26,570 --> 00:09:29,960
and from the few notes you just want
basically 21

154
00:09:29,960 --> 00:09:34,290
to get the size so we can you know all
to look at the bar for analyzing gets

155
00:09:34,290 --> 00:09:35,120
all the information

156
00:09:35,120 --> 00:09:39,520
what are two completions it's a very
simple kernel extension it compiles 220

157
00:09:39,520 --> 00:09:40,339
K i sync

158
00:09:40,339 --> 00:09:43,430
probably in it with some optimization
can be even smaller

159
00:09:43,430 --> 00:09:46,570
it's very stable fast and it to eat as

160
00:09:46,570 --> 00:09:51,410
minimal impact the system trust me I'm
giving a products and I know

161
00:09:51,410 --> 00:09:58,260
this is very stable fast and Barack a

162
00:09:58,260 --> 00:10:01,780
one nest pay the bills a.m.

163
00:10:01,780 --> 00:10:06,280
so and I think attacking team changes
the folder well Let The Right Stuff

164
00:10:06,280 --> 00:10:09,959
this is an assumption air it detects
every single

165
00:10:09,959 --> 00:10:14,940
arson so my aviation because the tool
fans

166
00:10:14,940 --> 00:10:19,370
detects everything over sin of lacking
team stuff

167
00:10:19,370 --> 00:10:25,700
it's compatible send an extra rules I
don't wanna

168
00:10:25,700 --> 00:10:32,700
you know that health but not I have two
ranks again tech against Apple

169
00:10:32,730 --> 00:10:35,220
rules are rules you know also

170
00:10:35,220 --> 00:10:41,610
rules up

171
00:10:41,610 --> 00:10:48,610
hap

172
00:10:49,100 --> 00:10:52,710
so it's compatible down to Snow Leopard
bro you can years we've

173
00:10:52,710 --> 00:10:56,710
Tiger I'm not sure if dress BSD was
implemented the Indian tiger I think not

174
00:10:56,710 --> 00:10:59,860
it so it's just Snow Leopard I just care

175
00:10:59,860 --> 00:11:03,300
and we have the mountain lion and
maverick's but

176
00:11:03,300 --> 00:11:07,500
it can you can work with Snow Leopard
there's the false-positive

177
00:11:07,500 --> 00:11:11,170
yet she issues because we are just
matching that bath

178
00:11:11,170 --> 00:11:14,860
it's not the best touristic

179
00:11:14,860 --> 00:11:19,270
I can tell you I have more advanced
stuff but its proper attire from the

180
00:11:19,270 --> 00:11:21,660
company blah blah alas I cannot give it
up

181
00:11:21,660 --> 00:11:25,490
air but it's not that difficult to
detect tacking team stuff

182
00:11:25,490 --> 00:11:28,580
there's also the a V Munster

183
00:11:28,580 --> 00:11:32,170
proof of concept that I really do like
two years ago or whatever

184
00:11:32,170 --> 00:11:36,700
which basically attacks the chaos and my
view is I think last week

185
00:11:36,700 --> 00:11:41,570
some blog post attacking dressed BST so
if you have a kernel exploit

186
00:11:41,570 --> 00:11:45,339
at you have some problems with these
because again over right one by turtle

187
00:11:45,339 --> 00:11:47,290
bites and he's able these systems

188
00:11:47,290 --> 00:11:51,870
so we be careful with these assumptions
now the rant against Apple

189
00:11:51,870 --> 00:11:56,180
open its worse her the last 5 five shots
of whiskey

190
00:11:56,180 --> 00:11:59,920
the code signing an apple air into
dissident

191
00:11:59,920 --> 00:12:04,580
in maverick Scott signing mandatory
consigning far to kernel extensions it's

192
00:12:04,580 --> 00:12:06,709
still not mandatory but you get a
warning

193
00:12:06,709 --> 00:12:10,660
and last year I presented out to kill
that warning but its

194
00:12:10,660 --> 00:12:14,760
annoying if you want to really is a
public to I'm not sure what is the idea

195
00:12:14,760 --> 00:12:19,040
they must be afraid of kernel rootkits
our dates just want to close access to

196
00:12:19,040 --> 00:12:19,709
the colonel

197
00:12:19,709 --> 00:12:24,160
this is the icing the official excuse
people create kernel extensions

198
00:12:24,160 --> 00:12:28,000
do not get into the kernel this is one
of the few show notes or

199
00:12:28,000 --> 00:12:31,540
some stuff they publish an email not
getting the kernel the kernel these

200
00:12:31,540 --> 00:12:35,050
their caused area you don't know all
what

201
00:12:35,050 --> 00:12:39,089
what you are doing do not get there at
least I am lucky because

202
00:12:39,089 --> 00:12:42,980
ever a company that got the certificate
so I can play with this stuff

203
00:12:42,980 --> 00:12:47,300
I want to relieve the pain retool maybe
I will spend the 99

204
00:12:47,300 --> 00:12:51,310
dollars then make the request and that
will give me the certificate so I can

205
00:12:51,310 --> 00:12:52,280
release the tool

206
00:12:52,280 --> 00:12:55,760
to the public the other randy is against
dress BST

207
00:12:55,760 --> 00:12:59,250
if you compile occurred like session
with the SDK for

208
00:12:59,250 --> 00:13:02,320
may breaks and they get a warning
warning

209
00:13:02,320 --> 00:13:07,230
this stuff he's not for you to use it's
going to get calls from the next person

210
00:13:07,230 --> 00:13:11,589
I have no idea why because first BST one
of the best features

211
00:13:11,589 --> 00:13:16,650
that they ported to to michael has I
hope they get back on that decision

212
00:13:16,650 --> 00:13:20,180
because again field a roosevelt very
interesting stuff

213
00:13:20,180 --> 00:13:23,360
on on this and it's very stable on
system

214
00:13:23,360 --> 00:13:28,650
be careful with assumptions at this
presentation as usual as a few

215
00:13:28,650 --> 00:13:32,440
question them and you can work around
it's always a

216
00:13:32,440 --> 00:13:36,240
circle game man it assume something

217
00:13:36,240 --> 00:13:40,520
you protect their and their is another
assumption so be careful

218
00:13:40,520 --> 00:13:43,750
we'd this stuff always question your
assumptions

219
00:13:43,750 --> 00:13:46,850
greetings you for listening to me

220
00:13:46,850 --> 00:13:51,579
and The Godfather miss atomic claim it
was a pleasure working with you and you

221
00:13:51,579 --> 00:13:52,910
are a great friend and

222
00:13:52,910 --> 00:13:57,640
everything fell apart I

223
00:13:57,640 --> 00:14:02,029
the but you gotta go on

224
00:14:02,029 --> 00:14:05,370
you wanna go on know you act the last
one

225
00:14:05,370 --> 00:14:08,560
day for free

226
00:14:08,560 --> 00:14:12,029
a my god I for real good last night

227
00:14:12,029 --> 00:14:16,000
you have my blog you have the key term
I'm going to publish the coat forties

228
00:14:16,000 --> 00:14:19,750
there when I arrived home which is
Monday obscures the

229
00:14:19,750 --> 00:14:23,480
anyways my email feel free to when I me
ask questions

230
00:14:23,480 --> 00:14:26,750
if i dont answer as usual in a week or
something

231
00:14:26,750 --> 00:14:31,650
send again and send the stang reply my
email because if I don't reply now they

232
00:14:31,650 --> 00:14:33,690
are too weak go to the queue when

233
00:14:33,690 --> 00:14:37,730
I get more interesting stuff to do if
you want to follow me on twitter

234
00:14:37,730 --> 00:14:42,680
that's my Twitter probably should not
follow me and Mel B's because we start

235
00:14:42,680 --> 00:14:43,850
rolling air

236
00:14:43,850 --> 00:14:46,900
it it will you look at a lot of nyse:

237
00:14:46,900 --> 00:14:50,780
so pro issue is should split between me
and the LB's

238
00:14:50,780 --> 00:14:54,240
I don't recommend you to select sports
that's it

