1
00:00:00,120 --> 00:00:06,490
last year's I most of the time talked
about iOS this year I will go back to

2
00:00:06,490 --> 00:00:16,460
basics so I'm talking about singing the
the ship so sorry this is not about

3
00:00:16,460 --> 00:00:22,760
actually ships is not about Titanic part
to its about what Apple calls system

4
00:00:22,760 --> 00:00:30,910
integrity protection and I will first
explain what it actually is and then I

5
00:00:30,910 --> 00:00:37,550
show several weaknesses in it like very
few of those are actually fixed right

6
00:00:37,550 --> 00:00:40,870
now

7
00:00:40,870 --> 00:01:08,050
so what system last few months before
the WWDC the media and wondering how

8
00:01:08,050 --> 00:01:15,270
does the root user and things like that
and after eight when was finally

9
00:01:15,270 --> 00:01:20,619
released we realize that it's actually
not a route less system it's more like a

10
00:01:20,619 --> 00:01:28,710
root user that can do less and the other
thing is while it is officially branded

11
00:01:28,710 --> 00:01:35,580
system integrity protection now the
string fruitless everywhere to be found

12
00:01:35,580 --> 00:01:40,500
in this protection and also the very
very basic core of this implementation

13
00:01:40,500 --> 00:01:45,610
was already actually public in the
source code of justice committee so the

14
00:01:45,610 --> 00:01:50,899
term rootless have ya surprise to
anybody because it was already public

15
00:01:50,899 --> 00:01:53,620
the name

16
00:01:53,620 --> 00:02:04,890
so what is Apple's idea behind this I i
watched WWDC talk from 2015 online and

17
00:02:04,890 --> 00:02:10,369
they had to slide where the said that
the problem was root users on Mac OS X

18
00:02:10,369 --> 00:02:15,870
is that often uses have simple pass
routes and Austin the admin user is

19
00:02:15,870 --> 00:02:21,610
automatically the everyday user so
Reuters basically only protected by

20
00:02:21,610 --> 00:02:28,040
simple password also the other
motivation they say is basically Reuters

21
00:02:28,040 --> 00:02:33,700
only a single privilege escalation away
and that would be bad if just getting

22
00:02:33,700 --> 00:02:40,079
root means the whole system is
compromised and so the idea behind sip

23
00:02:40,080 --> 00:02:45,880
is apparently to lock the system down
from the root user saw the idea is to

24
00:02:45,880 --> 00:02:51,430
make it impossible for the reuters are
due to everything that will be required

25
00:02:51,430 --> 00:02:55,320
to take over the system and the
intention behind that is most probably

26
00:02:55,320 --> 00:03:01,870
that malware that is showing up for was
not supposed to be able to totally

27
00:03:01,870 --> 00:03:06,709
compromised a system just because a user
may be entered his password

28
00:03:09,280 --> 00:03:18,970
when you think about this can be
imagined like this on a normal system

29
00:03:18,970 --> 00:03:23,400
without sip you have your processors
some of the processes might run in the

30
00:03:23,400 --> 00:03:29,459
sent box and now the idea of soup is
basically that the whole thing is put

31
00:03:29,459 --> 00:03:34,720
into another sent box and internal
dissent boxes called the platform

32
00:03:34,720 --> 00:03:42,670
profile there is some bull in the Indian
descent books travel that felt like this

33
00:03:42,670 --> 00:03:51,299
and yeah this is how you must imagine
chip in on top of this sandbox there's

34
00:03:51,300 --> 00:03:56,220
also a few additional checks that were
introduced that are not directly related

35
00:03:56,220 --> 00:03:59,220
to the sent box

36
00:04:00,310 --> 00:04:09,670
so to clear up confusion shows soup it's
not a protection against channel memory

37
00:04:09,670 --> 00:04:16,500
corruption box it's absolutely not
assigned to do that and when therefore

38
00:04:16,500 --> 00:04:19,980
when someone's goes on stage and shows a
couple exploiting says he has a simple

39
00:04:19,980 --> 00:04:25,630
person is actually completely nonsense
because it was never intended to protect

40
00:04:25,630 --> 00:04:31,830
against those so it's obviously when you
have kernel memory corruption that you

41
00:04:31,830 --> 00:04:38,539
can disable soup suppers more just
bluntly a summation that kernel memory

42
00:04:38,540 --> 00:04:44,450
corruption banks do not available to the
attacker because there may be too hard

43
00:04:44,450 --> 00:04:54,210
to exploit for them they don't exist
this is something that I cannot accept

44
00:04:54,210 --> 00:05:02,580
this idea and I show you why when you
look at the attack surface with on a

45
00:05:02,580 --> 00:05:06,539
system without serb you can see that the
attack surfaced when you're inside a

46
00:05:06,539 --> 00:05:12,390
central location is quite small if you
actually outside of a sandbox then it's

47
00:05:12,390 --> 00:05:18,820
a little bit larger but the singer's the
moment you are roots you have a gigantic

48
00:05:18,820 --> 00:05:27,310
attack surface and the idea of its not
basically bad you take a part of his

49
00:05:27,310 --> 00:05:38,669
attack surface and blacklisted and say
ok our system is no more secure but as

50
00:05:38,669 --> 00:05:44,200
you can see it can only because it's a
blacklisting approach can only blacklist

51
00:05:44,200 --> 00:05:50,479
the part of this whole a text service
and the effect that soup brings new code

52
00:05:50,479 --> 00:05:53,570
into the kernel interviews allen's and
so on and so on

53
00:05:54,190 --> 00:06:00,080
there's actually no new attack surface
like to radically race condition in

54
00:06:00,080 --> 00:06:06,200
jerusalem because they are trying to do
the check very shy something that is

55
00:06:06,200 --> 00:06:10,909
something trusted and then they verified
in the next moment basically assembled

56
00:06:10,909 --> 00:06:11,370
link

57
00:06:11,370 --> 00:06:16,510
willing to switch and it's not trusted
anymore but you you later

58
00:06:20,030 --> 00:06:25,909
also the idea that color box and not
available two attackers seems highly

59
00:06:25,910 --> 00:06:33,320
questionable every time there's a new I
West Sussex release right now especially

60
00:06:33,320 --> 00:06:39,420
you see that Google and some other
companies I also seem like 360 they seem

61
00:06:39,420 --> 00:06:43,420
to invest a lot of money actually in
paying their their own engineers to

62
00:06:43,420 --> 00:06:50,020
actually find a box for Apple so they
get fixed in OS X and the other thing is

63
00:06:50,020 --> 00:06:54,450
because I do some kind of trainings for
colonel I know that there's a lot of

64
00:06:54,450 --> 00:06:59,640
people out there that don't actually
report bucks to a poll from many reasons

65
00:06:59,640 --> 00:07:04,700
some just refused to work for companies
that don't offer some kind of bug

66
00:07:04,700 --> 00:07:11,420
bounties others have hurt very bad info
about the Apple security team like they

67
00:07:11,420 --> 00:07:17,630
don't care and so many many reasons and
others of course these parks

68
00:07:20,070 --> 00:07:30,560
so before we actually start to get a
little technical actually minder maybe

69
00:07:30,560 --> 00:07:35,570
for you so you have no idea what
entitlements are saying this talk we

70
00:07:35,570 --> 00:07:40,230
talk a little bit about entitlements
over and over again and basically the

71
00:07:40,230 --> 00:07:47,510
idea behind entitlements as small XML
snippets that are embedded India digit

72
00:07:47,510 --> 00:07:53,969
code signature of of the executable
binaries so this means they cannot be

73
00:07:53,970 --> 00:08:00,040
changed and the idea of this with this
that they can for example give a binary

74
00:08:00,040 --> 00:08:06,030
permissions that they normally do
wouldn't have comparable from security

75
00:08:06,030 --> 00:08:10,559
point of view 23 binaries but in this
case you're not switching users are so

76
00:08:10,560 --> 00:08:13,640
you just like getting permissions in the
system

77
00:08:15,960 --> 00:08:25,780
the next thing is in a few slides I have
these sent box profile grounds and they

78
00:08:25,780 --> 00:08:30,349
look kinda complicated by the actually
quite simple and the idea is basically

79
00:08:30,349 --> 00:08:34,260
of those except box that you have liked
more than 100 operation that can be

80
00:08:34,260 --> 00:08:39,929
controlled like here for example this
nvm delete which is a princely sum

81
00:08:39,929 --> 00:08:45,120
operation that tries to deliver
something from the non-volatile RAM and

82
00:08:45,120 --> 00:08:49,990
nowadays you also must know that while
he was always the case in iOS but now

83
00:08:49,990 --> 00:08:54,709
this new platform profile the
interesting one is also only kept in

84
00:08:54,709 --> 00:09:03,329
binary form in August six that's why I
in the last years worked on the work of

85
00:09:03,330 --> 00:09:08,040
the all-new original reversed at sandbox
and I pointed it basically to the newer

86
00:09:08,040 --> 00:09:14,699
version fixed all the things and I
released this open toe which can be used

87
00:09:14,700 --> 00:09:20,910
to basically well nowadays you have to
manually extracted binaries depends

88
00:09:20,910 --> 00:09:25,390
because Apple changed from a bit and I
have imported idiots but if you have

89
00:09:25,390 --> 00:09:30,649
extracted two bins from the from the
sandbox driver you can now use that tool

90
00:09:30,649 --> 00:09:33,760
kit to create this kind of grabs

91
00:09:35,930 --> 00:09:42,399
and these graphs actually very easy to
reach you have the operation on top and

92
00:09:42,399 --> 00:09:48,149
then you always have futures and treat a
parameter that check if certain things

93
00:09:48,149 --> 00:09:53,510
about your input is true for example we
have the NVRAM d lead and now we are

94
00:09:53,510 --> 00:09:57,420
trying to seek Envia and urine variable
Rex

95
00:09:57,420 --> 00:10:04,219
there's a check if the variable that we
try to access starts with CSL desh and

96
00:10:04,220 --> 00:10:09,830
then it can be true or false and
obviously green is the true case and

97
00:10:09,830 --> 00:10:16,500
falls as a red case and so this year
basically shows that if you're trying to

98
00:10:16,500 --> 00:10:23,029
delete an invariable that starts with
the next check is if you are running

99
00:10:23,029 --> 00:10:31,740
let's say in recovery mode and if not
then this action is tonight we will see

100
00:10:31,740 --> 00:10:35,030
later why

101
00:10:35,030 --> 00:10:38,030
ok let's get back to this thing

102
00:10:41,130 --> 00:10:51,450
around everything and of course nobody
can model the whole system the default

103
00:10:51,450 --> 00:10:56,230
action the sent box profiles of course
allow and this means that the overall

104
00:10:56,230 --> 00:11:00,290
strategy of SIP therefore must be a
blacklisting approached you first lol

105
00:11:00,290 --> 00:11:04,890
everything and then you pick out certain
things that you considered dangerous

106
00:11:04,890 --> 00:11:13,600
considers dangerous and those are
blacklisted now when you look at what it

107
00:11:13,600 --> 00:11:18,000
actually does there's a number of things
we are almost all these new chicks

108
00:11:18,000 --> 00:11:25,120
implemented I have taken here the most
important ones so basically when you try

109
00:11:25,120 --> 00:11:31,850
to load kernel driver is taking the
signature so if it's not correct you

110
00:11:31,850 --> 00:11:37,790
signed and loaded you cannot just
arbitrate you back on your own system

111
00:11:37,790 --> 00:11:42,599
anymore because Apple consider certain
process to be restricted so you cannot

112
00:11:42,600 --> 00:11:50,900
attach to them anymore all the important
areas in your faces to protect against

113
00:11:50,900 --> 00:11:59,010
modification so you can no longer like
think I used to semester ones and I know

114
00:11:59,010 --> 00:12:04,160
free sample that at least in a very
first version of my co-workers had

115
00:12:04,160 --> 00:12:13,610
trouble getting some the tokens triple
tokens to work because those Krystal

116
00:12:13,610 --> 00:12:18,500
Thomas needs to start to be modified in
these areas and so basically we had to

117
00:12:18,500 --> 00:12:24,160
disable all the time and tell that a
customer with several hundred systems

118
00:12:24,160 --> 00:12:24,860
and so on

119
00:12:24,860 --> 00:12:36,170
yeah then he traces restricted which is
of course a good idea and these NVRAM

120
00:12:36,170 --> 00:12:42,510
operations we're sorry the deli Dorset
are protected and we see why in a minute

121
00:12:42,510 --> 00:12:45,600
there's a number of other places where

122
00:12:47,220 --> 00:12:54,509
shake like for example the launch team
now has the white list of demands that

123
00:12:54,509 --> 00:13:00,290
you cannot just stop a security launched
even anymore otherwise compromised the

124
00:13:00,290 --> 00:13:11,849
security of the system if you are like a
researcher and you deal with you will

125
00:13:11,850 --> 00:13:15,810
often run into the problem that stops
you from doing what you actually want to

126
00:13:15,810 --> 00:13:21,420
do and luckily for us there is this

127
00:13:21,959 --> 00:13:31,029
are you tell that allows you to disable
sip totally or partially actually does

128
00:13:31,029 --> 00:13:36,389
partially as I think I saw the partial
you sing is still not documented as far

129
00:13:36,389 --> 00:13:41,980
as I know and of course for security
reasons you can only country road this

130
00:13:41,980 --> 00:13:46,730
whole thing if you are system runs in
recovery mode so this means you must

131
00:13:46,730 --> 00:13:56,319
have physical access to the system
recovery mode you can just are you to

132
00:13:56,319 --> 00:14:07,490
disable and then you have a system from
the security point of view if you just

133
00:14:07,490 --> 00:14:11,300
want to develop kernel extension but you
don't have a kernel extension

134
00:14:11,300 --> 00:14:17,959
certificate you can just chill and able
they stay she was old text and then kick

135
00:14:17,959 --> 00:14:21,130
signing protection is disabled

136
00:14:21,130 --> 00:14:27,590
ok so that is the high-level way to
configure it though the hunt what

137
00:14:27,590 --> 00:14:35,320
happens is that these configurations are
stored in NVRAM variables and these

138
00:14:35,320 --> 00:14:39,450
other vendor environments that start
with Sears ardèche and their first loss

139
00:14:39,450 --> 00:14:44,630
caused a good idea that these are not
modifiable by arbitrary users and that's

140
00:14:44,630 --> 00:14:50,460
why the sandbox profiles forbids laws
are active concepts basically a bit

141
00:14:50,460 --> 00:14:55,380
field next slide where the different
features can be activated or deactivated

142
00:14:55,380 --> 00:15:01,460
and the suicide data is apparently
foreign export configuration I never

143
00:15:01,460 --> 00:15:05,360
actually tried so I've never seen her in
the wild

144
00:15:06,390 --> 00:15:14,480
yeah and it's yours do children also use
this and you must be in recovery mode

145
00:15:14,480 --> 00:15:19,180
and you have a specific entitlement to
actually be able to to do this

146
00:15:19,180 --> 00:15:30,189
modification so this is what it is
defined in the colonel and a few

147
00:15:30,190 --> 00:15:35,230
examples we can just skip bayless is not
so important but basically disappeared

148
00:15:35,230 --> 00:15:41,560
feel that shows what is activated when
one is not internal and it's quite easy

149
00:15:41,560 --> 00:15:46,479
to get this information the driver and
you want to hook into super basically

150
00:15:46,480 --> 00:15:55,330
you can ask by AP ice if if the current
configuration or so but when it comes to

151
00:15:55,330 --> 00:16:01,570
userspace Apple is also prepared
something which is our CTL system call

152
00:16:01,570 --> 00:16:08,100
and so now userspace towards and demons
can basically check for the current

153
00:16:08,100 --> 00:16:15,610
state of and then can work accordingly
for example as skip the signature shake

154
00:16:15,610 --> 00:16:20,030
or something like that or while many
other things

155
00:16:22,710 --> 00:16:26,910
but so in the space of course usually
the people don't use the system call

156
00:16:26,910 --> 00:16:32,949
directly so they use this API functions
use our check so let's go into these

157
00:16:32,950 --> 00:16:41,790
protections are one by one the first one
was that you only load kernel extensions

158
00:16:41,790 --> 00:16:48,449
and that is actually not really new on
OSX because he was basically the same

159
00:16:48,450 --> 00:16:55,670
thing only the implementation is now
different I would say and that's also

160
00:16:55,670 --> 00:17:01,199
the reason why the way you would disable
this check is also different so in just

161
00:17:01,200 --> 00:17:08,520
the material just set this kicks 2011
argument which would disable it so now

162
00:17:08,520 --> 00:17:13,209
in El Capitan you have to configure us
to disable it

163
00:17:14,810 --> 00:17:20,619
the thing is this signature check its
use the space driven so basically when

164
00:17:20,619 --> 00:17:25,899
you have the entitlement comment by
Reuters kicks management is really

165
00:17:25,900 --> 00:17:34,550
dangerous for so far for the system and
there's some other website or extension

166
00:17:34,550 --> 00:17:38,820
that is on the system but it's also a
level of this concept which is called

167
00:17:38,820 --> 00:17:43,810
upload pics to exclude list . text and
this is basically a whitelist and

168
00:17:43,810 --> 00:17:51,370
blacklist for kicks loading and this is
what it is in that case there's an info

169
00:17:51,370 --> 00:17:57,449
plist file that contains a lot of
information but two dictionaries or a

170
00:17:57,450 --> 00:18:03,140
race I don't remember picture is so two
dictionaries and these dictionaries are

171
00:18:03,140 --> 00:18:09,870
called West texts exception has list and
that is basically a whitelist off-color

172
00:18:09,870 --> 00:18:17,790
extensions by some hash that will be
loaded by the system even though they

173
00:18:17,790 --> 00:18:23,770
don't have a signature plight those the
most probably you something important

174
00:18:23,770 --> 00:18:30,150
service search party tools that want to
break the other thing

175
00:18:30,150 --> 00:18:36,280
is there a supply list for kernel
extensions that should not get loaded

176
00:18:36,280 --> 00:18:42,510
even though they are valid and it's
called always text exclude list there's

177
00:18:42,510 --> 00:18:47,850
a good reason to be able to to blacklist
is extensions because there's even this

178
00:18:47,850 --> 00:18:56,370
HW excess current extension that is
shipped with memorex and chill summit

179
00:18:56,370 --> 00:19:01,820
team and it's basically extension when
it's loaded gifts root user

180
00:19:02,490 --> 00:19:08,310
read and write access to physical memory
so this is basically complete ownership

181
00:19:08,310 --> 00:19:14,070
of the system and this is of course an
apple to rule so it's Apple signed so

182
00:19:14,070 --> 00:19:18,419
there must be a way to stop recovery
time from loading it otherwise the whole

183
00:19:18,420 --> 00:19:25,310
protection would be toast it this
exclude list is by the way handled in

184
00:19:25,310 --> 00:19:32,060
both central and I what I mean is that
these userspace deposit exploding

185
00:19:32,600 --> 00:19:38,689
validate that you are not in that list
in New Zealand but if you can somehow

186
00:19:38,690 --> 00:19:45,020
trick that the kernel has the case
Trojan from the last and an external

187
00:19:45,020 --> 00:19:51,240
reviewers 22 loaded even when you trick
the user space part of it

188
00:19:54,960 --> 00:20:01,380
so that's the kernel extension loading
the next thing is this

189
00:20:01,380 --> 00:20:08,590
5 system protection and there is now
part of the fighters are protected

190
00:20:08,590 --> 00:20:14,129
against modifications and this is kinda
configured in system library sent box

191
00:20:14,130 --> 00:20:23,149
rootless told conf and you can look into
this file and this is so apparently when

192
00:20:23,149 --> 00:20:30,168
you have no star in the beginning then
it's it's protected when you have a star

193
00:20:30,169 --> 00:20:36,679
in the beginning that is accepted Forex
exempted from the protection and what

194
00:20:36,679 --> 00:20:40,520
other meanings I have never actually
tried to find out what what what it

195
00:20:40,520 --> 00:20:45,129
means when Putin and so on this in their
eyes never try to to check that the

196
00:20:45,130 --> 00:20:51,419
others is most interesting here I will
exploit that later

197
00:20:56,060 --> 00:21:04,429
the next thing is of course only there's
they don't have source code anymore and

198
00:21:04,430 --> 00:21:10,020
they people just want to use them and
always so Apple has created something

199
00:21:10,020 --> 00:21:17,560
quite a comparatively bundle that
contains past names just a plain text

200
00:21:17,560 --> 00:21:25,540
file with all these names and those of
pasta names are basically exempted from

201
00:21:25,540 --> 00:21:30,129
from serb so you can create these fires
can put anything you want in these

202
00:21:30,130 --> 00:21:36,530
locations and this is internally done
with this rootless whitelist a whitelist

203
00:21:36,530 --> 00:21:39,530
push Apia

204
00:21:40,120 --> 00:21:47,340
only used a few of the right entitlement
so there's something special about these

205
00:21:47,340 --> 00:21:56,050
files because they can be anything will
be aware of of that and the system will

206
00:21:56,050 --> 00:21:59,350
not trust them

207
00:21:59,350 --> 00:22:06,399
it means that there is actually an AP
either scored Reuters check trusted and

208
00:22:06,400 --> 00:22:12,720
health UF if this file is currently
protected bicep and you are allowed to

209
00:22:12,720 --> 00:22:19,799
trusted also the other thing is why this
conflagration firewood lestat conf is

210
00:22:19,799 --> 00:22:25,530
the actual decisions are not done by
this file election decisions are done by

211
00:22:25,530 --> 00:22:30,520
extended attributes on disk and extended
release called com dot episode rootless

212
00:22:30,520 --> 00:22:35,280
and you cannot manual attached at the
sent box will not allow you to touch

213
00:22:35,280 --> 00:22:38,830
this on a on a system that is activated

214
00:22:38,830 --> 00:22:46,539
however of course there must be seems
like installers and soul special kinds

215
00:22:46,539 --> 00:22:56,490
of entitlements and I also believe flex
in the courts can make an application

216
00:22:56,490 --> 00:23:02,960
recognized as an installer and in this
case you have basically full access to

217
00:23:02,960 --> 00:23:05,960
the file system and can do what you want

218
00:23:08,100 --> 00:23:13,699
and the whole enforcement of this holds
five protections is entering done in the

219
00:23:13,700 --> 00:23:20,309
box office success already existed
however they have added a bunch of new

220
00:23:20,309 --> 00:23:25,418
features we saw these features like nvm
variable records they have now added new

221
00:23:25,419 --> 00:23:39,480
features to this specific are actually
read them but the point is that they

222
00:23:39,480 --> 00:23:49,440
have rootless disc rootless fighter and
that's basically aids and but they have

223
00:23:49,440 --> 00:23:56,039
also rootless proper attire and ruthless
boot fitter no rules put device which is

224
00:23:56,039 --> 00:24:05,610
here so there's a there's five new shit
has since the release of town and of

225
00:24:05,610 --> 00:24:11,370
course they are completely closed would
have to reverse the sandbox extension in

226
00:24:11,370 --> 00:24:17,379
in in detail you have to find the Evo
function and how these are actually

227
00:24:17,380 --> 00:24:26,460
implemented so this is basically just a
way to sure to check the screen sip

228
00:24:26,460 --> 00:24:36,400
configuration against a bit mosque then
Reuters device filter basically matches

229
00:24:36,400 --> 00:24:43,190
this conflagration forbids specific
device so this is special especially

230
00:24:43,190 --> 00:24:51,669
when you see them in this in this grass
shear a matching of the future means

231
00:24:51,669 --> 00:24:56,950
that system integrity protection does
not want you to have access to it so

232
00:24:56,950 --> 00:25:05,659
green arrows coming out of a negative
result for you so when is going green

233
00:25:05,659 --> 00:25:10,260
will usually result in a June I so
that's a big difference to the other

234
00:25:10,260 --> 00:25:14,700
other shooters so yeah the boot

235
00:25:14,700 --> 00:25:21,900
the proxy is basically there to stop you
from a teacher attaching to ya

236
00:25:21,900 --> 00:25:27,549
restricted processes and this can be
overridden issue have this comment

237
00:25:27,549 --> 00:25:35,960
system task ports entitlement and then
there's this is 5 feet up which is the

238
00:25:35,960 --> 00:25:39,929
thing that basically implements the
whole protection if you are allowed to

239
00:25:39,929 --> 00:25:44,550
access the file on north and this is the
one that evaluates T

240
00:25:44,550 --> 00:25:53,169
extended attribute and this is also the
one that allows and programs

241
00:25:53,170 --> 00:26:03,110
entitlements to actually buy purses
protection features is its foreign if

242
00:26:03,110 --> 00:26:09,419
you want to attack you want to xxxx
block devices then again there's a

243
00:26:09,420 --> 00:26:14,890
different kind of entitlement com blog
devices that would allow you to access

244
00:26:14,890 --> 00:26:22,900
this again all of this is completely
closed source so I know about this is

245
00:26:22,900 --> 00:26:29,970
just like skimming through George
function that is a big big switch about

246
00:26:29,970 --> 00:26:33,720
all the features and just trying to
understand what what they're doing

247
00:26:36,590 --> 00:26:46,189
oK so that's how its integrated into the
sent box so now this protection of

248
00:26:46,190 --> 00:26:52,799
restricted processes the idea is like
has already said it cannot attach to do

249
00:26:52,799 --> 00:27:00,309
something with a debugger if its
restricted and traditionally there is a

250
00:27:00,309 --> 00:27:06,440
way that you can get a restricted by
having a very strict segment but

251
00:27:06,440 --> 00:27:11,730
normally restricted processes are done
in a different kind of way

252
00:27:11,730 --> 00:27:17,190
first of all they can have special
flicks in the code signing information

253
00:27:17,190 --> 00:27:22,250
which makes them kind of restricted they
can have the moment when they use

254
00:27:22,250 --> 00:27:32,980
special secret private appt 0 comments
endemic in tightly restricted but also

255
00:27:32,980 --> 00:27:38,080
when they execute from certain protected
fight system or magic tries to Maria's

256
00:27:38,080 --> 00:27:42,559
so you can test it on your own El
Capitan system tried to for example

257
00:27:42,559 --> 00:27:48,370
attach the debugger to bin bash which
will fail and then just copy been based

258
00:27:48,370 --> 00:27:54,149
22 temp directory and now try to debug
this again and suddenly you can attach

259
00:27:54,149 --> 00:27:57,149
to it

260
00:27:57,760 --> 00:28:06,140
yeah the last thing here and here is the
protection of the end of you so I

261
00:28:06,140 --> 00:28:11,910
already showed that the partial graph
for the Delete but basically the idea is

262
00:28:11,910 --> 00:28:17,740
that the lead or set will stop you from
modifying any boot

263
00:28:18,380 --> 00:28:27,870
any any nvm variable that's because
that's for configuring the the same and

264
00:28:27,870 --> 00:28:32,770
you can only really do that if you are
in recovery mode and you should have the

265
00:28:32,770 --> 00:28:43,830
right entitlements however these
profiles usually explicitly allow you to

266
00:28:43,830 --> 00:28:47,560
set arbitrary product shipments to the
colonel

267
00:28:53,049 --> 00:29:01,929
so now the last thing I want to go into
here is launched is this thing that

268
00:29:01,929 --> 00:29:10,179
starts launch demons and manage them and
there's no one in this file that is why

269
00:29:10,179 --> 00:29:18,070
the young white list of ya demons that
are allowed to be removed from the

270
00:29:18,070 --> 00:29:23,489
system so you can stop them should try
to stop any other launched maneuvers

271
00:29:23,489 --> 00:29:27,980
tell you all know this you cannot do
that because of serb and the basic idea

272
00:29:27,980 --> 00:29:33,159
seems to be that if you could stop
security relevant demons you could

273
00:29:33,159 --> 00:29:38,580
basically maybe take over what they're
doing and then you have compromised the

274
00:29:38,580 --> 00:29:46,249
security chain and one addition to the
whole system is that added a new hooks

275
00:29:46,249 --> 00:29:52,480
to the max framework that allows them to
look into this task said special point

276
00:29:52,480 --> 00:29:59,509
function which is a function that allows
demands or normally launched to register

277
00:29:59,509 --> 00:30:06,739
so-called special points with the system
and the idea is that other parts of the

278
00:30:06,739 --> 00:30:11,119
system Kirk Hanson message to his
special ports and the whole basically

279
00:30:11,119 --> 00:30:12,928
code signing and and so on

280
00:30:12,929 --> 00:30:20,820
relies on this so it will be really bad
if someone could just like chill and

281
00:30:20,820 --> 00:30:25,590
then take over this on a on a system
because as a Reuters are normally would

282
00:30:25,590 --> 00:30:30,299
be able to take this over but now you
cannot do this anymore because they have

283
00:30:30,299 --> 00:30:36,158
this new protection that basically
checks if you try to take over the host

284
00:30:36,159 --> 00:30:41,779
telemetry ports and if you do that then
you must have this combo private XP

285
00:30:41,779 --> 00:30:47,440
sea-launched the event molitor
entitlement and it must be true and then

286
00:30:47,440 --> 00:30:53,989
it's allowed but if you try to attach to
any any other special port then the next

287
00:30:53,989 --> 00:31:01,820
shakers issue our trucks which you are
fit 10 launch D and if you are this is

288
00:31:01,820 --> 00:31:03,679
allowed and if you're not

289
00:31:03,680 --> 00:31:10,700
and it's denied this means basically
only launched you can now assign these

290
00:31:10,700 --> 00:31:18,570
products ports so even if you would they
be able to kill some time an you could

291
00:31:18,570 --> 00:31:23,439
not add replaced airports and hijacked
communication anymore

292
00:31:23,440 --> 00:31:35,920
oK so that's Yi protections kinda let's
get into sinking the ship and

293
00:31:39,820 --> 00:31:47,450
yeah remember the first assumption that
I had that maybe is the idea is that

294
00:31:47,450 --> 00:31:52,240
people are not using charcoal exports
because it's too hard for the attack

295
00:31:52,240 --> 00:32:03,670
which may be a thing because while bucks
may be there for free by just reading

296
00:32:03,670 --> 00:32:11,590
the Google output but expectations may
be hard because of medications however

297
00:32:11,590 --> 00:32:19,639
has a bunch of API's that you can use US
Route you though that make Colonel

298
00:32:19,640 --> 00:32:28,370
exploitation actually easier so far as
hosts open in full or you can use that

299
00:32:28,370 --> 00:32:34,669
by using its separate judicial on your
own device it gives output that helps on

300
00:32:34,670 --> 00:32:42,140
board with doing colonel he fractured if
you have a heap overflow actually I used

301
00:32:42,140 --> 00:32:46,520
that I was followed three jailbreak
inside the jailbreak to to find out how

302
00:32:46,520 --> 00:32:50,870
many points to close on the heap and
right after Apple actually started

303
00:32:50,870 --> 00:32:55,610
looking this whole thing down but of
course as a route on always text you

304
00:32:55,610 --> 00:33:01,219
still have full access to that even if
they're have an entitlement in place

305
00:33:01,220 --> 00:33:05,730
there is still this checkpoint you chill
and you can just take the old port on

306
00:33:05,730 --> 00:33:12,450
the comment line they said there was
another thing until recently which is

307
00:33:12,450 --> 00:33:20,120
was fixin always extend 11 30 there was
a system call cast in that was not

308
00:33:20,120 --> 00:33:25,560
protected and discussed in Fergus you
the address space layout randomization

309
00:33:25,560 --> 00:33:31,860
slide show the route you that so
basically as root there was no problem

310
00:33:31,860 --> 00:33:35,800
ever to break case you could just after
system for it

311
00:33:35,800 --> 00:33:43,230
ok this was fixed in 10113 and yesterday
there was 10114 so is fixed

312
00:33:44,690 --> 00:33:54,960
the whole story is not over here because
Sep also does not stop you from setting

313
00:33:54,960 --> 00:34:02,280
kernel boot arguments and this includes
tons of put arguments that control

314
00:34:02,280 --> 00:34:11,179
security mitigations like if SME P or s
AP is activated if your text segments is

315
00:34:11,179 --> 00:34:19,739
made right protected if you're
constipated actually write protected if

316
00:34:19,739 --> 00:34:25,290
they are initial random locations and
there's a few others I didn't even

317
00:34:25,290 --> 00:34:29,040
bother to put them on the slide but
there's a few others at all control

318
00:34:29,040 --> 00:34:34,650
mitigations directly and you can as the
root user can just disable these

319
00:34:34,650 --> 00:34:40,220
protection and then reboot the system
and then you're such a system that is

320
00:34:40,219 --> 00:34:43,219
very friendly friendly for kroll
exportation

321
00:34:48,280 --> 00:34:54,550
there's something more more dangerous
the colonel

322
00:34:59,150 --> 00:35:02,279
contrary to popular belief on the
Internet

323
00:35:03,369 --> 00:35:09,690
absolutely does not control the kind of
debug oh so even if it fully activated

324
00:35:09,690 --> 00:35:16,510
you can just use the kind of guy you
just set the debug equals argument

325
00:35:16,510 --> 00:35:24,470
reboot and you can use secure debugger
even though citrus fully activated and

326
00:35:24,470 --> 00:35:33,160
of course with local mountains but if
your computer is connected to align with

327
00:35:33,160 --> 00:35:43,779
a snowboard car network card then you
can actually remote debugging of course

328
00:35:43,779 --> 00:35:50,760
issuer running in the AM and someone has
to host so bad if an attacker is able to

329
00:35:50,760 --> 00:35:55,940
get root on your system and at the same
time gets control over any other system

330
00:35:55,940 --> 00:36:01,799
in your life that is reachable and that
is she doesn't even need root on this

331
00:36:01,799 --> 00:36:09,460
you just need to use a condom then he
can just like turn on the debug on the

332
00:36:09,460 --> 00:36:18,599
on the on the one we're already got root
and on the other he just waits for the

333
00:36:18,599 --> 00:36:21,599
other device to reboot

334
00:36:24,549 --> 00:36:32,689
ok this device is rebooting now the
question is how do you enter the do well

335
00:36:32,689 --> 00:36:38,019
there are several ways to enter a
debugger and before or extend 11 to

336
00:36:38,019 --> 00:36:47,439
there was actually a host reboot that
allows you to directly to struggle so

337
00:36:47,439 --> 00:36:50,629
just execute that function they are you
have to give it though their private

338
00:36:50,630 --> 00:36:56,029
parts for that and then it starts its
bigger things

339
00:36:56,029 --> 00:37:00,969
well yeah i i think it was 10112 when
you look into the source code you will

340
00:37:00,969 --> 00:37:06,900
see that this is gone because Apple has
put in if they're around this code so

341
00:37:06,900 --> 00:37:15,349
that it's now only compiled in debug or
development kernels on released but if

342
00:37:15,349 --> 00:37:19,569
you may be attacking a developer then
he's running a development colonel

343
00:37:19,569 --> 00:37:26,219
something again who knows anyway even if
you are not able to do it easily

344
00:37:26,839 --> 00:37:30,519
the only thing you need to trigger the
debugger slickest the simplest gonna

345
00:37:30,519 --> 00:37:37,718
crash ever and that should be no problem
to find anything that touches the

346
00:37:37,719 --> 00:37:45,369
colonel and people who will give you
this box 44 little of $5 or something

347
00:37:45,369 --> 00:37:52,539
like that yeah the other thing is you
might just tried to use the boot

348
00:37:52,539 --> 00:37:58,809
arguments to activate remote corner
Christians might just leaked interesting

349
00:37:58,809 --> 00:38:03,969
data to whoever is on the other side of
course it would be detected the Jordan

350
00:38:03,969 --> 00:38:08,999
system kind of freezes for a long time
why it's sending it over but maybe the

351
00:38:08,999 --> 00:38:14,178
the whole reboot was done in time when
the system was unattended or the person

352
00:38:14,179 --> 00:38:21,239
just went for coffee or whatever it's
questionable what's all internal memory

353
00:38:21,239 --> 00:38:29,660
I never actually tried that so I don't
know if I can find keys in there and I

354
00:38:29,660 --> 00:38:40,598
mean in the normal question and yeah so
this should be kind of obvious because

355
00:38:40,599 --> 00:38:48,369
when you can attach to a criminal you
can physically disabled simple and here

356
00:38:48,369 --> 00:38:51,369
is I have a first first team

357
00:38:58,170 --> 00:39:11,260
so I'm doing this demo on an older
system because I want to use this post I

358
00:39:11,260 --> 00:39:18,750
have already this snapshot is already
booted with their argument and you can

359
00:39:18,750 --> 00:39:26,390
see this year's our usual status is
enabled and to prove that I'm not having

360
00:39:26,390 --> 00:39:37,040
anything disabled at the moment let me
try to touch when I was here and there

361
00:39:37,040 --> 00:39:49,230
is not permitted so now I have exploits
its called noticing our first exploits

362
00:39:51,690 --> 00:39:55,050
directory

363
00:39:55,050 --> 00:39:58,050
oh yeah directory

364
00:40:07,810 --> 00:40:15,890
so this is a bug me this is just the
house dribbled call that a debugger so

365
00:40:15,890 --> 00:40:22,160
let me just run this by the way I just
show you interviewed by the way I'm

366
00:40:22,160 --> 00:40:33,200
already route so hard so you can see I
have the right now so I just run

367
00:40:36,190 --> 00:40:39,190
me and now it's frozen

368
00:40:43,200 --> 00:40:47,020
I have the debugger here I don't connect

369
00:40:52,869 --> 00:40:55,869
so now I'm connected

370
00:41:01,080 --> 00:41:07,950
so what I do right now is I get myself
the address of this year's

371
00:41:07,950 --> 00:41:16,930
all variable in this case I have some
balls because I it's an older can also I

372
00:41:16,930 --> 00:41:21,220
have two kids if you don't have that you
just like reverse the country's not that

373
00:41:21,220 --> 00:41:28,810
hard to reverse the whole kernel you
just you have to source code and you

374
00:41:28,810 --> 00:41:33,710
know that this variable is used in the
function like a little like so long so

375
00:41:33,710 --> 00:41:40,000
33 lines are so so it's really easy to
find us to manually so right now this

376
00:41:40,000 --> 00:41:46,790
very well seems to be said 20 so let me
just set it to one with a memory write

377
00:41:46,790 --> 00:41:52,630
comment but I have to just use the
pointer because that was from last time

378
00:41:52,630 --> 00:41:58,660
and of course due to kids are the
different know who now I writer one here

379
00:41:58,660 --> 00:42:04,220
let me check it's now one so let me know
continue the other side and of course

380
00:42:04,220 --> 00:42:07,950
you normally as a as am i where you
would do it automatically and not like

381
00:42:07,950 --> 00:42:15,029
need need need five minutes to do it so
now in the background the system should

382
00:42:15,030 --> 00:42:18,030
be running again where is the mouse

383
00:42:21,240 --> 00:42:31,279
so the system yeah yeah of course it's a
problem so yeah I'm I now running again

384
00:42:31,280 --> 00:42:39,830
and I know traders touch again and this
time it didn't

385
00:42:50,170 --> 00:43:14,490
fighters to right now so let me delete
this system to go back into lab shirt

386
00:43:14,490 --> 00:43:19,200
because the next thing is an extreme
again

387
00:43:23,950 --> 00:43:33,180
so because it's easier to do because I
don't need to have a crush exploit or so

388
00:43:33,180 --> 00:43:39,830
for that but the back order the kind of
thing still works with 10:11 sure why I

389
00:43:39,830 --> 00:43:46,569
tested it but I would then have to hit
the secured party communication to

390
00:43:46,570 --> 00:43:54,000
actually get into the debugger and thats
less less nice ok so the next thing is

391
00:43:54,000 --> 00:44:01,350
something that I knew but then someone
else killed it it's the mount militias

392
00:44:01,350 --> 00:44:15,509
and was most probably I think it was
killed in 10 10112 by Apple because it

393
00:44:15,510 --> 00:44:20,380
mentions this union mount back in the
security updates and responded by make

394
00:44:20,380 --> 00:44:28,680
defender whatever that is and that's as
usual not much information in Apple

395
00:44:28,680 --> 00:44:32,990
release announcement saw you normally
have no idea what the buck extremist and

396
00:44:32,990 --> 00:44:36,250
sometimes the descriptions actually
wrong because when you know the back in

397
00:44:36,250 --> 00:44:41,580
order description just wondered what the
bucket supposed to be so I'm not sure if

398
00:44:41,580 --> 00:44:46,640
it's really the Bank today reported by
the pics at the same time so what is the

399
00:44:46,640 --> 00:44:51,259
first thing you do when you have a fight
system that you cannot write to

400
00:44:53,470 --> 00:44:56,470
try to mount something over it

401
00:44:58,330 --> 00:45:17,710
and because you see it it took until
10112 to fix that and I'm pretty sure

402
00:45:17,710 --> 00:45:22,530
that was not developed in one day so
they must have been some testing before

403
00:45:22,530 --> 00:45:28,950
and so there must be a long time when
nobody ever tested so it's actually

404
00:45:28,950 --> 00:45:33,660
quite simple that's how I do it I don't
know how much defended it I crack myself

405
00:45:33,660 --> 00:45:40,500
from directory I use HDI you to create
the source folder evil ideology and then

406
00:45:40,500 --> 00:45:51,140
I mounted over the system like recent
books directory so do I create my myself

407
00:45:51,140 --> 00:45:57,190
two of these theories and the first EMG
basically contains the militias ruthless

408
00:45:57,190 --> 00:46:03,350
con and its second one just an empty
comment by Reuters repair and the second

409
00:46:03,350 --> 00:46:12,560
one is like the real and also repaired
and the militias that I disable the

410
00:46:12,560 --> 00:46:15,560
protection for the kernel binary

411
00:46:17,940 --> 00:46:26,130
then I mount the malicious 10 voters
said dr. rectory run this is rootless in

412
00:46:26,130 --> 00:46:33,079
it which will apply the rootless
conscious choice to the system which

413
00:46:33,079 --> 00:46:38,960
will make the kernel binary writable but
I just pitch to curb I read disabled

414
00:46:38,960 --> 00:46:46,300
serb and now I cannot create a new page
because the system will see all the

415
00:46:46,300 --> 00:46:52,339
kernels not trusted so what I have to do
is mount the clean stuff over it to make

416
00:46:52,339 --> 00:47:00,180
the kernel protected again and when i
touch the library extension it will

417
00:47:00,180 --> 00:47:04,009
create a new kernel cage reboot and I
have a system that does not usurp

418
00:47:04,010 --> 00:47:08,930
anymore I also have Addie Moore

419
00:47:13,630 --> 00:47:16,630
it's basically

420
00:47:21,029 --> 00:47:29,079
right directory so I'm here I have my
disc wonders to directories and Edam

421
00:47:29,079 --> 00:47:35,229
cheese and I already have a pitch
trouble there and the arguments for

422
00:47:35,229 --> 00:47:40,269
playing with death I cannot show that

423
00:47:42,580 --> 00:47:46,259
let me show you like this thing

424
00:47:55,210 --> 00:48:09,220
already explained and do that let me
prove again that I have no access to

425
00:48:09,220 --> 00:48:22,160
this it's not allowed in or can just
take while I what I would do right now

426
00:48:22,160 --> 00:48:29,980
is I believe I will continue because it
really takes a wile however then you

427
00:48:29,980 --> 00:48:35,560
might believe I'm faking with us but I
will lose too much time if I'm like not

428
00:48:35,560 --> 00:48:43,680
continuing right now is fixed anyways so
the demon works and when you do slights

429
00:48:43,680 --> 00:48:46,930
you can basically do it on your own
system and you see that I'm not thinking

430
00:48:46,930 --> 00:48:52,529
is the bike was fixed so let's get into
something that's interesting because

431
00:48:52,530 --> 00:48:55,970
it's still open lets abuse entitlements

432
00:48:58,740 --> 00:49:05,640
in my point of view into entitlements
are the new suite by Reese and we all

433
00:49:05,640 --> 00:49:06,970
know that

434
00:49:06,970 --> 00:49:12,490
hardening sued by Maurice took years and
they're still box inside by Reese and

435
00:49:12,490 --> 00:49:15,490
that's why we actually don't you sweet
binaries anymore

436
00:49:17,050 --> 00:49:22,740
every single binary they give
entitlements and this is a process that

437
00:49:22,740 --> 00:49:26,000
will take forever

438
00:49:26,000 --> 00:49:31,780
but in the context of it's actually
easier because mostly the batteries that

439
00:49:31,780 --> 00:49:36,790
have come apparatus and store are
extremely dangerous dangerous from now

440
00:49:36,790 --> 00:49:37,550
on

441
00:49:37,550 --> 00:49:43,040
up-to-date system 10114 how hard is it
to apprentice

442
00:49:45,850 --> 00:49:54,560
truth squad effects yes that has since
entitlement and when you look into them

443
00:49:54,560 --> 00:50:05,520
on page page you receive their option to
write to a lot file so this too has full

444
00:50:05,520 --> 00:50:10,190
access to the fight system and when you
run it it basically can ride in

445
00:50:10,190 --> 00:50:16,910
supporting the directories not really
hard to create fight somewhere

446
00:50:17,870 --> 00:50:25,350
the problem only appended and in many
places false positives are so forgiving

447
00:50:25,350 --> 00:50:31,640
that depended garbage to filestube
actually do anything so but this is how

448
00:50:31,640 --> 00:50:34,640
uses of cheques es el

449
00:50:35,280 --> 00:50:43,480
I am here and of course as root because
it's and then you do it anyway I'm here

450
00:50:43,480 --> 00:50:48,220
is there and because I didn't put any
more parameter output of the stool and

451
00:50:48,220 --> 00:50:51,859
that's why this fight as you read this
moment otherwise if you give it some

452
00:50:51,860 --> 00:50:55,720
parameter is the output of the tool will
end up in that fire and this will

453
00:50:55,720 --> 00:51:01,899
basically be garbage so I i try to play
around with it and I must say I didn't

454
00:51:01,900 --> 00:51:06,360
have a good idea how to abuse that the
only thing I try to do was basically

455
00:51:06,360 --> 00:51:12,290
killing pillars but killing Peters has
really the problem that garbage at the

456
00:51:12,290 --> 00:51:17,800
end of pillars the puzzle mostly ignored
except if you are garbage starts with

457
00:51:17,800 --> 00:51:23,390
like an opening tech but this is not
possible here so it seemed that I

458
00:51:23,390 --> 00:51:31,410
couldn't do anything however there's
more when you look of entitlement and

459
00:51:31,410 --> 00:51:37,660
sweet memories there something that
three boundaries have that had to be

460
00:51:37,660 --> 00:51:41,730
added to all the kernels of all the
operating systems and that is basically

461
00:51:41,730 --> 00:51:48,550
a protection when you start a sweet by
Lori with the fight a script as 02 1:01

462
00:51:48,550 --> 00:51:51,740
into closed

463
00:51:51,740 --> 00:51:56,189
to protect against that normally because
if you don't protect against that you

464
00:51:56,190 --> 00:52:05,430
can redirected anywhere you can open any
file with this thing and then because 01

465
00:52:05,430 --> 00:52:10,390
into are basically finders keepers
juiced for four output and so on and

466
00:52:10,390 --> 00:52:17,029
import you can basically make the same
access as rude that are not supposed to

467
00:52:17,030 --> 00:52:22,910
be accessed as rude and no protection

468
00:52:23,830 --> 00:52:27,230
binaries that can write an email the
file system have exactly the same

469
00:52:27,230 --> 00:52:34,869
problem when you stop them with a little
bit different you because at this time

470
00:52:34,869 --> 00:52:38,360
you don't have to you when this is open
to you don't have the entitlement

471
00:52:38,360 --> 00:52:44,180
already so it's a little birds less
problematic however you can still create

472
00:52:44,180 --> 00:52:48,830
havoc because what will happen is when
you have the right by Yuri when you

473
00:52:48,830 --> 00:52:54,080
start it and you have lost closed then
this file despite Nuri ticket sales for

474
00:52:54,080 --> 00:53:00,060
example will at some point open a file
that will end up in zero one or two and

475
00:53:00,060 --> 00:53:04,170
then from this moment what is output
believe it into this file or red or

476
00:53:04,170 --> 00:53:04,869
whatever

477
00:53:04,869 --> 00:53:12,960
depending on which you open and this is
how you can abuse that you can even

478
00:53:12,960 --> 00:53:17,700
abused on the best comment line you
don't need to write code for that new

479
00:53:17,700 --> 00:53:25,689
clothes fighters crippled one then you
use F sects YES on deaf disc brakes disc

480
00:53:25,690 --> 00:53:32,270
X because it needs to start was def disc
is like some nonsense in infinite or so

481
00:53:32,270 --> 00:53:38,530
what you can do is make it exists
anywhere on the face and then the output

482
00:53:38,530 --> 00:53:44,940
of the trilogy written to that file
where ever you pointed and this allows

483
00:53:44,940 --> 00:53:48,180
you to ride anywhere on the system

484
00:53:48,740 --> 00:53:53,009
I'm just time to the beginning of those
fires so this time you can destroy files

485
00:53:54,619 --> 00:54:07,319
how did well but continuous first the
singer's I can just make the symbolic

486
00:54:07,319 --> 00:54:13,660
link point into this airport txt exclude
list info plist file this destroys

487
00:54:13,660 --> 00:54:19,038
disappear this disc and extensions
cannot be used anymore which means when

488
00:54:19,039 --> 00:54:23,279
I when I triggered the the croquet
generation it will not put into the

489
00:54:23,279 --> 00:54:29,720
kerner cage and when the system reboots
then it's gone there's no protection

490
00:54:29,720 --> 00:54:36,629
anymore and they can just load Apple WH
HW access and can write to any physical

491
00:54:36,630 --> 00:54:43,400
memory and that's basically game over
for simple and nice thing is this whole

492
00:54:43,400 --> 00:54:46,400
protection fits into a single tweet

493
00:54:48,290 --> 00:54:58,610
84 bytes that will basically killed the
upper text exclude list and yeah I I

494
00:54:58,610 --> 00:55:03,460
didn't implement the whole pitching
physical memory thingy but what I would

495
00:55:03,460 --> 00:55:09,510
show you is that I after a rugged I can
actually noticed a poor extension and

496
00:55:09,510 --> 00:55:17,620
yeah so what time again and the other
one should have rebooted by now

497
00:55:21,200 --> 00:55:32,460
know apparently I did not report ok so
now the color should be replaced and it

498
00:55:32,460 --> 00:55:37,920
should reboot so but it doesn't matter
because the other to the other day my do

499
00:55:37,920 --> 00:55:40,920
on the

500
00:55:44,030 --> 00:55:50,930
on the other anyway because we want to
show it on the latest versions of this

501
00:55:50,930 --> 00:55:53,930
is the one that was released yesterday

502
00:55:55,660 --> 00:56:06,529
so where r is activated in the above
text exclude

503
00:56:11,890 --> 00:56:16,670
let me become root

504
00:56:24,839 --> 00:56:29,430
and try to open to actually go to school
extension

505
00:56:37,750 --> 00:56:42,900
so I'm trying to lure extension

506
00:56:42,900 --> 00:56:45,900
tells me a can of loaded

507
00:56:51,279 --> 00:56:54,279
why

508
00:57:00,549 --> 00:57:07,349
entering was one hand is really so now
you can see is cannot open it because

509
00:57:07,349 --> 00:57:13,789
Apple HW access isn't exclude list so
it's exactly what I said it doesn't work

510
00:57:13,789 --> 00:57:27,269
but no major 84 bytes come into play I
put them in the air now reboot by the

511
00:57:27,269 --> 00:57:30,238
way did the other one rebooted meanwhile

512
00:57:30,239 --> 00:57:33,239
rebooted let me see

513
00:57:41,740 --> 00:57:45,310
the other one is still waiting for the
current be generated and then to reboot

514
00:57:45,310 --> 00:57:52,430
so I'm here again I'm again i think im
not right no so it's become Reuters

515
00:57:52,430 --> 00:57:58,390
noted that has basically

516
00:57:58,390 --> 00:58:10,980
pitched out I managed it like right in
the last 15 minutes before the talks so

517
00:58:10,980 --> 00:58:15,500
I hope it's rocking it seems to work

518
00:58:24,010 --> 00:58:27,490
ok

519
00:58:27,490 --> 00:58:32,750
the finest they're just generated and it
said so the other one is still rebooting

520
00:58:32,750 --> 00:58:36,830
and yeah

521
00:58:38,680 --> 00:58:41,680
unfortunately always slow

522
00:58:46,230 --> 00:58:50,600
but the best is yet to come

523
00:58:54,770 --> 00:59:02,030
but at least it doesn't come on

524
00:59:04,690 --> 00:59:13,210
let me know if it's finished now than to
israel directly

525
00:59:23,340 --> 00:59:26,340
waiting

526
00:59:48,670 --> 00:59:59,530
and you can see an extension is loaded
so at this point you have just tried to

527
00:59:59,530 --> 01:00:09,119
add that uses to catch ya in the same
way we use the debugger so the last part

528
01:00:09,119 --> 01:00:18,190
is picked up and I know I will be using
the term backdrop but you will see what

529
01:00:18,190 --> 01:00:27,130
I mean in the second with the release of
OS X 10 90 Apple created this back to

530
01:00:27,130 --> 01:00:34,490
work and the idea is that they added
support for the simulator for I was 42

531
01:00:34,490 --> 01:00:42,118
S&T vos to do so the idea now is that
the kernel of steam in binary notes

532
01:00:42,119 --> 01:00:48,859
executed atomically the dynamic linkers
that there is an environment variable to

533
01:00:48,859 --> 01:00:56,609
true path check that there is a binary
and then execute loading execute that

534
01:00:56,609 --> 01:01:04,808
the simulated will then go to libraries
simulator and then execute the main by

535
01:01:04,809 --> 01:01:16,160
rain and it's really bad because this
backdoor allows you to take over the

536
01:01:16,160 --> 01:01:22,299
permission of this binary here even if
it's a routine areas but also the

537
01:01:22,299 --> 01:01:24,640
entitlements

538
01:01:24,640 --> 01:01:31,720
and that's why the back door because
it's an undocumented functionality that

539
01:01:31,720 --> 01:01:36,788
injects cold into any executable on the
device because it in the main

540
01:01:36,789 --> 01:01:42,599
dynamically and you can completely take
over any privilege this executable has

541
01:01:42,599 --> 01:01:54,099
so far back to any protection yes Apple
head of protection when they created the

542
01:01:54,099 --> 01:02:00,010
protection was selected as finalists its
own doesn't problem is there is

543
01:02:00,010 --> 01:02:06,730
absolutely no connection because if you
are the normal use and you have your

544
01:02:06,730 --> 01:02:12,160
number of users and then just trigger
any creation with the file into the

545
01:02:12,160 --> 01:02:18,730
directory but I like big losses this
file will pay route and writable but you

546
01:02:18,730 --> 01:02:26,960
so you can just put a 3rd symptom also
when you just your normal system as ever

547
01:02:26,960 --> 01:02:31,839
installed many many levels are so crazy
that they basically and stone fight on

548
01:02:31,839 --> 01:02:41,940
system that will travel and when you're
so the problems have been reported based

549
01:02:41,940 --> 01:02:54,470
on beast 10 in March 2015 that's good so
only like five months later Apple

550
01:02:54,470 --> 01:02:58,868
released tent and five where they have a
new protection against hers and they

551
01:02:58,869 --> 01:03:03,259
basically removed the they are still
common we checking for a for a weird way

552
01:03:03,259 --> 01:03:08,329
20 but the action not doing it anymore
so they removed their troops shake and

553
01:03:08,329 --> 01:03:15,269
now the insurance today as a consequence
attached to the binary if not and they

554
01:03:15,269 --> 01:03:20,538
changed so that there's a special way to
validate acoustic stuff for the

555
01:03:20,539 --> 01:03:30,539
simulator however that part had a simple
integer overflow the whole code and

556
01:03:30,539 --> 01:03:34,519
basically getting execution execution

557
01:03:35,260 --> 01:03:38,260
before that he was ever triggers

558
01:03:38,830 --> 01:03:47,160
anybody ever to Apple but when they
released one month later first version

559
01:03:47,160 --> 01:03:53,319
they base it been disconnected because
we had enforced extremely paranoid

560
01:03:53,320 --> 01:03:59,160
validation of structure of 2009 me so
they're allowed checking that every

561
01:03:59,160 --> 01:04:08,410
strictly old and again in this and it's
not mind she might be the one that Apple

562
01:04:08,410 --> 01:04:11,750
basic credits the update yesterday to
stay again

563
01:04:14,200 --> 01:04:28,509
yeah yeah and the thing is that will be
the day was the tribes of stairs and the

564
01:04:28,510 --> 01:04:33,920
first attempt at doing the protection of
this from its record execution and the

565
01:04:33,920 --> 01:04:39,640
betting here is and is not as much as I
had nothing to do with this whole thing

566
01:04:39,640 --> 01:04:46,140
with the whole disclosed except the day
once and Sunday I get an email from

567
01:04:46,140 --> 01:04:53,629
someone asked me that they have fixed
please please review the facts of course

568
01:04:53,630 --> 01:05:05,770
I i didnt i didnt answer key thing here
is I don't know why I don't know why

569
01:05:05,770 --> 01:05:09,380
Apple tries to fix it by hardening new
coat signature again and again and again

570
01:05:09,380 --> 01:05:15,410
and to him this change in the Colorado
validated dynamic linkers on the correct

571
01:05:15,410 --> 01:05:20,830
fix would be to just remove this code
from the system and compile assimilated

572
01:05:20,830 --> 01:05:26,590
by recent a different way and there's no
valid reason so that every single binary

573
01:05:26,590 --> 01:05:34,270
system that allows this sector
especially the majority of users are not

574
01:05:34,270 --> 01:05:37,300
developers

575
01:05:37,300 --> 01:05:48,480
and now again the single I was fixed way
annoys me so much is because it tries to

576
01:05:48,480 --> 01:05:57,380
hide it takes about replacing the later
against evil secretly ignore that and

577
01:05:57,380 --> 01:06:04,010
the president calls from libraries and
so I can tell you that you can do the

578
01:06:04,010 --> 01:06:10,290
same over well little bit less poverty
takeover of permissions adjusting the

579
01:06:10,290 --> 01:06:11,750
original barry

580
01:06:11,750 --> 01:06:17,360
validation to do they can only be read
as much as it is the original one I just

581
01:06:17,360 --> 01:06:22,910
take the red apple one and that I needed
other end of a text cause the dynamic

582
01:06:22,910 --> 01:06:27,870
linker and that truth at least is
completely Hache they have a lot of

583
01:06:27,870 --> 01:06:39,330
things in there and all this together
make it really easy to basically just

584
01:06:39,330 --> 01:06:45,310
abuses in the same way the injection
does not work with sweet by the reason

585
01:06:45,310 --> 01:06:51,180
because that's at least one thing that
it does do the kids but you can still

586
01:06:51,180 --> 01:06:58,370
use to insert libraries with any
entitled Pinery so there's no check for

587
01:06:58,370 --> 01:07:06,140
a restricted binaries and so on and now
that means we don't have sued writes

588
01:07:06,140 --> 01:07:11,710
lincoln tech but you might all remember
route pipe from last year and new Taipei

589
01:07:11,710 --> 01:07:17,740
City was fixed by protecting it with a
portrait at medrad conflict entitlement

590
01:07:17,740 --> 01:07:27,040
so we can just take anybody that has all
the right words with it which makes US

591
01:07:27,040 --> 01:07:34,330
Route 13 a route with abusing that users
to install and then we have separate

592
01:07:34,330 --> 01:07:36,720
probe

593
01:07:36,720 --> 01:07:48,490
that's how you address later but not
right now and let me check if they

594
01:07:48,490 --> 01:07:51,490
finally ended

595
01:07:57,150 --> 01:08:08,520
actually I but OK at this point of time
the only thing we have killed the

596
01:08:08,520 --> 01:08:13,650
exclusion list so I don't need to read
all the snapshot we still disabled

597
01:08:16,259 --> 01:08:35,130
like this and I can still not touch the
derived from

598
01:08:39,089 --> 01:08:48,908
so I know as a bunch of skepticism you
see that the original notes that I just

599
01:08:48,908 --> 01:08:57,299
copied over from one of the three case I
have some dialogue I have actually not

600
01:08:57,299 --> 01:09:01,099
four not put the sauce for the
bipartisan there but for the get rude

601
01:09:01,099 --> 01:09:05,159
and I have an interest free script and
it runs the things I need to do a little

602
01:09:05,158 --> 01:09:12,439
preparation cause it needs to create its
own special temp directory in right

603
01:09:12,439 --> 01:09:15,309
place and the library support in there
and so on

604
01:09:15,310 --> 01:09:22,460
pricey oh by the way let's first very 5
I'm I have no special permission

605
01:09:25,430 --> 01:09:34,270
takes too long now I need to be route to
be that so let's get real

606
01:09:36,359 --> 01:09:44,949
so I do right now and then I suit was an
empty positive and so I become moot

607
01:09:44,948 --> 01:09:47,948
responsible shell

608
01:09:49,988 --> 01:10:04,329
I'm now route let's cannot have been
allowed to use pipes

609
01:10:07,400 --> 01:10:13,839
another challenge is activated and now I
can touch pen

610
01:10:15,880 --> 01:10:26,350
love and basically cept attack there
this time so completely in jerusalem and

611
01:10:26,350 --> 01:10:30,920
actually all the attacks I did we're
kind of used oil and except maybe I

612
01:10:30,920 --> 01:10:36,770
don't know if attaching curitiba is but
everything else was basically all use a

613
01:10:36,770 --> 01:10:47,179
lender takes to disable sip on a single
while there were no kind of memory

614
01:10:47,179 --> 01:10:54,810
corruption yeah I'm I'm finished at this
point and I blasted my time but if your

615
01:10:54,810 --> 01:10:57,810
question

616
01:11:06,140 --> 01:11:28,080
the debug burma's you can just whatever
system started it would just be

617
01:11:28,080 --> 01:11:33,860
adequately just wondered whether the
singer's I tried that she was a son of a

618
01:11:33,860 --> 01:11:47,580
doctor because normally you need a
unique network this moment and that

619
01:11:47,580 --> 01:11:50,580
looks with serial anymore

620
01:11:53,750 --> 01:12:02,520
the show because I usually do it on a
map and it's very seldom delayed due to

621
01:12:02,520 --> 01:12:10,350
two different computers so I don't know
how it works these days but and also I

622
01:12:10,350 --> 01:12:17,500
have a lot of all two systems that all
have like built-in so maybe I haven't

623
01:12:17,500 --> 01:12:20,500
has anyone else

624
01:12:23,340 --> 01:12:28,000
anyone know no questions or step on the
right stuff and thank you very much

