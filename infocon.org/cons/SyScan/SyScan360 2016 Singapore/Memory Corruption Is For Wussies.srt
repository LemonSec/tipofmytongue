1
00:00:00,000 --> 00:00:07,790
welcome to my presentation the last one
with a very provocative I told you are

2
00:00:07,790 --> 00:00:12,050
not offended if you are a main memory
corruption guy but I'll show you a very

3
00:00:12,050 --> 00:00:19,449
nice 0 those or X 20 days that are non
memory corruption so the demanding where

4
00:00:19,449 --> 00:00:25,340
my slide to make publicity to my company
to work for those guys Sentinel 1 I'm

5
00:00:25,340 --> 00:00:30,970
still a white hats for the past two
years I'm designing security products

6
00:00:30,970 --> 00:00:37,410
but more nicer than that it's the number
one trial two years ago I made a scene

7
00:00:37,410 --> 00:00:43,199
or moralists taking the week on record
doing six shots of whiskey making fun of

8
00:00:43,200 --> 00:00:48,460
fracking team last week or two weeks ago
I made a post calling the Italians

9
00:00:48,460 --> 00:00:52,890
morons there were a couple of Italians
are friends on the internet because I

10
00:00:52,890 --> 00:00:54,899
was calling they're morons

11
00:00:54,899 --> 00:01:00,710
a bunch of morons and if you look at
emails and all their check these guys

12
00:01:00,710 --> 00:01:06,670
are not that good so let's proceed with
his stuff what's up today what's what do

13
00:01:06,670 --> 00:01:11,510
I want to present you I'm killing some 0
those because I made a promise to some

14
00:01:11,510 --> 00:01:17,409
apple guy that I will give them 20 they
so I promise I will go very quickly over

15
00:01:17,409 --> 00:01:24,680
system integrity protection stuff and it
is yesterday I still going to talk about

16
00:01:24,680 --> 00:01:30,600
this so I'm just going so over some
details also to introduce a funny 0 they

17
00:01:30,600 --> 00:01:33,820
there and that's the reason why I want
to go on system integrity protection

18
00:01:33,820 --> 00:01:40,169
then I'll quickly talk about Mike
messaging and then out of nowhere Mac OS

19
00:01:40,170 --> 00:01:46,600
execute processes and then talk about
the expectation about the another bug i

20
00:01:46,600 --> 00:01:51,020
I was joking on Twitter I could easily
talk two or three hours about this

21
00:01:51,020 --> 00:01:55,149
because those two Mike messaging and
easy clergy are very interesting subject

22
00:01:55,149 --> 00:01:59,640
and you could talk about the internals
of michael is a long time and he's but I

23
00:01:59,640 --> 00:02:01,820
only have one hour

24
00:02:01,820 --> 00:02:08,549
probably another 15 minutes and then I
passed out with whiskey so system

25
00:02:08,550 --> 00:02:13,680
integrity protection as Stefan said it
was introduced at the El Capitan it

26
00:02:13,680 --> 00:02:18,930
reduces the power of the root user
stefan is the same image mental limits I

27
00:02:18,930 --> 00:02:24,610
have it's a systemwide send books
yesterday I'll be implemented and from a

28
00:02:24,610 --> 00:02:28,980
conceptual use a sandbox all over the
system and it's based on those who

29
00:02:28,980 --> 00:02:33,660
technology market which is a subset from
tourism USD two of my favorite

30
00:02:33,660 --> 00:02:40,410
technology in my quest once again let me
back sample beat those guys are closing

31
00:02:40,410 --> 00:02:45,200
this system its private API's it's still
not fully closed but you need to do some

32
00:02:45,200 --> 00:02:48,780
tricks you into the some software
compatible with older versions you need

33
00:02:48,780 --> 00:02:53,630
to play some point during games and so
on which is not that good looking to to

34
00:02:53,630 --> 00:02:57,989
the commercial product so if you want to
do something if you want to have fun

35
00:02:57,989 --> 00:02:59,410
with this

36
00:02:59,410 --> 00:03:04,269
send an email to tell them please open
markets I want to use that stuff in a

37
00:03:04,269 --> 00:03:08,000
commercial brother maybe they will
listen to you and opened its doors for

38
00:03:08,000 --> 00:03:08,850
good

39
00:03:08,850 --> 00:03:14,790
Stefan yesterday went over the details
the most important details where system

40
00:03:14,790 --> 00:03:20,070
integrity protection is based on is they
use code signatures and entitlements to

41
00:03:20,070 --> 00:03:24,880
manage authorization stefan is shown you
yesterday a few entitlements that are

42
00:03:24,880 --> 00:03:31,329
used to to control what operations
wineries can do this and I will

43
00:03:31,329 --> 00:03:36,989
emphasize is that too many wineries with
entitlements there is the range of

44
00:03:36,989 --> 00:03:41,010
entitlements that is never ending it
probably started inside their boys a

45
00:03:41,010 --> 00:03:45,760
nice solution for a small set of
problems and they expanding these for

46
00:03:45,760 --> 00:03:49,280
everything so it's really now the number
one solution we have a problem creating

47
00:03:49,280 --> 00:03:55,530
entitlement to solve that problem and
that's it so that these entitlements

48
00:03:55,530 --> 00:04:01,049
these were going really fast you can see
this Jordan jonathan levin of Mac OS

49
00:04:01,049 --> 00:04:06,560
internals book published least right now
the last time I saw the list to get only

50
00:04:06,560 --> 00:04:09,980
have iOS entitlements you can see the
list is huge

51
00:04:10,709 --> 00:04:14,020
is working on the OS X version for this

52
00:04:14,020 --> 00:04:19,660
and the list will probably also also
used so we get Oprah saying look at

53
00:04:19,660 --> 00:04:22,960
entitlements everyone gets an
entitlement because this is the reality

54
00:04:22,960 --> 00:04:25,960
you can find these days in Mac OS

55
00:04:26,840 --> 00:04:32,359
every almost every winery that there's
something interesting this is the

56
00:04:32,360 --> 00:04:37,450
indictment that stuff as shown you
yesterday the convo temple dots rootless

57
00:04:37,450 --> 00:04:41,710
not install is a very important
entitlement because if you have this it

58
00:04:41,710 --> 00:04:45,229
allows you to upload the file system
which is something that you want to do

59
00:04:45,230 --> 00:04:51,820
you want to install malware and you have
these guys looking like this is serious

60
00:04:51,820 --> 00:05:03,909
stuff you going to bring problems to
hack stuff protected processes try to

61
00:05:03,910 --> 00:05:09,940
draw these are under a debugger you will
see lol he be complaining I cannot do

62
00:05:09,940 --> 00:05:14,290
that because these binaries protected by
system protection so you start getting

63
00:05:14,290 --> 00:05:20,020
annoyed you can attest to this same
protective processes I can't remember

64
00:05:20,020 --> 00:05:24,109
which processes DS one but its system
protected process and you get the same

65
00:05:24,110 --> 00:05:29,000
message cannot attach starting to get
really annoyed and then you want to

66
00:05:29,000 --> 00:05:32,460
modify the file system you want to add
files you want to delete you want to

67
00:05:32,460 --> 00:05:37,469
update and you cannot do anything
because people tell you you are not

68
00:05:37,470 --> 00:05:41,680
allowed to to do this and you can see
the state is here it's enabled so you

69
00:05:41,680 --> 00:05:45,580
cannot do anything on your file system
and this is when you gets really annoyed

70
00:05:45,580 --> 00:05:49,580
you see when they launched see there was
a lot of confusion over the internet so

71
00:05:49,580 --> 00:05:53,890
people really annoyed because they could
not do many things on their own their

72
00:05:53,890 --> 00:05:59,900
file systems so it's really annoying I
really just always you have a code

73
00:05:59,900 --> 00:06:04,419
signing certificates that you can
disable in runtime which is useful I use

74
00:06:04,419 --> 00:06:10,419
it a lot 44 doing some stuff I enable I
disable the soup to the same thing and

75
00:06:10,419 --> 00:06:18,010
then again so is my favorite slides of
the presentation describes really good

76
00:06:18,010 --> 00:06:23,590
and see if it magically protects your
system because it looks like black magic

77
00:06:23,590 --> 00:06:25,090
the way they implemented this stuff

78
00:06:25,090 --> 00:06:31,409
and if you are ok I have a problem I
cannot take anymore

79
00:06:31,410 --> 00:06:46,360
the system for allegedly you cannot put
on a protected the process is a

80
00:06:46,360 --> 00:06:49,699
protected process is the process that
allows you to load the kernel extensions

81
00:06:49,699 --> 00:06:54,960
so we love peace process and their GB
and then you break point at the entry

82
00:06:54,960 --> 00:06:55,698
points

83
00:06:55,699 --> 00:07:00,910
any any any memory is racism cases
allegedly seat will not let you do this

84
00:07:00,910 --> 00:07:03,470
and then what you get

85
00:07:03,470 --> 00:07:09,380
run and you get the process running ok
so he can buy best to protect the

86
00:07:09,380 --> 00:07:18,740
process since someone made a mistake but
the thing is it cannot attach to the

87
00:07:18,740 --> 00:07:24,289
same process to the other processes so
what we can do it can launch processing

88
00:07:24,289 --> 00:07:32,050
allegedly protected and cannot attach
222 other processes and I think it was

89
00:07:32,050 --> 00:07:37,919
January that wasn't nice presentation at
smoke on Wednesday head this life and

90
00:07:37,919 --> 00:07:45,070
when I saw like 10 they is guys don't
probably know what is happening in the

91
00:07:45,070 --> 00:07:49,919
event I was throwing some friends some
friends and I was saying to them

92
00:07:49,919 --> 00:07:54,190
ok go see these presentation can you see
is your day there and they could not see

93
00:07:54,190 --> 00:07:58,469
is your day they didn't know what was
happening you can see that the same guys

94
00:07:58,470 --> 00:08:03,110
were saying it doesn't work on now only
be which is the condition that they have

95
00:08:03,110 --> 00:08:10,990
shown you for me as I accidentally these
closed at work on a presentation and

96
00:08:10,990 --> 00:08:17,210
when I saw this really wow these guys
Funderburg there goes 10 they that I

97
00:08:17,210 --> 00:08:22,109
really liked a lot because it's so
simple you just get GTV and that's it

98
00:08:22,110 --> 00:08:25,160
you can buy best sip

99
00:08:25,160 --> 00:08:33,080
work you have your system I'm trying to
create a file on 11 / system which is

100
00:08:33,080 --> 00:08:39,120
protected from the operation is denied
you can see that city's enabled the

101
00:08:39,120 --> 00:08:46,100
status is enable so what you do I'm
running these binary system Charles

102
00:08:46,100 --> 00:08:51,070
which is a binary that does that entail
comment the one to install files so we

103
00:08:51,070 --> 00:08:55,950
run under debugger you break point on
the entry point so that they know code

104
00:08:55,950 --> 00:09:04,030
will run then you run on the debugger
you see that the break point is it's so

105
00:09:04,030 --> 00:09:11,610
right now have full control of this
process and this is set to IDE shellcode

106
00:09:11,610 --> 00:09:23,940
for Mac very simple creates it would
sell I said basically here the shuttle's

107
00:09:23,940 --> 00:09:29,820
high over right dan surprised with the
shell coalescing unusual just changing

108
00:09:29,820 --> 00:09:35,290
memory you run you continue the process
you get to hate on donder linker because

109
00:09:35,290 --> 00:09:38,870
because you are running the the
shellcode indeed executing different

110
00:09:38,870 --> 00:09:43,780
functions you continue there is no
problem and what you got to get the

111
00:09:43,780 --> 00:09:49,199
shell and now you try again to touch the
fancy the file to create the file and

112
00:09:49,200 --> 00:09:52,200
you see the file is created and start us
off

113
00:09:53,050 --> 00:09:59,130
see peace deal in April so what we get
is system integrity protection because

114
00:09:59,130 --> 00:10:04,070
you can see the Department of Defense
it's not working as a defense measure

115
00:10:04,070 --> 00:10:09,970
sleep with a Samson with something as
simple as as you BB I totally findings

116
00:10:09,970 --> 00:10:15,380
by like I was still a GDV user I don't
like lol and that was to begin the

117
00:10:15,380 --> 00:10:19,850
process and i notice ok this is what he
was saying here I never understood

118
00:10:19,850 --> 00:10:24,550
understood the root cause of these
because I'm pretty sure this bug is

119
00:10:24,550 --> 00:10:29,339
linked to the next book and so I didn't
spend time to understands what's what

120
00:10:29,339 --> 00:10:37,420
was happening here you can hold on the
whole system basically is defeated by a

121
00:10:37,420 --> 00:10:44,189
simple it is seems you have a local
privilege escalation because only

122
00:10:44,190 --> 00:10:47,120
protects from roots so you live

123
00:10:47,120 --> 00:10:52,860
precondition needs is your foot so I'm
trying to draw here will you be from

124
00:10:52,860 --> 00:10:57,270
under was not control because if you
have to give you can buy best protection

125
00:10:57,270 --> 00:11:06,589
if essentially be to someone maybe you
are bypassing was no we like Stefano

126
00:11:06,589 --> 00:11:10,209
interviews are under his let me continue
because there is a very funny things

127
00:11:10,209 --> 00:11:13,209
over here

128
00:11:14,670 --> 00:11:21,310
I really liked a fun way to say that
cities are bits like sweaty boundaries

129
00:11:21,310 --> 00:11:25,849
because if everything is entitled a
single blog on only one of those

130
00:11:25,850 --> 00:11:30,470
entitled wineries and if you have full
control of the indictment you can do

131
00:11:30,470 --> 00:11:36,170
whatever you want to the system library
injection bucks if you can find a way to

132
00:11:36,170 --> 00:11:40,760
inject a library or cold until a process
it's game over because you will have

133
00:11:40,760 --> 00:11:46,650
your code is running into the process
from your library framework leaking bugs

134
00:11:46,650 --> 00:11:51,610
if you can find a way to link bugs like
stuff yesterday it's game over you also

135
00:11:51,610 --> 00:11:54,470
load codes into the process and that's
it

136
00:11:54,470 --> 00:12:00,330
colonel bugsy Zabel Zabel hook's
basically anything that you can manage

137
00:12:00,330 --> 00:12:06,150
to rights anyway or two at one of the
vulnerable points you can disable the

138
00:12:06,150 --> 00:12:12,020
hopes that you can set a flag that you
have on the kernel that says its enable

139
00:12:12,020 --> 00:12:18,329
or disable there was a presentation
doing that yesterday or you can exploit

140
00:12:18,330 --> 00:12:27,560
them developer's application I gots into
these applications are always someone to

141
00:12:27,560 --> 00:12:32,400
this and when I see it ok I'm pretty
sure what's happening here there is a

142
00:12:32,400 --> 00:12:34,100
colonel colonel

143
00:12:34,100 --> 00:12:40,209
extension doing their thing Jackson so I
loathe these into either and the first

144
00:12:40,209 --> 00:12:44,859
thing is I really know these codes and I
went to stew to start disassembling its

145
00:12:44,860 --> 00:12:50,360
my cold or no proof of concept that I
post and the guy reap most of Michaels

146
00:12:50,360 --> 00:12:55,440
and didn't even give me credit for that
funny thing is that the guy copy even

147
00:12:55,440 --> 00:12:59,759
bike so people are just getting cold
copying the code and they don't even

148
00:12:59,759 --> 00:13:06,600
understand the codes so the signed
extension these guys as a colonel

149
00:13:06,600 --> 00:13:14,930
certificates so we can install these any
any Mac the guy doesn't really

150
00:13:14,930 --> 00:13:20,019
understand the whole process so you can
exploit this extension and load on our

151
00:13:20,019 --> 00:13:23,779
return a library into any process so you
install

152
00:13:23,779 --> 00:13:30,410
download this doesn't try to install the
kernel extension until the target is

153
00:13:30,410 --> 00:13:38,120
exploiting someone and then used abused
his application Dardis kernel extension

154
00:13:38,120 --> 00:13:43,310
to load the now-retired library into any
process so you have for example the 2012

155
00:13:43,310 --> 00:13:50,069
the system show to write faster to sort
of you know that process you inject a

156
00:13:50,069 --> 00:13:56,199
library and that's it came over you can
do whatever you want and bypass sit have

157
00:13:56,199 --> 00:14:01,180
been pushing these are even talking
about this code signing years and is not

158
00:14:01,180 --> 00:14:07,370
really an obstacle because in terms of
people just need to spend $99 to buy a

159
00:14:07,370 --> 00:14:12,329
new certificate and give them some
excuse I want to the security products I

160
00:14:12,329 --> 00:14:16,839
want to do something that I need colonel
access and that's it they will give you

161
00:14:16,839 --> 00:14:19,569
the the certificate it's not really
their fault

162
00:14:19,569 --> 00:14:24,959
very difficult process I can you know
what what the user is doing the only way

163
00:14:24,959 --> 00:14:30,339
is sent as the cold will shake it like
the App Store and then we can give you

164
00:14:30,339 --> 00:14:34,589
the security code I'm not sure what is
the best process I just think that

165
00:14:34,589 --> 00:14:38,230
consigning is not really a security
measure

166
00:14:39,009 --> 00:14:41,790
guys

167
00:14:41,790 --> 00:14:46,910
me on Twitter I start making some noise
and they already revoked certificate but

168
00:14:46,910 --> 00:14:50,949
the guy that application told me it's
not a problem I got the fuel

169
00:14:50,950 --> 00:14:56,050
certificates so they will be playing
games canceled search brigade River Oaks

170
00:14:56,050 --> 00:15:03,680
articulate with with this simple as some
design problems I will go on on

171
00:15:03,680 --> 00:15:11,670
conclusions about this but I continue so
let's go into Mac and what is Mac

172
00:15:11,670 --> 00:15:19,750
introduction to mark mike is the core is
the core part of the kernel of michael s

173
00:15:19,750 --> 00:15:27,770
journalism you colonel and then the TPS
delia onto on top of it everything is

174
00:15:27,770 --> 00:15:32,390
implemented objects and the task two
strands of Utah memory it's quite

175
00:15:32,390 --> 00:15:40,210
interesting the design in terms of you
like these I know of everything is

176
00:15:40,210 --> 00:15:43,960
communicated with messages this is also
one of the problems of my colonels

177
00:15:43,960 --> 00:15:46,750
because of the performace

178
00:15:46,750 --> 00:15:51,690
is messaging you live for example from
users to colonel contest switching and

179
00:15:51,690 --> 00:16:00,160
that this type of kernels for example
there is based on dynamic design and

180
00:16:00,160 --> 00:16:04,730
probably it's one of the reasons why not
help still not final because they have

181
00:16:04,730 --> 00:16:13,260
problems there an example or graphic
Architektur you can see max here really

182
00:16:13,260 --> 00:16:20,100
low it's very very near the hardware so
it's the basis for everything else these

183
00:16:20,100 --> 00:16:24,430
refugees is a bit more simple and you
can see Mac encapsulating

184
00:16:24,430 --> 00:16:30,319
is always talked to the to the drivers
and then it can see the the BSD later

185
00:16:30,320 --> 00:16:36,840
based on top of so it's really nice
Architektur leader nice job you can read

186
00:16:36,840 --> 00:16:41,710
the story about these it's really
benefit our sex when they made the

187
00:16:41,710 --> 00:16:48,090
transition from the old system 722 this
interesting types for interesting things

188
00:16:48,090 --> 00:16:50,420
for us for this presentation

189
00:16:50,420 --> 00:16:57,990
there are two types of Mac message
simple and complex messages basically

190
00:16:57,990 --> 00:17:01,430
container fix it heavier for
communicating with Mike Mike Mike

191
00:17:01,430 --> 00:17:08,069
internal details and then add that in
this case I put your fingers in pussy

192
00:17:08,069 --> 00:17:15,178
eating grass sign along along a 64 oz
caster and so on so it's very simple

193
00:17:15,179 --> 00:17:21,530
they put a header and put some value
when you sent this that's the reason why

194
00:17:21,530 --> 00:17:26,178
it's called a simple message
accomplished messager are the ones that

195
00:17:26,179 --> 00:17:33,480
are more interesting they also have to
set to tell to the system are many

196
00:17:33,480 --> 00:17:38,320
descriptors are you going to have been
you have a list that the data the

197
00:17:38,320 --> 00:17:43,168
serialize descriptors whether they did
that you want to send a message and

198
00:17:43,169 --> 00:17:47,490
interesting thing is that you can send
out of line data and port rights on

199
00:17:47,490 --> 00:17:52,610
those messages meaning you can send you
ever been a process and it can tell you

200
00:17:52,610 --> 00:17:57,080
can for example the rights to a port to
another process

201
00:17:58,040 --> 00:18:03,389
pointers for example if you will get TN
beer should look at these least they are

202
00:18:03,390 --> 00:18:10,480
somebody's on on Mac basically you can
send pointers then they were not

203
00:18:10,480 --> 00:18:16,350
checking the addresses of those parts so
out of bounds parts pointers and so on

204
00:18:16,350 --> 00:18:22,219
so books everywhere dude interesting
very interesting area 44 research I

205
00:18:22,220 --> 00:18:28,100
built on the kernel so I can snuff all
the Mac messages and idea the goal of

206
00:18:28,100 --> 00:18:34,330
that is to kill the snakes are not as if
not a big fan and because you need to

207
00:18:34,330 --> 00:18:39,270
understand what messages are being best
22 into the kernel for example if we

208
00:18:39,270 --> 00:18:44,980
start phasing you need to know the type
of messages from you is the best way to

209
00:18:44,980 --> 00:18:49,429
find everything that goes on under
system now I can for all those messages

210
00:18:49,429 --> 00:18:54,010
on those pointers an interesting stuff
it will probably get one of these days

211
00:18:54,010 --> 00:18:57,010
so you can play with it

212
00:18:59,309 --> 00:19:04,070
the diagram of a complex message so this
is the heavier that you said the

213
00:19:04,070 --> 00:19:07,759
different options the size of the
message to heart through to the end

214
00:19:07,759 --> 00:19:14,559
points of the message comes from and
where it goes to the Scriptures are many

215
00:19:14,559 --> 00:19:19,649
descriptors insights that message then
the descriptors and they can ask for

216
00:19:19,649 --> 00:19:26,469
some data for some trailers to other
today that was the message messages and

217
00:19:26,470 --> 00:19:32,230
so on its not very important I just put
here to speak and understand and the

218
00:19:32,230 --> 00:19:37,749
format of the message if you have been
here the last year I was talking about

219
00:19:37,749 --> 00:19:43,779
kernel rootkits and interesting Mike
parts there are three interesting parts

220
00:19:43,779 --> 00:19:47,590
MacPorts them or parts of the special
portents wandered are also interesting

221
00:19:47,590 --> 00:19:52,730
but in terms of an apple for binary they
are treating the task which represents

222
00:19:52,730 --> 00:19:59,119
the whole process the trap that gives
you access to the threat so you can have

223
00:19:59,119 --> 00:20:04,129
parts for the gun control for example a
single thread and everything else you

224
00:20:04,129 --> 00:20:07,959
are not controlling and the host is the
machine is still have access to the host

225
00:20:07,960 --> 00:20:12,990
parts you can do whatever you want to
the machine at every other process so

226
00:20:12,990 --> 00:20:18,529
let's see how was talking about these
bug sound-bite ET two years ago from

227
00:20:18,529 --> 00:20:19,960
what's wrong

228
00:20:19,960 --> 00:20:25,580
despite what particularly to you is
access to the to the kernel passport so

229
00:20:25,580 --> 00:20:30,309
if you have access to that party control
if you have somehow the kernel

230
00:20:30,309 --> 00:20:34,240
transporting can control the colonel and
then you can write what everyone skurdal

231
00:20:34,240 --> 00:20:38,059
memory and you can use these for
rootkits which was part of my

232
00:20:38,059 --> 00:20:43,019
presentation last year of using these
these vulnerabilities and the other was

233
00:20:43,019 --> 00:20:48,159
using the kernel extension that staff
presented yesterday the abolition of

234
00:20:48,159 --> 00:20:52,159
rock says the one day black police
because brought most probably because of

235
00:20:52,159 --> 00:20:55,620
my presentation last year

236
00:20:55,620 --> 00:20:59,340
to retrieve the passports from from
another task

237
00:20:59,340 --> 00:21:07,510
privileges because if any part of other
tasks there will be no security under

238
00:21:07,510 --> 00:21:11,910
normal circumstances this is what
happens when taking bugs out of the

239
00:21:11,910 --> 00:21:17,520
equation you'll get to prompt that
prompt asking you for identifying and

240
00:21:17,520 --> 00:21:22,730
there's sometimes normally a debugger
once access to these other tasked with

241
00:21:22,730 --> 00:21:35,780
identifying please make sure that you
want to do this operation privileges to

242
00:21:35,780 --> 00:21:46,740
get its own port itself describing it
gets tossed the Mac system leave the

243
00:21:46,740 --> 00:21:53,320
port to the Mac task force to myself so
its application is asking give me my own

244
00:21:53,320 --> 00:21:59,610
part doesn't need any security but this
this is interesting because of what I

245
00:21:59,610 --> 00:22:05,639
told the parts and the rights to the
parts they can be best between tasks

246
00:22:05,640 --> 00:22:14,179
between complex message to the way I
found this book because I was thinking

247
00:22:14,179 --> 00:22:19,470
about the time with which pipe and I was
starting singing ok I want to control

248
00:22:19,470 --> 00:22:24,610
the process I know this may be there is
a way I can pass that the port to

249
00:22:24,610 --> 00:22:29,590
another application that is part of the
design and then I found the race

250
00:22:29,590 --> 00:22:34,490
condition thinking about it and because
I i did some a lot of work on that area

251
00:22:34,490 --> 00:22:39,690
where the bris condition happens and you
know it's kind of ideas that before it

252
00:22:39,690 --> 00:22:44,429
didn't occur to you then there's a drink
around inside Iranian you see clearly

253
00:22:44,429 --> 00:22:48,860
where the bodies it's really easy to see
after after you know where it is it's

254
00:22:48,860 --> 00:22:53,669
really easy to understand the bank so if
you have to

255
00:22:54,410 --> 00:22:59,350
the task parts if you pass this task
port to some other application you have

256
00:22:59,350 --> 00:23:03,949
full control of that application from
from somewhere else and we don't need to

257
00:23:03,950 --> 00:23:08,970
use the normal EPA's a task force which
is the function at we'll ask you for

258
00:23:08,970 --> 00:23:14,700
authorization this doesn't happen under
normal situations in the kitchens living

259
00:23:14,700 --> 00:23:19,590
that the sport to other two other
applications now is no such thing as a

260
00:23:19,590 --> 00:23:24,370
bad guy please take my passport do
whatever you want with my application

261
00:23:24,370 --> 00:23:30,139
unless there is a developer doing bad
things with that went through that if

262
00:23:30,140 --> 00:23:37,770
you are aware analyzer for max there's
not a lot of work on that area it's not

263
00:23:37,770 --> 00:23:42,700
nothing compared with what you can use
the street from malware purposes for

264
00:23:42,700 --> 00:23:49,610
example you can get very old windows
trick you can get two processes one is

265
00:23:49,610 --> 00:23:50,870
the master process

266
00:23:50,870 --> 00:23:58,699
child process or domain process what you
have an application by support another

267
00:23:58,700 --> 00:24:05,750
application to the master the message is
now for example you can execute code in

268
00:24:05,750 --> 00:24:11,550
the massive bruises you generate an
exception in the child the child says

269
00:24:11,550 --> 00:24:17,110
okay I have a problem the monster can
control the process gets an exception

270
00:24:17,110 --> 00:24:23,090
execute a bunch of gold and then sends a
result for example to the to the child

271
00:24:23,090 --> 00:24:30,169
if you make this coating the master can
get pretty annoying for reversal is a

272
00:24:30,170 --> 00:24:34,930
trick for example known as Toulon bytes
in in windows and different variations

273
00:24:34,930 --> 00:24:40,180
so pay attention this kind of freaks can
start happening in your micro is where

274
00:24:40,180 --> 00:24:44,840
the fighters really want to have some
fun designing these and creating some

275
00:24:44,840 --> 00:24:51,250
problems and Broadway dampens ok I see
the code executes but I don't understand

276
00:24:51,250 --> 00:24:56,970
which is also an advantage because if
you attach a debugger there is no longer

277
00:24:56,970 --> 00:25:01,340
will not know doesn't know what is the
exception and it will pressure or

278
00:25:01,340 --> 00:25:04,600
whatever and you fail to see what is
happening so you need to think of it

279
00:25:04,600 --> 00:25:06,759
about what is happening there

280
00:25:06,759 --> 00:25:14,469
look at look at the market by and see if
they have anything like this very

281
00:25:14,469 --> 00:25:20,139
quickly to send mike messages between
between the processes it's very easy to

282
00:25:20,139 --> 00:25:25,279
define for much in this case you have
the header which is demanding the body

283
00:25:25,279 --> 00:25:31,379
and this is the they will report that I
want to send between between processes

284
00:25:31,379 --> 00:25:35,968
and this is the underside in this case
however the trailer because at the time

285
00:25:35,969 --> 00:25:40,929
I was testing some stuff but the message
could be just this format it would be ok

286
00:25:40,929 --> 00:25:47,699
you register a server to basically do
some magic with parts you need to

287
00:25:47,699 --> 00:25:53,949
allocate ports and give rights Mac stuff
and then you this dysfunction doesn't

288
00:25:53,949 --> 00:25:59,279
have this function on on includes so you
need to put an external with this

289
00:25:59,279 --> 00:26:03,769
function it's very easy and then what
dysfunction is doing its registered

290
00:26:03,769 --> 00:26:09,609
report with lunch the munchies the main
server order in it D equivalent in in

291
00:26:09,609 --> 00:26:16,948
Mac OS X control the ports so you say
now there is this process the server

292
00:26:16,949 --> 00:26:23,589
process you can find me at this part in
this case this one and so if any process

293
00:26:23,589 --> 00:26:30,049
wants to talk to this server it will
register of make a look up and say okay

294
00:26:30,049 --> 00:26:40,099
there is this application that sport go
there and you are waiting for messages

295
00:26:40,099 --> 00:26:44,639
because we are the server process and
there will be clients talking to to this

296
00:26:44,639 --> 00:26:50,559
in terms of an option saying I'ma summer
I'm waiting for messages to come to my

297
00:26:50,559 --> 00:26:55,859
son small retail Mac message function
that will receive process of the

298
00:26:55,859 --> 00:26:56,658
messages

299
00:26:56,659 --> 00:27:02,469
blocks so it's it's waits until server
is waiting there so there's not not a

300
00:27:02,469 --> 00:27:06,419
problem you don't need to worry about
about these do not need any tricks

301
00:27:06,419 --> 00:27:12,359
during select all kind of stuff it will
do all the dirty work for you

302
00:27:12,359 --> 00:27:18,000
so this is my server disguise I i said
im waiting

303
00:27:18,000 --> 00:27:23,410
messages then I said some parts stuff
and then here you are Mike message

304
00:27:23,410 --> 00:27:28,080
function cold and it's waiting for a
message when the clients in some matches

305
00:27:28,080 --> 00:27:32,020
it will continue the codes on Monday
slope industries I'm doing a little

306
00:27:32,020 --> 00:27:37,440
because I will show you later I want to
it's a race condition so I want to to to

307
00:27:37,440 --> 00:27:44,020
move on July wind the condition on the
client's what the plan which will look

308
00:27:44,020 --> 00:27:49,379
up the server is a server it can
continue if there's not a server it

309
00:27:49,380 --> 00:27:55,210
cannot do anything because we are doing
a client-server think this is the

310
00:27:55,210 --> 00:28:01,060
message that is locating the server the
server

311
00:28:02,140 --> 00:28:07,040
this is asking lunch the one is the
server if there is a server tell me I

312
00:28:07,040 --> 00:28:12,960
want to talk to the server then it just
a magic again with Mike force basically

313
00:28:12,960 --> 00:28:18,300
rights to receive messages and I just
say I want to receive messages basically

314
00:28:18,300 --> 00:28:23,790
because it just contact my message to
you it needs to know

315
00:28:23,790 --> 00:28:28,210
ok you want to receive messages you have
rights for for that I can send you

316
00:28:28,210 --> 00:28:33,880
messages once again this is the client
the client is sending a message it is a

317
00:28:33,880 --> 00:28:40,220
complex messages because we want to send
a port right we are setting and and

318
00:28:40,220 --> 00:28:44,770
sending here that you want to send a
message and sent setting parts of

319
00:28:44,770 --> 00:28:51,360
basically initializing market internals
and is the trick that you that you used

320
00:28:51,360 --> 00:28:57,520
to send a message this is the body that
the body tells you there is one part

321
00:28:57,520 --> 00:29:01,070
right you can put more than one part
rights in this case there is no interest

322
00:29:01,070 --> 00:29:06,290
in doing that and here you have to trick
the application is getting its own parts

323
00:29:06,290 --> 00:29:10,860
and it's going to send this fort to the
server so when the server received his

324
00:29:10,860 --> 00:29:17,060
december can do whatever he wants to the
client application and finally send a

325
00:29:17,060 --> 00:29:22,850
message once again use Mac message we
get the whole messages is israeli to to

326
00:29:22,850 --> 00:29:27,280
be sent the message to the server in the
server will receive the message

327
00:29:28,179 --> 00:29:34,049
the server once it's received the
message it will extract the port it has

328
00:29:34,049 --> 00:29:38,929
control of the port can do whatever and
in this case I use a trick to

329
00:29:38,929 --> 00:29:43,369
synchronize the client and server I sent
the reply message it's empty messages I

330
00:29:43,369 --> 00:29:47,119
don't need to send anything I just want
to see the client that the server

331
00:29:47,119 --> 00:29:52,949
finally received the message and it's
ready to to to to start the race I'm not

332
00:29:52,950 --> 00:29:58,039
sure if you really need is that allows
you to synchronize the client and server

333
00:29:58,039 --> 00:30:08,330
so but this way it also works you can
see these here did this come from the

334
00:30:08,330 --> 00:30:15,908
server so we are the server received
reports reports right and he's a local

335
00:30:15,909 --> 00:30:21,070
variable on part another server can do
whatever we do we do sports can ride

336
00:30:21,070 --> 00:30:27,330
Sorkin read memory from from the clients
and is sending a reply saying okay I'm

337
00:30:27,330 --> 00:30:32,330
ready you can stop the freak on your
side then they will start the trick on

338
00:30:32,330 --> 00:30:34,279
my side

339
00:30:34,279 --> 00:30:42,399
relevant my original goal at the time
was to take control of Spidey binaries

340
00:30:42,399 --> 00:30:48,080
the reason is what I was working with
roots private with something exporting

341
00:30:48,080 --> 00:30:54,749
some alternatives but then I saw ok
after undertaking work like control any

342
00:30:54,749 --> 00:31:01,190
binary so I can control any entitled
winery with the same technique so the

343
00:31:01,190 --> 00:31:07,379
bug allows you to do privilege
escalation and then allow you to 60

344
00:31:07,379 --> 00:31:20,369
which is run by allows you to control
everything on under system is located is

345
00:31:20,369 --> 00:31:30,408
a pretty sure exactly and all the fire
and variance you have one on my question

346
00:31:30,409 --> 00:31:36,200
a few you also you can call this one
market which is not a subset and he's

347
00:31:36,200 --> 00:31:39,409
also expanded existing Linux and so on

348
00:31:39,409 --> 00:31:41,270
is very good one if you are looking for

349
00:31:41,270 --> 00:31:47,090
performance this one is more performance
for days even if this is important for

350
00:31:47,090 --> 00:31:51,300
forcing if you're doing something in OSX
but still the performance in OS X is

351
00:31:51,300 --> 00:31:57,200
really bad this is one of the things in
FL comply complains about its very slow

352
00:31:57,200 --> 00:32:01,730
the performances live once served or
even worse than for example Linux so

353
00:32:01,730 --> 00:32:06,760
it's not a good the funding platform so
when you execute something you go around

354
00:32:06,760 --> 00:32:12,460
these stocks are putting stuff in the
kernel this is a very important function

355
00:32:12,460 --> 00:32:20,870
it decides what is the format what what
are you going to execute talking about

356
00:32:20,870 --> 00:32:25,270
these in Linux it has the same it
decides if it's the scripts if it's

357
00:32:25,270 --> 00:32:29,590
Michael binary and some other minor some
other type of things that you can

358
00:32:29,590 --> 00:32:30,709
execute

359
00:32:30,710 --> 00:32:35,220
decision or to take a decision it reads
the file because it makes you understand

360
00:32:35,220 --> 00:32:39,690
if it's a binary shortest route and if
it's a binary till execute this function

361
00:32:39,690 --> 00:32:44,760
that will start loading the binary and
doing all the the trickery to load the

362
00:32:44,760 --> 00:32:50,120
binary dysfunction is very important it
is the one that loves the binary your

363
00:32:50,120 --> 00:32:55,449
partner binary and so on and this
function is one that will check if the

364
00:32:55,450 --> 00:32:57,410
winery is a sweaty winery

365
00:32:57,410 --> 00:33:02,250
to do some protections on undead winery
because the binaries are very important

366
00:33:02,250 --> 00:33:04,730
in the system

367
00:33:04,730 --> 00:33:11,980
I just put each year to to show that the
function load much much this is where

368
00:33:11,980 --> 00:33:19,610
most of the work happens when you load
any winery so what this function does it

369
00:33:19,610 --> 00:33:26,370
it will really again the binary from the
disk in my memory if it's a view for

370
00:33:26,370 --> 00:33:31,459
Cora normal for there are some
differences in terms of memory but it's

371
00:33:31,460 --> 00:33:38,559
just wanted us most of the parsing
loading of the winery happens inside

372
00:33:38,559 --> 00:33:44,399
this function that that is inside the
dysfunction probably is a problem

373
00:33:44,400 --> 00:33:50,840
interesting fortune to to look for bucks
and Stefan says Apple never gets patches

374
00:33:50,840 --> 00:33:57,010
correct all the time so you probably
want to do some research work on parsing

375
00:33:57,010 --> 00:34:02,140
they are improving and gardening demarco
parsing but there's still some bugs

376
00:34:02,140 --> 00:34:07,440
inside interesting book are very old
book remember who should control the

377
00:34:07,440 --> 00:34:12,000
task parts you control the process and
inventor there was a very interesting

378
00:34:12,000 --> 00:34:18,489
but that looks obvious now whatever
needs that issue and that's why the

379
00:34:18,489 --> 00:34:19,319
binary

380
00:34:19,320 --> 00:34:27,960
because they were not resulting that
port so you n for example you will

381
00:34:27,960 --> 00:34:32,270
launch the application to the weather
was controlling the application because

382
00:34:32,270 --> 00:34:36,659
they were not cleaning the parts of the
book I will have the access on that

383
00:34:36,659 --> 00:34:41,320
process and then you have swayed and
whatever spanish girl that's so when

384
00:34:41,320 --> 00:34:46,240
punter they fix this bug by resetting
the party fits us why the binary they

385
00:34:46,239 --> 00:34:50,529
will resent the port before so that you
cannot take control of the process

386
00:34:50,530 --> 00:34:53,580
inside the privilege

387
00:34:53,580 --> 00:35:00,040
so you cannot do anything you can find
this cool it was modified because Apple

388
00:35:00,040 --> 00:35:04,940
has added more features and so on so in
these days they also they resent the

389
00:35:04,940 --> 00:35:09,440
task force and they also results the
trade for it because it could be

390
00:35:09,440 --> 00:35:12,520
controlling up a threat and if you
control the trade you could be lucky and

391
00:35:12,520 --> 00:35:16,259
control something interesting some call
them dresses some interesting call the

392
00:35:16,260 --> 00:35:23,000
same thing you could exploit it sold to
resume what happens here the kernel we

393
00:35:23,000 --> 00:35:28,160
load bars and map the executable the new
executable that you want to execute and

394
00:35:28,160 --> 00:35:34,580
it will try to guarantee the integrity
of the new process versus its parent so

395
00:35:34,580 --> 00:35:39,810
if you ever wanted to execute a sweaty
binary you cannot are in Serie you

396
00:35:39,810 --> 00:35:45,279
cannot do anything from the parent brand
cannot influence the child she read it

397
00:35:45,280 --> 00:35:52,630
should be protected so its rise to
protect and nurture its Michael will try

398
00:35:52,630 --> 00:36:01,600
to show you that doesn't protect these
when it executed the image this is

399
00:36:01,600 --> 00:36:06,630
loading the file parsing so right now
and dysfunction finishes you have

400
00:36:06,630 --> 00:36:07,780
already

401
00:36:07,780 --> 00:36:14,940
the new binary maps in memory then it
calls a function that will result of the

402
00:36:14,940 --> 00:36:20,100
test port and industrial region but if
you look with some attention to this is

403
00:36:20,100 --> 00:36:25,640
a race condition between these two
points what happens is that when you

404
00:36:25,640 --> 00:36:33,609
hear the new winery is already parsed
and take some time to reset the ports

405
00:36:33,610 --> 00:36:39,570
which is obvious if you are somewhere
between here and here you can do

406
00:36:39,570 --> 00:36:44,760
whatever you want to the new process so
if you have the porting another process

407
00:36:44,760 --> 00:36:50,120
in a server process for example you can
stocks rights to the new process before

408
00:36:50,120 --> 00:36:56,120
this happens if it changed the cold of
that process it's game over

409
00:36:56,120 --> 00:37:00,700
you just want a race condition you can
do whatever you want this Mr develop the

410
00:37:00,700 --> 00:37:03,368
scheme because the stakes

411
00:37:03,369 --> 00:37:13,210
seep seep there's something here it asks
to see if that process can can do

412
00:37:13,210 --> 00:37:17,059
something to the other process but
basically the race condition is still

413
00:37:17,059 --> 00:37:23,470
there you can you can improve it because
these will take more CPU cycles between

414
00:37:23,470 --> 00:37:28,359
here and here so the rest can be one
even better so browse introduced

415
00:37:28,359 --> 00:37:37,288
improved the race condition and that
happens here what I was telling you the

416
00:37:37,289 --> 00:37:44,140
parts are only after the binary the new
binary he's already mapped so if you do

417
00:37:44,140 --> 00:37:48,808
the trick that I was explaining you if
you press the port before execution to

418
00:37:48,809 --> 00:37:55,109
another winery then you don't need to
fork you just do you know what does it

419
00:37:55,109 --> 00:37:59,640
it will map a new image inside the
process so the task forty still is still

420
00:37:59,640 --> 00:38:03,519
the same it doesn't change and you can
do whatever you want during that race

421
00:38:03,519 --> 00:38:08,508
condition to the new process so if you
wind let's raise its game over we just

422
00:38:08,509 --> 00:38:14,700
influence the the code of the new
process so the trick is to get the task

423
00:38:14,700 --> 00:38:21,868
part of another task the port to another
process via Mac we don't want to use

424
00:38:21,869 --> 00:38:27,569
days because it will acquire prompted
will say what your password so these not

425
00:38:27,569 --> 00:38:33,130
waste else still there there are
probably some very few users that give

426
00:38:33,130 --> 00:38:37,480
them a prompt a please put your best
foot but this is not the way we want to

427
00:38:37,480 --> 00:38:43,029
do it we have a client which will do

428
00:38:43,029 --> 00:38:51,869
days with us waving banners are entitled
owner and then we will try to win that

429
00:38:51,869 --> 00:38:55,440
race so that everything is put together

430
00:38:57,630 --> 00:39:11,400
correct because it will get the port to
itself and sends via mark to the server

431
00:39:11,400 --> 00:39:17,240
the server will acknowledge that it
received the parts from the client sends

432
00:39:17,240 --> 00:39:23,629
an acknowledged and while the client is
waiting for its clients received it was

433
00:39:23,630 --> 00:39:30,970
trying to execute why the process in
this case and violets executing these

434
00:39:30,970 --> 00:39:36,839
the server starts trying to write it
starts to try to win the race or try to

435
00:39:36,839 --> 00:39:42,470
using this function Macrium rights which
is a function that allows you to write

436
00:39:42,470 --> 00:39:50,390
to memory of any time that you have the
power to if this lady task is mapped

437
00:39:50,390 --> 00:39:55,740
it's already mapped this way details so
we are trying to to win the race if we

438
00:39:55,740 --> 00:40:04,299
get a root shell in the case of office
yd process we can write data to into the

439
00:40:04,299 --> 00:40:08,589
new process if we win the race you can
put the shell called into the winter

440
00:40:08,589 --> 00:40:09,430
point

441
00:40:09,430 --> 00:40:13,759
constructors you can put there because
construction will execute code before

442
00:40:13,759 --> 00:40:21,259
the main entry point its depends on the
targets young exploitation if we win the

443
00:40:21,259 --> 00:40:28,680
race when we will always win the race
might take 12 or fewer times but we we

444
00:40:28,680 --> 00:40:36,049
will win this race it's game over the
system is exploited complicates things

445
00:40:36,049 --> 00:40:42,930
are something called a SLR if you try to
exploit these against San on minorities

446
00:40:42,930 --> 00:40:47,089
for example there's a poker game
PokerStars client to their deserts yd

447
00:40:47,089 --> 00:40:56,308
binary 32 bids its deadly when the time
came over 32 bit binary is that I can't

448
00:40:56,309 --> 00:41:01,099
remember why but it also works without
any problems because of probably the

449
00:41:01,099 --> 00:41:07,259
space is very small and some more stuff
inside the kernel that allows you to win

450
00:41:07,259 --> 00:41:10,540
the race but the problem is 64 bit
wineries

451
00:41:10,540 --> 00:41:15,440
on modern systems on the phone system
most of the stuff is 64 bit or

452
00:41:15,440 --> 00:41:22,540
depressing stuff so we sell our to give
us a problem but I'm not a super

453
00:41:22,540 --> 00:41:28,590
exporter like many other guys I'm not on
that's most of that area I asked some

454
00:41:28,590 --> 00:41:33,910
three more some data and yet some died
about a year seller and he told me ok

455
00:41:33,910 --> 00:41:39,740
just brute force with the selected value
you can use as any other value there I'm

456
00:41:39,740 --> 00:41:45,490
not sure if it's really true or not but
if you if you try to together some sixty

457
00:41:45,490 --> 00:41:52,049
60 weapons as well you quite a few times
and if you look at the algorithm in the

458
00:41:52,050 --> 00:41:58,850
RSX colonel in snow the function that
generates a SLR will generate 0 I'm not

459
00:41:58,850 --> 00:42:04,180
sure if you can accept it there will be
a chance that the processes you wish you

460
00:42:04,180 --> 00:42:11,470
could say okay just take 1111 point on
on that end and do not a set I'm not

461
00:42:11,470 --> 00:42:13,209
sure what is

462
00:42:13,210 --> 00:42:19,190
what position on that it's just an
interesting seeing you can use 0 and

463
00:42:19,190 --> 00:42:25,370
brute force what this means if we are
trying to force a SLR exploit will be

464
00:42:25,370 --> 00:42:33,560
super noisy because we need to though
like dental we win the race so this is a

465
00:42:33,560 --> 00:42:36,560
great vulnerability but the execution is
not that good

466
00:42:37,400 --> 00:42:42,020
probably most will not notice northern
cities are very fast

467
00:42:42,020 --> 00:42:47,030
get a spike but that's it they will not
notice but someone that is looking at my

468
00:42:47,030 --> 00:42:50,920
attention that you want to exploit
they'll probably something weird is

469
00:42:50,920 --> 00:42:54,270
happening so I'm not impressed

470
00:42:54,270 --> 00:43:01,200
can you do better than this is a very
nice man I get so what do we need the

471
00:43:01,200 --> 00:43:08,140
known address under under process we
cannot attack because the link has its

472
00:43:08,140 --> 00:43:14,569
own SLR offset which is which changes
with every execution so we cannot attack

473
00:43:14,570 --> 00:43:22,450
it that we have the same problem with
what else can we do that is probably on

474
00:43:22,450 --> 00:43:29,609
a fix it there is something that the
library cache this case she's maps into

475
00:43:29,610 --> 00:43:35,770
every process it is run the miles on
each reboot so there is some entropy on

476
00:43:35,770 --> 00:43:42,900
this but while the machine is up it is
the same address for any process so you

477
00:43:42,900 --> 00:43:48,530
know there is a position we are brute
forcing so it's okay for us

478
00:43:49,120 --> 00:43:58,230
weekend as it has some advantages it is
copy on write like 250 megabytes cash or

479
00:43:58,230 --> 00:43:59,250
whatever

480
00:43:59,250 --> 00:44:05,260
map into every process that will not
work on writing is a nice technique for

481
00:44:05,260 --> 00:44:12,650
us so we just need to modify a function
by the winery and sees its copyright

482
00:44:12,650 --> 00:44:17,750
only that winery will have a different
copy of these library memory so this is

483
00:44:17,750 --> 00:44:20,750
safe we are not attacking other
processes

484
00:44:21,260 --> 00:44:31,210
to go on risky so the point of BS which
is a slavery in OS X and you can see

485
00:44:31,210 --> 00:44:39,650
they are calling function very early in
the process so what we can have the

486
00:44:39,650 --> 00:44:46,580
server process find where this function
is in the library can we just need to do

487
00:44:46,580 --> 00:44:51,470
this once because we know the library's
map on every address so when you find it

488
00:44:51,470 --> 00:44:57,060
at that address it will be always so the
server can find it on itself on its own

489
00:44:57,060 --> 00:45:03,450
cash worries dysfunction that's it but
these as an advantage that you to

490
00:45:03,450 --> 00:45:09,270
improve our chances because we know we
are going to rights instead of forcing

491
00:45:09,270 --> 00:45:16,580
in finding and using the SLR of setoff
do we know we are going to try to write

492
00:45:16,580 --> 00:45:24,279
that to fix it all said so this exploit
months we just need like 125 at them and

493
00:45:24,280 --> 00:45:32,880
we also there is a bug lesion with this
will be his exploits seems to be better

494
00:45:32,880 --> 00:45:37,950
because it doesn't difference week trial
with a lot but it's more or less the

495
00:45:37,950 --> 00:45:43,540
same 11 attempt to attempts and it's
it's game over under under under race

496
00:45:43,540 --> 00:45:50,090
condition so why these bodies is so
great it's 100% reliable it will always

497
00:45:50,090 --> 00:45:55,290
work it's 100% safe because it will not
crash the process if you fail to win the

498
00:45:55,290 --> 00:45:59,509
race condition nothing special weapons
but at least I tried so many times then

499
00:45:59,510 --> 00:46:07,800
I never had a problem everything except
the one that is already bad you can have

500
00:46:07,800 --> 00:46:14,030
using binary so I was joking on Twitter
I loves to to excavate privileges using

501
00:46:14,030 --> 00:46:19,210
PCs because it's BS it shouldn't do
anything special and confusing entitled

502
00:46:19,210 --> 00:46:23,360
binary because you can control that the
process you can launch if you want to

503
00:46:23,360 --> 00:46:27,690
install the kernel binary that as
colonel

504
00:46:28,349 --> 00:46:35,180
closing process privileges and that's it
so I told you I from these last year in

505
00:46:35,180 --> 00:46:39,538
early 2005 there was a bug collision
with the NBA

506
00:46:39,539 --> 00:46:43,249
reported to Apple before me and he did
yesterday

507
00:46:43,749 --> 00:46:48,529
posed about these years a slightly
different technique exploiting this but

508
00:46:48,529 --> 00:46:53,640
the concept is is is exactly the same
it's the same race the same way is to

509
00:46:53,640 --> 00:47:04,150
send the boards so it's it's an iceberg
collisions that will look to see that

510
00:47:04,150 --> 00:47:17,619
exploit so this is the server I'm using
the remote exploiting these days the

511
00:47:17,619 --> 00:47:24,960
compact smoke because it's the first one
so it's it's ok exploiting here he s so

512
00:47:24,960 --> 00:47:29,700
we found where the function is it's
these address always fixes and

513
00:47:29,700 --> 00:47:35,419
registered with we've launched the
server and now it knows that targeting

514
00:47:35,420 --> 00:47:40,299
she pointed at this address this is for
the brute forcing so it's Adam Buxton

515
00:47:40,299 --> 00:47:45,219
and now we have the clients here you
could do this in a single exploit I was

516
00:47:45,219 --> 00:47:50,880
just lazy and Cody the client and server
you can do this inside on the same just

517
00:47:50,880 --> 00:47:54,410
for can get a parent and a child and
sync between

518
00:47:55,630 --> 00:48:03,160
so we're on it trying trying and that's
it so you can see

519
00:48:04,180 --> 00:48:09,379
two attempts it didn't fail the
demagogues didn't fail me so it's ok now

520
00:48:09,380 --> 00:48:24,839
this cannot exploit the same because I'm
using the same

521
00:48:26,390 --> 00:48:30,640
mike boorda the same my part is just
neither different important the same

522
00:48:30,640 --> 00:48:34,529
server and that's it because if I tried
to register the same port lunch they

523
00:48:34,529 --> 00:48:45,769
will say okay there is already some 12
so this is Michelle I cannot

524
00:49:23,020 --> 00:49:35,230
and that's so

525
00:50:02,230 --> 00:50:29,000
because success we can load kernel
extensions without any problem instead

526
00:50:29,000 --> 00:50:34,900
of using the the demon we use the
program that that is used to load the

527
00:50:34,900 --> 00:50:41,140
kernel extension what do you do there is
a trick if you remove the communication

528
00:50:41,140 --> 00:50:45,520
with the demon what happens is that tax
laws will start talking to the kernel

529
00:50:45,520 --> 00:50:51,600
directly control the KX clothes and the
code scanners Scott signatures are still

530
00:50:51,600 --> 00:50:56,069
may be in use around with just control
the process we patched the right places

531
00:50:56,070 --> 00:51:09,980
and we can load any codes into the
kernel source code for the text you can

532
00:51:09,980 --> 00:51:16,510
see you free Patch year the condition it
will say I cannot talk to the demons so

533
00:51:16,510 --> 00:51:23,520
I will try to talk directly to the
kernel then you have here then signed

534
00:51:23,520 --> 00:51:29,960
check it will shake if you are trying to
to to load he signed was again you

535
00:51:29,960 --> 00:51:37,470
purchased one bite or two but it's okay
by press the condition and if if the

536
00:51:37,470 --> 00:51:43,770
court is not signed I will still 022
loads and continued stalling and get it

537
00:51:43,770 --> 00:51:49,150
you can load and signed called basically
it's cracking he explored patching the

538
00:51:49,150 --> 00:51:55,000
right places and that's it for this is
troubling news about from

539
00:51:56,250 --> 00:52:13,770
bug on s1 parser coaching nurtures in in
the kernel because there's a cost

540
00:52:13,770 --> 00:52:23,750
benefit same here I was saying these
last year and the year before you cannot

541
00:52:23,750 --> 00:52:28,940
sports called on rings you doing shacks
on ring ring three on the userland

542
00:52:28,940 --> 00:52:34,160
because there's always a way to control
the process or any any vulnerability in

543
00:52:34,160 --> 00:52:40,350
user land and the girls game over and if
you are it's game over for sure it

544
00:52:40,350 --> 00:52:46,549
doesn't make any sense otherwise for for
me and for me it's not sure whatever is

545
00:52:46,550 --> 00:52:56,380
this industry doing but whatever we can
it's for me I cannot imagine that we

546
00:52:56,380 --> 00:53:02,180
cannot build something secure and
Microsoft they do the right when you can

547
00:53:02,180 --> 00:53:06,419
take a chance with bugs but the thing is
once again a cost benefits relationship

548
00:53:06,420 --> 00:53:13,030
because if there's a bug in israel and I
can take control on the colonel he said

549
00:53:13,030 --> 00:53:18,820
there's a bug in the kernel I can you
can take control in the kernel refusing

550
00:53:18,820 --> 00:53:24,400
to these do is to do this the right way
I'm not sure what we are doing in this

551
00:53:24,400 --> 00:53:30,770
industry so we should start thinking
about this kind of things and do things

552
00:53:30,770 --> 00:53:34,780
the right way you don't need the full is
in one person in the kernel you don't

553
00:53:34,780 --> 00:53:39,370
see the full subset just a subset to
identify the kernel extension make make

554
00:53:39,370 --> 00:53:45,759
it smaller subset make something that
you can control 1-7

555
00:53:49,540 --> 00:54:01,660
these are very interesting form our what
you can do you bypass abd on a protected

556
00:54:01,660 --> 00:54:06,970
folder you restore sip condition and
then sleep will protect yourself you

557
00:54:06,970 --> 00:54:11,520
ever sit protection rackets because it
will not let the normal user clean up

558
00:54:11,520 --> 00:54:17,290
what the user needs to do the user needs
to do so the process

559
00:54:17,290 --> 00:54:22,950
recovery mode and it will open a shell
to disable this think the normal user

560
00:54:22,950 --> 00:54:28,810
that goes to Apple Genius knows how to
do this no other special Apple entitled

561
00:54:28,810 --> 00:54:34,390
half that for example if there's a warm
affecting everything they will need to

562
00:54:34,390 --> 00:54:39,330
to really something that is entitlements
the FBI would always say give me I would

563
00:54:39,330 --> 00:54:44,549
like to have that stuff because whatever
I want and then you have babies i wud

564
00:54:44,550 --> 00:54:50,610
V's clean up their their their customers
they will have to bypass sit so they've

565
00:54:50,610 --> 00:54:55,770
I tell roadside I'm not sure on Twitter
on a post least easy's tend to be a

566
00:54:55,770 --> 00:55:00,110
different kind of with because they will
need to behave like a rootkit protection

567
00:55:00,110 --> 00:55:05,050
clean-up we start the protection
solutions you can see that that

568
00:55:05,050 --> 00:55:10,080
gentleman would be if everything went as
normal they will be complaining for me

569
00:55:10,080 --> 00:55:18,790
to get out of the stage the the point of
this dark is not to say yes but they are

570
00:55:18,790 --> 00:55:20,630
also nice guys

571
00:55:20,630 --> 00:55:25,770
security systems is very difficult I can
tell you this because I am designing one

572
00:55:25,770 --> 00:55:36,110
and you have a lot of people complaining
and give it a try you'll see the demands

573
00:55:36,110 --> 00:55:40,570
of problems that you have it's very
difficult to solve them and then if you

574
00:55:40,570 --> 00:55:44,990
say solving them then you have customer
saying oh this doesn't work you need to

575
00:55:44,990 --> 00:55:50,890
disable these so it's very complicated
doesn't do everything right but they

576
00:55:50,890 --> 00:55:58,750
attempt and used the same that the
continuation design doesn't give you

577
00:55:58,750 --> 00:56:01,390
much we have I we have all heard about

578
00:56:01,390 --> 00:56:05,230
we have the brokers we can reverse
engineer it just buy it buys you some

579
00:56:05,230 --> 00:56:11,050
time so it's really a white paper with
your design goals you don't need to put

580
00:56:11,050 --> 00:56:18,010
the cold if you want I want to protect
these and isn't that and people first

581
00:56:18,010 --> 00:56:19,470
can understand what you want

582
00:56:19,470 --> 00:56:24,109
there will be no misunderstanding that's
it will be the best thing for the worst

583
00:56:24,110 --> 00:56:28,270
thing you can either send you can talk
to people or two other friends and

584
00:56:28,270 --> 00:56:35,380
saying okay you analyze these days but
there's the book there so we can have

585
00:56:35,380 --> 00:56:38,430
some interaction with the fender

586
00:56:38,430 --> 00:56:42,460
this stop stop stop stop stop stop

587
00:56:42,460 --> 00:56:50,660
that's the whole idea is for my site not
guilty

588
00:56:53,400 --> 00:56:59,670
now you have five minutes

589
00:57:01,930 --> 00:57:15,779
logic and race conditions are really
great bucks because they can leave for

590
00:57:15,780 --> 00:57:23,510
many many years you saw the presentation
on Sean poem about them and so on his

591
00:57:23,510 --> 00:57:29,630
stuff that requires thinking about the
models are creating great tools so we

592
00:57:29,630 --> 00:57:34,550
should start looking up this can of beer
is doing some work under isn't the

593
00:57:34,550 --> 00:57:39,460
reason most probably the reason why he
got the book collisions because I

594
00:57:39,460 --> 00:57:45,940
expected to leave for many years I was
throwing apples for many months is my

595
00:57:45,940 --> 00:57:50,490
plan was to release a video when the El
Capitan was going on because she seemed

596
00:57:50,490 --> 00:57:55,759
was released I could bypass it with this
is a reason why these books are really

597
00:57:55,760 --> 00:58:01,339
interesting You're radio batteries for
El Capitan and iOS because of this bug

598
00:58:01,339 --> 00:58:05,750
applies in iOS but I'm not sure you can
exploit it there because you need floor

599
00:58:05,750 --> 00:58:09,980
and allegedly or normal conditions you
cannot afford you don't have permission

600
00:58:09,980 --> 00:58:17,500
for that there are no patches for every
other version OS X is important if you

601
00:58:17,500 --> 00:58:21,569
are running one of those versions
hopefully against you that this work is

602
00:58:21,569 --> 00:58:27,150
really powerful and it will always work
I have no idea why this happens I had

603
00:58:27,150 --> 00:58:32,500
time yet to reverse the bug probably
they are using some future that all the

604
00:58:32,500 --> 00:58:42,490
russians don't have so great just never
forget that there's always the human

605
00:58:42,490 --> 00:58:48,339
element you can have every single the
firewalls encryption options and so on

606
00:58:48,339 --> 00:58:55,740
but human ever will always give you the
problems some failure he's where the

607
00:58:55,740 --> 00:59:03,020
witness if Thomas Jacob had the great
idea for all the pictures

608
00:59:03,710 --> 00:59:10,770
guys they are nice guys sometimes they
fail but they are still nice guys not

609
00:59:10,770 --> 00:59:12,730
for me I promise

610
00:59:12,730 --> 00:59:16,780
Jacob that I would use peter is pictures
of them forget to vote for me for the

611
00:59:16,780 --> 00:59:21,150
best presentation feel free to contact
me I will try to help you I'm not sure

612
00:59:21,150 --> 00:59:27,030
if I will exploit but if you want simple
goal just look at the NBA's by the

613
00:59:27,030 --> 00:59:35,170
publisher full cold and it's working so
it's ok well thank you

614
00:59:36,170 --> 00:59:42,270
questions how long he drank whiskey I
don't have some questions for him anyone

615
00:59:42,270 --> 00:59:58,600
frank says 5902 questions anyway she was
no one ok good yes why are you reporting

616
00:59:58,600 --> 01:00:05,720
your books to a good question why are
you reporting about snapple ok there's a

617
01:00:05,720 --> 01:00:12,390
story first I was throwing them for a
couple and I was planning to make a

618
01:00:12,390 --> 01:00:17,560
video making fun of them and then had a
very personal email from someone asking

619
01:00:17,560 --> 01:00:22,820
me please don't do that and they explain
me the reasons why there wasn't

620
01:00:22,820 --> 01:00:29,500
precondition which was if i bug that was
your day that made a lot of mass and I

621
01:00:29,500 --> 01:00:35,370
was reasonable k let's give it a try I
will show you that offer you money no

622
01:00:35,370 --> 01:00:36,730
sheepskin

623
01:00:36,730 --> 01:00:45,860
there so you are cheap yeah it by you
for lunch

624
01:00:45,860 --> 01:00:47,430
kidding me

625
01:00:47,430 --> 01:00:53,450
anyone will take one last question no I
thank you very much thank you

