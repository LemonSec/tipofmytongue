1
00:00:00,000 --> 00:00:04,870
all right thank you Thomas again
apologies for us growing up the scale of

2
00:00:04,870 --> 00:00:09,460
the conference I know how to say it was
a safe laptop but not how to get myself

3
00:00:09,460 --> 00:00:15,000
safely young so that's probably the next
lesson for me to learn so the topic

4
00:00:15,000 --> 00:00:20,210
today is a reasonably safe travel but a
laptop and the idea is basically you

5
00:00:20,210 --> 00:00:25,109
know you have all heard the stories
about laptops getting implants and so on

6
00:00:25,109 --> 00:00:28,230
so you want to have something that you
can trust it a bit when you're Trevor

7
00:00:28,230 --> 00:00:33,640
it's cheap enough to throw away after
your Trevor but you know sometimes you

8
00:00:33,640 --> 00:00:37,130
want to get something into a country
like a presentation or something or even

9
00:00:37,130 --> 00:00:41,090
more sensitive data and then you need a
solution to bring it to the country

10
00:00:41,090 --> 00:00:45,100
that's so that you know the people will
you bring it to a don't know everything

11
00:00:45,100 --> 00:00:50,110
about you left already read thomas
introduced me my name is Michele di work

12
00:00:50,110 --> 00:00:54,750
was crowd strike which is a small
American company focusing on threat

13
00:00:54,750 --> 00:01:00,690
intelligence and yes let's dive into the
talk show that side was a motivational

14
00:01:00,690 --> 00:01:03,968
bitter some some stories and so on

15
00:01:03,969 --> 00:01:08,600
stefan is see you talked yesterday and
some people might have seen less young

16
00:01:08,600 --> 00:01:13,658
to die he was posting pictures from his
laptop from his hotel room where they

17
00:01:13,659 --> 00:01:17,299
were screws missing and so on so
evidently if somebody was trying to do

18
00:01:17,299 --> 00:01:23,310
something to his laptop on it is hard to
rule but there's another story that I

19
00:01:23,310 --> 00:01:27,880
got towards recently there was kind of
funny couple of years ago somebody was

20
00:01:27,880 --> 00:01:32,479
going to enter into the united states
for attending the blackhat and DEFCON

21
00:01:32,479 --> 00:01:37,329
conferences and unfortunately entering
the country for him as he did not have

22
00:01:37,329 --> 00:01:40,429
the awesome German passport that makes
it very easy to install the country's

23
00:01:40,430 --> 00:01:46,119
was not the same as for him and he got
taken his laptop away for x-ray the

24
00:01:46,119 --> 00:01:51,329
laptop you know if you've already boy on
the plane and going into the country you

25
00:01:51,329 --> 00:01:54,919
think maybe my laptop is fine I know
they take it away for another three

26
00:01:54,920 --> 00:01:55,280
hours

27
00:01:55,280 --> 00:01:59,509
X-raying it right and then you can make
up their minds out why does it take

28
00:01:59,509 --> 00:02:03,579
three hours to X-ray laptop and so on
but your laptop is gone for three hours

29
00:02:03,579 --> 00:02:07,860
and you don't know what's happening to
it right so it's kind of the motivation

30
00:02:07,860 --> 00:02:10,020
and x-rayed shouldn't take three hours
probably

31
00:02:10,020 --> 00:02:13,330
have to X-ray lot of laptops and it's
it's an acute or maybe it's just not

32
00:02:13,330 --> 00:02:18,370
being x-rayed ride and then of course
the problem you probably need sex radio

33
00:02:18,370 --> 00:02:21,550
laptop yourself then because you don't
you want to see what happened to it

34
00:02:21,550 --> 00:02:29,330
except that it's probably cheaper to
just throw it away and of course you

35
00:02:29,330 --> 00:02:34,760
know with all the snow to revelations
many people saw this sorry if anybody

36
00:02:34,760 --> 00:02:39,200
was jus clearance I'm sorry that I'm
showing of these sluts you can go on now

37
00:02:39,200 --> 00:02:45,959
so there were these these yeah catalogue
published catalogue which is their

38
00:02:45,960 --> 00:02:50,900
internal product portfolio the implants
that they offer ends on and what do you

39
00:02:50,900 --> 00:02:55,330
see you know said two implants they
offer for putting it onto laptop says

40
00:02:55,330 --> 00:03:02,820
software which is basically just MBR
modification that allows staging

41
00:03:02,820 --> 00:03:07,920
secondary payloads like you know trojan
or whatever from the ambiance even if

42
00:03:07,920 --> 00:03:12,030
you clean it from operating system in
the AM God and in case you know

43
00:03:12,030 --> 00:03:16,180
antivirus and you have an antivirus it
even sex and clean Cmdr

44
00:03:16,180 --> 00:03:21,910
they even went a step further and say
what you fight your system hot disk

45
00:03:21,910 --> 00:03:26,609
firmware so that it only presents an
infected MBI during the boot phase and

46
00:03:26,610 --> 00:03:31,120
after that the hard drive pretends to
have a clean MVR from their own so it's

47
00:03:31,120 --> 00:03:35,930
even more hot to clean your laptop and
of course these things are something

48
00:03:35,930 --> 00:03:39,820
that could be installed by remote
software expectation but if somebody's

49
00:03:39,820 --> 00:03:43,829
coming into the country for blackhat
anyway it's much much easier to just you

50
00:03:43,830 --> 00:03:48,390
know X-rated slept for three hours and
take this time to reflect the hard drive

51
00:03:48,390 --> 00:03:52,579
firmware and get access to the dead at
this way and the big drawback of courses

52
00:03:52,580 --> 00:03:55,330
even if you have full disk encryption
you're going to unlock your hard to get

53
00:03:55,330 --> 00:03:58,700
some point and they don't need an unlock
taught us to deploy this because I just

54
00:03:58,700 --> 00:04:03,280
flashing the firmware so what they can
basically do as you left us locked an

55
00:04:03,280 --> 00:04:07,550
encrypted they at this implant and then
they just wait for you to unlock your

56
00:04:07,550 --> 00:04:11,430
laptop yourself and then they don't even
need to know your past frozen I mean

57
00:04:11,430 --> 00:04:14,739
probably they would still recorded but
they get access to the unencrypted data

58
00:04:14,739 --> 00:04:16,519
because you unencrypted for them

59
00:04:16,519 --> 00:04:21,039
so this is of course only the American
example I don't wanna bet on the

60
00:04:21,039 --> 00:04:25,659
Americans pretty sure that other
countries do it this a record actually

61
00:04:25,659 --> 00:04:29,909
of Germany doing this at the border and
customs and there was a public place

62
00:04:29,909 --> 00:04:34,389
about this when they did it for criminal
investigation into drug trafficking

63
00:04:34,389 --> 00:04:38,970
where they actually implanted with a
soft implant only a laptop of a drug

64
00:04:38,970 --> 00:04:44,530
trafficker at the customs at the border
entering germany and those are only the

65
00:04:44,530 --> 00:04:49,318
Germans and Americans now but I'm sure
that you know other countries have these

66
00:04:49,319 --> 00:04:52,590
capabilities as well induces
capabilities because if somebody enters

67
00:04:52,590 --> 00:04:56,270
the country it's very very convenient
because people are used to the house and

68
00:04:56,270 --> 00:04:56,849
so on

69
00:04:56,849 --> 00:05:00,969
is much less convenient to enter a hotel
room but if that needs to be done is of

70
00:05:00,970 --> 00:05:04,599
course still not a big hit for them
right especially for people like us

71
00:05:04,599 --> 00:05:09,280
knows we're not gonna even if you see
somebody in or not you know beat them up

72
00:05:09,280 --> 00:05:09,880
right

73
00:05:09,880 --> 00:05:17,560
ok there is some existing solutions
insecure ecosystems are ready for secure

74
00:05:17,560 --> 00:05:21,780
boozing and trusted led laptops Russa
platforms and so on and so on the most

75
00:05:21,780 --> 00:05:26,489
famous one US Office of course I West
which you know has a very high bar for

76
00:05:26,490 --> 00:05:29,460
jailbreaking these days there are
millions of dollars being paid to

77
00:05:29,460 --> 00:05:34,620
getting to see no code execution and
rebook assistance but I S is not very

78
00:05:34,620 --> 00:05:39,360
you know productive operating system
right you cannot do much on an iPhone or

79
00:05:39,360 --> 00:05:46,219
iPad the other one that's really really
nice is chrome last from from Google

80
00:05:46,219 --> 00:05:52,029
also have a pretty tight which train and
platform integrity measures but the is

81
00:05:52,029 --> 00:05:56,860
the same problem again you have you end
up with a Chrome OS browser basically

82
00:05:56,860 --> 00:06:00,210
and then you can use everything from the
Google cloud which means you know you

83
00:06:00,210 --> 00:06:03,250
have to trust Google and you need to
have internet access to the Google cloud

84
00:06:03,250 --> 00:06:07,830
in the country that jane and so on which
is not very useful again but I mean they

85
00:06:07,830 --> 00:06:11,979
are the solution said that are out there
and then of course there's UEFI secure

86
00:06:11,979 --> 00:06:17,729
boot which applies to Windows but there
have been so many were available 'tis

87
00:06:17,729 --> 00:06:21,568
and you you that it's not very
trustworthy for your platform integrity

88
00:06:21,569 --> 00:06:23,610
right I think every conference and

89
00:06:23,610 --> 00:06:27,659
or every major conference in the last
two years headed talk like owning you if

90
00:06:27,659 --> 00:06:33,310
I getting code execution in essence as a
member through a box and so on so that's

91
00:06:33,310 --> 00:06:38,909
a very trustworthy and some obscure
inter technologies like interviewed

92
00:06:38,909 --> 00:06:43,909
guidance on that are interesting because
they offer you interesting possibilities

93
00:06:43,909 --> 00:06:50,000
for securing your from recent vectors of
from stage 0 of laptop code execution up

94
00:06:50,000 --> 00:06:54,009
to operating system but the problem
there is no need to be a big UEM

95
00:06:54,009 --> 00:06:59,419
manufacturer to get access to these
technologies and into one you know let

96
00:06:59,419 --> 00:07:03,029
me talk to them said ik I want to secure
my own laptop how can I use its

97
00:07:03,029 --> 00:07:08,930
technology for that and also most of
these things are under NDA was OEM

98
00:07:08,930 --> 00:07:14,159
Samsung because they want to protect
their intellectual property so what what

99
00:07:14,159 --> 00:07:17,319
is it that I wanted to do right I wanted
to have something that is open source

100
00:07:17,319 --> 00:07:22,379
because at least its hypothetically
auditable we have seen with OpenSSL that

101
00:07:22,379 --> 00:07:25,580
open source doesn't actually mean that
anybody looks at the source code but you

102
00:07:25,580 --> 00:07:30,620
could we still want something that the
ship to throw away they have been this

103
00:07:30,620 --> 00:07:34,560
liberal laptops from pure -ism that got
some publicity they're actually its

104
00:07:34,560 --> 00:07:39,419
marketing hype they're not actually that
free as free in in blood free no binary

105
00:07:39,419 --> 00:07:43,830
code is still a lot of stuff for drivers
who need binary blocks but also the over

106
00:07:43,830 --> 00:07:49,169
$1000 and might might go but I want to
stay under $300 because that's my

107
00:07:49,169 --> 00:07:54,628
personal mark when I say I can still
throw it away after a trip if I suspect

108
00:07:54,629 --> 00:07:59,860
some compromise I mean in some companies
to c-level executives negative shiny new

109
00:07:59,860 --> 00:08:03,629
MacBook for every trip but I'm not a
c-level executives so nobody pays that

110
00:08:03,629 --> 00:08:04,620
for me

111
00:08:04,620 --> 00:08:09,820
and the ghost also be assembled
diversified echo system and what I mean

112
00:08:09,820 --> 00:08:13,150
by this is not everybody has the same
security level empty of everybody

113
00:08:13,150 --> 00:08:18,948
business owned it slightly different but
that makes it much harder want to

114
00:08:18,949 --> 00:08:22,169
actually attack this this class of
travel up to us because of the oldest

115
00:08:22,169 --> 00:08:26,820
aimed you have one solution that fits
all everybody both the same even maybe

116
00:08:26,820 --> 00:08:30,729
next one or two mistakes it's actually
good because then everyone has a unique

117
00:08:30,729 --> 00:08:36,549
snowflake so to say which is a little
bit harder to it and then again since is

118
00:08:36,549 --> 00:08:39,588
open source and this goes in the same
direction you can add your own unique

119
00:08:39,589 --> 00:08:43,839
personalized element so you can actually
see this is my travel laptop on not one

120
00:08:43,839 --> 00:08:48,150
of the same laptops was a different
firmware or something but somebody swap

121
00:08:48,150 --> 00:08:52,279
the laptop from you right so that's
that's the general idea and the

122
00:08:52,279 --> 00:08:58,640
motivation so let's talk about how I
approach this problem and the husband

123
00:08:58,640 --> 00:09:05,319
imitations and so on the basic things
that you have to decide when you when

124
00:09:05,320 --> 00:09:09,360
you build something like this is where
is the root of my chain of trust ride at

125
00:09:09,360 --> 00:09:12,790
some point you have to make some
assumptions writes for example this is

126
00:09:12,790 --> 00:09:16,760
actually the same physical laptop at
abroad and not something entirely

127
00:09:16,760 --> 00:09:20,420
different that only looks the same right
you have to have some kind of threat

128
00:09:20,420 --> 00:09:24,790
months and for me I decided for this
project the root of the chain of trust

129
00:09:24,790 --> 00:09:29,969
will be the SPI flash in there so
there's a little flesh is also known as

130
00:09:29,970 --> 00:09:33,529
a wrong when there's a lot and some
different names for it which basically

131
00:09:33,529 --> 00:09:40,320
contention bias and song rights which is
not join you on your hard disk its own

132
00:09:40,320 --> 00:09:44,839
flesh so you could still replaces first
trip for example you can do so literate

133
00:09:44,839 --> 00:09:50,160
and solar in another chip but that's a
little bit more work and more customers

134
00:09:50,160 --> 00:09:53,910
than you know just flashing a new phone
what was in the plans

135
00:09:53,910 --> 00:09:58,770
and so that's going to be in in this
talk deadwood off the chain of trust and

136
00:09:58,770 --> 00:10:03,660
on the CSPI flesh there will be equal
boot which is an open-source by US I'm

137
00:10:03,660 --> 00:10:09,790
gonna go into this as well as corrupt to
linux bootloader which additionally has

138
00:10:09,790 --> 00:10:14,800
modules for full disk encryption and key
verification of everything that comes

139
00:10:14,800 --> 00:10:19,300
from there and then the second stage is
as a classical booting set up on your

140
00:10:19,300 --> 00:10:24,010
SST or hot ride because of course you
want to be able to you know updates if

141
00:10:24,010 --> 00:10:28,990
you want to be able to change something
in the operating system but because we

142
00:10:28,990 --> 00:10:34,210
have the bootloader actually in the SPI
flash itself so grab lives on the

143
00:10:34,210 --> 00:10:39,080
firmware flash the bios lives you can
actually have full disk encryption off

144
00:10:39,080 --> 00:10:43,530
the entire heart disease including the
boot partition if you want and then the

145
00:10:43,530 --> 00:10:46,530
other thing is that the BIOS

146
00:10:47,240 --> 00:10:52,090
guy flesh concerns your own signing key
already know everything that's loaded

147
00:10:52,090 --> 00:10:58,050
from your hard disk is actually are say
signs including your current including

148
00:10:58,050 --> 00:11:01,990
you in a trauma as a content smudges and
so on so you have basically code signing

149
00:11:01,990 --> 00:11:07,270
for the first stages from your life
which is you know usually the approach

150
00:11:07,270 --> 00:11:11,470
for landing in implants to your laptop
is remove the hard drive

151
00:11:11,470 --> 00:11:14,770
reflects the firmware on the hard drive
which is mount the hard drive and at a

152
00:11:14,770 --> 00:11:18,520
dance off then plant this way but
everything on the hard drive is being

153
00:11:18,520 --> 00:11:21,980
sign and see this image as ever if I see
if they're actually

154
00:11:21,980 --> 00:11:28,940
I want to take this approach then they
have to reflash the rom chip on your

155
00:11:28,940 --> 00:11:34,290
main boards which is you know a little
bit more cumbersome right of course they

156
00:11:34,290 --> 00:11:39,329
could still do with us and this is why
you can do if you want some hardware

157
00:11:39,330 --> 00:11:46,230
modifications even to your chip PC chip
to have right protection but the right

158
00:11:46,230 --> 00:11:50,590
protection can be lifted again if you
attach to it was actual physical

159
00:11:50,590 --> 00:11:54,880
violence because there's a pin that is
called right protected to say and if you

160
00:11:54,880 --> 00:11:59,140
raise that right protect into a
physicist with input voltage than

161
00:11:59,140 --> 00:12:03,490
actually even if you said right
protection nonvolatile right protection

162
00:12:03,490 --> 00:12:07,750
you can still remove that again and
that's basically so people don't you

163
00:12:07,750 --> 00:12:10,920
know we have to throw away the flesh
even if they said right protection at

164
00:12:10,920 --> 00:12:16,270
some point you can still physically
repair it does to a simple solutions to

165
00:12:16,270 --> 00:12:19,970
make it to reread only ship of the first
one is set the right protection and then

166
00:12:19,970 --> 00:12:24,990
covered in loads of epoxy than they
actually have to you know remove the

167
00:12:24,990 --> 00:12:29,460
proxy which would probably destroy your
main board and the other one is that

168
00:12:29,460 --> 00:12:33,730
actual you can physically removed the
right protect pin because on the main

169
00:12:33,730 --> 00:12:38,320
Bazar looked at I borrowed a logic
analyzer that is never used during on

170
00:12:38,320 --> 00:12:43,070
the boot its will would only be used by
an attacker trying to make your pledge

171
00:12:43,070 --> 00:12:47,940
to provide again so if you have like a
small milling tool you can cut off the

172
00:12:47,940 --> 00:12:53,710
spin and military way and then you get a
very real readonly chip or you can

173
00:12:53,710 --> 00:12:58,450
actually go to this less room and SPI
flash manufacturing states cell also

174
00:12:58,450 --> 00:13:03,980
chips that I really read only from some
point on but those are much much more

175
00:13:03,980 --> 00:13:09,250
expensive if you buy this flash chips
and maybe five to ten cents apiece and

176
00:13:09,250 --> 00:13:13,100
the real the ones that you can make
really read only in bulk they started to

177
00:13:13,100 --> 00:13:18,270
$3 and if you actually buy a singer when
you gonna pay $20 or more so it's much

178
00:13:18,270 --> 00:13:23,069
cheaper to actually just you know
removed at Singapore and then you

179
00:13:23,070 --> 00:13:26,760
actually have a read only chain of trust
that's the point here I'd even if they

180
00:13:26,760 --> 00:13:30,850
come with external hardware flasher
screw up your laptop and try to flash

181
00:13:30,850 --> 00:13:32,320
Thursday they cannot flash it

182
00:13:32,320 --> 00:13:37,060
of course that candy solder it and
replace it with another flash chip and

183
00:13:37,060 --> 00:13:41,540
then at the stuff on the new flagship
but this is something that you cannot do

184
00:13:41,540 --> 00:13:44,870
in three hours anymore this is something
because we're talking about unique

185
00:13:44,870 --> 00:13:48,340
snowflakes yet so to say this is an
approach for them they would take them

186
00:13:48,340 --> 00:13:51,590
including reverse engineering of your
phone when its on the script take them a

187
00:13:51,590 --> 00:13:56,400
gift for five days somebody takes a
laptop a way for 45 days you know before

188
00:13:56,400 --> 00:14:01,310
the way so it makes it more detectable
rights and of course you can do a

189
00:14:01,310 --> 00:14:04,599
designer stuff like putting nail polish
on screws and so on and so on so you can

190
00:14:04,600 --> 00:14:11,880
actually see if they open so the target
hardware that I am targeting as I said

191
00:14:11,880 --> 00:14:15,630
it should be cheap and I don't want you
know make commercials for any specific

192
00:14:15,630 --> 00:14:21,120
vendor but I chose to use the Asus Eee
on the 720 and see 740 I have one of

193
00:14:21,120 --> 00:14:28,980
these year they you can buy them used on
eBay in Germany 400 USDollar and if you

194
00:14:28,980 --> 00:14:32,750
buy them you then you get them for $250
the great thing about chrome works

195
00:14:32,750 --> 00:14:36,590
basically as he gets so many of them in
great condition on eBay because there's

196
00:14:36,590 --> 00:14:39,750
so many people selling them on ebay like
oh I bought this one and then I start

197
00:14:39,750 --> 00:14:43,770
doesn't have windows so you can get them
in great condition because they turn

198
00:14:43,770 --> 00:14:48,310
them on and see all the spaces chrome
something bullshit and then they sell

199
00:14:48,310 --> 00:14:53,339
them on eBay so you can get them
relatively cheap and the same thing if

200
00:14:53,340 --> 00:14:56,520
you buy them off ebay from a private
person

201
00:14:56,520 --> 00:15:01,880
some people may have seen the us-
intelligence community supply chain

202
00:15:01,880 --> 00:15:06,590
interdiction right so if you buy a
Macbook from Apple and it gets shipped

203
00:15:06,590 --> 00:15:10,970
to you they actually you know tap into
this purchasing process and interdict

204
00:15:10,970 --> 00:15:14,240
the shipment to you so they will
actually get the laptop before they

205
00:15:14,240 --> 00:15:18,810
arrive at your home for the first place
if you buy something off ebay very you

206
00:15:18,810 --> 00:15:22,680
know less likely that they will
interdict disciplined from eBay and also

207
00:15:22,680 --> 00:15:27,349
you know a person and as a twenty-two
ship it and so on so it's you know much

208
00:15:27,350 --> 00:15:28,570
more custom again

209
00:15:28,570 --> 00:15:34,650
so these laptops cell not really great
to have two gigabytes of RAM you can get

210
00:15:34,650 --> 00:15:40,030
for gigabyte miles in the ass but I
don't live in dus and the Rams sold it

211
00:15:40,030 --> 00:15:44,560
to them both so it's not easy to upgrade
and they have crappy CPUs as well

212
00:15:44,560 --> 00:15:51,780
seller on ebay superiors they have i
three models in the USA again but it

213
00:15:51,780 --> 00:15:57,230
said that doesn't actually work really
well on the ivory based models and the

214
00:15:57,230 --> 00:16:01,400
big disadvantage SIA said the Celeron
stay don't have the AES hardware

215
00:16:01,400 --> 00:16:07,480
extensions actually fullest encryption
is not too slow but it's a bigger drain

216
00:16:07,480 --> 00:16:11,130
on you better read and if you have had
to support at least they come with

217
00:16:11,130 --> 00:16:16,210
normal m2 SSDs are easy to upgrade so if
you're not happy with the 16 or 32

218
00:16:16,210 --> 00:16:21,040
gigabyte of storage getting one of these
are compatible

219
00:16:21,040 --> 00:16:25,370
28 gigabyte SSD is only like twenty
thirty dollars so that's easy to upgrade

220
00:16:25,370 --> 00:16:30,480
and yeah as I said their religion they
also don't have the greatest feeling so

221
00:16:30,480 --> 00:16:33,740
they don't compare to like I think that
for example in terms of feelings all

222
00:16:33,740 --> 00:16:40,300
plastic and so on but it's it's good
enough and lightweight and slim and yeah

223
00:16:40,300 --> 00:16:45,189
this is the main body of the sea 726
agency it's a small man but actually

224
00:16:45,190 --> 00:16:49,190
it's one system on a chip and it's
mostly about sorry there and then of

225
00:16:49,190 --> 00:16:54,570
course you have fear the flashed right
so this is actually here is the flash

226
00:16:54,570 --> 00:17:01,120
too and this is what you would see clip
onto as an external attacker was right

227
00:17:01,120 --> 00:17:05,250
and I believe this is the right
protected if I'm not mistaken was the

228
00:17:05,250 --> 00:17:09,180
orientation of the trip right now so
this is what you could then remove

229
00:17:09,180 --> 00:17:14,240
physically which I didn't obviously in
this case to make it impossible even

230
00:17:14,240 --> 00:17:17,720
with an external flash programmer to
attach to the strip but as you can see

231
00:17:17,720 --> 00:17:21,850
it's a tiny chip so you need to have a
specialized clip to attach to it or

232
00:17:21,849 --> 00:17:24,250
spend more time solving problems wit and
so on

233
00:17:24,250 --> 00:17:30,850
not that quickly to do maybe not include
hours and the 740 looks pretty much the

234
00:17:30,850 --> 00:17:35,250
same day as very few differences they
basically took the same design upgraded

235
00:17:35,250 --> 00:17:39,059
the process and just make sure it works
with the same process so

236
00:17:39,059 --> 00:17:45,009
also the flagship pretty much looks the
same and this is also what you will

237
00:17:45,009 --> 00:17:52,200
reprogram was your own forward to make
the cellebrite ok so I stopped in terms

238
00:17:52,200 --> 00:17:56,289
of hardware that you need you need an
external SPI flash because you can

239
00:17:56,289 --> 00:18:00,610
reflash your firmware from inside the
operating system for Chromebooks if you

240
00:18:00,610 --> 00:18:05,889
remove a special screw but you can do
this exactly once right and if you if

241
00:18:05,889 --> 00:18:09,519
you screw that up and you cannot get a
second try because it cannot boot into

242
00:18:09,519 --> 00:18:14,269
the operating system to get a second
attempt I started was next to Ernest Bai

243
00:18:14,269 --> 00:18:22,360
flesh was a bus Pirates which is a very
widely available but it takes more than

244
00:18:22,360 --> 00:18:26,889
30 minutes to do one read read read
cycle for verification of the whole

245
00:18:26,889 --> 00:18:31,979
flesh and the main limitation of the bus
powered is headed basically goes over

246
00:18:31,980 --> 00:18:36,590
Syria it right it has a USB serial
mutilation and that's very very slow

247
00:18:36,590 --> 00:18:41,080
nasa but on the SPI protocol that is
used to speak to the chip can actually

248
00:18:41,080 --> 00:18:47,350
be serious book at a much much higher
frequency so I went looking around and I

249
00:18:47,350 --> 00:18:54,340
found this from Adafruit SFT the I
shipwreck aboard the aft 232 age which

250
00:18:54,340 --> 00:19:00,389
is very awesome tool it's only 15 euro
and you can speak UART SPI i2c and so on

251
00:19:00,389 --> 00:19:06,158
all over USB at high frequencies and
this is the grades high-speed

252
00:19:06,159 --> 00:19:10,539
programmable flash so it takes two
minutes now to do one full read cycle

253
00:19:10,539 --> 00:19:14,299
ride cycle and earlier each cycle to do
verification so very quick to to

254
00:19:14,299 --> 00:19:20,450
reprogram then I went to Aliexpress and
got 46 euro you can get these clips

255
00:19:20,450 --> 00:19:26,009
actually to clip onto the chip and you
don't have to solder anything at all you

256
00:19:26,009 --> 00:19:28,280
know attaching whilst

257
00:19:28,280 --> 00:19:31,870
if you actually have to do a lot of
fleshing I recommend getting one of

258
00:19:31,870 --> 00:19:36,899
these like more expensive pulmonic lives
about $30 because they last much longer

259
00:19:36,900 --> 00:19:41,460
Daily Express one day but like after
twenty fleshing attempts are simple 23

260
00:19:41,460 --> 00:19:46,130
attachments the springs weren't that
tired anymore and so on so I got the new

261
00:19:46,130 --> 00:19:47,680
one and then your needs

262
00:19:47,680 --> 00:19:53,280
just some arbitrary 3.3 world power
supply that you can use to power on the

263
00:19:53,280 --> 00:19:57,470
flagship only if you have to remove
their laptop power battery because

264
00:19:57,470 --> 00:20:01,260
otherwise the embedded control of the
laptop will be powered on and so on and

265
00:20:01,260 --> 00:20:05,550
you will be fighting over the SPI bus so
it's a lot easier to to external power

266
00:20:05,550 --> 00:20:10,210
supply and therefore your reference if
you get this Legislature deaths of flesh

267
00:20:10,210 --> 00:20:14,430
from commanded you can actually use with
this specific breakout boards to flat

268
00:20:14,430 --> 00:20:22,610
too bright and this is this is basically
my setup looked I I really don't like

269
00:20:22,610 --> 00:20:26,290
touching hardware and software guy right
and I'm afraid of soldiering I'm afraid

270
00:20:26,290 --> 00:20:31,220
of breaking stuff and it doesn't have to
be beautiful what I'm trying to say is

271
00:20:31,220 --> 00:20:35,610
anybody can do this right just some
jumper wires that you put on the clip

272
00:20:35,610 --> 00:20:42,199
and so on and some connections and it's
it's not hard right I started this I was

273
00:20:42,200 --> 00:20:46,750
like oh and BIOS programming the songs
are very difficult but really isn't

274
00:20:46,750 --> 00:20:51,420
difficult that's like the coupon of this
talk and anybody so to say can do this

275
00:20:51,420 --> 00:20:56,470
and what iPhone even more impressive
when I started talking to cope with

276
00:20:56,470 --> 00:20:59,990
developers how do you do debugging right
because it's not like you can print on

277
00:20:59,990 --> 00:21:04,190
the screen the bias runs before the i
mean before even the memory of the

278
00:21:04,190 --> 00:21:08,060
system is initialized you don't have a
random access memory don't have to

279
00:21:08,060 --> 00:21:08,940
scream and so on

280
00:21:08,940 --> 00:21:12,630
it turns out actually on the stroke of
luck some of the corporate developments

281
00:21:12,630 --> 00:21:18,440
was looking exactly the strip family for
doing the debugging over you are of

282
00:21:18,440 --> 00:21:20,480
Assyria over USB

283
00:21:20,480 --> 00:21:25,380
it's insane so basically the court would
bias scored it contains the USB host

284
00:21:25,380 --> 00:21:31,130
driver for the specific chipset that
will then speak serial on the undersea

285
00:21:31,130 --> 00:21:35,690
report off of the spread on board and
you have to imagine this right this is

286
00:21:35,690 --> 00:21:39,030
before the memories initialize bizarre
before your laptop actually

287
00:21:39,030 --> 00:21:43,350
memory they already speak USB and you
can get a cereal output from from core

288
00:21:43,350 --> 00:21:46,919
board which is kind of impressive and
very very useful of course for debugging

289
00:21:46,920 --> 00:21:55,210
played in this works over the so-called
EHCI debug port so that each laptop yes

290
00:21:55,210 --> 00:22:00,170
the iPod USB bus host controller there's
one specific part that is designated to

291
00:22:00,170 --> 00:22:07,260
debug port and this specific parts can
be programmed only without interrupts

292
00:22:07,260 --> 00:22:09,110
and so on only was part I L

293
00:22:09,110 --> 00:22:13,110
so this is a much easier to you don't
have to do alike have a memory and so on

294
00:22:13,110 --> 00:22:17,080
you just send by store supports and so
on and this can then be used on the

295
00:22:17,080 --> 00:22:20,850
specific USB port and there's actually
one dedicated physical product you have

296
00:22:20,850 --> 00:22:24,350
to find out which one documented here
for the Chromebooks one which one it is

297
00:22:24,350 --> 00:22:30,740
that you can only use this you know low
no more on there and then you can build

298
00:22:30,740 --> 00:22:34,420
was another generic you are to USB
converter you can kind of build a new

299
00:22:34,420 --> 00:22:39,480
modem cable serial cable over USB
between the two laptops and this is

300
00:22:39,480 --> 00:22:44,060
actually how I did debugging again for
us friends later on the commands and

301
00:22:44,060 --> 00:22:49,159
information that you need for the
potency in the slides so actual

302
00:22:49,160 --> 00:22:52,960
implementation I mean this was kind of
the high-level roadmap uses as I said

303
00:22:52,960 --> 00:23:01,070
let's see about some of the details and
as I said is is an open source bias

304
00:23:01,070 --> 00:23:06,330
right so what I've been doing is using
upstream just head or even more bleeding

305
00:23:06,330 --> 00:23:10,929
at harrods review branches so actually
if you normally think about you know

306
00:23:10,930 --> 00:23:14,870
developments it had as kind of like the
bleeding as the latest commit but could

307
00:23:14,870 --> 00:23:19,179
there actually very very structured they
have a lot of reviews if you supply a

308
00:23:19,180 --> 00:23:23,150
pageant will be reviewed and so on and
that's basically ensures that the jet

309
00:23:23,150 --> 00:23:26,660
had as always valid bills and it
actually runs on all the laptop said

310
00:23:26,660 --> 00:23:30,790
they supported the bill testing before
allowing any committed to mass sensor

311
00:23:30,790 --> 00:23:36,550
but just to get really bleeding US Code
and I should say there's four or five of

312
00:23:36,550 --> 00:23:40,680
the quad core developers are actually
germans so they're very pedantic about

313
00:23:40,680 --> 00:23:42,090
the source code and

314
00:23:42,090 --> 00:23:45,490
and so on it actually very difficult to
contribute something upstream but you

315
00:23:45,490 --> 00:23:51,620
have a very clean it musta had this way
and what I basically did is if you

316
00:23:51,620 --> 00:23:57,969
retard from original club or chrome bulk
SMS because I should have said this

317
00:23:57,970 --> 00:24:01,429
earlier Chromebooks they run Corbett in
production right if you buy a Chromebook

318
00:24:01,429 --> 00:24:06,039
Chromebook off the shelf they would have
called on that so the Google firma team

319
00:24:06,039 --> 00:24:11,029
actually the other way round 245 cork
wrobel developers have all been hired by

320
00:24:11,029 --> 00:24:15,570
Google into the Google former team and
now Google basically uses quoted in

321
00:24:15,570 --> 00:24:21,080
production so all the Chromebook state
using open source by us with you know

322
00:24:21,080 --> 00:24:25,350
the caveat that Google open source is
always really obvious sources EPA

323
00:24:25,350 --> 00:24:28,490
compliant at some point you can get the
source code but it's not like they

324
00:24:28,490 --> 00:24:33,610
actually contribute to the corporate
upstream but still it's called on that

325
00:24:33,610 --> 00:24:39,649
and this means because quotes can store
the conflagration in the flesh that it

326
00:24:39,649 --> 00:24:43,309
was built with you can also go to your
actual measurement and extract the

327
00:24:43,309 --> 00:24:47,520
conflagration from it again to see what
options do I need to enable in in the

328
00:24:47,520 --> 00:24:53,240
cupboard bid process to get exactly the
same flesh the famous we don't want

329
00:24:53,240 --> 00:24:57,860
actually exactly the same flash image
because we don't want kids if you boot

330
00:24:57,860 --> 00:25:03,240
the Chrome OS boot loader we all other
one used up to and so on so you can

331
00:25:03,240 --> 00:25:09,140
adjust the configuration for your
purposes a bit as a separate references

332
00:25:09,140 --> 00:25:13,760
all these commands in here again
basically what we want is four megabytes

333
00:25:13,760 --> 00:25:18,570
of this aid megabyte flesh we want to
remove the reserve for our own corporate

334
00:25:18,570 --> 00:25:23,899
parts and for a large grub2 image that
all goes into the flesh and of course

335
00:25:23,899 --> 00:25:28,110
remove all the chroma specifics from the
configuration right and then you can

336
00:25:28,110 --> 00:25:31,830
book or boots it's literally like this
make many conflicts like building a

337
00:25:31,830 --> 00:25:36,529
Linux kernel of Benelux gonna before
this looks very familiar the type make

338
00:25:36,529 --> 00:25:42,870
and even on the JIT upstream master
heads you get you know nice flash image

339
00:25:42,870 --> 00:25:45,919
that you can actually flesh so this is

340
00:25:45,920 --> 00:25:49,960
about let's say three hours of work
downloading the dude from core board

341
00:25:49,960 --> 00:25:53,440
reading some documentation in building
your own corporate it's all very

342
00:25:53,440 --> 00:25:58,270
feasible to Apple and then Corbett has
this amazing future where you gonna give

343
00:25:58,270 --> 00:26:02,889
it a payload right because normally a
BIOS does two things that does the hot

344
00:26:02,890 --> 00:26:07,040
bear communication is so he's Asian and
it provides the bio services which is in

345
00:26:07,040 --> 00:26:11,350
modern-day said CUFI services and also
daily was called the BIOS interrupts

346
00:26:11,350 --> 00:26:14,870
that you may be still no you know you
can use interrupt excerpt team to

347
00:26:14,870 --> 00:26:20,510
display something on the screen and so
on and cobalt is only the first part

348
00:26:20,510 --> 00:26:25,100
quote what does happen insulation it
does not provide by a service so if you

349
00:26:25,100 --> 00:26:29,780
want by our services you have to come
see BIOS for example that you may also

350
00:26:29,780 --> 00:26:34,520
new from QMI UNC on C biases by
assimilation for the virtual machines

351
00:26:34,520 --> 00:26:38,260
but you can actually run see bias on
real hardware in combination was

352
00:26:38,260 --> 00:26:43,080
crippled ass well in this case however
we don't need anybody simulation at all

353
00:26:43,080 --> 00:26:46,610
because we want to be booting on a
secure Linux we don't need a noble

354
00:26:46,610 --> 00:26:51,570
services for this at all he just uses up
to as payloads aboard and then you can

355
00:26:51,570 --> 00:26:58,560
actually build crept into the BIOS flash
and then again in grub2 using upstream

356
00:26:58,560 --> 00:27:02,590
just head again same policy applies to
jet had always business leading edge and

357
00:27:02,590 --> 00:27:03,090
so on

358
00:27:03,090 --> 00:27:07,320
you invoke configure and telling it like
auto platform is not actually like

359
00:27:07,320 --> 00:27:12,030
normal PC bootloader our target platform
is scope would then you can nicely

360
00:27:12,030 --> 00:27:16,970
embedded and used like 10 command
Krupnick stand-alone to create like a

361
00:27:16,970 --> 00:27:21,350
stand-alone rub and so on and what you
stand alone grabbed his first

362
00:27:21,350 --> 00:27:27,449
configuration a gravity FG configuration
nomogram configuration that will be

363
00:27:27,450 --> 00:27:31,210
embedded into the flesh as well right
and the other thing that you added to

364
00:27:31,210 --> 00:27:35,940
the the grub flesh images on assigning
so you can actually create a publicly

365
00:27:35,940 --> 00:27:42,140
the world for our say was a group eg
tools and expert publicly off this and

366
00:27:42,140 --> 00:27:46,540
AM baghdad to grab and Emma debt into
your flesh so you don't have to do any

367
00:27:46,540 --> 00:27:52,600
is a Terry Kopassus X 509 or whatever
stuff can actually used us use GPG to

368
00:27:52,600 --> 00:27:55,219
sign your images is very convenient

369
00:27:55,220 --> 00:27:59,610
in very approachable for everybody and
then you don't need to even be clever

370
00:27:59,610 --> 00:28:03,959
ball what crap modules include and don't
include in your grab image because you

371
00:28:03,960 --> 00:28:07,890
have so much space four megabytes and
the whole drug thing will be as Adam a

372
00:28:07,890 --> 00:28:12,130
compressed so you can actually build
like take the full group was all the

373
00:28:12,130 --> 00:28:18,610
future if you want and put that into
your flesh and then you can have a grip

374
00:28:18,610 --> 00:28:23,270
safety in the flesh image was called a
super user configuration for the grub

375
00:28:23,270 --> 00:28:27,270
safety first of course Lohse your
trusted signing key from from the

376
00:28:27,270 --> 00:28:32,590
freshman try because you want to be
doing signature verification and menu

377
00:28:32,590 --> 00:28:36,689
option only if you have looks and Crips
not your boot partition or full hard

378
00:28:36,690 --> 00:28:38,360
disk you first two Deluxe

379
00:28:38,360 --> 00:28:44,080
looks unlocking of the hottest and then
the next stage in the group CFG from

380
00:28:44,080 --> 00:28:48,668
memory is that it actually loads
assigned groups EFG from the hot and

381
00:28:48,669 --> 00:28:52,840
that the idea behind this is the second
stage grub configuration that needs to

382
00:28:52,840 --> 00:28:56,860
be signed but can live on the hardest so
the ideas if you change your corner

383
00:28:56,860 --> 00:29:00,799
commandant for example or the way you
load modules into your comments on you

384
00:29:00,799 --> 00:29:04,710
don't have to go and flashed a new flash
image with an excellent program you can

385
00:29:04,710 --> 00:29:09,020
change this kind of stuff on the hard
disk but the configuration itself needs

386
00:29:09,020 --> 00:29:14,280
to be signed off cause to have secure
chain of trust in the bush in rain and

387
00:29:14,280 --> 00:29:19,049
the kind of the superuser conflagration
here's if any of these steps fails

388
00:29:19,049 --> 00:29:26,039
actually for pass phrase that you can be
KDF to was a lot of operations so it's

389
00:29:26,039 --> 00:29:30,320
not easy to brute force of course you
can just disable the space race but what

390
00:29:30,320 --> 00:29:33,480
I'm trying to say it's not possible that
if any of these steps fares and it gives

391
00:29:33,480 --> 00:29:37,039
you the grub rescue shelter and then you
can just load anything right

392
00:29:38,039 --> 00:29:46,620
the next step is we want to have secure
root filesystem and there's actually

393
00:29:46,620 --> 00:29:51,080
before that this solution out there
already that caused quite diem varity so

394
00:29:51,080 --> 00:29:57,490
the basic idea is we want to have a root
filesystem for Linux it is tied to our

395
00:29:57,490 --> 00:30:01,559
signing key right however it's
impractical to sign every single phone

396
00:30:01,559 --> 00:30:05,520
your root filesystem obviously because
our sales slow and so on

397
00:30:05,520 --> 00:30:11,139
and also takes all the signatures take
too much space in parity is hash tree

398
00:30:11,140 --> 00:30:16,680
over all the blocks in your disk so
basically what you can and then into

399
00:30:16,680 --> 00:30:21,550
your configuration that loss Linux is
the root tests it's basically something

400
00:30:21,550 --> 00:30:27,050
like someone has for example over your
entire blocks of your actually roadblock

401
00:30:27,050 --> 00:30:31,240
device underlying disk contents right
however building a hash of everything

402
00:30:31,240 --> 00:30:34,970
and refine the contents of the entire
just called resided in very slow boot

403
00:30:34,970 --> 00:30:39,170
process this is why they use a hash
treat hester is basically you have for

404
00:30:39,170 --> 00:30:43,870
every roadblock of your hard disk you
have a hash for this blocked so you can

405
00:30:43,870 --> 00:30:48,149
verify the house as read the block so
you don't have to verify everything in

406
00:30:48,150 --> 00:30:52,860
the beginning you can do it at runtime
and it's rather perform and and then the

407
00:30:52,860 --> 00:30:57,649
hash tree is basically you know
different stages in the trio has about

408
00:30:57,650 --> 00:31:02,050
other hashes and because it's a tree you
end up with one root hairs that you can

409
00:31:02,050 --> 00:31:06,250
then Amidon your command line and the
Kona command line is part of the same

410
00:31:06,250 --> 00:31:10,920
configuration file I decided it
emphasized the configuration assigned

411
00:31:10,920 --> 00:31:16,650
implicitly the route has also signed
with GPG key so buy influence the entire

412
00:31:16,650 --> 00:31:24,530
root filesystem is signed by your bio
key again the commands to compute this

413
00:31:24,530 --> 00:31:30,850
and this basically protects your entire
you know root filesystem of course this

414
00:31:30,850 --> 00:31:34,740
also implies that the root filesystem is
to be read only because you know if you

415
00:31:34,740 --> 00:31:38,860
write the root filesystem you change the
hashes and verification would fail right

416
00:31:38,860 --> 00:31:45,070
so you have to have a home partisan for
example in the setup that I use I have a

417
00:31:45,070 --> 00:31:48,720
read only route petition that is
actually not encrypted because I have I

418
00:31:48,720 --> 00:31:52,350
don't need to hide what programs I use
only want to hide my personal data from

419
00:31:52,350 --> 00:31:56,120
a competition and there's also a lot
faster if the repetition is not

420
00:31:56,120 --> 00:31:59,459
encrypted you don't have all the battery
drain and so on and

421
00:32:00,519 --> 00:32:06,940
competition is encrypted and Martin
Nowak 60 there's no executables that can

422
00:32:06,940 --> 00:32:12,499
never be loaded from competition and all
executables in my system are on the

423
00:32:12,499 --> 00:32:17,919
street only petition if somebody wants
to have local root exploit and mounted

424
00:32:17,919 --> 00:32:21,820
read write again then it's still
verified in the history the next time I

425
00:32:21,820 --> 00:32:26,499
boot or the next time this is this is
being read the verification fares right

426
00:32:26,499 --> 00:32:30,979
so you get kind of also from from remote
code execution you get some protection

427
00:32:30,979 --> 00:32:38,239
for for persistence exploits of course
that is so many interpreters like Python

428
00:32:38,239 --> 00:32:42,570
impassioned soon and then accept this is
a passive protection only saw an

429
00:32:42,570 --> 00:32:47,239
attacker could for example drop
something that is executed a bomb at

430
00:32:47,239 --> 00:32:50,849
lock in the configuration file that
executes the best script at Logan into

431
00:32:50,849 --> 00:32:54,769
yourself but you know at least you can
protect against native code execution to

432
00:32:54,769 --> 00:33:00,509
swim so this is kind of similar to the
IRS old iOS I don't know maybe six or

433
00:33:00,509 --> 00:33:05,589
seven models but you need to have you
time

434
00:33:05,589 --> 00:33:11,969
assistance exploit to get code execution
during boot to deploy some persistent

435
00:33:11,969 --> 00:33:18,049
now where if you don't have to sign in
his throat and then a little water in

436
00:33:18,049 --> 00:33:21,559
the binary blob spider a bloodless
basically you know most most modern

437
00:33:21,559 --> 00:33:26,320
hardware vendors to supply you with
former blocks that the operating system

438
00:33:26,320 --> 00:33:29,519
needs to know that moved into the
firmware for different devices to their

439
00:33:29,519 --> 00:33:32,639
function properly right that's the
firmware for the vibe by drivers and so

440
00:33:32,639 --> 00:33:35,849
on but even even more from where

441
00:33:35,849 --> 00:33:41,428
so the Chromebooks that I i targets here
they do require binary bob steiner et to

442
00:33:41,429 --> 00:33:45,409
work you cannot just make it work was a
binary blobs right and all the tinfoil

443
00:33:45,409 --> 00:33:49,070
hats will tell you but there will be you
know back to us in the binary blobs

444
00:33:49,070 --> 00:33:53,599
right and this is so then as a gets onto
laptop again and that's from my

445
00:33:53,599 --> 00:33:56,879
perspective that's not irrelevant
because it takes surface except for the

446
00:33:56,879 --> 00:34:01,349
firmware for your network equipment of
course is local attack surface only

447
00:34:01,349 --> 00:34:05,789
right so this could be relevant for a
getting for example to Assam system

448
00:34:05,789 --> 00:34:07,440
management more than things like this

449
00:34:07,440 --> 00:34:12,270
but it's not relevant as a remote attack
surface part of these blocks are

450
00:34:12,270 --> 00:34:18,480
actually X x86 code that is being run on
your host CPU for example of the PGA

451
00:34:18,480 --> 00:34:22,668
adept tights needs to execute one of
these binary blobs to initialize it's

452
00:34:22,668 --> 00:34:28,158
got to be Jayron right on foods and but
thats x86 code that you can actually

453
00:34:28,159 --> 00:34:31,990
easily reverse engineer and on the
Chromebooks also have an embedded

454
00:34:31,989 --> 00:34:36,388
controller but again the firmware
there's open source so you can audit its

455
00:34:36,389 --> 00:34:41,639
and build it yourself right that's it
Texas again he resists river there's no

456
00:34:41,639 --> 00:34:45,940
DMA so there's no direct memory access
from the American troller all they can

457
00:34:45,940 --> 00:34:49,668
do on the embedded controller it's
because it's used for cooking the

458
00:34:49,668 --> 00:34:54,989
keyboard metrics up to x-ray scan codes
they can do keylogging but you have no

459
00:34:54,989 --> 00:34:58,549
way to expert rated the data from the
embedded control except if you actually

460
00:34:58,550 --> 00:35:04,020
managed to pull off some you know radio
communications over some wires there was

461
00:35:04,020 --> 00:35:09,500
some israelis doing some research on
this recently in addition the code that

462
00:35:09,500 --> 00:35:15,900
is partially open source or insurance
that the controller firmware is correct

463
00:35:15,900 --> 00:35:20,200
states who is this could be adapted
which I did not do it yet there's a big

464
00:35:20,200 --> 00:35:25,089
secret thing about into manageability
ends and then to manageability engine is

465
00:35:25,089 --> 00:35:30,490
basically an additional embedded control
at least these days and the same package

466
00:35:30,490 --> 00:35:34,910
as your main processor is usually an
awkward spot processor that does you

467
00:35:34,910 --> 00:35:39,750
know our stuff and so on the Chromebooks
come with a very small minute ability

468
00:35:39,750 --> 00:35:44,310
and firmware which is really normally
you can have in turn anti-theft

469
00:35:44,310 --> 00:35:47,520
technology you can have integrated
lights-out management and so on for

470
00:35:47,520 --> 00:35:51,310
servers in in the manageability engine
then you have an extra room or detect

471
00:35:51,310 --> 00:35:55,349
surface the manageability engine in
these laptops we just for you know power

472
00:35:55,349 --> 00:35:58,619
saving and so on so there's no real
attack surface

473
00:35:59,740 --> 00:36:04,160
and even this is being reversed
engineered by people even though it's

474
00:36:04,160 --> 00:36:07,799
you know obscure and so on and so
separate topic yugoslavians gave some

475
00:36:07,800 --> 00:36:13,610
some talks at Tech SEC I believe about
this and yeah there's some research

476
00:36:13,610 --> 00:36:18,380
being done but again the attack suffice
for our purposes not relevant so they

477
00:36:18,380 --> 00:36:24,220
are binary blobs but it's not a problem
in my perspective so the last thing that

478
00:36:24,220 --> 00:36:28,129
I want to talk about today before we get
to some some you know then was looking

479
00:36:28,130 --> 00:36:34,440
at stuff is measuring and attestation so
Richard Stallman said at some point at

480
00:36:34,440 --> 00:36:39,310
TPM stress applied for my jaws are very
EVA thing nobody should support this

481
00:36:39,310 --> 00:36:44,119
they are against free software and so on
I actually believe this is not very good

482
00:36:44,119 --> 00:36:48,730
you know policy because the PM's are
really great for securing your platform

483
00:36:48,730 --> 00:36:52,570
that's why they're called Trusted
Platform 11 years but they were proposed

484
00:36:52,570 --> 00:36:57,630
partially by Microsoft and you can
actually see that the government had a

485
00:36:57,630 --> 00:37:01,980
lot of their fingers in those but it's
not a technology that's imposed on

486
00:37:01,980 --> 00:37:05,650
people to control of them will go to get
access but actually yes government wants

487
00:37:05,650 --> 00:37:10,310
them to secure their own platforms and
make them more trustworthy that's pretty

488
00:37:10,310 --> 00:37:14,990
funny you can even find like the NSA
singers and some open source since I

489
00:37:14,990 --> 00:37:20,350
never show you later so basically the
the Trusted Platform Module is one

490
00:37:20,350 --> 00:37:25,609
single additional support of the many
chips on your mainboard right and it's

491
00:37:25,609 --> 00:37:30,029
connected to your main CPU over what's
called the NPC bus so that's basically

492
00:37:30,030 --> 00:37:35,380
left a bus or may not pass and it can
talk to your CPU directly the idea of

493
00:37:35,380 --> 00:37:39,609
trusted platform modules that their
updates have to be signs they have

494
00:37:39,609 --> 00:37:43,640
proper cryptography and they have
auditing of from west from these and so

495
00:37:43,640 --> 00:37:48,500
on but of course the most of these
companies in the signing happens in the

496
00:37:48,500 --> 00:37:54,210
USA if your threat model release the NSA
and so on then you have you could be you

497
00:37:54,210 --> 00:37:58,840
know paranoid about getting a Trusted
Platform Module from baghdad that's even

498
00:37:58,840 --> 00:38:01,490
sign but still contains the back door

499
00:38:01,490 --> 00:38:07,399
again the TPM has no deep DMA and so on
so it cannot be compromised immune

500
00:38:07,400 --> 00:38:11,690
system but if you use the TPM to you
know it's true the integrity of your

501
00:38:11,690 --> 00:38:16,790
system then back during and of course
would allow them to back to your system

502
00:38:16,790 --> 00:38:22,490
without you noticing it also 2 p.m. is
by design are not hard against physical

503
00:38:22,490 --> 00:38:26,859
tempering so that their threat model is
always that you have to have your laptop

504
00:38:26,860 --> 00:38:31,320
in your possession always which is not
exactly the threat of this talk we talk

505
00:38:31,320 --> 00:38:36,590
about somebody takes her laptop away at
the border right so hypothetically your

506
00:38:36,590 --> 00:38:41,420
candy cap them extract secrets from them
and so on and so on but again this is

507
00:38:41,420 --> 00:38:44,810
something that doesn't happen within
three hours of a laptop being taken away

508
00:38:44,810 --> 00:38:50,600
and what you can do with a Trusted
Platform Module is you can measure your

509
00:38:50,600 --> 00:38:54,600
platform stage until the system is being
reset right well what's the meaning of

510
00:38:54,600 --> 00:38:58,380
measuring the platform state the
so-called platform control registers

511
00:38:58,380 --> 00:39:02,880
which are 20 bytes long which is
coincidentally the official one has to

512
00:39:02,880 --> 00:39:08,910
say and the host CPU voluntarily reports
its current state in the form of shower

513
00:39:08,910 --> 00:39:13,790
one has service to the TPM so when you
boot you can take a shower one-half the

514
00:39:13,790 --> 00:39:17,259
bootloader check security you can take a
shower one-half of the configuration of

515
00:39:17,260 --> 00:39:21,520
the bootloader you can take a shower
wanna someone has traffic on and so on

516
00:39:21,520 --> 00:39:26,300
report these hashes to the Trusted
Platform Module but instead of directly

517
00:39:26,300 --> 00:39:30,030
writing the head into one of these
registers which is a write operation

518
00:39:30,030 --> 00:39:35,040
which is kind of loose useless because
then at any later stage any implant

519
00:39:35,040 --> 00:39:39,279
could write the correct hasn't to this
register in new assimilate good stayed

520
00:39:39,280 --> 00:39:43,350
you cannot actually writers is
registered you can only extend them

521
00:39:43,350 --> 00:39:48,240
that's the name of this operation and
this means you don't try to force

522
00:39:48,240 --> 00:39:53,140
someone hasn't as a register but the
report the new house to the TPM and then

523
00:39:53,140 --> 00:39:57,310
dnt p.m. takes the old test from the
register contents and the new hash and

524
00:39:57,310 --> 00:40:02,410
hashes them again and the head of this
is put in the register so register

525
00:40:02,410 --> 00:40:04,170
content is implicitly

526
00:40:04,170 --> 00:40:09,720
shame about all the stages said you have
executed so when you look at the

527
00:40:09,720 --> 00:40:13,399
contradictory register you can never
explicitly influence the content you can

528
00:40:13,400 --> 00:40:14,099
only employee

529
00:40:14,099 --> 00:40:20,559
extent the state and Afghan off like a
secure has trained that then relates

530
00:40:20,559 --> 00:40:26,009
back to what status executed but you can
never explicitly influence this and the

531
00:40:26,009 --> 00:40:30,930
next interesting feature the TBM has
remote at the station which is basically

532
00:40:30,930 --> 00:40:35,019
a way to tell a remote parts here over
an insecure channel like a network

533
00:40:35,019 --> 00:40:39,098
connection or even locally over an
untrusted bus like the legacy bus

534
00:40:39,099 --> 00:40:44,150
because hypothetically somebody could be
attaching wires to your mainboard you

535
00:40:44,150 --> 00:40:48,339
can attest the state of your current
platform and basically what this means

536
00:40:48,339 --> 00:40:52,558
it's science the current content of his
platform control registers and random

537
00:40:52,559 --> 00:40:56,680
nonce that you know the party that is
being addressed to generate and provides

538
00:40:56,680 --> 00:41:03,788
with 2 p.m. specific 2048 bits are a key
so if you bring your public key from the

539
00:41:03,789 --> 00:41:09,569
specific at the station key to some
supper for example for her and then you

540
00:41:09,569 --> 00:41:15,038
can travel around and even if you're
operating system has been compromised in

541
00:41:15,039 --> 00:41:19,460
the way that every user interface you
wouldn't used to look at the TPM

542
00:41:19,460 --> 00:41:22,460
contents would be modified to fake
correct state when reality you

543
00:41:22,460 --> 00:41:27,289
compromise you can then use on a remote
server this this publicly verification

544
00:41:27,289 --> 00:41:31,529
and it would tell you this is actually
not a correct signature on the state so

545
00:41:31,529 --> 00:41:37,979
you could actually figure out a
compromise so when I started out there

546
00:41:37,979 --> 00:41:42,710
was no PCR measuring the pleasure of
State measuring in Corbett's I work with

547
00:41:42,710 --> 00:41:47,950
some other guy who was actually quite a
long time developer on adding 2 p.m.

548
00:41:47,950 --> 00:41:55,069
measurements to quote moves upstream of
streaming already added 2 p.m. hardware

549
00:41:55,069 --> 00:42:00,450
support and generals so Google users in
the Chromebook film we're still make use

550
00:42:00,450 --> 00:42:04,390
of the TPM so the general hardware
support was there but there was simply

551
00:42:04,390 --> 00:42:08,078
no quote that takes the shower one died
just after different keyboard and would

552
00:42:08,079 --> 00:42:10,619
stages and report this to the TPM right

553
00:42:10,619 --> 00:42:15,230
the code that we added in the room stage
missus measures around stage so before

554
00:42:15,230 --> 00:42:19,849
memory is initialized you executing was
was something else called cassius

555
00:42:19,849 --> 00:42:24,740
remember this is platform details and
basically what's being hashed is what's

556
00:42:24,740 --> 00:42:29,740
going to be executed in memory see even
if you assume somebody user PCI Express

557
00:42:29,740 --> 00:42:36,229
ha trim played in your laptop to access
your memory at runtime and change memory

558
00:42:36,230 --> 00:42:41,920
contents this starts measuring for
memory is initialized right so you

559
00:42:41,920 --> 00:42:46,259
measure stuff before the PC and before
the american actually do something bad

560
00:42:46,259 --> 00:42:52,420
to you of course BC I could then wait
for the right moment to modify the code

561
00:42:52,420 --> 00:42:58,170
after measuring and then the RAM stage
measures all the PCI RAM so if you have

562
00:42:58,170 --> 00:43:02,529
like beside devices that have option or
arms ban reblogged seas are being hashed

563
00:43:02,529 --> 00:43:06,569
and actually also has to say and
measures the payload which in our case

564
00:43:06,569 --> 00:43:12,950
is abrupt too and I did not modify the
grub2 pillar to do additional

565
00:43:12,950 --> 00:43:15,700
measurements because I don't think it's
necessary

566
00:43:15,700 --> 00:43:19,499
the signing key that you use for
verifying the integrity of the corner of

567
00:43:19,499 --> 00:43:24,249
the configuration and so on its part of
the payload depended is being measured

568
00:43:24,249 --> 00:43:29,200
by microbes implicitly you signing key
is being measured by global as well so

569
00:43:29,200 --> 00:43:33,618
if somebody was to replace assigning key
in your in your flesh was something else

570
00:43:33,619 --> 00:43:37,779
was an external flash programmer for
example all the CPM platform state would

571
00:43:37,779 --> 00:43:42,269
be changing because they have legal
Wireless will soon be dead right and so

572
00:43:42,269 --> 00:43:45,848
you could actually see this if you
really think you need the stairs

573
00:43:45,849 --> 00:43:55,819
actually trusted group to which I talked
to the group also have bloody Mia I

574
00:43:55,819 --> 00:43:58,560
don't know what a second family Nick
sorry

575
00:43:58,560 --> 00:44:02,840
ask them why they don't want 2 p.m.
support an upstream and they basically

576
00:44:02,840 --> 00:44:07,340
follow Richard Simons Free Software
Foundation 30 p.m. sorry evil and you

577
00:44:07,340 --> 00:44:12,990
suppress so there but there's the front
of crop that actually has coached to do

578
00:44:12,990 --> 00:44:17,229
measurements unfortunately it doesn't
have the code to do talk to the TPM

579
00:44:17,230 --> 00:44:22,450
directly but it requires actually
dispute services UEFI BIOS interrupts in

580
00:44:22,450 --> 00:44:24,750
interface to actually talk to the TPM

581
00:44:24,750 --> 00:44:28,720
supports trusted rub two frogmen would
have to ease extent cool boots to

582
00:44:28,720 --> 00:44:33,629
provide these boots services which could
would allow upstream or modify trusted

583
00:44:33,630 --> 00:44:41,000
truck tool to have supported directly
talk to their PC bus what I wanted to do

584
00:44:41,000 --> 00:44:45,250
is using this remote attestation as kind
of second factor in authentication

585
00:44:45,250 --> 00:44:51,340
because you know I use ssh right you
know you have your eye sees shells over

586
00:44:51,340 --> 00:44:57,230
unnecessary chicken recipe to copy data
to your laptop so I thought it may be a

587
00:44:57,230 --> 00:45:01,050
good idea to use remote attestation a
second factor so you have two factors

588
00:45:01,050 --> 00:45:04,390
you have the secret that you possess in
your home directory which is in essence

589
00:45:04,390 --> 00:45:09,049
a private key that you used to look into
your server but you also use remote

590
00:45:09,050 --> 00:45:13,310
attestation to verify that the machine
that you're logging in with is in a

591
00:45:13,310 --> 00:45:18,130
secure estate right I mean I totally
about the station and now the remote

592
00:45:18,130 --> 00:45:22,070
attestation towards the SSH server to
prove that the terminal that the

593
00:45:22,070 --> 00:45:25,770
keyboard and an operating system that
you looking into is is clean and so on

594
00:45:25,770 --> 00:45:31,240
its trust right even if somebody for
some reason is able to steal your

595
00:45:31,240 --> 00:45:34,319
private key that you use of course only
use for traveling

596
00:45:34,850 --> 00:45:38,680
they will not be able to look into the
machine unless they have exactly that

597
00:45:38,680 --> 00:45:43,750
same platform state from from your
laptop right so what I basically did is

598
00:45:43,750 --> 00:45:49,100
I implemented 2 p.m. remote attestation
with Streisand as a transport because

599
00:45:49,100 --> 00:45:54,759
the Trusted Computing Group 2 p.m.
software stack that's what CSS stands

600
00:45:54,760 --> 00:45:55,350
for

601
00:45:55,350 --> 00:46:02,120
specifies a 71 and coding was you know
Dr rules as transport for generally more

602
00:46:02,120 --> 00:46:06,089
devastation and so on and if you have
your followed in the last 10 years

603
00:46:06,090 --> 00:46:10,800
Security Advisor associate someone as
brilliant way to introduce code

604
00:46:10,800 --> 00:46:15,940
execution vulnerabilities so I did not
want to use and one as a transport here

605
00:46:15,940 --> 00:46:19,460
and not want to add stuff like this
authentication at all

606
00:46:20,150 --> 00:46:26,040
wrote to simple tools are also Assange
technology called quote make and verify

607
00:46:26,040 --> 00:46:31,790
their very simple you know command line
201 is used to make a remote attestation

608
00:46:31,790 --> 00:46:36,180
the thing the block that you sent 42
stations called a quote right because

609
00:46:36,180 --> 00:46:40,589
you make a quote on the state of the
laptop so this 21 court make makes a

610
00:46:40,590 --> 00:46:44,600
quote on your local laptop and cord
verify can then be used on a remote

611
00:46:44,600 --> 00:46:49,250
server to verify that a lot of course
actually correctly sign and so on and

612
00:46:49,250 --> 00:46:54,460
this is then used to very fair to verify
the integrity of the laptop and I'm

613
00:46:54,460 --> 00:47:02,180
using CCSD which is 40 p.m.
implementation there another way to

614
00:47:02,180 --> 00:47:07,640
prove integrity by the way is 2 p.m.
unsealing this is some some third-party

615
00:47:07,640 --> 00:47:11,799
research I briefly want to mention from
the field carried mostly you can also

616
00:47:11,800 --> 00:47:15,900
this is public you stuff right to can
also 2 p.m. can do symmetric AES

617
00:47:15,900 --> 00:47:20,950
encryption using your platform state as
a symmetric cute and one brilliant idea

618
00:47:20,950 --> 00:47:25,620
that mr Garrett head is instead of
incrementing aesthetic secret that you

619
00:47:25,620 --> 00:47:30,880
would display for verification which is
very easy to show the self right so if

620
00:47:30,880 --> 00:47:34,370
you have like an image that you decrypt
and only if you see the right image than

621
00:47:34,370 --> 00:47:37,529
you know your plans for mister good
stayed but then somebody can showed us a

622
00:47:37,530 --> 00:47:41,530
few of the images and then they can just
replicate the image when the implants

623
00:47:41,530 --> 00:47:45,440
who writes but his idea was basically
that to use it to UTEP secret like you

624
00:47:45,440 --> 00:47:46,230
know these days

625
00:47:46,230 --> 00:47:50,440
two-factor authentication Google
authenticator and do a second so on so

626
00:47:50,440 --> 00:47:56,150
you encrypt the secret for TOTP with the
current place on state and then you only

627
00:47:56,150 --> 00:48:02,010
display the current active belet six
digits right and you have to same record

628
00:48:02,010 --> 00:48:05,420
on your mobile phone so you can compare
the six digits from your mobile phone

629
00:48:05,420 --> 00:48:06,760
was what you're being shown in your life

630
00:48:06,760 --> 00:48:10,700
only if the six digit match which is
very easy to verify because people are

631
00:48:10,700 --> 00:48:15,370
lazy only then developed state and
nobody has a use of solar surfing you

632
00:48:15,370 --> 00:48:21,200
for the six digits because they change
every minute ride because it's time but

633
00:48:21,200 --> 00:48:25,129
I liked the public have brats ok before
we get to the company's you know

634
00:48:25,130 --> 00:48:31,370
everybody you bring in extra time right
let's see you can see this yeah this is

635
00:48:31,370 --> 00:48:36,580
my hands okay so this is the laptop P&O
thats this is the security level laptop

636
00:48:36,580 --> 00:48:41,029
now has started on first and if you
watch the upper left corner USD briefly

637
00:48:41,030 --> 00:48:50,430
that Rob says hello to you hope it works
now that depends on what up briefly set

638
00:48:50,430 --> 00:48:55,830
alone another Linux are starting already
honey get a kernel panic ok that's a Dem

639
00:48:55,830 --> 00:49:00,049
effect yet that's actually that's a buck
and then one of the phone will prob so

640
00:49:00,050 --> 00:49:05,350
about one out of four or five
put-together colon pentagon boot which

641
00:49:05,350 --> 00:49:09,069
doesn't matter then you just reset it
and you put a can of course had to get

642
00:49:09,070 --> 00:49:16,620
the condominium better get another 10
just because it wasn't okay and I'm

643
00:49:16,620 --> 00:49:19,250
being prompted for my and you see my

644
00:49:19,250 --> 00:49:26,350
ok I want to see how somebody
reconstruct my best friends from my

645
00:49:26,350 --> 00:49:31,710
finger movements and vibrations that
will be nice and at a candidate because

646
00:49:31,710 --> 00:49:36,490
I take many has a duration because I'm
kinda paranoid and I'm basically

647
00:49:36,490 --> 00:49:42,640
unlocking my competition and you see you
get a useful

648
00:49:42,640 --> 00:49:49,069
lennox ok you cannot see the screen very
well but the focus doesn't work so we're

649
00:49:49,070 --> 00:49:57,820
here but I will login and you have
reasonably normal laptop was was it was

650
00:49:57,820 --> 00:50:03,390
a messed up now and you can work with
that right so this is this is useful

651
00:50:03,390 --> 00:50:06,250
thing opposed to like a homeless for
example

652
00:50:06,250 --> 00:50:12,020
and then the next thing I want to do it
was first go to Germany

653
00:50:18,119 --> 00:50:23,059
and start existing open-source software
that has caused it to be a manager you

654
00:50:23,059 --> 00:50:29,279
can display the PCR sealer basically you
can see I don't populate all the

655
00:50:29,279 --> 00:50:33,710
platform registers but these three have
been populated by crumbled known susan

656
00:50:33,710 --> 00:50:38,599
utilization status all zeros and these
hazardous they are specific to what I'm

657
00:50:38,599 --> 00:50:39,519
booting right now

658
00:50:39,519 --> 00:50:43,868
ok so this is this is the first thing
you can check the content of this

659
00:50:43,869 --> 00:50:50,599
hatch's but that is not very easy to
remember right so let's let's try demo

660
00:50:50,599 --> 00:50:57,910
of remote attestation as you can see
here I have network connection between

661
00:50:57,910 --> 00:51:05,009
my laptop and this computer here and I
thought so as you can see have some DSCP

662
00:51:05,009 --> 00:51:09,269
running so if everything is somewhat
working I will get at least now

663
00:51:15,260 --> 00:51:18,260
of course

664
00:52:07,079 --> 00:52:24,859
ok very interesting because it's the
first thing I wanted to do local

665
00:52:24,859 --> 00:52:31,479
verification solicit think that Iran has
PCR states and I can actually show you

666
00:52:31,479 --> 00:52:34,578
the PCR clinton's here

667
00:52:56,020 --> 00:53:09,240
because they have much more external
supply data that the measuring and

668
00:53:09,240 --> 00:53:12,810
executing and they're not very secure
but you know you get a much much more

669
00:53:12,810 --> 00:53:18,670
platform state so what I want to do
first is remote attestation over the NPC

670
00:53:18,670 --> 00:53:24,100
bus to the local host untrusted bus and
these other two told said that I brought

671
00:53:24,100 --> 00:53:28,779
right I want to verify quote and I have
what I call like these expectations

672
00:53:28,780 --> 00:53:33,120
Asian files so that's very funny quotes
truth and then you get an attestation

673
00:53:33,120 --> 00:53:37,180
request right because this contains the
nonce the random nonsense that's been

674
00:53:37,180 --> 00:53:43,149
signed and the PCR registers and you
copy that the station request to the

675
00:53:43,150 --> 00:53:47,320
court makes things to tell it make me an
attestation was announced as you can see

676
00:53:47,320 --> 00:53:51,050
2 p.m. is really slow to sign stuff but
then you get your quote right in the

677
00:53:51,050 --> 00:53:56,340
quote basically contains no the contents
of this one has a softer platform

678
00:53:56,340 --> 00:54:03,720
control registers the extra quote is you
know contains a company of this year and

679
00:54:03,720 --> 00:54:08,189
the nonsense and worsen information and
then the extra RCA signature 2048 bit

680
00:54:08,190 --> 00:54:14,800
over over the quote and this is this is
the quote and we can feed this to our

681
00:54:14,800 --> 00:54:20,560
verification code and yet exit code 0 so
this was fined know if I take the same

682
00:54:20,560 --> 00:54:27,049
at the station requests are taken you at
the station request but this time I

683
00:54:27,050 --> 00:54:33,820
would mess was the nonce I need to be
better than a 64 and if I slightly

684
00:54:33,820 --> 00:54:39,500
modify the nonce of course still used an
onsen give me give me a quote but if I

685
00:54:39,500 --> 00:54:44,310
then verify the quote for example the
nonsense does not match quote for

686
00:54:44,310 --> 00:54:51,170
Education Fair texaco six and so on and
i could screw business now but so this

687
00:54:51,170 --> 00:54:55,350
is basically nice because even if I
don't trust the PCR is being displayed

688
00:54:55,350 --> 00:55:00,410
to me and then there's this UI and so on
I can't even if I trust the bus I cannot

689
00:55:00,410 --> 00:55:02,850
remember rating system

690
00:55:02,850 --> 00:55:06,839
ok let me log into connection refused

691
00:55:07,660 --> 00:55:10,660
K

692
00:55:34,070 --> 00:55:37,370
from this one

693
00:56:04,720 --> 00:56:29,629
look into the public another request
from I can use this one again

694
00:56:35,870 --> 00:56:42,859
ok I need to install a librarian for
this I need internet so I would put the

695
00:56:42,860 --> 00:56:52,330
democrats second other any questions let
me briefly explain the reasoning because

696
00:56:52,330 --> 00:56:55,470
this one doesn't have persistent state
because the root system is readonly I

697
00:56:55,470 --> 00:57:00,450
installed the library but I rebooted the
system instead of suspending its all the

698
00:57:00,450 --> 00:57:03,240
library is gone again and I need
internet connection to install the

699
00:57:03,240 --> 00:57:08,359
library actually so security for the
paranoid Arsenal very good for demos I

700
00:57:08,360 --> 00:57:12,310
will do the damage was taken off the
remote attestation basically the ideas

701
00:57:12,310 --> 00:57:15,790
you have that the state's request you do
the same thing that I do locally and you

702
00:57:15,790 --> 00:57:20,590
do that remotely in India so if you have
a direct quote

703
00:57:20,590 --> 00:57:31,990
all right let's briefly to a conclusion
then I will take questions and we go so

704
00:57:31,990 --> 00:57:32,750
the conclusion

705
00:57:32,750 --> 00:57:38,140
contribution is everything I talked
about is open source and there is a Jew

706
00:57:38,140 --> 00:57:45,370
top was embarked on read me that really
has like the row walkthrough with how

707
00:57:45,370 --> 00:57:49,270
you set up everything and even
step-by-step setup to replicate this

708
00:57:49,270 --> 00:57:54,440
setup thread so that's public also the
same shit repository all the scripts

709
00:57:54,440 --> 00:57:57,860
configurations and I'm using the code
for the Jason 2 p.m. remote attestation

710
00:57:57,860 --> 00:58:05,290
and abused e license as published their
support for the 2010 season at forty is

711
00:58:05,290 --> 00:58:09,110
a master now so you don't even have to
use my charitable trust me but you can

712
00:58:09,110 --> 00:58:11,810
actually used the crowd would say it's

713
00:58:11,810 --> 00:58:15,860
with the code that has been reviewed by
the copper team in the main conclusion

714
00:58:15,860 --> 00:58:19,970
as a trusted which train does not have
to be expensive you can take one of

715
00:58:19,970 --> 00:58:25,270
these really really cheap laptops cheap
flashing set up for a less than a total

716
00:58:25,270 --> 00:58:31,710
of $30 and you basically end up with
less than $150 to replicate the setup of

717
00:58:31,710 --> 00:58:35,100
course you will be using a lot of open
source software I called was their

718
00:58:35,100 --> 00:58:39,339
trappist they're very to support a Linux
all their rights open source software

719
00:58:39,340 --> 00:58:44,140
use there is priceless and I want to
thank you flip that visa for working on

720
00:58:44,140 --> 00:58:47,759
the property p.m. supply with me and a
month for giving me initially

721
00:58:47,760 --> 00:58:53,230
inspiration for this requirement to have
something like this many years ago

722
00:58:53,230 --> 00:58:58,350
already alright no thank you first of
all the attention bear with me for the

723
00:58:58,350 --> 00:59:08,560
new fed them oh and thanks on any
questions yes oh by the way I first

724
00:59:08,560 --> 00:59:11,560
three questions get a free cross
strikers

725
00:59:12,090 --> 00:59:21,730
what's your question they do wonder
where to second there sorry so it's it's

726
00:59:21,730 --> 00:59:26,730
kind of a minor thing but you don't
often k your home partition so are you

727
00:59:26,730 --> 00:59:32,000
worried about an attack modifying that
change of presentation slides to like go

728
00:59:32,000 --> 00:59:36,050
to or something did you look off then
skated fullest encryption for that or

729
00:59:36,050 --> 00:59:41,920
saying anything so if you want to bring
athletic competition without the ability

730
00:59:41,920 --> 00:59:46,720
to actually safe work then you can just
leave the home petition you can encrypt

731
00:59:46,720 --> 00:59:49,980
your route edition and use the same p.m.
varity set up for your competition as

732
00:59:49,980 --> 00:59:55,580
well so that's trivial to adapt to leave
out the step of extra competition just

733
00:59:55,580 --> 00:59:59,049
leave it on the repetition then you have
an authenticated competition but then

734
00:59:59,050 --> 01:00:03,000
you will lose all work or you have to
save work on external thumb drive for

735
01:00:03,000 --> 01:00:10,270
example right the encryption however the
court that does the decryption and would

736
01:00:10,270 --> 01:00:15,240
have the ability to modify the contents
at runtime would have to be signed right

737
01:00:15,240 --> 01:00:18,200
I'm verifying that the unlocking code
and so on

738
01:00:18,200 --> 01:00:23,460
so somebody would have to have my pass
phrase to actually my shoulder surfing

739
01:00:23,460 --> 01:00:27,859
for example to do modification some info
this but I I want to write about

740
01:00:27,859 --> 01:00:30,930
petition on my laptop otherwise it's
pointless to bring a laptop for me

741
01:00:30,930 --> 01:00:34,990
because I do more than a surfing YouTube
with it and then again the home content

742
01:00:34,990 --> 01:00:46,118
doesn't matter but you can do this
description in the top so ripped it so

743
01:00:46,119 --> 01:00:52,530
what if the ticker will it would instead
of modifying the disk contents would

744
01:00:52,530 --> 01:00:58,300
refresh the firmware after hard disk and
modified in a way that after five

745
01:00:58,300 --> 01:01:04,089
minutes it will start giving out bad
memories for example that's that's the

746
01:01:04,089 --> 01:01:08,029
great thing about the invariant see
every time an extra blocker is read from

747
01:01:08,030 --> 01:01:14,260
the exit device the hash for that block
is verified of course Linux has blocked

748
01:01:14,260 --> 01:01:18,690
cache memories so you know even worse
addresses don't always read the dead are

749
01:01:18,690 --> 01:01:23,960
freshmen does give you access it again
right so if you assume an attack that

750
01:01:23,960 --> 01:01:28,319
modifies the block cash in memory that
would be possible but every time

751
01:01:28,319 --> 01:01:31,550
something is actually read from the
disaster has been verified so instead of

752
01:01:31,550 --> 01:01:35,839
verifying everything at boot you saw it
was reasonably fast food except for

753
01:01:35,839 --> 01:01:40,759
doing a lot of fishing off my for this
encryption passphrase it would it would

754
01:01:40,760 --> 01:01:44,630
take forever if it has everything right
it only has data as it's being access so

755
01:01:44,630 --> 01:01:51,440
you can actually not use the form we're
taking a hard disk anyone else ever

756
01:01:51,440 --> 01:01:54,440
thought

757
01:01:56,780 --> 01:02:01,690
I guess this will help against some kind
of hydrogen plants but I can imagine it

758
01:02:01,690 --> 01:02:09,060
won't happen at all of them yes as I
said if you have a PCI bus complained

759
01:02:09,060 --> 01:02:14,990
that speaks to you may to your physical
memory than the integrity of the system

760
01:02:14,990 --> 01:02:20,029
is so much compromise some stuff is
still going to be verified by signatures

761
01:02:20,030 --> 01:02:24,290
but you could patch the verification
code in memory for example without

762
01:02:24,290 --> 01:02:30,790
affecting the TPM is immense and so on
so it does not have against attacks but

763
01:02:30,790 --> 01:02:39,730
there was this mailbox is actually does
don't expose PCI bus so to add PCI

764
01:02:39,730 --> 01:02:44,080
hardware implants into this laptop
mainboard you actually have to very

765
01:02:44,080 --> 01:02:48,120
carefully drill into the left of the
main bar to access the trends of the PCI

766
01:02:48,120 --> 01:02:55,839
bus which is very cumbersome attack and
also disagree just in these things right

767
01:02:55,840 --> 01:03:00,320
so if you have a very very flat have
complained and you have the time to

768
01:03:00,320 --> 01:03:02,170
actually very

769
01:03:02,170 --> 01:03:06,520
carefully adjust the the laptop under a
drilling saddam that doesn't destroy

770
01:03:06,520 --> 01:03:11,009
other traces the mainboard it's possible
this is this is not like government

771
01:03:11,010 --> 01:03:16,010
grade but Alice yes exactly so this is
this is not a hundred percent tamper

772
01:03:16,010 --> 01:03:20,010
proof but at that point it's probably
easier to just get different laptop just

773
01:03:20,010 --> 01:03:25,090
looks like he also so I mean what you
could do is take a laptop that has been

774
01:03:25,090 --> 01:03:29,270
prepared and swept over there sixty so
you still have the same petition but you

775
01:03:29,270 --> 01:03:32,870
have already prepared the other little
pride and at that point I mean if you if

776
01:03:32,870 --> 01:03:35,529
you don't even know anymore what system
you have in your hand then you kind of

777
01:03:35,530 --> 01:03:39,320
screwed anyway and then again the
simplest rate Darius you know my wife

778
01:03:39,320 --> 01:03:43,800
has awesome battery pink nail polish but
maybe it's a big maybe it's green I

779
01:03:43,800 --> 01:03:51,610
won't tell you so you know you have some
you know how tempering prevention but of

780
01:03:51,610 --> 01:03:57,270
course this is the basic idea else it's
very convenient for governments at this

781
01:03:57,270 --> 01:04:02,050
point to take your network Dell laptop
provide an appliance and a manual for

782
01:04:02,050 --> 01:04:07,720
customs border officer understand shit
on computers just as many this year but

783
01:04:07,720 --> 01:04:10,730
that bloodier than you turn on their
minds and you left us implanted right

784
01:04:10,730 --> 01:04:15,620
that's it's possible these days and
supplies right this very soon as to have

785
01:04:15,620 --> 01:04:20,480
at some customized you need some action
Commission on site to the implantation

786
01:04:20,480 --> 01:04:26,390
and that raises so much as long as soon
as Ahmadinejad inevitably find anyone

787
01:04:26,390 --> 01:04:28,370
anyone

788
01:04:28,370 --> 01:04:38,930
yeah I use a travel a lot and I thought
last night was awesome

