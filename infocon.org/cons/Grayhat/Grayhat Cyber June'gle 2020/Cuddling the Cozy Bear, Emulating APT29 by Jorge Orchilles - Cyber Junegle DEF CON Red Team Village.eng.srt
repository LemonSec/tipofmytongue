1
00:00:01,280 --> 00:00:03,600
all right we're back live and

2
00:00:03,600 --> 00:00:06,319
thank you again jorge for supporting the

3
00:00:06,319 --> 00:00:08,240
def con rating village and also for

4
00:00:08,240 --> 00:00:10,719
texas cyber summit in this event and i

5
00:00:10,719 --> 00:00:12,080
thank you for supporting the community

6
00:00:12,080 --> 00:00:12,960
overall

7
00:00:12,960 --> 00:00:14,639
and without further ado please take it

8
00:00:14,639 --> 00:00:16,079
away thank you

9
00:00:16,079 --> 00:00:19,920
thank you very much and welcome everyone

10
00:00:19,920 --> 00:00:23,600
happy saturday or maybe sunday depending

11
00:00:23,600 --> 00:00:23,840
on

12
00:00:23,840 --> 00:00:26,480
where you're watching from or what time

13
00:00:26,480 --> 00:00:28,160
i know this can be recorded

14
00:00:28,160 --> 00:00:30,880
appreciate you taking some time with us

15
00:00:30,880 --> 00:00:31,679
and

16
00:00:31,679 --> 00:00:34,880
thank you thank you thank you to

17
00:00:34,880 --> 00:00:38,719
um the red team village to all the folks

18
00:00:38,719 --> 00:00:41,520
putting this together to the sponsors

19
00:00:41,520 --> 00:00:43,200
uh thank you all very much we really

20
00:00:43,200 --> 00:00:44,800
appreciate this always

21
00:00:44,800 --> 00:00:48,640
love giving back to the community today

22
00:00:48,640 --> 00:00:50,879
we are going to talk about cuddling with

23
00:00:50,879 --> 00:00:52,480
the cozy bear

24
00:00:52,480 --> 00:00:55,840
or emulating apt-29 but i know that

25
00:00:55,840 --> 00:00:57,120
doesn't sound as

26
00:00:57,120 --> 00:00:59,680
fun right i know everyone wants to give

27
00:00:59,680 --> 00:01:00,879
a big

28
00:01:00,879 --> 00:01:03,440
bear just a hug and cuddle with that

29
00:01:03,440 --> 00:01:04,239
bear

30
00:01:04,239 --> 00:01:06,720
and um of course i joke we're talking

31
00:01:06,720 --> 00:01:07,520
about

32
00:01:07,520 --> 00:01:10,000
a russian bread actor here right where

33
00:01:10,000 --> 00:01:11,840
no one really wants to cuddle with them

34
00:01:11,840 --> 00:01:13,680
so we're going to talk about that

35
00:01:13,680 --> 00:01:16,320
um you can see there our first intro

36
00:01:16,320 --> 00:01:17,360
picture

37
00:01:17,360 --> 00:01:20,080
on the bottom right here of a nice

38
00:01:20,080 --> 00:01:21,520
little cozy bear

39
00:01:21,520 --> 00:01:24,880
i am george ortiz i am on twitter

40
00:01:24,880 --> 00:01:28,560
um on discord talk to me i see you

41
00:01:28,560 --> 00:01:31,360
hi clint hi everyone else that is on

42
00:01:31,360 --> 00:01:32,000
there

43
00:01:32,000 --> 00:01:33,840
um let me know i have another window

44
00:01:33,840 --> 00:01:35,840
down here we have questions

45
00:01:35,840 --> 00:01:38,079
put those questions as we go it's how i

46
00:01:38,079 --> 00:01:40,640
like to interact with you in this

47
00:01:40,640 --> 00:01:43,119
uh fully virtual world where we can't

48
00:01:43,119 --> 00:01:43,840
cuddle with

49
00:01:43,840 --> 00:01:46,880
anybody uh outside our homes right

50
00:01:46,880 --> 00:01:49,920
so just real quick uh who

51
00:01:49,920 --> 00:01:53,520
am i this is technique1033 system owner

52
00:01:53,520 --> 00:01:55,920
user discovery if you follow miter

53
00:01:55,920 --> 00:01:57,920
attack you know what i'm talking about

54
00:01:57,920 --> 00:01:59,840
um and we'll talk about that more here

55
00:01:59,840 --> 00:02:01,600
but this is a technique where you figure

56
00:02:01,600 --> 00:02:02,719
out who

57
00:02:02,719 --> 00:02:04,640
who you are when you compromise the

58
00:02:04,640 --> 00:02:05,759
system well

59
00:02:05,759 --> 00:02:08,639
i am georgiochi as as as i said i'm on

60
00:02:08,639 --> 00:02:09,440
twitter

61
00:02:09,440 --> 00:02:12,800
at georgiochias also on linkedin connect

62
00:02:12,800 --> 00:02:13,599
with me let's

63
00:02:13,599 --> 00:02:15,920
continue this conversation beyond just

64
00:02:15,920 --> 00:02:17,440
this uh one hour

65
00:02:17,440 --> 00:02:19,840
i'm the chief technology officer at an

66
00:02:19,840 --> 00:02:22,239
awesome startup called site we're the

67
00:02:22,239 --> 00:02:22,720
ones

68
00:02:22,720 --> 00:02:25,920
with the unicorns so we

69
00:02:25,920 --> 00:02:29,360
create adversary emulation

70
00:02:29,360 --> 00:02:31,920
software and it's awesome stuff i'm not

71
00:02:31,920 --> 00:02:33,360
going to talk about that here because i

72
00:02:33,360 --> 00:02:34,560
know you're not here for marketing

73
00:02:34,560 --> 00:02:36,080
you're here to learn stuff

74
00:02:36,080 --> 00:02:38,560
so we do really believe in giving back

75
00:02:38,560 --> 00:02:40,080
to a community that's why i said

76
00:02:40,080 --> 00:02:42,560
thank you so much to the folks doing

77
00:02:42,560 --> 00:02:43,920
this

78
00:02:43,920 --> 00:02:46,560
and let's continue to give back to

79
00:02:46,560 --> 00:02:48,080
community one of the ways that we did

80
00:02:48,080 --> 00:02:48,480
that

81
00:02:48,480 --> 00:02:50,800
is with the c2 matrix the command and

82
00:02:50,800 --> 00:02:51,920
control matrix

83
00:02:51,920 --> 00:02:53,760
it's one of the co-creators along with

84
00:02:53,760 --> 00:02:55,200
bryson bohr and

85
00:02:55,200 --> 00:02:58,959
adam and everyone else um

86
00:02:58,959 --> 00:03:00,560
and you can contribute to we're going to

87
00:03:00,560 --> 00:03:02,080
talk about that here

88
00:03:02,080 --> 00:03:05,519
i spent 10 years an entire decade

89
00:03:05,519 --> 00:03:08,720
at a large financial called citigroup

90
00:03:08,720 --> 00:03:11,840
and there started in a small

91
00:03:11,840 --> 00:03:13,599
offensive security team just doing

92
00:03:13,599 --> 00:03:15,200
vulnerability assessment

93
00:03:15,200 --> 00:03:18,879
and that grew we grew into pen testing

94
00:03:18,879 --> 00:03:19,840
we grew into

95
00:03:19,840 --> 00:03:22,319
creating a red team and the purple team

96
00:03:22,319 --> 00:03:23,840
function so a lot of what i'm going to

97
00:03:23,840 --> 00:03:24,560
talk about

98
00:03:24,560 --> 00:03:26,879
i've been able to do an industry there i

99
00:03:26,879 --> 00:03:29,280
also teach for sans i'm a certified sans

100
00:03:29,280 --> 00:03:30,400
instructor

101
00:03:30,400 --> 00:03:32,640
um if you all those with g pens out

102
00:03:32,640 --> 00:03:33,840
there

103
00:03:33,840 --> 00:03:36,720
cheers to you those with gcih those are

104
00:03:36,720 --> 00:03:37,040
uh

105
00:03:37,040 --> 00:03:39,760
my six day classes that i teach i'm also

106
00:03:39,760 --> 00:03:40,080
the

107
00:03:40,080 --> 00:03:43,680
author of a two day red team exercise

108
00:03:43,680 --> 00:03:45,519
and adversary emulation course

109
00:03:45,519 --> 00:03:48,959
actually giving it for the last time

110
00:03:48,959 --> 00:03:52,080
for the foreseeable future on monday and

111
00:03:52,080 --> 00:03:52,959
tuesday so

112
00:03:52,959 --> 00:03:56,000
you have exactly like 20 some hours

113
00:03:56,000 --> 00:03:58,000
to sign up if you want to do that if not

114
00:03:58,000 --> 00:03:59,760
it's available on demand

115
00:03:59,760 --> 00:04:01,519
and then i'll be back teaching after a

116
00:04:01,519 --> 00:04:03,280
couple months the reason for that is

117
00:04:03,280 --> 00:04:05,599
because we are expecting a baby girl

118
00:04:05,599 --> 00:04:07,280
in early july so i'm going to take a

119
00:04:07,280 --> 00:04:08,959
little break um

120
00:04:08,959 --> 00:04:11,920
but we'll be back in a couple months i

121
00:04:11,920 --> 00:04:13,280
also worked on something called the

122
00:04:13,280 --> 00:04:15,200
common vulnerability scoring

123
00:04:15,200 --> 00:04:17,680
system i'm sure you've used it if you've

124
00:04:17,680 --> 00:04:18,320
uh

125
00:04:18,320 --> 00:04:20,959
work in vulnerability space you've seen

126
00:04:20,959 --> 00:04:22,800
vulnerabilities you've scored them

127
00:04:22,800 --> 00:04:24,240
been part of that working group for a

128
00:04:24,240 --> 00:04:26,000
number of years we released version 3

129
00:04:26,000 --> 00:04:27,360
and 3.1

130
00:04:27,360 --> 00:04:29,120
and i'm no longer a voting member

131
00:04:29,120 --> 00:04:31,600
because i left my company but that's

132
00:04:31,600 --> 00:04:34,160
okay i think we figured out that problem

133
00:04:34,160 --> 00:04:36,639
um let's talk more about adversary

134
00:04:36,639 --> 00:04:37,759
emulation

135
00:04:37,759 --> 00:04:39,360
also love giving back to the community

136
00:04:39,360 --> 00:04:40,800
shout out to issa

137
00:04:40,800 --> 00:04:43,280
information system security association

138
00:04:43,280 --> 00:04:44,960
that has honored me with the fellow

139
00:04:44,960 --> 00:04:46,240
designation

140
00:04:46,240 --> 00:04:48,320
and the national security institute i'm

141
00:04:48,320 --> 00:04:50,320
a technologist fellow there this year

142
00:04:50,320 --> 00:04:53,919
so enough about me let's talk about

143
00:04:53,919 --> 00:04:56,560
adversary emulation so what are we

144
00:04:56,560 --> 00:04:57,520
talking about

145
00:04:57,520 --> 00:04:59,919
well i posted on twitter as you can see

146
00:04:59,919 --> 00:05:00,800
over here on the right

147
00:05:00,800 --> 00:05:03,440
again connect with me just interact i'm

148
00:05:03,440 --> 00:05:04,400
a normal

149
00:05:04,400 --> 00:05:06,400
human just like all of you like let's

150
00:05:06,400 --> 00:05:08,080
talk let's connect

151
00:05:08,080 --> 00:05:10,720
let's uh talk about fun stuff and i

152
00:05:10,720 --> 00:05:12,560
literally asked like i need cute bear

153
00:05:12,560 --> 00:05:13,360
pictures

154
00:05:13,360 --> 00:05:15,440
for a presentation and a lot of you

155
00:05:15,440 --> 00:05:17,280
replied so i have a bunch of bear

156
00:05:17,280 --> 00:05:18,160
pictures

157
00:05:18,160 --> 00:05:19,440
um and that's because we're gonna talk

158
00:05:19,440 --> 00:05:21,280
about cozy bear which is a russian

159
00:05:21,280 --> 00:05:22,479
threat actor so

160
00:05:22,479 --> 00:05:23,840
first we're to talk about adversary

161
00:05:23,840 --> 00:05:25,600
emulation then we're going to see bear

162
00:05:25,600 --> 00:05:26,320
pictures

163
00:05:26,320 --> 00:05:27,520
then we're going to talk about cyber

164
00:05:27,520 --> 00:05:29,199
throne intelligence which is very

165
00:05:29,199 --> 00:05:31,520
important when we do adversary emulation

166
00:05:31,520 --> 00:05:33,840
then we're going to see bear pictures

167
00:05:33,840 --> 00:05:35,440
then we're going to create an adversary

168
00:05:35,440 --> 00:05:37,280
emulation plan

169
00:05:37,280 --> 00:05:39,680
and really use mitre attack for a lot of

170
00:05:39,680 --> 00:05:40,479
this

171
00:05:40,479 --> 00:05:42,880
more bear pictures live demos pray to

172
00:05:42,880 --> 00:05:44,240
the demo bears

173
00:05:44,240 --> 00:05:46,560
and then more bear pictures and then

174
00:05:46,560 --> 00:05:47,840
let's talk about a little bit about

175
00:05:47,840 --> 00:05:48,720
defense

176
00:05:48,720 --> 00:05:51,280
because it's not all just about getting

177
00:05:51,280 --> 00:05:52,880
in it's not winning

178
00:05:52,880 --> 00:05:54,720
right if you're not making security

179
00:05:54,720 --> 00:05:56,639
better and yeah more bears

180
00:05:56,639 --> 00:05:59,520
so if you get one commenting out of this

181
00:05:59,520 --> 00:06:00,960
we're talking about bears

182
00:06:00,960 --> 00:06:05,120
so we can't do a red team talk

183
00:06:05,120 --> 00:06:08,240
without debating what red team means

184
00:06:08,240 --> 00:06:10,800
right so i took this from the red team

185
00:06:10,800 --> 00:06:12,720
journal i think it's the best definition

186
00:06:12,720 --> 00:06:15,520
of a red team and yes we know it came

187
00:06:15,520 --> 00:06:16,800
from the military

188
00:06:16,800 --> 00:06:18,639
some will argue that red teaming

189
00:06:18,639 --> 00:06:20,000
actually came all the way

190
00:06:20,000 --> 00:06:23,520
back in catholic church uh times uh joe

191
00:06:23,520 --> 00:06:23,919
vest

192
00:06:23,919 --> 00:06:26,880
has this in his uh awesome book that you

193
00:06:26,880 --> 00:06:28,240
definitely should buy

194
00:06:28,240 --> 00:06:31,039
um and this is playing devil's advocate

195
00:06:31,039 --> 00:06:33,199
or the practice of looking at a problem

196
00:06:33,199 --> 00:06:34,319
or situation

197
00:06:34,319 --> 00:06:37,680
from the perspective of an adversary

198
00:06:37,680 --> 00:06:40,000
and we have goals right our goals are to

199
00:06:40,000 --> 00:06:41,759
make the blue team better

200
00:06:41,759 --> 00:06:44,960
we've kind of matured and evolved

201
00:06:44,960 --> 00:06:46,880
from just finding vulnerabilities and

202
00:06:46,880 --> 00:06:49,440
technology to looking at an organization

203
00:06:49,440 --> 00:06:50,960
holistically

204
00:06:50,960 --> 00:06:54,960
and testing and measuring people process

205
00:06:54,960 --> 00:06:57,759
and technology and we like testing

206
00:06:57,759 --> 00:06:58,880
assumptions right

207
00:06:58,880 --> 00:07:02,160
we hear all the time i believe that we

208
00:07:02,160 --> 00:07:02,560
have

209
00:07:02,560 --> 00:07:04,319
antivirus and that's going to stop us

210
00:07:04,319 --> 00:07:06,000
right and i know you all laugh at that

211
00:07:06,000 --> 00:07:06,639
because

212
00:07:06,639 --> 00:07:08,880
um half the time we're just getting

213
00:07:08,880 --> 00:07:10,400
around it very easily

214
00:07:10,400 --> 00:07:12,960
but they believe uh senior managers

215
00:07:12,960 --> 00:07:13,680
believe

216
00:07:13,680 --> 00:07:16,240
that they're spending a lot of money on

217
00:07:16,240 --> 00:07:17,759
technology

218
00:07:17,759 --> 00:07:19,440
and it's really protecting them and we

219
00:07:19,440 --> 00:07:21,039
just want to test that

220
00:07:21,039 --> 00:07:23,440
is it really protecting you you know you

221
00:07:23,440 --> 00:07:25,520
just can't buy the blinky box

222
00:07:25,520 --> 00:07:27,280
put it in your network and it works

223
00:07:27,280 --> 00:07:28,720
right

224
00:07:28,720 --> 00:07:31,520
so that's what we do um how do we do it

225
00:07:31,520 --> 00:07:33,599
the effort's generally manual

226
00:07:33,599 --> 00:07:35,440
one of the main things about red teaming

227
00:07:35,440 --> 00:07:37,520
is that it's people it's very smart

228
00:07:37,520 --> 00:07:38,160
people

229
00:07:38,160 --> 00:07:39,840
all of you that are red teamers are

230
00:07:39,840 --> 00:07:41,919
brilliant minds

231
00:07:41,919 --> 00:07:43,759
and that is something we're not going to

232
00:07:43,759 --> 00:07:45,680
be able to automate so anyone that tells

233
00:07:45,680 --> 00:07:47,039
you we're automating red team

234
00:07:47,039 --> 00:07:49,440
they're lying we need you there we need

235
00:07:49,440 --> 00:07:50,560
you to think

236
00:07:50,560 --> 00:07:52,560
so it's very manual there's a lot of

237
00:07:52,560 --> 00:07:54,240
tools i'm going to talk about the c2

238
00:07:54,240 --> 00:07:55,120
matrix

239
00:07:55,120 --> 00:07:56,800
and then the frequency really depends on

240
00:07:56,800 --> 00:07:58,879
what you're doing but the biggest thing

241
00:07:58,879 --> 00:08:01,039
is our customer our customers the blue

242
00:08:01,039 --> 00:08:01,840
team right

243
00:08:01,840 --> 00:08:04,000
shout out to ryan o'hara who said that

244
00:08:04,000 --> 00:08:06,560
the only way to do red team wrong

245
00:08:06,560 --> 00:08:10,080
is to not pay attention or not listen to

246
00:08:10,080 --> 00:08:12,160
your blue team

247
00:08:12,160 --> 00:08:15,039
so we do have this thing though where we

248
00:08:15,039 --> 00:08:15,520
have

249
00:08:15,520 --> 00:08:18,400
internal red teams and we have external

250
00:08:18,400 --> 00:08:19,520
red teams

251
00:08:19,520 --> 00:08:22,000
and they operate differently based on

252
00:08:22,000 --> 00:08:23,120
what the objectives are

253
00:08:23,120 --> 00:08:25,039
right an internal red team is going to

254
00:08:25,039 --> 00:08:26,800
do engagements and they're going to

255
00:08:26,800 --> 00:08:28,319
repeat those engagements

256
00:08:28,319 --> 00:08:29,680
and they're going to have to work with a

257
00:08:29,680 --> 00:08:31,280
number of people in the target

258
00:08:31,280 --> 00:08:33,760
organization right this for 10 years

259
00:08:33,760 --> 00:08:35,760
we work with the operating system

260
00:08:35,760 --> 00:08:37,360
engineers we pay

261
00:08:37,360 --> 00:08:39,519
we work with the security operations

262
00:08:39,519 --> 00:08:40,880
center with the

263
00:08:40,880 --> 00:08:43,039
incident response team to make sure that

264
00:08:43,039 --> 00:08:44,800
they can catch

265
00:08:44,800 --> 00:08:47,440
some of our stuff right we have insider

266
00:08:47,440 --> 00:08:48,640
knowledge

267
00:08:48,640 --> 00:08:50,800
and really we should be seen as a

268
00:08:50,800 --> 00:08:52,560
sparring partner

269
00:08:52,560 --> 00:08:55,279
right you never knock out your sparring

270
00:08:55,279 --> 00:08:57,120
partner right everyone's seen the movie

271
00:08:57,120 --> 00:08:58,000
rocky

272
00:08:58,000 --> 00:08:59,680
did their sparring partner ever knock

273
00:08:59,680 --> 00:09:01,839
him down no right they work together

274
00:09:01,839 --> 00:09:03,120
they practice

275
00:09:03,120 --> 00:09:04,720
one gets better the other one gets

276
00:09:04,720 --> 00:09:07,040
better and then when it's time to fight

277
00:09:07,040 --> 00:09:10,720
the big bad bear then you work together

278
00:09:10,720 --> 00:09:12,000
and you fight

279
00:09:12,000 --> 00:09:13,279
external red teams are a little

280
00:09:13,279 --> 00:09:15,279
different but they're awesome right i

281
00:09:15,279 --> 00:09:17,200
have a lot of friends in external red

282
00:09:17,200 --> 00:09:17,680
teams

283
00:09:17,680 --> 00:09:20,399
you all are amazing but it's a different

284
00:09:20,399 --> 00:09:22,240
perspective right you're coming in from

285
00:09:22,240 --> 00:09:23,839
the outside you're learning about this

286
00:09:23,839 --> 00:09:25,120
target environment

287
00:09:25,120 --> 00:09:27,279
depending on the scope you will probably

288
00:09:27,279 --> 00:09:29,360
spend a lot of time figuring out how to

289
00:09:29,360 --> 00:09:31,040
get that initial access

290
00:09:31,040 --> 00:09:33,120
and then once you're in you start going

291
00:09:33,120 --> 00:09:34,800
and you figure things out based on the

292
00:09:34,800 --> 00:09:36,480
objective but you'll look at the entire

293
00:09:36,480 --> 00:09:38,080
organization right

294
00:09:38,080 --> 00:09:40,640
very snapshotty right you're in maybe

295
00:09:40,640 --> 00:09:42,480
even if it's a three-month engagement

296
00:09:42,480 --> 00:09:43,440
that's awesome

297
00:09:43,440 --> 00:09:45,680
but that's a snapshot time for an

298
00:09:45,680 --> 00:09:47,200
organization that's been around

299
00:09:47,200 --> 00:09:50,560
a lot longer right so we've gone to a

300
00:09:50,560 --> 00:09:53,279
point of adversary emulation right

301
00:09:53,279 --> 00:09:56,560
and this is where the red team or

302
00:09:56,560 --> 00:09:57,839
if you don't have a red team you got a

303
00:09:57,839 --> 00:10:00,640
red team tool and you emulate how an

304
00:10:00,640 --> 00:10:01,440
adversary

305
00:10:01,440 --> 00:10:02,880
operates which means you have to

306
00:10:02,880 --> 00:10:04,640
understand that you use cyber threat

307
00:10:04,640 --> 00:10:05,440
intelligence

308
00:10:05,440 --> 00:10:07,440
you understand an adversary it's likely

309
00:10:07,440 --> 00:10:09,920
to target your organization

310
00:10:09,920 --> 00:10:12,240
and then you emulate those same tactics

311
00:10:12,240 --> 00:10:13,959
techniques and procedures right those

312
00:10:13,959 --> 00:10:17,360
ttps with the same objective

313
00:10:17,360 --> 00:10:20,399
as this adversary and it's very

314
00:10:20,399 --> 00:10:22,320
important to do this because

315
00:10:22,320 --> 00:10:24,800
on the red team side you kind of tend to

316
00:10:24,800 --> 00:10:26,560
go full cyber

317
00:10:26,560 --> 00:10:28,480
and you're not really bringing a lot of

318
00:10:28,480 --> 00:10:30,480
these together but if you bring these

319
00:10:30,480 --> 00:10:32,079
attack chains together or these

320
00:10:32,079 --> 00:10:33,440
scenarios

321
00:10:33,440 --> 00:10:36,240
in adversary emulation then you can

322
00:10:36,240 --> 00:10:36,959
actually

323
00:10:36,959 --> 00:10:38,640
defend against these right and we'll

324
00:10:38,640 --> 00:10:40,880
talk about this in a bit but

325
00:10:40,880 --> 00:10:44,399
just running a particular ttp one ttb

326
00:10:44,399 --> 00:10:46,240
it's gonna be very hard to catch right

327
00:10:46,240 --> 00:10:47,760
it's going to be hard to detect maybe

328
00:10:47,760 --> 00:10:49,440
you logged it somewhere

329
00:10:49,440 --> 00:10:52,079
but how much value is that really

330
00:10:52,079 --> 00:10:53,519
bringing right you want to bring these

331
00:10:53,519 --> 00:10:54,560
together and that's why i have the

332
00:10:54,560 --> 00:10:56,320
serial emulations there

333
00:10:56,320 --> 00:10:58,079
you want to understand how prepared the

334
00:10:58,079 --> 00:10:59,360
organization is

335
00:10:59,360 --> 00:11:00,800
most of the time these are manual

336
00:11:00,800 --> 00:11:03,040
engagements and

337
00:11:03,040 --> 00:11:04,880
your customers the entire organization

338
00:11:04,880 --> 00:11:06,399
there you can see the bears you can see

339
00:11:06,399 --> 00:11:08,079
these are actually masks

340
00:11:08,079 --> 00:11:10,079
uh not sure how many people caught that

341
00:11:10,079 --> 00:11:11,600
so shout out to bryson

342
00:11:11,600 --> 00:11:13,839
that uh told me to use this one here i

343
00:11:13,839 --> 00:11:17,040
thought it was uh pretty good

344
00:11:17,120 --> 00:11:18,959
where are you at citigroup during any of

345
00:11:18,959 --> 00:11:20,399
the big breaches

346
00:11:20,399 --> 00:11:24,480
um perhaps

347
00:11:24,640 --> 00:11:28,480
towards a purple team yes the unicorns

348
00:11:28,480 --> 00:11:29,920
and purple right so

349
00:11:29,920 --> 00:11:32,000
you asked my daughter she's six years

350
00:11:32,000 --> 00:11:32,959
old

351
00:11:32,959 --> 00:11:34,640
how do you make purple and it's so

352
00:11:34,640 --> 00:11:36,720
simple right you just mix

353
00:11:36,720 --> 00:11:40,240
red and blue together but what is purple

354
00:11:40,240 --> 00:11:41,839
tv right what's this hotness that

355
00:11:41,839 --> 00:11:43,200
everyone's talking about

356
00:11:43,200 --> 00:11:45,839
well it's not really a team so i don't

357
00:11:45,839 --> 00:11:46,880
think any of you are

358
00:11:46,880 --> 00:11:49,920
in a purple team per se

359
00:11:49,920 --> 00:11:51,360
generally you are in a red team or

360
00:11:51,360 --> 00:11:53,200
you're in a blue team but a purple team

361
00:11:53,200 --> 00:11:54,320
is a virtual team

362
00:11:54,320 --> 00:11:58,000
a functional team that comes together

363
00:11:58,000 --> 00:12:00,399
to measure and improve your defensive

364
00:12:00,399 --> 00:12:01,200
posture

365
00:12:01,200 --> 00:12:04,160
it's a little more efficient based on

366
00:12:04,160 --> 00:12:05,760
your goals and objectives

367
00:12:05,760 --> 00:12:07,680
i'm not saying stop doing red teaming

368
00:12:07,680 --> 00:12:09,680
i'm not saying stop doing blind

369
00:12:09,680 --> 00:12:12,240
or zero knowledge uh red team

370
00:12:12,240 --> 00:12:13,600
engagements i'm not saying

371
00:12:13,600 --> 00:12:15,440
stop your vulnerability assessments or

372
00:12:15,440 --> 00:12:16,959
your vulnerability scanning or your pen

373
00:12:16,959 --> 00:12:17,600
testing

374
00:12:17,600 --> 00:12:19,519
not saying that wrong this is a

375
00:12:19,519 --> 00:12:21,600
different scope different objective

376
00:12:21,600 --> 00:12:24,560
and it works pretty simple you just like

377
00:12:24,560 --> 00:12:25,839
in a red team engagement

378
00:12:25,839 --> 00:12:29,279
you leverage cyber threat intelligence

379
00:12:29,279 --> 00:12:32,480
to understand an adversary that has a

380
00:12:32,480 --> 00:12:33,360
capability

381
00:12:33,360 --> 00:12:35,760
intent and opportunity to attack your

382
00:12:35,760 --> 00:12:36,720
organization

383
00:12:36,720 --> 00:12:39,440
your industry your region then you

384
00:12:39,440 --> 00:12:42,000
create an adversary emulation plan

385
00:12:42,000 --> 00:12:44,720
you work together with your blue teamers

386
00:12:44,720 --> 00:12:45,760
you say hey

387
00:12:45,760 --> 00:12:48,399
this little attack chain we have here do

388
00:12:48,399 --> 00:12:49,839
you think that this will work

389
00:12:49,839 --> 00:12:53,279
or maybe not well we think that

390
00:12:53,279 --> 00:12:55,120
maybe this email will get through

391
00:12:55,120 --> 00:12:57,200
because our controls aren't that good

392
00:12:57,200 --> 00:12:57,680
but

393
00:12:57,680 --> 00:13:00,399
the execution of an exe and that might

394
00:13:00,399 --> 00:13:01,360
not work

395
00:13:01,360 --> 00:13:04,320
well good document that and then

396
00:13:04,320 --> 00:13:04,880
actually

397
00:13:04,880 --> 00:13:08,240
emulate like hands-on keyboard execute a

398
00:13:08,240 --> 00:13:10,160
payload on a target system

399
00:13:10,160 --> 00:13:11,920
and see what happens have the blue team

400
00:13:11,920 --> 00:13:13,839
go after and see if they find these

401
00:13:13,839 --> 00:13:16,000
behaviors and then work together and

402
00:13:16,000 --> 00:13:17,760
create a remediation plan

403
00:13:17,760 --> 00:13:19,920
so again testing and repeating these

404
00:13:19,920 --> 00:13:20,880
exercises

405
00:13:20,880 --> 00:13:26,000
between people process and technology

406
00:13:27,680 --> 00:13:30,639
so yes purple is the new hotness you can

407
00:13:30,639 --> 00:13:31,440
see there

408
00:13:31,440 --> 00:13:34,000
on our memes and lots of memes i did a

409
00:13:34,000 --> 00:13:35,040
whole talk on this

410
00:13:35,040 --> 00:13:38,079
on how to go from blah

411
00:13:38,079 --> 00:13:40,320
from zero knowledge red teaming to a

412
00:13:40,320 --> 00:13:41,199
purple team

413
00:13:41,199 --> 00:13:43,440
especially in an organization where the

414
00:13:43,440 --> 00:13:45,680
red team kind of punched the blue team

415
00:13:45,680 --> 00:13:46,880
too many times and

416
00:13:46,880 --> 00:13:50,240
the eye and they didn't like us

417
00:13:50,240 --> 00:13:53,279
so how do you fix that situation it's

418
00:13:53,279 --> 00:13:54,399
important to fix it

419
00:13:54,399 --> 00:13:58,160
because like ryan o'hara said right

420
00:13:58,160 --> 00:14:01,680
it's important to care about the blue

421
00:14:01,680 --> 00:14:04,079
team it's not just about giving them

422
00:14:04,079 --> 00:14:06,800
a red eye or breaking them or knocking

423
00:14:06,800 --> 00:14:07,839
them out

424
00:14:07,839 --> 00:14:10,959
it is giving value so

425
00:14:10,959 --> 00:14:13,120
for all of this we need frameworks i

426
00:14:13,120 --> 00:14:14,959
know i lose half of you on this part but

427
00:14:14,959 --> 00:14:16,000
frameworks are so

428
00:14:16,000 --> 00:14:20,240
important the cyber kill chain

429
00:14:20,240 --> 00:14:22,000
any of you have a drink in your hand i

430
00:14:22,000 --> 00:14:25,199
know that's a time to drink

431
00:14:25,199 --> 00:14:28,399
and we give the kill chain a lot of crap

432
00:14:28,399 --> 00:14:31,600
right because it's not really the seven

433
00:14:31,600 --> 00:14:34,720
steps that attackers do is it but

434
00:14:34,720 --> 00:14:36,959
you know what the kill chain did the

435
00:14:36,959 --> 00:14:38,240
kill chin

436
00:14:38,240 --> 00:14:40,560
got this in front of a lot of seniors a

437
00:14:40,560 --> 00:14:42,800
lot of executives a lot of people that

438
00:14:42,800 --> 00:14:44,560
didn't really understand

439
00:14:44,560 --> 00:14:46,320
what was happening and said this is how

440
00:14:46,320 --> 00:14:47,680
an attacker works

441
00:14:47,680 --> 00:14:49,760
paul pauls then came and created this

442
00:14:49,760 --> 00:14:51,680
awesome unified cyber kill chain

443
00:14:51,680 --> 00:14:55,199
which was like more realistic of what

444
00:14:55,199 --> 00:14:58,320
what really malicious actors do and then

445
00:14:58,320 --> 00:15:00,160
of course if you're in a financial which

446
00:15:00,160 --> 00:15:02,160
again i spent a lot of years there we

447
00:15:02,160 --> 00:15:03,760
have a lot of regulations

448
00:15:03,760 --> 00:15:06,000
um i had the benefit of working at an

449
00:15:06,000 --> 00:15:07,040
organization that

450
00:15:07,040 --> 00:15:09,199
was in over 100 countries and like

451
00:15:09,199 --> 00:15:11,279
everyone plus their mom

452
00:15:11,279 --> 00:15:13,680
their art their cousin they all

453
00:15:13,680 --> 00:15:15,440
regulated us so we had a lot of

454
00:15:15,440 --> 00:15:17,040
regulations to figure out

455
00:15:17,040 --> 00:15:18,959
to work with the bank of england work

456
00:15:18,959 --> 00:15:20,880
with the european central bank

457
00:15:20,880 --> 00:15:23,120
the monetary authority of singapore the

458
00:15:23,120 --> 00:15:24,959
hong kong monetary authority they all

459
00:15:24,959 --> 00:15:27,600
had these awesome frameworks for doing

460
00:15:27,600 --> 00:15:31,519
this threat led type of engagement

461
00:15:31,519 --> 00:15:33,920
and of course because there was weren't

462
00:15:33,920 --> 00:15:34,880
that many

463
00:15:34,880 --> 00:15:36,959
frameworks we created another framework

464
00:15:36,959 --> 00:15:38,240
and that's the last one here the

465
00:15:38,240 --> 00:15:40,639
framework for the regulatory use of pen

466
00:15:40,639 --> 00:15:42,399
testing in the financial services

467
00:15:42,399 --> 00:15:43,199
industry

468
00:15:43,199 --> 00:15:45,120
and really just very quick it's here on

469
00:15:45,120 --> 00:15:46,480
the right that's what we're going to

470
00:15:46,480 --> 00:15:47,920
talk about today

471
00:15:47,920 --> 00:15:50,000
threat intelligence first figure out

472
00:15:50,000 --> 00:15:51,199
your organization

473
00:15:51,199 --> 00:15:52,839
if you're not doing vulnerability

474
00:15:52,839 --> 00:15:54,560
assessment if you want to be

475
00:15:54,560 --> 00:15:56,000
scanning if you're not doing pen tests

476
00:15:56,000 --> 00:15:57,839
if you have no idea of what assets you

477
00:15:57,839 --> 00:15:59,440
have in your organization

478
00:15:59,440 --> 00:16:00,959
if you don't know what software you have

479
00:16:00,959 --> 00:16:03,360
running if you're not patching

480
00:16:03,360 --> 00:16:05,440
red teaming and adversarial emulation

481
00:16:05,440 --> 00:16:06,959
may not be for you

482
00:16:06,959 --> 00:16:09,120
you probably need to do some of the

483
00:16:09,120 --> 00:16:11,120
basics first

484
00:16:11,120 --> 00:16:14,079
but if you think you're right okay let's

485
00:16:14,079 --> 00:16:15,519
talk about threat actor that's

486
00:16:15,519 --> 00:16:16,880
likely to attack you that's probably

487
00:16:16,880 --> 00:16:18,800
attacking you right now let's learn

488
00:16:18,800 --> 00:16:20,240
about it let's use cyber clear

489
00:16:20,240 --> 00:16:20,959
intelligence

490
00:16:20,959 --> 00:16:23,680
let's plan an exercise around this

491
00:16:23,680 --> 00:16:25,040
whether it's purple d

492
00:16:25,040 --> 00:16:27,360
red team and then let's test them for

493
00:16:27,360 --> 00:16:29,519
that we use miter attack right so

494
00:16:29,519 --> 00:16:32,480
cheers i said miter attack uh i said it

495
00:16:32,480 --> 00:16:36,399
twice so take your drink

496
00:16:36,399 --> 00:16:38,800
and we use that framework as a common

497
00:16:38,800 --> 00:16:39,839
knowledge

498
00:16:39,839 --> 00:16:43,920
to then emulate a particular adversary

499
00:16:43,920 --> 00:16:46,079
get in you know the fun stuff you like

500
00:16:46,079 --> 00:16:47,120
to do

501
00:16:47,120 --> 00:16:49,519
and then show value and that's the

502
00:16:49,519 --> 00:16:50,160
closure

503
00:16:50,160 --> 00:16:53,360
part the exercise closure so here's your

504
00:16:53,360 --> 00:16:54,880
miter attack i

505
00:16:54,880 --> 00:16:57,360
hope everyone knows what this is by now

506
00:16:57,360 --> 00:16:58,880
right

507
00:16:58,880 --> 00:17:02,000
adversary tactics techniques and common

508
00:17:02,000 --> 00:17:02,880
knowledge

509
00:17:02,880 --> 00:17:04,880
it was really a common not it's a common

510
00:17:04,880 --> 00:17:05,919
language

511
00:17:05,919 --> 00:17:08,880
that allows red teamers blue teamers and

512
00:17:08,880 --> 00:17:10,319
cyber threat intelligence folks

513
00:17:10,319 --> 00:17:13,199
to all speak the same language right

514
00:17:13,199 --> 00:17:14,480
something can happen

515
00:17:14,480 --> 00:17:16,799
some incident response forensic scheme

516
00:17:16,799 --> 00:17:17,599
goes in

517
00:17:17,599 --> 00:17:19,919
they find out what certain particular

518
00:17:19,919 --> 00:17:20,959
actor did

519
00:17:20,959 --> 00:17:22,880
and they map it back to these tactics

520
00:17:22,880 --> 00:17:24,240
techniques and procedures

521
00:17:24,240 --> 00:17:26,799
in the top row you have your tactics

522
00:17:26,799 --> 00:17:28,480
these are the high level goals of the

523
00:17:28,480 --> 00:17:29,760
adversary

524
00:17:29,760 --> 00:17:31,760
and then under them you have techniques

525
00:17:31,760 --> 00:17:33,360
and then each technique has

526
00:17:33,360 --> 00:17:36,400
multiple procedures now this is not

527
00:17:36,400 --> 00:17:39,520
a bingo card not bingo we're not playing

528
00:17:39,520 --> 00:17:41,120
bingo i know it's saturday night for

529
00:17:41,120 --> 00:17:41,919
some of you

530
00:17:41,919 --> 00:17:45,280
this is not bingo you are not just like

531
00:17:45,280 --> 00:17:48,559
checking off like oh i can detect this

532
00:17:48,559 --> 00:17:51,200
and i can detect that that's great but

533
00:17:51,200 --> 00:17:51,600
you

534
00:17:51,600 --> 00:17:54,720
will never get to 100 right like that is

535
00:17:54,720 --> 00:17:55,039
just

536
00:17:55,039 --> 00:17:57,360
part of this we know that all these

537
00:17:57,360 --> 00:17:58,720
things are possible

538
00:17:58,720 --> 00:18:00,720
we want to put them together in an

539
00:18:00,720 --> 00:18:02,720
attack chain or attack scenario

540
00:18:02,720 --> 00:18:05,919
and then see if we can detect those

541
00:18:05,919 --> 00:18:09,280
so an awesome thing that mitre did is

542
00:18:09,280 --> 00:18:11,520
attack evaluations and this seems to be

543
00:18:11,520 --> 00:18:13,600
like everyone knows about minor attack

544
00:18:13,600 --> 00:18:14,960
but not many of you know about the

545
00:18:14,960 --> 00:18:17,280
evaluation you haven't looked at them

546
00:18:17,280 --> 00:18:20,640
so please do look at that shout out to

547
00:18:20,640 --> 00:18:23,840
mitre team right frank adam

548
00:18:23,840 --> 00:18:27,039
jamie uh john richard

549
00:18:27,039 --> 00:18:29,440
all of you awesome awesome stuff and all

550
00:18:29,440 --> 00:18:31,360
the folks that have left mitre

551
00:18:31,360 --> 00:18:34,160
you've all done awesome as well right

552
00:18:34,160 --> 00:18:34,720
blake

553
00:18:34,720 --> 00:18:38,480
and katie nichols and all of you folks

554
00:18:38,480 --> 00:18:40,799
did awesome awesome work we thank you so

555
00:18:40,799 --> 00:18:41,600
much

556
00:18:41,600 --> 00:18:43,039
and that's what we're going to actually

557
00:18:43,039 --> 00:18:45,360
base most of this talk on because

558
00:18:45,360 --> 00:18:49,440
i wanted to emulate cozy bear

559
00:18:49,440 --> 00:18:51,039
he's over there on the right looks so

560
00:18:51,039 --> 00:18:52,559
cute isn't he

561
00:18:52,559 --> 00:18:56,480
and my attack did this for us in what

562
00:18:56,480 --> 00:18:58,080
they call evaluations

563
00:18:58,080 --> 00:19:00,240
see what they do is they first make a

564
00:19:00,240 --> 00:19:01,360
call out for

565
00:19:01,360 --> 00:19:03,520
cyber threat intelligence they say

566
00:19:03,520 --> 00:19:05,200
please give a cyber threat intelligence

567
00:19:05,200 --> 00:19:06,720
about this particular actor

568
00:19:06,720 --> 00:19:09,679
they chose cozy bear then let's create

569
00:19:09,679 --> 00:19:11,760
this adversary emulation plan

570
00:19:11,760 --> 00:19:14,559
and let's test a bunch of controls a

571
00:19:14,559 --> 00:19:16,240
bunch of security products

572
00:19:16,240 --> 00:19:18,480
and i actually didn't check the list of

573
00:19:18,480 --> 00:19:20,880
sponsors so if you're on there

574
00:19:20,880 --> 00:19:23,840
this is not a win or lose we don't you

575
00:19:23,840 --> 00:19:25,360
there's no winner

576
00:19:25,360 --> 00:19:27,600
there's no rankings there's no ratings

577
00:19:27,600 --> 00:19:29,600
there's no score

578
00:19:29,600 --> 00:19:31,520
right so it's nice because i don't talk

579
00:19:31,520 --> 00:19:33,039
bad about any vendor

580
00:19:33,039 --> 00:19:35,600
and we see what they can do what can

581
00:19:35,600 --> 00:19:36,400
they detect

582
00:19:36,400 --> 00:19:38,559
because like i said you can't just like

583
00:19:38,559 --> 00:19:40,720
pull this security product and put it in

584
00:19:40,720 --> 00:19:41,600
your environment

585
00:19:41,600 --> 00:19:44,000
and all of a sudden you're secure right

586
00:19:44,000 --> 00:19:45,520
it's like compliance you're not

587
00:19:45,520 --> 00:19:47,360
compliant just because you're using a

588
00:19:47,360 --> 00:19:48,640
compliant system

589
00:19:48,640 --> 00:19:50,240
right you actually have to make sure

590
00:19:50,240 --> 00:19:52,400
that the process is there

591
00:19:52,400 --> 00:19:55,200
so minor attack is awesome attack

592
00:19:55,200 --> 00:19:56,320
evaluations is

593
00:19:56,320 --> 00:19:58,160
even more awesome that's what we're

594
00:19:58,160 --> 00:20:01,120
gonna uh focus on today

595
00:20:01,120 --> 00:20:03,360
so a word about threat intelligence and

596
00:20:03,360 --> 00:20:04,320
again

597
00:20:04,320 --> 00:20:07,440
another buzzword george ah you're making

598
00:20:07,440 --> 00:20:08,640
me drink too much

599
00:20:08,640 --> 00:20:11,840
the pyramid of pain

600
00:20:13,360 --> 00:20:16,559
what is the pyramid of pain well

601
00:20:16,559 --> 00:20:19,520
shout out to david bianco created this

602
00:20:19,520 --> 00:20:20,799
this is

603
00:20:20,799 --> 00:20:22,080
different types of cyber threat

604
00:20:22,080 --> 00:20:24,640
intelligence now yeah you're all red

605
00:20:24,640 --> 00:20:26,880
you might not know about the blue team

606
00:20:26,880 --> 00:20:27,840
side but

607
00:20:27,840 --> 00:20:29,679
cyber throne intelligence on a blue team

608
00:20:29,679 --> 00:20:32,080
side is a number of things

609
00:20:32,080 --> 00:20:33,760
but we can actually use this for red

610
00:20:33,760 --> 00:20:36,559
team so here we go

611
00:20:36,559 --> 00:20:39,440
the bottom of the pyramid we have hash

612
00:20:39,440 --> 00:20:40,720
batteries right

613
00:20:40,720 --> 00:20:43,039
antivirus works like this right there's

614
00:20:43,039 --> 00:20:44,000
a bad

615
00:20:44,000 --> 00:20:47,039
malware out there there's a hash for it

616
00:20:47,039 --> 00:20:49,280
it gets updated in your av signature and

617
00:20:49,280 --> 00:20:50,480
then it gets stopped

618
00:20:50,480 --> 00:20:54,400
wow magic right now

619
00:20:54,400 --> 00:20:57,679
pretty trivial it's also trivial

620
00:20:57,679 --> 00:21:00,400
for a red team or a malicious adversary

621
00:21:00,400 --> 00:21:01,440
right

622
00:21:01,440 --> 00:21:03,120
hope everything you're doing is with

623
00:21:03,120 --> 00:21:05,600
permission

624
00:21:05,600 --> 00:21:07,440
what can they do they can change the

625
00:21:07,440 --> 00:21:08,640
hash value

626
00:21:08,640 --> 00:21:11,120
so easily trivially right like just

627
00:21:11,120 --> 00:21:12,400
change one bit

628
00:21:12,400 --> 00:21:15,280
and your hash value changes how about ip

629
00:21:15,280 --> 00:21:16,799
addresses and domain names

630
00:21:16,799 --> 00:21:18,559
those are pretty easy too right most of

631
00:21:18,559 --> 00:21:20,240
you use if you're a red teaming

632
00:21:20,240 --> 00:21:23,200
you are using cloud infrastructure for

633
00:21:23,200 --> 00:21:23,760
this

634
00:21:23,760 --> 00:21:27,039
it's like three clicks maybe to change

635
00:21:27,039 --> 00:21:28,799
your ip address

636
00:21:28,799 --> 00:21:30,880
to buy a domain it's going to cost you

637
00:21:30,880 --> 00:21:32,080
about 14

638
00:21:32,080 --> 00:21:34,799
right pretty simple but then as you

639
00:21:34,799 --> 00:21:37,039
start working away up the pyramid

640
00:21:37,039 --> 00:21:40,159
both for a defender

641
00:21:40,159 --> 00:21:42,880
to catch this particular type of threat

642
00:21:42,880 --> 00:21:44,159
intelligence and

643
00:21:44,159 --> 00:21:47,280
for an attacker to modify it

644
00:21:47,280 --> 00:21:51,360
it gets annoying challenging and tough

645
00:21:51,360 --> 00:21:54,400
but what we want to focus on as red team

646
00:21:54,400 --> 00:21:57,919
as adversary emulators right is the top

647
00:21:57,919 --> 00:21:59,760
the adversary behaviors

648
00:21:59,760 --> 00:22:02,880
their tactics techniques and procedures

649
00:22:02,880 --> 00:22:04,480
and that's our focus here we're going to

650
00:22:04,480 --> 00:22:05,840
talk about some tools i'm going to show

651
00:22:05,840 --> 00:22:07,440
you some tools i'm going to live demo

652
00:22:07,440 --> 00:22:08,320
some tools

653
00:22:08,320 --> 00:22:11,440
but tools can change

654
00:22:11,440 --> 00:22:13,679
and just detecting a tool doesn't mean

655
00:22:13,679 --> 00:22:15,760
you get to check that box

656
00:22:15,760 --> 00:22:19,039
on miter attack

657
00:22:19,520 --> 00:22:21,440
so who are we talking about we're

658
00:22:21,440 --> 00:22:22,640
talking about cozy

659
00:22:22,640 --> 00:22:25,120
bear cozy bear you've probably heard

660
00:22:25,120 --> 00:22:26,559
about it if you've

661
00:22:26,559 --> 00:22:29,280
read anything in the news in the united

662
00:22:29,280 --> 00:22:31,760
states of america i apologize news is

663
00:22:31,760 --> 00:22:34,480
horrible for those uh internationally

664
00:22:34,480 --> 00:22:35,919
hearing about the united states on the

665
00:22:35,919 --> 00:22:36,320
news

666
00:22:36,320 --> 00:22:38,559
i also apologize to you it's it's never

667
00:22:38,559 --> 00:22:40,320
good i'm from florida

668
00:22:40,320 --> 00:22:42,640
like there's never anything good coming

669
00:22:42,640 --> 00:22:43,520
out of florida

670
00:22:43,520 --> 00:22:45,200
we have florida man if you've never

671
00:22:45,200 --> 00:22:47,039
heard of florida man like

672
00:22:47,039 --> 00:22:48,400
i think that's actually good don't

673
00:22:48,400 --> 00:22:49,840
google florida man you don't want to

674
00:22:49,840 --> 00:22:52,240
know about florida man but it's like

675
00:22:52,240 --> 00:22:55,200
all this stuff is just happening right

676
00:22:55,200 --> 00:22:55,919
we went full

677
00:22:55,919 --> 00:22:59,440
2020 this year so cozy bear what's cozy

678
00:22:59,440 --> 00:22:59,919
bear

679
00:22:59,919 --> 00:23:02,960
threat actor attributed to the russian

680
00:23:02,960 --> 00:23:03,600
government

681
00:23:03,600 --> 00:23:08,159
and most likely reportedly attributed to

682
00:23:08,159 --> 00:23:10,960
based on who you talk to compromise the

683
00:23:10,960 --> 00:23:11,840
democratic

684
00:23:11,840 --> 00:23:14,720
national committee in 2015 right before

685
00:23:14,720 --> 00:23:16,960
elections right

686
00:23:16,960 --> 00:23:20,080
they are a group that was known to be

687
00:23:20,080 --> 00:23:21,520
pretty stealthy

688
00:23:21,520 --> 00:23:24,480
pretty sophisticated had some pretty

689
00:23:24,480 --> 00:23:26,559
cool techniques had a new technique

690
00:23:26,559 --> 00:23:29,039
that we'll see if the demo works for it

691
00:23:29,039 --> 00:23:30,080
um called

692
00:23:30,080 --> 00:23:33,280
time stomping scheduled tests um

693
00:23:33,280 --> 00:23:35,360
i also saw nick carr today on twitter

694
00:23:35,360 --> 00:23:37,200
shout out to you

695
00:23:37,200 --> 00:23:40,000
he's gonna talk tomorrow but uh he

696
00:23:40,000 --> 00:23:41,679
actually confirmed that cozy bear was

697
00:23:41,679 --> 00:23:43,360
the first one to do this

698
00:23:43,360 --> 00:23:45,360
and of course thank you miter over on

699
00:23:45,360 --> 00:23:46,880
the right for providing

700
00:23:46,880 --> 00:23:50,320
such cool pictures so cozy bear

701
00:23:50,320 --> 00:23:51,760
and then of course there's a lot of

702
00:23:51,760 --> 00:23:53,440
bears so if you haven't heard

703
00:23:53,440 --> 00:23:56,720
about all these bears pretty much if you

704
00:23:56,720 --> 00:23:57,279
hear

705
00:23:57,279 --> 00:24:00,559
an adversary name that they are a bear

706
00:24:00,559 --> 00:24:02,720
that means that they are russian so you

707
00:24:02,720 --> 00:24:04,320
have different types of bears here

708
00:24:04,320 --> 00:24:06,240
you have the black bear the brown bear

709
00:24:06,240 --> 00:24:07,360
the polar bear

710
00:24:07,360 --> 00:24:10,000
of course the cozy bear and thank you

711
00:24:10,000 --> 00:24:13,200
jamie for this picture

712
00:24:13,630 --> 00:24:15,919
[Music]

713
00:24:15,919 --> 00:24:18,880
of course identifying what kind of bears

714
00:24:18,880 --> 00:24:21,360
in your network is not as easy

715
00:24:21,360 --> 00:24:25,120
as this chart it's not just about what

716
00:24:25,120 --> 00:24:26,720
they look like you gotta go a little

717
00:24:26,720 --> 00:24:28,320
deeper

718
00:24:28,320 --> 00:24:30,880
so we like using attack navigator this

719
00:24:30,880 --> 00:24:32,159
is another

720
00:24:32,159 --> 00:24:35,120
awesome awesome resource from mitre

721
00:24:35,120 --> 00:24:35,919
attack and

722
00:24:35,919 --> 00:24:37,360
as you can see i really like mitre

723
00:24:37,360 --> 00:24:39,520
attack little bias of one of the

724
00:24:39,520 --> 00:24:41,279
founding members of their new

725
00:24:41,279 --> 00:24:44,720
ingenuity um center

726
00:24:44,720 --> 00:24:46,880
which actually sponsors minor attack and

727
00:24:46,880 --> 00:24:48,159
a bunch of other things

728
00:24:48,159 --> 00:24:50,720
so love them love what they're doing

729
00:24:50,720 --> 00:24:52,480
attack navigator

730
00:24:52,480 --> 00:24:55,760
this site that you can either run inside

731
00:24:55,760 --> 00:24:56,960
your environment

732
00:24:56,960 --> 00:25:00,000
or you can run just on a github page and

733
00:25:00,000 --> 00:25:02,799
interact with it that tags the different

734
00:25:02,799 --> 00:25:05,679
ttps used by a particular thread actor

735
00:25:05,679 --> 00:25:09,039
so in this case this is cozy bear

736
00:25:09,039 --> 00:25:11,600
these are all the things that cozy bear

737
00:25:11,600 --> 00:25:13,679
was known to do based on the cyber

738
00:25:13,679 --> 00:25:17,360
intelligence that was provided to mitre

739
00:25:17,360 --> 00:25:19,919
when they had the call for this so if

740
00:25:19,919 --> 00:25:20,960
you're gonna start

741
00:25:20,960 --> 00:25:24,000
creating kind of a plan you now have an

742
00:25:24,000 --> 00:25:25,760
idea

743
00:25:25,760 --> 00:25:28,080
of what this malicious actor was doing

744
00:25:28,080 --> 00:25:29,840
and you can kind of start coming up with

745
00:25:29,840 --> 00:25:30,480
a

746
00:25:30,480 --> 00:25:34,960
plan so planning is important

747
00:25:34,960 --> 00:25:36,640
you have your goals and objectives just

748
00:25:36,640 --> 00:25:38,799
like malicious actors have their goals

749
00:25:38,799 --> 00:25:41,520
and objectives

750
00:25:41,520 --> 00:25:43,520
what are your goals as objectives as a

751
00:25:43,520 --> 00:25:45,520
red team remember it's not about

752
00:25:45,520 --> 00:25:49,440
winning it's about giving business value

753
00:25:49,440 --> 00:25:51,200
so you're not going to go full cyber

754
00:25:51,200 --> 00:25:52,799
here and just own the entire

755
00:25:52,799 --> 00:25:54,080
organization

756
00:25:54,080 --> 00:25:56,640
and drop a report off and be like i win

757
00:25:56,640 --> 00:25:58,240
you suck goodbye

758
00:25:58,240 --> 00:25:59,840
because that you're not going to be

759
00:25:59,840 --> 00:26:03,600
called back if you're an internal team

760
00:26:03,600 --> 00:26:05,200
you're going to be doing a lot of retest

761
00:26:05,200 --> 00:26:07,039
work for like

762
00:26:07,039 --> 00:26:10,320
years so what are our goals of

763
00:26:10,320 --> 00:26:11,200
objectives

764
00:26:11,200 --> 00:26:13,520
that we figure out on the planning stage

765
00:26:13,520 --> 00:26:15,120
are we going to do this as a blind

766
00:26:15,120 --> 00:26:16,000
engagement

767
00:26:16,000 --> 00:26:18,080
or as a purple team engagement in other

768
00:26:18,080 --> 00:26:20,000
words is it zero knowledge

769
00:26:20,000 --> 00:26:21,919
for a blue team or blue team is our

770
00:26:21,919 --> 00:26:24,320
security operations center

771
00:26:24,320 --> 00:26:27,679
or are they going to know about it

772
00:26:27,679 --> 00:26:29,760
highly highly recommend an exercise

773
00:26:29,760 --> 00:26:31,679
coordinator or project manager i saw

774
00:26:31,679 --> 00:26:33,440
phillip weil on twitter the other day

775
00:26:33,440 --> 00:26:36,080
writing like you know how to stop her

776
00:26:36,080 --> 00:26:38,480
and an ethical hacker you make them

777
00:26:38,480 --> 00:26:40,559
manage a project and that's correct

778
00:26:40,559 --> 00:26:41,919
you do not want to be the project

779
00:26:41,919 --> 00:26:44,559
manager did this in two engagements

780
00:26:44,559 --> 00:26:48,159
never again you really want to find

781
00:26:48,159 --> 00:26:50,000
an exercise coordinator or project

782
00:26:50,000 --> 00:26:51,520
manager

783
00:26:51,520 --> 00:26:54,159
that has some technical understanding

784
00:26:54,159 --> 00:26:54,720
had

785
00:26:54,720 --> 00:26:56,880
the benefit of working with an awesome

786
00:26:56,880 --> 00:26:58,080
awesome person

787
00:26:58,080 --> 00:27:01,679
uh for many years she knows who she is

788
00:27:01,679 --> 00:27:04,080
and she was an awesome exercise

789
00:27:04,080 --> 00:27:05,039
coordinator because she

790
00:27:05,039 --> 00:27:07,679
understood the importance of cyber

791
00:27:07,679 --> 00:27:08,960
threat intelligence

792
00:27:08,960 --> 00:27:10,640
what the blue team was doing and what

793
00:27:10,640 --> 00:27:12,240
the red team was doing and really they

794
00:27:12,240 --> 00:27:12,640
bring

795
00:27:12,640 --> 00:27:15,440
everyone together they're your trusted

796
00:27:15,440 --> 00:27:16,480
agents

797
00:27:16,480 --> 00:27:18,559
right they know what's going on in this

798
00:27:18,559 --> 00:27:20,000
engagement they can

799
00:27:20,000 --> 00:27:21,840
tell you oh the blue team's working on

800
00:27:21,840 --> 00:27:23,120
this incident

801
00:27:23,120 --> 00:27:24,720
and then you can deconflict and make

802
00:27:24,720 --> 00:27:26,399
sure it's not the red team instagram the

803
00:27:26,399 --> 00:27:27,360
red team says oh

804
00:27:27,360 --> 00:27:30,480
i got initial access now what can i do

805
00:27:30,480 --> 00:27:33,520
or now i'm gonna go do this and those

806
00:27:33,520 --> 00:27:34,080
folks

807
00:27:34,080 --> 00:27:36,240
because they are trusted agents as the

808
00:27:36,240 --> 00:27:37,360
name implies

809
00:27:37,360 --> 00:27:39,440
are all coming together thanks to the

810
00:27:39,440 --> 00:27:41,520
exercise coordinator

811
00:27:41,520 --> 00:27:44,240
in this planning phase you also want to

812
00:27:44,240 --> 00:27:45,279
talk about

813
00:27:45,279 --> 00:27:48,480
doing an assumed breach or a full

814
00:27:48,480 --> 00:27:51,679
end to end kill chain exercise

815
00:27:51,679 --> 00:27:54,880
and that really depends right because a

816
00:27:54,880 --> 00:27:57,440
lot of red teams today

817
00:27:57,440 --> 00:28:00,640
spend a lot of time gaining that initial

818
00:28:00,640 --> 00:28:01,679
access right

819
00:28:01,679 --> 00:28:03,840
like it's getting harder for us which

820
00:28:03,840 --> 00:28:05,840
we're not complaining right we all like

821
00:28:05,840 --> 00:28:06,159
that

822
00:28:06,159 --> 00:28:08,240
we're getting challenged we're working

823
00:28:08,240 --> 00:28:10,159
harder we love it

824
00:28:10,159 --> 00:28:12,559
but are you going to be spending all

825
00:28:12,559 --> 00:28:15,200
this time all the time

826
00:28:15,200 --> 00:28:18,799
if your organization knows that at some

827
00:28:18,799 --> 00:28:20,000
point you're going to have a

828
00:28:20,000 --> 00:28:22,240
vulnerability that you didn't patch

829
00:28:22,240 --> 00:28:24,399
or that someone's going to click on

830
00:28:24,399 --> 00:28:25,520
something

831
00:28:25,520 --> 00:28:27,679
and execute something on the behalf of

832
00:28:27,679 --> 00:28:29,760
the militia factors and get access

833
00:28:29,760 --> 00:28:32,960
then maybe you can do an assumed breach

834
00:28:32,960 --> 00:28:36,320
excellent excellent talk by tim medine

835
00:28:36,320 --> 00:28:38,799
and the folks over at red siege on

836
00:28:38,799 --> 00:28:40,080
assume breach

837
00:28:40,080 --> 00:28:43,039
it is a great way of doing and getting

838
00:28:43,039 --> 00:28:43,600
the most

839
00:28:43,600 --> 00:28:46,159
value out of these pen tests and red

840
00:28:46,159 --> 00:28:47,360
team engagements

841
00:28:47,360 --> 00:28:50,080
i would really consider it then of

842
00:28:50,080 --> 00:28:52,080
course you cover rules of engagement

843
00:28:52,080 --> 00:28:53,600
what can the red team do what can the

844
00:28:53,600 --> 00:28:55,440
blue team do if you are

845
00:28:55,440 --> 00:28:59,360
measuring what the blue team is doing

846
00:28:59,360 --> 00:29:01,760
then you need to give them rules that

847
00:29:01,760 --> 00:29:03,679
they realize it's an exercise which you

848
00:29:03,679 --> 00:29:04,159
hope

849
00:29:04,159 --> 00:29:07,919
they don't that they continue to operate

850
00:29:07,919 --> 00:29:11,760
as if this was a real engagement because

851
00:29:11,760 --> 00:29:13,919
behavior changes when they realize that

852
00:29:13,919 --> 00:29:15,200
they're being tested

853
00:29:15,200 --> 00:29:17,600
they're like uh i'm not gonna run that

854
00:29:17,600 --> 00:29:19,600
quickly on this one because

855
00:29:19,600 --> 00:29:22,559
it's just another red team right and uh

856
00:29:22,559 --> 00:29:24,320
another shout out there to nick carr and

857
00:29:24,320 --> 00:29:26,399
some other folks online

858
00:29:26,399 --> 00:29:28,480
that talk about that all the time right

859
00:29:28,480 --> 00:29:29,760
about the red team

860
00:29:29,760 --> 00:29:31,520
not really bringing value so focus on

861
00:29:31,520 --> 00:29:33,760
that all of this is done in the planning

862
00:29:33,760 --> 00:29:34,880
stage

863
00:29:34,880 --> 00:29:37,039
the last part of the planning stage is

864
00:29:37,039 --> 00:29:38,960
the attack infrastructure and this is

865
00:29:38,960 --> 00:29:40,080
where

866
00:29:40,080 --> 00:29:42,480
the red team sets up how they're going

867
00:29:42,480 --> 00:29:43,600
to attack

868
00:29:43,600 --> 00:29:45,520
and this is all based on the scope and

869
00:29:45,520 --> 00:29:47,039
the planning phase

870
00:29:47,039 --> 00:29:49,919
over on the right we see a sad bear

871
00:29:49,919 --> 00:29:51,840
sitting on a picnic chair talking about

872
00:29:51,840 --> 00:29:53,840
planning because i know this is not your

873
00:29:53,840 --> 00:29:54,880
favorite part

874
00:29:54,880 --> 00:29:57,200
thank you alex who's on twitter for

875
00:29:57,200 --> 00:29:58,240
providing

876
00:29:58,240 --> 00:30:00,960
that image

877
00:30:03,840 --> 00:30:07,360
so we created this thing

878
00:30:07,360 --> 00:30:10,399
called the c2 matrix the command

879
00:30:10,399 --> 00:30:13,200
and control matrix now hopefully you've

880
00:30:13,200 --> 00:30:15,279
heard of this hopefully you've used it

881
00:30:15,279 --> 00:30:17,760
if you've used this this awesome thank

882
00:30:17,760 --> 00:30:18,480
you

883
00:30:18,480 --> 00:30:21,360
uh for using it please let us know if it

884
00:30:21,360 --> 00:30:23,200
was valuable or not this

885
00:30:23,200 --> 00:30:27,520
just started out almost a year ago now

886
00:30:27,520 --> 00:30:30,559
that i think about it

887
00:30:30,640 --> 00:30:32,640
powershell empire have you all heard of

888
00:30:32,640 --> 00:30:34,399
empire i think you've heard of empire

889
00:30:34,399 --> 00:30:34,799
right

890
00:30:34,799 --> 00:30:36,399
it's an awesome command control

891
00:30:36,399 --> 00:30:38,480
framework right shout out to harm joy

892
00:30:38,480 --> 00:30:41,840
and all the developers on there um very

893
00:30:41,840 --> 00:30:45,679
very cool now empire around july

894
00:30:45,679 --> 00:30:47,760
end of july i actually remember the day

895
00:30:47,760 --> 00:30:49,520
and i know that's sad

896
00:30:49,520 --> 00:30:51,200
they are like we're done with this

897
00:30:51,200 --> 00:30:54,000
project powershell's dead

898
00:30:54,000 --> 00:30:57,440
everyone catches it we're moving on and

899
00:30:57,440 --> 00:31:00,799
i was sad because i had just released

900
00:31:00,799 --> 00:31:03,039
a two-day red team course and we were

901
00:31:03,039 --> 00:31:04,399
based on empire

902
00:31:04,399 --> 00:31:07,279
because empire was so reliable such good

903
00:31:07,279 --> 00:31:08,000
code

904
00:31:08,000 --> 00:31:09,919
thank you guys again i really appreciate

905
00:31:09,919 --> 00:31:12,640
it we all appreciate it

906
00:31:12,640 --> 00:31:16,320
empire was awesome and this end of life

907
00:31:16,320 --> 00:31:18,320
is like oh my gosh what do we do now so

908
00:31:18,320 --> 00:31:20,000
i started talking to folks

909
00:31:20,000 --> 00:31:22,399
um i mentioned i'm a sans instructor so

910
00:31:22,399 --> 00:31:24,640
we have our slack and i'm like hey what

911
00:31:24,640 --> 00:31:26,399
what do you use what do you use and i

912
00:31:26,399 --> 00:31:27,919
got a whole bunch of different answers

913
00:31:27,919 --> 00:31:28,240
and

914
00:31:28,240 --> 00:31:30,720
then i'm at derbycon and i'm talking to

915
00:31:30,720 --> 00:31:32,320
bryce and i'm like ah

916
00:31:32,320 --> 00:31:34,960
you know this just happened it's like i

917
00:31:34,960 --> 00:31:35,600
was just

918
00:31:35,600 --> 00:31:39,039
using caldera to try to do something and

919
00:31:39,039 --> 00:31:40,559
i didn't know it didn't have this

920
00:31:40,559 --> 00:31:42,720
ability and all of a sudden

921
00:31:42,720 --> 00:31:45,440
it just started to kind of snowball it

922
00:31:45,440 --> 00:31:46,080
was

923
00:31:46,080 --> 00:31:48,399
a spreadsheet like you can see here on

924
00:31:48,399 --> 00:31:49,840
on this image right because

925
00:31:49,840 --> 00:31:51,600
at this point i'm a manager like i'm not

926
00:31:51,600 --> 00:31:53,679
even technical right i'm just kidding

927
00:31:53,679 --> 00:31:55,919
i i quit being a manager to stay

928
00:31:55,919 --> 00:31:56,799
technical

929
00:31:56,799 --> 00:31:59,840
um but start as a little spreadsheet

930
00:31:59,840 --> 00:32:01,840
with various different features of what

931
00:32:01,840 --> 00:32:03,760
different command controls

932
00:32:03,760 --> 00:32:07,840
uh frameworks can do there's 48 of them

933
00:32:07,840 --> 00:32:08,799
now

934
00:32:08,799 --> 00:32:11,600
48 command and control frameworks can

935
00:32:11,600 --> 00:32:13,760
you believe

936
00:32:13,760 --> 00:32:16,640
and we track them here so whether you're

937
00:32:16,640 --> 00:32:18,240
a blue team whether you're a red team

938
00:32:18,240 --> 00:32:19,840
whether you're doing purple teaming you

939
00:32:19,840 --> 00:32:20,720
should definitely

940
00:32:20,720 --> 00:32:23,919
check this out most of them are free

941
00:32:23,919 --> 00:32:26,320
free and open source you can check them

942
00:32:26,320 --> 00:32:27,760
out see what

943
00:32:27,760 --> 00:32:30,799
what uh capabilities they have how they

944
00:32:30,799 --> 00:32:32,240
can communicate

945
00:32:32,240 --> 00:32:34,559
if they have agents or payloads for

946
00:32:34,559 --> 00:32:36,559
various different operating systems

947
00:32:36,559 --> 00:32:38,960
and like i said just contribute back

948
00:32:38,960 --> 00:32:40,559
fill these out let me know if a new one

949
00:32:40,559 --> 00:32:42,399
comes out and it's not there we'll add

950
00:32:42,399 --> 00:32:43,919
it to it

951
00:32:43,919 --> 00:32:46,240
and we've also done some other things

952
00:32:46,240 --> 00:32:48,559
like we released the sans

953
00:32:48,559 --> 00:32:51,679
slingshot c2 matrix edition

954
00:32:51,679 --> 00:32:54,159
virtual machine so some of these aren't

955
00:32:54,159 --> 00:32:55,600
that easy to install

956
00:32:55,600 --> 00:32:57,279
so we did all that work for you right

957
00:32:57,279 --> 00:32:59,760
now there's eight different

958
00:32:59,760 --> 00:33:01,919
c2s already pre-installed you just

959
00:33:01,919 --> 00:33:03,120
download the vm

960
00:33:03,120 --> 00:33:06,000
you power it up with virtual vmware and

961
00:33:06,000 --> 00:33:07,919
you can just hit the ground running

962
00:33:07,919 --> 00:33:10,320
we also have a how-to site which shows

963
00:33:10,320 --> 00:33:13,200
you how to use these so today

964
00:33:13,200 --> 00:33:16,159
based on cozy bear using posh c2 and

965
00:33:16,159 --> 00:33:18,720
they have the ceramiation plan we will

966
00:33:18,720 --> 00:33:21,760
do posh sleep doom and it's all there

967
00:33:21,760 --> 00:33:23,279
like you can copy and paste that

968
00:33:23,279 --> 00:33:25,519
obviously you should learn how they work

969
00:33:25,519 --> 00:33:28,559
um and you can follow them on the c2

970
00:33:28,559 --> 00:33:31,519
matrix on twitter

971
00:33:31,600 --> 00:33:35,120
so next step is to create this adversary

972
00:33:35,120 --> 00:33:36,080
emulation plan

973
00:33:36,080 --> 00:33:40,880
now again thank you to mitre attack

974
00:33:40,880 --> 00:33:43,519
because they did this in attack of the

975
00:33:43,519 --> 00:33:45,120
evals

976
00:33:45,120 --> 00:33:47,840
we have this whole operational flow we

977
00:33:47,840 --> 00:33:48,480
have this

978
00:33:48,480 --> 00:33:53,360
emulation plan it has 20 different steps

979
00:33:53,360 --> 00:33:55,919
over two days obviously i probably have

980
00:33:55,919 --> 00:33:57,760
like 20 minutes left so

981
00:33:57,760 --> 00:34:00,640
i'm not gonna do it all but it's there

982
00:34:00,640 --> 00:34:01,760
i'm going to show you

983
00:34:01,760 --> 00:34:04,159
how and give you the building blocks so

984
00:34:04,159 --> 00:34:05,440
you can do it yourself with

985
00:34:05,440 --> 00:34:08,879
all free tools um and and it's an

986
00:34:08,879 --> 00:34:11,040
awesome resource again thank you so

987
00:34:11,040 --> 00:34:14,480
initial access like 90 some percent of

988
00:34:14,480 --> 00:34:17,520
initial accesses today started with

989
00:34:17,520 --> 00:34:21,280
drum roll fishing right

990
00:34:21,280 --> 00:34:24,079
and it got broken off one is broad

991
00:34:24,079 --> 00:34:25,199
fishing and the other one's more

992
00:34:25,199 --> 00:34:27,199
targeted spear fishing right

993
00:34:27,199 --> 00:34:30,879
day one smash and grab like go

994
00:34:30,879 --> 00:34:34,480
in be noisy etcetera right

995
00:34:34,480 --> 00:34:37,119
they use puppy and metasploit slash

996
00:34:37,119 --> 00:34:38,879
interpreter which is the

997
00:34:38,879 --> 00:34:40,399
metasploit payload i'm sure you're all

998
00:34:40,399 --> 00:34:42,480
familiar with that extremely noisy a

999
00:34:42,480 --> 00:34:44,079
continuous connection

1000
00:34:44,079 --> 00:34:46,560
back and forth over http probably

1001
00:34:46,560 --> 00:34:48,079
something that gets caught

1002
00:34:48,079 --> 00:34:51,839
and then they did day two

1003
00:34:51,839 --> 00:34:54,560
which is still low and slow using posh

1004
00:34:54,560 --> 00:34:55,679
t2 so

1005
00:34:55,679 --> 00:34:58,320
um i'm gonna do that one just because i

1006
00:34:58,320 --> 00:35:00,400
like being difficult with myself

1007
00:35:00,400 --> 00:35:02,880
and there's a ton of resources now

1008
00:35:02,880 --> 00:35:05,520
excellent question there happy fun time

1009
00:35:05,520 --> 00:35:07,680
what's the difference between slingshot

1010
00:35:07,680 --> 00:35:08,880
community edition

1011
00:35:08,880 --> 00:35:11,520
slingshot c2 matrix edition the

1012
00:35:11,520 --> 00:35:12,720
slingshot

1013
00:35:12,720 --> 00:35:16,000
c2 matrix edition has everything the

1014
00:35:16,000 --> 00:35:19,680
community edition has but it also has

1015
00:35:19,680 --> 00:35:22,720
these a command and control

1016
00:35:22,720 --> 00:35:25,040
frameworks already pre-installed that

1017
00:35:25,040 --> 00:35:25,760
you can just

1018
00:35:25,760 --> 00:35:29,200
run so it's a little bigger maybe a lot

1019
00:35:29,200 --> 00:35:31,040
bigger i actually haven't checked like

1020
00:35:31,040 --> 00:35:33,920
i think the c2 matrix one is maybe like

1021
00:35:33,920 --> 00:35:34,880
10 gigs

1022
00:35:34,880 --> 00:35:37,359
while the ones a little smaller but

1023
00:35:37,359 --> 00:35:38,560
that's the main difference

1024
00:35:38,560 --> 00:35:41,680
is that one has c2 frameworks while the

1025
00:35:41,680 --> 00:35:42,480
other one

1026
00:35:42,480 --> 00:35:44,720
does not um and the reason we did that

1027
00:35:44,720 --> 00:35:46,480
is to really lower the curve right

1028
00:35:46,480 --> 00:35:47,119
because

1029
00:35:47,119 --> 00:35:49,040
all these are free they're open sources

1030
00:35:49,040 --> 00:35:50,560
are out there like

1031
00:35:50,560 --> 00:35:53,680
people are using these why can't you

1032
00:35:53,680 --> 00:35:56,480
why can't you just grab this vm and

1033
00:35:56,480 --> 00:35:57,680
start testing right

1034
00:35:57,680 --> 00:35:59,440
obviously do all this with permission

1035
00:35:59,440 --> 00:36:01,359
and yada yada right

1036
00:36:01,359 --> 00:36:04,160
so another thing that's extremely

1037
00:36:04,160 --> 00:36:05,680
important

1038
00:36:05,680 --> 00:36:08,319
very important

1039
00:36:09,280 --> 00:36:12,560
is you have to track your work in your

1040
00:36:12,560 --> 00:36:14,000
red team engagements

1041
00:36:14,000 --> 00:36:17,280
or purple team exercises you have to

1042
00:36:17,280 --> 00:36:18,320
track your work

1043
00:36:18,320 --> 00:36:21,680
the whole point of this isn't to go full

1044
00:36:21,680 --> 00:36:24,560
cyber as uh jake williams said in one of

1045
00:36:24,560 --> 00:36:25,680
his talks at a

1046
00:36:25,680 --> 00:36:27,520
hot fest a couple weeks ago right don't

1047
00:36:27,520 --> 00:36:28,960
go full cyber

1048
00:36:28,960 --> 00:36:31,839
actually track this right if you don't

1049
00:36:31,839 --> 00:36:33,599
track it you're really providing

1050
00:36:33,599 --> 00:36:37,280
very little value because why not just

1051
00:36:37,280 --> 00:36:38,640
use a real breach

1052
00:36:38,640 --> 00:36:41,760
why not just look at forensics of a real

1053
00:36:41,760 --> 00:36:43,040
investigation

1054
00:36:43,040 --> 00:36:45,440
the whole point of you doing this is to

1055
00:36:45,440 --> 00:36:47,760
track everything from the beginning

1056
00:36:47,760 --> 00:36:50,960
what time did you send that email what

1057
00:36:50,960 --> 00:36:53,119
time did you actually push the person

1058
00:36:53,119 --> 00:36:55,119
what time did your c2 get its

1059
00:36:55,119 --> 00:36:56,800
communication back right

1060
00:36:56,800 --> 00:36:59,839
all of that is extremely important and

1061
00:36:59,839 --> 00:37:00,079
sh

1062
00:37:00,079 --> 00:37:03,760
we should do that first

1063
00:37:06,880 --> 00:37:10,079
the right side is blue team

1064
00:37:10,079 --> 00:37:13,040
so whenever you do the left side you

1065
00:37:13,040 --> 00:37:14,960
then want to see what the blue team

1066
00:37:14,960 --> 00:37:18,560
was able to detect did that particular

1067
00:37:18,560 --> 00:37:21,040
test case did that ttp

1068
00:37:21,040 --> 00:37:24,079
get something logged was it blocked

1069
00:37:24,079 --> 00:37:27,119
was it detected was there an alert right

1070
00:37:27,119 --> 00:37:27,839
and as you

1071
00:37:27,839 --> 00:37:31,200
fill these out you'll get other other

1072
00:37:31,200 --> 00:37:33,599
forms so if you were to put detected on

1073
00:37:33,599 --> 00:37:35,520
here it would say okay was there an

1074
00:37:35,520 --> 00:37:36,880
alert

1075
00:37:36,880 --> 00:37:39,359
how high was the alert and the adversary

1076
00:37:39,359 --> 00:37:40,240
emulation

1077
00:37:40,240 --> 00:37:44,879
um evals also show that as well

1078
00:37:45,680 --> 00:37:49,680
so let's do demos because

1079
00:37:49,680 --> 00:37:52,960
i know that's what you all love

1080
00:37:53,119 --> 00:37:57,599
so first of all c2 matrix

1081
00:37:57,599 --> 00:38:00,240
that's here

1082
00:38:02,000 --> 00:38:05,200
10.2 gigs happy fun time yep not that

1083
00:38:05,200 --> 00:38:07,119
bad right we're on gig connections that

1084
00:38:07,119 --> 00:38:08,079
took you what

1085
00:38:08,079 --> 00:38:11,200
32 seconds

1086
00:38:12,320 --> 00:38:15,040
if it took long i'm sorry but at least

1087
00:38:15,040 --> 00:38:16,160
you didn't have to spend the time

1088
00:38:16,160 --> 00:38:17,440
installing them

1089
00:38:17,440 --> 00:38:20,320
so this is c2 matrix site there's a lot

1090
00:38:20,320 --> 00:38:21,760
of stuff going on

1091
00:38:21,760 --> 00:38:24,560
um we have asked the matrix this was a

1092
00:38:24,560 --> 00:38:26,240
little questionnaire

1093
00:38:26,240 --> 00:38:29,440
that you can just choose and see like do

1094
00:38:29,440 --> 00:38:30,000
you need

1095
00:38:30,000 --> 00:38:31,680
a command and control framework that

1096
00:38:31,680 --> 00:38:33,680
supports multiple users

1097
00:38:33,680 --> 00:38:36,880
yes i want multiple users because

1098
00:38:36,880 --> 00:38:39,280
it's a red team engagement and then what

1099
00:38:39,280 --> 00:38:41,040
channels do you want to communicate on

1100
00:38:41,040 --> 00:38:43,119
and this is important today

1101
00:38:43,119 --> 00:38:46,320
most things are over http

1102
00:38:46,320 --> 00:38:48,320
so you can select that you see not much

1103
00:38:48,320 --> 00:38:50,880
filtering or what operating system do

1104
00:38:50,880 --> 00:38:52,560
you want agents to run on

1105
00:38:52,560 --> 00:38:56,480
i want to own everything all the things

1106
00:38:56,480 --> 00:38:58,800
what other capabilities do you want like

1107
00:38:58,800 --> 00:39:00,880
the ability to jitter

1108
00:39:00,880 --> 00:39:04,000
do you want to set a kill date look at

1109
00:39:04,000 --> 00:39:04,400
that

1110
00:39:04,400 --> 00:39:08,000
we're down to four right so

1111
00:39:08,000 --> 00:39:09,839
two of these are paid cobalt strike

1112
00:39:09,839 --> 00:39:11,359
inside covenant

1113
00:39:11,359 --> 00:39:14,400
awesome awesome stuff love coming in

1114
00:39:14,400 --> 00:39:16,560
but we are actually going to use posh

1115
00:39:16,560 --> 00:39:18,079
team 2 and again i love

1116
00:39:18,079 --> 00:39:20,720
all of these so thank you to all the

1117
00:39:20,720 --> 00:39:21,760
developers

1118
00:39:21,760 --> 00:39:24,160
we have documentation which i'll cover

1119
00:39:24,160 --> 00:39:24,960
shortly

1120
00:39:24,960 --> 00:39:26,960
we have feedback do give us feedback

1121
00:39:26,960 --> 00:39:28,400
please like

1122
00:39:28,400 --> 00:39:30,480
you don't like the site someone wrote

1123
00:39:30,480 --> 00:39:32,240
like the site looks like it was created

1124
00:39:32,240 --> 00:39:32,560
by

1125
00:39:32,560 --> 00:39:35,119
a seven-year-old i'm like thanks we did

1126
00:39:35,119 --> 00:39:37,119
this for free you're welcome

1127
00:39:37,119 --> 00:39:40,560
but if you have actual useful feedback

1128
00:39:40,560 --> 00:39:42,000
or if you don't know if your feedback

1129
00:39:42,000 --> 00:39:44,320
will be useful or not just let us know

1130
00:39:44,320 --> 00:39:47,760
do you want another c2 in the c2

1131
00:39:47,760 --> 00:39:50,800
uh the slingshot version let us know we

1132
00:39:50,800 --> 00:39:51,760
will help

1133
00:39:51,760 --> 00:39:54,720
there's a gui of this and the gui is a

1134
00:39:54,720 --> 00:39:57,680
pain to update i am not a web developer

1135
00:39:57,680 --> 00:40:00,720
so i really encourage you to use

1136
00:40:00,720 --> 00:40:05,040
the matrix the matrix again is just a

1137
00:40:05,040 --> 00:40:07,520
google sheet and there's a lot sometimes

1138
00:40:07,520 --> 00:40:09,200
we'll add stuff

1139
00:40:09,200 --> 00:40:12,160
without actually checking it out see i

1140
00:40:12,160 --> 00:40:12,560
even

1141
00:40:12,560 --> 00:40:15,760
put here for evaluator contribute

1142
00:40:15,760 --> 00:40:18,640
please contribute right so i felt

1143
00:40:18,640 --> 00:40:19,599
awesome stuff

1144
00:40:19,599 --> 00:40:22,400
uh this was cody from spectre ops

1145
00:40:22,400 --> 00:40:24,160
there's some new ones there's one called

1146
00:40:24,160 --> 00:40:26,000
baby shark that i keep getting the

1147
00:40:26,000 --> 00:40:28,240
song stuck in my head right you all know

1148
00:40:28,240 --> 00:40:29,680
the song right

1149
00:40:29,680 --> 00:40:32,240
um there's a bunch of others and there's

1150
00:40:32,240 --> 00:40:32,880
there's a ton

1151
00:40:32,880 --> 00:40:36,000
so today we're gonna use posh d2 we can

1152
00:40:36,000 --> 00:40:39,359
see the license there bsd

1153
00:40:39,359 --> 00:40:41,760
we can see the price which is free we

1154
00:40:41,760 --> 00:40:43,520
can see where we find it right you can

1155
00:40:43,520 --> 00:40:43,839
just

1156
00:40:43,839 --> 00:40:46,160
click on it and go to the github page

1157
00:40:46,160 --> 00:40:47,040
you can see

1158
00:40:47,040 --> 00:40:50,400
netitude labs thank you

1159
00:40:50,400 --> 00:40:51,920
thank you i've actually been using this

1160
00:40:51,920 --> 00:40:54,400
today you can see the eval date there

1161
00:40:54,400 --> 00:40:57,520
is today that's because

1162
00:40:57,520 --> 00:40:59,119
i took advantage of this demo and

1163
00:40:59,119 --> 00:41:00,640
actually did it

1164
00:41:00,640 --> 00:41:02,800
they're on version six i installed it

1165
00:41:02,800 --> 00:41:04,560
with install.ch

1166
00:41:04,560 --> 00:41:08,160
there's a how-to site what there is how

1167
00:41:08,160 --> 00:41:11,440
to use this that's amazing

1168
00:41:11,440 --> 00:41:13,359
i actually installed this in slingshot

1169
00:41:13,359 --> 00:41:15,280
so it doesn't come in the slingshot but

1170
00:41:15,280 --> 00:41:16,640
it's definitely possible

1171
00:41:16,640 --> 00:41:18,240
if you just follow the instructions

1172
00:41:18,240 --> 00:41:20,079
we'll add it next time because

1173
00:41:20,079 --> 00:41:22,240
i really like this one we're actually

1174
00:41:22,240 --> 00:41:23,760
working with folks from offensive

1175
00:41:23,760 --> 00:41:24,480
security

1176
00:41:24,480 --> 00:41:26,319
so it's going to be on the next cali

1177
00:41:26,319 --> 00:41:27,920
build and this

1178
00:41:27,920 --> 00:41:30,079
the server was created in python and

1179
00:41:30,079 --> 00:41:31,280
then you can have

1180
00:41:31,280 --> 00:41:37,040
agents in powershell c-sharp and python

1181
00:41:37,680 --> 00:41:39,839
does cozy bear follow russian business

1182
00:41:39,839 --> 00:41:42,480
hours that is a great question

1183
00:41:42,480 --> 00:41:45,119
happy fun time whoever you are i love

1184
00:41:45,119 --> 00:41:47,040
all the questions you're asking

1185
00:41:47,040 --> 00:41:50,319
um when you establish

1186
00:41:50,319 --> 00:41:53,680
the business hours it's actually the

1187
00:41:53,680 --> 00:41:54,240
hours

1188
00:41:54,240 --> 00:41:56,960
in the target system that's actually

1189
00:41:56,960 --> 00:41:58,240
interesting that you bring that up

1190
00:41:58,240 --> 00:41:58,640
because

1191
00:41:58,640 --> 00:42:02,240
posh c2 just put on twitter like

1192
00:42:02,240 --> 00:42:05,200
should we use utc time should we use

1193
00:42:05,200 --> 00:42:06,400
local time

1194
00:42:06,400 --> 00:42:10,319
and the answer is it depends but

1195
00:42:10,319 --> 00:42:12,400
it really does depend right on you if

1196
00:42:12,400 --> 00:42:13,839
you're using working hours

1197
00:42:13,839 --> 00:42:15,440
you want to use the working hours on the

1198
00:42:15,440 --> 00:42:17,520
target system because

1199
00:42:17,520 --> 00:42:20,079
nine to five is nine to five in whatever

1200
00:42:20,079 --> 00:42:21,040
time zone

1201
00:42:21,040 --> 00:42:23,680
of that person actually working right so

1202
00:42:23,680 --> 00:42:25,599
great question there i thought that was

1203
00:42:25,599 --> 00:42:29,760
hilarious um then is it multi-user in

1204
00:42:29,760 --> 00:42:30,000
this

1205
00:42:30,000 --> 00:42:32,960
case posh d2 is it has it's mostly

1206
00:42:32,960 --> 00:42:34,400
command line i'm going to show it to you

1207
00:42:34,400 --> 00:42:35,839
in a few seconds

1208
00:42:35,839 --> 00:42:38,880
um it has agents

1209
00:42:38,880 --> 00:42:41,040
in a number of different operating

1210
00:42:41,040 --> 00:42:44,000
systems it runs mostly in http uh

1211
00:42:44,000 --> 00:42:48,160
and https it has a key exchange

1212
00:42:48,160 --> 00:42:50,240
it can do domain fronting it can do

1213
00:42:50,240 --> 00:42:52,000
custom profiles like

1214
00:42:52,000 --> 00:42:54,480
it's all there right pretty cool stuff

1215
00:42:54,480 --> 00:42:55,280
um

1216
00:42:55,280 --> 00:42:58,240
also how to detect it shout out to these

1217
00:42:58,240 --> 00:42:59,040
folks

1218
00:42:59,040 --> 00:43:02,319
they actually published how to

1219
00:43:02,319 --> 00:43:05,680
detect this

1220
00:43:05,680 --> 00:43:08,319
which is amazing i'm going to show you

1221
00:43:08,319 --> 00:43:09,119
right here

1222
00:43:09,119 --> 00:43:12,000
they posted not only is posh c2

1223
00:43:12,000 --> 00:43:13,119
available for you

1224
00:43:13,119 --> 00:43:16,319
but this is how you can detect it these

1225
00:43:16,319 --> 00:43:19,440
are the ilc's right so awesome stuff

1226
00:43:19,440 --> 00:43:21,760
thank you again and let's move this

1227
00:43:21,760 --> 00:43:22,560
along so

1228
00:43:22,560 --> 00:43:25,359
the how to the how to has stuff now

1229
00:43:25,359 --> 00:43:26,800
poshd 2

1230
00:43:26,800 --> 00:43:30,160
is very well documented again

1231
00:43:30,160 --> 00:43:32,640
thank you to the developers you all are

1232
00:43:32,640 --> 00:43:33,359
awesome

1233
00:43:33,359 --> 00:43:36,720
like just click on this link and look at

1234
00:43:36,720 --> 00:43:40,240
all this documentation how to install it

1235
00:43:40,240 --> 00:43:43,280
how to use it how to extend it

1236
00:43:43,280 --> 00:43:46,400
reporting thank you thank you thank you

1237
00:43:46,400 --> 00:43:48,640
now this is not the case for all the

1238
00:43:48,640 --> 00:43:49,680
other c2s

1239
00:43:49,680 --> 00:43:52,800
so don't get that exciting but

1240
00:43:52,800 --> 00:43:56,319
great job there um this is their github

1241
00:43:56,319 --> 00:43:58,240
they just released version six

1242
00:43:58,240 --> 00:44:00,960
definitely check them out um the how to

1243
00:44:00,960 --> 00:44:03,119
is here if you want to download the sans

1244
00:44:03,119 --> 00:44:05,680
slingshot c2 matrix edition you just

1245
00:44:05,680 --> 00:44:07,680
click here it comes with covenant empire

1246
00:44:07,680 --> 00:44:08,480
3

1247
00:44:08,480 --> 00:44:11,920
by the way empire is supported today

1248
00:44:11,920 --> 00:44:14,960
thank you to the folks of bc security

1249
00:44:14,960 --> 00:44:18,560
they have not only empire 3 which is on

1250
00:44:18,560 --> 00:44:19,599
python 3

1251
00:44:19,599 --> 00:44:21,599
now fully supported but they have this

1252
00:44:21,599 --> 00:44:23,040
gui called starkiller

1253
00:44:23,040 --> 00:44:24,720
i've demoed that before actually the

1254
00:44:24,720 --> 00:44:26,480
last time i came on

1255
00:44:26,480 --> 00:44:29,599
this um red team village talk i showed

1256
00:44:29,599 --> 00:44:30,880
that one so i'm not going to show that

1257
00:44:30,880 --> 00:44:31,680
one again

1258
00:44:31,680 --> 00:44:33,599
there's also faction there's croatic

1259
00:44:33,599 --> 00:44:35,280
there's merlin menace boy

1260
00:44:35,280 --> 00:44:38,480
silent trinity and sliver and it has

1261
00:44:38,480 --> 00:44:40,800
vector installed as well here's a little

1262
00:44:40,800 --> 00:44:42,640
walkthrough of how to use it

1263
00:44:42,640 --> 00:44:45,599
little facts frequently asked questions

1264
00:44:45,599 --> 00:44:47,839
here's the c2 matrix eval lab

1265
00:44:47,839 --> 00:44:51,040
this is what you should have to actually

1266
00:44:51,040 --> 00:44:53,359
test this stuff if you want to

1267
00:44:53,359 --> 00:44:55,359
contribute there's a contribute page

1268
00:44:55,359 --> 00:44:56,960
right here

1269
00:44:56,960 --> 00:44:59,599
what we need you to do please do

1270
00:44:59,599 --> 00:45:01,760
contribute like if there's new ones

1271
00:45:01,760 --> 00:45:03,520
or if you want to write how how-to as

1272
00:45:03,520 --> 00:45:04,880
you can see

1273
00:45:04,880 --> 00:45:07,839
there's not 48 how-to's there's only a

1274
00:45:07,839 --> 00:45:09,359
few how-to's right

1275
00:45:09,359 --> 00:45:12,079
so definitely um contribute back we

1276
00:45:12,079 --> 00:45:14,480
would really appreciate

1277
00:45:14,480 --> 00:45:19,200
now let's get to the fun part

1278
00:45:19,200 --> 00:45:23,760
emulating cozy bear attack evaluations

1279
00:45:23,760 --> 00:45:27,760
i'm at attack evals.miter.org apt-29

1280
00:45:27,760 --> 00:45:30,240
operational flow they have this broken

1281
00:45:30,240 --> 00:45:31,200
up in two

1282
00:45:31,200 --> 00:45:34,079
scenario one and scenario two awesome

1283
00:45:34,079 --> 00:45:34,400
you

1284
00:45:34,400 --> 00:45:39,440
have to put these ttps together

1285
00:45:41,119 --> 00:45:44,160
now i'm not gonna do one one is very

1286
00:45:44,160 --> 00:45:47,680
smash and grabby i'm gonna do two

1287
00:45:47,680 --> 00:45:52,000
second scenario they use posh c2

1288
00:45:52,000 --> 00:45:54,560
to create a commanding control and if

1289
00:45:54,560 --> 00:45:56,560
you click here malware is executed on

1290
00:45:56,560 --> 00:45:57,440
the victim

1291
00:45:57,440 --> 00:45:59,920
you can see every step is actually a

1292
00:45:59,920 --> 00:46:01,520
chain

1293
00:46:01,520 --> 00:46:04,640
this first step uses t120 a

1294
00:46:04,640 --> 00:46:06,880
this one this one oh my gosh all these

1295
00:46:06,880 --> 00:46:09,760
things it drops a powershell stager etc

1296
00:46:09,760 --> 00:46:12,480
so you can go through all these and do

1297
00:46:12,480 --> 00:46:13,440
them now

1298
00:46:13,440 --> 00:46:16,800
how do you do that the step by step

1299
00:46:16,800 --> 00:46:19,520
is available available in this github

1300
00:46:19,520 --> 00:46:21,680
page it's minor attacks github

1301
00:46:21,680 --> 00:46:24,560
under attack arsenal adversary emulation

1302
00:46:24,560 --> 00:46:26,800
apt-29 which is cozy bear

1303
00:46:26,800 --> 00:46:29,040
and here you can see everything day one

1304
00:46:29,040 --> 00:46:30,240
and day two does

1305
00:46:30,240 --> 00:46:32,960
so we're gonna go over to day two now

1306
00:46:32,960 --> 00:46:35,119
day two requires a little bit of prep so

1307
00:46:35,119 --> 00:46:36,319
don't think that you can just

1308
00:46:36,319 --> 00:46:39,920
go out and do this that quickly

1309
00:46:39,920 --> 00:46:42,000
special thanks to all these folks right

1310
00:46:42,000 --> 00:46:43,599
uh atomic red team

1311
00:46:43,599 --> 00:46:46,160
mammoth cats posh c2 right the folks

1312
00:46:46,160 --> 00:46:48,160
from power supply etc

1313
00:46:48,160 --> 00:46:50,000
tells you your requirements your victim

1314
00:46:50,000 --> 00:46:52,160
systems your red team system

1315
00:46:52,160 --> 00:46:54,079
the red team set up you actually have to

1316
00:46:54,079 --> 00:46:56,319
go through and do all this

1317
00:46:56,319 --> 00:46:59,599
and then it goes down to step by step

1318
00:46:59,599 --> 00:47:03,040
what you need to do for each step

1319
00:47:03,040 --> 00:47:07,280
now i of course did not have time

1320
00:47:07,280 --> 00:47:10,480
to do all of these but they're awesome

1321
00:47:10,480 --> 00:47:12,640
and why are they awesome because they're

1322
00:47:12,640 --> 00:47:13,599
payloads

1323
00:47:13,599 --> 00:47:16,319
that you can actually pull down and run

1324
00:47:16,319 --> 00:47:16,720
as

1325
00:47:16,720 --> 00:47:20,800
powershell scripts so

1326
00:47:20,800 --> 00:47:25,839
let's do this

1327
00:47:31,839 --> 00:47:35,599
all right so i already have this

1328
00:47:35,599 --> 00:47:40,640
is hopefully viewable

1329
00:47:40,640 --> 00:47:46,240
this is the slingshot c2 matrix edition

1330
00:47:47,359 --> 00:47:50,839
and i have already set up

1331
00:47:50,839 --> 00:47:53,760
the

1332
00:47:53,760 --> 00:47:57,440
posh2 and how do you do that

1333
00:47:57,440 --> 00:48:01,200
again there's a posh c2 step here

1334
00:48:01,200 --> 00:48:03,599
it doesn't come installed you literally

1335
00:48:03,599 --> 00:48:04,640
sudo

1336
00:48:04,640 --> 00:48:08,160
then run this command then configure it

1337
00:48:08,160 --> 00:48:11,680
i will show you my configuration

1338
00:48:11,680 --> 00:48:14,720
first of all just so you have a look at

1339
00:48:14,720 --> 00:48:16,799
it

1340
00:48:18,160 --> 00:48:21,359
hopefully this is large enough so

1341
00:48:21,359 --> 00:48:24,480
this is just a brand new

1342
00:48:24,480 --> 00:48:27,200
slingshot c2 and on top of that i put

1343
00:48:27,200 --> 00:48:28,480
posh

1344
00:48:28,480 --> 00:48:31,839
on it and if you look at

1345
00:48:31,839 --> 00:48:36,079
this config.yaml file

1346
00:48:36,079 --> 00:48:38,480
you will see the configuration so you do

1347
00:48:38,480 --> 00:48:39,200
need to change

1348
00:48:39,200 --> 00:48:41,760
things so you have to put the ip address

1349
00:48:41,760 --> 00:48:42,480
oh my gosh

1350
00:48:42,480 --> 00:48:49,520
is this not my ip oh please be my ip

1351
00:48:49,520 --> 00:48:52,240
oh my gosh yes thank you this is my ip

1352
00:48:52,240 --> 00:48:54,319
sorry i freaked out for a second

1353
00:48:54,319 --> 00:48:57,680
um so this is the ip um

1354
00:48:57,680 --> 00:48:59,760
don't do this with dynamic ips because

1355
00:48:59,760 --> 00:49:01,040
you'll freak out

1356
00:49:01,040 --> 00:49:03,280
um now something very important if

1357
00:49:03,280 --> 00:49:05,119
you're only doing this in a small test

1358
00:49:05,119 --> 00:49:05,760
environment

1359
00:49:05,760 --> 00:49:08,319
sqlite is fine if you're going to do

1360
00:49:08,319 --> 00:49:10,559
this in a bigger environment

1361
00:49:10,559 --> 00:49:12,960
then you might want to use postgres and

1362
00:49:12,960 --> 00:49:14,319
that's all there

1363
00:49:14,319 --> 00:49:17,440
as well as the pay load communication

1364
00:49:17,440 --> 00:49:20,800
over http i did something here i changed

1365
00:49:20,800 --> 00:49:22,800
the user agent

1366
00:49:22,800 --> 00:49:26,000
um to the new edge

1367
00:49:26,000 --> 00:49:27,920
just because that kind of blends in

1368
00:49:27,920 --> 00:49:29,280
right so this is

1369
00:49:29,280 --> 00:49:32,640
the brand new latest um

1370
00:49:32,640 --> 00:49:35,359
user agent default sleep i put five

1371
00:49:35,359 --> 00:49:36,720
seconds just so we're not

1372
00:49:36,720 --> 00:49:39,839
waiting forever jitter that and by the

1373
00:49:39,839 --> 00:49:41,520
way so if you don't know this

1374
00:49:41,520 --> 00:49:44,559
default sleep this is how often the

1375
00:49:44,559 --> 00:49:47,520
agent on the end point is going to call

1376
00:49:47,520 --> 00:49:47,839
back

1377
00:49:47,839 --> 00:49:51,599
to our system um because that's how http

1378
00:49:51,599 --> 00:49:52,800
works right like

1379
00:49:52,800 --> 00:49:56,640
you don't have a ongoing http connection

1380
00:49:56,640 --> 00:50:00,160
all the time you go to a website you

1381
00:50:00,160 --> 00:50:01,359
open a new tab

1382
00:50:01,359 --> 00:50:03,680
you go to google it makes a request it

1383
00:50:03,680 --> 00:50:05,359
gets something back and then it just

1384
00:50:05,359 --> 00:50:06,480
chills

1385
00:50:06,480 --> 00:50:08,480
and then you open like a million tabs

1386
00:50:08,480 --> 00:50:10,079
and they stay open right

1387
00:50:10,079 --> 00:50:12,160
that's how http works so the same thing

1388
00:50:12,160 --> 00:50:13,839
you're doing here you're putting a five

1389
00:50:13,839 --> 00:50:17,280
second in this case beacon and you don't

1390
00:50:17,280 --> 00:50:19,680
want to fall into a

1391
00:50:19,680 --> 00:50:22,640
pattern so you put a jitter that means

1392
00:50:22,640 --> 00:50:23,920
20

1393
00:50:23,920 --> 00:50:26,880
between five seconds so between four and

1394
00:50:26,880 --> 00:50:27,359
six

1395
00:50:27,359 --> 00:50:31,680
seconds every time it will call out

1396
00:50:31,680 --> 00:50:33,680
and then there's some other things there

1397
00:50:33,680 --> 00:50:35,920
um for this particular one so you

1398
00:50:35,920 --> 00:50:37,280
definitely want to

1399
00:50:37,280 --> 00:50:40,640
configure that first then

1400
00:50:40,640 --> 00:50:44,240
what do you do you run

1401
00:50:44,240 --> 00:50:48,160
the server it's poshdash server

1402
00:50:48,160 --> 00:50:49,839
and you're going to find that it's going

1403
00:50:49,839 --> 00:50:52,079
to create all these payloads

1404
00:50:52,079 --> 00:50:55,359
for you it is amazing so

1405
00:50:55,359 --> 00:50:58,480
we are here

1406
00:50:58,640 --> 00:51:03,200
um let me make that bigger sorry about

1407
00:51:06,839 --> 00:51:09,839
that

1408
00:51:10,319 --> 00:51:13,680
so here it creates this quickstart.txt

1409
00:51:13,680 --> 00:51:15,490
if we look at that quickstart

1410
00:51:15,490 --> 00:51:16,960
[Music]

1411
00:51:16,960 --> 00:51:20,480
it has created a whole bunch of payloads

1412
00:51:20,480 --> 00:51:22,319
it's something really cool about posh

1413
00:51:22,319 --> 00:51:23,760
you'll actually have to go and create

1414
00:51:23,760 --> 00:51:26,079
the payloads one by one it does it for

1415
00:51:26,079 --> 00:51:27,359
you right off the bat

1416
00:51:27,359 --> 00:51:30,400
and it saves it in this posh c2 project

1417
00:51:30,400 --> 00:51:31,280
folder

1418
00:51:31,280 --> 00:51:33,359
so here we have a number of reflective

1419
00:51:33,359 --> 00:51:34,400
dlls

1420
00:51:34,400 --> 00:51:36,480
you'll have posh version 2 posh version

1421
00:51:36,480 --> 00:51:38,000
4 sharp

1422
00:51:38,000 --> 00:51:40,000
and bind and then when you do run it

1423
00:51:40,000 --> 00:51:42,240
with run dll it tells you exactly how to

1424
00:51:42,240 --> 00:51:42,880
do it

1425
00:51:42,880 --> 00:51:45,280
to run run dll and this is a miter

1426
00:51:45,280 --> 00:51:46,319
attack technique

1427
00:51:46,319 --> 00:51:48,960
you run run dll the dll and then where

1428
00:51:48,960 --> 00:51:50,640
you want to start the function in this

1429
00:51:50,640 --> 00:51:52,319
case it's void function

1430
00:51:52,319 --> 00:51:55,440
there's also shell code in dot bin files

1431
00:51:55,440 --> 00:51:58,240
there is a power shell which is the

1432
00:51:58,240 --> 00:52:00,079
easiest thing we're going to do

1433
00:52:00,079 --> 00:52:01,839
so literally we're just going to grab

1434
00:52:01,839 --> 00:52:04,079
this we're going to copy

1435
00:52:04,079 --> 00:52:05,680
it and then we're going to execute it

1436
00:52:05,680 --> 00:52:08,240
but you have mshta

1437
00:52:08,240 --> 00:52:11,520
which is an hta this is another low bin

1438
00:52:11,520 --> 00:52:14,800
a living off the lan binary this is a

1439
00:52:14,800 --> 00:52:16,960
an executable that comes with all

1440
00:52:16,960 --> 00:52:18,319
windows systems

1441
00:52:18,319 --> 00:52:21,280
same with reg server 32 all of these are

1442
00:52:21,280 --> 00:52:24,480
ttps and they're all different ttps

1443
00:52:24,480 --> 00:52:27,280
there's also some c-sharp there's just

1444
00:52:27,280 --> 00:52:29,359
some standard executables you can do

1445
00:52:29,359 --> 00:52:31,599
this one with cert util

1446
00:52:31,599 --> 00:52:33,680
awesome awesome stuff start you to watch

1447
00:52:33,680 --> 00:52:35,599
and go out into the internet

1448
00:52:35,599 --> 00:52:39,119
pull down and execute so you have a

1449
00:52:39,119 --> 00:52:39,920
number of those

1450
00:52:39,920 --> 00:52:42,640
all things you should definitely test

1451
00:52:42,640 --> 00:52:43,599
out

1452
00:52:43,599 --> 00:52:47,119
and then over here i'm just going to hit

1453
00:52:47,119 --> 00:52:48,240
refresh i have

1454
00:52:48,240 --> 00:52:51,760
no implants so pray to the bear

1455
00:52:51,760 --> 00:52:55,040
gods we have a windows 10 poor victim

1456
00:52:55,040 --> 00:52:56,400
over here

1457
00:52:56,400 --> 00:52:58,960
we're just going to come start a command

1458
00:52:58,960 --> 00:53:00,720
and

1459
00:53:00,720 --> 00:53:03,599
it failed because i did not copy and

1460
00:53:03,599 --> 00:53:05,200
paste correctly so

1461
00:53:05,200 --> 00:53:08,000
hold on one second i'm going to copy and

1462
00:53:08,000 --> 00:53:09,200
paste

1463
00:53:09,200 --> 00:53:15,040
powershell copy let's try this again

1464
00:53:15,040 --> 00:53:19,119
there we go so nothing happened right

1465
00:53:19,119 --> 00:53:22,559
wrong let's go over here and if we hit

1466
00:53:22,559 --> 00:53:23,440
enter again

1467
00:53:23,440 --> 00:53:26,640
we have a new shell so

1468
00:53:26,640 --> 00:53:29,359
pretty easy posh d2 is that simple to

1469
00:53:29,359 --> 00:53:30,079
use

1470
00:53:30,079 --> 00:53:33,119
we press 4 to interact with it

1471
00:53:33,119 --> 00:53:36,319
now what do we want to do

1472
00:53:36,319 --> 00:53:39,599
well we want to do some fun stuff right

1473
00:53:39,599 --> 00:53:41,040
we want to follow

1474
00:53:41,040 --> 00:53:45,359
this particular um

1475
00:53:45,520 --> 00:53:49,119
this particular cozy bear um thing right

1476
00:53:49,119 --> 00:53:49,839
so

1477
00:53:49,839 --> 00:53:52,400
one of the things you should do is on

1478
00:53:52,400 --> 00:53:53,040
the site

1479
00:53:53,040 --> 00:53:55,280
download these payloads i've already

1480
00:53:55,280 --> 00:53:56,640
downloaded the payload

1481
00:53:56,640 --> 00:54:00,079
i'm going to run step 14 i'm sorry step

1482
00:54:00,079 --> 00:54:00,800
12.

1483
00:54:00,800 --> 00:54:03,520
step 11 is to actually get a shell step

1484
00:54:03,520 --> 00:54:04,079
12

1485
00:54:04,079 --> 00:54:07,200
is to execute this so um i've

1486
00:54:07,200 --> 00:54:11,839
already done this

1487
00:54:12,960 --> 00:54:16,240
here we see step 14

1488
00:54:16,240 --> 00:54:18,240
or sorry step 12 why don't why am i

1489
00:54:18,240 --> 00:54:19,599
skipping forward

1490
00:54:19,599 --> 00:54:23,280
and if we look at step 12 we see what it

1491
00:54:23,280 --> 00:54:24,160
does

1492
00:54:24,160 --> 00:54:26,000
it's going to do a number of things it's

1493
00:54:26,000 --> 00:54:27,680
a powershell script

1494
00:54:27,680 --> 00:54:30,319
um so how do you do that well you can

1495
00:54:30,319 --> 00:54:30,720
just

1496
00:54:30,720 --> 00:54:35,598
load any power shell into

1497
00:54:35,920 --> 00:54:40,319
posh you just tell it where it is

1498
00:54:44,319 --> 00:54:47,520
and it will load this powershell so in

1499
00:54:47,520 --> 00:54:48,880
this case

1500
00:54:48,880 --> 00:54:52,480
step 12 oh my gosh i can't type

1501
00:54:52,480 --> 00:54:56,400
12 the ps1 it's going to load that now

1502
00:54:56,400 --> 00:54:58,880
something about posh you have to jump

1503
00:54:58,880 --> 00:54:59,839
over here

1504
00:54:59,839 --> 00:55:02,400
to see if it happened so you can only

1505
00:55:02,400 --> 00:55:04,000
see the result on the server

1506
00:55:04,000 --> 00:55:05,920
yeah i know that's kind of hard you have

1507
00:55:05,920 --> 00:55:07,599
to switch back and forth

1508
00:55:07,599 --> 00:55:10,799
but now that's loaded so

1509
00:55:10,799 --> 00:55:13,920
let's run detect av and

1510
00:55:13,920 --> 00:55:18,400
again this is every five seconds

1511
00:55:18,400 --> 00:55:20,720
oh hey johnny welcome i can't believe

1512
00:55:20,720 --> 00:55:22,079
you're only here for the last few

1513
00:55:22,079 --> 00:55:22,880
seconds

1514
00:55:22,880 --> 00:55:25,839
the last few minutes

1515
00:55:26,240 --> 00:55:28,240
so again you don't know if this ran or

1516
00:55:28,240 --> 00:55:29,839
not you actually have to switch

1517
00:55:29,839 --> 00:55:32,480
over to the server and see that it did

1518
00:55:32,480 --> 00:55:32,880
run

1519
00:55:32,880 --> 00:55:36,559
in this case it runs windows defender

1520
00:55:36,559 --> 00:55:39,599
now we can run the next um

1521
00:55:39,599 --> 00:55:42,640
the next one which is software and again

1522
00:55:42,640 --> 00:55:46,160
i am just going through the adversary

1523
00:55:46,160 --> 00:55:48,640
emulation plan that was provided

1524
00:55:48,640 --> 00:55:50,960
by mitre so right now i'm all the way

1525
00:55:50,960 --> 00:55:52,240
down here

1526
00:55:52,240 --> 00:55:56,079
on step 12 i just ran software

1527
00:55:56,079 --> 00:55:59,040
and that's executing it doesn't tell you

1528
00:55:59,040 --> 00:56:00,720
what happened but if you switch over

1529
00:56:00,720 --> 00:56:01,280
here

1530
00:56:01,280 --> 00:56:04,400
you can see what actually executed

1531
00:56:04,400 --> 00:56:08,079
and in this case we ran um

1532
00:56:08,079 --> 00:56:11,200
software and we found we run gpg there's

1533
00:56:11,200 --> 00:56:12,400
chrome

1534
00:56:12,400 --> 00:56:14,640
chrome probably out of date oh there's

1535
00:56:14,640 --> 00:56:16,880
ice casts there's some fun

1536
00:56:16,880 --> 00:56:19,200
stuff on here that we can go after right

1537
00:56:19,200 --> 00:56:21,359
so all you really need to do

1538
00:56:21,359 --> 00:56:24,480
is follow this adversary emulation plan

1539
00:56:24,480 --> 00:56:24,960
and go

1540
00:56:24,960 --> 00:56:27,760
through the next steps local enumeration

1541
00:56:27,760 --> 00:56:28,079
then

1542
00:56:28,079 --> 00:56:30,799
elevation then persistence lateral

1543
00:56:30,799 --> 00:56:31,680
movement

1544
00:56:31,680 --> 00:56:35,119
etc it's all done for you because

1545
00:56:35,119 --> 00:56:38,240
the folks at mitre attack are

1546
00:56:38,240 --> 00:56:41,359
that awesome

1547
00:56:42,160 --> 00:56:45,359
so just wrapping up and obviously my

1548
00:56:45,359 --> 00:56:46,000
demo is

1549
00:56:46,000 --> 00:56:48,880
always always taking longer than they

1550
00:56:48,880 --> 00:56:50,240
should

1551
00:56:50,240 --> 00:56:54,480
defending against the cozy bears you

1552
00:56:54,480 --> 00:56:55,440
don't want to

1553
00:56:55,440 --> 00:56:57,040
you know just hug these bears because

1554
00:56:57,040 --> 00:56:59,760
they're bad they're russian

1555
00:56:59,760 --> 00:57:03,040
so what can you do well minor attack as

1556
00:57:03,040 --> 00:57:05,119
part of their attack evals they tested

1557
00:57:05,119 --> 00:57:07,920
all of these on the screen all of them

1558
00:57:07,920 --> 00:57:09,280
the black bears

1559
00:57:09,280 --> 00:57:12,480
the the polar bears and a bunch of

1560
00:57:12,480 --> 00:57:15,599
other bears and

1561
00:57:15,599 --> 00:57:18,079
each of them have various different

1562
00:57:18,079 --> 00:57:19,040
detection

1563
00:57:19,040 --> 00:57:22,960
techniques so again this isn't about

1564
00:57:22,960 --> 00:57:25,200
preventing anything right you can't just

1565
00:57:25,200 --> 00:57:26,079
prevent

1566
00:57:26,079 --> 00:57:27,520
some of the things we did you can

1567
00:57:27,520 --> 00:57:29,280
prevent power shell

1568
00:57:29,280 --> 00:57:32,640
but can you if

1569
00:57:32,640 --> 00:57:35,040
you map these out together in an attack

1570
00:57:35,040 --> 00:57:36,960
chain and then adversary emulation

1571
00:57:36,960 --> 00:57:39,520
can you detect it and that's a question

1572
00:57:39,520 --> 00:57:40,000
you need to

1573
00:57:40,000 --> 00:57:42,720
answer and it's not just by deploying

1574
00:57:42,720 --> 00:57:44,240
any of these technologies

1575
00:57:44,240 --> 00:57:47,280
it's actually testing them so

1576
00:57:47,280 --> 00:57:50,079
you want more more cozy bears shout out

1577
00:57:50,079 --> 00:57:51,440
to tim malcolm better

1578
00:57:51,440 --> 00:57:53,680
thank you for this picture cozy bear and

1579
00:57:53,680 --> 00:57:57,119
fancy bear just kind of hanging out

1580
00:57:57,119 --> 00:57:59,440
one of the things that i've done with

1581
00:57:59,440 --> 00:58:00,480
site which

1582
00:58:00,480 --> 00:58:02,240
is awesome because we love giving back

1583
00:58:02,240 --> 00:58:04,480
to the community is threat thursday

1584
00:58:04,480 --> 00:58:07,760
so it's a weekly blog we introduce an

1585
00:58:07,760 --> 00:58:10,559
adversary we consume this cyber threat

1586
00:58:10,559 --> 00:58:11,440
intelligence we

1587
00:58:11,440 --> 00:58:13,520
map it to miter attack we give you an

1588
00:58:13,520 --> 00:58:15,520
adversary emulation plan

1589
00:58:15,520 --> 00:58:17,359
we emulate it and then we talk about how

1590
00:58:17,359 --> 00:58:18,559
to defend it so we've done

1591
00:58:18,559 --> 00:58:20,400
four this is actually my fourth week at

1592
00:58:20,400 --> 00:58:23,440
scythe i'm loving it i've done apt 19

1593
00:58:23,440 --> 00:58:25,760
but trap apt 33 and of course this week

1594
00:58:25,760 --> 00:58:27,040
we did cozy bear

1595
00:58:27,040 --> 00:58:29,119
definitely check it out i spent 10

1596
00:58:29,119 --> 00:58:31,359
minutes having coffee with jamie

1597
00:58:31,359 --> 00:58:32,880
williams from

1598
00:58:32,880 --> 00:58:35,520
mitre attack and just talking about cozy

1599
00:58:35,520 --> 00:58:36,799
bear is so cool

1600
00:58:36,799 --> 00:58:38,720
so definitely check it out we have more

1601
00:58:38,720 --> 00:58:41,440
coming uh to you in the coming weeks

1602
00:58:41,440 --> 00:58:44,720
and now vector we are doing a

1603
00:58:44,720 --> 00:58:47,839
free sans webcast next thursday july

1604
00:58:47,839 --> 00:58:50,559
2nd with the folks from vector so phil

1605
00:58:50,559 --> 00:58:51,839
wayne wright

1606
00:58:51,839 --> 00:58:54,880
awesome person one of the main the one

1607
00:58:54,880 --> 00:58:57,680
of the leads the lead not one the lead

1608
00:58:57,680 --> 00:59:00,720
of vector vector is for managing

1609
00:59:00,720 --> 00:59:02,640
and showing value of your red team

1610
00:59:02,640 --> 00:59:04,960
engagements and purple team exercises

1611
00:59:04,960 --> 00:59:06,559
we're going to do a webcast it's going

1612
00:59:06,559 --> 00:59:08,000
to be free july 2nd

1613
00:59:08,000 --> 00:59:11,280
so check us out all of these references

1614
00:59:11,280 --> 00:59:14,880
are there and

1615
00:59:14,880 --> 00:59:17,599
one minute to spare thank you thank you

1616
00:59:17,599 --> 00:59:19,119
thank you thank you thank you for your

1617
00:59:19,119 --> 00:59:20,000
time

1618
00:59:20,000 --> 00:59:22,960
thank you for joining me today um if

1619
00:59:22,960 --> 00:59:24,240
there's questions

1620
00:59:24,240 --> 00:59:27,839
i'm going to open up and say what's up

1621
00:59:27,839 --> 00:59:28,640
to you on

1622
00:59:28,640 --> 00:59:31,839
discord um are these slides

1623
00:59:31,839 --> 00:59:34,319
available the answer is yes these slides

1624
00:59:34,319 --> 00:59:35,839
are always available to you i'm gonna

1625
00:59:35,839 --> 00:59:37,280
post them right now

1626
00:59:37,280 --> 00:59:39,599
on discord and this recording is gonna

1627
00:59:39,599 --> 00:59:40,799
be posted as well

1628
00:59:40,799 --> 00:59:42,400
so thank you again for all your time

1629
00:59:42,400 --> 00:59:44,400
thank you for the organizers omar

1630
00:59:44,400 --> 00:59:46,319
you are awesome thank you so much for

1631
00:59:46,319 --> 00:59:47,920
everything and

1632
00:59:47,920 --> 00:59:49,760
keep it up we're we're only we're not

1633
00:59:49,760 --> 00:59:51,280
even halfway there right we got

1634
00:59:51,280 --> 00:59:53,760
a few more hours left few more hours

1635
00:59:53,760 --> 00:59:54,400
left and

1636
00:59:54,400 --> 00:59:56,160
great presentation jorge thank you so

1637
00:59:56,160 --> 00:59:57,599
much for your time for and so for

1638
00:59:57,599 --> 00:59:59,200
supporting us as well

1639
00:59:59,200 --> 01:00:00,880
so for all the attendees as already

1640
01:00:00,880 --> 01:00:03,119
mentioned please feel free to join

1641
01:00:03,119 --> 01:00:06,319
the conversation in our discord servers

1642
01:00:06,319 --> 01:00:08,160
you will find the link at the event

1643
01:00:08,160 --> 01:00:10,130
website which is in the bottom of the

1644
01:00:10,130 --> 01:00:12,839
[Music]

1645
01:00:12,839 --> 01:00:15,839
screen

1646
01:00:17,880 --> 01:00:20,880
easy

