1
00:00:10,580 --> 00:00:20,369
<font color="#CCCCCC">okay so now we</font><font color="#E5E5E5"> have Hannah on the</font><font color="#CCCCCC"> stage</font>

2
00:00:13,349 --> 00:00:24,750
<font color="#CCCCCC">please give</font><font color="#E5E5E5"> her</font><font color="#CCCCCC"> know her hand yeah</font><font color="#E5E5E5"> so</font>

3
00:00:20,369 --> 00:00:27,660
this<font color="#E5E5E5"> was a bit spontaneous but we want a</font>

4
00:00:24,750 --> 00:00:30,210
<font color="#E5E5E5">pony</font><font color="#CCCCCC"> Award</font><font color="#E5E5E5"> for this work and like people</font>

5
00:00:27,660 --> 00:00:31,920
<font color="#E5E5E5">came to me and said yeah congratulations</font>

6
00:00:30,210 --> 00:00:34,260
for the Tony Award but what was it about

7
00:00:31,920 --> 00:00:38,970
<font color="#E5E5E5">so I thought I should give a talk</font><font color="#CCCCCC"> about</font>

8
00:00:34,260 --> 00:00:44,040
<font color="#E5E5E5">that</font><font color="#CCCCCC"> so we discovered an attack in TLS</font>

9
00:00:38,970 --> 00:00:46,260
which we named the robot attack so<font color="#E5E5E5"> the</font>

10
00:00:44,040 --> 00:00:49,409
talk will contain a few formulas I hope

11
00:00:46,260 --> 00:00:54,360
nobody<font color="#CCCCCC"> is scared</font><font color="#E5E5E5"> of that but like some</font>

12
00:00:49,409 --> 00:00:56,159
<font color="#E5E5E5">basic math but yeah</font><font color="#CCCCCC"> so to understand its</font>

13
00:00:54,360 --> 00:01:01,320
attack where you need to have<font color="#CCCCCC"> a look at</font>

14
00:00:56,159 --> 00:01:03,629
the TLS handshake<font color="#CCCCCC"> so</font><font color="#E5E5E5"> so if we want to</font>

15
00:01:01,320 --> 00:01:05,670
start TLS connection<font color="#E5E5E5"> what we want to get</font>

16
00:01:03,629 --> 00:01:07,590
is that<font color="#E5E5E5"> a client and the server they</font>

17
00:01:05,670 --> 00:01:13,950
need to get a shared secret which they

18
00:01:07,590 --> 00:01:17,119
can<font color="#CCCCCC"> use for encryption</font><font color="#E5E5E5"> and there are two</font>

19
00:01:13,950 --> 00:01:19,950
major<font color="#E5E5E5"> ways how to do this there's the</font>

20
00:01:17,119 --> 00:01:22,320
traditional<font color="#E5E5E5"> all the way which is using</font>

21
00:01:19,950 --> 00:01:25,140
RSA encryption and then there's the more

22
00:01:22,320 --> 00:01:25,919
modern way<font color="#E5E5E5"> to use a</font><font color="#CCCCCC"> different key</font>

23
00:01:25,140 --> 00:01:29,310
<font color="#E5E5E5">exchange</font>

24
00:01:25,920 --> 00:01:30,869
this can still<font color="#E5E5E5"> use RSA but then RSA is</font>

25
00:01:29,310 --> 00:01:33,390
used for signatures and not for

26
00:01:30,869 --> 00:01:35,369
encryption<font color="#E5E5E5"> and this provides</font><font color="#CCCCCC"> so-called</font>

27
00:01:33,390 --> 00:01:39,689
<font color="#E5E5E5">forward secrecy which is a nice property</font>

28
00:01:35,369 --> 00:01:41,789
<font color="#E5E5E5">to have but attack I'm talking</font><font color="#CCCCCC"> about</font>

29
00:01:39,689 --> 00:01:45,139
this<font color="#E5E5E5"> about the RSA encryption</font><font color="#CCCCCC"> so the</font>

30
00:01:41,789 --> 00:01:48,060
older version of the<font color="#E5E5E5"> TLS handshake</font><font color="#CCCCCC"> and</font>

31
00:01:45,140 --> 00:01:51,060
this is how a TLS handshake looks like

32
00:01:48,060 --> 00:01:52,859
so<font color="#E5E5E5"> it starts that a client connects</font><font color="#CCCCCC"> to a</font>

33
00:01:51,060 --> 00:01:55,469
server with the<font color="#E5E5E5"> so called client</font><font color="#CCCCCC"> hello</font>

34
00:01:52,859 --> 00:01:57,538
<font color="#E5E5E5">message this basically contains what</font>

35
00:01:55,469 --> 00:02:01,139
version of TLS the client supports

36
00:01:57,539 --> 00:02:03,539
maximum<font color="#E5E5E5"> and what encryption methods it</font>

37
00:02:01,139 --> 00:02:05,850
supports and then the server<font color="#CCCCCC"> answer</font><font color="#E5E5E5"> spec</font>

38
00:02:03,539 --> 00:02:08,399
<font color="#E5E5E5">with what version the server supports</font>

39
00:02:05,850 --> 00:02:12,150
and which encryption method it<font color="#CCCCCC"> wants use</font>

40
00:02:08,399 --> 00:02:14,160
it sends back<font color="#E5E5E5"> a certificate and the</font>

41
00:02:12,150 --> 00:02:17,769
message<font color="#E5E5E5"> via the server hello done which</font>

42
00:02:14,160 --> 00:02:20,079
just ends this flow of<font color="#E5E5E5"> messages</font>

43
00:02:17,769 --> 00:02:21,579
and then<font color="#CCCCCC"> there comes</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> client key</font>

44
00:02:20,079 --> 00:02:23,829
exchange<font color="#E5E5E5"> and this is the interesting</font>

45
00:02:21,579 --> 00:02:27,819
part<font color="#CCCCCC"> because that is where this attack</font>

46
00:02:23,829 --> 00:02:31,750
<font color="#E5E5E5">happens which is in the case of RSA</font>

47
00:02:27,819 --> 00:02:34,450
essentially some random bytes that<font color="#CCCCCC"> are</font>

48
00:02:31,750 --> 00:02:38,620
encrypted<font color="#E5E5E5"> with RSA and these are yet</font>

49
00:02:34,450 --> 00:02:40,599
later used to<font color="#E5E5E5"> generate a key and then</font>

50
00:02:38,620 --> 00:02:43,780
this<font color="#CCCCCC"> change type respect basically means</font>

51
00:02:40,599 --> 00:02:45,310
starting here<font color="#E5E5E5"> we are encrypting and then</font>

52
00:02:43,780 --> 00:02:47,049
this finished message is some kind of

53
00:02:45,310 --> 00:02:48,970
<font color="#CCCCCC">integrity check over the handshake</font><font color="#E5E5E5"> but</font>

54
00:02:47,049 --> 00:02:54,489
the<font color="#E5E5E5"> relevant part is really this client</font>

55
00:02:48,970 --> 00:02:56,170
key exchange message<font color="#CCCCCC"> so that is an RSA</font>

56
00:02:54,489 --> 00:02:57,730
encrypted value and this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> so</font>

57
00:02:56,170 --> 00:02:59,798
<font color="#CCCCCC">called</font><font color="#E5E5E5"> premaster secret</font>

58
00:02:57,730 --> 00:03:06,459
it sounds very fancy<font color="#CCCCCC"> but it's really</font>

59
00:02:59,799 --> 00:03:09,129
<font color="#E5E5E5">just some</font><font color="#CCCCCC"> random data so if we look at</font>

60
00:03:06,459 --> 00:03:11,470
<font color="#CCCCCC">RSA so maybe at some point</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> have</font>

61
00:03:09,129 --> 00:03:13,629
heard some introduction to crypto where

62
00:03:11,470 --> 00:03:15,790
you<font color="#CCCCCC"> thought these formulas about RSA</font>

63
00:03:13,629 --> 00:03:21,370
where it says yeah you<font color="#E5E5E5"> encrypt something</font>

64
00:03:15,790 --> 00:03:23,819
<font color="#E5E5E5">by exponentiating it with a public</font><font color="#CCCCCC"> key</font>

65
00:03:21,370 --> 00:03:26,049
value and then modulus<font color="#E5E5E5"> another value and</font>

66
00:03:23,819 --> 00:03:27,790
decrypting is basically the same you

67
00:03:26,049 --> 00:03:33,280
<font color="#CCCCCC">just use the private key instead</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font>

68
00:03:27,790 --> 00:03:35,650
<font color="#E5E5E5">public key now this naive way of RSA</font>

69
00:03:33,280 --> 00:03:38,769
encryption is not really what we use in

70
00:03:35,650 --> 00:03:40,959
the<font color="#E5E5E5"> real world</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I often also get a</font>

71
00:03:38,769 --> 00:03:43,060
bit annoyed and angry when<font color="#CCCCCC"> people teach</font>

72
00:03:40,959 --> 00:03:48,669
this as that's how you do RSA because

73
00:03:43,060 --> 00:03:51,010
it's<font color="#E5E5E5"> really not</font><font color="#CCCCCC"> and there's so this is</font>

74
00:03:48,669 --> 00:03:53,409
what we call textbook RSA and it has a

75
00:03:51,010 --> 00:03:55,179
lot<font color="#CCCCCC"> of security problems so there's a</font>

76
00:03:53,409 --> 00:03:57,489
very obvious problem with that

77
00:03:55,180 --> 00:04:00,370
if you exponentiate something with the

78
00:03:57,489 --> 00:04:03,069
key let's<font color="#E5E5E5"> say we want to encrypt a zero</font>

79
00:04:00,370 --> 00:04:05,319
I<font color="#E5E5E5"> mean it's legit right why</font><font color="#CCCCCC"> not encrypt</font>

80
00:04:03,069 --> 00:04:07,238
to zero<font color="#E5E5E5"> well then we see this RSA</font>

81
00:04:05,319 --> 00:04:09,970
formula doesn't<font color="#E5E5E5"> do anything because the</font>

82
00:04:07,239 --> 00:04:12,370
zero stays zero<font color="#CCCCCC"> and the same if we want</font>

83
00:04:09,970 --> 00:04:16,358
to<font color="#CCCCCC"> encrypt the one</font><font color="#E5E5E5"> it also stays a one</font>

84
00:04:12,370 --> 00:04:17,399
so this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a quite obvious problem but</font>

85
00:04:16,358 --> 00:04:19,779
there are other problems<font color="#E5E5E5"> like</font>

86
00:04:17,399 --> 00:04:22,089
<font color="#E5E5E5">essentially if you encrypt any kind of</font>

87
00:04:19,779 --> 00:04:24,429
small<font color="#E5E5E5"> values you have a problem if you</font>

88
00:04:22,089 --> 00:04:27,070
encrypt things<font color="#E5E5E5"> where large parts of the</font>

89
00:04:24,430 --> 00:04:30,219
inputs are known<font color="#E5E5E5"> you get other problems</font>

90
00:04:27,070 --> 00:04:31,360
so that's not how we really<font color="#E5E5E5"> do it RSA so</font>

91
00:04:30,219 --> 00:04:34,629
what we do

92
00:04:31,360 --> 00:04:38,849
instead<font color="#CCCCCC"> we</font><font color="#E5E5E5"> use a form of padding before</font>

93
00:04:34,629 --> 00:04:41,259
we actually encrypt something<font color="#CCCCCC"> and the</font>

94
00:04:38,849 --> 00:04:50,259
padding<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is still the</font><font color="#E5E5E5"> most prevalent</font>

95
00:04:41,259 --> 00:04:56,680
is called pkcs1 version 1.5<font color="#E5E5E5"> and this is</font>

96
00:04:50,259 --> 00:04:58,389
how it looks<font color="#CCCCCC"> so we're starting with two</font>

97
00:04:56,680 --> 00:05:00,610
bytes which are the block type and these

98
00:04:58,389 --> 00:05:03,879
are for encryption just static<font color="#E5E5E5"> zero zero</font>

99
00:05:00,610 --> 00:05:07,689
<font color="#E5E5E5">zero two so this is just</font><font color="#CCCCCC"> indicating here</font>

100
00:05:03,879 --> 00:05:09,099
is an RSA encryption block<font color="#E5E5E5"> so if we're</font>

101
00:05:07,689 --> 00:05:12,580
<font color="#CCCCCC">using this mode this is obvious</font>

102
00:05:09,099 --> 00:05:15,580
aesthetic<font color="#E5E5E5"> this is always</font><font color="#CCCCCC"> the same then</font>

103
00:05:12,580 --> 00:05:18,719
we have random bytes<font color="#CCCCCC"> they are just there</font>

104
00:05:15,580 --> 00:05:22,240
<font color="#E5E5E5">to fill up the space</font><font color="#CCCCCC"> so they are just</font>

105
00:05:18,719 --> 00:05:25,840
padding<font color="#E5E5E5"> to so that we get to</font><font color="#CCCCCC"> a certain</font>

106
00:05:22,240 --> 00:05:27,849
<font color="#CCCCCC">length</font><font color="#E5E5E5"> but these bytes cannot contain a</font>

107
00:05:25,840 --> 00:05:31,539
zero<font color="#E5E5E5"> because there's a zero to indicate</font>

108
00:05:27,849 --> 00:05:32,919
<font color="#CCCCCC">that</font><font color="#E5E5E5"> here the padding ends then we have</font>

109
00:05:31,539 --> 00:05:35,378
something<font color="#CCCCCC"> which is kind</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> special for</font>

110
00:05:32,919 --> 00:05:38,020
TLS we have a version number here it

111
00:05:35,379 --> 00:05:42,520
says<font color="#CCCCCC"> 3 3 which obviously stands</font><font color="#E5E5E5"> for</font>

112
00:05:38,020 --> 00:05:44,349
<font color="#CCCCCC">tears</font><font color="#E5E5E5"> 1.2</font><font color="#CCCCCC"> if you don't find this obvious</font>

113
00:05:42,520 --> 00:05:46,870
I could give a<font color="#CCCCCC"> whole talk about here</font>

114
00:05:44,349 --> 00:05:50,800
less version numbers<font color="#E5E5E5"> it's a horrible</font>

115
00:05:46,870 --> 00:05:56,199
story<font color="#CCCCCC"> but that's how it is</font>

116
00:05:50,800 --> 00:05:58,539
<font color="#E5E5E5">and here it's 1.3 it's also</font><font color="#CCCCCC"> 3-3 it's a</font>

117
00:05:56,199 --> 00:06:01,089
horrible story<font color="#CCCCCC"> and then we have some</font>

118
00:05:58,539 --> 00:06:03,818
bytes and these are random<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that is</font>

119
00:06:01,089 --> 00:06:06,610
the<font color="#E5E5E5"> secret that we will later use for</font>

120
00:06:03,819 --> 00:06:09,460
our TLS encryption so this is a kind of

121
00:06:06,610 --> 00:06:12,250
the important part<font color="#E5E5E5"> the rest is</font><font color="#CCCCCC"> just</font>

122
00:06:09,460 --> 00:06:17,560
basically to<font color="#CCCCCC"> fill up space and have some</font>

123
00:06:12,250 --> 00:06:19,750
structure in<font color="#CCCCCC"> 1998 cryptographer called</font>

124
00:06:17,560 --> 00:06:26,250
<font color="#CCCCCC">Anya</font><font color="#E5E5E5"> blind Baha figured out that there's</font>

125
00:06:19,750 --> 00:06:28,810
a<font color="#E5E5E5"> problem</font><font color="#CCCCCC"> with this way of doing</font><font color="#E5E5E5"> RSA and</font>

126
00:06:26,250 --> 00:06:31,150
Daniel<font color="#CCCCCC"> blank Baha asked okay so this</font>

127
00:06:28,810 --> 00:06:34,689
decrypted<font color="#E5E5E5"> RSA block always starts</font><font color="#CCCCCC"> with</font>

128
00:06:31,150 --> 00:06:37,179
<font color="#E5E5E5">zero zero zero</font><font color="#CCCCCC"> two so what does the</font>

129
00:06:34,689 --> 00:06:38,740
server do if it decrypts something and

130
00:06:37,180 --> 00:06:41,589
it doesn't<font color="#CCCCCC"> start with</font><font color="#E5E5E5"> these two</font><font color="#CCCCCC"> bytes</font>

131
00:06:38,740 --> 00:06:43,930
and<font color="#CCCCCC"> now evilly</font><font color="#E5E5E5"> you could say yeah okay</font>

132
00:06:41,589 --> 00:06:44,770
it just rejects it and<font color="#CCCCCC"> sends an error</font>

133
00:06:43,930 --> 00:06:47,830
message

134
00:06:44,770 --> 00:06:51,159
right so<font color="#E5E5E5"> I mean something is wrong so we</font>

135
00:06:47,830 --> 00:06:53,258
just throw an error<font color="#CCCCCC"> the problem here is</font>

136
00:06:51,160 --> 00:06:55,870
that we<font color="#CCCCCC"> just gave the attacker some</font>

137
00:06:53,259 --> 00:06:58,560
information<font color="#E5E5E5"> and we gave the attacker</font>

138
00:06:55,870 --> 00:07:02,500
information about the encrypted<font color="#E5E5E5"> data</font>

139
00:06:58,560 --> 00:07:04,990
<font color="#CCCCCC">precisely we told the attacker</font><font color="#E5E5E5"> that this</font>

140
00:07:02,500 --> 00:07:08,919
decrypt the<font color="#E5E5E5"> ciphertext is within a</font>

141
00:07:04,990 --> 00:07:12,940
<font color="#E5E5E5">certain interval</font><font color="#CCCCCC"> because like if it's if</font>

142
00:07:08,919 --> 00:07:16,330
it starts with 0 0 0 2 then we know it

143
00:07:12,940 --> 00:07:21,669
can only be between 0 0 0<font color="#CCCCCC"> to 0 0</font><font color="#E5E5E5"> and so</font>

144
00:07:16,330 --> 00:07:24,460
<font color="#CCCCCC">on</font><font color="#E5E5E5"> and 0 0 0 to</font><font color="#CCCCCC"> FF and so on</font><font color="#E5E5E5"> and if if</font>

145
00:07:21,669 --> 00:07:26,830
it doesn't start with<font color="#E5E5E5"> 0 0 0 2 we know</font>

146
00:07:24,460 --> 00:07:28,690
it's<font color="#CCCCCC"> outside of</font><font color="#E5E5E5"> this interval so we have</font>

147
00:07:26,830 --> 00:07:33,460
some<font color="#E5E5E5"> information about the decrypted</font>

148
00:07:28,690 --> 00:07:36,190
<font color="#E5E5E5">data</font><font color="#CCCCCC"> then as it has a</font><font color="#E5E5E5"> property there</font>

149
00:07:33,460 --> 00:07:39,008
which is called malleability<font color="#E5E5E5"> which kind</font>

150
00:07:36,190 --> 00:07:42,009
of<font color="#E5E5E5"> means you can change</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> in crew RSA</font>

151
00:07:39,009 --> 00:07:43,900
encrypted data in a way that<font color="#CCCCCC"> creates a</font>

152
00:07:42,009 --> 00:07:48,370
predictable change in the decrypted<font color="#E5E5E5"> data</font>

153
00:07:43,900 --> 00:07:51,549
<font color="#E5E5E5">and particularly you can multiply an RSA</font>

154
00:07:48,370 --> 00:07:54,460
encrypted cipher text in a way that you

155
00:07:51,550 --> 00:08:00,520
get<font color="#E5E5E5"> the multiplication of the plaintext</font>

156
00:07:54,460 --> 00:08:02,289
input<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is a very basic math but it's</font>

157
00:08:00,520 --> 00:08:04,120
just what you need<font color="#E5E5E5"> to remember is</font><font color="#CCCCCC"> ok we</font>

158
00:08:02,289 --> 00:08:07,419
can make some control changes and

159
00:08:04,120 --> 00:08:11,710
<font color="#CCCCCC">particularly we can multiply the kind</font><font color="#E5E5E5"> of</font>

160
00:08:07,419 --> 00:08:13,419
the the<font color="#E5E5E5"> plaintext that we don't know but</font>

161
00:08:11,710 --> 00:08:15,130
<font color="#E5E5E5">we can change it in a way we can change</font>

162
00:08:13,419 --> 00:08:19,109
the<font color="#E5E5E5"> cipher text in a way that the plane</font>

163
00:08:15,130 --> 00:08:19,110
takes<font color="#E5E5E5"> also changes in a predictable way</font>

164
00:08:20,219 --> 00:08:27,520
so<font color="#E5E5E5"> ok</font><font color="#CCCCCC"> so what does it mean so what we</font>

165
00:08:26,169 --> 00:08:30,250
need to<font color="#CCCCCC"> remember is the crypto is</font>

166
00:08:27,520 --> 00:08:31,659
essentially just<font color="#E5E5E5"> math on numbers so when</font>

167
00:08:30,250 --> 00:08:33,099
we talk about keys when we talk about

168
00:08:31,659 --> 00:08:36,010
<font color="#E5E5E5">cipher texts they are all just</font>

169
00:08:33,099 --> 00:08:41,229
<font color="#E5E5E5">representations in numbers numbers you</font>

170
00:08:36,010 --> 00:08:43,750
<font color="#CCCCCC">are probably familiar with so ok and so</font>

171
00:08:41,229 --> 00:08:48,279
we<font color="#CCCCCC"> learnt</font><font color="#E5E5E5"> if we have a wet valid padding</font>

172
00:08:43,750 --> 00:08:50,470
that implies<font color="#CCCCCC"> that so if we do this this</font>

173
00:08:48,279 --> 00:08:55,410
manipulation<font color="#E5E5E5"> that I just told you the</font>

174
00:08:50,470 --> 00:08:58,060
malleability<font color="#CCCCCC"> and we kind</font><font color="#E5E5E5"> of know what</font>

175
00:08:55,410 --> 00:08:59,500
whether when we know whether<font color="#E5E5E5"> it starts</font>

176
00:08:58,060 --> 00:09:03,130
with zero zero<font color="#CCCCCC"> zero two we know</font>

177
00:08:59,500 --> 00:09:08,230
something about<font color="#E5E5E5"> a factor multiplied with</font>

178
00:09:03,130 --> 00:09:10,720
<font color="#CCCCCC">plaintext message so we can look at a</font>

179
00:09:08,230 --> 00:09:13,390
simple example which kind of illustrates

180
00:09:10,720 --> 00:09:16,480
what that means<font color="#E5E5E5"> so let us assume we have</font>

181
00:09:13,390 --> 00:09:18,870
a<font color="#CCCCCC"> number X</font><font color="#E5E5E5"> and we</font><font color="#CCCCCC"> know that</font><font color="#E5E5E5"> three</font>

182
00:09:16,480 --> 00:09:21,970
thousand thousand times this number

183
00:09:18,870 --> 00:09:25,350
starts<font color="#E5E5E5"> with four or five then</font><font color="#CCCCCC"> we know</font>

184
00:09:21,970 --> 00:09:29,220
<font color="#CCCCCC">that three thousand times this number</font><font color="#E5E5E5"> is</font>

185
00:09:25,350 --> 00:09:32,530
larger than<font color="#CCCCCC"> 45,000 and</font><font color="#E5E5E5"> it's smaller than</font>

186
00:09:29,220 --> 00:09:34,840
46,000 that is obvious<font color="#E5E5E5"> right that's kind</font>

187
00:09:32,530 --> 00:09:37,449
<font color="#CCCCCC">of the definition the number five digit</font>

188
00:09:34,840 --> 00:09:39,610
starts with these two numbers so we<font color="#CCCCCC"> can</font>

189
00:09:37,450 --> 00:09:41,950
also<font color="#E5E5E5"> calculate then what this means for</font>

190
00:09:39,610 --> 00:09:47,980
X and we know<font color="#E5E5E5"> that X is between some</font>

191
00:09:41,950 --> 00:09:50,500
certain values<font color="#CCCCCC"> if we know the same</font><font color="#E5E5E5"> for</font>

192
00:09:47,980 --> 00:09:53,860
let's say three thousand<font color="#E5E5E5"> ten times X</font>

193
00:09:50,500 --> 00:09:57,250
then we can<font color="#E5E5E5"> narrow the interval for X we</font>

194
00:09:53,860 --> 00:10:00,010
learn<font color="#E5E5E5"> something more about X we we can</font>

195
00:09:57,250 --> 00:10:02,560
<font color="#E5E5E5">have</font><font color="#CCCCCC"> a narrow narrow</font><font color="#E5E5E5"> interval of what we</font>

196
00:10:00,010 --> 00:10:05,319
assume<font color="#E5E5E5"> X is and if we do this long</font>

197
00:10:02,560 --> 00:10:13,839
<font color="#CCCCCC">enough</font><font color="#E5E5E5"> we can get a more precise</font>

198
00:10:05,320 --> 00:10:16,600
<font color="#CCCCCC">measurement of</font><font color="#E5E5E5"> X so yeah</font><font color="#CCCCCC"> and we can do</font>

199
00:10:13,840 --> 00:10:19,360
the same with<font color="#E5E5E5"> RSA</font><font color="#CCCCCC"> it works a bit</font>

200
00:10:16,600 --> 00:10:21,310
differently because we're not working<font color="#CCCCCC"> on</font>

201
00:10:19,360 --> 00:10:24,970
real numbers<font color="#E5E5E5"> we're working</font><font color="#CCCCCC"> inside this</font>

202
00:10:21,310 --> 00:10:26,380
modulus<font color="#CCCCCC"> but essentially what Daniel</font>

203
00:10:24,970 --> 00:10:28,450
blocking but have figured out is<font color="#CCCCCC"> that</font>

204
00:10:26,380 --> 00:10:31,960
<font color="#E5E5E5">there is an algorithm where if you have</font>

205
00:10:28,450 --> 00:10:34,030
enough<font color="#CCCCCC"> of these if you get enough</font>

206
00:10:31,960 --> 00:10:35,920
<font color="#CCCCCC">information about</font><font color="#E5E5E5"> these whether</font>

207
00:10:34,030 --> 00:10:39,240
something starts with this block or<font color="#CCCCCC"> not</font>

208
00:10:35,920 --> 00:10:41,860
<font color="#E5E5E5">then you can in the end</font><font color="#CCCCCC"> narrow the</font>

209
00:10:39,240 --> 00:10:43,330
interval of<font color="#E5E5E5"> what the plaintext is more</font>

210
00:10:41,860 --> 00:10:47,830
and<font color="#CCCCCC"> more and at some point you can just</font>

211
00:10:43,330 --> 00:10:54,340
<font color="#E5E5E5">brute force it and yeah then you learn</font>

212
00:10:47,830 --> 00:10:57,880
<font color="#E5E5E5">about the decrypted value so there are</font>

213
00:10:54,340 --> 00:11:01,270
some<font color="#CCCCCC"> variations of this so I said so the</font>

214
00:10:57,880 --> 00:11:03,220
ideal attack works<font color="#CCCCCC"> if the server just</font>

215
00:11:01,270 --> 00:11:06,069
tells us whether these two<font color="#E5E5E5"> bytes at the</font>

216
00:11:03,220 --> 00:11:08,350
beginning are correct or not<font color="#E5E5E5"> but</font><font color="#CCCCCC"> we also</font>

217
00:11:06,070 --> 00:11:10,960
have other servers were

218
00:11:08,350 --> 00:11:12,700
it may behave differently<font color="#E5E5E5"> depending on</font>

219
00:11:10,960 --> 00:11:14,650
<font color="#E5E5E5">whether in this random</font><font color="#CCCCCC"> padding there are</font>

220
00:11:12,700 --> 00:11:17,850
<font color="#E5E5E5">zeros or whether this version number is</font>

221
00:11:14,650 --> 00:11:20,439
<font color="#E5E5E5">different so we sometimes get not</font>

222
00:11:17,850 --> 00:11:22,480
<font color="#E5E5E5">directly this information that it starts</font>

223
00:11:20,440 --> 00:11:24,760
<font color="#E5E5E5">with zero zero zero two or not but only</font>

224
00:11:22,480 --> 00:11:27,190
with some probability and then we<font color="#E5E5E5"> talk</font>

225
00:11:24,760 --> 00:11:34,450
<font color="#CCCCCC">of different strengths of Oracle's but</font>

226
00:11:27,190 --> 00:11:36,970
yeah so now you<font color="#E5E5E5"> might wonder okay how do</font>

227
00:11:34,450 --> 00:11:39,490
we<font color="#E5E5E5"> fix this and of course this was in</font>

228
00:11:36,970 --> 00:11:42,520
1998<font color="#E5E5E5"> so people thought</font><font color="#CCCCCC"> okay we need to</font>

229
00:11:39,490 --> 00:11:45,130
do<font color="#E5E5E5"> something about it</font><font color="#CCCCCC"> and the next</font>

230
00:11:42,520 --> 00:11:50,500
version of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> TLS nerd worst year is</font>

231
00:11:45,130 --> 00:11:53,020
1.0<font color="#E5E5E5"> before it was called SSL</font><font color="#CCCCCC"> yeah and</font>

232
00:11:50,500 --> 00:11:54,940
this<font color="#CCCCCC"> is okay the</font><font color="#E5E5E5"> best way to avoid when</font>

233
00:11:53,020 --> 00:11:56,860
ability to this attack is to treat

234
00:11:54,940 --> 00:11:58,750
<font color="#E5E5E5">incorrectly formatted messages in a</font>

235
00:11:56,860 --> 00:12:00,190
manner indistinguishable<font color="#E5E5E5"> from correctly</font>

236
00:11:58,750 --> 00:12:02,710
formatted RSA blocks

237
00:12:00,190 --> 00:12:04,870
thus when it receives an incorrectly for

238
00:12:02,710 --> 00:12:07,420
<font color="#E5E5E5">RSA block a server should generate a</font>

239
00:12:04,870 --> 00:12:11,200
random 48 byte value and proceed using

240
00:12:07,420 --> 00:12:13,500
<font color="#E5E5E5">it as the premaster secret so the idea</font>

241
00:12:11,200 --> 00:12:17,350
here is<font color="#E5E5E5"> if</font><font color="#CCCCCC"> a server gets a wrong</font>

242
00:12:13,500 --> 00:12:19,990
decryption<font color="#E5E5E5"> then it pretends everything</font>

243
00:12:17,350 --> 00:12:22,840
is<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> but it will continue the</font>

244
00:12:19,990 --> 00:12:25,120
<font color="#E5E5E5">handshake with randomly generated data</font>

245
00:12:22,840 --> 00:12:27,220
and then the handshake will fail<font color="#E5E5E5"> later</font>

246
00:12:25,120 --> 00:12:34,180
because server and client have different

247
00:12:27,220 --> 00:12:37,870
<font color="#E5E5E5">keys this sounds a bit weird maybe a bit</font>

248
00:12:34,180 --> 00:12:41,589
yeah<font color="#E5E5E5"> but that is the defense they can</font>

249
00:12:37,870 --> 00:12:45,460
office now turn out this this was yeah

250
00:12:41,590 --> 00:12:47,470
<font color="#E5E5E5">so yeah that's it what I just said it</font>

251
00:12:45,460 --> 00:12:50,530
turns out this was<font color="#CCCCCC"> not entirely</font>

252
00:12:47,470 --> 00:12:53,200
sufficient<font color="#E5E5E5"> so in TLS 1.2 the section got</font>

253
00:12:50,530 --> 00:12:55,839
a bit longer<font color="#CCCCCC"> it</font><font color="#E5E5E5"> says as described by him</font>

254
00:12:53,200 --> 00:12:58,240
as a<font color="#CCCCCC"> clima he he wrote a paper that</font>

255
00:12:55,840 --> 00:12:59,950
<font color="#E5E5E5">where he basically could show</font><font color="#CCCCCC"> that some</font>

256
00:12:58,240 --> 00:13:01,240
implementations<font color="#E5E5E5"> even if they implemented</font>

257
00:12:59,950 --> 00:13:04,740
<font color="#E5E5E5">this countermeasure they were still</font>

258
00:13:01,240 --> 00:13:08,530
vulnerable to<font color="#CCCCCC"> a variation of</font><font color="#E5E5E5"> this attack</font>

259
00:13:04,740 --> 00:13:10,480
<font color="#CCCCCC">so one thing here that is different is</font>

260
00:13:08,530 --> 00:13:12,459
<font color="#CCCCCC">that you should generate this random</font>

261
00:13:10,480 --> 00:13:15,370
data<font color="#CCCCCC"> even before</font><font color="#E5E5E5"> you start decrypting</font>

262
00:13:12,460 --> 00:13:17,230
<font color="#E5E5E5">anything and the reason</font><font color="#CCCCCC"> for that</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> that</font>

263
00:13:15,370 --> 00:13:19,330
it could<font color="#E5E5E5"> lead to timing attacks if you</font>

264
00:13:17,230 --> 00:13:21,190
only generate this random data<font color="#E5E5E5"> after you</font>

265
00:13:19,330 --> 00:13:23,170
got a wrong block

266
00:13:21,190 --> 00:13:26,980
and then it has this<font color="#E5E5E5"> kind of complicated</font>

267
00:13:23,170 --> 00:13:28,810
algorithm here what you should do<font color="#E5E5E5"> but</font>

268
00:13:26,980 --> 00:13:32,590
also it proposes<font color="#E5E5E5"> you another algorithm</font>

269
00:13:28,810 --> 00:13:34,630
<font color="#E5E5E5">which is equally complicated</font><font color="#CCCCCC"> and then it</font>

270
00:13:32,590 --> 00:13:36,580
<font color="#E5E5E5">tells you although no practical attacks</font>

271
00:13:34,630 --> 00:13:38,110
<font color="#E5E5E5">against this construction are known</font><font color="#CCCCCC"> you</font>

272
00:13:36,580 --> 00:13:39,580
might all describe some theoretically

273
00:13:38,110 --> 00:13:42,130
attacks<font color="#E5E5E5"> and therefore the first</font>

274
00:13:39,580 --> 00:13:43,990
<font color="#E5E5E5">constructor is recommended so you get</font>

275
00:13:42,130 --> 00:13:45,730
<font color="#E5E5E5">kind of you get two ways to prevent this</font>

276
00:13:43,990 --> 00:13:47,290
attack then they tell you should use the

277
00:13:45,730 --> 00:13:50,890
first<font color="#E5E5E5"> one but you could still</font><font color="#CCCCCC"> use the</font>

278
00:13:47,290 --> 00:13:53,260
second one<font color="#E5E5E5"> not really clear why</font><font color="#CCCCCC"> but and</font>

279
00:13:50,890 --> 00:13:55,180
also<font color="#CCCCCC"> yeah in any case that TLS server</font>

280
00:13:53,260 --> 00:13:57,490
must not generate an alert<font color="#E5E5E5"> if processing</font>

281
00:13:55,180 --> 00:13:58,839
<font color="#CCCCCC">is a cryptid premaster secret phase or</font>

282
00:13:57,490 --> 00:14:01,140
<font color="#CCCCCC">the version</font><font color="#E5E5E5"> number</font><font color="#CCCCCC"> is not as expected</font>

283
00:13:58,840 --> 00:14:04,570
<font color="#E5E5E5">and so on and so on</font>

284
00:14:01,140 --> 00:14:06,910
<font color="#CCCCCC">and also</font><font color="#E5E5E5"> the this nice note here however</font>

285
00:14:04,570 --> 00:14:09,280
<font color="#E5E5E5">care must be taken to avoid leaking the</font>

286
00:14:06,910 --> 00:14:10,900
information to an attacker<font color="#E5E5E5"> through for</font>

287
00:14:09,280 --> 00:14:15,189
example timing<font color="#E5E5E5"> log files or other</font>

288
00:14:10,900 --> 00:14:17,350
channels<font color="#E5E5E5"> so to summarize this</font><font color="#CCCCCC"> a server</font>

289
00:14:15,190 --> 00:14:19,510
generates a random value<font color="#E5E5E5"> before pausing</font>

290
00:14:17,350 --> 00:14:19,920
<font color="#E5E5E5">the message just in case something</font><font color="#CCCCCC"> goes</font>

291
00:14:19,510 --> 00:14:28,810
wrong

292
00:14:19,920 --> 00:14:31,870
as a question since<font color="#E5E5E5"> the message has a</font>

293
00:14:28,810 --> 00:14:34,119
specific length<font color="#E5E5E5"> why</font><font color="#CCCCCC"> why</font><font color="#E5E5E5"> aren't they used</font>

294
00:14:31,870 --> 00:14:35,500
adding some random bytes at the

295
00:14:34,120 --> 00:14:37,150
beginning or at<font color="#CCCCCC"> the end of the message</font>

296
00:14:35,500 --> 00:14:38,100
and<font color="#CCCCCC"> you get into specific bytes they</font>

297
00:14:37,150 --> 00:14:40,600
need

298
00:14:38,100 --> 00:14:42,970
sorry<font color="#E5E5E5"> why why do they</font><font color="#CCCCCC"> choose suits a</font>

299
00:14:40,600 --> 00:14:46,900
complicated complicated<font color="#E5E5E5"> padding</font><font color="#CCCCCC"> columns</font>

300
00:14:42,970 --> 00:14:49,450
<font color="#E5E5E5">when they could use put specific</font><font color="#CCCCCC"> parts</font>

301
00:14:46,900 --> 00:14:55,000
of the brain master secret<font color="#E5E5E5"> prepared with</font>

302
00:14:49,450 --> 00:14:59,320
use random data<font color="#E5E5E5"> for</font><font color="#CCCCCC"> example I think I</font>

303
00:14:55,000 --> 00:15:02,290
know what<font color="#E5E5E5"> I mean I haven't come I didn't</font>

304
00:14:59,320 --> 00:15:03,910
come up<font color="#E5E5E5"> with this</font><font color="#CCCCCC"> I it's amazingly</font>

305
00:15:02,290 --> 00:15:08,469
complicated and I<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> think it's a</font>

306
00:15:03,910 --> 00:15:11,050
good idea<font color="#E5E5E5"> so I'm not sure</font><font color="#CCCCCC"> if what you're</font>

307
00:15:08,470 --> 00:15:17,650
proposing would work<font color="#CCCCCC"> I would have to</font>

308
00:15:11,050 --> 00:15:21,010
<font color="#CCCCCC">think about</font><font color="#E5E5E5"> that but yeah</font><font color="#CCCCCC"> okay so to</font>

309
00:15:17,650 --> 00:15:24,089
summarize it so you generate a random

310
00:15:21,010 --> 00:15:26,980
value<font color="#E5E5E5"> just in case something</font><font color="#CCCCCC"> goes wrong</font>

311
00:15:24,089 --> 00:15:29,950
<font color="#CCCCCC">if the message has any form of bad</font>

312
00:15:26,980 --> 00:15:32,110
padding then<font color="#CCCCCC"> you're you're replacing</font>

313
00:15:29,950 --> 00:15:34,440
whatever you decrypted with<font color="#E5E5E5"> that random</font>

314
00:15:32,110 --> 00:15:34,440
value

315
00:15:34,780 --> 00:15:39,280
if the message has a bad version<font color="#E5E5E5"> that's</font>

316
00:15:37,330 --> 00:15:41,290
kind<font color="#CCCCCC"> of a</font><font color="#E5E5E5"> special case this is these two</font>

317
00:15:39,280 --> 00:15:43,300
different<font color="#E5E5E5"> algorithms you can choose</font>

318
00:15:41,290 --> 00:15:45,040
whether<font color="#CCCCCC"> to replace</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> with a random</font>

319
00:15:43,300 --> 00:15:47,650
value or whether<font color="#E5E5E5"> you're trying</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> fix</font>

320
00:15:45,040 --> 00:15:51,490
the version number that has a very

321
00:15:47,650 --> 00:15:54,100
obscure argument in the paper<font color="#E5E5E5"> it's not</font>

322
00:15:51,490 --> 00:15:56,800
that relevant<font color="#E5E5E5"> then it says okay the</font>

323
00:15:54,100 --> 00:15:58,480
second version is better<font color="#E5E5E5"> but as we like</font>

324
00:15:56,800 --> 00:15:59,979
<font color="#E5E5E5">to make</font><font color="#CCCCCC"> things more complicated</font><font color="#E5E5E5"> in the</font>

325
00:15:58,480 --> 00:16:03,370
standard longer<font color="#E5E5E5"> we give you two versions</font>

326
00:15:59,980 --> 00:16:05,440
<font color="#CCCCCC">that you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> choose one also</font><font color="#E5E5E5"> everything</font>

327
00:16:03,370 --> 00:16:09,370
<font color="#E5E5E5">must be timing safe and you need to</font>

328
00:16:05,440 --> 00:16:12,910
<font color="#CCCCCC">figure out how to do that</font><font color="#E5E5E5"> best</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> that's</font>

329
00:16:09,370 --> 00:16:17,710
<font color="#E5E5E5">totally easy</font><font color="#CCCCCC"> right everyone will get</font>

330
00:16:12,910 --> 00:16:19,959
<font color="#E5E5E5">this right</font><font color="#CCCCCC"> and of</font><font color="#E5E5E5"> course as this attack</font>

331
00:16:17,710 --> 00:16:22,540
has been known since 1998 and<font color="#CCCCCC"> it's well</font>

332
00:16:19,960 --> 00:16:24,220
documented<font color="#CCCCCC"> I mean if you do a crypto</font>

333
00:16:22,540 --> 00:16:26,349
introduction you<font color="#CCCCCC"> will usually</font><font color="#E5E5E5"> teach this</font>

334
00:16:24,220 --> 00:16:28,000
attack so everyone knows<font color="#E5E5E5"> about it and</font>

335
00:16:26,350 --> 00:16:29,830
<font color="#E5E5E5">everyone has</font><font color="#CCCCCC"> requesting tests right</font>

336
00:16:28,000 --> 00:16:33,640
<font color="#E5E5E5">that's how we do software development</font>

337
00:16:29,830 --> 00:16:36,940
<font color="#E5E5E5">right</font><font color="#CCCCCC"> maybe that's</font><font color="#E5E5E5"> not how it works in</font>

338
00:16:33,640 --> 00:16:38,980
the real<font color="#E5E5E5"> world so at some point I</font>

339
00:16:36,940 --> 00:16:42,700
thought maybe you want<font color="#CCCCCC"> to test</font><font color="#E5E5E5"> if this</font>

340
00:16:38,980 --> 00:16:44,950
attack<font color="#E5E5E5"> has really been fixed so how do</font>

341
00:16:42,700 --> 00:16:48,089
you do that<font color="#E5E5E5"> basically</font><font color="#CCCCCC"> you send out a</font>

342
00:16:44,950 --> 00:16:50,920
bunch<font color="#E5E5E5"> of broken RSA key exchanges</font><font color="#CCCCCC"> and</font>

343
00:16:48,089 --> 00:16:54,550
then you check<font color="#E5E5E5"> if you get different</font>

344
00:16:50,920 --> 00:16:56,709
<font color="#E5E5E5">results</font><font color="#CCCCCC"> so and it doesn't really matter</font>

345
00:16:54,550 --> 00:17:00,939
how they<font color="#CCCCCC"> are different this</font><font color="#E5E5E5"> can be</font>

346
00:16:56,710 --> 00:17:03,310
different<font color="#CCCCCC"> yes alerts</font><font color="#E5E5E5"> this can be we had</font>

347
00:17:00,940 --> 00:17:06,069
situations<font color="#CCCCCC"> where so it sent</font><font color="#E5E5E5"> a duplicate</font>

348
00:17:03,310 --> 00:17:08,169
alert which is not really considered<font color="#CCCCCC"> in</font>

349
00:17:06,069 --> 00:17:10,139
the standard but<font color="#CCCCCC"> it happens or if you</font>

350
00:17:08,170 --> 00:17:12,310
get connection resets or timeout

351
00:17:10,140 --> 00:17:14,260
<font color="#E5E5E5">anything how you can distinguish</font><font color="#CCCCCC"> between</font>

352
00:17:12,310 --> 00:17:16,419
these different<font color="#E5E5E5"> states whether this</font>

353
00:17:14,260 --> 00:17:20,339
padding is correct or not<font color="#E5E5E5"> you can use</font>

354
00:17:16,420 --> 00:17:23,560
for an attack<font color="#CCCCCC"> the</font><font color="#E5E5E5"> first it was</font>

355
00:17:20,339 --> 00:17:25,720
<font color="#CCCCCC">facebook.com so I scanned them the</font><font color="#E5E5E5"> Alexa</font>

356
00:17:23,560 --> 00:17:30,610
top 1 million<font color="#E5E5E5"> I think Facebook is number</font>

357
00:17:25,720 --> 00:17:33,700
<font color="#E5E5E5">3</font><font color="#CCCCCC"> and I thought okay</font><font color="#E5E5E5"> we have to attack</font>

358
00:17:30,610 --> 00:17:35,469
Facebook<font color="#E5E5E5"> and then I thought</font><font color="#CCCCCC"> okay it</font>

359
00:17:33,700 --> 00:17:37,060
would be<font color="#E5E5E5"> really cool if we could sign a</font>

360
00:17:35,470 --> 00:17:39,340
message<font color="#E5E5E5"> with the private key</font><font color="#CCCCCC"> from</font>

361
00:17:37,060 --> 00:17:40,960
Facebook because then kind<font color="#E5E5E5"> of we would</font>

362
00:17:39,340 --> 00:17:45,040
have cryptographic proof that this

363
00:17:40,960 --> 00:17:48,020
really<font color="#E5E5E5"> happened</font><font color="#CCCCCC"> I reached out</font><font color="#E5E5E5"> to a</font>

364
00:17:45,040 --> 00:17:50,060
friend<font color="#CCCCCC"> yo reso moravsky because I</font><font color="#E5E5E5"> knew</font>

365
00:17:48,020 --> 00:17:52,370
he had been<font color="#E5E5E5"> doing research on biking</font>

366
00:17:50,060 --> 00:17:55,820
<font color="#CCCCCC">Baja</font><font color="#E5E5E5"> text before</font><font color="#CCCCCC"> and together</font><font color="#E5E5E5"> we tried</font>

367
00:17:52,370 --> 00:17:57,709
to<font color="#CCCCCC"> implement this attack this attack</font>

368
00:17:55,820 --> 00:18:02,810
needs<font color="#E5E5E5"> several thousands of</font><font color="#CCCCCC"> connections</font>

369
00:17:57,710 --> 00:18:05,390
so we<font color="#E5E5E5"> needed it to</font><font color="#CCCCCC"> be fast one thing we</font>

370
00:18:02,810 --> 00:18:08,990
did is we<font color="#E5E5E5"> tried all the AWS locations</font>

371
00:18:05,390 --> 00:18:11,870
and figured out<font color="#E5E5E5"> okay if we use the u.s.</font>

372
00:18:08,990 --> 00:18:13,850
<font color="#E5E5E5">west</font><font color="#CCCCCC"> coast location on AWS we get ping</font>

373
00:18:11,870 --> 00:18:16,280
<font color="#E5E5E5">times down to between</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> three</font>

374
00:18:13,850 --> 00:18:20,389
<font color="#E5E5E5">milliseconds which is very nice this</font>

375
00:18:16,280 --> 00:18:23,030
accelerated<font color="#E5E5E5"> or take a lot later we also</font>

376
00:18:20,390 --> 00:18:24,950
figured<font color="#E5E5E5"> out that if you have a</font><font color="#CCCCCC"> lot of</font>

377
00:18:23,030 --> 00:18:28,940
short connections you want to use this

378
00:18:24,950 --> 00:18:34,280
option TCP no delay<font color="#CCCCCC"> then you get many</font>

379
00:18:28,940 --> 00:18:36,320
<font color="#E5E5E5">more connections sequentially and yeah</font>

380
00:18:34,280 --> 00:18:38,450
<font color="#E5E5E5">after several attempts we we managed to</font>

381
00:18:36,320 --> 00:18:40,159
do it<font color="#E5E5E5"> we successfully signed a message</font>

382
00:18:38,450 --> 00:18:42,650
with Facebook's key we have also

383
00:18:40,160 --> 00:18:45,040
<font color="#CCCCCC">published this message so</font><font color="#E5E5E5"> you can all of</font>

384
00:18:42,650 --> 00:18:50,150
<font color="#CCCCCC">you</font><font color="#E5E5E5"> can verify that this</font><font color="#CCCCCC"> is really</font>

385
00:18:45,040 --> 00:18:51,980
correctly signed with Facebook's key so

386
00:18:50,150 --> 00:18:53,660
then of course we reported it to

387
00:18:51,980 --> 00:18:56,990
<font color="#E5E5E5">Facebook through their bug bounty</font>

388
00:18:53,660 --> 00:19:03,080
program and then they fixed it<font color="#CCCCCC"> around</font><font color="#E5E5E5"> a</font>

389
00:18:56,990 --> 00:19:06,710
week later<font color="#CCCCCC"> so then a face after that we</font>

390
00:19:03,080 --> 00:19:08,810
<font color="#CCCCCC">always got</font><font color="#E5E5E5"> the same tier as alert when</font>

391
00:19:06,710 --> 00:19:14,300
we send<font color="#E5E5E5"> these different my front message</font>

392
00:19:08,810 --> 00:19:19,480
so that<font color="#E5E5E5"> seemed</font><font color="#CCCCCC"> kind of correct except if</font>

393
00:19:14,300 --> 00:19:22,909
you remember this<font color="#E5E5E5"> handshake</font><font color="#CCCCCC"> you see that</font>

394
00:19:19,480 --> 00:19:24,800
<font color="#E5E5E5">usually there this</font><font color="#CCCCCC"> cranky exchange</font><font color="#E5E5E5"> and</font>

395
00:19:22,910 --> 00:19:27,950
these other messages they are<font color="#E5E5E5"> sent</font>

396
00:19:24,800 --> 00:19:30,080
together<font color="#E5E5E5"> because they are at the</font><font color="#CCCCCC"> same</font>

397
00:19:27,950 --> 00:19:33,380
point<font color="#E5E5E5"> in the protocol so</font><font color="#CCCCCC"> it makes sense</font>

398
00:19:30,080 --> 00:19:35,659
<font color="#E5E5E5">to</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> send them all in one</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> what</font>

399
00:19:33,380 --> 00:19:39,800
happens if you just<font color="#E5E5E5"> don't do that</font>

400
00:19:35,660 --> 00:19:42,950
<font color="#E5E5E5">and you can do that and it turned out if</font>

401
00:19:39,800 --> 00:19:48,040
we did that<font color="#CCCCCC"> Facebook was vulnerable</font>

402
00:19:42,950 --> 00:19:51,620
again so we could sign another message

403
00:19:48,040 --> 00:19:56,389
so yeah<font color="#E5E5E5"> we reported it and then they</font>

404
00:19:51,620 --> 00:20:00,379
really fixed<font color="#CCCCCC"> it so and what happened</font>

405
00:19:56,390 --> 00:20:01,750
there was that<font color="#E5E5E5"> like when we had a</font>

406
00:20:00,380 --> 00:20:04,240
message<font color="#E5E5E5"> with a bad</font>

407
00:20:01,750 --> 00:20:07,270
<font color="#CCCCCC">petting then we immediately got the</font>

408
00:20:04,240 --> 00:20:09,970
<font color="#E5E5E5">connection terminated</font><font color="#CCCCCC"> and when we had a</font>

409
00:20:07,270 --> 00:20:11,650
<font color="#E5E5E5">message was a correct petting</font><font color="#CCCCCC"> it would</font>

410
00:20:09,970 --> 00:20:15,700
just leave the connection<font color="#E5E5E5"> open</font><font color="#CCCCCC"> and we</font>

411
00:20:11,650 --> 00:20:17,470
<font color="#E5E5E5">had a time out at some</font><font color="#CCCCCC"> point Facebook</font>

412
00:20:15,700 --> 00:20:21,130
was of course not<font color="#CCCCCC"> the only</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> herbal</font>

413
00:20:17,470 --> 00:20:27,430
<font color="#E5E5E5">host</font><font color="#CCCCCC"> we had we discovered devices from</font>

414
00:20:21,130 --> 00:20:30,280
f5<font color="#E5E5E5"> they send a TLS alert versus a</font><font color="#CCCCCC"> a</font>

415
00:20:27,430 --> 00:20:33,190
<font color="#CCCCCC">timeout leaving the connection open</font>

416
00:20:30,280 --> 00:20:35,080
we had devices from Citrix where it was

417
00:20:33,190 --> 00:20:36,790
the other way around<font color="#CCCCCC"> there in the</font>

418
00:20:35,080 --> 00:20:40,090
invalid<font color="#E5E5E5"> padding the connection was left</font>

419
00:20:36,790 --> 00:20:42,399
open<font color="#CCCCCC"> this was a bit annoying</font><font color="#E5E5E5"> because we</font>

420
00:20:40,090 --> 00:20:43,870
have many<font color="#E5E5E5"> more of messages with an</font>

421
00:20:42,400 --> 00:20:45,790
invalid padding than with a valid

422
00:20:43,870 --> 00:20:47,560
padding so this made the attack kind of

423
00:20:45,790 --> 00:20:53,770
<font color="#E5E5E5">impractical because we had all this time</font>

424
00:20:47,560 --> 00:20:58,000
<font color="#E5E5E5">out</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so what is the impact of such an</font>

425
00:20:53,770 --> 00:20:59,650
attack<font color="#E5E5E5"> so as I said earlier there</font><font color="#CCCCCC"> are</font>

426
00:20:58,000 --> 00:21:02,200
these two<font color="#E5E5E5"> different</font><font color="#CCCCCC"> ways of doing here</font>

427
00:20:59,650 --> 00:21:04,180
<font color="#CCCCCC">lesson tricks the</font><font color="#E5E5E5"> RS</font><font color="#CCCCCC"> a1 and the</font>

428
00:21:02,200 --> 00:21:06,430
diffie-hellman<font color="#E5E5E5"> one and if you have a</font>

429
00:21:04,180 --> 00:21:08,950
server that<font color="#E5E5E5"> only supports these RS a</font>

430
00:21:06,430 --> 00:21:11,020
handshake then this attack is kind of

431
00:21:08,950 --> 00:21:14,290
<font color="#E5E5E5">really bad because you just record</font>

432
00:21:11,020 --> 00:21:15,850
<font color="#E5E5E5">traffic and then you can decrypt it so I</font>

433
00:21:14,290 --> 00:21:19,690
<font color="#E5E5E5">don't know you can read passwords or</font>

434
00:21:15,850 --> 00:21:25,149
whatever<font color="#CCCCCC"> however</font><font color="#E5E5E5"> these days most people</font>

435
00:21:19,690 --> 00:21:26,350
<font color="#CCCCCC">is</font><font color="#E5E5E5"> there a</font><font color="#CCCCCC"> question ok these</font><font color="#E5E5E5"> days most</font>

436
00:21:25,150 --> 00:21:29,950
<font color="#CCCCCC">people use these more</font><font color="#E5E5E5"> modern</font>

437
00:21:26,350 --> 00:21:32,679
diffie-hellman modes and then<font color="#E5E5E5"> it's a bit</font>

438
00:21:29,950 --> 00:21:34,710
<font color="#E5E5E5">more tricky so then if the</font><font color="#CCCCCC"> both the</font>

439
00:21:32,680 --> 00:21:39,070
server and<font color="#E5E5E5"> the client support these</font>

440
00:21:34,710 --> 00:21:41,650
forward secrecy modes then<font color="#CCCCCC"> you cannot</font>

441
00:21:39,070 --> 00:21:43,810
just decrypt data<font color="#E5E5E5"> and you might be able</font>

442
00:21:41,650 --> 00:21:45,520
<font color="#E5E5E5">to do a man-in-the-middle attack but</font>

443
00:21:43,810 --> 00:21:47,200
this is challenging<font color="#CCCCCC"> because then</font>

444
00:21:45,520 --> 00:21:51,070
essentially<font color="#E5E5E5"> you have to</font><font color="#CCCCCC"> perform this</font>

445
00:21:47,200 --> 00:21:53,230
attack during<font color="#E5E5E5"> the handshake and we are</font>

446
00:21:51,070 --> 00:21:55,510
<font color="#E5E5E5">talking about tens of thousands of</font>

447
00:21:53,230 --> 00:21:57,010
connections<font color="#E5E5E5"> so getting this down fast</font>

448
00:21:55,510 --> 00:21:59,710
enough<font color="#CCCCCC"> that you can do it during a</font>

449
00:21:57,010 --> 00:22:01,450
handshake is<font color="#E5E5E5"> challenging you would</font>

450
00:21:59,710 --> 00:22:03,850
<font color="#E5E5E5">probably have two parallel eyes a lot</font>

451
00:22:01,450 --> 00:22:06,730
and run the attack<font color="#E5E5E5"> from different points</font>

452
00:22:03,850 --> 00:22:08,770
and<font color="#E5E5E5"> maybe against different servers</font><font color="#CCCCCC"> so</font>

453
00:22:06,730 --> 00:22:11,350
and we have not tried this practically

454
00:22:08,770 --> 00:22:12,790
we believe it's<font color="#E5E5E5"> probably</font><font color="#CCCCCC"> possible for</font>

455
00:22:11,350 --> 00:22:14,800
touch<font color="#CCCCCC"> it like Facebook because Facebook</font>

456
00:22:12,790 --> 00:22:18,309
has<font color="#E5E5E5"> many servers so you</font>

457
00:22:14,800 --> 00:22:22,809
can do a lot of<font color="#E5E5E5"> parallelization</font><font color="#CCCCCC"> but we</font>

458
00:22:18,309 --> 00:22:25,420
have not tried it<font color="#E5E5E5"> yeah yeah Facebook was</font>

459
00:22:22,809 --> 00:22:28,120
not the owner we host these<font color="#E5E5E5"> are a few of</font>

460
00:22:25,420 --> 00:22:30,250
the<font color="#E5E5E5"> hosts that vulnerable</font><font color="#CCCCCC"> I don't know</font>

461
00:22:28,120 --> 00:22:33,428
some<font color="#CCCCCC"> of them I</font><font color="#E5E5E5"> think are reasonably</font>

462
00:22:30,250 --> 00:22:34,270
<font color="#CCCCCC">popular services maybe some of you have</font>

463
00:22:33,429 --> 00:22:37,420
used<font color="#CCCCCC"> them</font>

464
00:22:34,270 --> 00:22:37,929
I think PayPal has something to do with

465
00:22:37,420 --> 00:22:40,890
<font color="#E5E5E5">money</font>

466
00:22:37,929 --> 00:22:46,720
I<font color="#E5E5E5"> don't know Apple sells</font><font color="#CCCCCC"> I think</font>

467
00:22:40,890 --> 00:22:49,230
expensive computers<font color="#CCCCCC"> okay then of</font><font color="#E5E5E5"> course</font>

468
00:22:46,720 --> 00:22:51,970
we wanted<font color="#CCCCCC"> to report these</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> and</font>

469
00:22:49,230 --> 00:22:53,710
what<font color="#CCCCCC"> you</font><font color="#E5E5E5"> figure out there it's really</font>

470
00:22:51,970 --> 00:22:56,140
hard to track<font color="#E5E5E5"> down the vendors because</font>

471
00:22:53,710 --> 00:22:58,809
people are really reluctant to tell you

472
00:22:56,140 --> 00:23:00,520
things about<font color="#E5E5E5"> their infrastructure so</font>

473
00:22:58,809 --> 00:23:01,420
when I know about<font color="#E5E5E5"> this vulnerability</font>

474
00:23:00,520 --> 00:23:03,730
<font color="#CCCCCC">okay I know</font>

475
00:23:01,420 --> 00:23:06,280
<font color="#CCCCCC">epic comm is vulnerable</font><font color="#E5E5E5"> but what</font>

476
00:23:03,730 --> 00:23:08,920
hardware's<font color="#E5E5E5"> Apple come running they</font>

477
00:23:06,280 --> 00:23:11,320
wouldn't tell<font color="#CCCCCC"> me if you're curious they</font>

478
00:23:08,920 --> 00:23:13,809
run<font color="#CCCCCC"> citrix devices but they seem to</font>

479
00:23:11,320 --> 00:23:16,510
<font color="#E5E5E5">consider that a company secret</font><font color="#CCCCCC"> but I</font>

480
00:23:13,809 --> 00:23:18,250
<font color="#E5E5E5">eventually I found enough people who</font>

481
00:23:16,510 --> 00:23:21,040
were<font color="#E5E5E5"> running vulnerable servers who told</font>

482
00:23:18,250 --> 00:23:23,170
me so that<font color="#CCCCCC"> we've we could find a few</font>

483
00:23:21,040 --> 00:23:27,040
<font color="#E5E5E5">vendors</font><font color="#CCCCCC"> so we learned that f5 was</font>

484
00:23:23,170 --> 00:23:28,540
vulnerable Citrix radware<font color="#CCCCCC"> Cisco Cisco</font>

485
00:23:27,040 --> 00:23:30,940
has two different<font color="#E5E5E5"> products that were</font>

486
00:23:28,540 --> 00:23:33,639
<font color="#E5E5E5">vulnerable then we tested of</font><font color="#CCCCCC"> course all</font>

487
00:23:30,940 --> 00:23:36,010
kinds of<font color="#E5E5E5"> open source libraries we found</font>

488
00:23:33,640 --> 00:23:40,090
that bouncy castle is vulnerable along

489
00:23:36,010 --> 00:23:42,640
<font color="#E5E5E5">both</font><font color="#CCCCCC"> SSL then the other three only kind</font>

490
00:23:40,090 --> 00:23:45,250
<font color="#E5E5E5">of came out after we</font><font color="#CCCCCC"> published it so</font>

491
00:23:42,640 --> 00:23:48,340
after<font color="#CCCCCC"> we published</font><font color="#E5E5E5"> it then we learned</font>

492
00:23:45,250 --> 00:23:50,440
<font color="#E5E5E5">that more devices were vulnerable yeah</font>

493
00:23:48,340 --> 00:23:53,139
<font color="#E5E5E5">and we recently prolonged that list</font>

494
00:23:50,440 --> 00:23:55,150
because<font color="#CCCCCC"> we found</font><font color="#E5E5E5"> a few advisories online</font>

495
00:23:53,140 --> 00:24:00,400
that they didn't<font color="#E5E5E5"> tell us but they</font>

496
00:23:55,150 --> 00:24:02,230
apparently<font color="#E5E5E5"> gave out an advisory the</font>

497
00:24:00,400 --> 00:24:05,980
Cisco device<font color="#CCCCCC"> that was particularly</font>

498
00:24:02,230 --> 00:24:09,940
interesting<font color="#CCCCCC"> so Cisco had a device called</font>

499
00:24:05,980 --> 00:24:11,679
<font color="#E5E5E5">AC e and they are the vulnerability was</font>

500
00:24:09,940 --> 00:24:13,929
particularly<font color="#E5E5E5"> severe</font><font color="#CCCCCC"> because these</font>

501
00:24:11,679 --> 00:24:16,660
devices<font color="#CCCCCC"> only supported these ARS</font><font color="#E5E5E5"> a mode</font>

502
00:24:13,929 --> 00:24:20,620
<font color="#E5E5E5">so you had this we can directly decrypt</font>

503
00:24:16,660 --> 00:24:22,510
data<font color="#CCCCCC"> Cisco told us okay we won't fix</font>

504
00:24:20,620 --> 00:24:25,360
this<font color="#E5E5E5"> because these devices have been out</font>

505
00:24:22,510 --> 00:24:27,370
<font color="#CCCCCC">of support for more than three years</font><font color="#E5E5E5"> so</font>

506
00:24:25,360 --> 00:24:28,029
we're not<font color="#E5E5E5"> supporting them anymore so</font><font color="#CCCCCC"> we</font>

507
00:24:27,370 --> 00:24:32,109
won't<font color="#E5E5E5"> release</font>

508
00:24:28,029 --> 00:24:35,229
<font color="#E5E5E5">Fix</font><font color="#CCCCCC"> I wrote</font><font color="#E5E5E5"> them back yet that's very</font>

509
00:24:32,109 --> 00:24:37,059
<font color="#E5E5E5">interesting but it seems like Cisco</font>

510
00:24:35,229 --> 00:24:39,039
comments using<font color="#CCCCCC"> one of these devices that</font>

511
00:24:37,059 --> 00:24:42,190
<font color="#E5E5E5">are</font><font color="#CCCCCC"> out of support for more than three</font>

512
00:24:39,039 --> 00:24:49,210
years<font color="#E5E5E5"> do you</font><font color="#CCCCCC"> have a comment on that</font>

513
00:24:42,190 --> 00:24:50,889
they didn't comment<font color="#E5E5E5"> on that yeah what we</font>

514
00:24:49,210 --> 00:24:53,619
also did is<font color="#E5E5E5"> we try to reach out to</font>

515
00:24:50,889 --> 00:24:55,379
<font color="#E5E5E5">developers from testing tools because I</font>

516
00:24:53,619 --> 00:24:57,908
think<font color="#E5E5E5"> one thing this shows is that</font>

517
00:24:55,379 --> 00:25:01,658
<font color="#CCCCCC">people are not testing for</font><font color="#E5E5E5"> known</font>

518
00:24:57,909 --> 00:25:04,080
vulnerabilities and I guess this is<font color="#E5E5E5"> the</font>

519
00:25:01,659 --> 00:25:06,789
<font color="#E5E5E5">most popular testing tool for tls/ssl</font>

520
00:25:04,080 --> 00:25:13,029
apps and if you have a vulnerable server

521
00:25:06,789 --> 00:25:14,830
<font color="#CCCCCC">SSL FS will now give you an F rating but</font>

522
00:25:13,029 --> 00:25:18,039
<font color="#E5E5E5">we also contacted</font><font color="#CCCCCC"> develop from other</font>

523
00:25:14,830 --> 00:25:21,218
tools<font color="#E5E5E5"> for example</font><font color="#CCCCCC"> test SSL TLS</font><font color="#E5E5E5"> attacker</font>

524
00:25:18,039 --> 00:25:25,149
is written by<font color="#E5E5E5"> one of the co-authors or</font>

525
00:25:21,219 --> 00:25:27,460
TLS father and<font color="#E5E5E5"> Padilla is</font><font color="#CCCCCC"> noteworthy</font>

526
00:25:25,149 --> 00:25:30,549
<font color="#E5E5E5">that before we did this work there was</font>

527
00:25:27,460 --> 00:25:36,669
no<font color="#E5E5E5"> easy to use testing tool for these</font>

528
00:25:30,549 --> 00:25:39,339
kinds of attacks yeah<font color="#E5E5E5"> we also did the</font>

529
00:25:36,669 --> 00:25:41,919
capture the flag contest so it helps

530
00:25:39,339 --> 00:25:43,539
three stages<font color="#E5E5E5"> the</font><font color="#CCCCCC"> first was we had a</font>

531
00:25:41,919 --> 00:25:45,879
vulnerable host and you needed to

532
00:25:43,539 --> 00:25:48,219
<font color="#CCCCCC">decrypt a message</font><font color="#E5E5E5"> that gave you the</font>

533
00:25:45,879 --> 00:25:51,009
<font color="#E5E5E5">instructions</font><font color="#CCCCCC"> for the next level and</font><font color="#E5E5E5"> we</font>

534
00:25:48,219 --> 00:25:53,499
actually<font color="#E5E5E5"> gave people a public key</font><font color="#CCCCCC"> and</font>

535
00:25:51,009 --> 00:25:56,859
said they<font color="#CCCCCC"> should sign something</font><font color="#E5E5E5"> with</font>

536
00:25:53,499 --> 00:25:59,799
this public<font color="#CCCCCC"> key we didn't tell people</font>

537
00:25:56,859 --> 00:26:01,478
where the vulnerable host was we thought

538
00:25:59,799 --> 00:26:04,089
<font color="#E5E5E5">they should figure that</font><font color="#CCCCCC"> out by using a</font>

539
00:26:01,479 --> 00:26:05,769
certificate transparency<font color="#CCCCCC"> locks that was</font>

540
00:26:04,089 --> 00:26:07,418
interesting for me<font color="#CCCCCC"> because many people</font>

541
00:26:05,769 --> 00:26:09,759
then wrote me emails and<font color="#E5E5E5"> say hey we're</font>

542
00:26:07,419 --> 00:26:12,330
<font color="#CCCCCC">with</font><font color="#E5E5E5"> that one</font><font color="#CCCCCC"> /</font><font color="#E5E5E5"> host how do I find it I</font>

543
00:26:09,759 --> 00:26:16,239
just<font color="#CCCCCC"> have this key what should I do</font>

544
00:26:12,330 --> 00:26:17,769
<font color="#E5E5E5">or it apparently seems that too many</font>

545
00:26:16,239 --> 00:26:19,839
<font color="#E5E5E5">people are not yet familiar of a</font>

546
00:26:17,769 --> 00:26:22,450
<font color="#E5E5E5">certificate transparency</font><font color="#CCCCCC"> if you don't</font>

547
00:26:19,839 --> 00:26:24,639
know it it's a<font color="#E5E5E5"> project where it's</font>

548
00:26:22,450 --> 00:26:27,219
<font color="#E5E5E5">basically a public lock</font><font color="#CCCCCC"> where all the</font>

549
00:26:24,639 --> 00:26:30,879
<font color="#E5E5E5">certificates that</font><font color="#CCCCCC"> are publicly trusted</font>

550
00:26:27,219 --> 00:26:33,369
<font color="#CCCCCC">are just stored</font><font color="#E5E5E5"> and this has done a lot</font>

551
00:26:30,879 --> 00:26:35,830
<font color="#E5E5E5">to</font><font color="#CCCCCC"> improve auditability</font><font color="#E5E5E5"> of the TLS</font>

552
00:26:33,369 --> 00:26:37,779
ecosystem yeah and then the third

553
00:26:35,830 --> 00:26:39,889
<font color="#E5E5E5">challenge was it to sign a</font><font color="#CCCCCC"> message with</font>

554
00:26:37,779 --> 00:26:41,900
the<font color="#CCCCCC"> servers key this</font>

555
00:26:39,890 --> 00:26:43,910
<font color="#E5E5E5">it wasn't so far more difficult</font><font color="#CCCCCC"> because</font>

556
00:26:41,900 --> 00:26:49,670
the signing<font color="#E5E5E5"> a message takes one more</font>

557
00:26:43,910 --> 00:26:51,680
<font color="#E5E5E5">step</font><font color="#CCCCCC"> to implement in the attack</font><font color="#E5E5E5"> we did</font>

558
00:26:49,670 --> 00:26:53,420
<font color="#E5E5E5">not really consider timing attacks in</font>

559
00:26:51,680 --> 00:26:55,730
this<font color="#E5E5E5"> research we assume</font><font color="#CCCCCC"> that there</font><font color="#E5E5E5"> are</font>

560
00:26:53,420 --> 00:26:57,770
many more vulnerable implementations

561
00:26:55,730 --> 00:27:01,550
that are<font color="#CCCCCC"> vulnerable the timing attacks</font>

562
00:26:57,770 --> 00:27:03,050
but exploiting these is<font color="#E5E5E5"> it's annoying</font>

563
00:27:01,550 --> 00:27:04,850
<font color="#E5E5E5">because you have to send thousands of</font>

564
00:27:03,050 --> 00:27:11,210
<font color="#CCCCCC">messages and</font><font color="#E5E5E5"> then</font><font color="#CCCCCC"> to statistical</font>

565
00:27:04,850 --> 00:27:12,379
middling<font color="#E5E5E5"> and yeah it is kind of public</font>

566
00:27:11,210 --> 00:27:14,360
knowledge that<font color="#CCCCCC"> there are some</font>

567
00:27:12,380 --> 00:27:16,130
implementations that<font color="#E5E5E5"> don't implement</font>

568
00:27:14,360 --> 00:27:19,310
countermeasures against these timing

569
00:27:16,130 --> 00:27:22,700
attacks<font color="#E5E5E5"> for example in NSS which is the</font>

570
00:27:19,310 --> 00:27:25,070
<font color="#CCCCCC">Mozilla TLS library</font><font color="#E5E5E5"> there's an open box</font>

571
00:27:22,700 --> 00:27:28,130
<font color="#E5E5E5">since many years and it's kind</font><font color="#CCCCCC"> of known</font>

572
00:27:25,070 --> 00:27:29,510
that<font color="#CCCCCC"> it's not fixed it doesn't matter</font>

573
00:27:28,130 --> 00:27:33,770
that<font color="#E5E5E5"> much because it's a server</font>

574
00:27:29,510 --> 00:27:40,100
vulnerability and<font color="#E5E5E5"> the NSS</font><font color="#CCCCCC"> is not used</font>

575
00:27:33,770 --> 00:27:41,600
that often on servers<font color="#E5E5E5"> but something we</font>

576
00:27:40,100 --> 00:27:43,250
learnt then is that even if you

577
00:27:41,600 --> 00:27:45,320
<font color="#E5E5E5">implement it correctly according to the</font>

578
00:27:43,250 --> 00:27:46,790
spec<font color="#CCCCCC"> and do all the counter measurements</font>

579
00:27:45,320 --> 00:27:49,189
against timing attacks that<font color="#E5E5E5"> are written</font>

580
00:27:46,790 --> 00:27:53,480
in the<font color="#E5E5E5"> tier s standard you may still be</font>

581
00:27:49,190 --> 00:27:55,610
<font color="#CCCCCC">vulnerable to something and we we're</font>

582
00:27:53,480 --> 00:27:58,370
getting back here<font color="#E5E5E5"> to that crypto is just</font>

583
00:27:55,610 --> 00:27:59,959
math and<font color="#E5E5E5"> our cryptographic keys and our</font>

584
00:27:58,370 --> 00:28:03,770
signatures and everything they are<font color="#E5E5E5"> just</font>

585
00:27:59,960 --> 00:28:07,100
numbers and these cryptographic

586
00:28:03,770 --> 00:28:10,270
libraries they use<font color="#E5E5E5"> big</font><font color="#CCCCCC"> num structures</font>

587
00:28:07,100 --> 00:28:13,040
and these are more<font color="#E5E5E5"> or</font><font color="#CCCCCC"> less just</font><font color="#E5E5E5"> we have</font>

588
00:28:10,270 --> 00:28:16,940
<font color="#CCCCCC">we store our</font><font color="#E5E5E5"> numbers</font><font color="#CCCCCC"> in a buffer with</font>

589
00:28:13,040 --> 00:28:18,980
the<font color="#E5E5E5"> size that is the effect that if you</font>

590
00:28:16,940 --> 00:28:22,430
have a smaller<font color="#E5E5E5"> number it takes less</font>

591
00:28:18,980 --> 00:28:23,990
space<font color="#E5E5E5"> because like if something starts</font>

592
00:28:22,430 --> 00:28:28,520
with a<font color="#E5E5E5"> zero then it gets a smaller</font>

593
00:28:23,990 --> 00:28:31,100
number<font color="#E5E5E5"> right so so if we look back at</font>

594
00:28:28,520 --> 00:28:34,220
this RSA formula and if you have a

595
00:28:31,100 --> 00:28:37,969
common his eyes like 2048 bit then the

596
00:28:34,220 --> 00:28:41,840
result should be 256<font color="#E5E5E5"> bytes but it could</font>

597
00:28:37,970 --> 00:28:44,120
also be 255<font color="#E5E5E5"> bytes or 254 bytes when it</font>

598
00:28:41,840 --> 00:28:49,850
starts with a<font color="#CCCCCC"> zero of as</font><font color="#E5E5E5"> two zeros and</font>

599
00:28:44,120 --> 00:28:51,889
<font color="#CCCCCC">that gives your timing signal and that</font>

600
00:28:49,850 --> 00:28:52,219
basically affects all the<font color="#CCCCCC"> libraries out</font>

601
00:28:51,890 --> 00:28:52,950
there

602
00:28:52,220 --> 00:28:57,240
<font color="#CCCCCC">the</font>

603
00:28:52,950 --> 00:28:58,799
<font color="#E5E5E5">you can think of</font><font color="#CCCCCC"> we have no idea</font><font color="#E5E5E5"> if this</font>

604
00:28:57,240 --> 00:29:02,789
<font color="#CCCCCC">is practically exploitable but it's</font>

605
00:28:58,799 --> 00:29:05,549
definitely not<font color="#E5E5E5"> nice</font><font color="#CCCCCC"> david benjamin from</font>

606
00:29:02,789 --> 00:29:09,299
<font color="#CCCCCC">google he's made a developer at Boeing</font>

607
00:29:05,549 --> 00:29:10,559
<font color="#CCCCCC">SSL they have now</font><font color="#E5E5E5"> are testing a fix and</font>

608
00:29:09,299 --> 00:29:13,860
<font color="#E5E5E5">they have</font><font color="#CCCCCC"> also submitted a pull request</font>

609
00:29:10,559 --> 00:29:19,710
<font color="#CCCCCC">to open SSL so maybe it will be</font><font color="#E5E5E5"> fixed at</font>

610
00:29:13,860 --> 00:29:22,168
least yeah yeah<font color="#E5E5E5"> one thing we</font>

611
00:29:19,710 --> 00:29:23,850
occasionally<font color="#E5E5E5"> observed was that</font><font color="#CCCCCC"> we were</font>

612
00:29:22,169 --> 00:29:26,700
getting<font color="#E5E5E5"> inconsistent replies from</font>

613
00:29:23,850 --> 00:29:32,039
servers and sometimes also<font color="#E5E5E5"> things that</font>

614
00:29:26,700 --> 00:29:34,620
look like<font color="#E5E5E5"> just garbage bytes so we one</font>

615
00:29:32,039 --> 00:29:36,510
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the products was communicate</font><font color="#CCCCCC"> pro</font>

616
00:29:34,620 --> 00:29:40,768
which seems<font color="#E5E5E5"> to be some mail server</font>

617
00:29:36,510 --> 00:29:45,510
product<font color="#CCCCCC"> they did not</font><font color="#E5E5E5"> really communicate</font>

618
00:29:40,769 --> 00:29:47,330
with us<font color="#E5E5E5"> even though that yeah so we</font>

619
00:29:45,510 --> 00:29:52,110
assume<font color="#E5E5E5"> there</font><font color="#CCCCCC"> are some kind of</font>

620
00:29:47,330 --> 00:29:54,120
vulnerabilities<font color="#CCCCCC"> that is not mine</font>

621
00:29:52,110 --> 00:29:56,370
we assume that<font color="#E5E5E5"> there may be some kind</font><font color="#CCCCCC"> of</font>

622
00:29:54,120 --> 00:29:58,799
heartbleed style vulnerability in some

623
00:29:56,370 --> 00:30:05,850
products<font color="#E5E5E5"> if someone wants to look out</font>

624
00:29:58,799 --> 00:30:07,019
for this<font color="#CCCCCC"> may</font><font color="#E5E5E5"> be interesting</font><font color="#CCCCCC"> so what</font>

625
00:30:05,850 --> 00:30:11,820
should we<font color="#E5E5E5"> really do</font><font color="#CCCCCC"> about this</font>

626
00:30:07,019 --> 00:30:15,029
vulnerability<font color="#E5E5E5"> essentially I think these</font>

627
00:30:11,820 --> 00:30:17,250
TLS<font color="#CCCCCC"> RSA modes</font><font color="#E5E5E5"> they are broken these</font>

628
00:30:15,029 --> 00:30:18,720
countermeasures are extremely

629
00:30:17,250 --> 00:30:20,580
complicated and<font color="#E5E5E5"> if you need so</font>

630
00:30:18,720 --> 00:30:22,080
complicated countermeasures to<font color="#E5E5E5"> prevent</font>

631
00:30:20,580 --> 00:30:23,879
an<font color="#CCCCCC"> attack</font><font color="#E5E5E5"> I would call an encryption</font>

632
00:30:22,080 --> 00:30:27,120
<font color="#E5E5E5">method</font><font color="#CCCCCC"> problem</font><font color="#E5E5E5"> so I think you should</font>

633
00:30:23,880 --> 00:30:29,700
<font color="#CCCCCC">disable them</font><font color="#E5E5E5"> we did a bit of</font>

634
00:30:27,120 --> 00:30:32,279
measurements on our own<font color="#CCCCCC"> service and we</font>

635
00:30:29,700 --> 00:30:34,500
think that<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> feasible that if you</font>

636
00:30:32,279 --> 00:30:37,260
disable them you will not get a lot<font color="#E5E5E5"> of</font>

637
00:30:34,500 --> 00:30:39,330
<font color="#E5E5E5">problems because basically all normal</font>

638
00:30:37,260 --> 00:30:43,220
browsers these days<font color="#E5E5E5"> support these more</font>

639
00:30:39,330 --> 00:30:43,220
modern modes that use diffie-hellman

640
00:30:44,600 --> 00:30:50,820
until<font color="#CCCCCC"> s 1.3 these are as a key exchanges</font>

641
00:30:48,210 --> 00:30:52,860
have been<font color="#E5E5E5"> removed but you need to</font>

642
00:30:50,820 --> 00:30:54,840
<font color="#E5E5E5">consider that they are still a risk left</font>

643
00:30:52,860 --> 00:30:57,178
if you still support the old TLS

644
00:30:54,840 --> 00:31:02,809
versions because<font color="#E5E5E5"> you can even attack TLS</font>

645
00:30:57,179 --> 00:31:02,809
1.3 if you have an Oracle<font color="#CCCCCC"> 4 TLS 1.2</font>

646
00:31:05,120 --> 00:31:11,489
so yeah<font color="#CCCCCC"> in general people should stop</font>

647
00:31:09,120 --> 00:31:13,560
<font color="#CCCCCC">using RSA with this old petting mode</font>

648
00:31:11,490 --> 00:31:16,130
there has been a<font color="#E5E5E5"> newer petting mode</font>

649
00:31:13,560 --> 00:31:20,340
I think it's been standardized<font color="#CCCCCC"> in</font><font color="#E5E5E5"> 2004</font>

650
00:31:16,130 --> 00:31:22,440
<font color="#CCCCCC">for some unclear reason in 2008 when</font>

651
00:31:20,340 --> 00:31:24,120
they wrote TLS 1.2 they decided they

652
00:31:22,440 --> 00:31:26,790
don't<font color="#E5E5E5"> like that new mode and still want</font>

653
00:31:24,120 --> 00:31:28,709
to stick<font color="#CCCCCC"> with the old one but</font><font color="#E5E5E5"> these</font>

654
00:31:26,790 --> 00:31:30,350
newer modes are much more robust against

655
00:31:28,710 --> 00:31:34,320
these<font color="#CCCCCC"> attacks</font>

656
00:31:30,350 --> 00:31:36,689
so yeah<font color="#CCCCCC"> takeaways all the tech</font><font color="#E5E5E5"> still</font>

657
00:31:34,320 --> 00:31:39,409
work and yeah you can<font color="#CCCCCC"> even win a pony</font>

658
00:31:36,690 --> 00:31:43,440
<font color="#CCCCCC">award by recycling a 20 year old attack</font>

659
00:31:39,410 --> 00:31:47,460
you<font color="#E5E5E5"> should stop</font><font color="#CCCCCC"> using TR SRS</font><font color="#E5E5E5"> AFS in TLS</font>

660
00:31:43,440 --> 00:31:58,970
<font color="#E5E5E5">and you should stop using</font><font color="#CCCCCC"> pkcs1</font><font color="#E5E5E5"> 1.5 yeah</font>

661
00:31:47,460 --> 00:31:58,970
thank you any questions

662
00:32:05,470 --> 00:32:12,380
<font color="#CCCCCC">Thanks thanks</font><font color="#E5E5E5"> for the great talk</font><font color="#CCCCCC"> do you</font>

663
00:32:08,900 --> 00:32:14,510
know if<font color="#CCCCCC"> this labs tests for TLS</font><font color="#E5E5E5"> RSA</font>

664
00:32:12,380 --> 00:32:16,940
enabled or does<font color="#CCCCCC"> it really test the</font>

665
00:32:14,510 --> 00:32:19,490
attack<font color="#E5E5E5"> no no it</font><font color="#CCCCCC"> tests the attack okay</font>

666
00:32:16,940 --> 00:32:23,840
<font color="#E5E5E5">also with the short messages yeah yeah</font>

667
00:32:19,490 --> 00:32:34,309
we so they implemented what we<font color="#E5E5E5"> told them</font>

668
00:32:23,840 --> 00:32:41,990
<font color="#CCCCCC">ok great great work do</font><font color="#E5E5E5"> we have other</font>

669
00:32:34,309 --> 00:32:45,200
questions let's give a big hand<font color="#E5E5E5"> again</font>

670
00:32:41,990 --> 00:32:45,200
[Applause]

