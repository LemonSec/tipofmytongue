1
00:00:00,120 --> 00:00:02,220
hey everyone thanks for coming to my

2
00:00:02,220 --> 00:00:04,620
talk this afternoon my name's Kenton

3
00:00:04,620 --> 00:00:05,759
McDaniel

4
00:00:05,759 --> 00:00:08,340
um I love cracking passwords it's like

5
00:00:08,340 --> 00:00:10,019
one of my favorite things ever and I

6
00:00:10,019 --> 00:00:11,820
love privilege escalation so those two

7
00:00:11,820 --> 00:00:13,559
things pretty much are my favorite

8
00:00:13,559 --> 00:00:15,540
things about information security but

9
00:00:15,540 --> 00:00:16,940
today we're going to be talking about

10
00:00:16,940 --> 00:00:19,440
instant response tools and tactics for

11
00:00:19,440 --> 00:00:21,119
absolute beginners so the Baseline of

12
00:00:21,119 --> 00:00:24,180
knowledge assumed here is close to not

13
00:00:24,180 --> 00:00:25,439
so it's assumed you have Baseline

14
00:00:25,439 --> 00:00:27,599
knowledge with it but no Baseline

15
00:00:27,599 --> 00:00:29,160
knowledge about incident response so the

16
00:00:29,160 --> 00:00:31,199
first thing is to Define what is an

17
00:00:31,199 --> 00:00:33,840
incident and that can vary heavily by

18
00:00:33,840 --> 00:00:35,760
organization and also sorry I forgot to

19
00:00:35,760 --> 00:00:37,980
mention if you have any questions please

20
00:00:37,980 --> 00:00:40,079
just raise your hand during the

21
00:00:40,079 --> 00:00:41,280
presentation if you have any questions

22
00:00:41,280 --> 00:00:43,739
if you want to Heckle just during is

23
00:00:43,739 --> 00:00:44,820
great you don't have to wait till the

24
00:00:44,820 --> 00:00:45,719
end

25
00:00:45,719 --> 00:00:48,420
so every organization is going to be

26
00:00:48,420 --> 00:00:50,520
different and defining what an INS What

27
00:00:50,520 --> 00:00:53,039
an incident is for an organization

28
00:00:53,039 --> 00:00:54,719
is an important part of knowing what

29
00:00:54,719 --> 00:00:56,219
instant response should look like for

30
00:00:56,219 --> 00:00:58,500
your organization and I'm saying

31
00:00:58,500 --> 00:01:01,079
organization a lot but you have to

32
00:01:01,079 --> 00:01:03,300
understand what constitutes an incident

33
00:01:03,300 --> 00:01:04,979
so that you can respond to an incident

34
00:01:04,979 --> 00:01:06,960
on a sliding scale from everything we

35
00:01:06,960 --> 00:01:10,320
operate as a Honeypot to our users have

36
00:01:10,320 --> 00:01:12,680
to have secure issued laptops with

37
00:01:12,680 --> 00:01:16,140
physical MFA We All Fall somewhere on

38
00:01:16,140 --> 00:01:18,540
that Spectrum right so

39
00:01:18,540 --> 00:01:20,280
understanding that and defining that

40
00:01:20,280 --> 00:01:22,439
helps you to helps you determine when

41
00:01:22,439 --> 00:01:24,600
you should respond to an incident

42
00:01:24,600 --> 00:01:27,119
and that's largely dictated by your

43
00:01:27,119 --> 00:01:30,000
executive leadership so getting them on

44
00:01:30,000 --> 00:01:31,979
board with what constitutes an incident

45
00:01:31,979 --> 00:01:34,380
helps you be successful in responding to

46
00:01:34,380 --> 00:01:36,420
incidents because if you respond to

47
00:01:36,420 --> 00:01:38,040
everything great if you've got the

48
00:01:38,040 --> 00:01:39,659
capability to respond to everything

49
00:01:39,659 --> 00:01:42,180
great if not you should set layers of

50
00:01:42,180 --> 00:01:43,799
what your response looks like so you're

51
00:01:43,799 --> 00:01:45,240
only responding to the things that are

52
00:01:45,240 --> 00:01:47,100
the most important

53
00:01:47,100 --> 00:01:48,840
I talked a little bit about risk profile

54
00:01:48,840 --> 00:01:49,979
and this is

55
00:01:49,979 --> 00:01:52,140
a great way to approach your Executives

56
00:01:52,140 --> 00:01:53,939
is ask the risk profile that they're

57
00:01:53,939 --> 00:01:55,920
comfortable carrying and the answer is

58
00:01:55,920 --> 00:01:58,020
going to be wildly different

59
00:01:58,020 --> 00:02:00,180
sometimes even between departments in a

60
00:02:00,180 --> 00:02:02,579
large organization knowing that risk

61
00:02:02,579 --> 00:02:05,159
profile is what helps you as an incident

62
00:02:05,159 --> 00:02:07,619
responder understand what steps you

63
00:02:07,619 --> 00:02:09,119
should take what kind of tactics you

64
00:02:09,119 --> 00:02:10,318
should take and what kind of tools

65
00:02:10,318 --> 00:02:12,180
you're allowed to use so

66
00:02:12,180 --> 00:02:13,620
when I talk a little bit about tools

67
00:02:13,620 --> 00:02:15,360
there'll be some you'll say hey I can't

68
00:02:15,360 --> 00:02:16,680
use it out of my organization which

69
00:02:16,680 --> 00:02:18,180
makes sense and there'll be others that

70
00:02:18,180 --> 00:02:21,560
you can use at an organization

71
00:02:21,840 --> 00:02:24,480
so incident response is determining the

72
00:02:24,480 --> 00:02:26,040
scope of an incident containing an

73
00:02:26,040 --> 00:02:27,420
incident and eradicating and then

74
00:02:27,420 --> 00:02:29,220
documenting Lessons Learned

75
00:02:29,220 --> 00:02:31,680
so

76
00:02:31,680 --> 00:02:33,060
to be a little bit more granular

77
00:02:33,060 --> 00:02:36,200
detection isolation containment

78
00:02:36,200 --> 00:02:39,420
investigation eradication Lessons

79
00:02:39,420 --> 00:02:41,700
Learned and information sharing so I

80
00:02:41,700 --> 00:02:43,140
want to talk a little bit about each of

81
00:02:43,140 --> 00:02:46,379
these phases and some of these overlap

82
00:02:46,379 --> 00:02:48,900
greatly some of them can be condensed

83
00:02:48,900 --> 00:02:50,340
into the same thing depending on the

84
00:02:50,340 --> 00:02:53,040
scope and nature of the incident but all

85
00:02:53,040 --> 00:02:54,599
of them should happen

86
00:02:54,599 --> 00:02:56,760
so and especially important is the very

87
00:02:56,760 --> 00:02:58,560
last one Lessons Learned in information

88
00:02:58,560 --> 00:03:01,560
sharing if if you're not documenting

89
00:03:01,560 --> 00:03:03,120
what lessons you've learned from an

90
00:03:03,120 --> 00:03:05,220
incident and you're not sharing that

91
00:03:05,220 --> 00:03:07,080
information with the rest of your

92
00:03:07,080 --> 00:03:08,760
organization you're doing yourself a

93
00:03:08,760 --> 00:03:10,800
disservice because sharing information

94
00:03:10,800 --> 00:03:13,319
helps Foster future incident response

95
00:03:13,319 --> 00:03:15,420
activities so let's say there's an

96
00:03:15,420 --> 00:03:17,459
incident and we have to shut down

97
00:03:17,459 --> 00:03:19,319
we have to shut down a random web server

98
00:03:19,319 --> 00:03:21,720
but people are using that web server if

99
00:03:21,720 --> 00:03:23,640
we don't share the information as to why

100
00:03:23,640 --> 00:03:25,860
we had to shut the web server down what

101
00:03:25,860 --> 00:03:27,480
we've learned for future incidents that

102
00:03:27,480 --> 00:03:29,760
we're going to respond to and things we

103
00:03:29,760 --> 00:03:32,099
could do better then we're going to lose

104
00:03:32,099 --> 00:03:33,540
the trust of the people who are

105
00:03:33,540 --> 00:03:35,280
operating those devices

106
00:03:35,280 --> 00:03:37,620
so we absolutely have to share what

107
00:03:37,620 --> 00:03:39,540
we've learned and we have to get better

108
00:03:39,540 --> 00:03:41,099
every single time

109
00:03:41,099 --> 00:03:42,599
because none of us are going to respond

110
00:03:42,599 --> 00:03:43,860
correctly every single time to an

111
00:03:43,860 --> 00:03:45,840
incident sometimes you have seconds to

112
00:03:45,840 --> 00:03:47,879
make a decision right it's a it's a

113
00:03:47,879 --> 00:03:49,200
really tough spot to be in you have

114
00:03:49,200 --> 00:03:51,239
seconds to make this decision and if you

115
00:03:51,239 --> 00:03:53,280
make the wrong decision that's okay

116
00:03:53,280 --> 00:03:55,200
try to get return to operation but you

117
00:03:55,200 --> 00:03:57,000
have to be able to will able and willing

118
00:03:57,000 --> 00:03:58,500
to share that information to move

119
00:03:58,500 --> 00:04:01,140
forward and to maintain that trust

120
00:04:01,140 --> 00:04:04,980
so detection is a very very broad topic

121
00:04:04,980 --> 00:04:06,299
I'm going to keep it super simple

122
00:04:06,299 --> 00:04:07,920
because the audience this is geared

123
00:04:07,920 --> 00:04:10,379
towards is beginners so we're going to

124
00:04:10,379 --> 00:04:13,140
talk about a couple detection Tools in

125
00:04:13,140 --> 00:04:14,580
brief

126
00:04:14,580 --> 00:04:17,160
first one is antivirus raise your hand

127
00:04:17,160 --> 00:04:19,738
if you've never heard of antivirus

128
00:04:19,738 --> 00:04:24,720
great good so antiviruses is your little

129
00:04:24,720 --> 00:04:27,840
agent that runs on something right runs

130
00:04:27,840 --> 00:04:29,880
on a device an endpoint

131
00:04:29,880 --> 00:04:31,680
that looks for different things and then

132
00:04:31,680 --> 00:04:33,419
there's EDR endpoint detection and

133
00:04:33,419 --> 00:04:35,280
response and they can brand it however

134
00:04:35,280 --> 00:04:37,440
they want MDR xdr has anyone ever heard

135
00:04:37,440 --> 00:04:40,080
any other am I missing an acronym MDR

136
00:04:40,080 --> 00:04:42,120
xdr

137
00:04:42,120 --> 00:04:43,800
they've got all kinds of acronyms

138
00:04:43,800 --> 00:04:45,540
they're all the same thing right

139
00:04:45,540 --> 00:04:47,880
they're all trying to up the game of

140
00:04:47,880 --> 00:04:50,160
what an antivirus does to allow us to

141
00:04:50,160 --> 00:04:52,560
detect and then hopefully respond to

142
00:04:52,560 --> 00:04:53,759
threats

143
00:04:53,759 --> 00:04:56,580
so let's talk about antivirus signature

144
00:04:56,580 --> 00:04:59,220
based antivirus and heuristic antivirus

145
00:04:59,220 --> 00:05:01,080
so signature-based antivirus is the idea

146
00:05:01,080 --> 00:05:04,440
of I have seen this before

147
00:05:04,440 --> 00:05:06,600
I know what this thing is doing

148
00:05:06,600 --> 00:05:09,180
therefore I don't want to allow it or I

149
00:05:09,180 --> 00:05:11,880
do want to allow it and that's where a

150
00:05:11,880 --> 00:05:13,860
large chunk of your antivirus programs

151
00:05:13,860 --> 00:05:16,500
fall they just say hey I've seen this

152
00:05:16,500 --> 00:05:18,660
thing before and I know this thing is

153
00:05:18,660 --> 00:05:21,780
good or bad heuristics is what is it

154
00:05:21,780 --> 00:05:22,979
doing

155
00:05:22,979 --> 00:05:25,080
the idea of this thing just did

156
00:05:25,080 --> 00:05:27,840
something bad therefore I classify it as

157
00:05:27,840 --> 00:05:30,300
bad or this thing has yet to do anything

158
00:05:30,300 --> 00:05:33,120
bad therefore I classify it as safe for

159
00:05:33,120 --> 00:05:33,960
now

160
00:05:33,960 --> 00:05:37,020
so AV Falls in those two groups

161
00:05:37,020 --> 00:05:38,820
signature and heuristic and some people

162
00:05:38,820 --> 00:05:41,160
some AV vendors will try to sell you

163
00:05:41,160 --> 00:05:42,240
that

164
00:05:42,240 --> 00:05:44,580
they're more than that they're not I

165
00:05:44,580 --> 00:05:46,380
mean you can sandbox all you want cool

166
00:05:46,380 --> 00:05:48,300
when you sandbox what are you evaluating

167
00:05:48,300 --> 00:05:49,560
inside of the sandbox you're either

168
00:05:49,560 --> 00:05:50,759
evaluating the signature or the

169
00:05:50,759 --> 00:05:52,199
heuristics right you're trying to run it

170
00:05:52,199 --> 00:05:54,479
and see what it does so they fall into

171
00:05:54,479 --> 00:05:56,400
these two basic camps signature based

172
00:05:56,400 --> 00:05:58,560
and heuristic

173
00:05:58,560 --> 00:06:02,400
so a couple of free antivirus options uh

174
00:06:02,400 --> 00:06:06,180
Windows Defender is fantastic

175
00:06:06,180 --> 00:06:08,340
one of my favorite anti-viruses to

176
00:06:08,340 --> 00:06:10,500
deploy and one of my least favorite to

177
00:06:10,500 --> 00:06:11,880
go against so

178
00:06:11,880 --> 00:06:15,539
when I'm building a new package or a new

179
00:06:15,539 --> 00:06:17,880
implant what's the first thing I always

180
00:06:17,880 --> 00:06:19,919
test that implant against Windows

181
00:06:19,919 --> 00:06:22,860
Defender why because it comes by default

182
00:06:22,860 --> 00:06:24,960
installed on Windows is detection

183
00:06:24,960 --> 00:06:26,880
through signature and heuristics is

184
00:06:26,880 --> 00:06:29,100
actually pretty good

185
00:06:29,100 --> 00:06:31,080
and it scales really well and it doesn't

186
00:06:31,080 --> 00:06:32,520
murder the performance of your endpoint

187
00:06:32,520 --> 00:06:34,500
unless you're throwing tons and tons and

188
00:06:34,500 --> 00:06:36,960
tons of stuff at it so and then there's

189
00:06:36,960 --> 00:06:39,660
clam AV has anyone ever used clam AV

190
00:06:39,660 --> 00:06:43,259
does anyone really love clam AV

191
00:06:43,259 --> 00:06:46,500
okay good so Clan maybe I didn't I

192
00:06:46,500 --> 00:06:47,699
didn't want to hurt anyone's feelings

193
00:06:47,699 --> 00:06:51,300
clam AV is fine right I mean if you

194
00:06:51,300 --> 00:06:52,680
really need something to look out for

195
00:06:52,680 --> 00:06:55,080
signatures and and maybe detect a couple

196
00:06:55,080 --> 00:06:56,699
things here and there

197
00:06:56,699 --> 00:06:59,759
clam AV is fine but those are two good

198
00:06:59,759 --> 00:07:01,560
free options that you can deploy the

199
00:07:01,560 --> 00:07:03,300
defender Parts free with a Windows

200
00:07:03,300 --> 00:07:05,220
license we're not talking about like

201
00:07:05,220 --> 00:07:07,319
Defender ATP or whatever they've

202
00:07:07,319 --> 00:07:09,539
rebranded it to this month I don't know

203
00:07:09,539 --> 00:07:11,699
what Microsoft's calling it now the

204
00:07:11,699 --> 00:07:13,440
their Advanced threat protection or

205
00:07:13,440 --> 00:07:16,380
their their more heuristic based EDR

206
00:07:16,380 --> 00:07:18,419
but the just the normal Defender comes

207
00:07:18,419 --> 00:07:19,860
with your windows license

208
00:07:19,860 --> 00:07:22,080
and clam AV you can deploy it on your

209
00:07:22,080 --> 00:07:24,960
Linux endpoints and it's fine

210
00:07:24,960 --> 00:07:27,180
so those are those are two decent

211
00:07:27,180 --> 00:07:28,860
options for free

212
00:07:28,860 --> 00:07:31,740
for EDR for free has anyone ever played

213
00:07:31,740 --> 00:07:34,139
with open EDR or wazoo

214
00:07:34,139 --> 00:07:37,199
anyone they're okay

215
00:07:37,199 --> 00:07:40,620
if you don't have budget this is an

216
00:07:40,620 --> 00:07:42,780
actually good option

217
00:07:42,780 --> 00:07:44,580
because as we'll talk about in just a

218
00:07:44,580 --> 00:07:46,560
little bit

219
00:07:46,560 --> 00:07:49,319
the whole point behind antivirus and EDR

220
00:07:49,319 --> 00:07:53,580
is not to comprehensively protect all of

221
00:07:53,580 --> 00:07:55,560
your assets from threats

222
00:07:55,560 --> 00:07:57,840
the whole point is to alert you in time

223
00:07:57,840 --> 00:08:00,120
to be able to respond effectively to

224
00:08:00,120 --> 00:08:01,860
those threats

225
00:08:01,860 --> 00:08:05,099
so we've got to think about our EDR it's

226
00:08:05,099 --> 00:08:07,080
running there the sales people are going

227
00:08:07,080 --> 00:08:09,000
to tell us this will stop zero days and

228
00:08:09,000 --> 00:08:10,199
you're like you don't even know what

229
00:08:10,199 --> 00:08:12,300
you're talking about how on Earth that

230
00:08:12,300 --> 00:08:14,099
doesn't make any sense the reality is

231
00:08:14,099 --> 00:08:16,620
this heuristics engine should tell us

232
00:08:16,620 --> 00:08:18,780
far enough in advance that something

233
00:08:18,780 --> 00:08:20,280
happened

234
00:08:20,280 --> 00:08:22,440
so that we can respond in a timely

235
00:08:22,440 --> 00:08:24,240
manner that's what we're looking for

236
00:08:24,240 --> 00:08:27,840
here and if you get an alert so for

237
00:08:27,840 --> 00:08:29,940
example let's say I get an alert for

238
00:08:29,940 --> 00:08:32,940
mimikatz executing against an

239
00:08:32,940 --> 00:08:34,740
application server

240
00:08:34,740 --> 00:08:38,159
but my EDR says it prevented it by show

241
00:08:38,159 --> 00:08:39,958
of hands who thinks that we trust the

242
00:08:39,958 --> 00:08:42,958
EDR to say that everything's fine

243
00:08:42,958 --> 00:08:45,480
I am so proud of all of you we don't we

244
00:08:45,480 --> 00:08:47,700
don't trust the EDR right all we know is

245
00:08:47,700 --> 00:08:49,260
someone has a foothold on that machine

246
00:08:49,260 --> 00:08:51,720
they tried to run mimikats

247
00:08:51,720 --> 00:08:53,519
which is a credential stealing software

248
00:08:53,519 --> 00:08:54,839
love moving cats by the way it's

249
00:08:54,839 --> 00:08:55,920
fantastic

250
00:08:55,920 --> 00:08:58,680
so they tried to run mimicats the EDR

251
00:08:58,680 --> 00:09:01,080
smacked it and said no so now what's

252
00:09:01,080 --> 00:09:04,920
what's the attacker going to do anyone

253
00:09:04,920 --> 00:09:06,779
they're gonna they're gonna just

254
00:09:06,779 --> 00:09:09,240
redeploy mimikats right they're going to

255
00:09:09,240 --> 00:09:10,980
strip it down they're going to get rid

256
00:09:10,980 --> 00:09:12,000
of the signatures they're going to

257
00:09:12,000 --> 00:09:13,800
redeploy mimikats and they're going to

258
00:09:13,800 --> 00:09:14,880
go forward

259
00:09:14,880 --> 00:09:15,959
so

260
00:09:15,959 --> 00:09:18,660
these detection engines are super

261
00:09:18,660 --> 00:09:20,760
important for us as Defenders but

262
00:09:20,760 --> 00:09:21,959
they're not

263
00:09:21,959 --> 00:09:24,000
something that's a wall that stops

264
00:09:24,000 --> 00:09:26,700
everything again it's just this alerts

265
00:09:26,700 --> 00:09:28,260
me in time so that I know I've got time

266
00:09:28,260 --> 00:09:30,480
to respond to a threat

267
00:09:30,480 --> 00:09:33,779
so even if we just do a cursory glance

268
00:09:33,779 --> 00:09:36,320
yeah

269
00:09:38,100 --> 00:09:40,800
I would recommend both

270
00:09:40,800 --> 00:09:42,839
um you can get some

271
00:09:42,839 --> 00:09:44,820
some EDR platforms oh sorry the question

272
00:09:44,820 --> 00:09:46,620
was for anyone that didn't hear would

273
00:09:46,620 --> 00:09:49,080
you run both an anti-virus and an EDR on

274
00:09:49,080 --> 00:09:51,600
an endpoint so my response is I would

275
00:09:51,600 --> 00:09:54,360
run both unless the EDR comes bundled

276
00:09:54,360 --> 00:09:56,820
with anti-malware signature based and a

277
00:09:56,820 --> 00:09:59,100
lot of them do a lot of them don't so

278
00:09:59,100 --> 00:10:01,200
knowing your tool set's important

279
00:10:01,200 --> 00:10:02,940
because spend is a thing right you don't

280
00:10:02,940 --> 00:10:04,500
want to double spend if you don't have

281
00:10:04,500 --> 00:10:06,839
to so if you go to your EDR vendor and

282
00:10:06,839 --> 00:10:09,240
they say okay cool the anti-malware is

283
00:10:09,240 --> 00:10:10,380
bundled in here's how it gives the

284
00:10:10,380 --> 00:10:11,640
signature updates here's how we do

285
00:10:11,640 --> 00:10:13,680
detection here's when we scan then we

286
00:10:13,680 --> 00:10:15,600
probably don't need to double deploy but

287
00:10:15,600 --> 00:10:17,399
if we have an EDR vendor like if we're

288
00:10:17,399 --> 00:10:18,959
using one of the free ones definitely

289
00:10:18,959 --> 00:10:21,420
want to double up on that or if our EDR

290
00:10:21,420 --> 00:10:23,100
vendor doesn't have the signature based

291
00:10:23,100 --> 00:10:25,440
detection you want to double up on that

292
00:10:25,440 --> 00:10:27,720
fantastic question by the way thank you

293
00:10:27,720 --> 00:10:29,839
so

294
00:10:29,839 --> 00:10:32,459
understanding when to investigate the

295
00:10:32,459 --> 00:10:34,680
alerts because in an ideal scenario we

296
00:10:34,680 --> 00:10:37,200
investigate all alerts right but some of

297
00:10:37,200 --> 00:10:38,820
us have really sprawling I.T

298
00:10:38,820 --> 00:10:40,320
infrastructures we can't investigate all

299
00:10:40,320 --> 00:10:43,080
alerts so familiarizing yourself with

300
00:10:43,080 --> 00:10:45,540
different payloads and packages

301
00:10:45,540 --> 00:10:47,820
because most edrna vendors are fairly

302
00:10:47,820 --> 00:10:49,200
helpful at telling us what they think

303
00:10:49,200 --> 00:10:50,459
this was

304
00:10:50,459 --> 00:10:52,079
right they're like I think this was

305
00:10:52,079 --> 00:10:54,360
mimicats I think this was Cobalt strike

306
00:10:54,360 --> 00:10:57,839
or I think this was adware of those

307
00:10:57,839 --> 00:11:00,120
three AdWords the one I put at the

308
00:11:00,120 --> 00:11:01,740
bottom of the list to investigate after

309
00:11:01,740 --> 00:11:03,660
I go after my mimicats and my Cobalt

310
00:11:03,660 --> 00:11:05,040
strike right

311
00:11:05,040 --> 00:11:08,399
or my interpreter so knowing a little

312
00:11:08,399 --> 00:11:10,200
bit about the packages that the

313
00:11:10,200 --> 00:11:11,760
adversaries are going to deploy to your

314
00:11:11,760 --> 00:11:14,160
infrastructure helps you know kind of

315
00:11:14,160 --> 00:11:16,260
your triage order right because we're

316
00:11:16,260 --> 00:11:18,060
getting alerts constantly and that can

317
00:11:18,060 --> 00:11:20,640
lead to severe fatigue so again we set

318
00:11:20,640 --> 00:11:21,959
our expectation of what our instant

319
00:11:21,959 --> 00:11:23,700
response plan looks like which instance

320
00:11:23,700 --> 00:11:26,700
we respond to know our categories of

321
00:11:26,700 --> 00:11:29,760
responses that we need to apply

322
00:11:29,760 --> 00:11:32,760
so isolation so we've investigated a

323
00:11:32,760 --> 00:11:34,800
little bit right we've investigated a

324
00:11:34,800 --> 00:11:37,019
little bit or we've detected sorry going

325
00:11:37,019 --> 00:11:38,399
out of order we detected a little bit

326
00:11:38,399 --> 00:11:40,620
and we said okay something was detected

327
00:11:40,620 --> 00:11:42,540
within our environment we need to start

328
00:11:42,540 --> 00:11:44,820
responding to this isolation the idea is

329
00:11:44,820 --> 00:11:47,040
to minimize the impact around the

330
00:11:47,040 --> 00:11:49,019
affected device

331
00:11:49,019 --> 00:11:51,420
so a lot of paid platforms give you the

332
00:11:51,420 --> 00:11:53,579
ability to remotely isolate an endpoint

333
00:11:53,579 --> 00:11:55,920
and that's fantastic if you don't have

334
00:11:55,920 --> 00:11:56,820
that

335
00:11:56,820 --> 00:11:58,560
I highly recommend

336
00:11:58,560 --> 00:12:00,540
the best thing you can do is pull the

337
00:12:00,540 --> 00:12:02,459
Nick or turn it off

338
00:12:02,459 --> 00:12:04,320
why don't we I know it's cheating

339
00:12:04,320 --> 00:12:05,640
because it's already on the slide but

340
00:12:05,640 --> 00:12:07,620
why don't we reboot the machine or power

341
00:12:07,620 --> 00:12:12,200
it off if we can help it at all anyone

342
00:12:12,480 --> 00:12:15,860
yeah so we can inspect it and

343
00:12:15,959 --> 00:12:18,420
yeah memory forensics is super important

344
00:12:18,420 --> 00:12:19,860
right

345
00:12:19,860 --> 00:12:22,800
some payloads so there's there's no true

346
00:12:22,800 --> 00:12:24,779
payloads that execute only in memory

347
00:12:24,779 --> 00:12:27,480
they always touch disk at some point

348
00:12:27,480 --> 00:12:30,060
right so I've I've seen all these claims

349
00:12:30,060 --> 00:12:31,500
you know this my download cradle Only

350
00:12:31,500 --> 00:12:33,060
Hits memory well sure but it also hits

351
00:12:33,060 --> 00:12:35,579
disk a little bit so but we want to

352
00:12:35,579 --> 00:12:37,560
preserve the memory forensics for

353
00:12:37,560 --> 00:12:40,019
investigation after the fact

354
00:12:40,019 --> 00:12:42,420
if we lose the memory forensics we lose

355
00:12:42,420 --> 00:12:44,160
valuable data that can help us tell

356
00:12:44,160 --> 00:12:46,440
where they came from and where they're

357
00:12:46,440 --> 00:12:47,639
going next

358
00:12:47,639 --> 00:12:52,079
right so always always leave that box on

359
00:12:52,079 --> 00:12:54,540
pull the Nick right pull the network

360
00:12:54,540 --> 00:12:56,040
don't let it communicate outbound to

361
00:12:56,040 --> 00:12:58,019
anything else but leave it on if you can

362
00:12:58,019 --> 00:13:00,779
help it if you can't turn it off

363
00:13:00,779 --> 00:13:01,800
right

364
00:13:01,800 --> 00:13:03,720
you're you're better losing those memory

365
00:13:03,720 --> 00:13:06,180
forensics in my opinion so this is

366
00:13:06,180 --> 00:13:08,399
kenton's opinion you're better losing

367
00:13:08,399 --> 00:13:09,839
the memory forensics than you are

368
00:13:09,839 --> 00:13:12,120
allowing them to move laterally

369
00:13:12,120 --> 00:13:13,860
so again it's

370
00:13:13,860 --> 00:13:15,600
understanding what your network looks

371
00:13:15,600 --> 00:13:17,399
like understanding what you're defending

372
00:13:17,399 --> 00:13:18,600
and what your threat profile is

373
00:13:18,600 --> 00:13:20,639
acceptable then you know do I turn it

374
00:13:20,639 --> 00:13:22,139
off do I pull the Nick do I try to get

375
00:13:22,139 --> 00:13:23,820
memory forensics but these are just some

376
00:13:23,820 --> 00:13:25,980
things to consider

377
00:13:25,980 --> 00:13:28,920
so containment containment means finding

378
00:13:28,920 --> 00:13:30,600
where did they move laterally laterally

379
00:13:30,600 --> 00:13:32,339
is anyone not familiar with the concept

380
00:13:32,339 --> 00:13:35,240
of lateral movement

381
00:13:36,060 --> 00:13:39,060
okay great I'm going to say that someone

382
00:13:39,060 --> 00:13:40,500
out there might not be so the idea

383
00:13:40,500 --> 00:13:42,720
behind lateral movement is

384
00:13:42,720 --> 00:13:46,019
um I send user a a malicious Word

385
00:13:46,019 --> 00:13:48,660
document with macros they open it up I

386
00:13:48,660 --> 00:13:51,060
deployed my Cobalt strike and now what

387
00:13:51,060 --> 00:13:53,639
I'm doing is I'm dumping hashes I'm

388
00:13:53,639 --> 00:13:55,320
trying to find out where's my next place

389
00:13:55,320 --> 00:13:57,320
that I can go to gain more privileges

390
00:13:57,320 --> 00:14:00,899
gain more access and ultimately

391
00:14:00,899 --> 00:14:02,820
compromise the network

392
00:14:02,820 --> 00:14:06,000
so what's my next stop right let's say

393
00:14:06,000 --> 00:14:07,920
I'm five hops from a domain

394
00:14:07,920 --> 00:14:10,200
administrator account we need to be able

395
00:14:10,200 --> 00:14:12,240
to tell where the containment is so we

396
00:14:12,240 --> 00:14:14,639
can know how many of those hops did they

397
00:14:14,639 --> 00:14:17,399
go if they went all five hops what do I

398
00:14:17,399 --> 00:14:19,260
have to shut down to contain this

399
00:14:19,260 --> 00:14:21,120
intrusion

400
00:14:21,120 --> 00:14:24,480
so a lot of it is just knowing a lot of

401
00:14:24,480 --> 00:14:25,980
information about your network and

402
00:14:25,980 --> 00:14:27,660
visibility into networks is a super

403
00:14:27,660 --> 00:14:29,760
complex topic we don't have time to dig

404
00:14:29,760 --> 00:14:30,899
into that that's like a four hour

405
00:14:30,899 --> 00:14:33,540
presentation but I recommend you get all

406
00:14:33,540 --> 00:14:35,639
the visibility that you can into your

407
00:14:35,639 --> 00:14:37,500
networks and your assets so that you

408
00:14:37,500 --> 00:14:41,420
know what you're trying to defend

409
00:14:41,600 --> 00:14:43,980
so containment

410
00:14:43,980 --> 00:14:45,480
having a good idea of what the

411
00:14:45,480 --> 00:14:47,639
attacker's goals are

412
00:14:47,639 --> 00:14:49,380
helps you know what you need to contain

413
00:14:49,380 --> 00:14:52,079
and what you don't need to contain so

414
00:14:52,079 --> 00:14:54,600
if does anyone so don't raise your hands

415
00:14:54,600 --> 00:14:57,000
but think in your head if you use active

416
00:14:57,000 --> 00:14:58,320
directory

417
00:14:58,320 --> 00:15:00,240
have you ever heard of bloodhound

418
00:15:00,240 --> 00:15:01,800
if not

419
00:15:01,800 --> 00:15:05,160
after this go download it and run it

420
00:15:05,160 --> 00:15:08,040
and say thank you to the creators of

421
00:15:08,040 --> 00:15:09,660
Bloodhound go tell spectrops thank you

422
00:15:09,660 --> 00:15:10,680
so

423
00:15:10,680 --> 00:15:13,260
Bloodhound is a fantastic active

424
00:15:13,260 --> 00:15:15,660
directory attack mapping tool

425
00:15:15,660 --> 00:15:18,660
that tells you the paths through active

426
00:15:18,660 --> 00:15:20,880
directory misconfigurations to

427
00:15:20,880 --> 00:15:22,680
compromise your network

428
00:15:22,680 --> 00:15:24,660
so it may not tell you some of some

429
00:15:24,660 --> 00:15:26,519
exploits that are out there right but

430
00:15:26,519 --> 00:15:27,779
I'll talk a little bit about Bloodhound

431
00:15:27,779 --> 00:15:28,920
later but

432
00:15:28,920 --> 00:15:31,980
fantastic tool highly recommended if

433
00:15:31,980 --> 00:15:33,600
you're not using it your adversary

434
00:15:33,600 --> 00:15:35,339
likely is

435
00:15:35,339 --> 00:15:37,680
um it's open source so the people trying

436
00:15:37,680 --> 00:15:39,240
to compromise your network are running

437
00:15:39,240 --> 00:15:41,279
Bloodhound so you should run Bloodhound

438
00:15:41,279 --> 00:15:42,180
too

439
00:15:42,180 --> 00:15:43,980
so that you have the same data that they

440
00:15:43,980 --> 00:15:45,180
have and operate from the same point

441
00:15:45,180 --> 00:15:47,519
that they do

442
00:15:47,519 --> 00:15:49,139
investigation so now we're trying to

443
00:15:49,139 --> 00:15:50,760
figure out okay what happened

444
00:15:50,760 --> 00:15:53,639
right I get an alert on an endpoint what

445
00:15:53,639 --> 00:15:55,620
happened what made me get this alert how

446
00:15:55,620 --> 00:15:56,820
did we get here

447
00:15:56,820 --> 00:15:58,199
I'm just doing a quick time check okay

448
00:15:58,199 --> 00:16:00,779
so how did we get to this point

449
00:16:00,779 --> 00:16:02,519
that's our investigation

450
00:16:02,519 --> 00:16:04,079
and so there's tons of different tools

451
00:16:04,079 --> 00:16:05,279
we can use we'll talk a little bit more

452
00:16:05,279 --> 00:16:06,779
about those I've got some quick examples

453
00:16:06,779 --> 00:16:08,699
we're going to do a really dirty quick

454
00:16:08,699 --> 00:16:10,139
and dirty instant response and triage

455
00:16:10,139 --> 00:16:12,360
based off some logs that I've got but

456
00:16:12,360 --> 00:16:14,760
investigation is a bulk of our activity

457
00:16:14,760 --> 00:16:17,940
into determining root cause analysis

458
00:16:17,940 --> 00:16:20,519
and being able to then go back and share

459
00:16:20,519 --> 00:16:22,320
Lessons Learned

460
00:16:22,320 --> 00:16:24,660
so eradication we need to completely

461
00:16:24,660 --> 00:16:26,040
remove the threat from the environment

462
00:16:26,040 --> 00:16:29,579
haha so why do I say haha because this

463
00:16:29,579 --> 00:16:30,660
is tough

464
00:16:30,660 --> 00:16:32,820
right if you don't know exactly what was

465
00:16:32,820 --> 00:16:35,220
affected if you don't know exactly where

466
00:16:35,220 --> 00:16:37,079
the threat actor is going

467
00:16:37,079 --> 00:16:40,980
eradication is tough because I if if you

468
00:16:40,980 --> 00:16:42,600
are in the spot where you could

469
00:16:42,600 --> 00:16:44,399
completely spin up a brand new

470
00:16:44,399 --> 00:16:46,139
environment of you of everything that

471
00:16:46,139 --> 00:16:48,899
you have with a click of a button I envy

472
00:16:48,899 --> 00:16:49,639
you

473
00:16:49,639 --> 00:16:52,440
most most people that I've met aren't

474
00:16:52,440 --> 00:16:53,100
there

475
00:16:53,100 --> 00:16:56,519
and so being able to find out where the

476
00:16:56,519 --> 00:16:58,139
compromise happened trace the exact

477
00:16:58,139 --> 00:17:00,959
chain and then remove that threat from

478
00:17:00,959 --> 00:17:02,699
your organization

479
00:17:02,699 --> 00:17:04,980
takes time you can minimize the impact

480
00:17:04,980 --> 00:17:06,839
and you should protect the things that

481
00:17:06,839 --> 00:17:08,099
are most important to your organization

482
00:17:08,099 --> 00:17:10,260
so that you have time to eradicate the

483
00:17:10,260 --> 00:17:12,720
threat and root cause analysis is very

484
00:17:12,720 --> 00:17:14,939
important because you need you want to

485
00:17:14,939 --> 00:17:15,660
know

486
00:17:15,660 --> 00:17:18,000
how they got in so that you can know

487
00:17:18,000 --> 00:17:19,859
where they likely went next and what you

488
00:17:19,859 --> 00:17:22,559
need to eradicate now attribution is not

489
00:17:22,559 --> 00:17:25,619
root cause analysis in my opinion

490
00:17:25,619 --> 00:17:27,059
I'm not going to cover attribution

491
00:17:27,059 --> 00:17:28,679
because that's

492
00:17:28,679 --> 00:17:31,620
very very complex but root cause

493
00:17:31,620 --> 00:17:33,780
analysis is the idea of

494
00:17:33,780 --> 00:17:36,480
I know at least where this started and

495
00:17:36,480 --> 00:17:38,880
the answer is usually

496
00:17:38,880 --> 00:17:41,100
probably a malicious attachment or an

497
00:17:41,100 --> 00:17:43,320
exposed server somewhere

498
00:17:43,320 --> 00:17:45,240
um that's in most of the investigations

499
00:17:45,240 --> 00:17:48,440
that's where it started

500
00:17:48,660 --> 00:17:50,280
Lessons Learned so I was talking a

501
00:17:50,280 --> 00:17:51,120
little bit about this at the beginning

502
00:17:51,120 --> 00:17:52,679
it's a super important part of the

503
00:17:52,679 --> 00:17:54,960
process we need to be able to share this

504
00:17:54,960 --> 00:17:56,820
information complete transparency should

505
00:17:56,820 --> 00:17:58,380
be the goal does that mean we tell

506
00:17:58,380 --> 00:18:00,419
everyone everything no

507
00:18:00,419 --> 00:18:02,039
but for the people who need the

508
00:18:02,039 --> 00:18:03,840
information we're completely transparent

509
00:18:03,840 --> 00:18:05,520
did we screw up during the incident

510
00:18:05,520 --> 00:18:07,980
response tell them we did

511
00:18:07,980 --> 00:18:10,919
right hey I shut off these five machines

512
00:18:10,919 --> 00:18:12,360
only two of them really needed to be

513
00:18:12,360 --> 00:18:15,120
shut off here's why I shut all five off

514
00:18:15,120 --> 00:18:17,039
did we have some lost work hours for

515
00:18:17,039 --> 00:18:19,440
those people we did here's why it

516
00:18:19,440 --> 00:18:20,460
happened

517
00:18:20,460 --> 00:18:22,200
share the information because then you

518
00:18:22,200 --> 00:18:24,059
build that trust and people know that

519
00:18:24,059 --> 00:18:26,400
you're defending in a way that matters

520
00:18:26,400 --> 00:18:28,919
to the organization be as transparent as

521
00:18:28,919 --> 00:18:30,660
you possibly can

522
00:18:30,660 --> 00:18:32,520
okay so useful tools I want to talk a

523
00:18:32,520 --> 00:18:35,160
little bit about useful tools things

524
00:18:35,160 --> 00:18:37,080
that are great for people to use an

525
00:18:37,080 --> 00:18:38,700
incident response scenarios in my

526
00:18:38,700 --> 00:18:40,140
opinion

527
00:18:40,140 --> 00:18:42,900
so disclaimer for anyone who's a hacker

528
00:18:42,900 --> 00:18:44,700
in the room which I like to pretend that

529
00:18:44,700 --> 00:18:48,240
I'm a hacker if you are deploying a

530
00:18:48,240 --> 00:18:51,120
payload to an endpoint and The Blue Team

531
00:18:51,120 --> 00:18:53,880
doesn't know that you're

532
00:18:53,880 --> 00:18:56,220
performing an authorized test of that

533
00:18:56,220 --> 00:18:57,539
Network

534
00:18:57,539 --> 00:18:58,799
so if you're doing this in the dark

535
00:18:58,799 --> 00:19:01,980
right then please don't complain that

536
00:19:01,980 --> 00:19:03,660
your payload got up late uploaded to

537
00:19:03,660 --> 00:19:07,020
virus total right we've got to be better

538
00:19:07,020 --> 00:19:09,059
than that we can't just say why did you

539
00:19:09,059 --> 00:19:10,500
do that you know my payload's burned

540
00:19:10,500 --> 00:19:12,480
you're right it's burned there was no

541
00:19:12,480 --> 00:19:14,299
con there was no sharing of information

542
00:19:14,299 --> 00:19:17,640
in this very important exercise of the

543
00:19:17,640 --> 00:19:19,740
maturity of our organization

544
00:19:19,740 --> 00:19:21,960
so by the way I built I build custom

545
00:19:21,960 --> 00:19:24,059
payloads I love it do I hate it when

546
00:19:24,059 --> 00:19:26,220
they get burned yes is it usually my

547
00:19:26,220 --> 00:19:29,400
fault when they get burned 100 percent

548
00:19:29,400 --> 00:19:30,960
so I'm going to talk a little bit about

549
00:19:30,960 --> 00:19:32,400
some different different tool categories

550
00:19:32,400 --> 00:19:34,980
so online sandboxes decoding and

551
00:19:34,980 --> 00:19:36,539
decrypting tools reverse engineering

552
00:19:36,539 --> 00:19:39,179
tools and attack mapping and Analysis

553
00:19:39,179 --> 00:19:40,380
tools

554
00:19:40,380 --> 00:19:41,780
so

555
00:19:41,780 --> 00:19:43,919
reverse engineering tools for anyone who

556
00:19:43,919 --> 00:19:46,020
just went this is not beginner I'm going

557
00:19:46,020 --> 00:19:48,059
to cover like the very smallest amount

558
00:19:48,059 --> 00:19:50,340
of reverse engineering so it's going to

559
00:19:50,340 --> 00:19:51,780
be very beginner focused because reverse

560
00:19:51,780 --> 00:19:54,480
engineering again it's a whole topic

561
00:19:54,480 --> 00:19:56,700
that could take hours to go into

562
00:19:56,700 --> 00:19:59,340
so let's talk about online sandboxes has

563
00:19:59,340 --> 00:20:02,340
anyone never used an online sandbox

564
00:20:02,340 --> 00:20:03,840
if I raise a hand

565
00:20:03,840 --> 00:20:06,480
Okay cool so the idea behind an online

566
00:20:06,480 --> 00:20:10,980
sandbox is that I submit the document

567
00:20:10,980 --> 00:20:13,620
executable

568
00:20:13,620 --> 00:20:16,500
um HTML file ISO whatever it is right

569
00:20:16,500 --> 00:20:18,360
whatever I'm getting alerts from I

570
00:20:18,360 --> 00:20:21,240
submit that to this online sandbox

571
00:20:21,240 --> 00:20:24,360
and they'll spin up multiple VMS or AVM

572
00:20:24,360 --> 00:20:26,840
for me

573
00:20:27,179 --> 00:20:29,940
run the payload and give me analysis of

574
00:20:29,940 --> 00:20:32,280
what the payload did what IPS it reached

575
00:20:32,280 --> 00:20:34,740
out to the things that it did on disk

576
00:20:34,740 --> 00:20:36,780
it'll give me this full analysis and

577
00:20:36,780 --> 00:20:38,940
it's completely free

578
00:20:38,940 --> 00:20:41,580
the bottom bullet point is the caveat as

579
00:20:41,580 --> 00:20:43,260
to why it's completely free

580
00:20:43,260 --> 00:20:45,000
you're giving out free threat

581
00:20:45,000 --> 00:20:46,679
intelligence

582
00:20:46,679 --> 00:20:48,660
which is okay but it's might not be

583
00:20:48,660 --> 00:20:51,000
great for your organization so if your

584
00:20:51,000 --> 00:20:53,880
organization tightly controls all

585
00:20:53,880 --> 00:20:55,320
information submitted within your

586
00:20:55,320 --> 00:20:57,900
systems online sandboxes unless you have

587
00:20:57,900 --> 00:20:59,520
a premium subscription that says you

588
00:20:59,520 --> 00:21:02,100
they will not share are probably not for

589
00:21:02,100 --> 00:21:04,799
you so understand what your risk

590
00:21:04,799 --> 00:21:06,480
acceptance profile is for your

591
00:21:06,480 --> 00:21:07,880
organization

592
00:21:07,880 --> 00:21:10,260
if the risk acceptance profile is much

593
00:21:10,260 --> 00:21:12,240
more broad online sandboxes are

594
00:21:12,240 --> 00:21:14,960
fantastic one of my favorite is triage

595
00:21:14,960 --> 00:21:18,419
tri.age fantastic sandbox you can spin

596
00:21:18,419 --> 00:21:19,760
up a Windows 7

597
00:21:19,760 --> 00:21:23,100
Windows 10. I haven't seen 11 yet

598
00:21:23,100 --> 00:21:25,200
you can spin up a Windows 7 and a

599
00:21:25,200 --> 00:21:27,960
Windows 10 VM it'll run whatever you

600
00:21:27,960 --> 00:21:30,299
submitted to it it'll build you a report

601
00:21:30,299 --> 00:21:32,580
based on the behavior of what it found

602
00:21:32,580 --> 00:21:35,220
and it will link back to miter ttps

603
00:21:35,220 --> 00:21:37,679
which is all very important stuff I mean

604
00:21:37,679 --> 00:21:40,380
I try to avoid over-the-top business

605
00:21:40,380 --> 00:21:43,200
speak if I can but miter ttps are super

606
00:21:43,200 --> 00:21:44,760
important because a lot of people see

607
00:21:44,760 --> 00:21:47,159
that as a de facto ranking

608
00:21:47,159 --> 00:21:49,740
so triage is fantastic by the way

609
00:21:49,740 --> 00:21:51,720
everything you submit is public so if

610
00:21:51,720 --> 00:21:53,760
you submitted a doc the document you

611
00:21:53,760 --> 00:21:55,679
thought was bad that had confidential

612
00:21:55,679 --> 00:21:58,080
confidential information in it it's now

613
00:21:58,080 --> 00:22:00,179
free to the public so you just have to

614
00:22:00,179 --> 00:22:01,860
exercise caution when using online

615
00:22:01,860 --> 00:22:04,699
sandboxes

616
00:22:05,000 --> 00:22:07,320
virustotal has anyone not heard of virus

617
00:22:07,320 --> 00:22:08,940
total

618
00:22:08,940 --> 00:22:12,240
so the idea behind virustotal is they

619
00:22:12,240 --> 00:22:14,220
spin up a whole bunch of anti-virus

620
00:22:14,220 --> 00:22:16,220
engines in containers on the back end

621
00:22:16,220 --> 00:22:19,500
every time you submit something that has

622
00:22:19,500 --> 00:22:22,140
never been seen before those containers

623
00:22:22,140 --> 00:22:23,520
will run their detection against

624
00:22:23,520 --> 00:22:25,860
whatever is in there and then they'll

625
00:22:25,860 --> 00:22:27,299
give you back whether it was detected

626
00:22:27,299 --> 00:22:29,100
clean or malicious

627
00:22:29,100 --> 00:22:31,919
so if it's already seen it before so

628
00:22:31,919 --> 00:22:34,020
let's say and you can search by hash or

629
00:22:34,020 --> 00:22:35,460
let's say I submit executable that's

630
00:22:35,460 --> 00:22:37,500
already seen then it'll show me here's

631
00:22:37,500 --> 00:22:39,059
the detection rate for that executable

632
00:22:39,059 --> 00:22:41,100
across all these different antivirus

633
00:22:41,100 --> 00:22:42,960
platforms here's the people that think

634
00:22:42,960 --> 00:22:44,220
it's malicious here's the community

635
00:22:44,220 --> 00:22:45,960
score for it if there is a community

636
00:22:45,960 --> 00:22:49,500
score so people can go and

637
00:22:49,500 --> 00:22:51,480
go and say hey yeah I saw this on my

638
00:22:51,480 --> 00:22:53,100
network it's bad or people can go and

639
00:22:53,100 --> 00:22:54,600
say no it's a Microsoft signed binary

640
00:22:54,600 --> 00:22:56,520
that's just doing dumb things so there's

641
00:22:56,520 --> 00:22:58,080
there's the community element to it

642
00:22:58,080 --> 00:23:00,299
which is great but if you have a virus

643
00:23:00,299 --> 00:23:02,520
total premium membership you can

644
00:23:02,520 --> 00:23:04,500
download everything that's submitted to

645
00:23:04,500 --> 00:23:06,780
virustotal

646
00:23:06,780 --> 00:23:09,539
which is awesome for threat research

647
00:23:09,539 --> 00:23:11,880
like if I want to go grab the latest

648
00:23:11,880 --> 00:23:14,100
um the latest Ice D or the latest

649
00:23:14,100 --> 00:23:17,460
bumblebee cool I can go get it there but

650
00:23:17,460 --> 00:23:19,559
everything you submit can be downloaded

651
00:23:19,559 --> 00:23:20,700
by someone else

652
00:23:20,700 --> 00:23:22,559
so that's that's the big caveat with

653
00:23:22,559 --> 00:23:23,940
those Services

654
00:23:23,940 --> 00:23:26,280
um decoding and decrypting tools

655
00:23:26,280 --> 00:23:29,340
has anyone heard of cyber Chef before

656
00:23:29,340 --> 00:23:31,679
cyber Chef fantastic online decoding and

657
00:23:31,679 --> 00:23:33,179
decrypting Tool if you have the keys you

658
00:23:33,179 --> 00:23:36,179
can decrypt payloads or if it's base64

659
00:23:36,179 --> 00:23:39,360
you can unbase 60 for it right so it's

660
00:23:39,360 --> 00:23:43,020
it's a fantastic online platform

661
00:23:43,020 --> 00:23:45,179
that will let you mess around with

662
00:23:45,179 --> 00:23:47,760
different strings of payloads try

663
00:23:47,760 --> 00:23:49,919
different combinations of you know maybe

664
00:23:49,919 --> 00:23:54,059
the base64 and then rotted it

665
00:23:54,059 --> 00:23:55,919
you know or maybe there's some stego in

666
00:23:55,919 --> 00:23:57,179
this image that I pulled out and I don't

667
00:23:57,179 --> 00:23:59,520
know what it is so you can take on Cyber

668
00:23:59,520 --> 00:24:01,740
Chef cyber Chef doesn't save stuff and

669
00:24:01,740 --> 00:24:02,940
share stuff

670
00:24:02,940 --> 00:24:05,460
so if you have a text payload I highly

671
00:24:05,460 --> 00:24:07,740
recommend cyber Chef be would be where

672
00:24:07,740 --> 00:24:10,320
you go to mess with it and if and I know

673
00:24:10,320 --> 00:24:12,299
that image is like super tiny but that's

674
00:24:12,299 --> 00:24:14,880
a base64 encoded Powershell download

675
00:24:14,880 --> 00:24:16,740
cradle

676
00:24:16,740 --> 00:24:20,780
so that's what that is in my image

677
00:24:20,940 --> 00:24:23,159
trial and error so

678
00:24:23,159 --> 00:24:26,100
this wonderful string of Powershell

679
00:24:26,100 --> 00:24:28,260
trial and error is a huge part of it

680
00:24:28,260 --> 00:24:30,299
knowing what the attackers are trying to

681
00:24:30,299 --> 00:24:32,760
do helps you decode what the Powershell

682
00:24:32,760 --> 00:24:34,919
is looking at this quickly does anyone

683
00:24:34,919 --> 00:24:38,179
have a guess as to what this is

684
00:24:40,919 --> 00:24:43,440
this is a Powershell download cradle

685
00:24:43,440 --> 00:24:44,640
does anyone know what a Powershell

686
00:24:44,640 --> 00:24:47,280
download cradle is by raise man

687
00:24:47,280 --> 00:24:50,100
the idea is I the malicious per attacker

688
00:24:50,100 --> 00:24:52,020
put together a sequence of Powershell

689
00:24:52,020 --> 00:24:54,299
that's going to go out and from that end

690
00:24:54,299 --> 00:24:55,620
point is going to go to a different

691
00:24:55,620 --> 00:24:57,840
endpoint download some Powershell

692
00:24:57,840 --> 00:25:01,020
execute it mostly in memory that will

693
00:25:01,020 --> 00:25:03,240
give them a shell or a session on that

694
00:25:03,240 --> 00:25:05,340
host

695
00:25:05,340 --> 00:25:08,820
so how you can tell really quickly is

696
00:25:08,820 --> 00:25:10,200
I'm oh I'm not supposed to wander too

697
00:25:10,200 --> 00:25:11,280
far from the podium I told him I

698
00:25:11,280 --> 00:25:13,559
wouldn't so if you look at where it says

699
00:25:13,559 --> 00:25:16,200
uh we got the double colon in New

700
00:25:16,200 --> 00:25:17,820
at the very bottom so they're doing a

701
00:25:17,820 --> 00:25:19,140
whole bunch of obfuscation here but the

702
00:25:19,140 --> 00:25:20,700
double colon and new tells me that

703
00:25:20,700 --> 00:25:23,460
they're creating a new instance of

704
00:25:23,460 --> 00:25:24,539
gosh I can't even remember the

705
00:25:24,539 --> 00:25:27,179
terminology but the Powershell class is

706
00:25:27,179 --> 00:25:28,980
going to download text for them from a

707
00:25:28,980 --> 00:25:31,520
remote service

708
00:25:32,100 --> 00:25:34,140
reverse engineering tools

709
00:25:34,140 --> 00:25:37,500
strings does anyone ever run strings

710
00:25:37,500 --> 00:25:40,620
so strings is included by default in

711
00:25:40,620 --> 00:25:42,559
Linux and Mac OS

712
00:25:42,559 --> 00:25:45,480
Windows terminal I don't know if Windows

713
00:25:45,480 --> 00:25:46,559
terminal strings I haven't played with

714
00:25:46,559 --> 00:25:48,120
Windows terminal in like a year or so

715
00:25:48,120 --> 00:25:51,179
but the idea is it'll go into a binary

716
00:25:51,179 --> 00:25:54,240
tell you any of the dot Text data or the

717
00:25:54,240 --> 00:25:56,400
dot data data that it can find and show

718
00:25:56,400 --> 00:25:57,720
you what it thinks that binary is doing

719
00:25:57,720 --> 00:25:58,559
so

720
00:25:58,559 --> 00:26:02,779
I created a thing called util.elf

721
00:26:03,059 --> 00:26:05,460
and as we can see here does anyone want

722
00:26:05,460 --> 00:26:07,260
a hazard guess

723
00:26:07,260 --> 00:26:10,020
as to what util.elf is doing based off

724
00:26:10,020 --> 00:26:13,039
the strings data

725
00:26:14,279 --> 00:26:16,140
yes

726
00:26:16,140 --> 00:26:20,179
great and what tells you that

727
00:26:21,059 --> 00:26:23,880
perfect thank you fantastic so I see

728
00:26:23,880 --> 00:26:25,080
someone

729
00:26:25,080 --> 00:26:27,179
there's an IP in there and they're

730
00:26:27,179 --> 00:26:29,520
executing bin sh so that tells me this

731
00:26:29,520 --> 00:26:32,220
is likely a reverse show

732
00:26:32,220 --> 00:26:34,260
so dot Peak does anyone ever used dot

733
00:26:34,260 --> 00:26:37,500
Peak or any of the other

734
00:26:37,500 --> 00:26:40,159
sort of things like that so the idea is

735
00:26:40,159 --> 00:26:42,539
taking.net source code back to its

736
00:26:42,539 --> 00:26:43,679
original source code and I got to kind

737
00:26:43,679 --> 00:26:45,539
of hurry I'm almost out of time so the

738
00:26:45,539 --> 00:26:46,860
idea is it'll take it back to its

739
00:26:46,860 --> 00:26:48,840
original source code for me because.net

740
00:26:48,840 --> 00:26:51,120
is super friendly like that we'll do it

741
00:26:51,120 --> 00:26:53,039
for C binaries and C plus plus nope

742
00:26:53,039 --> 00:26:54,779
just.net

743
00:26:54,779 --> 00:26:56,400
so reverse engineering you can go super

744
00:26:56,400 --> 00:26:58,320
deep on reverse engineering we're not

745
00:26:58,320 --> 00:26:59,700
going to because it's super complex

746
00:26:59,700 --> 00:27:01,860
Bloodhound go get Bloodhound it's

747
00:27:01,860 --> 00:27:03,960
fantastic run it against your active

748
00:27:03,960 --> 00:27:05,940
directory domain it will tell you the

749
00:27:05,940 --> 00:27:07,380
steps that the attacker is going to take

750
00:27:07,380 --> 00:27:10,740
to compromise your domain

751
00:27:10,740 --> 00:27:13,200
so fantastic tool I love Bloodhound I've

752
00:27:13,200 --> 00:27:14,520
got two Bloodhound t-shirts I didn't

753
00:27:14,520 --> 00:27:16,620
wear them today but I love bloodhound

754
00:27:16,620 --> 00:27:18,419
so log files

755
00:27:18,419 --> 00:27:20,159
get all the log files that you can

756
00:27:20,159 --> 00:27:21,720
during your instant response because

757
00:27:21,720 --> 00:27:23,940
learning to analyze log files for common

758
00:27:23,940 --> 00:27:26,880
attack paths and patterns will save you

759
00:27:26,880 --> 00:27:30,000
hours of time learn how to be a hacker

760
00:27:30,000 --> 00:27:32,640
so that you can respond to incidents

761
00:27:32,640 --> 00:27:34,380
appropriately

762
00:27:34,380 --> 00:27:36,000
so learn how to carry out super common

763
00:27:36,000 --> 00:27:38,820
exploits so I've I've got two minutes

764
00:27:38,820 --> 00:27:40,620
left so we're gonna look real quick so

765
00:27:40,620 --> 00:27:41,940
does anyone

766
00:27:41,940 --> 00:27:44,100
want to can anyone tell me what the

767
00:27:44,100 --> 00:27:46,200
highlighted line and the highlighted log

768
00:27:46,200 --> 00:27:47,640
entry is

769
00:27:47,640 --> 00:27:49,260
or is it too small if it's too small

770
00:27:49,260 --> 00:27:52,580
just say so and I'll go the next slide

771
00:27:52,620 --> 00:27:54,779
too small Okay cool so in this Windows

772
00:27:54,779 --> 00:27:55,679
log

773
00:27:55,679 --> 00:27:57,779
the remote registry service has been

774
00:27:57,779 --> 00:27:59,820
started that tells me that likely

775
00:27:59,820 --> 00:28:01,679
someone dumped credentials remotely

776
00:28:01,679 --> 00:28:04,919
using a packet from this machine

777
00:28:04,919 --> 00:28:07,620
so someone had valid credentials used in

778
00:28:07,620 --> 00:28:11,760
packets PA was a secret stump to grab

779
00:28:11,760 --> 00:28:13,140
credentials from this machine by

780
00:28:13,140 --> 00:28:15,240
starting the remote registry service

781
00:28:15,240 --> 00:28:17,580
web access log files

782
00:28:17,580 --> 00:28:19,200
so does anyone

783
00:28:19,200 --> 00:28:22,200
want to Hazard this to tell me what's

784
00:28:22,200 --> 00:28:24,900
happening here so this is just my Apache

785
00:28:24,900 --> 00:28:26,760
logs

786
00:28:26,760 --> 00:28:28,679
and there's a very clear path that

787
00:28:28,679 --> 00:28:30,179
somebody took

788
00:28:30,179 --> 00:28:33,480
and there's something that happened here

789
00:28:33,480 --> 00:28:35,580
yeah

790
00:28:35,580 --> 00:28:37,559
they so they are that's the first part

791
00:28:37,559 --> 00:28:38,880
right they're trying to figure out where

792
00:28:38,880 --> 00:28:40,440
things are

793
00:28:40,440 --> 00:28:42,419
so they're looking at it so they start

794
00:28:42,419 --> 00:28:45,059
the index they go to the dashboard and

795
00:28:45,059 --> 00:28:47,640
then we see that they go to

796
00:28:47,640 --> 00:28:49,860
they are trying to enumerate enumerate

797
00:28:49,860 --> 00:28:52,380
an uploads folder so this thing lets you

798
00:28:52,380 --> 00:28:54,659
upload stuff right they found that

799
00:28:54,659 --> 00:28:57,000
there's an upload uploads folder

800
00:28:57,000 --> 00:29:00,960
and we see that there is a bunch of 404s

801
00:29:00,960 --> 00:29:02,700
they tried to upload something but they

802
00:29:02,700 --> 00:29:04,620
couldn't get to it and then they called

803
00:29:04,620 --> 00:29:07,080
the add function

804
00:29:07,080 --> 00:29:09,900
and then they were able to go to the

805
00:29:09,900 --> 00:29:13,140
very bottom line says that test.php was

806
00:29:13,140 --> 00:29:16,140
uploaded and we get a 200 so 200 means

807
00:29:16,140 --> 00:29:18,960
it was successful CMD equals ID so what

808
00:29:18,960 --> 00:29:20,399
did they just do they uploaded a web

809
00:29:20,399 --> 00:29:22,860
shell onto this web server and they

810
00:29:22,860 --> 00:29:24,779
executed the ID command to tell what

811
00:29:24,779 --> 00:29:28,220
level of privileges they're running with

812
00:29:28,380 --> 00:29:31,500
and then last plug flare VM is a

813
00:29:31,500 --> 00:29:33,779
fantastic VM that bundles together a

814
00:29:33,779 --> 00:29:35,220
bunch of these tools that I talked about

815
00:29:35,220 --> 00:29:38,520
it's a Windows VM mandiant maintains it

816
00:29:38,520 --> 00:29:41,460
so grab player VM it gives you a ton of

817
00:29:41,460 --> 00:29:43,320
instant response tools all in one

818
00:29:43,320 --> 00:29:45,120
package that you can run virtualized

819
00:29:45,120 --> 00:29:47,880
which helps protect your host OS

820
00:29:47,880 --> 00:29:50,520
you can detonate things in there and let

821
00:29:50,520 --> 00:29:52,080
it be destroyed and cleaned up and I am

822
00:29:52,080 --> 00:29:53,580
out of time if you have any questions

823
00:29:53,580 --> 00:29:55,380
please come up and talk to me after

824
00:29:55,380 --> 00:29:56,940
thank you so much everybody I really

825
00:29:56,940 --> 00:29:59,539
appreciate it

