1
00:00:04,130 --> 00:00:08,969
all right we're gonna go ahead<font color="#CCCCCC"> and</font><font color="#E5E5E5"> get</font>

2
00:00:06,120 --> 00:00:11,400
started<font color="#E5E5E5"> welcome</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> presentation</font><font color="#E5E5E5"> on</font>

3
00:00:08,970 --> 00:00:15,780
<font color="#CCCCCC">windows tactical endpoint monitoring a</font>

4
00:00:11,400 --> 00:00:17,699
quick introduction<font color="#E5E5E5"> who are we I'm</font><font color="#CCCCCC"> Jon</font>

5
00:00:15,780 --> 00:00:19,948
Sidwell<font color="#CCCCCC"> I work for the county of Salt</font>

6
00:00:17,699 --> 00:00:22,080
Lake<font color="#E5E5E5"> I'm an IT security engine they're</font>

7
00:00:19,949 --> 00:00:24,600
engineer<font color="#CCCCCC"> they're been there about</font><font color="#E5E5E5"> four</font>

8
00:00:22,080 --> 00:00:27,810
years<font color="#CCCCCC"> some of my responsibilities</font>

9
00:00:24,600 --> 00:00:31,669
include<font color="#E5E5E5"> red teaming vulnerability</font>

10
00:00:27,810 --> 00:00:34,469
scanning<font color="#E5E5E5"> threat hunting sim management</font>

11
00:00:31,669 --> 00:00:35,820
<font color="#E5E5E5">and a lot of endpoint security</font><font color="#CCCCCC"> I have a</font>

12
00:00:34,469 --> 00:00:37,920
<font color="#CCCCCC">co-worker Chris who's going to be</font>

13
00:00:35,820 --> 00:00:39,840
presenting<font color="#CCCCCC"> the Hat second half</font><font color="#E5E5E5"> and I'll</font>

14
00:00:37,920 --> 00:00:44,610
let him introduce<font color="#E5E5E5"> himself when he when</font>

15
00:00:39,840 --> 00:00:47,010
he<font color="#CCCCCC"> gets up so I'm</font><font color="#E5E5E5"> gonna start off</font><font color="#CCCCCC"> by</font>

16
00:00:44,610 --> 00:00:49,260
talking about endpoints monitoring why

17
00:00:47,010 --> 00:00:52,110
it's important what insight can be

18
00:00:49,260 --> 00:00:53,820
gained from monitoring endpoints<font color="#E5E5E5"> I'm</font>

19
00:00:52,110 --> 00:00:56,190
going to talk<font color="#E5E5E5"> about a specific tool</font>

20
00:00:53,820 --> 00:00:58,410
called system on from sysinternals<font color="#CCCCCC"> that</font>

21
00:00:56,190 --> 00:01:00,420
can help generate<font color="#E5E5E5"> logs around that</font>

22
00:00:58,410 --> 00:01:02,148
activity<font color="#E5E5E5"> and then I'll turn it over to</font>

23
00:01:00,420 --> 00:01:04,470
Chris<font color="#E5E5E5"> and Chris is going to talk about</font>

24
00:01:02,149 --> 00:01:09,030
<font color="#E5E5E5">elastic stack and how we're using</font>

25
00:01:04,470 --> 00:01:10,830
elastic stack<font color="#E5E5E5"> to gather all this all</font>

26
00:01:09,030 --> 00:01:12,990
<font color="#E5E5E5">these logs that system on is generating</font>

27
00:01:10,830 --> 00:01:15,179
and bring it into<font color="#E5E5E5"> a central source so we</font>

28
00:01:12,990 --> 00:01:19,080
<font color="#CCCCCC">can utilize</font><font color="#E5E5E5"> those logs from a central</font>

29
00:01:15,180 --> 00:01:22,229
platform<font color="#E5E5E5"> so we had a</font><font color="#CCCCCC"> problem it's the</font>

30
00:01:19,080 --> 00:01:24,630
Salt<font color="#E5E5E5"> Lake County back</font><font color="#CCCCCC"> in 2016 we brought</font>

31
00:01:22,229 --> 00:01:27,360
in a pen testing company to do an

32
00:01:24,630 --> 00:01:29,390
internal pen test<font color="#CCCCCC"> and we learned very</font>

33
00:01:27,360 --> 00:01:32,430
<font color="#CCCCCC">quickly</font><font color="#E5E5E5"> that we had a visibility problem</font>

34
00:01:29,390 --> 00:01:35,220
what's<font color="#E5E5E5"> the adversary or the pen tester</font>

35
00:01:32,430 --> 00:01:37,340
in this case got<font color="#E5E5E5"> on to our systems</font><font color="#CCCCCC"> and</font>

36
00:01:35,220 --> 00:01:41,340
<font color="#E5E5E5">started the post exploitation phase of</font>

37
00:01:37,340 --> 00:01:44,310
his attack cycle<font color="#CCCCCC"> we missed a lot</font><font color="#E5E5E5"> of his</font>

38
00:01:41,340 --> 00:01:46,740
activity there<font color="#CCCCCC"> was a lot of credential</font>

39
00:01:44,310 --> 00:01:48,659
theft and reuse a lot of moving

40
00:01:46,740 --> 00:01:51,119
<font color="#E5E5E5">laterally between systems workstation</font>

41
00:01:48,659 --> 00:01:52,920
and workstation or server to server the

42
00:01:51,119 --> 00:01:56,369
pen tester used a lot of<font color="#E5E5E5"> living off the</font>

43
00:01:52,920 --> 00:02:00,600
land techniques using<font color="#CCCCCC"> wmi or</font><font color="#E5E5E5"> when RM or</font>

44
00:01:56,369 --> 00:02:01,979
powershell<font color="#E5E5E5"> and</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> things were kind of</font>

45
00:02:00,600 --> 00:02:04,949
foreign<font color="#CCCCCC"> to us and we didn't have a good</font>

46
00:02:01,979 --> 00:02:07,770
<font color="#E5E5E5">handle on</font><font color="#CCCCCC"> how to track them and and be</font>

47
00:02:04,950 --> 00:02:09,390
<font color="#CCCCCC">able to detect their use and then even</font>

48
00:02:07,770 --> 00:02:11,640
<font color="#E5E5E5">when we did in the few cases</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we</font>

49
00:02:09,389 --> 00:02:13,279
were able<font color="#E5E5E5"> to determine there was an</font>

50
00:02:11,640 --> 00:02:15,470
indicator<font color="#E5E5E5"> of compromise we had a</font><font color="#CCCCCC"> probe</font>

51
00:02:13,280 --> 00:02:17,240
<font color="#E5E5E5">and being able to scale out and look</font>

52
00:02:15,470 --> 00:02:19,910
across<font color="#CCCCCC"> to all of</font><font color="#E5E5E5"> our systems to see</font>

53
00:02:17,240 --> 00:02:20,840
where else that particular activity<font color="#CCCCCC"> was</font>

54
00:02:19,910 --> 00:02:23,060
<font color="#E5E5E5">taking place on</font>

55
00:02:20,840 --> 00:02:25,340
so<font color="#E5E5E5"> we've Italy we realized very quickly</font>

56
00:02:23,060 --> 00:02:28,220
that<font color="#CCCCCC"> we needed better logging and better</font>

57
00:02:25,340 --> 00:02:29,780
visibility<font color="#CCCCCC"> and</font><font color="#E5E5E5"> we needed to</font><font color="#CCCCCC"> be on our</font>

58
00:02:28,220 --> 00:02:32,630
<font color="#E5E5E5">endpoints to be able to track</font><font color="#CCCCCC"> that</font>

59
00:02:29,780 --> 00:02:36,560
activity and and track<font color="#CCCCCC"> that that</font>

60
00:02:32,630 --> 00:02:38,170
<font color="#E5E5E5">movement of the adversary so what some</font>

61
00:02:36,560 --> 00:02:40,850
why do we want<font color="#E5E5E5"> to monitor</font><font color="#CCCCCC"> the endpoint</font>

62
00:02:38,170 --> 00:02:42,769
here's a quick little side-by-side

63
00:02:40,850 --> 00:02:44,390
comparison<font color="#E5E5E5"> of what you can get from</font>

64
00:02:42,770 --> 00:02:47,540
monitoring the<font color="#CCCCCC"> network versus what you</font>

65
00:02:44,390 --> 00:02:50,059
can get from<font color="#E5E5E5"> monitoring an endpoint so</font>

66
00:02:47,540 --> 00:02:51,590
muttering the the<font color="#E5E5E5"> network you can gain</font>

67
00:02:50,060 --> 00:02:54,110
some a lot about valuable<font color="#E5E5E5"> information</font>

68
00:02:51,590 --> 00:02:56,690
<font color="#CCCCCC">their IP addresses that</font><font color="#E5E5E5"> are involved</font>

69
00:02:54,110 --> 00:02:57,920
from<font color="#E5E5E5"> the client the</font><font color="#CCCCCC"> server's ports that</font>

70
00:02:56,690 --> 00:03:00,859
<font color="#CCCCCC">are used number of bytes they're</font>

71
00:02:57,920 --> 00:03:02,569
transferred duration of connections<font color="#E5E5E5"> in</font>

72
00:03:00,860 --> 00:03:06,069
the case<font color="#E5E5E5"> of this comparison it's a</font>

73
00:03:02,569 --> 00:03:08,149
remote access trojan so if that

74
00:03:06,069 --> 00:03:10,160
communication over the<font color="#CCCCCC"> network was</font>

75
00:03:08,150 --> 00:03:11,930
unencrypted you perhaps could see the

76
00:03:10,160 --> 00:03:15,019
commands were being issued from system

77
00:03:11,930 --> 00:03:17,690
system<font color="#CCCCCC"> however that also</font><font color="#E5E5E5"> might be</font>

78
00:03:15,019 --> 00:03:18,860
<font color="#E5E5E5">encoded and difficult to look at but if</font>

79
00:03:17,690 --> 00:03:20,060
we<font color="#E5E5E5"> get if we're on the monitor if we're</font>

80
00:03:18,860 --> 00:03:22,750
on the<font color="#E5E5E5"> endpoint</font><font color="#CCCCCC"> and we're tracking</font>

81
00:03:20,060 --> 00:03:25,010
activity there<font color="#E5E5E5"> we can pick up everything</font>

82
00:03:22,750 --> 00:03:27,680
<font color="#CCCCCC">that we could have</font><font color="#E5E5E5"> picked up</font><font color="#CCCCCC"> from the</font>

83
00:03:25,010 --> 00:03:29,000
network<font color="#E5E5E5"> but in</font><font color="#CCCCCC"> addition to</font><font color="#E5E5E5"> that where</font>

84
00:03:27,680 --> 00:03:32,810
you can<font color="#E5E5E5"> start looking at the commands</font>

85
00:03:29,000 --> 00:03:34,670
regardless of SSL or TLS<font color="#E5E5E5"> we can start</font>

86
00:03:32,810 --> 00:03:38,180
understanding<font color="#E5E5E5"> what users are involved</font>

87
00:03:34,670 --> 00:03:41,359
<font color="#E5E5E5">with with a</font><font color="#CCCCCC"> compromised</font><font color="#E5E5E5"> or you know</font>

88
00:03:38,180 --> 00:03:43,670
suspicious activity<font color="#CCCCCC"> we</font><font color="#E5E5E5"> can pick up the</font>

89
00:03:41,360 --> 00:03:46,549
privileges of<font color="#E5E5E5"> those users</font><font color="#CCCCCC"> is that user</font>

90
00:03:43,670 --> 00:03:48,559
running<font color="#E5E5E5"> with unprivileged rights or they</font>

91
00:03:46,549 --> 00:03:52,160
you know made<font color="#E5E5E5"> perhaps</font><font color="#CCCCCC"> a local admin or</font>

92
00:03:48,560 --> 00:03:53,870
even a domain privileged account and

93
00:03:52,160 --> 00:03:55,850
with the remote access trojan we can

94
00:03:53,870 --> 00:03:59,810
start looking at files that perhaps were

95
00:03:55,850 --> 00:04:03,590
downloaded or moved<font color="#CCCCCC"> around</font><font color="#E5E5E5"> we can start</font>

96
00:03:59,810 --> 00:04:05,750
monitoring<font color="#E5E5E5"> the various locations for for</font>

97
00:04:03,590 --> 00:04:08,209
persistence attempting the<font color="#CCCCCC"> remote access</font>

98
00:04:05,750 --> 00:04:10,190
<font color="#CCCCCC">trojan attempting to gain persistence on</font>

99
00:04:08,209 --> 00:04:11,840
a system and a lot more<font color="#E5E5E5"> and we'll go</font>

100
00:04:10,190 --> 00:04:13,400
into<font color="#E5E5E5"> some</font><font color="#CCCCCC"> of those additional</font><font color="#E5E5E5"> details</font>

101
00:04:11,840 --> 00:04:15,380
here shortly

102
00:04:13,400 --> 00:04:17,630
one of the hard things with monitoring

103
00:04:15,380 --> 00:04:21,409
endpoints is they're such a large number

104
00:04:17,630 --> 00:04:23,030
<font color="#CCCCCC">of</font><font color="#E5E5E5"> devices and you know as you scale</font><font color="#CCCCCC"> up</font>

105
00:04:21,409 --> 00:04:25,039
and more and more system to get involved

106
00:04:23,030 --> 00:04:26,400
it comes more difficult to manage<font color="#CCCCCC"> on the</font>

107
00:04:25,039 --> 00:04:29,340
network side

108
00:04:26,400 --> 00:04:31,440
it can be easier<font color="#E5E5E5"> in a lot</font><font color="#CCCCCC"> of cases</font>

109
00:04:29,340 --> 00:04:33,150
<font color="#E5E5E5">because there's maybe a few choke points</font>

110
00:04:31,440 --> 00:04:34,800
<font color="#E5E5E5">and you just have to deploy a few</font>

111
00:04:33,150 --> 00:04:36,919
systems<font color="#E5E5E5"> at those choke points to be able</font>

112
00:04:34,800 --> 00:04:38,970
<font color="#CCCCCC">to monitor</font><font color="#E5E5E5"> activity on the network</font>

113
00:04:36,919 --> 00:04:41,099
<font color="#CCCCCC">however with the endpoints you're gonna</font>

114
00:04:38,970 --> 00:04:43,860
get<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> more data a lot more insight</font>

115
00:04:41,100 --> 00:04:46,470
into what's going<font color="#E5E5E5"> on</font><font color="#CCCCCC"> monitoring</font><font color="#E5E5E5"> the</font>

116
00:04:43,860 --> 00:04:48,509
network<font color="#CCCCCC"> is is is</font><font color="#E5E5E5"> awesome and it helps</font>

117
00:04:46,470 --> 00:04:50,729
but there's fewer data<font color="#E5E5E5"> points and it's</font>

118
00:04:48,509 --> 00:04:53,820
also blinded by encryption whereas on

119
00:04:50,729 --> 00:04:56,940
the<font color="#E5E5E5"> endpoint</font><font color="#CCCCCC"> it might not be it's easier</font>

120
00:04:53,820 --> 00:04:59,539
<font color="#E5E5E5">perhaps with purpose-built security</font>

121
00:04:56,940 --> 00:05:02,760
<font color="#E5E5E5">analytics platforms on the network side</font>

122
00:04:59,539 --> 00:05:05,010
<font color="#CCCCCC">it's easier to look</font><font color="#E5E5E5"> at those data</font><font color="#CCCCCC"> points</font>

123
00:05:02,760 --> 00:05:08,310
from<font color="#E5E5E5"> a few systems</font><font color="#CCCCCC"> and it can be more</font>

124
00:05:05,010 --> 00:05:11,099
<font color="#E5E5E5">difficult on the</font><font color="#CCCCCC"> endpoints side is</font>

125
00:05:08,310 --> 00:05:13,590
<font color="#E5E5E5">getting logs from you know thousands of</font>

126
00:05:11,100 --> 00:05:15,479
systems<font color="#E5E5E5"> into a central repository</font><font color="#CCCCCC"> to be</font>

127
00:05:13,590 --> 00:05:17,969
able<font color="#E5E5E5"> to aggregate and visualize and</font>

128
00:05:15,479 --> 00:05:19,320
report on<font color="#E5E5E5"> that activity is a challenge</font>

129
00:05:17,970 --> 00:05:23,580
<font color="#E5E5E5">and that's something that Chris</font><font color="#CCCCCC"> will</font>

130
00:05:19,320 --> 00:05:26,250
talk about here<font color="#CCCCCC"> shortly so endpoint logs</font>

131
00:05:23,580 --> 00:05:27,960
<font color="#CCCCCC">exist to tell us</font><font color="#E5E5E5"> a story</font><font color="#CCCCCC"> there's a</font>

132
00:05:26,250 --> 00:05:31,740
multiple data<font color="#E5E5E5"> sources</font><font color="#CCCCCC"> that are available</font>

133
00:05:27,960 --> 00:05:33,690
<font color="#E5E5E5">to to look at with logs</font><font color="#CCCCCC"> and an endpoint</font>

134
00:05:31,740 --> 00:05:35,610
and<font color="#E5E5E5"> I'll cover some</font><font color="#CCCCCC"> of those on the next</font>

135
00:05:33,690 --> 00:05:37,889
slide<font color="#CCCCCC"> but they're</font><font color="#E5E5E5"> great</font><font color="#CCCCCC"> because it can</font>

136
00:05:35,610 --> 00:05:40,590
show us user attribution and they're

137
00:05:37,889 --> 00:05:43,860
good<font color="#E5E5E5"> for many use cases you</font><font color="#CCCCCC"> know threat</font>

138
00:05:40,590 --> 00:05:47,638
hunting<font color="#CCCCCC"> incident</font><font color="#E5E5E5"> response detection of</font>

139
00:05:43,860 --> 00:05:50,550
compromised systems<font color="#E5E5E5"> forensics</font><font color="#CCCCCC"> there's a</font>

140
00:05:47,639 --> 00:05:51,750
lot of use cases<font color="#E5E5E5"> with it so data sources</font>

141
00:05:50,550 --> 00:05:54,990
that<font color="#CCCCCC"> we can use to start understanding</font>

142
00:05:51,750 --> 00:05:56,460
<font color="#E5E5E5">what's going on on a Windows endpoint</font><font color="#CCCCCC"> I</font>

143
00:05:54,990 --> 00:05:57,900
think the one<font color="#E5E5E5"> that most people are</font>

144
00:05:56,460 --> 00:06:00,570
<font color="#CCCCCC">familiar with</font><font color="#E5E5E5"> is probably the built in</font>

145
00:05:57,900 --> 00:06:02,599
<font color="#E5E5E5">logging mechanisms so those are your</font>

146
00:06:00,570 --> 00:06:04,500
system<font color="#E5E5E5"> security application channels</font>

147
00:06:02,599 --> 00:06:06,630
<font color="#CCCCCC">things that you can see in the Event</font>

148
00:06:04,500 --> 00:06:07,919
Viewer<font color="#CCCCCC"> and those aren't</font><font color="#E5E5E5"> the only</font><font color="#CCCCCC"> ones</font>

149
00:06:06,630 --> 00:06:11,130
<font color="#CCCCCC">that are</font><font color="#E5E5E5"> built in there's there's</font><font color="#CCCCCC"> quite</font>

150
00:06:07,919 --> 00:06:13,229
a few<font color="#E5E5E5"> others but</font><font color="#CCCCCC"> with the security event</font>

151
00:06:11,130 --> 00:06:15,960
<font color="#E5E5E5">channel you can use advanced security</font>

152
00:06:13,229 --> 00:06:18,539
<font color="#E5E5E5">audit policies to help</font><font color="#CCCCCC"> more granularly</font>

153
00:06:15,960 --> 00:06:20,400
granularly<font color="#E5E5E5"> define what you want to pick</font>

154
00:06:18,539 --> 00:06:21,719
up<font color="#E5E5E5"> and there's lots of activity</font><font color="#CCCCCC"> you can</font>

155
00:06:20,400 --> 00:06:22,380
pick up with the<font color="#E5E5E5"> built-in logging</font>

156
00:06:21,720 --> 00:06:27,300
mechanisms

157
00:06:22,380 --> 00:06:29,690
log online<font color="#CCCCCC"> logoff activity you know when</font>

158
00:06:27,300 --> 00:06:31,979
new accounts are<font color="#CCCCCC"> created or deleted</font>

159
00:06:29,690 --> 00:06:34,229
policy<font color="#E5E5E5"> changes and if you're monitoring</font>

160
00:06:31,979 --> 00:06:36,690
<font color="#E5E5E5">perhaps a domain controller you</font><font color="#CCCCCC"> can look</font>

161
00:06:34,229 --> 00:06:38,219
at policy changes<font color="#E5E5E5"> across your domain</font>

162
00:06:36,690 --> 00:06:39,750
with with the<font color="#E5E5E5"> GPOs that are being</font>

163
00:06:38,219 --> 00:06:42,420
implemented

164
00:06:39,750 --> 00:06:45,000
other things that<font color="#CCCCCC"> aren't</font><font color="#E5E5E5"> listed here you</font>

165
00:06:42,420 --> 00:06:46,980
can log when shares are<font color="#E5E5E5"> being accessed</font>

166
00:06:45,000 --> 00:06:49,530
you can log when<font color="#E5E5E5"> USBs are being plugged</font>

167
00:06:46,980 --> 00:06:52,140
into a system object<font color="#CCCCCC"> access there's</font>

168
00:06:49,530 --> 00:06:53,130
there's a lot<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> things and one</font><font color="#CCCCCC"> of</font>

169
00:06:52,140 --> 00:06:54,630
the good<font color="#E5E5E5"> things with the built-in</font>

170
00:06:53,130 --> 00:06:56,640
logging mechanisms is there's a lot of

171
00:06:54,630 --> 00:07:00,240
<font color="#E5E5E5">best practices around how</font><font color="#CCCCCC"> to do that</font>

172
00:06:56,640 --> 00:07:03,390
maybe with CIS benchmarks or SCM

173
00:07:00,240 --> 00:07:05,460
benchmarks but the<font color="#CCCCCC"> built-in</font><font color="#E5E5E5"> logging</font>

174
00:07:03,390 --> 00:07:07,650
<font color="#E5E5E5">capability has a few limitations that</font>

175
00:07:05,460 --> 00:07:09,390
<font color="#CCCCCC">I'll go</font><font color="#E5E5E5"> into here shortly and if you</font>

176
00:07:07,650 --> 00:07:11,700
want to up the<font color="#CCCCCC"> game a</font><font color="#E5E5E5"> little bit and get</font>

177
00:07:09,390 --> 00:07:13,830
a deeper<font color="#CCCCCC"> level of what's</font><font color="#E5E5E5"> going on on</font>

178
00:07:11,700 --> 00:07:17,310
your<font color="#CCCCCC"> host on</font><font color="#E5E5E5"> your windows hosts you can</font>

179
00:07:13,830 --> 00:07:19,950
push out<font color="#E5E5E5"> something like</font><font color="#CCCCCC"> sis Mon that can</font>

180
00:07:17,310 --> 00:07:21,510
record<font color="#E5E5E5"> quite a bit more activity or you</font>

181
00:07:19,950 --> 00:07:23,640
can even<font color="#CCCCCC"> do something more</font><font color="#E5E5E5"> custom if you</font>

182
00:07:21,510 --> 00:07:25,230
want to<font color="#E5E5E5"> design you know alerting with</font>

183
00:07:23,640 --> 00:07:27,500
your own<font color="#CCCCCC"> PowerShell scripts you can push</font>

184
00:07:25,230 --> 00:07:30,810
events<font color="#E5E5E5"> into your own own event channels</font>

185
00:07:27,500 --> 00:07:33,810
<font color="#E5E5E5">so some</font><font color="#CCCCCC"> of the limitations</font><font color="#E5E5E5"> around</font>

186
00:07:30,810 --> 00:07:36,480
<font color="#E5E5E5">built-in</font><font color="#CCCCCC"> Windows monitoring is there</font>

187
00:07:33,810 --> 00:07:38,130
some<font color="#CCCCCC"> common attack behavior that's you</font>

188
00:07:36,480 --> 00:07:39,570
can't really pick up<font color="#E5E5E5"> with those things</font>

189
00:07:38,130 --> 00:07:42,360
like credential theft or<font color="#E5E5E5"> thread</font>

190
00:07:39,570 --> 00:07:44,040
injection<font color="#CCCCCC"> and then there's some limited</font>

191
00:07:42,360 --> 00:07:45,840
information<font color="#E5E5E5"> around process creates or</font>

192
00:07:44,040 --> 00:07:47,760
<font color="#CCCCCC">DLL loads they're definitely logs that</font>

193
00:07:45,840 --> 00:07:49,640
<font color="#CCCCCC">can</font><font color="#E5E5E5"> help track those but if you want to</font>

194
00:07:47,760 --> 00:07:54,360
<font color="#E5E5E5">look at code signing and whether the</font>

195
00:07:49,640 --> 00:07:56,130
<font color="#E5E5E5">signing is valid</font><font color="#CCCCCC"> it's not as not as</font>

196
00:07:54,360 --> 00:07:57,150
detailed<font color="#E5E5E5"> there and it's also not as</font>

197
00:07:56,130 --> 00:07:59,190
<font color="#CCCCCC">detailed on some of the network</font>

198
00:07:57,150 --> 00:08:03,510
connection information<font color="#E5E5E5"> coming</font><font color="#CCCCCC"> off of a</font>

199
00:07:59,190 --> 00:08:05,100
host<font color="#E5E5E5"> so with system on in particular</font>

200
00:08:03,510 --> 00:08:07,050
<font color="#E5E5E5">there's a lot more granular control you</font>

201
00:08:05,100 --> 00:08:12,120
can have over what you're logging<font color="#E5E5E5"> as</font>

202
00:08:07,050 --> 00:08:14,870
well so<font color="#E5E5E5"> system on what is it this bond</font>

203
00:08:12,120 --> 00:08:17,490
is a tool from<font color="#CCCCCC"> Windows sysinternals</font>

204
00:08:14,870 --> 00:08:20,880
<font color="#E5E5E5">built by mark russinovich and timers</font>

205
00:08:17,490 --> 00:08:23,100
<font color="#E5E5E5">you're near</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> runs as a Windows system</font>

206
00:08:20,880 --> 00:08:24,750
service and it also installs<font color="#E5E5E5"> the device</font>

207
00:08:23,100 --> 00:08:27,360
driver can<font color="#CCCCCC"> be used on</font><font color="#E5E5E5"> any current</font>

208
00:08:24,750 --> 00:08:29,640
supported version of<font color="#E5E5E5"> Windows</font><font color="#CCCCCC"> a very</font>

209
00:08:27,360 --> 00:08:31,170
minimal overhead<font color="#E5E5E5"> a lot of granular</font>

210
00:08:29,640 --> 00:08:33,750
control and I'll show an<font color="#E5E5E5"> example of that</font>

211
00:08:31,170 --> 00:08:35,520
<font color="#E5E5E5">here</font><font color="#CCCCCC"> shortly</font><font color="#E5E5E5"> and it monitors a wide</font>

212
00:08:33,750 --> 00:08:38,940
variety<font color="#CCCCCC"> of activity happening happening</font>

213
00:08:35,520 --> 00:08:40,799
on a system these<font color="#E5E5E5"> are</font><font color="#CCCCCC"> just a few</font><font color="#E5E5E5"> and</font>

214
00:08:38,940 --> 00:08:43,410
we'll go<font color="#E5E5E5"> into a deep details on these</font>

215
00:08:40,799 --> 00:08:47,000
here shortly<font color="#E5E5E5"> but monitors processes</font>

216
00:08:43,409 --> 00:08:51,000
network connections file creations<font color="#E5E5E5"> etc</font>

217
00:08:47,000 --> 00:08:52,230
<font color="#E5E5E5">here's an example of what a log looks</font>

218
00:08:51,000 --> 00:08:54,300
like from system on

219
00:08:52,230 --> 00:08:56,280
system on this is a process<font color="#E5E5E5"> creation</font>

220
00:08:54,300 --> 00:08:58,979
event<font color="#CCCCCC"> so</font><font color="#E5E5E5"> spawn actually sends all of its</font>

221
00:08:56,280 --> 00:09:02,130
<font color="#E5E5E5">logs about activity to its own channel</font>

222
00:08:58,980 --> 00:09:04,350
<font color="#E5E5E5">in in Windows it's on logging</font><font color="#CCCCCC"> channel</font><font color="#E5E5E5"> so</font>

223
00:09:02,130 --> 00:09:07,800
an example<font color="#CCCCCC"> with the process create you</font>

224
00:09:04,350 --> 00:09:11,190
can pick out<font color="#E5E5E5"> you know what application</font>

225
00:09:07,800 --> 00:09:12,689
<font color="#E5E5E5">started up what executable started up</font><font color="#CCCCCC"> it</font>

226
00:09:11,190 --> 00:09:14,550
<font color="#E5E5E5">records all the command-line invocation</font>

227
00:09:12,690 --> 00:09:17,100
around that process<font color="#E5E5E5"> so in this case</font>

228
00:09:14,550 --> 00:09:20,699
there's not any command-line<font color="#E5E5E5"> switches</font>

229
00:09:17,100 --> 00:09:21,930
<font color="#CCCCCC">but for other executables</font><font color="#E5E5E5"> your you'd</font>

230
00:09:20,700 --> 00:09:24,000
probably get some<font color="#CCCCCC"> command-line</font><font color="#E5E5E5"> switches</font>

231
00:09:21,930 --> 00:09:26,189
it should be<font color="#CCCCCC"> helpful to determine what</font>

232
00:09:24,000 --> 00:09:29,640
the application is is attempting to do

233
00:09:26,190 --> 00:09:32,250
you can<font color="#E5E5E5"> see the directory</font><font color="#CCCCCC"> that the</font>

234
00:09:29,640 --> 00:09:34,350
process was<font color="#CCCCCC"> started or whether where the</font>

235
00:09:32,250 --> 00:09:36,990
user was<font color="#E5E5E5"> at when the process was started</font>

236
00:09:34,350 --> 00:09:40,050
<font color="#CCCCCC">you can pick out what user perform the</font>

237
00:09:36,990 --> 00:09:42,200
activity and the integrity level<font color="#E5E5E5"> of the</font>

238
00:09:40,050 --> 00:09:44,130
<font color="#E5E5E5">process itself whether it's running with</font>

239
00:09:42,200 --> 00:09:46,560
administrative rights or it's an

240
00:09:44,130 --> 00:09:49,140
unprivileged process it can be great for

241
00:09:46,560 --> 00:09:51,959
<font color="#E5E5E5">figuring out how deep the potential</font>

242
00:09:49,140 --> 00:09:54,840
compromise<font color="#E5E5E5"> is and then you're also going</font>

243
00:09:51,960 --> 00:09:57,060
to get information<font color="#E5E5E5"> like the parent that</font>

244
00:09:54,840 --> 00:09:59,600
ended up spawning<font color="#E5E5E5"> the child process</font><font color="#CCCCCC"> and</font>

245
00:09:57,060 --> 00:10:01,890
that<font color="#E5E5E5"> can help out quite</font><font color="#CCCCCC"> a bit</font><font color="#E5E5E5"> with</font>

246
00:09:59,600 --> 00:10:05,910
determining you<font color="#E5E5E5"> know the chain of events</font>

247
00:10:01,890 --> 00:10:06,949
and and help with instant response<font color="#E5E5E5"> in</font>

248
00:10:05,910 --> 00:10:11,160
forensics

249
00:10:06,950 --> 00:10:13,400
<font color="#CCCCCC">so granular granular audit control Isis</font>

250
00:10:11,160 --> 00:10:16,469
<font color="#CCCCCC">mod can be installed in a few ways</font>

251
00:10:13,400 --> 00:10:18,270
<font color="#E5E5E5">system on with a basic install there's a</font>

252
00:10:16,470 --> 00:10:20,160
list of<font color="#CCCCCC"> things it starts tracking</font><font color="#E5E5E5"> right</font>

253
00:10:18,270 --> 00:10:21,689
off the bat without<font color="#E5E5E5"> any additional</font>

254
00:10:20,160 --> 00:10:23,969
options<font color="#E5E5E5"> and you can</font><font color="#CCCCCC"> throw in a couple</font>

255
00:10:21,690 --> 00:10:24,300
<font color="#CCCCCC">command line switches</font><font color="#E5E5E5"> to turn it on</font><font color="#CCCCCC"> or</font>

256
00:10:23,970 --> 00:10:26,520
<font color="#CCCCCC">off</font>

257
00:10:24,300 --> 00:10:28,229
other other event types but<font color="#E5E5E5"> the real</font>

258
00:10:26,520 --> 00:10:30,480
<font color="#E5E5E5">power system on is in the advanced</font>

259
00:10:28,230 --> 00:10:32,970
install with the<font color="#CCCCCC"> advanced install you</font>

260
00:10:30,480 --> 00:10:35,040
feed it a XML configuration file and

261
00:10:32,970 --> 00:10:37,380
<font color="#CCCCCC">that XML configuration file</font><font color="#E5E5E5"> defines for</font>

262
00:10:35,040 --> 00:10:40,740
each event type what you<font color="#CCCCCC"> want to either</font>

263
00:10:37,380 --> 00:10:44,030
<font color="#E5E5E5">include or exclude from being monitored</font>

264
00:10:40,740 --> 00:10:47,100
<font color="#CCCCCC">and there's a great starting point</font><font color="#E5E5E5"> from</font>

265
00:10:44,030 --> 00:10:49,470
<font color="#E5E5E5">that's on github with from Swift on</font>

266
00:10:47,100 --> 00:10:51,420
security<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it's really good because it</font>

267
00:10:49,470 --> 00:10:54,510
has a lot of<font color="#E5E5E5"> documentation on why they</font>

268
00:10:51,420 --> 00:10:56,280
turned on or off certain certain types

269
00:10:54,510 --> 00:10:58,980
of logging and and what they're looking

270
00:10:56,280 --> 00:11:01,290
<font color="#CCCCCC">for with the with those</font><font color="#E5E5E5"> events here's an</font>

271
00:10:58,980 --> 00:11:03,450
example of ample<font color="#E5E5E5"> of what granular audit</font>

272
00:11:01,290 --> 00:11:05,400
control<font color="#E5E5E5"> looks like in the XML</font>

273
00:11:03,450 --> 00:11:05,790
configuration<font color="#CCCCCC"> so in this case it's kind</font>

274
00:11:05,400 --> 00:11:09,079
<font color="#E5E5E5">of hard to</font>

275
00:11:05,790 --> 00:11:13,230
see<font color="#E5E5E5"> but this</font><font color="#CCCCCC"> is a</font><font color="#E5E5E5"> configuration around</font>

276
00:11:09,080 --> 00:11:15,510
<font color="#E5E5E5">network connection events so this is a</font>

277
00:11:13,230 --> 00:11:17,220
<font color="#E5E5E5">non match include so anything that</font><font color="#CCCCCC"> meets</font>

278
00:11:15,510 --> 00:11:20,670
the correct<font color="#E5E5E5"> any of</font><font color="#CCCCCC"> the criteria below</font>

279
00:11:17,220 --> 00:11:22,680
will be audited so there's a section

280
00:11:20,670 --> 00:11:24,750
<font color="#CCCCCC">here and</font><font color="#E5E5E5"> you can add it around you know</font>

281
00:11:22,680 --> 00:11:25,739
where the executable<font color="#E5E5E5"> underlying</font>

282
00:11:24,750 --> 00:11:27,270
executable that<font color="#E5E5E5"> makes the network</font>

283
00:11:25,740 --> 00:11:29,820
<font color="#E5E5E5">connection is launched from so if it's</font>

284
00:11:27,270 --> 00:11:33,180
in any of these directories<font color="#CCCCCC"> it's gonna</font>

285
00:11:29,820 --> 00:11:36,900
monitor the network<font color="#E5E5E5"> connections</font><font color="#CCCCCC"> or you</font>

286
00:11:33,180 --> 00:11:38,760
can track network connections from

287
00:11:36,900 --> 00:11:45,590
specific named executables like

288
00:11:38,760 --> 00:11:49,650
<font color="#E5E5E5">PowerShell</font><font color="#CCCCCC"> the net</font><font color="#E5E5E5"> exe MSHDA executable</font>

289
00:11:45,590 --> 00:11:52,500
<font color="#CCCCCC">and you can even</font><font color="#E5E5E5"> define auditing around</font>

290
00:11:49,650 --> 00:11:53,760
<font color="#E5E5E5">maybe the destination port up here for</font>

291
00:11:52,500 --> 00:11:56,880
example<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> three three eight</font><font color="#CCCCCC"> nine</font>

292
00:11:53,760 --> 00:12:00,180
so<font color="#CCCCCC"> RDP connections we'd pick</font><font color="#E5E5E5"> up all</font>

293
00:11:56,880 --> 00:12:04,470
those network connections in in logs on

294
00:12:00,180 --> 00:12:05,760
the<font color="#CCCCCC"> hosts</font><font color="#E5E5E5"> detailed tracking so I'll walk</font>

295
00:12:04,470 --> 00:12:08,340
through<font color="#CCCCCC"> a few of the things</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> be</font>

296
00:12:05,760 --> 00:12:10,170
tracked<font color="#CCCCCC"> with sis mom so the one</font><font color="#E5E5E5"> of the</font>

297
00:12:08,340 --> 00:12:13,410
real powerful ones their process events

298
00:12:10,170 --> 00:12:15,510
and that includes both<font color="#E5E5E5"> process creations</font>

299
00:12:13,410 --> 00:12:18,530
and process terminations<font color="#CCCCCC"> so you can see</font>

300
00:12:15,510 --> 00:12:20,939
how<font color="#E5E5E5"> long a process was running for and</font>

301
00:12:18,530 --> 00:12:22,980
like I<font color="#E5E5E5"> mentioned for you get full</font>

302
00:12:20,940 --> 00:12:25,680
command line<font color="#CCCCCC"> indications parent process</font>

303
00:12:22,980 --> 00:12:27,750
information<font color="#E5E5E5"> easier tribute</font><font color="#CCCCCC"> Abul</font><font color="#E5E5E5"> even get</font>

304
00:12:25,680 --> 00:12:28,800
hashes from every process that spawns so

305
00:12:27,750 --> 00:12:30,420
if you want to<font color="#E5E5E5"> take that and throw it</font>

306
00:12:28,800 --> 00:12:33,000
<font color="#E5E5E5">into virustotal to see if it's been seen</font>

307
00:12:30,420 --> 00:12:36,030
before<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> easily use that to help</font>

308
00:12:33,000 --> 00:12:39,420
help determine<font color="#E5E5E5"> whether something is</font>

309
00:12:36,030 --> 00:12:42,439
<font color="#CCCCCC">suspicious or malicious one thing</font><font color="#E5E5E5"> that</font>

310
00:12:39,420 --> 00:12:44,430
we do a lot of is defining

311
00:12:42,440 --> 00:12:47,220
suspiciousness around the parent process

312
00:12:44,430 --> 00:12:49,849
<font color="#E5E5E5">so for things like maybe SVC host or</font>

313
00:12:47,220 --> 00:12:53,550
service<font color="#CCCCCC"> see that</font><font color="#E5E5E5"> exe</font><font color="#CCCCCC"> if they have a</font>

314
00:12:49,850 --> 00:12:55,400
parent process<font color="#E5E5E5"> that's not the normal</font>

315
00:12:53,550 --> 00:12:58,770
parent<font color="#CCCCCC"> process we have alerts around</font>

316
00:12:55,400 --> 00:13:01,439
that type<font color="#CCCCCC"> of activity</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> with command</font>

317
00:12:58,770 --> 00:13:03,030
<font color="#E5E5E5">line in vacations with some of the pen</font>

318
00:13:01,440 --> 00:13:06,870
<font color="#E5E5E5">tests</font><font color="#CCCCCC"> are pen testing frameworks like</font>

319
00:13:03,030 --> 00:13:08,640
Empire<font color="#CCCCCC"> a lot of those commands you know</font>

320
00:13:06,870 --> 00:13:12,150
PowerShell runs will<font color="#E5E5E5"> have an extremely</font>

321
00:13:08,640 --> 00:13:14,300
<font color="#E5E5E5">long</font><font color="#CCCCCC"> command</font><font color="#E5E5E5"> line invocation and we use</font>

322
00:13:12,150 --> 00:13:17,069
<font color="#CCCCCC">that</font><font color="#E5E5E5"> to help out help pick out</font>

323
00:13:14,300 --> 00:13:18,640
suspicious activity

324
00:13:17,070 --> 00:13:21,399
other events

325
00:13:18,640 --> 00:13:23,079
there's Network events so this is great

326
00:13:21,399 --> 00:13:26,260
<font color="#E5E5E5">because it ties network connections back</font>

327
00:13:23,079 --> 00:13:29,109
to the process and user responsible for

328
00:13:26,260 --> 00:13:30,569
the activity<font color="#E5E5E5"> and then you can tie that</font>

329
00:13:29,110 --> 00:13:34,870
<font color="#E5E5E5">back to whether it was</font><font color="#CCCCCC"> running with</font>

330
00:13:30,570 --> 00:13:37,480
<font color="#CCCCCC">privilege rights or not it also is</font><font color="#E5E5E5"> going</font>

331
00:13:34,870 --> 00:13:39,190
<font color="#CCCCCC">to enrich the network events with</font><font color="#E5E5E5"> DNS</font>

332
00:13:37,480 --> 00:13:41,920
data so it's<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to try to</font><font color="#E5E5E5"> do a</font>

333
00:13:39,190 --> 00:13:43,690
reverse lookup to find the<font color="#CCCCCC"> host that's</font>

334
00:13:41,920 --> 00:13:46,360
that's connected to the IP address

335
00:13:43,690 --> 00:13:49,230
<font color="#E5E5E5">that's being seen and it's it's great</font>

336
00:13:46,360 --> 00:13:56,170
<font color="#CCCCCC">because it tracks UDP activity</font><font color="#E5E5E5"> TCP IP v4</font>

337
00:13:49,230 --> 00:13:58,209
ipv6 and it also does lookups on the the

338
00:13:56,170 --> 00:14:01,089
<font color="#CCCCCC">host</font><font color="#E5E5E5"> so the source host and destination</font>

339
00:13:58,209 --> 00:14:05,229
host<font color="#CCCCCC"> it's it'll pick out</font><font color="#E5E5E5"> that</font>

340
00:14:01,089 --> 00:14:07,589
information<font color="#E5E5E5"> for you thread events so one</font>

341
00:14:05,230 --> 00:14:11,200
of<font color="#E5E5E5"> the things that's nice to be able to</font>

342
00:14:07,589 --> 00:14:12,820
<font color="#E5E5E5">track with with</font><font color="#CCCCCC"> sis Mon is when one</font>

343
00:14:11,200 --> 00:14:15,820
process tries to inject code into

344
00:14:12,820 --> 00:14:18,370
another process<font color="#CCCCCC"> this can be</font><font color="#E5E5E5"> indicated an</font>

345
00:14:15,820 --> 00:14:19,630
indicator for for malware<font color="#E5E5E5"> malware might</font>

346
00:14:18,370 --> 00:14:20,620
try<font color="#E5E5E5"> to hide itself in a legitimate</font>

347
00:14:19,630 --> 00:14:26,339
<font color="#CCCCCC">process</font>

348
00:14:20,620 --> 00:14:26,339
<font color="#E5E5E5">maybe explorer.exe</font><font color="#CCCCCC"> e or or svchost.exe</font>

349
00:14:26,940 --> 00:14:31,060
<font color="#CCCCCC">there are some false positives that</font><font color="#E5E5E5"> I</font>

350
00:14:29,589 --> 00:14:33,190
think we've<font color="#E5E5E5"> seen with this but with</font>

351
00:14:31,060 --> 00:14:35,890
granular<font color="#CCCCCC"> audit</font><font color="#E5E5E5"> control you can you know</font>

352
00:14:33,190 --> 00:14:38,529
filter out some<font color="#E5E5E5"> of the common processes</font>

353
00:14:35,890 --> 00:14:43,120
that use thread<font color="#E5E5E5"> events like debuggers or</font>

354
00:14:38,529 --> 00:14:45,189
crash dump applications<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> also</font>

355
00:14:43,120 --> 00:14:49,120
picking up<font color="#E5E5E5"> raw discrete events with</font>

356
00:14:45,190 --> 00:14:52,269
system on so like in in<font color="#CCCCCC"> power sploit</font>

357
00:14:49,120 --> 00:14:54,399
there's the invoke ninja copy that is

358
00:14:52,269 --> 00:14:57,029
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> try to use a rot disk read to</font>

359
00:14:54,399 --> 00:15:00,370
gain access to files that are locked

360
00:14:57,029 --> 00:15:02,610
normally things like password databases

361
00:15:00,370 --> 00:15:05,290
like the Sam database or the<font color="#E5E5E5"> NTDs</font>

362
00:15:02,610 --> 00:15:07,870
database<font color="#CCCCCC"> in a</font><font color="#E5E5E5"> domain</font><font color="#CCCCCC"> controller</font><font color="#E5E5E5"> you can</font>

363
00:15:05,290 --> 00:15:09,689
<font color="#E5E5E5">try to use raw disk reads to gain access</font>

364
00:15:07,870 --> 00:15:13,170
to those even when they're<font color="#E5E5E5"> locked and</font>

365
00:15:09,690 --> 00:15:15,970
system on can help pick<font color="#CCCCCC"> up</font><font color="#E5E5E5"> that activity</font>

366
00:15:13,170 --> 00:15:18,640
other<font color="#E5E5E5"> events that are</font><font color="#CCCCCC"> tracked</font><font color="#E5E5E5"> with six</font>

367
00:15:15,970 --> 00:15:21,760
months<font color="#CCCCCC"> of file creations</font><font color="#E5E5E5"> or is a nice</font>

368
00:15:18,640 --> 00:15:23,949
<font color="#E5E5E5">one you can use</font><font color="#CCCCCC"> it to monitor Auto Start</font>

369
00:15:21,760 --> 00:15:25,839
locations<font color="#CCCCCC"> startup folders or the new</font>

370
00:15:23,949 --> 00:15:28,270
<font color="#CCCCCC">scheduled tasks directory to see if</font>

371
00:15:25,839 --> 00:15:31,600
anything<font color="#CCCCCC"> new is created</font><font color="#E5E5E5"> and you can also</font>

372
00:15:28,270 --> 00:15:32,050
monitor<font color="#CCCCCC"> common locations for malware a</font>

373
00:15:31,600 --> 00:15:33,519
lot of time

374
00:15:32,050 --> 00:15:35,859
<font color="#CCCCCC">malware's initially brought down maybe</font>

375
00:15:33,519 --> 00:15:38,350
to<font color="#CCCCCC"> a</font><font color="#E5E5E5"> downloads folder so you can track</font>

376
00:15:35,860 --> 00:15:40,630
file creation events<font color="#CCCCCC"> around those those</font>

377
00:15:38,350 --> 00:15:42,820
directories<font color="#E5E5E5"> things coming</font><font color="#CCCCCC"> down from the</font>

378
00:15:40,630 --> 00:15:44,620
Internet's<font color="#E5E5E5"> are actually tagged with an</font>

379
00:15:42,820 --> 00:15:47,589
alternative data stream so<font color="#CCCCCC"> that</font><font color="#E5E5E5"> name</font>

380
00:15:44,620 --> 00:15:49,540
file stream<font color="#CCCCCC"> create</font><font color="#E5E5E5"> created event</font><font color="#CCCCCC"> so you</font>

381
00:15:47,589 --> 00:15:51,670
can use alternative<font color="#E5E5E5"> data streams and the</font>

382
00:15:49,540 --> 00:15:53,740
logs around<font color="#E5E5E5"> it to determine a flat if a</font>

383
00:15:51,670 --> 00:15:54,910
file was from the<font color="#CCCCCC"> internet it's usually</font>

384
00:15:53,740 --> 00:15:57,430
tagged when it comes down<font color="#CCCCCC"> through a</font>

385
00:15:54,910 --> 00:15:59,199
browser or through<font color="#E5E5E5"> an</font><font color="#CCCCCC"> email client and</font>

386
00:15:57,430 --> 00:16:02,370
that<font color="#E5E5E5"> can help with</font><font color="#CCCCCC"> your investigations</font>

387
00:15:59,200 --> 00:16:07,050
and determining and detecting problems

388
00:16:02,370 --> 00:16:08,950
<font color="#E5E5E5">process access so a lot</font><font color="#CCCCCC"> of times</font>

389
00:16:07,050 --> 00:16:11,019
adversary might<font color="#CCCCCC"> tread it's still</font>

390
00:16:08,950 --> 00:16:13,959
<font color="#E5E5E5">credentials out of memory from</font><font color="#CCCCCC"> the L SAS</font>

391
00:16:11,019 --> 00:16:17,980
process and the process access event

392
00:16:13,959 --> 00:16:21,339
will actually cut a log<font color="#CCCCCC"> if a</font><font color="#E5E5E5"> process</font>

393
00:16:17,980 --> 00:16:23,709
tries to interact<font color="#CCCCCC"> with else ass and pull</font>

394
00:16:21,339 --> 00:16:25,959
<font color="#E5E5E5">you know data from it so that</font><font color="#CCCCCC"> it's a</font>

395
00:16:23,709 --> 00:16:28,869
great<font color="#CCCCCC"> event that that comes comes</font>

396
00:16:25,959 --> 00:16:30,790
<font color="#CCCCCC">they're monitoring</font><font color="#E5E5E5"> the registry system</font>

397
00:16:28,870 --> 00:16:33,579
on does<font color="#CCCCCC"> that as</font><font color="#E5E5E5"> well so for any key</font>

398
00:16:30,790 --> 00:16:36,219
that's created deleted<font color="#CCCCCC"> set renames</font><font color="#E5E5E5"> you</font>

399
00:16:33,579 --> 00:16:38,140
can set tracking around<font color="#E5E5E5"> it so you can</font>

400
00:16:36,220 --> 00:16:40,180
use<font color="#CCCCCC"> this to monitor</font><font color="#E5E5E5"> maybe</font><font color="#CCCCCC"> auto start</font>

401
00:16:38,140 --> 00:16:43,360
locations in the registry<font color="#E5E5E5"> that run that</font>

402
00:16:40,180 --> 00:16:47,140
<font color="#E5E5E5">run once key</font><font color="#CCCCCC"> you can also use it to</font>

403
00:16:43,360 --> 00:16:48,880
<font color="#E5E5E5">track security</font><font color="#CCCCCC"> modification so a lot of</font>

404
00:16:47,140 --> 00:16:50,829
<font color="#E5E5E5">the security controls are set in the</font>

405
00:16:48,880 --> 00:16:56,860
registry<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you can track when those</font>

406
00:16:50,829 --> 00:16:59,800
<font color="#E5E5E5">things are attempted to be modified file</font>

407
00:16:56,860 --> 00:17:02,649
<font color="#CCCCCC">time</font><font color="#E5E5E5"> stopping so file creation</font>

408
00:16:59,800 --> 00:17:05,020
modification events<font color="#CCCCCC"> if a</font><font color="#E5E5E5"> process</font>

409
00:17:02,649 --> 00:17:07,809
attempts to modify<font color="#CCCCCC"> the time create a</font>

410
00:17:05,020 --> 00:17:10,000
time on a file we can cut<font color="#E5E5E5"> logs around</font>

411
00:17:07,809 --> 00:17:15,069
<font color="#E5E5E5">that and look at that type of</font><font color="#CCCCCC"> of</font>

412
00:17:10,000 --> 00:17:17,980
<font color="#E5E5E5">activity</font><font color="#CCCCCC"> images and driver loading so</font>

413
00:17:15,069 --> 00:17:20,079
for every process<font color="#E5E5E5"> that spawned or</font><font color="#CCCCCC"> DLL</font>

414
00:17:17,980 --> 00:17:22,240
that's loaded you can<font color="#E5E5E5"> we can</font><font color="#CCCCCC"> get some</font>

415
00:17:20,079 --> 00:17:25,448
hashing information around<font color="#E5E5E5"> it and also</font>

416
00:17:22,240 --> 00:17:28,240
<font color="#E5E5E5">the code</font><font color="#CCCCCC"> signing on those those</font>

417
00:17:25,449 --> 00:17:31,419
processes<font color="#CCCCCC"> and it doesn't even validates</font>

418
00:17:28,240 --> 00:17:34,150
the the signing so you can use that to

419
00:17:31,419 --> 00:17:37,000
maybe filter out benign processes<font color="#E5E5E5"> based</font>

420
00:17:34,150 --> 00:17:38,559
on that information<font color="#E5E5E5"> I haven't</font><font color="#CCCCCC"> used pipe</font>

421
00:17:37,000 --> 00:17:40,030
events too much but it also records

422
00:17:38,559 --> 00:17:42,910
<font color="#E5E5E5">information</font><font color="#CCCCCC"> on inter process</font>

423
00:17:40,030 --> 00:17:44,610
communication<font color="#CCCCCC"> events</font><font color="#E5E5E5"> and it records</font>

424
00:17:42,910 --> 00:17:47,220
<font color="#CCCCCC">information on WMI as well</font>

425
00:17:44,610 --> 00:17:50,189
so you can use<font color="#CCCCCC"> WMI to establish</font>

426
00:17:47,220 --> 00:17:53,480
persistence and<font color="#CCCCCC"> sis</font><font color="#E5E5E5"> Mon can be used to</font>

427
00:17:50,190 --> 00:17:55,710
<font color="#CCCCCC">attract</font><font color="#E5E5E5"> that that attempt at persistence</font>

428
00:17:53,480 --> 00:17:59,190
<font color="#CCCCCC">so this is all well and good</font><font color="#E5E5E5"> maybe on a</font>

429
00:17:55,710 --> 00:18:00,659
singular<font color="#CCCCCC"> system but an enterprise scale</font>

430
00:17:59,190 --> 00:18:03,029
<font color="#E5E5E5">we need</font><font color="#CCCCCC"> to be able to</font><font color="#E5E5E5"> look at many</font>

431
00:18:00,659 --> 00:18:05,100
systems at the<font color="#E5E5E5"> same time and track</font>

432
00:18:03,029 --> 00:18:06,539
activity between<font color="#E5E5E5"> them so some of the</font>

433
00:18:05,100 --> 00:18:08,908
things<font color="#CCCCCC"> that you may</font><font color="#E5E5E5"> want to do you know</font>

434
00:18:06,539 --> 00:18:11,340
<font color="#CCCCCC">cross enterprise and tracking bits</font>

435
00:18:08,909 --> 00:18:14,370
<font color="#E5E5E5">endpoint activity is do we see systems</font>

436
00:18:11,340 --> 00:18:16,289
<font color="#CCCCCC">talking to each other that may not need</font>

437
00:18:14,370 --> 00:18:19,709
to<font color="#CCCCCC"> talk to each other maybe pass the</font>

438
00:18:16,289 --> 00:18:23,399
hash<font color="#E5E5E5"> techniques between systems</font>

439
00:18:19,710 --> 00:18:24,960
<font color="#E5E5E5">if logs are deleted or they roll</font><font color="#CCCCCC"> over</font>

440
00:18:23,399 --> 00:18:27,299
we're<font color="#E5E5E5"> gonna need you know the logging</font>

441
00:18:24,960 --> 00:18:29,820
information<font color="#CCCCCC"> to a central repository in</font>

442
00:18:27,299 --> 00:18:31,830
order to do analysis<font color="#E5E5E5"> even if the</font>

443
00:18:29,820 --> 00:18:34,559
<font color="#CCCCCC">system's</font><font color="#E5E5E5"> offline or the logs are not</font>

444
00:18:31,830 --> 00:18:37,939
available<font color="#E5E5E5"> for some reason and with</font>

445
00:18:34,559 --> 00:18:39,779
average<font color="#E5E5E5"> breach detection x' being such</font>

446
00:18:37,940 --> 00:18:42,720
you know<font color="#E5E5E5"> it takes a long</font><font color="#CCCCCC"> time to</font>

447
00:18:39,779 --> 00:18:45,450
<font color="#E5E5E5">discover</font><font color="#CCCCCC"> a breach we need to have logs</font>

448
00:18:42,720 --> 00:18:46,919
available for a long period of time<font color="#E5E5E5"> the</font>

449
00:18:45,450 --> 00:18:50,190
average breach detection is about a

450
00:18:46,919 --> 00:18:53,820
hundred<font color="#E5E5E5"> plus days and so we need we need</font>

451
00:18:50,190 --> 00:18:55,980
some a good duration of logs that<font color="#E5E5E5"> we</font>

452
00:18:53,820 --> 00:18:57,809
have<font color="#E5E5E5"> stored up and we also need to</font>

453
00:18:55,980 --> 00:19:01,500
<font color="#CCCCCC">aggregate and analyze behavior</font><font color="#E5E5E5"> across</font>

454
00:18:57,809 --> 00:19:03,629
the entire footprint<font color="#E5E5E5"> so what can help</font>

455
00:19:01,500 --> 00:19:04,350
here is a log management<font color="#E5E5E5"> system or a sim</font>

456
00:19:03,630 --> 00:19:07,799
solution

457
00:19:04,350 --> 00:19:10,129
Splunk curator our logarithm<font color="#CCCCCC"> arcsight</font><font color="#E5E5E5"> in</font>

458
00:19:07,799 --> 00:19:12,330
our case we deployed an elastic stack

459
00:19:10,130 --> 00:19:15,000
<font color="#CCCCCC">implementation and</font><font color="#E5E5E5"> I'm actually going to</font>

460
00:19:12,330 --> 00:19:16,230
<font color="#E5E5E5">turn it over to Chris</font><font color="#CCCCCC"> and let him talk</font>

461
00:19:15,000 --> 00:19:18,389
about<font color="#CCCCCC"> what we've done</font><font color="#E5E5E5"> there and how</font>

462
00:19:16,230 --> 00:19:21,440
elastic stack<font color="#E5E5E5"> can</font><font color="#CCCCCC"> be used to monitor</font>

463
00:19:18,389 --> 00:19:21,439
<font color="#E5E5E5">endpoints on scale</font>

464
00:19:37,330 --> 00:19:43,428
so just a<font color="#CCCCCC"> little bit about</font><font color="#E5E5E5"> myself I've</font>

465
00:19:40,009 --> 00:19:44,149
been with<font color="#E5E5E5"> Salt Lake County more</font><font color="#CCCCCC"> than</font><font color="#E5E5E5"> 20</font>

466
00:19:43,429 --> 00:19:46,700
years<font color="#CCCCCC"> now</font>

467
00:19:44,149 --> 00:19:49,879
I've<font color="#E5E5E5"> been on the security team</font><font color="#CCCCCC"> for about</font>

468
00:19:46,700 --> 00:19:52,940
<font color="#E5E5E5">eight</font><font color="#CCCCCC"> years and most of my</font><font color="#E5E5E5"> life has</font><font color="#CCCCCC"> been</font>

469
00:19:49,879 --> 00:19:54,619
<font color="#CCCCCC">Blue Team stuff I'm starting to get</font><font color="#E5E5E5"> into</font>

470
00:19:52,940 --> 00:19:56,029
<font color="#CCCCCC">some of</font><font color="#E5E5E5"> the red</font><font color="#CCCCCC"> team stuff and and</font>

471
00:19:54,619 --> 00:20:00,559
John's kind<font color="#E5E5E5"> of helping me</font><font color="#CCCCCC"> in that</font>

472
00:19:56,029 --> 00:20:03,970
direction but I'm a so we make a few

473
00:20:00,559 --> 00:20:07,580
assumptions in<font color="#E5E5E5"> our in our presentation</font>

474
00:20:03,970 --> 00:20:11,210
<font color="#E5E5E5">you we're using elastic stack as you saw</font>

475
00:20:07,580 --> 00:20:13,489
in the previous slide<font color="#CCCCCC"> you know if you've</font>

476
00:20:11,210 --> 00:20:17,210
<font color="#E5E5E5">got a logging system you can pull system</font>

477
00:20:13,489 --> 00:20:19,729
<font color="#E5E5E5">on logs into your system you can do a</font>

478
00:20:17,210 --> 00:20:21,919
lot<font color="#CCCCCC"> of the same things we're doing</font><font color="#E5E5E5"> and</font>

479
00:20:19,729 --> 00:20:24,830
not have to go the direction<font color="#E5E5E5"> we did we</font>

480
00:20:21,919 --> 00:20:26,869
<font color="#E5E5E5">went this direction</font><font color="#CCCCCC"> because we don't</font>

481
00:20:24,830 --> 00:20:30,830
have<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> money right elastic was</font>

482
00:20:26,869 --> 00:20:35,119
free system on was free<font color="#CCCCCC"> we went</font><font color="#E5E5E5"> through</font>

483
00:20:30,830 --> 00:20:36,949
<font color="#E5E5E5">a lot of different</font><font color="#CCCCCC"> endpoint monitoring</font>

484
00:20:35,119 --> 00:20:40,789
systems and we just simply<font color="#CCCCCC"> couldn't</font>

485
00:20:36,950 --> 00:20:44,269
<font color="#E5E5E5">afford the ones we liked so we went this</font>

486
00:20:40,789 --> 00:20:47,599
way mostly<font color="#E5E5E5"> because it was</font><font color="#CCCCCC"> the path least</font>

487
00:20:44,269 --> 00:20:48,919
resistance it was<font color="#E5E5E5"> easiest</font><font color="#CCCCCC"> for us but</font><font color="#E5E5E5"> you</font>

488
00:20:47,599 --> 00:20:51,168
couldn't<font color="#CCCCCC"> implement a lot of these</font><font color="#E5E5E5"> things</font>

489
00:20:48,919 --> 00:20:52,970
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> if you've got your own logging</font>

490
00:20:51,169 --> 00:20:54,440
system in place if you've got<font color="#CCCCCC"> Splunk or</font>

491
00:20:52,970 --> 00:20:56,950
something<font color="#E5E5E5"> like</font><font color="#CCCCCC"> that it</font><font color="#E5E5E5"> would</font><font color="#CCCCCC"> be really</font>

492
00:20:54,440 --> 00:20:56,950
<font color="#CCCCCC">pretty easy</font>

493
00:21:04,290 --> 00:21:09,389
so I'm<font color="#E5E5E5"> assuming people have heard of</font>

494
00:21:06,780 --> 00:21:12,540
elastic stack and and some<font color="#E5E5E5"> people may</font>

495
00:21:09,390 --> 00:21:15,240
have<font color="#E5E5E5"> already have elastic stack running</font>

496
00:21:12,540 --> 00:21:21,330
<font color="#CCCCCC">in their environment</font><font color="#E5E5E5"> and know quite a</font>

497
00:21:15,240 --> 00:21:22,950
<font color="#CCCCCC">bit about it this slide just gives kind</font>

498
00:21:21,330 --> 00:21:25,530
of<font color="#E5E5E5"> a basic overview of the architecture</font>

499
00:21:22,950 --> 00:21:30,780
<font color="#CCCCCC">so on the left side there you've got the</font>

500
00:21:25,530 --> 00:21:33,480
endpoints with syslog and elastic uses

501
00:21:30,780 --> 00:21:35,790
to collect syslog<font color="#E5E5E5"> we're using what's</font>

502
00:21:33,480 --> 00:21:40,020
called<font color="#CCCCCC"> wind log beats</font><font color="#E5E5E5"> which is the</font>

503
00:21:35,790 --> 00:21:42,060
<font color="#CCCCCC">client-side data collection that</font><font color="#E5E5E5"> elastic</font>

504
00:21:40,020 --> 00:21:45,410
stack uses so then you get<font color="#E5E5E5"> over to the</font>

505
00:21:42,060 --> 00:21:51,690
<font color="#CCCCCC">server-side</font><font color="#E5E5E5"> components where you've got</font>

506
00:21:45,410 --> 00:21:53,940
<font color="#CCCCCC">logs - wind log beats and logs - have</font>

507
00:21:51,690 --> 00:21:55,950
some similar components and you can

508
00:21:53,940 --> 00:21:57,480
decide based on<font color="#E5E5E5"> your</font><font color="#CCCCCC"> environment that</font>

509
00:21:55,950 --> 00:22:00,240
<font color="#E5E5E5">you know how that's gonna work</font><font color="#CCCCCC"> for you</font>

510
00:21:57,480 --> 00:22:03,000
we<font color="#E5E5E5"> we tried to do most everything on the</font>

511
00:22:00,240 --> 00:22:04,800
<font color="#CCCCCC">endpoint</font><font color="#E5E5E5"> so you know we weren't really</font>

512
00:22:03,000 --> 00:22:09,540
<font color="#CCCCCC">sure how it was gonna affect</font><font color="#E5E5E5"> our server</font>

513
00:22:04,800 --> 00:22:11,340
environment<font color="#E5E5E5"> or you know what kind of you</font>

514
00:22:09,540 --> 00:22:12,720
<font color="#E5E5E5">know how much data how much traffic</font><font color="#CCCCCC"> we</font>

515
00:22:11,340 --> 00:22:17,159
were gonna be ingesting because<font color="#E5E5E5"> we've</font>

516
00:22:12,720 --> 00:22:20,010
<font color="#E5E5E5">never done it before</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> with wind log</font>

517
00:22:17,160 --> 00:22:25,230
beats<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> we we define where it's</font>

518
00:22:20,010 --> 00:22:27,900
going<font color="#E5E5E5"> to ship its data to we also</font><font color="#CCCCCC"> tag</font>

519
00:22:25,230 --> 00:22:29,700
certain things<font color="#CCCCCC"> at that level</font><font color="#E5E5E5"> so if it's</font>

520
00:22:27,900 --> 00:22:32,790
a server we're monitoring<font color="#E5E5E5"> we tag it</font><font color="#CCCCCC"> as a</font>

521
00:22:29,700 --> 00:22:35,250
server so<font color="#CCCCCC"> that we can search it easier</font>

522
00:22:32,790 --> 00:22:36,870
<font color="#E5E5E5">and pull out server events and and weed</font>

523
00:22:35,250 --> 00:22:39,840
them out from workstation<font color="#E5E5E5"> and then point</font>

524
00:22:36,870 --> 00:22:42,149
events<font color="#E5E5E5"> you know then you've got your</font>

525
00:22:39,840 --> 00:22:45,060
your<font color="#E5E5E5"> elastic search where all the data</font>

526
00:22:42,150 --> 00:22:46,260
<font color="#E5E5E5">is is indexed and stored and you've got</font>

527
00:22:45,060 --> 00:22:48,480
finally<font color="#CCCCCC"> Kabana</font>

528
00:22:46,260 --> 00:22:50,310
which is where you know you can

529
00:22:48,480 --> 00:22:53,010
visualize the data<font color="#E5E5E5"> and create your</font>

530
00:22:50,310 --> 00:22:55,770
dashboards<font color="#E5E5E5"> and you know dashboards are</font>

531
00:22:53,010 --> 00:22:58,020
all the rage lately all your c-level

532
00:22:55,770 --> 00:23:04,379
folks love to see a good dashboard and

533
00:22:58,020 --> 00:23:08,730
<font color="#CCCCCC">kibana helps a lot with</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> I talked</font>

534
00:23:04,380 --> 00:23:12,050
about<font color="#E5E5E5"> wind log beats briefly see if</font>

535
00:23:08,730 --> 00:23:12,050
there's anything I wanted<font color="#E5E5E5"> to add to</font><font color="#CCCCCC"> that</font>

536
00:23:13,640 --> 00:23:21,420
we have a you<font color="#E5E5E5"> know wind</font><font color="#CCCCCC"> log beat uses a</font>

537
00:23:16,700 --> 00:23:26,490
<font color="#E5E5E5">Yama file for its configuration</font><font color="#CCCCCC"> and we</font>

538
00:23:21,420 --> 00:23:27,870
have an<font color="#CCCCCC"> endpoint what do you call it</font><font color="#E5E5E5"> not</font>

539
00:23:26,490 --> 00:23:30,030
monitoring that's what I want to say

540
00:23:27,870 --> 00:23:32,520
it's so we have endpoint management

541
00:23:30,030 --> 00:23:34,740
where we can push those configuration

542
00:23:32,520 --> 00:23:36,720
files out periodically to<font color="#CCCCCC"> make</font><font color="#E5E5E5"> sure they</font>

543
00:23:34,740 --> 00:23:39,210
have the most up-to-date configuration

544
00:23:36,720 --> 00:23:45,300
if we<font color="#E5E5E5"> happen to change everything or</font>

545
00:23:39,210 --> 00:23:47,430
anything<font color="#E5E5E5"> we use the win log beat to help</font>

546
00:23:45,300 --> 00:23:49,440
load<font color="#E5E5E5"> balance we define the backend</font><font color="#CCCCCC"> you</font>

547
00:23:47,430 --> 00:23:54,600
<font color="#CCCCCC">know at the client</font><font color="#E5E5E5"> so it knows where to</font>

548
00:23:49,440 --> 00:24:00,600
put it<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then log stashes the server</font>

549
00:23:54,600 --> 00:24:02,909
<font color="#CCCCCC">side log aggregator</font><font color="#E5E5E5"> so we're</font><font color="#CCCCCC"> talking</font>

550
00:24:00,600 --> 00:24:05,189
<font color="#E5E5E5">about just system on here but in terms</font>

551
00:24:02,910 --> 00:24:06,780
<font color="#E5E5E5">of normalizing data you know you can</font>

552
00:24:05,190 --> 00:24:08,100
<font color="#E5E5E5">collect a lot of</font><font color="#CCCCCC"> different logs with</font>

553
00:24:06,780 --> 00:24:10,980
this and you<font color="#E5E5E5"> can go in a lot</font><font color="#CCCCCC"> of</font>

554
00:24:08,100 --> 00:24:12,959
<font color="#E5E5E5">different directions and we have but you</font>

555
00:24:10,980 --> 00:24:15,360
<font color="#E5E5E5">can help normalize those fields if</font>

556
00:24:12,960 --> 00:24:17,580
they're<font color="#E5E5E5"> not the same in each kind of</font>

557
00:24:15,360 --> 00:24:19,770
logs<font color="#E5E5E5"> that you're trying to pull if the</font>

558
00:24:17,580 --> 00:24:23,970
the IP address isn't<font color="#CCCCCC"> in the same field</font>

559
00:24:19,770 --> 00:24:26,100
is from<font color="#E5E5E5"> one system to the other</font>

560
00:24:23,970 --> 00:24:29,220
<font color="#CCCCCC">you might normalize those things</font><font color="#E5E5E5"> in log</font>

561
00:24:26,100 --> 00:24:34,050
stash so that you can search that data

562
00:24:29,220 --> 00:24:38,490
<font color="#CCCCCC">easily and then the storage end of it is</font>

563
00:24:34,050 --> 00:24:43,379
the elastic<font color="#E5E5E5"> search does all the things</font>

564
00:24:38,490 --> 00:24:45,090
that<font color="#E5E5E5"> we've</font><font color="#CCCCCC"> got there it's where you want</font>

565
00:24:43,380 --> 00:24:54,420
to keep track<font color="#CCCCCC"> of your data retention as</font>

566
00:24:45,090 --> 00:24:56,280
well and then<font color="#CCCCCC"> Kabana is where we you</font>

567
00:24:54,420 --> 00:24:58,530
know<font color="#E5E5E5"> analyze and visualize this</font><font color="#CCCCCC"> we can</font>

568
00:24:56,280 --> 00:25:00,090
pull out and you can build<font color="#E5E5E5"> queries and</font>

569
00:24:58,530 --> 00:25:03,889
and make dashboards that<font color="#E5E5E5"> show you</font>

570
00:25:00,090 --> 00:25:06,120
<font color="#E5E5E5">instantly what</font><font color="#CCCCCC"> it sees with those and</font>

571
00:25:03,890 --> 00:25:09,960
<font color="#E5E5E5">you know how well you can see this this</font>

572
00:25:06,120 --> 00:25:13,139
is<font color="#E5E5E5"> this is a basic</font><font color="#CCCCCC"> Cabana dashboard</font>

573
00:25:09,960 --> 00:25:16,580
you know the count of system on event

574
00:25:13,140 --> 00:25:18,990
counts and<font color="#E5E5E5"> then the second one from the</font>

575
00:25:16,580 --> 00:25:21,240
on the top<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are second from left</font>

576
00:25:18,990 --> 00:25:23,250
shows you the system<font color="#CCCCCC"> on event types</font>

577
00:25:21,240 --> 00:25:25,299
right<font color="#E5E5E5"> there's a bunch of different event</font>

578
00:25:23,250 --> 00:25:27,720
types

579
00:25:25,299 --> 00:25:29,769
<font color="#E5E5E5">it can break him</font><font color="#CCCCCC"> down by that and then</font>

580
00:25:27,720 --> 00:25:33,129
you know the dashboards<font color="#E5E5E5"> you're going to</font>

581
00:25:29,769 --> 00:25:34,690
be creating for for consumption<font color="#E5E5E5"> by</font>

582
00:25:33,129 --> 00:25:36,418
<font color="#E5E5E5">c-level executives it's going to be</font>

583
00:25:34,690 --> 00:25:38,409
quite a bit<font color="#CCCCCC"> different than what you</font>

584
00:25:36,419 --> 00:25:40,269
create for yourself<font color="#CCCCCC"> when you're</font>

585
00:25:38,409 --> 00:25:42,190
monitoring<font color="#E5E5E5"> your systems we use</font><font color="#CCCCCC"> a lot of</font>

586
00:25:40,269 --> 00:25:43,480
<font color="#E5E5E5">tables</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know we</font><font color="#CCCCCC"> just like to see the</font>

587
00:25:42,190 --> 00:25:54,759
raw data

588
00:25:43,480 --> 00:25:56,139
how many who those kinds of things<font color="#E5E5E5"> try</font>

589
00:25:54,759 --> 00:25:57,789
to give an example<font color="#E5E5E5"> probably the easiest</font>

590
00:25:56,139 --> 00:26:00,039
ones<font color="#E5E5E5"> to give are that are the</font><font color="#CCCCCC"> phishing</font>

591
00:25:57,789 --> 00:26:02,980
problems we have<font color="#CCCCCC"> right I don't know what</font>

592
00:26:00,039 --> 00:26:04,600
<font color="#CCCCCC">your users</font><font color="#E5E5E5"> are like but ours will click</font>

593
00:26:02,980 --> 00:26:06,070
on anything and<font color="#E5E5E5"> we and we've discovered</font>

594
00:26:04,600 --> 00:26:07,928
<font color="#CCCCCC">that we have about</font><font color="#E5E5E5"> 10</font><font color="#CCCCCC"> minutes between</font>

595
00:26:06,070 --> 00:26:13,299
<font color="#E5E5E5">the time the email gets in to the time</font>

596
00:26:07,929 --> 00:26:15,039
they're clicking<font color="#E5E5E5"> on the links so system</font>

597
00:26:13,299 --> 00:26:18,340
on an elastic stack has really helped<font color="#E5E5E5"> us</font>

598
00:26:15,039 --> 00:26:19,919
go back once<font color="#E5E5E5"> we find out that you know</font>

599
00:26:18,340 --> 00:26:22,449
<font color="#E5E5E5">people have received a phishing</font><font color="#CCCCCC"> email</font>

600
00:26:19,919 --> 00:26:25,840
<font color="#E5E5E5">within very little time less than half</font>

601
00:26:22,450 --> 00:26:28,480
an hour we<font color="#E5E5E5"> can figure out who got the</font>

602
00:26:25,840 --> 00:26:30,609
email<font color="#E5E5E5"> who clicked the link</font><font color="#CCCCCC"> and in</font>

603
00:26:28,480 --> 00:26:34,299
certain<font color="#CCCCCC"> cases we can even go along and</font>

604
00:26:30,609 --> 00:26:36,668
<font color="#E5E5E5">we can say all</font><font color="#CCCCCC"> right after</font><font color="#E5E5E5"> the person</font>

605
00:26:34,299 --> 00:26:38,950
enters credentials<font color="#E5E5E5"> into this site where</font>

606
00:26:36,669 --> 00:26:40,570
does that<font color="#E5E5E5"> site redirect them so you can</font>

607
00:26:38,950 --> 00:26:44,440
look<font color="#E5E5E5"> at something and you can say</font><font color="#CCCCCC"> okay</font>

608
00:26:40,570 --> 00:26:48,100
<font color="#E5E5E5">person</font><font color="#CCCCCC"> X went to the site we can</font><font color="#E5E5E5"> see</font>

609
00:26:44,440 --> 00:26:49,690
<font color="#CCCCCC">that person y&z not only went to</font><font color="#E5E5E5"> the</font>

610
00:26:48,100 --> 00:26:51,908
site but<font color="#CCCCCC"> I can see</font><font color="#E5E5E5"> that they were</font>

611
00:26:49,690 --> 00:26:54,009
redirected to the site<font color="#CCCCCC"> after they put in</font>

612
00:26:51,909 --> 00:26:55,960
their credentials so I can with quite a

613
00:26:54,009 --> 00:26:58,779
bit<font color="#CCCCCC"> of</font><font color="#E5E5E5"> certainty</font><font color="#CCCCCC"> say that you know</font>

614
00:26:55,960 --> 00:27:02,619
person y&z entered their credentials<font color="#E5E5E5"> in</font>

615
00:26:58,779 --> 00:27:04,779
person X just<font color="#E5E5E5"> visited the site so what</font>

616
00:27:02,619 --> 00:27:06,939
that's done for us is far in terms of

617
00:27:04,779 --> 00:27:08,710
<font color="#E5E5E5">incident response is we don't have</font><font color="#CCCCCC"> to</font>

618
00:27:06,940 --> 00:27:11,169
rely<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> end user</font><font color="#CCCCCC"> anymore in their</font>

619
00:27:08,710 --> 00:27:16,179
<font color="#E5E5E5">self-report which was a horrible way</font><font color="#CCCCCC"> to</font>

620
00:27:11,169 --> 00:27:17,679
<font color="#E5E5E5">go to begin with we can see what's</font><font color="#CCCCCC"> going</font>

621
00:27:16,179 --> 00:27:19,690
on<font color="#E5E5E5"> in their computer we know more</font><font color="#CCCCCC"> about</font>

622
00:27:17,679 --> 00:27:23,200
<font color="#E5E5E5">what they're</font><font color="#CCCCCC"> doing then</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> often times</font>

623
00:27:19,690 --> 00:27:25,809
more than they do<font color="#E5E5E5"> and so it's really cut</font>

624
00:27:23,200 --> 00:27:28,539
the<font color="#E5E5E5"> time</font><font color="#CCCCCC"> down for us we can get ahead of</font>

625
00:27:25,809 --> 00:27:31,239
<font color="#E5E5E5">these things we</font><font color="#CCCCCC"> don't find out about</font>

626
00:27:28,539 --> 00:27:33,279
account<font color="#E5E5E5"> compromised when someone's used</font>

627
00:27:31,239 --> 00:27:36,070
our system to send<font color="#E5E5E5"> emails out we found</font>

628
00:27:33,279 --> 00:27:36,909
<font color="#CCCCCC">out about</font><font color="#E5E5E5"> it much quicker and</font><font color="#CCCCCC"> we can do</font>

629
00:27:36,070 --> 00:27:45,039
something<font color="#CCCCCC"> about</font><font color="#E5E5E5"> it much</font>

630
00:27:36,909 --> 00:27:50,169
quicker<font color="#CCCCCC"> again</font><font color="#E5E5E5"> so this this jumps to</font>

631
00:27:45,039 --> 00:27:52,769
alerting<font color="#CCCCCC"> we</font><font color="#E5E5E5"> decided on a last</font><font color="#CCCCCC"> alert</font>

632
00:27:50,169 --> 00:27:55,090
mostly for the same reason<font color="#E5E5E5"> we decided</font><font color="#CCCCCC"> on</font>

633
00:27:52,769 --> 00:27:56,349
elastic stack<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> because it was free</font>

634
00:27:55,090 --> 00:28:01,330
<font color="#CCCCCC">it was</font><font color="#E5E5E5"> something we could add in and</font>

635
00:27:56,349 --> 00:28:05,249
implement<font color="#E5E5E5"> pretty easily</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> see some</font>

636
00:28:01,330 --> 00:28:05,249
of<font color="#E5E5E5"> the rule types there and you can see</font>

637
00:28:07,259 --> 00:28:12,639
this helps you get ahead<font color="#E5E5E5"> of events right</font>

638
00:28:10,299 --> 00:28:15,429
<font color="#CCCCCC">now you're being alerted to</font><font color="#E5E5E5"> things that</font>

639
00:28:12,639 --> 00:28:16,809
<font color="#E5E5E5">are happening on your network</font><font color="#CCCCCC"> and you're</font>

640
00:28:15,429 --> 00:28:18,669
not having<font color="#CCCCCC"> to</font><font color="#E5E5E5"> wait for someone to tell</font>

641
00:28:16,809 --> 00:28:19,899
you<font color="#E5E5E5"> that they may have clicked on</font>

642
00:28:18,669 --> 00:28:21,940
something<font color="#E5E5E5"> or they may have seen</font>

643
00:28:19,899 --> 00:28:24,939
something<font color="#E5E5E5"> weird</font><font color="#CCCCCC"> you can see a lot of</font>

644
00:28:21,940 --> 00:28:27,399
<font color="#E5E5E5">this stuff right</font><font color="#CCCCCC"> up front</font><font color="#E5E5E5"> and I've got</font>

645
00:28:24,940 --> 00:28:33,549
some examples<font color="#E5E5E5"> of some of the alerts here</font>

646
00:28:27,399 --> 00:28:36,449
<font color="#E5E5E5">in a few slides</font><font color="#CCCCCC"> the other thing we</font>

647
00:28:33,549 --> 00:28:38,830
discovered<font color="#E5E5E5"> when we implemented this was</font>

648
00:28:36,450 --> 00:28:40,479
we were<font color="#E5E5E5"> able</font><font color="#CCCCCC"> to tune quite a bit of</font>

649
00:28:38,830 --> 00:28:42,369
stuff on<font color="#E5E5E5"> our network there's a lot of</font>

650
00:28:40,479 --> 00:28:45,220
things that<font color="#E5E5E5"> are going on that nobody has</font>

651
00:28:42,369 --> 00:28:47,820
any idea<font color="#E5E5E5"> they're happening until</font><font color="#CCCCCC"> someone</font>

652
00:28:45,220 --> 00:28:49,599
starts<font color="#E5E5E5"> looking at the logs</font><font color="#CCCCCC"> you know</font>

653
00:28:47,820 --> 00:28:52,479
<font color="#E5E5E5">servers doing certain things</font>

654
00:28:49,599 --> 00:28:54,220
communicating in certain ways<font color="#E5E5E5"> and you</font>

655
00:28:52,479 --> 00:28:58,389
just start<font color="#CCCCCC"> asking why and we've been</font>

656
00:28:54,220 --> 00:29:01,359
able to dramatically tune quite a bit of

657
00:28:58,389 --> 00:29:04,928
the noise out<font color="#CCCCCC"> of our network</font><font color="#E5E5E5"> with just</font>

658
00:29:01,359 --> 00:29:08,499
by monitoring endpoints and servers<font color="#E5E5E5"> with</font>

659
00:29:04,929 --> 00:29:11,729
<font color="#E5E5E5">sis</font><font color="#CCCCCC"> Mon you know we've tailored</font><font color="#E5E5E5"> this so</font>

660
00:29:08,499 --> 00:29:15,149
that we just see<font color="#E5E5E5"> security alerting but</font>

661
00:29:11,729 --> 00:29:17,440
you know if you're more interested<font color="#CCCCCC"> in in</font>

662
00:29:15,149 --> 00:29:19,268
performance on your network<font color="#CCCCCC"> you can</font>

663
00:29:17,440 --> 00:29:22,119
really tailor some<font color="#E5E5E5"> of these alerts and</font>

664
00:29:19,269 --> 00:29:24,609
some of these<font color="#E5E5E5"> dashboards to show you</font>

665
00:29:22,119 --> 00:29:26,559
performance<font color="#CCCCCC"> and to see why things</font><font color="#E5E5E5"> are</font>

666
00:29:24,609 --> 00:29:29,759
acting the<font color="#CCCCCC"> way they are it's really been</font>

667
00:29:26,559 --> 00:29:29,759
a<font color="#CCCCCC"> very useful tool</font>

668
00:29:34,200 --> 00:29:43,390
this is an example of one<font color="#CCCCCC"> of the email</font>

669
00:29:37,659 --> 00:29:45,970
alerts that<font color="#E5E5E5"> come</font><font color="#CCCCCC"> to us so it's</font><font color="#E5E5E5"> really</font>

670
00:29:43,390 --> 00:29:49,870
only probably a<font color="#E5E5E5"> couple of minutes after</font>

671
00:29:45,970 --> 00:29:52,120
<font color="#E5E5E5">the events happen</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> elastic and it</font>

672
00:29:49,870 --> 00:29:55,539
ingests it that we get an alert<font color="#E5E5E5"> so it</font>

673
00:29:52,120 --> 00:29:57,100
<font color="#E5E5E5">turns around pretty quick</font><font color="#CCCCCC"> the other</font>

674
00:29:55,539 --> 00:29:59,679
<font color="#CCCCCC">thing I wanted to</font><font color="#E5E5E5"> mention about elastic</font>

675
00:29:57,100 --> 00:30:02,549
is<font color="#CCCCCC"> once we got this</font><font color="#E5E5E5"> running in full</font>

676
00:29:59,679 --> 00:30:07,000
<font color="#CCCCCC">production we found out that the</font>

677
00:30:02,549 --> 00:30:08,408
shipping the system on logs<font color="#E5E5E5"> and pulling</font>

678
00:30:07,000 --> 00:30:10,899
all the logs that we're<font color="#E5E5E5"> pulling really</font>

679
00:30:08,409 --> 00:30:12,820
had a very small<font color="#E5E5E5"> footprint it didn't</font>

680
00:30:10,899 --> 00:30:14,678
even show up on<font color="#CCCCCC"> our</font><font color="#E5E5E5"> top</font><font color="#CCCCCC"> 10 list</font><font color="#E5E5E5"> of</font>

681
00:30:12,820 --> 00:30:18,100
things that were<font color="#E5E5E5"> traversing our network</font>

682
00:30:14,679 --> 00:30:24,549
<font color="#E5E5E5">so it was really a nice solution that</font>

683
00:30:18,100 --> 00:30:27,299
didn't cause a lot<font color="#E5E5E5"> of kind of angst for</font>

684
00:30:24,549 --> 00:30:27,299
<font color="#E5E5E5">our network</font><font color="#CCCCCC"> people</font>

685
00:30:30,680 --> 00:30:38,930
so now that<font color="#E5E5E5"> we've talked about elastic</font>

686
00:30:34,310 --> 00:30:40,460
alert or last<font color="#E5E5E5"> alert we can start</font>

687
00:30:38,930 --> 00:30:41,600
thinking about<font color="#E5E5E5"> what</font><font color="#CCCCCC"> kind of</font><font color="#E5E5E5"> things do</font><font color="#CCCCCC"> we</font>

688
00:30:40,460 --> 00:30:42,830
want to be<font color="#E5E5E5"> alerted on what kind of</font>

689
00:30:41,600 --> 00:30:47,480
things do<font color="#E5E5E5"> we want to look for in our</font>

690
00:30:42,830 --> 00:30:51,470
environment and then you know we have

691
00:30:47,480 --> 00:30:54,650
<font color="#E5E5E5">some use</font><font color="#CCCCCC"> cases here</font><font color="#E5E5E5"> detecting credential</font>

692
00:30:51,470 --> 00:31:00,410
theft<font color="#CCCCCC"> you know if we see processes that</font>

693
00:30:54,650 --> 00:31:05,560
injector interact<font color="#E5E5E5"> with</font><font color="#CCCCCC"> LSAs SDXC we get</font>

694
00:31:00,410 --> 00:31:09,410
alerts on that within<font color="#E5E5E5"> minutes you know</font>

695
00:31:05,560 --> 00:31:13,460
<font color="#E5E5E5">injecting processes that jekking</font>

696
00:31:09,410 --> 00:31:16,760
themselves<font color="#E5E5E5"> into other processes</font><font color="#CCCCCC"> any use</font>

697
00:31:13,460 --> 00:31:18,620
of<font color="#E5E5E5"> PowerShell really I mean it was</font><font color="#CCCCCC"> very</font>

698
00:31:16,760 --> 00:31:20,360
useful<font color="#E5E5E5"> for</font><font color="#CCCCCC"> us to get</font><font color="#E5E5E5"> kind of a handle on</font>

699
00:31:18,620 --> 00:31:23,870
<font color="#E5E5E5">who use PowerShell in our environment</font>

700
00:31:20,360 --> 00:31:25,159
<font color="#E5E5E5">you know our</font><font color="#CCCCCC"> our just our system admins</font>

701
00:31:23,870 --> 00:31:27,649
using it are their people<font color="#E5E5E5"> and other</font>

702
00:31:25,160 --> 00:31:30,530
<font color="#E5E5E5">divisions within our within</font><font color="#CCCCCC"> the county</font>

703
00:31:27,650 --> 00:31:32,000
that<font color="#CCCCCC"> are using it</font><font color="#E5E5E5"> so that was really</font>

704
00:31:30,530 --> 00:31:35,410
useful to<font color="#E5E5E5"> get an idea of what kind of</font>

705
00:31:32,000 --> 00:31:35,410
behavior we're seeing on<font color="#CCCCCC"> our network</font>

706
00:31:37,390 --> 00:31:42,050
oftentimes<font color="#CCCCCC"> your your garden-variety</font>

707
00:31:39,920 --> 00:31:45,680
<font color="#E5E5E5">ransomware we'll start with command exe</font>

708
00:31:42,050 --> 00:31:47,960
move to<font color="#CCCCCC"> PowerShell and then do</font><font color="#E5E5E5"> something</font>

709
00:31:45,680 --> 00:31:49,760
like use BitLocker<font color="#CCCCCC"> against itself</font><font color="#E5E5E5"> and</font>

710
00:31:47,960 --> 00:31:53,150
<font color="#E5E5E5">you can see that progression through</font>

711
00:31:49,760 --> 00:31:54,980
here you'll<font color="#CCCCCC"> be able to see when someone</font>

712
00:31:53,150 --> 00:31:57,410
invokes<font color="#E5E5E5"> command</font><font color="#CCCCCC"> exe</font><font color="#E5E5E5"> how they get the</font>

713
00:31:54,980 --> 00:31:59,480
PowerShell you can watch the process<font color="#CCCCCC"> as</font>

714
00:31:57,410 --> 00:32:01,130
it<font color="#E5E5E5"> happens and</font><font color="#CCCCCC"> you can go back and</font>

715
00:31:59,480 --> 00:32:04,540
search<font color="#E5E5E5"> your</font><font color="#CCCCCC"> entire environment</font><font color="#E5E5E5"> to see</font>

716
00:32:01,130 --> 00:32:04,540
where<font color="#E5E5E5"> else this may have occurred</font>

717
00:32:05,290 --> 00:32:10,070
<font color="#E5E5E5">probably the biggest gain we've got from</font>

718
00:32:07,490 --> 00:32:13,670
that<font color="#E5E5E5"> is</font><font color="#CCCCCC"> when something happens and we go</font>

719
00:32:10,070 --> 00:32:15,770
to you know<font color="#E5E5E5"> some kind of meeting to talk</font>

720
00:32:13,670 --> 00:32:17,750
<font color="#CCCCCC">about what's going on</font><font color="#E5E5E5"> you know we have</font>

721
00:32:15,770 --> 00:32:18,980
answers we can<font color="#E5E5E5"> say this is where the</font>

722
00:32:17,750 --> 00:32:22,160
<font color="#E5E5E5">person came in this is what they're</font>

723
00:32:18,980 --> 00:32:24,170
<font color="#CCCCCC">doing this is what they're after</font><font color="#E5E5E5"> it</font>

724
00:32:22,160 --> 00:32:25,550
gives us the ability<font color="#E5E5E5"> to give answers in</font>

725
00:32:24,170 --> 00:32:28,070
<font color="#E5E5E5">these kind of</font><font color="#CCCCCC"> meetings especially</font><font color="#E5E5E5"> the</font>

726
00:32:25,550 --> 00:32:31,129
<font color="#E5E5E5">after-action kind of you know lessons</font>

727
00:32:28,070 --> 00:32:32,240
learned things<font color="#E5E5E5"> whereas before you</font><font color="#CCCCCC"> may go</font>

728
00:32:31,130 --> 00:32:35,810
in and you may only<font color="#CCCCCC"> have</font><font color="#E5E5E5"> partial</font>

729
00:32:32,240 --> 00:32:36,650
<font color="#CCCCCC">information or maybe you really</font><font color="#E5E5E5"> don't</font>

730
00:32:35,810 --> 00:32:39,350
know what happened

731
00:32:36,650 --> 00:32:41,990
this kind of system<font color="#E5E5E5"> with with</font><font color="#CCCCCC"> system on</font>

732
00:32:39,350 --> 00:32:43,129
and a way<font color="#E5E5E5"> to ingest those logs and bring</font>

733
00:32:41,990 --> 00:32:45,779
them<font color="#CCCCCC"> back up</font>

734
00:32:43,130 --> 00:32:49,289
you know has<font color="#CCCCCC"> really upped our game and</font>

735
00:32:45,779 --> 00:32:51,299
<font color="#E5E5E5">we</font><font color="#CCCCCC"> can we can go in</font><font color="#E5E5E5"> with pretty good</font>

736
00:32:49,289 --> 00:32:53,100
certainty now and just say<font color="#E5E5E5"> look this is</font>

737
00:32:51,299 --> 00:32:55,139
<font color="#E5E5E5">what we saw here's the computers</font><font color="#CCCCCC"> that</font>

738
00:32:53,100 --> 00:32:56,939
<font color="#E5E5E5">are affected here's the users this</font><font color="#CCCCCC"> is</font>

739
00:32:55,140 --> 00:33:00,090
<font color="#CCCCCC">how they got in our</font><font color="#E5E5E5"> environment</font><font color="#CCCCCC"> this is</font>

740
00:32:56,940 --> 00:33:03,590
where they've moved<font color="#CCCCCC"> it's given us a</font><font color="#E5E5E5"> lot</font>

741
00:33:00,090 --> 00:33:03,590
<font color="#E5E5E5">of capability that's been really nice</font>

742
00:33:04,820 --> 00:33:08,939
<font color="#E5E5E5">and I'm kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> moving fast through</font>

743
00:33:07,260 --> 00:33:10,470
<font color="#E5E5E5">these I hope to kind of get through them</font>

744
00:33:08,940 --> 00:33:12,059
<font color="#CCCCCC">and</font><font color="#E5E5E5"> get to some points where people if</font>

745
00:33:10,470 --> 00:33:14,580
<font color="#CCCCCC">they would</font><font color="#E5E5E5"> have questions or they want</font>

746
00:33:12,059 --> 00:33:19,710
us<font color="#CCCCCC"> to cover more areas in more depth</font>

747
00:33:14,580 --> 00:33:23,689
than we can go back<font color="#E5E5E5"> and do that</font><font color="#CCCCCC"> this is</font>

748
00:33:19,710 --> 00:33:23,690
you know tracking evil on the<font color="#CCCCCC"> in</font><font color="#E5E5E5"> point</font>

749
00:33:26,120 --> 00:33:37,158
<font color="#E5E5E5">you know obviously you can</font><font color="#CCCCCC"> see when they</font>

750
00:33:29,700 --> 00:33:39,929
<font color="#E5E5E5">beacon back</font><font color="#CCCCCC"> to c2 you can start to see</font>

751
00:33:37,159 --> 00:33:43,130
<font color="#E5E5E5">attacker pivoting behavior so if any of</font>

752
00:33:39,929 --> 00:33:46,320
you sat in<font color="#E5E5E5"> on Chris</font><font color="#CCCCCC"> hunters</font><font color="#E5E5E5"> W my</font>

753
00:33:43,130 --> 00:33:48,840
workshop<font color="#E5E5E5"> all that stuff where he's</font>

754
00:33:46,320 --> 00:33:49,710
living<font color="#E5E5E5"> off the land and moving sideways</font>

755
00:33:48,840 --> 00:33:52,559
in your environment

756
00:33:49,710 --> 00:33:54,570
throws flags and we get alerts I mean

757
00:33:52,559 --> 00:33:58,529
someone that's gonna have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be awful</font>

758
00:33:54,570 --> 00:34:00,269
stealthy<font color="#E5E5E5"> to sneak around on our network</font>

759
00:33:58,529 --> 00:34:03,360
you know it might<font color="#CCCCCC"> not take much to</font><font color="#E5E5E5"> get</font>

760
00:34:00,269 --> 00:34:07,919
in given the end users<font color="#CCCCCC"> or what they are</font>

761
00:34:03,360 --> 00:34:09,659
<font color="#CCCCCC">but once they're in we're reasonably</font>

762
00:34:07,919 --> 00:34:13,950
certain<font color="#E5E5E5"> we can catch their behavior</font>

763
00:34:09,659 --> 00:34:17,280
within<font color="#E5E5E5"> minutes</font><font color="#CCCCCC"> at best and you know it's</font>

764
00:34:13,949 --> 00:34:18,899
not<font color="#E5E5E5"> going to take us long</font><font color="#CCCCCC"> our biggest</font>

765
00:34:17,280 --> 00:34:21,450
<font color="#E5E5E5">problem is you know we're a government</font>

766
00:34:18,899 --> 00:34:26,449
shop and and we're<font color="#E5E5E5"> not there on the</font>

767
00:34:21,449 --> 00:34:28,949
<font color="#E5E5E5">weekends and we're not staffed 24/7 so</font>

768
00:34:26,449 --> 00:34:30,810
the hackers know that and they sneak in

769
00:34:28,949 --> 00:34:34,098
at<font color="#CCCCCC"> night or on the holiday weekends and</font>

770
00:34:30,810 --> 00:34:34,099
<font color="#E5E5E5">that's when we see the</font><font color="#CCCCCC"> most activity</font>

771
00:34:39,389 --> 00:34:45,359
John do<font color="#CCCCCC"> you have anything</font><font color="#E5E5E5"> you want to</font>

772
00:34:40,860 --> 00:34:47,040
add to these we go into these<font color="#CCCCCC"> in case</font>

773
00:34:45,360 --> 00:34:48,720
you want to<font color="#E5E5E5"> come up and talk</font><font color="#CCCCCC"> to some of</font>

774
00:34:47,040 --> 00:35:00,029
<font color="#E5E5E5">these because you're the you're</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> red</font>

775
00:34:48,719 --> 00:35:03,830
<font color="#E5E5E5">team guy all right so we have</font><font color="#CCCCCC"> a few</font>

776
00:35:00,030 --> 00:35:06,150
<font color="#CCCCCC">slides on red team activity or</font>

777
00:35:03,830 --> 00:35:09,240
adversarial activity little<font color="#CCCCCC"> attack</font><font color="#E5E5E5"> chain</font>

778
00:35:06,150 --> 00:35:12,840
and what can be<font color="#E5E5E5"> picked up with</font><font color="#CCCCCC"> system on</font>

779
00:35:09,240 --> 00:35:15,600
and analyzed<font color="#E5E5E5"> with elastic stack so in</font>

780
00:35:12,840 --> 00:35:18,330
the attack chain<font color="#E5E5E5"> just</font><font color="#CCCCCC"> a few steps</font><font color="#E5E5E5"> in</font>

781
00:35:15,600 --> 00:35:22,140
this<font color="#E5E5E5"> mini one here but</font><font color="#CCCCCC"> client-side</font>

782
00:35:18,330 --> 00:35:26,220
<font color="#E5E5E5">compromised user opens</font><font color="#CCCCCC"> up malware that</font>

783
00:35:22,140 --> 00:35:28,470
<font color="#E5E5E5">user</font><font color="#CCCCCC"> the adversary then elevates to</font><font color="#E5E5E5"> sift</font>

784
00:35:26,220 --> 00:35:29,759
system level permissions<font color="#CCCCCC"> does some</font>

785
00:35:28,470 --> 00:35:31,740
credential theft and<font color="#E5E5E5"> then moves</font>

786
00:35:29,760 --> 00:35:33,570
laterally<font color="#CCCCCC"> so the first</font><font color="#E5E5E5"> of those</font>

787
00:35:31,740 --> 00:35:36,839
<font color="#CCCCCC">activities just to kind of worry you</font>

788
00:35:33,570 --> 00:35:39,020
here<font color="#E5E5E5"> so on the left in the red box is</font>

789
00:35:36,840 --> 00:35:42,840
<font color="#E5E5E5">the adversarial activity in the blue is</font>

790
00:35:39,020 --> 00:35:44,400
what we can pick<font color="#CCCCCC"> up</font><font color="#E5E5E5"> with with elastic</font>

791
00:35:42,840 --> 00:35:47,060
stack and what we get alerted<font color="#E5E5E5"> on or see</font>

792
00:35:44,400 --> 00:35:51,170
visualizations around so in this example

793
00:35:47,060 --> 00:35:54,900
<font color="#E5E5E5">an HT a file is created by the attacker</font>

794
00:35:51,170 --> 00:35:56,940
<font color="#E5E5E5">not displayed here is hosting the the</font>

795
00:35:54,900 --> 00:35:59,190
<font color="#CCCCCC">malware and having getting</font><font color="#E5E5E5"> the user to</font>

796
00:35:56,940 --> 00:36:02,310
go download<font color="#E5E5E5"> it</font><font color="#CCCCCC"> and execute</font><font color="#E5E5E5"> it but when</font>

797
00:35:59,190 --> 00:36:04,800
it is downloaded and<font color="#CCCCCC"> executed</font><font color="#E5E5E5"> our verse</font>

798
00:36:02,310 --> 00:36:07,410
shell<font color="#CCCCCC"> is obtained by the attacker</font><font color="#E5E5E5"> and</font>

799
00:36:04,800 --> 00:36:11,040
that's what's happening<font color="#E5E5E5"> on the left on</font>

800
00:36:07,410 --> 00:36:13,980
the<font color="#CCCCCC"> right</font><font color="#E5E5E5"> the particular</font><font color="#CCCCCC"> HT a file</font>

801
00:36:11,040 --> 00:36:15,870
launched<font color="#E5E5E5"> PowerShell and</font><font color="#CCCCCC"> the command-line</font>

802
00:36:13,980 --> 00:36:18,240
invocation of that<font color="#E5E5E5"> PowerShell execution</font>

803
00:36:15,870 --> 00:36:20,549
was very large<font color="#E5E5E5"> you can see there the</font>

804
00:36:18,240 --> 00:36:22,589
command line length was almost<font color="#CCCCCC"> 5,000</font>

805
00:36:20,550 --> 00:36:24,510
characters we have<font color="#E5E5E5"> a particular alert</font>

806
00:36:22,590 --> 00:36:25,800
around<font color="#CCCCCC"> if more than a thousand</font>

807
00:36:24,510 --> 00:36:28,020
characters are seen<font color="#CCCCCC"> in a command line</font>

808
00:36:25,800 --> 00:36:31,080
invocation of<font color="#E5E5E5"> PowerShell then alert us</font>

809
00:36:28,020 --> 00:36:33,420
<font color="#CCCCCC">to it you can</font><font color="#E5E5E5"> see</font><font color="#CCCCCC"> there in</font><font color="#E5E5E5"> the alert not</font>

810
00:36:31,080 --> 00:36:36,390
<font color="#E5E5E5">only does it show us you know what user</font>

811
00:36:33,420 --> 00:36:37,800
was involved<font color="#E5E5E5"> in the activity and the</font>

812
00:36:36,390 --> 00:36:39,960
host that<font color="#CCCCCC"> was involved</font><font color="#E5E5E5"> in the activity</font>

813
00:36:37,800 --> 00:36:43,740
but<font color="#E5E5E5"> it also shows us</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> process</font>

814
00:36:39,960 --> 00:36:45,570
integrity level of that<font color="#E5E5E5"> PowerShell is</font>

815
00:36:43,740 --> 00:36:47,970
high so it was an administrator that's

816
00:36:45,570 --> 00:36:50,460
our local<font color="#E5E5E5"> administrator</font><font color="#CCCCCC"> that happened to</font>

817
00:36:47,970 --> 00:36:52,890
launch this this malware<font color="#CCCCCC"> and it even</font>

818
00:36:50,460 --> 00:36:55,860
shows us<font color="#E5E5E5"> the parent process and the</font>

819
00:36:52,890 --> 00:36:59,190
the process command line around the

820
00:36:55,860 --> 00:37:01,020
activity<font color="#CCCCCC"> so that's the elastomer</font><font color="#E5E5E5"> email</font>

821
00:36:59,190 --> 00:37:04,560
we would get and then in the<font color="#E5E5E5"> bottom</font>

822
00:37:01,020 --> 00:37:07,230
right is just<font color="#CCCCCC"> the system</font><font color="#E5E5E5"> on events for</font>

823
00:37:04,560 --> 00:37:10,170
network connections<font color="#E5E5E5"> reaching back out to</font>

824
00:37:07,230 --> 00:37:12,180
the<font color="#CCCCCC"> command-and-control</font><font color="#E5E5E5"> server so that's</font>

825
00:37:10,170 --> 00:37:14,820
in this case how<font color="#E5E5E5"> the attacker gets his</font>

826
00:37:12,180 --> 00:37:19,020
initial access to a machine<font color="#E5E5E5"> when he has</font>

827
00:37:14,820 --> 00:37:20,250
<font color="#CCCCCC">it initial access he</font><font color="#E5E5E5"> once he realizes</font>

828
00:37:19,020 --> 00:37:21,630
that he<font color="#CCCCCC"> has the</font><font color="#E5E5E5"> local administrative</font>

829
00:37:20,250 --> 00:37:25,380
rights he's<font color="#CCCCCC"> likely going to try to</font>

830
00:37:21,630 --> 00:37:28,560
elevate<font color="#E5E5E5"> to system in</font><font color="#CCCCCC"> Metasploit</font><font color="#E5E5E5"> simple</font>

831
00:37:25,380 --> 00:37:33,300
process<font color="#E5E5E5"> elevate system</font><font color="#CCCCCC"> when</font><font color="#E5E5E5"> he does that</font>

832
00:37:28,560 --> 00:37:36,090
<font color="#E5E5E5">it</font><font color="#CCCCCC"> actually said logs an</font><font color="#E5E5E5"> event</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> a new</font>

833
00:37:33,300 --> 00:37:39,590
<font color="#E5E5E5">service creation</font><font color="#CCCCCC"> I mean that new service</font>

834
00:37:36,090 --> 00:37:42,720
is<font color="#E5E5E5"> created we</font><font color="#CCCCCC"> have an alert built around</font>

835
00:37:39,590 --> 00:37:44,220
system new service creations service

836
00:37:42,720 --> 00:37:47,189
creation names that have never been seen

837
00:37:44,220 --> 00:37:48,899
before in<font color="#E5E5E5"> our environment so</font><font color="#CCCCCC"> Metasploit</font>

838
00:37:47,190 --> 00:37:51,600
actually uses a random service name in

839
00:37:48,900 --> 00:37:53,280
this<font color="#E5E5E5"> case</font><font color="#CCCCCC"> so because</font><font color="#E5E5E5"> that's brand new to</font>

840
00:37:51,600 --> 00:37:55,589
our<font color="#E5E5E5"> environment</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> get an alert around</font>

841
00:37:53,280 --> 00:37:57,780
<font color="#E5E5E5">it so we know that a new service has</font>

842
00:37:55,590 --> 00:38:01,860
<font color="#E5E5E5">been installed on a system and</font><font color="#CCCCCC"> we can</font>

843
00:37:57,780 --> 00:38:03,450
<font color="#E5E5E5">work backward</font><font color="#CCCCCC"> from what the service</font>

844
00:38:01,860 --> 00:38:06,300
executable is and what the command<font color="#E5E5E5"> line</font>

845
00:38:03,450 --> 00:38:07,589
<font color="#CCCCCC">of vacation is of that new service and</font>

846
00:38:06,300 --> 00:38:10,290
we can try<font color="#E5E5E5"> to figure out what occurred</font>

847
00:38:07,590 --> 00:38:12,780
on the system in this case<font color="#E5E5E5"> elevation to</font>

848
00:38:10,290 --> 00:38:15,930
system level permissions<font color="#E5E5E5"> and then on the</font>

849
00:38:12,780 --> 00:38:19,050
<font color="#CCCCCC">bottom right</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> Cabana we have some</font>

850
00:38:15,930 --> 00:38:20,490
dashboards<font color="#E5E5E5"> built around new new service</font>

851
00:38:19,050 --> 00:38:24,120
installs across our<font color="#CCCCCC"> entire environment</font>

852
00:38:20,490 --> 00:38:27,209
<font color="#CCCCCC">so if this similar pivoting TechNet is</font>

853
00:38:24,120 --> 00:38:28,319
this similar<font color="#E5E5E5"> IOC was seen</font><font color="#CCCCCC"> elsewhere in</font>

854
00:38:27,210 --> 00:38:30,000
our environment<font color="#E5E5E5"> we might be able to</font>

855
00:38:28,320 --> 00:38:32,370
<font color="#E5E5E5">catch</font><font color="#CCCCCC"> it by looking at a dashboard with</font>

856
00:38:30,000 --> 00:38:35,550
giant spikes so new service is being

857
00:38:32,370 --> 00:38:37,200
<font color="#E5E5E5">installed on many systems and in an</font>

858
00:38:35,550 --> 00:38:41,430
inner<font color="#CCCCCC"> enterprise</font><font color="#E5E5E5"> within a short period</font>

859
00:38:37,200 --> 00:38:45,509
<font color="#CCCCCC">of time so that's</font><font color="#E5E5E5"> how we can potentially</font>

860
00:38:41,430 --> 00:38:47,310
<font color="#E5E5E5">track</font><font color="#CCCCCC"> an alert on system elevation once</font>

861
00:38:45,510 --> 00:38:50,040
you have the attacker has system<font color="#CCCCCC"> he's in</font>

862
00:38:47,310 --> 00:38:53,370
<font color="#E5E5E5">a try some credential theft so in this</font>

863
00:38:50,040 --> 00:38:57,390
case there's a<font color="#CCCCCC"> module and</font><font color="#E5E5E5"> meterpreter to</font>

864
00:38:53,370 --> 00:39:00,720
to run<font color="#E5E5E5"> me me cats running me me cats</font><font color="#CCCCCC"> it</font>

865
00:38:57,390 --> 00:39:03,029
will dump hashes<font color="#CCCCCC"> and even if you're</font><font color="#E5E5E5"> on</font>

866
00:39:00,720 --> 00:39:04,950
an old<font color="#CCCCCC"> or older</font><font color="#E5E5E5"> Windows 7</font><font color="#CCCCCC"> Box</font><font color="#E5E5E5"> it might</font>

867
00:39:03,030 --> 00:39:07,110
dump the<font color="#CCCCCC"> plain text</font>

868
00:39:04,950 --> 00:39:11,640
credentials<font color="#E5E5E5"> from memory</font>

869
00:39:07,110 --> 00:39:14,340
so when the attacker does this<font color="#CCCCCC"> it's kind</font>

870
00:39:11,640 --> 00:39:17,720
of hard to see there but on the left is

871
00:39:14,340 --> 00:39:17,720
some<font color="#E5E5E5"> Cabana</font>

872
00:39:17,930 --> 00:39:24,419
<font color="#CCCCCC">dashboards around</font><font color="#E5E5E5"> a particular</font>

873
00:39:21,920 --> 00:39:27,180
executable interacting with else ass and

874
00:39:24,420 --> 00:39:28,500
then on the right again<font color="#E5E5E5"> with IOC</font><font color="#CCCCCC"> s we</font>

875
00:39:27,180 --> 00:39:30,470
can look<font color="#E5E5E5"> across our entire environment</font>

876
00:39:28,500 --> 00:39:34,100
<font color="#E5E5E5">to see if this</font><font color="#CCCCCC"> activity is taking</font><font color="#E5E5E5"> place</font>

877
00:39:30,470 --> 00:39:38,609
<font color="#E5E5E5">elsewhere and we can see giant spikes in</font>

878
00:39:34,100 --> 00:39:40,940
suspicious<font color="#E5E5E5"> else s interactions so we can</font>

879
00:39:38,610 --> 00:39:43,860
pick up<font color="#E5E5E5"> a credential theft</font><font color="#CCCCCC"> across our</font>

880
00:39:40,940 --> 00:39:46,470
our footprint and<font color="#E5E5E5"> then the last step in</font>

881
00:39:43,860 --> 00:39:48,390
this little mini attack chain always<font color="#E5E5E5"> may</font>

882
00:39:46,470 --> 00:39:48,868
<font color="#E5E5E5">be lateral movement from one system to</font>

883
00:39:48,390 --> 00:39:50,910
another

884
00:39:48,869 --> 00:39:54,180
<font color="#E5E5E5">so once the adversary has some of those</font>

885
00:39:50,910 --> 00:39:57,029
credentials<font color="#CCCCCC"> maybe in this</font><font color="#E5E5E5"> case</font><font color="#CCCCCC"> up in the</font>

886
00:39:54,180 --> 00:40:00,839
top right<font color="#CCCCCC"> they're using a module or both</font>

887
00:39:57,030 --> 00:40:02,610
<font color="#E5E5E5">around</font><font color="#CCCCCC"> WMI to execute code on a remote</font>

888
00:40:00,840 --> 00:40:05,280
system<font color="#E5E5E5"> with the current credentials</font>

889
00:40:02,610 --> 00:40:07,230
they've stolen<font color="#E5E5E5"> so once they do</font><font color="#CCCCCC"> that on</font>

890
00:40:05,280 --> 00:40:12,210
the<font color="#CCCCCC"> Left again we have some alerting</font>

891
00:40:07,230 --> 00:40:15,210
<font color="#E5E5E5">both arounds</font><font color="#CCCCCC"> WMI pivoting what users</font>

892
00:40:12,210 --> 00:40:18,300
<font color="#CCCCCC">involved what hosts and the commands</font>

893
00:40:15,210 --> 00:40:20,790
issued<font color="#E5E5E5"> across it</font><font color="#CCCCCC"> WMI connection and then</font>

894
00:40:18,300 --> 00:40:22,770
<font color="#E5E5E5">the bottom rights again a system on</font>

895
00:40:20,790 --> 00:40:25,500
events<font color="#E5E5E5"> both wrong network connections</font>

896
00:40:22,770 --> 00:40:29,130
you can see the pivoting there and then

897
00:40:25,500 --> 00:40:34,740
on the left a<font color="#CCCCCC"> dashboard for</font><font color="#E5E5E5"> in this case</font>

898
00:40:29,130 --> 00:40:36,330
<font color="#CCCCCC">w mik executable executions in our</font>

899
00:40:34,740 --> 00:40:38,129
environment so if we see giant spikes it

900
00:40:36,330 --> 00:40:42,420
might be an indicator or something to

901
00:40:38,130 --> 00:40:44,400
<font color="#E5E5E5">look at</font><font color="#CCCCCC"> so that's how</font><font color="#E5E5E5"> we're using</font>

902
00:40:42,420 --> 00:40:45,810
endpoint monitoring but<font color="#E5E5E5"> going beyond</font>

903
00:40:44,400 --> 00:40:47,880
endpoint monitoring and bringing in

904
00:40:45,810 --> 00:40:51,210
<font color="#E5E5E5">other data sources to elastic stack</font>

905
00:40:47,880 --> 00:40:52,680
there's a lot of room for growth<font color="#CCCCCC"> to help</font>

906
00:40:51,210 --> 00:40:55,320
<font color="#E5E5E5">improve detection hunting and forensic</font>

907
00:40:52,680 --> 00:40:56,669
capability<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can start</font><font color="#CCCCCC"> bringing in</font>

908
00:40:55,320 --> 00:40:59,580
those domain controller logs to see

909
00:40:56,670 --> 00:41:02,730
what's going<font color="#CCCCCC"> on</font><font color="#E5E5E5"> across the domain DHCP</font>

910
00:40:59,580 --> 00:41:05,759
logs to see what<font color="#CCCCCC"> oh you know what</font>

911
00:41:02,730 --> 00:41:10,050
<font color="#CCCCCC">hosts</font><font color="#E5E5E5"> are connecting to the network DNS</font>

912
00:41:05,760 --> 00:41:12,390
events are<font color="#E5E5E5"> great to see if a machine</font>

913
00:41:10,050 --> 00:41:16,190
<font color="#E5E5E5">reached out to a particular particular</font>

914
00:41:12,390 --> 00:41:18,420
<font color="#E5E5E5">host</font><font color="#CCCCCC"> bro data</font><font color="#E5E5E5"> for a lot</font><font color="#CCCCCC"> of different</font>

915
00:41:16,190 --> 00:41:19,500
<font color="#E5E5E5">different use cases but</font><font color="#CCCCCC"> that's the</font>

916
00:41:18,420 --> 00:41:21,660
<font color="#E5E5E5">system for</font>

917
00:41:19,500 --> 00:41:24,119
<font color="#CCCCCC">and trekking metadata across network</font>

918
00:41:21,660 --> 00:41:26,660
connections<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can bring in not win not</font>

919
00:41:24,119 --> 00:41:30,510
just<font color="#CCCCCC"> Windows host but Linux hosts data</font>

920
00:41:26,660 --> 00:41:32,910
<font color="#CCCCCC">you know the secure</font><font color="#E5E5E5"> dot log and the auth</font>

921
00:41:30,510 --> 00:41:35,789
dot log files are great for<font color="#CCCCCC"> bringing in</font>

922
00:41:32,910 --> 00:41:38,940
information around<font color="#E5E5E5"> who's connecting</font><font color="#CCCCCC"> over</font>

923
00:41:35,789 --> 00:41:41,549
SSH who's running sudo commands<font color="#CCCCCC"> who's</font>

924
00:41:38,940 --> 00:41:44,160
who's elevating<font color="#CCCCCC"> to</font><font color="#E5E5E5"> routes you can start</font>

925
00:41:41,549 --> 00:41:45,619
bringing<font color="#E5E5E5"> in those logs into elastic you</font>

926
00:41:44,160 --> 00:41:47,940
<font color="#E5E5E5">can bring in your web infrastructure</font>

927
00:41:45,619 --> 00:41:50,970
<font color="#E5E5E5">some cloud infrastructure</font>

928
00:41:47,940 --> 00:41:54,089
<font color="#CCCCCC">there's plugins in log stash both for</font>

929
00:41:50,970 --> 00:41:57,569
Azure and for AWS<font color="#E5E5E5"> to monitor cloud</font>

930
00:41:54,089 --> 00:41:58,859
<font color="#CCCCCC">activity</font><font color="#E5E5E5"> in elastic</font><font color="#CCCCCC"> if you have</font><font color="#E5E5E5"> identity</font>

931
00:41:57,569 --> 00:42:00,960
<font color="#E5E5E5">management systems you can start</font>

932
00:41:58,859 --> 00:42:02,848
<font color="#E5E5E5">bringing in</font><font color="#CCCCCC"> those logs but really the</font>

933
00:42:00,960 --> 00:42:04,760
the possibilities are<font color="#CCCCCC"> endless in terms</font>

934
00:42:02,849 --> 00:42:08,640
of what you<font color="#E5E5E5"> can bring in and start some</font>

935
00:42:04,760 --> 00:42:10,710
start looking at<font color="#CCCCCC"> here's kind of a</font>

936
00:42:08,640 --> 00:42:12,420
<font color="#CCCCCC">reference</font><font color="#E5E5E5"> slide on</font><font color="#CCCCCC"> how you can learn</font>

937
00:42:10,710 --> 00:42:14,099
more if you want to do do something<font color="#E5E5E5"> like</font>

938
00:42:12,420 --> 00:42:16,619
this in<font color="#E5E5E5"> your environment</font><font color="#CCCCCC"> where we</font>

939
00:42:14,099 --> 00:42:20,250
started<font color="#E5E5E5"> was with the that cyberwar dog</font>

940
00:42:16,619 --> 00:42:22,740
blog<font color="#CCCCCC"> greats</font><font color="#E5E5E5"> reference on how to deploy</font>

941
00:42:20,250 --> 00:42:24,059
your<font color="#E5E5E5"> first elastic stack and he has a</font>

942
00:42:22,740 --> 00:42:28,109
lot<font color="#CCCCCC"> of articles</font><font color="#E5E5E5"> both around threat</font>

943
00:42:24,059 --> 00:42:30,809
hunting<font color="#E5E5E5"> with</font><font color="#CCCCCC"> system on</font><font color="#E5E5E5"> mark russinovich</font>

944
00:42:28,109 --> 00:42:33,900
<font color="#CCCCCC">few years ago at RSA presented a</font><font color="#E5E5E5"> great</font>

945
00:42:30,809 --> 00:42:38,460
presentation<font color="#E5E5E5"> around using system on</font><font color="#CCCCCC"> to</font>

946
00:42:33,900 --> 00:42:39,750
<font color="#E5E5E5">track adversarial activity great system</font>

947
00:42:38,460 --> 00:42:41,400
on configuration document<font color="#E5E5E5"> there from</font>

948
00:42:39,750 --> 00:42:43,140
<font color="#E5E5E5">swift on security to help you started</font>

949
00:42:41,400 --> 00:42:44,609
and then I've seen<font color="#CCCCCC"> a few presentations</font>

950
00:42:43,140 --> 00:42:47,400
here<font color="#E5E5E5"> at the conference about the</font><font color="#CCCCCC"> miter</font>

951
00:42:44,609 --> 00:42:49,950
attack framework<font color="#E5E5E5"> and you know there's</font>

952
00:42:47,400 --> 00:42:52,349
adversarial techniques tactics and

953
00:42:49,950 --> 00:42:53,879
<font color="#E5E5E5">procedures and how you can I can track</font>

954
00:42:52,349 --> 00:42:56,039
those<font color="#E5E5E5"> and</font><font color="#CCCCCC"> what to look for</font><font color="#E5E5E5"> so that's</font><font color="#CCCCCC"> a</font>

955
00:42:53,880 --> 00:42:58,130
great reference<font color="#E5E5E5"> to get started figure</font>

956
00:42:56,039 --> 00:43:01,380
<font color="#CCCCCC">out what you want</font><font color="#E5E5E5"> to start alerting on</font>

957
00:42:58,130 --> 00:43:05,000
and that that's pretty<font color="#E5E5E5"> much it are there</font>

958
00:43:01,380 --> 00:43:05,000
any questions<font color="#E5E5E5"> or</font><font color="#CCCCCC"> comments</font>

959
00:43:09,430 --> 00:43:14,839
so for some<font color="#E5E5E5"> of the alerting</font><font color="#CCCCCC"> for example</font>

960
00:43:12,890 --> 00:43:18,379
like with<font color="#E5E5E5"> new service creations at</font>

961
00:43:14,840 --> 00:43:19,790
<font color="#CCCCCC">baselines you know last</font><font color="#E5E5E5"> 120 days what</font>

962
00:43:18,380 --> 00:43:21,380
activity we've seen enough<font color="#CCCCCC"> anything that</font>

963
00:43:19,790 --> 00:43:23,960
deviates from<font color="#CCCCCC"> that we get an alert on it</font>

964
00:43:21,380 --> 00:43:25,369
<font color="#E5E5E5">a lot of</font><font color="#CCCCCC"> other things are more built</font>

965
00:43:23,960 --> 00:43:29,390
around<font color="#E5E5E5"> things in the miter attack</font>

966
00:43:25,369 --> 00:43:31,790
framework<font color="#CCCCCC"> you don't know what's you know</font>

967
00:43:29,390 --> 00:43:33,500
what<font color="#E5E5E5"> techniques blacklist techniques may</font>

968
00:43:31,790 --> 00:43:36,160
<font color="#CCCCCC">be should</font><font color="#E5E5E5"> be alerted on so it's kind of</font>

969
00:43:33,500 --> 00:43:36,160
a little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of both</font>

970
00:43:37,130 --> 00:43:41,570
and elastic is really good<font color="#CCCCCC"> they last</font>

971
00:43:39,320 --> 00:43:45,349
alert<font color="#E5E5E5"> alerting engine is great because</font>

972
00:43:41,570 --> 00:43:47,240
they<font color="#E5E5E5"> have a a</font><font color="#CCCCCC"> whitelisting alert module</font>

973
00:43:45,349 --> 00:43:48,920
<font color="#E5E5E5">so you give</font><font color="#CCCCCC"> it a filled and say hey</font>

974
00:43:47,240 --> 00:43:51,589
anything in this particular field if it

975
00:43:48,920 --> 00:43:54,650
<font color="#E5E5E5">deviates then alert on it</font>

976
00:43:51,590 --> 00:43:59,869
and you can use<font color="#E5E5E5"> that module for for</font>

977
00:43:54,650 --> 00:44:02,600
<font color="#CCCCCC">baselining all right thanks</font><font color="#E5E5E5"> for coming</font>

978
00:43:59,869 --> 00:44:08,150
and we appreciate you listening<font color="#E5E5E5"> to us</font>

979
00:44:02,600 --> 00:44:08,150
[Applause]

