1
00:00:03,779 --> 00:00:15,579
give me a countdown when you're<font color="#E5E5E5"> in okay</font>

2
00:00:12,280 --> 00:00:19,359
<font color="#E5E5E5">welcome</font><font color="#CCCCCC"> we're glad to have you here</font><font color="#E5E5E5"> it's</font>

3
00:00:15,579 --> 00:00:22,060
a little hot<font color="#E5E5E5"> okay fantastic</font>

4
00:00:19,359 --> 00:00:26,339
this<font color="#E5E5E5"> is a 101 track we're going to talk</font>

5
00:00:22,060 --> 00:00:30,640
<font color="#CCCCCC">about leveraging the dark side</font><font color="#E5E5E5"> hopefully</font>

6
00:00:26,339 --> 00:00:34,120
hopefully<font color="#E5E5E5"> you're all ready to get</font><font color="#CCCCCC"> a slew</font>

7
00:00:30,640 --> 00:00:37,240
of code information<font color="#E5E5E5"> and and some some</font>

8
00:00:34,120 --> 00:00:39,430
good stuff<font color="#CCCCCC"> the might first of all my</font>

9
00:00:37,240 --> 00:00:40,900
<font color="#E5E5E5">name</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> Jeremy Cox</font><font color="#CCCCCC"> I am the networking</font>

10
00:00:39,430 --> 00:00:43,870
<font color="#E5E5E5">security manager for Washington County</font>

11
00:00:40,900 --> 00:00:45,940
School District<font color="#CCCCCC"> that's my website right</font>

12
00:00:43,870 --> 00:00:49,180
<font color="#CCCCCC">there super tech guy comm you can find</font>

13
00:00:45,940 --> 00:00:51,610
this presentation<font color="#CCCCCC"> along</font><font color="#E5E5E5"> with some code</font>

14
00:00:49,180 --> 00:00:53,320
<font color="#E5E5E5">and some different things</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> I made</font>

15
00:00:51,610 --> 00:00:56,650
available as<font color="#E5E5E5"> part of this presentation</font>

16
00:00:53,320 --> 00:00:59,350
on my<font color="#CCCCCC"> website at super tech guy comm and</font>

17
00:00:56,650 --> 00:01:03,970
that is my<font color="#E5E5E5"> employers website if you're</font>

18
00:00:59,350 --> 00:01:06,280
interested<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so in this</font>

19
00:01:03,970 --> 00:01:08,170
<font color="#E5E5E5">presentation we will examine</font><font color="#CCCCCC"> how</font><font color="#E5E5E5"> to</font>

20
00:01:06,280 --> 00:01:12,310
leverage<font color="#E5E5E5"> a portion of your address space</font>

21
00:01:08,170 --> 00:01:14,710
<font color="#E5E5E5">to monitor and mitigate attacks</font><font color="#CCCCCC"> we will</font>

22
00:01:12,310 --> 00:01:16,750
discuss custom logging<font color="#CCCCCC"> and that this</font>

23
00:01:14,710 --> 00:01:19,389
will<font color="#E5E5E5"> be focused in kind of the Palo Alto</font>

24
00:01:16,750 --> 00:01:20,740
world<font color="#E5E5E5"> can it be applied to other worlds</font>

25
00:01:19,390 --> 00:01:23,080
absolutely

26
00:01:20,740 --> 00:01:25,449
but in this presentation I will<font color="#E5E5E5"> show you</font>

27
00:01:23,080 --> 00:01:28,390
how<font color="#E5E5E5"> to do it in Palo Alto from the Palo</font>

28
00:01:25,450 --> 00:01:30,100
Alto firewall to a<font color="#E5E5E5"> Linux log server we</font>

29
00:01:28,390 --> 00:01:33,010
will discuss<font color="#E5E5E5"> creating a custom dashboard</font>

30
00:01:30,100 --> 00:01:34,990
<font color="#E5E5E5">with these logs we will</font><font color="#CCCCCC"> also discuss how</font>

31
00:01:33,010 --> 00:01:37,990
<font color="#E5E5E5">to turn those logs into a list of IP</font>

32
00:01:34,990 --> 00:01:40,449
addresses<font color="#E5E5E5"> and we will discuss</font><font color="#CCCCCC"> the uses</font>

33
00:01:37,990 --> 00:01:42,990
<font color="#E5E5E5">of dynamic address list on the Palo Alto</font>

34
00:01:40,450 --> 00:01:46,479
firewall and then<font color="#E5E5E5"> we will also discuss</font>

35
00:01:42,990 --> 00:01:47,669
<font color="#CCCCCC">using</font><font color="#E5E5E5"> access lists to block traffic from</font>

36
00:01:46,479 --> 00:01:50,140
those addresses

37
00:01:47,670 --> 00:01:52,810
so there's a lot we're<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> cover today</font>

38
00:01:50,140 --> 00:01:55,960
<font color="#E5E5E5">we've got a almost a full hour to cover</font>

39
00:01:52,810 --> 00:01:58,780
it if we get done early<font color="#CCCCCC"> then we'll take</font>

40
00:01:55,960 --> 00:02:01,149
a Q&A<font color="#CCCCCC"> at the end but</font><font color="#E5E5E5"> otherwise we'll</font>

41
00:01:58,780 --> 00:02:03,250
<font color="#E5E5E5">we'll just</font><font color="#CCCCCC"> keep on moving forward</font>

42
00:02:01,150 --> 00:02:06,430
okay so technologies used<font color="#E5E5E5"> in this</font>

43
00:02:03,250 --> 00:02:08,500
presentation<font color="#CCCCCC"> as I stated already Palo</font>

44
00:02:06,430 --> 00:02:12,400
<font color="#CCCCCC">Alto firewall</font><font color="#E5E5E5"> we'll be talking about</font>

45
00:02:08,500 --> 00:02:14,709
syslog-ng<font color="#CCCCCC"> which is an open</font><font color="#E5E5E5"> source system</font>

46
00:02:12,400 --> 00:02:18,459
logger<font color="#E5E5E5"> Apache</font>

47
00:02:14,709 --> 00:02:21,939
we'll use<font color="#CCCCCC"> PHP 5 HTML 5 excuse me PHP 7</font>

48
00:02:18,459 --> 00:02:23,980
HTML 5 and Ajax<font color="#E5E5E5"> and yes it may work on</font>

49
00:02:21,939 --> 00:02:26,920
others<font color="#E5E5E5"> but today I'll show you</font><font color="#CCCCCC"> how</font><font color="#E5E5E5"> to do</font>

50
00:02:23,980 --> 00:02:29,108
it on<font color="#E5E5E5"> these so first of all what</font><font color="#CCCCCC"> is a</font>

51
00:02:26,920 --> 00:02:31,420
darknet<font color="#CCCCCC"> many of</font><font color="#E5E5E5"> you have heard the term</font>

52
00:02:29,109 --> 00:02:34,269
<font color="#CCCCCC">darknet</font><font color="#E5E5E5"> no we're not</font><font color="#CCCCCC"> referring to the</font>

53
00:02:31,420 --> 00:02:35,798
<font color="#CCCCCC">Tor</font><font color="#E5E5E5"> network</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> in this particular</font>

54
00:02:34,269 --> 00:02:38,469
instance we're not referring<font color="#CCCCCC"> referring</font>

55
00:02:35,799 --> 00:02:40,299
<font color="#E5E5E5">to the darknet we're talking about a</font>

56
00:02:38,469 --> 00:02:43,000
<font color="#CCCCCC">darknet</font><font color="#E5E5E5"> that you're going to build on</font>

57
00:02:40,299 --> 00:02:46,239
<font color="#CCCCCC">your own networks a</font><font color="#E5E5E5"> darknet is basically</font>

58
00:02:43,000 --> 00:02:49,209
a section of addresses<font color="#CCCCCC"> an address space</font>

59
00:02:46,239 --> 00:02:51,549
<font color="#CCCCCC">with nothing on it</font><font color="#E5E5E5"> something</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> has no</font>

60
00:02:49,209 --> 00:02:54,040
DNS records pointed to it no servers on

61
00:02:51,549 --> 00:02:57,310
it no references<font color="#E5E5E5"> to</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> in any way</font><font color="#CCCCCC"> and</font>

62
00:02:54,040 --> 00:02:59,858
preferably<font color="#E5E5E5"> has never had anything on it</font>

63
00:02:57,310 --> 00:03:02,889
<font color="#E5E5E5">or hasn't had anything on it in a very</font>

64
00:02:59,859 --> 00:03:05,230
<font color="#E5E5E5">very long time so the idea</font><font color="#CCCCCC"> being that</font>

65
00:03:02,889 --> 00:03:07,180
<font color="#E5E5E5">you've got some addresses but there is</font>

66
00:03:05,230 --> 00:03:09,849
no legitimate<font color="#E5E5E5"> way that anybody should</font>

67
00:03:07,180 --> 00:03:12,060
ever really be talking<font color="#E5E5E5"> to</font><font color="#CCCCCC"> them and if</font>

68
00:03:09,849 --> 00:03:15,010
they<font color="#CCCCCC"> are talking to them it's because</font>

69
00:03:12,060 --> 00:03:17,319
they<font color="#E5E5E5"> shouldn't be there</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> that's the</font>

70
00:03:15,010 --> 00:03:20,590
idea<font color="#E5E5E5"> behind this and what is the purpose</font>

71
00:03:17,319 --> 00:03:23,379
<font color="#E5E5E5">of a darknet mostly to catch automated</font>

72
00:03:20,590 --> 00:03:26,220
scans<font color="#E5E5E5"> we're looking at people</font><font color="#CCCCCC"> who are</font>

73
00:03:23,379 --> 00:03:30,790
<font color="#CCCCCC">going through your network</font><font color="#E5E5E5"> with either</font>

74
00:03:26,220 --> 00:03:32,739
<font color="#E5E5E5">nmap or any other number of scanners out</font>

75
00:03:30,790 --> 00:03:35,078
there some script kiddies<font color="#CCCCCC"> or just</font>

76
00:03:32,739 --> 00:03:37,439
automated scans that<font color="#E5E5E5"> are looking through</font>

77
00:03:35,079 --> 00:03:41,349
<font color="#E5E5E5">your network looking for resources</font><font color="#CCCCCC"> to</font>

78
00:03:37,439 --> 00:03:43,900
<font color="#CCCCCC">hack and exploit and so the purpose of</font>

79
00:03:41,349 --> 00:03:46,899
the darknet is to see those scans as

80
00:03:43,900 --> 00:03:49,840
they come in on your network in a

81
00:03:46,900 --> 00:03:52,900
controlled environment<font color="#CCCCCC"> and</font><font color="#E5E5E5"> such that you</font>

82
00:03:49,840 --> 00:03:56,169
know who's doing<font color="#E5E5E5"> it what they're looking</font>

83
00:03:52,900 --> 00:03:57,400
<font color="#CCCCCC">for</font><font color="#E5E5E5"> and ultimately have the ability</font><font color="#CCCCCC"> to</font>

84
00:03:56,169 --> 00:04:00,750
do something<font color="#E5E5E5"> about it</font>

85
00:03:57,400 --> 00:04:03,069
<font color="#E5E5E5">so to build a</font><font color="#CCCCCC"> darknet how do</font><font color="#E5E5E5"> we do this</font>

86
00:04:00,750 --> 00:04:06,220
well<font color="#CCCCCC"> first</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> need to determine how</font>

87
00:04:03,069 --> 00:04:09,069
large of a<font color="#E5E5E5"> darknet you need okay and</font>

88
00:04:06,220 --> 00:04:10,810
this largely depends on what kind of IP

89
00:04:09,069 --> 00:04:12,569
structure you're working with how<font color="#CCCCCC"> many</font>

90
00:04:10,810 --> 00:04:15,729
addresses you're working with in your

91
00:04:12,569 --> 00:04:18,430
<font color="#CCCCCC">organization for example if you have a</font>

92
00:04:15,729 --> 00:04:21,130
slash 16<font color="#E5E5E5"> for some of you that</font><font color="#CCCCCC"> may be</font>

93
00:04:18,430 --> 00:04:24,310
astronomically huge<font color="#E5E5E5"> for others</font><font color="#CCCCCC"> of you</font>

94
00:04:21,130 --> 00:04:27,669
that may be small<font color="#CCCCCC"> so if you have a slash</font>

95
00:04:24,310 --> 00:04:28,150
<font color="#E5E5E5">16</font><font color="#CCCCCC"> you know a slash 24 might be enough</font>

96
00:04:27,669 --> 00:04:32,380
<font color="#E5E5E5">for you</font><font color="#CCCCCC"> to</font>

97
00:04:28,150 --> 00:04:34,210
do this<font color="#E5E5E5"> or you could do 224</font><font color="#CCCCCC"> or 225s I</font>

98
00:04:32,380 --> 00:04:36,669
mean<font color="#CCCCCC"> they you can kind of build it as</font>

99
00:04:34,210 --> 00:04:38,770
you please<font color="#CCCCCC"> if you've only got a handful</font>

100
00:04:36,669 --> 00:04:42,070
<font color="#E5E5E5">of addresses you may just say one</font>

101
00:04:38,770 --> 00:04:43,719
address is your<font color="#E5E5E5"> dartnet that's the one</font>

102
00:04:42,070 --> 00:04:48,190
address that nobody should<font color="#E5E5E5"> ever be</font>

103
00:04:43,720 --> 00:04:50,800
talking to<font color="#E5E5E5"> so build your dartnet</font>

104
00:04:48,190 --> 00:04:53,020
according to your size<font color="#E5E5E5"> and then make</font>

105
00:04:50,800 --> 00:04:55,120
sure that you that it's giving you what

106
00:04:53,020 --> 00:04:58,930
you<font color="#CCCCCC"> want</font><font color="#E5E5E5"> okay whatever you have the</font>

107
00:04:55,120 --> 00:05:03,880
spare so how do you build it<font color="#E5E5E5"> out for</font>

108
00:04:58,930 --> 00:05:05,710
example assuming that 10.0.0.0 was<font color="#CCCCCC"> /</font><font color="#E5E5E5"> 16</font>

109
00:05:03,880 --> 00:05:09,250
was actually public address base which

110
00:05:05,710 --> 00:05:11,530
is not but if it was and not<font color="#CCCCCC"> private</font><font color="#E5E5E5"> you</font>

111
00:05:09,250 --> 00:05:13,380
would want to<font color="#E5E5E5"> start possibly at</font><font color="#CCCCCC"> the</font>

112
00:05:11,530 --> 00:05:16,448
beginning of<font color="#CCCCCC"> that</font><font color="#E5E5E5"> address space and</font>

113
00:05:13,380 --> 00:05:17,770
potentially<font color="#E5E5E5"> also at the end so the idea</font>

114
00:05:16,449 --> 00:05:21,039
being<font color="#E5E5E5"> that if somebody's going</font><font color="#CCCCCC"> to</font>

115
00:05:17,770 --> 00:05:22,479
sequentially sequentially scan you which

116
00:05:21,039 --> 00:05:24,550
by the way<font color="#E5E5E5"> that's not always how it</font>

117
00:05:22,479 --> 00:05:27,550
happens<font color="#E5E5E5"> although</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is the default</font>

118
00:05:24,550 --> 00:05:30,400
<font color="#E5E5E5">behavior that you would see them before</font>

119
00:05:27,550 --> 00:05:32,020
<font color="#CCCCCC">they hit your network not while they're</font>

120
00:05:30,400 --> 00:05:36,070
in the<font color="#E5E5E5"> middle of your network if that</font>

121
00:05:32,020 --> 00:05:39,460
makes sense<font color="#CCCCCC"> okay we're not before but at</font>

122
00:05:36,070 --> 00:05:42,370
the very<font color="#E5E5E5"> beginning and if your address</font>

123
00:05:39,460 --> 00:05:44,680
space is<font color="#E5E5E5"> non continuous then at that</font>

124
00:05:42,370 --> 00:05:46,360
point you<font color="#E5E5E5"> kind of have to work it in and</font>

125
00:05:44,680 --> 00:05:48,220
it's really<font color="#E5E5E5"> up</font><font color="#CCCCCC"> to you you have to kind</font>

126
00:05:46,360 --> 00:05:51,310
of look at<font color="#CCCCCC"> it</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> say</font><font color="#E5E5E5"> okay if somebody's</font>

127
00:05:48,220 --> 00:05:53,680
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> scan my network are they some</font>

128
00:05:51,310 --> 00:05:56,830
at some<font color="#CCCCCC"> point along</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> way I want to</font><font color="#E5E5E5"> be</font>

129
00:05:53,680 --> 00:05:59,199
able<font color="#CCCCCC"> to stop them</font><font color="#E5E5E5"> and block them and</font>

130
00:05:56,830 --> 00:06:01,599
keep them<font color="#CCCCCC"> from coming</font><font color="#E5E5E5"> into my network so</font>

131
00:05:59,199 --> 00:06:04,930
planet wisely think about it<font color="#E5E5E5"> tactically</font>

132
00:06:01,599 --> 00:06:06,219
how does it affect your network<font color="#E5E5E5"> how</font>

133
00:06:04,930 --> 00:06:09,460
<font color="#CCCCCC">would they look at your network how</font>

134
00:06:06,220 --> 00:06:11,710
would they see it<font color="#E5E5E5"> so let's go</font><font color="#CCCCCC"> right into</font>

135
00:06:09,460 --> 00:06:13,359
the config so on the Palo Alto<font color="#CCCCCC"> the very</font>

136
00:06:11,710 --> 00:06:15,580
first place that<font color="#CCCCCC"> you're going to start</font>

137
00:06:13,360 --> 00:06:18,190
is you're<font color="#CCCCCC"> going to create</font><font color="#E5E5E5"> a darknet zone</font>

138
00:06:15,580 --> 00:06:22,479
now this is basically an identifier that

139
00:06:18,190 --> 00:06:25,810
<font color="#E5E5E5">says hey I am going to take and build in</font>

140
00:06:22,479 --> 00:06:27,669
a zone<font color="#E5E5E5"> in</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the Palo Alto that I'm</font>

141
00:06:25,810 --> 00:06:29,889
gonna<font color="#E5E5E5"> call it dark net and then we're</font>

142
00:06:27,669 --> 00:06:32,440
<font color="#E5E5E5">going to assign some things to that</font>

143
00:06:29,889 --> 00:06:34,270
<font color="#E5E5E5">you're gonna take by the way all these</font>

144
00:06:32,440 --> 00:06:36,250
slides will be posted on the<font color="#CCCCCC"> website</font><font color="#E5E5E5"> so</font>

145
00:06:34,270 --> 00:06:37,810
<font color="#E5E5E5">don't feel like you have</font><font color="#CCCCCC"> to do it all</font>

146
00:06:36,250 --> 00:06:39,669
while I'm<font color="#CCCCCC"> talking I'm gonna walk you</font>

147
00:06:37,810 --> 00:06:40,220
through<font color="#E5E5E5"> it then you can take it</font><font color="#CCCCCC"> back and</font>

148
00:06:39,669 --> 00:06:42,620
do

149
00:06:40,220 --> 00:06:44,590
later if<font color="#CCCCCC"> you'd like</font><font color="#E5E5E5"> after that you're</font>

150
00:06:42,620 --> 00:06:47,150
gonna tie your<font color="#CCCCCC"> dart</font><font color="#E5E5E5"> net to an interface</font>

151
00:06:44,590 --> 00:06:49,549
<font color="#E5E5E5">it's important that it</font><font color="#CCCCCC"> is actually</font><font color="#E5E5E5"> tied</font>

152
00:06:47,150 --> 00:06:51,289
<font color="#CCCCCC">to a specific interface</font><font color="#E5E5E5"> even</font><font color="#CCCCCC"> if there is</font>

153
00:06:49,550 --> 00:06:53,900
literally nothing on the other side<font color="#CCCCCC"> of</font>

154
00:06:51,290 --> 00:06:55,910
that interface<font color="#E5E5E5"> okay so you can create a</font>

155
00:06:53,900 --> 00:06:57,770
virtual<font color="#E5E5E5"> interface you can create an</font>

156
00:06:55,910 --> 00:06:59,810
interface<font color="#CCCCCC"> that</font><font color="#E5E5E5"> is a sub interface</font>

157
00:06:57,770 --> 00:07:02,210
whatever you want to do with<font color="#CCCCCC"> it but tie</font>

158
00:06:59,810 --> 00:07:05,860
it to an<font color="#CCCCCC"> interface and</font><font color="#E5E5E5"> then you're going</font>

159
00:07:02,210 --> 00:07:08,210
<font color="#E5E5E5">to attach it</font><font color="#CCCCCC"> to a virtual router and</font>

160
00:07:05,860 --> 00:07:13,640
then attach<font color="#CCCCCC"> it to the security zone</font>

161
00:07:08,210 --> 00:07:17,330
<font color="#E5E5E5">darknet okay once you've done</font><font color="#CCCCCC"> that you</font>

162
00:07:13,640 --> 00:07:19,909
<font color="#CCCCCC">want to go</font><font color="#E5E5E5"> into the ipv4 section or the</font>

163
00:07:17,330 --> 00:07:22,580
ipv6 section and assign<font color="#CCCCCC"> it that address</font>

164
00:07:19,910 --> 00:07:24,620
space<font color="#E5E5E5"> so</font><font color="#CCCCCC"> if you've got multiple address</font>

165
00:07:22,580 --> 00:07:26,870
spaces<font color="#CCCCCC"> you would put all of those</font>

166
00:07:24,620 --> 00:07:29,060
address spaces<font color="#E5E5E5"> in there you're going to</font>

167
00:07:26,870 --> 00:07:30,500
<font color="#E5E5E5">have to do the backend</font><font color="#CCCCCC"> routing on the</font>

168
00:07:29,060 --> 00:07:32,540
device that's<font color="#E5E5E5"> in front of it if it's</font>

169
00:07:30,500 --> 00:07:34,910
doing dynamic<font color="#CCCCCC"> routing then they</font><font color="#E5E5E5"> the Palo</font>

170
00:07:32,540 --> 00:07:36,830
Alto welcome will talk directly to<font color="#E5E5E5"> it if</font>

171
00:07:34,910 --> 00:07:37,970
it's not if it's doing static<font color="#E5E5E5"> then</font>

172
00:07:36,830 --> 00:07:40,640
you're gonna have<font color="#E5E5E5"> to configure the</font>

173
00:07:37,970 --> 00:07:43,820
routing<font color="#E5E5E5"> to make sure that that network</font>

174
00:07:40,640 --> 00:07:44,960
hits that firewall<font color="#E5E5E5"> that makes sense but</font>

175
00:07:43,820 --> 00:07:47,719
<font color="#E5E5E5">you're going to attach it</font><font color="#CCCCCC"> to that</font>

176
00:07:44,960 --> 00:07:50,810
particular address and you're going<font color="#E5E5E5"> to</font>

177
00:07:47,720 --> 00:07:52,850
do it on the Palo Alto<font color="#E5E5E5"> and then you're</font>

178
00:07:50,810 --> 00:07:55,040
going<font color="#E5E5E5"> to create a syslog server profile</font>

179
00:07:52,850 --> 00:07:56,479
now<font color="#E5E5E5"> on the Palo Alto you have to do</font>

180
00:07:55,040 --> 00:07:59,630
several<font color="#CCCCCC"> different</font><font color="#E5E5E5"> things in order</font><font color="#CCCCCC"> to</font>

181
00:07:56,479 --> 00:08:01,430
<font color="#CCCCCC">make</font><font color="#E5E5E5"> it actually get to the point where</font>

182
00:07:59,630 --> 00:08:05,210
you can send sis logs<font color="#E5E5E5"> out to your</font>

183
00:08:01,430 --> 00:08:07,130
syslog-ng box and the<font color="#E5E5E5"> servers so you go</font>

184
00:08:05,210 --> 00:08:09,560
to a syslog get server profile create a

185
00:08:07,130 --> 00:08:10,120
new<font color="#E5E5E5"> probe profile you can call it what</font>

186
00:08:09,560 --> 00:08:12,440
<font color="#CCCCCC">you like</font>

187
00:08:10,120 --> 00:08:14,570
you're gonna then add the name<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

188
00:08:12,440 --> 00:08:17,479
server<font color="#CCCCCC"> you're gonna put the IP address</font>

189
00:08:14,570 --> 00:08:19,280
in the<font color="#E5E5E5"> syslog server</font><font color="#CCCCCC"> you're going to</font>

190
00:08:17,479 --> 00:08:20,930
tell it that<font color="#E5E5E5"> it's UDP assuming that it</font>

191
00:08:19,280 --> 00:08:25,369
<font color="#CCCCCC">is on five fourteen which</font><font color="#E5E5E5"> is the default</font>

192
00:08:20,930 --> 00:08:27,380
syslog port and then you're going<font color="#E5E5E5"> to set</font>

193
00:08:25,370 --> 00:08:29,330
<font color="#E5E5E5">that after that you're gonna go into the</font>

194
00:08:27,380 --> 00:08:31,280
custom log<font color="#E5E5E5"> format and we're gonna</font>

195
00:08:29,330 --> 00:08:33,890
<font color="#E5E5E5">actually use</font><font color="#CCCCCC"> a custom</font><font color="#E5E5E5"> log format and</font>

196
00:08:31,280 --> 00:08:37,069
I'll show<font color="#E5E5E5"> you why in a minute why we use</font>

197
00:08:33,890 --> 00:08:38,718
<font color="#E5E5E5">that because in the end we're looking to</font>

198
00:08:37,070 --> 00:08:41,990
do something<font color="#E5E5E5"> that</font><font color="#CCCCCC"> looks</font><font color="#E5E5E5"> kind of like</font>

199
00:08:38,719 --> 00:08:45,410
<font color="#CCCCCC">that</font><font color="#E5E5E5"> now that's really really hard to</font>

200
00:08:41,990 --> 00:08:49,690
see because<font color="#CCCCCC"> it's really really</font><font color="#E5E5E5"> small for</font>

201
00:08:45,410 --> 00:08:51,810
you guys and I'm trying<font color="#E5E5E5"> to remember</font>

202
00:08:49,690 --> 00:08:54,930
<font color="#E5E5E5">there we go</font>

203
00:08:51,810 --> 00:08:56,670
maybe that's a<font color="#E5E5E5"> little easier to see</font><font color="#CCCCCC"> so</font>

204
00:08:54,930 --> 00:09:00,750
we're looking<font color="#E5E5E5"> for something like that</font>

205
00:08:56,670 --> 00:09:02,579
<font color="#E5E5E5">okay and if we put it in a cup to a</font>

206
00:09:00,750 --> 00:09:05,580
custom log format<font color="#CCCCCC"> you can create a</font>

207
00:09:02,580 --> 00:09:08,160
dashboard that<font color="#E5E5E5"> shows where the scans are</font>

208
00:09:05,580 --> 00:09:09,750
coming in and then ultimately<font color="#E5E5E5"> what's</font>

209
00:09:08,160 --> 00:09:11,969
being blocked<font color="#CCCCCC"> and I've actually</font>

210
00:09:09,750 --> 00:09:14,340
distributed the code that's available on

211
00:09:11,970 --> 00:09:15,870
<font color="#CCCCCC">the</font><font color="#E5E5E5"> website to do this and we'll walk</font>

212
00:09:14,340 --> 00:09:18,360
<font color="#E5E5E5">you through kind of the steps to set</font>

213
00:09:15,870 --> 00:09:20,540
<font color="#E5E5E5">this up but essentially that's kind of</font>

214
00:09:18,360 --> 00:09:22,860
what we're after<font color="#E5E5E5"> in this presentation</font>

215
00:09:20,540 --> 00:09:25,680
along<font color="#CCCCCC"> with the blocking</font><font color="#E5E5E5"> that's actually</font>

216
00:09:22,860 --> 00:09:30,480
happening on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> other side so we go in</font>

217
00:09:25,680 --> 00:09:32,030
we set a custom log format and it's

218
00:09:30,480 --> 00:09:34,500
going<font color="#E5E5E5"> to look something like this</font>

219
00:09:32,030 --> 00:09:37,500
we can<font color="#CCCCCC"> actually go</font><font color="#E5E5E5"> in the Palo Alto</font><font color="#CCCCCC"> we</font>

220
00:09:34,500 --> 00:09:39,480
<font color="#E5E5E5">can say hey I want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use the scan from</font>

221
00:09:37,500 --> 00:09:42,630
<font color="#E5E5E5">and then you're going to dollar sign</font>

222
00:09:39,480 --> 00:09:45,420
source<font color="#CCCCCC"> - dollar sign destination</font><font color="#E5E5E5"> DST and</font>

223
00:09:42,630 --> 00:09:48,240
then we're gonna pipe in the protocol

224
00:09:45,420 --> 00:09:50,790
the destination port and if part

225
00:09:48,240 --> 00:09:52,380
<font color="#CCCCCC">perchance the Palo Alto identifies the</font>

226
00:09:50,790 --> 00:09:55,349
app which it usually<font color="#CCCCCC"> doesn't because</font>

227
00:09:52,380 --> 00:09:57,570
this is not<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> be talking</font>

228
00:09:55,350 --> 00:10:02,040
to anything<font color="#E5E5E5"> I throw the app in there</font>

229
00:09:57,570 --> 00:10:04,980
just<font color="#E5E5E5"> in case then you're going to create</font>

230
00:10:02,040 --> 00:10:06,270
<font color="#E5E5E5">your custom log</font><font color="#CCCCCC"> forward email okay so</font>

231
00:10:04,980 --> 00:10:09,780
you have<font color="#E5E5E5"> to create a log forwarding</font>

232
00:10:06,270 --> 00:10:14,010
profile<font color="#CCCCCC"> once you've done that</font><font color="#E5E5E5"> you assign</font>

233
00:10:09,780 --> 00:10:16,140
it<font color="#E5E5E5"> directly to the to the syslog server</font>

234
00:10:14,010 --> 00:10:21,780
profile that you<font color="#E5E5E5"> created earlier</font>

235
00:10:16,140 --> 00:10:23,939
okay same<font color="#E5E5E5"> thing here create your custom</font>

236
00:10:21,780 --> 00:10:26,130
log forwarding this<font color="#E5E5E5"> is the next screen</font>

237
00:10:23,940 --> 00:10:28,080
then it<font color="#CCCCCC"> brings you in it</font><font color="#E5E5E5"> basically</font>

238
00:10:26,130 --> 00:10:30,960
pushes it to that syslog server

239
00:10:28,080 --> 00:10:34,830
and afterwards you need<font color="#E5E5E5"> to create a</font>

240
00:10:30,960 --> 00:10:36,660
policy so in your policies this is

241
00:10:34,830 --> 00:10:38,240
something you<font color="#E5E5E5"> want to put probably at</font>

242
00:10:36,660 --> 00:10:40,890
the<font color="#CCCCCC"> end you can put it</font><font color="#E5E5E5"> at the beginning</font>

243
00:10:38,240 --> 00:10:42,720
<font color="#CCCCCC">it really doesn't matter because nothing</font>

244
00:10:40,890 --> 00:10:44,069
else should<font color="#CCCCCC"> be hitting that it shouldn't</font>

245
00:10:42,720 --> 00:10:46,140
well actually it's probably<font color="#E5E5E5"> better at</font>

246
00:10:44,070 --> 00:10:48,810
the beginning to be<font color="#E5E5E5"> honest and I'm not</font>

247
00:10:46,140 --> 00:10:51,960
sure why I put at the<font color="#E5E5E5"> end I'll have to</font>

248
00:10:48,810 --> 00:10:53,910
<font color="#E5E5E5">change that slide but in the end what</font>

249
00:10:51,960 --> 00:10:55,790
you want to do is a<font color="#E5E5E5"> catch-all that</font>

250
00:10:53,910 --> 00:11:00,030
anything that<font color="#E5E5E5"> hits that address space</font>

251
00:10:55,790 --> 00:11:01,890
gets stuffed into<font color="#E5E5E5"> this policy it's</font>

252
00:11:00,030 --> 00:11:04,079
critical<font color="#CCCCCC"> that the policy catches</font>

253
00:11:01,890 --> 00:11:05,340
everything<font color="#E5E5E5"> that hits there so if you've</font>

254
00:11:04,080 --> 00:11:07,400
got other<font color="#E5E5E5"> room</font>

255
00:11:05,340 --> 00:11:10,050
tools<font color="#E5E5E5"> that can</font><font color="#CCCCCC"> potentially let things in</font>

256
00:11:07,400 --> 00:11:12,990
then this<font color="#E5E5E5"> is why you would want to put</font>

257
00:11:10,050 --> 00:11:14,670
it at<font color="#E5E5E5"> the</font><font color="#CCCCCC"> beginning so you go to source</font>

258
00:11:12,990 --> 00:11:16,110
<font color="#E5E5E5">you say the source is the outside</font>

259
00:11:14,670 --> 00:11:18,300
<font color="#E5E5E5">because</font><font color="#CCCCCC"> we don't</font><font color="#E5E5E5"> want to necessarily</font>

260
00:11:16,110 --> 00:11:22,440
catch<font color="#CCCCCC"> it internal traffic</font><font color="#E5E5E5"> and start</font>

261
00:11:18,300 --> 00:11:24,719
blocking<font color="#E5E5E5"> that the destination is the</font>

262
00:11:22,440 --> 00:11:26,670
darknet<font color="#CCCCCC"> okay so that particular zone</font>

263
00:11:24,720 --> 00:11:29,520
<font color="#CCCCCC">that we've assigned it and then</font>

264
00:11:26,670 --> 00:11:31,469
basically based on<font color="#E5E5E5"> the interface tie and</font>

265
00:11:29,520 --> 00:11:33,569
<font color="#E5E5E5">assigning that zone to that interface</font>

266
00:11:31,470 --> 00:11:35,670
and<font color="#CCCCCC"> then assigning</font><font color="#E5E5E5"> those IP</font><font color="#CCCCCC"> addresses</font><font color="#E5E5E5"> it</font>

267
00:11:33,570 --> 00:11:38,640
will only catch<font color="#E5E5E5"> things that go to that</font>

268
00:11:35,670 --> 00:11:42,170
<font color="#E5E5E5">interface to that zone and then we're</font>

269
00:11:38,640 --> 00:11:45,840
gonna do an action which is<font color="#E5E5E5"> deny and</font>

270
00:11:42,170 --> 00:11:47,520
we're going to<font color="#E5E5E5"> put it the</font><font color="#CCCCCC"> long</font>

271
00:11:45,840 --> 00:11:49,140
forwarding is the critical<font color="#E5E5E5"> piece here</font>

272
00:11:47,520 --> 00:11:53,540
<font color="#E5E5E5">because</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is where we want to say</font>

273
00:11:49,140 --> 00:11:56,880
send anything<font color="#E5E5E5"> that happens here</font><font color="#CCCCCC"> over to</font>

274
00:11:53,540 --> 00:12:01,620
your log server in that<font color="#E5E5E5"> custom format</font>

275
00:11:56,880 --> 00:12:05,370
that we declared<font color="#CCCCCC"> okay so then we go</font><font color="#E5E5E5"> into</font>

276
00:12:01,620 --> 00:12:07,050
syslog-ng<font color="#CCCCCC"> and at this point your Palo</font>

277
00:12:05,370 --> 00:12:08,910
Alto should be forwarding logs to your

278
00:12:07,050 --> 00:12:11,760
syslog-ng<font color="#E5E5E5"> servers that looks something</font>

279
00:12:08,910 --> 00:12:13,709
like this<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so you see should see</font>

280
00:12:11,760 --> 00:12:16,319
logs I've<font color="#E5E5E5"> I've commented out the IP</font>

281
00:12:13,710 --> 00:12:17,850
addresses<font color="#E5E5E5"> now in the code it's doing</font>

282
00:12:16,320 --> 00:12:21,870
that as well<font color="#E5E5E5"> you notice</font><font color="#CCCCCC"> that on the</font>

283
00:12:17,850 --> 00:12:23,760
screen<font color="#CCCCCC"> okay that'll actually</font><font color="#E5E5E5"> show IP</font>

284
00:12:21,870 --> 00:12:26,940
addresses for you guys but<font color="#E5E5E5"> I did that</font>

285
00:12:23,760 --> 00:12:29,700
<font color="#E5E5E5">for this presentation and</font><font color="#CCCCCC"> it shows that</font>

286
00:12:26,940 --> 00:12:33,330
there's a scan from<font color="#E5E5E5"> a certain address</font>

287
00:12:29,700 --> 00:12:36,570
<font color="#CCCCCC">and it's</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to a certain address</font><font color="#E5E5E5"> and</font>

288
00:12:33,330 --> 00:12:40,200
then<font color="#E5E5E5"> the relevant</font><font color="#CCCCCC"> information about</font><font color="#E5E5E5"> that</font>

289
00:12:36,570 --> 00:12:42,150
scan<font color="#E5E5E5"> okay so you should</font><font color="#CCCCCC"> see those logs</font>

290
00:12:40,200 --> 00:12:44,160
start flowing in but now at<font color="#E5E5E5"> this point</font>

291
00:12:42,150 --> 00:12:46,620
we<font color="#CCCCCC"> want to actually filter</font><font color="#E5E5E5"> them so</font>

292
00:12:44,160 --> 00:12:48,930
syslog-ng has a really cool function<font color="#E5E5E5"> in</font>

293
00:12:46,620 --> 00:12:52,410
which you can<font color="#CCCCCC"> actually go in</font><font color="#E5E5E5"> you can say</font>

294
00:12:48,930 --> 00:12:55,380
hey I want<font color="#CCCCCC"> to filter</font><font color="#E5E5E5"> how these logs flow</font>

295
00:12:52,410 --> 00:12:58,650
in and what files they go into<font color="#E5E5E5"> so we</font>

296
00:12:55,380 --> 00:13:01,080
want to in this<font color="#E5E5E5"> at sea syslog-ng compte</font>

297
00:12:58,650 --> 00:13:04,020
directory we want to create<font color="#E5E5E5"> a file and</font>

298
00:13:01,080 --> 00:13:05,640
<font color="#E5E5E5">call it dark net comp</font><font color="#CCCCCC"> okay and at the</font>

299
00:13:04,020 --> 00:13:09,390
<font color="#E5E5E5">very top of</font><font color="#CCCCCC"> the file we need to start</font>

300
00:13:05,640 --> 00:13:11,850
with a sources saying any<font color="#E5E5E5"> sis logs</font>

301
00:13:09,390 --> 00:13:14,520
coming in on UDP this is how we're going

302
00:13:11,850 --> 00:13:18,420
to<font color="#E5E5E5"> work</font><font color="#CCCCCC"> with them so we have a source</font>

303
00:13:14,520 --> 00:13:19,079
and then we need a destination<font color="#CCCCCC"> so this</font>

304
00:13:18,420 --> 00:13:21,360
is basically

305
00:13:19,080 --> 00:13:23,820
the file<font color="#E5E5E5"> that we're going to stuff all</font>

306
00:13:21,360 --> 00:13:26,850
<font color="#E5E5E5">these logs into in this case we're gonna</font>

307
00:13:23,820 --> 00:13:29,610
create a<font color="#CCCCCC"> destination called DF darknet</font>

308
00:13:26,850 --> 00:13:32,730
and the file we're gonna put in<font color="#E5E5E5"> VAR log</font>

309
00:13:29,610 --> 00:13:36,630
<font color="#E5E5E5">dartnet log we're gonna assign the owner</font>

310
00:13:32,730 --> 00:13:39,810
as a root and then<font color="#E5E5E5"> the group as</font><font color="#CCCCCC"> W W data</font>

311
00:13:36,630 --> 00:13:42,000
or<font color="#E5E5E5"> whatever is running the group</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> your</font>

312
00:13:39,810 --> 00:13:44,849
<font color="#E5E5E5">web server</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> this is a critical</font>

313
00:13:42,000 --> 00:13:47,010
<font color="#E5E5E5">component you might go why are we giving</font>

314
00:13:44,850 --> 00:13:51,060
the web server access to this log well

315
00:13:47,010 --> 00:13:53,010
that's important<font color="#E5E5E5"> to do with this okay</font>

316
00:13:51,060 --> 00:13:55,319
the web server needs to<font color="#E5E5E5"> be able to see</font>

317
00:13:53,010 --> 00:13:58,530
those logs<font color="#E5E5E5"> and at least read them in</font>

318
00:13:55,320 --> 00:14:02,520
order<font color="#CCCCCC"> to be able to generate</font><font color="#E5E5E5"> this kind</font>

319
00:13:58,530 --> 00:14:05,189
<font color="#E5E5E5">of log file that's tailing okay so we're</font>

320
00:14:02,520 --> 00:14:08,189
gonna<font color="#E5E5E5"> start with that and then we're</font>

321
00:14:05,190 --> 00:14:10,530
gonna<font color="#E5E5E5"> create a filter so the</font><font color="#CCCCCC"> filter</font>

322
00:14:08,190 --> 00:14:14,700
basically<font color="#CCCCCC"> it can start</font><font color="#E5E5E5"> as easy as this</font>

323
00:14:10,530 --> 00:14:17,040
if you have one<font color="#E5E5E5"> only one firewall</font><font color="#CCCCCC"> that's</font>

324
00:14:14,700 --> 00:14:18,780
basically peeling these logs out<font color="#E5E5E5"> and</font>

325
00:14:17,040 --> 00:14:20,370
<font color="#E5E5E5">that's a recommended practice if you've</font>

326
00:14:18,780 --> 00:14:22,709
got a firewall<font color="#E5E5E5"> that you can spare that</font>

327
00:14:20,370 --> 00:14:24,680
can do this<font color="#E5E5E5"> that can be kind of a lab</font>

328
00:14:22,710 --> 00:14:26,880
firewall<font color="#E5E5E5"> darknet firewall type</font>

329
00:14:24,680 --> 00:14:28,560
environment<font color="#E5E5E5"> and that's great if you</font>

330
00:14:26,880 --> 00:14:31,290
don't<font color="#E5E5E5"> and it's just hitting your main</font>

331
00:14:28,560 --> 00:14:32,729
firewall<font color="#E5E5E5"> that's fine too</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> you're</font>

332
00:14:31,290 --> 00:14:35,430
gonna have<font color="#E5E5E5"> to get a little more detailed</font>

333
00:14:32,730 --> 00:14:37,710
so in this case what we're saying is in

334
00:14:35,430 --> 00:14:39,420
this<font color="#E5E5E5"> first one I've only got one</font>

335
00:14:37,710 --> 00:14:42,570
firewall<font color="#CCCCCC"> any logs</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> are coming from</font>

336
00:14:39,420 --> 00:14:44,819
it are from<font color="#E5E5E5"> the darknet otherwise you're</font>

337
00:14:42,570 --> 00:14:46,230
probably<font color="#CCCCCC"> more likely to want</font><font color="#E5E5E5"> something</font>

338
00:14:44,820 --> 00:14:47,610
like this<font color="#CCCCCC"> well</font><font color="#E5E5E5"> it's coming from this</font>

339
00:14:46,230 --> 00:14:49,470
firewall<font color="#CCCCCC"> okay</font>

340
00:14:47,610 --> 00:14:51,540
there's the net mask and the end

341
00:14:49,470 --> 00:14:53,730
<font color="#E5E5E5">syslog-ng</font><font color="#CCCCCC"> you're you're gonna have to</font>

342
00:14:51,540 --> 00:14:57,599
make<font color="#CCCCCC"> sure you use it</font><font color="#E5E5E5"> inside our notation</font>

343
00:14:53,730 --> 00:15:00,090
<font color="#E5E5E5">so a slash 32 is a single host okay so</font>

344
00:14:57,600 --> 00:15:01,920
you<font color="#E5E5E5"> just put the IP address of the</font>

345
00:15:00,090 --> 00:15:04,230
firewall where it's going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be sending</font>

346
00:15:01,920 --> 00:15:06,089
it<font color="#E5E5E5"> from now the firewalls</font><font color="#CCCCCC"> have multiple</font>

347
00:15:04,230 --> 00:15:08,250
interfaces<font color="#CCCCCC"> sometimes so you've got to</font>

348
00:15:06,090 --> 00:15:11,010
make<font color="#E5E5E5"> sure you know exactly</font><font color="#CCCCCC"> what IP</font>

349
00:15:08,250 --> 00:15:14,370
address it's sending<font color="#E5E5E5"> it from and then</font>

350
00:15:11,010 --> 00:15:16,620
the message<font color="#CCCCCC"> scan from or message threat</font>

351
00:15:14,370 --> 00:15:18,600
from you notice that language that<font color="#CCCCCC"> we</font>

352
00:15:16,620 --> 00:15:21,180
used when we<font color="#CCCCCC"> created that custom log</font>

353
00:15:18,600 --> 00:15:23,730
format okay<font color="#CCCCCC"> and we did</font><font color="#E5E5E5"> that on the</font>

354
00:15:21,180 --> 00:15:27,719
<font color="#CCCCCC">firewall</font><font color="#E5E5E5"> when we created that so it's</font>

355
00:15:23,730 --> 00:15:31,740
looking for those<font color="#CCCCCC"> key words coming from</font>

356
00:15:27,720 --> 00:15:32,640
<font color="#E5E5E5">that firewall and then lastly we're</font>

357
00:15:31,740 --> 00:15:35,580
<font color="#E5E5E5">gonna tie it</font>

358
00:15:32,640 --> 00:15:38,130
together with a log declaration<font color="#E5E5E5"> now what</font>

359
00:15:35,580 --> 00:15:41,970
this does<font color="#E5E5E5"> is it says</font><font color="#CCCCCC"> if the source is</font>

360
00:15:38,130 --> 00:15:45,950
UDP run it<font color="#E5E5E5"> through the filter</font><font color="#CCCCCC"> darknet</font>

361
00:15:41,970 --> 00:15:49,710
that we just created back<font color="#E5E5E5"> here okay</font>

362
00:15:45,950 --> 00:15:53,070
there's<font color="#E5E5E5"> that filter okay</font><font color="#CCCCCC"> and if it</font>

363
00:15:49,710 --> 00:15:56,130
matches<font color="#E5E5E5"> this filter then stuff it in the</font>

364
00:15:53,070 --> 00:15:58,620
destination<font color="#CCCCCC"> DF darknet which we declared</font>

365
00:15:56,130 --> 00:16:00,990
right here which means<font color="#CCCCCC"> that it's</font><font color="#E5E5E5"> going</font>

366
00:15:58,620 --> 00:16:03,660
<font color="#E5E5E5">to stuff it in this VAR log darknet</font><font color="#CCCCCC"> the</font>

367
00:16:00,990 --> 00:16:05,310
log file<font color="#E5E5E5"> and that's ultimately what</font>

368
00:16:03,660 --> 00:16:07,949
we're<font color="#CCCCCC"> trying to</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> we're trying</font><font color="#CCCCCC"> to</font>

369
00:16:05,310 --> 00:16:12,000
<font color="#E5E5E5">take all of your logs that</font><font color="#CCCCCC"> are that are</font>

370
00:16:07,950 --> 00:16:15,830
being<font color="#CCCCCC"> collected by this dark net this</font>

371
00:16:12,000 --> 00:16:18,870
darkness<font color="#E5E5E5"> e and stuff them</font><font color="#CCCCCC"> into that file</font>

372
00:16:15,830 --> 00:16:21,600
so at<font color="#E5E5E5"> that point you should</font><font color="#CCCCCC"> have a file</font>

373
00:16:18,870 --> 00:16:26,580
<font color="#CCCCCC">that shows up</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> var log</font><font color="#E5E5E5"> grep dark net</font>

374
00:16:21,600 --> 00:16:28,440
<font color="#CCCCCC">okay it called dark net dot log</font><font color="#E5E5E5"> and then</font>

375
00:16:26,580 --> 00:16:30,360
you want to<font color="#E5E5E5"> set up a log rotate</font>

376
00:16:28,440 --> 00:16:31,740
obviously because otherwise what's gonna

377
00:16:30,360 --> 00:16:34,170
happen is that<font color="#E5E5E5"> file is going</font><font color="#CCCCCC"> to get</font>

378
00:16:31,740 --> 00:16:38,070
<font color="#E5E5E5">massive</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so we're gonna create</font><font color="#CCCCCC"> a</font>

379
00:16:34,170 --> 00:16:40,560
<font color="#E5E5E5">Nessie log rotate dark net</font><font color="#CCCCCC"> log rotate D</font>

380
00:16:38,070 --> 00:16:43,920
dark net file and in it we're gonna

381
00:16:40,560 --> 00:16:46,050
stuff in this<font color="#E5E5E5"> information so in here</font>

382
00:16:43,920 --> 00:16:49,020
you've got your dark net<font color="#CCCCCC"> VAR log dark</font>

383
00:16:46,050 --> 00:16:51,900
net that log and you're saying<font color="#E5E5E5"> I want</font><font color="#CCCCCC"> to</font>

384
00:16:49,020 --> 00:16:56,100
rotate<font color="#E5E5E5"> it every 14 days well basically</font>

385
00:16:51,900 --> 00:16:58,699
<font color="#E5E5E5">means that every</font><font color="#CCCCCC"> for 14 iterations okay</font>

386
00:16:56,100 --> 00:17:02,550
I want to<font color="#E5E5E5"> keep 14 iterations of it</font><font color="#CCCCCC"> I</font>

387
00:16:58,700 --> 00:17:04,650
want to do it daily<font color="#E5E5E5"> okay and the rest of</font>

388
00:17:02,550 --> 00:17:06,690
<font color="#CCCCCC">this stuff I won't even</font><font color="#E5E5E5"> worry about but</font>

389
00:17:04,650 --> 00:17:09,240
essentially what you're gonna<font color="#E5E5E5"> end up</font>

390
00:17:06,690 --> 00:17:11,550
<font color="#E5E5E5">with is you're gonna end up</font><font color="#CCCCCC"> with 14 log</font>

391
00:17:09,240 --> 00:17:13,980
files<font color="#CCCCCC"> okay that's two weeks worth of</font>

392
00:17:11,550 --> 00:17:16,770
dark net information and it's going<font color="#CCCCCC"> to</font>

393
00:17:13,980 --> 00:17:19,319
rotate them on a<font color="#E5E5E5"> daily basis it will</font>

394
00:17:16,770 --> 00:17:20,940
<font color="#CCCCCC">also compress them</font><font color="#E5E5E5"> okay so if you get</font>

395
00:17:19,319 --> 00:17:22,649
older ones they're gonna compress it so

396
00:17:20,940 --> 00:17:27,930
<font color="#E5E5E5">you're</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> going to be using up tons of</font>

397
00:17:22,650 --> 00:17:30,630
disk space<font color="#CCCCCC"> so that will</font><font color="#E5E5E5"> make it rotate</font>

398
00:17:27,930 --> 00:17:34,500
daily so after 14 days<font color="#E5E5E5"> you'll have</font><font color="#CCCCCC"> a set</font>

399
00:17:30,630 --> 00:17:36,600
of files<font color="#E5E5E5"> that'll look like that okay</font>

400
00:17:34,500 --> 00:17:38,640
enough to wait 14 days to<font color="#E5E5E5"> see that many</font>

401
00:17:36,600 --> 00:17:40,740
but after the first<font color="#E5E5E5"> day you should at</font>

402
00:17:38,640 --> 00:17:42,420
<font color="#E5E5E5">least see dartnet</font><font color="#CCCCCC"> log in the second day</font>

403
00:17:40,740 --> 00:17:44,490
<font color="#CCCCCC">you should</font><font color="#E5E5E5"> see dark net</font><font color="#CCCCCC"> dialogue got one</font>

404
00:17:42,420 --> 00:17:46,419
<font color="#E5E5E5">and if you're seeing</font><font color="#CCCCCC"> that then you'll</font>

405
00:17:44,490 --> 00:17:52,480
see the rest of the field<font color="#CCCCCC"> see the rest</font>

406
00:17:46,419 --> 00:17:55,450
the you<font color="#E5E5E5"> know files shortly that so in</font>

407
00:17:52,480 --> 00:17:58,749
<font color="#CCCCCC">Apache PHP</font><font color="#E5E5E5"> you're gonna want to go to</font>

408
00:17:55,450 --> 00:18:01,929
super<font color="#E5E5E5"> tech</font><font color="#CCCCCC"> I comm slash training okay</font>

409
00:17:58,749 --> 00:18:04,239
<font color="#E5E5E5">and there I've got posted all that</font>

410
00:18:01,929 --> 00:18:06,340
information regarding the PHP code<font color="#CCCCCC"> we're</font>

411
00:18:04,239 --> 00:18:08,169
<font color="#E5E5E5">not going to go</font><font color="#CCCCCC"> over all of it</font><font color="#E5E5E5"> because</font>

412
00:18:06,340 --> 00:18:10,418
there's no<font color="#E5E5E5"> point in boring you with</font><font color="#CCCCCC"> a</font>

413
00:18:08,169 --> 00:18:14,489
whole<font color="#E5E5E5"> bunch of lines of code more than I</font>

414
00:18:10,419 --> 00:18:19,960
already am<font color="#CCCCCC"> you're gonna pull the log -</font>

415
00:18:14,489 --> 00:18:24,639
<font color="#E5E5E5">tar.gz</font><font color="#CCCCCC"> and in that tarball is all the</font>

416
00:18:19,960 --> 00:18:25,840
code to<font color="#CCCCCC"> run this and in the end you</font>

417
00:18:24,639 --> 00:18:29,889
<font color="#CCCCCC">should get something</font><font color="#E5E5E5"> that looks like</font>

418
00:18:25,840 --> 00:18:33,699
<font color="#E5E5E5">this</font><font color="#CCCCCC"> although</font><font color="#E5E5E5"> you won't have this bottom</font>

419
00:18:29,889 --> 00:18:35,738
section<font color="#E5E5E5"> right</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> okay the codes fairly</font>

420
00:18:33,700 --> 00:18:37,480
explanatory<font color="#CCCCCC"> feel</font><font color="#E5E5E5"> free to reach out to me</font>

421
00:18:35,739 --> 00:18:39,509
if<font color="#CCCCCC"> you have any questions or concerns or</font>

422
00:18:37,480 --> 00:18:42,850
your frustrations with<font color="#E5E5E5"> it</font>

423
00:18:39,509 --> 00:18:45,879
you're also going to pull a PHP<font color="#E5E5E5"> skit or</font>

424
00:18:42,850 --> 00:18:49,869
<font color="#CCCCCC">a script called dart net underscore</font><font color="#E5E5E5"> IPs</font>

425
00:18:45,879 --> 00:18:54,219
PHP and this particular<font color="#E5E5E5"> script is used</font>

426
00:18:49,869 --> 00:18:57,459
to basically<font color="#E5E5E5"> build that list</font><font color="#CCCCCC"> okay so the</font>

427
00:18:54,220 --> 00:19:00,460
Palo Alto has<font color="#E5E5E5"> to have the list of IPs</font><font color="#CCCCCC"> in</font>

428
00:18:57,460 --> 00:19:02,019
a very<font color="#CCCCCC"> specific format and the cool</font>

429
00:19:00,460 --> 00:19:03,809
thing<font color="#CCCCCC"> about this is</font><font color="#E5E5E5"> once you start</font><font color="#CCCCCC"> to</font>

430
00:19:02,019 --> 00:19:05,619
figure<font color="#E5E5E5"> this out you can</font><font color="#CCCCCC"> start to feed</font>

431
00:19:03,809 --> 00:19:07,629
additional<font color="#E5E5E5"> IPs</font>

432
00:19:05,619 --> 00:19:10,269
<font color="#E5E5E5">from other resources</font><font color="#CCCCCC"> and from other</font>

433
00:19:07,629 --> 00:19:13,570
systems<font color="#E5E5E5"> where you detect compromises and</font>

434
00:19:10,269 --> 00:19:16,480
so<font color="#E5E5E5"> building this system is really</font>

435
00:19:13,570 --> 00:19:21,428
advantageous<font color="#E5E5E5"> to you as you start to</font>

436
00:19:16,480 --> 00:19:23,619
expand on it so in<font color="#E5E5E5"> that file and I will</font>

437
00:19:21,429 --> 00:19:26,049
show you<font color="#E5E5E5"> the code on this one</font>

438
00:19:23,619 --> 00:19:28,418
essentially<font color="#CCCCCC"> all it's doing is it's a PHP</font>

439
00:19:26,049 --> 00:19:32,200
<font color="#E5E5E5">script that</font><font color="#CCCCCC"> runs when the</font><font color="#E5E5E5"> Apache web</font>

440
00:19:28,419 --> 00:19:33,820
<font color="#E5E5E5">server calls it because Palo Alto wants</font>

441
00:19:32,200 --> 00:19:37,059
to have a file that<font color="#CCCCCC"> they can pull right</font>

442
00:19:33,820 --> 00:19:39,850
<font color="#CCCCCC">off</font><font color="#E5E5E5"> the web</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> all it</font><font color="#CCCCCC"> does is it</font>

443
00:19:37,059 --> 00:19:43,178
<font color="#E5E5E5">executes a couple of shell commands and</font>

444
00:19:39,850 --> 00:19:46,799
it basically cats out the darknet log

445
00:19:43,179 --> 00:19:49,179
file if now it has a couple<font color="#CCCCCC"> of</font><font color="#E5E5E5"> options</font>

446
00:19:46,799 --> 00:19:51,700
<font color="#CCCCCC">what it does is it allows</font><font color="#E5E5E5"> you to</font><font color="#CCCCCC"> pool</font>

447
00:19:49,179 --> 00:19:55,509
<font color="#E5E5E5">multiple pages so you can</font><font color="#CCCCCC"> pull up to</font>

448
00:19:51,700 --> 00:19:57,549
<font color="#CCCCCC">fourteen pages which gives you today is</font>

449
00:19:55,509 --> 00:20:00,250
if by default<font color="#E5E5E5"> it'll give you today's</font>

450
00:19:57,549 --> 00:20:01,900
blocks<font color="#E5E5E5"> it'll give you if</font><font color="#CCCCCC"> you</font>

451
00:20:00,250 --> 00:20:04,150
<font color="#CCCCCC">page one</font><font color="#E5E5E5"> it'll give you yesterday's</font>

452
00:20:01,900 --> 00:20:05,980
blocks if you<font color="#E5E5E5"> do page two you'll give</font>

453
00:20:04,150 --> 00:20:08,530
you<font color="#CCCCCC"> the day befores</font><font color="#E5E5E5"> blocks and so forth</font>

454
00:20:05,980 --> 00:20:10,510
<font color="#E5E5E5">okay and so there's a couple of</font>

455
00:20:08,530 --> 00:20:12,550
different logical operations<font color="#E5E5E5"> that happen</font>

456
00:20:10,510 --> 00:20:15,400
here but<font color="#E5E5E5"> essentially what it does</font><font color="#CCCCCC"> is it</font>

457
00:20:12,550 --> 00:20:16,690
cats those out and<font color="#E5E5E5"> then it basically</font>

458
00:20:15,400 --> 00:20:19,510
<font color="#CCCCCC">uses awk</font>

459
00:20:16,690 --> 00:20:22,720
to take and peel out just the IP

460
00:20:19,510 --> 00:20:24,520
addresses<font color="#CCCCCC"> then it sorts them</font><font color="#E5E5E5"> and then it</font>

461
00:20:22,720 --> 00:20:27,070
<font color="#E5E5E5">gives you the</font><font color="#CCCCCC"> unique</font><font color="#E5E5E5"> addresses</font><font color="#CCCCCC"> that's</font>

462
00:20:24,520 --> 00:20:29,740
<font color="#E5E5E5">all it does because what happens is when</font>

463
00:20:27,070 --> 00:20:31,360
those things<font color="#E5E5E5"> when those IP</font><font color="#CCCCCC"> addresses are</font>

464
00:20:29,740 --> 00:20:33,610
hitting your network<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> get</font>

465
00:20:31,360 --> 00:20:36,459
multiple logs sometimes hundreds of logs

466
00:20:33,610 --> 00:20:37,899
from<font color="#E5E5E5"> the exact same ip address</font><font color="#CCCCCC"> and the</font>

467
00:20:36,460 --> 00:20:39,910
last thing<font color="#E5E5E5"> you want to do is feed the a</font>

468
00:20:37,900 --> 00:20:42,730
Palo Alto a whole bunch of duplicate IP

469
00:20:39,910 --> 00:20:45,610
addresses<font color="#CCCCCC"> so this essentially</font><font color="#E5E5E5"> peels out</font>

470
00:20:42,730 --> 00:20:48,810
all those<font color="#CCCCCC"> duplicates by first sorting it</font>

471
00:20:45,610 --> 00:20:52,899
and then running them through unique and

472
00:20:48,810 --> 00:20:56,110
then basically what you get<font color="#E5E5E5"> is something</font>

473
00:20:52,900 --> 00:20:58,690
<font color="#E5E5E5">that</font><font color="#CCCCCC"> looks like this</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> this shows</font>

474
00:20:56,110 --> 00:21:00,850
today's malicious hosts to go backwards

475
00:20:58,690 --> 00:21:03,760
in time use<font color="#CCCCCC"> the page variable</font><font color="#E5E5E5"> okay</font>

476
00:21:00,850 --> 00:21:09,250
<font color="#E5E5E5">example index dot PHP question mark page</font>

477
00:21:03,760 --> 00:21:11,410
equals<font color="#CCCCCC"> one and this</font><font color="#E5E5E5"> is page zero if you</font>

478
00:21:09,250 --> 00:21:15,190
did use page one it's a this is page one

479
00:21:11,410 --> 00:21:16,660
<font color="#E5E5E5">but</font><font color="#CCCCCC"> it shows the first few IP addresses</font>

480
00:21:15,190 --> 00:21:21,430
that<font color="#E5E5E5"> my network has detected as</font>

481
00:21:16,660 --> 00:21:24,820
malicious so part two we go back to the

482
00:21:21,430 --> 00:21:27,070
Palo Alto<font color="#CCCCCC"> we then go in</font><font color="#E5E5E5"> and create an</font>

483
00:21:24,820 --> 00:21:29,679
external<font color="#CCCCCC"> dynamic list external dynamic</font>

484
00:21:27,070 --> 00:21:32,830
lists are very very cool they're very

485
00:21:29,680 --> 00:21:35,110
very<font color="#CCCCCC"> easy to</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> they allow us to</font>

486
00:21:32,830 --> 00:21:37,240
<font color="#E5E5E5">basically pull this from</font><font color="#CCCCCC"> online now</font>

487
00:21:35,110 --> 00:21:39,159
there's<font color="#E5E5E5"> lots of sources out there</font><font color="#CCCCCC"> on the</font>

488
00:21:37,240 --> 00:21:41,380
internet for<font color="#CCCCCC"> these types</font><font color="#E5E5E5"> of Lists</font><font color="#CCCCCC"> that</font>

489
00:21:39,160 --> 00:21:44,230
<font color="#E5E5E5">you can pull online do I recommend</font><font color="#CCCCCC"> you</font>

490
00:21:41,380 --> 00:21:46,660
use<font color="#E5E5E5"> them all some of</font><font color="#CCCCCC"> them maybe but be</font>

491
00:21:44,230 --> 00:21:49,000
very<font color="#E5E5E5"> very careful so this is a word of</font>

492
00:21:46,660 --> 00:21:52,120
<font color="#E5E5E5">caution</font><font color="#CCCCCC"> any time you start start to</font><font color="#E5E5E5"> set</font>

493
00:21:49,000 --> 00:21:54,130
<font color="#E5E5E5">up dynamic lists you got to realize that</font>

494
00:21:52,120 --> 00:21:55,419
somehow<font color="#E5E5E5"> somebody who needs to</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> the</font>

495
00:21:54,130 --> 00:21:57,400
service who's supposed to<font color="#E5E5E5"> use the</font>

496
00:21:55,420 --> 00:22:00,070
service might accidentally get blocked

497
00:21:57,400 --> 00:22:02,920
<font color="#CCCCCC">okay now the nice thing about dark Nets</font>

498
00:22:00,070 --> 00:22:04,720
is you should have anybody who's

499
00:22:02,920 --> 00:22:07,120
legitimately needing to use the service

500
00:22:04,720 --> 00:22:08,980
ever<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> that network I mean</font>

501
00:22:07,120 --> 00:22:11,889
realistically it shouldn't happen<font color="#E5E5E5"> does</font>

502
00:22:08,980 --> 00:22:13,400
<font color="#E5E5E5">it happen yeah it might but it's really</font>

503
00:22:11,890 --> 00:22:15,620
unlikely

504
00:22:13,400 --> 00:22:18,260
there are other IP<font color="#CCCCCC"> block lists out there</font>

505
00:22:15,620 --> 00:22:19,760
that occasionally<font color="#E5E5E5"> somebody will show up</font>

506
00:22:18,260 --> 00:22:21,530
on<font color="#CCCCCC"> that</font><font color="#E5E5E5"> list</font><font color="#CCCCCC"> that was supposed</font><font color="#E5E5E5"> to</font>

507
00:22:19,760 --> 00:22:23,360
actually<font color="#E5E5E5"> legitimately use your service</font>

508
00:22:21,530 --> 00:22:27,290
<font color="#E5E5E5">so be very careful how you implement</font>

509
00:22:23,360 --> 00:22:29,260
these be careful how you you go<font color="#E5E5E5"> through</font>

510
00:22:27,290 --> 00:22:32,120
it and monitor what<font color="#E5E5E5"> it's pulling off</font>

511
00:22:29,260 --> 00:22:34,820
also<font color="#E5E5E5"> realize that</font><font color="#CCCCCC"> you do have the</font>

512
00:22:32,120 --> 00:22:36,800
<font color="#CCCCCC">capability to</font><font color="#E5E5E5"> do exceptions so if you</font>

513
00:22:34,820 --> 00:22:39,800
have blocks of<font color="#E5E5E5"> addresses</font><font color="#CCCCCC"> you say</font><font color="#E5E5E5"> I don't</font>

514
00:22:36,800 --> 00:22:42,680
<font color="#CCCCCC">care what shows up in here I can always</font>

515
00:22:39,800 --> 00:22:44,960
<font color="#E5E5E5">put I always want to talk to this block</font>

516
00:22:42,680 --> 00:22:48,350
of addresses<font color="#E5E5E5"> you can do that and the</font>

517
00:22:44,960 --> 00:22:49,820
Palo Alto will accept that exception so

518
00:22:48,350 --> 00:22:52,610
<font color="#E5E5E5">essentially what you do is</font><font color="#CCCCCC"> you go in</font>

519
00:22:49,820 --> 00:22:57,080
<font color="#E5E5E5">here</font><font color="#CCCCCC"> you to an IP external dynamic</font><font color="#E5E5E5"> list</font>

520
00:22:52,610 --> 00:22:58,669
<font color="#E5E5E5">you type in type is IP an IP list and</font>

521
00:22:57,080 --> 00:23:03,679
then<font color="#E5E5E5"> you put in your source which is</font>

522
00:22:58,670 --> 00:23:07,220
just the HTML<font color="#E5E5E5"> okay where to find that</font>

523
00:23:03,680 --> 00:23:09,680
page<font color="#CCCCCC"> so you're gonna say a</font><font color="#E5E5E5"> your you're</font>

524
00:23:07,220 --> 00:23:12,110
just<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> put HTTP colon and the name</font>

525
00:23:09,680 --> 00:23:18,710
<font color="#CCCCCC">of the server</font><font color="#E5E5E5"> and that PHP</font><font color="#CCCCCC"> script that</font>

526
00:23:12,110 --> 00:23:21,919
you're pulling yes<font color="#E5E5E5"> in fact that's</font>

527
00:23:18,710 --> 00:23:24,890
exactly<font color="#E5E5E5"> what you do so depending on how</font>

528
00:23:21,920 --> 00:23:29,030
long you want to<font color="#E5E5E5"> block for okay in my</font>

529
00:23:24,890 --> 00:23:31,370
<font color="#CCCCCC">case</font><font color="#E5E5E5"> I block for three days</font><font color="#CCCCCC"> okay but you</font>

530
00:23:29,030 --> 00:23:33,680
could block for two weeks<font color="#CCCCCC"> or you could</font>

531
00:23:31,370 --> 00:23:35,719
go in<font color="#E5E5E5"> that log rotate and</font><font color="#CCCCCC"> you could make</font>

532
00:23:33,680 --> 00:23:37,760
it last<font color="#E5E5E5"> for instead of 14 days</font><font color="#CCCCCC"> you could</font>

533
00:23:35,720 --> 00:23:41,510
do 365 days you could block for a full

534
00:23:37,760 --> 00:23:43,390
year<font color="#CCCCCC"> which is a little</font><font color="#E5E5E5"> extreme okay</font><font color="#CCCCCC"> but</font>

535
00:23:41,510 --> 00:23:46,070
you could do<font color="#E5E5E5"> it if you really wanted to</font>

536
00:23:43,390 --> 00:23:48,500
you could also<font color="#E5E5E5"> change the</font><font color="#CCCCCC"> way that log</font>

537
00:23:46,070 --> 00:23:50,240
rotate works and and you could do a lots

538
00:23:48,500 --> 00:23:55,550
of different<font color="#CCCCCC"> things</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> not have to do</font>

539
00:23:50,240 --> 00:23:58,130
<font color="#E5E5E5">it in 365 files but essentially what you</font>

540
00:23:55,550 --> 00:24:01,669
do<font color="#CCCCCC"> is you create</font><font color="#E5E5E5"> three different dynamic</font>

541
00:23:58,130 --> 00:24:04,040
lists<font color="#CCCCCC"> dartnet scans</font><font color="#E5E5E5"> one two and darknets</font>

542
00:24:01,670 --> 00:24:06,620
hands current and<font color="#E5E5E5"> then you can and you</font>

543
00:24:04,040 --> 00:24:08,540
can<font color="#E5E5E5"> do this as many</font><font color="#CCCCCC"> as you like</font><font color="#E5E5E5"> and then</font>

544
00:24:06,620 --> 00:24:10,760
<font color="#CCCCCC">you can basically</font><font color="#E5E5E5"> put in the page</font>

545
00:24:08,540 --> 00:24:13,490
numbers of which day you want<font color="#E5E5E5"> to pool</font>

546
00:24:10,760 --> 00:24:16,040
once you've created these dynamic lists

547
00:24:13,490 --> 00:24:17,360
there may be some duplicates<font color="#E5E5E5"> amongst</font>

548
00:24:16,040 --> 00:24:19,129
those I always<font color="#CCCCCC"> assumed there would be</font>

549
00:24:17,360 --> 00:24:22,189
that doesn't matter<font color="#E5E5E5"> the Palo Alto is</font>

550
00:24:19,130 --> 00:24:25,550
fine with that<font color="#E5E5E5"> and the other thing</font>

551
00:24:22,190 --> 00:24:27,200
you'll<font color="#CCCCCC"> notice is that I pull previous</font>

552
00:24:25,550 --> 00:24:30,529
days daily

553
00:24:27,200 --> 00:24:34,850
in the morning but I pull the current

554
00:24:30,529 --> 00:24:36,860
one<font color="#E5E5E5"> every five</font><font color="#CCCCCC"> minutes</font><font color="#E5E5E5"> okay that way if</font>

555
00:24:34,850 --> 00:24:40,870
somebody scans my<font color="#CCCCCC"> Network five minutes</font>

556
00:24:36,860 --> 00:24:45,639
<font color="#E5E5E5">later they're blocked for 72 hours</font>

557
00:24:40,870 --> 00:24:47,600
<font color="#CCCCCC">you're done okay all right</font>

558
00:24:45,639 --> 00:24:50,178
at that point<font color="#E5E5E5"> you're going</font><font color="#CCCCCC"> to create</font>

559
00:24:47,600 --> 00:24:53,779
another syslog server profile<font color="#CCCCCC"> I love</font>

560
00:24:50,179 --> 00:24:55,580
this it's lots of boring stuff

561
00:24:53,779 --> 00:24:56,960
and<font color="#E5E5E5"> then basically this is log server</font>

562
00:24:55,580 --> 00:25:00,590
profile we're going to use to<font color="#CCCCCC"> identify</font>

563
00:24:56,960 --> 00:25:03,710
blocked attacks<font color="#E5E5E5"> okay and this profile is</font>

564
00:25:00,590 --> 00:25:05,720
going<font color="#E5E5E5"> to say</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> if something hits one</font>

565
00:25:03,710 --> 00:25:06,860
<font color="#E5E5E5">of those dynamic lists we're gonna take</font>

566
00:25:05,720 --> 00:25:08,779
them and we're gonna send<font color="#E5E5E5"> that</font>

567
00:25:06,860 --> 00:25:10,908
<font color="#CCCCCC">information</font><font color="#E5E5E5"> back to the syslog server so</font>

568
00:25:08,779 --> 00:25:14,029
<font color="#CCCCCC">we know what's being blocked</font><font color="#E5E5E5"> so we can</font>

569
00:25:10,909 --> 00:25:17,090
<font color="#E5E5E5">monitor that yeah so same</font><font color="#CCCCCC"> thing as</font>

570
00:25:14,029 --> 00:25:19,309
<font color="#E5E5E5">before very very similar we're then</font>

571
00:25:17,090 --> 00:25:22,070
going to<font color="#E5E5E5"> go into the custom blog format</font>

572
00:25:19,309 --> 00:25:24,320
and we're going to change<font color="#E5E5E5"> the log to</font>

573
00:25:22,070 --> 00:25:26,330
something<font color="#CCCCCC"> that</font><font color="#E5E5E5"> looks like this which is</font>

574
00:25:24,320 --> 00:25:29,000
<font color="#CCCCCC">attack blocked from source to</font>

575
00:25:26,330 --> 00:25:32,658
destination<font color="#E5E5E5"> the protocol the destination</font>

576
00:25:29,000 --> 00:25:34,519
port the application and then I like<font color="#E5E5E5"> to</font>

577
00:25:32,659 --> 00:25:38,210
<font color="#E5E5E5">add on that</font><font color="#CCCCCC"> DRK at the end so I know</font>

578
00:25:34,519 --> 00:25:42,230
exactly<font color="#E5E5E5"> why it was blocked what reason</font>

579
00:25:38,210 --> 00:25:43,580
it was blocked<font color="#E5E5E5"> yeah all right</font><font color="#CCCCCC"> and then</font>

580
00:25:42,230 --> 00:25:45,380
after that you're<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> create your</font>

581
00:25:43,580 --> 00:25:47,689
custom log forwarding another log

582
00:25:45,380 --> 00:25:49,220
forwarding<font color="#E5E5E5"> and you're gonna say this is</font>

583
00:25:47,690 --> 00:25:51,320
the blocked attack<font color="#CCCCCC"> you're going to</font>

584
00:25:49,220 --> 00:25:53,029
<font color="#E5E5E5">assign it</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> that server profile and</font>

585
00:25:51,320 --> 00:25:58,990
you're gonna push it out to<font color="#E5E5E5"> the log</font>

586
00:25:53,029 --> 00:25:58,990
server and<font color="#E5E5E5"> uh-huh yeah</font><font color="#CCCCCC"> go for</font><font color="#E5E5E5"> it</font>

587
00:26:06,370 --> 00:26:11,540
correct<font color="#E5E5E5"> because</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> will happen is if</font>

588
00:26:09,320 --> 00:26:14,450
they continue<font color="#CCCCCC"> to ask in that</font><font color="#E5E5E5"> dark net</font>

589
00:26:11,540 --> 00:26:17,060
<font color="#E5E5E5">they will continue to end up on</font><font color="#CCCCCC"> that</font>

590
00:26:14,450 --> 00:26:19,310
list<font color="#CCCCCC"> now if they're</font><font color="#E5E5E5"> not scanning the</font>

591
00:26:17,060 --> 00:26:22,340
dark net<font color="#E5E5E5"> they'll eventually fade off of</font>

592
00:26:19,310 --> 00:26:26,540
it if that<font color="#CCCCCC"> makes any sense okay</font><font color="#E5E5E5"> it</font>

593
00:26:22,340 --> 00:26:27,679
doesn't continue if if they're if

594
00:26:26,540 --> 00:26:30,139
they're<font color="#E5E5E5"> scanning the rest of your</font>

595
00:26:27,680 --> 00:26:32,210
network<font color="#E5E5E5"> three days later and they've</font>

596
00:26:30,140 --> 00:26:35,750
already faded off the dark net<font color="#E5E5E5"> then it</font>

597
00:26:32,210 --> 00:26:38,690
<font color="#E5E5E5">won't catch</font><font color="#CCCCCC"> them at that point yeah</font><font color="#E5E5E5"> so</font>

598
00:26:35,750 --> 00:26:41,960
yeah there are some holes<font color="#CCCCCC"> but this is a</font>

599
00:26:38,690 --> 00:26:44,210
generally good<font color="#E5E5E5"> practice okay so you're</font>

600
00:26:41,960 --> 00:26:46,430
gonna create a<font color="#E5E5E5"> policy rule this is</font>

601
00:26:44,210 --> 00:26:48,770
important<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is kind of the key to</font><font color="#E5E5E5"> the</font>

602
00:26:46,430 --> 00:26:51,290
whole<font color="#CCCCCC"> thing that we want to go in</font><font color="#E5E5E5"> and we</font>

603
00:26:48,770 --> 00:26:52,850
say the source if they come from<font color="#CCCCCC"> and</font>

604
00:26:51,290 --> 00:26:54,260
then<font color="#E5E5E5"> you notice</font><font color="#CCCCCC"> that we use</font><font color="#E5E5E5"> those</font>

605
00:26:52,850 --> 00:26:58,010
dynamic lists that we already<font color="#E5E5E5"> created</font>

606
00:26:54,260 --> 00:26:59,750
<font color="#E5E5E5">dark net scans one two and current if</font>

607
00:26:58,010 --> 00:27:03,170
they<font color="#E5E5E5"> come anything comes from those</font>

608
00:26:59,750 --> 00:27:05,510
<font color="#E5E5E5">we're going to deny them and we're going</font>

609
00:27:03,170 --> 00:27:07,640
to forward<font color="#CCCCCC"> that on to</font><font color="#E5E5E5"> that log</font><font color="#CCCCCC"> probe</font>

610
00:27:05,510 --> 00:27:12,410
<font color="#E5E5E5">that log forwarding profile that we</font>

611
00:27:07,640 --> 00:27:15,620
created earlier<font color="#CCCCCC"> and that's it that's the</font>

612
00:27:12,410 --> 00:27:17,570
<font color="#CCCCCC">end of</font><font color="#E5E5E5"> it but in the end what you'll</font>

613
00:27:15,620 --> 00:27:21,649
<font color="#E5E5E5">have is something that looks</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> this</font>

614
00:27:17,570 --> 00:27:25,280
<font color="#CCCCCC">so we show</font><font color="#E5E5E5"> the scans at the top where</font>

615
00:27:21,650 --> 00:27:27,490
they're coming<font color="#E5E5E5"> in okay and then they</font>

616
00:27:25,280 --> 00:27:31,250
attack this blog from<font color="#E5E5E5"> that particular</font>

617
00:27:27,490 --> 00:27:33,860
<font color="#E5E5E5">scan and this is happening within five</font>

618
00:27:31,250 --> 00:27:35,510
minutes of these scans coming in they're

619
00:27:33,860 --> 00:27:37,669
being<font color="#E5E5E5"> blocked on</font><font color="#CCCCCC"> the rest</font><font color="#E5E5E5"> of the</font>

620
00:27:35,510 --> 00:27:39,740
firewalls<font color="#E5E5E5"> now the cool thing hold on</font>

621
00:27:37,670 --> 00:27:42,230
just one second I'll get to you<font color="#E5E5E5"> the cool</font>

622
00:27:39,740 --> 00:27:44,570
thing about this is you can<font color="#E5E5E5"> also if</font>

623
00:27:42,230 --> 00:27:46,310
you're<font color="#CCCCCC"> using panorama with Palo Alto</font><font color="#E5E5E5"> you</font>

624
00:27:44,570 --> 00:27:50,000
can push this out to all of<font color="#E5E5E5"> your</font>

625
00:27:46,310 --> 00:27:51,530
firewalls<font color="#E5E5E5"> very very easily and now not</font>

626
00:27:50,000 --> 00:27:54,230
<font color="#CCCCCC">only is he being blocked on one firewall</font>

627
00:27:51,530 --> 00:27:55,760
<font color="#CCCCCC">it's being</font><font color="#E5E5E5"> blocked on ten firewalls or</font>

628
00:27:54,230 --> 00:28:03,380
however many firewalls you have in your

629
00:27:55,760 --> 00:28:04,670
organization<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> go ahead that you</font>

630
00:28:03,380 --> 00:28:07,100
don't want to pull<font color="#E5E5E5"> it</font><font color="#CCCCCC"> too early and I</font>

631
00:28:04,670 --> 00:28:10,910
<font color="#CCCCCC">think that is as well I</font><font color="#E5E5E5"> think that is as</font>

632
00:28:07,100 --> 00:28:12,860
quick as you<font color="#E5E5E5"> can pull it there so I</font>

633
00:28:10,910 --> 00:28:17,440
don't<font color="#E5E5E5"> know I can't remember that's what</font>

634
00:28:12,860 --> 00:28:17,439
I<font color="#E5E5E5"> ended up setting it as that's</font>

635
00:28:18,070 --> 00:28:22,700
correct<font color="#E5E5E5"> so that you'll still have five</font>

636
00:28:21,290 --> 00:28:24,200
minutes to continue scanning<font color="#E5E5E5"> but</font>

637
00:28:22,700 --> 00:28:26,900
depending<font color="#E5E5E5"> on how big your address space</font>

638
00:28:24,200 --> 00:28:29,450
is and the other<font color="#E5E5E5"> thing is is at that</font>

639
00:28:26,900 --> 00:28:30,620
point<font color="#E5E5E5"> they may come</font><font color="#CCCCCC"> back after a scan</font>

640
00:28:29,450 --> 00:28:46,570
and<font color="#E5E5E5"> they're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> be blocked for at</font>

641
00:28:30,620 --> 00:28:46,570
least three<font color="#E5E5E5"> days so okay yeah yep</font>

642
00:29:02,970 --> 00:29:09,179
you know<font color="#CCCCCC"> what</font><font color="#E5E5E5"> I I haven't run into</font><font color="#CCCCCC"> that</font>

643
00:29:05,759 --> 00:29:10,859
yet<font color="#CCCCCC"> but</font><font color="#E5E5E5"> you've got it I mean you've</font>

644
00:29:09,179 --> 00:29:12,599
absolutely got a valid<font color="#E5E5E5"> point</font>

645
00:29:10,859 --> 00:29:14,070
<font color="#CCCCCC">and that's why I</font><font color="#E5E5E5"> kind of preface this</font>

646
00:29:12,599 --> 00:29:17,460
with you've got<font color="#CCCCCC"> to be careful</font><font color="#E5E5E5"> what you</font>

647
00:29:14,070 --> 00:29:19,559
<font color="#E5E5E5">end up</font><font color="#CCCCCC"> blocking Paulo so does</font><font color="#E5E5E5"> have the</font>

648
00:29:17,460 --> 00:29:21,330
<font color="#CCCCCC">capability to do exemptions</font><font color="#E5E5E5"> but you're</font>

649
00:29:19,559 --> 00:29:23,220
<font color="#E5E5E5">spot-on</font><font color="#CCCCCC"> I mean if somebody</font><font color="#E5E5E5"> did spoof</font>

650
00:29:21,330 --> 00:29:32,399
something you'd have it you'd<font color="#E5E5E5"> have an</font>

651
00:29:23,220 --> 00:29:37,019
issue<font color="#E5E5E5"> so go ahead I've had it</font>

652
00:29:32,399 --> 00:29:44,178
implemented for quite some time<font color="#CCCCCC"> now</font><font color="#E5E5E5"> well</font>

653
00:29:37,019 --> 00:29:50,299
<font color="#E5E5E5">over it's been at least</font><font color="#CCCCCC"> a year more I</font>

654
00:29:44,179 --> 00:29:50,299
haven't had any issues<font color="#E5E5E5"> yet so</font><font color="#CCCCCC"> okay</font>

655
00:29:58,970 --> 00:30:05,840
yes this has not caused<font color="#E5E5E5"> a problem</font><font color="#CCCCCC"> with</font>

656
00:30:03,720 --> 00:30:05,840
that

657
00:30:25,080 --> 00:30:30,370
yeah so if somebody purposely pointed at

658
00:30:28,750 --> 00:30:32,230
one<font color="#CCCCCC"> of my Dartmouth</font><font color="#E5E5E5"> space</font><font color="#CCCCCC"> at address</font>

659
00:30:30,370 --> 00:30:40,059
spaces yes absolutely they'd be blocked

660
00:30:32,230 --> 00:30:42,970
<font color="#E5E5E5">and within</font><font color="#CCCCCC"> five minutes so absolutely</font><font color="#E5E5E5"> he</font>

661
00:30:40,059 --> 00:30:46,000
could<font color="#CCCCCC"> but</font><font color="#E5E5E5"> like I said since there are no</font>

662
00:30:42,970 --> 00:30:48,370
DNS entries<font color="#E5E5E5"> no reason to</font><font color="#CCCCCC"> ever go to</font><font color="#E5E5E5"> that</font>

663
00:30:46,000 --> 00:30:50,530
<font color="#E5E5E5">space that</font><font color="#CCCCCC"> should never happen in any</font>

664
00:30:48,370 --> 00:30:52,689
<font color="#CCCCCC">legitimate reason</font><font color="#E5E5E5"> in any legitimate way</font>

665
00:30:50,530 --> 00:30:55,059
<font color="#E5E5E5">okay that's why I said at the very</font>

666
00:30:52,690 --> 00:30:56,590
beginning<font color="#CCCCCC"> we talked about how do we</font>

667
00:30:55,059 --> 00:30:58,809
<font color="#E5E5E5">determine what a</font><font color="#CCCCCC"> darknet space looks</font>

668
00:30:56,590 --> 00:31:01,959
like if we're using a darkness<font color="#E5E5E5"> space</font>

669
00:30:58,809 --> 00:31:03,490
that has ever had anything<font color="#E5E5E5"> on it that</font>

670
00:31:01,960 --> 00:31:06,429
anybody would<font color="#CCCCCC"> ever if there's ever been</font>

671
00:31:03,490 --> 00:31:08,409
DNS addresses pointed at<font color="#CCCCCC"> it</font><font color="#E5E5E5"> we want to</font>

672
00:31:06,429 --> 00:31:10,900
make<font color="#CCCCCC"> sure that this is clean space or</font>

673
00:31:08,409 --> 00:31:15,780
has been<font color="#CCCCCC"> clean for</font><font color="#E5E5E5"> quite some time so</font>

674
00:31:10,900 --> 00:31:15,780
<font color="#CCCCCC">that no one would</font><font color="#E5E5E5"> ever ever touch</font><font color="#CCCCCC"> it</font>

675
00:31:31,310 --> 00:31:35,600
<font color="#E5E5E5">oh you mean if somebody was going in and</font>

676
00:31:33,920 --> 00:31:38,000
<font color="#E5E5E5">saying okay they're pounding the</font>

677
00:31:35,600 --> 00:31:42,500
firewall against you know they<font color="#E5E5E5"> they got</font>

678
00:31:38,000 --> 00:31:44,620
an excessive<font color="#CCCCCC"> excessive drops on the</font>

679
00:31:42,500 --> 00:31:46,430
firewall during in normal space

680
00:31:44,620 --> 00:31:49,010
<font color="#CCCCCC">absolutely you could</font><font color="#E5E5E5"> do things like that</font>

681
00:31:46,430 --> 00:31:51,800
<font color="#CCCCCC">if you wanted</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> Cisco they call that</font>

682
00:31:49,010 --> 00:31:53,510
the shunning<font color="#E5E5E5"> and in Cisco will actually</font>

683
00:31:51,800 --> 00:31:57,260
do that<font color="#E5E5E5"> automatically if you turn on</font><font color="#CCCCCC"> the</font>

684
00:31:53,510 --> 00:31:58,910
thing<font color="#CCCCCC"> it can be problematic and</font><font color="#E5E5E5"> because</font>

685
00:31:57,260 --> 00:32:00,560
what happens is sometimes<font color="#E5E5E5"> people have</font>

686
00:31:58,910 --> 00:32:02,830
clients that are misconfigured and doing

687
00:32:00,560 --> 00:32:08,030
things<font color="#E5E5E5"> that they shouldn't</font><font color="#CCCCCC"> do and</font>

688
00:32:02,830 --> 00:32:11,240
<font color="#E5E5E5">they're legitimate people it does have</font>

689
00:32:08,030 --> 00:32:12,920
some issues and back to you know I've

690
00:32:11,240 --> 00:32:15,850
have run<font color="#E5E5E5"> into problems with that when</font>

691
00:32:12,920 --> 00:32:20,110
I've<font color="#CCCCCC"> used it can you do</font><font color="#E5E5E5"> it absolutely</font>

692
00:32:15,850 --> 00:32:20,110
<font color="#E5E5E5">but if you do it be careful</font><font color="#CCCCCC"> with it</font>

693
00:32:23,410 --> 00:32:31,420
any other questions<font color="#CCCCCC"> okay we finished</font>

694
00:32:27,950 --> 00:32:31,420
<font color="#E5E5E5">early thank you</font>

695
00:32:33,810 --> 00:32:36,919
[Applause]

