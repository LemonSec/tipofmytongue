1
00:00:00,130 --> 00:00:06,250
investigating PDF mark so how I got
started I was sitting at work one day

2
00:00:06,250 --> 00:00:12,730
and one of my coworkers send out an
email where you can download free books

3
00:00:12,730 --> 00:00:25,289
like that I was curious what would
motivate someone to provide downloads of

4
00:00:25,289 --> 00:00:30,869
three books most of which are probably
under some sort of copyright and as a

5
00:00:30,869 --> 00:00:36,080
result I decided to investigate it and
the conclusion I came to there's really

6
00:00:36,080 --> 00:00:42,129
only one reason to allow for downloading
books that are owned by someone else for

7
00:00:42,130 --> 00:00:45,560
free and that's because the people that
are doing that are actually getting

8
00:00:45,560 --> 00:00:52,480
something out of it and the way they get
something out of it is so essentially

9
00:00:52,480 --> 00:00:57,050
the majority of those kinds of things

10
00:00:57,050 --> 00:01:02,650
part of larger criminal enterprises and
they're using these things and other

11
00:01:02,650 --> 00:01:07,510
things in there are also used in
conjunction with pitching

12
00:01:07,510 --> 00:01:10,430
to be able to get access to your
computer and the things that you have

13
00:01:10,430 --> 00:01:18,040
access to so first of all we should talk
about what a PDF PDF representing

14
00:01:18,040 --> 00:01:22,040
documents in a manner independent the
application software hardware and

15
00:01:22,040 --> 00:01:28,230
operating system used to create them and
the output device on which they are to

16
00:01:28,230 --> 00:01:33,800
be displayed or printed according to the
docs so essentially the media is a

17
00:01:33,800 --> 00:01:40,890
growth from postscript that as a
language designed to identify the

18
00:01:40,890 --> 00:01:47,820
locations for objects on a page and
there in a way that is cross-platform so

19
00:01:47,820 --> 00:01:54,940
why mall where on PBS well is a really
great idea

20
00:01:54,940 --> 00:01:59,429
anything you can write once and it works
on every platform that's really helpful

21
00:01:59,430 --> 00:02:09,440
to us it's everywhere so how does he at
work in general I might go through a

22
00:02:09,440 --> 00:02:11,940
little bit of history here

23
00:02:11,940 --> 00:02:21,020
originally called camelot developed by
Adobe and it was introduced first

24
00:02:21,020 --> 00:02:26,230
introduced in nineteen ninety three men
in 1996 they added a couple of extra

25
00:02:26,230 --> 00:02:33,380
features including passwords encryption
objects and links and it defined a more

26
00:02:33,380 --> 00:02:39,829
structured format than most programs and
the special biohazard including

27
00:02:39,830 --> 00:02:44,630
hypertext links they're not part of the
patients themselves but they end up

28
00:02:44,630 --> 00:02:46,109
being useful

29
00:02:46,110 --> 00:02:52,050
tour interactive kinds of doing how many
of you and HTTP or HTTPS link in a PDF

30
00:02:52,050 --> 00:02:56,550
document Italian people

31
00:02:56,550 --> 00:03:05,070
rate is hopeful but it's a little bit
evil in 1996 they introduced version 1.2

32
00:03:05,070 --> 00:03:10,239
or they had forms that were added to PDF
how many of you fill out a PDF form

33
00:03:10,240 --> 00:03:18,940
maybe their tax documents call a lot of
movies and sounds off the rails here

34
00:03:18,940 --> 00:03:27,900
next two thousand they added JavaScript
and embedded in my dreams of you hackers

35
00:03:27,900 --> 00:03:33,570
are excited about those two things
everyday better be ready to get into

36
00:03:33,570 --> 00:03:41,590
things then finally in 2001 they added
to his impressive images saving to

37
00:03:41,590 --> 00:03:46,280
decode has some serious issues in PDF
documents that's a great place to do

38
00:03:46,280 --> 00:03:51,570
some exploits gonna steal a couple
different versions moved to Thurs 1.7

39
00:03:51,570 --> 00:04:00,829
they added encryption encryption in
Britain 1.7 D was added in 1.1 was based

40
00:04:00,830 --> 00:04:05,230
on AMD 5 NRC for does it work of two
people know that's not a very good idea

41
00:04:05,230 --> 00:04:10,820
so they added a second in 2008 and then
they discovered how thought it wasn't

42
00:04:10,820 --> 00:04:18,950
takes it in 2011 there's actually I
believe a specification for version 1.7

43
00:04:18,950 --> 00:04:23,229
and I don't have a lot of information
about that there are two standards for

44
00:04:23,230 --> 00:04:31,570
PDF documents you have entered an EIS
Center the ISO standard is generally 21

45
00:04:31,570 --> 00:04:37,150
that is included in almost every single
PDF document that you have ever seen the

46
00:04:37,150 --> 00:04:45,349
double standard simply content to that
so they generally a return to those as

47
00:04:45,350 --> 00:04:52,040
Adobe extensions on top of the ISO
standard in the end what is an attacker

48
00:04:52,040 --> 00:05:05,420
want to execute they want to gain access
to your devised when it rang to your

49
00:05:05,420 --> 00:05:10,490
computer to a video so what they really
want to do is be able to get some code

50
00:05:10,490 --> 00:05:19,350
document and executed so the way that I
like to look at this ever since I was a

51
00:05:19,350 --> 00:05:24,360
kid whenever I was playing those games
where I would be amazed I love to start

52
00:05:24,360 --> 00:05:30,260
at the end where the solution is already
apparent and work my way backwards if

53
00:05:30,260 --> 00:05:32,020
you served from the beginning

54
00:05:32,020 --> 00:05:36,039
oftentimes all the third seemed really
come leaders in the hard to understand

55
00:05:36,040 --> 00:05:39,880
but if you see the place for you know
you need to get to it seems easier to me

56
00:05:39,880 --> 00:05:43,740
so I wanna talk about some of the
fundamentals of how a PDF that is built

57
00:05:43,740 --> 00:05:55,990
how many of you have looked at appear in
some sort of editor before you knew this

58
00:05:55,990 --> 00:06:02,460
is what it looks like a really in the
back as a minute just a minute but

59
00:06:02,460 --> 00:06:09,159
essentially it's mostly binary data and
reading binary data is hard for people

60
00:06:09,160 --> 00:06:14,160
it's really easy for computers but it's
hard for people so let's talk about the

61
00:06:14,160 --> 00:06:22,170
different components that are in PDF
documents for beginning the first one

62
00:06:22,170 --> 00:06:27,760
point four people were written by seven
entering the document catalogs and

63
00:06:27,760 --> 00:06:40,449
that's not terribly helpful but this is
what it looks like 20 to the right thing

64
00:06:40,449 --> 00:06:46,430
whereas a percent PDF 1.3 and then some
things out to that that's generally the

65
00:06:46,430 --> 00:06:51,879
person that you got back and he added
that to you know what kind of a PDF

66
00:06:51,879 --> 00:06:57,860
document that you have unless of course
it's over in the dictionary that tells

67
00:06:57,860 --> 00:07:02,779
you to version thanks to be due
importance there are other ways to DVD

68
00:07:02,779 --> 00:07:03,849
out headers

69
00:07:03,849 --> 00:07:10,089
doesn't have to be right at the top they
can be in the first 1000 bytes chances

70
00:07:10,089 --> 00:07:13,560
are if you have a PDF document it looks
like this instead of a default one that

71
00:07:13,560 --> 00:07:21,520
I was showing you before there aren't a
whole lot of pdf Tools that inject

72
00:07:21,520 --> 00:07:27,229
content into PDF documents before the
header and that's because it's very

73
00:07:27,229 --> 00:07:35,068
helpful to do that you can but it's very
helpful to do that once the document and

74
00:07:35,069 --> 00:07:38,960
the next thing that goes for is a
trailer which is at the end of a

75
00:07:38,960 --> 00:07:43,359
document that sets up the object the
route we're gonna talk about a little

76
00:07:43,360 --> 00:07:49,710
bit more and the data to the training is
probably that if you have anything

77
00:07:49,710 --> 00:07:53,938
that's injected into the document after
the trailer declaration probably not a

78
00:07:53,939 --> 00:07:59,319
good thing and documents should be
suspects or any kind of malware and the

79
00:07:59,319 --> 00:08:06,440
truth sets are cross reference to object
locations by character position in the

80
00:08:06,440 --> 00:08:12,040
and the cross-reference table is a map
all the items in the file by showing you

81
00:08:12,040 --> 00:08:19,370
the the root element so this is the end
immediately that I was experimenting

82
00:08:19,370 --> 00:08:24,410
with you see much of lines in the year
the trailer will cross reference table

83
00:08:24,410 --> 00:08:29,510
and then surely make a service this is
the day that you can go to and then the

84
00:08:29,510 --> 00:08:36,409
EOS declaration anything after that is
probably bad there's not a real good

85
00:08:36,409 --> 00:08:39,939
reason for you to include items after
that and much more

86
00:08:39,940 --> 00:08:43,700
building something for hackers count
which there may or may not be any of

87
00:08:43,700 --> 00:08:50,080
them so once you establish the head and
the free to have a pretty good idea of

88
00:08:50,080 --> 00:08:57,350
where the bounds of the document our
media standard you are adhering to the

89
00:08:57,350 --> 00:09:04,780
next day that we need to get into the
root element so the document itself is a

90
00:09:04,780 --> 00:09:10,410
collection of objects under the root
element and all of the objects in a PDF

91
00:09:10,410 --> 00:09:15,900
document descend from that root element
threw one pass for another and

92
00:09:15,900 --> 00:09:21,530
essentially it's a tree structure we
don't have some big trees in here today

93
00:09:21,530 --> 00:09:25,439
but we don't have any real trees look at
this is just a sample of what it looks

94
00:09:25,440 --> 00:09:30,390
like some of your photos and they would
that be publicly with the data

95
00:09:30,390 --> 00:09:34,900
structures retreat as well so there is a
single base object inside of a PDF

96
00:09:34,900 --> 00:09:37,230
document everything comes out of that

97
00:09:37,230 --> 00:09:49,370
to other objects inserting pages and
other things so documents objects that

98
00:09:49,370 --> 00:09:56,040
are embedded inside of media documents
some of you who have used documents are

99
00:09:56,040 --> 00:10:03,380
probably things like text and images
which is kinda nasty JavaScript which is

100
00:10:03,380 --> 00:10:11,080
really exciting for hackers files and
then PDF documents yes you can inject a

101
00:10:11,080 --> 00:10:20,370
PDF document into a PDF document can be
embedded into a PDF document that's when

102
00:10:20,370 --> 00:10:24,380
you can inject immediate access to a PDF
document so you get a tree inside of a

103
00:10:24,380 --> 00:10:25,010
tree

104
00:10:25,010 --> 00:10:29,680
fortunately though it appears of the new
language standard does not allow you to

105
00:10:29,680 --> 00:10:34,339
inject a PDF document into a PDF
document into a PDF document so you'll

106
00:10:34,340 --> 00:10:40,800
have to a two layers of strains are
several things once you've gotten the

107
00:10:40,800 --> 00:10:48,859
basic idea how the tree structure words
and the methods of interacting with the

108
00:10:48,860 --> 00:10:51,610
different objects inside of the tree
structure which will probably talk about

109
00:10:51,610 --> 00:10:52,840
a little bit more

110
00:10:52,840 --> 00:10:57,440
attacker what they really want to do to
execute their cell code is create some

111
00:10:57,440 --> 00:11:02,730
sort of it's free or not or something of
that nature where they get through

112
00:11:02,730 --> 00:11:08,190
enough viewer randomly distributed
memory jus location pointer that points

113
00:11:08,190 --> 00:11:11,610
to their telco and executors of code

114
00:11:11,610 --> 00:11:16,790
of you who are unfamiliar cellco give
you a good example of how many of you

115
00:11:16,790 --> 00:11:20,589
play the game channel and you get there
you move forward to the basis of

116
00:11:20,589 --> 00:11:25,360
something announced that is essentially
something that says move forward once

117
00:11:25,360 --> 00:11:31,519
phase space over and over and over again
until you get to the Lakers forward to

118
00:11:31,519 --> 00:11:36,180
being able to do that is really exciting
if you're trying to compromise between

119
00:11:36,180 --> 00:11:43,000
its not so great to be saved and there
are a lot of functionality and features

120
00:11:43,000 --> 00:11:48,269
built into new modern applications to
try and prevent attackers from the evil

121
00:11:48,269 --> 00:11:53,790
to create enough said and other things
like that but getting creative in the

122
00:11:53,790 --> 00:12:00,730
way they're making their no walks in
these things and so it's not necessarily

123
00:12:00,730 --> 00:12:05,700
a simple task to be able to identify the
section of a document happens to be

124
00:12:05,700 --> 00:12:10,540
enough said and this is the shellcode
until you get into the good some of the

125
00:12:10,540 --> 00:12:16,920
more simple versions of software that is
injected into PDF documents tomorrow

126
00:12:16,920 --> 00:12:26,040
we're very easy to detect because they
have a clear pattern operations in them

127
00:12:26,040 --> 00:12:30,099
and then all of those things of course
can be included an encrypted with around

128
00:12:30,100 --> 00:12:32,730
talk about it in just a minute so

129
00:12:32,730 --> 00:12:36,880
let's talk a little about the different
kinds of objects that are inside PDF

130
00:12:36,880 --> 00:12:42,360
documents the objects that you can have
any PDF document object object itself

131
00:12:42,360 --> 00:12:47,329
and then end up ject you can have a
stream and then stream those are the

132
00:12:47,329 --> 00:12:50,719
areas around a stream across the trailer

133
00:12:50,720 --> 00:12:57,490
pages you've probably seen those in PDF
documents thank you to encrypt intense

134
00:12:57,490 --> 00:13:05,079
jet stream which allows you are kinds of
objects and files and JavaScript objects

135
00:13:05,079 --> 00:13:11,489
and open action objects that executes
when the document is opened

136
00:13:11,490 --> 00:13:19,269
actress honors for form content to
decode is contents were compression

137
00:13:19,269 --> 00:13:25,480
images rich media is for sounds and
videos and then I'm not a dude ranch

138
00:13:25,480 --> 00:13:31,990
house allows you to add files in there
and then exit eight colors so those are

139
00:13:31,990 --> 00:13:38,690
pretty good list of objects that are
found inside a PDF document so the basic

140
00:13:38,690 --> 00:13:45,940
object in a PDF document looks a little
bit like this you have the object number

141
00:13:45,940 --> 00:13:50,500
and the object reference you have the
length of the Dixie stream which will be

142
00:13:50,500 --> 00:13:55,160
about screaming this case it's just a
dream that indicates there were gonna be

143
00:13:55,160 --> 00:13:59,839
printing out some texts there's a pond
and a size in there and then the one

144
00:13:59,839 --> 00:14:05,420
hundred seven hundred is the position of
the text on the page in this case is

145
00:14:05,420 --> 00:14:10,180
fight sequence even has hello world in
plain text that's great and if you're

146
00:14:10,180 --> 00:14:14,839
reading a PDF document it's really
exciting to be able to see plane tickets

147
00:14:14,839 --> 00:14:17,040
and say I know what that point of
printing out

148
00:14:17,040 --> 00:14:20,009
could read the JavaScript upfront
because you're really good at

149
00:14:20,009 --> 00:14:25,990
seventy-eight documents that challenge
with that is that it's usually not that

150
00:14:25,990 --> 00:14:31,810
simple I don't know of a way for you to
create this except by doing it manually

151
00:14:31,810 --> 00:14:38,388
because the tools you would create a PDF
document with filters I believe that

152
00:14:38,389 --> 00:14:41,209
there are 10 different kinds of voters
is Romans and I have been able to find

153
00:14:41,209 --> 00:14:46,219
the most common one that I know of
inside the PDF

154
00:14:46,220 --> 00:14:54,970
decode if you do LZW compression like
giving the impression that you have that

155
00:14:54,970 --> 00:15:00,610
one as well but any one of those things
can be used as a filter on top of the

156
00:15:00,610 --> 00:15:05,839
objects dream that you have inside of
your document all of those filters

157
00:15:05,839 --> 00:15:13,699
different effects unless you that
particulate filters so it's not as

158
00:15:13,699 --> 00:15:20,008
simple as a single signature for some of
these items of video eyewear so here's

159
00:15:20,009 --> 00:15:30,769
an example an item with the ASCII decode
the third grade so I'm not alone that's

160
00:15:30,769 --> 00:15:37,360
really hard to read and being able to
decrypt that requires you to apply that

161
00:15:37,360 --> 00:15:45,319
it gets worse though someone indexing
mall where into your document can

162
00:15:45,319 --> 00:15:53,599
actually filters on a number of levels
and so this particular example uses

163
00:15:53,600 --> 00:15:57,360
including 85 decoding

164
00:15:57,360 --> 00:16:04,940
to be able to read that content there's
also encryption inside this rings that

165
00:16:04,940 --> 00:16:10,730
are contained inside a PDF document so a
document that is encrypted will have the

166
00:16:10,730 --> 00:16:14,420
strings and side of an encrypted but the
objects will not be encrypted so when

167
00:16:14,420 --> 00:16:18,420
you look at an object you'll see this is
the object table you'll see the subject

168
00:16:18,420 --> 00:16:23,949
to the terms of the end it's an action
it has a URL and the euro is this thing

169
00:16:23,950 --> 00:16:32,529
which I can read without detailing so
all of those things contribute to a

170
00:16:32,529 --> 00:16:38,769
little bit of difficulty that we have in
being able to identify and address where

171
00:16:38,769 --> 00:16:47,850
in PDF documents so objects in PDF
language the ones I think are the most

172
00:16:47,850 --> 00:16:52,709
dangerous of these ones here in red and
JavaScript because that's the judgment

173
00:16:52,709 --> 00:16:58,339
scripting language which to do a lot of
things when it's enabled and then open

174
00:16:58,339 --> 00:17:05,549
action open by default and exit i also
very dangerous the accuracy to decode

175
00:17:05,549 --> 00:17:13,549
and rich media and used to supplement
select Send but their little bit harder

176
00:17:13,549 --> 00:17:20,389
to exploit so when you're looking at a
PDF document if you can identify some of

177
00:17:20,390 --> 00:17:26,950
these things are in there that should
raise your alert level a little bit

178
00:17:26,950 --> 00:17:32,960
she you notice a you have a PDF document
it has GPS and JavaScript and a and open

179
00:17:32,960 --> 00:17:39,230
action in it he wear a reason for you to
have all of those in a regular PDF

180
00:17:39,230 --> 00:17:47,440
document at all it's possible that I can
think of one and in the end all of these

181
00:17:47,440 --> 00:17:54,740
things can be areas and all of these
things can be benign you have to be able

182
00:17:54,740 --> 00:17:58,090
to understand the content of the
document that you working on someone to

183
00:17:58,090 --> 00:18:05,949
send you an invoice I would question the
need for having JavaScript an invoice I

184
00:18:05,950 --> 00:18:09,640
would question the need for having
something open as soon as you open job

185
00:18:09,640 --> 00:18:16,820
executing some code when you're just
doing an invoice so this is an

186
00:18:16,820 --> 00:18:24,510
open-access object looks like the object
this is a big number one it's a

187
00:18:24,510 --> 00:18:28,710
catalogue of these outlines and some
pages and then open action which refers

188
00:18:28,710 --> 00:18:33,990
to the number eight when you have that
this is a document opens it probably

189
00:18:33,990 --> 00:18:37,550
opens object number one which might be
the route object in this case it

190
00:18:37,550 --> 00:18:40,060
probably is and then

191
00:18:40,060 --> 00:18:46,600
the fires off a couple of different
pages and then execute the open action

192
00:18:46,600 --> 00:18:58,840
so all of these things are parts of the
PDF structure and this tedious allows

193
00:18:58,840 --> 00:19:06,760
some of our attackers to be able to
inject into PDF documents so at this

194
00:19:06,760 --> 00:19:15,600
point I want to talk a little bit about
some of the tools that we have to get

195
00:19:15,600 --> 00:19:19,669
PDF documents how many of you have seen
work by any one of these three people

196
00:19:19,670 --> 00:19:31,100
love you so Stevens a built-in
researcher has done some incredible work

197
00:19:31,100 --> 00:19:41,379
on where and identifying it and being
able to execute those kinds of things if

198
00:19:41,380 --> 00:19:45,680
you haven't seen his work you're
interested in understanding how that

199
00:19:45,680 --> 00:19:50,990
affects you I would recommend this site
its cities even that it is even so calm

200
00:19:50,990 --> 00:19:56,100
and he's got some incredible tools there
the the two that I find most useful or a

201
00:19:56,100 --> 00:20:04,080
PDF by the in PDF parser DFID is a tool
that you can use you run it as a threat

202
00:20:04,080 --> 00:20:07,260
against your media documents

203
00:20:07,260 --> 00:20:17,250
and it will identify the basic objects
inside of the PDF document to give you

204
00:20:17,250 --> 00:20:26,180
an idea how risky that document is and
as you run that tool if you're under a

205
00:20:26,180 --> 00:20:29,690
lot of PDF documents you'll start to
recognize patterns of turkey recognizes

206
00:20:29,690 --> 00:20:35,240
when certain things are applied together
there are more likely to be dangerous

207
00:20:35,240 --> 00:20:41,380
and when they're a part for example of
an open action together those are likely

208
00:20:41,380 --> 00:20:48,760
to be some sort of nowhere then he also
has a PDF and PDF our stories and much

209
00:20:48,760 --> 00:20:56,410
more in depth tool PDF ideas very simple
very very simple it doesn't do a lot of

210
00:20:56,410 --> 00:21:02,100
musicians inside the PDF document and
the reason for that is because the more

211
00:21:02,100 --> 00:21:07,000
you add to your tool examining PDF
documents are probably have could have

212
00:21:07,000 --> 00:21:12,430
more in the more likely you are to have
some sort of vulnerability included in

213
00:21:12,430 --> 00:21:19,680
that PDF reader as a result DFID is very
small it sorry sixteen and generally

214
00:21:19,680 --> 00:21:26,020
does not include a lot of features that
you would use as far as debugging were

215
00:21:26,020 --> 00:21:30,520
deep investigation into those documents
as well the good thing and a bad thing

216
00:21:30,520 --> 00:21:38,580
but mostly good thing because it can be
used in conjunction with PDF PDF parser

217
00:21:38,580 --> 00:21:43,929
is a more sophisticated tool as far as
investigating the contents of the

218
00:21:43,930 --> 00:21:45,320
documents

219
00:21:45,320 --> 00:21:50,168
when you use PDF parts are you have the
ability to follow an object stream

220
00:21:50,169 --> 00:21:55,580
object I object to decode all of the
filters filter by military and extract

221
00:21:55,580 --> 00:22:04,399
the contents of individual objects as if
they were playing tax anything that's an

222
00:22:04,399 --> 00:22:11,199
awesome tool I do I think that's
incredibly useful know what kind of jobs

223
00:22:11,200 --> 00:22:15,659
have someone has injected into a PDF
document as soon as I'm aware and be

224
00:22:15,659 --> 00:22:20,210
able to come up with patterns to prevent
that from a Senior Network work

225
00:22:20,210 --> 00:22:24,809
installing ransomware on someone's
computer or some sort of back-door shows

226
00:22:24,809 --> 00:22:31,210
like that being able to identify that is
really helpful and it's really hard to

227
00:22:31,210 --> 00:22:36,720
do that when a PDF document has
encrypted streams ran and whites phase

228
00:22:36,720 --> 00:22:43,179
and Kim have any number of filters
applied anyway but the PDF parser allows

229
00:22:43,179 --> 00:22:53,570
you to do that also D PDF I D tool as a
desk here that removes the JavaScript

230
00:22:53,570 --> 00:22:58,049
and open access features the document
and gives you a new PDF talking without

231
00:22:58,049 --> 00:23:04,759
those just removing those things
basically removes most of the

232
00:23:04,759 --> 00:23:08,549
possibility of vulnerability in that
document so if you're trying to remove

233
00:23:08,549 --> 00:23:14,120
media in order to your environment and
the ability to say script pdf doc answer

234
00:23:14,120 --> 00:23:18,959
incoming email you want to read PDF
aidid Ashby then all of these documents

235
00:23:18,960 --> 00:23:21,510
can be modified to remove

236
00:23:21,510 --> 00:23:27,129
items and then moved here immediately on
opening the document which is really

237
00:23:27,130 --> 00:23:27,720
cool

238
00:23:27,720 --> 00:23:32,010
not being able to do that in the simple
command is great I'd also like to

239
00:23:32,010 --> 00:23:38,040
request if anyone here is really good at
C code I'm working on a faster version

240
00:23:38,040 --> 00:23:40,330
of that sort of thing

241
00:23:40,330 --> 00:23:45,210
writing it and see because he is
indicted on and off the pipeline is a

242
00:23:45,210 --> 00:23:52,570
great language not nearly as so I'd like
to do is if anyone has interesting that

243
00:23:52,570 --> 00:23:57,879
works see development skills come talk
to me now to discuss and I would love to

244
00:23:57,880 --> 00:24:02,540
discuss the possibility of you helping
out in building at 201 ability that

245
00:24:02,540 --> 00:24:10,810
allows us to really large PDF documents
in a very short time frame and as we do

246
00:24:10,810 --> 00:24:16,370
that removes these are the most
dangerous without modifying the document

247
00:24:16,370 --> 00:24:23,239
in a way that prevents people to be able
to use it so anyway they're in it with

248
00:24:23,240 --> 00:24:28,020
those two tools that that PDF I D tool
in the PDF parser tool you have the

249
00:24:28,020 --> 00:24:34,879
ability to identify very quickly on a
relative scale using PMID how risky is

250
00:24:34,880 --> 00:24:41,520
this document if you are an icy manager
or security manager and someone sends

251
00:24:41,520 --> 00:24:46,100
you a document and they're not sure if
it's risky you can download pdf idea it

252
00:24:46,100 --> 00:24:52,590
is open source as a link to get home
then I did not post comes from 37 site

253
00:24:52,590 --> 00:24:57,850
and you can tell that to yourself and
running yourself and find out how risky

254
00:24:57,850 --> 00:25:02,550
that is if you find things it includes
JavaScript or open act and says probably

255
00:25:02,550 --> 00:25:03,760
not so great

256
00:25:03,760 --> 00:25:10,010
and you might want to remove those items
the PDF parser is more advanced things

257
00:25:10,010 --> 00:25:14,460
and if you start digging into you will
start to identify someone is getting so

258
00:25:14,460 --> 00:25:22,000
good on to your systems it's worth
noting that executing showed to a PDF

259
00:25:22,000 --> 00:25:25,560
document is not an easy thing to do

260
00:25:25,560 --> 00:25:34,220
simply bcoz PDF readers out there and
most suited in PDF documents are

261
00:25:34,220 --> 00:25:39,600
actually persons the city or software
specific how many of you open PDF

262
00:25:39,600 --> 00:25:47,070
documents with the Adobe Acrobat Reader
to open PDF documents with the different

263
00:25:47,070 --> 00:25:54,010
reader coming to use the Mac prev using
ok to use your browser's with the

264
00:25:54,010 --> 00:26:01,030
built-in Firefox Chrome whatever so all
of those things different code bases and

265
00:26:01,030 --> 00:26:04,910
having different databases means that a
different developer came up with that

266
00:26:04,910 --> 00:26:11,310
and hopefully they got all of the season
they were supposed to but they're

267
00:26:11,310 --> 00:26:15,090
different vulnerability for different
software applications that are used to

268
00:26:15,090 --> 00:26:20,870
open these things when you visit dr. is
hard to determine whether or not you'll

269
00:26:20,870 --> 00:26:22,428
be vulnerable to that

270
00:26:22,429 --> 00:26:26,879
a lot of those things are
vulnerabilities with older versions of

271
00:26:26,879 --> 00:26:34,559
PDF readers so if you haven't seen the
talk he better get updates to update

272
00:26:34,559 --> 00:26:38,428
your PDF readers making sure that your
doctors appt today is also really

273
00:26:38,429 --> 00:26:47,019
important factor in preventing video and
then the next is by Jamie Gillis and he

274
00:26:47,019 --> 00:26:52,440
wrote he PDF and to my knowledge there
isn't any functionality inside that

275
00:26:52,440 --> 00:27:01,220
software that allows you to be able to
remove undesirable pieces of the

276
00:27:01,220 --> 00:27:06,570
document were to detain them so to speak
but it does give you a really good you

277
00:27:06,570 --> 00:27:12,610
inside the PDF document and it's very
similar to the PDF parser a lot of the

278
00:27:12,610 --> 00:27:18,320
things that it returns are very similar
simply because they are reading the same

279
00:27:18,320 --> 00:27:20,789
format in the same kinds of things are
dangerous

280
00:27:20,789 --> 00:27:30,470
the PTS also includes the software that
allows you to kind of a sign a new lease

281
00:27:30,470 --> 00:27:34,809
sale to documents which

282
00:27:34,809 --> 00:27:38,590
really helps what you're trying to
determine how risky is this you don't

283
00:27:38,590 --> 00:27:41,580
want to do the investigating itself if
you just want to strip didn't have a

284
00:27:41,580 --> 00:27:45,490
certain number that says this is risking
up whatever that might be a good thing

285
00:27:45,490 --> 00:27:51,269
for you I guess I also failed to mention
did it is even speedier processor has

286
00:27:51,269 --> 00:27:54,610
the ability for you to plug in
headphones that could do that same kind

287
00:27:54,610 --> 00:28:00,479
of thing for you automatically there
have been a number of atoms that have

288
00:28:00,480 --> 00:28:04,269
been released for that so that's very
helpful as well and then the question

289
00:28:04,269 --> 00:28:09,889
today is preparing for this talk about
what do you do if you're sending out a

290
00:28:09,889 --> 00:28:15,149
PDF document you want to extract all the
metadata added that it's not necessarily

291
00:28:15,149 --> 00:28:18,840
a mall where the question but it is a
PDF reader questions so if you want to

292
00:28:18,840 --> 00:28:26,029
do that you'd probably get indexed tools
by my colleague and essentially draws

293
00:28:26,029 --> 00:28:33,019
the screen for the PDF document takes a
group eg then goes back into a PDF

294
00:28:33,019 --> 00:28:41,330
without many of the meditative which is
also very cool so here's an example

295
00:28:41,330 --> 00:28:52,980
output of media if you submit a comment
the size of a battery which is almost

296
00:28:52,980 --> 00:28:56,150
always true whether or not it's accepted

297
00:28:56,150 --> 00:29:01,210
any objects and streams in there and
nerves which a lot of times areas can

298
00:29:01,210 --> 00:29:07,790
indicate whether or not your document is
not areas then we've got a catalog which

299
00:29:07,790 --> 00:29:14,530
the objects inside of a whole different
object reference then your streams and

300
00:29:14,530 --> 00:29:18,620
then down here the more dangerous stuff
the object for job code suspicious

301
00:29:18,620 --> 00:29:25,729
elements and some heat corruption which
have a CD next to it if you get those

302
00:29:25,730 --> 00:29:31,970
kinds of things out of doors trying to
look at PDF documents that's probably

303
00:29:31,970 --> 00:29:40,370
bad it would be worth also looking at
that CBE or whatever CD that might go up

304
00:29:40,370 --> 00:29:45,040
and if you find that your system is
vulnerable to you either need to not

305
00:29:45,040 --> 00:29:47,780
have people over in that document where
you need to make sure that your software

306
00:29:47,780 --> 00:29:55,030
as fast as possible

307
00:29:55,030 --> 00:30:09,660
document that crashes everytime you open
it chances are that's not very good

308
00:30:09,660 --> 00:30:19,290
views the pilot for the show mister
Roboto you saw this segment of the show

309
00:30:19,290 --> 00:30:26,340
where the gentleman and a CD for his
whatever end someone that into their

310
00:30:26,340 --> 00:30:32,760
computer and they said it doesn't matter
what I do he keeps crashing as soon as I

311
00:30:32,760 --> 00:30:42,520
don't know that's an unhandled exception
occurs love unhandled exceptions because

312
00:30:42,520 --> 00:30:45,920
that means that there's nothing
preventing them from being able to jam

313
00:30:45,920 --> 00:30:50,450
something into memory and hope to
execute code it's usually a trick to get

314
00:30:50,450 --> 00:30:56,560
past that but being able to know that
there is an unhandled exception is very

315
00:30:56,560 --> 00:31:03,280
very helpful so we need to have some
questions what I'd like to do is sit

316
00:31:03,280 --> 00:31:37,220
back and show some line usage of the
media idea to write

317
00:31:37,220 --> 00:31:44,999
my demos directory

318
00:31:44,999 --> 00:31:49,809
couple of styles that are included in
that directory

319
00:31:49,809 --> 00:31:56,199
the PDF documents that are included in
here for PDF documents that I downloaded

320
00:31:56,199 --> 00:32:02,289
from this brief look site as I thought
that would be so inside of you we've got

321
00:32:02,289 --> 00:32:06,829
a book on a tour 2011 wireless networks
the definitive guide second edition how

322
00:32:06,829 --> 00:32:13,178
many of you would like to read a good
book great Photoshop cs6 50 Lightroom

323
00:32:13,179 --> 00:32:25,320
and of that or advanced had a very
testing 123 testing

324
00:32:25,320 --> 00:32:32,668
like I said it's my tongue so soon a
great job but i dont not as fast as

325
00:32:32,669 --> 00:32:52,029
compiled code

326
00:32:52,029 --> 00:33:04,399
their results and let's see we have here
so if you had the PDF headers his first

327
00:33:04,399 --> 00:33:12,059
album by six there's 7374 objects and
700 7074 and objects that's probably

328
00:33:12,059 --> 00:33:18,080
good because they're the same number of
the streams are also the same tables

329
00:33:18,080 --> 00:33:26,918
trailers 414 pages in the document 226
objects unit is down here is the number

330
00:33:26,919 --> 00:33:33,649
one and if you notice a little bit down
further tax reform has a number one this

331
00:33:33,649 --> 00:34:05,439
document probably so that's our first
try another one

332
00:34:05,440 --> 00:34:08,240
thank you to complete that would be
really hard to type without being able

333
00:34:08,239 --> 00:34:21,520
to see it

334
00:34:21,520 --> 00:34:27,918
a lot faster so we have the same number
of Jason Hoppy Jason streams as well

335
00:34:27,918 --> 00:34:34,389
this is a PDF version 1.4 and inside of
your we encrypt object and ingest

336
00:34:34,389 --> 00:34:37,679
objects so there may be more we're in
here but you'll notice there's no edta

337
00:34:37,679 --> 00:34:43,649
open action so if trouble does inspire
the second you open the document that's

338
00:34:43,649 --> 00:36:12,319
probably a good thing

339
00:36:12,320 --> 00:37:12,660
agree

340
00:37:12,660 --> 00:37:28,339
and the open action calls the accuracy
and the Act reformist so is the only to

341
00:37:28,339 --> 00:37:34,849
then not so much so now that you bring
that up with something about a document

342
00:37:34,849 --> 00:37:36,869
that i think is a little bit more
interesting

343
00:37:36,869 --> 00:37:44,579
the Adobe Photoshop cs6 family from the
free book site since I did it

344
00:37:44,579 --> 00:37:51,619
1122 pages but it has five JavaScript
objects 20 size and one open action

345
00:37:51,619 --> 00:38:00,010
items in there so when you open this PDF
document $0.26 fire it is just a book on

346
00:38:00,010 --> 00:38:07,609
Nov three times yes indeed that I don't
know and in the end the reality is that

347
00:38:07,609 --> 00:38:12,319
you need to investigate these documents
one on one you need to look into them

348
00:38:12,319 --> 00:38:19,009
individually to be able to tell is it
somewhere or not the doctors who looked

349
00:38:19,010 --> 00:38:23,000
at today this one seems like the most
obvious one to wear because there are

350
00:38:23,000 --> 00:38:28,069
lots of open actions and lots of a
records all of those things all those

351
00:38:28,069 --> 00:38:31,859
objects are potentially dangerous the
higher the number the more likely they

352
00:38:31,859 --> 00:38:33,150
are to be dangerous

353
00:38:33,150 --> 00:38:37,400
you can also see that there is a
difference between the object center

354
00:38:37,400 --> 00:38:41,470
open and the objects that are intended
that's probably also not a very good

355
00:38:41,470 --> 00:38:49,129
thing and then

356
00:38:49,130 --> 00:38:56,310
run this was the death D

357
00:38:56,310 --> 00:39:00,759
so that's what this says it doesn't
regular expression replacement change

358
00:39:00,760 --> 00:39:05,200
its open action with the capital only
capitulate to everything is the wrong

359
00:39:05,200 --> 00:39:12,790
case and the PDF document reader just
says that is moves on the cool idea

360
00:39:12,790 --> 00:39:40,980
waiting for that GTA question

361
00:39:40,980 --> 00:39:46,940
the question is whether I have seen more
where that is

362
00:39:46,940 --> 00:39:56,670
be attached where or links inside the
the email and said I would say that it's

363
00:39:56,670 --> 00:40:02,670
probably more common to see links inside
the email because there are a couple of

364
00:40:02,670 --> 00:40:07,150
things that are really great about
things inside and email and that is what

365
00:40:07,150 --> 00:40:12,440
number one people click on them over
time and number two you can control

366
00:40:12,440 --> 00:40:16,440
what's on the other end and you can
update it for you can deliver different

367
00:40:16,440 --> 00:40:24,570
content based features that you might be
able to detect when you send out a PDF

368
00:40:24,570 --> 00:40:28,350
document to someone you really hoping
that they have something that you

369
00:40:28,350 --> 00:40:35,560
already have codes or so you know it's
you know he s nowhere specimens really

370
00:40:35,560 --> 00:40:41,920
really good but it works on Windows with
Acrobat Reader seven that's awesome if

371
00:40:41,920 --> 00:40:46,400
the person you are sending to has
Acrobat Reader seven if they don't then

372
00:40:46,400 --> 00:40:51,770
that's not so great and so I mean if I
were trying to create more sophisticated

373
00:40:51,770 --> 00:40:56,380
phishing malware kind of thing it might
even be beneficial to give people a link

374
00:40:56,380 --> 00:41:00,810
to a PDF document on a website does that
answer your question

375
00:41:00,810 --> 00:41:15,130
alright who also has a question relating
to this design that a yes

376
00:41:15,130 --> 00:41:52,150
object program a lot of the same
question

377
00:41:52,150 --> 00:42:03,250
it's really cool to be able to do things
that the full-featured programming

378
00:42:03,250 --> 00:42:06,559
language like like JavaScript as opposed
to just a video of language itself

379
00:42:06,559 --> 00:42:11,329
however the moment you open up a
full-featured language like Java Script

380
00:42:11,329 --> 00:42:15,869
you allow hackers to do things like
bumper overflows and when they did you

381
00:42:15,869 --> 00:42:19,020
vote for overflows they can do not sides
and they can ensure show code and they

382
00:42:19,020 --> 00:42:22,950
can execute that whenever they get to
some sort of unhandled exception and the

383
00:42:22,950 --> 00:42:27,868
same thing applies to the TSS
application also allows for you to

384
00:42:27,869 --> 00:42:32,779
embedded files in there and just say
this is out but somehow someway someone

385
00:42:32,779 --> 00:42:38,010
decided that saving out executable files
is not a good idea so they disallowed

386
00:42:38,010 --> 00:43:00,000
that so at least we have some open that
yes

387
00:43:00,000 --> 00:43:07,530
is some of the PDF said he has seen
actually try to open up jar files and

388
00:43:07,530 --> 00:43:11,740
the end result of that is there's no way
for me to tell you for sure whether

389
00:43:11,740 --> 00:43:17,759
that's bad or not it could be great for
your environment but the GPS allows for

390
00:43:17,760 --> 00:43:23,480
that and that's the real danger the UPS
facility allows for a lot of incredible

391
00:43:23,480 --> 00:43:28,200
features but almost all those incredible
creatures starting with version 1.1

392
00:43:28,200 --> 00:43:34,509
we're really great for attackers evil to
inject for JavaScript stuff being able

393
00:43:34,510 --> 00:43:40,150
to act use forms to inject names being
able to embed told files and save them

394
00:43:40,150 --> 00:43:46,810
out to the disc and some of the
advancement in PDF readers lately have

395
00:43:46,810 --> 00:43:52,180
been you know working on mitigating
those kinds of things by the way if you

396
00:43:52,180 --> 00:43:55,120
haven't updated your PDF reader in the
last little bit you might want to

397
00:43:55,120 --> 00:43:58,910
consider that a lot of vulnerability
three pts in question was little bit

398
00:43:58,910 --> 00:44:07,379
other questions let's take a look at the
results were

399
00:44:07,380 --> 00:44:16,259
removal of those things so we had one
open access the government placed a

400
00:44:16,259 --> 00:44:21,779
couple things and then either another
set of their kind of open access

401
00:44:21,779 --> 00:44:28,480
journals and JavaScript so at the end of
that it also gives you the PDF Editor

402
00:44:28,480 --> 00:44:34,220
results and objects and everything for
that particular document and it shows

403
00:44:34,220 --> 00:44:49,529
you the Council of things before that it
created a new document inside there so

404
00:44:49,529 --> 00:44:56,710
if we do a video by the

405
00:44:56,710 --> 00:45:01,380
the

406
00:45:01,380 --> 00:45:11,390
6 disarmed so take just a minute and it
will show that those things have gone

407
00:45:11,390 --> 00:45:13,470
away which will be really helpful

408
00:45:13,470 --> 00:45:23,310
do we have any other questions like two
minutes left

409
00:45:23,310 --> 00:45:31,390
taco relating to this is in the end I
found the PDF mom wears a very

410
00:45:31,390 --> 00:45:35,580
interesting topics for me I like
research if you want to know more about

411
00:45:35,580 --> 00:45:40,340
this the research done by some of the
people that have created these tools is

412
00:45:40,340 --> 00:45:44,490
incredible D Stevens has a number of
videos that are available on YouTube

413
00:45:44,490 --> 00:45:49,299
he's given talks security conferences
around the world if you want to learn

414
00:45:49,300 --> 00:45:53,680
how to use his tools he's much better
teaching them that I am and you can

415
00:45:53,680 --> 00:45:59,160
learn some great things of that he has a
lot of things and he regularly updates

416
00:45:59,160 --> 00:46:03,890
his tools as well so that's really
helpful and then there have also been a

417
00:46:03,890 --> 00:46:12,200
couple times I think we're definitely
talked about PBS yes

418
00:46:12,200 --> 00:46:20,439
militias PDS Google's free ebooks
that'll be a really quickly to get some

419
00:46:20,440 --> 00:46:27,980
sample ones then you know i i dont know
im pretty sure that did it even has a

420
00:46:27,980 --> 00:46:33,000
number of things he also has another
tool that I didn't mention the stock and

421
00:46:33,000 --> 00:46:38,300
he has a tool that allows you to create
your own and hopefully you use that for

422
00:46:38,300 --> 00:46:46,890
good but that allows you to inject
content into PDF documents in being able

423
00:46:46,890 --> 00:46:52,480
to do that i think is out a meal
understand how that affects PDF

424
00:46:52,480 --> 00:46:56,490
documents and hopefully helps you to be
able to identify those kinds of things

425
00:46:56,490 --> 00:47:00,729
inside of your PDF documents was
answered questions first where you can

426
00:47:00,730 --> 00:47:07,500
get those and what you should do about
it maybe I i dont have a repository that

427
00:47:07,500 --> 00:47:12,599
I can help with that which is probably
okay because I wanted to show you where

428
00:47:12,599 --> 00:47:20,050
right so if you look at the results the
DFID now it looks a whole lot better

429
00:47:20,050 --> 00:47:25,730
all those objects that can be seen as
negative have disappeared

430
00:47:25,730 --> 00:47:32,540
and is that did not negatively impact
the document in any way you can still

431
00:47:32,540 --> 00:47:38,500
read all of the things that you want why
not there's nothing that prevents you

432
00:47:38,500 --> 00:47:41,390
from being able to do it if you can do
that across your organization for every

433
00:47:41,390 --> 00:47:45,740
PDF coming into your email can you solve
that problem of people emailing you in

434
00:47:45,740 --> 00:47:48,750
PDF said this is an invoice for
such-and-such to your accounting

435
00:47:48,750 --> 00:47:53,359
department and they open it up and now
you're counting hauser ransomware to

436
00:47:53,359 --> 00:48:00,730
whatever so that the other tools that an
elicitor also very helpful

437
00:48:00,730 --> 00:48:07,000
any other questions okay thank you very
much

