1
00:00:00,060 --> 00:00:07,770
mic works PowerPoint works we're halfway

2
00:00:03,360 --> 00:00:12,360
there so a quick introduction Adam

3
00:00:07,770 --> 00:00:13,980
Fisher bendin IT security for a long

4
00:00:12,360 --> 00:00:15,959
time

5
00:00:13,980 --> 00:00:19,740
flew in from San Jose today spent half

6
00:00:15,960 --> 00:00:21,449
my week on a plane if not more have like

7
00:00:19,740 --> 00:00:25,500
most people have really turned my focus

8
00:00:21,449 --> 00:00:28,080
to cloud solutions and a lot of my

9
00:00:25,500 --> 00:00:30,689
customers that I work with now are you

10
00:00:28,080 --> 00:00:34,550
know any WS as you're focused or are

11
00:00:30,689 --> 00:00:34,550
moving they're in some shape or form

12
00:00:34,730 --> 00:00:39,959
early from Pennsylvania came out to Salt

13
00:00:37,290 --> 00:00:42,690
Lake City in 2001 graduated from Utah

14
00:00:39,960 --> 00:00:47,430
Valley University made a Utah girl known

15
00:00:42,690 --> 00:00:51,809
from Utah and security in security

16
00:00:47,430 --> 00:00:54,750
because of wind nuke 95 and ICQ so when

17
00:00:51,809 --> 00:00:56,250
I say wind nuke 95 and every time I

18
00:00:54,750 --> 00:00:59,340
present and every time I ask this

19
00:00:56,250 --> 00:01:03,199
question the hands get less who knows

20
00:00:59,340 --> 00:01:06,900
what when nuke 95 is one two three four

21
00:01:03,199 --> 00:01:09,658
it's getting less no window 95 oh

22
00:01:06,900 --> 00:01:12,810
there's a okay that's good so Windows 95

23
00:01:09,659 --> 00:01:17,070
was a great tool that would send an out

24
00:01:12,810 --> 00:01:19,430
of bound to a Windows 95 machine and

25
00:01:17,070 --> 00:01:23,008
cause a blue screen of death

26
00:01:19,430 --> 00:01:26,100
ICQ was a chat protocol - may be

27
00:01:23,009 --> 00:01:28,770
familiar with ICQ that gratefully

28
00:01:26,100 --> 00:01:32,309
exposed the IP address of your attack of

29
00:01:28,770 --> 00:01:34,048
your person you're chatting with and was

30
00:01:32,310 --> 00:01:36,119
often fun to watch those people just

31
00:01:34,049 --> 00:01:38,490
drop out of chat rooms left and right if

32
00:01:36,119 --> 00:01:41,040
you just take their computer offline and

33
00:01:38,490 --> 00:01:43,289
so that really got me into all right

34
00:01:41,040 --> 00:01:46,710
this is some cool stuff the fact that I

35
00:01:43,290 --> 00:01:49,220
could be sitting remotely you know in my

36
00:01:46,710 --> 00:01:51,479
house and I could take somebody off line

37
00:01:49,220 --> 00:01:53,070
other side of the world as I had the

38
00:01:51,479 --> 00:01:58,200
country out of the state whatever it may

39
00:01:53,070 --> 00:01:59,880
be was pretty appealing today we're

40
00:01:58,200 --> 00:02:01,590
gonna talk a little bit about a new

41
00:01:59,880 --> 00:02:06,960
attack vector that I would say has

42
00:02:01,590 --> 00:02:09,149
gained a lot of exposure over the last

43
00:02:06,960 --> 00:02:10,769
18 months it goes by a couple different

44
00:02:09,149 --> 00:02:13,110
names we got credential stuffing out

45
00:02:10,770 --> 00:02:16,440
there I can be referred to as a count

46
00:02:13,110 --> 00:02:20,400
Gover really what this is is an

47
00:02:16,440 --> 00:02:21,630
evolution of password theft down at the

48
00:02:20,400 --> 00:02:24,600
gate it's just stealing people's

49
00:02:21,630 --> 00:02:26,940
passwords and reusing those passwords to

50
00:02:24,600 --> 00:02:28,049
take over their online accounts and

51
00:02:26,940 --> 00:02:30,090
that's what we're going to review today

52
00:02:28,050 --> 00:02:32,880
we're going to go through a couple

53
00:02:30,090 --> 00:02:35,100
threat patterns why it's important we're

54
00:02:32,880 --> 00:02:37,560
gonna look at a tool that can then be

55
00:02:35,100 --> 00:02:40,340
used to you launch these account

56
00:02:37,560 --> 00:02:44,940
takeover attacks and what it takes to

57
00:02:40,340 --> 00:02:46,560
mitigate those attacks from us from a

58
00:02:44,940 --> 00:02:51,480
security perspective to protect

59
00:02:46,560 --> 00:02:53,850
ourselves so first off kind of setting

60
00:02:51,480 --> 00:02:55,500
the stage here online accounts are

61
00:02:53,850 --> 00:02:57,900
valuable obviously if you think about

62
00:02:55,500 --> 00:02:59,880
all the websites that we log into what

63
00:02:57,900 --> 00:03:04,170
would happen if somebody else had your

64
00:02:59,880 --> 00:03:07,650
account and it's we're full of examples

65
00:03:04,170 --> 00:03:08,730
of you know what happens when people

66
00:03:07,650 --> 00:03:11,310
drain their bank account

67
00:03:08,730 --> 00:03:14,220
take your award points get to your

68
00:03:11,310 --> 00:03:17,760
financial data and those accounts have

69
00:03:14,220 --> 00:03:21,239
have value the three main avenues that

70
00:03:17,760 --> 00:03:23,640
we see is data breaches and we're all

71
00:03:21,239 --> 00:03:25,769
familiar with those the other way that

72
00:03:23,640 --> 00:03:28,920
we're gonna get or if somebody would get

73
00:03:25,769 --> 00:03:31,980
your account is malware keylogging they

74
00:03:28,920 --> 00:03:34,018
they install a virus or malware on your

75
00:03:31,980 --> 00:03:35,630
machine as you visit those sites they

76
00:03:34,019 --> 00:03:37,709
they take your credentials and then

77
00:03:35,630 --> 00:03:41,280
phishing and we've seen phishing

78
00:03:37,709 --> 00:03:45,060
attempts by far and away the most common

79
00:03:41,280 --> 00:03:47,760
here is data breaches I do have us a

80
00:03:45,060 --> 00:03:52,350
little slide here on that but this this

81
00:03:47,760 --> 00:03:55,170
barely touches you know it touches the

82
00:03:52,350 --> 00:03:57,299
the front door just breaches the surface

83
00:03:55,170 --> 00:04:01,649
on the amount of data theft there is

84
00:03:57,299 --> 00:04:04,350
here it seems like every week you know

85
00:04:01,650 --> 00:04:07,110
we see businesses that have exposed

86
00:04:04,350 --> 00:04:11,100
customer data and expose those login

87
00:04:07,110 --> 00:04:14,640
credentials and what the next step here

88
00:04:11,100 --> 00:04:18,450
isn't so much that oh I I have this

89
00:04:14,640 --> 00:04:20,570
breach I'm then gonna go and log in with

90
00:04:18,450 --> 00:04:23,280
those accounts the idea is to sell those

91
00:04:20,570 --> 00:04:25,670
right so once we have those accounts

92
00:04:23,280 --> 00:04:28,559
we're going to sell them

93
00:04:25,670 --> 00:04:30,150
and there's various various sites out

94
00:04:28,560 --> 00:04:33,380
there that can be used this leak source

95
00:04:30,150 --> 00:04:36,090
is one that is pretty popular that I see

96
00:04:33,380 --> 00:04:39,690
seems to have a lot of good stuff on

97
00:04:36,090 --> 00:04:41,520
there as far as once a breach happens

98
00:04:39,690 --> 00:04:45,360
leaks or stems to be like one of the

99
00:04:41,520 --> 00:04:49,080
first ones to expose it now what's

100
00:04:45,360 --> 00:04:53,000
interesting is by the time we see those

101
00:04:49,080 --> 00:04:55,229
leak credentials come up for sale

102
00:04:53,000 --> 00:04:58,200
they've already been validated

103
00:04:55,230 --> 00:04:59,610
they've already been used if somebody's

104
00:04:58,200 --> 00:05:01,740
selling them it's usually because the

105
00:04:59,610 --> 00:05:04,170
hackers that already had them went

106
00:05:01,740 --> 00:05:07,050
through got what they could out of it

107
00:05:04,170 --> 00:05:09,900
and okay now we're gonna sell them to

108
00:05:07,050 --> 00:05:13,170
get the last little bit of of money we

109
00:05:09,900 --> 00:05:15,359
can out of our breach a good

110
00:05:13,170 --> 00:05:20,280
presentation is nothing without a few

111
00:05:15,360 --> 00:05:21,600
numbers and out of the Google passwords

112
00:05:20,280 --> 00:05:23,340
that they are they you know the latest

113
00:05:21,600 --> 00:05:27,390
when I saw here from a Google was 67

114
00:05:23,340 --> 00:05:29,010
million passwords now even me being in

115
00:05:27,390 --> 00:05:31,950
security I have no shame in admitting

116
00:05:29,010 --> 00:05:35,099
this I really use my passwords not every

117
00:05:31,950 --> 00:05:36,420
single one but I have I have a number of

118
00:05:35,100 --> 00:05:38,580
passwords that I'm just gonna recycle

119
00:05:36,420 --> 00:05:40,440
through that way when I forget my

120
00:05:38,580 --> 00:05:41,580
password I can usually get it within

121
00:05:40,440 --> 00:05:43,650
four or five tries

122
00:05:41,580 --> 00:05:45,090
and that's about as long as I can go

123
00:05:43,650 --> 00:05:48,570
before you're like you're locked out and

124
00:05:45,090 --> 00:05:49,679
then you're really screwed right and I'm

125
00:05:48,570 --> 00:05:51,420
pretty sure everybody else in this room

126
00:05:49,680 --> 00:05:53,550
you know I talked to enough security

127
00:05:51,420 --> 00:05:56,760
professionals we all reuse passwords in

128
00:05:53,550 --> 00:05:58,020
one shape or form if you don't maybe you

129
00:05:56,760 --> 00:05:59,940
have like a password manager or

130
00:05:58,020 --> 00:06:01,919
something hats off to you that's great I

131
00:05:59,940 --> 00:06:05,070
still don't find that that works across

132
00:06:01,920 --> 00:06:07,050
enough of my devices and I get LastPass

133
00:06:05,070 --> 00:06:09,780
is pretty good at it and if you buy into

134
00:06:07,050 --> 00:06:12,240
the chrome atmosphere then that can do

135
00:06:09,780 --> 00:06:13,590
pretty good across multiple devices but

136
00:06:12,240 --> 00:06:15,120
nothing frustrates me more when I

137
00:06:13,590 --> 00:06:17,789
actually did set some super-secret

138
00:06:15,120 --> 00:06:19,680
password that only my password manager

139
00:06:17,790 --> 00:06:21,740
can enter and then on my mobile device

140
00:06:19,680 --> 00:06:24,600
and I can't freakin get into the site

141
00:06:21,740 --> 00:06:27,000
once that happened I was done and I was

142
00:06:24,600 --> 00:06:28,560
like I said now I have it now I have a

143
00:06:27,000 --> 00:06:31,200
handful of passwords that I rotate

144
00:06:28,560 --> 00:06:33,810
through and usually I can get to it in

145
00:06:31,200 --> 00:06:36,450
about four or five guesses so we're all

146
00:06:33,810 --> 00:06:37,950
guilty of that and that's that's why you

147
00:06:36,450 --> 00:06:38,750
know when we see this as we go through

148
00:06:37,950 --> 00:06:42,270
the high

149
00:06:38,750 --> 00:06:45,150
why it makes sense that one attackers

150
00:06:42,270 --> 00:06:48,479
are gonna spend time to get to a set of

151
00:06:45,150 --> 00:06:50,849
usernames and passwords first that they

152
00:06:48,479 --> 00:06:52,770
know exists and know is being used and

153
00:06:50,850 --> 00:06:55,260
then second their that's what they're

154
00:06:52,770 --> 00:06:58,260
gonna guess with if I'm a real attacker

155
00:06:55,260 --> 00:07:01,650
for me to launch an attack against a

156
00:06:58,260 --> 00:07:02,810
website and cross my fingers that I'm

157
00:07:01,650 --> 00:07:06,090
gonna get a username password

158
00:07:02,810 --> 00:07:08,970
combination do it may be successful is

159
00:07:06,090 --> 00:07:11,849
gonna cost me a lot of money a whole lot

160
00:07:08,970 --> 00:07:15,180
of time and by the time I get to it it's

161
00:07:11,850 --> 00:07:18,840
it's nearly useless so I want to start

162
00:07:15,180 --> 00:07:20,340
from a known set of identities if I'm

163
00:07:18,840 --> 00:07:24,119
gonna get to the data that that user

164
00:07:20,340 --> 00:07:26,698
account has access to so in the next

165
00:07:24,120 --> 00:07:31,080
couple slides I have some examples of

166
00:07:26,699 --> 00:07:35,010
real data breaches here from a tool that

167
00:07:31,080 --> 00:07:37,740
I have access to and we're gonna walk

168
00:07:35,010 --> 00:07:40,380
through this console in more detail here

169
00:07:37,740 --> 00:07:44,190
later but just to show you kind of how

170
00:07:40,380 --> 00:07:46,050
the an attack you know how an attacker

171
00:07:44,190 --> 00:07:48,599
might may think is he's coming through

172
00:07:46,050 --> 00:07:50,490
here and launching an attack this is a

173
00:07:48,599 --> 00:07:53,360
tool here that specifically monitors

174
00:07:50,490 --> 00:07:56,970
login activity for that malicious

175
00:07:53,360 --> 00:07:59,520
activity here and so the first thing the

176
00:07:56,970 --> 00:08:02,099
gray box here this is just login

177
00:07:59,520 --> 00:08:04,710
attempts not necessarily malicious or

178
00:08:02,099 --> 00:08:06,630
anything but login attempts the yellow

179
00:08:04,710 --> 00:08:08,520
line then are the ones that are deemed

180
00:08:06,630 --> 00:08:11,190
malicious and the blue line that we see

181
00:08:08,520 --> 00:08:14,430
catching up here is when the algorithm

182
00:08:11,190 --> 00:08:17,250
kicks in and starts blocking attacks so

183
00:08:14,430 --> 00:08:18,990
this is pretty standard from you know

184
00:08:17,250 --> 00:08:22,020
somebody's just launching a wave in a

185
00:08:18,990 --> 00:08:25,260
wave of attacks and you'll see this kind

186
00:08:22,020 --> 00:08:28,169
of ramped up usually during a

187
00:08:25,260 --> 00:08:31,740
reconnaissance phase so what I mean by

188
00:08:28,169 --> 00:08:35,069
that is it's slow its steady they're

189
00:08:31,740 --> 00:08:37,589
just trying to see what security tools

190
00:08:35,070 --> 00:08:40,229
are in play here is there any

191
00:08:37,589 --> 00:08:43,469
rate-limiting gonna happen are you

192
00:08:40,229 --> 00:08:45,690
blocking countries anything around

193
00:08:43,469 --> 00:08:47,130
around the gamut right so they're gonna

194
00:08:45,690 --> 00:08:50,250
they're they're trying to get some

195
00:08:47,130 --> 00:08:51,389
feedback as to what is gonna trigger one

196
00:08:50,250 --> 00:08:55,769
of your security

197
00:08:51,389 --> 00:08:58,699
to mitigate the activity after that

198
00:08:55,769 --> 00:08:59,999
you're gonna get into what I call spikes

199
00:08:58,699 --> 00:09:02,339
alright

200
00:08:59,999 --> 00:09:05,579
so now they get a feel for what's going

201
00:09:02,339 --> 00:09:08,910
on and they're gonna ramp it up okay now

202
00:09:05,579 --> 00:09:13,079
they want to see how fast they can get

203
00:09:08,910 --> 00:09:16,199
through a list before the rate limit or

204
00:09:13,079 --> 00:09:20,719
something kicks in by this time they

205
00:09:16,199 --> 00:09:23,519
have already created five six ten twelve

206
00:09:20,720 --> 00:09:26,100
legitimate accounts in your website if

207
00:09:23,519 --> 00:09:27,809
it's an e-commerce site they've already

208
00:09:26,100 --> 00:09:30,299
gone through the login process with

209
00:09:27,809 --> 00:09:32,879
legitimate accounts a number of times

210
00:09:30,299 --> 00:09:35,730
they've even purchased real things are

211
00:09:32,879 --> 00:09:38,249
signed up for real services a number of

212
00:09:35,730 --> 00:09:40,799
times so they have the complete flow of

213
00:09:38,249 --> 00:09:43,829
what they need to do once they find a

214
00:09:40,799 --> 00:09:45,360
legitimate account so now that they have

215
00:09:43,829 --> 00:09:46,979
that now they're gonna see how fast they

216
00:09:45,360 --> 00:09:49,889
can get through it okay and you're gonna

217
00:09:46,980 --> 00:09:53,100
start seeing them ramped up now from a

218
00:09:49,889 --> 00:09:56,610
security perspective we love lots of

219
00:09:53,100 --> 00:09:58,169
data we love lots of anomalies and

220
00:09:56,610 --> 00:10:00,299
that's what happens when things kick up

221
00:09:58,169 --> 00:10:01,679
so what you'll see are some of the

222
00:10:00,299 --> 00:10:06,029
spikes here and we'll see this when we

223
00:10:01,679 --> 00:10:09,809
launch an attack here is most of these

224
00:10:06,029 --> 00:10:13,350
types of tools will allow the first 20

225
00:10:09,809 --> 00:10:14,910
30 maybe 40 requests in and then start

226
00:10:13,350 --> 00:10:16,649
shutting it down because the algorithm

227
00:10:14,910 --> 00:10:19,319
starts picking up on those own those

228
00:10:16,649 --> 00:10:22,259
anomalies and then you're gonna get

229
00:10:19,319 --> 00:10:24,209
something like this so yeah I'll back up

230
00:10:22,259 --> 00:10:25,829
here actually and just talk about some

231
00:10:24,209 --> 00:10:27,839
of these numbers so you can see this

232
00:10:25,829 --> 00:10:29,099
scale of the attack and I'm not sure the

233
00:10:27,839 --> 00:10:31,619
numbers show up there that cuz they're

234
00:10:29,100 --> 00:10:35,549
kind of small on my screen but we had

235
00:10:31,619 --> 00:10:39,419
here within a seven day period 15 point

236
00:10:35,549 --> 00:10:42,929
4 million login attempts out of which

237
00:10:39,419 --> 00:10:46,139
fifteen point three nine were deemed

238
00:10:42,929 --> 00:10:49,019
malicious enough to be mitigated that's

239
00:10:46,139 --> 00:10:50,399
a lot of logins for seven days okay

240
00:10:49,019 --> 00:10:53,549
that's a really busy site and this

241
00:10:50,399 --> 00:10:58,799
wasn't like an Amazon site right you

242
00:10:53,549 --> 00:11:00,990
know and so this is what when I talk

243
00:10:58,799 --> 00:11:02,879
about ramping up this is ramping up

244
00:11:00,990 --> 00:11:04,270
they're gonna start sending multiple

245
00:11:02,879 --> 00:11:07,180
multiple requests

246
00:11:04,270 --> 00:11:10,449
and then you'll start seeing a level out

247
00:11:07,180 --> 00:11:12,010
and they're gonna get to a point they're

248
00:11:10,450 --> 00:11:13,510
gonna basically get to a point where

249
00:11:12,010 --> 00:11:15,640
they can send as many requests as

250
00:11:13,510 --> 00:11:18,520
possible where it's under your rate

251
00:11:15,640 --> 00:11:21,580
limit and it is not going to take down

252
00:11:18,520 --> 00:11:23,439
your web server right and so now this

253
00:11:21,580 --> 00:11:26,980
levels out and they're sending about two

254
00:11:23,440 --> 00:11:30,160
million you know so we'll see things

255
00:11:26,980 --> 00:11:32,500
like that and then on a normal day this

256
00:11:30,160 --> 00:11:34,990
is what you should see everything's

257
00:11:32,500 --> 00:11:37,630
green you have that nice bell curve that

258
00:11:34,990 --> 00:11:39,310
we all see in our network graphs people

259
00:11:37,630 --> 00:11:41,410
go to bed and they wake up they go to

260
00:11:39,310 --> 00:11:45,510
bed they wake up and that's what we

261
00:11:41,410 --> 00:11:45,510
expect to see from normal login activity

262
00:11:46,170 --> 00:11:53,349
okay so let's get into this year how

263
00:11:50,860 --> 00:11:55,300
does this how does this happen first off

264
00:11:53,350 --> 00:11:56,950
they have to breach and harvest the

265
00:11:55,300 --> 00:11:59,319
credentials or they have to go and buy

266
00:11:56,950 --> 00:12:00,940
credentials from somebody else and we'll

267
00:11:59,320 --> 00:12:02,500
get into why you have to do that there's

268
00:12:00,940 --> 00:12:07,089
no way we wouldn't start a credential

269
00:12:02,500 --> 00:12:09,130
attack from ground zero the next thing

270
00:12:07,089 --> 00:12:11,110
you need to do is send us through

271
00:12:09,130 --> 00:12:14,800
multiple proxies you're going to either

272
00:12:11,110 --> 00:12:16,390
have to own a botnet rent a botnet but

273
00:12:14,800 --> 00:12:19,540
you cannot launch an attack from a

274
00:12:16,390 --> 00:12:21,220
single IP address once you gain access

275
00:12:19,540 --> 00:12:24,910
so we're gonna we're gonna log in a

276
00:12:21,220 --> 00:12:28,630
million times we hope for a hundred two

277
00:12:24,910 --> 00:12:31,029
hundred a thousand good hits out of that

278
00:12:28,630 --> 00:12:33,579
then we go through the login process the

279
00:12:31,029 --> 00:12:36,490
control server the bot Network then

280
00:12:33,579 --> 00:12:38,410
knows how to manipulate the site to get

281
00:12:36,490 --> 00:12:41,529
the endgame that's going to take the

282
00:12:38,410 --> 00:12:43,750
medical records drain the account steal

283
00:12:41,529 --> 00:12:48,880
the funds drain the gift cards whatever

284
00:12:43,750 --> 00:12:50,770
it may be fraud of some sort and that's

285
00:12:48,880 --> 00:12:53,740
that's exactly what they're after now

286
00:12:50,770 --> 00:12:56,980
some some accounts will actually stop at

287
00:12:53,740 --> 00:12:58,510
step three and they will have the breach

288
00:12:56,980 --> 00:13:00,880
they're going to get all these accounts

289
00:12:58,510 --> 00:13:03,490
and they're going to target a specific a

290
00:13:00,880 --> 00:13:06,820
specific company a specific site a

291
00:13:03,490 --> 00:13:09,600
specific bank one of the worst customers

292
00:13:06,820 --> 00:13:14,140
that I saw here was a very small

293
00:13:09,600 --> 00:13:16,180
regional bank out of st. Louis normally

294
00:13:14,140 --> 00:13:17,710
they they might see five to six hundred

295
00:13:16,180 --> 00:13:20,199
logins on their site

296
00:13:17,710 --> 00:13:24,460
and all of a sudden it was in the

297
00:13:20,200 --> 00:13:26,440
millions in the millions and I mean that

298
00:13:24,460 --> 00:13:28,600
there poor guys were were flooded to

299
00:13:26,440 --> 00:13:31,050
death had no idea to how to handle it

300
00:13:28,600 --> 00:13:34,720
but it wasn't so much that they were

301
00:13:31,050 --> 00:13:36,279
that they were after the records or

302
00:13:34,720 --> 00:13:38,230
after those bank accounts they wanted to

303
00:13:36,279 --> 00:13:40,209
know which logins were successful and

304
00:13:38,230 --> 00:13:43,029
they were taking those and then selling

305
00:13:40,209 --> 00:13:45,279
those out on the dark web so their their

306
00:13:43,029 --> 00:13:47,830
job was we're gonna take all of the

307
00:13:45,279 --> 00:13:51,070
breach data that we see and just see

308
00:13:47,830 --> 00:13:53,440
who's reusing that gmail email and

309
00:13:51,070 --> 00:13:56,020
password to log in to this bank site and

310
00:13:53,440 --> 00:13:59,350
then that was enough for us to go out

311
00:13:56,020 --> 00:14:02,260
and say hey here's 600 accounts that can

312
00:13:59,350 --> 00:14:04,390
login to that bank and that that for

313
00:14:02,260 --> 00:14:07,240
them was the asset so there's oftentimes

314
00:14:04,390 --> 00:14:09,370
two two ways you'll see there I

315
00:14:07,240 --> 00:14:11,200
personally feel and where I've seen is

316
00:14:09,370 --> 00:14:13,810
the steal asset methodology if

317
00:14:11,200 --> 00:14:17,800
somebody's after what's behind that

318
00:14:13,810 --> 00:14:20,020
login they're more sophisticated they're

319
00:14:17,800 --> 00:14:22,959
not gonna go away they don't give up for

320
00:14:20,020 --> 00:14:24,850
them the endgame is is that medical

321
00:14:22,959 --> 00:14:27,219
record in the healthcare portal or

322
00:14:24,850 --> 00:14:29,470
whatever it may be okay they're more

323
00:14:27,220 --> 00:14:31,540
sophisticated if you're if your website

324
00:14:29,470 --> 00:14:34,209
is protecting or has access to those

325
00:14:31,540 --> 00:14:35,980
types of that type of data just expect

326
00:14:34,209 --> 00:14:40,449
to have a more sophisticated attack and

327
00:14:35,980 --> 00:14:42,250
we'll get into some of that okay I'm

328
00:14:40,450 --> 00:14:44,200
gonna go through this I'm gonna go

329
00:14:42,250 --> 00:14:45,970
through that and then this will be the

330
00:14:44,200 --> 00:14:48,430
endgame so after this we'll jump into

331
00:14:45,970 --> 00:14:52,990
the demo and we'll start walking through

332
00:14:48,430 --> 00:14:55,420
Hydra but eventually eventually this is

333
00:14:52,990 --> 00:14:58,060
what's going to happen to your data it's

334
00:14:55,420 --> 00:15:00,849
going to be distributed it's no longer

335
00:14:58,060 --> 00:15:03,819
going to be coming from you know a

336
00:15:00,850 --> 00:15:08,260
single IP address or a handful of IPs

337
00:15:03,820 --> 00:15:10,180
it's gonna be a globally distributed so

338
00:15:08,260 --> 00:15:12,939
you can't really hone in on it or target

339
00:15:10,180 --> 00:15:14,560
it it's gonna be on a login page but

340
00:15:12,940 --> 00:15:17,110
then it's gonna be a very slow request

341
00:15:14,560 --> 00:15:19,689
rate we're talking one two three

342
00:15:17,110 --> 00:15:21,940
requests per IP and then they're off to

343
00:15:19,690 --> 00:15:24,430
the next IP address and why do they do

344
00:15:21,940 --> 00:15:28,900
that because they don't want there to be

345
00:15:24,430 --> 00:15:31,199
a spike a noticeable spike then your

346
00:15:28,900 --> 00:15:34,300
normal requests per second traffic

347
00:15:31,200 --> 00:15:38,170
it has to blend into normal daytime

348
00:15:34,300 --> 00:15:40,209
bell-curve traffic and and you'll see

349
00:15:38,170 --> 00:15:42,550
that you know you'll you'll see them

350
00:15:40,210 --> 00:15:47,890
mask it so that just as part of your

351
00:15:42,550 --> 00:15:51,150
busiest time of the day all right okay

352
00:15:47,890 --> 00:15:54,970
good so I'm sure I've been timed out of

353
00:15:51,150 --> 00:15:57,360
90% of my stuff but the first thing I'm

354
00:15:54,970 --> 00:15:58,600
going to do is just introduce us to

355
00:15:57,360 --> 00:16:03,010
Hydra

356
00:15:58,600 --> 00:16:04,900
now Hydra is a credential stuffing tool

357
00:16:03,010 --> 00:16:10,270
for lack of a better description it

358
00:16:04,900 --> 00:16:12,310
allows me to define a website define the

359
00:16:10,270 --> 00:16:14,710
usernames and passwords that I want to

360
00:16:12,310 --> 00:16:17,560
use to then try and log in to that

361
00:16:14,710 --> 00:16:18,700
website it requires a few bits of

362
00:16:17,560 --> 00:16:22,209
information and we're going to walk

363
00:16:18,700 --> 00:16:23,890
through that so first a single target

364
00:16:22,210 --> 00:16:27,280
where I can do multiple targets I can

365
00:16:23,890 --> 00:16:30,100
have a text file of URLs that I want to

366
00:16:27,280 --> 00:16:32,439
attack so I put my URL in here I put the

367
00:16:30,100 --> 00:16:33,760
port that I want to attack on and then I

368
00:16:32,440 --> 00:16:36,310
want to put the protocol now there's

369
00:16:33,760 --> 00:16:38,050
lots of different options here you know

370
00:16:36,310 --> 00:16:41,829
I could have chose to try and brute

371
00:16:38,050 --> 00:16:43,359
force an FTP site or an SSH login I can

372
00:16:41,830 --> 00:16:45,760
try and brute force an edge firewall the

373
00:16:43,360 --> 00:16:47,740
at Cisco in here all that kind of good

374
00:16:45,760 --> 00:16:48,910
stuff so we're not gonna focus on all of

375
00:16:47,740 --> 00:16:53,950
that we're going to specifically focus

376
00:16:48,910 --> 00:16:56,319
today on HTTP POST and that's something

377
00:16:53,950 --> 00:16:59,770
because the website that I have needs

378
00:16:56,320 --> 00:17:06,180
post it required a post form so what we

379
00:16:59,770 --> 00:17:06,180
have here thank you

380
00:17:09,210 --> 00:17:15,660
that's weird let me try this

381
00:17:21,419 --> 00:17:29,699
sweet okay all right good thanks let me

382
00:17:25,628 --> 00:17:29,698
know all right so where I'm at here is

383
00:17:30,629 --> 00:17:39,580
ya I'm gonna jump ahead a little bit

384
00:17:36,730 --> 00:17:40,659
everybody should see this site so if

385
00:17:39,580 --> 00:17:44,139
you're out there and you want to browse

386
00:17:40,659 --> 00:17:45,190
the Fish Hatchery net and just start

387
00:17:44,139 --> 00:17:48,158
clicking around that would give me some

388
00:17:45,190 --> 00:17:50,289
traffic don't ddos it or like break it

389
00:17:48,159 --> 00:17:52,350
or anything please at least for the next

390
00:17:50,289 --> 00:17:54,519
45 minutes then you're and you're free

391
00:17:52,350 --> 00:17:56,740
okay but what we need to do here

392
00:17:54,519 --> 00:17:58,840
whenever like so if I'm an attacker I'm

393
00:17:56,740 --> 00:18:00,940
gonna use Hydra there's a couple things

394
00:17:58,840 --> 00:18:03,158
I need to do so like I said I need to go

395
00:18:00,940 --> 00:18:04,720
through a login I need to know what the

396
00:18:03,159 --> 00:18:05,889
login is gonna look like the first thing

397
00:18:04,720 --> 00:18:08,379
I'm going to do is come into the dev

398
00:18:05,889 --> 00:18:10,479
tools I'll refresh and when they get

399
00:18:08,379 --> 00:18:13,029
basically pull down the information for

400
00:18:10,480 --> 00:18:14,379
the site I've got a login button here in

401
00:18:13,029 --> 00:18:18,519
some sites like this right when I do

402
00:18:14,379 --> 00:18:21,009
this it brings up a form but I don't see

403
00:18:18,519 --> 00:18:23,529
the log it where the login request is

404
00:18:21,009 --> 00:18:34,240
going to go over here yet so when I log

405
00:18:23,529 --> 00:18:41,799
in I then get where am I at

406
00:18:34,240 --> 00:18:46,320
I get spinny bars so what I'm after is

407
00:18:41,799 --> 00:18:50,549
the login.php let me just refresh this

408
00:18:46,320 --> 00:18:50,549
make sure I type in the password right

409
00:18:55,290 --> 00:19:03,030
so the login.php is what I want here and

410
00:18:58,300 --> 00:19:07,960
we can see that this is Ajax analog in

411
00:19:03,030 --> 00:19:11,260
PHP this URL is where the request goes

412
00:19:07,960 --> 00:19:12,430
and so this is the request that we need

413
00:19:11,260 --> 00:19:14,950
so if I'm going to do this with another

414
00:19:12,430 --> 00:19:18,910
site this is what I would have to go and

415
00:19:14,950 --> 00:19:22,450
pull off ok the quest is a post this is

416
00:19:18,910 --> 00:19:28,930
what I want to get to so I would take

417
00:19:22,450 --> 00:19:40,990
that then and Hydra and I'm gonna add

418
00:19:28,930 --> 00:19:43,840
this to to my specific URL path here so

419
00:19:40,990 --> 00:19:45,460
wanna make sure people see this that's

420
00:19:43,840 --> 00:19:48,010
the first step you have to grab where

421
00:19:45,460 --> 00:19:49,000
that request is going to go and as an

422
00:19:48,010 --> 00:19:50,620
attacker this is part of my

423
00:19:49,000 --> 00:19:54,820
reconnaissance that I was doing any web

424
00:19:50,620 --> 00:19:56,949
site the next thing I'm going to do here

425
00:19:54,820 --> 00:20:00,460
is to find my usernames and passwords

426
00:19:56,950 --> 00:20:02,320
that I want to guess so if I am

427
00:20:00,460 --> 00:20:05,860
specifically going after a known user

428
00:20:02,320 --> 00:20:07,330
see so CEO CIO somebody famous right

429
00:20:05,860 --> 00:20:09,490
then I want to try and grab a user name

430
00:20:07,330 --> 00:20:12,040
for I can drop it right in there and

431
00:20:09,490 --> 00:20:14,890
just try and guess passwords against a

432
00:20:12,040 --> 00:20:16,629
single username all day long here I've

433
00:20:14,890 --> 00:20:21,460
taken some of the things that Kali gives

434
00:20:16,630 --> 00:20:23,920
us I've taken the rock you use your name

435
00:20:21,460 --> 00:20:25,630
list and then I've created a password

436
00:20:23,920 --> 00:20:27,880
list I'm going to get into what I use

437
00:20:25,630 --> 00:20:32,140
there to do that to create a list of

438
00:20:27,880 --> 00:20:34,270
passwords that I want to guess if you

439
00:20:32,140 --> 00:20:36,940
choose Hydra to allow it to generate a

440
00:20:34,270 --> 00:20:39,540
password list for you you can use that

441
00:20:36,940 --> 00:20:42,250
it limits it at four billion passwords

442
00:20:39,540 --> 00:20:44,260
you may sing though that's that's like

443
00:20:42,250 --> 00:20:46,930
more than I'd ever guess it's not hard

444
00:20:44,260 --> 00:20:48,879
an eight character password of lowercase

445
00:20:46,930 --> 00:20:52,870
numbers will be more than would be more

446
00:20:48,880 --> 00:20:55,320
than four billion combinations so it's

447
00:20:52,870 --> 00:20:58,560
it's not easy to do that so I use crunch

448
00:20:55,320 --> 00:21:00,939
to generate a password list for me and

449
00:20:58,560 --> 00:21:04,030
obviously it's a lot easier and crunch

450
00:21:00,940 --> 00:21:06,190
can generate X numbers so why is why is

451
00:21:04,030 --> 00:21:07,540
crunch helpful so I'm just going to do a

452
00:21:06,190 --> 00:21:12,010
quick one here

453
00:21:07,540 --> 00:21:13,000
I want to show use a butt crunch I can

454
00:21:12,010 --> 00:21:14,950
do something like this

455
00:21:13,000 --> 00:21:17,560
started a character so if I know the

456
00:21:14,950 --> 00:21:20,110
website part of my reconnaissance if I

457
00:21:17,560 --> 00:21:23,590
type in the wrong password what do most

458
00:21:20,110 --> 00:21:25,959
websites give you no it has to be you

459
00:21:23,590 --> 00:21:28,209
know 8 characters long uppercase letter

460
00:21:25,960 --> 00:21:30,460
special character whatever I can

461
00:21:28,210 --> 00:21:33,970
actually take crunch and I can put in

462
00:21:30,460 --> 00:21:36,670
those variables to this site exactly

463
00:21:33,970 --> 00:21:39,430
what I need right so if I need it to

464
00:21:36,670 --> 00:21:40,900
have a special character letter I can

465
00:21:39,430 --> 00:21:43,360
just start typing things in there like

466
00:21:40,900 --> 00:21:47,230
that to match the password requirements

467
00:21:43,360 --> 00:21:51,159
of the site that I'm attacking okay so

468
00:21:47,230 --> 00:21:54,400
for me that admin password is webco one

469
00:21:51,160 --> 00:21:56,890
two three so I can put in those

470
00:21:54,400 --> 00:21:59,650
requirements now it's not going to

471
00:21:56,890 --> 00:22:02,380
create just that password it's gonna

472
00:21:59,650 --> 00:22:05,200
create every combination that those

473
00:22:02,380 --> 00:22:08,290
letters would create but now if I wanted

474
00:22:05,200 --> 00:22:11,620
to say I know that the passwords gonna

475
00:22:08,290 --> 00:22:16,000
end in a number or a series of numbers

476
00:22:11,620 --> 00:22:17,409
and as eight characters long I put in

477
00:22:16,000 --> 00:22:20,440
five characters and then I say it's

478
00:22:17,410 --> 00:22:23,710
going to end in one two three so now

479
00:22:20,440 --> 00:22:25,870
that password list is already smaller

480
00:22:23,710 --> 00:22:28,510
and this is exactly what an attacker

481
00:22:25,870 --> 00:22:31,870
would go through as he wants to limit

482
00:22:28,510 --> 00:22:35,050
how many guesses he needs to make before

483
00:22:31,870 --> 00:22:36,639
he's successful now this list right here

484
00:22:35,050 --> 00:22:39,850
still created something like a hundred

485
00:22:36,640 --> 00:22:43,150
and twenty eight megabit file of like a

486
00:22:39,850 --> 00:22:45,040
character text on each line it's a lot

487
00:22:43,150 --> 00:22:47,620
of it's a lot of it's a lot of guesses

488
00:22:45,040 --> 00:22:50,470
and that's why they have to ramp up an

489
00:22:47,620 --> 00:22:53,379
attack they can't just do a little bit

490
00:22:50,470 --> 00:22:55,060
here and there it's got to be they have

491
00:22:53,380 --> 00:22:58,210
to max out how fast they can get through

492
00:22:55,060 --> 00:23:02,560
it and then I will just simply output

493
00:22:58,210 --> 00:23:06,930
this to a file file text I think I got

494
00:23:02,560 --> 00:23:11,230
this syntax right now what did I miss

495
00:23:06,930 --> 00:23:13,030
none of the max min anybody have one

496
00:23:11,230 --> 00:23:15,130
more in there than I should all right

497
00:23:13,030 --> 00:23:19,639
there we go so this is going to create

498
00:23:15,130 --> 00:23:22,530
32,000 lines their jobs through

499
00:23:19,640 --> 00:23:26,430
isn't quite like uh one two three in

500
00:23:22,530 --> 00:23:28,290
there but you get the idea so what I did

501
00:23:26,430 --> 00:23:30,390
here that is I basically just created a

502
00:23:28,290 --> 00:23:33,210
list of passwords it's gonna run through

503
00:23:30,390 --> 00:23:36,960
various combinations of that webco one

504
00:23:33,210 --> 00:23:40,380
two three if I I can also create a

505
00:23:36,960 --> 00:23:43,020
specific username password and that's

506
00:23:40,380 --> 00:23:44,640
what I have here in the route final so

507
00:23:43,020 --> 00:23:46,139
we're actually go through an example of

508
00:23:44,640 --> 00:23:48,480
that as well

509
00:23:46,140 --> 00:23:50,850
all right some other things here tuning

510
00:23:48,480 --> 00:23:53,010
I think this is one I had yeah so I end

511
00:23:50,850 --> 00:23:56,550
this up a little bit to generate some

512
00:23:53,010 --> 00:23:58,860
traffic and this is where you can't earn

513
00:23:56,550 --> 00:24:00,629
a credential stuffing an attack in from

514
00:23:58,860 --> 00:24:02,790
I'm trying to guess usernames and

515
00:24:00,630 --> 00:24:05,010
passwords to where I'm trying to crash

516
00:24:02,790 --> 00:24:08,550
the login server or the authentication

517
00:24:05,010 --> 00:24:11,070
process you can really ranch it this up

518
00:24:08,550 --> 00:24:14,040
I was able to get out of you know my

519
00:24:11,070 --> 00:24:16,649
simple Comcast connection at home if I

520
00:24:14,040 --> 00:24:18,840
set this to 64 and the timeout down to

521
00:24:16,650 --> 00:24:20,880
like ten I got about 20 thousand

522
00:24:18,840 --> 00:24:24,389
requests a second out of a single

523
00:24:20,880 --> 00:24:26,070
process on a single server from a 10

524
00:24:24,390 --> 00:24:30,780
megabit opposite up side connection

525
00:24:26,070 --> 00:24:32,159
right and that was pretty impressive

526
00:24:30,780 --> 00:24:34,370
that's kind of gives you an idea of just

527
00:24:32,160 --> 00:24:38,610
how Hydra how fast this thing can run

528
00:24:34,370 --> 00:24:41,489
okay we're not going to do that now

529
00:24:38,610 --> 00:24:44,399
because it prevents like half my

530
00:24:41,490 --> 00:24:46,170
internet from working at home so I'll

531
00:24:44,400 --> 00:24:48,390
put this down to like 16 it's a little

532
00:24:46,170 --> 00:24:49,290
bit more of a reasonable number and then

533
00:24:48,390 --> 00:24:53,100
if we have time at the end we'll have

534
00:24:49,290 --> 00:24:55,620
some fun we can crank it up you can if

535
00:24:53,100 --> 00:24:57,300
you have a single proxy you can proxy

536
00:24:55,620 --> 00:25:02,429
this right here but we're going to get

537
00:24:57,300 --> 00:25:04,020
into a better way to do proxy so let me

538
00:25:02,430 --> 00:25:06,300
switch over to this screen here I want

539
00:25:04,020 --> 00:25:09,540
to start with this this attack it's a

540
00:25:06,300 --> 00:25:13,050
little bit less and we're going to get

541
00:25:09,540 --> 00:25:16,200
rid of this to start okay the next thing

542
00:25:13,050 --> 00:25:18,300
you need to do so just like those use

543
00:25:16,200 --> 00:25:19,950
names and password fields that are there

544
00:25:18,300 --> 00:25:23,340
the query parameters we need to enter

545
00:25:19,950 --> 00:25:25,470
those and there's a format here that you

546
00:25:23,340 --> 00:25:28,290
can read about with Hydra basically

547
00:25:25,470 --> 00:25:30,180
using them user password pass and then

548
00:25:28,290 --> 00:25:32,260
Hydra it doesn't look on what's

549
00:25:30,180 --> 00:25:34,570
successful it looks on what's false

550
00:25:32,260 --> 00:25:38,590
so it wants to look at what is an

551
00:25:34,570 --> 00:25:41,020
invalid login and let me come back to my

552
00:25:38,590 --> 00:25:45,580
site here see if it's uh acting a little

553
00:25:41,020 --> 00:25:48,700
bit better yeah yeah I actually think I

554
00:25:45,580 --> 00:25:51,490
like gave it a headache for a while

555
00:25:48,700 --> 00:25:56,280
because I was hitting it hard to give it

556
00:25:51,490 --> 00:25:56,280
give me some data let me see here

557
00:25:57,390 --> 00:26:07,600
but this doesn't work I'll just jump to

558
00:25:59,710 --> 00:26:08,950
the login yeah so let me do this and

559
00:26:07,600 --> 00:26:11,649
you'll see what I'm talking about when I

560
00:26:08,950 --> 00:26:13,150
say like a login like the log in

561
00:26:11,650 --> 00:26:15,520
response so if I come straight to that

562
00:26:13,150 --> 00:26:18,130
page then that's what we're after there

563
00:26:15,520 --> 00:26:20,650
so here I'm just looking at the response

564
00:26:18,130 --> 00:26:23,440
from a failed log and this is what it

565
00:26:20,650 --> 00:26:25,360
would send me if I try and hit the Ajax

566
00:26:23,440 --> 00:26:28,059
login dot PHP without any username

567
00:26:25,360 --> 00:26:29,199
password age is gonna say invalid using

568
00:26:28,059 --> 00:26:32,139
a password and that's what I'm looking

569
00:26:29,200 --> 00:26:33,940
at so you have to so an attacker would

570
00:26:32,140 --> 00:26:35,530
need to gather this as part of his

571
00:26:33,940 --> 00:26:37,540
reconnaissance it's why he's creating

572
00:26:35,530 --> 00:26:39,668
ballot accounts that's why he's going

573
00:26:37,540 --> 00:26:41,740
through the login flow so he can

574
00:26:39,669 --> 00:26:44,020
differentiate between what's of a valid

575
00:26:41,740 --> 00:26:45,850
and an invalid login if you don't have

576
00:26:44,020 --> 00:26:48,280
that hydras not gonna be able to tell

577
00:26:45,850 --> 00:26:50,949
you when you hit gold mines and when you

578
00:26:48,280 --> 00:26:52,540
hit a valid login okay so you have to be

579
00:26:50,950 --> 00:26:54,820
able to feed that intelligence back into

580
00:26:52,540 --> 00:26:57,159
Hydra and really any other account

581
00:26:54,820 --> 00:26:59,678
takeover tool you need needs to be able

582
00:26:57,160 --> 00:27:02,080
to differentiate between a valid and an

583
00:26:59,679 --> 00:27:06,130
invalid login so some of my customers

584
00:27:02,080 --> 00:27:09,250
have tried to argue skate that piece of

585
00:27:06,130 --> 00:27:10,840
the puzzle so they'll do funny things

586
00:27:09,250 --> 00:27:15,070
like send it for a redirect to a

587
00:27:10,840 --> 00:27:18,399
different site or they don't have any

588
00:27:15,070 --> 00:27:20,439
indication that it's an invalid login so

589
00:27:18,400 --> 00:27:22,660
if you log in with a valid login or you

590
00:27:20,440 --> 00:27:25,660
log in with an invalid login the

591
00:27:22,660 --> 00:27:28,870
response doesn't differentiate it's the

592
00:27:25,660 --> 00:27:35,350
exact same and that's a good obvious

593
00:27:28,870 --> 00:27:37,959
keishon technique you know a hacker

594
00:27:35,350 --> 00:27:40,030
who's persistent isn't gonna stop at

595
00:27:37,960 --> 00:27:42,610
just that but it does make it more

596
00:27:40,030 --> 00:27:44,230
difficult so think about that right if

597
00:27:42,610 --> 00:27:45,610
you're managing your website your logins

598
00:27:44,230 --> 00:27:48,750
you can make them both

599
00:27:45,610 --> 00:27:51,399
both the same both responses are 200s

600
00:27:48,750 --> 00:27:53,590
everything says it's okay and

601
00:27:51,400 --> 00:27:55,420
everything's the same is difficult to

602
00:27:53,590 --> 00:27:58,659
differentiate from an attacker

603
00:27:55,420 --> 00:28:00,190
perspective when I'm successful okay

604
00:27:58,660 --> 00:28:03,330
because surely he's not going to sit

605
00:28:00,190 --> 00:28:05,590
there and look at each no aspect of it

606
00:28:03,330 --> 00:28:08,020
all right so let me look here real quick

607
00:28:05,590 --> 00:28:11,439
I think on this one now this one should

608
00:28:08,020 --> 00:28:14,920
get blocked I'm not doing anything here

609
00:28:11,440 --> 00:28:22,870
to really hide myself so what I'm gonna

610
00:28:14,920 --> 00:28:24,610
do is I'm actually going to I'm going to

611
00:28:22,870 --> 00:28:27,219
use a separate one this one runs through

612
00:28:24,610 --> 00:28:29,320
about 20 different combinations and then

613
00:28:27,220 --> 00:28:33,970
it does have a valid login here at the

614
00:28:29,320 --> 00:28:35,590
end but this should still be still be

615
00:28:33,970 --> 00:28:39,100
detected so what we're gonna do is we're

616
00:28:35,590 --> 00:28:41,889
gonna run this through impervious cloud

617
00:28:39,100 --> 00:28:45,219
web application firewall that detects

618
00:28:41,890 --> 00:28:48,360
these sorts of actors these sorts of

619
00:28:45,220 --> 00:28:50,890
tools okay so out of the gate Hydra

620
00:28:48,360 --> 00:28:52,870
because everything on Kali right is not

621
00:28:50,890 --> 00:28:56,919
to be used for malicious purposes

622
00:28:52,870 --> 00:28:59,199
I identify as itself as such it's gonna

623
00:28:56,919 --> 00:29:02,530
tell me hey hydras visiting this website

624
00:28:59,200 --> 00:29:05,880
it does not hide itself and we're gonna

625
00:29:02,530 --> 00:29:05,879
see what happens okay

626
00:29:06,580 --> 00:29:13,000
I don't want to send it through proxy

627
00:29:10,390 --> 00:29:17,770
chains just yet because I'm hiding

628
00:29:13,000 --> 00:29:21,520
myself let me think it's this one here I

629
00:29:17,770 --> 00:29:26,190
can use them but let me get rid of my

630
00:29:21,520 --> 00:29:26,190
header okay

631
00:29:26,309 --> 00:29:33,690
still valid make sure my tunings right

632
00:29:28,740 --> 00:29:35,340
yes good right we'll start this one now

633
00:29:33,690 --> 00:29:39,330
I'm gonna run now I have this one set

634
00:29:35,340 --> 00:29:42,990
for grrrrrr sorry guys I have this one

635
00:29:39,330 --> 00:29:45,928
set to go through I want to go through

636
00:29:42,990 --> 00:29:50,880
you just so it's a little bit shorter

637
00:29:45,929 --> 00:29:54,990
and nothing to uh nothing to hide us

638
00:29:50,880 --> 00:29:59,010
this is gonna be a dry run no you know

639
00:29:54,990 --> 00:30:01,770
open it I type X Hydra and the callee

640
00:29:59,010 --> 00:30:03,270
terminal this pops up and here we are so

641
00:30:01,770 --> 00:30:07,559
here we get to see the logins that I'm

642
00:30:03,270 --> 00:30:11,220
trying the passwords that I'm sending we

643
00:30:07,559 --> 00:30:14,158
come down here everything's done zero

644
00:30:11,220 --> 00:30:16,140
valid passwords everything's complete

645
00:30:14,159 --> 00:30:19,070
everything's finished so I've been

646
00:30:16,140 --> 00:30:21,870
running this right here we can then see

647
00:30:19,070 --> 00:30:25,200
everything was blocked you know red line

648
00:30:21,870 --> 00:30:28,199
means blocked about you know 35 requests

649
00:30:25,200 --> 00:30:32,130
a second when I come down here look at

650
00:30:28,200 --> 00:30:35,730
new samples THC Hydra detected as a bad

651
00:30:32,130 --> 00:30:38,270
bot this is exactly what a Web

652
00:30:35,730 --> 00:30:40,470
Application Firewall is designed to do

653
00:30:38,270 --> 00:30:41,970
from this standpoint if you don't have a

654
00:30:40,470 --> 00:30:44,250
web application firewall you're missing

655
00:30:41,970 --> 00:30:47,520
the first boat okay if you're not

656
00:30:44,250 --> 00:30:49,080
blocking this you're in big trouble you

657
00:30:47,520 --> 00:30:51,090
know we haven't even gotten into an

658
00:30:49,080 --> 00:30:53,699
advanced persistent threat scenario yet

659
00:30:51,090 --> 00:30:55,590
this is an out of the box script Kitty

660
00:30:53,700 --> 00:30:57,059
your guy down the street installed Kali

661
00:30:55,590 --> 00:31:00,360
and wants to play around on your website

662
00:30:57,059 --> 00:31:03,510
okay that's what this is 206 requests

663
00:31:00,360 --> 00:31:05,908
206 and you can see Hydra right here

664
00:31:03,510 --> 00:31:10,320
this is the user agent accurately

665
00:31:05,909 --> 00:31:12,630
identifies itself as Hydra so if I am an

666
00:31:10,320 --> 00:31:14,149
attacker any guesses what's the next

667
00:31:12,630 --> 00:31:17,490
thing I need to do to be successful

668
00:31:14,150 --> 00:31:20,400
where should i elevate my procedure from

669
00:31:17,490 --> 00:31:25,110
here what's the next tactic I'm using

670
00:31:20,400 --> 00:31:27,450
some keywords here yeah and you're

671
00:31:25,110 --> 00:31:30,299
cheating and you can't you can't comment

672
00:31:27,450 --> 00:31:32,000
on this one you know that you know the

673
00:31:30,299 --> 00:31:36,179
answer before I even that's the question

674
00:31:32,000 --> 00:31:37,640
okay so yeah right first thing I need to

675
00:31:36,179 --> 00:31:39,679
do is change the user agent

676
00:31:37,640 --> 00:31:43,549
how hard do you think Hydra makes that

677
00:31:39,679 --> 00:31:48,429
very difficult probably not so what I

678
00:31:43,549 --> 00:31:52,100
did is I went out to this website here

679
00:31:48,429 --> 00:31:54,950
super secret website chrome user agents

680
00:31:52,100 --> 00:31:58,159
and I can just look in whatever user

681
00:31:54,950 --> 00:32:01,100
agent I want to pick to make myself my

682
00:31:58,160 --> 00:32:04,510
user agent look like Chrome I can just

683
00:32:01,100 --> 00:32:12,309
pick a version right let's go for 74 I

684
00:32:04,510 --> 00:32:12,309
picked 74 I'll use Jim because I'm

685
00:32:12,730 --> 00:32:24,049
because I like to I'll drop my user

686
00:32:19,490 --> 00:32:26,600
agent in there h4 header equals I define

687
00:32:24,049 --> 00:32:29,418
the user agent I have to escape the

688
00:32:26,600 --> 00:32:32,209
colon and then I drop in the Chrome

689
00:32:29,419 --> 00:32:34,460
browser user agent right not very

690
00:32:32,210 --> 00:32:36,160
difficult pretty easy

691
00:32:34,460 --> 00:32:39,160
what do you think the lats gonna do

692
00:32:36,160 --> 00:32:39,160
thoughts

693
00:32:40,720 --> 00:32:46,580
what would a web application if I will

694
00:32:44,059 --> 00:32:48,379
do at this point let's find out okay so

695
00:32:46,580 --> 00:32:50,780
now we're gonna run it going to go

696
00:32:48,380 --> 00:32:53,780
through those same usually in passwords

697
00:32:50,780 --> 00:32:56,450
only this time I'm sending a different

698
00:32:53,780 --> 00:32:58,990
header classifying myself as something

699
00:32:56,450 --> 00:32:58,990
different

700
00:33:00,130 --> 00:33:08,919
alright how about now

701
00:33:04,720 --> 00:33:12,530
so now as expected same IP address

702
00:33:08,919 --> 00:33:15,230
showing up as Chrome I expect to see a

703
00:33:12,530 --> 00:33:19,879
little bit of a spike here

704
00:33:15,230 --> 00:33:23,270
sometimes it takes a moment oh I know

705
00:33:19,880 --> 00:33:24,500
why I'm a little step ahead to you so

706
00:33:23,270 --> 00:33:30,620
this was something else I was doing

707
00:33:24,500 --> 00:33:33,940
earlier just so that again I have some

708
00:33:30,620 --> 00:33:33,939
data but I gotta turn this piece off

709
00:33:38,380 --> 00:33:42,059
and we're going to turn this off

710
00:33:51,880 --> 00:33:58,960
come back here will trigger this again

711
00:33:54,300 --> 00:34:04,870
and but yeah as expected you can see

712
00:33:58,960 --> 00:34:07,150
there now I'm showing up its Chrome but

713
00:34:04,870 --> 00:34:11,469
there's something else here that this is

714
00:34:07,150 --> 00:34:15,910
going to trigger on that an attacker

715
00:34:11,469 --> 00:34:18,279
would not like because even if a web

716
00:34:15,909 --> 00:34:20,049
application of firewall well a web

717
00:34:18,280 --> 00:34:26,520
allocation fire will will eventually

718
00:34:20,050 --> 00:34:26,520
trigger on this it will not be difficult

719
00:34:27,540 --> 00:34:36,159
for the firewall to to block this this

720
00:34:30,580 --> 00:34:39,400
attack here either so let me come back

721
00:34:36,159 --> 00:34:41,520
over here see if we can't get some data

722
00:34:39,400 --> 00:34:41,520
now

723
00:34:52,260 --> 00:34:58,770
probably to give it a bit for that other

724
00:34:54,190 --> 00:35:01,120
mitigation rule to this slide away

725
00:34:58,770 --> 00:35:02,860
that's why we're seeing this right here

726
00:35:01,120 --> 00:35:05,589
so this mitigation rule and we'll get

727
00:35:02,860 --> 00:35:08,350
into why that's important and the next

728
00:35:05,590 --> 00:35:10,090
step that you would have to take and why

729
00:35:08,350 --> 00:35:27,000
we're seeing those specific types of

730
00:35:10,090 --> 00:35:27,000
solutions in the market today well

731
00:35:35,040 --> 00:35:42,270
so I've seen this happen once or twice

732
00:35:38,280 --> 00:35:44,070
before and if I close Hydra and open it

733
00:35:42,270 --> 00:35:46,350
up again I kind of like refreshes itself

734
00:35:44,070 --> 00:35:47,790
but I have another one over here and

735
00:35:46,350 --> 00:35:51,120
we're just gonna proceed on so what's

736
00:35:47,790 --> 00:35:52,940
gonna happen is what the next thing here

737
00:35:51,120 --> 00:35:56,640
is what we're gonna see is every attack

738
00:35:52,940 --> 00:35:58,830
still comes from a single IP address so

739
00:35:56,640 --> 00:36:03,089
even though now I don't have Hydra here

740
00:35:58,830 --> 00:36:04,980
and I have my chrome user agent which

741
00:36:03,090 --> 00:36:08,580
means I'm no longer gonna be detected by

742
00:36:04,980 --> 00:36:12,750
some signature some bot classification I

743
00:36:08,580 --> 00:36:16,049
now look like a browser I'm still coming

744
00:36:12,750 --> 00:36:17,430
from a single IP address and that's not

745
00:36:16,050 --> 00:36:18,750
that's not gonna work a couple things

746
00:36:17,430 --> 00:36:20,339
are gonna happen first off if you're

747
00:36:18,750 --> 00:36:22,680
really launching an attack consecutively

748
00:36:20,340 --> 00:36:24,390
that IP address is gonna get blacklisted

749
00:36:22,680 --> 00:36:28,200
in a matter of 24 hours you're done

750
00:36:24,390 --> 00:36:33,029
you'd have one day okay so you're gonna

751
00:36:28,200 --> 00:36:39,080
have to distribute this how would you

752
00:36:33,030 --> 00:36:39,080
distribute this cheaply and easily

753
00:36:40,430 --> 00:36:47,640
that's say again I didn't expect that to

754
00:36:45,450 --> 00:36:50,609
be the first answer that's a good one so

755
00:36:47,640 --> 00:36:53,129
proxies all right next cally guys let's

756
00:36:50,610 --> 00:36:56,340
be more specific what tool do you think

757
00:36:53,130 --> 00:36:58,230
I use to go against proxies yeah yeah

758
00:36:56,340 --> 00:37:00,030
thank you when they give another way in

759
00:36:58,230 --> 00:37:02,160
the beginning but that's a good one so

760
00:37:00,030 --> 00:37:03,740
the first thing I liked and I really

761
00:37:02,160 --> 00:37:07,500
like this list it was pretty accurate

762
00:37:03,740 --> 00:37:10,410
proxy - list download as a gory glorious

763
00:37:07,500 --> 00:37:13,350
site we can go out and in a click of a

764
00:37:10,410 --> 00:37:15,330
button if I want to get through all of

765
00:37:13,350 --> 00:37:18,630
these different proxies I can pick the

766
00:37:15,330 --> 00:37:20,940
country that I want or I can just I mean

767
00:37:18,630 --> 00:37:23,940
look at this I can come down here and

768
00:37:20,940 --> 00:37:27,180
just click in the box and it copies to

769
00:37:23,940 --> 00:37:32,750
my clipboard and here I got a list of

770
00:37:27,180 --> 00:37:36,950
socks for socks five HTTP HTTP proxies

771
00:37:32,750 --> 00:37:42,060
how many do you think are here for free

772
00:37:36,950 --> 00:37:43,529
updated every two hours 10,000 I'm not

773
00:37:42,060 --> 00:37:46,190
even paying for a botnet

774
00:37:43,530 --> 00:37:48,660
I'm not even controlling a botnet I'm

775
00:37:46,190 --> 00:37:53,210
browsing the Internet and I had

776
00:37:48,660 --> 00:37:56,609
access to a free list of 10,000 proxies

777
00:37:53,210 --> 00:38:01,410
okay so what do I do I take all of those

778
00:37:56,609 --> 00:38:03,270
I drop it into notepad plus plus because

779
00:38:01,410 --> 00:38:06,089
I need a massage it a little bit proxy

780
00:38:03,270 --> 00:38:09,990
change the program proxy chains wants to

781
00:38:06,089 --> 00:38:12,720
have tabs instead of colons and you need

782
00:38:09,990 --> 00:38:18,808
to define what the protocol is for that

783
00:38:12,720 --> 00:38:28,308
proxy so we do that I copy it over I add

784
00:38:18,809 --> 00:38:28,309
it to my list pretty sure it have well I

785
00:38:28,819 --> 00:38:33,890
have it in my proxy chains config and

786
00:38:34,339 --> 00:38:40,339
here it is I've got four thousand six

787
00:38:36,690 --> 00:38:43,109
hundred and forty nine socks for proxies

788
00:38:40,339 --> 00:38:44,670
okay so let's take a moment and I want

789
00:38:43,109 --> 00:38:50,609
to we're going to talk a little bit

790
00:38:44,670 --> 00:38:55,859
about we're gonna talk a little bit

791
00:38:50,609 --> 00:38:57,390
about setting up proxy chains nobody can

792
00:38:55,859 --> 00:38:59,038
talk to me all mr. robot because I've

793
00:38:57,390 --> 00:39:01,049
only watched the first episode but they

794
00:38:59,039 --> 00:39:03,779
do this Elliott does this one like

795
00:39:01,049 --> 00:39:06,230
season one and if anybody talks to me

796
00:39:03,779 --> 00:39:10,349
about episode two or three we're done

797
00:39:06,230 --> 00:39:12,859
but he does this in like season one he's

798
00:39:10,349 --> 00:39:16,500
just some proxies out of Estonia and

799
00:39:12,859 --> 00:39:19,259
uses proxy chains to mask his content so

800
00:39:16,500 --> 00:39:22,170
the first two here dynamic and strict

801
00:39:19,260 --> 00:39:24,890
chain those are good if you know exactly

802
00:39:22,170 --> 00:39:27,750
what proxies you want to bounce through

803
00:39:24,890 --> 00:39:30,660
meaning I've got ten proxies that are no

804
00:39:27,750 --> 00:39:33,329
we're up and fast and I want to go

805
00:39:30,660 --> 00:39:36,270
through those from chain from proxy one

806
00:39:33,329 --> 00:39:38,849
to proxy ten and proxy ten is my exit

807
00:39:36,270 --> 00:39:40,319
node okay those are good strict means

808
00:39:38,849 --> 00:39:43,079
one through ten have to work or else

809
00:39:40,319 --> 00:39:44,549
you're done dynamic mean if one is five

810
00:39:43,079 --> 00:39:47,339
is down I'll just go to six and you'll

811
00:39:44,549 --> 00:39:48,779
have nine in your chain okay but I can I

812
00:39:47,339 --> 00:39:50,430
mean this is literally we're talking

813
00:39:48,779 --> 00:39:51,839
about that spinning globe and you're

814
00:39:50,430 --> 00:39:52,500
bouncing across a little two different

815
00:39:51,839 --> 00:39:55,140
proxies

816
00:39:52,500 --> 00:39:58,049
that's what proxy change does what I

817
00:39:55,140 --> 00:40:00,089
have set here for is round-robin I've

818
00:39:58,049 --> 00:40:01,190
got four thousand some proxies I don't

819
00:40:00,089 --> 00:40:04,160
want to go from one to four

820
00:40:01,190 --> 00:40:06,319
before I actually get to my target this

821
00:40:04,160 --> 00:40:09,649
is gonna basically just cycle through a

822
00:40:06,319 --> 00:40:11,990
random list and pick some but what's

823
00:40:09,650 --> 00:40:15,260
nice about this is that if it does find

824
00:40:11,990 --> 00:40:17,959
a dead proxy it won't use it again all

825
00:40:15,260 --> 00:40:20,859
right and and when I tested this I

826
00:40:17,960 --> 00:40:23,180
created my proxy list like last Friday

827
00:40:20,859 --> 00:40:27,109
and when I tested this at one o'clock

828
00:40:23,180 --> 00:40:30,529
today I had like a 90% dead rate that's

829
00:40:27,109 --> 00:40:33,200
how fast these proxies come up and come

830
00:40:30,530 --> 00:40:35,690
down and you need to keep it refreshed

831
00:40:33,200 --> 00:40:37,189
and it's important to then to skip out

832
00:40:35,690 --> 00:40:39,440
the dead ones and we'll see that here

833
00:40:37,190 --> 00:40:42,680
when I when I turn this on but there is

834
00:40:39,440 --> 00:40:45,319
the chain length setting here if I set

835
00:40:42,680 --> 00:40:46,970
this right now this is set it to so I'm

836
00:40:45,319 --> 00:40:48,650
going to use two proxies if I want to be

837
00:40:46,970 --> 00:40:50,480
more I can make it whatever number I

838
00:40:48,650 --> 00:40:54,410
want I've got four thousand six hundred

839
00:40:50,480 --> 00:40:56,930
I won't go that high but be aware if you

840
00:40:54,410 --> 00:41:00,770
set this to four six eight or ten like

841
00:40:56,930 --> 00:41:07,430
I've done before then you must set your

842
00:41:00,770 --> 00:41:11,569
timeout where is it you must set your

843
00:41:07,430 --> 00:41:14,000
timeout here to be equal to that if we

844
00:41:11,569 --> 00:41:17,630
don't get a Hydra doesn't get a response

845
00:41:14,000 --> 00:41:19,160
in 30 seconds it just closes the

846
00:41:17,630 --> 00:41:22,520
connection it goes on to the next

847
00:41:19,160 --> 00:41:24,980
request so if your proxy is long and

848
00:41:22,520 --> 00:41:26,140
it's gonna take a while it's just you're

849
00:41:24,980 --> 00:41:30,010
gonna have to wait awhile

850
00:41:26,140 --> 00:41:30,009
alright so that's what it's gonna take

851
00:41:30,680 --> 00:41:36,339
and I want to leave things on verbose

852
00:41:33,740 --> 00:41:39,828
it'll be really chatty when we run this

853
00:41:36,339 --> 00:41:43,339
it's kind of nice to keep like don't

854
00:41:39,829 --> 00:41:48,740
print message errors unless you really

855
00:41:43,339 --> 00:41:50,540
care about you know how much you know

856
00:41:48,740 --> 00:41:53,149
how much close connections and stuff you

857
00:41:50,540 --> 00:41:55,910
have so I think I'm happy with this

858
00:41:53,150 --> 00:41:58,400
I'm going to get rid of this and this

859
00:41:55,910 --> 00:42:01,190
was like 44 billion combinations here so

860
00:41:58,400 --> 00:42:06,800
we're let this run and let this run too

861
00:42:01,190 --> 00:42:09,770
long on Friday and then we'll drop in

862
00:42:06,800 --> 00:42:13,420
the user-agent there again so we'll get

863
00:42:09,770 --> 00:42:15,580
past the laughs we'll start this

864
00:42:13,420 --> 00:42:18,070
so now we see proxy chains oh yeah I

865
00:42:15,580 --> 00:42:22,390
forgot this point I had to upgrade proxy

866
00:42:18,070 --> 00:42:25,420
chains on Kali 2 for 3 was not stable

867
00:42:22,390 --> 00:42:26,650
it wasn't connecting through proxies I

868
00:42:25,420 --> 00:42:29,020
couldn't figure out why and I just

869
00:42:26,650 --> 00:42:34,270
upgraded it and amazingly that made it

870
00:42:29,020 --> 00:42:38,950
work ok so here we go we're gonna let

871
00:42:34,270 --> 00:42:40,360
this run a little bit and if this bombs

872
00:42:38,950 --> 00:42:45,520
out on me I'll have to I'll have to

873
00:42:40,360 --> 00:42:47,110
close it and open up a new Hydra it

874
00:42:45,520 --> 00:42:53,140
shouldn't be stopping here at 16 like

875
00:42:47,110 --> 00:42:58,150
this I'm probably not getting any

876
00:42:53,140 --> 00:42:59,319
traffic ok so I'm going to close this

877
00:42:58,150 --> 00:43:08,080
and I'm gonna have to add everything

878
00:42:59,320 --> 00:43:10,680
back in just give me a second should be

879
00:43:08,080 --> 00:43:10,680
like right there

880
00:43:17,950 --> 00:43:23,509
so that's how you start it then it opens

881
00:43:21,830 --> 00:43:26,150
up and yeah you can probably have it

882
00:43:23,510 --> 00:43:28,720
like saved and stuff in here but I just

883
00:43:26,150 --> 00:43:28,720
have it

884
00:43:37,190 --> 00:43:40,720
but so that hurt

885
00:43:45,770 --> 00:43:56,240
so my username list my password list

886
00:43:52,640 --> 00:43:56,240
tuning will leave at default

887
00:44:02,570 --> 00:44:04,630
you

888
00:44:11,360 --> 00:44:18,100
and I type this in enough that

889
00:44:14,590 --> 00:44:18,100
unfortunately I know it

890
00:44:28,760 --> 00:44:32,110
but don't know this

891
00:44:45,990 --> 00:44:50,669
wait a little bit for my rest or file to

892
00:44:48,310 --> 00:44:50,670
go away

893
00:44:56,230 --> 00:45:03,540
yeah it's getting stuck this should be

894
00:45:00,880 --> 00:45:03,540
running through that

895
00:45:11,160 --> 00:45:13,220
you

896
00:45:13,620 --> 00:45:19,069
always the joys of the live demo

897
00:45:26,670 --> 00:45:31,489
I'm hoping like a verbose note here just

898
00:45:29,039 --> 00:45:36,319
give me something usually it's pretty

899
00:45:31,489 --> 00:45:36,319
helpful to tell you what's going on

900
00:45:46,619 --> 00:45:52,070
you

901
00:45:48,470 --> 00:45:53,660
let me see if I clear out whenever

902
00:45:52,070 --> 00:45:56,800
Stover filed but I don't think that's

903
00:45:53,660 --> 00:45:56,799
really the problem here

904
00:46:24,099 --> 00:46:27,940
all right one more go

905
00:46:30,809 --> 00:46:33,919
give me some love

906
00:46:40,360 --> 00:46:47,030
well as that's sitting there we'll let

907
00:46:44,119 --> 00:46:49,010
that think for a second when I ran this

908
00:46:47,030 --> 00:46:51,590
before at one o'clock you can see here

909
00:46:49,010 --> 00:46:53,960
where I was coming out of alright so

910
00:46:51,590 --> 00:46:55,670
you're gonna get these requests well

911
00:46:53,960 --> 00:46:58,060
we're gonna look up and we start showing

912
00:46:55,670 --> 00:47:02,300
up here is the basically unknown BOTS or

913
00:46:58,060 --> 00:47:05,920
Pingdom BOTS and this allows you to have

914
00:47:02,300 --> 00:47:08,869
a much lower request rate per IP address

915
00:47:05,920 --> 00:47:12,260
so you're gonna have you know traffic

916
00:47:08,869 --> 00:47:15,560
that looks a lot more simpler to normal

917
00:47:12,260 --> 00:47:18,310
traffic so where do I go from here if I

918
00:47:15,560 --> 00:47:22,730
want to detect this style of traffic I

919
00:47:18,310 --> 00:47:26,450
can't rely on signature based policies I

920
00:47:22,730 --> 00:47:28,340
can't rely on simple classification this

921
00:47:26,450 --> 00:47:30,470
is where solutions in the market have

922
00:47:28,340 --> 00:47:33,380
come out around what's referred to as

923
00:47:30,470 --> 00:47:38,959
advanced bot protection so solutions

924
00:47:33,380 --> 00:47:41,900
like distill shape anything that says

925
00:47:38,960 --> 00:47:44,930
advanced bot management is where we have

926
00:47:41,900 --> 00:47:48,460
to go to get here so one of the

927
00:47:44,930 --> 00:47:51,980
solutions that I have on hand is

928
00:47:48,460 --> 00:47:54,590
impervious account takeover tool so you

929
00:47:51,980 --> 00:47:56,720
can see today when I ran this I cranked

930
00:47:54,590 --> 00:47:58,010
it up pretty well I probably it's

931
00:47:56,720 --> 00:48:00,410
probably why it's not working right now

932
00:47:58,010 --> 00:48:04,940
but just in that short amount of time I

933
00:48:00,410 --> 00:48:08,480
had 200,000 requests come in you know 2

934
00:48:04,940 --> 00:48:10,700
out of 200 2000 legitimate attempts we

935
00:48:08,480 --> 00:48:13,700
can see here where this was and then

936
00:48:10,700 --> 00:48:17,509
when I enabled mitigation what happened

937
00:48:13,700 --> 00:48:20,390
we got to you know pretty much an exact

938
00:48:17,510 --> 00:48:23,150
match on the attacks that I was running

939
00:48:20,390 --> 00:48:26,180
and the account takeover solution takes

940
00:48:23,150 --> 00:48:28,280
it a step farther at this point we're

941
00:48:26,180 --> 00:48:32,839
out looking at user agents we're

942
00:48:28,280 --> 00:48:35,540
actually looking at the behavior of the

943
00:48:32,840 --> 00:48:37,340
logins that are coming in looking and

944
00:48:35,540 --> 00:48:38,900
it's a lot I mean I can't even get into

945
00:48:37,340 --> 00:48:41,180
her the algorithm but simply to say it's

946
00:48:38,900 --> 00:48:42,590
machine learning at this point we have

947
00:48:41,180 --> 00:48:45,830
to get into some type of machine

948
00:48:42,590 --> 00:48:48,500
learning behavior profiling risk aware

949
00:48:45,830 --> 00:48:51,240
situations where it's not looking at

950
00:48:48,500 --> 00:48:53,700
each individual request on its own

951
00:48:51,240 --> 00:48:55,259
and so when we when we enable mitigation

952
00:48:53,700 --> 00:48:57,899
this what we see here we can see what

953
00:48:55,260 --> 00:49:00,119
things are classified as some of the

954
00:48:57,900 --> 00:49:01,470
places where I'm coming from there you

955
00:49:00,119 --> 00:49:03,290
can see a few of the countries where

956
00:49:01,470 --> 00:49:05,879
even though most of us the United States

957
00:49:03,290 --> 00:49:07,980
don't some of those proxies were located

958
00:49:05,880 --> 00:49:11,250
elsewhere and so this is where I'm

959
00:49:07,980 --> 00:49:12,869
coming in from and this is a style of a

960
00:49:11,250 --> 00:49:15,690
solution that's specifically geared

961
00:49:12,869 --> 00:49:17,190
toward this style of an attack and so

962
00:49:15,690 --> 00:49:20,359
you might think to myself why isn't a

963
00:49:17,190 --> 00:49:22,770
wife or why isn't another security tool

964
00:49:20,359 --> 00:49:25,580
capable of emitting this style of attack

965
00:49:22,770 --> 00:49:28,490
ins because it's legitimate traffic

966
00:49:25,580 --> 00:49:31,049
login by nature isn't a sequel injection

967
00:49:28,490 --> 00:49:34,049
it's not a cross-site script it's

968
00:49:31,050 --> 00:49:35,940
nothing inside the OWASP top 10 it's not

969
00:49:34,050 --> 00:49:38,339
even it's not even bad code in my

970
00:49:35,940 --> 00:49:40,050
website it's just a login page

971
00:49:38,339 --> 00:49:43,410
it could be coded completely 100 percent

972
00:49:40,050 --> 00:49:45,420
correct but it's still a hole into the

973
00:49:43,410 --> 00:49:48,029
application that's being executed being

974
00:49:45,420 --> 00:49:51,119
breached and so we have to look outside

975
00:49:48,030 --> 00:49:53,400
of the standard code vulnerability style

976
00:49:51,119 --> 00:49:56,130
tools we have to look outside of the

977
00:49:53,400 --> 00:49:59,099
standard application security tools to a

978
00:49:56,130 --> 00:50:00,810
specific solution and so that's where

979
00:49:59,099 --> 00:50:02,880
the account takeover market really is

980
00:50:00,810 --> 00:50:04,920
right now and it's all possible because

981
00:50:02,880 --> 00:50:09,570
of the machine learning that exists you

982
00:50:04,920 --> 00:50:11,400
got a question so the minute the

983
00:50:09,570 --> 00:50:14,609
mitigation here in this solution is kind

984
00:50:11,400 --> 00:50:16,320
of based on probability and then we take

985
00:50:14,609 --> 00:50:19,560
it there's there's simply a risk

986
00:50:16,320 --> 00:50:22,109
associated to it so and when you get

987
00:50:19,560 --> 00:50:25,920
into the risk aware it's not a yes or no

988
00:50:22,109 --> 00:50:29,580
so we have the attack probability medium

989
00:50:25,920 --> 00:50:32,220
and low and so and obviously the high

990
00:50:29,580 --> 00:50:33,869
attack probability there's a point there

991
00:50:32,220 --> 00:50:37,140
in the risk rating where it turns into

992
00:50:33,869 --> 00:50:39,359
high from medium and in there there's no

993
00:50:37,140 --> 00:50:42,180
simple answer to say oh it's because we

994
00:50:39,359 --> 00:50:45,119
saw X number of requests or next number

995
00:50:42,180 --> 00:50:49,348
of bad requests it's a holistic view of

996
00:50:45,119 --> 00:50:51,330
it comes from this IP reputation it's

997
00:50:49,349 --> 00:50:55,440
classified you know a lot of what we do

998
00:50:51,330 --> 00:50:58,410
is we see like AWS IP addresses well if

999
00:50:55,440 --> 00:51:01,170
you're being attacked by an AWS IP

1000
00:50:58,410 --> 00:51:04,379
address it's probably not one of your

1001
00:51:01,170 --> 00:51:04,590
customers who fired up a ec2 instance to

1002
00:51:04,380 --> 00:51:07,830
law

1003
00:51:04,590 --> 00:51:11,520
into your website right and so when we

1004
00:51:07,830 --> 00:51:14,850
see that kind of activity huh it raises

1005
00:51:11,520 --> 00:51:17,070
the risk right and that's what you're

1006
00:51:14,850 --> 00:51:18,720
after and so the main thing here is you

1007
00:51:17,070 --> 00:51:20,460
really need to look at risk aware you

1008
00:51:18,720 --> 00:51:24,689
need some type of an intelligence that

1009
00:51:20,460 --> 00:51:28,500
says this is what's causing the that it

1010
00:51:24,690 --> 00:51:30,360
to be an elevated risk and so along with

1011
00:51:28,500 --> 00:51:32,790
that lots of times I'll show this to

1012
00:51:30,360 --> 00:51:34,980
customers and you know there is a a

1013
00:51:32,790 --> 00:51:37,320
large rental car company I was working

1014
00:51:34,980 --> 00:51:38,940
with and you know what some of their

1015
00:51:37,320 --> 00:51:42,690
first questions are when they enabled

1016
00:51:38,940 --> 00:51:44,430
mitigation is why this slope you know

1017
00:51:42,690 --> 00:51:45,810
and that's because we have to actually

1018
00:51:44,430 --> 00:51:49,169
do a little bit there's a little bit of

1019
00:51:45,810 --> 00:51:52,049
learning involved you know it we if we

1020
00:51:49,170 --> 00:51:54,450
don't have a slope then it's a yes or no

1021
00:51:52,050 --> 00:51:56,280
discussion and your false positives go

1022
00:51:54,450 --> 00:51:58,799
through the roof you start blocking

1023
00:51:56,280 --> 00:52:00,540
legitimate people logging in so there

1024
00:51:58,800 --> 00:52:02,820
has to be a learning there has to be

1025
00:52:00,540 --> 00:52:05,210
that time where the algorithm can hone

1026
00:52:02,820 --> 00:52:08,910
in on what's risky and what's not risky

1027
00:52:05,210 --> 00:52:09,990
so the fun part here the climax of it

1028
00:52:08,910 --> 00:52:12,810
looks like it's going to bomb out only

1029
00:52:09,990 --> 00:52:22,470
let's see if we can't get a little bit

1030
00:52:12,810 --> 00:52:28,340
of luck here I'm gonna have to do a

1031
00:52:22,470 --> 00:52:28,339
restart here what is doing

1032
00:52:28,420 --> 00:52:37,990
I come back here nothing I'd say like is

1033
00:52:36,130 --> 00:52:46,980
my internet down but I'm like VPN into

1034
00:52:37,990 --> 00:52:49,558
my router right now so I tell you what

1035
00:52:46,980 --> 00:52:52,000
you're like five minutes I'm gonna do

1036
00:52:49,559 --> 00:52:57,819
just a quick I'll just restart this

1037
00:52:52,000 --> 00:52:59,170
whole thing and then we can I'll take

1038
00:52:57,819 --> 00:53:02,170
any questions it shouldn't take too long

1039
00:52:59,170 --> 00:53:03,819
looking try it again but really what

1040
00:53:02,170 --> 00:53:06,400
proxy change does is it runs through

1041
00:53:03,819 --> 00:53:10,500
every you know every chain link that I

1042
00:53:06,400 --> 00:53:10,500
have and launches those attacks yeah

1043
00:53:24,520 --> 00:53:31,900
yeah absolutely so you definitely need

1044
00:53:27,190 --> 00:53:34,540
to have that what so what I did here is

1045
00:53:31,900 --> 00:53:37,720
I went back seven days will go back a

1046
00:53:34,540 --> 00:53:39,160
little longer will go back 30 days so

1047
00:53:37,720 --> 00:53:40,689
you see this when I'm highlighting here

1048
00:53:39,160 --> 00:53:44,109
right now is a list of compromised user

1049
00:53:40,690 --> 00:53:50,070
logins this is a list of accounts that

1050
00:53:44,110 --> 00:53:57,360
were successful during an attack okay

1051
00:53:50,070 --> 00:53:59,800
this will come up here give me some love

1052
00:53:57,360 --> 00:54:02,200
and then we'd be able to see which user

1053
00:53:59,800 --> 00:54:04,420
names were we're listed here so this

1054
00:54:02,200 --> 00:54:06,460
will be all stored on the source IP and

1055
00:54:04,420 --> 00:54:08,860
this will actually provide to your the

1056
00:54:06,460 --> 00:54:13,060
usernames that you would then want to go

1057
00:54:08,860 --> 00:54:14,380
and take back and give to your you know

1058
00:54:13,060 --> 00:54:15,520
give to your fraud team and say hey

1059
00:54:14,380 --> 00:54:19,360
these are the passwords that we need to

1060
00:54:15,520 --> 00:54:20,710
reset so let me try this here alright so

1061
00:54:19,360 --> 00:54:23,619
here we can kind of see what shows up

1062
00:54:20,710 --> 00:54:26,800
Googlebot impersonators if I take this

1063
00:54:23,619 --> 00:54:29,109
we'll just see the ones here so I was

1064
00:54:26,800 --> 00:54:30,369
successfully logging in as admin we

1065
00:54:29,109 --> 00:54:33,009
provide those usernames

1066
00:54:30,369 --> 00:54:34,780
and and you know this will show up it

1067
00:54:33,010 --> 00:54:37,180
what's really nice here is that these

1068
00:54:34,780 --> 00:54:37,780
will be you know filtered out during the

1069
00:54:37,180 --> 00:54:40,049
attack

1070
00:54:37,780 --> 00:54:43,050
so we'll see which ones were successful

1071
00:54:40,050 --> 00:54:43,050
mm-hmm

1072
00:54:52,280 --> 00:54:56,820
absolutely so there's that learning mode

1073
00:54:55,260 --> 00:54:59,190
when it ramps up so the algorithm is

1074
00:54:56,820 --> 00:55:02,010
still kicking in once the algorithm

1075
00:54:59,190 --> 00:55:04,260
catches up you know so for me basically

1076
00:55:02,010 --> 00:55:07,619
if I set the blocking to be on high I

1077
00:55:04,260 --> 00:55:09,680
shouldn't see any compromised user

1078
00:55:07,619 --> 00:55:12,770
logins in here that are listed as high

1079
00:55:09,680 --> 00:55:16,410
it should only be maybe medium and lows

1080
00:55:12,770 --> 00:55:19,080
that were successful if I come back in

1081
00:55:16,410 --> 00:55:21,149
here after the fact and we will retro

1082
00:55:19,080 --> 00:55:23,970
actively raise the risk level to these

1083
00:55:21,150 --> 00:55:27,240
if in the future it was determined oh

1084
00:55:23,970 --> 00:55:28,950
that was actually high and so that's a

1085
00:55:27,240 --> 00:55:31,379
very good point so my customers will

1086
00:55:28,950 --> 00:55:32,970
leverage this you know they I mean out

1087
00:55:31,380 --> 00:55:36,359
of like so that example that I showed

1088
00:55:32,970 --> 00:55:39,000
previously with 15 million attacks you

1089
00:55:36,359 --> 00:55:40,590
know out of that there was probably two

1090
00:55:39,000 --> 00:55:43,590
thousand that we might say these are

1091
00:55:40,590 --> 00:55:45,359
probably compromised logins what they do

1092
00:55:43,590 --> 00:55:47,010
is they come back in here sort that on

1093
00:55:45,359 --> 00:55:50,400
high and those were the ones that are

1094
00:55:47,010 --> 00:55:52,590
retro actively elevated those gets sent

1095
00:55:50,400 --> 00:55:55,890
to the fraud see immediately proactively

1096
00:55:52,590 --> 00:55:58,109
force a password reset or just use that

1097
00:55:55,890 --> 00:56:02,368
intelligence to possibly increase the

1098
00:55:58,109 --> 00:56:04,319
fraud score into other solutions so with

1099
00:56:02,369 --> 00:56:07,230
Imperva solutions specifically it this

1100
00:56:04,320 --> 00:56:10,490
sits at the edge it's a cloud wife just

1101
00:56:07,230 --> 00:56:14,250
like a Akamai or CloudFlare solution and

1102
00:56:10,490 --> 00:56:16,459
it's oftentimes the very first solution

1103
00:56:14,250 --> 00:56:19,109
to have visibility into the attack

1104
00:56:16,460 --> 00:56:22,200
because it's on the edge closest to the

1105
00:56:19,109 --> 00:56:25,259
edge user and so because of that you can

1106
00:56:22,200 --> 00:56:32,100
then feed that intelligence in the

1107
00:56:25,260 --> 00:56:33,660
downstream solutions okay yeah so that's

1108
00:56:32,100 --> 00:56:35,700
good the other thing here that is you're

1109
00:56:33,660 --> 00:56:38,009
evaluating account takeover solutions

1110
00:56:35,700 --> 00:56:40,410
you definitely want to look at lead

1111
00:56:38,010 --> 00:56:42,630
credentials this is another thing here

1112
00:56:40,410 --> 00:56:45,899
that we provide this is something you

1113
00:56:42,630 --> 00:56:47,369
can go out and say hey look here are you

1114
00:56:45,900 --> 00:56:49,590
know we have a list of I mean I don't

1115
00:56:47,369 --> 00:56:52,440
know billions of breach credentials from

1116
00:56:49,590 --> 00:56:54,869
various breaches that are out there it

1117
00:56:52,440 --> 00:56:57,240
may not even be used in the attack but

1118
00:56:54,869 --> 00:56:58,920
if somebody just logs in we can notify

1119
00:56:57,240 --> 00:57:00,990
oh hey that person is using credentials

1120
00:56:58,920 --> 00:57:03,480
that he also uses on mariette and ebay

1121
00:57:00,990 --> 00:57:04,740
and linkedin you might want to have him

1122
00:57:03,480 --> 00:57:07,530
reset his password

1123
00:57:04,740 --> 00:57:09,029
right those are two key things

1124
00:57:07,530 --> 00:57:10,740
especially the lead credentials if you

1125
00:57:09,030 --> 00:57:12,150
if you're looking at ATO and you have a

1126
00:57:10,740 --> 00:57:15,450
solution that doesn't have that just

1127
00:57:12,150 --> 00:57:21,060
keep looking you need to have that type

1128
00:57:15,450 --> 00:57:23,250
of intelligence yeah so we this is what

1129
00:57:21,060 --> 00:57:24,630
I launched like last week when I was

1130
00:57:23,250 --> 00:57:27,420
messing around with this getting ready

1131
00:57:24,630 --> 00:57:30,980
for this so appreciate the questions

1132
00:57:27,420 --> 00:57:30,980
let's see if that bought me enough time

1133
00:57:31,640 --> 00:57:35,390
we'll try this one more time

1134
00:57:37,339 --> 00:57:40,670
holy smokes

1135
00:57:42,410 --> 00:57:47,810
sounds many kids bought probably my kids

1136
00:57:44,490 --> 00:57:47,810
probably watching Netflix or something

1137
00:58:12,170 --> 00:58:15,440
all right

1138
00:58:22,330 --> 00:58:26,080
now obviously don't have to use X Hydra

1139
00:58:24,520 --> 00:58:30,540
but and obviously it done was pretty

1140
00:58:26,080 --> 00:58:30,540
well except when it doesn't work

1141
00:58:38,119 --> 00:58:40,180
you

1142
00:58:43,980 --> 00:58:47,160
thanks man

1143
00:58:52,090 --> 00:58:58,930
you know what for this one let's use one

1144
00:58:55,660 --> 00:59:01,500
that I know will work as a working

1145
00:58:58,930 --> 00:59:01,500
credential

1146
00:59:15,569 --> 00:59:17,630
you

1147
00:59:37,480 --> 00:59:47,359
well let's just go with that and that

1148
00:59:44,269 --> 00:59:49,700
that works it won't get around Hydra but

1149
00:59:47,359 --> 00:59:52,970
we'll see how far we get and then I can

1150
00:59:49,700 --> 01:00:01,609
just disable some protection if this

1151
00:59:52,970 --> 01:00:04,578
will get through the first 16 yeah there

1152
01:00:01,609 --> 01:00:12,499
we go okay so I got the round-robin

1153
01:00:04,579 --> 01:00:15,640
working let me go let me go grab I need

1154
01:00:12,499 --> 01:00:15,640
my header value real quick

1155
01:00:30,340 --> 01:00:35,020
really difficult to find these things I

1156
01:00:35,560 --> 01:00:39,080
think this is the thing that's most

1157
01:00:37,340 --> 01:00:42,590
surprising right is people really feel

1158
01:00:39,080 --> 01:00:46,279
that to launch some attack like this I

1159
01:00:42,590 --> 01:00:49,310
have to be you know it's super

1160
01:00:46,280 --> 01:00:52,790
complicated and all the data is hidden

1161
01:00:49,310 --> 01:00:55,090
underneath some magic rock or I don't

1162
01:00:52,790 --> 01:00:55,090
know

1163
01:01:03,400 --> 01:01:13,809
but that is not the case all right

1164
01:01:09,720 --> 01:01:16,538
now we should have some data when that

1165
01:01:13,809 --> 01:01:23,200
anything kicks off yeah we already had

1166
01:01:16,539 --> 01:01:25,920
some stuff in there and I just want to

1167
01:01:23,200 --> 01:01:29,410
make sure yeah okay good

1168
01:01:25,920 --> 01:01:31,269
otherwise it wouldn't get too far all

1169
01:01:29,410 --> 01:01:42,519
right so I'm at 4:30 now we'll be about

1170
01:01:31,269 --> 01:01:44,740
done here I'll let you guys go so this

1171
01:01:42,519 --> 01:01:47,229
is going through the connections right

1172
01:01:44,740 --> 01:01:50,348
now when I keep saying ok it means it's

1173
01:01:47,230 --> 01:01:55,210
good it's good it should keep going

1174
01:01:50,349 --> 01:01:56,980
there we go and now we're cooking so

1175
01:01:55,210 --> 01:02:00,210
this will be your chain this is just

1176
01:01:56,980 --> 01:02:02,559
picking up two random IP addresses and

1177
01:02:00,210 --> 01:02:05,849
right now it looks like so I did update

1178
01:02:02,559 --> 01:02:08,769
this about two hours ago my proxy list

1179
01:02:05,849 --> 01:02:11,410
so I'm not seeing that the connection

1180
01:02:08,769 --> 01:02:17,649
timeouts and drop connections that I saw

1181
01:02:11,410 --> 01:02:21,788
before which is good and this this will

1182
01:02:17,650 --> 01:02:28,210
show up here but the connections take a

1183
01:02:21,789 --> 01:02:30,069
little while yeah and so what's

1184
01:02:28,210 --> 01:02:34,989
interesting is but it goes through all

1185
01:02:30,069 --> 01:02:37,749
of this it'll just keep going and you

1186
01:02:34,989 --> 01:02:40,930
got 4,000 proxies to go through and now

1187
01:02:37,749 --> 01:02:42,788
my traffic all everything's hit in you

1188
01:02:40,930 --> 01:02:44,558
know it doesn't detect the user agent it

1189
01:02:42,789 --> 01:02:48,339
doesn't affect my IP address I'm coming

1190
01:02:44,559 --> 01:02:52,359
from you know my my my target will now

1191
01:02:48,339 --> 01:02:55,328
see IP address is coming across from

1192
01:02:52,359 --> 01:02:57,369
every which direction and you're totally

1193
01:02:55,329 --> 01:03:00,130
obvious gated didn't have to buy a

1194
01:02:57,369 --> 01:03:03,670
botnet didn't have to own one just going

1195
01:03:00,130 --> 01:03:05,950
through a bunch of socks for proxies any

1196
01:03:03,670 --> 01:03:10,230
questions on that or what we talked

1197
01:03:05,950 --> 01:03:10,230
about yeah

1198
01:03:10,460 --> 01:03:15,480
cool well I'm at time I'm not I'm still

1199
01:03:14,099 --> 01:03:18,930
not getting traffic over here but I know

1200
01:03:15,480 --> 01:03:22,910
that I will the idea was to have that

1201
01:03:18,930 --> 01:03:30,049
running for a little while so he would

1202
01:03:22,910 --> 01:03:32,450
any other questions that's Hydra be safe

1203
01:03:30,049 --> 01:03:34,739
don't hurt yourself

1204
01:03:32,450 --> 01:03:37,149
okay guys I appreciate your time thanks

1205
01:03:34,739 --> 01:03:43,139
for your questions

1206
01:03:37,150 --> 01:03:43,139
[Applause]

