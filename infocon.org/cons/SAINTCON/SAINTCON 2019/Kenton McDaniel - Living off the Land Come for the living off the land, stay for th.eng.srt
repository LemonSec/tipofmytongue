1
00:00:00,000 --> 00:00:03,179
talk about why attackers would choose to

2
00:00:01,890 --> 00:00:04,950
live off the land and this is all from

3
00:00:03,179 --> 00:00:07,140
the perspective of an attacker I am an

4
00:00:04,950 --> 00:00:10,980
attacker that is what I do full-time I

5
00:00:07,140 --> 00:00:12,239
do threat simulation so there's a little

6
00:00:10,980 --> 00:00:13,290
bit on defense at the end but not very

7
00:00:12,240 --> 00:00:17,910
much because I don't do that I'm not

8
00:00:13,290 --> 00:00:18,960
very good at it so Who am I I'm Kenton

9
00:00:17,910 --> 00:00:21,180
McDaniel I'm a staff information

10
00:00:18,960 --> 00:00:22,650
security engineer I've got some letters

11
00:00:21,180 --> 00:00:24,720
behind my name there's more that I

12
00:00:22,650 --> 00:00:26,130
didn't list those are my favorite groups

13
00:00:24,720 --> 00:00:29,038
of letters that I like the most

14
00:00:26,130 --> 00:00:31,049
I like crypto I love getting shells

15
00:00:29,039 --> 00:00:31,740
nothing like that dopamine hit from

16
00:00:31,050 --> 00:00:34,530
getting the shell

17
00:00:31,740 --> 00:00:35,070
I love Provost to local Provost is so

18
00:00:34,530 --> 00:00:36,390
much fun

19
00:00:35,070 --> 00:00:38,579
secure application architecture and I

20
00:00:36,390 --> 00:00:40,290
love cracking passwords recently with

21
00:00:38,579 --> 00:00:43,379
the with Shawn's help built for password

22
00:00:40,290 --> 00:00:45,510
cracking regs so disclaimer so these

23
00:00:43,379 --> 00:00:47,430
represent my views and are not

24
00:00:45,510 --> 00:00:49,469
necessarily shared by my employer I'm

25
00:00:47,430 --> 00:00:51,899
going to be sharing some things that you

26
00:00:49,469 --> 00:00:53,489
could use to do malicious things I

27
00:00:51,899 --> 00:00:56,789
highly recommend you don't because you

28
00:00:53,489 --> 00:00:58,019
will get caught so don't but some of the

29
00:00:56,789 --> 00:01:00,660
things I'm gonna share our antivirus

30
00:00:58,020 --> 00:01:02,430
evasion techniques and frameworks don't

31
00:01:00,660 --> 00:01:04,080
use them mostly you'll get caught and

32
00:01:02,430 --> 00:01:05,700
you'll go to jail so this is a very

33
00:01:04,080 --> 00:01:08,039
high-level overview of living off the

34
00:01:05,700 --> 00:01:10,320
land I'm not gonna talk about any zero

35
00:01:08,040 --> 00:01:12,630
days I'm not gonna talk about anything

36
00:01:10,320 --> 00:01:13,889
that's new or novel except for maybe one

37
00:01:12,630 --> 00:01:15,658
little quirk that I'm gonna throw in

38
00:01:13,890 --> 00:01:17,189
it's just a perspective of what is

39
00:01:15,659 --> 00:01:19,049
living off the land why do people do it

40
00:01:17,189 --> 00:01:20,539
and how you can do it if this is part of

41
00:01:19,049 --> 00:01:23,340
your job

42
00:01:20,540 --> 00:01:25,200
so my disclaimer is that these

43
00:01:23,340 --> 00:01:27,360
techniques were all tested with local

44
00:01:25,200 --> 00:01:28,829
firewall intact on the VMS that I tested

45
00:01:27,360 --> 00:01:30,840
them on and the physical hosts that I

46
00:01:28,829 --> 00:01:32,639
tested them on they were tested with

47
00:01:30,840 --> 00:01:35,579
Windows Defender Norton AntiVirus McAfee

48
00:01:32,640 --> 00:01:37,619
Enterprise and also I tested one with

49
00:01:35,579 --> 00:01:39,929
Kaspersky before we phase that out and

50
00:01:37,619 --> 00:01:42,060
then I also have tested against cyber

51
00:01:39,930 --> 00:01:44,909
ease and active probe so these have been

52
00:01:42,060 --> 00:01:48,079
tested with real antivirus and real EDR

53
00:01:44,909 --> 00:01:50,009
solutions intact running and monitoring

54
00:01:48,079 --> 00:01:51,570
because a lot of you are gonna look at

55
00:01:50,009 --> 00:01:54,149
these payloads and laugh that's why I

56
00:01:51,570 --> 00:01:56,669
have this slide so for Mac OS I tested

57
00:01:54,149 --> 00:01:58,049
without antivirus because I didn't want

58
00:01:56,670 --> 00:01:59,420
to take the time to install antivirus on

59
00:01:58,049 --> 00:02:01,890
the Mac OS machine I found lying around

60
00:01:59,420 --> 00:02:02,700
but I'm confident my payload would still

61
00:02:01,890 --> 00:02:05,369
work in Linux

62
00:02:02,700 --> 00:02:09,810
I tested up with an up-to-date abun -

63
00:02:05,369 --> 00:02:13,080
LTS VM with no antivirus so living off

64
00:02:09,810 --> 00:02:13,920
the land living off the land is the idea

65
00:02:13,080 --> 00:02:16,069
of using in

66
00:02:13,920 --> 00:02:18,000
place binaries in order to do your

67
00:02:16,069 --> 00:02:19,619
exploitation and your post exploitation

68
00:02:18,000 --> 00:02:21,780
so it's not just about post exploitation

69
00:02:19,620 --> 00:02:24,090
it's also about your exploitation right

70
00:02:21,780 --> 00:02:25,680
finding a way into that machine finding

71
00:02:24,090 --> 00:02:28,230
away onto that environment by using

72
00:02:25,680 --> 00:02:30,270
pre-existing binaries so that you don't

73
00:02:28,230 --> 00:02:31,709
trigger the defense mechanisms you don't

74
00:02:30,270 --> 00:02:35,190
trigger their defenders they can't see

75
00:02:31,709 --> 00:02:36,480
you coming at all because antivirus is

76
00:02:35,190 --> 00:02:39,300
getting so much better at detecting

77
00:02:36,480 --> 00:02:41,280
threats hackers are gravitating towards

78
00:02:39,300 --> 00:02:44,030
living off the land so you used to have

79
00:02:41,280 --> 00:02:47,040
the early days of people were just

80
00:02:44,030 --> 00:02:48,180
throwing out binaries on their right

81
00:02:47,040 --> 00:02:49,980
that had never been on the machine

82
00:02:48,180 --> 00:02:52,440
signature based detection is getting

83
00:02:49,980 --> 00:02:53,459
pretty good these days and someone's

84
00:02:52,440 --> 00:02:54,120
always submitting something to

85
00:02:53,459 --> 00:02:57,090
virustotal

86
00:02:54,120 --> 00:02:59,040
so that means your payloads get detected

87
00:02:57,090 --> 00:03:00,780
quicker your signatures get up-to-date

88
00:02:59,040 --> 00:03:03,420
faster right your signatures are being

89
00:03:00,780 --> 00:03:07,019
updated hourly every minute sometimes

90
00:03:03,420 --> 00:03:08,429
so using precompiled binaries on a

91
00:03:07,019 --> 00:03:12,209
machinist sometimes not your best

92
00:03:08,430 --> 00:03:14,760
approach so living off the land includes

93
00:03:12,209 --> 00:03:16,170
also any pre-installed software so if

94
00:03:14,760 --> 00:03:17,459
you're attacking an enterprise group

95
00:03:16,170 --> 00:03:19,589
that you know has a pre-installed

96
00:03:17,459 --> 00:03:22,140
software use that pre-installed software

97
00:03:19,590 --> 00:03:23,850
to your advantage right figure out who

98
00:03:22,140 --> 00:03:26,059
you're attacking know what software they

99
00:03:23,850 --> 00:03:28,920
have used that to your advantage and

100
00:03:26,060 --> 00:03:31,170
then my idea is I want to minimize my

101
00:03:28,920 --> 00:03:32,820
footprint number one and I want to evade

102
00:03:31,170 --> 00:03:35,309
detection and I want to maintain access

103
00:03:32,820 --> 00:03:38,250
right I don't want to be detected I want

104
00:03:35,310 --> 00:03:39,989
to stay on that machine forever and I do

105
00:03:38,250 --> 00:03:41,519
not want to leave a huge footprint on

106
00:03:39,989 --> 00:03:45,180
the machine the bigger the footprint the

107
00:03:41,519 --> 00:03:46,829
easier I am to detect so a source for a

108
00:03:45,180 --> 00:03:48,840
lot of living offline information got

109
00:03:46,829 --> 00:03:51,540
two good github repos here the lol bass

110
00:03:48,840 --> 00:03:52,920
and the gtfo bins good repos for

111
00:03:51,540 --> 00:03:56,790
learning about living off the land

112
00:03:52,920 --> 00:04:00,149
binaries so living off the land is all

113
00:03:56,790 --> 00:04:01,170
about improvising right you have to be

114
00:04:00,150 --> 00:04:03,569
able to think on your feet you got to be

115
00:04:01,170 --> 00:04:04,619
able to move quickly so Windows I'm

116
00:04:03,569 --> 00:04:06,630
going to talk a little bit about Windows

117
00:04:04,620 --> 00:04:09,569
PowerShell PowerShell is still

118
00:04:06,630 --> 00:04:12,959
incredibly useful many things are

119
00:04:09,569 --> 00:04:15,298
detecting power show usage but you can

120
00:04:12,959 --> 00:04:16,680
still get in using powershell cert util

121
00:04:15,299 --> 00:04:18,690
i exact bash

122
00:04:16,680 --> 00:04:19,918
I love windows subsystem Linux it's

123
00:04:18,690 --> 00:04:21,539
fantastic I have a whole bunch of slides

124
00:04:19,918 --> 00:04:25,140
we'll get there love windows subsystem

125
00:04:21,539 --> 00:04:27,599
Linux so much msbuild C sharp and dotnet

126
00:04:25,140 --> 00:04:29,490
core so compiling your own

127
00:04:27,600 --> 00:04:31,530
code on the fly pushing your entire

128
00:04:29,490 --> 00:04:32,550
payload over the wire think about those

129
00:04:31,530 --> 00:04:34,679
kind of things right

130
00:04:32,550 --> 00:04:37,290
your entire code flows over the wire as

131
00:04:34,680 --> 00:04:38,910
a string compiled remotely on the host

132
00:04:37,290 --> 00:04:40,140
with different signatures every single

133
00:04:38,910 --> 00:04:43,770
time that's how you live off the land

134
00:04:40,140 --> 00:04:46,500
and others for Windows so defenders are

135
00:04:43,770 --> 00:04:48,510
plugin powershell a lot and so the thing

136
00:04:46,500 --> 00:04:50,040
the trend that I've noticed is that

137
00:04:48,510 --> 00:04:51,390
traditional lol bins are getting flagged

138
00:04:50,040 --> 00:04:53,310
as malicious right like if I'm trying to

139
00:04:51,390 --> 00:04:55,050
use cert util the downloaded file it's

140
00:04:53,310 --> 00:04:56,280
gonna get flagged a lot even if it

141
00:04:55,050 --> 00:04:58,680
doesn't get stopped dead in its tracks

142
00:04:56,280 --> 00:05:02,190
it's gonna get flagged someone's gonna

143
00:04:58,680 --> 00:05:04,260
notice it right but what I'm seeing the

144
00:05:02,190 --> 00:05:07,290
trend is it's people are moving towards

145
00:05:04,260 --> 00:05:09,420
full dotnet native code so you talk

146
00:05:07,290 --> 00:05:12,090
about things like power up if anyone's

147
00:05:09,420 --> 00:05:13,500
familiar power up so power ups going

148
00:05:12,090 --> 00:05:14,520
away because everything Flags power up

149
00:05:13,500 --> 00:05:16,050
they're like that's a previous script

150
00:05:14,520 --> 00:05:18,150
you can't run that so they have things

151
00:05:16,050 --> 00:05:21,420
like sharp up char pound there's this

152
00:05:18,150 --> 00:05:23,370
whole C sharp suite of tools using built

153
00:05:21,420 --> 00:05:24,960
in dotnet libraries that already exist

154
00:05:23,370 --> 00:05:28,380
on the machines much like powers already

155
00:05:24,960 --> 00:05:30,000
existed on the machines so Mac OS talked

156
00:05:28,380 --> 00:05:33,390
a little bit about Mac OS I am NOT a Mac

157
00:05:30,000 --> 00:05:36,630
OS guy but you can exploit Mac OS so

158
00:05:33,390 --> 00:05:38,719
matka Python OS a script and the list

159
00:05:36,630 --> 00:05:42,000
goes on Macs have tons of built-in

160
00:05:38,720 --> 00:05:44,840
binaries that allow you to maintain your

161
00:05:42,000 --> 00:05:47,850
access and to bring more land in and

162
00:05:44,840 --> 00:05:49,830
then Linux Linux is my favorite because

163
00:05:47,850 --> 00:05:51,840
you can do whatever you want on Linux

164
00:05:49,830 --> 00:05:55,409
most of the time unless you're sysadmin

165
00:05:51,840 --> 00:05:58,049
is really restrict down the things and I

166
00:05:55,410 --> 00:05:59,910
have not found many that do let's just

167
00:05:58,050 --> 00:06:02,070
say that I have not found many that are

168
00:05:59,910 --> 00:06:03,930
fastidious enough to go through and

169
00:06:02,070 --> 00:06:06,480
restrict down the usage of everything

170
00:06:03,930 --> 00:06:08,910
pythons their pearls their rubies their

171
00:06:06,480 --> 00:06:10,290
everything is there to allow me to

172
00:06:08,910 --> 00:06:12,780
expand my footprint run things only in

173
00:06:10,290 --> 00:06:14,190
memory so let's talk about our initial

174
00:06:12,780 --> 00:06:16,559
foothold we're gonna talk about exploits

175
00:06:14,190 --> 00:06:17,760
versus phishing an exploit for the

176
00:06:16,560 --> 00:06:19,500
definition of what we're talking about

177
00:06:17,760 --> 00:06:21,240
here is finding something in the

178
00:06:19,500 --> 00:06:24,390
application or os code that allows for

179
00:06:21,240 --> 00:06:26,580
unintended paths or subverting intended

180
00:06:24,390 --> 00:06:28,590
paths to get code execution to get

181
00:06:26,580 --> 00:06:29,969
access to get persistence right we're

182
00:06:28,590 --> 00:06:31,500
not going to talk about exploits that's

183
00:06:29,970 --> 00:06:33,060
way too much to cover in this so we're

184
00:06:31,500 --> 00:06:34,770
gonna go for the low-hanging fruit

185
00:06:33,060 --> 00:06:36,690
we're also going to talk about Prive

186
00:06:34,770 --> 00:06:37,979
esque and the small note about probe

187
00:06:36,690 --> 00:06:40,440
esque is I'm not going to talk about it

188
00:06:37,980 --> 00:06:41,340
much but when you're talking about

189
00:06:40,440 --> 00:06:42,840
looking at pretty

190
00:06:41,340 --> 00:06:44,820
tasks don't go to the colonel first

191
00:06:42,840 --> 00:06:46,859
always look for pre-installed software

192
00:06:44,820 --> 00:06:49,740
software is absolutely horrible at

193
00:06:46,860 --> 00:06:51,240
running with lease privilege and I say

194
00:06:49,740 --> 00:06:53,610
that because I was a software developer

195
00:06:51,240 --> 00:06:55,380
for 13 years and I work with lots of

196
00:06:53,610 --> 00:06:56,699
software developer software is horrible

197
00:06:55,380 --> 00:06:58,020
at running with least privilege that's

198
00:06:56,699 --> 00:06:59,820
where you look for your probe escas in

199
00:06:58,020 --> 00:07:03,330
your software so we're going to talk

200
00:06:59,820 --> 00:07:05,880
about phishing because that is one of

201
00:07:03,330 --> 00:07:08,280
the easier ways to get into a system is

202
00:07:05,880 --> 00:07:10,440
by phishing convincing a user to open

203
00:07:08,280 --> 00:07:12,448
something or to visit a link that will

204
00:07:10,440 --> 00:07:15,450
allow you to get more access than you

205
00:07:12,449 --> 00:07:17,040
should have you should research your

206
00:07:15,450 --> 00:07:18,030
fish right everybody knows it's you

207
00:07:17,040 --> 00:07:19,500
gotta know what software they've got

208
00:07:18,030 --> 00:07:21,270
there so you can know how to live off

209
00:07:19,500 --> 00:07:22,680
the land afterward you need to research

210
00:07:21,270 --> 00:07:24,240
your people what are they complaining

211
00:07:22,680 --> 00:07:26,070
about on social media people are all

212
00:07:24,240 --> 00:07:28,169
over social media and it's hilarious

213
00:07:26,070 --> 00:07:29,700
because they complain about the

214
00:07:28,169 --> 00:07:31,289
frameworks and tools they have to use

215
00:07:29,700 --> 00:07:33,330
now you know a frameworks and tools they

216
00:07:31,290 --> 00:07:35,220
use right they're complaining about

217
00:07:33,330 --> 00:07:36,630
setting up these new instances now you

218
00:07:35,220 --> 00:07:38,490
know everything about those instances

219
00:07:36,630 --> 00:07:40,080
research your fish know exactly who

220
00:07:38,490 --> 00:07:42,389
you're going after social media is a

221
00:07:40,080 --> 00:07:45,180
goldmine for finding out how to live off

222
00:07:42,389 --> 00:07:47,940
the land for that particular person now

223
00:07:45,180 --> 00:07:49,350
why do we live off the land the bottom

224
00:07:47,940 --> 00:07:51,660
bullet point is the most salient point

225
00:07:49,350 --> 00:07:53,610
right there's an inherent trust level

226
00:07:51,660 --> 00:07:55,350
when you're living off the land because

227
00:07:53,610 --> 00:07:57,599
those things are already included in

228
00:07:55,350 --> 00:07:59,099
what you're attacking and so you don't

229
00:07:57,599 --> 00:08:00,570
have to do any extra work to bring

230
00:07:59,099 --> 00:08:02,010
something down and make it trusted it's

231
00:08:00,570 --> 00:08:03,120
already trusted it's already installed

232
00:08:02,010 --> 00:08:05,310
it's been vetted

233
00:08:03,120 --> 00:08:07,620
now you're subverting that and using

234
00:08:05,310 --> 00:08:11,610
that to maintain or gain access to the

235
00:08:07,620 --> 00:08:16,500
machine so again no 0 days right I'm not

236
00:08:11,610 --> 00:08:20,400
dropping 0 days so fishing let's show a

237
00:08:16,500 --> 00:08:22,500
very short demo of fishing a Windows

238
00:08:20,400 --> 00:08:24,989
user and let's show how living offline

239
00:08:22,500 --> 00:08:27,300
can work so scenario number one for our

240
00:08:24,990 --> 00:08:28,800
Windows user right I'm gonna send a

241
00:08:27,300 --> 00:08:30,599
malicious Word document everybody loves

242
00:08:28,800 --> 00:08:31,800
Word documents right I love them you can

243
00:08:30,599 --> 00:08:35,279
do so many cool things with Word

244
00:08:31,800 --> 00:08:36,839
documents so I want my payload to not

245
00:08:35,279 --> 00:08:38,370
immediately get snagged by

246
00:08:36,839 --> 00:08:39,450
signature-based antivirus let's say

247
00:08:38,370 --> 00:08:40,830
that's our first hurdle we won't

248
00:08:39,450 --> 00:08:42,779
overcome signature based antivirus I

249
00:08:40,830 --> 00:08:44,490
won't my payload not to get snack so

250
00:08:42,779 --> 00:08:46,589
solution number one to that problem

251
00:08:44,490 --> 00:08:49,140
number one is I can use AV evasion

252
00:08:46,589 --> 00:08:51,930
modules anyone ever used if the evasion

253
00:08:49,140 --> 00:08:53,880
frameworks veil you know stuff like that

254
00:08:51,930 --> 00:08:55,150
talk about some other ones there's a

255
00:08:53,880 --> 00:08:56,920
bunch of AV evasion

256
00:08:55,150 --> 00:08:58,990
frameworks out there that can get you

257
00:08:56,920 --> 00:09:00,579
binaries that will usually are

258
00:08:58,990 --> 00:09:02,110
precompiled you compile them yourself

259
00:09:00,580 --> 00:09:02,440
and then you can push them down to the

260
00:09:02,110 --> 00:09:04,600
machine

261
00:09:02,440 --> 00:09:08,140
the problem is AV is your Bayesian is

262
00:09:04,600 --> 00:09:09,820
great for a little while and so

263
00:09:08,140 --> 00:09:11,380
eventually your payload is gonna get

264
00:09:09,820 --> 00:09:12,820
detected if you leave it on the machine

265
00:09:11,380 --> 00:09:14,350
if you forget to clean up you might be

266
00:09:12,820 --> 00:09:16,390
the one that got it detected right

267
00:09:14,350 --> 00:09:17,860
if you leave your payload there it's

268
00:09:16,390 --> 00:09:19,930
gonna get detected and eventually it's

269
00:09:17,860 --> 00:09:21,610
gonna get detected so I was using three

270
00:09:19,930 --> 00:09:24,040
or four different AV evasion frameworks

271
00:09:21,610 --> 00:09:26,920
that I really loved and recently I was

272
00:09:24,040 --> 00:09:28,839
attacking a Windows Server 2016 box and

273
00:09:26,920 --> 00:09:31,209
every single one of them got stomped

274
00:09:28,840 --> 00:09:33,520
immediately by Defender and that was new

275
00:09:31,210 --> 00:09:35,680
that was new as of like month and a half

276
00:09:33,520 --> 00:09:37,270
ago I was used to using these AV evasion

277
00:09:35,680 --> 00:09:39,609
frameworks and I was like I'm made right

278
00:09:37,270 --> 00:09:41,680
this is golden I got code execution I

279
00:09:39,610 --> 00:09:44,890
can stay there forever now they

280
00:09:41,680 --> 00:09:47,020
immediately got snagged so the caveat is

281
00:09:44,890 --> 00:09:48,670
use your own homegrown AV evasion

282
00:09:47,020 --> 00:09:50,800
frameworks if you want to pre compiled

283
00:09:48,670 --> 00:09:52,240
binaries that you're gonna push out to

284
00:09:50,800 --> 00:09:54,699
them use your own homegrown I wrote my

285
00:09:52,240 --> 00:09:56,890
own in c-sharp works like a champ no

286
00:09:54,700 --> 00:09:59,680
detection right and always modify the

287
00:09:56,890 --> 00:10:01,990
signatures a little bit modify your

288
00:09:59,680 --> 00:10:04,030
signatures of your methods modify what

289
00:10:01,990 --> 00:10:06,370
you compile don't you don't have to go

290
00:10:04,030 --> 00:10:08,020
for polymorphic if anyone's familiar

291
00:10:06,370 --> 00:10:09,970
with that idea right you don't need to

292
00:10:08,020 --> 00:10:12,610
go the whole idea of like every

293
00:10:09,970 --> 00:10:14,170
half-hour it brings down a new set of

294
00:10:12,610 --> 00:10:16,090
code that it compiles on-the-fly and

295
00:10:14,170 --> 00:10:18,010
replaces the old one I mean that's what

296
00:10:16,090 --> 00:10:19,720
the that's what the ransomware guys are

297
00:10:18,010 --> 00:10:21,310
doing you don't need to do that because

298
00:10:19,720 --> 00:10:22,720
we're all doing this with consent from

299
00:10:21,310 --> 00:10:23,979
the people that we've tested so we're

300
00:10:22,720 --> 00:10:26,200
not trying to maintain access for that

301
00:10:23,980 --> 00:10:27,910
long right cuz we're the good guys so

302
00:10:26,200 --> 00:10:29,170
we're not we don't need to do that but

303
00:10:27,910 --> 00:10:31,510
we do need to modify our signatures

304
00:10:29,170 --> 00:10:33,520
because we don't want to get caught and

305
00:10:31,510 --> 00:10:34,990
if you want your AV evasion to last

306
00:10:33,520 --> 00:10:37,360
don't share it with the community I know

307
00:10:34,990 --> 00:10:39,690
that sounds like a total jerk move but

308
00:10:37,360 --> 00:10:41,500
someone will submit it to virustotal

309
00:10:39,690 --> 00:10:42,760
because they'll be like I wonder what

310
00:10:41,500 --> 00:10:44,110
the detection rate is on this thing

311
00:10:42,760 --> 00:10:45,760
they'll submit it's a virus total and

312
00:10:44,110 --> 00:10:48,280
it's blown the AV vendors will update

313
00:10:45,760 --> 00:10:51,310
their signatures and your your antivirus

314
00:10:48,280 --> 00:10:53,410
evasion is completely blown so horde it

315
00:10:51,310 --> 00:10:55,510
if you're gonna use precompiled binaries

316
00:10:53,410 --> 00:10:59,949
don't share that's why I used OC I'm not

317
00:10:55,510 --> 00:11:01,990
sharing mine so horde it especially note

318
00:10:59,950 --> 00:11:03,370
about Windows Defender Windows Defender

319
00:11:01,990 --> 00:11:05,050
is getting really really good and

320
00:11:03,370 --> 00:11:07,000
anytime I land on a Windows box and I

321
00:11:05,050 --> 00:11:07,839
see defender there I know I'm gonna have

322
00:11:07,000 --> 00:11:10,030
to work hard

323
00:11:07,840 --> 00:11:11,950
what I'm gonna get the best thing you

324
00:11:10,030 --> 00:11:13,630
can do is install antivirus on top of

325
00:11:11,950 --> 00:11:15,550
defender if anyone's ever done that cuz

326
00:11:13,630 --> 00:11:16,750
then defender shuts down defender is

327
00:11:15,550 --> 00:11:19,240
like oh cool you got something else so

328
00:11:16,750 --> 00:11:20,470
you like drop Kaspersky drop McAfee on

329
00:11:19,240 --> 00:11:22,900
the box something like that

330
00:11:20,470 --> 00:11:24,190
defender shuts down and so now you just

331
00:11:22,900 --> 00:11:25,720
got to work against signature-based

332
00:11:24,190 --> 00:11:27,100
which is so much easier to get around

333
00:11:25,720 --> 00:11:29,140
than behavior-based I haven't seen any

334
00:11:27,100 --> 00:11:31,540
real good behavior detection out of a

335
00:11:29,140 --> 00:11:34,390
lot of commercial antivirus antivirus

336
00:11:31,540 --> 00:11:35,650
packages so solution number two this is

337
00:11:34,390 --> 00:11:37,480
the one I'm gonna do let's use a full

338
00:11:35,650 --> 00:11:39,730
shower powerful shell solution that

339
00:11:37,480 --> 00:11:42,370
never touches disk this should minimize

340
00:11:39,730 --> 00:11:44,890
our impact and should minimize our

341
00:11:42,370 --> 00:11:47,080
chance of being detected and according

342
00:11:44,890 --> 00:11:49,030
to a CrowdStrike global threat report of

343
00:11:47,080 --> 00:11:51,400
2019 most cyber criminals in the United

344
00:11:49,030 --> 00:11:54,010
States are moving towards file lists

345
00:11:51,400 --> 00:11:55,569
right they're moving completely away

346
00:11:54,010 --> 00:11:57,730
from a file based malware they're moving

347
00:11:55,570 --> 00:12:00,370
to file less now at some point is there

348
00:11:57,730 --> 00:12:03,430
a file there somewhere yes but it's

349
00:12:00,370 --> 00:12:05,050
growing to be your your exploitation

350
00:12:03,430 --> 00:12:06,099
point and how you're gaining and

351
00:12:05,050 --> 00:12:07,900
maintaining your persistence is

352
00:12:06,100 --> 00:12:10,030
completely filed us and that's where

353
00:12:07,900 --> 00:12:11,829
it's growing in the US and the croucher

354
00:12:10,030 --> 00:12:12,730
report is fascinating is different in

355
00:12:11,830 --> 00:12:14,260
all these different parts of the world

356
00:12:12,730 --> 00:12:16,540
which is very interesting to me if you

357
00:12:14,260 --> 00:12:18,400
guys want to look it up so PowerShell is

358
00:12:16,540 --> 00:12:20,290
included in most versions of Windows by

359
00:12:18,400 --> 00:12:22,060
default lots of organizations are

360
00:12:20,290 --> 00:12:23,709
restricting PowerShell usage but if I

361
00:12:22,060 --> 00:12:25,810
put it inside of a macro in a Word

362
00:12:23,710 --> 00:12:28,540
document and that person clicks yes to

363
00:12:25,810 --> 00:12:30,339
run the macro it doesn't matter because

364
00:12:28,540 --> 00:12:31,780
PowerShell just let you bypass all the

365
00:12:30,340 --> 00:12:36,670
restrictions that are in place and run

366
00:12:31,780 --> 00:12:38,530
arbitrary commands so inside my macro I

367
00:12:36,670 --> 00:12:41,469
said to evade policies and macros in

368
00:12:38,530 --> 00:12:44,949
2019 right yeah well macros are still

369
00:12:41,470 --> 00:12:46,660
used and people still click on them like

370
00:12:44,950 --> 00:12:49,120
I've an alarming rate people still click

371
00:12:46,660 --> 00:12:51,579
on macros and they still click links an

372
00:12:49,120 --> 00:12:53,140
AV detection of macros is not great the

373
00:12:51,580 --> 00:12:55,210
more heavily you off you skate what's

374
00:12:53,140 --> 00:12:57,550
happening inside of the macro so dust

375
00:12:55,210 --> 00:12:59,170
off your VB skills the more heavily you

376
00:12:57,550 --> 00:13:01,449
office off you skate what's in there

377
00:12:59,170 --> 00:13:03,280
delete that less likely it is to be

378
00:13:01,450 --> 00:13:06,370
detected and because some macros still

379
00:13:03,280 --> 00:13:08,140
have legitimate business usage I have

380
00:13:06,370 --> 00:13:10,150
yet to find an organization that has

381
00:13:08,140 --> 00:13:12,460
completely restricted macro usage you

382
00:13:10,150 --> 00:13:13,810
can do it but I don't know how some of

383
00:13:12,460 --> 00:13:15,460
your business people would get by if

384
00:13:13,810 --> 00:13:18,160
they use macros heavily in their in

385
00:13:15,460 --> 00:13:20,320
their workflow so there's a whole bunch

386
00:13:18,160 --> 00:13:21,189
of other ways you can use macros other

387
00:13:20,320 --> 00:13:23,470
than just

388
00:13:21,190 --> 00:13:25,270
power show you can do DDD Otto my

389
00:13:23,470 --> 00:13:26,950
favorite is dumping SMB hashes over the

390
00:13:25,270 --> 00:13:29,020
Internet it's wonderful you just embed

391
00:13:26,950 --> 00:13:30,130
an image in there tell it to use SMB to

392
00:13:29,020 --> 00:13:32,079
get the image and they'll dump their

393
00:13:30,130 --> 00:13:34,120
Intel and v2 hashes over the Internet to

394
00:13:32,080 --> 00:13:36,430
you then you try to either relay those

395
00:13:34,120 --> 00:13:37,540
crack them whatever so let's talk about

396
00:13:36,430 --> 00:13:39,729
the payload real quick what the payload

397
00:13:37,540 --> 00:13:41,589
looks like I'm saying no profiles so

398
00:13:39,730 --> 00:13:43,690
don't run this as any user execution

399
00:13:41,590 --> 00:13:45,010
policy ha just bypass the execution

400
00:13:43,690 --> 00:13:47,830
policy I don't care what the execution

401
00:13:45,010 --> 00:13:49,540
policy is hidden window style and then

402
00:13:47,830 --> 00:13:51,010
I'm running an encoded command you

403
00:13:49,540 --> 00:13:52,599
should always base64 encode your

404
00:13:51,010 --> 00:13:55,120
commands if for no other reason make

405
00:13:52,600 --> 00:13:56,950
people work at least a little bit write

406
00:13:55,120 --> 00:13:58,420
it at least make them work a little bit

407
00:13:56,950 --> 00:14:01,150
sure you're clear text command may run

408
00:13:58,420 --> 00:14:02,800
but make them work for it but now I've

409
00:14:01,150 --> 00:14:04,209
got this shell right so this command

410
00:14:02,800 --> 00:14:06,250
right here give me a shell on the system

411
00:14:04,210 --> 00:14:08,050
now I want persistence so I'm gonna

412
00:14:06,250 --> 00:14:11,350
create a start up item in a folder using

413
00:14:08,050 --> 00:14:12,640
Windows system Linux bash because I love

414
00:14:11,350 --> 00:14:14,740
bash it's so much easier to download

415
00:14:12,640 --> 00:14:17,050
files and bash than it is on PowerShell

416
00:14:14,740 --> 00:14:19,330
I guess I just suck at PowerShell so in

417
00:14:17,050 --> 00:14:21,219
pivoting between different living off

418
00:14:19,330 --> 00:14:22,270
the land techniques is also a great way

419
00:14:21,220 --> 00:14:24,610
to not get detected

420
00:14:22,270 --> 00:14:25,449
right if you're going hard and fast on

421
00:14:24,610 --> 00:14:27,250
PowerShell

422
00:14:25,450 --> 00:14:28,990
it's gonna start raising flags if I'm

423
00:14:27,250 --> 00:14:30,580
pivoting between the different binaries

424
00:14:28,990 --> 00:14:32,170
and different executables and I'm using

425
00:14:30,580 --> 00:14:34,240
I'm less likely to be detected if I'm

426
00:14:32,170 --> 00:14:36,160
quiet if I'm noisy as all get-out

427
00:14:34,240 --> 00:14:39,340
I'm gonna be detected be quiet minimize

428
00:14:36,160 --> 00:14:41,230
your footprint so let's show this short

429
00:14:39,340 --> 00:14:44,380
video if this will render come on office

430
00:14:41,230 --> 00:14:45,820
365 there we go so this is from an

431
00:14:44,380 --> 00:14:47,320
attackers perspective I don't know oh

432
00:14:45,820 --> 00:14:51,400
it's a ginormous you guys should be able

433
00:14:47,320 --> 00:14:54,760
to see it so what you'll see is me I'm

434
00:14:51,400 --> 00:14:56,680
opening a word document right and I just

435
00:14:54,760 --> 00:15:00,310
got a show back using full PowerShell

436
00:14:56,680 --> 00:15:03,069
and now what I'm gonna do is I am

437
00:15:00,310 --> 00:15:04,989
actually going to run bash because this

438
00:15:03,070 --> 00:15:06,820
poor soul has windows subsystem Linux

439
00:15:04,990 --> 00:15:08,230
installed and so now I'm getting a full

440
00:15:06,820 --> 00:15:09,760
reverse show in bash and if you look at

441
00:15:08,230 --> 00:15:11,260
the payload that I used it's not

442
00:15:09,760 --> 00:15:13,540
obfuscated in any way shape or form

443
00:15:11,260 --> 00:15:15,189
defender McAfee Norton everyone's fine

444
00:15:13,540 --> 00:15:17,260
with it cyber reason they don't care

445
00:15:15,190 --> 00:15:19,650
because it's windows subsystem Linux no

446
00:15:17,260 --> 00:15:21,939
one knows what it is or what it's doing

447
00:15:19,650 --> 00:15:23,829
so I've got my reverse shell and now I'm

448
00:15:21,940 --> 00:15:26,380
gonna dump something in the startup

449
00:15:23,830 --> 00:15:28,540
folder right that'll give me a show

450
00:15:26,380 --> 00:15:31,110
every single time the system restarts

451
00:15:28,540 --> 00:15:34,110
using the same windows subsystem Linux

452
00:15:31,110 --> 00:15:34,110
so

453
00:15:34,730 --> 00:15:40,650
this is me

454
00:15:36,270 --> 00:15:42,480
typing super slow and here we go see I

455
00:15:40,650 --> 00:15:44,069
love I love windows system subsystem

456
00:15:42,480 --> 00:15:47,550
Linux a can just double you get the file

457
00:15:44,070 --> 00:15:50,310
right it's super easy double you get the

458
00:15:47,550 --> 00:15:53,609
file I put it down there and now I can

459
00:15:50,310 --> 00:15:55,770
kill myself out of this show and I come

460
00:15:53,610 --> 00:15:59,460
back over to this other show and I say

461
00:15:55,770 --> 00:16:01,439
okay I'm gonna restart windows just to

462
00:15:59,460 --> 00:16:03,300
prove that it works right I mean usually

463
00:16:01,440 --> 00:16:04,860
you just wait for the user to restart it

464
00:16:03,300 --> 00:16:06,120
because these are usually Windows

465
00:16:04,860 --> 00:16:08,160
desktops and they're not gonna stay

466
00:16:06,120 --> 00:16:10,020
online for a long time I'm just doing it

467
00:16:08,160 --> 00:16:11,790
just to prove that it happens so let's

468
00:16:10,020 --> 00:16:13,589
skip ahead because for some reason this

469
00:16:11,790 --> 00:16:20,849
takes a disgusting amount of time to

470
00:16:13,589 --> 00:16:24,050
reboot come on oh there it is so you can

471
00:16:20,850 --> 00:16:26,430
see it got wait No hold on come on

472
00:16:24,050 --> 00:16:28,740
you'll see I'm gonna get a hit on my

473
00:16:26,430 --> 00:16:38,969
HTTP server or it's going to download my

474
00:16:28,740 --> 00:16:41,310
malicious startup command there you go

475
00:16:38,970 --> 00:16:45,120
so just got payload text right which

476
00:16:41,310 --> 00:16:46,619
payload text is in the lower what is

477
00:16:45,120 --> 00:16:48,980
that for you guys the lower right hand

478
00:16:46,620 --> 00:16:53,550
corner right that's what the payload was

479
00:16:48,980 --> 00:16:55,709
just a clear text bash reverse shell so

480
00:16:53,550 --> 00:16:57,569
got payload text for my server ran it

481
00:16:55,709 --> 00:17:01,109
and now I have a reverse shell on that

482
00:16:57,570 --> 00:17:02,880
machine so practical applications what

483
00:17:01,110 --> 00:17:04,319
are my practical applications here I'm

484
00:17:02,880 --> 00:17:05,490
setting up malware torrents I had the

485
00:17:04,319 --> 00:17:06,780
startup folder I'm setting up a key

486
00:17:05,490 --> 00:17:08,609
logger I'm still in credentials right

487
00:17:06,780 --> 00:17:10,379
practical applications for living off

488
00:17:08,609 --> 00:17:11,639
the land of course we're doing this as

489
00:17:10,380 --> 00:17:12,780
an authorized person we're not doing

490
00:17:11,640 --> 00:17:13,230
this legally because that's a terrible

491
00:17:12,780 --> 00:17:16,050
idea

492
00:17:13,230 --> 00:17:17,670
so since we're using a power shown coded

493
00:17:16,050 --> 00:17:20,069
command antivirus and defender are a

494
00:17:17,670 --> 00:17:24,270
little bit more unlikely but as of july

495
00:17:20,069 --> 00:17:27,809
2019 a defender has started snagging my

496
00:17:24,270 --> 00:17:30,059
encoded obvious gated powershell scripts

497
00:17:27,809 --> 00:17:31,800
just normal defender not like server

498
00:17:30,059 --> 00:17:34,020
installations normal defender has begun

499
00:17:31,800 --> 00:17:36,270
snagging those so we either need to do

500
00:17:34,020 --> 00:17:39,660
more office gation use older versions of

501
00:17:36,270 --> 00:17:42,420
powershell or let's talk about windows

502
00:17:39,660 --> 00:17:45,870
expanded attack surface AKA windows

503
00:17:42,420 --> 00:17:46,960
subsystem linux right so it's awesome I

504
00:17:45,870 --> 00:17:48,340
love it

505
00:17:46,960 --> 00:17:50,920
I recently uninstalled it from my

506
00:17:48,340 --> 00:17:52,360
desktop but I loved it so let's get a

507
00:17:50,920 --> 00:17:55,090
reverse shell using Windows so stats on

508
00:17:52,360 --> 00:17:56,979
Linux right so here's my bash reverse

509
00:17:55,090 --> 00:17:58,570
shell from windows subsystem Linux again

510
00:17:56,980 --> 00:18:01,500
it's just an encoded command again right

511
00:17:58,570 --> 00:18:03,730
I tested this both in the clear and

512
00:18:01,500 --> 00:18:06,190
base64-encoded against all the things

513
00:18:03,730 --> 00:18:08,470
that I talked about before but always

514
00:18:06,190 --> 00:18:09,910
encode it again make people work if the

515
00:18:08,470 --> 00:18:11,320
blue team is going to try to find it

516
00:18:09,910 --> 00:18:14,130
make them work at least a little bit

517
00:18:11,320 --> 00:18:17,590
right don't make it that easy for people

518
00:18:14,130 --> 00:18:19,960
so here we go this is really short just

519
00:18:17,590 --> 00:18:21,780
to prove that it works and so you see

520
00:18:19,960 --> 00:18:25,360
I've got my netcat listener waiting and

521
00:18:21,780 --> 00:18:27,550
I ran a macro that just has that power

522
00:18:25,360 --> 00:18:29,469
show and coded inside of it right to

523
00:18:27,550 --> 00:18:30,909
just get a reverse shell using Windows

524
00:18:29,470 --> 00:18:33,780
cestus from the Linux a bash reverse

525
00:18:30,910 --> 00:18:38,110
shell and now I have that reverse shell

526
00:18:33,780 --> 00:18:39,910
very easy it's dead easy so make your

527
00:18:38,110 --> 00:18:42,100
windows subsystem linux attacks a part

528
00:18:39,910 --> 00:18:44,440
of your macro but also think outside of

529
00:18:42,100 --> 00:18:48,300
the box git does anybody ever have to do

530
00:18:44,440 --> 00:18:51,070
anything with developers some people so

531
00:18:48,300 --> 00:18:52,419
lots of developers use git git comes

532
00:18:51,070 --> 00:18:53,919
with the full version of bash shipped

533
00:18:52,420 --> 00:18:56,740
with it it's a wonderful reverse shell

534
00:18:53,920 --> 00:18:58,540
you just call out to the git bash with

535
00:18:56,740 --> 00:19:01,270
the exact same syntax in the clear

536
00:18:58,540 --> 00:19:02,800
nothing's gonna snag it hopefully no one

537
00:19:01,270 --> 00:19:03,940
is watching from the people on the

538
00:19:02,800 --> 00:19:05,350
livestream right that are gonna go

539
00:19:03,940 --> 00:19:07,480
update their virustotal records or

540
00:19:05,350 --> 00:19:08,980
anything but as of when I tested this

541
00:19:07,480 --> 00:19:11,740
it's fine just run it in the clear

542
00:19:08,980 --> 00:19:13,750
nothing gets it so here's my script I'm

543
00:19:11,740 --> 00:19:15,520
just a simple script and so I prefer the

544
00:19:13,750 --> 00:19:16,990
get show over the windows subsystem

545
00:19:15,520 --> 00:19:19,090
linux shell so I just showed a quick

546
00:19:16,990 --> 00:19:21,670
script that I run and every time I run

547
00:19:19,090 --> 00:19:25,149
this script if I'm dealing with people

548
00:19:21,670 --> 00:19:27,130
who have to use Windows right but want

549
00:19:25,150 --> 00:19:29,380
Linux then a lot of them are gonna

550
00:19:27,130 --> 00:19:30,730
install windows subsystem Linux and a

551
00:19:29,380 --> 00:19:32,560
lot of developers are gonna have git

552
00:19:30,730 --> 00:19:36,820
installed and that's the default get

553
00:19:32,560 --> 00:19:38,830
install location C program files get so

554
00:19:36,820 --> 00:19:40,149
you can also bring your own lands so

555
00:19:38,830 --> 00:19:42,370
this is kind of a new movement as well

556
00:19:40,150 --> 00:19:44,800
bring your own land you can install

557
00:19:42,370 --> 00:19:47,770
using power show windows subsystem Linux

558
00:19:44,800 --> 00:19:49,030
in the background so after I gain

559
00:19:47,770 --> 00:19:50,560
presence on the machine I installed

560
00:19:49,030 --> 00:19:53,080
Windows system Linux in the background

561
00:19:50,560 --> 00:19:55,210
and then the next time they reboot I'll

562
00:19:53,080 --> 00:19:56,350
get a reverse shell using bash they

563
00:19:55,210 --> 00:19:57,520
won't even know windows so sips and

564
00:19:56,350 --> 00:19:58,719
Linux is installed unless they go

565
00:19:57,520 --> 00:19:59,350
looking for it cuz it's not going to be

566
00:19:58,720 --> 00:20:00,940
in your face

567
00:19:59,350 --> 00:20:03,820
because just default windows thing now

568
00:20:00,940 --> 00:20:06,100
so bring it with you and get I'm working

569
00:20:03,820 --> 00:20:08,020
on a script that's gonna install git

570
00:20:06,100 --> 00:20:09,820
silently in the background on any

571
00:20:08,020 --> 00:20:11,860
machine so that I can just get a reverse

572
00:20:09,820 --> 00:20:13,480
shut get bring the land with you right

573
00:20:11,860 --> 00:20:15,159
gets a trusted application window so

574
00:20:13,480 --> 00:20:17,800
system Linux is a trusted application

575
00:20:15,160 --> 00:20:22,360
bring that land with you use that land

576
00:20:17,800 --> 00:20:23,980
to live off the land okay Mac OSX um

577
00:20:22,360 --> 00:20:25,389
it's not I mean to fishing why because

578
00:20:23,980 --> 00:20:28,870
fishings a people thing it's not a

579
00:20:25,390 --> 00:20:31,540
system thing right so I sent a Microsoft

580
00:20:28,870 --> 00:20:34,989
Word document with a malicious macro to

581
00:20:31,540 --> 00:20:39,100
an OS X user me and the macro has a

582
00:20:34,990 --> 00:20:41,650
basic bash command there you go that was

583
00:20:39,100 --> 00:20:43,510
it I didn't give you my IP address even

584
00:20:41,650 --> 00:20:47,860
though it's internal because that's the

585
00:20:43,510 --> 00:20:50,260
command so because I can execute bash

586
00:20:47,860 --> 00:20:52,540
commands it's really easy to you to

587
00:20:50,260 --> 00:20:54,220
reverse shell on Mac OS right now I am

588
00:20:52,540 --> 00:20:56,980
gonna be sandboxed right I'm not gonna

589
00:20:54,220 --> 00:20:59,170
talk about sandbox escapes and perfects

590
00:20:56,980 --> 00:21:00,520
Prive s con Mac today there are sandbox

591
00:20:59,170 --> 00:21:01,420
escapes out there you just gotta go look

592
00:21:00,520 --> 00:21:04,629
for him I'm not going to talk about

593
00:21:01,420 --> 00:21:09,730
escaping the sandbox right now so quick

594
00:21:04,630 --> 00:21:12,490
demo of Mac OS so how am I on time okay

595
00:21:09,730 --> 00:21:13,900
so I've got my netcat listener that show

596
00:21:12,490 --> 00:21:16,510
I showed you from from before that

597
00:21:13,900 --> 00:21:18,670
simple bash right simple bash reverse

598
00:21:16,510 --> 00:21:22,360
shell that I've got I now have a reverse

599
00:21:18,670 --> 00:21:25,930
shell on Windows just to prove it there

600
00:21:22,360 --> 00:21:28,919
it is right that's back OS it's not

601
00:21:25,930 --> 00:21:32,110
Linux it's not Windows as Mac OS and

602
00:21:28,920 --> 00:21:35,440
we'll see pythons installed so now I'm

603
00:21:32,110 --> 00:21:37,600
gonna get a full reverse shell and then

604
00:21:35,440 --> 00:21:39,220
I'm gonna look for some other things I'm

605
00:21:37,600 --> 00:21:42,909
gonna look for Perl other things like

606
00:21:39,220 --> 00:21:44,260
that but basically Mac OS X is easy to

607
00:21:42,910 --> 00:21:45,520
fish if you can get the user then you

608
00:21:44,260 --> 00:21:47,530
gotta escape the sandbox and that's no

609
00:21:45,520 --> 00:21:49,030
small task but you can't escape the

610
00:21:47,530 --> 00:21:52,360
sandbox don't let that be a hurdle so

611
00:21:49,030 --> 00:21:54,610
Linux I'm guessing a lot of you guys are

612
00:21:52,360 --> 00:21:56,889
sysadmin x' or guessing some kind of

613
00:21:54,610 --> 00:21:59,050
vein like that so most Linux flavours

614
00:21:56,890 --> 00:22:01,810
come pre-installed with tons of tools

615
00:21:59,050 --> 00:22:04,270
for you to use so can you fish Linux

616
00:22:01,810 --> 00:22:05,889
users yes you can openoffice and

617
00:22:04,270 --> 00:22:07,780
libreoffice allow for macros that have

618
00:22:05,890 --> 00:22:08,920
Python code execution so if they don't

619
00:22:07,780 --> 00:22:11,350
have to throw openoffice and libreoffice

620
00:22:08,920 --> 00:22:12,700
you can fish them we're gonna do

621
00:22:11,350 --> 00:22:14,350
something a little bit different though

622
00:22:12,700 --> 00:22:16,029
we are going to create a github repo

623
00:22:14,350 --> 00:22:17,529
with some code and I got to read this so

624
00:22:16,029 --> 00:22:19,869
I get it right that claims to

625
00:22:17,529 --> 00:22:21,609
centralized dashboard visualizations for

626
00:22:19,869 --> 00:22:23,439
the Splunk aggregation endpoint monitor

627
00:22:21,609 --> 00:22:25,869
you can tell I am NOT a DevOps guy I

628
00:22:23,440 --> 00:22:27,519
just made something up so we're gonna

629
00:22:25,869 --> 00:22:29,678
get some sis admins to install all right

630
00:22:27,519 --> 00:22:31,090
we're gonna say hey this is going to

631
00:22:29,679 --> 00:22:33,609
aggregate and help you visualize all

632
00:22:31,090 --> 00:22:34,840
your data install this thing and we're

633
00:22:33,609 --> 00:22:37,658
gonna tell them they have to sudo it

634
00:22:34,840 --> 00:22:41,168
right because everything has to be run

635
00:22:37,659 --> 00:22:41,590
as a root and then that actually happens

636
00:22:41,169 --> 00:22:44,769
in real life

637
00:22:41,590 --> 00:22:46,779
so I didn't just make that up happens in

638
00:22:44,769 --> 00:22:49,480
real life right people were putting out

639
00:22:46,779 --> 00:22:52,259
malware for Linux disguised as

640
00:22:49,480 --> 00:22:54,970
productivity tools targeting system ins

641
00:22:52,259 --> 00:22:59,950
so it's a believable thing you could do

642
00:22:54,970 --> 00:23:02,889
to people so we are we are going to show

643
00:22:59,950 --> 00:23:06,309
what it looks like in Linux so I've got

644
00:23:02,889 --> 00:23:07,889
my Ubuntu VM right so I'm reading the

645
00:23:06,309 --> 00:23:10,899
read mean because we all do that and

646
00:23:07,889 --> 00:23:16,080
then I run install that Sh and look at

647
00:23:10,899 --> 00:23:16,080
that beautiful reverse shell in Linux so

648
00:23:16,320 --> 00:23:21,759
how do we stop living off the land

649
00:23:18,989 --> 00:23:23,619
hopefully antivirus IDs and IPS gets a

650
00:23:21,759 --> 00:23:25,539
lot better

651
00:23:23,619 --> 00:23:27,009
like I said a non-polluting guy so I

652
00:23:25,539 --> 00:23:28,480
don't have most the answers for you but

653
00:23:27,009 --> 00:23:30,730
what I do have is look for indicators of

654
00:23:28,480 --> 00:23:32,109
compromised right if the person is doing

655
00:23:30,730 --> 00:23:33,340
it is sloppy and doesn't cover their

656
00:23:32,109 --> 00:23:34,509
tracks you're gonna look for indicators

657
00:23:33,340 --> 00:23:35,799
of compromised you're gonna look for

658
00:23:34,509 --> 00:23:37,299
data that's been exfiltrated

659
00:23:35,799 --> 00:23:39,309
you're gonna look for connections that

660
00:23:37,299 --> 00:23:43,149
shouldn't be there those are the ways

661
00:23:39,309 --> 00:23:44,739
you can stop this now the best thing you

662
00:23:43,149 --> 00:23:46,359
can do is hire good incident responders

663
00:23:44,739 --> 00:23:47,980
and operate with lease privilege least

664
00:23:46,359 --> 00:23:49,389
privilege is the best thing you can do

665
00:23:47,980 --> 00:23:51,970
because if I gain access to a machine

666
00:23:49,389 --> 00:23:54,428
but I can't do anything with that access

667
00:23:51,970 --> 00:23:55,899
because I don't have local admin I don't

668
00:23:54,429 --> 00:23:57,789
have any rights and now I have to really

669
00:23:55,899 --> 00:24:00,309
work to prevent your making it difficult

670
00:23:57,789 --> 00:24:02,679
for me so that's what you should your

671
00:24:00,309 --> 00:24:04,928
goal should be run with lease privilege

672
00:24:02,679 --> 00:24:06,639
so that if the machine is compromised

673
00:24:04,929 --> 00:24:10,480
the attacker can't do anything with that

674
00:24:06,639 --> 00:24:15,879
information and here's some of the

675
00:24:10,480 --> 00:24:18,429
things I pull from so Microsoft and

676
00:24:15,879 --> 00:24:20,789
CrowdStrike are both saying that those

677
00:24:18,429 --> 00:24:23,019
are recognized threat vectors and

678
00:24:20,789 --> 00:24:24,759
they're oh and another good thing there

679
00:24:23,019 --> 00:24:26,230
at the bottom is the ultimate app Locker

680
00:24:24,759 --> 00:24:28,299
bypass list so

681
00:24:26,230 --> 00:24:31,150
AppLocker can't save you their AppLocker

682
00:24:28,299 --> 00:24:33,040
bypasses their SMI bypasses indicators

683
00:24:31,150 --> 00:24:35,620
are compromised lease privilege that's

684
00:24:33,040 --> 00:24:39,270
gonna save you I have one minute for

685
00:24:35,620 --> 00:24:43,870
questions anybody have any questions

686
00:24:39,270 --> 00:24:46,030
yeah I'm going to be making it available

687
00:24:43,870 --> 00:24:48,309
I'm going to put it up on my github and

688
00:24:46,030 --> 00:24:49,750
then I will talk to the st. Colin guys

689
00:24:48,309 --> 00:24:52,330
about the best way to get that out to

690
00:24:49,750 --> 00:24:54,840
people but yes I will make my side deck

691
00:24:52,330 --> 00:24:59,490
available after the conference is over

692
00:24:54,840 --> 00:25:05,599
have any more questions all right thanks

693
00:24:59,490 --> 00:25:05,599
[Applause]

