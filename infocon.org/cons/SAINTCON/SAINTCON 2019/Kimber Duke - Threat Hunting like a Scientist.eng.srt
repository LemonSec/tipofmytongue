1
00:00:00,000 --> 00:00:07,859
I'm right here alright it is 1:30 so

2
00:00:05,670 --> 00:00:11,639
welcome to threat hunting like a

3
00:00:07,859 --> 00:00:13,950
scientist my name is Kimberley Duke I'm

4
00:00:11,639 --> 00:00:14,940
currently a security engineer for stage

5
00:00:13,950 --> 00:00:17,960
2 security

6
00:00:14,940 --> 00:00:19,890
I do blue team work or defensive work

7
00:00:17,960 --> 00:00:23,490
mostly worked in defensive and

8
00:00:19,890 --> 00:00:25,260
compliance related roles I enjoy finding

9
00:00:23,490 --> 00:00:27,180
things that are broken and a little bit

10
00:00:25,260 --> 00:00:29,490
of a different way from pen testers so

11
00:00:27,180 --> 00:00:32,030
it's primarily through threat hunting

12
00:00:29,490 --> 00:00:37,110
looking at logs fun things like that

13
00:00:32,030 --> 00:00:38,879
thank you at the end of this talk I hope

14
00:00:37,110 --> 00:00:40,890
to provide you with ideas and

15
00:00:38,879 --> 00:00:42,570
methodology for what's rent hunting

16
00:00:40,890 --> 00:00:44,550
could look like in your enterprise if

17
00:00:42,570 --> 00:00:45,149
you don't do it already even if you do

18
00:00:44,550 --> 00:00:46,828
do it already

19
00:00:45,149 --> 00:00:52,170
maybe this will put some words to a

20
00:00:46,829 --> 00:00:55,500
process that you're currently doing so

21
00:00:52,170 --> 00:00:57,239
what is threat hunting I found this

22
00:00:55,500 --> 00:00:59,579
definition and I really like it too

23
00:00:57,239 --> 00:01:01,739
threat hunt means to proactively search

24
00:00:59,579 --> 00:01:03,510
for malware or attackers that are

25
00:01:01,739 --> 00:01:06,270
lurking in your network and may have

26
00:01:03,510 --> 00:01:10,619
been there for some time so this implies

27
00:01:06,270 --> 00:01:13,289
that you are finding people bad guys

28
00:01:10,619 --> 00:01:16,890
generally threat actors or just people

29
00:01:13,290 --> 00:01:20,159
who are poking at you and this hole has

30
00:01:16,890 --> 00:01:21,780
been open for some time will you always

31
00:01:20,159 --> 00:01:24,000
find a bad guy when you're threatening

32
00:01:21,780 --> 00:01:25,409
no but you'll usually find some

33
00:01:24,000 --> 00:01:29,520
indicator that somebody has at least

34
00:01:25,409 --> 00:01:32,280
attempted to exploit this hole you might

35
00:01:29,520 --> 00:01:34,500
find things such as a test server that

36
00:01:32,280 --> 00:01:35,850
has RDP open to the Internet a business

37
00:01:34,500 --> 00:01:38,600
process that allows for easy

38
00:01:35,850 --> 00:01:41,939
exfiltration of payroll data or a

39
00:01:38,600 --> 00:01:43,350
misconfigured ACL that allows endless

40
00:01:41,939 --> 00:01:46,919
brute-force attempts on your company's

41
00:01:43,350 --> 00:01:48,899
employee portal portal note that threat

42
00:01:46,920 --> 00:01:51,479
hunting usually skips the automation

43
00:01:48,899 --> 00:01:53,850
step so if you can automate something to

44
00:01:51,479 --> 00:01:55,259
block it you're just gonna kind of

45
00:01:53,850 --> 00:01:57,899
ignore that in threat hunting

46
00:01:55,259 --> 00:01:59,310
so somebody visiting malicious URL you

47
00:01:57,899 --> 00:02:03,299
can automate that you can just

48
00:01:59,310 --> 00:02:05,340
automatically block it some firewalls

49
00:02:03,299 --> 00:02:07,409
will automatically shut people off after

50
00:02:05,340 --> 00:02:08,580
a number of brute-force attempts but if

51
00:02:07,409 --> 00:02:10,289
you don't have a rule that protects

52
00:02:08,580 --> 00:02:12,260
against that your throat hunting could

53
00:02:10,288 --> 00:02:15,890
find it so

54
00:02:12,260 --> 00:02:21,319
when I went to research threat hunting I

55
00:02:15,890 --> 00:02:27,589
found there's a lot out there I found

56
00:02:21,319 --> 00:02:29,599
that the average time that a an advanced

57
00:02:27,590 --> 00:02:34,120
persistent threat can lurk in your

58
00:02:29,599 --> 00:02:36,980
network according to IBM is 191 days and

59
00:02:34,120 --> 00:02:39,260
that can cost your business up to seven

60
00:02:36,980 --> 00:02:40,760
million dollars know that this is IBM so

61
00:02:39,260 --> 00:02:42,980
these are like your major enterprises

62
00:02:40,760 --> 00:02:47,209
that are you know definitely affected by

63
00:02:42,980 --> 00:02:49,488
advanced persistent threats there are

64
00:02:47,209 --> 00:02:51,230
many articles out there that will tell

65
00:02:49,489 --> 00:02:52,819
you that's route hunting is an art and

66
00:02:51,230 --> 00:02:54,379
it's just an innate skill that you're

67
00:02:52,819 --> 00:02:56,328
born with and if you're lucky enough to

68
00:02:54,379 --> 00:02:58,220
have this magical threat hunting ability

69
00:02:56,329 --> 00:03:00,140
you're gonna be fine and make millions

70
00:02:58,220 --> 00:03:01,640
of dollars with your excellent skills

71
00:03:00,140 --> 00:03:05,358
but that's not true you could totally

72
00:03:01,640 --> 00:03:08,089
learn how to do it um this little graph

73
00:03:05,359 --> 00:03:10,459
on the right hand side was a survey of

74
00:03:08,090 --> 00:03:12,709
stock analysts for last year by a

75
00:03:10,459 --> 00:03:14,930
company called exa beam and exa beam

76
00:03:12,709 --> 00:03:16,669
found that the stock analysts were most

77
00:03:14,930 --> 00:03:20,480
concerned with their threat hunting

78
00:03:16,669 --> 00:03:22,430
skills so Saki analysts out there know

79
00:03:20,480 --> 00:03:25,220
you're thinking about this and wondering

80
00:03:22,430 --> 00:03:27,139
if you're a hunter or not there are also

81
00:03:25,220 --> 00:03:29,359
many different graphs that you can find

82
00:03:27,139 --> 00:03:33,760
that tell you what to do with vague

83
00:03:29,359 --> 00:03:37,220
things on them such as intelligence and

84
00:03:33,760 --> 00:03:38,870
talent and of training what training do

85
00:03:37,220 --> 00:03:41,660
I need what talent do I need what kind

86
00:03:38,870 --> 00:03:44,480
of intelligence do I need so that all

87
00:03:41,660 --> 00:03:46,489
kinds of just adds up to yikes and a

88
00:03:44,480 --> 00:03:49,369
feeling of just being overwhelmed with

89
00:03:46,489 --> 00:03:50,480
what path to even get started down if

90
00:03:49,370 --> 00:03:56,750
you wanted to implement throughout

91
00:03:50,480 --> 00:04:00,138
hunting in your landscape so here's some

92
00:03:56,750 --> 00:04:04,220
common methods that I have found through

93
00:04:00,139 --> 00:04:08,660
a survey of different company / looking

94
00:04:04,220 --> 00:04:11,090
online my favorite is the teamwork makes

95
00:04:08,660 --> 00:04:15,168
the dream work so this is where your

96
00:04:11,090 --> 00:04:16,728
sock or your security team or any group

97
00:04:15,169 --> 00:04:20,630
of individuals who's interested

98
00:04:16,728 --> 00:04:23,870
gathers up weekly monthly as often as

99
00:04:20,630 --> 00:04:25,300
they can to assess things as a team and

100
00:04:23,870 --> 00:04:27,759
look at some section of

101
00:04:25,300 --> 00:04:30,550
the company and together collectively

102
00:04:27,759 --> 00:04:34,539
figure out what looks weird there is

103
00:04:30,550 --> 00:04:38,199
also the dig up some IOC s aspect

104
00:04:34,539 --> 00:04:40,840
this is indicators of compromise so you

105
00:04:38,199 --> 00:04:43,210
could look through some threat feeds or

106
00:04:40,840 --> 00:04:44,619
you can look at Twitter and you can say

107
00:04:43,210 --> 00:04:47,739
I wonder if that's in my network and

108
00:04:44,620 --> 00:04:50,830
then go looking for it there is also the

109
00:04:47,740 --> 00:04:53,169
the CSO logs in to Splunk for the first

110
00:04:50,830 --> 00:04:55,568
time in six months and looks at a graph

111
00:04:53,169 --> 00:04:59,080
and says that looks weird go find it so

112
00:04:55,569 --> 00:05:00,460
that's another fun aspect of threat

113
00:04:59,080 --> 00:05:02,530
hunting is sometimes you're just told

114
00:05:00,460 --> 00:05:04,810
hey I think this looks weird go hunt it

115
00:05:02,530 --> 00:05:09,190
down that can be a good way to get

116
00:05:04,810 --> 00:05:11,620
started as well but my ultimate favorite

117
00:05:09,190 --> 00:05:16,599
method is the scientific method and that

118
00:05:11,620 --> 00:05:19,120
is what this talk is about so this is

119
00:05:16,599 --> 00:05:20,378
the scientific method it's a great way

120
00:05:19,120 --> 00:05:24,490
to structure your thoughts when your

121
00:05:20,379 --> 00:05:27,879
store threat hunting you can first make

122
00:05:24,490 --> 00:05:30,190
an observation then ask a question form

123
00:05:27,879 --> 00:05:32,440
a hypothesis test your hypothesis and

124
00:05:30,190 --> 00:05:36,099
iterate to make new hypotheses or

125
00:05:32,440 --> 00:05:39,250
processes or predictions chances are you

126
00:05:36,099 --> 00:05:40,810
do this really normally as an analytical

127
00:05:39,250 --> 00:05:42,430
human being we're all in this room we

128
00:05:40,810 --> 00:05:44,080
all love computers we all know tinker

129
00:05:42,430 --> 00:05:45,940
with things so I'm sure you're no

130
00:05:44,080 --> 00:05:49,210
stranger to this process but you

131
00:05:45,940 --> 00:05:50,830
probably rarely put words to it so let

132
00:05:49,210 --> 00:05:53,109
me give you an example of what this

133
00:05:50,830 --> 00:05:54,758
looks like in your natural life so you

134
00:05:53,110 --> 00:05:56,409
wake up in the morning you really want

135
00:05:54,759 --> 00:05:58,300
to check the news on your laptop how

136
00:05:56,409 --> 00:06:01,120
about a bed go let the dog out get your

137
00:05:58,300 --> 00:06:03,729
coffee open your laptop to find it's not

138
00:06:01,120 --> 00:06:06,460
on blank screen dead bar dead battery

139
00:06:03,729 --> 00:06:09,610
you plugged it in last night why isn't

140
00:06:06,460 --> 00:06:12,638
it at 100% so you have a problem let's

141
00:06:09,610 --> 00:06:15,430
apply the scientific method first your

142
00:06:12,639 --> 00:06:18,069
observation laptop is dead second your

143
00:06:15,430 --> 00:06:20,050
question why did this not get charged

144
00:06:18,069 --> 00:06:23,590
last night you think about what you've

145
00:06:20,050 --> 00:06:25,090
observed tested played with pressed all

146
00:06:23,590 --> 00:06:27,039
the buttons nothing's turning on it's

147
00:06:25,090 --> 00:06:29,619
not user error so you offer this

148
00:06:27,039 --> 00:06:32,080
hypothesis to yourself that maybe my

149
00:06:29,620 --> 00:06:35,770
outlet broke somehow kids stuck a crayon

150
00:06:32,080 --> 00:06:38,210
in it something like that so you move

151
00:06:35,770 --> 00:06:39,799
the charger to a different spot

152
00:06:38,210 --> 00:06:43,940
that's testing your hypothesis and

153
00:06:39,800 --> 00:06:45,680
finally the laptop turns on so here at

154
00:06:43,940 --> 00:06:46,460
pathi this has been proven but now you

155
00:06:45,680 --> 00:06:49,099
have a new problem

156
00:06:46,460 --> 00:06:50,930
why isn't that outlet working so you're

157
00:06:49,099 --> 00:06:52,219
gonna keep cycling through figuring out

158
00:06:50,930 --> 00:06:54,020
what the root cause of the problem is

159
00:06:52,220 --> 00:06:55,550
maybe you've been finding a solution to

160
00:06:54,020 --> 00:06:58,120
not having your kids stick crayons in

161
00:06:55,550 --> 00:07:01,370
the outlet anymore little outlet cover

162
00:06:58,120 --> 00:07:02,650
so the scientific process iterating is

163
00:07:01,370 --> 00:07:04,280
what keeps you questioning life

164
00:07:02,650 --> 00:07:07,880
continuing to find out new things

165
00:07:04,280 --> 00:07:10,099
continuing to educate yourself and it

166
00:07:07,880 --> 00:07:12,289
might seem overwhelming because that

167
00:07:10,099 --> 00:07:14,419
presents the theory of thought that

168
00:07:12,289 --> 00:07:16,250
there's always problems happening to

169
00:07:14,419 --> 00:07:17,889
solve and I don't really think that's a

170
00:07:16,250 --> 00:07:20,479
bad thing because it keeps us learning

171
00:07:17,889 --> 00:07:21,860
so it's one of the true benefits of

172
00:07:20,479 --> 00:07:23,659
being a threat hunter or having your

173
00:07:21,860 --> 00:07:25,729
team do a threat hunt is that you'll

174
00:07:23,660 --> 00:07:28,250
become driven by the part by the process

175
00:07:25,729 --> 00:07:30,020
of learning itself which is something

176
00:07:28,250 --> 00:07:31,430
that I think many of us thrive on we're

177
00:07:30,020 --> 00:07:37,758
all here at a conference we all want to

178
00:07:31,430 --> 00:07:43,550
learn more so let's do the first step is

179
00:07:37,759 --> 00:07:44,680
to make an observation and what does

180
00:07:43,550 --> 00:07:47,949
that look like

181
00:07:44,680 --> 00:07:52,159
so in order to make an observation you

182
00:07:47,949 --> 00:07:54,590
have to have normals statistics and

183
00:07:52,159 --> 00:07:56,330
baselines and then have some methods for

184
00:07:54,590 --> 00:07:58,669
figuring out what looks different than

185
00:07:56,330 --> 00:08:00,710
those normals and baselines an

186
00:07:58,669 --> 00:08:02,419
observation is a simple statement which

187
00:08:00,710 --> 00:08:06,049
contains a valuable point of information

188
00:08:02,419 --> 00:08:08,090
to cause inquiry never calf network

189
00:08:06,050 --> 00:08:09,560
traffic might be higher than usual I can

190
00:08:08,090 --> 00:08:13,039
access an internal web site from our

191
00:08:09,560 --> 00:08:15,560
guest Wi-Fi things like that the simpler

192
00:08:13,039 --> 00:08:18,520
you can keep it the better because you

193
00:08:15,560 --> 00:08:21,169
only want to solve one thing at a time

194
00:08:18,520 --> 00:08:23,000
how do you acquire observations um

195
00:08:21,169 --> 00:08:25,370
determine when things are different than

196
00:08:23,000 --> 00:08:28,280
normals like I said one of the things

197
00:08:25,370 --> 00:08:30,380
that determine what normal are in our

198
00:08:28,280 --> 00:08:33,620
organizations are policies procedures

199
00:08:30,380 --> 00:08:35,659
and pretty graphs the three P's so you

200
00:08:33,620 --> 00:08:38,270
might have dashboards up in your sock

201
00:08:35,659 --> 00:08:40,880
that will show you know the peaks and

202
00:08:38,270 --> 00:08:42,439
valleys and you'll get to learn what

203
00:08:40,880 --> 00:08:45,980
your normals are and when a peak is

204
00:08:42,440 --> 00:08:48,740
occurring to make observations you might

205
00:08:45,980 --> 00:08:50,209
go spend some time and helpdesk and find

206
00:08:48,740 --> 00:08:51,080
that they're not asking people for their

207
00:08:50,209 --> 00:08:52,670
dates of birth

208
00:08:51,080 --> 00:08:56,300
setting a password they're not following

209
00:08:52,670 --> 00:08:58,610
procedures you might find that documents

210
00:08:56,300 --> 00:09:00,260
aren't being deleted within six months

211
00:08:58,610 --> 00:09:01,060
when your retention policy says

212
00:09:00,260 --> 00:09:04,910
otherwise

213
00:09:01,060 --> 00:09:09,349
so those are three places to start

214
00:09:04,910 --> 00:09:11,510
making observations second or one of the

215
00:09:09,350 --> 00:09:13,550
places I really like to start is to be a

216
00:09:11,510 --> 00:09:16,850
user if you have different roles in your

217
00:09:13,550 --> 00:09:18,800
organization um how many of those have

218
00:09:16,850 --> 00:09:20,840
you tried have you tried it seeing what

219
00:09:18,800 --> 00:09:23,479
a help desk user can do compared to a

220
00:09:20,840 --> 00:09:25,460
domain admin is it different because

221
00:09:23,480 --> 00:09:27,920
sometimes it's exactly the same thing

222
00:09:25,460 --> 00:09:29,690
though it may have different name have

223
00:09:27,920 --> 00:09:31,760
you tried seeing what someone on your

224
00:09:29,690 --> 00:09:33,950
guest Wi-Fi can do if they wanted to

225
00:09:31,760 --> 00:09:37,490
play around would they be able to you

226
00:09:33,950 --> 00:09:39,890
might be surprised by the results so you

227
00:09:37,490 --> 00:09:40,970
can also be your nightmare user if you

228
00:09:39,890 --> 00:09:42,500
wake up in the middle of the night

229
00:09:40,970 --> 00:09:44,510
stressing that somebody is going to have

230
00:09:42,500 --> 00:09:48,560
a Wi-Fi pineapple how would it affect

231
00:09:44,510 --> 00:09:50,660
your network see what you observe the

232
00:09:48,560 --> 00:09:52,939
other thing that I really enjoy doing is

233
00:09:50,660 --> 00:09:55,339
spending time in other departments when

234
00:09:52,940 --> 00:09:57,260
was the last time you spoke to a non IT

235
00:09:55,340 --> 00:09:58,880
user and asked them about their day or

236
00:09:57,260 --> 00:10:01,610
what their concerns were with their

237
00:09:58,880 --> 00:10:04,160
computers see what you can learn about

238
00:10:01,610 --> 00:10:07,100
procedures of departments of that aren't

239
00:10:04,160 --> 00:10:08,600
IT and then you'll also make some

240
00:10:07,100 --> 00:10:13,520
friends for when you need to gather data

241
00:10:08,600 --> 00:10:17,300
in the future you all you will also find

242
00:10:13,520 --> 00:10:20,630
out many many shenanigans of course that

243
00:10:17,300 --> 00:10:21,770
can be a really fun time so these three

244
00:10:20,630 --> 00:10:23,510
options will give you so many

245
00:10:21,770 --> 00:10:24,530
observations you might be a little

246
00:10:23,510 --> 00:10:28,130
overwhelmed you might be a little

247
00:10:24,530 --> 00:10:29,990
horrified but focus on one tiny part of

248
00:10:28,130 --> 00:10:35,120
what you've seen because we'll expand on

249
00:10:29,990 --> 00:10:42,110
that in the next step so our next step

250
00:10:35,120 --> 00:10:44,630
is to ask a question how do you know if

251
00:10:42,110 --> 00:10:46,700
you're asking the right questions a good

252
00:10:44,630 --> 00:10:49,870
question is answerable testable and

253
00:10:46,700 --> 00:10:52,520
falsifiable it should have some answers

254
00:10:49,870 --> 00:10:54,470
it's like yes or simple yes or no

255
00:10:52,520 --> 00:10:56,689
question is there a user logged into the

256
00:10:54,470 --> 00:10:58,700
machine at that time is it a testable

257
00:10:56,690 --> 00:11:00,680
question meaning is there some sort of

258
00:10:58,700 --> 00:11:01,940
statistical based in curry like what

259
00:11:00,680 --> 00:11:04,760
kind of traffic would cause this

260
00:11:01,940 --> 00:11:07,940
behavior and falsified

261
00:11:04,760 --> 00:11:10,250
so a traffic a scenario that is either

262
00:11:07,940 --> 00:11:11,900
true or false is the user browsing the

263
00:11:10,250 --> 00:11:14,870
Netflix are they staying after their

264
00:11:11,900 --> 00:11:16,640
shift to watch movies driving questions

265
00:11:14,870 --> 00:11:19,010
in a direction that your instincts tell

266
00:11:16,640 --> 00:11:21,980
you because we're all reading the news

267
00:11:19,010 --> 00:11:24,770
we're all up-to-date on what the latest

268
00:11:21,980 --> 00:11:26,600
threats are I would hope so if you know

269
00:11:24,770 --> 00:11:28,250
from your observations that users enjoy

270
00:11:26,600 --> 00:11:30,920
googling for watch free movies online

271
00:11:28,250 --> 00:11:32,780
and clicking the sketchiest results you

272
00:11:30,920 --> 00:11:34,310
might use that information to ask were

273
00:11:32,780 --> 00:11:36,709
they using a legitimate website to

274
00:11:34,310 --> 00:11:38,569
stream data if you find a server that's

275
00:11:36,710 --> 00:11:39,710
unnamed what is this thing doing it

276
00:11:38,570 --> 00:11:43,460
wouldn't necessarily be your question

277
00:11:39,710 --> 00:11:44,870
but because it's not answerable testable

278
00:11:43,460 --> 00:11:47,420
or falsifiable it's just kind of a

279
00:11:44,870 --> 00:11:49,070
really vague question from your

280
00:11:47,420 --> 00:11:50,689
observations about the server you could

281
00:11:49,070 --> 00:11:52,430
totally narrow it down to does the

282
00:11:50,690 --> 00:11:54,080
development team own this server and

283
00:11:52,430 --> 00:11:55,819
that may give you some sense of purpose

284
00:11:54,080 --> 00:11:59,020
for what it's doing or at least someone

285
00:11:55,820 --> 00:12:01,610
to question for the data that you need

286
00:11:59,020 --> 00:12:02,990
goals of your questions multiple

287
00:12:01,610 --> 00:12:05,150
questions you want to make sure to have

288
00:12:02,990 --> 00:12:06,890
a lot of them should be to fix a problem

289
00:12:05,150 --> 00:12:08,810
that you think is there collect good

290
00:12:06,890 --> 00:12:11,240
data or be the change that you want to

291
00:12:08,810 --> 00:12:13,849
see in your security organization so

292
00:12:11,240 --> 00:12:16,190
your goal is not necessarily that the

293
00:12:13,850 --> 00:12:18,440
Koreans are in your servers or any sort

294
00:12:16,190 --> 00:12:20,600
of apt like that that you were reading

295
00:12:18,440 --> 00:12:23,210
about this morning it's that there's a

296
00:12:20,600 --> 00:12:25,550
problem and you want to fix it so that

297
00:12:23,210 --> 00:12:27,500
we got the right questions we can form

298
00:12:25,550 --> 00:12:34,760
the crux of our threat hunt the best

299
00:12:27,500 --> 00:12:37,370
hypothesis when you were in elementary

300
00:12:34,760 --> 00:12:40,370
school middle school you might have done

301
00:12:37,370 --> 00:12:44,240
those science fair projects with the

302
00:12:40,370 --> 00:12:47,480
if-then hypothesis the if I do this then

303
00:12:44,240 --> 00:12:49,130
this will happen so an example if I were

304
00:12:47,480 --> 00:12:51,710
to change the temperature then the water

305
00:12:49,130 --> 00:12:53,390
will take longer debate to boil if I

306
00:12:51,710 --> 00:12:55,820
feed the cat more then it'll get fat

307
00:12:53,390 --> 00:12:58,250
things like that that's the basic four

308
00:12:55,820 --> 00:12:59,630
four hypothesis super simple we're not

309
00:12:58,250 --> 00:13:07,340
gonna go any more complicated than

310
00:12:59,630 --> 00:13:09,020
if-then scenarios so sorry I'm switching

311
00:13:07,340 --> 00:13:12,770
to between two presentations so there's

312
00:13:09,020 --> 00:13:16,430
a little lag time how do i form the best

313
00:13:12,770 --> 00:13:18,529
hypothesis hypothesis is a possible

314
00:13:16,430 --> 00:13:20,479
explanation that we can test

315
00:13:18,529 --> 00:13:23,360
see if it is correct or if we need to

316
00:13:20,480 --> 00:13:26,480
make a new hypothesis so if you follow

317
00:13:23,360 --> 00:13:28,850
the if-then format if part contains the

318
00:13:26,480 --> 00:13:31,310
testable portion and the then portion is

319
00:13:28,850 --> 00:13:32,899
the prediction of the relationship so a

320
00:13:31,310 --> 00:13:35,149
precise of prosthesis will contain both

321
00:13:32,899 --> 00:13:37,970
aspects of that not just the prediction

322
00:13:35,149 --> 00:13:41,029
portion what does that look like based

323
00:13:37,970 --> 00:13:42,980
upon the example of raised network

324
00:13:41,029 --> 00:13:43,999
traffic so more network traffic at a

325
00:13:42,980 --> 00:13:45,649
weird time

326
00:13:43,999 --> 00:13:48,860
it's a strange protocol that you're not

327
00:13:45,649 --> 00:13:50,899
necessarily familiar with is their user

328
00:13:48,860 --> 00:13:53,629
logged in what kind of traffic is it you

329
00:13:50,899 --> 00:13:56,569
can form the hypothesis if the spikes

330
00:13:53,629 --> 00:13:59,180
network traffic contain if the spike

331
00:13:56,569 --> 00:14:01,160
network traffic afterhours contains FTP

332
00:13:59,180 --> 00:14:03,410
traffic then the source computer is

333
00:14:01,160 --> 00:14:05,740
performing an unauthorized file transfer

334
00:14:03,410 --> 00:14:09,170
so the thing that you think is happening

335
00:14:05,740 --> 00:14:14,509
is in the done part and your observation

336
00:14:09,170 --> 00:14:16,189
is your testable part this is where it

337
00:14:14,509 --> 00:14:18,350
gets kind of interesting because you can

338
00:14:16,189 --> 00:14:19,129
go so many different places with it you

339
00:14:18,350 --> 00:14:21,079
could go

340
00:14:19,129 --> 00:14:23,870
what if there's no active logins on the

341
00:14:21,079 --> 00:14:26,420
machine what if the user logs in logged

342
00:14:23,870 --> 00:14:28,370
in is an administrator and what is the

343
00:14:26,420 --> 00:14:30,410
IP address the traffic is going to go is

344
00:14:28,370 --> 00:14:33,379
just a digitalocean instance that we

345
00:14:30,410 --> 00:14:35,120
don't own if your hypothesis makes you

346
00:14:33,379 --> 00:14:38,059
really excited to go down a path you've

347
00:14:35,120 --> 00:14:41,029
definitely found a good one if it scares

348
00:14:38,059 --> 00:14:44,029
you don't be scared you're gonna find it

349
00:14:41,029 --> 00:14:45,290
figured it out it's gonna be okay note

350
00:14:44,029 --> 00:14:48,769
that you want to be able to test your

351
00:14:45,290 --> 00:14:50,930
hypothesis hypothesis could be if we see

352
00:14:48,769 --> 00:14:53,269
DNS queries with large packets two

353
00:14:50,930 --> 00:14:56,689
strange domains apt 32 is in the network

354
00:14:53,269 --> 00:14:59,120
because they use DNS exfiltration but

355
00:14:56,689 --> 00:15:00,139
when you don't even log DNS requests or

356
00:14:59,120 --> 00:15:02,179
where they're coming from or anything

357
00:15:00,139 --> 00:15:04,519
like that you how would you test that

358
00:15:02,179 --> 00:15:06,439
hypothesis so if you don't have that

359
00:15:04,519 --> 00:15:08,600
data you just adjust to something more

360
00:15:06,439 --> 00:15:11,000
testable if we see characteristic

361
00:15:08,600 --> 00:15:12,500
command line behavior then apt 32 is in

362
00:15:11,000 --> 00:15:14,480
the network where it's much better in

363
00:15:12,500 --> 00:15:17,439
this imaginary organization because we

364
00:15:14,480 --> 00:15:20,029
have command line logging so quicker

365
00:15:17,439 --> 00:15:21,459
more effective you don't go down any

366
00:15:20,029 --> 00:15:24,980
paths that you don't need to go down

367
00:15:21,459 --> 00:15:26,689
because the idea that you need to start

368
00:15:24,980 --> 00:15:28,009
implementing something in order to solve

369
00:15:26,689 --> 00:15:30,079
your threat hunt might not necessarily

370
00:15:28,009 --> 00:15:31,550
be what you're in what your organization

371
00:15:30,079 --> 00:15:32,270
needs at this time you might need to

372
00:15:31,550 --> 00:15:36,260
find the quickest

373
00:15:32,270 --> 00:15:38,449
a threat of course your hypothesis can

374
00:15:36,260 --> 00:15:40,460
not follow the if-then format but they

375
00:15:38,450 --> 00:15:42,500
still need to be testable you could

376
00:15:40,460 --> 00:15:44,480
totally do simple predictions like their

377
00:15:42,500 --> 00:15:46,850
raise server CPU cycles is a coin hive

378
00:15:44,480 --> 00:15:50,630
miner and find the code that executes

379
00:15:46,850 --> 00:15:52,220
that sitting on the server but it's just

380
00:15:50,630 --> 00:15:54,880
up to personal preference I think the

381
00:15:52,220 --> 00:15:57,740
if-then format is probably the one that

382
00:15:54,880 --> 00:16:02,510
sounds more professional so that's why I

383
00:15:57,740 --> 00:16:05,960
like it if you are really stumped about

384
00:16:02,510 --> 00:16:08,180
a hypothesis this is a really good

385
00:16:05,960 --> 00:16:10,990
framework I'm sure we've all heard of

386
00:16:08,180 --> 00:16:15,219
they might attack framework along top

387
00:16:10,990 --> 00:16:18,890
one side along the top has the different

388
00:16:15,220 --> 00:16:22,400
phases of an attack and along columns

389
00:16:18,890 --> 00:16:25,310
are the different methods that are in

390
00:16:22,400 --> 00:16:27,560
each category so it gives you a lot of

391
00:16:25,310 --> 00:16:32,300
methodologies to hypothesize about and

392
00:16:27,560 --> 00:16:35,930
it fits in to the extent or mat so if if

393
00:16:32,300 --> 00:16:38,449
a malicious actor has gained initial

394
00:16:35,930 --> 00:16:41,180
access then a user has input information

395
00:16:38,450 --> 00:16:44,090
into a spearfishing link so you can see

396
00:16:41,180 --> 00:16:47,660
that initial access is the leftmost

397
00:16:44,090 --> 00:16:49,670
header and then spearfishing is down in

398
00:16:47,660 --> 00:16:52,610
the column underneath it so it gives you

399
00:16:49,670 --> 00:16:55,400
a ton of combos and iterations to use

400
00:16:52,610 --> 00:16:57,590
when you're trying to try hunt down what

401
00:16:55,400 --> 00:16:58,579
something could possibly be doing so if

402
00:16:57,590 --> 00:17:00,970
you think something might be

403
00:16:58,580 --> 00:17:03,640
exfiltrating how is it exfiltrating it

404
00:17:00,970 --> 00:17:05,990
given the observations that you've made

405
00:17:03,640 --> 00:17:08,690
if you're not familiar with minor attack

406
00:17:05,990 --> 00:17:10,459
it is at attack mightor gorg and I

407
00:17:08,690 --> 00:17:12,290
strongly recommend checking it out to

408
00:17:10,459 --> 00:17:19,550
get familiar with all of those different

409
00:17:12,290 --> 00:17:22,369
methods of scariness so finally after we

410
00:17:19,550 --> 00:17:25,369
formed a hypothesis that we would enjoy

411
00:17:22,369 --> 00:17:27,169
sharing with somebody else and saying

412
00:17:25,369 --> 00:17:32,800
hey I think this thing might might be

413
00:17:27,170 --> 00:17:32,800
happening you can test your hypothesis

414
00:17:34,350 --> 00:17:44,760
technical difficulties guys once I get

415
00:17:37,520 --> 00:17:48,690
so test your hypothesis by going to the

416
00:17:44,760 --> 00:17:50,670
dad of that you need and think of

417
00:17:48,690 --> 00:17:52,560
testing as how do I prove myself right

418
00:17:50,670 --> 00:17:54,660
I've come up with this great hypothesis

419
00:17:52,560 --> 00:17:56,280
I've spent hours observing the help desk

420
00:17:54,660 --> 00:17:57,900
I've looked at logs and now I have a

421
00:17:56,280 --> 00:17:59,490
great hypothesis I really think

422
00:17:57,900 --> 00:18:02,100
something interesting is happening here

423
00:17:59,490 --> 00:18:03,810
so your hypothesis will dictate what

424
00:18:02,100 --> 00:18:06,240
data you need but it's up to you to find

425
00:18:03,810 --> 00:18:07,919
out how to get it given the hypothesis

426
00:18:06,240 --> 00:18:09,780
if a threat actor has gained initial

427
00:18:07,920 --> 00:18:12,360
access then a user has input information

428
00:18:09,780 --> 00:18:14,190
to a spearfishing link I found what data

429
00:18:12,360 --> 00:18:15,629
will you need to prove that correct what

430
00:18:14,190 --> 00:18:16,230
will help you in the quickest way

431
00:18:15,630 --> 00:18:17,970
possible

432
00:18:16,230 --> 00:18:21,000
that you know about existing in your

433
00:18:17,970 --> 00:18:23,010
organization can you determine if a post

434
00:18:21,000 --> 00:18:24,090
request has been made to a website that

435
00:18:23,010 --> 00:18:26,550
would probably be the quickest way to

436
00:18:24,090 --> 00:18:29,000
find out but can you follow web traffic

437
00:18:26,550 --> 00:18:32,820
to determine if any user has been to it

438
00:18:29,000 --> 00:18:34,680
second quickest way the testing process

439
00:18:32,820 --> 00:18:37,080
will make you incredibly familiar with

440
00:18:34,680 --> 00:18:39,260
the data available within a moment's

441
00:18:37,080 --> 00:18:41,699
notice to your security group and

442
00:18:39,260 --> 00:18:43,640
hopefully it will help you find out who

443
00:18:41,700 --> 00:18:46,740
does have access to that data as well

444
00:18:43,640 --> 00:18:48,360
for example if a supply chain attack

445
00:18:46,740 --> 00:18:50,100
occurred wouldn't necessarily be the

446
00:18:48,360 --> 00:18:54,719
security department responding to that

447
00:18:50,100 --> 00:18:57,689
or would you go to the team that would

448
00:18:54,720 --> 00:18:59,270
manage the supply chain and they could

449
00:18:57,690 --> 00:19:01,560
identify the information that you need

450
00:18:59,270 --> 00:19:03,090
threaten hunting is an excellent test of

451
00:19:01,560 --> 00:19:05,220
your ability to be a walking phone book

452
00:19:03,090 --> 00:19:08,340
Wikipedia article helpful know-it-all

453
00:19:05,220 --> 00:19:10,230
fill in the blank you are the one who

454
00:19:08,340 --> 00:19:15,169
holds the key to finding the data the

455
00:19:10,230 --> 00:19:15,170
fastest if you are a threat hunter

456
00:19:16,130 --> 00:19:20,610
finally what if you just tested the

457
00:19:18,390 --> 00:19:22,770
situation in real life what if you

458
00:19:20,610 --> 00:19:24,209
thought a year had a certain piece of

459
00:19:22,770 --> 00:19:26,430
malware on their computer that you

460
00:19:24,210 --> 00:19:28,610
weren't familiar with and you weren't

461
00:19:26,430 --> 00:19:30,870
sure how it acted you weren't sure what

462
00:19:28,610 --> 00:19:34,500
what sort of artifacts it left behind

463
00:19:30,870 --> 00:19:36,419
and you had a copy of the Malheur

464
00:19:34,500 --> 00:19:40,710
because you sandbox everything that your

465
00:19:36,420 --> 00:19:42,840
users run and then you could see what it

466
00:19:40,710 --> 00:19:45,780
was doing for example I was once

467
00:19:42,840 --> 00:19:49,370
presented with a strange URL just hey

468
00:19:45,780 --> 00:19:52,200
check out this URL see what it's doing

469
00:19:49,370 --> 00:19:55,080
observing what it was doing what kind of

470
00:19:52,200 --> 00:19:57,270
network it was on the kind of patterns

471
00:19:55,080 --> 00:19:59,850
during the times of day and it's and how

472
00:19:57,270 --> 00:20:02,280
long it occurred for I came up with the

473
00:19:59,850 --> 00:20:04,830
theory that it was a VPN app that you

474
00:20:02,280 --> 00:20:07,680
install on iOS and I was able to

475
00:20:04,830 --> 00:20:09,929
actually hop on the guest Wi-Fi and test

476
00:20:07,680 --> 00:20:12,090
the app and in blogs we saw the exact

477
00:20:09,930 --> 00:20:13,860
same traffic pattern so I did a little

478
00:20:12,090 --> 00:20:15,889
bit of science and it totally paid off

479
00:20:13,860 --> 00:20:19,679
because now we know what all those

480
00:20:15,890 --> 00:20:21,300
strange logs are don't be afraid to

481
00:20:19,680 --> 00:20:23,640
sandbox your ideas because the worst

482
00:20:21,300 --> 00:20:25,800
thing that you could happen is that you

483
00:20:23,640 --> 00:20:27,840
would be wrong if you think the registry

484
00:20:25,800 --> 00:20:29,760
has been editable ish ously see if you

485
00:20:27,840 --> 00:20:32,280
can reproduce it on the proper equipment

486
00:20:29,760 --> 00:20:35,240
of course you know don't don't do this

487
00:20:32,280 --> 00:20:37,470
on your main machine do it on some VMs

488
00:20:35,240 --> 00:20:39,840
think about it like a scientist and

489
00:20:37,470 --> 00:20:41,190
experiment with your hypothesis to gain

490
00:20:39,840 --> 00:20:42,810
a greater understanding of how threats

491
00:20:41,190 --> 00:20:45,750
on your network can interact with your

492
00:20:42,810 --> 00:20:48,149
network because if you are the one

493
00:20:45,750 --> 00:20:50,910
poking at your network you'll learn to

494
00:20:48,150 --> 00:20:53,670
think like an attacker which a good

495
00:20:50,910 --> 00:20:55,980
defensive team will implement into their

496
00:20:53,670 --> 00:20:58,920
thinking can you poke that machine over

497
00:20:55,980 --> 00:21:00,510
port 3389 from the guest Wi-Fi why not

498
00:20:58,920 --> 00:21:02,460
try it instead of chroming three logs to

499
00:21:00,510 --> 00:21:03,990
prove your point if you are the one who

500
00:21:02,460 --> 00:21:05,670
created the logs those logs will have

501
00:21:03,990 --> 00:21:07,620
greater legitimacy when you're trying to

502
00:21:05,670 --> 00:21:11,160
prove that a bad guy has done the same

503
00:21:07,620 --> 00:21:12,959
thing revise your procedure if need be

504
00:21:11,160 --> 00:21:14,340
in the situation until you feel like you

505
00:21:12,960 --> 00:21:16,110
have a procedure that gives you the data

506
00:21:14,340 --> 00:21:18,300
that you need how do you know if you're

507
00:21:16,110 --> 00:21:21,060
successful in your testing because you

508
00:21:18,300 --> 00:21:22,590
either invoke incident response you find

509
00:21:21,060 --> 00:21:24,629
a thing to fix and present it to the

510
00:21:22,590 --> 00:21:27,899
appropriate team or find that it's a

511
00:21:24,630 --> 00:21:29,670
normal behavior so if you don't find any

512
00:21:27,900 --> 00:21:31,740
of those options if you're still just

513
00:21:29,670 --> 00:21:34,650
kind of questioning you will cycle back

514
00:21:31,740 --> 00:21:36,570
to revising your hypothesis and don't

515
00:21:34,650 --> 00:21:37,920
just give up on it if you found a

516
00:21:36,570 --> 00:21:39,689
strange thing that you felt was worth

517
00:21:37,920 --> 00:21:41,700
your time maybe you just didn't go down

518
00:21:39,690 --> 00:21:43,260
the right path at first but it's okay to

519
00:21:41,700 --> 00:21:45,630
fail and it's okay to not get it right

520
00:21:43,260 --> 00:21:47,160
on the first try because no matter what

521
00:21:45,630 --> 00:21:50,550
you have to make sure to follow the

522
00:21:47,160 --> 00:21:54,650
final step the final step is to iterate

523
00:21:50,550 --> 00:21:54,649
to make new hypotheses or predictions

524
00:21:55,700 --> 00:22:01,260
the process of repeating what you just

525
00:21:58,290 --> 00:22:06,250
did all over again

526
00:22:01,260 --> 00:22:08,260
so this is the whoops refinement of the

527
00:22:06,250 --> 00:22:10,300
scientific process this is what keeps

528
00:22:08,260 --> 00:22:13,660
you learning and this is what determines

529
00:22:10,300 --> 00:22:15,430
if your hunt was successful what

530
00:22:13,660 --> 00:22:18,160
questions did you ask while you were

531
00:22:15,430 --> 00:22:20,680
testing your hypothesis did you find

532
00:22:18,160 --> 00:22:23,230
open holes in your network what did you

533
00:22:20,680 --> 00:22:26,230
learn how curious are you did it give

534
00:22:23,230 --> 00:22:28,780
you some sort of value chances are that

535
00:22:26,230 --> 00:22:30,760
you may not have found something that

536
00:22:28,780 --> 00:22:32,920
turned out to be that interesting you

537
00:22:30,760 --> 00:22:35,740
might have just found that your users

538
00:22:32,920 --> 00:22:37,210
googled for a recipe and went to a

539
00:22:35,740 --> 00:22:39,430
sketchy website and that was the end of

540
00:22:37,210 --> 00:22:43,710
it but it does give you greater insight

541
00:22:39,430 --> 00:22:46,800
to how fast can you solve this issue and

542
00:22:43,710 --> 00:22:51,490
where is the data that solves this issue

543
00:22:46,800 --> 00:22:54,129
so I'll give you another example since I

544
00:22:51,490 --> 00:22:57,220
have a little bit more time of a throw

545
00:22:54,130 --> 00:23:01,030
hunt that I did recently I had a

546
00:22:57,220 --> 00:23:03,220
situation where users there was an alert

547
00:23:01,030 --> 00:23:06,790
that said that there was this vague DNS

548
00:23:03,220 --> 00:23:08,830
request going on and try hunting it down

549
00:23:06,790 --> 00:23:10,659
tried seeing what's happening on these

550
00:23:08,830 --> 00:23:13,629
users computers that's causing a DNS

551
00:23:10,660 --> 00:23:15,820
request and you would think oh maybe

552
00:23:13,630 --> 00:23:17,800
something's installed did all the virus

553
00:23:15,820 --> 00:23:19,870
scans looked at the machines told

554
00:23:17,800 --> 00:23:22,840
helpdesk is anything odd installed on

555
00:23:19,870 --> 00:23:24,939
this kept coming back with noes kept

556
00:23:22,840 --> 00:23:27,189
coming back with failures for way too

557
00:23:24,940 --> 00:23:29,050
long and then I thought well what

558
00:23:27,190 --> 00:23:31,120
websites are these users going to what

559
00:23:29,050 --> 00:23:34,690
are they doing beforehand that I can see

560
00:23:31,120 --> 00:23:37,270
so I went and I looked and they were

561
00:23:34,690 --> 00:23:41,620
googling for an employee login portal

562
00:23:37,270 --> 00:23:44,680
that was the second result on being gave

563
00:23:41,620 --> 00:23:46,479
a link to a malicious PDF and I clicked

564
00:23:44,680 --> 00:23:50,440
on that PDF and got the same exact

565
00:23:46,480 --> 00:23:52,330
traffic pattern of a DNS request but you

566
00:23:50,440 --> 00:23:54,790
had to be in a particular version of

567
00:23:52,330 --> 00:23:57,250
Adobe Acrobat in order to get it so that

568
00:23:54,790 --> 00:23:59,920
one took a lot of working out but it was

569
00:23:57,250 --> 00:24:02,140
so successful once I ate it through all

570
00:23:59,920 --> 00:24:04,240
of those different hypotheses to get to

571
00:24:02,140 --> 00:24:08,140
my final answer of that dang being

572
00:24:04,240 --> 00:24:10,210
resolved never used being users never

573
00:24:08,140 --> 00:24:12,740
used being

574
00:24:10,210 --> 00:24:15,500
so if you're new to the idea of threat

575
00:24:12,740 --> 00:24:17,330
hunting and you're feeling kind of like

576
00:24:15,500 --> 00:24:19,250
I can't do this in my enterprise yet

577
00:24:17,330 --> 00:24:20,570
because I just don't know it well enough

578
00:24:19,250 --> 00:24:22,790
I don't know how everything works

579
00:24:20,570 --> 00:24:24,500
together well enough or if you just want

580
00:24:22,790 --> 00:24:26,120
to do it for funsies practice it in your

581
00:24:24,500 --> 00:24:27,530
home network what is that strange

582
00:24:26,120 --> 00:24:30,260
process in the background all the time

583
00:24:27,530 --> 00:24:32,510
doing if you setup a honeypot what is

584
00:24:30,260 --> 00:24:34,400
the IP that visits every Sunday get

585
00:24:32,510 --> 00:24:37,160
curious and become a person who isn't

586
00:24:34,400 --> 00:24:42,260
afraid to follow their curiosity to find

587
00:24:37,160 --> 00:24:44,480
out answers so to recap make

588
00:24:42,260 --> 00:24:45,940
observations in any way that you can ask

589
00:24:44,480 --> 00:24:48,860
questions about those observations

590
00:24:45,940 --> 00:24:51,080
develop testable hypotheses based upon

591
00:24:48,860 --> 00:24:52,520
those questions and use the answers to

592
00:24:51,080 --> 00:24:55,639
iterate down the paths that make your

593
00:24:52,520 --> 00:24:58,280
organization more secure so thank you

594
00:24:55,640 --> 00:25:01,070
for your time and now go find threats

595
00:24:58,280 --> 00:25:03,980
and if there are any questions I'll hang

596
00:25:01,070 --> 00:25:05,220
out the remainder of the time and that's

597
00:25:03,980 --> 00:25:10,249
it thanks for your time

598
00:25:05,220 --> 00:25:10,249
[Applause]

