1
00:00:03,110 --> 00:00:10,320
all right it's a one o'clock so time to

2
00:00:06,660 --> 00:00:13,620
get started I'm excited to see you all

3
00:00:10,320 --> 00:00:17,160
here I look forward to coming to st. Con

4
00:00:13,620 --> 00:00:20,369
every year this is my fourth or fifth

5
00:00:17,160 --> 00:00:24,029
year coming probably I started out as a

6
00:00:20,369 --> 00:00:25,859
volunteer work in security so I was one

7
00:00:24,029 --> 00:00:27,300
of the ones that stood and made sure you

8
00:00:25,859 --> 00:00:31,980
had your badge when you came through the

9
00:00:27,300 --> 00:00:34,530
lunch line a couple years ago and I

10
00:00:31,980 --> 00:00:37,440
loved it and so I have gotten more

11
00:00:34,530 --> 00:00:39,510
involved since every year I've been

12
00:00:37,440 --> 00:00:43,709
doing Wireshark training now for the

13
00:00:39,510 --> 00:00:48,269
last three years and it's always similar

14
00:00:43,710 --> 00:00:51,110
but always a little different so I'm

15
00:00:48,270 --> 00:00:53,070
excited if you haven't yet downloaded

16
00:00:51,110 --> 00:00:56,190
Wireshark you'll want to download

17
00:00:53,070 --> 00:00:56,850
Wireshark and the capture files that

18
00:00:56,190 --> 00:01:01,440
we'll be using

19
00:00:56,850 --> 00:01:03,420
so the links here are posted and I'll

20
00:01:01,440 --> 00:01:05,990
leave it up for a second I'm just going

21
00:01:03,420 --> 00:01:09,380
to go back to a couple of slides and

22
00:01:05,990 --> 00:01:11,580
then I'll come back to this one so I

23
00:01:09,380 --> 00:01:14,210
can't remember if I already said my name

24
00:01:11,580 --> 00:01:17,869
I don't think I did I'm Kyle fates I

25
00:01:14,210 --> 00:01:21,149
worked at Weber State as a professor in

26
00:01:17,869 --> 00:01:24,330
the School of Computing I love it there

27
00:01:21,150 --> 00:01:27,240
it's great we're hiring we're always

28
00:01:24,330 --> 00:01:35,700
hiring so if you want to try out

29
00:01:27,240 --> 00:01:37,759
academic life come talk to me how many

30
00:01:35,700 --> 00:01:44,189
people still need time to download

31
00:01:37,759 --> 00:01:46,470
Wireshark or the capture files okay so

32
00:01:44,189 --> 00:01:48,360
as we're as you're downloading that let

33
00:01:46,470 --> 00:01:51,270
me talk a little bit about what we will

34
00:01:48,360 --> 00:01:53,820
and won't be doing in this training so

35
00:01:51,270 --> 00:01:56,610
what we won't be doing is any live

36
00:01:53,820 --> 00:02:01,219
capture we will be using existing

37
00:01:56,610 --> 00:02:01,219
capture files to look at and analyze and

38
00:02:01,340 --> 00:02:06,509
there's lots of you know fun and cool

39
00:02:04,079 --> 00:02:09,690
stuff we can do with that live capture

40
00:02:06,509 --> 00:02:12,480
is awesome because you can see exactly

41
00:02:09,690 --> 00:02:13,500
what's on your network but you need to

42
00:02:12,480 --> 00:02:15,480
be aware of where

43
00:02:13,500 --> 00:02:18,840
you're doing live capture and if you

44
00:02:15,480 --> 00:02:20,420
have the permissions there to capture so

45
00:02:18,840 --> 00:02:22,680
it

46
00:02:20,420 --> 00:02:25,679
that's this bullet point here of know

47
00:02:22,680 --> 00:02:28,530
the law and company policy don't just

48
00:02:25,680 --> 00:02:32,580
start capturing traffic on your company

49
00:02:28,530 --> 00:02:35,430
network they might get mad at you but if

50
00:02:32,580 --> 00:02:37,230
if they've assigned you and said hey you

51
00:02:35,430 --> 00:02:39,270
know we need you to look at this then

52
00:02:37,230 --> 00:02:44,399
yeah absolutely Wireshark can be a great

53
00:02:39,270 --> 00:02:45,870
tool for doing that I am going to assume

54
00:02:44,400 --> 00:02:48,270
that you have some knowledge of

55
00:02:45,870 --> 00:02:50,190
networking and networking protocols I'll

56
00:02:48,270 --> 00:02:51,900
still try and touch on the basics so

57
00:02:50,190 --> 00:02:54,090
you're not completely lost if you don't

58
00:02:51,900 --> 00:02:57,360
have a little bit of knowledge on

59
00:02:54,090 --> 00:02:59,910
networking protocols but you certainly

60
00:02:57,360 --> 00:03:02,160
as we sort of go deeper into a protocol

61
00:02:59,910 --> 00:03:06,720
you may start get to get a little lost

62
00:03:02,160 --> 00:03:10,459
and that's okay I was in Troy's talk

63
00:03:06,720 --> 00:03:15,120
earlier this F this morning about

64
00:03:10,459 --> 00:03:17,850
imposter syndrome and how a lot of us

65
00:03:15,120 --> 00:03:20,010
feel inadequate and like we don't belong

66
00:03:17,850 --> 00:03:21,900
and those around us have more knowledge

67
00:03:20,010 --> 00:03:26,820
and I don't want you to feel like that

68
00:03:21,900 --> 00:03:28,680
in here I'm not an expert or maybe I am

69
00:03:26,820 --> 00:03:30,600
an expert but I'm not any more expert

70
00:03:28,680 --> 00:03:32,880
than anyone else here I've just I've

71
00:03:30,600 --> 00:03:34,650
used Wireshark for a lot of years I've

72
00:03:32,880 --> 00:03:37,140
taught Wireshark for a lot of years

73
00:03:34,650 --> 00:03:39,440
so I know quite a bit about it but that

74
00:03:37,140 --> 00:03:43,679
doesn't make me write any more

75
00:03:39,440 --> 00:03:45,989
knowledgeable or capable so keep that in

76
00:03:43,680 --> 00:03:48,180
mind use this as an opportunity to

77
00:03:45,989 --> 00:03:50,190
collaborate and talk and work with one

78
00:03:48,180 --> 00:03:51,780
another that's one of the things I love

79
00:03:50,190 --> 00:03:54,269
about saint con is it's such a great

80
00:03:51,780 --> 00:03:57,989
place to meet people and get new ideas

81
00:03:54,269 --> 00:03:59,430
and find out new ways to do things okay

82
00:03:57,989 --> 00:04:01,410
so how we're doing on getting the

83
00:03:59,430 --> 00:04:09,480
capture files if those downloaded okay

84
00:04:01,410 --> 00:04:11,190
for everyone now all right so even

85
00:04:09,480 --> 00:04:12,929
though I said we're not gonna be doing

86
00:04:11,190 --> 00:04:15,150
any live captures I do want to talk

87
00:04:12,930 --> 00:04:17,040
about it for a minute so that when you

88
00:04:15,150 --> 00:04:18,390
go and try and do a live capture and

89
00:04:17,040 --> 00:04:21,090
you're like why am I not seeing the

90
00:04:18,390 --> 00:04:23,729
traffic that I'm expecting you'll know

91
00:04:21,089 --> 00:04:25,570
why so we'll start out talking a little

92
00:04:23,729 --> 00:04:28,030
bit about that

93
00:04:25,570 --> 00:04:30,250
we'll talk about having a baseline

94
00:04:28,030 --> 00:04:33,099
knowing what your network traffic looks

95
00:04:30,250 --> 00:04:36,100
like under normal circumstances that's

96
00:04:33,100 --> 00:04:38,080
gonna be critical to being able to find

97
00:04:36,100 --> 00:04:41,980
out if something abnormal is happening

98
00:04:38,080 --> 00:04:43,979
if you've got something malicious going

99
00:04:41,980 --> 00:04:46,480
on or if you're just trying to

100
00:04:43,980 --> 00:04:48,490
understand a certain application you've

101
00:04:46,480 --> 00:04:49,750
you know installed some new software and

102
00:04:48,490 --> 00:04:51,490
you want to know what what it's

103
00:04:49,750 --> 00:04:53,830
communicating on the network if you

104
00:04:51,490 --> 00:04:55,960
don't know what your traffic looked like

105
00:04:53,830 --> 00:04:59,409
before that then it's going to be a lot

106
00:04:55,960 --> 00:05:01,419
harder to figure out what's changed so

107
00:04:59,410 --> 00:05:03,220
we want to have a baseline we want to

108
00:05:01,419 --> 00:05:05,020
then talk about finding that needle

109
00:05:03,220 --> 00:05:09,730
finding that piece of information you're

110
00:05:05,020 --> 00:05:11,260
looking for in the flood of data we'll

111
00:05:09,730 --> 00:05:14,110
talk about some of the basic protocols

112
00:05:11,260 --> 00:05:15,430
and interesting things that Wireshark

113
00:05:14,110 --> 00:05:18,640
can help you find with those protocols

114
00:05:15,430 --> 00:05:21,490
and we'll look specifically if we have

115
00:05:18,640 --> 00:05:24,010
time at some different network

116
00:05:21,490 --> 00:05:25,900
reconnaissance scans and how those show

117
00:05:24,010 --> 00:05:27,219
up on your network okay so that's sort

118
00:05:25,900 --> 00:05:32,080
of where we'll be going and talking

119
00:05:27,220 --> 00:05:34,660
about today feel free to bounce in and

120
00:05:32,080 --> 00:05:37,450
out of here it's a two hour session so

121
00:05:34,660 --> 00:05:39,040
if there's a you know talks halfway

122
00:05:37,450 --> 00:05:42,400
through you want to go to I won't be

123
00:05:39,040 --> 00:05:45,789
offended at all I'm just happy to see

124
00:05:42,400 --> 00:05:49,000
you guys here so if this is our

125
00:05:45,789 --> 00:05:51,820
hypothetical network where we've got a

126
00:05:49,000 --> 00:05:55,150
couple different LANs and a wireless LAN

127
00:05:51,820 --> 00:05:57,460
and you know a connection to the rest of

128
00:05:55,150 --> 00:06:00,250
the Internet and we want to capture

129
00:05:57,460 --> 00:06:02,409
traffic on this network the thing we

130
00:06:00,250 --> 00:06:05,530
have to remember is that not every

131
00:06:02,410 --> 00:06:07,450
device sees all of the traffic back in

132
00:06:05,530 --> 00:06:11,049
the good old days when we had hubs

133
00:06:07,450 --> 00:06:12,900
everywhere that that was the case a hub

134
00:06:11,050 --> 00:06:15,610
would send the traffic to everyone and

135
00:06:12,900 --> 00:06:18,789
it was really easy to capture traffic

136
00:06:15,610 --> 00:06:22,450
well now our devices are smarter we have

137
00:06:18,789 --> 00:06:25,180
switches that only route traffic to the

138
00:06:22,450 --> 00:06:29,200
MAC address where that traffic belongs

139
00:06:25,180 --> 00:06:32,169
and so if I'm on this device and 10 and

140
00:06:29,200 --> 00:06:34,539
I'm capturing traffic locally on this n

141
00:06:32,169 --> 00:06:38,289
10 device it's really only going to see

142
00:06:34,539 --> 00:06:41,469
traffic meant for it and it'll see right

143
00:06:38,289 --> 00:06:43,240
any traffic that it's sending as well so

144
00:06:41,469 --> 00:06:45,099
it can still be powerful but it's not

145
00:06:43,240 --> 00:06:50,199
going to be as powerful as if you had a

146
00:06:45,099 --> 00:06:53,169
view of your entire network if it's a

147
00:06:50,199 --> 00:06:58,689
switch if it's just a you know a dumb

148
00:06:53,169 --> 00:07:02,139
switch then you're going to have to

149
00:06:58,689 --> 00:07:05,080
insert a network tap into your line and

150
00:07:02,139 --> 00:07:06,909
to capture traffic that way if it's a

151
00:07:05,080 --> 00:07:09,490
managed switch then a lot of times they

152
00:07:06,909 --> 00:07:10,959
have features available to do port

153
00:07:09,490 --> 00:07:13,029
mirroring where you can say hey

154
00:07:10,959 --> 00:07:15,309
everything that you're seeing on these

155
00:07:13,029 --> 00:07:19,449
ports send out this one port and that's

156
00:07:15,309 --> 00:07:23,499
where you would then capture okay

157
00:07:19,449 --> 00:07:27,360
similarly with your wireless traffic if

158
00:07:23,499 --> 00:07:30,009
you're capturing from a Windows device

159
00:07:27,360 --> 00:07:32,080
you're not going to be able to see the

160
00:07:30,009 --> 00:07:34,509
rest of the wireless traffic the drivers

161
00:07:32,080 --> 00:07:38,139
just don't support it but you can get

162
00:07:34,509 --> 00:07:40,449
drivers you can you capture wirelessly

163
00:07:38,139 --> 00:07:43,719
in what's called promiscuous mode and

164
00:07:40,449 --> 00:07:46,809
see all the wireless traffic around you

165
00:07:43,719 --> 00:07:52,029
I remember the first time I did that I

166
00:07:46,809 --> 00:07:53,979
was in college and you know my professor

167
00:07:52,029 --> 00:07:57,939
was teaching me about this kind of stuff

168
00:07:53,979 --> 00:08:00,959
and I went home and I went home from

169
00:07:57,939 --> 00:08:04,330
college right to my parents house and

170
00:08:00,959 --> 00:08:05,979
back then they had an open wireless

171
00:08:04,330 --> 00:08:09,369
network because that's what lots of

172
00:08:05,979 --> 00:08:11,860
people did and so I fired it up and sure

173
00:08:09,369 --> 00:08:13,839
enough all of the traffic that you know

174
00:08:11,860 --> 00:08:15,819
my parents were my siblings or whatever

175
00:08:13,839 --> 00:08:17,769
for browsing wireless oh he was right

176
00:08:15,819 --> 00:08:20,529
there visible and I was like dad look

177
00:08:17,769 --> 00:08:22,149
this is why you need to put a password

178
00:08:20,529 --> 00:08:25,089
on your network because anyone driving

179
00:08:22,149 --> 00:08:26,740
by your house can see this so it's kind

180
00:08:25,089 --> 00:08:33,698
of eye-opening what you can do with

181
00:08:26,740 --> 00:08:35,799
Wireshark okay so let's talk about our

182
00:08:33,698 --> 00:08:39,669
baseline what is normal traffic

183
00:08:35,799 --> 00:08:41,289
look like there's all kinds of ways you

184
00:08:39,669 --> 00:08:43,990
could describe what normal traffic looks

185
00:08:41,289 --> 00:08:45,699
like you could talk about what protocols

186
00:08:43,990 --> 00:08:47,560
are used and what percentage of your

187
00:08:45,699 --> 00:08:50,410
traffic is those protocols so how much

188
00:08:47,560 --> 00:08:51,550
of your traffic is HTTP traffic or how

189
00:08:50,410 --> 00:08:57,280
much of your traffic

190
00:08:51,550 --> 00:09:00,040
is SSH traffic you could talk about what

191
00:08:57,280 --> 00:09:03,640
hosts are commonly communicating on your

192
00:09:00,040 --> 00:09:05,230
network and host by IP address host by

193
00:09:03,640 --> 00:09:07,510
MAC address so we have all these

194
00:09:05,230 --> 00:09:09,910
different characteristics about our

195
00:09:07,510 --> 00:09:13,510
network and it's going to be specific to

196
00:09:09,910 --> 00:09:16,420
our network I can't take a baseline of

197
00:09:13,510 --> 00:09:18,040
my home network and use that to then

198
00:09:16,420 --> 00:09:20,770
understand what's going on at Weber

199
00:09:18,040 --> 00:09:23,319
State's Network their characteristics

200
00:09:20,770 --> 00:09:25,439
are going to be very different and it

201
00:09:23,320 --> 00:09:28,090
would be the same with any of your

202
00:09:25,440 --> 00:09:30,880
organization's or networks that you're

203
00:09:28,090 --> 00:09:33,520
working on every network is kind of

204
00:09:30,880 --> 00:09:36,070
unique in what kind of devices are on it

205
00:09:33,520 --> 00:09:41,170
what kind of processes and protocols are

206
00:09:36,070 --> 00:09:42,970
being used so I've set up a couple

207
00:09:41,170 --> 00:09:44,020
capture files well a whole bunch of

208
00:09:42,970 --> 00:09:46,680
capture files that you've downloaded

209
00:09:44,020 --> 00:09:54,280
let's go ahead and open one up and see

210
00:09:46,680 --> 00:09:57,760
or take our first look at Wireshark so

211
00:09:54,280 --> 00:10:01,020
I've got Wireshark open if you have the

212
00:09:57,760 --> 00:10:03,360
capture file already downloaded you can

213
00:10:01,020 --> 00:10:06,130
double click on it and a lot of times

214
00:10:03,360 --> 00:10:09,700
the file Association will open it up in

215
00:10:06,130 --> 00:10:21,910
Wireshark but we just want to open the

216
00:10:09,700 --> 00:10:29,349
baseline pcap capture file and you

217
00:10:21,910 --> 00:10:33,139
three different windows or splits of

218
00:10:29,349 --> 00:10:38,199
ways to look at your network traffic so

219
00:10:33,139 --> 00:10:40,429
the first one is our packet list and so

220
00:10:38,199 --> 00:10:45,378
you know here where we have all these

221
00:10:40,429 --> 00:10:46,939
numbers on the side and details and your

222
00:10:45,379 --> 00:10:50,059
list might look a little different than

223
00:10:46,939 --> 00:10:51,559
mine let me actually switch my profile

224
00:10:50,059 --> 00:10:54,348
the default we'll talk about using

225
00:10:51,559 --> 00:10:56,719
profiles in a second now your list shook

226
00:10:54,349 --> 00:10:57,829
should look a little pretty similar

227
00:10:56,720 --> 00:11:01,579
unless you've already made

228
00:10:57,829 --> 00:11:04,368
customizations and so these are the

229
00:11:01,579 --> 00:11:08,858
packets that we were seeing at the time

230
00:11:04,369 --> 00:11:13,339
that I'd created this capture file and

231
00:11:08,859 --> 00:11:15,289
so are as we click on a different packet

232
00:11:13,339 --> 00:11:19,129
in the list you'll notice the other two

233
00:11:15,289 --> 00:11:23,629
views down here change and so the next

234
00:11:19,129 --> 00:11:26,779
view is our packet details and it breaks

235
00:11:23,629 --> 00:11:29,329
it out by protocol and it says okay at

236
00:11:26,779 --> 00:11:31,489
our different layers of our networking

237
00:11:29,329 --> 00:11:34,429
model you know we have our Ethernet

238
00:11:31,489 --> 00:11:36,829
header our ipv4 header our TCP header

239
00:11:34,429 --> 00:11:38,988
and we can break out and look at those

240
00:11:36,829 --> 00:11:40,878
individual pieces and Wireshark

241
00:11:38,989 --> 00:11:46,220
interprets all of those fields for us

242
00:11:40,879 --> 00:11:48,489
and then the third view is the raw data

243
00:11:46,220 --> 00:11:51,649
view right where we have the actual

244
00:11:48,489 --> 00:11:54,289
hexadecimal values on the left and the

245
00:11:51,649 --> 00:11:56,989
ascii interpretation of those values on

246
00:11:54,289 --> 00:11:59,659
the right and so all three of these

247
00:11:56,989 --> 00:12:02,689
views are useful in understanding our

248
00:11:59,659 --> 00:12:05,209
network traffic but what we want to look

249
00:12:02,689 --> 00:12:07,939
at first we're talking about baselining

250
00:12:05,209 --> 00:12:11,768
this traffic is looking at some of the

251
00:12:07,939 --> 00:12:16,129
statistics and so up here in the menu

252
00:12:11,769 --> 00:12:18,649
under our statistics we have all kinds

253
00:12:16,129 --> 00:12:20,449
of different statistics and we'll go

254
00:12:18,649 --> 00:12:22,489
through a few of them but right now

255
00:12:20,449 --> 00:12:30,049
let's just start with the capture files

256
00:12:22,489 --> 00:12:32,689
capture file properties and the

257
00:12:30,049 --> 00:12:35,089
statistics I'm most interested about in

258
00:12:32,689 --> 00:12:37,608
are the ones down here at the bottom

259
00:12:35,089 --> 00:12:47,269
I mean that's probably small it's small

260
00:12:37,609 --> 00:12:50,239
for me is it small for you so we'll use

261
00:12:47,269 --> 00:12:54,949
the magnifying glass sometimes when

262
00:12:50,239 --> 00:12:59,449
things get a little too small so that

263
00:12:54,949 --> 00:13:01,848
hopefully you can still see them all

264
00:12:59,449 --> 00:13:04,189
right so under our statistics we have

265
00:13:01,849 --> 00:13:06,469
statistics about the packets that have

266
00:13:04,189 --> 00:13:08,718
been captured and the packets that are

267
00:13:06,469 --> 00:13:10,759
displayed right now these statistics are

268
00:13:08,719 --> 00:13:16,399
the same because we're displaying all of

269
00:13:10,759 --> 00:13:19,399
our captured packets we can see how long

270
00:13:16,399 --> 00:13:21,529
our capture last lasted for we can see

271
00:13:19,399 --> 00:13:24,079
the average packets per second so that's

272
00:13:21,529 --> 00:13:25,879
our PPS where you can see average packet

273
00:13:24,079 --> 00:13:28,069
size we can see number of bytes average

274
00:13:25,879 --> 00:13:30,079
bytes per second and so this gives us a

275
00:13:28,069 --> 00:13:32,238
feel for how much traffic is on our

276
00:13:30,079 --> 00:13:35,569
network and it's the start of our

277
00:13:32,239 --> 00:13:40,009
baselining process so if we normally

278
00:13:35,569 --> 00:13:42,709
have you know 30,000 bytes per second

279
00:13:40,009 --> 00:13:47,569
flowing on our network and all of a

280
00:13:42,709 --> 00:13:50,689
sudden we see a spike and we're at you

281
00:13:47,569 --> 00:13:52,878
know a hundred thousand bytes per second

282
00:13:50,689 --> 00:13:54,529
that's three times more traffic than we

283
00:13:52,879 --> 00:13:56,089
normally see and we might be going well

284
00:13:54,529 --> 00:13:56,539
what's going on why do we see that much

285
00:13:56,089 --> 00:13:59,719
traffic

286
00:13:56,539 --> 00:14:03,589
oh my daughter's started streaming

287
00:13:59,719 --> 00:14:05,659
Netflix or something right so we just

288
00:14:03,589 --> 00:14:14,650
want to be aware of the the patterns of

289
00:14:05,659 --> 00:14:16,420
what's normal for our network the

290
00:14:14,650 --> 00:14:20,680
their statistics I want to look at right

291
00:14:16,420 --> 00:14:26,410
now is the protocol hierarchy statistics

292
00:14:20,680 --> 00:14:27,910
and so this covers not only what packets

293
00:14:26,410 --> 00:14:29,920
how many packets per second and that

294
00:14:27,910 --> 00:14:33,180
kind of stuff but specifically it breaks

295
00:14:29,920 --> 00:14:37,599
it down by protocol and so you can say

296
00:14:33,180 --> 00:14:40,510
you know how much of my traffic is ipv6

297
00:14:37,600 --> 00:14:42,430
and in this capture it's practically

298
00:14:40,510 --> 00:14:46,330
nothing there were two packets out of

299
00:14:42,430 --> 00:14:51,040
the 300 or 30,000 packets that were ipv6

300
00:14:46,330 --> 00:14:54,190
we can say how much of it was this ipv4

301
00:14:51,040 --> 00:14:56,530
how much of it was TCP and so it gives

302
00:14:54,190 --> 00:15:00,160
us percentages it gives us raw number of

303
00:14:56,530 --> 00:15:04,510
packets and it also gives us some of

304
00:15:00,160 --> 00:15:07,329
those values in terms of packets per

305
00:15:04,510 --> 00:15:10,720
second or in this case you know bits per

306
00:15:07,330 --> 00:15:12,100
second and again this just helps you get

307
00:15:10,720 --> 00:15:13,960
a feel for your network and

308
00:15:12,100 --> 00:15:19,240
understanding what kind of traffic to

309
00:15:13,960 --> 00:15:25,110
expect when you're looking at a

310
00:15:19,240 --> 00:15:27,970
particular capture file okay

311
00:15:25,110 --> 00:15:30,870
so let's go ahead get rid of the

312
00:15:27,970 --> 00:15:30,870
magnifier for now

313
00:15:35,520 --> 00:15:38,730
and I've got two different capture files

314
00:15:37,050 --> 00:15:40,680
here I would recommend pulling them up

315
00:15:38,730 --> 00:15:43,140
side by side open two different

316
00:15:40,680 --> 00:15:45,870
instances of Wireshark and just compare

317
00:15:43,140 --> 00:15:51,830
statistics on them compare the capture

318
00:15:45,870 --> 00:15:54,660
file statistics compare the double-time

319
00:15:51,830 --> 00:15:57,600
capture file statistics and the protocol

320
00:15:54,660 --> 00:15:59,400
hierarchy statistics after you've looked

321
00:15:57,600 --> 00:16:01,380
at them for you know a minute or

322
00:15:59,400 --> 00:16:03,750
whatever then I want you to turn to your

323
00:16:01,380 --> 00:16:05,520
neighbor and talk about what differences

324
00:16:03,750 --> 00:16:07,890
you see and if you think those

325
00:16:05,520 --> 00:16:10,350
differences are significant or if

326
00:16:07,890 --> 00:16:12,150
there's within what you would consider

327
00:16:10,350 --> 00:16:14,220
normal and you would say oh this is

328
00:16:12,150 --> 00:16:17,220
still pretty much the same type of

329
00:16:14,220 --> 00:16:19,500
traffic in the same traffic patterns I'm

330
00:16:17,220 --> 00:16:22,350
seeing okay so let's take a couple

331
00:16:19,500 --> 00:16:24,690
minutes open these two up look at the

332
00:16:22,350 --> 00:16:26,040
statistics and then talk about them with

333
00:16:24,690 --> 00:16:28,260
a neighbor and I'm going to wander

334
00:16:26,040 --> 00:16:31,880
around if you have any questions about

335
00:16:28,260 --> 00:16:31,880
looking at statistics

336
00:22:42,990 --> 00:22:51,940
okay so a couple people have come in

337
00:22:47,730 --> 00:22:55,450
late and so if you need the capture

338
00:22:51,940 --> 00:22:59,530
files here's the link again it's a

339
00:22:55,450 --> 00:23:03,310
career CST birdeye edu slash tilde k

340
00:22:59,530 --> 00:23:06,460
fate / download / saint con captures dot

341
00:23:03,310 --> 00:23:10,389
zip and I'll leave that up as we talk

342
00:23:06,460 --> 00:23:13,510
about what you found so what do you guys

343
00:23:10,390 --> 00:23:16,570
think are these capture files mostly

344
00:23:13,510 --> 00:23:18,460
similar or they're mostly different what

345
00:23:16,570 --> 00:23:31,060
things did you find that we're either

346
00:23:18,460 --> 00:23:33,730
similar or different the total time that

347
00:23:31,060 --> 00:23:36,190
was captured yeah so you don't want to

348
00:23:33,730 --> 00:23:38,410
be looking at just the raw numbers

349
00:23:36,190 --> 00:23:40,930
because one of them's like twice as long

350
00:23:38,410 --> 00:23:43,510
as the other one or something right good

351
00:23:40,930 --> 00:23:46,020
observation what else did you see with

352
00:23:43,510 --> 00:23:46,020
looking at these

353
00:24:09,950 --> 00:24:15,950
okay yeah so even so if you just look at

354
00:24:12,920 --> 00:24:17,570
the broad number of packets that's not a

355
00:24:15,950 --> 00:24:19,280
fair comparison because they're

356
00:24:17,570 --> 00:24:22,399
capturing over different amounts of time

357
00:24:19,280 --> 00:24:25,970
but then if you look at the per second

358
00:24:22,400 --> 00:24:29,330
statistics those now average it out over

359
00:24:25,970 --> 00:24:33,710
time and so what did you see are they

360
00:24:29,330 --> 00:24:38,720
are they similar throughput are they or

361
00:24:33,710 --> 00:24:45,650
are they different in terms of you know

362
00:24:38,720 --> 00:24:51,830
bytes per second let's say double times

363
00:24:45,650 --> 00:24:55,000
higher how much higher almost double the

364
00:24:51,830 --> 00:24:57,830
name gives it away a little bit right so

365
00:24:55,000 --> 00:25:00,830
now the question is would you call it a

366
00:24:57,830 --> 00:25:02,780
significant difference well it depends

367
00:25:00,830 --> 00:25:05,540
on how much fluctuation you would

368
00:25:02,780 --> 00:25:07,639
normally see so even having one capture

369
00:25:05,540 --> 00:25:09,379
file and saying okay this is my baseline

370
00:25:07,640 --> 00:25:10,640
and having another capture file and

371
00:25:09,380 --> 00:25:13,700
saying oh this one's different

372
00:25:10,640 --> 00:25:16,090
well there's going to be differences as

373
00:25:13,700 --> 00:25:19,790
you capture the question is is it

374
00:25:16,090 --> 00:25:22,040
different from normal and you can't know

375
00:25:19,790 --> 00:25:23,899
from just one capture file you can't

376
00:25:22,040 --> 00:25:27,139
really even know from to capture files

377
00:25:23,900 --> 00:25:30,640
you need to be consistently looking at

378
00:25:27,140 --> 00:25:33,980
your network and saying okay you know

379
00:25:30,640 --> 00:25:36,110
during this time of day at this period

380
00:25:33,980 --> 00:25:38,210
this is what traffic typically looks

381
00:25:36,110 --> 00:25:40,040
like to be able to answer

382
00:25:38,210 --> 00:25:43,490
are these really different from one

383
00:25:40,040 --> 00:25:46,240
another so they are absolutely different

384
00:25:43,490 --> 00:25:49,280
in terms of raw numbers the one it has a

385
00:25:46,240 --> 00:25:52,250
close to twice as many packets flowing

386
00:25:49,280 --> 00:25:54,740
per second as the other but it's not so

387
00:25:52,250 --> 00:25:56,840
high that you'd say oh yeah there's

388
00:25:54,740 --> 00:25:59,590
definitely something has changed on my

389
00:25:56,840 --> 00:26:02,860
network alright because it could just be

390
00:25:59,590 --> 00:26:10,730
the flow of traffic that day or whatever

391
00:26:02,860 --> 00:26:11,629
okay so let me in case anyone has not

392
00:26:10,730 --> 00:26:14,930
seen that

393
00:26:11,630 --> 00:26:18,580
so we have our baseline and we'll start

394
00:26:14,930 --> 00:26:18,580
another instance of Wireshark here

395
00:26:21,070 --> 00:26:29,409
and open up the double time that's not

396
00:26:26,660 --> 00:26:29,410
right double time

397
00:26:48,260 --> 00:26:54,420
and what are we doing capture file

398
00:26:51,870 --> 00:27:00,270
properties okay so in my double-time

399
00:26:54,420 --> 00:27:05,040
capture file properties I'm seeing on

400
00:27:00,270 --> 00:27:11,030
average 62 packets per second and an

401
00:27:05,040 --> 00:27:20,940
average packet size of 868 bytes in my

402
00:27:11,030 --> 00:27:24,000
baseline capture file properties I'm at

403
00:27:20,940 --> 00:27:32,400
52 packets per second and an average

404
00:27:24,000 --> 00:27:36,930
packet size of 58 or 588 bytes and then

405
00:27:32,400 --> 00:27:40,700
average bytes 30,000 per second whereas

406
00:27:36,930 --> 00:27:43,980
double time was 53,000 bytes per second

407
00:27:40,700 --> 00:27:46,170
so we have two kind of differences there

408
00:27:43,980 --> 00:27:47,940
one is the number of packets per second

409
00:27:46,170 --> 00:27:51,000
and that's not that different

410
00:27:47,940 --> 00:27:54,300
all right the ones 52 packets per second

411
00:27:51,000 --> 00:27:56,940
the other 62 packets per second but

412
00:27:54,300 --> 00:27:59,370
these packets not only are they they're

413
00:27:56,940 --> 00:28:01,530
more of them but they're also larger so

414
00:27:59,370 --> 00:28:04,580
that our total bytes per second ends up

415
00:28:01,530 --> 00:28:07,980
being you know close to twice as many

416
00:28:04,580 --> 00:28:10,860
30,000 bytes per second versus 53 that

417
00:28:07,980 --> 00:28:12,120
was invites per second okay does

418
00:28:10,860 --> 00:28:19,189
everyone know where I'm getting those

419
00:28:12,120 --> 00:28:19,189
numbers we're good all right

420
00:28:24,320 --> 00:28:29,168
time if you need the link take a picture

421
00:28:26,360 --> 00:28:29,168
because I'm moving on

422
00:28:35,960 --> 00:28:41,960
so we talked about

423
00:28:39,499 --> 00:28:43,820
baselining capturing some basic traffic

424
00:28:41,960 --> 00:28:46,100
getting an understanding of our network

425
00:28:43,820 --> 00:28:48,950
now we're ready to start finding

426
00:28:46,100 --> 00:28:51,549
interesting things finding what's

427
00:28:48,950 --> 00:28:55,119
actually happening on our networks and

428
00:28:51,549 --> 00:28:58,399
Wireshark has a lot of good tools to

429
00:28:55,119 --> 00:29:01,309
help with that and so they have tools to

430
00:28:58,399 --> 00:29:03,709
limit what you capture they have tools

431
00:29:01,309 --> 00:29:05,809
to limit what you see when you're

432
00:29:03,710 --> 00:29:07,879
looking at a capture file and they have

433
00:29:05,809 --> 00:29:11,480
tools to highlight what you're looking

434
00:29:07,879 --> 00:29:13,998
at and so those are our capture filters

435
00:29:11,480 --> 00:29:22,999
our display filters and our color

436
00:29:13,999 --> 00:29:24,830
coloring rules as we use those we'll

437
00:29:22,999 --> 00:29:27,470
have different needs at different times

438
00:29:24,830 --> 00:29:30,049
so sometimes we'll be you know trying to

439
00:29:27,470 --> 00:29:33,049
understand what's going on with our HTTP

440
00:29:30,049 --> 00:29:35,240
traffic and so we'll want a specific set

441
00:29:33,049 --> 00:29:37,158
of coloring rules and capture filters

442
00:29:35,240 --> 00:29:40,220
and display filters for working with our

443
00:29:37,159 --> 00:29:42,549
HTTP protocol but other times we'll be

444
00:29:40,220 --> 00:29:45,559
trying to figure out if we're being

445
00:29:42,549 --> 00:29:48,259
scanned right if someone's doing an nmap

446
00:29:45,559 --> 00:29:49,789
scan on our network or something and so

447
00:29:48,259 --> 00:29:52,220
we need to look at different pieces of

448
00:29:49,789 --> 00:29:54,259
information and rather than trying to

449
00:29:52,220 --> 00:29:56,960
look at different pieces of information

450
00:29:54,259 --> 00:30:01,159
all at the same time we can create

451
00:29:56,960 --> 00:30:04,220
profiles that are custom-built for what

452
00:30:01,159 --> 00:30:07,360
we are currently interested in and so

453
00:30:04,220 --> 00:30:07,360
let's take a look at how to do that

454
00:30:15,380 --> 00:30:21,919
so I'll turn on the magnifying glass

455
00:30:17,570 --> 00:30:26,450
again so you can hopefully see down here

456
00:30:21,919 --> 00:30:29,480
in the bottom right corner is your

457
00:30:26,450 --> 00:30:30,980
currently active profile and if you

458
00:30:29,480 --> 00:30:34,730
haven't changed anything it probably

459
00:30:30,980 --> 00:30:37,340
says default if you just click down

460
00:30:34,730 --> 00:30:40,429
there there will be a couple other

461
00:30:37,340 --> 00:30:42,020
profiles built into Wireshark not as

462
00:30:40,429 --> 00:30:44,799
many as you see on my list right now

463
00:30:42,020 --> 00:30:49,460
because I've already created a bunch of

464
00:30:44,799 --> 00:30:52,610
profiles and you can select any of those

465
00:30:49,460 --> 00:30:55,480
profiles and it changes how things are

466
00:30:52,610 --> 00:30:59,418
displayed it changes what rules you have

467
00:30:55,480 --> 00:31:02,260
active but if instead you right-click

468
00:30:59,419 --> 00:31:05,270
down there then you get the option to

469
00:31:02,260 --> 00:31:08,150
create new profiles and manage your

470
00:31:05,270 --> 00:31:14,240
existing profiles so I'm going to go to

471
00:31:08,150 --> 00:31:19,070
my manage profiles and again now we have

472
00:31:14,240 --> 00:31:21,799
the list of profiles and down in the

473
00:31:19,070 --> 00:31:24,950
left on that box you have options to

474
00:31:21,799 --> 00:31:27,470
create a profile delete a profile or

475
00:31:24,950 --> 00:31:30,350
copy a profile and that's what I like to

476
00:31:27,470 --> 00:31:32,390
do is I like to copy so that I'm working

477
00:31:30,350 --> 00:31:34,820
from a consistent base so I'll usually

478
00:31:32,390 --> 00:31:38,059
copy my default profile which is what

479
00:31:34,820 --> 00:31:41,980
I'll do right now and so we just clicked

480
00:31:38,059 --> 00:31:44,780
a little copy button and then you can

481
00:31:41,980 --> 00:31:46,880
name it you know whatever you want in

482
00:31:44,780 --> 00:31:51,710
this case I'm going to name it my sink

483
00:31:46,880 --> 00:31:53,659
on demo profile and what profiles lets

484
00:31:51,710 --> 00:31:56,750
you do is that lets you make changes to

485
00:31:53,659 --> 00:32:01,880
Wireshark without it having to always be

486
00:31:56,750 --> 00:32:04,520
active and so that I can right now with

487
00:32:01,880 --> 00:32:07,700
my sink on demo profile now anything any

488
00:32:04,520 --> 00:32:09,980
changes that I make if I completely you

489
00:32:07,700 --> 00:32:11,419
know screw things up or add a whole

490
00:32:09,980 --> 00:32:14,539
bunch of columns that I don't really

491
00:32:11,419 --> 00:32:16,520
care about I don't care cuz it's in this

492
00:32:14,539 --> 00:32:20,090
demo profile that I can just delete at

493
00:32:16,520 --> 00:32:21,918
the end or you know never use again or

494
00:32:20,090 --> 00:32:27,049
use it all the time because I found out

495
00:32:21,919 --> 00:32:27,890
it's really awesome so once you got it

496
00:32:27,049 --> 00:32:31,879
created

497
00:32:27,890 --> 00:32:34,640
go ahead and select okay and because we

498
00:32:31,880 --> 00:32:36,890
copied the default profile you nothing

499
00:32:34,640 --> 00:32:39,020
will change we were on the default

500
00:32:36,890 --> 00:32:40,880
profile before now we're on a copy of

501
00:32:39,020 --> 00:32:44,720
the default profile everything should

502
00:32:40,880 --> 00:32:49,670
still be the same so let's make some

503
00:32:44,720 --> 00:32:52,220
changes one of the things you can do

504
00:32:49,670 --> 00:32:55,580
with a profile is you can change which

505
00:32:52,220 --> 00:32:59,000
columns are displayed in your packet

506
00:32:55,580 --> 00:33:03,439
list and so currently it's showing me

507
00:32:59,000 --> 00:33:06,380
the time relative to the start of the

508
00:33:03,440 --> 00:33:09,770
capture file it's showing me the source

509
00:33:06,380 --> 00:33:12,770
IP address of the packet the destination

510
00:33:09,770 --> 00:33:14,809
IP address of the packet which protocol

511
00:33:12,770 --> 00:33:19,400
which application layer protocol is

512
00:33:14,809 --> 00:33:23,240
being used if applicable the length of

513
00:33:19,400 --> 00:33:27,110
the packet and some information we can

514
00:33:23,240 --> 00:33:30,260
add any column we want any field that is

515
00:33:27,110 --> 00:33:35,330
available in our protocol we can have it

516
00:33:30,260 --> 00:33:38,059
display as a column so maybe let's just

517
00:33:35,330 --> 00:33:43,610
click on one of these so I'm on packet

518
00:33:38,059 --> 00:33:50,260
number one if I go to my IP protocol in

519
00:33:43,610 --> 00:33:54,290
my packet details I can see all of the

520
00:33:50,260 --> 00:33:57,520
fields that the IP header has and I can

521
00:33:54,290 --> 00:34:00,230
add any one of those fields as a column

522
00:33:57,520 --> 00:34:05,090
so for example I can take this time to

523
00:34:00,230 --> 00:34:09,310
live field I can right-click on it and I

524
00:34:05,090 --> 00:34:12,109
can apply as column and when I do that

525
00:34:09,310 --> 00:34:15,918
it adds a new column up here to my

526
00:34:12,109 --> 00:34:18,139
display list this is incredibly useful

527
00:34:15,918 --> 00:34:22,069
when you're trying to find that needle

528
00:34:18,139 --> 00:34:23,840
when you are you know working with pick

529
00:34:22,070 --> 00:34:26,929
your favorite problem and you need to

530
00:34:23,840 --> 00:34:29,210
look at a specific value in your packets

531
00:34:26,929 --> 00:34:32,330
you can just add it as a column and then

532
00:34:29,210 --> 00:34:34,940
scroll through and very easily see the

533
00:34:32,330 --> 00:34:39,918
value for every single packet in your

534
00:34:34,940 --> 00:34:41,149
capture file you can sort on these

535
00:34:39,918 --> 00:34:42,649
columns so

536
00:34:41,149 --> 00:34:47,179
I can say you know which packets have

537
00:34:42,649 --> 00:34:49,308
the highest time to live and sort of the

538
00:34:47,179 --> 00:34:52,970
other way so it's shown me highest the

539
00:34:49,309 --> 00:34:55,549
smallest and now I've got a list of

540
00:34:52,969 --> 00:35:00,020
packets sorted by their time to live

541
00:34:55,549 --> 00:35:02,210
field okay so that's one of the things

542
00:35:00,020 --> 00:35:04,430
we can do in terms of finding the needle

543
00:35:02,210 --> 00:35:08,690
we can add columns to make the

544
00:35:04,430 --> 00:35:11,660
information more easily visible another

545
00:35:08,690 --> 00:35:14,000
thing we can do is we can create what

546
00:35:11,660 --> 00:35:17,569
are called display filters display

547
00:35:14,000 --> 00:35:22,279
filters limit which packets are shown in

548
00:35:17,569 --> 00:35:25,490
your packet list so if for example let's

549
00:35:22,279 --> 00:35:28,010
take a look at our protocol hierarchy

550
00:35:25,490 --> 00:35:30,379
again we have all kinds of different

551
00:35:28,010 --> 00:35:34,160
protocols being used and we have some

552
00:35:30,380 --> 00:35:34,609
ipv6 very few we have some ipv4 a whole

553
00:35:34,160 --> 00:35:40,190
bunch

554
00:35:34,609 --> 00:35:44,960
we have SSH you know 4 % of our packets

555
00:35:40,190 --> 00:35:47,299
are SSH we have HTTP 22% of those HTTP

556
00:35:44,960 --> 00:35:49,849
well what if we only wanted to look at a

557
00:35:47,299 --> 00:35:53,538
specific protocol we could create a

558
00:35:49,849 --> 00:35:57,920
filter to do that so which what protocol

559
00:35:53,539 --> 00:36:00,680
do you want to look at SSH ok so I'm

560
00:35:57,920 --> 00:36:06,920
going to come over here to my display

561
00:36:00,680 --> 00:36:10,220
filter and I'm going to type SSH most

562
00:36:06,920 --> 00:36:14,029
protocols can be filtered by their name

563
00:36:10,220 --> 00:36:16,578
in Wireshark there's probably a few

564
00:36:14,029 --> 00:36:19,430
exceptions to that but most of them if

565
00:36:16,579 --> 00:36:22,670
you type in the protocol name as an

566
00:36:19,430 --> 00:36:25,669
abbreviation that will be a valid filter

567
00:36:22,670 --> 00:36:31,309
in Wireshark to then show you only that

568
00:36:25,670 --> 00:36:33,890
type of traffic and so once I do that if

569
00:36:31,309 --> 00:36:37,760
we look through this list you'll now see

570
00:36:33,890 --> 00:36:42,170
every single packet here is using the

571
00:36:37,760 --> 00:36:45,950
SSH protocol now this is a security

572
00:36:42,170 --> 00:36:48,890
conference so I better warn you don't

573
00:36:45,950 --> 00:36:52,848
trust this filter to be showing you all

574
00:36:48,890 --> 00:36:54,500
of your ssh traffic because Wireshark is

575
00:36:52,849 --> 00:36:56,780
not that smart I mean it

576
00:36:54,500 --> 00:37:01,700
really smart and powerful tool but it's

577
00:36:56,780 --> 00:37:04,670
not going to be able to find traffic

578
00:37:01,700 --> 00:37:06,740
that it doesn't know is ssh alright so

579
00:37:04,670 --> 00:37:09,680
how does it know it's ssh it knows by

580
00:37:06,740 --> 00:37:12,770
the port number says oh ssh usually uses

581
00:37:09,680 --> 00:37:15,890
port 22 so fat it's using port 22 i'm

582
00:37:12,770 --> 00:37:19,270
going to call that ssh traffic i think

583
00:37:15,890 --> 00:37:24,109
it has a couple of others we can check

584
00:37:19,270 --> 00:37:29,300
the properties here so on our ssh

585
00:37:24,110 --> 00:37:33,470
protocol and our protocol preferences we

586
00:37:29,300 --> 00:37:38,350
can see which tcp ports it considers to

587
00:37:33,470 --> 00:37:41,540
be ssh traffic and if you click on that

588
00:37:38,350 --> 00:37:44,900
it gives you the list here and currently

589
00:37:41,540 --> 00:37:47,570
it's saying port 22 and port two

590
00:37:44,900 --> 00:37:49,820
thousand or twenty nine thousand four

591
00:37:47,570 --> 00:37:51,830
hundred eight and eighteen if it's using

592
00:37:49,820 --> 00:37:55,340
those ports it'll try and decode it as

593
00:37:51,830 --> 00:37:58,730
ssh so if someone's being sneaky and

594
00:37:55,340 --> 00:38:04,090
running ssh on any other port besides

595
00:37:58,730 --> 00:38:09,860
twenty two or twenty nine thousand 418

596
00:38:04,090 --> 00:38:12,790
this ssh filter won't catch it right so

597
00:38:09,860 --> 00:38:19,370
that's my my warning there is you can't

598
00:38:12,790 --> 00:38:22,190
trust the filter in terms of saying oh

599
00:38:19,370 --> 00:38:24,980
yeah it's got all of my ssh traffic well

600
00:38:22,190 --> 00:38:27,650
it's got all of your ssh traffic using

601
00:38:24,980 --> 00:38:31,280
those ports this gets back to doing a

602
00:38:27,650 --> 00:38:33,590
baseline and knowing if you're running

603
00:38:31,280 --> 00:38:36,080
ssh on the standard port or if you're

604
00:38:33,590 --> 00:38:38,480
using a different port and then

605
00:38:36,080 --> 00:38:41,810
configuring Wireshark appropriately so

606
00:38:38,480 --> 00:38:48,070
if you run Wireshark or if you run SSH

607
00:38:41,810 --> 00:38:52,340
on port 22 22 you can add it to the list

608
00:38:48,070 --> 00:38:56,060
and in this case it probably doesn't

609
00:38:52,340 --> 00:39:00,020
make any difference because I don't have

610
00:38:56,060 --> 00:39:03,170
any ssh traffic on port 22 22 but if we

611
00:39:00,020 --> 00:39:05,350
did it would then get those packets as

612
00:39:03,170 --> 00:39:05,350
well

613
00:39:05,849 --> 00:39:13,979
so that's nice I can create this display

614
00:39:08,309 --> 00:39:16,559
filter but what we want is to make it as

615
00:39:13,979 --> 00:39:18,538
easy as possible to analyze our traffic

616
00:39:16,559 --> 00:39:21,329
and if every time I have to remember

617
00:39:18,539 --> 00:39:23,059
which display filters to type in that's

618
00:39:21,329 --> 00:39:27,209
going to be problematic

619
00:39:23,059 --> 00:39:33,599
so instead Wireshark has these bookmarks

620
00:39:27,209 --> 00:39:36,509
of display filters and you can save any

621
00:39:33,599 --> 00:39:37,890
filter that you type in to a bookmark

622
00:39:36,509 --> 00:39:41,219
and it saves it

623
00:39:37,890 --> 00:39:43,828
to the active profile so as you switch

624
00:39:41,219 --> 00:39:48,660
profiles you can change which display

625
00:39:43,829 --> 00:39:51,779
filters you have saved that then you

626
00:39:48,660 --> 00:39:55,129
have quick access to again because we

627
00:39:51,779 --> 00:40:00,269
copied our default profile we have some

628
00:39:55,130 --> 00:40:08,369
filters already here created I think let

629
00:40:00,269 --> 00:40:11,508
me whoops oh it's because what a

630
00:40:08,369 --> 00:40:11,509
magnifier was doing

631
00:40:52,970 --> 00:41:01,080
where's our here we go so here's some

632
00:40:57,270 --> 00:41:03,900
questions for you to try and answer and

633
00:41:01,080 --> 00:41:07,799
as you answer these think about you know

634
00:41:03,900 --> 00:41:10,320
using display filters to narrow down

635
00:41:07,800 --> 00:41:13,400
what traffic you're looking at and then

636
00:41:10,320 --> 00:41:17,550
save those display filters to your

637
00:41:13,400 --> 00:41:24,150
bookmark and similarly if you need to

638
00:41:17,550 --> 00:41:28,220
add any columns to your packet list I

639
00:41:24,150 --> 00:41:32,430
add those and let's look at the baseline

640
00:41:28,220 --> 00:41:37,259
capture file and take five minutes or so

641
00:41:32,430 --> 00:41:42,359
and figure out which hosts by IP address

642
00:41:37,260 --> 00:41:45,830
is acting as an ssh server what are all

643
00:41:42,360 --> 00:41:49,440
of the UDP protocols that are used and

644
00:41:45,830 --> 00:41:52,710
then which IP address is associated with

645
00:41:49,440 --> 00:41:56,100
a MAC address and in this case I haven't

646
00:41:52,710 --> 00:41:58,590
given a specific MAC address instead you

647
00:41:56,100 --> 00:42:01,319
know we'll look at several alright so

648
00:41:58,590 --> 00:42:05,220
just make a list of all this IP address

649
00:42:01,320 --> 00:42:07,080
is associated with this MAC address okay

650
00:42:05,220 --> 00:42:09,299
and if any of these questions you like

651
00:42:07,080 --> 00:42:12,270
oh I don't even know what that's asking

652
00:42:09,300 --> 00:42:15,600
as I walk around ask for a clarification

653
00:42:12,270 --> 00:42:19,040
and if we need to we can clarify with

654
00:42:15,600 --> 00:42:19,040
everyone - okay

655
00:52:21,040 --> 00:52:25,210
okay so let's take a look and see what

656
00:52:23,350 --> 00:52:27,430
we found

657
00:52:25,210 --> 00:52:29,710
I'm gonna leave it like this first and

658
00:52:27,430 --> 00:52:32,620
then I can demo as we need so for the

659
00:52:29,710 --> 00:52:34,540
first question which host is an ssh

660
00:52:32,620 --> 00:52:40,839
server what

661
00:52:34,540 --> 00:52:43,390
so by IP address what did you find I'm

662
00:52:40,840 --> 00:52:47,590
hearing lots but I can't pick out what

663
00:52:43,390 --> 00:52:50,319
you're saying 3.1 ok

664
00:52:47,590 --> 00:52:52,800
who said that there you go how did you

665
00:52:50,320 --> 00:52:52,800
find that out

666
00:53:34,039 --> 00:53:44,329
okay so let me pull up here and see if

667
00:53:39,119 --> 00:53:44,329
we can sort of replicate your process so

668
00:53:47,150 --> 00:53:56,819
I'll turn the magnifier back on so the

669
00:53:53,910 --> 00:53:59,720
first thing is to just look at our ssh

670
00:53:56,819 --> 00:53:59,720
traffic right

671
00:54:19,260 --> 00:54:27,380
yep know that that's a perfect approach

672
00:54:23,280 --> 00:54:31,350
is to to match up right that info column

673
00:54:27,380 --> 00:54:33,180
and then look over at your IP addresses

674
00:54:31,350 --> 00:54:36,470
and match them up that way

675
00:54:33,180 --> 00:54:40,919
yeah that's perfectly valid approach

676
00:54:36,470 --> 00:54:44,520
okay so we're filtering by SSH so that

677
00:54:40,920 --> 00:54:46,580
we sort of start to drill down and just

678
00:54:44,520 --> 00:54:51,270
look at the traffic that we care about

679
00:54:46,580 --> 00:54:52,920
as we do that here's where there's like

680
00:54:51,270 --> 00:54:55,109
probably a hundred different ways you

681
00:54:52,920 --> 00:54:56,910
could solve this problem so one way was

682
00:54:55,109 --> 00:54:59,880
saying you can look over here in the

683
00:54:56,910 --> 00:55:03,210
info column and it tells you which

684
00:54:59,880 --> 00:55:05,970
packets are server packets and which

685
00:55:03,210 --> 00:55:08,100
packets are client packets and so you

686
00:55:05,970 --> 00:55:09,629
can you know scroll through that and you

687
00:55:08,100 --> 00:55:12,839
can see all these packets that are

688
00:55:09,630 --> 00:55:16,320
server packets and you can look over at

689
00:55:12,840 --> 00:55:20,869
the source IP address right who sent

690
00:55:16,320 --> 00:55:27,030
that server packet and it's the 3.1

691
00:55:20,869 --> 00:55:30,390
address now one of the things that I

692
00:55:27,030 --> 00:55:34,950
love about Wireshark is with its display

693
00:55:30,390 --> 00:55:37,859
filters there's thousands upon thousands

694
00:55:34,950 --> 00:55:41,160
of possible filters things that you can

695
00:55:37,859 --> 00:55:44,549
filter on and so I don't remember all of

696
00:55:41,160 --> 00:55:47,100
the exact syntax of how to filter on any

697
00:55:44,550 --> 00:55:49,619
specific column or value but I don't

698
00:55:47,100 --> 00:55:52,950
have to remember because Wireshark makes

699
00:55:49,619 --> 00:55:57,900
it really easy if I want to filter and

700
00:55:52,950 --> 00:56:00,960
say show me the packets where the 3.1

701
00:55:57,900 --> 00:56:03,210
address is the source that one is

702
00:56:00,960 --> 00:56:06,030
actually pretty common so I do just

703
00:56:03,210 --> 00:56:10,340
remember that and I can type it in and

704
00:56:06,030 --> 00:56:17,010
say so I want SSH and I want I P dot

705
00:56:10,340 --> 00:56:20,760
source SRC double equal sign for a

706
00:56:17,010 --> 00:56:25,190
comparison and then the address 192 dot

707
00:56:20,760 --> 00:56:25,190
one sixty eight dot 3.1

708
00:56:26,190 --> 00:56:35,520
and what this does is it lets me sort of

709
00:56:32,460 --> 00:56:39,240
double-check my process and say okay

710
00:56:35,520 --> 00:56:41,790
anytime 3.1 sending packets if I look

711
00:56:39,240 --> 00:56:47,160
over here in the info it's always

712
00:56:41,790 --> 00:56:49,650
sending server packets okay but if I

713
00:56:47,160 --> 00:56:54,990
didn't know that or if I didn't remember

714
00:56:49,650 --> 00:56:59,730
that I can also so I'm gonna go back to

715
00:56:54,990 --> 00:57:05,370
just SSH as my filter I can find any

716
00:56:59,730 --> 00:57:08,010
field in my detail list and I can

717
00:57:05,370 --> 00:57:11,339
right-click on it so I can find my

718
00:57:08,010 --> 00:57:13,710
source IP field I can right-click on it

719
00:57:11,340 --> 00:57:16,320
and I can choose to apply that as a

720
00:57:13,710 --> 00:57:18,780
filter and so I don't have to know how

721
00:57:16,320 --> 00:57:22,080
to what the syntax for the filter is if

722
00:57:18,780 --> 00:57:23,970
I can find an example of it in my detail

723
00:57:22,080 --> 00:57:26,130
list because then I can just right-click

724
00:57:23,970 --> 00:57:27,120
on it and say hey I want to find values

725
00:57:26,130 --> 00:57:31,290
that look like this

726
00:57:27,120 --> 00:57:34,410
so I want to don't find ones where it

727
00:57:31,290 --> 00:57:38,970
has this IP address selected or where

728
00:57:34,410 --> 00:57:41,310
it's not this IP address selected and we

729
00:57:38,970 --> 00:57:44,009
can combine it with what we have already

730
00:57:41,310 --> 00:57:47,790
we can say take what I have and add to

731
00:57:44,010 --> 00:57:53,460
it and this has to be selected or this

732
00:57:47,790 --> 00:57:56,190
has to be selected okay whoops and I

733
00:57:53,460 --> 00:58:00,300
chose the wrong one I chose selected I

734
00:57:56,190 --> 00:58:02,400
got rid of my SSH but you can see right

735
00:58:00,300 --> 00:58:03,720
then it builds that filter for you you

736
00:58:02,400 --> 00:58:06,590
don't have to type it in and you don't

737
00:58:03,720 --> 00:58:09,359
have to know the exact syntax for

738
00:58:06,590 --> 00:58:11,420
filtering on all the thousands of

739
00:58:09,360 --> 00:58:15,120
possible fields that you can filter on

740
00:58:11,420 --> 00:58:21,530
okay are we good on that question ready

741
00:58:15,120 --> 00:58:26,700
to go to the next so our next question

742
00:58:21,530 --> 00:58:32,930
was what UDP protocols are used in this

743
00:58:26,700 --> 00:58:32,930
capture file what'd you guys find

744
00:58:33,680 --> 00:58:58,069
G&S dhcp mdns anything else ok how did

745
00:58:45,079 --> 00:59:02,500
you guys find those ok perfect so you

746
00:58:58,069 --> 00:59:05,990
can apply a filter for only UDP traffic

747
00:59:02,500 --> 00:59:09,109
you can go into the protocol hierarchy

748
00:59:05,990 --> 00:59:12,950
statistics which we saw previously and

749
00:59:09,109 --> 00:59:14,660
you'll notice down here at the bottom it

750
00:59:12,950 --> 00:59:18,558
tells you that you have an active

751
00:59:14,660 --> 00:59:21,890
display filter and these protocol

752
00:59:18,559 --> 00:59:31,490
statistics are based on that display

753
00:59:21,890 --> 00:59:38,000
filter so now that should be a hundred

754
00:59:31,490 --> 00:59:41,209
percent if it's UDP oh yeah it is 100

755
00:59:38,000 --> 00:59:48,170
percent but it two of our our 0.2% is

756
00:59:41,210 --> 00:59:50,359
UDP on ipv6 so we can see a list of all

757
00:59:48,170 --> 00:59:53,529
the protocols being used and it's the

758
00:59:50,359 --> 00:59:59,619
exact three that you guys mentioned DNS

759
00:59:53,529 --> 01:00:02,089
DHCP and mdns ok some of the other

760
00:59:59,619 --> 01:00:04,490
statistics let's look at some of those

761
01:00:02,089 --> 01:00:06,009
because I said we would this is a good

762
01:00:04,490 --> 01:00:09,140
time as any

763
01:00:06,010 --> 01:00:12,760
so you have these conversation and

764
01:00:09,140 --> 01:00:16,160
endpoint statistics they let you look at

765
01:00:12,760 --> 01:00:19,160
endpoints looks at either MAC address in

766
01:00:16,160 --> 01:00:22,129
points or IP address in points or port

767
01:00:19,160 --> 01:00:24,980
number endpoints and conversations is

768
01:00:22,130 --> 01:00:27,529
very similar but it looks at pairs so it

769
01:00:24,980 --> 01:00:29,210
says not just the end point but the two

770
01:00:27,529 --> 01:00:30,890
end points together right you have that

771
01:00:29,210 --> 01:00:32,869
conversation back and forth there's

772
01:00:30,890 --> 01:00:34,970
always a source and destination there

773
01:00:32,869 --> 01:00:38,020
both end points and when you put them

774
01:00:34,970 --> 01:00:44,470
together then they become a conversation

775
01:00:38,020 --> 01:00:47,420
so both of these statistics instead of

776
01:00:44,470 --> 01:00:50,660
showing always what's

777
01:00:47,420 --> 01:00:54,200
displayed or always all of the packets

778
01:00:50,660 --> 01:00:57,470
it has an option by default it's going

779
01:00:54,200 --> 01:00:59,450
to show you what am I on conversations

780
01:00:57,470 --> 01:01:02,180
it's going to show you the conversations

781
01:00:59,450 --> 01:01:03,890
in your entire capture file even if

782
01:01:02,180 --> 01:01:06,049
they're not displayed so even if you've

783
01:01:03,890 --> 01:01:09,170
applied a filter it's still showing you

784
01:01:06,049 --> 01:01:12,250
all of the conversations here but it has

785
01:01:09,170 --> 01:01:18,790
this checkbox option to say actually

786
01:01:12,250 --> 01:01:21,710
only show me the display filter

787
01:01:18,790 --> 01:01:25,130
conversations and you'll notice when I

788
01:01:21,710 --> 01:01:27,890
did that I'm currently on the TCP tab of

789
01:01:25,130 --> 01:01:31,160
my conversations and there's no longer

790
01:01:27,890 --> 01:01:36,348
any conversations listed because I've

791
01:01:31,160 --> 01:01:42,649
filtered to UDP traffic on my UDP tab I

792
01:01:36,349 --> 01:01:44,299
still have of those UDP conversations so

793
01:01:42,650 --> 01:01:47,960
that's pretty common

794
01:01:44,299 --> 01:01:52,880
most of the different statistics windows

795
01:01:47,960 --> 01:01:56,000
will either filter by your display

796
01:01:52,880 --> 01:02:03,740
filter or have the option to filter by

797
01:01:56,000 --> 01:02:06,500
your display filter okay

798
01:02:03,740 --> 01:02:09,890
the final question which IP address is

799
01:02:06,500 --> 01:02:15,290
associated with a given MAC address so

800
01:02:09,890 --> 01:02:25,779
let me pull out a MAC address here so if

801
01:02:15,290 --> 01:02:25,779
I have MAC address where's mine

802
01:02:31,920 --> 01:02:41,529
zero eight zero zero two seven nine CEA

803
01:02:36,539 --> 01:02:43,900
71 that's my MAC address I want to know

804
01:02:41,529 --> 01:02:50,559
what IP address is associated with that

805
01:02:43,900 --> 01:02:53,039
MAC address what do you find or how do I

806
01:02:50,559 --> 01:02:53,039
find that

807
01:03:00,430 --> 01:03:13,109
what's that I heard it from this side of

808
01:03:04,450 --> 01:03:13,109
the room speak up now what's over here

809
01:03:14,040 --> 01:03:17,610
apply is filter

810
01:03:26,760 --> 01:03:42,860
okay yeah so if I filter on this MAC

811
01:03:37,290 --> 01:03:46,650
address that I'm looking for so now my

812
01:03:42,860 --> 01:03:51,930
source address right MAC address is your

813
01:03:46,650 --> 01:03:57,480
right 0:02 790 ei 71 alright that's the

814
01:03:51,930 --> 01:04:04,379
source if I look at the source IP

815
01:03:57,480 --> 01:04:09,180
address I actually see several IP

816
01:04:04,380 --> 01:04:15,600
addresses that show up with that source

817
01:04:09,180 --> 01:04:17,580
MAC address now that's ok as long as I

818
01:04:15,600 --> 01:04:19,589
have an understanding of my network

819
01:04:17,580 --> 01:04:21,540
protocols and this is where like I said

820
01:04:19,590 --> 01:04:23,400
you don't have to have a great

821
01:04:21,540 --> 01:04:26,100
understanding for a lot of this but to

822
01:04:23,400 --> 01:04:30,090
start going into some of the details we

823
01:04:26,100 --> 01:04:34,170
need to understand our protocols so IP

824
01:04:30,090 --> 01:04:37,080
address MAC address they serve different

825
01:04:34,170 --> 01:04:40,320
roles the role of your IP address is to

826
01:04:37,080 --> 01:04:44,580
identify the device on your entire

827
01:04:40,320 --> 01:04:47,790
network and so we have the IP address if

828
01:04:44,580 --> 01:04:50,430
it's a public IP address it's valid

829
01:04:47,790 --> 01:04:52,860
anywhere no matter where you are that IP

830
01:04:50,430 --> 01:04:56,399
address identifies your device and

831
01:04:52,860 --> 01:04:59,730
whether you're talking to it here at st.

832
01:04:56,400 --> 01:05:02,370
Conn or you're talking to it in China or

833
01:04:59,730 --> 01:05:04,380
you're talking to it at Weber at that

834
01:05:02,370 --> 01:05:07,650
public IP address identifies the

835
01:05:04,380 --> 01:05:11,070
location of your device the MAC address

836
01:05:07,650 --> 01:05:16,320
is different the MAC address is only

837
01:05:11,070 --> 01:05:19,770
valid on your local link network it's a

838
01:05:16,320 --> 01:05:24,380
layer 2 protocol and so it identifies

839
01:05:19,770 --> 01:05:28,830
the device for your link local network

840
01:05:24,380 --> 01:05:32,880
what that means is that in the in this

841
01:05:28,830 --> 01:05:37,140
particular case this MAC address serves

842
01:05:32,880 --> 01:05:39,690
as the next step along the way for a

843
01:05:37,140 --> 01:05:40,509
whole bunch of IP addresses but this is

844
01:05:39,690 --> 01:05:44,500
the Makah dry

845
01:05:40,510 --> 01:05:49,330
of the router in our capture scenario

846
01:05:44,500 --> 01:05:52,030
and so anything that's going to that to

847
01:05:49,330 --> 01:05:55,840
the router itself or out to the Internet

848
01:05:52,030 --> 01:05:58,810
is going to use the MAC address of the

849
01:05:55,840 --> 01:06:00,490
router to get it to that one step right

850
01:05:58,810 --> 01:06:02,350
and then the router says okay what's the

851
01:06:00,490 --> 01:06:05,560
IP address where's the next step along

852
01:06:02,350 --> 01:06:07,960
the way it routes the packet so they

853
01:06:05,560 --> 01:06:09,580
said this MAC address right will show up

854
01:06:07,960 --> 01:06:14,170
with a whole bunch of different IP

855
01:06:09,580 --> 01:06:27,390
addresses let's try the other one right

856
01:06:14,170 --> 01:06:30,910
so our 8 0 27 37 to see 0 6 address and

857
01:06:27,390 --> 01:06:33,370
so right now we're using destination

858
01:06:30,910 --> 01:06:37,569
when it's a destination and if we look

859
01:06:33,370 --> 01:06:41,190
at the destination IP address here it's

860
01:06:37,570 --> 01:06:46,540
always the same it's always the 112

861
01:06:41,190 --> 01:06:49,270
address ok and so we can see oh our 112

862
01:06:46,540 --> 01:06:52,660
address is associated with this MAC

863
01:06:49,270 --> 01:06:56,230
address all right that's one way to

864
01:06:52,660 --> 01:06:58,450
answer this question how else what other

865
01:06:56,230 --> 01:07:05,710
ways did people attempt to answer this

866
01:06:58,450 --> 01:07:08,129
question okay look at the IP packet and

867
01:07:05,710 --> 01:07:08,130
do what

868
01:07:13,450 --> 01:07:22,810
okay so let's make it really easy to do

869
01:07:18,890 --> 01:07:26,990
that we already have our IP address as a

870
01:07:22,810 --> 01:07:29,180
column let's add our MAC address as a

871
01:07:26,990 --> 01:07:32,859
column right so when we can do that

872
01:07:29,180 --> 01:07:38,330
side-by-side comparison so I'm going to

873
01:07:32,860 --> 01:07:40,700
under my Ethernet details instead of

874
01:07:38,330 --> 01:07:44,120
applying this as a filter I'm going to

875
01:07:40,700 --> 01:07:47,210
apply it as a column and then I'm going

876
01:07:44,120 --> 01:07:56,900
to put it right over here next to my

877
01:07:47,210 --> 01:08:06,170
destination IP address and clear out my

878
01:07:56,900 --> 01:08:10,880
filter so we can see different ones and

879
01:08:06,170 --> 01:08:13,730
now we can answer that question for any

880
01:08:10,880 --> 01:08:16,089
pair that shows up as a destination and

881
01:08:13,730 --> 01:08:20,960
we can see when it's a destination

882
01:08:16,089 --> 01:08:23,750
though one thirteen address uses the 71

883
01:08:20,960 --> 01:08:29,210
MAC address the 112 address uses the O

884
01:08:23,750 --> 01:08:34,220
six MAC address the thirty-four address

885
01:08:29,210 --> 01:08:37,010
uses the a eight MAC address okay and so

886
01:08:34,220 --> 01:08:40,900
by adding that column it makes it a lot

887
01:08:37,010 --> 01:08:40,900
easier to visualize that information

888
01:08:41,290 --> 01:08:49,479
okay did anyone try and use the ARP

889
01:08:46,670 --> 01:08:49,480
protocol

890
01:08:50,140 --> 01:09:02,950
all right were you successful okay tell

891
01:09:00,080 --> 01:09:02,950
us what you did

892
01:09:19,279 --> 01:09:26,729
perfect so if you couldn't hear he's

893
01:09:22,290 --> 01:09:30,000
saying he applied an ARP filter ARP ARP

894
01:09:26,729 --> 01:09:32,759
is our address resolution protocol which

895
01:09:30,000 --> 01:09:35,100
again if so if you have an understanding

896
01:09:32,760 --> 01:09:36,930
of network protocols it makes doing this

897
01:09:35,100 --> 01:09:38,040
analysis and Wireshark a lot easier

898
01:09:36,930 --> 01:09:40,859
because you can start putting these

899
01:09:38,040 --> 01:09:42,359
pieces together and you can say okay you

900
01:09:40,859 --> 01:09:44,790
know I need to associate a MAC address

901
01:09:42,359 --> 01:09:49,100
with an IP address what can I use to do

902
01:09:44,790 --> 01:09:52,830
that oh yeah are the address resolution

903
01:09:49,100 --> 01:09:57,570
protocol that's what it does so we take

904
01:09:52,830 --> 01:09:59,190
a look here and the essentially the way

905
01:09:57,570 --> 01:10:01,650
it works is it sends out a request and

906
01:09:59,190 --> 01:10:04,169
says hey I'm looking for this IP address

907
01:10:01,650 --> 01:10:07,019
what's the MAC address associated with

908
01:10:04,170 --> 01:10:09,660
it right and so we get all of these

909
01:10:07,020 --> 01:10:12,030
requests that look like that who has

910
01:10:09,660 --> 01:10:15,510
this IP address who has that IP address

911
01:10:12,030 --> 01:10:19,380
who has this IP address and then we also

912
01:10:15,510 --> 01:10:23,130
get back responses it says oh that IP

913
01:10:19,380 --> 01:10:26,610
address has this MAC address or so

914
01:10:23,130 --> 01:10:32,010
that's you know this address has this

915
01:10:26,610 --> 01:10:35,250
MAC address and it's a great way to look

916
01:10:32,010 --> 01:10:39,990
at IP address and MAC address

917
01:10:35,250 --> 01:10:42,540
associations in terms of if we're just

918
01:10:39,990 --> 01:10:45,620
looking in general we can apply our art

919
01:10:42,540 --> 01:10:48,840
filter if we're looking for a specific

920
01:10:45,620 --> 01:10:51,510
MAC address or a specific IP address

921
01:10:48,840 --> 01:10:56,520
then we can use our filter to get more

922
01:10:51,510 --> 01:11:01,020
specific I think the question I asked

923
01:10:56,520 --> 01:11:05,250
was about a MAC address I said you know

924
01:11:01,020 --> 01:11:08,040
this particular MAC address what's the

925
01:11:05,250 --> 01:11:13,470
IP address associated with it so we can

926
01:11:08,040 --> 01:11:16,610
just do a filter for a let's get a

927
01:11:13,470 --> 01:11:16,610
response packet

928
01:11:19,229 --> 01:11:27,209
so I'm going to I'm on packet number 936

929
01:11:24,090 --> 01:11:37,389
which is a response to an arp request

930
01:11:27,209 --> 01:11:40,239
and using that i can say the 3.1 address

931
01:11:37,389 --> 01:11:42,849
is associated with the e a 71 MAC

932
01:11:40,239 --> 01:11:46,148
address but what I'm really interested

933
01:11:42,849 --> 01:11:48,699
in is how do I build a filter so I'm

934
01:11:46,149 --> 01:11:51,159
going to select that right click on it

935
01:11:48,699 --> 01:11:55,989
apply as filter and then I get the

936
01:11:51,159 --> 01:11:59,320
syntax easy ok if I want a filter for an

937
01:11:55,989 --> 01:12:03,249
ARP request that has the source hardware

938
01:11:59,320 --> 01:12:06,728
MAC address as this right that's my

939
01:12:03,249 --> 01:12:10,478
filter but that's not exactly what I

940
01:12:06,729 --> 01:12:14,519
want because that will include both

941
01:12:10,479 --> 01:12:18,360
requests and replies from that address

942
01:12:14,519 --> 01:12:21,099
all right so you'll notice in our filter

943
01:12:18,360 --> 01:12:24,308
sometimes that address shows up as the

944
01:12:21,099 --> 01:12:27,489
one responding and sometimes it shows up

945
01:12:24,309 --> 01:12:29,530
as the one asking the question and we're

946
01:12:27,489 --> 01:12:32,259
really only interested in when it

947
01:12:29,530 --> 01:12:40,179
responds with the answer so we can add

948
01:12:32,260 --> 01:12:43,749
to our filter and when you can say the

949
01:12:40,179 --> 01:12:47,619
ARP protocol has a field that says

950
01:12:43,749 --> 01:12:49,929
whether this is a request or a reply we

951
01:12:47,619 --> 01:12:55,299
say ok I want to find the cases where it

952
01:12:49,929 --> 01:13:02,610
is whoops I wanted to do that with an

953
01:12:55,300 --> 01:13:02,610
and so I've got it as a reply and a

954
01:13:04,559 --> 01:13:13,179
particular address now I can very

955
01:13:10,389 --> 01:13:15,639
quickly answer that question of which

956
01:13:13,179 --> 01:13:18,219
MAC address is associated with a given

957
01:13:15,639 --> 01:13:19,719
IP address or vice-versa which IP

958
01:13:18,219 --> 01:13:21,760
address which is I think how the

959
01:13:19,719 --> 01:13:24,159
question was worded is associated with a

960
01:13:21,760 --> 01:13:26,619
particular MAC address because I've got

961
01:13:24,159 --> 01:13:28,719
a filter to do that and I can save this

962
01:13:26,619 --> 01:13:31,598
filter and even though it's got a

963
01:13:28,719 --> 01:13:32,710
specific MAC address in there it's now

964
01:13:31,599 --> 01:13:34,989
very easy for me

965
01:13:32,710 --> 01:13:36,550
to change the question and say oh but

966
01:13:34,989 --> 01:13:38,830
actually I don't care about that MAC

967
01:13:36,550 --> 01:13:45,000
address I care about some other MAC

968
01:13:38,830 --> 01:13:45,000
address I care about the as an example

969
01:13:45,090 --> 01:14:04,630
zero eight zero zero two seven five five

970
01:13:53,850 --> 01:14:05,110
one da8 address and then I've got the

971
01:14:04,630 --> 01:14:09,610
answer

972
01:14:05,110 --> 01:14:11,320
oh that one's the 3.34 IP address hey

973
01:14:09,610 --> 01:14:18,480
this one seemed useful I'm gonna save

974
01:14:11,320 --> 01:14:18,480
this as a filter and I'll call this my

975
01:14:22,410 --> 01:14:39,219
Mac IP lookup filter or something like

976
01:14:29,500 --> 01:14:43,770
that okay questions on any of that all

977
01:14:39,219 --> 01:14:43,770
right turn off the magnifier

978
01:14:55,659 --> 01:15:00,909
based on time I'm gonna you know just

979
01:14:58,840 --> 01:15:04,540
talk about this briefly so we've looked

980
01:15:00,909 --> 01:15:07,388
at display filters we've looked at

981
01:15:04,540 --> 01:15:09,250
adding columns another way that you can

982
01:15:07,389 --> 01:15:11,590
customize the information that you see

983
01:15:09,250 --> 01:15:15,610
in Wireshark is with what our car called

984
01:15:11,590 --> 01:15:19,330
coloring rules coloring rules have the

985
01:15:15,610 --> 01:15:20,679
exact same syntax as display filters so

986
01:15:19,330 --> 01:15:22,780
anything that you can do with the

987
01:15:20,679 --> 01:15:25,960
display filter you can do with a

988
01:15:22,780 --> 01:15:29,650
coloring rule and the difference is a

989
01:15:25,960 --> 01:15:31,389
display filter limits what you see it

990
01:15:29,650 --> 01:15:34,449
shows you only the information that

991
01:15:31,389 --> 01:15:37,659
you've filtered on a coloring rule

992
01:15:34,449 --> 01:15:40,809
leaves all of the data still visible but

993
01:15:37,659 --> 01:15:44,320
it will highlight or color the packets

994
01:15:40,810 --> 01:15:47,469
that the rule matches and so it's a way

995
01:15:44,320 --> 01:15:49,929
of getting context around your packets

996
01:15:47,469 --> 01:15:54,179
but still being able to focus in on the

997
01:15:49,929 --> 01:15:54,179
information that you're interested in

998
01:15:57,389 --> 01:16:04,600
you'll notice let me clear out my filter

999
01:16:01,440 --> 01:16:06,250
Wireshark already uses coloring rules

1000
01:16:04,600 --> 01:16:09,340
and you might have been wondering why

1001
01:16:06,250 --> 01:16:12,070
are these different colors it's because

1002
01:16:09,340 --> 01:16:15,159
of the coloring rules so in the packet

1003
01:16:12,070 --> 01:16:18,009
list to help you process all this

1004
01:16:15,159 --> 01:16:19,989
information Wireshark colors different

1005
01:16:18,010 --> 01:16:22,900
packets differently so some of them are

1006
01:16:19,989 --> 01:16:25,419
green and some of them are blue and some

1007
01:16:22,900 --> 01:16:32,080
of them are black some of them where's

1008
01:16:25,420 --> 01:16:33,969
they're brownish ones we just filtered

1009
01:16:32,080 --> 01:16:37,590
the ARP and we'll see them again and

1010
01:16:33,969 --> 01:16:40,330
some of them are the tannish brown okay

1011
01:16:37,590 --> 01:16:42,820
Wireshark has built-in coloring rules

1012
01:16:40,330 --> 01:16:44,830
and you can create your own you can say

1013
01:16:42,820 --> 01:16:49,120
you know what I really care about is

1014
01:16:44,830 --> 01:16:56,980
making sure that I notice of the ssh

1015
01:16:49,120 --> 01:17:01,389
traffic and so instead of having it be

1016
01:16:56,980 --> 01:17:04,360
this sort of bluish color that doesn't

1017
01:17:01,389 --> 01:17:07,590
stand out you can create a coloring rule

1018
01:17:04,360 --> 01:17:12,089
that makes it bright pink

1019
01:17:07,590 --> 01:17:17,540
and the way you do it is under your view

1020
01:17:12,090 --> 01:17:17,540
menu we better do the magnifying glass

1021
01:17:25,710 --> 01:17:34,530
so under the view menu there's a

1022
01:17:29,570 --> 01:17:38,940
coloring rules option when you select

1023
01:17:34,530 --> 01:17:45,240
that it lists all of your coloring rules

1024
01:17:38,940 --> 01:17:48,839
that are active and it has similar to

1025
01:17:45,240 --> 01:17:51,330
our display or our profile options the

1026
01:17:48,840 --> 01:17:55,950
ability to create new ones delete

1027
01:17:51,330 --> 01:17:58,260
existing ones copy existing ones and the

1028
01:17:55,950 --> 01:18:02,010
trick here there's two tricks

1029
01:17:58,260 --> 01:18:04,440
one it goes from top to bottom so as

1030
01:18:02,010 --> 01:18:08,870
soon as the rule matches it applies that

1031
01:18:04,440 --> 01:18:12,599
coloring and then stops so if you have

1032
01:18:08,870 --> 01:18:16,580
HTTP here being colored green and later

1033
01:18:12,600 --> 01:18:21,780
on you have TCP being colored purple

1034
01:18:16,580 --> 01:18:23,940
HTTP is using the TCP protocol so it

1035
01:18:21,780 --> 01:18:26,070
could be colored either color it could

1036
01:18:23,940 --> 01:18:27,900
be green because it's HTTP or it could

1037
01:18:26,070 --> 01:18:33,290
be purple because it's TCP

1038
01:18:27,900 --> 01:18:37,740
well it'll be colored green because HTTP

1039
01:18:33,290 --> 01:18:39,210
coloring rule is listed first so that's

1040
01:18:37,740 --> 01:18:41,519
something to keep in mind when creating

1041
01:18:39,210 --> 01:18:44,610
these coloring rules is if multiple

1042
01:18:41,520 --> 01:18:50,580
rules match it's going to color based on

1043
01:18:44,610 --> 01:18:52,349
the earliest rule in the list so I said

1044
01:18:50,580 --> 01:18:57,540
we were going to do one for SSH and make

1045
01:18:52,350 --> 01:19:01,650
it pink so I click the plus button I

1046
01:18:57,540 --> 01:19:04,500
enter my display filter and again it's

1047
01:19:01,650 --> 01:19:08,879
the exact same syntax as our display

1048
01:19:04,500 --> 01:19:12,300
filter you can you know create a display

1049
01:19:08,880 --> 01:19:14,880
filter first make sure it's filtering

1050
01:19:12,300 --> 01:19:19,980
the packets that you want and then add

1051
01:19:14,880 --> 01:19:24,200
it as a coloring room give it a name

1052
01:19:19,980 --> 01:19:24,200
like SSH

1053
01:19:25,739 --> 01:19:33,150
and then the way that you set the colors

1054
01:19:29,100 --> 01:19:34,980
is down here at the bottom there's two

1055
01:19:33,150 --> 01:19:38,309
buttons to set the background and the

1056
01:19:34,980 --> 01:19:39,870
foreground and this is the one not the

1057
01:19:38,310 --> 01:19:45,080
one thing but one complaint I have about

1058
01:19:39,870 --> 01:19:50,370
wires wire shark's interface is the

1059
01:19:45,080 --> 01:19:52,800
color of the button is the color that is

1060
01:19:50,370 --> 01:19:56,250
describing even though so like

1061
01:19:52,800 --> 01:19:58,469
foreground is the foreground of the text

1062
01:19:56,250 --> 01:20:00,719
write the text coloring it's the

1063
01:19:58,469 --> 01:20:03,150
background of the button that the color

1064
01:20:00,719 --> 01:20:06,600
is all right so the foreground currently

1065
01:20:03,150 --> 01:20:08,849
for this coloring rule is black and the

1066
01:20:06,600 --> 01:20:12,650
background is white and I'm going to

1067
01:20:08,850 --> 01:20:21,330
change that let's make the background

1068
01:20:12,650 --> 01:20:24,120
some nice pinkish color and we'll leave

1069
01:20:21,330 --> 01:20:31,080
the text black because that's mostly

1070
01:20:24,120 --> 01:20:33,360
readable the other step or trick I'll

1071
01:20:31,080 --> 01:20:35,489
tell you is make sure you check the

1072
01:20:33,360 --> 01:20:37,650
little box I don't know how many times

1073
01:20:35,489 --> 01:20:40,049
I've created a coloring rule and it

1074
01:20:37,650 --> 01:20:42,750
doesn't check the box by default and I

1075
01:20:40,050 --> 01:20:45,840
go ahead and hit OK and nothing changes

1076
01:20:42,750 --> 01:20:48,270
and I'm like what is my syntax wrong and

1077
01:20:45,840 --> 01:20:49,980
I go in and check it ten times and then

1078
01:20:48,270 --> 01:20:51,690
I realize oh I forgot to check the box

1079
01:20:49,980 --> 01:20:58,230
alright so if the box is not checked

1080
01:20:51,690 --> 01:21:00,719
that coloring rule is not active okay so

1081
01:20:58,230 --> 01:21:03,379
as soon as we're here okay all of our

1082
01:21:00,719 --> 01:21:07,680
SSH packets turn this nice bright pink

1083
01:21:03,380 --> 01:21:10,230
so that when we clear our filter and are

1084
01:21:07,680 --> 01:21:12,270
scrolling through now we can see the

1085
01:21:10,230 --> 01:21:14,250
context around those packets we can see

1086
01:21:12,270 --> 01:21:16,290
what else was going on but they still

1087
01:21:14,250 --> 01:21:18,600
stand out to us and we still say this is

1088
01:21:16,290 --> 01:21:22,760
what I'm really focusing on and I just

1089
01:21:18,600 --> 01:21:22,760
want you know the context around that

1090
01:21:22,880 --> 01:21:30,020
way over here on the right there's this

1091
01:21:26,160 --> 01:21:32,940
tiny little sidebar that is a

1092
01:21:30,020 --> 01:21:38,690
representation of your entire packet

1093
01:21:32,940 --> 01:21:42,440
list squished so that you can

1094
01:21:38,690 --> 01:21:45,349
use that to jump to a specific spot in

1095
01:21:42,440 --> 01:21:47,599
your capture file and say oh you know

1096
01:21:45,350 --> 01:21:49,610
here's a lot of pink let me get up there

1097
01:21:47,600 --> 01:21:55,390
and you can click on it and it takes you

1098
01:21:49,610 --> 01:21:55,389
to that spot in the packet list okay

1099
01:22:09,420 --> 01:22:13,320
I'm gonna skip the demo unless you guys

1100
01:22:11,460 --> 01:22:24,150
want some practice doing coloring rules

1101
01:22:13,320 --> 01:22:26,309
are we okay moving on alright so let's

1102
01:22:24,150 --> 01:22:27,629
talk about some protocols and some of

1103
01:22:26,310 --> 01:22:30,000
the things that you might be interested

1104
01:22:27,630 --> 01:22:31,590
in doing with those protocols some of

1105
01:22:30,000 --> 01:22:34,739
the values you might be interested in

1106
01:22:31,590 --> 01:22:37,170
filtering on we talked about are Paul

1107
01:22:34,739 --> 01:22:39,509
ready as we were doing that we've seen

1108
01:22:37,170 --> 01:22:42,210
IP address filtering where you can

1109
01:22:39,510 --> 01:22:44,520
filter by a source or destination that's

1110
01:22:42,210 --> 01:22:46,980
probably the most common field you'll

1111
01:22:44,520 --> 01:22:53,790
use when you're filtering at the IP

1112
01:22:46,980 --> 01:22:55,019
protocol ICMP we'll talk about in just a

1113
01:22:53,790 --> 01:22:56,489
second when we do our network

1114
01:22:55,020 --> 01:23:02,730
reconnaissance so I'm going to save that

1115
01:22:56,489 --> 01:23:04,379
one UDP and TCP again we talked about a

1116
01:23:02,730 --> 01:23:08,790
little bit as we've been doing our

1117
01:23:04,380 --> 01:23:12,929
baseline analysis one of the things with

1118
01:23:08,790 --> 01:23:15,030
UDP is that it's a very simple protocol

1119
01:23:12,929 --> 01:23:17,219
so there's not a lot that can go wrong

1120
01:23:15,030 --> 01:23:21,300
with it which is nice from a

1121
01:23:17,219 --> 01:23:24,239
troubleshooting perspective usually

1122
01:23:21,300 --> 01:23:27,270
either it works or it doesn't work and

1123
01:23:24,239 --> 01:23:29,400
if it doesn't work depending on which

1124
01:23:27,270 --> 01:23:31,710
side of the capture file you're on your

1125
01:23:29,400 --> 01:23:33,059
you just don't get the packets or you

1126
01:23:31,710 --> 01:23:35,790
get the packets and you don't get a

1127
01:23:33,060 --> 01:23:39,540
response and UDP has no mechanism to

1128
01:23:35,790 --> 01:23:42,150
recover from those errors I want to

1129
01:23:39,540 --> 01:23:44,190
focus on these last two though HTTP and

1130
01:23:42,150 --> 01:23:47,009
FTP because Wireshark provides some

1131
01:23:44,190 --> 01:23:49,669
really neat ways of interacting with

1132
01:23:47,010 --> 01:23:55,739
these two protocols

1133
01:23:49,670 --> 01:24:01,170
so in this baseline traffic you can

1134
01:23:55,739 --> 01:24:06,449
filter to http traffic and get a list of

1135
01:24:01,170 --> 01:24:10,590
all of the HTTP packets being used here

1136
01:24:06,449 --> 01:24:12,540
and you can see you know what requests

1137
01:24:10,590 --> 01:24:17,699
were being made you can see the

1138
01:24:12,540 --> 01:24:20,489
responses as you go through you can do

1139
01:24:17,699 --> 01:24:22,910
things like let me get to a different

1140
01:24:20,489 --> 01:24:22,910
request

1141
01:24:33,510 --> 01:24:35,540
Oh

1142
01:24:40,559 --> 01:24:49,829
so you know here was a request made to a

1143
01:24:44,690 --> 01:24:57,480
particular server and it's just a

1144
01:24:49,829 --> 01:24:59,730
request for the root of that URL one of

1145
01:24:57,480 --> 01:25:03,299
the things that you can do is you can do

1146
01:24:59,730 --> 01:25:05,308
what's called following the stream so

1147
01:25:03,300 --> 01:25:06,809
right now it's intermixed with all of

1148
01:25:05,309 --> 01:25:10,679
the other packets except that we've

1149
01:25:06,809 --> 01:25:14,670
filtered it to http we can then follow

1150
01:25:10,679 --> 01:25:16,380
either the TCP stream or the HTTP stream

1151
01:25:14,670 --> 01:25:19,260
and they're going to be very similar in

1152
01:25:16,380 --> 01:25:24,590
how they work let's start with the TCP

1153
01:25:19,260 --> 01:25:29,400
stream and this gives you the actual

1154
01:25:24,590 --> 01:25:34,340
ASCII text of that exchange and so you

1155
01:25:29,400 --> 01:25:37,500
see the get request it was to google.com

1156
01:25:34,340 --> 01:25:40,250
you see the headers associated with the

1157
01:25:37,500 --> 01:25:44,429
request and then you see the response

1158
01:25:40,250 --> 01:25:47,849
and you see the headers with the

1159
01:25:44,429 --> 01:25:51,329
response and you see the actual response

1160
01:25:47,849 --> 01:25:55,349
itself one of the things you'll notice

1161
01:25:51,329 --> 01:25:59,280
in this case the content encoding type

1162
01:25:55,349 --> 01:26:02,070
is gzip so it's been compressed which is

1163
01:25:59,280 --> 01:26:04,739
why when we get down here the response

1164
01:26:02,070 --> 01:26:09,780
doesn't make any sense because it's all

1165
01:26:04,739 --> 01:26:15,110
compressed data lots of times with lots

1166
01:26:09,780 --> 01:26:15,110
of protocols like if you're doing FTP or

1167
01:26:17,059 --> 01:26:23,670
even HTTP when they're not doing

1168
01:26:19,619 --> 01:26:25,980
compression the plain text will be right

1169
01:26:23,670 --> 01:26:27,690
here following the stream and you can

1170
01:26:25,980 --> 01:26:30,869
see the entire request you can see all

1171
01:26:27,690 --> 01:26:33,690
the data and you can save it all right

1172
01:26:30,869 --> 01:26:41,190
so there's options to you know save this

1173
01:26:33,690 --> 01:26:44,489
stream out to a file with HTTP they make

1174
01:26:41,190 --> 01:26:48,869
it even easier because they have this

1175
01:26:44,489 --> 01:26:52,440
export objects option that says you can

1176
01:26:48,869 --> 01:26:54,420
export objects as HTTP you combined all

1177
01:26:52,440 --> 01:26:56,580
the HTTP objects in the file

1178
01:26:54,420 --> 01:27:03,230
and I'll list them and I say you know

1179
01:26:56,580 --> 01:27:03,230
this webpage this image this media file

1180
01:27:03,830 --> 01:27:13,530
here it is my every response HTTP object

1181
01:27:09,600 --> 01:27:17,460
that was sent back is in this list and

1182
01:27:13,530 --> 01:27:21,590
you can you know filter text and you can

1183
01:27:17,460 --> 01:27:23,850
find a specific piece of information

1184
01:27:21,590 --> 01:27:33,119
let's find one that's somewhat

1185
01:27:23,850 --> 01:27:35,239
interesting maybe let's do by content

1186
01:27:33,119 --> 01:27:35,239
type

1187
01:27:47,889 --> 01:27:55,089
this is slightly boring because there's

1188
01:27:49,719 --> 01:27:59,409
no images in it yep

1189
01:27:55,089 --> 01:28:03,639
okay but we'll demo some text in so I

1190
01:27:59,409 --> 01:28:10,478
can do right here is our request to

1191
01:28:03,639 --> 01:28:17,349
Google the root URL and I'm going to

1192
01:28:10,479 --> 01:28:26,789
save that and let's save it just to the

1193
01:28:17,349 --> 01:28:26,789
desktop for now HTML

1194
01:28:33,940 --> 01:28:40,169
and I can get my PowerPoint to go away

1195
01:28:44,340 --> 01:28:52,660
so now on my desktop I've got this

1196
01:28:47,500 --> 01:28:56,500
Google HTML file and it is the web page

1197
01:28:52,660 --> 01:29:01,570
that was downloaded when I from that

1198
01:28:56,500 --> 01:29:04,180
capture traffic and it's taken care of

1199
01:29:01,570 --> 01:29:07,150
right because now it's in my web browser

1200
01:29:04,180 --> 01:29:13,090
it's taken care of the gzip compression

1201
01:29:07,150 --> 01:29:14,769
and I can see the actual data the other

1202
01:29:13,090 --> 01:29:18,340
wood thing I can do if I don't want to

1203
01:29:14,770 --> 01:29:24,880
save it to a file if I choose to follow

1204
01:29:18,340 --> 01:29:29,699
the HTTP stream on that so I did a TCP

1205
01:29:24,880 --> 01:29:29,699
stream last time if I do a HTTP stream

1206
01:29:30,090 --> 01:29:37,449
Wireshark is pretty smart and it says

1207
01:29:33,430 --> 01:29:40,270
hey I can understand HTTP headers and I

1208
01:29:37,449 --> 01:29:42,280
can look at the content encoding and if

1209
01:29:40,270 --> 01:29:45,310
it's something that I know how to decode

1210
01:29:42,280 --> 01:29:47,949
it'll decode it so if it's compressed

1211
01:29:45,310 --> 01:29:50,680
data you can still get the plaintext

1212
01:29:47,949 --> 01:29:53,019
right here in Wireshark you don't have

1213
01:29:50,680 --> 01:29:54,610
to save it out as a file you can because

1214
01:29:53,020 --> 01:29:56,620
often times maybe that's what you want

1215
01:29:54,610 --> 01:29:59,799
but if you don't want to save it out as

1216
01:29:56,620 --> 01:30:05,110
a file you just want to see the plain

1217
01:29:59,800 --> 01:30:08,890
text of it you can follow that stream

1218
01:30:05,110 --> 01:30:14,820
and see the entire request and response

1219
01:30:08,890 --> 01:30:14,820
all in plain text okay

1220
01:30:17,789 --> 01:30:22,130
that's questions on that

1221
01:30:26,280 --> 01:30:28,969
all right

1222
01:30:47,840 --> 01:30:51,770
so let's look at you know we've looked

1223
01:30:49,970 --> 01:30:54,230
at some basic protocols and things you

1224
01:30:51,770 --> 01:30:56,540
can do with them let's look at now from

1225
01:30:54,230 --> 01:30:58,940
a security perspective and say how can I

1226
01:30:56,540 --> 01:31:01,490
use Wireshark to see if someone's

1227
01:30:58,940 --> 01:31:03,200
scanning my network or you know that's

1228
01:31:01,490 --> 01:31:05,389
what we're going to focus on you can go

1229
01:31:03,200 --> 01:31:09,110
a lot further you can say how can I use

1230
01:31:05,390 --> 01:31:12,590
Wireshark to see what my network traffic

1231
01:31:09,110 --> 01:31:15,679
looks like when I'm infected with you

1232
01:31:12,590 --> 01:31:18,740
know the wanna cry or wannabe virus

1233
01:31:15,680 --> 01:31:21,590
right or what does it look like when a

1234
01:31:18,740 --> 01:31:24,349
heartbleed attack is going on from the

1235
01:31:21,590 --> 01:31:27,110
network perspective and Wireshark gives

1236
01:31:24,350 --> 01:31:29,750
you all that but let's just start with a

1237
01:31:27,110 --> 01:31:32,809
simple network reconnaissance what does

1238
01:31:29,750 --> 01:31:35,270
it look like when someone's doing a port

1239
01:31:32,810 --> 01:31:37,190
scan or doing a host scan or is trying

1240
01:31:35,270 --> 01:31:39,230
to detect what operating system I'm

1241
01:31:37,190 --> 01:31:45,139
running by sending a whole bunch of

1242
01:31:39,230 --> 01:31:49,009
network requests so I told you we'd talk

1243
01:31:45,140 --> 01:31:50,750
about ICMP it'll show up here if I want

1244
01:31:49,010 --> 01:31:52,490
to know what hosts are on a network

1245
01:31:50,750 --> 01:31:54,890
there's lots of ways I could do it

1246
01:31:52,490 --> 01:31:59,840
depending on where I am in that network

1247
01:31:54,890 --> 01:32:02,000
I could use DNS and say I could do DNS

1248
01:31:59,840 --> 01:32:06,470
reverse lookups say hey here's this IP

1249
01:32:02,000 --> 01:32:09,620
address is there DNS entry here now from

1250
01:32:06,470 --> 01:32:14,360
a attackers perspective that could be

1251
01:32:09,620 --> 01:32:19,160
nice because that could happen outside

1252
01:32:14,360 --> 01:32:21,950
of your target Network and your target

1253
01:32:19,160 --> 01:32:24,889
Network won't see that you hit the DNS

1254
01:32:21,950 --> 01:32:30,170
server because the DNS server isn't even

1255
01:32:24,890 --> 01:32:31,790
part of their network monitoring so you

1256
01:32:30,170 --> 01:32:33,290
may or may not see those requests

1257
01:32:31,790 --> 01:32:36,710
depending on where you're capturing and

1258
01:32:33,290 --> 01:32:40,250
where they're happening we saw art as a

1259
01:32:36,710 --> 01:32:43,010
way of determining IP addresses well you

1260
01:32:40,250 --> 01:32:45,470
can use that to determine devices that

1261
01:32:43,010 --> 01:32:47,990
are active on the network from an

1262
01:32:45,470 --> 01:32:50,780
attackers perspective Arps particularly

1263
01:32:47,990 --> 01:32:53,540
powerful because you cannot disable it

1264
01:32:50,780 --> 01:32:59,000
my ARP is required for your networks to

1265
01:32:53,540 --> 01:33:00,840
work so but the downside of it is it

1266
01:32:59,000 --> 01:33:04,139
only works in your local

1267
01:33:00,840 --> 01:33:05,909
network it doesn't traverse a router so

1268
01:33:04,139 --> 01:33:11,400
you have to already be inside the

1269
01:33:05,909 --> 01:33:14,339
network to do an ARP scan ICMP is sort

1270
01:33:11,400 --> 01:33:16,679
of in between those two it's going to

1271
01:33:14,340 --> 01:33:19,230
give you a view of what's on the network

1272
01:33:16,679 --> 01:33:21,690
but it's also going to be visible to the

1273
01:33:19,230 --> 01:33:23,909
target network administrators and it can

1274
01:33:21,690 --> 01:33:26,070
be disabled they can block it at the

1275
01:33:23,909 --> 01:33:29,339
firewall and nothing major is going to

1276
01:33:26,070 --> 01:33:32,219
break if you're not responding to ICMP

1277
01:33:29,340 --> 01:33:35,369
requests ICMP is the protocol that ping

1278
01:33:32,219 --> 01:33:37,440
uses ping uses that traceroute uses it

1279
01:33:35,369 --> 01:33:38,699
by default so if you've used those

1280
01:33:37,440 --> 01:33:44,969
utilities before

1281
01:33:38,699 --> 01:33:51,619
that's our ICMP protocol so I have a

1282
01:33:44,969 --> 01:33:56,580
bunch of capture files in the folder

1283
01:33:51,619 --> 01:34:00,210
that have this as their starting name so

1284
01:33:56,580 --> 01:34:03,360
nmap underscore s capital l and map

1285
01:34:00,210 --> 01:34:07,770
underscore SN and map i underscore

1286
01:34:03,360 --> 01:34:14,699
external these are different captures of

1287
01:34:07,770 --> 01:34:17,849
a nmap scan as it's happening on the

1288
01:34:14,699 --> 01:34:18,900
network and the reason I do asterisks

1289
01:34:17,849 --> 01:34:21,030
here is because there's two different

1290
01:34:18,900 --> 01:34:23,339
versions right there's one version that

1291
01:34:21,030 --> 01:34:25,650
just shows the scanning traffic and

1292
01:34:23,340 --> 01:34:27,449
there's one version that shows the

1293
01:34:25,650 --> 01:34:31,110
scanning traffic intermixed with the

1294
01:34:27,449 --> 01:34:33,540
baseline so the version that has

1295
01:34:31,110 --> 01:34:35,730
baseline included in it includes

1296
01:34:33,540 --> 01:34:37,920
baseline traffic the file name without

1297
01:34:35,730 --> 01:34:41,129
baseline doesn't include baseline

1298
01:34:37,920 --> 01:34:44,940
traffic and the goal here is to create

1299
01:34:41,130 --> 01:34:50,340
coloring rules and filters that let you

1300
01:34:44,940 --> 01:34:54,500
spot the N map traffic all right so look

1301
01:34:50,340 --> 01:34:57,300
at open the traffic that's just n map

1302
01:34:54,500 --> 01:34:59,070
look through it see what characteristics

1303
01:34:57,300 --> 01:35:02,030
or what things you could create a

1304
01:34:59,070 --> 01:35:06,509
display filter on to show you only those

1305
01:35:02,030 --> 01:35:08,639
what coloring rules you might use save

1306
01:35:06,510 --> 01:35:12,869
them to your profile and then load the

1307
01:35:08,639 --> 01:35:13,889
baseline capture file and see you know

1308
01:35:12,869 --> 01:35:17,159
if it helped

1309
01:35:13,889 --> 01:35:20,639
you identify that that scan is occurring

1310
01:35:17,159 --> 01:35:22,980
okay so take a look at these three

1311
01:35:20,639 --> 01:35:25,290
capture files really six capture files

1312
01:35:22,980 --> 01:35:27,928
and then we'll talk about rules that you

1313
01:35:25,290 --> 01:35:30,139
use to help highlight this scanning

1314
01:35:27,929 --> 01:35:30,139
process

1315
01:46:04,220 --> 01:46:08,060
so how're we doing do we need more time

1316
01:46:06,830 --> 01:46:14,360
to look at these you want to look at

1317
01:46:08,060 --> 01:46:18,410
them together upfront are we in the

1318
01:46:14,360 --> 01:46:26,360
afternoon stupor and are no longer

1319
01:46:18,410 --> 01:46:41,660
capable of communication yeah should we

1320
01:46:26,360 --> 01:46:44,690
look at it upfront then okay all right

1321
01:46:41,660 --> 01:46:47,570
where are we on time we probably won't

1322
01:46:44,690 --> 01:46:48,740
go through all of these but let's pick

1323
01:46:47,570 --> 01:46:54,980
one of them which one do you want to

1324
01:46:48,740 --> 01:46:56,540
look at SL very first one all right

1325
01:46:54,980 --> 01:47:07,450
that's probably the one most people have

1326
01:46:56,540 --> 01:47:07,450
at least looked at so we're going in map

1327
01:47:08,260 --> 01:47:11,260
SL

1328
01:47:17,250 --> 01:47:22,910
what's the first thing you notice about

1329
01:47:18,600 --> 01:47:22,910
this capture file

1330
01:47:23,090 --> 01:47:30,240
lots of DNS queries ok so there's n map

1331
01:47:27,840 --> 01:47:32,760
SL and by the name by the way the name

1332
01:47:30,240 --> 01:47:35,099
of these is based off the flags that you

1333
01:47:32,760 --> 01:47:38,520
use that you pass the end map to

1334
01:47:35,100 --> 01:47:44,130
accomplish this type of scan so this is

1335
01:47:38,520 --> 01:47:46,070
a DNS scan all right that's why there's

1336
01:47:44,130 --> 01:47:49,770
all these DNS requests is because it's

1337
01:47:46,070 --> 01:47:52,590
attempting to enumerate host names for

1338
01:47:49,770 --> 01:47:54,300
all these IP addresses so what else do

1339
01:47:52,590 --> 01:48:00,030
you notice lots of DNS requests what do

1340
01:47:54,300 --> 01:48:06,240
you notice about them all coming from

1341
01:48:00,030 --> 01:48:09,480
one source what else and sequential it's

1342
01:48:06,240 --> 01:48:12,660
just droop force trying one IP address

1343
01:48:09,480 --> 01:48:16,980
after the next and it's trying it using

1344
01:48:12,660 --> 01:48:19,559
this reverse lookup and so DNS usually

1345
01:48:16,980 --> 01:48:22,500
goes from a domain name to an IP address

1346
01:48:19,560 --> 01:48:27,060
but it can be used in Reverse to go from

1347
01:48:22,500 --> 01:48:30,000
an IP address to a domain name now I

1348
01:48:27,060 --> 01:48:35,190
would suggest in terms of filters and

1349
01:48:30,000 --> 01:48:37,560
colouring rules that that in itself is

1350
01:48:35,190 --> 01:48:40,139
probably a good coloring rule to have to

1351
01:48:37,560 --> 01:48:42,210
highlight any time you see a reverse DNS

1352
01:48:40,140 --> 01:48:46,050
request because they're not very common

1353
01:48:42,210 --> 01:48:49,380
in everyday browsing in fact if you go

1354
01:48:46,050 --> 01:48:51,690
back to the base line not the nmap base

1355
01:48:49,380 --> 01:48:55,770
line just the normal base line and try

1356
01:48:51,690 --> 01:48:58,799
and find a DNS reverse packet there's

1357
01:48:55,770 --> 01:49:02,600
probably not one there we could pull it

1358
01:48:58,800 --> 01:49:08,130
up and check so we need to create a

1359
01:49:02,600 --> 01:49:15,260
filter for reverse lookups or that's one

1360
01:49:08,130 --> 01:49:17,670
approach did anyone try and do that yeah

1361
01:49:15,260 --> 01:49:19,260
what did you use for your were you

1362
01:49:17,670 --> 01:49:21,680
successful and what did you use for your

1363
01:49:19,260 --> 01:49:21,680
filter

1364
01:49:27,450 --> 01:49:30,450
okay

1365
01:49:33,330 --> 01:49:42,519
so let's use our newfound skills and say

1366
01:49:38,710 --> 01:49:52,810
alright if I can find a field that looks

1367
01:49:42,520 --> 01:49:56,110
like what I want I can filter on it okay

1368
01:49:52,810 --> 01:49:58,210
so we want the request right because

1369
01:49:56,110 --> 01:50:04,330
that indicates a scan so one thing we

1370
01:49:58,210 --> 01:50:12,810
might do is filter for this so apply as

1371
01:50:04,330 --> 01:50:12,809
filter gotta get lower in my window

1372
01:50:20,590 --> 01:50:26,770
so that'll get us partway down the right

1373
01:50:24,010 --> 01:50:31,300
track now this will only be highlighting

1374
01:50:26,770 --> 01:50:35,160
DNS requests how do I make it so that it

1375
01:50:31,300 --> 01:50:47,560
highlights DNS requests that I reverse

1376
01:50:35,160 --> 01:50:51,370
lookups if we expand out the query we

1377
01:50:47,560 --> 01:50:53,380
see this type and again here's where

1378
01:50:51,370 --> 01:50:57,280
some understanding of the DNS protocol

1379
01:50:53,380 --> 01:50:58,780
might be helpful and if you have less

1380
01:50:57,280 --> 01:51:00,340
understanding of it looking at the

1381
01:50:58,780 --> 01:51:02,650
baseline file and looking what a normal

1382
01:51:00,340 --> 01:51:05,710
DNS request looks like and comparing it

1383
01:51:02,650 --> 01:51:09,070
to this allows you to see the same thing

1384
01:51:05,710 --> 01:51:13,420
so a normal DNS request the type will be

1385
01:51:09,070 --> 01:51:17,410
a for ipv4 request and it'll be for A's

1386
01:51:13,420 --> 01:51:22,420
for ipv6 request the type for a reverse

1387
01:51:17,410 --> 01:51:25,840
lookup is this pointer type which makes

1388
01:51:22,420 --> 01:51:33,430
a great way to filter so I'm gonna say

1389
01:51:25,840 --> 01:51:36,670
it's not a response and it's a pointer

1390
01:51:33,430 --> 01:51:41,710
type right which has value of 12 in

1391
01:51:36,670 --> 01:51:47,710
terms of its decimal value and apply

1392
01:51:41,710 --> 01:51:49,930
that as my display filter once I sort of

1393
01:51:47,710 --> 01:51:52,780
scan through this and say yeah that's

1394
01:51:49,930 --> 01:51:57,510
filtering to all of these reverse

1395
01:51:52,780 --> 01:52:00,730
lookups that seems to be what I want I

1396
01:51:57,510 --> 01:52:10,750
can grab that and move it to a coloring

1397
01:52:00,730 --> 01:52:14,620
rule and we'll just do a new one put in

1398
01:52:10,750 --> 01:52:19,830
the rule we just created call this our

1399
01:52:14,620 --> 01:52:19,830
DNS reverse lookup

1400
01:52:23,000 --> 01:52:31,889
and make it something that will stand

1401
01:52:25,770 --> 01:52:39,329
out so I'll go with like a red for a

1402
01:52:31,889 --> 01:52:42,139
nice warning color black doesn't show up

1403
01:52:39,329 --> 01:52:49,230
so well on that red so we'll change the

1404
01:52:42,139 --> 01:52:56,429
foreground to white and check the box

1405
01:52:49,230 --> 01:52:59,940
yep okay so all these show up now in

1406
01:52:56,429 --> 01:53:03,329
this nice easy to see red let's see how

1407
01:52:59,940 --> 01:53:15,869
it works when we load it in our baseline

1408
01:53:03,329 --> 01:53:21,509
file we open in map SL baseline clear my

1409
01:53:15,869 --> 01:53:23,969
display filter and what this does is it

1410
01:53:21,510 --> 01:53:26,520
lets me as I look through my baseline

1411
01:53:23,969 --> 01:53:29,099
file I'm going yeah everything looks

1412
01:53:26,520 --> 01:53:30,900
good looks good looks good oh wait a

1413
01:53:29,099 --> 01:53:34,230
minute why am i seeing all these Reds

1414
01:53:30,900 --> 01:53:36,960
what's going on and it just alerts me to

1415
01:53:34,230 --> 01:53:42,299
look at this in a little more detail say

1416
01:53:36,960 --> 01:53:47,159
okay oh I'm getting a whole bunch of

1417
01:53:42,300 --> 01:53:52,730
these in sequential order it looks like

1418
01:53:47,159 --> 01:53:56,040
someone's doing a DNS reverse lookup as

1419
01:53:52,730 --> 01:54:01,980
someone over here I think pointed out we

1420
01:53:56,040 --> 01:54:06,300
can then use Wireshark to start doing

1421
01:54:01,980 --> 01:54:09,239
some next steps right we can say not

1422
01:54:06,300 --> 01:54:11,699
only am i under attack is someone

1423
01:54:09,239 --> 01:54:16,650
actively scanning my network but I can

1424
01:54:11,699 --> 01:54:20,280
see where that scan is coming from it's

1425
01:54:16,650 --> 01:54:23,400
coming from the 232 IP address so I not

1426
01:54:20,280 --> 01:54:24,989
now know oh let's use you know what we

1427
01:54:23,400 --> 01:54:26,730
just learned about in terms of looking

1428
01:54:24,989 --> 01:54:30,598
up that MAC address maybe we already

1429
01:54:26,730 --> 01:54:32,308
have it in our management system but if

1430
01:54:30,599 --> 01:54:35,280
we don't we can use Wireshark look at

1431
01:54:32,309 --> 01:54:36,000
the MAC address and go to our inventory

1432
01:54:35,280 --> 01:54:39,540
and say okay

1433
01:54:36,000 --> 01:54:45,300
which device is currently has this IP

1434
01:54:39,540 --> 01:54:47,820
address which MAC address is that go you

1435
01:54:45,300 --> 01:54:52,590
know physically check it out is it oh

1436
01:54:47,820 --> 01:54:56,370
that's you know that's my partner right

1437
01:54:52,590 --> 01:54:59,400
next door he must be you know doing a

1438
01:54:56,370 --> 01:55:02,010
security audit or oh no that's the guy

1439
01:54:59,400 --> 01:55:03,960
downstairs I wonder if his computer got

1440
01:55:02,010 --> 01:55:06,900
infected by a worm let's go check it out

1441
01:55:03,960 --> 01:55:12,240
it gives us a place to start looking for

1442
01:55:06,900 --> 01:55:15,990
more information okay we're about out of

1443
01:55:12,240 --> 01:55:19,019
time is there anything you want to know

1444
01:55:15,990 --> 01:55:22,070
about Wireshark questions you have that

1445
01:55:19,020 --> 01:55:22,070
we didn't get to

1446
01:55:28,970 --> 01:55:34,640
okay if not like I said I've been using

1447
01:55:32,540 --> 01:55:37,160
wireshark for a lot of years and I still

1448
01:55:34,640 --> 01:55:40,280
don't know everything you can do with it

1449
01:55:37,160 --> 01:55:43,970
I hope this has given you a place to

1450
01:55:40,280 --> 01:55:45,230
start and to start using wireshark find

1451
01:55:43,970 --> 01:55:48,650
ways to use it

1452
01:55:45,230 --> 01:55:50,660
I've had several people I teach a class

1453
01:55:48,650 --> 01:55:52,009
at Weber using wireshark

1454
01:55:50,660 --> 01:55:54,380
I've had several students afterwards

1455
01:55:52,010 --> 01:55:56,090
come up and tell me you know I've I

1456
01:55:54,380 --> 01:55:58,160
started using the Wireshark in my job

1457
01:55:56,090 --> 01:55:59,830
and I solved this problem no one else

1458
01:55:58,160 --> 01:56:02,900
can solve or I figured out why our

1459
01:55:59,830 --> 01:56:05,180
network connection was slow or I you

1460
01:56:02,900 --> 01:56:06,980
know it's it's a very powerful tool and

1461
01:56:05,180 --> 01:56:09,830
so I encourage you to keep exploring and

1462
01:56:06,980 --> 01:56:11,509
using it and I'm happy throughout the

1463
01:56:09,830 --> 01:56:14,090
con if you run into any questions about

1464
01:56:11,510 --> 01:56:16,460
it I'll be here through Friday and I'm

1465
01:56:14,090 --> 01:56:18,500
happy to talk to you and meet any of you

1466
01:56:16,460 --> 01:56:21,640
and I hope you enjoyed the rest of the

1467
01:56:18,500 --> 01:56:21,640
con so thank you

1468
01:56:23,500 --> 01:56:26,890
[Applause]

