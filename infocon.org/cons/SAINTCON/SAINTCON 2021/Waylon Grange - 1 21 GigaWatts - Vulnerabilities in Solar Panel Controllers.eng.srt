1
00:00:00,240 --> 00:00:01,120
all right

2
00:00:01,120 --> 00:00:03,439
okay thank you all for coming out here

3
00:00:03,439 --> 00:00:06,960
this um this talk titled 1.21 gigawatts

4
00:00:06,960 --> 00:00:09,120
is um is about hacking solar panel

5
00:00:09,120 --> 00:00:11,599
controllers um i've given this talk at

6
00:00:11,599 --> 00:00:13,360
rsa and defcon

7
00:00:13,360 --> 00:00:15,519
but they're like a 25-minute version and

8
00:00:15,519 --> 00:00:16,720
when i talked when i presented for st

9
00:00:16,720 --> 00:00:18,160
con they're like oh yeah let's do that

10
00:00:18,160 --> 00:00:20,160
but make it like 60 minutes

11
00:00:20,160 --> 00:00:22,080
so you guys get the more detailed

12
00:00:22,080 --> 00:00:24,000
information i'm going to show you

13
00:00:24,000 --> 00:00:26,080
exactly i have the solar panel up here

14
00:00:26,080 --> 00:00:27,279
the controller up here and i'm going to

15
00:00:27,279 --> 00:00:28,560
show you how some of the attacks that i

16
00:00:28,560 --> 00:00:31,199
did on it that the firmware or attacks

17
00:00:31,199 --> 00:00:34,320
or the hardware attacks is part of this

18
00:00:34,320 --> 00:00:35,920
and i'll try to leave some time at the

19
00:00:35,920 --> 00:00:37,680
end for questions

20
00:00:37,680 --> 00:00:38,399
but

21
00:00:38,399 --> 00:00:40,800
with that i'll kind of get started and

22
00:00:40,800 --> 00:00:42,160
give me i'm going to be showing

23
00:00:42,160 --> 00:00:43,520
different screens that i usually don't

24
00:00:43,520 --> 00:00:45,360
so i may have some

25
00:00:45,360 --> 00:00:47,280
tech issues but hopefully they're

26
00:00:47,280 --> 00:00:49,520
they're not big issues that hold us back

27
00:00:49,520 --> 00:00:51,840
so a little background on me um i do

28
00:00:51,840 --> 00:00:53,120
well not on me

29
00:00:53,120 --> 00:00:55,680
i do this kind of stuff for fun um in

30
00:00:55,680 --> 00:00:58,960
fact this was my 2020 project um i was

31
00:00:58,960 --> 00:01:00,960
locked in my house for quite some time

32
00:01:00,960 --> 00:01:04,080
right i just also had a newborn so i had

33
00:01:04,080 --> 00:01:05,760
a lot of time at home but it was like

34
00:01:05,760 --> 00:01:06,960
sporadic

35
00:01:06,960 --> 00:01:09,360
and around the same time that we all got

36
00:01:09,360 --> 00:01:11,439
locked at home a little before that my

37
00:01:11,439 --> 00:01:12,640
neighbor's like oh check out the new

38
00:01:12,640 --> 00:01:14,320
solar panel system i have on my house i

39
00:01:14,320 --> 00:01:16,080
can control it via my phone

40
00:01:16,080 --> 00:01:17,680
and i was like oh that sounds

41
00:01:17,680 --> 00:01:20,400
interesting i think i got a new project

42
00:01:20,400 --> 00:01:22,640
so my neighbor's house has solar panel

43
00:01:22,640 --> 00:01:24,080
controllers and i have free time that's

44
00:01:24,080 --> 00:01:26,720
what led to this project as it is

45
00:01:26,720 --> 00:01:28,880
um i'm gonna tell you step by step what

46
00:01:28,880 --> 00:01:31,520
i did how i go at this um what worked

47
00:01:31,520 --> 00:01:33,600
what didn't work kind of props to the

48
00:01:33,600 --> 00:01:36,560
the company and what doesn't prop or or

49
00:01:36,560 --> 00:01:38,720
where they failed i also do iot pen

50
00:01:38,720 --> 00:01:40,720
testing for work so i can kind of say

51
00:01:40,720 --> 00:01:42,960
you know this is a systemic issue etc as

52
00:01:42,960 --> 00:01:45,040
we go through things so

53
00:01:45,040 --> 00:01:48,000
overall when i get a hardware project i

54
00:01:48,000 --> 00:01:49,840
always start online i never touch the

55
00:01:49,840 --> 00:01:51,600
device to start with right like when i

56
00:01:51,600 --> 00:01:52,720
first get the device i want to find out

57
00:01:52,720 --> 00:01:54,399
okay what am i looking at what's the

58
00:01:54,399 --> 00:01:56,799
attack surface before i start to break

59
00:01:56,799 --> 00:01:58,399
things and take it apart that's the last

60
00:01:58,399 --> 00:01:59,920
step i want to do

61
00:01:59,920 --> 00:02:01,680
so this is a slide taking from their

62
00:02:01,680 --> 00:02:03,119
marketing material

63
00:02:03,119 --> 00:02:05,280
it talks about their whole in-phase

64
00:02:05,280 --> 00:02:07,680
setup here right you've got these um

65
00:02:07,680 --> 00:02:09,280
solar panels on the roof and each one

66
00:02:09,280 --> 00:02:12,160
has their own micro uh converter on it i

67
00:02:12,160 --> 00:02:13,200
think

68
00:02:13,200 --> 00:02:14,319
does my mouse show up on your thing

69
00:02:14,319 --> 00:02:16,560
perfect the little converter um they

70
00:02:16,560 --> 00:02:17,920
really they're really

71
00:02:17,920 --> 00:02:19,840
happy about their connector they use so

72
00:02:19,840 --> 00:02:21,120
they highlight that in these slides for

73
00:02:21,120 --> 00:02:23,120
some reason but you can control it via

74
00:02:23,120 --> 00:02:25,440
your ipad the person who installs these

75
00:02:25,440 --> 00:02:27,599
things does it via his iphone um there's

76
00:02:27,599 --> 00:02:29,520
this battery pack and it's all the

77
00:02:29,520 --> 00:02:31,519
brains of this operation is this uh in

78
00:02:31,519 --> 00:02:33,760
phase envoy controller this is the

79
00:02:33,760 --> 00:02:36,000
brains that then talks to the cloud and

80
00:02:36,000 --> 00:02:37,440
reports your

81
00:02:37,440 --> 00:02:39,680
production and how much consumption

82
00:02:39,680 --> 00:02:41,440
you're doing and then you talk to the

83
00:02:41,440 --> 00:02:43,120
cloud component with your phone or your

84
00:02:43,120 --> 00:02:45,200
mobile device

85
00:02:45,200 --> 00:02:46,640
but what i found interesting is that the

86
00:02:46,640 --> 00:02:49,440
installer uses the phone on your site to

87
00:02:49,440 --> 00:02:51,760
configure the device i was like okay

88
00:02:51,760 --> 00:02:53,360
there's an installer app i got to go

89
00:02:53,360 --> 00:02:56,000
find that so i go looking you know on on

90
00:02:56,000 --> 00:02:58,000
the play store or

91
00:02:58,000 --> 00:02:59,760
apple there's there's two apps out there

92
00:02:59,760 --> 00:03:02,319
there's the app for the user the end

93
00:03:02,319 --> 00:03:03,760
user and there's also the installer

94
00:03:03,760 --> 00:03:05,760
toolkit app pulled them both down it's

95
00:03:05,760 --> 00:03:07,440
like oh this is great let's go ahead and

96
00:03:07,440 --> 00:03:09,440
start looking around i also scoured

97
00:03:09,440 --> 00:03:11,200
their site looking for firmware images

98
00:03:11,200 --> 00:03:13,599
um didn't find anything on their site so

99
00:03:13,599 --> 00:03:14,560
just

100
00:03:14,560 --> 00:03:15,920
they didn't have the firmware images

101
00:03:15,920 --> 00:03:18,080
available to users to download and

102
00:03:18,080 --> 00:03:19,920
upload their devices so that was kind of

103
00:03:19,920 --> 00:03:22,000
a win for them

104
00:03:22,000 --> 00:03:22,879
um

105
00:03:22,879 --> 00:03:24,560
on their side but their apps are out

106
00:03:24,560 --> 00:03:26,879
there and so their apps what their apps

107
00:03:26,879 --> 00:03:28,400
are were actually

108
00:03:28,400 --> 00:03:31,280
the android app and the win and the

109
00:03:31,280 --> 00:03:33,840
apple app both just were

110
00:03:33,840 --> 00:03:35,920
net cover so like the javascript just

111
00:03:35,920 --> 00:03:38,319
called into a net library and the swift

112
00:03:38,319 --> 00:03:40,720
code called into a.net library and the

113
00:03:40,720 --> 00:03:43,280
net library did all the heavy lifting

114
00:03:43,280 --> 00:03:45,440
let's see if i can get that screen up

115
00:03:45,440 --> 00:03:49,519
give me just a second to figure this out

116
00:03:49,519 --> 00:03:52,480
all right that's the screen i want

117
00:03:52,480 --> 00:03:53,599
but

118
00:03:53,599 --> 00:03:55,120
i don't oh there we go i get to see it

119
00:03:55,120 --> 00:03:57,599
there okay

120
00:03:57,599 --> 00:03:59,519
um

121
00:03:59,519 --> 00:04:02,400
and i'm gonna open aisle spy so i'll sp

122
00:04:02,400 --> 00:04:05,680
i oh that is tiny

123
00:04:06,799 --> 00:04:10,080
il spy is a tool for viewing.net um

124
00:04:10,080 --> 00:04:12,799
assemblies and so with aisle spy i load

125
00:04:12,799 --> 00:04:14,560
it up in there and it does pretty much a

126
00:04:14,560 --> 00:04:16,320
really good reversing i can almost get

127
00:04:16,320 --> 00:04:18,639
the initial source code minus comments

128
00:04:18,639 --> 00:04:20,160
um from them

129
00:04:20,160 --> 00:04:21,759
and so i'm scouring over the source code

130
00:04:21,759 --> 00:04:23,759
looking for anything interesting and one

131
00:04:23,759 --> 00:04:27,120
of the first things i find is a url here

132
00:04:27,120 --> 00:04:28,479
can you guys see that that's really tiny

133
00:04:28,479 --> 00:04:29,680
for me to read i don't know if you guys

134
00:04:29,680 --> 00:04:31,040
can you read this

135
00:04:31,040 --> 00:04:34,400
great so there's a url to a amazon sw3

136
00:04:34,400 --> 00:04:36,720
bucket right you can see that

137
00:04:36,720 --> 00:04:38,240
that was that's where their firmware

138
00:04:38,240 --> 00:04:41,040
packages are at this is this sw3 bucket

139
00:04:41,040 --> 00:04:43,360
but i didn't see any creds for that so

140
00:04:43,360 --> 00:04:44,800
i'm like okay well there's this bucket

141
00:04:44,800 --> 00:04:48,000
out there let's go look at it

142
00:04:48,000 --> 00:04:49,440
now i'm going to try to do something

143
00:04:49,440 --> 00:04:51,280
that's

144
00:04:51,280 --> 00:04:52,880
again not

145
00:04:52,880 --> 00:04:56,520
what i plan on

146
00:04:56,639 --> 00:05:00,560
and we'll just skip to the desktop

147
00:05:00,960 --> 00:05:02,479
desktop

148
00:05:02,479 --> 00:05:05,120
oh i got to close that

149
00:05:05,120 --> 00:05:07,840
that's rough

150
00:05:09,039 --> 00:05:12,000
so aws there's command like tools if

151
00:05:12,000 --> 00:05:13,919
you're familiar aws

152
00:05:13,919 --> 00:05:18,320
and one of them is the s3 ls

153
00:05:18,800 --> 00:05:20,880
and that's not going to work because i

154
00:05:20,880 --> 00:05:22,880
didn't tell it what i'm going to ls but

155
00:05:22,880 --> 00:05:25,680
basically all i need to do

156
00:05:25,680 --> 00:05:29,199
is just say

157
00:05:31,039 --> 00:05:33,199
oh i thought i saved this somewhere now

158
00:05:33,199 --> 00:05:35,199
i don't see it

159
00:05:35,199 --> 00:05:38,199
bugger

160
00:05:41,120 --> 00:05:43,520
booger

161
00:05:49,840 --> 00:05:52,560
darn okay well that part of the live

162
00:05:52,560 --> 00:05:54,800
demo didn't work but that

163
00:05:54,800 --> 00:05:57,600
link that i showed here is actually an

164
00:05:57,600 --> 00:06:00,319
open s3 bucket which means if you just

165
00:06:00,319 --> 00:06:03,520
use if i actually why don't i quit being

166
00:06:03,520 --> 00:06:04,639
lazy

167
00:06:04,639 --> 00:06:07,840
and just

168
00:06:09,759 --> 00:06:11,600
copy that that's so tiny for me so i

169
00:06:11,600 --> 00:06:15,080
hope this will work

170
00:06:24,800 --> 00:06:26,319
all right i'm getting that so i can read

171
00:06:26,319 --> 00:06:28,319
it and we'll try that

172
00:06:28,319 --> 00:06:30,960
what does that say

173
00:06:31,600 --> 00:06:35,039
bucket name cannot be found

174
00:06:35,039 --> 00:06:36,880
oh because i don't need the https in

175
00:06:36,880 --> 00:06:39,360
front of it

176
00:06:45,919 --> 00:06:48,240
okay let's try that again oh what where

177
00:06:48,240 --> 00:06:50,560
did it go

178
00:06:52,240 --> 00:06:54,560
um

179
00:07:00,479 --> 00:07:02,960
i stopped running myself off my yeah but

180
00:07:02,960 --> 00:07:04,960
i'm still presenting

181
00:07:04,960 --> 00:07:06,720
i'm still here

182
00:07:06,720 --> 00:07:08,400
do i need to have powerpoint running for

183
00:07:08,400 --> 00:07:10,880
that to work

184
00:07:12,080 --> 00:07:13,360
oh thank you

185
00:07:13,360 --> 00:07:16,400
okay so here we'll try this again so

186
00:07:16,400 --> 00:07:18,400
here i just do an ls of the name of that

187
00:07:18,400 --> 00:07:20,880
bucket

188
00:07:21,199 --> 00:07:22,800
all right i'm going to move on i'm not

189
00:07:22,800 --> 00:07:24,400
sure why that's not working that should

190
00:07:24,400 --> 00:07:26,400
just work just fine and i can get a list

191
00:07:26,400 --> 00:07:28,080
of what's on there

192
00:07:28,080 --> 00:07:31,039
um in on that bucket

193
00:07:31,039 --> 00:07:34,159
let's just skip ahead

194
00:07:34,400 --> 00:07:36,160
so here is a screenshot of me doing that

195
00:07:36,160 --> 00:07:38,720
from before um

196
00:07:38,720 --> 00:07:40,000
oh

197
00:07:40,000 --> 00:07:42,720
i have that syntax wrong sorry guys um

198
00:07:42,720 --> 00:07:44,319
but you can see the list of the packages

199
00:07:44,319 --> 00:07:45,680
that they have up there um the

200
00:07:45,680 --> 00:07:47,280
extensions on those are a little funky

201
00:07:47,280 --> 00:07:50,080
though that's like a dot ee pkg instead

202
00:07:50,080 --> 00:07:53,360
of just a sum or a tgz file and what

203
00:07:53,360 --> 00:07:55,280
that was is so they have a public bucket

204
00:07:55,280 --> 00:07:56,879
where all their firmware images are and

205
00:07:56,879 --> 00:07:58,560
there's also an xml file saying which

206
00:07:58,560 --> 00:08:00,000
image is applied to which devices which

207
00:08:00,000 --> 00:08:01,120
was really really great for me as a

208
00:08:01,120 --> 00:08:03,520
researcher but this anything with the ee

209
00:08:03,520 --> 00:08:05,680
pkg was encrypted

210
00:08:05,680 --> 00:08:08,639
in fact they have on that site is also a

211
00:08:08,639 --> 00:08:10,080
ruby script which goes through the

212
00:08:10,080 --> 00:08:12,160
install and part of that ruby script

213
00:08:12,160 --> 00:08:14,639
says hey grab these files and decrypt it

214
00:08:14,639 --> 00:08:17,280
with this ee crypt tool i scoured the

215
00:08:17,280 --> 00:08:18,960
web looking for this ee tool and

216
00:08:18,960 --> 00:08:21,039
it's something specific to them and it's

217
00:08:21,039 --> 00:08:22,879
only on the firmware images so now i've

218
00:08:22,879 --> 00:08:25,120
got this kind of catch 22 bug where i've

219
00:08:25,120 --> 00:08:27,120
got the firmware images but to decrypt

220
00:08:27,120 --> 00:08:29,039
them i need this tool which is on the

221
00:08:29,039 --> 00:08:31,280
firmware image right like they kind of

222
00:08:31,280 --> 00:08:33,599
got me around a loop here so

223
00:08:33,599 --> 00:08:35,839
i thought i had a win having full access

224
00:08:35,839 --> 00:08:37,599
to the firmware images but it turns out

225
00:08:37,599 --> 00:08:39,679
i don't have them until i have that tool

226
00:08:39,679 --> 00:08:40,799
so

227
00:08:40,799 --> 00:08:42,479
now i have a new goal is somehow to find

228
00:08:42,479 --> 00:08:44,399
this tool

229
00:08:44,399 --> 00:08:47,440
also in the installer app

230
00:08:47,440 --> 00:08:49,200
the dot-net assemblies they all reverse

231
00:08:49,200 --> 00:08:51,360
really easily except for there's a spot

232
00:08:51,360 --> 00:08:53,519
where that installer app

233
00:08:53,519 --> 00:08:56,720
let's see if i can switch screens again

234
00:08:56,720 --> 00:08:59,040
we'll call into and i'm going to step

235
00:08:59,040 --> 00:09:02,079
down here because that's too small

236
00:09:04,320 --> 00:09:06,480
i can't see it anyways

237
00:09:06,480 --> 00:09:08,000
there's a spot in here where it will

238
00:09:08,000 --> 00:09:10,480
call into a password

239
00:09:10,480 --> 00:09:13,279
um a function and that password

240
00:09:13,279 --> 00:09:15,839
functions uh emu git mobile password and

241
00:09:15,839 --> 00:09:17,440
what that will do is i'll call a native

242
00:09:17,440 --> 00:09:20,399
assembly like a an sl file

243
00:09:20,399 --> 00:09:22,000
which will then calculate some kind of

244
00:09:22,000 --> 00:09:24,560
password in c code and then report it

245
00:09:24,560 --> 00:09:27,680
back up to the dot net and as a reverser

246
00:09:27,680 --> 00:09:30,320
whenever i see native code or dot net

247
00:09:30,320 --> 00:09:32,240
code or java's code calling into some

248
00:09:32,240 --> 00:09:34,320
low level assembly function

249
00:09:34,320 --> 00:09:36,240
the real reason you would see that or

250
00:09:36,240 --> 00:09:38,320
that that's there is to do like driver

251
00:09:38,320 --> 00:09:39,279
um

252
00:09:39,279 --> 00:09:41,600
tasking right you you're doing low level

253
00:09:41,600 --> 00:09:42,720
stuff

254
00:09:42,720 --> 00:09:44,000
but this doesn't do anything with low

255
00:09:44,000 --> 00:09:47,120
level and in fact um with the other time

256
00:09:47,120 --> 00:09:48,800
we see it which is not the real use for

257
00:09:48,800 --> 00:09:50,480
it but we see it as a people are trying

258
00:09:50,480 --> 00:09:52,240
to hide something like

259
00:09:52,240 --> 00:09:54,080
developers know oh dot net is easy to

260
00:09:54,080 --> 00:09:55,920
reverse java is easy to reverse but if i

261
00:09:55,920 --> 00:09:57,760
write this in c and it compiles down to

262
00:09:57,760 --> 00:10:00,240
assembly they won't figure me out me as

263
00:10:00,240 --> 00:10:02,240
a reverser i'm like dude you're playing

264
00:10:02,240 --> 00:10:04,000
right into my trap like i reverse

265
00:10:04,000 --> 00:10:05,839
assembly i love that stuff right so when

266
00:10:05,839 --> 00:10:08,000
i see you go in there it's basically

267
00:10:08,000 --> 00:10:10,240
like look here this is where the goods

268
00:10:10,240 --> 00:10:13,519
are right and so i grab that so i

269
00:10:13,519 --> 00:10:16,079
reverse it and you can see that the two

270
00:10:16,079 --> 00:10:17,519
other screenshots here kind of show that

271
00:10:17,519 --> 00:10:19,920
function it basically builds this string

272
00:10:19,920 --> 00:10:20,959
based on

273
00:10:20,959 --> 00:10:22,560
the username

274
00:10:22,560 --> 00:10:24,959
and in phase energy and like every other

275
00:10:24,959 --> 00:10:27,279
case and it builds an md5 of that and

276
00:10:27,279 --> 00:10:29,040
then it kind of does a crc on that and

277
00:10:29,040 --> 00:10:31,040
that's the installer man's password

278
00:10:31,040 --> 00:10:33,440
right so all he needs all i need to know

279
00:10:33,440 --> 00:10:35,760
is the serial number device and i know

280
00:10:35,760 --> 00:10:37,600
the installer's password for that device

281
00:10:37,600 --> 00:10:40,160
now it's like pre-computed via this tool

282
00:10:40,160 --> 00:10:41,600
so i'm like great this is an easy win

283
00:10:41,600 --> 00:10:43,839
for me

284
00:10:45,680 --> 00:10:48,000
okay so at this point i haven't i have a

285
00:10:48,000 --> 00:10:49,839
password i don't have access to the

286
00:10:49,839 --> 00:10:51,920
firmware images as far as i was able to

287
00:10:51,920 --> 00:10:53,040
make it without actually touching the

288
00:10:53,040 --> 00:10:55,120
device so now i'm okay now it's time

289
00:10:55,120 --> 00:10:57,200
let's get one of these and break it down

290
00:10:57,200 --> 00:10:59,200
um this is one i grabbed off of ebay

291
00:10:59,200 --> 00:11:00,800
it's sitting right here

292
00:11:00,800 --> 00:11:02,399
this box

293
00:11:02,399 --> 00:11:03,440
that picture's better so i'm going to

294
00:11:03,440 --> 00:11:06,640
show you that one before i jump to mine

295
00:11:06,640 --> 00:11:09,120
so there's this line across here

296
00:11:09,120 --> 00:11:11,040
and this line divides the high power

297
00:11:11,040 --> 00:11:13,360
side from the low power side so this is

298
00:11:13,360 --> 00:11:16,480
all you know 110

299
00:11:16,480 --> 00:11:18,720
and this all these down here this is for

300
00:11:18,720 --> 00:11:20,320
all your solar panels that are coming in

301
00:11:20,320 --> 00:11:21,680
to show how much consumption or

302
00:11:21,680 --> 00:11:23,040
production you're doing and then these

303
00:11:23,040 --> 00:11:25,200
are um for outbound things so to tell

304
00:11:25,200 --> 00:11:26,320
how much

305
00:11:26,320 --> 00:11:29,279
consumption you're doing as well so

306
00:11:29,279 --> 00:11:31,839
you wire this up in seoul in in parallel

307
00:11:31,839 --> 00:11:34,320
with your your home systems actually if

308
00:11:34,320 --> 00:11:36,640
you dare say in phase is actually really

309
00:11:36,640 --> 00:11:40,000
popular here in in utah do any of you

310
00:11:40,000 --> 00:11:41,600
have solar panel systems and like

311
00:11:41,600 --> 00:11:43,279
recognize like oh i have one of these

312
00:11:43,279 --> 00:11:45,200
anybody i got i see at least two a few

313
00:11:45,200 --> 00:11:46,720
hands out there yeah

314
00:11:46,720 --> 00:11:48,480
we'll talk about this because this is

315
00:11:48,480 --> 00:11:50,160
still an el sandy bug i've reported it

316
00:11:50,160 --> 00:11:52,160
to them but um

317
00:11:52,160 --> 00:11:54,079
they haven't done much about it

318
00:11:54,079 --> 00:11:56,320
um so this is this is the controller

319
00:11:56,320 --> 00:11:57,760
that's the high power side over here on

320
00:11:57,760 --> 00:12:00,959
this side we have this is a custom chip

321
00:12:00,959 --> 00:12:02,720
for tracking the power consumption this

322
00:12:02,720 --> 00:12:05,200
is the main processor which just runs

323
00:12:05,200 --> 00:12:06,959
the linux kernel this is the ram for

324
00:12:06,959 --> 00:12:08,560
that main processor it's got a battery

325
00:12:08,560 --> 00:12:11,839
backup ethernet port usb and then this

326
00:12:11,839 --> 00:12:14,240
is the wi-fi chip that goes with that so

327
00:12:14,240 --> 00:12:16,160
this is the whole system on the back

328
00:12:16,160 --> 00:12:17,760
side there's a chip or two more but

329
00:12:17,760 --> 00:12:20,959
they're they're really small um

330
00:12:20,959 --> 00:12:23,120
so

331
00:12:23,120 --> 00:12:25,519
yeah let's say i want that screen over

332
00:12:25,519 --> 00:12:27,760
there so you can see it

333
00:12:27,760 --> 00:12:29,760
okay so here's mine

334
00:12:29,760 --> 00:12:32,639
that same chip that same thing um for

335
00:12:32,639 --> 00:12:36,399
testing mine i basically just took

336
00:12:36,399 --> 00:12:38,800
a power cable

337
00:12:38,800 --> 00:12:40,399
just a regular outlet

338
00:12:40,399 --> 00:12:42,720
and cut it and spliced it and plugged it

339
00:12:42,720 --> 00:12:45,360
in right there which i'm sure it's not

340
00:12:45,360 --> 00:12:47,200
i'm sure it's not like osha compliant or

341
00:12:47,200 --> 00:12:49,279
anything there's just like 110 wires

342
00:12:49,279 --> 00:12:52,560
right there kind of exposed it is

343
00:12:52,560 --> 00:12:54,240
actually scary for me too when i plug it

344
00:12:54,240 --> 00:12:55,360
in sometimes i worry that they're going

345
00:12:55,360 --> 00:12:57,600
to touch but um not enough that i

346
00:12:57,600 --> 00:12:59,680
actually did anything about it

347
00:12:59,680 --> 00:13:01,040
so

348
00:13:01,040 --> 00:13:04,000
that's the device um but on there there

349
00:13:04,000 --> 00:13:07,040
were a few exposed debug pins that i

350
00:13:07,040 --> 00:13:08,480
noticed let's see if the camera's going

351
00:13:08,480 --> 00:13:10,959
to focus

352
00:13:11,519 --> 00:13:14,399
no it's not really focusing

353
00:13:14,399 --> 00:13:15,600
but right

354
00:13:15,600 --> 00:13:17,600
here i have some tweezers so i could

355
00:13:17,600 --> 00:13:20,600
point

356
00:13:22,000 --> 00:13:24,079
so right here you can see a set of

357
00:13:24,079 --> 00:13:26,320
jumpers there's this really tiny 10 pin

358
00:13:26,320 --> 00:13:28,240
here that's going to be the jtag

359
00:13:28,240 --> 00:13:30,800
interface and then there's four pins

360
00:13:30,800 --> 00:13:32,240
right here and i found that those are a

361
00:13:32,240 --> 00:13:33,839
uart interface so you've got like

362
00:13:33,839 --> 00:13:36,160
transmit receive ground and power right

363
00:13:36,160 --> 00:13:37,920
so these are these are attack surfaces

364
00:13:37,920 --> 00:13:40,240
that i have to interface with it while

365
00:13:40,240 --> 00:13:41,279
it's running

366
00:13:41,279 --> 00:13:42,959
but i'm getting ahead of myself before i

367
00:13:42,959 --> 00:13:44,480
talk about that let's

368
00:13:44,480 --> 00:13:46,839
i want to talk about top down when we

369
00:13:46,839 --> 00:13:49,360
do when we do pen test against type of

370
00:13:49,360 --> 00:13:51,839
things there's kind of an attack levels

371
00:13:51,839 --> 00:13:53,199
there's different levels of the device

372
00:13:53,199 --> 00:13:54,240
and different attacks you can make at

373
00:13:54,240 --> 00:13:56,399
each one so there's when the thing's

374
00:13:56,399 --> 00:13:58,240
first starting up like the boot levels

375
00:13:58,240 --> 00:14:00,000
until it's finally running

376
00:14:00,000 --> 00:14:01,440
and i'm going to talk about these from

377
00:14:01,440 --> 00:14:02,800
in reverse order

378
00:14:02,800 --> 00:14:05,680
because most people attack it yeah we do

379
00:14:05,680 --> 00:14:08,079
our attacks from running and then work

380
00:14:08,079 --> 00:14:10,240
backwards if we have to so the the

381
00:14:10,240 --> 00:14:12,000
highest level is when the

382
00:14:12,000 --> 00:14:14,000
linux kernels completely boot up and

383
00:14:14,000 --> 00:14:15,680
this the attacks that that are possible

384
00:14:15,680 --> 00:14:16,720
here are pretty much your attacks

385
00:14:16,720 --> 00:14:18,079
against any linux machine except for

386
00:14:18,079 --> 00:14:20,320
this is just a slight slightly smaller

387
00:14:20,320 --> 00:14:21,600
but if it's running telnet if it's

388
00:14:21,600 --> 00:14:23,920
running https if it's running ssh we're

389
00:14:23,920 --> 00:14:24,959
going to enumerate those see what

390
00:14:24,959 --> 00:14:26,079
software it's running if there's no

391
00:14:26,079 --> 00:14:27,440
vulnerabilities that's an easy win and

392
00:14:27,440 --> 00:14:29,680
we don't have to work any harder

393
00:14:29,680 --> 00:14:31,279
in this case

394
00:14:31,279 --> 00:14:33,360
the ssh was running telnet was not

395
00:14:33,360 --> 00:14:35,600
running and there is a web service but

396
00:14:35,600 --> 00:14:37,279
there wasn't any known vulnerabilities

397
00:14:37,279 --> 00:14:39,279
for anything that was out there

398
00:14:39,279 --> 00:14:41,199
we can also try to connect to those two

399
00:14:41,199 --> 00:14:43,600
ports i showed you the ur and the jtag

400
00:14:43,600 --> 00:14:45,839
the jtag in this case was disabled so

401
00:14:45,839 --> 00:14:47,600
it's a hardware disabled meaning as soon

402
00:14:47,600 --> 00:14:50,079
as they at some point it's either a fuse

403
00:14:50,079 --> 00:14:51,600
or something that they've

404
00:14:51,600 --> 00:14:53,360
programmed in there that that jtag is no

405
00:14:53,360 --> 00:14:54,959
longer responsive i can't communicate

406
00:14:54,959 --> 00:14:57,199
with it the uart however worked so i

407
00:14:57,199 --> 00:14:58,959
could read messages but it wouldn't

408
00:14:58,959 --> 00:15:00,800
accept any of my endpoint um the

409
00:15:00,800 --> 00:15:03,440
kernel's been told hey don't accept data

410
00:15:03,440 --> 00:15:05,360
from over the uart so i was like okay

411
00:15:05,360 --> 00:15:06,959
well those attacks don't work at this

412
00:15:06,959 --> 00:15:08,240
level i'm going to have to move up a

413
00:15:08,240 --> 00:15:09,760
level that's the process when it's

414
00:15:09,760 --> 00:15:11,680
booting right when it's booting if i can

415
00:15:11,680 --> 00:15:13,440
get kind of into single user mode if i

416
00:15:13,440 --> 00:15:15,279
can interrupt that kernel boot in any

417
00:15:15,279 --> 00:15:17,120
sort of way then i can do some other

418
00:15:17,120 --> 00:15:19,440
things um it's still even at boot it

419
00:15:19,440 --> 00:15:21,360
wouldn't accept anything of my uart and

420
00:15:21,360 --> 00:15:23,920
jtag is just for her hardware um

421
00:15:23,920 --> 00:15:25,839
disabled so at no point what's jtag

422
00:15:25,839 --> 00:15:27,120
available to me

423
00:15:27,120 --> 00:15:28,560
but if i could like get it to interrupt

424
00:15:28,560 --> 00:15:29,600
a command

425
00:15:29,600 --> 00:15:31,279
then i could get it to go to safe motor

426
00:15:31,279 --> 00:15:33,600
you know and it wouldn't do such a thing

427
00:15:33,600 --> 00:15:35,279
another attack at this level is called

428
00:15:35,279 --> 00:15:36,800
glitching so

429
00:15:36,800 --> 00:15:37,600
the

430
00:15:37,600 --> 00:15:40,480
on the device itself the eemc chip

431
00:15:40,480 --> 00:15:42,320
stores the linux kernel which is

432
00:15:42,320 --> 00:15:44,800
separate chip from the processor and

433
00:15:44,800 --> 00:15:46,639
what glitching is is you take those data

434
00:15:46,639 --> 00:15:48,560
lines in between there and you pull them

435
00:15:48,560 --> 00:15:50,639
to ground so when the kernel tries to

436
00:15:50,639 --> 00:15:54,160
read the root file system it errors out

437
00:15:54,160 --> 00:15:55,680
and you're hoping it's going to error

438
00:15:55,680 --> 00:15:57,279
out and give you some kind of like safe

439
00:15:57,279 --> 00:15:58,639
mode prompt like hey i can't mount the

440
00:15:58,639 --> 00:15:59,839
root file system what do you want me to

441
00:15:59,839 --> 00:16:01,519
do

442
00:16:01,519 --> 00:16:03,440
for an iot vendor

443
00:16:03,440 --> 00:16:05,759
what you want to do any iot type device

444
00:16:05,759 --> 00:16:08,000
if your file system is not where it's

445
00:16:08,000 --> 00:16:09,600
meant to be or you don't it doesn't find

446
00:16:09,600 --> 00:16:11,440
it you want it to just fail and panic

447
00:16:11,440 --> 00:16:12,720
you don't want it to try to give you

448
00:16:12,720 --> 00:16:14,160
backup options right it's not like your

449
00:16:14,160 --> 00:16:16,079
home pc where you're like oh let me just

450
00:16:16,079 --> 00:16:17,680
put in the backup drive if your

451
00:16:17,680 --> 00:16:19,839
hardware's not how you physically built

452
00:16:19,839 --> 00:16:21,519
it somebody's been mucking with and you

453
00:16:21,519 --> 00:16:23,279
should fail hard and that's what this

454
00:16:23,279 --> 00:16:25,440
vendor did so if i glitched it it would

455
00:16:25,440 --> 00:16:27,600
just say nope i'm not doing anything

456
00:16:27,600 --> 00:16:29,440
it's not what i expect and it panicked

457
00:16:29,440 --> 00:16:30,399
and that's then that's the right

458
00:16:30,399 --> 00:16:32,079
security response for a design like this

459
00:16:32,079 --> 00:16:34,079
so i had to look further up

460
00:16:34,079 --> 00:16:35,199
so

461
00:16:35,199 --> 00:16:37,040
understanding this this firmware this

462
00:16:37,040 --> 00:16:38,480
soc chip

463
00:16:38,480 --> 00:16:40,000
it's not

464
00:16:40,000 --> 00:16:42,160
um it's got a little bit of memory flash

465
00:16:42,160 --> 00:16:43,519
inside of it and that little bit of

466
00:16:43,519 --> 00:16:45,839
flash isn't very big it's not big enough

467
00:16:45,839 --> 00:16:48,399
to know how to mount an ext4 file system

468
00:16:48,399 --> 00:16:50,399
and it's not big enough to load a linux

469
00:16:50,399 --> 00:16:52,720
kernel in a memory so what it does is

470
00:16:52,720 --> 00:16:55,120
it's a little chip that will go read

471
00:16:55,120 --> 00:16:56,480
another trip

472
00:16:56,480 --> 00:16:58,160
like a little flash chip which is called

473
00:16:58,160 --> 00:17:00,560
which runs u-boot and u-boot is a little

474
00:17:00,560 --> 00:17:02,399
bit bigger it knows enough to be able to

475
00:17:02,399 --> 00:17:05,119
mount an ext4 file system so you boot

476
00:17:05,119 --> 00:17:08,000
like the intermediary step it will load

477
00:17:08,000 --> 00:17:11,280
up the ext4 file system it will find the

478
00:17:11,280 --> 00:17:13,359
linux kernel load that into memory and

479
00:17:13,359 --> 00:17:15,280
then pass execution to linux kernel

480
00:17:15,280 --> 00:17:17,760
that's the u-boot process

481
00:17:17,760 --> 00:17:19,520
but that when that runs it's got some

482
00:17:19,520 --> 00:17:21,199
environment variables that it passes to

483
00:17:21,199 --> 00:17:23,359
the kernel and by default it's like a

484
00:17:23,359 --> 00:17:24,880
three second delay when it starts up

485
00:17:24,880 --> 00:17:26,480
like it's got its own command prompt

486
00:17:26,480 --> 00:17:27,839
where you can interact with it or

487
00:17:27,839 --> 00:17:30,320
interact with the ext4 file system in

488
00:17:30,320 --> 00:17:32,960
fact uboot also supports tftp so like if

489
00:17:32,960 --> 00:17:34,799
it has an internet i could like oh go

490
00:17:34,799 --> 00:17:36,640
grab this kernel image from the internet

491
00:17:36,640 --> 00:17:38,559
and run that um so if i could get to

492
00:17:38,559 --> 00:17:39,919
that console then i could pretty much

493
00:17:39,919 --> 00:17:41,200
own the kernel and then i could pretty

494
00:17:41,200 --> 00:17:44,160
much own the device um however

495
00:17:44,160 --> 00:17:46,720
that three second default prompt um they

496
00:17:46,720 --> 00:17:48,799
disabled it there's environment settings

497
00:17:48,799 --> 00:17:50,720
that you has on its flash that tell it

498
00:17:50,720 --> 00:17:53,280
how to run and they disabled that um

499
00:17:53,280 --> 00:17:55,520
window i had to attack so if you just

500
00:17:55,520 --> 00:17:56,960
set it to zero then i don't have any

501
00:17:56,960 --> 00:17:58,480
chance to like press a key and interrupt

502
00:17:58,480 --> 00:18:00,400
the process

503
00:18:00,400 --> 00:18:02,400
that u-boot typically resides on an

504
00:18:02,400 --> 00:18:05,280
external flash and in this case it

505
00:18:05,280 --> 00:18:07,918
resides

506
00:18:08,240 --> 00:18:11,360
on that little well that's hard sort of

507
00:18:11,360 --> 00:18:13,360
see

508
00:18:13,360 --> 00:18:15,520
on this flash chip right

509
00:18:15,520 --> 00:18:16,799
there

510
00:18:16,799 --> 00:18:19,520
that's a little uh nor flash chip

511
00:18:19,520 --> 00:18:21,280
on the back side and it's just like a

512
00:18:21,280 --> 00:18:22,960
you know an 8 meg chip that holds the

513
00:18:22,960 --> 00:18:25,280
u-boot kernel

514
00:18:25,280 --> 00:18:27,760
so i could try to

515
00:18:27,760 --> 00:18:29,760
replace that firmware image or on that

516
00:18:29,760 --> 00:18:32,240
chip and that's one possible attack i'll

517
00:18:32,240 --> 00:18:33,679
come back to that

518
00:18:33,679 --> 00:18:34,960
and then

519
00:18:34,960 --> 00:18:36,880
even before u-boot starts i mentioned

520
00:18:36,880 --> 00:18:38,720
there's a little tiny bit of flash built

521
00:18:38,720 --> 00:18:41,360
in this is the arm system on a chip

522
00:18:41,360 --> 00:18:43,600
itself that flash is very small and all

523
00:18:43,600 --> 00:18:45,120
it knows how to do is go find this

524
00:18:45,120 --> 00:18:47,600
external flash and load up the u-boot

525
00:18:47,600 --> 00:18:50,160
kernel and jump to it um you can attack

526
00:18:50,160 --> 00:18:52,799
it here jtag if that's available or you

527
00:18:52,799 --> 00:18:54,960
can try to rewrite that flash that one

528
00:18:54,960 --> 00:18:57,440
is like the most dangerous and least um

529
00:18:57,440 --> 00:18:59,919
ideal option for an attack because if

530
00:18:59,919 --> 00:19:01,440
you screw that up you've just bricked

531
00:19:01,440 --> 00:19:03,200
the device right like these others are

532
00:19:03,200 --> 00:19:05,360
lower stages so you can have a second

533
00:19:05,360 --> 00:19:07,440
chance to catch them but if i mess this

534
00:19:07,440 --> 00:19:09,520
up i break the thing so that's not an

535
00:19:09,520 --> 00:19:12,240
attack i wanted to do instead i wanted

536
00:19:12,240 --> 00:19:14,880
to attack this u-boot and so what i'm

537
00:19:14,880 --> 00:19:16,240
going to do is i'm going to show you my

538
00:19:16,240 --> 00:19:18,240
toolkit for

539
00:19:18,240 --> 00:19:20,559
taking the data right off that chip um

540
00:19:20,559 --> 00:19:22,559
what i've got here

541
00:19:22,559 --> 00:19:24,559
is a

542
00:19:24,559 --> 00:19:26,720
tiggered board this is i'm not trying to

543
00:19:26,720 --> 00:19:30,000
sell any product but um a dude developed

544
00:19:30,000 --> 00:19:32,320
this board just for hardware hacking and

545
00:19:32,320 --> 00:19:33,919
what it does is it can act like a uart

546
00:19:33,919 --> 00:19:35,440
interface

547
00:19:35,440 --> 00:19:38,880
it can it fuzz spi bus it can do jtag it

548
00:19:38,880 --> 00:19:40,400
can do lots of cool

549
00:19:40,400 --> 00:19:42,400
techniques and so what i have is these

550
00:19:42,400 --> 00:19:44,160
little gator clips

551
00:19:44,160 --> 00:19:46,480
that's an eight pin gator clip and all i

552
00:19:46,480 --> 00:19:48,080
have to do

553
00:19:48,080 --> 00:19:51,360
is take this eight pin gator clip

554
00:19:51,360 --> 00:19:55,600
and clip it right on top of that sucker

555
00:19:55,760 --> 00:19:58,080
and now i'm connected to it

556
00:19:58,080 --> 00:19:59,200
um

557
00:19:59,200 --> 00:20:00,720
and now let's see if i can get a window

558
00:20:00,720 --> 00:20:03,120
over here

559
00:20:03,120 --> 00:20:07,840
okay desktop oh i gotta close that

560
00:20:13,280 --> 00:20:14,480
and then

561
00:20:14,480 --> 00:20:20,120
i just run as a command if i can find it

562
00:20:22,799 --> 00:20:24,640
there we go so basically i just say hey

563
00:20:24,640 --> 00:20:26,720
i've got this tigger board out here um i

564
00:20:26,720 --> 00:20:28,799
want you to read the ram off of this

565
00:20:28,799 --> 00:20:32,480
device and just drop it to flash.bin

566
00:20:32,480 --> 00:20:36,960
did that work reading flash

567
00:20:38,159 --> 00:20:41,760
boom should be done if i do an ls dash

568
00:20:41,760 --> 00:20:43,520
lsa

569
00:20:43,520 --> 00:20:45,919
flash dot bin

570
00:20:45,919 --> 00:20:49,640
i can't see what i'm typing

571
00:20:51,200 --> 00:20:53,760
oh yeah it's there and then let me open

572
00:20:53,760 --> 00:20:55,919
it in like a hex editor so we can kind

573
00:20:55,919 --> 00:20:58,880
of peek around at it

574
00:21:00,159 --> 00:21:03,840
how many times okay good

575
00:21:10,000 --> 00:21:13,200
open file

576
00:21:13,520 --> 00:21:16,400
where am i working at i'm oh i'm totally

577
00:21:16,400 --> 00:21:19,679
in the wrong spot but oh well

578
00:21:21,360 --> 00:21:22,320
okay

579
00:21:22,320 --> 00:21:23,520
actually i'm gonna

580
00:21:23,520 --> 00:21:25,039
i can't see that small so i'm gonna do

581
00:21:25,039 --> 00:21:26,159
it on this other window and then move it

582
00:21:26,159 --> 00:21:29,320
over there

583
00:21:48,000 --> 00:21:49,520
let me steal this one too see where i'm

584
00:21:49,520 --> 00:21:52,520
at

585
00:22:05,120 --> 00:22:07,679
all right i got this open now

586
00:22:07,679 --> 00:22:09,520
the first little bit of this data is the

587
00:22:09,520 --> 00:22:11,919
actual u-boot kernel so that's going to

588
00:22:11,919 --> 00:22:14,559
be arm assembly code we're just going to

589
00:22:14,559 --> 00:22:16,480
scroll past that actually what i'm going

590
00:22:16,480 --> 00:22:18,240
to do is i'm going to do a fine for a

591
00:22:18,240 --> 00:22:20,080
string

592
00:22:20,080 --> 00:22:23,480
that looks interesting

593
00:22:28,320 --> 00:22:29,280
there we go

594
00:22:29,280 --> 00:22:31,760
so here you can see this big old blob on

595
00:22:31,760 --> 00:22:34,640
this device of environment variables for

596
00:22:34,640 --> 00:22:36,640
the u-boot kernel and one of those in

597
00:22:36,640 --> 00:22:38,799
there right at the start is boot delay

598
00:22:38,799 --> 00:22:40,400
and it right now it's set to one because

599
00:22:40,400 --> 00:22:41,679
i've already broke this but the first

600
00:22:41,679 --> 00:22:43,360
time i pulled that it said boot delay

601
00:22:43,360 --> 00:22:45,679
equals zero and so all i needed to do is

602
00:22:45,679 --> 00:22:47,520
i changed that one variable on this

603
00:22:47,520 --> 00:22:50,080
device and then reflash this chip the

604
00:22:50,080 --> 00:22:51,360
next time it boots it's gonna give me

605
00:22:51,360 --> 00:22:53,039
that delay and then i can interact with

606
00:22:53,039 --> 00:22:54,640
it so that's all i did i just changed

607
00:22:54,640 --> 00:22:56,480
this one byte in this hex image and then

608
00:22:56,480 --> 00:22:59,200
used my same tool to re-flash that that

609
00:22:59,200 --> 00:23:01,600
chip and now i have

610
00:23:01,600 --> 00:23:03,600
a boot delay where i can interact with

611
00:23:03,600 --> 00:23:05,200
that device

612
00:23:05,200 --> 00:23:08,200
so

613
00:23:08,240 --> 00:23:10,720
bunker

614
00:23:15,760 --> 00:23:18,159
i want to do that live with you guys now

615
00:23:18,159 --> 00:23:21,200
that i have device

616
00:23:21,200 --> 00:23:23,840
this window

617
00:23:24,080 --> 00:23:26,480
so we'll flip this back over and i'm

618
00:23:26,480 --> 00:23:28,240
going to hook these back up

619
00:23:28,240 --> 00:23:30,720
let's see tx

620
00:23:30,720 --> 00:23:32,720
if i get these wrong

621
00:23:32,720 --> 00:23:36,200
i'll try again

622
00:23:44,799 --> 00:23:47,039
all right that's hooked up

623
00:23:47,039 --> 00:23:51,480
and then i just need to

624
00:24:04,720 --> 00:24:06,240
i'll move this window over so you can

625
00:24:06,240 --> 00:24:07,279
see what i'm oh you can't see them

626
00:24:07,279 --> 00:24:09,600
because that's in the way

627
00:24:09,600 --> 00:24:11,440
all right

628
00:24:11,440 --> 00:24:12,559
and

629
00:24:12,559 --> 00:24:17,000
make that bigger so we can all see

630
00:24:19,600 --> 00:24:20,400
and

631
00:24:20,400 --> 00:24:23,200
that should work

632
00:24:27,520 --> 00:24:31,080
if i get the right device

633
00:24:35,200 --> 00:24:38,880
okay so now i've got a uart usb device

634
00:24:38,880 --> 00:24:41,600
and i've hooked it up to this um

635
00:24:41,600 --> 00:24:43,360
solar panel controller

636
00:24:43,360 --> 00:24:45,200
now i need to do is plug the solar panel

637
00:24:45,200 --> 00:24:46,480
controller in

638
00:24:46,480 --> 00:24:49,919
and as long as my wires aren't touching

639
00:24:49,919 --> 00:24:52,880
nobody's going to get hurt

640
00:24:57,919 --> 00:24:59,520
okay that should start booting up but

641
00:24:59,520 --> 00:25:01,360
i'm not seeing any data so i guess i

642
00:25:01,360 --> 00:25:02,640
have

643
00:25:02,640 --> 00:25:06,120
my pins wrong

644
00:25:16,240 --> 00:25:18,240
oh you see stuff a little bit it's

645
00:25:18,240 --> 00:25:20,559
trying

646
00:25:24,559 --> 00:25:27,559
hmm

647
00:25:28,159 --> 00:25:29,520
i don't think i have a common ground

648
00:25:29,520 --> 00:25:32,240
give me a second

649
00:25:37,919 --> 00:25:41,640
still not quite there

650
00:25:42,720 --> 00:25:46,799
try again and i'll just reboot it

651
00:25:46,960 --> 00:25:48,240
yeah it should be

652
00:25:48,240 --> 00:25:51,360
oh did i not have the right number

653
00:25:51,360 --> 00:25:52,640
okay yes

654
00:25:52,640 --> 00:25:55,440
one one five oh you're right

655
00:25:55,440 --> 00:25:59,039
missed a zero thank you

656
00:26:00,960 --> 00:26:02,559
okay so now did i have the pins right

657
00:26:02,559 --> 00:26:05,879
the first time

658
00:26:18,000 --> 00:26:21,039
don't see anything yet

659
00:26:21,200 --> 00:26:22,559
oh we were getting something for a

660
00:26:22,559 --> 00:26:23,760
second

661
00:26:23,760 --> 00:26:25,279
okay good

662
00:26:25,279 --> 00:26:26,880
now i'm still too slow so we'll try it

663
00:26:26,880 --> 00:26:29,120
again

664
00:26:30,799 --> 00:26:32,400
all right so there it is if i press a

665
00:26:32,400 --> 00:26:36,840
key hold down keys i should

666
00:26:38,240 --> 00:26:40,559
what do we get

667
00:26:40,559 --> 00:26:44,080
there we go oh nope not yet

668
00:26:46,640 --> 00:26:48,559
so it's still booting okay hitting the

669
00:26:48,559 --> 00:26:49,600
key

670
00:26:49,600 --> 00:26:51,440
oh i didn't hit the nikki i'm too lazy

671
00:26:51,440 --> 00:26:53,200
low it's too slow try that again

672
00:26:53,200 --> 00:26:55,039
oh no it's not too slow i just forgot to

673
00:26:55,039 --> 00:26:58,640
hook up the tx line

674
00:26:59,360 --> 00:27:00,880
sorry guys it looks like a mess this is

675
00:27:00,880 --> 00:27:02,400
actually how it goes for me all the time

676
00:27:02,400 --> 00:27:04,640
um this is hardware hacking works like

677
00:27:04,640 --> 00:27:07,679
one tenth of the time

678
00:27:07,679 --> 00:27:09,120
but when it works that's all you need

679
00:27:09,120 --> 00:27:12,719
once right you only need to win once

680
00:27:12,960 --> 00:27:16,559
okay vice is booting

681
00:27:19,200 --> 00:27:21,679
okay so there now i've got this u-boot

682
00:27:21,679 --> 00:27:23,679
uh access to this device

683
00:27:23,679 --> 00:27:25,200
so with this

684
00:27:25,200 --> 00:27:26,480
um

685
00:27:26,480 --> 00:27:28,159
we're almost there yeah thank you for

686
00:27:28,159 --> 00:27:29,360
the applause

687
00:27:29,360 --> 00:27:31,760
it'll get better i promise um so once i

688
00:27:31,760 --> 00:27:34,640
have you boot access i can now read the

689
00:27:34,640 --> 00:27:38,000
emc chip which has the ext4 file system

690
00:27:38,000 --> 00:27:38,960
on it

691
00:27:38,960 --> 00:27:41,840
and so what i can do is

692
00:27:41,840 --> 00:27:44,320
let's just go read the shadow file off

693
00:27:44,320 --> 00:27:46,559
that disk so this command will say go to

694
00:27:46,559 --> 00:27:50,799
that emc ext4 emc chip and find the etsy

695
00:27:50,799 --> 00:27:52,880
shadow file and copy it into memory

696
00:27:52,880 --> 00:27:55,600
address 9000 or you know whatever that

697
00:27:55,600 --> 00:27:57,279
big number is i just chose something

698
00:27:57,279 --> 00:27:59,279
that i knew wouldn't corrupt any memory

699
00:27:59,279 --> 00:28:00,480
i need

700
00:28:00,480 --> 00:28:02,640
and then all i can say is just oh yeah

701
00:28:02,640 --> 00:28:04,320
show me the contents of that memory and

702
00:28:04,320 --> 00:28:06,640
so there now i know the root user's hash

703
00:28:06,640 --> 00:28:07,840
right like okay now i can just go

704
00:28:07,840 --> 00:28:09,360
through this at a cracking tool crack

705
00:28:09,360 --> 00:28:11,279
that and then i can ssh into the box

706
00:28:11,279 --> 00:28:13,039
unfortunately i never was able to crack

707
00:28:13,039 --> 00:28:14,159
that hash

708
00:28:14,159 --> 00:28:14,960
but

709
00:28:14,960 --> 00:28:16,399
it doesn't actually matter because i

710
00:28:16,399 --> 00:28:18,399
have a different way of getting in

711
00:28:18,399 --> 00:28:19,600
or at least i found a different way of

712
00:28:19,600 --> 00:28:22,320
getting in so i never got in with this

713
00:28:22,320 --> 00:28:23,120
but

714
00:28:23,120 --> 00:28:25,279
what i also could do is uh remember the

715
00:28:25,279 --> 00:28:26,880
firmware images that i couldn't get to

716
00:28:26,880 --> 00:28:29,120
before

717
00:28:29,120 --> 00:28:31,760
there's the ee tool on that ext4

718
00:28:31,760 --> 00:28:34,000
file system all i need to do is load

719
00:28:34,000 --> 00:28:35,919
that into memory and then i just hex

720
00:28:35,919 --> 00:28:38,799
dump that tool and then i can basically

721
00:28:38,799 --> 00:28:41,919
just dxd like xxd reverse right and then

722
00:28:41,919 --> 00:28:46,320
i got the ee tool out of memory

723
00:28:46,320 --> 00:28:48,559
so let's go back to my slides then and

724
00:28:48,559 --> 00:28:52,080
pick back up where we left off

725
00:28:53,520 --> 00:28:55,440
so yeah we pulled the flash

726
00:28:55,440 --> 00:28:57,760
so here's basically what we talked about

727
00:28:57,760 --> 00:28:59,919
i now have that ee crypt i can just

728
00:28:59,919 --> 00:29:02,000
reverse the ee crypt and see okay how do

729
00:29:02,000 --> 00:29:04,240
you decrypt those images and we see what

730
00:29:04,240 --> 00:29:06,000
what i found is it does it has a

731
00:29:06,000 --> 00:29:08,080
hard-coded password or rather it does

732
00:29:08,080 --> 00:29:09,840
aes decryption i was like great i just

733
00:29:09,840 --> 00:29:11,679
got to find the key

734
00:29:11,679 --> 00:29:13,360
but i think they knew better than like

735
00:29:13,360 --> 00:29:16,000
well we shouldn't put an uh aes key

736
00:29:16,000 --> 00:29:18,240
hardcoded in the binary so instead what

737
00:29:18,240 --> 00:29:20,399
they did is this funky hash routine

738
00:29:20,399 --> 00:29:23,120
where they have these strings these four

739
00:29:23,120 --> 00:29:25,279
one two three four five six blocks five

740
00:29:25,279 --> 00:29:27,600
blocks and they hash them in different

741
00:29:27,600 --> 00:29:29,919
orders they're like hash block one two

742
00:29:29,919 --> 00:29:32,399
three four and three two one two three

743
00:29:32,399 --> 00:29:34,880
like they hash these and then that hash

744
00:29:34,880 --> 00:29:36,799
is the password so it's like we didn't

745
00:29:36,799 --> 00:29:38,960
hard code the key we just hard coded how

746
00:29:38,960 --> 00:29:41,360
you come up with the key in the binary

747
00:29:41,360 --> 00:29:44,000
it's like you didn't really win anything

748
00:29:44,000 --> 00:29:46,080
i still know your password or i still

749
00:29:46,080 --> 00:29:47,679
know your key and sure enough with the

750
00:29:47,679 --> 00:29:48,960
key i could then decrypt all the

751
00:29:48,960 --> 00:29:51,120
firmware images or now that i have this

752
00:29:51,120 --> 00:29:52,480
tool i can just run this tool and have

753
00:29:52,480 --> 00:29:54,559
it decrypt the images either way i still

754
00:29:54,559 --> 00:29:56,320
have your firmware images so this is

755
00:29:56,320 --> 00:30:00,000
slide like 1920 now and that's where i

756
00:30:00,000 --> 00:30:02,000
typically want to be i now have firmware

757
00:30:02,000 --> 00:30:04,000
access i can read the firmware to look

758
00:30:04,000 --> 00:30:06,159
for other vulnerabilities

759
00:30:06,159 --> 00:30:08,000
and so the fact that they encrypted

760
00:30:08,000 --> 00:30:09,360
their firmware and didn't provide them

761
00:30:09,360 --> 00:30:10,559
unencrypted

762
00:30:10,559 --> 00:30:12,399
what slowed me down 20 slides so that's

763
00:30:12,399 --> 00:30:14,799
that's pretty good um

764
00:30:14,799 --> 00:30:16,080
because as soon as i have the firmware

765
00:30:16,080 --> 00:30:18,320
images i could go look at the web pages

766
00:30:18,320 --> 00:30:20,399
and immediately it took me like less

767
00:30:20,399 --> 00:30:22,480
than an hour having access to this

768
00:30:22,480 --> 00:30:24,240
i find my first

769
00:30:24,240 --> 00:30:26,480
unsanitized user input on their website

770
00:30:26,480 --> 00:30:28,640
this is a upgrade function

771
00:30:28,640 --> 00:30:32,080
function upgrade start and you see here

772
00:30:32,080 --> 00:30:34,799
it takes arguments that are passed from

773
00:30:34,799 --> 00:30:37,200
the user so i could just

774
00:30:37,200 --> 00:30:40,320
argument pipe run a command and it would

775
00:30:40,320 --> 00:30:43,360
execute it so now using that i have

776
00:30:43,360 --> 00:30:45,679
command execution on the box

777
00:30:45,679 --> 00:30:48,080
however it's through this rce and i'd

778
00:30:48,080 --> 00:30:50,320
rather like to have like ssh access to

779
00:30:50,320 --> 00:30:52,559
the box i'd like to have a full terminal

780
00:30:52,559 --> 00:30:54,559
something easier to work with than this

781
00:30:54,559 --> 00:30:56,480
command line thing where i don't get to

782
00:30:56,480 --> 00:30:58,320
see it's blind right i don't see the

783
00:30:58,320 --> 00:30:59,919
output of my commands

784
00:30:59,919 --> 00:31:01,120
so

785
00:31:01,120 --> 00:31:03,279
i wanted the root user so what i did i

786
00:31:03,279 --> 00:31:05,120
couldn't crack that password i just ran

787
00:31:05,120 --> 00:31:07,279
you know changed the user's password and

788
00:31:07,279 --> 00:31:08,720
so i changed the root user's password

789
00:31:08,720 --> 00:31:10,320
and then tried to ssh in and i still

790
00:31:10,320 --> 00:31:11,840
failed it still wouldn't let me in it's

791
00:31:11,840 --> 00:31:13,919
like i know i just changed that password

792
00:31:13,919 --> 00:31:15,840
why are you not letting me ssh into this

793
00:31:15,840 --> 00:31:17,760
box so i started looking around the

794
00:31:17,760 --> 00:31:19,440
firmware and seeing what's going on and

795
00:31:19,440 --> 00:31:21,440
i see that they have their custom

796
00:31:21,440 --> 00:31:24,000
a custom pam module installed so if

797
00:31:24,000 --> 00:31:25,840
you're familiar with linux pam is the

798
00:31:25,840 --> 00:31:28,000
authentication portion of

799
00:31:28,000 --> 00:31:29,679
linux and you can write your own modules

800
00:31:29,679 --> 00:31:31,519
to do your own authentication and that's

801
00:31:31,519 --> 00:31:33,519
what they did what they did is they

802
00:31:33,519 --> 00:31:35,679
hooked all authentication even the ssh

803
00:31:35,679 --> 00:31:38,240
user authentication and basically if

804
00:31:38,240 --> 00:31:40,000
it's one of these type of methods the

805
00:31:40,000 --> 00:31:42,480
password verbose or public or mobile

806
00:31:42,480 --> 00:31:44,159
mobile being the same method we saw

807
00:31:44,159 --> 00:31:46,799
before then it runs its own routine and

808
00:31:46,799 --> 00:31:48,640
you have to match its routine so it

809
00:31:48,640 --> 00:31:50,640
didn't even matter what was in that etsy

810
00:31:50,640 --> 00:31:52,399
shadow file it's never even checked

811
00:31:52,399 --> 00:31:53,519
against that that's why when i was

812
00:31:53,519 --> 00:31:56,000
changing the password it never mattered

813
00:31:56,000 --> 00:31:59,120
it has to match what this thing does

814
00:31:59,120 --> 00:32:02,080
and this thing all it does is it takes

815
00:32:02,080 --> 00:32:03,519
the username

816
00:32:03,519 --> 00:32:04,799
and it says username at

817
00:32:04,799 --> 00:32:06,720
endphaseenergy.com

818
00:32:06,720 --> 00:32:08,080
um

819
00:32:08,080 --> 00:32:11,039
serial number and that end phase energy

820
00:32:11,039 --> 00:32:13,200
string and funky case it builds another

821
00:32:13,200 --> 00:32:15,840
string computes an md5 of that string

822
00:32:15,840 --> 00:32:18,960
and that md5 hash is your password

823
00:32:18,960 --> 00:32:20,000
so

824
00:32:20,000 --> 00:32:21,919
the the this

825
00:32:21,919 --> 00:32:24,000
this is weird to me um

826
00:32:24,000 --> 00:32:26,080
because it first off this is really bad

827
00:32:26,080 --> 00:32:28,080
um this is not a good idea the reason

828
00:32:28,080 --> 00:32:30,640
being is you cannot change your password

829
00:32:30,640 --> 00:32:32,240
right like i try changing your my

830
00:32:32,240 --> 00:32:33,760
password and i cannot the password is

831
00:32:33,760 --> 00:32:36,240
hard-coded because of this routine

832
00:32:36,240 --> 00:32:38,399
and worst off is now that i know how

833
00:32:38,399 --> 00:32:40,080
it's generated

834
00:32:40,080 --> 00:32:41,600
all i need is the serial number for a

835
00:32:41,600 --> 00:32:44,159
device and i know every single password

836
00:32:44,159 --> 00:32:45,919
to that device i know each of the

837
00:32:45,919 --> 00:32:47,200
different logins because they all use

838
00:32:47,200 --> 00:32:48,640
the same routine

839
00:32:48,640 --> 00:32:51,360
um and what this feels like to me is

840
00:32:51,360 --> 00:32:53,360
they knew oh we can't just have one

841
00:32:53,360 --> 00:32:54,720
password for everything we have to have

842
00:32:54,720 --> 00:32:56,640
a unique password for each device right

843
00:32:56,640 --> 00:32:58,880
one password's a bad idea so like they

844
00:32:58,880 --> 00:33:00,559
knew they had a problem

845
00:33:00,559 --> 00:33:02,640
but their solution

846
00:33:02,640 --> 00:33:05,840
actually made the problem worse

847
00:33:05,840 --> 00:33:08,880
and that's that like these three cves

848
00:33:08,880 --> 00:33:11,360
all came from that one module like you

849
00:33:11,360 --> 00:33:13,039
tried to fix one problem and you made

850
00:33:13,039 --> 00:33:14,399
three

851
00:33:14,399 --> 00:33:15,679
um

852
00:33:15,679 --> 00:33:17,679
and this is i don't know i don't want to

853
00:33:17,679 --> 00:33:19,919
hash this too much but um hard-coded

854
00:33:19,919 --> 00:33:22,559
password can't be changed um and it's

855
00:33:22,559 --> 00:33:24,559
derived from the serial number and the

856
00:33:24,559 --> 00:33:26,480
username so really all i need is the

857
00:33:26,480 --> 00:33:28,720
username which i know root right uh the

858
00:33:28,720 --> 00:33:31,200
serial number that's the last piece so

859
00:33:31,200 --> 00:33:33,519
how do i get the serial number well

860
00:33:33,519 --> 00:33:35,679
um it's on this board in three different

861
00:33:35,679 --> 00:33:38,240
spots there in red

862
00:33:38,240 --> 00:33:39,600
that means you have to physical access

863
00:33:39,600 --> 00:33:41,600
that's no fun it's also on the back of

864
00:33:41,600 --> 00:33:43,360
the case

865
00:33:43,360 --> 00:33:44,960
it's on the bottom of the box so it's

866
00:33:44,960 --> 00:33:47,519
right here it's also right there

867
00:33:47,519 --> 00:33:49,279
there's pictures online of like even

868
00:33:49,279 --> 00:33:50,480
there even on their site they have

869
00:33:50,480 --> 00:33:51,760
pictures and the serial number is

870
00:33:51,760 --> 00:33:53,919
clearly visible for the device

871
00:33:53,919 --> 00:33:55,120
if that's not good enough it's on the

872
00:33:55,120 --> 00:33:56,559
inside of the service panel on your

873
00:33:56,559 --> 00:33:57,760
house

874
00:33:57,760 --> 00:34:00,799
it's on the shipping box so it's there

875
00:34:00,799 --> 00:34:02,559
and then if you don't have physical

876
00:34:02,559 --> 00:34:05,919
access it's also on this xml page um

877
00:34:05,919 --> 00:34:08,560
it's also on the home page and it's in

878
00:34:08,560 --> 00:34:11,440
the title bar like if you couldn't find

879
00:34:11,440 --> 00:34:14,239
it we made sure you could find it it's

880
00:34:14,239 --> 00:34:16,000
everywhere so

881
00:34:16,000 --> 00:34:18,960
with that like if you do oh so my model

882
00:34:18,960 --> 00:34:20,399
my model is a pretty lame one but there

883
00:34:20,399 --> 00:34:22,960
are models that have uh cellular access

884
00:34:22,960 --> 00:34:24,560
which means they're out there on the web

885
00:34:24,560 --> 00:34:26,639
right like i can do a soda and search

886
00:34:26,639 --> 00:34:28,719
and find these models out there and i

887
00:34:28,719 --> 00:34:30,480
know their serial number just by going

888
00:34:30,480 --> 00:34:32,159
to this one site so like i that

889
00:34:32,159 --> 00:34:33,760
potentially could

890
00:34:33,760 --> 00:34:35,679
hack it and get in the box

891
00:34:35,679 --> 00:34:36,399
so

892
00:34:36,399 --> 00:34:38,320
what should we do like what's the threat

893
00:34:38,320 --> 00:34:39,839
so what you hack my solar panel

894
00:34:39,839 --> 00:34:41,199
controller what you're gonna do build it

895
00:34:41,199 --> 00:34:43,119
like a ddos out of it like yeah that

896
00:34:43,119 --> 00:34:44,480
that's probably what script kitties

897
00:34:44,480 --> 00:34:45,839
would do

898
00:34:45,839 --> 00:34:46,719
um

899
00:34:46,719 --> 00:34:48,399
um one thing i noticed is that there's

900
00:34:48,399 --> 00:34:50,560
also this ability for the box to build a

901
00:34:50,560 --> 00:34:52,399
connection and when you when you click

902
00:34:52,399 --> 00:34:54,879
this um connect to interface support the

903
00:34:54,879 --> 00:34:58,320
box makes a vpn tunnel into in phases

904
00:34:58,320 --> 00:35:00,800
network and so they also have i mean

905
00:35:00,800 --> 00:35:02,320
it's a two-way tunnel right so you have

906
00:35:02,320 --> 00:35:03,760
a tunnel in their network but that means

907
00:35:03,760 --> 00:35:05,520
they also have a tunnel into your home

908
00:35:05,520 --> 00:35:07,599
network which was like whoa i don't

909
00:35:07,599 --> 00:35:09,839
think i like you having ssh access to my

910
00:35:09,839 --> 00:35:11,599
house thank you very much

911
00:35:11,599 --> 00:35:13,599
so that was a big alert i never actually

912
00:35:13,599 --> 00:35:15,359
seen how much access we have to their

913
00:35:15,359 --> 00:35:16,960
network i didn't want to get in any

914
00:35:16,960 --> 00:35:19,200
legal trouble this was a home project so

915
00:35:19,200 --> 00:35:20,880
i wasn't being paid by them so i wasn't

916
00:35:20,880 --> 00:35:24,079
going to step over any boundaries

917
00:35:24,079 --> 00:35:25,760
but when i was looking at the box

918
00:35:25,760 --> 00:35:28,000
something really caught my eye and that

919
00:35:28,000 --> 00:35:29,839
is these things called solar renewable

920
00:35:29,839 --> 00:35:32,640
credits so in some states not utah um

921
00:35:32,640 --> 00:35:34,800
you can sign up for credits right and

922
00:35:34,800 --> 00:35:37,119
then you get credits based on how much

923
00:35:37,119 --> 00:35:39,440
clean energy you produce you can then

924
00:35:39,440 --> 00:35:41,839
sell these credits to corporations that

925
00:35:41,839 --> 00:35:43,280
have to meet a certain amount of clean

926
00:35:43,280 --> 00:35:46,320
energy quota right and this device is

927
00:35:46,320 --> 00:35:48,880
the thing that decides how much energy

928
00:35:48,880 --> 00:35:50,480
you create

929
00:35:50,480 --> 00:35:52,160
so

930
00:35:52,160 --> 00:35:54,240
you see in january i really started to

931
00:35:54,240 --> 00:35:56,800
get in on this clean energy i really was

932
00:35:56,800 --> 00:36:01,280
a big fan um yeah 9 000 kilowatts of

933
00:36:01,280 --> 00:36:03,359
solar energy and their system was just

934
00:36:03,359 --> 00:36:05,520
like oh yeah he's totally got 1200 solar

935
00:36:05,520 --> 00:36:07,200
panels on his little roof yeah that's

936
00:36:07,200 --> 00:36:10,160
good and i was like oh no let's not why

937
00:36:10,160 --> 00:36:12,240
stop there

938
00:36:12,240 --> 00:36:14,400
let's generate a whole bolt of lightning

939
00:36:14,400 --> 00:36:16,400
right like let's let's go to town and

940
00:36:16,400 --> 00:36:18,640
sure enough there was nothing stopping

941
00:36:18,640 --> 00:36:20,000
no i didn't actually sign up for the

942
00:36:20,000 --> 00:36:21,440
credits so i didn't get a buttload of

943
00:36:21,440 --> 00:36:22,400
credit so i didn't want to get in

944
00:36:22,400 --> 00:36:24,480
trouble but i would hope there's some

945
00:36:24,480 --> 00:36:27,280
kind of sanity piece in there between

946
00:36:27,280 --> 00:36:29,359
the amount the user says they generate

947
00:36:29,359 --> 00:36:31,520
and how many credits you actually get

948
00:36:31,520 --> 00:36:34,160
because if that was possible i mean

949
00:36:34,160 --> 00:36:36,000
i don't even know what kind of acreage

950
00:36:36,000 --> 00:36:37,760
i'd need to generate that much power

951
00:36:37,760 --> 00:36:39,680
maybe somebody's a little bit more solar

952
00:36:39,680 --> 00:36:41,839
aware than i am could could tell me yeah

953
00:36:41,839 --> 00:36:44,079
you'd need like the whole state of utah

954
00:36:44,079 --> 00:36:46,000
i don't know but that's a whole lot of

955
00:36:46,000 --> 00:36:48,400
power for my one little home solar unit

956
00:36:48,400 --> 00:36:50,720
to be producing

957
00:36:50,720 --> 00:36:51,760
so

958
00:36:51,760 --> 00:36:53,599
prologue

959
00:36:53,599 --> 00:36:55,599
i found this vulnerability last

960
00:36:55,599 --> 00:36:58,320
september about a year ago i reached out

961
00:36:58,320 --> 00:37:00,000
to the vendor actually i phoned it found

962
00:37:00,000 --> 00:37:02,240
in august i reached out in september i

963
00:37:02,240 --> 00:37:03,440
told them hey

964
00:37:03,440 --> 00:37:06,000
i'm not after money i'm not ransomware i

965
00:37:06,000 --> 00:37:07,520
just have these vulnerabilities i'm a

966
00:37:07,520 --> 00:37:08,480
hobbyist

967
00:37:08,480 --> 00:37:10,800
and you've got these problems

968
00:37:10,800 --> 00:37:12,960
and then that that the conversation is

969
00:37:12,960 --> 00:37:14,320
always a little awkward right because

970
00:37:14,320 --> 00:37:16,640
they're like like i'm always like oh i

971
00:37:16,640 --> 00:37:18,800
know people right i don't want to name

972
00:37:18,800 --> 00:37:20,079
names here but i know people that are at

973
00:37:20,079 --> 00:37:22,000
this conference who have tried to reach

974
00:37:22,000 --> 00:37:22,960
out to a vendor when they found a

975
00:37:22,960 --> 00:37:24,640
vulnerability and the vendor sticks

976
00:37:24,640 --> 00:37:26,079
legal on them and right like cease and

977
00:37:26,079 --> 00:37:27,760
desist

978
00:37:27,760 --> 00:37:29,440
and so when i do this when i release

979
00:37:29,440 --> 00:37:31,119
this i also say oh by the way i've

980
00:37:31,119 --> 00:37:33,119
already told nist so go ahead and try to

981
00:37:33,119 --> 00:37:35,920
shut me down but it's out there right um

982
00:37:35,920 --> 00:37:37,599
i've got a third neutral party that

983
00:37:37,599 --> 00:37:39,599
knows about these bugs as well so i told

984
00:37:39,599 --> 00:37:42,400
them i told them i told nist and i said

985
00:37:42,400 --> 00:37:44,160
we typically like i'm not after money

986
00:37:44,160 --> 00:37:46,079
i'm not everything please fix these bugs

987
00:37:46,079 --> 00:37:47,359
i'm gonna talk about them in

988
00:37:47,359 --> 00:37:50,640
presentations in six months so hopefully

989
00:37:50,640 --> 00:37:52,160
you can fix them by then that's all

990
00:37:52,160 --> 00:37:52,960
that's

991
00:37:52,960 --> 00:37:55,040
that's all that we're gonna go with this

992
00:37:55,040 --> 00:37:56,480
um it took a little while to get the

993
00:37:56,480 --> 00:37:58,240
right contact on their site right like

994
00:37:58,240 --> 00:37:59,520
all their site had was like the tech

995
00:37:59,520 --> 00:38:00,640
support and the tech support like who

996
00:38:00,640 --> 00:38:02,400
the heck are you but i got the right guy

997
00:38:02,400 --> 00:38:03,599
they said thank you very much we'll get

998
00:38:03,599 --> 00:38:04,720
these fixed

999
00:38:04,720 --> 00:38:07,280
and then in january i send them a

1000
00:38:07,280 --> 00:38:08,960
follow-up said hey rsa is like three

1001
00:38:08,960 --> 00:38:10,079
months away i'm going to talk about

1002
00:38:10,079 --> 00:38:11,200
these are going to fix this and they're

1003
00:38:11,200 --> 00:38:12,480
like oh yeah we'll have them fixed by

1004
00:38:12,480 --> 00:38:14,160
may we're going to release a fix in

1005
00:38:14,160 --> 00:38:15,200
april

1006
00:38:15,200 --> 00:38:16,720
then in april i send them another email

1007
00:38:16,720 --> 00:38:18,400
like hey i'm gonna talk about this next

1008
00:38:18,400 --> 00:38:19,280
month

1009
00:38:19,280 --> 00:38:20,960
i didn't hear back

1010
00:38:20,960 --> 00:38:22,800
and then in may i was like okay i'm

1011
00:38:22,800 --> 00:38:24,400
talking about them tomorrow

1012
00:38:24,400 --> 00:38:26,000
i still haven't heard back like they

1013
00:38:26,000 --> 00:38:27,680
just went cold on me i was like fine

1014
00:38:27,680 --> 00:38:29,520
like i'm gonna bring these public

1015
00:38:29,520 --> 00:38:30,400
um

1016
00:38:30,400 --> 00:38:33,200
i've been watching that aws repo there

1017
00:38:33,200 --> 00:38:35,119
has been updates to it but none of them

1018
00:38:35,119 --> 00:38:37,839
have addressed my bugs however they did

1019
00:38:37,839 --> 00:38:41,200
add this additional web page and they

1020
00:38:41,200 --> 00:38:43,599
put ip they turned iptables on on the

1021
00:38:43,599 --> 00:38:46,960
device so the ssh port isn't accessible

1022
00:38:46,960 --> 00:38:48,720
to you on your home network anymore it's

1023
00:38:48,720 --> 00:38:50,560
only accessible to them on that vpn

1024
00:38:50,560 --> 00:38:52,560
tunnel if they build that

1025
00:38:52,560 --> 00:38:54,880
however there's this website there's

1026
00:38:54,880 --> 00:38:58,800
this webpage um that's called

1027
00:38:58,800 --> 00:39:01,040
ip uh that's called uh

1028
00:39:01,040 --> 00:39:03,599
oh what is it what is the website page

1029
00:39:03,599 --> 00:39:04,880
url

1030
00:39:04,880 --> 00:39:06,400
i forget what it's called it's something

1031
00:39:06,400 --> 00:39:07,440
like

1032
00:39:07,440 --> 00:39:08,960
services

1033
00:39:08,960 --> 00:39:11,839
iptables and this code is what it does

1034
00:39:11,839 --> 00:39:13,599
and basically this code checks how long

1035
00:39:13,599 --> 00:39:15,280
the machine's been on and if the

1036
00:39:15,280 --> 00:39:16,880
machine's been on less than five minutes

1037
00:39:16,880 --> 00:39:18,960
and you hit this url it turns off ib

1038
00:39:18,960 --> 00:39:20,320
tables for you

1039
00:39:20,320 --> 00:39:22,560
so they like just they put the security

1040
00:39:22,560 --> 00:39:24,240
measure in and then they backdoored it

1041
00:39:24,240 --> 00:39:26,480
and it's like well okay i can i can

1042
00:39:26,480 --> 00:39:28,160
reboot the device that's easy for me to

1043
00:39:28,160 --> 00:39:30,400
do remotely right like i have login

1044
00:39:30,400 --> 00:39:32,720
creds to the web panel i just reboot the

1045
00:39:32,720 --> 00:39:34,720
device and then i can assist into the

1046
00:39:34,720 --> 00:39:37,200
box so they're fixed like they still

1047
00:39:37,200 --> 00:39:39,280
don't understand this security thing i i

1048
00:39:39,280 --> 00:39:41,359
don't know how to help them um

1049
00:39:41,359 --> 00:39:42,560
especially if they don't want to talk to

1050
00:39:42,560 --> 00:39:44,000
me

1051
00:39:44,000 --> 00:39:45,200
about it

1052
00:39:45,200 --> 00:39:46,400
so

1053
00:39:46,400 --> 00:39:48,480
i checked last week i pulled my i

1054
00:39:48,480 --> 00:39:49,920
plugged this device in hooked it to the

1055
00:39:49,920 --> 00:39:51,520
internet hope there was like a firmware

1056
00:39:51,520 --> 00:39:53,760
update there is no firmware update so

1057
00:39:53,760 --> 00:39:56,000
you guys have these at home um i've got

1058
00:39:56,000 --> 00:39:57,200
a blog if you want to come reach me

1059
00:39:57,200 --> 00:39:58,480
afterward i can tell you what you need

1060
00:39:58,480 --> 00:39:59,280
to do

1061
00:39:59,280 --> 00:40:00,880
i can give you a script if you want to

1062
00:40:00,880 --> 00:40:02,480
like ssh into your home box and just

1063
00:40:02,480 --> 00:40:04,079
kind of peek around it's yours right you

1064
00:40:04,079 --> 00:40:05,920
can do what you want with it but um i

1065
00:40:05,920 --> 00:40:07,280
wouldn't recommend you you break it

1066
00:40:07,280 --> 00:40:09,359
because that is is a profit point for

1067
00:40:09,359 --> 00:40:10,400
you guys right

1068
00:40:10,400 --> 00:40:11,440
um

1069
00:40:11,440 --> 00:40:14,880
but ins in in overall

1070
00:40:14,880 --> 00:40:17,200
i feel like these guys broke the one

1071
00:40:17,200 --> 00:40:19,040
rule for crypto and that's never roll

1072
00:40:19,040 --> 00:40:21,040
your own crypto right like oh we've got

1073
00:40:21,040 --> 00:40:22,640
this password problem i know i'm going

1074
00:40:22,640 --> 00:40:24,560
to come up with my own solution

1075
00:40:24,560 --> 00:40:26,400
um if you guys are developed something

1076
00:40:26,400 --> 00:40:28,000
you're probably not the first ones to

1077
00:40:28,000 --> 00:40:30,800
have that problem right like look around

1078
00:40:30,800 --> 00:40:32,319
see what other people have done yeah

1079
00:40:32,319 --> 00:40:33,920
it's a bad idea to have one password for

1080
00:40:33,920 --> 00:40:35,520
everything but it's the even worse idea

1081
00:40:35,520 --> 00:40:36,880
to hard code a password that nobody can

1082
00:40:36,880 --> 00:40:37,920
change

1083
00:40:37,920 --> 00:40:38,720
you

1084
00:40:38,720 --> 00:40:40,319
if you have this device at home you

1085
00:40:40,319 --> 00:40:42,319
can't change your password to fix this

1086
00:40:42,319 --> 00:40:43,920
you have to like manage it with

1087
00:40:43,920 --> 00:40:45,760
firewalls because the device itself is

1088
00:40:45,760 --> 00:40:47,760
fighting you it won't let you secure it

1089
00:40:47,760 --> 00:40:49,200
and which is really this is really

1090
00:40:49,200 --> 00:40:51,040
disappointing

1091
00:40:51,040 --> 00:40:52,960
um i think i've i've actually got a

1092
00:40:52,960 --> 00:40:54,960
little bit of time i ran faster

1093
00:40:54,960 --> 00:40:56,800
than i thought it would despite all my

1094
00:40:56,800 --> 00:40:59,520
troubles do you guys have questions or

1095
00:40:59,520 --> 00:41:01,599
comments or things you want to discuss

1096
00:41:01,599 --> 00:41:03,119
i'd be more than happy to talk about

1097
00:41:03,119 --> 00:41:04,400
them um if you want to talk about it

1098
00:41:04,400 --> 00:41:07,839
private you can too yes

1099
00:41:11,920 --> 00:41:14,000
wow okay it's not as much as i thought

1100
00:41:14,000 --> 00:41:16,640
it would take three 3.4 acres guys we

1101
00:41:16,640 --> 00:41:18,079
let's go out to farmington we can make

1102
00:41:18,079 --> 00:41:20,480
that work

1103
00:41:20,480 --> 00:41:22,720
all right in one year oh in one year

1104
00:41:22,720 --> 00:41:24,480
that's the catch right like i just did

1105
00:41:24,480 --> 00:41:26,780
mine i was doing that continuously like

1106
00:41:26,780 --> 00:41:29,960
[Laughter]

1107
00:41:31,599 --> 00:41:34,480
thank you 15 square miles

1108
00:41:34,480 --> 00:41:36,240
of solar panels that's a lot of solar

1109
00:41:36,240 --> 00:41:38,560
panels and infrastructure to manage it

1110
00:41:38,560 --> 00:41:40,319
thank you

1111
00:41:40,319 --> 00:41:44,000
any any other questions or comments

1112
00:41:45,200 --> 00:41:49,399
all right oh there's one

1113
00:41:53,119 --> 00:41:55,920
yes so i guess i didn't bring that

1114
00:41:55,920 --> 00:41:57,760
i didn't make that very clear his point

1115
00:41:57,760 --> 00:41:59,599
was can't people use this to lunge or

1116
00:41:59,599 --> 00:42:02,960
monday yes that is a huge vulnerability

1117
00:42:02,960 --> 00:42:04,880
in my book right like worse than all the

1118
00:42:04,880 --> 00:42:06,960
others the fact that this can be used to

1119
00:42:06,960 --> 00:42:08,960
to launder money i i think it can i

1120
00:42:08,960 --> 00:42:10,400
haven't actually tested it but it

1121
00:42:10,400 --> 00:42:11,680
appears to be set up that people can

1122
00:42:11,680 --> 00:42:13,599
launder money i and i agree i would

1123
00:42:13,599 --> 00:42:15,599
think that they would be very concerned

1124
00:42:15,599 --> 00:42:18,079
about that um there are the code that

1125
00:42:18,079 --> 00:42:20,319
they use to report

1126
00:42:20,319 --> 00:42:23,200
how much power consumption you do back

1127
00:42:23,200 --> 00:42:25,440
to their site it does some function

1128
00:42:25,440 --> 00:42:27,280
funky again hand world encryption so i

1129
00:42:27,280 --> 00:42:29,119
think they understand that that data is

1130
00:42:29,119 --> 00:42:32,160
very important and it's very critical

1131
00:42:32,160 --> 00:42:34,560
but i don't i don't know why they didn't

1132
00:42:34,560 --> 00:42:36,640
feel like this was a big issue i really

1133
00:42:36,640 --> 00:42:38,000
think that they've kind of got the same

1134
00:42:38,000 --> 00:42:39,520
mentality of let's just brush it under

1135
00:42:39,520 --> 00:42:41,280
the rug nobody's gonna know nobody's

1136
00:42:41,280 --> 00:42:43,280
gonna care i don't think

1137
00:42:43,280 --> 00:42:45,359
i i it feels to me like this is a very

1138
00:42:45,359 --> 00:42:46,960
young and naive company and doesn't

1139
00:42:46,960 --> 00:42:48,079
realize

1140
00:42:48,079 --> 00:42:50,079
how security works or how the security

1141
00:42:50,079 --> 00:42:51,920
industry how to interface or work with

1142
00:42:51,920 --> 00:42:53,599
the security industry i don't think

1143
00:42:53,599 --> 00:42:55,119
they've matured to that point that's my

1144
00:42:55,119 --> 00:42:57,280
personal feeling on the comms i've had

1145
00:42:57,280 --> 00:42:59,440
but yes that's a very bad point on their

1146
00:42:59,440 --> 00:43:01,680
side

1147
00:43:03,040 --> 00:43:04,720
okay cool well thank you guys very much

1148
00:43:04,720 --> 00:43:06,000
if you've got personal questions come on

1149
00:43:06,000 --> 00:43:07,680
up i appreciate you listening for the

1150
00:43:07,680 --> 00:43:10,510
whole thing so thank you for humoring me

1151
00:43:10,510 --> 00:43:13,359
[Applause]

