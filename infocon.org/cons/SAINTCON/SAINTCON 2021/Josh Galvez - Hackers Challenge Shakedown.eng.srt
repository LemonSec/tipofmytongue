1
00:00:00,320 --> 00:00:02,399
good morning welcome to the hackers

2
00:00:02,399 --> 00:00:04,720
challenge shakedown

3
00:00:04,720 --> 00:00:07,839
i am josh galvez also known as zevlag or

4
00:00:07,839 --> 00:00:10,000
the hackers challenge game master

5
00:00:10,000 --> 00:00:11,599
uh by raise of hands because i love to

6
00:00:11,599 --> 00:00:13,920
see it i assume that's why you're here

7
00:00:13,920 --> 00:00:15,440
how many of you have played hackers

8
00:00:15,440 --> 00:00:17,919
challenge this week

9
00:00:21,520 --> 00:00:23,680
hey honestly when it comes down to it a

10
00:00:23,680 --> 00:00:25,119
ton of you have played hackers challenge

11
00:00:25,119 --> 00:00:27,760
this week and that's awesome

12
00:00:27,760 --> 00:00:30,240
there was a huge collection of

13
00:00:30,240 --> 00:00:32,479
challenges on the board

14
00:00:32,479 --> 00:00:35,280
four categories of hackers jeopardy

15
00:00:35,280 --> 00:00:36,480
which was considerably less than

16
00:00:36,480 --> 00:00:37,680
previous years and i've heard a lot of

17
00:00:37,680 --> 00:00:40,239
thank you for that so

18
00:00:40,239 --> 00:00:41,680
hopefully it wasn't

19
00:00:41,680 --> 00:00:44,079
too many and not too few this year a

20
00:00:44,079 --> 00:00:46,640
full 20 puzzles and uh none of them were

21
00:00:46,640 --> 00:00:50,000
single solve one guest questions so

22
00:00:50,000 --> 00:00:53,440
none of this who versus whom

23
00:00:53,920 --> 00:00:55,920
uh everything else so there we had 15

24
00:00:55,920 --> 00:00:58,320
other active categories uh spanning

25
00:00:58,320 --> 00:01:00,719
another 71 challenges

26
00:01:00,719 --> 00:01:01,440
so

27
00:01:01,440 --> 00:01:03,600
there was a large breadth

28
00:01:03,600 --> 00:01:06,320
of challenges across multiple areas

29
00:01:06,320 --> 00:01:08,159
hopefully it drove you around to

30
00:01:08,159 --> 00:01:10,960
multiple saintcon villages and got you

31
00:01:10,960 --> 00:01:14,640
participating amongst your peers

32
00:01:15,119 --> 00:01:18,320
307 players registered to play

33
00:01:18,320 --> 00:01:19,680
of our conference registration of

34
00:01:19,680 --> 00:01:23,040
somewhere near 11 000 or 1100 uh

35
00:01:23,040 --> 00:01:26,720
well a bit over a third

36
00:01:26,720 --> 00:01:28,320
of you solved

37
00:01:28,320 --> 00:01:30,640
uh at least one challenge so that's

38
00:01:30,640 --> 00:01:31,600
awesome

39
00:01:31,600 --> 00:01:34,560
and then 165 solved at least five

40
00:01:34,560 --> 00:01:36,240
challenges which is my bar for saying

41
00:01:36,240 --> 00:01:38,159
hey are they really participating so

42
00:01:38,159 --> 00:01:42,240
that's great participation for players

43
00:01:43,600 --> 00:01:45,200
four thousand correct answers across all

44
00:01:45,200 --> 00:01:46,640
those puzzles

45
00:01:46,640 --> 00:01:48,479
that's a lot of puzzles i was like whoa

46
00:01:48,479 --> 00:01:49,600
i didn't realize there'd be that many

47
00:01:49,600 --> 00:01:52,799
right answers caught me off guard

48
00:01:52,799 --> 00:01:55,840
fifteen 000 incorrect guesses

49
00:01:55,840 --> 00:01:58,000
so

50
00:01:58,640 --> 00:01:59,600
those are the ones that actually made it

51
00:01:59,600 --> 00:02:01,040
to the scoreboard i'm sure you had a lot

52
00:02:01,040 --> 00:02:03,600
more guesses that never made it there

53
00:02:03,600 --> 00:02:05,119
um and this is the one that disappointed

54
00:02:05,119 --> 00:02:06,000
me

55
00:02:06,000 --> 00:02:08,639
uh 2700 brute force solve attempts on

56
00:02:08,639 --> 00:02:10,239
one puzzle

57
00:02:10,239 --> 00:02:11,280
one of you

58
00:02:11,280 --> 00:02:13,120
sat there and pounded against my server

59
00:02:13,120 --> 00:02:15,840
for a while uh just brute forcing a

60
00:02:15,840 --> 00:02:20,760
wrought 13 question uh

61
00:02:26,310 --> 00:02:30,370
[Laughter]

62
00:02:31,280 --> 00:02:35,040
he says he didn't know how to spell 13.

63
00:02:35,360 --> 00:02:39,120
please don't brute force the game server

64
00:02:40,959 --> 00:02:42,640
if you had uh

65
00:02:42,640 --> 00:02:43,840
been higher on the scoreboard i would

66
00:02:43,840 --> 00:02:46,000
have to disqualify you for that behavior

67
00:02:46,000 --> 00:02:47,360
at this point it didn't wasn't severely

68
00:02:47,360 --> 00:02:49,040
detrimental but

69
00:02:49,040 --> 00:02:51,920
it can severely harm the game

70
00:02:51,920 --> 00:02:54,879
but thank you for playing

71
00:02:57,280 --> 00:02:59,120
uh uh i will welcome your question come

72
00:02:59,120 --> 00:03:00,239
on up to the mic and ask if you don't

73
00:03:00,239 --> 00:03:03,239
mind

74
00:03:09,040 --> 00:03:11,040
uh yes i'm wondering what framework you

75
00:03:11,040 --> 00:03:12,080
wrote the

76
00:03:12,080 --> 00:03:13,680
the game the

77
00:03:13,680 --> 00:03:16,000
challenge uh system the game server yeah

78
00:03:16,000 --> 00:03:17,680
so the game server is hosted on a

79
00:03:17,680 --> 00:03:19,599
platform called ctfd

80
00:03:19,599 --> 00:03:23,040
it's available on github um i have

81
00:03:23,040 --> 00:03:25,040
extremely augmented it with multiple

82
00:03:25,040 --> 00:03:27,760
plugins and extensions for it

83
00:03:27,760 --> 00:03:29,840
to provide the game style that we have

84
00:03:29,840 --> 00:03:31,599
classically here at st con and that we

85
00:03:31,599 --> 00:03:32,480
love

86
00:03:32,480 --> 00:03:34,239
so to make a hacker challenge

87
00:03:34,239 --> 00:03:36,239
if you are interested in hosting ctfs i

88
00:03:36,239 --> 00:03:38,879
strongly suggest ctfd and

89
00:03:38,879 --> 00:03:40,480
it's a community that deserves our

90
00:03:40,480 --> 00:03:44,319
feedback and support because it's great

91
00:03:44,400 --> 00:03:46,159
time stats i don't have as detailed as i

92
00:03:46,159 --> 00:03:48,159
like but it surprised me that the

93
00:03:48,159 --> 00:03:50,480
slowest time for answers was actually 8

94
00:03:50,480 --> 00:03:52,640
a.m there were more answers submitted

95
00:03:52,640 --> 00:03:55,439
during the 6am 5 am 4 am hours than

96
00:03:55,439 --> 00:03:59,480
there were in the 8 a.m hour

97
00:04:01,599 --> 00:04:03,360
and then the busiest was actually 4 p.m

98
00:04:03,360 --> 00:04:05,360
uh the most attempts happened during

99
00:04:05,360 --> 00:04:07,760
that hour

100
00:04:07,760 --> 00:04:09,760
okay that's my stats for the attacker's

101
00:04:09,760 --> 00:04:11,680
challenge shakedown so now it's your

102
00:04:11,680 --> 00:04:13,360
turn what puzzles do you want to hear

103
00:04:13,360 --> 00:04:14,720
about which puzzles do you have

104
00:04:14,720 --> 00:04:16,880
questions about and let's

105
00:04:16,880 --> 00:04:18,399
we'll turn the time over to you to ask

106
00:04:18,399 --> 00:04:20,399
those and we'll walk through them

107
00:04:20,399 --> 00:04:22,320
please come up to the mic

108
00:04:22,320 --> 00:04:24,510
over voltage over voltage

109
00:04:24,510 --> 00:04:26,880
[Laughter]

110
00:04:26,880 --> 00:04:29,040
so overvoltage was a fun puzzle uh built

111
00:04:29,040 --> 00:04:30,720
on a new password vault it was

112
00:04:30,720 --> 00:04:32,479
contributed by our

113
00:04:32,479 --> 00:04:34,720
password cracking community

114
00:04:34,720 --> 00:04:36,160
and uh

115
00:04:36,160 --> 00:04:37,040
it

116
00:04:37,040 --> 00:04:40,960
implements a fairly secure algorithm to

117
00:04:40,960 --> 00:04:42,639
uh

118
00:04:42,639 --> 00:04:44,800
maintenance password vault the

119
00:04:44,800 --> 00:04:47,199
primary steps i don't have a solve step

120
00:04:47,199 --> 00:04:49,040
on my workstation um

121
00:04:49,040 --> 00:04:53,440
but the intended method is to simply

122
00:04:53,440 --> 00:04:56,960
write a wrapper around the format to

123
00:04:56,960 --> 00:04:59,120
then brute force it it the password for

124
00:04:59,120 --> 00:05:01,039
that was in the rocky list it's blue

125
00:05:01,039 --> 00:05:03,360
lightning

126
00:05:03,360 --> 00:05:04,800
and so it's something that either you

127
00:05:04,800 --> 00:05:06,960
write an expect script around or you

128
00:05:06,960 --> 00:05:08,960
find some actually published scripts for

129
00:05:08,960 --> 00:05:10,800
a similar password vault and you pull

130
00:05:10,800 --> 00:05:14,080
out the bottom half of the scripts that

131
00:05:14,080 --> 00:05:16,479
were explicit to that style and then you

132
00:05:16,479 --> 00:05:18,800
augment them to

133
00:05:18,800 --> 00:05:20,720
brute force that and that that is a

134
00:05:20,720 --> 00:05:22,840
literally what it was passive tracking

135
00:05:22,840 --> 00:05:24,880
attempt if you have more questions

136
00:05:24,880 --> 00:05:27,120
specifically about it our good friend q

137
00:05:27,120 --> 00:05:28,400
from the password cracking submitted

138
00:05:28,400 --> 00:05:30,560
that

139
00:05:30,800 --> 00:05:33,120
thank you

140
00:05:34,240 --> 00:05:36,960
um so i wanted to know about the one

141
00:05:36,960 --> 00:05:39,520
from the crypto challenge that looked

142
00:05:39,520 --> 00:05:42,880
like base 64 but wasn't playing base 64.

143
00:05:42,880 --> 00:05:45,120
okay that's a fun one uh

144
00:05:45,120 --> 00:05:47,360
that one i was a a reminder of a

145
00:05:47,360 --> 00:05:49,520
challenge that taught a really good

146
00:05:49,520 --> 00:05:51,120
lesson to some of our previous winners

147
00:05:51,120 --> 00:05:52,479
in the past years let me pull that up

148
00:05:52,479 --> 00:05:55,120
and i'll show you that one

149
00:05:58,639 --> 00:06:02,000
so we were looking for the crypto

150
00:06:02,000 --> 00:06:05,199
just a small challenge

151
00:06:05,680 --> 00:06:07,840
so uh

152
00:06:07,840 --> 00:06:10,080
i will remind you that as i build

153
00:06:10,080 --> 00:06:12,240
challenges i often build a lot of

154
00:06:12,240 --> 00:06:14,560
metadata into the challenge the name of

155
00:06:14,560 --> 00:06:16,639
a challenge or the comment is a strong

156
00:06:16,639 --> 00:06:18,639
hint to what you're looking at

157
00:06:18,639 --> 00:06:20,479
so just a small challenge

158
00:06:20,479 --> 00:06:21,680
you look at this string and it's pretty

159
00:06:21,680 --> 00:06:24,479
obvious you have a base 64 string

160
00:06:24,479 --> 00:06:25,759
so i'm going to go to one of my favorite

161
00:06:25,759 --> 00:06:27,280
tools that all of you should hopefully

162
00:06:27,280 --> 00:06:28,880
have used at least dozen times during

163
00:06:28,880 --> 00:06:30,240
this challenge

164
00:06:30,240 --> 00:06:32,840
was gchq's cyber

165
00:06:32,840 --> 00:06:36,479
chef so i'll paste this base64 into the

166
00:06:36,479 --> 00:06:39,440
input field of cyber chef

167
00:06:39,440 --> 00:06:41,120
and we know it's base64 so that one

168
00:06:41,120 --> 00:06:42,800
really easy we'll go from base64 we end

169
00:06:42,800 --> 00:06:44,560
up with is looking this blob looks like

170
00:06:44,560 --> 00:06:46,800
this

171
00:06:46,960 --> 00:06:48,720
so when i'm looking at blobs like this i

172
00:06:48,720 --> 00:06:50,000
find it important i like to look at a

173
00:06:50,000 --> 00:06:53,599
hex dump so i'll go uh two hex

174
00:06:53,599 --> 00:06:55,599
so i'll take this i'll drag two hex over

175
00:06:55,599 --> 00:06:56,720
here

176
00:06:56,720 --> 00:06:58,479
and i look at this and

177
00:06:58,479 --> 00:07:00,160
as you get familiar with formats you

178
00:07:00,160 --> 00:07:01,599
might notice something looks obvious to

179
00:07:01,599 --> 00:07:03,919
you it might not but it does to me so

180
00:07:03,919 --> 00:07:07,440
there's one f 8 b 08 0. that is a very

181
00:07:07,440 --> 00:07:08,800
familiar header to me

182
00:07:08,800 --> 00:07:10,880
um i'm not going to get the answer yet

183
00:07:10,880 --> 00:07:12,639
but let's try another attempt here so if

184
00:07:12,639 --> 00:07:15,280
i take this and i don't go to hex

185
00:07:15,280 --> 00:07:17,440
but i can say cybershift let's do some

186
00:07:17,440 --> 00:07:18,960
magic on this i don't know if this one

187
00:07:18,960 --> 00:07:20,479
magical find or not but i'll play along

188
00:07:20,479 --> 00:07:21,599
with you

189
00:07:21,599 --> 00:07:23,360
and right here on some magic it found

190
00:07:23,360 --> 00:07:25,520
that it was a gm dip and it gave you

191
00:07:25,520 --> 00:07:28,400
your flag right here

192
00:07:28,800 --> 00:07:29,680
so

193
00:07:29,680 --> 00:07:31,360
you could have done magic and said the

194
00:07:31,360 --> 00:07:33,759
cybershot detected or recognized the

195
00:07:33,759 --> 00:07:37,199
header that it was a gzip header

196
00:07:37,199 --> 00:07:38,000
and

197
00:07:38,000 --> 00:07:40,319
so just a small challenge if something

198
00:07:40,319 --> 00:07:41,440
small

199
00:07:41,440 --> 00:07:43,199
or something is big

200
00:07:43,199 --> 00:07:44,160
what are you going to do to make it

201
00:07:44,160 --> 00:07:45,840
small you're going to compress it and so

202
00:07:45,840 --> 00:07:47,919
that was a compression header and

203
00:07:47,919 --> 00:07:50,000
it was basically a gzip file was

204
00:07:50,000 --> 00:07:51,280
basically forward to make it easy to

205
00:07:51,280 --> 00:07:53,758
communicate

206
00:07:57,199 --> 00:07:59,680
and that's all for that challenge

207
00:07:59,680 --> 00:08:02,160
do you have another

208
00:08:05,199 --> 00:08:07,520
so my guess my hint there would be learn

209
00:08:07,520 --> 00:08:09,520
to use cybershift it has extremely

210
00:08:09,520 --> 00:08:12,560
powerful tools to do binary rotation uh

211
00:08:12,560 --> 00:08:15,120
file detection basic classic crypto and

212
00:08:15,120 --> 00:08:16,879
even mono crypto all the way up to aes

213
00:08:16,879 --> 00:08:18,160
and

214
00:08:18,160 --> 00:08:21,039
blowfish etc

215
00:08:21,280 --> 00:08:24,799
it doesn't do rod 8000

216
00:08:25,199 --> 00:08:28,479
so how do you get the mac address from

217
00:08:28,479 --> 00:08:30,479
the memory dump mac adjustment mirror

218
00:08:30,479 --> 00:08:32,479
dump i'm going to invite our

219
00:08:32,479 --> 00:08:34,000
my fellow game master that helped to

220
00:08:34,000 --> 00:08:36,000
design many of the challenges here bash

221
00:08:36,000 --> 00:08:39,200
ninja up to talk about the memory dump

222
00:08:39,200 --> 00:08:41,440
it does

223
00:08:41,440 --> 00:08:43,519
okay awesome so

224
00:08:43,519 --> 00:08:46,160
the mac address that one was really fun

225
00:08:46,160 --> 00:08:47,120
um

226
00:08:47,120 --> 00:08:49,279
it was not

227
00:08:49,279 --> 00:08:50,640
it was not supposed to be as hard as it

228
00:08:50,640 --> 00:08:52,240
was but it ended up being pretty

229
00:08:52,240 --> 00:08:54,240
difficult for many of you

230
00:08:54,240 --> 00:08:56,640
the trick with a mac address is that you

231
00:08:56,640 --> 00:08:59,680
can't easily pull it out with volatility

232
00:08:59,680 --> 00:09:02,240
so we had all these challenges

233
00:09:02,240 --> 00:09:04,000
you know the memory dump challenges the

234
00:09:04,000 --> 00:09:06,640
majority of you were using volatility 2

235
00:09:06,640 --> 00:09:10,160
and volatility 3 to solve this one

236
00:09:10,160 --> 00:09:13,040
the the there's i've seen couple of

237
00:09:13,040 --> 00:09:14,720
people solve it a couple of different

238
00:09:14,720 --> 00:09:15,839
ways

239
00:09:15,839 --> 00:09:18,080
one of the more interesting ways was

240
00:09:18,080 --> 00:09:20,959
they just ran a strings of the entire

241
00:09:20,959 --> 00:09:23,360
memory dump and then regex for something

242
00:09:23,360 --> 00:09:25,040
in mac format and attempted every single

243
00:09:25,040 --> 00:09:27,200
mac address they found

244
00:09:27,200 --> 00:09:30,080
that's useful for a ctf not so useful

245
00:09:30,080 --> 00:09:32,560
for a real forensics investigation um

246
00:09:32,560 --> 00:09:34,560
the correct way to do this or the way

247
00:09:34,560 --> 00:09:36,880
that i personally intended it to be

248
00:09:36,880 --> 00:09:40,240
solved was you have the ability to

249
00:09:40,240 --> 00:09:43,680
use a a plug-in called hive list which

250
00:09:43,680 --> 00:09:45,600
will show you the registry

251
00:09:45,600 --> 00:09:48,160
the registries that are found in memory

252
00:09:48,160 --> 00:09:50,080
there's a flag for it called dash dash

253
00:09:50,080 --> 00:09:53,600
dump you can dump the registry to a file

254
00:09:53,600 --> 00:09:57,519
and then i used a tool called

255
00:09:57,519 --> 00:10:00,240
regripper to help me go through this

256
00:10:00,240 --> 00:10:02,560
dumped registry and find values that are

257
00:10:02,560 --> 00:10:03,440
in there

258
00:10:03,440 --> 00:10:05,360
and the mac address is contained within

259
00:10:05,360 --> 00:10:08,160
the registry of the windows machine

260
00:10:08,160 --> 00:10:09,120
yeah

261
00:10:09,120 --> 00:10:10,640
i'd love to comment and i really think

262
00:10:10,640 --> 00:10:12,959
bash ninja for his contributions to the

263
00:10:12,959 --> 00:10:14,800
memory forensic category this year that

264
00:10:14,800 --> 00:10:16,320
is a new one for st con and i would love

265
00:10:16,320 --> 00:10:18,079
to hear from my applause if you enjoyed

266
00:10:18,079 --> 00:10:20,319
that

267
00:10:21,360 --> 00:10:24,000
thanks bash

268
00:10:24,320 --> 00:10:25,920
that's a new one for st con we've never

269
00:10:25,920 --> 00:10:27,760
done memory dump images we've done disk

270
00:10:27,760 --> 00:10:30,000
images and virtual machines

271
00:10:30,000 --> 00:10:31,279
but we had a lot of fun with memory

272
00:10:31,279 --> 00:10:33,680
images um and next year i think you may

273
00:10:33,680 --> 00:10:36,320
need to know how to dump live ram from a

274
00:10:36,320 --> 00:10:38,480
system if you're going to play so maybe

275
00:10:38,480 --> 00:10:40,000
look into lime or some of the other two

276
00:10:40,000 --> 00:10:43,760
plugins to pull the ram yourself

277
00:10:43,760 --> 00:10:45,680
continuing on that i uh everything i

278
00:10:45,680 --> 00:10:48,079
know about windows uh

279
00:10:48,079 --> 00:10:49,920
memory dog processing i learned

280
00:10:49,920 --> 00:10:52,230
yesterday

281
00:10:52,230 --> 00:10:56,399
[Applause]

282
00:10:56,399 --> 00:10:57,120
but

283
00:10:57,120 --> 00:10:58,880
but another question i has

284
00:10:58,880 --> 00:11:00,310
oops i did it again

285
00:11:00,310 --> 00:11:03,040
[Laughter]

286
00:11:03,040 --> 00:11:04,000
okay

287
00:11:04,000 --> 00:11:05,760
that was my fun one and i really enjoyed

288
00:11:05,760 --> 00:11:07,279
building the oops i did it again

289
00:11:07,279 --> 00:11:09,680
challenge

290
00:11:10,000 --> 00:11:11,920
that is right here in the pointable

291
00:11:11,920 --> 00:11:13,760
category

292
00:11:13,760 --> 00:11:15,200
and we look at it and i've got a fancy

293
00:11:15,200 --> 00:11:16,640
new website it's running the latest

294
00:11:16,640 --> 00:11:19,040
software i'm sure because i built that

295
00:11:19,040 --> 00:11:21,120
software from source

296
00:11:21,120 --> 00:11:22,480
nobody's going to breach my site

297
00:11:22,480 --> 00:11:24,720
nobody's going to read my database

298
00:11:24,720 --> 00:11:26,640
okay so once again reminder there's a

299
00:11:26,640 --> 00:11:28,480
lot of metadata here so

300
00:11:28,480 --> 00:11:31,279
um you're going to look at

301
00:11:31,279 --> 00:11:33,360
what web server is running

302
00:11:33,360 --> 00:11:35,040
and if you

303
00:11:35,040 --> 00:11:36,800
first notice that it is the apache web

304
00:11:36,800 --> 00:11:39,360
server and it's running the version i

305
00:11:39,360 --> 00:11:42,240
don't 2450

306
00:11:42,240 --> 00:11:43,279
um

307
00:11:43,279 --> 00:11:45,360
there was a modern

308
00:11:45,360 --> 00:11:47,440
cve a recent vulnerability that happened

309
00:11:47,440 --> 00:11:50,639
in apache on 2449 it was a really simple

310
00:11:50,639 --> 00:11:53,200
local file inclusion a path traversal

311
00:11:53,200 --> 00:11:53,920
so

312
00:11:53,920 --> 00:11:56,639
let me pull up

313
00:11:56,639 --> 00:11:59,440
some details on that

314
00:11:59,600 --> 00:12:01,360
one of my favorite places to find

315
00:12:01,360 --> 00:12:02,959
information about modern vulnerabilities

316
00:12:02,959 --> 00:12:04,800
is somewhere like exploit db

317
00:12:04,800 --> 00:12:06,320
especially for big vulnerabilities and

318
00:12:06,320 --> 00:12:07,600
you'll notice going to exploit db

319
00:12:07,600 --> 00:12:10,079
they're right at the top of the list

320
00:12:10,079 --> 00:12:13,199
oh it's down the list now

321
00:12:14,040 --> 00:12:17,209
[Laughter]

322
00:12:23,279 --> 00:12:25,920
search here for apache

323
00:12:25,920 --> 00:12:28,880
and right here the top list for apache

324
00:12:28,880 --> 00:12:30,800
uh started october 6th october 13th we

325
00:12:30,800 --> 00:12:32,320
have a two four four nine patched

326
00:12:32,320 --> 00:12:33,920
reversal in code execution and a two

327
00:12:33,920 --> 00:12:35,200
four five oh path traversal code

328
00:12:35,200 --> 00:12:36,399
execution

329
00:12:36,399 --> 00:12:39,279
and so i intentionally didn't choose the

330
00:12:39,279 --> 00:12:42,240
older one where it was completely raw um

331
00:12:42,240 --> 00:12:43,680
because

332
00:12:43,680 --> 00:12:45,760
that was easy

333
00:12:45,760 --> 00:12:47,279
so i went to 2450 where they had

334
00:12:47,279 --> 00:12:48,880
attempted to patch it and instead of

335
00:12:48,880 --> 00:12:50,240
using a simple

336
00:12:50,240 --> 00:12:52,560
x uh parenthesis uh

337
00:12:52,560 --> 00:12:54,639
percentage sign two e which they weren't

338
00:12:54,639 --> 00:12:56,160
escaping properly so you could patch

339
00:12:56,160 --> 00:12:57,279
reversal

340
00:12:57,279 --> 00:12:59,360
uh you had to do a double

341
00:12:59,360 --> 00:13:00,720
escape so prince

342
00:13:00,720 --> 00:13:02,880
prince prince percent signed percent two

343
00:13:02,880 --> 00:13:03,760
e

344
00:13:03,760 --> 00:13:05,519
two six or it was a double escape and

345
00:13:05,519 --> 00:13:07,519
i'll show you here in the code

346
00:13:07,519 --> 00:13:09,279
um and that would allow you to do the

347
00:13:09,279 --> 00:13:11,760
file inclusion and a lot of you saw that

348
00:13:11,760 --> 00:13:13,360
you found that and you could

349
00:13:13,360 --> 00:13:15,440
actually find the source file of the

350
00:13:15,440 --> 00:13:18,079
index.php and you could say oh it was

351
00:13:18,079 --> 00:13:20,560
trying to include a file in a different

352
00:13:20,560 --> 00:13:24,560
path uh use our local apache 2

353
00:13:24,560 --> 00:13:26,079
db

354
00:13:26,079 --> 00:13:28,560
flag dot inc let me see if i can just

355
00:13:28,560 --> 00:13:31,599
walk through that and show you

356
00:13:33,440 --> 00:13:35,600
so we pull up the site

357
00:13:35,600 --> 00:13:37,360
and it's a fun looking site i built a

358
00:13:37,360 --> 00:13:38,560
little bit of a site here so you'd have

359
00:13:38,560 --> 00:13:41,959
something entertaining

360
00:13:52,480 --> 00:13:54,480
i just want to see the headers here

361
00:13:54,480 --> 00:13:55,920
so once again we pulled the site and we

362
00:13:55,920 --> 00:13:58,639
see you get responses 2450

363
00:13:58,639 --> 00:14:00,000
and

364
00:14:00,000 --> 00:14:02,160
by using the path traversal

365
00:14:02,160 --> 00:14:04,240
vulnerability i'll just look right here

366
00:14:04,240 --> 00:14:06,880
in the exploit db

367
00:14:06,880 --> 00:14:07,839
and you can even just take these

368
00:14:07,839 --> 00:14:09,279
examples here

369
00:14:09,279 --> 00:14:10,800
and you can see there they've encoded

370
00:14:10,800 --> 00:14:12,639
this and i'll space this in here a few

371
00:14:12,639 --> 00:14:15,639
times

372
00:14:22,880 --> 00:14:25,920
and i'll go up like that and go etsy

373
00:14:25,920 --> 00:14:27,839
password

374
00:14:27,839 --> 00:14:31,839
let's put it in there a few more

375
00:14:35,360 --> 00:14:37,680
oh and so here's the uh

376
00:14:37,680 --> 00:14:41,199
sorry i'm doing this live demo um

377
00:14:41,199 --> 00:14:42,320
it needs to

378
00:14:42,320 --> 00:14:43,760
with this exploit

379
00:14:43,760 --> 00:14:45,519
for this modern version it needs to

380
00:14:45,519 --> 00:14:46,639
actually

381
00:14:46,639 --> 00:14:48,320
the exploit the the problem in the

382
00:14:48,320 --> 00:14:50,240
vulnerability was that it

383
00:14:50,240 --> 00:14:52,160
had to go through an aliased directory

384
00:14:52,160 --> 00:14:55,120
and a default alias directory for apache

385
00:14:55,120 --> 00:14:58,639
is the cgi bin

386
00:14:58,639 --> 00:14:59,680
and i think it may actually need the

387
00:14:59,680 --> 00:15:00,800
post command

388
00:15:00,800 --> 00:15:02,800
but so the the solve here is this

389
00:15:02,800 --> 00:15:04,639
exploit actually just work and raw so if

390
00:15:04,639 --> 00:15:07,120
you were to grab the script

391
00:15:07,120 --> 00:15:09,760
and put in the path and run it for that

392
00:15:09,760 --> 00:15:12,160
destination for that folder the with the

393
00:15:12,160 --> 00:15:15,040
against the user local apache 2 db 5.ink

394
00:15:15,040 --> 00:15:18,160
it would drop that flag out

395
00:15:18,160 --> 00:15:19,360
my wife was looking at yesterday was

396
00:15:19,360 --> 00:15:20,639
entertained let me see if i can find it

397
00:15:20,639 --> 00:15:23,880
in my history

398
00:15:26,720 --> 00:15:28,399
i don't have a ministry right now but

399
00:15:28,399 --> 00:15:30,639
that to solve it was vulnerable to the

400
00:15:30,639 --> 00:15:33,600
two four five two four five oh uh

401
00:15:33,600 --> 00:15:36,240
ex cgi bin exploit and just dumped the

402
00:15:36,240 --> 00:15:38,480
black dot inc

403
00:15:38,480 --> 00:15:41,440
um once again uh exploit db is a great

404
00:15:41,440 --> 00:15:42,399
source

405
00:15:42,399 --> 00:15:44,160
um to find

406
00:15:44,160 --> 00:15:46,560
modern exploits that get included in

407
00:15:46,560 --> 00:15:48,560
metasploit so it or you could use the

408
00:15:48,560 --> 00:15:51,040
metasploit framework as well

409
00:15:51,040 --> 00:15:52,320
to find once you found that was

410
00:15:52,320 --> 00:15:55,839
vulnerable to the apache bug

411
00:15:57,920 --> 00:15:58,880
what other questions what are the

412
00:15:58,880 --> 00:16:02,600
puzzles we want to walk through

413
00:16:08,959 --> 00:16:11,680
okay so i really loved jumping into

414
00:16:11,680 --> 00:16:12,620
troy's head

415
00:16:12,620 --> 00:16:14,399
[Laughter]

416
00:16:14,399 --> 00:16:16,720
and i took the leap of faith

417
00:16:16,720 --> 00:16:18,560
jumped out over the trees found stuff on

418
00:16:18,560 --> 00:16:20,240
the ground and then i tried looking at

419
00:16:20,240 --> 00:16:21,920
the code finally i don't know what i was

420
00:16:21,920 --> 00:16:23,279
doing though so

421
00:16:23,279 --> 00:16:24,639
i want to know that one

422
00:16:24,639 --> 00:16:25,600
so

423
00:16:25,600 --> 00:16:28,880
that was a fun contribution a tristan

424
00:16:28,880 --> 00:16:30,880
our network guru here at st con built

425
00:16:30,880 --> 00:16:32,240
that and had a lot of fun building that

426
00:16:32,240 --> 00:16:33,680
for us

427
00:16:33,680 --> 00:16:37,120
and it provided a lot of entertainment

428
00:16:37,120 --> 00:16:39,040
if you had actually persisted i think

429
00:16:39,040 --> 00:16:40,160
the name of that challenge was

430
00:16:40,160 --> 00:16:41,759
persistence right

431
00:16:41,759 --> 00:16:44,720
on that one um and done it again

432
00:16:44,720 --> 00:16:45,759
jumped has gone through the hoop and

433
00:16:45,759 --> 00:16:48,000
jumped to the head again uh the code

434
00:16:48,000 --> 00:16:51,279
becomes visible um let me i'm sure

435
00:16:51,279 --> 00:16:52,959
there's a more concise solved path for

436
00:16:52,959 --> 00:16:53,920
it

437
00:16:53,920 --> 00:16:55,920
is tristan in here

438
00:16:55,920 --> 00:16:57,680
okay he's not um

439
00:16:57,680 --> 00:16:58,560
oh

440
00:16:58,560 --> 00:17:02,439
tristan come tell us about it

441
00:17:04,240 --> 00:17:09,439
[Applause]

442
00:17:09,439 --> 00:17:12,079
so that challenge um is basically you

443
00:17:12,079 --> 00:17:14,640
have to climb up a giant statue of troy

444
00:17:14,640 --> 00:17:16,000
uh jupiter

445
00:17:16,000 --> 00:17:17,439
all my challenges actually have jupiter

446
00:17:17,439 --> 00:17:18,640
hidden in them

447
00:17:18,640 --> 00:17:21,199
and yeah you're welcome

448
00:17:21,199 --> 00:17:22,400
um

449
00:17:22,400 --> 00:17:23,919
so

450
00:17:23,919 --> 00:17:26,079
you were able to jump

451
00:17:26,079 --> 00:17:28,160
yeah the uh there was once it got inside

452
00:17:28,160 --> 00:17:31,200
his head said take a leap of faith

453
00:17:31,200 --> 00:17:33,360
the the solution is you actually have to

454
00:17:33,360 --> 00:17:34,880
go to the highest point point and then

455
00:17:34,880 --> 00:17:36,880
jump off and just kind of go off to the

456
00:17:36,880 --> 00:17:38,720
edge and you'll fall off the world and

457
00:17:38,720 --> 00:17:40,000
did you get under the under the world

458
00:17:40,000 --> 00:17:43,039
and see the message under there

459
00:17:43,280 --> 00:17:44,960
yes oh you see you got there okay you

460
00:17:44,960 --> 00:17:47,280
did get there

461
00:17:47,280 --> 00:17:48,000
so

462
00:17:48,000 --> 00:17:49,679
let's let's look at the clue here

463
00:17:49,679 --> 00:17:51,520
that was a lot of fun so here's the clue

464
00:17:51,520 --> 00:17:53,120
for that one

465
00:17:53,120 --> 00:17:55,039
and once again remember my metadata from

466
00:17:55,039 --> 00:17:56,400
my puzzles

467
00:17:56,400 --> 00:17:57,760
always guide you towards what you're

468
00:17:57,760 --> 00:17:59,360
looking at so let's read this out let's

469
00:17:59,360 --> 00:18:00,400
read this together

470
00:18:00,400 --> 00:18:01,679
we can accomplish our great things by

471
00:18:01,679 --> 00:18:03,600
working together some people are gas

472
00:18:03,600 --> 00:18:05,360
giants guiding dozens of moons in the

473
00:18:05,360 --> 00:18:06,400
orbit

474
00:18:06,400 --> 00:18:08,720
even though hardships try to divide us

475
00:18:08,720 --> 00:18:10,400
we will remain strong

476
00:18:10,400 --> 00:18:13,200
what was in that string that you found

477
00:18:13,200 --> 00:18:15,360
a percent sign meaning modulo and you

478
00:18:15,360 --> 00:18:16,880
see it now

479
00:18:16,880 --> 00:18:19,120
a divide and a remainder so you perform

480
00:18:19,120 --> 00:18:21,280
the mathematical arithmetic function on

481
00:18:21,280 --> 00:18:25,559
that string and that's your flag

482
00:18:29,760 --> 00:18:31,360
thank you tristan so much for

483
00:18:31,360 --> 00:18:34,320
contributing that challenge

484
00:18:38,559 --> 00:18:40,720
how in the world do you boot those

485
00:18:40,720 --> 00:18:42,559
reverse engineering ones the dot bin

486
00:18:42,559 --> 00:18:44,400
files i could not figure that out let me

487
00:18:44,400 --> 00:18:47,600
show you that that's a lot of fun

488
00:18:48,400 --> 00:18:50,720
so let me put my vmware one of the

489
00:18:50,720 --> 00:18:52,080
awesome tools i mentioned in my talk

490
00:18:52,080 --> 00:18:54,240
yesterday was vmware i use it for

491
00:18:54,240 --> 00:18:55,520
everything

492
00:18:55,520 --> 00:18:56,799
uh learned you've used virtual

493
00:18:56,799 --> 00:18:58,880
environments and so i'm going to boot up

494
00:18:58,880 --> 00:19:01,520
ubuntu environment on my mac

495
00:19:01,520 --> 00:19:03,039
and inside my inbuilt environment i'm

496
00:19:03,039 --> 00:19:05,120
going to do even more virtualization i'm

497
00:19:05,120 --> 00:19:08,520
going to run qemu

498
00:19:20,880 --> 00:19:21,679
oh

499
00:19:21,679 --> 00:19:24,919
there we go

500
00:19:30,240 --> 00:19:31,360
sorry while i wait for my slow

501
00:19:31,360 --> 00:19:32,720
workstation

502
00:19:32,720 --> 00:19:35,520
it's time to upgrade

503
00:19:35,520 --> 00:19:37,280
as i wink at my wife sit on the front

504
00:19:37,280 --> 00:19:37,860
row

505
00:19:37,860 --> 00:19:41,200
[Laughter]

506
00:19:41,200 --> 00:19:43,440
okay

507
00:19:50,400 --> 00:19:53,919
history pipe grip qemu

508
00:19:53,919 --> 00:19:56,400
and so

509
00:19:56,480 --> 00:19:58,480
i have my install my x86 system there

510
00:19:58,480 --> 00:20:02,799
but uh i don't have my history

511
00:20:03,760 --> 00:20:04,880
and i just want to show you this right

512
00:20:04,880 --> 00:20:08,840
so let me go find my build flag

513
00:20:22,790 --> 00:20:27,980
[Laughter]

514
00:20:33,039 --> 00:20:35,200
inches away from is screen

515
00:20:35,200 --> 00:20:36,799
zooming and everything else i mean he's

516
00:20:36,799 --> 00:20:40,480
got a guy with science he's very very

517
00:20:40,480 --> 00:20:42,240
super good at it

518
00:20:42,240 --> 00:20:43,120
but

519
00:20:43,120 --> 00:20:44,640
you have to think of

520
00:20:44,640 --> 00:20:47,120
what i'll call it a disability but maybe

521
00:20:47,120 --> 00:20:48,799
not really that

522
00:20:48,799 --> 00:20:50,400
how much harder he has to work to make

523
00:20:50,400 --> 00:20:53,039
all this work

524
00:20:54,159 --> 00:20:56,400
okay so this was my boot me challenge

525
00:20:56,400 --> 00:20:58,240
there's my make file and where i had it

526
00:20:58,240 --> 00:21:00,960
tested so essentially command like this

527
00:21:00,960 --> 00:21:04,000
this uh so install qmu and allow it to

528
00:21:04,000 --> 00:21:07,039
install the subsystem for x86 emulation

529
00:21:07,039 --> 00:21:08,880
and you can just pass it a path such as

530
00:21:08,880 --> 00:21:12,240
the boot.bin uh for the boot drive

531
00:21:12,240 --> 00:21:13,840
um and that's how you would easily boot

532
00:21:13,840 --> 00:21:16,640
it to run it let me copy and paste this

533
00:21:16,640 --> 00:21:20,080
into my system and i'll show it to you

534
00:21:20,159 --> 00:21:25,640
this is in my boot me reverse folder

535
00:21:36,400 --> 00:21:38,880
and if i just go make boot which hold on

536
00:21:38,880 --> 00:21:42,240
my boot file you'll see a boot

537
00:21:42,240 --> 00:21:44,080
and in this case for that one there's

538
00:21:44,080 --> 00:21:46,080
your flag

539
00:21:46,080 --> 00:21:47,440
so we'll just straight flag for that

540
00:21:47,440 --> 00:21:48,559
first one the next one was a little bit

541
00:21:48,559 --> 00:21:49,840
more challenging it'd

542
00:21:49,840 --> 00:21:52,400
pop up with a password prompt um but the

543
00:21:52,400 --> 00:21:53,600
key is gonna be the same for both of

544
00:21:53,600 --> 00:21:55,440
them the way to approach it and you'll

545
00:21:55,440 --> 00:21:58,320
see that if i do a make debug it'll boot

546
00:21:58,320 --> 00:22:00,400
and it'll connect my gdp debugger for me

547
00:22:00,400 --> 00:22:02,240
automatically and this you don't have

548
00:22:02,240 --> 00:22:04,080
the source code to build a run this way

549
00:22:04,080 --> 00:22:05,360
but that's how the approach would have

550
00:22:05,360 --> 00:22:07,360
been and so there's the my make file and

551
00:22:07,360 --> 00:22:10,000
the commands that i would have used

552
00:22:10,000 --> 00:22:11,280
to

553
00:22:11,280 --> 00:22:14,960
either boot it or to boot into a debug

554
00:22:14,960 --> 00:22:16,960
environment and attach gdb to set

555
00:22:16,960 --> 00:22:19,679
breakpoints through it

556
00:22:19,679 --> 00:22:21,360
and so that's that was the step for the

557
00:22:21,360 --> 00:22:23,600
first boot me and the next one where you

558
00:22:23,600 --> 00:22:27,840
had to boot it and then get the password

559
00:22:28,799 --> 00:22:30,240
what was that

560
00:22:30,240 --> 00:22:32,559
again

561
00:22:32,880 --> 00:22:34,480
the droids

562
00:22:34,480 --> 00:22:36,960
okay so droids is not related to the

563
00:22:36,960 --> 00:22:38,159
same

564
00:22:38,159 --> 00:22:40,960
two sets the two challenges it was a uh

565
00:22:40,960 --> 00:22:43,120
uber difficult uh reverse engineering

566
00:22:43,120 --> 00:22:44,960
puzzle that one was contributed with

567
00:22:44,960 --> 00:22:47,440
much gratitude to our professor plum

568
00:22:47,440 --> 00:22:49,679
who a couple years ago built the windows

569
00:22:49,679 --> 00:22:51,039
version of that and a complete

570
00:22:51,039 --> 00:22:54,039
anti-debugger

571
00:22:57,440 --> 00:22:59,600
there were at least 16 steps of

572
00:22:59,600 --> 00:23:00,960
anti-debugging that you had to go

573
00:23:00,960 --> 00:23:04,240
through to uh

574
00:23:04,240 --> 00:23:06,320
extract that flag and then decrypt it

575
00:23:06,320 --> 00:23:08,960
with openssl so

576
00:23:08,960 --> 00:23:10,960
i don't have all those steps to walk

577
00:23:10,960 --> 00:23:12,159
through that right here on stage right

578
00:23:12,159 --> 00:23:13,840
now but i'm sure professor plum would

579
00:23:13,840 --> 00:23:18,280
gladly talk you through those

580
00:23:23,679 --> 00:23:25,440
yes please come up and ask a question

581
00:23:25,440 --> 00:23:29,039
hello i thought i knew what the rfc

582
00:23:29,039 --> 00:23:31,520
winged animals one was but

583
00:23:31,520 --> 00:23:32,880
everything i tried didn't work so okay

584
00:23:32,880 --> 00:23:34,400
so tell me about it what he's asking

585
00:23:34,400 --> 00:23:36,480
about rc for winged animals uh what tell

586
00:23:36,480 --> 00:23:39,280
me what you learned about it i

587
00:23:39,280 --> 00:23:40,960
thought it was a gnat because it has

588
00:23:40,960 --> 00:23:43,200
wings on it oh interesting i i hadn't

589
00:23:43,200 --> 00:23:44,880
thought about that and it smells like

590
00:23:44,880 --> 00:23:46,880
you know internet networking stuff but

591
00:23:46,880 --> 00:23:49,120
it didn't work okay so

592
00:23:49,120 --> 00:23:50,880
the ietf i don't know if you're familiar

593
00:23:50,880 --> 00:23:54,159
with this group that uh develops uh rfcs

594
00:23:54,159 --> 00:23:55,679
to for the foundation of internet

595
00:23:55,679 --> 00:23:57,840
engineers um

596
00:23:57,840 --> 00:23:59,360
are very entertaining people like a lot

597
00:23:59,360 --> 00:24:01,279
of us and sometimes they get very bored

598
00:24:01,279 --> 00:24:03,919
and just need some fun so they have

599
00:24:03,919 --> 00:24:06,480
published some very interesting rfcs

600
00:24:06,480 --> 00:24:08,320
about the operation of the world

601
00:24:08,320 --> 00:24:11,279
so he's asking about an rfc

602
00:24:11,279 --> 00:24:12,720
let's pull it up so i'll show you on the

603
00:24:12,720 --> 00:24:13,760
game board

604
00:24:13,760 --> 00:24:15,919
and

605
00:24:15,919 --> 00:24:19,320
unlock me

606
00:24:22,480 --> 00:24:25,440
and you were asking about

607
00:24:25,440 --> 00:24:28,320
yeah it didn't unlock for me

608
00:24:28,320 --> 00:24:29,120
but

609
00:24:29,120 --> 00:24:33,158
let me go to the admin panel

610
00:24:33,200 --> 00:24:34,960
oh it will show the score there

611
00:24:34,960 --> 00:24:37,279
i'm not going back that way

612
00:24:37,279 --> 00:24:38,240
okay

613
00:24:38,240 --> 00:24:41,279
so this jeopardy one i was asking about

614
00:24:41,279 --> 00:24:43,679
let me pull up i can pull up that sheet

615
00:24:43,679 --> 00:24:44,720
you guys can see that because you've

616
00:24:44,720 --> 00:24:48,480
seen them already hacker jeopardy

617
00:24:53,039 --> 00:24:56,760
i think that's the right one

618
00:25:04,080 --> 00:25:05,279
yes

619
00:25:05,279 --> 00:25:07,279
this rfc allows for the internet to

620
00:25:07,279 --> 00:25:09,120
function by winged animals so this is

621
00:25:09,120 --> 00:25:13,120
rfc number 1149 about carrier pigeons it

622
00:25:13,120 --> 00:25:15,919
is tcp over carrier pigeon

623
00:25:15,919 --> 00:25:17,919
or avia avian yes

624
00:25:17,919 --> 00:25:20,480
avian carriers carrier pigeon is the

625
00:25:20,480 --> 00:25:23,360
modification to it later uh it provided

626
00:25:23,360 --> 00:25:26,600
uh cueing

627
00:25:28,559 --> 00:25:29,919
yes it was the bergen network group and

628
00:25:29,919 --> 00:25:31,520
it was actually implemented it was

629
00:25:31,520 --> 00:25:33,918
entertaining

630
00:25:35,919 --> 00:25:37,760
yes it was released on april 1st several

631
00:25:37,760 --> 00:25:38,880
of these that i called out were april

632
00:25:38,880 --> 00:25:41,120
first releases like i said the ietf has

633
00:25:41,120 --> 00:25:43,120
some entertaining engineers they get

634
00:25:43,120 --> 00:25:45,439
bored

635
00:25:45,600 --> 00:25:47,918
yes

636
00:25:49,039 --> 00:25:50,559
any other questions which puzzles do you

637
00:25:50,559 --> 00:25:53,760
want to see walk-throughs for

638
00:25:53,760 --> 00:25:54,840
or

639
00:25:54,840 --> 00:25:57,520
solutions he reminded me the rfc where

640
00:25:57,520 --> 00:25:59,200
the ip address

641
00:25:59,200 --> 00:26:01,840
could end in zero yes i looked at a

642
00:26:01,840 --> 00:26:03,440
number of them

643
00:26:03,440 --> 00:26:05,200
and couldn't find the right one so i'm

644
00:26:05,200 --> 00:26:07,279
kind of curious so which one you were

645
00:26:07,279 --> 00:26:08,799
looking for that one was tricky because

646
00:26:08,799 --> 00:26:11,200
it wasn't actually asking for an rfc oh

647
00:26:11,200 --> 00:26:13,120
really yes let's look at the wording for

648
00:26:13,120 --> 00:26:15,279
this

649
00:26:18,960 --> 00:26:21,360
yes and so this is networking 101 and

650
00:26:21,360 --> 00:26:22,799
the question was

651
00:26:22,799 --> 00:26:24,799
the standard that allowed for your

652
00:26:24,799 --> 00:26:30,080
workstation to ip address to end in zero

653
00:26:31,679 --> 00:26:33,440
that that oh yes the title of the hint

654
00:26:33,440 --> 00:26:36,400
let me i'll log in so i can see that

655
00:26:36,400 --> 00:26:38,240
let's show that once again metadata was

656
00:26:38,240 --> 00:26:40,640
important

657
00:26:42,320 --> 00:26:45,520
i won't show the scores

658
00:26:46,240 --> 00:26:47,360
let's see if i can type my password

659
00:26:47,360 --> 00:26:51,879
though on stage it's like

660
00:26:52,880 --> 00:26:55,760
not long enough

661
00:26:56,960 --> 00:27:00,480
okay so a drink

662
00:27:02,640 --> 00:27:05,120
so the hint on this is a drink

663
00:27:05,120 --> 00:27:05,919
the standard allowed for your

664
00:27:05,919 --> 00:27:08,000
workstation ip address to end in zero

665
00:27:08,000 --> 00:27:10,000
so the name of this standard is

666
00:27:10,000 --> 00:27:12,720
classless internet interdomain routing

667
00:27:12,720 --> 00:27:16,559
which is commonly called cider cidr

668
00:27:16,559 --> 00:27:20,039
thus a drink

669
00:27:32,240 --> 00:27:35,840
the one where you just do local

670
00:27:35,840 --> 00:27:38,959
so when we're um

671
00:27:42,399 --> 00:27:45,520
i know how i saw the png flag

672
00:27:45,520 --> 00:27:48,080
where the flag was in the

673
00:27:48,080 --> 00:27:52,320
the picture filtered is for the filter

674
00:27:52,320 --> 00:27:54,240
um

675
00:27:54,240 --> 00:27:57,679
which one are you asking about i'm sorry

676
00:27:57,679 --> 00:27:58,880
the one with it in the game in the

677
00:27:58,880 --> 00:28:01,880
binary

678
00:28:07,120 --> 00:28:08,559
so i have a lot of puzzles that you

679
00:28:08,559 --> 00:28:09,600
could be asking about i'm trying to make

680
00:28:09,600 --> 00:28:11,440
sure i get to the right one

681
00:28:11,440 --> 00:28:13,919
it's it's the one where you have the

682
00:28:13,919 --> 00:28:16,960
pirate theme

683
00:28:16,960 --> 00:28:19,679
bash games level game ah batman

684
00:28:19,679 --> 00:28:21,840
welcome bash ninja he built our fun

685
00:28:21,840 --> 00:28:24,320
string of docker ssh

686
00:28:24,320 --> 00:28:26,720
challenges that we call the bash games

687
00:28:26,720 --> 00:28:27,840
so you're talking about the one where

688
00:28:27,840 --> 00:28:30,799
you're sshinging into a machine right

689
00:28:30,799 --> 00:28:33,679
yeah you're ssh into the machine okay

690
00:28:33,679 --> 00:28:35,760
so this i got it but i'm just wondering

691
00:28:35,760 --> 00:28:38,799
if what i did was so fast way

692
00:28:38,799 --> 00:28:40,559
there are a lot of ways literally i'm

693
00:28:40,559 --> 00:28:43,760
just giving you a machine to log into

694
00:28:43,760 --> 00:28:47,200
and then we blocked all outbound traffic

695
00:28:47,200 --> 00:28:49,520
so you can't send stuff out so you have

696
00:28:49,520 --> 00:28:51,200
to figure out how to get it in

697
00:28:51,200 --> 00:28:53,600
there's a couple different ways

698
00:28:53,600 --> 00:28:55,520
but the way that i intended it to be

699
00:28:55,520 --> 00:28:58,399
solved was to use a tool called scp

700
00:28:58,399 --> 00:29:00,720
which is like it's it's very similar to

701
00:29:00,720 --> 00:29:04,159
ftp it's just over an ssh tunnel right

702
00:29:04,159 --> 00:29:06,640
um there are other ways that i've seen

703
00:29:06,640 --> 00:29:09,600
solved it i saw one person um cat the

704
00:29:09,600 --> 00:29:12,320
file to base 64. which is the way i

705
00:29:12,320 --> 00:29:14,880
would have done it take the string

706
00:29:14,880 --> 00:29:16,320
bring it to their desktop and then

707
00:29:16,320 --> 00:29:17,679
debase this

708
00:29:17,679 --> 00:29:20,720
decode that and then write it to a file

709
00:29:20,720 --> 00:29:22,799
similar to that there's there's so many

710
00:29:22,799 --> 00:29:25,440
different ways but hex dumped it with x

711
00:29:25,440 --> 00:29:29,760
xd yep hex dump it with x16

712
00:29:29,760 --> 00:29:31,360
and then

713
00:29:31,360 --> 00:29:33,919
rik you know saved it took the command

714
00:29:33,919 --> 00:29:35,200
lines out

715
00:29:35,200 --> 00:29:37,200
and then pipe that back through it again

716
00:29:37,200 --> 00:29:40,559
to re regenerate the file yeah there's

717
00:29:40,559 --> 00:29:42,480
just a lot of different ways and i i'm

718
00:29:42,480 --> 00:29:44,159
hoping that people be creative with it

719
00:29:44,159 --> 00:29:46,480
just find a way to get around the the

720
00:29:46,480 --> 00:29:48,320
outbound block you can't just transfer

721
00:29:48,320 --> 00:29:50,000
it out you have to figure out how to get

722
00:29:50,000 --> 00:29:52,320
get it to you and so the very simplest

723
00:29:52,320 --> 00:29:53,760
way is to do

724
00:29:53,760 --> 00:29:55,440
scp

725
00:29:55,440 --> 00:29:57,120
space

726
00:29:57,120 --> 00:29:58,000
the

727
00:29:58,000 --> 00:29:59,919
you know the host you're connecting to

728
00:29:59,919 --> 00:30:01,840
and the file path that you want and a

729
00:30:01,840 --> 00:30:03,120
space and then where you want to write

730
00:30:03,120 --> 00:30:04,960
to on your desktop or on your local

731
00:30:04,960 --> 00:30:06,720
machine and that'll just pull the file

732
00:30:06,720 --> 00:30:08,640
straight down but again there's lots of

733
00:30:08,640 --> 00:30:09,919
cool and creative ways that you can go

734
00:30:09,919 --> 00:30:12,799
about solving that one

735
00:30:13,600 --> 00:30:17,440
capital p and turn on port 14. yep

736
00:30:17,440 --> 00:30:18,399
yes

737
00:30:18,399 --> 00:30:19,600
thank you

738
00:30:19,600 --> 00:30:23,840
i want to ask is kleeb in the room

739
00:30:25,120 --> 00:30:26,240
are you willing to come walk up here and

740
00:30:26,240 --> 00:30:27,679
talk about overvoltage you are our first

741
00:30:27,679 --> 00:30:29,840
solve on that and i want to hear your

742
00:30:29,840 --> 00:30:31,200
solve method and if you're okay stop

743
00:30:31,200 --> 00:30:32,320
doing it the mic i'd love to hear about

744
00:30:32,320 --> 00:30:34,480
it

745
00:30:34,799 --> 00:30:37,360
for overvolt right yeah for overhaul

746
00:30:37,360 --> 00:30:39,520
yeah so um

747
00:30:39,520 --> 00:30:41,360
that overvolt was probably one of the

748
00:30:41,360 --> 00:30:42,960
first really hard questions i looked at

749
00:30:42,960 --> 00:30:44,559
like tuesday night

750
00:30:44,559 --> 00:30:46,880
um and just spent like hours looking at

751
00:30:46,880 --> 00:30:49,039
the spec trying to figure it out

752
00:30:49,039 --> 00:30:50,559
and

753
00:30:50,559 --> 00:30:52,080
texted a couple of my friends i'm like

754
00:30:52,080 --> 00:30:53,360
hey like

755
00:30:53,360 --> 00:30:55,600
what is going on how are we like i'm

756
00:30:55,600 --> 00:30:59,039
looking at this i can't figure it out

757
00:30:59,200 --> 00:31:00,399
and looked at the spec and i was

758
00:31:00,399 --> 00:31:02,640
confused and i thought that maybe

759
00:31:02,640 --> 00:31:06,320
i could pull out a hash the script hash

760
00:31:06,320 --> 00:31:08,159
um if you look at the spec there's you

761
00:31:08,159 --> 00:31:09,440
know it talks about that and i was like

762
00:31:09,440 --> 00:31:10,799
maybe i can pull that out and crack it

763
00:31:10,799 --> 00:31:12,640
with hash cat which was the intended

764
00:31:12,640 --> 00:31:14,960
method that's one way you could do it

765
00:31:14,960 --> 00:31:16,480
i'm gonna hear you going i'm not sure

766
00:31:16,480 --> 00:31:20,399
you could but that's okay um

767
00:31:20,720 --> 00:31:22,640
and i had problems with that because the

768
00:31:22,640 --> 00:31:24,640
script hash is wrapped in

769
00:31:24,640 --> 00:31:26,960
in another encryption right and the file

770
00:31:26,960 --> 00:31:28,399
key is like 16 bytes and i didn't want

771
00:31:28,399 --> 00:31:30,240
to have to brute force that

772
00:31:30,240 --> 00:31:31,600
and it was a whole thing and then i

773
00:31:31,600 --> 00:31:35,200
realized you know why don't i just use

774
00:31:35,200 --> 00:31:36,480
because i at this point i had been

775
00:31:36,480 --> 00:31:38,159
writing some go i realized that so in

776
00:31:38,159 --> 00:31:40,000
the spec it talks about like

777
00:31:40,000 --> 00:31:43,120
he uses base64 but without padding and i

778
00:31:43,120 --> 00:31:44,240
was like i don't know how to do that

779
00:31:44,240 --> 00:31:45,440
myself i don't know how to do that on

780
00:31:45,440 --> 00:31:46,960
the command line like i'm just going to

781
00:31:46,960 --> 00:31:49,039
use the same function he uses in go and

782
00:31:49,039 --> 00:31:51,039
i didn't know go and i learned it for

783
00:31:51,039 --> 00:31:52,960
this which it was a blast

784
00:31:52,960 --> 00:31:54,240
um

785
00:31:54,240 --> 00:31:56,320
thank you

786
00:31:56,320 --> 00:31:58,399
so

787
00:31:58,399 --> 00:32:00,240
i'm looking at i write this thing and go

788
00:32:00,240 --> 00:32:02,159
to like reverse the basics before just

789
00:32:02,159 --> 00:32:03,440
to look at it get it back into like the

790
00:32:03,440 --> 00:32:05,360
normal format whatever

791
00:32:05,360 --> 00:32:06,399
and then i'm like you know what why

792
00:32:06,399 --> 00:32:08,880
don't i just use

793
00:32:08,880 --> 00:32:11,919
the age source code and like

794
00:32:11,919 --> 00:32:14,240
get a hook in there so we can brute

795
00:32:14,240 --> 00:32:16,159
force the passwords and i write some

796
00:32:16,159 --> 00:32:17,039
code

797
00:32:17,039 --> 00:32:18,880
and it doesn't work i use ages like

798
00:32:18,880 --> 00:32:21,519
official exported api i run into some

799
00:32:21,519 --> 00:32:23,440
issues i message a friend he gets on

800
00:32:23,440 --> 00:32:25,039
discord with me we look at it we dig

801
00:32:25,039 --> 00:32:26,399
through the spec we dig through the code

802
00:32:26,399 --> 00:32:28,880
we spent four hours

803
00:32:28,880 --> 00:32:30,799
digging and looking and looking at like

804
00:32:30,799 --> 00:32:32,399
the stanza specification and the

805
00:32:32,399 --> 00:32:34,480
recipients and the headers

806
00:32:34,480 --> 00:32:36,159
and

807
00:32:36,159 --> 00:32:38,480
hooked into that code instead

808
00:32:38,480 --> 00:32:40,080
um

809
00:32:40,080 --> 00:32:41,760
and then brute forced it with rocky and

810
00:32:41,760 --> 00:32:43,440
i didn't get it with rocky so we tried

811
00:32:43,440 --> 00:32:45,360
it with the crack station list

812
00:32:45,360 --> 00:32:49,519
and that worked it's in the rocky list i

813
00:32:49,519 --> 00:32:51,840
don't know what i did wrong but you know

814
00:32:51,840 --> 00:32:53,919
it's fine but we got it

815
00:32:53,919 --> 00:32:56,320
and it took me days i like i couldn't

816
00:32:56,320 --> 00:32:57,840
sleep at night i was just thinking about

817
00:32:57,840 --> 00:32:59,760
the specification and how i could unwrap

818
00:32:59,760 --> 00:33:01,440
things and how we could like

819
00:33:01,440 --> 00:33:03,039
what can we do to reverse the the

820
00:33:03,039 --> 00:33:04,559
outside encryption so i can get the

821
00:33:04,559 --> 00:33:06,320
inside hash that was a big red herring

822
00:33:06,320 --> 00:33:07,440
yes

823
00:33:07,440 --> 00:33:08,399
um

824
00:33:08,399 --> 00:33:10,159
it was a big blast and and shout out to

825
00:33:10,159 --> 00:33:12,559
my friend kyle hovey uh for helping me

826
00:33:12,559 --> 00:33:15,039
with the go side of it and

827
00:33:15,039 --> 00:33:16,559
that stuff he couldn't be here today but

828
00:33:16,559 --> 00:33:18,480
i wish he could so thank you so much for

829
00:33:18,480 --> 00:33:22,200
playing good job

830
00:33:24,000 --> 00:33:27,039
come see me after i want to talk to you

831
00:33:27,039 --> 00:33:28,640
what other puzzles do i hear about

832
00:33:28,640 --> 00:33:30,559
uh

833
00:33:30,559 --> 00:33:32,640
i think it's called uh pwned it filtered

834
00:33:32,640 --> 00:33:34,720
it that one i wanted to yes what did you

835
00:33:34,720 --> 00:33:36,799
expect us to do with that the server

836
00:33:36,799 --> 00:33:38,480
server's blocking it

837
00:33:38,480 --> 00:33:39,279
okay

838
00:33:39,279 --> 00:33:41,279
let's look at the one you were hope see

839
00:33:41,279 --> 00:33:42,880
you were looking proponent is that the

840
00:33:42,880 --> 00:33:45,360
one you wanted

841
00:33:46,880 --> 00:33:47,919
okay we'll

842
00:33:47,919 --> 00:33:49,600
talk about the whole series i'm not

843
00:33:49,600 --> 00:33:50,720
going to show you all of them but i'll

844
00:33:50,720 --> 00:33:52,000
talk you through all of them because i

845
00:33:52,000 --> 00:33:54,399
know them

846
00:33:59,760 --> 00:34:01,519
okay so this was a fun series this is

847
00:34:01,519 --> 00:34:02,799
the

848
00:34:02,799 --> 00:34:04,559
a series of upload challenges this is a

849
00:34:04,559 --> 00:34:06,880
service that let me just pull it up

850
00:34:06,880 --> 00:34:07,679
because i'll show you at least one

851
00:34:07,679 --> 00:34:09,119
screen here and i want everybody to see

852
00:34:09,119 --> 00:34:11,280
it

853
00:34:11,760 --> 00:34:13,440
not the pokey door the image drop site

854
00:34:13,440 --> 00:34:15,119
this is the hackers challenge image drop

855
00:34:15,119 --> 00:34:17,440
site you can drop your images here and

856
00:34:17,440 --> 00:34:19,280
come back and find them in the next hour

857
00:34:19,280 --> 00:34:20,800
if you're lucky because i delete

858
00:34:20,800 --> 00:34:21,670
everything randomly

859
00:34:21,670 --> 00:34:24,560
[Laughter]

860
00:34:24,560 --> 00:34:27,440
that was really to save disk space but

861
00:34:27,440 --> 00:34:28,879
and

862
00:34:28,879 --> 00:34:31,280
every user that started a session got a

863
00:34:31,280 --> 00:34:33,040
new user directory so you weren't

864
00:34:33,040 --> 00:34:36,719
stomping on top of each other hopefully

865
00:34:36,719 --> 00:34:38,159
and so the challenges here is you could

866
00:34:38,159 --> 00:34:40,239
upload a file to the server and it would

867
00:34:40,239 --> 00:34:41,760
show up so i'll go ahead and upload an

868
00:34:41,760 --> 00:34:44,000
image

869
00:34:45,760 --> 00:34:48,760
yep

870
00:34:56,480 --> 00:34:58,240
um so i'll go and upload an image and so

871
00:34:58,240 --> 00:34:59,599
here you have an upload image so the

872
00:34:59,599 --> 00:35:02,160
goal here is can you upload images that

873
00:35:02,160 --> 00:35:03,599
you weren't supposed to

874
00:35:03,599 --> 00:35:06,640
can you upload images that will get ran

875
00:35:06,640 --> 00:35:08,800
as php code because the server is

876
00:35:08,800 --> 00:35:11,040
running php and you want to be able to

877
00:35:11,040 --> 00:35:13,040
execute your code on the server to find

878
00:35:13,040 --> 00:35:16,160
the flag that's hidden in the source

879
00:35:16,160 --> 00:35:17,760
and so for this first one it was really

880
00:35:17,760 --> 00:35:19,599
simple

881
00:35:19,599 --> 00:35:20,480
um

882
00:35:20,480 --> 00:35:22,720
the idea is you just rename your file

883
00:35:22,720 --> 00:35:23,920
and to

884
00:35:23,920 --> 00:35:26,320
upload a php file straight up

885
00:35:26,320 --> 00:35:28,000
not much filtering going on

886
00:35:28,000 --> 00:35:29,760
it only would block at client side in

887
00:35:29,760 --> 00:35:32,960
javascript or in html

888
00:35:32,960 --> 00:35:34,240
so that was easy

889
00:35:34,240 --> 00:35:36,560
move on to the next one

890
00:35:36,560 --> 00:35:38,640
i'm looking for my category web right

891
00:35:38,640 --> 00:35:41,040
there so

892
00:35:41,040 --> 00:35:42,560
um

893
00:35:42,560 --> 00:35:45,599
bypass it

894
00:35:45,599 --> 00:35:47,280
so this one we got a little bit harder

895
00:35:47,280 --> 00:35:48,960
and we had file type filters on the

896
00:35:48,960 --> 00:35:52,640
website and so it would check and verify

897
00:35:52,640 --> 00:35:54,560
the extension on the file

898
00:35:54,560 --> 00:35:56,320
and on the server side is this an

899
00:35:56,320 --> 00:35:58,079
extension this one's file type that's

900
00:35:58,079 --> 00:35:59,680
what it was yes so this one would look

901
00:35:59,680 --> 00:36:01,839
for the mime type when you upload a file

902
00:36:01,839 --> 00:36:03,680
you in your post form send to data and

903
00:36:03,680 --> 00:36:07,200
say hey this is mime type files image

904
00:36:07,200 --> 00:36:09,760
slash png image slash jpeg and server

905
00:36:09,760 --> 00:36:11,680
would check for that file type and so

906
00:36:11,680 --> 00:36:14,320
you could say i'm sending you a jpeg

907
00:36:14,320 --> 00:36:16,400
but i'm going to name it

908
00:36:16,400 --> 00:36:18,240
get the flag.php

909
00:36:18,240 --> 00:36:19,920
and it would accept it

910
00:36:19,920 --> 00:36:21,599
because it was a you told it was jpeg

911
00:36:21,599 --> 00:36:23,839
data but you gave it a php file so you

912
00:36:23,839 --> 00:36:27,320
could execute it

913
00:36:27,440 --> 00:36:29,359
what was that

914
00:36:29,359 --> 00:36:30,880
only legal if you set the evil bit

915
00:36:30,880 --> 00:36:34,800
exactly you have to follow those rfcs

916
00:36:35,119 --> 00:36:38,079
okay uh web category bypass it filtered

917
00:36:38,079 --> 00:36:39,040
it

918
00:36:39,040 --> 00:36:40,880
so once again here now we're better

919
00:36:40,880 --> 00:36:42,240
known better but we were too sneaky for

920
00:36:42,240 --> 00:36:44,720
us we added the relevant file validation

921
00:36:44,720 --> 00:36:46,480
logic on the server side

922
00:36:46,480 --> 00:36:48,400
so now it's checking

923
00:36:48,400 --> 00:36:50,560
for if the

924
00:36:50,560 --> 00:36:52,400
mime types are correct and it's now

925
00:36:52,400 --> 00:36:54,800
going to check file extensions

926
00:36:54,800 --> 00:36:58,000
and it checks file extensions in a white

927
00:36:58,000 --> 00:36:59,040
list

928
00:36:59,040 --> 00:37:00,079
and

929
00:37:00,079 --> 00:37:01,839
if you're programming as a lazy

930
00:37:01,839 --> 00:37:03,520
developer and you mail the whitelist

931
00:37:03,520 --> 00:37:05,280
extensions and you think about how

932
00:37:05,280 --> 00:37:06,880
you're going to check it you say unless

933
00:37:06,880 --> 00:37:08,480
run some regex on it and i'm going to

934
00:37:08,480 --> 00:37:12,000
say if the file has dot png in it it's a

935
00:37:12,000 --> 00:37:13,839
valid file

936
00:37:13,839 --> 00:37:16,000
if it has jpeg in it it's a valid file

937
00:37:16,000 --> 00:37:18,880
what's the mistake there

938
00:37:18,880 --> 00:37:20,640
the mistake is that it can be anywhere

939
00:37:20,640 --> 00:37:22,560
in the file name you didn't just it

940
00:37:22,560 --> 00:37:24,880
wasn't just checking to see if jpeg was

941
00:37:24,880 --> 00:37:26,880
at the end of the file

942
00:37:26,880 --> 00:37:29,640
and so you could name it

943
00:37:29,640 --> 00:37:31,200
getmyflag.jpg.php

944
00:37:31,200 --> 00:37:32,880
and it would pass the file validation

945
00:37:32,880 --> 00:37:35,040
logic

946
00:37:35,040 --> 00:37:36,640
and it's uh and you might say that's

947
00:37:36,640 --> 00:37:39,040
contrived but it's not i've ran into

948
00:37:39,040 --> 00:37:42,000
this in production code

949
00:37:42,000 --> 00:37:44,000
so hopefully some of these challenges

950
00:37:44,000 --> 00:37:45,119
help you recognize problems that you

951
00:37:45,119 --> 00:37:47,839
might have in your environments

952
00:37:47,839 --> 00:37:50,880
okay so for the last one pwnedit

953
00:37:50,880 --> 00:37:53,359
this is a cool one and we went a little

954
00:37:53,359 --> 00:37:55,040
bit beyond

955
00:37:55,040 --> 00:37:58,160
uh the file validation problems in a

956
00:37:58,160 --> 00:37:59,680
unique way and i'm going to show you the

957
00:37:59,680 --> 00:38:01,119
code because that's what makes this one

958
00:38:01,119 --> 00:38:04,119
fun

959
00:38:04,800 --> 00:38:08,560
web where's my web ones

960
00:38:11,200 --> 00:38:15,240
sorry give me a second

961
00:38:22,960 --> 00:38:26,560
open my code okay so i have a

962
00:38:26,560 --> 00:38:29,200
blacklisted files and so in this

963
00:38:29,200 --> 00:38:31,599
application you cannot upload any file

964
00:38:31,599 --> 00:38:34,320
that has any of these extensions

965
00:38:34,320 --> 00:38:36,480
i won't if and this is a good validation

966
00:38:36,480 --> 00:38:39,359
logic if if it ends with extension this

967
00:38:39,359 --> 00:38:40,880
extension it will not make it to the

968
00:38:40,880 --> 00:38:42,480
server

969
00:38:42,480 --> 00:38:43,200
so

970
00:38:43,200 --> 00:38:45,200
i have a blacklist and if you look at

971
00:38:45,200 --> 00:38:48,079
this blacklist it's pretty complete

972
00:38:48,079 --> 00:38:50,480
my server will not execute will only

973
00:38:50,480 --> 00:38:54,320
execute things with these extensions

974
00:38:54,880 --> 00:38:56,880
the server is running apache

975
00:38:56,880 --> 00:38:59,119
and apache is connected to

976
00:38:59,119 --> 00:39:02,160
the php cgi executable

977
00:39:02,160 --> 00:39:03,359
and so here's where you need to know a

978
00:39:03,359 --> 00:39:05,680
little bit about how php and apache

979
00:39:05,680 --> 00:39:08,079
operate and how they integrate together

980
00:39:08,079 --> 00:39:10,480
because does anybody

981
00:39:10,480 --> 00:39:12,560
know how you tell apache

982
00:39:12,560 --> 00:39:15,839
to run php code

983
00:39:17,520 --> 00:39:19,839
so you tell it the interpreter you and

984
00:39:19,839 --> 00:39:21,839
your in your ht

985
00:39:21,839 --> 00:39:24,720
ht http config file tell hey if the

986
00:39:24,720 --> 00:39:27,920
extension is php or php5 or it has this

987
00:39:27,920 --> 00:39:29,280
mime type

988
00:39:29,280 --> 00:39:32,079
send it to php

989
00:39:32,079 --> 00:39:34,560
now how do you configure php well there

990
00:39:34,560 --> 00:39:37,440
you can do an http config file or every

991
00:39:37,440 --> 00:39:39,040
directory

992
00:39:39,040 --> 00:39:42,240
in apache can also have a dot ht access

993
00:39:42,240 --> 00:39:43,119
file

994
00:39:43,119 --> 00:39:45,200
this dot ht access file lets you

995
00:39:45,200 --> 00:39:47,280
configure php how or configure apache

996
00:39:47,280 --> 00:39:48,720
however you want to do for that

997
00:39:48,720 --> 00:39:50,960
directory only

998
00:39:50,960 --> 00:39:53,680
and so i didn't blacklist which is why

999
00:39:53,680 --> 00:39:55,520
blacklists can be a problem

1000
00:39:55,520 --> 00:39:58,160
the dot htaccess file

1001
00:39:58,160 --> 00:40:00,560
and so you could upload a hd access file

1002
00:40:00,560 --> 00:40:03,520
and modify the apache configuration to

1003
00:40:03,520 --> 00:40:06,880
run whatever file you wanted as php code

1004
00:40:06,880 --> 00:40:08,960
so you could say if the file extension

1005
00:40:08,960 --> 00:40:10,640
is dot

1006
00:40:10,640 --> 00:40:11,920
png

1007
00:40:11,920 --> 00:40:13,760
run it as php code and so you can

1008
00:40:13,760 --> 00:40:15,839
actually upload an image

1009
00:40:15,839 --> 00:40:17,440
that was php source

1010
00:40:17,440 --> 00:40:18,800
and tells apache to upload it once

1011
00:40:18,800 --> 00:40:21,040
you've modified it dot ht access

1012
00:40:21,040 --> 00:40:24,020
and that's the solution for that puzzle

1013
00:40:24,020 --> 00:40:32,750
[Applause]

1014
00:40:33,359 --> 00:40:35,200
next year there will be an sql puzzle

1015
00:40:35,200 --> 00:40:37,680
line like that that behaves similarly i

1016
00:40:37,680 --> 00:40:40,480
didn't get it finished this year

1017
00:40:40,480 --> 00:40:42,000
do you like those progressive puzzles

1018
00:40:42,000 --> 00:40:43,440
where they build the same website with

1019
00:40:43,440 --> 00:40:45,520
progressive challenges

1020
00:40:45,520 --> 00:40:47,759
okay

1021
00:40:51,200 --> 00:40:53,440
the now you see me puzzle

1022
00:40:53,440 --> 00:40:55,520
now you see me there's probably an

1023
00:40:55,520 --> 00:40:58,079
easier way than i did so

1024
00:40:58,079 --> 00:41:01,359
i i'd appreciate seeing how

1025
00:41:01,359 --> 00:41:03,359
you do it i went kind of in circles on

1026
00:41:03,359 --> 00:41:04,560
that one

1027
00:41:04,560 --> 00:41:07,520
okay um this one was another javascript

1028
00:41:07,520 --> 00:41:09,520
game that uh was built by tristan thank

1029
00:41:09,520 --> 00:41:12,480
you tristan um and the idea was that it

1030
00:41:12,480 --> 00:41:14,400
flashes a

1031
00:41:14,400 --> 00:41:17,119
string with your flag for like .12

1032
00:41:17,119 --> 00:41:20,480
milliseconds or a single frame

1033
00:41:20,480 --> 00:41:22,400
and there are several approaches here

1034
00:41:22,400 --> 00:41:24,480
and i there's not a wrong way or a right

1035
00:41:24,480 --> 00:41:25,839
way

1036
00:41:25,839 --> 00:41:27,839
you could have done a screen capture and

1037
00:41:27,839 --> 00:41:30,079
recorded your video on your screen

1038
00:41:30,079 --> 00:41:32,240
and stepped through those screens one

1039
00:41:32,240 --> 00:41:33,760
frame by frame

1040
00:41:33,760 --> 00:41:35,280
or to dig into javascript source and

1041
00:41:35,280 --> 00:41:36,400
find the

1042
00:41:36,400 --> 00:41:38,319
timer function and extend that timer so

1043
00:41:38,319 --> 00:41:39,839
it would play longer

1044
00:41:39,839 --> 00:41:41,839
those are the two methods i had looked

1045
00:41:41,839 --> 00:41:44,000
at myself and have seen done if you

1046
00:41:44,000 --> 00:41:45,520
solved it a different way i want to hear

1047
00:41:45,520 --> 00:41:47,359
about it because i'm curious and

1048
00:41:47,359 --> 00:41:49,839
entertained

1049
00:41:50,720 --> 00:41:53,680
i've got somebody coming up

1050
00:41:56,079 --> 00:41:58,240
i just put some break break points in

1051
00:41:58,240 --> 00:41:59,680
the

1052
00:41:59,680 --> 00:42:01,760
command line editor

1053
00:42:01,760 --> 00:42:04,480
and when it so when it reached those the

1054
00:42:04,480 --> 00:42:06,160
point where it's checking and it fails

1055
00:42:06,160 --> 00:42:08,240
that check i could step through

1056
00:42:08,240 --> 00:42:11,440
nice at that point and then it showed up

1057
00:42:11,440 --> 00:42:13,310
good job

1058
00:42:13,310 --> 00:42:18,319
[Applause]

1059
00:42:18,319 --> 00:42:21,440
i open up the javascript files that were

1060
00:42:21,440 --> 00:42:23,200
just loaded in the browser

1061
00:42:23,200 --> 00:42:26,000
read through the code figured out

1062
00:42:26,000 --> 00:42:28,960
one of the objects that was storing

1063
00:42:28,960 --> 00:42:31,599
the

1064
00:42:31,599 --> 00:42:33,680
value and

1065
00:42:33,680 --> 00:42:37,359
was able to go just use the console in

1066
00:42:37,359 --> 00:42:40,079
the devtools my browser and just figured

1067
00:42:40,079 --> 00:42:41,040
out

1068
00:42:41,040 --> 00:42:44,000
and said just print out this object that

1069
00:42:44,000 --> 00:42:46,880
was hanging out in memory and then

1070
00:42:46,880 --> 00:42:49,440
i was able to expand the object

1071
00:42:49,440 --> 00:42:51,359
and find a hidden

1072
00:42:51,359 --> 00:42:52,960
function that had the variable just

1073
00:42:52,960 --> 00:42:54,960
stored right there just sweet right

1074
00:42:54,960 --> 00:42:58,359
there in the console

1075
00:43:01,280 --> 00:43:03,520
so for that one i was digging through

1076
00:43:03,520 --> 00:43:05,280
the javascript and i found the part

1077
00:43:05,280 --> 00:43:06,160
where it

1078
00:43:06,160 --> 00:43:08,400
hides it for a random amount of time and

1079
00:43:08,400 --> 00:43:10,480
i said hide it for zero seconds every

1080
00:43:10,480 --> 00:43:12,000
time yeah so then it just showed up

1081
00:43:12,000 --> 00:43:14,560
permanently

1082
00:43:14,790 --> 00:43:18,319
[Applause]

1083
00:43:18,319 --> 00:43:20,000
okay we've got up time for about another

1084
00:43:20,000 --> 00:43:21,839
ten well i don't know 10 minutes i

1085
00:43:21,839 --> 00:43:22,800
think

1086
00:43:22,800 --> 00:43:23,599
and

1087
00:43:23,599 --> 00:43:25,440
so i've got two two or more questions

1088
00:43:25,440 --> 00:43:27,839
probably

1089
00:43:30,800 --> 00:43:32,400
i i don't know the complexity of this

1090
00:43:32,400 --> 00:43:34,000
one but it drove me crazy because i

1091
00:43:34,000 --> 00:43:35,359
thought i got the right answer could you

1092
00:43:35,359 --> 00:43:38,319
do the rfc pink hexadecimal rfc ping

1093
00:43:38,319 --> 00:43:41,839
hexadecimal okay

1094
00:43:47,839 --> 00:43:49,040
okay so

1095
00:43:49,040 --> 00:43:50,800
when you ping

1096
00:43:50,800 --> 00:43:54,359
0x 64199055

1097
00:43:54,880 --> 00:43:58,079
oh pink you pink not pinging

1098
00:43:58,079 --> 00:43:59,839
okay

1099
00:43:59,839 --> 00:44:02,960
okay a beautiful vivid pink and the word

1100
00:44:02,960 --> 00:44:05,520
to remove a file in leet

1101
00:44:05,520 --> 00:44:06,880
okay so

1102
00:44:06,880 --> 00:44:09,200
this one is

1103
00:44:09,200 --> 00:44:11,440
0x delete

1104
00:44:11,440 --> 00:44:15,119
is the the hexadecimal flag

1105
00:44:16,800 --> 00:44:19,359
the e's are e's

1106
00:44:19,359 --> 00:44:20,220
and the one

1107
00:44:20,220 --> 00:44:21,440
[Music]

1108
00:44:21,440 --> 00:44:23,280
and yes you have the one and the seven

1109
00:44:23,280 --> 00:44:26,319
and the e's or e's

1110
00:44:28,319 --> 00:44:30,640
and so what is zero x delete um i did

1111
00:44:30,640 --> 00:44:33,119
see people trying to answer it with an o

1112
00:44:33,119 --> 00:44:34,800
instead of a zero

1113
00:44:34,800 --> 00:44:37,440
so there were several people that uh

1114
00:44:37,440 --> 00:44:39,839
were putting o's oh x instead of zero x

1115
00:44:39,839 --> 00:44:41,359
um and there were several people that

1116
00:44:41,359 --> 00:44:44,480
tried threes instead of ease

1117
00:44:45,520 --> 00:44:47,040
if you if you want to check afterwards i

1118
00:44:47,040 --> 00:44:48,880
can look and see where what was going on

1119
00:44:48,880 --> 00:44:51,839
with your answer but

1120
00:44:52,160 --> 00:44:54,560
three instead of ease

1121
00:44:54,560 --> 00:44:56,000
and it's a beautiful color pink it's

1122
00:44:56,000 --> 00:44:57,040
almost the color of our hacker's

1123
00:44:57,040 --> 00:44:58,319
challenge pink

1124
00:44:58,319 --> 00:45:00,720
this year

1125
00:45:01,760 --> 00:45:02,800
so

1126
00:45:02,800 --> 00:45:05,040
i'd like to hear anybody so we solved

1127
00:45:05,040 --> 00:45:07,680
the the game the the

1128
00:45:07,680 --> 00:45:09,520
one where you start

1129
00:45:09,520 --> 00:45:11,839
if you are in the room that you can't

1130
00:45:11,839 --> 00:45:12,880
reach

1131
00:45:12,880 --> 00:45:15,040
um we solved it by

1132
00:45:15,040 --> 00:45:16,560
just making that our start position i'd

1133
00:45:16,560 --> 00:45:19,359
love to know how oh nice

1134
00:45:19,359 --> 00:45:21,040
okay so he's saying he's asking if

1135
00:45:21,040 --> 00:45:22,800
you've solved the uh

1136
00:45:22,800 --> 00:45:23,760
the

1137
00:45:23,760 --> 00:45:27,839
go sdl game um how did you approach

1138
00:45:27,839 --> 00:45:30,880
getting into the lock the hidden room

1139
00:45:30,880 --> 00:45:32,960
uh

1140
00:45:32,960 --> 00:45:36,960
you deleted the walls awesome

1141
00:45:36,960 --> 00:45:39,520
uh he started in the room when i play

1142
00:45:39,520 --> 00:45:42,160
tested this i patched the binary with a

1143
00:45:42,160 --> 00:45:44,480
no clipping patch and so i made it so

1144
00:45:44,480 --> 00:45:46,240
that when you hit the walls you could go

1145
00:45:46,240 --> 00:45:48,799
right through them

1146
00:45:49,359 --> 00:45:51,920
okay so on that game i don't know how

1147
00:45:51,920 --> 00:45:53,200
many of you played that and tried

1148
00:45:53,200 --> 00:45:55,119
reverse engines near those files

1149
00:45:55,119 --> 00:45:57,599
you could open various tools guidra

1150
00:45:57,599 --> 00:45:58,960
binary ninja

1151
00:45:58,960 --> 00:46:01,359
but i had the most success with reading

1152
00:46:01,359 --> 00:46:02,240
go

1153
00:46:02,240 --> 00:46:05,599
in ida free with their cloud decompiler

1154
00:46:05,599 --> 00:46:06,480
it

1155
00:46:06,480 --> 00:46:09,440
created some very readable uh main dot

1156
00:46:09,440 --> 00:46:12,839
main and other sub functions to be able

1157
00:46:12,839 --> 00:46:14,720
to uh

1158
00:46:14,720 --> 00:46:17,280
interpret what go was trying to do so if

1159
00:46:17,280 --> 00:46:18,960
you next time you approach go i would

1160
00:46:18,960 --> 00:46:20,960
suggest looking at the

1161
00:46:20,960 --> 00:46:24,720
item free in their cloud compiler

1162
00:46:26,720 --> 00:46:28,079
he says everything else wasn't very

1163
00:46:28,079 --> 00:46:29,280
pretty

1164
00:46:29,280 --> 00:46:31,680
yeah i was using ghidra and yeah it was

1165
00:46:31,680 --> 00:46:33,359
kind of a pain but

1166
00:46:33,359 --> 00:46:35,599
i think what i ended up doing was just

1167
00:46:35,599 --> 00:46:37,839
patching the binary to remove the check

1168
00:46:37,839 --> 00:46:40,240
for if you were like in the room and so

1169
00:46:40,240 --> 00:46:42,160
it just did it automatically as soon as

1170
00:46:42,160 --> 00:46:44,079
the game started nice

1171
00:46:44,079 --> 00:46:45,440
so it just like printed it out or

1172
00:46:45,440 --> 00:46:46,720
whatever

1173
00:46:46,720 --> 00:46:48,400
well thank you i hope you enjoyed

1174
00:46:48,400 --> 00:46:49,760
hacker's challenge that's the shakedown

1175
00:46:49,760 --> 00:46:51,680
for this year i will leave the games up

1176
00:46:51,680 --> 00:46:53,599
for a few days like not coming out on

1177
00:46:53,599 --> 00:46:55,599
time but i will post a tax challenge

1178
00:46:55,599 --> 00:46:58,480
we try to save some money for st con and

1179
00:46:58,480 --> 00:47:00,560
close cloud resources can get pricey but

1180
00:47:00,560 --> 00:47:02,319
uh thank you for complaining i hope you

1181
00:47:02,319 --> 00:47:03,920
enjoy it stick around for a few minutes

1182
00:47:03,920 --> 00:47:05,520
for closing ceremonies and we will go

1183
00:47:05,520 --> 00:47:07,680
through the top scores and awards and

1184
00:47:07,680 --> 00:47:08,970
prizes

1185
00:47:08,970 --> 00:47:14,488
[Applause]

