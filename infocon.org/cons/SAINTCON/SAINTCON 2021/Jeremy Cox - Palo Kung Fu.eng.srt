1
00:00:00,960 --> 00:00:02,159
all right so

2
00:00:02,159 --> 00:00:04,880
paulo kung fu um this is a rinse and

3
00:00:04,880 --> 00:00:07,680
repeat talk i did three years ago about

4
00:00:07,680 --> 00:00:10,240
palo alto we're going to talk a lot

5
00:00:10,240 --> 00:00:13,759
about um how to take and use a dark net

6
00:00:13,759 --> 00:00:16,079
and we'll talk about what that means but

7
00:00:16,079 --> 00:00:17,760
first of all my name is jeremy cox if

8
00:00:17,760 --> 00:00:20,240
you don't know me i'm super tech guy i'm

9
00:00:20,240 --> 00:00:22,160
the director of technology or the cto

10
00:00:22,160 --> 00:00:24,240
for washington county school district

11
00:00:24,240 --> 00:00:25,240
um

12
00:00:25,240 --> 00:00:27,519
supertechguy.com is where you're going

13
00:00:27,519 --> 00:00:30,640
to find this training at the end i have

14
00:00:30,640 --> 00:00:33,200
not posted it there yet it will be there

15
00:00:33,200 --> 00:00:35,440
uh probably tonight

16
00:00:35,440 --> 00:00:38,160
so if you want the slides you'll find

17
00:00:38,160 --> 00:00:40,800
them there at supertechguy.com slash

18
00:00:40,800 --> 00:00:42,320
training

19
00:00:42,320 --> 00:00:43,760
and all of the slides for every

20
00:00:43,760 --> 00:00:45,360
presentation i've done

21
00:00:45,360 --> 00:00:48,160
here at sync con are on there up to

22
00:00:48,160 --> 00:00:51,039
the ones that i couldn't remember um

23
00:00:51,039 --> 00:00:53,680
which are a very very long time ago so

24
00:00:53,680 --> 00:00:54,960
in this presentation we're going to

25
00:00:54,960 --> 00:00:57,280
examine how to leverage a portion of

26
00:00:57,280 --> 00:00:59,520
your address space on your network to

27
00:00:59,520 --> 00:01:02,239
monitor and mitigate attacks

28
00:01:02,239 --> 00:01:04,080
we'll discuss custom logging from the

29
00:01:04,080 --> 00:01:05,760
palo alto firewall

30
00:01:05,760 --> 00:01:07,760
to a linux log server

31
00:01:07,760 --> 00:01:09,439
we will discuss creating custom

32
00:01:09,439 --> 00:01:11,680
dashboards so that you can view these

33
00:01:11,680 --> 00:01:14,000
logs and we'll also discuss how to turn

34
00:01:14,000 --> 00:01:16,720
those logs into a list of ip addresses

35
00:01:16,720 --> 00:01:18,320
and then take

36
00:01:18,320 --> 00:01:19,119
and

37
00:01:19,119 --> 00:01:21,600
import those i p addresses as dynamic

38
00:01:21,600 --> 00:01:24,000
lists into the palo alto

39
00:01:24,000 --> 00:01:26,159
and then using them to block traffic

40
00:01:26,159 --> 00:01:29,119
from those addresses so the idea being

41
00:01:29,119 --> 00:01:31,520
is that we're going to teach you how to

42
00:01:31,520 --> 00:01:34,960
automate blocking on your palo based on

43
00:01:34,960 --> 00:01:37,520
a set of criteria that you make and the

44
00:01:37,520 --> 00:01:39,360
beauty of this is you don't need any of

45
00:01:39,360 --> 00:01:41,840
the custom subscriptions to do this if

46
00:01:41,840 --> 00:01:44,079
you have a palo alto firewall

47
00:01:44,079 --> 00:01:45,600
you can do this

48
00:01:45,600 --> 00:01:48,479
regardless of what subscription you have

49
00:01:48,479 --> 00:01:50,159
um the technologies we're going to use

50
00:01:50,159 --> 00:01:51,759
in this are the palo alto firewall

51
00:01:51,759 --> 00:01:53,200
obviously

52
00:01:53,200 --> 00:01:55,759
syslog ng is the logging choice that i

53
00:01:55,759 --> 00:01:58,880
use it's not the one you have to use

54
00:01:58,880 --> 00:02:02,320
but apache php and basically something

55
00:02:02,320 --> 00:02:04,159
that linux on that side is probably

56
00:02:04,159 --> 00:02:06,560
going to be your best choice

57
00:02:06,560 --> 00:02:08,399
it may work on others but today i'm

58
00:02:08,399 --> 00:02:09,440
going to show you how to do it with

59
00:02:09,440 --> 00:02:10,399
those

60
00:02:10,399 --> 00:02:11,680
and

61
00:02:11,680 --> 00:02:13,760
so the question is what is a dark knit

62
00:02:13,760 --> 00:02:15,520
now that we're not going to confuse this

63
00:02:15,520 --> 00:02:19,840
by the tor network or the dark net

64
00:02:19,840 --> 00:02:22,480
a dark net is basically a section of

65
00:02:22,480 --> 00:02:25,520
address space on your network that has

66
00:02:25,520 --> 00:02:27,440
nothing on it preferably something that

67
00:02:27,440 --> 00:02:30,319
has never had anything on it that won't

68
00:02:30,319 --> 00:02:32,319
ever have anything on it that you have

69
00:02:32,319 --> 00:02:34,800
no dns records that it will ever point

70
00:02:34,800 --> 00:02:38,239
to it or have ever pointed to it and no

71
00:02:38,239 --> 00:02:41,680
servers on it no references in any way

72
00:02:41,680 --> 00:02:43,120
and probably

73
00:02:43,120 --> 00:02:43,920
you

74
00:02:43,920 --> 00:02:46,720
the idea is to have something a space

75
00:02:46,720 --> 00:02:48,560
some address space

76
00:02:48,560 --> 00:02:49,760
that

77
00:02:49,760 --> 00:02:52,000
there's no good reason for anyone ever

78
00:02:52,000 --> 00:02:55,120
being there okay

79
00:02:55,120 --> 00:02:56,000
so

80
00:02:56,000 --> 00:02:57,599
what we're going to do with it is we're

81
00:02:57,599 --> 00:02:59,760
going to catch those automated scans so

82
00:02:59,760 --> 00:03:01,760
somebody comes in and they

83
00:03:01,760 --> 00:03:03,040
end map

84
00:03:03,040 --> 00:03:06,000
and use nmap and then scan your network

85
00:03:06,000 --> 00:03:07,280
there's a couple of different ways that

86
00:03:07,280 --> 00:03:08,959
can happen right you can go forward to

87
00:03:08,959 --> 00:03:10,480
backwards backwards to forwards or

88
00:03:10,480 --> 00:03:11,440
random

89
00:03:11,440 --> 00:03:13,920
randoms kind of hard to catch in any

90
00:03:13,920 --> 00:03:15,840
reasonable amount of time but if they go

91
00:03:15,840 --> 00:03:18,159
forwards or backwards

92
00:03:18,159 --> 00:03:21,200
then the idea is you could catch them

93
00:03:21,200 --> 00:03:23,120
quicker than maybe they get to some of

94
00:03:23,120 --> 00:03:25,440
the the internal stuff that you may not

95
00:03:25,440 --> 00:03:28,480
want them to see okay

96
00:03:28,799 --> 00:03:30,080
so

97
00:03:30,080 --> 00:03:31,760
the way you build a net is first you're

98
00:03:31,760 --> 00:03:33,760
going to determine how large of a dark

99
00:03:33,760 --> 00:03:36,400
net space to build um

100
00:03:36,400 --> 00:03:38,239
depending on how big of a network you're

101
00:03:38,239 --> 00:03:40,400
working with um

102
00:03:40,400 --> 00:03:42,159
you may be able to work with just a

103
00:03:42,159 --> 00:03:44,319
single slash 24

104
00:03:44,319 --> 00:03:46,080
if you're talking about a really large

105
00:03:46,080 --> 00:03:47,519
network you may want to do some more of

106
00:03:47,519 --> 00:03:49,599
that um

107
00:03:49,599 --> 00:03:51,519
though basically it's whatever you have

108
00:03:51,519 --> 00:03:52,799
to spare

109
00:03:52,799 --> 00:03:55,200
and how do you build it out well

110
00:03:55,200 --> 00:03:57,280
the idea is to build it out in such a

111
00:03:57,280 --> 00:03:59,280
way that you're going to see the traffic

112
00:03:59,280 --> 00:04:00,959
coming in but there's another

113
00:04:00,959 --> 00:04:02,560
interesting thing that happens is maybe

114
00:04:02,560 --> 00:04:04,080
you have somebody who's scanning

115
00:04:04,080 --> 00:04:05,840
internally on your network so you may

116
00:04:05,840 --> 00:04:07,599
also want to consider

117
00:04:07,599 --> 00:04:09,599
building it out in private space on your

118
00:04:09,599 --> 00:04:10,640
network

119
00:04:10,640 --> 00:04:13,120
now usually what i when i look at it i

120
00:04:13,120 --> 00:04:14,400
say okay

121
00:04:14,400 --> 00:04:16,399
i'm gonna when i've designed mine i

122
00:04:16,399 --> 00:04:18,720
thought okay well maybe i'll put my a

123
00:04:18,720 --> 00:04:20,880
dark net right in the at the beginning

124
00:04:20,880 --> 00:04:22,479
of my network a dark net at the end of

125
00:04:22,479 --> 00:04:24,080
my network and what the heck let's put

126
00:04:24,080 --> 00:04:26,320
one right in the smack dab middle okay

127
00:04:26,320 --> 00:04:28,400
it's kind of a guessing game there's no

128
00:04:28,400 --> 00:04:30,479
right or wrong way to do it it's just

129
00:04:30,479 --> 00:04:32,240
strategy how do you think you're going

130
00:04:32,240 --> 00:04:34,320
to be able to catch someone scanning

131
00:04:34,320 --> 00:04:36,960
your network

132
00:04:36,960 --> 00:04:37,919
so

133
00:04:37,919 --> 00:04:39,680
there's not really a wrong way to do

134
00:04:39,680 --> 00:04:42,880
this it's just okay if i'm seeing scans

135
00:04:42,880 --> 00:04:44,479
on my network where am i probably going

136
00:04:44,479 --> 00:04:47,040
to see them first

137
00:04:47,040 --> 00:04:48,000
okay

138
00:04:48,000 --> 00:04:49,919
um what if your address space is not

139
00:04:49,919 --> 00:04:51,120
contiguous

140
00:04:51,120 --> 00:04:52,479
a lot of you are going to run into this

141
00:04:52,479 --> 00:04:54,160
problem hey we got a bunch of address

142
00:04:54,160 --> 00:04:56,479
space but it's all over the board

143
00:04:56,479 --> 00:04:59,040
really just design it whatever you think

144
00:04:59,040 --> 00:05:01,520
is the best thing for you

145
00:05:01,520 --> 00:05:03,440
however you think it's going to use it

146
00:05:03,440 --> 00:05:06,800
best but even if you have non-contiguous

147
00:05:06,800 --> 00:05:08,720
public address space you're probably

148
00:05:08,720 --> 00:05:11,759
using contiguous private address space

149
00:05:11,759 --> 00:05:14,639
in your network so utilize that be smart

150
00:05:14,639 --> 00:05:16,400
about how you build those out plan it

151
00:05:16,400 --> 00:05:17,680
wisely

152
00:05:17,680 --> 00:05:18,960
so the very first thing that we're going

153
00:05:18,960 --> 00:05:22,320
to talk about is what to do for part one

154
00:05:22,320 --> 00:05:24,479
you're going to create a dark net zone

155
00:05:24,479 --> 00:05:26,320
in the palo alto now for those of you

156
00:05:26,320 --> 00:05:28,880
who use the pallos you know that

157
00:05:28,880 --> 00:05:30,800
there's lots of zone capabilities within

158
00:05:30,800 --> 00:05:32,960
the palos to define and you can create

159
00:05:32,960 --> 00:05:35,039
rules based on those zones

160
00:05:35,039 --> 00:05:37,039
now in this case we want its own

161
00:05:37,039 --> 00:05:38,560
specified zone we're going to call it

162
00:05:38,560 --> 00:05:39,600
dart net

163
00:05:39,600 --> 00:05:41,120
and then we're going to tie it to a

164
00:05:41,120 --> 00:05:44,160
specific interface

165
00:05:45,759 --> 00:05:48,400
and basically give an address to it and

166
00:05:48,400 --> 00:05:50,240
now you may tie it to multiple

167
00:05:50,240 --> 00:05:51,919
interfaces right and give it multiple

168
00:05:51,919 --> 00:05:53,280
addresses

169
00:05:53,280 --> 00:05:55,520
but ultimately

170
00:05:55,520 --> 00:05:56,880
we're going to tie it to that interface

171
00:05:56,880 --> 00:05:58,639
or we might create multiple interfaces

172
00:05:58,639 --> 00:06:00,560
that are tied to that same zone however

173
00:06:00,560 --> 00:06:01,919
you want to do it there's like i said

174
00:06:01,919 --> 00:06:03,680
there's not a lot of wrong ways to do

175
00:06:03,680 --> 00:06:04,479
this

176
00:06:04,479 --> 00:06:07,120
the idea is the same

177
00:06:07,120 --> 00:06:08,639
then you're going to want to create a

178
00:06:08,639 --> 00:06:10,880
syslog server profile once you've

179
00:06:10,880 --> 00:06:12,960
created that syslog server profile it

180
00:06:12,960 --> 00:06:16,240
allows you to push the data the logs in

181
00:06:16,240 --> 00:06:19,440
a very particular format so we can say

182
00:06:19,440 --> 00:06:22,000
hey i want a custom log format that

183
00:06:22,000 --> 00:06:23,919
looks like

184
00:06:23,919 --> 00:06:26,240
this

185
00:06:26,240 --> 00:06:27,360
so

186
00:06:27,360 --> 00:06:28,960
you can say i've got

187
00:06:28,960 --> 00:06:31,039
a threat and if you're using threat

188
00:06:31,039 --> 00:06:32,400
subscription you could do something like

189
00:06:32,400 --> 00:06:35,440
this and use the threat if not if you

190
00:06:35,440 --> 00:06:38,319
don't have any subscriptions usually

191
00:06:38,319 --> 00:06:39,919
basically you're looking at traffic

192
00:06:39,919 --> 00:06:42,880
right so you're going to say scan from

193
00:06:42,880 --> 00:06:45,600
source to destination

194
00:06:45,600 --> 00:06:48,319
and then we want the protocol the port

195
00:06:48,319 --> 00:06:49,759
and the application if there's an

196
00:06:49,759 --> 00:06:52,160
application detected by the palo

197
00:06:52,160 --> 00:06:54,960
okay now this is really crucial because

198
00:06:54,960 --> 00:06:56,960
building it in a format that both you

199
00:06:56,960 --> 00:06:58,479
can parse

200
00:06:58,479 --> 00:07:01,039
and both looks good on a dashboard can

201
00:07:01,039 --> 00:07:03,520
be very helpful to you as you're looking

202
00:07:03,520 --> 00:07:05,680
at these logs okay

203
00:07:05,680 --> 00:07:07,840
all right and you want to make sure that

204
00:07:07,840 --> 00:07:09,680
it's not just pushing it in its normal

205
00:07:09,680 --> 00:07:11,280
format because

206
00:07:11,280 --> 00:07:13,039
one it might be more difficult to parse

207
00:07:13,039 --> 00:07:14,479
it gives you a lot more information you

208
00:07:14,479 --> 00:07:15,680
probably need

209
00:07:15,680 --> 00:07:17,919
and two it doesn't look pretty on a nice

210
00:07:17,919 --> 00:07:19,759
dashboard unless you reformat do a whole

211
00:07:19,759 --> 00:07:21,759
lot of more work so you could do it that

212
00:07:21,759 --> 00:07:22,960
way but you're going to have to spend a

213
00:07:22,960 --> 00:07:25,280
lot more time on it

214
00:07:25,280 --> 00:07:26,800
so

215
00:07:26,800 --> 00:07:27,919
once again

216
00:07:27,919 --> 00:07:30,479
in real big letters we're in in the

217
00:07:30,479 --> 00:07:32,319
traffic we're going to say scan from

218
00:07:32,319 --> 00:07:34,560
dollar sign src

219
00:07:34,560 --> 00:07:36,960
two dollar sign dst

220
00:07:36,960 --> 00:07:39,680
and then i just put a a bar in there

221
00:07:39,680 --> 00:07:41,360
protocol

222
00:07:41,360 --> 00:07:44,479
destination port and application

223
00:07:44,479 --> 00:07:46,160
now like i said all of these slides are

224
00:07:46,160 --> 00:07:47,840
going to be on my website so you don't

225
00:07:47,840 --> 00:07:49,280
have to take pictures if you don't want

226
00:07:49,280 --> 00:07:52,240
to it'll be easy to find to follow from

227
00:07:52,240 --> 00:07:54,479
that point

228
00:07:54,479 --> 00:07:56,479
so at that point you're going to create

229
00:07:56,479 --> 00:07:59,440
your own custom log forwarding you're

230
00:07:59,440 --> 00:08:01,199
going to create a log forwarding profile

231
00:08:01,199 --> 00:08:03,120
that says hey i i have this log

232
00:08:03,120 --> 00:08:04,479
forwarding profile that we're going to

233
00:08:04,479 --> 00:08:06,000
later attach

234
00:08:06,000 --> 00:08:08,400
that's going to reference

235
00:08:08,400 --> 00:08:09,360
that

236
00:08:09,360 --> 00:08:11,759
the syslog server profile that you

237
00:08:11,759 --> 00:08:14,400
created earlier

238
00:08:14,400 --> 00:08:16,638
okay

239
00:08:17,120 --> 00:08:19,680
once that your is done

240
00:08:19,680 --> 00:08:21,520
very at the very very end you're going

241
00:08:21,520 --> 00:08:23,599
to want to create a policy

242
00:08:23,599 --> 00:08:25,759
that goes in and says at the very end of

243
00:08:25,759 --> 00:08:28,479
your trap at the end of your policies

244
00:08:28,479 --> 00:08:30,160
you're going to say we're going to catch

245
00:08:30,160 --> 00:08:33,120
every all the traffic that hits those

246
00:08:33,120 --> 00:08:35,839
dark nets scanners before it's allowed

247
00:08:35,839 --> 00:08:37,120
so we're going to let everything through

248
00:08:37,120 --> 00:08:39,599
that's already explicitly allowed and

249
00:08:39,599 --> 00:08:41,919
then anything else which there should be

250
00:08:41,919 --> 00:08:44,320
any openings to your dart net

251
00:08:44,320 --> 00:08:45,519
we're going to create a policy we're

252
00:08:45,519 --> 00:08:47,680
going to call it darkness scanners we're

253
00:08:47,680 --> 00:08:49,200
going to say okay if it comes from the

254
00:08:49,200 --> 00:08:51,839
outside or if you're working with a

255
00:08:51,839 --> 00:08:54,160
firewall on the inside you may want to

256
00:08:54,160 --> 00:08:56,000
say you know if it's coming and it's

257
00:08:56,000 --> 00:08:58,399
hitting the 192 or 192

258
00:08:58,399 --> 00:09:00,640
or 10 or any of the private address

259
00:09:00,640 --> 00:09:03,040
space you may change this but right now

260
00:09:03,040 --> 00:09:04,720
we're working with public address space

261
00:09:04,720 --> 00:09:06,560
so we know it's probably going to come

262
00:09:06,560 --> 00:09:10,000
from the outside you could also say

263
00:09:10,000 --> 00:09:12,560
you could say it comes from any zone

264
00:09:12,560 --> 00:09:14,480
that way if it comes from the inside or

265
00:09:14,480 --> 00:09:16,720
the outside it's going to catch this

266
00:09:16,720 --> 00:09:19,279
rule okay in this case i said outside

267
00:09:19,279 --> 00:09:22,560
but it could be any of those zones so

268
00:09:22,560 --> 00:09:25,839
um and then the most important part is

269
00:09:25,839 --> 00:09:29,839
it's going to the zone darknet

270
00:09:30,160 --> 00:09:32,399
so we go to actions we're going to deny

271
00:09:32,399 --> 00:09:34,399
it we automatically are going to deny it

272
00:09:34,399 --> 00:09:36,480
we don't want it to do anything

273
00:09:36,480 --> 00:09:38,560
but then that's where we go in we set

274
00:09:38,560 --> 00:09:40,560
our log forwarding to that dark net

275
00:09:40,560 --> 00:09:43,519
scanner to that log forwarding profile

276
00:09:43,519 --> 00:09:46,160
so now any bit of traffic that comes

277
00:09:46,160 --> 00:09:47,680
into the palo

278
00:09:47,680 --> 00:09:49,519
tries to hit

279
00:09:49,519 --> 00:09:51,040
that network

280
00:09:51,040 --> 00:09:53,360
it's immediately going to say okay

281
00:09:53,360 --> 00:09:55,040
you get pushed over to this log

282
00:09:55,040 --> 00:09:57,279
forwarding profile that gets pushed to

283
00:09:57,279 --> 00:09:59,839
this syslog server that we've built for

284
00:09:59,839 --> 00:10:01,120
this purpose

285
00:10:01,120 --> 00:10:03,680
or even a regular syslog server that you

286
00:10:03,680 --> 00:10:05,519
use by your organization and you've

287
00:10:05,519 --> 00:10:07,839
created a rule that it funnels that log

288
00:10:07,839 --> 00:10:10,640
into a file

289
00:10:11,279 --> 00:10:12,959
so this is what it looks like in syslog

290
00:10:12,959 --> 00:10:14,480
ng

291
00:10:14,480 --> 00:10:16,399
so right now

292
00:10:16,399 --> 00:10:18,720
in syslog ng you should be getting logs

293
00:10:18,720 --> 00:10:20,560
that look something like this

294
00:10:20,560 --> 00:10:22,240
scan from

295
00:10:22,240 --> 00:10:23,279
um

296
00:10:23,279 --> 00:10:26,160
where it's coming from where it's going

297
00:10:26,160 --> 00:10:28,640
what type of traffic is it udp

298
00:10:28,640 --> 00:10:30,880
is it tcp what port

299
00:10:30,880 --> 00:10:33,120
and what application if the pallow

300
00:10:33,120 --> 00:10:35,279
detected it now in most of these cases

301
00:10:35,279 --> 00:10:36,640
the palo is not going to detect the

302
00:10:36,640 --> 00:10:38,640
application because it needs to see the

303
00:10:38,640 --> 00:10:39,920
handshake so you're not going to see

304
00:10:39,920 --> 00:10:41,440
that a lot

305
00:10:41,440 --> 00:10:43,279
because in most cases it has to actually

306
00:10:43,279 --> 00:10:46,880
see the handshake um so we're going to

307
00:10:46,880 --> 00:10:48,800
create a filter

308
00:10:48,800 --> 00:10:50,560
that's going to send all those logs into

309
00:10:50,560 --> 00:10:52,800
one file because otherwise it's going to

310
00:10:52,800 --> 00:10:55,040
say it's stuffed in syslog ng in your

311
00:10:55,040 --> 00:10:57,360
regular log file and mixed with

312
00:10:57,360 --> 00:10:59,279
everything else so we're going to create

313
00:10:59,279 --> 00:11:02,000
a source that's based on udp

314
00:11:02,000 --> 00:11:04,320
and then a destination

315
00:11:04,320 --> 00:11:07,360
which is the file darknet.log

316
00:11:07,360 --> 00:11:08,320
okay

317
00:11:08,320 --> 00:11:10,640
and we're going to grant it owner root

318
00:11:10,640 --> 00:11:13,120
and group wwe data and we'll tell you

319
00:11:13,120 --> 00:11:15,200
i'll show you why it's important that we

320
00:11:15,200 --> 00:11:17,680
actually give it to the web user

321
00:11:17,680 --> 00:11:20,079
later

322
00:11:20,480 --> 00:11:22,240
then we're going to create a filter

323
00:11:22,240 --> 00:11:25,120
basically we're going to say if it comes

324
00:11:25,120 --> 00:11:28,959
from that firewall you can do this now

325
00:11:28,959 --> 00:11:31,040
if it's not the only thing you have

326
00:11:31,040 --> 00:11:32,959
coming from that firewall you may want

327
00:11:32,959 --> 00:11:34,399
to do something more like what you have

328
00:11:34,399 --> 00:11:36,880
at the bottom which basically says if it

329
00:11:36,880 --> 00:11:39,839
comes from this firewall and it says

330
00:11:39,839 --> 00:11:43,600
scan from or message threat from which

331
00:11:43,600 --> 00:11:46,560
is why we created that custom language

332
00:11:46,560 --> 00:11:48,480
in the log forwarding

333
00:11:48,480 --> 00:11:50,560
then we're going to stuff it into that

334
00:11:50,560 --> 00:11:53,279
particular darknet log

335
00:11:53,279 --> 00:11:55,760
okay we tie it all together with a log

336
00:11:55,760 --> 00:11:59,600
declaration which is darknet log um we

337
00:11:59,600 --> 00:12:02,000
do your source the filter and the

338
00:12:02,000 --> 00:12:04,639
destination and in the end you should

339
00:12:04,639 --> 00:12:07,360
have a file show up that looks like that

340
00:12:07,360 --> 00:12:09,360
that says dartnet.log

341
00:12:09,360 --> 00:12:10,720
okay

342
00:12:10,720 --> 00:12:12,160
and then of course you want to set up

343
00:12:12,160 --> 00:12:13,680
log rotate otherwise that log will

344
00:12:13,680 --> 00:12:16,959
become insanely large and fill up your

345
00:12:16,959 --> 00:12:19,200
firewall so when you're done when you're

346
00:12:19,200 --> 00:12:21,040
seeing the log rotates you should see

347
00:12:21,040 --> 00:12:23,360
something like this

348
00:12:23,360 --> 00:12:24,959
and based off of

349
00:12:24,959 --> 00:12:27,599
excuse me

350
00:12:27,680 --> 00:12:29,279
based off this script that we've set

351
00:12:29,279 --> 00:12:31,920
here to do a log rotate i'm showing only

352
00:12:31,920 --> 00:12:34,320
14 days now you could do more than that

353
00:12:34,320 --> 00:12:36,480
if you wanted to the challenge is

354
00:12:36,480 --> 00:12:38,880
depending on how many

355
00:12:38,880 --> 00:12:41,120
how many things you have funneled into

356
00:12:41,120 --> 00:12:43,600
this how many i p addresses are actually

357
00:12:43,600 --> 00:12:46,240
scanning you each day which are probably

358
00:12:46,240 --> 00:12:49,440
if you're like me a whole heck of a lot

359
00:12:49,440 --> 00:12:51,680
then this is going to be a lot of

360
00:12:51,680 --> 00:12:53,920
addresses and your palo is probably not

361
00:12:53,920 --> 00:12:57,279
going to be able to handle 14 days worth

362
00:12:57,279 --> 00:12:59,680
of addresses okay you're probably only

363
00:12:59,680 --> 00:13:01,120
looking at a couple days worth of

364
00:13:01,120 --> 00:13:03,920
addresses and maybe some for historical

365
00:13:03,920 --> 00:13:05,760
purposes

366
00:13:05,760 --> 00:13:08,720
so you'll see 14 days worth of logs

367
00:13:08,720 --> 00:13:10,079
and this is what we would do on the

368
00:13:10,079 --> 00:13:13,120
apache side

369
00:13:14,880 --> 00:13:16,480
and i don't know why that slide is in

370
00:13:16,480 --> 00:13:17,279
there

371
00:13:17,279 --> 00:13:19,600
at all

372
00:13:19,600 --> 00:13:20,880
okay

373
00:13:20,880 --> 00:13:24,720
if you go to um supertechguy.com

374
00:13:24,720 --> 00:13:25,839
training

375
00:13:25,839 --> 00:13:28,200
you'll also find this log

376
00:13:28,200 --> 00:13:30,160
dash.tar.gz file

377
00:13:30,160 --> 00:13:32,639
which contains the code

378
00:13:32,639 --> 00:13:34,560
okay that basically gives you a

379
00:13:34,560 --> 00:13:38,000
dashboard that looks just like that

380
00:13:38,000 --> 00:13:38,959
okay

381
00:13:38,959 --> 00:13:41,279
so that you can put this up on a screen

382
00:13:41,279 --> 00:13:43,120
and show exactly what's happening on

383
00:13:43,120 --> 00:13:45,120
your network in our case we actually

384
00:13:45,120 --> 00:13:46,959
took and we have some other dashboards

385
00:13:46,959 --> 00:13:49,120
that are above this and down below it

386
00:13:49,120 --> 00:13:51,120
just scrolls through and shows us who's

387
00:13:51,120 --> 00:13:54,000
currently attacking us or scanning us

388
00:13:54,000 --> 00:13:56,079
now the cool thing is that you can also

389
00:13:56,079 --> 00:13:57,600
funnel back

390
00:13:57,600 --> 00:13:59,440
from your other file walls as they

391
00:13:59,440 --> 00:14:01,519
detect these attacks

392
00:14:01,519 --> 00:14:04,959
you can funnel back those same exact

393
00:14:04,959 --> 00:14:07,440
um syslog packets back into that same

394
00:14:07,440 --> 00:14:10,399
dark net file and then you'll also see

395
00:14:10,399 --> 00:14:12,800
which ones are actually getting blocked

396
00:14:12,800 --> 00:14:14,639
as they're coming through so you see the

397
00:14:14,639 --> 00:14:16,959
scan come through and then you see it

398
00:14:16,959 --> 00:14:20,160
getting blocked later on

399
00:14:24,000 --> 00:14:26,880
okay so this is the particular file um

400
00:14:26,880 --> 00:14:28,560
that we've got that basically is going

401
00:14:28,560 --> 00:14:31,600
to go through and create a

402
00:14:31,600 --> 00:14:34,240
list that you can then take

403
00:14:34,240 --> 00:14:37,040
off of that dark net log okay i know

404
00:14:37,040 --> 00:14:39,120
this is kind of rough

405
00:14:39,120 --> 00:14:41,600
it's a lot of technical detail

406
00:14:41,600 --> 00:14:43,760
you're going to take that dart net log

407
00:14:43,760 --> 00:14:45,760
and then you're going to push it into a

408
00:14:45,760 --> 00:14:48,560
file a text file then the palo alto can

409
00:14:48,560 --> 00:14:50,639
actually understand because the palo

410
00:14:50,639 --> 00:14:51,920
looks at when you're going to create a

411
00:14:51,920 --> 00:14:53,440
dynamic list

412
00:14:53,440 --> 00:14:55,360
you're going to say okay

413
00:14:55,360 --> 00:14:57,680
a dynamic list is basically a text file

414
00:14:57,680 --> 00:15:00,240
of ip addresses that's all it is

415
00:15:00,240 --> 00:15:02,480
but if you try to feed that dark net log

416
00:15:02,480 --> 00:15:04,079
into it it's not going to have a clue

417
00:15:04,079 --> 00:15:05,279
what to do

418
00:15:05,279 --> 00:15:07,839
you need a list of just the ip addresses

419
00:15:07,839 --> 00:15:09,600
that are in

420
00:15:09,600 --> 00:15:10,800
that log

421
00:15:10,800 --> 00:15:12,560
and then unique ones you don't want it

422
00:15:12,560 --> 00:15:13,680
to repeat

423
00:15:13,680 --> 00:15:15,440
you want the palo to do more work than

424
00:15:15,440 --> 00:15:18,240
it needs to do okay so the idea is

425
00:15:18,240 --> 00:15:20,480
you're gonna say okay on page now the

426
00:15:20,480 --> 00:15:22,079
beauty of this is it allows you to do

427
00:15:22,079 --> 00:15:24,880
multiple days worth of logs so say you

428
00:15:24,880 --> 00:15:26,399
want to take

429
00:15:26,399 --> 00:15:27,360
and

430
00:15:27,360 --> 00:15:29,440
i want to see yesterday's logs and i

431
00:15:29,440 --> 00:15:31,920
want to import those also into the palo

432
00:15:31,920 --> 00:15:34,320
and use it to block tuesday's worth of

433
00:15:34,320 --> 00:15:35,680
logs okay

434
00:15:35,680 --> 00:15:36,959
you can do that

435
00:15:36,959 --> 00:15:39,279
so the idea is you go and you say okay

436
00:15:39,279 --> 00:15:41,680
this is php code that will go in and

437
00:15:41,680 --> 00:15:43,759
basically run the the script pass

438
00:15:43,759 --> 00:15:44,560
through

439
00:15:44,560 --> 00:15:46,720
run the the command pass through which

440
00:15:46,720 --> 00:15:49,120
is going to cat basically whatever it

441
00:15:49,120 --> 00:15:51,040
sees on the command line it's just going

442
00:15:51,040 --> 00:15:54,560
to pass it back to to apache to ph

443
00:15:54,560 --> 00:15:56,800
through php

444
00:15:56,800 --> 00:15:58,959
whatever that output is so in this case

445
00:15:58,959 --> 00:16:00,639
we're going to cat

446
00:16:00,639 --> 00:16:01,480
uh

447
00:16:01,480 --> 00:16:03,519
varlog.net.log and then we're going to

448
00:16:03,519 --> 00:16:06,000
pipe it to a program called awk now awk

449
00:16:06,000 --> 00:16:09,120
will take and filter it in a specific

450
00:16:09,120 --> 00:16:11,600
way and in this particular case awk is

451
00:16:11,600 --> 00:16:13,839
looking at it and saying okay i want to

452
00:16:13,839 --> 00:16:16,160
print field number seven

453
00:16:16,160 --> 00:16:17,199
okay

454
00:16:17,199 --> 00:16:19,600
and i want to print

455
00:16:19,600 --> 00:16:22,880
a slash 32 at the end so basically what

456
00:16:22,880 --> 00:16:24,560
we're doing is we're saying field number

457
00:16:24,560 --> 00:16:26,959
seven happens to be the ip address where

458
00:16:26,959 --> 00:16:29,600
the attack or the scan is coming from

459
00:16:29,600 --> 00:16:32,800
okay and a slash 32 is what paulo is

460
00:16:32,800 --> 00:16:35,839
expecting because it has to see it in a

461
00:16:35,839 --> 00:16:38,800
cider format okay you can't just feed an

462
00:16:38,800 --> 00:16:40,720
ip address there you've got to actually

463
00:16:40,720 --> 00:16:43,920
feed a cider formatted network address

464
00:16:43,920 --> 00:16:46,880
this happens to be a network of one okay

465
00:16:46,880 --> 00:16:49,440
then we're gonna sort it in order

466
00:16:49,440 --> 00:16:50,959
all right so we have all the ip

467
00:16:50,959 --> 00:16:52,800
addresses sorted in order and then we're

468
00:16:52,800 --> 00:16:54,639
going to run unique

469
00:16:54,639 --> 00:16:57,040
which is going to take and limit it down

470
00:16:57,040 --> 00:17:00,639
to just 100 just the unique ip addresses

471
00:17:00,639 --> 00:17:02,000
in that list

472
00:17:02,000 --> 00:17:03,759
does that make sense

473
00:17:03,759 --> 00:17:06,720
so ultimately what you'll get

474
00:17:06,720 --> 00:17:10,000
is something that looks like this

475
00:17:10,319 --> 00:17:12,639
okay

476
00:17:12,720 --> 00:17:14,640
and you'll see just the unique ib

477
00:17:14,640 --> 00:17:16,319
addresses that have actually scanned

478
00:17:16,319 --> 00:17:19,359
your dark net once you have that list

479
00:17:19,359 --> 00:17:20,720
then there's a lot of power that comes

480
00:17:20,720 --> 00:17:22,319
with that now you'll notice that the

481
00:17:22,319 --> 00:17:24,559
other ones if it's page one it says go

482
00:17:24,559 --> 00:17:27,119
to dart net log dot one and if it's

483
00:17:27,119 --> 00:17:28,559
something else

484
00:17:28,559 --> 00:17:31,919
then go to dark night dog dot and then

485
00:17:31,919 --> 00:17:34,320
dollar sign page so whatever that is

486
00:17:34,320 --> 00:17:36,799
whatever page you're asking for dot gz

487
00:17:36,799 --> 00:17:39,120
and you notice

488
00:17:39,120 --> 00:17:41,360
everything past that is going to be gz

489
00:17:41,360 --> 00:17:43,840
and it's going to be gc compressed

490
00:17:43,840 --> 00:17:44,799
okay

491
00:17:44,799 --> 00:17:46,960
so you got to use z cat instead of this

492
00:17:46,960 --> 00:17:48,000
cat

493
00:17:48,000 --> 00:17:50,080
all right so that's why that that script

494
00:17:50,080 --> 00:17:53,039
looks the way it does

495
00:17:53,440 --> 00:17:54,640
you're going to get a list that looks

496
00:17:54,640 --> 00:17:56,080
like this

497
00:17:56,080 --> 00:17:57,360
and then you're going to go back to the

498
00:17:57,360 --> 00:17:58,559
palo

499
00:17:58,559 --> 00:18:00,799
and what you're going to do on the palo

500
00:18:00,799 --> 00:18:02,320
and you can do this on all of the

501
00:18:02,320 --> 00:18:04,080
firewalls in your organization this is

502
00:18:04,080 --> 00:18:05,520
the beauty behind it

503
00:18:05,520 --> 00:18:07,280
is that within

504
00:18:07,280 --> 00:18:09,840
whatever you set as your repeat which in

505
00:18:09,840 --> 00:18:12,080
my case i set it for five minutes

506
00:18:12,080 --> 00:18:14,799
so somebody comes in they scan one of

507
00:18:14,799 --> 00:18:16,960
these dark net addresses

508
00:18:16,960 --> 00:18:19,120
within five minutes that ip address is

509
00:18:19,120 --> 00:18:21,440
blocked on every single firewall in my

510
00:18:21,440 --> 00:18:23,600
organization done

511
00:18:23,600 --> 00:18:25,600
automated complete

512
00:18:25,600 --> 00:18:26,720
okay

513
00:18:26,720 --> 00:18:28,320
all right so we're going to create an ip

514
00:18:28,320 --> 00:18:30,799
list an external dynamic list

515
00:18:30,799 --> 00:18:32,880
and it's an ip list and then we're going

516
00:18:32,880 --> 00:18:35,440
to point it directly the source

517
00:18:35,440 --> 00:18:38,320
directly at that page that we just

518
00:18:38,320 --> 00:18:39,919
created okay

519
00:18:39,919 --> 00:18:42,720
now in this case i'm actually it's a php

520
00:18:42,720 --> 00:18:45,520
script but it shows up as a text file

521
00:18:45,520 --> 00:18:47,520
when it gets pulled and then i want to

522
00:18:47,520 --> 00:18:50,000
pull it every five minutes

523
00:18:50,000 --> 00:18:51,039
okay

524
00:18:51,039 --> 00:18:53,760
and then i'm going to take those

525
00:18:53,760 --> 00:18:55,360
dynamic lists and i'll maybe create

526
00:18:55,360 --> 00:18:57,200
another one so for instance i'm going to

527
00:18:57,200 --> 00:18:58,799
have one that's going to be

528
00:18:58,799 --> 00:19:01,360
current which is what's happening today

529
00:19:01,360 --> 00:19:02,880
one that's going to be what happened

530
00:19:02,880 --> 00:19:04,720
yesterday and one that's going to be

531
00:19:04,720 --> 00:19:06,480
what happened to the day before and you

532
00:19:06,480 --> 00:19:08,160
can do as many as

533
00:19:08,160 --> 00:19:10,240
these as you want to up to the point

534
00:19:10,240 --> 00:19:12,000
that you have to look at

535
00:19:12,000 --> 00:19:14,320
how many external dynamic lists or how

536
00:19:14,320 --> 00:19:17,280
many ip addresses can your palo handle

537
00:19:17,280 --> 00:19:19,360
in external dynamic lists

538
00:19:19,360 --> 00:19:21,280
because there is a limitation

539
00:19:21,280 --> 00:19:24,400
and you can't do 30 days worth you can

540
00:19:24,400 --> 00:19:26,559
probably only get away with a few days

541
00:19:26,559 --> 00:19:29,280
worth okay

542
00:19:29,280 --> 00:19:32,240
and basically that first one we know the

543
00:19:32,240 --> 00:19:33,440
current one

544
00:19:33,440 --> 00:19:34,960
we know we want to pull that up every

545
00:19:34,960 --> 00:19:36,720
five minutes and refresh it the other

546
00:19:36,720 --> 00:19:39,679
ones we know we only need to pull it

547
00:19:39,679 --> 00:19:41,840
once that day because it's not going to

548
00:19:41,840 --> 00:19:43,919
change what happened yesterday

549
00:19:43,919 --> 00:19:46,080
okay but the beauty behind this is now

550
00:19:46,080 --> 00:19:47,520
we know that

551
00:19:47,520 --> 00:19:49,840
we've got three days worth of blocks so

552
00:19:49,840 --> 00:19:52,880
you scan our network okay you're going

553
00:19:52,880 --> 00:19:55,360
to be blocked for at least three days

554
00:19:55,360 --> 00:19:57,120
in this case

555
00:19:57,120 --> 00:19:58,480
you may configure your firewall

556
00:19:58,480 --> 00:20:00,720
differently and maybe do more than three

557
00:20:00,720 --> 00:20:02,960
days or less depending on what your

558
00:20:02,960 --> 00:20:05,280
constraints are

559
00:20:05,280 --> 00:20:07,039
okay now we're going to create that

560
00:20:07,039 --> 00:20:09,760
other syslog profile that i talked about

561
00:20:09,760 --> 00:20:12,080
these are the blocked attacks

562
00:20:12,080 --> 00:20:13,120
all right

563
00:20:13,120 --> 00:20:15,360
so this we're going to go in we're going

564
00:20:15,360 --> 00:20:17,120
to create the exact same thing send it

565
00:20:17,120 --> 00:20:19,280
to the exact same server except this

566
00:20:19,280 --> 00:20:20,559
time

567
00:20:20,559 --> 00:20:22,240
in the traffic log i'm going to say

568
00:20:22,240 --> 00:20:24,400
attack has now been blocked

569
00:20:24,400 --> 00:20:26,720
from source to destination using this

570
00:20:26,720 --> 00:20:28,400
protocol this port

571
00:20:28,400 --> 00:20:31,280
and this application and then i like to

572
00:20:31,280 --> 00:20:33,760
at the end reference where is this block

573
00:20:33,760 --> 00:20:35,360
actually coming from because we have

574
00:20:35,360 --> 00:20:37,360
other ways that we pull blocks from that

575
00:20:37,360 --> 00:20:39,039
are automated

576
00:20:39,039 --> 00:20:39,919
and

577
00:20:39,919 --> 00:20:41,679
dart net's just one of them so in this

578
00:20:41,679 --> 00:20:44,400
case i put drk at the end so i know this

579
00:20:44,400 --> 00:20:46,799
is what why this attack was blocked what

580
00:20:46,799 --> 00:20:49,440
actually blocked it so if i ever need to

581
00:20:49,440 --> 00:20:52,559
go back and say why is some traffic not

582
00:20:52,559 --> 00:20:54,640
working i can look through this log file

583
00:20:54,640 --> 00:20:57,360
and say oh that's why it's not working

584
00:20:57,360 --> 00:20:59,600
okay

585
00:21:01,200 --> 00:21:02,159
and then we're going to create that

586
00:21:02,159 --> 00:21:04,720
custom log forwarding once again

587
00:21:04,720 --> 00:21:07,200
tie it back to that blocked attack

588
00:21:07,200 --> 00:21:08,640
and

589
00:21:08,640 --> 00:21:11,200
set that up

590
00:21:11,200 --> 00:21:13,039
and then we're going to create a block

591
00:21:13,039 --> 00:21:14,720
based on those lists now this would go

592
00:21:14,720 --> 00:21:16,320
at the very very beginning of your

593
00:21:16,320 --> 00:21:18,240
firewall that you're going to say hey i

594
00:21:18,240 --> 00:21:20,080
want to block darkneck scanners if

595
00:21:20,080 --> 00:21:22,400
you're using panorama it makes it really

596
00:21:22,400 --> 00:21:24,880
easy just to push this all out as a the

597
00:21:24,880 --> 00:21:27,200
very very beginning of your lists

598
00:21:27,200 --> 00:21:29,280
on all of your access lists for your

599
00:21:29,280 --> 00:21:31,679
rules you can set up a rule that will

600
00:21:31,679 --> 00:21:33,200
just go out to everything on your

601
00:21:33,200 --> 00:21:34,240
network

602
00:21:34,240 --> 00:21:35,520
okay

603
00:21:35,520 --> 00:21:36,880
and then you're going to reference

604
00:21:36,880 --> 00:21:39,360
anytime it comes from these sources and

605
00:21:39,360 --> 00:21:42,159
it comes from any interface any zone to

606
00:21:42,159 --> 00:21:44,080
any of those source addresses those

607
00:21:44,080 --> 00:21:45,679
external dynamic lists that we just

608
00:21:45,679 --> 00:21:46,720
created

609
00:21:46,720 --> 00:21:47,600
okay

610
00:21:47,600 --> 00:21:49,200
and then we're going to take at the end

611
00:21:49,200 --> 00:21:50,320
we're going to say we're going to deny

612
00:21:50,320 --> 00:21:52,080
it again and we're going to do a log

613
00:21:52,080 --> 00:21:56,399
forwarding to a blocked attack

614
00:21:56,799 --> 00:21:58,880
and that's all it is

615
00:21:58,880 --> 00:22:00,720
so

616
00:22:00,720 --> 00:22:03,039
i covered that in 20 minutes

617
00:22:03,039 --> 00:22:05,360
and maybe i went way too fast but let me

618
00:22:05,360 --> 00:22:07,280
tell you the rundown of this

619
00:22:07,280 --> 00:22:09,520
we've been running this the last time i

620
00:22:09,520 --> 00:22:12,080
did this presentation

621
00:22:12,080 --> 00:22:13,840
three years ago

622
00:22:13,840 --> 00:22:16,159
we had been running it for about a year

623
00:22:16,159 --> 00:22:17,840
we had no issues

624
00:22:17,840 --> 00:22:20,240
we've now been running it for four years

625
00:22:20,240 --> 00:22:22,480
we've still had no issues

626
00:22:22,480 --> 00:22:24,880
none i haven't had

627
00:22:24,880 --> 00:22:26,559
except for

628
00:22:26,559 --> 00:22:29,679
when i've had people get curious

629
00:22:29,679 --> 00:22:31,440
and start to play

630
00:22:31,440 --> 00:22:33,840
on my network i have never seen

631
00:22:33,840 --> 00:22:36,880
legitimate traffic blocked by this

632
00:22:36,880 --> 00:22:38,960
which tells me something

633
00:22:38,960 --> 00:22:40,159
because that was one of the biggest

634
00:22:40,159 --> 00:22:41,679
things that we were concerned about and

635
00:22:41,679 --> 00:22:43,039
it's probably one of the biggest things

636
00:22:43,039 --> 00:22:45,120
in your mind okay so if i set an

637
00:22:45,120 --> 00:22:47,760
automated blocking to a darknet based

638
00:22:47,760 --> 00:22:48,799
off of

639
00:22:48,799 --> 00:22:50,960
traffic that hits the dark net what is

640
00:22:50,960 --> 00:22:52,960
that going to break

641
00:22:52,960 --> 00:22:55,039
this is the thing is

642
00:22:55,039 --> 00:22:56,799
nobody should ever be talking to that

643
00:22:56,799 --> 00:22:58,960
space like i said you want to build this

644
00:22:58,960 --> 00:23:00,799
space in such a way that nothing's ever

645
00:23:00,799 --> 00:23:03,200
been on it nothing's pointed at it

646
00:23:03,200 --> 00:23:05,360
there's no reason for anyone to ever be

647
00:23:05,360 --> 00:23:08,000
there and as long as you can do that and

648
00:23:08,000 --> 00:23:10,400
you have the capability the capability

649
00:23:10,400 --> 00:23:12,480
to do that you should have no issues

650
00:23:12,480 --> 00:23:14,960
with this now

651
00:23:14,960 --> 00:23:16,640
is that a guarantee no nothing's

652
00:23:16,640 --> 00:23:18,320
guaranteed but i can tell you that we've

653
00:23:18,320 --> 00:23:20,720
had great success with it and the beauty

654
00:23:20,720 --> 00:23:23,520
behind it is we look at this traffic

655
00:23:23,520 --> 00:23:24,640
every day

656
00:23:24,640 --> 00:23:26,960
and we go okay there just goes

657
00:23:26,960 --> 00:23:29,039
you see somebody come in and start

658
00:23:29,039 --> 00:23:31,760
scanning the network and then suddenly

659
00:23:31,760 --> 00:23:33,600
it's all blocked and it's blocked for

660
00:23:33,600 --> 00:23:34,880
three days

661
00:23:34,880 --> 00:23:38,000
okay and do we know that it's definitely

662
00:23:38,000 --> 00:23:39,520
blocked attacks

663
00:23:39,520 --> 00:23:41,360
or stops somebody from hacking on a

664
00:23:41,360 --> 00:23:42,960
network i don't know

665
00:23:42,960 --> 00:23:44,960
but it's just one more thing right it's

666
00:23:44,960 --> 00:23:46,240
one more thing

667
00:23:46,240 --> 00:23:48,480
so what questions do you guys have and

668
00:23:48,480 --> 00:23:51,520
then i'll go down and you guys can call

669
00:23:51,520 --> 00:23:53,039
it a day because

670
00:23:53,039 --> 00:23:54,080
you probably want to go get your

671
00:23:54,080 --> 00:23:56,080
families and or if you're coming to

672
00:23:56,080 --> 00:23:58,879
family night or not

673
00:23:59,919 --> 00:24:02,320
yes so if you go to supertechguy.com you

674
00:24:02,320 --> 00:24:04,640
go to training all the slides will be

675
00:24:04,640 --> 00:24:06,720
there i'll get those posted tonight

676
00:24:06,720 --> 00:24:09,039
along with the code so i'll make the

677
00:24:09,039 --> 00:24:10,799
code download downloadable and you can

678
00:24:10,799 --> 00:24:12,880
get that and implement it

679
00:24:12,880 --> 00:24:16,440
and play with it

680
00:24:19,120 --> 00:24:21,439
oh

681
00:24:23,200 --> 00:24:25,360
enough that you it takes a while to

682
00:24:25,360 --> 00:24:27,600
scroll scroll through the page

683
00:24:27,600 --> 00:24:30,080
okay let's just say it's a lot i i

684
00:24:30,080 --> 00:24:31,760
haven't actually

685
00:24:31,760 --> 00:24:33,919
i haven't actually counted them

686
00:24:33,919 --> 00:24:36,720
you know for a very very long time and i

687
00:24:36,720 --> 00:24:37,919
could possibly

688
00:24:37,919 --> 00:24:39,520
get in and count it at this point but

689
00:24:39,520 --> 00:24:40,559
let's just say

690
00:24:40,559 --> 00:24:43,440
it's a crazy amount

691
00:24:43,440 --> 00:24:47,840
there's a hand back here somewhere yeah

692
00:24:51,679 --> 00:24:53,919
so the syslog server profile it's

693
00:24:53,919 --> 00:24:56,400
pointing at a linux box that's running

694
00:24:56,400 --> 00:24:58,080
syslog ng

695
00:24:58,080 --> 00:25:00,320
and so we use i that that's the one i'm

696
00:25:00,320 --> 00:25:02,960
most familiar with um these instructions

697
00:25:02,960 --> 00:25:05,200
should work just fine on for syslog ng

698
00:25:05,200 --> 00:25:06,640
to set it up

699
00:25:06,640 --> 00:25:08,960
you could use other syslog servers and

700
00:25:08,960 --> 00:25:11,120
be just fine that's just the one i like

701
00:25:11,120 --> 00:25:12,960
the most

702
00:25:12,960 --> 00:25:15,840
yeah

703
00:25:15,919 --> 00:25:18,559
um for the dashboard it's just it's just

704
00:25:18,559 --> 00:25:21,600
apache php

705
00:25:21,760 --> 00:25:24,559
that refreshes it's got some it's now

706
00:25:24,559 --> 00:25:26,559
built into it that has some auto refresh

707
00:25:26,559 --> 00:25:29,039
right in right in the code it's not

708
00:25:29,039 --> 00:25:32,400
doing it i think we did

709
00:25:32,640 --> 00:25:34,400
i think it's running ajax now at this

710
00:25:34,400 --> 00:25:36,880
point to be honest with you but yeah

711
00:25:36,880 --> 00:25:39,919
it's just apache php it ends up on a big

712
00:25:39,919 --> 00:25:43,480
tv on the wall

713
00:25:58,000 --> 00:25:58,960
yes

714
00:25:58,960 --> 00:26:02,000
oh absolutely if you if you threw some

715
00:26:02,000 --> 00:26:04,400
some udp traffic at it and did something

716
00:26:04,400 --> 00:26:06,159
like that yeah you might have something

717
00:26:06,159 --> 00:26:07,840
like that happen in fact we talked about

718
00:26:07,840 --> 00:26:11,520
this very thing last time so yes is that

719
00:26:11,520 --> 00:26:14,000
a possibility absolutely

720
00:26:14,000 --> 00:26:15,600
absolutely i mean with any of these

721
00:26:15,600 --> 00:26:17,200
types of things anything automated

722
00:26:17,200 --> 00:26:18,640
you're going to run into those types of

723
00:26:18,640 --> 00:26:20,080
challenges right

724
00:26:20,080 --> 00:26:21,679
especially if somebody figures out where

725
00:26:21,679 --> 00:26:23,279
the crap you put that

726
00:26:23,279 --> 00:26:25,200
right

727
00:26:25,200 --> 00:26:28,880
so it just opens up a can of worms

728
00:26:28,880 --> 00:26:30,400
and if that happens if we're gonna have

729
00:26:30,400 --> 00:26:33,840
to deal with it absolutely

730
00:26:39,200 --> 00:26:41,600
with what

731
00:26:41,600 --> 00:26:42,960
we do

732
00:26:42,960 --> 00:26:45,440
yep we do i'm not saying that you should

733
00:26:45,440 --> 00:26:49,279
use this in in in lieu of anything else

734
00:26:49,279 --> 00:26:51,760
it's just one more thing

735
00:26:51,760 --> 00:26:54,640
one more thing to add to it

736
00:26:54,640 --> 00:26:56,880
yeah

737
00:26:57,679 --> 00:27:00,080
do you tell them where your dark

738
00:27:00,080 --> 00:27:03,639
dark zone is

739
00:27:16,640 --> 00:27:19,520
well actually

740
00:27:19,520 --> 00:27:21,039
trying to remember if we ever set up

741
00:27:21,039 --> 00:27:23,039
some i think we might have set up some

742
00:27:23,039 --> 00:27:24,399
custom

743
00:27:24,399 --> 00:27:27,200
allow rule or something i i think we did

744
00:27:27,200 --> 00:27:29,360
run into that one time but at the

745
00:27:29,360 --> 00:27:31,440
beginning the answer was no we didn't

746
00:27:31,440 --> 00:27:32,960
but i do believe we did run into that

747
00:27:32,960 --> 00:27:34,559
because they did do they started doing

748
00:27:34,559 --> 00:27:36,799
some funky scanning at one point i do

749
00:27:36,799 --> 00:27:38,159
remember that now

750
00:27:38,159 --> 00:27:39,760
like i said it's been three years since

751
00:27:39,760 --> 00:27:43,200
i gave this presentation so

752
00:27:49,279 --> 00:27:51,520
yes

753
00:27:55,679 --> 00:27:57,760
most of that does yes but we have had

754
00:27:57,760 --> 00:27:59,360
some internal scanners that have gotten

755
00:27:59,360 --> 00:28:03,479
hit by the private space

756
00:28:04,080 --> 00:28:06,320
not not very often

757
00:28:06,320 --> 00:28:07,760
it's rare

758
00:28:07,760 --> 00:28:09,840
yeah i mean i've got a i have a massive

759
00:28:09,840 --> 00:28:10,960
network

760
00:28:10,960 --> 00:28:13,279
um

761
00:28:14,880 --> 00:28:16,960
it's it's probably the biggest network

762
00:28:16,960 --> 00:28:18,720
in southern utah but

763
00:28:18,720 --> 00:28:21,919
it's it's rare

764
00:28:26,159 --> 00:28:29,880
okay yeah

765
00:28:33,039 --> 00:28:35,919
yes we do have some exceptions so any we

766
00:28:35,919 --> 00:28:37,760
do have some exceptions that are allowed

767
00:28:37,760 --> 00:28:39,919
through that that automatically do not

768
00:28:39,919 --> 00:28:40,960
get

769
00:28:40,960 --> 00:28:42,640
um whammied

770
00:28:42,640 --> 00:28:45,640
yeah

771
00:28:54,880 --> 00:28:57,200
they could be either way i think the way

772
00:28:57,200 --> 00:28:59,279
we actually that the code that i gave

773
00:28:59,279 --> 00:29:00,880
you is probably an old version of the

774
00:29:00,880 --> 00:29:02,559
code i'm thinking it's in the code if i

775
00:29:02,559 --> 00:29:03,840
remember right

776
00:29:03,840 --> 00:29:05,760
but you could do it either way you could

777
00:29:05,760 --> 00:29:07,279
you could say

778
00:29:07,279 --> 00:29:08,240
yeah

779
00:29:08,240 --> 00:29:10,159
you could make exceptions write in the

780
00:29:10,159 --> 00:29:14,000
rule if you wanted to even so

781
00:29:16,640 --> 00:29:18,559
yeah

782
00:29:18,559 --> 00:29:21,559
yeah

783
00:29:34,880 --> 00:29:37,600
usually scans are done continuously

784
00:29:37,600 --> 00:29:38,880
there are

785
00:29:38,880 --> 00:29:40,559
nmap does have some flags that you can

786
00:29:40,559 --> 00:29:43,279
say scan this at random that's really

787
00:29:43,279 --> 00:29:44,799
hard to catch

788
00:29:44,799 --> 00:29:46,880
um in any

789
00:29:46,880 --> 00:29:49,200
reasonable period of time

790
00:29:49,200 --> 00:29:51,120
but usually if somebody if you've just

791
00:29:51,120 --> 00:29:52,880
got a script kitty going through or just

792
00:29:52,880 --> 00:29:54,640
somebody's just lazily scanning your

793
00:29:54,640 --> 00:29:57,279
network is contiguous

794
00:29:57,279 --> 00:29:59,039
so front back

795
00:29:59,039 --> 00:30:01,120
something in the middle

796
00:30:01,120 --> 00:30:02,960
you know something like that

797
00:30:02,960 --> 00:30:05,919
it you just kind of plan accordingly

798
00:30:05,919 --> 00:30:06,840
does that

799
00:30:06,840 --> 00:30:10,320
help okay

800
00:30:20,000 --> 00:30:22,559
how quick does that happen um it doesn't

801
00:30:22,559 --> 00:30:24,000
take very long we just have to go in and

802
00:30:24,000 --> 00:30:25,840
make an exception for it

803
00:30:25,840 --> 00:30:27,679
we can have it done in about

804
00:30:27,679 --> 00:30:31,200
30 seconds or so

805
00:30:34,480 --> 00:30:36,240
and then we usually take that exception

806
00:30:36,240 --> 00:30:38,480
off afterwards or

807
00:30:38,480 --> 00:30:39,600
assuming that it's not going to happen

808
00:30:39,600 --> 00:30:40,720
again if it's something that's

809
00:30:40,720 --> 00:30:43,919
reoccurring we can leave it in

810
00:30:46,720 --> 00:30:50,120
anything else

811
00:30:50,399 --> 00:30:52,590
okay thank you very much

812
00:30:52,590 --> 00:30:55,480
[Applause]

