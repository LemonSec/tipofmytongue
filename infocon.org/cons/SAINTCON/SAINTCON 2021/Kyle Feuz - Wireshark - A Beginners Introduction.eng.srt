1
00:00:00,240 --> 00:00:04,400
all right welcome out to my presentation

2
00:00:04,400 --> 00:00:08,240
this is a training on wireshark

3
00:00:08,240 --> 00:00:11,200
it's geared towards beginners so if you

4
00:00:11,200 --> 00:00:13,120
don't have any experience with wireshark

5
00:00:13,120 --> 00:00:14,799
that's perfect if you have a little bit

6
00:00:14,799 --> 00:00:16,160
of experience with wireshark that's

7
00:00:16,160 --> 00:00:18,800
probably okay too if you're

8
00:00:18,800 --> 00:00:21,039
if you've been using wireshark for years

9
00:00:21,039 --> 00:00:23,279
you may pick up one or two tricks

10
00:00:23,279 --> 00:00:25,439
but this training is probably not for

11
00:00:25,439 --> 00:00:26,880
you if that's the case

12
00:00:26,880 --> 00:00:29,119
so i just want you to you know be aware

13
00:00:29,119 --> 00:00:32,880
of that right from the beginning

14
00:00:33,440 --> 00:00:35,040
a couple things

15
00:00:35,040 --> 00:00:36,719
about me one

16
00:00:36,719 --> 00:00:38,640
i don't like to stand behind the podium

17
00:00:38,640 --> 00:00:42,480
so i'll be moving around a lot

18
00:00:42,559 --> 00:00:45,600
i've been to saint conn

19
00:00:45,600 --> 00:00:46,800
for

20
00:00:46,800 --> 00:00:50,160
seven years in a row now uh i started

21
00:00:50,160 --> 00:00:52,879
coming in 2014

22
00:00:52,879 --> 00:00:56,000
and you know 2014 i just came

23
00:00:56,000 --> 00:00:58,399
tried it out a little uh

24
00:00:58,399 --> 00:01:02,000
2015 i volunteered as a security

25
00:01:02,000 --> 00:01:03,120
person

26
00:01:03,120 --> 00:01:04,479
and then

27
00:01:04,479 --> 00:01:07,680
2016 i started uh doing presentations

28
00:01:07,680 --> 00:01:09,439
and i've been

29
00:01:09,439 --> 00:01:11,600
doing that ever since i love st con how

30
00:01:11,600 --> 00:01:13,680
many of you if is this your first time

31
00:01:13,680 --> 00:01:15,920
here at st khan

32
00:01:15,920 --> 00:01:18,720
sweet okay so it's awesome

33
00:01:18,720 --> 00:01:20,960
um

34
00:01:20,960 --> 00:01:23,200
i learn a ton

35
00:01:23,200 --> 00:01:25,360
make great friends build network

36
00:01:25,360 --> 00:01:26,560
connections

37
00:01:26,560 --> 00:01:27,680
it's really

38
00:01:27,680 --> 00:01:30,159
uh one of the best conferences that i go

39
00:01:30,159 --> 00:01:30,960
to

40
00:01:30,960 --> 00:01:32,000
out of

41
00:01:32,000 --> 00:01:33,759
in fact i would say it is the best

42
00:01:33,759 --> 00:01:35,759
conference that i go to my wife always

43
00:01:35,759 --> 00:01:38,479
uh complains that when i go to st con

44
00:01:38,479 --> 00:01:41,680
i'm not working i'm just having fun

45
00:01:41,680 --> 00:01:43,600
you get to go party for a week and

46
00:01:43,600 --> 00:01:45,680
that's really what it feels like right

47
00:01:45,680 --> 00:01:47,840
you know it is work it's learning and

48
00:01:47,840 --> 00:01:50,240
opportunities to grow and develop but

49
00:01:50,240 --> 00:01:53,360
it's also a ton of fun

50
00:01:53,360 --> 00:01:54,399
okay

51
00:01:54,399 --> 00:01:56,079
so

52
00:01:56,079 --> 00:01:58,560
in my day job i teach at weber state

53
00:01:58,560 --> 00:02:01,040
university i'm a

54
00:02:01,040 --> 00:02:03,200
faculty in computer science and well the

55
00:02:03,200 --> 00:02:04,560
school of computing

56
00:02:04,560 --> 00:02:07,520
there uh i've been there about as long

57
00:02:07,520 --> 00:02:10,000
as i've been coming to saint con that

58
00:02:10,000 --> 00:02:12,000
was how i got introduced to saint fund

59
00:02:12,000 --> 00:02:13,280
was through my

60
00:02:13,280 --> 00:02:15,120
work there they used to host the

61
00:02:15,120 --> 00:02:17,360
conference up at weber state

62
00:02:17,360 --> 00:02:20,560
so i've been doing that i occasionally

63
00:02:20,560 --> 00:02:23,360
teach an entire class on wireshark up at

64
00:02:23,360 --> 00:02:25,920
weber state university so this is a very

65
00:02:25,920 --> 00:02:28,480
condensed version right usually when i

66
00:02:28,480 --> 00:02:30,160
cover these kind of topics i get to

67
00:02:30,160 --> 00:02:33,360
spend 15 weeks talking about wireshark

68
00:02:33,360 --> 00:02:35,920
and we get to go into tons of detail

69
00:02:35,920 --> 00:02:36,959
instead

70
00:02:36,959 --> 00:02:38,879
you get the the highlights and the

71
00:02:38,879 --> 00:02:41,760
condensed version in two hours and

72
00:02:41,760 --> 00:02:43,920
hopefully it's enough to get you

73
00:02:43,920 --> 00:02:46,000
started and figuring out how to use it

74
00:02:46,000 --> 00:02:47,599
and to

75
00:02:47,599 --> 00:02:50,480
then you know go on from there to

76
00:02:50,480 --> 00:02:53,040
to learn more about all the great things

77
00:02:53,040 --> 00:02:55,760
you can do with it

78
00:02:56,319 --> 00:02:57,760
i should have had this side up the whole

79
00:02:57,760 --> 00:02:59,440
time i was talking i kind of forgot that

80
00:02:59,440 --> 00:03:00,959
that's what it's going to do if you

81
00:03:00,959 --> 00:03:03,360
haven't already

82
00:03:03,360 --> 00:03:05,519
download wireshark

83
00:03:05,519 --> 00:03:07,440
you don't need the absolute latest

84
00:03:07,440 --> 00:03:09,840
version um but if you're downloading it

85
00:03:09,840 --> 00:03:11,200
you might as well download the latest

86
00:03:11,200 --> 00:03:14,159
version but any recent version will work

87
00:03:14,159 --> 00:03:16,640
it hasn't changed too significantly in

88
00:03:16,640 --> 00:03:18,319
terms of the interface or anything or

89
00:03:18,319 --> 00:03:20,159
any of the features that we'll be using

90
00:03:20,159 --> 00:03:22,319
in this talk

91
00:03:22,319 --> 00:03:24,560
so you'll be fine if you have a recent

92
00:03:24,560 --> 00:03:26,159
ish copy

93
00:03:26,159 --> 00:03:27,599
you'll be fine there

94
00:03:27,599 --> 00:03:30,560
and then in this training it's very

95
00:03:30,560 --> 00:03:32,720
hands-on i'll be

96
00:03:32,720 --> 00:03:34,480
up here on the stage sometimes but a lot

97
00:03:34,480 --> 00:03:35,840
of times i'll be down there walking

98
00:03:35,840 --> 00:03:37,120
around

99
00:03:37,120 --> 00:03:38,959
you know hoping through the different

100
00:03:38,959 --> 00:03:41,200
capture files that we're working on so

101
00:03:41,200 --> 00:03:44,319
we are not doing any live captures

102
00:03:44,319 --> 00:03:47,360
instead i have um

103
00:03:47,360 --> 00:03:49,680
already captured some traffic and made

104
00:03:49,680 --> 00:03:51,760
those available at the second url here

105
00:03:51,760 --> 00:03:54,319
on the sides that's the the short url

106
00:03:54,319 --> 00:03:56,560
one that's just a link to a google drive

107
00:03:56,560 --> 00:03:59,760
folder that has two files in it it has

108
00:03:59,760 --> 00:04:00,400
the

109
00:04:00,400 --> 00:04:02,799
um capture files

110
00:04:02,799 --> 00:04:04,560
in a zip file and it has this

111
00:04:04,560 --> 00:04:06,720
presentation so that you can

112
00:04:06,720 --> 00:04:09,519
follow along and come back to it and

113
00:04:09,519 --> 00:04:11,920
move through it as needed

114
00:04:11,920 --> 00:04:14,000
okay

115
00:04:14,000 --> 00:04:17,040
so a few things about this presentation

116
00:04:17,040 --> 00:04:18,720
and you know what we'll cover and that

117
00:04:18,720 --> 00:04:20,880
kind of stuff first off i will start

118
00:04:20,880 --> 00:04:24,080
with the disclaimer of

119
00:04:24,080 --> 00:04:25,759
you should know the law and you should

120
00:04:25,759 --> 00:04:29,360
know company policy or you know

121
00:04:29,360 --> 00:04:31,600
your organization's policy in terms of

122
00:04:31,600 --> 00:04:35,040
capturing traffic uh there can be and

123
00:04:35,040 --> 00:04:37,680
often is sensitive information on our

124
00:04:37,680 --> 00:04:40,560
networks and wireshark is a tool that

125
00:04:40,560 --> 00:04:43,199
lets you see anything that's on your

126
00:04:43,199 --> 00:04:44,160
network

127
00:04:44,160 --> 00:04:45,840
and so um

128
00:04:45,840 --> 00:04:48,960
there are right laws and company policy

129
00:04:48,960 --> 00:04:51,360
that sort of govern the use of

130
00:04:51,360 --> 00:04:54,320
monitoring your network traffic and so

131
00:04:54,320 --> 00:04:56,479
that's not uh one of the things that i

132
00:04:56,479 --> 00:04:58,560
cover in this presentation is when

133
00:04:58,560 --> 00:05:00,320
you're okay to capture traffic and when

134
00:05:00,320 --> 00:05:02,720
you're not and if you're um right if you

135
00:05:02,720 --> 00:05:04,000
have the right permissions and stuff i

136
00:05:04,000 --> 00:05:07,600
leave that up to to you to work out with

137
00:05:07,600 --> 00:05:09,520
those who are in control of the networks

138
00:05:09,520 --> 00:05:11,840
that you're capturing on

139
00:05:11,840 --> 00:05:13,600
and so with that that's another reason

140
00:05:13,600 --> 00:05:15,199
we don't do any live captures here that

141
00:05:15,199 --> 00:05:17,280
way we don't have to worry about it i've

142
00:05:17,280 --> 00:05:18,720
already captured the traffic we need to

143
00:05:18,720 --> 00:05:20,880
work with

144
00:05:20,880 --> 00:05:22,639
so we won't be covering

145
00:05:22,639 --> 00:05:24,960
we're doing actual live captures we will

146
00:05:24,960 --> 00:05:25,919
talk about

147
00:05:25,919 --> 00:05:28,479
um how to capture and where to capture

148
00:05:28,479 --> 00:05:29,919
the traffic

149
00:05:29,919 --> 00:05:32,320
so those will be some skills that we do

150
00:05:32,320 --> 00:05:33,280
cover

151
00:05:33,280 --> 00:05:34,240
uh

152
00:05:34,240 --> 00:05:38,919
in terms of other skills needed

153
00:05:39,039 --> 00:05:40,639
you know there's the obvious skills that

154
00:05:40,639 --> 00:05:41,759
come with

155
00:05:41,759 --> 00:05:43,280
network security

156
00:05:43,280 --> 00:05:43,670
and

157
00:05:43,670 --> 00:05:45,680
[Music]

158
00:05:45,680 --> 00:05:48,160
in terms of like curiosity an analytical

159
00:05:48,160 --> 00:05:49,120
mind

160
00:05:49,120 --> 00:05:51,280
those kind of things again those are not

161
00:05:51,280 --> 00:05:53,520
what we're going to be covering here

162
00:05:53,520 --> 00:05:56,080
but are critical to success in

163
00:05:56,080 --> 00:05:57,520
understanding what's happening on your

164
00:05:57,520 --> 00:05:58,800
network

165
00:05:58,800 --> 00:06:01,280
we're focusing on the technical details

166
00:06:01,280 --> 00:06:04,560
of how to use wireshark

167
00:06:04,560 --> 00:06:06,800
we also will briefly talk about some of

168
00:06:06,800 --> 00:06:09,199
the network protocols but to be really

169
00:06:09,199 --> 00:06:11,600
good at using wireshark you have to

170
00:06:11,600 --> 00:06:13,280
understand what it is you're looking at

171
00:06:13,280 --> 00:06:14,960
you have to understand

172
00:06:14,960 --> 00:06:17,360
how the devices are communicating and

173
00:06:17,360 --> 00:06:19,919
wireshark will help you do that but it's

174
00:06:19,919 --> 00:06:22,319
also helpful if you already

175
00:06:22,319 --> 00:06:24,479
have an understanding of the protocols

176
00:06:24,479 --> 00:06:25,759
you're looking at right so you

177
00:06:25,759 --> 00:06:28,000
understand the basics of how the http

178
00:06:28,000 --> 00:06:30,160
protocol works or how

179
00:06:30,160 --> 00:06:33,600
the art protocol works right and so

180
00:06:33,600 --> 00:06:35,840
again in this two-hour

181
00:06:35,840 --> 00:06:38,319
training we don't have time to cover

182
00:06:38,319 --> 00:06:40,479
all the protocols in detail we'll do a

183
00:06:40,479 --> 00:06:43,120
high-level introduction to a few of them

184
00:06:43,120 --> 00:06:44,720
uh to kind of give you a taste of the

185
00:06:44,720 --> 00:06:46,960
types of things that you can be doing uh

186
00:06:46,960 --> 00:06:50,719
on your networks and with wireshark

187
00:06:54,160 --> 00:06:58,319
so let's start just with a basic tour

188
00:06:58,319 --> 00:07:00,080
i'm not going to

189
00:07:00,080 --> 00:07:01,280
i try and

190
00:07:01,280 --> 00:07:04,319
make the presentation uh accessible to a

191
00:07:04,319 --> 00:07:06,479
large variety of individuals with

192
00:07:06,479 --> 00:07:08,479
different skill sets right so

193
00:07:08,479 --> 00:07:10,720
uh some of you are like okay yeah i've

194
00:07:10,720 --> 00:07:12,319
seen wireshark before i don't need a

195
00:07:12,319 --> 00:07:14,560
tour and that's okay we won't spend too

196
00:07:14,560 --> 00:07:18,400
long on our tour of wireshark

197
00:07:18,880 --> 00:07:20,400
but i do just want to go over some of

198
00:07:20,400 --> 00:07:22,240
the key elements of the interface and

199
00:07:22,240 --> 00:07:23,759
then we'll get into more of the details

200
00:07:23,759 --> 00:07:25,919
of using that

201
00:07:25,919 --> 00:07:28,080
just let me pause for a second

202
00:07:28,080 --> 00:07:30,800
are most of you able to have the capture

203
00:07:30,800 --> 00:07:33,199
files downloaded and the wireshark

204
00:07:33,199 --> 00:07:34,800
downloaded at this point so that we're

205
00:07:34,800 --> 00:07:37,120
able to kind of follow along and work

206
00:07:37,120 --> 00:07:39,919
through this together

207
00:07:40,319 --> 00:07:42,319
and do we need a couple more minutes to

208
00:07:42,319 --> 00:07:45,840
download things

209
00:07:46,400 --> 00:07:49,680
okay so it sounds like we're good

210
00:07:49,680 --> 00:07:50,720
uh

211
00:07:50,720 --> 00:07:53,360
oh this is

212
00:07:53,680 --> 00:07:57,560
gonna be slightly problematic

213
00:07:58,720 --> 00:08:00,879
in terms of

214
00:08:00,879 --> 00:08:03,199
when i'm presenting and not presenting

215
00:08:03,199 --> 00:08:06,479
what's showing on my screen

216
00:08:07,280 --> 00:08:11,239
i think we can make it work

217
00:08:14,479 --> 00:08:16,879
that's really small on my

218
00:08:16,879 --> 00:08:20,160
presenter monitor is it small

219
00:08:20,160 --> 00:08:21,120
on the

220
00:08:21,120 --> 00:08:24,440
thing there

221
00:08:28,800 --> 00:08:30,879
yeah and there's lots of seats up front

222
00:08:30,879 --> 00:08:32,320
here too so

223
00:08:32,320 --> 00:08:35,039
let me try

224
00:08:35,360 --> 00:08:37,200
i can change like

225
00:08:37,200 --> 00:08:39,200
some of the settings that will make a

226
00:08:39,200 --> 00:08:42,000
few of the things larger but i think if

227
00:08:42,000 --> 00:08:43,519
i

228
00:08:43,519 --> 00:08:46,000
switch my presenter mode that might help

229
00:08:46,000 --> 00:08:49,160
as well

230
00:09:05,600 --> 00:09:09,120
okay see if that improved our resolution

231
00:09:09,120 --> 00:09:13,040
over there there that's better right

232
00:09:13,120 --> 00:09:15,360
okay

233
00:09:15,360 --> 00:09:18,959
so quick tour of wireshark

234
00:09:19,120 --> 00:09:21,200
like most programs we've got our menu

235
00:09:21,200 --> 00:09:22,399
options here

236
00:09:22,399 --> 00:09:24,160
one of the best things

237
00:09:24,160 --> 00:09:25,600
you can do in terms of learning

238
00:09:25,600 --> 00:09:28,959
wireshark is just explore those

239
00:09:28,959 --> 00:09:31,120
i talked about curiosity being an

240
00:09:31,120 --> 00:09:33,519
important mindset and skill to have and

241
00:09:33,519 --> 00:09:34,720
that's one of the best ways you're going

242
00:09:34,720 --> 00:09:36,640
to learn is just

243
00:09:36,640 --> 00:09:38,480
try things out and see well what happens

244
00:09:38,480 --> 00:09:39,600
when i look at these different

245
00:09:39,600 --> 00:09:42,320
statistics can i start to learn things

246
00:09:42,320 --> 00:09:45,360
about those and we'll explore some of

247
00:09:45,360 --> 00:09:47,360
some of those in a few more details here

248
00:09:47,360 --> 00:09:49,200
in a minute

249
00:09:49,200 --> 00:09:54,080
i'm going to open up a capture file here

250
00:09:54,080 --> 00:09:56,480
so i'm going to start with the baseline

251
00:09:56,480 --> 00:09:58,240
pcap file

252
00:09:58,240 --> 00:10:00,320
that should be in your set of downloads

253
00:10:00,320 --> 00:10:02,720
and that way we can just have a common

254
00:10:02,720 --> 00:10:06,399
file to work through for a second

255
00:10:07,279 --> 00:10:09,839
we have three main areas here in

256
00:10:09,839 --> 00:10:12,640
wireshark the first area is our packet

257
00:10:12,640 --> 00:10:13,519
list

258
00:10:13,519 --> 00:10:16,480
and so it's showing a list

259
00:10:16,480 --> 00:10:18,079
you can see numbers one two three four

260
00:10:18,079 --> 00:10:20,399
five of all the packets that were

261
00:10:20,399 --> 00:10:22,959
captured in this um

262
00:10:22,959 --> 00:10:25,200
wire shark capture

263
00:10:25,200 --> 00:10:28,079
and a few of the details right some a

264
00:10:28,079 --> 00:10:30,800
time stamp where it came from where it

265
00:10:30,800 --> 00:10:33,040
was going in terms of ip address some

266
00:10:33,040 --> 00:10:35,760
basic information about that packet

267
00:10:35,760 --> 00:10:36,640
this is

268
00:10:36,640 --> 00:10:39,120
customizable we'll get into that

269
00:10:39,120 --> 00:10:41,920
the second thing you're seeing here

270
00:10:41,920 --> 00:10:44,800
is your packet details and so as i

271
00:10:44,800 --> 00:10:47,600
change which packet i have selected

272
00:10:47,600 --> 00:10:48,720
right now

273
00:10:48,720 --> 00:10:50,320
packet number one is selected it's

274
00:10:50,320 --> 00:10:52,560
showing me then all of the details of

275
00:10:52,560 --> 00:10:55,519
that packet and it breaks it down by the

276
00:10:55,519 --> 00:10:57,440
different layers in the packet and so we

277
00:10:57,440 --> 00:10:59,680
can start with our application layer say

278
00:10:59,680 --> 00:11:01,600
okay you know this is a dns packet

279
00:11:01,600 --> 00:11:04,959
here's the details of that dns packet

280
00:11:04,959 --> 00:11:07,600
and you can see

281
00:11:07,600 --> 00:11:08,800
the

282
00:11:08,800 --> 00:11:12,320
all the information that was being sent

283
00:11:12,320 --> 00:11:15,600
as part of that dns query in this case

284
00:11:15,600 --> 00:11:17,519
and then you can go to the next

285
00:11:17,519 --> 00:11:20,480
level in your uh protocol hierarchy and

286
00:11:20,480 --> 00:11:23,440
say well it was sent using udp protocol

287
00:11:23,440 --> 00:11:25,120
and here's the details right it was this

288
00:11:25,120 --> 00:11:28,480
port this port this length etc

289
00:11:28,480 --> 00:11:30,560
and that was wrapped in an ip packet

290
00:11:30,560 --> 00:11:32,240
right and you can see the ip address and

291
00:11:32,240 --> 00:11:34,959
all that so all your details of this

292
00:11:34,959 --> 00:11:37,279
individual packet show up in your detail

293
00:11:37,279 --> 00:11:39,519
list

294
00:11:39,680 --> 00:11:40,839
as you

295
00:11:40,839 --> 00:11:43,760
change to so i'm going to jump down here

296
00:11:43,760 --> 00:11:45,760
to like packet number five right your

297
00:11:45,760 --> 00:11:47,519
detail list changes because now you're

298
00:11:47,519 --> 00:11:49,040
looking at the details for that

299
00:11:49,040 --> 00:11:50,720
particular packet

300
00:11:50,720 --> 00:11:52,560
okay

301
00:11:52,560 --> 00:11:55,360
and then finally the last section

302
00:11:55,360 --> 00:11:56,639
is the

303
00:11:56,639 --> 00:11:58,000
packet bytes

304
00:11:58,000 --> 00:12:00,079
and so

305
00:12:00,079 --> 00:12:02,959
ultimately right the the packet just

306
00:12:02,959 --> 00:12:04,639
corresponds to a set of bytes that were

307
00:12:04,639 --> 00:12:07,440
sent across your network and so here are

308
00:12:07,440 --> 00:12:09,680
those bytes in

309
00:12:09,680 --> 00:12:12,959
hexadecimal format and then as ascii

310
00:12:12,959 --> 00:12:14,160
characters

311
00:12:14,160 --> 00:12:15,120
and so

312
00:12:15,120 --> 00:12:17,839
as you are working in your detail list

313
00:12:17,839 --> 00:12:20,480
and you click on a given segment it

314
00:12:20,480 --> 00:12:21,760
highlights

315
00:12:21,760 --> 00:12:24,320
the bytes that correspond to that

316
00:12:24,320 --> 00:12:26,959
segment so again

317
00:12:26,959 --> 00:12:28,639
i like to think of it as sort of

318
00:12:28,639 --> 00:12:31,360
drilling down you start with

319
00:12:31,360 --> 00:12:34,000
the part the packet then you get the

320
00:12:34,000 --> 00:12:35,760
details on the packet and then you get

321
00:12:35,760 --> 00:12:38,000
the details on the individual bytes of

322
00:12:38,000 --> 00:12:39,279
that packet

323
00:12:39,279 --> 00:12:40,639
okay

324
00:12:40,639 --> 00:12:41,600
you can

325
00:12:41,600 --> 00:12:43,440
move around those windows you saw me

326
00:12:43,440 --> 00:12:45,600
dragging them up and down you can choose

327
00:12:45,600 --> 00:12:47,200
other layouts put one of them on the

328
00:12:47,200 --> 00:12:48,800
side on the right or the left or

329
00:12:48,800 --> 00:12:52,160
whatever i typically we'll use this

330
00:12:52,160 --> 00:12:54,000
three line layout when i'm working with

331
00:12:54,000 --> 00:12:57,600
it and unless i need to see the bytes i

332
00:12:57,600 --> 00:12:58,639
usually

333
00:12:58,639 --> 00:13:01,200
will shrink that one way down because i

334
00:13:01,200 --> 00:13:02,720
most of the time don't care about what

335
00:13:02,720 --> 00:13:04,720
the actual bites are i just care about

336
00:13:04,720 --> 00:13:05,600
these

337
00:13:05,600 --> 00:13:08,320
packet details and so i like to keep

338
00:13:08,320 --> 00:13:10,000
most of my window

339
00:13:10,000 --> 00:13:13,440
able to see those two items

340
00:13:19,680 --> 00:13:21,760
okay so we talked about the menus we

341
00:13:21,760 --> 00:13:23,120
skipped the filter bar because i'm going

342
00:13:23,120 --> 00:13:24,800
to cover it in more detail and we

343
00:13:24,800 --> 00:13:26,560
skipped the schedus bar let me just

344
00:13:26,560 --> 00:13:28,800
quick

345
00:13:29,200 --> 00:13:31,360
the last thing here down at the bottom

346
00:13:31,360 --> 00:13:35,040
is our status bar it has some

347
00:13:35,040 --> 00:13:36,959
details on your packets like how many

348
00:13:36,959 --> 00:13:38,959
packs are in the capture file how many

349
00:13:38,959 --> 00:13:41,040
of those are being displayed

350
00:13:41,040 --> 00:13:44,000
what profile you're currently using

351
00:13:44,000 --> 00:13:46,560
and again we'll get into

352
00:13:46,560 --> 00:13:48,880
changing some of those options here in

353
00:13:48,880 --> 00:13:50,720
just a second

354
00:13:50,720 --> 00:13:52,880
okay any questions about the general

355
00:13:52,880 --> 00:13:55,600
interface of wireshark

356
00:13:55,600 --> 00:13:57,120
hopefully we didn't spend too much time

357
00:13:57,120 --> 00:13:59,279
on that and and lose anybody here looks

358
00:13:59,279 --> 00:14:00,160
like

359
00:14:00,160 --> 00:14:02,560
you're at least still sitting

360
00:14:02,560 --> 00:14:05,920
and not sleeping so that's good

361
00:14:14,959 --> 00:14:17,279
the next thing we need to talk about is

362
00:14:17,279 --> 00:14:18,480
where to

363
00:14:18,480 --> 00:14:20,720
get these packets from okay we're not

364
00:14:20,720 --> 00:14:23,040
going to do the actual live capture but

365
00:14:23,040 --> 00:14:24,800
i do want you to have the ability to go

366
00:14:24,800 --> 00:14:26,639
home and you know create your own packet

367
00:14:26,639 --> 00:14:28,880
captures and get some interesting data

368
00:14:28,880 --> 00:14:30,800
with that and so let's talk about that

369
00:14:30,800 --> 00:14:33,040
for just a second here

370
00:14:33,040 --> 00:14:36,639
if i've got a sample network

371
00:14:36,639 --> 00:14:38,160
you know this could be

372
00:14:38,160 --> 00:14:40,240
a home network it could be an enterprise

373
00:14:40,240 --> 00:14:42,959
network whatever

374
00:14:43,120 --> 00:14:45,279
my images here

375
00:14:45,279 --> 00:14:48,079
n5 n7 those are basic switches

376
00:14:48,079 --> 00:14:50,639
uh n3 and 6n4 those might be more like

377
00:14:50,639 --> 00:14:51,920
routers

378
00:14:51,920 --> 00:14:55,680
uh n6 being a wireless device so that

379
00:14:55,680 --> 00:14:57,519
then we have our wireless network we

380
00:14:57,519 --> 00:14:59,440
have our wired network we have the

381
00:14:59,440 --> 00:15:01,279
ability you know those are connected

382
00:15:01,279 --> 00:15:02,720
together so that they can talk to one

383
00:15:02,720 --> 00:15:05,920
another and ultimately you know

384
00:15:05,920 --> 00:15:08,240
this n4 might then be connected up to

385
00:15:08,240 --> 00:15:11,279
the internet right for general

386
00:15:11,279 --> 00:15:13,440
connectivity

387
00:15:13,440 --> 00:15:14,399
so

388
00:15:14,399 --> 00:15:17,199
if this is my network setup and i want

389
00:15:17,199 --> 00:15:21,120
to capture traffic on this

390
00:15:21,120 --> 00:15:25,639
where should i go about doing that

391
00:15:32,880 --> 00:15:34,720
okay so i heard someone over here speak

392
00:15:34,720 --> 00:15:36,880
up

393
00:15:37,199 --> 00:15:41,839
n3 if you can okay why n3

394
00:15:42,560 --> 00:15:45,440
yeah n3 is sort of this central point

395
00:15:45,440 --> 00:15:47,680
where you're going to get uh

396
00:15:47,680 --> 00:15:51,199
traffic from n10 to n8 has to flow

397
00:15:51,199 --> 00:15:54,399
through n3 right traffic from n2 up to

398
00:15:54,399 --> 00:15:56,399
n8 has to

399
00:15:56,399 --> 00:15:58,399
flow through n3

400
00:15:58,399 --> 00:15:59,440
so

401
00:15:59,440 --> 00:16:01,199
in terms of

402
00:16:01,199 --> 00:16:03,120
capturing

403
00:16:03,120 --> 00:16:05,600
the most traffic on your network that's

404
00:16:05,600 --> 00:16:08,320
probably going to be the ideal point to

405
00:16:08,320 --> 00:16:09,600
capture

406
00:16:09,600 --> 00:16:12,079
now what about if i'm

407
00:16:12,079 --> 00:16:13,360
working

408
00:16:13,360 --> 00:16:16,000
trying to find a specific problem i've

409
00:16:16,000 --> 00:16:18,320
got my desktop computer let's call that

410
00:16:18,320 --> 00:16:19,600
one n10

411
00:16:19,600 --> 00:16:21,440
and i've got my laptop and we'll call

412
00:16:21,440 --> 00:16:23,199
that one n12

413
00:16:23,199 --> 00:16:25,360
and i'm trying to share my files between

414
00:16:25,360 --> 00:16:26,880
them or whatever and it's not working

415
00:16:26,880 --> 00:16:28,639
and i want to see what's happening on

416
00:16:28,639 --> 00:16:31,120
the network try and see if there's

417
00:16:31,120 --> 00:16:33,920
something there of why it's not working

418
00:16:33,920 --> 00:16:37,759
in that case will n3 be a suitable place

419
00:16:37,759 --> 00:16:40,800
to capture traffic

420
00:16:41,120 --> 00:16:43,600
no right because most of the time our

421
00:16:43,600 --> 00:16:45,360
switch isn't going to bother sending it

422
00:16:45,360 --> 00:16:47,199
to n3 it's just going to go straight

423
00:16:47,199 --> 00:16:50,800
from n10 through our switch into n12 and

424
00:16:50,800 --> 00:16:53,279
so if we're capturing on n3

425
00:16:53,279 --> 00:16:55,040
we probably aren't going to see that

426
00:16:55,040 --> 00:16:56,480
traffic

427
00:16:56,480 --> 00:16:58,399
and that's the main point i want to make

428
00:16:58,399 --> 00:17:00,720
here is that there's no right place to

429
00:17:00,720 --> 00:17:03,279
capture traffic the right place is

430
00:17:03,279 --> 00:17:05,679
wherever the traffic's flowing that you

431
00:17:05,679 --> 00:17:07,119
want to see

432
00:17:07,119 --> 00:17:08,880
okay

433
00:17:08,880 --> 00:17:10,640
there are um

434
00:17:10,640 --> 00:17:12,480
things you can do depending on what kind

435
00:17:12,480 --> 00:17:15,119
of devices you have here that will let

436
00:17:15,119 --> 00:17:17,359
you capture traffic either

437
00:17:17,359 --> 00:17:20,480
better or worse and so if your

438
00:17:20,480 --> 00:17:22,400
switch has the ability to do what's

439
00:17:22,400 --> 00:17:24,640
called port mirroring and you can say

440
00:17:24,640 --> 00:17:26,480
hey

441
00:17:26,480 --> 00:17:28,559
i don't want to just capture traffic on

442
00:17:28,559 --> 00:17:30,480
n10 i want to capture all the traffic

443
00:17:30,480 --> 00:17:33,440
from this switch mirror

444
00:17:33,440 --> 00:17:35,360
all the traffic that you see right and

445
00:17:35,360 --> 00:17:37,039
send it to this one port and then we'll

446
00:17:37,039 --> 00:17:40,400
capture out on that port and so

447
00:17:40,400 --> 00:17:41,919
if you have a

448
00:17:41,919 --> 00:17:44,160
switch or router with that capability

449
00:17:44,160 --> 00:17:46,160
you can enable that and capture the

450
00:17:46,160 --> 00:17:48,640
traffic if you don't well then you've

451
00:17:48,640 --> 00:17:50,320
got to get creative and come up with

452
00:17:50,320 --> 00:17:53,520
other uh techniques and solutions

453
00:17:53,520 --> 00:17:54,720
sometimes

454
00:17:54,720 --> 00:17:57,200
uh you just care about

455
00:17:57,200 --> 00:18:00,400
getting on that on a specific line and

456
00:18:00,400 --> 00:18:01,760
so you can get

457
00:18:01,760 --> 00:18:03,760
um

458
00:18:03,760 --> 00:18:06,720
a tap right a network tap that just

459
00:18:06,720 --> 00:18:09,200
you basically insert a connection right

460
00:18:09,200 --> 00:18:12,720
here say okay oops

461
00:18:12,960 --> 00:18:15,200
i'm just gonna right plug my wire coming

462
00:18:15,200 --> 00:18:17,840
into this tap and then out to the step

463
00:18:17,840 --> 00:18:19,440
and just insert my device right there so

464
00:18:19,440 --> 00:18:22,000
that i can then capture that traffic

465
00:18:22,000 --> 00:18:23,039
okay

466
00:18:23,039 --> 00:18:25,039
i forgot to bring it it's in my hotel

467
00:18:25,039 --> 00:18:27,520
room i have a sam a little example of a

468
00:18:27,520 --> 00:18:29,600
network tap

469
00:18:29,600 --> 00:18:31,919
you know just a little square box with

470
00:18:31,919 --> 00:18:34,240
four connections uh that lets you

471
00:18:34,240 --> 00:18:36,320
capture completely silently because it

472
00:18:36,320 --> 00:18:38,559
isolates the network and so what comes

473
00:18:38,559 --> 00:18:39,280
in

474
00:18:39,280 --> 00:18:41,520
uh is completely separate from what's

475
00:18:41,520 --> 00:18:43,280
going out and you can

476
00:18:43,280 --> 00:18:46,080
monitor both directions of that traffic

477
00:18:46,080 --> 00:18:47,280
without

478
00:18:47,280 --> 00:18:49,600
your device interfering on the network

479
00:18:49,600 --> 00:18:51,520
and that's something to consider as well

480
00:18:51,520 --> 00:18:53,600
depending on what you're doing with the

481
00:18:53,600 --> 00:18:55,200
capturing the traffic

482
00:18:55,200 --> 00:18:57,919
wireshark can generate additional

483
00:18:57,919 --> 00:18:59,600
traffic on your network

484
00:18:59,600 --> 00:19:00,960
so that's something to be aware of if

485
00:19:00,960 --> 00:19:03,280
you're capturing traffic and you want to

486
00:19:03,280 --> 00:19:05,440
be silent you know you don't want to tip

487
00:19:05,440 --> 00:19:07,760
off an intruder that you're monitoring

488
00:19:07,760 --> 00:19:10,240
what's going on you'll want to take

489
00:19:10,240 --> 00:19:12,160
precautions with that and say okay yeah

490
00:19:12,160 --> 00:19:14,400
let me get one of these tap devices so

491
00:19:14,400 --> 00:19:16,240
that it completely isolates my wire

492
00:19:16,240 --> 00:19:18,880
shark and prevents it from sending out

493
00:19:18,880 --> 00:19:21,200
any traffic on the network

494
00:19:21,200 --> 00:19:22,000
there's

495
00:19:22,000 --> 00:19:23,919
configurations in wireshark itself that

496
00:19:23,919 --> 00:19:26,720
you can do to minimize

497
00:19:26,720 --> 00:19:28,559
what information it sends out on your

498
00:19:28,559 --> 00:19:30,880
network when you're capturing

499
00:19:30,880 --> 00:19:31,919
um

500
00:19:31,919 --> 00:19:35,280
but again in terms of like

501
00:19:35,280 --> 00:19:37,280
extra layers of security

502
00:19:37,280 --> 00:19:40,160
is how i like to think things

503
00:19:40,160 --> 00:19:41,120
okay

504
00:19:41,120 --> 00:19:42,880
let's go back because i wanted to talk

505
00:19:42,880 --> 00:19:46,000
about our wireless network as well

506
00:19:46,000 --> 00:19:48,640
troy was just in here talking about how

507
00:19:48,640 --> 00:19:50,559
you know things have changed in computer

508
00:19:50,559 --> 00:19:51,679
security

509
00:19:51,679 --> 00:19:53,440
that's certainly true with our wireless

510
00:19:53,440 --> 00:19:56,000
networks when i got into this

511
00:19:56,000 --> 00:19:59,039
and was doing my first captures

512
00:19:59,039 --> 00:20:01,200
almost every wireless network was open

513
00:20:01,200 --> 00:20:03,039
it was very rare to have a wireless

514
00:20:03,039 --> 00:20:04,159
network that

515
00:20:04,159 --> 00:20:05,919
used any type of encryption and that you

516
00:20:05,919 --> 00:20:07,440
had to put your password in or you had

517
00:20:07,440 --> 00:20:09,919
to have the um certificate or anything

518
00:20:09,919 --> 00:20:12,559
right those were uncommon and so

519
00:20:12,559 --> 00:20:14,159
capturing traffic

520
00:20:14,159 --> 00:20:16,320
in those days was really

521
00:20:16,320 --> 00:20:19,039
awesome right because you could see

522
00:20:19,039 --> 00:20:20,880
in a in a wireless device where you're

523
00:20:20,880 --> 00:20:23,280
capturing traffic is anything that can

524
00:20:23,280 --> 00:20:25,840
see those uh wireless

525
00:20:25,840 --> 00:20:28,400
right um waves

526
00:20:28,400 --> 00:20:30,320
could read that traffic

527
00:20:30,320 --> 00:20:32,559
and so i remember when i first learned

528
00:20:32,559 --> 00:20:34,320
about that i was like whoa

529
00:20:34,320 --> 00:20:36,799
mind blowing so i you know went home to

530
00:20:36,799 --> 00:20:39,120
my parents and pulled it up and said hey

531
00:20:39,120 --> 00:20:41,360
dad you know go visit that website or

532
00:20:41,360 --> 00:20:42,240
whatever

533
00:20:42,240 --> 00:20:44,000
and i captured it and then i showed it i

534
00:20:44,000 --> 00:20:46,320
was like look here's what you just did

535
00:20:46,320 --> 00:20:48,720
and i saw it all it's like whoa

536
00:20:48,720 --> 00:20:49,919
mind blown

537
00:20:49,919 --> 00:20:52,159
um

538
00:20:52,159 --> 00:20:54,320
i went to

539
00:20:54,320 --> 00:20:56,960
oh now i'm not sure is it dark matter

540
00:20:56,960 --> 00:20:59,440
that does the wifi cactus did anyone

541
00:20:59,440 --> 00:21:01,039
else go to that talk

542
00:21:01,039 --> 00:21:03,360
so i went to that one and

543
00:21:03,360 --> 00:21:05,840
he's doing capturing wireless traffic

544
00:21:05,840 --> 00:21:07,520
and it turns out even though most of our

545
00:21:07,520 --> 00:21:09,679
networks now are encrypted and

546
00:21:09,679 --> 00:21:11,760
you have to have a key in stuff

547
00:21:11,760 --> 00:21:14,240
if you have that key it's still

548
00:21:14,240 --> 00:21:15,360
able to

549
00:21:15,360 --> 00:21:17,440
capture that traffic and decrypt it so

550
00:21:17,440 --> 00:21:18,480
there are

551
00:21:18,480 --> 00:21:20,320
options here when you're capturing

552
00:21:20,320 --> 00:21:22,159
wireless traffic

553
00:21:22,159 --> 00:21:23,840
it's a little harder to do than it used

554
00:21:23,840 --> 00:21:25,919
to be if you want to get that wireless

555
00:21:25,919 --> 00:21:27,440
traffic

556
00:21:27,440 --> 00:21:32,080
from a wireless card but you can do it

557
00:21:34,400 --> 00:21:36,880
any questions about

558
00:21:36,880 --> 00:21:39,440
where to capture or how to capture

559
00:21:39,440 --> 00:21:41,200
we didn't go too much into the house in

560
00:21:41,200 --> 00:21:43,679
terms of what it looks like on wireshark

561
00:21:43,679 --> 00:21:46,080
i'll just

562
00:21:47,360 --> 00:21:49,360
so this little blue fin

563
00:21:49,360 --> 00:21:51,919
if you've already loaded a capture file

564
00:21:51,919 --> 00:21:53,919
is what oh i didn't want to actually

565
00:21:53,919 --> 00:21:56,240
start

566
00:21:56,880 --> 00:21:58,080
that's good because i didn't have one

567
00:21:58,080 --> 00:22:00,880
here we go when you're in this interface

568
00:22:00,880 --> 00:22:01,679
here

569
00:22:01,679 --> 00:22:05,280
you can choose which wireless well which

570
00:22:05,280 --> 00:22:06,880
network device you want to capture

571
00:22:06,880 --> 00:22:08,000
traffic on

572
00:22:08,000 --> 00:22:10,640
and i'm not you know plugged into my

573
00:22:10,640 --> 00:22:12,320
local connection and so there's no

574
00:22:12,320 --> 00:22:14,320
traffic there whereas my wi-fi traffic

575
00:22:14,320 --> 00:22:16,240
you can see on this line it's getting

576
00:22:16,240 --> 00:22:17,919
traffic so if i wanted to start

577
00:22:17,919 --> 00:22:20,640
capturing traffic live that's

578
00:22:20,640 --> 00:22:24,760
how i would go about doing it

579
00:22:29,520 --> 00:22:33,120
so that's a great question uh i

580
00:22:33,120 --> 00:22:34,720
for those that couldn't hear he asked

581
00:22:34,720 --> 00:22:36,720
about he said on linux you can do tcp

582
00:22:36,720 --> 00:22:39,039
dump to capture the traffic

583
00:22:39,039 --> 00:22:42,080
which is super helpful you can then

584
00:22:42,080 --> 00:22:44,559
right you can use what tcp dump captures

585
00:22:44,559 --> 00:22:46,720
to then feed into wireshark

586
00:22:46,720 --> 00:22:48,960
and then he asks about tools on windows

587
00:22:48,960 --> 00:22:51,280
to do the same thing

588
00:22:51,280 --> 00:22:52,080
i

589
00:22:52,080 --> 00:22:53,840
typically when i'm capturing from a

590
00:22:53,840 --> 00:22:56,880
windows device we'll just use uh

591
00:22:56,880 --> 00:23:00,720
wireshark to do the actual capture

592
00:23:00,720 --> 00:23:03,280
i believe there are tools

593
00:23:03,280 --> 00:23:06,000
um well one tool that's related to

594
00:23:06,000 --> 00:23:07,919
wireshark is the t-shark which is

595
00:23:07,919 --> 00:23:09,679
basically a command line interface

596
00:23:09,679 --> 00:23:12,159
version of wireshark

597
00:23:12,159 --> 00:23:13,600
that you can do if

598
00:23:13,600 --> 00:23:14,880
if you're wanting to capture from the

599
00:23:14,880 --> 00:23:16,559
command line like you can do with tcp

600
00:23:16,559 --> 00:23:17,840
dump

601
00:23:17,840 --> 00:23:19,919
great question other questions about

602
00:23:19,919 --> 00:23:23,640
where or how to capture

603
00:23:38,880 --> 00:23:40,000
uh that

604
00:23:40,000 --> 00:23:42,159
still has been my experience so again to

605
00:23:42,159 --> 00:23:43,679
repeat the question he's saying you know

606
00:23:43,679 --> 00:23:46,320
wireless um nicks or wireless network

607
00:23:46,320 --> 00:23:47,860
interface cards

608
00:23:47,860 --> 00:23:49,120
[Music]

609
00:23:49,120 --> 00:23:50,880
in the past it's been difficult to get

610
00:23:50,880 --> 00:23:52,880
them into monitor mode to get them to be

611
00:23:52,880 --> 00:23:55,279
able to actually monitor all the traffic

612
00:23:55,279 --> 00:23:57,279
he's asking if that's still the case

613
00:23:57,279 --> 00:23:58,159
um

614
00:23:58,159 --> 00:24:00,320
in terms of if you just go out and buy a

615
00:24:00,320 --> 00:24:03,279
random wireless card or a random laptop

616
00:24:03,279 --> 00:24:05,360
and use its wireless card

617
00:24:05,360 --> 00:24:07,360
yeah it's pretty hit and miss still if

618
00:24:07,360 --> 00:24:09,200
you're able to do a good capture with

619
00:24:09,200 --> 00:24:11,919
that but there are

620
00:24:11,919 --> 00:24:15,200
specific radios and drivers now

621
00:24:15,200 --> 00:24:16,799
that if you know that's what you want to

622
00:24:16,799 --> 00:24:19,520
do you go out and get those ones and in

623
00:24:19,520 --> 00:24:21,279
that case right talk to like dark matter

624
00:24:21,279 --> 00:24:23,520
with the wi-fi cactus because he can you

625
00:24:23,520 --> 00:24:25,440
know tell you all about his experience

626
00:24:25,440 --> 00:24:27,679
with capturing the wireless traffic but

627
00:24:27,679 --> 00:24:30,159
yeah for me it's still been hit and miss

628
00:24:30,159 --> 00:24:33,919
on how well a random wireless

629
00:24:33,919 --> 00:24:37,600
nic will be able to capture your traffic

630
00:24:39,279 --> 00:24:41,919
other questions

631
00:24:43,279 --> 00:24:46,440
all right

632
00:24:48,080 --> 00:24:50,240
so

633
00:24:50,240 --> 00:24:51,840
where'd we leave off

634
00:24:51,840 --> 00:24:53,360
having a baseline

635
00:24:53,360 --> 00:24:55,679
all right when i teach this class at the

636
00:24:55,679 --> 00:24:57,360
university

637
00:24:57,360 --> 00:24:58,080
i

638
00:24:58,080 --> 00:25:00,080
as part of the class i have the students

639
00:25:00,080 --> 00:25:01,760
do a project and they can choose

640
00:25:01,760 --> 00:25:03,520
whatever project they want

641
00:25:03,520 --> 00:25:05,120
they pick something they're interested

642
00:25:05,120 --> 00:25:07,279
in but it has to involve capturing

643
00:25:07,279 --> 00:25:09,360
traffic and using wireshark and lots of

644
00:25:09,360 --> 00:25:10,720
times they'll say oh i'm going to do a

645
00:25:10,720 --> 00:25:12,559
capture on my own home network or i want

646
00:25:12,559 --> 00:25:14,240
to see what happens when i'm streaming

647
00:25:14,240 --> 00:25:15,520
twitch or i want to see what happens

648
00:25:15,520 --> 00:25:16,720
when i'm playing this video game or

649
00:25:16,720 --> 00:25:18,000
whatever

650
00:25:18,000 --> 00:25:19,679
and they'll do something like that

651
00:25:19,679 --> 00:25:20,640
and

652
00:25:20,640 --> 00:25:22,720
probably like 99 of the time when they

653
00:25:22,720 --> 00:25:23,840
do that

654
00:25:23,840 --> 00:25:25,840
they come back and they're like

655
00:25:25,840 --> 00:25:28,640
whoa i never knew what all this other

656
00:25:28,640 --> 00:25:31,120
stuff was on my network like i tried to

657
00:25:31,120 --> 00:25:32,880
just look at what happened when i played

658
00:25:32,880 --> 00:25:35,120
this game but there was

659
00:25:35,120 --> 00:25:36,880
a hundred other things going on on my

660
00:25:36,880 --> 00:25:38,720
network and i had a hard time you know

661
00:25:38,720 --> 00:25:41,200
finding the traffic that was my game and

662
00:25:41,200 --> 00:25:43,279
i got sidetracked because i saw this

663
00:25:43,279 --> 00:25:45,840
thing and i thought maybe i was um

664
00:25:45,840 --> 00:25:47,840
being attacked right i saw this traffic

665
00:25:47,840 --> 00:25:49,520
and i didn't know what it was or i saw

666
00:25:49,520 --> 00:25:51,200
this ip address that was on my home

667
00:25:51,200 --> 00:25:53,120
network and i didn't know what it was

668
00:25:53,120 --> 00:25:54,320
and so

669
00:25:54,320 --> 00:25:57,200
when you start doing a network

670
00:25:57,200 --> 00:25:59,600
capture one of the keys is to have a

671
00:25:59,600 --> 00:26:02,720
baseline to know what your traffic looks

672
00:26:02,720 --> 00:26:05,679
like in a normal circumstance

673
00:26:05,679 --> 00:26:07,919
so that you can then find those

674
00:26:07,919 --> 00:26:10,080
anomalies and you can find the things

675
00:26:10,080 --> 00:26:12,240
that are different or you install a new

676
00:26:12,240 --> 00:26:14,000
service and you can see how it changes

677
00:26:14,000 --> 00:26:15,760
your network traffic

678
00:26:15,760 --> 00:26:18,159
and so that's what we're going to

679
00:26:18,159 --> 00:26:20,480
work through here for just a minute is

680
00:26:20,480 --> 00:26:23,200
talking about baselining our network and

681
00:26:23,200 --> 00:26:26,559
figuring out what normal looks like

682
00:26:26,559 --> 00:26:28,400
so there's lots of different things you

683
00:26:28,400 --> 00:26:29,440
can do there

684
00:26:29,440 --> 00:26:31,679
in terms of baselining your network you

685
00:26:31,679 --> 00:26:33,919
can

686
00:26:34,000 --> 00:26:36,640
look at what protocols are being used in

687
00:26:36,640 --> 00:26:39,520
your captures you can look at

688
00:26:39,520 --> 00:26:43,120
how much traffic's flowing you know in a

689
00:26:43,120 --> 00:26:45,279
given time period you can look at what

690
00:26:45,279 --> 00:26:46,640
the hosts are

691
00:26:46,640 --> 00:26:48,559
which ip addresses are active on your

692
00:26:48,559 --> 00:26:50,880
network

693
00:26:50,880 --> 00:26:54,080
and all that's going to vary

694
00:26:54,080 --> 00:26:57,039
for each network and over time as

695
00:26:57,039 --> 00:26:59,279
different things change so having a

696
00:26:59,279 --> 00:27:02,159
baseline of what wireless traffic looks

697
00:27:02,159 --> 00:27:04,400
like when you're here at st con is going

698
00:27:04,400 --> 00:27:05,520
to be

699
00:27:05,520 --> 00:27:07,679
different than what it might look like

700
00:27:07,679 --> 00:27:09,360
on your home network or what it might

701
00:27:09,360 --> 00:27:11,760
look like on your work network every

702
00:27:11,760 --> 00:27:14,400
network has a different kind of profile

703
00:27:14,400 --> 00:27:18,240
of what's normal for that network

704
00:27:18,240 --> 00:27:21,600
and so we want to know what's normal for

705
00:27:21,600 --> 00:27:24,320
our own network whichever one we're

706
00:27:24,320 --> 00:27:26,640
monitoring or trying to

707
00:27:26,640 --> 00:27:28,240
look for details on

708
00:27:28,240 --> 00:27:30,399
so i have four different capture files

709
00:27:30,399 --> 00:27:32,799
in the download that i want you to play

710
00:27:32,799 --> 00:27:34,240
around with a little bit and i'll give

711
00:27:34,240 --> 00:27:36,559
you a couple things that you can look at

712
00:27:36,559 --> 00:27:38,880
specifically and just see how these

713
00:27:38,880 --> 00:27:40,799
capture files are different

714
00:27:40,799 --> 00:27:43,520
or similar

715
00:27:43,520 --> 00:27:45,760
so the four capture files the baseline

716
00:27:45,760 --> 00:27:47,679
one that we've pulled up

717
00:27:47,679 --> 00:27:49,520
the mac off flood

718
00:27:49,520 --> 00:27:52,399
uh the nat back and the nat front okay

719
00:27:52,399 --> 00:27:54,080
and so let me

720
00:27:54,080 --> 00:27:55,360
walk through a couple of things on the

721
00:27:55,360 --> 00:27:57,919
baseline and then you guys can walk

722
00:27:57,919 --> 00:27:58,640
through

723
00:27:58,640 --> 00:28:00,240
some of those same things with the other

724
00:28:00,240 --> 00:28:02,159
capture files and then we'll talk about

725
00:28:02,159 --> 00:28:04,240
it

726
00:28:05,360 --> 00:28:08,080
okay so pull open my baseline file again

727
00:28:08,080 --> 00:28:10,399
here

728
00:28:13,279 --> 00:28:16,159
and i'm going to start in my statistics

729
00:28:16,159 --> 00:28:19,360
and my capture file properties

730
00:28:19,360 --> 00:28:21,360
so this one's going to give me some

731
00:28:21,360 --> 00:28:23,440
overall statistics about the entire

732
00:28:23,440 --> 00:28:25,840
capture file itself

733
00:28:25,840 --> 00:28:28,480
most of them i don't care about you know

734
00:28:28,480 --> 00:28:30,640
in terms of the file itself so i

735
00:28:30,640 --> 00:28:33,120
generally skip over those

736
00:28:33,120 --> 00:28:36,159
the time when the capture

737
00:28:36,159 --> 00:28:38,640
occurred that can be useful

738
00:28:38,640 --> 00:28:40,720
depending on what you're trying to do so

739
00:28:40,720 --> 00:28:42,159
you can see you know this one was

740
00:28:42,159 --> 00:28:45,039
captured four or five years ago

741
00:28:45,039 --> 00:28:48,159
in between these time periods

742
00:28:48,159 --> 00:28:48,800
you can see

743
00:28:48,800 --> 00:28:50,240
[Music]

744
00:28:50,240 --> 00:28:52,960
sometimes information about what device

745
00:28:52,960 --> 00:28:55,120
it was captured from depending on what

746
00:28:55,120 --> 00:28:58,399
was available in the capture file itself

747
00:28:58,399 --> 00:28:59,919
but what we care about here for

748
00:28:59,919 --> 00:29:01,279
baselining

749
00:29:01,279 --> 00:29:03,600
is these statistics down here at the

750
00:29:03,600 --> 00:29:04,480
bottom

751
00:29:04,480 --> 00:29:05,760
so we can see

752
00:29:05,760 --> 00:29:08,399
how many packets we captured we can see

753
00:29:08,399 --> 00:29:10,840
over what time span

754
00:29:10,840 --> 00:29:13,840
and what that breaks down into in terms

755
00:29:13,840 --> 00:29:16,080
of packets per second so that's our pps

756
00:29:16,080 --> 00:29:18,799
here is how many packets per second

757
00:29:18,799 --> 00:29:19,919
and then

758
00:29:19,919 --> 00:29:21,360
the size of those

759
00:29:21,360 --> 00:29:22,960
packets on average

760
00:29:22,960 --> 00:29:24,799
total number of bytes

761
00:29:24,799 --> 00:29:26,640
and then average bytes per second and

762
00:29:26,640 --> 00:29:28,559
average bits per second

763
00:29:28,559 --> 00:29:30,080
and so that

764
00:29:30,080 --> 00:29:31,520
at a very high level is going to give

765
00:29:31,520 --> 00:29:33,760
you some statistics on your network of

766
00:29:33,760 --> 00:29:36,480
how much traffic was flowing during that

767
00:29:36,480 --> 00:29:39,480
capture

768
00:29:41,039 --> 00:29:43,440
also in our statistics menu

769
00:29:43,440 --> 00:29:45,919
we can

770
00:29:45,919 --> 00:29:49,360
look at our protocol hierarchy

771
00:29:49,360 --> 00:29:51,360
and this is going to give us a different

772
00:29:51,360 --> 00:29:53,279
way of breaking down the traffic this

773
00:29:53,279 --> 00:29:56,320
breaks it down by what protocol was used

774
00:29:56,320 --> 00:29:58,720
as a percentage of the total traffic

775
00:29:58,720 --> 00:30:00,159
captured

776
00:30:00,159 --> 00:30:01,919
and so all of them

777
00:30:01,919 --> 00:30:03,120
were using

778
00:30:03,120 --> 00:30:04,080
uh

779
00:30:04,080 --> 00:30:06,559
frames and ethernet right so a hundred

780
00:30:06,559 --> 00:30:08,799
percent of the packets we captured

781
00:30:08,799 --> 00:30:10,960
were captured that way which makes sense

782
00:30:10,960 --> 00:30:12,799
since we were capturing on a

783
00:30:12,799 --> 00:30:15,200
ethernet device

784
00:30:15,200 --> 00:30:17,200
some of the protocol some of the traffic

785
00:30:17,200 --> 00:30:19,600
was using ipv6

786
00:30:19,600 --> 00:30:20,840
but not

787
00:30:20,840 --> 00:30:23,200
even high enough to register as a

788
00:30:23,200 --> 00:30:25,360
percentage of our packets it was just

789
00:30:25,360 --> 00:30:28,559
two packets that showed up like that

790
00:30:28,559 --> 00:30:32,480
most of them were using ipv4

791
00:30:32,960 --> 00:30:35,520
of those right so this is like drilling

792
00:30:35,520 --> 00:30:38,880
down and so of the ones using ipv4

793
00:30:38,880 --> 00:30:39,760
then

794
00:30:39,760 --> 00:30:42,240
four percent of them were using udp

795
00:30:42,240 --> 00:30:44,159
95 of them

796
00:30:44,159 --> 00:30:47,679
were using tcp and so it breaks it down

797
00:30:47,679 --> 00:30:49,360
and then further which applications were

798
00:30:49,360 --> 00:30:50,559
being used

799
00:30:50,559 --> 00:30:52,399
and that can give you a guide and

800
00:30:52,399 --> 00:30:54,640
insight into your network of okay how

801
00:30:54,640 --> 00:30:56,799
much traffic am i seeing that's http

802
00:30:56,799 --> 00:30:59,440
traffic how much of it is ftp traffic

803
00:30:59,440 --> 00:31:00,559
and

804
00:31:00,559 --> 00:31:04,600
start to get a feel for that

805
00:31:08,640 --> 00:31:10,080
the other one

806
00:31:10,080 --> 00:31:12,320
that we'll look at right now is this in

807
00:31:12,320 --> 00:31:14,240
points

808
00:31:14,240 --> 00:31:17,440
and so the endpoints has tabs at the top

809
00:31:17,440 --> 00:31:18,480
that

810
00:31:18,480 --> 00:31:20,000
again correspond to our different

811
00:31:20,000 --> 00:31:21,919
protocols and so it depends on what

812
00:31:21,919 --> 00:31:23,919
level we're talking about in terms of

813
00:31:23,919 --> 00:31:25,919
our network hierarchy for looking at

814
00:31:25,919 --> 00:31:28,960
endpoints so we can look at endpoints

815
00:31:28,960 --> 00:31:30,640
at our

816
00:31:30,640 --> 00:31:33,039
lowest level right closest to our actual

817
00:31:33,039 --> 00:31:35,679
physical network and look at the mac

818
00:31:35,679 --> 00:31:38,720
addresses that were observed in this

819
00:31:38,720 --> 00:31:41,039
communication

820
00:31:41,039 --> 00:31:42,559
we can

821
00:31:42,559 --> 00:31:44,880
move closer to the application at our

822
00:31:44,880 --> 00:31:46,480
network layer and look at what ip

823
00:31:46,480 --> 00:31:48,640
addresses were observed in this

824
00:31:48,640 --> 00:31:50,240
communication

825
00:31:50,240 --> 00:31:53,679
and not only which ip addresses or which

826
00:31:53,679 --> 00:31:55,919
mac addresses but also some statistics

827
00:31:55,919 --> 00:31:57,679
about them how many packets how many

828
00:31:57,679 --> 00:31:59,519
bytes i was the

829
00:31:59,519 --> 00:32:01,120
how many of those were being transferred

830
00:32:01,120 --> 00:32:04,559
how many of them were being received

831
00:32:04,559 --> 00:32:08,240
okay and we can do that for each of our

832
00:32:08,240 --> 00:32:10,080
levels through the

833
00:32:10,080 --> 00:32:11,519
up to the

834
00:32:11,519 --> 00:32:14,080
transport layer so then we can look at

835
00:32:14,080 --> 00:32:16,240
tcp and udp that will include both ip

836
00:32:16,240 --> 00:32:18,320
address and port number and break it

837
00:32:18,320 --> 00:32:20,000
down that way

838
00:32:20,000 --> 00:32:22,159
okay so let's start with that i've i've

839
00:32:22,159 --> 00:32:23,360
kind of walked you through looking at

840
00:32:23,360 --> 00:32:25,679
statistics for our baseline file what i

841
00:32:25,679 --> 00:32:27,679
want you to do is now pull open those

842
00:32:27,679 --> 00:32:30,480
other three files the mac off file

843
00:32:30,480 --> 00:32:32,320
the nmap um

844
00:32:32,320 --> 00:32:35,120
not nmap the nat back and that front

845
00:32:35,120 --> 00:32:37,600
and just do a little comparison how do

846
00:32:37,600 --> 00:32:40,159
those compare to our baseline what do

847
00:32:40,159 --> 00:32:42,640
they look like how are they similar how

848
00:32:42,640 --> 00:32:44,880
are they different and we'll take maybe

849
00:32:44,880 --> 00:32:47,200
five minutes or so to work through those

850
00:32:47,200 --> 00:32:48,640
and i'll walk around if you have

851
00:32:48,640 --> 00:32:50,640
questions about the statistics and stuff

852
00:32:50,640 --> 00:32:51,919
and then we'll come back up and talk

853
00:32:51,919 --> 00:32:55,880
about it up front okay

854
00:35:25,280 --> 00:35:26,079
okay

855
00:35:26,079 --> 00:35:27,680
if you need the link

856
00:35:27,680 --> 00:35:29,440
to download the files it's up here while

857
00:35:29,440 --> 00:35:33,079
we're walking around

858
00:37:31,680 --> 00:37:34,000
okay

859
00:37:34,720 --> 00:37:36,960
so

860
00:37:36,960 --> 00:37:38,640
here we go

861
00:37:38,640 --> 00:37:40,640
what did you guys find as you were

862
00:37:40,640 --> 00:37:42,480
looking at that what were some of the

863
00:37:42,480 --> 00:37:45,359
similarities in these capture files and

864
00:37:45,359 --> 00:37:46,960
what were some of the

865
00:37:46,960 --> 00:37:49,960
differences

866
00:37:55,119 --> 00:37:58,599
the flood one

867
00:38:05,520 --> 00:38:10,160
okay yeah so you so you're in in the

868
00:38:12,160 --> 00:38:15,598
no let's pull it up and

869
00:38:17,119 --> 00:38:18,400
well it should have been in my recent

870
00:38:18,400 --> 00:38:20,640
list

871
00:38:24,079 --> 00:38:26,079
so you're talking about here in the file

872
00:38:26,079 --> 00:38:28,960
statistics right

873
00:38:29,359 --> 00:38:30,960
let it finish loading so it can tell us

874
00:38:30,960 --> 00:38:33,839
about it

875
00:38:34,079 --> 00:38:36,480
there we go

876
00:38:42,160 --> 00:38:44,320
so hardware is unknown

877
00:38:44,320 --> 00:38:46,560
as was the other one i get

878
00:38:46,560 --> 00:38:48,800
os and applications still being detected

879
00:38:48,800 --> 00:38:49,920
is that

880
00:38:49,920 --> 00:38:51,200
what you're seeing are you seeing

881
00:38:51,200 --> 00:38:54,520
something different

882
00:39:05,280 --> 00:39:07,440
i

883
00:39:08,720 --> 00:39:09,599
yeah

884
00:39:09,599 --> 00:39:12,760
the uh

885
00:39:14,640 --> 00:39:16,240
so this one

886
00:39:16,240 --> 00:39:17,599
you're you're talking about the mac off

887
00:39:17,599 --> 00:39:19,680
flood right

888
00:39:19,680 --> 00:39:22,160
and the

889
00:39:23,680 --> 00:39:27,000
end points

890
00:39:29,359 --> 00:39:30,880
yeah right

891
00:39:30,880 --> 00:39:33,520
look at those ip addresses in terms of

892
00:39:33,520 --> 00:39:35,599
and how they compare to what we were

893
00:39:35,599 --> 00:39:39,599
seeing before okay good

894
00:39:40,960 --> 00:39:42,400
other things you guys

895
00:39:42,400 --> 00:39:46,240
notice as you go through these files

896
00:39:52,800 --> 00:39:55,200
okay great yeah so you're talking about

897
00:39:55,200 --> 00:39:57,599
you know how fast it is so let's look at

898
00:39:57,599 --> 00:39:58,800
that

899
00:39:58,800 --> 00:40:00,720
when we check out these capture file

900
00:40:00,720 --> 00:40:03,280
packets so this one's doing

901
00:40:03,280 --> 00:40:05,359
an average of

902
00:40:05,359 --> 00:40:09,119
1 245 packets per second and whereas the

903
00:40:09,119 --> 00:40:11,359
baseline was what 50 or something like

904
00:40:11,359 --> 00:40:13,599
that

905
00:40:13,599 --> 00:40:15,280
yeah

906
00:40:15,280 --> 00:40:16,640
okay

907
00:40:16,640 --> 00:40:18,560
good observation other things you guys

908
00:40:18,560 --> 00:40:21,560
noticed

909
00:40:25,680 --> 00:40:29,118
okay so nat back

910
00:40:36,160 --> 00:40:38,880
and seeing lots of ssh traffic right

911
00:40:38,880 --> 00:40:40,560
that's what you're talking about

912
00:40:40,560 --> 00:40:43,440
good so now seeing more of a particular

913
00:40:43,440 --> 00:40:47,200
kind of traffic in this capture file

914
00:40:49,200 --> 00:40:51,440
and for those right so we can sort of

915
00:40:51,440 --> 00:40:52,800
follow along

916
00:40:52,800 --> 00:40:55,119
one way that we could see that is in our

917
00:40:55,119 --> 00:40:58,079
protocol hierarchy and we can see

918
00:40:58,079 --> 00:41:02,240
oh yeah 11 of this traffic is ssh

919
00:41:02,240 --> 00:41:05,240
traffic

920
00:41:07,680 --> 00:41:11,480
yeah let's do that

921
00:41:24,960 --> 00:41:27,359
that's a great question let's dig into

922
00:41:27,359 --> 00:41:29,280
that question a little bit okay so we

923
00:41:29,280 --> 00:41:31,440
we've pulled up this file we've pulled

924
00:41:31,440 --> 00:41:33,200
up our protocol hierarchy and we're

925
00:41:33,200 --> 00:41:34,400
looking at it and we're saying wait a

926
00:41:34,400 --> 00:41:37,040
minute this doesn't look normal this is

927
00:41:37,040 --> 00:41:38,800
different than our baseline what's going

928
00:41:38,800 --> 00:41:40,079
on here

929
00:41:40,079 --> 00:41:42,160
and so the observation he made was

930
00:41:42,160 --> 00:41:45,520
there's a couple packets that have

931
00:41:45,520 --> 00:41:48,160
an application layer protocol and even a

932
00:41:48,160 --> 00:41:50,800
tcp or udp right transport layer

933
00:41:50,800 --> 00:41:53,200
protocol but only two of them

934
00:41:53,200 --> 00:41:56,240
out of the 76 000 packets we captured

935
00:41:56,240 --> 00:41:59,520
only two of them have any

936
00:41:59,680 --> 00:42:02,800
recognizable transport layer protocol or

937
00:42:02,800 --> 00:42:04,000
higher

938
00:42:04,000 --> 00:42:06,640
and so one of the questions we might ask

939
00:42:06,640 --> 00:42:08,400
is is that just because

940
00:42:08,400 --> 00:42:10,160
it's not detecting what the transport

941
00:42:10,160 --> 00:42:12,319
layer is well let's take a look at our

942
00:42:12,319 --> 00:42:14,880
packet details and see

943
00:42:14,880 --> 00:42:17,599
so as i select in my packet list and

944
00:42:17,599 --> 00:42:20,400
i'll just start with the very first one

945
00:42:20,400 --> 00:42:22,720
what we actually see

946
00:42:22,720 --> 00:42:24,640
is when we go into packet details is the

947
00:42:24,640 --> 00:42:26,640
same thing as it's only breaking it down

948
00:42:26,640 --> 00:42:28,880
into those first two layers or

949
00:42:28,880 --> 00:42:31,040
you know our

950
00:42:31,040 --> 00:42:34,079
ethernet layer and our ip

951
00:42:34,079 --> 00:42:37,119
v4 layer and there's nothing below that

952
00:42:37,119 --> 00:42:40,480
when we look at the bytes

953
00:42:40,960 --> 00:42:42,800
that show up with that

954
00:42:42,800 --> 00:42:45,839
there are

955
00:42:47,119 --> 00:42:49,680
right bytes beyond

956
00:42:49,680 --> 00:42:53,118
the ipv4

957
00:42:53,280 --> 00:42:55,040
protocol there's these

958
00:42:55,040 --> 00:42:57,359
additional what is that that's like 10

959
00:42:57,359 --> 00:42:59,520
or 12 bytes it looks like

960
00:42:59,520 --> 00:43:02,880
uh of data that isn't being classified

961
00:43:02,880 --> 00:43:04,160
as anything

962
00:43:04,160 --> 00:43:05,680
so

963
00:43:05,680 --> 00:43:07,040
yeah it's

964
00:43:07,040 --> 00:43:08,160
close to

965
00:43:08,160 --> 00:43:10,400
what you were saying like there there is

966
00:43:10,400 --> 00:43:13,520
something there after our network layer

967
00:43:13,520 --> 00:43:15,520
but it isn't

968
00:43:15,520 --> 00:43:16,880
a typical

969
00:43:16,880 --> 00:43:20,079
udp packet or a typical tcp packet or

970
00:43:20,079 --> 00:43:21,839
anything else that wireshark knows how

971
00:43:21,839 --> 00:43:24,160
to recognize and wireshark knows how to

972
00:43:24,160 --> 00:43:28,160
recognize a lot of protocols

973
00:43:29,280 --> 00:43:30,240
as a

974
00:43:30,240 --> 00:43:32,000
side note here

975
00:43:32,000 --> 00:43:33,760
if we go into

976
00:43:33,760 --> 00:43:36,640
preferences

977
00:43:37,680 --> 00:43:42,160
and click on the protocols we can see

978
00:43:42,160 --> 00:43:44,160
all of the different protocols that

979
00:43:44,160 --> 00:43:47,920
wireshark knows how to recognize

980
00:43:48,240 --> 00:43:49,359
and it's

981
00:43:49,359 --> 00:43:52,680
none of those

982
00:43:54,400 --> 00:43:57,920
okay so that was a good observation

983
00:43:59,040 --> 00:44:02,319
other things on these files

984
00:44:07,680 --> 00:44:09,760
let's uh

985
00:44:09,760 --> 00:44:12,800
continue on here

986
00:44:16,160 --> 00:44:17,920
is it okay if i don't go back into

987
00:44:17,920 --> 00:44:20,240
presenter mode and you can see the sides

988
00:44:20,240 --> 00:44:22,560
okay like this

989
00:44:22,560 --> 00:44:24,560
just switching back and forth it's a

990
00:44:24,560 --> 00:44:26,799
pain

991
00:44:31,839 --> 00:44:33,520
okay so we've done a little bit of

992
00:44:33,520 --> 00:44:35,520
baselining we've seen how some of the

993
00:44:35,520 --> 00:44:37,599
packet captures are similar how some of

994
00:44:37,599 --> 00:44:40,800
them are quite different

995
00:44:40,880 --> 00:44:43,280
let's talk a little bit more about how

996
00:44:43,280 --> 00:44:45,920
to sniff and this is how to sniff part

997
00:44:45,920 --> 00:44:46,800
two

998
00:44:46,800 --> 00:44:48,560
i remember how i was saying with

999
00:44:48,560 --> 00:44:51,040
wireless traffic it used to be

1000
00:44:51,040 --> 00:44:53,119
you know all of it was unencrypted and

1001
00:44:53,119 --> 00:44:54,960
you could just sniff it right out of

1002
00:44:54,960 --> 00:44:57,680
there and it was awesome

1003
00:44:57,680 --> 00:45:00,560
the same is becoming true

1004
00:45:00,560 --> 00:45:02,079
of our

1005
00:45:02,079 --> 00:45:05,359
http traffic right all the traffic that

1006
00:45:05,359 --> 00:45:06,319
um

1007
00:45:06,319 --> 00:45:09,440
flows through our web browsers and stuff

1008
00:45:09,440 --> 00:45:11,440
it used to be

1009
00:45:11,440 --> 00:45:12,480
that

1010
00:45:12,480 --> 00:45:16,839
most websites were done over normal just

1011
00:45:16,839 --> 00:45:18,480
http

1012
00:45:18,480 --> 00:45:19,359
now

1013
00:45:19,359 --> 00:45:22,319
we've seen a shift to where almost every

1014
00:45:22,319 --> 00:45:25,119
website is using https

1015
00:45:25,119 --> 00:45:27,520
and they're encrypting all that traffic

1016
00:45:27,520 --> 00:45:30,800
and so even when you're capturing on a

1017
00:45:30,800 --> 00:45:34,960
wired interface you're not able to see

1018
00:45:34,960 --> 00:45:36,560
the details

1019
00:45:36,560 --> 00:45:38,720
of what's being sent

1020
00:45:38,720 --> 00:45:40,800
through that application layer protocol

1021
00:45:40,800 --> 00:45:42,720
because it's being encrypted through

1022
00:45:42,720 --> 00:45:46,000
either tls or ssl

1023
00:45:46,000 --> 00:45:48,240
well there's a couple ways around that

1024
00:45:48,240 --> 00:45:50,240
uh with

1025
00:45:50,240 --> 00:45:52,240
either using wireshark or using other

1026
00:45:52,240 --> 00:45:53,200
tools

1027
00:45:53,200 --> 00:45:55,119
right so one way around it using other

1028
00:45:55,119 --> 00:45:57,680
tools is you can set up a proxy right

1029
00:45:57,680 --> 00:45:59,680
that'll

1030
00:45:59,680 --> 00:46:01,680
receive the traffic

1031
00:46:01,680 --> 00:46:03,839
decrypt it re-encrypt it with its own

1032
00:46:03,839 --> 00:46:05,920
certificate and send it along to your

1033
00:46:05,920 --> 00:46:07,359
browser

1034
00:46:07,359 --> 00:46:09,359
and so that's one option that you can

1035
00:46:09,359 --> 00:46:10,720
use and in

1036
00:46:10,720 --> 00:46:12,720
some sort of like enterprise type

1037
00:46:12,720 --> 00:46:14,400
setting that might be

1038
00:46:14,400 --> 00:46:16,640
the best option

1039
00:46:16,640 --> 00:46:19,119
i worked at sandia national laboratories

1040
00:46:19,119 --> 00:46:22,160
for a little bit and that was what they

1041
00:46:22,160 --> 00:46:24,240
did because they

1042
00:46:24,240 --> 00:46:26,079
it was a highly secured environment and

1043
00:46:26,079 --> 00:46:28,800
they wanted to know everything that was

1044
00:46:28,800 --> 00:46:31,119
on their networks and so we had to

1045
00:46:31,119 --> 00:46:32,319
install

1046
00:46:32,319 --> 00:46:35,520
custom certificates on our

1047
00:46:35,520 --> 00:46:36,720
device

1048
00:46:36,720 --> 00:46:37,680
that

1049
00:46:37,680 --> 00:46:39,119
basically

1050
00:46:39,119 --> 00:46:41,280
let them be able to decrypt all the

1051
00:46:41,280 --> 00:46:43,520
traffic right because they

1052
00:46:43,520 --> 00:46:44,480
you know

1053
00:46:44,480 --> 00:46:46,720
signed their certificate and our browser

1054
00:46:46,720 --> 00:46:48,880
accepted it and then they were able to

1055
00:46:48,880 --> 00:46:50,400
we were still able to use the internet

1056
00:46:50,400 --> 00:46:52,400
but they were able to right monitor all

1057
00:46:52,400 --> 00:46:56,800
that traffic so that's a an option uh

1058
00:46:56,800 --> 00:46:58,240
when you're

1059
00:46:58,240 --> 00:46:59,839
just capturing traffic on your home

1060
00:46:59,839 --> 00:47:02,000
network or you know personal traffic or

1061
00:47:02,000 --> 00:47:04,960
something sometimes an easier option

1062
00:47:04,960 --> 00:47:06,000
is

1063
00:47:06,000 --> 00:47:08,400
your browser already knows how to

1064
00:47:08,400 --> 00:47:10,000
capture that

1065
00:47:10,000 --> 00:47:11,760
or how to decrypt that traffic right

1066
00:47:11,760 --> 00:47:13,359
because it's showing it to you

1067
00:47:13,359 --> 00:47:16,480
unencrypted and so if there was a way

1068
00:47:16,480 --> 00:47:17,200
to

1069
00:47:17,200 --> 00:47:19,680
have the browser

1070
00:47:19,680 --> 00:47:21,599
ability to decrypt and get that into

1071
00:47:21,599 --> 00:47:24,400
wireshark that would solve our problem

1072
00:47:24,400 --> 00:47:28,240
and it turns out that we can do that

1073
00:47:31,520 --> 00:47:32,640
let me

1074
00:47:32,640 --> 00:47:34,240
start by showing

1075
00:47:34,240 --> 00:47:38,880
what it looks like before we decrypt it

1076
00:47:38,880 --> 00:47:40,880
so i'm going to pull up

1077
00:47:40,880 --> 00:47:41,680
the

1078
00:47:41,680 --> 00:47:46,480
ssl saintcon capture file

1079
00:47:49,760 --> 00:47:52,760
and

1080
00:47:57,119 --> 00:48:00,800
actually well let me check

1081
00:48:00,960 --> 00:48:02,880
because it looks like maybe it's already

1082
00:48:02,880 --> 00:48:06,520
decrypted it

1083
00:48:12,160 --> 00:48:14,160
okay it's using that one it shouldn't

1084
00:48:14,160 --> 00:48:18,359
decrypt it we'll check oops

1085
00:48:23,200 --> 00:48:25,280
all wizard

1086
00:48:25,280 --> 00:48:26,480
so

1087
00:48:26,480 --> 00:48:28,160
please wait for the wizard to install

1088
00:48:28,160 --> 00:48:29,680
the software

1089
00:48:29,680 --> 00:48:32,680
okay

1090
00:48:34,240 --> 00:48:36,480
hello hello okay

1091
00:48:36,480 --> 00:48:40,000
red mean batteries dying or just

1092
00:48:44,960 --> 00:48:48,640
as ip addresses is kind of

1093
00:48:48,640 --> 00:48:51,040
archaic

1094
00:48:51,040 --> 00:48:53,839
and so we introduced dns

1095
00:48:53,839 --> 00:48:55,599
long long ago

1096
00:48:55,599 --> 00:48:56,400
pretty

1097
00:48:56,400 --> 00:48:58,400
in the days of

1098
00:48:58,400 --> 00:48:59,599
the

1099
00:48:59,599 --> 00:49:02,480
dns provides kind of a phone book

1100
00:49:02,480 --> 00:49:06,160
service for the internet

1101
00:49:09,119 --> 00:49:11,839
so um

1102
00:49:13,280 --> 00:49:14,400
it's a

1103
00:49:14,400 --> 00:49:16,640
i have to know the ip address

1104
00:49:16,640 --> 00:49:19,319
and i can just say i want to go to

1105
00:49:19,319 --> 00:49:23,040
microsoft.com and i don't care

1106
00:49:23,040 --> 00:49:26,480
what their ip address is

1107
00:49:26,880 --> 00:49:28,079
and

1108
00:49:28,079 --> 00:49:30,559
if i put that into my browser

1109
00:49:30,559 --> 00:49:32,800
and and go there

1110
00:49:32,800 --> 00:49:34,079
it will uh

1111
00:49:34,079 --> 00:49:36,880
it will translate that for me

1112
00:49:36,880 --> 00:49:39,599
and so all of our computers have dns

1113
00:49:39,599 --> 00:49:42,559
they use a dns server to

1114
00:49:42,559 --> 00:49:45,040
be able to

1115
00:49:45,040 --> 00:49:46,079
back

1116
00:49:46,079 --> 00:49:48,960
oh oh okay the name you asked for was

1117
00:49:48,960 --> 00:49:50,480
this

1118
00:49:50,480 --> 00:49:52,640
okay this is the ip address that you

1119
00:49:52,640 --> 00:49:55,280
want to connect to to get that

1120
00:49:55,280 --> 00:49:56,800
and so

1121
00:49:56,800 --> 00:49:58,480
uh with dns

1122
00:49:58,480 --> 00:50:00,400
that's that's what we get you know

1123
00:50:00,400 --> 00:50:02,640
that's the way it works and

1124
00:50:02,640 --> 00:50:05,359
you request something a dns request goes

1125
00:50:05,359 --> 00:50:07,520
out from your computer

1126
00:50:07,520 --> 00:50:09,920
and the response comes back from the dns

1127
00:50:09,920 --> 00:50:12,319
server saying

1128
00:50:12,319 --> 00:50:15,200
i know that or i know how you can find

1129
00:50:15,200 --> 00:50:16,800
out that

1130
00:50:16,800 --> 00:50:21,839
and helps you to find the the correct ad

1131
00:50:23,599 --> 00:50:25,200
um

1132
00:50:25,200 --> 00:50:29,520
you can you can even buy your own

1133
00:50:30,400 --> 00:50:34,480
there's out there that you can

1134
00:50:34,480 --> 00:50:38,440
to buy a name

1135
00:50:40,559 --> 00:50:42,400
you do have to tell them what dns

1136
00:50:42,400 --> 00:50:44,160
servers you want to use a lot of

1137
00:50:44,160 --> 00:50:46,640
registrars of

1138
00:50:46,640 --> 00:50:50,079
names will even offer their own dns

1139
00:50:50,079 --> 00:50:52,559
servers for you to use

1140
00:50:52,559 --> 00:50:54,559
if you have an account with them

1141
00:50:54,559 --> 00:50:55,599
so

1142
00:50:55,599 --> 00:50:58,079
and and sometimes you know when you pay

1143
00:50:58,079 --> 00:51:00,079
to register with them they'll offer

1144
00:51:00,079 --> 00:51:03,040
those services free

1145
00:51:03,040 --> 00:51:05,359
um

1146
00:51:06,319 --> 00:51:08,640
tcp and udp

1147
00:51:08,640 --> 00:51:13,400
tcp versus udp tcp

1148
01:01:20,079 --> 01:01:23,440
okay so i've had a couple requests to uh

1149
01:01:23,440 --> 01:01:24,640
demonstrate

1150
01:01:24,640 --> 01:01:26,799
what that you know using this key log

1151
01:01:26,799 --> 01:01:28,160
file actually

1152
01:01:28,160 --> 01:01:30,160
looks like where i've just you know

1153
01:01:30,160 --> 01:01:31,839
given you the key log file how do you

1154
01:01:31,839 --> 01:01:33,760
get the key log file

1155
01:01:33,760 --> 01:01:35,040
right

1156
01:01:35,040 --> 01:01:36,799
so let's take a look at that it's going

1157
01:01:36,799 --> 01:01:38,640
to be a little bit different depending

1158
01:01:38,640 --> 01:01:39,359
on

1159
01:01:39,359 --> 01:01:40,480
your

1160
01:01:40,480 --> 01:01:43,760
system and your environment

1161
01:01:43,760 --> 01:01:45,520
in terms of

1162
01:01:45,520 --> 01:01:49,880
how you set an environment variable

1163
01:01:53,599 --> 01:01:55,839
now let's just show the desktop there we

1164
01:01:55,839 --> 01:01:56,559
go

1165
01:01:56,559 --> 01:01:57,599
okay

1166
01:01:57,599 --> 01:02:00,079
so the trick here is

1167
01:02:00,079 --> 01:02:02,240
that in whatever environment you're

1168
01:02:02,240 --> 01:02:05,200
using you need to set the ssl key log

1169
01:02:05,200 --> 01:02:08,319
file environment variable

1170
01:02:08,319 --> 01:02:09,200
so

1171
01:02:09,200 --> 01:02:12,000
i'm going to

1172
01:02:16,880 --> 01:02:18,720
come in here

1173
01:02:18,720 --> 01:02:22,000
to my computer under manage

1174
01:02:22,000 --> 01:02:23,839
hopefully

1175
01:02:23,839 --> 01:02:27,880
no that's not the one i want

1176
01:02:34,240 --> 01:02:37,640
where is

1177
01:02:55,920 --> 01:02:58,960
there we go okay

1178
01:02:59,920 --> 01:03:01,760
i don't often have to set my windows

1179
01:03:01,760 --> 01:03:03,440
environment variables usually when i'm

1180
01:03:03,440 --> 01:03:06,079
doing this i'm just setting them in a

1181
01:03:06,079 --> 01:03:08,319
bash shell right and using curl or

1182
01:03:08,319 --> 01:03:09,200
something

1183
01:03:09,200 --> 01:03:10,559
so

1184
01:03:10,559 --> 01:03:11,599
for

1185
01:03:11,599 --> 01:03:13,680
again each system is going to be a

1186
01:03:13,680 --> 01:03:15,920
little different on windows i was able

1187
01:03:15,920 --> 01:03:18,640
to get to my system properties

1188
01:03:18,640 --> 01:03:19,920
through

1189
01:03:19,920 --> 01:03:22,240
this pc property's advanced system

1190
01:03:22,240 --> 01:03:23,359
settings

1191
01:03:23,359 --> 01:03:25,039
and what we're looking for is

1192
01:03:25,039 --> 01:03:27,359
environment variables

1193
01:03:27,359 --> 01:03:29,200
and we can either set them

1194
01:03:29,200 --> 01:03:30,480
for

1195
01:03:30,480 --> 01:03:31,440
um

1196
01:03:31,440 --> 01:03:32,720
oh look

1197
01:03:32,720 --> 01:03:34,960
i did not know that i was

1198
01:03:34,960 --> 01:03:37,200
i've had that set for who knows how long

1199
01:03:37,200 --> 01:03:38,160
i've

1200
01:03:38,160 --> 01:03:40,240
i've been logging my ssl key logs

1201
01:03:40,240 --> 01:03:42,240
forever oh you guys aren't seeing it it

1202
01:03:42,240 --> 01:03:46,000
went away from duplicating my display

1203
01:03:46,000 --> 01:03:49,440
thanks for pointing that out

1204
01:03:49,440 --> 01:03:53,000
go back to duplicate

1205
01:04:01,200 --> 01:04:02,559
okay so

1206
01:04:02,559 --> 01:04:04,480
environment variables

1207
01:04:04,480 --> 01:04:06,160
you can either set them for a specific

1208
01:04:06,160 --> 01:04:08,400
user or system wide

1209
01:04:08,400 --> 01:04:09,760
and the trick here

1210
01:04:09,760 --> 01:04:12,079
you name the environment variable ssl

1211
01:04:12,079 --> 01:04:13,680
keylog file

1212
01:04:13,680 --> 01:04:15,680
and the value you give it

1213
01:04:15,680 --> 01:04:18,640
is the path where you want it to write

1214
01:04:18,640 --> 01:04:20,799
that file

1215
01:04:20,799 --> 01:04:23,839
and then every time you're using

1216
01:04:23,839 --> 01:04:25,440
your browser whether it's chrome or

1217
01:04:25,440 --> 01:04:28,000
firefox i know for sure those two

1218
01:04:28,000 --> 01:04:31,119
follow this environment variable

1219
01:04:31,119 --> 01:04:33,440
and i also know curl follows this

1220
01:04:33,440 --> 01:04:35,680
environment variable anytime you're

1221
01:04:35,680 --> 01:04:36,880
using them

1222
01:04:36,880 --> 01:04:39,520
and they are using tls

1223
01:04:39,520 --> 01:04:41,359
and have that

1224
01:04:41,359 --> 01:04:44,319
pre-shared secret they will write it out

1225
01:04:44,319 --> 01:04:46,000
to this file

1226
01:04:46,000 --> 01:04:48,319
and so you set this environment variable

1227
01:04:48,319 --> 01:04:49,440
first

1228
01:04:49,440 --> 01:04:51,280
you start your capture

1229
01:04:51,280 --> 01:04:53,520
you go browse to the encrypted traffic

1230
01:04:53,520 --> 01:04:56,160
that you want to capture

1231
01:04:56,160 --> 01:04:58,400
you stop your capture

1232
01:04:58,400 --> 01:05:00,720
you come grab this file right so in this

1233
01:05:00,720 --> 01:05:03,200
case my file is located in my home

1234
01:05:03,200 --> 01:05:06,400
directory and i called it ssl keys.log

1235
01:05:06,400 --> 01:05:08,480
and i would load that file

1236
01:05:08,480 --> 01:05:11,119
into wireshark to then

1237
01:05:11,119 --> 01:05:14,319
do the decryption

1238
01:05:14,319 --> 01:05:16,558
okay

1239
01:05:17,280 --> 01:05:19,440
other questions about

1240
01:05:19,440 --> 01:05:22,400
using this keylog file or encrypting it

1241
01:05:22,400 --> 01:05:24,640
oh there was a question i wanted to show

1242
01:05:24,640 --> 01:05:27,200
and demo

1243
01:05:28,400 --> 01:05:30,559
someone said okay great we decrypted it

1244
01:05:30,559 --> 01:05:32,400
but so what like

1245
01:05:32,400 --> 01:05:35,280
how do we see what was decrypted

1246
01:05:35,280 --> 01:05:37,920
and that's a really great question

1247
01:05:37,920 --> 01:05:41,039
so we we sort of showed oh look now i

1248
01:05:41,039 --> 01:05:44,319
can filter http traffic and actually see

1249
01:05:44,319 --> 01:05:46,319
this http traffic

1250
01:05:46,319 --> 01:05:49,200
in my packet list but how do i see

1251
01:05:49,200 --> 01:05:50,880
what that traffic was how do i see what

1252
01:05:50,880 --> 01:05:54,240
was transmitted and received

1253
01:05:55,280 --> 01:05:57,760
you can right click on a packet in the

1254
01:05:57,760 --> 01:06:00,000
packet list

1255
01:06:00,000 --> 01:06:04,160
and there's this follow option

1256
01:06:04,160 --> 01:06:06,400
previously before you decrypt it it

1257
01:06:06,400 --> 01:06:10,799
wouldn't have a http stream as an option

1258
01:06:10,799 --> 01:06:13,039
now that we've decrypted it it's able to

1259
01:06:13,039 --> 01:06:15,200
follow that http stream

1260
01:06:15,200 --> 01:06:17,920
and we can pull it up and we can see

1261
01:06:17,920 --> 01:06:19,599
right the exact

1262
01:06:19,599 --> 01:06:21,119
request

1263
01:06:21,119 --> 01:06:23,359
and the response

1264
01:06:23,359 --> 01:06:25,119
and we can see

1265
01:06:25,119 --> 01:06:28,000
all the details of that response

1266
01:06:28,000 --> 01:06:29,920
and then the next request

1267
01:06:29,920 --> 01:06:32,480
and the next response so it's all there

1268
01:06:32,480 --> 01:06:34,079
it's all decrypted

1269
01:06:34,079 --> 01:06:37,039
ready for us to go

1270
01:06:38,400 --> 01:06:40,960
i wasn't necessarily planning on this at

1271
01:06:40,960 --> 01:06:43,680
this point but it feels like a natural

1272
01:06:43,680 --> 01:06:44,960
time to

1273
01:06:44,960 --> 01:06:47,359
take a look at it as well

1274
01:06:47,359 --> 01:06:50,319
you can also come under here under file

1275
01:06:50,319 --> 01:06:52,720
and export objects

1276
01:06:52,720 --> 01:06:55,200
and http

1277
01:06:55,200 --> 01:06:58,720
and it will pull out all of the

1278
01:06:58,720 --> 01:07:00,720
pieces of information

1279
01:07:00,720 --> 01:07:03,200
that were sent as an entire object so

1280
01:07:03,200 --> 01:07:04,960
like if there was a picture

1281
01:07:04,960 --> 01:07:07,680
sent over your http it'll be in this

1282
01:07:07,680 --> 01:07:10,400
list if there was a

1283
01:07:10,400 --> 01:07:12,799
json file sent it'll be in this list if

1284
01:07:12,799 --> 01:07:15,280
there was a javascript file it will be

1285
01:07:15,280 --> 01:07:17,359
in this list so you can just come in

1286
01:07:17,359 --> 01:07:21,119
here and export those bytes to their own

1287
01:07:21,119 --> 01:07:23,440
 to your file and then you have the

1288
01:07:23,440 --> 01:07:26,640
image that was sent or you have the

1289
01:07:26,640 --> 01:07:29,760
html file right and so you can

1290
01:07:29,760 --> 01:07:32,880
actually save those out as a file so if

1291
01:07:32,880 --> 01:07:33,839
i want to

1292
01:07:33,839 --> 01:07:36,000
save the sync con

1293
01:07:36,000 --> 01:07:38,960
fav icon image i i can do that i just

1294
01:07:38,960 --> 01:07:40,799
select it in the list

1295
01:07:40,799 --> 01:07:43,680
hit save

1296
01:07:43,680 --> 01:07:46,880
it'll ask me where i want to save it

1297
01:07:46,880 --> 01:07:50,319
and then i can pull it up here

1298
01:07:51,359 --> 01:07:53,039
and it just pulls it right out of the

1299
01:07:53,039 --> 01:07:55,280
packets that previously that was

1300
01:07:55,280 --> 01:07:58,640
encrypted now it's decrypted and able to

1301
01:07:58,640 --> 01:08:01,119
you know recognize it as the file that

1302
01:08:01,119 --> 01:08:03,839
was transferred

1303
01:08:05,680 --> 01:08:08,079
all right so other questions about

1304
01:08:08,079 --> 01:08:12,079
pos encryption and decryption

1305
01:08:31,839 --> 01:08:34,719
that's a great question i don't have one

1306
01:08:34,719 --> 01:08:36,839
in these capture files

1307
01:08:36,839 --> 01:08:38,479
um

1308
01:08:38,479 --> 01:08:39,679
i have

1309
01:08:39,679 --> 01:08:43,040
some logins depending on

1310
01:08:43,040 --> 01:08:44,880
i'm trying to think i don't think i have

1311
01:08:44,880 --> 01:08:47,920
any http login captures

1312
01:08:47,920 --> 01:08:51,198
i do have like some ftp login captures

1313
01:08:51,198 --> 01:08:53,679
in other capture files

1314
01:08:53,679 --> 01:08:58,279
but i don't have any in these ones

1315
01:09:07,520 --> 01:09:10,080
yeah great question uh so when you're

1316
01:09:10,080 --> 01:09:12,880
looking at that stream

1317
01:09:12,880 --> 01:09:17,319
where'd it go guess who closed it

1318
01:09:21,198 --> 01:09:24,960
we can follow our http stream

1319
01:09:24,960 --> 01:09:28,719
so the red is the request and the blue

1320
01:09:28,719 --> 01:09:31,839
is the response and down here

1321
01:09:31,839 --> 01:09:32,880
um

1322
01:09:32,880 --> 01:09:35,439
it shows

1323
01:09:35,439 --> 01:09:38,960
some details about the stream and it has

1324
01:09:38,960 --> 01:09:41,600
the word client and it puts that in red

1325
01:09:41,600 --> 01:09:43,759
to indicate everything in reds from the

1326
01:09:43,759 --> 01:09:46,080
client and then blue

1327
01:09:46,080 --> 01:09:48,238
server and puts it in blue and that can

1328
01:09:48,238 --> 01:09:49,120
help

1329
01:09:49,120 --> 01:09:51,920
it's the same not just with http traffic

1330
01:09:51,920 --> 01:09:53,279
you can follow

1331
01:09:53,279 --> 01:09:55,440
you know the tcp stream or whatever and

1332
01:09:55,440 --> 01:09:57,360
it'll use this same color coding and

1333
01:09:57,360 --> 01:10:00,400
provide that guide down at the bottom of

1334
01:10:00,400 --> 01:10:02,000
you know the client thread and the

1335
01:10:02,000 --> 01:10:03,920
server's blue

1336
01:10:03,920 --> 01:10:07,480
that's a good question

1337
01:10:16,239 --> 01:10:18,880
that is a good question uh the question

1338
01:10:18,880 --> 01:10:20,480
was you know can we decrypt other

1339
01:10:20,480 --> 01:10:21,920
protocols

1340
01:10:21,920 --> 01:10:24,080
um

1341
01:10:24,080 --> 01:10:27,120
i don't know the answer to that as far

1342
01:10:27,120 --> 01:10:29,760
as i've never tried to like decrypt ssh

1343
01:10:29,760 --> 01:10:31,920
traffic

1344
01:10:31,920 --> 01:10:35,440
on wireshark so it may be possible but i

1345
01:10:35,440 --> 01:10:38,599
don't know

1346
01:10:44,880 --> 01:10:47,199
okay

1347
01:10:55,440 --> 01:10:58,640
so let's talk about

1348
01:10:58,640 --> 01:11:00,480
we've we've figured out how to look at

1349
01:11:00,480 --> 01:11:02,560
the packets we've done some baselining

1350
01:11:02,560 --> 01:11:05,120
we've done you know decrypting all of

1351
01:11:05,120 --> 01:11:07,280
this is so that we can

1352
01:11:07,280 --> 01:11:09,920
examine in detail what's going on on our

1353
01:11:09,920 --> 01:11:11,120
networks

1354
01:11:11,120 --> 01:11:13,840
and so we're to the point where we need

1355
01:11:13,840 --> 01:11:15,920
to

1356
01:11:15,920 --> 01:11:17,760
find the needle that we're looking for

1357
01:11:17,760 --> 01:11:19,920
and we've got this haste deck of all of

1358
01:11:19,920 --> 01:11:23,120
our network traffic how do we pick out

1359
01:11:23,120 --> 01:11:25,600
in the millions of bytes flowing on our

1360
01:11:25,600 --> 01:11:27,840
wires the bytes that we are interested

1361
01:11:27,840 --> 01:11:28,640
in

1362
01:11:28,640 --> 01:11:30,719
and this is where wireshark can be

1363
01:11:30,719 --> 01:11:32,560
really powerful

1364
01:11:32,560 --> 01:11:34,480
you know we talked previously about you

1365
01:11:34,480 --> 01:11:36,560
know you can capture packets with tcp

1366
01:11:36,560 --> 01:11:37,760
dump or

1367
01:11:37,760 --> 01:11:40,560
you know other tools like that but

1368
01:11:40,560 --> 01:11:42,480
one of the benefits of wireshark is it

1369
01:11:42,480 --> 01:11:44,000
lets you

1370
01:11:44,000 --> 01:11:46,880
filter down and find exactly what you're

1371
01:11:46,880 --> 01:11:48,239
looking for

1372
01:11:48,239 --> 01:11:49,280
and so that's what we're going to talk

1373
01:11:49,280 --> 01:11:50,800
about next

1374
01:11:50,800 --> 01:11:52,159
is how to make

1375
01:11:52,159 --> 01:11:53,199
the

1376
01:11:53,199 --> 01:11:56,800
maximize our use of that

1377
01:11:56,800 --> 01:11:57,920
one thing

1378
01:11:57,920 --> 01:11:59,360
right off the bat

1379
01:11:59,360 --> 01:12:00,480
is

1380
01:12:00,480 --> 01:12:02,000
most of the time

1381
01:12:02,000 --> 01:12:04,080
when you're using wireshark you might

1382
01:12:04,080 --> 01:12:06,239
have different use cases

1383
01:12:06,239 --> 01:12:07,360
like

1384
01:12:07,360 --> 01:12:09,600
different things you're trying to find

1385
01:12:09,600 --> 01:12:10,400
so

1386
01:12:10,400 --> 01:12:12,159
in one case you might be troubleshooting

1387
01:12:12,159 --> 01:12:14,560
a problem why can't my computer talk to

1388
01:12:14,560 --> 01:12:16,800
my printer what's going on

1389
01:12:16,800 --> 01:12:18,960
that's going to be a very different kind

1390
01:12:18,960 --> 01:12:21,040
of traffic analysis

1391
01:12:21,040 --> 01:12:23,440
then trying to answer the question

1392
01:12:23,440 --> 01:12:24,320
um

1393
01:12:24,320 --> 01:12:26,640
is my network compromise right is

1394
01:12:26,640 --> 01:12:28,719
someone exfiltrating data out of my

1395
01:12:28,719 --> 01:12:30,640
network

1396
01:12:30,640 --> 01:12:32,960
is someone actively exploiting

1397
01:12:32,960 --> 01:12:35,679
heartbleed on my devices

1398
01:12:35,679 --> 01:12:38,560
those answering those questions requires

1399
01:12:38,560 --> 01:12:40,239
looking for different pieces of

1400
01:12:40,239 --> 01:12:42,320
information

1401
01:12:42,320 --> 01:12:44,400
so what i like to do when i'm using

1402
01:12:44,400 --> 01:12:47,679
wireshark is i like to set up profiles

1403
01:12:47,679 --> 01:12:50,239
and profiles are basically

1404
01:12:50,239 --> 01:12:52,960
fixed configurations or customizable

1405
01:12:52,960 --> 01:12:56,080
configurations for how wireshark works

1406
01:12:56,080 --> 01:12:58,080
some of the things you can customize are

1407
01:12:58,080 --> 01:13:00,080
you can customize what filters are

1408
01:13:00,080 --> 01:13:03,120
available we'll talk about these

1409
01:13:03,120 --> 01:13:04,560
you can customize

1410
01:13:04,560 --> 01:13:06,800
coloring rules so you might have noticed

1411
01:13:06,800 --> 01:13:08,880
as you're looking at these packets the

1412
01:13:08,880 --> 01:13:10,960
in the packet list some of them are blue

1413
01:13:10,960 --> 01:13:12,320
and some of them are green and some of

1414
01:13:12,320 --> 01:13:15,120
them are purple you can customize how it

1415
01:13:15,120 --> 01:13:16,640
colors those lists

1416
01:13:16,640 --> 01:13:18,719
you can customize which columns of data

1417
01:13:18,719 --> 01:13:20,080
you're looking at

1418
01:13:20,080 --> 01:13:22,560
and all of those can help you find the

1419
01:13:22,560 --> 01:13:24,560
information you're looking for

1420
01:13:24,560 --> 01:13:26,640
more efficiently

1421
01:13:26,640 --> 01:13:28,880
but which things are going to help

1422
01:13:28,880 --> 01:13:31,280
change based on what problem or question

1423
01:13:31,280 --> 01:13:33,360
you're trying to answer

1424
01:13:33,360 --> 01:13:35,920
so i set up a profile for the different

1425
01:13:35,920 --> 01:13:38,159
types of things i'm looking for and in

1426
01:13:38,159 --> 01:13:39,520
this case i'm just going to set up a

1427
01:13:39,520 --> 01:13:41,440
demo profile

1428
01:13:41,440 --> 01:13:43,199
and not you know i'm not looking for

1429
01:13:43,199 --> 01:13:46,599
anything specific

1430
01:13:47,040 --> 01:13:49,360
but it'll demonstrate how we can use

1431
01:13:49,360 --> 01:13:51,679
wireshark in that way

1432
01:13:51,679 --> 01:13:53,679
so under wireshark down here at the

1433
01:13:53,679 --> 01:13:56,080
bottom it lists the profile we're

1434
01:13:56,080 --> 01:13:58,080
currently using

1435
01:13:58,080 --> 01:14:00,159
you probably don't have this giant list

1436
01:14:00,159 --> 01:14:03,199
like i do um

1437
01:14:03,199 --> 01:14:05,840
because by default it comes with like a

1438
01:14:05,840 --> 01:14:07,840
default protocol and maybe a couple

1439
01:14:07,840 --> 01:14:10,000
others bluetooth and classic i think are

1440
01:14:10,000 --> 01:14:11,290
built in

1441
01:14:11,290 --> 01:14:12,880
[Music]

1442
01:14:12,880 --> 01:14:14,480
all of these others might be ones i

1443
01:14:14,480 --> 01:14:16,480
added

1444
01:14:16,480 --> 01:14:18,960
so as you uh

1445
01:14:18,960 --> 01:14:21,760
change profiles it might it'll change

1446
01:14:21,760 --> 01:14:24,880
different configurations that you have

1447
01:14:24,880 --> 01:14:26,480
so you can see

1448
01:14:26,480 --> 01:14:28,480
when i switched from

1449
01:14:28,480 --> 01:14:31,199
default to ftp and back it changed this

1450
01:14:31,199 --> 01:14:33,440
time field and what information was

1451
01:14:33,440 --> 01:14:36,239
displaying one of them my ftp

1452
01:14:36,239 --> 01:14:38,320
profile in this case is showing the

1453
01:14:38,320 --> 01:14:40,239
entire time stamp

1454
01:14:40,239 --> 01:14:42,880
whereas the default profile

1455
01:14:42,880 --> 01:14:44,400
is just showing

1456
01:14:44,400 --> 01:14:46,480
the relative

1457
01:14:46,480 --> 01:14:48,080
time of the

1458
01:14:48,080 --> 01:14:49,520
packet

1459
01:14:49,520 --> 01:14:51,040
and in fact i think it's showing the

1460
01:14:51,040 --> 01:14:54,800
relative time between packets

1461
01:14:55,120 --> 01:14:57,520
so how do you create your own profile so

1462
01:14:57,520 --> 01:14:59,520
that you can start customizing what the

1463
01:14:59,520 --> 01:15:01,520
time field looks like or which fields

1464
01:15:01,520 --> 01:15:04,480
are in this list or what protocol

1465
01:15:04,480 --> 01:15:05,600
filters

1466
01:15:05,600 --> 01:15:06,480
are

1467
01:15:06,480 --> 01:15:09,280
saved and ready for quick access

1468
01:15:09,280 --> 01:15:10,880
the way you do that

1469
01:15:10,880 --> 01:15:13,840
is right clicking on the profile

1470
01:15:13,840 --> 01:15:17,440
and choosing manage profiles

1471
01:15:18,159 --> 01:15:19,280
just making sure you couldn't do it the

1472
01:15:19,280 --> 01:15:21,440
other way yep so right click

1473
01:15:21,440 --> 01:15:23,360
and manage profiles or you can just

1474
01:15:23,360 --> 01:15:25,040
directly go to new

1475
01:15:25,040 --> 01:15:26,400
i like

1476
01:15:26,400 --> 01:15:28,159
manage because it gives you a little

1477
01:15:28,159 --> 01:15:30,159
more control

1478
01:15:30,159 --> 01:15:32,080
and you can

1479
01:15:32,080 --> 01:15:35,120
choose an existing profile to duplicate

1480
01:15:35,120 --> 01:15:36,800
or make a copy of

1481
01:15:36,800 --> 01:15:38,480
and work from that

1482
01:15:38,480 --> 01:15:41,440
or you can just add a brand new proto

1483
01:15:41,440 --> 01:15:43,280
call or profile

1484
01:15:43,280 --> 01:15:44,880
so i'm going to start with the default

1485
01:15:44,880 --> 01:15:46,080
profile

1486
01:15:46,080 --> 01:15:48,320
and i'm just going to

1487
01:15:48,320 --> 01:15:49,840
copy that one

1488
01:15:49,840 --> 01:15:51,280
and i'll name it

1489
01:15:51,280 --> 01:15:53,679
demo right because it's for my

1490
01:15:53,679 --> 01:15:56,640
this demo purpose

1491
01:15:57,840 --> 01:16:00,080
and

1492
01:16:00,080 --> 01:16:01,360
click ok

1493
01:16:01,360 --> 01:16:03,520
and it should switch over to the demo

1494
01:16:03,520 --> 01:16:04,640
profile

1495
01:16:04,640 --> 01:16:07,120
and it'll have the exact same settings

1496
01:16:07,120 --> 01:16:09,360
as my default profile because i

1497
01:16:09,360 --> 01:16:11,199
duplicated that one

1498
01:16:11,199 --> 01:16:13,760
now i can start customizing it and i can

1499
01:16:13,760 --> 01:16:15,360
start

1500
01:16:15,360 --> 01:16:16,560
changing

1501
01:16:16,560 --> 01:16:18,480
what the time field looks like changing

1502
01:16:18,480 --> 01:16:21,839
these fields adding

1503
01:16:22,000 --> 01:16:23,920
filters that are saved

1504
01:16:23,920 --> 01:16:26,480
and so that's

1505
01:16:27,840 --> 01:16:29,199
well i'll pause for a minute make sure

1506
01:16:29,199 --> 01:16:30,880
that you've got your profile and then

1507
01:16:30,880 --> 01:16:33,040
we'll go about creating some of these

1508
01:16:33,040 --> 01:16:35,199
customizations to our profile

1509
01:16:35,199 --> 01:16:36,960
is everyone able to create their own

1510
01:16:36,960 --> 01:16:40,560
profile to start working from

1511
01:16:40,880 --> 01:16:42,800
okay i did find out that there's some

1512
01:16:42,800 --> 01:16:45,120
small differences between like wireshark

1513
01:16:45,120 --> 01:16:48,000
on windows and wireshark on a mac so if

1514
01:16:48,000 --> 01:16:50,159
you had to look somewhere else

1515
01:16:50,159 --> 01:16:53,599
looks like everyone's found it though

1516
01:16:53,840 --> 01:16:56,800
um okay

1517
01:17:00,560 --> 01:17:03,520
yeah right click right and

1518
01:17:03,520 --> 01:17:07,520
manage your new or edit right

1519
01:17:08,719 --> 01:17:10,480
so i want to

1520
01:17:10,480 --> 01:17:13,879
make some customizations

1521
01:17:15,040 --> 01:17:18,320
you can customize what capture filters

1522
01:17:18,320 --> 01:17:20,159
like you can save capture filters i'm

1523
01:17:20,159 --> 01:17:22,159
not going to talk about those and the

1524
01:17:22,159 --> 01:17:23,760
reason i'm not really going to talk

1525
01:17:23,760 --> 01:17:27,440
about those is because i hardly ever use

1526
01:17:27,440 --> 01:17:28,840
capture

1527
01:17:28,840 --> 01:17:31,760
filters so capture filter

1528
01:17:31,760 --> 01:17:32,960
is

1529
01:17:32,960 --> 01:17:35,040
good for a couple reasons

1530
01:17:35,040 --> 01:17:37,280
it's going to be more efficient in your

1531
01:17:37,280 --> 01:17:40,320
capture if you've got a lot of traffic

1532
01:17:40,320 --> 01:17:41,920
on your device that you're capturing

1533
01:17:41,920 --> 01:17:43,760
from then you might want to use a

1534
01:17:43,760 --> 01:17:46,159
capture filter and say i don't need to

1535
01:17:46,159 --> 01:17:48,960
be capturing all of this traffic i only

1536
01:17:48,960 --> 01:17:52,320
need the http traffic or i only need

1537
01:17:52,320 --> 01:17:55,120
traffic from this host and in that case

1538
01:17:55,120 --> 01:17:57,600
you can set up a capture filter to limit

1539
01:17:57,600 --> 01:17:59,679
what even gets saved to your capture

1540
01:17:59,679 --> 01:18:01,679
file

1541
01:18:01,679 --> 01:18:06,239
the reason i hardly ever use capture

1542
01:18:06,239 --> 01:18:09,199
filters is because

1543
01:18:09,199 --> 01:18:12,400
once that's filtered out it's

1544
01:18:12,400 --> 01:18:15,120
filtered out at the capture process it's

1545
01:18:15,120 --> 01:18:18,000
gone right it's not available in your

1546
01:18:18,000 --> 01:18:19,840
capture file because it never

1547
01:18:19,840 --> 01:18:21,679
made it into the capture file to begin

1548
01:18:21,679 --> 01:18:23,360
with wireshark ignored it and said oh

1549
01:18:23,360 --> 01:18:24,880
that packet's not for me oh that

1550
01:18:24,880 --> 01:18:27,040
packet's not for me and it didn't even

1551
01:18:27,040 --> 01:18:29,199
save it into your capture file

1552
01:18:29,199 --> 01:18:30,239
so

1553
01:18:30,239 --> 01:18:31,840
if you know exactly what you're looking

1554
01:18:31,840 --> 01:18:35,360
for or if you specifically need to limit

1555
01:18:35,360 --> 01:18:37,360
i can only capture traffic from these

1556
01:18:37,360 --> 01:18:39,120
hosts because i don't have control over

1557
01:18:39,120 --> 01:18:41,199
these other hosts and those are the

1558
01:18:41,199 --> 01:18:43,120
times where a capture filter will be

1559
01:18:43,120 --> 01:18:44,640
useful

1560
01:18:44,640 --> 01:18:46,560
otherwise

1561
01:18:46,560 --> 01:18:47,440
i

1562
01:18:47,440 --> 01:18:50,400
generally stay away from them

1563
01:18:50,400 --> 01:18:53,440
instead i like to use display filters

1564
01:18:53,440 --> 01:18:56,400
and i use display filters all the time

1565
01:18:56,400 --> 01:18:58,159
every time i'm in wireshark i'm using

1566
01:18:58,159 --> 01:19:00,480
display filters we've already used a ton

1567
01:19:00,480 --> 01:19:02,000
of display filters as we've been going

1568
01:19:02,000 --> 01:19:03,199
through the talk

1569
01:19:03,199 --> 01:19:05,840
so display filters they limit what is

1570
01:19:05,840 --> 01:19:08,080
seen and everything is still captured

1571
01:19:08,080 --> 01:19:10,320
and everything's still in that file but

1572
01:19:10,320 --> 01:19:12,400
it only presents you

1573
01:19:12,400 --> 01:19:15,120
what makes it through the filter

1574
01:19:15,120 --> 01:19:16,960
and so it's great for focusing in on

1575
01:19:16,960 --> 01:19:19,360
details for ignoring everything that's

1576
01:19:19,360 --> 01:19:21,120
not important right now for what you're

1577
01:19:21,120 --> 01:19:23,120
looking at but it doesn't

1578
01:19:23,120 --> 01:19:25,440
discard discard that other information

1579
01:19:25,440 --> 01:19:27,120
so if you later need to go and look at

1580
01:19:27,120 --> 01:19:29,120
some other packet it's still there and

1581
01:19:29,120 --> 01:19:30,719
available and you just change your

1582
01:19:30,719 --> 01:19:34,239
display filter and you can see it again

1583
01:19:34,239 --> 01:19:36,480
it doesn't give you any efficiency boost

1584
01:19:36,480 --> 01:19:38,480
in terms of like the size of your file

1585
01:19:38,480 --> 01:19:40,000
because it's still going to be the same

1586
01:19:40,000 --> 01:19:42,320
size file right it's all still there

1587
01:19:42,320 --> 01:19:43,840
um

1588
01:19:43,840 --> 01:19:49,320
but i use these like i said all the time

1589
01:19:50,320 --> 01:19:52,560
so let's take a look at

1590
01:19:52,560 --> 01:19:54,640
using some of these display filters

1591
01:19:54,640 --> 01:19:57,520
we've used them we filtered for http

1592
01:19:57,520 --> 01:19:58,640
traffic

1593
01:19:58,640 --> 01:20:00,719
that's a a basic

1594
01:20:00,719 --> 01:20:02,800
display filter

1595
01:20:02,800 --> 01:20:04,400
it's a common

1596
01:20:04,400 --> 01:20:06,719
way to start with your filtering is say

1597
01:20:06,719 --> 01:20:08,159
i don't know exactly what i'm looking

1598
01:20:08,159 --> 01:20:09,679
for but i know it's

1599
01:20:09,679 --> 01:20:12,639
ssh traffic or i know it's http traffic

1600
01:20:12,639 --> 01:20:15,199
or i know it's arp traffic

1601
01:20:15,199 --> 01:20:18,000
and so pretty much every protocol you

1602
01:20:18,000 --> 01:20:19,280
can filter

1603
01:20:19,280 --> 01:20:21,920
by using wireshark's name for that

1604
01:20:21,920 --> 01:20:23,600
protocol and so if i want to see all of

1605
01:20:23,600 --> 01:20:26,719
the arp packets i can just arp put it in

1606
01:20:26,719 --> 01:20:30,159
my filter bar hit go and it's ready to

1607
01:20:30,159 --> 01:20:31,920
and it filters out and only shows me

1608
01:20:31,920 --> 01:20:34,159
those packets

1609
01:20:34,159 --> 01:20:35,679
tls

1610
01:20:35,679 --> 01:20:36,719
any

1611
01:20:36,719 --> 01:20:38,480
pretty much any protocol wireshark can

1612
01:20:38,480 --> 01:20:40,639
handle you can filter and say just show

1613
01:20:40,639 --> 01:20:44,239
me packets that are involved with those

1614
01:20:44,840 --> 01:20:47,120
protocols now when you're creating

1615
01:20:47,120 --> 01:20:49,440
custom profiles

1616
01:20:49,440 --> 01:20:51,280
you can save some time

1617
01:20:51,280 --> 01:20:53,360
and not have to type all that out by

1618
01:20:53,360 --> 01:20:54,400
creating

1619
01:20:54,400 --> 01:20:58,480
bookmarks and shortcuts for these

1620
01:20:58,480 --> 01:21:01,760
filters wireshark remembers your recent

1621
01:21:01,760 --> 01:21:03,199
filters

1622
01:21:03,199 --> 01:21:05,360
which is great

1623
01:21:05,360 --> 01:21:07,199
but it also has

1624
01:21:07,199 --> 01:21:08,960
these little bookmarks

1625
01:21:08,960 --> 01:21:11,679
and you can save filters it has a few

1626
01:21:11,679 --> 01:21:13,120
built in

1627
01:21:13,120 --> 01:21:15,199
to start with you can go in and clean

1628
01:21:15,199 --> 01:21:18,000
those up delete them edit them

1629
01:21:18,000 --> 01:21:20,080
whatever add new ones which is what

1630
01:21:20,080 --> 01:21:22,159
we're looking at here

1631
01:21:22,159 --> 01:21:23,679
so if you have

1632
01:21:23,679 --> 01:21:25,120
a filter

1633
01:21:25,120 --> 01:21:27,040
in your filter bar and you're like hey

1634
01:21:27,040 --> 01:21:29,040
this is a useful one i want this in my

1635
01:21:29,040 --> 01:21:31,520
profile i want it so i can just click

1636
01:21:31,520 --> 01:21:32,960
and it's there

1637
01:21:32,960 --> 01:21:35,840
you can save it

1638
01:21:38,880 --> 01:21:41,199
it'll add it to the list here's the

1639
01:21:41,199 --> 01:21:42,560
expression

1640
01:21:42,560 --> 01:21:44,639
and here's the display name and i'm

1641
01:21:44,639 --> 01:21:47,280
going to change that display name to

1642
01:21:47,280 --> 01:21:49,840
tos

1643
01:21:51,360 --> 01:21:53,600
while i'm in here i can look at this

1644
01:21:53,600 --> 01:21:56,320
list and say

1645
01:21:56,320 --> 01:21:59,199
you know in this demo filter

1646
01:21:59,199 --> 01:22:01,760
i don't want a filter that

1647
01:22:01,760 --> 01:22:04,600
only looks at ip address

1648
01:22:04,600 --> 01:22:07,520
192.0.2.1 that one's not useful to me so

1649
01:22:07,520 --> 01:22:08,960
i'm just going to remove that one from

1650
01:22:08,960 --> 01:22:09,920
the list

1651
01:22:09,920 --> 01:22:12,400
and you can edit those bookmarked

1652
01:22:12,400 --> 01:22:15,040
filters and make them

1653
01:22:15,040 --> 01:22:17,679
exactly what you need for the traffic

1654
01:22:17,679 --> 01:22:20,560
that you're trying to look at

1655
01:22:20,560 --> 01:22:22,960
okay so that's one place

1656
01:22:22,960 --> 01:22:25,840
you can uh save filters is here in the

1657
01:22:25,840 --> 01:22:28,719
bookmark whoops i hit cancel rather than

1658
01:22:28,719 --> 01:22:31,120
okay

1659
01:22:35,920 --> 01:22:37,360
so hit okay

1660
01:22:37,360 --> 01:22:38,880
now it's changed to

1661
01:22:38,880 --> 01:22:40,639
yellow indicating that it's a custom

1662
01:22:40,639 --> 01:22:43,440
list and it's got tls in our list oh

1663
01:22:43,440 --> 01:22:45,760
actually i think it was yellow because

1664
01:22:45,760 --> 01:22:50,199
it was applying one from the list

1665
01:22:54,560 --> 01:22:57,440
and they're there ready to go

1666
01:22:57,440 --> 01:22:59,520
other places you can

1667
01:22:59,520 --> 01:23:02,159
put those filters you can have a button

1668
01:23:02,159 --> 01:23:03,920
so i've got a button here that applies

1669
01:23:03,920 --> 01:23:07,199
the tcp filter i can click the little

1670
01:23:07,199 --> 01:23:09,199
plus button

1671
01:23:09,199 --> 01:23:10,480
and add

1672
01:23:10,480 --> 01:23:13,040
a new button a new filter

1673
01:23:13,040 --> 01:23:15,280
here's the name of the button

1674
01:23:15,280 --> 01:23:19,040
maybe i want an http button

1675
01:23:19,199 --> 01:23:20,480
http

1676
01:23:20,480 --> 01:23:22,159
is the filter i'll use

1677
01:23:22,159 --> 01:23:25,199
i don't need a comment

1678
01:23:25,199 --> 01:23:27,440
click ok and it adds a little button

1679
01:23:27,440 --> 01:23:30,719
here for easy access to the filter

1680
01:23:30,719 --> 01:23:33,719
okay

1681
01:23:40,400 --> 01:23:43,840
for more advanced filters

1682
01:23:43,840 --> 01:23:46,880
it can be difficult to know what to put

1683
01:23:46,880 --> 01:23:49,920
in our filter bar like we can guess the

1684
01:23:49,920 --> 01:23:52,400
protocol name a lot sometimes

1685
01:23:52,400 --> 01:23:54,719
they're fairly

1686
01:23:54,719 --> 01:23:57,199
common abbreviations but if i want a

1687
01:23:57,199 --> 01:24:00,480
specific filter like the source port

1688
01:24:00,480 --> 01:24:03,040
that tcp is using well that's a little

1689
01:24:03,040 --> 01:24:05,520
bit trickier how do i put that into a

1690
01:24:05,520 --> 01:24:07,199
filter

1691
01:24:07,199 --> 01:24:09,520
there's some options to help you you can

1692
01:24:09,520 --> 01:24:12,000
freeform type it and as you do that

1693
01:24:12,000 --> 01:24:14,320
it'll sort of auto-complete or bring you

1694
01:24:14,320 --> 01:24:17,120
a list up of options so i would say oh

1695
01:24:17,120 --> 01:24:19,920
well tcp port that's getting closer to

1696
01:24:19,920 --> 01:24:23,760
what i want but i actually

1697
01:24:24,000 --> 01:24:27,679
i said i wanted the source port

1698
01:24:28,800 --> 01:24:30,400
and so

1699
01:24:30,400 --> 01:24:32,239
you start typing and it'll come up and

1700
01:24:32,239 --> 01:24:35,760
oh there's our source port filter

1701
01:24:35,760 --> 01:24:38,560
now i know exactly what name it has

1702
01:24:38,560 --> 01:24:40,320
and i want

1703
01:24:40,320 --> 01:24:43,600
cases where the source port was port 80.

1704
01:24:43,600 --> 01:24:46,560
and it'll limit to now packets in this

1705
01:24:46,560 --> 01:24:47,520
list

1706
01:24:47,520 --> 01:24:49,920
are the ones that have a source port of

1707
01:24:49,920 --> 01:24:50,880
80.

1708
01:24:50,880 --> 01:24:52,080
and as we

1709
01:24:52,080 --> 01:24:53,600
scroll through the list

1710
01:24:53,600 --> 01:24:55,920
we can see all the details they all have

1711
01:24:55,920 --> 01:24:57,920
source port of 80. because that's what

1712
01:24:57,920 --> 01:25:00,880
we limited our filter to

1713
01:25:00,880 --> 01:25:03,360
so you can type them free form

1714
01:25:03,360 --> 01:25:07,519
but that's kind of tricky to get right

1715
01:25:08,000 --> 01:25:10,560
you can also

1716
01:25:10,560 --> 01:25:14,480
go into the expression builder

1717
01:25:14,800 --> 01:25:16,719
i hardly ever use the expression builder

1718
01:25:16,719 --> 01:25:20,840
now i can't remember where it is

1719
01:25:29,520 --> 01:25:31,520
that was our list in the bookmarks i

1720
01:25:31,520 --> 01:25:34,239
think it's this one

1721
01:25:37,120 --> 01:25:38,480
started to come up

1722
01:25:38,480 --> 01:25:43,600
yeah so display filter expression under

1723
01:25:43,600 --> 01:25:44,880
analyze

1724
01:25:44,880 --> 01:25:48,080
display filter expression

1725
01:25:48,080 --> 01:25:49,920
this lets you

1726
01:25:49,920 --> 01:25:51,440
choose

1727
01:25:51,440 --> 01:25:53,600
from all the different fields

1728
01:25:53,600 --> 01:25:56,239
and build your expression and so you

1729
01:25:56,239 --> 01:25:58,239
don't have to know

1730
01:25:58,239 --> 01:26:00,080
the name you just have to be able to

1731
01:26:00,080 --> 01:26:01,360
find the name

1732
01:26:01,360 --> 01:26:03,679
say okay i'm looking for

1733
01:26:03,679 --> 01:26:06,159
an expression using

1734
01:26:06,159 --> 01:26:07,840
ll

1735
01:26:07,840 --> 01:26:10,719
right and maybe i care about

1736
01:26:10,719 --> 01:26:13,920
you know some specific field here

1737
01:26:13,920 --> 01:26:16,239
and you can choose that out

1738
01:26:16,239 --> 01:26:17,280
and then

1739
01:26:17,280 --> 01:26:18,159
say

1740
01:26:18,159 --> 01:26:20,480
that field has to be present you can say

1741
01:26:20,480 --> 01:26:22,400
it's equal to a certain value greater

1742
01:26:22,400 --> 01:26:24,000
than less than

1743
01:26:24,000 --> 01:26:25,760
right so you have all those options and

1744
01:26:25,760 --> 01:26:27,520
you can build it out here and if you

1745
01:26:27,520 --> 01:26:30,159
build it incorrectly

1746
01:26:30,159 --> 01:26:33,679
it highlights it in red

1747
01:26:34,000 --> 01:26:36,880
and when you get a valid expression then

1748
01:26:36,880 --> 01:26:38,400
it turns it to

1749
01:26:38,400 --> 01:26:40,080
green

1750
01:26:40,080 --> 01:26:42,639
you can search for specific fields

1751
01:26:42,639 --> 01:26:44,639
here which can be useful in trying to

1752
01:26:44,639 --> 01:26:46,639
find what you're looking for

1753
01:26:46,639 --> 01:26:50,880
and again can be an option for

1754
01:26:50,880 --> 01:26:53,840
creating these filters

1755
01:26:53,840 --> 01:26:56,159
you heard me say i hardly ever use it

1756
01:26:56,159 --> 01:26:57,760
which seems odd because it's kind of

1757
01:26:57,760 --> 01:26:58,719
powerful

1758
01:26:58,719 --> 01:27:01,199
but the reason i hardly ever use it

1759
01:27:01,199 --> 01:27:02,400
is because

1760
01:27:02,400 --> 01:27:04,639
i'm more powerful to me

1761
01:27:04,639 --> 01:27:08,800
way of doing it is in our packet details

1762
01:27:08,800 --> 01:27:11,920
anything i can find in my packet details

1763
01:27:11,920 --> 01:27:13,520
i can filter on

1764
01:27:13,520 --> 01:27:15,040
and so if i

1765
01:27:15,040 --> 01:27:18,080
can find one example of it then i can

1766
01:27:18,080 --> 01:27:21,360
create a filter from it

1767
01:27:21,360 --> 01:27:24,000
so i'm going to

1768
01:27:24,000 --> 01:27:25,760
do a quick example we did the source

1769
01:27:25,760 --> 01:27:28,400
port on tcp if i wanted to filter on the

1770
01:27:28,400 --> 01:27:33,120
destination port i just find that in my

1771
01:27:33,120 --> 01:27:34,719
details list

1772
01:27:34,719 --> 01:27:36,560
right click on it

1773
01:27:36,560 --> 01:27:38,719
and there's options to either directly

1774
01:27:38,719 --> 01:27:40,560
apply it as a filter

1775
01:27:40,560 --> 01:27:43,360
or prepare it as a filter which will put

1776
01:27:43,360 --> 01:27:45,120
it into the filter bar but won't

1777
01:27:45,120 --> 01:27:47,120
actually run the filter until we've had

1778
01:27:47,120 --> 01:27:50,000
a chance to make any modifications and

1779
01:27:50,000 --> 01:27:52,159
hit go on it

1780
01:27:52,159 --> 01:27:54,080
so if it's exactly what i want and i

1781
01:27:54,080 --> 01:27:55,199
want to

1782
01:27:55,199 --> 01:27:56,480
filter for

1783
01:27:56,480 --> 01:27:58,840
cases where the destination port is that

1784
01:27:58,840 --> 01:28:00,480
value

1785
01:28:00,480 --> 01:28:01,679
right click

1786
01:28:01,679 --> 01:28:03,440
apply as filter

1787
01:28:03,440 --> 01:28:06,080
selected

1788
01:28:06,400 --> 01:28:08,400
and it adds it in there if it's not

1789
01:28:08,400 --> 01:28:11,040
quite what i want but it's close enough

1790
01:28:11,040 --> 01:28:14,239
then i just do a prepare as filter hit

1791
01:28:14,239 --> 01:28:15,920
selected and say oh maybe what i

1792
01:28:15,920 --> 01:28:17,920
actually wanted was i wanted to find

1793
01:28:17,920 --> 01:28:18,960
everything

1794
01:28:18,960 --> 01:28:20,159
that was

1795
01:28:20,159 --> 01:28:21,760
um

1796
01:28:21,760 --> 01:28:25,040
greater than that value

1797
01:28:25,040 --> 01:28:27,199
and i can go in there and adjust it

1798
01:28:27,199 --> 01:28:28,560
and hit go

1799
01:28:28,560 --> 01:28:30,719
okay so that's how

1800
01:28:30,719 --> 01:28:33,600
probably like 95 of the time when i'm

1801
01:28:33,600 --> 01:28:35,920
applying filters that's how i usually do

1802
01:28:35,920 --> 01:28:38,239
it is i'll find a value that's close to

1803
01:28:38,239 --> 01:28:40,159
what i'm looking for apply it as a

1804
01:28:40,159 --> 01:28:43,360
filter modify it if needed

1805
01:28:43,360 --> 01:28:45,600
okay

1806
01:28:45,600 --> 01:28:47,679
so lots of ways to do filtering and to

1807
01:28:47,679 --> 01:28:50,719
save those filters

1808
01:28:50,960 --> 01:28:54,639
we covered most of those looks like

1809
01:28:54,639 --> 01:28:56,560
let's do some practice

1810
01:28:56,560 --> 01:29:00,000
pull up your baseline capture file

1811
01:29:00,000 --> 01:29:01,120
and

1812
01:29:01,120 --> 01:29:02,320
go through it

1813
01:29:02,320 --> 01:29:04,080
use filters you don't have to use

1814
01:29:04,080 --> 01:29:05,920
filters but it's easier right drill down

1815
01:29:05,920 --> 01:29:07,600
to the information you're looking for

1816
01:29:07,600 --> 01:29:10,880
and try and answer these questions

1817
01:29:10,880 --> 01:29:12,719
so what's

1818
01:29:12,719 --> 01:29:14,960
what device which i p address is the

1819
01:29:14,960 --> 01:29:16,719
host

1820
01:29:16,719 --> 01:29:19,360
of an ssh server

1821
01:29:19,360 --> 01:29:22,239
what udp protocols are being used

1822
01:29:22,239 --> 01:29:25,280
and which ip address is associated with

1823
01:29:25,280 --> 01:29:27,679
this specific mac address now if you

1824
01:29:27,679 --> 01:29:29,360
don't know how to answer those questions

1825
01:29:29,360 --> 01:29:32,239
because you don't know what protocol

1826
01:29:32,239 --> 01:29:34,320
is going to help you find those answers

1827
01:29:34,320 --> 01:29:36,320
that's okay i'll be around to help and

1828
01:29:36,320 --> 01:29:38,159
we'll demonstrate and talk about it up

1829
01:29:38,159 --> 01:29:39,920
here up front as well

1830
01:29:39,920 --> 01:29:42,920
okay

1831
01:35:30,960 --> 01:35:32,000
okay

1832
01:35:32,000 --> 01:35:35,199
so what'd you guys find uh which

1833
01:35:35,199 --> 01:35:36,400
host

1834
01:35:36,400 --> 01:35:38,159
or and or there could be more than one

1835
01:35:38,159 --> 01:35:41,760
but is a ssh server in our baseline pcap

1836
01:35:41,760 --> 01:35:44,159
file

1837
01:35:48,880 --> 01:35:52,000
okay the 3.1 address and how did you

1838
01:35:52,000 --> 01:35:55,880
arrive at that information

1839
01:36:17,920 --> 01:36:18,800
okay

1840
01:36:18,800 --> 01:36:20,480
perfect so

1841
01:36:20,480 --> 01:36:22,080
uh

1842
01:36:22,080 --> 01:36:24,880
use knowledge of the ssh protocol and

1843
01:36:24,880 --> 01:36:26,960
said oh well typically we'll find that

1844
01:36:26,960 --> 01:36:30,320
using port 22. and so you filtered for

1845
01:36:30,320 --> 01:36:33,600
traffic on port 22.

1846
01:36:33,600 --> 01:36:35,280
and then

1847
01:36:35,280 --> 01:36:38,080
saw that

1848
01:36:38,080 --> 01:36:40,000
one did you look at you saw the right a

1849
01:36:40,000 --> 01:36:42,719
request came from 34

1850
01:36:42,719 --> 01:36:45,040
to 3.1

1851
01:36:45,040 --> 01:36:47,199
and then later on you can see

1852
01:36:47,199 --> 01:36:49,280
right the 3.1

1853
01:36:49,280 --> 01:36:51,760
is identified as the server right sends

1854
01:36:51,760 --> 01:36:53,840
back a response

1855
01:36:53,840 --> 01:36:56,480
client sends the request

1856
01:36:56,480 --> 01:36:57,760
okay

1857
01:36:57,760 --> 01:37:01,679
good so yeah i agree the 3.1

1858
01:37:01,679 --> 01:37:03,440
is the server

1859
01:37:03,440 --> 01:37:06,000
in this instance

1860
01:37:06,000 --> 01:37:08,800
someone else come to the same conclusion

1861
01:37:08,800 --> 01:37:12,760
but using a different approach

1862
01:37:21,760 --> 01:37:22,719
perfect

1863
01:37:22,719 --> 01:37:23,679
so

1864
01:37:23,679 --> 01:37:27,600
did did you filter first or

1865
01:37:27,600 --> 01:37:31,600
okay yep so i did a filter for the ssh

1866
01:37:31,600 --> 01:37:33,520
protocol

1867
01:37:33,520 --> 01:37:36,400
and then over here in the info

1868
01:37:36,400 --> 01:37:39,519
you saw that it was

1869
01:37:44,159 --> 01:37:45,360
yeah

1870
01:37:45,360 --> 01:37:46,639
and then you see

1871
01:37:46,639 --> 01:37:48,560
these are all the clients right this is

1872
01:37:48,560 --> 01:37:52,560
the server it's the one sending the keys

1873
01:37:52,560 --> 01:37:54,480
yep here's right it actually sending

1874
01:37:54,480 --> 01:37:55,360
that

1875
01:37:55,360 --> 01:37:57,440
exchange reply

1876
01:37:57,440 --> 01:38:00,480
and the 3.1 right

1877
01:38:00,480 --> 01:38:02,639
good and there is no cheating

1878
01:38:02,639 --> 01:38:04,639
if you get the information that's the

1879
01:38:04,639 --> 01:38:06,719
goal the easier you can get it the

1880
01:38:06,719 --> 01:38:09,040
better

1881
01:38:10,000 --> 01:38:12,159
okay so let's take a look what were some

1882
01:38:12,159 --> 01:38:14,840
of the other questions we were trying to

1883
01:38:14,840 --> 01:38:18,480
answer uh udp protocols what udp

1884
01:38:18,480 --> 01:38:22,560
protocols are used in this capture file

1885
01:38:22,560 --> 01:38:25,360
dhcp

1886
01:38:25,360 --> 01:38:28,000
dns

1887
01:38:28,159 --> 01:38:31,839
multicast dns

1888
01:38:32,239 --> 01:38:34,799
is that it

1889
01:38:36,639 --> 01:38:40,719
okay how did you find that information

1890
01:38:43,199 --> 01:38:46,159
okay yeah so one thing we can do

1891
01:38:46,159 --> 01:38:48,000
protocol hierarchy

1892
01:38:48,000 --> 01:38:49,760
look at our

1893
01:38:49,760 --> 01:38:52,719
statistics here

1894
01:38:55,360 --> 01:38:56,320
oh

1895
01:38:56,320 --> 01:38:59,360
crashed shark

1896
01:38:59,679 --> 01:39:03,119
had too much open probably

1897
01:39:10,960 --> 01:39:12,880
all right let's bring our baseline back

1898
01:39:12,880 --> 01:39:15,040
up

1899
01:39:18,639 --> 01:39:22,400
check the protocol hierarchy

1900
01:39:22,639 --> 01:39:25,600
under udp

1901
01:39:25,600 --> 01:39:29,480
some mdns multicast dns

1902
01:39:29,480 --> 01:39:32,080
dhcp and dns

1903
01:39:32,080 --> 01:39:34,960
those the ones you guys listed right

1904
01:39:34,960 --> 01:39:37,040
anyone else get the same information a

1905
01:39:37,040 --> 01:39:40,360
different way

1906
01:39:43,920 --> 01:39:46,320
perfect right so we can filter and say

1907
01:39:46,320 --> 01:39:49,920
hey all i want to see is udp traffic

1908
01:39:49,920 --> 01:39:52,880
and i've got this protocol column i can

1909
01:39:52,880 --> 01:39:54,480
just scroll through

1910
01:39:54,480 --> 01:39:57,119
and check them off

1911
01:39:57,119 --> 01:39:59,360
good

1912
01:39:59,440 --> 01:40:01,199
lots of ways to find the information

1913
01:40:01,199 --> 01:40:03,440
okay

1914
01:40:03,920 --> 01:40:06,400
one thing

1915
01:40:07,199 --> 01:40:09,679
oh yeah someone was asking about this

1916
01:40:09,679 --> 01:40:11,920
earlier i think maybe they already left

1917
01:40:11,920 --> 01:40:13,760
but they're asked about you know can we

1918
01:40:13,760 --> 01:40:16,560
see statistics over a certain time

1919
01:40:16,560 --> 01:40:18,320
period

1920
01:40:18,320 --> 01:40:19,199
or

1921
01:40:19,199 --> 01:40:21,440
on a subset of our packets

1922
01:40:21,440 --> 01:40:23,280
so our i o graph

1923
01:40:23,280 --> 01:40:26,159
lets us do that and we can choose if

1924
01:40:26,159 --> 01:40:29,280
it's applying the filter or not

1925
01:40:29,280 --> 01:40:31,280
on our graph

1926
01:40:31,280 --> 01:40:34,080
and so that can be

1927
01:40:34,560 --> 01:40:36,880
useful there so this is under our

1928
01:40:36,880 --> 01:40:39,440
statistics as well

1929
01:40:39,440 --> 01:40:42,719
and then the io graphs

1930
01:40:43,280 --> 01:40:46,400
and you can add

1931
01:40:48,840 --> 01:40:52,000
additional filters and each filter can

1932
01:40:52,000 --> 01:40:53,440
be its own

1933
01:40:53,440 --> 01:40:56,638
chart in the graph

1934
01:41:03,199 --> 01:41:05,520
last question which ip address is

1935
01:41:05,520 --> 01:41:07,440
associated with the particular mac

1936
01:41:07,440 --> 01:41:10,559
address listed here

1937
01:41:11,679 --> 01:41:14,960
okay the ssh server

1938
01:41:14,960 --> 01:41:19,480
is that what everyone else got

1939
01:41:21,199 --> 01:41:23,520
yes no

1940
01:41:23,520 --> 01:41:27,360
or we didn't get that

1941
01:41:27,440 --> 01:41:29,678
okay

1942
01:41:30,000 --> 01:41:32,400
so let's see if we can

1943
01:41:32,400 --> 01:41:34,639
figure out

1944
01:41:34,639 --> 01:41:37,440
what's going on here

1945
01:41:37,440 --> 01:41:39,440
what was your approach for

1946
01:41:39,440 --> 01:41:43,159
matching those up

1947
01:41:46,560 --> 01:41:51,119
okay so we can filter for a particular

1948
01:41:51,119 --> 01:41:52,880
youth address

1949
01:41:52,880 --> 01:41:55,760
and in this case we want

1950
01:41:55,760 --> 01:41:59,080
this one

1951
01:42:09,679 --> 01:42:11,600
okay

1952
01:42:11,600 --> 01:42:15,679
and then right we see here both those

1953
01:42:15,679 --> 01:42:17,920
showing up in the list and the question

1954
01:42:17,920 --> 01:42:21,040
what becomes well is it the 3.1 or the

1955
01:42:21,040 --> 01:42:24,040
3.34

1956
01:42:28,320 --> 01:42:30,239
yep so then we can

1957
01:42:30,239 --> 01:42:32,480
compare and line them up and say well

1958
01:42:32,480 --> 01:42:36,239
this one the 3.1 when it's a source

1959
01:42:36,239 --> 01:42:38,239
has

1960
01:42:38,239 --> 01:42:40,560
ethernet source

1961
01:42:40,560 --> 01:42:43,119
of this address

1962
01:42:43,119 --> 01:42:45,679
which is not the one we're looking for

1963
01:42:45,679 --> 01:42:48,000
right but the destination

1964
01:42:48,000 --> 01:42:50,080
has the one we're looking for

1965
01:42:50,080 --> 01:42:53,199
and then is associated with the 34.

1966
01:42:53,199 --> 01:42:54,400
okay

1967
01:42:54,400 --> 01:42:57,040
so that's one approach for answering

1968
01:42:57,040 --> 01:42:58,880
that question

1969
01:42:58,880 --> 01:43:02,239
anyone take a different approach

1970
01:43:04,159 --> 01:43:06,560
okay yeah so if we have a

1971
01:43:06,560 --> 01:43:07,920
an understanding of some of the

1972
01:43:07,920 --> 01:43:09,679
protocols

1973
01:43:09,679 --> 01:43:11,840
the arp protocol

1974
01:43:11,840 --> 01:43:14,159
that's its job is to do what's called

1975
01:43:14,159 --> 01:43:16,159
address resolution right

1976
01:43:16,159 --> 01:43:19,040
and resolve if i have this ip address

1977
01:43:19,040 --> 01:43:19,840
which

1978
01:43:19,840 --> 01:43:22,239
mac address is associated with it that's

1979
01:43:22,239 --> 01:43:24,239
its whole job so it's a great one to

1980
01:43:24,239 --> 01:43:25,760
filter on to try and answer this

1981
01:43:25,760 --> 01:43:27,840
question

1982
01:43:27,840 --> 01:43:30,080
and

1983
01:43:31,440 --> 01:43:33,600
yeah so you didn't bother to then filter

1984
01:43:33,600 --> 01:43:35,360
further because you found the answer

1985
01:43:35,360 --> 01:43:36,020
right here on

1986
01:43:36,020 --> 01:43:37,600
[Music]

1987
01:43:37,600 --> 01:43:38,480
line

1988
01:43:38,480 --> 01:43:41,520
you know 5425

1989
01:43:41,520 --> 01:43:44,159
saying that that ip address is at that

1990
01:43:44,159 --> 01:43:46,879
mac address

1991
01:43:47,280 --> 01:43:49,119
okay

1992
01:43:49,119 --> 01:43:50,880
someone else

1993
01:43:50,880 --> 01:43:53,760
used dhcp which i thought was

1994
01:43:53,760 --> 01:43:56,080
clever i'd never thought of using dhcp

1995
01:43:56,080 --> 01:43:57,679
to answer this question

1996
01:43:57,679 --> 01:44:00,159
uh but it works as well

1997
01:44:00,159 --> 01:44:02,239
dhcp is going sort of the other way it's

1998
01:44:02,239 --> 01:44:05,040
used to get an ip address but to do that

1999
01:44:05,040 --> 01:44:06,960
it has to use its mac address because

2000
01:44:06,960 --> 01:44:09,600
that's all it has so you can find the

2001
01:44:09,600 --> 01:44:12,239
request for that ip address

2002
01:44:12,239 --> 01:44:14,320
and line it up

2003
01:44:14,320 --> 01:44:15,920
well you can look at the request for ip

2004
01:44:15,920 --> 01:44:17,840
addresses and line them up

2005
01:44:17,840 --> 01:44:19,840
to see which mac address corresponds

2006
01:44:19,840 --> 01:44:23,440
there and it you know again the 34

2007
01:44:23,440 --> 01:44:24,960
shows up in

2008
01:44:24,960 --> 01:44:26,560
our list of the

2009
01:44:26,560 --> 01:44:28,000
uh

2010
01:44:28,000 --> 01:44:29,920
one that we're looking for

2011
01:44:29,920 --> 01:44:33,360
destination here in that case

2012
01:44:33,360 --> 01:44:35,839
awesome

2013
01:44:36,719 --> 01:44:38,639
questions on using

2014
01:44:38,639 --> 01:44:42,199
display filters

2015
01:44:48,000 --> 01:44:50,800
yeah great question so you know let's

2016
01:44:50,800 --> 01:44:52,880
say this is a more complex

2017
01:44:52,880 --> 01:44:55,760
file and when we do arp there's you know

2018
01:44:55,760 --> 01:44:57,600
thousands in this list and we need to

2019
01:44:57,600 --> 01:44:59,600
find the one specific one that we're

2020
01:44:59,600 --> 01:45:01,520
looking for

2021
01:45:01,520 --> 01:45:02,400
again

2022
01:45:02,400 --> 01:45:04,000
this is where

2023
01:45:04,000 --> 01:45:06,239
what i would do is i would come down

2024
01:45:06,239 --> 01:45:08,880
here to get close enough

2025
01:45:08,880 --> 01:45:10,880
and then modify my filter so i'd say

2026
01:45:10,880 --> 01:45:12,560
okay filter to arp

2027
01:45:12,560 --> 01:45:16,560
so i'm looking for um one that looks

2028
01:45:16,560 --> 01:45:18,480
like this where it's saying here's this

2029
01:45:18,480 --> 01:45:20,960
ip address here's its mac address

2030
01:45:20,960 --> 01:45:23,920
and i'm going to

2031
01:45:24,560 --> 01:45:26,080
line that up

2032
01:45:26,080 --> 01:45:29,360
and say okay here's the

2033
01:45:29,360 --> 01:45:32,080
uh ip address here's the corresponding

2034
01:45:32,080 --> 01:45:34,880
mac address now let me just

2035
01:45:34,880 --> 01:45:38,000
prepare a filter

2036
01:45:38,480 --> 01:45:40,000
so that i didn't have to figure out

2037
01:45:40,000 --> 01:45:41,679
exactly what the names of those fields

2038
01:45:41,679 --> 01:45:42,719
were

2039
01:45:42,719 --> 01:45:45,440
and now i can just modify this

2040
01:45:45,440 --> 01:45:47,600
with the address that i'm actually

2041
01:45:47,600 --> 01:45:50,239
looking for

2042
01:45:54,320 --> 01:45:57,679
and in that case right now we see

2043
01:45:57,679 --> 01:45:58,800
just

2044
01:45:58,800 --> 01:46:01,520
that ip address with the mac address

2045
01:46:01,520 --> 01:46:03,600
and would let us find that information

2046
01:46:03,600 --> 01:46:07,440
even if there were thousands in there

2047
01:46:08,320 --> 01:46:11,639
other questions

2048
01:46:21,280 --> 01:46:24,320
yeah you can

2049
01:46:24,560 --> 01:46:25,520
you can

2050
01:46:25,520 --> 01:46:27,840
do ands and ors and combinations and

2051
01:46:27,840 --> 01:46:31,440
parentheses and nots and complex logic

2052
01:46:31,440 --> 01:46:33,199
most of the time what i find when i'm

2053
01:46:33,199 --> 01:46:36,080
doing it is that i rarely have need for

2054
01:46:36,080 --> 01:46:38,880
anything more than

2055
01:46:38,880 --> 01:46:41,840
a single and or a single or like usually

2056
01:46:41,840 --> 01:46:43,920
what i'm looking for just isn't that

2057
01:46:43,920 --> 01:46:45,119
specific

2058
01:46:45,119 --> 01:46:46,880
um

2059
01:46:46,880 --> 01:46:48,639
occasionally

2060
01:46:48,639 --> 01:46:51,119
so like

2061
01:46:51,280 --> 01:46:54,080
let me

2062
01:46:54,080 --> 01:46:58,119
try a couple things here

2063
01:47:27,119 --> 01:47:31,040
yep no it can go as complex as you need

2064
01:47:31,040 --> 01:47:32,000
it to

2065
01:47:32,000 --> 01:47:34,159
um and yeah like you're saying there can

2066
01:47:34,159 --> 01:47:36,000
be a few cases where you're like okay i

2067
01:47:36,000 --> 01:47:38,880
want specifically from this address on

2068
01:47:38,880 --> 01:47:41,040
this vlan

2069
01:47:41,040 --> 01:47:43,040
sending this type of data

2070
01:47:43,040 --> 01:47:45,280
and you can build those filters and

2071
01:47:45,280 --> 01:47:49,159
it'll handle it just fine

2072
01:47:50,480 --> 01:47:53,199
and then i saw a hand over here

2073
01:47:53,199 --> 01:47:55,599
earlier

2074
01:48:11,600 --> 01:48:14,000
okay so you're saying

2075
01:48:14,000 --> 01:48:16,400
like when we did this

2076
01:48:16,400 --> 01:48:19,199
filter on our udp traffic

2077
01:48:19,199 --> 01:48:20,960
and then instead of having to scroll

2078
01:48:20,960 --> 01:48:22,719
through and find

2079
01:48:22,719 --> 01:48:25,199
okay there's a dns there's a

2080
01:48:25,199 --> 01:48:26,880
mdns

2081
01:48:26,880 --> 01:48:28,800
could we just say just show me the first

2082
01:48:28,800 --> 01:48:30,639
instance of each of those that's what

2083
01:48:30,639 --> 01:48:32,080
you're asking about that's a good

2084
01:48:32,080 --> 01:48:33,240
question um

2085
01:48:33,240 --> 01:48:35,440
[Music]

2086
01:48:35,440 --> 01:48:37,600
not that i know of

2087
01:48:37,600 --> 01:48:41,960
but that doesn't mean it's not possible

2088
01:48:46,480 --> 01:48:48,639
you can

2089
01:48:48,639 --> 01:48:51,600
sort by any of these fields which can be

2090
01:48:51,600 --> 01:48:52,639
helpful

2091
01:48:52,639 --> 01:48:54,320
right so you can say well sort by

2092
01:48:54,320 --> 01:48:56,400
protocol so now when i'm looking through

2093
01:48:56,400 --> 01:48:58,320
i don't have to worry about one being in

2094
01:48:58,320 --> 01:49:00,080
the middle there because it's all the

2095
01:49:00,080 --> 01:49:01,600
dns first

2096
01:49:01,600 --> 01:49:04,000
and then

2097
01:49:04,560 --> 01:49:06,800
all the mdns

2098
01:49:06,800 --> 01:49:10,880
and the hcp must have been above those

2099
01:49:13,440 --> 01:49:17,360
other questions on using our filters

2100
01:49:22,480 --> 01:49:24,560
okay

2101
01:49:24,560 --> 01:49:26,800
so based on time we have time for one

2102
01:49:26,800 --> 01:49:28,560
more thing i've got

2103
01:49:28,560 --> 01:49:30,080
several more things

2104
01:49:30,080 --> 01:49:32,080
planned that we could work through

2105
01:49:32,080 --> 01:49:34,080
let me see sort of which one you would

2106
01:49:34,080 --> 01:49:37,040
rather so we can do a similar thing but

2107
01:49:37,040 --> 01:49:40,000
with coloring rules so it uses syntax

2108
01:49:40,000 --> 01:49:41,360
like filters

2109
01:49:41,360 --> 01:49:44,239
and changes how these lines are colored

2110
01:49:44,239 --> 01:49:45,679
and we can talk about that and look

2111
01:49:45,679 --> 01:49:46,719
through that

2112
01:49:46,719 --> 01:49:47,599
or

2113
01:49:47,599 --> 01:49:49,679
we can move into

2114
01:49:49,679 --> 01:49:52,080
doing more analysis and we can look at

2115
01:49:52,080 --> 01:49:53,920
like the

2116
01:49:53,920 --> 01:49:55,520
nmap

2117
01:49:55,520 --> 01:49:57,920
capture files and see what kind of

2118
01:49:57,920 --> 01:49:59,119
patterns

2119
01:49:59,119 --> 01:50:01,599
we discover as we look through those

2120
01:50:01,599 --> 01:50:04,480
capture files

2121
01:50:05,920 --> 01:50:08,400
and map and map okay i'm hearing votes

2122
01:50:08,400 --> 01:50:11,840
for nmap so let's do that

2123
01:50:11,840 --> 01:50:14,080
so i've got

2124
01:50:14,080 --> 01:50:15,760
two

2125
01:50:15,760 --> 01:50:18,560
capture files

2126
01:50:18,560 --> 01:50:19,599
here

2127
01:50:19,599 --> 01:50:23,040
one of them is the nmap default and the

2128
01:50:23,040 --> 01:50:26,719
other one is the nmap default baseline

2129
01:50:26,719 --> 01:50:28,880
i

2130
01:50:31,040 --> 01:50:32,800
i'm torn on which one you should look at

2131
01:50:32,800 --> 01:50:35,760
for first if you've never looked at nmap

2132
01:50:35,760 --> 01:50:37,679
traffic you don't know at all what to

2133
01:50:37,679 --> 01:50:38,560
expect

2134
01:50:38,560 --> 01:50:40,639
i would look at the nmap

2135
01:50:40,639 --> 01:50:43,280
default capture file first because

2136
01:50:43,280 --> 01:50:44,639
that's just

2137
01:50:44,639 --> 01:50:46,719
only the nmap traffic right it doesn't

2138
01:50:46,719 --> 01:50:49,440
have any other traffic mixed in

2139
01:50:49,440 --> 01:50:50,880
if you

2140
01:50:50,880 --> 01:50:52,639
instead want to see what it looks like

2141
01:50:52,639 --> 01:50:54,719
with other traffic occurring at the same

2142
01:50:54,719 --> 01:50:55,760
time

2143
01:50:55,760 --> 01:50:57,840
then that's the nmap

2144
01:50:57,840 --> 01:51:00,239
default baseline so that one has

2145
01:51:00,239 --> 01:51:03,440
baseline traffic ongoing and then nmap

2146
01:51:03,440 --> 01:51:05,760
doing a scan in the background

2147
01:51:05,760 --> 01:51:08,480
so both of these are demonstrating what

2148
01:51:08,480 --> 01:51:11,040
you see on the network when someone runs

2149
01:51:11,040 --> 01:51:13,760
an nmap scan with the default settings

2150
01:51:13,760 --> 01:51:16,080
so no extra parameters or anything they

2151
01:51:16,080 --> 01:51:17,119
just say

2152
01:51:17,119 --> 01:51:18,159
nmap

2153
01:51:18,159 --> 01:51:20,159
this network right an nmap starts

2154
01:51:20,159 --> 01:51:22,400
scanning the network well what happens

2155
01:51:22,400 --> 01:51:24,480
what does that look like if you're

2156
01:51:24,480 --> 01:51:27,040
seeing it in wireshark

2157
01:51:27,040 --> 01:51:29,520
so take a minute uh look through it see

2158
01:51:29,520 --> 01:51:31,119
what you find on your own and then we'll

2159
01:51:31,119 --> 01:51:32,800
talk about it together some of the

2160
01:51:32,800 --> 01:51:36,760
interesting things you've discovered

2161
01:54:42,800 --> 01:54:45,040
all right so you've had a couple minutes

2162
01:54:45,040 --> 01:54:47,920
to look over it

2163
01:54:47,920 --> 01:54:49,840
what have you found as you're

2164
01:54:49,840 --> 01:54:53,360
looking at this capture file

2165
01:54:53,520 --> 01:54:57,040
or these capture files

2166
01:54:59,119 --> 01:55:00,480
so i heard a voice but i can't see where

2167
01:55:00,480 --> 01:55:04,280
it's coming from okay

2168
01:55:04,960 --> 01:55:05,920
okay

2169
01:55:05,920 --> 01:55:07,920
so let's i'm going to pull up the one

2170
01:55:07,920 --> 01:55:12,159
that's just the end map stuff

2171
01:55:15,679 --> 01:55:17,520
and it starts out with a lot of arp

2172
01:55:17,520 --> 01:55:19,199
traffic

2173
01:55:19,199 --> 01:55:21,679
what is that arp traffic

2174
01:55:21,679 --> 01:55:24,080
doing

2175
01:55:27,679 --> 01:55:29,840
okay it's sequential and it's broadcast

2176
01:55:29,840 --> 01:55:32,320
traffic right so it's going

2177
01:55:32,320 --> 01:55:34,800
who has this ip address who has this ip

2178
01:55:34,800 --> 01:55:37,199
address who has this ip address

2179
01:55:37,199 --> 01:55:39,679
and this one this one okay it's all

2180
01:55:39,679 --> 01:55:44,560
being broadcast and sent out

2181
01:55:44,560 --> 01:55:47,599
to that entire network and just saying

2182
01:55:47,599 --> 01:55:48,800
looking for this one looking for this

2183
01:55:48,800 --> 01:55:50,480
one looking for this one

2184
01:55:50,480 --> 01:55:53,440
why would it do that

2185
01:55:56,159 --> 01:55:59,280
yeah this is how when you run nmap it

2186
01:55:59,280 --> 01:56:00,400
figures out

2187
01:56:00,400 --> 01:56:03,440
which devices are active on your network

2188
01:56:03,440 --> 01:56:05,440
if you just run an nmap with the default

2189
01:56:05,440 --> 01:56:06,400
settings

2190
01:56:06,400 --> 01:56:07,599
and

2191
01:56:07,599 --> 01:56:09,920
it's doing

2192
01:56:09,920 --> 01:56:13,199
a scan on your network right not on a if

2193
01:56:13,199 --> 01:56:15,280
it's a different network arp won't work

2194
01:56:15,280 --> 01:56:16,800
and it has to do a different scan in

2195
01:56:16,800 --> 01:56:18,480
that case but if it's scanning on the

2196
01:56:18,480 --> 01:56:21,119
local network it's going to find devices

2197
01:56:21,119 --> 01:56:23,679
by using arp and we can see that we can

2198
01:56:23,679 --> 01:56:26,840
see all these arp requests coming in

2199
01:56:26,840 --> 01:56:28,560
okay

2200
01:56:28,560 --> 01:56:30,239
from a

2201
01:56:30,239 --> 01:56:32,880
security perspective

2202
01:56:32,880 --> 01:56:35,360
that tells us something that tells us if

2203
01:56:35,360 --> 01:56:36,320
we

2204
01:56:36,320 --> 01:56:39,360
are wondering if

2205
01:56:39,360 --> 01:56:42,239
someone internal on our network is

2206
01:56:42,239 --> 01:56:44,800
scanning us we should maybe look for arp

2207
01:56:44,800 --> 01:56:46,800
traffic

2208
01:56:46,800 --> 01:56:48,560
but we can't just say oh all our

2209
01:56:48,560 --> 01:56:51,440
traffic's bad because we just saw in our

2210
01:56:51,440 --> 01:56:53,920
baseline that arp is also part of the

2211
01:56:53,920 --> 01:56:55,599
normal functioning of the way our

2212
01:56:55,599 --> 01:56:57,840
protocols work so we're looking for sort

2213
01:56:57,840 --> 01:56:58,800
of those

2214
01:56:58,800 --> 01:57:01,119
what differentiates it well in this case

2215
01:57:01,119 --> 01:57:03,040
a whole bunch of arp traffic all

2216
01:57:03,040 --> 01:57:05,040
sequential

2217
01:57:05,040 --> 01:57:07,360
and that'll so when we see that pattern

2218
01:57:07,360 --> 01:57:09,280
we say oh this isn't this isn't

2219
01:57:09,280 --> 01:57:11,199
following our baseline right something

2220
01:57:11,199 --> 01:57:14,400
unusual is going on here

2221
01:57:15,280 --> 01:57:17,760
what happens after all these arp

2222
01:57:17,760 --> 01:57:20,760
requests

2223
01:57:24,560 --> 01:57:27,040
speak up

2224
01:57:27,280 --> 01:57:29,040
okay then we see a bunch of reset

2225
01:57:29,040 --> 01:57:30,560
packets

2226
01:57:30,560 --> 01:57:34,000
let's get down to those

2227
01:57:36,880 --> 01:57:38,239
all right that's taking too long i'm

2228
01:57:38,239 --> 01:57:40,239
going to apply a filter and say

2229
01:57:40,239 --> 01:57:42,799
not arp

2230
01:57:44,639 --> 01:57:46,719
okay so we see

2231
01:57:46,719 --> 01:57:49,440
some other traffic some tcp requests and

2232
01:57:49,440 --> 01:57:50,800
then all of a sudden we start seeing a

2233
01:57:50,800 --> 01:57:53,360
bunch of these reset packets

2234
01:57:53,360 --> 01:57:55,199
then more tcp

2235
01:57:55,199 --> 01:57:57,440
requests and more reset packets

2236
01:57:57,440 --> 01:57:59,440
eventually it starts looking like sort

2237
01:57:59,440 --> 01:58:00,719
of

2238
01:58:00,719 --> 01:58:03,360
pattern right

2239
01:58:04,480 --> 01:58:06,880
so what's going on

2240
01:58:06,880 --> 01:58:09,280
here

2241
01:58:12,159 --> 01:58:15,760
yeah so it's we've done the arp scan

2242
01:58:15,760 --> 01:58:17,360
where we were enumerating all the

2243
01:58:17,360 --> 01:58:19,199
devices on the network

2244
01:58:19,199 --> 01:58:21,360
and what you'll

2245
01:58:21,360 --> 01:58:23,760
notice now

2246
01:58:23,760 --> 01:58:25,920
well what you might notice

2247
01:58:25,920 --> 01:58:27,280
is all of these

2248
01:58:27,280 --> 01:58:28,800
packets

2249
01:58:28,800 --> 01:58:30,639
are coming

2250
01:58:30,639 --> 01:58:32,719
from the same

2251
01:58:32,719 --> 01:58:35,360
source right to

2252
01:58:35,360 --> 01:58:37,920
the same destination

2253
01:58:37,920 --> 01:58:39,199
and it's a whole bunch of different

2254
01:58:39,199 --> 01:58:42,719
requests on different ports and a whole

2255
01:58:42,719 --> 01:58:44,080
bunch of

2256
01:58:44,080 --> 01:58:46,000
syn requests right which is the opening

2257
01:58:46,000 --> 01:58:49,199
of a tcp connection and so it's trying

2258
01:58:49,199 --> 01:58:50,000
out

2259
01:58:50,000 --> 01:58:52,400
a whole bunch of ports this time not

2260
01:58:52,400 --> 01:58:53,920
sequentially

2261
01:58:53,920 --> 01:58:54,639
but

2262
01:58:54,639 --> 01:58:57,360
lots of ports excuse me

2263
01:58:57,360 --> 01:59:00,719
uh on a specific ip address

2264
01:59:00,719 --> 01:59:03,520
and so it's it's gone out it's figured

2265
01:59:03,520 --> 01:59:05,280
out which ip addresses are active on the

2266
01:59:05,280 --> 01:59:06,639
network and now it's trying to figure

2267
01:59:06,639 --> 01:59:09,360
out which ports are active on that

2268
01:59:09,360 --> 01:59:11,440
device and the way it's doing it is just

2269
01:59:11,440 --> 01:59:14,320
by trying to connect to a whole bunch of

2270
01:59:14,320 --> 01:59:16,000
different ports and seeing which ones

2271
01:59:16,000 --> 01:59:17,760
respond back and say yeah you can

2272
01:59:17,760 --> 01:59:19,679
connect to this port

2273
01:59:19,679 --> 01:59:21,520
you can connect to this port

2274
01:59:21,520 --> 01:59:24,239
so the resets that we're seeing

2275
01:59:24,239 --> 01:59:26,320
are actually a

2276
01:59:26,320 --> 01:59:28,320
side effect of that

2277
01:59:28,320 --> 01:59:30,080
because a lot of those are being

2278
01:59:30,080 --> 01:59:31,920
rejected you try and connect to this

2279
01:59:31,920 --> 01:59:34,880
port and says sorry this one's closed

2280
01:59:34,880 --> 01:59:36,960
nothing's available here reset reset

2281
01:59:36,960 --> 01:59:38,960
reset so those are actually

2282
01:59:38,960 --> 01:59:40,400
a side effect

2283
01:59:40,400 --> 01:59:42,000
they're coming from

2284
01:59:42,000 --> 01:59:43,920
the legitimate clients that are just out

2285
01:59:43,920 --> 01:59:46,719
there doing their job and it's the

2286
01:59:46,719 --> 01:59:48,719
this 232

2287
01:59:48,719 --> 01:59:51,440
that's generating all these requests

2288
01:59:51,440 --> 01:59:53,520
it's the one causing the problem by

2289
01:59:53,520 --> 01:59:56,320
trying to connect to all these devices

2290
01:59:56,320 --> 02:00:00,320
all these ports okay

2291
02:00:02,239 --> 02:00:04,080
uh i sort of

2292
02:00:04,080 --> 02:00:06,080
gave it away

2293
02:00:06,080 --> 02:00:07,440
in terms of

2294
02:00:07,440 --> 02:00:12,280
which device here is the attacker

2295
02:00:12,320 --> 02:00:16,320
the 232 okay and we can see that

2296
02:00:16,320 --> 02:00:20,000
in the arp request if we look at

2297
02:00:20,000 --> 02:00:22,880
who's sending out all those arp requests

2298
02:00:22,880 --> 02:00:24,639
we can see that in

2299
02:00:24,639 --> 02:00:27,199
this sin scan if we look at who's

2300
02:00:27,199 --> 02:00:30,320
sending out the connection requests

2301
02:00:30,320 --> 02:00:32,559
okay

2302
02:00:32,960 --> 02:00:34,960
so if you

2303
02:00:34,960 --> 02:00:36,960
use what we applied in this file and

2304
02:00:36,960 --> 02:00:38,960
said okay now i know

2305
02:00:38,960 --> 02:00:41,920
what a nmap scan looks like

2306
02:00:41,920 --> 02:00:44,159
on my local network when it's occurring

2307
02:00:44,159 --> 02:00:46,719
from a device on my local network i want

2308
02:00:46,719 --> 02:00:50,000
to create some rules and some filters

2309
02:00:50,000 --> 02:00:52,719
that will help me identify that

2310
02:00:52,719 --> 02:00:55,119
wireshark already has a okay one in the

2311
02:00:55,119 --> 02:00:56,719
it's highlighting all these reset

2312
02:00:56,719 --> 02:00:58,960
packets in red so they'll kind of stand

2313
02:00:58,960 --> 02:01:00,560
out

2314
02:01:00,560 --> 02:01:02,000
you might want to

2315
02:01:02,000 --> 02:01:04,400
highlight arp packets in a different

2316
02:01:04,400 --> 02:01:07,040
color if you're in your

2317
02:01:07,040 --> 02:01:10,159
nmap seeking profile or whatever right

2318
02:01:10,159 --> 02:01:13,040
to make those pop out so you can notice

2319
02:01:13,040 --> 02:01:15,520
if they are

2320
02:01:15,520 --> 02:01:17,679
in that file and largely prevalent

2321
02:01:17,679 --> 02:01:19,119
without having to remember to

2322
02:01:19,119 --> 02:01:21,199
specifically check it because it'll be a

2323
02:01:21,199 --> 02:01:22,560
visual reminder

2324
02:01:22,560 --> 02:01:24,639
that's where the coloring rules

2325
02:01:24,639 --> 02:01:26,480
come into play i know we sort of skipped

2326
02:01:26,480 --> 02:01:28,960
the coloring rules but i'm gonna so i'll

2327
02:01:28,960 --> 02:01:30,320
just show you

2328
02:01:30,320 --> 02:01:32,800
where you set those

2329
02:01:32,800 --> 02:01:34,400
under view

2330
02:01:34,400 --> 02:01:37,199
coloring rules

2331
02:01:37,199 --> 02:01:40,560
you can apply custom coloring rules

2332
02:01:40,560 --> 02:01:43,760
and you do it by giving it a name and

2333
02:01:43,760 --> 02:01:45,760
assigning in a filter any packet that

2334
02:01:45,760 --> 02:01:48,480
matches that filter will get colored

2335
02:01:48,480 --> 02:01:51,119
with those the colors that you select

2336
02:01:51,119 --> 02:01:52,719
and it applies them

2337
02:01:52,719 --> 02:01:55,520
in order meaning it starts at the top

2338
02:01:55,520 --> 02:01:57,440
and the first packet that matches that

2339
02:01:57,440 --> 02:02:00,000
filter gets the color and then it stops

2340
02:02:00,000 --> 02:02:02,000
and it doesn't go on and try and see if

2341
02:02:02,000 --> 02:02:04,639
it matches one below that

2342
02:02:04,639 --> 02:02:06,800
okay so that's how you can use coloring

2343
02:02:06,800 --> 02:02:08,080
rules

2344
02:02:08,080 --> 02:02:09,679
to help you as you're doing this

2345
02:02:09,679 --> 02:02:12,679
analysis

2346
02:02:19,119 --> 02:02:21,360
yep that's exactly right so when we come

2347
02:02:21,360 --> 02:02:23,440
under here to our

2348
02:02:23,440 --> 02:02:24,560
uh

2349
02:02:24,560 --> 02:02:26,560
coloring rules

2350
02:02:26,560 --> 02:02:29,119
and we see it's got an arp coloring rule

2351
02:02:29,119 --> 02:02:33,839
and it's coloring at these colors we can

2352
02:02:34,800 --> 02:02:36,880
move that

2353
02:02:36,880 --> 02:02:39,280
up in our list

2354
02:02:39,280 --> 02:02:41,679
maybe

2355
02:02:42,880 --> 02:02:44,000
there we go

2356
02:02:44,000 --> 02:02:46,719
by just clicking and dragging it

2357
02:02:46,719 --> 02:02:49,440
up the list

2358
02:02:51,440 --> 02:02:54,080
so that it's the first rule that applies

2359
02:02:54,080 --> 02:02:55,920
and then if we're if we're doing that we

2360
02:02:55,920 --> 02:02:57,360
probably want to make it stand out a

2361
02:02:57,360 --> 02:02:58,800
little more so i'm going to change the

2362
02:02:58,800 --> 02:03:00,560
background color

2363
02:03:00,560 --> 02:03:03,760
to be bright pink

2364
02:03:08,080 --> 02:03:10,719
so now when i'm scanning through

2365
02:03:10,719 --> 02:03:13,679
those really pop out

2366
02:03:13,679 --> 02:03:16,000
over here on the far right

2367
02:03:16,000 --> 02:03:17,119
is like

2368
02:03:17,119 --> 02:03:21,119
a preview of a larger portion of your

2369
02:03:21,119 --> 02:03:23,840
capture and so that can also help you oh

2370
02:03:23,840 --> 02:03:25,599
look there's a big chunk of pink and you

2371
02:03:25,599 --> 02:03:27,760
can click on it and jump to it and

2372
02:03:27,760 --> 02:03:30,480
analyze it

2373
02:03:32,239 --> 02:03:34,480
okay

2374
02:03:35,520 --> 02:03:36,719
all right well you guys have been

2375
02:03:36,719 --> 02:03:39,440
awesome we're out of time so we'll wrap

2376
02:03:39,440 --> 02:03:41,840
up with that today

2377
02:03:41,840 --> 02:03:44,320
as i'm wandering throughout the con feel

2378
02:03:44,320 --> 02:03:47,040
free to say hi i love meeting

2379
02:03:47,040 --> 02:03:48,960
everyone who's here if you have any

2380
02:03:48,960 --> 02:03:50,719
questions i can hang around for a minute

2381
02:03:50,719 --> 02:03:53,199
and answer questions too

2382
02:03:53,199 --> 02:03:56,440
thank you

