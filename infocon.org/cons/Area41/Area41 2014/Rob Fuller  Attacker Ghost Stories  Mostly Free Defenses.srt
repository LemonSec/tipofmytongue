1
00:00:08,750 --> 00:00:12,349
alright so

2
00:00:12,349 --> 00:00:15,620
that's me I have some awesome kids

3
00:00:15,620 --> 00:00:16,740
from I'm a

4
00:00:16,740 --> 00:00:20,390
has been no hacker I don't know if you
guys know what that is and also marine

5
00:00:20,390 --> 00:00:23,550
so why are we here

6
00:00:23,550 --> 00:00:27,250
shouted out wise anybody here

7
00:00:27,250 --> 00:00:30,529
learn we got learn light

8
00:00:30,529 --> 00:00:36,199
nothing we're just we're just here to
sit in chairs

9
00:00:36,199 --> 00:00:39,920
got it still laptops

10
00:00:39,920 --> 00:00:43,050
awesome so

11
00:00:43,050 --> 00:00:46,769
before getting team at I am I put this

12
00:00:46,769 --> 00:00:50,220
together because when I was

13
00:00:50,220 --> 00:00:55,320
doing all these contests I would do the
Pentastar give the report

14
00:00:55,320 --> 00:00:59,589
and then the person who got the report
the cis or whoever

15
00:00:59,589 --> 00:01:03,979
guy they go okay how do I fix these
things okay I told you how to fix these

16
00:01:03,979 --> 00:01:04,479
things

17
00:01:04,479 --> 00:01:10,510
which box do i buy to fix these things I
am

18
00:01:10,510 --> 00:01:14,580
really is in a box is no there's no
wonderful solution that comes

19
00:01:14,580 --> 00:01:19,220
and you pay for it most other things are
free

20
00:01:19,220 --> 00:01:22,890
who's here herder he met good

21
00:01:22,890 --> 00:01:26,130
more hands than normal this is awesome
so

22
00:01:26,130 --> 00:01:30,950
email is you can if you haven't heard of
it it's basically this free tool

23
00:01:30,950 --> 00:01:34,189
that is like a memory

24
00:01:34,189 --> 00:01:37,310
down sir so he stands in front of this

25
00:01:37,310 --> 00:01:40,499
this all this memory that year Windows

26
00:01:40,499 --> 00:01:43,719
machine has and says no its not gonna
happen

27
00:01:43,719 --> 00:01:47,929
the great thing about this is that it's
operating at a level

28
00:01:47,929 --> 00:01:51,270
where most people don't really think
about

29
00:01:51,270 --> 00:01:56,149
so you have buffer overflows for
instance a buffer overflow what it does

30
00:01:56,149 --> 00:02:00,130
and most you guys know this I'm not
trying to tell you something the yard

31
00:02:00,130 --> 00:02:03,350
no reno is it starts with

32
00:02:03,350 --> 00:02:07,549
a problem in a piece of software once
that is a software

33
00:02:07,549 --> 00:02:10,860
has a problem in it someone throws a
bunch of stuff in it

34
00:02:10,860 --> 00:02:14,260
and it does some other stuff well the
problem is

35
00:02:14,260 --> 00:02:18,080
that once it has that code execution
once you have

36
00:02:18,080 --> 00:02:21,980
like where the bad guy is controlling
things

37
00:02:21,980 --> 00:02:25,750
that's the problem not the software

38
00:02:25,750 --> 00:02:27,930
so he might actually protects against
this

39
00:02:27,930 --> 00:02:31,560
using somethings like

40
00:02:31,560 --> 00:02:35,299
forced

41
00:02:35,299 --> 00:02:38,689
Dec scho p

42
00:02:38,689 --> 00:02:42,370
SLR all all these different protections
so

43
00:02:42,370 --> 00:02:46,370
email has all these amazing protections
on it and you can

44
00:02:46,370 --> 00:02:51,079
apply it via GPO and this is free so you
get all this cool stuff

45
00:02:51,079 --> 00:02:54,159
it stops all the memory corruption
budget stuff so days it's great

46
00:02:54,159 --> 00:03:00,950
but you can bypass it right

47
00:03:00,950 --> 00:03:04,319
there's all these talks and stuff about
bypassing the net

48
00:03:04,319 --> 00:03:08,590
here's another one

49
00:03:08,590 --> 00:03:12,689
and you can you can take a picture that
QR code loaded up by

50
00:03:12,689 --> 00:03:18,069
its fine in trust me we just talked
about trust REIT

51
00:03:18,069 --> 00:03:21,189
but the problem with the

52
00:03:21,189 --> 00:03:25,280
all the he met bypasses the scene out
there is they bypass one

53
00:03:25,280 --> 00:03:28,989
or two or three pieces a or protections
that he met does

54
00:03:28,989 --> 00:03:33,599
well the planning on

55
00:03:33,599 --> 00:03:37,310
now so depending on the buffer for other
or the exploit or so

56
00:03:37,310 --> 00:03:40,400
that can mean one of two things

57
00:03:40,400 --> 00:03:44,229
they can either bypass some a minute and
that particular

58
00:03:44,229 --> 00:03:48,319
application is either not protected by
met or it is in its only

59
00:03:48,319 --> 00:03:52,010
I'll Adina couple on these protections

60
00:03:52,010 --> 00:03:55,699
or they have to bypass all or months ago

61
00:03:55,699 --> 00:04:01,699
so that's really hard if I am an
attacker

62
00:04:01,699 --> 00:04:06,079
how much money do you think I'm going to
spend on getting into your organization

63
00:04:06,079 --> 00:04:11,269
if I can just spam everyone and get into
a bun some organizations

64
00:04:11,269 --> 00:04:14,689
not much unless I'm going after
something very specific

65
00:04:14,689 --> 00:04:18,549
so he met is not a hundred percent
solution it's the ninety percent

66
00:04:18,549 --> 00:04:19,150
solution

67
00:04:19,150 --> 00:04:22,970
you can get ninety percent of dry bison

68
00:04:22,970 --> 00:04:26,270
watering hole tax and all that stuff
that's going on right now

69
00:04:26,270 --> 00:04:31,340
with 13 tool with you don't have to
worry about catching you can you can

70
00:04:31,340 --> 00:04:31,970
stop at

71
00:04:31,970 --> 00:04:36,439
as a that work for everyone

72
00:04:36,439 --> 00:04:38,840
yeah no so

73
00:04:38,840 --> 00:04:43,110
email we got that for free from
Microsoft and that smacks of stuff

74
00:04:43,110 --> 00:04:46,409
and its windows stuff what about Java

75
00:04:46,409 --> 00:04:49,520
most the job at things in under

76
00:04:49,520 --> 00:04:52,870
unfortunately I'm saying this on camera
for whatever I am

77
00:04:52,870 --> 00:04:56,749
mostly job things are are problems that
Sun created or

78
00:04:56,749 --> 00:05:00,319
mister ellison created or Oracle created
or stuff like that

79
00:05:00,319 --> 00:05:07,080
anyways I am so Java has problems that
are buffer overflows their

80
00:05:07,080 --> 00:05:10,210
stupid problems in in

81
00:05:10,210 --> 00:05:14,509
permissions or stuff like that so how do
you

82
00:05:14,509 --> 00:05:20,080
how do you stop Java anyone ever
uninstall

83
00:05:20,080 --> 00:05:23,550
it's a great honor so I put up these the

84
00:05:23,550 --> 00:05:29,099
I normally get is packing that works

85
00:05:29,099 --> 00:05:33,680
everyone was just patch job although it
to the newest version or good right

86
00:05:33,680 --> 00:05:37,529
yeah really doesn't work in the

87
00:05:37,529 --> 00:05:42,849
in a developer situation I was disable
the plugin in GPO let's just

88
00:05:42,849 --> 00:05:47,439
make it so that there's all that stuff
doesn't work now works

89
00:05:47,439 --> 00:05:51,000
or

90
00:05:51,000 --> 00:05:54,360
the final whatever she wants to just run
Linux because Java doesn't work on Linux

91
00:05:54,360 --> 00:05:57,520
right very

92
00:05:57,520 --> 00:06:00,639
so everyone knows that this is

93
00:06:00,639 --> 00:06:03,810
this is what all on your users

94
00:06:03,810 --> 00:06:07,779
sent to every website that they go to
you

95
00:06:07,779 --> 00:06:12,620
what version are dotnet the running what
version InfoPath

96
00:06:12,620 --> 00:06:16,099
and all that this is all this this is
called the user agent if you haven't

97
00:06:16,099 --> 00:06:17,460
seen the user agent before that

98
00:06:17,460 --> 00:06:23,020
in HCV traffic and the crazy thing about
this is that this user agent

99
00:06:23,020 --> 00:06:27,819
is used on all a website that goes
through but when it sees Java code

100
00:06:27,819 --> 00:06:33,349
when something is written in Java for a
web application

101
00:06:33,349 --> 00:06:37,419
it does something weird it sends all
that stuff

102
00:06:37,419 --> 00:06:41,099
Mikes Mike softer whatever I'm browser
you use

103
00:06:41,099 --> 00:06:45,849
says I don't know how to do anything
with this here Java plugin you doing a

104
00:06:45,849 --> 00:06:47,459
Java plugin

105
00:06:47,459 --> 00:06:51,449
since this across it says a

106
00:06:51,449 --> 00:06:54,759
Java I'm gonna go through the proxy I'm
gonna request this thing

107
00:06:54,759 --> 00:06:59,029
but sings it with a user-agent

108
00:06:59,029 --> 00:07:05,509
thats way different than the one that
uses in the browser job W S 1.6 died 09

109
00:07:05,509 --> 00:07:09,389
0:29 anyone know what we're a what
exploit works for that

110
00:07:09,389 --> 00:07:12,699
about 1 626

111
00:07:12,699 --> 00:07:17,129
170 45

112
00:07:17,129 --> 00:07:21,409
alright anyways those shoppers regions
are

113
00:07:21,409 --> 00:07:24,969
are going across the wire so why not do
something about it

114
00:07:24,969 --> 00:07:31,819
so this is how it looks and this is what
I'm for

115
00:07:31,819 --> 00:07:34,849
I I suggest to people block

116
00:07:34,849 --> 00:07:40,569
Java at the firehall rather proxy you
even block it very simply by

117
00:07:40,569 --> 00:07:45,039
going in Shiprock since a day it has
this job user-agent: don't allow

118
00:07:45,039 --> 00:07:48,759
through that works for everyone

119
00:07:48,759 --> 00:07:53,029
you guys are dead it's too early in the
morning right

120
00:07:53,029 --> 00:07:56,459
Monday it

121
00:07:56,459 --> 00:08:02,110
good excuse alright so if the user never
gets this product

122
00:08:02,110 --> 00:08:05,559
then you win you never given the option
to click run

123
00:08:05,559 --> 00:08:09,669
because people like Dave Kennedy have
sign their stuff

124
00:08:09,669 --> 00:08:14,449
and they have the option and you know
click wrong so let's just not given that

125
00:08:14,449 --> 00:08:15,039
option

126
00:08:15,039 --> 00:08:18,899
we would you trust all users to

127
00:08:18,899 --> 00:08:22,769
to to sign code in in your organization

128
00:08:22,769 --> 00:08:30,039
always nice so this is how I said just
do it

129
00:08:30,039 --> 00:08:33,599
there's two ways one you can

130
00:08:33,599 --> 00:08:37,289
completely block all job user-agent: if
are all

131
00:08:37,289 --> 00:08:41,860
in only allow specific exceptions
through this is worked out very large

132
00:08:41,860 --> 00:08:42,899
organizations

133
00:08:42,899 --> 00:08:47,730
already during this or

134
00:08:47,730 --> 00:08:51,269
you can just block on the version so
like I showed it earlier that job

135
00:08:51,269 --> 00:08:54,610
user-agent: shows you exactly what
version it's going

136
00:08:54,610 --> 00:08:59,579
the way that I found that Iran fishing
exercises and saw hey

137
00:08:59,579 --> 00:09:00,329
this job for you

138
00:09:00,329 --> 00:09:03,949
regions getting shown up let me send
them that exploit this morning's your

139
00:09:03,949 --> 00:09:09,040
let me sing bad actually so see that
read:

140
00:09:09,040 --> 00:09:15,389
this is also three so

141
00:09:15,389 --> 00:09:19,049
stop exploits the browser and they came
on

142
00:09:19,049 --> 00:09:24,739
0 yes that last bullet there is no way
that I know

143
00:09:24,739 --> 00:09:28,309
and I've asked a lot of people that a
attacker

144
00:09:28,309 --> 00:09:33,049
can change the job the user agent before
the export kicks off

145
00:09:33,049 --> 00:09:38,679
so they have to use that job usually do
there's no

146
00:09:38,679 --> 00:09:43,489
ifs ands or buts about it they hacked
the user if they are pulling down code

147
00:09:43,489 --> 00:09:47,119
now if they start training stuff like

148
00:09:47,119 --> 00:09:51,019
I flashed a Java and stuff like that
that might change things

149
00:09:51,019 --> 00:09:57,299
when and seen anyone use that yet so

150
00:09:57,299 --> 00:10:00,939
after I posted a blog post on how to do
this with squid

151
00:10:00,939 --> 00:10:04,230
there's a guy named easy on reddit that
said a

152
00:10:04,230 --> 00:10:07,470
this works in sl2 so

153
00:10:07,470 --> 00:10:10,999
user-agent: is sent across proxies

154
00:10:10,999 --> 00:10:15,220
that use SSL Santana not only am i
blocking

155
00:10:15,220 --> 00:10:18,360
all the memory corruption bugs with the
Met

156
00:10:18,360 --> 00:10:22,399
unless they bypassed 30:40 a.m. I'm

157
00:10:22,399 --> 00:10:25,610
blocking all love the job law are
problems with

158
00:10:25,610 --> 00:10:30,319
with my proxy even if the attacker

159
00:10:30,319 --> 00:10:34,199
decides to use SSL on their website and
trying ripped everything

160
00:10:34,199 --> 00:10:38,029
I still blocking cool stuff

161
00:10:38,029 --> 00:10:44,890
your the Monday

162
00:10:44,890 --> 00:10:47,320
oh yeah and it helps with Max to

163
00:10:47,320 --> 00:10:52,360
how many people just as a the as a a
show of hands how many people in your

164
00:10:52,360 --> 00:10:55,029
organization have max on their network
right now

165
00:10:55,029 --> 00:10:58,060
keeper and raced

166
00:10:58,060 --> 00:11:02,560
how many have you guys put it down if
you don't have

167
00:11:02,560 --> 00:11:06,410
group policy or or central management of
those

168
00:11:06,410 --> 00:11:10,440
max every had McDonalds in these two

169
00:11:10,440 --> 00:11:16,680
I

170
00:11:16,680 --> 00:11:21,970
alright so we block all of these things
that memory corruption we bought

171
00:11:21,970 --> 00:11:25,860
all this job stuff how many fishing

172
00:11:25,860 --> 00:11:30,260
arm exploit or targets can you think of
that

173
00:11:30,260 --> 00:11:34,360
are in those two groups 0

174
00:11:34,360 --> 00:11:40,290
so not solved all your client I Klein
exploitation

175
00:11:40,290 --> 00:11:43,680
problems right alright

176
00:11:43,680 --> 00:11:47,079
so next topic on talk about is

177
00:11:47,079 --> 00:11:51,199
is kinda one that's been be to death on

178
00:11:51,199 --> 00:11:54,540
every other talk that I've ever seen
first one

179
00:11:54,540 --> 00:11:58,339
one that I don't see very many people
talking about

180
00:11:58,339 --> 00:12:01,440
is if PW don't is removed

181
00:12:01,440 --> 00:12:06,470
from your I ask box in your DMZ is that
the end of the solution

182
00:12:06,470 --> 00:12:09,480
is like if its

183
00:12:09,480 --> 00:12:14,440
if you're AV guy comes up to you and
says hey all these things got moved

184
00:12:14,440 --> 00:12:18,050
you like great job well done

185
00:12:18,050 --> 00:12:21,110
no

186
00:12:21,110 --> 00:12:25,740
if they got there somehow just PW dumb

187
00:12:25,740 --> 00:12:29,670
doesn't just magically appear on I asked
boxes and lustrous john Ryley put it

188
00:12:29,670 --> 00:12:30,079
there

189
00:12:30,079 --> 00:12:33,959
I

190
00:12:33,959 --> 00:12:37,449
so less let's start working on getting

191
00:12:37,449 --> 00:12:40,910
all love the actively remove things
looked at and

192
00:12:40,910 --> 00:12:44,199
and assessed log are learning

193
00:12:44,199 --> 00:12:48,089
how many people in this room right now
have

194
00:12:48,089 --> 00:12:51,500
something and fries that logs and alerts
on

195
00:12:51,500 --> 00:12:55,880
successful log on the terms

196
00:12:55,880 --> 00:12:59,449
to 3 BS you just raise your hand now

197
00:12:59,449 --> 00:13:02,740
so

198
00:13:02,740 --> 00:13:06,870
a tiara plus news is the only one that I
know thats paid in this whole talk

199
00:13:06,870 --> 00:13:10,490
idiotic forces the only true that I've
ever seen that does is cause I was on a

200
00:13:10,490 --> 00:13:11,160
pen test

201
00:13:11,160 --> 00:13:14,250
and I'd successfully fish

202
00:13:14,250 --> 00:13:17,509
into this organization Guardian

203
00:13:17,509 --> 00:13:21,319
I started using the local admin Hashim
got found the domain admin

204
00:13:21,319 --> 00:13:25,209
started using the domain and into
authenticate other places

205
00:13:25,209 --> 00:13:30,290
I used that authentication three times
Adri plus

206
00:13:30,290 --> 00:13:33,350
sent email to the domain admin are

207
00:13:33,350 --> 00:13:37,620
our text message to remain anon domain
admin responded that text message

208
00:13:37,620 --> 00:13:41,709
change password his pattern was
instantly change

209
00:13:41,709 --> 00:13:46,970
on the domain controller from his cell
phone the local admin that I also use

210
00:13:46,970 --> 00:13:48,880
was also change automatically

211
00:13:48,880 --> 00:13:52,089
and I was dead in the water and all over
the Longhorns

212
00:13:52,089 --> 00:13:55,310
that I had done reported to him via
email

213
00:13:55,310 --> 00:14:00,380
in a matter of minutes I was dead in the
water

214
00:14:00,380 --> 00:14:04,410
so idiotic pluses what is it true that I

215
00:14:04,410 --> 00:14:08,920
he said that he used to do that which is
amazing I haven't seen anyone else do

216
00:14:08,920 --> 00:14:09,529
that

217
00:14:09,529 --> 00:14:12,860
I'm sure you can do it was flunking
every other thing that a

218
00:14:12,860 --> 00:14:15,949
Rafi would tell us about I

219
00:14:15,949 --> 00:14:19,639
hips now

220
00:14:19,639 --> 00:14:24,170
this is a little bit of a sensitive part
for me how many people in here

221
00:14:24,170 --> 00:14:28,670
have some kinda host intrusion
prevention system on their computers

222
00:14:28,670 --> 00:14:29,300
right now

223
00:14:29,300 --> 00:14:33,279
that's kind it's hard there's like five
hands

224
00:14:33,279 --> 00:14:38,339
alright how many people in their
organizations actually enable

225
00:14:38,339 --> 00:14:43,050
the prevention part not as logging
missed two hands

226
00:14:43,050 --> 00:14:46,920
3.5 down it's you alright so

227
00:14:46,920 --> 00:14:50,120
it's really hard for someone to enable

228
00:14:50,120 --> 00:14:53,720
host Intrusion Prevention actual
prevention part because

229
00:14:53,720 --> 00:14:57,410
those signatures can run the gamut

230
00:14:57,410 --> 00:15:01,110
and and sometimes they actually target
themselves like mccaffrey's

231
00:15:01,110 --> 00:15:05,319
I'll so how do you do this effectively

232
00:15:05,319 --> 00:15:06,310
well

233
00:15:06,310 --> 00:15:10,259
remember the PW them for example have a
let's just turn on categories:

234
00:15:10,259 --> 00:15:15,569
like if it's a hacker tool let's enable
the Convention on that he nor the rare

235
00:15:15,569 --> 00:15:19,399
long gold the other you know signatures
and stuff that it detects

236
00:15:19,399 --> 00:15:22,949
let's just enable the prevention on

237
00:15:22,949 --> 00:15:26,459
hacker tools like netcat

238
00:15:26,459 --> 00:15:30,850
evil netcat an

239
00:15:30,850 --> 00:15:34,339
Monday I what a body scanning

240
00:15:34,339 --> 00:15:38,680
how many

241
00:15:38,680 --> 00:15:42,040
how many in this room are Penn testers K

242
00:15:42,040 --> 00:15:45,199
how many vulnerability assessments
people

243
00:15:45,199 --> 00:15:48,860
not want North

244
00:15:48,860 --> 00:15:53,250
what's the reason and that's awesome
voted early assessments I

245
00:15:53,250 --> 00:15:56,810
basically morally scanning how many how
many in this room

246
00:15:56,810 --> 00:16:00,360
dont have always can do about that
alright

247
00:16:00,360 --> 00:16:05,220
how many people that had done that
police can have looked through every

248
00:16:05,220 --> 00:16:06,899
single one of those results

249
00:16:06,899 --> 00:16:10,000
really

250
00:16:10,000 --> 00:16:16,079
for awesome now the problem I see here's
is becoming more and more common

251
00:16:16,079 --> 00:16:19,910
as more people moraz asians your body
scanning

252
00:16:19,910 --> 00:16:23,660
by default they hire people to do those
who then

253
00:16:23,660 --> 00:16:28,750
generate the reports given to the people
who own those machines they fix these

254
00:16:28,750 --> 00:16:31,750
how effective is that

255
00:16:31,750 --> 00:16:37,130
right so formally scanning is

256
00:16:37,130 --> 00:16:40,670
is what that rule dies and many more
people in it in

257
00:16:40,670 --> 00:16:43,860
that go into those results and say

258
00:16:43,860 --> 00:16:47,019
PHP CGI vulnerability that

259
00:16:47,019 --> 00:16:51,040
is in this module that's never enabled
not important

260
00:16:51,040 --> 00:16:54,380
or chrome or inability

261
00:16:54,380 --> 00:16:57,449
that nobody publishes information on

262
00:16:57,449 --> 00:17:01,300
and K ever be exploited yeah

263
00:17:01,300 --> 00:17:04,880
I see some people laughing me know how
it is so

264
00:17:04,880 --> 00:17:09,089
we need people in front of this many
people doing voted on the reporting

265
00:17:09,089 --> 00:17:10,829
instead of just sending of this

266
00:17:10,829 --> 00:17:14,770
stupid little report that get generated
by the damn thing

267
00:17:14,770 --> 00:17:18,569
I and if your organization

268
00:17:18,569 --> 00:17:21,890
doesn't have someone to do that

269
00:17:21,890 --> 00:17:25,089
if they just had the person that pushes
the button and does thing

270
00:17:25,089 --> 00:17:28,380
you know gives it off your pen testers
involved

271
00:17:28,380 --> 00:17:33,230
a guarantee every single pen tester
would love to see your own abilities can

272
00:17:33,230 --> 00:17:38,299
alright

273
00:17:38,299 --> 00:17:41,679
Milan crowdsourcing security

274
00:17:41,679 --> 00:17:46,600
I'm everyone knows that crowdsourcing is
right

275
00:17:46,600 --> 00:17:50,309
and UK so crowdsourcing security is

276
00:17:50,309 --> 00:17:53,929
is a is an attempt to change all of your
users

277
00:17:53,929 --> 00:17:59,350
that bad word into shit an idea into
someone who actually wants to help you

278
00:17:59,350 --> 00:18:02,360
so how we how do we do that first

279
00:18:02,360 --> 00:18:05,470
was take this this its incident

280
00:18:05,470 --> 00:18:08,970
program the security is referring where
someone reports a problem

281
00:18:08,970 --> 00:18:14,270
and the don't get any feedback or the
report a problem and you say okay I'll

282
00:18:14,270 --> 00:18:15,179
take care

283
00:18:15,179 --> 00:18:18,799
in turn into something more mcgain

284
00:18:18,799 --> 00:18:23,240
so I I believe there are a couple people
with that are talking about

285
00:18:23,240 --> 00:18:27,809
demarcation are a different programs I'm
stealing the thunder right now

286
00:18:27,809 --> 00:18:31,610
I'll but let's turn this into a reward
program

287
00:18:31,610 --> 00:18:35,470
where the top users the people who
report all these

288
00:18:35,470 --> 00:18:39,120
machine exercises are these these
attempts a

289
00:18:39,120 --> 00:18:42,210
breaking into your organization get
something out of it

290
00:18:42,210 --> 00:18:48,179
so you say pay si ESO CEO could use
enough this email to

291
00:18:48,179 --> 00:18:51,780
the company require because getting
recognition from the

292
00:18:51,780 --> 00:18:54,840
CEO the company that they were the

293
00:18:54,840 --> 00:18:59,549
the top three people in the organization
the reported security vulnerabilities

294
00:18:59,549 --> 00:19:02,559
matters it start making a

295
00:19:02,559 --> 00:19:07,010
into a game starts making into like
greedy selves that we all are

296
00:19:07,010 --> 00:19:10,710
and saying I want to be recognized I
want to be recognized I wanna be the guy

297
00:19:10,710 --> 00:19:14,130
top and then you give them a hundred
dollar gift card

298
00:19:14,130 --> 00:19:18,960
a fifty dollar gift card something more
than five dollars on its

299
00:19:18,960 --> 00:19:22,510
if it's a five dollar gift card to
Starbucks no one's gonna care

300
00:19:22,510 --> 00:19:26,480
so

301
00:19:26,480 --> 00:19:30,410
once you do that once you make it into a
game once you make it recognizable

302
00:19:30,410 --> 00:19:33,580
something that responds you start making
it

303
00:19:33,580 --> 00:19:36,590
innings where every single employee is
an IDS

304
00:19:36,590 --> 00:19:40,120
where someone wants to tell you about
the bad things that happen in any

305
00:19:40,120 --> 00:19:42,610
organization and finally

306
00:19:42,610 --> 00:19:46,590
the think quarterly think Evil games now

307
00:19:46,590 --> 00:19:50,140
no olive you didn't just start into
security

308
00:19:50,140 --> 00:19:54,280
I came at a college in like yeah I'm
gonna be

309
00:19:54,280 --> 00:19:57,900
I senior Pentax direct company s no

310
00:19:57,900 --> 00:20:02,040
we were all IT guys are or or different
you know

311
00:20:02,040 --> 00:20:07,900
different positions in the company's at
some point and we all found ways

312
00:20:07,900 --> 00:20:11,830
to get what we wanted we all found ways
to get to Facebook

313
00:20:11,830 --> 00:20:15,820
when it was blocked we all found ways to
get SSH out or

314
00:20:15,820 --> 00:20:18,910
my webserver selecting download movies
to watch it work

315
00:20:18,910 --> 00:20:22,290
we all found those ways so

316
00:20:22,290 --> 00:20:25,590
this thing this quarterly think you will
gain is

317
00:20:25,590 --> 00:20:29,200
a one-time one corner deal

318
00:20:29,200 --> 00:20:32,450
where you say if you tell me if you're
employees

319
00:20:32,450 --> 00:20:36,830
you tell me about how you got around our
security

320
00:20:36,830 --> 00:20:42,020
you you will not be disappointed all and
we will show you how to do it correctly

321
00:20:42,020 --> 00:20:45,130
you'll get a lot of people telling you

322
00:20:45,130 --> 00:20:48,380
all the little things that you didn't
know about

323
00:20:48,380 --> 00:20:51,880
that there's a proxy over here in this
party organization

324
00:20:51,880 --> 00:20:57,419
that everyone but you knows about that
can go out to Facebook

325
00:20:57,419 --> 00:21:02,750
so if you give them the opportunity to
tell you without repercussion

326
00:21:02,750 --> 00:21:05,750
or maybe even giving them part of the
reward

327
00:21:05,750 --> 00:21:10,280
you start getting more intelligence
about your own organization than you

328
00:21:10,280 --> 00:21:11,040
normally would

329
00:21:11,040 --> 00:21:14,290
the second

330
00:21:14,290 --> 00:21:17,900
crowdsourcing suggestion I have for you
guys is

331
00:21:17,900 --> 00:21:22,410
internal Bongani programs how many have
you

332
00:21:22,410 --> 00:21:25,520
have gone to an internal web application

333
00:21:25,520 --> 00:21:29,540
are an internal and it was just that
with internal evaporation

334
00:21:29,540 --> 00:21:33,660
internal evaporation and put a tick mark
and something broke

335
00:21:33,660 --> 00:21:34,320
anyway

336
00:21:34,320 --> 00:21:38,059
thing act next yeah

337
00:21:38,059 --> 00:21:41,509
so if you have something

338
00:21:41,509 --> 00:21:44,570
where someone can report those and say

339
00:21:44,570 --> 00:21:49,539
K I found this and it gives me a sequel
where I don't know what this is about

340
00:21:49,539 --> 00:21:50,659
but I think it's bad

341
00:21:50,659 --> 00:21:53,970
or or I put I put in my password and it
said

342
00:21:53,970 --> 00:21:57,210
no you don't that's the wrong password
the admin password is this

343
00:21:57,210 --> 00:22:03,740
if you have a way for someone to report
those things

344
00:22:03,740 --> 00:22:08,750
they will if you make it part of the
game they will walk to report that

345
00:22:08,750 --> 00:22:12,899
they want those gift cards they want
those those little things that make them

346
00:22:12,899 --> 00:22:14,190
more important in there

347
00:22:14,190 --> 00:22:18,740
organization and if you make it easy the
key to this

348
00:22:18,740 --> 00:22:22,100
whole thing is making the easy if you

349
00:22:22,100 --> 00:22:25,809
right now do not have security at
company not Kong

350
00:22:25,809 --> 00:22:31,490
for spam it's after company not come
you're not making it easy and if you do

351
00:22:31,490 --> 00:22:35,750
and all it is is a is a folder in some
security guys like

352
00:22:35,750 --> 00:22:40,419
in Boston ever gets like that you're
also making it part of the problem

353
00:22:40,419 --> 00:22:45,789
so 0

354
00:22:45,789 --> 00:22:49,070
real quick rules real awesome story
about that

355
00:22:49,070 --> 00:22:52,269
so we're doing a princess one-time and

356
00:22:52,269 --> 00:22:55,309
I we send 'em a bunch to these phishing
emails in

357
00:22:55,309 --> 00:22:56,080
and

358
00:22:56,080 --> 00:22:59,820
and one of the guys clicked on an

359
00:22:59,820 --> 00:23:04,059
summit is username/password but we
didn't get any code execution

360
00:23:04,059 --> 00:23:08,880
so we got all these passwords used and
passwords

361
00:23:08,880 --> 00:23:12,500
we're able to log into the their OWA but

362
00:23:12,500 --> 00:23:16,559
not a single execution came out so we
got as one guy's email

363
00:23:16,559 --> 00:23:21,279
and he had sent and he wants an email to
us the security team

364
00:23:21,279 --> 00:23:24,669
same is this legit this looks like

365
00:23:24,669 --> 00:23:27,860
you know a fishy no and they didn't send
anything back

366
00:23:27,860 --> 00:23:31,299
so we sent something back we said

367
00:23:31,299 --> 00:23:35,649
yes it is please click and run it five
minutes later

368
00:23:35,649 --> 00:23:40,830
we got to an execution it was awesome so
if your security program does not have a

369
00:23:40,830 --> 00:23:41,690
response

370
00:23:41,690 --> 00:23:45,850
a human response then

371
00:23:45,850 --> 00:23:52,389
your partner from everyone knows is on

372
00:23:52,389 --> 00:23:55,539
this is my favorite gonna believe all
time I get

373
00:23:55,539 --> 00:23:58,789
excited when I see this hands down

374
00:23:58,789 --> 00:24:03,880
the less for ability all-time in
Microsoft makes a default all the way up

375
00:24:03,880 --> 00:24:04,990
to win is 8.1

376
00:24:04,990 --> 00:24:08,120
water bodies there

377
00:24:08,120 --> 00:24:11,909
the check marks automatically configure
proxy settings

378
00:24:11,909 --> 00:24:15,600
guess know that means

379
00:24:15,600 --> 00:24:19,639
anyone on that network that names their
computer W dad

380
00:24:19,639 --> 00:24:23,139
that's my computer name and I think most
to yours as well

381
00:24:23,139 --> 00:24:26,250
you name your computer W Pat just what
happens

382
00:24:26,250 --> 00:24:29,350
windows will automatically say don't add

383
00:24:29,350 --> 00:24:34,010
he's giving right roxie settings and my
group sessions as

384
00:24:34,010 --> 00:24:41,620
okay here you go

385
00:24:41,620 --> 00:24:43,679
it's very easy to defend against this

386
00:24:43,679 --> 00:24:48,140
very easy in I had no idea why I'm
organizations don't

387
00:24:48,140 --> 00:24:52,000
the simple ways nor out w hat

388
00:24:52,000 --> 00:24:55,409
also had a you had %uh we've had

389
00:24:55,409 --> 00:24:59,080
for ipv6 you can disable that BIOS

390
00:24:59,080 --> 00:25:03,929
that's a great one by our anyone heard
of NB NS

391
00:25:03,929 --> 00:25:07,059
by last name servers this is also a
great one

392
00:25:07,059 --> 00:25:10,490
if you disable that last complete the
reorganization unless you have Windows

393
00:25:10,490 --> 00:25:11,929
98 still going

394
00:25:11,929 --> 00:25:16,909
you'll be fine how many organizations is
a room want to admit there

395
00:25:16,909 --> 00:25:20,230
windows ninety-eight going here

396
00:25:20,230 --> 00:25:26,330
yeah I it's also free

397
00:25:26,330 --> 00:25:30,000
to solve this problem haven't seen s
this one

398
00:25:30,000 --> 00:25:33,539
everybody doesn't believe me on this is
funny

399
00:25:33,539 --> 00:25:41,019
so DNS turn it of in your organization
you can literally turn

400
00:25:41,019 --> 00:25:44,230
DNS of you can say hey

401
00:25:44,230 --> 00:25:47,360
if it's not Active Directory

402
00:25:47,360 --> 00:25:52,760
DNS don't lower through there's no
reason why

403
00:25:52,760 --> 00:25:59,970
your end-user knees tipping Google and
it resolved your proxy

404
00:25:59,970 --> 00:26:05,090
and allow that resolution happen so if
you have a internal proxy

405
00:26:05,090 --> 00:26:08,799
what and you can't be transparent that's
the one thing it has to be

406
00:26:08,799 --> 00:26:09,779
non-transparent

407
00:26:09,779 --> 00:26:14,639
fewer if you have a proxy and you should
your prosecute you all that resolution

408
00:26:14,639 --> 00:26:19,190
now I stand behind this one because

409
00:26:19,190 --> 00:26:23,330
I I went to an organization to work and

410
00:26:23,330 --> 00:26:28,909
I was going on to a red team and I was I
i thought i was hot crack II was awesome

411
00:26:28,909 --> 00:26:32,279
because I came in that red team like a
look at this new

412
00:26:32,279 --> 00:26:35,580
DNS based Trojan I got it talks

413
00:26:35,580 --> 00:26:39,070
all DNS normal ever see it Iran

414
00:26:39,070 --> 00:26:43,269
inside the organization and guess what
he did nothin

415
00:26:43,269 --> 00:26:46,470
it did absolutely nothing because it
couldn't get out

416
00:26:46,470 --> 00:26:51,000
they had no idea how to do resolution
and there are more and more and more

417
00:26:51,000 --> 00:26:55,270
more backdoors Trojan viruses or what
everyone calling

418
00:26:55,270 --> 00:26:58,540
doing DNS these days for their
command-and-control

419
00:26:58,540 --> 00:27:04,060
you have DNS turned off it it takes the
entire field

420
00:27:04,060 --> 00:27:10,510
I'm badness out I'm play cool stuff so
far

421
00:27:10,510 --> 00:27:14,000
okay toll-free how many people come up
to

422
00:27:14,000 --> 00:27:17,540
like you at a at a vendor place or or

423
00:27:17,540 --> 00:27:20,890
car speakers and say all of my solutions
are free fear

424
00:27:20,890 --> 00:27:25,390
good are saying tell the

425
00:27:25,390 --> 00:27:30,080
actually tried to present in our say and
they didn't accept me and there's like

426
00:27:30,080 --> 00:27:35,710
why are you talking about free stuff so

427
00:27:35,710 --> 00:27:39,180
I'm this when I'm stealing from Chris
Chris Cason

428
00:27:39,180 --> 00:27:43,100
and anchors nickerson from Laura's this

429
00:27:43,100 --> 00:27:46,160
the slide is amazing if you don't have
this

430
00:27:46,160 --> 00:27:51,240
in your dictionary then you're not
endorsing correctly because

431
00:27:51,240 --> 00:27:55,790
one of those will work every single
organization

432
00:27:55,790 --> 00:27:59,630
I and probably some %uh view in this
crowd like that my password

433
00:27:59,630 --> 00:28:03,250
this works somewhere

434
00:28:03,250 --> 00:28:06,860
at least one account in your
organization as this right now

435
00:28:06,860 --> 00:28:10,720
so how

436
00:28:10,720 --> 00:28:14,400
on earth do you dump your own houses had
how do you how do you do pasture

437
00:28:14,400 --> 00:28:15,530
management or at least

438
00:28:15,530 --> 00:28:21,280
like how do you handle users selecting
bad passwords for everything including

439
00:28:21,280 --> 00:28:24,840
or a girl can Oracle accounts like sis
sis

440
00:28:24,840 --> 00:28:28,380
or database accounts

441
00:28:28,380 --> 00:28:33,950
essay blink we need to do is do

442
00:28:33,950 --> 00:28:37,290
arm password auditing on all of that

443
00:28:37,290 --> 00:28:40,930
how do you do it your pen testers
involved

444
00:28:40,930 --> 00:28:45,280
I guarantee any pen tester the coming up
to you new p.m. in the give your for any

445
00:28:45,280 --> 00:28:46,060
say at the end

446
00:28:46,060 --> 00:28:49,150
pay could you do a password on it
they're gonna be like

447
00:28:49,150 --> 00:28:52,820
yeah okay is always a crazy

448
00:28:52,820 --> 00:28:55,830
like that is we we take your password
like

449
00:28:55,830 --> 00:28:58,170
yes give us all a min

450
00:28:58,170 --> 00:29:01,140
and you're like really don't want to

451
00:29:01,140 --> 00:29:04,230
I'm so

452
00:29:04,230 --> 00:29:07,950
but honestly getting off on the Joe arm

453
00:29:07,950 --> 00:29:12,150
your pen tester your rating/review
people who are doing that

454
00:29:12,150 --> 00:29:15,710
will jump at the chance to help you
audit those passwords

455
00:29:15,710 --> 00:29:20,530
after the penthouse is done just

456
00:29:20,530 --> 00:29:23,700
say hey I'll let you are my domain
controller

457
00:29:23,700 --> 00:29:27,470
don't the hashes tell us like let me
know what accounts you

458
00:29:27,470 --> 00:29:31,320
you can crack in 15-20 minutes and they
will walk it out and and

459
00:29:31,320 --> 00:29:34,320
I'm resetting tell the users that saddam

460
00:29:34,320 --> 00:29:39,070
so John rippers a great one rock you

461
00:29:39,070 --> 00:29:44,110
do that on this when I don't really talk
about too often

462
00:29:44,110 --> 00:29:49,310
or are too much because if you're at the
point in your organization where your

463
00:29:49,310 --> 00:29:52,760
were you thinking about honeypots you
are we

464
00:29:52,760 --> 00:29:55,890
the way in trying to gain but

465
00:29:55,890 --> 00:30:00,510
if you do want to talk to your caso
about honey pots and

466
00:30:00,510 --> 00:30:04,860
I'm see XO honeypots normally they're
like you wanna put abort abort system in

467
00:30:04,860 --> 00:30:05,450
our network

468
00:30:05,450 --> 00:30:09,470
and you usually get lacked out the door

469
00:30:09,470 --> 00:30:12,970
what are the ways that i've seen places
arm

470
00:30:12,970 --> 00:30:16,090
do this though is on their printer

471
00:30:16,090 --> 00:30:19,340
they set up a port for the National says

472
00:30:19,340 --> 00:30:22,560
hey if you're coming into my main web
server

473
00:30:22,560 --> 00:30:27,110
and my name answers only port 80 because
all it is is news about stuff

474
00:30:27,110 --> 00:30:30,530
I don't really care about other stuff if
you're coming into it over SSL

475
00:30:30,530 --> 00:30:33,710
443 iMac I will

476
00:30:33,710 --> 00:30:37,600
port forwarded out to a limo or or
another bps

477
00:30:37,600 --> 00:30:40,870
and have that running like an old
version of Word Press

478
00:30:40,870 --> 00:30:46,310
now the bag I think that they're hitting
your main web server SSL

479
00:30:46,310 --> 00:30:50,510
but they're actually hitting some DPS
somewhere and you never have to

480
00:30:50,510 --> 00:30:53,550
let your organization be compromised or

481
00:30:53,550 --> 00:31:01,110
put a viable system anywhere near

482
00:31:01,110 --> 00:31:02,460
had alright

483
00:31:02,460 --> 00:31:06,150
so wish we blocked although the DNS
problems

484
00:31:06,150 --> 00:31:09,960
we've blocked all a little memory
corruption problems we blocked all the

485
00:31:09,960 --> 00:31:11,070
Java problems

486
00:31:11,070 --> 00:31:16,400
what about all your users that still go
through the proctor

487
00:31:16,400 --> 00:31:19,450
go through a proxy in all the domains
that are bad

488
00:31:19,450 --> 00:31:22,900
in all the the

489
00:31:22,900 --> 00:31:26,700
now where that is proxy where well

490
00:31:26,700 --> 00:31:30,090
authenticated splash proxies

491
00:31:30,090 --> 00:31:33,490
are one solution to that now

492
00:31:33,490 --> 00:31:37,690
what is an authenticator splash proxy
the 10

493
00:31:37,690 --> 00:31:42,640
vindicated splash proxy so thick it is
flashed Rossi basically

494
00:31:42,640 --> 00:31:46,770
is is a proxy that you have to
authenticate to you

495
00:31:46,770 --> 00:31:51,160
has a special splash page on every
single day may not show you in a second

496
00:31:51,160 --> 00:31:51,940
how that works

497
00:31:51,940 --> 00:31:56,860
but if you have if you have

498
00:31:56,860 --> 00:32:00,060
I'm a requirement for

499
00:32:00,060 --> 00:32:03,820
authentication please

500
00:32:03,820 --> 00:32:06,860
please please please don't make it
automatic

501
00:32:06,860 --> 00:32:10,520
if you make the proxy take

502
00:32:10,520 --> 00:32:15,900
in T-lam or base of vacation or any
other authentication that when news can

503
00:32:15,900 --> 00:32:16,950
you automatically

504
00:32:16,950 --> 00:32:21,290
so can I i if you're

505
00:32:21,290 --> 00:32:25,210
proxy can take authentication
automatically so can the attacker

506
00:32:25,210 --> 00:32:28,580
it's literally one line of code insider
see

507
00:32:28,580 --> 00:32:31,650
to make it happen you can say use cash
credentials

508
00:32:31,650 --> 00:32:38,789
done and I'll do it

509
00:32:38,789 --> 00:32:42,279
so make it making a web for make it
something username/password

510
00:32:42,279 --> 00:32:46,520
begin this is what I mean by indicate a
splash proxy

511
00:32:46,520 --> 00:32:49,860
the one sure thing K have a

512
00:32:49,860 --> 00:32:54,270
little splash page like this and the
splash page does something important

513
00:32:54,270 --> 00:32:57,890
it actually creates a domain

514
00:32:57,890 --> 00:33:01,380
white blacklist so you can stay

515
00:33:01,380 --> 00:33:05,179
first-person into work goes to Google
dot com in the get this

516
00:33:05,179 --> 00:33:10,120
and says a do you want to allow this for
the entire company

517
00:33:10,120 --> 00:33:14,330
most people will shy away from that

518
00:33:14,330 --> 00:33:18,230
very quickly if they're like on facebook
in there like you want to allow this for

519
00:33:18,230 --> 00:33:20,260
the entire company

520
00:33:20,260 --> 00:33:24,010
in no going to

521
00:33:24,010 --> 00:33:27,700
pornhub dot com join allow this from the
entire company

522
00:33:27,700 --> 00:33:29,100
mean

523
00:33:29,100 --> 00:33:33,160
no so out on this you actually get a

524
00:33:33,160 --> 00:33:36,780
awesome intelligence well Chris might do
about whether

525
00:33:36,780 --> 00:33:40,049
I'm you get off in IntelliJ you get to
know

526
00:33:40,049 --> 00:33:44,490
whose actually unlocking these things
you're getting a dynamic

527
00:33:44,490 --> 00:33:48,860
domain block list automatically set by
love your users

528
00:33:48,860 --> 00:33:53,350
now will NEC to on the planet know how
to use this

529
00:33:53,350 --> 00:34:00,940
especially if its flash not a chance the
great thing is if you

530
00:34:00,940 --> 00:34:04,700
as you cook the unblock button its read
it looks like a bad thing

531
00:34:04,700 --> 00:34:11,369
it's psychologically freaking your users
out you have the block button

532
00:34:11,369 --> 00:34:16,659
actually doesn't know really do anything
you not allowing your users to say

533
00:34:16,659 --> 00:34:20,619
block all this right so it's just people
see you on that side

534
00:34:20,619 --> 00:34:23,950
but how do you do that like how

535
00:34:23,950 --> 00:34:27,020
how often do you remove everything

536
00:34:27,020 --> 00:34:31,149
so when the company that I work for that
actually had this this list was

537
00:34:31,149 --> 00:34:36,260
refresh every day now going into work
and having to click

538
00:34:36,260 --> 00:34:39,490
unblock every single time you wanna go
to Google or or

539
00:34:39,490 --> 00:34:42,830
anything like that sucks but if this is
an

540
00:34:42,830 --> 00:34:46,200
company-wide this that makes it much
more manageable

541
00:34:46,200 --> 00:34:50,359
so song goes in and says hey unblock
Google then good luck trying to block

542
00:34:50,359 --> 00:34:51,100
for everyone

543
00:34:51,100 --> 00:34:54,899
then someone goes in and says I'm on
facebook the first one

544
00:34:54,899 --> 00:34:59,300
now at the organization I work four
hours daily

545
00:34:59,300 --> 00:35:02,830
thats lil little too much for some
people

546
00:35:02,830 --> 00:35:06,020
they don't want to to hinder stuff

547
00:35:06,020 --> 00:35:09,470
all the great thing about this is that
it blocks ads to

548
00:35:09,470 --> 00:35:14,270
automatically my arm the organization I
work for

549
00:35:14,270 --> 00:35:17,940
I'm recently actually put this in place

550
00:35:17,940 --> 00:35:21,070
for I'm every month

551
00:35:21,070 --> 00:35:24,440
so this block this gets completely wiped
out every month

552
00:35:24,440 --> 00:35:31,039
and you awesome status is on it cool
stuff

553
00:35:31,039 --> 00:35:36,279
rare and okay well this is where
everybody like actually starts

554
00:35:36,279 --> 00:35:40,950
having fun so these are the evil
canaries honey pots are hard

555
00:35:40,950 --> 00:35:44,960
honeypots you have to monitor her honey
pot you have to look through and analyze

556
00:35:44,960 --> 00:35:50,599
evil canaries you know so all of these
are ways that me or

557
00:35:50,599 --> 00:35:53,979
friend that has told me the story have
gotten cut

558
00:35:53,979 --> 00:35:58,700
now how many 10 testers you know that
tell you exactly how they got caught

559
00:35:58,700 --> 00:36:01,930
right

560
00:36:01,930 --> 00:36:06,509
I'm so domain user domain admin temp

561
00:36:06,509 --> 00:36:09,660
so I was rrrr pen test in

562
00:36:09,660 --> 00:36:14,039
we get on got in and the I got a list a
domain users and we like

563
00:36:14,039 --> 00:36:17,519
domain admin temp awesome and then in
the

564
00:36:17,519 --> 00:36:21,989
in the the description it said here's
the password for domain and in 10

565
00:36:21,989 --> 00:36:26,809
John I N game over I'm done with his pen
this first day

566
00:36:26,809 --> 00:36:30,729
tried logging into it again

567
00:36:30,729 --> 00:36:34,900
again again tried logging in like 10
times nothing was going on

568
00:36:34,900 --> 00:36:39,589
nothing worked because its long hours in
windows and actor-director set to 0

569
00:36:39,589 --> 00:36:42,660
it could not login any point in the day

570
00:36:42,660 --> 00:36:47,569
it said active I looked in the domain
account was active

571
00:36:47,569 --> 00:36:52,079
was not locked out so I tried logging in
more and the two main

572
00:36:52,079 --> 00:36:59,850
the actual demand in guys and security
guys were over in a corner gone

573
00:36:59,850 --> 00:37:00,290
I

574
00:37:00,290 --> 00:37:03,710
the second one really pissed me off
though so I was

575
00:37:03,710 --> 00:37:08,800
I was doing the pen test when are look I
found the share called password audits

576
00:37:08,800 --> 00:37:12,830
pic year gain on

577
00:37:12,830 --> 00:37:16,310
and then I was allowed into the share

578
00:37:16,310 --> 00:37:19,600
so I went into the share and there was
this bigness a

579
00:37:19,600 --> 00:37:22,920
Excel document formation Mike game over
I got

580
00:37:22,920 --> 00:37:27,460
double clicked it nothing happened okay

581
00:37:27,460 --> 00:37:30,630
try to download it nothing happens
actress died

582
00:37:30,630 --> 00:37:34,880
when you mean access denied and local
admin house in taxes 9

583
00:37:34,880 --> 00:37:39,530
copy again well in Windows if you put it
in I'm rule on a

584
00:37:39,530 --> 00:37:42,610
it overrides any of the nikkei are real
rule on it

585
00:37:42,610 --> 00:37:46,010
so how many times

586
00:37:46,010 --> 00:37:49,350
just as a guess how many times you think
I could come into being

587
00:37:49,350 --> 00:37:52,670
here probably a thousand times

588
00:37:52,670 --> 00:37:56,490
so again the security guy in the corners
on her

589
00:37:56,490 --> 00:38:02,200
because every time that I tried to
access that file they had one ruin

590
00:38:02,200 --> 00:38:05,310
in place that said if I listen 10

591
00:38:05,310 --> 00:38:09,160
file access attempted log directly to
this

592
00:38:09,160 --> 00:38:13,930
the Security Manager because no one
should ever be cooking on that

593
00:38:13,930 --> 00:38:17,200
so they said it and for got it

594
00:38:17,200 --> 00:38:20,490
they just let it go in and

595
00:38:20,490 --> 00:38:24,390
never had to worry about it never had
even think about it past the one time

596
00:38:24,390 --> 00:38:25,840
they had to set up those rules

597
00:38:25,840 --> 00:38:29,570
secular third one

598
00:38:29,570 --> 00:38:33,380
I was was a backup database

599
00:38:33,380 --> 00:38:37,110
that had an out-of-date my sequel on
Windows

600
00:38:37,110 --> 00:38:40,810
know if anybody knows about my sig along
windows basically that's

601
00:38:40,810 --> 00:38:44,930
that's gold that's game over Penn test
done because

602
00:38:44,930 --> 00:38:48,380
on Windows the plugin directory for my
sequels usually

603
00:38:48,380 --> 00:38:51,860
completely unguarded so you can load up

604
00:38:51,860 --> 00:38:57,210
any kind a plug in any kind of deal all
you want so as soon as I saw that I was

605
00:38:57,210 --> 00:38:57,600
like

606
00:38:57,600 --> 00:39:00,900
awesome game over so I logged in

607
00:39:00,900 --> 00:39:04,220
authentication work great

608
00:39:04,220 --> 00:39:06,550
butted didn't give me any kind of
problems

609
00:39:06,550 --> 00:39:10,090
Mike it just logged in and dropped back
to my shell might

610
00:39:10,090 --> 00:39:14,440
okay that was weird tried logging in
again back to the prompt

611
00:39:14,440 --> 00:39:19,470
what happened so I tried logging in
again and again and again and trying to

612
00:39:19,470 --> 00:39:20,360
figure this thing out

613
00:39:20,360 --> 00:39:25,670
and kept trying to login what happened
was the Security admin had set this up

614
00:39:25,670 --> 00:39:27,570
on just a a Raspberry Pi

615
00:39:27,570 --> 00:39:32,850
are not apply our on a Windows VM and
removed the DLL

616
00:39:32,850 --> 00:39:37,810
for the authentication peace so this was
just a

617
00:39:37,810 --> 00:39:41,150
my single box just running out there
with the

618
00:39:41,150 --> 00:39:44,180
the deal well that was needed for
authentication or are going faster than

619
00:39:44,180 --> 00:39:45,520
occasion of

620
00:39:45,520 --> 00:39:49,250
so no one could ever log into this thing
successfully so what he did was

621
00:39:49,250 --> 00:39:54,530
he logged every 10 to login and send it
directly to the security manager

622
00:39:54,530 --> 00:39:57,970
set it and forget it that's one of the
cool things about

623
00:39:57,970 --> 00:40:01,780
evil carries like you just put these
things in place in every contest urs

624
00:40:01,780 --> 00:40:04,010
less attacker on the planet will go
after them

625
00:40:04,010 --> 00:40:08,000
with a hunger are

626
00:40:08,000 --> 00:40:11,150
this was funny out I web developer

627
00:40:11,150 --> 00:40:14,680
thought it was hilarious that he made
all of his

628
00:40:14,680 --> 00:40:17,690
all the custom scanners like Nick towing
and

629
00:40:17,690 --> 00:40:22,550
action action all over the web scanners
reply with a 402

630
00:40:22,550 --> 00:40:25,790
basically means is like pay me

631
00:40:25,790 --> 00:40:28,860
if you want to break into my web
application need to pay me

632
00:40:28,860 --> 00:40:33,480
it was really knowing I

633
00:40:33,480 --> 00:40:37,310
through the great thing about this with
a specific age the Access file that did

634
00:40:37,310 --> 00:40:37,770
this

635
00:40:37,770 --> 00:40:41,580
was that it correlated all the attempts
and said

636
00:40:41,580 --> 00:40:45,720
a this looks like nickel and send it off
the IP address and everything off to the

637
00:40:45,720 --> 00:40:46,750
security manager

638
00:40:46,750 --> 00:40:50,880
so obviously I was caught

639
00:40:50,880 --> 00:40:55,280
anyone ever been to get credit card
numbers dot com

640
00:40:55,280 --> 00:40:59,670
everybody's like I'm not admitting that

641
00:40:59,670 --> 00:41:04,079
I am so it's actually a great website
that generates fake numbers for you to

642
00:41:04,079 --> 00:41:04,650
use

643
00:41:04,650 --> 00:41:08,599
in test data so this one organization

644
00:41:08,599 --> 00:41:12,420
took their payment processing database

645
00:41:12,420 --> 00:41:16,950
this big honking clustered system and
put one

646
00:41:16,950 --> 00:41:20,430
extra database name in there they put
credit card numbers

647
00:41:20,430 --> 00:41:23,980
as the databaseName now every other
thing

648
00:41:23,980 --> 00:41:27,930
every single other database in that
database error in that

649
00:41:27,930 --> 00:41:31,980
whatever computer had

650
00:41:31,980 --> 00:41:36,089
credit card numbers but this one like
real credit card numbers this one was

651
00:41:36,089 --> 00:41:37,380
called credit card numbers

652
00:41:37,380 --> 00:41:41,299
too soon as I got access the credit card
processing database I was like cool

653
00:41:41,299 --> 00:41:45,510
when we looked OK ZX 501 whatever is
that like

654
00:41:45,510 --> 00:41:49,640
I have no idea what these are 0 credit
card numbers

655
00:41:49,640 --> 00:41:53,029
that's the 1i want so I

656
00:41:53,029 --> 00:41:56,390
as soon as I access that credit card
number database I saw a bunch a credit

657
00:41:56,390 --> 00:41:58,930
card numbers that were generated by the
stupid website

658
00:41:58,930 --> 00:42:03,230
logged in like game over cent of the
report

659
00:42:03,230 --> 00:42:06,319
security admins like

660
00:42:06,319 --> 00:42:09,849
thanks to report credit card numbers on

661
00:42:09,849 --> 00:42:13,069
where'd you get a up yeah great

662
00:42:13,069 --> 00:42:16,720
we saw you and we learned on UN

663
00:42:16,720 --> 00:42:25,390
and and those aren't real credit card
numbers so I'm

664
00:42:25,390 --> 00:42:29,109
anyone ever use a June 1st VPN even use
it

665
00:42:29,109 --> 00:42:33,570
yes so this there is the the website for

666
00:42:33,570 --> 00:42:37,050
is pretty basic it's like username
password or PIN code and password

667
00:42:37,050 --> 00:42:41,340
and and stuff like that well normally I

668
00:42:41,340 --> 00:42:45,140
things mostly through burr and I look at
how they work so that I can try and

669
00:42:45,140 --> 00:42:46,690
figure out other things around

670
00:42:46,690 --> 00:42:50,750
so I put I access to this juniper
firewall or this year

671
00:42:50,750 --> 00:42:55,070
re p.m. through bourbon saw username
default username/password

672
00:42:55,070 --> 00:42:59,530
so unlike I just found the default user
and password for all juniper fire

673
00:42:59,530 --> 00:43:05,750
for VBS yes no what actually happened
was the HTML source for that page

674
00:43:05,750 --> 00:43:09,780
was edited by the EPA an admin to catch
bad guys

675
00:43:09,780 --> 00:43:12,920
so as soon as you are able to log into
that like it was

676
00:43:12,920 --> 00:43:17,500
actual user name password that you can
use soon as you are in the gene for VPN

677
00:43:17,500 --> 00:43:22,570
didn't give you access to anything it on
an accurate the security a

678
00:43:22,570 --> 00:43:27,460
manager and I was caught by they're like
block IP is automatically done

679
00:43:27,460 --> 00:43:31,410
Mike 00 all over so

680
00:43:31,410 --> 00:43:35,530
that piss me off yet

681
00:43:35,530 --> 00:43:38,089
I am

682
00:43:38,089 --> 00:43:41,940
in this one this one was really annoying
so we set of fish

683
00:43:41,940 --> 00:43:47,599
in fishy no after this I organization we
had another guy doing web applications

684
00:43:47,599 --> 00:43:50,759
so we set of the fish got 10

685
00:43:50,759 --> 00:43:54,059
and username password for this
organization and we're like

686
00:43:54,059 --> 00:43:57,249
yes we're winning we didn't get any code
execution

687
00:43:57,249 --> 00:44:01,619
you know what web application guy said
he found a place that you can log into

688
00:44:01,619 --> 00:44:03,390
the domain using the revocation

689
00:44:03,390 --> 00:44:07,410
like awesome let's try out these using
password: see if they work

690
00:44:07,410 --> 00:44:11,579
we tried it out it's it's s okay cool
that one works

691
00:44:11,579 --> 00:44:15,599
tried it out so this success awesome
that works we tried

692
00:44:15,599 --> 00:44:19,109
all ten of those and saw if those using
password worked

693
00:44:19,109 --> 00:44:22,180
and then we try to 11th one

694
00:44:22,180 --> 00:44:26,729
just to see you know guess if five
minutes ten minutes something I can see

695
00:44:26,729 --> 00:44:28,709
there's two in smoke I'm

696
00:44:28,709 --> 00:44:32,160
if the user and password

697
00:44:32,160 --> 00:44:35,479
and that would work too is like way

698
00:44:35,479 --> 00:44:38,729
okay let's try I'll one more astrid

699
00:44:38,729 --> 00:44:43,380
bobbitt you know and in the past and Bob
that one successful to

700
00:44:43,380 --> 00:44:47,009
how did that work so what it

701
00:44:47,009 --> 00:44:50,650
when it happened was that do me the the
web application guide treated

702
00:44:50,650 --> 00:44:54,539
a page that said you know here's how to
log into the main

703
00:44:54,539 --> 00:44:59,779
and every single one those fishing I
using

704
00:44:59,779 --> 00:45:03,170
passwords that we had were automatically
disabled

705
00:45:03,170 --> 00:45:06,529
by that revocation when I used

706
00:45:06,529 --> 00:45:09,839
so yes you can manipulate that if you
knew how to use it

707
00:45:09,839 --> 00:45:14,109
if she knew that that's what he did but
we didn't know how what it was doing

708
00:45:14,109 --> 00:45:17,410
and we're caught like instantly because
the

709
00:45:17,410 --> 00:45:21,989
they'd found although the the I user
names and passwords in with fish

710
00:45:21,989 --> 00:45:25,519
they found the fish that we use because
the they trace it all back

711
00:45:25,519 --> 00:45:29,799
and we're we're game over before even
got to use those using passers once

712
00:45:29,799 --> 00:45:32,500
so

713
00:45:32,500 --> 00:45:36,000
on while that was loud I so

714
00:45:36,000 --> 00:45:40,630
there was another one where there is a
machine this machine was listening on

715
00:45:40,630 --> 00:45:44,690
on 23 everyone knows a 23 is telnet

716
00:45:44,690 --> 00:45:48,630
so is this 923 I'm and

717
00:45:48,630 --> 00:45:51,740
as soon as anyone talk to that thing on
423

718
00:45:51,740 --> 00:45:55,960
it automatically alert its own because
any any faulty CB connection

719
00:45:55,960 --> 00:45:59,319
this is actually story from the team I'm
on I'm

720
00:45:59,319 --> 00:46:03,780
where we're caught by this and

721
00:46:03,780 --> 00:46:08,410
I'm because we're caught because the the
guy was so great we actually hired him

722
00:46:08,410 --> 00:46:09,150
onto the ready

723
00:46:09,150 --> 00:46:12,640
better to have a

724
00:46:12,640 --> 00:46:16,230
a colleague in an adversary someone like
that

725
00:46:16,230 --> 00:46:19,410
so finally I

726
00:46:19,410 --> 00:46:22,839
those are off on those are all how
unique are those are all things that you

727
00:46:22,839 --> 00:46:23,980
can set it and forget

728
00:46:23,980 --> 00:46:27,300
right but one of the things that we we

729
00:46:27,300 --> 00:46:32,310
we do too much for getting is at the
helpdesk usually knows more than we do a

730
00:46:32,310 --> 00:46:33,280
security guys

731
00:46:33,280 --> 00:46:36,940
the helpdesk is usually the people who
get all the stupid calls

732
00:46:36,940 --> 00:46:41,700
but fishy know about about their
passwords being used in faces

733
00:46:41,700 --> 00:46:46,300
are about him being disabled and we
rarely rarely rarely talk to the secure

734
00:46:46,300 --> 00:46:47,540
the helpdesk about

735
00:46:47,540 --> 00:46:52,190
I what they're seeing what they are

736
00:46:52,190 --> 00:46:55,829
you know you're experiencing high
volumes and calls because a

737
00:46:55,829 --> 00:47:00,170
XYZ so let's stop leaving them out of
the loop

738
00:47:00,170 --> 00:47:03,940
let's use the Help Desk as part of our
security infrastructure

739
00:47:03,940 --> 00:47:07,200
and that

740
00:47:07,200 --> 00:47:12,780
is it thank you very much and if you
want to see more about me leaving fun

741
00:47:12,780 --> 00:47:13,240
stuff there

