1
00:00:03,589 --> 00:00:10,740
hi everyone I hope you're enjoying the

2
00:00:07,859 --> 00:00:15,240
conference so far I'm really excited I

3
00:00:10,740 --> 00:00:18,570
hope I won't ruin it so I want to talk

4
00:00:15,240 --> 00:00:20,910
to you today about bike sharing services

5
00:00:18,570 --> 00:00:24,948
and I think it's a very interesting

6
00:00:20,910 --> 00:00:27,689
topic because in Zurich we've been

7
00:00:24,949 --> 00:00:31,619
having more more of those bike sharing

8
00:00:27,689 --> 00:00:34,050
services deployed and since they were

9
00:00:31,619 --> 00:00:37,489
all around the city I thought it would

10
00:00:34,050 --> 00:00:40,559
be cool to have a closer look at them

11
00:00:37,489 --> 00:00:44,370
Who am I I'm an information security

12
00:00:40,559 --> 00:00:47,399
passionate I in my free time I do some

13
00:00:44,370 --> 00:00:51,209
hobby penetration testing as is this

14
00:00:47,399 --> 00:00:55,500
project it's all done in my free time

15
00:00:51,210 --> 00:00:57,090
besides work besides family and it has

16
00:00:55,500 --> 00:00:59,640
nothing to do with my current employer

17
00:00:57,090 --> 00:01:03,510
just to let you know it's not something

18
00:00:59,640 --> 00:01:05,729
we do as a business and in my past time

19
00:01:03,510 --> 00:01:07,970
I also have bees and I've been doing

20
00:01:05,729 --> 00:01:12,119
that for about four five years and

21
00:01:07,970 --> 00:01:15,750
pretty cool hobby apart from the fact

22
00:01:12,119 --> 00:01:19,770
that you get stung from time to time so

23
00:01:15,750 --> 00:01:21,960
the motivation for this side project was

24
00:01:19,770 --> 00:01:23,610
actually so I told you no I didn't tell

25
00:01:21,960 --> 00:01:27,600
you yet but I used to work for a

26
00:01:23,610 --> 00:01:30,570
penetration testing company and I did a

27
00:01:27,600 --> 00:01:32,390
lot of great projects there it was super

28
00:01:30,570 --> 00:01:36,839
interesting but there was just one

29
00:01:32,390 --> 00:01:39,150
category of projects or technologies I

30
00:01:36,840 --> 00:01:43,229
never looked at there were mobile

31
00:01:39,150 --> 00:01:48,600
applications and so I thought I wanted

32
00:01:43,229 --> 00:01:53,100
to look a bit more into mobile apps in

33
00:01:48,600 --> 00:01:56,070
my free time and so break some apps and

34
00:01:53,100 --> 00:02:00,419
so I needed an app to test it and this

35
00:01:56,070 --> 00:02:02,008
is how I came to test the bike sharing

36
00:02:00,420 --> 00:02:09,060
services because obviously you need a

37
00:02:02,009 --> 00:02:11,730
mobile app to unlock the bikes then so

38
00:02:09,060 --> 00:02:13,480
bike sharing services in Zurich so you

39
00:02:11,730 --> 00:02:18,700
see from last

40
00:02:13,480 --> 00:02:24,630
of almost two years now we've had bikes

41
00:02:18,700 --> 00:02:27,609
that you can rent in the city there are

42
00:02:24,630 --> 00:02:29,260
different modes to rent those bikes

43
00:02:27,610 --> 00:02:32,020
most of them three of them the first

44
00:02:29,260 --> 00:02:35,459
ones are free-floating or ductless bike

45
00:02:32,020 --> 00:02:38,319
sharing services this means bikes are

46
00:02:35,459 --> 00:02:40,930
deployed all around the city and you

47
00:02:38,319 --> 00:02:43,510
need the app to locate the bike then you

48
00:02:40,930 --> 00:02:45,400
go to the bike you lock it you can ride

49
00:02:43,510 --> 00:02:48,670
and then you can leave the bike anywhere

50
00:02:45,400 --> 00:02:52,720
the one exception is the last one people

51
00:02:48,670 --> 00:02:56,798
bike which is actually the newest so it

52
00:02:52,720 --> 00:02:59,530
was deployed a month ago and this one

53
00:02:56,799 --> 00:03:01,390
you need to to get the bike from a

54
00:02:59,530 --> 00:03:04,269
station you ride it and then you need to

55
00:03:01,390 --> 00:03:07,988
put it back to a station so the first

56
00:03:04,269 --> 00:03:11,830
one smiled I will

57
00:03:07,989 --> 00:03:14,140
well actually I only had I'm only going

58
00:03:11,830 --> 00:03:18,850
to talk about two bike sharing services

59
00:03:14,140 --> 00:03:22,078
these are smart and OH bike and we'll

60
00:03:18,850 --> 00:03:25,090
look at the specifics of those bikes but

61
00:03:22,079 --> 00:03:28,989
then there's also also lime bike which

62
00:03:25,090 --> 00:03:33,459
is Californian service and as I said

63
00:03:28,989 --> 00:03:37,690
public bike which is Swiss okay so how

64
00:03:33,459 --> 00:03:39,640
do bike sharing services work so you

65
00:03:37,690 --> 00:03:43,950
need a smart phone you need to install

66
00:03:39,640 --> 00:03:46,358
an app you need to sign up either with a

67
00:03:43,950 --> 00:03:49,810
social media account like Facebook or

68
00:03:46,359 --> 00:03:52,720
Google or you can just register with

69
00:03:49,810 --> 00:03:55,000
your mobile phone number you need to buy

70
00:03:52,720 --> 00:03:58,959
credits with your credit card so you

71
00:03:55,000 --> 00:04:01,440
load some credits on it and then you're

72
00:03:58,959 --> 00:04:06,640
good to go you locate a bike on the app

73
00:04:01,440 --> 00:04:08,829
there's a map and then you can say you

74
00:04:06,640 --> 00:04:11,350
want to lease the bike you start leasing

75
00:04:08,829 --> 00:04:13,180
as long as you're riding you pay your

76
00:04:11,350 --> 00:04:15,910
fee and then at the end of your journey

77
00:04:13,180 --> 00:04:17,650
you just lock it down and for all the

78
00:04:15,910 --> 00:04:20,250
free floating services you trick you can

79
00:04:17,649 --> 00:04:23,169
just leave the bike anywhere which is

80
00:04:20,250 --> 00:04:25,450
some kind sometimes kind of a problem

81
00:04:23,169 --> 00:04:26,409
because people usually tend to leave the

82
00:04:25,450 --> 00:04:33,719
back side anywhere

83
00:04:26,410 --> 00:04:36,160
and that's not so good so what kind of

84
00:04:33,720 --> 00:04:39,240
problems could we expect from an IT

85
00:04:36,160 --> 00:04:42,340
security point of view with those bikes

86
00:04:39,240 --> 00:04:46,660
they're our first operational issues so

87
00:04:42,340 --> 00:04:48,940
I had it on the title slide you wouldn't

88
00:04:46,660 --> 00:04:51,130
steal a bike so obviously if you look at

89
00:04:48,940 --> 00:04:53,230
the security system you'd say ok I want

90
00:04:51,130 --> 00:04:54,010
to bypass the payment so you could have

91
00:04:53,230 --> 00:04:57,510
free rides

92
00:04:54,010 --> 00:05:02,099
that's one motivation you could have of

93
00:04:57,510 --> 00:05:07,260
hacking such an app then a second thing

94
00:05:02,100 --> 00:05:12,310
you would want to be prepared for is

95
00:05:07,260 --> 00:05:15,760
service downtime so if a hacker is able

96
00:05:12,310 --> 00:05:17,890
to shut down the whole system you won't

97
00:05:15,760 --> 00:05:20,710
earn any money that's bad third

98
00:05:17,890 --> 00:05:24,430
operational risk I would say is data

99
00:05:20,710 --> 00:05:26,830
protection is I mean you have subscribed

100
00:05:24,430 --> 00:05:28,900
users they all look in with their

101
00:05:26,830 --> 00:05:30,789
personal information they have financial

102
00:05:28,900 --> 00:05:33,849
information with a credit card you

103
00:05:30,790 --> 00:05:36,940
wouldn't want that data to leak then

104
00:05:33,850 --> 00:05:40,360
another type of risks you can have our

105
00:05:36,940 --> 00:05:44,169
like safety and also liability because

106
00:05:40,360 --> 00:05:47,620
the people renting those bikes will be

107
00:05:44,169 --> 00:05:50,469
on the streets they will be in traffic

108
00:05:47,620 --> 00:05:53,020
and if something happens to them because

109
00:05:50,470 --> 00:05:55,630
your bike has a malfunction then you

110
00:05:53,020 --> 00:06:01,120
will be probably liable and that's not

111
00:05:55,630 --> 00:06:05,740
so nice so all of this has a business

112
00:06:01,120 --> 00:06:09,460
impact I mean if you have if you know

113
00:06:05,740 --> 00:06:11,230
how to hack it to have free rides and

114
00:06:09,460 --> 00:06:16,390
obviously you'll have enough financial

115
00:06:11,230 --> 00:06:19,870
loss but also a reputational damage okay

116
00:06:16,390 --> 00:06:24,219
so let's go on and have a look at the

117
00:06:19,870 --> 00:06:26,950
first bike it's mine so it's a company

118
00:06:24,220 --> 00:06:28,900
based in Zurich they were originally

119
00:06:26,950 --> 00:06:30,400
backed by an insurance company and it's

120
00:06:28,900 --> 00:06:32,440
pretty interesting because the insurance

121
00:06:30,400 --> 00:06:35,830
company wanted to do some research on

122
00:06:32,440 --> 00:06:40,780
how people would use

123
00:06:35,830 --> 00:06:43,870
new mobility like immobility and like

124
00:06:40,780 --> 00:06:46,359
car sharing with vehicles that don't

125
00:06:43,870 --> 00:06:50,980
belong to them and it was kind of like a

126
00:06:46,360 --> 00:06:52,930
testbed from there for them to see or to

127
00:06:50,980 --> 00:06:57,820
analyze the behavior of people how they

128
00:06:52,930 --> 00:07:00,490
would ride the bike so the bikes they

129
00:06:57,820 --> 00:07:04,540
are renting are also it's also a Swiss

130
00:07:00,490 --> 00:07:07,600
product it's my it's Toma bikes and

131
00:07:04,540 --> 00:07:13,090
they're very high quality bikes they are

132
00:07:07,600 --> 00:07:15,040
very nice too - right there are very

133
00:07:13,090 --> 00:07:19,479
powerful bikes actually so they're a

134
00:07:15,040 --> 00:07:22,450
bikes they have a motor in it and I

135
00:07:19,480 --> 00:07:24,550
think I'm not sure how fast you can ride

136
00:07:22,450 --> 00:07:25,659
with with the smile bikes but if you

137
00:07:24,550 --> 00:07:28,480
have one of these

138
00:07:25,660 --> 00:07:33,940
slow-mo bikes I guess you can ride them

139
00:07:28,480 --> 00:07:36,280
up to 40 km/h the unit price is pretty

140
00:07:33,940 --> 00:07:38,020
high if you would want to buy such a

141
00:07:36,280 --> 00:07:41,289
bike it's like six and a half thousand

142
00:07:38,020 --> 00:07:43,270
francs approximately they have smiled

143
00:07:41,290 --> 00:07:43,720
themselves have a fleet of about 400

144
00:07:43,270 --> 00:07:46,060
bikes

145
00:07:43,720 --> 00:07:48,700
according to what you can see from the

146
00:07:46,060 --> 00:07:51,130
API but I don't know if it's reliable a

147
00:07:48,700 --> 00:07:53,170
reliable number because maybe a lot of

148
00:07:51,130 --> 00:07:56,620
bikes are in maintenance or not deployed

149
00:07:53,170 --> 00:07:59,680
at the moment and how are the bikes

150
00:07:56,620 --> 00:08:02,290
tracked they have an integrated GPS

151
00:07:59,680 --> 00:08:05,590
module and they communicate with the

152
00:08:02,290 --> 00:08:07,450
back end with the GSM modem so you can

153
00:08:05,590 --> 00:08:10,469
do fleet management with them so let's

154
00:08:07,450 --> 00:08:13,650
look a bit closer at that how that works

155
00:08:10,470 --> 00:08:17,110
so as I already mentioned the bike

156
00:08:13,650 --> 00:08:18,190
communicates with the GPS satellite so

157
00:08:17,110 --> 00:08:21,490
it knows where it is

158
00:08:18,190 --> 00:08:24,790
it also has GSM linked to the base

159
00:08:21,490 --> 00:08:26,920
station and talks directly to this might

160
00:08:24,790 --> 00:08:29,050
bike and with which does the whole fleet

161
00:08:26,920 --> 00:08:30,940
management on the other side you have a

162
00:08:29,050 --> 00:08:34,150
mobile app which also connects to the

163
00:08:30,940 --> 00:08:35,679
backend which manages all bookings or if

164
00:08:34,150 --> 00:08:38,770
you want to lock the bike if you want to

165
00:08:35,679 --> 00:08:43,510
unlock it and so on so the bikes are

166
00:08:38,770 --> 00:08:46,990
autonomous and if you were to steal them

167
00:08:43,510 --> 00:08:48,760
then you have some protections against

168
00:08:46,990 --> 00:08:54,160
that

169
00:08:48,760 --> 00:08:56,709
let me see yeah I'll see about the the

170
00:08:54,160 --> 00:09:03,610
protections afterwards so let us have a

171
00:08:56,709 --> 00:09:05,260
look at the API on the mobile side

172
00:09:03,610 --> 00:09:08,890
because I analyzed the the mobile

173
00:09:05,260 --> 00:09:10,600
application so let us this this is the

174
00:09:08,890 --> 00:09:14,620
call you're using to get all the bikes

175
00:09:10,600 --> 00:09:16,930
you just do a rest call and then you get

176
00:09:14,620 --> 00:09:19,240
a JSON response of that type so

177
00:09:16,930 --> 00:09:23,140
obviously you have a lot of more of that

178
00:09:19,240 --> 00:09:25,420
records you get an ID number you get the

179
00:09:23,140 --> 00:09:29,319
number plate of the bikes you get its

180
00:09:25,420 --> 00:09:31,719
battery level you get the approximate

181
00:09:29,320 --> 00:09:35,680
address where it is and the GPS

182
00:09:31,720 --> 00:09:38,589
coordinates so theft protection if

183
00:09:35,680 --> 00:09:44,519
somebody were to take the bike and move

184
00:09:38,589 --> 00:09:49,230
it away then this is a feature of stoma

185
00:09:44,519 --> 00:09:52,470
that the movement would be detected

186
00:09:49,230 --> 00:09:56,140
fleet management would get an alarm and

187
00:09:52,470 --> 00:09:57,339
there's might people would start and try

188
00:09:56,140 --> 00:10:01,540
to figure out where it is

189
00:09:57,339 --> 00:10:03,070
so there's another feature is like when

190
00:10:01,540 --> 00:10:05,439
you lock down the bike you don't have a

191
00:10:03,070 --> 00:10:08,430
physical lock on it but you have a the

192
00:10:05,440 --> 00:10:11,320
motor has an electronic lock that means

193
00:10:08,430 --> 00:10:14,439
that the rear wheel is actually blocked

194
00:10:11,320 --> 00:10:15,880
and you can't ride with a bike and as

195
00:10:14,440 --> 00:10:21,220
soon as you unlock the bike then you're

196
00:10:15,880 --> 00:10:22,600
free to to to ride it let's look at the

197
00:10:21,220 --> 00:10:26,170
at the booking process it's pretty

198
00:10:22,600 --> 00:10:29,110
simple so you find a bike on the left

199
00:10:26,170 --> 00:10:31,779
side it's vacant and it's locked then

200
00:10:29,110 --> 00:10:34,480
you start the booking you unlock the

201
00:10:31,779 --> 00:10:36,880
bike and then while you're riding the

202
00:10:34,480 --> 00:10:39,790
bike maybe you want to lock it but keep

203
00:10:36,880 --> 00:10:43,089
the booking because maybe you want to do

204
00:10:39,790 --> 00:10:45,490
your groceries but you want to get back

205
00:10:43,089 --> 00:10:47,829
on the bike afterwards so you have the

206
00:10:45,490 --> 00:10:49,329
ability to keep the booking and lock the

207
00:10:47,829 --> 00:10:53,260
bike and then you come back to the bike

208
00:10:49,329 --> 00:10:55,359
unlock it and and ride again so let's

209
00:10:53,260 --> 00:10:57,790
look at how this is done first of all

210
00:10:55,360 --> 00:11:00,670
you need to authenticate authentication

211
00:10:57,790 --> 00:11:03,329
is pretty simple you give in your email

212
00:11:00,670 --> 00:11:03,329
address your password

213
00:11:03,610 --> 00:11:10,820
so you have different login types if

214
00:11:06,110 --> 00:11:14,450
you're using and you call it social

215
00:11:10,820 --> 00:11:19,970
media or not I'm using here my own email

216
00:11:14,450 --> 00:11:21,830
address and then you get JSON web token

217
00:11:19,970 --> 00:11:25,130
as an answer so if you don't know how

218
00:11:21,830 --> 00:11:28,760
jason web token looks like it looks like

219
00:11:25,130 --> 00:11:32,150
that it's a series it's block subdivided

220
00:11:28,760 --> 00:11:35,210
into three parts of base64 encoded stuff

221
00:11:32,150 --> 00:11:38,120
so let me show it how it looks like so

222
00:11:35,210 --> 00:11:42,860
you have a header which tells me it's a

223
00:11:38,120 --> 00:11:49,310
JSON web token and you're using H Mac

224
00:11:42,860 --> 00:11:52,970
sha 50 12 512 to sign the assertion you

225
00:11:49,310 --> 00:11:55,310
have a user ID you have a timestamp and

226
00:11:52,970 --> 00:11:59,750
an expiration and this is kind of like a

227
00:11:55,310 --> 00:12:02,869
signed token that you can pass on for

228
00:11:59,750 --> 00:12:07,430
all the subsequent calls that identifies

229
00:12:02,870 --> 00:12:13,970
the user ok so now we have JWT token JW

230
00:12:07,430 --> 00:12:15,770
token GWT and we want to unlock them we

231
00:12:13,970 --> 00:12:20,770
want to initiate a booking so what you

232
00:12:15,770 --> 00:12:24,710
do you post on the REST API booking and

233
00:12:20,770 --> 00:12:28,189
you put in in the HTTP header you put in

234
00:12:24,710 --> 00:12:33,020
this token this auth token you say which

235
00:12:28,190 --> 00:12:35,030
bike you want to book number 133 and you

236
00:12:33,020 --> 00:12:37,460
also give in your user ID which is

237
00:12:35,030 --> 00:12:40,400
redundant because it's already and in

238
00:12:37,460 --> 00:12:42,410
the token what you get as response you

239
00:12:40,400 --> 00:12:45,110
get a booking ID as a response this is

240
00:12:42,410 --> 00:12:49,280
the booking ID you're going to use for

241
00:12:45,110 --> 00:12:51,170
every operation during your ride you

242
00:12:49,280 --> 00:12:53,300
have an active flag that says you're

243
00:12:51,170 --> 00:12:57,500
currently using your bike right now so

244
00:12:53,300 --> 00:12:59,359
it's unlocked no it's not a active it's

245
00:12:57,500 --> 00:13:00,830
a usage flag actually so now it's in

246
00:12:59,360 --> 00:13:02,480
false you have a second call where you

247
00:13:00,830 --> 00:13:04,940
can then unlock the back and then the

248
00:13:02,480 --> 00:13:08,060
active the usage flag will be set to

249
00:13:04,940 --> 00:13:10,370
true and you have some style time stamps

250
00:13:08,060 --> 00:13:12,050
ok so let's assume I'm riding the bike

251
00:13:10,370 --> 00:13:14,710
now and I want to stop by the grocery

252
00:13:12,050 --> 00:13:16,750
store and I want to lock

253
00:13:14,710 --> 00:13:19,750
I could keep the booking what I'm gonna

254
00:13:16,750 --> 00:13:21,970
do is I'm going to call the another REST

255
00:13:19,750 --> 00:13:24,010
API so we're on the booking one two

256
00:13:21,970 --> 00:13:27,820
three four five usage and then I'm going

257
00:13:24,010 --> 00:13:30,730
to set the usage to false and thereby

258
00:13:27,820 --> 00:13:34,410
telling the backends that I want to lock

259
00:13:30,730 --> 00:13:37,540
the bike and the backend tells me okay

260
00:13:34,410 --> 00:13:41,350
usage is set to false and you have a pin

261
00:13:37,540 --> 00:13:42,880
code if you weren't able to unlock the

262
00:13:41,350 --> 00:13:44,800
bike with your mobile app you could

263
00:13:42,880 --> 00:13:47,260
still use the pin code and enter it on

264
00:13:44,800 --> 00:13:51,750
the display of the bike okay so I

265
00:13:47,260 --> 00:13:58,090
thought what if I have a second user

266
00:13:51,750 --> 00:14:02,410
that uses the same booking ID and what I

267
00:13:58,090 --> 00:14:03,040
also noticed is that the booking IDs are

268
00:14:02,410 --> 00:14:06,939
sequential

269
00:14:03,040 --> 00:14:08,770
so actually you could if you have if I

270
00:14:06,940 --> 00:14:11,320
have a booking ID one two three four six

271
00:14:08,770 --> 00:14:13,150
I could go in the past one two three

272
00:14:11,320 --> 00:14:15,400
four five and get the booking ID of

273
00:14:13,150 --> 00:14:18,040
another user on the street and then tell

274
00:14:15,400 --> 00:14:25,590
him I want to lock the bike and what

275
00:14:18,040 --> 00:14:29,550
happens is it works so that's a kind of

276
00:14:25,590 --> 00:14:35,380
risk that goes into safety and health

277
00:14:29,550 --> 00:14:38,680
issues when I found this out I reported

278
00:14:35,380 --> 00:14:40,300
it to smile they didn't have a security

279
00:14:38,680 --> 00:14:43,930
contact so I just used their info

280
00:14:40,300 --> 00:14:46,030
contact I did the the report in the lady

281
00:14:43,930 --> 00:14:48,969
in the night but the same and this was a

282
00:14:46,030 --> 00:14:50,380
Saturday so in the same day during the

283
00:14:48,970 --> 00:14:51,070
same well in the afternoon of death

284
00:14:50,380 --> 00:14:56,170
Saturday

285
00:14:51,070 --> 00:14:58,570
I got a confirmation of the supporter

286
00:14:56,170 --> 00:15:00,969
and he was like okay thanks a lot we

287
00:14:58,570 --> 00:15:03,370
will have to look into it and then four

288
00:15:00,970 --> 00:15:05,230
days later I got a confirmation from the

289
00:15:03,370 --> 00:15:08,110
product owner who told me okay well

290
00:15:05,230 --> 00:15:11,050
thanks a lot for the report they already

291
00:15:08,110 --> 00:15:12,880
had fixed it on Monday and I could test

292
00:15:11,050 --> 00:15:15,040
it it was fixed so it was really cool

293
00:15:12,880 --> 00:15:17,930
they offered me 100 minutes for free

294
00:15:15,040 --> 00:15:20,930
ride and yeah

295
00:15:17,930 --> 00:15:23,149
I really enjoyed the communication they

296
00:15:20,930 --> 00:15:25,819
they took it seriously they responded

297
00:15:23,149 --> 00:15:27,670
very fast and as you will see it was not

298
00:15:25,820 --> 00:15:31,970
always the case

299
00:15:27,670 --> 00:15:35,479
okay so that was all for smile now let's

300
00:15:31,970 --> 00:15:38,060
go over to O bike o bike is another kind

301
00:15:35,480 --> 00:15:40,160
of service it's also free-floating it's

302
00:15:38,060 --> 00:15:41,989
not from Switzerland it's from Singapore

303
00:15:40,160 --> 00:15:46,069
it's employed in a lot of different

304
00:15:41,990 --> 00:15:49,459
countries and actually it's some cities

305
00:15:46,070 --> 00:15:52,550
are starting to ban all bike so munich

306
00:15:49,459 --> 00:15:54,829
and melbourne in australia are banning o

307
00:15:52,550 --> 00:15:57,920
bags because everybody leaves them

308
00:15:54,830 --> 00:16:01,570
around or puts them in the river and

309
00:15:57,920 --> 00:16:06,920
they think it's an environmental issue

310
00:16:01,570 --> 00:16:09,470
the bikes are different than smile in

311
00:16:06,920 --> 00:16:12,140
that they're super cheap they're not

312
00:16:09,470 --> 00:16:14,810
well the estimated cost is maybe two

313
00:16:12,140 --> 00:16:18,260
hundred dollars including deployment to

314
00:16:14,810 --> 00:16:22,579
the countries they have only a single

315
00:16:18,260 --> 00:16:27,529
speed so no it's not an e-bike you you

316
00:16:22,580 --> 00:16:30,110
have to to write it yourself it's

317
00:16:27,529 --> 00:16:33,290
totally maintenance-free they have solid

318
00:16:30,110 --> 00:16:35,240
rubber tires so nobody needs to go and

319
00:16:33,290 --> 00:16:37,310
and maintain the bites I mean with the

320
00:16:35,240 --> 00:16:38,930
e-bikes you always need to go after the

321
00:16:37,310 --> 00:16:41,060
bikes and replace the batteries because

322
00:16:38,930 --> 00:16:46,000
eventually they'll they'll be empty and

323
00:16:41,060 --> 00:16:50,719
if you look at the fair it's it's also a

324
00:16:46,000 --> 00:16:54,830
cost model that's way cheaper okay so

325
00:16:50,720 --> 00:16:59,360
let's look at the interfaces it's also

326
00:16:54,830 --> 00:17:02,240
much more simpler the bike itself is not

327
00:16:59,360 --> 00:17:04,579
autonomous it only has a Bluetooth

328
00:17:02,240 --> 00:17:07,880
low-energy link to the mobile app and

329
00:17:04,579 --> 00:17:09,829
actually everything more or less

330
00:17:07,880 --> 00:17:12,829
everything is done on the mobile app

331
00:17:09,829 --> 00:17:16,399
this means location tracking is the

332
00:17:12,829 --> 00:17:18,169
mobile app and communication with the

333
00:17:16,400 --> 00:17:20,689
backend is done through the mobile app

334
00:17:18,170 --> 00:17:24,500
so actually the mobile app is kind of

335
00:17:20,689 --> 00:17:26,240
like man in the middle so let's see how

336
00:17:24,500 --> 00:17:28,700
the rest interface looks like if you

337
00:17:26,240 --> 00:17:33,110
want to have a list of all the bikes

338
00:17:28,700 --> 00:17:35,750
the same as for smite you just have you

339
00:17:33,110 --> 00:17:38,659
just say which point you want to have

340
00:17:35,750 --> 00:17:41,210
the bikes then you get all bikes in a

341
00:17:38,660 --> 00:17:43,730
radius of I think about a kilometer so

342
00:17:41,210 --> 00:17:51,350
you get a whole list of them you get an

343
00:17:43,730 --> 00:17:55,610
ID you get the coordinates and so on so

344
00:17:51,350 --> 00:17:58,310
actually you can map all the bikes so

345
00:17:55,610 --> 00:18:00,649
but as you can see I mean it's the

346
00:17:58,310 --> 00:18:02,629
mobile application who's telling the

347
00:18:00,650 --> 00:18:04,130
backend where the bike is located at the

348
00:18:02,630 --> 00:18:07,850
moment when you're locking or unlocking

349
00:18:04,130 --> 00:18:10,250
the bike so how does it look like you

350
00:18:07,850 --> 00:18:11,600
put the location for a certain bike so

351
00:18:10,250 --> 00:18:14,930
you have the bike ID and the new

352
00:18:11,600 --> 00:18:17,389
coordinates and the back end tells you

353
00:18:14,930 --> 00:18:20,870
something in Chinese location report

354
00:18:17,390 --> 00:18:23,290
succeed a success that means that

355
00:18:20,870 --> 00:18:29,929
actually if we come back to this one if

356
00:18:23,290 --> 00:18:31,700
somebody was funny enough to put well he

357
00:18:29,930 --> 00:18:34,220
could like put all the bikes in the

358
00:18:31,700 --> 00:18:35,900
river and everybody would see on their

359
00:18:34,220 --> 00:18:37,580
mobile app couldn't find any any other

360
00:18:35,900 --> 00:18:40,370
bikes so you could spoof the location of

361
00:18:37,580 --> 00:18:44,260
all the bikes or if you want I mean you

362
00:18:40,370 --> 00:18:44,260
could do like ASCII art with the dots

363
00:18:46,620 --> 00:18:53,169
I'm hearing challenge accepted somewhere

364
00:18:49,950 --> 00:18:56,680
okay let us look at the hardware so I

365
00:18:53,170 --> 00:18:59,170
found those pictures on the website of

366
00:18:56,680 --> 00:19:03,160
FCC the Federal Communications

367
00:18:59,170 --> 00:19:06,490
Commission of the USA and it's pretty

368
00:19:03,160 --> 00:19:09,190
cool so to see how it's built up so this

369
00:19:06,490 --> 00:19:13,180
is the lock how it looks like when it's

370
00:19:09,190 --> 00:19:15,070
opened and what you see in the blue part

371
00:19:13,180 --> 00:19:18,220
in the middle well everything is blue

372
00:19:15,070 --> 00:19:19,899
okay but there's a pretty large battery

373
00:19:18,220 --> 00:19:21,790
inside it but you also have a solar

374
00:19:19,900 --> 00:19:24,340
panel so the solar panel recharges the

375
00:19:21,790 --> 00:19:27,370
battery you know here we can see the

376
00:19:24,340 --> 00:19:29,439
battery a bit better and then you have

377
00:19:27,370 --> 00:19:32,919
well two PCBs

378
00:19:29,440 --> 00:19:35,290
one of them has a little beeper and Ana

379
00:19:32,920 --> 00:19:40,300
knob a button push button and the other

380
00:19:35,290 --> 00:19:45,430
one has the whole mall chips on it what

381
00:19:40,300 --> 00:19:48,070
you also see in the middle is a latch or

382
00:19:45,430 --> 00:19:50,350
lever which will actually unlock the

383
00:19:48,070 --> 00:19:53,379
bike once it's so you have a little

384
00:19:50,350 --> 00:19:56,709
electrical motor it will just open the

385
00:19:53,380 --> 00:20:00,280
latch and and then the whole lock will

386
00:19:56,710 --> 00:20:03,880
fall down because of this spring well

387
00:20:00,280 --> 00:20:06,070
known well it goes up yeah well there's

388
00:20:03,880 --> 00:20:09,400
a quite neat video I think from an

389
00:20:06,070 --> 00:20:11,409
Australian guy who took a whole lock

390
00:20:09,400 --> 00:20:13,690
apart and it's just one screenshot

391
00:20:11,410 --> 00:20:17,680
because on this image you can see quite

392
00:20:13,690 --> 00:20:20,110
well you see the imprint of the of the

393
00:20:17,680 --> 00:20:24,430
trip which I couldn't see on the FCC

394
00:20:20,110 --> 00:20:27,159
images so it's the system on a chip

395
00:20:24,430 --> 00:20:31,350
that's used a main trip on the PCB is a

396
00:20:27,160 --> 00:20:37,960
Texas Instrument chip con 25:41 which is

397
00:20:31,350 --> 00:20:39,909
an system-on-a-chip specialized for

398
00:20:37,960 --> 00:20:42,430
Bluetooth low-energy communication if

399
00:20:39,910 --> 00:20:46,050
you look at the specification of the

400
00:20:42,430 --> 00:20:49,870
chip you see that it has an aes

401
00:20:46,050 --> 00:20:53,730
processor which says ok can do crypto

402
00:20:49,870 --> 00:20:57,669
and these are the different modes the

403
00:20:53,730 --> 00:21:01,870
processor can support so you see it

404
00:20:57,670 --> 00:21:06,460
can do a es 128 and it has support for

405
00:21:01,870 --> 00:21:09,760
ECBC BCC FASB CTR modes but also cbc-mac

406
00:21:06,460 --> 00:21:11,860
which I assume is used for the crypto in

407
00:21:09,760 --> 00:21:15,430
the protocol cbc-mac

408
00:21:11,860 --> 00:21:19,419
I'd say is kind of like a digital

409
00:21:15,430 --> 00:21:23,860
signature but using symmetric key so if

410
00:21:19,420 --> 00:21:28,330
anyone knows the key he can sign the

411
00:21:23,860 --> 00:21:30,370
messages okay so I had a look at the

412
00:21:28,330 --> 00:21:34,750
Bluetooth communication so between the

413
00:21:30,370 --> 00:21:38,379
lock and the mobile phone and try to

414
00:21:34,750 --> 00:21:41,440
reverse-engineer it to to see how it

415
00:21:38,380 --> 00:21:43,210
works this is the overall common

416
00:21:41,440 --> 00:21:45,580
structure you always have a preamble

417
00:21:43,210 --> 00:21:48,220
that's fixed is always the same then you

418
00:21:45,580 --> 00:21:50,290
have a length for the payload you have a

419
00:21:48,220 --> 00:21:54,220
command type you have then the payload

420
00:21:50,290 --> 00:21:56,350
and then a check byte what's interesting

421
00:21:54,220 --> 00:21:59,530
in the comment type is you can figure

422
00:21:56,350 --> 00:22:04,570
out the direction of the command so if

423
00:21:59,530 --> 00:22:09,670
the third bit yeah the third bits in the

424
00:22:04,570 --> 00:22:12,030
first nibble well you have oxh 8o x8

425
00:22:09,670 --> 00:22:14,170
it's going to be a communication or

426
00:22:12,030 --> 00:22:17,500
message from the mobile to the oh bike

427
00:22:14,170 --> 00:22:20,830
and if the bit is set right besides it

428
00:22:17,500 --> 00:22:23,200
so you have oxo or it's going to be in

429
00:22:20,830 --> 00:22:26,230
the other way also if you're interested

430
00:22:23,200 --> 00:22:28,570
to know how the trackpad is computed

431
00:22:26,230 --> 00:22:30,700
it's just by Soaring the individual

432
00:22:28,570 --> 00:22:33,340
bytes of the payload and the command

433
00:22:30,700 --> 00:22:36,160
type okay so let's have a look at the

434
00:22:33,340 --> 00:22:37,990
first message sent from the mobile phone

435
00:22:36,160 --> 00:22:39,610
to the lock to initiate the

436
00:22:37,990 --> 00:22:41,980
communication it's actually it's an

437
00:22:39,610 --> 00:22:45,129
empty message you see length is 0 there

438
00:22:41,980 --> 00:22:46,840
is no payload and obviously the check by

439
00:22:45,130 --> 00:22:49,450
it is the same as the comment because

440
00:22:46,840 --> 00:22:52,149
it's the only byte which is used in the

441
00:22:49,450 --> 00:22:55,000
checksum computation then you get a

442
00:22:52,150 --> 00:22:57,760
response from the lock which just has

443
00:22:55,000 --> 00:23:00,670
the bytes set as a response but it's

444
00:22:57,760 --> 00:23:02,980
also an anti and then T's response okay

445
00:23:00,670 --> 00:23:06,040
so the next message the mobile phone

446
00:23:02,980 --> 00:23:09,330
will send to the o bike is actually here

447
00:23:06,040 --> 00:23:12,800
are your coordinates and

448
00:23:09,330 --> 00:23:15,860
the chip will store the coordinates so

449
00:23:12,800 --> 00:23:21,389
it has some persistence so it knows

450
00:23:15,860 --> 00:23:24,419
maybe for later on where the bike was

451
00:23:21,390 --> 00:23:28,500
located so as you see what's interesting

452
00:23:24,420 --> 00:23:31,650
here is that they use one byte less for

453
00:23:28,500 --> 00:23:38,220
the latitude longitude

454
00:23:31,650 --> 00:23:40,170
well yeah but there are a lot of strange

455
00:23:38,220 --> 00:23:42,060
thing things going on but I mean it's

456
00:23:40,170 --> 00:23:44,820
it's the precision is is high enough so

457
00:23:42,060 --> 00:23:48,360
it's okay what you get back from the

458
00:23:44,820 --> 00:23:52,800
lock is you have some constants I

459
00:23:48,360 --> 00:23:54,840
couldn't make any sense out of them but

460
00:23:52,800 --> 00:23:58,110
the interesting part is this 32 bit

461
00:23:54,840 --> 00:24:01,199
challenge which is a random number which

462
00:23:58,110 --> 00:24:03,899
will be sent to the mobile phone and the

463
00:24:01,200 --> 00:24:08,430
mobile phone will send this via the REST

464
00:24:03,900 --> 00:24:10,200
API to the backend and they call that in

465
00:24:08,430 --> 00:24:14,400
the REST API the the parameter is called

466
00:24:10,200 --> 00:24:16,920
key source afterwards you get a response

467
00:24:14,400 --> 00:24:19,860
back from the backend via REST API and

468
00:24:16,920 --> 00:24:22,590
actually it's kind of like a response to

469
00:24:19,860 --> 00:24:31,379
that challenge and you also have a key

470
00:24:22,590 --> 00:24:33,949
index so the response looks like it I I

471
00:24:31,380 --> 00:24:37,950
think it's the cbc-mac

472
00:24:33,950 --> 00:24:42,480
but it's not 128 bits it's only 96 bits

473
00:24:37,950 --> 00:24:45,330
and I don't know why they just truncated

474
00:24:42,480 --> 00:24:48,360
it but I mean it should be still enough

475
00:24:45,330 --> 00:24:51,330
bits if the chip does the same

476
00:24:48,360 --> 00:24:55,770
computation and is part two to compare

477
00:24:51,330 --> 00:24:57,389
it but still there's some room for for

478
00:24:55,770 --> 00:24:59,460
randomness there and what's also

479
00:24:57,390 --> 00:25:02,310
interesting is that you always get a

480
00:24:59,460 --> 00:25:04,560
different key ID and I think from what

481
00:25:02,310 --> 00:25:06,929
I've observed there may be about hundred

482
00:25:04,560 --> 00:25:10,200
different key IDs and I think it's the

483
00:25:06,930 --> 00:25:12,030
the key that is shared between the lock

484
00:25:10,200 --> 00:25:14,700
and the backend and they just tell you

485
00:25:12,030 --> 00:25:17,010
ok I calculated the Mac with this key

486
00:25:14,700 --> 00:25:21,610
with this specific key

487
00:25:17,010 --> 00:25:24,730
okay at that point the lock opens and

488
00:25:21,610 --> 00:25:27,070
the lock generates also an acknowledged

489
00:25:24,730 --> 00:25:30,909
message which is also signed and you

490
00:25:27,070 --> 00:25:32,918
have ulka a sort of information you have

491
00:25:30,909 --> 00:25:35,409
time stamps well actually twice once

492
00:25:32,919 --> 00:25:37,600
big-endian wants little-endian you have

493
00:25:35,409 --> 00:25:41,220
a bike ID which is actually a part of

494
00:25:37,600 --> 00:25:44,559
the MAC address of the Bluetooth

495
00:25:41,220 --> 00:25:48,789
interface then you have the stored

496
00:25:44,559 --> 00:25:52,330
coordinates and then this message is has

497
00:25:48,789 --> 00:25:55,299
a cbc-mac of 128 bits with another key

498
00:25:52,330 --> 00:25:59,230
ID which will then be validated by the

499
00:25:55,299 --> 00:26:03,580
backend okay so I guess you can already

500
00:25:59,230 --> 00:26:06,870
figure out the whole security relies

501
00:26:03,580 --> 00:26:13,210
upon those shared keys which are

502
00:26:06,870 --> 00:26:15,309
actually on the chip and also on within

503
00:26:13,210 --> 00:26:18,460
the backend so it's interesting is this

504
00:26:15,309 --> 00:26:22,418
is another picture from that I taken

505
00:26:18,460 --> 00:26:26,440
from FCC you see so the chip con chip

506
00:26:22,419 --> 00:26:31,690
and above you have like five pads which

507
00:26:26,440 --> 00:26:35,049
I guess our debug pads so I asked o bike

508
00:26:31,690 --> 00:26:38,880
I requested a I did a request if they

509
00:26:35,049 --> 00:26:41,679
would be willing to give me a test lock

510
00:26:38,880 --> 00:26:44,700
because I want to look into it obviously

511
00:26:41,679 --> 00:26:48,850
with the debugger and to see if I could

512
00:26:44,700 --> 00:26:53,320
extract some of the keys but I got no

513
00:26:48,850 --> 00:26:55,689
response so time went by and I was like

514
00:26:53,320 --> 00:27:01,289
I mean I was not working always on the

515
00:26:55,690 --> 00:27:04,090
on the project but I was still regularly

516
00:27:01,289 --> 00:27:09,750
googling stuff about Oba X every time o

517
00:27:04,090 --> 00:27:14,199
bike would come in the news and I found

518
00:27:09,750 --> 00:27:16,899
interesting PDF from it's a student

519
00:27:14,200 --> 00:27:19,390
project from the new University of

520
00:27:16,899 --> 00:27:22,469
Singapore where I figured out well they

521
00:27:19,390 --> 00:27:26,470
were also looking into the OU bikes and

522
00:27:22,470 --> 00:27:28,539
they had another focus they also looked

523
00:27:26,470 --> 00:27:31,220
at the rest interface they looked a lot

524
00:27:28,539 --> 00:27:33,169
of different aspects they didn't

525
00:27:31,220 --> 00:27:35,480
the paper they didn't invest so much

526
00:27:33,169 --> 00:27:38,179
time as I did in the details of the

527
00:27:35,480 --> 00:27:41,210
Bluetooth communication and actually it

528
00:27:38,179 --> 00:27:45,400
down to me I was too deep in the details

529
00:27:41,210 --> 00:27:48,169
and they had a wonderful description of

530
00:27:45,400 --> 00:27:51,559
vulnerability which I can show you in

531
00:27:48,169 --> 00:27:55,419
the next slide so if you paid attention

532
00:27:51,559 --> 00:27:57,889
maybe you already found the problem so

533
00:27:55,419 --> 00:27:59,630
this is high-level description of the

534
00:27:57,890 --> 00:28:01,039
protocol so the oberek sends the

535
00:27:59,630 --> 00:28:03,830
challenge to the mobile app the mobile

536
00:28:01,039 --> 00:28:09,220
app sends it to the backend the back-end

537
00:28:03,830 --> 00:28:12,770
responses responds with cbc-mac

538
00:28:09,220 --> 00:28:16,940
which do bike validates at that moment

539
00:28:12,770 --> 00:28:21,129
the lock opens what you do from now on

540
00:28:16,940 --> 00:28:23,750
the lock computes an acknowledgment and

541
00:28:21,130 --> 00:28:25,580
only at the time where the backend

542
00:28:23,750 --> 00:28:32,980
receives the acknowledgement it starts

543
00:28:25,580 --> 00:28:41,799
billing so fail number two okay so

544
00:28:32,980 --> 00:28:44,210
obviously that way of doing you would

545
00:28:41,799 --> 00:28:45,950
have communication with the backend so

546
00:28:44,210 --> 00:28:50,870
that they can detect what's going on

547
00:28:45,950 --> 00:28:53,030
what happens is if the back end doesn't

548
00:28:50,870 --> 00:28:54,678
receive the acknowledgement there's some

549
00:28:53,030 --> 00:28:56,299
logic on the backend that tells you okay

550
00:28:54,679 --> 00:28:59,360
this bike must be broken because it

551
00:28:56,299 --> 00:29:01,400
haven't sent me it initiated the

552
00:28:59,360 --> 00:29:01,879
unlocking process but they didn't finish

553
00:29:01,400 --> 00:29:06,530
it

554
00:29:01,880 --> 00:29:10,789
so they flag the bike as being broken

555
00:29:06,530 --> 00:29:13,700
for 24 hours and if you think about that

556
00:29:10,789 --> 00:29:15,740
that's another fail because you could do

557
00:29:13,700 --> 00:29:18,320
that with the whole range of bikes and

558
00:29:15,740 --> 00:29:22,520
you're dosing the whole system so every

559
00:29:18,320 --> 00:29:29,510
bike is not available for for a period

560
00:29:22,520 --> 00:29:37,668
of 24 hours okay

561
00:29:29,510 --> 00:29:40,908
so after sometime in fall of 2017 I

562
00:29:37,669 --> 00:29:43,460
realized they changed the rest API so as

563
00:29:40,909 --> 00:29:44,870
usual I wanted to see I wanted to get

564
00:29:43,460 --> 00:29:47,630
the list of bikes and

565
00:29:44,870 --> 00:29:53,059
then I got an error service busy please

566
00:29:47,630 --> 00:29:54,680
try later not very useful error and I I

567
00:29:53,059 --> 00:29:57,020
noticed there was an update of the app

568
00:29:54,680 --> 00:29:59,870
so I looked into the communication again

569
00:29:57,020 --> 00:30:03,650
and then the call had changed actually

570
00:29:59,870 --> 00:30:06,070
it was like a hex payload but I couldn't

571
00:30:03,650 --> 00:30:08,800
make any sense of it until I realized

572
00:30:06,070 --> 00:30:12,470
okay it must be something encrypted and

573
00:30:08,800 --> 00:30:18,260
in the news you could see okay somebody

574
00:30:12,470 --> 00:30:20,690
else found a way to leak all data of all

575
00:30:18,260 --> 00:30:24,260
users of all bikes so you could access

576
00:30:20,690 --> 00:30:27,590
the personal information mobile phone

577
00:30:24,260 --> 00:30:31,429
numbers but no credit columns and I

578
00:30:27,590 --> 00:30:34,159
think it was as a measure or a reaction

579
00:30:31,429 --> 00:30:38,540
to this leak that they changed the API

580
00:30:34,160 --> 00:30:44,540
and made it more secure I don't know so

581
00:30:38,540 --> 00:30:46,670
I thought well I mean if the mobile app

582
00:30:44,540 --> 00:30:50,178
knows how to encrypt those messages so

583
00:30:46,670 --> 00:30:55,940
the the key must be somewhere in the app

584
00:30:50,179 --> 00:30:58,550
so I used tools to decompile Dex files

585
00:30:55,940 --> 00:31:03,220
of Java files and couldn't find anything

586
00:30:58,550 --> 00:31:09,860
there until I realized okay they hit the

587
00:31:03,220 --> 00:31:12,550
the keys inside a native library and so

588
00:31:09,860 --> 00:31:16,309
you as you can see here it's for the x

589
00:31:12,550 --> 00:31:19,100
x86 version you also have the arm

590
00:31:16,309 --> 00:31:20,809
version and so on and in every of those

591
00:31:19,100 --> 00:31:23,629
shared libraries you would find

592
00:31:20,809 --> 00:31:28,879
somewhere if you dump the library you

593
00:31:23,630 --> 00:31:31,070
would find needed a keys to do that and

594
00:31:28,880 --> 00:31:34,160
how is it used so first of all it's not

595
00:31:31,070 --> 00:31:36,200
only encryption it's also integrity

596
00:31:34,160 --> 00:31:38,300
protected so first you have an intake

597
00:31:36,200 --> 00:31:41,630
integrity protection with a sha-1 hash

598
00:31:38,300 --> 00:31:45,200
and there you need the first key this Oh

599
00:31:41,630 --> 00:31:48,800
BA D DX and this was used under Android

600
00:31:45,200 --> 00:31:51,100
and I figured out other people are also

601
00:31:48,800 --> 00:31:56,720
find that out because they wanted to

602
00:31:51,100 --> 00:31:58,520
develop an a global app to find bikes of

603
00:31:56,720 --> 00:32:01,130
different sharing services

604
00:31:58,520 --> 00:32:03,920
so what they did is they also reverse

605
00:32:01,130 --> 00:32:06,320
engineering it but they use an iOS phone

606
00:32:03,920 --> 00:32:08,630
and I figured out this ad D means

607
00:32:06,320 --> 00:32:12,409
Android and the iOS version you would

608
00:32:08,630 --> 00:32:14,390
have an iOS at that place so you need

609
00:32:12,410 --> 00:32:17,440
the plain text which is just adjacent

610
00:32:14,390 --> 00:32:22,030
payload and you have this ampersand you

611
00:32:17,440 --> 00:32:26,150
you calculate the message authentical

612
00:32:22,030 --> 00:32:29,510
authentication code by concatenating all

613
00:32:26,150 --> 00:32:32,150
this stuff and computing the sha-1 out

614
00:32:29,510 --> 00:32:34,879
of it then afterwards you're going to

615
00:32:32,150 --> 00:32:37,160
use that Mac again using the plaintext

616
00:32:34,880 --> 00:32:41,990
the ampersand and then appending the Mac

617
00:32:37,160 --> 00:32:44,090
you put it into a ES 128 cbc with an

618
00:32:41,990 --> 00:32:46,160
initialization vector that's very random

619
00:32:44,090 --> 00:32:49,189
this is one two three four five and then

620
00:32:46,160 --> 00:32:53,870
the other key plus the app version

621
00:32:49,190 --> 00:32:56,720
number so I used like the app number the

622
00:32:53,870 --> 00:32:59,809
version number two dot v dot four and

623
00:32:56,720 --> 00:33:01,730
you had to take the individual digits so

624
00:32:59,809 --> 00:33:02,870
like two five four and just append it to

625
00:33:01,730 --> 00:33:06,590
this key and then you would get the

626
00:33:02,870 --> 00:33:08,780
cipher text so if we look at the payload

627
00:33:06,590 --> 00:33:11,120
I had just before when you decrypt it

628
00:33:08,780 --> 00:33:12,889
you get like this and what's interesting

629
00:33:11,120 --> 00:33:14,870
is that now they're also tracking the

630
00:33:12,890 --> 00:33:18,260
device ID when you want to access the

631
00:33:14,870 --> 00:33:23,149
byte locations so it's more of a

632
00:33:18,260 --> 00:33:28,640
security by obscurity strategy and I

633
00:33:23,150 --> 00:33:33,050
don't know what they wanted to to reach

634
00:33:28,640 --> 00:33:37,210
with that okay so I'm already at the end

635
00:33:33,050 --> 00:33:40,360
I have some conclusions first of all

636
00:33:37,210 --> 00:33:45,710
think about the risks when you're

637
00:33:40,360 --> 00:33:48,320
developing such a system because there

638
00:33:45,710 --> 00:33:53,179
could be obvious and less obvious risks

639
00:33:48,320 --> 00:33:58,129
I'd say the the safety issues are less

640
00:33:53,179 --> 00:34:05,540
obvious and you need to think about them

641
00:33:58,130 --> 00:34:07,970
and another point do I don't want to

642
00:34:05,540 --> 00:34:09,918
lobby for depend penetration testing

643
00:34:07,970 --> 00:34:10,980
companies but I think it makes sense

644
00:34:09,918 --> 00:34:12,868
it's

645
00:34:10,980 --> 00:34:15,418
when you're deploying on such a mass

646
00:34:12,869 --> 00:34:18,750
scale I think you could like invest like

647
00:34:15,418 --> 00:34:21,779
maybe 10 or 20 thousand dollars to do a

648
00:34:18,750 --> 00:34:23,668
basic security audit but because

649
00:34:21,780 --> 00:34:27,690
actually I'm doing this in my spare time

650
00:34:23,668 --> 00:34:30,149
and I I think I got a lot of low-hanging

651
00:34:27,690 --> 00:34:32,970
fruit so you could get rid of those low

652
00:34:30,149 --> 00:34:38,339
hanging fruits by just having some

653
00:34:32,969 --> 00:34:42,830
security guys looking at it then the

654
00:34:38,340 --> 00:34:45,869
third thing I'm gonna say is eventually

655
00:34:42,830 --> 00:34:48,480
there will be design flaws as we saw or

656
00:34:45,869 --> 00:34:50,310
the keys will be leaked so you need to

657
00:34:48,480 --> 00:34:53,429
prepare for that you need to make your

658
00:34:50,310 --> 00:34:57,029
devices fixable so in the case of all

659
00:34:53,429 --> 00:35:01,619
bikes I'm I guess it's not possible to

660
00:34:57,030 --> 00:35:04,109
update the the locks over-the-air well I

661
00:35:01,619 --> 00:35:06,180
I didn't find anything in the app that

662
00:35:04,109 --> 00:35:10,290
would go in this direction of course

663
00:35:06,180 --> 00:35:13,740
maybe it's it's possible but because you

664
00:35:10,290 --> 00:35:15,990
would want to avoid to go out to all the

665
00:35:13,740 --> 00:35:19,950
bikes and reprogram the stuff that will

666
00:35:15,990 --> 00:35:22,910
be almost infeasible so you need to keep

667
00:35:19,950 --> 00:35:27,140
that in mind and have some mechanism to

668
00:35:22,910 --> 00:35:33,180
to allow to update the code on your

669
00:35:27,140 --> 00:35:36,359
devices okay so before I go over to the

670
00:35:33,180 --> 00:35:38,850
questions some comments because I see I

671
00:35:36,359 --> 00:35:40,350
have some time left if you want to see

672
00:35:38,850 --> 00:35:42,750
all the description of the reverse

673
00:35:40,350 --> 00:35:45,660
engineering so on I just put it on my

674
00:35:42,750 --> 00:35:48,540
github account so it's on 20 and / or

675
00:35:45,660 --> 00:35:51,660
bike if you want to follow me on Twitter

676
00:35:48,540 --> 00:35:55,740
it's on 20 but with a zero instead of oh

677
00:35:51,660 --> 00:35:57,990
oh and a third reference there's a

678
00:35:55,740 --> 00:36:00,479
Twitter account called broken Oh bikes

679
00:35:57,990 --> 00:36:03,720
it's super entertaining so it's someone

680
00:36:00,480 --> 00:36:06,359
who's gathering pictures of all bikes in

681
00:36:03,720 --> 00:36:09,180
all kinds of funny situation like in the

682
00:36:06,359 --> 00:36:11,840
river on trees stacked on another or

683
00:36:09,180 --> 00:36:13,970
like people who are

684
00:36:11,840 --> 00:36:17,120
changing the aspect of the back just

685
00:36:13,970 --> 00:36:20,120
look at it this really pretty funny then

686
00:36:17,120 --> 00:36:25,400
I have something else I discovered

687
00:36:20,120 --> 00:36:29,330
during the analysis is if you paid

688
00:36:25,400 --> 00:36:30,860
attention during the the when I showed

689
00:36:29,330 --> 00:36:34,730
how you could get the location you have

690
00:36:30,860 --> 00:36:37,160
one field it's called emai and first I

691
00:36:34,730 --> 00:36:38,570
thought I didn't know what's inside the

692
00:36:37,160 --> 00:36:41,330
lock so I thought okay that's clear

693
00:36:38,570 --> 00:36:43,790
that's this the International Mobile

694
00:36:41,330 --> 00:36:47,810
Equipment Identity that's something that

695
00:36:43,790 --> 00:36:50,980
would identify the GSM module like you

696
00:36:47,810 --> 00:36:54,049
every every GSM phone has an email and

697
00:36:50,980 --> 00:36:56,990
it's used to track the phone actually so

698
00:36:54,050 --> 00:36:58,400
I thought okay it must have some means

699
00:36:56,990 --> 00:37:00,049
of communication but it's not the case

700
00:36:58,400 --> 00:37:02,900
so it should miss probably another

701
00:37:00,050 --> 00:37:06,230
acronym so I looked at it and it's not

702
00:37:02,900 --> 00:37:08,570
another tall the format of an email but

703
00:37:06,230 --> 00:37:10,760
it's a hex string so I looked at the hex

704
00:37:08,570 --> 00:37:13,910
string and and and so it's all in the

705
00:37:10,760 --> 00:37:16,640
ask range and actually some of the

706
00:37:13,910 --> 00:37:20,149
values you can overlap them and you see

707
00:37:16,640 --> 00:37:23,740
it's it means something so it's very

708
00:37:20,150 --> 00:37:27,680
interesting so this is just an exertion

709
00:37:23,740 --> 00:37:30,649
light initialization function simple ble

710
00:37:27,680 --> 00:37:32,899
peripheral and so for me ble is like

711
00:37:30,650 --> 00:37:36,110
that's Bluetooth Low Energy so that's

712
00:37:32,900 --> 00:37:41,480
kind of like function names that are

713
00:37:36,110 --> 00:37:44,210
used on the client but I never needed

714
00:37:41,480 --> 00:37:47,960
those actually to make the whole thing

715
00:37:44,210 --> 00:37:51,320
work so I have no idea what it is maybe

716
00:37:47,960 --> 00:37:54,130
it's a memory leak so if somebody ever

717
00:37:51,320 --> 00:37:59,980
finds out I'd be interested in knowing

718
00:37:54,130 --> 00:37:59,980
ok so thanks a lot for your attention

719
00:38:10,170 --> 00:38:13,860
okay are there any questions

720
00:38:30,210 --> 00:38:36,400
thanks for the interesting talk how did

721
00:38:33,640 --> 00:38:39,640
you test this stuff brought you the

722
00:38:36,400 --> 00:38:43,240
bikes to your home well you can see it

723
00:38:39,640 --> 00:38:46,960
on this photograph this is somewhere in

724
00:38:43,240 --> 00:38:47,620
Zurich and I just brought my my computer

725
00:38:46,960 --> 00:38:51,250
to the bike

726
00:38:47,620 --> 00:38:54,100
sometimes I even put the bike somewhere

727
00:38:51,250 --> 00:38:55,750
closer to where I work so I can access

728
00:38:54,100 --> 00:38:58,540
it but they have a range of about 10

729
00:38:55,750 --> 00:39:00,910
meters so with the VLE so you don't

730
00:38:58,540 --> 00:39:02,950
really need it to have it close to you

731
00:39:00,910 --> 00:39:12,210
maybe if you have it outside the window

732
00:39:02,950 --> 00:39:14,799
it's already enough another question

733
00:39:12,210 --> 00:39:18,670
did you disclose to all bikes that you

734
00:39:14,800 --> 00:39:21,970
were able to extract AES keys and if so

735
00:39:18,670 --> 00:39:25,950
how did they react if at all I didn't

736
00:39:21,970 --> 00:39:25,950
understand the part with the AEF Keith

737
00:39:26,220 --> 00:39:32,080
did you disclose to all bikes if you

738
00:39:28,690 --> 00:39:34,630
that you extracted the AES key how they

739
00:39:32,080 --> 00:39:37,029
I didn't extract the AES keys it's just

740
00:39:34,630 --> 00:39:39,820
it wasn't well and not a dead end

741
00:39:37,030 --> 00:39:44,290
but actually since I didn't get access

742
00:39:39,820 --> 00:39:47,520
to a lock I didn't go further that way I

743
00:39:44,290 --> 00:39:51,009
did talk I tried to contact o bike at

744
00:39:47,520 --> 00:39:52,930
several occasions either through their

745
00:39:51,010 --> 00:39:56,110
support which i think is in Singapore

746
00:39:52,930 --> 00:40:00,960
and otherwise we are the contacts in

747
00:39:56,110 --> 00:40:03,430
Switzerland and I mentioned the paper of

748
00:40:00,960 --> 00:40:06,550
the new University of Singapore which

749
00:40:03,430 --> 00:40:11,200
was publicly accessible on the internet

750
00:40:06,550 --> 00:40:13,600
and the response was very fast they told

751
00:40:11,200 --> 00:40:15,790
me they fixed the problem so afterwards

752
00:40:13,600 --> 00:40:18,520
I informed them that I would mention

753
00:40:15,790 --> 00:40:22,680
this bug and the security conference and

754
00:40:18,520 --> 00:40:22,680
then I didn't have any response anymore

755
00:40:24,000 --> 00:40:41,140
any other questions okay doesn't look

756
00:40:38,800 --> 00:40:42,620
like that so let's thank the speaker

757
00:40:41,140 --> 00:40:46,810
again

758
00:40:42,620 --> 00:40:48,870
[Applause]

759
00:40:46,810 --> 00:40:48,870
you

