1
00:00:03,800 --> 00:00:12,088
good morning guten tag Bonjour Bonjour

2
00:00:07,800 --> 00:00:14,759
no it's very very nice to be here and

3
00:00:12,089 --> 00:00:19,230
thanks candy than the other organizers

4
00:00:14,759 --> 00:00:22,320
for having me it's a great opportunity

5
00:00:19,230 --> 00:00:25,679
to talk about I think a very interesting

6
00:00:22,320 --> 00:00:28,140
subject because we live I think we live

7
00:00:25,679 --> 00:00:31,080
in interesting times there's this famous

8
00:00:28,140 --> 00:00:33,240
Chinese proverb which says may we live

9
00:00:31,080 --> 00:00:35,820
in interesting times and I think we live

10
00:00:33,240 --> 00:00:39,300
in very interesting times and

11
00:00:35,820 --> 00:00:42,240
attribution is I think one of the most

12
00:00:39,300 --> 00:00:44,510
interesting parts of the work that we do

13
00:00:42,240 --> 00:00:46,260
nowadays because you see that

14
00:00:44,510 --> 00:00:49,170
cyberattacks there's more and more

15
00:00:46,260 --> 00:00:51,030
cyberattacks destructive attacks there

16
00:00:49,170 --> 00:00:55,110
was let's say a significant change in

17
00:00:51,030 --> 00:00:57,000
the way the attacks are launched when

18
00:00:55,110 --> 00:01:01,230
let's say we've have started seeing

19
00:00:57,000 --> 00:01:05,610
destructive attacks and with that in

20
00:01:01,230 --> 00:01:08,548
mind probably you know some of the

21
00:01:05,610 --> 00:01:10,289
research that we have done with the

22
00:01:08,549 --> 00:01:13,380
global research and analysis team at

23
00:01:10,289 --> 00:01:17,539
Kaspersky LA to be honest I started

24
00:01:13,380 --> 00:01:20,640
there looking into apts around 2010 and

25
00:01:17,539 --> 00:01:23,070
back then I was not really interested in

26
00:01:20,640 --> 00:01:26,759
this subject I was more interested in

27
00:01:23,070 --> 00:01:29,249
banking attacks you know exploit kids

28
00:01:26,759 --> 00:01:31,319
and so on but one of my colleagues

29
00:01:29,249 --> 00:01:34,079
Alex Gustav he was supposed to speak at

30
00:01:31,319 --> 00:01:36,359
a conference in Canada he couldn't get a

31
00:01:34,079 --> 00:01:39,178
visa so he asked me can you go instead

32
00:01:36,359 --> 00:01:42,240
and talk about Stuxnet and I kind of

33
00:01:39,179 --> 00:01:44,700
knew what was Stuxnet I knew it was like

34
00:01:42,240 --> 00:01:47,759
a malicious program used in Iran

35
00:01:44,700 --> 00:01:49,740
probably it has some relations to United

36
00:01:47,759 --> 00:01:52,889
States and Israel so I was not very

37
00:01:49,740 --> 00:01:55,530
comfortable so I went to Canada to talk

38
00:01:52,889 --> 00:01:59,280
about Stuxnet instead of Alex so as I

39
00:01:55,530 --> 00:02:00,959
got on the stage as I was talking I saw

40
00:01:59,280 --> 00:02:02,759
like three people at the back of the

41
00:02:00,959 --> 00:02:04,619
room who were not very happy with my

42
00:02:02,759 --> 00:02:08,369
speech

43
00:02:04,619 --> 00:02:10,889
and I could feel there was some tension

44
00:02:08,369 --> 00:02:13,500
in the air about two weeks after the

45
00:02:10,889 --> 00:02:16,410
speech I found a gift in my home which

46
00:02:13,500 --> 00:02:19,680
said take a break so then I realized

47
00:02:16,410 --> 00:02:21,810
that you know the research that we do

48
00:02:19,680 --> 00:02:25,319
can have like some serious implications

49
00:02:21,810 --> 00:02:28,760
and to be honest one of the most I say

50
00:02:25,319 --> 00:02:33,060
interesting things here is a problem of

51
00:02:28,760 --> 00:02:36,840
attribution of cyberattacks and I'll

52
00:02:33,060 --> 00:02:41,130
give you an example the USA elections

53
00:02:36,840 --> 00:02:43,019
from 2016 and I tried very hard to find

54
00:02:41,130 --> 00:02:47,250
a photo of these two guys where they

55
00:02:43,019 --> 00:02:49,980
look nice because in most of the other

56
00:02:47,250 --> 00:02:52,110
photos it's either one of them who looks

57
00:02:49,980 --> 00:02:56,099
terrible and the other nice or the other

58
00:02:52,110 --> 00:02:59,099
way around but maybe not many people

59
00:02:56,099 --> 00:03:01,679
remember that before the USA elections

60
00:02:59,099 --> 00:03:04,410
there was this guy called

61
00:03:01,680 --> 00:03:06,540
Gucci fur and this is a photo when he

62
00:03:04,410 --> 00:03:08,579
was arrested by the Romanian police and

63
00:03:06,540 --> 00:03:10,920
Gucci fur I think he became famous for

64
00:03:08,579 --> 00:03:13,530
all sorts of things one of them being

65
00:03:10,920 --> 00:03:17,160
for claiming that he was able to hack

66
00:03:13,530 --> 00:03:19,410
into Hillary Clinton's email server so

67
00:03:17,160 --> 00:03:21,989
actually at that point he said yeah yeah

68
00:03:19,410 --> 00:03:24,780
like I know a lot of people who are able

69
00:03:21,989 --> 00:03:28,319
to hack her email server and read her

70
00:03:24,780 --> 00:03:32,400
emails and I think this is a probably an

71
00:03:28,319 --> 00:03:36,929
interesting story because Gucci fur by

72
00:03:32,400 --> 00:03:38,880
his name Marshall Lazar Allah health he

73
00:03:36,930 --> 00:03:43,739
was a Romanian guy his main occupation

74
00:03:38,880 --> 00:03:46,440
was actually a taxi driver but what is

75
00:03:43,739 --> 00:03:49,650
interesting that let's say he had like a

76
00:03:46,440 --> 00:03:51,480
very strange how to put his mentality

77
00:03:49,650 --> 00:03:54,090
some people would say that he was a bit

78
00:03:51,480 --> 00:03:56,340
crazy because he said that he combines

79
00:03:54,090 --> 00:04:01,530
the style of Gucci with the power of

80
00:03:56,340 --> 00:04:03,989
Lucifer whatever that means and he had

81
00:04:01,530 --> 00:04:06,690
like no skills to be honest except the

82
00:04:03,989 --> 00:04:09,000
knowledge that he was able to learn

83
00:04:06,690 --> 00:04:12,389
online so some might actually say that

84
00:04:09,000 --> 00:04:15,689
he was a script kiddie in a way however

85
00:04:12,389 --> 00:04:17,000
with his a script kiddie tools skills he

86
00:04:15,689 --> 00:04:19,459
was able to

87
00:04:17,000 --> 00:04:21,410
do let's say a lot of hacks such as for

88
00:04:19,459 --> 00:04:23,930
instance he was able to hack the email

89
00:04:21,410 --> 00:04:27,050
of Colin Powell the Rockefeller family

90
00:04:23,930 --> 00:04:30,860
he was able to hack a bunch of FBI and

91
00:04:27,050 --> 00:04:33,620
US Secret Service agents as well as

92
00:04:30,860 --> 00:04:35,420
let's say a few other guys such as

93
00:04:33,620 --> 00:04:38,120
Karina correct so in George Meyer

94
00:04:35,420 --> 00:04:41,930
now to be honest for the Romanian police

95
00:04:38,120 --> 00:04:43,820
this was not a high profile case until

96
00:04:41,930 --> 00:04:46,100
the moment that he was able to hack

97
00:04:43,820 --> 00:04:48,800
these two guys Carina Creta was a

98
00:04:46,100 --> 00:04:51,169
Romanian politician but George George

99
00:04:48,800 --> 00:04:54,650
George Mir was actually the head of the

100
00:04:51,169 --> 00:04:56,960
Romanian intelligence service obviously

101
00:04:54,650 --> 00:04:57,739
I think things change when when he did

102
00:04:56,960 --> 00:05:00,080
this

103
00:04:57,740 --> 00:05:03,530
it's funny how he managed to hack the

104
00:05:00,080 --> 00:05:05,810
email of Corinna Kratz ooh he actually

105
00:05:03,530 --> 00:05:08,210
went to her yahoo account and he tried

106
00:05:05,810 --> 00:05:10,250
to reset password and he was asked I

107
00:05:08,210 --> 00:05:12,409
think one of the question was her

108
00:05:10,250 --> 00:05:14,750
birthday he was able to get it from some

109
00:05:12,410 --> 00:05:17,300
public documents the other question that

110
00:05:14,750 --> 00:05:19,940
he got was the name of the street where

111
00:05:17,300 --> 00:05:22,160
she grew up so she actually he actually

112
00:05:19,940 --> 00:05:24,560
knew that she grew up in a city in

113
00:05:22,160 --> 00:05:27,710
Bucharest called Braila so he tried the

114
00:05:24,560 --> 00:05:32,150
names of all the streets in Braila until

115
00:05:27,710 --> 00:05:35,840
he got it right which I would say was

116
00:05:32,150 --> 00:05:37,969
very thorough from his side however the

117
00:05:35,840 --> 00:05:40,640
problem is when he hacked into Georgia

118
00:05:37,970 --> 00:05:44,090
Meyers emails he actually tried to

119
00:05:40,640 --> 00:05:46,310
ransom him he blackmailed George Meyer

120
00:05:44,090 --> 00:05:48,320
he called him a skunk and he asked for

121
00:05:46,310 --> 00:05:49,729
money not to publish his emails and

122
00:05:48,320 --> 00:05:52,340
remember this was the head of the

123
00:05:49,729 --> 00:05:54,200
Romanian intelligence service so what

124
00:05:52,340 --> 00:05:55,090
happens is two weeks later he got

125
00:05:54,200 --> 00:06:00,110
arrested

126
00:05:55,090 --> 00:06:04,039
problem solved yeah this was in August

127
00:06:00,110 --> 00:06:07,610
of 2013 so then of course we have this

128
00:06:04,040 --> 00:06:10,910
very interesting case of the dnc hack

129
00:06:07,610 --> 00:06:12,950
which is still being discussed and was a

130
00:06:10,910 --> 00:06:13,669
very interesting blog post which

131
00:06:12,950 --> 00:06:17,919
CrowdStrike

132
00:06:13,669 --> 00:06:20,900
published and in this blog post he they

133
00:06:17,919 --> 00:06:23,539
detailed their analysis of the dnc hack

134
00:06:20,900 --> 00:06:25,310
and he said they found basically two

135
00:06:23,540 --> 00:06:29,000
hacking groups is there one of them apt

136
00:06:25,310 --> 00:06:30,530
28 also known as so fussy and fancy bear

137
00:06:29,000 --> 00:06:34,160
the other one

138
00:06:30,530 --> 00:06:36,320
basically the Dukes apt 29 and they said

139
00:06:34,160 --> 00:06:38,390
like these two apt groups which are

140
00:06:36,320 --> 00:06:40,340
linked to Russia were able to penetrate

141
00:06:38,390 --> 00:06:42,890
the DNC Network and steal the

142
00:06:40,340 --> 00:06:46,549
information so what happened next

143
00:06:42,890 --> 00:06:48,710
gucci fir 2.0 appeared in gucci fur 2.0

144
00:06:46,550 --> 00:06:51,530
basically he said you know this cross

145
00:06:48,710 --> 00:06:54,710
strike saying is in reality was

146
00:06:51,530 --> 00:06:58,669
just me alone hacker and I hacked to the

147
00:06:54,710 --> 00:07:01,430
DNC and as a proof here's my emails so

148
00:06:58,670 --> 00:07:05,030
of course this in the beginning at least

149
00:07:01,430 --> 00:07:07,520
it kind of ruined and let's say put a

150
00:07:05,030 --> 00:07:10,760
shadow on the crosstrack blog which in

151
00:07:07,520 --> 00:07:12,620
my opinion was all correct however some

152
00:07:10,760 --> 00:07:16,130
people actually had the idea of talking

153
00:07:12,620 --> 00:07:18,580
to gucci friend 2.0 and he was quite

154
00:07:16,130 --> 00:07:21,500
keen to talk to them so for instance

155
00:07:18,580 --> 00:07:23,900
Lorenzo Franceschi Bri for motherboard

156
00:07:21,500 --> 00:07:25,520
he did an interview with Gucci fur and

157
00:07:23,900 --> 00:07:28,099
he asked him where are you from and

158
00:07:25,520 --> 00:07:30,740
Gucci fur 2.0 he said I'm from Romania

159
00:07:28,100 --> 00:07:32,750
and then I think Lauren so used the

160
00:07:30,740 --> 00:07:35,120
Google Translate to try to talk to him

161
00:07:32,750 --> 00:07:37,669
to see if he knows and he says okay we

162
00:07:35,120 --> 00:07:41,090
want to talk a bit in Romanian to which

163
00:07:37,669 --> 00:07:43,520
Gucci fear applies also in Romanian like

164
00:07:41,090 --> 00:07:47,929
do you speak Romanian four beats Roman

165
00:07:43,520 --> 00:07:50,120
Esther and then Francesco asks him why

166
00:07:47,930 --> 00:07:53,720
did you put a Russian metadata in the

167
00:07:50,120 --> 00:07:57,080
documents to which Gucci fur 2 says it's

168
00:07:53,720 --> 00:08:00,710
my watermark and he uses a very strange

169
00:07:57,080 --> 00:08:04,969
word here three times which is filigrana

170
00:08:00,710 --> 00:08:06,770
now this word in Romanian it's extremely

171
00:08:04,970 --> 00:08:09,500
extremely rare I think there's people

172
00:08:06,770 --> 00:08:13,070
that I have friends who never used this

173
00:08:09,500 --> 00:08:14,660
word in their life normal people don't

174
00:08:13,070 --> 00:08:17,000
use this word because let's say

175
00:08:14,660 --> 00:08:21,200
everybody says watermarks nobody says

176
00:08:17,000 --> 00:08:23,810
filigrana so actually gucci fer - made a

177
00:08:21,200 --> 00:08:27,440
bunch of mistakes for instance he didn't

178
00:08:23,810 --> 00:08:30,740
correctly say of Orbitz Limbaugh Romana

179
00:08:27,440 --> 00:08:33,710
so he made us say some kind of strange

180
00:08:30,740 --> 00:08:37,070
mistakes in his Romanian in my opinion

181
00:08:33,710 --> 00:08:40,099
he was definitely not Romanian and some

182
00:08:37,070 --> 00:08:42,860
people said ok but why is he using these

183
00:08:40,099 --> 00:08:43,700
words so actually if you go to Google

184
00:08:42,860 --> 00:08:46,910
Translate

185
00:08:43,700 --> 00:08:49,550
you try to do it is my watermark in

186
00:08:46,910 --> 00:08:52,699
Romanian you get exactly this strange

187
00:08:49,550 --> 00:08:56,030
Romanian word it yes the filigrana old

188
00:08:52,700 --> 00:08:59,690
male which as I said nobody uses so this

189
00:08:56,030 --> 00:09:02,209
kind of exposed him as let's say not

190
00:08:59,690 --> 00:09:05,240
being a true Romanian so he was let's

191
00:09:02,210 --> 00:09:07,610
say trying to do a false flag in this

192
00:09:05,240 --> 00:09:10,970
case and I then I realized when this

193
00:09:07,610 --> 00:09:13,760
story was happening that even with

194
00:09:10,970 --> 00:09:15,560
malware when people write malware and

195
00:09:13,760 --> 00:09:18,290
they try to make it look as something

196
00:09:15,560 --> 00:09:20,000
else you can still catch them by

197
00:09:18,290 --> 00:09:22,910
mistakes because everybody makes

198
00:09:20,000 --> 00:09:25,550
mistakes and when you make mistakes they

199
00:09:22,910 --> 00:09:28,310
remained on the internet forever and

200
00:09:25,550 --> 00:09:33,109
that's when people like us we can

201
00:09:28,310 --> 00:09:36,229
actually catch them so this led me to

202
00:09:33,110 --> 00:09:38,120
think about code similarity and this is

203
00:09:36,230 --> 00:09:41,030
like the main topic of what I want to

204
00:09:38,120 --> 00:09:45,670
say today is using code similarity in

205
00:09:41,030 --> 00:09:48,829
big stories and I remember on 12 of May

206
00:09:45,670 --> 00:09:53,050
2017 it was a Friday how many people

207
00:09:48,830 --> 00:09:57,500
remember May 12 2007 teen a few people I

208
00:09:53,050 --> 00:09:59,870
know where you guys were it was a quiet

209
00:09:57,500 --> 00:10:02,270
Friday so I was at work

210
00:09:59,870 --> 00:10:04,070
Harris you know Friday Friday is the

211
00:10:02,270 --> 00:10:07,670
beginning of the weekend you don't want

212
00:10:04,070 --> 00:10:10,010
problems on a Friday and then a guy like

213
00:10:07,670 --> 00:10:12,500
from my team from my Spain he writes me

214
00:10:10,010 --> 00:10:15,220
a message you know in Spain it's siesta

215
00:10:12,500 --> 00:10:18,370
like no

216
00:10:15,220 --> 00:10:20,650
and he says like we have some huge

217
00:10:18,370 --> 00:10:23,650
attack in Spain yeah there's like

218
00:10:20,650 --> 00:10:26,620
everywhere telecommunications are down

219
00:10:23,650 --> 00:10:31,209
and I come on it's siesta and second

220
00:10:26,620 --> 00:10:36,940
it's Friday and then you know we started

221
00:10:31,210 --> 00:10:39,760
seeing things like this one and things

222
00:10:36,940 --> 00:10:46,500
like this one in Spain of course big

223
00:10:39,760 --> 00:10:49,600
tragedy in the hotels ATMs in Russia

224
00:10:46,500 --> 00:10:53,520
banking in Russia for instance we have

225
00:10:49,600 --> 00:10:57,370
the transportation the trams in

226
00:10:53,520 --> 00:11:02,949
Frankfurt ATMs in China and you all

227
00:10:57,370 --> 00:11:05,170
recognize this red screen and it goes on

228
00:11:02,950 --> 00:11:09,850
and on and on and that was probably

229
00:11:05,170 --> 00:11:13,599
quite big in my opinion which let other

230
00:11:09,850 --> 00:11:17,860
people to to you know make fun of it in

231
00:11:13,600 --> 00:11:22,270
a way that it can hit other things as

232
00:11:17,860 --> 00:11:27,210
well Nokia microwave ovens washing

233
00:11:22,270 --> 00:11:33,970
machines Google glasses air conditioning

234
00:11:27,210 --> 00:11:35,310
Smart Watch yes you know good stuff by

235
00:11:33,970 --> 00:11:38,800
the way

236
00:11:35,310 --> 00:11:43,599
smart cars and pretty much everywhere in

237
00:11:38,800 --> 00:11:46,390
the matrix but of course when wanna cry

238
00:11:43,600 --> 00:11:49,510
hit I worked throughout the weekend

239
00:11:46,390 --> 00:11:51,670
trying to you know take it apart it was

240
00:11:49,510 --> 00:11:55,000
like reasonably large so it requires

241
00:11:51,670 --> 00:11:56,890
some analysis but like the big question

242
00:11:55,000 --> 00:12:00,850
everybody asks is who is behind wanna

243
00:11:56,890 --> 00:12:04,350
cry and it wasn't I think until Monday

244
00:12:00,850 --> 00:12:06,850
evening when Neil Mecca from Google

245
00:12:04,350 --> 00:12:09,250
published this cryptical message on

246
00:12:06,850 --> 00:12:10,870
Twitter and when we saw the message you

247
00:12:09,250 --> 00:12:13,810
know everybody was like facepalm of

248
00:12:10,870 --> 00:12:16,930
course and the other people were like

249
00:12:13,810 --> 00:12:19,810
what the hell but if you actually look

250
00:12:16,930 --> 00:12:21,819
in the in the message what he does here

251
00:12:19,810 --> 00:12:25,900
he posed to hashes of two different

252
00:12:21,820 --> 00:12:27,810
samples as well as the offsets in these

253
00:12:25,900 --> 00:12:30,660
two different samples

254
00:12:27,810 --> 00:12:33,300
and as I opened the two samples we have

255
00:12:30,660 --> 00:12:36,420
them here one and the other one actually

256
00:12:33,300 --> 00:12:39,420
one of them is a sample of one a cry 1.0

257
00:12:36,420 --> 00:12:43,110
the other one is a sample of a worm used

258
00:12:39,420 --> 00:12:45,180
by the Lazarus apt group so he was the

259
00:12:43,110 --> 00:12:47,420
first person to point out there's a

260
00:12:45,180 --> 00:12:50,069
similarity between one a cry in this

261
00:12:47,420 --> 00:12:52,650
Lazarus group which became famous for

262
00:12:50,070 --> 00:12:55,980
hacking into Sony Pictures you know the

263
00:12:52,650 --> 00:12:58,199
dark civil attacks the Bangladesh bank

264
00:12:55,980 --> 00:13:00,480
heist and so on and so on so an apt

265
00:12:58,200 --> 00:13:02,810
group it was a pretty interesting case

266
00:13:00,480 --> 00:13:04,920
when a nation-state or an actor

267
00:13:02,810 --> 00:13:07,589
suspected of being connected to a

268
00:13:04,920 --> 00:13:10,740
nation-state to launch a ransomware

269
00:13:07,589 --> 00:13:13,230
attack you know to make money but I

270
00:13:10,740 --> 00:13:15,120
guess in their case you know it's a

271
00:13:13,230 --> 00:13:17,010
pretty tough situation and they needed

272
00:13:15,120 --> 00:13:19,230
the money and of course the question

273
00:13:17,010 --> 00:13:21,450
everybody asked was how was Google able

274
00:13:19,230 --> 00:13:23,580
to do this because we looked everybody

275
00:13:21,450 --> 00:13:25,200
like all the people here in the room who

276
00:13:23,580 --> 00:13:27,630
work for antivirus companies they all

277
00:13:25,200 --> 00:13:29,940
looked at the malware as well but they

278
00:13:27,630 --> 00:13:33,689
couldn't find that particular fragment

279
00:13:29,940 --> 00:13:37,310
which was between the two samples and

280
00:13:33,690 --> 00:13:39,750
going back to 2011 Google bought

281
00:13:37,310 --> 00:13:43,650
dynamics I seen hull where flake was a

282
00:13:39,750 --> 00:13:46,080
keynote speaker here last year then in

283
00:13:43,650 --> 00:13:48,990
2014 I was talking to a friend of mine

284
00:13:46,080 --> 00:13:51,510
who worked at Google and we were like

285
00:13:48,990 --> 00:13:53,910
thinking how can we find more samples of

286
00:13:51,510 --> 00:13:55,800
this malware whatever and he said you

287
00:13:53,910 --> 00:13:57,930
know it's easy you just spin ten

288
00:13:55,800 --> 00:14:02,130
thousand machines and you do a grep in

289
00:13:57,930 --> 00:14:04,199
parallel so I was thinking like the idea

290
00:14:02,130 --> 00:14:06,660
of you know the power of ten thousand

291
00:14:04,200 --> 00:14:11,900
machines and do a grep in Perl I went to

292
00:14:06,660 --> 00:14:11,900
our city or my boss and I said boss

293
00:14:13,670 --> 00:14:21,300
can I get some money to buy 10,000

294
00:14:17,340 --> 00:14:25,590
machines and you can imagine his answer

295
00:14:21,300 --> 00:14:28,859
and well I said sure in the 2017 like

296
00:14:25,590 --> 00:14:32,160
step fast forward Google Links wanna cry

297
00:14:28,860 --> 00:14:34,770
to Lazarus so I said we need to find

298
00:14:32,160 --> 00:14:37,439
some solution which allows us to do the

299
00:14:34,770 --> 00:14:39,300
same but with less money and like

300
00:14:37,440 --> 00:14:41,160
whether if you look around that other

301
00:14:39,300 --> 00:14:44,430
companies Google is not the only one

302
00:14:41,160 --> 00:14:46,170
with such capabilities binary was

303
00:14:44,430 --> 00:14:47,010
another company they were purchased by

304
00:14:46,170 --> 00:14:49,140
CrowdStrike

305
00:14:47,010 --> 00:14:53,640
which they developed this kind of

306
00:14:49,140 --> 00:14:55,800
technology another one is integer is an

307
00:14:53,640 --> 00:14:58,110
Israeli company they have a very very

308
00:14:55,800 --> 00:15:00,150
good technology I think it's now it's

309
00:14:58,110 --> 00:15:02,760
free so you can sign up on their website

310
00:15:00,150 --> 00:15:05,490
for an account and play with it and see

311
00:15:02,760 --> 00:15:07,500
how it works but actually in let's say

312
00:15:05,490 --> 00:15:10,260
at least in principle this is quite easy

313
00:15:07,500 --> 00:15:13,380
for instance you could generate all the

314
00:15:10,260 --> 00:15:15,630
say between 8 and 16 by sub strings of a

315
00:15:13,380 --> 00:15:18,300
sample and then you search it throughout

316
00:15:15,630 --> 00:15:20,700
your malware collection the only problem

317
00:15:18,300 --> 00:15:23,099
is that at least for us the collection

318
00:15:20,700 --> 00:15:26,580
is very big we our malware collection is

319
00:15:23,100 --> 00:15:29,550
now about 5 petabytes so to search 5

320
00:15:26,580 --> 00:15:32,160
petabytes of data for I don't know a

321
00:15:29,550 --> 00:15:34,170
hundred thousand strings it will take

322
00:15:32,160 --> 00:15:37,380
some time so you cannot do it over the

323
00:15:34,170 --> 00:15:39,990
weekend or you know in a few hours and

324
00:15:37,380 --> 00:15:42,990
we cannot buy ten thousand machines you

325
00:15:39,990 --> 00:15:46,470
know to spin them whenever we need so

326
00:15:42,990 --> 00:15:49,350
one of the ideas which actually I want

327
00:15:46,470 --> 00:15:51,420
to talk about and this is what we have

328
00:15:49,350 --> 00:15:53,520
done this is the the nice part about

329
00:15:51,420 --> 00:15:56,370
this is that anyone can do it like this

330
00:15:53,520 --> 00:15:59,640
is a great thing about er how many

331
00:15:56,370 --> 00:16:01,860
people are familiar with the era ok

332
00:15:59,640 --> 00:16:03,960
people ask me like a lot of young people

333
00:16:01,860 --> 00:16:07,230
ask me and say what is the best

334
00:16:03,960 --> 00:16:09,780
programming language that I should learn

335
00:16:07,230 --> 00:16:12,480
you know in order to become a researcher

336
00:16:09,780 --> 00:16:15,390
or something and they say should is it

337
00:16:12,480 --> 00:16:16,770
like Python or Perl and usually I tell

338
00:16:15,390 --> 00:16:19,260
them you know try to learn the era

339
00:16:16,770 --> 00:16:21,360
because it's maybe not necessarily a

340
00:16:19,260 --> 00:16:23,310
programming language but it's a very

341
00:16:21,360 --> 00:16:25,470
very powerful and interesting tool which

342
00:16:23,310 --> 00:16:28,979
can really help your career

343
00:16:25,470 --> 00:16:30,630
so with the ARRA for instance the idea

344
00:16:28,980 --> 00:16:33,090
would be the following first we try to

345
00:16:30,630 --> 00:16:35,490
identify some relevant strings in a file

346
00:16:33,090 --> 00:16:38,220
and then we make the error rule from it

347
00:16:35,490 --> 00:16:41,580
and we just run that URL rule on our

348
00:16:38,220 --> 00:16:45,000
malware collection now the only problem

349
00:16:41,580 --> 00:16:47,430
is that how do we identify the relevant

350
00:16:45,000 --> 00:16:50,250
fragments of code and for instance if

351
00:16:47,430 --> 00:16:53,430
you have a 100k file as I said that's

352
00:16:50,250 --> 00:16:56,970
like 100,000 the sub strings between

353
00:16:53,430 --> 00:16:59,160
let's say just 16 bytes sub strings

354
00:16:56,970 --> 00:17:01,320
inside the sample so even if you filter

355
00:16:59,160 --> 00:17:02,939
out the clean strings what's clean

356
00:17:01,320 --> 00:17:05,640
there's like strings which appear in

357
00:17:02,940 --> 00:17:08,360
library files you know like a lip seek

358
00:17:05,640 --> 00:17:11,459
style of of strings you still have a lot

359
00:17:08,359 --> 00:17:15,958
30,000 sub strings you cannot search for

360
00:17:11,459 --> 00:17:18,270
30,000 sub strings but however this can

361
00:17:15,959 --> 00:17:20,880
actually be optimized a bit so if you

362
00:17:18,270 --> 00:17:23,369
look at these two different strings here

363
00:17:20,880 --> 00:17:25,800
the one on top which is a prologue of a

364
00:17:23,369 --> 00:17:28,770
function compiled by visual sea and the

365
00:17:25,800 --> 00:17:30,389
other one is full of cc's by the way

366
00:17:28,770 --> 00:17:36,690
anybody knows what is CC which

367
00:17:30,390 --> 00:17:40,640
instruction no usually there's like one

368
00:17:36,690 --> 00:17:45,000
guy in the back yelling it's in three I

369
00:17:40,640 --> 00:17:46,740
need to hire such a guy next time so

370
00:17:45,000 --> 00:17:49,290
yeah it's like full of III you know

371
00:17:46,740 --> 00:17:51,360
which are kind of let's say debug

372
00:17:49,290 --> 00:17:54,060
instructions put in the code by a

373
00:17:51,360 --> 00:17:56,070
compiler to pad the code so you don't

374
00:17:54,060 --> 00:17:58,470
want to make a signature on that because

375
00:17:56,070 --> 00:18:02,700
you'll find it in almost you know any

376
00:17:58,470 --> 00:18:04,260
other Windows program out there so if

377
00:18:02,700 --> 00:18:06,900
you look for the interesting strings

378
00:18:04,260 --> 00:18:09,960
like the one on top for instance you can

379
00:18:06,900 --> 00:18:11,370
make yarra rules like this one here and

380
00:18:09,960 --> 00:18:14,850
you see like different shell code

381
00:18:11,370 --> 00:18:17,070
fragments which appear in the shadow pad

382
00:18:14,850 --> 00:18:20,219
a PT samples for instance but they don't

383
00:18:17,070 --> 00:18:22,860
appear in any clean samples out there

384
00:18:20,220 --> 00:18:24,780
and this is like very powerful error

385
00:18:22,860 --> 00:18:27,209
rule which finds a lot of stuff so you

386
00:18:24,780 --> 00:18:30,149
can actually prove it you make the error

387
00:18:27,210 --> 00:18:32,610
rule you on one sample then you test it

388
00:18:30,150 --> 00:18:34,830
on several samples and you only keep the

389
00:18:32,610 --> 00:18:37,979
fragments of code which are found across

390
00:18:34,830 --> 00:18:38,970
different samples of the same family and

391
00:18:37,980 --> 00:18:41,010
then you run the

392
00:18:38,970 --> 00:18:43,620
rule on something like virustotal

393
00:18:41,010 --> 00:18:48,510
malware intelligence which allows you to

394
00:18:43,620 --> 00:18:51,120
do this just like some numbers about the

395
00:18:48,510 --> 00:18:54,360
system that we have we have a system

396
00:18:51,120 --> 00:18:56,610
that we call Jana which process is about

397
00:18:54,360 --> 00:18:59,789
the quarter million samples per day this

398
00:18:56,610 --> 00:19:02,820
way and it knows about 28 million good

399
00:18:59,789 --> 00:19:05,610
samples we actually we keep growing this

400
00:19:02,820 --> 00:19:09,330
number and it has like about 4 billion

401
00:19:05,610 --> 00:19:13,139
known good strings and about 8 billion

402
00:19:09,330 --> 00:19:15,539
known good opcode sequences so we know

403
00:19:13,140 --> 00:19:17,909
that those opcode sequences only appear

404
00:19:15,539 --> 00:19:20,100
in clean programs so when you have these

405
00:19:17,909 --> 00:19:23,309
everything which is left is basically

406
00:19:20,100 --> 00:19:25,260
suspicious so let me actually show some

407
00:19:23,309 --> 00:19:27,539
examples you know all this theory is

408
00:19:25,260 --> 00:19:31,530
nice but what about some real-world

409
00:19:27,539 --> 00:19:34,289
examples so for instance I was

410
00:19:31,530 --> 00:19:37,168
mentioning shadow pad before this was a

411
00:19:34,289 --> 00:19:40,379
very cool case a financial institution

412
00:19:37,169 --> 00:19:42,020
hired one of our guys to check their

413
00:19:40,380 --> 00:19:44,909
network they said we have some

414
00:19:42,020 --> 00:19:47,520
suspicions that there's something bad in

415
00:19:44,909 --> 00:19:50,280
our networks but we cannot find it so

416
00:19:47,520 --> 00:19:52,889
our guy went there he started looking at

417
00:19:50,280 --> 00:19:55,200
he found a D and some DNS requests to

418
00:19:52,890 --> 00:19:56,820
some kind of random looking domains they

419
00:19:55,200 --> 00:19:57,960
were originating from one of their

420
00:19:56,820 --> 00:20:00,299
payment servers

421
00:19:57,960 --> 00:20:03,659
so like a very sensitive system which

422
00:20:00,299 --> 00:20:05,639
was processing financial transactions so

423
00:20:03,659 --> 00:20:07,530
he looked there he couldn't find any

424
00:20:05,640 --> 00:20:10,409
malware so what he did he dumped the

425
00:20:07,530 --> 00:20:13,200
memory and he found a piece of code

426
00:20:10,409 --> 00:20:15,900
which was making those DNS calls it was

427
00:20:13,200 --> 00:20:18,270
in a software called nets Arang from a

428
00:20:15,900 --> 00:20:20,159
company called net sarang and this was

429
00:20:18,270 --> 00:20:22,530
like a legitimate software like a

430
00:20:20,159 --> 00:20:25,380
management server management software

431
00:20:22,530 --> 00:20:28,500
which appears to have been hacked by

432
00:20:25,380 --> 00:20:31,169
someone and injected with the malicious

433
00:20:28,500 --> 00:20:33,840
fragment of code about 40 kilobytes in

434
00:20:31,169 --> 00:20:35,490
size so the attackers which launched

435
00:20:33,840 --> 00:20:37,949
this attack I think they were pretty

436
00:20:35,490 --> 00:20:40,559
good they hacked into net Sarang they

437
00:20:37,950 --> 00:20:43,530
got their build server they got their

438
00:20:40,559 --> 00:20:48,000
source code they edited the source code

439
00:20:43,530 --> 00:20:51,370
in a very nice way and they linked this

440
00:20:48,000 --> 00:20:55,510
malicious program

441
00:20:51,370 --> 00:20:59,139
like they modified the linker in there

442
00:20:55,510 --> 00:21:01,990
let's say a production conveyor belt to

443
00:20:59,140 --> 00:21:04,240
include the malicious module in pretty

444
00:21:01,990 --> 00:21:06,760
much all their programs so it's like a

445
00:21:04,240 --> 00:21:09,400
pretty cool attack so we worked with the

446
00:21:06,760 --> 00:21:12,040
Nets around to you know identify the

447
00:21:09,400 --> 00:21:14,020
problem to mitigate it and so on but the

448
00:21:12,040 --> 00:21:16,809
question was of course who did it like

449
00:21:14,020 --> 00:21:18,760
who is as good as these guys to do

450
00:21:16,809 --> 00:21:21,160
something like this and we were able to

451
00:21:18,760 --> 00:21:23,350
find some similarities between one of

452
00:21:21,160 --> 00:21:25,960
the shadow pad plugins with our system

453
00:21:23,350 --> 00:21:28,600
and the plugin from a sample of served

454
00:21:25,960 --> 00:21:30,490
in a weed nti incident if in case you're

455
00:21:28,600 --> 00:21:35,110
not familiar with a twin nti is a

456
00:21:30,490 --> 00:21:37,780
malware used by two Chinese apt groups

457
00:21:35,110 --> 00:21:40,389
which both have like let's say different

458
00:21:37,780 --> 00:21:42,639
focuses one of them is hacking gaming

459
00:21:40,390 --> 00:21:45,220
companies and stealing you know e

460
00:21:42,640 --> 00:21:47,559
money's kind of things weapons virtual

461
00:21:45,220 --> 00:21:51,100
weapons which is pretty serious stuff

462
00:21:47,559 --> 00:21:54,940
and the other guys are stealing like

463
00:21:51,100 --> 00:21:56,918
submarine diagrams torpedoes and such

464
00:21:54,940 --> 00:21:59,590
which is also very serious stuff for

465
00:21:56,919 --> 00:22:02,140
other people so if you look at the code

466
00:21:59,590 --> 00:22:04,809
between these two plugins by the way if

467
00:22:02,140 --> 00:22:06,940
C is pretty much identical but what is

468
00:22:04,809 --> 00:22:09,639
it exactly so this is what it looks if

469
00:22:06,940 --> 00:22:12,820
when you reverse it in to see it's a

470
00:22:09,640 --> 00:22:16,390
hashing subroutine for api's and it's

471
00:22:12,820 --> 00:22:18,399
unique to this guy so we kind of we are

472
00:22:16,390 --> 00:22:20,530
confident that the guys who did this

473
00:22:18,400 --> 00:22:22,780
nets are wrong attack they're not the

474
00:22:20,530 --> 00:22:26,678
one with the games more likely they're

475
00:22:22,780 --> 00:22:29,950
the ones with the submarines or maybe

476
00:22:26,679 --> 00:22:32,440
the games the other big incident was a

477
00:22:29,950 --> 00:22:35,020
sick CCleaner attack from the last year

478
00:22:32,440 --> 00:22:37,240
this was pretty big as well because

479
00:22:35,020 --> 00:22:39,780
there are tens of millions of people

480
00:22:37,240 --> 00:22:43,390
running ccleaner and overnight CCleaner

481
00:22:39,780 --> 00:22:46,030
came with the malware inside in the same

482
00:22:43,390 --> 00:22:47,740
style that Nets around in the beginning

483
00:22:46,030 --> 00:22:50,470
let's say we couldn't find any

484
00:22:47,740 --> 00:22:52,960
connections but later we realized there

485
00:22:50,470 --> 00:22:55,660
was the same group behind the tooth and

486
00:22:52,960 --> 00:22:58,240
we immediately like checked it with our

487
00:22:55,660 --> 00:23:00,130
similarity system and we found that

488
00:22:58,240 --> 00:23:02,260
there's this fragment of code between

489
00:23:00,130 --> 00:23:03,429
the backdoor used in the ccleaner

490
00:23:02,260 --> 00:23:07,089
incident and

491
00:23:03,429 --> 00:23:10,450
a pt-17 backdoor called missile so I put

492
00:23:07,089 --> 00:23:12,249
it on Twitter there's like similarity

493
00:23:10,450 --> 00:23:14,379
with that and immediately the guys from

494
00:23:12,249 --> 00:23:16,389
in tester that I mentioned below they

495
00:23:14,379 --> 00:23:20,228
confirmed that their system also thinks

496
00:23:16,389 --> 00:23:22,839
the same and by the way if you run the

497
00:23:20,229 --> 00:23:25,389
yarra rule that we built from that it

498
00:23:22,839 --> 00:23:30,009
finds a bunch of different malware from

499
00:23:25,389 --> 00:23:33,008
this apt 17 guys so missile grass him

500
00:23:30,009 --> 00:23:37,059
and hike it and speaking of that by the

501
00:23:33,009 --> 00:23:38,409
way what is this missile thinking it's

502
00:23:37,059 --> 00:23:42,369
funny that they're calling the malware

503
00:23:38,409 --> 00:23:45,249
Mesa there's a very cool presentation

504
00:23:42,369 --> 00:23:47,589
from a guy called Chris McConkey that

505
00:23:45,249 --> 00:23:51,669
you can find on YouTube he was able to

506
00:23:47,589 --> 00:23:55,989
find the guy behind this he was able to

507
00:23:51,669 --> 00:23:58,479
find the exact guy who wrote the missile

508
00:23:55,989 --> 00:24:02,669
malware and his accounts on one six

509
00:23:58,479 --> 00:24:05,710
three the QQ account and so on and

510
00:24:02,669 --> 00:24:07,690
apparently this is a malware developer

511
00:24:05,710 --> 00:24:10,359
which created hi kid

512
00:24:07,690 --> 00:24:12,129
missile and grass seems all three so he

513
00:24:10,359 --> 00:24:15,968
has probably access to the source code

514
00:24:12,129 --> 00:24:17,978
which does this and the no veteran as a

515
00:24:15,969 --> 00:24:21,399
report published by a company called

516
00:24:17,979 --> 00:24:25,029
Nevada they pointed out that the malware

517
00:24:21,399 --> 00:24:27,309
these families of malware like for

518
00:24:25,029 --> 00:24:30,389
instance poison ivy and goes there used

519
00:24:27,309 --> 00:24:34,928
I think by different groups however

520
00:24:30,389 --> 00:24:37,269
tools like socks PNG Grasim and hike it

521
00:24:34,929 --> 00:24:39,909
they are only used by the axiom apt

522
00:24:37,269 --> 00:24:42,190
Group and the axiom apt group is one of

523
00:24:39,909 --> 00:24:44,409
the groups which use the winning TI

524
00:24:42,190 --> 00:24:48,099
malware in their attacks to steal the

525
00:24:44,409 --> 00:24:51,519
Submariner blueprints not the games

526
00:24:48,099 --> 00:24:56,349
basically so we kind of know now that it

527
00:24:51,519 --> 00:24:58,899
was those guys by the way this process

528
00:24:56,349 --> 00:25:01,450
of digging back I'm calling it sometimes

529
00:24:58,899 --> 00:25:03,879
cyber paleontology because you take

530
00:25:01,450 --> 00:25:07,059
something and you look for dinosaurs you

531
00:25:03,879 --> 00:25:09,520
know ten years ago or more here's

532
00:25:07,059 --> 00:25:12,879
another example of a

533
00:25:09,520 --> 00:25:14,530
rule created by our system for Reagan in

534
00:25:12,880 --> 00:25:17,770
case you're not familiar with Reagan

535
00:25:14,530 --> 00:25:19,780
there's a very good paper from Symantec

536
00:25:17,770 --> 00:25:22,210
about Reagan they were the first to

537
00:25:19,780 --> 00:25:26,200
publish it and we also published once a

538
00:25:22,210 --> 00:25:28,510
few days later this is one of the most

539
00:25:26,200 --> 00:25:31,930
sophisticated apts we have seen which

540
00:25:28,510 --> 00:25:33,850
targeted GSM operators telecommunication

541
00:25:31,930 --> 00:25:36,940
companies and so on and they had the

542
00:25:33,850 --> 00:25:39,280
ability to mess with the base stations

543
00:25:36,940 --> 00:25:43,090
in GSM networks in order to intercept

544
00:25:39,280 --> 00:25:46,030
calls or to launch destructive attacks

545
00:25:43,090 --> 00:25:49,270
if they wanted the same so when we run

546
00:25:46,030 --> 00:25:51,790
this Yara rule on our mother collection

547
00:25:49,270 --> 00:25:58,090
one of the first hits we had was on a

548
00:25:51,790 --> 00:26:00,490
shadow brokers dealer called CN L i dot

549
00:25:58,090 --> 00:26:02,139
dll so we immediately if you look there

550
00:26:00,490 --> 00:26:05,110
and you see there's like a lot of code

551
00:26:02,140 --> 00:26:08,290
overlap so we look there and we see that

552
00:26:05,110 --> 00:26:13,120
this CN li dachuan it actually has a

553
00:26:08,290 --> 00:26:16,480
bunch of exports such as see any file

554
00:26:13,120 --> 00:26:20,260
IOC any file I oh dear next and so on so

555
00:26:16,480 --> 00:26:21,940
pretty much all file system functions

556
00:26:20,260 --> 00:26:24,490
that you can imagine they're implemented

557
00:26:21,940 --> 00:26:31,510
by this dealer by there any idea what is

558
00:26:24,490 --> 00:26:33,580
CN e well I think there's different

559
00:26:31,510 --> 00:26:37,150
explanations one of them could be it's a

560
00:26:33,580 --> 00:26:39,790
computer network exploitation so like in

561
00:26:37,150 --> 00:26:41,050
this terminology used by spy agency

562
00:26:39,790 --> 00:26:43,840
there's computer network exploitation

563
00:26:41,050 --> 00:26:46,120
and there's computer network attack

564
00:26:43,840 --> 00:26:49,179
which is they're worse for espionage and

565
00:26:46,120 --> 00:26:51,750
sabotage so CN e is another way of

566
00:26:49,180 --> 00:26:54,580
saying exploitation of networks

567
00:26:51,750 --> 00:26:57,430
espionage basically so it's a library

568
00:26:54,580 --> 00:27:00,070
pretty much a library which is matched

569
00:26:57,430 --> 00:27:02,230
by got this code signature from the

570
00:27:00,070 --> 00:27:04,480
shadow brokers dump and nothing else so

571
00:27:02,230 --> 00:27:07,690
if you look inside actually what is the

572
00:27:04,480 --> 00:27:10,600
code doing well this particular fragment

573
00:27:07,690 --> 00:27:14,200
of Co is a wrapper for the pretty much

574
00:27:10,600 --> 00:27:16,209
less a standard i/o functions in the

575
00:27:14,200 --> 00:27:18,550
operating system such as write file for

576
00:27:16,210 --> 00:27:21,850
instance you see it here in a Reagan

577
00:27:18,550 --> 00:27:23,320
sample in the CN li dachuan dealer so

578
00:27:21,850 --> 00:27:25,899
why do you need such a library

579
00:27:23,320 --> 00:27:28,300
to make our code portable on any

580
00:27:25,900 --> 00:27:30,310
operating system so this way by

581
00:27:28,300 --> 00:27:32,800
implementing this functions from the

582
00:27:30,310 --> 00:27:35,139
library they can compile their code for

583
00:27:32,800 --> 00:27:38,740
pretty much any operating system where

584
00:27:35,140 --> 00:27:42,430
cnl is available like you know unique

585
00:27:38,740 --> 00:27:45,850
system Solaris Linux even Reuters of

586
00:27:42,430 --> 00:27:49,240
course another cool case which we

587
00:27:45,850 --> 00:27:52,270
analyzed the case of the lamberts apt so

588
00:27:49,240 --> 00:27:56,920
this started in 2014 with the zero-day

589
00:27:52,270 --> 00:28:00,460
attack on a nuclear research agency in

590
00:27:56,920 --> 00:28:02,350
the European Union basically so from

591
00:28:00,460 --> 00:28:05,740
there we call the malware we call it a

592
00:28:02,350 --> 00:28:08,230
black Lambert because you know it sounds

593
00:28:05,740 --> 00:28:10,450
scary so it was like a scary attack so

594
00:28:08,230 --> 00:28:12,760
like the black line so next we found

595
00:28:10,450 --> 00:28:14,830
another malware which was maybe a bit

596
00:28:12,760 --> 00:28:17,320
less scary so we called it a white

597
00:28:14,830 --> 00:28:20,649
Lambert you know just to be politically

598
00:28:17,320 --> 00:28:22,060
correct and not have any issues then we

599
00:28:20,650 --> 00:28:23,800
had another one we found the blue

600
00:28:22,060 --> 00:28:27,399
Lambert the green Lambert the ping

601
00:28:23,800 --> 00:28:29,740
Lambert you know we want to be like fair

602
00:28:27,400 --> 00:28:31,390
and square and the grey Lambert and the

603
00:28:29,740 --> 00:28:33,610
brown line with the red Lambert the goal

604
00:28:31,390 --> 00:28:38,020
number is like kind of a neverending

605
00:28:33,610 --> 00:28:40,540
story with the with the Lambert's and we

606
00:28:38,020 --> 00:28:42,970
published about this semantics again

607
00:28:40,540 --> 00:28:46,629
published about their own analysis I

608
00:28:42,970 --> 00:28:48,520
think semantics were the first and a few

609
00:28:46,630 --> 00:28:51,670
days later we also published our own

610
00:28:48,520 --> 00:28:54,160
analysis and if you look at the time

611
00:28:51,670 --> 00:28:56,500
line of discoveries we found we started

612
00:28:54,160 --> 00:28:59,710
looking into the black Lambert in 2014

613
00:28:56,500 --> 00:29:03,400
and it took like about three years of

614
00:28:59,710 --> 00:29:08,410
research to find the brown Lambert in

615
00:29:03,400 --> 00:29:09,880
October 2017 so maybe some will say it's

616
00:29:08,410 --> 00:29:12,130
you know it's kind of crazy to waste

617
00:29:09,880 --> 00:29:15,760
three years of your life chasing colors

618
00:29:12,130 --> 00:29:17,590
you know malware comes but it's one of

619
00:29:15,760 --> 00:29:20,980
the things I think which makes this job

620
00:29:17,590 --> 00:29:23,709
interesting because you work with very

621
00:29:20,980 --> 00:29:26,440
cool things and this is why I really

622
00:29:23,710 --> 00:29:29,080
like my job because we always have to do

623
00:29:26,440 --> 00:29:31,600
interesting things by the way the

624
00:29:29,080 --> 00:29:33,850
Lambert's also had malware for OS 10 so

625
00:29:31,600 --> 00:29:37,149
for Mac and we suspect they also had

626
00:29:33,850 --> 00:29:41,169
Muller for UNIX systems and they were

627
00:29:37,150 --> 00:29:44,380
active probably since 2009 or before so

628
00:29:41,170 --> 00:29:46,840
we put our code similarity system just

629
00:29:44,380 --> 00:29:48,940
in case to see how it works through

630
00:29:46,840 --> 00:29:49,689
these different Lambert samples and we

631
00:29:48,940 --> 00:29:52,420
immediately

632
00:29:49,690 --> 00:29:54,370
it found a shared code fragment which

633
00:29:52,420 --> 00:29:57,400
appears in the while amber the black

634
00:29:54,370 --> 00:29:59,409
Lambert and brown Lambert so you know

635
00:29:57,400 --> 00:30:02,040
this this took like a couple of minutes

636
00:29:59,410 --> 00:30:04,420
so for us who like spent three years

637
00:30:02,040 --> 00:30:06,399
looking for connections you know

638
00:30:04,420 --> 00:30:09,490
obviously we didn't spend all the three

639
00:30:06,400 --> 00:30:11,560
years doing only this but things are

640
00:30:09,490 --> 00:30:13,600
kind of slow you know when you jump from

641
00:30:11,560 --> 00:30:15,790
one to another you load it in high dial

642
00:30:13,600 --> 00:30:17,770
you look at the code you think what

643
00:30:15,790 --> 00:30:20,620
could be common code and all of these

644
00:30:17,770 --> 00:30:23,410
can be now done like in a more pretty

645
00:30:20,620 --> 00:30:25,860
much matter of minutes here's another

646
00:30:23,410 --> 00:30:28,540
example for the wanna cry thing

647
00:30:25,860 --> 00:30:31,360
replicating what Google did so a

648
00:30:28,540 --> 00:30:33,520
fragment of code from wanna cry which

649
00:30:31,360 --> 00:30:34,840
catches a balloon or of malware used in

650
00:30:33,520 --> 00:30:38,139
the Bangladesh heist

651
00:30:34,840 --> 00:30:40,300
manuscript malware which is used in a

652
00:30:38,140 --> 00:30:42,850
bunch of very cool attacks against

653
00:30:40,300 --> 00:30:45,490
crypto currency exchanges for instance

654
00:30:42,850 --> 00:30:46,870
and my colleague choong-soo Park will

655
00:30:45,490 --> 00:30:50,290
talk about this tomorrow

656
00:30:46,870 --> 00:30:54,449
cyber attacks against crypto currency

657
00:30:50,290 --> 00:30:57,010
exchanges in South Korea but I hope

658
00:30:54,450 --> 00:30:59,200
everybody purchased bitcoins when they

659
00:30:57,010 --> 00:31:00,970
were like a dollar a piece right and

660
00:30:59,200 --> 00:31:05,950
solve them when they were twenty

661
00:31:00,970 --> 00:31:09,460
thousand right and deca Fett is another

662
00:31:05,950 --> 00:31:13,480
key logger used by the by the Lazaro and

663
00:31:09,460 --> 00:31:15,640
there's also like another code fragment

664
00:31:13,480 --> 00:31:17,290
extracted by our system with for

665
00:31:15,640 --> 00:31:19,750
instance it catches the dark hotel

666
00:31:17,290 --> 00:31:22,649
samples it's a pretty interesting apt

667
00:31:19,750 --> 00:31:26,020
that we found was targeting hotels and

668
00:31:22,650 --> 00:31:27,399
they would hack into the Wi-Fi system of

669
00:31:26,020 --> 00:31:29,440
the hotel and

670
00:31:27,399 --> 00:31:32,320
reservation system and they will have

671
00:31:29,440 --> 00:31:34,659
the ability to see who checks in in what

672
00:31:32,320 --> 00:31:36,489
rooms and only the people which were

673
00:31:34,659 --> 00:31:38,769
interesting for to them would get

674
00:31:36,489 --> 00:31:41,379
targeted so when they connected to the

675
00:31:38,769 --> 00:31:43,809
Wi-Fi they would have like a prompt to

676
00:31:41,379 --> 00:31:46,809
update your Flash Player you know how

677
00:31:43,809 --> 00:31:49,389
that else so if you download the Flash

678
00:31:46,809 --> 00:31:52,210
Player and you know the people who

679
00:31:49,389 --> 00:31:54,789
usually do stay in these hotels they're

680
00:31:52,210 --> 00:31:56,200
not security experts but when you see

681
00:31:54,789 --> 00:31:58,210
that you cannot connect to the Wi-Fi

682
00:31:56,200 --> 00:32:00,879
unless you have the latest Flash Player

683
00:31:58,210 --> 00:32:05,529
what can you do you need to work so you

684
00:32:00,879 --> 00:32:10,658
download it of course so I think pretty

685
00:32:05,529 --> 00:32:13,089
much this is how the new yara rules look

686
00:32:10,659 --> 00:32:16,479
you know and when you have the ability

687
00:32:13,089 --> 00:32:19,450
to do yara rules without codes so what

688
00:32:16,479 --> 00:32:22,599
does it all mean like you know i would

689
00:32:19,450 --> 00:32:26,529
say this pretty much it brings us to the

690
00:32:22,599 --> 00:32:29,200
age of attribution 2.0 so what do we

691
00:32:26,529 --> 00:32:31,389
mean by attribution 2.0 well first of

692
00:32:29,200 --> 00:32:32,889
all we can do now things which took

693
00:32:31,389 --> 00:32:35,799
years we can do it in a matter of

694
00:32:32,889 --> 00:32:37,539
minutes and I think that as I said

695
00:32:35,799 --> 00:32:40,259
Google has probably an amazing

696
00:32:37,539 --> 00:32:42,759
technology integer has technology

697
00:32:40,259 --> 00:32:44,710
Crosstrek has a I think pretty much

698
00:32:42,759 --> 00:32:47,139
everybody will have this technology in

699
00:32:44,710 --> 00:32:49,149
two three years so what it means is that

700
00:32:47,139 --> 00:32:51,218
now you'll be able to very quickly say

701
00:32:49,149 --> 00:32:54,248
when there's a cyber attack we'll be

702
00:32:51,219 --> 00:32:56,619
able to say yeah we suspect with some

703
00:32:54,249 --> 00:32:59,169
degree of confidence that it's that apt

704
00:32:56,619 --> 00:33:01,330
but what does it mean also as an effect

705
00:32:59,169 --> 00:33:04,749
we think they'll see more false flags

706
00:33:01,330 --> 00:33:08,139
and the best examples the Lazarus group

707
00:33:04,749 --> 00:33:09,909
for instance but after the NSA said that

708
00:33:08,139 --> 00:33:11,769
the Lazarus group attacks they think

709
00:33:09,909 --> 00:33:13,929
they're linked to North Korea they

710
00:33:11,769 --> 00:33:15,789
started putting Russian keywords in the

711
00:33:13,929 --> 00:33:18,219
mother like but really bad Russian

712
00:33:15,789 --> 00:33:18,729
keywords like nobody writes them that

713
00:33:18,219 --> 00:33:21,249
way

714
00:33:18,729 --> 00:33:23,259
so it didn't fool anyone obviously why

715
00:33:21,249 --> 00:33:25,989
was like an attempt you know to blame

716
00:33:23,259 --> 00:33:27,969
Russia because nowadays is fashionable

717
00:33:25,989 --> 00:33:30,729
to them to just blame Russia for

718
00:33:27,969 --> 00:33:35,229
everything I guess and the other thing

719
00:33:30,729 --> 00:33:37,269
is the Olympic destroyer case which I

720
00:33:35,229 --> 00:33:39,099
think it's quite interesting in which

721
00:33:37,269 --> 00:33:41,050
they try to blame North Korea

722
00:33:39,099 --> 00:33:44,290
some people said you know it's a

723
00:33:41,050 --> 00:33:47,200
for the Russian keywords in the Lazaro

724
00:33:44,290 --> 00:33:49,060
smaller so what happened there they

725
00:33:47,200 --> 00:33:50,890
tried ever to fool everybody thinking

726
00:33:49,060 --> 00:33:52,750
into the fact that North Korea was

727
00:33:50,890 --> 00:33:55,480
launching these attacks on the Olympic

728
00:33:52,750 --> 00:33:59,050
Games so of course we think that we'll

729
00:33:55,480 --> 00:34:02,830
also have more shell related attacks

730
00:33:59,050 --> 00:34:05,050
power shell partial Empire you know this

731
00:34:02,830 --> 00:34:06,790
kind of frameworks and those are like

732
00:34:05,050 --> 00:34:08,949
very difficult to attribute because if

733
00:34:06,790 --> 00:34:11,409
all the trade actors start using

734
00:34:08,949 --> 00:34:13,750
open-source tools you don't know who is

735
00:34:11,409 --> 00:34:17,649
who anymore so I think that will be the

736
00:34:13,750 --> 00:34:19,540
next level of challenge and if you look

737
00:34:17,649 --> 00:34:22,149
let's say just to leave you guys with

738
00:34:19,540 --> 00:34:25,239
the final picture of what I think the

739
00:34:22,149 --> 00:34:28,270
information war looks nowadays well we

740
00:34:25,239 --> 00:34:30,399
have on one hand we have espionage and

741
00:34:28,270 --> 00:34:32,830
we have sabotage which both use malware

742
00:34:30,399 --> 00:34:35,799
and I think we got pretty good at

743
00:34:32,830 --> 00:34:38,710
catching this we are able we know how to

744
00:34:35,800 --> 00:34:41,530
do this there's one thing which is more

745
00:34:38,710 --> 00:34:44,649
worrying in my opinion and that one is a

746
00:34:41,530 --> 00:34:48,070
mass opinion manipulation you know the

747
00:34:44,649 --> 00:34:52,299
kind of fake news attacks Facebook

748
00:34:48,070 --> 00:34:54,130
related mass opinion manipulation and

749
00:34:52,300 --> 00:34:56,110
for that I don't think we have a

750
00:34:54,130 --> 00:34:58,750
solution and I believe that we as a

751
00:34:56,110 --> 00:35:01,510
security community we have to do

752
00:34:58,750 --> 00:35:04,930
something by ourselves in order to help

753
00:35:01,510 --> 00:35:07,450
so it's our duty to work in this

754
00:35:04,930 --> 00:35:09,850
direction and if we don't I'm worried

755
00:35:07,450 --> 00:35:12,819
about the future of democracy

756
00:35:09,850 --> 00:35:15,970
so with this positive thing in mind

757
00:35:12,820 --> 00:35:17,130
please help us save the world and thank

758
00:35:15,970 --> 00:35:18,689
you very much

759
00:35:17,130 --> 00:35:20,130
things

760
00:35:18,690 --> 00:35:23,619
[Applause]

761
00:35:20,130 --> 00:35:23,619
[Music]

762
00:35:28,850 --> 00:35:30,910
you

