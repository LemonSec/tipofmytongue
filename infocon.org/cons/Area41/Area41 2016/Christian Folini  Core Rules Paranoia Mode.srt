1
00:00:05,790 --> 00:00:12,309
thank you<font color="#CCCCCC"> very</font><font color="#E5E5E5"> much for the welcome here</font>

2
00:00:08,380 --> 00:00:14,650
at area 41 it's a pleasure<font color="#E5E5E5"> to and an</font>

3
00:00:12,309 --> 00:00:16,689
honor to open the tech talks on<font color="#CCCCCC"> the main</font>

4
00:00:14,650 --> 00:00:19,300
stage with my talk on the<font color="#CCCCCC"> corrals</font>

5
00:00:16,690 --> 00:00:21,789
paranoia mode in fact I've<font color="#E5E5E5"> been looking</font>

6
00:00:19,300 --> 00:00:24,669
forward to this presentation all winter

7
00:00:21,789 --> 00:00:29,369
and spring when we were developing the

8
00:00:24,669 --> 00:00:32,590
<font color="#E5E5E5">corrals paranoia mode have you guys read</font>

9
00:00:29,369 --> 00:00:36,000
<font color="#E5E5E5">Jessica Parker's article on the</font><font color="#CCCCCC"> impostor</font>

10
00:00:32,590 --> 00:00:38,380
syndrome last week who has read that

11
00:00:36,000 --> 00:00:42,730
you're not familiar with that you<font color="#E5E5E5"> have</font>

12
00:00:38,380 --> 00:00:44,470
<font color="#E5E5E5">read</font><font color="#CCCCCC"> our no hay so Jessica Parker at</font>

13
00:00:42,730 --> 00:00:47,319
this idea that in the IT security

14
00:00:44,470 --> 00:00:49,600
industry a lot of<font color="#CCCCCC"> people</font><font color="#E5E5E5"> have this</font>

15
00:00:47,320 --> 00:00:53,020
feeling that there is self-appointed

16
00:00:49,600 --> 00:00:55,690
experts without the formal education

17
00:00:53,020 --> 00:00:57,160
that<font color="#E5E5E5"> they're an</font><font color="#CCCCCC"> imposter somehow and</font>

18
00:00:55,690 --> 00:01:00,820
when they're standing on a stage

19
00:00:57,160 --> 00:01:04,059
addressing the audience a lot if<font color="#E5E5E5"> not</font>

20
00:01:00,820 --> 00:01:06,670
most of IT security people feel like

21
00:01:04,059 --> 00:01:09,310
they're a fraud<font color="#CCCCCC"> during a poster</font><font color="#E5E5E5"> and</font>

22
00:01:06,670 --> 00:01:12,759
anytime somebody could walk up to them

23
00:01:09,310 --> 00:01:15,130
and tell the<font color="#CCCCCC"> world that they're naked</font>

24
00:01:12,759 --> 00:01:18,789
we're<font color="#CCCCCC"> standing naked in front of the</font>

25
00:01:15,130 --> 00:01:23,318
audience<font color="#E5E5E5"> and we fear to be disposed we</font>

26
00:01:18,789 --> 00:01:25,539
fear were in posters now as michelle has

27
00:01:23,319 --> 00:01:27,609
told you I have a PhD in medieval

28
00:01:25,539 --> 00:01:31,119
history and what you're<font color="#CCCCCC"> about to witness</font>

29
00:01:27,609 --> 00:01:32,710
is a medieval historian pretending to

30
00:01:31,119 --> 00:01:35,139
know something about application

31
00:01:32,710 --> 00:01:37,479
security and if there ever was an

32
00:01:35,139 --> 00:01:42,249
<font color="#E5E5E5">impostor in the IT security industry it</font>

33
00:01:37,479 --> 00:01:46,590
must<font color="#E5E5E5"> be me take of this what you will</font>

34
00:01:42,249 --> 00:01:46,589
but I sure hope<font color="#CCCCCC"> you enjoy the show</font>

35
00:01:47,039 --> 00:01:52,689
modsecurity talks are usually in front

36
00:01:50,020 --> 00:01:56,319
of smaller audiences and if a look

37
00:01:52,689 --> 00:01:58,568
around some<font color="#E5E5E5"> of you like this</font><font color="#CCCCCC"> crazy look</font>

38
00:01:56,319 --> 00:02:02,139
in the eyes which you get from writing

39
00:01:58,569 --> 00:02:04,749
regular expressions all day<font color="#CCCCCC"> long this</font>

40
00:02:02,139 --> 00:02:07,630
tells me somehow that I should probably

41
00:02:04,749 --> 00:02:11,410
introduce web application firewalls

42
00:02:07,630 --> 00:02:15,849
modsecurity and the OS modsecurity<font color="#CCCCCC"> core</font>

43
00:02:11,410 --> 00:02:17,799
rules to begin with that is a bit<font color="#E5E5E5"> boring</font>

44
00:02:15,849 --> 00:02:19,299
for the most security people around but

45
00:02:17,799 --> 00:02:21,160
I think it's<font color="#E5E5E5"> really necessary for</font>

46
00:02:19,300 --> 00:02:23,650
the rest of the audience to really

47
00:02:21,160 --> 00:02:26,440
understand<font color="#E5E5E5"> and appreciate the rest of</font>

48
00:02:23,650 --> 00:02:29,040
the talk so much security guys this is

49
00:02:26,440 --> 00:02:32,079
<font color="#E5E5E5">the moment where you could take a nap or</font>

50
00:02:29,040 --> 00:02:34,359
right through a few regular expressions

51
00:02:32,080 --> 00:02:41,260
will wake you when we need your

52
00:02:34,360 --> 00:02:44,020
expertise good so much security is a web

53
00:02:41,260 --> 00:02:47,320
application firewall one which probably

54
00:02:44,020 --> 00:02:49,420
has the biggest user base in the

55
00:02:47,320 --> 00:02:52,269
<font color="#E5E5E5">internet the highest number of installs</font>

56
00:02:49,420 --> 00:02:55,600
but web application firewalls they have

57
00:02:52,270 --> 00:02:59,080
a<font color="#E5E5E5"> very bad name the bad name is probably</font>

58
00:02:55,600 --> 00:03:03,280
due to the<font color="#E5E5E5"> PCI standard which made the</font>

59
00:02:59,080 --> 00:03:06,100
use of a wolf mandatory now<font color="#CCCCCC"> PCI has been</font>

60
00:03:03,280 --> 00:03:09,160
called it'll take so many times I do not

61
00:03:06,100 --> 00:03:12,160
want<font color="#E5E5E5"> to repeat it here on stage but if</font>

62
00:03:09,160 --> 00:03:17,410
there is one<font color="#CCCCCC"> thing that pc i got right</font>

63
00:03:12,160 --> 00:03:19,630
it was to make above mandatory now of

64
00:03:17,410 --> 00:03:21,370
<font color="#CCCCCC">course in an ideal world we</font><font color="#E5E5E5"> wouldn't</font>

65
00:03:19,630 --> 00:03:23,859
need a web application firewall in an

66
00:03:21,370 --> 00:03:25,840
ideal<font color="#CCCCCC"> world there wouldn't be any buffer</font>

67
00:03:23,860 --> 00:03:28,450
overflows in applications and

68
00:03:25,840 --> 00:03:30,760
applications will not expose SQL

69
00:03:28,450 --> 00:03:34,209
injection vulnerabilities to the

70
00:03:30,760 --> 00:03:36,899
<font color="#E5E5E5">internet and developers would actually</font>

71
00:03:34,209 --> 00:03:41,260
know what a secure flag on a cookie is

72
00:03:36,900 --> 00:03:43,870
but the internet being man-made is as

73
00:03:41,260 --> 00:03:49,000
imperfect as anything else<font color="#E5E5E5"> man ever</font>

74
00:03:43,870 --> 00:03:51,630
built so it turns<font color="#E5E5E5"> out buffer overflows</font>

75
00:03:49,000 --> 00:03:54,160
are still very<font color="#E5E5E5"> much alive and</font>

76
00:03:51,630 --> 00:03:57,269
applications are plagued by forever days

77
00:03:54,160 --> 00:04:01,000
do you<font color="#E5E5E5"> guys know what a forever day is</font>

78
00:03:57,270 --> 00:04:05,680
now really<font color="#E5E5E5"> a for every day is a sero to</font>

79
00:04:01,000 --> 00:04:08,350
exploit which is not fixed ever so it's

80
00:04:05,680 --> 00:04:11,230
a flaw which is persisting nobody's

81
00:04:08,350 --> 00:04:13,840
fixing it so buffer overflows are still

82
00:04:11,230 --> 00:04:16,358
alive applications are plagued by for

83
00:04:13,840 --> 00:04:18,190
every<font color="#CCCCCC"> day's and the developers of the</font>

84
00:04:16,358 --> 00:04:21,459
<font color="#E5E5E5">legacy applications left the house</font>

85
00:04:18,190 --> 00:04:25,060
without leaving a number or any sort of

86
00:04:21,459 --> 00:04:29,370
usable documentation behind and<font color="#E5E5E5"> that's</font>

87
00:04:25,060 --> 00:04:33,220
the situation and now vas to the rescue

88
00:04:29,370 --> 00:04:35,110
we have to patch a service without

89
00:04:33,220 --> 00:04:37,720
touching the source code of<font color="#CCCCCC"> the</font>

90
00:04:35,110 --> 00:04:41,140
application we<font color="#E5E5E5"> have to do layered</font>

91
00:04:37,720 --> 00:04:44,380
defense now we have to do defense in

92
00:04:41,140 --> 00:04:47,020
death as they call it we impose access

93
00:04:44,380 --> 00:04:50,050
restrictions on the services<font color="#E5E5E5"> and we</font>

94
00:04:47,020 --> 00:04:54,130
install<font color="#E5E5E5"> mod security as a means of</font>

95
00:04:50,050 --> 00:04:56,860
Defense where we hope to<font color="#CCCCCC"> do virtual</font>

96
00:04:54,130 --> 00:04:59,830
patching that's a crazy term so you

97
00:04:56,860 --> 00:05:02,410
provide<font color="#E5E5E5"> a virtual patch to fix an</font>

98
00:04:59,830 --> 00:05:05,320
application which you cannot really fix

99
00:05:02,410 --> 00:05:08,170
and that's a very<font color="#E5E5E5"> stupid idea I agree</font>

100
00:05:05,320 --> 00:05:11,190
with<font color="#E5E5E5"> you but then I did not write the</font>

101
00:05:08,170 --> 00:05:14,320
goddamn code and all I trying to<font color="#E5E5E5"> do is</font>

102
00:05:11,190 --> 00:05:23,770
helping fixing it when the developer<font color="#E5E5E5"> is</font>

103
00:05:14,320 --> 00:05:27,070
already gone or cannot be reached so web

104
00:05:23,770 --> 00:05:29,950
application firewalls that's how of

105
00:05:27,070 --> 00:05:32,710
application firewall install looks very

106
00:05:29,950 --> 00:05:35,320
often I see three different<font color="#CCCCCC"> kinds of</font>

107
00:05:32,710 --> 00:05:39,000
setups there are the naive setups the

108
00:05:35,320 --> 00:05:41,680
<font color="#CCCCCC">overwhelm</font><font color="#E5E5E5"> setups and in rare cases</font>

109
00:05:39,000 --> 00:05:44,140
functional setups what is a naive<font color="#E5E5E5"> wife</font>

110
00:05:41,680 --> 00:05:46,540
set up a naive one is where the

111
00:05:44,140 --> 00:05:50,110
administrator or at least his manager

112
00:05:46,540 --> 00:05:52,660
things that the vas is functioning<font color="#E5E5E5"> the</font>

113
00:05:50,110 --> 00:05:54,550
complete lack of false positives could

114
00:05:52,660 --> 00:05:56,320
point them in the direction that<font color="#E5E5E5"> the</font>

115
00:05:54,550 --> 00:05:58,900
valve is actually not working properly

116
00:05:56,320 --> 00:06:01,810
it's probably<font color="#E5E5E5"> not enabled it's probably</font>

117
00:05:58,900 --> 00:06:03,940
deployed out of band it doesn't see any

118
00:06:01,810 --> 00:06:07,270
traffic or if it sees the traffic it's

119
00:06:03,940 --> 00:06:09,790
sending the alerts to death null and you

120
00:06:07,270 --> 00:06:12,789
will be surprised how many people invest

121
00:06:09,790 --> 00:06:16,660
precious money into licenses of

122
00:06:12,790 --> 00:06:20,620
commercial<font color="#CCCCCC"> vas products and then have</font>

123
00:06:16,660 --> 00:06:23,050
them<font color="#E5E5E5"> collect dust in a corner very often</font>

124
00:06:20,620 --> 00:06:25,990
people are overwhelmed so these are new

125
00:06:23,050 --> 00:06:28,720
projects new<font color="#CCCCCC"> settlements they</font><font color="#E5E5E5"> approached</font>

126
00:06:25,990 --> 00:06:31,060
modsecurity or the sort of wasps they

127
00:06:28,720 --> 00:06:33,100
<font color="#E5E5E5">deploy it and they they buried</font>

128
00:06:31,060 --> 00:06:37,919
immediately underneath the youth

129
00:06:33,100 --> 00:06:41,010
avalanche of locks false alarms rules

130
00:06:37,919 --> 00:06:43,870
reports and all sort<font color="#E5E5E5"> of madness</font>

131
00:06:41,010 --> 00:06:46,990
deploying a web application firewall is

132
00:06:43,870 --> 00:06:49,780
hard and when you do it the<font color="#E5E5E5"> first time</font>

133
00:06:46,990 --> 00:06:52,720
you're really overwhelmed without very

134
00:06:49,780 --> 00:06:55,270
good guidance and very good team you

135
00:06:52,720 --> 00:06:58,240
<font color="#E5E5E5">will not pull this off and people very</font>

136
00:06:55,270 --> 00:07:00,880
often shy away when I first seen it in

137
00:06:58,240 --> 00:07:03,670
action when it has first trashed or set

138
00:07:00,880 --> 00:07:07,300
up and they can no longer continue to be

139
00:07:03,670 --> 00:07:10,270
productive and then in rare cases people

140
00:07:07,300 --> 00:07:12,310
step out of this situation and they

141
00:07:10,270 --> 00:07:15,520
actually managed to run a functional

142
00:07:12,310 --> 00:07:17,680
<font color="#E5E5E5">modsecurity setup and what I mean we</font>

143
00:07:15,520 --> 00:07:19,510
functionally is a tight blocking mode

144
00:07:17,680 --> 00:07:22,660
which is<font color="#E5E5E5"> actually protecting the</font>

145
00:07:19,510 --> 00:07:24,909
application it is actively monitored so

146
00:07:22,660 --> 00:07:28,630
the alerts are actually meeting somebody

147
00:07:24,910 --> 00:07:31,510
and the configuration is continually

148
00:07:28,630 --> 00:07:33,870
adjusted to the dynamic<font color="#CCCCCC"> and fast-moving</font>

149
00:07:31,510 --> 00:07:37,539
application which<font color="#CCCCCC"> is continually</font>

150
00:07:33,870 --> 00:07:40,140
developed the core of<font color="#E5E5E5"> all this problem</font>

151
00:07:37,540 --> 00:07:43,420
is of<font color="#CCCCCC"> course the rules because the</font>

152
00:07:40,140 --> 00:07:45,820
<font color="#CCCCCC">engine itself is innocent and nice but</font>

153
00:07:43,420 --> 00:07:48,310
it's the rules which act as the sensor

154
00:07:45,820 --> 00:07:50,710
it's the rule that<font color="#E5E5E5"> interact</font><font color="#CCCCCC"> with the</font>

155
00:07:48,310 --> 00:07:53,470
requests with the<font color="#CCCCCC"> Internet reactive week</font>

156
00:07:50,710 --> 00:07:57,549
and it's the rules which generate the

157
00:07:53,470 --> 00:08:09,340
few real alerts and the great many false

158
00:07:57,550 --> 00:08:12,040
positives now modsecurity is no

159
00:08:09,340 --> 00:08:14,979
<font color="#CCCCCC">self-learning masterpiece as commercials</font>

160
00:08:12,040 --> 00:08:18,690
on commercial products it is also no

161
00:08:14,980 --> 00:08:21,520
neuronal<font color="#CCCCCC"> network and it's no black magic</font>

162
00:08:18,690 --> 00:08:25,030
it's much more a mechanical piece of

163
00:08:21,520 --> 00:08:27,130
code with granular control and I have

164
00:08:25,030 --> 00:08:31,150
made<font color="#CCCCCC"> a few rough edges around the corner</font>

165
00:08:27,130 --> 00:08:34,360
it's<font color="#CCCCCC"> much like a mechanical watch where</font>

166
00:08:31,150 --> 00:08:37,179
the mechanic would use his little

167
00:08:34,360 --> 00:08:39,909
screwdriver to interact with<font color="#E5E5E5"> the</font><font color="#CCCCCC"> setup</font>

168
00:08:37,179 --> 00:08:42,459
<font color="#E5E5E5">and try to change the configuration</font>

169
00:08:39,909 --> 00:08:46,449
within to make sure that the<font color="#E5E5E5"> internet</font>

170
00:08:42,460 --> 00:08:50,680
traffic passes the valve without too

171
00:08:46,450 --> 00:08:54,310
many false alarms this is the real image

172
00:08:50,680 --> 00:08:56,650
of a mall security installation this can

173
00:08:54,310 --> 00:09:00,130
be understood but if you look inside is

174
00:08:56,650 --> 00:09:04,670
watch it's a bit complicated isn't it

175
00:09:00,130 --> 00:09:08,320
web application firewalls can be defined

176
00:09:04,670 --> 00:09:11,329
by rules and rule sets come in two forms

177
00:09:08,320 --> 00:09:13,880
they come in a white listing in a black

178
00:09:11,330 --> 00:09:16,730
listing forum we also call this positive

179
00:09:13,880 --> 00:09:18,650
or negative security models you all know

180
00:09:16,730 --> 00:09:21,650
the<font color="#E5E5E5"> white listing that's how a network</font>

181
00:09:18,650 --> 00:09:24,740
firewall works you close everything<font color="#E5E5E5"> and</font>

182
00:09:21,650 --> 00:09:27,890
then you allow the selective few ports

183
00:09:24,740 --> 00:09:30,680
which you want to<font color="#E5E5E5"> see the ports where</font>

184
00:09:27,890 --> 00:09:32,510
you have an application running that's

185
00:09:30,680 --> 00:09:35,180
nice and everything on the network<font color="#E5E5E5"> level</font>

186
00:09:32,510 --> 00:09:37,880
but when<font color="#E5E5E5"> you move</font><font color="#CCCCCC"> up the application</font>

187
00:09:35,180 --> 00:09:41,780
<font color="#CCCCCC">layer up to the application layer it</font>

188
00:09:37,880 --> 00:09:44,689
gets very complicated selinux<font color="#E5E5E5"> is an</font>

189
00:09:41,780 --> 00:09:47,810
approach to run a linux kernel in a

190
00:09:44,690 --> 00:09:50,870
white listing mode that works but it's

191
00:09:47,810 --> 00:09:54,290
hard to set up using a buff in a white

192
00:09:50,870 --> 00:09:56,180
listing setup works but it's hard to set

193
00:09:54,290 --> 00:09:59,660
up it's a<font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> work and people usually</font>

194
00:09:56,180 --> 00:10:02,120
not willing to<font color="#CCCCCC"> invest the resources it</font>

195
00:09:59,660 --> 00:10:05,180
takes to set is up my advice in these

196
00:10:02,120 --> 00:10:08,150
situations<font color="#E5E5E5"> is maybe you don't need a</font>

197
00:10:05,180 --> 00:10:10,849
complete whitelisting<font color="#CCCCCC"> setup maybe it is</font>

198
00:10:08,150 --> 00:10:13,850
enough if you do selective whitelisting

199
00:10:10,850 --> 00:10:15,920
that<font color="#CCCCCC"> will mean to</font><font color="#E5E5E5"> concentrate your white</font>

200
00:10:13,850 --> 00:10:19,370
list on<font color="#CCCCCC"> the weak spots of your</font>

201
00:10:15,920 --> 00:10:21,709
application like the login page this is

202
00:10:19,370 --> 00:10:23,870
exposed to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Internet this</font><font color="#E5E5E5"> is where</font>

203
00:10:21,710 --> 00:10:25,670
you can deploy<font color="#E5E5E5"> a white listing rules</font>

204
00:10:23,870 --> 00:10:27,230
that without too much hassle them in the

205
00:10:25,670 --> 00:10:30,199
login<font color="#E5E5E5"> page is usually fairly simple</font>

206
00:10:27,230 --> 00:10:32,390
after the login comes the complicated

207
00:10:30,200 --> 00:10:34,460
website the complicated functionality

208
00:10:32,390 --> 00:10:38,180
the white listing would be very hard<font color="#E5E5E5"> to</font>

209
00:10:34,460 --> 00:10:41,270
do this is probably<font color="#E5E5E5"> over the edge so do</font>

210
00:10:38,180 --> 00:10:43,969
selective white listing for login pages

211
00:10:41,270 --> 00:10:47,750
probably upload forums on other weak

212
00:10:43,970 --> 00:10:50,420
spots of your application but with web

213
00:10:47,750 --> 00:10:53,090
application firewalls people usually do

214
00:10:50,420 --> 00:10:55,910
a blacklisting approach a blacklisting

215
00:10:53,090 --> 00:10:58,760
approach is much more water what snort

216
00:10:55,910 --> 00:11:01,160
is doing of the antivirus companies and

217
00:10:58,760 --> 00:11:04,189
of course antivirus is broken why is<font color="#E5E5E5"> it</font>

218
00:11:01,160 --> 00:11:07,459
broken because it relies<font color="#CCCCCC"> on a database</font>

219
00:11:04,190 --> 00:11:10,520
<font color="#E5E5E5">of patterns it relies on a database of</font>

220
00:11:07,460 --> 00:11:12,970
known patterns this means that

221
00:11:10,520 --> 00:11:16,600
everything which is<font color="#E5E5E5"> new</font>

222
00:11:12,970 --> 00:11:19,000
unknown so all the new attacks pass and

223
00:11:16,600 --> 00:11:24,730
that's broken by design is not<font color="#E5E5E5"> how it</font>

224
00:11:19,000 --> 00:11:26,920
works so<font color="#CCCCCC"> mod security has a generic</font>

225
00:11:24,730 --> 00:11:30,699
blacklisting rule set and this is in

226
00:11:26,920 --> 00:11:34,209
fact<font color="#E5E5E5"> the</font><font color="#CCCCCC"> OVAs modsecurity call rule set</font>

227
00:11:30,699 --> 00:11:36,128
this is an idea which is about 10 years

228
00:11:34,209 --> 00:11:39,849
old<font color="#E5E5E5"> by offer she's half and Ryan Burnett</font>

229
00:11:36,129 --> 00:11:43,449
and they designed the rule set based on

230
00:11:39,850 --> 00:11:46,449
not security which would be generic and

231
00:11:43,449 --> 00:11:50,949
<font color="#E5E5E5">it's blacklisting this is an idea that</font>

232
00:11:46,449 --> 00:11:54,790
<font color="#E5E5E5">says do not all the SQL injections have</font>

233
00:11:50,949 --> 00:11:57,609
some characteristic in common does isn't

234
00:11:54,790 --> 00:12:00,279
there something which tells you this is

235
00:11:57,610 --> 00:12:03,339
a cross-site scripting without looking

236
00:12:00,279 --> 00:12:05,829
<font color="#E5E5E5">at the details but it somehow looks like</font>

237
00:12:03,339 --> 00:12:08,230
a cross-site scripting or it's a

238
00:12:05,829 --> 00:12:10,810
protocol violation a general protocol

239
00:12:08,230 --> 00:12:14,050
violation this must be<font color="#E5E5E5"> an attack that's</font>

240
00:12:10,810 --> 00:12:16,209
the idea<font color="#CCCCCC"> behind the core rules and then</font>

241
00:12:14,050 --> 00:12:20,740
they went over and about and wrote about

242
00:12:16,209 --> 00:12:24,069
200-250 rules which would restrict XL

243
00:12:20,740 --> 00:12:28,149
requests in this regard so that's<font color="#E5E5E5"> the</font>

244
00:12:24,069 --> 00:12:29,680
call rule set in the car will set you

245
00:12:28,149 --> 00:12:32,139
have rules against protocol violations

246
00:12:29,680 --> 00:12:34,809
you have cross-site scripting rules all

247
00:12:32,139 --> 00:12:37,449
sort of<font color="#E5E5E5"> an injection rules this is where</font>

248
00:12:34,809 --> 00:12:40,329
<font color="#E5E5E5">MOT secure is very strong a lot of SQL</font>

249
00:12:37,449 --> 00:12:42,878
injection always command injection PHP

250
00:12:40,329 --> 00:12:44,829
function names injections whatever you

251
00:12:42,879 --> 00:12:46,809
<font color="#E5E5E5">want to</font><font color="#CCCCCC"> think of but then there are</font><font color="#E5E5E5"> also</font>

252
00:12:44,829 --> 00:12:50,019
rules which look at the application

253
00:12:46,809 --> 00:12:52,920
response so the HTTP response this is

254
00:12:50,019 --> 00:12:56,230
where you would see a java<font color="#CCCCCC"> sec-treas or</font>

255
00:12:52,920 --> 00:12:58,360
server error messages going back to<font color="#CCCCCC"> the</font>

256
00:12:56,230 --> 00:13:01,120
<font color="#E5E5E5">client and you can interrupt those as</font>

257
00:12:58,360 --> 00:13:04,089
well makes a<font color="#CCCCCC"> lot of sense and here you</font>

258
00:13:01,120 --> 00:13:06,339
see in a<font color="#E5E5E5"> very generic way so if it looks</font>

259
00:13:04,089 --> 00:13:08,019
like a<font color="#CCCCCC"> Java stack trace then you stop it</font>

260
00:13:06,339 --> 00:13:12,459
no<font color="#E5E5E5"> matter if you've seen the stack trace</font>

261
00:13:08,019 --> 00:13:14,730
before or not and this code rule set has

262
00:13:12,459 --> 00:13:17,888
<font color="#CCCCCC">been around for like eight or ten years</font>

263
00:13:14,730 --> 00:13:20,199
it has died down a bit in development

264
00:13:17,889 --> 00:13:23,649
during recent years and last year it

265
00:13:20,199 --> 00:13:26,439
started to pick up again towards the

266
00:13:23,649 --> 00:13:26,710
major release 30 the one which I'm<font color="#E5E5E5"> going</font>

267
00:13:26,439 --> 00:13:31,569
<font color="#E5E5E5">to</font>

268
00:13:26,710 --> 00:13:35,560
talk about you can use these rules in a

269
00:13:31,570 --> 00:13:37,960
legacy strict yes or no mode so whenever

270
00:13:35,560 --> 00:13:40,569
one of these rules<font color="#E5E5E5"> fires then you block</font>

271
00:13:37,960 --> 00:13:43,990
the request immediately and of<font color="#CCCCCC"> course</font>

272
00:13:40,570 --> 00:13:46,540
<font color="#E5E5E5">that has a lot</font><font color="#CCCCCC"> of consequences to left</font>

273
00:13:43,990 --> 00:13:49,720
to right every<font color="#E5E5E5"> false positive will stop</font>

274
00:13:46,540 --> 00:13:52,390
the interaction so what people usually

275
00:13:49,720 --> 00:13:55,570
do and what I advise people to do is run

276
00:13:52,390 --> 00:13:59,860
in the much better anomaly scoring mode

277
00:13:55,570 --> 00:14:02,890
and I<font color="#E5E5E5"> wanted</font><font color="#CCCCCC"> to do I wanted to do a</font>

278
00:13:59,860 --> 00:14:05,260
little demo with this but then my

279
00:14:02,890 --> 00:14:08,020
computer didn't really want to work

280
00:14:05,260 --> 00:14:10,060
today and I think or I'm afraid<font color="#E5E5E5"> we have</font>

281
00:14:08,020 --> 00:14:12,880
to do that<font color="#CCCCCC"> with some people from</font><font color="#E5E5E5"> the</font>

282
00:14:10,060 --> 00:14:16,420
audience first we're going<font color="#E5E5E5"> to need</font>

283
00:14:12,880 --> 00:14:18,689
somebody<font color="#E5E5E5"> with a hoodie a lot of hackers</font>

284
00:14:16,420 --> 00:14:22,510
around somebody must be varying a hoodie

285
00:14:18,690 --> 00:14:24,940
come on guys we need a volunteer your

286
00:14:22,510 --> 00:14:27,000
duty<font color="#E5E5E5"> volunteer please come up on</font><font color="#CCCCCC"> the</font>

287
00:14:24,940 --> 00:14:27,000
stage

288
00:14:37,050 --> 00:14:46,449
okay while we're waiting<font color="#E5E5E5"> for him we'll</font>

289
00:14:40,420 --> 00:14:49,030
need five more guys afterwards hello hi

290
00:14:46,450 --> 00:14:51,460
what's your name that is<font color="#E5E5E5"> Andy very nice</font>

291
00:14:49,030 --> 00:14:55,089
welcome to the<font color="#E5E5E5"> stage so we're going to</font>

292
00:14:51,460 --> 00:14:58,200
do more security call rules and you have

293
00:14:55,090 --> 00:15:01,810
a hoodie you're going to be the attacker

294
00:14:58,200 --> 00:15:03,580
would you put up your<font color="#E5E5E5"> hoodie please ask</font>

295
00:15:01,810 --> 00:15:08,979
the attackers are doing they always do

296
00:15:03,580 --> 00:15:11,320
this<font color="#E5E5E5"> in the videos as you wish okay that</font>

297
00:15:08,980 --> 00:15:14,950
looks<font color="#CCCCCC"> really dangerous now you can look</font>

298
00:15:11,320 --> 00:15:18,280
out very good good attacker for for this

299
00:15:14,950 --> 00:15:20,710
demo would you mind if we call you oops

300
00:15:18,280 --> 00:15:22,510
that's the wrong way around<font color="#E5E5E5"> if we call</font>

301
00:15:20,710 --> 00:15:25,960
you little Bobby tables you know the

302
00:15:22,510 --> 00:15:27,790
cartoon you don't read the cartoon rest

303
00:15:25,960 --> 00:15:35,380
of the audience we need five more people

304
00:15:27,790 --> 00:15:38,800
would you send<font color="#E5E5E5"> them up please so that's</font>

305
00:15:35,380 --> 00:15:42,189
<font color="#E5E5E5">the famous XKCD guy where the mother is</font>

306
00:15:38,800 --> 00:15:45,339
presenting or is filling an online form

307
00:15:42,190 --> 00:15:47,830
at<font color="#CCCCCC"> the school with her son's name with</font>

308
00:15:45,340 --> 00:15:51,610
the famous drop table students in it and

309
00:15:47,830 --> 00:15:56,110
then the school calls and ask is your

310
00:15:51,610 --> 00:15:58,120
son really<font color="#E5E5E5"> called Robert quote bracket</font>

311
00:15:56,110 --> 00:16:02,080
<font color="#CCCCCC">close drop table students she says yes</font>

312
00:15:58,120 --> 00:16:05,770
we call them little Bobby tables ok guys

313
00:16:02,080 --> 00:16:10,180
please line up we need you Bobby you

314
00:16:05,770 --> 00:16:13,270
stand over there nice and so you guys

315
00:16:10,180 --> 00:16:17,530
you're going to be our core rules for

316
00:16:13,270 --> 00:16:20,829
<font color="#E5E5E5">this demo and I'm giving you score caps</font>

317
00:16:17,530 --> 00:16:22,660
that's a<font color="#E5E5E5"> plus five for you you're going</font>

318
00:16:20,830 --> 00:16:24,930
to be a plus to rule you're not a very

319
00:16:22,660 --> 00:16:28,089
strong rule but some indication is here

320
00:16:24,930 --> 00:16:30,579
<font color="#CCCCCC">you're plus</font><font color="#E5E5E5"> five as well here we have a</font>

321
00:16:28,090 --> 00:16:33,160
plus<font color="#E5E5E5"> three rule no you're not getting</font>

322
00:16:30,580 --> 00:16:35,380
<font color="#CCCCCC">one now we have only three rules in its</font>

323
00:16:33,160 --> 00:16:39,510
rules that this will be 200 of these

324
00:16:35,380 --> 00:16:43,180
guys and we need you as the final gate

325
00:16:39,510 --> 00:16:44,769
the point is we're going to<font color="#E5E5E5"> do animal is</font>

326
00:16:43,180 --> 00:16:47,529
scoring with Bobby tables

327
00:16:44,769 --> 00:16:48,879
and then we<font color="#E5E5E5"> have two defenders at the</font>

328
00:16:47,529 --> 00:16:51,339
end would you put up the helmet please

329
00:16:48,879 --> 00:16:53,949
it should be large enough for you and

330
00:16:51,339 --> 00:16:55,899
you form a gate here which you has to

331
00:16:53,949 --> 00:16:59,439
pass would you know you're a bit smaller

332
00:16:55,899 --> 00:17:03,539
come to come to the front you go here<font color="#CCCCCC"> ok</font>

333
00:16:59,439 --> 00:17:08,109
and I giving<font color="#CCCCCC"> you the threshold stick</font>

334
00:17:03,539 --> 00:17:11,260
this is the threshold stick would you

335
00:17:08,109 --> 00:17:13,479
hold this very high and and look a<font color="#E5E5E5"> bit</font>

336
00:17:11,260 --> 00:17:15,459
relaxed you're a hippie ruleset you

337
00:17:13,480 --> 00:17:17,980
don't<font color="#E5E5E5"> really care you're a brand new</font>

338
00:17:15,459 --> 00:17:20,319
install with very loose restrictions and

339
00:17:17,980 --> 00:17:25,179
now what is<font color="#E5E5E5"> happening with our request</font>

340
00:17:20,319 --> 00:17:27,668
is that Bobby is approaching the chain

341
00:17:25,179 --> 00:17:30,130
he's a request and he has to pass<font color="#E5E5E5"> all</font>

342
00:17:27,669 --> 00:17:32,409
the rules now and you go to the first

343
00:17:30,130 --> 00:17:34,720
rule and now<font color="#E5E5E5"> you decide stop stop at the</font>

344
00:17:32,409 --> 00:17:37,240
<font color="#E5E5E5">first you decide is he an attacker or</font>

345
00:17:34,720 --> 00:17:42,850
not and if you think<font color="#CCCCCC"> he's in</font><font color="#E5E5E5"> paccar you</font>

346
00:17:37,240 --> 00:17:47,770
put the plus 5 tack on his back<font color="#CCCCCC"> and then</font>

347
00:17:42,850 --> 00:17:49,600
he goes on to the next rule oh he's

348
00:17:47,770 --> 00:17:54,879
identified again he's such an obvious

349
00:17:49,600 --> 00:17:57,520
attacker ok he passes the<font color="#CCCCCC"> first rule the</font>

350
00:17:54,880 --> 00:17:59,980
third a very good and then he passes the

351
00:17:57,520 --> 00:18:02,500
final gate no he's not passing and he

352
00:17:59,980 --> 00:18:06,039
has a score<font color="#E5E5E5"> of 12 now and he easily</font>

353
00:18:02,500 --> 00:18:09,610
passes underneath very well they come

354
00:18:06,039 --> 00:18:14,950
back to round please picked grab the

355
00:18:09,610 --> 00:18:18,908
packs again and as the attacker

356
00:18:14,950 --> 00:18:22,389
approaches as the setup is improving

357
00:18:18,909 --> 00:18:25,510
they're lowering<font color="#E5E5E5"> they're lowering the</font>

358
00:18:22,389 --> 00:18:28,418
threshold and<font color="#CCCCCC"> the lower they get the</font>

359
00:18:25,510 --> 00:18:32,490
harder it gets for Bobby to pass

360
00:18:28,419 --> 00:18:36,520
underneath and after a few iterations

361
00:18:32,490 --> 00:18:38,830
we're actually doing limbo dancing are

362
00:18:36,520 --> 00:18:42,399
you a good limbo dancer you're not a

363
00:18:38,830 --> 00:18:44,158
good limbo dancer but let's give it a

364
00:18:42,399 --> 00:18:48,908
try few still pass underneath like this

365
00:18:44,159 --> 00:18:52,120
<font color="#E5E5E5">ok usual self ok this happens a lot</font>

366
00:18:48,909 --> 00:18:54,730
every request runs through this chain

367
00:18:52,120 --> 00:18:57,549
and it passes and the<font color="#E5E5E5"> more mature data</font>

368
00:18:54,730 --> 00:18:58,490
set up is the lower he gets and he can

369
00:18:57,549 --> 00:19:02,090
get

370
00:18:58,490 --> 00:19:05,300
really really low go down and look a<font color="#E5E5E5"> bit</font>

371
00:19:02,090 --> 00:19:08,540
fierce that<font color="#CCCCCC"> you're no you're no longer</font>

372
00:19:05,300 --> 00:19:10,909
doing it you give up you give up you

373
00:19:08,540 --> 00:19:14,080
look for the<font color="#E5E5E5"> next target and that's the</font>

374
00:19:10,910 --> 00:19:17,270
whole point by a strict<font color="#CCCCCC"> mode</font><font color="#E5E5E5"> security</font>

375
00:19:14,080 --> 00:19:19,520
installation you shy attacker way

376
00:19:17,270 --> 00:19:23,510
because it's<font color="#CCCCCC"> getting too difficult for</font>

377
00:19:19,520 --> 00:19:30,110
Bobby to pass underneath did you guy get

378
00:19:23,510 --> 00:19:35,300
the idea<font color="#CCCCCC"> or should he do it again thank</font>

379
00:19:30,110 --> 00:19:38,620
you<font color="#CCCCCC"> okay we don't want</font><font color="#E5E5E5"> you to meet you</font>

380
00:19:35,300 --> 00:19:38,620
please give back my helmet

381
00:19:52,880 --> 00:20:00,350
so these<font color="#E5E5E5"> car rules they are very generic</font>

382
00:19:56,810 --> 00:20:03,200
in nature and with the generic rule set

383
00:20:00,350 --> 00:20:07,250
of course you also get a generic number

384
00:20:03,200 --> 00:20:11,210
of false positives how many false

385
00:20:07,250 --> 00:20:15,020
positives do you get you get<font color="#E5E5E5"> a lot you</font>

386
00:20:11,210 --> 00:20:18,740
get that many on the<font color="#E5E5E5"> x-axis you see the</font>

387
00:20:15,020 --> 00:20:23,330
score of the<font color="#CCCCCC"> individual requests and on</font>

388
00:20:18,740 --> 00:20:27,080
the y-axis you see how many quest scored

389
00:20:23,330 --> 00:20:30,260
the number so you have some requests

390
00:20:27,080 --> 00:20:33,379
which scored<font color="#E5E5E5"> zero in this ant you and</font>

391
00:20:30,260 --> 00:20:36,860
set up this is a<font color="#CCCCCC"> traditional core rules</font>

392
00:20:33,380 --> 00:20:40,520
to 29 and some requests actually got

393
00:20:36,860 --> 00:20:44,360
<font color="#CCCCCC">zero out of it but the biggest amount of</font>

394
00:20:40,520 --> 00:20:47,510
requests scored at 28 and as you have

395
00:20:44,360 --> 00:20:51,290
seen the biggest tag we have is a plus 5

396
00:20:47,510 --> 00:20:55,760
and with plus 5 to reach 28 you need at

397
00:20:51,290 --> 00:21:00,800
least sex alerts this means in this set

398
00:20:55,760 --> 00:21:06,860
up most of the request scored six alarms

399
00:21:00,800 --> 00:21:10,159
and a single<font color="#E5E5E5"> request this is unnaturally</font>

400
00:21:06,860 --> 00:21:13,100
high but it's not<font color="#E5E5E5"> that far off so very</font>

401
00:21:10,160 --> 00:21:16,370
often this<font color="#E5E5E5"> is what a new install is</font>

402
00:21:13,100 --> 00:21:18,919
facing it's a crazy amount of false

403
00:21:16,370 --> 00:21:22,639
positives and in this<font color="#CCCCCC"> set up this</font>

404
00:21:18,920 --> 00:21:26,540
represents millions of alarms what you

405
00:21:22,640 --> 00:21:32,200
see on this graph is over half a million

406
00:21:26,540 --> 00:21:35,540
of requests and on an untuned set up and

407
00:21:32,200 --> 00:21:39,410
all of these requests is called<font color="#E5E5E5"> one two</font>

408
00:21:35,540 --> 00:21:42,020
<font color="#E5E5E5">three four five alerts and far out to</font>

409
00:21:39,410 --> 00:21:45,080
the right there was an outlier at a

410
00:21:42,020 --> 00:21:50,330
score of 221 can you believe that that's

411
00:21:45,080 --> 00:21:53,990
really crazy<font color="#E5E5E5"> and that is a hard problem</font>

412
00:21:50,330 --> 00:21:56,780
and my job<font color="#CCCCCC"> is actually to help</font><font color="#E5E5E5"> people</font>

413
00:21:53,990 --> 00:21:59,180
get rid of these long green bars and

414
00:21:56,780 --> 00:22:02,210
move them over to the 0 bar to have a

415
00:21:59,180 --> 00:22:03,650
lot of requests<font color="#CCCCCC"> pass without any alarms</font>

416
00:22:02,210 --> 00:22:06,770
of course<font color="#E5E5E5"> that's what you want to have</font>

417
00:22:03,650 --> 00:22:09,280
and this is called modsecurity tuning

418
00:22:06,770 --> 00:22:12,950
and<font color="#E5E5E5"> what I would usually tell people</font>

419
00:22:09,280 --> 00:22:16,399
don't be<font color="#E5E5E5"> afraid this is what we all face</font>

420
00:22:12,950 --> 00:22:19,100
but with a bit of guidance and a good

421
00:22:16,400 --> 00:22:22,490
<font color="#E5E5E5">policy you can get rid of these false</font>

422
00:22:19,100 --> 00:22:26,360
positives fairly quickly and then you

423
00:22:22,490 --> 00:22:29,720
arrive at a functional setup but of

424
00:22:26,360 --> 00:22:33,379
course<font color="#E5E5E5"> it would be better if the setup</font>

425
00:22:29,720 --> 00:22:35,600
wouldn't have to be functional if if it

426
00:22:33,380 --> 00:22:37,850
would be functional from the outset if

427
00:22:35,600 --> 00:22:42,350
there wouldn't be any false positives

428
00:22:37,850 --> 00:22:45,730
and that's what the idea of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> core</font>

429
00:22:42,350 --> 00:22:49,100
rules paranoia mode is all about and

430
00:22:45,730 --> 00:22:51,620
when the development of the 30 release

431
00:22:49,100 --> 00:22:54,889
was starting last year<font color="#E5E5E5"> I would enter the</font>

432
00:22:51,620 --> 00:22:58,699
<font color="#E5E5E5">project again with the idea let's do</font>

433
00:22:54,890 --> 00:23:00,830
something<font color="#CCCCCC"> about false positives we could</font>

434
00:22:58,700 --> 00:23:02,540
simply remove the<font color="#E5E5E5"> rules of course but</font>

435
00:23:00,830 --> 00:23:05,780
then we would lose security that's not

436
00:23:02,540 --> 00:23:09,139
what we want we<font color="#CCCCCC"> want something which</font>

437
00:23:05,780 --> 00:23:12,020
helps the user without compromising the

438
00:23:09,140 --> 00:23:16,970
security and we have to improve<font color="#E5E5E5"> the</font>

439
00:23:12,020 --> 00:23:22,670
rules and hence the idea of the<font color="#CCCCCC"> paranoia</font>

440
00:23:16,970 --> 00:23:26,930
mode was born so how will you do this

441
00:23:22,670 --> 00:23:29,510
the basic<font color="#E5E5E5"> idea is we introduce paranoia</font>

442
00:23:26,930 --> 00:23:32,420
levels people tell me look<font color="#CCCCCC"> Tristan the</font>

443
00:23:29,510 --> 00:23:36,470
last thing that what modsecurity you

444
00:23:32,420 --> 00:23:39,080
need is<font color="#CCCCCC"> to be more paranoid it's already</font>

445
00:23:36,470 --> 00:23:42,230
<font color="#E5E5E5">very crazy and say no hold on the</font>

446
00:23:39,080 --> 00:23:44,840
default will have a very<font color="#E5E5E5"> low paranoia</font>

447
00:23:42,230 --> 00:23:47,780
setting in fact much lower than it is

448
00:23:44,840 --> 00:23:50,720
right now we introduce paranoia levels

449
00:23:47,780 --> 00:23:53,510
from one to four and then we take the

450
00:23:50,720 --> 00:23:56,920
rules and assign them to a paranoia

451
00:23:53,510 --> 00:24:00,140
level and the default level is one and

452
00:23:56,920 --> 00:24:02,570
in the level<font color="#E5E5E5"> one we only allow rules</font>

453
00:24:00,140 --> 00:24:08,210
which were quite sure that there are no

454
00:24:02,570 --> 00:24:10,340
or very few false positives and then as

455
00:24:08,210 --> 00:24:12,560
<font color="#CCCCCC">you rise through the levels there are</font>

456
00:24:10,340 --> 00:24:15,290
<font color="#CCCCCC">the more crazy rules the more strict</font>

457
00:24:12,560 --> 00:24:17,720
rules the rules where you can expect

458
00:24:15,290 --> 00:24:19,870
false positives and where you have to

459
00:24:17,720 --> 00:24:23,140
expect false positives

460
00:24:19,870 --> 00:24:26,020
and then there is<font color="#CCCCCC"> a second concept in</font>

461
00:24:23,140 --> 00:24:28,840
here as<font color="#CCCCCC"> well it is called the strict</font>

462
00:24:26,020 --> 00:24:31,150
siblings what we do<font color="#E5E5E5"> with siblings what</font>

463
00:24:28,840 --> 00:24:34,809
do you mean with it is you take an

464
00:24:31,150 --> 00:24:38,670
existing rule which has a certain limit

465
00:24:34,809 --> 00:24:41,830
and then you duplicate the rule<font color="#E5E5E5"> and add</font>

466
00:24:38,670 --> 00:24:44,320
stricter limit so it's a sibling of an

467
00:24:41,830 --> 00:24:46,720
<font color="#CCCCCC">existing rule which is stricter and then</font>

468
00:24:44,320 --> 00:24:50,020
on the next paranoia level even more

469
00:24:46,720 --> 00:24:56,679
strict and on level four is very strict

470
00:24:50,020 --> 00:24:58,590
indeed and this has been<font color="#CCCCCC"> going on in</font>

471
00:24:56,679 --> 00:25:02,950
winter<font color="#CCCCCC"> and springtime and we have now</font>

472
00:24:58,590 --> 00:25:06,189
150 rules left<font color="#E5E5E5"> in paranoia level</font><font color="#CCCCCC"> one we</font>

473
00:25:02,950 --> 00:25:07,809
are<font color="#E5E5E5"> 30 rules in paranoia level</font><font color="#CCCCCC"> two and a</font>

474
00:25:06,190 --> 00:25:09,970
couple of rules and three and four and

475
00:25:07,809 --> 00:25:12,850
this is where the development is still

476
00:25:09,970 --> 00:25:15,940
running so the strict siblings this is

477
00:25:12,850 --> 00:25:20,520
not yet done but the mechanics is fully

478
00:25:15,940 --> 00:25:23,710
functional it's there to<font color="#CCCCCC"> be used and</font>

479
00:25:20,520 --> 00:25:26,500
when when we set this up for<font color="#CCCCCC"> the</font><font color="#E5E5E5"> first</font>

480
00:25:23,710 --> 00:25:31,059
time you want<font color="#E5E5E5"> to you want to test it of</font>

481
00:25:26,500 --> 00:25:34,210
course and testing an individual rule is

482
00:25:31,059 --> 00:25:36,340
that's very<font color="#CCCCCC"> easy the test the whole</font>

483
00:25:34,210 --> 00:25:40,090
ruleset you want statistics don't<font color="#E5E5E5"> you</font>

484
00:25:36,340 --> 00:25:42,309
but then it's hard to do development on

485
00:25:40,090 --> 00:25:44,590
a productive release because you want to

486
00:25:42,309 --> 00:25:48,070
statistics you want a lot<font color="#E5E5E5"> of traffic and</font>

487
00:25:44,590 --> 00:25:50,409
traffic should be<font color="#CCCCCC"> shouldn't be a single</font>

488
00:25:48,070 --> 00:25:53,970
<font color="#E5E5E5">application it should be representative</font>

489
00:25:50,410 --> 00:25:56,440
it should be typical internet traffic as

490
00:25:53,970 --> 00:25:59,250
<font color="#CCCCCC">mod security installation typically</font>

491
00:25:56,440 --> 00:26:01,600
faces and it would<font color="#CCCCCC"> be nice if there</font>

492
00:25:59,250 --> 00:26:04,090
would be a project<font color="#CCCCCC"> somewhere on the</font>

493
00:26:01,600 --> 00:26:06,428
internet where people are providing you

494
00:26:04,090 --> 00:26:08,678
with a huge collection<font color="#E5E5E5"> of internet</font>

495
00:26:06,429 --> 00:26:11,980
traffic which you can then use to

496
00:26:08,679 --> 00:26:13,300
calibrate your rule set and set up that

497
00:26:11,980 --> 00:26:16,530
would<font color="#E5E5E5"> be very nice but that's not</font>

498
00:26:13,300 --> 00:26:19,210
existing if you want such a body of

499
00:26:16,530 --> 00:26:23,820
internet traffic you have to develop it

500
00:26:19,210 --> 00:26:26,740
yourself and that's<font color="#E5E5E5"> what</font><font color="#CCCCCC"> I did and what</font>

501
00:26:23,820 --> 00:26:29,950
what he came up with this I would run a

502
00:26:26,740 --> 00:26:31,870
man-in-the-middle attack on myself<font color="#CCCCCC"> so I</font>

503
00:26:29,950 --> 00:26:33,090
would install a man-in-the-middle in my

504
00:26:31,870 --> 00:26:35,520
browser

505
00:26:33,090 --> 00:26:39,350
and it would write down all my<font color="#CCCCCC"> requests</font>

506
00:26:35,520 --> 00:26:42,990
<font color="#E5E5E5">to the disk and I will then translate</font>

507
00:26:39,350 --> 00:26:46,290
this traffic into a usable form and then

508
00:26:42,990 --> 00:26:49,220
replay it against my own server so the

509
00:26:46,290 --> 00:26:52,830
traffic which would be sent to github or

510
00:26:49,220 --> 00:26:56,250
<font color="#CCCCCC">slashed out the reddit or anywhere would</font>

511
00:26:52,830 --> 00:26:58,439
then instead be sent to my own server to

512
00:26:56,250 --> 00:27:01,170
localhost where I could play around with

513
00:26:58,440 --> 00:27:03,840
the<font color="#CCCCCC"> rule set and run statistics and move</font>

514
00:27:01,170 --> 00:27:06,060
rules to different<font color="#CCCCCC"> levels</font><font color="#E5E5E5"> change the</font>

515
00:27:03,840 --> 00:27:09,149
limits introduce new rules throw them

516
00:27:06,060 --> 00:27:15,330
<font color="#E5E5E5">out and look how the statistic develops</font>

517
00:27:09,150 --> 00:27:18,960
and with this we were able to to design

518
00:27:15,330 --> 00:27:26,460
or put this coral paranoia mode into

519
00:27:18,960 --> 00:27:31,610
practice<font color="#CCCCCC"> and with this we ended up with</font>

520
00:27:26,460 --> 00:27:34,650
first statistics so what you see<font color="#CCCCCC"> here is</font>

521
00:27:31,610 --> 00:27:37,530
five different installations in the top

522
00:27:34,650 --> 00:27:41,940
bar you see the stable release the core

523
00:27:37,530 --> 00:27:45,690
rules to 29 and then the very small bar

524
00:27:41,940 --> 00:27:48,050
that's the 30 development release with

525
00:27:45,690 --> 00:27:51,390
<font color="#CCCCCC">the default paranoia level of one and</font>

526
00:27:48,050 --> 00:27:55,080
what we see is the average incoming

527
00:27:51,390 --> 00:27:58,320
animal scores so of all the requests

528
00:27:55,080 --> 00:28:01,830
this is the average score and as you can

529
00:27:58,320 --> 00:28:05,399
quickly see the<font color="#CCCCCC"> average animal is score</font>

530
00:28:01,830 --> 00:28:08,879
is coming way down with the new paranoia

531
00:28:05,400 --> 00:28:11,670
mode this immediately translates to

532
00:28:08,880 --> 00:28:13,650
false positives that's a lot less<font color="#E5E5E5"> alarms</font>

533
00:28:11,670 --> 00:28:15,900
and this is vanilla traffic that's my

534
00:28:13,650 --> 00:28:19,110
own<font color="#CCCCCC"> traffic this is no attack traffic</font>

535
00:28:15,900 --> 00:28:24,270
everything green here is<font color="#E5E5E5"> definitely a</font>

536
00:28:19,110 --> 00:28:27,419
false positive<font color="#CCCCCC"> and then as we raise the</font>

537
00:28:24,270 --> 00:28:30,690
paranoia level<font color="#E5E5E5"> two to three and four we</font>

538
00:28:27,420 --> 00:28:33,720
get the alerts back we get the false

539
00:28:30,690 --> 00:28:36,140
positives again and in paranoia level

540
00:28:33,720 --> 00:28:38,820
<font color="#CCCCCC">four thanks to district siblings</font>

541
00:28:36,140 --> 00:28:41,760
approach we were<font color="#E5E5E5"> getting even higher</font>

542
00:28:38,820 --> 00:28:47,060
security and even stricter limits than

543
00:28:41,760 --> 00:28:47,060
we used to have with the<font color="#E5E5E5"> corals 229</font>

544
00:28:47,799 --> 00:28:54,590
so i'm going<font color="#CCCCCC"> to show you now a couple of</font>

545
00:28:51,530 --> 00:28:58,428
individual rules and showing you what we

546
00:28:54,590 --> 00:29:01,220
<font color="#E5E5E5">have done to them the first one is a</font>

547
00:28:58,429 --> 00:29:05,710
rule about restricted SQL characters

548
00:29:01,220 --> 00:29:09,500
that's a<font color="#E5E5E5"> very notorious rules among new</font>

549
00:29:05,710 --> 00:29:11,660
<font color="#CCCCCC">mode security says it means</font><font color="#E5E5E5"> Oh</font><font color="#CCCCCC"> Sees I</font>

550
00:29:09,500 --> 00:29:16,700
mean facing modsecurity first time it's

551
00:29:11,660 --> 00:29:18,620
<font color="#E5E5E5">the rule ID in 98 1173 it defines a long</font>

552
00:29:16,700 --> 00:29:20,750
long<font color="#E5E5E5"> list that's one of these crazy</font>

553
00:29:18,620 --> 00:29:24,590
regular expressions a long list of

554
00:29:20,750 --> 00:29:28,580
parameters and then out to<font color="#CCCCCC"> the right you</font>

555
00:29:24,590 --> 00:29:32,149
see a limit of 5 so this rule tells us

556
00:29:28,580 --> 00:29:36,350
look<font color="#CCCCCC"> requests in any argument you're</font>

557
00:29:32,150 --> 00:29:40,730
submitting we're allowing a maximum of

558
00:29:36,350 --> 00:29:43,850
four special characters with number<font color="#CCCCCC"> 5</font>

559
00:29:40,730 --> 00:29:47,210
you're out you get a tag on<font color="#CCCCCC"> your back</font>

560
00:29:43,850 --> 00:29:50,840
<font color="#E5E5E5">you're tagged as an offender against 98</font>

561
00:29:47,210 --> 00:29:53,240
1173 and<font color="#E5E5E5"> i'll</font><font color="#CCCCCC"> tell you</font><font color="#E5E5E5"> this brings a lot</font>

562
00:29:50,840 --> 00:29:55,939
of false positives depending on<font color="#CCCCCC"> the</font>

563
00:29:53,240 --> 00:29:57,950
<font color="#E5E5E5">application you have cookie violating</font>

564
00:29:55,940 --> 00:30:00,049
this and the cookies sent with every

565
00:29:57,950 --> 00:30:03,410
request so every quest triggers this

566
00:30:00,049 --> 00:30:05,870
alarm that's that's really painful and

567
00:30:03,410 --> 00:30:09,200
what we<font color="#E5E5E5"> did in the new development</font>

568
00:30:05,870 --> 00:30:12,409
release is this the rule<font color="#CCCCCC"> is removed from</font>

569
00:30:09,200 --> 00:30:14,660
<font color="#E5E5E5">the default paranoia level and then it's</font>

570
00:30:12,410 --> 00:30:17,720
coming at level<font color="#E5E5E5"> 2 but no longer</font><font color="#CCCCCC"> with the</font>

571
00:30:14,660 --> 00:30:22,910
<font color="#E5E5E5">limit of five</font><font color="#CCCCCC"> now we're allowing up to</font>

572
00:30:17,720 --> 00:30:25,970
11 special characters and with character

573
00:30:22,910 --> 00:30:28,730
number 12<font color="#E5E5E5"> the rule fires and pen at</font>

574
00:30:25,970 --> 00:30:31,429
paranoia level<font color="#CCCCCC"> 3 we're bringing the same</font>

575
00:30:28,730 --> 00:30:35,679
rule or a copy of it it's a strict

576
00:30:31,429 --> 00:30:38,480
sibling with limit of six<font color="#E5E5E5"> and ten at</font>

577
00:30:35,679 --> 00:30:42,110
paranoia level<font color="#E5E5E5"> four we were bringing in</font>

578
00:30:38,480 --> 00:30:44,630
with a limit of two and Bobby tables

579
00:30:42,110 --> 00:30:49,309
told us he<font color="#CCCCCC"> is not very</font><font color="#E5E5E5"> good limbo dancer</font>

580
00:30:44,630 --> 00:30:51,980
and getting getting<font color="#E5E5E5"> a and exploit over</font>

581
00:30:49,309 --> 00:30:55,460
to the server without using more than

582
00:30:51,980 --> 00:30:58,730
one special character is really hard

583
00:30:55,460 --> 00:30:59,690
this is hard limbo so if you're<font color="#E5E5E5"> able to</font>

584
00:30:58,730 --> 00:31:01,669
run your application

585
00:30:59,690 --> 00:31:06,169
that a paranoia level<font color="#CCCCCC"> of for the</font>

586
00:31:01,669 --> 00:31:09,470
attacker will have a very<font color="#E5E5E5"> hard time next</font>

587
00:31:06,169 --> 00:31:11,269
example hex encodings so<font color="#E5E5E5"> X encoding as</font>

588
00:31:09,470 --> 00:31:16,039
you all know<font color="#CCCCCC"> is</font><font color="#E5E5E5"> typically a cero</font>

589
00:31:11,269 --> 00:31:19,009
followed by X and<font color="#E5E5E5"> then a hex number 029</font>

590
00:31:16,039 --> 00:31:21,769
a2f there is a bit syntactic sugar

591
00:31:19,009 --> 00:31:26,330
around this in the rule but<font color="#E5E5E5"> basically</font>

592
00:31:21,769 --> 00:31:28,580
it's<font color="#E5E5E5"> zero aches etc and of course this</font>

593
00:31:26,330 --> 00:31:31,730
brings a lot of false positives namely

594
00:31:28,580 --> 00:31:34,970
in the form of cookies session cookies

595
00:31:31,730 --> 00:31:37,250
there they created<font color="#CCCCCC"> by random and as it</font>

596
00:31:34,970 --> 00:31:39,139
happens very<font color="#E5E5E5"> often you have a zero</font>

597
00:31:37,250 --> 00:31:41,929
followed by six and then a new character

598
00:31:39,139 --> 00:31:45,889
it's a false positive is a hex encoding

599
00:31:41,929 --> 00:31:49,789
false positive<font color="#E5E5E5"> and the plan now this is</font>

600
00:31:45,889 --> 00:31:53,029
not yet done but the plan is let's run

601
00:31:49,789 --> 00:31:55,820
this rule in paranoia level one on the

602
00:31:53,029 --> 00:31:58,279
parameters and xml stuff and the cookie

603
00:31:55,820 --> 00:32:01,100
names but not on the cookie values

604
00:31:58,279 --> 00:32:04,580
themselves as this is where recession

605
00:32:01,100 --> 00:32:07,219
cookies are the<font color="#CCCCCC"> session cookies on the</font>

606
00:32:04,580 --> 00:32:11,840
request cookie values are only tested in

607
00:32:07,220 --> 00:32:15,379
paranoia level<font color="#E5E5E5"> two so we're giving up a</font>

608
00:32:11,840 --> 00:32:18,428
little bit of security but reducing the

609
00:32:15,379 --> 00:32:22,250
false positives a lot<font color="#E5E5E5"> and if you have</font>

610
00:32:18,429 --> 00:32:25,879
more need for security you raise the

611
00:32:22,250 --> 00:32:28,370
paranoia level and then you allow more

612
00:32:25,879 --> 00:32:30,439
false positives which you have to<font color="#E5E5E5"> tune</font>

613
00:32:28,370 --> 00:32:33,879
but then at least you know what you're

614
00:32:30,440 --> 00:32:36,500
doing and request cookie contents is

615
00:32:33,879 --> 00:32:38,629
usually not the way where the attack

616
00:32:36,500 --> 00:32:42,169
happens so think that is worthwhile we

617
00:32:38,629 --> 00:32:44,990
can do<font color="#E5E5E5"> this for a default install so</font>

618
00:32:42,169 --> 00:32:49,669
these<font color="#E5E5E5"> are two examples of rules and what</font>

619
00:32:44,990 --> 00:32:51,740
we doing the paranoia mode next one we

620
00:32:49,669 --> 00:32:53,960
have seen a bit of<font color="#E5E5E5"> vanilla traffic but</font>

621
00:32:51,740 --> 00:32:56,389
what<font color="#E5E5E5"> happens to the attackers do they</font>

622
00:32:53,960 --> 00:32:59,840
notice this as well are they likely to

623
00:32:56,389 --> 00:33:02,149
get as few alerts as we've seen with the

624
00:32:59,840 --> 00:33:05,720
green traffic no that's not the case

625
00:33:02,149 --> 00:33:09,018
here we have nikto scanning our server

626
00:33:05,720 --> 00:33:12,200
top row again coral stable release and

627
00:33:09,019 --> 00:33:13,490
then on the paranoia level one of the

628
00:33:12,200 --> 00:33:17,090
new development

629
00:33:13,490 --> 00:33:20,030
a bit fuel alerts the average<font color="#E5E5E5"> incoming</font>

630
00:33:17,090 --> 00:33:22,820
animal is core is a bit lower but it's

631
00:33:20,030 --> 00:33:25,580
still at a<font color="#CCCCCC"> 5 on average that's</font>

632
00:33:22,820 --> 00:33:27,350
substantial and then as we raise the

633
00:33:25,580 --> 00:33:31,550
paranoia level we're<font color="#E5E5E5"> getting higher and</font>

634
00:33:27,350 --> 00:33:35,689
higher<font color="#E5E5E5"> actually nikto is nice that it</font>

635
00:33:31,550 --> 00:33:39,370
does<font color="#CCCCCC"> not trigger all that many alerts if</font>

636
00:33:35,690 --> 00:33:41,570
you look<font color="#E5E5E5"> at SQL map that's a lot higher</font>

637
00:33:39,370 --> 00:33:45,469
here you see a substantial<font color="#E5E5E5"> difference</font>

638
00:33:41,570 --> 00:33:47,990
but even<font color="#CCCCCC"> on paranoia level 1 it's</font><font color="#E5E5E5"> it's</font>

639
00:33:45,470 --> 00:33:51,530
over an<font color="#CCCCCC"> 8 which is</font><font color="#E5E5E5"> already fairly high</font>

640
00:33:47,990 --> 00:33:53,480
for an average score and this is

641
00:33:51,530 --> 00:33:55,520
<font color="#E5E5E5">probably why we're seeing much higher</font>

642
00:33:53,480 --> 00:33:57,559
numbers than with nikto here is<font color="#CCCCCC"> probably</font>

643
00:33:55,520 --> 00:34:00,110
because<font color="#E5E5E5"> the core rules are very strong</font>

644
00:33:57,559 --> 00:34:02,389
against SQL injection<font color="#E5E5E5"> and of course</font><font color="#CCCCCC"> SQL</font>

645
00:34:00,110 --> 00:34:05,899
map is an SQL injection tool so that's

646
00:34:02,390 --> 00:34:08,629
why you get higher scores I also a data

647
00:34:05,900 --> 00:34:12,290
sample on the exploit DB this is

648
00:34:08,629 --> 00:34:15,049
unfortunately a small example<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> only</font>

649
00:34:12,290 --> 00:34:18,080
a couple of<font color="#E5E5E5"> hundred of exploits and here</font>

650
00:34:15,050 --> 00:34:22,389
the scores are even higher you're up to

651
00:34:18,080 --> 00:34:30,440
50 now in the default 30 development

652
00:34:22,389 --> 00:34:33,500
install good now<font color="#CCCCCC"> let's return</font><font color="#E5E5E5"> to the</font>

653
00:34:30,440 --> 00:34:36,710
rules and look at another advanced

654
00:34:33,500 --> 00:34:38,570
concept a strict sibling concept this

655
00:34:36,710 --> 00:34:40,699
was developed<font color="#E5E5E5"> by</font><font color="#CCCCCC"> Walter</font><font color="#E5E5E5"> hop from the</font>

656
00:34:38,570 --> 00:34:43,159
<font color="#E5E5E5">Netherlands this has to do with PHP</font>

657
00:34:40,699 --> 00:34:46,219
function names PHP function names is

658
00:34:43,159 --> 00:34:49,869
also a source of a lot of false

659
00:34:46,219 --> 00:34:52,779
positives in a two to nine core rules

660
00:34:49,869 --> 00:34:56,210
installations the problem is of course

661
00:34:52,780 --> 00:34:58,609
PHP is designed after the natural

662
00:34:56,210 --> 00:35:01,580
<font color="#E5E5E5">English language and the natural English</font>

663
00:34:58,609 --> 00:35:04,670
language has terms which also occur as

664
00:35:01,580 --> 00:35:07,369
as PHP function names there are innocent

665
00:35:04,670 --> 00:35:10,760
examples in the top left group that's

666
00:35:07,369 --> 00:35:13,640
sleep that's time this is usually<font color="#CCCCCC"> not</font>

667
00:35:10,760 --> 00:35:18,070
used in<font color="#E5E5E5"> an exploit so even if we're</font>

668
00:35:13,640 --> 00:35:23,390
seeing that it's not really dangerous of

669
00:35:18,070 --> 00:35:27,040
several low dangerousness is<font color="#CCCCCC"> set locale</font>

670
00:35:23,390 --> 00:35:31,120
or money underscore format

671
00:35:27,040 --> 00:35:33,220
this is used in PHP it's not using this

672
00:35:31,120 --> 00:35:37,900
language but<font color="#CCCCCC"> even if</font><font color="#E5E5E5"> it appears in a</font>

673
00:35:33,220 --> 00:35:39,899
string it's<font color="#E5E5E5"> unlikely to be an attack the</font>

674
00:35:37,900 --> 00:35:42,880
two groups on the<font color="#E5E5E5"> right they are harder</font>

675
00:35:39,900 --> 00:35:45,310
this is where these are<font color="#CCCCCC"> the functions</font>

676
00:35:42,880 --> 00:35:47,470
which are really used in attacks in the

677
00:35:45,310 --> 00:35:52,180
lower right corner you see group number

678
00:35:47,470 --> 00:35:55,689
<font color="#CCCCCC">four that's base64 decode or shell xik</font>

679
00:35:52,180 --> 00:35:58,839
that's really exploit stuff now if you

680
00:35:55,690 --> 00:36:00,880
see<font color="#E5E5E5"> this</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> incoming traffic it's very</font>

681
00:35:58,840 --> 00:36:03,370
likely<font color="#E5E5E5"> something bad is going on and</font>

682
00:36:00,880 --> 00:36:06,700
this is a large group of requests and

683
00:36:03,370 --> 00:36:09,009
what you want to<font color="#E5E5E5"> do is run a fast</font>

684
00:36:06,700 --> 00:36:11,020
algorithm against the list of these PHP

685
00:36:09,010 --> 00:36:12,910
function names and you don't have<font color="#E5E5E5"> to</font>

686
00:36:11,020 --> 00:36:16,360
care so much about false positives

687
00:36:12,910 --> 00:36:20,440
because nobody rare rights proc

688
00:36:16,360 --> 00:36:25,180
underscore open in an email unless he as

689
00:36:20,440 --> 00:36:27,490
a PHP coder but then the tricky bit is

690
00:36:25,180 --> 00:36:29,980
of course the<font color="#E5E5E5"> top right these are the</font>

691
00:36:27,490 --> 00:36:35,220
dangerous function names which also

692
00:36:29,980 --> 00:36:40,030
appears in standard traffic system file

693
00:36:35,220 --> 00:36:41,950
evo or<font color="#CCCCCC"> exsec happens all the time a lot</font>

694
00:36:40,030 --> 00:36:45,160
of<font color="#E5E5E5"> traffic that's what people riding in</font>

695
00:36:41,950 --> 00:36:48,069
subscribe<font color="#E5E5E5"> in forums and you cannot</font>

696
00:36:45,160 --> 00:36:50,319
simply check for these keywords with<font color="#E5E5E5"> the</font>

697
00:36:48,070 --> 00:36:52,180
fast algorithm you will get a huge

698
00:36:50,320 --> 00:36:55,570
amount<font color="#E5E5E5"> of false positives and that's</font>

699
00:36:52,180 --> 00:36:58,990
happening in<font color="#CCCCCC"> 2292</font><font color="#E5E5E5"> wide extent so what</font>

700
00:36:55,570 --> 00:37:01,600
Walter hop did for the upcoming major

701
00:36:58,990 --> 00:37:04,990
release and for the paranoia levels he

702
00:37:01,600 --> 00:37:07,240
would group all the PHP function names

703
00:37:04,990 --> 00:37:09,879
that's far beyond a thousand function

704
00:37:07,240 --> 00:37:13,149
names into these four groups and develop

705
00:37:09,880 --> 00:37:18,070
individual rules to cover them in the

706
00:37:13,150 --> 00:37:20,380
rule set and for the group<font color="#E5E5E5"> llama free</font>

707
00:37:18,070 --> 00:37:23,680
that's the system file except group

708
00:37:20,380 --> 00:37:26,530
there we<font color="#E5E5E5"> will make sure</font><font color="#CCCCCC"> they're really</font>

709
00:37:23,680 --> 00:37:29,859
occurring in a Content that looks like

710
00:37:26,530 --> 00:37:34,420
PHP if there is no bracket around that

711
00:37:29,860 --> 00:37:37,360
is unlikely that system refers to a PHP

712
00:37:34,420 --> 00:37:40,910
function name and with this he was able

713
00:37:37,360 --> 00:37:45,290
to<font color="#CCCCCC"> reduce the false positively immensely</font>

714
00:37:40,910 --> 00:37:50,180
while still catching a very big database

715
00:37:45,290 --> 00:37:52,600
of PHP exploits so here<font color="#CCCCCC"> we have a very</font>

716
00:37:50,180 --> 00:37:56,750
good distinction between attack and

717
00:37:52,600 --> 00:37:59,480
benign traffic very nice rules and I

718
00:37:56,750 --> 00:38:02,570
think this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> developing into a generic</font>

719
00:37:59,480 --> 00:38:05,380
pattern if you have a long list of

720
00:38:02,570 --> 00:38:08,720
function names<font color="#E5E5E5"> and any sort of language</font>

721
00:38:05,380 --> 00:38:11,120
dividing them into stuff which<font color="#CCCCCC"> is</font>

722
00:38:08,720 --> 00:38:13,879
appearing in<font color="#CCCCCC"> the language the natural</font>

723
00:38:11,120 --> 00:38:16,040
language or not and into dangerous and

724
00:38:13,880 --> 00:38:18,140
not dangerous stuff gives you four

725
00:38:16,040 --> 00:38:21,350
groups and you handle the four<font color="#E5E5E5"> groups</font>

726
00:38:18,140 --> 00:38:25,580
individually and I think we're going to

727
00:38:21,350 --> 00:38:27,950
apply this to other languages<font color="#E5E5E5"> as well so</font>

728
00:38:25,580 --> 00:38:29,960
return to the statistics<font color="#CCCCCC"> you've seen</font>

729
00:38:27,950 --> 00:38:33,799
this before this is my vanilla test

730
00:38:29,960 --> 00:38:37,610
traffic this is<font color="#E5E5E5"> myself victim of a</font>

731
00:38:33,800 --> 00:38:39,800
man-in-the-middle attack and this is the

732
00:38:37,610 --> 00:38:43,010
combined attack traffic you see the

733
00:38:39,800 --> 00:38:47,630
<font color="#CCCCCC">difference this is huge</font><font color="#E5E5E5"> and paranoia</font>

734
00:38:43,010 --> 00:38:49,700
level<font color="#CCCCCC"> one you can say like most of these</font>

735
00:38:47,630 --> 00:38:52,460
alerts that they are really<font color="#E5E5E5"> the</font>

736
00:38:49,700 --> 00:38:54,740
attackers and then even<font color="#E5E5E5"> I'm higher</font>

737
00:38:52,460 --> 00:39:00,860
paranoia level there<font color="#CCCCCC"> is a</font><font color="#E5E5E5"> huge gap</font>

738
00:38:54,740 --> 00:39:04,040
between green and red so what happens if

739
00:39:00,860 --> 00:39:07,580
you put this next to one another so now

740
00:39:04,040 --> 00:39:09,980
we have like the initial graph we have

741
00:39:07,580 --> 00:39:12,590
the available<font color="#E5E5E5"> requests and how much they</font>

742
00:39:09,980 --> 00:39:14,270
scored Bobby tables how many numbers

743
00:39:12,590 --> 00:39:18,860
together on his back what it was his

744
00:39:14,270 --> 00:39:22,460
score and now in paranoia level<font color="#CCCCCC"> one so</font>

745
00:39:18,860 --> 00:39:26,740
that's<font color="#E5E5E5"> the default 30 install most</font>

746
00:39:22,460 --> 00:39:31,340
requests skoura<font color="#E5E5E5"> 0 now green</font><font color="#CCCCCC"> raza red and</font>

747
00:39:26,740 --> 00:39:35,149
then<font color="#CCCCCC"> the there</font><font color="#E5E5E5"> is no vanilla request</font>

748
00:39:31,340 --> 00:39:37,430
scoring higher than 15 which is very

749
00:39:35,150 --> 00:39:40,370
<font color="#E5E5E5">nice why does the attacker is</font><font color="#CCCCCC"> called a</font>

750
00:39:37,430 --> 00:39:43,310
higher of course you're asking why are

751
00:39:40,370 --> 00:39:46,759
you seeing<font color="#E5E5E5"> see rose with the attackers</font>

752
00:39:43,310 --> 00:39:49,790
the point here<font color="#E5E5E5"> is not everything what</font>

753
00:39:46,760 --> 00:39:52,620
Nick told us is an attack a lot of the

754
00:39:49,790 --> 00:39:55,740
nikto requests<font color="#E5E5E5"> our scans is</font>

755
00:39:52,620 --> 00:39:58,109
PHP myadmin installed it's this week

756
00:39:55,740 --> 00:40:00,839
application installed this<font color="#E5E5E5"> is not an</font>

757
00:39:58,110 --> 00:40:03,420
attack in itself and<font color="#E5E5E5"> mod security is not</font>

758
00:40:00,840 --> 00:40:07,560
alarming when it sees this it's just a

759
00:40:03,420 --> 00:40:10,080
path which will likely lead to a 404 so

760
00:40:07,560 --> 00:40:13,230
that's how<font color="#CCCCCC"> we</font><font color="#E5E5E5"> get zeros but the real</font>

761
00:40:10,080 --> 00:40:15,360
attacks of nikto escrow map etc they're

762
00:40:13,230 --> 00:40:17,760
helping further to the right and we see

763
00:40:15,360 --> 00:40:19,980
a<font color="#CCCCCC"> very clear distinction and with a</font>

764
00:40:17,760 --> 00:40:24,150
little<font color="#E5E5E5"> bit of tuning and mind you this</font>

765
00:40:19,980 --> 00:40:28,710
is a logarithmic scale so 0 is way

766
00:40:24,150 --> 00:40:31,410
higher up on the roof and<font color="#E5E5E5"> 4 etc is way</font>

767
00:40:28,710 --> 00:40:33,030
lower I made it logarithmic to show you

768
00:40:31,410 --> 00:40:37,009
that<font color="#E5E5E5"> there</font><font color="#CCCCCC"> is something actually</font>

769
00:40:33,030 --> 00:40:37,010
happening with the green ones as well

770
00:40:38,360 --> 00:40:44,280
people ask me this paranoia mode is it

771
00:40:42,390 --> 00:40:46,650
compatible with the<font color="#E5E5E5"> animal is calling</font>

772
00:40:44,280 --> 00:40:49,100
the one which we did the demo and of

773
00:40:46,650 --> 00:40:52,380
course<font color="#CCCCCC"> it is that's the whole point</font>

774
00:40:49,100 --> 00:40:55,290
people<font color="#CCCCCC"> are supposed to ease in into an</font>

775
00:40:52,380 --> 00:40:59,400
installation now and have<font color="#CCCCCC"> have an easy</font>

776
00:40:55,290 --> 00:41:02,240
way into this with a low paranoia level

777
00:40:59,400 --> 00:41:05,580
a default setting at one at a very high

778
00:41:02,240 --> 00:41:07,979
relaxed threshold so you remember<font color="#CCCCCC"> the</font>

779
00:41:05,580 --> 00:41:10,470
stick and they were putting it hip very

780
00:41:07,980 --> 00:41:12,330
very high that's relaxed that's how<font color="#E5E5E5"> you</font>

781
00:41:10,470 --> 00:41:14,370
approach the problem that's<font color="#E5E5E5"> your first</font>

782
00:41:12,330 --> 00:41:17,779
installation you can<font color="#E5E5E5"> go into production</font>

783
00:41:14,370 --> 00:41:21,600
like that and nothing bad happens and

784
00:41:17,780 --> 00:41:24,660
then as<font color="#CCCCCC"> you mature you lower the limit</font>

785
00:41:21,600 --> 00:41:27,089
lower<font color="#E5E5E5"> and lower and you end up with the</font>

786
00:41:24,660 --> 00:41:30,359
security level of a standard side in the

787
00:41:27,090 --> 00:41:33,300
lower left corner so low paranoia level

788
00:41:30,360 --> 00:41:37,200
and an animal a limit which is<font color="#E5E5E5"> also low</font>

789
00:41:33,300 --> 00:41:41,220
of<font color="#CCCCCC"> course I would advocate to use a high</font>

790
00:41:37,200 --> 00:41:43,980
paranoia level but being reasonable we

791
00:41:41,220 --> 00:41:47,160
know that<font color="#E5E5E5"> not</font><font color="#CCCCCC"> security is so hard to</font>

792
00:41:43,980 --> 00:41:49,530
deploy nowadays that people refrain from

793
00:41:47,160 --> 00:41:53,670
using it all together and we would

794
00:41:49,530 --> 00:41:55,740
rather have a not so strong rule set but

795
00:41:53,670 --> 00:41:58,740
have it really in a blocking mode that's

796
00:41:55,740 --> 00:42:02,520
a lot<font color="#E5E5E5"> better than not having</font><font color="#CCCCCC"> the wolf at</font>

797
00:41:58,740 --> 00:42:05,870
all so I would<font color="#E5E5E5"> say a low paranoia level</font>

798
00:42:02,520 --> 00:42:07,910
combined with a strict low limit and

799
00:42:05,870 --> 00:42:10,190
very few false positive that's a good

800
00:42:07,910 --> 00:42:14,089
default that's what you should be aiming

801
00:42:10,190 --> 00:42:16,610
for and then if you have a higher need

802
00:42:14,090 --> 00:42:19,250
for security and if your appetite<font color="#CCCCCC"> for</font>

803
00:42:16,610 --> 00:42:22,790
false positives is higher then you

804
00:42:19,250 --> 00:42:26,540
slowly move up or raise the paranoia

805
00:42:22,790 --> 00:42:30,680
level to a higher level and then you

806
00:42:26,540 --> 00:42:36,440
arrive at a high security side what does

807
00:42:30,680 --> 00:42:40,430
not make any sense at all is to run the

808
00:42:36,440 --> 00:42:42,710
anomaly limit<font color="#E5E5E5"> high with a high paranoia</font>

809
00:42:40,430 --> 00:42:45,049
limit this will be<font color="#CCCCCC"> a</font><font color="#E5E5E5"> combination of the</font>

810
00:42:42,710 --> 00:42:49,550
bad the<font color="#CCCCCC"> bad things from the two worlds</font>

811
00:42:45,050 --> 00:42:52,400
so you would have<font color="#E5E5E5"> all no protection at</font>

812
00:42:49,550 --> 00:42:54,860
all because it's a very<font color="#CCCCCC"> hippy limit and</font>

813
00:42:52,400 --> 00:42:57,680
all the false positives which you can

814
00:42:54,860 --> 00:43:01,370
have that's crazy don't do that you

815
00:42:57,680 --> 00:43:03,230
either do a low paranoia level on a fee

816
00:43:01,370 --> 00:43:06,160
to a high paranoia level you would want

817
00:43:03,230 --> 00:43:11,750
to<font color="#E5E5E5"> run this with a low animal</font><font color="#CCCCCC"> e limit</font>

818
00:43:06,160 --> 00:43:14,240
good and two weeks<font color="#E5E5E5"> ago I was ready to</font>

819
00:43:11,750 --> 00:43:17,240
fire<font color="#CCCCCC"> this on a real production side so</font>

820
00:43:14,240 --> 00:43:19,220
that's the first<font color="#E5E5E5"> production side big</font>

821
00:43:17,240 --> 00:43:22,790
production side which would actually use

822
00:43:19,220 --> 00:43:25,279
the new development call rules at 30

823
00:43:22,790 --> 00:43:29,330
with this paranoia level and what I set

824
00:43:25,280 --> 00:43:32,240
up I wanted<font color="#E5E5E5"> to compare the behavior in</font>

825
00:43:29,330 --> 00:43:34,480
an untuned setting with a lot<font color="#CCCCCC"> of traffic</font>

826
00:43:32,240 --> 00:43:37,700
it's a high-traffic side and Switzerland

827
00:43:34,480 --> 00:43:41,450
with the different rule sets so I would

828
00:43:37,700 --> 00:43:44,689
set up five rule pipelines I would set

829
00:43:41,450 --> 00:43:47,990
up I call rules<font color="#E5E5E5"> 229 a stable release</font>

830
00:43:44,690 --> 00:43:50,450
pipeline than one for the new paranoia

831
00:43:47,990 --> 00:43:53,500
level one new rules for<font color="#E5E5E5"> our level two</font>

832
00:43:50,450 --> 00:43:57,080
three and four and i would get five

833
00:43:53,500 --> 00:44:00,800
pipelines and then run the request by

834
00:43:57,080 --> 00:44:04,520
random through our one of these rule

835
00:44:00,800 --> 00:44:07,190
sets and being a high-traffic side it's

836
00:44:04,520 --> 00:44:10,340
a content management system of a big

837
00:44:07,190 --> 00:44:12,530
corp in<font color="#E5E5E5"> switzerland with a in the region</font>

838
00:44:10,340 --> 00:44:15,050
of millions of requests per day single

839
00:44:12,530 --> 00:44:17,390
<font color="#CCCCCC">bigoted millions we get a</font><font color="#E5E5E5"> lot of traffic</font>

840
00:44:15,050 --> 00:44:19,850
and we're leveling out for a statistics

841
00:44:17,390 --> 00:44:22,400
and this is how we ended up

842
00:44:19,850 --> 00:44:27,259
it's a crazy amount of false positives

843
00:44:22,400 --> 00:44:30,590
for 229 so again every<font color="#E5E5E5"> single request</font>

844
00:44:27,260 --> 00:44:33,920
scored on average at least<font color="#E5E5E5"> five alerts</font>

845
00:44:30,590 --> 00:44:36,470
and this representing millions of

846
00:44:33,920 --> 00:44:40,580
requests these are millions and millions

847
00:44:36,470 --> 00:44:44,410
of false alarms but not the request

848
00:44:40,580 --> 00:44:47,420
which went<font color="#E5E5E5"> into the 30 development</font>

849
00:44:44,410 --> 00:44:50,149
release with<font color="#CCCCCC"> the default paranoia level</font>

850
00:44:47,420 --> 00:44:54,850
they didn't score exactly zero on

851
00:44:50,150 --> 00:44:57,640
average but almost so really way beyond

852
00:44:54,850 --> 00:45:01,310
99% of the false positives are gone and

853
00:44:57,640 --> 00:45:05,379
only when we raise the paranoia level to

854
00:45:01,310 --> 00:45:07,790
two or three are<font color="#E5E5E5"> they coming</font><font color="#CCCCCC"> back and</font>

855
00:45:05,380 --> 00:45:09,710
even if we<font color="#E5E5E5"> have a bit of attack traffic</font>

856
00:45:07,790 --> 00:45:12,860
in here I know there is<font color="#CCCCCC"> a bit of</font><font color="#E5E5E5"> attacks</font>

857
00:45:09,710 --> 00:45:16,670
but most of this is really legitimate

858
00:45:12,860 --> 00:45:19,790
and benign<font color="#CCCCCC"> Internet traffic there</font>

859
00:45:16,670 --> 00:45:21,830
shouldn't<font color="#E5E5E5"> be all that many alarms and I</font>

860
00:45:19,790 --> 00:45:25,340
think this proves that the whole<font color="#CCCCCC"> concept</font>

861
00:45:21,830 --> 00:45:28,220
of the paranoia mode actually works in

862
00:45:25,340 --> 00:45:30,920
practice thank you very<font color="#E5E5E5"> much for</font>

863
00:45:28,220 --> 00:45:32,779
listening the rest<font color="#E5E5E5"> of my presentation</font>

864
00:45:30,920 --> 00:45:36,560
here are my contacts is going to be

865
00:45:32,780 --> 00:45:39,620
online probably is already photo sources

866
00:45:36,560 --> 00:45:41,960
and if you're intrigued<font color="#CCCCCC"> now to dive into</font>

867
00:45:39,620 --> 00:45:44,029
modsecurity bit more<font color="#CCCCCC"> I'm going to</font><font color="#E5E5E5"> teach</font>

868
00:45:41,960 --> 00:45:46,280
a<font color="#E5E5E5"> mod Security Rule writing course and</font>

869
00:45:44,030 --> 00:45:49,070
the<font color="#CCCCCC"> karoo cores in London in September</font>

870
00:45:46,280 --> 00:45:51,980
and<font color="#E5E5E5"> will be cool to see a few faces from</font>

871
00:45:49,070 --> 00:45:54,940
you in London<font color="#E5E5E5"> in my course thank you for</font>

872
00:45:51,980 --> 00:45:54,940
watching thank you<font color="#E5E5E5"> for listening</font>

873
00:46:01,079 --> 00:46:09,609
are we<font color="#E5E5E5"> taking questions or anybody know</font>

874
00:46:06,579 --> 00:46:13,950
if questions are allowed I would welcome

875
00:46:09,609 --> 00:46:13,950
questions actually there is a question

876
00:46:28,460 --> 00:46:36,520
okay the the<font color="#E5E5E5"> question is why are we</font>

877
00:46:33,020 --> 00:46:40,690
seeing such a big big gap here between

878
00:46:36,520 --> 00:46:45,500
zero between paranoia level<font color="#CCCCCC"> one</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> two</font>

879
00:46:40,690 --> 00:46:48,190
this<font color="#E5E5E5"> is fairly new and there are not</font>

880
00:46:45,500 --> 00:46:50,869
that many rule in paranoia level<font color="#E5E5E5"> two and</font>

881
00:46:48,190 --> 00:46:54,560
this is not the end of the story we

882
00:46:50,869 --> 00:46:56,359
might get lower again but then this<font color="#CCCCCC"> is a</font>

883
00:46:54,560 --> 00:46:58,609
very specific installation this is

884
00:46:56,359 --> 00:47:01,310
actually I can tell you this is a Drupal

885
00:46:58,609 --> 00:47:03,890
site and Drupal is really crazy with the

886
00:47:01,310 --> 00:47:06,140
parameter<font color="#E5E5E5"> names so what is</font><font color="#CCCCCC"> happening</font>

887
00:47:03,890 --> 00:47:10,330
here that<font color="#E5E5E5"> a lot of cookies are</font>

888
00:47:06,140 --> 00:47:14,359
triggering a crazy amount<font color="#E5E5E5"> of traffic so</font>

889
00:47:10,330 --> 00:47:17,810
being so far to the right even in 229 is

890
00:47:14,359 --> 00:47:19,880
a bit extreme so when as this is the

891
00:47:17,810 --> 00:47:22,670
first side where I<font color="#E5E5E5"> used it and when I</font>

892
00:47:19,880 --> 00:47:25,339
saw it these numbers are almost too good

893
00:47:22,670 --> 00:47:28,580
to be true so the gap is not as high as

894
00:47:25,339 --> 00:47:30,680
that at a different installation but

895
00:47:28,580 --> 00:47:33,859
it's likely it will<font color="#E5E5E5"> be a significant gap</font>

896
00:47:30,680 --> 00:47:36,529
because in paranoia level<font color="#CCCCCC"> one we won't</font>

897
00:47:33,859 --> 00:47:39,290
really want to have as<font color="#CCCCCC"> little false</font>

898
00:47:36,530 --> 00:47:41,450
positive as positive as as possible and

899
00:47:39,290 --> 00:47:44,029
then<font color="#CCCCCC"> of course</font><font color="#E5E5E5"> there will be a high gap</font>

900
00:47:41,450 --> 00:47:46,399
to<font color="#CCCCCC"> the level to where you allow false</font>

901
00:47:44,030 --> 00:47:48,349
positive<font color="#CCCCCC"> and a reasonable number it</font>

902
00:47:46,400 --> 00:47:50,540
depends<font color="#E5E5E5"> on individual side and there is</font>

903
00:47:48,349 --> 00:47:54,500
still design going on it's tuning

904
00:47:50,540 --> 00:48:02,839
calibrating a bit<font color="#CCCCCC"> okay more questions</font>

905
00:47:54,500 --> 00:48:05,560
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> question no question okay thank</font>

906
00:48:02,839 --> 00:48:05,560
you we're<font color="#E5E5E5"> done</font>

907
00:48:06,299 --> 00:48:08,359
you

