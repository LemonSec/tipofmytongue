1
00:00:09,830 --> 00:00:16,680
<font color="#E5E5E5">okay we're off</font><font color="#CCCCCC"> good morning everyone</font>

2
00:00:12,930 --> 00:00:19,380
<font color="#CCCCCC">my name is</font><font color="#E5E5E5"> Beth</font><font color="#CCCCCC"> tutti I'm going to talk</font>

3
00:00:16,680 --> 00:00:24,390
to you about accessing<font color="#CCCCCC"> your embed device</font>

4
00:00:19,380 --> 00:00:26,820
using page guides so a little<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> about</font>

5
00:00:24,390 --> 00:00:28,470
me<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> deaf two-tiered as I mentioned</font>

6
00:00:26,820 --> 00:00:31,829
I'm an embedded software engineer

7
00:00:28,470 --> 00:00:35,220
<font color="#E5E5E5">currently at working at mind</font><font color="#CCCCCC"> which is a</font>

8
00:00:31,829 --> 00:00:36,390
division<font color="#CCCCCC"> of Ascension we are located in</font>

9
00:00:35,220 --> 00:00:41,250
<font color="#CCCCCC">lurvin</font>

10
00:00:36,390 --> 00:00:45,510
and we're doing<font color="#E5E5E5"> mainly embedded and</font><font color="#CCCCCC"> open</font>

11
00:00:41,250 --> 00:00:49,440
<font color="#CCCCCC">source projects</font><font color="#E5E5E5"> you can contact us using</font>

12
00:00:45,510 --> 00:00:53,910
our email address like that<font color="#CCCCCC"> and of</font>

13
00:00:49,440 --> 00:00:57,120
<font color="#E5E5E5">course our clients are always</font><font color="#CCCCCC"> working</font>

14
00:00:53,910 --> 00:01:00,179
with some kind of embedded products<font color="#E5E5E5"> and</font>

15
00:00:57,120 --> 00:01:02,550
an embedded<font color="#E5E5E5"> system in this example it</font>

16
00:01:00,180 --> 00:01:06,799
was a client who<font color="#E5E5E5"> was in the home</font>

17
00:01:02,550 --> 00:01:09,929
automation<font color="#E5E5E5"> sector and a typical</font>

18
00:01:06,799 --> 00:01:12,450
situation<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> find there is that</font>

19
00:01:09,929 --> 00:01:14,340
you<font color="#E5E5E5"> have some kind of yeah home</font>

20
00:01:12,450 --> 00:01:16,920
<font color="#E5E5E5">automation bus with all</font><font color="#CCCCCC"> devices</font>

21
00:01:14,340 --> 00:01:19,320
<font color="#CCCCCC">connected to</font><font color="#E5E5E5"> it whether it's Phillips</font>

22
00:01:16,920 --> 00:01:23,009
you or<font color="#E5E5E5"> KNX or whatever there's always</font>

23
00:01:19,320 --> 00:01:25,169
some proprietary<font color="#E5E5E5"> bus system with some</font>

24
00:01:23,009 --> 00:01:27,299
devices<font color="#E5E5E5"> connected</font><font color="#CCCCCC"> to it but then if you</font>

25
00:01:25,170 --> 00:01:30,119
want<font color="#E5E5E5"> to control it</font><font color="#CCCCCC"> with your</font><font color="#E5E5E5"> mobile</font>

26
00:01:27,299 --> 00:01:32,880
application for<font color="#E5E5E5"> example</font><font color="#CCCCCC"> you need some</font>

27
00:01:30,119 --> 00:01:35,429
sort of gateway<font color="#E5E5E5"> device which translates</font>

28
00:01:32,880 --> 00:01:39,420
the IP network on one side towards your

29
00:01:35,429 --> 00:01:42,840
<font color="#E5E5E5">proprietary bus</font><font color="#CCCCCC"> so this is what you get</font>

30
00:01:39,420 --> 00:01:44,759
when you're<font color="#CCCCCC"> on a local network but</font>

31
00:01:42,840 --> 00:01:49,289
<font color="#E5E5E5">usually your gateway is connected to</font>

32
00:01:44,759 --> 00:01:52,889
<font color="#E5E5E5">your home router or firewall and then</font>

33
00:01:49,289 --> 00:01:55,139
<font color="#E5E5E5">connected to</font><font color="#CCCCCC"> the Internet</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> the main</font>

34
00:01:52,889 --> 00:01:58,889
problem most of the time is how do<font color="#E5E5E5"> we</font>

35
00:01:55,139 --> 00:02:01,889
access our<font color="#E5E5E5"> gateway from outside of our</font>

36
00:01:58,889 --> 00:02:04,798
home network so over the<font color="#E5E5E5"> Internet</font>

37
00:02:01,889 --> 00:02:08,030
and for that<font color="#CCCCCC"> of course</font><font color="#E5E5E5"> we need some sort</font>

38
00:02:04,799 --> 00:02:12,720
of tunneling<font color="#E5E5E5"> there are different</font>

39
00:02:08,030 --> 00:02:16,040
<font color="#E5E5E5">solutions</font><font color="#CCCCCC"> for that most of you</font><font color="#E5E5E5"> think</font>

40
00:02:12,720 --> 00:02:19,100
<font color="#CCCCCC">about SSH or a VPN may</font>

41
00:02:16,040 --> 00:02:22,670
but usually<font color="#CCCCCC"> it's not possible to</font>

42
00:02:19,100 --> 00:02:24,950
implement a VPN client or an<font color="#CCCCCC"> SSH client</font>

43
00:02:22,670 --> 00:02:29,600
on an<font color="#CCCCCC"> embedded</font><font color="#E5E5E5"> device which is a</font>

44
00:02:24,950 --> 00:02:33,170
<font color="#CCCCCC">low-level</font><font color="#E5E5E5"> microcontroller so you can do</font>

45
00:02:29,600 --> 00:02:36,739
as Leon and use<font color="#CCCCCC"> MQTT maybe</font><font color="#E5E5E5"> but that</font>

46
00:02:33,170 --> 00:02:38,869
<font color="#E5E5E5">requires us to change the protocol</font><font color="#CCCCCC"> that</font>

47
00:02:36,740 --> 00:02:42,230
you're using to talk to the to the

48
00:02:38,870 --> 00:02:44,300
<font color="#CCCCCC">Gateway</font><font color="#E5E5E5"> so the protocol</font><font color="#CCCCCC"> that you</font><font color="#E5E5E5"> use to</font>

49
00:02:42,230 --> 00:02:47,209
talk<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> Gateway owner on your local</font>

50
00:02:44,300 --> 00:02:49,430
network<font color="#CCCCCC"> might be different than</font><font color="#E5E5E5"> when you</font>

51
00:02:47,210 --> 00:02:53,990
connect<font color="#CCCCCC"> to it</font><font color="#E5E5E5"> over the network over the</font>

52
00:02:49,430 --> 00:02:57,140
<font color="#CCCCCC">Internet</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> use PubNub which is</font>

53
00:02:53,990 --> 00:03:00,410
also requiring you<font color="#CCCCCC"> to change your</font>

54
00:02:57,140 --> 00:03:03,010
protocol<font color="#E5E5E5"> and it's also quite expensive</font><font color="#CCCCCC"> I</font>

55
00:03:00,410 --> 00:03:07,340
don't<font color="#E5E5E5"> think it's</font><font color="#CCCCCC"> open-source as well so</font>

56
00:03:03,010 --> 00:03:08,810
and one of the main<font color="#CCCCCC"> requirements from</font>

57
00:03:07,340 --> 00:03:11,480
<font color="#E5E5E5">our clients was that it should be</font>

58
00:03:08,810 --> 00:03:13,880
<font color="#CCCCCC">open-source scalable</font><font color="#E5E5E5"> and of course</font>

59
00:03:11,480 --> 00:03:17,060
doesn't<font color="#E5E5E5"> require us to change the</font>

60
00:03:13,880 --> 00:03:19,190
protocol so that<font color="#E5E5E5"> it's transparent for</font>

61
00:03:17,060 --> 00:03:22,070
the mobile<font color="#E5E5E5"> app whether he's</font><font color="#CCCCCC"> on the local</font>

62
00:03:19,190 --> 00:03:26,690
network<font color="#E5E5E5"> or on the</font><font color="#CCCCCC"> Internet to talk to</font>

63
00:03:22,070 --> 00:03:28,340
<font color="#CCCCCC">the device and</font><font color="#E5E5E5"> of course it should</font><font color="#CCCCCC"> be no</font>

64
00:03:26,690 --> 00:03:31,640
problem<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get through most of the</font>

65
00:03:28,340 --> 00:03:34,760
firewall settings<font color="#E5E5E5"> of routers</font><font color="#CCCCCC"> the typical</font>

66
00:03:31,640 --> 00:03:39,619
routers in your home so that's why we

67
00:03:34,760 --> 00:03:43,220
chose to<font color="#CCCCCC"> use page guides so what does</font>

68
00:03:39,620 --> 00:03:45,950
page guy do<font color="#CCCCCC"> has a library that we</font>

69
00:03:43,220 --> 00:03:49,700
created on your<font color="#CCCCCC"> embedded device running</font>

70
00:03:45,950 --> 00:03:52,730
<font color="#E5E5E5">on the</font><font color="#CCCCCC"> Gateway so in our specific</font><font color="#E5E5E5"> use</font>

71
00:03:49,700 --> 00:03:56,030
case<font color="#E5E5E5"> at our client the Gateway was an</font>

72
00:03:52,730 --> 00:03:58,700
embed device so we needed<font color="#E5E5E5"> to</font><font color="#CCCCCC"> create a</font>

73
00:03:56,030 --> 00:04:01,820
back-end library for<font color="#E5E5E5"> pagekite for Emmet</font>

74
00:03:58,700 --> 00:04:04,310
<font color="#CCCCCC">and of course</font><font color="#E5E5E5"> Emmet also needs a</font>

75
00:04:01,820 --> 00:04:08,780
<font color="#E5E5E5">front-end server running somewhere on</font>

76
00:04:04,310 --> 00:04:10,850
the public<font color="#E5E5E5"> Internet and it's the page</font>

77
00:04:08,780 --> 00:04:14,030
<font color="#E5E5E5">guide back-end library that will connect</font>

78
00:04:10,850 --> 00:04:17,029
to the<font color="#CCCCCC"> front-end and create a</font><font color="#E5E5E5"> tunnel and</font>

79
00:04:14,030 --> 00:04:18,910
and then your mobile app will talk to

80
00:04:17,029 --> 00:04:22,429
the page guide front-end server

81
00:04:18,910 --> 00:04:25,130
transparently like it would talk to<font color="#E5E5E5"> the</font>

82
00:04:22,430 --> 00:04:28,740
<font color="#CCCCCC">Gateway</font><font color="#E5E5E5"> immediately on your local</font>

83
00:04:25,130 --> 00:04:30,300
so<font color="#E5E5E5"> how does it work pagekite now you</font>

84
00:04:28,740 --> 00:04:32,580
have<font color="#E5E5E5"> your back end you have your front</font>

85
00:04:30,300 --> 00:04:35,250
<font color="#CCCCCC">ends</font><font color="#E5E5E5"> the reference link is there so if</font>

86
00:04:32,580 --> 00:04:38,669
you want<font color="#CCCCCC"> to read more about</font><font color="#E5E5E5"> it you start</font>

87
00:04:35,250 --> 00:04:40,950
<font color="#CCCCCC">off with setting up normal TCP TLS</font>

88
00:04:38,670 --> 00:04:45,290
connection<font color="#E5E5E5"> if you want the crip</font><font color="#CCCCCC"> ssin of</font>

89
00:04:40,950 --> 00:04:49,580
course you need TLS then you send a

90
00:04:45,290 --> 00:04:55,260
connect message towards<font color="#E5E5E5"> the front ends</font>

91
00:04:49,580 --> 00:05:00,300
<font color="#E5E5E5">which consists of a similar a similar</font>

92
00:04:55,260 --> 00:05:02,930
way as HTTP connect so<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> yeah</font>

93
00:05:00,300 --> 00:05:06,510
some sort<font color="#E5E5E5"> of fields that you need</font><font color="#CCCCCC"> to</font>

94
00:05:02,930 --> 00:05:11,100
fill in<font color="#E5E5E5"> so you have X page guide saying</font>

95
00:05:06,510 --> 00:05:14,599
okay we need a row protocol<font color="#CCCCCC"> the port</font>

96
00:05:11,100 --> 00:05:17,250
indicates the public port<font color="#E5E5E5"> where your</font>

97
00:05:14,600 --> 00:05:20,400
clients will connect to on the front<font color="#CCCCCC"> end</font>

98
00:05:17,250 --> 00:05:22,470
and then<font color="#E5E5E5"> you have the kite name which is</font>

99
00:05:20,400 --> 00:05:27,979
usually<font color="#E5E5E5"> the DNS of the front end server</font>

100
00:05:22,470 --> 00:05:31,230
and then a<font color="#E5E5E5"> random string the front</font><font color="#CCCCCC"> end</font>

101
00:05:27,980 --> 00:05:34,770
answers with a sign this message which

102
00:05:31,230 --> 00:05:38,490
consists of mainly the<font color="#E5E5E5"> same things that</font>

103
00:05:34,770 --> 00:05:43,849
you<font color="#E5E5E5"> sent to</font><font color="#CCCCCC"> it plus a token so also a</font>

104
00:05:38,490 --> 00:05:43,850
random<font color="#CCCCCC"> number and</font><font color="#E5E5E5"> a session ID</font>

105
00:05:44,840 --> 00:05:52,520
and then you send back<font color="#E5E5E5"> a sign message</font>

106
00:05:48,310 --> 00:05:55,250
which is<font color="#CCCCCC"> of</font><font color="#E5E5E5"> course includes a signature</font>

107
00:05:52,520 --> 00:05:57,049
<font color="#E5E5E5">which is based on the random number that</font>

108
00:05:55,250 --> 00:06:00,919
<font color="#E5E5E5">you got from the server from the</font>

109
00:05:57,050 --> 00:06:03,500
<font color="#CCCCCC">front-end server in in a hash of course</font>

110
00:06:00,919 --> 00:06:05,419
<font color="#CCCCCC">together with a shared secret</font><font color="#E5E5E5"> so the</font>

111
00:06:03,500 --> 00:06:09,020
front end and the<font color="#E5E5E5"> Emma device have a</font>

112
00:06:05,419 --> 00:06:14,570
shared secret<font color="#E5E5E5"> you create a hash and</font>

113
00:06:09,020 --> 00:06:17,150
<font color="#E5E5E5">that's your signature and then of course</font>

114
00:06:14,570 --> 00:06:22,190
<font color="#CCCCCC">the front</font><font color="#E5E5E5"> ends replies whatever your</font>

115
00:06:17,150 --> 00:06:27,440
signature was<font color="#E5E5E5"> okay or</font><font color="#CCCCCC"> not so with a</font>

116
00:06:22,190 --> 00:06:31,310
normal<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> or invalid and</font><font color="#E5E5E5"> after that</font>

117
00:06:27,440 --> 00:06:34,669
your<font color="#E5E5E5"> connection is</font><font color="#CCCCCC"> set up so when your</font>

118
00:06:31,310 --> 00:06:38,950
so the handshake is<font color="#CCCCCC"> done</font><font color="#E5E5E5"> when a client</font>

119
00:06:34,669 --> 00:06:40,820
connects to<font color="#E5E5E5"> your front ends then the</font>

120
00:06:38,950 --> 00:06:43,539
<font color="#E5E5E5">communication that is sent to the front</font>

121
00:06:40,820 --> 00:06:47,180
end is sent<font color="#E5E5E5"> over the tunnel in chunks so</font>

122
00:06:43,540 --> 00:06:49,550
<font color="#CCCCCC">how does a chunk look like a chunk is</font>

123
00:06:47,180 --> 00:06:53,570
actually just a length indicator and

124
00:06:49,550 --> 00:06:56,210
some data and what's in the data the

125
00:06:53,570 --> 00:07:00,800
<font color="#CCCCCC">data indicates</font><font color="#E5E5E5"> okay for which such a</font>

126
00:06:56,210 --> 00:07:04,849
session ID<font color="#E5E5E5"> is this data from which host</font>

127
00:07:00,800 --> 00:07:09,110
is it<font color="#E5E5E5"> coming towards which service on</font>

128
00:07:04,850 --> 00:07:11,539
your<font color="#CCCCCC"> gateway so you have your remote IP</font>

129
00:07:09,110 --> 00:07:14,120
and your remote port from where is a

130
00:07:11,539 --> 00:07:18,110
communication coming<font color="#E5E5E5"> and towards where</font>

131
00:07:14,120 --> 00:07:21,970
or<font color="#E5E5E5"> do you want it to be sent and then of</font>

132
00:07:18,110 --> 00:07:26,720
<font color="#CCCCCC">course the</font><font color="#E5E5E5"> data itself so this is how</font>

133
00:07:21,970 --> 00:07:28,610
you can know on your<font color="#CCCCCC"> back-end</font><font color="#E5E5E5"> side</font><font color="#CCCCCC"> where</font>

134
00:07:26,720 --> 00:07:33,650
does the<font color="#E5E5E5"> communication need to go where</font>

135
00:07:28,610 --> 00:07:36,740
does<font color="#E5E5E5"> the data need to go so what options</font>

136
00:07:33,650 --> 00:07:39,289
do we have<font color="#E5E5E5"> to implement page guides on</font>

137
00:07:36,740 --> 00:07:41,150
an<font color="#E5E5E5"> embed device we looked at the page</font>

138
00:07:39,289 --> 00:07:44,229
guide which is<font color="#E5E5E5"> provided by</font><font color="#CCCCCC"> the page</font>

139
00:07:41,150 --> 00:07:47,090
guide community which is a sea library

140
00:07:44,229 --> 00:07:49,490
<font color="#E5E5E5">but it was not really usable on an</font><font color="#CCCCCC"> embed</font>

141
00:07:47,090 --> 00:07:52,388
<font color="#E5E5E5">device because it depends on things like</font>

142
00:07:49,490 --> 00:07:55,180
<font color="#E5E5E5">open</font><font color="#CCCCCC"> SSL</font><font color="#E5E5E5"> leaptv</font>

143
00:07:52,389 --> 00:07:59,409
normal sockets<font color="#E5E5E5"> which is all not presents</font>

144
00:07:55,180 --> 00:08:02,770
in ambit<font color="#CCCCCC"> so we needed</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> implement our</font>

145
00:07:59,409 --> 00:08:07,270
<font color="#CCCCCC">own library</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> the backend</font>

146
00:08:02,770 --> 00:08:10,900
functions that<font color="#E5E5E5"> we</font><font color="#CCCCCC"> needed so what is M</font>

147
00:08:07,270 --> 00:08:14,590
but really ambit is a platform<font color="#CCCCCC"> an</font>

148
00:08:10,900 --> 00:08:18,549
operating system<font color="#CCCCCC"> for</font><font color="#E5E5E5"> IOT devices based</font>

149
00:08:14,590 --> 00:08:21,698
on<font color="#CCCCCC"> a cortex-m microcontrollers so it's</font>

150
00:08:18,550 --> 00:08:24,690
owned<font color="#CCCCCC"> by arm it's open source it's</font>

151
00:08:21,699 --> 00:08:28,569
<font color="#E5E5E5">includes a core OS some security</font>

152
00:08:24,690 --> 00:08:30,250
libraries like<font color="#CCCCCC"> ember TLS and also</font>

153
00:08:28,569 --> 00:08:32,769
<font color="#E5E5E5">networking and communication</font>

154
00:08:30,250 --> 00:08:34,809
technologies you have<font color="#CCCCCC"> difference I think</font>

155
00:08:32,769 --> 00:08:36,399
<font color="#CCCCCC">you have different tcp/ip stacks that</font>

156
00:08:34,809 --> 00:08:39,039
<font color="#E5E5E5">you can choose from or you can even</font>

157
00:08:36,399 --> 00:08:41,919
<font color="#E5E5E5">provide your own and it has a developer</font>

158
00:08:39,039 --> 00:08:45,630
community of course<font color="#E5E5E5"> I like to</font><font color="#CCCCCC"> see it as</font>

159
00:08:41,919 --> 00:08:45,630
an Arduino on steroids

160
00:08:46,110 --> 00:08:54,399
so what did<font color="#CCCCCC"> we use to develop this this</font>

161
00:08:50,950 --> 00:08:58,480
library we used the development platform

162
00:08:54,399 --> 00:09:00,699
which is<font color="#E5E5E5"> located here</font><font color="#CCCCCC"> and of</font><font color="#E5E5E5"> course the</font>

163
00:08:58,480 --> 00:09:05,470
<font color="#CCCCCC">Gateway of</font><font color="#E5E5E5"> our client was also based on</font>

164
00:09:00,699 --> 00:09:08,529
this<font color="#E5E5E5"> microcontroller the</font><font color="#CCCCCC"> NXP LPC 1768</font>

165
00:09:05,470 --> 00:09:12,870
<font color="#E5E5E5">which is a cortex m3 32-bit</font>

166
00:09:08,529 --> 00:09:17,579
microcontroller<font color="#CCCCCC"> it's six 96 megahertz</font>

167
00:09:12,870 --> 00:09:17,579
and only 32 kilobytes of RAM

168
00:09:19,580 --> 00:09:26,700
so the memory is actually<font color="#E5E5E5"> quite a</font>

169
00:09:22,410 --> 00:09:31,170
<font color="#E5E5E5">constraint the 32 kilobytes</font><font color="#CCCCCC"> Ram</font><font color="#E5E5E5"> actually</font>

170
00:09:26,700 --> 00:09:34,230
it's 64 kilobytes of RAM<font color="#E5E5E5"> but 32</font><font color="#CCCCCC"> is yeah</font>

171
00:09:31,170 --> 00:09:38,370
<font color="#E5E5E5">reserved for functions for the tcp/ip</font>

172
00:09:34,230 --> 00:09:41,250
<font color="#CCCCCC">stack things</font><font color="#E5E5E5"> like USB functionality and</font>

173
00:09:38,370 --> 00:09:45,660
<font color="#E5E5E5">come functionality so we cannot use a</font>

174
00:09:41,250 --> 00:09:49,410
full ROM that is available<font color="#CCCCCC"> but you can</font>

175
00:09:45,660 --> 00:09:51,719
<font color="#E5E5E5">tweak</font><font color="#CCCCCC"> it so you can tweak the linker a</font>

176
00:09:49,410 --> 00:09:54,449
little bit so you<font color="#CCCCCC"> can use some parts of</font>

177
00:09:51,720 --> 00:09:58,890
the 32 kilobytes that is reserved for

178
00:09:54,450 --> 00:10:01,560
other functions up until now it's not

179
00:09:58,890 --> 00:10:03,180
necessary<font color="#CCCCCC"> for</font><font color="#E5E5E5"> us</font><font color="#CCCCCC"> to do that but</font><font color="#E5E5E5"> probably</font>

180
00:10:01,560 --> 00:10:07,290
we will<font color="#E5E5E5"> need to do it in order</font><font color="#CCCCCC"> to</font>

181
00:10:03,180 --> 00:10:09,750
implement<font color="#CCCCCC"> embed TLS</font><font color="#E5E5E5"> there's also no</font>

182
00:10:07,290 --> 00:10:12,290
random number generator on<font color="#CCCCCC"> the</font>

183
00:10:09,750 --> 00:10:15,660
microcontroller<font color="#CCCCCC"> so we need to do other</font>

184
00:10:12,290 --> 00:10:19,349
tricks<font color="#E5E5E5"> like using the analog inputs as a</font>

185
00:10:15,660 --> 00:10:21,480
random source there<font color="#E5E5E5"> are discussion about</font>

186
00:10:19,350 --> 00:10:24,780
<font color="#CCCCCC">that if that's</font><font color="#E5E5E5"> a really true random</font>

187
00:10:21,480 --> 00:10:28,920
number but for<font color="#CCCCCC"> now it's it's enough</font><font color="#E5E5E5"> you</font>

188
00:10:24,780 --> 00:10:32,339
<font color="#CCCCCC">can</font><font color="#E5E5E5"> use external hardware as</font><font color="#CCCCCC"> well to</font>

189
00:10:28,920 --> 00:10:34,079
<font color="#E5E5E5">create a true</font><font color="#CCCCCC"> random number another</font>

190
00:10:32,340 --> 00:10:36,960
<font color="#E5E5E5">challenge that we had is that the page</font>

191
00:10:34,080 --> 00:10:41,520
guides<font color="#E5E5E5"> protocol documentation wasn't</font>

192
00:10:36,960 --> 00:10:45,330
really yeah as thorough as we would like

193
00:10:41,520 --> 00:10:46,980
<font color="#CCCCCC">I needed to</font><font color="#E5E5E5"> do some wire sharking in</font>

194
00:10:45,330 --> 00:10:50,910
order to really understand how<font color="#E5E5E5"> the</font>

195
00:10:46,980 --> 00:10:54,390
protocol<font color="#E5E5E5"> was working but probably they</font>

196
00:10:50,910 --> 00:10:55,199
<font color="#CCCCCC">are working</font><font color="#E5E5E5"> on that so what are the</font>

197
00:10:54,390 --> 00:10:57,120
<font color="#CCCCCC">limitations</font>

198
00:10:55,200 --> 00:10:59,490
<font color="#CCCCCC">up until now</font><font color="#E5E5E5"> that we have with</font><font color="#CCCCCC"> our</font>

199
00:10:57,120 --> 00:11:03,420
<font color="#E5E5E5">library so it's still in</font><font color="#CCCCCC"> its early</font>

200
00:10:59,490 --> 00:11:06,390
<font color="#CCCCCC">stages we have no encryption yet</font><font color="#E5E5E5"> we're</font>

201
00:11:03,420 --> 00:11:08,790
working<font color="#CCCCCC"> on</font><font color="#E5E5E5"> that there is also no</font>

202
00:11:06,390 --> 00:11:11,880
<font color="#E5E5E5">compression you can</font><font color="#CCCCCC"> use compression</font>

203
00:11:08,790 --> 00:11:15,270
<font color="#CCCCCC">which pagekite</font><font color="#E5E5E5"> we didn't need to because</font>

204
00:11:11,880 --> 00:11:17,970
<font color="#CCCCCC">the protocol</font><font color="#E5E5E5"> that we need to communicate</font>

205
00:11:15,270 --> 00:11:20,569
<font color="#E5E5E5">with</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> Gateway was actually consists</font>

206
00:11:17,970 --> 00:11:23,250
of only<font color="#E5E5E5"> very short messages so</font>

207
00:11:20,570 --> 00:11:27,510
<font color="#E5E5E5">compression was really an overkill</font><font color="#CCCCCC"> for</font>

208
00:11:23,250 --> 00:11:30,430
us<font color="#CCCCCC"> but it can be a challenge to</font>

209
00:11:27,510 --> 00:11:34,240
<font color="#E5E5E5">implement compression on an embed device</font>

210
00:11:30,430 --> 00:11:36,040
and currently<font color="#E5E5E5"> it's also limited</font><font color="#CCCCCC"> to only</font>

211
00:11:34,240 --> 00:11:38,740
one<font color="#CCCCCC"> connection at a time</font>

212
00:11:36,040 --> 00:11:40,870
so there's only<font color="#E5E5E5"> one app that can connect</font>

213
00:11:38,740 --> 00:11:45,130
over<font color="#E5E5E5"> the Internet towards your gateway</font>

214
00:11:40,870 --> 00:11:48,700
at the same time we need<font color="#CCCCCC"> to implement</font>

215
00:11:45,130 --> 00:11:51,220
some sort<font color="#CCCCCC"> of parallelism for that too to</font>

216
00:11:48,700 --> 00:11:56,410
allow<font color="#CCCCCC"> multiple connections</font><font color="#E5E5E5"> at the same</font>

217
00:11:51,220 --> 00:12:00,400
time so what's the API how did we<font color="#CCCCCC"> design</font>

218
00:11:56,410 --> 00:12:03,490
it<font color="#E5E5E5"> we try to make it as yeah similar as</font>

219
00:12:00,400 --> 00:12:07,000
possible<font color="#CCCCCC"> to</font><font color="#E5E5E5"> our the</font><font color="#CCCCCC"> TCP setting up a TCP</font>

220
00:12:03,490 --> 00:12:12,810
socket connection in<font color="#E5E5E5"> ambit so maybe</font>

221
00:12:07,000 --> 00:12:15,460
let's look at some code yeah here<font color="#CCCCCC"> it is</font>

222
00:12:12,810 --> 00:12:18,219
so what do we<font color="#E5E5E5"> need we need some</font>

223
00:12:15,460 --> 00:12:20,800
variables of<font color="#E5E5E5"> course the the kite name is</font>

224
00:12:18,220 --> 00:12:22,360
the<font color="#CCCCCC"> yeah here</font><font color="#E5E5E5"> I used an IP address</font><font color="#CCCCCC"> but</font>

225
00:12:20,800 --> 00:12:25,449
usually it's<font color="#E5E5E5"> the DNS name of your</font>

226
00:12:22,360 --> 00:12:28,900
<font color="#CCCCCC">front-end server</font><font color="#E5E5E5"> and then the port</font>

227
00:12:25,450 --> 00:12:31,060
towards which the the clients will

228
00:12:28,900 --> 00:12:33,910
connect on your<font color="#CCCCCC"> front-end server</font><font color="#E5E5E5"> so the</font>

229
00:12:31,060 --> 00:12:37,209
public ports on the<font color="#CCCCCC"> Internet and</font><font color="#E5E5E5"> then</font>

230
00:12:33,910 --> 00:12:40,740
<font color="#CCCCCC">your shared secrets then what do you do</font>

231
00:12:37,210 --> 00:12:45,790
you you create a page guides<font color="#CCCCCC"> bacons</font>

232
00:12:40,740 --> 00:12:50,070
object with those<font color="#E5E5E5"> parameters</font><font color="#CCCCCC"> you set</font><font color="#E5E5E5"> up</font>

233
00:12:45,790 --> 00:12:50,069
your tcp/ip connection

234
00:12:50,320 --> 00:13:00,040
and then you do a page guide connect to

235
00:12:53,889 --> 00:13:04,779
do<font color="#CCCCCC"> a connect first after that you do a</font>

236
00:13:00,040 --> 00:13:07,599
page guide except on that<font color="#E5E5E5"> connection and</font>

237
00:13:04,779 --> 00:13:09,250
when a client connects towards your

238
00:13:07,600 --> 00:13:12,660
<font color="#E5E5E5">front end</font><font color="#CCCCCC"> you will go through that</font>

239
00:13:09,250 --> 00:13:17,649
function and you can<font color="#E5E5E5"> start receiving</font>

240
00:13:12,660 --> 00:13:19,540
<font color="#E5E5E5">what your</font><font color="#CCCCCC"> clients</font><font color="#E5E5E5"> is sending you this is</font>

241
00:13:17,649 --> 00:13:22,720
<font color="#E5E5E5">actually a</font><font color="#CCCCCC"> sample application that we</font>

242
00:13:19,540 --> 00:13:25,060
provide<font color="#E5E5E5"> which is actually just receiving</font>

243
00:13:22,720 --> 00:13:27,190
whatever<font color="#E5E5E5"> you're sending towards your</font>

244
00:13:25,060 --> 00:13:29,829
embed device<font color="#E5E5E5"> over</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> page guide</font>

245
00:13:27,190 --> 00:13:35,889
connection and replying to it<font color="#E5E5E5"> by just</font>

246
00:13:29,829 --> 00:13:39,790
sending<font color="#E5E5E5"> it back so here we do a page</font>

247
00:13:35,889 --> 00:13:45,579
guide sense here connection<font color="#E5E5E5"> sense with</font>

248
00:13:39,790 --> 00:13:53,380
just the same data<font color="#E5E5E5"> let's do a demo for</font>

249
00:13:45,579 --> 00:13:59,099
<font color="#CCCCCC">that</font><font color="#E5E5E5"> so maybe we'll have some terminals</font>

250
00:13:53,380 --> 00:14:01,770
here so this is

251
00:13:59,100 --> 00:14:06,900
this is my embed device connected to

252
00:14:01,770 --> 00:14:09,689
<font color="#E5E5E5">over the UART then we have here I'm</font>

253
00:14:06,900 --> 00:14:12,449
going<font color="#E5E5E5"> to set up</font><font color="#CCCCCC"> a local front-end server</font>

254
00:14:09,690 --> 00:14:18,210
<font color="#E5E5E5">on</font><font color="#CCCCCC"> my laptop so my laptop is acting as</font>

255
00:14:12,450 --> 00:14:20,400
both<font color="#E5E5E5"> front</font><font color="#CCCCCC"> and server</font><font color="#E5E5E5"> as a router</font><font color="#CCCCCC"> so my</font>

256
00:14:18,210 --> 00:14:25,130
<font color="#E5E5E5">my device</font><font color="#CCCCCC"> is connected to my laptop and</font>

257
00:14:20,400 --> 00:14:31,410
<font color="#CCCCCC">my</font><font color="#E5E5E5"> laptop is</font><font color="#CCCCCC"> connected to</font><font color="#E5E5E5"> the Wi-Fi here</font>

258
00:14:25,130 --> 00:14:36,420
<font color="#CCCCCC">so I'm going</font><font color="#E5E5E5"> to run my page guide from</font>

259
00:14:31,410 --> 00:14:39,120
<font color="#CCCCCC">tens so now it is running</font><font color="#E5E5E5"> and accepting</font>

260
00:14:36,420 --> 00:14:41,459
connections from<font color="#E5E5E5"> back</font><font color="#CCCCCC"> ends page</font><font color="#E5E5E5"> guide</font>

261
00:14:39,120 --> 00:14:43,430
<font color="#E5E5E5">back ends</font><font color="#CCCCCC"> and also accepting connections</font>

262
00:14:41,460 --> 00:14:48,630
from<font color="#E5E5E5"> clients</font>

263
00:14:43,430 --> 00:14:52,680
so now if<font color="#CCCCCC"> I reboot my Emmitt device it</font>

264
00:14:48,630 --> 00:14:56,670
will start connecting to the front end

265
00:14:52,680 --> 00:14:59,239
server<font color="#CCCCCC"> now it's setting</font><font color="#E5E5E5"> up its network</font>

266
00:14:56,670 --> 00:14:59,240
connection

267
00:15:00,970 --> 00:15:08,410
<font color="#E5E5E5">all right</font><font color="#CCCCCC"> connection success so now</font>

268
00:15:05,000 --> 00:15:11,690
everything is<font color="#CCCCCC"> set up</font><font color="#E5E5E5"> you can see here</font>

269
00:15:08,410 --> 00:15:14,540
there's a device connected<font color="#E5E5E5"> on the front</font>

270
00:15:11,690 --> 00:15:17,870
<font color="#E5E5E5">end a back end device</font><font color="#CCCCCC"> so now we can</font>

271
00:15:14,540 --> 00:15:21,949
<font color="#E5E5E5">start sending over the public network</font><font color="#CCCCCC"> so</font>

272
00:15:17,870 --> 00:15:25,089
everybody who is using<font color="#E5E5E5"> who is connected</font>

273
00:15:21,950 --> 00:15:28,220
<font color="#CCCCCC">to</font><font color="#E5E5E5"> I think I'm connected</font><font color="#CCCCCC"> to the FOSDEM</font>

274
00:15:25,089 --> 00:15:32,440
<font color="#E5E5E5">dual-stack network everybody connected</font>

275
00:15:28,220 --> 00:15:35,570
there can run<font color="#CCCCCC"> this commands</font><font color="#E5E5E5"> in order to</font>

276
00:15:32,440 --> 00:15:37,970
open<font color="#CCCCCC"> a</font><font color="#E5E5E5"> connection to the front end</font>

277
00:15:35,570 --> 00:15:41,420
server that I'm running<font color="#CCCCCC"> now when I'm</font>

278
00:15:37,970 --> 00:15:46,279
<font color="#E5E5E5">sending</font><font color="#CCCCCC"> tests</font><font color="#E5E5E5"> I get a test reply from my</font>

279
00:15:41,420 --> 00:15:51,260
ended device and you see here so what

280
00:15:46,279 --> 00:15:53,959
happens<font color="#E5E5E5"> a new stream with ID</font><font color="#CCCCCC"> 5 opens we</font>

281
00:15:51,260 --> 00:15:57,290
receive<font color="#CCCCCC"> tests</font><font color="#E5E5E5"> from some clients over the</font>

282
00:15:53,959 --> 00:16:00,260
<font color="#CCCCCC">Internet</font><font color="#E5E5E5"> and we apply it and we close</font>

283
00:15:57,290 --> 00:16:05,329
the connection<font color="#E5E5E5"> again so that is what</font>

284
00:16:00,260 --> 00:16:07,750
happens<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> backend side and on the</font>

285
00:16:05,329 --> 00:16:07,750
client<font color="#E5E5E5"> side</font>

286
00:16:08,670 --> 00:16:12,020
back to the presentation

287
00:16:26,529 --> 00:16:32,409
so these are the<font color="#E5E5E5"> links the</font><font color="#CCCCCC"> Emmett</font>

288
00:16:29,649 --> 00:16:36,369
library is located<font color="#CCCCCC"> on our</font><font color="#E5E5E5"> Adsense</font><font color="#CCCCCC"> iam</font>

289
00:16:32,409 --> 00:16:39,069
<font color="#CCCCCC">Minds</font><font color="#E5E5E5"> public git repository so anybody</font>

290
00:16:36,369 --> 00:16:41,709
can<font color="#CCCCCC"> access it it's it's an MIT license</font>

291
00:16:39,069 --> 00:16:45,399
<font color="#E5E5E5">there's of course getting started in the</font>

292
00:16:41,709 --> 00:16:48,279
<font color="#E5E5E5">readme</font><font color="#CCCCCC"> and we also</font><font color="#E5E5E5"> provide an example</font>

293
00:16:45,399 --> 00:16:51,729
<font color="#E5E5E5">application the one that you</font><font color="#CCCCCC"> just saw we</font>

294
00:16:48,279 --> 00:16:57,159
just<font color="#E5E5E5"> does an echo</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the communication</font>

295
00:16:51,729 --> 00:16:58,959
that<font color="#CCCCCC"> you do</font><font color="#E5E5E5"> towards</font><font color="#CCCCCC"> the front end</font><font color="#E5E5E5"> so I</font>

296
00:16:57,159 --> 00:17:03,069
still have<font color="#CCCCCC"> some time left</font><font color="#E5E5E5"> for some</font>

297
00:16:58,959 --> 00:17:13,269
questions<font color="#CCCCCC"> anybody has some questions</font>

298
00:17:03,069 --> 00:17:15,398
<font color="#CCCCCC">about this yes currently owned by a</font>

299
00:17:13,269 --> 00:17:16,689
<font color="#E5E5E5">repeated question for you I'm going to</font>

300
00:17:15,398 --> 00:17:19,479
repeat<font color="#E5E5E5"> your question how</font><font color="#CCCCCC"> many</font>

301
00:17:16,689 --> 00:17:21,819
connections can we<font color="#E5E5E5"> support at the same</font>

302
00:17:19,480 --> 00:17:23,769
time<font color="#CCCCCC"> currently it's</font><font color="#E5E5E5"> only one so</font>

303
00:17:21,819 --> 00:17:24,938
currently we're only<font color="#E5E5E5"> limited to one</font>

304
00:17:23,769 --> 00:17:27,509
<font color="#CCCCCC">connection</font>

305
00:17:24,939 --> 00:17:31,539
we still need to<font color="#E5E5E5"> implement some</font><font color="#CCCCCC"> sort of</font>

306
00:17:27,509 --> 00:17:33,369
parallelism<font color="#CCCCCC"> to do it except</font><font color="#E5E5E5"> multiple</font>

307
00:17:31,539 --> 00:17:36,000
connections at the<font color="#E5E5E5"> same time yeah that's</font>

308
00:17:33,369 --> 00:17:36,000
a<font color="#E5E5E5"> limitation</font>

309
00:17:46,570 --> 00:17:55,700
so this one<font color="#E5E5E5"> okay maybe that's a more</font>

310
00:17:52,280 --> 00:18:06,139
<font color="#CCCCCC">interesting</font><font color="#E5E5E5"> flight and the last one</font>

311
00:17:55,700 --> 00:18:08,720
other questions<font color="#E5E5E5"> yes really practical and</font>

312
00:18:06,140 --> 00:18:11,920
<font color="#CCCCCC">really secure you have to distribute</font><font color="#E5E5E5"> it</font>

313
00:18:08,720 --> 00:18:15,620
between the front end<font color="#CCCCCC"> and the back end</font>

314
00:18:11,920 --> 00:18:17,720
that's a good question actually<font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't</font>

315
00:18:15,620 --> 00:18:19,879
know<font color="#CCCCCC"> how our clients</font><font color="#E5E5E5"> usually does this</font>

316
00:18:17,720 --> 00:18:22,780
because<font color="#E5E5E5"> our client is</font><font color="#CCCCCC"> using pagekite for</font>

317
00:18:19,880 --> 00:18:22,780
many purposes

318
00:18:22,990 --> 00:18:29,090
sorry<font color="#CCCCCC"> so the question was we have a</font>

319
00:18:26,960 --> 00:18:31,490
shared secret<font color="#E5E5E5"> between a</font><font color="#CCCCCC"> back-end</font><font color="#E5E5E5"> device</font>

320
00:18:29,090 --> 00:18:34,159
and a front-end server<font color="#E5E5E5"> how do you</font>

321
00:18:31,490 --> 00:18:38,300
distribute<font color="#E5E5E5"> that shared secret across</font>

322
00:18:34,160 --> 00:18:41,270
your devices and your servers that's<font color="#E5E5E5"> a</font>

323
00:18:38,300 --> 00:18:43,669
very<font color="#E5E5E5"> good question actually</font><font color="#CCCCCC"> I don't know</font>

324
00:18:41,270 --> 00:18:46,310
how our<font color="#E5E5E5"> client is doing it at the sir at</font>

325
00:18:43,670 --> 00:18:49,580
this moment<font color="#E5E5E5"> because he's using page</font>

326
00:18:46,310 --> 00:18:51,830
guides for<font color="#CCCCCC"> different purposes</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> he's</font>

327
00:18:49,580 --> 00:18:56,800
using page guy to connect to a web

328
00:18:51,830 --> 00:18:59,210
server running<font color="#E5E5E5"> on another</font><font color="#CCCCCC"> local device</font>

329
00:18:56,800 --> 00:19:01,970
<font color="#E5E5E5">actually I</font><font color="#CCCCCC"> don't have a good answer</font><font color="#E5E5E5"> for</font>

330
00:18:59,210 --> 00:19:06,020
<font color="#E5E5E5">that yet</font><font color="#CCCCCC"> you know it's of course</font>

331
00:19:01,970 --> 00:19:07,850
<font color="#CCCCCC">hard-coded in the software but yeah</font>

332
00:19:06,020 --> 00:19:10,120
maybe there's<font color="#E5E5E5"> better options to do this</font>

333
00:19:07,850 --> 00:19:10,120
<font color="#CCCCCC">step</font>

334
00:19:16,769 --> 00:19:23,399
<font color="#CCCCCC">sites of the connection because then</font>

335
00:19:19,739 --> 00:19:26,249
anyone could yeah<font color="#CCCCCC"> so why are we</font><font color="#E5E5E5"> using a</font>

336
00:19:23,399 --> 00:19:30,139
shared<font color="#E5E5E5"> secret</font><font color="#CCCCCC"> between the</font><font color="#E5E5E5"> server and the</font>

337
00:19:26,249 --> 00:19:33,149
<font color="#CCCCCC">backends we do that because</font><font color="#E5E5E5"> otherwise</font>

338
00:19:30,139 --> 00:19:36,928
<font color="#E5E5E5">anyone could connect towards</font><font color="#CCCCCC"> your</font>

339
00:19:33,149 --> 00:19:38,998
<font color="#CCCCCC">pagekite front-end server and use it as</font>

340
00:19:36,929 --> 00:19:41,609
a<font color="#CCCCCC"> front-end</font><font color="#E5E5E5"> for its own purposes so you</font>

341
00:19:38,999 --> 00:19:45,320
need some<font color="#E5E5E5"> sort of secret shared secret</font>

342
00:19:41,609 --> 00:19:48,178
<font color="#E5E5E5">in order</font><font color="#CCCCCC"> to do the handshaking</font><font color="#E5E5E5"> with</font>

343
00:19:45,320 --> 00:19:50,129
<font color="#CCCCCC">trusted devices</font><font color="#E5E5E5"> of course so that</font><font color="#CCCCCC"> only</font>

344
00:19:48,179 --> 00:19:56,309
your<font color="#E5E5E5"> back-end devices can connect to</font>

345
00:19:50,129 --> 00:20:00,539
your<font color="#E5E5E5"> front-end server yes you can do</font>

346
00:19:56,309 --> 00:20:04,918
<font color="#E5E5E5">that as well yeah but TLS is not needed</font>

347
00:20:00,539 --> 00:20:07,229
<font color="#E5E5E5">in most cases you can also do an</font>

348
00:20:04,919 --> 00:20:09,450
unencrypted<font color="#E5E5E5"> and unequipped</font><font color="#CCCCCC"> it connection</font>

349
00:20:07,229 --> 00:20:17,299
and then of<font color="#CCCCCC"> course is better to have a</font>

350
00:20:09,450 --> 00:20:17,299
shared secret other questions

351
00:20:19,279 --> 00:20:30,869
<font color="#E5E5E5">okay thank you very much</font>

352
00:20:21,940 --> 00:20:30,869
[Applause]

