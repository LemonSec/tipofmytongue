1
00:00:10,460 --> 00:00:16,320
so<font color="#CCCCCC"> welcome everyone thanks</font><font color="#E5E5E5"> for being</font>

2
00:00:13,320 --> 00:00:20,279
<font color="#E5E5E5">here</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> at lunchtime</font><font color="#CCCCCC"> I hope to not</font>

3
00:00:16,320 --> 00:00:21,660
let you fall asleep<font color="#E5E5E5"> I'm Ricardo</font>

4
00:00:20,279 --> 00:00:25,259
culturally I'm a site reliability

5
00:00:21,660 --> 00:00:26,790
engineer<font color="#E5E5E5"> that try to keeps Wikipedia</font>

6
00:00:25,259 --> 00:00:28,860
running I work at<font color="#CCCCCC"> the Wikimedia</font>

7
00:00:26,790 --> 00:00:30,950
Foundation that is the<font color="#E5E5E5"> nonprofit</font>

8
00:00:28,860 --> 00:00:33,870
organization<font color="#CCCCCC"> that basically is behind</font>

9
00:00:30,950 --> 00:00:37,829
<font color="#E5E5E5">Wikipedia and all its sister project but</font>

10
00:00:33,870 --> 00:00:40,769
that's enough about me<font color="#CCCCCC"> today</font><font color="#E5E5E5"> we will be</font>

11
00:00:37,829 --> 00:00:42,410
talking about<font color="#CCCCCC"> human automation okay</font>

12
00:00:40,770 --> 00:00:47,670
<font color="#E5E5E5">station made possible</font>

13
00:00:42,410 --> 00:00:50,069
let's see<font color="#CCCCCC"> human is a Python framework</font>

14
00:00:47,670 --> 00:00:51,660
and<font color="#E5E5E5"> command-line interface that</font>

15
00:00:50,070 --> 00:00:53,700
integrates<font color="#E5E5E5"> with existing infrastructure</font>

16
00:00:51,660 --> 00:00:56,669
that<font color="#E5E5E5"> allows you to execute multiple</font>

17
00:00:53,700 --> 00:00:59,700
commands in parallel on<font color="#E5E5E5"> a selected</font>

18
00:00:56,670 --> 00:01:01,559
number<font color="#CCCCCC"> of</font><font color="#E5E5E5"> hosts and automation isn't</font>

19
00:00:59,700 --> 00:01:02,940
easy but we<font color="#E5E5E5"> are trying to make it</font>

20
00:01:01,559 --> 00:01:05,850
possible

21
00:01:02,940 --> 00:01:07,890
it's a<font color="#CCCCCC"> queue basically allows and</font>

22
00:01:05,850 --> 00:01:11,339
provides you a flexible<font color="#E5E5E5"> reliable and</font>

23
00:01:07,890 --> 00:01:13,890
scalable way to<font color="#E5E5E5"> execute whatever</font>

24
00:01:11,340 --> 00:01:15,900
<font color="#CCCCCC">commands</font><font color="#E5E5E5"> you need</font><font color="#CCCCCC"> to run on multiple</font>

25
00:01:13,890 --> 00:01:18,900
laws and these laws will<font color="#E5E5E5"> be dynamically</font>

26
00:01:15,900 --> 00:01:21,479
selected based on<font color="#E5E5E5"> your needs</font><font color="#CCCCCC"> it will</font>

27
00:01:18,900 --> 00:01:23,220
<font color="#E5E5E5">allow to find</font><font color="#CCCCCC"> game</font><font color="#E5E5E5"> selection selecting</font>

28
00:01:21,479 --> 00:01:25,440
your<font color="#E5E5E5"> host that is something that it's</font>

29
00:01:23,220 --> 00:01:28,020
usually<font color="#E5E5E5"> not possible with with other</font>

30
00:01:25,440 --> 00:01:31,110
solutions<font color="#CCCCCC"> so let's see what what we will</font>

31
00:01:28,020 --> 00:01:34,740
cover today<font color="#E5E5E5"> first we will see</font><font color="#CCCCCC"> what</font>

32
00:01:31,110 --> 00:01:36,180
problems<font color="#E5E5E5"> coming inside</font><font color="#CCCCCC"> to solve then we</font>

33
00:01:34,740 --> 00:01:39,419
will go over<font color="#E5E5E5"> what are the main</font>

34
00:01:36,180 --> 00:01:41,520
components that that are part of cumin

35
00:01:39,420 --> 00:01:43,890
so basically the<font color="#CCCCCC"> backends that allow you</font>

36
00:01:41,520 --> 00:01:46,080
<font color="#E5E5E5">to select us from different</font><font color="#CCCCCC"> sorts of</font>

37
00:01:43,890 --> 00:01:48,090
<font color="#CCCCCC">toads</font><font color="#E5E5E5"> a grandma that</font><font color="#CCCCCC"> allow</font><font color="#E5E5E5"> you to</font>

38
00:01:46,080 --> 00:01:49,890
<font color="#CCCCCC">combine those results</font><font color="#E5E5E5"> and then the</font>

39
00:01:48,090 --> 00:01:51,689
<font color="#E5E5E5">transport that</font><font color="#CCCCCC"> is basically what will be</font>

40
00:01:49,890 --> 00:01:53,759
used<font color="#E5E5E5"> to</font><font color="#CCCCCC"> execute the</font><font color="#E5E5E5"> commands on the</font>

41
00:01:51,689 --> 00:01:55,889
<font color="#E5E5E5">target host and then we will go over</font>

42
00:01:53,759 --> 00:01:57,930
<font color="#CCCCCC">what are the execution strategies</font>

43
00:01:55,890 --> 00:02:00,090
another feature of<font color="#E5E5E5"> human that allow</font>

44
00:01:57,930 --> 00:02:03,090
<font color="#CCCCCC">basically to adapt to</font><font color="#E5E5E5"> most use cases and</font>

45
00:02:00,090 --> 00:02:05,400
it's one of<font color="#CCCCCC"> the main reason that we we</font>

46
00:02:03,090 --> 00:02:07,950
started writing this tool and then we

47
00:02:05,400 --> 00:02:13,799
will go<font color="#CCCCCC"> over a quick demo to show</font><font color="#E5E5E5"> you</font>

48
00:02:07,950 --> 00:02:16,040
human in action so first of all how we

49
00:02:13,799 --> 00:02:18,860
got here

50
00:02:16,040 --> 00:02:20,989
I will tell you our<font color="#CCCCCC"> story but this story</font>

51
00:02:18,860 --> 00:02:23,269
is most common and I'm sure you will

52
00:02:20,989 --> 00:02:25,579
<font color="#E5E5E5">would</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> familiar</font><font color="#CCCCCC"> with it so you start</font>

53
00:02:23,269 --> 00:02:28,340
at the start we have just<font color="#CCCCCC"> a few few</font>

54
00:02:25,579 --> 00:02:29,750
servers<font color="#E5E5E5"> to configure if you host and you</font>

55
00:02:28,340 --> 00:02:31,340
start to do<font color="#E5E5E5"> everything manually there is</font>

56
00:02:29,750 --> 00:02:32,780
no need of<font color="#E5E5E5"> information on either vodka</font>

57
00:02:31,340 --> 00:02:34,849
station no need of configuration

58
00:02:32,780 --> 00:02:36,890
management<font color="#E5E5E5"> just because it's too easy</font>

59
00:02:34,849 --> 00:02:40,099
<font color="#E5E5E5">you don't bother about</font><font color="#CCCCCC"> that the</font>

60
00:02:36,890 --> 00:02:41,929
complexity<font color="#E5E5E5"> then you start going and your</font>

61
00:02:40,099 --> 00:02:44,510
number of servers start to<font color="#E5E5E5"> grow and</font><font color="#CCCCCC"> you</font>

62
00:02:41,930 --> 00:02:46,400
start<font color="#E5E5E5"> doing some quick and easy</font>

63
00:02:44,510 --> 00:02:48,980
automation here and there with just some

64
00:02:46,400 --> 00:02:52,280
bash script or<font color="#CCCCCC"> pal</font><font color="#E5E5E5"> script and things</font>

65
00:02:48,980 --> 00:02:55,280
start to to get<font color="#E5E5E5"> better but then you</font>

66
00:02:52,280 --> 00:02:56,720
<font color="#E5E5E5">continue to grow and and what you do you</font>

67
00:02:55,280 --> 00:02:59,510
start<font color="#CCCCCC"> to look into a configuration</font>

68
00:02:56,720 --> 00:03:02,000
<font color="#CCCCCC">management solution and you go</font><font color="#E5E5E5"> over all</font>

69
00:02:59,510 --> 00:03:04,730
<font color="#CCCCCC">of them and pick one in our case puppet</font>

70
00:03:02,000 --> 00:03:09,019
was was selected on on the fall of 2008

71
00:03:04,730 --> 00:03:11,179
<font color="#CCCCCC">and and then we</font><font color="#E5E5E5"> continue to go then we</font>

72
00:03:09,019 --> 00:03:13,430
open a second data center and basically

73
00:03:11,180 --> 00:03:15,349
doublet the number<font color="#CCCCCC"> host</font><font color="#E5E5E5"> at that point</font>

74
00:03:13,430 --> 00:03:17,150
the configuration<font color="#E5E5E5"> management</font><font color="#CCCCCC"> it's still</font>

75
00:03:15,349 --> 00:03:19,209
<font color="#CCCCCC">ok will take care</font><font color="#E5E5E5"> of the configuration</font>

76
00:03:17,150 --> 00:03:22,159
of<font color="#CCCCCC"> your</font><font color="#E5E5E5"> host but it will not be</font><font color="#CCCCCC"> able to</font>

77
00:03:19,209 --> 00:03:24,829
to give you automation orchestration and

78
00:03:22,159 --> 00:03:26,298
more<font color="#CCCCCC"> mas you have and in particular if</font>

79
00:03:24,829 --> 00:03:30,199
you<font color="#CCCCCC"> have them in</font><font color="#E5E5E5"> multiple data centers</font>

80
00:03:26,299 --> 00:03:33,379
<font color="#E5E5E5">that's something very neat and and so we</font>

81
00:03:30,199 --> 00:03:34,849
started<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> for solution of things</font>

82
00:03:33,379 --> 00:03:36,798
that will allow<font color="#CCCCCC"> us to</font><font color="#E5E5E5"> do some</font>

83
00:03:34,849 --> 00:03:39,768
orchestration<font color="#E5E5E5"> and some automation across</font>

84
00:03:36,799 --> 00:03:41,870
the fleet<font color="#E5E5E5"> and in our case</font><font color="#CCCCCC"> we found</font><font color="#E5E5E5"> the</font>

85
00:03:39,769 --> 00:03:44,989
<font color="#E5E5E5">solution it wasn't perfect because we</font>

86
00:03:41,870 --> 00:03:46,579
didn't find anything<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the open source</font>

87
00:03:44,989 --> 00:03:50,060
<font color="#E5E5E5">software</font><font color="#CCCCCC"> that will allow us to</font><font color="#E5E5E5"> do that</font>

88
00:03:46,579 --> 00:03:51,829
but we chosen<font color="#CCCCCC"> one anyway</font><font color="#E5E5E5"> and was solved</font>

89
00:03:50,060 --> 00:03:54,500
<font color="#E5E5E5">not for the configuration</font><font color="#CCCCCC"> management</font>

90
00:03:51,829 --> 00:03:57,019
<font color="#E5E5E5">part because we were already</font><font color="#CCCCCC"> using</font>

91
00:03:54,500 --> 00:03:59,900
puppet but for the disabilities age

92
00:03:57,019 --> 00:04:02,599
basically capability and so we<font color="#E5E5E5"> started</font>

93
00:03:59,900 --> 00:04:04,609
<font color="#CCCCCC">using it but having puppet as a</font>

94
00:04:02,599 --> 00:04:07,280
configuration<font color="#CCCCCC"> management that means that</font>

95
00:04:04,609 --> 00:04:09,889
<font color="#CCCCCC">two you solved for distributed SSH we</font>

96
00:04:07,280 --> 00:04:13,099
had to have puppet configure<font color="#E5E5E5"> soft grains</font>

97
00:04:09,889 --> 00:04:15,409
on<font color="#CCCCCC"> the target host</font><font color="#E5E5E5"> to just have some hot</font>

98
00:04:13,099 --> 00:04:17,750
selection capability but<font color="#E5E5E5"> that was very</font>

99
00:04:15,409 --> 00:04:18,858
<font color="#CCCCCC">limited not incredibly integrated with</font>

100
00:04:17,750 --> 00:04:22,639
puppet in a

101
00:04:18,858 --> 00:04:24,740
<font color="#CCCCCC">in easy way and so it didn't allow us</font><font color="#E5E5E5"> to</font>

102
00:04:22,639 --> 00:04:27,830
do<font color="#E5E5E5"> all the things</font><font color="#CCCCCC"> that we wanted and so</font>

103
00:04:24,740 --> 00:04:31,270
we at<font color="#CCCCCC"> the</font><font color="#E5E5E5"> end we started deciding to</font>

104
00:04:27,830 --> 00:04:34,550
write a new tool<font color="#CCCCCC"> that in was human and</font>

105
00:04:31,270 --> 00:04:35,990
that we<font color="#E5E5E5"> wanted to allow us to</font><font color="#CCCCCC"> do all the</font>

106
00:04:34,550 --> 00:04:39,139
things<font color="#CCCCCC"> that the other tools didn't</font>

107
00:04:35,990 --> 00:04:41,900
didn't didn't allow and so basically

108
00:04:39,139 --> 00:04:43,699
what<font color="#E5E5E5"> we</font><font color="#CCCCCC"> actually wanted</font><font color="#E5E5E5"> so the first</font>

109
00:04:41,900 --> 00:04:46,219
thing<font color="#CCCCCC"> that we wanted was to be able</font><font color="#E5E5E5"> to</font>

110
00:04:43,699 --> 00:04:49,340
target<font color="#CCCCCC"> hosts in a very</font><font color="#E5E5E5"> fine-grain in a</font>

111
00:04:46,219 --> 00:04:51,469
way in a very<font color="#CCCCCC"> dynamic</font><font color="#E5E5E5"> way</font><font color="#CCCCCC"> we didn't want</font>

112
00:04:49,340 --> 00:04:54,560
fixed at least<font color="#CCCCCC"> vast we didn't want</font>

113
00:04:51,469 --> 00:04:56,419
anything the world's<font color="#E5E5E5"> title couplet</font><font color="#CCCCCC"> with</font>

114
00:04:54,560 --> 00:04:58,729
the current status but something<font color="#CCCCCC"> that</font>

115
00:04:56,419 --> 00:05:02,090
was dynamically gathered so in this case

116
00:04:58,729 --> 00:05:04,460
<font color="#E5E5E5">for</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> we will light or - host that</font>

117
00:05:02,090 --> 00:05:07,159
are in<font color="#E5E5E5"> intersection of different of</font>

118
00:05:04,460 --> 00:05:09,830
<font color="#CCCCCC">differently</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> somewhere lost like for</font>

119
00:05:07,159 --> 00:05:12,680
example<font color="#CCCCCC"> Debian stretch</font><font color="#E5E5E5"> hosts that</font><font color="#CCCCCC"> have a</font>

120
00:05:09,830 --> 00:05:15,859
puppy class<font color="#CCCCCC"> nginx with parameter</font><font color="#E5E5E5"> cluster</font>

121
00:05:12,680 --> 00:05:17,870
equal<font color="#E5E5E5"> foo and then maybe that</font><font color="#CCCCCC"> are not</font>

122
00:05:15,860 --> 00:05:19,759
pulled in the cluster foo<font color="#E5E5E5"> or something</font>

123
00:05:17,870 --> 00:05:22,789
like that<font color="#E5E5E5"> so we will be we want to be</font>

124
00:05:19,759 --> 00:05:25,009
able<font color="#E5E5E5"> to address the house for</font><font color="#CCCCCC"> example I</font>

125
00:05:22,789 --> 00:05:28,099
<font color="#CCCCCC">like to</font><font color="#E5E5E5"> do red and blue but maybe not</font>

126
00:05:25,009 --> 00:05:30,740
the one in black<font color="#E5E5E5"> or dynamically change</font>

127
00:05:28,099 --> 00:05:33,680
this selection very quickly<font color="#E5E5E5"> and so one</font>

128
00:05:30,740 --> 00:05:35,990
thing basically<font color="#CCCCCC"> something that was able</font>

129
00:05:33,680 --> 00:05:39,199
<font color="#CCCCCC">to</font><font color="#E5E5E5"> gather dynamic things from different</font>

130
00:05:35,990 --> 00:05:40,669
<font color="#CCCCCC">sources</font><font color="#E5E5E5"> tooth different backhands that</font>

131
00:05:39,199 --> 00:05:42,740
allow to gather<font color="#E5E5E5"> different</font><font color="#CCCCCC"> lists of us</font>

132
00:05:40,669 --> 00:05:44,779
<font color="#CCCCCC">and then mix them</font><font color="#E5E5E5"> and combine them</font>

133
00:05:42,740 --> 00:05:46,819
together with standard boolean<font color="#E5E5E5"> operators</font>

134
00:05:44,779 --> 00:05:49,819
and<font color="#E5E5E5"> parentheses allowing you to write a</font>

135
00:05:46,819 --> 00:05:53,089
simple<font color="#E5E5E5"> query that can mix them in the</font>

136
00:05:49,819 --> 00:05:55,490
way you want in that<font color="#E5E5E5"> moment the other</font>

137
00:05:53,089 --> 00:05:58,610
main feature that<font color="#E5E5E5"> we wanted is basically</font>

138
00:05:55,490 --> 00:06:01,069
how<font color="#CCCCCC"> to execute things sometimes</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> just</font>

139
00:05:58,610 --> 00:06:03,349
are<font color="#E5E5E5"> checking some status</font><font color="#CCCCCC"> on some info or</font>

140
00:06:01,069 --> 00:06:07,310
doing some simple<font color="#CCCCCC"> cleanup you don't need</font>

141
00:06:03,349 --> 00:06:09,349
a very safe<font color="#CCCCCC"> way to do it</font><font color="#E5E5E5"> because those</font>

142
00:06:07,310 --> 00:06:11,659
are safe<font color="#E5E5E5"> command are harmless common</font>

143
00:06:09,349 --> 00:06:12,740
that you want to execute<font color="#E5E5E5"> a closer fit as</font>

144
00:06:11,659 --> 00:06:14,539
quickly as possible

145
00:06:12,740 --> 00:06:16,729
<font color="#CCCCCC">because</font><font color="#E5E5E5"> you are just</font><font color="#CCCCCC"> wrapping something</font>

146
00:06:14,539 --> 00:06:19,430
<font color="#E5E5E5">around the fleet or checking some thatõs</font>

147
00:06:16,729 --> 00:06:21,830
<font color="#E5E5E5">and in this case you</font><font color="#CCCCCC"> just want to</font><font color="#E5E5E5"> run</font>

148
00:06:19,430 --> 00:06:24,319
them and get the output but there are

149
00:06:21,830 --> 00:06:26,359
<font color="#E5E5E5">cases you want to do more delicate stuff</font>

150
00:06:24,319 --> 00:06:28,069
for<font color="#E5E5E5"> example you want</font><font color="#CCCCCC"> to the pull some</font>

151
00:06:26,360 --> 00:06:30,620
<font color="#CCCCCC">cause from the cluster we're</font><font color="#E5E5E5"> start</font><font color="#CCCCCC"> to</font>

152
00:06:28,069 --> 00:06:32,389
<font color="#E5E5E5">service and pull it back and</font><font color="#CCCCCC"> you know</font>

153
00:06:30,620 --> 00:06:34,460
that you can do<font color="#E5E5E5"> that not everyone at the</font>

154
00:06:32,389 --> 00:06:37,219
same time of course<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> want to do</font>

155
00:06:34,460 --> 00:06:38,508
<font color="#E5E5E5">just</font><font color="#CCCCCC"> few</font><font color="#E5E5E5"> of the</font><font color="#CCCCCC"> dive</font><font color="#E5E5E5"> and then go on on</font>

156
00:06:37,219 --> 00:06:41,509
<font color="#E5E5E5">the next one so you want some back</font>

157
00:06:38,509 --> 00:06:43,879
matching capabilities but you also want

158
00:06:41,509 --> 00:06:46,400
<font color="#CCCCCC">control over them because</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> you're on</font>

159
00:06:43,879 --> 00:06:49,550
some<font color="#E5E5E5"> matching things across a whole</font>

160
00:06:46,400 --> 00:06:52,340
fleet<font color="#CCCCCC"> you don't want just to to play go</font>

161
00:06:49,550 --> 00:06:54,080
<font color="#CCCCCC">to say go and</font><font color="#E5E5E5"> then</font><font color="#CCCCCC"> forget you want to</font>

162
00:06:52,340 --> 00:06:56,479
check<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the status is okay at all</font>

163
00:06:54,080 --> 00:06:58,669
<font color="#E5E5E5">time and so you want to be able to stop</font>

164
00:06:56,479 --> 00:07:00,680
so basically wanted something that<font color="#E5E5E5"> could</font>

165
00:06:58,669 --> 00:07:03,409
<font color="#CCCCCC">do batching but then</font><font color="#E5E5E5"> stopping in the</font>

166
00:07:00,680 --> 00:07:05,960
middle<font color="#E5E5E5"> if at any point some success</font>

167
00:07:03,409 --> 00:07:09,438
percentage was not met<font color="#E5E5E5"> some success</font>

168
00:07:05,960 --> 00:07:11,568
criteria was not met<font color="#E5E5E5"> so this was</font><font color="#CCCCCC"> they</font>

169
00:07:09,439 --> 00:07:14,050
<font color="#E5E5E5">where the two main feature that we</font>

170
00:07:11,569 --> 00:07:18,050
<font color="#CCCCCC">actually we actually</font><font color="#E5E5E5"> wanted</font><font color="#CCCCCC"> inter-human</font>

171
00:07:14,050 --> 00:07:20,840
so let's see<font color="#E5E5E5"> for a moment</font><font color="#CCCCCC"> how we</font>

172
00:07:18,050 --> 00:07:23,360
<font color="#CCCCCC">structured cumin basically what our what</font>

173
00:07:20,840 --> 00:07:25,159
<font color="#CCCCCC">I its main</font><font color="#E5E5E5"> components so we</font><font color="#CCCCCC"> have a</font>

174
00:07:23,360 --> 00:07:27,620
<font color="#E5E5E5">global glamour that is the one that</font>

175
00:07:25,159 --> 00:07:29,990
allow us<font color="#CCCCCC"> to combine results from</font>

176
00:07:27,620 --> 00:07:32,150
<font color="#CCCCCC">different backends</font><font color="#E5E5E5"> and from one side</font>

177
00:07:29,990 --> 00:07:36,710
<font color="#E5E5E5">where the back ends</font><font color="#CCCCCC"> and now we already</font>

178
00:07:32,150 --> 00:07:39,469
have a<font color="#CCCCCC"> PDB</font><font color="#E5E5E5"> OpenStack API</font><font color="#CCCCCC"> Association on</font>

179
00:07:36,710 --> 00:07:42,620
us and others that<font color="#CCCCCC"> are</font><font color="#E5E5E5"> coming and we</font><font color="#CCCCCC"> are</font>

180
00:07:39,469 --> 00:07:44,719
<font color="#CCCCCC">riding but</font><font color="#E5E5E5"> also is possible to plug in</font>

181
00:07:42,620 --> 00:07:47,029
external<font color="#E5E5E5"> of the cans that you ride you</font>

182
00:07:44,719 --> 00:07:49,250
<font color="#CCCCCC">just</font><font color="#E5E5E5"> write a single class in Python and</font>

183
00:07:47,029 --> 00:07:53,060
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can plug in whatever back-end</font><font color="#E5E5E5"> that</font>

184
00:07:49,250 --> 00:07:54,589
is not yet part<font color="#E5E5E5"> of</font><font color="#CCCCCC"> queue itself and and</font>

185
00:07:53,060 --> 00:07:56,479
you can combine<font color="#E5E5E5"> yourselves from all of</font>

186
00:07:54,589 --> 00:07:58,370
them<font color="#E5E5E5"> and it's very easy to write to</font>

187
00:07:56,479 --> 00:08:00,770
<font color="#E5E5E5">write a new back-end I mean it's it's</font>

188
00:07:58,370 --> 00:08:02,960
<font color="#CCCCCC">just one file very very easy depends</font><font color="#E5E5E5"> on</font>

189
00:08:00,770 --> 00:08:05,568
your OPI of course but in general<font color="#CCCCCC"> it's</font>

190
00:08:02,960 --> 00:08:09,020
<font color="#E5E5E5">very easy and then given the global</font>

191
00:08:05,569 --> 00:08:11,120
<font color="#E5E5E5">grammar that is basically simply having</font>

192
00:08:09,020 --> 00:08:14,299
<font color="#CCCCCC">parenthesis boolean operator</font><font color="#E5E5E5"> and be able</font>

193
00:08:11,120 --> 00:08:16,759
<font color="#CCCCCC">to combine results of all of</font><font color="#E5E5E5"> them</font><font color="#CCCCCC"> you</font>

194
00:08:14,300 --> 00:08:19,580
can<font color="#CCCCCC"> select things</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> different source</font>

195
00:08:16,759 --> 00:08:24,050
of truth from your cluster management

196
00:08:19,580 --> 00:08:26,508
from your inventory<font color="#E5E5E5"> whatever you you</font>

197
00:08:24,050 --> 00:08:29,509
have and you<font color="#E5E5E5"> want to combine and then</font>

198
00:08:26,509 --> 00:08:31,849
use human just execute the<font color="#CCCCCC"> commands</font><font color="#E5E5E5"> on</font>

199
00:08:29,509 --> 00:08:33,190
the<font color="#CCCCCC"> on the resulting</font><font color="#E5E5E5"> subset of us and</font>

200
00:08:31,849 --> 00:08:34,689
the<font color="#E5E5E5"> transport</font>

201
00:08:33,190 --> 00:08:37,330
is that the one that<font color="#E5E5E5"> allow you to</font>

202
00:08:34,690 --> 00:08:41,590
execute things over the host<font color="#E5E5E5"> so right</font>

203
00:08:37,330 --> 00:08:44,440
now we just<font color="#E5E5E5"> implemented SSH we chose as</font>

204
00:08:41,590 --> 00:08:48,340
a sage<font color="#E5E5E5"> for two main reasons</font>

205
00:08:44,440 --> 00:08:50,620
in implied security super<font color="#E5E5E5"> simple it</font>

206
00:08:48,340 --> 00:08:52,960
doesn't require any<font color="#E5E5E5"> dependency on the</font>

207
00:08:50,620 --> 00:08:54,850
<font color="#CCCCCC">target host</font><font color="#E5E5E5"> so the only thing</font><font color="#CCCCCC"> that you</font>

208
00:08:52,960 --> 00:08:56,650
need<font color="#E5E5E5"> is a house with</font><font color="#CCCCCC"> cumin master and</font>

209
00:08:54,850 --> 00:08:59,920
you don't need anything else<font color="#E5E5E5"> on the</font>

210
00:08:56,650 --> 00:09:02,230
target<font color="#CCCCCC"> O's</font><font color="#E5E5E5"> just as an</font><font color="#CCCCCC"> SSH server and the</font>

211
00:08:59,920 --> 00:09:04,930
capability from<font color="#E5E5E5"> the to connect</font><font color="#CCCCCC"> from the</font>

212
00:09:02,230 --> 00:09:06,970
command master<font color="#E5E5E5"> but we are thinking</font><font color="#CCCCCC"> of</font>

213
00:09:04,930 --> 00:09:09,640
adding<font color="#E5E5E5"> additional transport layers in</font>

214
00:09:06,970 --> 00:09:14,290
particular we are<font color="#E5E5E5"> looking for HTTP HTTPS</font>

215
00:09:09,640 --> 00:09:15,939
for<font color="#E5E5E5"> restful api that might need to for</font>

216
00:09:14,290 --> 00:09:17,910
example<font color="#CCCCCC"> I don't know you have an</font><font color="#E5E5E5"> elastic</font>

217
00:09:15,940 --> 00:09:20,500
search cluster you want to connect to

218
00:09:17,910 --> 00:09:22,900
multiple<font color="#E5E5E5"> elastic search cluster you want</font>

219
00:09:20,500 --> 00:09:25,750
to connect to<font color="#E5E5E5"> the API or for example</font><font color="#CCCCCC"> we</font>

220
00:09:22,900 --> 00:09:27,880
are<font color="#CCCCCC"> looking to do mice QL transport to</font>

221
00:09:25,750 --> 00:09:31,060
connect to<font color="#CCCCCC"> to</font><font color="#E5E5E5"> to cluster of MySQL</font>

222
00:09:27,880 --> 00:09:33,189
servers so those are things<font color="#E5E5E5"> that</font><font color="#CCCCCC"> that</font>

223
00:09:31,060 --> 00:09:38,560
will come probably in the<font color="#E5E5E5"> next future of</font>

224
00:09:33,190 --> 00:09:40,060
cumin<font color="#CCCCCC"> let's check also</font><font color="#E5E5E5"> what are other</font>

225
00:09:38,560 --> 00:09:44,859
common feature that we took<font color="#E5E5E5"> into account</font>

226
00:09:40,060 --> 00:09:47,319
and<font color="#CCCCCC"> we are</font><font color="#E5E5E5"> fundamentally in in there in</font>

227
00:09:44,860 --> 00:09:49,180
its in<font color="#E5E5E5"> its capabilities so the execution</font>

228
00:09:47,320 --> 00:09:51,100
strategies are<font color="#CCCCCC"> the thing that I show you</font>

229
00:09:49,180 --> 00:09:55,660
before and I<font color="#CCCCCC"> will go a</font><font color="#E5E5E5"> little bit more</font>

230
00:09:51,100 --> 00:09:58,090
<font color="#CCCCCC">in detail now so</font><font color="#E5E5E5"> basically we wanted the</font>

231
00:09:55,660 --> 00:10:00,550
<font color="#CCCCCC">bread sites so we have you can select</font>

232
00:09:58,090 --> 00:10:04,300
batch size and you<font color="#E5E5E5"> can select</font><font color="#CCCCCC"> back a</font>

233
00:10:00,550 --> 00:10:06,579
batch sleep<font color="#CCCCCC"> batches</font><font color="#E5E5E5"> are implemented as a</font>

234
00:10:04,300 --> 00:10:08,620
sliding window<font color="#E5E5E5"> so if you start with</font>

235
00:10:06,580 --> 00:10:10,360
batch<font color="#E5E5E5"> 10 you will start with 10 hosts</font>

236
00:10:08,620 --> 00:10:13,810
and then<font color="#E5E5E5"> as soon as one else will finish</font>

237
00:10:10,360 --> 00:10:15,310
you will start scheduling the execution

238
00:10:13,810 --> 00:10:18,010
<font color="#E5E5E5">of the comments on the next host and</font>

239
00:10:15,310 --> 00:10:20,229
going on but you can select<font color="#CCCCCC"> also</font><font color="#E5E5E5"> much</font>

240
00:10:18,010 --> 00:10:21,939
sleep between house so basically before

241
00:10:20,230 --> 00:10:25,060
scheduling<font color="#E5E5E5"> the next</font><font color="#CCCCCC"> house they</font><font color="#E5E5E5"> will</font>

242
00:10:21,940 --> 00:10:26,560
sleep for such amount of time this allow

243
00:10:25,060 --> 00:10:28,869
for<font color="#E5E5E5"> example of doing things completely</font>

244
00:10:26,560 --> 00:10:30,579
sequentially<font color="#CCCCCC"> you can do one off at the</font>

245
00:10:28,870 --> 00:10:31,950
<font color="#E5E5E5">time wait five minutes sleep in the</font>

246
00:10:30,580 --> 00:10:35,040
middle<font color="#CCCCCC"> and do a very</font>

247
00:10:31,950 --> 00:10:38,280
<font color="#E5E5E5">earning a start of your whole fleet for</font>

248
00:10:35,040 --> 00:10:40,740
example at<font color="#E5E5E5"> this a time when use batch</font>

249
00:10:38,280 --> 00:10:44,130
you can<font color="#E5E5E5"> have the concept of success</font>

250
00:10:40,740 --> 00:10:47,190
percentage or<font color="#CCCCCC"> success ratio basically</font>

251
00:10:44,130 --> 00:10:50,280
<font color="#CCCCCC">what that means</font><font color="#E5E5E5"> is that for each batch</font>

252
00:10:47,190 --> 00:10:52,680
<font color="#E5E5E5">you will at the</font><font color="#CCCCCC"> end</font><font color="#E5E5E5"> whenever asked</font>

253
00:10:50,280 --> 00:10:54,630
completes the execution<font color="#CCCCCC"> of a command it</font>

254
00:10:52,680 --> 00:10:56,520
<font color="#E5E5E5">will calculate the success percentage of</font>

255
00:10:54,630 --> 00:10:58,890
all they also<font color="#E5E5E5"> that have executed already</font>

256
00:10:56,520 --> 00:11:01,530
a common<font color="#CCCCCC"> and if that percentage is over</font>

257
00:10:58,890 --> 00:11:03,390
your threshold<font color="#E5E5E5"> then you will go and</font>

258
00:11:01,530 --> 00:11:05,250
execute<font color="#E5E5E5"> and schedule the next sauce</font>

259
00:11:03,390 --> 00:11:08,819
otherwise<font color="#E5E5E5"> you will stop because it says</font>

260
00:11:05,250 --> 00:11:10,590
<font color="#CCCCCC">that he considered that</font><font color="#E5E5E5"> a failure so you</font>

261
00:11:08,820 --> 00:11:13,170
can<font color="#CCCCCC"> by define it by</font><font color="#E5E5E5"> the way by default</font>

262
00:11:10,590 --> 00:11:15,450
<font color="#CCCCCC">he has a</font><font color="#E5E5E5"> hundred percent success ratio</font>

263
00:11:13,170 --> 00:11:17,939
<font color="#E5E5E5">that means that at the first fold it</font>

264
00:11:15,450 --> 00:11:21,660
will stop by at the first failure sorry

265
00:11:17,940 --> 00:11:24,570
<font color="#E5E5E5">but you can change</font><font color="#CCCCCC"> that and decide what</font>

266
00:11:21,660 --> 00:11:29,219
is your use as a success acceptable

267
00:11:24,570 --> 00:11:31,380
ratio by default<font color="#CCCCCC"> you may</font><font color="#E5E5E5"> consider having</font>

268
00:11:29,220 --> 00:11:33,510
<font color="#CCCCCC">executed common that exit with a</font>

269
00:11:31,380 --> 00:11:37,200
different from zero exit status as a

270
00:11:33,510 --> 00:11:40,650
failure<font color="#E5E5E5"> but you can of</font><font color="#CCCCCC"> course change</font>

271
00:11:37,200 --> 00:11:42,780
that<font color="#E5E5E5"> we</font><font color="#CCCCCC"> are in a common line option or</font>

272
00:11:40,650 --> 00:11:44,880
if you are using it as a library<font color="#E5E5E5"> item</font>

273
00:11:42,780 --> 00:11:47,180
<font color="#E5E5E5">you can define the whole list of</font>

274
00:11:44,880 --> 00:11:51,030
acceptable exit codes that you consider

275
00:11:47,180 --> 00:11:52,949
successful in<font color="#CCCCCC"> that for example</font><font color="#E5E5E5"> in our</font>

276
00:11:51,030 --> 00:11:55,380
case is<font color="#E5E5E5"> very useful with puppet that</font>

277
00:11:52,950 --> 00:11:58,410
usually actually has<font color="#CCCCCC"> different exit code</font>

278
00:11:55,380 --> 00:12:02,790
even<font color="#CCCCCC"> if</font><font color="#E5E5E5"> they are successful but in test</font>

279
00:11:58,410 --> 00:12:04,650
mode has a different exit code the other

280
00:12:02,790 --> 00:12:05,459
<font color="#CCCCCC">thing that you can you can do our</font>

281
00:12:04,650 --> 00:12:07,079
<font color="#E5E5E5">timeouts</font>

282
00:12:05,460 --> 00:12:09,120
so basically a pair host timeout so

283
00:12:07,080 --> 00:12:11,430
every<font color="#CCCCCC"> common</font><font color="#E5E5E5"> that is executed in each</font>

284
00:12:09,120 --> 00:12:13,170
host<font color="#E5E5E5"> you can set the timeout or you can</font>

285
00:12:11,430 --> 00:12:16,469
set a global timeout of<font color="#E5E5E5"> the whole</font>

286
00:12:13,170 --> 00:12:19,530
execution<font color="#CCCCCC"> okay given what what are</font><font color="#E5E5E5"> your</font>

287
00:12:16,470 --> 00:12:22,110
needs basically are<font color="#E5E5E5"> the small features</font>

288
00:12:19,530 --> 00:12:23,790
are for<font color="#E5E5E5"> example interactive mode that</font>

289
00:12:22,110 --> 00:12:25,980
basically when you rank<font color="#E5E5E5"> you mean at the</font>

290
00:12:23,790 --> 00:12:27,930
<font color="#E5E5E5">end will you run normally but in the end</font>

291
00:12:25,980 --> 00:12:30,420
<font color="#E5E5E5">instead of just exiting you will drop</font>

292
00:12:27,930 --> 00:12:32,040
you into Python shell in which<font color="#E5E5E5"> they are</font>

293
00:12:30,420 --> 00:12:35,250
already<font color="#E5E5E5"> pre-loaded the result</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> you</font>

294
00:12:32,040 --> 00:12:37,519
<font color="#E5E5E5">can handle the</font><font color="#CCCCCC"> results</font><font color="#E5E5E5"> directly</font>

295
00:12:35,250 --> 00:12:40,889
in a<font color="#E5E5E5"> Python shell and that's pretty</font>

296
00:12:37,519 --> 00:12:44,069
useful<font color="#E5E5E5"> in some cases and the other one</font>

297
00:12:40,889 --> 00:12:46,139
are<font color="#CCCCCC"> different</font><font color="#E5E5E5"> output formats</font><font color="#CCCCCC"> so by</font>

298
00:12:44,069 --> 00:12:48,389
<font color="#CCCCCC">default it just brings the output but</font>

299
00:12:46,139 --> 00:12:50,779
you can select a JSON or<font color="#E5E5E5"> text</font>

300
00:12:48,389 --> 00:12:52,500
<font color="#E5E5E5">environment in which they will be</font>

301
00:12:50,779 --> 00:12:54,600
printed in an easy<font color="#E5E5E5"> way for</font>

302
00:12:52,500 --> 00:12:57,149
post-processing<font color="#E5E5E5"> in a different with</font>

303
00:12:54,600 --> 00:12:59,509
different<font color="#CCCCCC"> tools basically</font><font color="#E5E5E5"> and the other</font>

304
00:12:57,149 --> 00:13:02,040
feature coming<font color="#E5E5E5"> that is inherited from</font>

305
00:12:59,509 --> 00:13:04,709
from the library<font color="#E5E5E5"> that we choose</font><font color="#CCCCCC"> to do</font>

306
00:13:02,040 --> 00:13:07,230
SSH that is cluster shell that is<font color="#CCCCCC"> a very</font>

307
00:13:04,709 --> 00:13:11,430
powerful Python library that<font color="#E5E5E5"> comes from</font>

308
00:13:07,230 --> 00:13:13,800
the HPC world and it's<font color="#E5E5E5"> to a great result</font>

309
00:13:11,430 --> 00:13:15,930
so basically when<font color="#CCCCCC"> you're onyx same</font>

310
00:13:13,800 --> 00:13:17,399
common across the whole fleet if they

311
00:13:15,930 --> 00:13:19,019
have the same out<font color="#CCCCCC"> will all the hosts</font>

312
00:13:17,399 --> 00:13:21,180
<font color="#E5E5E5">that have the same output are grouped</font>

313
00:13:19,019 --> 00:13:23,129
together<font color="#E5E5E5"> and you will just see one line</font>

314
00:13:21,180 --> 00:13:25,439
with<font color="#E5E5E5"> lists of us that match and the</font>

315
00:13:23,129 --> 00:13:27,089
output so if you're running<font color="#CCCCCC"> this over a</font>

316
00:13:25,439 --> 00:13:29,730
<font color="#CCCCCC">hundred</font><font color="#E5E5E5"> or lost you don't have a very</font>

317
00:13:27,089 --> 00:13:31,920
long output but it's much more<font color="#CCCCCC"> compact</font>

318
00:13:29,730 --> 00:13:33,990
and very useful<font color="#E5E5E5"> for checking</font><font color="#CCCCCC"> things and</font>

319
00:13:31,920 --> 00:13:36,959
and<font color="#E5E5E5"> immediately understand how many</font>

320
00:13:33,990 --> 00:13:38,699
hosts have that output<font color="#CCCCCC"> and how many</font>

321
00:13:36,959 --> 00:13:45,239
hosts and which one<font color="#CCCCCC"> has a</font><font color="#E5E5E5"> different</font>

322
00:13:38,699 --> 00:13:49,949
output so let's see<font color="#E5E5E5"> for a</font><font color="#CCCCCC"> moment a quick</font>

323
00:13:45,240 --> 00:13:52,279
demo of of<font color="#CCCCCC"> Q&E in action</font><font color="#E5E5E5"> let me see if I</font>

324
00:13:49,949 --> 00:13:52,279
can

325
00:13:56,819 --> 00:14:05,310
<font color="#E5E5E5">sorry</font>

326
00:13:58,560 --> 00:14:08,010
<font color="#CCCCCC">this I hope is is visible</font><font color="#E5E5E5"> so first of</font>

327
00:14:05,310 --> 00:14:12,150
all let's let's take a quick look human

328
00:14:08,010 --> 00:14:13,830
options so as you can see<font color="#E5E5E5"> this is of</font>

329
00:14:12,150 --> 00:14:15,569
<font color="#E5E5E5">course everything</font><font color="#CCCCCC"> that I'm</font><font color="#E5E5E5"> saying I'm</font>

330
00:14:13,830 --> 00:14:19,260
showing here is using<font color="#E5E5E5"> human as a</font>

331
00:14:15,570 --> 00:14:21,210
command-line tool it can be perfectly

332
00:14:19,260 --> 00:14:23,580
used and it's very simple<font color="#CCCCCC"> as a library</font>

333
00:14:21,210 --> 00:14:25,740
Python library so<font color="#E5E5E5"> you just import cumin</font>

334
00:14:23,580 --> 00:14:27,420
and in the<font color="#E5E5E5"> documentation it's very</font>

335
00:14:25,740 --> 00:14:30,779
clearly<font color="#E5E5E5"> there</font><font color="#CCCCCC"> are a lot of example</font><font color="#E5E5E5"> of</font>

336
00:14:27,420 --> 00:14:34,349
<font color="#E5E5E5">how to use it</font><font color="#CCCCCC"> so the basically what you</font>

337
00:14:30,779 --> 00:14:36,210
run is cumin a hospice your query<font color="#E5E5E5"> that</font>

338
00:14:34,350 --> 00:14:37,890
you want to<font color="#E5E5E5"> select the host and the</font>

339
00:14:36,210 --> 00:14:42,930
series of common<font color="#E5E5E5"> that you want to</font>

340
00:14:37,890 --> 00:14:46,620
execute one or more and by default<font color="#CCCCCC"> it</font>

341
00:14:42,930 --> 00:14:48,839
<font color="#CCCCCC">reads a configuration that it's it's</font>

342
00:14:46,620 --> 00:14:52,529
usually in tcq me but you can change<font color="#E5E5E5"> it</font>

343
00:14:48,839 --> 00:14:55,680
and you can pick a<font color="#E5E5E5"> different one</font><font color="#CCCCCC"> the</font>

344
00:14:52,529 --> 00:14:58,680
mode is what it's a<font color="#E5E5E5"> very specific</font><font color="#CCCCCC"> thing</font>

345
00:14:55,680 --> 00:15:00,599
that<font color="#E5E5E5"> we decided</font><font color="#CCCCCC"> to do so basically</font><font color="#E5E5E5"> when</font>

346
00:14:58,680 --> 00:15:02,729
you<font color="#CCCCCC"> are running multiple</font><font color="#E5E5E5"> commands you</font>

347
00:15:00,600 --> 00:15:05,280
have<font color="#E5E5E5"> basically two way of doing that I</font>

348
00:15:02,730 --> 00:15:08,040
<font color="#E5E5E5">mean there are many but the most common</font>

349
00:15:05,280 --> 00:15:11,970
ways is I want to<font color="#E5E5E5"> run this common on all</font>

350
00:15:08,040 --> 00:15:14,550
the hosts<font color="#E5E5E5"> and then if it's a sexual run</font>

351
00:15:11,970 --> 00:15:16,860
the second common on all the hosts<font color="#CCCCCC"> that</font>

352
00:15:14,550 --> 00:15:19,800
were successful so basically<font color="#E5E5E5"> you</font><font color="#CCCCCC"> turn on</font>

353
00:15:16,860 --> 00:15:21,990
the first common of a hundreds have on I

354
00:15:19,800 --> 00:15:24,000
<font color="#CCCCCC">don't know</font><font color="#E5E5E5"> ten failures and that ten</font>

355
00:15:21,990 --> 00:15:27,150
<font color="#E5E5E5">failure series within your success ratio</font>

356
00:15:24,000 --> 00:15:29,160
and then you go<font color="#E5E5E5"> alien will execute the</font>

357
00:15:27,150 --> 00:15:31,920
next<font color="#E5E5E5"> common only on the ninety holes</font>

358
00:15:29,160 --> 00:15:33,209
that were successful if instead your

359
00:15:31,920 --> 00:15:35,160
success ratio was I don't<font color="#CCCCCC"> know</font>

360
00:15:33,210 --> 00:15:37,160
<font color="#CCCCCC">ninety-five percent</font><font color="#E5E5E5"> that will not match</font>

361
00:15:35,160 --> 00:15:40,020
<font color="#E5E5E5">will just run the first</font><font color="#CCCCCC"> command and stop</font>

362
00:15:37,160 --> 00:15:42,180
<font color="#CCCCCC">and this which we call a sink mode</font>

363
00:15:40,020 --> 00:15:45,990
basically<font color="#E5E5E5"> and then there is the</font><font color="#CCCCCC"> a sink</font>

364
00:15:42,180 --> 00:15:48,300
mode in which you<font color="#E5E5E5"> don't care about this</font>

365
00:15:45,990 --> 00:15:49,830
synchronicity about the<font color="#E5E5E5"> the cluster and</font>

366
00:15:48,300 --> 00:15:51,300
<font color="#E5E5E5">you just run</font><font color="#CCCCCC"> the first the second and</font>

367
00:15:49,830 --> 00:15:54,690
the<font color="#CCCCCC"> third</font><font color="#E5E5E5"> command or whatever they are</font>

368
00:15:51,300 --> 00:15:56,550
in each host independently<font color="#E5E5E5"> so in each</font>

369
00:15:54,690 --> 00:15:58,770
host<font color="#E5E5E5"> if one command fails</font><font color="#CCCCCC"> he will not</font>

370
00:15:56,550 --> 00:16:00,810
<font color="#CCCCCC">run the others but it will not wait for</font>

371
00:15:58,770 --> 00:16:02,590
<font color="#CCCCCC">the other for the</font><font color="#E5E5E5"> Helios so they are</font>

372
00:16:00,810 --> 00:16:04,599
independent between them

373
00:16:02,590 --> 00:16:06,630
they are basically<font color="#CCCCCC"> vertically</font>

374
00:16:04,600 --> 00:16:13,990
independent and each one will execute

375
00:16:06,630 --> 00:16:18,850
their commands so then we have the<font color="#E5E5E5"> other</font>

376
00:16:13,990 --> 00:16:22,810
<font color="#CCCCCC">options that we'll see that are</font>

377
00:16:18,850 --> 00:16:25,540
basically<font color="#E5E5E5"> the batch the</font><font color="#CCCCCC"> timeout output</font>

378
00:16:22,810 --> 00:16:29,229
sleep interactive mode<font color="#CCCCCC"> and all basically</font>

379
00:16:25,540 --> 00:16:31,689
the the option that<font color="#CCCCCC"> I</font><font color="#E5E5E5"> talked about and</font>

380
00:16:29,230 --> 00:16:33,970
then we let's see<font color="#E5E5E5"> how we can do</font>

381
00:16:31,690 --> 00:16:36,880
<font color="#E5E5E5">basically a simple a</font><font color="#CCCCCC"> simple query</font><font color="#E5E5E5"> in</font>

382
00:16:33,970 --> 00:16:39,730
this case we have we are<font color="#E5E5E5"> using Papa DB</font>

383
00:16:36,880 --> 00:16:42,520
as a<font color="#CCCCCC"> back-end</font><font color="#E5E5E5"> and so this is very simple</font>

384
00:16:39,730 --> 00:16:45,640
syntax to say I want all the house the

385
00:16:42,520 --> 00:16:47,380
match class<font color="#E5E5E5"> engine X and given that I</font>

386
00:16:45,640 --> 00:16:49,360
didn't put any commonly<font color="#E5E5E5"> we'll assume</font>

387
00:16:47,380 --> 00:16:51,700
that<font color="#CCCCCC"> is in</font><font color="#E5E5E5"> drier and more than just exit</font>

388
00:16:49,360 --> 00:16:53,980
after<font color="#E5E5E5"> listing the matching</font><font color="#CCCCCC"> lost</font><font color="#E5E5E5"> the</font>

389
00:16:51,700 --> 00:16:56,890
matching goes<font color="#E5E5E5"> also</font><font color="#CCCCCC"> they are listed in</font>

390
00:16:53,980 --> 00:16:59,530
very compact way<font color="#E5E5E5"> this is also thanks to</font>

391
00:16:56,890 --> 00:17:01,949
cluster shell library<font color="#E5E5E5"> that use a node</font>

392
00:16:59,530 --> 00:17:04,450
set that are basically<font color="#E5E5E5"> Python sets but</font>

393
00:17:01,950 --> 00:17:06,010
with additional<font color="#CCCCCC"> features and one of</font>

394
00:17:04,450 --> 00:17:10,360
<font color="#E5E5E5">those is basically to automatically</font>

395
00:17:06,010 --> 00:17:14,140
compress<font color="#CCCCCC"> they asked in</font><font color="#E5E5E5"> a very competent</font>

396
00:17:10,359 --> 00:17:19,000
<font color="#E5E5E5">syntax in particular if you</font><font color="#CCCCCC"> have number</font>

397
00:17:14,140 --> 00:17:21,160
range in<font color="#CCCCCC"> viewer in euros names and so</font>

398
00:17:19,000 --> 00:17:23,290
basically for<font color="#CCCCCC"> example to say just a Papa</font>

399
00:17:21,160 --> 00:17:25,360
DB a puppet class that is applied you we

400
00:17:23,290 --> 00:17:27,520
do that and in this<font color="#CCCCCC"> case we are just</font>

401
00:17:25,359 --> 00:17:31,899
checking<font color="#E5E5E5"> all the hosts</font><font color="#CCCCCC"> that match a</font>

402
00:17:27,520 --> 00:17:34,600
resource of type<font color="#E5E5E5"> file was title is that</font>

403
00:17:31,900 --> 00:17:36,790
one so<font color="#E5E5E5"> basically we are checking if that</font>

404
00:17:34,600 --> 00:17:38,439
fire is managed<font color="#CCCCCC"> by puppet</font><font color="#E5E5E5"> that will be</font>

405
00:17:36,790 --> 00:17:40,600
<font color="#CCCCCC">recorded in Papua DB as a resource a</font>

406
00:17:38,440 --> 00:17:43,900
file resource<font color="#E5E5E5"> and the title of that file</font>

407
00:17:40,600 --> 00:17:46,240
source is<font color="#CCCCCC"> the is the path</font><font color="#E5E5E5"> usually the</font>

408
00:17:43,900 --> 00:17:48,340
part<font color="#E5E5E5"> of where you are saving it and you</font>

409
00:17:46,240 --> 00:17:51,010
can check very quickly<font color="#E5E5E5"> and target those</font>

410
00:17:48,340 --> 00:17:53,919
<font color="#CCCCCC">host</font><font color="#E5E5E5"> based based on on specific</font>

411
00:17:51,010 --> 00:17:56,440
resources<font color="#CCCCCC"> so not only classes but but</font>

412
00:17:53,920 --> 00:18:00,360
also very<font color="#E5E5E5"> very specific resources or</font>

413
00:17:56,440 --> 00:18:03,790
facts<font color="#E5E5E5"> in this case we are</font><font color="#CCCCCC"> using the</font>

414
00:18:00,360 --> 00:18:06,280
<font color="#E5E5E5">kinda new</font><font color="#CCCCCC"> padding of paw patrols and</font>

415
00:18:03,790 --> 00:18:06,700
puppet profiles<font color="#E5E5E5"> so in this case it's a</font>

416
00:18:06,280 --> 00:18:08,920
<font color="#E5E5E5">roll</font>

417
00:18:06,700 --> 00:18:10,470
it's a roll call<font color="#CCCCCC"> MediaWiki observers</font><font color="#E5E5E5"> and</font>

418
00:18:08,920 --> 00:18:12,269
this will match

419
00:18:10,470 --> 00:18:17,640
the<font color="#CCCCCC"> horse that that have this rule</font>

420
00:18:12,269 --> 00:18:20,640
applied to them<font color="#E5E5E5"> and this</font><font color="#CCCCCC"> is a slightly</font>

421
00:18:17,640 --> 00:18:22,950
more<font color="#E5E5E5"> complex</font><font color="#CCCCCC"> P that is using the global</font>

422
00:18:20,640 --> 00:18:27,510
<font color="#E5E5E5">gamma so in this case I'm mixing things</font>

423
00:18:22,950 --> 00:18:29,610
from different<font color="#E5E5E5"> back and it's just an</font>

424
00:18:27,510 --> 00:18:31,710
<font color="#CCCCCC">example there are</font><font color="#E5E5E5"> both</font><font color="#CCCCCC"> Papa DB</font><font color="#E5E5E5"> back</font><font color="#CCCCCC"> ends</font>

425
00:18:29,610 --> 00:18:34,049
by different queries<font color="#E5E5E5"> so I can do</font><font color="#CCCCCC"> queries</font>

426
00:18:31,710 --> 00:18:36,809
that<font color="#E5E5E5"> Papa db-api don't allow me to do I</font>

427
00:18:34,049 --> 00:18:39,510
am asking for<font color="#E5E5E5"> all the house that</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> the</font>

428
00:18:36,809 --> 00:18:42,200
class<font color="#E5E5E5"> engine X and also all the halls</font>

429
00:18:39,510 --> 00:18:44,370
<font color="#E5E5E5">that have a fact that says that the</font>

430
00:18:42,200 --> 00:18:46,470
<font color="#CCCCCC">distribution name is Jessie</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> that</font>

431
00:18:44,370 --> 00:18:49,500
<font color="#E5E5E5">beyond Jessie so in this case I'm</font>

432
00:18:46,470 --> 00:18:53,429
getting<font color="#CCCCCC"> a sub selection of us and I can</font>

433
00:18:49,500 --> 00:18:55,710
do and and not works<font color="#CCCCCC"> or and combine them</font>

434
00:18:53,429 --> 00:18:58,080
<font color="#E5E5E5">with</font><font color="#CCCCCC"> parentheses so basically there is</font>

435
00:18:55,710 --> 00:19:01,350
<font color="#E5E5E5">no</font><font color="#CCCCCC"> no limitation for for the</font><font color="#E5E5E5"> combination</font>

436
00:18:58,080 --> 00:19:03,480
of lost<font color="#CCCCCC"> as you can see this can become</font>

437
00:19:01,350 --> 00:19:08,129
quite long the<font color="#CCCCCC"> piece can become</font><font color="#E5E5E5"> quite</font>

438
00:19:03,480 --> 00:19:10,470
long so<font color="#CCCCCC"> we develop audiences audiences</font>

439
00:19:08,130 --> 00:19:13,710
<font color="#CCCCCC">are basically</font><font color="#E5E5E5"> a configuration file</font><font color="#CCCCCC"> which</font>

440
00:19:10,470 --> 00:19:16,289
we you can just say I want an alias<font color="#CCCCCC"> in</font>

441
00:19:13,710 --> 00:19:19,019
this case a<font color="#E5E5E5"> and W is an alias for us and</font>

442
00:19:16,289 --> 00:19:19,379
that can be a<font color="#CCCCCC"> very complex</font><font color="#E5E5E5"> we doesn't</font>

443
00:19:19,019 --> 00:19:21,720
matter

444
00:19:19,380 --> 00:19:23,639
it's a configuration file<font color="#E5E5E5"> so all the</font>

445
00:19:21,720 --> 00:19:25,679
common queries that you might have you

446
00:19:23,639 --> 00:19:30,090
can<font color="#CCCCCC"> just save them in an alias and it</font>

447
00:19:25,679 --> 00:19:32,549
will be very<font color="#CCCCCC"> very</font><font color="#E5E5E5"> easy to to recall them</font>

448
00:19:30,090 --> 00:19:38,789
when you<font color="#E5E5E5"> want so in this case let's run</font>

449
00:19:32,549 --> 00:19:42,690
a<font color="#E5E5E5"> very simple thing I'm checking if</font>

450
00:19:38,789 --> 00:19:46,049
<font color="#E5E5E5">Apache do a Apache to process on</font>

451
00:19:42,690 --> 00:19:48,029
systemctl<font color="#CCCCCC"> is active</font><font color="#E5E5E5"> on a target</font><font color="#CCCCCC"> a series</font>

452
00:19:46,049 --> 00:19:50,460
of target<font color="#CCCCCC"> host</font><font color="#E5E5E5"> and I very quickly can</font>

453
00:19:48,029 --> 00:19:53,610
see that one host has it<font color="#CCCCCC"> inactive and</font>

454
00:19:50,460 --> 00:19:56,970
all the other hosts have the avid active

455
00:19:53,610 --> 00:20:02,010
and<font color="#CCCCCC"> q is telling me very clearly</font><font color="#E5E5E5"> at the</font>

456
00:19:56,970 --> 00:20:04,830
end that<font color="#CCCCCC"> 1%</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> the one host didn't did</font>

457
00:20:02,010 --> 00:20:08,519
executed the failed because the exit

458
00:20:04,830 --> 00:20:11,100
code of that<font color="#CCCCCC"> common</font><font color="#E5E5E5"> was not</font><font color="#CCCCCC"> 0</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> it</font>

459
00:20:08,519 --> 00:20:14,940
<font color="#CCCCCC">lists me where deals that</font><font color="#E5E5E5"> succeeds</font><font color="#CCCCCC"> so</font>

460
00:20:11,100 --> 00:20:16,740
<font color="#CCCCCC">from these I can basically just if I</font>

461
00:20:14,940 --> 00:20:18,570
want to do some next command based on

462
00:20:16,740 --> 00:20:19,730
this output<font color="#CCCCCC"> I can</font><font color="#E5E5E5"> just copy and paste</font>

463
00:20:18,570 --> 00:20:23,070
the list of all

464
00:20:19,730 --> 00:20:25,170
that the subgroups of successful and

465
00:20:23,070 --> 00:20:27,330
failing and failing<font color="#CCCCCC"> hosts</font><font color="#E5E5E5"> are there and</font>

466
00:20:25,170 --> 00:20:31,170
use cumin again with that list of us

467
00:20:27,330 --> 00:20:38,070
because I can just<font color="#E5E5E5"> put those things</font>

468
00:20:31,170 --> 00:20:40,650
<font color="#E5E5E5">there so a little bit more complex</font>

469
00:20:38,070 --> 00:20:44,909
example with<font color="#E5E5E5"> two comments</font><font color="#CCCCCC"> because this</font>

470
00:20:40,650 --> 00:20:47,970
was<font color="#CCCCCC"> just a</font><font color="#E5E5E5"> single comment we can run the</font>

471
00:20:44,910 --> 00:20:52,230
<font color="#E5E5E5">same thing but then I want to get the</font>

472
00:20:47,970 --> 00:20:55,920
<font color="#E5E5E5">status to know since how much time the</font>

473
00:20:52,230 --> 00:21:00,240
<font color="#E5E5E5">host sorry the service was active and in</font>

474
00:20:55,920 --> 00:21:03,480
this case it will just run at the same

475
00:21:00,240 --> 00:21:06,000
concept<font color="#CCCCCC"> but</font><font color="#E5E5E5"> I can show you whether here</font>

476
00:21:03,480 --> 00:21:09,900
<font color="#E5E5E5">so as you can</font><font color="#CCCCCC"> see I'm using the</font><font color="#E5E5E5"> a sync</font>

477
00:21:06,000 --> 00:21:11,970
mode in this case and what I'm telling

478
00:21:09,900 --> 00:21:14,100
<font color="#CCCCCC">is basically two and those common</font>

479
00:21:11,970 --> 00:21:16,290
independently<font color="#E5E5E5"> because I don't care to</font>

480
00:21:14,100 --> 00:21:20,159
<font color="#E5E5E5">end the status on all the hosts and then</font>

481
00:21:16,290 --> 00:21:21,540
<font color="#CCCCCC">to end the basically sorry</font><font color="#E5E5E5"> the is active</font>

482
00:21:20,160 --> 00:21:23,610
<font color="#E5E5E5">on all the hosts and then running the</font>

483
00:21:21,540 --> 00:21:27,240
status and<font color="#E5E5E5"> gapping for the the time it</font>

484
00:21:23,610 --> 00:21:30,240
was active on on all the<font color="#E5E5E5"> host after that</font>

485
00:21:27,240 --> 00:21:32,280
I just<font color="#CCCCCC"> run both</font><font color="#E5E5E5"> command on all the hosts</font>

486
00:21:30,240 --> 00:21:33,990
<font color="#E5E5E5">at the same time and as you can see</font>

487
00:21:32,280 --> 00:21:36,810
<font color="#E5E5E5">group the output together so I know that</font>

488
00:21:33,990 --> 00:21:38,340
<font color="#E5E5E5">44 hours</font><font color="#CCCCCC"> where basically</font><font color="#E5E5E5"> Apache 2 was</font>

489
00:21:36,810 --> 00:21:40,320
restarted<font color="#CCCCCC"> two weeks and four days ago</font>

490
00:21:38,340 --> 00:21:44,040
<font color="#E5E5E5">and was most likely for</font><font color="#CCCCCC"> our first</font>

491
00:21:40,320 --> 00:21:45,750
security upgrade and in<font color="#E5E5E5"> this case I'm</font>

492
00:21:44,040 --> 00:21:48,300
using<font color="#E5E5E5"> batches so it would be a little</font>

493
00:21:45,750 --> 00:21:51,570
<font color="#E5E5E5">bit slower</font><font color="#CCCCCC"> I'm using batches of</font><font color="#E5E5E5"> five and</font>

494
00:21:48,300 --> 00:21:53,750
I set the success percentage of<font color="#E5E5E5"> 80 that</font>

495
00:21:51,570 --> 00:21:56,310
means that I accept<font color="#CCCCCC"> 80 percent success</font>

496
00:21:53,750 --> 00:22:00,390
<font color="#E5E5E5">and only 20 percent fail you for each</font>

497
00:21:56,310 --> 00:22:03,300
batch of<font color="#CCCCCC"> 5 and I know already</font><font color="#E5E5E5"> that be</font>

498
00:22:00,390 --> 00:22:06,270
given<font color="#CCCCCC"> this same list</font><font color="#E5E5E5"> of us and in this</font>

499
00:22:03,300 --> 00:22:08,190
case sorry is using the sync<font color="#CCCCCC"> mod so</font>

500
00:22:06,270 --> 00:22:10,080
basically it's in this case<font color="#E5E5E5"> I am running</font>

501
00:22:08,190 --> 00:22:14,190
first one common on all<font color="#E5E5E5"> the hosts</font><font color="#CCCCCC"> and</font>

502
00:22:10,080 --> 00:22:17,510
then and then the second common only<font color="#CCCCCC"> on</font>

503
00:22:14,190 --> 00:22:17,510
the one<font color="#E5E5E5"> that that succeeded</font>

504
00:22:18,980 --> 00:22:27,470
and so this is going slowly because<font color="#E5E5E5"> it's</font>

505
00:22:24,170 --> 00:22:30,680
batch of five and we'll do the<font color="#E5E5E5"> same so</font>

506
00:22:27,470 --> 00:22:33,290
this<font color="#E5E5E5"> is a very quick example</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> how we</font>

507
00:22:30,680 --> 00:22:37,580
use cumin every day at the<font color="#E5E5E5"> wikimedia and</font>

508
00:22:33,290 --> 00:22:40,100
we have really<font color="#E5E5E5"> had a lot of good</font><font color="#CCCCCC"> result</font>

509
00:22:37,580 --> 00:22:40,909
<font color="#E5E5E5">so</font><font color="#CCCCCC"> far and a lot</font><font color="#E5E5E5"> of people are using</font>

510
00:22:40,100 --> 00:22:43,939
them<font color="#E5E5E5"> it</font>

511
00:22:40,910 --> 00:22:45,800
so just to<font color="#E5E5E5"> recap we have seen the cumin</font>

512
00:22:43,940 --> 00:22:49,520
as a<font color="#E5E5E5"> powerful query syntax to select</font>

513
00:22:45,800 --> 00:22:52,040
house<font color="#E5E5E5"> allowed to have multiple execution</font>

514
00:22:49,520 --> 00:22:54,680
strategies it aggregates<font color="#E5E5E5"> the output in a</font>

515
00:22:52,040 --> 00:22:57,050
smart way<font color="#E5E5E5"> and reports reliably or</font><font color="#CCCCCC"> the</font>

516
00:22:54,680 --> 00:22:59,990
failures can<font color="#E5E5E5"> be used as a common line</font>

517
00:22:57,050 --> 00:23:03,470
tool or as a<font color="#E5E5E5"> Python framework library in</font>

518
00:22:59,990 --> 00:23:08,540
<font color="#CCCCCC">your other automation or</font><font color="#E5E5E5"> orchestration</font>

519
00:23:03,470 --> 00:23:11,690
<font color="#E5E5E5">tools and to have more</font><font color="#CCCCCC"> information on</font>

520
00:23:08,540 --> 00:23:14,920
how<font color="#CCCCCC"> to</font><font color="#E5E5E5"> find the source code</font><font color="#CCCCCC"> that is the</font>

521
00:23:11,690 --> 00:23:16,880
<font color="#E5E5E5">leases on pi PI releases on github</font>

522
00:23:14,920 --> 00:23:18,980
<font color="#E5E5E5">documentation and how we use it</font><font color="#CCCCCC"> I</font>

523
00:23:16,880 --> 00:23:21,050
<font color="#E5E5E5">recommend</font><font color="#CCCCCC"> the foundation</font><font color="#E5E5E5"> it's so listed</font>

524
00:23:18,980 --> 00:23:23,450
on there that all<font color="#E5E5E5"> the links are</font><font color="#CCCCCC"> listed</font>

525
00:23:21,050 --> 00:23:26,270
on the page on the first<font color="#E5E5E5"> end page for</font>

526
00:23:23,450 --> 00:23:29,150
this told and all my contacts are on the

527
00:23:26,270 --> 00:23:31,129
speaker profile page on frost them<font color="#E5E5E5"> for</font>

528
00:23:29,150 --> 00:23:32,810
digital and<font color="#CCCCCC"> you can find them just</font>

529
00:23:31,130 --> 00:23:37,250
searching<font color="#CCCCCC"> for cumin for them and</font>

530
00:23:32,810 --> 00:23:41,480
optionally my name on any any search

531
00:23:37,250 --> 00:23:41,930
engine<font color="#E5E5E5"> so thank you</font><font color="#CCCCCC"> very much for being</font>

532
00:23:41,480 --> 00:23:44,660
<font color="#E5E5E5">here</font>

533
00:23:41,930 --> 00:23:47,779
and let<font color="#E5E5E5"> me know if you have any question</font>

534
00:23:44,660 --> 00:23:47,779
[Applause]

535
00:23:50,660 --> 00:23:54,769
[Applause]

536
00:24:08,700 --> 00:24:11,630
what do you mean

537
00:24:12,330 --> 00:24:18,740
okay yeah

538
00:24:23,809 --> 00:24:26,529
<font color="#E5E5E5">okay</font>

539
00:24:28,770 --> 00:24:31,800
so for that you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> set a very small</font>

540
00:24:31,110 --> 00:24:34,080
<font color="#CCCCCC">timeout</font>

541
00:24:31,800 --> 00:24:35,879
<font color="#CCCCCC">so if</font><font color="#E5E5E5"> your normal common</font><font color="#CCCCCC"> it's I don't</font>

542
00:24:34,080 --> 00:24:38,490
<font color="#CCCCCC">know ten seconds you can self some walk</font>

543
00:24:35,880 --> 00:24:43,200
<font color="#E5E5E5">20 just to be on</font><font color="#CCCCCC"> the safe side</font><font color="#E5E5E5"> and they</font>

544
00:24:38,490 --> 00:24:45,240
will fail<font color="#E5E5E5"> quickly the</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> option</font><font color="#CCCCCC"> it</font>

545
00:24:43,200 --> 00:24:47,700
doesn't have<font color="#CCCCCC"> exactly that that feature</font>

546
00:24:45,240 --> 00:24:51,030
so<font color="#CCCCCC"> that</font><font color="#E5E5E5"> after success already start the</font>

547
00:24:47,700 --> 00:24:53,100
second<font color="#CCCCCC"> one because we</font><font color="#E5E5E5"> want</font><font color="#CCCCCC"> to be</font>

548
00:24:51,030 --> 00:24:54,629
reliable<font color="#E5E5E5"> and execute like if you want to</font>

549
00:24:53,100 --> 00:24:56,280
do in<font color="#E5E5E5"> sync</font><font color="#CCCCCC"> module execute the</font><font color="#E5E5E5"> first one</font>

550
00:24:54,630 --> 00:24:59,400
on all of them because<font color="#CCCCCC"> you don't know if</font>

551
00:24:56,280 --> 00:25:03,210
the<font color="#CCCCCC"> next</font><font color="#E5E5E5"> one will be actually success or</font>

552
00:24:59,400 --> 00:25:06,770
failing<font color="#CCCCCC"> so we you can do that with a</font>

553
00:25:03,210 --> 00:25:06,770
<font color="#CCCCCC">timeout this</font><font color="#E5E5E5"> short time out to show that</font>

554
00:25:09,890 --> 00:25:14,790
like when<font color="#E5E5E5"> you use batches it's</font>

555
00:25:12,120 --> 00:25:17,580
calculated for each at any at<font color="#E5E5E5"> any time</font>

556
00:25:14,790 --> 00:25:19,290
<font color="#E5E5E5">host execute a comment so when you</font>

557
00:25:17,580 --> 00:25:21,570
finish<font color="#E5E5E5"> to execute a common it will</font>

558
00:25:19,290 --> 00:25:23,370
calculate a success percentage and if

559
00:25:21,570 --> 00:25:26,820
it's not<font color="#E5E5E5"> met it will not schedule again</font>

560
00:25:23,370 --> 00:25:27,449
and it will stop there<font color="#CCCCCC"> but yeah it's a</font>

561
00:25:26,820 --> 00:25:29,939
safety issue

562
00:25:27,450 --> 00:25:31,920
<font color="#E5E5E5">absolutely that's because like if you</font>

563
00:25:29,940 --> 00:25:34,110
<font color="#E5E5E5">want to do a batch of tea and then I</font>

564
00:25:31,920 --> 00:25:36,030
don't<font color="#E5E5E5"> know you accept one failure every</font>

565
00:25:34,110 --> 00:25:39,419
<font color="#E5E5E5">day but</font><font color="#CCCCCC"> it calculates on their own the</font>

566
00:25:36,030 --> 00:25:41,220
whole<font color="#CCCCCC"> thing so yeah</font><font color="#E5E5E5"> it will go but if</font>

567
00:25:39,420 --> 00:25:43,260
the first two fails it will<font color="#E5E5E5"> stop</font><font color="#CCCCCC"> for</font>

568
00:25:41,220 --> 00:25:45,179
example<font color="#CCCCCC"> because in the first batches you</font>

569
00:25:43,260 --> 00:25:47,420
have<font color="#E5E5E5"> very few holes and it's a safety</font>

570
00:25:45,179 --> 00:25:47,420
<font color="#CCCCCC">feature</font>

571
00:25:53,970 --> 00:25:57,240
thank you much

