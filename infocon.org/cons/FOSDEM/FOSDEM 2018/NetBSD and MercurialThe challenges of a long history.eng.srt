1
00:00:04,779 --> 00:00:16,790
hello everyone<font color="#CCCCCC"> what I'm going</font>

2
00:00:10,370 --> 00:00:19,549
about one<font color="#CCCCCC"> of the attempts to get</font><font color="#E5E5E5"> an FPS</font>

3
00:00:16,790 --> 00:00:27,070
<font color="#CCCCCC">tetouan</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> a modern version control</font>

4
00:00:19,550 --> 00:00:29,840
system so neck PST is a very old project

5
00:00:27,070 --> 00:00:35,899
<font color="#E5E5E5">historically it's the oldest of the new</font>

6
00:00:29,840 --> 00:00:40,460
<font color="#E5E5E5">PhDs after a</font><font color="#CCCCCC"> UCB basically got suits and</font>

7
00:00:35,899 --> 00:00:44,780
out of business<font color="#E5E5E5"> when</font><font color="#CCCCCC"> we came to software</font>

8
00:00:40,460 --> 00:00:48,260
development<font color="#CCCCCC"> and we are</font><font color="#E5E5E5"> also one of the</font>

9
00:00:44,780 --> 00:00:51,679
biggest<font color="#CCCCCC"> and oldest CVS repository still</font>

10
00:00:48,260 --> 00:00:54,920
around<font color="#E5E5E5"> and all pretty nice to to move to</font>

11
00:00:51,679 --> 00:00:58,640
something else<font color="#E5E5E5"> most</font><font color="#CCCCCC"> of this talk is not</font>

12
00:00:54,920 --> 00:01:02,600
really about<font color="#CCCCCC"> a net BST most of it</font>

13
00:00:58,640 --> 00:01:06,380
applies<font color="#CCCCCC"> to every other big project as</font>

14
00:01:02,600 --> 00:01:11,030
well so it would work<font color="#CCCCCC"> just as</font><font color="#E5E5E5"> well for</font>

15
00:01:06,380 --> 00:01:13,369
<font color="#CCCCCC">tdst Atwood with some changes apply to</font>

16
00:01:11,030 --> 00:01:17,710
<font color="#CCCCCC">FreeBSD as well</font><font color="#E5E5E5"> if they want</font><font color="#CCCCCC"> to get rid</font>

17
00:01:13,370 --> 00:01:22,070
of subversion<font color="#E5E5E5"> so I'm going to talk</font><font color="#CCCCCC"> about</font>

18
00:01:17,710 --> 00:01:25,820
what happened in the last<font color="#E5E5E5"> 25 years since</font>

19
00:01:22,070 --> 00:01:28,059
we<font color="#CCCCCC"> started with CVS I'm going to talk a</font>

20
00:01:25,820 --> 00:01:33,320
bit<font color="#E5E5E5"> about or what we</font><font color="#CCCCCC"> are currently doing</font>

21
00:01:28,060 --> 00:01:37,220
<font color="#E5E5E5">in in</font><font color="#CCCCCC"> FPS TV together</font>

22
00:01:33,320 --> 00:01:39,710
<font color="#CCCCCC">- mercurial I'm going to look at a</font>

23
00:01:37,220 --> 00:01:42,410
couple<font color="#E5E5E5"> of issues we have with mercurial</font>

24
00:01:39,710 --> 00:01:45,380
and what we are<font color="#E5E5E5"> going to do to fix them</font>

25
00:01:42,410 --> 00:01:51,020
in collaboration with<font color="#E5E5E5"> mercurial</font>

26
00:01:45,380 --> 00:01:54,259
developers and I'm also going to take a

27
00:01:51,020 --> 00:01:57,590
look<font color="#E5E5E5"> over what's hopefully going to</font>

28
00:01:54,260 --> 00:02:06,790
<font color="#E5E5E5">happen in the rest of the year or</font><font color="#CCCCCC"> maybe</font>

29
00:01:57,590 --> 00:02:13,280
<font color="#E5E5E5">the start of next year so</font><font color="#CCCCCC"> VCS migration</font>

30
00:02:06,790 --> 00:02:17,000
is very involved project<font color="#E5E5E5"> a couple of</font>

31
00:02:13,280 --> 00:02:19,370
people started to aggressively complain

32
00:02:17,000 --> 00:02:25,989
about<font color="#E5E5E5"> CVS</font>

33
00:02:19,370 --> 00:02:29,150
<font color="#E5E5E5">in</font><font color="#CCCCCC"> 2005</font><font color="#E5E5E5"> and one of the results of those</font>

34
00:02:25,989 --> 00:02:33,319
unstructured complaints was the creation

35
00:02:29,150 --> 00:02:35,360
of a mailing<font color="#E5E5E5"> list</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> people don't bother</font>

36
00:02:33,319 --> 00:02:38,230
<font color="#E5E5E5">all the other people</font><font color="#CCCCCC"> that actually try</font>

37
00:02:35,360 --> 00:02:40,819
to get things done like writing<font color="#E5E5E5"> software</font>

38
00:02:38,230 --> 00:02:44,480
<font color="#E5E5E5">so they they have their</font><font color="#CCCCCC"> own</font><font color="#E5E5E5"> little</font>

39
00:02:40,819 --> 00:02:51,560
<font color="#CCCCCC">corner</font><font color="#E5E5E5"> where they can be productive or</font>

40
00:02:44,480 --> 00:02:56,060
not<font color="#CCCCCC"> so lots of talks happened no one</font>

41
00:02:51,560 --> 00:02:58,750
really did anything<font color="#E5E5E5"> and this continued</font>

42
00:02:56,060 --> 00:02:58,750
for<font color="#CCCCCC"> quite a while</font>

43
00:03:00,310 --> 00:03:08,269
sometimes<font color="#E5E5E5"> in 2009 to 2010 we have</font>

44
00:03:05,120 --> 00:03:11,989
<font color="#E5E5E5">basically the situation that a couple of</font>

45
00:03:08,269 --> 00:03:15,470
tools existed that could do a conversion

46
00:03:11,989 --> 00:03:21,170
from CVS to subversion<font color="#E5E5E5"> or from CVS to</font>

47
00:03:15,470 --> 00:03:27,260
get<font color="#CCCCCC"> the rest sucked all of them</font><font color="#E5E5E5"> so we</font>

48
00:03:21,170 --> 00:03:31,668
<font color="#CCCCCC">have for example CBS 2's</font><font color="#E5E5E5"> VM and child</font>

49
00:03:27,260 --> 00:03:34,209
<font color="#CCCCCC">project</font><font color="#E5E5E5"> for converting to get there are</font>

50
00:03:31,669 --> 00:03:37,280
<font color="#CCCCCC">hopeless slow</font><font color="#E5E5E5"> we are talking about</font>

51
00:03:34,209 --> 00:03:41,480
converting an FEC source tree and

52
00:03:37,280 --> 00:03:43,069
something<font color="#E5E5E5"> like two days or more</font><font color="#CCCCCC"> that's</font>

53
00:03:41,480 --> 00:03:48,108
<font color="#E5E5E5">okay if you want to do the conversion</font>

54
00:03:43,069 --> 00:03:51,290
once but if you<font color="#CCCCCC"> actually want to prepare</font>

55
00:03:48,109 --> 00:03:56,629
migration project<font color="#E5E5E5"> you want to have</font>

56
00:03:51,290 --> 00:04:01,638
something<font color="#CCCCCC"> like a life more or less or</font>

57
00:03:56,629 --> 00:04:06,370
having<font color="#CCCCCC"> the lack of a</font><font color="#E5E5E5"> day okay but if you</font>

58
00:04:01,639 --> 00:04:06,370
have to do a<font color="#E5E5E5"> conversion every two days</font>

59
00:04:07,150 --> 00:04:17,478
that works so well some<font color="#E5E5E5"> other tools are</font>

60
00:04:11,690 --> 00:04:20,858
much<font color="#CCCCCC"> faster for example from CVS was</font>

61
00:04:17,478 --> 00:04:24,979
decently fast at the time the problem is

62
00:04:20,858 --> 00:04:27,020
it didn't really support<font color="#E5E5E5"> CVS that</font><font color="#CCCCCC"> well</font>

63
00:04:24,979 --> 00:04:30,050
<font color="#CCCCCC">for example</font>

64
00:04:27,020 --> 00:04:34,280
<font color="#E5E5E5">keyword expansion was completely broken</font>

65
00:04:30,050 --> 00:04:38,940
branch<font color="#CCCCCC"> handling was quite broken</font><font color="#E5E5E5"> imports</font>

66
00:04:34,280 --> 00:04:47,280
<font color="#E5E5E5">didn't really work</font><font color="#CCCCCC"> that well and so this</font>

67
00:04:38,940 --> 00:04:48,990
was<font color="#E5E5E5"> depressing so well</font><font color="#CCCCCC"> let's open source</font>

68
00:04:47,280 --> 00:04:51,630
<font color="#CCCCCC">approach if you</font><font color="#E5E5E5"> have a problem with the</font>

69
00:04:48,990 --> 00:04:54,600
<font color="#CCCCCC">existing things while you invent your</font>

70
00:04:51,630 --> 00:04:57,840
own<font color="#E5E5E5"> so that's basically what I did in</font>

71
00:04:54,600 --> 00:05:02,430
2010<font color="#CCCCCC"> I sat down and wrote a conversion</font>

72
00:04:57,840 --> 00:05:05,280
tool from CVS<font color="#E5E5E5"> to fossil</font><font color="#CCCCCC"> the primary</font>

73
00:05:02,430 --> 00:05:08,400
reason for<font color="#E5E5E5"> going with fossil was well it</font>

74
00:05:05,280 --> 00:05:13,070
<font color="#E5E5E5">was new at the time it was BSD license</font>

75
00:05:08,400 --> 00:05:16,530
which would be attractive<font color="#E5E5E5"> it's been</font>

76
00:05:13,070 --> 00:05:20,880
designed I want<font color="#E5E5E5"> database what makes it</font>

77
00:05:16,530 --> 00:05:23,729
actually quite attractive for crying<font color="#E5E5E5"> and</font>

78
00:05:20,880 --> 00:05:26,790
<font color="#E5E5E5">reporting so if you want to</font><font color="#CCCCCC"> analyze</font>

79
00:05:23,730 --> 00:05:29,640
<font color="#E5E5E5">what's going to happen in</font><font color="#CCCCCC"> your tree and</font>

80
00:05:26,790 --> 00:05:32,550
maybe fix up things like<font color="#E5E5E5"> that it's very</font>

81
00:05:29,640 --> 00:05:36,419
handy<font color="#CCCCCC"> to have an actual secret database</font>

82
00:05:32,550 --> 00:05:39,360
and not just a couple<font color="#CCCCCC"> of very special</font>

83
00:05:36,420 --> 00:05:42,380
<font color="#CCCCCC">purpose to it you have</font><font color="#E5E5E5"> to deal with so</font>

84
00:05:39,360 --> 00:05:46,770
this conversion<font color="#E5E5E5"> to live vote was also</font>

85
00:05:42,380 --> 00:05:51,510
based and using the database<font color="#E5E5E5"> because</font>

86
00:05:46,770 --> 00:05:55,169
while<font color="#CCCCCC"> it</font><font color="#E5E5E5"> was a well at the time</font><font color="#CCCCCC"> fifty</font>

87
00:05:51,510 --> 00:05:58,680
<font color="#CCCCCC">fifteen years of history in CVS you're</font>

88
00:05:55,170 --> 00:06:03,030
going to run<font color="#CCCCCC"> into lots of historical</font>

89
00:05:58,680 --> 00:06:08,790
<font color="#E5E5E5">garbage like</font><font color="#CCCCCC"> box and CVS that</font><font color="#E5E5E5"> creates</font>

90
00:06:03,030 --> 00:06:14,070
strange things and people<font color="#E5E5E5"> that misuse</font><font color="#CCCCCC"> -</font>

91
00:06:08,790 --> 00:06:17,040
things like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> and again this is an</font>

92
00:06:14,070 --> 00:06:19,380
ongoing project so you want to fix up

93
00:06:17,040 --> 00:06:24,690
those<font color="#E5E5E5"> things so you</font><font color="#CCCCCC"> don't have to do it</font>

94
00:06:19,380 --> 00:06:27,900
<font color="#E5E5E5">again and again and</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> some of the</font>

95
00:06:24,690 --> 00:06:32,760
requirements<font color="#CCCCCC"> for me was I wanted</font><font color="#E5E5E5"> to have</font>

96
00:06:27,900 --> 00:06:37,409
a conversion<font color="#E5E5E5"> tour that s faithful to the</font>

97
00:06:32,760 --> 00:06:39,420
original repository<font color="#CCCCCC"> as possible so he if</font>

98
00:06:37,410 --> 00:06:43,590
I do a CVS check out and

99
00:06:39,420 --> 00:06:45,450
given<font color="#E5E5E5"> approval</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> state in the new</font>

100
00:06:43,590 --> 00:06:49,820
version control system<font color="#E5E5E5"> they should</font><font color="#CCCCCC"> be</font>

101
00:06:45,450 --> 00:06:54,289
<font color="#E5E5E5">exactly the</font><font color="#CCCCCC"> same</font><font color="#E5E5E5"> no differences at all</font>

102
00:06:49,820 --> 00:06:59,430
<font color="#E5E5E5">it doesn't exactly work their view</font><font color="#CCCCCC"> there</font>

103
00:06:54,290 --> 00:07:03,870
<font color="#E5E5E5">few special</font><font color="#CCCCCC"> cases where I see what</font>

104
00:06:59,430 --> 00:07:06,660
expansion can be<font color="#E5E5E5"> tricky and like do you</font>

105
00:07:03,870 --> 00:07:08,940
do a basically<font color="#E5E5E5"> a check out of a specific</font>

106
00:07:06,660 --> 00:07:13,170
<font color="#CCCCCC">provision</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> a check out</font><font color="#E5E5E5"> of a branch</font>

107
00:07:08,940 --> 00:07:18,780
<font color="#CCCCCC">that can sometimes be different but</font><font color="#E5E5E5"> for</font>

108
00:07:13,170 --> 00:07:23,010
every case I have<font color="#E5E5E5"> that's a definition of</font>

109
00:07:18,780 --> 00:07:26,580
the behavior and you could get the<font color="#E5E5E5"> same</font>

110
00:07:23,010 --> 00:07:32,640
output<font color="#E5E5E5"> with the right flags from RCS or</font>

111
00:07:26,580 --> 00:07:37,770
CVS so that's good enough<font color="#CCCCCC"> I want you</font>

112
00:07:32,640 --> 00:07:41,180
also deal<font color="#CCCCCC"> with things like</font><font color="#E5E5E5"> vendor</font>

113
00:07:37,770 --> 00:07:45,060
branches in a way that makes sense

114
00:07:41,180 --> 00:07:48,510
<font color="#E5E5E5">historically so it's quite tricky</font><font color="#CCCCCC"> if you</font>

115
00:07:45,060 --> 00:07:52,440
want to deal<font color="#CCCCCC"> with CVS to get the state</font>

116
00:07:48,510 --> 00:07:55,110
of a vendor branch last<font color="#CCCCCC"> month</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> two</font>

117
00:07:52,440 --> 00:07:56,640
<font color="#CCCCCC">month</font><font color="#E5E5E5"> ago</font><font color="#CCCCCC"> especially if they're local</font>

118
00:07:55,110 --> 00:07:58,470
changes on top of it

119
00:07:56,640 --> 00:08:03,900
let's see<font color="#E5E5E5"> US doesn't really provide a</font>

120
00:07:58,470 --> 00:08:07,320
way<font color="#CCCCCC"> to extract that</font><font color="#E5E5E5"> bad data</font><font color="#CCCCCC"> but what we</font>

121
00:08:03,900 --> 00:08:11,010
can do is we pretend we are<font color="#E5E5E5"> in a time</font>

122
00:08:07,320 --> 00:08:13,080
machine<font color="#E5E5E5"> and provide</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> which what you</font>

123
00:08:11,010 --> 00:08:16,140
would<font color="#E5E5E5"> have</font><font color="#CCCCCC"> gotten or if you checked out</font>

124
00:08:13,080 --> 00:08:19,310
the<font color="#CCCCCC"> tree like two months</font><font color="#E5E5E5"> ago that works</font>

125
00:08:16,140 --> 00:08:25,320
very<font color="#E5E5E5"> well but it's also quite effective</font>

126
00:08:19,310 --> 00:08:28,590
<font color="#CCCCCC">I also want to</font><font color="#E5E5E5"> have a well a</font><font color="#CCCCCC"> crazy</font>

127
00:08:25,320 --> 00:08:29,760
<font color="#E5E5E5">incremental output</font><font color="#CCCCCC"> totally incremental</font>

128
00:08:28,590 --> 00:08:33,890
because I'm actually doing a full

129
00:08:29,760 --> 00:08:39,390
conversion but the output is stable<font color="#CCCCCC"> so</font>

130
00:08:33,890 --> 00:08:44,069
what you get is before repository

131
00:08:39,390 --> 00:08:48,449
conversion but all the<font color="#E5E5E5"> old stuff gets us</font>

132
00:08:44,070 --> 00:08:51,120
the<font color="#CCCCCC"> accepts and get revisions or fossil</font>

133
00:08:48,450 --> 00:08:53,190
revisions<font color="#E5E5E5"> whatever you want to call it</font>

134
00:08:51,120 --> 00:08:57,570
you are basically<font color="#E5E5E5"> only adding a couple</font>

135
00:08:53,190 --> 00:09:00,230
<font color="#E5E5E5">of new new things on top that couple of</font>

136
00:08:57,570 --> 00:09:04,460
optimizations to makes us faster but

137
00:09:00,230 --> 00:09:09,990
it's just<font color="#E5E5E5"> like that it's an optimization</font>

138
00:09:04,460 --> 00:09:13,529
so at the moment<font color="#CCCCCC"> modern hardware we have</font>

139
00:09:09,990 --> 00:09:16,830
<font color="#CCCCCC">a conversion cycle for the source treif</font>

140
00:09:13,529 --> 00:09:20,490
<font color="#E5E5E5">of about two hours for</font><font color="#CCCCCC"> packaged chairs</font>

141
00:09:16,830 --> 00:09:23,520
<font color="#E5E5E5">about one hour there's some</font><font color="#CCCCCC"> somewhat</font>

142
00:09:20,490 --> 00:09:25,350
<font color="#CCCCCC">lettin see added at the beginning to</font>

143
00:09:23,520 --> 00:09:27,839
make<font color="#CCCCCC"> sure that the tree is in a</font>

144
00:09:25,350 --> 00:09:30,210
consistent state like no one is

145
00:09:27,839 --> 00:09:34,260
currently committing to a hundred

146
00:09:30,210 --> 00:09:38,040
thousand files<font color="#E5E5E5"> and so you you want to</font>

147
00:09:34,260 --> 00:09:40,770
<font color="#E5E5E5">avoid getting into a middle of the</font>

148
00:09:38,040 --> 00:09:43,140
commit<font color="#CCCCCC"> part or beyond that and you</font>

149
00:09:40,770 --> 00:09:45,800
<font color="#CCCCCC">basically</font><font color="#E5E5E5"> get our twelve updates of the</font>

150
00:09:43,140 --> 00:09:45,800
<font color="#E5E5E5">source tree</font>

151
00:09:57,390 --> 00:10:00,959
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> Wyatt's</font>

152
00:10:09,620 --> 00:10:50,810
I<font color="#CCCCCC"> hit take the technology yes</font><font color="#E5E5E5"> okay it's</font>

153
00:10:45,110 --> 00:10:53,900
just<font color="#E5E5E5"> wait a minute for that so as I said</font>

154
00:10:50,810 --> 00:10:54,500
we have an update<font color="#CCCCCC"> cycle</font><font color="#E5E5E5"> off about every</font>

155
00:10:53,900 --> 00:10:58,579
<font color="#E5E5E5">two hours</font>

156
00:10:54,500 --> 00:11:02,180
this includes updating the more on

157
00:10:58,580 --> 00:11:05,390
github and updating them they are<font color="#E5E5E5"> on bit</font>

158
00:11:02,180 --> 00:11:08,410
packet so that's actually quite quite a

159
00:11:05,390 --> 00:11:11,180
bit more<font color="#E5E5E5"> work than</font><font color="#CCCCCC"> just converting the</font>

160
00:11:08,410 --> 00:11:16,480
repository<font color="#CCCCCC"> to one</font><font color="#E5E5E5"> system it includes all</font>

161
00:11:11,180 --> 00:11:20,260
three<font color="#E5E5E5"> or</font><font color="#CCCCCC"> three of them</font><font color="#E5E5E5"> the result</font>

162
00:11:16,480 --> 00:11:20,260
consumptions also quite low

163
00:11:35,580 --> 00:11:42,680
the the<font color="#CCCCCC"> truths</font><font color="#E5E5E5"> are with me to work in</font>

164
00:11:38,670 --> 00:11:45,420
less<font color="#E5E5E5"> than 40 a bite</font><font color="#CCCCCC"> of one</font><font color="#E5E5E5"> and on the</font>

165
00:11:42,680 --> 00:11:48,630
<font color="#E5E5E5">official nepia steam machine that's</font>

166
00:11:45,420 --> 00:11:52,560
really the conversion we also have a 32

167
00:11:48,630 --> 00:11:54,810
gigabyte memory file system for all the

168
00:11:52,560 --> 00:11:59,040
<font color="#E5E5E5">the</font><font color="#CCCCCC"> things that are</font><font color="#E5E5E5"> we've written all</font>

169
00:11:54,810 --> 00:12:03,540
the time to keep the the channel on<font color="#E5E5E5"> the</font>

170
00:11:59,040 --> 00:12:16,020
<font color="#E5E5E5">SS SSD slow but if you compare</font><font color="#CCCCCC"> that for</font>

171
00:12:03,540 --> 00:12:21,599
<font color="#E5E5E5">example with</font><font color="#CCCCCC"> Reaper surgeon from Eric he</font>

172
00:12:16,020 --> 00:12:25,350
complained<font color="#E5E5E5"> recently that he's running</font>

173
00:12:21,600 --> 00:12:29,010
out of swap space on machines with 64

174
00:12:25,350 --> 00:12:32,150
gigabyte<font color="#E5E5E5"> one and more for</font><font color="#CCCCCC"> projects that</font>

175
00:12:29,010 --> 00:12:44,490
<font color="#CCCCCC">are</font><font color="#E5E5E5"> essentially comparable in size so</font>

176
00:12:32,150 --> 00:12:48,319
next<font color="#CCCCCC"> Ricky so the the first mercurial</font>

177
00:12:44,490 --> 00:12:53,220
experiments were based on CBS 2's<font color="#CCCCCC"> VN</font><font color="#E5E5E5"> and</font>

178
00:12:48,320 --> 00:12:55,860
they were not very<font color="#CCCCCC"> encouraging</font><font color="#E5E5E5"> so asking</font>

179
00:12:53,220 --> 00:12:59,990
for the<font color="#E5E5E5"> mock entry of the latest</font>

180
00:12:55,860 --> 00:12:59,990
<font color="#E5E5E5">revision took something</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> 30 seconds</font>

181
00:13:00,140 --> 00:13:08,340
because<font color="#E5E5E5"> mercurial was trying to do was</font>

182
00:13:05,340 --> 00:13:11,910
figure out which text exists for the

183
00:13:08,340 --> 00:13:14,880
supervision<font color="#E5E5E5"> and this involved or poverty</font>

184
00:13:11,910 --> 00:13:17,310
<font color="#CCCCCC">pausing the tech file for every</font><font color="#E5E5E5"> single</font>

185
00:13:14,880 --> 00:13:20,160
branch<font color="#E5E5E5"> in the system and well at the</font>

186
00:13:17,310 --> 00:13:23,550
<font color="#CCCCCC">moment</font><font color="#E5E5E5"> we have some we have</font><font color="#CCCCCC"> 399</font><font color="#E5E5E5"> branches</font>

187
00:13:20,160 --> 00:13:27,449
<font color="#CCCCCC">it was a bit less at the time but the</font>

188
00:13:23,550 --> 00:13:28,479
the poverty 100 times in the world was

189
00:13:27,450 --> 00:13:32,560
still

190
00:13:28,480 --> 00:13:35,079
very slow and there was no tech<font color="#CCCCCC"> cache at</font>

191
00:13:32,560 --> 00:13:38,229
<font color="#CCCCCC">the</font><font color="#E5E5E5"> time so</font><font color="#CCCCCC"> it would</font><font color="#E5E5E5"> have been</font><font color="#CCCCCC"> done</font><font color="#E5E5E5"> over</font>

192
00:13:35,079 --> 00:13:42,370
and over<font color="#CCCCCC"> and over again well it turns</font>

193
00:13:38,230 --> 00:13:46,959
<font color="#E5E5E5">out this doesn't work so well a couple</font>

194
00:13:42,370 --> 00:13:49,630
<font color="#CCCCCC">of years later in 2014</font><font color="#E5E5E5"> Alistair did</font>

195
00:13:46,959 --> 00:13:53,349
another try based on my conversion true

196
00:13:49,630 --> 00:13:56,670
and then<font color="#E5E5E5"> basically taking the the get</font>

197
00:13:53,350 --> 00:14:04,000
fast import<font color="#E5E5E5"> or output from fossil and</font>

198
00:13:56,670 --> 00:14:07,089
importing that into a mercurial<font color="#E5E5E5"> Wow it</font>

199
00:14:04,000 --> 00:14:10,540
helped on<font color="#E5E5E5"> the material side to get the</font>

200
00:14:07,089 --> 00:14:15,250
general data support<font color="#CCCCCC"> documented properly</font>

201
00:14:10,540 --> 00:14:18,599
<font color="#E5E5E5">and this reduced the size of the</font>

202
00:14:15,250 --> 00:14:24,070
<font color="#E5E5E5">mercurial repository</font><font color="#CCCCCC"> from something like</font>

203
00:14:18,600 --> 00:14:28,600
<font color="#CCCCCC">25 gigabytes to 20 half gigabyte which</font>

204
00:14:24,070 --> 00:14:31,089
<font color="#CCCCCC">was okay at the time we didn't really</font>

205
00:14:28,600 --> 00:14:34,149
get branches because<font color="#E5E5E5"> well we are going</font>

206
00:14:31,089 --> 00:14:38,350
via the<font color="#CCCCCC"> deeper format and the gif format</font>

207
00:14:34,149 --> 00:14:43,630
<font color="#E5E5E5">means well you take</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> they had bats</font>

208
00:14:38,350 --> 00:14:45,430
<font color="#E5E5E5">of each branch and so since we</font><font color="#CCCCCC"> have</font>

209
00:14:43,630 --> 00:14:49,290
turned into bookmarks which is not

210
00:14:45,430 --> 00:14:51,069
really what<font color="#CCCCCC"> we wanted this was also</font>

211
00:14:49,290 --> 00:14:54,610
quite slow

212
00:14:51,069 --> 00:14:57,219
that's<font color="#E5E5E5"> what took two days or so because</font>

213
00:14:54,610 --> 00:15:07,529
<font color="#E5E5E5">we're the twigs didn't exactly scale and</font>

214
00:14:57,220 --> 00:15:07,529
<font color="#E5E5E5">sing stop that</font><font color="#CCCCCC"> right so what happened</font>

215
00:15:07,800 --> 00:15:15,430
<font color="#CCCCCC">another group that</font><font color="#E5E5E5"> wanted</font><font color="#CCCCCC"> to discuss</font>

216
00:15:12,089 --> 00:15:18,339
well how can<font color="#E5E5E5"> you finally get</font><font color="#CCCCCC"> you get and</font>

217
00:15:15,430 --> 00:15:20,888
because well<font color="#E5E5E5"> of course we</font><font color="#CCCCCC"> only have</font><font color="#E5E5E5"> have</font>

218
00:15:18,339 --> 00:15:27,220
the choice of of<font color="#E5E5E5"> taking get because</font><font color="#CCCCCC"> get</font>

219
00:15:20,889 --> 00:15:31,600
<font color="#CCCCCC">one and everyone is using it so the same</font>

220
00:15:27,220 --> 00:15:35,410
happened<font color="#E5E5E5"> as before nothing lots of talks</font>

221
00:15:31,600 --> 00:15:39,790
or nothing that<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> produced</font>

222
00:15:35,410 --> 00:15:43,000
something<font color="#E5E5E5"> and well I got annoyed by that</font>

223
00:15:39,790 --> 00:15:49,410
so I kept<font color="#CCCCCC"> the Smurfs</font>

224
00:15:43,000 --> 00:15:52,750
or forbid<font color="#E5E5E5"> Ronnie for years and it works</font>

225
00:15:49,410 --> 00:15:54,760
<font color="#CCCCCC">people still continue</font><font color="#E5E5E5"> we must use</font><font color="#CCCCCC"> get</font>

226
00:15:52,750 --> 00:15:59,290
but we<font color="#E5E5E5"> aren't willing to actually do</font>

227
00:15:54,760 --> 00:16:03,610
<font color="#E5E5E5">anything so I was I was sitting down and</font>

228
00:15:59,290 --> 00:16:05,920
see<font color="#CCCCCC"> oh</font><font color="#E5E5E5"> well I don't</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> want get I'm</font>

229
00:16:03,610 --> 00:16:09,250
quite okay with mercurial<font color="#E5E5E5"> but our last</font>

230
00:16:05,920 --> 00:16:12,099
time didn't work<font color="#E5E5E5"> so well</font><font color="#CCCCCC"> so let let's</font>

231
00:16:09,250 --> 00:16:16,300
sit<font color="#CCCCCC"> down and see what changed</font><font color="#E5E5E5"> on the</font>

232
00:16:12,100 --> 00:16:21,399
material side<font color="#E5E5E5"> of things and well let's</font>

233
00:16:16,300 --> 00:16:23,949
<font color="#E5E5E5">let's take a look there was this famous</font>

234
00:16:21,399 --> 00:16:26,290
Microsoft guy with developers developers

235
00:16:23,949 --> 00:16:29,339
to develop a so what<font color="#E5E5E5"> what do we actually</font>

236
00:16:26,290 --> 00:16:33,430
need<font color="#CCCCCC"> if you</font><font color="#E5E5E5"> want to switch what are our</font>

237
00:16:29,339 --> 00:16:34,899
requirements<font color="#E5E5E5"> the first one are always</font>

238
00:16:33,430 --> 00:16:37,388
<font color="#CCCCCC">whilst we</font><font color="#E5E5E5"> should have the version</font>

239
00:16:34,899 --> 00:16:42,720
<font color="#CCCCCC">control system in the base system</font><font color="#E5E5E5"> you</font>

240
00:16:37,389 --> 00:16:45,699
know<font color="#E5E5E5"> screw that</font><font color="#CCCCCC"> I don't care I don't see</font>

241
00:16:42,720 --> 00:16:47,740
the point for<font color="#E5E5E5"> having any version control</font>

242
00:16:45,699 --> 00:16:50,979
system in the base in the base<font color="#E5E5E5"> system</font>

243
00:16:47,740 --> 00:16:54,760
it's not<font color="#CCCCCC"> really</font><font color="#E5E5E5"> required it</font><font color="#CCCCCC"> shouldn't be</font>

244
00:16:50,980 --> 00:16:58,740
<font color="#CCCCCC">required to</font><font color="#E5E5E5"> do sensible things like</font>

245
00:16:54,760 --> 00:17:01,779
<font color="#E5E5E5">updating your system so ignore</font><font color="#CCCCCC"> that</font>

246
00:16:58,740 --> 00:17:04,929
<font color="#E5E5E5">which also</font><font color="#CCCCCC"> sidesteps a real</font><font color="#E5E5E5"> discussion</font>

247
00:17:01,779 --> 00:17:08,020
about<font color="#E5E5E5"> all we need to import or</font><font color="#CCCCCC"> Python or</font>

248
00:17:04,929 --> 00:17:11,020
<font color="#E5E5E5">we need to import or Paul or we need to</font>

249
00:17:08,020 --> 00:17:13,000
import - or<font color="#E5E5E5"> whatever dependency the</font>

250
00:17:11,020 --> 00:17:17,079
version<font color="#E5E5E5"> control system has so let's</font>

251
00:17:13,000 --> 00:17:23,368
<font color="#E5E5E5">ignore that we don't want to have proper</font>

252
00:17:17,079 --> 00:17:24,750
branches simply because doing any

253
00:17:23,368 --> 00:17:27,010
[Music]

254
00:17:24,750 --> 00:17:28,870
operating system project<font color="#CCCCCC"> without</font>

255
00:17:27,010 --> 00:17:33,100
branches<font color="#E5E5E5"> especially for release</font>

256
00:17:28,870 --> 00:17:35,199
management<font color="#E5E5E5"> and so</font><font color="#CCCCCC"> on is</font><font color="#E5E5E5"> just insane</font><font color="#CCCCCC"> so</font>

257
00:17:33,100 --> 00:17:38,260
<font color="#E5E5E5">well you need to check out if it works</font>

258
00:17:35,200 --> 00:17:41,590
<font color="#E5E5E5">or not and what if it doesn't work what</font>

259
00:17:38,260 --> 00:17:43,390
is necessary of<font color="#E5E5E5"> course we still want</font><font color="#CCCCCC"> to</font>

260
00:17:41,590 --> 00:17:47,139
have<font color="#CCCCCC"> the incremental conversion during</font>

261
00:17:43,390 --> 00:17:49,160
<font color="#E5E5E5">the test phase and it's also quite</font>

262
00:17:47,140 --> 00:17:53,030
important<font color="#CCCCCC"> to work on</font>

263
00:17:49,160 --> 00:17:56,840
<font color="#CCCCCC">or smaller machines for example West</font>

264
00:17:53,030 --> 00:18:00,770
Park West patio<font color="#E5E5E5"> pie only has so much</font>

265
00:17:56,840 --> 00:18:02,209
memory and also<font color="#CCCCCC"> not necessarily the</font>

266
00:18:00,770 --> 00:18:05,840
fastest when it comes to<font color="#E5E5E5"> disk</font>

267
00:18:02,210 --> 00:18:10,190
performance and a lot<font color="#CCCCCC"> of other all the</font>

268
00:18:05,840 --> 00:18:13,909
machines have quite similar restrictions

269
00:18:10,190 --> 00:18:20,900
<font color="#CCCCCC">it doesn't mean that</font><font color="#E5E5E5"> I care about doing</font>

270
00:18:13,910 --> 00:18:24,520
<font color="#E5E5E5">development on things</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> that was</font>

271
00:18:20,900 --> 00:18:27,860
maybe 32<font color="#E5E5E5"> or 64 megabyte of RAM</font><font color="#CCCCCC"> but</font>

272
00:18:24,520 --> 00:18:36,050
<font color="#E5E5E5">should</font><font color="#CCCCCC"> still</font><font color="#E5E5E5"> be possible to get</font><font color="#CCCCCC"> the tree</font>

273
00:18:27,860 --> 00:18:43,159
on a decently machine so what's the

274
00:18:36,050 --> 00:18:46,550
current<font color="#E5E5E5"> state to passing projects one is</font>

275
00:18:43,160 --> 00:18:50,240
for handling the the fast imports

276
00:18:46,550 --> 00:18:52,790
<font color="#E5E5E5">tooling or from get and passing it and</font>

277
00:18:50,240 --> 00:18:56,540
providing an interface<font color="#CCCCCC"> and acting with</font>

278
00:18:52,790 --> 00:18:59,710
<font color="#CCCCCC">it and there's a mercurial extension on</font>

279
00:18:56,540 --> 00:19:08,530
top of that which basically provides<font color="#E5E5E5"> a</font>

280
00:18:59,710 --> 00:19:11,500
convert sauce it works for branches just

281
00:19:08,530 --> 00:19:14,480
like<font color="#CCCCCC"> it wants to so it basically</font><font color="#E5E5E5"> turns</font>

282
00:19:11,500 --> 00:19:18,010
the git branch into real mercurial

283
00:19:14,480 --> 00:19:23,840
branch<font color="#E5E5E5"> by delaying some stuff and then</font>

284
00:19:18,010 --> 00:19:29,390
perfect the material<font color="#E5E5E5"> first imported</font>

285
00:19:23,840 --> 00:19:34,850
<font color="#CCCCCC">pension works</font><font color="#E5E5E5"> not very fast and</font><font color="#CCCCCC"> more</font>

286
00:19:29,390 --> 00:19:37,580
importantly<font color="#E5E5E5"> whenever saw a</font><font color="#CCCCCC"> blob command</font>

287
00:19:34,850 --> 00:19:39,790
<font color="#E5E5E5">and we get a fast import stream it would</font>

288
00:19:37,580 --> 00:19:43,699
create a file in<font color="#E5E5E5"> a temporary directory</font>

289
00:19:39,790 --> 00:19:47,750
<font color="#E5E5E5">this is okay if you have like 50,000</font>

290
00:19:43,700 --> 00:19:48,290
changes in India repository<font color="#E5E5E5"> it doesn't</font>

291
00:19:47,750 --> 00:19:50,080
<font color="#E5E5E5">scale</font>

292
00:19:48,290 --> 00:19:52,570
if you

293
00:19:50,080 --> 00:19:56,289
have a million changes and what<font color="#CCCCCC"> secured</font>

294
00:19:52,570 --> 00:20:00,039
<font color="#CCCCCC">a million</font><font color="#E5E5E5"> files</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> fact one directory</font><font color="#CCCCCC"> so</font>

295
00:19:56,289 --> 00:20:04,570
first first attempts<font color="#E5E5E5"> where to basically</font>

296
00:20:00,039 --> 00:20:09,580
create a hash tree<font color="#CCCCCC"> and later I just went</font>

297
00:20:04,570 --> 00:20:11,590
with<font color="#E5E5E5"> a secure database again it's just</font>

298
00:20:09,580 --> 00:20:17,860
so much easier to<font color="#CCCCCC"> have only a single</font>

299
00:20:11,590 --> 00:20:21,299
file<font color="#CCCCCC"> once you have</font><font color="#E5E5E5"> that it's also quite</font>

300
00:20:17,860 --> 00:20:24,519
easy<font color="#CCCCCC"> to fix</font><font color="#E5E5E5"> it with many problems</font><font color="#CCCCCC"> to get</font>

301
00:20:21,299 --> 00:20:29,429
incremental operations working<font color="#E5E5E5"> the</font>

302
00:20:24,519 --> 00:20:35,549
biggest<font color="#E5E5E5"> problem was that was originally</font>

303
00:20:29,429 --> 00:20:35,549
the extension<font color="#E5E5E5"> was preserving the</font>

304
00:20:35,610 --> 00:20:43,809
modifier<font color="#E5E5E5"> in the fast import stream for</font>

305
00:20:41,399 --> 00:20:46,059
revision<font color="#CCCCCC"> based ends</font><font color="#E5E5E5"> or some true that</font>

306
00:20:43,809 --> 00:20:51,370
while this<font color="#E5E5E5"> is something stable on the</font>

307
00:20:46,059 --> 00:20:54,190
south side but<font color="#CCCCCC"> FSA is actually creating</font>

308
00:20:51,370 --> 00:20:57,010
<font color="#E5E5E5">this one as a ghost based on the current</font>

309
00:20:54,190 --> 00:20:59,500
<font color="#CCCCCC">database name</font><font color="#E5E5E5"> so if you</font><font color="#CCCCCC"> recreated the</font>

310
00:20:57,010 --> 00:21:01,779
original repository<font color="#CCCCCC"> you would get</font>

311
00:20:59,500 --> 00:21:03,909
<font color="#E5E5E5">different identifiers</font><font color="#CCCCCC"> this different</font>

312
00:21:01,779 --> 00:21:07,240
identifiers would leak<font color="#E5E5E5"> onto the</font>

313
00:21:03,909 --> 00:21:10,750
mercurial side as<font color="#CCCCCC"> metadata</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font>

314
00:21:07,240 --> 00:21:14,740
<font color="#CCCCCC">commits and therefore the commit IDs</font>

315
00:21:10,750 --> 00:21:17,380
would end up being different<font color="#CCCCCC"> and turns</font>

316
00:21:14,740 --> 00:21:22,149
out<font color="#E5E5E5"> packet is not very happy if</font><font color="#CCCCCC"> you have</font>

317
00:21:17,380 --> 00:21:28,179
<font color="#E5E5E5">more than a couple</font><font color="#CCCCCC"> of thousand pet</font>

318
00:21:22,149 --> 00:21:32,459
revisions<font color="#E5E5E5"> and branches because HTTP</font>

319
00:21:28,179 --> 00:21:34,600
header sizes are sometimes limited<font color="#E5E5E5"> by</font>

320
00:21:32,460 --> 00:21:38,889
proxy components and things<font color="#E5E5E5"> like that</font>

321
00:21:34,600 --> 00:21:43,600
<font color="#E5E5E5">and if you have too many hats they will</font>

322
00:21:38,889 --> 00:21:49,840
blow up<font color="#E5E5E5"> when you try to</font><font color="#CCCCCC"> catch something</font>

323
00:21:43,600 --> 00:21:52,990
and not<font color="#E5E5E5"> very happy</font><font color="#CCCCCC"> but what we are now</font>

324
00:21:49,840 --> 00:21:57,220
at<font color="#E5E5E5"> the point where</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> 399 branches and</font>

325
00:21:52,990 --> 00:21:59,350
<font color="#CCCCCC">at PST can be found on bit packet you</font>

326
00:21:57,220 --> 00:22:00,340
<font color="#CCCCCC">can actually look at them which</font><font color="#E5E5E5"> is</font>

327
00:21:59,350 --> 00:22:03,399
<font color="#E5E5E5">something that</font>

328
00:22:00,340 --> 00:22:06,580
work for a<font color="#E5E5E5"> couple of years on</font><font color="#CCCCCC"> DTaP</font><font color="#E5E5E5"> you</font>

329
00:22:03,400 --> 00:22:10,750
would always get<font color="#E5E5E5"> a</font><font color="#CCCCCC"> timeout when you open</font>

330
00:22:06,580 --> 00:22:13,330
the branch page and they fixed it in the

331
00:22:10,750 --> 00:22:18,520
meantime<font color="#CCCCCC"> by actually offering pagination</font>

332
00:22:13,330 --> 00:22:20,949
but that<font color="#E5E5E5"> chips surprisingly long estate</font>

333
00:22:18,520 --> 00:22:22,900
<font color="#E5E5E5">since I</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> have a pagination for</font>

334
00:22:20,950 --> 00:22:27,179
directory listings which is a<font color="#E5E5E5"> problem</font>

335
00:22:22,900 --> 00:22:27,179
<font color="#E5E5E5">for packaged source in some cases but</font>

336
00:22:27,960 --> 00:22:36,399
the repository we have now is comparable

337
00:22:31,740 --> 00:22:42,390
<font color="#E5E5E5">in size and complexity toward Mozilla</font>

338
00:22:36,399 --> 00:22:45,279
<font color="#CCCCCC">house</font><font color="#E5E5E5"> which is the biggest mainstream</font>

339
00:22:42,390 --> 00:22:45,970
open source repository<font color="#CCCCCC"> in mercurial</font>

340
00:22:45,279 --> 00:22:52,690
right now

341
00:22:45,970 --> 00:22:56,529
so we<font color="#E5E5E5"> had pretty similar issues in some</font>

342
00:22:52,690 --> 00:23:00,370
cases so there are also quite happy if

343
00:22:56,529 --> 00:23:03,899
<font color="#CCCCCC">we are fixing things there are a couple</font>

344
00:23:00,370 --> 00:23:06,639
of<font color="#E5E5E5"> larger repositories with mercurial</font>

345
00:23:03,899 --> 00:23:10,830
Facebook for example but<font color="#E5E5E5"> Facebook also</font>

346
00:23:06,640 --> 00:23:15,429
has its own server implementation so

347
00:23:10,830 --> 00:23:22,178
things<font color="#E5E5E5"> a bit different but what we can</font>

348
00:23:15,429 --> 00:23:26,080
do with<font color="#E5E5E5"> this tree how does</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> work so</font>

349
00:23:22,179 --> 00:23:27,190
let's take a look<font color="#E5E5E5"> at cloning</font><font color="#CCCCCC"> well not</font>

350
00:23:26,080 --> 00:23:29,439
really

351
00:23:27,190 --> 00:23:34,690
the interesting<font color="#E5E5E5"> part</font><font color="#CCCCCC"> about the mercurial</font>

352
00:23:29,440 --> 00:23:38,980
design is<font color="#CCCCCC"> a couple of</font><font color="#E5E5E5"> things that share</font>

353
00:23:34,690 --> 00:23:42,039
<font color="#CCCCCC">the same code and just have a bit</font>

354
00:23:38,980 --> 00:23:44,850
different plumbing<font color="#E5E5E5"> and clone is one of</font>

355
00:23:42,039 --> 00:23:49,260
them so basically cloning and pulling

356
00:23:44,850 --> 00:23:53,080
<font color="#E5E5E5">goes through almost the same code and</font>

357
00:23:49,260 --> 00:23:58,360
for<font color="#CCCCCC"> changes you can basically simulate</font>

358
00:23:53,080 --> 00:24:00,158
what the the<font color="#E5E5E5"> network based communication</font>

359
00:23:58,360 --> 00:24:05,350
is doing<font color="#CCCCCC"> they're just</font><font color="#E5E5E5"> creating a bundle</font>

360
00:24:00,159 --> 00:24:08,549
and asking if the system was<font color="#CCCCCC"> unbundle to</font>

361
00:24:05,350 --> 00:24:09,990
apply it locally<font color="#CCCCCC"> the</font><font color="#E5E5E5"> only difference is</font>

362
00:24:08,549 --> 00:24:12,900
differences

363
00:24:09,990 --> 00:24:15,360
clone or<font color="#E5E5E5"> poor which creates a spangled</font>

364
00:24:12,900 --> 00:24:19,590
dynamically<font color="#E5E5E5"> whereas we</font><font color="#CCCCCC"> can actually</font>

365
00:24:15,360 --> 00:24:22,129
create<font color="#CCCCCC"> it offline and this has the very</font>

366
00:24:19,590 --> 00:24:25,409
nice advantage that you have<font color="#CCCCCC"> a easy</font>

367
00:24:22,130 --> 00:24:29,150
<font color="#CCCCCC">reproduce ability which is</font><font color="#E5E5E5"> very</font>

368
00:24:25,410 --> 00:24:32,300
important if you<font color="#CCCCCC"> want to benchmark sings</font>

369
00:24:29,150 --> 00:24:38,490
<font color="#CCCCCC">this thing's</font><font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> well there's one</font>

370
00:24:32,300 --> 00:24:42,270
<font color="#E5E5E5">exception if you do streaming clones</font><font color="#CCCCCC"> it</font>

371
00:24:38,490 --> 00:24:48,360
will not create an actual in the normal

372
00:24:42,270 --> 00:24:50,070
way but<font color="#CCCCCC"> basically tar up the repository</font>

373
00:24:48,360 --> 00:24:54,830
on the server side send it to the client

374
00:24:50,070 --> 00:24:57,450
<font color="#E5E5E5">and the kind</font><font color="#CCCCCC"> just extracted which has a</font>

375
00:24:54,830 --> 00:25:00,419
<font color="#E5E5E5">number of implications we'll come back</font>

376
00:24:57,450 --> 00:25:03,480
to that later<font color="#CCCCCC"> so the primary</font><font color="#E5E5E5"> sense of</font>

377
00:25:00,420 --> 00:25:06,780
interest for<font color="#E5E5E5"> me are the memory</font><font color="#CCCCCC"> use on</font>

378
00:25:03,480 --> 00:25:10,320
the client<font color="#CCCCCC"> because that's the one</font>

379
00:25:06,780 --> 00:25:13,350
resource that<font color="#CCCCCC"> we can't fix I'm in CPU</font>

380
00:25:10,320 --> 00:25:16,020
time you can<font color="#CCCCCC"> always wait</font><font color="#E5E5E5"> a bit longer</font><font color="#CCCCCC"> if</font>

381
00:25:13,350 --> 00:25:19,290
it<font color="#E5E5E5"> needs</font><font color="#CCCCCC"> too much</font><font color="#E5E5E5"> run and goes into</font>

382
00:25:16,020 --> 00:25:22,800
heavy swapping or you<font color="#E5E5E5"> don't want to wait</font>

383
00:25:19,290 --> 00:25:24,800
that<font color="#CCCCCC"> long and the other important</font><font color="#E5E5E5"> part</font>

384
00:25:22,800 --> 00:25:28,080
of course is network bandwidth<font color="#E5E5E5"> because</font>

385
00:25:24,800 --> 00:25:31,649
while we are not<font color="#E5E5E5"> Facebook</font><font color="#CCCCCC"> we are not to</font>

386
00:25:28,080 --> 00:25:34,949
do we have quite a few<font color="#E5E5E5"> constraints on</font>

387
00:25:31,650 --> 00:25:39,120
how<font color="#CCCCCC"> much all servers</font><font color="#E5E5E5"> can actually send</font>

388
00:25:34,950 --> 00:25:42,780
our what is only of secondary interest

389
00:25:39,120 --> 00:25:46,830
<font color="#E5E5E5">is CPU load on client and server on the</font>

390
00:25:42,780 --> 00:25:50,129
client<font color="#CCCCCC"> or get a faster machine if you</font>

391
00:25:46,830 --> 00:25:53,159
don't want to wait on the server<font color="#E5E5E5"> right</font>

392
00:25:50,130 --> 00:25:55,550
<font color="#E5E5E5">now we hope that it simply won't matter</font>

393
00:25:53,160 --> 00:25:55,550
enough

394
00:25:59,340 --> 00:26:08,509
so<font color="#CCCCCC"> as</font><font color="#E5E5E5"> baseline</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> creating a</font><font color="#CCCCCC"> bundle of</font>

395
00:26:03,990 --> 00:26:14,970
the repository<font color="#E5E5E5"> compress it</font><font color="#CCCCCC"> with</font>

396
00:26:08,509 --> 00:26:18,659
<font color="#E5E5E5">Facebook's</font><font color="#CCCCCC"> and SST level 2022 so pretty</font>

397
00:26:14,970 --> 00:26:24,240
much the biggest<font color="#CCCCCC"> possible</font><font color="#E5E5E5"> use whatever</font>

398
00:26:18,659 --> 00:26:26,549
<font color="#E5E5E5">large we know you can and this</font>

399
00:26:24,240 --> 00:26:30,509
compresses all pretty<font color="#E5E5E5"> well I mean we get</font>

400
00:26:26,549 --> 00:26:33,450
a bundle size of 840 megabyte or which

401
00:26:30,509 --> 00:26:37,409
<font color="#E5E5E5">is quite</font><font color="#CCCCCC"> good especially if you compare</font>

402
00:26:33,450 --> 00:26:39,539
to<font color="#E5E5E5"> simply compressing or the</font><font color="#CCCCCC"> OCS files</font>

403
00:26:37,409 --> 00:26:45,320
for example<font color="#E5E5E5"> it's those are actually</font>

404
00:26:39,539 --> 00:26:49,619
larger and trying to apply<font color="#E5E5E5"> that bundle</font>

405
00:26:45,320 --> 00:26:53,129
<font color="#CCCCCC">for the the old release version of</font>

406
00:26:49,619 --> 00:26:57,899
<font color="#CCCCCC">Mercurio required something like 827</font>

407
00:26:53,129 --> 00:27:00,570
megabyte on AMD 64<font color="#E5E5E5"> needed something like</font>

408
00:26:57,899 --> 00:27:04,439
eight<font color="#E5E5E5"> and a half minutes</font><font color="#CCCCCC"> and that was</font>

409
00:27:00,570 --> 00:27:07,340
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> so what's</font><font color="#E5E5E5"> going on here let's try</font>

410
00:27:04,440 --> 00:27:11,909
<font color="#CCCCCC">to take a look and turns out there was</font>

411
00:27:07,340 --> 00:27:14,730
<font color="#CCCCCC">an index being kept off the</font><font color="#E5E5E5"> but deficits</font>

412
00:27:11,909 --> 00:27:18,389
in the bundle<font color="#CCCCCC"> for every commit and every</font>

413
00:27:14,730 --> 00:27:19,470
file and so on<font color="#E5E5E5"> and nothing really used</font>

414
00:27:18,389 --> 00:27:24,629
<font color="#E5E5E5">that index</font>

415
00:27:19,470 --> 00:27:28,369
<font color="#E5E5E5">so</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> 118 megabyte a completely</font>

416
00:27:24,629 --> 00:27:32,039
useless data and that was fixed<font color="#CCCCCC"> and</font>

417
00:27:28,369 --> 00:27:36,449
since then we had<font color="#E5E5E5"> just a bit over six</font>

418
00:27:32,039 --> 00:27:39,299
hundred megabyte of<font color="#CCCCCC"> pic memory use it</font>

419
00:27:36,450 --> 00:27:40,999
<font color="#E5E5E5">even got a bit faster</font><font color="#CCCCCC"> so that was very</font>

420
00:27:39,299 --> 00:27:44,759
<font color="#CCCCCC">good</font>

421
00:27:40,999 --> 00:27:48,809
<font color="#CCCCCC">one of this one</font><font color="#E5E5E5"> of the concerns were</font>

422
00:27:44,759 --> 00:27:51,090
that the<font color="#E5E5E5"> large window</font><font color="#CCCCCC"> and from</font><font color="#E5E5E5"> the</font>

423
00:27:48,809 --> 00:27:53,700
compression algorithm is also<font color="#E5E5E5"> going to</font>

424
00:27:51,090 --> 00:27:55,110
increase memory<font color="#E5E5E5"> use patterns</font><font color="#CCCCCC"> order it</font>

425
00:27:53,700 --> 00:27:59,179
<font color="#E5E5E5">has almost no impact</font>

426
00:27:55,110 --> 00:27:59,178
so our perfect

427
00:28:01,480 --> 00:28:08,769
so let's take a more detailed look into

428
00:28:04,929 --> 00:28:12,279
<font color="#E5E5E5">what happened</font><font color="#CCCCCC"> asshole a</font><font color="#E5E5E5"> linear increase</font>

429
00:28:08,769 --> 00:28:14,860
<font color="#E5E5E5">of the the process size over time so</font><font color="#CCCCCC"> it</font>

430
00:28:12,279 --> 00:28:17,370
<font color="#E5E5E5">definitely the bookkeeping or things</font>

431
00:28:14,860 --> 00:28:17,370
going on

432
00:28:17,760 --> 00:28:24,720
once you find<font color="#E5E5E5"> very soon as that person</font>

433
00:28:21,340 --> 00:28:29,350
<font color="#CCCCCC">has a surprisingly large overhead for</font>

434
00:28:24,720 --> 00:28:32,260
objects<font color="#CCCCCC"> any number any string or</font>

435
00:28:29,350 --> 00:28:35,709
basically requires at least<font color="#CCCCCC"> thirty</font><font color="#E5E5E5"> to</font>

436
00:28:32,260 --> 00:28:39,639
<font color="#CCCCCC">five bytes</font><font color="#E5E5E5"> of memory or integers</font>

437
00:28:35,710 --> 00:28:41,679
sometimes go into<font color="#E5E5E5"> 24</font><font color="#CCCCCC"> bite but it's</font><font color="#E5E5E5"> still</font>

438
00:28:39,639 --> 00:28:47,949
much higher overhead than you would

439
00:28:41,679 --> 00:28:50,940
expect<font color="#CCCCCC"> in C and the main memory</font><font color="#E5E5E5"> hawk</font>

440
00:28:47,950 --> 00:28:55,000
<font color="#E5E5E5">that remains</font><font color="#CCCCCC"> as a transaction</font><font color="#E5E5E5"> object</font>

441
00:28:50,940 --> 00:28:58,059
<font color="#E5E5E5">itself</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> basically a</font><font color="#CCCCCC"> mercurial keeps</font>

442
00:28:55,000 --> 00:29:01,360
track of<font color="#E5E5E5"> the changes it's currently</font>

443
00:28:58,059 --> 00:29:04,570
<font color="#E5E5E5">trying to apply so if it has to abort</font><font color="#CCCCCC"> it</font>

444
00:29:01,360 --> 00:29:06,969
can be reset everything<font color="#CCCCCC"> and</font><font color="#E5E5E5"> also our</font>

445
00:29:04,570 --> 00:29:10,178
various extensions<font color="#CCCCCC"> use this transaction</font>

446
00:29:06,970 --> 00:29:14,049
<font color="#E5E5E5">object to figure out what what changed</font>

447
00:29:10,179 --> 00:29:16,840
so you can for example<font color="#CCCCCC"> sent sent an</font>

448
00:29:14,049 --> 00:29:19,179
email on incoming<font color="#CCCCCC"> changes things</font><font color="#E5E5E5"> like</font>

449
00:29:16,840 --> 00:29:22,840
that and they need<font color="#E5E5E5"> to know of</font><font color="#CCCCCC"> course</font>

450
00:29:19,179 --> 00:29:25,360
what happened as well and<font color="#E5E5E5"> this</font>

451
00:29:22,840 --> 00:29:28,779
transaction<font color="#CCCCCC"> object uses something</font><font color="#E5E5E5"> like</font>

452
00:29:25,360 --> 00:29:30,879
<font color="#CCCCCC">200 megabyte or out of the</font><font color="#E5E5E5"> 600</font><font color="#CCCCCC"> so</font>

453
00:29:28,779 --> 00:29:36,809
there's quite a lot of<font color="#E5E5E5"> potential for</font>

454
00:29:30,880 --> 00:29:40,380
fixing that the the phase transitions

455
00:29:36,809 --> 00:29:45,129
<font color="#CCCCCC">take about</font><font color="#E5E5E5"> 40 megabytes</font>

456
00:29:40,380 --> 00:29:49,029
I'm looking at almost completely

457
00:29:45,130 --> 00:29:51,549
eliminating<font color="#E5E5E5"> this the truncation Maps</font>

458
00:29:49,029 --> 00:29:55,240
<font color="#E5E5E5">where we're basically keeps track of</font><font color="#CCCCCC"> or</font>

459
00:29:51,549 --> 00:29:58,389
with which<font color="#E5E5E5"> repository file got new data</font>

460
00:29:55,240 --> 00:30:02,799
<font color="#E5E5E5">and where was</font><font color="#CCCCCC"> before need</font><font color="#E5E5E5"> something like</font>

461
00:29:58,389 --> 00:30:06,010
17 megabytes<font color="#CCCCCC"> packed</font><font color="#E5E5E5"> parts</font><font color="#CCCCCC"> read where</font>

462
00:30:02,799 --> 00:30:08,500
mercurial would stop using one file for

463
00:30:06,010 --> 00:30:11,879
<font color="#E5E5E5">every person the repository would help</font>

464
00:30:08,500 --> 00:30:14,250
to remove most of that it's tricky<font color="#E5E5E5"> and</font>

465
00:30:11,879 --> 00:30:18,090
going directly<font color="#CCCCCC"> to the on this</font>

466
00:30:14,250 --> 00:30:23,080
for the files would also have<font color="#CCCCCC"> help</font><font color="#E5E5E5"> but</font>

467
00:30:18,090 --> 00:30:26,649
<font color="#CCCCCC">they all have some implications for that</font>

468
00:30:23,080 --> 00:30:28,659
are very deep<font color="#CCCCCC"> so this is nothing easy</font>

469
00:30:26,650 --> 00:30:35,049
thing to fix but it's something<font color="#E5E5E5"> we are</font>

470
00:30:28,660 --> 00:30:37,240
<font color="#CCCCCC">looking at one thing</font><font color="#E5E5E5"> I was testing is</font>

471
00:30:35,049 --> 00:30:41,470
what what happened if we don't applied

472
00:30:37,240 --> 00:30:46,720
the history in one<font color="#E5E5E5"> go but basically</font>

473
00:30:41,470 --> 00:30:50,679
slice up the history<font color="#E5E5E5"> into yearly changes</font>

474
00:30:46,720 --> 00:30:54,450
<font color="#CCCCCC">what this overhead of course and less</font>

475
00:30:50,679 --> 00:30:59,049
redundancy for the compression to remove

476
00:30:54,450 --> 00:31:03,880
it also helps a lot<font color="#E5E5E5"> to reduce the memory</font>

477
00:30:59,049 --> 00:31:08,549
<font color="#E5E5E5">use so with that we</font><font color="#CCCCCC"> are a bit slower</font><font color="#E5E5E5"> but</font>

478
00:31:03,880 --> 00:31:11,320
take<font color="#E5E5E5"> only about 360 megabyte of</font><font color="#CCCCCC"> memory</font>

479
00:31:08,549 --> 00:31:18,070
<font color="#CCCCCC">this is</font><font color="#E5E5E5"> mostly because the transactions</font>

480
00:31:11,320 --> 00:31:20,590
<font color="#CCCCCC">themselves are smaller I mentioned</font>

481
00:31:18,070 --> 00:31:24,700
earlier there's a special options for

482
00:31:20,590 --> 00:31:29,020
cloning or the streaming clones<font color="#E5E5E5"> for</font>

483
00:31:24,700 --> 00:31:32,350
testing this was done over the<font color="#E5E5E5"> local</font><font color="#CCCCCC"> the</font>

484
00:31:29,020 --> 00:31:35,049
local<font color="#E5E5E5"> interface</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> has to transfer all</font>

485
00:31:32,350 --> 00:31:38,709
the files<font color="#E5E5E5"> all without removing</font>

486
00:31:35,049 --> 00:31:41,830
redundancy between<font color="#E5E5E5"> the fight so it it's</font>

487
00:31:38,710 --> 00:31:46,679
going<font color="#E5E5E5"> to transfer a lot more at the same</font>

488
00:31:41,830 --> 00:31:48,460
at<font color="#E5E5E5"> the</font><font color="#CCCCCC"> same time</font><font color="#E5E5E5"> it's also quite dumb so</font>

489
00:31:46,679 --> 00:31:51,730
for the client

490
00:31:48,460 --> 00:31:55,990
he's only<font color="#CCCCCC"> having</font><font color="#E5E5E5"> 60 megabyte which is</font>

491
00:31:51,730 --> 00:32:02,890
much better<font color="#E5E5E5"> than did if you</font><font color="#CCCCCC"> ask it to</font>

492
00:31:55,990 --> 00:32:05,830
ignore all the history<font color="#E5E5E5"> and this is</font>

493
00:32:02,890 --> 00:32:07,960
normally only attractive<font color="#CCCCCC"> if you are for</font>

494
00:32:05,830 --> 00:32:11,439
a very<font color="#E5E5E5"> fast network connection to the</font>

495
00:32:07,960 --> 00:32:16,820
server<font color="#CCCCCC"> well it turns out it's also</font>

496
00:32:11,440 --> 00:32:20,990
helpful<font color="#CCCCCC"> or if</font><font color="#E5E5E5"> you want to reduce with</font>

497
00:32:16,820 --> 00:32:22,939
or on the client<font color="#E5E5E5"> and it hasn't all or</font>

498
00:32:20,990 --> 00:32:25,070
<font color="#CCCCCC">nothing selectivity you can base you</font>

499
00:32:22,940 --> 00:32:29,440
can't basically say<font color="#E5E5E5"> I want</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> one</font>

500
00:32:25,070 --> 00:32:32,600
branch or<font color="#E5E5E5"> so which is a restriction and</font>

501
00:32:29,440 --> 00:32:36,170
the server<font color="#E5E5E5"> the client</font><font color="#CCCCCC"> has have to be</font>

502
00:32:32,600 --> 00:32:39,530
pretty pretty much<font color="#E5E5E5"> comfortable in the</font>

503
00:32:36,170 --> 00:32:43,790
repository<font color="#CCCCCC"> for month</font><font color="#E5E5E5"> they are using so</font>

504
00:32:39,530 --> 00:32:51,379
this would<font color="#CCCCCC"> also mean keeping them mostly</font>

505
00:32:43,790 --> 00:32:54,139
<font color="#E5E5E5">and think this was actually actually a</font>

506
00:32:51,380 --> 00:32:58,070
bit annoying<font color="#E5E5E5"> when I was doing the</font>

507
00:32:54,140 --> 00:33:00,380
testing<font color="#E5E5E5"> and preparation</font><font color="#CCCCCC"> for this talk</font><font color="#E5E5E5"> so</font>

508
00:32:58,070 --> 00:33:04,580
we are talking<font color="#CCCCCC"> about the fully</font><font color="#E5E5E5"> cache</font>

509
00:33:00,380 --> 00:33:07,510
case and we are looking<font color="#E5E5E5"> at the</font>

510
00:33:04,580 --> 00:33:09,800
differences between<font color="#E5E5E5"> two new PST branches</font>

511
00:33:07,510 --> 00:33:13,129
<font color="#CCCCCC">that</font><font color="#E5E5E5"> actually do for something like</font>

512
00:33:09,800 --> 00:33:18,169
<font color="#CCCCCC">eight hundred</font><font color="#E5E5E5"> megabytes</font><font color="#CCCCCC"> so it's expected</font>

513
00:33:13,130 --> 00:33:22,640
<font color="#CCCCCC">to take a bit but turns out</font><font color="#E5E5E5"> mercurial</font>

514
00:33:18,170 --> 00:33:27,380
was surprisingly slow<font color="#E5E5E5"> yeah like it took</font>

515
00:33:22,640 --> 00:33:31,970
three times as long as CVS and<font color="#E5E5E5"> yes</font>

516
00:33:27,380 --> 00:33:34,520
compared to get deep primal primary wins

517
00:33:31,970 --> 00:33:38,120
here because it has to do very<font color="#E5E5E5"> few</font>

518
00:33:34,520 --> 00:33:41,360
operations<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> DFS layer</font><font color="#E5E5E5"> the only has</font>

519
00:33:38,120 --> 00:33:44,919
to<font color="#E5E5E5"> open a handful of files and then use</font>

520
00:33:41,360 --> 00:33:48,139
<font color="#E5E5E5">memory mapping faxing accessing them</font>

521
00:33:44,920 --> 00:33:51,710
<font color="#E5E5E5">mercurial doesn't have that benefit at</font>

522
00:33:48,140 --> 00:33:54,830
the<font color="#E5E5E5"> moment we are looking at how it</font>

523
00:33:51,710 --> 00:33:59,510
could be<font color="#E5E5E5"> done but it's not</font><font color="#CCCCCC"> there yet</font>

524
00:33:54,830 --> 00:34:05,500
CVS<font color="#CCCCCC"> has one advantage here that the the</font>

525
00:33:59,510 --> 00:34:05,500
RCS format<font color="#CCCCCC"> basically keeps the diffs in</font>

526
00:34:05,530 --> 00:34:16,250
line base<font color="#E5E5E5"> so it can</font><font color="#CCCCCC"> actually a sidestep</font>

527
00:34:09,668 --> 00:34:21,350
<font color="#E5E5E5">quite a few computations here let's</font><font color="#CCCCCC"> go</font>

528
00:34:16,250 --> 00:34:24,590
<font color="#CCCCCC">file</font><font color="#E5E5E5"> it oh wow so terms of mercurial</font>

529
00:34:21,350 --> 00:34:26,918
spends about<font color="#CCCCCC"> seventy</font><font color="#E5E5E5"> percent</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

530
00:34:24,590 --> 00:34:32,740
execution<font color="#CCCCCC"> time of</font><font color="#E5E5E5"> the</font>

531
00:34:26,918 --> 00:34:37,989
<font color="#E5E5E5">of command writing output one of the</font>

532
00:34:32,739 --> 00:34:42,699
fixes was to basically<font color="#E5E5E5"> clustered</font><font color="#CCCCCC"> write</font>

533
00:34:37,989 --> 00:34:49,569
more aggressively so instead of<font color="#CCCCCC"> doing</font>

534
00:34:42,699 --> 00:34:57,759
one write output<font color="#E5E5E5"> it's going to do that</font>

535
00:34:49,569 --> 00:34:59,859
<font color="#E5E5E5">for 500,000 lines and this matters</font>

536
00:34:57,760 --> 00:35:01,809
because<font color="#CCCCCC"> while we had we are doing output</font>

537
00:34:59,859 --> 00:35:04,180
buffering that<font color="#E5E5E5"> output buffering is line</font>

538
00:35:01,809 --> 00:35:06,970
based and if you are sending<font color="#E5E5E5"> one</font><font color="#CCCCCC"> line</font>

539
00:35:04,180 --> 00:35:07,569
provide<font color="#E5E5E5"> it's effectively not bothering</font>

540
00:35:06,970 --> 00:35:11,078
at all

541
00:35:07,569 --> 00:35:17,079
so this basically cut<font color="#E5E5E5"> the time almost</font><font color="#CCCCCC"> in</font>

542
00:35:11,079 --> 00:35:20,200
half it helps<font color="#E5E5E5"> mercurial are also</font>

543
00:35:17,079 --> 00:35:22,119
important<font color="#CCCCCC"> to do a join of the buffer you</font>

544
00:35:20,200 --> 00:35:24,669
want to write and then<font color="#E5E5E5"> I'll write it in</font>

545
00:35:22,119 --> 00:35:26,710
<font color="#E5E5E5">one go so basically</font><font color="#CCCCCC"> you had doing one</font>

546
00:35:24,670 --> 00:35:30,880
allocation and<font color="#E5E5E5"> one right instead</font><font color="#CCCCCC"> of</font>

547
00:35:26,710 --> 00:35:33,180
doing<font color="#E5E5E5"> many small writes and we also did</font>

548
00:35:30,880 --> 00:35:38,010
a couple<font color="#E5E5E5"> of optimizations to the</font>

549
00:35:33,180 --> 00:35:41,649
algorithm<font color="#CCCCCC"> that's creating the dips</font><font color="#E5E5E5"> so</font>

550
00:35:38,010 --> 00:35:46,720
we're not<font color="#E5E5E5"> exactly at the</font><font color="#CCCCCC"> CVS time yet</font>

551
00:35:41,650 --> 00:35:50,170
<font color="#CCCCCC">but it's getting better</font><font color="#E5E5E5"> and now the time</font>

552
00:35:46,720 --> 00:35:52,839
<font color="#CCCCCC">is spent</font><font color="#E5E5E5"> on things like pausing the</font>

553
00:35:50,170 --> 00:35:53,799
repository which again it's not<font color="#CCCCCC"> that</font>

554
00:35:52,839 --> 00:35:56,700
easy to<font color="#E5E5E5"> fix</font>

555
00:35:53,799 --> 00:36:03,880
so the low-hanging<font color="#E5E5E5"> fruits are gone</font><font color="#CCCCCC"> but</font>

556
00:35:56,700 --> 00:36:06,720
we know what's work on<font color="#CCCCCC"> right the ref log</font>

557
00:36:03,880 --> 00:36:11,349
<font color="#CCCCCC">handling is basically the new hotspot</font>

558
00:36:06,720 --> 00:36:16,779
<font color="#CCCCCC">I'm looking at</font><font color="#E5E5E5"> doing proper indexing of</font>

559
00:36:11,349 --> 00:36:19,990
<font color="#E5E5E5">the defaults but it's difficult and of</font>

560
00:36:16,780 --> 00:36:22,000
course it's a bit annoying<font color="#E5E5E5"> that the</font>

561
00:36:19,990 --> 00:36:23,919
profiling<font color="#E5E5E5"> output will still show a</font>

562
00:36:22,000 --> 00:36:26,980
couple<font color="#E5E5E5"> of</font><font color="#CCCCCC"> functions</font><font color="#E5E5E5"> that are no longer</font>

563
00:36:23,920 --> 00:36:30,119
performance relevant simply because

564
00:36:26,980 --> 00:36:37,319
the instrumentation over had changes

565
00:36:30,119 --> 00:36:39,730
<font color="#E5E5E5">performance</font><font color="#CCCCCC"> the last big item is</font>

566
00:36:37,319 --> 00:36:42,460
<font color="#CCCCCC">mercurial has this feature</font><font color="#E5E5E5"> called clone</font>

567
00:36:39,730 --> 00:36:45,819
bundles<font color="#E5E5E5"> well when you do a clone or a</font>

568
00:36:42,460 --> 00:36:48,940
server basically<font color="#E5E5E5"> tells you you know my</font>

569
00:36:45,819 --> 00:36:51,579
administrator has prepared with nice

570
00:36:48,940 --> 00:36:56,380
bundles for you in advance<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can find</font>

571
00:36:51,579 --> 00:36:58,710
them at the following locations and you

572
00:36:56,380 --> 00:37:02,589
can put put them for example<font color="#CCCCCC"> on the CDN</font>

573
00:36:58,710 --> 00:37:05,710
<font color="#E5E5E5">instead of the main server the problem</font>

574
00:37:02,589 --> 00:37:09,460
is all this clone bundle support at the

575
00:37:05,710 --> 00:37:12,369
moment<font color="#E5E5E5"> assumes you have a second second</font>

576
00:37:09,460 --> 00:37:17,200
server that you are connecting to out of

577
00:37:12,369 --> 00:37:20,260
band there's a large file<font color="#CCCCCC"> extensions</font>

578
00:37:17,200 --> 00:37:25,058
some support for<font color="#E5E5E5"> in-stream or 10 minutes</font>

579
00:37:20,260 --> 00:37:28,359
now but<font color="#E5E5E5"> it's not</font><font color="#CCCCCC"> what we</font><font color="#E5E5E5"> really want to</font>

580
00:37:25,059 --> 00:37:32,140
have part of<font color="#E5E5E5"> the problem from</font><font color="#CCCCCC"> that PSD</font>

581
00:37:28,359 --> 00:37:37,210
<font color="#E5E5E5">is that CDN appears to dot</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> is hosted</font>

582
00:37:32,140 --> 00:37:40,210
by<font color="#E5E5E5"> a third party so we don't really</font>

583
00:37:37,210 --> 00:37:43,390
<font color="#E5E5E5">believe</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> fastly wants to hack us but</font>

584
00:37:40,210 --> 00:37:47,559
we don't<font color="#E5E5E5"> really put too much face into</font>

585
00:37:43,390 --> 00:37:51,490
them either<font color="#CCCCCC"> so it's a bit difficult</font><font color="#E5E5E5"> to</font>

586
00:37:47,559 --> 00:37:54,690
verify<font color="#E5E5E5"> that the cloning has actually</font>

587
00:37:51,490 --> 00:37:58,109
gotten<font color="#E5E5E5"> or this</font><font color="#CCCCCC"> stated</font><font color="#E5E5E5"> should have gotten</font>

588
00:37:54,690 --> 00:38:01,569
it's somewhat possible<font color="#CCCCCC"> to do it with</font>

589
00:37:58,109 --> 00:38:04,058
<font color="#E5E5E5">incoming and outgoing or commands to</font>

590
00:38:01,569 --> 00:38:08,230
basically see if we got more<font color="#CCCCCC"> or</font><font color="#E5E5E5"> less</font>

591
00:38:04,059 --> 00:38:12,280
than we should have<font color="#E5E5E5"> but it's not perfect</font>

592
00:38:08,230 --> 00:38:20,109
it doesn't<font color="#E5E5E5"> work well or with absolution</font>

593
00:38:12,280 --> 00:38:25,750
markers and things<font color="#E5E5E5"> like that</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> one idea</font>

594
00:38:20,109 --> 00:38:28,270
<font color="#CCCCCC">to fix out as</font><font color="#E5E5E5"> the operation on the the</font>

595
00:38:25,750 --> 00:38:33,970
wire protocol of<font color="#CCCCCC"> Mercurio basically</font>

596
00:38:28,270 --> 00:38:36,240
could just use a<font color="#CCCCCC"> precomputed fire</font><font color="#E5E5E5"> this</font>

597
00:38:33,970 --> 00:38:41,459
is essentially what

598
00:38:36,240 --> 00:38:43,770
<font color="#CCCCCC">vandals do and the server already</font><font color="#E5E5E5"> knows</font>

599
00:38:41,460 --> 00:38:46,020
what the client wants<font color="#CCCCCC"> the server already</font>

600
00:38:43,770 --> 00:38:49,740
<font color="#E5E5E5">knows what the sort of what the</font><font color="#CCCCCC"> client</font>

601
00:38:46,020 --> 00:38:53,040
has so it could select a<font color="#E5E5E5"> matching bundle</font>

602
00:38:49,740 --> 00:38:57,149
the only problem if the client might get

603
00:38:53,040 --> 00:38:58,770
<font color="#E5E5E5">a</font><font color="#CCCCCC"> lesson it asked</font><font color="#E5E5E5"> for and at the moment</font>

604
00:38:57,150 --> 00:39:02,960
<font color="#E5E5E5">or</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> current is not very happy</font><font color="#CCCCCC"> with</font>

605
00:38:58,770 --> 00:39:07,740
Saturday<font color="#E5E5E5"> so the client has to be fixed</font><font color="#CCCCCC"> -</font>

606
00:39:02,960 --> 00:39:10,020
<font color="#E5E5E5">to deal with that Petrus for that are on</font>

607
00:39:07,740 --> 00:39:12,868
the review or<font color="#CCCCCC"> the performance</font><font color="#E5E5E5"> is</font>

608
00:39:10,020 --> 00:39:18,060
actually<font color="#CCCCCC"> or</font><font color="#E5E5E5"> very promising so the</font>

609
00:39:12,869 --> 00:39:23,190
<font color="#CCCCCC">overheads is very low</font><font color="#E5E5E5"> and I'm hoping to</font>

610
00:39:18,060 --> 00:39:27,359
get that in soon<font color="#E5E5E5"> so what's going to</font>

611
00:39:23,190 --> 00:39:29,690
happen<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> future on the mercurial</font>

612
00:39:27,359 --> 00:39:29,690
side

613
00:39:29,839 --> 00:39:36,380
primarily<font color="#CCCCCC"> reduced</font><font color="#E5E5E5"> memory overhead of</font>

614
00:39:32,940 --> 00:39:41,520
transactions<font color="#E5E5E5"> that's going to help</font>

615
00:39:36,380 --> 00:39:46,560
everyone looking at<font color="#E5E5E5"> implementing</font><font color="#CCCCCC"> pack</font>

616
00:39:41,520 --> 00:39:49,080
<font color="#CCCCCC">parts</font><font color="#E5E5E5"> it's definitely also very useful</font>

617
00:39:46,560 --> 00:39:50,970
<font color="#CCCCCC">and of course</font><font color="#E5E5E5"> to not profiling there are</font>

618
00:39:49,080 --> 00:39:53,160
a lot of other commands<font color="#E5E5E5"> or I haven't</font>

619
00:39:50,970 --> 00:39:56,009
<font color="#E5E5E5">looked at yet because they are not as</font>

620
00:39:53,160 --> 00:39:59,940
crucial<font color="#E5E5E5"> but I expect</font><font color="#CCCCCC"> there are still</font>

621
00:39:56,010 --> 00:40:01,740
quite<font color="#E5E5E5"> a few and low hanging</font><font color="#CCCCCC"> fruits</font><font color="#E5E5E5"> so if</font>

622
00:39:59,940 --> 00:40:05,940
someone wants to<font color="#E5E5E5"> work on it for</font><font color="#CCCCCC"> example</font>

623
00:40:01,740 --> 00:40:10,200
<font color="#E5E5E5">for the sum of codes be my guest come to</font>

624
00:40:05,940 --> 00:40:15,570
me on the net<font color="#CCCCCC"> PSD side</font>

625
00:40:10,200 --> 00:40:18,480
it's basically finishing documentation

626
00:40:15,570 --> 00:40:22,260
for good<font color="#E5E5E5"> workflow so how are developers</font>

627
00:40:18,480 --> 00:40:25,080
supposed to use a<font color="#E5E5E5"> system and how</font><font color="#CCCCCC"> are</font>

628
00:40:22,260 --> 00:40:26,969
they supposed<font color="#E5E5E5"> to do you think</font><font color="#CCCCCC"> they are</font>

629
00:40:25,080 --> 00:40:29,819
doing<font color="#E5E5E5"> and see us now</font>

630
00:40:26,969 --> 00:40:34,679
because things are of course<font color="#E5E5E5"> different</font>

631
00:40:29,819 --> 00:40:38,219
<font color="#E5E5E5">so it's a couple</font><font color="#CCCCCC"> of adjustment and we</font>

632
00:40:34,679 --> 00:40:41,369
<font color="#CCCCCC">have some</font><font color="#E5E5E5"> tooling like the</font><font color="#CCCCCC"> big cluster</font>

633
00:40:38,219 --> 00:40:44,699
the automatic progression testing and

634
00:40:41,369 --> 00:40:47,910
and so on<font color="#E5E5E5"> and they either need to be</font>

635
00:40:44,699 --> 00:40:50,849
<font color="#CCCCCC">adjusted to not use CVS anymore but</font>

636
00:40:47,910 --> 00:40:54,239
mercurial<font color="#E5E5E5"> or what we need to look at new</font>

637
00:40:50,849 --> 00:40:58,289
tools<font color="#E5E5E5"> that serves the same purpose</font>

638
00:40:54,239 --> 00:41:01,380
<font color="#E5E5E5">but can use mercurial</font><font color="#CCCCCC"> and what the final</font>

639
00:40:58,289 --> 00:41:05,219
<font color="#E5E5E5">point</font><font color="#CCCCCC"> is of course convince the other</font>

640
00:41:01,380 --> 00:41:10,289
developers that<font color="#CCCCCC"> they no longer want to</font>

641
00:41:05,219 --> 00:41:16,289
have CVS and which color<font color="#E5E5E5"> the</font><font color="#CCCCCC"> budget</font>

642
00:41:10,289 --> 00:41:23,369
should have so do you have any questions

643
00:41:16,289 --> 00:41:25,060
for<font color="#E5E5E5"> me</font><font color="#CCCCCC"> and that is thanks for your</font>

644
00:41:23,369 --> 00:41:31,329
attention

645
00:41:25,060 --> 00:41:31,328
[Applause]

