1
00:00:14,920 --> 00:00:18,160
go

2
00:00:16,239 --> 00:00:19,599
hello our next speaker is florian

3
00:00:18,160 --> 00:00:22,720
observer who will be talking about

4
00:00:19,600 --> 00:00:24,720
unwind a privilege separated validating

5
00:00:22,720 --> 00:00:25,840
the net recursive name server for every

6
00:00:24,720 --> 00:00:27,840
laptop

7
00:00:25,840 --> 00:00:29,039
you have the floor thank you can you

8
00:00:27,840 --> 00:00:31,840
switch this over

9
00:00:29,039 --> 00:00:31,840
oh yeah

10
00:00:32,009 --> 00:00:36,719
[Applause]

11
00:00:33,280 --> 00:00:36,719
other people's laptops are the worst

12
00:00:38,640 --> 00:00:42,640
okay good afternoon i'm going to talk

13
00:00:40,879 --> 00:00:44,559
about unwind

14
00:00:42,640 --> 00:00:47,360
i'm florian i'm an optimist developer

15
00:00:44,559 --> 00:00:49,280
since 2012 where mostly specialize

16
00:00:47,360 --> 00:00:51,519
on uh privilege separated network

17
00:00:49,280 --> 00:00:52,559
daemons i've also poked at things in a

18
00:00:51,520 --> 00:00:55,600
network stack

19
00:00:52,559 --> 00:00:56,640
and since of um this week my total

20
00:00:55,600 --> 00:00:58,320
contributions on

21
00:00:56,640 --> 00:01:00,399
openvsd have been in that negative i

22
00:00:58,320 --> 00:01:02,399
deleted more lines than i added

23
00:01:00,399 --> 00:01:04,239
and i'm not going to talk about this

24
00:01:02,399 --> 00:01:06,559
because that will get android nightmares

25
00:01:04,239 --> 00:01:06,559
i think

26
00:01:08,560 --> 00:01:13,040
for work i work as a senior assistant

27
00:01:11,119 --> 00:01:15,119
engineer at the roypnc where i'm

28
00:01:13,040 --> 00:01:16,720
a part of the team that runs the k root

29
00:01:15,119 --> 00:01:18,320
name server

30
00:01:16,720 --> 00:01:21,439
which basically means we have to figure

31
00:01:18,320 --> 00:01:24,559
out how to answer annex domain real fast

32
00:01:21,439 --> 00:01:27,279
but but but

33
00:01:24,560 --> 00:01:28,560
more about the things that i do for fun

34
00:01:27,280 --> 00:01:30,960
so

35
00:01:28,560 --> 00:01:32,560
openbased has been described as a hiking

36
00:01:30,960 --> 00:01:32,960
club with computer problems so when we

37
00:01:32,560 --> 00:01:34,799
get

38
00:01:32,960 --> 00:01:36,798
out of our basement uh we we go on

39
00:01:34,799 --> 00:01:39,840
hackathons we meet meet up in

40
00:01:36,799 --> 00:01:40,880
all these beautiful places and so we

41
00:01:39,840 --> 00:01:43,920
need to travel there

42
00:01:40,880 --> 00:01:47,679
and you might end up on a train or um

43
00:01:43,920 --> 00:01:50,079
hotel wi-fi you might be in an airport

44
00:01:47,680 --> 00:01:53,119
and you're always stuck with what the

45
00:01:50,079 --> 00:01:54,479
network provides your dns wise

46
00:01:53,119 --> 00:01:57,439
sometimes you find yourself behind the

47
00:01:54,479 --> 00:02:00,799
captive portal you need to get past that

48
00:01:57,439 --> 00:02:01,119
and so we were thinking can we automate

49
00:02:00,799 --> 00:02:02,000
this

50
00:02:01,119 --> 00:02:03,520
you always fiddle with your

51
00:02:02,000 --> 00:02:05,600
configuration can we have a demon

52
00:02:03,520 --> 00:02:08,318
running that handles this for you

53
00:02:05,600 --> 00:02:10,878
that handles the the harsh locations uh

54
00:02:08,318 --> 00:02:12,399
dns voice network-wise

55
00:02:10,878 --> 00:02:14,079
well actually no matter how harsh they

56
00:02:12,400 --> 00:02:15,599
are maybe you find yourself in a hut in

57
00:02:14,080 --> 00:02:17,040
the rocky mountains in the snow behind

58
00:02:15,599 --> 00:02:18,799
the schedule i think

59
00:02:17,040 --> 00:02:21,120
and we have done this twice it was

60
00:02:18,800 --> 00:02:21,120
awesome

61
00:02:21,520 --> 00:02:25,760
so what did people do before on their

62
00:02:23,599 --> 00:02:27,839
laptop um

63
00:02:25,760 --> 00:02:29,280
you just run dh client it takes over a

64
00:02:27,840 --> 00:02:31,280
resolveconf

65
00:02:29,280 --> 00:02:32,640
uh you will get past captive portals

66
00:02:31,280 --> 00:02:35,280
with this because that's how they are

67
00:02:32,640 --> 00:02:37,279
designed how to get past them

68
00:02:35,280 --> 00:02:38,640
but you're at the mercy of the um name

69
00:02:37,280 --> 00:02:40,319
server operator that whatever the

70
00:02:38,640 --> 00:02:42,640
network hands you

71
00:02:40,319 --> 00:02:43,760
you don't have dnsec in the sense of you

72
00:02:42,640 --> 00:02:46,399
don't run the crypto

73
00:02:43,760 --> 00:02:47,760
on your laptop so maybe uh the name

74
00:02:46,400 --> 00:02:49,519
server does this but

75
00:02:47,760 --> 00:02:51,518
it gives you an ad flag can you trust

76
00:02:49,519 --> 00:02:53,200
that i don't

77
00:02:51,519 --> 00:02:55,360
uh it also probably doesn't give you

78
00:02:53,200 --> 00:02:56,799
privacy really depends on what the thing

79
00:02:55,360 --> 00:02:58,159
behind this does but not on the first

80
00:02:56,800 --> 00:03:01,519
hop

81
00:02:58,159 --> 00:03:03,519
and your resolving

82
00:03:01,519 --> 00:03:06,319
runs in the same address space so if i

83
00:03:03,519 --> 00:03:10,400
run ping fasten.org

84
00:03:06,319 --> 00:03:11,359
this goes to libsy uses stop resolver

85
00:03:10,400 --> 00:03:14,159
there

86
00:03:11,360 --> 00:03:16,080
and talks to something that i don't know

87
00:03:14,159 --> 00:03:17,280
who actually runs this can i trust this

88
00:03:16,080 --> 00:03:19,120
it hands me back

89
00:03:17,280 --> 00:03:21,440
a network package which i then need to

90
00:03:19,120 --> 00:03:24,640
parse

91
00:03:21,440 --> 00:03:26,159
um a variation on this is yeah i really

92
00:03:24,640 --> 00:03:28,720
don't trust that network

93
00:03:26,159 --> 00:03:29,679
i put one of the quad axis in there and

94
00:03:28,720 --> 00:03:31,359
resolve conf

95
00:03:29,680 --> 00:03:34,000
this will very likely not get your past

96
00:03:31,360 --> 00:03:35,280
kept the portals and

97
00:03:34,000 --> 00:03:37,440
it also will not work in places where

98
00:03:35,280 --> 00:03:39,920
dns is filtered

99
00:03:37,440 --> 00:03:41,599
um then in openmsd we do have unbound

100
00:03:39,920 --> 00:03:42,159
and base so people figured well we can

101
00:03:41,599 --> 00:03:44,640
just

102
00:03:42,159 --> 00:03:47,200
run that which gives you then a dns

103
00:03:44,640 --> 00:03:50,238
validation you can have privacy with dot

104
00:03:47,200 --> 00:03:53,040
if you configure a line they'll very

105
00:03:50,239 --> 00:03:54,959
likely not get you past captive portals

106
00:03:53,040 --> 00:03:56,798
and it will not work in in places where

107
00:03:54,959 --> 00:03:59,439
dns is filtered however it runs in a

108
00:03:56,799 --> 00:04:01,760
different address space

109
00:03:59,439 --> 00:04:03,040
um there are some other options that you

110
00:04:01,760 --> 00:04:04,879
can do for

111
00:04:03,040 --> 00:04:07,280
there was a talk talk last year at

112
00:04:04,879 --> 00:04:08,879
fosdem about uh systemd resolve d

113
00:04:07,280 --> 00:04:10,000
which seems like they are trying to

114
00:04:08,879 --> 00:04:10,720
solve the same problem that we are

115
00:04:10,000 --> 00:04:12,720
trying to do

116
00:04:10,720 --> 00:04:14,000
with with unwind so that was certainly

117
00:04:12,720 --> 00:04:18,000
an interesting talk for for

118
00:04:14,000 --> 00:04:18,000
ideas now

119
00:04:18,399 --> 00:04:22,969
what does unwind promise again we're

120
00:04:21,120 --> 00:04:24,880
taking over resolve conf

121
00:04:22,970 --> 00:04:26,960
[Music]

122
00:04:24,880 --> 00:04:29,199
we we get the anesthetic validation we

123
00:04:26,960 --> 00:04:31,680
get dot if you configure it

124
00:04:29,199 --> 00:04:33,280
it will get you past captive portals it

125
00:04:31,680 --> 00:04:35,120
will work in places where

126
00:04:33,280 --> 00:04:37,919
dns is filtered and it runs in a

127
00:04:35,120 --> 00:04:37,919
different address space

128
00:04:38,000 --> 00:04:42,080
the the architecture so we all we want

129
00:04:40,479 --> 00:04:42,800
to run this always so we need to get

130
00:04:42,080 --> 00:04:45,120
this

131
00:04:42,800 --> 00:04:45,919
secure we're following the standard

132
00:04:45,120 --> 00:04:48,000
openings the

133
00:04:45,919 --> 00:04:50,000
um privileged separated demon

134
00:04:48,000 --> 00:04:53,120
architecture which mostly consists of

135
00:04:50,000 --> 00:04:54,560
three processes um we have this design

136
00:04:53,120 --> 00:04:57,919
and multiple demons

137
00:04:54,560 --> 00:05:00,960
already and uh using using that

138
00:04:57,919 --> 00:05:02,639
template it gives us a ipc over over

139
00:05:00,960 --> 00:05:03,840
pipes with a structured data we don't

140
00:05:02,639 --> 00:05:06,639
need to re-parse it

141
00:05:03,840 --> 00:05:07,758
gives us a config file where the grammar

142
00:05:06,639 --> 00:05:09,520
is is

143
00:05:07,759 --> 00:05:11,440
very similar across the daemon so people

144
00:05:09,520 --> 00:05:13,758
are already familiar with the conflict

145
00:05:11,440 --> 00:05:17,440
language

146
00:05:13,759 --> 00:05:18,240
and it it also gives you a logging

147
00:05:17,440 --> 00:05:19,840
framework

148
00:05:18,240 --> 00:05:20,720
where it locks the syslog or if you run

149
00:05:19,840 --> 00:05:21,520
it in the foreground it will

150
00:05:20,720 --> 00:05:25,600
automatically

151
00:05:21,520 --> 00:05:27,520
lock the standard error and the cli tool

152
00:05:25,600 --> 00:05:28,880
now the the three processes we have a

153
00:05:27,520 --> 00:05:30,400
parent process that just spins

154
00:05:28,880 --> 00:05:31,600
everything up it's privileged it opens

155
00:05:30,400 --> 00:05:33,599
up port 53

156
00:05:31,600 --> 00:05:34,960
and hands that over to the the front end

157
00:05:33,600 --> 00:05:38,479
process

158
00:05:34,960 --> 00:05:39,280
it asks dhclient for uh oh did you learn

159
00:05:38,479 --> 00:05:42,000
some some

160
00:05:39,280 --> 00:05:42,638
name servers please tell them to me and

161
00:05:42,000 --> 00:05:46,800
we run

162
00:05:42,639 --> 00:05:48,800
the processes in a um

163
00:05:46,800 --> 00:05:50,639
reduced service operating mode we we

164
00:05:48,800 --> 00:05:52,479
with the syscall we have an openbc it's

165
00:05:50,639 --> 00:05:55,759
called pledge and it's it's literally

166
00:05:52,479 --> 00:05:59,199
just this string which means uh we plan

167
00:05:55,759 --> 00:05:59,759
to only uh use the standard o parts of

168
00:05:59,199 --> 00:06:01,840
libc

169
00:05:59,759 --> 00:06:02,800
or talk to open file descriptors uh

170
00:06:01,840 --> 00:06:05,758
that's the standard

171
00:06:02,800 --> 00:06:06,880
output we plan to only open files for

172
00:06:05,759 --> 00:06:10,960
reading

173
00:06:06,880 --> 00:06:13,039
and for technicality we can then send

174
00:06:10,960 --> 00:06:14,479
file descriptors over socket over pipe

175
00:06:13,039 --> 00:06:16,479
sorry and if you do

176
00:06:14,479 --> 00:06:19,199
something else in that process it just

177
00:06:16,479 --> 00:06:22,880
gets killed by the kernel

178
00:06:19,199 --> 00:06:24,720
um another the the second process

179
00:06:22,880 --> 00:06:26,800
is the front-end process that gets the

180
00:06:24,720 --> 00:06:30,720
the queries from a client

181
00:06:26,800 --> 00:06:33,840
uh which then parses it and hands over a

182
00:06:30,720 --> 00:06:35,919
structured data to the resolver process

183
00:06:33,840 --> 00:06:37,198
and when it gets a response back from

184
00:06:35,919 --> 00:06:40,159
there

185
00:06:37,199 --> 00:06:41,680
it sends that back to the client this

186
00:06:40,160 --> 00:06:45,039
part also handles the

187
00:06:41,680 --> 00:06:47,520
control socket and

188
00:06:45,039 --> 00:06:48,960
it gets informed by the kernel when an

189
00:06:47,520 --> 00:06:52,318
interface goes up down or

190
00:06:48,960 --> 00:06:54,719
interface just disappears and also the

191
00:06:52,319 --> 00:06:56,000
learned name servers arrive here so this

192
00:06:54,720 --> 00:06:59,280
is the process

193
00:06:56,000 --> 00:07:02,319
um that's mostly export

194
00:06:59,280 --> 00:07:02,799
exposed to to the outside in the sense

195
00:07:02,319 --> 00:07:06,400
of

196
00:07:02,800 --> 00:07:06,400
where user interaction comes in

197
00:07:07,599 --> 00:07:14,159
um and the final process is

198
00:07:11,599 --> 00:07:17,120
where we do our all our uh heavy lifting

199
00:07:14,160 --> 00:07:20,000
and for dns

200
00:07:17,120 --> 00:07:20,479
and this part needs to keep track of

201
00:07:20,000 --> 00:07:21,840
various

202
00:07:20,479 --> 00:07:24,080
resolving strategies i'm going to talk

203
00:07:21,840 --> 00:07:25,679
later about what what those are

204
00:07:24,080 --> 00:07:27,440
uh it receives a query from the

205
00:07:25,680 --> 00:07:29,280
front-end process

206
00:07:27,440 --> 00:07:30,800
finds the best strategy to get this

207
00:07:29,280 --> 00:07:32,960
resolved and

208
00:07:30,800 --> 00:07:34,880
when an answer comes back it passes this

209
00:07:32,960 --> 00:07:37,099
back to to the front end

210
00:07:34,880 --> 00:07:39,680
and since this one does um

211
00:07:37,100 --> 00:07:41,680
[Music]

212
00:07:39,680 --> 00:07:43,199
do all the dns resolving eventually it

213
00:07:41,680 --> 00:07:45,120
needs to talk to the internet

214
00:07:43,199 --> 00:07:46,560
so it has the iron pledge in there which

215
00:07:45,120 --> 00:07:48,639
basically means you're allowed to open

216
00:07:46,560 --> 00:07:50,960
the socket and talk to the internet

217
00:07:48,639 --> 00:07:52,639
but not a lot of more oh there's one

218
00:07:50,960 --> 00:07:56,080
thing since we do support

219
00:07:52,639 --> 00:07:57,840
dod we need a search bundle but we don't

220
00:07:56,080 --> 00:07:58,560
want this process to read the whole file

221
00:07:57,840 --> 00:08:00,799
system

222
00:07:58,560 --> 00:08:01,759
so we can tell it with the the unreal

223
00:08:00,800 --> 00:08:03,520
syscall

224
00:08:01,759 --> 00:08:05,360
look there's only this one file only

225
00:08:03,520 --> 00:08:07,039
this file exists in your

226
00:08:05,360 --> 00:08:08,400
whole file system if you try to open

227
00:08:07,039 --> 00:08:10,878
something else the kernel will tell you

228
00:08:08,400 --> 00:08:14,159
this does not exist

229
00:08:10,879 --> 00:08:15,440
so you cannot exfiltrate any information

230
00:08:14,160 --> 00:08:17,680
that's on the file system it's just not

231
00:08:15,440 --> 00:08:17,680
there

232
00:08:18,720 --> 00:08:25,360
time for breath um

233
00:08:21,919 --> 00:08:26,719
let's talk about the resolving bit

234
00:08:25,360 --> 00:08:28,319
because this is uh i suppose the

235
00:08:26,720 --> 00:08:32,240
interesting part for for this room

236
00:08:28,319 --> 00:08:34,000
and so i mentioned that um

237
00:08:32,240 --> 00:08:36,560
i run a name server for a living which

238
00:08:34,000 --> 00:08:40,080
means i go to all the conferences and

239
00:08:36,559 --> 00:08:42,319
um go to the the dns talks and

240
00:08:40,080 --> 00:08:43,599
what the implementers tell me is oh boy

241
00:08:42,320 --> 00:08:45,040
it's really terrible to implement a

242
00:08:43,599 --> 00:08:47,600
resolver don't do that

243
00:08:45,040 --> 00:08:48,959
and now i'm not doing that um we're just

244
00:08:47,600 --> 00:08:51,040
standing on the shoulder of giants and

245
00:08:48,959 --> 00:08:53,119
and use a lib unknown for that which is

246
00:08:51,040 --> 00:08:55,360
the the working horse for for for

247
00:08:53,120 --> 00:08:58,560
unbound

248
00:08:55,360 --> 00:09:00,560
um and for for technical reasons we have

249
00:08:58,560 --> 00:09:02,479
a local copy in there

250
00:09:00,560 --> 00:09:03,599
because the api doesn't expose all the

251
00:09:02,480 --> 00:09:05,839
things that we need

252
00:09:03,600 --> 00:09:07,440
so we need to poke at some internals but

253
00:09:05,839 --> 00:09:08,480
this is certainly not a fork i do not

254
00:09:07,440 --> 00:09:09,839
want to maintain that

255
00:09:08,480 --> 00:09:14,399
so every time there is a new release

256
00:09:09,839 --> 00:09:14,399
from internet i just want to jam that in

257
00:09:15,920 --> 00:09:19,360
so i mentioned the resolver strategies

258
00:09:18,080 --> 00:09:20,959
this is where this really gets

259
00:09:19,360 --> 00:09:22,399
interesting so you can run unwind

260
00:09:20,959 --> 00:09:25,359
without a config file

261
00:09:22,399 --> 00:09:26,160
which already gives you four strategies

262
00:09:25,360 --> 00:09:28,240
it can run

263
00:09:26,160 --> 00:09:30,319
as a recurser basically what what

264
00:09:28,240 --> 00:09:35,040
unmount would do

265
00:09:30,320 --> 00:09:38,320
it can talk to learn forwarders

266
00:09:35,040 --> 00:09:41,519
it will try to talk opportunistic eot to

267
00:09:38,320 --> 00:09:45,120
learn forwarders and

268
00:09:41,519 --> 00:09:45,120
uh it can run as uh

269
00:09:45,440 --> 00:09:50,160
it can a sidestep lip unbound and just

270
00:09:47,440 --> 00:09:53,200
use the the lip c stub stop

271
00:09:50,160 --> 00:09:55,120
we'll later see why that is important

272
00:09:53,200 --> 00:09:57,040
you can also give it a config file where

273
00:09:55,120 --> 00:09:58,320
you configure dot forwards with an

274
00:09:57,040 --> 00:10:00,319
authentication name for the

275
00:09:58,320 --> 00:10:01,680
for the operating duty it cannot

276
00:10:00,320 --> 00:10:02,160
validate the search doesn't know the

277
00:10:01,680 --> 00:10:03,680
name

278
00:10:02,160 --> 00:10:07,439
but in the config file you can put in a

279
00:10:03,680 --> 00:10:09,920
name and it will then validate the cert

280
00:10:07,440 --> 00:10:11,600
um and in the config file you can also

281
00:10:09,920 --> 00:10:12,640
tweak the the preferences of the

282
00:10:11,600 --> 00:10:16,839
strategies and

283
00:10:12,640 --> 00:10:18,319
this is just the default that it runs

284
00:10:16,839 --> 00:10:21,040
with

285
00:10:18,320 --> 00:10:21,760
all the all the strategies uh run off of

286
00:10:21,040 --> 00:10:24,480
individual

287
00:10:21,760 --> 00:10:25,040
lib unmount contacts so one of them can

288
00:10:24,480 --> 00:10:26,800
do

289
00:10:25,040 --> 00:10:28,240
its own recursion the other one can talk

290
00:10:26,800 --> 00:10:31,439
to a forwarder but

291
00:10:28,240 --> 00:10:32,079
these are different uh objects and we

292
00:10:31,440 --> 00:10:35,200
found a way

293
00:10:32,079 --> 00:10:37,120
to have a shared cache here we need to

294
00:10:35,200 --> 00:10:40,959
be a bit careful there

295
00:10:37,120 --> 00:10:44,160
since you can only share a cache if

296
00:10:40,959 --> 00:10:47,279
the the context has the

297
00:10:44,160 --> 00:10:49,519
the same quality uh it basically means

298
00:10:47,279 --> 00:10:50,959
it needs to be able to validate uh if

299
00:10:49,519 --> 00:10:52,240
you're trying to share cash

300
00:10:50,959 --> 00:10:54,479
between a strategy that does not

301
00:10:52,240 --> 00:10:56,480
validate that cannot validate because uh

302
00:10:54,480 --> 00:10:58,079
signatures are stripped uh if you jam

303
00:10:56,480 --> 00:11:00,640
that into the same cache uh really

304
00:10:58,079 --> 00:11:04,239
interesting things happen

305
00:11:00,640 --> 00:11:08,800
and this is all things threaded

306
00:11:04,240 --> 00:11:11,600
we plug it in together with a lip event

307
00:11:08,800 --> 00:11:13,040
so we need to figure out are these

308
00:11:11,600 --> 00:11:16,240
strategies any good

309
00:11:13,040 --> 00:11:18,800
and what we do for that is

310
00:11:16,240 --> 00:11:20,079
we ask for the start of the authority

311
00:11:18,800 --> 00:11:23,040
record for the root zone

312
00:11:20,079 --> 00:11:24,640
because we know that that exists and we

313
00:11:23,040 --> 00:11:26,800
know that it's signed

314
00:11:24,640 --> 00:11:28,000
and from there we can deduce if a

315
00:11:26,800 --> 00:11:30,880
specific strategy

316
00:11:28,000 --> 00:11:32,720
is any good so we can find out is this

317
00:11:30,880 --> 00:11:37,200
strategy validating

318
00:11:32,720 --> 00:11:39,120
or does it strip r6 or a dns case which

319
00:11:37,200 --> 00:11:42,800
happens on some metal boxes or

320
00:11:39,120 --> 00:11:45,120
happens on some open public resolvers

321
00:11:42,800 --> 00:11:46,079
then we assign um this thing is

322
00:11:45,120 --> 00:11:47,920
resolving

323
00:11:46,079 --> 00:11:50,319
or maybe we just can't talk dns to the

324
00:11:47,920 --> 00:11:51,279
outside world because 53 or 853 are

325
00:11:50,320 --> 00:11:53,360
blocked

326
00:11:51,279 --> 00:11:57,760
then this strategy is clearly dead and

327
00:11:53,360 --> 00:11:59,920
we will not hand any inquiries to it

328
00:11:57,760 --> 00:12:01,600
um another thing that we're doing is we

329
00:11:59,920 --> 00:12:04,319
we observe

330
00:12:01,600 --> 00:12:04,959
how how good a strategy is how fast does

331
00:12:04,320 --> 00:12:07,200
it

332
00:12:04,959 --> 00:12:08,560
answer so we keep track of the round

333
00:12:07,200 --> 00:12:11,760
trip time and

334
00:12:08,560 --> 00:12:14,079
put that put that into a decaying

335
00:12:11,760 --> 00:12:17,680
histogram and calculate

336
00:12:14,079 --> 00:12:21,199
median of the round trip time over that

337
00:12:17,680 --> 00:12:22,479
and uh so running the cli tool um on on

338
00:12:21,200 --> 00:12:24,000
my laptop

339
00:12:22,480 --> 00:12:25,920
i think it was online for about a week

340
00:12:24,000 --> 00:12:28,530
or so um

341
00:12:25,920 --> 00:12:29,839
and it shows me this um

342
00:12:28,530 --> 00:12:32,639
[Music]

343
00:12:29,839 --> 00:12:34,000
so this is where we uh calculate uh the

344
00:12:32,639 --> 00:12:36,880
the quality from

345
00:12:34,000 --> 00:12:38,480
and um i suppose one interesting thing

346
00:12:36,880 --> 00:12:40,720
is the first column where

347
00:12:38,480 --> 00:12:41,920
um the round trip time is below 10

348
00:12:40,720 --> 00:12:43,519
milliseconds and

349
00:12:41,920 --> 00:12:45,760
all the queries ended up there which

350
00:12:43,519 --> 00:12:47,360
basically means these are all cache hits

351
00:12:45,760 --> 00:12:49,040
so eventually everything gets answered

352
00:12:47,360 --> 00:12:52,480
off to the cache except for

353
00:12:49,040 --> 00:12:55,279
all the other stuff i guess

354
00:12:52,480 --> 00:12:55,760
um so we have all these strategies we

355
00:12:55,279 --> 00:12:57,519
have

356
00:12:55,760 --> 00:12:59,839
we checked out if they're any good and

357
00:12:57,519 --> 00:13:01,519
um how do we do the resolving now well

358
00:12:59,839 --> 00:13:02,959
uh we need to sort the strategies to

359
00:13:01,519 --> 00:13:04,800
find the best one and

360
00:13:02,959 --> 00:13:06,000
validating is always strictly better

361
00:13:04,800 --> 00:13:08,079
than resolving

362
00:13:06,000 --> 00:13:10,000
and then we use the median rtt for

363
00:13:08,079 --> 00:13:12,719
tiebreaker

364
00:13:10,000 --> 00:13:13,839
and we also have the um the preference

365
00:13:12,720 --> 00:13:17,040
to consider

366
00:13:13,839 --> 00:13:18,720
and the way we do that is we skew the

367
00:13:17,040 --> 00:13:19,599
most preferred strategy by 200

368
00:13:18,720 --> 00:13:22,320
milliseconds

369
00:13:19,600 --> 00:13:24,480
so if i say i really want to do

370
00:13:22,320 --> 00:13:25,760
recursive resolving as the the preferred

371
00:13:24,480 --> 00:13:27,680
strategy

372
00:13:25,760 --> 00:13:29,279
what i mean is yeah i'm willing to wait

373
00:13:27,680 --> 00:13:31,519
200 milliseconds more

374
00:13:29,279 --> 00:13:32,959
um but if i find myself behind the

375
00:13:31,519 --> 00:13:33,760
satellite link what that usually means

376
00:13:32,959 --> 00:13:35,680
if i try to do

377
00:13:33,760 --> 00:13:38,480
my own recursive resolving and an answer

378
00:13:35,680 --> 00:13:40,638
comes in two seconds after i ask

379
00:13:38,480 --> 00:13:42,000
i'm not willing to wait that long so

380
00:13:40,639 --> 00:13:45,120
yeah you can wait

381
00:13:42,000 --> 00:13:45,920
200 milliseconds more but yeah then just

382
00:13:45,120 --> 00:13:47,279
give up there

383
00:13:45,920 --> 00:13:49,519
so what we're doing is we pick up the

384
00:13:47,279 --> 00:13:51,600
best strategy um

385
00:13:49,519 --> 00:13:52,639
give it to liberman to do the resolving

386
00:13:51,600 --> 00:13:55,839
and start a timer

387
00:13:52,639 --> 00:13:56,880
which waits the measured round-trip time

388
00:13:55,839 --> 00:14:00,079
milliseconds

389
00:13:56,880 --> 00:14:01,760
and if we do not get an answer we try

390
00:14:00,079 --> 00:14:03,920
the next best strategy

391
00:14:01,760 --> 00:14:04,800
and if we then wait the round-trip time

392
00:14:03,920 --> 00:14:08,079
milliseconds

393
00:14:04,800 --> 00:14:09,199
and um and so on and so on well if we do

394
00:14:08,079 --> 00:14:11,680
not cancel the

395
00:14:09,199 --> 00:14:13,439
already running queries uh because we

396
00:14:11,680 --> 00:14:14,719
put on all the work already they're

397
00:14:13,440 --> 00:14:17,120
talking to the internet

398
00:14:14,720 --> 00:14:19,760
things are happening uh we might as well

399
00:14:17,120 --> 00:14:22,320
uh while we do all the work already um

400
00:14:19,760 --> 00:14:23,439
maybe get a hot cache here and uh we

401
00:14:22,320 --> 00:14:25,440
also want to know

402
00:14:23,440 --> 00:14:27,199
how terrible is this actually this will

403
00:14:25,440 --> 00:14:28,800
skew uh the round trip time in the

404
00:14:27,199 --> 00:14:30,560
histogram so on the next time we will

405
00:14:28,800 --> 00:14:32,000
not actually

406
00:14:30,560 --> 00:14:34,719
use this strategy because we already

407
00:14:32,000 --> 00:14:34,720
know that it's bad

408
00:14:36,079 --> 00:14:39,680
um this is how this kind of all started

409
00:14:39,040 --> 00:14:42,480
so

410
00:14:39,680 --> 00:14:44,160
captive portals and dns breakage the

411
00:14:42,480 --> 00:14:46,560
capital portals break dns so it's kind

412
00:14:44,160 --> 00:14:50,319
of the same category

413
00:14:46,560 --> 00:14:52,959
um we used to have

414
00:14:50,320 --> 00:14:54,720
what what what your phone is doing and

415
00:14:52,959 --> 00:14:56,239
what the jesus laptop here is doing and

416
00:14:54,720 --> 00:14:58,320
what browsers are doing is

417
00:14:56,240 --> 00:14:59,920
that they have an http check they just

418
00:14:58,320 --> 00:15:01,839
go over to the internet to do an http

419
00:14:59,920 --> 00:15:02,959
query to a well-known url where they get

420
00:15:01,839 --> 00:15:05,600
a well-known answer

421
00:15:02,959 --> 00:15:06,880
and if they don't get that answer um

422
00:15:05,600 --> 00:15:07,360
they assume they're behind the captive

423
00:15:06,880 --> 00:15:08,800
portal

424
00:15:07,360 --> 00:15:10,399
where you then need to click yeah accept

425
00:15:08,800 --> 00:15:13,120
the german's conditions and all this

426
00:15:10,399 --> 00:15:15,680
yada yada um

427
00:15:13,120 --> 00:15:16,800
so chrome has a url for this or android

428
00:15:15,680 --> 00:15:19,920
has a ul for this

429
00:15:16,800 --> 00:15:22,639
uh mozilla has one apple has one we

430
00:15:19,920 --> 00:15:24,319
we have a cdn we could run our own but

431
00:15:22,639 --> 00:15:27,199
we could never agree on

432
00:15:24,320 --> 00:15:29,199
which evil corp we should trust here and

433
00:15:27,199 --> 00:15:32,319
why are we trustworthy then

434
00:15:29,199 --> 00:15:35,839
so one night we were we were talking

435
00:15:32,320 --> 00:15:37,199
to we monitor dns uh we know the thing

436
00:15:35,839 --> 00:15:40,079
about dns

437
00:15:37,199 --> 00:15:41,599
can we do this inline just toss the http

438
00:15:40,079 --> 00:15:43,439
and turns out we can

439
00:15:41,600 --> 00:15:44,959
uh we just need to have a look on how

440
00:15:43,440 --> 00:15:46,399
broken are things actually

441
00:15:44,959 --> 00:15:47,920
so you find yourself behind the captive

442
00:15:46,399 --> 00:15:48,880
portal you need to agree to the terms

443
00:15:47,920 --> 00:15:50,719
and conditions

444
00:15:48,880 --> 00:15:52,000
and what the thing does it completely

445
00:15:50,720 --> 00:15:54,560
blocks you off from the internet

446
00:15:52,000 --> 00:15:55,360
you can only talk to the dhcp forwarders

447
00:15:54,560 --> 00:15:58,479
well fine

448
00:15:55,360 --> 00:16:00,800
talk to those and you're done this is

449
00:15:58,480 --> 00:16:00,800
simple

450
00:16:01,040 --> 00:16:04,719
then you find yourself on the dutch

451
00:16:02,320 --> 00:16:04,720
railway

452
00:16:05,279 --> 00:16:09,519
and they are special so they have an

453
00:16:08,639 --> 00:16:14,560
open wi-fi

454
00:16:09,519 --> 00:16:16,800
uh you connect to the thing and

455
00:16:14,560 --> 00:16:17,599
whenever you you you set the query with

456
00:16:16,800 --> 00:16:19,439
uh um

457
00:16:17,600 --> 00:16:21,120
that has an edit zero option they just

458
00:16:19,440 --> 00:16:24,880
answer nx domain

459
00:16:21,120 --> 00:16:25,199
to everything this also turns out it's

460
00:16:24,880 --> 00:16:28,079
it's

461
00:16:25,199 --> 00:16:29,199
kind of okay because what we do the the

462
00:16:28,079 --> 00:16:30,959
check uh

463
00:16:29,199 --> 00:16:32,399
does this strategy actually work and we

464
00:16:30,959 --> 00:16:33,680
ask for the root zone and that this

465
00:16:32,399 --> 00:16:35,199
thing says here the root so that does

466
00:16:33,680 --> 00:16:37,519
not exist

467
00:16:35,199 --> 00:16:39,279
which is a cute story but kind of i

468
00:16:37,519 --> 00:16:42,399
don't trust that one

469
00:16:39,279 --> 00:16:45,199
so everything will have the quality of

470
00:16:42,399 --> 00:16:47,440
that will not be used and this is where

471
00:16:45,199 --> 00:16:50,000
why we have the stop in there as well

472
00:16:47,440 --> 00:16:50,560
because the the lib c stub does not do

473
00:16:50,000 --> 00:16:52,240
dns

474
00:16:50,560 --> 00:16:54,800
so you can actually get through that

475
00:16:52,240 --> 00:16:56,160
thing so you can click the terms and

476
00:16:54,800 --> 00:16:58,160
condition and everything is fine

477
00:16:56,160 --> 00:17:00,959
everything is funny

478
00:16:58,160 --> 00:17:01,680
and um so i actually have done a dot

479
00:17:00,959 --> 00:17:05,119
configured

480
00:17:01,680 --> 00:17:07,280
which then upgrades all of this to dot

481
00:17:05,119 --> 00:17:08,559
because even if you are behind the camp

482
00:17:07,280 --> 00:17:11,119
of portal if you if you

483
00:17:08,559 --> 00:17:15,280
went through there it will still answer

484
00:17:11,119 --> 00:17:15,280
annex domain it will intercept your dns

485
00:17:16,839 --> 00:17:22,079
now then maybe you you're living in the

486
00:17:20,880 --> 00:17:23,280
netherlands and you want to fly

487
00:17:22,079 --> 00:17:27,280
somewhere

488
00:17:23,280 --> 00:17:30,320
oh no hang on that's the next one um

489
00:17:27,280 --> 00:17:34,240
sorry you find yourself

490
00:17:30,320 --> 00:17:35,280
in in situations where dns is actually

491
00:17:34,240 --> 00:17:37,679
open

492
00:17:35,280 --> 00:17:39,360
and these are getting a bit more

493
00:17:37,679 --> 00:17:40,640
difficult because all your strategies

494
00:17:39,360 --> 00:17:42,000
suddenly say yeah this is totally

495
00:17:40,640 --> 00:17:43,440
working the route don't exist i can

496
00:17:42,000 --> 00:17:46,240
resolve this

497
00:17:43,440 --> 00:17:48,240
now you can of course uh run ip over dns

498
00:17:46,240 --> 00:17:51,280
but that's not particularly fast

499
00:17:48,240 --> 00:17:53,840
um the the problem here is so you

500
00:17:51,280 --> 00:17:56,799
you get an http redirect it is the

501
00:17:53,840 --> 00:18:00,080
captive portal the middle box intercepts

502
00:17:56,799 --> 00:18:02,639
your http or https

503
00:18:00,080 --> 00:18:05,360
it redirects you to a thing which runs

504
00:18:02,640 --> 00:18:08,080
on the middle box

505
00:18:05,360 --> 00:18:10,879
and but it's not the the redirect is not

506
00:18:08,080 --> 00:18:14,320
resolvable on the public internet

507
00:18:10,880 --> 00:18:16,080
so the resolver says yeah um

508
00:18:14,320 --> 00:18:18,159
annex domain you talk to one of the core

509
00:18:16,080 --> 00:18:20,639
taxes it says edx domain

510
00:18:18,160 --> 00:18:22,799
you talk dot to one of the public one it

511
00:18:20,640 --> 00:18:24,720
says nx domain it's not resolvable

512
00:18:22,799 --> 00:18:26,400
so we came up with a heuristic where

513
00:18:24,720 --> 00:18:28,559
we're saying okay fine

514
00:18:26,400 --> 00:18:29,760
for the first five minutes um we do not

515
00:18:28,559 --> 00:18:32,080
trust annex domain

516
00:18:29,760 --> 00:18:33,520
uh we just if you get an nx domain we

517
00:18:32,080 --> 00:18:37,360
just go to the stop and and

518
00:18:33,520 --> 00:18:40,559
figure it out that way uh which works uh

519
00:18:37,360 --> 00:18:42,240
real well and uh yeah we we go directly

520
00:18:40,559 --> 00:18:44,399
to the top not to the forwarders to do

521
00:18:42,240 --> 00:18:45,919
just sidestep dds zero issue at this

522
00:18:44,400 --> 00:18:48,240
point

523
00:18:45,919 --> 00:18:48,240
um

524
00:18:49,360 --> 00:18:56,559
now i'm at an airport in amsterdam

525
00:18:52,799 --> 00:18:59,200
this is brilliant so you get a redirect

526
00:18:56,559 --> 00:19:01,440
and or you you you go to the internet

527
00:18:59,200 --> 00:19:04,160
you talk http you get it redirect to

528
00:19:01,440 --> 00:19:06,080
the captive portal and this one is dns

529
00:19:04,160 --> 00:19:09,200
excited

530
00:19:06,080 --> 00:19:10,799
uh which works out quite nicely and

531
00:19:09,200 --> 00:19:12,720
so then you click here i agree to the

532
00:19:10,799 --> 00:19:14,400
terms and conditions and then it

533
00:19:12,720 --> 00:19:17,440
forwards you to another page where it

534
00:19:14,400 --> 00:19:19,280
actually opens up the internet

535
00:19:17,440 --> 00:19:21,679
that one is also resolvable on the

536
00:19:19,280 --> 00:19:23,918
public internet

537
00:19:21,679 --> 00:19:26,080
but the validation fails there are just

538
00:19:23,919 --> 00:19:30,400
no r6 on this

539
00:19:26,080 --> 00:19:32,080
and so yeah another heuristic there

540
00:19:30,400 --> 00:19:34,880
we do not trust validation errors for

541
00:19:32,080 --> 00:19:34,879
the first five minutes

542
00:19:36,840 --> 00:19:41,678
um so but in in

543
00:19:39,120 --> 00:19:43,360
uh so so people so i traveled with this

544
00:19:41,679 --> 00:19:45,280
uh um

545
00:19:43,360 --> 00:19:46,639
a lot of developers use this for for

546
00:19:45,280 --> 00:19:49,600
their traveling and uh

547
00:19:46,640 --> 00:19:50,320
it gets them past things there are still

548
00:19:49,600 --> 00:19:52,320
some uh

549
00:19:50,320 --> 00:19:54,639
there's still some stuff that we need to

550
00:19:52,320 --> 00:19:54,639
work on

551
00:19:55,919 --> 00:19:58,240
um

552
00:20:00,080 --> 00:20:05,678
so when our laptops have maybe four g

553
00:20:03,600 --> 00:20:07,760
cards and they also hand us forwarders

554
00:20:05,679 --> 00:20:09,440
but we need to figure out so and we just

555
00:20:07,760 --> 00:20:11,200
jam them in with with all the other four

556
00:20:09,440 --> 00:20:12,559
borders but this is not correct uh you

557
00:20:11,200 --> 00:20:13,360
should only use them when you when

558
00:20:12,559 --> 00:20:16,639
you're actually

559
00:20:13,360 --> 00:20:18,000
on 4g and not wi-fi um

560
00:20:16,640 --> 00:20:19,120
in practice this actually works out

561
00:20:18,000 --> 00:20:20,000
because they are not reachable when

562
00:20:19,120 --> 00:20:24,080
you're on wifi but

563
00:20:20,000 --> 00:20:26,000
it's still wrong a much bigger problem

564
00:20:24,080 --> 00:20:27,520
is what are we actually doing about dns

565
00:20:26,000 --> 00:20:30,159
tax so you can say well

566
00:20:27,520 --> 00:20:31,360
uh be strict about this dns is a thing

567
00:20:30,159 --> 00:20:33,120
you need to

568
00:20:31,360 --> 00:20:35,360
always validate and if you can't

569
00:20:33,120 --> 00:20:37,039
validate then just toss the answers

570
00:20:35,360 --> 00:20:38,320
well that's kind of not helping when

571
00:20:37,039 --> 00:20:39,520
you're in situations where it's really

572
00:20:38,320 --> 00:20:41,120
not working

573
00:20:39,520 --> 00:20:42,799
of course you can just slam your laptop

574
00:20:41,120 --> 00:20:45,360
shot and and go to the beach

575
00:20:42,799 --> 00:20:46,799
but if you really want internet maybe

576
00:20:45,360 --> 00:20:48,719
you should accept this

577
00:20:46,799 --> 00:20:50,000
so there are various ideas what we can

578
00:20:48,720 --> 00:20:53,919
do about this

579
00:20:50,000 --> 00:20:56,480
one is um do not allow a downgrade

580
00:20:53,919 --> 00:20:58,640
like you're you're in a network and you

581
00:20:56,480 --> 00:21:01,120
figure out the genetic validation works

582
00:20:58,640 --> 00:21:02,880
uh then strictly require dns validation

583
00:21:01,120 --> 00:21:05,039
works

584
00:21:02,880 --> 00:21:06,880
if someone suddenly starts to intercept

585
00:21:05,039 --> 00:21:09,360
you or actively attacks you and

586
00:21:06,880 --> 00:21:10,480
strips all the r6 uh just don't accept

587
00:21:09,360 --> 00:21:12,399
that

588
00:21:10,480 --> 00:21:14,240
unwind currently would do that it will

589
00:21:12,400 --> 00:21:16,400
would discover oh in this

590
00:21:14,240 --> 00:21:18,559
location a dns is not working so i don't

591
00:21:16,400 --> 00:21:22,240
bother trying

592
00:21:18,559 --> 00:21:24,559
um but it cannot detect uh

593
00:21:22,240 --> 00:21:26,400
that you're actively being attacked so

594
00:21:24,559 --> 00:21:28,240
we need to improve on that

595
00:21:26,400 --> 00:21:30,000
another thing is since we're doing all

596
00:21:28,240 --> 00:21:33,760
the crypto on the laptop

597
00:21:30,000 --> 00:21:37,280
we can actually trust the id flag so

598
00:21:33,760 --> 00:21:40,320
bubble this up to the to the software

599
00:21:37,280 --> 00:21:42,320
who actually wants to do the resolving

600
00:21:40,320 --> 00:21:44,720
that one needs to decide so i'm doing

601
00:21:42,320 --> 00:21:47,600
ssh my jump host

602
00:21:44,720 --> 00:21:48,480
and dns validation fails then ssh should

603
00:21:47,600 --> 00:21:51,360
prompt me

604
00:21:48,480 --> 00:21:52,960
yeah do you want to trust this but it's

605
00:21:51,360 --> 00:21:54,320
not doing that and i'm not aware of any

606
00:21:52,960 --> 00:21:55,039
software that actually currently does

607
00:21:54,320 --> 00:21:59,840
this

608
00:21:55,039 --> 00:21:59,840
so it's also not very helpful

609
00:22:01,600 --> 00:22:04,480
another thing

610
00:22:05,120 --> 00:22:12,719
it turns out when you're behind a

611
00:22:10,320 --> 00:22:14,000
weird captive portal oh sorry weird

612
00:22:12,720 --> 00:22:16,480
middle boxes and

613
00:22:14,000 --> 00:22:18,640
satellite links are one of those that

614
00:22:16,480 --> 00:22:22,720
they really like to intercept and

615
00:22:18,640 --> 00:22:26,000
and monst your udp package they they

616
00:22:22,720 --> 00:22:28,559
actually fake answers for you and

617
00:22:26,000 --> 00:22:29,840
they don't do dnastic so they also strip

618
00:22:28,559 --> 00:22:30,879
records and everything gets it gets

619
00:22:29,840 --> 00:22:33,760
weird at that point

620
00:22:30,880 --> 00:22:35,520
however they do not understand tcp so if

621
00:22:33,760 --> 00:22:38,559
you really want to talk to the internet

622
00:22:35,520 --> 00:22:40,799
just use a tcp but um

623
00:22:38,559 --> 00:22:42,480
lib will not do the right thing here

624
00:22:40,799 --> 00:22:45,600
because it also cannot know this

625
00:22:42,480 --> 00:22:46,480
um so it's happy to use udp and um but

626
00:22:45,600 --> 00:22:48,158
we know better that

627
00:22:46,480 --> 00:22:49,600
tcp would actually work so the idea is

628
00:22:48,159 --> 00:22:52,159
that we can detect this

629
00:22:49,600 --> 00:22:52,719
and then uh have a dedicated strategy

630
00:22:52,159 --> 00:22:58,000
just just

631
00:22:52,720 --> 00:22:58,000
does tcp um

632
00:22:58,640 --> 00:23:00,960
the the

633
00:23:02,720 --> 00:23:05,840
some some of the captive portals you you

634
00:23:04,960 --> 00:23:07,840
go through there

635
00:23:05,840 --> 00:23:09,520
and they only give you internet for 30

636
00:23:07,840 --> 00:23:11,600
minutes and

637
00:23:09,520 --> 00:23:13,360
what so this basically means after 30

638
00:23:11,600 --> 00:23:14,959
minutes you need to reconfirm

639
00:23:13,360 --> 00:23:16,719
uh but we already know that we are past

640
00:23:14,960 --> 00:23:18,080
the captive portal so all the heuristics

641
00:23:16,720 --> 00:23:20,000
would not trigger so we need to improve

642
00:23:18,080 --> 00:23:22,720
on that and one idea there is

643
00:23:20,000 --> 00:23:24,320
that we probably can work out what the

644
00:23:22,720 --> 00:23:27,440
redirect domains were

645
00:23:24,320 --> 00:23:30,639
and drag them put them in a special pool

646
00:23:27,440 --> 00:23:33,600
to handle them

647
00:23:30,640 --> 00:23:33,600
in a more special way

648
00:23:34,000 --> 00:23:37,440
a thing that was pointed out in the

649
00:23:36,880 --> 00:23:40,480
systemd

650
00:23:37,440 --> 00:23:44,080
resolve the talk last year was um

651
00:23:40,480 --> 00:23:45,600
that you since the captive portals are

652
00:23:44,080 --> 00:23:47,120
lying to you you should really not put

653
00:23:45,600 --> 00:23:48,959
their answers in

654
00:23:47,120 --> 00:23:50,320
in the cache and i think they're they

655
00:23:48,960 --> 00:23:52,159
talked about their solution to this

656
00:23:50,320 --> 00:23:52,480
problem is to dump the cash afterwards

657
00:23:52,159 --> 00:23:53,840
so

658
00:23:52,480 --> 00:23:55,520
when you know that you get past the

659
00:23:53,840 --> 00:23:56,399
capital portal but i really want to keep

660
00:23:55,520 --> 00:23:58,240
the cash

661
00:23:56,400 --> 00:24:00,320
so i put my laptop to sleep all the time

662
00:23:58,240 --> 00:24:03,360
and i open it so i want a hot cash

663
00:24:00,320 --> 00:24:06,320
um so we need to find a better way there

664
00:24:03,360 --> 00:24:08,879
and i hear reports of people using this

665
00:24:06,320 --> 00:24:10,320
behind dns six four net six four boxes

666
00:24:08,880 --> 00:24:12,320
that kind of maybe works but they seem

667
00:24:10,320 --> 00:24:15,520
to be weird problems so i need to

668
00:24:12,320 --> 00:24:20,639
investigate that anyway

669
00:24:15,520 --> 00:24:20,639
uh that was that do you have questions

670
00:24:21,200 --> 00:24:23,919
many questions

671
00:24:25,840 --> 00:24:33,840
thank you

672
00:24:34,159 --> 00:24:37,279
uh in the case of the horrible airport

673
00:24:36,960 --> 00:24:40,240
uh

674
00:24:37,279 --> 00:24:41,200
captive portal um you said this the

675
00:24:40,240 --> 00:24:43,360
solution was to

676
00:24:41,200 --> 00:24:44,320
uh ignore the nsx validation failures

677
00:24:43,360 --> 00:24:46,559
for five minutes

678
00:24:44,320 --> 00:24:47,520
yes does that equate equate to a

679
00:24:46,559 --> 00:24:51,520
downgrade attack

680
00:24:47,520 --> 00:24:54,960
yesterday yes just wanted to be sure

681
00:24:51,520 --> 00:24:54,960
yeah no yes

682
00:24:55,840 --> 00:25:00,399
because all you're doing is managing

683
00:24:57,279 --> 00:25:01,360
downgrade attacks in the same way yes so

684
00:25:00,400 --> 00:25:04,640
the idea is

685
00:25:01,360 --> 00:25:06,719
so we we know that the network changed

686
00:25:04,640 --> 00:25:08,480
uh that the kernel tells us this you

687
00:25:06,720 --> 00:25:13,120
connect it to a new wi-fi

688
00:25:08,480 --> 00:25:15,200
we treat that special um

689
00:25:13,120 --> 00:25:17,199
it's a trade-off many thanks for your

690
00:25:15,200 --> 00:25:20,880
presentation i would like to ask you

691
00:25:17,200 --> 00:25:23,600
uh openbc community uh usually use

692
00:25:20,880 --> 00:25:29,200
comic sans font for presentation why you

693
00:25:23,600 --> 00:25:30,480
use another one

694
00:25:29,200 --> 00:25:32,960
first i would like to thank the speaker

695
00:25:30,480 --> 00:25:36,559
for not using comic sans

696
00:25:32,960 --> 00:25:36,559
i i will improve on that for the next

697
00:25:40,840 --> 00:25:46,000
time

698
00:25:42,480 --> 00:25:47,600
hi florian well you mentioned ssh which

699
00:25:46,000 --> 00:25:49,360
i find interesting because it's an

700
00:25:47,600 --> 00:25:51,760
application written by the same

701
00:25:49,360 --> 00:25:52,799
uh project as the word this work you're

702
00:25:51,760 --> 00:25:55,440
presenting

703
00:25:52,799 --> 00:25:56,559
and i don't know if you're aware but ssh

704
00:25:55,440 --> 00:25:59,679
does have

705
00:25:56,559 --> 00:26:02,000
co-passes for dnsec validation

706
00:25:59,679 --> 00:26:02,960
i mean it ships with the ability to link

707
00:26:02,000 --> 00:26:05,440
with ldns

708
00:26:02,960 --> 00:26:07,440
that's not really worthwhile yeah there

709
00:26:05,440 --> 00:26:10,880
are patches that also link with

710
00:26:07,440 --> 00:26:13,600
cat dns that really works but then the

711
00:26:10,880 --> 00:26:15,520
open the ssh maintainers seem to think

712
00:26:13,600 --> 00:26:17,600
that this is a complete non-problem

713
00:26:15,520 --> 00:26:18,799
and nobody would ever want to run it

714
00:26:17,600 --> 00:26:21,678
like this so

715
00:26:18,799 --> 00:26:24,639
i hope that maybe your work will inspire

716
00:26:21,679 --> 00:26:26,880
the open ssh maintainers do to merge

717
00:26:24,640 --> 00:26:29,039
the nsx validation and then the problem

718
00:26:26,880 --> 00:26:32,320
should be solved for ssh at least

719
00:26:29,039 --> 00:26:34,960
i i suppose um i think uh the the

720
00:26:32,320 --> 00:26:36,320
um the things you're talking about these

721
00:26:34,960 --> 00:26:37,760
are in and portable

722
00:26:36,320 --> 00:26:40,720
so i don't think that the uh the

723
00:26:37,760 --> 00:26:42,240
openbsd1 can use ldns

724
00:26:40,720 --> 00:26:43,840
we don't have that in base so this has

725
00:26:42,240 --> 00:26:45,039
to be importable um

726
00:26:43,840 --> 00:26:48,879
well maybe you should merge from

727
00:26:45,039 --> 00:26:48,879
portable then maybe yes

728
00:26:51,360 --> 00:26:57,360
uh did you also so i saw a list of uh

729
00:26:54,480 --> 00:26:58,080
other projects yeah the uh the project

730
00:26:57,360 --> 00:27:01,600
dinosaur

731
00:26:58,080 --> 00:27:01,600
trigger was not on there

732
00:27:03,039 --> 00:27:07,520
because it's quite similar i think i

733
00:27:05,840 --> 00:27:10,679
can't find it on a short notice

734
00:27:07,520 --> 00:27:12,158
um oh yeah yeah yeah um

735
00:27:10,680 --> 00:27:13,919
[Music]

736
00:27:12,159 --> 00:27:16,159
is this still maintained is that still a

737
00:27:13,919 --> 00:27:20,480
thing i came across it and

738
00:27:16,159 --> 00:27:21,919
um it

739
00:27:20,480 --> 00:27:24,080
yeah i don't really remember the

740
00:27:21,919 --> 00:27:25,039
specific it it looked a bit uh abandoned

741
00:27:24,080 --> 00:27:30,000
but uh

742
00:27:25,039 --> 00:27:30,000
no okay okay sorry about that then

743
00:27:30,559 --> 00:27:35,840
oh several more questions hold on on my

744
00:27:33,520 --> 00:27:35,840
way

745
00:27:35,919 --> 00:27:41,279
okay thanks um i'm curious about how

746
00:27:39,360 --> 00:27:43,279
much of a pain in the s this would be to

747
00:27:41,279 --> 00:27:45,600
port to something other than open bsd

748
00:27:43,279 --> 00:27:47,840
so clearly there's the pledge thing but

749
00:27:45,600 --> 00:27:48,320
what else what other open bsd specific

750
00:27:47,840 --> 00:27:50,480
things

751
00:27:48,320 --> 00:27:51,520
are in there that would be horrible to

752
00:27:50,480 --> 00:27:54,480
port

753
00:27:51,520 --> 00:27:56,320
so the the pledged thing uh it's

754
00:27:54,480 --> 00:27:56,960
probably by now understood how to do

755
00:27:56,320 --> 00:27:58,720
that import

756
00:27:56,960 --> 00:28:03,679
in portable other software also does

757
00:27:58,720 --> 00:28:07,200
that um

758
00:28:03,679 --> 00:28:09,450
i think the the kernel integration

759
00:28:07,200 --> 00:28:11,120
might be problematic uh where um

760
00:28:09,450 --> 00:28:12,799
[Music]

761
00:28:11,120 --> 00:28:14,479
i don't even know if this is specific to

762
00:28:12,799 --> 00:28:16,559
to open bsd or specific to

763
00:28:14,480 --> 00:28:17,840
to bsds on how to learn that interface

764
00:28:16,559 --> 00:28:21,200
came up and down and these kind of

765
00:28:17,840 --> 00:28:24,000
things i suppose other operating systems

766
00:28:21,200 --> 00:28:25,120
right no this is a route socket okay

767
00:28:24,000 --> 00:28:27,520
yeah

768
00:28:25,120 --> 00:28:28,399
um so yeah i suppose there are ways to

769
00:28:27,520 --> 00:28:31,360
do this um

770
00:28:28,399 --> 00:28:33,439
and uh the the most simple way would

771
00:28:31,360 --> 00:28:34,479
actually be to just use the control that

772
00:28:33,440 --> 00:28:37,279
did the cli

773
00:28:34,480 --> 00:28:38,559
um just uh execute a script so if you if

774
00:28:37,279 --> 00:28:42,320
you have a way to tell

775
00:28:38,559 --> 00:28:43,520
oh uh my network changed um pipe this is

776
00:28:42,320 --> 00:28:45,200
through the cli

777
00:28:43,520 --> 00:28:47,120
i think that would be the the easiest

778
00:28:45,200 --> 00:28:48,559
way and um

779
00:28:47,120 --> 00:28:50,639
other than that i don't i don't think

780
00:28:48,559 --> 00:28:52,559
there are that many things that would

781
00:28:50,640 --> 00:28:55,200
not be portable

782
00:28:52,559 --> 00:28:56,480
right so like ip monitor on any linux

783
00:28:55,200 --> 00:28:59,840
which just gives you

784
00:28:56,480 --> 00:29:01,120
stuff to with pipe yeah okay any other

785
00:28:59,840 --> 00:29:03,600
questions

786
00:29:01,120 --> 00:29:03,600
here's one

787
00:29:05,200 --> 00:29:08,799
i was just wondering when you said that

788
00:29:07,039 --> 00:29:11,440
you one of the strategies is to

789
00:29:08,799 --> 00:29:12,799
run your own recurser like for example

790
00:29:11,440 --> 00:29:13,360
when you're at your office how do you

791
00:29:12,799 --> 00:29:15,279
resolve

792
00:29:13,360 --> 00:29:16,879
printers if it suddenly doesn't trust

793
00:29:15,279 --> 00:29:20,159
the dhcp

794
00:29:16,880 --> 00:29:26,480
provided forwarder yes um

795
00:29:20,159 --> 00:29:27,919
where's otto do you mind answering that

796
00:29:26,480 --> 00:29:30,320
there's a similar question about the

797
00:29:27,919 --> 00:29:33,440
firefox doh stuff of course

798
00:29:30,320 --> 00:29:33,439
but that's not this talk

799
00:29:34,399 --> 00:29:40,719
you can configure any

800
00:29:37,600 --> 00:29:43,760
name or domain and

801
00:29:40,720 --> 00:29:46,320
redirect all queries for that domain

802
00:29:43,760 --> 00:29:49,600
anything under it to a specific resolver

803
00:29:46,320 --> 00:29:52,720
which is typically let's say a

804
00:29:49,600 --> 00:29:56,080
solution to your split horizon thing

805
00:29:52,720 --> 00:29:58,080
in your office or in your home office

806
00:29:56,080 --> 00:30:00,240
the nasdaq can be used in that case but

807
00:29:58,080 --> 00:30:02,720
also can be

808
00:30:00,240 --> 00:30:03,600
switched off for those names which in

809
00:30:02,720 --> 00:30:06,960
general

810
00:30:03,600 --> 00:30:07,439
i think even in our office don't work

811
00:30:06,960 --> 00:30:11,360
that

812
00:30:07,440 --> 00:30:13,360
well thank you

813
00:30:11,360 --> 00:30:15,678
all right i have time for one very quick

814
00:30:13,360 --> 00:30:16,959
question

815
00:30:15,679 --> 00:30:20,159
so i can show this slide this is

816
00:30:16,960 --> 00:30:20,159
actually the better one i thought

817
00:30:20,799 --> 00:30:24,000
does that good have a title

818
00:30:24,640 --> 00:30:37,840
alright thank you for your talk thanks

819
00:30:38,720 --> 00:30:40,799
you

