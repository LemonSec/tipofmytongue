1
00:00:05,440 --> 00:00:09,920
hi

2
00:00:05,920 --> 00:00:12,240
i'm giovanni beckis um i'm

3
00:00:09,920 --> 00:00:14,639
an open busy developer and mail server

4
00:00:12,240 --> 00:00:18,400
administrator for my own company

5
00:00:14,639 --> 00:00:22,320
and this is a 10-year story

6
00:00:18,400 --> 00:00:25,680
about how we uh move our setup

7
00:00:22,320 --> 00:00:29,198
from uh bare metal servers

8
00:00:25,680 --> 00:00:32,320
running in postfix to vm

9
00:00:29,199 --> 00:00:33,280
in high availability running both

10
00:00:32,320 --> 00:00:38,160
postfix and

11
00:00:33,280 --> 00:00:38,160
open smtpd with shared data

12
00:00:39,040 --> 00:00:44,879
the historical setup was

13
00:00:42,079 --> 00:00:46,399
on mysp some opening business email

14
00:00:44,879 --> 00:00:49,199
servers

15
00:00:46,399 --> 00:00:50,160
and they're running uh the classical

16
00:00:49,200 --> 00:00:53,360
postfix

17
00:00:50,160 --> 00:00:56,839
spamassy namasa and kurimap

18
00:00:53,360 --> 00:01:00,399
and then during the years

19
00:00:56,840 --> 00:01:03,840
we we found that something should be

20
00:01:00,399 --> 00:01:07,520
changed to improve one of

21
00:01:03,840 --> 00:01:10,560
things was definitely postfix

22
00:01:07,520 --> 00:01:13,520
because complex

23
00:01:10,560 --> 00:01:14,560
setups start being too complex for many

24
00:01:13,520 --> 00:01:18,320
reasons

25
00:01:14,560 --> 00:01:18,720
due also because of uh amavi's that x

26
00:01:18,320 --> 00:01:21,279
locks

27
00:01:18,720 --> 00:01:21,759
a proxy as its own configuration and so

28
00:01:21,280 --> 00:01:26,080
on

29
00:01:21,759 --> 00:01:29,600
and we wanted something simpler uh

30
00:01:26,080 --> 00:01:32,720
some of the things we didn't change yet

31
00:01:29,600 --> 00:01:32,720
is kuru remap

32
00:01:33,119 --> 00:01:37,920
we decided not to go to dog cot for

33
00:01:38,400 --> 00:01:42,560
in the past it was uh mainly because we

34
00:01:41,280 --> 00:01:45,759
do not need uh

35
00:01:42,560 --> 00:01:49,040
some of the cool features docker has

36
00:01:45,759 --> 00:01:52,720
uh now it's it's probably something we

37
00:01:49,040 --> 00:01:56,719
we have to do but uh i know does

38
00:01:52,720 --> 00:02:00,000
script that should um change

39
00:01:56,719 --> 00:02:02,880
convert all meldiers to dovecote formats

40
00:02:00,000 --> 00:02:04,640
but at the moment we have something like

41
00:02:02,880 --> 00:02:08,000
half terabytes of emails

42
00:02:04,640 --> 00:02:10,878
so we need

43
00:02:08,000 --> 00:02:12,239
a very strict reason to switch to

44
00:02:10,878 --> 00:02:16,799
something else

45
00:02:12,239 --> 00:02:20,080
before uh trying to run a script

46
00:02:16,800 --> 00:02:21,520
on such mail

47
00:02:20,080 --> 00:02:23,440
there was initially there was no

48
00:02:21,520 --> 00:02:26,800
absolutely no load balances no

49
00:02:23,440 --> 00:02:30,239
shell storage just bare metal it was

50
00:02:26,800 --> 00:02:31,280
more than 10 years ago uh some fixed

51
00:02:30,239 --> 00:02:34,400
pieces uh

52
00:02:31,280 --> 00:02:37,840
we want to uh not to move

53
00:02:34,400 --> 00:02:38,480
as open bsd because we think it's rock

54
00:02:37,840 --> 00:02:41,760
stable

55
00:02:38,480 --> 00:02:45,119
and being one of developers

56
00:02:41,760 --> 00:02:48,399
is something that i'm

57
00:02:45,120 --> 00:02:52,239
very uh familiar with

58
00:02:48,400 --> 00:02:55,360
one other thing is uh i'm not gonna

59
00:02:52,239 --> 00:02:56,319
move from this apache spamming scene uh

60
00:02:55,360 --> 00:03:00,080
because i want one

61
00:02:56,319 --> 00:03:02,560
of the developer there as well so uh

62
00:03:00,080 --> 00:03:04,879
i had do not have any reason to move to

63
00:03:02,560 --> 00:03:09,200
us pandy or something

64
00:03:04,879 --> 00:03:12,000
some other software uh the first step

65
00:03:09,200 --> 00:03:12,319
towards moving to openscm tpd was done

66
00:03:12,000 --> 00:03:16,480
when

67
00:03:12,319 --> 00:03:20,399
uh open smtp has been committed to open

68
00:03:16,480 --> 00:03:23,760
businesses 3 mainly because we want to

69
00:03:20,400 --> 00:03:26,879
differentiate with from

70
00:03:23,760 --> 00:03:30,879
the main customers

71
00:03:26,879 --> 00:03:34,560
mail servers to a dedicated machines

72
00:03:30,879 --> 00:03:38,000
to let customers send the

73
00:03:34,560 --> 00:03:41,440
newsletters marketing stuff and so on

74
00:03:38,000 --> 00:03:44,480
and we decided to to try the software

75
00:03:41,440 --> 00:03:48,159
uh stuff initially was very simple

76
00:03:44,480 --> 00:03:51,679
was just plain uh virtual

77
00:03:48,159 --> 00:03:55,840
setup like password style lines

78
00:03:51,680 --> 00:04:00,159
um and it it goes very well

79
00:03:55,840 --> 00:04:04,239
so we decided uh to move to

80
00:04:00,159 --> 00:04:07,760
uh and better set up and to try to

81
00:04:04,239 --> 00:04:11,120
um to integrate

82
00:04:07,760 --> 00:04:14,480
on our infrastructure or open smtpd

83
00:04:11,120 --> 00:04:17,840
uh in a better way and to use it as

84
00:04:14,480 --> 00:04:18,719
primary mx as well the main problem at

85
00:04:17,839 --> 00:04:21,758
that time

86
00:04:18,720 --> 00:04:26,840
was that there was no filter

87
00:04:21,759 --> 00:04:29,759
interface so it it was complicated to

88
00:04:26,840 --> 00:04:32,799
integrate uh anti-spam software

89
00:04:29,759 --> 00:04:36,000
uh so we had to wait uh sometime

90
00:04:32,800 --> 00:04:39,040
till last year where filters

91
00:04:36,000 --> 00:04:43,120
were finally

92
00:04:39,040 --> 00:04:47,520
integrated in a very fascinating way

93
00:04:43,120 --> 00:04:47,520
and they are definitely production ready

94
00:04:49,199 --> 00:04:57,040
on our setup we're using a web panel

95
00:04:53,440 --> 00:05:00,080
that's sp configure we modify the

96
00:04:57,040 --> 00:05:03,840
depth to support openbsd

97
00:05:00,080 --> 00:05:07,440
and uh the the biggest

98
00:05:03,840 --> 00:05:10,960
part is just

99
00:05:07,440 --> 00:05:12,160
let the web panel creates a blowfish

100
00:05:10,960 --> 00:05:16,560
password

101
00:05:12,160 --> 00:05:19,759
because otherwise there were some

102
00:05:16,560 --> 00:05:23,039
path hard coded

103
00:05:19,759 --> 00:05:27,360
to fix and nothing nothing complicated

104
00:05:23,039 --> 00:05:31,039
using the panel uh let's let us

105
00:05:27,360 --> 00:05:33,440
save data in a way that we can use

106
00:05:31,039 --> 00:05:34,400
uh same data from posifix and for open

107
00:05:33,440 --> 00:05:40,080
smtpd

108
00:05:34,400 --> 00:05:43,840
in a clean way and our user can create a

109
00:05:40,080 --> 00:05:46,880
buy on on their own filters

110
00:05:43,840 --> 00:05:50,840
and uh whatever they want

111
00:05:46,880 --> 00:05:53,280
new alice's mnh their website their mail

112
00:05:50,840 --> 00:05:57,280
server

113
00:05:53,280 --> 00:06:01,039
first things towards a real

114
00:05:57,280 --> 00:06:03,840
high availability stop was

115
00:06:01,039 --> 00:06:06,240
absolutely a lot balancer so we start

116
00:06:03,840 --> 00:06:06,239
moving

117
00:06:06,319 --> 00:06:14,160
with the pf and the relay d integration

118
00:06:10,000 --> 00:06:17,440
as load balancer and

119
00:06:14,160 --> 00:06:21,120
to separate to have more machines

120
00:06:17,440 --> 00:06:25,919
and and then in share the nfs storage to

121
00:06:21,120 --> 00:06:29,759
or have medias um the web panel uses

122
00:06:25,919 --> 00:06:33,039
mysql as backend so we decided to go to

123
00:06:29,759 --> 00:06:37,039
with a mysql master master replica

124
00:06:33,039 --> 00:06:40,159
so all our users are uh replicated

125
00:06:37,039 --> 00:06:44,240
on more machines uh

126
00:06:40,160 --> 00:06:47,759
the mxr couple will the masters enslave

127
00:06:44,240 --> 00:06:51,360
and if the

128
00:06:47,759 --> 00:06:54,479
uh master master replied continue to

129
00:06:51,360 --> 00:06:57,919
to replicate and so we can

130
00:06:54,479 --> 00:07:01,680
uh both uh change user names

131
00:06:57,919 --> 00:07:03,440
and users can use their address books

132
00:07:01,680 --> 00:07:06,479
and calendars

133
00:07:03,440 --> 00:07:10,639
we use a sogo as calendar server

134
00:07:06,479 --> 00:07:10,639
to have this functionality

135
00:07:13,280 --> 00:07:20,719
the simple id up is just

136
00:07:16,960 --> 00:07:24,289
having an mx

137
00:07:20,720 --> 00:07:26,000
primary and a fullback and

138
00:07:24,290 --> 00:07:29,360
[Music]

139
00:07:26,000 --> 00:07:32,560
does a tcp check at the moment that

140
00:07:29,360 --> 00:07:33,440
just checks if the in the port is live

141
00:07:32,560 --> 00:07:36,000
or not

142
00:07:33,440 --> 00:07:37,199
and if it's not a full back to the uh

143
00:07:36,000 --> 00:07:40,160
secondary

144
00:07:37,199 --> 00:07:41,919
and uh for the secondary uh the

145
00:07:40,160 --> 00:07:45,199
configuration is inverted

146
00:07:41,919 --> 00:07:47,840
so we can have one of the two nodes

147
00:07:45,199 --> 00:07:48,319
down and the whole traffic is moved to

148
00:07:47,840 --> 00:07:52,400
the

149
00:07:48,319 --> 00:07:52,400
primary of the or the other one

150
00:07:53,840 --> 00:07:59,599
there should be

151
00:07:56,879 --> 00:08:01,440
in the future uh some improvements there

152
00:07:59,599 --> 00:08:05,120
because we would like to

153
00:08:01,440 --> 00:08:08,400
have not only check the tcp connection

154
00:08:05,120 --> 00:08:11,759
but also check the average queue

155
00:08:08,400 --> 00:08:14,799
of emails and some other things

156
00:08:11,759 --> 00:08:18,960
we're looking into some

157
00:08:14,800 --> 00:08:21,840
snap pt smp integration

158
00:08:18,960 --> 00:08:22,560
to have more information from rmx

159
00:08:21,840 --> 00:08:27,520
servers

160
00:08:22,560 --> 00:08:30,879
to detector which is the server

161
00:08:27,520 --> 00:08:30,878
to move the traffic to

162
00:08:34,159 --> 00:08:43,200
uh one important thing it was that

163
00:08:38,479 --> 00:08:43,200
the replica in mysql uh

164
00:08:43,679 --> 00:08:47,199
this setup is possible also with

165
00:08:46,320 --> 00:08:49,839
postgres

166
00:08:47,200 --> 00:08:50,720
it just the web panel doesn't work with

167
00:08:49,839 --> 00:08:54,560
postgresql

168
00:08:50,720 --> 00:08:56,959
you can do whatever you want if you want

169
00:08:54,560 --> 00:08:56,959
and

170
00:08:58,240 --> 00:09:02,880
in master master replica uh you can set

171
00:09:01,200 --> 00:09:07,120
the connection between the master

172
00:09:02,880 --> 00:09:11,040
and the on the slave and it's

173
00:09:07,120 --> 00:09:13,839
uh it does work uh

174
00:09:11,040 --> 00:09:16,240
just with the first line of

175
00:09:13,839 --> 00:09:20,320
configuration file when you say

176
00:09:16,240 --> 00:09:23,760
start replicating from this

177
00:09:20,320 --> 00:09:28,080
journal log journal file the second one

178
00:09:23,760 --> 00:09:32,080
it's a a new type of

179
00:09:28,080 --> 00:09:33,200
uh of replica that's more stable than

180
00:09:32,080 --> 00:09:36,880
the previous

181
00:09:33,200 --> 00:09:40,720
uh master muscle replication is

182
00:09:36,880 --> 00:09:45,680
fair stable on open bsd uh the

183
00:09:40,720 --> 00:09:50,880
the only problems we had was during

184
00:09:45,680 --> 00:09:54,880
some upgrade because uh

185
00:09:50,880 --> 00:09:59,839
my ready b uh certificates

186
00:09:54,880 --> 00:09:59,839
uh master master replica uh on uh

187
00:09:59,920 --> 00:10:09,279
only on this the same version of

188
00:10:04,800 --> 00:10:09,760
mysql they uh they certificate for a

189
00:10:09,279 --> 00:10:12,240
mixed

190
00:10:09,760 --> 00:10:13,040
version but there are a lot of

191
00:10:12,240 --> 00:10:16,240
conditions

192
00:10:13,040 --> 00:10:16,240
like supported

193
00:10:17,279 --> 00:10:20,720
officially supported operating system

194
00:10:19,519 --> 00:10:23,760
full moon

195
00:10:20,720 --> 00:10:28,560
and a lot of other things and

196
00:10:23,760 --> 00:10:33,519
so uh you have to to stay

197
00:10:28,560 --> 00:10:36,560
to maybe it's wisely to stop replica

198
00:10:33,519 --> 00:10:41,200
before upgrading the both servers

199
00:10:36,560 --> 00:10:41,199
and re-instructing later

200
00:10:44,560 --> 00:10:51,040
for the email server uh we wanted

201
00:10:47,760 --> 00:10:54,319
a setup that in which we can

202
00:10:51,040 --> 00:10:56,800
uh switch on from postfix to smtpd

203
00:10:54,320 --> 00:10:58,079
on a single server with a single command

204
00:10:56,800 --> 00:11:01,599
so

205
00:10:58,079 --> 00:11:04,640
we decided to go to a

206
00:11:01,600 --> 00:11:04,640
configuration that

207
00:11:04,720 --> 00:11:13,760
could be easier on the smtpd part

208
00:11:08,560 --> 00:11:16,800
uh maybe for queries muscle

209
00:11:13,760 --> 00:11:20,800
are some queries i'm a bit tricky

210
00:11:16,800 --> 00:11:24,160
but what we wanted it's that

211
00:11:20,800 --> 00:11:28,000
if uh doesn't need to switch

212
00:11:24,160 --> 00:11:29,680
from postfix to open smtpd and back for

213
00:11:28,000 --> 00:11:34,160
whatever reasons

214
00:11:29,680 --> 00:11:37,760
like security issues or

215
00:11:34,160 --> 00:11:38,800
like uh but there are some

216
00:11:37,760 --> 00:11:42,000
configurations

217
00:11:38,800 --> 00:11:44,719
that are better handled on the

218
00:11:42,000 --> 00:11:46,160
postfix part and other better handle on

219
00:11:44,720 --> 00:11:49,200
smtpd part

220
00:11:46,160 --> 00:11:50,639
so there's been cases in which for a

221
00:11:49,200 --> 00:11:54,240
specific customer

222
00:11:50,639 --> 00:11:56,160
we had to it was better to move to

223
00:11:54,240 --> 00:11:57,279
or supplement stampede or positive and

224
00:11:56,160 --> 00:12:00,560
we decided

225
00:11:57,279 --> 00:12:03,760
uh to go that part for that reason

226
00:12:00,560 --> 00:12:07,119
uh first lines

227
00:12:03,760 --> 00:12:09,519
are the certificates as a

228
00:12:07,120 --> 00:12:11,519
certificate you can use whatever you can

229
00:12:09,519 --> 00:12:16,320
use your own lights encrypter or

230
00:12:11,519 --> 00:12:18,000
a certificate you bought somewhere

231
00:12:16,320 --> 00:12:19,360
then there are the definition of the

232
00:12:18,000 --> 00:12:21,839
table where your

233
00:12:19,360 --> 00:12:24,000
virtual user are your virtual domain

234
00:12:21,839 --> 00:12:27,200
view trousers and the credentials are

235
00:12:24,000 --> 00:12:30,480
the users that are you use for satellite

236
00:12:27,200 --> 00:12:32,880
authentication to relay or outbound

237
00:12:30,480 --> 00:12:32,880
emails

238
00:12:33,680 --> 00:12:41,279
the trickiest part is

239
00:12:37,519 --> 00:12:44,399
as the mysql queries because

240
00:12:41,279 --> 00:12:48,720
in smtpd uh

241
00:12:44,399 --> 00:12:52,800
the user cannot be an email address

242
00:12:48,720 --> 00:12:57,200
but on many situations

243
00:12:52,800 --> 00:13:00,800
this is not true so we decided to go

244
00:12:57,200 --> 00:13:03,680
for a replace query

245
00:13:00,800 --> 00:13:05,279
and we decided that the underscore was

246
00:13:03,680 --> 00:13:10,160
not allowed or not stopped

247
00:13:05,279 --> 00:13:13,680
on for email addresses

248
00:13:10,160 --> 00:13:17,040
and the this is this has to be done

249
00:13:13,680 --> 00:13:20,959
in the both in the user info query

250
00:13:17,040 --> 00:13:24,240
that find where the meldier

251
00:13:20,959 --> 00:13:28,319
part is and in the query alias

252
00:13:24,240 --> 00:13:30,160
that's using uh mid values which is view

253
00:13:28,320 --> 00:13:31,760
that does more or less the same things

254
00:13:30,160 --> 00:13:35,120
and the query for user

255
00:13:31,760 --> 00:13:39,360
info so this way uh

256
00:13:35,120 --> 00:13:42,800
it's the uh the analysis are mapped

257
00:13:39,360 --> 00:13:49,839
in two fake users and then

258
00:13:42,800 --> 00:13:49,839
it's uh reconstructed later at mda level

259
00:13:54,480 --> 00:14:00,000
then does the entity sponsored up

260
00:13:57,760 --> 00:14:00,000
that

261
00:14:00,959 --> 00:14:08,239
there's a lot of filters available some

262
00:14:04,639 --> 00:14:08,240
features we're using some not

263
00:14:09,120 --> 00:14:17,680
at the moment with filters

264
00:14:13,040 --> 00:14:21,040
on summary guest for the

265
00:14:17,680 --> 00:14:23,120
the hello name and we check the reverse

266
00:14:21,040 --> 00:14:27,839
dns there are many

267
00:14:23,120 --> 00:14:30,959
other filters like for dnsbl

268
00:14:27,839 --> 00:14:32,399
if you fully trust in dnsbl you can you

269
00:14:30,959 --> 00:14:36,079
can disconnect

270
00:14:32,399 --> 00:14:40,480
if it's uh it's coming from one of

271
00:14:36,079 --> 00:14:43,839
these blacklists

272
00:14:40,480 --> 00:14:47,680
also instead of disconnecting the users

273
00:14:43,839 --> 00:14:50,720
there's another keyword that is junk so

274
00:14:47,680 --> 00:14:54,399
if the connection matches

275
00:14:50,720 --> 00:14:57,519
this particular filter the

276
00:14:54,399 --> 00:15:01,440
email is is moved on

277
00:14:57,519 --> 00:15:04,639
the junk folder of the user uh

278
00:15:01,440 --> 00:15:08,320
and it doesn't check all the subsequent

279
00:15:04,639 --> 00:15:11,600
filters this is uh uh very useful

280
00:15:08,320 --> 00:15:13,040
if you trust for example a particular

281
00:15:11,600 --> 00:15:15,920
filter

282
00:15:13,040 --> 00:15:16,800
oh and if you're not using pop3 because

283
00:15:15,920 --> 00:15:19,920
otherwise

284
00:15:16,800 --> 00:15:23,199
the mail will not be downloaded by

285
00:15:19,920 --> 00:15:27,040
users uh filters are

286
00:15:23,199 --> 00:15:29,680
not only to anti-spam setup

287
00:15:27,040 --> 00:15:30,399
related they are related also to some

288
00:15:29,680 --> 00:15:33,839
other

289
00:15:30,399 --> 00:15:36,880
things like uh dkim

290
00:15:33,839 --> 00:15:40,959
signing or reporting

291
00:15:36,880 --> 00:15:44,399
and the protocol is very easy is is

292
00:15:40,959 --> 00:15:46,079
is it is it's an ascii protocol it's not

293
00:15:44,399 --> 00:15:48,000
binary so

294
00:15:46,079 --> 00:15:49,279
you can write filter in whatever

295
00:15:48,000 --> 00:15:53,440
language you want

296
00:15:49,279 --> 00:15:57,759
and it's very easy to to write and

297
00:15:53,440 --> 00:16:01,680
and make it work did the kim sign

298
00:15:57,759 --> 00:16:05,199
a filter as a secularity

299
00:16:01,680 --> 00:16:07,920
because with

300
00:16:05,199 --> 00:16:08,479
with the posifix setup we use the

301
00:16:07,920 --> 00:16:12,399
ominous

302
00:16:08,480 --> 00:16:15,920
anomalies can sign but you have to

303
00:16:12,399 --> 00:16:18,720
have a key for every domain in

304
00:16:15,920 --> 00:16:20,399
the decaying sign filter you have one

305
00:16:18,720 --> 00:16:23,519
key for all your domains

306
00:16:20,399 --> 00:16:24,320
so it's it's a bit different in the

307
00:16:23,519 --> 00:16:27,600
setup

308
00:16:24,320 --> 00:16:29,519
from one to the other then

309
00:16:27,600 --> 00:16:30,880
there's a filter spam assessing there's

310
00:16:29,519 --> 00:16:34,000
also filter spandi

311
00:16:30,880 --> 00:16:37,600
if you if you're using the software that

312
00:16:34,000 --> 00:16:39,600
just connects to

313
00:16:37,600 --> 00:16:41,120
the spam assistant servers around the

314
00:16:39,600 --> 00:16:44,639
rules and

315
00:16:41,120 --> 00:16:47,920
copy back to the results so and the

316
00:16:44,639 --> 00:16:51,839
mail is rejected or accepted

317
00:16:47,920 --> 00:16:51,839
based off the spermacen configuration

318
00:16:59,839 --> 00:17:05,839
then filters are applied so

319
00:17:02,880 --> 00:17:07,119
you can decide based on whatever you

320
00:17:05,839 --> 00:17:10,319
want which filters

321
00:17:07,119 --> 00:17:14,239
you do want in this setup

322
00:17:10,319 --> 00:17:15,760
you have an address connection so the

323
00:17:14,240 --> 00:17:20,400
public interface

324
00:17:15,760 --> 00:17:23,760
where some filters are applied but

325
00:17:20,400 --> 00:17:23,760
it's possible also to

326
00:17:24,400 --> 00:17:30,960
change some things so you can for

327
00:17:28,319 --> 00:17:31,520
for example in some condition apply some

328
00:17:30,960 --> 00:17:33,600
features

329
00:17:31,520 --> 00:17:36,480
and in some other conditions applies

330
00:17:33,600 --> 00:17:36,480
different filters

331
00:17:36,960 --> 00:17:42,400
although one of the cool things is that

332
00:17:42,480 --> 00:17:50,160
for authentic submission for example uh

333
00:17:46,559 --> 00:17:52,879
tls authentication is required

334
00:17:50,160 --> 00:17:54,240
uh no no there's no way to do a

335
00:17:52,880 --> 00:17:57,919
submission or a

336
00:17:54,240 --> 00:18:00,960
book or an smtp

337
00:17:57,919 --> 00:18:03,679
relay on plain text

338
00:18:00,960 --> 00:18:06,240
like it's possible on postfix on other

339
00:18:03,679 --> 00:18:06,240
softwares

340
00:18:09,120 --> 00:18:13,520
clandy integration has been special

341
00:18:11,840 --> 00:18:16,720
because

342
00:18:13,520 --> 00:18:20,160
there's more than a way

343
00:18:16,720 --> 00:18:24,960
to do it one way

344
00:18:20,160 --> 00:18:24,960
is to use filter clamof

345
00:18:25,280 --> 00:18:30,799
but at the moment it's not

346
00:18:28,320 --> 00:18:32,000
production ready because it has some

347
00:18:30,799 --> 00:18:34,320
bugs

348
00:18:32,000 --> 00:18:34,320
and

349
00:18:35,200 --> 00:18:42,160
does some there are some races so

350
00:18:39,120 --> 00:18:45,760
it's possible to

351
00:18:42,160 --> 00:18:50,000
that emails are mixed up one two

352
00:18:45,760 --> 00:18:50,000
connect concatenated to another

353
00:18:50,320 --> 00:18:56,720
uh and um

354
00:18:53,360 --> 00:18:59,760
not all viruses are detected because

355
00:18:56,720 --> 00:19:02,400
uh the in the in the filter

356
00:18:59,760 --> 00:19:04,240
uh does something we still don't know

357
00:19:02,400 --> 00:19:07,200
what that

358
00:19:04,240 --> 00:19:07,919
changes the email content when sent to

359
00:19:07,200 --> 00:19:11,360
kram of

360
00:19:07,919 --> 00:19:13,840
maybe someone and and lights and or not

361
00:19:11,360 --> 00:19:15,520
not all viruses are detected this way

362
00:19:13,840 --> 00:19:18,320
yet

363
00:19:15,520 --> 00:19:21,039
so it's not it's not something to put in

364
00:19:18,320 --> 00:19:21,039
in production

365
00:19:22,480 --> 00:19:31,200
another possibility is to use a

366
00:19:26,640 --> 00:19:31,200
drama called by spamacin

367
00:19:32,000 --> 00:19:39,600
there there are cool things to use

368
00:19:35,600 --> 00:19:41,039
there uh but something that's not

369
00:19:39,600 --> 00:19:44,639
perfect

370
00:19:41,039 --> 00:19:48,240
the thing that's not perfect is that if

371
00:19:44,640 --> 00:19:51,280
a virus is detected this way the

372
00:19:48,240 --> 00:19:54,480
email will be rejected as junk as

373
00:19:51,280 --> 00:19:57,600
not as virus with so the

374
00:19:54,480 --> 00:20:01,600
message that will be

375
00:19:57,600 --> 00:20:02,799
put to the upstream uh mail server will

376
00:20:01,600 --> 00:20:07,439
be

377
00:20:02,799 --> 00:20:10,639
not correct the cool things is that

378
00:20:07,440 --> 00:20:13,760
with this plugin that's it's not

379
00:20:10,640 --> 00:20:17,200
uh officially integrated yet but

380
00:20:13,760 --> 00:20:20,720
we think we will integrate maybe in

381
00:20:17,200 --> 00:20:24,159
our 4.0 or 4.1 version

382
00:20:20,720 --> 00:20:25,200
it's it's possible to give different

383
00:20:24,159 --> 00:20:30,000
scores

384
00:20:25,200 --> 00:20:33,440
to different signatures from klamath

385
00:20:30,000 --> 00:20:36,799
so for example in klamath there are

386
00:20:33,440 --> 00:20:39,919
a lot of unofficial signatures that

387
00:20:36,799 --> 00:20:43,440
uh least phishing contents

388
00:20:39,919 --> 00:20:47,520
and macro viruses

389
00:20:43,440 --> 00:20:52,320
or some other stuff your bad urls

390
00:20:47,520 --> 00:20:52,320
etc and some of these are

391
00:20:53,039 --> 00:20:57,120
there's a high possibility to have some

392
00:20:55,520 --> 00:21:00,480
false positives

393
00:20:57,120 --> 00:21:03,439
uh with this plugin we have the

394
00:21:00,480 --> 00:21:05,520
the possibility to add different scores

395
00:21:03,440 --> 00:21:09,360
to different cloud signatures

396
00:21:05,520 --> 00:21:13,120
so the official scores uh the official

397
00:21:09,360 --> 00:21:16,240
signatures we are uh

398
00:21:13,120 --> 00:21:18,559
we are certain that are correct said

399
00:21:16,240 --> 00:21:21,120
there are will be no false positives

400
00:21:18,559 --> 00:21:22,399
and this way we can mark as with a high

401
00:21:21,120 --> 00:21:25,840
score

402
00:21:22,400 --> 00:21:28,960
uh in the unofficial ones

403
00:21:25,840 --> 00:21:32,720
we can change the score

404
00:21:28,960 --> 00:21:36,480
or uh or use other rules so

405
00:21:32,720 --> 00:21:38,880
uh we can check if it's listed

406
00:21:36,480 --> 00:21:40,559
in an official signature in klamath and

407
00:21:38,880 --> 00:21:44,240
some other conditions

408
00:21:40,559 --> 00:21:46,799
are met then will marx spawn as

409
00:21:44,240 --> 00:21:49,280
other way it will continue and will be

410
00:21:46,799 --> 00:21:49,280
accepted

411
00:21:51,440 --> 00:21:58,000
for uh as far as you know for s1d

412
00:21:54,720 --> 00:22:02,000
users there's not such feature available

413
00:21:58,000 --> 00:22:04,480
but i'm not sure so

414
00:22:02,000 --> 00:22:06,000
this is something that you have to think

415
00:22:04,480 --> 00:22:09,840
about because

416
00:22:06,000 --> 00:22:13,280
uh well integration with an antivirus

417
00:22:09,840 --> 00:22:17,600
is something that needs to be

418
00:22:13,280 --> 00:22:17,600
on a web server

419
00:22:22,080 --> 00:22:28,480
this is a interesting feature

420
00:22:25,280 --> 00:22:31,520
that it

421
00:22:28,480 --> 00:22:32,799
doesn't fully work with postfix for my

422
00:22:31,520 --> 00:22:36,320
experience

423
00:22:32,799 --> 00:22:39,918
that's srs it's centralized scheme

424
00:22:36,320 --> 00:22:43,840
that is when you relay

425
00:22:39,919 --> 00:22:44,960
towards a another certain external

426
00:22:43,840 --> 00:22:48,158
server

427
00:22:44,960 --> 00:22:51,520
with the dot forward within others

428
00:22:48,159 --> 00:22:52,240
uh that's the problem that spf is not

429
00:22:51,520 --> 00:22:56,559
respected

430
00:22:52,240 --> 00:23:00,400
so srs rewrites the

431
00:22:56,559 --> 00:23:01,200
the smith sender and this way spf is

432
00:23:00,400 --> 00:23:04,400
respected

433
00:23:01,200 --> 00:23:07,840
and made goes gmail

434
00:23:04,400 --> 00:23:09,679
facebook and others have a setup such

435
00:23:07,840 --> 00:23:12,399
that

436
00:23:09,679 --> 00:23:14,480
this kind of release without srs doesn't

437
00:23:12,400 --> 00:23:18,400
work

438
00:23:14,480 --> 00:23:19,360
with postfix there are external militars

439
00:23:18,400 --> 00:23:22,880
for

440
00:23:19,360 --> 00:23:26,799
srs but uh

441
00:23:22,880 --> 00:23:28,240
in some cases when vacation is enabled

442
00:23:26,799 --> 00:23:30,799
it doesn't work

443
00:23:28,240 --> 00:23:32,000
and it triggers some loops so it's it's

444
00:23:30,799 --> 00:23:35,440
not something

445
00:23:32,000 --> 00:23:36,080
we've found a real way to make it work

446
00:23:35,440 --> 00:23:40,799
in

447
00:23:36,080 --> 00:23:44,000
in a fine way this way is definitely

448
00:23:40,799 --> 00:23:47,200
easier and and is one of the

449
00:23:44,000 --> 00:23:48,159
cool things that make us move some of

450
00:23:47,200 --> 00:23:51,279
the infrastructure

451
00:23:48,159 --> 00:23:55,760
into open smtpd it just

452
00:23:51,279 --> 00:23:58,480
has to define a a crypto key

453
00:23:55,760 --> 00:23:58,879
that's used internally and and define

454
00:23:58,480 --> 00:24:01,600
that

455
00:23:58,880 --> 00:24:05,840
to any relay you have to apply srs and

456
00:24:01,600 --> 00:24:05,840
that's all

457
00:24:06,320 --> 00:24:11,200
the one of the trickiest part is uh

458
00:24:11,279 --> 00:24:15,440
the use of made drop made drop is

459
00:24:16,400 --> 00:24:22,240
the the sieve for double cut

460
00:24:19,919 --> 00:24:24,640
it's it does the same things that sits

461
00:24:22,240 --> 00:24:27,760
sieve does for the overcoat so

462
00:24:24,640 --> 00:24:32,480
it filters email base

463
00:24:27,760 --> 00:24:36,240
based on the main drop script language

464
00:24:32,480 --> 00:24:40,000
and ea checks for quotas and and so on

465
00:24:36,240 --> 00:24:44,240
uh this is the part where

466
00:24:40,000 --> 00:24:48,640
we have to use uh a custom mda

467
00:24:44,240 --> 00:24:52,880
because uh um may drop wants

468
00:24:48,640 --> 00:24:54,400
uh the user in the setup to be an email

469
00:24:52,880 --> 00:24:57,039
address but we have

470
00:24:54,400 --> 00:24:58,000
a user that's not email others because

471
00:24:57,039 --> 00:25:01,200
uh

472
00:24:58,000 --> 00:25:04,960
it doesn't work so uh

473
00:25:01,200 --> 00:25:08,640
the they have this the custom mda just

474
00:25:04,960 --> 00:25:11,279
uh replace the underscore

475
00:25:08,640 --> 00:25:12,840
that we set up first with a sql query

476
00:25:11,279 --> 00:25:15,840
and put it

477
00:25:12,840 --> 00:25:19,120
the the head sign

478
00:25:15,840 --> 00:25:22,639
back it checks for quota

479
00:25:19,120 --> 00:25:26,399
and quota is available uh

480
00:25:22,640 --> 00:25:29,919
on a global

481
00:25:26,400 --> 00:25:34,159
manner so you have to specify

482
00:25:29,919 --> 00:25:38,640
90 that's 90 so that's warning 190

483
00:25:34,159 --> 00:25:41,520
of the quota uh is uh is full

484
00:25:38,640 --> 00:25:43,679
email will be sent to the user saying

485
00:25:41,520 --> 00:25:47,760
well you're quite full

486
00:25:43,679 --> 00:25:52,799
the vmail is the user that we use for

487
00:25:47,760 --> 00:25:56,799
virtual delivery so the user

488
00:25:52,799 --> 00:25:59,279
that will accept the mail drop script

489
00:25:56,799 --> 00:26:00,000
and then a lot of other parameters that

490
00:25:59,279 --> 00:26:03,440
i used

491
00:26:00,000 --> 00:26:07,840
inside mail drop to detect uh

492
00:26:03,440 --> 00:26:11,600
the sender the dialysis and so on

493
00:26:07,840 --> 00:26:16,879
to to go with uh with passing

494
00:26:11,600 --> 00:26:20,240
discretes and and doing actions

495
00:26:16,880 --> 00:26:23,360
uh then we have once

496
00:26:20,240 --> 00:26:26,799
we defined the actions we

497
00:26:23,360 --> 00:26:27,840
we can define when those actions are

498
00:26:26,799 --> 00:26:31,279
applied

499
00:26:27,840 --> 00:26:35,520
like with the match from

500
00:26:31,279 --> 00:26:39,039
any from any to one of our domains

501
00:26:35,520 --> 00:26:42,960
uh put it on their ml folder

502
00:26:39,039 --> 00:26:46,400
through the custom mda or

503
00:26:42,960 --> 00:26:51,440
deliver local if the mail is local or

504
00:26:46,400 --> 00:26:51,440
if mail is authorized that you can relay

505
00:26:51,679 --> 00:26:55,679
outbound with the srs in this case

506
00:27:03,760 --> 00:27:10,720
log ascentpd

507
00:27:06,880 --> 00:27:10,720
are a bit

508
00:27:12,480 --> 00:27:19,760
i think strange for

509
00:27:16,559 --> 00:27:23,120
respect to what other mail servers are

510
00:27:19,760 --> 00:27:28,480
there are a lot of information

511
00:27:23,120 --> 00:27:31,520
but it's it's not as easy to

512
00:27:28,480 --> 00:27:32,080
correlate to the information i think

513
00:27:31,520 --> 00:27:36,240
this is

514
00:27:32,080 --> 00:27:39,918
something that could be

515
00:27:36,240 --> 00:27:39,919
improved and maybe

516
00:27:41,440 --> 00:27:48,320
a wrapper filter could up this way

517
00:27:44,559 --> 00:27:52,799
to create a custom lock fight two parts

518
00:27:48,320 --> 00:27:56,320
to use for example in the

519
00:27:52,799 --> 00:27:59,600
kibana or other analysis uh tools

520
00:27:56,320 --> 00:28:03,439
uh this is uh one of the things that

521
00:27:59,600 --> 00:28:06,959
that's missing is that when for example

522
00:28:03,440 --> 00:28:11,760
uh spawn b detects the desert spam

523
00:28:06,960 --> 00:28:14,880
in in the line there is no

524
00:28:11,760 --> 00:28:19,039
information about the users

525
00:28:14,880 --> 00:28:22,799
this pen is sent to this is

526
00:28:19,039 --> 00:28:26,559
because uh

527
00:28:22,799 --> 00:28:30,158
the user that is is

528
00:28:26,559 --> 00:28:34,000
uh is passed to spam a scene is

529
00:28:30,159 --> 00:28:34,640
unknown in this case this is something

530
00:28:34,000 --> 00:28:38,480
that

531
00:28:34,640 --> 00:28:41,600
is discussing on spam a scene

532
00:28:38,480 --> 00:28:44,799
you can send it

533
00:28:41,600 --> 00:28:48,799
to the server a user that

534
00:28:44,799 --> 00:28:52,000
usually is the email address that

535
00:28:48,799 --> 00:28:53,440
you are you are sending to and this is

536
00:28:52,000 --> 00:28:56,000
used

537
00:28:53,440 --> 00:28:57,360
to have custom rules per user custom

538
00:28:56,000 --> 00:29:00,159
score per user and

539
00:28:57,360 --> 00:29:01,439
some other informations um assangement

540
00:29:00,159 --> 00:29:04,720
setups

541
00:29:01,440 --> 00:29:05,600
they're different user by user on on

542
00:29:04,720 --> 00:29:09,679
user cases

543
00:29:05,600 --> 00:29:13,439
not on alias cases and or even on domain

544
00:29:09,679 --> 00:29:16,000
cases it's a way and

545
00:29:13,440 --> 00:29:16,960
this cannot be done at the moment in the

546
00:29:16,000 --> 00:29:20,559
filter

547
00:29:16,960 --> 00:29:24,399
because the user uh

548
00:29:20,559 --> 00:29:28,000
where the um email will be delivered

549
00:29:24,399 --> 00:29:31,439
is unknown at that stage yet

550
00:29:28,000 --> 00:29:33,679
uh we have just the

551
00:29:31,440 --> 00:29:33,679
uh

552
00:29:34,799 --> 00:29:38,840
the informations of the male cells so

553
00:29:36,640 --> 00:29:42,559
the rscpt2

554
00:29:38,840 --> 00:29:42,559
uh but

555
00:29:43,520 --> 00:29:49,918
their information is not

556
00:29:47,520 --> 00:29:51,360
uh correct for spencer's thing because

557
00:29:49,919 --> 00:29:54,799
for example

558
00:29:51,360 --> 00:29:58,719
the icpt-2 could be an alias it could be

559
00:29:54,799 --> 00:30:01,600
um a message from

560
00:29:58,720 --> 00:30:02,240
two email lists so it's not deformations

561
00:30:01,600 --> 00:30:05,840
it's not

562
00:30:02,240 --> 00:30:07,990
fully there there are so

563
00:30:05,840 --> 00:30:09,520
some other

564
00:30:07,990 --> 00:30:13,120
[Music]

565
00:30:09,520 --> 00:30:16,960
filter like military postfix

566
00:30:13,120 --> 00:30:20,639
for example try harder to

567
00:30:16,960 --> 00:30:25,600
check what's

568
00:30:20,640 --> 00:30:29,120
the username could be by

569
00:30:25,600 --> 00:30:32,080
looking into rcpt

570
00:30:29,120 --> 00:30:34,399
to headers and doing some tricks to try

571
00:30:32,080 --> 00:30:37,600
to detect what the correct user will be

572
00:30:34,399 --> 00:30:39,600
and passes to spell medicine this could

573
00:30:37,600 --> 00:30:42,959
be done

574
00:30:39,600 --> 00:30:46,399
but uh there are some parts

575
00:30:42,960 --> 00:30:50,480
in the meta code

576
00:30:46,399 --> 00:30:53,279
that could be used to

577
00:30:50,480 --> 00:30:55,120
mimic the the logic that are they're a

578
00:30:53,279 --> 00:30:57,519
bit strange like

579
00:30:55,120 --> 00:30:59,600
it's try to connect with some air to

580
00:30:57,519 --> 00:31:01,600
itself to detect if the user exists

581
00:30:59,600 --> 00:31:02,879
or not there are some strange things

582
00:31:01,600 --> 00:31:06,320
that

583
00:31:02,880 --> 00:31:08,640
that does is there are not

584
00:31:06,320 --> 00:31:09,439
that correct to do so we're trying to

585
00:31:08,640 --> 00:31:12,799
find

586
00:31:09,440 --> 00:31:16,240
a better way to find

587
00:31:12,799 --> 00:31:18,720
the correct user or something that

588
00:31:16,240 --> 00:31:20,240
it's at least similar to the correct

589
00:31:18,720 --> 00:31:23,120
user and put it

590
00:31:20,240 --> 00:31:24,240
uh to spam a scene and this way we will

591
00:31:23,120 --> 00:31:27,360
have

592
00:31:24,240 --> 00:31:30,840
also um in that line

593
00:31:27,360 --> 00:31:33,918
some informations about the users

594
00:31:30,840 --> 00:31:38,320
that email will be logged

595
00:31:33,919 --> 00:31:41,760
to so at the moment uh

596
00:31:38,320 --> 00:31:44,399
log files are uh

597
00:31:41,760 --> 00:31:46,960
there are quite all informations yeah so

598
00:31:44,399 --> 00:31:50,320
you can look uh

599
00:31:46,960 --> 00:31:51,810
into but they're

600
00:31:50,320 --> 00:31:54,559
not

601
00:31:51,810 --> 00:31:58,158
[Music]

602
00:31:54,559 --> 00:32:01,440
created in a way that's easy uh

603
00:31:58,159 --> 00:32:05,679
for a log analyzer to

604
00:32:01,440 --> 00:32:05,679
check and to store into

605
00:32:06,240 --> 00:32:13,120
into a web gui like kibana and so on

606
00:32:09,919 --> 00:32:16,880
uh to do that we use the

607
00:32:13,120 --> 00:32:20,879
logstash filebit so

608
00:32:16,880 --> 00:32:24,880
we have some filters that analyze

609
00:32:20,880 --> 00:32:26,840
the the log files and correlates with

610
00:32:24,880 --> 00:32:31,519
some other informations to

611
00:32:26,840 --> 00:32:34,080
produce those information

612
00:32:31,519 --> 00:32:34,880
and save them into elasticsearch this is

613
00:32:34,080 --> 00:32:37,439
done

614
00:32:34,880 --> 00:32:39,760
with the same filter for both pacific

615
00:32:37,440 --> 00:32:44,480
servers and smtpd servers

616
00:32:39,760 --> 00:32:49,039
so we can have a global information

617
00:32:44,480 --> 00:32:52,480
about who is sending uh

618
00:32:49,039 --> 00:32:55,120
who's relay uh with which server

619
00:32:52,480 --> 00:32:56,320
if how many people are relaying for

620
00:32:55,120 --> 00:33:00,559
example

621
00:32:56,320 --> 00:33:03,678
with a centipede or with pause fixer

622
00:33:00,559 --> 00:33:07,200
we use that also to analyze

623
00:33:03,679 --> 00:33:11,840
which are the

624
00:33:07,200 --> 00:33:15,039
the master hit rules in spelmatocin

625
00:33:11,840 --> 00:33:18,639
so we can decide for example

626
00:33:15,039 --> 00:33:22,080
if uh there's a particular

627
00:33:18,640 --> 00:33:25,120
newspam campaign and a lot of rules

628
00:33:22,080 --> 00:33:26,158
of the same rule that has a very low

629
00:33:25,120 --> 00:33:29,918
score is it

630
00:33:26,159 --> 00:33:34,960
we can think about improving

631
00:33:29,919 --> 00:33:34,960
this score to block this this campaign

632
00:33:36,840 --> 00:33:41,918
proactively

633
00:33:38,480 --> 00:33:42,880
and it's uh there are in log files there

634
00:33:41,919 --> 00:33:46,159
are information

635
00:33:42,880 --> 00:33:49,679
to use geologicalization to so to detect

636
00:33:46,159 --> 00:33:53,360
even if a user for example

637
00:33:49,679 --> 00:33:56,799
is trying to send emails from

638
00:33:53,360 --> 00:34:00,158
uh this

639
00:33:56,799 --> 00:34:01,360
the uh from different nations in the

640
00:34:00,159 --> 00:34:04,399
same

641
00:34:01,360 --> 00:34:07,918
uh at same time which is uh

642
00:34:04,399 --> 00:34:11,118
something that will probably

643
00:34:07,919 --> 00:34:14,079
uh be an alarm because it it could very

644
00:34:11,119 --> 00:34:17,359
very probably be

645
00:34:14,079 --> 00:34:20,960
an attack of impersonation of that

646
00:34:17,359 --> 00:34:24,960
of that user

647
00:34:20,960 --> 00:34:27,760
so uh the part that's missing

648
00:34:24,960 --> 00:34:29,280
at the moment is the spama simple user

649
00:34:27,760 --> 00:34:32,639
setup

650
00:34:29,280 --> 00:34:35,679
this is one that one thing that

651
00:34:32,639 --> 00:34:40,240
will i think will be fixed uh

652
00:34:35,679 --> 00:34:40,240
very soon and

653
00:34:41,760 --> 00:34:47,599
this is uh something that prevent us to

654
00:34:45,839 --> 00:34:50,719
move

655
00:34:47,599 --> 00:34:54,879
some users to this

656
00:34:50,719 --> 00:34:58,480
setup because it's something that

657
00:34:54,879 --> 00:35:00,400
some user wants and it's

658
00:34:58,480 --> 00:35:03,839
it can be done for some domains but not

659
00:35:00,400 --> 00:35:03,839
for for all

660
00:35:04,160 --> 00:35:07,759
uh we would like to get rid of the mail

661
00:35:06,320 --> 00:35:12,000
drop ropper and use

662
00:35:07,760 --> 00:35:16,480
directly mail drop because it's uh

663
00:35:12,000 --> 00:35:19,510
the maid drop dropper just fixes uh

664
00:35:16,480 --> 00:35:20,960
uh the parameters with some

665
00:35:19,510 --> 00:35:24,160
[Music]

666
00:35:20,960 --> 00:35:27,680
simple checks and then cause uh

667
00:35:24,160 --> 00:35:28,160
mail drop via exactly so it's something

668
00:35:27,680 --> 00:35:31,118
we

669
00:35:28,160 --> 00:35:31,839
would like to get read and the only way

670
00:35:31,119 --> 00:35:35,200
will be

671
00:35:31,839 --> 00:35:39,920
probably to modify the web interface

672
00:35:35,200 --> 00:35:43,200
to let it save directly uh the user

673
00:35:39,920 --> 00:35:46,400
so it's something that will probably

674
00:35:43,200 --> 00:35:48,399
touch uh more

675
00:35:46,400 --> 00:35:49,839
the web interface than major we so we

676
00:35:48,400 --> 00:35:53,520
have to decide

677
00:35:49,839 --> 00:35:56,320
uh which is the the path to go if

678
00:35:53,520 --> 00:35:58,000
maintaining mode of robert and let it do

679
00:35:56,320 --> 00:35:59,839
for example

680
00:35:58,000 --> 00:36:01,119
a dictionary logging or something like

681
00:35:59,839 --> 00:36:05,359
that or

682
00:36:01,119 --> 00:36:05,359
or change our website up

683
00:36:08,000 --> 00:36:14,320
one other thing is that could be diana

684
00:36:11,119 --> 00:36:17,280
releasing at the moment there's a no

685
00:36:14,320 --> 00:36:20,240
official officially committed the

686
00:36:17,280 --> 00:36:20,240
releasing filter

687
00:36:20,400 --> 00:36:23,200
but there is

688
00:36:23,520 --> 00:36:28,000
a graylist filter that's been written by

689
00:36:26,400 --> 00:36:33,520
gila

690
00:36:28,000 --> 00:36:37,440
that is is a bit different from the

691
00:36:33,520 --> 00:36:40,800
typical releasing setup because it is

692
00:36:37,440 --> 00:36:44,240
this filter in is spf aware

693
00:36:40,800 --> 00:36:48,000
so he knows and records

694
00:36:44,240 --> 00:36:48,000
a female comes from

695
00:36:48,240 --> 00:36:54,560
a domain that has spf set up so

696
00:36:51,920 --> 00:36:55,280
if a second connection comes from a

697
00:36:54,560 --> 00:36:58,320
different

698
00:36:55,280 --> 00:37:00,640
ip addresses it can map

699
00:36:58,320 --> 00:37:01,359
these ap addresses in the spf outer

700
00:37:00,640 --> 00:37:05,520
space

701
00:37:01,359 --> 00:37:08,240
and let it go in without waiting

702
00:37:05,520 --> 00:37:09,599
waiting and waiting like all classical

703
00:37:08,240 --> 00:37:12,160
releasing setups

704
00:37:09,599 --> 00:37:13,280
this is interesting and it's something

705
00:37:12,160 --> 00:37:16,720
that i think

706
00:37:13,280 --> 00:37:20,839
could be implemented and

707
00:37:16,720 --> 00:37:22,480
should be committed to the official

708
00:37:20,839 --> 00:37:25,440
sustri

709
00:37:22,480 --> 00:37:27,599
uh then definitely really the setup

710
00:37:25,440 --> 00:37:32,160
based on more data this would

711
00:37:27,599 --> 00:37:35,440
be uh would need implementing

712
00:37:32,160 --> 00:37:40,480
scripts or snmp or

713
00:37:35,440 --> 00:37:45,520
something like that to be able to decide

714
00:37:40,480 --> 00:37:45,520
uh in a more fine way more great

715
00:37:45,760 --> 00:37:53,119
granulate way which

716
00:37:48,880 --> 00:37:56,240
which is the the server that's

717
00:37:53,119 --> 00:37:59,280
currently alive this is mainly because

718
00:37:56,240 --> 00:38:02,879
tcp connection uh works

719
00:37:59,280 --> 00:38:07,760
most of the time uh even if

720
00:38:02,880 --> 00:38:10,960
for example there's a

721
00:38:07,760 --> 00:38:14,640
law there's a high loader

722
00:38:10,960 --> 00:38:17,680
average and in this case

723
00:38:14,640 --> 00:38:18,799
tcp connection works so emails continue

724
00:38:17,680 --> 00:38:22,240
to

725
00:38:18,800 --> 00:38:23,440
flow to the wrong server and it it be

726
00:38:22,240 --> 00:38:27,118
wise to

727
00:38:23,440 --> 00:38:29,359
uh switch the server on another switch

728
00:38:27,119 --> 00:38:30,800
they'll make you on another server so

729
00:38:29,359 --> 00:38:33,598
the load average could

730
00:38:30,800 --> 00:38:36,160
could go down it could be analyzer if if

731
00:38:33,599 --> 00:38:36,160
needed to

732
00:38:38,960 --> 00:38:46,880
so this is more or less finished

733
00:38:43,680 --> 00:38:51,839
we are going to move

734
00:38:46,880 --> 00:38:55,920
some more domains uh to this kind of

735
00:38:51,839 --> 00:38:59,359
setup and to improve that to be able to

736
00:38:55,920 --> 00:39:02,400
uh not uh getting rid of postfix

737
00:38:59,359 --> 00:39:06,640
definitely but to integrate

738
00:39:02,400 --> 00:39:10,320
uh posifix to with something that's

739
00:39:06,640 --> 00:39:13,680
uh merely uh bsd based

740
00:39:10,320 --> 00:39:16,400
and more easier to configure and more

741
00:39:13,680 --> 00:39:16,399
easy to manage

742
00:39:20,240 --> 00:39:27,200
yeah after friends to

743
00:39:23,520 --> 00:39:28,800
do post-q filtering like with the mavis

744
00:39:27,200 --> 00:39:32,399
like in postfix

745
00:39:28,800 --> 00:39:35,520
or you do only pre-q filtering that's

746
00:39:32,400 --> 00:39:39,359
this is pre-q filtering uh if you

747
00:39:35,520 --> 00:39:42,800
this is in the past we use the mlvs

748
00:39:39,359 --> 00:39:45,520
uh with open spd like a proxy so

749
00:39:42,800 --> 00:39:46,800
within pause q so it's it's possible to

750
00:39:45,520 --> 00:39:48,800
yeah

751
00:39:46,800 --> 00:39:50,000
please don't forget to repeat the

752
00:39:48,800 --> 00:39:57,839
question yeah sure yeah

753
00:39:50,000 --> 00:39:57,839
yes thank you

754
00:40:03,680 --> 00:40:11,839
okay okay thank you

755
00:40:15,119 --> 00:40:17,200
you

