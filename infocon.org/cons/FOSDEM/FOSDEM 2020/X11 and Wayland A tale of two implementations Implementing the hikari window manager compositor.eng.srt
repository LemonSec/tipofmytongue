1
00:00:05,120 --> 00:00:09,440
30 seconds extra nice

2
00:00:06,960 --> 00:00:10,480
so hi everyone i'm raichu uh i'm going

3
00:00:09,440 --> 00:00:13,759
to talk about

4
00:00:10,480 --> 00:00:15,440
x11 and wayland and unlike the link

5
00:00:13,759 --> 00:00:17,840
to this talk it's not about porting

6
00:00:15,440 --> 00:00:20,160
weyland uh it's also not about this

7
00:00:17,840 --> 00:00:22,160
window manager slash compositor it's

8
00:00:20,160 --> 00:00:24,720
basically about how i got there

9
00:00:22,160 --> 00:00:26,640
and all the little hurdles that you have

10
00:00:24,720 --> 00:00:28,560
to take when you're doing this on on on

11
00:00:26,640 --> 00:00:30,320
freebsd we heard this from nia from

12
00:00:28,560 --> 00:00:34,480
netbsd now

13
00:00:30,320 --> 00:00:36,160
same thing for for freebsd so yeah um

14
00:00:34,480 --> 00:00:38,800
this is basically just the hackspace

15
00:00:36,160 --> 00:00:41,679
that i'm at so don't care about the logo

16
00:00:38,800 --> 00:00:42,320
so i basically give this talk at 30 60

17
00:00:41,680 --> 00:00:44,480
c3

18
00:00:42,320 --> 00:00:46,000
before now i have 10 more minutes and i

19
00:00:44,480 --> 00:00:49,279
don't have rush that much

20
00:00:46,000 --> 00:00:50,800
which is good so first of all what

21
00:00:49,280 --> 00:00:53,120
was my project so the project's called

22
00:00:50,800 --> 00:00:56,559
hikari which is a window manager

23
00:00:53,120 --> 00:00:58,480
and a whaling compositor so i thought

24
00:00:56,559 --> 00:01:00,320
why not just take twice the time for a

25
00:00:58,480 --> 00:01:02,959
project and re-implement the thing

26
00:01:00,320 --> 00:01:03,600
using two different protocols uh so yeah

27
00:01:02,960 --> 00:01:07,360
that was fun

28
00:01:03,600 --> 00:01:09,920
so i roughly spent six months in every

29
00:01:07,360 --> 00:01:11,360
technology so i can kind of like i think

30
00:01:09,920 --> 00:01:13,200
i can form an

31
00:01:11,360 --> 00:01:14,400
informed opinion about this so maybe

32
00:01:13,200 --> 00:01:16,960
this is useful to you

33
00:01:14,400 --> 00:01:18,479
so first of all why did i do that so why

34
00:01:16,960 --> 00:01:20,000
do you write another window manager

35
00:01:18,479 --> 00:01:23,520
another compositor

36
00:01:20,000 --> 00:01:25,840
plenty out there um so yeah basically

37
00:01:23,520 --> 00:01:27,840
i wanted to write something that's sort

38
00:01:25,840 --> 00:01:29,759
of like a stacking tiling window manager

39
00:01:27,840 --> 00:01:32,079
approach anyone knows cwm from the

40
00:01:29,759 --> 00:01:33,119
openbsd folks yeah the opm open bsd

41
00:01:32,079 --> 00:01:35,919
everyone

42
00:01:33,119 --> 00:01:38,000
so um that's that is something that i

43
00:01:35,920 --> 00:01:39,759
was using on freebsd before and i

44
00:01:38,000 --> 00:01:40,479
thought this was a pretty nice concept

45
00:01:39,759 --> 00:01:42,399
and

46
00:01:40,479 --> 00:01:43,759
i wanted to have something a little bit

47
00:01:42,399 --> 00:01:45,759
more

48
00:01:43,759 --> 00:01:46,880
i thought this idea of groups was very

49
00:01:45,759 --> 00:01:50,079
intriguing because

50
00:01:46,880 --> 00:01:52,640
cwgm has groups one to nine

51
00:01:50,079 --> 00:01:54,559
and uh i basically just started using

52
00:01:52,640 --> 00:01:56,560
them as workspaces which is not really

53
00:01:54,560 --> 00:01:59,280
the idea of cwm i think

54
00:01:56,560 --> 00:02:00,159
but um i thought this group concept was

55
00:01:59,280 --> 00:02:02,960
pretty intriguing

56
00:02:00,159 --> 00:02:03,680
so like having arbitrary groups was

57
00:02:02,960 --> 00:02:05,839
probably

58
00:02:03,680 --> 00:02:07,119
this was something that i wanted to have

59
00:02:05,840 --> 00:02:07,600
and i'm going to show you what i mean by

60
00:02:07,119 --> 00:02:10,800
that

61
00:02:07,600 --> 00:02:12,319
so this is just let's start the terminal

62
00:02:10,800 --> 00:02:14,160
so this is

63
00:02:12,319 --> 00:02:16,560
basically just a simple terminal this is

64
00:02:14,160 --> 00:02:18,160
my aesthetics like one pixel border

65
00:02:16,560 --> 00:02:20,000
i'm happy with that every pixel means

66
00:02:18,160 --> 00:02:21,760
something um

67
00:02:20,000 --> 00:02:24,080
which i think is a nice thing so this is

68
00:02:21,760 --> 00:02:27,920
now white border i know i have contacts

69
00:02:24,080 --> 00:02:29,760
um focus so this concept of groups i

70
00:02:27,920 --> 00:02:30,640
have two terminals now and they reside

71
00:02:29,760 --> 00:02:32,720
in the same group

72
00:02:30,640 --> 00:02:34,319
it's uh the root shell oh it's the shell

73
00:02:32,720 --> 00:02:37,040
group so when i

74
00:02:34,319 --> 00:02:38,000
press mod now i get my title bars and it

75
00:02:37,040 --> 00:02:40,239
shows me

76
00:02:38,000 --> 00:02:42,080
all the windows that belong inside of

77
00:02:40,239 --> 00:02:43,120
that group so you can see okay this is

78
00:02:42,080 --> 00:02:46,319
my fish

79
00:02:43,120 --> 00:02:48,879
we're on sheet2 i use the word sheet

80
00:02:46,319 --> 00:02:50,480
for work spaces kind of different

81
00:02:48,879 --> 00:02:52,640
semantics but anyway

82
00:02:50,480 --> 00:02:54,238
i won't go into that here and it's in

83
00:02:52,640 --> 00:02:57,200
the shell group

84
00:02:54,239 --> 00:02:58,080
so i wanted to be able to like arbitrary

85
00:02:57,200 --> 00:02:59,280
group

86
00:02:58,080 --> 00:03:01,360
windows together so i have a

87
00:02:59,280 --> 00:03:04,159
communication web

88
00:03:01,360 --> 00:03:05,120
video audio shells and also maybe

89
00:03:04,159 --> 00:03:07,440
something like

90
00:03:05,120 --> 00:03:08,959
root shells so this is a root channel

91
00:03:07,440 --> 00:03:10,959
i'm going to type in my password here

92
00:03:08,959 --> 00:03:13,360
you can see this is a different group

93
00:03:10,959 --> 00:03:16,319
and what i can do now is i can cycle

94
00:03:13,360 --> 00:03:17,200
just between the most important views of

95
00:03:16,319 --> 00:03:18,879
the group

96
00:03:17,200 --> 00:03:20,958
so to me that was something that i

97
00:03:18,879 --> 00:03:24,079
really wanted to have is kind of useful

98
00:03:20,959 --> 00:03:26,720
and um as you can see this is like the

99
00:03:24,080 --> 00:03:28,159
usual floating thing which everyone

100
00:03:26,720 --> 00:03:29,040
thinks is totally inefficient but i

101
00:03:28,159 --> 00:03:31,440
don't think it isn't

102
00:03:29,040 --> 00:03:32,159
it isn't but sometimes i want to arrange

103
00:03:31,440 --> 00:03:34,799
my views

104
00:03:32,159 --> 00:03:35,760
sometimes i want to have tunneling and

105
00:03:34,799 --> 00:03:38,159
um

106
00:03:35,760 --> 00:03:39,120
so this is a very basic tiling algorithm

107
00:03:38,159 --> 00:03:41,679
that i used and

108
00:03:39,120 --> 00:03:43,519
was kind of inspired by what hapsluffed

109
00:03:41,680 --> 00:03:45,920
vm or herbsloftvm or

110
00:03:43,519 --> 00:03:46,959
if i want to pronounce it does where you

111
00:03:45,920 --> 00:03:48,399
can basically

112
00:03:46,959 --> 00:03:50,640
split up the screen into different

113
00:03:48,400 --> 00:03:52,959
sections and uh different frames and use

114
00:03:50,640 --> 00:03:55,359
different tiling algorithms like grid

115
00:03:52,959 --> 00:03:56,879
vertical horizontal full screen and

116
00:03:55,360 --> 00:03:57,280
stuff like that and you can configure

117
00:03:56,879 --> 00:03:59,679
that

118
00:03:57,280 --> 00:04:01,200
in the configuration file and kind of

119
00:03:59,680 --> 00:04:01,840
likes look like it kind of looks like

120
00:04:01,200 --> 00:04:04,079
json

121
00:04:01,840 --> 00:04:05,519
i'm using the ucl configuration language

122
00:04:04,080 --> 00:04:07,360
which is something that the freebsd

123
00:04:05,519 --> 00:04:10,000
folks are

124
00:04:07,360 --> 00:04:11,280
using as well internally so i thought

125
00:04:10,000 --> 00:04:14,640
why not use that as well

126
00:04:11,280 --> 00:04:17,519
so yeah um

127
00:04:14,640 --> 00:04:18,959
and as you can see i only have my title

128
00:04:17,519 --> 00:04:20,478
bars when i press mod

129
00:04:18,959 --> 00:04:22,320
which is it's kind of nice because i

130
00:04:20,478 --> 00:04:24,320
think toggle bars really

131
00:04:22,320 --> 00:04:26,080
take out a lot of screen escape and some

132
00:04:24,320 --> 00:04:27,120
sometimes i want to i want to see what

133
00:04:26,080 --> 00:04:29,359
the title

134
00:04:27,120 --> 00:04:32,639
of the window that i'm currently at is

135
00:04:29,360 --> 00:04:34,720
so that that can be kind of useful yeah

136
00:04:32,639 --> 00:04:36,160
and i want to have a very keyboard

137
00:04:34,720 --> 00:04:38,240
driven

138
00:04:36,160 --> 00:04:39,440
workflow where i can just jump to

139
00:04:38,240 --> 00:04:41,199
different windows just using like

140
00:04:39,440 --> 00:04:44,560
shortcuts and speed dial

141
00:04:41,199 --> 00:04:45,840
thingy is kind of useful yeah yeah

142
00:04:44,560 --> 00:04:47,840
and i also want to have minimal

143
00:04:45,840 --> 00:04:49,119
dependencies i know this is something

144
00:04:47,840 --> 00:04:52,000
different for everyone but

145
00:04:49,120 --> 00:04:53,360
um i just depend on a couple of things

146
00:04:52,000 --> 00:04:55,440
like cairo which

147
00:04:53,360 --> 00:04:56,880
kind of like spoils it for some of the

148
00:04:55,440 --> 00:04:59,440
people from open bsd

149
00:04:56,880 --> 00:04:59,919
that you can't pull that into base sorry

150
00:04:59,440 --> 00:05:02,240
um

151
00:04:59,919 --> 00:05:03,120
yeah i just need to have something to

152
00:05:02,240 --> 00:05:04,960
draw and

153
00:05:03,120 --> 00:05:06,240
that was the first thing i thought and i

154
00:05:04,960 --> 00:05:10,719
wanted to be

155
00:05:06,240 --> 00:05:13,039
kind of energy efficient so i was in cwm

156
00:05:10,720 --> 00:05:13,919
back then and that's a very minimal

157
00:05:13,039 --> 00:05:17,280
window manager

158
00:05:13,919 --> 00:05:19,280
and um when i switched to weyland uh i

159
00:05:17,280 --> 00:05:21,919
suddenly had one hour more

160
00:05:19,280 --> 00:05:23,599
uh of battery life it was like okay this

161
00:05:21,919 --> 00:05:26,240
is interesting what's going on there

162
00:05:23,600 --> 00:05:28,080
so i wanted to investigate more yeah so

163
00:05:26,240 --> 00:05:31,120
obviously i target freebsd

164
00:05:28,080 --> 00:05:32,479
so yeah at one point i will try to

165
00:05:31,120 --> 00:05:34,080
support other

166
00:05:32,479 --> 00:05:35,758
other operating systems but i don't have

167
00:05:34,080 --> 00:05:37,599
that many computers and don't want to go

168
00:05:35,759 --> 00:05:39,520
into virtualizing everything and

169
00:05:37,600 --> 00:05:40,880
but i will go there it will get there

170
00:05:39,520 --> 00:05:42,479
first things first

171
00:05:40,880 --> 00:05:44,560
yeah and i have two implementations

172
00:05:42,479 --> 00:05:45,680
because yeah spend twice the time on a

173
00:05:44,560 --> 00:05:48,479
project

174
00:05:45,680 --> 00:05:50,240
why not so yeah what's what's the

175
00:05:48,479 --> 00:05:53,360
difference what was

176
00:05:50,240 --> 00:05:54,880
what was the different thing that i felt

177
00:05:53,360 --> 00:05:57,280
the different problems that i

178
00:05:54,880 --> 00:05:58,560
encountered there is an x there i don't

179
00:05:57,280 --> 00:05:59,599
know if you can see it in the back but

180
00:05:58,560 --> 00:06:02,960
yeah that's

181
00:05:59,600 --> 00:06:03,360
xor versus weyland basically those two

182
00:06:02,960 --> 00:06:06,318
are just

183
00:06:03,360 --> 00:06:07,120
protocols we start to think we always

184
00:06:06,319 --> 00:06:09,120
talk about

185
00:06:07,120 --> 00:06:11,440
are you running x or whatever and x is

186
00:06:09,120 --> 00:06:14,319
basically just a protocol that we speak

187
00:06:11,440 --> 00:06:15,440
and um then an application speaks that

188
00:06:14,319 --> 00:06:17,120
draw me like that

189
00:06:15,440 --> 00:06:19,600
draw me like one of your french windows

190
00:06:17,120 --> 00:06:21,199
i don't know um

191
00:06:19,600 --> 00:06:23,360
and also wayland dissolves so those are

192
00:06:21,199 --> 00:06:26,800
just protocols like tcp

193
00:06:23,360 --> 00:06:28,080
so how do we manage events how do we

194
00:06:26,800 --> 00:06:29,759
want to look like

195
00:06:28,080 --> 00:06:31,280
whatever and this is what these two

196
00:06:29,759 --> 00:06:33,840
things do

197
00:06:31,280 --> 00:06:34,799
so let's look at x first so i stole

198
00:06:33,840 --> 00:06:37,198
these from

199
00:06:34,800 --> 00:06:38,720
uh the whalen page um so this is this is

200
00:06:37,199 --> 00:06:41,440
like the situation you have with

201
00:06:38,720 --> 00:06:42,240
whale and this step with with x this

202
00:06:41,440 --> 00:06:45,600
step is sort of

203
00:06:42,240 --> 00:06:46,319
optional and what happens if first you

204
00:06:45,600 --> 00:06:48,560
press

205
00:06:46,319 --> 00:06:50,319
a button you generate an event you send

206
00:06:48,560 --> 00:06:51,199
it to the x server the x server figures

207
00:06:50,319 --> 00:06:54,560
out

208
00:06:51,199 --> 00:06:57,520
um what client it sends this event to

209
00:06:54,560 --> 00:06:58,000
like your terminal or your lock screen

210
00:06:57,520 --> 00:07:00,080
or

211
00:06:58,000 --> 00:07:01,919
your window manager your window manager

212
00:07:00,080 --> 00:07:03,520
basically is a client to the x server

213
00:07:01,919 --> 00:07:07,120
it's like any other program

214
00:07:03,520 --> 00:07:09,680
so it sends it there then it this client

215
00:07:07,120 --> 00:07:10,720
replies what it ever like i want to look

216
00:07:09,680 --> 00:07:13,199
different now or

217
00:07:10,720 --> 00:07:14,639
i did something and it communicates this

218
00:07:13,199 --> 00:07:16,720
back to the x server

219
00:07:14,639 --> 00:07:17,759
and when you have a separate process

220
00:07:16,720 --> 00:07:20,880
like compton

221
00:07:17,759 --> 00:07:22,720
it basically sends that the

222
00:07:20,880 --> 00:07:24,240
all this stuff over to the compositor

223
00:07:22,720 --> 00:07:25,520
the compositor does something overwrites

224
00:07:24,240 --> 00:07:28,000
everything that the x server does

225
00:07:25,520 --> 00:07:29,599
and um yeah so there's a lot going on

226
00:07:28,000 --> 00:07:31,599
here and you can see

227
00:07:29,599 --> 00:07:32,639
all these different processes a lot of

228
00:07:31,599 --> 00:07:34,080
context switching

229
00:07:32,639 --> 00:07:35,759
a lot of work that the computer has to

230
00:07:34,080 --> 00:07:37,280
do just to talk to

231
00:07:35,759 --> 00:07:39,759
just basically when you're pressing a

232
00:07:37,280 --> 00:07:43,440
button like hell breaks loose

233
00:07:39,759 --> 00:07:45,599
um yeah and as i said before your

234
00:07:43,440 --> 00:07:47,120
ex your window manager is also just a

235
00:07:45,599 --> 00:07:49,039
client and this becomes interesting in

236
00:07:47,120 --> 00:07:52,080
the future spoiler

237
00:07:49,039 --> 00:07:53,759
so yeah what does

238
00:07:52,080 --> 00:07:55,120
a window manager look like so this is

239
00:07:53,759 --> 00:07:56,879
the most minimal

240
00:07:55,120 --> 00:07:59,280
window manager i could find on the

241
00:07:56,879 --> 00:08:01,919
internet it's called tiny wm

242
00:07:59,280 --> 00:08:03,520
by nick welsh and it basically fits on a

243
00:08:01,919 --> 00:08:04,479
slide i don't expect you to read that

244
00:08:03,520 --> 00:08:07,520
you shouldn't

245
00:08:04,479 --> 00:08:08,719
but this is i just wanted to show you

246
00:08:07,520 --> 00:08:11,280
how much work

247
00:08:08,720 --> 00:08:13,039
it takes to really get something working

248
00:08:11,280 --> 00:08:15,039
and this is what i found it was kind of

249
00:08:13,039 --> 00:08:18,719
impressive because after a week

250
00:08:15,039 --> 00:08:20,878
i had a working window manager that was

251
00:08:18,720 --> 00:08:22,879
like oh wow this is this is kind of cool

252
00:08:20,879 --> 00:08:25,120
because in the exterior we have

253
00:08:22,879 --> 00:08:26,960
all this functionality everything is

254
00:08:25,120 --> 00:08:28,879
ready for the taking

255
00:08:26,960 --> 00:08:30,960
everything is already there so yeah why

256
00:08:28,879 --> 00:08:34,000
not just use it so i thought well

257
00:08:30,960 --> 00:08:36,240
this is kind of neat well we me

258
00:08:34,000 --> 00:08:38,080
maybe maybe this ex stuff isn't so bad

259
00:08:36,240 --> 00:08:41,760
after all

260
00:08:38,080 --> 00:08:42,800
um and now that we know our window

261
00:08:41,760 --> 00:08:44,640
manager looks like

262
00:08:42,799 --> 00:08:46,640
we want to figure out how to to speak

263
00:08:44,640 --> 00:08:49,839
this protocol that i was talking about

264
00:08:46,640 --> 00:08:52,000
how do we speak x and there are two

265
00:08:49,839 --> 00:08:53,920
ways to speak to the x server the first

266
00:08:52,000 --> 00:08:54,959
one is like the traditional way it's

267
00:08:53,920 --> 00:08:59,279
called xlib

268
00:08:54,959 --> 00:09:02,959
and it's very synchronous so

269
00:08:59,279 --> 00:09:06,080
you talk to the ex server then you wait

270
00:09:02,959 --> 00:09:09,199
then a reply comes then you do something

271
00:09:06,080 --> 00:09:11,440
and as you can see you write the request

272
00:09:09,200 --> 00:09:12,560
you wait you read and this this this

273
00:09:11,440 --> 00:09:15,680
blocks a lot

274
00:09:12,560 --> 00:09:18,000
and you can see that uh in some of the

275
00:09:15,680 --> 00:09:20,880
window managers that are basically using

276
00:09:18,000 --> 00:09:22,320
uh xlip that it's not as snappy as you

277
00:09:20,880 --> 00:09:24,720
would like it to be because

278
00:09:22,320 --> 00:09:26,240
why would you just write request them

279
00:09:24,720 --> 00:09:28,320
and wait for the answer maybe you don't

280
00:09:26,240 --> 00:09:30,160
need that immediately maybe you want to

281
00:09:28,320 --> 00:09:32,800
write couple of requests and then

282
00:09:30,160 --> 00:09:34,319
later consume the responses and this is

283
00:09:32,800 --> 00:09:36,959
basically what xcb does

284
00:09:34,320 --> 00:09:38,320
so xcb is the xc binding which is

285
00:09:36,959 --> 00:09:40,560
sitting underneath

286
00:09:38,320 --> 00:09:42,160
the xlip and we can talk to that

287
00:09:40,560 --> 00:09:43,760
directly and now we can just

288
00:09:42,160 --> 00:09:45,199
write all these different different

289
00:09:43,760 --> 00:09:47,360
requests and then

290
00:09:45,200 --> 00:09:48,399
we get the responses and this is pretty

291
00:09:47,360 --> 00:09:51,040
this is really

292
00:09:48,399 --> 00:09:52,640
making a difference so with my first

293
00:09:51,040 --> 00:09:54,880
implementation of hikari

294
00:09:52,640 --> 00:09:55,680
i was comparing this against cwm all the

295
00:09:54,880 --> 00:09:58,480
time

296
00:09:55,680 --> 00:09:59,279
that felt way snappier that was like

297
00:09:58,480 --> 00:10:02,640
because

298
00:09:59,279 --> 00:10:05,120
um all the stuff that i saw in in

299
00:10:02,640 --> 00:10:06,880
cwm maybe they are using xdb somewhere

300
00:10:05,120 --> 00:10:09,360
down down the stack but i don't know

301
00:10:06,880 --> 00:10:11,040
they are using xslip and you can really

302
00:10:09,360 --> 00:10:14,720
sometimes see when you're switching

303
00:10:11,040 --> 00:10:16,480
between groups it takes some time

304
00:10:14,720 --> 00:10:19,200
until everything gets redrawn and it's

305
00:10:16,480 --> 00:10:22,720
kind of annoying

306
00:10:19,200 --> 00:10:23,920
so um let's talk a little bit about how

307
00:10:22,720 --> 00:10:25,519
the excel draws things

308
00:10:23,920 --> 00:10:27,120
because obviously when you draw windows

309
00:10:25,519 --> 00:10:29,200
you need an order in which you want to

310
00:10:27,120 --> 00:10:32,160
draw them

311
00:10:29,200 --> 00:10:32,959
so we usually draw from top to bottom

312
00:10:32,160 --> 00:10:34,319
and

313
00:10:32,959 --> 00:10:36,239
most of the time this is also your

314
00:10:34,320 --> 00:10:38,480
stacking order in which you want to

315
00:10:36,240 --> 00:10:40,320
cycle through the windows i want to just

316
00:10:38,480 --> 00:10:42,320
go up and down the stack if you're using

317
00:10:40,320 --> 00:10:45,680
a stacking window manager

318
00:10:42,320 --> 00:10:48,079
and yeah so this is

319
00:10:45,680 --> 00:10:49,839
the first place where i got a little bit

320
00:10:48,079 --> 00:10:53,680
okay what's going on here

321
00:10:49,839 --> 00:10:55,120
because um when you have this i showed

322
00:10:53,680 --> 00:10:57,920
you this group

323
00:10:55,120 --> 00:10:59,279
thing that i had i can group windows

324
00:10:57,920 --> 00:11:00,399
kind of differently i want to cycle

325
00:10:59,279 --> 00:11:02,720
between groups

326
00:11:00,399 --> 00:11:04,640
and now i have some sort of ordering

327
00:11:02,720 --> 00:11:06,480
inside of my window manager that the x

328
00:11:04,640 --> 00:11:09,120
server knows nothing about

329
00:11:06,480 --> 00:11:10,399
and you kind of like when you look at

330
00:11:09,120 --> 00:11:12,079
other window managers you see

331
00:11:10,399 --> 00:11:13,600
a lot of them are re-implementing this

332
00:11:12,079 --> 00:11:16,239
functionality where you

333
00:11:13,600 --> 00:11:17,839
how do you order your windows basically

334
00:11:16,240 --> 00:11:19,440
everyone's doing that you re-implement

335
00:11:17,839 --> 00:11:21,680
it so the egg server knows

336
00:11:19,440 --> 00:11:22,640
has an order in which it drives draws

337
00:11:21,680 --> 00:11:25,359
the windows

338
00:11:22,640 --> 00:11:26,800
and you on the window manager side have

339
00:11:25,360 --> 00:11:27,120
the order in which you want to cycle

340
00:11:26,800 --> 00:11:29,680
them

341
00:11:27,120 --> 00:11:31,120
or stack them or whatever so you are

342
00:11:29,680 --> 00:11:33,760
basically having

343
00:11:31,120 --> 00:11:35,200
this thing in two places which is kind

344
00:11:33,760 --> 00:11:37,200
of annoying

345
00:11:35,200 --> 00:11:38,480
um because you have to keep them in sync

346
00:11:37,200 --> 00:11:41,680
and things

347
00:11:38,480 --> 00:11:44,800
things can go pretty bad another very

348
00:11:41,680 --> 00:11:45,680
fun thing that i i just started another

349
00:11:44,800 --> 00:11:49,439
terminal

350
00:11:45,680 --> 00:11:52,479
um and you see these

351
00:11:49,440 --> 00:11:54,399
see these borders there um these

352
00:11:52,480 --> 00:11:55,600
orange borders that are drawn over the

353
00:11:54,399 --> 00:11:57,360
other window

354
00:11:55,600 --> 00:11:58,959
and exit you're doing that in a very

355
00:11:57,360 --> 00:12:02,560
very ugly way because

356
00:11:58,959 --> 00:12:03,279
basically every line there and i didn't

357
00:12:02,560 --> 00:12:04,719
make this up

358
00:12:03,279 --> 00:12:07,040
other window managers are doing this as

359
00:12:04,720 --> 00:12:09,200
well this is a window this is a window

360
00:12:07,040 --> 00:12:10,880
this is a window and this is a window

361
00:12:09,200 --> 00:12:12,880
and you just give it a background color

362
00:12:10,880 --> 00:12:16,320
and this is

363
00:12:12,880 --> 00:12:19,360
so open box is doing that

364
00:12:16,320 --> 00:12:21,200
i was doing that as well and when you

365
00:12:19,360 --> 00:12:23,839
have a stacking window manager

366
00:12:21,200 --> 00:12:24,240
you always have to keep those on top

367
00:12:23,839 --> 00:12:27,680
which

368
00:12:24,240 --> 00:12:30,800
is fun it isn't

369
00:12:27,680 --> 00:12:32,560
uh can be pretty frustrating so yeah

370
00:12:30,800 --> 00:12:35,599
that was the first thing i was like

371
00:12:32,560 --> 00:12:37,119
why do i have to do that annoying

372
00:12:35,600 --> 00:12:38,880
and another thing that you will see

373
00:12:37,120 --> 00:12:40,320
pretty quickly when you're not running

374
00:12:38,880 --> 00:12:42,959
things like compton

375
00:12:40,320 --> 00:12:43,760
is screen artifacts so imagine you have

376
00:12:42,959 --> 00:12:47,040
this window too

377
00:12:43,760 --> 00:12:50,240
and you want to erase it so we do that

378
00:12:47,040 --> 00:12:51,199
we probably need to redraw this part of

379
00:12:50,240 --> 00:12:52,800
the window

380
00:12:51,200 --> 00:12:54,320
and what x does is like it sends an

381
00:12:52,800 --> 00:12:56,399
exposed event to that window

382
00:12:54,320 --> 00:12:57,839
to that client just like hey you've been

383
00:12:56,399 --> 00:13:00,320
exposed please

384
00:12:57,839 --> 00:13:02,079
draw yourself show me how you look like

385
00:13:00,320 --> 00:13:03,600
and

386
00:13:02,079 --> 00:13:05,680
if you're running on power management or

387
00:13:03,600 --> 00:13:06,000
something you can watch the window

388
00:13:05,680 --> 00:13:09,199
getting

389
00:13:06,000 --> 00:13:09,680
redrawn and we sort of learn to accept

390
00:13:09,200 --> 00:13:11,600
that

391
00:13:09,680 --> 00:13:13,439
and it's kind of funny when you draw a

392
00:13:11,600 --> 00:13:16,440
window over other

393
00:13:13,440 --> 00:13:19,120
windows you get this nice little windows

394
00:13:16,440 --> 00:13:22,240
95-esque effect

395
00:13:19,120 --> 00:13:24,639
it's beautiful modern art

396
00:13:22,240 --> 00:13:25,920
um yeah this this was really i mean it

397
00:13:24,639 --> 00:13:27,920
gets a lot better when you're doing

398
00:13:25,920 --> 00:13:30,800
compositing and things like that but

399
00:13:27,920 --> 00:13:32,240
um well when you do compositing your

400
00:13:30,800 --> 00:13:34,479
clients still have to

401
00:13:32,240 --> 00:13:36,320
have to implement that functionality as

402
00:13:34,480 --> 00:13:38,399
your libraries at least have to do that

403
00:13:36,320 --> 00:13:40,240
because you cannot depend on the fact

404
00:13:38,399 --> 00:13:44,399
that a compositor is always present

405
00:13:40,240 --> 00:13:48,160
so yay useless code lying around there

406
00:13:44,399 --> 00:13:51,199
um yeah so things are getting like

407
00:13:48,160 --> 00:13:52,880
pretty weird um so you fail

408
00:13:51,199 --> 00:13:54,639
handling supposed events when you don't

409
00:13:52,880 --> 00:13:57,680
actually do need them

410
00:13:54,639 --> 00:13:59,839
it's yeah it's weird so

411
00:13:57,680 --> 00:14:01,279
go back to the mentally go back to the

412
00:13:59,839 --> 00:14:04,399
thing where i told you that

413
00:14:01,279 --> 00:14:05,920
we had that every client is

414
00:14:04,399 --> 00:14:07,519
every every window manager is always

415
00:14:05,920 --> 00:14:10,479
also just a client

416
00:14:07,519 --> 00:14:11,440
that means that the x server is

417
00:14:10,480 --> 00:14:13,440
basically

418
00:14:11,440 --> 00:14:14,560
handling all the events and stuff like

419
00:14:13,440 --> 00:14:16,079
that so

420
00:14:14,560 --> 00:14:18,719
your window manager is just a client so

421
00:14:16,079 --> 00:14:22,560
it has to ask for events

422
00:14:18,720 --> 00:14:24,079
so um when i do something like this

423
00:14:22,560 --> 00:14:26,959
and i want to put that in a different

424
00:14:24,079 --> 00:14:30,638
group oops

425
00:14:26,959 --> 00:14:33,760
so now this one has input and i can

426
00:14:30,639 --> 00:14:36,000
do type type e and all this stuff

427
00:14:33,760 --> 00:14:37,120
now my windowman's real compositor it

428
00:14:36,000 --> 00:14:39,920
just grabs the events

429
00:14:37,120 --> 00:14:40,639
and you type in there and all the all

430
00:14:39,920 --> 00:14:42,639
the events

431
00:14:40,639 --> 00:14:44,480
get sent to my my compositor instead of

432
00:14:42,639 --> 00:14:48,399
client so when i'm in

433
00:14:44,480 --> 00:14:50,480
x i have to fight for the right

434
00:14:48,399 --> 00:14:51,760
to process input events and this is how

435
00:14:50,480 --> 00:14:53,600
awesome does it

436
00:14:51,760 --> 00:14:56,079
awesome basically just tries a thousand

437
00:14:53,600 --> 00:14:57,680
times please give me that keyboard

438
00:14:56,079 --> 00:14:59,199
i am the winner manager i am in charge

439
00:14:57,680 --> 00:15:03,680
please give it to me

440
00:14:59,199 --> 00:15:06,639
um and it waits tries again and

441
00:15:03,680 --> 00:15:07,599
for about a second you're well i mean

442
00:15:06,639 --> 00:15:09,360
the awesome people

443
00:15:07,600 --> 00:15:11,040
they know what they're doing but yeah

444
00:15:09,360 --> 00:15:13,920
this is fun um

445
00:15:11,040 --> 00:15:14,560
i had to implement this myself and it

446
00:15:13,920 --> 00:15:18,160
felt

447
00:15:14,560 --> 00:15:19,518
wrong i don't know why exactly i know

448
00:15:18,160 --> 00:15:21,439
why it felt wrong but

449
00:15:19,519 --> 00:15:23,120
yeah this is like you are in the window

450
00:15:21,440 --> 00:15:25,680
manager should be in charge but

451
00:15:23,120 --> 00:15:26,240
now you're just please give me resources

452
00:15:25,680 --> 00:15:29,920
uh

453
00:15:26,240 --> 00:15:34,079
because i really need those um yeah

454
00:15:29,920 --> 00:15:37,360
fun stuff um so yeah so this

455
00:15:34,079 --> 00:15:40,479
was my my journey into the world of x uh

456
00:15:37,360 --> 00:15:41,839
as you can as can feel i have some

457
00:15:40,480 --> 00:15:43,680
issues

458
00:15:41,839 --> 00:15:45,360
with there but it was very easy to get

459
00:15:43,680 --> 00:15:46,079
something up and running like having a

460
00:15:45,360 --> 00:15:48,320
working

461
00:15:46,079 --> 00:15:50,239
window manager that you could like use

462
00:15:48,320 --> 00:15:53,600
in your day job after week is like

463
00:15:50,240 --> 00:15:56,880
yay feel pro hacker

464
00:15:53,600 --> 00:15:58,720
no but yes it works nice um

465
00:15:56,880 --> 00:16:00,160
but yeah graphically you have interfaces

466
00:15:58,720 --> 00:16:02,480
also have evolved and you have tough

467
00:16:00,160 --> 00:16:05,759
screens we have things that can rotate

468
00:16:02,480 --> 00:16:06,959
for some reason and um also toolkits

469
00:16:05,759 --> 00:16:08,720
have evolved you have

470
00:16:06,959 --> 00:16:10,800
things like off-screen rendering and

471
00:16:08,720 --> 00:16:11,920
buffers that get flipped around so

472
00:16:10,800 --> 00:16:14,560
things look smooth

473
00:16:11,920 --> 00:16:15,519
and you also have those in in x you also

474
00:16:14,560 --> 00:16:17,758
have those nice

475
00:16:15,519 --> 00:16:18,720
extensions or protocol extensions that

476
00:16:17,759 --> 00:16:20,240
you or usually

477
00:16:18,720 --> 00:16:22,160
stumble in when you're trying to start

478
00:16:20,240 --> 00:16:24,000
firefox which nia

479
00:16:22,160 --> 00:16:25,839
also mentioned his interest doing

480
00:16:24,000 --> 00:16:27,680
interesting things with the computer

481
00:16:25,839 --> 00:16:29,199
um yeah that's that's also fun when you

482
00:16:27,680 --> 00:16:30,479
start a client that's using a protocol

483
00:16:29,199 --> 00:16:31,279
that you never heard of before and

484
00:16:30,480 --> 00:16:34,000
things started

485
00:16:31,279 --> 00:16:35,120
look weird and windows jump around and

486
00:16:34,000 --> 00:16:38,399
resize themselves

487
00:16:35,120 --> 00:16:40,959
for weird reasons yeah but the main

488
00:16:38,399 --> 00:16:42,240
problem that i'm having is x is a global

489
00:16:40,959 --> 00:16:45,119
namespace

490
00:16:42,240 --> 00:16:45,920
um so every client at every point in

491
00:16:45,120 --> 00:16:48,720
time can just

492
00:16:45,920 --> 00:16:50,079
turn into a win a key logger or a screen

493
00:16:48,720 --> 00:16:51,120
recorder and just send that over the

494
00:16:50,079 --> 00:16:53,680
wire and

495
00:16:51,120 --> 00:16:55,519
because like in every window even knows

496
00:16:53,680 --> 00:16:58,800
where it is on the screen

497
00:16:55,519 --> 00:17:00,720
why i mean this is weird

498
00:16:58,800 --> 00:17:02,160
um and you're you're duplicating

499
00:17:00,720 --> 00:17:03,279
functionality and you have screen

500
00:17:02,160 --> 00:17:04,959
artifacts and

501
00:17:03,279 --> 00:17:08,240
all these things that we've kind of

502
00:17:04,959 --> 00:17:11,280
learned to accept but yeah

503
00:17:08,240 --> 00:17:12,400
so what's this other thing wayland um i

504
00:17:11,280 --> 00:17:14,000
actually started with them

505
00:17:12,400 --> 00:17:15,919
with looking into that and people

506
00:17:14,000 --> 00:17:16,480
started bugging me was have weight on

507
00:17:15,919 --> 00:17:19,120
sport

508
00:17:16,480 --> 00:17:19,679
i was like nah just i'm going to use

509
00:17:19,119 --> 00:17:22,958
things that

510
00:17:19,679 --> 00:17:26,240
work like x

511
00:17:22,959 --> 00:17:28,640
yeah past me

512
00:17:26,240 --> 00:17:30,480
i don't know what was wrong with me back

513
00:17:28,640 --> 00:17:32,799
then yeah and also saw

514
00:17:30,480 --> 00:17:35,039
nice little screen tearing effects when

515
00:17:32,799 --> 00:17:37,039
a friend of mine was using my compo

516
00:17:35,039 --> 00:17:38,160
my window manager and started strolling

517
00:17:37,039 --> 00:17:41,039
in in

518
00:17:38,160 --> 00:17:42,480
firefox and it wasn't fun it looked like

519
00:17:41,039 --> 00:17:45,280
i'm not going to say that

520
00:17:42,480 --> 00:17:46,480
it looked not good but yeah this is the

521
00:17:45,280 --> 00:17:48,240
situation with with

522
00:17:46,480 --> 00:17:50,240
weyland and you can see it's a lot more

523
00:17:48,240 --> 00:17:51,039
cleaned up because now we have the x

524
00:17:50,240 --> 00:17:53,600
server

525
00:17:51,039 --> 00:17:54,640
like the display server the window

526
00:17:53,600 --> 00:17:56,799
manager

527
00:17:54,640 --> 00:17:58,000
and the compositor it's all wrote into

528
00:17:56,799 --> 00:18:00,080
run process

529
00:17:58,000 --> 00:18:01,039
so you're not jumping around a lot

530
00:18:00,080 --> 00:18:02,799
anymore and that

531
00:18:01,039 --> 00:18:05,039
also really makes a difference context

532
00:18:02,799 --> 00:18:07,120
switches especially because intel has

533
00:18:05,039 --> 00:18:09,600
done such amazingly great work with

534
00:18:07,120 --> 00:18:11,199
uh things that have become quite

535
00:18:09,600 --> 00:18:14,959
expensive

536
00:18:11,200 --> 00:18:17,600
um yes and uh this really

537
00:18:14,960 --> 00:18:19,840
really helps and now what happens now is

538
00:18:17,600 --> 00:18:22,320
your client basically just gets

539
00:18:19,840 --> 00:18:23,120
a surface and it just draws stuff in

540
00:18:22,320 --> 00:18:25,039
there and

541
00:18:23,120 --> 00:18:26,799
tells the compositor please use that so

542
00:18:25,039 --> 00:18:28,720
we're automatically using a shared

543
00:18:26,799 --> 00:18:31,360
memory model

544
00:18:28,720 --> 00:18:33,039
which is nice because now we can have

545
00:18:31,360 --> 00:18:34,639
things like the client can handle like

546
00:18:33,039 --> 00:18:36,400
stuff like buffering and

547
00:18:34,640 --> 00:18:38,000
so smooth transitions and stuff like

548
00:18:36,400 --> 00:18:40,000
that

549
00:18:38,000 --> 00:18:41,919
most libraries do that you don't have to

550
00:18:40,000 --> 00:18:42,480
care about this this is this is great

551
00:18:41,919 --> 00:18:46,160
you can

552
00:18:42,480 --> 00:18:49,120
get this for free and yeah now

553
00:18:46,160 --> 00:18:50,000
mia said that um you have stuff like

554
00:18:49,120 --> 00:18:51,600
screen lockers

555
00:18:50,000 --> 00:18:53,760
like i said before screen locker is a

556
00:18:51,600 --> 00:18:56,399
really weird process because you start

557
00:18:53,760 --> 00:18:57,919
an arbitrary process and now it gets all

558
00:18:56,400 --> 00:19:00,400
the input events

559
00:18:57,919 --> 00:19:00,400
okay

560
00:19:01,360 --> 00:19:05,520
i cannot see how you can exploit that

561
00:19:06,240 --> 00:19:10,000
well yeah anyway but now the compositor

562
00:19:09,440 --> 00:19:12,559
has a lot

563
00:19:10,000 --> 00:19:13,679
more stuff to do and actually uh i'm

564
00:19:12,559 --> 00:19:15,678
doing screen locking

565
00:19:13,679 --> 00:19:16,960
in my compositor uh which is also nice

566
00:19:15,679 --> 00:19:18,799
to kind of can turn off the screen

567
00:19:16,960 --> 00:19:21,039
stuff like that and save energy which is

568
00:19:18,799 --> 00:19:22,480
also neat these days

569
00:19:21,039 --> 00:19:24,320
but yeah this is this is how it looks

570
00:19:22,480 --> 00:19:27,679
like with weyland

571
00:19:24,320 --> 00:19:30,879
and uh yeah every frame is perfect

572
00:19:27,679 --> 00:19:32,720
um this is everything available evolves

573
00:19:30,880 --> 00:19:34,960
around the idea that frames

574
00:19:32,720 --> 00:19:37,440
frames are should be quite perfect you

575
00:19:34,960 --> 00:19:38,960
don't have screen tearing you don't have

576
00:19:37,440 --> 00:19:40,720
things when you're scrolling things are

577
00:19:38,960 --> 00:19:42,480
starting to look weird or

578
00:19:40,720 --> 00:19:44,720
expose a window and then you see just

579
00:19:42,480 --> 00:19:47,039
half the window and watch it get itself

580
00:19:44,720 --> 00:19:49,440
redrawn which is super annoying

581
00:19:47,039 --> 00:19:50,400
but uh i actually wanted to show a demo

582
00:19:49,440 --> 00:19:53,760
where i demo

583
00:19:50,400 --> 00:19:56,720
um all this damage stuff but

584
00:19:53,760 --> 00:19:57,760
basically my compositor only redraws the

585
00:19:56,720 --> 00:20:00,080
things that the client

586
00:19:57,760 --> 00:20:01,039
tells it to i'm not not currently

587
00:20:00,080 --> 00:20:02,399
running not the

588
00:20:01,039 --> 00:20:04,320
it's not the debug version so i can't

589
00:20:02,400 --> 00:20:05,280
show you but it's actually kind of nice

590
00:20:04,320 --> 00:20:08,080
when you

591
00:20:05,280 --> 00:20:09,039
just start this and you type into a

592
00:20:08,080 --> 00:20:10,240
terminal and

593
00:20:09,039 --> 00:20:12,158
the only thing that actually gets

594
00:20:10,240 --> 00:20:12,960
redrawn is like the part where you're

595
00:20:12,159 --> 00:20:14,960
typing

596
00:20:12,960 --> 00:20:16,480
this this is pretty neat you're not just

597
00:20:14,960 --> 00:20:20,320
redrawing everything

598
00:20:16,480 --> 00:20:23,679
um so but since we're using this this

599
00:20:20,320 --> 00:20:26,158
double buffering stuff um

600
00:20:23,679 --> 00:20:27,440
we we really just the client says okay

601
00:20:26,159 --> 00:20:29,039
draw this and then

602
00:20:27,440 --> 00:20:31,520
we just flip buffers and stuff like that

603
00:20:29,039 --> 00:20:33,600
but you have to take care that this

604
00:20:31,520 --> 00:20:34,879
uh this works correctly because you can

605
00:20:33,600 --> 00:20:37,760
have very interesting

606
00:20:34,880 --> 00:20:39,440
artifacts when you're not telling this

607
00:20:37,760 --> 00:20:42,000
you should redraw this part

608
00:20:39,440 --> 00:20:43,360
of the screen um you have to take care

609
00:20:42,000 --> 00:20:46,559
of that then compositor but

610
00:20:43,360 --> 00:20:47,520
uh thankfully um there you can read

611
00:20:46,559 --> 00:20:49,840
those blog post it's

612
00:20:47,520 --> 00:20:51,360
by one of the authors of the wl roots

613
00:20:49,840 --> 00:20:53,760
library how to handle

614
00:20:51,360 --> 00:20:55,280
um how this all of this works but

615
00:20:53,760 --> 00:20:56,640
basically the library that i'm using is

616
00:20:55,280 --> 00:20:58,639
taking care of that

617
00:20:56,640 --> 00:21:01,520
so what library have i mean using so

618
00:20:58,640 --> 00:21:04,640
i've used the wl roots library

619
00:21:01,520 --> 00:21:08,158
yep that's plain uh 10 minutes left

620
00:21:04,640 --> 00:21:10,240
so i'm using the wf like uh wl roots

621
00:21:08,159 --> 00:21:12,799
library which is 50 000 lines of

622
00:21:10,240 --> 00:21:14,000
c code that i was had to write myself

623
00:21:12,799 --> 00:21:16,879
and i didn't want to do that so

624
00:21:14,000 --> 00:21:19,360
thankfully someone else did um

625
00:21:16,880 --> 00:21:21,039
it's the foundation for sway which is

626
00:21:19,360 --> 00:21:24,000
like i34

627
00:21:21,039 --> 00:21:25,520
for uh weyland and it's probably on one

628
00:21:24,000 --> 00:21:27,360
of the most popular

629
00:21:25,520 --> 00:21:28,639
just standalone compositors that's not

630
00:21:27,360 --> 00:21:31,600
embedded into a

631
00:21:28,640 --> 00:21:33,039
desktop environment and and it reached

632
00:21:31,600 --> 00:21:36,879
um

633
00:21:33,039 --> 00:21:38,799
1.0 0.1 in in october that was

634
00:21:36,880 --> 00:21:40,880
after i started working on the x thing

635
00:21:38,799 --> 00:21:43,039
so yeah i

636
00:21:40,880 --> 00:21:44,000
came late came cam i came early to the

637
00:21:43,039 --> 00:21:47,200
party but not before

638
00:21:44,000 --> 00:21:49,760
it was it had its first stable release

639
00:21:47,200 --> 00:21:51,039
um and it's now the common ground for a

640
00:21:49,760 --> 00:21:54,320
lot of compositors so

641
00:21:51,039 --> 00:21:55,679
uh sway is using that cage uh it's just

642
00:21:54,320 --> 00:21:57,200
a little kiosky thing

643
00:21:55,679 --> 00:21:59,039
it's also an interesting implementation

644
00:21:57,200 --> 00:22:01,039
that you can look at it's probably one

645
00:21:59,039 --> 00:22:04,720
of the most minimal things

646
00:22:01,039 --> 00:22:07,200
and um there's tiny wl which is shipped

647
00:22:04,720 --> 00:22:09,200
with wl roots which is

648
00:22:07,200 --> 00:22:11,200
the really smallest use case that you

649
00:22:09,200 --> 00:22:12,000
can have and it's just like a thousand

650
00:22:11,200 --> 00:22:13,760
line of code

651
00:22:12,000 --> 00:22:15,280
well the other one fit on a slide this

652
00:22:13,760 --> 00:22:16,158
is a thousand lines of code it sounds

653
00:22:15,280 --> 00:22:18,799
like much but

654
00:22:16,159 --> 00:22:20,080
remember this is the display server the

655
00:22:18,799 --> 00:22:22,320
compositors every

656
00:22:20,080 --> 00:22:23,360
it's everything in one process so i

657
00:22:22,320 --> 00:22:24,960
think a thousand line of

658
00:22:23,360 --> 00:22:26,799
lines of code is is actually kind of

659
00:22:24,960 --> 00:22:30,400
nice

660
00:22:26,799 --> 00:22:32,639
um yeah and some things that

661
00:22:30,400 --> 00:22:34,080
when you're starting to run uh one

662
00:22:32,640 --> 00:22:36,480
railand

663
00:22:34,080 --> 00:22:39,360
most of these libraries that we mostly

664
00:22:36,480 --> 00:22:42,720
use on like gtk qt clutter and stl

665
00:22:39,360 --> 00:22:44,719
all of them already have waylon backends

666
00:22:42,720 --> 00:22:46,080
so you don't have to care about this you

667
00:22:44,720 --> 00:22:49,039
start a process and

668
00:22:46,080 --> 00:22:50,000
it just works so i'm using sakura which

669
00:22:49,039 --> 00:22:52,960
is a very minimal

670
00:22:50,000 --> 00:22:54,799
gtk terminal and i didn't have to tell

671
00:22:52,960 --> 00:22:55,520
it anything it just starts and it's

672
00:22:54,799 --> 00:22:57,280
already

673
00:22:55,520 --> 00:22:59,120
using well on because it says oh there's

674
00:22:57,280 --> 00:23:02,559
a waiting process

675
00:22:59,120 --> 00:23:05,199
i can just use this back end now

676
00:23:02,559 --> 00:23:05,918
and um what you see right now is firefox

677
00:23:05,200 --> 00:23:09,200
natively

678
00:23:05,919 --> 00:23:12,080
running wayland my compositor has not

679
00:23:09,200 --> 00:23:13,200
no currently xylene support is a bit

680
00:23:12,080 --> 00:23:15,039
broken for me because i'm not

681
00:23:13,200 --> 00:23:18,559
maintaining it anymore because i'm

682
00:23:15,039 --> 00:23:20,240
just using uh native whaling

683
00:23:18,559 --> 00:23:21,600
clients at the moment probably need to

684
00:23:20,240 --> 00:23:25,280
fix that in the future

685
00:23:21,600 --> 00:23:27,918
but um yeah you can pretty quickly

686
00:23:25,280 --> 00:23:29,200
uh replace everything with with weyland

687
00:23:27,919 --> 00:23:31,360
native stuff and you don't have to care

688
00:23:29,200 --> 00:23:32,880
about axe anymore which is kind of nice

689
00:23:31,360 --> 00:23:34,479
and you also have clipboard stuff that

690
00:23:32,880 --> 00:23:36,240
makes my new vent happy

691
00:23:34,480 --> 00:23:38,159
video firefox if you're using

692
00:23:36,240 --> 00:23:39,840
thunderbird you just have to set this

693
00:23:38,159 --> 00:23:42,320
environment variable and

694
00:23:39,840 --> 00:23:43,199
everything starts to work which is

695
00:23:42,320 --> 00:23:47,039
pretty neat you

696
00:23:43,200 --> 00:23:50,720
don't see a lot of weird stuff happening

697
00:23:47,039 --> 00:23:53,760
so yeah um it's it's

698
00:23:50,720 --> 00:23:56,240
so this was what what this felt like

699
00:23:53,760 --> 00:23:56,799
uh but it was harder to get something up

700
00:23:56,240 --> 00:23:59,039
and running

701
00:23:56,799 --> 00:24:01,039
it took me like three or four months to

702
00:23:59,039 --> 00:24:01,440
really feel confident enough to use it

703
00:24:01,039 --> 00:24:04,879
at

704
00:24:01,440 --> 00:24:05,600
daily work which was yeah way more work

705
00:24:04,880 --> 00:24:09,279
than a week

706
00:24:05,600 --> 00:24:10,879
of course um well it and the the

707
00:24:09,279 --> 00:24:12,240
final product that i'm having right now

708
00:24:10,880 --> 00:24:13,039
even though it's more powerful it's

709
00:24:12,240 --> 00:24:14,559
roughly

710
00:24:13,039 --> 00:24:16,640
the same amount of code that you have

711
00:24:14,559 --> 00:24:18,639
there um which

712
00:24:16,640 --> 00:24:21,039
i think is also kind of neat a few

713
00:24:18,640 --> 00:24:23,600
processes aren't involved

714
00:24:21,039 --> 00:24:24,640
like i said um the nice thing about this

715
00:24:23,600 --> 00:24:27,918
is that you are

716
00:24:24,640 --> 00:24:30,400
really really saving battery life there

717
00:24:27,919 --> 00:24:31,600
and you have true ui's isolation which i

718
00:24:30,400 --> 00:24:34,480
think is really awesome

719
00:24:31,600 --> 00:24:36,320
every client just thinks it's the only

720
00:24:34,480 --> 00:24:39,039
thing on the planet

721
00:24:36,320 --> 00:24:41,279
so one client cannot look into the

722
00:24:39,039 --> 00:24:44,840
buffers of another client

723
00:24:41,279 --> 00:24:46,159
which actually is very interesting

724
00:24:44,840 --> 00:24:48,000
security

725
00:24:46,159 --> 00:24:50,080
issue there that this can happen that

726
00:24:48,000 --> 00:24:52,080
everything can become screen recorder

727
00:24:50,080 --> 00:24:53,279
there are protocols that you can

728
00:24:52,080 --> 00:24:54,480
implement to

729
00:24:53,279 --> 00:24:56,320
implement something like a screen

730
00:24:54,480 --> 00:24:59,600
recorder or implement something like

731
00:24:56,320 --> 00:25:00,000
screen locking this exists but i don't

732
00:24:59,600 --> 00:25:01,760
know how

733
00:25:00,000 --> 00:25:04,000
standard it is because it's i think it's

734
00:25:01,760 --> 00:25:06,000
part of wl roots and

735
00:25:04,000 --> 00:25:07,679
it's not standard yeah it's all wrote

736
00:25:06,000 --> 00:25:09,840
stuff yeah

737
00:25:07,679 --> 00:25:10,720
um yeah you have direct control over

738
00:25:09,840 --> 00:25:13,120
over your stuff

739
00:25:10,720 --> 00:25:14,400
it's not like oh i have to fight for

740
00:25:13,120 --> 00:25:15,918
input resource and stuff like that i

741
00:25:14,400 --> 00:25:18,320
have control over frames

742
00:25:15,919 --> 00:25:20,080
don't no flickering um sometimes

743
00:25:18,320 --> 00:25:21,678
client-side decorations get a little bit

744
00:25:20,080 --> 00:25:24,799
in the way because this is what a lot of

745
00:25:21,679 --> 00:25:27,200
clients are doing they're have their own

746
00:25:24,799 --> 00:25:28,158
borders and you have to take care of

747
00:25:27,200 --> 00:25:31,600
that as well

748
00:25:28,159 --> 00:25:33,360
it's a little bit weird yeah but if more

749
00:25:31,600 --> 00:25:34,799
more responsibility in the compositor

750
00:25:33,360 --> 00:25:35,840
things like screen locking things like

751
00:25:34,799 --> 00:25:39,039
recording

752
00:25:35,840 --> 00:25:39,678
um yeah but generally i think it's a

753
00:25:39,039 --> 00:25:43,520
really

754
00:25:39,679 --> 00:25:46,320
really great opportunity for us as bsds

755
00:25:43,520 --> 00:25:47,360
to catch up with other operating systems

756
00:25:46,320 --> 00:25:50,080
in terms of

757
00:25:47,360 --> 00:25:52,240
how things look like and we can really

758
00:25:50,080 --> 00:25:55,199
seize that

759
00:25:52,240 --> 00:25:56,880
so yeah i was using c to implement this

760
00:25:55,200 --> 00:25:58,960
and um

761
00:25:56,880 --> 00:26:00,400
so one side of the room is basically

762
00:25:58,960 --> 00:26:03,520
going yay the other

763
00:26:00,400 --> 00:26:06,400
is going and for good reason um

764
00:26:03,520 --> 00:26:07,679
i can i can sympathize with that um

765
00:26:06,400 --> 00:26:10,799
because yeah

766
00:26:07,679 --> 00:26:12,159
why would i do that why why you know

767
00:26:10,799 --> 00:26:14,720
rust

768
00:26:12,159 --> 00:26:15,760
this is what everyone is asking me and

769
00:26:14,720 --> 00:26:18,400
there it was

770
00:26:15,760 --> 00:26:19,600
this way cooler prairie project they

771
00:26:18,400 --> 00:26:22,960
sadly

772
00:26:19,600 --> 00:26:25,120
sadly stopped working on this but they

773
00:26:22,960 --> 00:26:27,520
started with west then they rewrote

774
00:26:25,120 --> 00:26:30,719
everything in c and now yeah

775
00:26:27,520 --> 00:26:34,080
um now they stop working uh so

776
00:26:30,720 --> 00:26:38,240
yeah it's really hard to wrap

777
00:26:34,080 --> 00:26:40,559
like nia said it before um

778
00:26:38,240 --> 00:26:42,000
those are the apis wrapping this in in

779
00:26:40,559 --> 00:26:44,158
another language is why

780
00:26:42,000 --> 00:26:45,840
this is more work than i want to do i

781
00:26:44,159 --> 00:26:48,000
want to don't want to work with this

782
00:26:45,840 --> 00:26:50,240
why extra work and i don't want to

783
00:26:48,000 --> 00:26:52,159
rewrite w roots completely myself i

784
00:26:50,240 --> 00:26:56,000
don't have the capacity to do that

785
00:26:52,159 --> 00:26:57,279
so yeah i i copped out and said okay i'm

786
00:26:56,000 --> 00:26:58,799
just going to write that with c and

787
00:26:57,279 --> 00:27:01,679
obviously everyone

788
00:26:58,799 --> 00:27:03,600
no wondering okay memory leaks stuff

789
00:27:01,679 --> 00:27:06,080
like that ugly things going to happen

790
00:27:03,600 --> 00:27:06,959
yeah basically threw everything at it

791
00:27:06,080 --> 00:27:08,960
that i could

792
00:27:06,960 --> 00:27:11,679
that it could handle so i'm using flying

793
00:27:08,960 --> 00:27:14,400
and all the sanitizing stuff

794
00:27:11,679 --> 00:27:15,360
so this helps me to to deal with things

795
00:27:14,400 --> 00:27:18,320
like

796
00:27:15,360 --> 00:27:20,240
double free and use after free and this

797
00:27:18,320 --> 00:27:22,320
really helps a lot and i also have

798
00:27:20,240 --> 00:27:24,399
since i'm running on freebsd i also have

799
00:27:22,320 --> 00:27:25,760
d-trays i can track all of my memory

800
00:27:24,399 --> 00:27:27,840
allocations and can

801
00:27:25,760 --> 00:27:29,440
see when they're when i get freed this

802
00:27:27,840 --> 00:27:32,480
is very useful so

803
00:27:29,440 --> 00:27:34,880
i i kind of like think i don't have a

804
00:27:32,480 --> 00:27:39,279
memory leak at the moment

805
00:27:34,880 --> 00:27:42,960
i think c is always there to surprise me

806
00:27:39,279 --> 00:27:45,360
but yeah i'm trying to take care of this

807
00:27:42,960 --> 00:27:47,600
so yeah that's pretty much it uh if you

808
00:27:45,360 --> 00:27:48,320
want to talk to me i'm on mastodon kl

809
00:27:47,600 --> 00:27:51,120
social

810
00:27:48,320 --> 00:27:52,240
write you or matrix or you can send me

811
00:27:51,120 --> 00:27:55,279
an email

812
00:27:52,240 --> 00:27:57,279
and i have this little chat i don't know

813
00:27:55,279 --> 00:27:59,679
if you can see that it's hikari

814
00:27:57,279 --> 00:28:00,320
acnelabs.space which is also a matrix

815
00:27:59,679 --> 00:28:02,559
chat

816
00:28:00,320 --> 00:28:04,639
and you can also come to your hackspace

817
00:28:02,559 --> 00:28:07,918
and talk to me there

818
00:28:04,640 --> 00:28:11,760
but yeah huh it's in bilafell

819
00:28:07,919 --> 00:28:13,520
germany um so if you want to come there

820
00:28:11,760 --> 00:28:15,200
hack on stuff hackspaces are just

821
00:28:13,520 --> 00:28:17,520
hackspaces are just basically

822
00:28:15,200 --> 00:28:18,559
hacker communities people hacking on

823
00:28:17,520 --> 00:28:20,960
stuff and

824
00:28:18,559 --> 00:28:22,960
this one of the projects there even

825
00:28:20,960 --> 00:28:26,720
though i'm currently the only maintainer

826
00:28:22,960 --> 00:28:26,720
so yeah i'm open for questions now

827
00:28:28,840 --> 00:28:31,840
thanks

828
00:28:34,799 --> 00:28:38,399
i actually have a question uh yeah sure

829
00:28:36,880 --> 00:28:40,399
you said in the beginning that you think

830
00:28:38,399 --> 00:28:42,000
it makes no sense for a window to know

831
00:28:40,399 --> 00:28:44,639
its position on the screen

832
00:28:42,000 --> 00:28:45,200
uh as a any and user like i see for

833
00:28:44,640 --> 00:28:48,320
instance

834
00:28:45,200 --> 00:28:51,679
i think k win has this issue where for

835
00:28:48,320 --> 00:28:52,240
the wayland uh um parts they're not able

836
00:28:51,679 --> 00:28:56,399
to

837
00:28:52,240 --> 00:28:59,200
show these menu from the title

838
00:28:56,399 --> 00:29:01,199
with the title like the the main menu

839
00:28:59,200 --> 00:29:02,720
and on on x11 it works you just click

840
00:29:01,200 --> 00:29:03,360
and it shows exactly on the position you

841
00:29:02,720 --> 00:29:06,080
clicked because

842
00:29:03,360 --> 00:29:07,360
it's inside the window but on the way

843
00:29:06,080 --> 00:29:10,000
lines they are not able and

844
00:29:07,360 --> 00:29:10,559
i think they said it's not possible

845
00:29:10,000 --> 00:29:12,960
because

846
00:29:10,559 --> 00:29:13,600
the the window doesn't know not in

847
00:29:12,960 --> 00:29:16,159
position

848
00:29:13,600 --> 00:29:16,719
i don't entirely know what you mean but

849
00:29:16,159 --> 00:29:20,080
i can't

850
00:29:16,720 --> 00:29:22,480
control it yes we have one minute left

851
00:29:20,080 --> 00:29:23,600
yeah so this will be the last question

852
00:29:22,480 --> 00:29:26,000
okay

853
00:29:23,600 --> 00:29:26,719
and uh just don't forget to repeat the

854
00:29:26,000 --> 00:29:28,880
question yeah

855
00:29:26,720 --> 00:29:29,760
i could so i'm not entirely sure what

856
00:29:28,880 --> 00:29:31,520
you're asking but

857
00:29:29,760 --> 00:29:32,960
maybe you should talk this offline

858
00:29:31,520 --> 00:29:35,440
because maybe you can show me

859
00:29:32,960 --> 00:29:36,960
uh maybe you can take one more question

860
00:29:35,440 --> 00:29:41,840
but uh

861
00:29:36,960 --> 00:29:41,840
yeah one more yes

862
00:29:53,520 --> 00:29:56,960
because then would have even more stuff

863
00:29:55,440 --> 00:29:59,840
to care about but i

864
00:29:56,960 --> 00:30:01,360
was um re-parenting is not it's i think

865
00:29:59,840 --> 00:30:04,080
it's not really helping me if i have

866
00:30:01,360 --> 00:30:04,559
obscured the window by something else

867
00:30:04,080 --> 00:30:06,158
because

868
00:30:04,559 --> 00:30:07,600
that yeah would just put that into

869
00:30:06,159 --> 00:30:09,360
another window and then

870
00:30:07,600 --> 00:30:12,000
all this re-parenting stuff would get

871
00:30:09,360 --> 00:30:14,479
replaced maybe you can do that repairing

872
00:30:12,000 --> 00:30:15,840
i have no idea how to do that but all

873
00:30:14,480 --> 00:30:19,039
the other

874
00:30:15,840 --> 00:30:21,918
things yeah okay

875
00:30:19,039 --> 00:30:22,960
exactly i just like do weird stuff but

876
00:30:21,919 --> 00:30:25,520
um

877
00:30:22,960 --> 00:30:26,640
what what i would i to to for these

878
00:30:25,520 --> 00:30:28,879
borders um

879
00:30:26,640 --> 00:30:30,000
i basically did what open look openbox

880
00:30:28,880 --> 00:30:34,159
did and

881
00:30:30,000 --> 00:30:38,399
looked reasonable to me and um but yeah

882
00:30:34,159 --> 00:30:38,399
this so yeah thanks thank you

883
00:30:41,600 --> 00:30:44,000
bam

884
00:30:44,720 --> 00:30:57,760
um oh no thank you

885
00:30:48,960 --> 00:30:57,760
no no no okay

