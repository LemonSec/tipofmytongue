1
00:00:04,870 --> 00:00:10,219
hi<font color="#CCCCCC"> women</font><font color="#E5E5E5"> thank you for coming my name is</font>

2
00:00:08,000 --> 00:00:13,179
<font color="#CCCCCC">ash La Mina</font><font color="#E5E5E5"> and this is my skill in the</font>

3
00:00:10,219 --> 00:00:16,970
cap theorem<font color="#CCCCCC"> we're going to see whether</font>

4
00:00:13,179 --> 00:00:20,090
<font color="#E5E5E5">cap theorem is relevant or irrelevant</font><font color="#CCCCCC"> to</font>

5
00:00:16,970 --> 00:00:22,210
<font color="#E5E5E5">production my scale systems I'm with a</font>

6
00:00:20,090 --> 00:00:24,920
gear<font color="#E5E5E5"> of databases</font><font color="#CCCCCC"> the structure team</font>

7
00:00:22,210 --> 00:00:27,560
<font color="#CCCCCC">assuming you I</font><font color="#E5E5E5"> know a little</font><font color="#CCCCCC"> bit about</font>

8
00:00:24,920 --> 00:00:33,680
<font color="#CCCCCC">github</font><font color="#E5E5E5"> we do run MySQL in our</font><font color="#CCCCCC"> backend</font>

9
00:00:27,560 --> 00:00:36,589
and clearly we're concerned with

10
00:00:33,680 --> 00:00:38,360
consistency<font color="#E5E5E5"> and availability</font><font color="#CCCCCC"> we want our</font>

11
00:00:36,589 --> 00:00:41,210
services<font color="#CCCCCC"> to be available right we want</font>

12
00:00:38,360 --> 00:00:46,729
you to be able<font color="#E5E5E5"> to open</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> pull request</font>

13
00:00:41,210 --> 00:00:49,449
page or an issue<font color="#CCCCCC"> raise</font><font color="#E5E5E5"> your hand if</font>

14
00:00:46,729 --> 00:00:50,600
you've ever<font color="#E5E5E5"> heard of the cap theorem</font>

15
00:00:49,449 --> 00:00:54,140
<font color="#E5E5E5">okay</font>

16
00:00:50,600 --> 00:00:57,080
so almost everyone<font color="#CCCCCC"> so the incentive to</font>

17
00:00:54,140 --> 00:00:59,150
<font color="#CCCCCC">this session is a couple</font><font color="#E5E5E5"> events one was</font>

18
00:00:57,080 --> 00:01:01,309
<font color="#CCCCCC">the blog posts that</font><font color="#E5E5E5"> are published</font><font color="#CCCCCC"> at</font>

19
00:00:59,150 --> 00:01:04,250
getup<font color="#CCCCCC"> and the other one was an</font><font color="#E5E5E5"> outage we</font>

20
00:01:01,309 --> 00:01:06,048
had and this sparkled community

21
00:01:04,250 --> 00:01:09,820
discussion and<font color="#E5E5E5"> people were saying things</font>

22
00:01:06,049 --> 00:01:09,820
<font color="#E5E5E5">like well why didn't</font>

23
00:01:10,420 --> 00:01:15,890
why did you design a an available system

24
00:01:14,600 --> 00:01:19,100
you should<font color="#CCCCCC"> have designed a consistent</font>

25
00:01:15,890 --> 00:01:21,230
system or you know<font color="#E5E5E5"> caps theorem says you</font>

26
00:01:19,100 --> 00:01:26,149
can't have<font color="#E5E5E5"> consistency if you prefer</font>

27
00:01:21,230 --> 00:01:28,250
availability or<font color="#CCCCCC"> vice-versa</font><font color="#E5E5E5"> and basically</font>

28
00:01:26,150 --> 00:01:30,800
waving the cap theorem and saying you

29
00:01:28,250 --> 00:01:33,920
know one thing can<font color="#E5E5E5"> be can</font><font color="#CCCCCC"> be done and</font>

30
00:01:30,800 --> 00:01:36,200
<font color="#E5E5E5">the</font><font color="#CCCCCC"> other can't be</font><font color="#E5E5E5"> done it's like an e</font>

31
00:01:33,920 --> 00:01:37,670
equals mc-squared kind of limitation and

32
00:01:36,200 --> 00:01:39,860
<font color="#CCCCCC">i found</font><font color="#E5E5E5"> many of these comments to be</font>

33
00:01:37,670 --> 00:01:41,750
<font color="#E5E5E5">inaccurate if not incorrect so in this</font>

34
00:01:39,860 --> 00:01:44,120
<font color="#E5E5E5">session I would like</font><font color="#CCCCCC"> to explain what cap</font>

35
00:01:41,750 --> 00:01:49,970
theorem<font color="#CCCCCC"> actually means and how it</font>

36
00:01:44,120 --> 00:01:55,490
applies to production systems<font color="#E5E5E5"> so 20</font>

37
00:01:49,970 --> 00:01:59,090
<font color="#CCCCCC">years ago</font><font color="#E5E5E5"> Eric Brewer conjectured</font><font color="#CCCCCC"> an</font>

38
00:01:55,490 --> 00:02:01,789
idea that's the<font color="#CCCCCC"> cap conjecture and he</font>

39
00:01:59,090 --> 00:02:04,490
said<font color="#E5E5E5"> a system can</font><font color="#CCCCCC"> be available</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> be</font>

40
00:02:01,790 --> 00:02:06,799
consistent<font color="#E5E5E5"> can be partitioned tolerant</font>

41
00:02:04,490 --> 00:02:09,408
<font color="#E5E5E5">it can't be all three you have</font><font color="#CCCCCC"> to put</font>

42
00:02:06,799 --> 00:02:14,500
pick two out of the three<font color="#E5E5E5"> that was the</font>

43
00:02:09,408 --> 00:02:16,220
conjecture<font color="#CCCCCC"> a few years later Lynch and</font>

44
00:02:14,500 --> 00:02:18,440
Gilbert

45
00:02:16,220 --> 00:02:21,470
what we call<font color="#E5E5E5"> the cap theorem</font><font color="#CCCCCC"> there</font>

46
00:02:18,440 --> 00:02:24,440
people<font color="#E5E5E5"> was called</font><font color="#CCCCCC"> after the</font><font color="#E5E5E5"> cap</font>

47
00:02:21,470 --> 00:02:27,830
conjecture by Eric Brewer<font color="#E5E5E5"> the name</font><font color="#CCCCCC"> Eric</font>

48
00:02:24,440 --> 00:02:30,050
were<font color="#CCCCCC"> Brewer appears on the title</font><font color="#E5E5E5"> but</font>

49
00:02:27,830 --> 00:02:32,450
misunderstood by many<font color="#E5E5E5"> they did not prove</font>

50
00:02:30,050 --> 00:02:33,650
Brewers conjecture<font color="#E5E5E5"> they proved a</font>

51
00:02:32,450 --> 00:02:38,030
different conjecture

52
00:02:33,650 --> 00:02:41,210
you see they changed the terms and they

53
00:02:38,030 --> 00:02:43,220
made a mathematical proof<font color="#E5E5E5"> now I'm I've</font>

54
00:02:41,210 --> 00:02:46,520
studied mathematics<font color="#CCCCCC"> I'm a great fan of</font>

55
00:02:43,220 --> 00:02:48,500
math<font color="#E5E5E5"> and in math a theorem only holds</font>

56
00:02:46,520 --> 00:02:49,130
true as long<font color="#CCCCCC"> as</font><font color="#E5E5E5"> its terms and conditions</font>

57
00:02:48,500 --> 00:02:51,320
are met

58
00:02:49,130 --> 00:02:53,060
you cannot just change<font color="#E5E5E5"> conditions and</font>

59
00:02:51,320 --> 00:02:55,850
say yeah the<font color="#CCCCCC"> current still holds</font><font color="#E5E5E5"> it</font>

60
00:02:53,060 --> 00:02:57,650
doesn't work like<font color="#CCCCCC"> that so they use</font>

61
00:02:55,850 --> 00:03:00,320
different<font color="#E5E5E5"> terms and because everybody</font>

62
00:02:57,650 --> 00:03:02,150
today quotes the cap theorem<font color="#CCCCCC"> we'll go by</font>

63
00:03:00,320 --> 00:03:06,410
their<font color="#E5E5E5"> terms and explain what their terms</font>

64
00:03:02,150 --> 00:03:09,460
mean<font color="#E5E5E5"> and how do they apply to our</font>

65
00:03:06,410 --> 00:03:11,840
systems so<font color="#E5E5E5"> the terms are still</font>

66
00:03:09,460 --> 00:03:12,350
consistency availability and<font color="#CCCCCC"> petition</font>

67
00:03:11,840 --> 00:03:14,810
<font color="#CCCCCC">tolerance</font>

68
00:03:12,350 --> 00:03:17,030
though the word availability lost<font color="#CCCCCC"> the</font>

69
00:03:14,810 --> 00:03:18,830
high part and it goes like<font color="#CCCCCC"> this</font>

70
00:03:17,030 --> 00:03:21,620
I'm going to read exactly<font color="#CCCCCC"> their</font>

71
00:03:18,830 --> 00:03:24,709
definition so consistency once the right

72
00:03:21,620 --> 00:03:27,140
is successful on<font color="#E5E5E5"> a note</font><font color="#CCCCCC"> anyway than any</font>

73
00:03:24,709 --> 00:03:29,900
<font color="#E5E5E5">other node must reflect that right or</font>

74
00:03:27,140 --> 00:03:33,829
any later<font color="#E5E5E5"> right so say there's a table</font>

75
00:03:29,900 --> 00:03:36,230
<font color="#E5E5E5">there's a value the value is</font><font color="#CCCCCC"> 1 and I run</font>

76
00:03:33,830 --> 00:03:40,070
a series of<font color="#E5E5E5"> updates I update</font><font color="#CCCCCC"> 2</font><font color="#E5E5E5"> 2 3</font><font color="#CCCCCC"> 4 5</font><font color="#E5E5E5"> 6</font>

77
00:03:36,230 --> 00:03:41,959
<font color="#CCCCCC">7 8 9</font><font color="#E5E5E5"> 10 I just updated to the number 7</font>

78
00:03:40,070 --> 00:03:44,780
I got an OK from the<font color="#E5E5E5"> committee</font>

79
00:03:41,959 --> 00:03:46,610
acknowledged<font color="#CCCCCC"> I go to any number</font><font color="#E5E5E5"> on any</font>

80
00:03:44,780 --> 00:03:49,820
other node I should see the number 7<font color="#E5E5E5"> or</font>

81
00:03:46,610 --> 00:03:51,620
8 or 9<font color="#E5E5E5"> maybe new we're right we're</font>

82
00:03:49,820 --> 00:03:55,660
taking<font color="#E5E5E5"> place but absolutely it shouldn't</font>

83
00:03:51,620 --> 00:03:58,040
be same 5<font color="#CCCCCC"> or 6 or 4 right</font><font color="#E5E5E5"> make sense</font><font color="#CCCCCC"> ok</font>

84
00:03:55,660 --> 00:03:58,840
availability that's the big change<font color="#E5E5E5"> from</font>

85
00:03:58,040 --> 00:04:04,010
Gruber's

86
00:03:58,840 --> 00:04:06,200
definition<font color="#CCCCCC"> pay attention every non</font><font color="#E5E5E5"> crush</font>

87
00:04:04,010 --> 00:04:09,470
node must respond to requests in a

88
00:04:06,200 --> 00:04:11,720
<font color="#E5E5E5">finite amount of</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> is the</font>

89
00:04:09,470 --> 00:04:13,250
<font color="#CCCCCC">definition</font><font color="#E5E5E5"> of this theorem any non</font><font color="#CCCCCC"> crush</font>

90
00:04:11,720 --> 00:04:16,730
node must respond to<font color="#E5E5E5"> requests in a</font>

91
00:04:13,250 --> 00:04:20,120
finite<font color="#CCCCCC"> amount of time</font><font color="#E5E5E5"> now a few notes</font>

92
00:04:16,730 --> 00:04:22,580
<font color="#E5E5E5">about this there is no limit on this</font>

93
00:04:20,120 --> 00:04:24,919
<font color="#E5E5E5">finite amount of</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> it could</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> 5</font>

94
00:04:22,580 --> 00:04:27,469
seconds<font color="#E5E5E5"> it could be 5 minutes</font>

95
00:04:24,919 --> 00:04:29,510
it could be<font color="#CCCCCC"> 7 years if the request</font>

96
00:04:27,470 --> 00:04:33,860
<font color="#CCCCCC">returns within</font><font color="#E5E5E5"> 7</font><font color="#CCCCCC"> years</font>

97
00:04:29,510 --> 00:04:36,110
the system is<font color="#CCCCCC"> available now</font><font color="#E5E5E5"> it is not</font>

98
00:04:33,860 --> 00:04:38,150
explicitly<font color="#E5E5E5"> declared but otherwise this</font>

99
00:04:36,110 --> 00:04:40,790
disproves the cap theorem<font color="#E5E5E5"> that the</font>

100
00:04:38,150 --> 00:04:42,950
response must<font color="#E5E5E5"> be successful this if the</font>

101
00:04:40,790 --> 00:04:45,410
system<font color="#CCCCCC"> returns</font><font color="#E5E5E5"> errors all the time then</font>

102
00:04:42,950 --> 00:04:49,370
it's<font color="#E5E5E5"> not available it must respect that</font>

103
00:04:45,410 --> 00:04:50,660
<font color="#E5E5E5">request which we sent in another last</font>

104
00:04:49,370 --> 00:04:54,290
thing to<font color="#CCCCCC"> note because</font><font color="#E5E5E5"> this is a</font>

105
00:04:50,660 --> 00:04:56,600
<font color="#E5E5E5">mathematical definition every</font><font color="#CCCCCC"> non crush</font>

106
00:04:54,290 --> 00:04:59,030
<font color="#E5E5E5">node must respond to requests infinite</font>

107
00:04:56,600 --> 00:05:03,290
amount<font color="#E5E5E5"> of time what we have in math is</font>

108
00:04:59,030 --> 00:05:06,469
<font color="#CCCCCC">like</font><font color="#E5E5E5"> true in an empty way or in its ruin</font>

109
00:05:03,290 --> 00:05:08,990
an empty statement<font color="#E5E5E5"> according to this</font>

110
00:05:06,470 --> 00:05:12,950
<font color="#CCCCCC">definition</font><font color="#E5E5E5"> a system a database system</font>

111
00:05:08,990 --> 00:05:16,250
where all the nodes are crushed<font color="#E5E5E5"> is</font>

112
00:05:12,950 --> 00:05:18,740
available okay<font color="#E5E5E5"> because</font><font color="#CCCCCC"> only the no</font><font color="#E5E5E5"> crush</font>

113
00:05:16,250 --> 00:05:20,960
nodes<font color="#E5E5E5"> must respond to</font><font color="#CCCCCC"> request</font><font color="#E5E5E5"> anything</font>

114
00:05:18,740 --> 00:05:24,020
<font color="#E5E5E5">it amount of time it is perfectly</font><font color="#CCCCCC"> valid</font>

115
00:05:20,960 --> 00:05:25,969
<font color="#E5E5E5">to declare such</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> crush system is</font>

116
00:05:24,020 --> 00:05:28,609
<font color="#E5E5E5">available according</font><font color="#CCCCCC"> to these</font><font color="#E5E5E5"> rules</font>

117
00:05:25,970 --> 00:05:30,500
now if I<font color="#E5E5E5"> told you that</font><font color="#CCCCCC"> weird getup</font><font color="#E5E5E5"> are</font>

118
00:05:28,610 --> 00:05:32,570
interested in<font color="#E5E5E5"> availability and so we're</font>

119
00:05:30,500 --> 00:05:35,810
<font color="#CCCCCC">crushing all our database service to</font>

120
00:05:32,570 --> 00:05:38,680
make<font color="#E5E5E5"> it available</font><font color="#CCCCCC"> you would say that</font>

121
00:05:35,810 --> 00:05:42,920
this doesn't<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> make sense agreed</font>

122
00:05:38,680 --> 00:05:44,900
<font color="#CCCCCC">okay we continue petition tolerance</font>

123
00:05:42,920 --> 00:05:47,930
means basically what it is<font color="#E5E5E5"> that the</font>

124
00:05:44,900 --> 00:05:50,690
<font color="#E5E5E5">system can operate with</font><font color="#CCCCCC"> Network failures</font>

125
00:05:47,930 --> 00:05:52,730
and I will rephrase the entire<font color="#CCCCCC"> cup here</font>

126
00:05:50,690 --> 00:05:55,100
and<font color="#CCCCCC"> instead of you know</font><font color="#E5E5E5"> doing</font><font color="#CCCCCC"> the two</font>

127
00:05:52,730 --> 00:05:58,250
out of<font color="#E5E5E5"> three I'll define it in this</font><font color="#CCCCCC"> way</font>

128
00:05:55,100 --> 00:05:59,690
<font color="#E5E5E5">so if the network is good you can</font>

129
00:05:58,250 --> 00:06:01,850
<font color="#CCCCCC">achieve both consistency and</font>

130
00:05:59,690 --> 00:06:04,430
availability no problem<font color="#CCCCCC"> if the network</font>

131
00:06:01,850 --> 00:06:06,800
is bad<font color="#E5E5E5"> then you might need to choose</font>

132
00:06:04,430 --> 00:06:10,220
between<font color="#E5E5E5"> availability</font><font color="#CCCCCC"> and consistency</font>

133
00:06:06,800 --> 00:06:13,400
<font color="#E5E5E5">that's that's what the theorem</font><font color="#CCCCCC"> says</font><font color="#E5E5E5"> all</font>

134
00:06:10,220 --> 00:06:15,080
<font color="#E5E5E5">right so we're going to prove the cap</font>

135
00:06:13,400 --> 00:06:17,359
theorem<font color="#E5E5E5"> right here</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> now this is</font>

136
00:06:15,080 --> 00:06:19,430
literally the proof on the paper<font color="#E5E5E5"> it's</font>

137
00:06:17,360 --> 00:06:22,610
absolutely not complicated<font color="#E5E5E5"> as you will</font>

138
00:06:19,430 --> 00:06:25,760
shortly agree<font color="#E5E5E5"> with me so the proof uses</font>

139
00:06:22,610 --> 00:06:27,290
two nodes<font color="#CCCCCC"> node N 1 n 2 they're connected</font>

140
00:06:25,760 --> 00:06:30,500
the replicating from each other they're

141
00:06:27,290 --> 00:06:32,510
happy everything<font color="#E5E5E5"> is fine we place a</font>

142
00:06:30,500 --> 00:06:35,560
network partition between<font color="#E5E5E5"> them we put a</font>

143
00:06:32,510 --> 00:06:39,980
barrier this barrier<font color="#E5E5E5"> is held for an</font>

144
00:06:35,560 --> 00:06:41,540
infinite amount<font color="#E5E5E5"> of time</font><font color="#CCCCCC"> ok it will never</font>

145
00:06:39,980 --> 00:06:42,240
come<font color="#CCCCCC"> back</font><font color="#E5E5E5"> it's an infinite amount of</font>

146
00:06:41,540 --> 00:06:45,840
<font color="#E5E5E5">time</font>

147
00:06:42,240 --> 00:06:48,430
we assume that<font color="#E5E5E5"> the system</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> available</font>

148
00:06:45,840 --> 00:06:50,529
<font color="#E5E5E5">agreed let's just assume that it is</font>

149
00:06:48,430 --> 00:06:52,749
<font color="#E5E5E5">available according to the definition of</font>

150
00:06:50,529 --> 00:06:57,129
a<font color="#E5E5E5"> blueberry which we have just described</font>

151
00:06:52,749 --> 00:06:59,289
<font color="#E5E5E5">so we</font><font color="#CCCCCC"> write let's say there</font><font color="#E5E5E5"> is some road</font>

152
00:06:57,129 --> 00:07:00,819
there's some data the value is<font color="#CCCCCC"> three</font>

153
00:06:59,289 --> 00:07:03,550
here and<font color="#CCCCCC"> three here</font><font color="#E5E5E5"> and the system is</font>

154
00:07:00,819 --> 00:07:06,819
consistent<font color="#CCCCCC"> we now write the value seven</font>

155
00:07:03,550 --> 00:07:09,400
on node number one<font color="#E5E5E5"> because we said</font><font color="#CCCCCC"> the</font>

156
00:07:06,819 --> 00:07:12,069
system<font color="#E5E5E5"> is available that means that</font>

157
00:07:09,400 --> 00:07:15,669
<font color="#E5E5E5">request will return in a finite amount</font>

158
00:07:12,069 --> 00:07:17,770
<font color="#E5E5E5">of time</font><font color="#CCCCCC"> whatever time it is but since</font>

159
00:07:15,669 --> 00:07:21,159
<font color="#CCCCCC">it's Finn it</font><font color="#E5E5E5"> it's valid to speak about</font>

160
00:07:17,770 --> 00:07:23,710
what happens afterwards<font color="#CCCCCC"> and what happens</font>

161
00:07:21,159 --> 00:07:26,590
afterwards<font color="#E5E5E5"> is that we're going</font><font color="#CCCCCC"> to read a</font>

162
00:07:23,710 --> 00:07:27,878
value<font color="#E5E5E5"> from node number two and that</font><font color="#CCCCCC"> - if</font>

163
00:07:26,590 --> 00:07:29,919
we<font color="#CCCCCC"> assume that</font><font color="#E5E5E5"> the system is available</font>

164
00:07:27,879 --> 00:07:31,210
<font color="#E5E5E5">is</font><font color="#CCCCCC"> going to complete within a finite</font>

165
00:07:29,919 --> 00:07:33,188
<font color="#E5E5E5">amount of time</font>

166
00:07:31,210 --> 00:07:36,339
it is therefore valid to speak<font color="#CCCCCC"> about</font>

167
00:07:33,189 --> 00:07:38,560
what happens next<font color="#CCCCCC"> what happens next</font><font color="#E5E5E5"> is</font>

168
00:07:36,339 --> 00:07:41,289
that<font color="#E5E5E5"> a finite</font><font color="#CCCCCC"> amount of time</font><font color="#E5E5E5"> is passed</font>

169
00:07:38,560 --> 00:07:44,439
<font color="#CCCCCC">we place the value</font><font color="#E5E5E5"> seven on node number</font>

170
00:07:41,289 --> 00:07:46,509
one there is<font color="#CCCCCC"> no way it reached node</font>

171
00:07:44,439 --> 00:07:49,779
number two because there is throughout

172
00:07:46,509 --> 00:07:52,990
this time the network<font color="#E5E5E5"> was broken QED</font>

173
00:07:49,779 --> 00:07:55,839
we assumed<font color="#E5E5E5"> availability therefore there</font>

174
00:07:52,990 --> 00:07:58,240
cannot be consistency<font color="#E5E5E5"> does that make</font>

175
00:07:55,839 --> 00:08:00,430
sense<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> the proof it's a</font>

176
00:07:58,240 --> 00:08:02,259
mathematical proof<font color="#E5E5E5"> that's it</font><font color="#CCCCCC"> that's</font>

177
00:08:00,430 --> 00:08:05,139
<font color="#CCCCCC">basically it you</font><font color="#E5E5E5"> know the capital</font><font color="#CCCCCC"> right</font>

178
00:08:02,259 --> 00:08:07,210
<font color="#E5E5E5">now</font><font color="#CCCCCC"> and as a mathematical</font><font color="#E5E5E5"> proof it</font><font color="#CCCCCC"> is</font>

179
00:08:05,139 --> 00:08:09,129
excellent<font color="#E5E5E5"> that's the way we prove things</font>

180
00:08:07,210 --> 00:08:11,620
in<font color="#E5E5E5"> mathematics right you you want to</font>

181
00:08:09,129 --> 00:08:13,750
<font color="#E5E5E5">prove</font><font color="#CCCCCC"> that something</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> not possible you</font>

182
00:08:11,620 --> 00:08:16,779
<font color="#E5E5E5">show one counter example where it breaks</font>

183
00:08:13,750 --> 00:08:18,310
<font color="#CCCCCC">right</font><font color="#E5E5E5"> otherwise it might be completely</font>

184
00:08:16,779 --> 00:08:21,219
possible<font color="#E5E5E5"> but if there's one use case</font>

185
00:08:18,310 --> 00:08:22,839
<font color="#E5E5E5">where it breaks then it is not possible</font>

186
00:08:21,219 --> 00:08:25,360
it is not<font color="#CCCCCC"> possible to achieve</font>

187
00:08:22,839 --> 00:08:28,149
availability and consistency<font color="#CCCCCC"> both</font>

188
00:08:25,360 --> 00:08:32,130
<font color="#E5E5E5">together because there is that</font><font color="#CCCCCC"> single</font>

189
00:08:28,149 --> 00:08:34,929
use case which breaks it but we as

190
00:08:32,130 --> 00:08:35,559
<font color="#E5E5E5">engineers understand that things are not</font>

191
00:08:34,929 --> 00:08:37,838
<font color="#E5E5E5">black and white</font>

192
00:08:35,559 --> 00:08:39,698
for example let's talk<font color="#CCCCCC"> about real high</font>

193
00:08:37,839 --> 00:08:42,279
availability the way we understand them

194
00:08:39,698 --> 00:08:44,349
and<font color="#E5E5E5"> studied as engineers</font><font color="#CCCCCC"> we already</font>

195
00:08:42,279 --> 00:08:45,939
agree that<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> no</font><font color="#CCCCCC"> such thing as a</font>

196
00:08:44,350 --> 00:08:47,740
<font color="#E5E5E5">hundred percent availability and we</font><font color="#CCCCCC"> talk</font>

197
00:08:45,940 --> 00:08:49,750
about<font color="#E5E5E5"> five nines and four 9s and</font>

198
00:08:47,740 --> 00:08:52,600
whatever makes us happy<font color="#CCCCCC"> in</font><font color="#E5E5E5"> production</font>

199
00:08:49,750 --> 00:08:53,490
<font color="#CCCCCC">right</font><font color="#E5E5E5"> we acknowledge that there could be</font>

200
00:08:52,600 --> 00:08:57,630
<font color="#CCCCCC">thing</font>

201
00:08:53,490 --> 00:08:59,670
use cases that<font color="#E5E5E5"> we might not meet if I'm</font>

202
00:08:57,630 --> 00:09:01,470
to<font color="#E5E5E5"> tell you that in the</font><font color="#CCCCCC"> next five years</font>

203
00:08:59,670 --> 00:09:05,219
there will be at<font color="#CCCCCC"> least three</font><font color="#E5E5E5"> seconds of</font>

204
00:09:01,470 --> 00:09:07,890
outage in your services okay you you

205
00:09:05,220 --> 00:09:10,649
<font color="#CCCCCC">will</font><font color="#E5E5E5"> believe me but you won't be shocked</font>

206
00:09:07,890 --> 00:09:13,430
<font color="#E5E5E5">right we understand that and</font><font color="#CCCCCC"> we</font>

207
00:09:10,649 --> 00:09:18,450
understand that<font color="#E5E5E5"> we</font><font color="#CCCCCC"> can make trade-offs</font>

208
00:09:13,430 --> 00:09:20,579
<font color="#E5E5E5">sometimes last about cap itself it does</font>

209
00:09:18,450 --> 00:09:23,070
not excuse a myriad of other topics

210
00:09:20,580 --> 00:09:26,270
<font color="#E5E5E5">which we</font><font color="#CCCCCC"> engineer in as engineers are</font>

211
00:09:23,070 --> 00:09:30,510
very<font color="#CCCCCC"> interested in such a scalability</font>

212
00:09:26,270 --> 00:09:33,240
<font color="#E5E5E5">uptime latencies durability etcetera</font>

213
00:09:30,510 --> 00:09:36,020
<font color="#E5E5E5">with that said let's move on and see</font><font color="#CCCCCC"> how</font>

214
00:09:33,240 --> 00:09:39,060
cap as we<font color="#CCCCCC"> define it</font><font color="#E5E5E5"> applies to</font>

215
00:09:36,020 --> 00:09:40,800
production<font color="#E5E5E5"> my</font><font color="#CCCCCC"> skill systems so we begin</font>

216
00:09:39,060 --> 00:09:44,550
with<font color="#CCCCCC"> the simple MySQL replication</font>

217
00:09:40,800 --> 00:09:46,260
cluster<font color="#E5E5E5"> sorry that's</font><font color="#CCCCCC"> the asynchronous</font>

218
00:09:44,550 --> 00:09:49,020
<font color="#E5E5E5">replication single master multiple</font>

219
00:09:46,260 --> 00:09:52,319
replicas<font color="#E5E5E5"> is this an AP or a</font><font color="#CCCCCC"> CP system</font>

220
00:09:49,020 --> 00:09:57,770
what do you think don't<font color="#E5E5E5"> be shy</font>

221
00:09:52,320 --> 00:09:57,770
<font color="#E5E5E5">ap or CP there's no time faster faster</font>

222
00:09:58,790 --> 00:10:04,770
<font color="#E5E5E5">CP okay so yeah clearly we</font><font color="#CCCCCC"> all agree</font>

223
00:10:02,640 --> 00:10:07,439
that<font color="#E5E5E5"> this cannot be a CP system right</font>

224
00:10:04,770 --> 00:10:08,760
<font color="#E5E5E5">this is a synchronous replication we</font>

225
00:10:07,440 --> 00:10:10,800
write on the master that<font color="#E5E5E5"> could be</font>

226
00:10:08,760 --> 00:10:12,870
replication lag nothing guarantees that

227
00:10:10,800 --> 00:10:15,479
the data will be<font color="#E5E5E5"> there we only know that</font>

228
00:10:12,870 --> 00:10:18,000
<font color="#CCCCCC">on a</font><font color="#E5E5E5"> daily basis</font><font color="#CCCCCC"> so clearly this cannot</font>

229
00:10:15,480 --> 00:10:20,520
be a<font color="#E5E5E5"> consistent system</font><font color="#CCCCCC"> I write here I</font>

230
00:10:18,000 --> 00:10:22,589
read here well it's not the<font color="#E5E5E5"> same value</font>

231
00:10:20,520 --> 00:10:26,100
<font color="#CCCCCC">surprise</font><font color="#E5E5E5"> so we know it's not the CP</font>

232
00:10:22,589 --> 00:10:28,740
system is it<font color="#E5E5E5"> an AP</font><font color="#CCCCCC"> system so my question</font>

233
00:10:26,100 --> 00:10:30,810
whether this was<font color="#CCCCCC"> ap or CP is really not</font>

234
00:10:28,740 --> 00:10:33,690
<font color="#E5E5E5">a good question</font><font color="#CCCCCC"> because it is neither</font>

235
00:10:30,810 --> 00:10:35,310
<font color="#E5E5E5">the</font><font color="#CCCCCC"> fact that</font><font color="#E5E5E5"> the system</font><font color="#CCCCCC"> is not AP</font>

236
00:10:33,690 --> 00:10:36,750
<font color="#E5E5E5">doesn't make it CP the fact that this</font>

237
00:10:35,310 --> 00:10:39,529
<font color="#E5E5E5">system is not see if it doesn't make it</font>

238
00:10:36,750 --> 00:10:42,240
<font color="#CCCCCC">ap</font><font color="#E5E5E5"> why is it not an AP</font><font color="#CCCCCC"> system</font>

239
00:10:39,529 --> 00:10:45,149
well<font color="#E5E5E5"> this cluster doesn't really meet</font>

240
00:10:42,240 --> 00:10:46,890
the definition<font color="#E5E5E5"> or the</font><font color="#CCCCCC"> State of Mind</font><font color="#E5E5E5"> of</font>

241
00:10:45,149 --> 00:10:49,350
<font color="#E5E5E5">the cap theorem</font><font color="#CCCCCC"> according to the cap</font>

242
00:10:46,890 --> 00:10:51,800
theorem<font color="#CCCCCC"> any node must accept a request</font>

243
00:10:49,350 --> 00:10:54,329
<font color="#E5E5E5">in</font><font color="#CCCCCC"> order</font><font color="#E5E5E5"> to be available</font><font color="#CCCCCC"> right in</font>

244
00:10:51,800 --> 00:10:56,010
<font color="#CCCCCC">respond to</font><font color="#E5E5E5"> any of our requests in a</font>

245
00:10:54,329 --> 00:10:58,319
finite<font color="#E5E5E5"> amount of time and without error</font>

246
00:10:56,010 --> 00:11:00,329
<font color="#CCCCCC">in</font><font color="#E5E5E5"> this system there</font><font color="#CCCCCC"> is only a single</font>

247
00:10:58,320 --> 00:11:02,970
node that can respond<font color="#CCCCCC"> to</font><font color="#E5E5E5"> write requests</font>

248
00:11:00,329 --> 00:11:05,500
right all the other nodes<font color="#E5E5E5"> do not even</font>

249
00:11:02,970 --> 00:11:07,480
play that game<font color="#CCCCCC"> there is a unidirectional</font>

250
00:11:05,500 --> 00:11:09,310
thing here but the current the<font color="#E5E5E5"> capturing</font>

251
00:11:07,480 --> 00:11:12,160
doesn't make these<font color="#E5E5E5"> distinctions it needs</font>

252
00:11:09,310 --> 00:11:15,069
<font color="#E5E5E5">all nodes to</font><font color="#CCCCCC"> be able to</font><font color="#E5E5E5"> participate</font><font color="#CCCCCC"> and</font>

253
00:11:12,160 --> 00:11:17,020
if there is no node goes down no one is

254
00:11:15,070 --> 00:11:18,850
able<font color="#E5E5E5"> to serve</font><font color="#CCCCCC"> rights</font><font color="#E5E5E5"> cap is not</font>

255
00:11:17,020 --> 00:11:21,069
interested in fail overs and what will

256
00:11:18,850 --> 00:11:21,550
happen<font color="#E5E5E5"> in</font><font color="#CCCCCC"> five seconds</font><font color="#E5E5E5"> after I failed</font>

257
00:11:21,070 --> 00:11:23,200
<font color="#E5E5E5">over</font>

258
00:11:21,550 --> 00:11:28,420
according to<font color="#CCCCCC"> cap</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is not an</font>

259
00:11:23,200 --> 00:11:31,420
available<font color="#E5E5E5"> system it is</font><font color="#CCCCCC"> not consistent</font><font color="#E5E5E5"> it</font>

260
00:11:28,420 --> 00:11:33,819
is not available<font color="#CCCCCC"> but we know how</font><font color="#E5E5E5"> to get</font>

261
00:11:31,420 --> 00:11:37,900
consistency<font color="#E5E5E5"> right we can always read</font>

262
00:11:33,820 --> 00:11:39,460
from the master<font color="#E5E5E5"> that's our way you write</font>

263
00:11:37,900 --> 00:11:41,770
to the master you you want consistency

264
00:11:39,460 --> 00:11:44,080
<font color="#CCCCCC">you read back from the master we know</font>

265
00:11:41,770 --> 00:11:47,800
<font color="#E5E5E5">that it</font><font color="#CCCCCC"> doesn't scale</font><font color="#E5E5E5"> but do we really</font>

266
00:11:44,080 --> 00:11:50,140
<font color="#E5E5E5">care that not all replicas have data at</font>

267
00:11:47,800 --> 00:11:52,329
that<font color="#CCCCCC"> exact time we have something we</font>

268
00:11:50,140 --> 00:11:56,380
<font color="#CCCCCC">have some solution</font><font color="#E5E5E5"> so it doesn't scale</font>

269
00:11:52,330 --> 00:11:59,890
so we<font color="#E5E5E5"> can use proxy SQL with casual</font><font color="#CCCCCC"> Gd</font>

270
00:11:56,380 --> 00:12:03,189
ad<font color="#E5E5E5"> reads right</font><font color="#CCCCCC"> this would</font><font color="#E5E5E5"> work for</font><font color="#CCCCCC"> pair</font>

271
00:11:59,890 --> 00:12:05,110
connection queries and not for all

272
00:12:03,190 --> 00:12:07,270
<font color="#E5E5E5">queries it is not kept consistent</font><font color="#CCCCCC"> it is</font>

273
00:12:05,110 --> 00:12:09,400
<font color="#E5E5E5">not fully production consistent but we</font>

274
00:12:07,270 --> 00:12:12,449
can mitigate a large part<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> problem</font>

275
00:12:09,400 --> 00:12:15,880
we can offload the reads<font color="#E5E5E5"> from the master</font>

276
00:12:12,450 --> 00:12:18,250
<font color="#CCCCCC">at</font><font color="#E5E5E5"> DW strain or to you ristic ELISA jest</font>

277
00:12:15,880 --> 00:12:19,990
<font color="#E5E5E5">that all replicas</font><font color="#CCCCCC"> are up to date and we</font>

278
00:12:18,250 --> 00:12:22,780
can offload queries<font color="#E5E5E5"> from master this is</font>

279
00:12:19,990 --> 00:12:26,830
<font color="#E5E5E5">not kept consistent</font><font color="#CCCCCC"> but we can achieve</font>

280
00:12:22,780 --> 00:12:30,310
better<font color="#CCCCCC"> consistency with with less impact</font>

281
00:12:26,830 --> 00:12:34,540
<font color="#CCCCCC">on</font><font color="#E5E5E5"> the master let's move on to the semi</font>

282
00:12:30,310 --> 00:12:36,219
<font color="#CCCCCC">sync with</font><font color="#E5E5E5"> them I think I write to the</font>

283
00:12:34,540 --> 00:12:38,770
master<font color="#CCCCCC"> and the right is</font><font color="#E5E5E5"> not acknowledged</font>

284
00:12:36,220 --> 00:12:40,630
until<font color="#E5E5E5"> the event the</font><font color="#CCCCCC"> bean log event has</font>

285
00:12:38,770 --> 00:12:44,560
<font color="#E5E5E5">been shaped to one or more replicas</font>

286
00:12:40,630 --> 00:12:47,020
depending on configuration<font color="#E5E5E5"> is this in a</font>

287
00:12:44,560 --> 00:12:50,050
more consistent system<font color="#E5E5E5"> because this is a</font>

288
00:12:47,020 --> 00:12:53,050
consistent<font color="#CCCCCC"> system right now it is not a</font>

289
00:12:50,050 --> 00:12:55,900
consistent<font color="#E5E5E5"> system because the only thing</font>

290
00:12:53,050 --> 00:12:58,540
<font color="#CCCCCC">that sustain guarantees is</font><font color="#E5E5E5"> durability of</font>

291
00:12:55,900 --> 00:13:00,610
my data<font color="#E5E5E5"> physically on another node but</font>

292
00:12:58,540 --> 00:13:02,199
nothing promises that the the data<font color="#E5E5E5"> has</font>

293
00:13:00,610 --> 00:13:04,150
been<font color="#E5E5E5"> the change has been applied</font><font color="#CCCCCC"> on that</font>

294
00:13:02,200 --> 00:13:06,420
<font color="#E5E5E5">node I still have replication like same</font>

295
00:13:04,150 --> 00:13:06,420
as before

296
00:13:06,510 --> 00:13:11,950
so this system is no more consistent<font color="#E5E5E5"> is</font>

297
00:13:09,310 --> 00:13:13,390
it more available<font color="#E5E5E5"> it is</font><font color="#CCCCCC"> not more</font>

298
00:13:11,950 --> 00:13:16,660
available because<font color="#CCCCCC"> there still</font><font color="#E5E5E5"> single</font>

299
00:13:13,390 --> 00:13:19,309
master it still<font color="#CCCCCC"> doesn't fit the model is</font>

300
00:13:16,660 --> 00:13:21,769
it even less available

301
00:13:19,309 --> 00:13:23,689
possibly<font color="#E5E5E5"> depending</font><font color="#CCCCCC"> on configuration if</font>

302
00:13:21,769 --> 00:13:26,599
you put an infinite<font color="#CCCCCC"> time-out on semi</font>

303
00:13:23,689 --> 00:13:29,269
<font color="#E5E5E5">sink and all</font><font color="#CCCCCC"> the replicas are isolated</font>

304
00:13:26,599 --> 00:13:31,459
that query on<font color="#CCCCCC"> the master might never</font>

305
00:13:29,269 --> 00:13:33,409
return<font color="#CCCCCC"> which makes the system not</font>

306
00:13:31,459 --> 00:13:37,459
available or less<font color="#E5E5E5"> available depending</font><font color="#CCCCCC"> on</font>

307
00:13:33,409 --> 00:13:41,989
how long you wait<font color="#CCCCCC"> it get up we have this</font>

308
00:13:37,459 --> 00:13:45,799
hybrid<font color="#CCCCCC"> setup</font><font color="#E5E5E5"> so we have local DC</font>

309
00:13:41,989 --> 00:13:47,839
replicas<font color="#E5E5E5"> use semi sink with a master</font>

310
00:13:45,799 --> 00:13:49,459
<font color="#E5E5E5">wait</font><font color="#CCCCCC"> time out</font><font color="#E5E5E5"> of 500 milliseconds and</font>

311
00:13:47,839 --> 00:13:54,679
<font color="#E5E5E5">remotely</font><font color="#CCCCCC"> see replicas don't use semi</font>

312
00:13:49,459 --> 00:13:56,358
sink at all<font color="#E5E5E5"> is my system</font><font color="#CCCCCC"> eighty or CP it</font>

313
00:13:54,679 --> 00:13:59,238
is neither right<font color="#E5E5E5"> it's not a P it's not</font>

314
00:13:56,359 --> 00:14:01,429
CP<font color="#E5E5E5"> but is it more</font><font color="#CCCCCC"> AP or more CP if we</font>

315
00:13:59,239 --> 00:14:03,829
try to approximate<font color="#E5E5E5"> what this really</font>

316
00:14:01,429 --> 00:14:07,309
<font color="#E5E5E5">depends when and where you look in this</font>

317
00:14:03,829 --> 00:14:09,709
DC it<font color="#CCCCCC"> is like more CP and that this is a</font>

318
00:14:07,309 --> 00:14:11,569
little<font color="#E5E5E5"> bit more</font><font color="#CCCCCC"> eighty</font><font color="#E5E5E5"> you cannot it</font>

319
00:14:09,709 --> 00:14:14,809
depends on the time of day on the

320
00:14:11,569 --> 00:14:17,659
<font color="#CCCCCC">workload you cannot classify</font><font color="#E5E5E5"> this system</font>

321
00:14:14,809 --> 00:14:19,939
by a single attribute right this is an

322
00:14:17,659 --> 00:14:24,589
AP system<font color="#E5E5E5"> you cannot it's a hybrid</font>

323
00:14:19,939 --> 00:14:27,559
system<font color="#E5E5E5"> take the</font><font color="#CCCCCC"> test so we test runs on</font>

324
00:14:24,589 --> 00:14:30,439
top of normal mask<font color="#E5E5E5"> you'll clusters and</font>

325
00:14:27,559 --> 00:14:32,598
<font color="#E5E5E5">it has this SQL interface the VD tablet</font>

326
00:14:30,439 --> 00:14:35,868
which I like<font color="#E5E5E5"> the proxy it is stateless</font>

327
00:14:32,599 --> 00:14:37,429
you send<font color="#E5E5E5"> queries it will break apart</font>

328
00:14:35,869 --> 00:14:40,729
<font color="#E5E5E5">those queries and send them to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> the</font>

329
00:14:37,429 --> 00:14:44,689
shards<font color="#E5E5E5"> the appropriate</font><font color="#CCCCCC"> shards</font><font color="#E5E5E5"> is that an</font>

330
00:14:40,729 --> 00:14:46,819
AP<font color="#CCCCCC"> system is CP system it is neither</font>

331
00:14:44,689 --> 00:14:49,219
because<font color="#E5E5E5"> it runs on</font><font color="#CCCCCC"> top of normal my</font>

332
00:14:46,819 --> 00:14:53,959
skill clusters hence it has the exact

333
00:14:49,220 --> 00:14:57,829
<font color="#CCCCCC">same properties</font><font color="#E5E5E5"> but but if you set same</font>

334
00:14:53,959 --> 00:15:00,649
<font color="#E5E5E5">I</font><font color="#CCCCCC"> think and you send only</font><font color="#E5E5E5"> re traffic</font>

335
00:14:57,829 --> 00:15:05,169
<font color="#E5E5E5">only from the master</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> you have a</font>

336
00:15:00,649 --> 00:15:08,599
reasonable failover mechanism then then

337
00:15:05,169 --> 00:15:11,989
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> get a very highly available</font>

338
00:15:08,599 --> 00:15:14,929
system a very<font color="#CCCCCC"> highly consistent system</font>

339
00:15:11,989 --> 00:15:16,639
<font color="#CCCCCC">one that</font><font color="#E5E5E5"> can scale because the</font><font color="#CCCCCC"> load of</font>

340
00:15:14,929 --> 00:15:21,259
<font color="#E5E5E5">the master is no longer an issue you</font><font color="#CCCCCC"> can</font>

341
00:15:16,639 --> 00:15:22,510
always<font color="#CCCCCC"> Rashad so you can get much of all</font>

342
00:15:21,259 --> 00:15:24,360
the world

343
00:15:22,510 --> 00:15:26,740
right all the good things together

344
00:15:24,360 --> 00:15:29,010
<font color="#CCCCCC">without this system being neither</font>

345
00:15:26,740 --> 00:15:31,480
available<font color="#CCCCCC"> needed nor consistent and</font>

346
00:15:29,010 --> 00:15:33,490
that's like the dirty little secret of

347
00:15:31,480 --> 00:15:35,380
<font color="#CCCCCC">CAP</font><font color="#E5E5E5"> it is not it does not have the power</font>

348
00:15:33,490 --> 00:15:37,990
of equals mc-squared

349
00:15:35,380 --> 00:15:40,510
imagine NASA wanted to send a spaceship

350
00:15:37,990 --> 00:15:43,389
<font color="#E5E5E5">that</font><font color="#CCCCCC"> goes beyond</font><font color="#E5E5E5"> the speed of light</font>

351
00:15:40,510 --> 00:15:47,170
<font color="#CCCCCC">right imagine this brilliant engineer</font>

352
00:15:43,389 --> 00:15:48,370
stepping up and says I know<font color="#E5E5E5"> I'm going to</font>

353
00:15:47,170 --> 00:15:50,620
make<font color="#CCCCCC"> a trade-off</font>

354
00:15:48,370 --> 00:15:53,019
I'm gonna build a spaceship<font color="#CCCCCC"> that runs</font>

355
00:15:50,620 --> 00:15:55,990
<font color="#CCCCCC">ten times the speed of</font><font color="#E5E5E5"> light</font><font color="#CCCCCC"> ninety-nine</font>

356
00:15:53,019 --> 00:15:57,850
<font color="#CCCCCC">percent of the time</font><font color="#E5E5E5"> and then the</font><font color="#CCCCCC"> next</font>

357
00:15:55,990 --> 00:16:00,880
one<font color="#E5E5E5"> one percent of the time it will run</font>

358
00:15:57,850 --> 00:16:03,220
<font color="#E5E5E5">only half the speed of light okay that</font>

359
00:16:00,880 --> 00:16:06,279
can't be done<font color="#E5E5E5"> because</font><font color="#CCCCCC"> equals mc-squared</font>

360
00:16:03,220 --> 00:16:08,470
<font color="#CCCCCC">you can do that sorry</font><font color="#E5E5E5"> but with cap</font>

361
00:16:06,279 --> 00:16:10,689
theorem we are<font color="#E5E5E5"> able</font><font color="#CCCCCC"> to work around the</font>

362
00:16:08,470 --> 00:16:14,139
limitations<font color="#CCCCCC"> and come up with a highly</font>

363
00:16:10,690 --> 00:16:18,850
<font color="#CCCCCC">consistence highly available</font><font color="#E5E5E5"> system and</font>

364
00:16:14,139 --> 00:16:21,300
we don't do we really need<font color="#E5E5E5"> it there's</font>

365
00:16:18,850 --> 00:16:24,490
more<font color="#E5E5E5"> let's talk about in a big cluster</font>

366
00:16:21,300 --> 00:16:26,680
<font color="#E5E5E5">before</font><font color="#CCCCCC"> eight point zero 14</font><font color="#E5E5E5"> thank you</font>

367
00:16:24,490 --> 00:16:30,190
Oracle for changing<font color="#CCCCCC"> my slides at the</font>

368
00:16:26,680 --> 00:16:33,130
last moment<font color="#E5E5E5"> so single</font><font color="#CCCCCC"> writer in a blue</font>

369
00:16:30,190 --> 00:16:34,930
cluster<font color="#E5E5E5"> now we have</font><font color="#CCCCCC"> Paxos alright that's</font>

370
00:16:33,130 --> 00:16:37,420
consensus there is the interesting<font color="#E5E5E5"> stuff</font>

371
00:16:34,930 --> 00:16:39,459
is decent available<font color="#E5E5E5"> available system is</font>

372
00:16:37,420 --> 00:16:45,490
this<font color="#CCCCCC"> a consistent</font><font color="#E5E5E5"> system who says it's</font>

373
00:16:39,459 --> 00:16:48,459
available<font color="#E5E5E5"> who says it's consistent it is</font>

374
00:16:45,490 --> 00:16:51,250
neither available nor consistent people

375
00:16:48,459 --> 00:16:52,839
<font color="#E5E5E5">so availability why is this not an</font>

376
00:16:51,250 --> 00:16:55,720
available<font color="#E5E5E5"> system because I could</font>

377
00:16:52,839 --> 00:16:57,790
petition<font color="#E5E5E5"> the</font><font color="#CCCCCC"> network so badly that there</font>

378
00:16:55,720 --> 00:16:59,319
will be no quorum if there's no qualms

379
00:16:57,790 --> 00:17:01,630
<font color="#E5E5E5">there's no leader if there's no leader</font>

380
00:16:59,319 --> 00:17:03,959
there is<font color="#E5E5E5"> no writer no rights can be</font>

381
00:17:01,630 --> 00:17:06,429
accepted so<font color="#CCCCCC"> we can make this system</font>

382
00:17:03,959 --> 00:17:08,530
<font color="#CCCCCC">unavailable on that repetition</font><font color="#E5E5E5"> is it</font>

383
00:17:06,429 --> 00:17:12,250
consistent<font color="#CCCCCC"> it is not because</font><font color="#E5E5E5"> you know</font>

384
00:17:08,530 --> 00:17:13,869
the big cluster<font color="#E5E5E5"> beef 48.0 14 only</font>

385
00:17:12,250 --> 00:17:16,000
<font color="#CCCCCC">guarantees much like Sam I think that</font>

386
00:17:13,869 --> 00:17:20,500
the data<font color="#CCCCCC"> gets durable in another</font><font color="#E5E5E5"> node</font>

387
00:17:16,000 --> 00:17:22,990
but necessarily applied of course you

388
00:17:20,500 --> 00:17:24,910
can put<font color="#CCCCCC"> a proxy and route all</font><font color="#E5E5E5"> queries to</font>

389
00:17:22,990 --> 00:17:29,130
<font color="#CCCCCC">the leader and get very very good</font>

390
00:17:24,910 --> 00:17:31,900
<font color="#E5E5E5">consistency but hack wise it's neither</font>

391
00:17:29,130 --> 00:17:32,840
<font color="#E5E5E5">with multi writer nodes you still get</font>

392
00:17:31,900 --> 00:17:36,110
the same<font color="#CCCCCC"> no</font>

393
00:17:32,840 --> 00:17:38,770
<font color="#E5E5E5">available not consistent system in</font><font color="#CCCCCC"> its</font>

394
00:17:36,110 --> 00:17:41,870
possibly even less available because<font color="#E5E5E5"> now</font>

395
00:17:38,770 --> 00:17:45,500
<font color="#E5E5E5">nodes may refuse your requests because</font>

396
00:17:41,870 --> 00:17:47,629
<font color="#E5E5E5">of conflict and that's not good with cap</font>

397
00:17:45,500 --> 00:17:51,830
<font color="#E5E5E5">so it's even less available if you have</font>

398
00:17:47,630 --> 00:17:56,029
more<font color="#CCCCCC"> writers it makes sense</font><font color="#E5E5E5"> less and</font>

399
00:17:51,830 --> 00:18:00,199
less<font color="#E5E5E5"> Galera</font>

400
00:17:56,029 --> 00:18:01,730
so<font color="#E5E5E5"> Galera is just as unavailable as you</font>

401
00:18:00,200 --> 00:18:03,169
know to be cluster<font color="#E5E5E5"> because I could</font>

402
00:18:01,730 --> 00:18:04,909
petition<font color="#E5E5E5"> the network so badly that</font>

403
00:18:03,169 --> 00:18:09,070
<font color="#E5E5E5">there's no</font><font color="#CCCCCC"> quorum no leader no</font><font color="#E5E5E5"> rights</font>

404
00:18:04,909 --> 00:18:12,230
but it introduces<font color="#CCCCCC"> the WS</font><font color="#E5E5E5"> reps</font><font color="#CCCCCC"> equate</font>

405
00:18:09,070 --> 00:18:13,879
<font color="#E5E5E5">argument a variable which we can set to</font>

406
00:18:12,230 --> 00:18:18,260
<font color="#CCCCCC">a nonzero value</font><font color="#E5E5E5"> let's say it's</font><font color="#CCCCCC"> three</font>

407
00:18:13,880 --> 00:18:21,020
which<font color="#E5E5E5"> means I could block on the reason</font>

408
00:18:18,260 --> 00:18:22,700
<font color="#E5E5E5">till they've</font><font color="#CCCCCC"> being applied a block on</font>

409
00:18:21,020 --> 00:18:25,850
<font color="#E5E5E5">the</font><font color="#CCCCCC"> right until they've been applied on</font>

410
00:18:22,700 --> 00:18:29,000
<font color="#CCCCCC">the other</font><font color="#E5E5E5"> nodes or block on the</font><font color="#CCCCCC"> reads so</font>

411
00:18:25,850 --> 00:18:31,330
they wait<font color="#E5E5E5"> on those rights to apply that</font>

412
00:18:29,000 --> 00:18:35,200
sounds like a consistent<font color="#E5E5E5"> system and</font>

413
00:18:31,330 --> 00:18:37,370
really<font color="#CCCCCC"> in practice</font><font color="#E5E5E5"> it's wonderful</font>

414
00:18:35,200 --> 00:18:40,010
according to cap<font color="#E5E5E5"> this is not a</font>

415
00:18:37,370 --> 00:18:44,389
<font color="#CCCCCC">consistent system because a single node</font>

416
00:18:40,010 --> 00:18:47,929
can<font color="#CCCCCC"> be isolated</font><font color="#E5E5E5"> and when it's isolated</font>

417
00:18:44,390 --> 00:18:50,659
<font color="#CCCCCC">it will take a timeout so that node</font><font color="#E5E5E5"> to</font>

418
00:18:47,929 --> 00:18:53,630
recognize that it's isolated<font color="#E5E5E5"> during that</font>

419
00:18:50,659 --> 00:18:56,690
<font color="#E5E5E5">time it will serve inconsistent reads it</font>

420
00:18:53,630 --> 00:18:58,730
<font color="#CCCCCC">will serve stale data</font><font color="#E5E5E5"> it could be five</font>

421
00:18:56,690 --> 00:19:01,039
seconds<font color="#CCCCCC"> it could be nothing</font><font color="#E5E5E5"> right</font>

422
00:18:58,730 --> 00:19:03,590
<font color="#E5E5E5">according</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the cap theorem this is</font>

423
00:19:01,039 --> 00:19:05,960
mathematics right we just<font color="#E5E5E5"> proved that</font>

424
00:19:03,590 --> 00:19:09,230
something can be done using an infinite

425
00:19:05,960 --> 00:19:12,250
<font color="#CCCCCC">network petition</font><font color="#E5E5E5"> right so here's another</font>

426
00:19:09,230 --> 00:19:14,659
use<font color="#CCCCCC"> case this</font><font color="#E5E5E5"> is not a consistent system</font>

427
00:19:12,250 --> 00:19:18,169
you know the<font color="#CCCCCC"> big cluster congratulations</font>

428
00:19:14,659 --> 00:19:22,880
<font color="#E5E5E5">Oracle 10 days ago released a week ago</font>

429
00:19:18,169 --> 00:19:25,100
whatever 8.0<font color="#E5E5E5"> 14 with really interesting</font>

430
00:19:22,880 --> 00:19:28,640
stuff in a<font color="#E5E5E5"> big cluster it can now serve</font>

431
00:19:25,100 --> 00:19:31,850
consistent reads not<font color="#CCCCCC"> kept consistent</font><font color="#E5E5E5"> I'm</font>

432
00:19:28,640 --> 00:19:34,100
sorry<font color="#CCCCCC"> it</font><font color="#E5E5E5"> is not an</font><font color="#CCCCCC"> available system</font>

433
00:19:31,850 --> 00:19:40,399
because<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the same network partitioning</font>

434
00:19:34,100 --> 00:19:43,908
problem<font color="#E5E5E5"> and much like the</font><font color="#CCCCCC"> Galera problem</font>

435
00:19:40,399 --> 00:19:45,570
<font color="#E5E5E5">if I isolate a single node there will be</font>

436
00:19:43,909 --> 00:19:47,430
<font color="#E5E5E5">a</font><font color="#CCCCCC"> timeout</font>

437
00:19:45,570 --> 00:19:49,770
amount of time some small amount of<font color="#E5E5E5"> time</font>

438
00:19:47,430 --> 00:19:53,190
<font color="#E5E5E5">again in production I'm really happy</font>

439
00:19:49,770 --> 00:19:56,940
with<font color="#E5E5E5"> this cap theorem wise this</font><font color="#CCCCCC"> is not</font>

440
00:19:53,190 --> 00:19:59,520
consistent<font color="#CCCCCC"> system so this</font><font color="#E5E5E5"> will serve</font>

441
00:19:56,940 --> 00:20:01,290
stale<font color="#CCCCCC"> reads</font><font color="#E5E5E5"> now we</font><font color="#CCCCCC"> didn't know the B</font>

442
00:19:59,520 --> 00:20:03,480
cluster we have an extra<font color="#CCCCCC"> option that</font>

443
00:20:01,290 --> 00:20:05,520
says<font color="#E5E5E5"> what happens to that isolated</font>

444
00:20:03,480 --> 00:20:09,930
server does it just turn read-only and

445
00:20:05,520 --> 00:20:12,540
refuses queries or does it shut itself

446
00:20:09,930 --> 00:20:15,870
<font color="#CCCCCC">down it can kill itself</font><font color="#E5E5E5"> commit suicide</font>

447
00:20:12,540 --> 00:20:19,379
once it realizes<font color="#CCCCCC"> its</font><font color="#E5E5E5"> it is not a part of</font>

448
00:20:15,870 --> 00:20:21,500
the<font color="#E5E5E5"> quorum or part of the cluster so</font>

449
00:20:19,380 --> 00:20:24,750
that<font color="#E5E5E5"> doesn't make it more</font><font color="#CCCCCC"> consistent but</font>

450
00:20:21,500 --> 00:20:28,950
killing the node<font color="#E5E5E5"> makes it more</font><font color="#CCCCCC"> available</font>

451
00:20:24,750 --> 00:20:30,750
<font color="#CCCCCC">so it's a bit a bit ironic that by</font>

452
00:20:28,950 --> 00:20:33,090
<font color="#CCCCCC">killing a node which makes</font><font color="#E5E5E5"> perfect sense</font>

453
00:20:30,750 --> 00:20:36,950
by<font color="#E5E5E5"> the way we make the system more</font>

454
00:20:33,090 --> 00:20:36,949
available according<font color="#E5E5E5"> to the cap theorem</font>

455
00:20:37,520 --> 00:20:51,330
sorry<font color="#E5E5E5"> okay all right</font><font color="#CCCCCC"> I have</font><font color="#E5E5E5"> to move on</font>

456
00:20:47,640 --> 00:20:53,490
<font color="#E5E5E5">I'll take this later</font><font color="#CCCCCC"> so far we haven't</font>

457
00:20:51,330 --> 00:20:55,830
seen<font color="#CCCCCC"> a single ap</font><font color="#E5E5E5"> system a single CP</font>

458
00:20:53,490 --> 00:20:58,770
system is there an AP system<font color="#CCCCCC"> yes there</font>

459
00:20:55,830 --> 00:21:00,570
is take<font color="#CCCCCC"> six masters not connected to</font>

460
00:20:58,770 --> 00:21:01,860
<font color="#CCCCCC">each</font><font color="#E5E5E5"> other in any way not replicating</font>

461
00:21:00,570 --> 00:21:04,139
not doing<font color="#CCCCCC"> anything in between each other</font>

462
00:21:01,860 --> 00:21:05,639
<font color="#E5E5E5">this is</font><font color="#CCCCCC"> an AP system of course there's</font>

463
00:21:04,140 --> 00:21:07,830
zero consistency and this<font color="#E5E5E5"> is not</font>

464
00:21:05,640 --> 00:21:10,740
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> a circular master</font>

465
00:21:07,830 --> 00:21:12,210
<font color="#CCCCCC">replication</font><font color="#E5E5E5"> is also an AP system but we</font>

466
00:21:10,740 --> 00:21:14,490
all know<font color="#CCCCCC"> they're in production we are</font>

467
00:21:12,210 --> 00:21:16,620
moving<font color="#E5E5E5"> away from this</font><font color="#CCCCCC"> setup this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> not</font>

468
00:21:14,490 --> 00:21:19,200
something that<font color="#E5E5E5"> I know a lot of companies</font>

469
00:21:16,620 --> 00:21:21,270
<font color="#CCCCCC">have just moved away from master master</font>

470
00:21:19,200 --> 00:21:26,700
<font color="#CCCCCC">replication so the AP systems are not</font>

471
00:21:21,270 --> 00:21:28,620
very compelling<font color="#CCCCCC"> and so</font><font color="#E5E5E5"> it's takeaways</font>

472
00:21:26,700 --> 00:21:33,090
and I'm<font color="#E5E5E5"> running out of time</font>

473
00:21:28,620 --> 00:21:36,840
<font color="#CCCCCC">let's take aways</font><font color="#E5E5E5"> I'm not sure cap is the</font>

474
00:21:33,090 --> 00:21:38,820
<font color="#E5E5E5">right model</font><font color="#CCCCCC"> for us we just like I</font><font color="#E5E5E5"> just</font>

475
00:21:36,840 --> 00:21:40,350
took all these<font color="#E5E5E5"> setups and said they're</font>

476
00:21:38,820 --> 00:21:42,060
not available<font color="#E5E5E5"> not consistent not</font>

477
00:21:40,350 --> 00:21:45,689
available<font color="#CCCCCC"> not criticism is</font><font color="#E5E5E5"> that a bad</font>

478
00:21:42,060 --> 00:21:47,310
thing<font color="#CCCCCC"> for</font><font color="#E5E5E5"> those systems</font><font color="#CCCCCC"> I don't think so</font>

479
00:21:45,690 --> 00:21:49,560
I think these systems are excellent we

480
00:21:47,310 --> 00:21:51,810
are able to achieve most what we want

481
00:21:49,560 --> 00:21:53,970
from<font color="#E5E5E5"> those systems maybe the problem is</font>

482
00:21:51,810 --> 00:21:56,399
that<font color="#CCCCCC"> we try to enforce the cap theorem</font>

483
00:21:53,970 --> 00:21:57,620
on something that does<font color="#E5E5E5"> not play</font><font color="#CCCCCC"> well</font>

484
00:21:56,400 --> 00:21:59,900
with<font color="#CCCCCC"> the cap theorem</font>

485
00:21:57,620 --> 00:22:03,199
I'm not sure we<font color="#CCCCCC"> necessarily want to talk</font>

486
00:21:59,900 --> 00:22:04,970
about<font color="#E5E5E5"> the cap theorem</font><font color="#CCCCCC"> the definition of</font>

487
00:22:03,200 --> 00:22:06,559
availability according to cap is not

488
00:22:04,970 --> 00:22:10,190
something I<font color="#CCCCCC"> feel comfortable with this</font>

489
00:22:06,559 --> 00:22:12,740
doesn't make<font color="#E5E5E5"> sense</font><font color="#CCCCCC"> to me and so please</font>

490
00:22:10,190 --> 00:22:14,720
be wary of<font color="#CCCCCC"> people waving</font><font color="#E5E5E5"> the cap theorem</font>

491
00:22:12,740 --> 00:22:16,370
<font color="#E5E5E5">saying you can't achieve this because of</font>

492
00:22:14,720 --> 00:22:18,440
<font color="#E5E5E5">that yes there is</font><font color="#CCCCCC"> a trade-off between</font>

493
00:22:16,370 --> 00:22:21,010
availability<font color="#CCCCCC"> and petition and</font>

494
00:22:18,440 --> 00:22:23,930
consistency<font color="#E5E5E5"> but it's not the one</font>

495
00:22:21,010 --> 00:22:27,980
everyone thinks it is it's a<font color="#E5E5E5"> different</font>

496
00:22:23,930 --> 00:22:30,890
trade-off<font color="#CCCCCC"> there's an</font><font color="#E5E5E5"> extension to</font><font color="#CCCCCC"> cap</font>

497
00:22:27,980 --> 00:22:32,660
read<font color="#E5E5E5"> about it later</font><font color="#CCCCCC"> there's a bunch of</font>

498
00:22:30,890 --> 00:22:34,790
<font color="#E5E5E5">links there's a lot of information on</font>

499
00:22:32,660 --> 00:22:38,540
the internet on<font color="#CCCCCC"> the cap theorem</font><font color="#E5E5E5"> I found</font>

500
00:22:34,790 --> 00:22:42,020
many misleading or incorrect articles so

501
00:22:38,540 --> 00:22:47,210
<font color="#E5E5E5">point in here quite a few links that are</font>

502
00:22:42,020 --> 00:22:50,639
correct<font color="#CCCCCC"> I believe and thank you</font>

503
00:22:47,210 --> 00:22:52,470
[Applause]

504
00:22:50,640 --> 00:22:56,289
[Music]

505
00:22:52,470 --> 00:22:56,289
[Applause]

