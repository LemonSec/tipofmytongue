1
00:00:07,080 --> 00:00:17,580
hello<font color="#E5E5E5"> hi welcome to</font>

2
00:00:11,190 --> 00:00:19,799
presentation on<font color="#E5E5E5"> Netflix and FreeBSD my</font>

3
00:00:17,580 --> 00:00:21,150
name is Jonathan Looney I am the manager

4
00:00:19,800 --> 00:00:24,750
of a software development group at

5
00:00:21,150 --> 00:00:26,729
Netflix<font color="#CCCCCC"> my group maintains and develops</font>

6
00:00:24,750 --> 00:00:28,649
<font color="#E5E5E5">the operating system</font><font color="#CCCCCC"> that runs on</font><font color="#E5E5E5"> the</font>

7
00:00:26,730 --> 00:00:30,899
content caches<font color="#CCCCCC"> that stir that served</font>

8
00:00:28,649 --> 00:00:32,279
<font color="#E5E5E5">Netflix is a streaming video and I'm</font>

9
00:00:30,899 --> 00:00:34,280
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> talk to you a little bit about how</font>

10
00:00:32,279 --> 00:00:36,540
we<font color="#E5E5E5"> develop that software and</font>

11
00:00:34,280 --> 00:00:39,180
specifically<font color="#E5E5E5"> how we use some open source</font>

12
00:00:36,540 --> 00:00:42,089
<font color="#E5E5E5">software</font><font color="#CCCCCC"> and particularly</font><font color="#E5E5E5"> FreeBSD to</font>

13
00:00:39,180 --> 00:00:45,780
deliver our<font color="#E5E5E5"> streaming video to happy</font>

14
00:00:42,090 --> 00:00:46,890
consumers around the<font color="#E5E5E5"> world</font><font color="#CCCCCC"> so to start</font>

15
00:00:45,780 --> 00:00:51,050
with I<font color="#E5E5E5"> need to tell you</font><font color="#CCCCCC"> that open</font>

16
00:00:46,890 --> 00:00:51,050
<font color="#E5E5E5">connect open connect is Netflix is</font><font color="#CCCCCC"> CDN</font>

17
00:00:51,140 --> 00:00:57,120
open<font color="#E5E5E5"> connect is a global efficient and</font>

18
00:00:54,499 --> 00:01:04,500
purpose-built CDN for distributing

19
00:00:57,120 --> 00:01:07,620
<font color="#E5E5E5">Netflix is content</font><font color="#CCCCCC"> it is</font><font color="#E5E5E5"> it is global it</font>

20
00:01:04,500 --> 00:01:11,159
<font color="#CCCCCC">is large</font><font color="#E5E5E5"> it is very fun to work on the</font>

21
00:01:07,620 --> 00:01:13,920
<font color="#E5E5E5">open connect</font><font color="#CCCCCC"> network at our peak we</font>

22
00:01:11,159 --> 00:01:17,370
deliver<font color="#E5E5E5"> over 100 terabits per second</font>

23
00:01:13,920 --> 00:01:19,340
<font color="#E5E5E5">around the world</font><font color="#CCCCCC"> and that</font><font color="#E5E5E5"> makes the</font>

24
00:01:17,370 --> 00:01:23,610
engineering challenges very interesting

25
00:01:19,340 --> 00:01:25,200
<font color="#E5E5E5">so 1% differences make a big deal</font>

26
00:01:23,610 --> 00:01:28,350
<font color="#CCCCCC">they're a big deal</font><font color="#E5E5E5"> when you're dealing</font>

27
00:01:25,200 --> 00:01:29,940
<font color="#E5E5E5">with these large scales</font><font color="#CCCCCC"> as I was</font>

28
00:01:28,350 --> 00:01:31,770
preparing<font color="#CCCCCC"> for the talk and I was</font>

29
00:01:29,940 --> 00:01:35,190
<font color="#E5E5E5">thinking about this I was realizing</font><font color="#CCCCCC"> that</font>

30
00:01:31,770 --> 00:01:38,220
if we had a 1%<font color="#E5E5E5"> change in the number of</font>

31
00:01:35,190 --> 00:01:40,259
TCP segments we<font color="#CCCCCC"> transmit so for instance</font>

32
00:01:38,220 --> 00:01:43,020
if we<font color="#E5E5E5"> already transmitted a 1% more of</font>

33
00:01:40,260 --> 00:01:45,810
the TCP segments on<font color="#E5E5E5"> our network</font><font color="#CCCCCC"> that's</font>

34
00:01:43,020 --> 00:01:47,729
an extra terabit per second at peak that

35
00:01:45,810 --> 00:01:50,700
we're sending out to the<font color="#CCCCCC"> Internet and</font>

36
00:01:47,730 --> 00:01:53,220
<font color="#CCCCCC">that's a lot of</font><font color="#E5E5E5"> traffic</font><font color="#CCCCCC"> and that's a big</font>

37
00:01:50,700 --> 00:01:56,190
change<font color="#CCCCCC"> and so we work in an</font><font color="#E5E5E5"> environment</font>

38
00:01:53,220 --> 00:01:59,870
where<font color="#E5E5E5"> small changes are a big deal and</font>

39
00:01:56,190 --> 00:02:02,929
<font color="#E5E5E5">we also value small improvements</font>

40
00:01:59,870 --> 00:02:05,640
<font color="#E5E5E5">obviously we'd like big ones but every</font>

41
00:02:02,930 --> 00:02:07,260
<font color="#CCCCCC">every little bit of efficiency matters</font>

42
00:02:05,640 --> 00:02:13,349
and so it's a<font color="#E5E5E5"> really</font><font color="#CCCCCC"> fun environment</font><font color="#E5E5E5"> to</font>

43
00:02:07,260 --> 00:02:16,860
work<font color="#E5E5E5"> and do engineering work the part of</font>

44
00:02:13,349 --> 00:02:18,869
our CDN<font color="#E5E5E5"> is our content caches</font>

45
00:02:16,860 --> 00:02:21,060
you could almost say that the<font color="#CCCCCC"> backbone</font>

46
00:02:18,870 --> 00:02:23,360
of the open connect<font color="#E5E5E5"> network they are</font>

47
00:02:21,060 --> 00:02:24,920
what<font color="#E5E5E5"> delivers that</font><font color="#CCCCCC"> hundreds here</font>

48
00:02:23,360 --> 00:02:27,829
for more<font color="#E5E5E5"> than hundred terabytes per</font>

49
00:02:24,920 --> 00:02:31,458
second at peak<font color="#CCCCCC"> you see here a picture of</font>

50
00:02:27,829 --> 00:02:32,450
<font color="#E5E5E5">the one of</font><font color="#CCCCCC"> our storage appliances from</font><font color="#E5E5E5"> a</font>

51
00:02:31,459 --> 00:02:34,760
few years<font color="#E5E5E5"> ago</font>

52
00:02:32,450 --> 00:02:38,719
it's the 40 gigabit per second attached

53
00:02:34,760 --> 00:02:40,608
storage appliance<font color="#CCCCCC"> and it has 248</font>

54
00:02:38,719 --> 00:02:45,140
terabytes of storage and a<font color="#CCCCCC"> to ru form</font>

55
00:02:40,609 --> 00:02:48,290
factor<font color="#CCCCCC"> we also have other varieties of</font>

56
00:02:45,140 --> 00:02:48,920
caches our highest end<font color="#E5E5E5"> production one at</font>

57
00:02:48,290 --> 00:02:51,170
the moment

58
00:02:48,920 --> 00:02:53,540
delivers<font color="#E5E5E5"> hundreds here or 100 gigabits</font>

59
00:02:51,170 --> 00:02:58,179
<font color="#E5E5E5">it's a hundred gigabits per second</font>

60
00:02:53,540 --> 00:03:02,060
attached<font color="#CCCCCC"> and it delivers</font><font color="#E5E5E5"> it can deliver</font>

61
00:02:58,180 --> 00:03:05,209
<font color="#E5E5E5">essentially</font><font color="#CCCCCC"> a full</font><font color="#E5E5E5"> line rate in a</font><font color="#CCCCCC"> one</font>

62
00:03:02,060 --> 00:03:09,349
argued form factor<font color="#CCCCCC"> the OCA runs almost</font>

63
00:03:05,209 --> 00:03:12,409
<font color="#E5E5E5">exclusively open source</font><font color="#CCCCCC"> software</font><font color="#E5E5E5"> and two</font>

64
00:03:09,349 --> 00:03:14,599
of the<font color="#CCCCCC"> more important things we run are</font>

65
00:03:12,409 --> 00:03:16,780
the operating system is based on FreeBSD

66
00:03:14,599 --> 00:03:20,689
it's a lightly<font color="#E5E5E5"> modified version of that</font>

67
00:03:16,780 --> 00:03:22,669
and our web server is a<font color="#E5E5E5"> slightly</font>

68
00:03:20,689 --> 00:03:26,900
<font color="#E5E5E5">modified</font><font color="#CCCCCC"> version of nginx or slightly</font>

69
00:03:22,669 --> 00:03:29,359
customized version of nginx this is our

70
00:03:26,900 --> 00:03:31,879
typical<font color="#E5E5E5"> traffic profile you'll see that</font>

71
00:03:29,359 --> 00:03:35,709
<font color="#E5E5E5">we have lots of Netflix clients that are</font>

72
00:03:31,879 --> 00:03:38,388
<font color="#E5E5E5">pulling data</font><font color="#CCCCCC"> from our CDN we have a</font>

73
00:03:35,709 --> 00:03:40,280
group that manages<font color="#CCCCCC"> the</font><font color="#E5E5E5"> steering for that</font>

74
00:03:38,389 --> 00:03:43,940
so we can<font color="#E5E5E5"> steer the Netflix clients to</font>

75
00:03:40,280 --> 00:03:48,169
go to the<font color="#CCCCCC"> the right caches for to serve</font>

76
00:03:43,940 --> 00:03:50,449
their content<font color="#CCCCCC"> there there are</font>

77
00:03:48,169 --> 00:03:52,220
redundancies<font color="#E5E5E5"> built into the system and</font>

78
00:03:50,449 --> 00:03:54,709
controlling the clients is<font color="#CCCCCC"> very helpful</font>

79
00:03:52,220 --> 00:03:56,090
<font color="#E5E5E5">because there it gives us the chance</font><font color="#CCCCCC"> to</font>

80
00:03:54,709 --> 00:03:58,909
tell them exactly<font color="#E5E5E5"> how they should behave</font>

81
00:03:56,090 --> 00:04:00,199
<font color="#CCCCCC">in</font><font color="#E5E5E5"> various failure scenarios and so we</font>

82
00:03:58,909 --> 00:04:02,599
can build redundancies into the stitch

83
00:04:00,199 --> 00:04:05,359
<font color="#E5E5E5">into the system such that if a single</font>

84
00:04:02,599 --> 00:04:07,638
<font color="#CCCCCC">o-ca fails a single one of our content</font>

85
00:04:05,359 --> 00:04:10,909
caches fails<font color="#E5E5E5"> the clients can seamlessly</font>

86
00:04:07,639 --> 00:04:15,019
switch<font color="#E5E5E5"> over to</font><font color="#CCCCCC"> other content caches and</font>

87
00:04:10,909 --> 00:04:18,289
that means that if<font color="#CCCCCC"> we are testing the</font>

88
00:04:15,019 --> 00:04:20,780
new software<font color="#E5E5E5"> and that new software has</font>

89
00:04:18,289 --> 00:04:23,120
some sort<font color="#E5E5E5"> of</font><font color="#CCCCCC"> fatal error</font><font color="#E5E5E5"> our clients can</font>

90
00:04:20,779 --> 00:04:24,590
seamlessly<font color="#E5E5E5"> switch over to something</font>

91
00:04:23,120 --> 00:04:27,590
running<font color="#CCCCCC"> more</font><font color="#E5E5E5"> stable software and</font>

92
00:04:24,590 --> 00:04:29,150
continue to be served without<font color="#E5E5E5"> hopefully</font>

93
00:04:27,590 --> 00:04:32,109
<font color="#E5E5E5">without even noticing any difference in</font>

94
00:04:29,150 --> 00:04:32,109
the quality of<font color="#E5E5E5"> their video</font>

95
00:04:33,180 --> 00:04:36,240
we also get<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of data back</font><font color="#CCCCCC"> from</font>

96
00:04:34,620 --> 00:04:37,740
<font color="#CCCCCC">these clients and so getting controlling</font>

97
00:04:36,240 --> 00:04:39,930
the clients<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> very helpful</font><font color="#CCCCCC"> because</font>

98
00:04:37,740 --> 00:04:41,639
<font color="#E5E5E5">the clients can tell us or controlling</font>

99
00:04:39,930 --> 00:04:43,800
these applicant applications is<font color="#CCCCCC"> very</font>

100
00:04:41,639 --> 00:04:45,000
helpful<font color="#CCCCCC"> because the client applications</font>

101
00:04:43,800 --> 00:04:47,550
can tell us exactly<font color="#E5E5E5"> what they think</font>

102
00:04:45,000 --> 00:04:49,440
<font color="#CCCCCC">about the quality of the cash that</font>

103
00:04:47,550 --> 00:04:51,120
they're talking<font color="#CCCCCC"> to they can tell us</font>

104
00:04:49,440 --> 00:04:53,430
<font color="#E5E5E5">whether they can tell us how fast they</font>

105
00:04:51,120 --> 00:04:55,229
were<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to get the video whether they</font>

106
00:04:53,430 --> 00:04:58,770
got it fast<font color="#E5E5E5"> enough to satisfy the</font>

107
00:04:55,229 --> 00:05:01,800
streaming needs of the client<font color="#CCCCCC"> whether it</font>

108
00:04:58,770 --> 00:05:03,060
<font color="#E5E5E5">was very choppy or smooth</font><font color="#CCCCCC"> things like</font>

109
00:05:01,800 --> 00:05:06,080
that so we<font color="#CCCCCC"> can get</font><font color="#E5E5E5"> a lot of</font><font color="#CCCCCC"> good</font>

110
00:05:03,060 --> 00:05:09,180
<font color="#CCCCCC">information from our video applications</font>

111
00:05:06,080 --> 00:05:10,680
<font color="#E5E5E5">and that helps us</font><font color="#CCCCCC"> to make informed</font>

112
00:05:09,180 --> 00:05:13,020
<font color="#CCCCCC">decisions about whether we've made</font>

113
00:05:10,680 --> 00:05:16,560
things<font color="#CCCCCC"> better or</font><font color="#E5E5E5"> worse in the software</font>

114
00:05:13,020 --> 00:05:18,690
<font color="#CCCCCC">that we're developing our typical</font>

115
00:05:16,560 --> 00:05:21,150
workload on one of<font color="#E5E5E5"> our content caches</font>

116
00:05:18,690 --> 00:05:22,979
looks like a typical<font color="#CCCCCC"> web server you've</font>

117
00:05:21,150 --> 00:05:25,919
got a bunch<font color="#E5E5E5"> of storage you need to get</font>

118
00:05:22,979 --> 00:05:29,130
data<font color="#CCCCCC"> off the storage into memory</font><font color="#E5E5E5"> we then</font>

119
00:05:25,919 --> 00:05:31,919
encrypt it we often encrypt it<font color="#CCCCCC"> for</font>

120
00:05:29,130 --> 00:05:34,409
transmission<font color="#CCCCCC"> over TLS</font><font color="#E5E5E5"> session and then</font>

121
00:05:31,919 --> 00:05:39,960
we send it out<font color="#E5E5E5"> we send it out some</font><font color="#CCCCCC"> mix</font>

122
00:05:34,409 --> 00:05:42,030
<font color="#CCCCCC">now this is not not rocket science in</font>

123
00:05:39,960 --> 00:05:46,349
the<font color="#E5E5E5"> sense this</font><font color="#CCCCCC"> is something that</font><font color="#E5E5E5"> many</font>

124
00:05:42,030 --> 00:05:47,758
<font color="#CCCCCC">people</font><font color="#E5E5E5"> have done</font><font color="#CCCCCC"> before and there</font><font color="#E5E5E5"> are</font>

125
00:05:46,349 --> 00:05:49,050
<font color="#CCCCCC">even</font><font color="#E5E5E5"> people who have probably other</font>

126
00:05:47,759 --> 00:05:52,979
<font color="#E5E5E5">people who have done it at the high</font>

127
00:05:49,050 --> 00:05:54,690
speeds we are<font color="#E5E5E5"> what the secret sauce if</font>

128
00:05:52,979 --> 00:06:00,090
you<font color="#CCCCCC"> will or makes this special is that</font>

129
00:05:54,690 --> 00:06:02,190
we<font color="#CCCCCC"> are</font><font color="#E5E5E5"> trying to get high speeds high</font>

130
00:06:00,090 --> 00:06:04,380
<font color="#E5E5E5">efficiency or high speeds out</font><font color="#CCCCCC"> of our</font>

131
00:06:02,190 --> 00:06:06,210
systems with<font color="#CCCCCC"> high efficiency</font><font color="#E5E5E5"> so we want</font>

132
00:06:04,380 --> 00:06:09,120
to not only<font color="#CCCCCC"> deliver a great experience</font>

133
00:06:06,210 --> 00:06:14,310
<font color="#CCCCCC">to our</font><font color="#E5E5E5"> end users</font><font color="#CCCCCC"> we also want to control</font>

134
00:06:09,120 --> 00:06:17,610
<font color="#E5E5E5">the costs and so we we</font><font color="#CCCCCC"> actually work</font>

135
00:06:14,310 --> 00:06:20,940
very<font color="#CCCCCC"> hard to optimize our workload so</font>

136
00:06:17,610 --> 00:06:24,449
that it can fit into relatively

137
00:06:20,940 --> 00:06:27,750
inexpensive parts<font color="#E5E5E5"> that you could go buy</font>

138
00:06:24,449 --> 00:06:30,630
off the<font color="#CCCCCC"> by off</font><font color="#E5E5E5"> the street</font><font color="#CCCCCC"> there's almost</font>

139
00:06:27,750 --> 00:06:34,469
nothing<font color="#CCCCCC"> that we use that you couldn't go</font>

140
00:06:30,630 --> 00:06:36,509
buy from<font color="#E5E5E5"> someone if you wanted to we</font>

141
00:06:34,469 --> 00:06:40,770
don't have custom Asics and things like

142
00:06:36,509 --> 00:06:42,870
<font color="#E5E5E5">that</font><font color="#CCCCCC"> floating around and so the</font><font color="#E5E5E5"> the</font>

143
00:06:40,770 --> 00:06:44,010
<font color="#E5E5E5">secret sauce if you will is simply</font><font color="#CCCCCC"> being</font>

144
00:06:42,870 --> 00:06:46,560
able<font color="#E5E5E5"> to</font>

145
00:06:44,010 --> 00:06:50,070
get things get things through<font color="#E5E5E5"> this</font>

146
00:06:46,560 --> 00:06:50,820
system<font color="#CCCCCC"> as fast</font><font color="#E5E5E5"> as possible as cheaply as</font>

147
00:06:50,070 --> 00:06:52,950
possible

148
00:06:50,820 --> 00:06:54,510
<font color="#E5E5E5">and you'll see that there's a couple of</font>

149
00:06:52,950 --> 00:06:58,890
resource constraints we have<font color="#CCCCCC"> the first</font>

150
00:06:54,510 --> 00:07:01,409
<font color="#CCCCCC">one is the the disk</font><font color="#E5E5E5"> i/o and the network</font>

151
00:06:58,890 --> 00:07:04,080
i/o<font color="#E5E5E5"> all has to go over</font><font color="#CCCCCC"> PCI 8</font><font color="#E5E5E5"> all over</font>

152
00:07:01,410 --> 00:07:06,510
<font color="#E5E5E5">PCIe</font><font color="#CCCCCC"> and so we have</font><font color="#E5E5E5"> we're constrained to</font>

153
00:07:04,080 --> 00:07:08,159
the number of PCI lanes we have we're

154
00:07:06,510 --> 00:07:11,460
also constrained in the bandwidth those

155
00:07:08,160 --> 00:07:15,780
PCI lanes have<font color="#E5E5E5"> and then all the data</font>

156
00:07:11,460 --> 00:07:17,400
<font color="#E5E5E5">coming in and out of memory</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> we're</font>

157
00:07:15,780 --> 00:07:18,989
constrained by the number of<font color="#E5E5E5"> memory</font>

158
00:07:17,400 --> 00:07:21,469
controllers we have number<font color="#E5E5E5"> of memory</font>

159
00:07:18,990 --> 00:07:25,380
<font color="#CCCCCC">channels as well as the speed of those</font>

160
00:07:21,470 --> 00:07:26,730
<font color="#E5E5E5">the memory</font><font color="#CCCCCC"> so those are the two main</font>

161
00:07:25,380 --> 00:07:29,640
resource constraints that<font color="#E5E5E5"> we fight</font>

162
00:07:26,730 --> 00:07:34,020
against<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can either buy your way</font>

163
00:07:29,640 --> 00:07:39,320
out<font color="#CCCCCC"> of that</font><font color="#E5E5E5"> by buying bigger CPUs or you</font>

164
00:07:34,020 --> 00:07:42,780
can try<font color="#E5E5E5"> to make things more efficient by</font>

165
00:07:39,320 --> 00:07:44,880
utilizing the resources you have more

166
00:07:42,780 --> 00:07:49,010
more efficiently<font color="#E5E5E5"> more intelligently</font><font color="#CCCCCC"> and</font>

167
00:07:44,880 --> 00:07:49,010
we try<font color="#E5E5E5"> to focus on the latter</font>

168
00:07:50,270 --> 00:07:56,430
so using<font color="#E5E5E5"> FreeBSD and commodity parts we</font>

169
00:07:53,910 --> 00:07:59,520
<font color="#E5E5E5">have we get 90 gigabits per second</font>

170
00:07:56,430 --> 00:08:01,260
<font color="#E5E5E5">steady state out of our latest hundred</font>

171
00:07:59,520 --> 00:08:02,250
gig storage appliance actually I<font color="#E5E5E5"> think</font>

172
00:08:01,260 --> 00:08:05,480
<font color="#E5E5E5">all of our hundred gig storage</font>

173
00:08:02,250 --> 00:08:07,800
appliances at this point the latest one

174
00:08:05,480 --> 00:08:14,640
we're using<font color="#CCCCCC"> fifty-five</font><font color="#E5E5E5"> percent</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

175
00:08:07,800 --> 00:08:16,080
CPU<font color="#E5E5E5"> on a 16 core 2.6 eager Hertz CPU</font><font color="#CCCCCC"> for</font>

176
00:08:14,640 --> 00:08:19,289
<font color="#E5E5E5">those that are interested it's an Intel</font>

177
00:08:16,080 --> 00:08:21,390
Xeon<font color="#E5E5E5"> 6122 CPU</font>

178
00:08:19,290 --> 00:08:24,120
there's 16 terabytes<font color="#E5E5E5"> nvme in this</font>

179
00:08:21,390 --> 00:08:27,450
appliance<font color="#E5E5E5"> and 96</font><font color="#CCCCCC"> C bytes of RAM in a</font><font color="#E5E5E5"> 1</font>

180
00:08:24,120 --> 00:08:28,950
<font color="#E5E5E5">ru form factor</font><font color="#CCCCCC"> 90 gigabits</font><font color="#E5E5E5"> the reason</font>

181
00:08:27,450 --> 00:08:30,719
I'm quoting the<font color="#CCCCCC"> new gigabits per second</font>

182
00:08:28,950 --> 00:08:34,799
number<font color="#E5E5E5"> is because that's what we we</font>

183
00:08:30,720 --> 00:08:38,220
shoot for in production we we aim<font color="#CCCCCC"> to use</font>

184
00:08:34,799 --> 00:08:42,598
<font color="#E5E5E5">90%</font><font color="#CCCCCC"> of the attachment speed the reason</font>

185
00:08:38,220 --> 00:08:44,070
we aim for<font color="#E5E5E5"> 90% is we do have a searing</font>

186
00:08:42,599 --> 00:08:47,670
system the<font color="#E5E5E5"> tri-state clients to the</font>

187
00:08:44,070 --> 00:08:49,710
correct caches and if you target<font color="#E5E5E5"> 90% you</font>

188
00:08:47,670 --> 00:08:51,810
can do that<font color="#E5E5E5"> pretty reliably if you go</font>

189
00:08:49,710 --> 00:08:54,030
above<font color="#CCCCCC"> that it gets a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> harder to do</font>

190
00:08:51,810 --> 00:08:56,250
the<font color="#E5E5E5"> control loop correctly on top of</font>

191
00:08:54,030 --> 00:08:57,360
that we<font color="#E5E5E5"> need some Headroom in case there</font>

192
00:08:56,250 --> 00:08:59,519
are failures in the system

193
00:08:57,360 --> 00:09:00,929
so if a<font color="#E5E5E5"> Content cache fails the clients</font>

194
00:08:59,519 --> 00:09:02,309
need<font color="#CCCCCC"> someplace</font><font color="#E5E5E5"> else to go to and</font><font color="#CCCCCC"> so we</font>

195
00:09:00,929 --> 00:09:05,069
<font color="#CCCCCC">need a</font><font color="#E5E5E5"> little bit of spare capacity in</font>

196
00:09:02,309 --> 00:09:07,350
<font color="#E5E5E5">the</font><font color="#CCCCCC"> system</font><font color="#E5E5E5"> and the 10% gives us just a</font>

197
00:09:05,069 --> 00:09:09,559
little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> - a little</font><font color="#E5E5E5"> bit of headroom to</font>

198
00:09:07,350 --> 00:09:12,720
absorb clients<font color="#CCCCCC"> that are</font><font color="#E5E5E5"> switching away</font>

199
00:09:09,559 --> 00:09:14,730
<font color="#CCCCCC">so we would consider</font><font color="#E5E5E5"> 90 gigabits per</font>

200
00:09:12,720 --> 00:09:16,889
second to be our target<font color="#E5E5E5"> for this</font>

201
00:09:14,730 --> 00:09:20,610
platform<font color="#E5E5E5"> and we can do that with</font><font color="#CCCCCC"> 55%</font>

202
00:09:16,889 --> 00:09:23,129
<font color="#E5E5E5">roughly 55% CPU usage</font><font color="#CCCCCC"> and here's some</font>

203
00:09:20,610 --> 00:09:24,949
graphs that show<font color="#E5E5E5"> that you'll see that</font>

204
00:09:23,129 --> 00:09:27,959
the bandwidth is<font color="#E5E5E5"> hovering right around</font>

205
00:09:24,949 --> 00:09:31,079
90 gigabits per second and the CP

206
00:09:27,959 --> 00:09:34,349
utilizations right around 55<font color="#CCCCCC"> and this is</font>

207
00:09:31,079 --> 00:09:35,638
<font color="#E5E5E5">measured</font><font color="#CCCCCC"> within an actual system serving</font>

208
00:09:34,350 --> 00:09:37,949
production<font color="#E5E5E5"> traffic this</font><font color="#CCCCCC"> is not a</font>

209
00:09:35,639 --> 00:09:43,499
synthetic benchmark<font color="#E5E5E5"> this is what we get</font>

210
00:09:37,949 --> 00:09:45,359
in production so let's<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about the</font>

211
00:09:43,499 --> 00:09:48,869
operating<font color="#E5E5E5"> system</font><font color="#CCCCCC"> that runs on these</font>

212
00:09:45,360 --> 00:09:51,509
caches<font color="#CCCCCC"> it's a as I said it's a</font><font color="#E5E5E5"> lightly</font>

213
00:09:48,869 --> 00:09:52,889
modified<font color="#E5E5E5"> version of FreeBSD for those of</font>

214
00:09:51,509 --> 00:09:57,480
you that<font color="#E5E5E5"> are not familiar with FreeBSD</font>

215
00:09:52,889 --> 00:10:02,309
here's the<font color="#E5E5E5"> 30 second introduction AT&T</font>

216
00:09:57,480 --> 00:10:03,989
had a UNIX distribution<font color="#E5E5E5"> they the</font>

217
00:10:02,309 --> 00:10:08,160
University of<font color="#CCCCCC"> california-berkeley got a</font>

218
00:10:03,989 --> 00:10:09,509
license<font color="#E5E5E5"> to</font><font color="#CCCCCC"> use that distribution they</font>

219
00:10:08,160 --> 00:10:13,350
created what<font color="#CCCCCC"> they called the</font><font color="#E5E5E5"> Berkeley</font>

220
00:10:09,509 --> 00:10:16,079
<font color="#E5E5E5">software distribution and there's a lot</font>

221
00:10:13,350 --> 00:10:19,019
<font color="#E5E5E5">that I'm skipping</font><font color="#CCCCCC"> over but essentially</font>

222
00:10:16,079 --> 00:10:23,910
FreeBSD<font color="#E5E5E5"> and</font><font color="#CCCCCC"> net bsd</font><font color="#E5E5E5"> are both descendants</font>

223
00:10:19,019 --> 00:10:25,739
of that<font color="#CCCCCC"> codebase</font><font color="#E5E5E5"> and the other there's</font>

224
00:10:23,910 --> 00:10:28,110
lots of other bsd distributions<font color="#CCCCCC"> i'm not</font>

225
00:10:25,739 --> 00:10:31,199
trying to<font color="#E5E5E5"> cover them exhaustively but</font>

226
00:10:28,110 --> 00:10:34,079
this is where freebsd came from<font color="#CCCCCC"> it's not</font>

227
00:10:31,199 --> 00:10:37,859
a<font color="#E5E5E5"> linux distribution</font><font color="#CCCCCC"> it's not it's not</font>

228
00:10:34,079 --> 00:10:39,959
<font color="#E5E5E5">really</font><font color="#CCCCCC"> related to linux</font><font color="#E5E5E5"> other than the</font>

229
00:10:37,860 --> 00:10:41,759
fact that<font color="#CCCCCC"> linux and unix</font><font color="#E5E5E5"> look similar</font><font color="#CCCCCC"> in</font>

230
00:10:39,959 --> 00:10:43,319
a<font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> ways</font>

231
00:10:41,759 --> 00:10:48,209
more or<font color="#E5E5E5"> less depending on who you ask</font>

232
00:10:43,319 --> 00:10:52,049
probably<font color="#E5E5E5"> the other thing is that freebsd</font>

233
00:10:48,209 --> 00:10:54,628
is a complete software system as opposed

234
00:10:52,049 --> 00:10:57,299
to<font color="#E5E5E5"> linux which is a kernel and then the</font>

235
00:10:54,629 --> 00:11:00,329
<font color="#E5E5E5">software distributions turn it into a</font>

236
00:10:57,299 --> 00:11:05,279
full operating system<font color="#CCCCCC"> freebsd is a full</font>

237
00:11:00,329 --> 00:11:07,049
operating<font color="#E5E5E5"> system</font><font color="#CCCCCC"> so the</font><font color="#E5E5E5"> freebsd release</font>

238
00:11:05,279 --> 00:11:08,699
cycle<font color="#E5E5E5"> looks</font><font color="#CCCCCC"> probably like your typical</font>

239
00:11:07,049 --> 00:11:09,910
software<font color="#E5E5E5"> release cycle for an</font><font color="#CCCCCC"> open</font>

240
00:11:08,699 --> 00:11:12,370
<font color="#E5E5E5">source project</font>

241
00:11:09,910 --> 00:11:14,260
<font color="#E5E5E5">there there is a head branch which</font><font color="#CCCCCC"> is</font>

242
00:11:12,370 --> 00:11:16,720
<font color="#E5E5E5">the development branch that's where new</font>

243
00:11:14,260 --> 00:11:19,750
features and bug fixes<font color="#CCCCCC"> go first</font><font color="#E5E5E5"> and then</font>

244
00:11:16,720 --> 00:11:21,100
there are<font color="#E5E5E5"> these release branches that</font>

245
00:11:19,750 --> 00:11:23,950
come<font color="#E5E5E5"> off of</font><font color="#CCCCCC"> that every once in a</font><font color="#E5E5E5"> while</font>

246
00:11:21,100 --> 00:11:26,890
<font color="#CCCCCC">and the release</font><font color="#E5E5E5"> branch is called the</font>

247
00:11:23,950 --> 00:11:29,470
stable branch<font color="#CCCCCC"> so for instance there was</font>

248
00:11:26,890 --> 00:11:32,830
a stable<font color="#E5E5E5"> 11 branch about</font><font color="#CCCCCC"> two years ago I</font>

249
00:11:29,470 --> 00:11:36,940
<font color="#E5E5E5">believe which is</font><font color="#CCCCCC"> the branch that</font><font color="#E5E5E5"> all of</font>

250
00:11:32,830 --> 00:11:40,270
the 11.0 men dot<font color="#E5E5E5"> X releases come off of</font>

251
00:11:36,940 --> 00:11:43,420
so<font color="#CCCCCC"> all</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> eleven</font><font color="#E5E5E5"> minor all of the</font>

252
00:11:40,270 --> 00:11:45,100
<font color="#E5E5E5">releases</font><font color="#CCCCCC"> that are</font><font color="#E5E5E5"> part of the</font><font color="#CCCCCC"> eleven</font>

253
00:11:43,420 --> 00:11:47,589
<font color="#E5E5E5">major release all the minor releases</font>

254
00:11:45,100 --> 00:11:49,450
<font color="#E5E5E5">come off of that release branch</font><font color="#CCCCCC"> likewise</font>

255
00:11:47,590 --> 00:11:52,390
the<font color="#E5E5E5"> recently was a stable twelve branch</font>

256
00:11:49,450 --> 00:11:55,330
that<font color="#E5E5E5"> was created over</font><font color="#CCCCCC"> time of course the</font>

257
00:11:52,390 --> 00:11:56,650
code diverges as you'd expect<font color="#CCCCCC"> with you</font>

258
00:11:55,330 --> 00:11:59,500
know a software development model like

259
00:11:56,650 --> 00:12:01,360
this<font color="#E5E5E5"> and the new features go into head</font>

260
00:11:59,500 --> 00:12:05,380
and not all<font color="#CCCCCC"> of</font><font color="#E5E5E5"> them are back ported</font>

261
00:12:01,360 --> 00:12:08,860
depending on just<font color="#E5E5E5"> how stable they are so</font>

262
00:12:05,380 --> 00:12:10,420
a while ago<font color="#CCCCCC"> when I first</font><font color="#E5E5E5"> joined Netflix</font>

263
00:12:08,860 --> 00:12:13,530
it was right around the time that<font color="#CCCCCC"> we</font>

264
00:12:10,420 --> 00:12:16,390
were running<font color="#E5E5E5"> stable</font><font color="#CCCCCC"> ten</font><font color="#E5E5E5"> which was the</font>

265
00:12:13,530 --> 00:12:20,319
<font color="#E5E5E5">the major release before stable</font><font color="#CCCCCC"> eleven</font>

266
00:12:16,390 --> 00:12:23,050
<font color="#CCCCCC">so we were our operating</font><font color="#E5E5E5"> system was</font>

267
00:12:20,320 --> 00:12:25,870
based on stable<font color="#CCCCCC"> ten and we had a choice</font>

268
00:12:23,050 --> 00:12:27,609
when stable<font color="#CCCCCC"> eleven was</font><font color="#E5E5E5"> released we could</font>

269
00:12:25,870 --> 00:12:30,700
stay on<font color="#E5E5E5"> stable</font><font color="#CCCCCC"> ten and get</font><font color="#E5E5E5"> farther</font>

270
00:12:27,610 --> 00:12:34,720
behind<font color="#E5E5E5"> or we could switch</font><font color="#CCCCCC"> to stable</font>

271
00:12:30,700 --> 00:12:38,620
eleven or head and we decided to rebase

272
00:12:34,720 --> 00:12:41,080
our code on<font color="#CCCCCC"> to stable eleven or pet and</font>

273
00:12:38,620 --> 00:12:42,970
then we had the choice<font color="#E5E5E5"> well it basically</font>

274
00:12:41,080 --> 00:12:44,320
<font color="#E5E5E5">stable</font><font color="#CCCCCC"> eleven and head or the same</font><font color="#E5E5E5"> thing</font>

275
00:12:42,970 --> 00:12:46,150
at<font color="#E5E5E5"> this point because it's just branched</font>

276
00:12:44,320 --> 00:12:48,940
<font color="#E5E5E5">so which do we want to do we</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> to go</font>

277
00:12:46,150 --> 00:12:51,730
<font color="#E5E5E5">to the next</font><font color="#CCCCCC"> stable release or do we</font><font color="#E5E5E5"> want</font>

278
00:12:48,940 --> 00:12:53,140
to<font color="#E5E5E5"> track head and we decided</font><font color="#CCCCCC"> to track</font>

279
00:12:51,730 --> 00:12:54,700
the development<font color="#E5E5E5"> branch and so</font><font color="#CCCCCC"> weary</font>

280
00:12:53,140 --> 00:12:58,360
based<font color="#E5E5E5"> on to the development branch and</font>

281
00:12:54,700 --> 00:13:01,180
we began<font color="#CCCCCC"> to track that</font><font color="#E5E5E5"> and we did that</font>

282
00:12:58,360 --> 00:13:03,420
<font color="#CCCCCC">for</font><font color="#E5E5E5"> about two years and then stable</font>

283
00:13:01,180 --> 00:13:08,050
<font color="#E5E5E5">twelve came along and we had a choice</font>

284
00:13:03,420 --> 00:13:09,880
<font color="#CCCCCC">valo stable 12</font><font color="#E5E5E5"> or stay on</font><font color="#CCCCCC"> head</font><font color="#E5E5E5"> and there</font>

285
00:13:08,050 --> 00:13:11,650
was essentially no<font color="#E5E5E5"> discussion or debate</font>

286
00:13:09,880 --> 00:13:14,740
everyone loved tracking head so much

287
00:13:11,650 --> 00:13:17,520
that we've continued<font color="#CCCCCC"> to do that so it's</font>

288
00:13:14,740 --> 00:13:17,520
worked<font color="#E5E5E5"> really well for</font><font color="#CCCCCC"> us</font>

289
00:13:20,220 --> 00:13:24,040
this is sort<font color="#E5E5E5"> of what the code</font>

290
00:13:22,420 --> 00:13:28,030
inheritance looks like for<font color="#E5E5E5"> those of you</font>

291
00:13:24,040 --> 00:13:30,430
that<font color="#E5E5E5"> proposed</font><font color="#CCCCCC"> me that need this mental</font>

292
00:13:28,030 --> 00:13:32,709
model or appreciate the mental model<font color="#E5E5E5"> so</font>

293
00:13:30,430 --> 00:13:34,890
<font color="#CCCCCC">FreeBSD heads</font><font color="#E5E5E5"> code</font><font color="#CCCCCC"> bases at the top we</font>

294
00:13:32,710 --> 00:13:38,260
have<font color="#CCCCCC"> our internal master branch</font><font color="#E5E5E5"> and</font>

295
00:13:34,890 --> 00:13:40,949
about every five weeks<font color="#E5E5E5"> we take a</font><font color="#CCCCCC"> sync</font>

296
00:13:38,260 --> 00:13:43,510
from head to our internal master branch

297
00:13:40,950 --> 00:13:45,640
<font color="#CCCCCC">we</font><font color="#E5E5E5"> develop some more code and then we</font>

298
00:13:43,510 --> 00:13:47,410
branch off our release branches<font color="#E5E5E5"> and we</font>

299
00:13:45,640 --> 00:13:50,920
shoot to<font color="#E5E5E5"> have a release just about once</font>

300
00:13:47,410 --> 00:13:53,850
every<font color="#E5E5E5"> five weeks our typical release</font>

301
00:13:50,920 --> 00:13:59,290
cycle<font color="#E5E5E5"> is five weeks of development</font>

302
00:13:53,850 --> 00:14:01,150
<font color="#E5E5E5">followed by five weeks of testing</font><font color="#CCCCCC"> the</font>

303
00:13:59,290 --> 00:14:03,459
five weeks of so there's two releases

304
00:14:01,150 --> 00:14:04,900
<font color="#E5E5E5">included in a given</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> one in</font>

305
00:14:03,460 --> 00:14:08,260
development one in testing and

306
00:14:04,900 --> 00:14:10,209
deployment<font color="#E5E5E5"> we start off with a freebie</font>

307
00:14:08,260 --> 00:14:14,170
<font color="#E5E5E5">emerge from FreeBSD head close to the</font>

308
00:14:10,210 --> 00:14:16,180
start of<font color="#E5E5E5"> the development process</font><font color="#CCCCCC"> then we</font>

309
00:14:14,170 --> 00:14:17,709
also<font color="#E5E5E5"> throughout</font><font color="#CCCCCC"> the five weeks for</font><font color="#E5E5E5"> doing</font>

310
00:14:16,180 --> 00:14:20,500
feature<font color="#CCCCCC"> development and integrating our</font>

311
00:14:17,710 --> 00:14:21,790
features into the<font color="#CCCCCC"> master</font><font color="#E5E5E5"> branch with</font><font color="#CCCCCC"> the</font>

312
00:14:20,500 --> 00:14:23,740
other features that<font color="#E5E5E5"> have</font><font color="#CCCCCC"> been developed</font>

313
00:14:21,790 --> 00:14:26,610
and of course we're<font color="#CCCCCC"> doing continual</font>

314
00:14:23,740 --> 00:14:30,340
testing<font color="#E5E5E5"> throughout the five weeks at</font>

315
00:14:26,610 --> 00:14:35,290
right at the<font color="#E5E5E5"> five week mark we we make</font>

316
00:14:30,340 --> 00:14:38,050
our release branch<font color="#E5E5E5"> and then we begin</font><font color="#CCCCCC"> the</font>

317
00:14:35,290 --> 00:14:40,780
process of doing further testing further

318
00:14:38,050 --> 00:14:43,359
intensive testing on<font color="#CCCCCC"> that release before</font>

319
00:14:40,780 --> 00:14:44,920
<font color="#E5E5E5">we deploy</font><font color="#CCCCCC"> it more widely so at this</font>

320
00:14:43,360 --> 00:14:48,250
<font color="#E5E5E5">stage we would be running this release</font>

321
00:14:44,920 --> 00:14:50,589
on approximately<font color="#E5E5E5"> what we'd be</font><font color="#CCCCCC"> using</font>

322
00:14:48,250 --> 00:14:53,920
approximately<font color="#CCCCCC"> 45 caches to test this</font>

323
00:14:50,590 --> 00:14:55,810
release<font color="#E5E5E5"> with a mixture of representative</font>

324
00:14:53,920 --> 00:14:58,959
<font color="#E5E5E5">hardware from</font><font color="#CCCCCC"> the different kinds</font><font color="#E5E5E5"> of</font>

325
00:14:55,810 --> 00:15:00,010
<font color="#E5E5E5">hardware that</font><font color="#CCCCCC"> we support half of</font><font color="#E5E5E5"> those</font>

326
00:14:58,960 --> 00:15:01,540
caches would be<font color="#E5E5E5"> running the old</font>

327
00:15:00,010 --> 00:15:03,670
operating<font color="#E5E5E5"> system half the new operating</font>

328
00:15:01,540 --> 00:15:06,339
system and we<font color="#E5E5E5"> would do a very close</font>

329
00:15:03,670 --> 00:15:08,800
comparison of the<font color="#CCCCCC"> performance of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> old</font>

330
00:15:06,340 --> 00:15:12,130
operating<font color="#E5E5E5"> system versus the new one</font><font color="#CCCCCC"> and</font>

331
00:15:08,800 --> 00:15:14,469
<font color="#E5E5E5">so we look at obvious things like panics</font>

332
00:15:12,130 --> 00:15:17,740
and crashes and<font color="#E5E5E5"> so forth</font><font color="#CCCCCC"> but we also</font>

333
00:15:14,470 --> 00:15:20,560
look at the metrics of<font color="#E5E5E5"> how</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> system is</font>

334
00:15:17,740 --> 00:15:24,190
<font color="#E5E5E5">performing</font><font color="#CCCCCC"> it has the CPU utilization</font>

335
00:15:20,560 --> 00:15:26,170
gone up or down<font color="#E5E5E5"> are we</font><font color="#CCCCCC"> able to</font><font color="#E5E5E5"> push out</font>

336
00:15:24,190 --> 00:15:28,510
<font color="#CCCCCC">the</font><font color="#E5E5E5"> end with as fast or able to push up</font>

337
00:15:26,170 --> 00:15:32,319
bits as fast<font color="#E5E5E5"> have TCP retransmissions</font>

338
00:15:28,510 --> 00:15:33,069
changed noticeably<font color="#E5E5E5"> we look at has power</font>

339
00:15:32,320 --> 00:15:36,520
usage<font color="#CCCCCC"> changed</font>

340
00:15:33,070 --> 00:15:38,170
noticeably<font color="#E5E5E5"> so we look at all of</font><font color="#CCCCCC"> the</font>

341
00:15:36,520 --> 00:15:40,230
metrics<font color="#E5E5E5"> you and probably think</font><font color="#CCCCCC"> that we</font>

342
00:15:38,170 --> 00:15:44,229
look at<font color="#E5E5E5"> and maybe even a</font><font color="#CCCCCC"> few more</font>

343
00:15:40,230 --> 00:15:45,970
regarding the the<font color="#E5E5E5"> system itself</font><font color="#CCCCCC"> we also</font>

344
00:15:44,230 --> 00:15:47,530
<font color="#CCCCCC">look at</font><font color="#E5E5E5"> the metrics the clients give us</font>

345
00:15:45,970 --> 00:15:48,640
<font color="#E5E5E5">so</font><font color="#CCCCCC"> where we the clients can</font><font color="#E5E5E5"> tell us</font>

346
00:15:47,530 --> 00:15:51,459
whether or<font color="#E5E5E5"> not they</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> this new</font>

347
00:15:48,640 --> 00:15:53,319
<font color="#E5E5E5">software and if the clients tell us that</font>

348
00:15:51,460 --> 00:15:56,230
<font color="#CCCCCC">they're experienced getting</font><font color="#E5E5E5"> data from</font>

349
00:15:53,320 --> 00:15:58,590
<font color="#E5E5E5">the</font><font color="#CCCCCC"> new the soft the castrating the new</font>

350
00:15:56,230 --> 00:16:01,030
<font color="#E5E5E5">software is as good as the experience</font>

351
00:15:58,590 --> 00:16:03,250
<font color="#E5E5E5">use it from the</font><font color="#CCCCCC"> cache</font><font color="#E5E5E5"> run in the old</font>

352
00:16:01,030 --> 00:16:05,890
software<font color="#CCCCCC"> that's a</font><font color="#E5E5E5"> pretty good indication</font>

353
00:16:03,250 --> 00:16:07,090
that<font color="#CCCCCC"> we haven't messed anything up and</font>

354
00:16:05,890 --> 00:16:12,189
<font color="#CCCCCC">if their experience is even better</font>

355
00:16:07,090 --> 00:16:14,470
that's great after we do our<font color="#E5E5E5"> dev testing</font>

356
00:16:12,190 --> 00:16:17,650
that we fixed whatever bugs we find it

357
00:16:14,470 --> 00:16:19,510
moves on to a canary<font color="#E5E5E5"> testing so</font><font color="#CCCCCC"> we've</font>

358
00:16:17,650 --> 00:16:22,270
deployed at this point to a much<font color="#CCCCCC"> larger</font>

359
00:16:19,510 --> 00:16:24,040
set of caches<font color="#E5E5E5"> so many more clients</font><font color="#CCCCCC"> are</font>

360
00:16:22,270 --> 00:16:26,470
hitting this and we can again do the

361
00:16:24,040 --> 00:16:28,689
comparison to see if things<font color="#E5E5E5"> have gotten</font>

362
00:16:26,470 --> 00:16:30,130
<font color="#CCCCCC">better or worse or</font><font color="#E5E5E5"> stay at about the</font>

363
00:16:28,690 --> 00:16:32,980
<font color="#E5E5E5">same and make sure that matches our</font>

364
00:16:30,130 --> 00:16:37,240
expectations<font color="#CCCCCC"> and then finally we go</font>

365
00:16:32,980 --> 00:16:40,480
through about<font color="#E5E5E5"> two weeks of deployment</font><font color="#CCCCCC"> in</font>

366
00:16:37,240 --> 00:16:42,850
an emergency<font color="#CCCCCC"> which does happen</font>

367
00:16:40,480 --> 00:16:44,380
periodically<font color="#E5E5E5"> so for example a security</font>

368
00:16:42,850 --> 00:16:47,170
vulnerability<font color="#CCCCCC"> or something like</font><font color="#E5E5E5"> that</font>

369
00:16:44,380 --> 00:16:50,800
we can speed up<font color="#E5E5E5"> this process very</font>

370
00:16:47,170 --> 00:16:53,770
<font color="#CCCCCC">greatly but</font><font color="#E5E5E5"> if we have the time to do</font>

371
00:16:50,800 --> 00:16:56,439
this sort of this<font color="#CCCCCC"> sort of process we</font>

372
00:16:53,770 --> 00:16:59,020
much prefer<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> slow and</font><font color="#E5E5E5"> methodical</font>

373
00:16:56,440 --> 00:17:03,940
<font color="#E5E5E5">then than rushed but if we need to</font><font color="#CCCCCC"> we</font>

374
00:16:59,020 --> 00:17:05,439
<font color="#CCCCCC">can rush out fixes in a hurry</font><font color="#E5E5E5"> so one of</font>

375
00:17:03,940 --> 00:17:06,760
the questions<font color="#CCCCCC"> you might be</font><font color="#E5E5E5"> asking is</font>

376
00:17:05,439 --> 00:17:10,959
well just what<font color="#E5E5E5"> kind of features do you</font>

377
00:17:06,760 --> 00:17:13,599
<font color="#E5E5E5">need to develop and the features that we</font>

378
00:17:10,959 --> 00:17:15,430
develop are basically aimed at one<font color="#E5E5E5"> of</font>

379
00:17:13,599 --> 00:17:19,419
two<font color="#E5E5E5"> things the first</font><font color="#CCCCCC"> one is making</font><font color="#E5E5E5"> our</font>

380
00:17:15,430 --> 00:17:21,100
customer experience better<font color="#E5E5E5"> or making the</font>

381
00:17:19,420 --> 00:17:23,170
OCS run more efficiently thereby

382
00:17:21,099 --> 00:17:26,948
lowering<font color="#E5E5E5"> our costs and we want to do one</font>

383
00:17:23,170 --> 00:17:30,070
<font color="#CCCCCC">of those</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> those two things</font><font color="#CCCCCC"> ideally</font>

384
00:17:26,949 --> 00:17:33,460
we want<font color="#E5E5E5"> to do both at the</font><font color="#CCCCCC"> same time but</font>

385
00:17:30,070 --> 00:17:36,580
<font color="#E5E5E5">we try we</font><font color="#CCCCCC"> try very very very hard not</font><font color="#E5E5E5"> to</font>

386
00:17:33,460 --> 00:17:39,400
sacrifice<font color="#E5E5E5"> customer performance in order</font>

387
00:17:36,580 --> 00:17:42,520
<font color="#E5E5E5">to save money</font><font color="#CCCCCC"> so we try</font><font color="#E5E5E5"> to do both at</font>

388
00:17:39,400 --> 00:17:44,440
the<font color="#E5E5E5"> same</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> and there are things we</font>

389
00:17:42,520 --> 00:17:45,639
can do<font color="#E5E5E5"> as software developers to make</font>

390
00:17:44,440 --> 00:17:49,870
the customer exterior

391
00:17:45,640 --> 00:17:52,210
it's better so for example<font color="#E5E5E5"> getting bites</font>

392
00:17:49,870 --> 00:17:53,709
off the<font color="#CCCCCC"> disk faster is something that</font>

393
00:17:52,210 --> 00:17:55,150
can help the customer experience because

394
00:17:53,710 --> 00:17:58,690
<font color="#E5E5E5">their video starts playing that much</font>

395
00:17:55,150 --> 00:18:00,130
faster<font color="#CCCCCC"> and there are</font><font color="#E5E5E5"> things we can do as</font>

396
00:17:58,690 --> 00:18:03,070
software developers<font color="#CCCCCC"> that</font><font color="#E5E5E5"> will make that</font>

397
00:18:00,130 --> 00:18:05,050
better<font color="#E5E5E5"> better or worse but here's some</font>

398
00:18:03,070 --> 00:18:06,929
examples<font color="#E5E5E5"> of</font><font color="#CCCCCC"> some</font><font color="#E5E5E5"> features</font><font color="#CCCCCC"> that either</font>

399
00:18:05,050 --> 00:18:08,560
we've developed internally or sponsored

400
00:18:06,930 --> 00:18:11,850
in the community

401
00:18:08,560 --> 00:18:13,870
the first one is Numa enhancements

402
00:18:11,850 --> 00:18:18,399
<font color="#CCCCCC">freebsd has had numerous</font><font color="#E5E5E5"> support for</font>

403
00:18:13,870 --> 00:18:21,699
many years<font color="#E5E5E5"> but it hasn't it hasn't</font>

404
00:18:18,400 --> 00:18:24,550
<font color="#E5E5E5">worked</font><font color="#CCCCCC"> for our</font><font color="#E5E5E5"> particular workflow</font><font color="#CCCCCC"> very</font>

405
00:18:21,700 --> 00:18:28,420
well we've tried<font color="#E5E5E5"> it so or at least it</font>

406
00:18:24,550 --> 00:18:31,149
didn't several<font color="#E5E5E5"> years ago so</font><font color="#CCCCCC"> we've we've</font>

407
00:18:28,420 --> 00:18:34,270
explored<font color="#E5E5E5"> adding or we've been</font><font color="#CCCCCC"> adding</font>

408
00:18:31,150 --> 00:18:36,340
some enhancements to it to make<font color="#E5E5E5"> it work</font>

409
00:18:34,270 --> 00:18:43,030
better for<font color="#E5E5E5"> everyone</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> also</font>

410
00:18:36,340 --> 00:18:45,520
<font color="#E5E5E5">particularly for our</font><font color="#CCCCCC"> workflow the next -</font>

411
00:18:43,030 --> 00:18:49,060
a synchronous send file<font color="#E5E5E5"> and Colonel TLS</font>

412
00:18:45,520 --> 00:18:51,639
<font color="#E5E5E5">are things that enable us to</font><font color="#CCCCCC"> get higher</font>

413
00:18:49,060 --> 00:18:54,280
speed higher efficiency<font color="#E5E5E5"> through the box</font>

414
00:18:51,640 --> 00:18:55,450
by avoiding<font color="#E5E5E5"> copy a bunch of context</font>

415
00:18:54,280 --> 00:18:57,639
switches and<font color="#E5E5E5"> copying data between</font>

416
00:18:55,450 --> 00:18:59,860
<font color="#CCCCCC">colonel</font><font color="#E5E5E5"> and user space I think other</font>

417
00:18:57,640 --> 00:19:01,420
people are probably<font color="#E5E5E5"> or some other people</font>

418
00:18:59,860 --> 00:19:04,000
are<font color="#CCCCCC"> probably using</font><font color="#E5E5E5"> DP</font><font color="#CCCCCC"> DK in this space</font>

419
00:19:01,420 --> 00:19:06,810
we aim<font color="#CCCCCC"> to keep as much in the kernel as</font>

420
00:19:04,000 --> 00:19:08,890
we can<font color="#E5E5E5"> and so</font><font color="#CCCCCC"> kernel TLS and</font>

421
00:19:06,810 --> 00:19:11,710
asynchronous<font color="#CCCCCC"> send file are ways that you</font>

422
00:19:08,890 --> 00:19:13,660
can the user space<font color="#E5E5E5"> can tell the colonel</font>

423
00:19:11,710 --> 00:19:15,550
please do this for<font color="#E5E5E5"> me</font><font color="#CCCCCC"> and then the</font>

424
00:19:13,660 --> 00:19:17,350
<font color="#E5E5E5">kernel takes care of it for the user</font>

425
00:19:15,550 --> 00:19:19,030
space<font color="#E5E5E5"> a</font><font color="#CCCCCC"> streaker does send the</font><font color="#E5E5E5"> file you</font>

426
00:19:17,350 --> 00:19:21,429
tell the colonel please send these bytes

427
00:19:19,030 --> 00:19:23,590
from this file over<font color="#CCCCCC"> the</font><font color="#E5E5E5"> socket and it</font>

428
00:19:21,430 --> 00:19:28,240
will just do that<font color="#E5E5E5"> and it'll only really</font>

429
00:19:23,590 --> 00:19:31,300
tell you if there's a problem<font color="#E5E5E5"> the kernel</font>

430
00:19:28,240 --> 00:19:33,760
TLS you give the kernel<font color="#E5E5E5"> the right</font>

431
00:19:31,300 --> 00:19:35,980
encryption keys then the kernel will go

432
00:19:33,760 --> 00:19:38,620
do the TLS encryption for<font color="#E5E5E5"> you and so you</font>

433
00:19:35,980 --> 00:19:41,380
<font color="#CCCCCC">combine the two together</font><font color="#E5E5E5"> and with one</font>

434
00:19:38,620 --> 00:19:44,560
system call you can send a large<font color="#E5E5E5"> chunk</font>

435
00:19:41,380 --> 00:19:46,570
<font color="#E5E5E5">of a file to a user</font><font color="#CCCCCC"> without the user</font>

436
00:19:44,560 --> 00:19:51,399
space having to make further system

437
00:19:46,570 --> 00:19:53,500
calls or do<font color="#E5E5E5"> more copies</font><font color="#CCCCCC"> the next two</font>

438
00:19:51,400 --> 00:19:55,300
were<font color="#CCCCCC"> PDF allocation enhancements and an</font>

439
00:19:53,500 --> 00:19:57,530
unmapped<font color="#CCCCCC"> em</font><font color="#E5E5E5"> buffs those are both ways</font>

440
00:19:55,300 --> 00:20:01,210
that we gained efficiency

441
00:19:57,530 --> 00:20:05,660
by taking bottlenecks out of the system

442
00:20:01,210 --> 00:20:08,890
the PIPA allocations<font color="#CCCCCC"> P posture the</font>

443
00:20:05,660 --> 00:20:12,260
physical buffers that<font color="#CCCCCC"> handled data on</font>

444
00:20:08,890 --> 00:20:15,140
<font color="#E5E5E5">Hindle or store data when it's coming</font>

445
00:20:12,260 --> 00:20:17,930
off<font color="#CCCCCC"> of the disk</font><font color="#E5E5E5"> so they would be buffers</font>

446
00:20:15,140 --> 00:20:21,230
for disk operations<font color="#E5E5E5"> there was contention</font>

447
00:20:17,930 --> 00:20:26,450
for<font color="#E5E5E5"> a lock which was making the</font>

448
00:20:21,230 --> 00:20:30,440
performance very very<font color="#CCCCCC"> bottleneck</font><font color="#E5E5E5"> and so</font>

449
00:20:26,450 --> 00:20:32,450
we we did some work to rewrite that<font color="#E5E5E5"> and</font>

450
00:20:30,440 --> 00:20:35,450
be able<font color="#E5E5E5"> to get more parallelism during</font>

451
00:20:32,450 --> 00:20:37,250
the<font color="#CCCCCC"> PPF allocation process unmapped m</font>

452
00:20:35,450 --> 00:20:40,640
<font color="#E5E5E5">buffs</font><font color="#CCCCCC"> again it was about</font><font color="#E5E5E5"> taking</font>

453
00:20:37,250 --> 00:20:44,720
<font color="#CCCCCC">bottlenecks out of the system someone on</font>

454
00:20:40,640 --> 00:20:47,540
my team<font color="#CCCCCC"> managed</font><font color="#E5E5E5"> to find a way that we</font>

455
00:20:44,720 --> 00:20:52,250
could take the same<font color="#CCCCCC"> amount of</font><font color="#E5E5E5"> data and</font>

456
00:20:47,540 --> 00:20:54,940
<font color="#CCCCCC">instead of representing it in I think</font>

457
00:20:52,250 --> 00:21:01,700
it's like<font color="#E5E5E5"> 64 Network buffers we can now</font>

458
00:20:54,940 --> 00:21:04,040
represent<font color="#E5E5E5"> it</font><font color="#CCCCCC"> in one</font><font color="#E5E5E5"> network buffer</font><font color="#CCCCCC"> io</font>

459
00:21:01,700 --> 00:21:06,020
scheduling<font color="#E5E5E5"> again we can really make</font><font color="#CCCCCC"> it a</font>

460
00:21:04,040 --> 00:21:08,810
significant impact on<font color="#CCCCCC"> users which we get</font>

461
00:21:06,020 --> 00:21:10,370
data off<font color="#E5E5E5"> the disk at the right time</font><font color="#CCCCCC"> it</font>

462
00:21:08,810 --> 00:21:12,139
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> really matters what when you</font>

463
00:21:10,370 --> 00:21:13,159
read and<font color="#CCCCCC"> write data you don't want to</font>

464
00:21:12,140 --> 00:21:15,380
read<font color="#E5E5E5"> it too</font><font color="#CCCCCC"> early you don't</font><font color="#E5E5E5"> want to</font>

465
00:21:13,160 --> 00:21:17,600
write<font color="#CCCCCC"> it too early you don't want to</font>

466
00:21:15,380 --> 00:21:19,700
read it<font color="#CCCCCC"> or write it too late either so</font>

467
00:21:17,600 --> 00:21:21,439
it really matters and we've done<font color="#E5E5E5"> some</font>

468
00:21:19,700 --> 00:21:23,060
work<font color="#CCCCCC"> to make sure that we are doing IO</font>

469
00:21:21,440 --> 00:21:28,820
at the right time<font color="#CCCCCC"> and doing</font><font color="#E5E5E5"> the right</font>

470
00:21:23,060 --> 00:21:30,710
amount of<font color="#CCCCCC"> i/o</font><font color="#E5E5E5"> and so forth</font><font color="#CCCCCC"> and likewise</font>

471
00:21:28,820 --> 00:21:32,270
<font color="#E5E5E5">the same thing applies to trims and</font>

472
00:21:30,710 --> 00:21:34,340
<font color="#E5E5E5">we've also been doing some</font><font color="#CCCCCC"> work</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> make</font>

473
00:21:32,270 --> 00:21:36,500
sure<font color="#E5E5E5"> we send</font><font color="#CCCCCC"> down the</font><font color="#E5E5E5"> right trims at the</font>

474
00:21:34,340 --> 00:21:38,300
right time and also<font color="#E5E5E5"> at the right pace</font>

475
00:21:36,500 --> 00:21:39,680
<font color="#E5E5E5">because sometimes</font><font color="#CCCCCC"> just drives don't</font>

476
00:21:38,300 --> 00:21:42,350
behave well when you send down<font color="#E5E5E5"> a whole</font>

477
00:21:39,680 --> 00:21:44,420
bunch<font color="#CCCCCC"> of trims all at once and so we</font>

478
00:21:42,350 --> 00:21:47,810
we've<font color="#CCCCCC"> done some work on scheduling</font><font color="#E5E5E5"> those</font>

479
00:21:44,420 --> 00:21:51,920
as well<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> finally we do work in</font>

480
00:21:47,810 --> 00:21:54,560
TCP regularly so there's a whole group

481
00:21:51,920 --> 00:21:58,910
<font color="#E5E5E5">that works just on TCP algorithms and so</font>

482
00:21:54,560 --> 00:22:01,879
forth<font color="#CCCCCC"> we've done a lot of work in both</font>

483
00:21:58,910 --> 00:22:05,900
<font color="#CCCCCC">research and development in algorithms</font>

484
00:22:01,880 --> 00:22:08,570
to get<font color="#E5E5E5"> TCP to transmit</font><font color="#CCCCCC"> data better</font>

485
00:22:05,900 --> 00:22:10,520
<font color="#E5E5E5">where better would mean again sending</font>

486
00:22:08,570 --> 00:22:14,600
the right bits at the<font color="#E5E5E5"> right</font>

487
00:22:10,520 --> 00:22:16,220
for that<font color="#E5E5E5"> for that session and we've also</font>

488
00:22:14,600 --> 00:22:17,689
<font color="#E5E5E5">added some</font><font color="#CCCCCC"> logging and</font><font color="#E5E5E5"> debugging</font>

489
00:22:16,220 --> 00:22:19,430
<font color="#CCCCCC">infrastructures so</font><font color="#E5E5E5"> we can tell</font><font color="#CCCCCC"> just</font>

490
00:22:17,690 --> 00:22:22,580
what's going<font color="#E5E5E5"> on when things don't work</font>

491
00:22:19,430 --> 00:22:24,560
<font color="#CCCCCC">the way we think they should and that's</font>

492
00:22:22,580 --> 00:22:26,300
been very<font color="#CCCCCC"> useful</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> us and</font><font color="#E5E5E5"> developing</font>

493
00:22:24,560 --> 00:22:28,790
these<font color="#E5E5E5"> things</font><font color="#CCCCCC"> and we've shared all this</font>

494
00:22:26,300 --> 00:22:31,159
<font color="#CCCCCC">with the</font><font color="#E5E5E5"> I think</font><font color="#CCCCCC"> we've shared</font><font color="#E5E5E5"> all of</font>

495
00:22:28,790 --> 00:22:33,920
this with<font color="#E5E5E5"> the</font><font color="#CCCCCC"> community at</font><font color="#E5E5E5"> this point so</font>

496
00:22:31,160 --> 00:22:36,170
I think that<font color="#CCCCCC"> just about all of this is</font>

497
00:22:33,920 --> 00:22:39,340
either upstream or is in<font color="#E5E5E5"> the process of</font>

498
00:22:36,170 --> 00:22:39,340
<font color="#CCCCCC">being</font><font color="#E5E5E5"> upstream in some way</font>

499
00:22:40,010 --> 00:22:46,490
tracking head makes it lets us be stay

500
00:22:44,600 --> 00:22:52,300
forward-looking<font color="#E5E5E5"> and stay</font><font color="#CCCCCC"> focused on</font>

501
00:22:46,490 --> 00:22:55,310
innovation<font color="#CCCCCC"> the the</font><font color="#E5E5E5"> problem that</font><font color="#CCCCCC"> you can</font>

502
00:22:52,300 --> 00:22:58,340
run into when you are tracking<font color="#E5E5E5"> the</font>

503
00:22:55,310 --> 00:23:00,889
stable branches<font color="#CCCCCC"> is that you continually</font>

504
00:22:58,340 --> 00:23:02,570
<font color="#CCCCCC">have to</font><font color="#E5E5E5"> deal with</font><font color="#CCCCCC"> the problem of</font><font color="#E5E5E5"> my code</font>

505
00:23:00,890 --> 00:23:05,420
<font color="#E5E5E5">doesn't match what everyone else is</font>

506
00:23:02,570 --> 00:23:08,030
developing<font color="#E5E5E5"> on upstream and so when there</font>

507
00:23:05,420 --> 00:23:09,320
are bug fixes<font color="#CCCCCC"> that occur or new features</font>

508
00:23:08,030 --> 00:23:11,600
<font color="#CCCCCC">that you</font><font color="#E5E5E5"> want you have to</font><font color="#CCCCCC"> figure</font><font color="#E5E5E5"> out how</font>

509
00:23:09,320 --> 00:23:14,419
to<font color="#E5E5E5"> get them back into the code that</font>

510
00:23:11,600 --> 00:23:16,060
you're<font color="#E5E5E5"> actually running likewise when</font>

511
00:23:14,420 --> 00:23:17,990
you<font color="#E5E5E5"> get the new merges from upstream</font>

512
00:23:16,060 --> 00:23:23,659
<font color="#CCCCCC">sometimes you</font><font color="#E5E5E5"> have to redevelop your</font>

513
00:23:17,990 --> 00:23:26,510
features<font color="#CCCCCC"> because the the api's have</font>

514
00:23:23,660 --> 00:23:27,650
changed<font color="#E5E5E5"> or data structures have changed</font>

515
00:23:26,510 --> 00:23:31,340
and<font color="#CCCCCC"> all of a sudden the code you had</font>

516
00:23:27,650 --> 00:23:34,580
doesn't work anymore but by tracking

517
00:23:31,340 --> 00:23:35,659
head<font color="#CCCCCC"> were</font><font color="#E5E5E5"> able to stay very</font><font color="#CCCCCC"> very close</font>

518
00:23:34,580 --> 00:23:38,480
to what's<font color="#CCCCCC"> going on in the upstream</font>

519
00:23:35,660 --> 00:23:40,070
developing community and instead<font color="#E5E5E5"> of</font>

520
00:23:38,480 --> 00:23:42,370
continually redeveloping this stuff

521
00:23:40,070 --> 00:23:45,919
we've<font color="#E5E5E5"> already done we can just work on</font>

522
00:23:42,370 --> 00:23:47,600
developing<font color="#CCCCCC"> new things that will benefit</font>

523
00:23:45,920 --> 00:23:56,660
us and hopefully benefit other<font color="#CCCCCC"> freebsd</font>

524
00:23:47,600 --> 00:23:59,300
users as well<font color="#CCCCCC"> my my my hypothesis is</font>

525
00:23:56,660 --> 00:24:01,400
that<font color="#E5E5E5"> you downstream users</font><font color="#CCCCCC"> and open</font>

526
00:23:59,300 --> 00:24:03,860
source projects can get stuck in<font color="#CCCCCC"> one of</font>

527
00:24:01,400 --> 00:24:07,160
two cycles<font color="#E5E5E5"> which I've labeled vicious</font>

528
00:24:03,860 --> 00:24:12,649
and virtuous and this is not entirely

529
00:24:07,160 --> 00:24:16,100
<font color="#E5E5E5">original thought but I think you can</font>

530
00:24:12,650 --> 00:24:18,530
easily<font color="#E5E5E5"> get</font><font color="#CCCCCC"> stuck in this vicious</font><font color="#E5E5E5"> cycle</font>

531
00:24:16,100 --> 00:24:21,080
<font color="#E5E5E5">what I call the vicious cycle</font><font color="#CCCCCC"> which</font>

532
00:24:18,530 --> 00:24:22,960
starts with infrequent merges<font color="#E5E5E5"> and so if</font>

533
00:24:21,080 --> 00:24:25,899
<font color="#CCCCCC">you're</font><font color="#E5E5E5"> a downstream</font>

534
00:24:22,960 --> 00:24:27,550
the downstream user and I don't<font color="#CCCCCC"> mean an</font>

535
00:24:25,900 --> 00:24:30,460
end user in this<font color="#E5E5E5"> case</font><font color="#CCCCCC"> I mean a company</font>

536
00:24:27,550 --> 00:24:33,370
<font color="#CCCCCC">like us that's trying to write an</font>

537
00:24:30,460 --> 00:24:36,400
operating system<font color="#E5E5E5"> or use a net or either</font>

538
00:24:33,370 --> 00:24:37,689
<font color="#E5E5E5">write an operating system and</font><font color="#CCCCCC"> use an</font>

539
00:24:36,400 --> 00:24:39,010
upstream operating system and customize

540
00:24:37,690 --> 00:24:41,130
<font color="#CCCCCC">it produces or use an upstream</font>

541
00:24:39,010 --> 00:24:44,110
application and customize<font color="#CCCCCC"> it for users</font>

542
00:24:41,130 --> 00:24:47,100
<font color="#CCCCCC">that</font><font color="#E5E5E5"> that's the kind of user I'm talking</font>

543
00:24:44,110 --> 00:24:50,199
<font color="#CCCCCC">about and I think this cycle starts with</font>

544
00:24:47,100 --> 00:24:53,439
infrequent merges so when you start<font color="#E5E5E5"> with</font>

545
00:24:50,200 --> 00:24:56,170
infrequent merges<font color="#CCCCCC"> and this is infrequent</font>

546
00:24:53,440 --> 00:24:57,910
merges of the development<font color="#E5E5E5"> code</font><font color="#CCCCCC"> so this</font>

547
00:24:56,170 --> 00:25:01,720
could mean<font color="#CCCCCC"> that you are tracking a</font>

548
00:24:57,910 --> 00:25:04,090
<font color="#E5E5E5">stable branch</font><font color="#CCCCCC"> and/or a released branch</font>

549
00:25:01,720 --> 00:25:06,100
and then every year<font color="#CCCCCC"> or two you jump to</font>

550
00:25:04,090 --> 00:25:08,230
<font color="#CCCCCC">the next</font><font color="#E5E5E5"> release branch that's innocent</font>

551
00:25:06,100 --> 00:25:10,780
<font color="#CCCCCC">in essence that's an infrequent merge of</font>

552
00:25:08,230 --> 00:25:12,850
the development code and when you start

553
00:25:10,780 --> 00:25:14,170
off<font color="#CCCCCC"> with that what happens over time as</font>

554
00:25:12,850 --> 00:25:15,730
<font color="#E5E5E5">you get farther and farther away from</font>

555
00:25:14,170 --> 00:25:17,650
the upstream<font color="#CCCCCC"> projects so when you do</font>

556
00:25:15,730 --> 00:25:20,380
actually<font color="#E5E5E5"> try to do a merge you have a</font>

557
00:25:17,650 --> 00:25:23,380
lot<font color="#CCCCCC"> of conflicts you have regressions</font>

558
00:25:20,380 --> 00:25:25,330
<font color="#E5E5E5">things don't work right</font><font color="#CCCCCC"> and it becomes</font>

559
00:25:23,380 --> 00:25:26,890
very<font color="#E5E5E5"> painful and so every time</font><font color="#CCCCCC"> you do</font>

560
00:25:25,330 --> 00:25:29,439
<font color="#E5E5E5">one of those merges it's very</font><font color="#CCCCCC"> painful</font>

561
00:25:26,890 --> 00:25:32,920
<font color="#E5E5E5">and disruptive to the organization</font><font color="#CCCCCC"> the</font>

562
00:25:29,440 --> 00:25:34,660
developers who were developing code

563
00:25:32,920 --> 00:25:36,520
suddenly have to<font color="#E5E5E5"> stop developing new</font>

564
00:25:34,660 --> 00:25:38,910
features<font color="#CCCCCC"> and go back and make all the</font>

565
00:25:36,520 --> 00:25:41,950
old stuff work again with<font color="#E5E5E5"> the new code</font>

566
00:25:38,910 --> 00:25:44,980
<font color="#CCCCCC">and that's not</font><font color="#E5E5E5"> very fun to</font><font color="#CCCCCC"> do as a</font>

567
00:25:41,950 --> 00:25:46,300
<font color="#E5E5E5">developer but it also means that's a</font>

568
00:25:44,980 --> 00:25:51,400
whole<font color="#E5E5E5"> bunch of time you're not</font><font color="#CCCCCC"> writing</font>

569
00:25:46,300 --> 00:25:54,760
new features<font color="#E5E5E5"> and all that means is that</font>

570
00:25:51,400 --> 00:25:57,340
you are you end up thinking<font color="#E5E5E5"> these words</font>

571
00:25:54,760 --> 00:25:59,500
<font color="#E5E5E5">are so painful</font><font color="#CCCCCC"> that you're going</font><font color="#E5E5E5"> to do</font>

572
00:25:57,340 --> 00:26:01,030
them even<font color="#E5E5E5"> less frequently and when you</font>

573
00:25:59,500 --> 00:26:03,510
do them less frequently<font color="#CCCCCC"> you</font><font color="#E5E5E5"> have even</font>

574
00:26:01,030 --> 00:26:06,129
<font color="#E5E5E5">more merge conflicts</font><font color="#CCCCCC"> and you have more</font>

575
00:26:03,510 --> 00:26:07,570
regressions<font color="#E5E5E5"> which means that you have to</font>

576
00:26:06,130 --> 00:26:09,580
spend<font color="#E5E5E5"> even more time fixing them all</font>

577
00:26:07,570 --> 00:26:12,340
which means your feature velocity gets

578
00:26:09,580 --> 00:26:15,879
even slower<font color="#CCCCCC"> and the whole thing</font><font color="#E5E5E5"> is so</font>

579
00:26:12,340 --> 00:26:18,159
painful<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you want to do the merges</font>

580
00:26:15,880 --> 00:26:20,230
even less<font color="#E5E5E5"> and at some point maybe you</font>

581
00:26:18,160 --> 00:26:23,140
<font color="#E5E5E5">even</font><font color="#CCCCCC"> stopped</font><font color="#E5E5E5"> taking merges from upstream</font>

582
00:26:20,230 --> 00:26:25,720
and instead you just<font color="#E5E5E5"> simply try to</font>

583
00:26:23,140 --> 00:26:28,929
<font color="#CCCCCC">cherry pick back the bug fixes that you</font>

584
00:26:25,720 --> 00:26:30,940
think you need so<font color="#E5E5E5"> you can compare that</font>

585
00:26:28,929 --> 00:26:32,410
<font color="#E5E5E5">to what I call the virtuous cycle</font><font color="#CCCCCC"> which</font>

586
00:26:30,940 --> 00:26:34,300
starts with frequent merges of the

587
00:26:32,410 --> 00:26:36,110
<font color="#CCCCCC">developing code so when</font><font color="#E5E5E5"> you're</font>

588
00:26:34,300 --> 00:26:39,760
frequently merging the development code

589
00:26:36,110 --> 00:26:42,590
you're diverging<font color="#CCCCCC"> from it less overtime</font>

590
00:26:39,760 --> 00:26:44,539
<font color="#CCCCCC">and</font><font color="#E5E5E5"> that means that each merge is much</font>

591
00:26:42,590 --> 00:26:45,980
easier<font color="#CCCCCC"> they'll</font><font color="#E5E5E5"> probably still be</font>

592
00:26:44,539 --> 00:26:49,370
conflicts they're probably still be

593
00:26:45,980 --> 00:26:51,169
regressions<font color="#E5E5E5"> but there should be fewer</font><font color="#CCCCCC"> of</font>

594
00:26:49,370 --> 00:26:53,899
them and each merge should be much

595
00:26:51,169 --> 00:26:55,549
<font color="#E5E5E5">easier to</font><font color="#CCCCCC"> handle furthermore</font><font color="#E5E5E5"> because</font>

596
00:26:53,899 --> 00:26:57,949
you're so<font color="#E5E5E5"> close to</font><font color="#CCCCCC"> the development</font>

597
00:26:55,549 --> 00:27:01,940
branch<font color="#E5E5E5"> it's easier to get things up</font>

598
00:26:57,950 --> 00:27:04,789
streams<font color="#CCCCCC"> it takes time it up streaming</font>

599
00:27:01,940 --> 00:27:07,250
things is not just<font color="#E5E5E5"> about pushing your</font>

600
00:27:04,789 --> 00:27:09,710
code<font color="#CCCCCC"> into the</font><font color="#E5E5E5"> upstream project rather</font>

601
00:27:07,250 --> 00:27:11,419
<font color="#CCCCCC">upstream things first of</font><font color="#E5E5E5"> all you need to</font>

602
00:27:09,710 --> 00:27:13,519
<font color="#CCCCCC">generalize</font><font color="#E5E5E5"> the feature and make it</font>

603
00:27:11,419 --> 00:27:18,529
generally applicable to all<font color="#E5E5E5"> the users of</font>

604
00:27:13,519 --> 00:27:19,880
<font color="#E5E5E5">the project</font><font color="#CCCCCC"> on top</font><font color="#E5E5E5"> of that you probably</font>

605
00:27:18,529 --> 00:27:21,830
need<font color="#E5E5E5"> to do some code cleanup because</font>

606
00:27:19,880 --> 00:27:24,320
there's probably some rough<font color="#E5E5E5"> edges</font><font color="#CCCCCC"> and</font>

607
00:27:21,830 --> 00:27:26,330
then if you<font color="#E5E5E5"> are and that's just if</font>

608
00:27:24,320 --> 00:27:28,039
you're<font color="#E5E5E5"> running the development branch</font><font color="#CCCCCC"> if</font>

609
00:27:26,330 --> 00:27:29,510
you're right if your code is<font color="#E5E5E5"> based off</font>

610
00:27:28,039 --> 00:27:31,490
of a stable<font color="#E5E5E5"> branch you need to do the</font>

611
00:27:29,510 --> 00:27:34,779
extra step of then rebasing your code

612
00:27:31,490 --> 00:27:36,980
<font color="#E5E5E5">onto the development branch</font><font color="#CCCCCC"> by running</font>

613
00:27:34,779 --> 00:27:38,809
<font color="#E5E5E5">by running the development branch</font>

614
00:27:36,980 --> 00:27:40,639
internally<font color="#E5E5E5"> we're able to skip that last</font>

615
00:27:38,809 --> 00:27:42,519
step<font color="#E5E5E5"> so we still</font><font color="#CCCCCC"> need to clean up</font><font color="#E5E5E5"> our</font>

616
00:27:40,639 --> 00:27:46,519
code we still need to generalize it<font color="#E5E5E5"> and</font>

617
00:27:42,519 --> 00:27:47,990
there's some<font color="#E5E5E5"> that costs extra money for</font>

618
00:27:46,519 --> 00:27:52,220
<font color="#E5E5E5">us but we're willing to do it because we</font>

619
00:27:47,990 --> 00:27:55,370
think it's the<font color="#E5E5E5"> right</font><font color="#CCCCCC"> thing to do and all</font>

620
00:27:52,220 --> 00:27:57,679
<font color="#E5E5E5">of</font><font color="#CCCCCC"> that means that</font><font color="#E5E5E5"> we can get our code</font>

621
00:27:55,370 --> 00:27:59,928
<font color="#CCCCCC">up streamed that much easier because we</font>

622
00:27:57,679 --> 00:28:01,639
don't have to rebase it regularly<font color="#E5E5E5"> on to</font>

623
00:27:59,929 --> 00:28:05,179
the development branch to get<font color="#E5E5E5"> an</font>

624
00:28:01,639 --> 00:28:06,649
upstream<font color="#CCCCCC"> and having</font><font color="#E5E5E5"> that code upstream</font>

625
00:28:05,179 --> 00:28:08,480
<font color="#E5E5E5">to means that our diff against the</font>

626
00:28:06,649 --> 00:28:13,219
<font color="#E5E5E5">development branch of the upstream</font>

627
00:28:08,480 --> 00:28:16,190
<font color="#CCCCCC">project</font><font color="#E5E5E5"> is relatively small that lets us</font>

628
00:28:13,220 --> 00:28:18,080
focus more<font color="#CCCCCC"> on</font><font color="#E5E5E5"> getting</font><font color="#CCCCCC"> our feature</font>

629
00:28:16,190 --> 00:28:19,429
developing new features<font color="#CCCCCC"> so we're to</font>

630
00:28:18,080 --> 00:28:20,899
spending less and less<font color="#CCCCCC"> time</font><font color="#E5E5E5"> of dealing</font>

631
00:28:19,429 --> 00:28:23,360
with<font color="#E5E5E5"> old features or spending more time</font>

632
00:28:20,899 --> 00:28:24,439
dealing<font color="#E5E5E5"> with new features and on top</font><font color="#CCCCCC"> of</font>

633
00:28:23,360 --> 00:28:26,928
<font color="#E5E5E5">that it lets us collaborate effectively</font>

634
00:28:24,440 --> 00:28:29,600
<font color="#E5E5E5">with other people in the upstream</font>

635
00:28:26,929 --> 00:28:33,559
community who<font color="#CCCCCC"> are using</font><font color="#E5E5E5"> using</font><font color="#CCCCCC"> this</font>

636
00:28:29,600 --> 00:28:35,899
project because<font color="#E5E5E5"> we're most</font><font color="#CCCCCC"> freebsd</font>

637
00:28:33,559 --> 00:28:40,309
developers run freebsd head and because

638
00:28:35,899 --> 00:28:42,408
we we also use head internally<font color="#CCCCCC"> we are</font>

639
00:28:40,309 --> 00:28:44,570
<font color="#CCCCCC">able to directly</font><font color="#E5E5E5"> share patches with them</font>

640
00:28:42,409 --> 00:28:46,460
and they can<font color="#CCCCCC"> apply</font><font color="#E5E5E5"> the patches they</font>

641
00:28:44,570 --> 00:28:48,678
apply cleanly<font color="#E5E5E5"> they get</font><font color="#CCCCCC"> senesce patches</font>

642
00:28:46,460 --> 00:28:49,850
they like they apply cleanly<font color="#E5E5E5"> and so we</font>

643
00:28:48,679 --> 00:28:52,460
can collaborate<font color="#E5E5E5"> together</font>

644
00:28:49,850 --> 00:28:54,740
we're doing our<font color="#CCCCCC"> work</font><font color="#E5E5E5"> and all that means</font>

645
00:28:52,460 --> 00:28:56,840
<font color="#E5E5E5">is that it makes it easy</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> us to do</font>

646
00:28:54,740 --> 00:29:00,140
more frequent<font color="#E5E5E5"> merges in fact we've</font>

647
00:28:56,840 --> 00:29:01,520
gotten to the<font color="#E5E5E5"> point where my developers</font>

648
00:29:00,140 --> 00:29:04,190
will sometimes just commit stuff

649
00:29:01,520 --> 00:29:06,289
upstream to the upstream projects rather

650
00:29:04,190 --> 00:29:08,690
<font color="#E5E5E5">than to our</font><font color="#CCCCCC"> repository and we'll just</font>

651
00:29:06,289 --> 00:29:13,760
<font color="#E5E5E5">pull it back</font><font color="#CCCCCC"> in the next upstream sink</font>

652
00:29:08,690 --> 00:29:16,750
that that we do<font color="#CCCCCC"> now</font><font color="#E5E5E5"> having said that we</font>

653
00:29:13,760 --> 00:29:19,879
<font color="#E5E5E5">do keep local</font><font color="#CCCCCC"> dips for a few reasons</font>

654
00:29:16,750 --> 00:29:22,330
the first one is should<font color="#CCCCCC"> be fairly</font>

655
00:29:19,880 --> 00:29:25,130
obvious<font color="#CCCCCC"> it's information covered by MDA</font>

656
00:29:22,330 --> 00:29:27,678
<font color="#CCCCCC">we do occasionally get information from</font>

657
00:29:25,130 --> 00:29:30,440
vendors which helps us<font color="#E5E5E5"> to do something</font>

658
00:29:27,679 --> 00:29:34,010
<font color="#CCCCCC">we need to do</font><font color="#E5E5E5"> but it's covered under an</font>

659
00:29:30,440 --> 00:29:37,010
NDA<font color="#E5E5E5"> and they will not let</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> upstream</font>

660
00:29:34,010 --> 00:29:38,390
the code based on<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I think we have</font>

661
00:29:37,010 --> 00:29:40,250
something<font color="#CCCCCC"> like</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> hundred lines of code</font>

662
00:29:38,390 --> 00:29:44,480
that<font color="#E5E5E5"> fall in</font><font color="#CCCCCC"> this category so it's a</font>

663
00:29:40,250 --> 00:29:46,750
very very<font color="#CCCCCC"> very small diff but this does</font>

664
00:29:44,480 --> 00:29:52,010
happen<font color="#E5E5E5"> occasionally</font>

665
00:29:46,750 --> 00:29:55,240
we also we<font color="#CCCCCC"> also have features which are</font>

666
00:29:52,010 --> 00:29:59,200
still<font color="#E5E5E5"> in development or testing we will</font>

667
00:29:55,240 --> 00:30:02,539
sometimes commit features to our tree

668
00:29:59,200 --> 00:30:04,100
for testing purposes<font color="#CCCCCC"> and we</font><font color="#E5E5E5"> don't</font>

669
00:30:02,539 --> 00:30:06,890
upstream them usually<font color="#E5E5E5"> until we're sure</font>

670
00:30:04,100 --> 00:30:08,240
they actually<font color="#E5E5E5"> work</font><font color="#CCCCCC"> and so we'll keep</font>

671
00:30:06,890 --> 00:30:09,830
that<font color="#CCCCCC"> local diff until we're sure the</font>

672
00:30:08,240 --> 00:30:12,799
<font color="#E5E5E5">feature works and we've had the chance</font>

673
00:30:09,830 --> 00:30:14,240
to generalize it<font color="#E5E5E5"> and that's the third</font>

674
00:30:12,799 --> 00:30:17,030
reason<font color="#E5E5E5"> we keep local</font><font color="#CCCCCC"> dips there are</font>

675
00:30:14,240 --> 00:30:19,159
features<font color="#CCCCCC"> we have</font><font color="#E5E5E5"> which are</font><font color="#CCCCCC"> too specific</font>

676
00:30:17,030 --> 00:30:22,580
for<font color="#CCCCCC"> us</font><font color="#E5E5E5"> there there are things that help</font>

677
00:30:19,159 --> 00:30:25,640
us with<font color="#CCCCCC"> our workload</font><font color="#E5E5E5"> but they're not</font>

678
00:30:22,580 --> 00:30:28,158
general enough<font color="#CCCCCC"> we have a very</font><font color="#E5E5E5"> specific</font>

679
00:30:25,640 --> 00:30:30,230
workload<font color="#CCCCCC"> you know as I showed you</font><font color="#E5E5E5"> we</font>

680
00:30:28,159 --> 00:30:32,929
tried our our whole<font color="#E5E5E5"> business is getting</font>

681
00:30:30,230 --> 00:30:34,429
<font color="#E5E5E5">data off</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> disks into memory encrypting</font>

682
00:30:32,929 --> 00:30:36,890
it in memory<font color="#E5E5E5"> sending it down on a</font><font color="#CCCCCC"> NIC</font>

683
00:30:34,429 --> 00:30:38,210
<font color="#CCCCCC">that's what we do and there are other</font>

684
00:30:36,890 --> 00:30:42,650
people<font color="#E5E5E5"> that</font><font color="#CCCCCC"> use computers for</font><font color="#E5E5E5"> other</font>

685
00:30:38,210 --> 00:30:45,049
things<font color="#CCCCCC"> and they might not</font><font color="#E5E5E5"> what is good</font>

686
00:30:42,650 --> 00:30:48,950
for<font color="#E5E5E5"> us might not be good for</font><font color="#CCCCCC"> them on top</font>

687
00:30:45,049 --> 00:30:52,129
<font color="#CCCCCC">of that we have a rather rather</font>

688
00:30:48,950 --> 00:30:55,429
homogeneous<font color="#E5E5E5"> environment</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> of our</font>

689
00:30:52,130 --> 00:30:58,450
<font color="#E5E5E5">caches are Intel 64-bit and there are</font>

690
00:30:55,429 --> 00:31:00,650
<font color="#E5E5E5">people that run other architectures and</font>

691
00:30:58,450 --> 00:31:02,300
again though it's good for<font color="#E5E5E5"> us and</font><font color="#CCCCCC"> in</font>

692
00:31:00,650 --> 00:31:06,280
<font color="#CCCCCC">celle 64-bit might</font><font color="#E5E5E5"> not be</font>

693
00:31:02,300 --> 00:31:11,059
<font color="#CCCCCC">four-armed 64-bit or</font><font color="#E5E5E5"> arm 32-bit or risk</font>

694
00:31:06,280 --> 00:31:12,379
<font color="#CCCCCC">RISC processors and so forth</font><font color="#E5E5E5"> so there</font>

695
00:31:11,059 --> 00:31:17,240
are features<font color="#CCCCCC"> that</font><font color="#E5E5E5"> need to be generalized</font>

696
00:31:12,380 --> 00:31:19,250
<font color="#E5E5E5">and we will hang on to those internally</font>

697
00:31:17,240 --> 00:31:21,679
<font color="#CCCCCC">until we've had the</font><font color="#E5E5E5"> chance to generalize</font>

698
00:31:19,250 --> 00:31:22,910
them<font color="#CCCCCC"> and once we have generalized them</font>

699
00:31:21,679 --> 00:31:26,090
and made sure<font color="#E5E5E5"> that</font><font color="#CCCCCC"> they work</font><font color="#E5E5E5"> for</font>

700
00:31:22,910 --> 00:31:30,620
<font color="#E5E5E5">everyone</font><font color="#CCCCCC"> or at</font><font color="#E5E5E5"> least don't</font><font color="#CCCCCC"> make things</font>

701
00:31:26,090 --> 00:31:31,760
worse<font color="#CCCCCC"> for anyone else then we will</font><font color="#E5E5E5"> then</font>

702
00:31:30,620 --> 00:31:34,580
<font color="#E5E5E5">we'll go</font><font color="#CCCCCC"> through the</font><font color="#E5E5E5"> process of up</font>

703
00:31:31,760 --> 00:31:37,970
streaming them but it's our<font color="#CCCCCC"> intentions</font>

704
00:31:34,580 --> 00:31:39,139
<font color="#E5E5E5">upstream any code</font><font color="#CCCCCC"> that we can</font><font color="#E5E5E5"> I think</font>

705
00:31:37,970 --> 00:31:42,350
<font color="#E5E5E5">that this is one of the great things</font>

706
00:31:39,140 --> 00:31:44,570
<font color="#E5E5E5">about working at Netflix</font><font color="#CCCCCC"> I've worked at</font>

707
00:31:42,350 --> 00:31:46,520
other companies<font color="#E5E5E5"> that</font><font color="#CCCCCC"> used open source</font>

708
00:31:44,570 --> 00:31:50,480
software as the<font color="#E5E5E5"> basis for their products</font>

709
00:31:46,520 --> 00:31:53,090
<font color="#E5E5E5">and they kept everything inside so they</font>

710
00:31:50,480 --> 00:31:54,620
had lots of local patches<font color="#E5E5E5"> that it was</font>

711
00:31:53,090 --> 00:31:59,209
<font color="#E5E5E5">very hard to share outside of the</font>

712
00:31:54,620 --> 00:32:00,590
company<font color="#CCCCCC"> Netflix does allow and in fact</font>

713
00:31:59,210 --> 00:32:02,750
encourage the use of<font color="#CCCCCC"> open</font><font color="#E5E5E5"> source</font>

714
00:32:00,590 --> 00:32:05,360
<font color="#E5E5E5">software make sense but they also let us</font>

715
00:32:02,750 --> 00:32:07,070
<font color="#E5E5E5">freely contribute our software back and</font>

716
00:32:05,360 --> 00:32:09,740
so the approval process upstream<font color="#CCCCCC"> of</font>

717
00:32:07,070 --> 00:32:12,439
feature is essentially it's

718
00:32:09,740 --> 00:32:16,700
automatically<font color="#E5E5E5"> approved</font><font color="#CCCCCC"> and that's really</font>

719
00:32:12,440 --> 00:32:19,429
<font color="#E5E5E5">nice</font><font color="#CCCCCC"> so we can get our software up</font>

720
00:32:16,700 --> 00:32:22,040
streamed rather he's rather easily<font color="#E5E5E5"> from</font>

721
00:32:19,429 --> 00:32:24,080
the Netflix perspective<font color="#E5E5E5"> and we're</font>

722
00:32:22,040 --> 00:32:26,780
willing to<font color="#E5E5E5"> pay</font><font color="#CCCCCC"> willing to pay our</font>

723
00:32:24,080 --> 00:32:28,879
developers or give them some amount<font color="#CCCCCC"> of</font>

724
00:32:26,780 --> 00:32:31,840
time to go through<font color="#CCCCCC"> the process of</font>

725
00:32:28,880 --> 00:32:35,300
upstream<font color="#E5E5E5"> in those cleaning up the code</font>

726
00:32:31,840 --> 00:32:36,770
generalizing it<font color="#E5E5E5"> making it work for</font><font color="#CCCCCC"> the</font>

727
00:32:35,300 --> 00:32:38,990
broader community<font color="#E5E5E5"> because we think</font>

728
00:32:36,770 --> 00:32:44,960
<font color="#CCCCCC">there's value in up streaming what we've</font>

729
00:32:38,990 --> 00:32:48,910
done<font color="#CCCCCC"> so we get a couple</font><font color="#E5E5E5"> benefits from</font>

730
00:32:44,960 --> 00:32:52,910
tracking<font color="#CCCCCC"> freebsd head the first one is</font>

731
00:32:48,910 --> 00:32:54,650
we get quicker<font color="#E5E5E5"> feature iteration as I</font>

732
00:32:52,910 --> 00:32:57,650
mentioned we're not our developers

733
00:32:54,650 --> 00:33:01,400
aren't constantly<font color="#E5E5E5"> stuck looking</font>

734
00:32:57,650 --> 00:33:05,360
backwards but rather we<font color="#CCCCCC"> can they can</font>

735
00:33:01,400 --> 00:33:08,340
develop looking forwards and they can

736
00:33:05,360 --> 00:33:11,189
they can rapidly<font color="#E5E5E5"> develop new features</font>

737
00:33:08,340 --> 00:33:14,459
<font color="#E5E5E5">knowing</font><font color="#CCCCCC"> that they're going</font><font color="#E5E5E5"> to be able</font><font color="#CCCCCC"> to</font>

738
00:33:11,190 --> 00:33:17,610
get them there they're going<font color="#CCCCCC"> to develop</font>

739
00:33:14,460 --> 00:33:19,200
them once<font color="#E5E5E5"> for us in our code base and</font>

740
00:33:17,610 --> 00:33:20,729
then that's the same code base<font color="#E5E5E5"> they'll</font>

741
00:33:19,200 --> 00:33:23,159
be<font color="#E5E5E5"> up streaming them into and so they</font>

742
00:33:20,730 --> 00:33:24,570
don't<font color="#CCCCCC"> have to think</font><font color="#E5E5E5"> about what's going</font>

743
00:33:23,159 --> 00:33:26,279
to<font color="#E5E5E5"> work in stable 10 and then what's</font>

744
00:33:24,570 --> 00:33:27,629
<font color="#E5E5E5">going to work in head and</font><font color="#CCCCCC"> you sort of</font>

745
00:33:26,279 --> 00:33:29,070
develop<font color="#E5E5E5"> this features twice they can</font>

746
00:33:27,629 --> 00:33:33,480
just develop them once and just<font color="#E5E5E5"> worry</font>

747
00:33:29,070 --> 00:33:35,428
about<font color="#E5E5E5"> the</font><font color="#CCCCCC"> one environment we also get</font>

748
00:33:33,480 --> 00:33:37,799
quicker access<font color="#E5E5E5"> to new</font><font color="#CCCCCC"> freebsd features</font>

749
00:33:35,429 --> 00:33:39,869
<font color="#E5E5E5">and this is probably the right point to</font>

750
00:33:37,799 --> 00:33:42,570
mention<font color="#E5E5E5"> that we're</font><font color="#CCCCCC"> very happy running</font>

751
00:33:39,869 --> 00:33:45,749
freebsd<font color="#CCCCCC"> we get</font><font color="#E5E5E5"> great</font><font color="#CCCCCC"> performance at a</font>

752
00:33:42,570 --> 00:33:47,939
freebsd it's very stable<font color="#CCCCCC"> and we get</font>

753
00:33:45,749 --> 00:33:49,529
access<font color="#CCCCCC"> to</font><font color="#E5E5E5"> lots</font><font color="#CCCCCC"> of really</font><font color="#E5E5E5"> cool</font><font color="#CCCCCC"> features</font>

754
00:33:47,940 --> 00:33:51,809
<font color="#CCCCCC">that people in the freebsd community are</font>

755
00:33:49,529 --> 00:33:54,419
working<font color="#CCCCCC"> on and so it's a great</font><font color="#E5E5E5"> benefit</font>

756
00:33:51,809 --> 00:33:55,980
to<font color="#E5E5E5"> us that we run that we track heads so</font>

757
00:33:54,419 --> 00:33:58,679
<font color="#CCCCCC">that we can get access</font><font color="#E5E5E5"> to the</font><font color="#CCCCCC"> new</font>

758
00:33:55,980 --> 00:34:00,869
<font color="#E5E5E5">features as soon as they're committed</font>

759
00:33:58,679 --> 00:34:02,700
and<font color="#E5E5E5"> so someone</font><font color="#CCCCCC"> commits a</font><font color="#E5E5E5"> new feature</font>

760
00:34:00,869 --> 00:34:05,519
today<font color="#E5E5E5"> and it can be running in our</font>

761
00:34:02,700 --> 00:34:07,799
network somewhere<font color="#E5E5E5"> between</font><font color="#CCCCCC"> five and</font>

762
00:34:05,519 --> 00:34:12,599
<font color="#CCCCCC">fifteen day five</font><font color="#E5E5E5"> and fifteen weeks from</font>

763
00:34:07,799 --> 00:34:14,520
now<font color="#E5E5E5"> typically so we like the fact that</font>

764
00:34:12,599 --> 00:34:17,520
we<font color="#E5E5E5"> get quick access to new freebsd</font>

765
00:34:14,520 --> 00:34:20,639
features and we can do cool<font color="#E5E5E5"> things by</font>

766
00:34:17,520 --> 00:34:23,579
getting<font color="#CCCCCC"> access to those features</font><font color="#E5E5E5"> we also</font>

767
00:34:20,639 --> 00:34:25,619
get quicker bug fixes<font color="#CCCCCC"> and this</font><font color="#E5E5E5"> isn't</font>

768
00:34:23,579 --> 00:34:27,809
<font color="#CCCCCC">just because</font><font color="#E5E5E5"> the code gets committed</font>

769
00:34:25,619 --> 00:34:29,369
first to head that's true so freebsd

770
00:34:27,809 --> 00:34:32,849
developers<font color="#CCCCCC"> are fixing a bug they'll put</font>

771
00:34:29,369 --> 00:34:34,859
it in<font color="#CCCCCC"> a freebsd head and then once</font>

772
00:34:32,849 --> 00:34:37,440
they're sure it works and<font color="#E5E5E5"> it's heads and</font>

773
00:34:34,859 --> 00:34:39,449
soak time they'll back<font color="#CCCCCC"> port</font><font color="#E5E5E5"> it to older</font>

774
00:34:37,440 --> 00:34:42,089
releases<font color="#E5E5E5"> so we get access to the bug</font>

775
00:34:39,449 --> 00:34:45,388
fixes<font color="#CCCCCC"> you know a couple</font><font color="#E5E5E5"> weeks earlier</font>

776
00:34:42,089 --> 00:34:47,399
<font color="#E5E5E5">generally running freebsd head but on</font>

777
00:34:45,389 --> 00:34:49,230
top of<font color="#E5E5E5"> that we</font><font color="#CCCCCC"> also get quicker bug</font>

778
00:34:47,399 --> 00:34:51,359
fixes because<font color="#E5E5E5"> our bug reports come much</font>

779
00:34:49,230 --> 00:34:53,129
closer<font color="#E5E5E5"> to when the codes committed so</font>

780
00:34:51,359 --> 00:34:55,319
let's say you're an upstream developer

781
00:34:53,129 --> 00:34:58,890
in the FreeBSD project<font color="#E5E5E5"> and you commit</font>

782
00:34:55,319 --> 00:35:00,930
code today<font color="#CCCCCC"> it may</font><font color="#E5E5E5"> be two years before</font>

783
00:34:58,890 --> 00:35:03,390
<font color="#CCCCCC">that ends up</font><font color="#E5E5E5"> in a freebsd release used</font>

784
00:35:00,930 --> 00:35:05,669
by the<font color="#E5E5E5"> general community once that</font>

785
00:35:03,390 --> 00:35:08,700
happens<font color="#CCCCCC"> two years</font><font color="#E5E5E5"> from now someone may</font>

786
00:35:05,670 --> 00:35:10,109
find a bug and report it to<font color="#CCCCCC"> you are you</font>

787
00:35:08,700 --> 00:35:14,848
<font color="#E5E5E5">going to remember why you wrote that</font>

788
00:35:10,109 --> 00:35:16,650
code two years ago<font color="#CCCCCC"> contrast that with</font>

789
00:35:14,849 --> 00:35:18,240
what happens when we<font color="#E5E5E5"> find bugs you</font>

790
00:35:16,650 --> 00:35:21,450
commit the code today

791
00:35:18,240 --> 00:35:24,240
in the next one<font color="#E5E5E5"> to five weeks we get the</font>

792
00:35:21,450 --> 00:35:28,618
code in a sink<font color="#E5E5E5"> we find a bug and we</font>

793
00:35:24,240 --> 00:35:30,359
report<font color="#E5E5E5"> it</font><font color="#CCCCCC"> and that's we report a bug to</font>

794
00:35:28,619 --> 00:35:32,520
you on code you just<font color="#CCCCCC"> wrote a</font><font color="#E5E5E5"> few weeks</font>

795
00:35:30,359 --> 00:35:35,640
ago<font color="#CCCCCC"> you're much</font><font color="#E5E5E5"> more likely</font><font color="#CCCCCC"> to have the</font>

796
00:35:32,520 --> 00:35:37,259
context in<font color="#CCCCCC"> your head</font><font color="#E5E5E5"> and it's likely</font>

797
00:35:35,640 --> 00:35:39,810
<font color="#E5E5E5">that you'll remember why you were</font><font color="#CCCCCC"> at the</font>

798
00:35:37,260 --> 00:35:43,140
code the<font color="#CCCCCC"> way you did and you can quickly</font>

799
00:35:39,810 --> 00:35:44,730
help<font color="#E5E5E5"> us troubleshoot and fix the bugs on</font>

800
00:35:43,140 --> 00:35:46,259
top<font color="#E5E5E5"> of that they're easier to fix</font>

801
00:35:44,730 --> 00:35:48,390
generally because there's not two<font color="#CCCCCC"> years</font>

802
00:35:46,260 --> 00:35:51,300
of other stuff built<font color="#E5E5E5"> built up that</font>

803
00:35:48,390 --> 00:35:52,589
depends<font color="#E5E5E5"> on that bug being there</font><font color="#CCCCCC"> you know</font>

804
00:35:51,300 --> 00:35:55,560
that that<font color="#E5E5E5"> sometimes happens over time</font>

805
00:35:52,589 --> 00:35:56,820
<font color="#CCCCCC">people you know they depend on</font><font color="#E5E5E5"> oh they</font>

806
00:35:55,560 --> 00:35:58,290
were<font color="#E5E5E5"> lying a bug being there because</font>

807
00:35:56,820 --> 00:35:59,190
<font color="#E5E5E5">it's been</font><font color="#CCCCCC"> there for two years they think</font>

808
00:35:58,290 --> 00:36:01,859
that's<font color="#CCCCCC"> just the</font><font color="#E5E5E5"> way things are supposed</font>

809
00:35:59,190 --> 00:36:03,359
to<font color="#E5E5E5"> work and you</font><font color="#CCCCCC"> could</font><font color="#E5E5E5"> try to fix a bug</font>

810
00:36:01,859 --> 00:36:05,009
and<font color="#CCCCCC"> you end up having to untangle this</font>

811
00:36:03,359 --> 00:36:07,348
rat's nest of dependencies that<font color="#E5E5E5"> have</font>

812
00:36:05,010 --> 00:36:09,170
built up<font color="#E5E5E5"> by</font><font color="#CCCCCC"> finding the</font><font color="#E5E5E5"> bug sooner and</font>

813
00:36:07,349 --> 00:36:12,390
reporting the bug sooner were able to

814
00:36:09,170 --> 00:36:14,670
generally get fairly<font color="#E5E5E5"> quick fixes</font><font color="#CCCCCC"> and</font>

815
00:36:12,390 --> 00:36:18,060
before lots of other dependent stuff<font color="#E5E5E5"> is</font>

816
00:36:14,670 --> 00:36:19,440
<font color="#E5E5E5">built up that makes it harder</font><font color="#CCCCCC"> to fix it</font>

817
00:36:18,060 --> 00:36:21,299
also enables<font color="#E5E5E5"> collaboration as I</font>

818
00:36:19,440 --> 00:36:22,800
mentioned most<font color="#CCCCCC"> freebsd developers run</font>

819
00:36:21,300 --> 00:36:24,900
<font color="#E5E5E5">freebsd head and so we're able</font><font color="#CCCCCC"> to</font>

820
00:36:22,800 --> 00:36:26,430
directly share patches with them<font color="#E5E5E5"> and</font>

821
00:36:24,900 --> 00:36:27,599
that's that's good we really<font color="#CCCCCC"> like the</font>

822
00:36:26,430 --> 00:36:30,180
<font color="#E5E5E5">fact we can collaborate</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> other</font>

823
00:36:27,599 --> 00:36:31,980
<font color="#CCCCCC">people in</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> community</font><font color="#E5E5E5"> and I want to be</font>

824
00:36:30,180 --> 00:36:33,330
clear we're not it's not a<font color="#E5E5E5"> one-way</font>

825
00:36:31,980 --> 00:36:34,470
collaboration<font color="#CCCCCC"> where we're</font><font color="#E5E5E5"> trying to</font>

826
00:36:33,330 --> 00:36:36,900
<font color="#E5E5E5">figure out what we can get from other</font>

827
00:36:34,470 --> 00:36:38,669
<font color="#E5E5E5">people</font><font color="#CCCCCC"> we really do like collaborating</font>

828
00:36:36,900 --> 00:36:40,140
with<font color="#E5E5E5"> people and being able to share the</font>

829
00:36:38,670 --> 00:36:44,250
patches we have the things we're

830
00:36:40,140 --> 00:36:45,660
thinking<font color="#CCCCCC"> about and</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know also</font><font color="#E5E5E5"> find</font>

831
00:36:44,250 --> 00:36:47,460
out what they're<font color="#CCCCCC"> thinking about in ways</font>

832
00:36:45,660 --> 00:36:52,109
that we can<font color="#E5E5E5"> work on projects together</font>

833
00:36:47,460 --> 00:36:56,369
perhaps it<font color="#CCCCCC"> also minimizes our</font><font color="#E5E5E5"> merged</font>

834
00:36:52,109 --> 00:36:57,960
conflicts<font color="#CCCCCC"> as I mentioned sometimes our</font>

835
00:36:56,369 --> 00:36:59,790
developers will even just commit code

836
00:36:57,960 --> 00:37:01,589
directly<font color="#E5E5E5"> to the FreeBSD project and</font>

837
00:36:59,790 --> 00:37:06,540
<font color="#CCCCCC">we'll pull it back as part of the next</font>

838
00:37:01,589 --> 00:37:07,770
<font color="#CCCCCC">sync in other cases</font><font color="#E5E5E5"> we it may take us a</font>

839
00:37:06,540 --> 00:37:09,390
<font color="#E5E5E5">little bit a little bit of time to</font>

840
00:37:07,770 --> 00:37:11,130
upstream things but we<font color="#E5E5E5"> can upstream them</font>

841
00:37:09,390 --> 00:37:14,118
much more<font color="#E5E5E5"> easily</font><font color="#CCCCCC"> because we don't have</font>

842
00:37:11,130 --> 00:37:18,270
to go through that<font color="#E5E5E5"> step of rebasing</font><font color="#CCCCCC"> onto</font>

843
00:37:14,119 --> 00:37:20,190
<font color="#CCCCCC">FreeBSD</font><font color="#E5E5E5"> headfirst</font><font color="#CCCCCC"> and so that</font><font color="#E5E5E5"> that</font>

844
00:37:18,270 --> 00:37:22,050
<font color="#CCCCCC">really helps us keep our dip</font><font color="#E5E5E5"> a local</font><font color="#CCCCCC"> dip</font>

845
00:37:20,190 --> 00:37:24,960
low and minimizes the words conflicts

846
00:37:22,050 --> 00:37:28,590
that we have it also amortizes the merge

847
00:37:24,960 --> 00:37:32,540
cost so

848
00:37:28,590 --> 00:37:35,250
if we did<font color="#E5E5E5"> if once every two years we</font>

849
00:37:32,540 --> 00:37:38,160
switched<font color="#E5E5E5"> rebased our code on to the</font>

850
00:37:35,250 --> 00:37:41,820
<font color="#E5E5E5">latest release</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> would be a very</font>

851
00:37:38,160 --> 00:37:44,549
<font color="#E5E5E5">painful long difficult merge</font><font color="#CCCCCC"> instead we</font>

852
00:37:41,820 --> 00:37:46,890
spread it<font color="#E5E5E5"> out and we do it</font><font color="#CCCCCC"> you know once</font>

853
00:37:44,550 --> 00:37:48,990
every<font color="#E5E5E5"> five weeks or so</font><font color="#CCCCCC"> we do a little</font>

854
00:37:46,890 --> 00:37:50,879
bit<font color="#E5E5E5"> of</font><font color="#CCCCCC"> that merge</font><font color="#E5E5E5"> and so it's a much</font>

855
00:37:48,990 --> 00:37:54,870
more manageable<font color="#CCCCCC"> chunks</font><font color="#E5E5E5"> the diff is much</font>

856
00:37:50,880 --> 00:37:56,910
smaller it's much easier to<font color="#E5E5E5"> spot bugs</font><font color="#CCCCCC"> if</font>

857
00:37:54,870 --> 00:37:59,670
we absolutely needed to it's even

858
00:37:56,910 --> 00:38:02,490
possible<font color="#E5E5E5"> to go do a binary search</font>

859
00:37:59,670 --> 00:38:04,020
through the code the<font color="#CCCCCC"> code</font><font color="#E5E5E5"> that's being</font>

860
00:38:02,490 --> 00:38:06,720
<font color="#E5E5E5">committed to figure out where</font><font color="#CCCCCC"> somewhere</font>

861
00:38:04,020 --> 00:38:08,130
<font color="#CCCCCC">a</font><font color="#E5E5E5"> regression was introduced</font><font color="#CCCCCC"> so we've got</font>

862
00:38:06,720 --> 00:38:12,180
much more<font color="#CCCCCC"> manageable diffs it's much</font>

863
00:38:08,130 --> 00:38:13,740
easier to to deal with<font color="#E5E5E5"> but overall I</font>

864
00:38:12,180 --> 00:38:16,830
would<font color="#E5E5E5"> say we</font><font color="#CCCCCC"> probably spend about</font><font color="#E5E5E5"> as</font>

865
00:38:13,740 --> 00:38:18,089
<font color="#E5E5E5">much time doing our in aggregate</font><font color="#CCCCCC"> we</font>

866
00:38:16,830 --> 00:38:20,190
spent<font color="#CCCCCC"> probably</font><font color="#E5E5E5"> spent</font><font color="#CCCCCC"> about as</font><font color="#E5E5E5"> much time</font>

867
00:38:18,090 --> 00:38:23,310
doing<font color="#CCCCCC"> our once every five week merge as</font>

868
00:38:20,190 --> 00:38:27,360
we would on the big merge at the end of

869
00:38:23,310 --> 00:38:28,950
the at<font color="#CCCCCC"> the end</font><font color="#E5E5E5"> of the the two years but</font>

870
00:38:27,360 --> 00:38:33,300
I<font color="#CCCCCC"> think the spreading</font><font color="#E5E5E5"> out is much</font><font color="#CCCCCC"> more</font>

871
00:38:28,950 --> 00:38:35,009
<font color="#E5E5E5">pleasant for everyone</font><font color="#CCCCCC"> freebsd also I</font>

872
00:38:33,300 --> 00:38:36,990
<font color="#CCCCCC">think</font><font color="#E5E5E5"> gets some benefits from</font><font color="#CCCCCC"> what we do</font>

873
00:38:35,010 --> 00:38:38,880
the<font color="#E5E5E5"> first one is that they get wide</font>

874
00:38:36,990 --> 00:38:44,669
deployment of their head branch very

875
00:38:38,880 --> 00:38:46,410
early<font color="#CCCCCC"> so their head branch is usually a</font>

876
00:38:44,670 --> 00:38:47,820
commit on the<font color="#E5E5E5"> head branch is deployed in</font>

877
00:38:46,410 --> 00:38:49,680
our network<font color="#E5E5E5"> somewhere between five and</font>

878
00:38:47,820 --> 00:38:53,880
<font color="#E5E5E5">fifteen weeks after it's committed</font><font color="#CCCCCC"> to</font>

879
00:38:49,680 --> 00:38:55,950
<font color="#CCCCCC">the freebsd head and i think it's a</font>

880
00:38:53,880 --> 00:38:58,620
testament<font color="#CCCCCC"> to how</font><font color="#E5E5E5"> stable the freebsd head</font>

881
00:38:55,950 --> 00:39:05,310
code is that<font color="#CCCCCC"> we can do this it's a</font><font color="#E5E5E5"> very</font>

882
00:38:58,620 --> 00:39:07,259
stable very<font color="#E5E5E5"> usable</font><font color="#CCCCCC"> release and we're</font>

883
00:39:05,310 --> 00:39:10,620
able to successfully<font color="#E5E5E5"> deploy that code</font>

884
00:39:07,260 --> 00:39:12,810
very quickly<font color="#E5E5E5"> on a large number of caches</font>

885
00:39:10,620 --> 00:39:15,240
<font color="#E5E5E5">and they get the benefit of having that</font>

886
00:39:12,810 --> 00:39:17,310
early deployment<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that early wide</font>

887
00:39:15,240 --> 00:39:21,779
deployment<font color="#CCCCCC"> of</font><font color="#E5E5E5"> their code so that</font><font color="#CCCCCC"> we can</font>

888
00:39:17,310 --> 00:39:23,070
find<font color="#E5E5E5"> we can find bugs now obviously we</font>

889
00:39:21,780 --> 00:39:25,620
<font color="#E5E5E5">try to find them before it's</font><font color="#CCCCCC"> deployed</font>

890
00:39:23,070 --> 00:39:27,840
that<font color="#E5E5E5"> widely but just in case they</font>

891
00:39:25,620 --> 00:39:31,350
slipped through<font color="#E5E5E5"> there their code is</font>

892
00:39:27,840 --> 00:39:32,980
still<font color="#E5E5E5"> seeing still seeing use on a</font><font color="#CCCCCC"> large</font>

893
00:39:31,350 --> 00:39:35,770
number of content caches

894
00:39:32,980 --> 00:39:40,300
around the world<font color="#CCCCCC"> they also get early</font>

895
00:39:35,770 --> 00:39:41,890
intensive<font color="#E5E5E5"> testing of that code</font><font color="#CCCCCC"> we test</font>

896
00:39:40,300 --> 00:39:44,040
the code thoroughly<font color="#E5E5E5"> before we deploy it</font>

897
00:39:41,890 --> 00:39:48,460
<font color="#CCCCCC">and again it gets tested</font><font color="#E5E5E5"> in production</font>

898
00:39:44,040 --> 00:39:52,810
<font color="#CCCCCC">and we we also have an incentive</font><font color="#E5E5E5"> to</font>

899
00:39:48,460 --> 00:39:54,790
upstream our code<font color="#CCCCCC"> and so we because we</font>

900
00:39:52,810 --> 00:39:56,650
want to<font color="#E5E5E5"> minimize your</font><font color="#CCCCCC"> diffs</font><font color="#E5E5E5"> we have a</font>

901
00:39:54,790 --> 00:39:58,270
great incentive<font color="#E5E5E5"> to upstream our code and</font>

902
00:39:56,650 --> 00:40:00,369
it's easier for<font color="#E5E5E5"> us</font><font color="#CCCCCC"> to do that and so</font><font color="#E5E5E5"> I</font>

903
00:39:58,270 --> 00:40:02,950
think<font color="#E5E5E5"> more more of our features end up</font>

904
00:40:00,369 --> 00:40:05,170
in the upstream code base then might

905
00:40:02,950 --> 00:40:07,450
<font color="#E5E5E5">otherwise and I think that's good</font><font color="#CCCCCC"> for</font>

906
00:40:05,170 --> 00:40:09,130
<font color="#E5E5E5">the</font><font color="#CCCCCC"> freebsd community as a whole again</font>

907
00:40:07,450 --> 00:40:11,830
<font color="#CCCCCC">we're not trying to just get our code</font>

908
00:40:09,130 --> 00:40:14,830
into<font color="#E5E5E5"> upstream</font><font color="#CCCCCC"> freebsd but we want to</font>

909
00:40:11,830 --> 00:40:16,359
benefit the upstream project by giving

910
00:40:14,830 --> 00:40:19,630
them access to<font color="#E5E5E5"> the features we've</font>

911
00:40:16,359 --> 00:40:24,450
developed internally<font color="#CCCCCC"> and we think that</font>

912
00:40:19,630 --> 00:40:24,450
that's good<font color="#CCCCCC"> for it's good for everyone</font>

913
00:40:24,990 --> 00:40:28,450
<font color="#CCCCCC">so you might have some you might think</font>

914
00:40:27,190 --> 00:40:31,359
of some objections to<font color="#CCCCCC"> running</font>

915
00:40:28,450 --> 00:40:33,939
development code<font color="#E5E5E5"> so the first one is it</font>

916
00:40:31,359 --> 00:40:36,720
<font color="#E5E5E5">isn't stable</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> well actually it</font>

917
00:40:33,940 --> 00:40:40,830
<font color="#CCCCCC">really is</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> freebsd community is</font>

918
00:40:36,720 --> 00:40:44,529
fanatical<font color="#E5E5E5"> about keeping head stable and</font>

919
00:40:40,830 --> 00:40:47,560
in fact it may even border on<font color="#E5E5E5"> unhealthy</font>

920
00:40:44,530 --> 00:40:51,220
it's there that fanatical about keeping

921
00:40:47,560 --> 00:40:51,850
<font color="#E5E5E5">heads stable</font><font color="#CCCCCC"> which is great I think is</font>

922
00:40:51,220 --> 00:40:54,640
great

923
00:40:51,850 --> 00:40:57,549
it means that you can download and use

924
00:40:54,640 --> 00:41:02,200
<font color="#E5E5E5">FreeBSD head and it</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> generally just</font>

925
00:40:57,550 --> 00:41:04,000
works really well<font color="#CCCCCC"> why should you pay to</font>

926
00:41:02,200 --> 00:41:06,490
find the bugs<font color="#E5E5E5"> that others are gonna find</font>

927
00:41:04,000 --> 00:41:08,650
weather testing<font color="#E5E5E5"> head well the obvious</font>

928
00:41:06,490 --> 00:41:10,000
<font color="#E5E5E5">problem here is if everyone has this</font>

929
00:41:08,650 --> 00:41:11,890
mindset who's actually<font color="#E5E5E5"> going to test</font>

930
00:41:10,000 --> 00:41:16,540
head who's actually<font color="#E5E5E5"> going to test the</font>

931
00:41:11,890 --> 00:41:18,250
code<font color="#CCCCCC"> and you know someone's gotta</font>

932
00:41:16,540 --> 00:41:20,320
<font color="#E5E5E5">someone has to do that testing and I</font>

933
00:41:18,250 --> 00:41:22,210
think that we're well positioned to<font color="#E5E5E5"> do</font>

934
00:41:20,320 --> 00:41:25,300
that testing<font color="#E5E5E5"> for at</font><font color="#CCCCCC"> least for our use</font>

935
00:41:22,210 --> 00:41:27,640
case on<font color="#CCCCCC"> top of that we would probably</font>

936
00:41:25,300 --> 00:41:29,260
<font color="#CCCCCC">still find some of these bugs</font><font color="#E5E5E5"> anyway two</font>

937
00:41:27,640 --> 00:41:31,390
years<font color="#E5E5E5"> down the road when we get the code</font>

938
00:41:29,260 --> 00:41:33,340
<font color="#E5E5E5">but it would be much harder for people</font>

939
00:41:31,390 --> 00:41:36,520
<font color="#E5E5E5">to fix</font><font color="#CCCCCC"> because they would</font><font color="#E5E5E5"> have lost all</font>

940
00:41:33,340 --> 00:41:39,280
<font color="#E5E5E5">that context about why they committed</font>

941
00:41:36,520 --> 00:41:41,530
that<font color="#E5E5E5"> code aren't there</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> security</font>

942
00:41:39,280 --> 00:41:46,029
bugs in development code<font color="#CCCCCC"> well actually</font>

943
00:41:41,530 --> 00:41:48,159
no not<font color="#E5E5E5"> in our experience I think</font>

944
00:41:46,029 --> 00:41:49,899
almost all if not all<font color="#CCCCCC"> of the security</font>

945
00:41:48,159 --> 00:41:53,979
<font color="#E5E5E5">bugs that we've run across</font><font color="#CCCCCC"> to the past</font>

946
00:41:49,899 --> 00:41:57,129
two<font color="#CCCCCC"> years have most of them have</font><font color="#E5E5E5"> been</font><font color="#CCCCCC"> in</font>

947
00:41:53,979 --> 00:41:59,799
the stable branches as well<font color="#CCCCCC"> and so on</font>

948
00:41:57,129 --> 00:42:02,529
the<font color="#CCCCCC"> whole</font><font color="#E5E5E5"> we probably have</font><font color="#CCCCCC"> the same</font>

949
00:41:59,799 --> 00:42:06,489
<font color="#CCCCCC">security bugs in general that the stable</font>

950
00:42:02,529 --> 00:42:07,989
<font color="#E5E5E5">branches have but the people developing</font>

951
00:42:06,489 --> 00:42:09,489
the fixes<font color="#E5E5E5"> for</font><font color="#CCCCCC"> those security bugs are</font>

952
00:42:07,989 --> 00:42:12,069
developing them on the head branch and

953
00:42:09,489 --> 00:42:13,179
we get access<font color="#CCCCCC"> to those security fixes</font>

954
00:42:12,069 --> 00:42:18,129
that they've<font color="#E5E5E5"> developed for the head</font>

955
00:42:13,179 --> 00:42:19,719
branch<font color="#CCCCCC"> no one does this</font><font color="#E5E5E5"> well that's</font><font color="#CCCCCC"> not</font>

956
00:42:18,129 --> 00:42:22,629
<font color="#CCCCCC">completely true there are</font><font color="#E5E5E5"> other</font>

957
00:42:19,719 --> 00:42:25,209
companies<font color="#CCCCCC"> that</font><font color="#E5E5E5"> do similar things</font><font color="#CCCCCC"> there's</font>

958
00:42:22,629 --> 00:42:26,618
one storage vendor that<font color="#E5E5E5"> announced a</font>

959
00:42:25,209 --> 00:42:29,618
couple<font color="#CCCCCC"> of</font><font color="#E5E5E5"> years ago that they</font><font color="#CCCCCC"> were going</font>

960
00:42:26,619 --> 00:42:34,629
<font color="#E5E5E5">to try to base their storage appliance</font>

961
00:42:29,619 --> 00:42:36,399
<font color="#E5E5E5">operating system on FreeBSD head</font><font color="#CCCCCC"> you pay</font>

962
00:42:34,629 --> 00:42:38,499
a monthly<font color="#CCCCCC"> cost to do merges that's true</font>

963
00:42:36,399 --> 00:42:42,519
we do but as I said<font color="#CCCCCC"> in aggregate</font><font color="#E5E5E5"> I think</font>

964
00:42:38,499 --> 00:42:45,249
that it's it's no more<font color="#CCCCCC"> than if we waited</font>

965
00:42:42,519 --> 00:42:46,689
<font color="#E5E5E5">and</font><font color="#CCCCCC"> did this</font><font color="#E5E5E5"> once every two years and I</font>

966
00:42:45,249 --> 00:42:48,368
<font color="#CCCCCC">think each one</font><font color="#E5E5E5"> is actually much easier</font>

967
00:42:46,689 --> 00:42:51,629
<font color="#CCCCCC">and much more pleasant for</font><font color="#E5E5E5"> everyone</font>

968
00:42:48,369 --> 00:42:54,159
<font color="#E5E5E5">involved</font><font color="#CCCCCC"> and you get new bugs each month</font>

969
00:42:51,629 --> 00:42:57,489
<font color="#E5E5E5">yes that's true we do get new bugs each</font>

970
00:42:54,159 --> 00:42:59,589
month<font color="#CCCCCC"> we</font><font color="#E5E5E5"> also get new</font><font color="#CCCCCC"> features and the</font>

971
00:42:57,489 --> 00:43:00,759
new<font color="#E5E5E5"> features are</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> cool and guess</font>

972
00:42:59,589 --> 00:43:03,249
what if we were running<font color="#E5E5E5"> the stable</font>

973
00:43:00,759 --> 00:43:05,319
branches and we did the merge once<font color="#E5E5E5"> once</font>

974
00:43:03,249 --> 00:43:08,109
every two years<font color="#CCCCCC"> we</font><font color="#E5E5E5"> get new bugs then</font><font color="#CCCCCC"> too</font>

975
00:43:05,319 --> 00:43:11,288
<font color="#CCCCCC">so but we wouldn't</font><font color="#E5E5E5"> be getting new</font>

976
00:43:08,109 --> 00:43:15,038
features during that<font color="#E5E5E5"> two year time so I</font>

977
00:43:11,289 --> 00:43:17,559
think that on<font color="#CCCCCC"> the whole it's true you</font>

978
00:43:15,039 --> 00:43:19,209
get<font color="#E5E5E5"> new bugs each month but it's</font>

979
00:43:17,559 --> 00:43:21,099
manageable<font color="#CCCCCC"> it's at a manageable pace</font>

980
00:43:19,209 --> 00:43:24,489
<font color="#E5E5E5">they're a little bit easier to</font><font color="#CCCCCC"> debug and</font>

981
00:43:21,099 --> 00:43:26,069
fix and it's<font color="#E5E5E5"> counterbalanced by the new</font>

982
00:43:24,489 --> 00:43:29,619
features we<font color="#E5E5E5"> get as well</font>

983
00:43:26,069 --> 00:43:33,239
so in conclusion<font color="#CCCCCC"> running</font><font color="#E5E5E5"> freebsd head</font>

984
00:43:29,619 --> 00:43:35,649
<font color="#E5E5E5">has been really really good for Netflix</font>

985
00:43:33,239 --> 00:43:39,579
<font color="#CCCCCC">let's just deliver very large amounts of</font>

986
00:43:35,649 --> 00:43:41,859
<font color="#E5E5E5">data</font><font color="#CCCCCC"> throughout the internet</font><font color="#E5E5E5"> very</font>

987
00:43:39,579 --> 00:43:45,159
efficiently<font color="#E5E5E5"> while maintaining a high</font>

988
00:43:41,859 --> 00:43:47,348
<font color="#CCCCCC">degree of feature velocity we've found</font>

989
00:43:45,159 --> 00:43:49,659
<font color="#CCCCCC">freebsd had to be very stable it's</font>

990
00:43:47,349 --> 00:43:51,669
<font color="#E5E5E5">stable enough</font><font color="#CCCCCC"> that we deploy</font><font color="#E5E5E5"> their</font>

991
00:43:49,659 --> 00:43:53,259
commits in our network<font color="#CCCCCC"> usually as I said</font>

992
00:43:51,669 --> 00:43:56,348
about<font color="#E5E5E5"> five to</font><font color="#CCCCCC"> 15 weeks after</font><font color="#E5E5E5"> they're</font>

993
00:43:53,259 --> 00:43:57,810
committed<font color="#CCCCCC"> it lets us deliver a large</font>

994
00:43:56,349 --> 00:43:59,400
amount of traffic<font color="#CCCCCC"> very efficiently</font>

995
00:43:57,810 --> 00:44:01,890
and it lets<font color="#E5E5E5"> us maintain our development</font>

996
00:43:59,400 --> 00:44:04,740
agenda<font color="#CCCCCC"> so we're very</font><font color="#E5E5E5"> happy</font>

997
00:44:01,890 --> 00:44:06,779
using<font color="#CCCCCC"> FreeBSD and</font><font color="#E5E5E5"> in fact running using</font>

998
00:44:04,740 --> 00:44:10,470
<font color="#E5E5E5">their head branch as the basis</font><font color="#CCCCCC"> for our</font>

999
00:44:06,780 --> 00:44:14,160
<font color="#E5E5E5">operating systems it looks like I have</font>

1000
00:44:10,470 --> 00:44:17,180
<font color="#E5E5E5">about five minutes if</font><font color="#CCCCCC"> anyone has</font>

1001
00:44:14,160 --> 00:44:20,879
questions they want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> ask</font>

1002
00:44:17,180 --> 00:44:20,879
[Applause]

1003
00:44:23,010 --> 00:44:30,300
[Music]

1004
00:44:25,910 --> 00:44:33,720
<font color="#CCCCCC">all right are</font><font color="#E5E5E5"> there are there any</font>

1005
00:44:30,300 --> 00:44:40,170
<font color="#CCCCCC">questions people have all right I see</font>

1006
00:44:33,720 --> 00:44:42,180
<font color="#E5E5E5">one right</font><font color="#CCCCCC"> there sat again you</font><font color="#E5E5E5"> know how</font>

1007
00:44:40,170 --> 00:44:45,089
much<font color="#E5E5E5"> of the Col deze nuts portal back to</font>

1008
00:44:42,180 --> 00:44:47,490
FreeBSD<font color="#E5E5E5"> how much is not allowed to</font><font color="#CCCCCC"> go</font>

1009
00:44:45,089 --> 00:44:47,820
<font color="#E5E5E5">with which features for example</font><font color="#CCCCCC"> what's</font>

1010
00:44:47,490 --> 00:44:51,240
that

1011
00:44:47,820 --> 00:44:56,220
which features<font color="#CCCCCC"> for example</font><font color="#E5E5E5"> which</font>

1012
00:44:51,240 --> 00:44:58,049
features<font color="#E5E5E5"> as I said our aim is to port</font>

1013
00:44:56,220 --> 00:45:01,109
back<font color="#E5E5E5"> all the features except for the</font>

1014
00:44:58,050 --> 00:45:05,520
ones covered under an NDA<font color="#CCCCCC"> at this point</font>

1015
00:45:01,109 --> 00:45:09,359
there are a few features<font color="#E5E5E5"> particularly in</font>

1016
00:45:05,520 --> 00:45:11,460
the tcp area which<font color="#E5E5E5"> are not not yet up</font>

1017
00:45:09,359 --> 00:45:12,779
streamed<font color="#CCCCCC"> but we're in the</font><font color="#E5E5E5"> process of</font>

1018
00:45:11,460 --> 00:45:17,460
working<font color="#E5E5E5"> through</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> backlog and up</font>

1019
00:45:12,780 --> 00:45:19,890
streaming them as we as we<font color="#E5E5E5"> can and and</font>

1020
00:45:17,460 --> 00:45:22,230
we're also<font color="#CCCCCC"> usually happy to share dips</font>

1021
00:45:19,890 --> 00:45:24,330
if we can and so when<font color="#CCCCCC"> people write us</font>

1022
00:45:22,230 --> 00:45:25,710
and<font color="#CCCCCC"> asked for diffs work we're happy to</font>

1023
00:45:24,330 --> 00:45:28,880
share<font color="#E5E5E5"> them and just we give them the</font>

1024
00:45:25,710 --> 00:45:33,420
<font color="#CCCCCC">caveats of this</font><font color="#E5E5E5"> isn't quite ready</font><font color="#CCCCCC"> yet</font>

1025
00:45:28,880 --> 00:45:35,280
any other questions why did you choose

1026
00:45:33,420 --> 00:45:38,790
this<font color="#E5E5E5"> FreeBSD kind of</font><font color="#CCCCCC"> Natalja</font><font color="#E5E5E5"> instead of</font>

1027
00:45:35,280 --> 00:45:42,240
<font color="#CCCCCC">relying external</font><font color="#E5E5E5"> your can you repeat the</font>

1028
00:45:38,790 --> 00:45:45,660
<font color="#CCCCCC">question was why did you choose FreeBSD</font>

1029
00:45:42,240 --> 00:45:51,000
instead of Linux<font color="#CCCCCC"> why</font><font color="#E5E5E5"> why previously</font>

1030
00:45:45,660 --> 00:45:52,140
instead of Linux<font color="#CCCCCC"> okay originally for</font>

1031
00:45:51,000 --> 00:45:53,760
what I entered I wasn't there when the

1032
00:45:52,140 --> 00:45:55,049
<font color="#CCCCCC">decision was</font><font color="#E5E5E5"> made originally from what I</font>

1033
00:45:53,760 --> 00:45:58,170
understand it<font color="#E5E5E5"> was all based on the</font>

1034
00:45:55,050 --> 00:46:01,109
license so<font color="#CCCCCC"> it's based on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> BSD license</font>

1035
00:45:58,170 --> 00:46:05,190
versus GPL<font color="#CCCCCC"> at this point we stick with</font>

1036
00:46:01,109 --> 00:46:08,640
<font color="#CCCCCC">it</font><font color="#E5E5E5"> because it has a combination of a</font>

1037
00:46:05,190 --> 00:46:12,599
<font color="#E5E5E5">very positive collaborative</font><font color="#CCCCCC"> developing</font>

1038
00:46:08,640 --> 00:46:16,920
community a good set<font color="#CCCCCC"> of features that</font>

1039
00:46:12,599 --> 00:46:20,580
are<font color="#E5E5E5"> a nice stable velocity and good</font>

1040
00:46:16,920 --> 00:46:23,550
<font color="#CCCCCC">performance for</font><font color="#E5E5E5"> us we have tested Linux</font>

1041
00:46:20,580 --> 00:46:25,230
in the past several years and it did it

1042
00:46:23,550 --> 00:46:28,020
didn't give us as good performance as

1043
00:46:25,230 --> 00:46:29,880
previous state but of<font color="#E5E5E5"> course we also</font>

1044
00:46:28,020 --> 00:46:31,500
it's not exactly a fair comparison

1045
00:46:29,880 --> 00:46:32,609
<font color="#E5E5E5">because we didn't do all the engineering</font>

1046
00:46:31,500 --> 00:46:34,290
work on Linux that<font color="#E5E5E5"> we've done in</font>

1047
00:46:32,609 --> 00:46:35,830
<font color="#CCCCCC">previous date so it's not exactly a fair</font>

1048
00:46:34,290 --> 00:46:37,450
comparison<font color="#E5E5E5"> but</font>

1049
00:46:35,830 --> 00:46:40,150
we clearly would<font color="#CCCCCC"> have to do a little</font><font color="#E5E5E5"> bit</font>

1050
00:46:37,450 --> 00:46:41,830
of engineering<font color="#CCCCCC"> work to be able</font><font color="#E5E5E5"> to switch</font>

1051
00:46:40,150 --> 00:46:46,330
to<font color="#E5E5E5"> Linux at this point if you wanted to</font>

1052
00:46:41,830 --> 00:46:48,040
<font color="#E5E5E5">but the</font><font color="#CCCCCC"> original</font><font color="#E5E5E5"> as I understand that</font>

1053
00:46:46,330 --> 00:46:50,770
<font color="#CCCCCC">the original reason was the license but</font>

1054
00:46:48,040 --> 00:46:52,180
we're very<font color="#E5E5E5"> happy with FreeBSD and I</font>

1055
00:46:50,770 --> 00:46:56,050
think we get a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> benefits from</font>

1056
00:46:52,180 --> 00:46:59,970
using it at this<font color="#E5E5E5"> point any other</font>

1057
00:46:56,050 --> 00:47:04,510
questions<font color="#CCCCCC"> yep how many developers</font>

1058
00:46:59,970 --> 00:47:08,740
<font color="#E5E5E5">focuses on these in Netflix</font><font color="#CCCCCC"> how</font><font color="#E5E5E5"> many</font>

1059
00:47:04,510 --> 00:47:13,630
developers<font color="#E5E5E5"> how many in Netflix</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> this</font>

1060
00:47:08,740 --> 00:47:15,580
topic<font color="#E5E5E5"> how many developers</font><font color="#CCCCCC"> in isn't</font>

1061
00:47:13,630 --> 00:47:19,080
Netflix for this topic<font color="#CCCCCC"> how many</font>

1062
00:47:15,580 --> 00:47:23,290
developers<font color="#E5E5E5"> work</font><font color="#CCCCCC"> on the operating</font><font color="#E5E5E5"> system</font>

1063
00:47:19,080 --> 00:47:26,560
<font color="#CCCCCC">so my team has six or eight people</font>

1064
00:47:23,290 --> 00:47:28,750
depending<font color="#E5E5E5"> on how you count and there's</font>

1065
00:47:26,560 --> 00:47:32,470
<font color="#E5E5E5">the team that works on the TCP protocols</font>

1066
00:47:28,750 --> 00:47:34,720
and that's I think<font color="#CCCCCC"> has four</font><font color="#E5E5E5"> people on it</font>

1067
00:47:32,470 --> 00:47:37,810
<font color="#CCCCCC">and there's a couple</font><font color="#E5E5E5"> of other people</font>

1068
00:47:34,720 --> 00:47:43,029
<font color="#E5E5E5">that also assist us so all told I would</font>

1069
00:47:37,810 --> 00:47:46,509
say probably<font color="#E5E5E5"> 16 or so so it's a nice</font>

1070
00:47:43,030 --> 00:47:49,420
small manageable team<font color="#CCCCCC"> one did</font><font color="#E5E5E5"> ask which</font>

1071
00:47:46,510 --> 00:47:53,200
file system of<font color="#E5E5E5"> FreeBSD you use is it</font><font color="#CCCCCC"> ufn</font>

1072
00:47:49,420 --> 00:47:58,080
<font color="#E5E5E5">so ZFS</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> you up best and then I</font>

1073
00:47:53,200 --> 00:48:01,000
using SSDs or just hard drives<font color="#E5E5E5"> we use</font>

1074
00:47:58,080 --> 00:48:02,560
nvme SSD and hard drives we use them in

1075
00:48:01,000 --> 00:48:04,930
<font color="#CCCCCC">different systems for different</font><font color="#E5E5E5"> reasons</font>

1076
00:48:02,560 --> 00:48:07,750
we have some systems<font color="#E5E5E5"> that are meant to</font>

1077
00:48:04,930 --> 00:48:12,669
<font color="#E5E5E5">store large amounts of content but serve</font>

1078
00:48:07,750 --> 00:48:14,740
it<font color="#E5E5E5"> less efficiently and those have hard</font>

1079
00:48:12,670 --> 00:48:16,720
<font color="#CCCCCC">drives in them we also have our hundred</font>

1080
00:48:14,740 --> 00:48:18,490
gig appliances<font color="#E5E5E5"> at the other end of that</font>

1081
00:48:16,720 --> 00:48:22,149
<font color="#E5E5E5">we've 100 Gig appliances which are meant</font>

1082
00:48:18,490 --> 00:48:24,490
to<font color="#E5E5E5"> serve a much smaller selection of</font>

1083
00:48:22,150 --> 00:48:29,110
data<font color="#E5E5E5"> but serve it very fast and they</font>

1084
00:48:24,490 --> 00:48:30,850
would be nvme or SSD for your

1085
00:48:29,110 --> 00:48:32,770
<font color="#E5E5E5">development testing a new canary</font>

1086
00:48:30,850 --> 00:48:36,370
deployments what is the percentage of

1087
00:48:32,770 --> 00:48:39,820
<font color="#E5E5E5">your user base you deploy to for the</font>

1088
00:48:36,370 --> 00:48:41,740
canary testing<font color="#CCCCCC"> event yes so for</font><font color="#E5E5E5"> the we</font>

1089
00:48:39,820 --> 00:48:44,260
do several<font color="#E5E5E5"> stages of testing the first</font>

1090
00:48:41,740 --> 00:48:47,830
one is<font color="#E5E5E5"> to about 45 caches</font>

1091
00:48:44,260 --> 00:48:49,950
the next stage is<font color="#CCCCCC"> to a larger number</font><font color="#E5E5E5"> I'm</font>

1092
00:48:47,830 --> 00:48:56,710
not<font color="#CCCCCC"> sure exactly what it is</font><font color="#E5E5E5"> I'm sorry</font>

1093
00:48:49,950 --> 00:48:57,970
<font color="#CCCCCC">but it's yeah I'm not</font><font color="#E5E5E5"> sure what the</font>

1094
00:48:56,710 --> 00:48:59,710
number<font color="#CCCCCC"> is I'm sorry</font><font color="#E5E5E5"> it's another group</font>

1095
00:48:57,970 --> 00:49:00,939
that<font color="#CCCCCC"> does that at that point we've</font>

1096
00:48:59,710 --> 00:49:03,100
handed it off to<font color="#CCCCCC"> another group when they</font>

1097
00:49:00,940 --> 00:49:06,360
<font color="#CCCCCC">do that that testing</font><font color="#E5E5E5"> so I'm not sure</font><font color="#CCCCCC"> I</font>

1098
00:49:03,100 --> 00:49:06,360
don't<font color="#E5E5E5"> know that answer</font><font color="#CCCCCC"> I'm sorry</font>

1099
00:49:09,240 --> 00:49:16,580
[Applause]

