1
00:00:00,000 --> 00:00:02,060
you

2
00:00:04,590 --> 00:00:09,420
our speaker is German hi thank you very

3
00:00:09,420 --> 00:00:11,670
much for coming my name is Jeff Markham

4
00:00:11,670 --> 00:00:14,280
I work at Mozilla where my title is

5
00:00:14,280 --> 00:00:16,289
policy engineer I also have a long-term

6
00:00:16,289 --> 00:00:17,970
cough so if I cough a bit don't worry

7
00:00:17,970 --> 00:00:19,710
about that if I actually collapse on the

8
00:00:19,710 --> 00:00:21,630
ground then feel free to call an

9
00:00:21,630 --> 00:00:23,520
ambulance anything short of that I will

10
00:00:23,520 --> 00:00:26,760
recover momentarily today I'm going to

11
00:00:26,760 --> 00:00:28,890
be talking about the Mozilla root

12
00:00:28,890 --> 00:00:31,320
program which is our program for

13
00:00:31,320 --> 00:00:34,379
managing certificate authorities and a

14
00:00:34,379 --> 00:00:36,510
little bit about how it works what we do

15
00:00:36,510 --> 00:00:40,050
how we do what we do and then all in the

16
00:00:40,050 --> 00:00:41,280
second half of the talk I'll go through

17
00:00:41,280 --> 00:00:42,629
some particular incidents that have

18
00:00:42,629 --> 00:00:44,969
happened in the CA world and their sort

19
00:00:44,969 --> 00:00:47,219
of policy responses that we have made to

20
00:00:47,219 --> 00:00:49,050
those incidents and possible future

21
00:00:49,050 --> 00:00:50,909
stuff and then hopefully we'll have some

22
00:00:50,909 --> 00:00:53,940
time for questions I'll going to try and

23
00:00:53,940 --> 00:00:56,190
speak clearly if quite fast but if I'm

24
00:00:56,190 --> 00:00:58,289
going too fast for you wave at me and

25
00:00:58,289 --> 00:01:02,999
let me know so as background if you want

26
00:01:02,999 --> 00:01:06,420
to establish over an untrusted Network a

27
00:01:06,420 --> 00:01:09,180
connection to a particular person on the

28
00:01:09,180 --> 00:01:11,759
other side there are roughly three ways

29
00:01:11,759 --> 00:01:13,649
that you can do it the first is

30
00:01:13,649 --> 00:01:15,360
out-of-band so you give them a phone

31
00:01:15,360 --> 00:01:16,890
call or you send them a letter or

32
00:01:16,890 --> 00:01:18,920
something to exchange some information

33
00:01:18,920 --> 00:01:22,259
that you can use to identify them when

34
00:01:22,259 --> 00:01:23,700
you make a connection over the untrusted

35
00:01:23,700 --> 00:01:25,500
Network and make sure that you're

36
00:01:25,500 --> 00:01:27,509
actually connecting to the person you

37
00:01:27,509 --> 00:01:30,630
hope to connect to the second way is

38
00:01:30,630 --> 00:01:33,570
called trust on first use or tofu which

39
00:01:33,570 --> 00:01:35,399
is normally what outer band ends up

40
00:01:35,399 --> 00:01:37,560
being in practice where you just connect

41
00:01:37,560 --> 00:01:38,729
for the first time over the untrusted

42
00:01:38,729 --> 00:01:40,560
Network and you get through to somebody

43
00:01:40,560 --> 00:01:43,020
and then you hope that that's the right

44
00:01:43,020 --> 00:01:44,820
person and then next time you just

45
00:01:44,820 --> 00:01:46,680
connect your connect you check your

46
00:01:46,680 --> 00:01:48,179
connecting to the same person you

47
00:01:48,179 --> 00:01:51,960
connected to last time but the third way

48
00:01:51,960 --> 00:01:54,000
is to have a trusted third party

49
00:01:54,000 --> 00:01:56,340
somebody you trust and somebody the

50
00:01:56,340 --> 00:01:59,039
other side trusts who can issue kind of

51
00:01:59,039 --> 00:02:01,740
tokens of identity and then you check

52
00:02:01,740 --> 00:02:03,479
when you get the token of identity back

53
00:02:03,479 --> 00:02:05,369
from the person you connect to whether

54
00:02:05,369 --> 00:02:07,140
it was correctly issued by the person

55
00:02:07,140 --> 00:02:09,270
you trust and if so you assume you're

56
00:02:09,270 --> 00:02:11,250
making the right connection to the

57
00:02:11,250 --> 00:02:13,800
person you want to and on the Internet

58
00:02:13,800 --> 00:02:15,750
at least trusted third party is most

59
00:02:15,750 --> 00:02:17,640
commonly implemented using

60
00:02:17,640 --> 00:02:21,090
system of digital certificates the

61
00:02:21,090 --> 00:02:23,640
advantages of this system are that

62
00:02:23,640 --> 00:02:26,490
minimal user interaction is required if

63
00:02:26,490 --> 00:02:28,350
I want to correct connect to a new

64
00:02:28,350 --> 00:02:30,330
website I've never connected before -

65
00:02:30,330 --> 00:02:32,430
and I want to connect securely I type

66
00:02:32,430 --> 00:02:34,830
the address into my browser with an HTTP

67
00:02:34,830 --> 00:02:36,630
on the front and it connects me up and

68
00:02:36,630 --> 00:02:38,490
assuming my browser doesn't sort of set

69
00:02:38,490 --> 00:02:40,440
off warning alarms I can be pretty

70
00:02:40,440 --> 00:02:42,270
confident I'm connecting to the right

71
00:02:42,270 --> 00:02:42,720
place

72
00:02:42,720 --> 00:02:46,200
now you can argue about the various

73
00:02:46,200 --> 00:02:47,489
different systems and their pros and

74
00:02:47,489 --> 00:02:49,530
cons but I would say at the very least

75
00:02:49,530 --> 00:02:52,290
that fact the fact that your grandmother

76
00:02:52,290 --> 00:02:54,780
your grandfather someone who is not

77
00:02:54,780 --> 00:02:57,300
technologically savvy can make secure

78
00:02:57,300 --> 00:02:59,070
connections without having to know

79
00:02:59,070 --> 00:03:01,470
anything about computer security is the

80
00:03:01,470 --> 00:03:04,290
reason why this system is primarily the

81
00:03:04,290 --> 00:03:05,730
system used on the web and is used for

82
00:03:05,730 --> 00:03:07,620
secure web connections and is used in

83
00:03:07,620 --> 00:03:09,540
many other environments as well because

84
00:03:09,540 --> 00:03:12,150
if you if your gran grandparent of some

85
00:03:12,150 --> 00:03:14,400
sort had to phone up their bank and get

86
00:03:14,400 --> 00:03:15,989
their bank to read them the Scharf if

87
00:03:15,989 --> 00:03:18,000
256 fingerprints which they then had to

88
00:03:18,000 --> 00:03:21,810
manually verify against the key that had

89
00:03:21,810 --> 00:03:23,670
been used in the connection they were

90
00:03:23,670 --> 00:03:25,320
establishing with their bank what would

91
00:03:25,320 --> 00:03:26,610
happen would be that no one would ever

92
00:03:26,610 --> 00:03:28,680
bother to do that and lots of people's

93
00:03:28,680 --> 00:03:31,440
data would be stolen but I'd say that's

94
00:03:31,440 --> 00:03:32,730
the main advantage of certificate

95
00:03:32,730 --> 00:03:35,130
systems but today is not about whether

96
00:03:35,130 --> 00:03:36,420
we should replace them as something else

97
00:03:36,420 --> 00:03:38,190
today is about how we deal with the

98
00:03:38,190 --> 00:03:41,940
world as we have it today so if you are

99
00:03:41,940 --> 00:03:44,310
going to have trusted third parties is

100
00:03:44,310 --> 00:03:46,170
that helping you to establish your

101
00:03:46,170 --> 00:03:48,180
secure connections then you need to have

102
00:03:48,180 --> 00:03:50,160
a list of the third parties that you

103
00:03:50,160 --> 00:03:53,180
trust and that is called a root program

104
00:03:53,180 --> 00:03:56,310
you can have root programs for trusting

105
00:03:56,310 --> 00:03:58,049
people for server-to-server connections

106
00:03:58,049 --> 00:04:00,180
you can have root programs for trusting

107
00:04:00,180 --> 00:04:02,549
people for signing of code so you know

108
00:04:02,549 --> 00:04:03,989
who wrote the code you're going to run

109
00:04:03,989 --> 00:04:05,489
on your computer you even have root

110
00:04:05,489 --> 00:04:06,900
programs for trusting the signing of

111
00:04:06,900 --> 00:04:09,150
documents or for email some root

112
00:04:09,150 --> 00:04:11,310
programs cover more than one thing the

113
00:04:11,310 --> 00:04:12,900
Mozilla root program for example covers

114
00:04:12,900 --> 00:04:14,670
server-to-server communication and it

115
00:04:14,670 --> 00:04:16,410
covers email it used to cover code

116
00:04:16,410 --> 00:04:17,789
signing but we found out that no one

117
00:04:17,789 --> 00:04:20,450
really cared so we stopped doing that

118
00:04:20,450 --> 00:04:24,210
who has one well all of the operating

119
00:04:24,210 --> 00:04:26,669
system vendors have a trusted root store

120
00:04:26,669 --> 00:04:29,010
built in so Microsoft has one Apple has

121
00:04:29,010 --> 00:04:32,330
one Google has one for Android

122
00:04:32,330 --> 00:04:38,300
also Oracle has one for Java Adobe has

123
00:04:38,300 --> 00:04:39,710
one although it's focused on document

124
00:04:39,710 --> 00:04:42,590
signing and Mozilla has one for Firefox

125
00:04:42,590 --> 00:04:45,230
because unlike Chrome which delegates

126
00:04:45,230 --> 00:04:47,210
these decisions to the operating system

127
00:04:47,210 --> 00:04:50,050
although it may make some tweaks to them

128
00:04:50,050 --> 00:04:53,180
Firefox uses its own built-in store of

129
00:04:53,180 --> 00:04:57,980
routes and so a CA which is trusted on

130
00:04:57,980 --> 00:05:00,590
Firefox is trusted everywhere on every

131
00:05:00,590 --> 00:05:02,690
operating system so we have consistency

132
00:05:02,690 --> 00:05:07,700
across Firefox across the OSS and the

133
00:05:07,700 --> 00:05:09,110
reason there is more than one of these

134
00:05:09,110 --> 00:05:10,820
route programs is that it's probably not

135
00:05:10,820 --> 00:05:12,950
a great idea for one single world

136
00:05:12,950 --> 00:05:15,110
authority to determine who everybody in

137
00:05:15,110 --> 00:05:17,000
the world trusts people want to make

138
00:05:17,000 --> 00:05:19,010
different decisions about who they think

139
00:05:19,010 --> 00:05:20,960
is trustworthy and who they think is not

140
00:05:20,960 --> 00:05:22,850
trustworthy and in fact you know what

141
00:05:22,850 --> 00:05:24,440
you get with your operating system or

142
00:05:24,440 --> 00:05:25,820
what you get with your browser is a

143
00:05:25,820 --> 00:05:28,400
default set to which you can add or even

144
00:05:28,400 --> 00:05:30,260
remove people if you feel that they are

145
00:05:30,260 --> 00:05:33,440
not worthy of your trust the issues that

146
00:05:33,440 --> 00:05:35,780
that causes of course is that for

147
00:05:35,780 --> 00:05:37,700
technical and historical reasons when a

148
00:05:37,700 --> 00:05:40,040
web site presents a certificate to

149
00:05:40,040 --> 00:05:42,140
anybody who connects to it normally

150
00:05:42,140 --> 00:05:43,820
except in special circumstances they can

151
00:05:43,820 --> 00:05:45,650
only present one certificate and

152
00:05:45,650 --> 00:05:47,360
therefore they want to present a

153
00:05:47,360 --> 00:05:49,250
certificate which is many people as

154
00:05:49,250 --> 00:05:50,990
possible who are trying to connect to

155
00:05:50,990 --> 00:05:53,930
them trust because otherwise as some

156
00:05:53,930 --> 00:05:55,880
proportion of that supposed customers

157
00:05:55,880 --> 00:05:57,950
will get error messages and be scared

158
00:05:57,950 --> 00:06:00,080
away from using their website this P of

159
00:06:00,080 --> 00:06:02,060
CAS certificate authorities the problem

160
00:06:02,060 --> 00:06:03,860
of ubiquity they would like to be in

161
00:06:03,860 --> 00:06:05,720
everybody's trust store they would like

162
00:06:05,720 --> 00:06:07,970
to be trusted by everyone and they would

163
00:06:07,970 --> 00:06:09,800
like that to have worked its way through

164
00:06:09,800 --> 00:06:12,320
the ecosystem so even old versions of

165
00:06:12,320 --> 00:06:14,540
Windows or old versions of Mac OS or old

166
00:06:14,540 --> 00:06:16,790
versions of Firefox have that trust so

167
00:06:16,790 --> 00:06:18,530
if you're setting up as a certificate

168
00:06:18,530 --> 00:06:20,420
authority unless you can find some way

169
00:06:20,420 --> 00:06:21,800
of bootstrapping yourself and we can

170
00:06:21,800 --> 00:06:24,020
come to that you have a very long lead

171
00:06:24,020 --> 00:06:27,230
time before your trust is ubiquitous

172
00:06:27,230 --> 00:06:28,760
enough among all of the different

173
00:06:28,760 --> 00:06:30,590
clients that people will even want to

174
00:06:30,590 --> 00:06:34,040
use your certificates why is Mozilla's

175
00:06:34,040 --> 00:06:36,200
root program different we run our root

176
00:06:36,200 --> 00:06:37,670
program in an open and transparent

177
00:06:37,670 --> 00:06:39,890
manner we feel that it's very important

178
00:06:39,890 --> 00:06:41,810
for the Internet that at least one root

179
00:06:41,810 --> 00:06:42,780
program

180
00:06:42,780 --> 00:06:45,060
in a way which listens to in takes

181
00:06:45,060 --> 00:06:47,550
account of the views of the internet

182
00:06:47,550 --> 00:06:49,350
community where the processes and

183
00:06:49,350 --> 00:06:51,900
procedures are open and people can

184
00:06:51,900 --> 00:06:53,340
suggest modifications and improvements

185
00:06:53,340 --> 00:06:55,440
the way that we do things that when

186
00:06:55,440 --> 00:06:57,030
we're considering adding someone to the

187
00:06:57,030 --> 00:06:58,710
trust list that is an open and

188
00:06:58,710 --> 00:07:00,570
discussion process whether is discussion

189
00:07:00,570 --> 00:07:02,280
and when we're considering taking

190
00:07:02,280 --> 00:07:04,470
someone off and whether that is the

191
00:07:04,470 --> 00:07:06,450
right reaction or not to some perceived

192
00:07:06,450 --> 00:07:09,480
crime or error or mistake we should have

193
00:07:09,480 --> 00:07:11,250
a discussion about that and so that is

194
00:07:11,250 --> 00:07:13,410
how our route program is different and

195
00:07:13,410 --> 00:07:16,290
in fact actually that influences the

196
00:07:16,290 --> 00:07:18,419
community of Route programs to be more

197
00:07:18,419 --> 00:07:22,550
open than they used to be certainly so

198
00:07:22,550 --> 00:07:24,870
just a little terminology to make sure

199
00:07:24,870 --> 00:07:25,950
we're all on the right page about

200
00:07:25,950 --> 00:07:27,240
certificates when they talk about them

201
00:07:27,240 --> 00:07:29,880
later certificates come in hierarchies

202
00:07:29,880 --> 00:07:32,220
they start with the roots at the top

203
00:07:32,220 --> 00:07:35,520
which are embedded in the browser or the

204
00:07:35,520 --> 00:07:37,110
operating system with the other trusting

205
00:07:37,110 --> 00:07:39,240
thing but normally you want your root

206
00:07:39,240 --> 00:07:40,860
certificates to be locked up in a bank

207
00:07:40,860 --> 00:07:42,660
vault somewhere because you really don't

208
00:07:42,660 --> 00:07:44,550
want them misused and so what happens is

209
00:07:44,550 --> 00:07:45,750
that the root sign what are called

210
00:07:45,750 --> 00:07:47,729
intermediate certificates of which there

211
00:07:47,729 --> 00:07:49,470
may be a number and those are the ones

212
00:07:49,470 --> 00:07:51,360
that you keep in your data center which

213
00:07:51,360 --> 00:07:53,340
are then themselves signing the end

214
00:07:53,340 --> 00:07:55,020
entity certificates which you hand out

215
00:07:55,020 --> 00:07:57,419
to people who own websites or who own

216
00:07:57,419 --> 00:07:59,640
email addresses or who want to sign code

217
00:07:59,640 --> 00:08:01,260
or whatever it is that you're doing

218
00:08:01,260 --> 00:08:03,360
so that's roots and intermediates and

219
00:08:03,360 --> 00:08:06,060
end NC certificates and if you're a new

220
00:08:06,060 --> 00:08:08,669
CA who wants to get into the markets you

221
00:08:08,669 --> 00:08:10,530
might pay another CA a very large amount

222
00:08:10,530 --> 00:08:12,510
of money to get them to do what's called

223
00:08:12,510 --> 00:08:14,850
a cross certificate which is where their

224
00:08:14,850 --> 00:08:17,490
route signs your route and so stuff that

225
00:08:17,490 --> 00:08:19,500
you're issuing is trusted in older

226
00:08:19,500 --> 00:08:20,940
browsers which don't have your route

227
00:08:20,940 --> 00:08:22,710
built-in because there's an alternate

228
00:08:22,710 --> 00:08:25,680
path up to theirs so that's called a

229
00:08:25,680 --> 00:08:29,010
cross certificate what policy tools do

230
00:08:29,010 --> 00:08:32,159
we have for managing our interactions

231
00:08:32,159 --> 00:08:33,929
with certificate authorities and

232
00:08:33,929 --> 00:08:36,390
managing this trusted list well every

233
00:08:36,390 --> 00:08:38,490
certificate authority for each route has

234
00:08:38,490 --> 00:08:41,580
what's called a CPS and a CP which are

235
00:08:41,580 --> 00:08:43,080
two documents of the difference between

236
00:08:43,080 --> 00:08:44,580
which is a bit geeky and technical but

237
00:08:44,580 --> 00:08:46,650
basically together they define the

238
00:08:46,650 --> 00:08:48,750
processes that the CA will use for

239
00:08:48,750 --> 00:08:49,800
issuing certificates we're going to

240
00:08:49,800 --> 00:08:51,120
issue them this way to this sort of

241
00:08:51,120 --> 00:08:53,010
person we're going to keep our data

242
00:08:53,010 --> 00:08:55,250
centers like this and so on and so forth

243
00:08:55,250 --> 00:08:56,410
there

244
00:08:56,410 --> 00:08:58,269
also an international organization

245
00:08:58,269 --> 00:08:59,949
called web trust and another European

246
00:08:59,949 --> 00:09:01,959
organization called Etsy which produce

247
00:09:01,959 --> 00:09:04,180
standards for certificate authorities as

248
00:09:04,180 --> 00:09:06,550
to how they should behave often that is

249
00:09:06,550 --> 00:09:08,500
you should do what you say on your CP

250
00:09:08,500 --> 00:09:10,569
and CPS and will check that you do and a

251
00:09:10,569 --> 00:09:12,730
little less than we would like about the

252
00:09:12,730 --> 00:09:14,139
thing you say that you're going to do is

253
00:09:14,139 --> 00:09:16,029
actually the right thing and sane but

254
00:09:16,029 --> 00:09:17,649
nevertheless there are these standards

255
00:09:17,649 --> 00:09:19,870
an organisation called the C a browser

256
00:09:19,870 --> 00:09:22,839
forum which is an informal collection of

257
00:09:22,839 --> 00:09:25,000
the major CAS and the major routes doors

258
00:09:25,000 --> 00:09:27,779
also produces a couple of standards and

259
00:09:27,779 --> 00:09:30,519
all of these standards are audited so

260
00:09:30,519 --> 00:09:33,189
every year a CA has an auditor from one

261
00:09:33,189 --> 00:09:35,050
of the from an audit firm come and visit

262
00:09:35,050 --> 00:09:36,670
and check that the things that they're

263
00:09:36,670 --> 00:09:38,649
doing match the requirements in all of

264
00:09:38,649 --> 00:09:40,420
these documents and the reason they have

265
00:09:40,420 --> 00:09:42,129
to do that the reason those documents

266
00:09:42,129 --> 00:09:44,230
and those audits have teeth is because

267
00:09:44,230 --> 00:09:46,689
each root program has a policy that if

268
00:09:46,689 --> 00:09:49,180
you want to be in our trusted list you

269
00:09:49,180 --> 00:09:51,339
have to have this sort of audit and this

270
00:09:51,339 --> 00:09:53,019
sort of audit and this sort of audit and

271
00:09:53,019 --> 00:09:54,670
you need to show us the documentation

272
00:09:54,670 --> 00:09:56,410
that shows that you've got them and that

273
00:09:56,410 --> 00:09:58,319
you passed

274
00:09:58,319 --> 00:10:01,600
so root program policy defines what we

275
00:10:01,600 --> 00:10:04,209
expect of CAS but also the audits that

276
00:10:04,209 --> 00:10:06,850
they have to have and therefore someone

277
00:10:06,850 --> 00:10:08,529
goes on to their premises and to some

278
00:10:08,529 --> 00:10:10,360
degree at least checks that they're

279
00:10:10,360 --> 00:10:11,529
doing all of the things that they're

280
00:10:11,529 --> 00:10:14,290
supposed to do one could argue about how

281
00:10:14,290 --> 00:10:16,660
effective those checks are but this is

282
00:10:16,660 --> 00:10:19,089
these other tools that we have the other

283
00:10:19,089 --> 00:10:21,069
policy tool that we have actually is

284
00:10:21,069 --> 00:10:22,509
changing the user interface of our

285
00:10:22,509 --> 00:10:25,089
product and/or its capabilities so in

286
00:10:25,089 --> 00:10:27,459
Firefox at least we can eliminate older

287
00:10:27,459 --> 00:10:29,529
algorithms or you know deprecated them

288
00:10:29,529 --> 00:10:31,120
or put warnings in for them to try and

289
00:10:31,120 --> 00:10:33,519
encourage people to stop using them and

290
00:10:33,519 --> 00:10:37,720
we can do things like so when Firefox

291
00:10:37,720 --> 00:10:39,430
connects to a secure site there are

292
00:10:39,430 --> 00:10:41,500
effectively only two states that can be

293
00:10:41,500 --> 00:10:43,660
in there's a state with which uses

294
00:10:43,660 --> 00:10:44,680
difficult they're called extended

295
00:10:44,680 --> 00:10:47,500
validation where the name the actual

296
00:10:47,500 --> 00:10:49,029
name of the business has been carefully

297
00:10:49,029 --> 00:10:51,040
checked by the CA and then we put that

298
00:10:51,040 --> 00:10:53,319
in the URL bar normally in green so it

299
00:10:53,319 --> 00:10:58,139
says this is you know B and Q or this is

300
00:10:58,139 --> 00:11:02,470
PayPal or this is amazon.com Inc in the

301
00:11:02,470 --> 00:11:04,300
in the in the top and then there's

302
00:11:04,300 --> 00:11:06,670
everything else now CAS have other sort

303
00:11:06,670 --> 00:11:08,439
of gray dated levels and validation that

304
00:11:08,439 --> 00:11:09,620
they managed to sell

305
00:11:09,620 --> 00:11:11,210
people but that doesn't change the

306
00:11:11,210 --> 00:11:12,980
browser UI so I'm not quite sure why

307
00:11:12,980 --> 00:11:15,560
people pay for the extra levels but I'm

308
00:11:15,560 --> 00:11:18,350
not in a CAS marketing department so

309
00:11:18,350 --> 00:11:20,210
those are the policy tools we have in

310
00:11:20,210 --> 00:11:23,570
broad-brush for managing the behavior of

311
00:11:23,570 --> 00:11:27,130
certificate authorities for re program

312
00:11:27,130 --> 00:11:30,500
so mozilla is keen to use our power

313
00:11:30,500 --> 00:11:32,870
because CA is want to be in our store so

314
00:11:32,870 --> 00:11:34,550
that their certificates will be trusted

315
00:11:34,550 --> 00:11:36,350
by firefox so they'll be able to sell

316
00:11:36,350 --> 00:11:39,050
them so people will be able to connect

317
00:11:39,050 --> 00:11:40,460
using firefox to their things and that

318
00:11:40,460 --> 00:11:43,000
power that we have allows us to drive

319
00:11:43,000 --> 00:11:45,650
improvements in the certificate system

320
00:11:45,650 --> 00:11:47,000
and in the authority of the web in the

321
00:11:47,000 --> 00:11:49,550
security of the web some of the previous

322
00:11:49,550 --> 00:11:50,870
improvements we've managed to drive

323
00:11:50,870 --> 00:11:53,390
either by acting unilaterally or by

324
00:11:53,390 --> 00:11:55,339
acting with other browsers or by acting

325
00:11:55,339 --> 00:11:57,410
through the c a browser forum have been

326
00:11:57,410 --> 00:11:58,490
things like the first thing the see a

327
00:11:58,490 --> 00:12:00,650
browser forum did was this extended

328
00:12:00,650 --> 00:12:02,750
validation standard so you can argue

329
00:12:02,750 --> 00:12:05,120
about the value of having information

330
00:12:05,120 --> 00:12:07,250
about these sort of physical location

331
00:12:07,250 --> 00:12:08,750
and address and so all of a company in a

332
00:12:08,750 --> 00:12:11,089
certificate but if that is valuable to

333
00:12:11,089 --> 00:12:12,710
you then you definitely want that

334
00:12:12,710 --> 00:12:15,230
information to be correct and it used to

335
00:12:15,230 --> 00:12:17,089
be the case that cas were doing things

336
00:12:17,089 --> 00:12:19,010
like yes I'll accept a doggedly faxed

337
00:12:19,010 --> 00:12:21,380
copy of some phone bill to show that

338
00:12:21,380 --> 00:12:23,810
this is your address right and some CAS

339
00:12:23,810 --> 00:12:25,940
were trying to do better but of course

340
00:12:25,940 --> 00:12:28,610
because doing better costs more there

341
00:12:28,610 --> 00:12:30,740
was a race to the bottom problem and so

342
00:12:30,740 --> 00:12:32,360
this is difficult the see a browser

343
00:12:32,360 --> 00:12:33,830
forum got together and produced a set of

344
00:12:33,830 --> 00:12:35,900
what we think are minimum standards for

345
00:12:35,900 --> 00:12:38,709
the vetting of actual real life identity

346
00:12:38,709 --> 00:12:41,930
and called it extended validation so

347
00:12:41,930 --> 00:12:44,480
many CA still use lowest standards but

348
00:12:44,480 --> 00:12:46,250
we don't trust those enough to display

349
00:12:46,250 --> 00:12:48,910
that information in our browser so

350
00:12:48,910 --> 00:12:51,080
extended validation is what we think is

351
00:12:51,080 --> 00:12:53,600
necessary for to actually have a real

352
00:12:53,600 --> 00:12:55,250
world identity written into a

353
00:12:55,250 --> 00:12:56,990
certificate so those standards were

354
00:12:56,990 --> 00:12:58,790
defined we started those in 2007 they

355
00:12:58,790 --> 00:13:01,100
finished in 2009 another thing we did

356
00:13:01,100 --> 00:13:03,110
was eliminate the use of 1024 bit RSA

357
00:13:03,110 --> 00:13:07,220
certificates so we had to drive them out

358
00:13:07,220 --> 00:13:09,230
by stopping ca's issuing end entity

359
00:13:09,230 --> 00:13:11,120
certificates like that and then we had

360
00:13:11,120 --> 00:13:12,470
to get them to rollover all their

361
00:13:12,470 --> 00:13:14,150
intermediates and then we had to get

362
00:13:14,150 --> 00:13:15,890
them to stop using 1024 bit roots

363
00:13:15,890 --> 00:13:18,230
because we started started to become

364
00:13:18,230 --> 00:13:21,380
clear that a well-motivated state level

365
00:13:21,380 --> 00:13:22,459
attacker with a large amount of

366
00:13:22,459 --> 00:13:23,560
computing power

367
00:13:23,560 --> 00:13:25,810
mentioning no names may be getting close

368
00:13:25,810 --> 00:13:28,149
to factoring 1024-bit certificates and

369
00:13:28,149 --> 00:13:30,279
if they could factor one 1024-bit

370
00:13:30,279 --> 00:13:32,019
certificate that was still in our root

371
00:13:32,019 --> 00:13:33,610
store they could generate as many

372
00:13:33,610 --> 00:13:35,230
certificates under that as they wanted

373
00:13:35,230 --> 00:13:37,329
and our browser would trust them so it

374
00:13:37,329 --> 00:13:38,560
was definitely time to move away from

375
00:13:38,560 --> 00:13:41,160
that but that was a multi-year effort

376
00:13:41,160 --> 00:13:43,600
around about and we'll get to exactly

377
00:13:43,600 --> 00:13:47,079
when and why 2010 or 2011 the CI browser

378
00:13:47,079 --> 00:13:48,639
forum produced a document called the

379
00:13:48,639 --> 00:13:50,649
baseline requirements which were a set

380
00:13:50,649 --> 00:13:52,360
of things that everybody has to do for

381
00:13:52,360 --> 00:13:54,370
the issuance of any certificate so this

382
00:13:54,370 --> 00:13:56,199
was just for certificates which contain

383
00:13:56,199 --> 00:13:58,180
real world identity but this is like

384
00:13:58,180 --> 00:14:01,959
anything that you do and so that was

385
00:14:01,959 --> 00:14:03,699
definitely a way of driving up the lower

386
00:14:03,699 --> 00:14:05,889
bound of certificate authority behavior

387
00:14:05,889 --> 00:14:08,139
and making sure that everyone did things

388
00:14:08,139 --> 00:14:12,009
that were at least vaguely sane the the

389
00:14:12,009 --> 00:14:14,050
world of intermediates so we have the

390
00:14:14,050 --> 00:14:15,550
roots which we know about then are

391
00:14:15,550 --> 00:14:16,809
trusted or but then the CA can issue any

392
00:14:16,809 --> 00:14:18,699
number of intermediates and you don't

393
00:14:18,699 --> 00:14:20,470
necessarily always see all of those and

394
00:14:20,470 --> 00:14:23,019
don't know what they're doing and so we

395
00:14:23,019 --> 00:14:24,670
came up with a policy a few years ago

396
00:14:24,670 --> 00:14:26,379
where CAS had to disclose all that

397
00:14:26,379 --> 00:14:28,509
intermediates to us in a database so we

398
00:14:28,509 --> 00:14:30,939
knew about all of those or technically

399
00:14:30,939 --> 00:14:32,230
constrain them so that they couldn't

400
00:14:32,230 --> 00:14:34,720
issue for random sites on the Internet

401
00:14:34,720 --> 00:14:38,040
so that was a policy that we we drove

402
00:14:38,040 --> 00:14:40,329
recently they've been improvements and

403
00:14:40,329 --> 00:14:42,069
much more rigor in domain validation

404
00:14:42,069 --> 00:14:43,660
methods which are the methods of

405
00:14:43,660 --> 00:14:46,079
determining whether somebody owns

406
00:14:46,079 --> 00:14:48,910
example.com or PayPal comm order over

407
00:14:48,910 --> 00:14:50,920
net or whatever because obviously the

408
00:14:50,920 --> 00:14:52,360
key thing a CA does before issuing

409
00:14:52,360 --> 00:14:54,069
certificate is check that the guy

410
00:14:54,069 --> 00:14:55,059
they're giving the certificate to

411
00:14:55,059 --> 00:14:57,699
actually owns the domain names which are

412
00:14:57,699 --> 00:14:59,500
in the certificate that's like the basic

413
00:14:59,500 --> 00:15:01,000
most important thing that they do and

414
00:15:01,000 --> 00:15:03,220
exactly how they were doing that was a

415
00:15:03,220 --> 00:15:05,680
wide variety of methods which had quite

416
00:15:05,680 --> 00:15:08,170
a lot of kind of slop in the definition

417
00:15:08,170 --> 00:15:09,879
of how they did it and so we came up

418
00:15:09,879 --> 00:15:11,350
with best practices for all of those

419
00:15:11,350 --> 00:15:13,540
styles of method documented those and

420
00:15:13,540 --> 00:15:14,860
those are now in the baseline

421
00:15:14,860 --> 00:15:17,829
requirements we've also driven on policy

422
00:15:17,829 --> 00:15:21,189
improvements through the changes to

423
00:15:21,189 --> 00:15:22,629
Firefox primarily in the use of

424
00:15:22,629 --> 00:15:26,170
cryptographic algorithms upcoming things

425
00:15:26,170 --> 00:15:27,970
that we're hoping to do through this

426
00:15:27,970 --> 00:15:30,129
route program power that we have there's

427
00:15:30,129 --> 00:15:32,319
a standard called certificate authority

428
00:15:32,319 --> 00:15:35,500
access or CAA which is where you put in

429
00:15:35,500 --> 00:15:36,470
your DNS

430
00:15:36,470 --> 00:15:38,540
a list of these certificate authorities

431
00:15:38,540 --> 00:15:40,970
that you want to allow for your domain

432
00:15:40,970 --> 00:15:42,980
this is a way of trying to solve the

433
00:15:42,980 --> 00:15:45,080
weakest link problem if there are 60

434
00:15:45,080 --> 00:15:48,230
trusted CAS and one of them sucks that

435
00:15:48,230 --> 00:15:49,730
one can issue certificates for your

436
00:15:49,730 --> 00:15:51,020
domain and you can't do anything about

437
00:15:51,020 --> 00:15:53,150
it so it's the difficult Authority

438
00:15:53,150 --> 00:15:54,710
access is an attempt to solve that

439
00:15:54,710 --> 00:15:56,510
problem by allowing sites to say no I

440
00:15:56,510 --> 00:15:58,460
only want certificates from Symantec or

441
00:15:58,460 --> 00:16:00,410
only Komodo and did you search or only

442
00:16:00,410 --> 00:16:02,810
let's encrypt but the trouble is of

443
00:16:02,810 --> 00:16:04,220
course that this hasn't really taken off

444
00:16:04,220 --> 00:16:07,670
because CAS aren't required yet to read

445
00:16:07,670 --> 00:16:09,890
and abide by that information and

446
00:16:09,890 --> 00:16:12,500
they're not very keen to do that for

447
00:16:12,500 --> 00:16:14,840
various reasons but we want to make it

448
00:16:14,840 --> 00:16:16,700
mandatory to change this we're trying to

449
00:16:16,700 --> 00:16:18,140
push that through the Sierra as a forum

450
00:16:18,140 --> 00:16:20,750
now but if we don't manage to succeed we

451
00:16:20,750 --> 00:16:22,250
may well take unilateral action and

452
00:16:22,250 --> 00:16:25,340
require it anyway Google has come up

453
00:16:25,340 --> 00:16:26,180
with a system called certificate

454
00:16:26,180 --> 00:16:28,670
transparency which is a way of trying to

455
00:16:28,670 --> 00:16:30,700
make sure that CA is disclosed publicly

456
00:16:30,700 --> 00:16:33,320
every certificate they issue it's not

457
00:16:33,320 --> 00:16:34,940
fully implemented yet so it's only used

458
00:16:34,940 --> 00:16:36,350
for a subset of certificates but it's

459
00:16:36,350 --> 00:16:38,330
already been extremely useful in finding

460
00:16:38,330 --> 00:16:42,280
issuances of problems that CAS have been

461
00:16:42,280 --> 00:16:44,330
thinking bad things that CAS have been

462
00:16:44,330 --> 00:16:46,370
doing Mozilla has some issues with the

463
00:16:46,370 --> 00:16:47,870
scalability of that system and how you

464
00:16:47,870 --> 00:16:50,210
can get certain guarantees that the log

465
00:16:50,210 --> 00:16:51,410
servers are actually going to behave

466
00:16:51,410 --> 00:16:53,210
properly and so we're proposing some

467
00:16:53,210 --> 00:16:55,040
modifications to it and that process is

468
00:16:55,040 --> 00:16:56,750
ongoing but we may we'll end up doing

469
00:16:56,750 --> 00:16:59,210
something like that and for reasons

470
00:16:59,210 --> 00:17:03,440
which we will come to we're feeling that

471
00:17:03,440 --> 00:17:07,190
the audit process is not as good as it

472
00:17:07,190 --> 00:17:08,540
could be because what happens is of

473
00:17:08,540 --> 00:17:10,609
course a CA employees an audit firm to

474
00:17:10,609 --> 00:17:12,500
do its audits and that audit firm would

475
00:17:12,500 --> 00:17:13,790
love to be employed again the following

476
00:17:13,790 --> 00:17:15,920
year and so is keen to make sure that

477
00:17:15,920 --> 00:17:17,750
gives the CA a clean bill of health and

478
00:17:17,750 --> 00:17:19,640
then that relationship has various

479
00:17:19,640 --> 00:17:21,560
professional obligations which means

480
00:17:21,560 --> 00:17:22,910
that they can't really audit for them

481
00:17:22,910 --> 00:17:23,900
say they can't really tell us anything

482
00:17:23,900 --> 00:17:25,430
about what happened apart from the fact

483
00:17:25,430 --> 00:17:27,319
that they passed and we think this kind

484
00:17:27,319 --> 00:17:28,369
of sucks and we need more transparency

485
00:17:28,369 --> 00:17:30,260
so we're trying to work out how to

486
00:17:30,260 --> 00:17:34,400
improve those mechanisms and recently as

487
00:17:34,400 --> 00:17:36,470
we'll come to we stopped accepting

488
00:17:36,470 --> 00:17:38,030
audits from one particular audit firm

489
00:17:38,030 --> 00:17:40,520
which we hope will generally galvanize

490
00:17:40,520 --> 00:17:41,900
audit firms to make sure they're doing a

491
00:17:41,900 --> 00:17:45,470
good job so that sort of a broad and

492
00:17:45,470 --> 00:17:47,630
very quick overview of the route program

493
00:17:47,630 --> 00:17:49,190
and what we do and what kind of things

494
00:17:49,190 --> 00:17:50,330
were trying to achieve with it

495
00:17:50,330 --> 00:17:52,040
and now I want to talk about some of the

496
00:17:52,040 --> 00:17:53,390
incidents that have happened in the past

497
00:17:53,390 --> 00:17:55,070
five years in the certificate authority

498
00:17:55,070 --> 00:17:57,740
space which have led to changes both

499
00:17:57,740 --> 00:18:03,110
technical and policy in 2011 a CA called

500
00:18:03,110 --> 00:18:05,570
Komodo a large CA had what's called a

501
00:18:05,570 --> 00:18:08,180
registration Authority or RA in Italy an

502
00:18:08,180 --> 00:18:10,250
RA is basically a firm that you have

503
00:18:10,250 --> 00:18:12,230
normally in a particular country which

504
00:18:12,230 --> 00:18:14,330
knows how to check that a business as a

505
00:18:14,330 --> 00:18:16,550
business and knows how to do publicity

506
00:18:16,550 --> 00:18:18,320
in those how to advertise and what they

507
00:18:18,320 --> 00:18:19,850
do is they kind of get business for you

508
00:18:19,850 --> 00:18:21,350
and do some of the checking and then

509
00:18:21,350 --> 00:18:22,700
they hand over the information to you

510
00:18:22,700 --> 00:18:24,970
for you to issue the certificate

511
00:18:24,970 --> 00:18:28,300
unfortunately they're the security of

512
00:18:28,300 --> 00:18:30,530
the accounts that they were logging into

513
00:18:30,530 --> 00:18:32,660
at Komodo to issue certificates was very

514
00:18:32,660 --> 00:18:35,179
bad I got caught Komodo hacker found out

515
00:18:35,179 --> 00:18:37,490
the password and issued a bunch of

516
00:18:37,490 --> 00:18:40,190
certificates for major websites which he

517
00:18:40,190 --> 00:18:44,510
then boasted about this also revealed in

518
00:18:44,510 --> 00:18:46,160
fact that Komodo were keeping their root

519
00:18:46,160 --> 00:18:48,380
certificates online so instead of the

520
00:18:48,380 --> 00:18:49,880
intermediate level that we were talking

521
00:18:49,880 --> 00:18:51,650
about they had their root certificates

522
00:18:51,650 --> 00:18:53,270
in the way in the servers that were

523
00:18:53,270 --> 00:18:55,490
issuing the certificates and were just

524
00:18:55,490 --> 00:18:58,309
issuing directly off those Komodo hacker

525
00:18:58,309 --> 00:18:59,870
may or may not have been from Iran

526
00:18:59,870 --> 00:19:01,940
Komodo claimed that he was but if that

527
00:19:01,940 --> 00:19:03,380
may be just cuz they wanted to big up

528
00:19:03,380 --> 00:19:04,730
their problems as being a state-level

529
00:19:04,730 --> 00:19:08,300
adversary not sure so what did we do the

530
00:19:08,300 --> 00:19:10,580
result of this was that we required that

531
00:19:10,580 --> 00:19:12,440
all issuances are pretty much all

532
00:19:12,440 --> 00:19:14,270
assurances had to be via an intermediate

533
00:19:14,270 --> 00:19:16,280
which then means that the CAS can keep

534
00:19:16,280 --> 00:19:17,809
the root certificate offline and reduce

535
00:19:17,809 --> 00:19:19,220
the risk of compromise of the root

536
00:19:19,220 --> 00:19:21,290
certificate key and we also said that

537
00:19:21,290 --> 00:19:23,210
any account to the CA you can login to

538
00:19:23,210 --> 00:19:25,400
as an RA that can cause certificate

539
00:19:25,400 --> 00:19:26,570
issuance has to have two-factor

540
00:19:26,570 --> 00:19:30,740
authentication that was in 2011 2011

541
00:19:30,740 --> 00:19:33,860
still a very famous incident a Dutch ta

542
00:19:33,860 --> 00:19:36,110
called diginotar got comprehensively

543
00:19:36,110 --> 00:19:38,720
pwned by somebody working for the

544
00:19:38,720 --> 00:19:41,179
Iranian government the exact scope of

545
00:19:41,179 --> 00:19:43,640
that was unknown but it was massive they

546
00:19:43,640 --> 00:19:45,590
completely failed to notify any of the

547
00:19:45,590 --> 00:19:47,059
root programs that they had trouble and

548
00:19:47,059 --> 00:19:48,650
instead tried to revoke the certificates

549
00:19:48,650 --> 00:19:49,880
that they found were dodgy and cover it

550
00:19:49,880 --> 00:19:52,520
up but in fact what happened was

551
00:19:52,520 --> 00:19:54,530
certificates that were issued from the

552
00:19:54,530 --> 00:19:56,809
DigiNotar roots were basically used to

553
00:19:56,809 --> 00:19:58,940
man in the middle people in Iran the

554
00:19:58,940 --> 00:20:00,950
company which did the forensic analysis

555
00:20:00,950 --> 00:20:03,200
of diginotar produced this video

556
00:20:03,200 --> 00:20:05,780
which was used which was made because

557
00:20:05,780 --> 00:20:08,440
when you when you use a certificate

558
00:20:08,440 --> 00:20:11,030
often this is your browser will go back

559
00:20:11,030 --> 00:20:12,590
to the CA and go is this certificate

560
00:20:12,590 --> 00:20:15,410
still okay using a protocol called OCSP

561
00:20:15,410 --> 00:20:17,870
and if you can look at those logs you

562
00:20:17,870 --> 00:20:20,060
can geolocate the IP addresses to find

563
00:20:20,060 --> 00:20:22,130
out where in the world people are using

564
00:20:22,130 --> 00:20:24,790
that certificate from

565
00:20:29,390 --> 00:20:33,120
hmm we are really quite washed out here

566
00:20:33,120 --> 00:20:36,840
aren't we let's can we get some of these

567
00:20:36,840 --> 00:20:39,060
lights off briefly are they is it up

568
00:20:39,060 --> 00:20:47,450
here no that's the there we go

569
00:20:47,450 --> 00:20:50,550
all right are you calling it found it

570
00:20:50,550 --> 00:20:57,900
okay that's better the little red dots

571
00:20:57,900 --> 00:21:00,600
are people using the certificate see

572
00:21:00,600 --> 00:21:05,250
where they all are the others we think

573
00:21:05,250 --> 00:21:07,230
of probably would have VPN or tor exit

574
00:21:07,230 --> 00:21:09,300
nodes and that kind of thing but it

575
00:21:09,300 --> 00:21:10,920
seemed pretty clear that the government

576
00:21:10,920 --> 00:21:12,870
of Iran was using these certificates to

577
00:21:12,870 --> 00:21:14,550
man-in-the-middle tens or hundreds of

578
00:21:14,550 --> 00:21:16,980
thousands of people and we have no idea

579
00:21:16,980 --> 00:21:18,840
how many people's security was

580
00:21:18,840 --> 00:21:20,490
compromised and how many people got into

581
00:21:20,490 --> 00:21:22,650
serious physical trouble because of this

582
00:21:22,650 --> 00:21:24,930
when I first saw this video it made me

583
00:21:24,930 --> 00:21:28,920
cry what did we do well we distrusted

584
00:21:28,920 --> 00:21:31,500
the entirety of Digitas organization and

585
00:21:31,500 --> 00:21:32,910
all of the root certificates they had

586
00:21:32,910 --> 00:21:34,980
control of eventually some of them they

587
00:21:34,980 --> 00:21:35,970
were managing for the Dutch government

588
00:21:35,970 --> 00:21:37,500
and the Dutch government did an initial

589
00:21:37,500 --> 00:21:39,210
investigation said no that our stuff is

590
00:21:39,210 --> 00:21:42,540
fine it's okay it's only that other

591
00:21:42,540 --> 00:21:45,090
stuff you can leave ours but it turned

592
00:21:45,090 --> 00:21:45,990
out that that was rubbish

593
00:21:45,990 --> 00:21:48,780
and so we distrusted theirs as well the

594
00:21:48,780 --> 00:21:50,520
baseline requirements had already been

595
00:21:50,520 --> 00:21:52,170
kind of going in the cab forum but this

596
00:21:52,170 --> 00:21:55,130
definitely lit a fire under them and so

597
00:21:55,130 --> 00:21:58,500
you know we got them going because of

598
00:21:58,500 --> 00:22:00,840
what we just saw all of these requests

599
00:22:00,840 --> 00:22:02,340
were coming in is this certificate any

600
00:22:02,340 --> 00:22:05,550
good and the service were saying yeah

601
00:22:05,550 --> 00:22:07,200
it's fine because it's certificate they

602
00:22:07,200 --> 00:22:10,170
never heard of because OCSP responders

603
00:22:10,170 --> 00:22:12,990
were in a sense powered by lists and bad

604
00:22:12,990 --> 00:22:15,150
certificates and so they just said it's

605
00:22:15,150 --> 00:22:16,860
fine for anything that wasn't on their

606
00:22:16,860 --> 00:22:18,660
list of bad certificates and we decided

607
00:22:18,660 --> 00:22:20,160
that this was completely ridiculous and

608
00:22:20,160 --> 00:22:22,140
that OCSP servers had to be properly

609
00:22:22,140 --> 00:22:23,760
database back to the database of good

610
00:22:23,760 --> 00:22:26,280
certificates and so we told CAS that

611
00:22:26,280 --> 00:22:27,990
they needed to completely reject our CSP

612
00:22:27,990 --> 00:22:29,160
servers worked so that they didn't do

613
00:22:29,160 --> 00:22:31,320
something so stupid and the last thing

614
00:22:31,320 --> 00:22:32,850
is that the cab forum produced some

615
00:22:32,850 --> 00:22:34,020
things called the network security

616
00:22:34,020 --> 00:22:36,720
guidelines which in hindsight were a bit

617
00:22:36,720 --> 00:22:39,660
of a knee-jerk reaction because they did

618
00:22:39,660 --> 00:22:41,530
say what seemed to be vaguely good thing

619
00:22:41,530 --> 00:22:43,920
to do with network security in 2011 in

620
00:22:43,920 --> 00:22:46,450
2016 a lot of the things that you do are

621
00:22:46,450 --> 00:22:48,190
different but this document hasn't

622
00:22:48,190 --> 00:22:50,950
changed no one really knows very much no

623
00:22:50,950 --> 00:22:52,300
one in the cab forum has the expertise

624
00:22:52,300 --> 00:22:54,910
to update it and so it's actually now a

625
00:22:54,910 --> 00:22:58,050
bit of a drag on certificate authority

626
00:22:58,050 --> 00:23:01,240
as a network security best practice and

627
00:23:01,240 --> 00:23:02,560
so we have to figure out what to do

628
00:23:02,560 --> 00:23:03,880
about that but that's something that

629
00:23:03,880 --> 00:23:07,510
happened at the time 2011 another

630
00:23:07,510 --> 00:23:10,240
company called digi cert Sdn Bhd not to

631
00:23:10,240 --> 00:23:12,070
be confused with the much bigger didyou

632
00:23:12,070 --> 00:23:14,140
cert in the u.s. was a Malaysian

633
00:23:14,140 --> 00:23:16,630
subordinate CA event trust so in trusted

634
00:23:16,630 --> 00:23:18,220
issued them an intermediate certificate

635
00:23:18,220 --> 00:23:19,900
which they were then using to issue to

636
00:23:19,900 --> 00:23:21,520
their customers they decided it would be

637
00:23:21,520 --> 00:23:22,870
great to have some certificates with

638
00:23:22,870 --> 00:23:25,270
512-bit keys which you can factor in

639
00:23:25,270 --> 00:23:27,450
about three minutes on your coffee pot

640
00:23:27,450 --> 00:23:33,670
and and no no key usage information

641
00:23:33,670 --> 00:23:34,930
which means these certificates could

642
00:23:34,930 --> 00:23:36,700
have been used for email or servers or

643
00:23:36,700 --> 00:23:38,200
anything you wanted to use them for and

644
00:23:38,200 --> 00:23:41,320
no way of revoking them well done did

645
00:23:41,320 --> 00:23:43,660
you set Sdn Bhd we decided to distrust

646
00:23:43,660 --> 00:23:45,970
them completely and at the ground the

647
00:23:45,970 --> 00:23:47,230
same time we published the baseline

648
00:23:47,230 --> 00:23:48,970
requirements which in case it wasn't

649
00:23:48,970 --> 00:23:50,860
really obvious required you to put

650
00:23:50,860 --> 00:23:52,180
information in your certificates about

651
00:23:52,180 --> 00:23:53,980
how to revoke them and what they should

652
00:23:53,980 --> 00:23:57,460
be used for 2012 a company called trust

653
00:23:57,460 --> 00:23:59,140
wave who's an American commercial CA

654
00:23:59,140 --> 00:24:01,360
issued an intermediate certificate to a

655
00:24:01,360 --> 00:24:03,700
company called Walgreens who used it for

656
00:24:03,700 --> 00:24:04,870
man in the middling everyone on their

657
00:24:04,870 --> 00:24:08,680
corporate network now in one sense that

658
00:24:08,680 --> 00:24:11,980
sort of okay because the people inside

659
00:24:11,980 --> 00:24:13,960
Walgreens network agreed to it in

660
00:24:13,960 --> 00:24:15,850
another sense it's really dangerous

661
00:24:15,850 --> 00:24:18,160
because if that intermediate certificate

662
00:24:18,160 --> 00:24:20,350
leaks someone can use it for man in the

663
00:24:20,350 --> 00:24:22,420
middle again e1 else in the world and we

664
00:24:22,420 --> 00:24:25,300
decided that this sort of thing was too

665
00:24:25,300 --> 00:24:28,150
dangerous to allow in the public PKI and

666
00:24:28,150 --> 00:24:30,580
because we hadn't taken a strong stance

667
00:24:30,580 --> 00:24:32,830
against it beforehand we didn't actually

668
00:24:32,830 --> 00:24:35,590
sanction Trustwave but we told all of

669
00:24:35,590 --> 00:24:37,030
the CAS that this has got to stop and we

670
00:24:37,030 --> 00:24:39,460
gave them two months to cut it out and

671
00:24:39,460 --> 00:24:40,830
get everyone to find some other solution

672
00:24:40,830 --> 00:24:43,960
so no more man in the middling under

673
00:24:43,960 --> 00:24:45,850
public roots even for people's internal

674
00:24:45,850 --> 00:24:47,680
networks because we can't trust you to

675
00:24:47,680 --> 00:24:51,280
keep the key safe so then in 2013 when

676
00:24:51,280 --> 00:24:52,480
the French government's yeah you did

677
00:24:52,480 --> 00:24:54,850
exactly the same thing we constrain them

678
00:24:54,850 --> 00:24:55,210
too

679
00:24:55,210 --> 00:24:58,419
via fr and about 12 other very small

680
00:24:58,419 --> 00:24:59,950
top-level domains which are French

681
00:24:59,950 --> 00:25:01,690
dependencies and it turns out actually

682
00:25:01,690 --> 00:25:03,070
that they decided that this incident

683
00:25:03,070 --> 00:25:04,659
meant that they didn't really want to be

684
00:25:04,659 --> 00:25:06,070
a public trusted CA at all and so

685
00:25:06,070 --> 00:25:07,059
they've been moving away from this

686
00:25:07,059 --> 00:25:08,710
hierarchy and it's soon going to be

687
00:25:08,710 --> 00:25:11,309
removed entirely at least from Firefox

688
00:25:11,309 --> 00:25:14,260
then in 2008 and 2014 there was an

689
00:25:14,260 --> 00:25:15,820
incident but it didn't apply to us it

690
00:25:15,820 --> 00:25:17,529
was a CA that was only a Microsoft Store

691
00:25:17,529 --> 00:25:20,830
so we dodged it that year 2015 a chinese

692
00:25:20,830 --> 00:25:23,529
CA called CN nic issued a certificate

693
00:25:23,529 --> 00:25:25,330
for man-in-the-middle to a Middle

694
00:25:25,330 --> 00:25:27,279
Eastern company called MCS Holdings in

695
00:25:27,279 --> 00:25:28,779
violation of its own certificate

696
00:25:28,779 --> 00:25:31,029
practice statement it didn't disclose

697
00:25:31,029 --> 00:25:32,740
this certificate as it was supposed to

698
00:25:32,740 --> 00:25:34,450
have because we had the intermediates

699
00:25:34,450 --> 00:25:36,490
closure rules in place by that point mcs

700
00:25:36,490 --> 00:25:39,309
had no PK practices you know we had no

701
00:25:39,309 --> 00:25:40,570
idea what they were doing with the

702
00:25:40,570 --> 00:25:41,890
certificate you know they could have had

703
00:25:41,890 --> 00:25:44,169
it just stuck on a you know a server in

704
00:25:44,169 --> 00:25:45,549
their data center with no protections

705
00:25:45,549 --> 00:25:47,950
whatsoever and we decided that this was

706
00:25:47,950 --> 00:25:49,270
so entirely ridiculous that we

707
00:25:49,270 --> 00:25:51,730
distrusted the entire CA although we did

708
00:25:51,730 --> 00:25:52,899
say after you know they could reapply

709
00:25:52,899 --> 00:25:54,669
and in fact they did reapply last

710
00:25:54,669 --> 00:25:56,169
October and they're going through the

711
00:25:56,169 --> 00:25:59,909
reapplication process to be re included

712
00:26:00,360 --> 00:26:04,899
2016 was whoa silence calm which I'm

713
00:26:04,899 --> 00:26:05,980
going to talk about a little bit more

714
00:26:05,980 --> 00:26:08,590
because it's a it's a really interesting

715
00:26:08,590 --> 00:26:10,840
detective story and I very much enjoyed

716
00:26:10,840 --> 00:26:13,210
detecting it woah sign is a Chinese CA

717
00:26:13,210 --> 00:26:15,880
in Stockholm is an Israeli CA and this

718
00:26:15,880 --> 00:26:18,700
incident started when people reported

719
00:26:18,700 --> 00:26:20,200
from various places including some of

720
00:26:20,200 --> 00:26:21,640
our friends at Google that there were

721
00:26:21,640 --> 00:26:23,919
various problems with whoa sign and when

722
00:26:23,919 --> 00:26:25,360
the word sort of three or four problems

723
00:26:25,360 --> 00:26:26,950
on this list we decided we should make a

724
00:26:26,950 --> 00:26:28,630
list and we made a list and then other

725
00:26:28,630 --> 00:26:30,549
people reported other things and the

726
00:26:30,549 --> 00:26:34,450
list got really quite long and so whoa

727
00:26:34,450 --> 00:26:35,980
sighing were kind of trying to deal with

728
00:26:35,980 --> 00:26:38,169
and respond to these but one particular

729
00:26:38,169 --> 00:26:40,510
thing on the list was particular

730
00:26:40,510 --> 00:26:42,669
concerning and that was sha-1 backdating

731
00:26:42,669 --> 00:26:45,399
the background to this is that sha-1 is

732
00:26:45,399 --> 00:26:47,320
a cryptographic algorithm a hash

733
00:26:47,320 --> 00:26:49,690
algorithm that has for a long time been

734
00:26:49,690 --> 00:26:52,470
showing its age and so there has been a

735
00:26:52,470 --> 00:26:55,330
industry-wide plan to eliminate its use

736
00:26:55,330 --> 00:26:57,490
and one of the key dates in that plan

737
00:26:57,490 --> 00:27:00,610
was the first of January 2016 which was

738
00:27:00,610 --> 00:27:02,260
the date after which no certificate

739
00:27:02,260 --> 00:27:04,450
authority was permitted to issue

740
00:27:04,450 --> 00:27:06,700
certificates that used the sha-1 hash

741
00:27:06,700 --> 00:27:08,429
algorithm as part of their cryptographic

742
00:27:08,429 --> 00:27:12,799
construction the trouble is that

743
00:27:12,799 --> 00:27:15,360
certificates don't have an issue date in

744
00:27:15,360 --> 00:27:17,309
them they have two dates to have a knock

745
00:27:17,309 --> 00:27:18,809
before date which is the date you're not

746
00:27:18,809 --> 00:27:20,279
supposed to use certificate before a

747
00:27:20,279 --> 00:27:21,779
start date in other words and are not

748
00:27:21,779 --> 00:27:23,340
after date which is sort of an expiry

749
00:27:23,340 --> 00:27:25,110
date but both of those bits of

750
00:27:25,110 --> 00:27:26,909
information are controlled by the CA and

751
00:27:26,909 --> 00:27:28,619
there is no requirement and there's no

752
00:27:28,619 --> 00:27:30,240
way you would enforce a requirement that

753
00:27:30,240 --> 00:27:32,759
the CA make them not before date the

754
00:27:32,759 --> 00:27:35,100
date of issue okay and in fact there are

755
00:27:35,100 --> 00:27:36,720
sometimes technical reasons why you have

756
00:27:36,720 --> 00:27:41,070
to vary it a little bit so sha Wan was

757
00:27:41,070 --> 00:27:42,389
forbidden for certificates issued after

758
00:27:42,389 --> 00:27:44,100
a certain date but of course it is

759
00:27:44,100 --> 00:27:45,360
technically possible for a CA to

760
00:27:45,360 --> 00:27:47,190
backdate their certificates to make it

761
00:27:47,190 --> 00:27:48,960
look like they were issued before the

762
00:27:48,960 --> 00:27:51,029
ban came into place thereby working

763
00:27:51,029 --> 00:27:53,309
around the codes that chrome and for a

764
00:27:53,309 --> 00:27:55,230
while Firefox had in that said we don't

765
00:27:55,230 --> 00:27:56,909
trust certificates that were issued

766
00:27:56,909 --> 00:28:00,090
after this date so we thought whoa sign

767
00:28:00,090 --> 00:28:01,919
had been doing that why did we think

768
00:28:01,919 --> 00:28:04,919
that well this is a graph of whoa signs

769
00:28:04,919 --> 00:28:07,679
sha-1 issuances for the three months

770
00:28:07,679 --> 00:28:11,159
leading up to the deadline day when they

771
00:28:11,159 --> 00:28:12,990
weren't supposed to do it anymore and it

772
00:28:12,990 --> 00:28:14,820
turned out by looking at various fields

773
00:28:14,820 --> 00:28:16,529
in the certificate because certificates

774
00:28:16,529 --> 00:28:18,629
in a sense have patterns or fingerprints

775
00:28:18,629 --> 00:28:20,730
sort of little features that you can

776
00:28:20,730 --> 00:28:21,899
tell they were issued by a particular

777
00:28:21,899 --> 00:28:23,759
system or in a particular way

778
00:28:23,759 --> 00:28:25,499
that they had two types of Charlaine

779
00:28:25,499 --> 00:28:27,419
issuance which are in green and orange

780
00:28:27,419 --> 00:28:29,309
the green ones we think will probably

781
00:28:29,309 --> 00:28:30,899
issued by an automated system they were

782
00:28:30,899 --> 00:28:32,850
issued on every day of the week and they

783
00:28:32,850 --> 00:28:34,559
were issued in quite a big volume but

784
00:28:34,559 --> 00:28:36,419
the orange ones we think were probably

785
00:28:36,419 --> 00:28:37,889
issued manually they were only issued

786
00:28:37,889 --> 00:28:39,330
between mondays and fridays they were

787
00:28:39,330 --> 00:28:42,570
issued in much smaller quantities well

788
00:28:42,570 --> 00:28:44,399
it almost completely only between

789
00:28:44,399 --> 00:28:46,499
mondays and fridays occasionally it

790
00:28:46,499 --> 00:28:49,019
seems someone came in on a Saturday and

791
00:28:49,019 --> 00:28:51,600
issued the odd certificate and on this

792
00:28:51,600 --> 00:28:55,950
particular Sunday there were 62

793
00:28:55,950 --> 00:28:57,749
certificates issued that's sort of two

794
00:28:57,749 --> 00:28:59,909
Sundays before the end of the year 20th

795
00:28:59,909 --> 00:29:03,480
of December and and we thought that that

796
00:29:03,480 --> 00:29:05,610
seemed a little bit surprising that they

797
00:29:05,610 --> 00:29:07,049
would come in on a Sunday and issue so

798
00:29:07,049 --> 00:29:08,940
many certificates at once and so we had

799
00:29:08,940 --> 00:29:10,169
to look at those certificates in

800
00:29:10,169 --> 00:29:12,749
comparison to the other orange ones and

801
00:29:12,749 --> 00:29:14,399
we looked at the time that they were

802
00:29:14,399 --> 00:29:16,710
issued now the orange ones you can see

803
00:29:16,710 --> 00:29:19,200
were issued this is UTC so issued during

804
00:29:19,200 --> 00:29:22,610
the day in China with a break for lunch

805
00:29:22,610 --> 00:29:27,300
okay the blue ones were issued at random

806
00:29:27,300 --> 00:29:28,890
times throughout this particular Sunday

807
00:29:28,890 --> 00:29:31,560
so we have two options one of which is

808
00:29:31,560 --> 00:29:33,540
that the employees of wou sign perhaps

809
00:29:33,540 --> 00:29:35,910
because they were you know under some

810
00:29:35,910 --> 00:29:37,620
sort of pressure came in on one Sunday

811
00:29:37,620 --> 00:29:40,140
but at midnight and worked all the way

812
00:29:40,140 --> 00:29:42,150
through to the next midnight issuing

813
00:29:42,150 --> 00:29:44,670
certificates sha-1 certificates before

814
00:29:44,670 --> 00:29:46,800
the deadline or it could be that in fact

815
00:29:46,800 --> 00:29:49,320
they had a template which had this back

816
00:29:49,320 --> 00:29:51,000
date in it and they were just using that

817
00:29:51,000 --> 00:29:53,940
template to issue certificates in 2016

818
00:29:53,940 --> 00:29:55,850
which they were claiming or issued in

819
00:29:55,850 --> 00:29:58,710
2015 we thought that was a bit more

820
00:29:58,710 --> 00:29:59,990
likely

821
00:29:59,990 --> 00:30:03,120
so then certificate transparency

822
00:30:03,120 --> 00:30:05,580
provided cryptographic evidence of the

823
00:30:05,580 --> 00:30:07,680
backdating of six of the 62 certificates

824
00:30:07,680 --> 00:30:11,370
but not the rest and so that again was a

825
00:30:11,370 --> 00:30:12,420
bit more evidence that they've been

826
00:30:12,420 --> 00:30:14,040
doing this the other thing that they did

827
00:30:14,040 --> 00:30:16,530
was that they bought this at Israeli

828
00:30:16,530 --> 00:30:19,200
cycles comm and Mozilla has a clause in

829
00:30:19,200 --> 00:30:21,930
our route policy that says that if a CA

830
00:30:21,930 --> 00:30:24,150
changes control you have to tell us

831
00:30:24,150 --> 00:30:26,460
because Trust is not transitive just cuz

832
00:30:26,460 --> 00:30:28,620
we trust company a doesn't mean we trust

833
00:30:28,620 --> 00:30:31,590
Company B when they buy a company a and

834
00:30:31,590 --> 00:30:32,760
so you have to at least tell us that

835
00:30:32,760 --> 00:30:34,440
that has happened and not only did they

836
00:30:34,440 --> 00:30:36,660
not tell us but they explicitly denied

837
00:30:36,660 --> 00:30:39,210
that it had happened until we went to

838
00:30:39,210 --> 00:30:42,020
the British Israeli and Hong Kong

839
00:30:42,020 --> 00:30:45,450
company registries and trace the chain

840
00:30:45,450 --> 00:30:48,600
of ownership to show that to show that

841
00:30:48,600 --> 00:30:51,000
in fact the Israeli company was now

842
00:30:51,000 --> 00:30:52,980
owned by British company which was now

843
00:30:52,980 --> 00:30:54,750
owned by a Hong Kong company which was

844
00:30:54,750 --> 00:30:57,030
owned by whoa sign which was itself

845
00:30:57,030 --> 00:31:00,660
owned by a Chinese large Chinese IT

846
00:31:00,660 --> 00:31:02,010
conglomerate which also has a browser

847
00:31:02,010 --> 00:31:06,990
called Qi who 360 but the problem was

848
00:31:06,990 --> 00:31:10,140
that we then found again using

849
00:31:10,140 --> 00:31:14,010
certificate transparency data that this

850
00:31:14,010 --> 00:31:15,870
kind of style of Mis assurance that we

851
00:31:15,870 --> 00:31:17,430
saw in those graphs those 62

852
00:31:17,430 --> 00:31:19,230
certificates had a very specific

853
00:31:19,230 --> 00:31:22,230
fingerprint and we found a missus done

854
00:31:22,230 --> 00:31:25,430
by scone with the same fingerprint for a

855
00:31:25,430 --> 00:31:27,600
Australian payments company called tyro

856
00:31:27,600 --> 00:31:29,940
and they'd issued two certificates to

857
00:31:29,940 --> 00:31:31,980
this company again which had been back

858
00:31:31,980 --> 00:31:34,350
dated and so we took that as evidence

859
00:31:34,350 --> 00:31:35,150
that the

860
00:31:35,150 --> 00:31:37,940
practices that whoa sign had imported

861
00:31:37,940 --> 00:31:40,160
themselves into Scholl and therefore it

862
00:31:40,160 --> 00:31:42,410
was reasonable to treat the whole as one

863
00:31:42,410 --> 00:31:44,690
and so what we did was we distrusted

864
00:31:44,690 --> 00:31:47,180
both CAS entirely from the 21st of

865
00:31:47,180 --> 00:31:50,330
October 2016 Starcom got an opportunity

866
00:31:50,330 --> 00:31:53,059
to be readmitted after six months if

867
00:31:53,059 --> 00:31:54,980
they could change their management so

868
00:31:54,980 --> 00:31:56,870
that they were no longer managed by wou

869
00:31:56,870 --> 00:31:58,880
sign but were owned directly and various

870
00:31:58,880 --> 00:32:00,380
other changes because they'd also moved

871
00:32:00,380 --> 00:32:02,600
to over to wou signs issuance systems

872
00:32:02,600 --> 00:32:04,940
which we had no confidence in because

873
00:32:04,940 --> 00:32:08,179
the code quality was terrible so Starcom

874
00:32:08,179 --> 00:32:09,380
had a bunch of work to do but could

875
00:32:09,380 --> 00:32:13,990
possibly apply for readmit insane April

876
00:32:13,990 --> 00:32:17,450
whoa sign can can apply for remittance

877
00:32:17,450 --> 00:32:19,100
after a year but basically has to

878
00:32:19,100 --> 00:32:21,950
rewrite their entire infrastructure and

879
00:32:21,950 --> 00:32:24,710
so on but the other thing that we did

880
00:32:24,710 --> 00:32:26,120
and this may be press into things to

881
00:32:26,120 --> 00:32:28,160
come is that we determined that some of

882
00:32:28,160 --> 00:32:29,929
the things that whoa sigh n-- had done

883
00:32:29,929 --> 00:32:32,840
wrong should have been spotted by their

884
00:32:32,840 --> 00:32:35,660
auditors so for example they had

885
00:32:35,660 --> 00:32:37,640
out-of-date software on their issuing

886
00:32:37,640 --> 00:32:38,960
computers right and one of the things

887
00:32:38,960 --> 00:32:40,580
that supposed to be checked is that you

888
00:32:40,580 --> 00:32:41,750
know you're applying security patches

889
00:32:41,750 --> 00:32:43,610
within a minimum of six months from the

890
00:32:43,610 --> 00:32:44,630
time that issued and some of the

891
00:32:44,630 --> 00:32:45,800
software they were running the OS was

892
00:32:45,800 --> 00:32:48,260
five years out-of-date there were other

893
00:32:48,260 --> 00:32:49,910
things about certificates that had been

894
00:32:49,910 --> 00:32:51,920
you know vast tranches of certificates

895
00:32:51,920 --> 00:32:53,540
had been issued with the wrong fields in

896
00:32:53,540 --> 00:32:55,040
this wasn't a technical or security

897
00:32:55,040 --> 00:32:56,510
problem but it's the sort of thing an

898
00:32:56,510 --> 00:32:58,640
audit could have been picked up and

899
00:32:58,640 --> 00:33:00,470
their auditors Ernst & Young Hong Kong

900
00:33:00,470 --> 00:33:02,120
had given them a clean bill of audit

901
00:33:02,120 --> 00:33:06,020
although I hear that this fact caused

902
00:33:06,020 --> 00:33:09,230
some disquiet among other auditors and

903
00:33:09,230 --> 00:33:10,400
among other bits of Ernst & Young but

904
00:33:10,400 --> 00:33:13,070
that's what happened and so we decided

905
00:33:13,070 --> 00:33:14,630
that we were no longer going to accept

906
00:33:14,630 --> 00:33:16,760
audits from that particular branch of

907
00:33:16,760 --> 00:33:18,590
Ernst & Young although of course if we

908
00:33:18,590 --> 00:33:20,179
later find more bits of Ernst & Young

909
00:33:20,179 --> 00:33:22,940
causing causing audit troubles then that

910
00:33:22,940 --> 00:33:25,550
might get wider but that's what we did

911
00:33:25,550 --> 00:33:28,040
and so we hope that this will because

912
00:33:28,040 --> 00:33:29,000
it's the first time that this has

913
00:33:29,000 --> 00:33:31,040
happened we did not for example and

914
00:33:31,040 --> 00:33:32,510
maybe in hindsight we should have done

915
00:33:32,510 --> 00:33:34,610
but we did not stop accepting audits

916
00:33:34,610 --> 00:33:37,370
from DigiNotar as auditors right despite

917
00:33:37,370 --> 00:33:39,200
the fact that there you know a lot of

918
00:33:39,200 --> 00:33:40,130
things that they were doing were

919
00:33:40,130 --> 00:33:42,679
completely terrible after they were

920
00:33:42,679 --> 00:33:45,900
investigated but this time we did

921
00:33:45,900 --> 00:33:48,960
so 2017

922
00:33:48,960 --> 00:33:51,059
and this is sort of ongoing at the

923
00:33:51,059 --> 00:33:53,490
moment so we'll see what happens a very

924
00:33:53,490 --> 00:33:56,190
large CA called Symantec has discovered

925
00:33:56,190 --> 00:33:58,500
some problems with an RA in Korea called

926
00:33:58,500 --> 00:34:00,600
cross cert so what happened was someone

927
00:34:00,600 --> 00:34:01,980
was looking through the certificate

928
00:34:01,980 --> 00:34:04,620
transparency data and they found that a

929
00:34:04,620 --> 00:34:06,420
bunch of certificates supposedly issued

930
00:34:06,420 --> 00:34:09,840
by Symantec that had like the word test

931
00:34:09,840 --> 00:34:11,940
in the organization field instead of the

932
00:34:11,940 --> 00:34:13,980
name of an actual company which again is

933
00:34:13,980 --> 00:34:15,780
not a serious security problem in itself

934
00:34:15,780 --> 00:34:17,850
but isn't what you're supposed to do and

935
00:34:17,850 --> 00:34:20,100
they said what about these and Symantec

936
00:34:20,100 --> 00:34:21,600
said oh yes those are issued by cross

937
00:34:21,600 --> 00:34:22,830
cert we'll go and talk to cross heard

938
00:34:22,830 --> 00:34:24,449
about this and they had a little chat

939
00:34:24,449 --> 00:34:25,649
with cross hurt and it seems like the

940
00:34:25,649 --> 00:34:27,389
more they talked across that the more

941
00:34:27,389 --> 00:34:31,469
problems they find so they were you know

942
00:34:31,469 --> 00:34:32,790
there were 12 certificates that they

943
00:34:32,790 --> 00:34:34,350
were concerned about they said oh just

944
00:34:34,350 --> 00:34:35,760
show us the logs for these the audit

945
00:34:35,760 --> 00:34:37,889
logs to show that you properly checked

946
00:34:37,889 --> 00:34:39,929
that these domains were owned and across

947
00:34:39,929 --> 00:34:44,909
her like audit logs so this it seems

948
00:34:44,909 --> 00:34:46,350
that it's this way the story is still

949
00:34:46,350 --> 00:34:49,020
emerging so and again this may also

950
00:34:49,020 --> 00:34:50,850
raised questions about cross certs

951
00:34:50,850 --> 00:34:53,310
auditor and whether cross cert got a

952
00:34:53,310 --> 00:34:54,570
clean bill of health and their auditor

953
00:34:54,570 --> 00:34:56,070
and whether they should have done so

954
00:34:56,070 --> 00:34:58,290
this is an emerging situation which

955
00:34:58,290 --> 00:35:00,570
we'll have to see but this might well be

956
00:35:00,570 --> 00:35:03,240
2017 s thing because and I'm still

957
00:35:03,240 --> 00:35:05,730
asking Symantec about this I don't think

958
00:35:05,730 --> 00:35:07,830
it's necessarily possible to tell when a

959
00:35:07,830 --> 00:35:09,930
certificate was issued via cross certain

960
00:35:09,930 --> 00:35:11,790
when it wasn't which means that the

961
00:35:11,790 --> 00:35:14,130
blast radius for this could be really

962
00:35:14,130 --> 00:35:18,510
quite large so watch this space there

963
00:35:18,510 --> 00:35:18,990
you go

964
00:35:18,990 --> 00:35:22,500
so there's some things that happened and

965
00:35:22,500 --> 00:35:24,570
what we did about them as well as stuff

966
00:35:24,570 --> 00:35:26,250
about our route program and I'm glad we

967
00:35:26,250 --> 00:35:28,050
have 10 minutes left and I'm very happy

968
00:35:28,050 --> 00:35:30,570
to take questions please sir

969
00:35:30,570 --> 00:35:34,790
yes that's you in the blue yes

970
00:35:55,040 --> 00:35:58,099
[Music]

971
00:36:50,869 --> 00:36:53,250
these problems with the CI system that

972
00:36:53,250 --> 00:36:58,529
will be run secure is great everyone's

973
00:36:58,529 --> 00:37:01,740
factor so two very different questions

974
00:37:01,740 --> 00:37:06,180
the first question was that some

975
00:37:06,180 --> 00:37:08,609
governments are now requiring parental

976
00:37:08,609 --> 00:37:10,289
controls which sort of requires

977
00:37:10,289 --> 00:37:12,539
man-in-the-middle and how do you how do

978
00:37:12,539 --> 00:37:16,200
you accommodate that technically and the

979
00:37:16,200 --> 00:37:18,720
second question was basically that if

980
00:37:18,720 --> 00:37:20,369
one of the CAS is bad everybody's

981
00:37:20,369 --> 00:37:22,140
stuffed what do you do about that to

982
00:37:22,140 --> 00:37:23,279
answer the second question

983
00:37:23,279 --> 00:37:26,609
things like CIA and mandatory use of CIA

984
00:37:26,609 --> 00:37:30,289
will hopefully go some way towards that

985
00:37:30,289 --> 00:37:33,270
it means that hopefully the CAS will

986
00:37:33,270 --> 00:37:35,490
have systems that automatically check in

987
00:37:35,490 --> 00:37:37,529
an on over rideable way and this is why

988
00:37:37,529 --> 00:37:38,990
we want to make it mandatory that

989
00:37:38,990 --> 00:37:40,890
they're allowed to issue for a

990
00:37:40,890 --> 00:37:42,119
particular domain and that we

991
00:37:42,119 --> 00:37:43,559
automatically blocked if they don't even

992
00:37:43,559 --> 00:37:46,160
if some evil person is at the controls

993
00:37:46,160 --> 00:37:48,280
so we hope that that will

994
00:37:48,280 --> 00:37:50,140
deal a little bit with the weakest link

995
00:37:50,140 --> 00:37:52,240
problem certificate transparency which

996
00:37:52,240 --> 00:37:53,440
Google are doing will also make it

997
00:37:53,440 --> 00:37:56,020
easier to spot when bad certificates are

998
00:37:56,020 --> 00:37:57,190
issued because they will have to be

999
00:37:57,190 --> 00:37:58,810
publicly logged in order to be trusted

1000
00:37:58,810 --> 00:38:00,610
and then you can notice that they're

1001
00:38:00,610 --> 00:38:02,080
there so those are a couple of things

1002
00:38:02,080 --> 00:38:03,520
that people are doing to try and avoid

1003
00:38:03,520 --> 00:38:05,980
that one CA is bad therefore we're all

1004
00:38:05,980 --> 00:38:10,120
stuffed problem in terms of man in the

1005
00:38:10,120 --> 00:38:12,670
middle and legitimate man in the middle

1006
00:38:12,670 --> 00:38:19,330
by say by companies or perhaps for

1007
00:38:19,330 --> 00:38:23,760
parental control reasons I think that

1008
00:38:23,760 --> 00:38:27,670
having the browser specifically add

1009
00:38:27,670 --> 00:38:29,680
features to allow man in the middling is

1010
00:38:29,680 --> 00:38:31,870
probably not the direction we want to go

1011
00:38:31,870 --> 00:38:36,250
down I think that you can all you can

1012
00:38:36,250 --> 00:38:41,020
already allow man in the middle by by

1013
00:38:41,020 --> 00:38:43,840
installing your own route and then and

1014
00:38:43,840 --> 00:38:47,590
then using generating certificates under

1015
00:38:47,590 --> 00:38:48,940
that route and I think that's probably

1016
00:38:48,940 --> 00:38:51,160
safer than your browser shipping with

1017
00:38:51,160 --> 00:38:52,480
some kind of built-in man-in-the-middle

1018
00:38:52,480 --> 00:38:57,520
feature another question man in the

1019
00:38:57,520 --> 00:38:59,770
middle though if you are behind an HTTP

1020
00:38:59,770 --> 00:39:02,920
proxy basically you you have man in the

1021
00:39:02,920 --> 00:39:06,280
middle in the native price right many

1022
00:39:06,280 --> 00:39:10,480
enterprises have this yeah okay and the

1023
00:39:10,480 --> 00:39:13,870
question is then yeah about the ubiquity

1024
00:39:13,870 --> 00:39:17,290
so now if I correctly understood in

1025
00:39:17,290 --> 00:39:20,470
Windows if I run Chrome or I don't

1026
00:39:20,470 --> 00:39:23,380
Firefox I will get different for

1027
00:39:23,380 --> 00:39:25,600
different websites or get different I

1028
00:39:25,600 --> 00:39:29,050
can get red green green red so different

1029
00:39:29,050 --> 00:39:32,950
things so that's yeah that's the big

1030
00:39:32,950 --> 00:39:34,930
query question and then the related

1031
00:39:34,930 --> 00:39:37,690
question is okay why separate route

1032
00:39:37,690 --> 00:39:41,640
program instead of cross-referencing so

1033
00:39:41,640 --> 00:39:44,530
the first question was you get different

1034
00:39:44,530 --> 00:39:46,830
results in Chrome and Firefox on Windows

1035
00:39:46,830 --> 00:39:51,310
and what about that and secondly why is

1036
00:39:51,310 --> 00:39:52,860
there more than one route program well

1037
00:39:52,860 --> 00:39:55,660
you get you can you know by default you

1038
00:39:55,660 --> 00:39:56,500
get different results

1039
00:39:56,500 --> 00:39:58,240
possibly in Chrome and Firefox if

1040
00:39:58,240 --> 00:40:00,250
there's a disparity between the windows

1041
00:40:00,250 --> 00:40:01,520
routes door and the

1042
00:40:01,520 --> 00:40:04,010
folks read store but Firefox does now

1043
00:40:04,010 --> 00:40:05,810
quite recently have an option you can

1044
00:40:05,810 --> 00:40:07,850
switch on which allows it to trust

1045
00:40:07,850 --> 00:40:10,400
manually added certificates in the

1046
00:40:10,400 --> 00:40:12,380
windows root store which means not the

1047
00:40:12,380 --> 00:40:13,910
ones that Microsoft add but if you've

1048
00:40:13,910 --> 00:40:16,430
added one as a domain administrator or

1049
00:40:16,430 --> 00:40:18,650
as a company Firefox will find that and

1050
00:40:18,650 --> 00:40:20,750
also trust it so it makes it easier to

1051
00:40:20,750 --> 00:40:22,280
use Firefox in enterprise environments

1052
00:40:22,280 --> 00:40:25,220
and those circumstances but why do we

1053
00:40:25,220 --> 00:40:26,990
have multiple root stores why do we not

1054
00:40:26,990 --> 00:40:30,440
just say ok on on Windows Firefox will

1055
00:40:30,440 --> 00:40:35,120
trust Microsoft's root store on Mac will

1056
00:40:35,120 --> 00:40:36,890
trust Apple's root store and on Linux

1057
00:40:36,890 --> 00:40:39,010
will trust oh hang on a minute

1058
00:40:39,010 --> 00:40:41,660
well there's one reason right because of

1059
00:40:41,660 --> 00:40:43,430
most Linux distributions use our root

1060
00:40:43,430 --> 00:40:46,430
store and so if we stop doing a root

1061
00:40:46,430 --> 00:40:47,930
store then they would end up having to

1062
00:40:47,930 --> 00:40:50,270
copy Microsoft or Apple and having

1063
00:40:50,270 --> 00:40:51,860
either Microsoft or Apple determine the

1064
00:40:51,860 --> 00:40:53,420
list of certificate authorities that

1065
00:40:53,420 --> 00:40:54,890
everybody trusts in the world in a

1066
00:40:54,890 --> 00:40:56,840
non-transparent way seems to me to be a

1067
00:40:56,840 --> 00:40:58,340
definite step backwards for web security

1068
00:40:58,340 --> 00:41:00,230
so you can ask the other root store

1069
00:41:00,230 --> 00:41:02,180
programs why they have their own program

1070
00:41:02,180 --> 00:41:04,370
and it's certainly true I think that

1071
00:41:04,370 --> 00:41:06,740
many of them are in a sense following

1072
00:41:06,740 --> 00:41:08,270
Mozilla's lead in terms of who they

1073
00:41:08,270 --> 00:41:11,780
admit because a commercial company a

1074
00:41:11,780 --> 00:41:13,910
root program is just a cost center right

1075
00:41:13,910 --> 00:41:15,800
it's a necessary evil that you have to

1076
00:41:15,800 --> 00:41:17,600
do you may want to keep it in order to

1077
00:41:17,600 --> 00:41:20,120
exercise some forms of control but you

1078
00:41:20,120 --> 00:41:21,530
know it's not really something you can

1079
00:41:21,530 --> 00:41:23,240
make money out charging CAS for

1080
00:41:23,240 --> 00:41:24,740
inclusion will give you a bit of money

1081
00:41:24,740 --> 00:41:26,810
we don't do that but you know not really

1082
00:41:26,810 --> 00:41:29,570
very much money it's just a hassle right

1083
00:41:29,570 --> 00:41:31,430
but the reason our root program exists

1084
00:41:31,430 --> 00:41:32,600
at least is because we think at least

1085
00:41:32,600 --> 00:41:34,460
one root program needs to exist which is

1086
00:41:34,460 --> 00:41:36,380
run open and transparently and we think

1087
00:41:36,380 --> 00:41:39,200
we can use it both to in a sense Drive

1088
00:41:39,200 --> 00:41:40,520
openness and transparency and other

1089
00:41:40,520 --> 00:41:42,920
route programs also drive up the general

1090
00:41:42,920 --> 00:41:45,080
security of the web using that power

1091
00:41:45,080 --> 00:41:48,430
that we have yes thank you for the clock

1092
00:41:48,430 --> 00:41:51,620
I'm wondering if you could elaborate a

1093
00:41:51,620 --> 00:41:54,970
bit more about what you want to see

1094
00:41:54,970 --> 00:42:01,420
changed in CT and also another question

1095
00:42:01,420 --> 00:42:06,700
can you elaborate on how a ideas will

1096
00:42:06,700 --> 00:42:09,080
maybe change

1097
00:42:09,080 --> 00:42:13,790
the root program for Mozilla yes so on

1098
00:42:13,790 --> 00:42:16,970
the matter of CT some people who

1099
00:42:16,970 --> 00:42:18,530
understand the technology much better

1100
00:42:18,530 --> 00:42:20,330
than me are currently producing a paper

1101
00:42:20,330 --> 00:42:22,190
about the changes that we'd like to see

1102
00:42:22,190 --> 00:42:24,500
so they put an initial post on the the

1103
00:42:24,500 --> 00:42:27,320
trans mailing list which is the ITF

1104
00:42:27,320 --> 00:42:28,990
mailing list for CT and things like it

1105
00:42:28,990 --> 00:42:31,220
about some of the concerns that they had

1106
00:42:31,220 --> 00:42:32,480
and they've been asked to go away and

1107
00:42:32,480 --> 00:42:34,190
write up the changes that they'd like to

1108
00:42:34,190 --> 00:42:35,720
see and that's what they're doing so

1109
00:42:35,720 --> 00:42:38,060
exactly how those changes work

1110
00:42:38,060 --> 00:42:40,340
technically is not my bag and so you'll

1111
00:42:40,340 --> 00:42:42,440
have to wait until they explain more

1112
00:42:42,440 --> 00:42:43,370
about the problems that they're having

1113
00:42:43,370 --> 00:42:45,890
the second question was about AI - which

1114
00:42:45,890 --> 00:42:53,510
is an EU regulation for for regulating

1115
00:42:53,510 --> 00:42:55,520
certificate authorities and stiff of

1116
00:42:55,520 --> 00:42:59,390
authority lists I have to be slightly

1117
00:42:59,390 --> 00:43:02,060
careful what I say about e I - because

1118
00:43:02,060 --> 00:43:03,890
some of my opinions about e IDs are

1119
00:43:03,890 --> 00:43:06,230
probably not all that printable or wise

1120
00:43:06,230 --> 00:43:11,240
to broadcast but I think that the people

1121
00:43:11,240 --> 00:43:12,950
who legislated AI - didn't really

1122
00:43:12,950 --> 00:43:14,690
understand the difference between the

1123
00:43:14,690 --> 00:43:16,580
SSL certificate market and other sort

1124
00:43:16,580 --> 00:43:18,740
certificate market like document signing

1125
00:43:18,740 --> 00:43:21,320
and code signing and even email and

1126
00:43:21,320 --> 00:43:24,230
therefore the regulations are not a good

1127
00:43:24,230 --> 00:43:25,250
fit

1128
00:43:25,250 --> 00:43:27,560
the ëitís people would like mozilla to

1129
00:43:27,560 --> 00:43:29,360
just decide that we're going to trust

1130
00:43:29,360 --> 00:43:33,050
anybody they decide to trust and so you

1131
00:43:33,050 --> 00:43:34,550
know if the EU trust somebody mozilla

1132
00:43:34,550 --> 00:43:38,180
should obviously trust them we and other

1133
00:43:38,180 --> 00:43:39,890
group programs to be fair pushed back

1134
00:43:39,890 --> 00:43:42,410
fairly strongly against that suggestion

1135
00:43:42,410 --> 00:43:45,740
and so we don't think that that's going

1136
00:43:45,740 --> 00:43:48,080
to happen we think that the best way of

1137
00:43:48,080 --> 00:43:49,520
managing it is if they want to have

1138
00:43:49,520 --> 00:43:51,770
their own trusted lists they can have

1139
00:43:51,770 --> 00:43:53,000
their own trusted lists and use them

1140
00:43:53,000 --> 00:43:54,710
whatever they want but the best way to

1141
00:43:54,710 --> 00:43:56,450
avoid problems is just to make sure

1142
00:43:56,450 --> 00:43:58,040
everyone in their trusted lists has been

1143
00:43:58,040 --> 00:44:00,320
through our process and has also got

1144
00:44:00,320 --> 00:44:02,360
into our trusted lists and then there's

1145
00:44:02,360 --> 00:44:04,850
in practice no disparity and so there'll

1146
00:44:04,850 --> 00:44:07,310
be no difficulty and we're very keen to

1147
00:44:07,310 --> 00:44:09,830
make it easier and simpler for people to

1148
00:44:09,830 --> 00:44:11,390
go through the process necessary without

1149
00:44:11,390 --> 00:44:13,670
making the process less rigorous and

1150
00:44:13,670 --> 00:44:17,060
we're happy to work with people from us

1151
00:44:17,060 --> 00:44:19,430
or anywhere else on doing that but it's

1152
00:44:19,430 --> 00:44:21,140
certainly not the case that we're going

1153
00:44:21,140 --> 00:44:22,670
to agree to trust anybody

1154
00:44:22,670 --> 00:44:24,710
that any other entity just says here's a

1155
00:44:24,710 --> 00:44:25,960
list of people to try stuff you go

1156
00:44:25,960 --> 00:44:28,490
because we think that first of all that

1157
00:44:28,490 --> 00:44:31,760
reduces our ability to drive positive

1158
00:44:31,760 --> 00:44:33,470
change because someone can say now I

1159
00:44:33,470 --> 00:44:34,730
don't have to do what you say Mozilla

1160
00:44:34,730 --> 00:44:36,020
because I can just get in there list and

1161
00:44:36,020 --> 00:44:39,220
then you promise to trust them so yours

1162
00:44:39,220 --> 00:44:42,200
not very helpful so we don't think he

1163
00:44:42,200 --> 00:44:44,420
Otis will have much effect in practice

1164
00:44:44,420 --> 00:44:49,220
on our route program okay thank you hi

1165
00:44:49,220 --> 00:44:52,690
well now the government's come in play

1166
00:44:52,690 --> 00:44:55,730
so the the company that owns the route

1167
00:44:55,730 --> 00:44:59,420
program where is it located the company

1168
00:44:59,420 --> 00:45:00,680
that owns the report well there's a

1169
00:45:00,680 --> 00:45:02,840
route program by Mozilla yes so it's

1170
00:45:02,840 --> 00:45:05,240
owned by a company I guess well Mozilla

1171
00:45:05,240 --> 00:45:07,250
is a nonprofit organization which is a

1172
00:45:07,250 --> 00:45:10,460
u.s. 501 C 3 so it's based in the US ok

1173
00:45:10,460 --> 00:45:12,380
so there is work that some of the

1174
00:45:12,380 --> 00:45:14,600
organization's issuance certificates in

1175
00:45:14,600 --> 00:45:16,760
the United States are on the United

1176
00:45:16,760 --> 00:45:18,500
States law and it's possible that the

1177
00:45:18,500 --> 00:45:20,180
United States administration getting a

1178
00:45:20,180 --> 00:45:21,920
hold of the keys of this root

1179
00:45:21,920 --> 00:45:23,660
certificate well that's true of

1180
00:45:23,660 --> 00:45:24,860
certificate authorities in any

1181
00:45:24,860 --> 00:45:27,710
jurisdiction so yeah if a CA is based in

1182
00:45:27,710 --> 00:45:29,360
a particular jurisdiction it's possible

1183
00:45:29,360 --> 00:45:30,350
that the government will come knocking

1184
00:45:30,350 --> 00:45:32,510
with their National Security Letter or

1185
00:45:32,510 --> 00:45:34,190
whatever it is and say we'd like a copy

1186
00:45:34,190 --> 00:45:35,810
of your root keys please that is

1187
00:45:35,810 --> 00:45:37,970
certainly true that's not a problem

1188
00:45:37,970 --> 00:45:40,060
that's specific to our root program or

1189
00:45:40,060 --> 00:45:42,530
you know or to any root program because

1190
00:45:42,530 --> 00:45:43,700
the government can always come knocking

1191
00:45:43,700 --> 00:45:45,800
and asking you for things but the

1192
00:45:45,800 --> 00:45:47,570
advantage of the certificate system is

1193
00:45:47,570 --> 00:45:50,630
at least that particularly significant

1194
00:45:50,630 --> 00:45:52,010
transparency might be able to help with

1195
00:45:52,010 --> 00:45:55,130
that in some cases but also if the

1196
00:45:55,130 --> 00:45:56,420
government does do that and starts

1197
00:45:56,420 --> 00:45:57,350
issuing certificates for

1198
00:45:57,350 --> 00:45:59,360
man-in-the-middle they are handing out

1199
00:45:59,360 --> 00:46:01,250
with every connection cryptographic

1200
00:46:01,250 --> 00:46:04,280
evidence of what they've done which

1201
00:46:04,280 --> 00:46:06,380
means that if the client is smart enough

1202
00:46:06,380 --> 00:46:08,360
and making smart clients which detect

1203
00:46:08,360 --> 00:46:10,100
this kind of thing is an ongoing area of

1204
00:46:10,100 --> 00:46:11,990
research it can grab that cryptographic

1205
00:46:11,990 --> 00:46:14,330
evidence submit it or publicize it and

1206
00:46:14,330 --> 00:46:16,670
we can go OK sniff occurred or thority

1207
00:46:16,670 --> 00:46:20,180
based in Co blackest an you know you've

1208
00:46:20,180 --> 00:46:21,650
clearly been issuing dodgy certificates

1209
00:46:21,650 --> 00:46:22,970
it doesn't matter if the government made

1210
00:46:22,970 --> 00:46:23,300
you do it

1211
00:46:23,300 --> 00:46:26,000
we're not trusting you anymore so you

1212
00:46:26,000 --> 00:46:27,350
know that there is always cryptographic

1213
00:46:27,350 --> 00:46:29,030
evidence when that happens the trick is

1214
00:46:29,030 --> 00:46:30,770
capturing it and that's a better

1215
00:46:30,770 --> 00:46:33,020
situation I think than other systems

1216
00:46:33,020 --> 00:46:36,290
where it's much harder to prove that

1217
00:46:36,290 --> 00:46:38,780
the government has snuck in and and

1218
00:46:38,780 --> 00:46:44,090
stolen some keys maybe we have seen that

1219
00:46:44,090 --> 00:46:47,210
the power of the CAS is I think too big

1220
00:46:47,210 --> 00:46:49,700
yeah they have they have a big potential

1221
00:46:49,700 --> 00:46:51,500
for abuse and they did it and they will

1222
00:46:51,500 --> 00:46:54,620
do it and why is there not a bigger

1223
00:46:54,620 --> 00:46:57,170
Drive like from Mozilla for example as

1224
00:46:57,170 --> 00:47:01,430
an NGO and to combine CA based systems

1225
00:47:01,430 --> 00:47:03,770
with for example trust on first contact

1226
00:47:03,770 --> 00:47:08,300
so that they can be reduced the CAS for

1227
00:47:08,300 --> 00:47:10,820
example to bootstrap only for example

1228
00:47:10,820 --> 00:47:13,850
trust on first contact with CA yeah

1229
00:47:13,850 --> 00:47:16,070
so that would be a one idea by I think

1230
00:47:16,070 --> 00:47:20,660
it's no one is even yet then this is I

1231
00:47:20,660 --> 00:47:22,490
didn't new for me or whatever there's no

1232
00:47:22,490 --> 00:47:24,980
one it would be other talk to kind of

1233
00:47:24,980 --> 00:47:27,080
talk about the different trade-offs and

1234
00:47:27,080 --> 00:47:28,580
user interface issues that there are

1235
00:47:28,580 --> 00:47:31,040
with different alternatives to the CA

1236
00:47:31,040 --> 00:47:34,520
system as it works today but very

1237
00:47:34,520 --> 00:47:36,110
briefly one of the big problems with the

1238
00:47:36,110 --> 00:47:38,240
trust and first use system is how you

1239
00:47:38,240 --> 00:47:41,150
deal with key change right so in a trust

1240
00:47:41,150 --> 00:47:43,610
on first useless in a CA system if a key

1241
00:47:43,610 --> 00:47:45,890
changes nobody knows nobody cares right

1242
00:47:45,890 --> 00:47:47,480
because the new key is signed by the

1243
00:47:47,480 --> 00:47:49,700
same authorities the old key and it's

1244
00:47:49,700 --> 00:47:50,990
still signed and you still trust the

1245
00:47:50,990 --> 00:47:52,970
authority so it's fine in a trust on

1246
00:47:52,970 --> 00:47:56,780
first used system a key compromise is

1247
00:47:56,780 --> 00:47:58,880
indistinguishable from some guy just

1248
00:47:58,880 --> 00:48:01,400
deciding to roll over his key right you

1249
00:48:01,400 --> 00:48:02,690
know I think I need a new key I'm gonna

1250
00:48:02,690 --> 00:48:04,280
get a new key you know the browser goes

1251
00:48:04,280 --> 00:48:06,230
oh there's a new key it's like what do I

1252
00:48:06,230 --> 00:48:08,090
do about that well it could be that

1253
00:48:08,090 --> 00:48:09,590
something bad has happened or it could

1254
00:48:09,590 --> 00:48:11,140
be that something bad hasn't happened

1255
00:48:11,140 --> 00:48:16,490
whatever right so that's a very brief

1256
00:48:16,490 --> 00:48:18,170
answer to what is actually a very large

1257
00:48:18,170 --> 00:48:20,090
problem and I you know it'd be great to

1258
00:48:20,090 --> 00:48:21,320
discuss that but we really don't have

1259
00:48:21,320 --> 00:48:24,830
time here yeah we're out of time thank

1260
00:48:24,830 --> 00:48:25,820
you so much

1261
00:48:25,820 --> 00:48:35,579
[Applause]

