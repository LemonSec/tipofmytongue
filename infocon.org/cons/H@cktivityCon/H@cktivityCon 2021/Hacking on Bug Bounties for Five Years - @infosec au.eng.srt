1
00:00:06,160 --> 00:00:09,309
[Music]

2
00:00:12,799 --> 00:00:14,639
hey everyone welcome to our presentation

3
00:00:14,639 --> 00:00:16,560
today on hacking on bug bounties for

4
00:00:16,560 --> 00:00:18,480
five years

5
00:00:18,480 --> 00:00:21,520
as an introduction my name is shabs

6
00:00:21,520 --> 00:00:23,039
i've been hacking for a very long time

7
00:00:23,039 --> 00:00:25,359
now especially in fun bounties i'm the

8
00:00:25,359 --> 00:00:27,840
co-founder and cto of ascentnote and

9
00:00:27,840 --> 00:00:29,359
i've previously worked as a senior

10
00:00:29,359 --> 00:00:31,760
security analyst at a consulting company

11
00:00:31,760 --> 00:00:33,600
called bishopfox

12
00:00:33,600 --> 00:00:35,840
i'm currently the number one hacker in

13
00:00:35,840 --> 00:00:38,239
on haka one in australia and i'm in the

14
00:00:38,239 --> 00:00:41,520
top 40 hackers worldwide

15
00:00:41,520 --> 00:00:43,760
hey guys i'm sean i work with jobs at

16
00:00:43,760 --> 00:00:46,000
arsenal i'm the engineering lead i've

17
00:00:46,000 --> 00:00:47,760
done a couple conference talks before

18
00:00:47,760 --> 00:00:49,680
like defcon cloud village hacking box

19
00:00:49,680 --> 00:00:52,399
singapore and b-sides camera

20
00:00:52,399 --> 00:00:54,239
most of my bug bounties these days is

21
00:00:54,239 --> 00:00:57,760
automating high-end critical risk bugs

22
00:00:57,760 --> 00:00:58,960
in the other times i am a

23
00:00:58,960 --> 00:01:01,600
girl-on-developer and you may know me as

24
00:01:01,600 --> 00:01:04,879
the person who wrote kite runner

25
00:01:06,159 --> 00:01:08,000
so it all starts off with humble

26
00:01:08,000 --> 00:01:09,920
beginnings

27
00:01:09,920 --> 00:01:12,320
i'm from an immigrant family that moved

28
00:01:12,320 --> 00:01:14,000
to australia from india in the year

29
00:01:14,000 --> 00:01:17,840
2000. that's almost 21 years ago and my

30
00:01:17,840 --> 00:01:20,320
father he was always invested in he

31
00:01:20,320 --> 00:01:22,000
always invested in computers at a young

32
00:01:22,000 --> 00:01:24,640
age for both my brother and i even

33
00:01:24,640 --> 00:01:27,520
though we barely ever had the money and

34
00:01:27,520 --> 00:01:30,000
as a result i fell in love with hacking

35
00:01:30,000 --> 00:01:32,640
because um i kept on losing at

36
00:01:32,640 --> 00:01:35,119
multiplayer games when when i was

37
00:01:35,119 --> 00:01:36,560
playing with my brother and i just

38
00:01:36,560 --> 00:01:39,040
wanted to beat my brother so i really

39
00:01:39,040 --> 00:01:41,040
started getting into this realm of

40
00:01:41,040 --> 00:01:43,520
hacking and i enjoyed learning about and

41
00:01:43,520 --> 00:01:46,320
practicing application security

42
00:01:46,320 --> 00:01:48,479
i've been in the infrastructure industry

43
00:01:48,479 --> 00:01:51,119
officially for around six years however

44
00:01:51,119 --> 00:01:53,119
i've worked in you know small consulting

45
00:01:53,119 --> 00:01:56,159
firms the big four high-end consulting

46
00:01:56,159 --> 00:02:00,479
firms and now i've co-founded a startup

47
00:02:00,719 --> 00:02:03,439
when i was 14 i was working at hungry

48
00:02:03,439 --> 00:02:06,240
jack's in western city hungry jacks is

49
00:02:06,240 --> 00:02:08,080
like a fast food restaurant here in

50
00:02:08,080 --> 00:02:09,758
australia in america you'd have the

51
00:02:09,758 --> 00:02:12,160
equivalent which is burger king but i

52
00:02:12,160 --> 00:02:15,280
was essentially making 6.50 an hour and

53
00:02:15,280 --> 00:02:17,200
i worked there for around eight months

54
00:02:17,200 --> 00:02:19,520
and i learned that at the end i only

55
00:02:19,520 --> 00:02:21,520
really made 800

56
00:02:21,520 --> 00:02:24,879
um in my free time i spent it hacking

57
00:02:24,879 --> 00:02:27,200
all the time that was all i was doing in

58
00:02:27,200 --> 00:02:28,480
my free time

59
00:02:28,480 --> 00:02:30,879
and you know i dreamt that an industry

60
00:02:30,879 --> 00:02:32,959
existed where i could use my application

61
00:02:32,959 --> 00:02:35,920
security skills it was very surprising

62
00:02:35,920 --> 00:02:38,480
to me that an industry did exist and at

63
00:02:38,480 --> 00:02:40,959
the time i had no idea that it did so i

64
00:02:40,959 --> 00:02:43,599
was always dreaming about it um at the

65
00:02:43,599 --> 00:02:46,640
time i was also submitting low risk bugs

66
00:02:46,640 --> 00:02:49,519
on paypal's background

67
00:02:49,519 --> 00:02:52,080
the first bugs i reported to paypal were

68
00:02:52,080 --> 00:02:54,000
absolutely terrible like there were

69
00:02:54,000 --> 00:02:56,080
technically security issues but they

70
00:02:56,080 --> 00:02:58,640
weren't that serious and they were they

71
00:02:58,640 --> 00:03:00,720
were a result of me using scanners and

72
00:03:00,720 --> 00:03:02,640
understand not fully understanding the

73
00:03:02,640 --> 00:03:04,560
results but sending in the results that

74
00:03:04,560 --> 00:03:06,319
scanners were returning

75
00:03:06,319 --> 00:03:08,080
a big part of my methodology back then

76
00:03:08,080 --> 00:03:10,560
was to simply use google docs and look

77
00:03:10,560 --> 00:03:12,879
at interesting subcommittees some of my

78
00:03:12,879 --> 00:03:15,440
first reported bugs to paypal were some

79
00:03:15,440 --> 00:03:17,360
of these here like apache tomcat

80
00:03:17,360 --> 00:03:18,400
disclosure

81
00:03:18,400 --> 00:03:20,319
http cookie

82
00:03:20,319 --> 00:03:22,959
disclosure um tls issues

83
00:03:22,959 --> 00:03:25,680
uh waft disclosure html forms without

84
00:03:25,680 --> 00:03:28,239
csrf protection as you understand these

85
00:03:28,239 --> 00:03:30,239
today they won't really get paid out in

86
00:03:30,239 --> 00:03:32,480
any major bug bounty program in fact

87
00:03:32,480 --> 00:03:34,400
they're mostly in exclusion lists and

88
00:03:34,400 --> 00:03:35,760
they're not bugs that companies are

89
00:03:35,760 --> 00:03:38,400
really looking for but back then as a 14

90
00:03:38,400 --> 00:03:40,080
year old i was just trying to break into

91
00:03:40,080 --> 00:03:42,239
bug bounties and you know one thing that

92
00:03:42,239 --> 00:03:44,400
we want to cover in this presentation is

93
00:03:44,400 --> 00:03:46,480
the journey from starting off in bug

94
00:03:46,480 --> 00:03:48,799
bounties all the way to the end and

95
00:03:48,799 --> 00:03:50,799
being really talented and successful at

96
00:03:50,799 --> 00:03:53,360
bug bounties so this was where i started

97
00:03:53,360 --> 00:03:55,760
off i started off with issues that were

98
00:03:55,760 --> 00:03:57,519
really not that important and not that

99
00:03:57,519 --> 00:03:59,920
serious from a security perspective this

100
00:03:59,920 --> 00:04:01,120
was the sort of stuff that i was

101
00:04:01,120 --> 00:04:02,799
reporting when i first started getting

102
00:04:02,799 --> 00:04:05,840
into bug bounties

103
00:04:05,920 --> 00:04:08,080
some of these bugs were paid out

104
00:04:08,080 --> 00:04:10,159
some payouts were very small but they

105
00:04:10,159 --> 00:04:11,840
made me realize that i could get paid

106
00:04:11,840 --> 00:04:14,560
for hacking this blew my mind as a 14

107
00:04:14,560 --> 00:04:17,358
year old i had had no idea that an

108
00:04:17,358 --> 00:04:19,120
information security industry even

109
00:04:19,120 --> 00:04:20,160
existed

110
00:04:20,160 --> 00:04:22,400
it motivated me to spend all of my time

111
00:04:22,400 --> 00:04:23,840
and learning more about application

112
00:04:23,840 --> 00:04:26,320
security i worked really hard to get

113
00:04:26,320 --> 00:04:28,639
into as many hall of fame pages as

114
00:04:28,639 --> 00:04:30,880
possible because being acknowledged as a

115
00:04:30,880 --> 00:04:32,960
hacker really mattered to me at the time

116
00:04:32,960 --> 00:04:34,880
and it was something that i thought was

117
00:04:34,880 --> 00:04:37,120
a really great way to get recognized for

118
00:04:37,120 --> 00:04:40,639
the efforts when you're hacking things

119
00:04:40,880 --> 00:04:43,199
my first critical bug was a server-side

120
00:04:43,199 --> 00:04:45,280
request for audrey bug through google

121
00:04:45,280 --> 00:04:47,440
docking i discovered an endpoint called

122
00:04:47,440 --> 00:04:49,600
merchants.buildmeleader.com

123
00:04:49,600 --> 00:04:52,320
which took in a url as input it looked

124
00:04:52,320 --> 00:04:55,040
like an internal xml testing tool so

125
00:04:55,040 --> 00:04:56,639
essentially you would be able to provide

126
00:04:56,639 --> 00:04:59,040
an arbitrary url and i would respond

127
00:04:59,040 --> 00:05:00,639
with this table which contained the

128
00:05:00,639 --> 00:05:02,479
contents of the response

129
00:05:02,479 --> 00:05:04,960
with this i could access internal hosts

130
00:05:04,960 --> 00:05:07,520
and read the full http response from

131
00:05:07,520 --> 00:05:11,240
these internal hosts

132
00:05:11,280 --> 00:05:13,360
paypal accepted this issue and they paid

133
00:05:13,360 --> 00:05:16,960
me 1 500 usd that was the biggest payout

134
00:05:16,960 --> 00:05:19,759
i had ever received i quit my job at

135
00:05:19,759 --> 00:05:22,400
hungry jax immediately after that payout

136
00:05:22,400 --> 00:05:24,800
and i never appeared at hungry jacks

137
00:05:24,800 --> 00:05:27,120
again

138
00:05:27,919 --> 00:05:29,520
okay so um

139
00:05:29,520 --> 00:05:32,000
now it's like for where i started

140
00:05:32,000 --> 00:05:32,800
and

141
00:05:32,800 --> 00:05:35,840
my background is i kind of had no

142
00:05:35,840 --> 00:05:37,600
background in security before i started

143
00:05:37,600 --> 00:05:40,960
university um in high school i was just

144
00:05:40,960 --> 00:05:42,320
a student that played lots of video

145
00:05:42,320 --> 00:05:43,199
games

146
00:05:43,199 --> 00:05:44,960
and i didn't really have much of an

147
00:05:44,960 --> 00:05:46,800
interest in programming i tried once or

148
00:05:46,800 --> 00:05:49,680
twice to get into c plus plus but i was

149
00:05:49,680 --> 00:05:51,840
terrible i had no concept of like what

150
00:05:51,840 --> 00:05:54,479
functions were uh my friends would laugh

151
00:05:54,479 --> 00:05:56,400
at me because i just didn't understand

152
00:05:56,400 --> 00:05:58,479
any component of programming

153
00:05:58,479 --> 00:06:00,639
so i came to university with very little

154
00:06:00,639 --> 00:06:02,960
idea of what i wanted to do myself and i

155
00:06:02,960 --> 00:06:04,639
decided that you know i'll just try some

156
00:06:04,639 --> 00:06:06,240
stuff that i tried before but i was

157
00:06:06,240 --> 00:06:07,919
really bad at

158
00:06:07,919 --> 00:06:09,600
since then

159
00:06:09,600 --> 00:06:10,880
it's been about

160
00:06:10,880 --> 00:06:13,280
seven years since i started uni i've

161
00:06:13,280 --> 00:06:14,560
played through

162
00:06:14,560 --> 00:06:18,080
tens if not hundreds of ctfs i've done

163
00:06:18,080 --> 00:06:20,479
consulting i've interned at small tech

164
00:06:20,479 --> 00:06:22,080
companies i've internet big tech

165
00:06:22,080 --> 00:06:25,280
companies i've lectured classes of like

166
00:06:25,280 --> 00:06:27,520
hundreds of students and now i'm working

167
00:06:27,520 --> 00:06:30,000
full-time at asset

168
00:06:30,000 --> 00:06:30,800
so

169
00:06:30,800 --> 00:06:32,720
back to how i got started with

170
00:06:32,720 --> 00:06:34,560
bug bounties and security

171
00:06:34,560 --> 00:06:36,880
um in my first year of university i

172
00:06:36,880 --> 00:06:39,600
remember seeing mr shabam right here

173
00:06:39,600 --> 00:06:41,360
rock up to our university and do a talk

174
00:06:41,360 --> 00:06:43,039
about bug bounties

175
00:06:43,039 --> 00:06:45,360
and i remember distinctly that i was

176
00:06:45,360 --> 00:06:48,000
walking along like a school main walkway

177
00:06:48,000 --> 00:06:50,080
and there were like small posters put up

178
00:06:50,080 --> 00:06:51,759
talking about how we were doing like

179
00:06:51,759 --> 00:06:53,520
they were doing a talk about making

180
00:06:53,520 --> 00:06:55,680
money by hacking games and i was like

181
00:06:55,680 --> 00:06:57,360
wow i play a lot of games i know what

182
00:06:57,360 --> 00:06:59,520
those are um and it was talking about

183
00:06:59,520 --> 00:07:01,440
like specifically finding bugs on this

184
00:07:01,440 --> 00:07:03,199
certain large gaming company i'll just

185
00:07:03,199 --> 00:07:05,360
call them clg code

186
00:07:05,360 --> 00:07:06,960
and like i played a lot of games from

187
00:07:06,960 --> 00:07:09,520
clg cars like well i know what they do

188
00:07:09,520 --> 00:07:11,199
and going through his talk he kept

189
00:07:11,199 --> 00:07:12,639
talking about like he kept finding these

190
00:07:12,639 --> 00:07:14,720
bugs each one was two thousand dollars

191
00:07:14,720 --> 00:07:16,720
five thousand dollars and he just had

192
00:07:16,720 --> 00:07:18,560
slide off the slide of these and i was

193
00:07:18,560 --> 00:07:21,039
like holy [ __ ] that is a lot of money

194
00:07:21,039 --> 00:07:23,120
for something that i probably spend just

195
00:07:23,120 --> 00:07:25,280
as much time on as shops but doing

196
00:07:25,280 --> 00:07:27,919
completely opposite things

197
00:07:27,919 --> 00:07:29,680
so that being said i was thinking to

198
00:07:29,680 --> 00:07:32,000
myself probably later that week like i

199
00:07:32,000 --> 00:07:34,479
can do this too it's not that hard um

200
00:07:34,479 --> 00:07:36,000
and i remember like i was reading off

201
00:07:36,000 --> 00:07:38,319
reddit and this one specific blog post

202
00:07:38,319 --> 00:07:41,120
came up about uh joseph frankovic

203
00:07:41,120 --> 00:07:42,479
talking about race conditions on

204
00:07:42,479 --> 00:07:44,000
facebook

205
00:07:44,000 --> 00:07:45,599
and i remember that blog post they were

206
00:07:45,599 --> 00:07:47,840
talking about okay like you can copy

207
00:07:47,840 --> 00:07:49,919
paste coupon codes and if you spam them

208
00:07:49,919 --> 00:07:51,440
fast enough then you can apply it

209
00:07:51,440 --> 00:07:52,800
multiple times

210
00:07:52,800 --> 00:07:53,599
um

211
00:07:53,599 --> 00:07:54,960
and i was just broadly thinking like

212
00:07:54,960 --> 00:07:56,879
yeah sure there's plenty of like online

213
00:07:56,879 --> 00:07:59,120
shops around like what about the ones in

214
00:07:59,120 --> 00:08:01,199
the clg code game

215
00:08:01,199 --> 00:08:04,160
so my first bug that i reported was a

216
00:08:04,160 --> 00:08:06,400
copy paste bug off the internet

217
00:08:06,400 --> 00:08:07,919
and to show you what it looked like it

218
00:08:07,919 --> 00:08:09,680
pretty much you start with the game and

219
00:08:09,680 --> 00:08:11,360
you have like these in-game currency

220
00:08:11,360 --> 00:08:15,840
points uh here i have 1 650 points

221
00:08:15,840 --> 00:08:17,919
and then i literally replicated what he

222
00:08:17,919 --> 00:08:20,080
did in the blog post i just took

223
00:08:20,080 --> 00:08:23,120
any one event um that you purchased

224
00:08:23,120 --> 00:08:24,960
something and in this case you can see

225
00:08:24,960 --> 00:08:27,199
i'm purchasing a bunch of runes and i'm

226
00:08:27,199 --> 00:08:30,319
purchasing one champion um

227
00:08:30,319 --> 00:08:32,000
and you can see i'm specifying the cost

228
00:08:32,000 --> 00:08:34,080
right so like we can't arbitrarily

229
00:08:34,080 --> 00:08:35,760
specify how much we want to pay we have

230
00:08:35,760 --> 00:08:38,320
to pay the correct amount but what we

231
00:08:38,320 --> 00:08:39,919
notice is if i send all of these

232
00:08:39,919 --> 00:08:42,000
requests at the exact same time

233
00:08:42,000 --> 00:08:44,480
um i eventually end up with one extra

234
00:08:44,480 --> 00:08:47,839
champion having only spent three points

235
00:08:47,839 --> 00:08:49,279
which is incredible because this is

236
00:08:49,279 --> 00:08:51,040
effectively what the blog post is

237
00:08:51,040 --> 00:08:52,080
discussed

238
00:08:52,080 --> 00:08:54,320
um and immediately after that like i was

239
00:08:54,320 --> 00:08:55,760
ecstatic like the adrenaline rush

240
00:08:55,760 --> 00:08:57,040
started like holy [ __ ] i might have

241
00:08:57,040 --> 00:08:59,920
found something so i reach out to shabam

242
00:08:59,920 --> 00:09:02,399
and i ask him for help and pretty much

243
00:09:02,399 --> 00:09:03,839
he's like well man maybe you have a

244
00:09:03,839 --> 00:09:05,680
security bug here's just a template

245
00:09:05,680 --> 00:09:07,519
report i use all the time fill in all

246
00:09:07,519 --> 00:09:09,120
the blanks and then just submit it to

247
00:09:09,120 --> 00:09:12,000
write submit it to the clg code and i'm

248
00:09:12,000 --> 00:09:14,320
like okay sure no problems so i write up

249
00:09:14,320 --> 00:09:16,000
this report it doesn't really make much

250
00:09:16,000 --> 00:09:17,279
sense

251
00:09:17,279 --> 00:09:19,200
and then i submit it and i sort of

252
00:09:19,200 --> 00:09:21,040
forget about it like they don't really

253
00:09:21,040 --> 00:09:24,080
respond um and then a few months later

254
00:09:24,080 --> 00:09:25,440
they start like sending me messages like

255
00:09:25,440 --> 00:09:27,440
okay yeah we're looking into your issue

256
00:09:27,440 --> 00:09:28,720
and i'm skeptical whether it's even

257
00:09:28,720 --> 00:09:30,240
going to get fixed it's like well it

258
00:09:30,240 --> 00:09:32,080
doesn't really have any impact it's just

259
00:09:32,080 --> 00:09:34,160
like you get to spend in-game points

260
00:09:34,160 --> 00:09:34,959
right

261
00:09:34,959 --> 00:09:37,920
um and then six months later they pay

262
00:09:37,920 --> 00:09:39,680
out two thousand dollars

263
00:09:39,680 --> 00:09:41,920
and to me in a first-year uni student

264
00:09:41,920 --> 00:09:44,320
who's not working part-time who's just

265
00:09:44,320 --> 00:09:46,399
accrued ten thousand dollars of debt

266
00:09:46,399 --> 00:09:48,480
every year getting two thousand dollars

267
00:09:48,480 --> 00:09:50,399
for effectively one night's worth of

268
00:09:50,399 --> 00:09:52,800
copy pasting is insane

269
00:09:52,800 --> 00:09:54,640
i get the spike of dopamine when i see

270
00:09:54,640 --> 00:09:58,480
the dollar figure and i'm totally hooked

271
00:09:58,480 --> 00:10:00,560
so from that point on it's only been

272
00:10:00,560 --> 00:10:02,320
going upwards and understanding more

273
00:10:02,320 --> 00:10:04,800
about it but that being said let's go

274
00:10:04,800 --> 00:10:05,920
through some quick tips of what we

275
00:10:05,920 --> 00:10:08,719
learned at the beginning

276
00:10:09,760 --> 00:10:11,920
so before you start hunting if you're

277
00:10:11,920 --> 00:10:14,000
looking to get into bug bounties

278
00:10:14,000 --> 00:10:15,920
your application security skills must be

279
00:10:15,920 --> 00:10:18,000
sharp and this is really important

280
00:10:18,000 --> 00:10:20,079
because bug bounties do require a good

281
00:10:20,079 --> 00:10:22,240
comprehensive knowledge of application

282
00:10:22,240 --> 00:10:23,920
security skills

283
00:10:23,920 --> 00:10:26,160
most bug bounties um with a few

284
00:10:26,160 --> 00:10:28,079
exceptions are rewarded for bugs and web

285
00:10:28,079 --> 00:10:29,519
applications

286
00:10:29,519 --> 00:10:31,440
web application security itself is

287
00:10:31,440 --> 00:10:33,519
actually a huge field to navigate there

288
00:10:33,519 --> 00:10:35,040
are client-side issues server-side

289
00:10:35,040 --> 00:10:37,440
issues cloud platform specific issues

290
00:10:37,440 --> 00:10:39,279
and these must all be studied and

291
00:10:39,279 --> 00:10:40,800
practiced before approaching bug

292
00:10:40,800 --> 00:10:42,000
bounties

293
00:10:42,000 --> 00:10:44,399
you can learn a lot by practicing websec

294
00:10:44,399 --> 00:10:46,880
academy's labs or even looking through

295
00:10:46,880 --> 00:10:49,360
the courses on pentester lab however i

296
00:10:49,360 --> 00:10:51,600
will say that you know as someone who's

297
00:10:51,600 --> 00:10:53,760
looking to get into bug bounties having

298
00:10:53,760 --> 00:10:55,360
a good fundamental knowledge of

299
00:10:55,360 --> 00:10:57,200
application security skills is

300
00:10:57,200 --> 00:11:01,600
absolutely vital to your success

301
00:11:01,600 --> 00:11:03,839
another thing that's really important is

302
00:11:03,839 --> 00:11:06,160
writing high quality reports

303
00:11:06,160 --> 00:11:09,120
often you'll find vulnerabilities but it

304
00:11:09,120 --> 00:11:10,880
is your report that is conveying the

305
00:11:10,880 --> 00:11:12,640
seriousness and the criticality of your

306
00:11:12,640 --> 00:11:14,480
vulnerabilities so the better your

307
00:11:14,480 --> 00:11:15,920
report is the more likely you're going

308
00:11:15,920 --> 00:11:18,079
to be paid out a decent amount of money

309
00:11:18,079 --> 00:11:20,320
if your reports are easy and legible to

310
00:11:20,320 --> 00:11:22,560
understand that's less time that the

311
00:11:22,560 --> 00:11:24,800
company has to spend to

312
00:11:24,800 --> 00:11:27,200
remediate the issue and ultimately they

313
00:11:27,200 --> 00:11:29,839
can reward you for that um amazing

314
00:11:29,839 --> 00:11:31,519
report that you send it

315
00:11:31,519 --> 00:11:32,640
um

316
00:11:32,640 --> 00:11:34,800
over time i've had to make an effort to

317
00:11:34,800 --> 00:11:36,640
become a better to become better at

318
00:11:36,640 --> 00:11:38,399
reporting and reminding myself of the

319
00:11:38,399 --> 00:11:40,720
value of good reports a report should

320
00:11:40,720 --> 00:11:42,800
usually contain a summary steps to

321
00:11:42,800 --> 00:11:45,120
reproduce supporting materials and

322
00:11:45,120 --> 00:11:47,279
impact

323
00:11:47,279 --> 00:11:48,800
you can have other things in the report

324
00:11:48,800 --> 00:11:50,320
but this is typically what i include in

325
00:11:50,320 --> 00:11:53,040
my reports

326
00:11:53,600 --> 00:11:55,920
so let's go back in time and let's think

327
00:11:55,920 --> 00:11:59,839
about 2015 um getting started full time

328
00:11:59,839 --> 00:12:02,000
so initially starting to hunt on bug

329
00:12:02,000 --> 00:12:04,399
bounties it can be pretty daunting so um

330
00:12:04,399 --> 00:12:06,720
the most important thing is that you're

331
00:12:06,720 --> 00:12:08,639
spending some time looking for bugs and

332
00:12:08,639 --> 00:12:10,720
trying different ideas on your target

333
00:12:10,720 --> 00:12:12,240
having a friend that you can compete

334
00:12:12,240 --> 00:12:14,399
with is actually a really good thing and

335
00:12:14,399 --> 00:12:16,240
i highly recommend it it's really

336
00:12:16,240 --> 00:12:18,240
productive and it will motivate you to

337
00:12:18,240 --> 00:12:19,760
spend more time looking for bugs

338
00:12:19,760 --> 00:12:21,120
especially if you're a competitive

339
00:12:21,120 --> 00:12:22,399
person

340
00:12:22,399 --> 00:12:24,240
setting healthy goals like one bug a

341
00:12:24,240 --> 00:12:26,240
week slash month can be a good way to

342
00:12:26,240 --> 00:12:28,880
commit to finding bugs initially as well

343
00:12:28,880 --> 00:12:31,200
and another thing is um building your

344
00:12:31,200 --> 00:12:33,200
rep and profile on these bug bounty

345
00:12:33,200 --> 00:12:35,200
platforms will prove to be pretty

346
00:12:35,200 --> 00:12:36,800
important in the future as a bug bounty

347
00:12:36,800 --> 00:12:38,959
hunter it will lead to things like more

348
00:12:38,959 --> 00:12:41,120
invites to private programs and even

349
00:12:41,120 --> 00:12:42,800
potentially invites to live hacking

350
00:12:42,800 --> 00:12:44,560
events

351
00:12:44,560 --> 00:12:46,720
there's still so much low hanging fruit

352
00:12:46,720 --> 00:12:48,240
out there you just need to be looking

353
00:12:48,240 --> 00:12:50,560
for it

354
00:12:51,040 --> 00:12:52,720
so this is one of the bugs that you know

355
00:12:52,720 --> 00:12:54,160
i found when i was first getting into

356
00:12:54,160 --> 00:12:57,120
bounties seriously and i you know

357
00:12:57,120 --> 00:12:59,200
essentially unmapped all of the assets i

358
00:12:59,200 --> 00:13:01,200
could discover on the attack surface and

359
00:13:01,200 --> 00:13:04,320
discovered the port 6389 on nasa now

360
00:13:04,320 --> 00:13:07,760
6389 is typically used by redis and by

361
00:13:07,760 --> 00:13:10,079
using netcat i could basically

362
00:13:10,079 --> 00:13:12,480
connect to this server on this port and

363
00:13:12,480 --> 00:13:15,360
i identified an exposed reader server

364
00:13:15,360 --> 00:13:17,839
um with this i could list all the values

365
00:13:17,839 --> 00:13:19,279
i could potentially get command

366
00:13:19,279 --> 00:13:21,600
execution i could dust the machine and

367
00:13:21,600 --> 00:13:23,200
there was even second order attacks by

368
00:13:23,200 --> 00:13:25,440
sending malicious values at the end they

369
00:13:25,440 --> 00:13:27,680
only really paid 500 for this because i

370
00:13:27,680 --> 00:13:29,279
couldn't improve impact beyond just

371
00:13:29,279 --> 00:13:31,839
setting and getting the keys um so this

372
00:13:31,839 --> 00:13:34,079
was a really low risk bug but at the end

373
00:13:34,079 --> 00:13:35,600
of the day it still got paid a decent

374
00:13:35,600 --> 00:13:37,920
amount of money at the time and it was a

375
00:13:37,920 --> 00:13:40,240
successful find

376
00:13:40,240 --> 00:13:42,480
another bug in a similar vein was an

377
00:13:42,480 --> 00:13:45,279
exposed aj proxy statistics valve so

378
00:13:45,279 --> 00:13:47,519
again i ran an nmap scan across all

379
00:13:47,519 --> 00:13:50,720
their assets found an open port on 444

380
00:13:50,720 --> 00:13:53,440
and going to this asset i found a ha

381
00:13:53,440 --> 00:13:55,760
proxy statistics panel really simple

382
00:13:55,760 --> 00:13:57,760
vulnerability again really low hanging

383
00:13:57,760 --> 00:13:59,600
fruit very limited information

384
00:13:59,600 --> 00:14:03,839
disclosure outdated software potential

385
00:14:16,560 --> 00:14:17,920
then i

386
00:14:17,920 --> 00:14:19,600
started reporting things like open

387
00:14:19,600 --> 00:14:22,320
administration interfaces um some bug

388
00:14:22,320 --> 00:14:24,320
bounty programs actually value this sort

389
00:14:24,320 --> 00:14:26,000
of submission because they don't expect

390
00:14:26,000 --> 00:14:28,079
any of their administration interfaces

391
00:14:28,079 --> 00:14:30,639
to be on the external internet um so i

392
00:14:30,639 --> 00:14:32,320
reported this to this program and they

393
00:14:32,320 --> 00:14:34,639
also paid a 500 pound

394
00:14:34,639 --> 00:14:35,519
um

395
00:14:35,519 --> 00:14:37,600
it's important to remember that this is

396
00:14:37,600 --> 00:14:40,079
five years ago and you know i wasn't as

397
00:14:40,079 --> 00:14:42,320
experienced or talented back then all of

398
00:14:42,320 --> 00:14:44,240
these bugs again are really simple to

399
00:14:44,240 --> 00:14:46,079
find and were things that i found just

400
00:14:46,079 --> 00:14:48,399
by doing some basic reconnaissance on

401
00:14:48,399 --> 00:14:51,360
all of these targets

402
00:14:51,360 --> 00:14:53,199
i tried to be a little cheeky i thought

403
00:14:53,199 --> 00:14:55,519
okay i found one an open administration

404
00:14:55,519 --> 00:14:58,000
interface what if um i've actually found

405
00:14:58,000 --> 00:14:59,839
multiple what if i report all of them as

406
00:14:59,839 --> 00:15:01,440
separate reports are they going to pay

407
00:15:01,440 --> 00:15:04,320
500 per report now one thing i can say

408
00:15:04,320 --> 00:15:06,480
to the broader community and people who

409
00:15:06,480 --> 00:15:08,320
are watching this is

410
00:15:08,320 --> 00:15:10,880
almost always when you find an instance

411
00:15:10,880 --> 00:15:12,639
of a vulnerability repeated across an

412
00:15:12,639 --> 00:15:14,800
attack surface most companies aren't

413
00:15:14,800 --> 00:15:17,040
going to pay for each individual report

414
00:15:17,040 --> 00:15:18,639
they're usually going to close it as a

415
00:15:18,639 --> 00:15:21,760
duplicate so i tried reporting this same

416
00:15:21,760 --> 00:15:23,600
issue across different assets in

417
00:15:23,600 --> 00:15:26,320
multiple reports but you know they ended

418
00:15:26,320 --> 00:15:28,480
up paying for it only once and the only

419
00:15:28,480 --> 00:15:30,000
um that's how they treated the

420
00:15:30,000 --> 00:15:31,120
vulnerability

421
00:15:31,120 --> 00:15:33,839
some programs do prefer it being batched

422
00:15:33,839 --> 00:15:36,160
up into a single report other programs

423
00:15:36,160 --> 00:15:37,680
might prefer it being

424
00:15:37,680 --> 00:15:40,800
in each separate reports but

425
00:15:40,800 --> 00:15:42,000
this is something that you have to

426
00:15:42,000 --> 00:15:44,240
experiment with with bug bounty programs

427
00:15:44,240 --> 00:15:45,839
it really depends on the program and

428
00:15:45,839 --> 00:15:47,680
what their preference is

429
00:15:47,680 --> 00:15:49,279
but in this instance i tried to be a

430
00:15:49,279 --> 00:15:51,279
little cheeky and it didn't really work

431
00:15:51,279 --> 00:15:53,360
out it closed all the extra reports i

432
00:15:53,360 --> 00:15:56,399
made as due tickets

433
00:15:56,560 --> 00:15:58,560
and here's some more low-risk bugs that

434
00:15:58,560 --> 00:16:00,880
i found five years ago so open

435
00:16:00,880 --> 00:16:02,880
administration interfaces reflected

436
00:16:02,880 --> 00:16:04,880
cross-site scripting

437
00:16:04,880 --> 00:16:07,040
information disclosure and dos url

438
00:16:07,040 --> 00:16:08,399
redirection

439
00:16:08,399 --> 00:16:11,279
again open it admin interfaces and also

440
00:16:11,279 --> 00:16:13,440
some exposed network devices

441
00:16:13,440 --> 00:16:16,079
um many more of these were low-risk bugs

442
00:16:16,079 --> 00:16:18,720
were found five years ago and the reason

443
00:16:18,720 --> 00:16:20,480
why i'm going into so much detail about

444
00:16:20,480 --> 00:16:22,720
these low-risk bugs is to give you some

445
00:16:22,720 --> 00:16:24,639
perspective about what it was like when

446
00:16:24,639 --> 00:16:27,120
i first started in bugbentees i didn't

447
00:16:27,120 --> 00:16:29,279
just start immediately making a large

448
00:16:29,279 --> 00:16:30,800
amount of money in bug bounties or

449
00:16:30,800 --> 00:16:32,399
finding critical vulnerabilities when i

450
00:16:32,399 --> 00:16:34,399
first started and i don't think it's

451
00:16:34,399 --> 00:16:36,399
reasonable to expect anyone to do that

452
00:16:36,399 --> 00:16:38,800
as soon as they start bug bounties but

453
00:16:38,800 --> 00:16:40,399
it was a slow process and it was

454
00:16:40,399 --> 00:16:42,320
something that i developed over time

455
00:16:42,320 --> 00:16:44,000
these were some of the lowest bugs in

456
00:16:44,000 --> 00:16:46,639
that process

457
00:16:46,880 --> 00:16:48,560
the last thing that i want to point out

458
00:16:48,560 --> 00:16:49,600
is

459
00:16:49,600 --> 00:16:52,079
a high payout does not necessarily mean

460
00:16:52,079 --> 00:16:54,720
that the bug was complex or hard to

461
00:16:54,720 --> 00:16:58,000
exploit um so this example was a simple

462
00:16:58,000 --> 00:17:00,320
subdomain hijacking bug something

463
00:17:00,320 --> 00:17:02,959
takeover bug um and it got paid out

464
00:17:02,959 --> 00:17:05,280
seven and a half grand it was really

465
00:17:05,280 --> 00:17:07,280
simple to exploit and find the

466
00:17:07,280 --> 00:17:10,160
vulnerability however the reason we got

467
00:17:10,160 --> 00:17:12,480
paid out such a high amount of money is

468
00:17:12,480 --> 00:17:15,039
because of the impact it had for this

469
00:17:15,039 --> 00:17:17,359
particular customer on hacker one and

470
00:17:17,359 --> 00:17:19,359
they recognized the impact and they paid

471
00:17:19,359 --> 00:17:20,160
out

472
00:17:20,160 --> 00:17:23,280
based on that impact

473
00:17:24,319 --> 00:17:26,480
along the way i also had a lot of any

474
00:17:26,480 --> 00:17:28,400
bugs so here's an example of some of the

475
00:17:28,400 --> 00:17:30,400
bugs that were not applicable and were

476
00:17:30,400 --> 00:17:33,679
denied a bug bounty entirely um this is

477
00:17:33,679 --> 00:17:35,280
natural so if you're starting to get

478
00:17:35,280 --> 00:17:37,840
into bug bounties um this does happen

479
00:17:37,840 --> 00:17:39,520
and you shouldn't be too bummed out by

480
00:17:39,520 --> 00:17:40,880
it it should give you a good

481
00:17:40,880 --> 00:17:43,039
understanding of what is an acceptable

482
00:17:43,039 --> 00:17:45,360
bug and what isn't an acceptable bug and

483
00:17:45,360 --> 00:17:47,440
you should be formulating your opinion

484
00:17:47,440 --> 00:17:49,600
on what bugs to report based on the

485
00:17:49,600 --> 00:17:51,679
experience you have from the n a bugs

486
00:17:51,679 --> 00:17:53,919
that you've received in the past i don't

487
00:17:53,919 --> 00:17:56,080
really have any bugs that get classified

488
00:17:56,080 --> 00:17:57,760
as n a these days

489
00:17:57,760 --> 00:17:59,679
most of my bugs do get triaged and you

490
00:17:59,679 --> 00:18:01,679
get paid out because i have had the

491
00:18:01,679 --> 00:18:03,280
experience and i've gone through the

492
00:18:03,280 --> 00:18:05,679
process of understanding what is a bug

493
00:18:05,679 --> 00:18:07,520
that's actually valuable to a company

494
00:18:07,520 --> 00:18:09,520
versus what is i think what's really

495
00:18:09,520 --> 00:18:12,000
important to remember is focusing on the

496
00:18:12,000 --> 00:18:13,919
impact it has to the company before

497
00:18:13,919 --> 00:18:16,080
reporting it if the bug doesn't really

498
00:18:16,080 --> 00:18:18,000
have any security impact it's most

499
00:18:18,000 --> 00:18:21,840
likely going to end up as an a bug

500
00:18:22,960 --> 00:18:24,400
so the retrospective you know

501
00:18:24,400 --> 00:18:26,240
competition between other bug bounty

502
00:18:26,240 --> 00:18:28,320
hunters that really helped me that

503
00:18:28,320 --> 00:18:31,120
really facilitated growth for me and it

504
00:18:31,120 --> 00:18:33,039
helped me innovate in the field of bug

505
00:18:33,039 --> 00:18:34,880
bounties because i wanted to beat any

506
00:18:34,880 --> 00:18:36,880
competi any people that i was competing

507
00:18:36,880 --> 00:18:39,120
with um it was also important to have

508
00:18:39,120 --> 00:18:41,200
the right mindset coming up with logical

509
00:18:41,200 --> 00:18:44,080
plans and executing them um low-hanging

510
00:18:44,080 --> 00:18:46,240
fruit is literally everywhere you can

511
00:18:46,240 --> 00:18:48,000
always capitalize on this if you're

512
00:18:48,000 --> 00:18:49,440
looking hard enough

513
00:18:49,440 --> 00:18:51,679
um and another thing i realized in this

514
00:18:51,679 --> 00:18:53,840
process five years ago was that hacking

515
00:18:53,840 --> 00:18:55,919
on bug bounty programs is actually

516
00:18:55,919 --> 00:18:57,360
pretty addictive because when you

517
00:18:57,360 --> 00:18:59,280
receive the bounty it usually causes a

518
00:18:59,280 --> 00:19:01,600
rush of happiness and um that's

519
00:19:01,600 --> 00:19:03,280
something i recognized that i really

520
00:19:03,280 --> 00:19:05,679
enjoyed and wanted to continue so

521
00:19:05,679 --> 00:19:08,080
um i you know reported low to medium

522
00:19:08,080 --> 00:19:09,679
bugs for most of that year but i was

523
00:19:09,679 --> 00:19:11,600
pretty happy that companies recognized

524
00:19:11,600 --> 00:19:14,480
my efforts and paid out my bug reports

525
00:19:14,480 --> 00:19:16,880
and ultimately the impact determines the

526
00:19:16,880 --> 00:19:19,039
payout simple bugs can still be very

527
00:19:19,039 --> 00:19:21,200
impactful and still be rewarded a large

528
00:19:21,200 --> 00:19:24,600
amount of money

529
00:19:24,720 --> 00:19:26,720
so in contrast to shops who spent most

530
00:19:26,720 --> 00:19:29,679
of 2015 doing full-time bug bounties um

531
00:19:29,679 --> 00:19:31,440
i was still going on with my uni degree

532
00:19:31,440 --> 00:19:33,840
so i didn't necessarily have as much

533
00:19:33,840 --> 00:19:35,760
time or freedom to do this each and

534
00:19:35,760 --> 00:19:37,679
every week

535
00:19:37,679 --> 00:19:38,480
and

536
00:19:38,480 --> 00:19:41,200
i realized that like from shabam's talk

537
00:19:41,200 --> 00:19:43,360
and chatting to him after the first bug

538
00:19:43,360 --> 00:19:45,440
i reported he has a whole wealth of

539
00:19:45,440 --> 00:19:47,280
already like knowledge and experience in

540
00:19:47,280 --> 00:19:49,600
exploring large attack surfaces whereas

541
00:19:49,600 --> 00:19:51,679
i probably didn't have as much expertise

542
00:19:51,679 --> 00:19:54,160
and filtering through so many results so

543
00:19:54,160 --> 00:19:55,600
instead i opted to look at things i was

544
00:19:55,600 --> 00:19:57,440
familiar with and probably things i had

545
00:19:57,440 --> 00:19:59,280
more like an in-depth understanding of

546
00:19:59,280 --> 00:20:00,880
how things worked

547
00:20:00,880 --> 00:20:01,760
um

548
00:20:01,760 --> 00:20:03,679
and that being said i spent most of my

549
00:20:03,679 --> 00:20:06,159
time studying in 2015 and i instead only

550
00:20:06,159 --> 00:20:08,640
opted to do bug bounties as short bursts

551
00:20:08,640 --> 00:20:10,960
of like a couple weeks between semesters

552
00:20:10,960 --> 00:20:12,720
or during down times

553
00:20:12,720 --> 00:20:14,320
um and i only really submitted about

554
00:20:14,320 --> 00:20:16,240
like two or three bugs in this entire

555
00:20:16,240 --> 00:20:18,400
like two or three period i won't

556
00:20:18,400 --> 00:20:20,480
necessarily advise dropping out to do

557
00:20:20,480 --> 00:20:22,080
bog boundaries full time instead of

558
00:20:22,080 --> 00:20:24,320
studying but i can say like there's two

559
00:20:24,320 --> 00:20:25,520
sides of the coin that you really want

560
00:20:25,520 --> 00:20:27,039
to pursue

561
00:20:27,039 --> 00:20:28,880
one of the major bugs that i did report

562
00:20:28,880 --> 00:20:30,880
that i was quite surprised about

563
00:20:30,880 --> 00:20:34,880
honestly uh was in the same clg code um

564
00:20:34,880 --> 00:20:36,640
they have a thick client application and

565
00:20:36,640 --> 00:20:39,440
this is notoriously difficult to

566
00:20:39,440 --> 00:20:41,360
typically reverse and intercept with

567
00:20:41,360 --> 00:20:43,440
things like burp proxy because you can't

568
00:20:43,440 --> 00:20:45,200
just like point your browser at it right

569
00:20:45,200 --> 00:20:47,280
it's wrapped inside its own thick

570
00:20:47,280 --> 00:20:48,960
application

571
00:20:48,960 --> 00:20:50,720
um so after a lot of fiddling around i

572
00:20:50,720 --> 00:20:52,000
figured out how to open up this

573
00:20:52,000 --> 00:20:54,159
application as my system proxy and i

574
00:20:54,159 --> 00:20:56,240
started understanding a bit more about

575
00:20:56,240 --> 00:20:59,200
how the store that i previously hacked

576
00:20:59,200 --> 00:21:00,080
worked

577
00:21:00,080 --> 00:21:01,840
and this is like noticeably a very

578
00:21:01,840 --> 00:21:03,840
different client to what you saw in the

579
00:21:03,840 --> 00:21:06,000
previous screenshots um because they've

580
00:21:06,000 --> 00:21:07,600
drastically changed in the period of

581
00:21:07,600 --> 00:21:09,679
time between the first time i hacked

582
00:21:09,679 --> 00:21:11,200
them and the second time again looking

583
00:21:11,200 --> 00:21:12,080
at them

584
00:21:12,080 --> 00:21:13,679
um and digging through their website i

585
00:21:13,679 --> 00:21:16,320
realized that wow this is just another

586
00:21:16,320 --> 00:21:18,000
poorly written web app at the end of the

587
00:21:18,000 --> 00:21:18,960
day

588
00:21:18,960 --> 00:21:21,120
and surprisingly enough behind all the

589
00:21:21,120 --> 00:21:23,760
layers of like complexity and challenges

590
00:21:23,760 --> 00:21:26,640
of trying to set up a proxy around it

591
00:21:26,640 --> 00:21:28,960
you can still pop xss and at the end of

592
00:21:28,960 --> 00:21:30,640
the day even the simplest bugs still

593
00:21:30,640 --> 00:21:32,480
yield great results and something i

594
00:21:32,480 --> 00:21:34,080
thought would have been well covered

595
00:21:34,080 --> 00:21:35,360
turns out is probably a bit more

596
00:21:35,360 --> 00:21:37,200
difficult to understand

597
00:21:37,200 --> 00:21:38,960
that being said i think

598
00:21:38,960 --> 00:21:40,559
throughout this period there also were

599
00:21:40,559 --> 00:21:42,240
heaps of droops that i did submit

600
00:21:42,240 --> 00:21:43,760
amongst these like couple that were

601
00:21:43,760 --> 00:21:46,320
legitimately reported um and some of

602
00:21:46,320 --> 00:21:47,600
them were just as simple as like

603
00:21:47,600 --> 00:21:49,840
reporting cv bugs admittedly this was

604
00:21:49,840 --> 00:21:53,120
back in 2015 so when drupal bugs popped

605
00:21:53,120 --> 00:21:55,120
not everyone jumped on it within 24

606
00:21:55,120 --> 00:21:56,720
hours there still was plenty of lead

607
00:21:56,720 --> 00:21:58,400
time for you to exploit them

608
00:21:58,400 --> 00:21:59,919
but this is what it looks like doing bug

609
00:21:59,919 --> 00:22:00,960
bounties while you're studying and

610
00:22:00,960 --> 00:22:02,320
there's still plenty of opportunity to

611
00:22:02,320 --> 00:22:04,559
both go wide and go deep with your

612
00:22:04,559 --> 00:22:07,760
knowledge and expertise

613
00:22:08,720 --> 00:22:10,400
cool

614
00:22:10,400 --> 00:22:13,679
from 2016 to 2018 there was a real focus

615
00:22:13,679 --> 00:22:16,000
on techniques um

616
00:22:16,000 --> 00:22:18,240
so you know after getting my feet wet in

617
00:22:18,240 --> 00:22:20,320
bug bounties i focus on techniques that

618
00:22:20,320 --> 00:22:22,159
can amplify the severity of my bugs and

619
00:22:22,159 --> 00:22:24,240
the payouts i was receiving um this

620
00:22:24,240 --> 00:22:26,880
often involved being pretty creative and

621
00:22:26,880 --> 00:22:28,480
identifying weak spots and attack

622
00:22:28,480 --> 00:22:30,880
surfaces um that could be reliably

623
00:22:30,880 --> 00:22:33,200
targeted when approaching targets

624
00:22:33,200 --> 00:22:34,159
um

625
00:22:34,159 --> 00:22:35,919
in order to do this and amplify the

626
00:22:35,919 --> 00:22:39,120
severity um i spent less time on client

627
00:22:39,120 --> 00:22:41,440
side issues and i started focusing on

628
00:22:41,440 --> 00:22:44,400
server-side bugs instead

629
00:22:44,400 --> 00:22:46,480
this evolution

630
00:22:46,480 --> 00:22:48,799
was necessary in order to

631
00:22:48,799 --> 00:22:50,720
be more successful in making higher

632
00:22:50,720 --> 00:22:53,120
payouts and bounties and

633
00:22:53,120 --> 00:22:54,559
also it was necessary to have

634
00:22:54,559 --> 00:22:57,440
persistence when executing these ideas

635
00:22:57,440 --> 00:22:58,880
um

636
00:22:58,880 --> 00:23:01,280
an open mind is also necessary to come

637
00:23:01,280 --> 00:23:03,120
up with ideas that may work in order to

638
00:23:03,120 --> 00:23:04,960
execute on those ideas you must first

639
00:23:04,960 --> 00:23:08,480
believe that it's possible

640
00:23:08,480 --> 00:23:10,480
um one of the examples is you know this

641
00:23:10,480 --> 00:23:13,039
bug that had multiple steps to victory

642
00:23:13,039 --> 00:23:16,000
um the bug's title was ability to write

643
00:23:16,000 --> 00:23:18,799
arbitrary scripts to this subdomain and

644
00:23:18,799 --> 00:23:20,000
another subdomain through a

645
00:23:20,000 --> 00:23:21,840
misconfigured s3

646
00:23:21,840 --> 00:23:24,320
however like while that might might seem

647
00:23:24,320 --> 00:23:26,480
um pretty straightforward that it was a

648
00:23:26,480 --> 00:23:28,880
misconfigured s3 bucket the steps to

649
00:23:28,880 --> 00:23:30,720
discovering the s3 bucket were actually

650
00:23:30,720 --> 00:23:32,720
really tricky and if there's something

651
00:23:32,720 --> 00:23:34,159
that you can take away from this

652
00:23:34,159 --> 00:23:36,240
presentation what i would love for it to

653
00:23:36,240 --> 00:23:37,919
be is that

654
00:23:37,919 --> 00:23:40,480
never to underestimate the value of good

655
00:23:40,480 --> 00:23:42,640
recommendations because sometimes good

656
00:23:42,640 --> 00:23:44,640
reconnaissance might require a large

657
00:23:44,640 --> 00:23:47,039
number of steps or complicated number of

658
00:23:47,039 --> 00:23:50,720
steps that lead to the vulnerabilities

659
00:23:50,720 --> 00:23:52,400
to find this bug there are at least

660
00:23:52,400 --> 00:23:54,400
seven steps involved starting at the

661
00:23:54,400 --> 00:23:56,159
company's blog and ending up at an

662
00:23:56,159 --> 00:23:58,799
exposed api that disclosed an s3 bucket

663
00:23:58,799 --> 00:24:00,480
that the company was using

664
00:24:00,480 --> 00:24:01,919
the bucket was in use by several

665
00:24:01,919 --> 00:24:03,520
applications and you could write to it

666
00:24:03,520 --> 00:24:05,279
as an anonymous user

667
00:24:05,279 --> 00:24:07,600
so i guess what i'd like to convey is

668
00:24:07,600 --> 00:24:09,679
you know don't be afraid to dig deeper

669
00:24:09,679 --> 00:24:11,600
uh sometimes digging deeper leads to

670
00:24:11,600 --> 00:24:13,840
gold and this was the case in this bug

671
00:24:13,840 --> 00:24:15,600
this bug was paid out seven and a half

672
00:24:15,600 --> 00:24:17,200
grand due to the impact it had to the

673
00:24:17,200 --> 00:24:19,840
company

674
00:24:19,840 --> 00:24:21,360
another example when it comes to

675
00:24:21,360 --> 00:24:23,200
focusing on techniques is second order

676
00:24:23,200 --> 00:24:25,600
takeovers so let's say for example your

677
00:24:25,600 --> 00:24:27,840
company uses sassservice1.com

678
00:24:27,840 --> 00:24:29,520
and it embeds content from that service

679
00:24:29,520 --> 00:24:31,760
across across your blog site

680
00:24:31,760 --> 00:24:33,200
if you've embedded links from this

681
00:24:33,200 --> 00:24:35,279
service and you might have these links

682
00:24:35,279 --> 00:24:37,679
embedded all over the place what happens

683
00:24:37,679 --> 00:24:39,760
um on the day that you stop using this

684
00:24:39,760 --> 00:24:41,200
service and you delete your account from

685
00:24:41,200 --> 00:24:42,880
their systems can someone else

686
00:24:42,880 --> 00:24:45,039
potentially claim these links are these

687
00:24:45,039 --> 00:24:46,799
embedded links still present in all of

688
00:24:46,799 --> 00:24:49,200
your blog posts if that's the case what

689
00:24:49,200 --> 00:24:51,120
happens if an attacker just registers on

690
00:24:51,120 --> 00:24:51,919
this

691
00:24:51,919 --> 00:24:54,919
serviceone.comaccount.com

692
00:24:55,200 --> 00:24:57,440
website and registers an account with

693
00:24:57,440 --> 00:24:59,679
the same name as yours can they now

694
00:24:59,679 --> 00:25:02,480
claim all of those links in that case an

695
00:25:02,480 --> 00:25:04,320
attacker could take over all the pages

696
00:25:04,320 --> 00:25:06,960
within the blog posts um so that that's

697
00:25:06,960 --> 00:25:08,799
what exactly what happened in this case

698
00:25:08,799 --> 00:25:10,799
and i was able to take over a bunch of

699
00:25:10,799 --> 00:25:14,000
blog post pages um through this sas

700
00:25:14,000 --> 00:25:16,159
service called wufu which is a form

701
00:25:16,159 --> 00:25:18,400
service so i could replace all the forms

702
00:25:18,400 --> 00:25:20,080
inside these blog posts with my own

703
00:25:20,080 --> 00:25:22,480
forms

704
00:25:23,279 --> 00:25:25,440
another technique that i really started

705
00:25:25,440 --> 00:25:27,760
focusing on throughout these years where

706
00:25:27,760 --> 00:25:30,159
um was expanding the scope

707
00:25:30,159 --> 00:25:32,400
so one thing um when it comes to

708
00:25:32,400 --> 00:25:34,000
approaching bug bounties is having the

709
00:25:34,000 --> 00:25:36,480
right mindset and many programs out

710
00:25:36,480 --> 00:25:38,960
there they consider any asset owned by

711
00:25:38,960 --> 00:25:41,120
them to be in scope now this isn't the

712
00:25:41,120 --> 00:25:43,120
case for all the programs but i

713
00:25:43,120 --> 00:25:45,039
certainly know some companies like uber

714
00:25:45,039 --> 00:25:48,159
for example um that really do have this

715
00:25:48,159 --> 00:25:50,720
open mindset about anything owned by us

716
00:25:50,720 --> 00:25:52,880
is in scope

717
00:25:52,880 --> 00:25:54,960
except for some exceptions

718
00:25:54,960 --> 00:25:56,480
and i realized that some of these large

719
00:25:56,480 --> 00:25:58,400
companies they operate in almost every

720
00:25:58,400 --> 00:26:01,039
country in the world so surely there's

721
00:26:01,039 --> 00:26:03,120
uh there are assets that are deployed in

722
00:26:03,120 --> 00:26:05,440
specific regions or countries that may

723
00:26:05,440 --> 00:26:07,279
not be as secure as the company's main

724
00:26:07,279 --> 00:26:10,640
assets that was the main hypothesis and

725
00:26:10,640 --> 00:26:13,039
that hypothesis was proven again and

726
00:26:13,039 --> 00:26:15,039
again and it's led to the discovery of

727
00:26:15,039 --> 00:26:17,440
critical vulnerabilities time after time

728
00:26:17,440 --> 00:26:19,200
it's all about finding weaknesses and

729
00:26:19,200 --> 00:26:22,840
blind spots in the attack surface

730
00:26:22,840 --> 00:26:25,760
so this point in time uh subs and myself

731
00:26:25,760 --> 00:26:28,320
started collaborating on more bugs and

732
00:26:28,320 --> 00:26:30,080
at this point he was really into looking

733
00:26:30,080 --> 00:26:32,320
at like a specific transport company and

734
00:26:32,320 --> 00:26:34,240
across these different countries

735
00:26:34,240 --> 00:26:35,279
um so

736
00:26:35,279 --> 00:26:37,120
in

737
00:26:37,120 --> 00:26:37,600
co russia

738
00:26:37,600 --> 00:26:41,279
iu was a contracted division to run

739
00:26:41,279 --> 00:26:42,960
the transport current in that country as

740
00:26:42,960 --> 00:26:45,440
the case with most multinational tech

741
00:26:45,440 --> 00:26:47,200
companies and

742
00:26:47,200 --> 00:26:49,679
prior to transport.co introducing like

743
00:26:49,679 --> 00:26:51,919
businesses and collaboration like

744
00:26:51,919 --> 00:26:54,720
coordination feature in the us there was

745
00:26:54,720 --> 00:26:57,120
sampling trialing in russia

746
00:26:57,120 --> 00:26:59,039
where you could hire other users and

747
00:26:59,039 --> 00:27:00,960
recruit other users

748
00:27:00,960 --> 00:27:03,039
and what we found was our initial entry

749
00:27:03,039 --> 00:27:05,720
point was a specific subdomain bought

750
00:27:05,720 --> 00:27:08,799
api.transport corru which led us to a

751
00:27:08,799 --> 00:27:11,279
telegram bot that lets you like manage

752
00:27:11,279 --> 00:27:14,400
your transport code drivers

753
00:27:14,400 --> 00:27:16,480
and shelves started hopping on chat with

754
00:27:16,480 --> 00:27:19,039
this telegram bot

755
00:27:19,039 --> 00:27:21,120
and here you can see him having a very

756
00:27:21,120 --> 00:27:24,080
fascinating discussion in russian um and

757
00:27:24,080 --> 00:27:25,760
we couldn't actually really

758
00:27:25,760 --> 00:27:27,679
make the link initially between this

759
00:27:27,679 --> 00:27:31,039
transport bot and uh transport co until

760
00:27:31,039 --> 00:27:32,480
we started clicking through the links it

761
00:27:32,480 --> 00:27:34,640
offered and then it sent up to this

762
00:27:34,640 --> 00:27:37,840
random russian sounding website

763
00:27:37,840 --> 00:27:39,600
and starting to do some reconnaissance

764
00:27:39,600 --> 00:27:41,919
and brute forcing on this box we noticed

765
00:27:41,919 --> 00:27:45,039
this was a pretty dirty box and when i

766
00:27:45,039 --> 00:27:47,120
say dirty i mean you could see a

767
00:27:47,120 --> 00:27:49,279
developer was probably writing scripts

768
00:27:49,279 --> 00:27:51,039
on this box and using this box as their

769
00:27:51,039 --> 00:27:52,799
primary means of development

770
00:27:52,799 --> 00:27:54,000
so we started going through the

771
00:27:54,000 --> 00:27:55,520
directories and started clicking through

772
00:27:55,520 --> 00:27:57,039
some of these files

773
00:27:57,039 --> 00:27:58,960
and it turns out that these files is

774
00:27:58,960 --> 00:28:01,039
just the source code for what's running

775
00:28:01,039 --> 00:28:03,120
on the website so this completely

776
00:28:03,120 --> 00:28:04,399
changed from

777
00:28:04,399 --> 00:28:06,720
like a reconnaissance mission to now a

778
00:28:06,720 --> 00:28:08,720
source auditing and just straight up

779
00:28:08,720 --> 00:28:11,440
shelling straight through the box

780
00:28:11,440 --> 00:28:12,880
clicking through some more scripts you

781
00:28:12,880 --> 00:28:15,520
could see more dodgy things um there was

782
00:28:15,520 --> 00:28:17,919
a script called test2.php

783
00:28:17,919 --> 00:28:19,440
and here it just listed a whole bunch of

784
00:28:19,440 --> 00:28:21,679
what we presume are phone numbers and

785
00:28:21,679 --> 00:28:24,159
usernames or like users

786
00:28:24,159 --> 00:28:26,080
um and going through more scripts there

787
00:28:26,080 --> 00:28:28,640
was another test of php script and this

788
00:28:28,640 --> 00:28:30,240
one just started putting out debug

789
00:28:30,240 --> 00:28:32,000
information and we couldn't really make

790
00:28:32,000 --> 00:28:34,799
sense of it at first um but looking

791
00:28:34,799 --> 00:28:36,480
deeply at it you can see there's some

792
00:28:36,480 --> 00:28:39,039
words that say google service sheets and

793
00:28:39,039 --> 00:28:41,679
then this spreadsheet id

794
00:28:41,679 --> 00:28:43,120
and we're thinking like what could the

795
00:28:43,120 --> 00:28:45,760
spreadsheet id possibly be for

796
00:28:45,760 --> 00:28:48,559
um well if you recognize the format

797
00:28:48,559 --> 00:28:50,399
that's the spreadsheet id for google

798
00:28:50,399 --> 00:28:51,279
sheets

799
00:28:51,279 --> 00:28:53,679
so we copy pasted that in to google

800
00:28:53,679 --> 00:28:55,679
sheets and out came

801
00:28:55,679 --> 00:28:57,679
all the user data for users of this

802
00:28:57,679 --> 00:28:59,120
application

803
00:28:59,120 --> 00:29:02,399
now turns out what was happening was the

804
00:29:02,399 --> 00:29:05,200
transport co russia like subsidiary or

805
00:29:05,200 --> 00:29:07,840
like contracted company was managing all

806
00:29:07,840 --> 00:29:10,480
their user data in one big google sheet

807
00:29:10,480 --> 00:29:13,360
and then they wrote a php app to wrap

808
00:29:13,360 --> 00:29:14,880
the data for the google sheets so they

809
00:29:14,880 --> 00:29:16,640
could interface it with it from their

810
00:29:16,640 --> 00:29:18,399
telegram app

811
00:29:18,399 --> 00:29:20,399
what ended up happening is we managed to

812
00:29:20,399 --> 00:29:22,559
get the email addresses the phone

813
00:29:22,559 --> 00:29:26,000
numbers and then the banking details for

814
00:29:26,000 --> 00:29:27,919
all of these transport co drivers in

815
00:29:27,919 --> 00:29:30,000
russia now you may be thinking like what

816
00:29:30,000 --> 00:29:32,240
can you do with banking details in this

817
00:29:32,240 --> 00:29:35,039
case the banking swift and bic numbers

818
00:29:35,039 --> 00:29:37,679
can be used to initiate international

819
00:29:37,679 --> 00:29:39,840
transfers against like without the

820
00:29:39,840 --> 00:29:42,240
owner's knowledge or will so

821
00:29:42,240 --> 00:29:43,919
that's actually pretty insane if you

822
00:29:43,919 --> 00:29:45,840
think about it we could have accessed

823
00:29:45,840 --> 00:29:47,600
thousands of users of banks accounts if

824
00:29:47,600 --> 00:29:49,200
we really wanted to go down the fraud

825
00:29:49,200 --> 00:29:50,000
path

826
00:29:50,000 --> 00:29:51,840
thankfully we just reported it to the

827
00:29:51,840 --> 00:29:55,120
transport co and they paid out for 4 500

828
00:29:55,120 --> 00:29:57,120
for effectively looking at scope that

829
00:29:57,120 --> 00:29:58,320
was

830
00:29:58,320 --> 00:29:59,679
outside of what they listed in their

831
00:29:59,679 --> 00:30:01,360
scope but definitely still owned and

832
00:30:01,360 --> 00:30:02,640
managed by the company because it

833
00:30:02,640 --> 00:30:04,559
affected their users

834
00:30:04,559 --> 00:30:06,559
that being said i don't recommend

835
00:30:06,559 --> 00:30:08,159
randomly going and hacking other

836
00:30:08,159 --> 00:30:10,399
companies services because there's no

837
00:30:10,399 --> 00:30:11,919
guarantee they own it

838
00:30:11,919 --> 00:30:13,120
please make sure you do your due

839
00:30:13,120 --> 00:30:14,799
diligence and check that

840
00:30:14,799 --> 00:30:17,520
specific company.com actually owns this

841
00:30:17,520 --> 00:30:19,120
random other company you're hacking and

842
00:30:19,120 --> 00:30:21,360
you're not accidentally now becoming

843
00:30:21,360 --> 00:30:23,840
fully legal

844
00:30:26,399 --> 00:30:29,520
and another uh successful strategy when

845
00:30:29,520 --> 00:30:31,200
it comes to looking at techniques is

846
00:30:31,200 --> 00:30:33,520
looking at third-party platforms so i've

847
00:30:33,520 --> 00:30:35,200
been pretty successful with looking at

848
00:30:35,200 --> 00:30:37,120
information disclosure on third-party

849
00:30:37,120 --> 00:30:39,600
platforms now what does that really mean

850
00:30:39,600 --> 00:30:41,919
what do third-party platforms mean so

851
00:30:41,919 --> 00:30:43,760
third-party platforms include like

852
00:30:43,760 --> 00:30:45,600
source code repositories on github

853
00:30:45,600 --> 00:30:47,919
gitlab bitbucket knowledge-based

854
00:30:47,919 --> 00:30:50,000
articles on servicenow internal

855
00:30:50,000 --> 00:30:52,399
documentation of atlassian products but

856
00:30:52,399 --> 00:30:54,320
in all of these examples there's often

857
00:30:54,320 --> 00:30:56,559
the scenario that sensitive information

858
00:30:56,559 --> 00:30:58,960
is leaked and when sensitive information

859
00:30:58,960 --> 00:31:00,799
is leaked it can often lead to

860
00:31:00,799 --> 00:31:03,360
vulnerabilities or the disclosure of

861
00:31:03,360 --> 00:31:05,600
just even having that information leads

862
00:31:05,600 --> 00:31:06,720
could be

863
00:31:06,720 --> 00:31:09,360
a valid vulnerability a report

864
00:31:09,360 --> 00:31:11,440
one of the examples that i had was

865
00:31:11,440 --> 00:31:13,519
visiting a webex subdomain for this

866
00:31:13,519 --> 00:31:14,559
company

867
00:31:14,559 --> 00:31:16,399
and i was able to see and potentially

868
00:31:16,399 --> 00:31:18,799
join on any of the upcoming scheduled

869
00:31:18,799 --> 00:31:20,799
meetings i thought that this was pretty

870
00:31:20,799 --> 00:31:22,720
interesting because it was actually not

871
00:31:22,720 --> 00:31:24,559
a vulnerability directly in the

872
00:31:24,559 --> 00:31:26,720
company's infrastructure but rather

873
00:31:26,720 --> 00:31:29,360
rather in misconfiguration in one of the

874
00:31:29,360 --> 00:31:31,600
sas products that this company used

875
00:31:31,600 --> 00:31:33,200
this bug was paid out five hundred

876
00:31:33,200 --> 00:31:35,360
dollars

877
00:31:35,360 --> 00:31:37,840
another example of uh leveraging

878
00:31:37,840 --> 00:31:40,399
third-party platforms is on github i

879
00:31:40,399 --> 00:31:42,000
found the following snippet of code for

880
00:31:42,000 --> 00:31:43,840
a very large conglomerate running a bug

881
00:31:43,840 --> 00:31:45,120
bounty

882
00:31:45,120 --> 00:31:46,720
basically it had a subdomain

883
00:31:46,720 --> 00:31:48,480
dropbox.company.com

884
00:31:48,480 --> 00:31:51,200
and what looked to be ftp credentials

885
00:31:51,200 --> 00:31:53,039
these credentials were valid and it was

886
00:31:53,039 --> 00:31:54,960
possible to upload files to the ftp

887
00:31:54,960 --> 00:31:56,000
server

888
00:31:56,000 --> 00:31:57,840
this led to persistent xss because at

889
00:31:57,840 --> 00:32:00,480
the time flash still existed and it was

890
00:32:00,480 --> 00:32:02,559
possible to leverage flash to get

891
00:32:02,559 --> 00:32:04,080
persistent xss

892
00:32:04,080 --> 00:32:07,840
thank god that flash is dead today

893
00:32:08,720 --> 00:32:10,559
another really cool technique is

894
00:32:10,559 --> 00:32:13,840
dangling ip subdomain takeovers so when

895
00:32:13,840 --> 00:32:15,600
an ec2 instance is started it gets

896
00:32:15,600 --> 00:32:18,320
assigned an elastic ip aws manages a

897
00:32:18,320 --> 00:32:20,159
huge address space including all the

898
00:32:20,159 --> 00:32:21,519
elastic ips that are assigned to

899
00:32:21,519 --> 00:32:24,080
instances in many cases something means

900
00:32:24,080 --> 00:32:27,039
according to elastic ips um

901
00:32:27,039 --> 00:32:29,600
that uh that belong to an ec2 instance

902
00:32:29,600 --> 00:32:31,440
what happens when the ec2 instance is

903
00:32:31,440 --> 00:32:33,519
destroyed well in that scenario the

904
00:32:33,519 --> 00:32:35,440
elastic ip might get released into the

905
00:32:35,440 --> 00:32:37,279
pool again and someone else may claim

906
00:32:37,279 --> 00:32:38,960
that ip at random

907
00:32:38,960 --> 00:32:40,880
um so what happens to the substrings

908
00:32:40,880 --> 00:32:43,120
that are pointing to the elastic ip well

909
00:32:43,120 --> 00:32:44,720
someone else can potentially control the

910
00:32:44,720 --> 00:32:46,799
contents of that subdomain as they may

911
00:32:46,799 --> 00:32:48,880
now own the elastic ipv those subplanes

912
00:32:48,880 --> 00:32:51,440
are pointing to

913
00:32:51,840 --> 00:32:53,519
you can often detect this by checking

914
00:32:53,519 --> 00:32:55,440
ssl certificates and seeing whether or

915
00:32:55,440 --> 00:32:56,799
not the subdomain is pointing to a

916
00:32:56,799 --> 00:32:59,039
completely different company or asset

917
00:32:59,039 --> 00:33:02,000
but there is no such api on aws that

918
00:33:02,000 --> 00:33:04,640
lets you easily detect this

919
00:33:04,640 --> 00:33:06,640
if there was then this would be a much

920
00:33:06,640 --> 00:33:08,880
easier thing to find discover and report

921
00:33:08,880 --> 00:33:10,880
however nothing exists out there that

922
00:33:10,880 --> 00:33:12,559
lets you detect this

923
00:33:12,559 --> 00:33:14,320
some bug mounting hunters out there

924
00:33:14,320 --> 00:33:16,080
they're continuously claiming elastic

925
00:33:16,080 --> 00:33:18,080
ips from the pool to be able to take

926
00:33:18,080 --> 00:33:20,000
over something that's pointing to

927
00:33:20,000 --> 00:33:22,480
dangling elastic ips this is what is

928
00:33:22,480 --> 00:33:24,799
called the lottery approach and this

929
00:33:24,799 --> 00:33:26,960
approach is being taken by many hackers

930
00:33:26,960 --> 00:33:28,960
in the bug county community in order to

931
00:33:28,960 --> 00:33:31,039
do elastic ip takeovers

932
00:33:31,039 --> 00:33:33,120
um i often report this issue to bug

933
00:33:33,120 --> 00:33:34,720
bounties either it's a third party

934
00:33:34,720 --> 00:33:36,880
submarine hijack or i actually do take

935
00:33:36,880 --> 00:33:39,440
over the ip but in many cases again it

936
00:33:39,440 --> 00:33:40,960
can get paid out a hundred dollars to

937
00:33:40,960 --> 00:33:42,640
two thousand dollars it really depends

938
00:33:42,640 --> 00:33:45,919
on the severity and impact

939
00:33:45,919 --> 00:33:47,600
here's an example report where i

940
00:33:47,600 --> 00:33:51,120
reported dangling ip subdomain takeover

941
00:33:51,120 --> 00:33:53,600
this was an example where the response

942
00:33:53,600 --> 00:33:55,279
clearly indicated that it no longer

943
00:33:55,279 --> 00:33:57,039
belonged to the company

944
00:33:57,039 --> 00:33:58,720
this is not an example of where i've

945
00:33:58,720 --> 00:34:00,480
actually taken over the ipv this is just

946
00:34:00,480 --> 00:34:02,240
an example where i've noticed that the

947
00:34:02,240 --> 00:34:06,600
ip no longer belongs to the company

948
00:34:07,360 --> 00:34:10,560
so finally a retrospective from 2016 to

949
00:34:10,560 --> 00:34:13,199
2018 we were still finding low-hanging

950
00:34:13,199 --> 00:34:15,440
fruit like lying in fruit still exists

951
00:34:15,440 --> 00:34:18,000
today and still plenty of it

952
00:34:18,000 --> 00:34:19,760
we spent a lot more time coming up with

953
00:34:19,760 --> 00:34:21,199
ideas and following through with

954
00:34:21,199 --> 00:34:23,199
execution and this is a natural

955
00:34:23,199 --> 00:34:24,719
progression when it comes to becoming

956
00:34:24,719 --> 00:34:27,040
good at bug bounties you will naturally

957
00:34:27,040 --> 00:34:29,119
progress into coming up with ideas

958
00:34:29,119 --> 00:34:31,520
techniques and different strategies that

959
00:34:31,520 --> 00:34:34,320
you will execute with some confidence

960
00:34:34,320 --> 00:34:35,918
once you've done that you'll realize

961
00:34:35,918 --> 00:34:37,599
that you know there's a lot of

962
00:34:37,599 --> 00:34:39,359
possibilities of making a lot of money

963
00:34:39,359 --> 00:34:42,320
in bug bounties um another thing that we

964
00:34:42,320 --> 00:34:44,000
did throughout this time period is that

965
00:34:44,000 --> 00:34:46,079
we focused less on client-side issues

966
00:34:46,079 --> 00:34:47,599
and we focused more on server-side

967
00:34:47,599 --> 00:34:50,719
issues due to severity mostly the high

968
00:34:50,719 --> 00:34:52,719
severity vulnerabilities are found on

969
00:34:52,719 --> 00:34:56,000
server-side from server-side issues

970
00:34:56,000 --> 00:34:57,839
one thing that was absolutely key when

971
00:34:57,839 --> 00:35:00,320
it came to all of this was persistence

972
00:35:00,320 --> 00:35:02,079
often bugs were found after a

973
00:35:02,079 --> 00:35:04,240
complicated chain of events so it's

974
00:35:04,240 --> 00:35:05,440
really important that when you're

975
00:35:05,440 --> 00:35:07,200
happening on bug bounties or hacking in

976
00:35:07,200 --> 00:35:09,520
general that you're really persistent

977
00:35:09,520 --> 00:35:11,839
and lastly we spent a lot of time

978
00:35:11,839 --> 00:35:13,680
mapping out attack surfaces in different

979
00:35:13,680 --> 00:35:15,680
regions and countries this led to a

980
00:35:15,680 --> 00:35:17,359
couple of really successful bugs and

981
00:35:17,359 --> 00:35:21,279
findings that we submitted to programs

982
00:35:22,720 --> 00:35:25,680
now lastly i want to talk about 2018 to

983
00:35:25,680 --> 00:35:28,000
2021. i want to talk a little bit about

984
00:35:28,000 --> 00:35:29,520
reconnaissance

985
00:35:29,520 --> 00:35:33,440
doors zero days and automation

986
00:35:33,440 --> 00:35:34,160
so

987
00:35:34,160 --> 00:35:36,000
in the last few years of bug bounty

988
00:35:36,000 --> 00:35:37,920
hunting recon was something that had

989
00:35:37,920 --> 00:35:39,599
become second nature to me due to how

990
00:35:39,599 --> 00:35:42,160
repetitive the process is i defined what

991
00:35:42,160 --> 00:35:44,000
recon really meant to me and you know

992
00:35:44,000 --> 00:35:45,680
how i think other hackers should think

993
00:35:45,680 --> 00:35:47,520
about it too when they think about it

994
00:35:47,520 --> 00:35:49,599
i'd try not to deviate from my processes

995
00:35:49,599 --> 00:35:51,920
related to it and i found systemic

996
00:35:51,920 --> 00:35:53,359
issues in bug mounting programs and

997
00:35:53,359 --> 00:35:54,960
exploited them for a steady train of

998
00:35:54,960 --> 00:35:57,440
bounties at high severity bugs

999
00:35:57,440 --> 00:35:59,119
identifying weaknesses and attack

1000
00:35:59,119 --> 00:36:01,040
surfaces holistically is what led to

1001
00:36:01,040 --> 00:36:02,720
this success

1002
00:36:02,720 --> 00:36:05,680
there was a also a small shift

1003
00:36:05,680 --> 00:36:08,480
to focus on source code analysis so that

1004
00:36:08,480 --> 00:36:10,320
i could find zero-day vulnerabilities in

1005
00:36:10,320 --> 00:36:12,640
vendor products and report those zero

1006
00:36:12,640 --> 00:36:16,240
days to bug bounty programs

1007
00:36:16,720 --> 00:36:18,480
one thing that i want to do right now is

1008
00:36:18,480 --> 00:36:20,400
define reconnaissance and recon in

1009
00:36:20,400 --> 00:36:22,000
general when i think about

1010
00:36:22,000 --> 00:36:23,920
reconnaissance i think about it in two

1011
00:36:23,920 --> 00:36:26,079
streams i think about it in the breadth

1012
00:36:26,079 --> 00:36:27,440
and in depth

1013
00:36:27,440 --> 00:36:28,960
there are two separate concepts when you

1014
00:36:28,960 --> 00:36:31,200
look at reconnaissance breadth might

1015
00:36:31,200 --> 00:36:32,960
mean that you're enumerating all of the

1016
00:36:32,960 --> 00:36:34,800
subdomains enumerating all of the

1017
00:36:34,800 --> 00:36:36,800
endpoints and you're enumerating all the

1018
00:36:36,800 --> 00:36:38,880
cloud resources finding related domains

1019
00:36:38,880 --> 00:36:41,040
looking at third-party platforms

1020
00:36:41,040 --> 00:36:43,040
depth on the other hand is looking at

1021
00:36:43,040 --> 00:36:44,480
things like reverse engineering

1022
00:36:44,480 --> 00:36:46,880
javascript discovering and testing all

1023
00:36:46,880 --> 00:36:49,680
the request parameters testing for route

1024
00:36:49,680 --> 00:36:52,480
53 and elastic ip takeovers detecting

1025
00:36:52,480 --> 00:36:54,160
all technologies and versions across an

1026
00:36:54,160 --> 00:36:56,560
attack surface and analyzing code within

1027
00:36:56,560 --> 00:36:58,560
the repos written by the organizational

1028
00:36:58,560 --> 00:37:00,800
employees you can see how these two

1029
00:37:00,800 --> 00:37:02,960
separate concepts of reconnaissance kind

1030
00:37:02,960 --> 00:37:05,200
of work hand in hand and i think that

1031
00:37:05,200 --> 00:37:07,200
what's really tricky is not many people

1032
00:37:07,200 --> 00:37:08,880
have had a go at defining what

1033
00:37:08,880 --> 00:37:10,960
reconnaissance actually means i think

1034
00:37:10,960 --> 00:37:12,880
that's why it's pretty important to i

1035
00:37:12,880 --> 00:37:14,800
guess convey what my meaning of

1036
00:37:14,800 --> 00:37:16,320
reconnaissance is to people who are

1037
00:37:16,320 --> 00:37:17,520
watching this

1038
00:37:17,520 --> 00:37:19,200
i really do think of reconnaissance in

1039
00:37:19,200 --> 00:37:21,359
these two different streams breadth and

1040
00:37:21,359 --> 00:37:23,359
depth and if you can think about all the

1041
00:37:23,359 --> 00:37:24,640
different things you can do for these

1042
00:37:24,640 --> 00:37:26,800
two different streams i think you can be

1043
00:37:26,800 --> 00:37:28,800
really successful at reconnaissance you

1044
00:37:28,800 --> 00:37:30,640
have to do a good job at every element

1045
00:37:30,640 --> 00:37:31,839
of reconnaissance to make sure you

1046
00:37:31,839 --> 00:37:33,839
haven't missed anything but it is one of

1047
00:37:33,839 --> 00:37:35,440
the most critical steps when looking for

1048
00:37:35,440 --> 00:37:37,839
bugs

1049
00:37:38,880 --> 00:37:41,520
and when you perform recon it's not that

1050
00:37:41,520 --> 00:37:43,280
difficult you just need to put the time

1051
00:37:43,280 --> 00:37:45,359
in recon is time consuming but it can

1052
00:37:45,359 --> 00:37:47,680
lead to amazing bugs being found

1053
00:37:47,680 --> 00:37:49,680
and once you follow these concepts of

1054
00:37:49,680 --> 00:37:51,839
breadth and depth you can always ask

1055
00:37:51,839 --> 00:37:53,680
yourself can i take this concept further

1056
00:37:53,680 --> 00:37:56,000
can i go deeper um you can follow your

1057
00:37:56,000 --> 00:37:57,839
handshakes you can build up instinct and

1058
00:37:57,839 --> 00:37:59,599
get better indications of when something

1059
00:37:59,599 --> 00:38:01,520
may lead to vulnerabilities

1060
00:38:01,520 --> 00:38:03,359
i spend a lot of time these days reverse

1061
00:38:03,359 --> 00:38:05,680
engineering javascript to find endpoints

1062
00:38:05,680 --> 00:38:08,800
parameters expected values and schemas

1063
00:38:08,800 --> 00:38:11,200
this is often a necessary step in a lot

1064
00:38:11,200 --> 00:38:12,640
of the vulnerabilities that i find these

1065
00:38:12,640 --> 00:38:14,960
days

1066
00:38:15,359 --> 00:38:17,520
one of my favorite bounties to hack on

1067
00:38:17,520 --> 00:38:19,520
is a food ordering platform they

1068
00:38:19,520 --> 00:38:22,720
represent everything as uuids um user

1069
00:38:22,720 --> 00:38:25,680
ids vehicle ids restaurant ids order ids

1070
00:38:25,680 --> 00:38:28,400
everything is a uuid i reported a lot of

1071
00:38:28,400 --> 00:38:30,240
access control issues to this company

1072
00:38:30,240 --> 00:38:32,640
from 2018 to 2021. some of these

1073
00:38:32,640 --> 00:38:33,839
vulnerabilities were as simple as

1074
00:38:33,839 --> 00:38:36,720
putting someone else's user uuid as mine

1075
00:38:36,720 --> 00:38:38,880
but some bugs were a bit more impactful

1076
00:38:38,880 --> 00:38:41,119
than others

1077
00:38:41,119 --> 00:38:43,359
one of my favorite bugs

1078
00:38:43,359 --> 00:38:45,760
all i needed to do was obtain a uuid of

1079
00:38:45,760 --> 00:38:47,200
a restaurant that i wanted to test the

1080
00:38:47,200 --> 00:38:49,359
bug on so essentially i went to this

1081
00:38:49,359 --> 00:38:51,680
website i clicked on the store and as

1082
00:38:51,680 --> 00:38:52,960
soon as i clicked on the store it gave

1083
00:38:52,960 --> 00:38:56,240
me the uuid for the store inside the url

1084
00:38:56,240 --> 00:38:58,720
so once i obtained this uuid for the

1085
00:38:58,720 --> 00:39:00,400
store we could move on to the next step

1086
00:39:00,400 --> 00:39:03,520
of the exploit

1087
00:39:04,480 --> 00:39:05,599
so

1088
00:39:05,599 --> 00:39:07,440
there was this request that i could

1089
00:39:07,440 --> 00:39:10,240
forge where essentially i could replace

1090
00:39:10,240 --> 00:39:13,200
my uuid with this restaurant uuid and i

1091
00:39:13,200 --> 00:39:15,920
could essentially close down this this

1092
00:39:15,920 --> 00:39:19,920
uh this this shop um early and sending

1093
00:39:19,920 --> 00:39:21,520
this request would essentially close

1094
00:39:21,520 --> 00:39:22,960
down this shop

1095
00:39:22,960 --> 00:39:25,040
i didn't think it was gonna work

1096
00:39:25,040 --> 00:39:27,200
but after i sent the request this is

1097
00:39:27,200 --> 00:39:28,800
what it looked like currently

1098
00:39:28,800 --> 00:39:30,079
unavailable

1099
00:39:30,079 --> 00:39:32,560
the funny thing is is that i actually

1100
00:39:32,560 --> 00:39:34,079
didn't really like the kebabs that much

1101
00:39:34,079 --> 00:39:36,880
from this shop anyways but obviously i

1102
00:39:36,880 --> 00:39:39,119
reported this bug as soon as i found it

1103
00:39:39,119 --> 00:39:40,000
and

1104
00:39:40,000 --> 00:39:41,520
it was something that was considered

1105
00:39:41,520 --> 00:39:43,599
pretty important and high severity at

1106
00:39:43,599 --> 00:39:44,640
the time

1107
00:39:44,640 --> 00:39:46,560
i never really expected it to work and i

1108
00:39:46,560 --> 00:39:50,160
was pretty surprised when it did work

1109
00:39:50,240 --> 00:39:52,880
so idols for this company it was a

1110
00:39:52,880 --> 00:39:55,359
systemic problem and you know i i've

1111
00:39:55,359 --> 00:39:56,880
demonstrated with this example that

1112
00:39:56,880 --> 00:39:59,040
idols can have major implications

1113
00:39:59,040 --> 00:40:01,440
sometimes the idol vulnerability class

1114
00:40:01,440 --> 00:40:03,760
is a systemic issue for a company and it

1115
00:40:03,760 --> 00:40:05,520
occurs throughout many applications and

1116
00:40:05,520 --> 00:40:08,000
assets so this was the case for a lot of

1117
00:40:08,000 --> 00:40:10,160
the programs that i was participating in

1118
00:40:10,160 --> 00:40:11,920
so i did really did specialize in

1119
00:40:11,920 --> 00:40:13,839
finding idols throughout this period of

1120
00:40:13,839 --> 00:40:15,839
time and i still consider at the end of

1121
00:40:15,839 --> 00:40:17,680
the day i still consider eye doors as

1122
00:40:17,680 --> 00:40:19,280
low hanging fruit to be completely

1123
00:40:19,280 --> 00:40:21,599
honest

1124
00:40:22,240 --> 00:40:24,640
lastly i want to talk well another thing

1125
00:40:24,640 --> 00:40:26,720
i want to talk about is xerodies i spent

1126
00:40:26,720 --> 00:40:29,520
a lot of time from 2018 to 2021 finding

1127
00:40:29,520 --> 00:40:30,800
vulnerabilities in the following

1128
00:40:30,800 --> 00:40:31,760
software

1129
00:40:31,760 --> 00:40:35,520
oracle ebs websphere jira confluence and

1130
00:40:35,520 --> 00:40:37,760
secure file transfer software i also

1131
00:40:37,760 --> 00:40:39,920
looked at django and python libraries so

1132
00:40:39,920 --> 00:40:42,400
for example django hpad still has a sql

1133
00:40:42,400 --> 00:40:44,400
injection still on patch this is

1134
00:40:44,400 --> 00:40:46,800
technically a zero day and also crowd

1135
00:40:46,800 --> 00:40:48,720
configuration issues like aws

1136
00:40:48,720 --> 00:40:51,440
misconfigurations and exploiting them

1137
00:40:51,440 --> 00:40:53,200
all of this led to significant bugs

1138
00:40:53,200 --> 00:40:55,440
being founded by bounties it's been

1139
00:40:55,440 --> 00:40:57,440
really rewarding but it has required a

1140
00:40:57,440 --> 00:40:58,800
really different skill set which is

1141
00:40:58,800 --> 00:41:01,040
source code analysis

1142
00:41:01,040 --> 00:41:02,800
this has been rewarding not only for bug

1143
00:41:02,800 --> 00:41:04,640
bounties but also my current job at

1144
00:41:04,640 --> 00:41:08,879
asset which requires this sort of stuff

1145
00:41:09,440 --> 00:41:11,280
the barrier of entry when it comes to

1146
00:41:11,280 --> 00:41:13,119
finding zero days isn't that high

1147
00:41:13,119 --> 00:41:15,119
anymore because you can often find

1148
00:41:15,119 --> 00:41:17,280
software and deploy it on azure and aws

1149
00:41:17,280 --> 00:41:19,599
marketplace and deploy these vendor

1150
00:41:19,599 --> 00:41:21,599
vendor applications without forking huge

1151
00:41:21,599 --> 00:41:24,000
license fees alternatively you can also

1152
00:41:24,000 --> 00:41:26,160
find vendor applications on docker hub

1153
00:41:26,160 --> 00:41:28,000
and simply spin up a container with that

1154
00:41:28,000 --> 00:41:29,599
vendor software

1155
00:41:29,599 --> 00:41:31,680
um static source code analysis is still

1156
00:41:31,680 --> 00:41:33,680
an extremely effective way to find

1157
00:41:33,680 --> 00:41:35,920
vulnerabilities in this vendor software

1158
00:41:35,920 --> 00:41:37,440
and obtaining the source code is often

1159
00:41:37,440 --> 00:41:40,079
trivial when it's java

1160
00:41:40,079 --> 00:41:42,000
a lot of vendors what they're banking on

1161
00:41:42,000 --> 00:41:43,119
is the fact that you won't be able to

1162
00:41:43,119 --> 00:41:44,480
discover vulnerabilities because you

1163
00:41:44,480 --> 00:41:46,560
don't even have a copy of the software

1164
00:41:46,560 --> 00:41:48,319
so sometimes the biggest barrier in

1165
00:41:48,319 --> 00:41:49,760
finding vulnerabilities in enterprise

1166
00:41:49,760 --> 00:41:51,839
software is surprisingly actually

1167
00:41:51,839 --> 00:41:54,480
getting access to the software itself

1168
00:41:54,480 --> 00:41:56,960
um on that i think one thing to note is

1169
00:41:56,960 --> 00:41:58,720
that a lot of different kinds of

1170
00:41:58,720 --> 00:42:01,680
software such as net apps java apps

1171
00:42:01,680 --> 00:42:03,359
actually lets you reverse to effectively

1172
00:42:03,359 --> 00:42:04,880
the full source there's plenty of

1173
00:42:04,880 --> 00:42:07,440
decompilers that if you're given a net

1174
00:42:07,440 --> 00:42:09,839
dll actually just speed up the original

1175
00:42:09,839 --> 00:42:11,119
source code

1176
00:42:11,119 --> 00:42:12,800
even at some degree if you can find

1177
00:42:12,800 --> 00:42:15,599
compiled python binaries to pyc files

1178
00:42:15,599 --> 00:42:17,680
those can be decompiled and unpacked to

1179
00:42:17,680 --> 00:42:19,680
give you nearly the original python

1180
00:42:19,680 --> 00:42:21,920
source so even a lot of the time with

1181
00:42:21,920 --> 00:42:23,760
applications that you think are probably

1182
00:42:23,760 --> 00:42:26,079
too big or too complex at the end of the

1183
00:42:26,079 --> 00:42:28,000
day with enough tooling you can actually

1184
00:42:28,000 --> 00:42:29,440
get back to a point where it's just

1185
00:42:29,440 --> 00:42:31,040
normal source code auditing at the end

1186
00:42:31,040 --> 00:42:33,359
of the day

1187
00:42:34,800 --> 00:42:36,480
next i wanted to talk about is

1188
00:42:36,480 --> 00:42:39,920
automation and over the past few years

1189
00:42:39,920 --> 00:42:41,280
i come from a software engineering

1190
00:42:41,280 --> 00:42:43,520
background i did computer science so

1191
00:42:43,520 --> 00:42:46,319
instead of spending my time diving deep

1192
00:42:46,319 --> 00:42:48,160
into like

1193
00:42:48,160 --> 00:42:50,000
building out like understanding bugs

1194
00:42:50,000 --> 00:42:51,839
super hard i was working on trying to

1195
00:42:51,839 --> 00:42:53,440
make things a lot easier for myself

1196
00:42:53,440 --> 00:42:55,760
using the skills i had and some of the

1197
00:42:55,760 --> 00:42:56,960
things that we've managed to automate

1198
00:42:56,960 --> 00:42:57,920
over the last few years that have

1199
00:42:57,920 --> 00:43:00,720
yielded very well over bounties include

1200
00:43:00,720 --> 00:43:03,760
ralph 53 takeovers eip takeovers

1201
00:43:03,760 --> 00:43:05,839
research we automated from bishop fox

1202
00:43:05,839 --> 00:43:08,319
like htc smuggling we've also some

1203
00:43:08,319 --> 00:43:09,839
degree automated javascript change

1204
00:43:09,839 --> 00:43:12,240
detection and these automations have

1205
00:43:12,240 --> 00:43:14,480
effectively short-cutted the recon

1206
00:43:14,480 --> 00:43:16,880
process for us because all the time if

1207
00:43:16,880 --> 00:43:18,640
you chain enough things together you get

1208
00:43:18,640 --> 00:43:20,720
to a point where you get to cut out a

1209
00:43:20,720 --> 00:43:22,560
lot of the noise especially with things

1210
00:43:22,560 --> 00:43:24,480
like eip takeovers and about 53

1211
00:43:24,480 --> 00:43:26,480
takeovers it's very expensive to

1212
00:43:26,480 --> 00:43:28,079
manually validate these but it's very

1213
00:43:28,079 --> 00:43:30,240
easy to do it in an automated fashion

1214
00:43:30,240 --> 00:43:31,839
and once you have that you now just have

1215
00:43:31,839 --> 00:43:33,520
a pipeline where you just maintain the

1216
00:43:33,520 --> 00:43:35,520
pipeline occasionally and you just have

1217
00:43:35,520 --> 00:43:37,280
bugs print out into your slack channel

1218
00:43:37,280 --> 00:43:38,319
every day

1219
00:43:38,319 --> 00:43:40,880
um

1220
00:43:40,880 --> 00:43:44,000
yeah so going over 2018 to 2021 we can

1221
00:43:44,000 --> 00:43:45,599
have a short retrospective and have a

1222
00:43:45,599 --> 00:43:46,560
look at

1223
00:43:46,560 --> 00:43:48,720
what things are probably useful um as

1224
00:43:48,720 --> 00:43:51,200
chels spoke about taking both a breadth

1225
00:43:51,200 --> 00:43:52,800
and depth approach

1226
00:43:52,800 --> 00:43:54,720
allows you to cover a lot more than just

1227
00:43:54,720 --> 00:43:56,640
going for one or the other um it's

1228
00:43:56,640 --> 00:43:58,240
important to make sure you consider both

1229
00:43:58,240 --> 00:44:00,000
because just having a large list of sub

1230
00:44:00,000 --> 00:44:02,079
domains isn't too helpful if you don't

1231
00:44:02,079 --> 00:44:03,680
actually manage to investigate anything

1232
00:44:03,680 --> 00:44:04,560
on them

1233
00:44:04,560 --> 00:44:06,960
um shops managed to exploit a wide range

1234
00:44:06,960 --> 00:44:09,440
of idols in a lot of cases even when

1235
00:44:09,440 --> 00:44:11,680
uuids are used and you think this makes

1236
00:44:11,680 --> 00:44:13,119
it a lot more difficult than just

1237
00:44:13,119 --> 00:44:15,599
incrementing integers

1238
00:44:15,599 --> 00:44:18,000
furthermore analyzing vendor software

1239
00:44:18,000 --> 00:44:20,079
and middleware across

1240
00:44:20,079 --> 00:44:22,319
various pieces of enterprise software to

1241
00:44:22,319 --> 00:44:24,560
find zero days is actually surprisingly

1242
00:44:24,560 --> 00:44:27,040
effective and ultimately this helps both

1243
00:44:27,040 --> 00:44:28,640
the people running the bug bounty as

1244
00:44:28,640 --> 00:44:30,720
well as the vendors um we've found a lot

1245
00:44:30,720 --> 00:44:32,720
of success over this the past few years

1246
00:44:32,720 --> 00:44:34,560
and finally reporting cloud security

1247
00:44:34,560 --> 00:44:36,720
misconfiguration issues especially in

1248
00:44:36,720 --> 00:44:38,960
aws environments has been very lucrative

1249
00:44:38,960 --> 00:44:40,480
especially as more and more companies

1250
00:44:40,480 --> 00:44:42,880
moved to cloud-based infrastructure away

1251
00:44:42,880 --> 00:44:44,960
from their on-prem or traditional data

1252
00:44:44,960 --> 00:44:47,599
center models

1253
00:44:48,319 --> 00:44:51,839
and lastly um you know don't be let down

1254
00:44:51,839 --> 00:44:54,160
when you have um periods of time that

1255
00:44:54,160 --> 00:44:56,640
you can't find bugs um this was a tweet

1256
00:44:56,640 --> 00:44:59,040
that i tweeted last year in october

1257
00:44:59,040 --> 00:45:01,119
where you know for a period of months i

1258
00:45:01,119 --> 00:45:03,119
just found nothing and it felt like i

1259
00:45:03,119 --> 00:45:05,040
couldn't hack at all i felt like the

1260
00:45:05,040 --> 00:45:07,440
worst hacker in the world so keep on

1261
00:45:07,440 --> 00:45:08,720
doing what you're doing and fight the

1262
00:45:08,720 --> 00:45:11,040
imposter syndrome um

1263
00:45:11,040 --> 00:45:12,560
if you're interested in learning a bit

1264
00:45:12,560 --> 00:45:14,560
more about our journey and bug bounties

1265
00:45:14,560 --> 00:45:16,480
you can read the blog post here on

1266
00:45:16,480 --> 00:45:18,480
hacking on bug bounties for four years

1267
00:45:18,480 --> 00:45:20,400
and high frequency security bug hunting

1268
00:45:20,400 --> 00:45:23,200
120 days to 120 bucks these two

1269
00:45:23,200 --> 00:45:25,440
resources are a good retrospective about

1270
00:45:25,440 --> 00:45:27,359
all of the bugs we've found over time

1271
00:45:27,359 --> 00:45:29,280
and gone to a lot of detail about what

1272
00:45:29,280 --> 00:45:31,119
the bugs were and how much they were pay

1273
00:45:31,119 --> 00:45:34,119
down

