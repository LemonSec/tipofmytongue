1
00:00:03,050 --> 00:00:09,390
so I'm going to talk a bit more about

2
00:00:05,759 --> 00:00:11,880
how we are utilizing a Miss into our

3
00:00:09,390 --> 00:00:14,040
incident response team and into our

4
00:00:11,880 --> 00:00:18,359
plans on working so a bit of background

5
00:00:14,040 --> 00:00:20,400
I work at J in data and Denmark I'm a

6
00:00:18,359 --> 00:00:22,589
cybersecurity crossfader incident

7
00:00:20,400 --> 00:00:25,589
responder and working with threat

8
00:00:22,589 --> 00:00:27,390
intelligence and also the founder of E

9
00:00:25,589 --> 00:00:30,179
crime labs in Denmark I've been working

10
00:00:27,390 --> 00:00:33,810
with MS since around 15 where I first

11
00:00:30,179 --> 00:00:36,060
started and then I've also been a part

12
00:00:33,810 --> 00:00:41,100
of implemented it into my current

13
00:00:36,060 --> 00:00:43,620
workplace so some places that we also

14
00:00:41,100 --> 00:00:45,210
use miss is the statistical data that

15
00:00:43,620 --> 00:00:47,339
has come in light of my terror attacks

16
00:00:45,210 --> 00:00:50,790
these things are really good for us

17
00:00:47,340 --> 00:00:52,950
because we can use it to identify in the

18
00:00:50,790 --> 00:00:55,410
incidents that we are analyzing but

19
00:00:52,950 --> 00:00:57,540
we're seeing on what should be

20
00:00:55,410 --> 00:00:59,459
prioritized in protecting trying to

21
00:00:57,540 --> 00:01:01,200
avoid this happen again because a lot of

22
00:00:59,460 --> 00:01:02,670
times is like there is a lot of

23
00:01:01,200 --> 00:01:04,949
different things occurring during an

24
00:01:02,670 --> 00:01:06,479
incident but what was some of the things

25
00:01:04,949 --> 00:01:08,310
that we're seeing again and again like

26
00:01:06,479 --> 00:01:10,619
in this case it's spear phishing would

27
00:01:08,310 --> 00:01:15,689
attachment its with links all these

28
00:01:10,619 --> 00:01:17,609
things the next thing was that we

29
00:01:15,689 --> 00:01:20,548
actually also started to use this with

30
00:01:17,609 --> 00:01:22,380
vulnerability management because if any

31
00:01:20,549 --> 00:01:25,829
of you have issues regarding

32
00:01:22,380 --> 00:01:28,109
prioritizing patches some use like cbss

33
00:01:25,829 --> 00:01:31,139
scores and other things like that but

34
00:01:28,109 --> 00:01:33,839
what we tried to do was also start using

35
00:01:31,139 --> 00:01:35,818
cv numbers that were mentioned or

36
00:01:33,840 --> 00:01:37,829
located in this so if we had seen a

37
00:01:35,819 --> 00:01:40,170
vulnerability being exploited or being

38
00:01:37,829 --> 00:01:46,439
mentioned and miss we actually used that

39
00:01:40,170 --> 00:01:48,749
in the prioritization phase to to decide

40
00:01:46,439 --> 00:01:52,048
again how we can counteract some of

41
00:01:48,749 --> 00:01:55,679
these DS attack types so these were some

42
00:01:52,049 --> 00:01:58,799
of the preparation parts where we are

43
00:01:55,679 --> 00:02:00,899
using this today so the next thing is

44
00:01:58,799 --> 00:02:04,079
how you can use mates to be an incident

45
00:02:00,899 --> 00:02:07,079
response superhero and actually use it

46
00:02:04,079 --> 00:02:09,989
as a soar platform our challenge today

47
00:02:07,079 --> 00:02:12,659
is that we have a bunch of services we

48
00:02:09,989 --> 00:02:14,640
have a bunch of governance around it

49
00:02:12,659 --> 00:02:16,709
working in the financial industry

50
00:02:14,640 --> 00:02:20,040
and we have a lot of customers so

51
00:02:16,710 --> 00:02:22,650
technologies across everything different

52
00:02:20,040 --> 00:02:25,200
integrations platforms systems all

53
00:02:22,650 --> 00:02:28,080
around so this was one of the issues

54
00:02:25,200 --> 00:02:30,690
that we were facing is how can we do the

55
00:02:28,080 --> 00:02:35,910
best incident response across all these

56
00:02:30,690 --> 00:02:37,620
different areas at once so the first

57
00:02:35,910 --> 00:02:39,540
thing that we needed to do was to ensure

58
00:02:37,620 --> 00:02:42,090
that wet coverage so we needed to add

59
00:02:39,540 --> 00:02:44,850
other coverage for for blocking or for

60
00:02:42,090 --> 00:02:47,130
detecting meaning block management we

61
00:02:44,850 --> 00:02:50,130
had need to have insight in network

62
00:02:47,130 --> 00:02:53,549
endpoints and locks and at least two of

63
00:02:50,130 --> 00:02:55,680
these is needed to be able to always

64
00:02:53,550 --> 00:02:57,420
have the biggest chance to see an

65
00:02:55,680 --> 00:03:03,810
adversary that are coming into our

66
00:02:57,420 --> 00:03:06,000
systems so with this in place we now

67
00:03:03,810 --> 00:03:07,470
also have the course of action part so

68
00:03:06,000 --> 00:03:10,170
with course of actions you have the

69
00:03:07,470 --> 00:03:12,270
passive part where you don't want to

70
00:03:10,170 --> 00:03:14,429
alert the attacker on that you're

71
00:03:12,270 --> 00:03:16,560
actually monitoring them or seeing them

72
00:03:14,430 --> 00:03:19,230
or searching for them and then you have

73
00:03:16,560 --> 00:03:21,420
the active part where you want to deny

74
00:03:19,230 --> 00:03:26,179
their access like firewalls disrupt

75
00:03:21,420 --> 00:03:29,100
could be antivirus degrade could be

76
00:03:26,180 --> 00:03:31,350
various other things to to get out of it

77
00:03:29,100 --> 00:03:34,109
it could be like in implementing quality

78
00:03:31,350 --> 00:03:35,609
of service so if you had an adversary IP

79
00:03:34,110 --> 00:03:38,820
address you could lower their bandwidth

80
00:03:35,610 --> 00:03:41,600
one kilometer or something to give them

81
00:03:38,820 --> 00:03:44,790
a hard time working in the environment

82
00:03:41,600 --> 00:03:47,430
so the way that we mapped is into Mis

83
00:03:44,790 --> 00:03:49,410
was that we wanted to use the tagging

84
00:03:47,430 --> 00:03:52,950
and thanks again for the local tagging

85
00:03:49,410 --> 00:03:55,350
part really useful here so we wanted to

86
00:03:52,950 --> 00:03:57,720
have like different tacks that we added

87
00:03:55,350 --> 00:03:59,730
to the system to then map against if it

88
00:03:57,720 --> 00:04:03,090
was a passive or an active defense

89
00:03:59,730 --> 00:04:05,280
mechanism that we wanted to work with so

90
00:04:03,090 --> 00:04:08,310
we have like alert tags that are used

91
00:04:05,280 --> 00:04:10,310
only for passive triggering meaning that

92
00:04:08,310 --> 00:04:12,989
we want to search or see in real time

93
00:04:10,310 --> 00:04:15,750
with these indicators so these tags can

94
00:04:12,989 --> 00:04:20,608
be set both on the entire event or on

95
00:04:15,750 --> 00:04:22,800
individual attributes logging tag says

96
00:04:20,608 --> 00:04:25,700
itself that you want to block something

97
00:04:22,800 --> 00:04:28,380
now you want to go into that part of it

98
00:04:25,700 --> 00:04:30,870
we also have the hunting part for

99
00:04:28,380 --> 00:04:33,090
our cm solution so when something has

100
00:04:30,870 --> 00:04:35,310
this tack on to it the hunting tack it

101
00:04:33,090 --> 00:04:38,310
will then search backwards in time to

102
00:04:35,310 --> 00:04:40,560
see if there has been any hits in the

103
00:04:38,310 --> 00:04:43,140
past on it yes that's also really

104
00:04:40,560 --> 00:04:45,660
important part of it and then we have

105
00:04:43,140 --> 00:04:47,789
the incident tack for when we need to do

106
00:04:45,660 --> 00:04:48,180
both the passive and active defense at

107
00:04:47,790 --> 00:04:52,170
once

108
00:04:48,180 --> 00:04:53,700
and of course false positive because we

109
00:04:52,170 --> 00:04:55,920
don't want to when we have incidents

110
00:04:53,700 --> 00:04:58,590
that we just grab into the mist that we

111
00:04:55,920 --> 00:05:00,270
are then removing out of the mist we

112
00:04:58,590 --> 00:05:02,159
just want to mark them as we've seen

113
00:05:00,270 --> 00:05:08,460
this we know that they're there but we

114
00:05:02,160 --> 00:05:10,470
then pull them out so looking at it into

115
00:05:08,460 --> 00:05:12,450
the capability is doing an incident so

116
00:05:10,470 --> 00:05:15,090
you have to passive discovery and detect

117
00:05:12,450 --> 00:05:18,780
with the three alerts on rental wear

118
00:05:15,090 --> 00:05:21,630
cases you want to act while you learn

119
00:05:18,780 --> 00:05:23,099
more about the incident so so in that

120
00:05:21,630 --> 00:05:25,350
case as soon as you add the incident

121
00:05:23,100 --> 00:05:27,780
tack this data will start to work its

122
00:05:25,350 --> 00:05:30,510
way out into our infrastructure and then

123
00:05:27,780 --> 00:05:33,000
we have the block tag is more for you

124
00:05:30,510 --> 00:05:36,360
can like free used it to create a

125
00:05:33,000 --> 00:05:39,060
playbook so you can do all the passive

126
00:05:36,360 --> 00:05:42,150
analysis first say okay now you have a

127
00:05:39,060 --> 00:05:45,060
good idea on how far a word adversary is

128
00:05:42,150 --> 00:05:46,590
in your network so we have all the IP

129
00:05:45,060 --> 00:05:50,880
addresses we have all the domains we

130
00:05:46,590 --> 00:05:52,950
have two URLs that we know about now we

131
00:05:50,880 --> 00:06:00,270
want to blog it and then we actually

132
00:05:52,950 --> 00:06:02,909
push it out so one of the things is to

133
00:06:00,270 --> 00:06:05,640
for elastic is that you can use memcache

134
00:06:02,910 --> 00:06:08,970
so we have a Python script that pulls

135
00:06:05,640 --> 00:06:11,940
data from Miss stores it into Memphis

136
00:06:08,970 --> 00:06:14,010
because it's memory based is fast and

137
00:06:11,940 --> 00:06:17,280
you will it the elastic search or lock

138
00:06:14,010 --> 00:06:20,520
stash actually look at it in real time

139
00:06:17,280 --> 00:06:24,359
when data comes in at the fly it on the

140
00:06:20,520 --> 00:06:25,710
fly and then we also use the more we're

141
00:06:24,360 --> 00:06:27,750
going to say the hunting tag that's

142
00:06:25,710 --> 00:06:31,950
where we didn't use the last alert to go

143
00:06:27,750 --> 00:06:35,070
back and do the search carbon black you

144
00:06:31,950 --> 00:06:36,960
can also now push in or provide the miss

145
00:06:35,070 --> 00:06:39,719
directly into carbon black so you could

146
00:06:36,960 --> 00:06:41,609
use it again to detect binaries or

147
00:06:39,720 --> 00:06:44,289
domains or IP

148
00:06:41,610 --> 00:06:46,330
from it but again this is from the the

149
00:06:44,289 --> 00:06:49,090
passive side again a lot of times that

150
00:06:46,330 --> 00:06:52,050
we've seen is that it's a matter of also

151
00:06:49,090 --> 00:06:55,419
not making that this area where that

152
00:06:52,050 --> 00:07:02,319
they actually been spotted before you

153
00:06:55,419 --> 00:07:03,940
you start to to counteract them and this

154
00:07:02,319 --> 00:07:07,360
part was actually what what originally

155
00:07:03,940 --> 00:07:09,250
started it was that we had I don't know

156
00:07:07,360 --> 00:07:10,900
how many of you have been on incidents

157
00:07:09,250 --> 00:07:13,060
where you're really good and analyzing

158
00:07:10,900 --> 00:07:15,270
and finding whatever happens but when

159
00:07:13,060 --> 00:07:17,349
you come to the point where you want to

160
00:07:15,270 --> 00:07:21,818
start the containment and eradication

161
00:07:17,349 --> 00:07:23,830
and trying to implement ten IP addresses

162
00:07:21,819 --> 00:07:27,009
in fifteen firewalls across multiple

163
00:07:23,830 --> 00:07:30,280
customers combined with your all's md5

164
00:07:27,009 --> 00:07:32,379
hashes you name it trying to get all

165
00:07:30,280 --> 00:07:34,628
that to work and be done within 30

166
00:07:32,379 --> 00:07:36,849
minutes with people and change

167
00:07:34,629 --> 00:07:39,789
management system that can sometimes be

168
00:07:36,849 --> 00:07:42,400
quite hard and we also saw this and

169
00:07:39,789 --> 00:07:46,360
sometimes it failed because you have

170
00:07:42,400 --> 00:07:48,698
people involved so what we did to to to

171
00:07:46,360 --> 00:07:53,139
counteract this was that we became our

172
00:07:48,699 --> 00:07:55,360
own feet provider so similar to that you

173
00:07:53,139 --> 00:07:58,509
have firewall providers that pull down

174
00:07:55,360 --> 00:08:01,449
your all feeds or IP feeds from various

175
00:07:58,509 --> 00:08:03,580
sources we just as a security department

176
00:08:01,449 --> 00:08:07,659
became a fee provider to our own

177
00:08:03,580 --> 00:08:09,990
organization and that's a way to to work

178
00:08:07,659 --> 00:08:13,569
in the system meaning that that's not

179
00:08:09,990 --> 00:08:16,449
work under change change doesn't apply

180
00:08:13,569 --> 00:08:18,580
to these updates and feats of course we

181
00:08:16,449 --> 00:08:22,479
have things in place to ensure that if

182
00:08:18,580 --> 00:08:24,698
something like a false-positive comes in

183
00:08:22,479 --> 00:08:26,680
we can swiftly get it out because it's

184
00:08:24,699 --> 00:08:29,440
like a maximum of every 15 minutes

185
00:08:26,680 --> 00:08:31,690
things are getting pulled and this means

186
00:08:29,440 --> 00:08:34,120
now that when we're pushing these data

187
00:08:31,690 --> 00:08:38,828
it get pushed into the anti-malware

188
00:08:34,120 --> 00:08:43,060
system to the proxies to DNS servers to

189
00:08:38,828 --> 00:08:46,779
firewalls to mail gateways all at once

190
00:08:43,059 --> 00:08:49,829
and across multiple customers call

191
00:08:46,779 --> 00:08:49,829
across multiple platforms

192
00:08:51,760 --> 00:08:57,579
so the full stack looks like this also

193
00:08:55,660 --> 00:09:00,370
we saw that you're getting a lot of

194
00:08:57,579 --> 00:09:03,099
valuable information from external

195
00:09:00,370 --> 00:09:04,870
parties and we wanted to gather these in

196
00:09:03,100 --> 00:09:06,779
a centralized location and that's where

197
00:09:04,870 --> 00:09:09,850
we're actually using also to miss

198
00:09:06,779 --> 00:09:12,300
because it's a good way to store it and

199
00:09:09,850 --> 00:09:16,029
get it out and working in organization

200
00:09:12,300 --> 00:09:18,459
so we have a small API in front of the

201
00:09:16,029 --> 00:09:20,260
Miss that are then delivering to all

202
00:09:18,459 --> 00:09:21,849
these different system because some some

203
00:09:20,260 --> 00:09:24,459
of the systems out there like Calvin

204
00:09:21,850 --> 00:09:27,790
black needs a particular way to get data

205
00:09:24,459 --> 00:09:30,430
represented or presented to them and

206
00:09:27,790 --> 00:09:33,370
then it actually feeds to the system and

207
00:09:30,430 --> 00:09:35,649
when we see some of these data it then

208
00:09:33,370 --> 00:09:37,620
comes back into the sium if an alert is

209
00:09:35,649 --> 00:09:40,899
then see or an if an IP address is see

210
00:09:37,620 --> 00:09:42,490
we get an alert or up into the hive and

211
00:09:40,899 --> 00:09:44,350
then we can work again from there so

212
00:09:42,490 --> 00:09:53,440
this is a way to have like to recycle

213
00:09:44,350 --> 00:09:56,470
all the time going through incident

214
00:09:53,440 --> 00:09:58,329
responders go back so a good idea is

215
00:09:56,470 --> 00:10:01,180
there also to actually have a local

216
00:09:58,329 --> 00:10:03,519
missed instance so each incident

217
00:10:01,180 --> 00:10:05,769
responder has a local instance of Miss

218
00:10:03,519 --> 00:10:09,279
running on their laptop that they

219
00:10:05,769 --> 00:10:12,310
synchronize up with there's centralized

220
00:10:09,279 --> 00:10:14,769
system and this is to ensure that you

221
00:10:12,310 --> 00:10:16,359
always are able to bring this this

222
00:10:14,769 --> 00:10:18,490
actually allows you also if you're in

223
00:10:16,360 --> 00:10:20,560
some air gaps location where you don't

224
00:10:18,490 --> 00:10:23,319
have internet access you still have the

225
00:10:20,560 --> 00:10:25,989
data so you can still use this in your

226
00:10:23,319 --> 00:10:29,459
actual incident response plan or when

227
00:10:25,990 --> 00:10:31,389
you're out doing forensics and

228
00:10:29,459 --> 00:10:33,310
afterwards when you're done with the

229
00:10:31,389 --> 00:10:35,529
incident and you get back then it gets

230
00:10:33,310 --> 00:10:43,388
synced up and can be used by by everyone

231
00:10:35,529 --> 00:10:46,089
so one of the troubles that we also had

232
00:10:43,389 --> 00:10:49,029
during this was how do you test it it's

233
00:10:46,089 --> 00:10:50,889
not like just taking some newspaper side

234
00:10:49,029 --> 00:10:53,709
and start bogging to see if the entire

235
00:10:50,889 --> 00:10:56,350
chain works so I created a small website

236
00:10:53,709 --> 00:10:58,839
called evil coke decay where I have a

237
00:10:56,350 --> 00:11:01,240
lot of indicators around this website

238
00:10:58,839 --> 00:11:03,790
like binaries that are not malicious in

239
00:11:01,240 --> 00:11:05,380
any way but can be used to test this

240
00:11:03,790 --> 00:11:08,949
entire flow

241
00:11:05,380 --> 00:11:12,220
if you also want to work with it so it's

242
00:11:08,950 --> 00:11:14,910
a yeah aside if you want to dig deeper

243
00:11:12,220 --> 00:11:14,910
into it

244
00:11:15,000 --> 00:11:26,320
and last but not least this was a what I

245
00:11:20,950 --> 00:11:30,330
had to some of the code is is located on

246
00:11:26,320 --> 00:11:34,260
on my gate and if you have any feedback

247
00:11:30,330 --> 00:11:34,260
yeah it'll be good

