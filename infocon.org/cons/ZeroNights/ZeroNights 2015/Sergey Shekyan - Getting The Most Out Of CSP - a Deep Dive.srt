1
00:00:00,000 --> 00:00:08,570
so I'm gonna be speaking in English
because I cannot put towards and

2
00:00:08,570 --> 00:00:13,780
technical russian anymore since I moved
to us' so yeah I will be talking about

3
00:00:13,780 --> 00:00:20,359
CSP policy as PCs P stands for Canadian
staging professionals and like if you

4
00:00:20,359 --> 00:00:27,599
want to make some money and stop pushing
buttons you can it's a joke is just the

5
00:00:27,599 --> 00:00:32,719
thing is that if you search for CSP
Google and switch the images first thing

6
00:00:32,719 --> 00:00:37,820
you see these days ago about Canadian
staging professionals who some kind of

7
00:00:37,820 --> 00:00:41,079
shady profession where you that when
they went where they teach you how to

8
00:00:41,079 --> 00:00:49,340
stage a house when you sell it so buyers
so you attract more buyers so we are not

9
00:00:49,340 --> 00:00:52,010
going to talk about that seriously we're
going to talk about content security

10
00:00:52,010 --> 00:01:02,370
policy so I work at a company called
shape security and we we we work on our

11
00:01:02,370 --> 00:01:10,158
network appliance which modifies content
responses that are going to the browser

12
00:01:10,159 --> 00:01:17,240
from a Web server so since we modify
content we need to take care of CSP web

13
00:01:17,240 --> 00:01:24,039
servers using CSP but before going there
and play what's his piece so she has

14
00:01:24,040 --> 00:01:29,430
been very cool new technology that

15
00:01:29,430 --> 00:01:33,000
mainly fights cross-site scripting

16
00:01:33,000 --> 00:01:37,950
help with fighting cross-site scripting
you are addressing a tax it helps to

17
00:01:37,950 --> 00:01:43,830
avoid weeks content vulnerabilities and
main problem

18
00:01:43,830 --> 00:01:50,440
exploited by cross-site scripting is
that browsers cannot distinguish between

19
00:01:50,440 --> 00:01:56,289
screens that intended to be part of your
web application and streets that

20
00:01:56,290 --> 00:02:01,420
maliciously injected by third-party so
what he's doing CSP they actually

21
00:02:01,420 --> 00:02:07,470
allowing through these able certain
features in the browser for example by

22
00:02:07,470 --> 00:02:13,510
default when your web page says load the
script from jcrew.com like you don't

23
00:02:13,510 --> 00:02:19,590
have control over it right you just have
a HTML which their scripts or sequels

24
00:02:19,590 --> 00:02:25,650
ATP whatever jcrew.com so you cannot
that capital with your clothing that

25
00:02:25,650 --> 00:02:30,440
third-party script is there and there is
no way to disable it for CSP provides a

26
00:02:30,440 --> 00:02:37,670
mechanism to disable certain certain
features just really brief history so it

27
00:02:37,670 --> 00:02:47,839
was first introduced in 2009 and six
years but popular and you see on the

28
00:02:47,840 --> 00:02:53,299
slides are widely popular but yeah it
was introduced into south 2009 level on

29
00:02:53,299 --> 00:02:54,610
spec was

30
00:02:54,610 --> 00:03:01,110
all 10 2012 now CSP to level 2 E's
current standards and there's active

31
00:03:01,110 --> 00:03:14,190
work being done on CSP level 3 so most
modern browsers this is for CSP level 10

32
00:03:14,190 --> 00:03:20,630
basically every browser support system
level on except Opera Mini and CSP level

33
00:03:20,630 --> 00:03:28,459
3 is supported by chrome and firefox
only for now catching up and adoption

34
00:03:28,459 --> 00:03:35,290
among website so we scanned Alexa
200,000 websites landing pages only and

35
00:03:35,290 --> 00:03:45,350
only 0.2% are using CSP which is kinda
strange and many many other content

36
00:03:45,350 --> 00:03:50,170
security policies are nonsensical or
even broken and missing we decided to

37
00:03:50,170 --> 00:03:53,420
understand like why adoption is so slow

38
00:03:53,420 --> 00:04:01,859
like what can we do to make it faster
and like how can we help people so the

39
00:04:01,860 --> 00:04:11,030
actual inflation what's the ESPYs so it
is a screen that's that can be delivered

40
00:04:11,030 --> 00:04:17,370
either through HTTP header or as a meta
tag on your page and basically this kind

41
00:04:17,370 --> 00:04:23,560
of security policy header and it
consists of directives and sources with

42
00:04:23,560 --> 00:04:29,740
direct so for example to meet where your
web page can load scripts you just say

43
00:04:29,740 --> 00:04:37,080
it's good source and you can have one or
more expressions that can be like Steam

44
00:04:37,080 --> 00:04:41,400
source lost source or like you work
force and basically for example this

45
00:04:41,400 --> 00:04:48,479
page says that this policy says that I
want to load screens only from HDS

46
00:04:48,479 --> 00:05:01,710
schemes and or only from example.com or
only for myself what happens if you have

47
00:05:01,710 --> 00:05:05,969
multiple expressions so basically he's
asked Becky saying that you have too

48
00:05:05,970 --> 00:05:11,960
much at least one source expression 22
too much that you want to know and like

49
00:05:11,960 --> 00:05:18,090
for example if you have a policy that
served from a side that calm and your

50
00:05:18,090 --> 00:05:19,299
web page

51
00:05:19,300 --> 00:05:24,979
script that's being loaded from side
that come in because it exactly matches

52
00:05:24,979 --> 00:05:30,419
self so the source of this creep that's
where testing it's exactly the same as

53
00:05:30,419 --> 00:05:35,508
the origin from where are the policies
to leave his side that described below

54
00:05:35,509 --> 00:05:40,770
API that side that wouldn't load because
it doesn't match anything it doesn't

55
00:05:40,770 --> 00:05:46,310
match so it doesn't matter HTTPS and it
doesn't match starts at example.com or

56
00:05:46,310 --> 00:05:54,520
because it matches the scheme its
matches one of the conditions HTTPS is

57
00:05:54,520 --> 00:05:55,930
OK

58
00:05:55,930 --> 00:06:01,719
should be able to come also wouldn't
work because politics he says that

59
00:06:01,719 --> 00:06:07,050
domain name should end with dot example
that comment we don't have the condition

60
00:06:07,050 --> 00:06:12,960
my condition is not satisfied and I gave
you have come with more because even if

61
00:06:12,960 --> 00:06:21,448
it's even its own insecurities maisha
vipi but API that example.com matches

62
00:06:21,449 --> 00:06:35,230
for example that no matching

63
00:06:35,230 --> 00:06:42,040
policy that says HDDs what would happen
with this three streets so I just leave

64
00:06:42,040 --> 00:06:49,960
like First World War because they match
HTTPS scheme and by good website for

65
00:06:49,960 --> 00:06:57,250
example women who are trying to explain
the basics of matching of sorts of

66
00:06:57,250 --> 00:07:07,040
special matching placed sources only
allows trips from a.com domain that

67
00:07:07,040 --> 00:07:14,830
matches a data so what would happen here
I'm sorry first one is actually

68
00:07:14,830 --> 00:07:25,909
incorrect yeah a.com port 8080 wouldn't
work because because

69
00:07:25,910 --> 00:07:32,750
scheme is not specified I was lied about
it but basically

70
00:07:32,750 --> 00:07:41,770
second directive assumes that port is
default port for either HTTP or HTTPS so

71
00:07:41,770 --> 00:07:45,140
it will not only port 8443

72
00:07:45,140 --> 00:07:48,169
according we would

73
00:07:48,169 --> 00:07:55,219
corresponding schemes this one is
important so if you have a possible part

74
00:07:55,219 --> 00:08:01,789
in your source expression and he doesn't
end with 40 / it means there has to be

75
00:08:01,789 --> 00:08:07,919
exact match so it literally means that
there must be an exact match so

76
00:08:07,919 --> 00:08:11,659
basically a dot com slash be able to
work and anything else wouldn't work

77
00:08:11,659 --> 00:08:17,319
because there is no exact match and if
your path and with / that means anything

78
00:08:17,319 --> 00:08:25,939
that contains that path and domain name
with work so basically yeah that'd be

79
00:08:25,939 --> 00:08:31,310
because there is no exact match but
anything that contains a that comes

80
00:08:31,310 --> 00:08:36,010
largely / would match basically yeah
that's the rules and it's not really

81
00:08:36,010 --> 00:08:41,718
clear from the spektr types of resources
that you can restrict with content

82
00:08:41,719 --> 00:08:47,980
security policy it's like street style
images finance forum action they wear

83
00:08:47,980 --> 00:08:53,570
your form submission can go and child
sources for the child but basically

84
00:08:53,570 --> 00:08:59,699
frames frames sources obsolete directive
and is gonna go

85
00:08:59,699 --> 00:09:05,019
gonna disappearing CSP level 3 and these
three plays by child actually objects or

86
00:09:05,019 --> 00:09:06,669
objects Connect is where you are

87
00:09:06,669 --> 00:09:11,649
XMLHttpRequest or like website gets can
connect to the media and base

88
00:09:11,649 --> 00:09:19,139
explanatory these are directives that
are accepting source least like

89
00:09:19,139 --> 00:09:23,249
arguments and there are three other
types of directives that the Fremont

90
00:09:23,249 --> 00:09:28,829
there's basically replacement for x-ray
mod trans type is you can least what

91
00:09:28,829 --> 00:09:39,799
what's mimetypes application can contain
and report to our eyes will come back to

92
00:09:39,799 --> 00:09:43,429
report their eyes basically where you're
violating the cease-fire violation

93
00:09:43,429 --> 00:09:49,929
reports are gonna be sent there for
keywords in CSP its

94
00:09:49,929 --> 00:09:56,629
which is basically sale he's the alias
for the urging from where your content

95
00:09:56,629 --> 00:10:01,269
security policies coming there's warden
on their own safety line and I some

96
00:10:01,269 --> 00:10:08,149
safety valve and last through our prev
like dangerous and should be used with

97
00:10:08,149 --> 00:10:13,939
great caution and his example like for
example if you have Street source now

98
00:10:13,939 --> 00:10:19,089
and some style source now is basically
means that you do not allow any streets

99
00:10:19,089 --> 00:10:23,149
to be any third party and external
scripts or styles to be loaded by your

100
00:10:23,149 --> 00:10:40,220
web page so basically none of this would
be a valid by the browser it will not

101
00:10:40,220 --> 00:10:45,139
load any sleep from third-party it
wouldn't let anything lined streets as

102
00:10:45,139 --> 00:10:45,889
like

103
00:10:45,889 --> 00:10:56,449
event handlers and it also doesn't let
any stream to JavaScript interpretations

104
00:10:56,449 --> 00:11:03,559
evaluation is not allow those allowed so
it's kind of like save to do I can on

105
00:11:03,559 --> 00:11:07,358
keyword is safe to use if that's what
you want

106
00:11:07,359 --> 00:11:12,499
unsafe in line basically it's widely
satellite makes an exception and allows

107
00:11:12,499 --> 00:11:19,299
an alliance to appear in your web page
and basically that means that you have

108
00:11:19,299 --> 00:11:26,179
troops stars 24 star on saving life
means that you let groups to be loaded

109
00:11:26,179 --> 00:11:32,419
from anywhere and you'll see which is
basically how proteins to appear on your

110
00:11:32,419 --> 00:11:33,739
own web page

111
00:11:33,739 --> 00:11:43,199
palos appear on the rampage it basically
means that it's still loads scripts from

112
00:11:43,199 --> 00:11:50,059
any third party allows in line streets
like event handlers but it doesn't allow

113
00:11:50,059 --> 00:11:57,040
evolve and to allow even you need to
actually use on safety well go faster

114
00:11:57,040 --> 00:12:02,368
over this basically try to avoid using
these keywords and safety line and

115
00:12:02,369 --> 00:12:08,879
unsafe about which means you don't it's
better not to have any alliance creeps

116
00:12:08,879 --> 00:12:16,209
on your webpage to allow the first if
you still have to have a script on your

117
00:12:16,209 --> 00:12:20,799
webpage alliance or inline style on your
web page you can like generally white

118
00:12:20,799 --> 00:12:26,249
leaves them either through text of the
content that you want to appear on the

119
00:12:26,249 --> 00:12:32,379
web page for example if you have to have
an onclick handler for example you can

120
00:12:32,379 --> 00:12:38,249
calculate that I just 256 for example
the edges and you

121
00:12:38,249 --> 00:12:43,209
routes that valujet you calculated in
your actual content security policy and

122
00:12:43,209 --> 00:12:50,069
only in line creep who's died just
matches whatever you declared in your

123
00:12:50,069 --> 00:12:54,899
HDD Heather and common security policy
would be evaluated anything else will be

124
00:12:54,899 --> 00:12:56,960
just blocked

125
00:12:56,960 --> 00:13:04,530
it's useful when you when you don't have
dynamic content but if you're for

126
00:13:04,530 --> 00:13:08,990
example your webpage serving different
streets for purp user agent or like our

127
00:13:08,990 --> 00:13:15,880
platform you can you can have multiple
crashes declared in your continued the

128
00:13:15,880 --> 00:13:20,780
policy but not a good idea and there's
another mechanism known space making his

129
00:13:20,780 --> 00:13:28,510
number used bombs so you generate a
random number and u-boot actually

130
00:13:28,510 --> 00:13:34,530
screamed to attribute in your HTML page
saying nonce and equals that's random

131
00:13:34,530 --> 00:13:42,949
value and you have the same monsignor
header and let it work and my brother

132
00:13:42,950 --> 00:13:52,060
just moxie

133
00:13:52,060 --> 00:14:04,030
source directive and if you don't
explicitly specify a resource type

134
00:14:04,030 --> 00:14:08,150
directive the value for the for the
directive will be derived from the full

135
00:14:08,150 --> 00:14:16,520
source so which means which means if you
don't have for example phone source

136
00:14:16,520 --> 00:14:20,439
declared in your policy the value for
fun source will be derived from default

137
00:14:20,440 --> 00:14:32,650
source and yeah the same thing for any
source type now we learned that if you

138
00:14:32,650 --> 00:14:38,600
have multiple expressions in Lansing go
directive you have too much any of them

139
00:14:38,600 --> 00:14:44,730
but there must be a match with any of
the expressions to let the resource 2022

140
00:14:44,730 --> 00:14:50,850
below that so now what if you have say
by your network infrastructure is that

141
00:14:50,850 --> 00:15:01,640
is such a way that you for example have
an edge devices that had some some some

142
00:15:01,640 --> 00:15:05,510
default content security policy and on
other web service actual application web

143
00:15:05,510 --> 00:15:10,900
servers are depending on actually
defining comment if you deposited

144
00:15:10,900 --> 00:15:16,069
specific to this particular webpage so
technically you can have multiple

145
00:15:16,070 --> 00:15:21,340
content security policies but there's a
caveat that in this case you actually

146
00:15:21,340 --> 00:15:25,500
have too much every single content
security policy that you have the Euro

147
00:15:25,500 --> 00:15:35,540
declare to allow the web page to load
the resource basically in this case

148
00:15:35,540 --> 00:15:40,910
only matching URL that would satisfy all
three policies would be something like

149
00:15:40,910 --> 00:15:52,839
eight ES API that example.com and only
case itself is also coming from example

150
00:15:52,839 --> 00:15:58,029
that come by when you you'll see later
endured you can combine actually

151
00:15:58,029 --> 00:16:03,670
multiple times have you deposited there
is a single had a comma-separated values

152
00:16:03,670 --> 00:16:08,199
it's it's it's not see a vacation that
you can come by then usually head are

153
00:16:08,199 --> 00:16:12,479
any multiple a sleepyhead asking to see
you go ahead with comma separated that

154
00:16:12,480 --> 00:16:23,860
it's also basically these are two
equivalent but fortunately you don't see

155
00:16:23,860 --> 00:16:29,939
much here but the point of these ladies
are you cannot basically

156
00:16:29,939 --> 00:16:36,189
if you try to combine policies by Justin
coordinating them going to a different

157
00:16:36,189 --> 00:16:44,059
policies because you first case you have
too much every single source expression

158
00:16:44,059 --> 00:16:49,069
and in case of second policy becomes
normal person you have too much only

159
00:16:49,069 --> 00:16:53,079
like any of the source expression so
different policies they have different

160
00:16:53,079 --> 00:17:03,748
semantics yeah speaking about semantics
as I said like if there is no explicit

161
00:17:03,749 --> 00:17:09,899
declaration of a resource type directive
will be derived from before source so

162
00:17:09,898 --> 00:17:13,859
now if we have for example a common
security policy that declares every

163
00:17:13,859 --> 00:17:19,339
single possible source type so we have
screwed source file source image own

164
00:17:19,339 --> 00:17:25,398
child connect object that means that
this was sourced doesn't have any

165
00:17:25,398 --> 00:17:29,899
meaning in this case or ABC is like not
used by by any of them because like

166
00:17:29,899 --> 00:17:33,158
every single policies over I think
development so basically it means that

167
00:17:33,159 --> 00:17:39,100
you can see all of these sub sub
resource directives are saying that I'm

168
00:17:39,100 --> 00:17:47,779
allowing the only domain origin DS
allowed to express the same thing as

169
00:17:47,779 --> 00:17:52,059
buyers just think before they have the
same semantics but the grammar is

170
00:17:52,059 --> 00:18:03,220
completely before so yeah if if you
skipping on that means basically empty

171
00:18:03,220 --> 00:18:12,330
of east of course expressions is the
same as now default

172
00:18:12,330 --> 00:18:16,260
here

173
00:18:16,260 --> 00:18:24,730
house bag interprets if you do not
specify the scheme so basically this 3

174
00:18:24,730 --> 00:18:29,710
directives are semantically are are
semantically equivalent because

175
00:18:29,710 --> 00:18:38,840
example.com if the team is missing and
spectators like him very long sentence

176
00:18:38,840 --> 00:18:44,299
with like one-two-three-four with four
negations it defines what you should do

177
00:18:44,299 --> 00:18:49,690
and what they basically what is it
saying that the false gmail is missing

178
00:18:49,690 --> 00:18:59,080
and think this is an example house bank
is not really easy to interpret and yeah

179
00:18:59,080 --> 00:19:05,379
if you have a poor if you have a scheme
and missing poor then default port will

180
00:19:05,380 --> 00:19:11,389
be assumed to be there is going to be a
DHCP at 4:40 a.m. website gets 80 443

181
00:19:11,389 --> 00:19:18,279
aspect also be finds golfer but using
both of these days most permissive

182
00:19:18,279 --> 00:19:24,429
policy like most of the content security
policy 101 blog posts are like tutorials

183
00:19:24,429 --> 00:19:29,789
are saying that most permissive policies
like defaults or star which means that

184
00:19:29,789 --> 00:19:34,679
any source any resource type can be
loaded from anywhere but it's actually

185
00:19:34,679 --> 00:19:40,679
not true because even if all sorts
daughter is still not allowing people on

186
00:19:40,679 --> 00:19:45,340
streets or it doesn't the law they the
URL for filesystem you are also blocked

187
00:19:45,340 --> 00:19:50,360
so basically most permissive policies
actually the the lower one is the false

188
00:19:50,360 --> 00:19:56,649
or star unsafe in line unsafe evolve and
it's exactly the same as like not having

189
00:19:56,649 --> 00:20:02,029
to policy

190
00:20:02,029 --> 00:20:06,899
on the other hand most restrictive
policies gonna be default source nine so

191
00:20:06,899 --> 00:20:15,978
missing on means empty expression sort
of pressure on but since praying mantis

192
00:20:15,979 --> 00:20:21,349
there's like form action and sandbox are
not derived from the default sources

193
00:20:21,349 --> 00:20:25,049
have to explicitly specify them because
by default if you don't specify say form

194
00:20:25,049 --> 00:20:29,879
action it is start winning form can be
submitted anywhere or play Manchester

195
00:20:29,879 --> 00:20:34,468
City's also star by before if you don't
explicitly specified in the policy any

196
00:20:34,469 --> 00:20:45,029
website download your web page can go
directly you don't remember what is this

197
00:20:45,029 --> 00:20:50,869
ok so there is one exception to connect
sources basically not about loading

198
00:20:50,869 --> 00:20:56,709
resources but about connecting making
good connections from your website and

199
00:20:56,710 --> 00:21:06,059
sources responsible to control where
your website can connect to myself and a

200
00:21:06,059 --> 00:21:12,789
CBS served by example that come with the
same rule like any of the sort of

201
00:21:12,789 --> 00:21:17,669
question should match so it doesn't
match anything scheme doesn't match it

202
00:21:17,669 --> 00:21:24,629
doesn't match sale because because he's
actually HTTPS example the origin and

203
00:21:24,629 --> 00:21:32,399
we're trying to connect to be so will
not be allowed to BS example of comfort

204
00:21:32,399 --> 00:21:37,918
8080 will also not be allowed because it
assumes that if you don't specify the

205
00:21:37,919 --> 00:21:47,999
port port has to be 4434 HDDs schemes on
this one because it matches the origin

206
00:21:47,999 --> 00:21:55,940
is the same a self so it is allowed
myself this one is also because 443 like

207
00:21:55,940 --> 00:22:00,469
it's the same as not specifying 443
because before court for HTTPS 443

208
00:22:00,469 --> 00:22:05,879
according to counter to the prospect
website get won't work because we don't

209
00:22:05,879 --> 00:22:07,830
allow WebSocket by any of the

210
00:22:07,830 --> 00:22:19,779
source expressions same as some examples
from real world this is actually works

211
00:22:19,779 --> 00:22:20,559
ESPN

212
00:22:20,559 --> 00:22:30,330
simplified suspended service CNN it's
pretty bad because they are not only

213
00:22:30,330 --> 00:22:36,100
allowing anything from anywhere they are
for some reason duplicating the same

214
00:22:36,100 --> 00:22:42,529
data because these streets are saying we
allow scripts to be loaded from

215
00:22:42,529 --> 00:22:47,480
everywhere and from cell which is
already nonsensical but on top of that

216
00:22:47,480 --> 00:22:53,570
they allow unsafe evolve and unsafe you
line and laws that allow they to URI for

217
00:22:53,570 --> 00:22:58,120
images to basically it's better not to
have any policies and to have something

218
00:22:58,120 --> 00:22:58,959
like this

219
00:22:58,960 --> 00:23:07,779
another example is it's actually some
Russian website this is the country to

220
00:23:07,779 --> 00:23:16,799
pass it serves its pretty long and I'm
sure it can be like optimized another

221
00:23:16,799 --> 00:23:26,418
may be worth policy ever itself by armed
outcome actually they allow directive

222
00:23:26,419 --> 00:23:31,320
name which is deprecated and allow
actually never made into official says

223
00:23:31,320 --> 00:23:36,439
peace pact and it was just experimental
feature 45 implemented by Firefox and

224
00:23:36,440 --> 00:23:39,389
they use for a man says there's in
Fremont systems directly was introduced

225
00:23:39,389 --> 00:23:43,070
by CSP level 21 for example Safari
doesn't know what three months has been

226
00:23:43,070 --> 00:23:46,840
seized and Safari doesn't know what a
lot of ways because allowing never made

227
00:23:46,840 --> 00:23:52,100
them to the specs so these policy by
armed that tom is actually like doing

228
00:23:52,100 --> 00:24:06,820
nothing at all browsers and this is a
big issue for example if you have any

229
00:24:06,820 --> 00:24:13,779
HTTP header and not contain no nasty
characters pretty much like if we

230
00:24:13,779 --> 00:24:15,399
generalize

231
00:24:15,399 --> 00:24:19,059
the CSP is not an exception that you
cannot have known as characters in CSP

232
00:24:19,059 --> 00:24:24,869
and if you put something like something
outside of austin range actually brought

233
00:24:24,869 --> 00:24:26,949
us behave differently

234
00:24:26,950 --> 00:24:30,440
chrome ignored the entire policy

235
00:24:30,440 --> 00:24:36,419
entire directive and Firefox will you
know they the particular that has a

236
00:24:36,419 --> 00:24:41,379
problem and pars the rest of the top
guns for example of good scripts or

237
00:24:41,379 --> 00:24:45,678
south and food in case of chrome
everything will be ignored and likes

238
00:24:45,679 --> 00:24:51,330
troops from everywhere are allowed to
download it and the case of Firefox self

239
00:24:51,330 --> 00:24:57,178
will still be enforced because they get
on these inspections that just ignored

240
00:24:57,179 --> 00:25:01,979
the problem out there and keep the rest

241
00:25:01,979 --> 00:25:06,599
keep other source expressions and
powerful still didn't fix it

242
00:25:06,599 --> 00:25:14,950
another box that we reported 15 bucks on
Chrome these two are action security

243
00:25:14,950 --> 00:25:22,619
bugs their feeds but they still haven't
removed from the box and you cannot see

244
00:25:22,619 --> 00:25:26,488
it's not available to everybody but for
example this is I think it's pretty big

245
00:25:26,489 --> 00:25:31,299
spec you saying that if you have a
policy like these like star . something

246
00:25:31,299 --> 00:25:40,029
that's something you actually have to
march aur mat match URL that are ending

247
00:25:40,029 --> 00:25:44,299
we've got something that's something
that actually allowing something .

248
00:25:44,299 --> 00:25:49,619
something so basically chrome was
allowing X Y class file to be moved it

249
00:25:49,619 --> 00:25:57,109
all go according to the schedule below
that and I think it can be a big source

250
00:25:57,109 --> 00:26:01,519
of the problem of problems because you
don't respect people implement their

251
00:26:01,519 --> 00:26:05,599
policies according to the specs but then
turns out that Chrome the browser is not

252
00:26:05,599 --> 00:26:10,310
interpreting the spec the same way as
you are or

253
00:26:10,310 --> 00:26:15,710
Islamist groups or star according to
this thing shouldn't allow any they

254
00:26:15,710 --> 00:26:19,990
tough or file system or blog you our
eyes but chrome is actually allowing you

255
00:26:19,990 --> 00:26:24,300
then you can have something like this in
your on your webpage like you're

256
00:26:24,300 --> 00:26:31,270
prosecuting payload can be dated uri
andropov perfectly workin chrome and you

257
00:26:31,270 --> 00:26:34,540
would have false sense of security by
thinking that chrome implemented

258
00:26:34,540 --> 00:26:43,340
properly there is pool featuring cspi
cultures be reporting so what happens

259
00:26:43,340 --> 00:26:46,560
when you specify policy and your browser

260
00:26:46,560 --> 00:26:50,030
violates the policy so basically tries
to load the street from somewhere that

261
00:26:50,030 --> 00:27:02,590
you are not widely actually browser
would send the report to you go you put

262
00:27:02,590 --> 00:27:06,919
report URI directive in your policy and
you can specify multiple electron URI

263
00:27:06,920 --> 00:27:10,029
where the report will be sent

264
00:27:10,029 --> 00:27:15,989
and the the spec you saying that report
you go to every URL you least they're

265
00:27:15,989 --> 00:27:27,169
all browsers except Firefox will
actually upend the kooky if you if if if

266
00:27:27,169 --> 00:27:35,109
report URI shares the report to rise but
has the same origin as the webpage where

267
00:27:35,109 --> 00:27:41,509
policy and although speakeasy finding
before much of their reports every

268
00:27:41,509 --> 00:27:47,749
brawls and implements its own format on
the report link for example the agency

269
00:27:47,749 --> 00:27:52,440
that is exactly the same violation
generated by Firefox and promised by the

270
00:27:52,440 --> 00:27:59,849
size of the report you can see that
there are different so reports ESP

271
00:27:59,849 --> 00:28:17,389
reporting just not normalize them before
processing

272
00:28:17,389 --> 00:28:27,699
report is as limited types of a third
attempt the browser can share with them

273
00:28:27,700 --> 00:28:33,959
point of collection reports so if you
want to add some extra data there is no

274
00:28:33,959 --> 00:28:38,909
way to extend the report format CSV
reporting for my report format so the

275
00:28:38,909 --> 00:28:44,239
only way is to pass the data as likewise
three parameters of your PSP reporter

276
00:28:44,239 --> 00:28:51,599
and by the end of the presentation I
there's a link on a blog post on how to

277
00:28:51,599 --> 00:28:56,369
be there for example is handling reports
and their polling station Navy actually

278
00:28:56,369 --> 00:29:01,399
CSP reports your I so basically they can
tell that this report was generated by

279
00:29:01,399 --> 00:29:07,320
these drawers are legitimately because
otherwise like every problem like if you

280
00:29:07,320 --> 00:29:12,729
have a little beauty your webpage all
browsers in the world are so we'll start

281
00:29:12,729 --> 00:29:18,329
sending UCSB reports and you cannot
distinguish if this report is legitimate

282
00:29:18,329 --> 00:29:26,989
or somebody's just bombing you with the
same post messages messages that contain

283
00:29:26,989 --> 00:29:30,769
something that looks like Sears report
unlike you can be pretty big source of

284
00:29:30,769 --> 00:29:37,630
for example a tax

285
00:29:37,630 --> 00:29:45,650
there's another good feature you can
actually you can deploy your policy in

286
00:29:45,650 --> 00:29:50,860
report only mode so basically report
only header after acts exactly the same

287
00:29:50,860 --> 00:29:59,409
way as content security policy had there
is that it's your policy violates it

288
00:29:59,410 --> 00:30:08,360
applies the violations but it doesn't
enforce violations just generate the

289
00:30:08,360 --> 00:30:11,479
report will generate reports in the same
way but it doesn't break the page if you

290
00:30:11,480 --> 00:30:15,870
have a problem on the web page but CSP
and you mistakenly are blocking some

291
00:30:15,870 --> 00:30:21,060
resources that are that is not supposed
to be blocked that constitute a false

292
00:30:21,060 --> 00:30:26,340
report only will help so basically you
do good practices to roll out your kind

293
00:30:26,340 --> 00:30:30,800
of security policy as report on me for a
week and liked we keep them to fix it

294
00:30:30,800 --> 00:30:34,879
until you stop receiving reports that
are not supposed to be there and you

295
00:30:34,880 --> 00:30:40,310
only receive actual attack reports and
then like a week later you switch the

296
00:30:40,310 --> 00:30:47,440
actual kind of security policy of their
yeah I should have mentioned this in the

297
00:30:47,440 --> 00:30:51,690
beginning of the presentation but holla
why we started bitching at CSP so

298
00:30:51,690 --> 00:30:58,400
company where I work we make a network
of plans which modifies the

299
00:30:58,400 --> 00:31:04,060
HDB responses we can inject our own
stripping to work the webpage or we

300
00:31:04,060 --> 00:31:07,970
might modify the actual streets that
already there and defense attorneys

301
00:31:07,970 --> 00:31:13,870
using CSP we need to actually add just
the CSP before forwarding that they

302
00:31:13,870 --> 00:31:21,659
should be response to the browser and
it's not actually that easy task it's

303
00:31:21,660 --> 00:31:26,420
not like just got an 18 or like I don't
know if for example you for introducing

304
00:31:26,420 --> 00:31:27,350
you

305
00:31:27,350 --> 00:31:32,030
origin and like if our appliances
eddings judge equity that damage looks

306
00:31:32,030 --> 00:31:38,350
like you are pending jQuery dot com into
the 22 this source its it has its own

307
00:31:38,350 --> 00:31:38,820
rules

308
00:31:38,820 --> 00:31:46,210
yeah we decided to implement the library
which optimizes things like bone parse

309
00:31:46,210 --> 00:31:51,530
error locations positions and warning
positions and you can answer questions

310
00:31:51,530 --> 00:31:55,570
like the same questions as browser with
us

311
00:31:55,570 --> 00:32:05,830
implementation will answer sorry using
production so it's pretty well past

312
00:32:05,830 --> 00:32:12,030
eight so yeah what are the problems that
our libraries trying to solve for

313
00:32:12,030 --> 00:32:16,389
example when you have to merge two
policies basically there was a policy

314
00:32:16,390 --> 00:32:20,200
set by the website and now we want to
merge that policy with something that we

315
00:32:20,200 --> 00:32:28,490
want to add that will be union emerging
and it's not just the nation yet to

316
00:32:28,490 --> 00:32:41,170
properly merge merge the values measured
using the intersection strategy also and

317
00:32:41,170 --> 00:32:45,660
this would basically meaning what
browser would do if you have multiple

318
00:32:45,660 --> 00:32:47,770
policies basically you have to come up

319
00:32:47,770 --> 00:32:53,040
yes to policies now you have to come up
with some fed policy that would satisfy

320
00:32:53,040 --> 00:32:59,409
both policies basically if you had a
policy that scene before source AMD and

321
00:32:59,410 --> 00:33:05,080
another policy which has the full source
not shown on would win because the only

322
00:33:05,080 --> 00:33:10,550
URL that would match both policies would
be like there is no such you are

323
00:33:10,550 --> 00:33:13,470
so for example the full source

324
00:33:13,470 --> 00:33:18,419
would become not prescribe source the
first policy is saying the full source a

325
00:33:18,419 --> 00:33:21,640
be there is no stream resource which
meaning Street source derived from

326
00:33:21,640 --> 00:33:26,490
default source which means for the first
policy astute sources also a B and for

327
00:33:26,490 --> 00:33:29,830
the second bombing star so the
intersection of them is going to be a B

328
00:33:29,830 --> 00:33:34,689
and leg for everything else there's no
intersection so you just get rid of it

329
00:33:34,690 --> 00:33:40,220
but it's hard to manual be bribed them
better to use something like our library

330
00:33:40,220 --> 00:33:46,280
for example of this website says they
don't have thought which uses some

331
00:33:46,280 --> 00:33:56,600
features of the library on the back end
and you can't ask them

332
00:33:56,600 --> 00:34:02,230
you can enter URL to Querrey actual
consecutive passes of some websites or

333
00:34:02,230 --> 00:34:07,200
like to lick the bottom and will
populate the URL of the website that

334
00:34:07,200 --> 00:34:11,010
actually contains CSP to analyze later
or you can come up with your own

335
00:34:11,010 --> 00:34:14,800
policies and like test them on the
website then let marge and merge using

336
00:34:14,800 --> 00:34:22,220
union strategy or intersection strategy
see democracy the warnings see

337
00:34:22,219 --> 00:34:29,709
nonsensical warnings will also also
optimize the policy for you and you can

338
00:34:29,710 --> 00:34:37,570
compare it was actually optimization
that took place or the same and you have

339
00:34:37,570 --> 00:34:48,770
a joke like optimal policy I just
actually our website is also serving the

340
00:34:48,770 --> 00:34:54,830
polycondensation the policy and this is
an example of good policy work first you

341
00:34:54,830 --> 00:35:00,930
write your website so you don't have to
have in line scripts or any kind of land

342
00:35:00,930 --> 00:35:05,440
resources because its first it's good
practice is good for caching so you move

343
00:35:05,440 --> 00:35:12,530
any script that you have to turn to
external files and yeah this policy

344
00:35:12,530 --> 00:35:21,170
covers everything but we cover all types
of resources we collect our reports we

345
00:35:21,170 --> 00:35:27,340
allow all the resources that we actually
need to and we are trying to be like

346
00:35:27,340 --> 00:35:33,220
estrogen as possible by like to start
with the sole source nom and then you at

347
00:35:33,220 --> 00:35:38,910
least your resources one-by-one yeah we
reported like i dont no more than 10

348
00:35:38,910 --> 00:35:46,259
bucks to against drugs we start helping
with actual says peace bag by submitting

349
00:35:46,260 --> 00:35:49,440
your request which are being accepted

350
00:35:49,440 --> 00:35:51,400
sometimes

351
00:35:51,400 --> 00:35:58,950
yeah these are my good resources where
you can learn about CSP and that's

352
00:35:58,950 --> 00:36:38,430
pretty much it

353
00:36:38,430 --> 00:36:58,649
anything other than star

354
00:36:58,650 --> 00:37:11,260
size speaker doesn't talk about it but
draws are sexually header so yeah

355
00:37:11,260 --> 00:37:23,170
that'll be your limit but doesn't define
and limits

356
00:37:23,170 --> 00:37:30,329
question of implementing CSP some time
ago and we got rid of report euro

357
00:37:30,329 --> 00:37:39,460
because we tried to avoid using report
arrive by guys something like we can't

358
00:37:39,460 --> 00:37:48,589
control the trusts in the JSON parser we
wrote for Europe are Sarah and would

359
00:37:48,589 --> 00:37:54,160
like to ask if there are any report you
write scripts ready that are quite good

360
00:37:54,160 --> 00:38:00,089
enough there are checked for
vulnerabilities and that we can use so

361
00:38:00,089 --> 00:38:06,609
that there are two things first for
example there was that existed from

362
00:38:06,609 --> 00:38:15,440
August last year till October this year
it was generating reports for Valley

363
00:38:15,440 --> 00:38:20,819
completely valid web pages that contain
on such a good and so yeah people were

364
00:38:20,819 --> 00:38:29,140
being hammered by CSP reports generated
by Firefox so a lot of people just

365
00:38:29,140 --> 00:38:35,879
disable TSP reporting at least user
agent is Firefox to answer your question

366
00:38:35,880 --> 00:38:41,540
there a third-party guys that are
collecting your reports for you and

367
00:38:41,540 --> 00:38:51,589
basically they take the risk of being
hacked PSP you it's yet century that

368
00:38:51,589 --> 00:38:55,720
come it's paid service but they
normalize the report for you like they

369
00:38:55,720 --> 00:38:59,339
provide you the normalized version of
everything and they basically they parse

370
00:38:59,339 --> 00:39:04,859
the JSON they take care of everything
it's paid there's another guy

371
00:39:04,859 --> 00:39:12,538
which is free website ECSB report there
that I think for CSP report that I use

372
00:39:12,539 --> 00:39:20,680
this guy report you are right but he
turned us off because too many rights

373
00:39:20,680 --> 00:39:26,980
testing in report on the mode but I
wonder if you just in in injury-time

374
00:39:26,980 --> 00:39:34,779
script and runs as an Aurora and some
analysts gods do sorority console for

375
00:39:34,779 --> 00:39:42,640
example and you run alert something like
that any existing if the report analyzer

376
00:39:42,640 --> 00:39:44,660
is returned

377
00:39:44,660 --> 00:39:50,078
that actually spanky saying that CSB
report mimetype content should be

378
00:39:50,079 --> 00:39:56,430
applications esq report but only chrome
implements all other browsers

379
00:39:56,430 --> 00:40:04,089
application that Jessie J Sun so when
all browser start doing it properly and

380
00:40:04,089 --> 00:40:14,069
you can tell already from content type
and yeah yeah not solved and the only

381
00:40:14,069 --> 00:40:27,269
thing is to outsource it to some guys
that are ready to take the beauty risk

382
00:40:27,269 --> 00:40:28,169
thank you

