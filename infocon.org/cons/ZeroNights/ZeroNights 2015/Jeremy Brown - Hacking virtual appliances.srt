1
00:00:00,000 --> 00:00:05,319
sham samples may be on the agenda shall
I knew much about them for months and

2
00:00:05,319 --> 00:00:11,010
Photoshop idea in the shower but also
said thank you for shopping at my desk

3
00:00:11,010 --> 00:00:15,730
as its applicability across Gaza Strip
and uni proceeds going to jump fast as I

4
00:00:15,730 --> 00:00:22,769
can be a contingent on the mark warda
pragmatic started when I missed seeing

5
00:00:22,769 --> 00:00:34,210
you this is Jeremy brown and yellow
Moscow great to be here actually don't

6
00:00:34,210 --> 00:00:38,040
have a nice Chinese store it was a
little hard to get here and I'm

7
00:00:38,040 --> 00:00:42,710
definitely glad that worked out because
what an awesome conference represent

8
00:00:42,710 --> 00:00:51,010
what a great place but today I'm going
to talk to you about hiking prices and

9
00:00:51,010 --> 00:00:54,370
well actually it right now we're talking
to you about that in two hours we

10
00:00:54,370 --> 00:00:58,890
talking about browser closing so come
back to that right now talking to you

11
00:00:58,890 --> 00:01:03,320
about how commercial clients and this is
larry is this really interesting to me

12
00:01:03,320 --> 00:01:07,250
and I kinda got into it because I don't
see anyone doing security around these

13
00:01:07,250 --> 00:01:13,030
things and when I first are looking them
I found a lot of really interesting bugs

14
00:01:13,030 --> 00:01:14,040
a lot of remote

15
00:01:14,040 --> 00:01:19,330
true bugs so they became really valuable
so decidedly more and more research and

16
00:01:19,330 --> 00:01:24,429
I get I didn't see many people looking
in this area and somebody's going to

17
00:01:24,430 --> 00:01:28,270
bugs are very specific to virtual
appliances if you don't have plans is

18
00:01:28,270 --> 00:01:31,929
making the sign I'm gonna go through all
that and hopefully show you something

19
00:01:31,930 --> 00:01:39,040
new today

20
00:01:39,040 --> 00:01:45,260
could run through the agenda will get
the introduction just kind of talk about

21
00:01:45,260 --> 00:01:49,240
what virtual appliances are where they
are you know why this is important and

22
00:01:49,240 --> 00:01:49,649
all

23
00:01:49,650 --> 00:01:54,700
always good to know motivation to do
further research biggest the image

24
00:01:54,700 --> 00:01:59,010
analysis and how I actually went about
looking and finding these

25
00:01:59,010 --> 00:02:02,370
vulnerabilities in virtual appliances
and a look into the vulnerabilities

26
00:02:02,370 --> 00:02:06,660
himself there's a ton and a few
different categories I kinda group them

27
00:02:06,660 --> 00:02:10,119
together and miscellaneous at the end
because there's just so many different

28
00:02:10,119 --> 00:02:14,780
kinds of bugs you can find in them and
some very specific to you know the the

29
00:02:14,780 --> 00:02:19,540
kind of virtual private area like
password later this pretty civic this

30
00:02:19,540 --> 00:02:24,370
another area that gets into to go with
the conclusion and you know where to go

31
00:02:24,370 --> 00:02:29,060
from here and how vendors can actually
start making these much more secure than

32
00:02:29,060 --> 00:02:33,380
they are right now so you know my name

33
00:02:33,380 --> 00:02:36,579
independent researcher consultant at the
moment

34
00:02:36,580 --> 00:02:42,030
used to work for Microsoft Windows Phone
Xbox security also worked in our

35
00:02:42,030 --> 00:02:46,980
production center for a while and before
that worked tenable and probably if you

36
00:02:46,980 --> 00:02:51,700
have used Nexus before I wrote a few
Nexus plugins while there is some

37
00:02:51,700 --> 00:02:57,670
reverse engineering things like that so
fun times so to be clear we're not

38
00:02:57,670 --> 00:03:00,869
talking about in this area in the in the
VA area

39
00:03:00,870 --> 00:03:04,670
relatively non critical issues not me
talking about must now service

40
00:03:04,670 --> 00:03:09,309
cross-site scripting again these can be
critical in other areas but virtual

41
00:03:09,310 --> 00:03:13,890
appliances it's not a huge deal and also
not decrypting 2 p.m. images school

42
00:03:13,890 --> 00:03:20,109
because that's sometimes necessary as
well in order to even start doing static

43
00:03:20,110 --> 00:03:25,120
analysis of the images you need to know
how the keys and and equip them and

44
00:03:25,120 --> 00:03:30,250
there's not a lot of tools that let you
do that today so that's pretty funny

45
00:03:30,250 --> 00:03:34,810
stuff this talk is very focused on
vulnerabilities for me mostly talking

46
00:03:34,810 --> 00:03:41,989
about Rochelle lash if you're a fan of
Rio shells command injection backdoor

47
00:03:41,989 --> 00:03:45,660
account and then once we get the shell
gonna be looking at how to escalate

48
00:03:45,660 --> 00:03:50,600
privileges to of course root cause most
assistance we look at just how all the

49
00:03:50,600 --> 00:03:52,430
dead are linux-based system

50
00:03:52,430 --> 00:03:57,329
so keep that in mind as well and other
interesting blogs there's a for

51
00:03:57,329 --> 00:04:00,900
mastering bargain here some kind of
misconfigured services that allow us to

52
00:04:00,900 --> 00:04:06,620
gain over the ground and again though
that the format favored bugs is specific

53
00:04:06,620 --> 00:04:13,769
to this area is your password later and
I'll show you more about that so what is

54
00:04:13,769 --> 00:04:16,530
a virtual appliance

55
00:04:16,529 --> 00:04:21,779
pretty smart and figured out physical
plants virtual plants so physical box

56
00:04:21,779 --> 00:04:26,880
and you have a disk image that you enter
into a hypervisor with all kind of

57
00:04:26,880 --> 00:04:30,919
configuration and run in a datacenter or
rent a home where you wish

58
00:04:30,919 --> 00:04:39,020
use VMware all those different kinds of
hypervisors and again the kind of thing

59
00:04:39,020 --> 00:04:42,389
the vendors are saying here ok we have a
physical appliance you know we can ship

60
00:04:42,389 --> 00:04:46,490
that to you just give them a little tiny
computer with a bunch of networking

61
00:04:46,490 --> 00:04:50,680
ports or we can just take all that
whatever is in on that flash memory

62
00:04:50,680 --> 00:04:52,090
whatever is on the hard drive

63
00:04:52,090 --> 00:04:59,020
jumping onto a virtualized disc ISO or
or a PhD or something like that and just

64
00:04:59,020 --> 00:05:06,740
ship it to the customers for their data
center where they won't install it so

65
00:05:06,740 --> 00:05:11,849
one interesting articles found in this
is from VMware article and that is

66
00:05:11,849 --> 00:05:14,820
another reason that a lot of vendors are
doing the virtual appliances his

67
00:05:14,820 --> 00:05:19,520
physical plant is no longer need to be
shipped across national borders I never

68
00:05:19,520 --> 00:05:23,150
really thought about that before I never
really thought that would be a reason

69
00:05:23,150 --> 00:05:27,630
but it is interesting when you look at
how you do you know how do you deliver a

70
00:05:27,630 --> 00:05:31,070
the customer device you know you have to
go through customs you have to go

71
00:05:31,070 --> 00:05:35,639
through import export and all that with
a physical device not so much when you

72
00:05:35,639 --> 00:05:39,389
have a virtual device that you can
either send them or drop somewhere where

73
00:05:39,389 --> 00:05:42,889
they can download things like that so
that's definitely something that's gonna

74
00:05:42,889 --> 00:05:46,720
make virtual appliances take off even
more than physical appliances you know

75
00:05:46,720 --> 00:05:52,520
once we get the computer computing power
down an important distinction here the

76
00:05:52,520 --> 00:05:59,430
bugs that are on virtual appliances are
in specific to an environment there it's

77
00:05:59,430 --> 00:06:02,380
kind of like the one bug rolls all
things where

78
00:06:02,380 --> 00:06:06,010
this is not some specific configuration
you gotta have or making modifications

79
00:06:06,010 --> 00:06:09,020
to their plans for to be vulnerable

80
00:06:09,020 --> 00:06:13,030
once the bug is shipped in this there's
not a ton of different versions he need

81
00:06:13,030 --> 00:06:18,190
two different things like that one bug
is going to take care of all of them so

82
00:06:18,190 --> 00:06:22,020
that's an important distinction to make
between that and just user regular user

83
00:06:22,020 --> 00:06:26,150
I am programs are things you install
Windows and Linux virtual appliances are

84
00:06:26,150 --> 00:06:30,890
little bit different so unpopular
vendors pretty much all the major

85
00:06:30,890 --> 00:06:36,200
vendors have appliances but not too much
Microsoft for example because a lot of

86
00:06:36,200 --> 00:06:40,219
Windows Virtual Appliances maybe a
couple but most major companies IBM

87
00:06:40,220 --> 00:06:44,670
semantic being more cisco has a ton of
virtual appliances being where has a

88
00:06:44,670 --> 00:06:49,470
pretty good laws while I get really good
as a teaser to appliances because that

89
00:06:49,470 --> 00:06:53,910
cloud only trials so I can actually
download it and he'll do my analysis on

90
00:06:53,910 --> 00:06:58,300
it you're only hosting and web page for
me to have to login and all the stuff so

91
00:06:58,300 --> 00:07:04,530
they'll offer that got some free
security work but some of the pros and

92
00:07:04,530 --> 00:07:09,049
cons are becoming the biggest thing here
they share pretty much the same amount

93
00:07:09,050 --> 00:07:13,610
of code I mean everything from the
physical device universal it's pretty

94
00:07:13,610 --> 00:07:18,330
much they just dump everything on the on
a disk image and shipped to customers so

95
00:07:18,330 --> 00:07:22,859
bugs you find there of course are going
to be probably vulnerable on virtual and

96
00:07:22,860 --> 00:07:27,270
physical and the common mind said the
crater long these messages customers

97
00:07:27,270 --> 00:07:31,169
don't have route that that's a huge
thing we're ok you know either they

98
00:07:31,170 --> 00:07:34,810
don't have root or they don't have a
shell so there is always the bug

99
00:07:34,810 --> 00:07:39,850
interfaces all these just sensitive
information bash history things like

100
00:07:39,850 --> 00:07:44,440
that they're just left on the system and
then when you start looking at when you

101
00:07:44,440 --> 00:07:48,910
start statically analyzing you even if
you don't have root dynamically when you

102
00:07:48,910 --> 00:07:52,730
have stalin's are running it
aesthetically you can try and all these

103
00:07:52,730 --> 00:07:56,000
things as they left on there and they
can lead to some pretty serious

104
00:07:56,000 --> 00:08:00,080
vulnerabilities

105
00:08:00,080 --> 00:08:05,560
so why are these appliances at all they
know what they are they're definitely a

106
00:08:05,560 --> 00:08:10,060
prevalent as one factor as i said i
becoming more and more popular look at

107
00:08:10,060 --> 00:08:12,879
entertainment there's a few slides I
have they're just funny things that

108
00:08:12,879 --> 00:08:18,120
happened with they're not really bugs
per se but this really things that can

109
00:08:18,120 --> 00:08:22,039
go to take another look at this is
probably more serious things going on

110
00:08:22,039 --> 00:08:26,520
and value of course I enterprises are
using system so they are the bugs here

111
00:08:26,520 --> 00:08:36,299
are valuable and interesting from there
there's one looks like somebody just

112
00:08:36,299 --> 00:08:41,120
said oh here's an image my work PC its
virtual appliance change password you

113
00:08:41,120 --> 00:08:46,850
want to don't just let the bass history
on here they left them in history they

114
00:08:46,850 --> 00:08:53,990
left the stage known hosts file so you
can kind of see where this is going and

115
00:08:53,990 --> 00:08:56,779
where they're just leaving thing is that
ok me that I have route they don't have

116
00:08:56,779 --> 00:09:00,769
whatever privileges even look at these
files so we don't need to worry about

117
00:09:00,769 --> 00:09:07,050
removing them this is one where they
left just plain text passwords and

118
00:09:07,050 --> 00:09:14,750
figuration file the file password secure
all this one you know this was a bug

119
00:09:14,750 --> 00:09:17,959
where they're like ok we can't leave
plaintext passwords and configuration

120
00:09:17,959 --> 00:09:24,018
file so let's hash them only thing here
they forgot to solve the hash so any

121
00:09:24,019 --> 00:09:27,339
rainbow tables going pick this up the
matter even if it's a pretty complex

122
00:09:27,339 --> 00:09:32,510
password and they're still gonna pick it
up as cluster password this one where

123
00:09:32,510 --> 00:09:37,260
they left the the password and any local
user can just walk into the database

124
00:09:37,260 --> 00:09:41,260
using the password to some local system
and you know do whatever they want from

125
00:09:41,260 --> 00:09:44,959
there again not really bug just this
kind of warming up to show you the

126
00:09:44,959 --> 00:09:48,540
things and the kind of information is
left on the system's

127
00:09:48,540 --> 00:09:54,140
even further used to it to actually
exploit vulnerabilities and this one is

128
00:09:54,140 --> 00:09:58,230
this is probably from a IBM virtual
violence because they're you know

129
00:09:58,230 --> 00:10:05,470
they're into internal IBM systems and
downloading looks like a image file as

130
00:10:05,470 --> 00:10:09,250
even funnier here they try to remove the
bash history and this is the past

131
00:10:09,250 --> 00:10:11,820
history so it really do a very good job
of removing

132
00:10:11,820 --> 00:10:19,610
alright so entertainment factor one more
this one they sued rooted that I D

133
00:10:19,610 --> 00:10:24,430
binary why would you ever sue drew tidy
binary

134
00:10:24,430 --> 00:10:27,800
there had to be some bug where they're
like we need to saying when it when it

135
00:10:27,800 --> 00:10:32,290
excuse I D we need to make sure it
thinks its route so we're just gonna

136
00:10:32,290 --> 00:10:35,870
leave it like that totally useless he
can really use it for anyone knows how

137
00:10:35,870 --> 00:10:41,110
to exploit a suit and airy let me know
but it just just as a strange thing that

138
00:10:41,110 --> 00:10:49,630
occurs so they are you again a lot
easier to find some be talking about are

139
00:10:49,630 --> 00:10:53,650
using Enterprise and most important
thing here customers really want these

140
00:10:53,650 --> 00:10:57,990
bugs fixed because if they're going to
trust that a virtual appliances you know

141
00:10:57,990 --> 00:11:02,110
is just as secure as a physical plants
and you start shipping all these things

142
00:11:02,110 --> 00:11:05,300
you start giving people free trials and
download them from these vulnerabilities

143
00:11:05,300 --> 00:11:11,069
and and then don't even pay attention to
him then that's really not good for

144
00:11:11,070 --> 00:11:13,840
customers they definitely want these
bugs fixed because they're putting money

145
00:11:13,840 --> 00:11:20,660
into it just as if it was a physical
plants is this the same to them so why

146
00:11:20,660 --> 00:11:25,199
security so bad again is at this point
the vendor just saying hey here's an

147
00:11:25,200 --> 00:11:30,520
image of a computer it's a virtual
appliance you know we don't have all the

148
00:11:30,520 --> 00:11:34,040
QA that we normally have on their own
physical appliances is really easy just

149
00:11:34,040 --> 00:11:38,439
go set it up you know here's the default
password default user has to do

150
00:11:38,440 --> 00:11:43,360
privileges and all these things is just
really really take that seriously at

151
00:11:43,360 --> 00:11:48,420
this point I get a nose recurring theme
in just about every new new wave of

152
00:11:48,420 --> 00:11:56,589
vulnerabilities but that's what's
happening here as well so this is the

153
00:11:56,590 --> 00:12:03,860
vendors dog apparently sitting down
having cup of coffee and joint income

154
00:12:03,860 --> 00:12:11,700
so let me ask you this point well how do
I get a virtual appliance to look at

155
00:12:11,700 --> 00:12:18,350
well I'll tell you how I did it so many
websites are good for cities accordingly

156
00:12:18,350 --> 00:12:23,089
for free trial request valuation all
these Google dorks gotta watch out some

157
00:12:23,089 --> 00:12:26,940
of them are like a mix trial demo stuff
you look out for that you can make a

158
00:12:26,940 --> 00:12:31,390
purchase they can make an investment you
know especially if you perhaps make up

159
00:12:31,390 --> 00:12:34,360
make a living selling bugs are things
like that you can make an investment

160
00:12:34,360 --> 00:12:39,980
acquire the virtual appliance and then
find bugs and go from there and

161
00:12:39,980 --> 00:12:43,670
sometimes they're just not available I
ran into a couple cases where you needed

162
00:12:43,670 --> 00:12:47,660
a support contract you needed to be a
company to be accompanied company

163
00:12:47,660 --> 00:12:52,149
purchase or have some existing support
there before you can even closer want

164
00:12:52,149 --> 00:12:55,519
even if you're willing to pay for it
that was your in this strange situations

165
00:12:55,519 --> 00:13:02,180
like that when you start again so you
guys have be fully aware what virtual

166
00:13:02,180 --> 00:13:07,959
appliances are so image analysis how do
I go about looking at them so Virtua

167
00:13:07,959 --> 00:13:12,880
Fighter distributed like a lot of you
know different systems and in this way

168
00:13:12,880 --> 00:13:14,220
digitally

169
00:13:14,220 --> 00:13:18,370
OVA containers they usually crowded disk
image and like some kind of metadata

170
00:13:18,370 --> 00:13:22,079
files to tell you how to save the
configuration they may just come as a

171
00:13:22,079 --> 00:13:26,949
PhD may just kind of the hard drive you
plug into the hypervisor so a couple

172
00:13:26,949 --> 00:13:32,430
different ways to mention before dynamic
and static so dynamic the system they

173
00:13:32,430 --> 00:13:35,609
said what you see is what you get you
know you're not looking at it

174
00:13:35,610 --> 00:13:39,480
statically you're playing with the
system you're trying to see if you have

175
00:13:39,480 --> 00:13:45,209
root trying to see if you can get show
it's the trouble here again if you don't

176
00:13:45,209 --> 00:13:48,920
have those things and maybe motivation
to find them at the same time you need

177
00:13:48,920 --> 00:13:53,089
to use both techniques need to use a
static approach combined with that

178
00:13:53,089 --> 00:13:57,399
because statically you can look at the
file system without ever having to boot

179
00:13:57,399 --> 00:14:02,970
up you can see the shadow file if they
have undocumented users can check you

180
00:14:02,970 --> 00:14:07,079
can documentation check the shadow
following its users not there and then

181
00:14:07,079 --> 00:14:11,519
maybe you can crack the password then
you know there's a liability and a

182
00:14:11,519 --> 00:14:15,020
procedure here you need to take the raw
file system and converted using

183
00:14:15,020 --> 00:14:19,250
muesli something like that and then use
some kind of like a manager or forensic

184
00:14:19,250 --> 00:14:20,630
tool to browse it

185
00:14:20,630 --> 00:14:25,300
think the one I use was FTK imager
something like that it was pretty good

186
00:14:25,300 --> 00:14:29,650
for browsing all filesystems but the
limitations here at the meet me at least

187
00:14:29,650 --> 00:14:31,959
once or twice what some of them

188
00:14:31,960 --> 00:14:38,080
virtual prizes have first few scripts so
as soon as you boo town they start

189
00:14:38,080 --> 00:14:42,080
setting passwords they started doing all
these things where you can rely on that

190
00:14:42,080 --> 00:14:46,840
you know maybe a works at first but as
soon as you boot you know things are

191
00:14:46,840 --> 00:14:51,170
changing so you gotta again you have to
use both approaches to to get a good

192
00:14:51,170 --> 00:14:58,640
picture and confirm the bugs index now
meet me and go on to the bugs are

193
00:14:58,640 --> 00:15:03,910
vulnerabilities that I have not
discovered in a virtual appliances again

194
00:15:03,910 --> 00:15:08,520
a very broad categories a lot of
undocumented users and then

195
00:15:08,520 --> 00:15:14,420
miscellaneous from there handsome
password glitter so the first week at

196
00:15:14,420 --> 00:15:21,610
Cisco paging server 20 him for single
wire software they Dave provide paging

197
00:15:21,610 --> 00:15:28,280
service stuff fisheries abating server
you probably haven't is fine so on this

198
00:15:28,280 --> 00:15:28,730
one

199
00:15:28,730 --> 00:15:33,700
there's actually three interfaces to
authenticate the SSH daemon Weber men

200
00:15:33,700 --> 00:15:38,410
and the web interface for the first two
of these you obviously know Linux pretty

201
00:15:38,410 --> 00:15:42,930
well you know the web man and and the
local education system which acetates

202
00:15:42,930 --> 00:15:47,660
usually uses share the same they're the
same their their system password all

203
00:15:47,660 --> 00:15:53,209
that the web interface Cisco took on
this approach is different it uses a

204
00:15:53,210 --> 00:15:58,980
totally different way to store passwords
checkup indication so what happens when

205
00:15:58,980 --> 00:16:03,260
you change the admin password the web
interface absolutely nothing on the on

206
00:16:03,260 --> 00:16:09,100
the you know the local system so when
you're documenting only to change the

207
00:16:09,100 --> 00:16:13,330
administrator password on the web
interface and you never talk about

208
00:16:13,330 --> 00:16:17,430
changing any of the other credentials
which are still defaulting on the system

209
00:16:17,430 --> 00:16:24,910
well even if you and even if the
password is for example change me you're

210
00:16:24,910 --> 00:16:27,890
never going to change it never going to
change that password because the

211
00:16:27,890 --> 00:16:28,400
document

212
00:16:28,400 --> 00:16:33,090
only tells you to change the web
interface now let's hear some really

213
00:16:33,090 --> 00:16:36,140
skeptical administrator you're not going
to worry about Sitzmann this point you

214
00:16:36,140 --> 00:16:39,650
said the paging server appliances
running fine you know anything to worry

215
00:16:39,650 --> 00:16:40,350
about

216
00:16:40,350 --> 00:16:45,650
so you can chalk it up as a
documentation bug sure but really you

217
00:16:45,650 --> 00:16:49,370
can just take this how much paging
service because no one is ever going to

218
00:16:49,370 --> 00:16:54,060
change a password this technically on
document changing the passwords with it

219
00:16:54,060 --> 00:17:02,489
and document authentication system even
keep our path so here's a virtual

220
00:17:02,490 --> 00:17:07,140
appliance that I found a couple
undocumented account wrong in see update

221
00:17:07,140 --> 00:17:13,940
and service user so guess what to do
with those dictionary attack so what up

222
00:17:13,940 --> 00:17:22,490
and John River found it in sees a base
password is password the other one is

223
00:17:22,490 --> 00:17:26,420
cracking for quite a while probably a
week or two I never did shiny things I

224
00:17:26,420 --> 00:17:31,290
must be some random complex whatever
before this one we just got a remote on

225
00:17:31,290 --> 00:17:36,180
the system to the web interface just by
an undocumented password so now we can

226
00:17:36,180 --> 00:17:41,220
control things on this appliance by
default with an undocumented user

227
00:17:41,220 --> 00:17:46,050
because of this mistake just leaving
them on for you not either not

228
00:17:46,050 --> 00:17:51,510
restricting it to you know maybe a local
only or forgetting to change the

229
00:17:51,510 --> 00:17:56,350
password when I first boot up this is
never documented and so therefore a

230
00:17:56,350 --> 00:18:01,840
remote on in C for this one

231
00:18:01,840 --> 00:18:09,419
monitoring virtual clients so I only
tested the trial so that's the only one

232
00:18:09,420 --> 00:18:13,100
I could have available it looked as if
you get upgraded to the production so

233
00:18:13,100 --> 00:18:17,610
just copy at their ninety percent sure
that still works in the in the official

234
00:18:17,610 --> 00:18:23,879
version but only had the trial to test
on this one just FYI 26 users with a

235
00:18:23,880 --> 00:18:30,910
Shelton the system two of them are
documented das user Wandy be to STFU one

236
00:18:30,910 --> 00:18:37,880
so we find the password and now we have
a remote on IBM SmartCloud monitoring

237
00:18:37,880 --> 00:18:41,400
Google+ just by and again undocumented
account

238
00:18:41,400 --> 00:18:46,510
there's no way to change the password
you know to the documentation and again

239
00:18:46,510 --> 00:18:49,560
unless you're just paranoid
administrator the time for these things

240
00:18:49,560 --> 00:18:58,100
and you're not just want to set up to
find this out so VMware horizon mobile

241
00:18:58,100 --> 00:19:03,860
manager this platform of course fur
managing a mobile devices and there's an

242
00:19:03,860 --> 00:19:04,919
in them P

243
00:19:04,920 --> 00:19:10,460
undocumented user on this one so what do
you think happens here another password

244
00:19:10,460 --> 00:19:14,330
is actually an empty and that we get a
remote on the end where the end where

245
00:19:14,330 --> 00:19:22,850
virtual plants during thing at this
point but with this one to actually send

246
00:19:22,850 --> 00:19:27,629
us the VMware but it was end of life and
the few months ago it was becoming into

247
00:19:27,630 --> 00:19:32,130
life just recently like maybe a week or
two ago and I should update the site

248
00:19:32,130 --> 00:19:36,180
actually did they did confirm this was
vulnerable but they were going to fix it

249
00:19:36,180 --> 00:19:40,950
because it's in the life of the product
but if I found this two years ago it was

250
00:19:40,950 --> 00:19:47,060
still just as good as it would just
laugh it today tho Cisco mobility

251
00:19:47,060 --> 00:19:52,830
services engine and other interesting
virtual appliance there's two user

252
00:19:52,830 --> 00:19:57,550
account on the plant's root and Oracle
so of course root password to set by the

253
00:19:57,550 --> 00:20:02,440
administrator when you install it or
goes untouched so this is gonna be

254
00:20:02,440 --> 00:20:07,180
interesting so I tried to crack the
password here with for example John the

255
00:20:07,180 --> 00:20:13,240
Ripper and unsuccessful but they have to
set us on where it has a password has a

256
00:20:13,240 --> 00:20:19,870
shadow entry and on the system must be a
password somewhere right

257
00:20:19,870 --> 00:20:25,530
a long time but finally found the script
this is the password if you can see ya

258
00:20:25,530 --> 00:20:34,370
so it's a really huge screen rather to
the bottom left X in PDB a123 so this is

259
00:20:34,370 --> 00:20:38,770
one where I actually could not crack
password after how the shadow file cuz

260
00:20:38,770 --> 00:20:41,660
they said a complex enough to not allow
for that to happen in a reasonable

261
00:20:41,660 --> 00:20:47,260
amount of time but I still found them
setting out later on so still a remote

262
00:20:47,260 --> 00:20:52,360
on the Cisco in the Cu appliance but
this little bit further

263
00:20:52,360 --> 00:20:58,010
for now we have Oracle which has a shelf
for some reason and can log in remotely

264
00:20:58,010 --> 00:21:02,670
you know you can stop that he just
turned off and the integration file they

265
00:21:02,670 --> 00:21:06,840
chose not to do that so we'll see if we
can escalate privileges little bit more

266
00:21:06,840 --> 00:21:14,549
so if you look at the post install log
file they make sued copies of women and

267
00:21:14,549 --> 00:21:19,500
children are you guys know what those
utilities do if you view that you use

268
00:21:19,500 --> 00:21:24,710
Linux for any amount of time you don't
want to set the suid root on those on

269
00:21:24,710 --> 00:21:32,290
those binaries but they did so let's use
them to first change permissions of the

270
00:21:32,290 --> 00:21:36,350
suitors this is one way to exploit e
there's a million different ways that's

271
00:21:36,350 --> 00:21:42,490
the way I chose those probably the
easiest way to just go ahead and add

272
00:21:42,490 --> 00:21:51,049
ourselves to the suitors file so we can
just automatically upgrade to route but

273
00:21:51,049 --> 00:21:54,379
we gotta clean up after that so we make
this really really still so if you're

274
00:21:54,380 --> 00:21:58,270
actually a key systems out there this is
gonna help you clean it up yourself

275
00:21:58,270 --> 00:22:02,000
sitting at all have some files from
honoring going on for that but I'm sure

276
00:22:02,000 --> 00:22:07,190
you know how to do that anyways we got
ourselves to satisfy land however route

277
00:22:07,190 --> 00:22:13,059
so through one mistake of them having a
complex password which was on crack all

278
00:22:13,059 --> 00:22:20,299
but finding it and install file and I'm
also making a silly mistake making a sua

279
00:22:20,299 --> 00:22:26,139
true copies a challenge him on you know
we're able to ourselves this file and

280
00:22:26,140 --> 00:22:33,710
escalate to root for this one has been
up here on tribe said you never put up a

281
00:22:33,710 --> 00:22:39,520
sign this form I CloudFlare as pretty
big so lets people you know probably use

282
00:22:39,520 --> 00:22:44,370
them if they have their support by
klubfiller so they actually did a really

283
00:22:44,370 --> 00:22:48,879
good job here generating a random
credentials so the fall passwords should

284
00:22:48,880 --> 00:22:53,850
not exist and Estes Drive go through
million appliances

285
00:22:53,850 --> 00:22:57,040
there's no reason to have default
password to this is actually the right

286
00:22:57,040 --> 00:22:57,700
way to do it

287
00:22:57,700 --> 00:23:02,060
the on psyche is essentially the
password for this appliance

288
00:23:02,060 --> 00:23:07,639
so they generate upon boot generate a
random set of credentials ray security

289
00:23:07,640 --> 00:23:14,010
only one thing here they did wrong which
got them they forgot to remove the bash

290
00:23:14,010 --> 00:23:21,160
history and you see that line actors who
you are man that long alphanumeric

291
00:23:21,160 --> 00:23:26,630
string looks like they made a typo when
they were when they were escalating

292
00:23:26,630 --> 00:23:32,730
privileges earlier so take advantage of
that now this is not even the

293
00:23:32,730 --> 00:23:38,790
administrator account for the appliance
this is the I guess you would say the

294
00:23:38,790 --> 00:23:43,159
vendors administrator account for the
appliance administrator password I

295
00:23:43,160 --> 00:23:46,850
showed you earlier they'd randomly
generated is for the customer

296
00:23:46,850 --> 00:23:51,189
this particular vendor pinocchio
apparently has other accounts that are

297
00:23:51,190 --> 00:23:55,470
only accessible by the vendor another
really interesting thing in the virtual

298
00:23:55,470 --> 00:24:00,140
appliance field a lot of vendors are
making putting a council a system that

299
00:24:00,140 --> 00:24:05,700
the customers don't have access to so
now we found out their master password

300
00:24:05,700 --> 00:24:09,170
for all these virtual appliances that
they're shipping to customers and

301
00:24:09,170 --> 00:24:18,650
customers don't you know this password
so your score the normal user guess what

302
00:24:18,650 --> 00:24:22,940
pinocchio man also has to do privileges

303
00:24:22,940 --> 00:24:33,470
now we have a remote root on every
customer virtual plans W has shipped

304
00:24:33,470 --> 00:24:40,419
not good for them to get my point of
them keeping site passwords that's

305
00:24:40,419 --> 00:24:45,150
another question needs to be raised to
should vendors beekeeping static

306
00:24:45,150 --> 00:24:49,470
passwords the customers are even aware
about right into that a few times my

307
00:24:49,470 --> 00:24:56,600
research so 71 another one you may not
have heard about they are definitely

308
00:24:56,600 --> 00:24:59,350
used by a lot of people a lot of
interesting people

309
00:24:59,350 --> 00:25:07,059
Verizon Comcast HBO but they get a lot
of free TV for this but they had to do a

310
00:25:07,059 --> 00:25:12,450
solid Pat recently so I was looking at
the virtual appliance a ship found an

311
00:25:12,450 --> 00:25:18,090
undocumented account seem CDR with a
password of CDR ok so great now we have

312
00:25:18,090 --> 00:25:19,449
remote

313
00:25:19,450 --> 00:25:24,090
looking on the system and there's a sua
binary souter binary a/s look up look

314
00:25:24,090 --> 00:25:25,360
like a custom binary

315
00:25:25,360 --> 00:25:28,939
I was just playing around with it when I
usually like to do with custom on areas

316
00:25:28,940 --> 00:25:33,530
that I like to do dinner fifteen years
ago and actually work much better give

317
00:25:33,530 --> 00:25:39,370
them a gift ban on arguments a bunch of
characters guess what the nineties

318
00:25:39,370 --> 00:25:43,570
attacked worked again so there's a
buffer overflow in the first argument

319
00:25:43,570 --> 00:25:51,250
like I'm sooo binary you get the point
so we have not only a remote a

320
00:25:51,250 --> 00:25:55,760
possibility to exploit that to get
republicans swell but I did a search for

321
00:25:55,760 --> 00:26:00,970
CNC Dr user and there's actually some
release notes where they had released a

322
00:26:00,970 --> 00:26:07,350
new version that contained information
about patching but you all have been

323
00:26:07,350 --> 00:26:08,020
removed

324
00:26:08,020 --> 00:26:14,780
thankfully Google cache is everything
for better or for worse and we look at a

325
00:26:14,780 --> 00:26:21,270
cash and see that platform remove shell
access for CNC Dr user ok I just looked

326
00:26:21,270 --> 00:26:23,010
up Creek corrected an issue

327
00:26:23,010 --> 00:26:29,750
yes she did so they put their release
notes which are now removed and the

328
00:26:29,750 --> 00:26:33,200
release ever hosted our website there
was any related as far as I could see

329
00:26:33,200 --> 00:26:33,559
you

330
00:26:33,559 --> 00:26:41,940
271 and other strange things so the
latest public download for this virtual

331
00:26:41,940 --> 00:26:44,360
appliance was 536

332
00:26:44,360 --> 00:26:49,969
paralegals takes 10538 so they fixed the
bug but I don't know you have to be a

333
00:26:49,970 --> 00:26:53,770
customer I guess I i assume you get an
email if you're if you know pay for

334
00:26:53,770 --> 00:26:57,129
support this says hey we fix an
interesting thing to you should upgrade

335
00:26:57,130 --> 00:27:04,760
but everyone else downloading the public
version is just so it's not going so

336
00:27:04,760 --> 00:27:08,140
what's going to command injection

337
00:27:08,140 --> 00:27:11,890
subclass of getting remembered or remote
shell this point

338
00:27:11,890 --> 00:27:20,960
EMC recover point pretty popular virtual
plants from EMC it provides continuous

339
00:27:20,960 --> 00:27:25,490
data protection so they will protect
your data

340
00:27:25,490 --> 00:27:33,120
fuses appliances also says right so and
also unchangeable is not just a fault

341
00:27:33,120 --> 00:27:38,070
there is no way I found there may be
some crazy way to do it but there is no

342
00:27:38,070 --> 00:27:41,389
way that I found to change these
credentials they are locked into this

343
00:27:41,390 --> 00:27:45,799
virtual appliance Sox manager box
management now we can hesitations the

344
00:27:45,799 --> 00:27:49,840
management interface and we get this
cute little console interface trials

345
00:27:49,840 --> 00:27:55,600
restricted from doing anything but they
want us to do well if we look at the

346
00:27:55,600 --> 00:28:00,309
diagnostic section of this we found one
that says run internal command and that

347
00:28:00,309 --> 00:28:04,049
was pretty interesting but there's only
a certain set of internal commands we

348
00:28:04,049 --> 00:28:10,690
can run it was the only way we could run
other commands then that you guys forgot

349
00:28:10,690 --> 00:28:19,000
this is command injection right boom
manage action so if you just used as a

350
00:28:19,000 --> 00:28:23,510
change with his a valid command and give
us some shell medicare actors and fix up

351
00:28:23,510 --> 00:28:30,010
your you can break into a shell so now
we have a shell with the box management

352
00:28:30,010 --> 00:28:36,140
user undercover point see what else is
interesting so they run man run box

353
00:28:36,140 --> 00:28:40,470
management is the console interface it
just calls a job for the UIM which is in

354
00:28:40,470 --> 00:28:47,059
Comcast recover play installation jar
there's a class in that jar file looks

355
00:28:47,059 --> 00:28:51,950
pretty interesting and run internal
command we wanted to compile that and

356
00:28:51,950 --> 00:28:56,930
see what else we may build do you know
because we have access this interface

357
00:28:56,930 --> 00:29:03,980
see what else we can do with the plants
will get the code here we can see we can

358
00:29:03,980 --> 00:29:10,260
run our RPing DAII straws from Perl
script and it just puts see output and

359
00:29:10,260 --> 00:29:13,860
it takes the output it prints it to
internal command of the temp directory

360
00:29:13,860 --> 00:29:22,379
and it puts if any of the commands are
on the list if it's soon so that we can

361
00:29:22,380 --> 00:29:27,310
know that any of these commands command
execute with root privileges so if we

362
00:29:27,310 --> 00:29:36,040
can execute any of these commands root
privileges what can we do it that there

363
00:29:36,040 --> 00:29:40,450
happened to be in again we confirm our
options in in the suitors how we see

364
00:29:40,450 --> 00:29:45,270
that we can execute all these but I
found that are actually read a file I

365
00:29:45,270 --> 00:29:49,660
didn't even know that for a try this so
if we if we have certain privileges to

366
00:29:49,660 --> 00:29:53,160
risk we don't need to use the console
anymore once we broke into shale we just

367
00:29:53,160 --> 00:29:59,400
pass whatever file we want to read too
soon and it will output any child

368
00:29:59,400 --> 00:30:06,710
reading of a system on the plants so
definitely like out there is a perl

369
00:30:06,710 --> 00:30:09,970
script I could really found any
interesting bugs they're all the bad

370
00:30:09,970 --> 00:30:14,500
stuff so the coast like out on this one
I didn't actually escalate rude I guess

371
00:30:14,500 --> 00:30:22,830
but I can read any of the system as root
so there's there's a starting point for

372
00:30:22,830 --> 00:30:28,100
those will be confusion about this one
so what is the root admin password if

373
00:30:28,100 --> 00:30:32,860
there is one in the shadow file but it's
not given to customers and if you ask

374
00:30:32,860 --> 00:30:37,399
for it there's just you know for example
something else to hear how do you reset

375
00:30:37,400 --> 00:30:42,060
the admin password forgot her point and
the fix a they say is the solution

376
00:30:42,060 --> 00:30:47,780
requires assistance from EMC contact him
see you support service and it's just

377
00:30:47,780 --> 00:30:52,430
you know again the theme of the vendor
having credentials for the thing about

378
00:30:52,430 --> 00:30:58,160
our customers feel about that on them
they know about it yet but definitely a

379
00:30:58,160 --> 00:31:00,679
point for discussion

380
00:31:00,679 --> 00:31:07,730
select one SolarWinds login a manager I
want to highlight this one is like $45

381
00:31:07,730 --> 00:31:13,529
and it's a it's actually a sec I am RSI
M

382
00:31:13,529 --> 00:31:18,200
and makes easy to use lawyers for
security compliance stuff so at as the

383
00:31:18,200 --> 00:31:24,740
FARC Reds for CMC password and runs a si
server on through 2022 I think this was

384
00:31:24,740 --> 00:31:33,889
actually undocumented seem to users well
so what we're gonna sese user we have

385
00:31:33,889 --> 00:31:37,939
another command injection we use the
literally the same strain we used to

386
00:31:37,940 --> 00:31:45,549
exploit the EMC EMC bug for this one we
drop into a shell so manager configures

387
00:31:45,549 --> 00:31:53,480
the main interface for this month and
pearl so continued control cause a bunch

388
00:31:53,480 --> 00:31:58,809
of shell scripts to implement commands
contigo control is a course ridable by

389
00:31:58,809 --> 00:32:04,999
contigo user the weirdest logged in ass
and it calls it's allowed to call and

390
00:32:04,999 --> 00:32:13,990
the script as root that's not the best
idea so if we had something useful to to

391
00:32:13,990 --> 00:32:20,019
continue to patrol like I don't know
give us a shelf for free no password if

392
00:32:20,019 --> 00:32:25,629
we just do that then we can just
upgraded for free so that is very very

393
00:32:25,629 --> 00:32:29,658
straightforward command injection that
we used to first break out of the shell

394
00:32:29,659 --> 00:32:35,649
and then go to and at ourselves be a
local vulnerability to escalate to root

395
00:32:35,649 --> 00:32:42,508
and there's one more bug in this point
as well as for mastering bug unless we

396
00:32:42,509 --> 00:32:46,860
have any old timers out there for these
bugs but they were super interesting

397
00:32:46,860 --> 00:32:50,479
they're still around a little bit I
found them from time to time but again

398
00:32:50,480 --> 00:32:56,049
the interfaces and pearl so if you know
if you get a present P percent and

399
00:32:56,049 --> 00:33:00,639
whatever accepts and then there's a
former stream but they're actually some

400
00:33:00,639 --> 00:33:04,998
exploitable for mastering bugs and pearl
is a really interesting paper back in

401
00:33:04,999 --> 00:33:09,680
2005 you look at that there's actually
maybe next went out for that as well

402
00:33:09,680 --> 00:33:13,730
but sorry I'm a pretty big fan of for
measuring vulnerabilities and I keep

403
00:33:13,730 --> 00:33:21,760
hearing their dad but keep finding them
so that's it was fun sort of thing this

404
00:33:21,760 --> 00:33:25,240
was about three password people asking
about it they're like yeah you can call

405
00:33:25,240 --> 00:33:28,800
support and we can use the root account
to get in and reset the password for you

406
00:33:28,800 --> 00:33:33,260
like I don't want you to do that if
everybody's appliance a lot of confusion

407
00:33:33,260 --> 00:33:41,020
on that issue so a person crazy sued by
Mariano we actually did a bunch of

408
00:33:41,020 --> 00:33:47,270
options those before us talk about one
end time Cisco Prime infrastructure so

409
00:33:47,270 --> 00:33:53,110
if you have a Linux box at home you know
that if you take a log of all the suid

410
00:33:53,110 --> 00:33:57,879
files there should be no where near 67
that's way too much right there is

411
00:33:57,880 --> 00:34:05,290
usually 20 2567 you know there's gonna
be some problems here so if you just

412
00:34:05,290 --> 00:34:10,710
grab the files in the file for Shell the
word shall we have some interesting ones

413
00:34:10,710 --> 00:34:19,420
one run shell command one run shell as
root what do you think they do either be

414
00:34:19,420 --> 00:34:26,730
helpful to us right now so they're so
poorly written actually Rancho command

415
00:34:26,730 --> 00:34:32,250
if you don't give it an argument it
crashes on all points so they didn't

416
00:34:32,250 --> 00:34:37,510
check if an argument is given so you
know the quality of the code more about

417
00:34:37,510 --> 00:34:41,530
share I just cannot believe that in
check for an argument this like you

418
00:34:41,530 --> 00:34:47,730
wrote this in 30 seconds or so the
saying it was aliens the certainly could

419
00:34:47,730 --> 00:34:52,650
have been so the way it works here

420
00:34:52,650 --> 00:34:57,040
Ranchos route you put whatever command
you want a file that you pass that found

421
00:34:57,040 --> 00:35:00,870
two and it runs in has hurt ouch

422
00:35:00,870 --> 00:35:07,120
show command well even easier you just
past the command to it and it runs as

423
00:35:07,120 --> 00:35:13,170
root for him so these are a local
binaries that are fluid that are

424
00:35:13,170 --> 00:35:21,040
executable by anyone on the system and
trivial to get you know provides

425
00:35:21,040 --> 00:35:23,750
escalation from here I gotta give them
credit they really stepped up security

426
00:35:23,750 --> 00:35:31,840
and he soon and routed the user and
binary and they made it only executable

427
00:35:31,840 --> 00:35:39,000
to route that doesn't make any sense
whatsoever why would you sue drew two

428
00:35:39,000 --> 00:35:45,020
and only let route executor watches
leave it alone but I guess we can use

429
00:35:45,020 --> 00:35:50,290
that to do anything right now we have
run shell command so we can just had a

430
00:35:50,290 --> 00:35:52,920
route to user with everything we need

431
00:35:52,920 --> 00:36:00,400
old-school style as you like it and then
we ever now we have crazy sued binaries

432
00:36:00,400 --> 00:36:04,850
plus a remote going on so we have a lot
of Cisco virtual appliances that was

433
00:36:04,850 --> 00:36:11,370
Cisco Prime infrastructure this is cisco
prime collaboration insurance there's

434
00:36:11,370 --> 00:36:16,490
many many more are all trying to confuse
you as much as possible to cancel the

435
00:36:16,490 --> 00:36:22,200
system quickly there's a corner case
with the setup is not likely for double

436
00:36:22,200 --> 00:36:28,299
but it's a it's a know where the case
study so quickly the interesting part

437
00:36:28,300 --> 00:36:32,500
here I wanna get to is with the job of
the bug server because I've ever used it

438
00:36:32,500 --> 00:36:34,830
but there's an interesting to a banner
here

439
00:36:34,830 --> 00:36:41,980
firewall just what it as controls the
firewall so they're running Java bug

440
00:36:41,980 --> 00:36:48,380
server as a rename process called p.m.
Sam person on engine and it's listening

441
00:36:48,380 --> 00:36:52,590
on the network interface but the finals
turned on and they did a really good

442
00:36:52,590 --> 00:36:57,290
security thing by making sure that no
one can access from the firewall

443
00:36:57,290 --> 00:37:01,890
although they can just as easily made it
listen on localhost nine had to worry

444
00:37:01,890 --> 00:37:03,940
about that I digress

445
00:37:03,940 --> 00:37:09,260
so that's Javed the bug server and I'll
active-duty a really cool research on

446
00:37:09,260 --> 00:37:10,260
this

447
00:37:10,260 --> 00:37:17,490
they did a little bug wire protocol
basically any has a TLDR says turn any

448
00:37:17,490 --> 00:37:24,919
open javadoc server into reliable remote
code execution so let's see how that

449
00:37:24,920 --> 00:37:30,780
works but one thing we have to access we
want and we can do it locally but we

450
00:37:30,780 --> 00:37:36,000
want a remote at this point so we just
turned off because it suited and we have

451
00:37:36,000 --> 00:37:40,440
privileges to do that so just turning
off now we can access this remote so

452
00:37:40,440 --> 00:37:45,920
this exploit I like the road I just used
in and I just told it and i actually to

453
00:37:45,920 --> 00:37:49,970
make it easier but Nick had on the
system whatever you can just make it

454
00:37:49,970 --> 00:37:56,919
easy as possible to exploit and now we
have a remote root on the system through

455
00:37:56,920 --> 00:38:01,460
job at about Trevor so anytime you see
job at about server running especially

456
00:38:01,460 --> 00:38:06,270
remotely so its local you get a local
route it is running remotely anytime

457
00:38:06,270 --> 00:38:11,360
easy job at about sure it's literally I
think it design fall and the server this

458
00:38:11,360 --> 00:38:15,460
actually still works today and I think
it's a year to old there I don't think

459
00:38:15,460 --> 00:38:20,100
there's any patch they literally have to
redesign it or just don't read it so

460
00:38:20,100 --> 00:38:26,170
very important if you're doing a pen
tester that you only live once

461
00:38:26,170 --> 00:38:33,680
so probably tired of hearing about
remote roots right those are so many of

462
00:38:33,680 --> 00:38:41,690
them so I'm going to conclude with a few
things people out there wanting some

463
00:38:41,690 --> 00:38:46,040
defensive stuff don't run away yet
because I'm talking about that

464
00:38:46,040 --> 00:38:51,830
the first indication so scared many
offend very policy this is actually

465
00:38:51,830 --> 00:38:59,240
Facebook's first responsible responsible
disclosure policy and they say they

466
00:38:59,240 --> 00:39:04,580
won't sue you if you make a good effort
and work with them how much things have

467
00:39:04,580 --> 00:39:09,299
changed by now but this was a few years
ago so brief disclosure timelines the

468
00:39:09,300 --> 00:39:14,470
sorrel and SolarWinds bug they took a
while to see me there PGP key and I

469
00:39:14,470 --> 00:39:17,859
don't know if they had to generate it or
they just forgot where it was I don't

470
00:39:17,860 --> 00:39:21,370
know what happened but they fixed in a
few months but it was just the first

471
00:39:21,370 --> 00:39:27,190
response was like will get you the PDP
soon and why is that just an email like

472
00:39:27,190 --> 00:39:32,970
you just send it to me through email and
then see the extent almost over a month

473
00:39:32,970 --> 00:39:36,890
which is really nice and then the guy
was work within see you left and now

474
00:39:36,890 --> 00:39:41,640
probably never gonna bug fixed again
that's great but noted they passed a

475
00:39:41,640 --> 00:39:46,720
potential security vulnerability sure
Cisco with a problem for sure it

476
00:39:46,720 --> 00:39:51,419
released a proud advisor yet the log in
to see is not searchable best way to do

477
00:39:51,420 --> 00:39:51,730
it

478
00:39:51,730 --> 00:39:59,090
VMware as I said send the ball so
initially discloses back in September

479
00:39:59,090 --> 00:40:04,430
and they they said they contact me a
couple days before disclosing said hey

480
00:40:04,430 --> 00:40:10,000
can you tell us anything and what i mean
if you don't contact me about it sure I

481
00:40:10,000 --> 00:40:13,820
give you full details and decided not to
fix its reasonable cause a lot of

482
00:40:13,820 --> 00:40:19,240
product SolarWinds a sixty-two September
Cisco fixed it a couple weeks ago old

483
00:40:19,240 --> 00:40:25,680
and in situ Vrba they released in July
if you didn't see it up there it's maybe

484
00:40:25,680 --> 00:40:31,700
not fixed so playing defense clean up
before you ship it i mean you guess all

485
00:40:31,700 --> 00:40:35,299
the past history where you know you're
able to get a remote root just buy a

486
00:40:35,300 --> 00:40:36,160
typo

487
00:40:36,160 --> 00:40:37,980
don't ship

488
00:40:37,980 --> 00:40:42,869
bash history to customers that's
nonsense all the crazy sued by various

489
00:40:42,869 --> 00:40:48,460
on boxers don't assume that nobody can
get a shell but nobody can you know do

490
00:40:48,460 --> 00:40:55,470
anything a local system so don't put you
know jimmy is on the box and then pat

491
00:40:55,470 --> 00:41:01,029
passwords and then customers just blows
my mind don't know if that's the new way

492
00:41:01,030 --> 00:41:07,220
of thinking or the or not as just a
strange far along is definitely good

493
00:41:07,220 --> 00:41:12,500
practice here but don't you know don't
let me turn off firewall course and like

494
00:41:12,500 --> 00:41:16,880
I said before generating random
passwords on boot there should never be

495
00:41:16,880 --> 00:41:21,000
another divall password like literally
it's unnecessary you're just asking for

496
00:41:21,000 --> 00:41:25,960
trouble using default passwords when you
pervert appliances set a random password

497
00:41:25,960 --> 00:41:30,090
on boot and be done with it you never
have to ask him to do anything they have

498
00:41:30,090 --> 00:41:33,460
the password on the local system if
they're looking at the local system you

499
00:41:33,460 --> 00:41:40,920
probably already figured so one
interesting thing I saw that the Cisco

500
00:41:40,920 --> 00:41:45,420
Prime collaboration deployment different
from the ones I promise they actually

501
00:41:45,420 --> 00:41:49,840
blacklisted users for remote access this
is an interesting medication because I

502
00:41:49,840 --> 00:41:54,230
thought at first I had a remote on this
virtual plants I thought I had

503
00:41:54,230 --> 00:42:00,200
informants Informix done undocumented
have a remote and I tried to log in

504
00:42:00,200 --> 00:42:03,819
remotely on my clock in a log in
remotely why can't I login anywhere but

505
00:42:03,820 --> 00:42:08,400
the local system but cause they
mitigated this problem somebody probably

506
00:42:08,400 --> 00:42:11,980
saw land thanks well this guy doesn't
need to log in remotely so let's just

507
00:42:11,980 --> 00:42:17,630
you know the dot the nihilist on the
acetate server very good medication is

508
00:42:17,630 --> 00:42:21,150
practically useless now even if there is
a default password because I can't log

509
00:42:21,150 --> 00:42:27,910
in remotely tremendous here this is very
specific but no makes trials and demos

510
00:42:27,910 --> 00:42:34,509
and this is super confusing and not only
for two rooms in my bugs which would

511
00:42:34,510 --> 00:42:37,890
really affect me must be just for the
development team in general they're

512
00:42:37,890 --> 00:42:41,080
gonna be like how the saddam oh so we
don't need to bring security and then

513
00:42:41,080 --> 00:42:43,970
the guy should be like oh no we're ready
to ship its actually a trial and then

514
00:42:43,970 --> 00:42:46,740
that we've heard a lot about assumptions

515
00:42:46,740 --> 00:42:51,220
don't ship the master development vnds
earlier shipping back

516
00:42:51,220 --> 00:42:56,230
history shipping all these other files
and then there should be a development

517
00:42:56,230 --> 00:43:00,690
team and a clean copy that you build
from that and I know of her true vendors

518
00:43:00,690 --> 00:43:04,480
all we do all that stuff sack ok why do
you have these bugs and while they exist

519
00:43:04,480 --> 00:43:10,090
obviously not doing it we're not doing
it for all the places and a listed

520
00:43:10,090 --> 00:43:14,410
checklist of must not have this was
something that every every development

521
00:43:14,410 --> 00:43:17,899
teams should have been there sipping a
product for these appliances

522
00:43:17,900 --> 00:43:24,530
you know i i listed a bunch a bunch of
things and I lost a bunch more bizarre

523
00:43:24,530 --> 00:43:29,599
things again for developers don't do
this when shipp the device or mister bug

524
00:43:29,599 --> 00:43:34,330
hunters to look for when they're testing
virtual Pontus whatever side you're on

525
00:43:34,330 --> 00:43:39,830
you can use this sort of all passwords
of course undocumented if they're

526
00:43:39,830 --> 00:43:46,920
undocumented Documentum its own system
removed them simple files obviously an

527
00:43:46,920 --> 00:43:51,420
encrypted passwords or unsalted
passwords I should say on this sensitive

528
00:43:51,420 --> 00:43:57,450
data all the Seward world writable
scripts it was in seeing that undergo a

529
00:43:57,450 --> 00:44:02,529
world writable script able to get
roofing that some of the services if

530
00:44:02,530 --> 00:44:06,260
they're meant to be local make them
listen on the local interface don't

531
00:44:06,260 --> 00:44:11,710
listen on a network interface again very
unnecessary and then using a different

532
00:44:11,710 --> 00:44:17,109
education systems as a kind of a photo
one off example but I could see that

533
00:44:17,109 --> 00:44:21,170
happening in the future actually it was
a pretty interesting blog and

534
00:44:21,170 --> 00:44:24,470
assumptions again it all comes down to
substance in the in the space

535
00:44:24,470 --> 00:44:29,569
don't assume it's not for production if
your shipping us don't say I can just

536
00:44:29,570 --> 00:44:35,390
hide this private key in a file like
Cisco did a while back and got all their

537
00:44:35,390 --> 00:44:40,319
virtual appliances compromise you know
don't only assume administrators can

538
00:44:40,320 --> 00:44:44,810
execute this script because somebody
gonna come on late come later on and say

539
00:44:44,810 --> 00:44:48,980
hi here's a new feature real change the
way this works maybe nine thats company

540
00:44:48,980 --> 00:44:54,160
more you know I'm looking at this is a
very I guess as a software company view

541
00:44:54,160 --> 00:44:56,598
where a lot of things i've seen

542
00:44:56,599 --> 00:45:00,059
you know people leave the comeback and
then bugs

543
00:45:00,059 --> 00:45:05,289
happened because of simpson's being made
and then again with coach R and updates

544
00:45:05,289 --> 00:45:11,759
a lot of things can change that don't
make any assumptions and then a

545
00:45:11,759 --> 00:45:14,819
satirical cheer there's a lot of help
her if your gonna go look at these

546
00:45:14,819 --> 00:45:18,959
device appliances I haven't broke the
mall I don't think I want access to all

547
00:45:18,959 --> 00:45:24,169
them now saying I could I would but
again if you look at these think about

548
00:45:24,170 --> 00:45:29,749
how her services all the helpers all the
things that maybe the external facing

549
00:45:29,749 --> 00:45:35,169
server is talking to an internal service
or those go unchecked support services

550
00:45:35,170 --> 00:45:39,789
remote access are always juicy fertile
ground for bugs they have a lot of

551
00:45:39,789 --> 00:45:43,699
backup restore directory so you can lick
and those for installation files to

552
00:45:43,699 --> 00:45:47,719
maybe see how they're doing something
how they're setting a password and then

553
00:45:47,719 --> 00:45:51,380
really read the documentation coast it
can be the difference between a bug and

554
00:45:51,380 --> 00:45:59,039
technically a future forensics oh my god
if I had $1,000,000 I would about

555
00:45:59,039 --> 00:46:03,689
forensic suite provide two million
dollars or three if I hadn't had a likes

556
00:46:03,689 --> 00:46:10,149
money I would obviously and just own a
ton of these hurt appliances because we

557
00:46:10,150 --> 00:46:15,099
deleted all sensitive files yeah you can
just help translate works right under

558
00:46:15,099 --> 00:46:21,019
leave things and that would be pretty
pretty big game-changer I think so I

559
00:46:21,019 --> 00:46:25,988
came into force Cisco got this huge bug
they ship some private keys on a on a

560
00:46:25,989 --> 00:46:29,979
bus their virtual appliances so anyone
who had access to could just get lucky

561
00:46:29,979 --> 00:46:39,140
and get remote root on all their stuff
pretty big deal so in conclusion as

562
00:46:39,140 --> 00:46:39,779
always

563
00:46:39,779 --> 00:46:44,549
area still unexplored there's a lot of
stuff I didn't have access to a lot of

564
00:46:44,549 --> 00:46:50,279
stuff is really expensive stuff they
don't offer 229 company in a diesel ever

565
00:46:50,279 --> 00:46:55,670
at the moment and I'm going to become
more prevalent like I said things are

566
00:46:55,670 --> 00:46:59,749
moving in a way where physical
appliances once we have you know the

567
00:46:59,749 --> 00:47:03,859
data centers are getting more more more
advanced more more processing power this

568
00:47:03,859 --> 00:47:07,449
baseball that they're going to be able
to even if you have a really high

569
00:47:07,449 --> 00:47:11,549
performing device will be able to make
it into bits and especially

570
00:47:11,549 --> 00:47:12,690
hypervisor

571
00:47:12,690 --> 00:47:17,140
and the cloud from where something like
that and there's a lot more work to do

572
00:47:17,140 --> 00:47:20,569
it like I said getting access to these
and then getting the vendors to properly

573
00:47:20,569 --> 00:47:27,839
fix some bugs is always an issue as well
so interesting area to get into and let

574
00:47:27,839 --> 00:47:35,720
me know if you have any questions that's
five minutes or so this guy I was told

575
00:47:35,720 --> 00:47:41,520
will throw a box at you and it won't
hurt 00 you that was close

576
00:47:41,520 --> 00:47:49,210
could you please go back to the slide
before must not house must not have yes

577
00:47:49,210 --> 00:48:01,280
the format is like unto corrections
Canada suggestion from the printed out

578
00:48:01,280 --> 00:48:07,569
and send out to average development team
ever brought against this world because

579
00:48:07,569 --> 00:48:13,619
it's not mutual clients is about basic
security for every software production

580
00:48:13,619 --> 00:48:20,490
no matter I'm glad I made a slide that
will stand the test of time

581
00:48:20,490 --> 00:48:26,149
Thank You Think and yes I would try to
get that too if you give me a list of

582
00:48:26,150 --> 00:48:34,230
companies Paulino to them I really will
I really well thank you should have any

583
00:48:34,230 --> 00:48:42,630
other questions I can go back and forth
probably on science got like three have

584
00:48:42,630 --> 00:48:46,460
you used any special software to scan
about

585
00:48:46,460 --> 00:48:50,700
example of the files with them correct
permissions or cause we have like UNIX

586
00:48:50,700 --> 00:48:52,560
previous checker

587
00:48:52,560 --> 00:48:58,500
have also witnessed robust check around
so there's things yes so understanding

588
00:48:58,500 --> 00:49:02,170
correctly I really need tools to to
automate a lot of these you know the

589
00:49:02,170 --> 00:49:05,890
most I had looking for aidid about
permissions are things like that I

590
00:49:05,890 --> 00:49:09,220
haven't come up with the toolset for
literally came up with these slides

591
00:49:09,220 --> 00:49:13,950
recently for the must not have I
actually thought a couple times about

592
00:49:13,950 --> 00:49:18,189
riding some tools for a bit I don't know
I got to a point where

593
00:49:18,190 --> 00:49:21,290
I was kind of you know I have certain
projects I was kind of done with this

594
00:49:21,290 --> 00:49:24,960
one and I didn't want to spend a lot
more time writing tools for it so I just

595
00:49:24,960 --> 00:49:30,680
wanted to come up with a list but not
hard to do hard to do you have if you

596
00:49:30,680 --> 00:49:33,549
have an automated framework and one
vendor was telling me that they were

597
00:49:33,550 --> 00:49:36,910
going to take like the must not have
stuff and kind of put into their own

598
00:49:36,910 --> 00:49:41,950
toolset they have checks for so maybe in
a way I kind of assumed that there is

599
00:49:41,950 --> 00:49:45,399
some framework that it may be a lot of
software vendors are you have to do

600
00:49:45,400 --> 00:49:49,860
certain checks and you know take those
roles and kind of put them in there like

601
00:49:49,860 --> 00:49:54,070
that but no I don't have any tool set to
do that but you totally is totally

602
00:49:54,070 --> 00:50:01,900
possible to do that thank you thank you
any more questions

603
00:50:01,900 --> 00:50:15,350
questions once more of a complement to
appreciate the company more question

604
00:50:15,350 --> 00:50:23,830
everybody understood everything really
well I hope I wrote it was right the

605
00:50:23,830 --> 00:50:27,020
slide those like I have to make this
simple enough for everyone understand

606
00:50:27,020 --> 00:50:39,050
but also stay awake most of you still
same way if there's no more questions

607
00:50:39,050 --> 00:50:42,440
come back and see me six o'clock and
other track they also say for this guy

608
00:50:42,440 --> 00:50:44,320
and thank you very much

