1
00:00:01,230 --> 00:00:05,430
[Music]

2
00:00:07,880 --> 00:00:14,549
as we all know<font color="#E5E5E5"> until</font><font color="#CCCCCC"> relay is an agent</font>

3
00:00:11,700 --> 00:00:17,698
exploit method<font color="#E5E5E5"> it now has many</font>

4
00:00:14,549 --> 00:00:20,820
restrictions<font color="#E5E5E5"> and it needs to be</font><font color="#CCCCCC"> reloaded</font>

5
00:00:17,699 --> 00:00:26,490
we will talk about some tricks to make

6
00:00:20,820 --> 00:00:30,119
<font color="#CCCCCC">NTM really quit again and I'm doing it</font>

7
00:00:26,490 --> 00:00:32,910
this is my Twitter md5<font color="#E5E5E5"> shot and</font><font color="#CCCCCC"> fro</font>

8
00:00:30,119 --> 00:00:36,809
whoops<font color="#E5E5E5"> and is</font><font color="#CCCCCC"> zero you</font><font color="#E5E5E5"> see D of T and</font>

9
00:00:32,910 --> 00:00:40,949
I'm<font color="#CCCCCC"> to year winner of Sigma which is</font><font color="#E5E5E5"> a</font>

10
00:00:36,809 --> 00:00:43,980
<font color="#CCCCCC">punning contest in China and here is my</font>

11
00:00:40,950 --> 00:00:51,629
<font color="#CCCCCC">chin ha you</font><font color="#E5E5E5"> can find some useful tools</font>

12
00:00:43,980 --> 00:00:55,468
here and this is<font color="#E5E5E5"> my meat I'm Johnny this</font>

13
00:00:51,629 --> 00:00:59,218
<font color="#CCCCCC">is a</font><font color="#E5E5E5"> mate with</font><font color="#CCCCCC"> her I'm from the cycle</font>

14
00:00:55,469 --> 00:01:03,210
our security team<font color="#E5E5E5"> this is my blog</font><font color="#CCCCCC"> I have</font>

15
00:00:59,219 --> 00:01:07,950
<font color="#CCCCCC">I have read some</font><font color="#E5E5E5"> pentester article</font><font color="#CCCCCC"> um</font>

16
00:01:03,210 --> 00:01:11,250
days and we<font color="#E5E5E5"> are both from</font><font color="#CCCCCC"> Tencent</font>

17
00:01:07,950 --> 00:01:15,030
security<font color="#CCCCCC"> lab we are we have a security</font>

18
00:01:11,250 --> 00:01:19,200
researcher and the pen tester<font color="#CCCCCC"> ok let's</font>

19
00:01:15,030 --> 00:01:21,930
come to the topic<font color="#E5E5E5"> today we all talk</font>

20
00:01:19,200 --> 00:01:25,950
about<font color="#CCCCCC"> aunty ami relay</font><font color="#E5E5E5"> first we all show</font>

21
00:01:21,930 --> 00:01:28,860
some<font color="#CCCCCC"> antium relay basics and some no</font>

22
00:01:25,950 --> 00:01:32,040
<font color="#E5E5E5">entire melee attack next</font>

23
00:01:28,860 --> 00:01:35,850
we also audio findings<font color="#CCCCCC"> a new way to send</font>

24
00:01:32,040 --> 00:01:38,850
credentials in browser and a way to

25
00:01:35,850 --> 00:01:41,339
<font color="#E5E5E5">bring attend be reflection attack back</font>

26
00:01:38,850 --> 00:01:43,679
<font color="#E5E5E5">to life and finally</font><font color="#CCCCCC"> we will talk about</font>

27
00:01:41,340 --> 00:01:48,479
how<font color="#E5E5E5"> to defend against</font><font color="#CCCCCC"> in here melee</font>

28
00:01:43,680 --> 00:01:54,630
attacks<font color="#E5E5E5"> ok let's start with entirely</font>

29
00:01:48,479 --> 00:01:57,180
basics so what is India<font color="#E5E5E5"> when ntlm</font><font color="#CCCCCC"> and</font>

30
00:01:54,630 --> 00:02:02,189
the arm is a protocol for<font color="#E5E5E5"> authentication</font>

31
00:01:57,180 --> 00:02:04,740
integrity and confidentiality<font color="#CCCCCC"> and it is</font>

32
00:02:02,189 --> 00:02:09,119
a challenge<font color="#CCCCCC"> response authentication</font>

33
00:02:04,740 --> 00:02:12,299
protocol<font color="#E5E5E5"> it has three types message type</font>

34
00:02:09,119 --> 00:02:13,400
of a message<font color="#E5E5E5"> for negotiation have</font><font color="#CCCCCC"> two</font>

35
00:02:12,300 --> 00:02:17,420
<font color="#E5E5E5">message for</font>

36
00:02:13,400 --> 00:02:20,580
<font color="#CCCCCC">top-3 message for authentication and</font>

37
00:02:17,420 --> 00:02:24,989
<font color="#E5E5E5">there is an interface in Microsoft</font>

38
00:02:20,580 --> 00:02:28,710
Windows called<font color="#E5E5E5"> Microsoft security</font>

39
00:02:24,990 --> 00:02:31,620
support provider and<font color="#CCCCCC"> trm implements this</font>

40
00:02:28,710 --> 00:02:37,710
interface which is<font color="#CCCCCC"> which is called</font>

41
00:02:31,620 --> 00:02:41,550
<font color="#CCCCCC">ntlmssp ok let's move to the three tabs</font>

42
00:02:37,710 --> 00:02:45,770
message<font color="#E5E5E5"> and here is the type</font><font color="#CCCCCC"> of I</font>

43
00:02:41,550 --> 00:02:48,900
<font color="#E5E5E5">message negotiation the client since is</font>

44
00:02:45,770 --> 00:02:54,060
information to the server<font color="#E5E5E5"> and</font><font color="#CCCCCC"> asked for</font>

45
00:02:48,900 --> 00:03:00,380
<font color="#CCCCCC">login</font><font color="#E5E5E5"> and the server will</font><font color="#CCCCCC"> responds with</font>

46
00:02:54,060 --> 00:03:07,710
the<font color="#E5E5E5"> challenge it asked the client to</font>

47
00:03:00,380 --> 00:03:09,720
prove he has<font color="#CCCCCC"> the real</font><font color="#E5E5E5"> password and here</font>

48
00:03:07,710 --> 00:03:13,800
comes the type<font color="#CCCCCC"> through message the</font>

49
00:03:09,720 --> 00:03:16,050
client does some calculations with<font color="#E5E5E5"> his</font>

50
00:03:13,800 --> 00:03:19,770
password and the Challenger he received

51
00:03:16,050 --> 00:03:24,210
and then send the challenge response<font color="#E5E5E5"> to</font>

52
00:03:19,770 --> 00:03:27,960
the server this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> three steps of</font>

53
00:03:24,210 --> 00:03:30,300
<font color="#E5E5E5">authentication so there is many</font>

54
00:03:27,960 --> 00:03:35,160
protocols<font color="#E5E5E5"> using</font><font color="#CCCCCC"> ntr methyl-p</font>

55
00:03:30,300 --> 00:03:39,540
such as SMB HTTP LD<font color="#CCCCCC"> AP or microsoft</font>

56
00:03:35,160 --> 00:03:42,299
secure server<font color="#E5E5E5"> so before he comes to</font>

57
00:03:39,540 --> 00:03:44,220
auntie em<font color="#E5E5E5"> relay attacks that's how the</font>

58
00:03:42,300 --> 00:03:50,640
<font color="#E5E5E5">last talk about windows name resolution</font>

59
00:03:44,220 --> 00:03:56,430
first windows will resolve a domain<font color="#CCCCCC"> name</font>

60
00:03:50,640 --> 00:03:59,160
in the<font color="#E5E5E5"> following order first it will see</font>

61
00:03:56,430 --> 00:04:06,510
the whether the domain is in the<font color="#E5E5E5"> host</font>

62
00:03:59,160 --> 00:04:09,780
file and next we are search from the DNS

63
00:04:06,510 --> 00:04:13,470
server<font color="#E5E5E5"> and next from the local um whose</font>

64
00:04:09,780 --> 00:04:15,200
file<font color="#CCCCCC"> if all means we are used the</font>

65
00:04:13,470 --> 00:04:19,970
<font color="#CCCCCC">following two protocols</font>

66
00:04:15,200 --> 00:04:25,590
<font color="#E5E5E5">admin</font><font color="#CCCCCC"> are and mb</font><font color="#E5E5E5"> an S to resolve a name</font>

67
00:04:19,970 --> 00:04:27,240
<font color="#E5E5E5">so our R is called is link-local</font>

68
00:04:25,590 --> 00:04:31,940
multicast<font color="#CCCCCC"> me</font>

69
00:04:27,240 --> 00:04:35,910
resolution<font color="#E5E5E5"> it is a UDP protocol and</font>

70
00:04:31,940 --> 00:04:39,479
ambien<font color="#CCCCCC"> s is net vows</font><font color="#E5E5E5"> name services it</font>

71
00:04:35,910 --> 00:04:43,229
typically<font color="#E5E5E5"> a UDP protocol</font><font color="#CCCCCC"> - and it is a</font>

72
00:04:39,479 --> 00:04:46,229
broadcast protocol<font color="#CCCCCC"> there's an</font>

73
00:04:43,229 --> 00:04:51,630
<font color="#CCCCCC">interesting feature that</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> source and</font>

74
00:04:46,229 --> 00:04:54,210
test<font color="#E5E5E5"> port are both</font><font color="#CCCCCC"> one-three-seven from</font>

75
00:04:51,630 --> 00:04:55,849
<font color="#E5E5E5">the packet we can see the</font><font color="#CCCCCC"> source port</font>

76
00:04:54,210 --> 00:04:59,969
and<font color="#E5E5E5"> the</font><font color="#CCCCCC"> desperate</font>

77
00:04:55,849 --> 00:05:04,770
there is a famous exploit called pet

78
00:04:59,970 --> 00:05:08,610
tunnel which<font color="#CCCCCC"> used this feature and these</font>

79
00:05:04,770 --> 00:05:12,560
two protocols<font color="#E5E5E5"> can be easily spoofed we</font>

80
00:05:08,610 --> 00:05:17,490
can use this<font color="#E5E5E5"> tour responder to spoof the</font>

81
00:05:12,560 --> 00:05:20,909
<font color="#E5E5E5">name resolution so if that the attacker</font>

82
00:05:17,490 --> 00:05:26,340
used this tool the attacker can be any

83
00:05:20,909 --> 00:05:29,370
host<font color="#E5E5E5"> and there is a special host called</font>

84
00:05:26,340 --> 00:05:36,060
<font color="#CCCCCC">wpad</font><font color="#E5E5E5"> which means web proxy</font>

85
00:05:29,370 --> 00:05:41,270
auto-discovery protocol and if the user

86
00:05:36,060 --> 00:05:46,710
<font color="#E5E5E5">used automatically detect proxy settings</font>

87
00:05:41,270 --> 00:05:49,940
which is set by<font color="#CCCCCC"> default in widows well</font>

88
00:05:46,710 --> 00:05:53,960
it'll<font color="#E5E5E5"> accept our website in the first</font>

89
00:05:49,940 --> 00:05:58,500
come<font color="#CCCCCC"> to this URL</font><font color="#E5E5E5"> to get the</font><font color="#CCCCCC"> pse file</font>

90
00:05:53,960 --> 00:06:01,609
which contains the proxy<font color="#E5E5E5"> rows so if the</font>

91
00:05:58,500 --> 00:06:06,150
attacker<font color="#E5E5E5"> hijack wpad</font>

92
00:06:01,610 --> 00:06:07,650
the attacker can be the proxy server<font color="#E5E5E5"> the</font>

93
00:06:06,150 --> 00:06:11,190
attacker can perform some

94
00:06:07,650 --> 00:06:15,239
man-in-the-middle attacks<font color="#E5E5E5"> so when the</font>

95
00:06:11,190 --> 00:06:18,780
client or the<font color="#E5E5E5"> victim access some HTTP</font>

96
00:06:15,240 --> 00:06:26,130
site the attacker can insert any HTML

97
00:06:18,780 --> 00:06:32,940
<font color="#E5E5E5">tags in a dtdp response</font><font color="#CCCCCC"> ok let's say a</font>

98
00:06:26,130 --> 00:06:36,139
typical<font color="#E5E5E5"> ntlm really attack first the</font>

99
00:06:32,940 --> 00:06:40,320
attacker wants to<font color="#CCCCCC"> login to the</font><font color="#E5E5E5"> server as</font>

100
00:06:36,139 --> 00:06:41,249
victim but unfortunately the attacker

101
00:06:40,320 --> 00:06:45,089
<font color="#E5E5E5">doesn't</font>

102
00:06:41,249 --> 00:06:51,169
no the<font color="#E5E5E5"> victims password so the</font><font color="#CCCCCC"> server</font>

103
00:06:45,089 --> 00:06:55,559
denies<font color="#E5E5E5"> the login for attacker and the</font>

104
00:06:51,169 --> 00:07:01,469
<font color="#E5E5E5">the attacker</font><font color="#CCCCCC"> waited until</font><font color="#E5E5E5"> the week team</font>

105
00:06:55,559 --> 00:07:05,819
want to access exam ho calm and the

106
00:07:01,469 --> 00:07:08,779
victim should check<font color="#CCCCCC"> dari PD first the</font>

107
00:07:05,819 --> 00:07:12,209
way the<font color="#E5E5E5"> week team asks who is</font><font color="#CCCCCC"> dar PD and</font>

108
00:07:08,779 --> 00:07:14,909
the<font color="#E5E5E5"> attacker answers yeah I'm the</font><font color="#CCCCCC"> Guru</font>

109
00:07:12,209 --> 00:07:18,599
<font color="#CCCCCC">PID you can get a</font><font color="#E5E5E5"> PhD</font><font color="#CCCCCC"> found for me and</font>

110
00:07:14,909 --> 00:07:22,860
in the<font color="#E5E5E5"> PC file it says the attacker is</font>

111
00:07:18,599 --> 00:07:26,819
also the proxy server so the<font color="#E5E5E5"> victim</font>

112
00:07:22,860 --> 00:07:30,049
believes<font color="#E5E5E5"> that the attacker is the proxy</font>

113
00:07:26,819 --> 00:07:37,139
server<font color="#E5E5E5"> and</font><font color="#CCCCCC"> asked for</font><font color="#E5E5E5"> the response</font><font color="#CCCCCC"> Oh</font>

114
00:07:30,049 --> 00:07:42,058
exam<font color="#CCCCCC"> or calm</font><font color="#E5E5E5"> and the attacker responds</font>

115
00:07:37,139 --> 00:07:45,569
with<font color="#CCCCCC"> Evo pillowed he injects</font><font color="#E5E5E5"> a real</font>

116
00:07:42,059 --> 00:07:52,110
image tag which the<font color="#CCCCCC"> source points</font><font color="#E5E5E5"> to the</font>

117
00:07:45,569 --> 00:07:55,949
attackers<font color="#E5E5E5"> at MB server so the victim</font>

118
00:07:52,110 --> 00:07:59,909
tries to<font color="#CCCCCC"> login to the</font><font color="#E5E5E5"> attackers SMB</font>

119
00:07:55,949 --> 00:08:04,559
server and<font color="#CCCCCC"> send the type one message to</font>

120
00:07:59,909 --> 00:08:09,589
<font color="#CCCCCC">the attacker</font><font color="#E5E5E5"> the attacker just forward</font>

121
00:08:04,559 --> 00:08:09,589
<font color="#CCCCCC">the type of</font><font color="#E5E5E5"> a message to this server and</font>

122
00:08:10,219 --> 00:08:17,009
<font color="#E5E5E5">the server responds with the challenge</font>

123
00:08:13,019 --> 00:08:22,949
to<font color="#E5E5E5"> the attacker and the attacker relays</font>

124
00:08:17,009 --> 00:08:26,599
the same challenge to the victim and the

125
00:08:22,949 --> 00:08:30,479
victim calculates the challenge response

126
00:08:26,599 --> 00:08:33,360
which is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> victim's credential unseen</font>

127
00:08:30,479 --> 00:08:37,729
<font color="#CCCCCC">is to the attacker and the attacker just</font>

128
00:08:33,360 --> 00:08:42,539
<font color="#E5E5E5">force this credential to the server so</font>

129
00:08:37,729 --> 00:08:49,110
the attacker can<font color="#CCCCCC"> login to</font><font color="#E5E5E5"> the server</font>

130
00:08:42,539 --> 00:08:54,139
successfully yeah<font color="#E5E5E5"> now the attacker can</font>

131
00:08:49,110 --> 00:08:57,569
become a<font color="#CCCCCC"> domain</font><font color="#E5E5E5"> it can</font><font color="#CCCCCC"> become victim</font>

132
00:08:54,139 --> 00:09:00,420
sometimes the<font color="#CCCCCC"> wig team and thrower is on</font>

133
00:08:57,569 --> 00:09:04,610
the<font color="#CCCCCC"> sea machine the sower</font><font color="#E5E5E5"> sometimes</font><font color="#CCCCCC"> may</font>

134
00:09:00,420 --> 00:09:07,050
<font color="#CCCCCC">be a service of</font><font color="#E5E5E5"> the machine</font>

135
00:09:04,610 --> 00:09:12,149
<font color="#CCCCCC">okay let's</font><font color="#E5E5E5"> move to some real world</font>

136
00:09:07,050 --> 00:09:16,349
attacks the first one is called<font color="#CCCCCC"> FMB</font>

137
00:09:12,149 --> 00:09:21,120
<font color="#E5E5E5">reflect attack when the weak team access</font>

138
00:09:16,350 --> 00:09:24,839
<font color="#E5E5E5">a UNC path or</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> foul protocol like this</font>

139
00:09:21,120 --> 00:09:28,680
<font color="#E5E5E5">and the victim we</font><font color="#CCCCCC"> all sense is</font>

140
00:09:24,839 --> 00:09:32,250
<font color="#CCCCCC">Crenshaw's automatically the attacker</font>

141
00:09:28,680 --> 00:09:37,439
<font color="#CCCCCC">just reflects the</font><font color="#E5E5E5"> credentials to the</font>

142
00:09:32,250 --> 00:09:40,740
<font color="#E5E5E5">weak teams SME server and the attacker</font>

143
00:09:37,439 --> 00:09:45,360
can achieve<font color="#CCCCCC"> rcee while starting</font><font color="#E5E5E5"> a</font>

144
00:09:40,740 --> 00:09:48,180
service and the<font color="#E5E5E5"> Microsoft released a</font>

145
00:09:45,360 --> 00:09:52,199
patch caught em at zero eight zero six

146
00:09:48,180 --> 00:09:56,579
eight<font color="#CCCCCC"> it stops at MB to FMB relay on</font>

147
00:09:52,199 --> 00:09:59,370
this stream on<font color="#CCCCCC"> the</font><font color="#E5E5E5"> same machine and the</font>

148
00:09:56,579 --> 00:10:00,029
years later<font color="#E5E5E5"> there comes another exploit</font>

149
00:09:59,370 --> 00:10:06,629
called

150
00:10:00,029 --> 00:10:09,899
hot potato<font color="#E5E5E5"> on</font><font color="#CCCCCC"> windows 7 first this this</font>

151
00:10:06,629 --> 00:10:15,319
is<font color="#CCCCCC"> part</font><font color="#E5E5E5"> we all start a web service on</font>

152
00:10:09,899 --> 00:10:16,529
localhost<font color="#E5E5E5"> and binding on port 80 it's</font>

153
00:10:15,319 --> 00:10:19,680
destroyed

154
00:10:16,529 --> 00:10:23,430
we<font color="#E5E5E5"> are hijacked our</font><font color="#CCCCCC"> epad and redirect</font>

155
00:10:19,680 --> 00:10:28,079
<font color="#CCCCCC">windows defenders update to the web</font>

156
00:10:23,430 --> 00:10:31,649
server<font color="#E5E5E5"> he just started and next the web</font>

157
00:10:28,079 --> 00:10:35,878
server will<font color="#CCCCCC"> ask for 401 and he our</font>

158
00:10:31,649 --> 00:10:41,550
<font color="#E5E5E5">authentication and relay the credentials</font>

159
00:10:35,879 --> 00:10:46,139
to<font color="#CCCCCC"> the local @mb and finally the exploit</font>

160
00:10:41,550 --> 00:10:52,008
can log into the local @mb server as<font color="#E5E5E5"> the</font>

161
00:10:46,139 --> 00:10:58,319
user<font color="#E5E5E5"> system this is</font><font color="#CCCCCC"> fraud is used to</font>

162
00:10:52,009 --> 00:11:02,420
privilege escalation<font color="#E5E5E5"> and this use a HTTP</font>

163
00:10:58,319 --> 00:11:06,899
to<font color="#CCCCCC"> amb relay on the same machine</font><font color="#E5E5E5"> and</font>

164
00:11:02,420 --> 00:11:07,740
here comes the patch<font color="#CCCCCC"> am as160</font>

165
00:11:06,899 --> 00:11:11,250
<font color="#E5E5E5">seven</font>

166
00:11:07,740 --> 00:11:15,180
five<font color="#E5E5E5"> this patch fixed relay crindars</font>

167
00:11:11,250 --> 00:11:22,440
<font color="#CCCCCC">Shaw from local</font><font color="#E5E5E5"> HTTP to local SMB server</font>

168
00:11:15,180 --> 00:11:26,459
<font color="#CCCCCC">and it's in theorem really</font><font color="#E5E5E5"> that the</font>

169
00:11:22,440 --> 00:11:29,780
answer is<font color="#E5E5E5"> no we can still relate to</font>

170
00:11:26,460 --> 00:11:33,420
other machine we<font color="#E5E5E5"> can really</font><font color="#CCCCCC"> atom</font><font color="#E5E5E5"> be to</font>

171
00:11:29,780 --> 00:11:38,400
Microsoft Exchange Server the email

172
00:11:33,420 --> 00:11:41,849
server because the<font color="#E5E5E5"> exchange web show is</font>

173
00:11:38,400 --> 00:11:46,170
supposed<font color="#E5E5E5"> ntlm authentication and there</font>

174
00:11:41,850 --> 00:11:51,300
<font color="#E5E5E5">there are</font><font color="#CCCCCC"> many useful web api's and if</font>

175
00:11:46,170 --> 00:11:56,849
you use outdated<font color="#E5E5E5"> outlook client you</font><font color="#CCCCCC"> may</font>

176
00:11:51,300 --> 00:11:59,849
be remote compromised<font color="#E5E5E5"> and we</font><font color="#CCCCCC"> can also</font>

177
00:11:56,850 --> 00:12:03,810
really<font color="#CCCCCC"> atom be to another merchants</font>

178
00:11:59,850 --> 00:12:09,780
<font color="#CCCCCC">atomy</font><font color="#E5E5E5"> if these two machine share the</font>

179
00:12:03,810 --> 00:12:14,280
same credentials so there comes<font color="#E5E5E5"> the</font>

180
00:12:09,780 --> 00:12:15,770
question where can<font color="#CCCCCC"> we get</font><font color="#E5E5E5"> atomy request</font>

181
00:12:14,280 --> 00:12:20,370
we can<font color="#E5E5E5"> get a</font>

182
00:12:15,770 --> 00:12:26,220
<font color="#CCCCCC">atomy requesting process in a word in</font>

183
00:12:20,370 --> 00:12:30,240
PDF<font color="#CCCCCC"> in</font><font color="#E5E5E5"> pro and the processor is</font><font color="#CCCCCC"> the most</font>

184
00:12:26,220 --> 00:12:36,320
common one in the<font color="#E5E5E5"> movie in the modern</font>

185
00:12:30,240 --> 00:12:36,320
<font color="#CCCCCC">browsers we can see from the table</font>

186
00:12:37,190 --> 00:12:46,680
<font color="#CCCCCC">IE on</font><font color="#E5E5E5"> windows 7 and chrome we all obey</font>

187
00:12:42,330 --> 00:12:50,700
the<font color="#E5E5E5"> wpad it which means when these two</font>

188
00:12:46,680 --> 00:12:53,959
brothers want to access your website<font color="#E5E5E5"> it</font>

189
00:12:50,700 --> 00:13:00,330
will find its<font color="#CCCCCC"> therapy ID first</font>

190
00:12:53,960 --> 00:13:02,420
and unfortunately in<font color="#CCCCCC"> chrome if you</font>

191
00:13:00,330 --> 00:13:07,710
process<font color="#CCCCCC"> a</font><font color="#E5E5E5"> web page</font>

192
00:13:02,420 --> 00:13:10,439
it cannot send out the window shows<font color="#E5E5E5"> in</font>

193
00:13:07,710 --> 00:13:18,210
here<font color="#CCCCCC"> i'm credentials automatically we</font>

194
00:13:10,440 --> 00:13:21,689
can only attack<font color="#E5E5E5"> IE and</font><font color="#CCCCCC"> ad so we cannot</font>

195
00:13:18,210 --> 00:13:25,199
attack IE or at our windows turn

196
00:13:21,689 --> 00:13:26,879
without user interaction<font color="#E5E5E5"> because we</font>

197
00:13:25,199 --> 00:13:31,740
cannot<font color="#E5E5E5"> be the proxy server</font>

198
00:13:26,879 --> 00:13:34,439
we cannot insert any<font color="#E5E5E5"> Evo tags and well</font>

199
00:13:31,740 --> 00:13:40,829
<font color="#E5E5E5">if we want to attack them the weak team</font>

200
00:13:34,439 --> 00:13:44,389
need to<font color="#E5E5E5"> bruise attackers page and we</font>

201
00:13:40,829 --> 00:13:47,878
cannot attack<font color="#CCCCCC"> chrome remotely because</font>

202
00:13:44,389 --> 00:13:51,990
<font color="#E5E5E5">chrome blocks all the requests to the</font>

203
00:13:47,879 --> 00:13:55,649
<font color="#E5E5E5">SMB it says we cannot we are not allowed</font>

204
00:13:51,990 --> 00:13:59,730
<font color="#CCCCCC">to load local resource and we also</font>

205
00:13:55,649 --> 00:14:02,429
cannot reflect credentials<font color="#CCCCCC"> 2fm beyond</font>

206
00:13:59,730 --> 00:14:06,569
the summation because of these two

207
00:14:02,429 --> 00:14:10,800
patches so there<font color="#E5E5E5"> comes the</font><font color="#CCCCCC"> question</font>

208
00:14:06,569 --> 00:14:13,829
again<font color="#E5E5E5"> is in here I'm really that then</font>

209
00:14:10,800 --> 00:14:20,639
also it's<font color="#E5E5E5"> almost so</font><font color="#CCCCCC"> auntie I'm</font><font color="#E5E5E5"> really</font>

210
00:14:13,829 --> 00:14:22,979
<font color="#E5E5E5">mr. rebirth okay just now my mate has</font>

211
00:14:20,639 --> 00:14:24,569
given<font color="#E5E5E5"> us introduction</font><font color="#CCCCCC"> to the railroads</font>

212
00:14:22,980 --> 00:14:27,809
way of the using and him will they

213
00:14:24,569 --> 00:14:30,389
attack we<font color="#CCCCCC"> can</font><font color="#E5E5E5"> all see well it micro</font>

214
00:14:27,809 --> 00:14:34,999
software has<font color="#E5E5E5"> provided many patch to</font>

215
00:14:30,389 --> 00:14:37,829
against it so so they are the<font color="#CCCCCC"> NTM relay</font>

216
00:14:34,999 --> 00:14:40,079
attacks really<font color="#CCCCCC"> dead</font><font color="#E5E5E5"> after our research</font>

217
00:14:37,829 --> 00:14:46,410
we brought some new hope to<font color="#CCCCCC"> the dying</font>

218
00:14:40,079 --> 00:14:49,670
patient as the<font color="#CCCCCC"> measurer</font><font color="#E5E5E5"> lead</font><font color="#CCCCCC"> pentium SSP</font>

219
00:14:46,410 --> 00:14:52,279
can be used to complete anti a.m.

220
00:14:49,670 --> 00:14:55,128
authentication for the<font color="#CCCCCC"> various service</font>

221
00:14:52,279 --> 00:14:58,589
here I will<font color="#CCCCCC"> introduce and Here I am</font>

222
00:14:55,129 --> 00:15:01,619
authentication<font color="#E5E5E5"> based on HTTP implement</font>

223
00:14:58,589 --> 00:15:05,459
implementation now that we are<font color="#E5E5E5"> talking</font>

224
00:15:01,619 --> 00:15:08,129
about HTTP services professors are<font color="#E5E5E5"> happy</font>

225
00:15:05,459 --> 00:15:10,649
code that has<font color="#E5E5E5"> be to be mentioned virus</font>

226
00:15:08,129 --> 00:15:14,100
professor has implemented the entire

227
00:15:10,649 --> 00:15:16,189
<font color="#CCCCCC">area of the</font><font color="#E5E5E5"> indication some service but</font>

228
00:15:14,100 --> 00:15:19,619
there are some difference in

229
00:15:16,189 --> 00:15:24,049
implementation<font color="#CCCCCC"> of each browsers I will</font>

230
00:15:19,619 --> 00:15:24,049
introduce those difference one by one

231
00:15:24,920 --> 00:15:31,229
let's take<font color="#CCCCCC"> a look at what and yum</font>

232
00:15:28,079 --> 00:15:33,689
education in HTTP looks like first

233
00:15:31,230 --> 00:15:34,980
the professor exists<font color="#E5E5E5"> the</font><font color="#CCCCCC"> web page that</font>

234
00:15:33,689 --> 00:15:38,699
<font color="#CCCCCC">need</font><font color="#E5E5E5"> need</font>

235
00:15:34,980 --> 00:15:41,089
and<font color="#E5E5E5"> identification after receiving to</font>

236
00:15:38,699 --> 00:15:43,829
request the server check if<font color="#CCCCCC"> the header</font>

237
00:15:41,089 --> 00:15:47,820
<font color="#E5E5E5">HTTP header contains the authentication</font>

238
00:15:43,829 --> 00:15:50,790
information<font color="#E5E5E5"> if doesn't</font><font color="#CCCCCC"> is retained it is</font>

239
00:15:47,820 --> 00:15:53,579
written<font color="#CCCCCC"> for a long students code and</font>

240
00:15:50,790 --> 00:15:57,000
<font color="#E5E5E5">approach protomans user that they are</font>

241
00:15:53,579 --> 00:16:00,599
not intent<font color="#CCCCCC"> occasion after the professor</font>

242
00:15:57,000 --> 00:16:03,360
<font color="#CCCCCC">mr. reserves it it's van that the page</font>

243
00:16:00,600 --> 00:16:06,209
need indium identification<font color="#E5E5E5"> so the</font>

244
00:16:03,360 --> 00:16:09,690
professor we are<font color="#E5E5E5"> tech</font><font color="#CCCCCC"> first</font><font color="#E5E5E5"> step and he</font>

245
00:16:06,209 --> 00:16:12,989
MSSP<font color="#CCCCCC"> nicosia age is also</font><font color="#E5E5E5"> called tap one</font>

246
00:16:09,690 --> 00:16:16,350
message after the server receiving<font color="#E5E5E5"> the</font>

247
00:16:12,990 --> 00:16:20,910
<font color="#CCCCCC">help a</font><font color="#E5E5E5"> message from the professor it's</font>

248
00:16:16,350 --> 00:16:23,730
returned and<font color="#CCCCCC"> ham</font><font color="#E5E5E5"> challenge this is step</font>

249
00:16:20,910 --> 00:16:25,800
<font color="#E5E5E5">two message and when the professor</font>

250
00:16:23,730 --> 00:16:27,839
carries a challenge it<font color="#E5E5E5"> were hash it with</font>

251
00:16:25,800 --> 00:16:30,510
you the user credentials<font color="#E5E5E5"> with the</font>

252
00:16:27,839 --> 00:16:33,089
generate<font color="#CCCCCC"> taps tree message after the</font>

253
00:16:30,510 --> 00:16:36,120
server<font color="#E5E5E5"> with</font><font color="#CCCCCC"> sermons tap story message</font>

254
00:16:33,089 --> 00:16:39,720
<font color="#E5E5E5">you use the same month to calculate</font>

255
00:16:36,120 --> 00:16:42,660
<font color="#CCCCCC">Ohashi</font><font color="#E5E5E5"> so we are comparative</font><font color="#CCCCCC"> house</font>

256
00:16:39,720 --> 00:16:46,730
if the same<font color="#CCCCCC"> engine authentication is</font>

257
00:16:42,660 --> 00:16:49,380
complete and the resource is<font color="#E5E5E5"> retained</font>

258
00:16:46,730 --> 00:16:52,680
how to send<font color="#CCCCCC"> a windows credential</font>

259
00:16:49,380 --> 00:16:58,439
automatically in professor professor

260
00:16:52,680 --> 00:17:00,410
this is<font color="#CCCCCC"> an interesting question</font><font color="#E5E5E5"> open the</font>

261
00:16:58,440 --> 00:17:03,980
<font color="#CCCCCC">eye settings we can say as follow</font>

262
00:17:00,410 --> 00:17:08,040
automatically<font color="#CCCCCC"> log</font><font color="#E5E5E5"> only</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> internet</font>

263
00:17:03,980 --> 00:17:11,579
after after machine is joined a domain

264
00:17:08,040 --> 00:17:15,000
<font color="#E5E5E5">when the</font><font color="#CCCCCC"> internet explorer exists now</font>

265
00:17:11,579 --> 00:17:18,389
fqt and hosted<font color="#CCCCCC"> hostname is</font><font color="#E5E5E5"> where make a</font>

266
00:17:15,000 --> 00:17:21,150
DNS query<font color="#E5E5E5"> its first for example the</font>

267
00:17:18,390 --> 00:17:24,240
<font color="#E5E5E5">domain name is</font><font color="#CCCCCC"> the transient and calm</font>

268
00:17:21,150 --> 00:17:27,260
and the<font color="#CCCCCC"> hostname is the</font><font color="#E5E5E5"> first server</font><font color="#CCCCCC"> yes</font>

269
00:17:24,240 --> 00:17:28,860
we<font color="#E5E5E5"> are correct what</font><font color="#CCCCCC"> is the first arrow</font>

270
00:17:27,260 --> 00:17:32,370
<font color="#CCCCCC">townsend.com</font>

271
00:17:28,860 --> 00:17:35,520
<font color="#CCCCCC">at the address if the HTTP of the</font><font color="#E5E5E5"> this</font>

272
00:17:32,370 --> 00:17:40,530
host means<font color="#E5E5E5"> an tiem</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> indication it will</font>

273
00:17:35,520 --> 00:17:43,799
be automatically authenticated<font color="#E5E5E5"> so when</font>

274
00:17:40,530 --> 00:17:46,440
the internet environment<font color="#CCCCCC"> windows suppose</font>

275
00:17:43,799 --> 00:17:49,370
some month to determine<font color="#E5E5E5"> whether the</font><font color="#CCCCCC"> uio</font>

276
00:17:46,440 --> 00:17:49,370
is<font color="#CCCCCC"> a Internet</font>

277
00:17:49,570 --> 00:17:57,129
the first<font color="#E5E5E5"> API is the</font><font color="#CCCCCC"> processes URL</font>

278
00:17:53,270 --> 00:18:00,260
action which<font color="#CCCCCC"> has two important Pro</font>

279
00:17:57,130 --> 00:18:04,789
protests in the<font color="#CCCCCC"> things one of the first</font>

280
00:18:00,260 --> 00:18:09,408
from parameter is the PSW the URL<font color="#E5E5E5"> you</font>

281
00:18:04,789 --> 00:18:13,129
<font color="#CCCCCC">see</font><font color="#E5E5E5"> that we enter to your</font><font color="#CCCCCC"> Arabic we</font>

282
00:18:09,409 --> 00:18:16,900
entered<font color="#E5E5E5"> a</font><font color="#CCCCCC"> yachtie just bad</font><font color="#E5E5E5"> the another</font>

283
00:18:13,130 --> 00:18:20,929
parameter is the output parameter<font color="#E5E5E5"> and</font>

284
00:18:16,900 --> 00:18:23,870
the second<font color="#E5E5E5"> API is the</font><font color="#CCCCCC"> map URI or</font><font color="#E5E5E5"> to zone</font>

285
00:18:20,929 --> 00:18:26,000
<font color="#E5E5E5">and it also has two important parameters</font>

286
00:18:23,870 --> 00:18:30,489
the first<font color="#E5E5E5"> either</font>

287
00:18:26,000 --> 00:18:33,470
the first is<font color="#CCCCCC"> steer p</font><font color="#E5E5E5"> p WS</font><font color="#CCCCCC"> uija</font>

288
00:18:30,490 --> 00:18:39,919
and the second parameter is is the

289
00:18:33,470 --> 00:18:42,770
output parameter the first are the first

290
00:18:39,919 --> 00:18:46,460
<font color="#CCCCCC">api we are output to the palace</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> the</font>

291
00:18:42,770 --> 00:18:51,889
second of<font color="#CCCCCC"> api will output</font><font color="#E5E5E5"> a zone so what</font>

292
00:18:46,460 --> 00:18:54,799
about zone and the<font color="#CCCCCC"> parity there</font><font color="#E5E5E5"> are many</font>

293
00:18:51,890 --> 00:18:57,020
types of<font color="#CCCCCC"> palace ii provided by microsoft</font>

294
00:18:54,799 --> 00:18:58,940
by the way<font color="#CCCCCC"> i will mention the</font><font color="#E5E5E5"> two here</font>

295
00:18:57,020 --> 00:19:02,929
<font color="#CCCCCC">the first row is the URL palace</font>

296
00:18:58,940 --> 00:19:05,120
equations<font color="#CCCCCC"> sienten logging ok and another</font>

297
00:19:02,929 --> 00:19:08,210
<font color="#CCCCCC">one</font><font color="#E5E5E5"> is the</font><font color="#CCCCCC"> you are URL policy</font>

298
00:19:05,120 --> 00:19:10,729
credentials master producers which means

299
00:19:08,210 --> 00:19:13,760
to<font color="#E5E5E5"> the protein user to enter the</font>

300
00:19:10,730 --> 00:19:17,360
password and<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> username</font><font color="#E5E5E5"> general</font>

301
00:19:13,760 --> 00:19:19,908
generally in the second policy whether

302
00:19:17,360 --> 00:19:23,750
the user should really be reminded by

303
00:19:19,909 --> 00:19:29,510
the proxy depends on the value of the

304
00:19:23,750 --> 00:19:32,380
zone<font color="#CCCCCC"> of the zone</font><font color="#E5E5E5"> looking at the looking</font>

305
00:19:29,510 --> 00:19:35,230
<font color="#E5E5E5">at this table</font><font color="#CCCCCC"> a list the different means</font>

306
00:19:32,380 --> 00:19:38,510
<font color="#CCCCCC">represented</font><font color="#E5E5E5"> by</font><font color="#CCCCCC"> different values and</font>

307
00:19:35,230 --> 00:19:44,330
whether the user should automatically

308
00:19:38,510 --> 00:19:47,270
<font color="#CCCCCC">login for example if if you enter a URL</font>

309
00:19:44,330 --> 00:19:50,990
<font color="#E5E5E5">the policy is</font><font color="#CCCCCC"> the URL policy credentials</font>

310
00:19:47,270 --> 00:19:53,750
<font color="#E5E5E5">Master Pro from its user pass the</font><font color="#CCCCCC"> song</font>

311
00:19:50,990 --> 00:19:59,860
value is<font color="#CCCCCC"> one which</font><font color="#E5E5E5"> also automatically</font>

312
00:19:53,750 --> 00:20:02,260
<font color="#CCCCCC">locking locks in based</font><font color="#E5E5E5"> on the two api's</font>

313
00:19:59,860 --> 00:20:04,330
we run<font color="#E5E5E5"> to</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> program for testing and</font>

314
00:20:02,260 --> 00:20:07,420
found the different<font color="#E5E5E5"> features on the</font>

315
00:20:04,330 --> 00:20:09,669
Windows 7<font color="#CCCCCC"> and Windows 10 the network</font>

316
00:20:07,420 --> 00:20:12,400
environment with Hester<font color="#E5E5E5"> was the</font><font color="#CCCCCC"> working</font>

317
00:20:09,670 --> 00:20:14,740
room environment<font color="#CCCCCC"> while do we choose the</font>

318
00:20:12,400 --> 00:20:17,290
working room environment<font color="#E5E5E5"> because in the</font>

319
00:20:14,740 --> 00:20:20,320
enterprise<font color="#E5E5E5"> Internet they are</font><font color="#CCCCCC"> generally</font>

320
00:20:17,290 --> 00:20:22,450
<font color="#CCCCCC">two environments</font><font color="#E5E5E5"> the one is the working</font>

321
00:20:20,320 --> 00:20:25,179
working group environment and<font color="#E5E5E5"> the other</font>

322
00:20:22,450 --> 00:20:27,910
one is the domain environment when the

323
00:20:25,180 --> 00:20:29,860
<font color="#E5E5E5">braava syrup encounters the</font><font color="#CCCCCC"> host</font><font color="#E5E5E5"> and</font>

324
00:20:27,910 --> 00:20:33,670
<font color="#CCCCCC">ampad address in the domain environment</font>

325
00:20:29,860 --> 00:20:36,780
is automatically<font color="#E5E5E5"> as the current domain</font>

326
00:20:33,670 --> 00:20:41,740
name<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> host name</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> its determine</font>

327
00:20:36,780 --> 00:20:44,560
determines<font color="#CCCCCC"> to all no fqdn type addressed</font>

328
00:20:41,740 --> 00:20:47,080
as<font color="#CCCCCC"> the local internet because the</font><font color="#E5E5E5"> domain</font>

329
00:20:44,560 --> 00:20:50,320
environment is trusted environment<font color="#E5E5E5"> but</font>

330
00:20:47,080 --> 00:20:52,510
the panel is the same the working group

331
00:20:50,320 --> 00:20:54,659
environment which is the net secure

332
00:20:52,510 --> 00:20:59,740
environment

333
00:20:54,660 --> 00:21:04,450
so<font color="#CCCCCC"> regardless</font><font color="#E5E5E5"> following result results</font>

334
00:20:59,740 --> 00:21:10,450
table on the Windows<font color="#CCCCCC"> 10 you input a</font>

335
00:21:04,450 --> 00:21:13,690
Windows 10 and then<font color="#E5E5E5"> song will be one but</font>

336
00:21:10,450 --> 00:21:19,810
different in Windows 7<font color="#E5E5E5"> if you input the</font>

337
00:21:13,690 --> 00:21:26,920
<font color="#CCCCCC">Windows</font><font color="#E5E5E5"> 7 in UI apart</font><font color="#CCCCCC"> say</font><font color="#E5E5E5"> we are</font><font color="#CCCCCC"> the</font>

338
00:21:19,810 --> 00:21:28,780
<font color="#CCCCCC">same the value is will be 3 ok see how</font>

339
00:21:26,920 --> 00:21:32,080
the professor<font color="#CCCCCC"> determine as to</font><font color="#E5E5E5"> whether or</font>

340
00:21:28,780 --> 00:21:34,810
<font color="#E5E5E5">not it can automatically</font><font color="#CCCCCC"> log in both</font>

341
00:21:32,080 --> 00:21:37,570
Firefox and the chrome<font color="#CCCCCC"> use the function</font>

342
00:21:34,810 --> 00:21:39,850
code can use the<font color="#E5E5E5"> default credentials</font><font color="#CCCCCC"> and</font>

343
00:21:37,570 --> 00:21:42,700
when this function<font color="#CCCCCC"> returns to</font>

344
00:21:39,850 --> 00:21:45,010
automatically<font color="#E5E5E5"> logging is allowed when</font>

345
00:21:42,700 --> 00:21:47,110
when this function<font color="#CCCCCC"> returns first the</font>

346
00:21:45,010 --> 00:21:50,400
user is remanded to<font color="#E5E5E5"> enter the password</font>

347
00:21:47,110 --> 00:21:50,399
and the<font color="#E5E5E5"> username</font>

348
00:21:50,430 --> 00:21:56,050
chrome<font color="#E5E5E5"> is respecting the</font><font color="#CCCCCC"> internet</font>

349
00:21:53,890 --> 00:21:58,450
<font color="#CCCCCC">explorer setting which means that the</font>

350
00:21:56,050 --> 00:22:01,330
result of the<font color="#E5E5E5"> two</font><font color="#CCCCCC"> api's we're talking</font>

351
00:21:58,450 --> 00:22:04,270
about earlier<font color="#E5E5E5"> what the chrome followings</font>

352
00:22:01,330 --> 00:22:06,909
<font color="#E5E5E5">in</font><font color="#CCCCCC"> the working work room environment</font>

353
00:22:04,270 --> 00:22:10,660
<font color="#CCCCCC">chrome</font><font color="#E5E5E5"> running</font><font color="#CCCCCC"> on Windows 10</font><font color="#E5E5E5"> we are</font>

354
00:22:06,910 --> 00:22:12,110
<font color="#E5E5E5">automatically complete for one</font><font color="#CCCCCC"> engine as</font>

355
00:22:10,660 --> 00:22:15,019
<font color="#CCCCCC">education</font>

356
00:22:12,110 --> 00:22:17,590
<font color="#E5E5E5">it's called when either in</font><font color="#CCCCCC"> cost the URL</font>

357
00:22:15,019 --> 00:22:21,529
of those<font color="#E5E5E5"> hosts is the null fqdn</font>

358
00:22:17,590 --> 00:22:24,709
<font color="#E5E5E5">therefore in chrome</font><font color="#CCCCCC"> we found a way to</font>

359
00:22:21,529 --> 00:22:28,549
lick and<font color="#E5E5E5"> Yamaha she again</font><font color="#CCCCCC"> perversely</font>

360
00:22:24,710 --> 00:22:31,460
we<font color="#CCCCCC"> use to the Lord extreme sauce</font><font color="#E5E5E5"> fell</font>

361
00:22:28,549 --> 00:22:34,549
<font color="#E5E5E5">through the</font><font color="#CCCCCC"> fare</font><font color="#E5E5E5"> protec and then use the</font>

362
00:22:31,460 --> 00:22:41,210
SMB requested to link the net and<font color="#CCCCCC"> he</font>

363
00:22:34,549 --> 00:22:43,940
<font color="#CCCCCC">mihashi so now we can attack chrome</font>

364
00:22:41,210 --> 00:22:47,240
remotely<font color="#E5E5E5"> chrome we are automatically</font>

365
00:22:43,940 --> 00:22:51,789
<font color="#CCCCCC">send</font><font color="#E5E5E5"> credential in the Internet is the</font>

366
00:22:47,240 --> 00:23:00,169
<font color="#CCCCCC">ng MSSP</font><font color="#E5E5E5"> over the HTTP but one more thing</font>

367
00:22:51,789 --> 00:23:03,340
is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> ma</font><font color="#E5E5E5"> is the chrome minion box</font><font color="#CCCCCC"> say</font>

368
00:23:00,169 --> 00:23:11,019
the<font color="#CCCCCC"> test</font><font color="#E5E5E5"> environment is the windows to</font>

369
00:23:03,340 --> 00:23:13,309
<font color="#E5E5E5">understand chrome in chrome certain 171</font>

370
00:23:11,019 --> 00:23:16,179
first the you would have anything<font color="#E5E5E5"> in</font>

371
00:23:13,309 --> 00:23:19,730
chrome<font color="#CCCCCC"> meaning</font><font color="#E5E5E5"> box such as today news</font>

372
00:23:16,179 --> 00:23:23,210
and then the windows<font color="#E5E5E5"> Oscar who is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> to</font>

373
00:23:19,730 --> 00:23:26,000
the news<font color="#CCCCCC"> on through the lam name</font>

374
00:23:23,210 --> 00:23:28,850
resolution<font color="#CCCCCC"> a check can also read by</font>

375
00:23:26,000 --> 00:23:31,909
disproving am to the news and I need you

376
00:23:28,850 --> 00:23:34,908
to complete<font color="#CCCCCC"> EMS education</font><font color="#E5E5E5"> chrome</font>

377
00:23:31,909 --> 00:23:37,220
determines chrome where the terms the

378
00:23:34,909 --> 00:23:40,610
today<font color="#CCCCCC"> news is the</font><font color="#E5E5E5"> internet</font><font color="#CCCCCC"> song and so</font>

379
00:23:37,220 --> 00:23:43,539
it will automatically log finally<font color="#E5E5E5"> the</font>

380
00:23:40,610 --> 00:23:47,418
attack<font color="#CCCCCC"> abandons the credential</font><font color="#E5E5E5"> and they</font>

381
00:23:43,539 --> 00:23:50,440
<font color="#CCCCCC">relay it to the</font><font color="#E5E5E5"> other machine he can</font>

382
00:23:47,419 --> 00:23:50,440
achieve the<font color="#CCCCCC"> RCE</font>

383
00:23:50,860 --> 00:24:03,709
so can we relate credentials to the<font color="#E5E5E5"> same</font>

384
00:23:54,649 --> 00:24:05,689
machine<font color="#E5E5E5"> the answer is yes</font><font color="#CCCCCC"> SMB</font>

385
00:24:03,710 --> 00:24:08,120
credentials reflection attack was

386
00:24:05,690 --> 00:24:13,519
discovered 10 years<font color="#CCCCCC"> ago and the</font>

387
00:24:08,120 --> 00:24:17,809
<font color="#CCCCCC">Microsoft</font><font color="#E5E5E5"> fixed either with MS 0 H 0 68</font>

388
00:24:13,519 --> 00:24:20,750
patch<font color="#E5E5E5"> in 2013</font>

389
00:24:17,809 --> 00:24:23,120
<font color="#CCCCCC">James photo</font><font color="#E5E5E5"> put forward</font><font color="#CCCCCC"> across protocol</font>

390
00:24:20,750 --> 00:24:24,669
and him<font color="#E5E5E5"> really attack what I'm</font>

391
00:24:23,120 --> 00:24:27,100
introducing today

392
00:24:24,669 --> 00:24:30,369
is used some of<font color="#E5E5E5"> the feature of the Chara</font>

393
00:24:27,100 --> 00:24:32,949
<font color="#E5E5E5">to complete this attack James found that</font>

394
00:24:30,369 --> 00:24:36,279
the way attack are used for local

395
00:24:32,950 --> 00:24:41,200
privilege escalation and our way is can

396
00:24:36,279 --> 00:24:44,139
do<font color="#CCCCCC"> sae the operation is divided into</font><font color="#E5E5E5"> the</font>

397
00:24:41,200 --> 00:24:47,590
<font color="#E5E5E5">following five steps using the java</font>

398
00:24:44,139 --> 00:24:52,479
application<font color="#E5E5E5"> to exist webpage which needs</font>

399
00:24:47,590 --> 00:24:56,459
an authentication and then<font color="#E5E5E5"> the attack</font>

400
00:24:52,480 --> 00:25:00,489
stating<font color="#CCCCCC"> state a</font><font color="#E5E5E5"> net</font><font color="#CCCCCC"> hoshi from the</font>

401
00:24:56,460 --> 00:25:04,440
victim<font color="#E5E5E5"> and then attack can reflecting</font>

402
00:25:00,489 --> 00:25:09,100
the<font color="#CCCCCC"> anti Maharshi</font><font color="#E5E5E5"> to victim SMB services</font>

403
00:25:04,440 --> 00:25:12,850
<font color="#CCCCCC">is the same machine after that</font><font color="#E5E5E5"> the</font>

404
00:25:09,100 --> 00:25:16,719
attack we are<font color="#CCCCCC"> login six six successfully</font>

405
00:25:12,850 --> 00:25:23,799
<font color="#CCCCCC">she can I say while studying our remote</font>

406
00:25:16,720 --> 00:25:27,309
remote servers<font color="#CCCCCC"> we can char was an HTTP</font>

407
00:25:23,799 --> 00:25:30,700
<font color="#E5E5E5">request</font><font color="#CCCCCC"> when a java application has</font><font color="#E5E5E5"> SSR</font>

408
00:25:27,309 --> 00:25:34,450
f or XX e<font color="#E5E5E5"> availabilities its can issue</font>

409
00:25:30,700 --> 00:25:37,029
HTTP<font color="#E5E5E5"> requires in the</font><font color="#CCCCCC"> ssl vulnerability</font>

410
00:25:34,450 --> 00:25:41,049
<font color="#E5E5E5">only requires the standard wrote a jetty</font>

411
00:25:37,029 --> 00:25:43,350
compute function<font color="#CCCCCC"> name the HTTP URL</font>

412
00:25:41,049 --> 00:25:49,299
connection<font color="#CCCCCC"> either</font><font color="#E5E5E5"> way automatically</font>

413
00:25:43,350 --> 00:25:52,988
complete intent occasion when<font color="#CCCCCC"> exploding</font>

414
00:25:49,299 --> 00:25:58,739
the XX<font color="#CCCCCC"> e1</font><font color="#E5E5E5"> ability you can defend</font><font color="#CCCCCC"> or in</font>

415
00:25:52,989 --> 00:26:01,570
tentative<font color="#E5E5E5"> to point</font><font color="#CCCCCC"> a URI and the</font><font color="#E5E5E5"> XML</font>

416
00:25:58,739 --> 00:26:04,809
professor will choose the way of<font color="#E5E5E5"> the</font>

417
00:26:01,570 --> 00:26:07,509
connection<font color="#CCCCCC"> coding the protocol and we</font>

418
00:26:04,809 --> 00:26:12,450
automatically use the HTTP URL

419
00:26:07,509 --> 00:26:16,539
connection to send HTTP<font color="#CCCCCC"> request throw</font>

420
00:26:12,450 --> 00:26:23,409
<font color="#E5E5E5">into attack surface we can get the net</font>

421
00:26:16,539 --> 00:26:26,408
and<font color="#E5E5E5"> Yamaha she okay when the request is</font>

422
00:26:23,409 --> 00:26:28,330
sent by the HTTP URL connection to

423
00:26:26,409 --> 00:26:33,480
request is actually<font color="#E5E5E5"> stand all the way</font>

424
00:26:28,330 --> 00:26:33,480
<font color="#E5E5E5">out there because as a picture</font><font color="#CCCCCC"> or shoot</font>

425
00:26:34,430 --> 00:26:41,550
but the Jaya Jaya is<font color="#CCCCCC"> a very important</font>

426
00:26:37,980 --> 00:26:46,620
<font color="#E5E5E5">field and them they try transparent and</font>

427
00:26:41,550 --> 00:26:48,450
<font color="#CCCCCC">yum</font><font color="#E5E5E5"> server this field</font><font color="#CCCCCC"> if it's</font><font color="#E5E5E5"> always</font>

428
00:26:46,620 --> 00:26:51,840
<font color="#CCCCCC">true</font><font color="#E5E5E5"> the username and the password will</font>

429
00:26:48,450 --> 00:26:59,310
<font color="#E5E5E5">be picked up from the current local user</font>

430
00:26:51,840 --> 00:27:02,340
creations so the process of defining

431
00:26:59,310 --> 00:27:05,520
tried transparent and general server is

432
00:27:02,340 --> 00:27:08,730
<font color="#E5E5E5">two-step process the first step is</font>

433
00:27:05,520 --> 00:27:12,960
determined by the supports chance

434
00:27:08,730 --> 00:27:18,770
<font color="#E5E5E5">parents authentication and another one</font>

435
00:27:12,960 --> 00:27:23,540
is the<font color="#E5E5E5"> trustee</font><font color="#CCCCCC"> data is the trusted</font><font color="#E5E5E5"> asset</font>

436
00:27:18,770 --> 00:27:27,870
<font color="#E5E5E5">we can see we</font><font color="#CCCCCC"> can see</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> called the</font>

437
00:27:23,540 --> 00:27:31,290
selenium<font color="#E5E5E5"> say is just addressed the</font>

438
00:27:27,870 --> 00:27:34,260
function is always returned to so the

439
00:27:31,290 --> 00:27:36,450
<font color="#E5E5E5">Transpac</font><font color="#CCCCCC"> to transparent parents and</font>

440
00:27:34,260 --> 00:27:44,510
young Sarah is always<font color="#E5E5E5"> true on the</font>

441
00:27:36,450 --> 00:27:47,640
windows let's look at the<font color="#E5E5E5"> process of SMB</font>

442
00:27:44,510 --> 00:27:51,290
credentials<font color="#E5E5E5"> reflect attack the attacker</font>

443
00:27:47,640 --> 00:27:55,200
is a HTTP server that<font color="#E5E5E5"> require an</font>

444
00:27:51,290 --> 00:27:59,100
authentication the victim is the<font color="#E5E5E5"> machine</font>

445
00:27:55,200 --> 00:28:02,760
<font color="#CCCCCC">that provides SMB server</font><font color="#E5E5E5"> it can</font><font color="#CCCCCC"> be it</font>

446
00:27:59,100 --> 00:28:05,250
can be a server or PC because<font color="#E5E5E5"> the SMB</font>

447
00:28:02,760 --> 00:28:09,030
services is provided<font color="#CCCCCC"> by default</font><font color="#E5E5E5"> on</font>

448
00:28:05,250 --> 00:28:11,700
Windows the victims and they<font color="#E5E5E5"> request</font><font color="#CCCCCC"> the</font>

449
00:28:09,030 --> 00:28:14,310
<font color="#CCCCCC">packet</font><font color="#E5E5E5"> as shown in the picture which</font><font color="#CCCCCC"> is</font>

450
00:28:11,700 --> 00:28:18,170
<font color="#E5E5E5">the first step in an tiem authentication</font>

451
00:28:14,310 --> 00:28:22,200
<font color="#E5E5E5">some flags are said in the</font><font color="#CCCCCC"> local shop no</font>

452
00:28:18,170 --> 00:28:24,450
<font color="#E5E5E5">in the negation</font><font color="#CCCCCC"> 8</font><font color="#E5E5E5"> flags field and the</font>

453
00:28:22,200 --> 00:28:26,910
current computer name and<font color="#CCCCCC"> bro</font><font color="#E5E5E5"> and the</font>

454
00:28:24,450 --> 00:28:29,880
operating<font color="#E5E5E5"> system routing are the same</font>

455
00:28:26,910 --> 00:28:34,970
provided the information is encoded by

456
00:28:29,880 --> 00:28:38,600
<font color="#CCCCCC">the six-four and send in the</font>

457
00:28:34,970 --> 00:28:41,720
<font color="#E5E5E5">authorization</font><font color="#CCCCCC"> fired in the HTTP handle</font>

458
00:28:38,600 --> 00:28:45,350
after<font color="#CCCCCC"> the attack</font><font color="#E5E5E5"> reserved a victim and</font>

459
00:28:41,720 --> 00:28:47,190
<font color="#CCCCCC">SSP negotiation</font><font color="#E5E5E5"> it does the same thing</font>

460
00:28:45,350 --> 00:28:51,600
<font color="#E5E5E5">with the</font><font color="#CCCCCC"> works</font>

461
00:28:47,190 --> 00:28:57,540
as an SMB services but system is the SM

462
00:28:51,600 --> 00:29:00,389
<font color="#E5E5E5">ng MSSP negotiated over the SMB the</font>

463
00:28:57,540 --> 00:29:02,280
victim returns the<font color="#E5E5E5"> antium challenging to</font>

464
00:29:00,390 --> 00:29:05,280
<font color="#E5E5E5">the attacker the attack doesn't</font>

465
00:29:02,280 --> 00:29:08,220
<font color="#E5E5E5">immediately take the tech a tapestry</font>

466
00:29:05,280 --> 00:29:11,879
<font color="#E5E5E5">operation of after</font><font color="#CCCCCC"> reserving</font><font color="#E5E5E5"> the</font>

467
00:29:08,220 --> 00:29:15,510
challenge<font color="#CCCCCC"> party instead we balance data</font>

468
00:29:11,880 --> 00:29:18,750
storage<font color="#CCCCCC"> the challenge</font><font color="#E5E5E5"> we need</font><font color="#CCCCCC"> to pay</font>

469
00:29:15,510 --> 00:29:26,360
attention to<font color="#E5E5E5"> the negotiate flags at this</font>

470
00:29:18,750 --> 00:29:28,980
time as<font color="#E5E5E5"> the pictures</font><font color="#CCCCCC"> shoot its the ACA</font>

471
00:29:26,360 --> 00:29:31,919
<font color="#E5E5E5">the attack will</font><font color="#CCCCCC"> return</font><font color="#E5E5E5"> the challenging</font>

472
00:29:28,980 --> 00:29:35,730
or been abandoned in the Provost<font color="#E5E5E5"> step to</font>

473
00:29:31,920 --> 00:29:38,160
the HDD based on him at indication in

474
00:29:35,730 --> 00:29:41,610
this step attack are not<font color="#E5E5E5"> only transport</font>

475
00:29:38,160 --> 00:29:44,480
<font color="#E5E5E5">and him challenging</font><font color="#CCCCCC"> and challenging but</font>

476
00:29:41,610 --> 00:29:48,120
<font color="#CCCCCC">also motive</font><font color="#E5E5E5"> files a negotiated flags</font>

477
00:29:44,480 --> 00:29:50,460
please<font color="#E5E5E5"> pay attention to the</font><font color="#CCCCCC"> picture the</font>

478
00:29:48,120 --> 00:29:54,919
type to message returns the attack at

479
00:29:50,460 --> 00:30:01,370
system<font color="#CCCCCC"> to not the negotiate</font><font color="#E5E5E5"> flags become</font>

480
00:29:54,920 --> 00:30:01,370
become the<font color="#E5E5E5"> ACA</font><font color="#CCCCCC"> why</font><font color="#E5E5E5"> modified those flag</font>

481
00:30:01,790 --> 00:30:05,490
the flag<font color="#CCCCCC"> changed from the ACA to a</font>

482
00:30:04,830 --> 00:30:08,699
thorough

483
00:30:05,490 --> 00:30:11,280
we know that the boundary of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> say is</font>

484
00:30:08,700 --> 00:30:14,850
<font color="#E5E5E5">the</font><font color="#CCCCCC"> one one they're all they're all</font><font color="#E5E5E5"> we</font>

485
00:30:11,280 --> 00:30:18,960
change<font color="#E5E5E5"> tube is both of them</font><font color="#CCCCCC"> changed from</font>

486
00:30:14,850 --> 00:30:21,080
the one to<font color="#E5E5E5"> zero</font><font color="#CCCCCC"> so so there is a flag</font>

487
00:30:18,960 --> 00:30:24,870
<font color="#E5E5E5">from the setting to</font><font color="#CCCCCC"> unexciting</font>

488
00:30:21,080 --> 00:30:28,110
there are two<font color="#E5E5E5"> flags represent the one is</font>

489
00:30:24,870 --> 00:30:36,389
the<font color="#CCCCCC"> negotiate it always sigh and another</font>

490
00:30:28,110 --> 00:30:40,229
one is and and it is why we<font color="#CCCCCC"> need to</font><font color="#E5E5E5"> why</font>

491
00:30:36,390 --> 00:30:44,400
we<font color="#E5E5E5"> need to change the change the change</font>

492
00:30:40,230 --> 00:30:48,690
<font color="#CCCCCC">debate</font><font color="#E5E5E5"> because we need to because we</font>

493
00:30:44,400 --> 00:30:53,340
don't<font color="#CCCCCC"> know the</font><font color="#E5E5E5"> single nature so so we so</font>

494
00:30:48,690 --> 00:30:54,450
<font color="#CCCCCC">we understand today's flag and then we</font>

495
00:30:53,340 --> 00:30:59,039
want

496
00:30:54,450 --> 00:31:01,499
and then we need to<font color="#E5E5E5"> spoof in the server</font>

497
00:30:59,039 --> 00:31:09,210
and<font color="#E5E5E5"> the client are not not</font><font color="#CCCCCC"> on the same</font>

498
00:31:01,499 --> 00:31:12,210
machine<font color="#E5E5E5"> so we change the two flags after</font>

499
00:31:09,210 --> 00:31:14,489
<font color="#E5E5E5">and after</font><font color="#CCCCCC"> the victim reserves the</font>

500
00:31:12,210 --> 00:31:17,489
challenges in the<font color="#CCCCCC"> bad attacker it will</font>

501
00:31:14,489 --> 00:31:20,190
use the<font color="#E5E5E5"> current net</font><font color="#CCCCCC"> Hashi to</font><font color="#E5E5E5"> pro-forma</font>

502
00:31:17,489 --> 00:31:23,489
<font color="#E5E5E5">some Hasek calculation on</font><font color="#CCCCCC"> the challenge</font>

503
00:31:20,190 --> 00:31:26,549
<font color="#E5E5E5">and then get the</font><font color="#CCCCCC"> NTM response to eat and</font>

504
00:31:23,489 --> 00:31:31,049
to the attacker<font color="#E5E5E5"> this is an tiem</font>

505
00:31:26,549 --> 00:31:34,049
authentication of<font color="#E5E5E5"> the HTTP the attacker</font>

506
00:31:31,049 --> 00:31:37,350
<font color="#CCCCCC">then forwards the engine response</font><font color="#E5E5E5"> to the</font>

507
00:31:34,049 --> 00:31:40,080
victim SMB services complaint in the

508
00:31:37,350 --> 00:31:43,908
process of the<font color="#E5E5E5"> forwarding the victim on</font>

509
00:31:40,080 --> 00:31:46,408
<font color="#CCCCCC">Croatian</font><font color="#E5E5E5"> to the victim after</font><font color="#CCCCCC"> the SMB</font>

510
00:31:43,909 --> 00:31:50,700
authenticated by the attacker<font color="#E5E5E5"> some</font>

511
00:31:46,409 --> 00:31:59,999
servers are started by using the RPC<font color="#E5E5E5"> we</font>

512
00:31:50,700 --> 00:32:02,129
can as family<font color="#CCCCCC"> at weekend RCE</font><font color="#E5E5E5"> let's see</font>

513
00:31:59,999 --> 00:32:05,009
<font color="#E5E5E5">us a more real-world attacker case I</font>

514
00:32:02,129 --> 00:32:08,340
found<font color="#CCCCCC"> the xxe one ability in the Apache</font>

515
00:32:05,009 --> 00:32:13,139
project<font color="#CCCCCC"> named in production some times</font>

516
00:32:08,340 --> 00:32:17,330
ago<font color="#CCCCCC"> I used the xxe to complete the SAT</font>

517
00:32:13,139 --> 00:32:22,850
<font color="#E5E5E5">with</font><font color="#CCCCCC"> check</font><font color="#E5E5E5"> vector</font><font color="#CCCCCC"> e we mentioned earlier</font>

518
00:32:17,330 --> 00:32:29,570
<font color="#E5E5E5">and this pro this pro product has the</font>

519
00:32:22,850 --> 00:32:32,730
<font color="#CCCCCC">xxe one ability in the Java in the Java</font>

520
00:32:29,570 --> 00:32:36,178
<font color="#CCCCCC">xx</font><font color="#E5E5E5"> even ability we usually use it to</font>

521
00:32:32,730 --> 00:32:40,169
read<font color="#E5E5E5"> files or</font><font color="#CCCCCC"> denying servers deny</font>

522
00:32:36,179 --> 00:32:45,690
services but they are limit<font color="#E5E5E5"> now we are</font>

523
00:32:40,169 --> 00:32:48,149
talking talking<font color="#CCCCCC"> a lot but it Hawking</font>

524
00:32:45,690 --> 00:32:51,859
it's cheap I will show me the<font color="#E5E5E5"> share</font>

525
00:32:48,149 --> 00:32:51,859
let's look at the demo

526
00:32:54,960 --> 00:33:04,760
<font color="#E5E5E5">okay the attacker</font><font color="#CCCCCC"> IP address and the</font>

527
00:33:00,000 --> 00:33:04,760
<font color="#E5E5E5">attacker wrong they choose the</font><font color="#CCCCCC"> relators</font>

528
00:33:06,830 --> 00:33:23,159
and then they is<font color="#CCCCCC"> the</font><font color="#E5E5E5"> XFL you stay client</font>

529
00:33:17,430 --> 00:33:25,340
to open the XFL and<font color="#CCCCCC"> the attack can say</font>

530
00:33:23,160 --> 00:33:28,560
<font color="#E5E5E5">user and</font><font color="#CCCCCC"> iam Hoshi</font>

531
00:33:25,340 --> 00:33:32,730
this is<font color="#E5E5E5"> indium</font><font color="#CCCCCC"> Hoshi not the net and</font><font color="#E5E5E5"> the</font>

532
00:33:28,560 --> 00:33:35,629
mihashi attack I used<font color="#E5E5E5"> a Hershey to pass</font>

533
00:33:32,730 --> 00:33:35,630
the hash attack

534
00:33:50,140 --> 00:33:54,660
we can say the calculator is<font color="#CCCCCC"> popping up</font>

535
00:33:57,120 --> 00:34:05,110
okay so how<font color="#CCCCCC"> to defend against the</font><font color="#E5E5E5"> Indian</font>

536
00:34:01,780 --> 00:34:07,330
relay for the<font color="#E5E5E5"> client-side I suggested</font>

537
00:34:05,110 --> 00:34:12,040
they<font color="#E5E5E5"> disable to automatically logging in</font>

538
00:34:07,330 --> 00:34:15,850
<font color="#CCCCCC">Internet and is able</font><font color="#E5E5E5"> to wpad if you</font>

539
00:34:12,040 --> 00:34:18,520
don't want to use the<font color="#E5E5E5"> smbs or if you</font>

540
00:34:15,850 --> 00:34:22,168
don't need<font color="#E5E5E5"> to provide SMB services you</font>

541
00:34:18,520 --> 00:34:28,780
can block the<font color="#E5E5E5"> four four or five port and</font>

542
00:34:22,168 --> 00:34:32,649
also<font color="#CCCCCC"> you can plug the 1 3 8</font><font color="#E5E5E5"> and 1 3 7</font><font color="#CCCCCC"> &</font>

543
00:34:28,780 --> 00:34:36,669
8<font color="#E5E5E5"> port where the firewall for</font><font color="#CCCCCC"> the server</font>

544
00:34:32,649 --> 00:34:39,100
side<font color="#CCCCCC"> you can enable the SMB</font><font color="#E5E5E5"> side but the</font>

545
00:34:36,668 --> 00:34:43,149
SMB sign is enabled by<font color="#E5E5E5"> default</font>

546
00:34:39,100 --> 00:34:47,080
<font color="#CCCCCC">MVC</font><font color="#E5E5E5"> if you are not DC you need to you</font>

547
00:34:43,149 --> 00:34:49,810
need to<font color="#CCCCCC"> open</font><font color="#E5E5E5"> it you</font><font color="#CCCCCC"> need to</font><font color="#E5E5E5"> enable it by</font>

548
00:34:47,080 --> 00:34:53,199
yourself and<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> exchange for</font><font color="#E5E5E5"> the</font>

549
00:34:49,810 --> 00:34:56,109
exchange web servers exchange web server

550
00:34:53,199 --> 00:34:56,859
should be built in the<font color="#E5E5E5"> build in the</font>

551
00:34:56,109 --> 00:35:01,680
Internet

552
00:34:56,859 --> 00:35:08,290
if the EWS<font color="#E5E5E5"> if the EWS is a not used</font>

553
00:35:01,680 --> 00:35:12,419
<font color="#E5E5E5">disable 6xn seat here is our material</font>

554
00:35:08,290 --> 00:35:12,420
refer reference<font color="#E5E5E5"> thank you all guys</font>

555
00:35:14,430 --> 00:35:21,310
special today I was special to<font color="#E5E5E5"> the</font>

556
00:35:18,700 --> 00:35:23,680
following<font color="#CCCCCC"> people on the</font><font color="#E5E5E5"> thumb keeper and</font>

557
00:35:21,310 --> 00:35:26,109
the flower code during<font color="#CCCCCC"> all our</font>

558
00:35:23,680 --> 00:35:29,080
<font color="#CCCCCC">researching we have a give us</font><font color="#E5E5E5"> a mainly</font>

559
00:35:26,109 --> 00:35:31,750
used for<font color="#E5E5E5"> advisor there are also a lot of</font>

560
00:35:29,080 --> 00:35:36,310
<font color="#CCCCCC">awesome terms to help me complete this</font>

561
00:35:31,750 --> 00:35:41,980
research is the impact<font color="#E5E5E5"> and the responder</font>

562
00:35:36,310 --> 00:35:45,520
and until I am<font color="#CCCCCC"> related to</font><font color="#E5E5E5"> e WS</font><font color="#CCCCCC"> ok thank</font>

563
00:35:41,980 --> 00:35:48,380
you<font color="#E5E5E5"> for</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> attention is any questions</font>

564
00:35:45,520 --> 00:36:23,909
[Applause]

565
00:35:48,380 --> 00:36:23,909
[Music]

