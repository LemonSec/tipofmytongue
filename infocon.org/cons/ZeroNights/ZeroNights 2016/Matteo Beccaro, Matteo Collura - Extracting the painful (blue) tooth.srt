1
00:00:00,199 --> 00:00:20,420
<font color="#E5E5E5">my terremoto a slow start ok hello okay</font>

2
00:00:17,390 --> 00:00:23,609
hello everyone thanks for coming<font color="#E5E5E5"> and</font>

3
00:00:20,420 --> 00:00:28,289
let's start because we are already a

4
00:00:23,609 --> 00:00:32,219
little<font color="#E5E5E5"> bit late and I am Mateo Vacarro</font>

5
00:00:28,289 --> 00:00:35,040
and I am CTO in a company i'm starting

6
00:00:32,219 --> 00:00:38,210
in Italian and we do like offensive

7
00:00:35,040 --> 00:00:42,360
physical security in among other service

8
00:00:38,210 --> 00:00:45,090
this<font color="#CCCCCC"> is my twitter ID if you want get in</font>

9
00:00:42,360 --> 00:00:47,910
touch for comments or whatever feedback

10
00:00:45,090 --> 00:00:55,969
from the presentation and i live now the

11
00:00:47,910 --> 00:01:00,410
word to my colleague<font color="#CCCCCC"> Motoko Laura hello</font>

12
00:00:55,969 --> 00:01:03,860
<font color="#E5E5E5">I'm Mateo</font><font color="#CCCCCC"> colora i'm a student at</font>

13
00:01:00,410 --> 00:01:07,380
politecnico of Turin it's a university

14
00:01:03,860 --> 00:01:11,240
in<font color="#E5E5E5"> italy and i'm studying electronic</font>

15
00:01:07,380 --> 00:01:14,640
engineering<font color="#CCCCCC"> i plan</font><font color="#E5E5E5"> to move maybe to</font>

16
00:01:11,240 --> 00:01:19,039
Switzerland next year and I'm a

17
00:01:14,640 --> 00:01:24,140
researcher<font color="#CCCCCC"> in multiple fields and we</font>

18
00:01:19,040 --> 00:01:26,780
together worked for several projects and

19
00:01:24,140 --> 00:01:32,810
today we are going to speak about

20
00:01:26,780 --> 00:01:36,420
bluetooth so i will introduce what is

21
00:01:32,810 --> 00:01:40,799
<font color="#CCCCCC">Bluetooth just some little details not</font>

22
00:01:36,420 --> 00:01:45,420
so boring and some known and unknown

23
00:01:40,799 --> 00:01:49,770
<font color="#E5E5E5">risks so a little bit of history so</font>

24
00:01:45,420 --> 00:01:54,899
let's start<font color="#E5E5E5"> Bluetooth is a world</font>

25
00:01:49,770 --> 00:01:57,990
standard and it is born well it has

26
00:01:54,899 --> 00:02:02,430
almost 20 years because the first

27
00:01:57,990 --> 00:02:06,780
version was in 1994 and it uses short

28
00:02:02,430 --> 00:02:11,160
<font color="#E5E5E5">wavelength</font><font color="#CCCCCC"> ultra-high frequency from 2.4</font>

29
00:02:06,780 --> 00:02:12,069
22.4 eighty five gigahertz and 79

30
00:02:11,160 --> 00:02:15,459
channels

31
00:02:12,069 --> 00:02:18,638
to allow<font color="#CCCCCC"> the communication with an</font>

32
00:02:15,459 --> 00:02:21,700
adaptive<font color="#CCCCCC"> frequency hopping procedure so</font>

33
00:02:18,639 --> 00:02:24,370
that if there<font color="#E5E5E5"> is a channel with some</font>

34
00:02:21,700 --> 00:02:27,849
interference it can jump to another one

35
00:02:24,370 --> 00:02:31,719
and<font color="#CCCCCC"> make the communication easier the</font>

36
00:02:27,849 --> 00:02:35,219
name comes from a king of denmark Harald

37
00:02:31,719 --> 00:02:39,489
Bluetooth so I say it is some

38
00:02:35,219 --> 00:02:43,030
Scandinavian humor those are some<font color="#E5E5E5"> rooms</font>

39
00:02:39,489 --> 00:02:46,959
for the<font color="#E5E5E5"> Danish health but they put</font>

40
00:02:43,030 --> 00:02:50,189
<font color="#CCCCCC">together it is a layer protocol</font>

41
00:02:46,959 --> 00:02:55,060
architecture so basically you choose

42
00:02:50,189 --> 00:02:57,250
your protocols and you in pile them you

43
00:02:55,060 --> 00:03:00,579
so you start from a physical layer then

44
00:02:57,250 --> 00:03:02,650
you need a baseband<font color="#E5E5E5"> and then of course a</font>

45
00:03:00,579 --> 00:03:05,430
link manager to manage the connections

46
00:03:02,650 --> 00:03:10,150
and then you can do whatever you want

47
00:03:05,430 --> 00:03:14,379
audio applications telephony other kind

48
00:03:10,150 --> 00:03:17,109
of protocols draw a lot of them during

49
00:03:14,379 --> 00:03:20,590
those 20 more<font color="#CCCCCC"> than 20 years there has</font>

50
00:03:17,109 --> 00:03:23,709
been<font color="#E5E5E5"> a lot of updates and starting from</font>

51
00:03:20,590 --> 00:03:26,590
the first versions the<font color="#E5E5E5"> version</font><font color="#CCCCCC"> one well</font>

52
00:03:23,709 --> 00:03:30,340
there are<font color="#E5E5E5"> some important updates the</font>

53
00:03:26,590 --> 00:03:34,049
mandatory<font color="#CCCCCC"> BD</font><font color="#E5E5E5"> address something like mac</font>

54
00:03:30,340 --> 00:03:37,209
address well you may think it is obvious

55
00:03:34,049 --> 00:03:40,689
of<font color="#CCCCCC"> course it is we need a physical</font>

56
00:03:37,209 --> 00:03:43,209
<font color="#CCCCCC">address to connect our devices then the</font>

57
00:03:40,689 --> 00:03:49,599
I Triple E decided to make it a standard

58
00:03:43,209 --> 00:03:52,590
in 2002 than other updates regarding the

59
00:03:49,599 --> 00:03:56,018
adaptive the frequency hopping and some

60
00:03:52,590 --> 00:03:59,799
<font color="#E5E5E5">what some of these features regarding</font>

61
00:03:56,019 --> 00:04:04,379
<font color="#CCCCCC">the connection and let's say how</font><font color="#E5E5E5"> to make</font>

62
00:03:59,799 --> 00:04:08,199
<font color="#CCCCCC">it easy</font><font color="#E5E5E5"> and resistant doing differences</font>

63
00:04:04,379 --> 00:04:13,030
then they made such updates to announce

64
00:04:08,199 --> 00:04:16,209
the data rate that was going to be

65
00:04:13,030 --> 00:04:20,798
transferred so<font color="#E5E5E5"> a faster data transfer</font>

66
00:04:16,209 --> 00:04:23,080
with version<font color="#E5E5E5"> 2.0 from version 2.1 there</font>

67
00:04:20,798 --> 00:04:25,969
is a<font color="#E5E5E5"> very important update we will</font>

68
00:04:23,080 --> 00:04:29,510
discuss about the<font color="#E5E5E5"> paving procedure</font>

69
00:04:25,970 --> 00:04:32,470
this update fixed a lot of important

70
00:04:29,510 --> 00:04:37,700
vulnerabilities I will show you later

71
00:04:32,470 --> 00:04:40,400
then from version<font color="#E5E5E5"> 3.2 well I</font><font color="#CCCCCC"> think that</font>

72
00:04:37,700 --> 00:04:42,500
the most important update was version

73
00:04:40,400 --> 00:04:45,429
four point oh which included the

74
00:04:42,500 --> 00:04:50,210
<font color="#E5E5E5">bluetooth low energy that is now</font>

75
00:04:45,430 --> 00:04:54,130
commonly used in such I of the devices

76
00:04:50,210 --> 00:04:56,810
wearable technologies they are using

77
00:04:54,130 --> 00:05:00,440
always the low-energy protocol because

78
00:04:56,810 --> 00:05:02,750
it is better<font color="#E5E5E5"> from the point of view of</font>

79
00:05:00,440 --> 00:05:06,530
consumptions because it has lower

80
00:05:02,750 --> 00:05:11,660
consumptions and easier to<font color="#E5E5E5"> implement to</font>

81
00:05:06,530 --> 00:05:15,080
be implemented so let's let's speak

82
00:05:11,660 --> 00:05:18,050
about some vulnerabilities I think<font color="#E5E5E5"> this</font>

83
00:05:15,080 --> 00:05:20,810
one was one of the most important well

84
00:05:18,050 --> 00:05:24,740
the most important was the following<font color="#CCCCCC"> one</font>

85
00:05:20,810 --> 00:05:28,370
but from here it all started it was

86
00:05:24,740 --> 00:05:33,590
discovered<font color="#E5E5E5"> in late 2003 and discovered</font>

87
00:05:28,370 --> 00:05:35,930
by<font color="#CCCCCC"> holtmann and</font><font color="#E5E5E5"> Laurie and it was</font>

88
00:05:33,590 --> 00:05:40,060
<font color="#CCCCCC">regarding the Bluetooth implementation</font>

89
00:05:35,930 --> 00:05:45,290
on mobile phones<font color="#E5E5E5"> and pocket pawns and</font>

90
00:05:40,060 --> 00:05:50,150
this vulnerability exploited the<font color="#CCCCCC"> obits</font>

91
00:05:45,290 --> 00:05:55,070
protocol well neobux protocol was used

92
00:05:50,150 --> 00:05:58,820
to send files and request files in a

93
00:05:55,070 --> 00:06:02,090
transfer of data and they<font color="#E5E5E5"> discovered</font>

94
00:05:58,820 --> 00:06:05,930
<font color="#CCCCCC">that if you know</font><font color="#E5E5E5"> exactly where the path</font>

95
00:06:02,090 --> 00:06:09,770
of your file was located was stored if

96
00:06:05,930 --> 00:06:12,530
you made a get request to that file<font color="#CCCCCC"> you</font>

97
00:06:09,770 --> 00:06:14,510
were allowed to easily to download that

98
00:06:12,530 --> 00:06:18,289
file to get that file from<font color="#CCCCCC"> the other</font>

99
00:06:14,510 --> 00:06:21,260
device without any prompt on<font color="#CCCCCC"> the other</font>

100
00:06:18,290 --> 00:06:23,900
device so in no authentication was

101
00:06:21,260 --> 00:06:27,169
needed so<font color="#CCCCCC"> just you had just to know</font>

102
00:06:23,900 --> 00:06:30,880
where the file was located at the time

103
00:06:27,169 --> 00:06:35,210
on<font color="#E5E5E5"> the pocket pocket palm with the</font>

104
00:06:30,880 --> 00:06:37,909
mobile OS<font color="#CCCCCC"> window mobile on it the first</font>

105
00:06:35,210 --> 00:06:39,229
versions it was easy to spot where the

106
00:06:37,910 --> 00:06:42,320
for example the con

107
00:06:39,230 --> 00:06:46,640
that's were stored so<font color="#CCCCCC"> we were able to</font>

108
00:06:42,320 --> 00:06:50,599
<font color="#E5E5E5">download to dump the contacts and this</font>

109
00:06:46,640 --> 00:06:55,250
kind<font color="#E5E5E5"> of data this vulnerability okay</font>

110
00:06:50,600 --> 00:07:00,860
this was a simple scheme as you can see

111
00:06:55,250 --> 00:07:03,170
you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> bypass this this block</font><font color="#CCCCCC"> or there</font>

112
00:07:00,860 --> 00:07:05,630
is a security manager the control

113
00:07:03,170 --> 00:07:09,730
because you you were allowed just to

114
00:07:05,630 --> 00:07:12,230
force the request to get your file but

115
00:07:09,730 --> 00:07:16,880
this was the<font color="#E5E5E5"> most important I think</font>

116
00:07:12,230 --> 00:07:22,310
because the year after Martin Harford

117
00:07:16,880 --> 00:07:24,320
joined Adam<font color="#CCCCCC"> Laurie in in studying about</font>

118
00:07:22,310 --> 00:07:28,520
those vulnerabilities and they present

119
00:07:24,320 --> 00:07:31,849
it at<font color="#E5E5E5"> Def Con 12 this big</font><font color="#CCCCCC"> Verner ability</font>

120
00:07:28,520 --> 00:07:37,490
it was a security loophole in which you

121
00:07:31,850 --> 00:07:41,900
were able<font color="#E5E5E5"> to send proper commons to a</font>

122
00:07:37,490 --> 00:07:45,890
certain device through a plain serial

123
00:07:41,900 --> 00:07:49,849
connection I mean you were<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to force</font>

124
00:07:45,890 --> 00:07:53,150
the device the victim device to execute

125
00:07:49,850 --> 00:07:56,420
some comments and you were able for

126
00:07:53,150 --> 00:08:00,020
example to make it ring or to send

127
00:07:56,420 --> 00:08:05,690
pictures<font color="#CCCCCC"> without any prompt on the user</font>

128
00:08:00,020 --> 00:08:08,630
side just sending sending comments

129
00:08:05,690 --> 00:08:10,340
through a plain serial connection so I

130
00:08:08,630 --> 00:08:14,060
don't know<font color="#CCCCCC"> if you remember if you ever</font>

131
00:08:10,340 --> 00:08:18,799
<font color="#CCCCCC">upon the symbian OS phone but it was one</font>

132
00:08:14,060 --> 00:08:21,770
<font color="#CCCCCC">of the most let's say exploit the</font>

133
00:08:18,800 --> 00:08:25,010
vulnerabilities this one to dump the

134
00:08:21,770 --> 00:08:28,370
pictures of your victim phone and I

135
00:08:25,010 --> 00:08:32,599
played a lot<font color="#E5E5E5"> on this I remember and it</font>

136
00:08:28,370 --> 00:08:36,289
was very fun and another one very

137
00:08:32,599 --> 00:08:40,669
important was<font color="#E5E5E5"> blowjob well it was used</font>

138
00:08:36,289 --> 00:08:44,750
to<font color="#CCCCCC"> disrupt a piconet so a connection</font>

139
00:08:40,669 --> 00:08:49,430
between multiple devices and actually it

140
00:08:44,750 --> 00:08:51,200
worked because if you try<font color="#E5E5E5"> to insert</font>

141
00:08:49,430 --> 00:08:55,370
inside this pic on it

142
00:08:51,200 --> 00:08:57,560
and sending the master our<font color="#CCCCCC"> requests just</font>

143
00:08:55,370 --> 00:09:00,200
a simple<font color="#CCCCCC"> request of contact hey I want</font>

144
00:08:57,560 --> 00:09:04,160
<font color="#E5E5E5">to I hate this is your</font><font color="#CCCCCC"> pic on it I'm</font>

145
00:09:00,200 --> 00:09:06,830
here the master was<font color="#E5E5E5"> confused about that</font>

146
00:09:04,160 --> 00:09:10,550
request because he cannot recognize it

147
00:09:06,830 --> 00:09:14,390
and the connection was destroyed but

148
00:09:10,550 --> 00:09:16,579
let's analyze now some procedures the

149
00:09:14,390 --> 00:09:20,720
<font color="#CCCCCC">paving procedures that were fixed that</font>

150
00:09:16,580 --> 00:09:25,400
just with version 2.1 this was important

151
00:09:20,720 --> 00:09:28,820
because as<font color="#CCCCCC"> you can see from this</font><font color="#E5E5E5"> little</font>

152
00:09:25,400 --> 00:09:32,360
picture the paving procedure was done in

153
00:09:28,820 --> 00:09:35,650
<font color="#E5E5E5">this way the first device sends to the</font>

154
00:09:32,360 --> 00:09:38,600
second<font color="#E5E5E5"> one which one to pay to the first</font>

155
00:09:35,650 --> 00:09:41,900
random number he was supposed to

156
00:09:38,600 --> 00:09:44,900
<font color="#E5E5E5">generate random number at this point by</font>

157
00:09:41,900 --> 00:09:49,100
evaluating with a proper algorithm and

158
00:09:44,900 --> 00:09:53,720
taking<font color="#E5E5E5"> into account the mac address of</font>

159
00:09:49,100 --> 00:09:59,900
the device was asking to pair both the

160
00:09:53,720 --> 00:10:03,650
tude generated k in it value with this

161
00:09:59,900 --> 00:10:07,250
value they generated a link the link he

162
00:10:03,650 --> 00:10:10,069
used to pair the two devices but at this

163
00:10:07,250 --> 00:10:14,720
point there is something missing no one

164
00:10:10,070 --> 00:10:22,010
is checking if the two link is our thing

165
00:10:14,720 --> 00:10:25,270
and this is a face it's not good and the

166
00:10:22,010 --> 00:10:28,970
authentication which was the next phase

167
00:10:25,270 --> 00:10:32,569
the next step in order to establish a

168
00:10:28,970 --> 00:10:35,600
connection actually worked like this the

169
00:10:32,570 --> 00:10:40,210
first device generated a random number

170
00:10:35,600 --> 00:10:43,060
and saddened to the device who asked to

171
00:10:40,210 --> 00:10:48,590
<font color="#E5E5E5">connect to the first one to authenticate</font>

172
00:10:43,060 --> 00:10:52,790
then this<font color="#E5E5E5"> number as res was evaluated</font>

173
00:10:48,590 --> 00:10:57,170
with the mac address of the claimant

174
00:10:52,790 --> 00:10:59,180
device and sent back<font color="#E5E5E5"> to the verifier at</font>

175
00:10:57,170 --> 00:11:03,819
this point the verifier already

176
00:10:59,180 --> 00:11:07,160
calculated the same s res and oops

177
00:11:03,820 --> 00:11:09,260
checks if they are the same<font color="#E5E5E5"> at the</font><font color="#CCCCCC"> pond</font>

178
00:11:07,160 --> 00:11:12,319
at<font color="#E5E5E5"> this point if they are the</font><font color="#CCCCCC"> same the</font>

179
00:11:09,260 --> 00:11:16,280
two device are authenticated by version

180
00:11:12,320 --> 00:11:19,070
2.1 this is the pay ring the craving

181
00:11:16,280 --> 00:11:21,230
procedure was improved<font color="#E5E5E5"> and there was an</font>

182
00:11:19,070 --> 00:11:24,890
additional<font color="#E5E5E5"> check which was missing in</font>

183
00:11:21,230 --> 00:11:28,250
the in the<font color="#E5E5E5"> previous and that way the</font>

184
00:11:24,890 --> 00:11:30,770
random numbers exchanged were actually

185
00:11:28,250 --> 00:11:33,880
two well the first<font color="#E5E5E5"> device the initiate</font>

186
00:11:30,770 --> 00:11:36,590
the initiating one was sending its own

187
00:11:33,880 --> 00:11:39,560
random number<font color="#E5E5E5"> and the nura initiating</font>

188
00:11:36,590 --> 00:11:44,870
device or sending its own random number

189
00:11:39,560 --> 00:11:46,969
then those two<font color="#E5E5E5"> values were combined in a</font>

190
00:11:44,870 --> 00:11:49,550
devaluation of an another factor and

191
00:11:46,970 --> 00:11:52,820
after<font color="#E5E5E5"> all this procedure the two device</font>

192
00:11:49,550 --> 00:11:54,829
was working simultaneously and finally

193
00:11:52,820 --> 00:12:00,200
they produces a number and that number

194
00:11:54,830 --> 00:12:04,190
was displayed on the user side on their

195
00:12:00,200 --> 00:12:06,590
mobile or their device at<font color="#CCCCCC"> the point the</font>

196
00:12:04,190 --> 00:12:09,050
user decided to and compare the two

197
00:12:06,590 --> 00:12:11,420
numbers and and say<font color="#CCCCCC"> okay they are the</font>

198
00:12:09,050 --> 00:12:15,319
same we can start the connection press

199
00:12:11,420 --> 00:12:19,270
the ok button and this was the<font color="#CCCCCC"> update</font>

200
00:12:15,320 --> 00:12:19,270
the essential update for version 2.1

201
00:12:20,380 --> 00:12:26,750
regarding the<font color="#E5E5E5"> the new versions of</font>

202
00:12:22,550 --> 00:12:30,050
bluetooth so 4.0 we need to talk about

203
00:12:26,750 --> 00:12:34,220
<font color="#E5E5E5">this one that was an encryption bypass</font>

204
00:12:30,050 --> 00:12:36,770
and discovered by Mark Ryan the fact<font color="#E5E5E5"> is</font>

205
00:12:34,220 --> 00:12:42,230
that if you are<font color="#E5E5E5"> working</font><font color="#CCCCCC"> with Bluetooth</font>

206
00:12:36,770 --> 00:12:45,199
4.0 they invented a different way to

207
00:12:42,230 --> 00:12:48,080
exchange keys a different protocol not

208
00:12:45,200 --> 00:12:53,150
for example<font color="#CCCCCC"> the elliptic curve most used</font>

209
00:12:48,080 --> 00:12:55,280
button used that strange method starting

210
00:12:53,150 --> 00:12:58,100
from<font color="#E5E5E5"> pay ring they generate a temporary</font>

211
00:12:55,280 --> 00:13:00,770
key from that temporary key generates

212
00:12:58,100 --> 00:13:03,320
another key and the final one<font color="#CCCCCC"> that is</font>

213
00:13:00,770 --> 00:13:06,620
the<font color="#CCCCCC"> long-term key is the one used for</font>

214
00:13:03,320 --> 00:13:10,220
the connection the point is that from

215
00:13:06,620 --> 00:13:13,790
temporary key on the exchanging

216
00:13:10,220 --> 00:13:20,420
procedure is done over the<font color="#E5E5E5"> air in</font>

217
00:13:13,790 --> 00:13:27,050
text so if i get the temporary key I'm

218
00:13:20,420 --> 00:13:30,050
actually able to<font color="#E5E5E5"> get the longtime key so</font>

219
00:13:27,050 --> 00:13:32,750
let's<font color="#CCCCCC"> focus on the temporary key how can</font>

220
00:13:30,050 --> 00:13:36,140
<font color="#CCCCCC">we</font><font color="#E5E5E5"> get that there are three ways in</font>

221
00:13:32,750 --> 00:13:39,230
<font color="#CCCCCC">order to make the pay ring if you are</font>

222
00:13:36,140 --> 00:13:42,860
working<font color="#CCCCCC"> with</font><font color="#E5E5E5"> Bluetooth 4.0 and they are</font>

223
00:13:39,230 --> 00:13:46,130
just shown here just works six digit pin

224
00:13:42,860 --> 00:13:50,060
or out of band<font color="#E5E5E5"> okay if it is out of band</font>

225
00:13:46,130 --> 00:13:54,560
and we are not<font color="#E5E5E5"> focusing on that spectrum</font>

226
00:13:50,060 --> 00:13:58,069
band we are fucked up because we cannot

227
00:13:54,560 --> 00:14:00,770
intercept that key of course but if we

228
00:13:58,070 --> 00:14:05,480
<font color="#E5E5E5">are in just works the temporary key is</font>

229
00:14:00,770 --> 00:14:10,069
by default set to<font color="#E5E5E5"> zero so easy and if</font>

230
00:14:05,480 --> 00:14:14,630
there<font color="#E5E5E5"> is a pin 6 digit pin requested we</font>

231
00:14:10,070 --> 00:14:21,380
<font color="#E5E5E5">have a 108 bit number so it is from 0 to</font>

232
00:14:14,630 --> 00:14:27,890
9 9 9 and 9 99 padded to 128 bits so if

233
00:14:21,380 --> 00:14:30,710
we join those two cases with the i7

234
00:14:27,890 --> 00:14:32,000
processor just one car one second in

235
00:14:30,710 --> 00:14:35,390
order to brute force all<font color="#E5E5E5"> the</font>

236
00:14:32,000 --> 00:14:37,730
possibilities and try them out so it's

237
00:14:35,390 --> 00:14:41,120
easy I get a temporary key then the

238
00:14:37,730 --> 00:14:45,560
short time key in the long time key I I

239
00:14:41,120 --> 00:14:48,710
can break everything and this procedure

240
00:14:45,560 --> 00:14:52,160
is going to be computed offline because

241
00:14:48,710 --> 00:14:54,640
I will evaluate all the<font color="#CCCCCC"> possible all</font><font color="#E5E5E5"> the</font>

242
00:14:52,160 --> 00:14:58,760
possible values for my temporary key and

243
00:14:54,640 --> 00:15:01,610
that's<font color="#E5E5E5"> it so now i will leave the word</font>

244
00:14:58,760 --> 00:15:06,520
to my friend and<font color="#CCCCCC"> we show what we</font>

245
00:15:01,610 --> 00:15:06,520
actually did a for this research

246
00:15:10,070 --> 00:15:17,690
ok let's start introducing what the

247
00:15:14,070 --> 00:15:22,200
smart lock unlock is it's a feature

248
00:15:17,690 --> 00:15:25,170
introduced with the<font color="#CCCCCC"> android 5.8 in</font>

249
00:15:22,200 --> 00:15:28,740
Abel's the smartphone to be unlocked

250
00:15:25,170 --> 00:15:32,089
without user interaction the only thing

251
00:15:28,740 --> 00:15:35,460
<font color="#CCCCCC">is that</font><font color="#E5E5E5"> one of this condition must apply</font>

252
00:15:32,090 --> 00:15:39,780
for example we have the NFC unlock and

253
00:15:35,460 --> 00:15:42,270
so if we<font color="#E5E5E5"> tap on a tag previous</font><font color="#CCCCCC"> save it</font>

254
00:15:39,780 --> 00:15:45,030
<font color="#CCCCCC">and on the smartphone</font><font color="#E5E5E5"> the smartphone is</font>

255
00:15:42,270 --> 00:15:48,480
unlock then we have the face recognition

256
00:15:45,030 --> 00:15:50,640
unlock so it common feature if the

257
00:15:48,480 --> 00:15:52,620
camera with smartphone recognize the

258
00:15:50,640 --> 00:15:54,860
owner then the smartphone unlocked

259
00:15:52,620 --> 00:15:58,620
without the pin code of the<font color="#E5E5E5"> passcode</font>

260
00:15:54,860 --> 00:16:00,540
then we<font color="#E5E5E5"> have the body unlock the the</font>

261
00:15:58,620 --> 00:16:02,340
smartphone is in contact with<font color="#E5E5E5"> the body I</font>

262
00:16:00,540 --> 00:16:05,040
have no idea<font color="#CCCCCC"> why they implement this</font>

263
00:16:02,340 --> 00:16:07,290
thing because it<font color="#E5E5E5"> doesn't recognize if</font>

264
00:16:05,040 --> 00:16:10,860
the bodies of the owner of not of course

265
00:16:07,290 --> 00:16:14,520
so I don't know and then we have<font color="#E5E5E5"> the</font>

266
00:16:10,860 --> 00:16:17,160
<font color="#E5E5E5">location unlock so we can set a range</font>

267
00:16:14,520 --> 00:16:19,980
and if the smartphone is in<font color="#E5E5E5"> within his</font>

268
00:16:17,160 --> 00:16:21,480
range the smartphone is unlock and then

269
00:16:19,980 --> 00:16:23,430
we have the bootloader<font color="#E5E5E5"> unlock which is</font>

270
00:16:21,480 --> 00:16:27,150
of course what we are focusing on today

271
00:16:23,430 --> 00:16:30,780
<font color="#E5E5E5">and for the Bluetooth unlock we have</font>

272
00:16:27,150 --> 00:16:32,880
this condition the user setup parrot

273
00:16:30,780 --> 00:16:35,010
bluetooth device so we already<font color="#E5E5E5"> have</font>

274
00:16:32,880 --> 00:16:38,060
paired with the target<font color="#E5E5E5"> Bluetooth device</font>

275
00:16:35,010 --> 00:16:41,520
and we set this device as trusted and

276
00:16:38,060 --> 00:16:43,199
from<font color="#CCCCCC"> now on every time we connect to</font>

277
00:16:41,520 --> 00:16:45,720
this device<font color="#E5E5E5"> the smartphone</font><font color="#CCCCCC"> is</font>

278
00:16:43,200 --> 00:16:49,530
automatically unlock so we don't<font color="#CCCCCC"> have to</font>

279
00:16:45,720 --> 00:16:51,960
put pin code or whatever so what's the

280
00:16:49,530 --> 00:16:55,740
problem the problem<font color="#E5E5E5"> is it in android</font>

281
00:16:51,960 --> 00:16:57,560
version before 5.1 the linky is not

282
00:16:55,740 --> 00:17:02,760
checked to verify the<font color="#CCCCCC"> bluetooth device</font>

283
00:16:57,560 --> 00:17:06,300
so<font color="#E5E5E5"> the point is</font><font color="#CCCCCC"> that it's basically our</font>

284
00:17:02,760 --> 00:17:08,400
mac address based authentication because

285
00:17:06,300 --> 00:17:10,230
we have the smartphone<font color="#E5E5E5"> we analyze</font><font color="#CCCCCC"> the</font>

286
00:17:08,400 --> 00:17:14,100
connection to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> bluetooth device or</font>

287
00:17:10,230 --> 00:17:17,640
vice versa and if mac mac address be the

288
00:17:14,099 --> 00:17:20,399
other is known so the smartphone get the

289
00:17:17,640 --> 00:17:22,589
device details it is not<font color="#CCCCCC"> known</font>

290
00:17:20,400 --> 00:17:27,240
the indication protien start but there

291
00:17:22,589 --> 00:17:29,190
is<font color="#E5E5E5"> no check on the linky well what what</font>

292
00:17:27,240 --> 00:17:32,430
does it mean it means that we<font color="#E5E5E5"> just</font><font color="#CCCCCC"> need</font>

293
00:17:29,190 --> 00:17:34,350
<font color="#E5E5E5">to get the mac address of the target</font>

294
00:17:32,430 --> 00:17:37,050
device to unlock the smartphone without

295
00:17:34,350 --> 00:17:39,120
the pin code and ending it is

296
00:17:37,050 --> 00:17:41,280
<font color="#E5E5E5">interesting because in bluetooth we</font>

297
00:17:39,120 --> 00:17:43,830
don't need the full mac address we<font color="#CCCCCC"> just</font>

298
00:17:41,280 --> 00:17:46,980
need the<font color="#E5E5E5"> force the four-by-four bite of</font>

299
00:17:43,830 --> 00:17:49,530
the mac address the last four bytes of

300
00:17:46,980 --> 00:17:53,190
the mac address and how can<font color="#E5E5E5"> we</font><font color="#CCCCCC"> get those</font>

301
00:17:49,530 --> 00:17:55,830
bites we have true solution the first

302
00:17:53,190 --> 00:17:57,690
one is to brute force it but we can do

303
00:17:55,830 --> 00:17:59,760
<font color="#CCCCCC">it offline so we have two initial eight</font>

304
00:17:57,690 --> 00:18:02,190
a new request a new connection request

305
00:17:59,760 --> 00:18:05,210
every time and the other the<font color="#CCCCCC"> other</font>

306
00:18:02,190 --> 00:18:08,310
<font color="#E5E5E5">method is sniffing both of them have</font>

307
00:18:05,210 --> 00:18:10,950
cons of course group force is low

308
00:18:08,310 --> 00:18:14,790
because we again we need<font color="#CCCCCC"> to create a new</font>

309
00:18:10,950 --> 00:18:17,910
<font color="#E5E5E5">connection every time is</font><font color="#CCCCCC"> expensive</font>

310
00:18:14,790 --> 00:18:21,240
because even if we can paralyze it

311
00:18:17,910 --> 00:18:23,640
because we can use a different bluetooth

312
00:18:21,240 --> 00:18:26,790
<font color="#E5E5E5">dongle for example to create parallel</font>

313
00:18:23,640 --> 00:18:30,540
connections over time it get expensive

314
00:18:26,790 --> 00:18:34,909
and anyway also if we<font color="#CCCCCC"> have like 100</font>

315
00:18:30,540 --> 00:18:34,909
dongles it's definitely too long

316
00:18:40,669 --> 00:18:46,890
and then we<font color="#E5E5E5"> anything sniffing requires</font>

317
00:18:44,399 --> 00:18:49,559
the vicinity because the target must be

318
00:18:46,890 --> 00:18:51,299
near us because we have to intercept the

319
00:18:49,559 --> 00:18:53,510
communication between the smartphone and

320
00:18:51,299 --> 00:18:57,000
the bluetooth device for example a

321
00:18:53,510 --> 00:18:59,450
SmartWatch or whatever there is<font color="#E5E5E5"> an</font>

322
00:18:57,000 --> 00:19:02,760
authentication process required because

323
00:18:59,450 --> 00:19:04,590
for to get<font color="#CCCCCC"> the all four bytes we need</font>

324
00:19:02,760 --> 00:19:06,090
the authentication process to intercept

325
00:19:04,590 --> 00:19:08,519
the identification process because I

326
00:19:06,090 --> 00:19:10,559
will be soon before the Maccabee the

327
00:19:08,519 --> 00:19:14,039
address is required<font color="#E5E5E5"> to create the linky</font>

328
00:19:10,559 --> 00:19:16,529
for the function one of the parameter in

329
00:19:14,039 --> 00:19:19,460
the function to generate the linky is

330
00:19:16,529 --> 00:19:19,460
the mac address

331
00:19:25,549 --> 00:19:37,519
yep so so and the target can become

332
00:19:34,369 --> 00:19:41,389
aware because we are usually not normal

333
00:19:37,519 --> 00:19:43,669
<font color="#CCCCCC">people look look at your site and we see</font>

334
00:19:41,389 --> 00:19:46,668
that you are not normal<font color="#CCCCCC"> people so if</font>

335
00:19:43,669 --> 00:19:49,279
someone at the bar see a guy like<font color="#CCCCCC"> this</font>

336
00:19:46,669 --> 00:19:54,019
<font color="#E5E5E5">one that it can became aware of</font>

337
00:19:49,279 --> 00:19:57,499
something is wrong this guy is my hero

338
00:19:54,019 --> 00:20:00,830
when I was a little guy in my in my

339
00:19:57,499 --> 00:20:04,970
village there was no speed internet

340
00:20:00,830 --> 00:20:07,639
connection I was just a<font color="#CCCCCC"> 50cc connection</font>

341
00:20:04,970 --> 00:20:10,460
and I'm 20 so it's not long time ago and

342
00:20:07,639 --> 00:20:13,248
this guy inspired me to create my first

343
00:20:10,460 --> 00:20:16,309
container to steal Wi-Fi connection from

344
00:20:13,249 --> 00:20:18,889
<font color="#CCCCCC">the village near by which was like 1.5</font>

345
00:20:16,309 --> 00:20:22,639
kilometers so this is<font color="#CCCCCC"> my year or don't</font>

346
00:20:18,889 --> 00:20:24,619
don't play with him<font color="#CCCCCC"> okay so what we what</font>

347
00:20:22,639 --> 00:20:28,820
we found is the solution<font color="#E5E5E5"> the solution is</font>

348
00:20:24,619 --> 00:20:32,029
hybrid because<font color="#E5E5E5"> there is another issue in</font>

349
00:20:28,820 --> 00:20:33,950
<font color="#CCCCCC">Android that Android when you turn on</font>

350
00:20:32,029 --> 00:20:37,100
<font color="#CCCCCC">the Bluetooth automatically start</font>

351
00:20:33,950 --> 00:20:40,340
sending out beacons with the mac address

352
00:20:37,100 --> 00:20:42,859
of<font color="#E5E5E5"> already paired devices it's something</font>

353
00:20:40,340 --> 00:20:45,980
similar to Wi-Fi connection when you

354
00:20:42,859 --> 00:20:49,428
turn on your Wi-Fi we start<font color="#CCCCCC"> looking for</font>

355
00:20:45,980 --> 00:20:51,529
already<font color="#E5E5E5"> known networks and it does</font><font color="#CCCCCC"> that</font>

356
00:20:49,429 --> 00:20:54,889
<font color="#E5E5E5">to sending out the mac address of this</font>

357
00:20:51,529 --> 00:20:57,980
network and the track we said that<font color="#CCCCCC"> the</font>

358
00:20:54,889 --> 00:20:59,959
trusted device must be<font color="#E5E5E5"> already paired so</font>

359
00:20:57,980 --> 00:21:03,350
the neck address of the trusted device

360
00:20:59,960 --> 00:21:05,960
is sent and so we can intercept the

361
00:21:03,350 --> 00:21:07,730
beacons and so we get the first three

362
00:21:05,960 --> 00:21:09,769
bites of the mac address we need and

363
00:21:07,730 --> 00:21:13,190
then we can just<font color="#E5E5E5"> brute force 1 by T</font>

364
00:21:09,769 --> 00:21:18,889
which is 256 possible make addresses so

365
00:21:13,190 --> 00:21:23,299
that's more convenient and<font color="#CCCCCC"> okay it's</font>

366
00:21:18,889 --> 00:21:25,178
difficult<font color="#E5E5E5"> now I have</font><font color="#CCCCCC"> a video a demo we</font>

367
00:21:23,299 --> 00:21:28,039
plan<font color="#E5E5E5"> to do the video yesterday night</font>

368
00:21:25,179 --> 00:21:30,859
yesterday<font color="#E5E5E5"> night</font><font color="#CCCCCC"> zero night organised</font><font color="#E5E5E5"> the</font>

369
00:21:28,039 --> 00:21:33,490
speaker<font color="#E5E5E5"> part and we are in Russia and</font>

370
00:21:30,859 --> 00:21:37,600
there is a<font color="#E5E5E5"> lot of alcohol in Russia</font>

371
00:21:33,490 --> 00:21:40,809
so the video was<font color="#CCCCCC"> not good so use a the</font>

372
00:21:37,600 --> 00:21:44,290
video we made<font color="#CCCCCC"> at DEFCON</font><font color="#E5E5E5"> defconn was made</font>

373
00:21:40,809 --> 00:21:46,059
in Vegas Vegas has a lot of alcohol so

374
00:21:44,290 --> 00:21:47,889
that the problem is still the same<font color="#CCCCCC"> so</font>

375
00:21:46,059 --> 00:21:50,470
I'm<font color="#CCCCCC"> very sorry for the quality of the</font>

376
00:21:47,890 --> 00:21:55,470
video will try to I try to explain<font color="#E5E5E5"> what</font>

377
00:21:50,470 --> 00:21:55,470
the important parts are but again<font color="#E5E5E5"> sorry</font>

378
00:21:56,490 --> 00:22:04,240
okay what what we will do here is just

379
00:21:59,320 --> 00:22:09,340
to show<font color="#CCCCCC"> how the mac address is a change</font>

380
00:22:04,240 --> 00:22:14,320
on the<font color="#CCCCCC"> kali linux for example so this is</font>

381
00:22:09,340 --> 00:22:16,840
of course not a true mac address it's

382
00:22:14,320 --> 00:22:21,428
just some stupid<font color="#E5E5E5"> neck address and we are</font>

383
00:22:16,840 --> 00:22:23,020
now scanning for devices to to clone a

384
00:22:21,429 --> 00:22:28,120
make others of our known<font color="#E5E5E5"> Bluetooth</font>

385
00:22:23,020 --> 00:22:29,710
devices<font color="#CCCCCC"> okay this is the the one</font>

386
00:22:28,120 --> 00:22:32,020
highlighted I don't know if you<font color="#E5E5E5"> can see</font>

387
00:22:29,710 --> 00:22:34,090
yes you can<font color="#CCCCCC"> see is the mac address of</font>

388
00:22:32,020 --> 00:22:39,389
the target into device we are trying<font color="#E5E5E5"> to</font>

389
00:22:34,090 --> 00:22:39,389
do spoof oh sorry

390
00:22:48,690 --> 00:22:54,100
okay we just change our make a dress and

391
00:22:51,820 --> 00:22:57,399
now we are resetting the bluetooth

392
00:22:54,100 --> 00:23:02,230
interface just to apply<font color="#E5E5E5"> the changes okay</font>

393
00:22:57,400 --> 00:23:05,260
so now you see that MAC address is

394
00:23:02,230 --> 00:23:12,400
changed and<font color="#CCCCCC"> what you are doing now</font><font color="#E5E5E5"> is</font>

395
00:23:05,260 --> 00:23:18,070
just starting H dump which basically

396
00:23:12,400 --> 00:23:21,190
print out or the or the<font color="#E5E5E5"> hei</font><font color="#CCCCCC"> packet from</font>

397
00:23:18,070 --> 00:23:26,020
from the blue 22 interface and on<font color="#E5E5E5"> this</font>

398
00:23:21,190 --> 00:23:28,770
<font color="#E5E5E5">screen you see a android device which we</font>

399
00:23:26,020 --> 00:23:32,470
turn on the<font color="#E5E5E5"> Bluetooth interface and</font>

400
00:23:28,770 --> 00:23:36,820
automatically try to connect a nice

401
00:23:32,470 --> 00:23:40,270
unlock so here you can<font color="#E5E5E5"> see that there</font><font color="#CCCCCC"> is</font>

402
00:23:36,820 --> 00:23:43,500
this mac address we try to is trying<font color="#CCCCCC"> to</font>

403
00:23:40,270 --> 00:23:46,180
request a connection to our laptop and

404
00:23:43,500 --> 00:23:48,220
since the connection from<font color="#CCCCCC"> the</font>

405
00:23:46,180 --> 00:23:50,770
perspective of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> android device is</font>

406
00:23:48,220 --> 00:23:53,130
already appended the sorry the

407
00:23:50,770 --> 00:23:56,080
authentication is already opinion the

408
00:23:53,130 --> 00:23:58,210
linky is supposed to be stored on both

409
00:23:56,080 --> 00:24:01,240
devices so<font color="#E5E5E5"> it's not calculated again and</font>

410
00:23:58,210 --> 00:24:04,180
so the<font color="#CCCCCC"> android device think that the</font>

411
00:24:01,240 --> 00:24:06,790
laptop<font color="#CCCCCC"> is</font><font color="#E5E5E5"> okay and unlock the device</font>

412
00:24:04,180 --> 00:24:09,700
without the pin code and after a<font color="#CCCCCC"> few</font>

413
00:24:06,790 --> 00:24:11,950
seconds of course the data exchange

414
00:24:09,700 --> 00:24:14,320
doesn't match because<font color="#E5E5E5"> the linky is also</font>

415
00:24:11,950 --> 00:24:16,810
used<font color="#E5E5E5"> to create the keys for</font><font color="#CCCCCC"> the</font>

416
00:24:14,320 --> 00:24:19,360
encryption or the data which<font color="#CCCCCC"> is of</font>

417
00:24:16,810 --> 00:24:21,639
<font color="#CCCCCC">course not not to abort because we don't</font>

418
00:24:19,360 --> 00:24:25,570
have<font color="#E5E5E5"> the linky so after a few seconds</font>

419
00:24:21,640 --> 00:24:28,240
the device get again a locket we are

420
00:24:25,570 --> 00:24:30,550
just<font color="#CCCCCC"> showing that the devices seem</font>

421
00:24:28,240 --> 00:24:34,780
connected ok this is should be the pin

422
00:24:30,550 --> 00:24:37,510
code requested again sorry for<font color="#CCCCCC"> the video</font>

423
00:24:34,780 --> 00:24:39,850
qualities should<font color="#CCCCCC"> ok we don't draw a</font>

424
00:24:37,510 --> 00:24:42,310
five-point well there is<font color="#CCCCCC"> no new feature</font>

425
00:24:39,850 --> 00:24:45,580
which is<font color="#E5E5E5"> that we can access the</font>

426
00:24:42,310 --> 00:24:47,980
bluetooth menu of storage device from

427
00:24:45,580 --> 00:24:50,740
the<font color="#E5E5E5"> lock screen without the pin code so</font>

428
00:24:47,980 --> 00:24:54,910
<font color="#CCCCCC">we can</font><font color="#E5E5E5"> select the target device and send</font>

429
00:24:50,740 --> 00:24:59,000
out beacons only for that device so if

430
00:24:54,910 --> 00:25:02,420
before<font color="#E5E5E5"> we have to we will</font>

431
00:24:59,000 --> 00:25:04,490
get the mac address of all previously

432
00:25:02,420 --> 00:25:06,560
saved device<font color="#CCCCCC"> Bluetooth previous self</font>

433
00:25:04,490 --> 00:25:11,090
device now we can select<font color="#CCCCCC"> and Target just</font>

434
00:25:06,560 --> 00:25:16,810
one<font color="#E5E5E5"> device to even further decrease the</font>

435
00:25:11,090 --> 00:25:20,360
number of brute force tries required and

436
00:25:16,810 --> 00:25:25,370
there is a new video but<font color="#E5E5E5"> the best is yet</font>

437
00:25:20,360 --> 00:25:27,590
<font color="#E5E5E5">to come in which we just show this is</font>

438
00:25:25,370 --> 00:25:30,199
the uber tooth interface which is

439
00:25:27,590 --> 00:25:32,959
running on on the laptop<font color="#CCCCCC"> and on the</font>

440
00:25:30,200 --> 00:25:36,260
right we have the again the<font color="#E5E5E5"> Android</font>

441
00:25:32,960 --> 00:25:39,710
device in which we are enabling the

442
00:25:36,260 --> 00:25:42,440
bluetooth interface and as you can see

443
00:25:39,710 --> 00:25:45,980
we are trying<font color="#E5E5E5"> to connect just to this</font>

444
00:25:42,440 --> 00:25:49,370
<font color="#E5E5E5">device creative it would be free a ton</font>

445
00:25:45,980 --> 00:25:53,090
380 and here we<font color="#CCCCCC"> can see the</font><font color="#E5E5E5"> mac address</font>

446
00:25:49,370 --> 00:25:56,810
which<font color="#CCCCCC"> is the LA p of just this device</font>

447
00:25:53,090 --> 00:25:58,580
which is for<font color="#CCCCCC"> b 6 a-8 too so as you can</font>

448
00:25:56,810 --> 00:26:01,970
see we see a lot of packets just for

449
00:25:58,580 --> 00:26:04,159
this device and the device was not in

450
00:26:01,970 --> 00:26:05,630
range so as you can see the connection

451
00:26:04,160 --> 00:26:08,120
does it happen because the device is not

452
00:26:05,630 --> 00:26:10,460
in range we just have the smartphone but

453
00:26:08,120 --> 00:26:16,540
we can have the<font color="#E5E5E5"> first free bite require</font>

454
00:26:10,460 --> 00:26:22,490
the for the authentication that's it and

455
00:26:16,540 --> 00:26:24,980
now oh<font color="#E5E5E5"> yes</font><font color="#CCCCCC"> okay with android 5.1 they</font>

456
00:26:22,490 --> 00:26:28,040
fix the issue of<font color="#E5E5E5"> the smart unlock</font>

457
00:26:24,980 --> 00:26:30,320
feature which is<font color="#E5E5E5"> built in in android but</font>

458
00:26:28,040 --> 00:26:34,310
the api of<font color="#E5E5E5"> bluetooth in android are</font>

459
00:26:30,320 --> 00:26:36,679
still vulnerable to this thing so if you

460
00:26:34,310 --> 00:26:38,149
have an<font color="#E5E5E5"> ax even now with android the</font>

461
00:26:36,680 --> 00:26:41,840
six-point oh they are still vulnerable

462
00:26:38,150 --> 00:26:45,620
we we request a fix to the<font color="#E5E5E5"> android</font>

463
00:26:41,840 --> 00:26:47,780
security team<font color="#E5E5E5"> and this response that i</font>

464
00:26:45,620 --> 00:26:51,530
don't<font color="#E5E5E5"> know if you can read they said</font><font color="#CCCCCC"> ok</font>

465
00:26:47,780 --> 00:26:54,470
there is a method in a OSP and is public

466
00:26:51,530 --> 00:26:57,080
these methods<font color="#CCCCCC"> is supposed to check if</font>

467
00:26:54,470 --> 00:27:01,100
the connection is encrypted or not but

468
00:26:57,080 --> 00:27:04,340
the method as today actually not 27

469
00:27:01,100 --> 00:27:06,530
<font color="#CCCCCC">april but today is a still not present</font>

470
00:27:04,340 --> 00:27:08,149
in the latest<font color="#CCCCCC"> version of the</font><font color="#E5E5E5"> sdk so you</font>

471
00:27:06,530 --> 00:27:12,010
cannot use this method if you are

472
00:27:08,150 --> 00:27:12,010
running the official android sdk

473
00:27:17,850 --> 00:27:24,459
ok so the<font color="#CCCCCC"> Android the smart unlock</font>

474
00:27:22,810 --> 00:27:26,800
feature is fixed so what's the problem

475
00:27:24,460 --> 00:27:28,870
<font color="#E5E5E5">with the FBI because there is a lot of</font>

476
00:27:26,800 --> 00:27:31,300
third-party application<font color="#E5E5E5"> third-party</font>

477
00:27:28,870 --> 00:27:34,530
applications which are emulating this

478
00:27:31,300 --> 00:27:37,690
<font color="#CCCCCC">Martin lock feature for android 4.2 or</font>

479
00:27:34,530 --> 00:27:39,700
3.6 whatever so if you are running<font color="#E5E5E5"> a</font>

480
00:27:37,690 --> 00:27:42,190
older<font color="#E5E5E5"> version of</font><font color="#CCCCCC"> Android which we are</font>

481
00:27:39,700 --> 00:27:45,070
probably doing because<font color="#E5E5E5"> we</font><font color="#CCCCCC"> know the</font>

482
00:27:42,190 --> 00:27:47,200
<font color="#E5E5E5">Android updates are not so so fast and</font>

483
00:27:45,070 --> 00:27:49,389
you are using this application to

484
00:27:47,200 --> 00:27:52,780
emulate the smart and lock feature then

485
00:27:49,390 --> 00:27:56,410
you get problems and<font color="#E5E5E5"> I have the the</font>

486
00:27:52,780 --> 00:27:58,480
<font color="#E5E5E5">latest demo which is the worst one you</font>

487
00:27:56,410 --> 00:28:01,390
will see<font color="#E5E5E5"> probably just my face I'm sorry</font>

488
00:27:58,480 --> 00:28:05,350
<font color="#E5E5E5">for that this is me yesterday no in</font>

489
00:28:01,390 --> 00:28:10,300
Vegas probably drunk trying to<font color="#CCCCCC"> produce</font>

490
00:28:05,350 --> 00:28:13,179
<font color="#CCCCCC">the video I'm sorry so here we are just</font>

491
00:28:10,300 --> 00:28:16,149
changing again it's also a the focus

492
00:28:13,180 --> 00:28:19,540
problem is his fault not mine I'm<font color="#E5E5E5"> I just</font>

493
00:28:16,150 --> 00:28:22,630
writing on the on the keyboard so blame

494
00:28:19,540 --> 00:28:25,360
him and we are just ok we<font color="#E5E5E5"> changed the</font>

495
00:28:22,630 --> 00:28:28,510
blue the<font color="#E5E5E5"> bluetooth mac address again to</font>

496
00:28:25,360 --> 00:28:33,669
the<font color="#E5E5E5"> target device and we are resetting</font>

497
00:28:28,510 --> 00:28:39,430
the interface as before ok so the mac

498
00:28:33,670 --> 00:28:46,900
address is now changed and now we will

499
00:28:39,430 --> 00:28:48,910
we will start the visibility<font color="#E5E5E5"> ok we start</font>

500
00:28:46,900 --> 00:28:51,040
the visibility of the laptop so that

501
00:28:48,910 --> 00:28:56,610
other<font color="#E5E5E5"> Bluetooth devices can see actually</font>

502
00:28:51,040 --> 00:29:01,330
the interface on the laptop<font color="#E5E5E5"> and ok and</font>

503
00:28:56,610 --> 00:29:03,879
now we move to the<font color="#CCCCCC"> OS and we start HEC</font>

504
00:29:01,330 --> 00:29:07,960
dumped again to see the packets and now

505
00:29:03,880 --> 00:29:10,210
we move to the in this case an<font color="#E5E5E5"> Android</font>

506
00:29:07,960 --> 00:29:12,400
the lab android tablet with android the

507
00:29:10,210 --> 00:29:13,990
four-point something and<font color="#CCCCCC"> i</font><font color="#E5E5E5"> remember</font>

508
00:29:12,400 --> 00:29:17,860
sorry and we turn on the<font color="#E5E5E5"> Bluetooth</font>

509
00:29:13,990 --> 00:29:21,370
interface it automatically<font color="#CCCCCC"> try to</font>

510
00:29:17,860 --> 00:29:24,269
connect to this device creative would be

511
00:29:21,370 --> 00:29:27,059
whatever which is the mac address we

512
00:29:24,269 --> 00:29:31,080
of before and okay I don't know if you

513
00:29:27,059 --> 00:29:32,668
<font color="#E5E5E5">can read here device unlock</font><font color="#CCCCCC"> it and the</font>

514
00:29:31,080 --> 00:29:35,189
device they actually the creative would

515
00:29:32,669 --> 00:29:38,009
be free 80 is not connected just

516
00:29:35,190 --> 00:29:41,849
available but the device is unlocked it

517
00:29:38,009 --> 00:29:44,639
anyway because the application using the

518
00:29:41,849 --> 00:29:47,639
API thinks that device as the correct

519
00:29:44,639 --> 00:29:55,109
link Esau is correctly connected but

520
00:29:47,639 --> 00:29:57,089
that's not true so okay here<font color="#E5E5E5"> we just see</font>

521
00:29:55,109 --> 00:29:59,609
the packet and we see that<font color="#E5E5E5"> after a few</font>

522
00:29:57,089 --> 00:30:01,379
seconds the connection is terminated but

523
00:29:59,609 --> 00:30:03,629
we already have the device they<font color="#CCCCCC"> android</font>

524
00:30:01,379 --> 00:30:05,809
device unlocked so we don't care in this

525
00:30:03,629 --> 00:30:08,879
way we can bypass about the<font color="#CCCCCC"> pincode the</font>

526
00:30:05,809 --> 00:30:11,999
encryption of the<font color="#E5E5E5"> of the device whatever</font>

527
00:30:08,879 --> 00:30:15,299
<font color="#E5E5E5">if you need to extract information like</font>

528
00:30:11,999 --> 00:30:17,029
contacts whatever for example take from

529
00:30:15,299 --> 00:30:19,769
the point of view of police which are

530
00:30:17,029 --> 00:30:26,489
taking your smartphone<font color="#E5E5E5"> because you are</font>

531
00:30:19,769 --> 00:30:31,579
doing bad stuff you know<font color="#E5E5E5"> em okay future</font>

532
00:30:26,489 --> 00:30:34,169
work filter work we we were focusing on

533
00:30:31,579 --> 00:30:36,959
we are trying to apply<font color="#CCCCCC"> the same</font>

534
00:30:34,169 --> 00:30:40,349
methodology we use for<font color="#E5E5E5"> this kind of test</font>

535
00:30:36,959 --> 00:30:42,839
so trying<font color="#E5E5E5"> to see what are the critical</font>

536
00:30:40,349 --> 00:30:45,950
points in<font color="#E5E5E5"> this case was</font><font color="#CCCCCC"> the linky and</font>

537
00:30:42,839 --> 00:30:48,719
every education of the linky actually on

538
00:30:45,950 --> 00:30:52,049
several other devices which are like for

539
00:30:48,719 --> 00:30:54,629
example IOT devices smart locks<font color="#E5E5E5"> fit</font><font color="#CCCCCC"> bend</font>

540
00:30:52,049 --> 00:30:56,908
we have some issues here and there but

541
00:30:54,629 --> 00:31:00,718
we can<font color="#CCCCCC"> discuss now because we are under</font>

542
00:30:56,909 --> 00:31:03,899
NDA<font color="#CCCCCC"> and you know this is</font><font color="#E5E5E5"> recorded what</font>

543
00:31:00,719 --> 00:31:05,639
up and that's because<font color="#E5E5E5"> we will do this</font>

544
00:31:03,899 --> 00:31:08,158
everywhere<font color="#E5E5E5"> I mean every device has</font>

545
00:31:05,639 --> 00:31:10,728
bluetooth now every IOT device implement

546
00:31:08,159 --> 00:31:15,149
or bluetooth or zigbee or Wi-Fi but

547
00:31:10,729 --> 00:31:19,669
<font color="#E5E5E5">notices is very very common so thank you</font>

548
00:31:15,149 --> 00:31:19,668
thank you for your time and let<font color="#CCCCCC"> it</font>

549
00:31:24,180 --> 00:31:27,630
okay question

550
00:31:31,320 --> 00:31:35,350
you have a<font color="#E5E5E5"> 13 minutes so you have to</font>

551
00:31:33,909 --> 00:31:44,220
make some questions because you can

552
00:31:35,350 --> 00:31:44,219
leave the room at least one

553
00:31:48,090 --> 00:31:51,899
ask<font color="#E5E5E5"> about Italy ask or something it</font>

554
00:31:50,789 --> 00:31:56,158
doesn't have<font color="#E5E5E5"> to be related</font><font color="#CCCCCC"> to the</font>

555
00:31:51,900 --> 00:32:02,940
<font color="#E5E5E5">presentation did you enjoy</font><font color="#CCCCCC"> okay it's a</font>

556
00:31:56,159 --> 00:32:06,179
question there is<font color="#E5E5E5"> a box with something</font>

557
00:32:02,940 --> 00:32:08,640
for you yeah do you<font color="#CCCCCC"> have experience with</font>

558
00:32:06,179 --> 00:32:11,400
discovering some vulnerability of

559
00:32:08,640 --> 00:32:15,779
<font color="#E5E5E5">Bluetooth itself when</font><font color="#CCCCCC"> we can execute</font>

560
00:32:11,400 --> 00:32:18,779
like shell code or something I think

561
00:32:15,779 --> 00:32:20,760
<font color="#E5E5E5">that was some something related to the</font>

562
00:32:18,779 --> 00:32:25,470
vulnerability discover by<font color="#E5E5E5"> Adam ilori</font>

563
00:32:20,760 --> 00:32:28,620
with the<font color="#E5E5E5"> the blue bug very much it's</font>

564
00:32:25,470 --> 00:32:30,990
rather old yeah it's new ten years<font color="#CCCCCC"> ago</font>

565
00:32:28,620 --> 00:32:35,760
<font color="#E5E5E5">or something like that what do you think</font>

566
00:32:30,990 --> 00:32:39,440
if I if I need<font color="#CCCCCC"> to find this stuff what</font>

567
00:32:35,760 --> 00:32:41,730
should I start for from<font color="#CCCCCC"> Ray you have to</font>

568
00:32:39,440 --> 00:32:43,830
first of<font color="#E5E5E5"> all you have to read a specific</font>

569
00:32:41,730 --> 00:32:47,210
specification at least some part of it

570
00:32:43,830 --> 00:32:50,549
it's like<font color="#E5E5E5"> a big book very big book</font>

571
00:32:47,210 --> 00:32:52,320
anyway and then you need some I don't

572
00:32:50,549 --> 00:32:55,049
know if you know the uber tooth device

573
00:32:52,320 --> 00:32:57,809
yeah okay you need it because you need

574
00:32:55,049 --> 00:33:02,010
to<font color="#E5E5E5"> be able to decode the Bluetooth</font>

575
00:32:57,809 --> 00:33:03,750
packets and and then you need to know

576
00:33:02,010 --> 00:33:05,279
also the implant a specific

577
00:33:03,750 --> 00:33:07,620
implementation<font color="#E5E5E5"> or device you are looking</font>

578
00:33:05,279 --> 00:33:10,169
you're looking at for example we were

579
00:33:07,620 --> 00:33:13,168
focusing on<font color="#E5E5E5"> Android but if you want</font><font color="#CCCCCC"> to</font>

580
00:33:10,169 --> 00:33:16,230
check the same things on I don't know

581
00:33:13,169 --> 00:33:18,450
you're smart lock your<font color="#E5E5E5"> IOT smartlock you</font>

582
00:33:16,230 --> 00:33:20,460
have to know<font color="#E5E5E5"> how the Coyotes Martok</font>

583
00:33:18,450 --> 00:33:22,260
<font color="#CCCCCC">ended the</font><font color="#E5E5E5"> Bluetooth connection what are</font>

584
00:33:20,460 --> 00:33:25,380
the packet sent what are the interface

585
00:33:22,260 --> 00:33:28,080
of the bluetooth which are exposed from

586
00:33:25,380 --> 00:33:31,549
the from the<font color="#E5E5E5"> smart clock as we said in</font>

587
00:33:28,080 --> 00:33:35,010
the beginning the bluetooth is just a

588
00:33:31,549 --> 00:33:37,649
big protocol in which you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> stuck a</font>

589
00:33:35,010 --> 00:33:40,919
lot of other protocols and so<font color="#E5E5E5"> this are</font>

590
00:33:37,649 --> 00:33:43,289
not<font color="#CCCCCC"> mandatory so every implementation as</font>

591
00:33:40,919 --> 00:33:45,809
different protocols inside and expose

592
00:33:43,289 --> 00:33:49,049
different kind<font color="#E5E5E5"> of feature so so we can</font>

593
00:33:45,809 --> 00:33:53,309
attack every layer yeah sorry so we can

594
00:33:49,049 --> 00:33:55,460
attack every layer of this stuff yeah we

595
00:33:53,309 --> 00:33:55,460
can

596
00:33:57,019 --> 00:34:06,690
nope you can analyze every layer you can

597
00:34:02,700 --> 00:34:10,589
start studying every layer with a day<font color="#E5E5E5"> /</font>

598
00:34:06,690 --> 00:34:13,740
tooth and ahe<font color="#E5E5E5"> ACHC</font><font color="#CCCCCC"> I dumped you can</font>

599
00:34:10,589 --> 00:34:16,879
start analyzing the packets but as again

600
00:34:13,739 --> 00:34:20,520
the layer depends on implementation so

601
00:34:16,879 --> 00:34:25,168
it you can say there is no<font color="#E5E5E5"> general way</font>

602
00:34:20,520 --> 00:34:27,480
to analyze everything so since 2004 no

603
00:34:25,168 --> 00:34:34,259
even single exploit<font color="#E5E5E5"> exists for this</font>

604
00:34:27,480 --> 00:34:38,699
stuff what other exploit I just quoted

605
00:34:34,260 --> 00:34:43,770
the main the most important exploits it

606
00:34:38,699 --> 00:34:46,678
might well in my opinion<font color="#E5E5E5"> but yes for for</font>

607
00:34:43,770 --> 00:34:49,290
Bluetooth like dozin but this<font color="#E5E5E5"> is are the</font>

608
00:34:46,679 --> 00:34:51,990
most critical what we used to start

609
00:34:49,290 --> 00:34:54,599
studying we've analyzed out the these

610
00:34:51,989 --> 00:34:57,240
bugs are discovered and then we applied

611
00:34:54,599 --> 00:35:00,060
some<font color="#CCCCCC"> of this methodology for our for our</font>

612
00:34:57,240 --> 00:35:06,149
stuff and<font color="#E5E5E5"> we create what what you're</font>

613
00:35:00,060 --> 00:35:09,690
seeing<font color="#E5E5E5"> now</font><font color="#CCCCCC"> ok thank</font><font color="#E5E5E5"> you I come hello</font>

614
00:35:06,150 --> 00:35:12,960
have you tried using some sort of

615
00:35:09,690 --> 00:35:17,280
software-defined radio that sort of

616
00:35:12,960 --> 00:35:23,730
stuff so you can analyze lower layers<font color="#E5E5E5"> or</font>

617
00:35:17,280 --> 00:35:26,730
just default<font color="#CCCCCC"> Bluetooth transceivers yes</font>

618
00:35:23,730 --> 00:35:29,730
and then we saw that was a mess so

619
00:35:26,730 --> 00:35:32,790
<font color="#E5E5E5">actually we focus on the higher level</font>

620
00:35:29,730 --> 00:35:35,099
with the is pretty easy with the uber

621
00:35:32,790 --> 00:35:38,160
tooth because the decoding of the

622
00:35:35,099 --> 00:35:40,530
packets is all done automatically and we

623
00:35:38,160 --> 00:35:43,140
also use a lot of the HCI down to

624
00:35:40,530 --> 00:35:45,359
information because you can see where

625
00:35:43,140 --> 00:35:48,420
the process starts or stop in the

626
00:35:45,359 --> 00:35:53,069
<font color="#E5E5E5">connection but we didn't go on</font><font color="#CCCCCC"> the lower</font>

627
00:35:48,420 --> 00:35:57,079
layer on the bottom of this<font color="#E5E5E5"> of this</font>

628
00:35:53,069 --> 00:35:57,079
table thank

629
00:36:04,780 --> 00:36:07,740
eight minutes

630
00:36:18,710 --> 00:36:27,410
is that okay hello the soft you used is

631
00:36:23,180 --> 00:36:31,368
yours or<font color="#E5E5E5"> I can download it from</font>

632
00:36:27,410 --> 00:36:33,859
something okay we we<font color="#CCCCCC"> just we didn't use</font>

633
00:36:31,369 --> 00:36:36,980
any kind of<font color="#E5E5E5"> particular software we just</font>

634
00:36:33,859 --> 00:36:40,000
use the uber<font color="#E5E5E5"> 22 utility which are free</font>

635
00:36:36,980 --> 00:36:42,410
available<font color="#CCCCCC"> on github and we use the</font>

636
00:36:40,000 --> 00:36:46,730
actually this is a logical<font color="#E5E5E5"> bug it's not</font>

637
00:36:42,410 --> 00:36:49,580
something<font color="#CCCCCC"> it's logical because there is</font>

638
00:36:46,730 --> 00:36:51,980
a dismissing check so there is<font color="#E5E5E5"> no need</font>

639
00:36:49,580 --> 00:36:55,069
to create new tools you just analyzed

640
00:36:51,980 --> 00:36:57,950
how the connection is made how is the

641
00:36:55,070 --> 00:37:00,260
the checking procedure is a implemented

642
00:36:57,950 --> 00:37:04,250
in<font color="#CCCCCC"> Android so you just use the standard</font>

643
00:37:00,260 --> 00:37:06,650
tools wireshark uber to 10 HZ item which

644
00:37:04,250 --> 00:37:08,660
is built<font color="#E5E5E5"> in inland</font><font color="#CCCCCC"> linux and you can</font>

645
00:37:06,650 --> 00:37:10,910
analyze the whole procedure<font color="#E5E5E5"> or the</font>

646
00:37:08,660 --> 00:37:15,399
authorization or the communication and

647
00:37:10,910 --> 00:37:15,399
connection procedures<font color="#CCCCCC"> ok thank you</font>

648
00:37:21,859 --> 00:37:28,589
one more question<font color="#E5E5E5"> does standard software</font>

649
00:37:25,470 --> 00:37:32,868
and hardware allowed to adjust monitor

650
00:37:28,589 --> 00:37:36,839
so just monitor another packets without

651
00:37:32,869 --> 00:37:40,589
actually connection making connection to

652
00:37:36,839 --> 00:37:44,759
observe and<font color="#E5E5E5"> sniff packets from other</font>

653
00:37:40,589 --> 00:37:49,880
devices or you need something special

654
00:37:44,760 --> 00:37:54,599
devices or special drivers may be<font color="#CCCCCC"> okay</font>

655
00:37:49,880 --> 00:37:57,000
the uber tooth is required to intercept

656
00:37:54,599 --> 00:37:59,520
packets you can change MAC address if

657
00:37:57,000 --> 00:38:03,420
<font color="#CCCCCC">you have a some particular chipset made</font>

658
00:37:59,520 --> 00:38:05,339
by broadcom and another chip set

659
00:38:03,420 --> 00:38:07,589
<font color="#E5E5E5">manufacturer which I don't</font><font color="#CCCCCC"> remember</font><font color="#E5E5E5"> but</font>

660
00:38:05,339 --> 00:38:10,049
this dongle to<font color="#CCCCCC"> the dongle you can buy</font>

661
00:38:07,589 --> 00:38:12,200
<font color="#E5E5E5">from ebay for one euros or something</font>

662
00:38:10,049 --> 00:38:15,000
like that it's very very<font color="#E5E5E5"> very cheap and</font>

663
00:38:12,200 --> 00:38:17,040
instead for intercepting things there<font color="#E5E5E5"> is</font>

664
00:38:15,000 --> 00:38:21,390
the<font color="#CCCCCC"> use there is</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> kneading of the</font>

665
00:38:17,040 --> 00:38:24,900
uber tooth device which is anyway again

666
00:38:21,390 --> 00:38:27,598
<font color="#CCCCCC">80 years if not the craziest thing I</font>

667
00:38:24,900 --> 00:38:30,089
actually think you can apply the same

668
00:38:27,599 --> 00:38:33,210
the same<font color="#E5E5E5"> things used to vertebrate hood</font>

669
00:38:30,089 --> 00:38:35,609
on any kind of SDR which has the range

670
00:38:33,210 --> 00:38:39,839
of the Bluetooth frequency of course so

671
00:38:35,609 --> 00:38:41,490
2.4 giggles but of course<font color="#E5E5E5"> the uber tooth</font>

672
00:38:39,839 --> 00:38:43,799
is simpler because everything is just

673
00:38:41,490 --> 00:38:45,779
created for that if you<font color="#CCCCCC"> have to buy a</font>

674
00:38:43,799 --> 00:38:50,509
new<font color="#E5E5E5"> ser for this I</font><font color="#CCCCCC"> don't recommend it</font>

675
00:38:45,780 --> 00:38:50,510
just buy the Huber food thank you

676
00:38:53,090 --> 00:39:00,990
so you were targeting bluetooth for like

677
00:38:57,060 --> 00:39:04,080
Bluetooth<font color="#E5E5E5"> Low Energy know the version is</font>

678
00:39:00,990 --> 00:39:06,540
not a month it's not<font color="#E5E5E5"> something that</font>

679
00:39:04,080 --> 00:39:16,799
matters<font color="#E5E5E5"> here the</font><font color="#CCCCCC"> Bluetooth connection is</font>

680
00:39:06,540 --> 00:39:20,369
the problem as it as we saw before both

681
00:39:16,800 --> 00:39:24,630
in the<font color="#CCCCCC"> two to two point O or before or</font>

682
00:39:20,369 --> 00:39:27,090
<font color="#E5E5E5">root for every time we use a a key for</font>

683
00:39:24,630 --> 00:39:29,430
establishing the encryption encrypted

684
00:39:27,090 --> 00:39:33,240
connection so the problem is<font color="#E5E5E5"> that the</font>

685
00:39:29,430 --> 00:39:36,359
non droid before 5.1 whiskey<font color="#E5E5E5"> whatever it</font>

686
00:39:33,240 --> 00:39:39,118
is<font color="#E5E5E5"> the whatever version it is is not</font>

687
00:39:36,360 --> 00:39:41,520
<font color="#E5E5E5">checked so every version of Android is</font>

688
00:39:39,119 --> 00:39:44,360
vulnerable<font color="#CCCCCC"> to the was vulnerable to this</font>

689
00:39:41,520 --> 00:39:44,360
product to this issue

690
00:39:58,340 --> 00:40:05,690
did you like the videos

691
00:40:00,990 --> 00:40:05,689
please say yes thank you

692
00:40:10,070 --> 00:40:21,020
well if normal questions are present I

693
00:40:13,550 --> 00:40:24,770
will say<font color="#E5E5E5"> okay thank you and I hope you</font>

694
00:40:21,020 --> 00:40:29,420
enjoyed the talk<font color="#E5E5E5"> and so a big thank you</font>

695
00:40:24,770 --> 00:40:31,340
once again if you are shy we stay here

696
00:40:29,420 --> 00:40:35,200
for a couple of minutes<font color="#E5E5E5"> if you have more</font>

697
00:40:31,340 --> 00:40:35,200
question you don't want to say out loud

