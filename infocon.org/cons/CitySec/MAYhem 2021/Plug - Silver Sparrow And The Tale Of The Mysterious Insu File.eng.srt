1
00:00:00,000 --> 00:00:03,149
[Music]

2
00:00:13,820 --> 00:00:21,840
[Music]

3
00:00:23,359 --> 00:00:24,640
hello everyone

4
00:00:24,640 --> 00:00:28,640
thank you for remain here this

5
00:00:28,640 --> 00:00:32,558
nice saturday afternoon um

6
00:00:32,558 --> 00:00:35,200
all right so uh kudos to everyone that

7
00:00:35,200 --> 00:00:36,079
had spoken

8
00:00:36,079 --> 00:00:39,360
uh previously uh tommy is it awesome

9
00:00:39,360 --> 00:00:41,760
um we'll talk about a little tom in a

10
00:00:41,760 --> 00:00:42,480
moment

11
00:00:42,480 --> 00:00:44,160
um so we're going to talk about silver

12
00:00:44,160 --> 00:00:46,239
spyro is a mac malware and this is a bit

13
00:00:46,239 --> 00:00:48,239
of a story about that malware

14
00:00:48,239 --> 00:00:51,520
and how uh we use threat hunting to

15
00:00:51,520 --> 00:00:53,760
help us uncover it and keep an eye on it

16
00:00:53,760 --> 00:00:56,000
as uh the story unfolded

17
00:00:56,000 --> 00:00:59,120
um so you're in mayhem 2021. uh the

18
00:00:59,120 --> 00:01:01,680
agenda for today is a little bit about

19
00:01:01,680 --> 00:01:03,120
us who we are

20
00:01:03,120 --> 00:01:04,640
uh we're going to do a little recap of

21
00:01:04,640 --> 00:01:06,400
silver spyro

22
00:01:06,400 --> 00:01:07,520
uh we're going to talk about thread

23
00:01:07,520 --> 00:01:09,680
hunting um then we're going to do

24
00:01:09,680 --> 00:01:11,360
another review of silver sparrow from

25
00:01:11,360 --> 00:01:12,560
our point of view

26
00:01:12,560 --> 00:01:13,920
and you know some take away something

27
00:01:13,920 --> 00:01:16,240
that maybe might be useful to you

28
00:01:16,240 --> 00:01:19,680
and we've got time some questions um

29
00:01:19,680 --> 00:01:23,280
so really quick about us um i am part of

30
00:01:23,280 --> 00:01:24,400
the paranoids team

31
00:01:24,400 --> 00:01:27,759
uh you know tommy is um

32
00:01:27,759 --> 00:01:30,159
a hacker that goes to hacker one and uh

33
00:01:30,159 --> 00:01:32,400
he keeps his business sometimes you know

34
00:01:32,400 --> 00:01:34,560
my instant response and he's part of the

35
00:01:34,560 --> 00:01:36,079
paranoids program so

36
00:01:36,079 --> 00:01:37,920
it's kind of nice to see him talk about

37
00:01:37,920 --> 00:01:39,360
his experience

38
00:01:39,360 --> 00:01:42,720
um so this talk is made possible by

39
00:01:42,720 --> 00:01:46,000
other co-worker um he's going by agent k

40
00:01:46,000 --> 00:01:48,799
in this case so agent k thank you for

41
00:01:48,799 --> 00:01:49,520
all the work

42
00:01:49,520 --> 00:01:51,040
and you know the fun times we spend on

43
00:01:51,040 --> 00:01:52,960
doing some of this this work

44
00:01:52,960 --> 00:01:55,680
um and i i go by plug my name is

45
00:01:55,680 --> 00:01:56,880
actually carlos

46
00:01:56,880 --> 00:01:59,520
um i'm into synthetizers you probably

47
00:01:59,520 --> 00:02:01,119
can see something in the back

48
00:02:01,119 --> 00:02:03,600
and uh i lead the trek hunting program

49
00:02:03,600 --> 00:02:05,360
um for the paranoids

50
00:02:05,360 --> 00:02:08,399
and i do insulin response

51
00:02:08,399 --> 00:02:12,720
um so let's jump into silver spiral now

52
00:02:12,720 --> 00:02:14,160
uh this stuff might be a little dense at

53
00:02:14,160 --> 00:02:14,640
times

54
00:02:14,640 --> 00:02:16,400
so where with me i'm going to try to you

55
00:02:16,400 --> 00:02:18,319
know dissect everything and make it

56
00:02:18,319 --> 00:02:19,360
super easy

57
00:02:19,360 --> 00:02:22,560
uh solar sparrow is a malware that came

58
00:02:22,560 --> 00:02:24,800
to light on february 18 to 20

59
00:02:24,800 --> 00:02:28,239
2021 um you can see here screenshot of

60
00:02:28,239 --> 00:02:29,920
the news it made the news

61
00:02:29,920 --> 00:02:33,840
um because it was um a very or is a very

62
00:02:33,840 --> 00:02:36,959
interesting piece of malware

63
00:02:36,959 --> 00:02:40,239
so this malware made the news because

64
00:02:40,239 --> 00:02:43,440
it did it was the first one quotes that

65
00:02:43,440 --> 00:02:44,319
actually

66
00:02:44,319 --> 00:02:47,440
targeted both macos intel processors

67
00:02:47,440 --> 00:02:50,640
and the new m1 arm processors so it was

68
00:02:50,640 --> 00:02:51,200
able to

69
00:02:51,200 --> 00:02:54,239
basically infect both types of machines

70
00:02:54,239 --> 00:02:57,920
that was a new um but for us

71
00:02:57,920 --> 00:02:59,920
what these malware did it kind of hinted

72
00:02:59,920 --> 00:03:02,080
to a larger ecosystem

73
00:03:02,080 --> 00:03:05,519
and um you know the potential for

74
00:03:05,519 --> 00:03:07,440
you know supply chain paper installed

75
00:03:07,440 --> 00:03:09,519
scheme and we'll talk about more what

76
00:03:09,519 --> 00:03:11,680
that might mean

77
00:03:11,680 --> 00:03:14,560
um so the full recap of why this malware

78
00:03:14,560 --> 00:03:15,440
is interested is

79
00:03:15,440 --> 00:03:18,959
it infected both intel and arm chips

80
00:03:18,959 --> 00:03:21,440
according to news there were about 29 30

81
00:03:21,440 --> 00:03:25,519
even upper numbers of infected hosts

82
00:03:25,519 --> 00:03:28,519
the activity started since late august

83
00:03:28,519 --> 00:03:31,360
2020 and it made the news

84
00:03:31,360 --> 00:03:33,760
later in february so this model was

85
00:03:33,760 --> 00:03:35,280
active for quite some time

86
00:03:35,280 --> 00:03:38,640
until it made the headlines now the most

87
00:03:38,640 --> 00:03:39,760
interesting or one of the most

88
00:03:39,760 --> 00:03:41,599
interesting things perhaps is that there

89
00:03:41,599 --> 00:03:42,640
was no payload

90
00:03:42,640 --> 00:03:44,799
malware got installed on your machine

91
00:03:44,799 --> 00:03:46,400
and then

92
00:03:46,400 --> 00:03:48,959
nothing happened a the secondary payload

93
00:03:48,959 --> 00:03:50,400
that you would expect that does

94
00:03:50,400 --> 00:03:52,239
whatever the malware is supposed to do

95
00:03:52,239 --> 00:03:55,040
never arrived and that made this malware

96
00:03:55,040 --> 00:03:58,319
a lot and a lot more interesting

97
00:03:58,319 --> 00:04:01,040
part of the whole you know um part of

98
00:04:01,040 --> 00:04:01,680
the malware

99
00:04:01,680 --> 00:04:05,040
is there was these mysterious um that

100
00:04:05,040 --> 00:04:08,640
um into file and it wasn't sure

101
00:04:08,640 --> 00:04:11,040
no one knew what the purpose of that

102
00:04:11,040 --> 00:04:12,879
file is so we're gonna try to answer

103
00:04:12,879 --> 00:04:13,920
that

104
00:04:13,920 --> 00:04:16,959
in here and we're going to try to answer

105
00:04:16,959 --> 00:04:19,519
that through thread hunting

106
00:04:19,519 --> 00:04:23,199
point of view so for us

107
00:04:23,199 --> 00:04:24,880
this led into this talk you know what is

108
00:04:24,880 --> 00:04:26,880
this mysterious insuffio and what you

109
00:04:26,880 --> 00:04:28,479
see in there is the actual picture of my

110
00:04:28,479 --> 00:04:30,960
coworker

111
00:04:31,360 --> 00:04:33,759
now i want to deter a little bit because

112
00:04:33,759 --> 00:04:35,440
what i do is thread hunting

113
00:04:35,440 --> 00:04:37,280
and one of the things that help us in

114
00:04:37,280 --> 00:04:39,199
this case is to actually do thread hunt

115
00:04:39,199 --> 00:04:40,479
and we were able to find

116
00:04:40,479 --> 00:04:42,960
attp and that helped us cover so the

117
00:04:42,960 --> 00:04:44,320
spiral as it evolved

118
00:04:44,320 --> 00:04:46,560
so because i do threat hunting and

119
00:04:46,560 --> 00:04:47,919
threat hunting is an interesting topic

120
00:04:47,919 --> 00:04:49,199
that a lot of people are jumping and i

121
00:04:49,199 --> 00:04:50,880
felt it was important to address it so

122
00:04:50,880 --> 00:04:52,479
let's kind of deviate a little bit from

123
00:04:52,479 --> 00:04:53,199
here

124
00:04:53,199 --> 00:04:54,880
now one of the things that i like to

125
00:04:54,880 --> 00:04:56,240
talk when i do the hunting is this

126
00:04:56,240 --> 00:04:58,400
concept of the nonan unknowns

127
00:04:58,400 --> 00:05:00,560
and we're gonna read this quote really

128
00:05:00,560 --> 00:05:02,080
quick this quote was done by

129
00:05:02,080 --> 00:05:04,560
donald rumsfeld um it happened during

130
00:05:04,560 --> 00:05:05,120
the

131
00:05:05,120 --> 00:05:08,080
iraq war um and he quoted this and

132
00:05:08,080 --> 00:05:10,000
usually we'll put a video but

133
00:05:10,000 --> 00:05:13,199
it says there are known nouns that are

134
00:05:13,199 --> 00:05:14,240
things we know

135
00:05:14,240 --> 00:05:17,199
that we know there are no new nouns that

136
00:05:17,199 --> 00:05:18,240
is to say

137
00:05:18,240 --> 00:05:21,039
that are things that we know know we

138
00:05:21,039 --> 00:05:22,080
don't know

139
00:05:22,080 --> 00:05:24,479
but there are also known unknowns that

140
00:05:24,479 --> 00:05:25,120
are things

141
00:05:25,120 --> 00:05:28,320
we don't know we don't know and if

142
00:05:28,320 --> 00:05:29,280
you're wondering

143
00:05:29,280 --> 00:05:32,479
what does that mean i don't blame you

144
00:05:32,479 --> 00:05:34,479
so let's kind of unfold what that means

145
00:05:34,479 --> 00:05:35,919
and why this is important

146
00:05:35,919 --> 00:05:37,680
for many things we do especially when

147
00:05:37,680 --> 00:05:39,360
you do treat hunting

148
00:05:39,360 --> 00:05:41,840
so there are known knowns there are no

149
00:05:41,840 --> 00:05:44,000
new nouns that are unknown knowns and

150
00:05:44,000 --> 00:05:46,800
then there are the unknown unknowns

151
00:05:46,800 --> 00:05:48,160
when i do tread hunting i thoroughly

152
00:05:48,160 --> 00:05:50,479
concentrate on the last one so let's

153
00:05:50,479 --> 00:05:53,680
talk about what the non-unknowns are so

154
00:05:53,680 --> 00:05:57,199
um in this case a known

155
00:05:57,199 --> 00:05:59,680
is and no knowns are the things that we

156
00:05:59,680 --> 00:06:00,720
know like us

157
00:06:00,720 --> 00:06:03,039
you know the security team on a company

158
00:06:03,039 --> 00:06:04,880
and also an adversary nodes

159
00:06:04,880 --> 00:06:07,360
right so for example we know that we

160
00:06:07,360 --> 00:06:08,479
have a firewall in

161
00:06:08,479 --> 00:06:11,919
officex but the adversary knows about

162
00:06:11,919 --> 00:06:13,600
that firewall because they discovered

163
00:06:13,600 --> 00:06:14,960
through some network scans

164
00:06:14,960 --> 00:06:17,919
so we both know about that firewall then

165
00:06:17,919 --> 00:06:18,560
there are the

166
00:06:18,560 --> 00:06:20,639
known unknowns now this one is on our

167
00:06:20,639 --> 00:06:22,240
favor because we know about it

168
00:06:22,240 --> 00:06:23,919
but the adversary doesn't know so the

169
00:06:23,919 --> 00:06:26,560
things we know and an adversary does not

170
00:06:26,560 --> 00:06:27,360
know

171
00:06:27,360 --> 00:06:29,600
for example we use an application x to

172
00:06:29,600 --> 00:06:30,720
protect our company

173
00:06:30,720 --> 00:06:32,639
we have some secret sauce no one knows

174
00:06:32,639 --> 00:06:34,720
about it but that resort doesn't know it

175
00:06:34,720 --> 00:06:37,600
so we got the upper head in that case

176
00:06:37,600 --> 00:06:38,800
now we get into the interesting

177
00:06:38,800 --> 00:06:40,479
territory these are the things that are

178
00:06:40,479 --> 00:06:42,080
the unknown knowns

179
00:06:42,080 --> 00:06:44,080
this is actually where things don't work

180
00:06:44,080 --> 00:06:45,280
in our favor

181
00:06:45,280 --> 00:06:47,520
the things we don't know but an

182
00:06:47,520 --> 00:06:48,720
adversary knows

183
00:06:48,720 --> 00:06:50,960
a good example of this could be maybe an

184
00:06:50,960 --> 00:06:52,960
employee-like credentials in github

185
00:06:52,960 --> 00:06:54,800
right we're not aware maybe our

186
00:06:54,800 --> 00:06:56,000
detections didn't trigger

187
00:06:56,000 --> 00:06:58,160
for whatever reason we don't know but

188
00:06:58,160 --> 00:07:00,319
maybe an adversary has kept eye

189
00:07:00,319 --> 00:07:02,240
on those credentials and now they're

190
00:07:02,240 --> 00:07:03,759
aware of them and they could use them

191
00:07:03,759 --> 00:07:04,560
against us

192
00:07:04,560 --> 00:07:07,759
we don't know they know about it

193
00:07:07,759 --> 00:07:09,759
the more interesting part is the things

194
00:07:09,759 --> 00:07:11,120
that we don't know

195
00:07:11,120 --> 00:07:13,759
and they don't know the unknown unknowns

196
00:07:13,759 --> 00:07:14,400
so

197
00:07:14,400 --> 00:07:16,880
what what is this unknown unknowns so

198
00:07:16,880 --> 00:07:17,919
again things we

199
00:07:17,919 --> 00:07:20,400
might not know but i never say it might

200
00:07:20,400 --> 00:07:21,360
not know either

201
00:07:21,360 --> 00:07:24,160
we're both kind of blind to that a good

202
00:07:24,160 --> 00:07:25,440
example of this would be maybe an

203
00:07:25,440 --> 00:07:26,800
employee did a network

204
00:07:26,800 --> 00:07:29,680
change in a router firewall and an

205
00:07:29,680 --> 00:07:30,000
access

206
00:07:30,000 --> 00:07:32,720
list an acl got dropped but now people

207
00:07:32,720 --> 00:07:34,240
can connect from the internet

208
00:07:34,240 --> 00:07:37,199
to systems that they shouldn't um for

209
00:07:37,199 --> 00:07:38,240
whatever reason

210
00:07:38,240 --> 00:07:39,919
we don't know about that and an

211
00:07:39,919 --> 00:07:41,840
adversary does it not yet so we're blind

212
00:07:41,840 --> 00:07:42,479
to it

213
00:07:42,479 --> 00:07:45,120
uh maybe the antivirus in your office

214
00:07:45,120 --> 00:07:46,160
stopped working

215
00:07:46,160 --> 00:07:48,160
it didn't trigger an alert i don't know

216
00:07:48,160 --> 00:07:50,080
but an adversary doesn't know either

217
00:07:50,080 --> 00:07:52,960
and so they couldn't use that against us

218
00:07:52,960 --> 00:07:54,400
so

219
00:07:54,400 --> 00:07:55,759
now that we know a little bit what all

220
00:07:55,759 --> 00:07:58,000
of these combinations or nones are

221
00:07:58,000 --> 00:08:00,639
how do we find the known unknowns what

222
00:08:00,639 --> 00:08:02,319
do what do we do about that

223
00:08:02,319 --> 00:08:04,080
well this is why we use threat hunting

224
00:08:04,080 --> 00:08:05,440
tree hunting will be

225
00:08:05,440 --> 00:08:07,520
one way in which we can find all of

226
00:08:07,520 --> 00:08:08,639
these things

227
00:08:08,639 --> 00:08:10,479
but before we jump into that you know

228
00:08:10,479 --> 00:08:12,800
let's define what is threat hunting

229
00:08:12,800 --> 00:08:14,960
now in wikipedia there is this

230
00:08:14,960 --> 00:08:17,199
definition of what threat hunting is

231
00:08:17,199 --> 00:08:19,280
and according to that is the process of

232
00:08:19,280 --> 00:08:20,639
proactively and

233
00:08:20,639 --> 00:08:22,720
iteratively searching through networks

234
00:08:22,720 --> 00:08:24,960
to detect and isolate advanced threats

235
00:08:24,960 --> 00:08:28,560
that evade existing security solutions i

236
00:08:28,560 --> 00:08:31,039
think that it's actually too complex of

237
00:08:31,039 --> 00:08:32,320
a description

238
00:08:32,320 --> 00:08:34,799
and for me it is actually much more

239
00:08:34,799 --> 00:08:36,240
simple trey hunting is just a

240
00:08:36,240 --> 00:08:37,599
methodology

241
00:08:37,599 --> 00:08:40,000
to proactively look for the unknown

242
00:08:40,000 --> 00:08:40,799
unknowns

243
00:08:40,799 --> 00:08:42,479
and we talk about what those things

244
00:08:42,479 --> 00:08:44,800
might be

245
00:08:44,880 --> 00:08:47,440
so i already did a talk about this you

246
00:08:47,440 --> 00:08:49,200
can find it if you you know search for

247
00:08:49,200 --> 00:08:49,839
for plugged

248
00:08:49,839 --> 00:08:52,320
hunting but one of the things that is is

249
00:08:52,320 --> 00:08:53,120
very important

250
00:08:53,120 --> 00:08:55,839
in my case is that all the three content

251
00:08:55,839 --> 00:08:57,839
i do is hypothesis based i come up with

252
00:08:57,839 --> 00:08:59,920
a hypothesis and i use that to

253
00:08:59,920 --> 00:09:02,000
basically do everything else that goes

254
00:09:02,000 --> 00:09:03,120
from there on

255
00:09:03,120 --> 00:09:05,760
and it i found that is extremely useful

256
00:09:05,760 --> 00:09:06,560
and it is

257
00:09:06,560 --> 00:09:08,080
probably the best way to approach today

258
00:09:08,080 --> 00:09:10,959
hunting in my opinion

259
00:09:10,959 --> 00:09:12,240
and the reason why a hypothesis is

260
00:09:12,240 --> 00:09:14,000
important is because by definition it's

261
00:09:14,000 --> 00:09:16,160
a superstition or proposed explanation

262
00:09:16,160 --> 00:09:18,560
and you kind of have to um you don't

263
00:09:18,560 --> 00:09:19,920
have evidence you have to choose the

264
00:09:19,920 --> 00:09:21,600
evidence develop experiments

265
00:09:21,600 --> 00:09:23,519
and it's through that investigation that

266
00:09:23,519 --> 00:09:25,200
you will decide

267
00:09:25,200 --> 00:09:27,680
whether you found an answer for your

268
00:09:27,680 --> 00:09:29,440
hypothesis you prove it or disprove it

269
00:09:29,440 --> 00:09:30,720
that's the ultimate goal

270
00:09:30,720 --> 00:09:33,360
so that's why i like it when i do

271
00:09:33,360 --> 00:09:34,880
hypothesis

272
00:09:34,880 --> 00:09:36,880
one of the things that i try to follow

273
00:09:36,880 --> 00:09:38,399
is use the the

274
00:09:38,399 --> 00:09:41,680
six w's who what why

275
00:09:41,680 --> 00:09:45,040
where when and how how am i gonna hunt

276
00:09:45,040 --> 00:09:47,279
for this data now this is where it gets

277
00:09:47,279 --> 00:09:49,200
really complex for a lot of people

278
00:09:49,200 --> 00:09:51,920
but in reality threat hunting is

279
00:09:51,920 --> 00:09:53,600
basically leveraging just you're seeing

280
00:09:53,600 --> 00:09:55,120
for the most part at the end of the day

281
00:09:55,120 --> 00:09:56,959
if you don't do any tests or anything

282
00:09:56,959 --> 00:09:58,880
you know and so what you're going to do

283
00:09:58,880 --> 00:10:01,200
is you're just going to generate queries

284
00:10:01,200 --> 00:10:03,200
to go and try to answer the question

285
00:10:03,200 --> 00:10:04,720
that you set yourself to

286
00:10:04,720 --> 00:10:07,600
go and prove or disprove and ideally

287
00:10:07,600 --> 00:10:10,000
your queries will be designed to

288
00:10:10,000 --> 00:10:12,880
answer those questions where what when

289
00:10:12,880 --> 00:10:13,519
right

290
00:10:13,519 --> 00:10:16,720
and so that really in a nutshell is

291
00:10:16,720 --> 00:10:20,160
three hunting and if you want to try it

292
00:10:20,160 --> 00:10:20,560
that's

293
00:10:20,560 --> 00:10:22,560
really all you really need to do come up

294
00:10:22,560 --> 00:10:23,920
with a hypothesis the bullets and

295
00:10:23,920 --> 00:10:24,720
queries

296
00:10:24,720 --> 00:10:26,480
of your goal and privilege to prove what

297
00:10:26,480 --> 00:10:28,399
you have now there's a lot more to it

298
00:10:28,399 --> 00:10:28,640
and

299
00:10:28,640 --> 00:10:30,320
like i said there's a talk about it and

300
00:10:30,320 --> 00:10:32,240
everyone wants more dive into it

301
00:10:32,240 --> 00:10:34,640
you know i'll be around but now that we

302
00:10:34,640 --> 00:10:36,079
more or less explain what

303
00:10:36,079 --> 00:10:40,320
um trey hunting might be right um let's

304
00:10:40,320 --> 00:10:42,560
kind of end this uh detour and then dive

305
00:10:42,560 --> 00:10:43,440
into

306
00:10:43,440 --> 00:10:47,680
these persistent um item so

307
00:10:47,680 --> 00:10:50,800
one of the things that led me into this

308
00:10:50,800 --> 00:10:51,360
talk and

309
00:10:51,360 --> 00:10:53,600
us to uncover something is research

310
00:10:53,600 --> 00:10:54,959
sometimes when you interact you want to

311
00:10:54,959 --> 00:10:56,240
do some research

312
00:10:56,240 --> 00:10:59,279
and in mac os there is

313
00:10:59,279 --> 00:11:01,920
these concept of the launch agents and

314
00:11:01,920 --> 00:11:03,440
demons so let's explain that a little

315
00:11:03,440 --> 00:11:04,800
bit what they are

316
00:11:04,800 --> 00:11:07,279
so normally you have what is called a p

317
00:11:07,279 --> 00:11:07,920
list

318
00:11:07,920 --> 00:11:09,920
plus is the configuration file that

319
00:11:09,920 --> 00:11:11,600
tells um

320
00:11:11,600 --> 00:11:14,320
you know the demon or the agent to start

321
00:11:14,320 --> 00:11:15,120
stop

322
00:11:15,120 --> 00:11:18,320
and what will happen is that you kind of

323
00:11:18,320 --> 00:11:20,720
have the two kinds the launch demon

324
00:11:20,720 --> 00:11:23,519
usually runs without a logged on user

325
00:11:23,519 --> 00:11:24,720
there is no gui

326
00:11:24,720 --> 00:11:27,120
interaction it's throwing the passes

327
00:11:27,120 --> 00:11:28,000
that you see in here

328
00:11:28,000 --> 00:11:29,519
and it's important that you are familiar

329
00:11:29,519 --> 00:11:31,839
with these pads um

330
00:11:31,839 --> 00:11:33,680
it looks like it's an xml file for the

331
00:11:33,680 --> 00:11:35,279
most part and it looks like the way you

332
00:11:35,279 --> 00:11:36,160
see it on the

333
00:11:36,160 --> 00:11:39,360
on the on the screen um and then you

334
00:11:39,360 --> 00:11:40,560
have also the launch

335
00:11:40,560 --> 00:11:42,640
agents and the launch changes basically

336
00:11:42,640 --> 00:11:44,640
is another plus file

337
00:11:44,640 --> 00:11:46,800
that looks exactly the same the

338
00:11:46,800 --> 00:11:47,839
difference is

339
00:11:47,839 --> 00:11:50,160
these are associated with a user the

340
00:11:50,160 --> 00:11:51,519
user must be logged on

341
00:11:51,519 --> 00:11:54,240
right so you log on agent kicks in there

342
00:11:54,240 --> 00:11:56,240
might be google interaction

343
00:11:56,240 --> 00:11:59,120
uh there are store and different paths

344
00:11:59,120 --> 00:12:01,279
within the operating system

345
00:12:01,279 --> 00:12:03,360
um and the way that you can think about

346
00:12:03,360 --> 00:12:05,279
all of these is there are analogous to

347
00:12:05,279 --> 00:12:07,839
the wrong keys or the servers in windows

348
00:12:07,839 --> 00:12:08,480
so

349
00:12:08,480 --> 00:12:10,320
um you know they they're kind of like

350
00:12:10,320 --> 00:12:12,079
the startup file that tells the service

351
00:12:12,079 --> 00:12:13,680
this is the conditions you need to

352
00:12:13,680 --> 00:12:15,680
actually go and run

353
00:12:15,680 --> 00:12:18,079
and so if you want to get persistence in

354
00:12:18,079 --> 00:12:20,560
mac os then you need to somehow deploy

355
00:12:20,560 --> 00:12:21,839
one of this

356
00:12:21,839 --> 00:12:24,639
and use it to leave your shell running

357
00:12:24,639 --> 00:12:26,639
or malware

358
00:12:26,639 --> 00:12:28,639
so that led me into but do a little bit

359
00:12:28,639 --> 00:12:30,480
of research and i'm gonna walk you more

360
00:12:30,480 --> 00:12:31,200
or less

361
00:12:31,200 --> 00:12:32,320
you know because we're using the thread

362
00:12:32,320 --> 00:12:34,240
hunting perspective to kind of see

363
00:12:34,240 --> 00:12:36,079
what will be the roadmap like if you

364
00:12:36,079 --> 00:12:37,920
wanted to do this how would you do it so

365
00:12:37,920 --> 00:12:39,120
the first thing i did is

366
00:12:39,120 --> 00:12:41,600
well let's first look at miner and for

367
00:12:41,600 --> 00:12:43,360
those of you that are new mitre

368
00:12:43,360 --> 00:12:46,639
is a us government

369
00:12:46,639 --> 00:12:48,240
agency or not agency like our

370
00:12:48,240 --> 00:12:50,399
organization not for profit

371
00:12:50,399 --> 00:12:53,440
and they developed these uh att and ck

372
00:12:53,440 --> 00:12:54,160
framework

373
00:12:54,160 --> 00:12:57,360
basically is a way to um map

374
00:12:57,360 --> 00:13:00,160
um adversaries and their tactics and

375
00:13:00,160 --> 00:13:01,040
techniques

376
00:13:01,040 --> 00:13:03,120
you know and how they've used them

377
00:13:03,120 --> 00:13:04,959
across the kilo chain you compromise

378
00:13:04,959 --> 00:13:05,600
something

379
00:13:05,600 --> 00:13:07,040
you know there's this chain that you

380
00:13:07,040 --> 00:13:08,959
normally follow and these

381
00:13:08,959 --> 00:13:10,800
is a way to document all the different

382
00:13:10,800 --> 00:13:12,240
things that multiple

383
00:13:12,240 --> 00:13:14,320
actors have used so it's a good way for

384
00:13:14,320 --> 00:13:15,519
you to figure out

385
00:13:15,519 --> 00:13:17,360
you know what research has been done or

386
00:13:17,360 --> 00:13:19,200
maybe the things you want to try haunt

387
00:13:19,200 --> 00:13:20,160
are the things you want to develop

388
00:13:20,160 --> 00:13:21,440
detections for so

389
00:13:21,440 --> 00:13:23,360
i just went there and you know we're

390
00:13:23,360 --> 00:13:24,800
looking at plus files right because

391
00:13:24,800 --> 00:13:26,560
after all i want to look for the

392
00:13:26,560 --> 00:13:29,440
uh launch demons and agents so i just

393
00:13:29,440 --> 00:13:31,360
did that i searched for that

394
00:13:31,360 --> 00:13:34,079
then i color coded minor you know map

395
00:13:34,079 --> 00:13:34,720
just to see

396
00:13:34,720 --> 00:13:37,519
you know where there was data and you

397
00:13:37,519 --> 00:13:38,480
know zoom in

398
00:13:38,480 --> 00:13:40,160
in to expand that now you have sub

399
00:13:40,160 --> 00:13:41,600
techniques so expanded

400
00:13:41,600 --> 00:13:42,880
and as you can see somewhere in here

401
00:13:42,880 --> 00:13:44,480
there's the launch agents and launch

402
00:13:44,480 --> 00:13:45,360
demons

403
00:13:45,360 --> 00:13:48,639
so what i did then is i started doing

404
00:13:48,639 --> 00:13:49,199
some

405
00:13:49,199 --> 00:13:50,959
small research you know what else i can

406
00:13:50,959 --> 00:13:53,040
do and i come across julius body

407
00:13:53,040 --> 00:13:54,880
i was not familiar with pilla's body

408
00:13:54,880 --> 00:13:56,079
honestly at the time i

409
00:13:56,079 --> 00:13:58,560
i i was familiar but not to this level

410
00:13:58,560 --> 00:13:59,600
i've seen it

411
00:13:59,600 --> 00:14:02,720
um but i didn't pay attention to it

412
00:14:02,720 --> 00:14:05,040
so please buddy is basically a program

413
00:14:05,040 --> 00:14:06,880
that is provided with mac os

414
00:14:06,880 --> 00:14:09,519
and it allows you to create or edit the

415
00:14:09,519 --> 00:14:10,800
pls files that are

416
00:14:10,800 --> 00:14:12,639
in the operating system basically these

417
00:14:12,639 --> 00:14:15,760
xml type files that i talk about early

418
00:14:15,760 --> 00:14:18,639
now what i did next is well is there

419
00:14:18,639 --> 00:14:19,680
like someone has

420
00:14:19,680 --> 00:14:22,079
actually done a lobbying like a living

421
00:14:22,079 --> 00:14:23,760
of the land and leveraged this tool to

422
00:14:23,760 --> 00:14:24,880
do something

423
00:14:24,880 --> 00:14:27,920
and i don't find anything so i did

424
00:14:27,920 --> 00:14:30,399
what i will do i basically started

425
00:14:30,399 --> 00:14:32,720
searching for things right you know

426
00:14:32,720 --> 00:14:36,160
yahooing googling um and

427
00:14:36,160 --> 00:14:37,920
i didn't find anything i found a bunch

428
00:14:37,920 --> 00:14:39,920
of blog posts about how to properly use

429
00:14:39,920 --> 00:14:40,880
it

430
00:14:40,880 --> 00:14:42,959
i went to github and i didn't find any

431
00:14:42,959 --> 00:14:44,959
offensive tools that were leveraging at

432
00:14:44,959 --> 00:14:45,760
the time

433
00:14:45,760 --> 00:14:47,279
and there were no security projects that

434
00:14:47,279 --> 00:14:48,800
were using it so that become very

435
00:14:48,800 --> 00:14:49,600
interesting

436
00:14:49,600 --> 00:14:52,160
so all right off i go so i develop my

437
00:14:52,160 --> 00:14:53,519
hypotheses right

438
00:14:53,519 --> 00:14:56,320
so adversaries might be leveraging

439
00:14:56,320 --> 00:14:57,920
built-in operating operating system

440
00:14:57,920 --> 00:14:59,519
tools like philly's body

441
00:14:59,519 --> 00:15:01,199
to create persistence in order to avoid

442
00:15:01,199 --> 00:15:02,800
detection when running copying or

443
00:15:02,800 --> 00:15:03,600
installing

444
00:15:03,600 --> 00:15:06,959
pls files that was the idea well let's

445
00:15:06,959 --> 00:15:10,320
try to go through the process so read

446
00:15:10,320 --> 00:15:11,920
everything about pilla's body that i can

447
00:15:11,920 --> 00:15:13,600
do and

448
00:15:13,600 --> 00:15:17,199
um i figured out that there were

449
00:15:17,199 --> 00:15:18,800
in general by looking and doing a

450
00:15:18,800 --> 00:15:21,120
statistical analysis on all the meta

451
00:15:21,120 --> 00:15:22,720
all the telemetry that i have at my

452
00:15:22,720 --> 00:15:24,320
disposal that there were a few

453
00:15:24,320 --> 00:15:26,240
operations within pilla's body

454
00:15:26,240 --> 00:15:29,440
that can with a high level of confidence

455
00:15:29,440 --> 00:15:31,360
similar signal anomaly and i'm going to

456
00:15:31,360 --> 00:15:32,639
walk you through what that is

457
00:15:32,639 --> 00:15:34,000
so in other words there's a lot of

458
00:15:34,000 --> 00:15:35,519
pillars about activity if you you have

459
00:15:35,519 --> 00:15:35,839
them

460
00:15:35,839 --> 00:15:39,120
if you defend macos networks then you

461
00:15:39,120 --> 00:15:40,000
will see a lot of that

462
00:15:40,000 --> 00:15:42,560
but there are a few things that are very

463
00:15:42,560 --> 00:15:43,360
very rare

464
00:15:43,360 --> 00:15:44,560
and that gives you a high level of

465
00:15:44,560 --> 00:15:46,800
confidence to create detections

466
00:15:46,800 --> 00:15:50,160
so you know using plus body um i created

467
00:15:50,160 --> 00:15:51,279
a pill list and so this is the

468
00:15:51,279 --> 00:15:52,320
walkthrough of how

469
00:15:52,320 --> 00:15:54,160
i create the p list right so these are

470
00:15:54,160 --> 00:15:55,600
the steps i went and

471
00:15:55,600 --> 00:15:57,199
issue all of this command on my little

472
00:15:57,199 --> 00:15:59,360
terminal and i run all of this

473
00:15:59,360 --> 00:16:00,959
now i highlighted one in particular

474
00:16:00,959 --> 00:16:02,399
because this is the one that turned out

475
00:16:02,399 --> 00:16:03,120
to be

476
00:16:03,120 --> 00:16:05,199
very interesting because it allowed me

477
00:16:05,199 --> 00:16:06,800
to actually do the persistent

478
00:16:06,800 --> 00:16:09,279
and do something with it now after i

479
00:16:09,279 --> 00:16:10,560
created that little script

480
00:16:10,560 --> 00:16:13,040
then basically i wanted to review it

481
00:16:13,040 --> 00:16:13,759
does this look

482
00:16:13,759 --> 00:16:15,759
you know right and so basically i

483
00:16:15,759 --> 00:16:17,279
printed to the screen

484
00:16:17,279 --> 00:16:19,120
you know the script and you can actually

485
00:16:19,120 --> 00:16:21,519
see here the contents of that described

486
00:16:21,519 --> 00:16:23,120
for this particular test i'm not

487
00:16:23,120 --> 00:16:25,519
covering what i wanted to do is

488
00:16:25,519 --> 00:16:29,199
i had a little empire shell and i wanted

489
00:16:29,199 --> 00:16:30,320
to make sure that it

490
00:16:30,320 --> 00:16:32,560
basically will come back anytime that

491
00:16:32,560 --> 00:16:34,880
someone logged in or rebooted the system

492
00:16:34,880 --> 00:16:37,040
and what you see in here is that i'm

493
00:16:37,040 --> 00:16:39,199
basically trying to run python 3 and

494
00:16:39,199 --> 00:16:40,800
python 3 is going to point to

495
00:16:40,800 --> 00:16:43,680
you know that pi the hunt.pi file and

496
00:16:43,680 --> 00:16:44,639
it's going to

497
00:16:44,639 --> 00:16:46,480
run that at load so every time that

498
00:16:46,480 --> 00:16:47,920
someone um the

499
00:16:47,920 --> 00:16:51,199
system loads right so then

500
00:16:51,199 --> 00:16:52,720
one of the tests that i did is well

501
00:16:52,720 --> 00:16:54,320
let's test this manually let's let's see

502
00:16:54,320 --> 00:16:55,920
if this will actually

503
00:16:55,920 --> 00:17:00,000
um do something right and

504
00:17:00,000 --> 00:17:02,880
then it did um what you see in here is

505
00:17:02,880 --> 00:17:04,880
basically the result of my test

506
00:17:04,880 --> 00:17:06,799
what you could see in here is that the

507
00:17:06,799 --> 00:17:08,240
pillis body did run

508
00:17:08,240 --> 00:17:11,760
it was under python and basically i

509
00:17:11,760 --> 00:17:14,959
had my persistence so

510
00:17:14,959 --> 00:17:17,280
this was actually very important because

511
00:17:17,280 --> 00:17:19,599
at this stage i realized

512
00:17:19,599 --> 00:17:22,400
wait a second this runa load it is

513
00:17:22,400 --> 00:17:23,039
actually

514
00:17:23,039 --> 00:17:25,280
interesting and by digging a little bit

515
00:17:25,280 --> 00:17:27,839
further i found that

516
00:17:27,839 --> 00:17:29,919
it's almost rare it almost never

517
00:17:29,919 --> 00:17:32,160
happened in the way that i did it

518
00:17:32,160 --> 00:17:36,160
and that would have been a hint so

519
00:17:36,160 --> 00:17:39,600
what ended up happening is pilli's body

520
00:17:39,600 --> 00:17:42,000
at run ad load turned out to be an

521
00:17:42,000 --> 00:17:43,679
interesting artifact

522
00:17:43,679 --> 00:17:45,440
and it was a great way to create

523
00:17:45,440 --> 00:17:47,200
persistence there was no reference in

524
00:17:47,200 --> 00:17:48,160
any offensive

525
00:17:48,160 --> 00:17:51,440
blogs about it at that point in time no

526
00:17:51,440 --> 00:17:52,960
malware had used it before

527
00:17:52,960 --> 00:17:54,640
no malware i haven't seen them while

528
00:17:54,640 --> 00:17:56,080
we're doing that

529
00:17:56,080 --> 00:17:58,320
so for me it was a success yeah you know

530
00:17:58,320 --> 00:18:00,240
we found something cool and

531
00:18:00,240 --> 00:18:02,559
we're now kind of all about detection

532
00:18:02,559 --> 00:18:03,600
and so

533
00:18:03,600 --> 00:18:05,600
off you go we discovered a new

534
00:18:05,600 --> 00:18:07,200
persistent mechanism that had not been

535
00:18:07,200 --> 00:18:08,799
made public yet

536
00:18:08,799 --> 00:18:10,559
great or you know maybe someone knew

537
00:18:10,559 --> 00:18:13,039
about it which is not public

538
00:18:13,039 --> 00:18:16,160
so this is important because this pillis

539
00:18:16,160 --> 00:18:17,840
body activity became

540
00:18:17,840 --> 00:18:20,880
a key ttp that will help us uncover what

541
00:18:20,880 --> 00:18:22,240
will be known as silver

542
00:18:22,240 --> 00:18:25,840
sparrows so let's dive into silver

543
00:18:25,840 --> 00:18:27,679
spirals let's talk about what that is

544
00:18:27,679 --> 00:18:30,480
and you know what what what we knew and

545
00:18:30,480 --> 00:18:30,960
what

546
00:18:30,960 --> 00:18:33,120
maybe we can tell you now that maybe

547
00:18:33,120 --> 00:18:35,600
wasn't clear in the beginning

548
00:18:35,600 --> 00:18:37,600
so in order for us to understand silver

549
00:18:37,600 --> 00:18:39,440
spiral what we're going to talk is we're

550
00:18:39,440 --> 00:18:40,400
going to talk about two different

551
00:18:40,400 --> 00:18:41,520
clusters

552
00:18:41,520 --> 00:18:44,799
of malware and i'm gonna talk about you

553
00:18:44,799 --> 00:18:46,320
know those clusters we're gonna skip one

554
00:18:46,320 --> 00:18:47,039
of them the

555
00:18:47,039 --> 00:18:50,160
the cl3 um no time for it but so the

556
00:18:50,160 --> 00:18:51,360
first cluster is what we call

557
00:18:51,360 --> 00:18:52,640
overlapping techniques

558
00:18:52,640 --> 00:18:54,799
right so these are infections that took

559
00:18:54,799 --> 00:18:55,679
place

560
00:18:55,679 --> 00:18:58,640
just weeks prior to silver spiral they

561
00:18:58,640 --> 00:19:00,960
both share similar techniques or iocs

562
00:19:00,960 --> 00:19:02,960
as reported in silver spiral reports

563
00:19:02,960 --> 00:19:05,120
right then there is the silver spiral

564
00:19:05,120 --> 00:19:06,160
infections

565
00:19:06,160 --> 00:19:08,240
and these are infections that we saw

566
00:19:08,240 --> 00:19:10,559
took place on both intel and mi

567
00:19:10,559 --> 00:19:13,840
uh processors and then the last cluster

568
00:19:13,840 --> 00:19:15,679
uh is an instance case in which we

569
00:19:15,679 --> 00:19:16,880
actually sell

570
00:19:16,880 --> 00:19:20,160
um silver sparrow turn install um

571
00:19:20,160 --> 00:19:22,640
itself in uh next to another piece of

572
00:19:22,640 --> 00:19:24,240
malware and how it tried to kind of

573
00:19:24,240 --> 00:19:25,360
remove itself

574
00:19:25,360 --> 00:19:27,760
and you know the poor job that it did at

575
00:19:27,760 --> 00:19:29,760
that and it was actually fascinating to

576
00:19:29,760 --> 00:19:31,120
see it to be honest

577
00:19:31,120 --> 00:19:33,360
um but we're going to concentrate on

578
00:19:33,360 --> 00:19:35,039
this cluster one for a period of time

579
00:19:35,039 --> 00:19:36,240
because these will be the clauses that

580
00:19:36,240 --> 00:19:37,039
will provide

581
00:19:37,039 --> 00:19:39,440
some of the key answers part of the

582
00:19:39,440 --> 00:19:40,799
beauty of this malware is that there

583
00:19:40,799 --> 00:19:42,640
were a few nodes what was the purpose

584
00:19:42,640 --> 00:19:44,480
what was the insu file for

585
00:19:44,480 --> 00:19:46,559
so let's look into that mysterious

586
00:19:46,559 --> 00:19:49,039
insult file

587
00:19:49,039 --> 00:19:52,240
so like i said we created a cluster and

588
00:19:52,240 --> 00:19:54,080
we looked into the insta file what is

589
00:19:54,080 --> 00:19:55,440
this insta file

590
00:19:55,440 --> 00:19:58,080
so from our telemetry the first time we

591
00:19:58,080 --> 00:19:58,799
actually saw

592
00:19:58,799 --> 00:20:00,960
the insta file on our telemetry was on

593
00:20:00,960 --> 00:20:02,080
august 14

594
00:20:02,080 --> 00:20:06,000
2020. now

595
00:20:06,000 --> 00:20:08,720
what we basically can tell you is that

596
00:20:08,720 --> 00:20:09,919
the insult

597
00:20:09,919 --> 00:20:12,240
is just an artifact that was left over

598
00:20:12,240 --> 00:20:14,080
by other malware

599
00:20:14,080 --> 00:20:16,640
it had nothing to do with silver spiral

600
00:20:16,640 --> 00:20:18,240
it came from another malware

601
00:20:18,240 --> 00:20:20,559
could it be that the same developer or

602
00:20:20,559 --> 00:20:22,880
the same fervor was used in the past

603
00:20:22,880 --> 00:20:25,200
possible but it's not connected to

604
00:20:25,200 --> 00:20:26,640
silver spiral

605
00:20:26,640 --> 00:20:28,320
it's basically an empty file that gets

606
00:20:28,320 --> 00:20:29,840
created during infection

607
00:20:29,840 --> 00:20:33,679
right and we basically use that file to

608
00:20:33,679 --> 00:20:34,960
find a cluster

609
00:20:34,960 --> 00:20:36,720
now this cluster is actually quite

610
00:20:36,720 --> 00:20:38,720
interesting so if you have some

611
00:20:38,720 --> 00:20:40,400
virus total here are some of the b

612
00:20:40,400 --> 00:20:42,000
hashes you need to have like a special

613
00:20:42,000 --> 00:20:42,720
account to

614
00:20:42,720 --> 00:20:44,640
go and look at that intelligence data

615
00:20:44,640 --> 00:20:46,240
but i have some screenshots for you

616
00:20:46,240 --> 00:20:48,880
so basically if you go and start looking

617
00:20:48,880 --> 00:20:50,480
into the insta cluster

618
00:20:50,480 --> 00:20:52,240
you're gonna find a few interesting

619
00:20:52,240 --> 00:20:53,760
hashes but

620
00:20:53,760 --> 00:20:56,080
there's also something very interesting

621
00:20:56,080 --> 00:20:57,919
if you take a look at the name of the

622
00:20:57,919 --> 00:20:59,919
application the word search keeps coming

623
00:20:59,919 --> 00:21:02,640
up public character search search net

624
00:21:02,640 --> 00:21:05,200
expert character search you go into a

625
00:21:05,200 --> 00:21:06,559
different cluster

626
00:21:06,559 --> 00:21:09,039
general channel search global toolbox

627
00:21:09,039 --> 00:21:10,159
search

628
00:21:10,159 --> 00:21:13,440
search search everywhere

629
00:21:13,440 --> 00:21:16,720
so these cluster one or insofar it's

630
00:21:16,720 --> 00:21:18,320
kind of interesting because

631
00:21:18,320 --> 00:21:21,200
um it a lot of the malware infections

632
00:21:21,200 --> 00:21:22,799
had to do with applications they had the

633
00:21:22,799 --> 00:21:24,080
word search or fine

634
00:21:24,080 --> 00:21:26,559
on them and that in itself is probably

635
00:21:26,559 --> 00:21:27,600
another talk for

636
00:21:27,600 --> 00:21:30,080
another time but it's one that you know

637
00:21:30,080 --> 00:21:32,400
it's actually interesting on its own

638
00:21:32,400 --> 00:21:34,320
and again it had nothing to do with

639
00:21:34,320 --> 00:21:35,679
silver spiral

640
00:21:35,679 --> 00:21:37,679
now this insta cluster was active for a

641
00:21:37,679 --> 00:21:38,720
few months

642
00:21:38,720 --> 00:21:40,480
um we like i said we only in our

643
00:21:40,480 --> 00:21:42,720
telemetry you saw it from august 14

644
00:21:42,720 --> 00:21:44,799
to the ninth i want to remind everyone

645
00:21:44,799 --> 00:21:47,200
we're not at like anti-providers or like

646
00:21:47,200 --> 00:21:47,679
a

647
00:21:47,679 --> 00:21:49,919
you know a security firm we're just

648
00:21:49,919 --> 00:21:52,080
basically a security team that is

649
00:21:52,080 --> 00:21:54,240
you know defending our network and so

650
00:21:54,240 --> 00:21:56,000
there might be a lot of data sets we

651
00:21:56,000 --> 00:21:57,200
don't have access

652
00:21:57,200 --> 00:21:59,520
so these states are from our point of

653
00:21:59,520 --> 00:22:01,039
view

654
00:22:01,039 --> 00:22:03,360
now the connection to silver spyro comes

655
00:22:03,360 --> 00:22:04,799
from the fact that

656
00:22:04,799 --> 00:22:07,600
this file was used in subspira so there

657
00:22:07,600 --> 00:22:08,720
was a check

658
00:22:08,720 --> 00:22:10,480
so what silverspire will come in and say

659
00:22:10,480 --> 00:22:12,640
hey if this file alexis i'm gonna remove

660
00:22:12,640 --> 00:22:15,440
it myself from this machine that i'm

661
00:22:15,440 --> 00:22:16,000
about to

662
00:22:16,000 --> 00:22:17,919
that i just infected so i'm gonna

663
00:22:17,919 --> 00:22:20,799
uninstall my my way out of this machine

664
00:22:20,799 --> 00:22:22,400
and so that was the only thing that was

665
00:22:22,400 --> 00:22:23,679
and actually that in itself is an

666
00:22:23,679 --> 00:22:24,720
interesting question

667
00:22:24,720 --> 00:22:28,159
right but in our opinion this

668
00:22:28,159 --> 00:22:30,080
file has been misattributed to silver

669
00:22:30,080 --> 00:22:32,320
spyro it has nothing to do with it

670
00:22:32,320 --> 00:22:33,840
there are other questions that come up

671
00:22:33,840 --> 00:22:36,000
from you know the use of this file what

672
00:22:36,000 --> 00:22:36,880
was intent

673
00:22:36,880 --> 00:22:38,880
is there a connection with this cluster

674
00:22:38,880 --> 00:22:41,200
and the developers of silver spiral

675
00:22:41,200 --> 00:22:43,840
possibly right i mean you know um maybe

676
00:22:43,840 --> 00:22:45,679
this is a way to keep track of

677
00:22:45,679 --> 00:22:47,520
infections and we believe that that was

678
00:22:47,520 --> 00:22:49,600
kind of like you know um

679
00:22:49,600 --> 00:22:51,120
tell me alert to the fact that you will

680
00:22:51,120 --> 00:22:52,720
hack and you drop um

681
00:22:52,720 --> 00:22:54,159
you know like hey i was here kind of

682
00:22:54,159 --> 00:22:55,840
thing so this insta file is kind of like

683
00:22:55,840 --> 00:22:57,039
hey i'm here already

684
00:22:57,039 --> 00:22:58,559
don't don't mess around with my

685
00:22:58,559 --> 00:23:00,559
operation

686
00:23:00,559 --> 00:23:02,400
but this instant cluster becomes

687
00:23:02,400 --> 00:23:04,159
actually interesting because according

688
00:23:04,159 --> 00:23:05,200
to the news

689
00:23:05,200 --> 00:23:08,480
there were more than you know 29

690
00:23:08,480 --> 00:23:11,919
30 000 40 000 infections and so

691
00:23:11,919 --> 00:23:14,000
this is the screenshot that came from

692
00:23:14,000 --> 00:23:16,480
the report that was made by malwarebytes

693
00:23:16,480 --> 00:23:19,039
but since we know that the insuffile is

694
00:23:19,039 --> 00:23:19,919
actually not

695
00:23:19,919 --> 00:23:22,400
connected to silver spiral then it's

696
00:23:22,400 --> 00:23:24,159
fair for us to infer that the actual

697
00:23:24,159 --> 00:23:25,440
number of infections

698
00:23:25,440 --> 00:23:28,240
was actually lower two to three thousand

699
00:23:28,240 --> 00:23:30,159
and i'm just going counting by the data

700
00:23:30,159 --> 00:23:30,960
that

701
00:23:30,960 --> 00:23:32,799
malwarebytes provided it could be even

702
00:23:32,799 --> 00:23:35,280
less now that in itself is also another

703
00:23:35,280 --> 00:23:36,000
very interesting

704
00:23:36,000 --> 00:23:38,400
question because this is a much smaller

705
00:23:38,400 --> 00:23:39,280
operation

706
00:23:39,280 --> 00:23:41,840
and i believe that it was great that the

707
00:23:41,840 --> 00:23:43,679
you know all of these vendors

708
00:23:43,679 --> 00:23:45,919
made this public just at the right time

709
00:23:45,919 --> 00:23:47,520
in my opinion

710
00:23:47,520 --> 00:23:50,159
so as far as us we're concerned we

711
00:23:50,159 --> 00:23:51,039
basically

712
00:23:51,039 --> 00:23:53,120
solved the mystery of what this insu

713
00:23:53,120 --> 00:23:55,679
file was used and it was basically

714
00:23:55,679 --> 00:23:58,880
related to other malware now here's

715
00:23:58,880 --> 00:24:00,400
another thing that i don't think it's

716
00:24:00,400 --> 00:24:01,679
down

717
00:24:01,679 --> 00:24:03,360
there is another cluster and we call it

718
00:24:03,360 --> 00:24:04,960
the king cluster and

719
00:24:04,960 --> 00:24:07,039
it's because of the particular name

720
00:24:07,039 --> 00:24:08,720
reference into that file

721
00:24:08,720 --> 00:24:10,480
i'm not going to go into this particular

722
00:24:10,480 --> 00:24:12,240
one on details because

723
00:24:12,240 --> 00:24:13,840
there might be another presentation that

724
00:24:13,840 --> 00:24:15,600
could be made about this cluster

725
00:24:15,600 --> 00:24:16,960
but the important thing about this

726
00:24:16,960 --> 00:24:18,799
cluster is that we first

727
00:24:18,799 --> 00:24:20,960
saw it in our telemetry on august 20th

728
00:24:20,960 --> 00:24:22,400
or 2020

729
00:24:22,400 --> 00:24:26,000
and it was the first malware that i know

730
00:24:26,000 --> 00:24:27,039
of

731
00:24:27,039 --> 00:24:28,640
that actually leveraged for the first

732
00:24:28,640 --> 00:24:30,480
time the pillis body persistent

733
00:24:30,480 --> 00:24:31,279
technique

734
00:24:31,279 --> 00:24:33,919
that we had uncovered so this is great

735
00:24:33,919 --> 00:24:35,200
you know okay first time

736
00:24:35,200 --> 00:24:37,279
what is this who's using it what is this

737
00:24:37,279 --> 00:24:39,279
malware right and so

738
00:24:39,279 --> 00:24:41,360
this is the first know sample that i

739
00:24:41,360 --> 00:24:44,559
know of that leverage that technique

740
00:24:44,559 --> 00:24:48,000
now again this cluster there might be

741
00:24:48,000 --> 00:24:49,600
maybe folks that are looking into that

742
00:24:49,600 --> 00:24:51,679
so i will not go into details but it is

743
00:24:51,679 --> 00:24:52,799
relevant because

744
00:24:52,799 --> 00:24:55,360
it has this overlapping technique and so

745
00:24:55,360 --> 00:24:56,799
we saw that this technique was later

746
00:24:56,799 --> 00:24:59,039
used by silver spiral as it began its

747
00:24:59,039 --> 00:25:00,400
activities

748
00:25:00,400 --> 00:25:02,159
what is actually very interesting is

749
00:25:02,159 --> 00:25:04,240
that king cluster that

750
00:25:04,240 --> 00:25:07,279
started in the 20s basically is slowed

751
00:25:07,279 --> 00:25:07,679
down

752
00:25:07,679 --> 00:25:10,400
and then by the 28th when we first saw

753
00:25:10,400 --> 00:25:11,039
the first

754
00:25:11,039 --> 00:25:13,520
sample of pilla's body king cluster had

755
00:25:13,520 --> 00:25:14,640
gone away

756
00:25:14,640 --> 00:25:16,080
so the question is are these two

757
00:25:16,080 --> 00:25:17,919
connected well

758
00:25:17,919 --> 00:25:19,679
the reality is that king cluster

759
00:25:19,679 --> 00:25:21,520
actually do have did have a payload

760
00:25:21,520 --> 00:25:23,200
there was malware and it did a few

761
00:25:23,200 --> 00:25:23,760
things

762
00:25:23,760 --> 00:25:26,400
pilla's body did not and so that is

763
00:25:26,400 --> 00:25:27,200
interesting

764
00:25:27,200 --> 00:25:30,080
but it leveraged basically similar

765
00:25:30,080 --> 00:25:30,799
techniques and

766
00:25:30,799 --> 00:25:32,799
one of the most important ones is that

767
00:25:32,799 --> 00:25:34,880
pillar's body

768
00:25:34,880 --> 00:25:37,279
so basically that's what i want to say

769
00:25:37,279 --> 00:25:39,520
so why is all of this important well

770
00:25:39,520 --> 00:25:40,480
well

771
00:25:40,480 --> 00:25:41,760
all of these pre-explanation is

772
00:25:41,760 --> 00:25:43,520
important because now we know that the

773
00:25:43,520 --> 00:25:45,360
insuli file is related to other malware

774
00:25:45,360 --> 00:25:46,960
we now know that probably the number of

775
00:25:46,960 --> 00:25:48,960
infections reported it's actually lower

776
00:25:48,960 --> 00:25:50,480
we know there was another malware that

777
00:25:50,480 --> 00:25:52,320
leveraged build his body and we know

778
00:25:52,320 --> 00:25:54,480
that all of this sort of ended

779
00:25:54,480 --> 00:25:56,960
um or transition into what became silver

780
00:25:56,960 --> 00:25:58,799
spiral

781
00:25:58,799 --> 00:26:01,120
so now let's talk about silver spiral

782
00:26:01,120 --> 00:26:02,720
what is that what is that malware

783
00:26:02,720 --> 00:26:06,159
and why it's interesting so again

784
00:26:06,159 --> 00:26:08,880
key ttp for us was the fact that it was

785
00:26:08,880 --> 00:26:09,440
used

786
00:26:09,440 --> 00:26:13,120
tillage body for persistence now the

787
00:26:13,120 --> 00:26:15,440
scene behind um red canary did a great

788
00:26:15,440 --> 00:26:16,320
job on

789
00:26:16,320 --> 00:26:18,080
documenting everything that has to do

790
00:26:18,080 --> 00:26:19,600
with silver sparrow so if you haven't

791
00:26:19,600 --> 00:26:20,159
read i'd

792
00:26:20,159 --> 00:26:23,039
recommend you do uh kudos to tony and

793
00:26:23,039 --> 00:26:23,440
team

794
00:26:23,440 --> 00:26:26,000
i think they made it super easy to read

795
00:26:26,000 --> 00:26:26,960
and digest

796
00:26:26,960 --> 00:26:28,799
all of the information so i won't go

797
00:26:28,799 --> 00:26:30,080
into many of the information they

798
00:26:30,080 --> 00:26:31,200
already covered because they already

799
00:26:31,200 --> 00:26:34,240
cover and they've done a great job

800
00:26:34,240 --> 00:26:36,080
however we're going to cover these a

801
00:26:36,080 --> 00:26:38,720
little bit from the point of view of

802
00:26:38,720 --> 00:26:41,919
our network right um here

803
00:26:41,919 --> 00:26:44,720
um in the team of the paranoias we

804
00:26:44,720 --> 00:26:46,159
actually open source the tool and the

805
00:26:46,159 --> 00:26:47,840
name of the tool is called archime

806
00:26:47,840 --> 00:26:50,400
it was known before as molok this is a

807
00:26:50,400 --> 00:26:51,279
nice

808
00:26:51,279 --> 00:26:52,880
network visibility tool that allows you

809
00:26:52,880 --> 00:26:54,240
to connect because and observe the

810
00:26:54,240 --> 00:26:55,440
network traffic

811
00:26:55,440 --> 00:26:57,760
so we're going to leverage these tools

812
00:26:57,760 --> 00:26:59,200
for this part of the conversation to

813
00:26:59,200 --> 00:26:59,919
talk about

814
00:26:59,919 --> 00:27:03,520
you know some things silver sparrow

815
00:27:03,520 --> 00:27:07,039
so when it comes to syllabary spyro um

816
00:27:07,039 --> 00:27:10,080
it has a a flow on how the infections

817
00:27:10,080 --> 00:27:11,120
took place

818
00:27:11,120 --> 00:27:12,640
what you can see in this screen is

819
00:27:12,640 --> 00:27:15,120
basically us looking into

820
00:27:15,120 --> 00:27:18,080
um that activity right um and kind of

821
00:27:18,080 --> 00:27:19,360
following

822
00:27:19,360 --> 00:27:21,600
um the activity and keeping an eye on

823
00:27:21,600 --> 00:27:24,000
what's going on

824
00:27:24,000 --> 00:27:26,720
so this is a little too dense to read

825
00:27:26,720 --> 00:27:28,000
we're going to have a blog post where

826
00:27:28,000 --> 00:27:28,720
you can

827
00:27:28,720 --> 00:27:30,960
get a lot more information about this

828
00:27:30,960 --> 00:27:32,480
but in general

829
00:27:32,480 --> 00:27:34,399
if you were looking at a moloch what you

830
00:27:34,399 --> 00:27:36,799
see on the screen will be more or less

831
00:27:36,799 --> 00:27:40,080
um the infection chain

832
00:27:40,080 --> 00:27:42,480
right the way that it work uh and i'll

833
00:27:42,480 --> 00:27:43,840
dive a little bit into it

834
00:27:43,840 --> 00:27:46,000
now what you really cannot see is that

835
00:27:46,000 --> 00:27:49,120
there is a lot of um

836
00:27:49,120 --> 00:27:52,720
um parameters within these queries that

837
00:27:52,720 --> 00:27:54,799
turn out to be a lot of very interesting

838
00:27:54,799 --> 00:27:56,720
things we're just not going to have time

839
00:27:56,720 --> 00:27:57,760
to kind of

840
00:27:57,760 --> 00:28:00,720
cover all the uri parameters um and so

841
00:28:00,720 --> 00:28:02,159
we're going to only dig into a few of

842
00:28:02,159 --> 00:28:04,960
them and you can read all about them

843
00:28:04,960 --> 00:28:08,159
why are we covering all of this well

844
00:28:08,159 --> 00:28:09,600
one of the things that happened and i

845
00:28:09,600 --> 00:28:11,840
don't care often is when you do

846
00:28:11,840 --> 00:28:14,720
threat hunting most of the folks that

847
00:28:14,720 --> 00:28:16,399
currently do three hunting they

848
00:28:16,399 --> 00:28:18,880
heavily concentrate on the host side of

849
00:28:18,880 --> 00:28:19,919
things

850
00:28:19,919 --> 00:28:22,960
and this is our way to say you have to

851
00:28:22,960 --> 00:28:24,640
compensate and you have to actually look

852
00:28:24,640 --> 00:28:26,159
at the network side of things

853
00:28:26,159 --> 00:28:28,480
and you can do a lot of awesome and very

854
00:28:28,480 --> 00:28:29,760
interesting trey hunt

855
00:28:29,760 --> 00:28:31,760
on the network side and sometimes that

856
00:28:31,760 --> 00:28:33,600
will give you clues to actually uncover

857
00:28:33,600 --> 00:28:34,799
even more things

858
00:28:34,799 --> 00:28:37,200
so we're trying to walk you through an

859
00:28:37,200 --> 00:28:39,679
approach into how you do that

860
00:28:39,679 --> 00:28:42,640
so the way solo spirals works is

861
00:28:42,640 --> 00:28:44,559
normally there was some sort of search

862
00:28:44,559 --> 00:28:48,480
related um um endpoint on a cdn

863
00:28:48,480 --> 00:28:52,080
in this example it was one on on akamai

864
00:28:52,080 --> 00:28:54,799
uh and so basically what you seem to

865
00:28:54,799 --> 00:28:55,520
have is

866
00:28:55,520 --> 00:28:57,440
you're a user you open a browser you

867
00:28:57,440 --> 00:28:58,960
search for something

868
00:28:58,960 --> 00:29:02,080
and that's when the sort of chain kind

869
00:29:02,080 --> 00:29:03,200
of begins

870
00:29:03,200 --> 00:29:05,760
um silver spiral will collect a cube

871
00:29:05,760 --> 00:29:07,360
parameter that you see in here

872
00:29:07,360 --> 00:29:09,279
and so that is the search term you use

873
00:29:09,279 --> 00:29:11,120
like i want to buy shoes right

874
00:29:11,120 --> 00:29:13,919
um and and then there is another value

875
00:29:13,919 --> 00:29:14,320
the

876
00:29:14,320 --> 00:29:17,440
the pq value or pg pj value

877
00:29:17,440 --> 00:29:19,440
and this is a unique id that kind of

878
00:29:19,440 --> 00:29:21,679
tracks you down so you do the search

879
00:29:21,679 --> 00:29:23,360
and this is a unique identifier to your

880
00:29:23,360 --> 00:29:25,440
machine and

881
00:29:25,440 --> 00:29:27,760
that is the beginning of everything so

882
00:29:27,760 --> 00:29:29,360
at that point

883
00:29:29,360 --> 00:29:32,559
you are searching for something you are

884
00:29:32,559 --> 00:29:33,200
going to be

885
00:29:33,200 --> 00:29:36,559
then redirected to a website the website

886
00:29:36,559 --> 00:29:37,279
we saw

887
00:29:37,279 --> 00:29:39,600
on our telemetry the most and the one

888
00:29:39,600 --> 00:29:40,320
that was doing

889
00:29:40,320 --> 00:29:42,600
the most activity is this one

890
00:29:42,600 --> 00:29:43,760
standardconnection.com

891
00:29:43,760 --> 00:29:45,760
i believe it's still live so hopefully

892
00:29:45,760 --> 00:29:46,799
that's gonna be

893
00:29:46,799 --> 00:29:50,159
you know gone then fairly soon um

894
00:29:50,159 --> 00:29:52,240
and what you will see here is the view

895
00:29:52,240 --> 00:29:53,440
from our

896
00:29:53,440 --> 00:29:55,760
rcmu tool you basically are being

897
00:29:55,760 --> 00:29:58,080
redirected into this site

898
00:29:58,080 --> 00:30:01,200
and you can see in here the 302 you've

899
00:30:01,200 --> 00:30:01,520
been

900
00:30:01,520 --> 00:30:04,000
it's moved but there's actually some

901
00:30:04,000 --> 00:30:05,600
parameters that are kind of hidden in

902
00:30:05,600 --> 00:30:06,720
there

903
00:30:06,720 --> 00:30:08,320
we filter a few things because there are

904
00:30:08,320 --> 00:30:10,000
there might be some sensitive data so

905
00:30:10,000 --> 00:30:11,279
you're not going to see everything in

906
00:30:11,279 --> 00:30:13,200
here but

907
00:30:13,200 --> 00:30:14,960
then once you've redirected it then

908
00:30:14,960 --> 00:30:16,880
you're redirected yet again

909
00:30:16,880 --> 00:30:18,720
it's almost like i want to make sure

910
00:30:18,720 --> 00:30:20,399
that you're a mac and you meet the

911
00:30:20,399 --> 00:30:21,840
criteria and if so

912
00:30:21,840 --> 00:30:24,000
then you're going to be a possible

913
00:30:24,000 --> 00:30:25,120
target for me

914
00:30:25,120 --> 00:30:28,320
to infect and so we get a secondary

915
00:30:28,320 --> 00:30:29,120
redirection

916
00:30:29,120 --> 00:30:32,399
itself to standard connection um and

917
00:30:32,399 --> 00:30:34,240
across that redirection there are some

918
00:30:34,240 --> 00:30:36,320
values that you might be able to see on

919
00:30:36,320 --> 00:30:36,720
this

920
00:30:36,720 --> 00:30:39,600
screenshot and again i'm detailing those

921
00:30:39,600 --> 00:30:41,120
on on our blog post

922
00:30:41,120 --> 00:30:42,480
but there's a lot of values that are

923
00:30:42,480 --> 00:30:45,039
gonna carry over since the inception of

924
00:30:45,039 --> 00:30:49,200
the search at that point you will be

925
00:30:49,200 --> 00:30:50,159
resurrected

926
00:30:50,159 --> 00:30:53,840
to an s3 bucket and aws

927
00:30:53,840 --> 00:30:57,039
and at this point um

928
00:30:57,039 --> 00:30:59,600
you're now it is very likely you're

929
00:30:59,600 --> 00:31:00,159
gonna be

930
00:31:00,159 --> 00:31:02,480
infected you know this is you're good

931
00:31:02,480 --> 00:31:04,240
you know you meet the criteria

932
00:31:04,240 --> 00:31:06,720
to go and become an infected and so what

933
00:31:06,720 --> 00:31:09,360
we can see in here again is a 302

934
00:31:09,360 --> 00:31:11,600
but there is this information that is

935
00:31:11,600 --> 00:31:13,360
keeps being passed on

936
00:31:13,360 --> 00:31:16,559
to be sent you to download the malware

937
00:31:16,559 --> 00:31:18,480
now there is another side that i don't

938
00:31:18,480 --> 00:31:20,640
think has been made public and is this

939
00:31:20,640 --> 00:31:20,960
one

940
00:31:20,960 --> 00:31:23,679
valid function we saw it across you know

941
00:31:23,679 --> 00:31:25,840
basically everything we looked into

942
00:31:25,840 --> 00:31:28,080
and in our opinion this value function

943
00:31:28,080 --> 00:31:29,120
side uh

944
00:31:29,120 --> 00:31:32,559
was basically tracking

945
00:31:32,559 --> 00:31:34,799
telemetry and it was actually connected

946
00:31:34,799 --> 00:31:37,600
to the download of the malware

947
00:31:37,600 --> 00:31:40,320
one of the key things is that there is

948
00:31:40,320 --> 00:31:41,279
uri

949
00:31:41,279 --> 00:31:43,519
within the parameters of the uri there

950
00:31:43,519 --> 00:31:45,279
is this value called dlclick

951
00:31:45,279 --> 00:31:47,679
which basically is down on click and it

952
00:31:47,679 --> 00:31:49,840
will keep track of who's downloading the

953
00:31:49,840 --> 00:31:51,200
click

954
00:31:51,200 --> 00:31:53,120
why is all of this important well this

955
00:31:53,120 --> 00:31:54,880
is important because it really tells us

956
00:31:54,880 --> 00:31:56,640
that there is an ecosystem

957
00:31:56,640 --> 00:31:59,519
of malware mac os and someone is making

958
00:31:59,519 --> 00:32:00,320
money

959
00:32:00,320 --> 00:32:02,880
of these installations and you need to

960
00:32:02,880 --> 00:32:04,880
have a way to track back

961
00:32:04,880 --> 00:32:08,080
how someone arrived to you right so like

962
00:32:08,080 --> 00:32:10,399
it came from this website and then how

963
00:32:10,399 --> 00:32:12,960
many downloads are being taken place

964
00:32:12,960 --> 00:32:14,720
and then later on how many infections

965
00:32:14,720 --> 00:32:16,399
are being taken place that's how you

966
00:32:16,399 --> 00:32:17,519
monetize your

967
00:32:17,519 --> 00:32:20,320
infrastructure and your your you know

968
00:32:20,320 --> 00:32:21,760
your malware

969
00:32:21,760 --> 00:32:23,440
so this is kind of interesting to see it

970
00:32:23,440 --> 00:32:25,120
unfolding here

971
00:32:25,120 --> 00:32:28,320
now this could be a little dense but on

972
00:32:28,320 --> 00:32:30,000
the valid function there are a few

973
00:32:30,000 --> 00:32:31,679
parameters and hopefully you can see it

974
00:32:31,679 --> 00:32:34,480
here in red and those are actually

975
00:32:34,480 --> 00:32:36,080
interesting parameters because again

976
00:32:36,080 --> 00:32:38,880
they're tracking your uuid basically who

977
00:32:38,880 --> 00:32:39,840
who you are

978
00:32:39,840 --> 00:32:42,320
and that allows them to you know again

979
00:32:42,320 --> 00:32:43,279
you know

980
00:32:43,279 --> 00:32:45,440
be able to be aware of who is that

981
00:32:45,440 --> 00:32:46,480
they're infecting

982
00:32:46,480 --> 00:32:49,519
now there are other parameters um that

983
00:32:49,519 --> 00:32:51,840
are applied in here

984
00:32:51,840 --> 00:32:55,120
and uh there is this value stu

985
00:32:55,120 --> 00:32:56,960
or u parameters right and so they're

986
00:32:56,960 --> 00:32:58,240
kind of carry over on

987
00:32:58,240 --> 00:33:01,760
every uh red direction so all of these

988
00:33:01,760 --> 00:33:03,360
again it leads us to believe that there

989
00:33:03,360 --> 00:33:05,120
is some sort of monetization taking

990
00:33:05,120 --> 00:33:06,559
place

991
00:33:06,559 --> 00:33:10,240
um so once you go through this chain

992
00:33:10,240 --> 00:33:11,760
right and you go through all these

993
00:33:11,760 --> 00:33:13,360
different red directions and you've been

994
00:33:13,360 --> 00:33:14,559
sent to some place

995
00:33:14,559 --> 00:33:16,640
you eventually land on to the final

996
00:33:16,640 --> 00:33:18,159
destination which is

997
00:33:18,159 --> 00:33:21,519
this um domain they update and that

998
00:33:21,519 --> 00:33:23,120
change i believe that it didn't change

999
00:33:23,120 --> 00:33:24,399
honestly you don't remember but

1000
00:33:24,399 --> 00:33:25,840
basically that's where you will

1001
00:33:25,840 --> 00:33:28,320
eventually download the malware that

1002
00:33:28,320 --> 00:33:29,120
will then

1003
00:33:29,120 --> 00:33:32,000
uh use a specific technique that again

1004
00:33:32,000 --> 00:33:33,120
you can read all about

1005
00:33:33,120 --> 00:33:36,799
on the um red canada blog on how it

1006
00:33:36,799 --> 00:33:38,640
infected through

1007
00:33:38,640 --> 00:33:41,519
leveraging on the installer a bit of the

1008
00:33:41,519 --> 00:33:43,600
javascript

1009
00:33:43,600 --> 00:33:45,600
so this is what it looks like when

1010
00:33:45,600 --> 00:33:47,600
you're looking at the network side you

1011
00:33:47,600 --> 00:33:50,480
can actually zoom in into this

1012
00:33:50,480 --> 00:33:51,919
particular

1013
00:33:51,919 --> 00:33:53,760
screen now one of the things i didn't do

1014
00:33:53,760 --> 00:33:55,200
is that there are a few set of values on

1015
00:33:55,200 --> 00:33:55,760
the get

1016
00:33:55,760 --> 00:33:58,399
portion so if you were to zoom in into

1017
00:33:58,399 --> 00:34:00,000
this get portion here

1018
00:34:00,000 --> 00:34:02,159
you will be able to see some values all

1019
00:34:02,159 --> 00:34:03,120
of these uri

1020
00:34:03,120 --> 00:34:05,120
parameters become huntable you can

1021
00:34:05,120 --> 00:34:06,159
actually now

1022
00:34:06,159 --> 00:34:08,719
go and use them to start looking for

1023
00:34:08,719 --> 00:34:09,359
things

1024
00:34:09,359 --> 00:34:11,440
that might be related to the cluster or

1025
00:34:11,440 --> 00:34:12,560
not and that's why

1026
00:34:12,560 --> 00:34:14,239
these network telemetry becomes very

1027
00:34:14,239 --> 00:34:15,839
important so

1028
00:34:15,839 --> 00:34:17,839
you can see for example here these get

1029
00:34:17,839 --> 00:34:19,359
stats with that

1030
00:34:19,359 --> 00:34:22,560
trlp event too well we could tell you

1031
00:34:22,560 --> 00:34:23,679
that that event is

1032
00:34:23,679 --> 00:34:25,599
is actually very unique and you can

1033
00:34:25,599 --> 00:34:27,440
actually use that event to go and hunt

1034
00:34:27,440 --> 00:34:28,239
for things

1035
00:34:28,239 --> 00:34:30,239
and you will find a lot of other

1036
00:34:30,239 --> 00:34:31,359
interesting things when you start

1037
00:34:31,359 --> 00:34:33,040
looking into that you might uncover even

1038
00:34:33,040 --> 00:34:34,079
more domains

1039
00:34:34,079 --> 00:34:36,239
that are related to these or different

1040
00:34:36,239 --> 00:34:37,440
malware types

1041
00:34:37,440 --> 00:34:39,280
again it all points to an interesting

1042
00:34:39,280 --> 00:34:41,199
ecosystem that is

1043
00:34:41,199 --> 00:34:44,560
you know maybe pay-per-click um

1044
00:34:44,560 --> 00:34:48,239
paper infection um so

1045
00:34:48,239 --> 00:34:50,399
when you download the malware this is

1046
00:34:50,399 --> 00:34:52,000
some sort of the connections that you

1047
00:34:52,000 --> 00:34:52,480
will see

1048
00:34:52,480 --> 00:34:55,280
you can see here the 200 okay basically

1049
00:34:55,280 --> 00:34:55,760
you know

1050
00:34:55,760 --> 00:34:58,800
you are now being infected um

1051
00:34:58,800 --> 00:35:00,960
as you are then later in the fact that

1052
00:35:00,960 --> 00:35:02,880
the malware and this is the part that

1053
00:35:02,880 --> 00:35:04,160
made it very interesting

1054
00:35:04,160 --> 00:35:05,680
is going to start doing some curl

1055
00:35:05,680 --> 00:35:07,440
beacons now

1056
00:35:07,440 --> 00:35:10,079
for us we have this thing called the

1057
00:35:10,079 --> 00:35:11,680
pickle call and the pickle call

1058
00:35:11,680 --> 00:35:13,520
basically is related to the curls

1059
00:35:13,520 --> 00:35:15,520
so from the whole side what you will see

1060
00:35:15,520 --> 00:35:17,119
is just a curl to any of those two

1061
00:35:17,119 --> 00:35:18,000
domains ap

1062
00:35:18,000 --> 00:35:20,960
mobile trades and api special attributes

1063
00:35:20,960 --> 00:35:22,560
api mobile trades and api

1064
00:35:22,560 --> 00:35:25,280
special attributes.com but there is this

1065
00:35:25,280 --> 00:35:26,160
called the

1066
00:35:26,160 --> 00:35:28,240
pickle call now what do we call the pico

1067
00:35:28,240 --> 00:35:30,640
call because the your uri parameter has

1068
00:35:30,640 --> 00:35:30,880
a

1069
00:35:30,880 --> 00:35:34,320
pki on it um or else don't remember if

1070
00:35:34,320 --> 00:35:35,680
it's an ir nl

1071
00:35:35,680 --> 00:35:37,920
and you can clearly see and here's the

1072
00:35:37,920 --> 00:35:40,240
screenshot that is basically talking to

1073
00:35:40,240 --> 00:35:43,280
the api and it's doing a post now

1074
00:35:43,280 --> 00:35:45,839
in addition to that um you can see the

1075
00:35:45,839 --> 00:35:46,640
curl engine

1076
00:35:46,640 --> 00:35:49,200
so these as itself this screenshot that

1077
00:35:49,200 --> 00:35:50,880
could be something you can actually hunt

1078
00:35:50,880 --> 00:35:53,760
you can look for these things and it

1079
00:35:53,760 --> 00:35:56,640
will help you to uncover other things

1080
00:35:56,640 --> 00:36:00,240
um there is this value about the mn

1081
00:36:00,240 --> 00:36:02,320
uh pk install which is basically a

1082
00:36:02,320 --> 00:36:04,880
packet uh package install parameter

1083
00:36:04,880 --> 00:36:07,040
and you know we believe that the m

1084
00:36:07,040 --> 00:36:08,560
belongs to the machine id

1085
00:36:08,560 --> 00:36:11,280
now the machine id is something i didn't

1086
00:36:11,280 --> 00:36:13,119
cover and it will be on the

1087
00:36:13,119 --> 00:36:15,680
on the red canary blog it is basically

1088
00:36:15,680 --> 00:36:17,359
collected through a particular

1089
00:36:17,359 --> 00:36:20,880
process uh a command that you will run

1090
00:36:20,880 --> 00:36:22,800
that collects information about your

1091
00:36:22,800 --> 00:36:24,320
operating system and

1092
00:36:24,320 --> 00:36:26,320
serial number and other information and

1093
00:36:26,320 --> 00:36:28,480
all of that basically gets blurbed

1094
00:36:28,480 --> 00:36:31,440
and basically it gets parts on right i

1095
00:36:31,440 --> 00:36:33,520
want to keep track of who am i affecting

1096
00:36:33,520 --> 00:36:35,359
and all the system information so all of

1097
00:36:35,359 --> 00:36:38,000
that has been sent on that um

1098
00:36:38,000 --> 00:36:41,280
you know curl out um

1099
00:36:41,280 --> 00:36:43,680
here you can see that as part of that

1100
00:36:43,680 --> 00:36:44,400
api

1101
00:36:44,400 --> 00:36:46,800
you you basically see a check on that

1102
00:36:46,800 --> 00:36:47,599
package

1103
00:36:47,599 --> 00:36:49,280
and the most important thing is that

1104
00:36:49,280 --> 00:36:51,440
this whole api

1105
00:36:51,440 --> 00:36:54,720
um was basically looking for

1106
00:36:54,720 --> 00:36:57,040
is there what is my next you know phase

1107
00:36:57,040 --> 00:36:58,480
right so you install them

1108
00:36:58,480 --> 00:37:01,040
you infect the machine and this will

1109
00:37:01,040 --> 00:37:02,000
happen

1110
00:37:02,000 --> 00:37:04,960
almost on an hour so it was fun at home

1111
00:37:04,960 --> 00:37:06,560
right you can see these curls that are

1112
00:37:06,560 --> 00:37:07,760
taking place

1113
00:37:07,760 --> 00:37:10,800
and this is actually interesting because

1114
00:37:10,800 --> 00:37:11,200
oh

1115
00:37:11,200 --> 00:37:13,200
actually let's stop back in here you see

1116
00:37:13,200 --> 00:37:14,960
the scrolls happening

1117
00:37:14,960 --> 00:37:17,040
right but the what made this model very

1118
00:37:17,040 --> 00:37:19,359
interesting is

1119
00:37:19,359 --> 00:37:21,440
you're pulling a json file that will

1120
00:37:21,440 --> 00:37:22,560
give you information

1121
00:37:22,560 --> 00:37:24,720
instructions what am i going to do next

1122
00:37:24,720 --> 00:37:26,880
right so imagine that you just are

1123
00:37:26,880 --> 00:37:29,359
ready or an adversary you compromise the

1124
00:37:29,359 --> 00:37:30,079
machine

1125
00:37:30,079 --> 00:37:32,480
you have now your beacon in there but

1126
00:37:32,480 --> 00:37:34,320
you are not delivering any payload

1127
00:37:34,320 --> 00:37:36,640
you're waiting for like the next stage

1128
00:37:36,640 --> 00:37:39,200
well in this case the secondary stage

1129
00:37:39,200 --> 00:37:40,240
never happened

1130
00:37:40,240 --> 00:37:42,880
but it you know it was there and ready

1131
00:37:42,880 --> 00:37:44,560
and that's what made this malware

1132
00:37:44,560 --> 00:37:46,400
actually interesting and scary at the

1133
00:37:46,400 --> 00:37:47,680
same time because it could have

1134
00:37:47,680 --> 00:37:50,880
gotten really really worse so that's

1135
00:37:50,880 --> 00:37:52,720
about silver spiral but since we're

1136
00:37:52,720 --> 00:37:54,400
talking about thread hunting

1137
00:37:54,400 --> 00:37:56,240
i want to take the time to kind of walk

1138
00:37:56,240 --> 00:37:57,839
you through other ideas that

1139
00:37:57,839 --> 00:38:00,000
hopefully you know even if you didn't

1140
00:38:00,000 --> 00:38:01,599
know about pillows body

1141
00:38:01,599 --> 00:38:04,640
that you could have used or you can now

1142
00:38:04,640 --> 00:38:07,680
use to uncover other malware like super

1143
00:38:07,680 --> 00:38:08,560
spiral or

1144
00:38:08,560 --> 00:38:11,680
your red team or adversaries so

1145
00:38:11,680 --> 00:38:14,560
taking the data from the blog post from

1146
00:38:14,560 --> 00:38:15,920
red canary

1147
00:38:15,920 --> 00:38:17,280
because it did a good job and it just

1148
00:38:17,280 --> 00:38:19,040
makes it easy for me to explain it

1149
00:38:19,040 --> 00:38:21,200
there are a few things that silver

1150
00:38:21,200 --> 00:38:22,400
spiral will do

1151
00:38:22,400 --> 00:38:24,240
and all of those become huntable and

1152
00:38:24,240 --> 00:38:25,680
things you can actually use to

1153
00:38:25,680 --> 00:38:28,240
to look for things so the first one is

1154
00:38:28,240 --> 00:38:29,839
you know the crawls that we saw right so

1155
00:38:29,839 --> 00:38:31,280
there is this curl

1156
00:38:31,280 --> 00:38:33,680
um after the machine gets infected that

1157
00:38:33,680 --> 00:38:35,040
will take place

1158
00:38:35,040 --> 00:38:37,280
and so one of the things you can do is

1159
00:38:37,280 --> 00:38:38,720
you can hunt for

1160
00:38:38,720 --> 00:38:42,160
coral activity happening on your temp

1161
00:38:42,160 --> 00:38:42,960
directory

1162
00:38:42,960 --> 00:38:44,240
now i'll tell you this based on my

1163
00:38:44,240 --> 00:38:46,079
dilemma to me in my experience

1164
00:38:46,079 --> 00:38:50,240
you know crawls that involve

1165
00:38:50,240 --> 00:38:53,040
json files and attempted rock3 will

1166
00:38:53,040 --> 00:38:55,119
probably be rare but this varies by

1167
00:38:55,119 --> 00:38:56,160
organization

1168
00:38:56,160 --> 00:38:58,240
in my experience they're rare and so

1169
00:38:58,240 --> 00:39:00,720
it's worth to look at them

1170
00:39:00,720 --> 00:39:02,880
um then you have this notion of curl

1171
00:39:02,880 --> 00:39:04,240
beacons right so

1172
00:39:04,240 --> 00:39:06,160
now you not only have the fact that

1173
00:39:06,160 --> 00:39:07,839
there might be a one-time curl

1174
00:39:07,839 --> 00:39:09,520
but the fact that it's beaconing it just

1175
00:39:09,520 --> 00:39:11,040
keeps happening all the time

1176
00:39:11,040 --> 00:39:13,280
so that becomes even more telling what

1177
00:39:13,280 --> 00:39:14,240
in the heck is

1178
00:39:14,240 --> 00:39:16,640
you know keeps it running curl every x

1179
00:39:16,640 --> 00:39:18,560
amount of time and it's pointed to this

1180
00:39:18,560 --> 00:39:20,320
you know unknown json file on the temp

1181
00:39:20,320 --> 00:39:23,200
directory so that becomes countable and

1182
00:39:23,200 --> 00:39:24,960
this is a good way to see it you can see

1183
00:39:24,960 --> 00:39:26,640
here that almost on the hour

1184
00:39:26,640 --> 00:39:29,119
this thing was actually you know phoning

1185
00:39:29,119 --> 00:39:29,760
home

1186
00:39:29,760 --> 00:39:31,680
um and that will be one interesting

1187
00:39:31,680 --> 00:39:33,119
thing that you can actually go

1188
00:39:33,119 --> 00:39:36,800
and hunt um

1189
00:39:36,800 --> 00:39:39,280
now this is another one that is

1190
00:39:39,280 --> 00:39:39,839
interesting

1191
00:39:39,839 --> 00:39:42,160
in macos there's a lot of built-in tools

1192
00:39:42,160 --> 00:39:42,960
and the pl

1193
00:39:42,960 --> 00:39:45,200
util is basically a tool that is

1194
00:39:45,200 --> 00:39:47,119
commonly used by legit operations within

1195
00:39:47,119 --> 00:39:48,160
the operating system and other

1196
00:39:48,160 --> 00:39:49,200
applications

1197
00:39:49,200 --> 00:39:52,240
inside the macos ecosystem but based on

1198
00:39:52,240 --> 00:39:54,640
my experience and you know the way that

1199
00:39:54,640 --> 00:39:56,160
solar spiral behaves

1200
00:39:56,160 --> 00:39:58,960
what sets this command apart is that

1201
00:39:58,960 --> 00:39:59,520
dash

1202
00:39:59,520 --> 00:40:03,200
r value that value it is rare

1203
00:40:03,200 --> 00:40:04,880
at least in my telemetry it's limited i

1204
00:40:04,880 --> 00:40:07,440
have access it is not very common

1205
00:40:07,440 --> 00:40:10,160
and this if you want to take it and go

1206
00:40:10,160 --> 00:40:10,560
and

1207
00:40:10,560 --> 00:40:12,560
just search for it on your telemetry

1208
00:40:12,560 --> 00:40:14,560
might help you cover other things

1209
00:40:14,560 --> 00:40:16,240
um now what the area is doing is

1210
00:40:16,240 --> 00:40:17,920
basically try to properly read

1211
00:40:17,920 --> 00:40:19,839
you know the json and suffer matter

1212
00:40:19,839 --> 00:40:22,160
properly for the p-list

1213
00:40:22,160 --> 00:40:24,800
but it it is very unique now when you do

1214
00:40:24,800 --> 00:40:26,319
hunts like this you want to count that

1215
00:40:26,319 --> 00:40:26,960
the

1216
00:40:26,960 --> 00:40:29,440
letter r or the that parameter could be

1217
00:40:29,440 --> 00:40:30,640
at any time you know

1218
00:40:30,640 --> 00:40:33,200
in different positions within the query

1219
00:40:33,200 --> 00:40:34,480
so make sure that you create a query

1220
00:40:34,480 --> 00:40:35,760
that accounts for all of that

1221
00:40:35,760 --> 00:40:39,359
but in my personal opinion any activity

1222
00:40:39,359 --> 00:40:40,560
connected to this

1223
00:40:40,560 --> 00:40:43,200
particular portion of the command will

1224
00:40:43,200 --> 00:40:44,319
be likely rare

1225
00:40:44,319 --> 00:40:46,160
and in my opinion it will be of high

1226
00:40:46,160 --> 00:40:48,000
confidence and it's a good

1227
00:40:48,000 --> 00:40:51,359
um command to look for detection

1228
00:40:51,359 --> 00:40:52,480
opportunities

1229
00:40:52,480 --> 00:40:54,960
now another thing that happens often and

1230
00:40:54,960 --> 00:40:56,000
still spyro

1231
00:40:56,000 --> 00:40:59,040
is no different is you can look into

1232
00:40:59,040 --> 00:41:02,640
sqlite and macos has these quarantine

1233
00:41:02,640 --> 00:41:04,240
events basically

1234
00:41:04,240 --> 00:41:06,400
when a file is gets downloaded you know

1235
00:41:06,400 --> 00:41:08,560
it's verified it is a developer and on

1236
00:41:08,560 --> 00:41:10,079
and a few other things that will not go

1237
00:41:10,079 --> 00:41:10,960
into

1238
00:41:10,960 --> 00:41:12,960
but so what some of the malware do is

1239
00:41:12,960 --> 00:41:14,640
they kind of try to leverage

1240
00:41:14,640 --> 00:41:17,760
uh they will use that to uh collect some

1241
00:41:17,760 --> 00:41:18,560
information

1242
00:41:18,560 --> 00:41:21,119
or to bypass some things as it was made

1243
00:41:21,119 --> 00:41:21,760
recently

1244
00:41:21,760 --> 00:41:25,040
or some months ago made public

1245
00:41:25,040 --> 00:41:26,400
the whole point is you want to kind of

1246
00:41:26,400 --> 00:41:27,760
look into the sql three and the

1247
00:41:27,760 --> 00:41:29,280
quarantine events

1248
00:41:29,280 --> 00:41:30,640
what i can tell you is that pointer

1249
00:41:30,640 --> 00:41:32,560
malware loves to play with this

1250
00:41:32,560 --> 00:41:35,440
and silver spyro did exactly the same so

1251
00:41:35,440 --> 00:41:36,960
legit operations

1252
00:41:36,960 --> 00:41:39,359
will be taking place but for the most

1253
00:41:39,359 --> 00:41:40,960
part anyone that is

1254
00:41:40,960 --> 00:41:42,880
using sql3 to look into quarantine

1255
00:41:42,880 --> 00:41:45,119
events and then try to do some queries

1256
00:41:45,119 --> 00:41:45,599
to

1257
00:41:45,599 --> 00:41:48,319
dump the files as you can see into some

1258
00:41:48,319 --> 00:41:49,440
temp folder

1259
00:41:49,440 --> 00:41:51,359
then that is extremely rare and that

1260
00:41:51,359 --> 00:41:53,119
will not be legit so you can definitely

1261
00:41:53,119 --> 00:41:55,119
look into that

1262
00:41:55,119 --> 00:41:56,720
another thing you can actually do and

1263
00:41:56,720 --> 00:41:58,000
this is probably one of the most

1264
00:41:58,000 --> 00:41:59,200
interesting one is

1265
00:41:59,200 --> 00:42:01,760
mac os in this case there's an installer

1266
00:42:01,760 --> 00:42:04,480
you can follow the installer process

1267
00:42:04,480 --> 00:42:06,560
and by looking into the installer

1268
00:42:06,560 --> 00:42:08,560
processes you might find some very

1269
00:42:08,560 --> 00:42:10,079
interesting

1270
00:42:10,079 --> 00:42:12,000
finds now before you go into this if

1271
00:42:12,000 --> 00:42:13,280
you're doing trade hunting

1272
00:42:13,280 --> 00:42:14,880
i recommend you do some statistical

1273
00:42:14,880 --> 00:42:16,480
analysis right understand

1274
00:42:16,480 --> 00:42:18,160
how does the installer activity looks in

1275
00:42:18,160 --> 00:42:20,560
your network and then you kind of start

1276
00:42:20,560 --> 00:42:22,880
removing some of the noise that is legit

1277
00:42:22,880 --> 00:42:24,560
and then you start zooming into things

1278
00:42:24,560 --> 00:42:25,280
that

1279
00:42:25,280 --> 00:42:28,319
start to look rare so

1280
00:42:28,319 --> 00:42:31,359
if you do this zoom into activity within

1281
00:42:31,359 --> 00:42:33,599
the temp directory that was a key to tp

1282
00:42:33,599 --> 00:42:33,920
for

1283
00:42:33,920 --> 00:42:35,920
silver spiral and for a lot of malware

1284
00:42:35,920 --> 00:42:38,000
but also keep yourself aware of

1285
00:42:38,000 --> 00:42:38,720
something

1286
00:42:38,720 --> 00:42:41,119
related to the big install sandbox and

1287
00:42:41,119 --> 00:42:42,800
again this is related to the fact that

1288
00:42:42,800 --> 00:42:44,880
there's a sandbox that make sure that

1289
00:42:44,880 --> 00:42:46,000
you know um

1290
00:42:46,000 --> 00:42:47,680
the software is legit and so forth so

1291
00:42:47,680 --> 00:42:49,839
there's going to be a lot of installer

1292
00:42:49,839 --> 00:42:52,400
activity connected to the pk install

1293
00:42:52,400 --> 00:42:53,200
sandbox

1294
00:42:53,200 --> 00:42:55,040
just remove it and filter that out and

1295
00:42:55,040 --> 00:42:56,640
then you're going to be left over with

1296
00:42:56,640 --> 00:43:00,480
very interesting stuff so

1297
00:43:00,480 --> 00:43:02,480
hopefully at this point some curious

1298
00:43:02,480 --> 00:43:05,200
eyes you some viewers have noticed that

1299
00:43:05,200 --> 00:43:06,319
a lot of the stuff that i've been

1300
00:43:06,319 --> 00:43:09,040
talking is sort of connected to this

1301
00:43:09,040 --> 00:43:12,400
temp folder and that is actually

1302
00:43:12,400 --> 00:43:14,160
quite interesting because as you start

1303
00:43:14,160 --> 00:43:15,760
looking into the activity of this and

1304
00:43:15,760 --> 00:43:17,200
other malware

1305
00:43:17,200 --> 00:43:20,240
you know it starts to get weird i mean i

1306
00:43:20,240 --> 00:43:21,680
don't know you but um

1307
00:43:21,680 --> 00:43:23,440
maybe some developers or other phones

1308
00:43:23,440 --> 00:43:25,440
will actually create an sh file within

1309
00:43:25,440 --> 00:43:26,560
the temp directory

1310
00:43:26,560 --> 00:43:29,040
but it's the connection of activity

1311
00:43:29,040 --> 00:43:30,640
there's a lot of other commands that are

1312
00:43:30,640 --> 00:43:32,400
taking place now in this screenshot you

1313
00:43:32,400 --> 00:43:34,240
can actually see the i o reg

1314
00:43:34,240 --> 00:43:37,280
command and that basically command

1315
00:43:37,280 --> 00:43:39,359
is the one that i alerted that early

1316
00:43:39,359 --> 00:43:41,200
that allows you to

1317
00:43:41,200 --> 00:43:42,880
collect some information that will be

1318
00:43:42,880 --> 00:43:44,560
identifiers for your machine that

1319
00:43:44,560 --> 00:43:46,400
eventually are sent out on that

1320
00:43:46,400 --> 00:43:48,960
api crawl call when the malware was

1321
00:43:48,960 --> 00:43:50,480
phoning home

1322
00:43:50,480 --> 00:43:52,720
so even looking into this might be of

1323
00:43:52,720 --> 00:43:54,079
interest now there's a lot of noise

1324
00:43:54,079 --> 00:43:55,359
there's a lot of good stuff that will

1325
00:43:55,359 --> 00:43:56,000
use it

1326
00:43:56,000 --> 00:43:58,480
but again connected to temp that starts

1327
00:43:58,480 --> 00:43:59,920
to get interesting

1328
00:43:59,920 --> 00:44:02,319
and that is the case when it comes to

1329
00:44:02,319 --> 00:44:03,280
silver's power

1330
00:44:03,280 --> 00:44:05,680
and a lot of malware so what i really

1331
00:44:05,680 --> 00:44:06,640
recommend

1332
00:44:06,640 --> 00:44:08,800
if you if you're new to this or if your

1333
00:44:08,800 --> 00:44:10,480
season if you haven't done it

1334
00:44:10,480 --> 00:44:13,119
is basically track activity with an

1335
00:44:13,119 --> 00:44:13,839
installer

1336
00:44:13,839 --> 00:44:16,880
and map it to the temp directory you're

1337
00:44:16,880 --> 00:44:18,880
going to find a goldmine of activity

1338
00:44:18,880 --> 00:44:20,800
and that in itself would have been the

1339
00:44:20,800 --> 00:44:22,640
clue for you to find silver spiral

1340
00:44:22,640 --> 00:44:24,480
if you didn't know about anything else

1341
00:44:24,480 --> 00:44:25,760
because it would have signaled that

1342
00:44:25,760 --> 00:44:27,440
there's some activity in there

1343
00:44:27,440 --> 00:44:29,760
that is very interesting especially as

1344
00:44:29,760 --> 00:44:31,839
as it started doing the beacon later on

1345
00:44:31,839 --> 00:44:35,520
just kept on using that temp folder so

1346
00:44:35,520 --> 00:44:37,920
you definitely want to zoom in into that

1347
00:44:37,920 --> 00:44:38,960
gem folder

1348
00:44:38,960 --> 00:44:41,280
and connect installer and what i'm going

1349
00:44:41,280 --> 00:44:42,800
to try to do later on is to

1350
00:44:42,800 --> 00:44:46,160
you know release some um

1351
00:44:46,160 --> 00:44:49,119
detections um the sigma rule so you can

1352
00:44:49,119 --> 00:44:49,680
have them

1353
00:44:49,680 --> 00:44:52,319
and you can play with them and so stay

1354
00:44:52,319 --> 00:44:53,359
tuned for that

1355
00:44:53,359 --> 00:44:55,280
um but meanwhile this will help you to

1356
00:44:55,280 --> 00:44:57,280
kind of identify this malware

1357
00:44:57,280 --> 00:44:59,359
so let's do a recap and you know and

1358
00:44:59,359 --> 00:45:01,280
some take aways on this

1359
00:45:01,280 --> 00:45:04,160
um so first i hope that i can show you

1360
00:45:04,160 --> 00:45:06,400
that trey hunting does pay off right

1361
00:45:06,400 --> 00:45:08,560
uh we knew about the ttps way ahead of

1362
00:45:08,560 --> 00:45:09,920
time and

1363
00:45:09,920 --> 00:45:12,960
if you try on similar things

1364
00:45:12,960 --> 00:45:15,920
you will have found or still could find

1365
00:45:15,920 --> 00:45:17,280
very interesting stuff

1366
00:45:17,280 --> 00:45:20,240
i do want to say something that when it

1367
00:45:20,240 --> 00:45:22,240
comes to this pillar's body

1368
00:45:22,240 --> 00:45:24,720
it really it's not groundbreaking i

1369
00:45:24,720 --> 00:45:25,680
didn't discover

1370
00:45:25,680 --> 00:45:29,040
something you know like that i think

1371
00:45:29,040 --> 00:45:31,359
is is really that groundbreaking it's

1372
00:45:31,359 --> 00:45:33,680
just i just followed the process

1373
00:45:33,680 --> 00:45:35,520
and the process led me into identifying

1374
00:45:35,520 --> 00:45:37,119
something that's become

1375
00:45:37,119 --> 00:45:39,520
interesting and at the time um i had not

1376
00:45:39,520 --> 00:45:41,920
seen any telemetry or any abuse about it

1377
00:45:41,920 --> 00:45:43,760
and so that is the interesting part in

1378
00:45:43,760 --> 00:45:45,520
here when you tried hunting not

1379
00:45:45,520 --> 00:45:47,280
everything has to be gun breaking

1380
00:45:47,280 --> 00:45:49,200
you might stumble across some things

1381
00:45:49,200 --> 00:45:51,280
that will become significant at any

1382
00:45:51,280 --> 00:45:52,079
point and

1383
00:45:52,079 --> 00:45:55,359
that is why i like what i do and this is

1384
00:45:55,359 --> 00:45:56,880
why i recommend you take that

1385
00:45:56,880 --> 00:45:58,480
you know hypothesis approach and you

1386
00:45:58,480 --> 00:46:00,240
develop some test cases and you go

1387
00:46:00,240 --> 00:46:00,800
through it

1388
00:46:00,800 --> 00:46:03,520
and if you follow the process you might

1389
00:46:03,520 --> 00:46:05,440
find or recover into this interesting

1390
00:46:05,440 --> 00:46:06,079
stuff

1391
00:46:06,079 --> 00:46:08,880
again in this case what would be

1392
00:46:08,880 --> 00:46:09,920
happening is

1393
00:46:09,920 --> 00:46:13,200
um no references about using billy's

1394
00:46:13,200 --> 00:46:14,240
body for

1395
00:46:14,240 --> 00:46:16,160
persistence anywhere and it turned out

1396
00:46:16,160 --> 00:46:18,640
to be that by us creating that detection

1397
00:46:18,640 --> 00:46:20,880
we were able to keep an eye on this

1398
00:46:20,880 --> 00:46:21,920
malware and

1399
00:46:21,920 --> 00:46:25,040
alert whenever it was in use another

1400
00:46:25,040 --> 00:46:26,480
important thing is we were able to

1401
00:46:26,480 --> 00:46:28,400
determine that the ins file is basically

1402
00:46:28,400 --> 00:46:30,160
related to other malware

1403
00:46:30,160 --> 00:46:33,280
and as a result we can use and say

1404
00:46:33,280 --> 00:46:36,000
that the original announcement about the

1405
00:46:36,000 --> 00:46:37,920
number of infections is in

1406
00:46:37,920 --> 00:46:40,640
it's actually you know exaggerated and

1407
00:46:40,640 --> 00:46:41,680
more likely is

1408
00:46:41,680 --> 00:46:43,839
much more lower two to three thousand k

1409
00:46:43,839 --> 00:46:44,800
infections

1410
00:46:44,800 --> 00:46:47,200
now that actually opens up for a lot of

1411
00:46:47,200 --> 00:46:47,839
multiple

1412
00:46:47,839 --> 00:46:49,760
of questions that i'm not going to be

1413
00:46:49,760 --> 00:46:51,119
able to answer here

1414
00:46:51,119 --> 00:46:53,359
but you know one of the interesting

1415
00:46:53,359 --> 00:46:54,480
questions that for me

1416
00:46:54,480 --> 00:46:56,560
you know becomes supplies you know is

1417
00:46:56,560 --> 00:46:57,680
there a framework

1418
00:46:57,680 --> 00:47:00,160
that um some of these malware developers

1419
00:47:00,160 --> 00:47:00,960
are using

1420
00:47:00,960 --> 00:47:03,200
or is was this a single developer that

1421
00:47:03,200 --> 00:47:04,319
is selling this

1422
00:47:04,319 --> 00:47:07,920
to two buyers um there is definitely an

1423
00:47:07,920 --> 00:47:09,119
ecosystem of

1424
00:47:09,119 --> 00:47:10,960
malware especially adware that has been

1425
00:47:10,960 --> 00:47:12,560
applied and is used

1426
00:47:12,560 --> 00:47:14,800
and that is significant it's important

1427
00:47:14,800 --> 00:47:16,960
to to note and we kind of show that that

1428
00:47:16,960 --> 00:47:17,599
is at play

1429
00:47:17,599 --> 00:47:20,640
here but what this would have been super

1430
00:47:20,640 --> 00:47:21,520
interesting is

1431
00:47:21,520 --> 00:47:24,079
what was the next stage and in my

1432
00:47:24,079 --> 00:47:26,400
opinion the operators kind of

1433
00:47:26,400 --> 00:47:28,800
messed up on that one and i think that

1434
00:47:28,800 --> 00:47:30,319
the call that was done by

1435
00:47:30,319 --> 00:47:31,760
you know red county to bring it to the

1436
00:47:31,760 --> 00:47:33,200
line with all the other vendors like

1437
00:47:33,200 --> 00:47:34,319
malwarebytes

1438
00:47:34,319 --> 00:47:36,960
um was great you know basically end this

1439
00:47:36,960 --> 00:47:37,440
because

1440
00:47:37,440 --> 00:47:39,119
it could actually get really bad and

1441
00:47:39,119 --> 00:47:40,559
there's no reason to

1442
00:47:40,559 --> 00:47:42,079
to you know keep an eye on it and it

1443
00:47:42,079 --> 00:47:43,680
hasn't happened and

1444
00:47:43,680 --> 00:47:46,400
you know it is a recipe for disaster if

1445
00:47:46,400 --> 00:47:47,599
the second problem would have come on it

1446
00:47:47,599 --> 00:47:49,520
could have been really really bad

1447
00:47:49,520 --> 00:47:52,559
um so um

1448
00:47:52,559 --> 00:47:55,200
with that said um i've reached the end

1449
00:47:55,200 --> 00:47:56,960
of the talk i just want to you know

1450
00:47:56,960 --> 00:47:59,520
take the time to do some props obviously

1451
00:47:59,520 --> 00:48:00,720
to red canary

1452
00:48:00,720 --> 00:48:03,200
special scooter to tony tony lambert um

1453
00:48:03,200 --> 00:48:04,640
i get the chance to talk to him

1454
00:48:04,640 --> 00:48:06,079
he actually likes to share a lot of

1455
00:48:06,079 --> 00:48:08,240
stuff so kudos tony

1456
00:48:08,240 --> 00:48:10,400
you're you're a good friend um wanna say

1457
00:48:10,400 --> 00:48:12,720
thank you to the mayhem city sec team

1458
00:48:12,720 --> 00:48:15,440
thank you for inviting me um and

1459
00:48:15,440 --> 00:48:16,880
allowing me to be part of here

1460
00:48:16,880 --> 00:48:19,520
and the week on ellie um they're part of

1461
00:48:19,520 --> 00:48:20,160
the um

1462
00:48:20,160 --> 00:48:21,920
rtm community this is a tool that we

1463
00:48:21,920 --> 00:48:23,280
open source that you can go and download

1464
00:48:23,280 --> 00:48:24,480
for free and deploy it

1465
00:48:24,480 --> 00:48:26,960
and get really good network telemetry um

1466
00:48:26,960 --> 00:48:28,160
and that will help you in your

1467
00:48:28,160 --> 00:48:29,520
hunting activities or forensic

1468
00:48:29,520 --> 00:48:31,200
investigations um

1469
00:48:31,200 --> 00:48:32,640
i want to say thank you to the partners

1470
00:48:32,640 --> 00:48:35,359
in both um daniel collins

1471
00:48:35,359 --> 00:48:38,720
our awesome uh security team uh agent

1472
00:48:38,720 --> 00:48:41,920
tk which is the pocket connoisseur and

1473
00:48:41,920 --> 00:48:43,359
uh sean esposito

1474
00:48:43,359 --> 00:48:45,440
um he is the wizard of wars and helped

1475
00:48:45,440 --> 00:48:46,960
us on the blog

1476
00:48:46,960 --> 00:48:49,040
and you know paying attention i didn't

1477
00:48:49,040 --> 00:48:50,559
have any typos in here so thank you

1478
00:48:50,559 --> 00:48:52,000
everyone to get involved

1479
00:48:52,000 --> 00:48:54,559
um the team i'm you know part of the

1480
00:48:54,559 --> 00:48:55,520
fire team and

1481
00:48:55,520 --> 00:48:58,319
all of the fire team and with that just

1482
00:48:58,319 --> 00:48:59,760
want to say thank you thank you for

1483
00:48:59,760 --> 00:49:01,440
watching hopefully this was of use to

1484
00:49:01,440 --> 00:49:02,319
you

1485
00:49:02,319 --> 00:49:05,359
and if you have any questions i'm around

1486
00:49:05,359 --> 00:49:08,800
let me know happy to answer anything um

1487
00:49:08,800 --> 00:49:10,800
and especially if it's content related

1488
00:49:10,800 --> 00:49:13,200
you're happy to do it

1489
00:49:13,200 --> 00:49:16,400
okay thank you so much block there was

1490
00:49:16,400 --> 00:49:19,520
so much uh information that i'm

1491
00:49:19,520 --> 00:49:21,440
happy that we are actually recording

1492
00:49:21,440 --> 00:49:23,040
this and you can

1493
00:49:23,040 --> 00:49:26,400
go back to them and reverse

1494
00:49:26,400 --> 00:49:30,000
so i do have uh some questions which i

1495
00:49:30,000 --> 00:49:33,359
picked up from here and there is the

1496
00:49:33,359 --> 00:49:37,119
one does the newest mac os bixer

1497
00:49:37,119 --> 00:49:40,400
make things uh signific significantly

1498
00:49:40,400 --> 00:49:42,079
harder

1499
00:49:42,079 --> 00:49:45,599
for malware authors so

1500
00:49:45,599 --> 00:49:49,359
um yes um the apple ecosystem

1501
00:49:49,359 --> 00:49:52,640
in in some way yes um the the apple

1502
00:49:52,640 --> 00:49:54,160
ecosystem has

1503
00:49:54,160 --> 00:49:56,079
created certain things to make that a

1504
00:49:56,079 --> 00:49:57,359
little bit more difficult now on the

1505
00:49:57,359 --> 00:49:58,720
flip side

1506
00:49:58,720 --> 00:50:00,640
because the apple ecosystem is kind of a

1507
00:50:00,640 --> 00:50:01,839
little bit close

1508
00:50:01,839 --> 00:50:03,920
um and not not a lot of people are

1509
00:50:03,920 --> 00:50:06,319
exploring it especially on the iphone's

1510
00:50:06,319 --> 00:50:08,559
ipads there's a lot of stuff we don't

1511
00:50:08,559 --> 00:50:10,240
know and there's a lot of possible zero

1512
00:50:10,240 --> 00:50:11,440
days that exist

1513
00:50:11,440 --> 00:50:14,079
and they're basically going unnoticed um

1514
00:50:14,079 --> 00:50:15,680
as far as your machine

1515
00:50:15,680 --> 00:50:17,520
pixel did change a few things that are

1516
00:50:17,520 --> 00:50:18,960
making it a little more difficult

1517
00:50:18,960 --> 00:50:19,599
recently

1518
00:50:19,599 --> 00:50:22,559
there was um i i actually as part of

1519
00:50:22,559 --> 00:50:23,680
this testing one of the things

1520
00:50:23,680 --> 00:50:25,520
i didn't mention i was using another

1521
00:50:25,520 --> 00:50:27,440
technique that i didn't know was

1522
00:50:27,440 --> 00:50:30,640
actually a vulnerability on uh on macos

1523
00:50:30,640 --> 00:50:31,920
that was made public by

1524
00:50:31,920 --> 00:50:35,200
cedric recently uh and he got a cve

1525
00:50:35,200 --> 00:50:38,839
basically you could um bypass

1526
00:50:38,839 --> 00:50:41,920
um the

1527
00:50:41,920 --> 00:50:45,280
the sandbox that mac os uses so um i

1528
00:50:45,280 --> 00:50:46,559
think that one of the good things is

1529
00:50:46,559 --> 00:50:49,040
that apple has done a really good job at

1530
00:50:49,040 --> 00:50:50,160
trying to make sure that you're

1531
00:50:50,160 --> 00:50:52,559
protected and i think big sur

1532
00:50:52,559 --> 00:50:55,839
is a step forward into that protection

1533
00:50:55,839 --> 00:50:59,119
okay so the next next question is

1534
00:50:59,119 --> 00:51:01,920
is there a common theme in mac os

1535
00:51:01,920 --> 00:51:02,720
malware

1536
00:51:02,720 --> 00:51:05,680
and what is the user objective of mac

1537
00:51:05,680 --> 00:51:08,640
malware authors

1538
00:51:08,640 --> 00:51:11,119
so there there seems to be in general

1539
00:51:11,119 --> 00:51:13,040
there is a common theme

1540
00:51:13,040 --> 00:51:16,480
and you will find that um one way you

1541
00:51:16,480 --> 00:51:18,400
can make money on mac os malware is

1542
00:51:18,400 --> 00:51:20,319
basically you get install an application

1543
00:51:20,319 --> 00:51:22,240
i show you a cluster that is about

1544
00:51:22,240 --> 00:51:24,160
search right all the apps have to do

1545
00:51:24,160 --> 00:51:25,440
with search so

1546
00:51:25,440 --> 00:51:27,119
you know it could be an add-on on your

1547
00:51:27,119 --> 00:51:29,599
browser and and is basically

1548
00:51:29,599 --> 00:51:32,319
uh you're throwing uh redirects to

1549
00:51:32,319 --> 00:51:34,480
websites and you basically get money of

1550
00:51:34,480 --> 00:51:35,359
those visits

1551
00:51:35,359 --> 00:51:36,800
whether they happen on the background if

1552
00:51:36,800 --> 00:51:39,599
you know or not but the problem is that

1553
00:51:39,599 --> 00:51:42,640
that initial lower level adware

1554
00:51:42,640 --> 00:51:45,520
usually lends itself to then be used by

1555
00:51:45,520 --> 00:51:47,440
much more nefarious malware

1556
00:51:47,440 --> 00:51:50,319
so if you think about it as a malware

1557
00:51:50,319 --> 00:51:51,680
operator i have an incentive

1558
00:51:51,680 --> 00:51:53,920
incentive to infect some machines and

1559
00:51:53,920 --> 00:51:56,400
then monetize off of them and then sell

1560
00:51:56,400 --> 00:51:57,040
you

1561
00:51:57,040 --> 00:52:00,160
you know access uh which i have no proof

1562
00:52:00,160 --> 00:52:01,520
that that is taking place

1563
00:52:01,520 --> 00:52:03,280
but i wouldn't suspect that you know

1564
00:52:03,280 --> 00:52:04,559
that it's already happening

1565
00:52:04,559 --> 00:52:06,800
and to be honest silver sparrow it did

1566
00:52:06,800 --> 00:52:07,680
seem that he had

1567
00:52:07,680 --> 00:52:09,920
all the capabilities to be exactly that

1568
00:52:09,920 --> 00:52:11,520
it's just we never saw the secondary

1569
00:52:11,520 --> 00:52:13,920
payload

1570
00:52:13,920 --> 00:52:17,599
okay so uh i think we can take a few

1571
00:52:17,599 --> 00:52:18,880
mores here

1572
00:52:18,880 --> 00:52:21,520
so how would you go about building a

1573
00:52:21,520 --> 00:52:22,880
forensic lab for

1574
00:52:22,880 --> 00:52:26,800
macos malware and creating mac os

1575
00:52:26,800 --> 00:52:30,160
virtual machine isn't an as easy as

1576
00:52:30,160 --> 00:52:33,200
windows or linux um so actually it's

1577
00:52:33,200 --> 00:52:35,040
actually fairly easy you know you

1578
00:52:35,040 --> 00:52:38,079
you could totally um

1579
00:52:38,079 --> 00:52:40,720
but if you have a mac it's really easy

1580
00:52:40,720 --> 00:52:42,880
you basically download the iso for

1581
00:52:42,880 --> 00:52:46,000
your mac operating system you download

1582
00:52:46,000 --> 00:52:49,520
um vmware fusion and you basically

1583
00:52:49,520 --> 00:52:52,319
run vmware fusion on top of your machine

1584
00:52:52,319 --> 00:52:52,880
or

1585
00:52:52,880 --> 00:52:56,079
any of the hypervisors and yeah it could

1586
00:52:56,079 --> 00:52:58,720
totally run

1587
00:52:59,040 --> 00:53:02,240
apple uh operating system um if you have

1588
00:53:02,240 --> 00:53:03,280
a pc

1589
00:53:03,280 --> 00:53:04,720
uh it gets a little more tricky more

1590
00:53:04,720 --> 00:53:06,640
difficult i i really haven't tried that

1591
00:53:06,640 --> 00:53:08,800
in a long time i have a

1592
00:53:08,800 --> 00:53:11,599
a powerful um laptop that allows me to

1593
00:53:11,599 --> 00:53:12,480
basically do that

1594
00:53:12,480 --> 00:53:16,319
now aws amazon now offers the services

1595
00:53:16,319 --> 00:53:17,680
where you can actually go on

1596
00:53:17,680 --> 00:53:20,000
and spawn an instance that will be mac

1597
00:53:20,000 --> 00:53:20,720
os

1598
00:53:20,720 --> 00:53:22,800
um it's not as cheap so it's expensive

1599
00:53:22,800 --> 00:53:25,119
so be prepared to spend some money i do

1600
00:53:25,119 --> 00:53:26,960
recommend that you basically do a mini

1601
00:53:26,960 --> 00:53:29,040
live and that's what i do i have in my

1602
00:53:29,040 --> 00:53:32,000
uh at home i have my mini lab and

1603
00:53:32,000 --> 00:53:33,760
another thing you could do is literally

1604
00:53:33,760 --> 00:53:37,359
um buy an older laptop that has enough

1605
00:53:37,359 --> 00:53:39,839
ram and that will allow you to to run

1606
00:53:39,839 --> 00:53:40,559
things

1607
00:53:40,559 --> 00:53:43,680
and so what you want to do is uh

1608
00:53:43,680 --> 00:53:46,079
if you do that i will recommend that you

1609
00:53:46,079 --> 00:53:47,119
look into the

1610
00:53:47,119 --> 00:53:50,400
um objective c tools

1611
00:53:50,400 --> 00:53:52,640
uh patrick has done a great job and has

1612
00:53:52,640 --> 00:53:53,760
a bunch of

1613
00:53:53,760 --> 00:53:56,000
free tools out there that will be useful

1614
00:53:56,000 --> 00:53:57,040
if you want to

1615
00:53:57,040 --> 00:53:59,119
do some malware analysis definitely it's

1616
00:53:59,119 --> 00:54:00,880
told something like always query

1617
00:54:00,880 --> 00:54:03,440
it's completely open source and you will

1618
00:54:03,440 --> 00:54:05,040
be able to collect logs

1619
00:54:05,040 --> 00:54:07,520
uh there's a few other tools out there

1620
00:54:07,520 --> 00:54:09,280
that will look into the process and i

1621
00:54:09,280 --> 00:54:10,079
can get a list

1622
00:54:10,079 --> 00:54:12,319
and share it on the channel if needed

1623
00:54:12,319 --> 00:54:13,520
there's a set of tools that i kind of

1624
00:54:13,520 --> 00:54:14,319
like to use

1625
00:54:14,319 --> 00:54:16,319
and allows you to kind of look into the

1626
00:54:16,319 --> 00:54:17,839
process activity and whatnot there's

1627
00:54:17,839 --> 00:54:18,400
another

1628
00:54:18,400 --> 00:54:19,839
very interesting book for anyone that

1629
00:54:19,839 --> 00:54:22,800
wants to get into this world of mac os

1630
00:54:22,800 --> 00:54:26,720
that is um by um jonathan

1631
00:54:26,720 --> 00:54:29,359
levy and is basically three very amazing

1632
00:54:29,359 --> 00:54:31,200
books on all about mac os

1633
00:54:31,200 --> 00:54:32,880
uh that i recommend reading now i'll put

1634
00:54:32,880 --> 00:54:34,720
a link but basically it's super easy

1635
00:54:34,720 --> 00:54:35,200
just

1636
00:54:35,200 --> 00:54:37,839
you know get the iso run bmware and

1637
00:54:37,839 --> 00:54:39,680
enough you go and just apply the tools

1638
00:54:39,680 --> 00:54:40,559
that you want to

1639
00:54:40,559 --> 00:54:41,839
use to kind of keep an eye on the

1640
00:54:41,839 --> 00:54:43,680
malware

1641
00:54:43,680 --> 00:54:46,079
okay um i'm going to take the last

1642
00:54:46,079 --> 00:54:48,079
question and then we can

1643
00:54:48,079 --> 00:54:52,319
continue the so um

1644
00:54:52,319 --> 00:54:55,920
uh was the current quarantine event a

1645
00:54:55,920 --> 00:54:58,960
sort of convenient essence way to get a

1646
00:54:58,960 --> 00:54:59,760
handle

1647
00:54:59,760 --> 00:55:02,079
when the payload has been successfully

1648
00:55:02,079 --> 00:55:04,079
loaded on the machine

1649
00:55:04,079 --> 00:55:07,599
did uh the

1650
00:55:07,599 --> 00:55:10,720
the question uh president er cut it

1651
00:55:10,720 --> 00:55:11,520
right

1652
00:55:11,520 --> 00:55:14,000
or is it oh i guess this is the

1653
00:55:14,000 --> 00:55:15,119
references about the

1654
00:55:15,119 --> 00:55:17,040
why did the quarantine check took place

1655
00:55:17,040 --> 00:55:19,920
right so basically in this case

1656
00:55:19,920 --> 00:55:22,799
the quantum query is basically the

1657
00:55:22,799 --> 00:55:23,520
malware

1658
00:55:23,520 --> 00:55:26,720
after installing is trying to collect a

1659
00:55:26,720 --> 00:55:29,119
few things to be able to track back

1660
00:55:29,119 --> 00:55:32,640
how you know which machines are being

1661
00:55:32,640 --> 00:55:33,280
installed

1662
00:55:33,280 --> 00:55:36,000
and the url so in macos whenever you

1663
00:55:36,000 --> 00:55:37,040
download a file

1664
00:55:37,040 --> 00:55:40,319
um from the internet there is a table

1665
00:55:40,319 --> 00:55:42,640
that basically tracks where those files

1666
00:55:42,640 --> 00:55:44,000
are being downloaded

1667
00:55:44,000 --> 00:55:47,119
and that allows you to basically

1668
00:55:47,119 --> 00:55:50,640
um query whatever you want in the and

1669
00:55:50,640 --> 00:55:52,480
find a url or a parameter

1670
00:55:52,480 --> 00:55:54,559
and in this case i have no mistaken for

1671
00:55:54,559 --> 00:55:56,000
that person to solve spiral basically

1672
00:55:56,000 --> 00:55:57,040
what he's doing is looking for a

1673
00:55:57,040 --> 00:55:58,400
particular field

1674
00:55:58,400 --> 00:56:00,640
and that film was used to basically

1675
00:56:00,640 --> 00:56:01,440
track who

1676
00:56:01,440 --> 00:56:04,160
who how is these infections getting in

1677
00:56:04,160 --> 00:56:04,799
there

1678
00:56:04,799 --> 00:56:08,160
now some malware might use the uh

1679
00:56:08,160 --> 00:56:10,000
quarantine files to bypass it the

1680
00:56:10,000 --> 00:56:11,440
sandbox and that was a well-known

1681
00:56:11,440 --> 00:56:12,880
evolution that existed

1682
00:56:12,880 --> 00:56:16,319
that all the malware um so there are

1683
00:56:16,319 --> 00:56:18,960
techniques in which you will use the sql

1684
00:56:18,960 --> 00:56:22,720
command to look into it to either

1685
00:56:22,720 --> 00:56:24,960
read content and then take those and put

1686
00:56:24,960 --> 00:56:27,119
them into a file and if i

1687
00:56:27,119 --> 00:56:29,200
if you look at the slides you will see

1688
00:56:29,200 --> 00:56:31,599
that it is looking for a particular

1689
00:56:31,599 --> 00:56:35,119
um field and is being put into

1690
00:56:35,119 --> 00:56:38,000
this sh file if you're not mistaken so

1691
00:56:38,000 --> 00:56:39,839
that was that was more than 10 not not

1692
00:56:39,839 --> 00:56:41,599
to bypass but to pull

1693
00:56:41,599 --> 00:56:44,640
information um about the download

1694
00:56:44,640 --> 00:56:47,920
um i believe not 100 at this at this

1695
00:56:47,920 --> 00:56:49,520
time i need to look at it again but

1696
00:56:49,520 --> 00:56:51,040
i believe that was the reason for it

1697
00:56:51,040 --> 00:56:52,720
hopefully that is the question let me

1698
00:56:52,720 --> 00:56:54,079
know if that is the case

1699
00:56:54,079 --> 00:56:58,240
if not happy to clarify anything

1700
00:56:58,240 --> 00:57:00,079
yeah i think you can actually continue

1701
00:57:00,079 --> 00:57:01,680
the discussion

1702
00:57:01,680 --> 00:57:04,799
on our uh chat channel chat

1703
00:57:04,799 --> 00:57:06,640
so there was the question and you can

1704
00:57:06,640 --> 00:57:08,240
actually find the

1705
00:57:08,240 --> 00:57:11,359
person who was asking

1706
00:57:11,359 --> 00:57:14,960
it and i think we

1707
00:57:14,960 --> 00:57:18,799
this was um excellent day i've been

1708
00:57:18,799 --> 00:57:20,640
really thrilled to be able to actually

1709
00:57:20,640 --> 00:57:22,000
host you all

1710
00:57:22,000 --> 00:57:25,119
and i'm really thanking you black for

1711
00:57:25,119 --> 00:57:28,160
hopping in here it was really amazing to

1712
00:57:28,160 --> 00:57:31,200
listen to all of your talks and

1713
00:57:31,200 --> 00:57:34,559
yeah so if you are still online

1714
00:57:34,559 --> 00:57:37,359
i highly recommend everybody to actually

1715
00:57:37,359 --> 00:57:38,640
join into our

1716
00:57:38,640 --> 00:57:40,880
discord server there you can actually

1717
00:57:40,880 --> 00:57:42,000
continue the talk

1718
00:57:42,000 --> 00:57:45,119
and find the table and have a chat

1719
00:57:45,119 --> 00:57:48,240
it's great they have got you

1720
00:57:48,240 --> 00:57:52,319
the really fun stuff there going on

1721
00:57:52,319 --> 00:57:55,920
and i think that was all and

1722
00:57:55,920 --> 00:57:58,119
the ones who are still online

1723
00:57:58,119 --> 00:58:00,400
congratulations you just survived the

1724
00:58:00,400 --> 00:58:02,880
mayhem

1725
00:58:02,960 --> 00:58:08,319
thank you for inviting me

