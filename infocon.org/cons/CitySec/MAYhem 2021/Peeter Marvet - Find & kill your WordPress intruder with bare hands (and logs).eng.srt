1
00:00:02,639 --> 00:00:03,520
okay

2
00:00:03,520 --> 00:00:06,560
welcome to today's second and probably

3
00:00:06,560 --> 00:00:07,520
also the last

4
00:00:07,520 --> 00:00:10,480
uh workshop we must burn the internet

5
00:00:10,480 --> 00:00:10,880
down

6
00:00:10,880 --> 00:00:14,160
so we don't need to care about

7
00:00:14,160 --> 00:00:17,039
what's coming to happen after me i was

8
00:00:17,039 --> 00:00:18,480
just informed that you

9
00:00:18,480 --> 00:00:21,760
had the chance to see the wrong video

10
00:00:21,760 --> 00:00:25,599
so i do expect there will be a

11
00:00:25,599 --> 00:00:29,279
right video at some time

12
00:00:29,279 --> 00:00:32,479
my name is peter barbat i'm working for

13
00:00:32,479 --> 00:00:36,079
zone.te which is estonian largest

14
00:00:36,079 --> 00:00:38,480
web hosting provider nobody believes

15
00:00:38,480 --> 00:00:39,360
that

16
00:00:39,360 --> 00:00:41,360
my official position there happens to be

17
00:00:41,360 --> 00:00:42,719
related to marketing

18
00:00:42,719 --> 00:00:44,960
but i'm mostly having business cards

19
00:00:44,960 --> 00:00:45,920
with

20
00:00:45,920 --> 00:00:48,559
text like

21
00:00:49,280 --> 00:00:52,879
resident hacker and i work in making

22
00:00:52,879 --> 00:00:54,719
things like

23
00:00:54,719 --> 00:00:58,879
really fancy stickers like we sell speed

24
00:00:58,879 --> 00:01:02,079
and seems apparently

25
00:01:02,079 --> 00:01:05,199
yeah and you hacked what and then things

26
00:01:05,199 --> 00:01:06,960
like this so if anybody

27
00:01:06,960 --> 00:01:08,880
is interested in this then this is my

28
00:01:08,880 --> 00:01:10,880
actual work my hobby work

29
00:01:10,880 --> 00:01:15,200
is related to the fact that we have

30
00:01:15,200 --> 00:01:19,040
over 40 000 web servers

31
00:01:19,040 --> 00:01:22,080
or our clients web servers under

32
00:01:22,080 --> 00:01:25,360
or running on our platform and

33
00:01:25,360 --> 00:01:27,920
which is something like about one-third

34
00:01:27,920 --> 00:01:29,920
of estonian websites

35
00:01:29,920 --> 00:01:33,119
um that also means that uh we are

36
00:01:33,119 --> 00:01:33,759
getting

37
00:01:33,759 --> 00:01:37,600
uh let's say one-third of uh attention

38
00:01:37,600 --> 00:01:40,720
from everybody trying to take down these

39
00:01:40,720 --> 00:01:42,000
websites

40
00:01:42,000 --> 00:01:45,680
and often the reasons are pretty

41
00:01:45,680 --> 00:01:48,479
simple like usually nothing being

42
00:01:48,479 --> 00:01:50,960
updated

43
00:01:50,960 --> 00:01:54,000
really stupid passwords and

44
00:01:54,000 --> 00:01:57,920
they and similar common things

45
00:01:58,159 --> 00:02:00,719
but we somehow need to get the sites

46
00:02:00,719 --> 00:02:02,240
back up

47
00:02:02,240 --> 00:02:05,759
explain to clients that no no we didn't

48
00:02:05,759 --> 00:02:08,479
cause the trouble that the trouble is

49
00:02:08,479 --> 00:02:09,919
whoever

50
00:02:09,919 --> 00:02:12,560
set it up poorly or maybe forgot to

51
00:02:12,560 --> 00:02:14,000
change the password after putting a

52
00:02:14,000 --> 00:02:15,440
website live

53
00:02:15,440 --> 00:02:18,560
so for past five and a half years

54
00:02:18,560 --> 00:02:22,720
i've had time to play around

55
00:02:22,720 --> 00:02:27,200
with a lot of live problems

56
00:02:27,200 --> 00:02:30,400
and i started just

57
00:02:30,400 --> 00:02:32,800
looking over shoulder of my colleagues

58
00:02:32,800 --> 00:02:34,480
and asking that

59
00:02:34,480 --> 00:02:36,800
how do you automate this process or how

60
00:02:36,800 --> 00:02:38,959
do you make this work easier or how do

61
00:02:38,959 --> 00:02:39,680
you

62
00:02:39,680 --> 00:02:42,080
collect the information from different

63
00:02:42,080 --> 00:02:43,280
incidents you are seeing

64
00:02:43,280 --> 00:02:44,720
and what do you what we are learning

65
00:02:44,720 --> 00:02:47,200
about that and

66
00:02:47,200 --> 00:02:51,120
so i started building some tools

67
00:02:51,120 --> 00:02:54,400
actually i think tool is a

68
00:02:54,400 --> 00:02:57,519
too nice word for that you will be

69
00:02:57,519 --> 00:03:01,760
seeing my

70
00:03:01,760 --> 00:03:05,599
my scripts today they look really ugly

71
00:03:05,599 --> 00:03:08,720
because mostly when i'm

72
00:03:08,720 --> 00:03:10,879
scripting something i usually start with

73
00:03:10,879 --> 00:03:11,760
just a

74
00:03:11,760 --> 00:03:14,159
document named memo where i'm copy

75
00:03:14,159 --> 00:03:16,239
pasting all of the commands i have been

76
00:03:16,239 --> 00:03:19,519
repeatedly using and at some point

77
00:03:19,519 --> 00:03:23,200
i'm slightly redesigning the memo

78
00:03:23,200 --> 00:03:26,560
or text into something dot sh

79
00:03:26,560 --> 00:03:28,720
a shell script or maybe adding something

80
00:03:28,720 --> 00:03:30,000
in php or doing

81
00:03:30,000 --> 00:03:34,000
something like that and

82
00:03:34,000 --> 00:03:36,080
initially i don't know i don't

83
00:03:36,080 --> 00:03:37,840
absolutely know what i'm doing

84
00:03:37,840 --> 00:03:40,159
and then i'm starting building these

85
00:03:40,159 --> 00:03:42,159
things and

86
00:03:42,159 --> 00:03:44,560
i have very basically never had time to

87
00:03:44,560 --> 00:03:45,599
refactor them

88
00:03:45,599 --> 00:03:48,400
during past five years so having said

89
00:03:48,400 --> 00:03:49,040
that

90
00:03:49,040 --> 00:03:52,640
they this is the reason why they look

91
00:03:52,640 --> 00:03:56,879
pretty ugly now

92
00:03:56,879 --> 00:04:00,239
oh another reason is also because

93
00:04:00,239 --> 00:04:02,640
at the moment i have a tool to look for

94
00:04:02,640 --> 00:04:03,680
some kind of a data

95
00:04:03,680 --> 00:04:06,720
on a compromised website i have so much

96
00:04:06,720 --> 00:04:07,360
inform

97
00:04:07,360 --> 00:04:10,720
so much compromised website data

98
00:04:10,720 --> 00:04:12,959
that i'm completely forgetting my tools

99
00:04:12,959 --> 00:04:14,879
i'm just using them

100
00:04:14,879 --> 00:04:16,880
from command lines as quickly as

101
00:04:16,880 --> 00:04:17,918
possible to

102
00:04:17,918 --> 00:04:22,000
find all of the cool hacked

103
00:04:22,000 --> 00:04:24,720
contents and how how the other party is

104
00:04:24,720 --> 00:04:26,000
working

105
00:04:26,000 --> 00:04:28,400
and somehow i've gotten to the point

106
00:04:28,400 --> 00:04:30,160
when i

107
00:04:30,160 --> 00:04:33,919
uh think that i

108
00:04:33,919 --> 00:04:37,520
i can kind of uh know who's on other

109
00:04:37,520 --> 00:04:38,000
side

110
00:04:38,000 --> 00:04:41,360
so uh i know that ah this is probably

111
00:04:41,360 --> 00:04:42,800
this guy who has

112
00:04:42,800 --> 00:04:45,360
tricked me in this particular way which

113
00:04:45,360 --> 00:04:45,840
will be

114
00:04:45,840 --> 00:04:49,199
also some samples will be seeing

115
00:04:49,199 --> 00:04:52,160
and talking about or ah these are the

116
00:04:52,160 --> 00:04:55,199
indonesian guys or this is the

117
00:04:55,199 --> 00:04:59,040
famous moroccan hacker

118
00:04:59,040 --> 00:05:02,960
and so on so kind of getting the picture

119
00:05:02,960 --> 00:05:03,600
of

120
00:05:03,600 --> 00:05:08,080
what's out there and

121
00:05:08,080 --> 00:05:11,520
i've tried to put together for today a

122
00:05:11,520 --> 00:05:13,520
[Music]

123
00:05:13,520 --> 00:05:17,759
sampling of how we had zone

124
00:05:17,759 --> 00:05:21,039
work in our second level support and

125
00:05:21,039 --> 00:05:24,240
security side trying to understand

126
00:05:24,240 --> 00:05:25,520
what's going

127
00:05:25,520 --> 00:05:28,880
on on websites and when they have hacked

128
00:05:28,880 --> 00:05:31,199
and find out how exactly they have been

129
00:05:31,199 --> 00:05:32,000
have been

130
00:05:32,000 --> 00:05:35,360
compromised because before you can clean

131
00:05:35,360 --> 00:05:36,479
something

132
00:05:36,479 --> 00:05:39,600
you need to actually know how the bad

133
00:05:39,600 --> 00:05:41,120
guy is cut in

134
00:05:41,120 --> 00:05:44,240
you can't plug the holes and find all of

135
00:05:44,240 --> 00:05:44,800
them

136
00:05:44,800 --> 00:05:48,160
find all of the malware uh before

137
00:05:48,160 --> 00:05:51,759
you know what is their technique tactic

138
00:05:51,759 --> 00:05:55,199
tactics techniques and procedures

139
00:05:55,199 --> 00:05:59,039
or was in other order so

140
00:05:59,039 --> 00:06:02,160
oh and we'll be looking

141
00:06:02,160 --> 00:06:05,280
during this at some

142
00:06:05,280 --> 00:06:08,720
websites most of them actually the most

143
00:06:08,720 --> 00:06:13,759
difficult part for this workshop for us

144
00:06:13,759 --> 00:06:17,120
finding ways to have

145
00:06:17,120 --> 00:06:20,960
both anonymized information from real

146
00:06:20,960 --> 00:06:22,000
cases

147
00:06:22,000 --> 00:06:25,280
or having a let's say synthetic

148
00:06:25,280 --> 00:06:29,039
websites to to try out and also have a

149
00:06:29,039 --> 00:06:31,280
playground for you to try the tools

150
00:06:31,280 --> 00:06:34,800
later um

151
00:06:34,800 --> 00:06:38,400
this means that uh some of the sites

152
00:06:38,400 --> 00:06:41,759
uh where i do have the malware

153
00:06:41,759 --> 00:06:45,280
and where we what we are going to see

154
00:06:45,280 --> 00:06:49,199
are sites where after you learn to use

155
00:06:49,199 --> 00:06:49,919
the tools

156
00:06:49,919 --> 00:06:53,199
you can actually get the get the malware

157
00:06:53,199 --> 00:06:57,680
you can probably find some md5 hashed

158
00:06:57,680 --> 00:07:00,560
passwords in the malware and you can use

159
00:07:00,560 --> 00:07:02,160
the same malware to get

160
00:07:02,160 --> 00:07:05,199
into the server and

161
00:07:05,199 --> 00:07:09,919
screw it up uh please don't be

162
00:07:09,919 --> 00:07:13,360
because some servers have been running

163
00:07:13,360 --> 00:07:14,840
for some time

164
00:07:14,840 --> 00:07:17,199
and especially the wrong history is

165
00:07:17,199 --> 00:07:18,960
something which

166
00:07:18,960 --> 00:07:21,199
makes them interesting to investigate

167
00:07:21,199 --> 00:07:22,400
again

168
00:07:22,400 --> 00:07:25,360
and if you just go there and tweet

169
00:07:25,360 --> 00:07:27,120
everything or do something then

170
00:07:27,120 --> 00:07:30,400
yeah it's possible but please just don't

171
00:07:30,400 --> 00:07:31,599
do that

172
00:07:31,599 --> 00:07:34,960
also at some part

173
00:07:34,960 --> 00:07:38,240
we'll be having a possibility to launch

174
00:07:38,240 --> 00:07:41,759
some droplets on digitalocean

175
00:07:41,759 --> 00:07:45,440
why not on our own hosting where well

176
00:07:45,440 --> 00:07:49,120
i like to again i hope nobody is going

177
00:07:49,120 --> 00:07:50,960
to use the droplets for anything

178
00:07:50,960 --> 00:07:53,680
malicious you probably can send email

179
00:07:53,680 --> 00:07:54,240
from

180
00:07:54,240 --> 00:07:56,840
them because i for some examples i had

181
00:07:56,840 --> 00:07:58,080
to

182
00:07:58,080 --> 00:08:01,759
keep that allowed and so on so

183
00:08:01,759 --> 00:08:03,520
i hope you don't do that but anyway i

184
00:08:03,520 --> 00:08:05,120
decided to do it on

185
00:08:05,120 --> 00:08:09,120
our own platform

186
00:08:09,280 --> 00:08:13,039
so uh there is there are a couple of

187
00:08:13,039 --> 00:08:13,680
tools

188
00:08:13,680 --> 00:08:17,759
uh we'd like you i'd like you to try

189
00:08:17,759 --> 00:08:21,039
as was mentioned in the pre-workshop

190
00:08:21,039 --> 00:08:22,319
information

191
00:08:22,319 --> 00:08:27,440
uh we're going to use

192
00:08:27,440 --> 00:08:31,440
mostly the browser the later part will

193
00:08:31,440 --> 00:08:32,640
be also including

194
00:08:32,640 --> 00:08:36,320
if somebody wants to try things

195
00:08:36,320 --> 00:08:40,159
using ssh on some

196
00:08:40,159 --> 00:08:44,399
vms but

197
00:08:44,800 --> 00:08:46,880
i tried to keep this thing as simple as

198
00:08:46,880 --> 00:08:49,360
possible

199
00:08:49,600 --> 00:08:52,720
i have been using myself for

200
00:08:52,720 --> 00:08:56,399
log analysis for a long time an estonian

201
00:08:56,399 --> 00:08:57,760
tool called

202
00:08:57,760 --> 00:09:01,600
spectix and

203
00:09:02,080 --> 00:09:05,920
to see the logs together with me

204
00:09:05,920 --> 00:09:09,920
there are two ways one is that you can

205
00:09:09,920 --> 00:09:14,800
go to spectix.com

206
00:09:14,800 --> 00:09:18,160
and it's possible to get your own free

207
00:09:18,160 --> 00:09:19,680
copy

208
00:09:19,680 --> 00:09:23,360
from here and there is possibility to

209
00:09:23,360 --> 00:09:24,320
request

210
00:09:24,320 --> 00:09:27,440
the license

211
00:09:27,440 --> 00:09:29,440
during i think some some part in the

212
00:09:29,440 --> 00:09:30,800
registration

213
00:09:30,800 --> 00:09:36,000
and you can then run it on your own

214
00:09:36,000 --> 00:09:38,640
computer a desktop edition for personal

215
00:09:38,640 --> 00:09:40,080
use it's

216
00:09:40,080 --> 00:09:43,519
nicely free so

217
00:09:43,519 --> 00:09:46,720
you can request a single user license

218
00:09:46,720 --> 00:09:50,000
from here i have

219
00:09:50,000 --> 00:09:53,200
also set up a

220
00:09:53,200 --> 00:09:56,240
spectix d-cuff bad which

221
00:09:56,240 --> 00:09:59,920
is a server instance and

222
00:09:59,920 --> 00:10:02,959
uh you

223
00:10:02,959 --> 00:10:06,079
you can try it in both ways

224
00:10:06,079 --> 00:10:09,760
also the files i'll be showing on the

225
00:10:09,760 --> 00:10:13,600
this decaf pad installation will remain

226
00:10:13,600 --> 00:10:16,880
available after workshop so you can

227
00:10:16,880 --> 00:10:20,160
start easier here or or

228
00:10:20,160 --> 00:10:23,440
perhaps start with your own and be ready

229
00:10:23,440 --> 00:10:24,160
to use it

230
00:10:24,160 --> 00:10:27,760
on the monday for uh real work

231
00:10:27,760 --> 00:10:30,959
now to get in here uh

232
00:10:30,959 --> 00:10:34,800
then there is a

233
00:10:34,800 --> 00:10:37,279
google doc i was thinking about all of

234
00:10:37,279 --> 00:10:39,680
the cool ways to

235
00:10:39,680 --> 00:10:44,720
share the access video but

236
00:10:44,720 --> 00:10:48,000
after some time i found that easiest way

237
00:10:48,000 --> 00:10:50,480
is just to generate bunch of usernames

238
00:10:50,480 --> 00:10:51,200
which also

239
00:10:51,200 --> 00:10:54,399
act as as

240
00:10:54,399 --> 00:10:58,079
passwords so if you take from here

241
00:10:58,079 --> 00:11:01,120
a random one let's say

242
00:11:01,120 --> 00:11:04,240
homeless hummingbird then you

243
00:11:04,240 --> 00:11:07,200
also if you pick a password from here

244
00:11:07,200 --> 00:11:09,519
then

245
00:11:09,839 --> 00:11:13,120
add your name so everybody can pick a

246
00:11:13,120 --> 00:11:14,240
different

247
00:11:14,240 --> 00:11:17,680
username and there is no problem of

248
00:11:17,680 --> 00:11:21,200
you running under the same account

249
00:11:21,200 --> 00:11:24,560
and you can then

250
00:11:24,560 --> 00:11:28,560
log in here

251
00:11:28,560 --> 00:11:31,120
and perhaps we don't know we didn't need

252
00:11:31,120 --> 00:11:33,200
to

253
00:11:33,200 --> 00:11:35,519
keep seeing these things now another

254
00:11:35,519 --> 00:11:36,240
option

255
00:11:36,240 --> 00:11:40,560
is downloading the spectix

256
00:11:40,560 --> 00:11:43,440
and installing it which is actually

257
00:11:43,440 --> 00:11:44,720
pretty easy on

258
00:11:44,720 --> 00:11:48,079
os 10 you just need to drag it

259
00:11:48,079 --> 00:11:50,319
to

260
00:11:51,279 --> 00:11:54,880
applications folder and then

261
00:11:54,880 --> 00:11:57,360
you launch it there is i think for

262
00:11:57,360 --> 00:11:58,880
configuration there is the only thing

263
00:11:58,880 --> 00:12:00,639
you need to configure

264
00:12:00,639 --> 00:12:03,920
is your max mind

265
00:12:03,920 --> 00:12:07,600
girl light license key

266
00:12:07,600 --> 00:12:10,720
for getting the

267
00:12:10,720 --> 00:12:14,639
country and as name databases

268
00:12:14,639 --> 00:12:17,360
so you need to go to the max minds

269
00:12:17,360 --> 00:12:18,079
website

270
00:12:18,079 --> 00:12:21,519
to log in and create a key

271
00:12:21,519 --> 00:12:26,800
but oops you see also my key i i can

272
00:12:26,800 --> 00:12:30,399
replace it later so you can also if you

273
00:12:30,399 --> 00:12:33,600
did a screencrab use that one

274
00:12:33,600 --> 00:12:36,880
and once you have it installed you can

275
00:12:36,880 --> 00:12:37,680
open it

276
00:12:37,680 --> 00:12:39,839
you will be asked for two things you'll

277
00:12:39,839 --> 00:12:41,200
be asked to

278
00:12:41,200 --> 00:12:45,600
agree with the license and enter the

279
00:12:45,600 --> 00:12:49,040
license key which will be sent to an

280
00:12:49,040 --> 00:12:51,360
email or perhaps somebody has already

281
00:12:51,360 --> 00:12:52,560
done that

282
00:12:52,560 --> 00:12:56,399
before so and this is

283
00:12:56,399 --> 00:12:59,839
the place where we can actually

284
00:12:59,839 --> 00:13:02,880
start looking at

285
00:13:02,880 --> 00:13:06,320
data um

286
00:13:06,320 --> 00:13:09,440
first we can perhaps

287
00:13:09,440 --> 00:13:11,120
[Music]

288
00:13:11,120 --> 00:13:14,880
start with a story

289
00:13:14,880 --> 00:13:17,760
that actually brought me to this

290
00:13:17,760 --> 00:13:19,279
presentation

291
00:13:19,279 --> 00:13:23,760
and this is uh

292
00:13:24,079 --> 00:13:27,839
when i look at her stuff

293
00:13:27,839 --> 00:13:30,880
the sea timer decaf bad eu site

294
00:13:30,880 --> 00:13:32,800
now when you go there there is there

295
00:13:32,800 --> 00:13:34,240
should be also something on the front

296
00:13:34,240 --> 00:13:35,760
page

297
00:13:35,760 --> 00:13:39,360
yes so

298
00:13:39,360 --> 00:13:43,120
this is actually my tool which i'll be

299
00:13:43,120 --> 00:13:44,800
showing which i have been actually using

300
00:13:44,800 --> 00:13:46,639
for all of these

301
00:13:46,639 --> 00:13:50,000
years to try to understand what's going

302
00:13:50,000 --> 00:13:51,839
on on the web servers

303
00:13:51,839 --> 00:13:54,880
and the name c timer there is also

304
00:13:54,880 --> 00:13:58,959
when you look at the this

305
00:13:58,959 --> 00:14:02,480
files part there is also possible to

306
00:14:02,480 --> 00:14:05,839
go and find this tool

307
00:14:05,839 --> 00:14:09,680
on github so

308
00:14:09,680 --> 00:14:12,079
there's the php script which is just

309
00:14:12,079 --> 00:14:13,839
something

310
00:14:13,839 --> 00:14:16,480
you can drop on a random web server and

311
00:14:16,480 --> 00:14:17,120
see

312
00:14:17,120 --> 00:14:20,320
what what are the fee times so

313
00:14:20,320 --> 00:14:23,920
what's the story about of that

314
00:14:24,320 --> 00:14:27,120
when i when i started looking at how the

315
00:14:27,120 --> 00:14:28,959
websites

316
00:14:28,959 --> 00:14:30,720
what is the information that is the

317
00:14:30,720 --> 00:14:32,079
easiest way to actually

318
00:14:32,079 --> 00:14:35,839
understand what has been done

319
00:14:35,839 --> 00:14:38,800
so i have

320
00:14:39,600 --> 00:14:42,399
here two examples i think let's say

321
00:14:42,399 --> 00:14:45,760
start from example two

322
00:14:45,760 --> 00:14:50,240
what it does is it basically

323
00:14:50,240 --> 00:14:53,199
gathers from the file tree all of the c

324
00:14:53,199 --> 00:14:53,600
time

325
00:14:53,600 --> 00:14:56,800
times which is the latest

326
00:14:56,800 --> 00:14:59,920
change time of inode

327
00:14:59,920 --> 00:15:02,560
a completely different different from

328
00:15:02,560 --> 00:15:05,519
the time you're seeing in

329
00:15:05,519 --> 00:15:10,079
ls or looking at over sfdp at the site

330
00:15:10,079 --> 00:15:12,480
this is the actual change time of uh

331
00:15:12,480 --> 00:15:13,760
file or its

332
00:15:13,760 --> 00:15:18,320
parameters um now

333
00:15:18,320 --> 00:15:21,600
i was looking for rock type to

334
00:15:21,600 --> 00:15:24,160
find cool examples that are cool and

335
00:15:24,160 --> 00:15:26,320
where the

336
00:15:26,320 --> 00:15:28,480
problems are not obviously visible

337
00:15:28,480 --> 00:15:29,600
unfortunately

338
00:15:29,600 --> 00:15:33,040
i didn't find them so we have to do with

339
00:15:33,040 --> 00:15:35,360
some examples that

340
00:15:35,360 --> 00:15:38,480
do have their problems clearly visible

341
00:15:38,480 --> 00:15:41,600
like this one this is actually a site

342
00:15:41,600 --> 00:15:43,600
that i was

343
00:15:43,600 --> 00:15:47,360
helping to clean up i think this file is

344
00:15:47,360 --> 00:15:49,519
from

345
00:15:49,519 --> 00:15:52,839
october last year i had cleaned up it

346
00:15:52,839 --> 00:15:55,839
earlier and the bad guy came

347
00:15:55,839 --> 00:15:59,839
back so apparently by the sound it's

348
00:15:59,839 --> 00:16:02,399
coming by

349
00:16:02,800 --> 00:16:05,600
some kind of police or ambulance driving

350
00:16:05,600 --> 00:16:07,680
by

351
00:16:07,680 --> 00:16:11,199
so uh what's what's uh so so it's uh

352
00:16:11,199 --> 00:16:14,399
grouping the times we could uh

353
00:16:14,399 --> 00:16:17,600
do it uh also other ways

354
00:16:17,600 --> 00:16:20,639
for example you could can just

355
00:16:20,639 --> 00:16:24,000
go to the server and to a find and print

356
00:16:24,000 --> 00:16:24,639
out the

357
00:16:24,639 --> 00:16:27,279
c types and get the list and sort and

358
00:16:27,279 --> 00:16:28,399
look at

359
00:16:28,399 --> 00:16:32,079
that but looking at a long list of

360
00:16:32,079 --> 00:16:35,440
these times even sorted

361
00:16:35,440 --> 00:16:38,079
often the server contains tens of

362
00:16:38,079 --> 00:16:40,079
thousands of files

363
00:16:40,079 --> 00:16:43,360
and it was impossible to

364
00:16:43,360 --> 00:16:46,959
discern what's important and what's not

365
00:16:46,959 --> 00:16:49,759
so after having actually looked at that

366
00:16:49,759 --> 00:16:50,000
for

367
00:16:50,000 --> 00:16:53,360
some time i

368
00:16:53,519 --> 00:16:56,639
found that hmm what if i group the files

369
00:16:56,639 --> 00:16:57,680
into some kind of

370
00:16:57,680 --> 00:17:02,079
clusters by their changing time

371
00:17:02,079 --> 00:17:05,199
because and and turns out that was

372
00:17:05,199 --> 00:17:06,319
exactly the thing

373
00:17:06,319 --> 00:17:10,079
that uh made possible to see into

374
00:17:10,079 --> 00:17:13,839
what what is happening inside these deep

375
00:17:13,839 --> 00:17:17,599
directory trees of uh web applications

376
00:17:17,599 --> 00:17:20,559
so here for example is this particular

377
00:17:20,559 --> 00:17:21,760
website

378
00:17:21,760 --> 00:17:25,359
there has been somebody logging in

379
00:17:25,359 --> 00:17:29,120
at 23 12

380
00:17:29,120 --> 00:17:32,720
and 5th of october uploading into

381
00:17:32,720 --> 00:17:37,120
different parts of website

382
00:17:37,120 --> 00:17:40,320
backdoors and

383
00:17:40,480 --> 00:17:44,880
not only web shells and and so on

384
00:17:44,880 --> 00:17:48,240
changing for some reason hd access

385
00:17:48,240 --> 00:17:50,640
and also dealing with something which is

386
00:17:50,640 --> 00:17:51,280
called

387
00:17:51,280 --> 00:17:54,799
dump sec uh the dump sec is

388
00:17:54,799 --> 00:17:57,760
something i'm going to show you later it

389
00:17:57,760 --> 00:17:59,120
is really a dump

390
00:17:59,120 --> 00:18:02,320
dumb solution to a problem

391
00:18:02,320 --> 00:18:05,760
in this case what the intruder did but

392
00:18:05,760 --> 00:18:07,919
what dumpster is doing then i was

393
00:18:07,919 --> 00:18:09,760
interested in understanding how they got

394
00:18:09,760 --> 00:18:10,480
in

395
00:18:10,480 --> 00:18:12,880
because looking at the logs at that time

396
00:18:12,880 --> 00:18:13,600
i saw

397
00:18:13,600 --> 00:18:16,080
they actually came and logged into the

398
00:18:16,080 --> 00:18:17,360
wordpress

399
00:18:17,360 --> 00:18:21,679
so i installed a simple php script

400
00:18:21,679 --> 00:18:24,880
which is just saving a log file

401
00:18:24,880 --> 00:18:27,360
the information about who is logging in

402
00:18:27,360 --> 00:18:28,000
to make sure

403
00:18:28,000 --> 00:18:32,880
that that

404
00:18:36,320 --> 00:18:39,600
that i i know because in wordpress it

405
00:18:39,600 --> 00:18:41,600
may be later difficult to understand

406
00:18:41,600 --> 00:18:44,480
who actually

407
00:18:45,679 --> 00:18:47,360
logged in and whose password is

408
00:18:47,360 --> 00:18:49,360
compromised i've also used it to

409
00:18:49,360 --> 00:18:50,960
actually capture the passwords

410
00:18:50,960 --> 00:18:53,360
but in this time the guy actually came

411
00:18:53,360 --> 00:18:56,480
in looked from the log files

412
00:18:56,480 --> 00:18:59,679
he launched the php info

413
00:18:59,679 --> 00:19:02,960
check that i had prepending this

414
00:19:02,960 --> 00:19:06,720
dumpster script and changed the script

415
00:19:06,720 --> 00:19:09,360
to just comment one out one line which

416
00:19:09,360 --> 00:19:09,760
was

417
00:19:09,760 --> 00:19:12,480
doing the logging so as a result i

418
00:19:12,480 --> 00:19:14,960
didn't have a talk about

419
00:19:14,960 --> 00:19:18,400
what how they had logged in

420
00:19:18,400 --> 00:19:21,039
and i believed actually they had been

421
00:19:21,039 --> 00:19:23,360
logging in using

422
00:19:23,360 --> 00:19:25,760
somebody's password turns out they had

423
00:19:25,760 --> 00:19:27,600
actually captured earlier

424
00:19:27,600 --> 00:19:30,639
the uh

425
00:19:33,360 --> 00:19:36,080
sql password and they were using some

426
00:19:36,080 --> 00:19:38,960
kind of sql administrator trading tool

427
00:19:38,960 --> 00:19:41,600
to change the password login and then

428
00:19:41,600 --> 00:19:42,640
move on

429
00:19:42,640 --> 00:19:45,840
but these are the files and

430
00:19:45,840 --> 00:19:49,200
i think i have actually the files also

431
00:19:49,200 --> 00:19:53,760
here so i can show the same files which

432
00:19:53,760 --> 00:19:54,320
are

433
00:19:54,320 --> 00:19:59,760
here like for example the autoload

434
00:20:00,000 --> 00:20:03,360
is looking like like that

435
00:20:03,360 --> 00:20:07,840
so that's definitely

436
00:20:08,480 --> 00:20:12,559
malicious so and the rest of the files

437
00:20:12,559 --> 00:20:13,520
are

438
00:20:13,520 --> 00:20:16,480
pretty comparable

439
00:20:17,039 --> 00:20:20,320
so but the question often

440
00:20:20,320 --> 00:20:24,480
is twofold i know the change of the

441
00:20:24,480 --> 00:20:24,960
times

442
00:20:24,960 --> 00:20:27,919
but again going and checking all of

443
00:20:27,919 --> 00:20:29,360
these files

444
00:20:29,360 --> 00:20:32,799
is uh difficult to

445
00:20:32,799 --> 00:20:35,679
to to find their folders collect the

446
00:20:35,679 --> 00:20:37,120
samples and so on

447
00:20:37,120 --> 00:20:39,360
because my interest was actually to find

448
00:20:39,360 --> 00:20:40,640
a way to

449
00:20:40,640 --> 00:20:42,880
to

450
00:20:44,000 --> 00:20:47,280
to create urls

451
00:20:47,280 --> 00:20:49,679
about what i talked on previous headset

452
00:20:49,679 --> 00:20:50,320
meeting

453
00:20:50,320 --> 00:20:54,320
meetup to and to learn about

454
00:20:54,320 --> 00:20:57,520
what the guys are doing there so next

455
00:20:57,520 --> 00:20:57,919
thing

456
00:20:57,919 --> 00:21:01,679
what i did was i added the possibility

457
00:21:01,679 --> 00:21:05,760
here to actually tag the files i find

458
00:21:05,760 --> 00:21:07,840
interesting and that's the thing we are

459
00:21:07,840 --> 00:21:09,200
going to try

460
00:21:09,200 --> 00:21:13,440
uh soon on our own as well

461
00:21:13,440 --> 00:21:16,960
and the moment i have marked the

462
00:21:16,960 --> 00:21:20,159
files i get the possibility to

463
00:21:20,159 --> 00:21:23,280
download the list

464
00:21:23,280 --> 00:21:23,770
and

465
00:21:23,770 --> 00:21:26,879
[Music]

466
00:21:29,600 --> 00:21:33,120
and here one moment i'll be

467
00:21:33,120 --> 00:21:36,240
showing that also

468
00:21:36,240 --> 00:21:39,440
so basically we have the list of the

469
00:21:39,440 --> 00:21:40,320
files

470
00:21:40,320 --> 00:21:44,159
then it's possible using rsync or

471
00:21:44,159 --> 00:21:46,559
something like that

472
00:21:46,559 --> 00:21:49,600
you could get the actual files or

473
00:21:49,600 --> 00:21:52,640
if you want to try that later on your

474
00:21:52,640 --> 00:21:56,080
own web forensic tasks

475
00:21:56,080 --> 00:21:59,360
then you can

476
00:21:59,360 --> 00:22:02,640
get from here the c timer fetch

477
00:22:02,640 --> 00:22:05,919
which is uh nicely

478
00:22:05,919 --> 00:22:10,640
taking this list and you can over ssh

479
00:22:10,640 --> 00:22:14,080
fetch the files from another

480
00:22:14,080 --> 00:22:18,000
server but

481
00:22:20,000 --> 00:22:23,520
yes but that's not all

482
00:22:23,520 --> 00:22:27,039
for today i somehow

483
00:22:27,039 --> 00:22:30,640
happened to not so much just prepare for

484
00:22:30,640 --> 00:22:31,200
the

485
00:22:31,200 --> 00:22:36,000
workshop but i also changed the z timer

486
00:22:36,000 --> 00:22:40,240
so i have a

487
00:22:40,240 --> 00:22:44,480
website to play and

488
00:22:46,159 --> 00:22:49,679
it's called wuhan like let's say it's

489
00:22:49,679 --> 00:22:50,240
the

490
00:22:50,240 --> 00:22:53,280
cyber security level or cyber safety

491
00:22:53,280 --> 00:22:54,240
level 4

492
00:22:54,240 --> 00:22:56,720
laboratory for testing all kinds of

493
00:22:56,720 --> 00:22:57,919
things

494
00:22:57,919 --> 00:23:01,039
and this is

495
00:23:01,039 --> 00:23:05,120
something i have been playing around for

496
00:23:05,120 --> 00:23:08,000
some time i just registered the domain

497
00:23:08,000 --> 00:23:10,000
so nobody will crap and use it for a

498
00:23:10,000 --> 00:23:11,760
malicious use and

499
00:23:11,760 --> 00:23:14,960
then one day i need somewhere to put a

500
00:23:14,960 --> 00:23:17,679
honeypot and i kind of thought it's a

501
00:23:17,679 --> 00:23:20,880
interesting name for a honeypot

502
00:23:20,880 --> 00:23:24,480
so uh this one has

503
00:23:24,480 --> 00:23:28,799
one additional functionality

504
00:23:28,799 --> 00:23:32,480
and let's see where's my

505
00:23:32,480 --> 00:23:37,840
editor or ftp so i can

506
00:23:38,080 --> 00:23:41,360
so this so i need to go to this site to

507
00:23:41,360 --> 00:23:45,918
change one key which i

508
00:23:46,240 --> 00:23:51,840
hadn't changed before

509
00:23:52,159 --> 00:23:55,679
and so

510
00:23:55,679 --> 00:23:58,400
the code itself looks like that and i

511
00:23:58,400 --> 00:23:59,279
have here

512
00:23:59,279 --> 00:24:02,799
the ah okay i have already allowed the

513
00:24:02,799 --> 00:24:06,240
download possibility so with this

514
00:24:06,240 --> 00:24:09,279
tool again this is

515
00:24:09,279 --> 00:24:11,919
something which is meant for using for

516
00:24:11,919 --> 00:24:12,799
let's say

517
00:24:12,799 --> 00:24:17,520
analyzing a website so

518
00:24:17,760 --> 00:24:20,799
if you so it is basically a

519
00:24:20,799 --> 00:24:23,840
dangerous tool meaning that if you

520
00:24:23,840 --> 00:24:27,120
forget it on a server then it is

521
00:24:27,120 --> 00:24:27,919
possible that

522
00:24:27,919 --> 00:24:30,559
somebody who knows that you have named

523
00:24:30,559 --> 00:24:30,960
it

524
00:24:30,960 --> 00:24:34,640
timer 2 can access that

525
00:24:34,640 --> 00:24:38,400
and access your files and as i'm going

526
00:24:38,400 --> 00:24:38,880
to show

527
00:24:38,880 --> 00:24:40,480
also the possibility to download the

528
00:24:40,480 --> 00:24:42,960
files it's possible they

529
00:24:42,960 --> 00:24:45,600
can access whatever files are on the

530
00:24:45,600 --> 00:24:47,840
server

531
00:24:48,080 --> 00:24:51,840
having said that it does have couple of

532
00:24:51,840 --> 00:24:55,360
safeties first one

533
00:24:55,360 --> 00:25:00,080
is that it must not be named

534
00:25:00,080 --> 00:25:03,279
c timer if it is then it will be

535
00:25:03,279 --> 00:25:04,480
renaming

536
00:25:04,480 --> 00:25:06,880
itself right now herself himself

537
00:25:06,880 --> 00:25:09,039
themself

538
00:25:09,039 --> 00:25:12,960
by adding a random hash and also it must

539
00:25:12,960 --> 00:25:13,440
not

540
00:25:13,440 --> 00:25:17,039
have been on server more than i think uh

541
00:25:17,039 --> 00:25:20,400
there is somewhere 22 times something i

542
00:25:20,400 --> 00:25:21,200
think for

543
00:25:21,200 --> 00:25:23,200
one day or something like that then it

544
00:25:23,200 --> 00:25:25,520
will delete if if accessed

545
00:25:25,520 --> 00:25:27,520
so there are a couple of uh safeties

546
00:25:27,520 --> 00:25:28,720
other than that it

547
00:25:28,720 --> 00:25:32,480
is a tool that can be misused

548
00:25:32,480 --> 00:25:36,400
so now the question to workshop

549
00:25:36,400 --> 00:25:40,640
attendance is that

550
00:25:40,640 --> 00:25:43,600
what do you think has happened on this

551
00:25:43,600 --> 00:25:44,720
site

552
00:25:44,720 --> 00:25:49,520
and what are the problems you can

553
00:25:49,520 --> 00:25:52,799
see so you can access that at wuhan dot

554
00:25:52,799 --> 00:25:54,240
e

555
00:25:54,240 --> 00:25:57,279
c timer 2 dot

556
00:25:57,279 --> 00:26:00,320
and you can

557
00:26:00,799 --> 00:26:03,520
click around it's possible to see

558
00:26:03,520 --> 00:26:04,799
different

559
00:26:04,799 --> 00:26:09,279
packs of files changed

560
00:26:09,279 --> 00:26:12,880
and it's possible also to download these

561
00:26:12,880 --> 00:26:16,240
files so you can

562
00:26:16,240 --> 00:26:20,640
we can for example

563
00:26:20,640 --> 00:26:23,279
see okay there there is for example

564
00:26:23,279 --> 00:26:24,799
there is an interesting file called

565
00:26:24,799 --> 00:26:26,559
goodness overload

566
00:26:26,559 --> 00:26:30,640
overlord uh which

567
00:26:30,640 --> 00:26:33,679
possibly seems interesting okay wso is

568
00:26:33,679 --> 00:26:34,640
also name of

569
00:26:34,640 --> 00:26:38,240
a web shell so that's also something too

570
00:26:38,240 --> 00:26:41,760
possible to look so if you uh

571
00:26:41,760 --> 00:26:44,400
find here things that are interesting

572
00:26:44,400 --> 00:26:46,320
it's possible to

573
00:26:46,320 --> 00:26:51,200
download them and let's see if it

574
00:26:51,200 --> 00:26:54,470
worked nicely so

575
00:26:54,470 --> 00:26:55,679
[Music]

576
00:26:55,679 --> 00:26:57,390
i do have here

577
00:26:57,390 --> 00:26:59,360
[Music]

578
00:26:59,360 --> 00:27:02,400
this zip file

579
00:27:02,400 --> 00:27:05,760
which very nicely contains

580
00:27:05,760 --> 00:27:10,320
all of the components from a particular

581
00:27:10,320 --> 00:27:14,240
website i'm adding to them

582
00:27:14,240 --> 00:27:17,039
always the

583
00:27:17,440 --> 00:27:20,240
hash this is the hash of this particular

584
00:27:20,240 --> 00:27:21,360
file

585
00:27:21,360 --> 00:27:23,440
why why i'm doing that because often

586
00:27:23,440 --> 00:27:24,720
let's say the

587
00:27:24,720 --> 00:27:27,919
compromised index.php may be in various

588
00:27:27,919 --> 00:27:29,200
folders

589
00:27:29,200 --> 00:27:34,159
so then if it's the same index.php

590
00:27:34,159 --> 00:27:36,240
which is compromised it will be having

591
00:27:36,240 --> 00:27:37,679
the same hash

592
00:27:37,679 --> 00:27:40,480
and nicely in the same flat directory

593
00:27:40,480 --> 00:27:41,520
tree

594
00:27:41,520 --> 00:27:43,920
if it's uh

595
00:27:43,920 --> 00:27:46,840
[Music]

596
00:27:46,840 --> 00:27:48,559
uh

597
00:27:48,559 --> 00:27:51,279
different index each of them will have

598
00:27:51,279 --> 00:27:52,480
different hash and it's

599
00:27:52,480 --> 00:27:57,200
again and there's also the

600
00:27:58,080 --> 00:28:02,240
path list so there is possibility to

601
00:28:02,240 --> 00:28:07,039
check where the files came from so

602
00:28:07,520 --> 00:28:10,559
has anybody opened the cuteness

603
00:28:10,559 --> 00:28:15,520
overlord already and

604
00:28:15,520 --> 00:28:18,159
i think this should be cuteness or

605
00:28:18,159 --> 00:28:20,880
probably was the index yes

606
00:28:20,880 --> 00:28:24,720
so it's a very cool shell

607
00:28:25,600 --> 00:28:31,600
that looks like that

608
00:28:31,600 --> 00:28:35,919
so there is a uh

609
00:28:35,919 --> 00:28:38,960
what's the name of language i think it's

610
00:28:38,960 --> 00:28:39,360
uh

611
00:28:39,360 --> 00:28:43,440
called brain or something like that

612
00:28:43,440 --> 00:28:47,279
which is making a completely unreadable

613
00:28:47,279 --> 00:28:50,480
code out of different

614
00:28:50,480 --> 00:28:55,120
parentheses and marks and

615
00:28:55,120 --> 00:28:58,399
this is derivative of that

616
00:28:58,399 --> 00:29:01,600
in php and if i

617
00:29:01,600 --> 00:29:05,440
recall correctly i think it will be

618
00:29:05,440 --> 00:29:08,640
using the parameter of underscore

619
00:29:08,640 --> 00:29:11,760
from accessing it

620
00:29:11,760 --> 00:29:15,120
to actually uh provide

621
00:29:15,120 --> 00:29:18,080
uh shell access so this is one thing i

622
00:29:18,080 --> 00:29:19,120
told that

623
00:29:19,120 --> 00:29:22,159
uh please if you see now there is a

624
00:29:22,159 --> 00:29:24,559
shell do not use that to

625
00:29:24,559 --> 00:29:27,760
do something bad to the server

626
00:29:27,760 --> 00:29:31,919
so we can continue using that

627
00:29:32,320 --> 00:29:35,600
so this is a

628
00:29:36,080 --> 00:29:40,640
an example of the files that can be

629
00:29:40,640 --> 00:29:44,159
retrieved this way

630
00:29:44,399 --> 00:29:47,840
so uh and then this is actually

631
00:29:47,840 --> 00:29:50,960
what we often doing

632
00:29:50,960 --> 00:29:55,760
so but what else has happened here

633
00:29:55,760 --> 00:29:59,440
how to find out

634
00:29:59,440 --> 00:30:03,279
we can see that

635
00:30:03,440 --> 00:30:06,480
there are some file changes and if we

636
00:30:06,480 --> 00:30:07,440
probably

637
00:30:07,440 --> 00:30:10,240
download these files we'll also find uh

638
00:30:10,240 --> 00:30:10,640
that

639
00:30:10,640 --> 00:30:16,000
there are some kind of uh attached

640
00:30:16,320 --> 00:30:20,080
they contain some form of uh malware

641
00:30:20,080 --> 00:30:23,840
but uh

642
00:30:27,120 --> 00:30:29,600
but i'm and i'm also checking the

643
00:30:29,600 --> 00:30:31,200
workshop questions in my

644
00:30:31,200 --> 00:30:33,360
workshop chat if anybody wants to

645
00:30:33,360 --> 00:30:34,799
comment or

646
00:30:34,799 --> 00:30:37,840
ask then

647
00:30:38,240 --> 00:30:41,120
feel free to ask there so when i'm

648
00:30:41,120 --> 00:30:41,919
looking to

649
00:30:41,919 --> 00:30:45,039
my left then i'm probably looking at at

650
00:30:45,039 --> 00:30:48,399
the either of the chats

651
00:30:48,840 --> 00:30:51,360
so how to find out

652
00:30:51,360 --> 00:30:54,960
uh what happened here and possibly

653
00:30:54,960 --> 00:30:57,080
i i see a pattern of changing

654
00:30:57,080 --> 00:30:58,880
functions.php files

655
00:30:58,880 --> 00:31:02,159
so i think these

656
00:31:02,159 --> 00:31:04,799
things are actually also connected

657
00:31:04,799 --> 00:31:05,840
something has

658
00:31:05,840 --> 00:31:08,480
happened there

659
00:31:09,120 --> 00:31:12,480
now to go on with that uh let's

660
00:31:12,480 --> 00:31:15,919
uh and especially now that we know the

661
00:31:15,919 --> 00:31:19,440
time because often for me

662
00:31:19,440 --> 00:31:21,840
the main question with log files has

663
00:31:21,840 --> 00:31:23,039
been

664
00:31:23,039 --> 00:31:27,360
how to how to find

665
00:31:27,360 --> 00:31:29,519
the actual time when to look for

666
00:31:29,519 --> 00:31:30,720
something in the log file

667
00:31:30,720 --> 00:31:35,440
because with these sample files we have

668
00:31:35,440 --> 00:31:38,880
everything is easy because they're

669
00:31:38,880 --> 00:31:39,679
pretty small

670
00:31:39,679 --> 00:31:42,720
but real log files can be gigabytes and

671
00:31:42,720 --> 00:31:44,000
actually without

672
00:31:44,000 --> 00:31:46,320
zooming in into particular time moment

673
00:31:46,320 --> 00:31:48,399
it may be very difficult to

674
00:31:48,399 --> 00:31:51,360
find also because a lot of traffic is

675
00:31:51,360 --> 00:31:53,279
actually different kind of actors trying

676
00:31:53,279 --> 00:31:54,960
to

677
00:31:54,960 --> 00:31:58,000
get into the website so what is the

678
00:31:58,000 --> 00:31:59,840
actual attack and what is just something

679
00:31:59,840 --> 00:32:01,279
that looks attack

680
00:32:01,279 --> 00:32:04,480
is a difficult question

681
00:32:04,480 --> 00:32:08,399
but difficult to discern but here

682
00:32:08,399 --> 00:32:11,760
is my friend spectix

683
00:32:11,760 --> 00:32:15,919
now i'm using the pre-installed

684
00:32:15,919 --> 00:32:18,799
version on server that's running the

685
00:32:18,799 --> 00:32:21,600
server instance actually with your

686
00:32:21,600 --> 00:32:23,840
if anybody gets the private key you can

687
00:32:23,840 --> 00:32:25,679
also run it on the

688
00:32:25,679 --> 00:32:28,720
server side it's running on port 8000

689
00:32:28,720 --> 00:32:29,679
something

690
00:32:29,679 --> 00:32:33,519
i've just put apache in front of that to

691
00:32:33,519 --> 00:32:34,880
do the tls

692
00:32:34,880 --> 00:32:39,039
termination and and

693
00:32:39,919 --> 00:32:43,840
serve on port 443

694
00:32:43,919 --> 00:32:47,840
oh and if you want to

695
00:32:47,840 --> 00:32:50,200
try the thing on your own instance then

696
00:32:50,200 --> 00:32:52,559
[Music]

697
00:32:52,559 --> 00:32:56,080
the files that are

698
00:32:56,080 --> 00:32:58,720
the one which ones which are on the

699
00:32:58,720 --> 00:33:00,480
shared

700
00:33:00,480 --> 00:33:04,240
server are the one are also available

701
00:33:04,240 --> 00:33:04,799
here

702
00:33:04,799 --> 00:33:08,159
so here is the folder called

703
00:33:08,159 --> 00:33:12,000
logs which you can just download and

704
00:33:12,000 --> 00:33:15,760
unzip somewhere perhaps on your desktop

705
00:33:15,760 --> 00:33:20,240
and there is the labs which

706
00:33:20,240 --> 00:33:22,799
if you have your own spectix instance

707
00:33:22,799 --> 00:33:24,799
you can go into the shield folder

708
00:33:24,799 --> 00:33:27,600
and upload the zip it will unpack

709
00:33:27,600 --> 00:33:28,399
everything

710
00:33:28,399 --> 00:33:30,480
presumably at least it didn't in on my

711
00:33:30,480 --> 00:33:31,679
case

712
00:33:31,679 --> 00:33:34,880
on the same things that

713
00:33:34,880 --> 00:33:36,840
we are going to see on the shared

714
00:33:36,840 --> 00:33:38,480
version

715
00:33:38,480 --> 00:33:42,080
here also when you are doing your

716
00:33:42,080 --> 00:33:45,120
own on your own instance trying

717
00:33:45,120 --> 00:33:48,399
then in data stores it's possible to

718
00:33:48,399 --> 00:33:51,600
oh okay i can't i'm logged in as

719
00:33:51,600 --> 00:33:54,720
homeless hummingbird so i can't change

720
00:33:54,720 --> 00:33:55,440
that

721
00:33:55,440 --> 00:33:59,679
but i can probably add a data store to

722
00:33:59,679 --> 00:34:04,240
my own user so we could name it

723
00:34:04,240 --> 00:34:07,840
use file store names is for example

724
00:34:07,840 --> 00:34:12,399
spectix okay perspectives i think

725
00:34:12,399 --> 00:34:15,599
okay i think i

726
00:34:15,599 --> 00:34:19,040
i have in okay it works even here

727
00:34:19,040 --> 00:34:22,399
i have made in the

728
00:34:26,000 --> 00:34:28,879
aha juices telling that bin security

729
00:34:28,879 --> 00:34:30,639
real-time protection off

730
00:34:30,639 --> 00:34:35,839
for wuhan samples

731
00:34:36,000 --> 00:34:38,440
okay this was the one which you

732
00:34:38,440 --> 00:34:40,879
downloaded

733
00:34:40,879 --> 00:34:44,239
from website and yes indeed

734
00:34:44,239 --> 00:34:47,520
it does have php malware

735
00:34:47,520 --> 00:34:51,520
so the fact that your antivirus virus

736
00:34:51,520 --> 00:34:54,079
detected inside the zip file

737
00:34:54,079 --> 00:34:56,159
this information this is completely

738
00:34:56,159 --> 00:34:57,200
correct

739
00:34:57,200 --> 00:34:58,880
this is something which makes it pretty

740
00:34:58,880 --> 00:35:00,400
difficult to

741
00:35:00,400 --> 00:35:04,000
deal with php malware and have

742
00:35:04,000 --> 00:35:07,520
antivirus active because half of my

743
00:35:07,520 --> 00:35:09,599
samples would be probably lost by that

744
00:35:09,599 --> 00:35:11,040
time but anyway

745
00:35:11,040 --> 00:35:13,599
i'm creating a file store it is possible

746
00:35:13,599 --> 00:35:15,760
to access the files just also

747
00:35:15,760 --> 00:35:18,560
directly but all of the samples are

748
00:35:18,560 --> 00:35:20,880
presuming i'm using the store name

749
00:35:20,880 --> 00:35:24,320
name spectix and here you can point

750
00:35:24,320 --> 00:35:27,440
to uh oh interesting way

751
00:35:27,440 --> 00:35:31,440
can't okay currently as a user for some

752
00:35:31,440 --> 00:35:32,400
reason i'm not

753
00:35:32,400 --> 00:35:35,599
allowed but you sh

754
00:35:35,599 --> 00:35:37,680
but on your own instance you have a

755
00:35:37,680 --> 00:35:39,200
folder icon so you can

756
00:35:39,200 --> 00:35:43,200
point to where was the file that you

757
00:35:43,200 --> 00:35:46,480
download it uh from uh these uh

758
00:35:46,480 --> 00:35:51,440
these uh files um

759
00:35:51,440 --> 00:35:55,040
now about uh spectix uh why i

760
00:35:55,040 --> 00:35:59,599
like it i like it for a couple of

761
00:35:59,599 --> 00:36:00,640
reasons

762
00:36:00,640 --> 00:36:03,680
first it works very nicely

763
00:36:03,680 --> 00:36:06,880
with all of the compressed

764
00:36:06,880 --> 00:36:10,480
log archives meaning that

765
00:36:10,480 --> 00:36:12,720
especially in cases when i'm dealing

766
00:36:12,720 --> 00:36:15,359
with mostly with

767
00:36:15,359 --> 00:36:19,598
let's say such a incident response

768
00:36:19,760 --> 00:36:23,599
i don't need to have these things

769
00:36:23,599 --> 00:36:26,640
online in something like in in

770
00:36:26,640 --> 00:36:29,520
expensive unpacked format i can have

771
00:36:29,520 --> 00:36:30,800
just everything in

772
00:36:30,800 --> 00:36:34,720
zip files and and then see how it

773
00:36:34,720 --> 00:36:38,320
goes on from there i can show you the

774
00:36:38,320 --> 00:36:42,960
log files folder this is what you are

775
00:36:42,960 --> 00:36:46,160
getting if you download so or and we

776
00:36:46,160 --> 00:36:48,240
have the same things on the server side

777
00:36:48,240 --> 00:36:49,280
so

778
00:36:49,280 --> 00:36:53,760
some files are open log files

779
00:36:53,760 --> 00:36:57,920
some files are zipped

780
00:36:57,920 --> 00:37:02,000
like here's a bunch of remote security

781
00:37:02,000 --> 00:37:05,760
audit logs so

782
00:37:06,640 --> 00:37:08,720
it doesn't matter if they are compressed

783
00:37:08,720 --> 00:37:10,480
or not perhaps i

784
00:37:10,480 --> 00:37:12,320
i should have compressed them also for a

785
00:37:12,320 --> 00:37:13,520
demo but

786
00:37:13,520 --> 00:37:17,680
i forgot also most of the the error log

787
00:37:17,680 --> 00:37:18,880
files

788
00:37:18,880 --> 00:37:23,119
are raw like they came from my servers

789
00:37:23,119 --> 00:37:25,760
the access log files that might contain

790
00:37:25,760 --> 00:37:27,040
people's

791
00:37:27,040 --> 00:37:31,280
actual ip addresses have been anonymized

792
00:37:31,280 --> 00:37:34,640
by shifting the iprs by some random

793
00:37:34,640 --> 00:37:36,000
number i think the only exception

794
00:37:36,000 --> 00:37:38,480
is my own ip address which i replaced

795
00:37:38,480 --> 00:37:39,839
back

796
00:37:39,839 --> 00:37:42,960
so we can tell that we are not uh

797
00:37:42,960 --> 00:37:46,079
sharing private potentially private data

798
00:37:46,079 --> 00:37:47,599
like ip addresses

799
00:37:47,599 --> 00:37:51,520
with timestamps so this is the

800
00:37:51,520 --> 00:37:55,359
structure of the log files and

801
00:37:55,359 --> 00:37:57,920
usually they're of course much larger

802
00:37:57,920 --> 00:37:59,119
than here

803
00:37:59,119 --> 00:38:02,320
and here under shared

804
00:38:02,320 --> 00:38:06,320
i have prepared

805
00:38:06,320 --> 00:38:09,520
some lab exercises to

806
00:38:09,520 --> 00:38:12,320
try through and understand how the

807
00:38:12,320 --> 00:38:13,839
spectics is

808
00:38:13,839 --> 00:38:17,359
working perhaps

809
00:38:17,359 --> 00:38:19,920
i put the summary as zero but let's

810
00:38:19,920 --> 00:38:22,240
start from the one which is

811
00:38:22,240 --> 00:38:25,680
lab one

812
00:38:26,160 --> 00:38:29,760
uh again i presume it should very nicely

813
00:38:29,760 --> 00:38:31,040
work

814
00:38:31,040 --> 00:38:34,320
with several users

815
00:38:34,320 --> 00:38:37,520
trying to use it at the

816
00:38:37,520 --> 00:38:42,000
same time so

817
00:38:43,599 --> 00:38:46,480
so yeah i see some people have taken

818
00:38:46,480 --> 00:38:47,119
their

819
00:38:47,119 --> 00:38:50,000
accounts so there must be somebody else

820
00:38:50,000 --> 00:38:51,599
also on the

821
00:38:51,599 --> 00:38:55,040
on the spectics here

822
00:38:56,880 --> 00:39:00,160
what's spectix is doing is it's

823
00:39:00,160 --> 00:39:03,440
parsing the log files so for that

824
00:39:03,440 --> 00:39:07,839
i have prepared some patterns

825
00:39:07,839 --> 00:39:11,280
this is because sometimes servers tend

826
00:39:11,280 --> 00:39:13,359
to have a slightly

827
00:39:13,359 --> 00:39:15,520
varying log file formats for example

828
00:39:15,520 --> 00:39:19,680
date or apaches access file can have

829
00:39:19,680 --> 00:39:22,480
different custom parameters that might

830
00:39:22,480 --> 00:39:23,760
be interesting for

831
00:39:23,760 --> 00:39:26,880
somebody so for that reason i have

832
00:39:26,880 --> 00:39:30,800
here under shared patterns i have

833
00:39:30,800 --> 00:39:34,160
some of more common and less common

834
00:39:34,160 --> 00:39:37,119
files how i usually start working with a

835
00:39:37,119 --> 00:39:38,240
log file

836
00:39:38,240 --> 00:39:42,240
is i start with we can start with input

837
00:39:42,240 --> 00:39:42,800
data

838
00:39:42,800 --> 00:39:46,079
i can find the spectics i can find from

839
00:39:46,079 --> 00:39:46,480
here

840
00:39:46,480 --> 00:39:49,920
the uh

841
00:39:50,400 --> 00:39:53,280
what's the spectix data store there is

842
00:39:53,280 --> 00:39:55,119
for example technocrat there is

843
00:39:55,119 --> 00:39:57,680
access log technocrat has been my own

844
00:39:57,680 --> 00:39:58,320
brand for

845
00:39:58,320 --> 00:40:02,000
years so i i found an access log

846
00:40:02,000 --> 00:40:06,000
i can prepare here a pattern and

847
00:40:06,000 --> 00:40:08,079
apparently it does have some idea it

848
00:40:08,079 --> 00:40:09,760
looks like apache

849
00:40:09,760 --> 00:40:13,760
access log it actually is catching the

850
00:40:13,760 --> 00:40:17,200
wrong access lock but we can see that it

851
00:40:17,200 --> 00:40:19,440
found the pattern from here and we

852
00:40:19,440 --> 00:40:20,720
already get

853
00:40:20,720 --> 00:40:24,000
some kind of result from that

854
00:40:24,000 --> 00:40:27,040
now that we have the

855
00:40:27,040 --> 00:40:29,760
pattern ready we can actually use the

856
00:40:29,760 --> 00:40:30,319
pattern

857
00:40:30,319 --> 00:40:34,400
and go into preparing a query with that

858
00:40:34,400 --> 00:40:38,400
so we can took the save say max logs

859
00:40:38,400 --> 00:40:42,640
and check how it works

860
00:40:42,640 --> 00:40:45,599
i'm not going to stop on that part for

861
00:40:45,599 --> 00:40:47,359
longer because that's why i

862
00:40:47,359 --> 00:40:50,800
prepared these lab tasks

863
00:40:50,800 --> 00:40:55,359
so in our case uh it starts very simple

864
00:40:55,359 --> 00:40:57,920
the stream is something that starts with

865
00:40:57,920 --> 00:40:59,599
the add sign

866
00:40:59,599 --> 00:41:02,560
so i'm telling that the stream is

867
00:41:02,560 --> 00:41:04,640
parsing using this pattern that i showed

868
00:41:04,640 --> 00:41:05,280
you

869
00:41:05,280 --> 00:41:08,319
the files from democrats

870
00:41:08,319 --> 00:41:10,960
access log this is actually my own blogs

871
00:41:10,960 --> 00:41:11,599
and some

872
00:41:11,599 --> 00:41:14,319
a couple of other sites access log for

873
00:41:14,319 --> 00:41:14,800
past

874
00:41:14,800 --> 00:41:18,720
i think four or five days

875
00:41:18,720 --> 00:41:22,319
and having this defined uh source

876
00:41:22,319 --> 00:41:24,880
we could

877
00:41:25,839 --> 00:41:30,160
of course just without that but

878
00:41:30,240 --> 00:41:33,040
i'm using this pattern for uh next

879
00:41:33,040 --> 00:41:34,480
example as well

880
00:41:34,480 --> 00:41:37,680
so we have defined the the

881
00:41:37,680 --> 00:41:40,160
stream coming from the log file parsed

882
00:41:40,160 --> 00:41:41,040
and

883
00:41:41,040 --> 00:41:43,440
then i'm going to do some things with uh

884
00:41:43,440 --> 00:41:45,040
that

885
00:41:45,040 --> 00:41:48,720
i'm usually liking to sort it by its

886
00:41:48,720 --> 00:41:49,520
timestamp

887
00:41:49,520 --> 00:41:52,720
because uh at this time when i have

888
00:41:52,720 --> 00:41:53,520
single log

889
00:41:53,520 --> 00:41:56,079
but often i have multiple separate logs

890
00:41:56,079 --> 00:41:57,760
for http

891
00:41:57,760 --> 00:42:00,800
and https connections so they might not

892
00:42:00,800 --> 00:42:03,359
be reading in

893
00:42:03,359 --> 00:42:06,960
correct time order so i'm doing a short

894
00:42:06,960 --> 00:42:07,920
timestamp

895
00:42:07,920 --> 00:42:11,440
and basically i can

896
00:42:11,440 --> 00:42:14,160
add here

897
00:42:14,640 --> 00:42:17,520
select and use all of the fields but by

898
00:42:17,520 --> 00:42:19,119
default it will be also

899
00:42:19,119 --> 00:42:21,359
selecting everything that's coming from

900
00:42:21,359 --> 00:42:23,280
the stream

901
00:42:23,280 --> 00:42:27,040
so this is now my webs

902
00:42:27,040 --> 00:42:30,160
access log in nicely human readable

903
00:42:30,160 --> 00:42:34,079
uh format

904
00:42:34,079 --> 00:42:37,280
um you can basically if you want

905
00:42:37,280 --> 00:42:40,400
you can export that as uh

906
00:42:40,400 --> 00:42:43,440
csv and i don't know look at it

907
00:42:43,440 --> 00:42:47,680
in excel there are occasions when i'm

908
00:42:47,680 --> 00:42:50,800
sharing this log files exactly as

909
00:42:50,800 --> 00:42:53,520
csv or extra files to make some kind of

910
00:42:53,520 --> 00:42:54,960
selections of logo files

911
00:42:54,960 --> 00:42:58,560
easier to follow

912
00:42:58,560 --> 00:43:01,680
but yes this is basically the

913
00:43:01,680 --> 00:43:05,520
simple view we have host ip addresses

914
00:43:05,520 --> 00:43:09,200
and all of the parts of the log file

915
00:43:09,200 --> 00:43:12,480
nicely broken apart

916
00:43:12,480 --> 00:43:18,800
i in our log files we have something

917
00:43:18,800 --> 00:43:21,920
a bit more special we have also request

918
00:43:21,920 --> 00:43:24,480
id to

919
00:43:24,480 --> 00:43:27,760
php's fast process managing fpm and we

920
00:43:27,760 --> 00:43:29,359
have a wall time

921
00:43:29,359 --> 00:43:32,800
that request took to run

922
00:43:32,800 --> 00:43:36,000
now why is that cool that's cool because

923
00:43:36,000 --> 00:43:38,480
uh when we're looking at the log file

924
00:43:38,480 --> 00:43:39,119
currently

925
00:43:39,119 --> 00:43:42,319
yes the log file in this case happens to

926
00:43:42,319 --> 00:43:43,760
be a lot of

927
00:43:43,760 --> 00:43:47,119
bots meaning that

928
00:43:47,119 --> 00:43:50,160
most of the requests are actually

929
00:43:50,160 --> 00:43:52,880
running php but there are some that are

930
00:43:52,880 --> 00:43:54,000
not

931
00:43:54,000 --> 00:43:58,560
for example okay

932
00:43:58,560 --> 00:44:01,760
for whatever reason the root for uh i

933
00:44:01,760 --> 00:44:02,960
might be having a

934
00:44:02,960 --> 00:44:06,079
cache there and uh

935
00:44:06,079 --> 00:44:10,160
here is okay here's definitely a

936
00:44:10,160 --> 00:44:13,599
what was the correct pronunciation gif

937
00:44:13,599 --> 00:44:16,000
an image which probably doesn't need any

938
00:44:16,000 --> 00:44:17,599
kind of

939
00:44:17,599 --> 00:44:20,880
handler to process now

940
00:44:20,880 --> 00:44:23,920
why is that important it's important

941
00:44:23,920 --> 00:44:24,640
because

942
00:44:24,640 --> 00:44:28,000
uh when you are looking for

943
00:44:28,000 --> 00:44:29,760
some some kind of bad actors on a

944
00:44:29,760 --> 00:44:32,480
website you probably are not

945
00:44:32,480 --> 00:44:35,200
caring about anything that is fetching

946
00:44:35,200 --> 00:44:36,480
static files

947
00:44:36,480 --> 00:44:38,640
there could be some kind of denial of

948
00:44:38,640 --> 00:44:42,160
service at that tax based on that

949
00:44:42,160 --> 00:44:45,359
but they're not that common so

950
00:44:45,359 --> 00:44:49,200
we could use here something like

951
00:44:49,200 --> 00:44:54,240
filter let's say let's filter out

952
00:44:54,640 --> 00:44:57,839
anything that were uri

953
00:44:57,839 --> 00:45:00,720
contains

954
00:45:01,520 --> 00:45:04,960
dot gif so uh

955
00:45:04,960 --> 00:45:08,079
pretty self-explanatory i hope from the

956
00:45:08,079 --> 00:45:12,079
syntax viewpoint so you can

957
00:45:12,079 --> 00:45:15,280
actually see that now the g

958
00:45:15,280 --> 00:45:19,119
file should be gone from here

959
00:45:19,119 --> 00:45:22,079
there are still some files that are not

960
00:45:22,079 --> 00:45:22,960
running php

961
00:45:22,960 --> 00:45:26,480
so but

962
00:45:26,880 --> 00:45:29,920
i've tried before i learned about

963
00:45:29,920 --> 00:45:33,599
using uh this

964
00:45:33,599 --> 00:45:37,920
php handler running time that

965
00:45:37,920 --> 00:45:42,079
assembling everything that's that's

966
00:45:42,079 --> 00:45:46,480
possibly static as a let's say

967
00:45:46,480 --> 00:45:48,640
regex match or something like that a

968
00:45:48,640 --> 00:45:49,520
filter

969
00:45:49,520 --> 00:45:53,280
is time consuming

970
00:45:53,280 --> 00:45:57,040
it still lives in some things that

971
00:45:58,720 --> 00:46:01,440
perhaps not important for analysis part

972
00:46:01,440 --> 00:46:01,839
but

973
00:46:01,839 --> 00:46:06,240
also i've in real life seen

974
00:46:06,480 --> 00:46:10,319
actors on websites uh assigned to let's

975
00:46:10,319 --> 00:46:13,200
say for two css files

976
00:46:13,200 --> 00:46:17,119
a php handler so they can nicely have

977
00:46:17,119 --> 00:46:20,880
php running from inside the css file

978
00:46:20,880 --> 00:46:24,560
so actually excluding things files by

979
00:46:24,560 --> 00:46:27,200
just extensions is definitely not a good

980
00:46:27,200 --> 00:46:29,359
choice

981
00:46:29,359 --> 00:46:32,720
so much better for me to

982
00:46:32,720 --> 00:46:35,599
do that is considering we have here a

983
00:46:35,599 --> 00:46:36,960
request id and

984
00:46:36,960 --> 00:46:40,640
time which are zero so we can do filter

985
00:46:40,640 --> 00:46:41,680
out

986
00:46:41,680 --> 00:46:45,919
time is null

987
00:46:46,240 --> 00:46:52,000
so this means that so yeah two else

988
00:46:52,240 --> 00:46:54,720
now i should have nicely everything in

989
00:46:54,720 --> 00:46:56,079
my log files that

990
00:46:56,079 --> 00:46:59,119
is coming from

991
00:46:59,119 --> 00:47:03,200
or is running php so possibly could be

992
00:47:03,200 --> 00:47:07,440
a problem that can be

993
00:47:07,440 --> 00:47:10,800
attacked by somebody or he's in the

994
00:47:10,800 --> 00:47:13,920
process of being attacked

995
00:47:14,160 --> 00:47:16,079
should you have any any questions or

996
00:47:16,079 --> 00:47:18,960
want me to stop on something

997
00:47:18,960 --> 00:47:20,670
just mention

998
00:47:20,670 --> 00:47:22,240
[Music]

999
00:47:22,240 --> 00:47:27,040
mention uh on any of the

1000
00:47:27,040 --> 00:47:29,520
discord channels workshop chapter

1001
00:47:29,520 --> 00:47:30,559
workshop questions

1002
00:47:30,559 --> 00:47:34,880
and i hopefully will notice that

1003
00:47:34,880 --> 00:47:38,079
uh so this is a

1004
00:47:38,079 --> 00:47:42,720
simple view of looking at that

1005
00:47:43,680 --> 00:47:47,040
i've also this is now what i'm

1006
00:47:47,040 --> 00:47:50,720
most using myself is

1007
00:47:50,720 --> 00:47:54,119
we can now look at for example the same

1008
00:47:54,119 --> 00:47:56,240
denograt.net

1009
00:47:56,240 --> 00:48:01,119
so and it was access.log i've

1010
00:48:01,119 --> 00:48:04,240
forgotten to prepare that power or save

1011
00:48:04,240 --> 00:48:05,359
that

1012
00:48:05,359 --> 00:48:10,240
and for that i'm usually keeping in my

1013
00:48:10,720 --> 00:48:14,400
sample scripts so when i'm working daily

1014
00:48:14,400 --> 00:48:18,880
i'm usually having these pre-prepared

1015
00:48:18,880 --> 00:48:21,760
templates that i'm using to kind of look

1016
00:48:21,760 --> 00:48:24,640
ad hoc on any kind of log files

1017
00:48:24,640 --> 00:48:28,559
so here i have the

1018
00:48:28,559 --> 00:48:31,599
better view so i i'm already

1019
00:48:31,599 --> 00:48:35,119
excluding everything that's uh

1020
00:48:35,119 --> 00:48:39,520
null or part i'm still keeping in

1021
00:48:39,520 --> 00:48:43,119
everything that has possibly a response

1022
00:48:43,119 --> 00:48:44,559
of

1023
00:48:44,559 --> 00:48:49,119
indicating error to get it uh

1024
00:48:49,119 --> 00:48:50,640
everything that might be interesting for

1025
00:48:50,640 --> 00:48:52,720
me into the output

1026
00:48:52,720 --> 00:48:55,119
so what i'm usually doing is exactly

1027
00:48:55,119 --> 00:48:56,319
like that

1028
00:48:56,319 --> 00:48:59,520
so i do have here a bit uh better

1029
00:48:59,520 --> 00:49:02,640
uh ordered uh

1030
00:49:02,640 --> 00:49:05,760
components starting with the time time

1031
00:49:05,760 --> 00:49:06,240
it

1032
00:49:06,240 --> 00:49:09,359
takes to run

1033
00:49:09,839 --> 00:49:14,319
uri response codes and

1034
00:49:14,319 --> 00:49:18,300
so on so i can start to

1035
00:49:18,300 --> 00:49:19,520
[Music]

1036
00:49:19,520 --> 00:49:22,559
distill the information into or

1037
00:49:22,559 --> 00:49:25,440
exclude the things that are perhaps not

1038
00:49:25,440 --> 00:49:26,720
important

1039
00:49:26,720 --> 00:49:30,000
for example here in this picture i think

1040
00:49:30,000 --> 00:49:32,640
the yandex beyond export coming from the

1041
00:49:32,640 --> 00:49:33,440
yandex is

1042
00:49:33,440 --> 00:49:37,200
a network range

1043
00:49:37,200 --> 00:49:40,640
i believe this is actually yandex

1044
00:49:40,640 --> 00:49:44,079
so i can safely ignore it

1045
00:49:44,079 --> 00:49:46,720
doing such ignores or filtering in or

1046
00:49:46,720 --> 00:49:48,720
filtering out is pretty

1047
00:49:48,720 --> 00:49:51,040
simple so you can just right click on

1048
00:49:51,040 --> 00:49:52,000
that

1049
00:49:52,000 --> 00:49:55,839
and do that you filter contacts or you

1050
00:49:55,839 --> 00:50:00,000
filter out osteoarthritis so

1051
00:50:00,000 --> 00:50:03,119
already be a better picture also

1052
00:50:03,119 --> 00:50:06,319
let's see what's here

1053
00:50:07,200 --> 00:50:10,240
so ah this is better search

1054
00:50:10,240 --> 00:50:15,118
this is uh huawei's i think

1055
00:50:15,680 --> 00:50:18,640
what is google because they can't

1056
00:50:18,640 --> 00:50:20,720
distribute

1057
00:50:20,720 --> 00:50:23,839
google's official apps anymore so they

1058
00:50:23,839 --> 00:50:25,760
have their own

1059
00:50:25,760 --> 00:50:28,319
search engines and everything so i think

1060
00:50:28,319 --> 00:50:29,839
i can probably

1061
00:50:29,839 --> 00:50:32,880
also exclude that

1062
00:50:32,880 --> 00:50:35,839
in fact i have already done most of

1063
00:50:35,839 --> 00:50:37,040
these

1064
00:50:37,040 --> 00:50:40,160
things here so because i often need to

1065
00:50:40,160 --> 00:50:43,119
or i often need to do these things then

1066
00:50:43,119 --> 00:50:44,880
i have already

1067
00:50:44,880 --> 00:50:47,920
prepared and commented out some of the

1068
00:50:47,920 --> 00:50:48,720
parts

1069
00:50:48,720 --> 00:50:52,160
which make it easier to

1070
00:50:52,319 --> 00:50:55,520
and to uh

1071
00:50:55,520 --> 00:50:58,720
interesting white teeth

1072
00:50:58,720 --> 00:51:03,040
and filteries and

1073
00:51:03,040 --> 00:51:07,280
victories and it should be probably

1074
00:51:07,280 --> 00:51:10,079
not matches

1075
00:51:10,800 --> 00:51:14,640
yes now we have gotten rid of these

1076
00:51:14,640 --> 00:51:16,640
these particular addresses and why i'm

1077
00:51:16,640 --> 00:51:18,400
having a

1078
00:51:18,400 --> 00:51:20,240
positive and is probable because

1079
00:51:20,240 --> 00:51:22,000
sometimes the especially this

1080
00:51:22,000 --> 00:51:25,440
huawei cloud has caused large

1081
00:51:25,440 --> 00:51:27,520
server loads so i've been probably

1082
00:51:27,520 --> 00:51:28,880
looking for them

1083
00:51:28,880 --> 00:51:32,720
from different uh perspective

1084
00:51:32,720 --> 00:51:35,920
and now we're starting to see more

1085
00:51:35,920 --> 00:51:37,040
interesting

1086
00:51:37,040 --> 00:51:40,480
access happening also okay we could also

1087
00:51:40,480 --> 00:51:42,319
probably

1088
00:51:42,319 --> 00:51:45,760
i know it's not nice to just exclude

1089
00:51:45,760 --> 00:51:46,880
everything from

1090
00:51:46,880 --> 00:51:50,480
estonia but i don't believe

1091
00:51:50,480 --> 00:51:54,559
there is uh much risk coming from there

1092
00:51:54,559 --> 00:51:57,760
and also i could filter out by our own

1093
00:51:57,760 --> 00:51:59,119
uh

1094
00:51:59,119 --> 00:52:02,480
uh yes name

1095
00:52:02,480 --> 00:52:04,160
so this will be probably the server

1096
00:52:04,160 --> 00:52:06,960
doing the chrome tasks

1097
00:52:06,960 --> 00:52:10,319
against itself again

1098
00:52:10,319 --> 00:52:13,680
and with each of these filterings we are

1099
00:52:13,680 --> 00:52:14,800
starting to

1100
00:52:14,800 --> 00:52:18,480
see better and better picture

1101
00:52:18,480 --> 00:52:23,119
about the activities that are going on

1102
00:52:23,119 --> 00:52:26,559
and as currently we can see that

1103
00:52:26,559 --> 00:52:28,800
a large proportion of the traffic

1104
00:52:28,800 --> 00:52:30,480
hitting my website

1105
00:52:30,480 --> 00:52:34,240
is coming from some guys who are

1106
00:52:34,240 --> 00:52:37,680
looking for for

1107
00:52:37,680 --> 00:52:41,119
ways to compromise the website

1108
00:52:41,119 --> 00:52:44,640
mostly there is the

1109
00:52:44,640 --> 00:52:47,599
vp login and we'll be going we are going

1110
00:52:47,599 --> 00:52:50,240
to see that

1111
00:52:50,400 --> 00:52:53,440
more later and uh here

1112
00:52:53,440 --> 00:52:57,280
i think this is a especially cool

1113
00:52:57,280 --> 00:53:00,720
path so there is the

1114
00:53:00,720 --> 00:53:04,000
scanning of the authors so polaris

1115
00:53:04,000 --> 00:53:04,880
democrat now

1116
00:53:04,880 --> 00:53:08,640
bro this is actually also running on

1117
00:53:08,640 --> 00:53:12,720
uh on another other name so i can

1118
00:53:12,720 --> 00:53:15,280
show you the website it is actually its

1119
00:53:15,280 --> 00:53:16,400
main name is

1120
00:53:16,400 --> 00:53:19,599
polaris yacht story and

1121
00:53:19,599 --> 00:53:22,720
when we go to the author

1122
00:53:22,720 --> 00:53:26,079
the author will be redirected to

1123
00:53:26,079 --> 00:53:29,119
to user named page

1124
00:53:29,119 --> 00:53:32,319
so this is exactly how

1125
00:53:32,319 --> 00:53:35,359
let's see this was the proper window how

1126
00:53:35,359 --> 00:53:39,760
they are enumerating the users

1127
00:53:39,760 --> 00:53:43,280
and having enumerated the users

1128
00:53:43,280 --> 00:53:47,200
within couple of seconds they will

1129
00:53:47,200 --> 00:53:50,480
start trying to login

1130
00:53:50,480 --> 00:53:54,559
as you see the logins are usually

1131
00:53:54,559 --> 00:53:58,400
done in sets of uh

1132
00:53:58,400 --> 00:54:01,520
less than i think three or six

1133
00:54:01,520 --> 00:54:05,040
possibly in some cases they're also

1134
00:54:05,040 --> 00:54:07,040
trying to find when they are getting

1135
00:54:07,040 --> 00:54:08,079
blocked

1136
00:54:08,079 --> 00:54:11,680
but you are also seeing here that

1137
00:54:11,680 --> 00:54:14,800
there there is a

1138
00:54:14,800 --> 00:54:18,559
possibly 3 2 20

1139
00:54:18,559 --> 00:54:21,920
and there is different

1140
00:54:21,920 --> 00:54:26,160
ip different country different

1141
00:54:26,160 --> 00:54:30,240
areas name so uh while it is possible

1142
00:54:30,240 --> 00:54:31,920
they're completely different

1143
00:54:31,920 --> 00:54:35,040
actors we need probably to look at

1144
00:54:35,040 --> 00:54:38,160
longer time frame to understand that

1145
00:54:38,160 --> 00:54:41,599
but what i'm repeatedly seeing that

1146
00:54:41,599 --> 00:54:44,319
all of these login attempts start with

1147
00:54:44,319 --> 00:54:45,839
scanning for authors

1148
00:54:45,839 --> 00:54:49,040
and then doing couple of

1149
00:54:49,040 --> 00:54:52,799
login attempts and then switching ips

1150
00:54:52,799 --> 00:54:55,119
so most of the common solutions like uh

1151
00:54:55,119 --> 00:54:56,720
okay let's block the

1152
00:54:56,720 --> 00:54:58,799
after i know the third earth except

1153
00:54:58,799 --> 00:55:01,440
attempt are clearly not

1154
00:55:01,440 --> 00:55:03,839
working there are some actors that are

1155
00:55:03,839 --> 00:55:05,280
doing a massive

1156
00:55:05,280 --> 00:55:08,640
brute force attempts but they are pretty

1157
00:55:08,640 --> 00:55:09,599
rare i'm

1158
00:55:09,599 --> 00:55:13,280
much more seeing this kind of pattern in

1159
00:55:13,280 --> 00:55:17,520
log files another one

1160
00:55:17,520 --> 00:55:19,839
is that it's taking the logins and then

1161
00:55:19,839 --> 00:55:22,079
it took doing the

1162
00:55:22,079 --> 00:55:26,319
xml rpc which as we'll be seeing later

1163
00:55:26,319 --> 00:55:29,359
is a method of using

1164
00:55:29,359 --> 00:55:32,720
in theory either escaping the

1165
00:55:32,720 --> 00:55:37,119
login logout or using a single call to

1166
00:55:37,119 --> 00:55:37,760
do

1167
00:55:37,760 --> 00:55:41,359
multiple authentications with one

1168
00:55:41,359 --> 00:55:44,720
call and usually

1169
00:55:44,720 --> 00:55:46,400
you are seeing from here interesting

1170
00:55:46,400 --> 00:55:48,480
thing there is also the login

1171
00:55:48,480 --> 00:55:51,599
is taking 69 milliseconds

1172
00:55:51,599 --> 00:55:55,200
and the excel xml rpc call is taking

1173
00:55:55,200 --> 00:55:58,480
145 milliseconds so

1174
00:55:58,480 --> 00:56:01,599
either because of pad implementation in

1175
00:56:01,599 --> 00:56:02,319
wordpress

1176
00:56:02,319 --> 00:56:06,160
or because it had multiple user names to

1177
00:56:06,160 --> 00:56:07,520
test

1178
00:56:07,520 --> 00:56:10,880
it is taking a longer time and also

1179
00:56:10,880 --> 00:56:14,079
we are seeing that compared to vp login

1180
00:56:14,079 --> 00:56:18,799
the excellent rpc is causing on

1181
00:56:18,799 --> 00:56:21,920
larger processor loads on uh

1182
00:56:21,920 --> 00:56:24,880
hosting servers so xmrap rpc is

1183
00:56:24,880 --> 00:56:25,839
something that

1184
00:56:25,839 --> 00:56:30,559
definitely is better locked down

1185
00:56:30,559 --> 00:56:34,079
let's see if we can find from here

1186
00:56:34,079 --> 00:56:37,200
something else uh-huh there is somebody

1187
00:56:37,200 --> 00:56:37,839
looking for

1188
00:56:37,839 --> 00:56:40,640
some kind of db cache again we are

1189
00:56:40,640 --> 00:56:41,119
seeing

1190
00:56:41,119 --> 00:56:44,160
a lot of ip addresses from different uh

1191
00:56:44,160 --> 00:56:49,040
hosting providers so uh

1192
00:56:49,599 --> 00:56:52,400
i'd i've been really thinking about

1193
00:56:52,400 --> 00:56:53,440
disabling

1194
00:56:53,440 --> 00:56:56,480
disabling access to my websites from

1195
00:56:56,480 --> 00:57:00,000
hosting providers network ranges

1196
00:57:00,000 --> 00:57:01,599
there are some exceptions like for

1197
00:57:01,599 --> 00:57:03,680
example if you are into the

1198
00:57:03,680 --> 00:57:05,359
search engine optimization then

1199
00:57:05,359 --> 00:57:07,280
aircrafts and those

1200
00:57:07,280 --> 00:57:09,200
are also using of course hosting

1201
00:57:09,200 --> 00:57:11,280
providers clouds

1202
00:57:11,280 --> 00:57:15,040
but but

1203
00:57:15,040 --> 00:57:18,559
this is not a thing to

1204
00:57:18,559 --> 00:57:22,160
worry if you are not doing

1205
00:57:22,160 --> 00:57:25,200
active seo analysis on your website

1206
00:57:25,200 --> 00:57:27,839
it will be just doing work for somebody

1207
00:57:27,839 --> 00:57:28,640
else's

1208
00:57:28,640 --> 00:57:31,920
seo so let's see if we can see

1209
00:57:31,920 --> 00:57:36,400
something else interesting uh aha i have

1210
00:57:36,400 --> 00:57:38,880
not added here one more thing which i

1211
00:57:38,880 --> 00:57:40,160
wanted to show you later but

1212
00:57:40,160 --> 00:57:43,359
okay i'll

1213
00:57:44,319 --> 00:57:47,440
i'll jump over to

1214
00:57:47,440 --> 00:57:51,119
uh to lab5 which

1215
00:57:51,119 --> 00:57:54,240
has a pretty similar

1216
00:57:54,240 --> 00:57:57,359
selection but so we are

1217
00:57:57,359 --> 00:57:59,920
excluding requests that are not

1218
00:57:59,920 --> 00:58:01,440
interesting

1219
00:58:01,440 --> 00:58:03,440
we could copy here some more from the

1220
00:58:03,440 --> 00:58:04,640
previous lab

1221
00:58:04,640 --> 00:58:08,079
but this one is interesting because

1222
00:58:08,079 --> 00:58:12,720
it's adding to the select to all of the

1223
00:58:12,720 --> 00:58:16,160
columns that we are looking at also

1224
00:58:16,160 --> 00:58:18,559
something called row color which is

1225
00:58:18,559 --> 00:58:20,839
using the case statement

1226
00:58:20,839 --> 00:58:23,680
to see if

1227
00:58:23,680 --> 00:58:27,040
there is a tor ip in news

1228
00:58:27,040 --> 00:58:30,319
how it is doing that is that

1229
00:58:30,319 --> 00:58:34,480
when we previously were using one stream

1230
00:58:34,480 --> 00:58:37,280
which came from our log file then here

1231
00:58:37,280 --> 00:58:38,559
i'm

1232
00:58:38,559 --> 00:58:41,760
defining another another stream

1233
00:58:41,760 --> 00:58:44,960
which is uh using cached version of

1234
00:58:44,960 --> 00:58:48,400
uh tor exit nodes

1235
00:58:48,400 --> 00:58:50,640
which is coming from i think somewhere

1236
00:58:50,640 --> 00:58:52,319
here in the

1237
00:58:52,319 --> 00:58:56,160
utils so we can always uh

1238
00:58:56,160 --> 00:59:00,559
get from here the exit nodes

1239
00:59:00,559 --> 00:59:02,839
but here i think when we scroll we

1240
00:59:02,839 --> 00:59:05,440
should

1241
00:59:05,440 --> 00:59:09,760
soon see also some color oh sorry

1242
00:59:09,760 --> 00:59:13,119
and then there is also the joining

1243
00:59:13,119 --> 00:59:16,240
of the store to current source

1244
00:59:16,240 --> 00:59:19,200
and using the press syntax which is

1245
00:59:19,200 --> 00:59:20,720
pretty comparable to

1246
00:59:20,720 --> 00:59:24,559
uh sql so here we

1247
00:59:24,559 --> 00:59:27,839
have and do we have also something

1248
00:59:27,839 --> 00:59:30,640
coming up with the tour it should be of

1249
00:59:30,640 --> 00:59:30,960
some

1250
00:59:30,960 --> 00:59:34,960
nice color okay

1251
00:59:34,960 --> 00:59:38,079
i can do not the left join but do the

1252
00:59:38,079 --> 00:59:39,440
join then we'll be seeing

1253
00:59:39,440 --> 00:59:42,640
only the eyepiece of tor so

1254
00:59:42,640 --> 00:59:47,760
okay here seems that uh

1255
00:59:47,760 --> 00:59:50,559
in this version there is less okay they

1256
00:59:50,559 --> 00:59:51,119
probably

1257
00:59:51,119 --> 00:59:53,760
clean the log files a bit uh too much

1258
00:59:53,760 --> 00:59:55,599
original file i'm looking for

1259
00:59:55,599 --> 00:59:59,200
no i think it had more

1260
00:59:59,200 --> 01:00:01,119
but anyway we are seeing the similar

1261
01:00:01,119 --> 01:00:03,680
access to the xmr rpc files

1262
01:00:03,680 --> 01:00:06,880
coming from the tor networks so this is

1263
01:00:06,880 --> 01:00:10,640
uh often uh indicator that this is not

1264
01:00:10,640 --> 01:00:16,160
uh legitimate traffic uh hitting us

1265
01:00:16,160 --> 01:00:20,000
looking more at things that are

1266
01:00:20,000 --> 01:00:24,480
targeting us then

1267
01:00:25,760 --> 01:00:28,880
here are some other samples to

1268
01:00:28,880 --> 01:00:33,839
use for example i've been

1269
01:00:33,839 --> 01:00:36,799
thinking that what are actually they

1270
01:00:36,799 --> 01:00:38,640
looking in excess

1271
01:00:38,640 --> 01:00:42,000
in addition to

1272
01:00:42,000 --> 01:00:46,240
looking for locking possibilities

1273
01:00:46,240 --> 01:00:50,240
and compromising via that so i devised a

1274
01:00:50,240 --> 01:00:53,520
pretty simple pattern that

1275
01:00:53,520 --> 01:00:56,960
is taking again my access log

1276
01:00:56,960 --> 01:01:00,480
and it is a

1277
01:01:00,480 --> 01:01:04,319
matching url to some places under

1278
01:01:04,319 --> 01:01:07,599
wordpress that should not

1279
01:01:07,599 --> 01:01:11,680
run usually php because most of the

1280
01:01:11,680 --> 01:01:13,680
wordpress components coming from plugins

1281
01:01:13,680 --> 01:01:16,880
or themes should be running using the

1282
01:01:16,880 --> 01:01:19,599
built-in routing mechanism so i'm

1283
01:01:19,599 --> 01:01:20,319
looking for

1284
01:01:20,319 --> 01:01:23,280
things coming from themes or accessing

1285
01:01:23,280 --> 01:01:24,559
things from themes

1286
01:01:24,559 --> 01:01:28,480
that are not part of conventional

1287
01:01:28,480 --> 01:01:31,920
browsing or looking for strange

1288
01:01:31,920 --> 01:01:35,359
for php files in strange places

1289
01:01:35,359 --> 01:01:38,799
so and in this way

1290
01:01:38,799 --> 01:01:42,079
i'm able to okay and again

1291
01:01:42,079 --> 01:01:45,920
filter out some bots that might be also

1292
01:01:45,920 --> 01:01:50,640
happening into wrong places so let's see

1293
01:01:51,200 --> 01:01:54,480
uh here is traffic that is definitely

1294
01:01:54,480 --> 01:01:56,960
looking very strange

1295
01:01:56,960 --> 01:02:00,079
uh there are some kind of

1296
01:02:00,079 --> 01:02:02,640
uh plugins in which they are trying to

1297
01:02:02,640 --> 01:02:03,680
access the

1298
01:02:03,680 --> 01:02:06,480
index files

1299
01:02:08,240 --> 01:02:12,880
so this might not be exactly yet

1300
01:02:12,880 --> 01:02:15,359
but it might be just enumeration of

1301
01:02:15,359 --> 01:02:18,319
existence of some kind of a

1302
01:02:18,319 --> 01:02:21,760
plugins so uh

1303
01:02:21,760 --> 01:02:24,640
and as you see i i have currently on the

1304
01:02:24,640 --> 01:02:25,440
same server

1305
01:02:25,440 --> 01:02:28,880
a lot of uh sub domains so

1306
01:02:28,880 --> 01:02:31,440
and i'm using this example exactly

1307
01:02:31,440 --> 01:02:32,160
because it

1308
01:02:32,160 --> 01:02:35,440
does have a bit more interesting traffic

1309
01:02:35,440 --> 01:02:35,839
than

1310
01:02:35,839 --> 01:02:38,319
perhaps my own block in a single view

1311
01:02:38,319 --> 01:02:39,200
would

1312
01:02:39,200 --> 01:02:42,640
have so there

1313
01:02:42,640 --> 01:02:46,559
are other things uh-huh

1314
01:02:46,559 --> 01:02:49,520
okay this one is interesting this is uh

1315
01:02:49,520 --> 01:02:50,319
apparently

1316
01:02:50,319 --> 01:02:53,680
a uh part reversal

1317
01:02:53,680 --> 01:02:57,119
or before it's local file inclusion

1318
01:02:57,119 --> 01:03:00,640
kind of attack looking for vp config

1319
01:03:00,640 --> 01:03:03,680
so how do how do they get

1320
01:03:03,680 --> 01:03:08,720
their database credentials to attack

1321
01:03:08,720 --> 01:03:12,839
in another way like was actually the

1322
01:03:12,839 --> 01:03:16,559
example2.com sample that i showed you

1323
01:03:16,559 --> 01:03:17,359
earlier

1324
01:03:17,359 --> 01:03:19,200
this is probably through some kind of

1325
01:03:19,200 --> 01:03:22,559
access of being able to access the

1326
01:03:22,559 --> 01:03:26,559
config files

1327
01:03:26,640 --> 01:03:30,640
and yes probably

1328
01:03:30,640 --> 01:03:34,720
yeah wordpress file manager had a large

1329
01:03:34,720 --> 01:03:38,400
security issue last year

1330
01:03:38,400 --> 01:03:41,599
first september 2020 so they are looking

1331
01:03:41,599 --> 01:03:45,520
for that and

1332
01:03:45,520 --> 01:03:48,960
so on now that we

1333
01:03:48,960 --> 01:03:53,039
actually do know that

1334
01:03:53,039 --> 01:03:56,240
there are scanners looking for more

1335
01:03:56,240 --> 01:03:58,000
research files

1336
01:03:58,000 --> 01:04:01,359
my next question is what else they are

1337
01:04:01,359 --> 01:04:03,200
looking for

1338
01:04:03,200 --> 01:04:06,240
so there is

1339
01:04:06,240 --> 01:04:10,319
another lab which is now

1340
01:04:10,319 --> 01:04:14,160
doing things like it's using the source

1341
01:04:14,160 --> 01:04:16,720
and scanners are from the source this

1342
01:04:16,720 --> 01:04:17,440
selection

1343
01:04:17,440 --> 01:04:21,039
like i showed and it's also doing the

1344
01:04:21,039 --> 01:04:24,079
grouping by ip so we can see

1345
01:04:24,079 --> 01:04:28,720
also here we have here a lot of

1346
01:04:29,839 --> 01:04:32,319
different

1347
01:04:33,680 --> 01:04:36,880
access attempts we can do

1348
01:04:36,880 --> 01:04:40,000
here that we group it by

1349
01:04:40,000 --> 01:04:42,400
ip

1350
01:04:43,119 --> 01:04:45,400
and see what are the

1351
01:04:45,400 --> 01:04:47,359
[Music]

1352
01:04:47,359 --> 01:04:52,400
okay there was this one so

1353
01:04:52,400 --> 01:04:56,079
yes so we have 33 unique

1354
01:04:56,079 --> 01:04:59,839
uh ips so perhaps there is no point in

1355
01:04:59,839 --> 01:05:02,880
selecting the row but we can select like

1356
01:05:02,880 --> 01:05:07,520
we do in the sql select the

1357
01:05:07,760 --> 01:05:11,599
ip count them

1358
01:05:11,599 --> 01:05:14,559
and perhaps also we can take the country

1359
01:05:14,559 --> 01:05:16,480
code of ip

1360
01:05:16,480 --> 01:05:20,839
and last name

1361
01:05:20,839 --> 01:05:23,839
asmay

1362
01:05:24,480 --> 01:05:27,520
of the ip

1363
01:05:27,599 --> 01:05:30,880
so in this way we are seeing that

1364
01:05:30,880 --> 01:05:34,400
we can also group and we can add here

1365
01:05:34,400 --> 01:05:37,440
sorting sorting by

1366
01:05:37,440 --> 01:05:41,039
count the sending

1367
01:05:41,119 --> 01:05:44,480
so we are seeing the ips that

1368
01:05:44,480 --> 01:05:47,760
access these specific

1369
01:05:47,760 --> 01:05:51,599
urls that are definitely not for

1370
01:05:51,599 --> 01:05:54,720
good people to look at so here we are

1371
01:05:54,720 --> 01:05:58,319
doing the basically the same thing that

1372
01:05:58,319 --> 01:06:02,079
i did here we are using generating one

1373
01:06:02,079 --> 01:06:02,640
source

1374
01:06:02,640 --> 01:06:05,760
a stream of scanners and then we are

1375
01:06:05,760 --> 01:06:08,319
joining it

1376
01:06:08,319 --> 01:06:10,000
and then not left training but joining

1377
01:06:10,000 --> 01:06:12,640
to get only the rows that are

1378
01:06:12,640 --> 01:06:16,720
problematic from my

1379
01:06:16,720 --> 01:06:20,240
user set so

1380
01:06:20,240 --> 01:06:24,880
now i have been able to expand my view

1381
01:06:24,880 --> 01:06:28,559
of what the malicious actors are doing

1382
01:06:28,559 --> 01:06:31,680
so we are seeing that they are looking

1383
01:06:31,680 --> 01:06:34,799
so for this social forgotten by somebody

1384
01:06:34,799 --> 01:06:35,839
there

1385
01:06:35,839 --> 01:06:40,799
these are the plug-in things we know uh

1386
01:06:40,799 --> 01:06:45,039
uh indoor exploit i think this is

1387
01:06:45,039 --> 01:06:48,000
some kind of probably indonesian gang uh

1388
01:06:48,000 --> 01:06:48,680
there is

1389
01:06:48,680 --> 01:06:52,079
up.php pretty commonly

1390
01:06:52,079 --> 01:06:55,760
a name for uploading something and some

1391
01:06:55,760 --> 01:06:58,640
and so on so we are seeing uh what are

1392
01:06:58,640 --> 01:07:00,960
the files they're using some of them are

1393
01:07:00,960 --> 01:07:04,000
i think we'll be seeing uh things like

1394
01:07:04,000 --> 01:07:08,240
uh uh-huh not sure what's

1395
01:07:08,240 --> 01:07:10,640
that that's probably mistaking my

1396
01:07:10,640 --> 01:07:11,599
wordpress for

1397
01:07:11,599 --> 01:07:14,799
joomla or something like uh that i think

1398
01:07:14,799 --> 01:07:17,119
bluestork is somebody's theme

1399
01:07:17,119 --> 01:07:21,359
uh looking again for uh

1400
01:07:21,520 --> 01:07:24,640
for forgotten shells for

1401
01:07:24,640 --> 01:07:27,760
uh some people uh like to

1402
01:07:27,760 --> 01:07:30,799
put shells inside for for php

1403
01:07:30,799 --> 01:07:35,520
inside theme folders pretty common thing

1404
01:07:35,520 --> 01:07:36,319
because

1405
01:07:36,319 --> 01:07:39,599
all themes they have been installed but

1406
01:07:39,599 --> 01:07:42,960
they are rarely getting updates

1407
01:07:42,960 --> 01:07:46,559
so a good place for hiding

1408
01:07:46,559 --> 01:07:50,240
and i think when i looked at the file

1409
01:07:50,240 --> 01:07:53,920
earlier now this is probably

1410
01:07:53,920 --> 01:07:57,359
i can just click and see

1411
01:07:57,359 --> 01:08:01,440
it doesn't have any great

1412
01:08:01,440 --> 01:08:04,640
user agent but it d seems to be some

1413
01:08:04,640 --> 01:08:05,440
kind of a

1414
01:08:05,440 --> 01:08:08,960
stupid scanner for whatever reason

1415
01:08:08,960 --> 01:08:12,079
but i want it aha here's a cool uh

1416
01:08:12,079 --> 01:08:14,480
search by the same guys they're looking

1417
01:08:14,480 --> 01:08:16,720
for

1418
01:08:17,439 --> 01:08:21,040
again for sql credentials by

1419
01:08:21,040 --> 01:08:24,560
looking for backup copies of

1420
01:08:24,560 --> 01:08:27,679
config files and let's see

1421
01:08:27,679 --> 01:08:30,880
if they are looking

1422
01:08:31,520 --> 01:08:34,960
okay this now looks like probably some

1423
01:08:34,960 --> 01:08:37,279
kind of somebody's

1424
01:08:37,279 --> 01:08:40,960
door again a list of

1425
01:08:40,960 --> 01:08:44,319
files that they have probably found

1426
01:08:44,319 --> 01:08:47,439
common there is also usually a search

1427
01:08:47,439 --> 01:08:48,560
for

1428
01:08:48,560 --> 01:08:52,080
sql files but uh

1429
01:08:52,080 --> 01:08:55,359
i think that uh this time we are not

1430
01:08:55,359 --> 01:08:57,279
uh seeing things get much more

1431
01:08:57,279 --> 01:08:58,799
interesting when you are

1432
01:08:58,799 --> 01:09:01,600
looking at the log files for uh longer

1433
01:09:01,600 --> 01:09:02,560
time but

1434
01:09:02,560 --> 01:09:06,319
uh for sharing here in the workshop i

1435
01:09:06,319 --> 01:09:09,679
picked a shorter time

1436
01:09:09,679 --> 01:09:11,800
so this is basically how

1437
01:09:11,800 --> 01:09:13,198
[Music]

1438
01:09:13,198 --> 01:09:17,520
you can gain more information from the

1439
01:09:17,520 --> 01:09:22,158
log files by being able to actually

1440
01:09:22,158 --> 01:09:25,759
look at them in nice tabulated

1441
01:09:25,759 --> 01:09:29,040
format not like your usual

1442
01:09:29,040 --> 01:09:34,319
access logs are uh

1443
01:09:34,319 --> 01:09:38,960
single lines and you can't follow the

1444
01:09:38,960 --> 01:09:42,238
parts so uh now

1445
01:09:42,238 --> 01:09:45,279
uh coming back to the part of

1446
01:09:45,279 --> 01:09:48,479
how we started with the question of

1447
01:09:48,479 --> 01:09:52,719
what happened at my

1448
01:09:52,719 --> 01:09:56,480
wuhan sample site

1449
01:09:56,480 --> 01:09:59,840
so we can come back here and

1450
01:09:59,840 --> 01:10:03,840
all of the oh i'll show you one more

1451
01:10:03,840 --> 01:10:04,159
thing

1452
01:10:04,159 --> 01:10:08,480
before i move to the uh

1453
01:10:08,480 --> 01:10:12,320
one is i've here i have here

1454
01:10:12,320 --> 01:10:16,000
a summary which is a different kind

1455
01:10:16,000 --> 01:10:19,520
of accessing the log file so

1456
01:10:19,520 --> 01:10:22,800
instead of just having a the

1457
01:10:22,800 --> 01:10:25,360
list and looking at that i'm doing a

1458
01:10:25,360 --> 01:10:27,759
select

1459
01:10:27,840 --> 01:10:30,000
grouping the information by some period

1460
01:10:30,000 --> 01:10:31,199
because usually

1461
01:10:31,199 --> 01:10:34,320
i'm it's one minute and

1462
01:10:34,320 --> 01:10:37,520
when there are campaigns hitting eshops

1463
01:10:37,520 --> 01:10:41,760
then i'm often doing that by one second

1464
01:10:41,760 --> 01:10:44,960
but this is discreting the time by

1465
01:10:44,960 --> 01:10:47,520
one hour period and i'm getting all of

1466
01:10:47,520 --> 01:10:48,000
these

1467
01:10:48,000 --> 01:10:51,600
counts of different requests for

1468
01:10:51,600 --> 01:10:55,199
one hour

1469
01:10:55,360 --> 01:10:57,679
so what i'm counting i'm counting we're

1470
01:10:57,679 --> 01:10:59,440
calculating the average

1471
01:10:59,440 --> 01:11:02,080
wall time which pretty much shows how

1472
01:11:02,080 --> 01:11:03,760
well the server is performing

1473
01:11:03,760 --> 01:11:05,760
if if the average run time is getting

1474
01:11:05,760 --> 01:11:08,640
over one second then it means that every

1475
01:11:08,640 --> 01:11:10,480
cost is taking one second and when you

1476
01:11:10,480 --> 01:11:11,760
have eight cores you can

1477
01:11:11,760 --> 01:11:14,080
basically have eight requests at the

1478
01:11:14,080 --> 01:11:15,760
same time which probably

1479
01:11:15,760 --> 01:11:17,679
will be a problem if you happen to have

1480
01:11:17,679 --> 01:11:20,080
more than eight requests per second

1481
01:11:20,080 --> 01:11:22,960
uh and also i'm looking for long and

1482
01:11:22,960 --> 01:11:24,000
short

1483
01:11:24,000 --> 01:11:27,679
requests i'm looking for

1484
01:11:27,679 --> 01:11:30,719
access by bots and

1485
01:11:30,719 --> 01:11:33,360
depending on occasions i'm also looking

1486
01:11:33,360 --> 01:11:33,840
at

1487
01:11:33,840 --> 01:11:36,239
different

1488
01:11:36,960 --> 01:11:40,960
different uh

1489
01:11:40,960 --> 01:11:44,640
response codes but usually having error

1490
01:11:44,640 --> 01:11:45,360
is

1491
01:11:45,360 --> 01:11:48,320
good uh enough okay and also there may

1492
01:11:48,320 --> 01:11:48,640
be

1493
01:11:48,640 --> 01:11:52,320
some kind of other reasons to

1494
01:11:52,320 --> 01:11:55,840
to count but let's see what i will see

1495
01:11:55,840 --> 01:11:57,440
from here

1496
01:11:57,440 --> 01:12:00,560
so we have nicely seen that

1497
01:12:00,560 --> 01:12:03,520
there is a

1498
01:12:03,760 --> 01:12:06,239
constant flow with the exception of some

1499
01:12:06,239 --> 01:12:07,360
time

1500
01:12:07,360 --> 01:12:10,560
looking at table to find when there is a

1501
01:12:10,560 --> 01:12:11,280
higher

1502
01:12:11,280 --> 01:12:13,280
than usual access is probably pretty

1503
01:12:13,280 --> 01:12:14,719
difficult

1504
01:12:14,719 --> 01:12:18,400
so that's where i'm using charts

1505
01:12:18,400 --> 01:12:23,360
so from this chart i'm seeing that

1506
01:12:23,360 --> 01:12:26,640
that most of the day is uh

1507
01:12:26,640 --> 01:12:30,239
pretty boring but something has been

1508
01:12:30,239 --> 01:12:35,280
accessing or probably indexing the site

1509
01:12:35,440 --> 01:12:38,560
uh nights especially there is uh around

1510
01:12:38,560 --> 01:12:42,400
uh uh 5

1511
01:12:42,400 --> 01:12:46,560
a.m there is more traffic than

1512
01:12:46,560 --> 01:12:50,080
than usually uh

1513
01:12:50,080 --> 01:12:53,440
so uh we can now go to

1514
01:12:53,440 --> 01:12:56,960
take one of these uh better views

1515
01:12:56,960 --> 01:13:00,320
or i can just use the same

1516
01:13:00,320 --> 01:13:03,120
file location and do like i'm doing when

1517
01:13:03,120 --> 01:13:04,000
i'm

1518
01:13:04,000 --> 01:13:05,760
usually looking at things i'm using the

1519
01:13:05,760 --> 01:13:07,040
detail view

1520
01:13:07,040 --> 01:13:10,400
i'm giving it the same file name i'm

1521
01:13:10,400 --> 01:13:14,400
telling it to look from for today

1522
01:13:14,400 --> 01:13:18,000
oh sorry 05 oh sorry

1523
01:13:18,000 --> 01:13:21,520
from five

1524
01:13:21,520 --> 01:13:25,360
fifteen five in the morning

1525
01:13:25,360 --> 01:13:28,480
for one hour and

1526
01:13:28,480 --> 01:13:31,520
uh let's see what the truck uh-huh

1527
01:13:31,520 --> 01:13:36,239
i need to comment out the filter here so

1528
01:13:36,239 --> 01:13:39,280
now i'm nicely

1529
01:13:39,280 --> 01:13:42,320
in this time frame i hope

1530
01:13:42,320 --> 01:13:46,400
that i did see access and

1531
01:13:46,400 --> 01:13:49,360
aha i'm seeing also a student ips from

1532
01:13:49,360 --> 01:13:50,800
server form

1533
01:13:50,800 --> 01:13:53,679
trying to log in probably not one of the

1534
01:13:53,679 --> 01:13:55,440
real users

1535
01:13:55,440 --> 01:13:58,840
and there is

1536
01:13:58,840 --> 01:14:01,520
uh jensen so

1537
01:14:01,520 --> 01:14:04,640
let's see if we can also see some kind

1538
01:14:04,640 --> 01:14:05,120
of

1539
01:14:05,120 --> 01:14:08,000
i think we should be seeing at this time

1540
01:14:08,000 --> 01:14:09,360
frame

1541
01:14:09,360 --> 01:14:13,440
some form of of

1542
01:14:13,440 --> 01:14:17,600
website scanning that is

1543
01:14:17,600 --> 01:14:21,840
not related to breaking in but

1544
01:14:21,840 --> 01:14:25,040
somehow i'm currently not seeing that

1545
01:14:25,040 --> 01:14:28,719
let's say let's take a let's take

1546
01:14:28,719 --> 01:14:31,920
a one minute test period can we spot

1547
01:14:31,920 --> 01:14:34,640
the actual

1548
01:14:36,159 --> 01:14:40,080
access here so it was

1549
01:14:40,080 --> 01:14:44,880
today and the traffic has been

1550
01:14:44,880 --> 01:14:48,400
higher than normal in these and here's

1551
01:14:48,400 --> 01:14:49,520
also the blue

1552
01:14:49,520 --> 01:14:52,719
is accessing these static files

1553
01:14:52,719 --> 01:14:56,000
so we can see and find out

1554
01:14:56,000 --> 01:14:59,840
when exactly has been the

1555
01:14:59,840 --> 01:15:02,640
scanning of the static files so the

1556
01:15:02,640 --> 01:15:04,480
highest point has been

1557
01:15:04,480 --> 01:15:07,760
35 so let's

1558
01:15:07,760 --> 01:15:12,400
see again we can come here and see at

1559
01:15:12,400 --> 01:15:17,920
let's say 30 for 10 minutes

1560
01:15:18,159 --> 01:15:22,239
and see if we can

1561
01:15:22,239 --> 01:15:25,120
okay and here because it's static files

1562
01:15:25,120 --> 01:15:25,840
then

1563
01:15:25,840 --> 01:15:27,920
we probably must look at all traffic to

1564
01:15:27,920 --> 01:15:31,120
see what's going on here

1565
01:15:32,400 --> 01:15:38,159
and who is scanning come on can we

1566
01:15:38,159 --> 01:15:41,519
uh it's uh

1567
01:15:42,880 --> 01:15:43,750
uh-huh

1568
01:15:43,750 --> 01:15:46,320
[Music]

1569
01:15:46,320 --> 01:15:49,600
yeah okay uh this is doing

1570
01:15:49,600 --> 01:15:53,360
redirect with no time used

1571
01:15:53,360 --> 01:15:57,120
so perhaps what we saw earlier in the

1572
01:15:57,120 --> 01:15:58,239
graph

1573
01:15:58,239 --> 01:16:00,719
is for some reason access takes a xml

1574
01:16:00,719 --> 01:16:03,760
rpc that is doing a redirect somewhere

1575
01:16:03,760 --> 01:16:06,880
so it possibly logged in

1576
01:16:06,880 --> 01:16:10,719
logged as static

1577
01:16:10,719 --> 01:16:14,080
access so contrary to what we

1578
01:16:14,080 --> 01:16:17,280
saw earlier we are also seeing access

1579
01:16:17,280 --> 01:16:19,600
that's coming from the same ip

1580
01:16:19,600 --> 01:16:22,719
and doing a lot of requests so we are

1581
01:16:22,719 --> 01:16:24,400
basically seeing that in the

1582
01:16:24,400 --> 01:16:27,440
same second we have like five

1583
01:16:27,440 --> 01:16:30,800
five requests per second trying to brute

1584
01:16:30,800 --> 01:16:31,520
force

1585
01:16:31,520 --> 01:16:34,800
and even more yeah okay about five per

1586
01:16:34,800 --> 01:16:35,600
second

1587
01:16:35,600 --> 01:16:37,440
trying to brute force into hendra

1588
01:16:37,440 --> 01:16:38,719
kronema's uh

1589
01:16:38,719 --> 01:16:42,560
old block and that is uh

1590
01:16:42,560 --> 01:16:46,000
we we would produce he's a journalist we

1591
01:16:46,000 --> 01:16:48,080
have been producing radio together he's

1592
01:16:48,080 --> 01:16:49,199
currently running

1593
01:16:49,199 --> 01:16:52,719
one of very successful estonian

1594
01:16:52,800 --> 01:16:57,120
also technology and other news sites

1595
01:16:57,120 --> 01:16:59,600
but he's not using the site anymore so

1596
01:16:59,600 --> 01:17:00,320
so

1597
01:17:00,320 --> 01:17:02,880
this is how you can actually zoom in

1598
01:17:02,880 --> 01:17:05,040
into a particular place of

1599
01:17:05,040 --> 01:17:07,920
interest in your log files now coming

1600
01:17:07,920 --> 01:17:10,080
back to the

1601
01:17:10,080 --> 01:17:13,679
wuhan example so

1602
01:17:13,679 --> 01:17:16,800
we are here and we'd like to understand

1603
01:17:16,800 --> 01:17:21,840
what has happened at 24th of

1604
01:17:21,840 --> 01:17:24,940
february which is by the way estonian

1605
01:17:24,940 --> 01:17:28,129
[Music]

1606
01:17:29,040 --> 01:17:30,560
birthday first of all republic of

1607
01:17:30,560 --> 01:17:33,760
estonia uh so

1608
01:17:33,760 --> 01:17:36,480
thinking that uh why on this day i think

1609
01:17:36,480 --> 01:17:38,480
i have been preparing for some kind of a

1610
01:17:38,480 --> 01:17:40,239
presentation then

1611
01:17:40,239 --> 01:17:42,879
using the free

1612
01:17:43,360 --> 01:17:46,800
bank holiday to to do that but

1613
01:17:46,800 --> 01:17:50,480
uh we and and i'm very often

1614
01:17:50,480 --> 01:17:52,800
using exactly in this way that i'm

1615
01:17:52,800 --> 01:17:53,760
coming here

1616
01:17:53,760 --> 01:17:57,199
i'm looking at the change of the

1617
01:17:57,199 --> 01:18:00,239
files and

1618
01:18:00,239 --> 01:18:03,840
based on that deciding at what point

1619
01:18:03,840 --> 01:18:06,800
point of logs i need to look and this is

1620
01:18:06,800 --> 01:18:09,120
especially important because

1621
01:18:09,120 --> 01:18:11,840
this time yes unfortunately this is at

1622
01:18:11,840 --> 01:18:14,320
the beginning of this

1623
01:18:14,320 --> 01:18:17,520
server's lifetime uh often it's

1624
01:18:17,520 --> 01:18:20,640
uh somewhere in the middle but uh

1625
01:18:20,640 --> 01:18:22,960
looking at today's log files you would

1626
01:18:22,960 --> 01:18:24,960
have not

1627
01:18:24,960 --> 01:18:27,120
guess that the actual compromise has

1628
01:18:27,120 --> 01:18:28,960
happened uh

1629
01:18:28,960 --> 01:18:31,199
more than a year ago but looking at

1630
01:18:31,199 --> 01:18:33,840
these file change times grouped

1631
01:18:33,840 --> 01:18:37,280
uh it is uh visible so that something

1632
01:18:37,280 --> 01:18:38,880
has happened here

1633
01:18:38,880 --> 01:18:42,159
now let's come back to the spectic so

1634
01:18:42,159 --> 01:18:43,679
this is the local version

1635
01:18:43,679 --> 01:18:47,199
but we can locate that it

1636
01:18:47,199 --> 01:18:50,560
here which we

1637
01:18:50,560 --> 01:18:53,679
view we should i think we should

1638
01:18:53,679 --> 01:18:56,719
to maybe have a better view and this

1639
01:18:56,719 --> 01:18:58,719
time really use the

1640
01:18:58,719 --> 01:19:02,159
log files from this server i'm looking

1641
01:19:02,159 --> 01:19:05,280
all only on files that are running php

1642
01:19:05,280 --> 01:19:06,080
because

1643
01:19:06,080 --> 01:19:07,840
that's probably the only way to change

1644
01:19:07,840 --> 01:19:09,600
the files there

1645
01:19:09,600 --> 01:19:14,080
and let's see what has happened there

1646
01:19:15,440 --> 01:19:20,239
so okay i

1647
01:19:20,239 --> 01:19:23,600
thought i changed log file but anyway

1648
01:19:23,600 --> 01:19:25,199
there are the delete me it's another

1649
01:19:25,199 --> 01:19:27,199
problem this is actually the

1650
01:19:27,199 --> 01:19:28,480
installatron

1651
01:19:28,480 --> 01:19:32,000
server doing the install so apparently

1652
01:19:32,000 --> 01:19:36,480
somebody's installing the wordpress

1653
01:19:36,480 --> 01:19:40,480
unfortunately at the start of

1654
01:19:40,800 --> 01:19:45,040
this log file so it's too easily visible

1655
01:19:45,040 --> 01:19:47,600
and the file log files were it's not so

1656
01:19:47,600 --> 01:19:48,960
easily visible i use

1657
01:19:48,960 --> 01:19:51,840
unfortunately not that my discretion to

1658
01:19:51,840 --> 01:19:52,560
share

1659
01:19:52,560 --> 01:19:56,000
publicly in this way

1660
01:19:56,000 --> 01:19:59,040
so i'm seeing there is also somewhere

1661
01:19:59,040 --> 01:20:02,719
a login by the way the interesting thing

1662
01:20:02,719 --> 01:20:04,239
about wordpress login

1663
01:20:04,239 --> 01:20:06,719
is that you are not going to find

1664
01:20:06,719 --> 01:20:08,880
successful logins by looking at vapor

1665
01:20:08,880 --> 01:20:09,679
login

1666
01:20:09,679 --> 01:20:13,920
answering with a response code 200.

1667
01:20:13,920 --> 01:20:17,280
the correct way to look at these if

1668
01:20:17,280 --> 01:20:20,880
the response is 302 because

1669
01:20:20,880 --> 01:20:24,400
then the user is being redirected

1670
01:20:24,400 --> 01:20:27,840
to bp admin so

1671
01:20:27,840 --> 01:20:30,480
this is the filter to look at when there

1672
01:20:30,480 --> 01:20:31,520
has been

1673
01:20:31,520 --> 01:20:34,159
an actual login so we are seeing that

1674
01:20:34,159 --> 01:20:34,560
the

1675
01:20:34,560 --> 01:20:38,480
login has been around 1320

1676
01:20:38,480 --> 01:20:41,520
but now i'm interested in all of these

1677
01:20:41,520 --> 01:20:45,199
ips from zone because

1678
01:20:45,199 --> 01:20:49,360
this this one is actually the

1679
01:20:49,360 --> 01:20:51,760
installer turn but let's see if we can

1680
01:20:51,760 --> 01:20:52,719
see the

1681
01:20:52,719 --> 01:20:56,320
exact login point from here also uh

1682
01:20:56,320 --> 01:21:00,639
so there is this uh successful login

1683
01:21:00,639 --> 01:21:02,960
and

1684
01:21:05,040 --> 01:21:08,080
then there is access

1685
01:21:08,080 --> 01:21:12,560
to site named nult

1686
01:21:12,560 --> 01:21:15,840
which accidentally is the site where i

1687
01:21:15,840 --> 01:21:17,280
did install

1688
01:21:17,280 --> 01:21:20,400
uh the nulled

1689
01:21:20,400 --> 01:21:24,400
wordpress theme if you want to

1690
01:21:24,400 --> 01:21:27,760
try this kind of compromise yourself

1691
01:21:27,760 --> 01:21:32,560
then the easiest way to

1692
01:21:32,560 --> 01:21:35,920
cell phone is to go to something called

1693
01:21:35,920 --> 01:21:37,679
let's let's take a

1694
01:21:37,679 --> 01:21:41,280
cognito window go to

1695
01:21:41,280 --> 01:21:44,159
vista themes

1696
01:21:44,719 --> 01:21:48,159
and it's pretty to

1697
01:21:48,159 --> 01:21:51,679
find you can find here wordpress

1698
01:21:51,679 --> 01:21:55,520
themes and plugins so i think in this

1699
01:21:55,520 --> 01:21:56,480
case

1700
01:21:56,480 --> 01:22:00,800
i was using a bakery theme

1701
01:22:00,800 --> 01:22:04,080
for whatever reason it was bakery theme

1702
01:22:04,080 --> 01:22:07,120
if you want to try with this specific

1703
01:22:07,120 --> 01:22:10,560
theme so this is also available

1704
01:22:10,560 --> 01:22:13,920
here uh under the files you can

1705
01:22:13,920 --> 01:22:16,960
if you have a throwaway wordpress later

1706
01:22:16,960 --> 01:22:20,000
you can try uh installing that and

1707
01:22:20,000 --> 01:22:21,679
seeing if you're seeing the similar

1708
01:22:21,679 --> 01:22:24,800
pattern there

1709
01:22:24,800 --> 01:22:27,920
so but we were

1710
01:22:27,920 --> 01:22:32,159
here so we are seeing something which is

1711
01:22:32,159 --> 01:22:32,639
uh

1712
01:22:32,639 --> 01:22:36,480
very common in two different

1713
01:22:36,480 --> 01:22:38,880
scenarios we are seeing somebody logging

1714
01:22:38,880 --> 01:22:39,920
in

1715
01:22:39,920 --> 01:22:43,040
and uh okay this is again something i

1716
01:22:43,040 --> 01:22:45,520
should have removed or actually i did

1717
01:22:45,520 --> 01:22:46,560
remove but uh

1718
01:22:46,560 --> 01:22:50,560
forgot to upload the right file

1719
01:22:50,560 --> 01:22:54,800
so uh there is uh compression tests

1720
01:22:54,800 --> 01:22:58,080
i mean themes and here is the theme

1721
01:22:58,080 --> 01:22:59,679
admin

1722
01:22:59,679 --> 01:23:03,679
so this is the 1442

1723
01:23:03,679 --> 01:23:07,120
when i have uploaded

1724
01:23:07,120 --> 01:23:10,159
this particular

1725
01:23:10,159 --> 01:23:13,360
theme and it has been activated

1726
01:23:13,360 --> 01:23:17,360
now let's see if i also was

1727
01:23:17,360 --> 01:23:20,920
correct in connecting the two timelines

1728
01:23:20,920 --> 01:23:25,320
1443 so

1729
01:23:25,320 --> 01:23:28,400
1443 is

1730
01:23:28,400 --> 01:23:31,520
something that is happening but hey

1731
01:23:31,520 --> 01:23:35,360
this is a different site

1732
01:23:35,360 --> 01:23:38,800
so apparently when i

1733
01:23:38,800 --> 01:23:42,800
did activate the

1734
01:23:42,800 --> 01:23:45,840
theme it also looked for

1735
01:23:45,840 --> 01:23:49,440
other installations on the same server

1736
01:23:49,440 --> 01:23:52,880
so perhaps i can show you how the server

1737
01:23:52,880 --> 01:23:54,560
looks like

1738
01:23:54,560 --> 01:23:59,199
if i open from here the one server

1739
01:24:01,360 --> 01:24:05,600
so that's the server and

1740
01:24:05,600 --> 01:24:09,600
we have here uh there is this

1741
01:24:09,600 --> 01:24:14,719
uh nult

1742
01:24:14,719 --> 01:24:19,520
theme or a site to which i installed the

1743
01:24:19,520 --> 01:24:22,000
backdoor there is a separate phone with

1744
01:24:22,000 --> 01:24:24,320
with more backdoors we'll see later

1745
01:24:24,320 --> 01:24:26,880
and here completely in different

1746
01:24:26,880 --> 01:24:28,840
location

1747
01:24:28,840 --> 01:24:31,840
is

1748
01:24:32,400 --> 01:24:35,679
this safe which has

1749
01:24:35,679 --> 01:24:39,679
also gotten compromised

1750
01:24:39,679 --> 01:24:41,920
because it's it is going a couple of

1751
01:24:41,920 --> 01:24:43,120
levels up and then

1752
01:24:43,120 --> 01:24:45,840
looking for all kinds of functions.php

1753
01:24:45,840 --> 01:24:47,040
and other files and

1754
01:24:47,040 --> 01:24:50,159
wordpress installs and compromising them

1755
01:24:50,159 --> 01:24:53,520
all in a single go

1756
01:24:53,520 --> 01:24:57,360
so i found the compromise of

1757
01:24:57,360 --> 01:25:01,040
that and i think the 1422

1758
01:25:01,040 --> 01:25:03,840
should have been one of the earlier and

1759
01:25:03,840 --> 01:25:05,040
the 13

1760
01:25:05,040 --> 01:25:08,719
20. did i see something with these times

1761
01:25:08,719 --> 01:25:10,960
as well

1762
01:25:10,960 --> 01:25:14,239
yeah it seems that 1320 has been the

1763
01:25:14,239 --> 01:25:17,700
initial uh

1764
01:25:17,700 --> 01:25:19,600
[Music]

1765
01:25:19,600 --> 01:25:23,040
setup so there are things

1766
01:25:23,040 --> 01:25:26,080
the problems currently with this

1767
01:25:26,080 --> 01:25:29,520
this file is this changed

1768
01:25:29,520 --> 01:25:33,840
change see time is that there have been

1769
01:25:33,840 --> 01:25:37,520
some later actions

1770
01:25:37,520 --> 01:25:40,800
i think when i restarted the site

1771
01:25:40,800 --> 01:25:45,199
the installation did some updates so

1772
01:25:45,199 --> 01:25:46,960
some of the information has been

1773
01:25:46,960 --> 01:25:50,480
overwritten so that sometimes are

1774
01:25:50,480 --> 01:25:54,400
wrong but i still see from here

1775
01:25:54,400 --> 01:25:57,520
the changes that have happened

1776
01:25:57,520 --> 01:26:00,239
there as mentioned it's possible to

1777
01:26:00,239 --> 01:26:02,080
download the

1778
01:26:02,080 --> 01:26:04,719
files and components apparently this is

1779
01:26:04,719 --> 01:26:06,639
something which is called wp

1780
01:26:06,639 --> 01:26:08,800
vcd if you are looking for this name you

1781
01:26:08,800 --> 01:26:10,400
are going to find a really nice

1782
01:26:10,400 --> 01:26:15,120
white paper from i think word friends

1783
01:26:15,199 --> 01:26:18,800
where they have described how it works

1784
01:26:18,800 --> 01:26:22,080
we can also see here

1785
01:26:22,080 --> 01:26:24,400
again let's see if i get it working

1786
01:26:24,400 --> 01:26:25,520
using

1787
01:26:25,520 --> 01:26:28,560
incognito window so there should be

1788
01:26:28,560 --> 01:26:31,760
a site called 900d

1789
01:26:31,760 --> 01:26:34,159
aha

1790
01:26:35,120 --> 01:26:38,480
that's already strange looks like

1791
01:26:38,480 --> 01:26:42,239
maybe comparing to a new cloud flare

1792
01:26:42,239 --> 01:26:45,600
but now in this case it is not

1793
01:26:45,600 --> 01:26:47,920
it's

1794
01:26:49,199 --> 01:26:52,239
this site which probably has a

1795
01:26:52,239 --> 01:26:56,000
bunch of already uh

1796
01:26:56,000 --> 01:26:59,679
errors so it's trying to let's see

1797
01:26:59,679 --> 01:27:03,199
it's trying to access

1798
01:27:03,199 --> 01:27:07,280
different sites

1799
01:27:07,280 --> 01:27:10,960
uh-huh and

1800
01:27:10,960 --> 01:27:15,360
completely not on

1801
01:27:15,679 --> 01:27:20,000
my site so that's a sign that

1802
01:27:20,000 --> 01:27:22,560
there's something going on on the north

1803
01:27:22,560 --> 01:27:25,120
node

1804
01:27:25,600 --> 01:27:29,040
ee i think

1805
01:27:29,040 --> 01:27:32,560
occasionally i've been able to

1806
01:27:32,560 --> 01:27:36,639
to get even better results

1807
01:27:36,639 --> 01:27:38,150
having

1808
01:27:38,150 --> 01:27:43,280
[Music]

1809
01:27:43,280 --> 01:27:47,840
yeah most of the things are

1810
01:27:48,000 --> 01:27:50,719
rumors i would need to learn how to use

1811
01:27:50,719 --> 01:27:52,719
presented tools in this

1812
01:27:52,719 --> 01:27:55,440
workshop seems like i think i need these

1813
01:27:55,440 --> 01:27:57,360
strings and grip

1814
01:27:57,360 --> 01:28:01,760
well yes you can do a lot of things with

1815
01:28:01,760 --> 01:28:04,800
grep until you know where you're looking

1816
01:28:04,800 --> 01:28:05,520
for

1817
01:28:05,520 --> 01:28:07,920
and if you're doing it daily looking at

1818
01:28:07,920 --> 01:28:09,120
apache log files

1819
01:28:09,120 --> 01:28:12,960
you can presumably also

1820
01:28:13,040 --> 01:28:16,560
find things with uh grep but sorting

1821
01:28:16,560 --> 01:28:18,320
things out from uh

1822
01:28:18,320 --> 01:28:22,000
from uh deeper uh log files

1823
01:28:22,000 --> 01:28:25,040
usually uh is something that

1824
01:28:25,040 --> 01:28:27,920
uh with uh just grip gives you just a

1825
01:28:27,920 --> 01:28:29,760
lot of

1826
01:28:29,760 --> 01:28:33,040
a lot of garbage and and

1827
01:28:33,040 --> 01:28:35,920
without being able to look at it with a

1828
01:28:35,920 --> 01:28:37,440
bit more visual tools it

1829
01:28:37,440 --> 01:28:39,600
is time consuming to actually find the

1830
01:28:39,600 --> 01:28:40,639
actual

1831
01:28:40,639 --> 01:28:44,480
uh about actors there is a pretty common

1832
01:28:44,480 --> 01:28:46,080
problem that

1833
01:28:46,080 --> 01:28:49,360
when people do clean up words wordpress

1834
01:28:49,360 --> 01:28:50,400
sites or other

1835
01:28:50,400 --> 01:28:54,559
hosting sites they are

1836
01:28:54,880 --> 01:28:58,080
missing the point when the

1837
01:28:58,080 --> 01:29:01,120
malaysian sector has gotten in

1838
01:29:01,120 --> 01:29:04,480
and when you do leave some of the pieces

1839
01:29:04,480 --> 01:29:06,239
of malware behind

1840
01:29:06,239 --> 01:29:10,000
then then the problem is that

1841
01:29:10,000 --> 01:29:13,120
uh uh they will be back usually within

1842
01:29:13,120 --> 01:29:13,679
the next

1843
01:29:13,679 --> 01:29:18,719
24 to 48 uh hours

1844
01:29:19,360 --> 01:29:22,560
uh no okay i hope to i i'll be presented

1845
01:29:22,560 --> 01:29:24,880
also with some porn but unfortunately we

1846
01:29:24,880 --> 01:29:25,920
are not getting

1847
01:29:25,920 --> 01:29:29,280
porn this time so next time

1848
01:29:29,280 --> 01:29:32,719
perhaps more porn

1849
01:29:35,120 --> 01:29:38,159
now coming back to this uh

1850
01:29:38,159 --> 01:29:41,920
look and trying to understand how to

1851
01:29:41,920 --> 01:29:44,159
uh

1852
01:29:46,480 --> 01:29:48,480
okay no no problem just starting it's

1853
01:29:48,480 --> 01:29:50,840
cool to see somebody's actually

1854
01:29:50,840 --> 01:29:53,840
uh

1855
01:29:53,840 --> 01:29:56,560
in the chat sometimes so i i kind of

1856
01:29:56,560 --> 01:29:56,960
feel

1857
01:29:56,960 --> 01:30:00,320
uh pretty alone if nobody is

1858
01:30:00,320 --> 01:30:04,800
throwing things at me but now to look at

1859
01:30:04,800 --> 01:30:08,480
how to make this uh same uh

1860
01:30:08,480 --> 01:30:11,600
uh thing uh more

1861
01:30:11,600 --> 01:30:15,040
interesting is that uh let's see

1862
01:30:15,040 --> 01:30:17,840
we are in the

1863
01:30:19,360 --> 01:30:24,159
website and we have here the

1864
01:30:24,159 --> 01:30:27,280
c timer again now the next uh

1865
01:30:27,280 --> 01:30:30,719
task is that when the actual

1866
01:30:30,719 --> 01:30:34,880
change logs is more complex than

1867
01:30:34,880 --> 01:30:37,120
than

1868
01:30:38,800 --> 01:30:42,000
in this case when it's kind of synthetic

1869
01:30:42,000 --> 01:30:44,719
there is often the question that why did

1870
01:30:44,719 --> 01:30:45,840
the files change

1871
01:30:45,840 --> 01:30:49,679
has somebody been tampering with them

1872
01:30:49,679 --> 01:30:52,320
or is it

1873
01:30:54,159 --> 01:30:57,199
just a wordpress or plugin update

1874
01:30:57,199 --> 01:30:59,360
with plugin updates it's usually pretty

1875
01:30:59,360 --> 01:31:00,880
easy because plugins

1876
01:31:00,880 --> 01:31:03,920
are replaced by basically deleting the

1877
01:31:03,920 --> 01:31:06,080
folder and adding

1878
01:31:06,080 --> 01:31:09,440
it back in so you're

1879
01:31:09,440 --> 01:31:12,400
going to see a batches of plugins

1880
01:31:12,400 --> 01:31:14,400
updated at the same time

1881
01:31:14,400 --> 01:31:17,839
now um

1882
01:31:18,639 --> 01:31:21,199
yeah thanks

1883
01:31:21,679 --> 01:31:25,199
and now i am

1884
01:31:25,199 --> 01:31:28,639
dropping here another file which is

1885
01:31:28,639 --> 01:31:30,639
another project i actually

1886
01:31:30,639 --> 01:31:35,840
completed for this

1887
01:31:36,320 --> 01:31:39,600
workshop that's a white list

1888
01:31:39,600 --> 01:31:43,120
of something like

1889
01:31:43,520 --> 01:31:47,199
five uh megabytes uh

1890
01:31:47,199 --> 01:31:50,639
uh it's the five uh wait list of all

1891
01:31:50,639 --> 01:31:53,440
of the wordpress install files from

1892
01:31:53,440 --> 01:31:54,800
version three

1893
01:31:54,800 --> 01:31:57,520
and also i think 10 most common points

1894
01:31:57,520 --> 01:32:00,560
and 10 most common

1895
01:32:01,360 --> 01:32:04,639
common themes the

1896
01:32:04,639 --> 01:32:08,880
wow this repo currently is not

1897
01:32:08,880 --> 01:32:12,000
public but on my side it's doing

1898
01:32:12,000 --> 01:32:15,199
a nightmare scan so if anybody needs a

1899
01:32:15,199 --> 01:32:18,239
list of whitelist for wordpress and

1900
01:32:18,239 --> 01:32:19,679
hopefully soon also for other things

1901
01:32:19,679 --> 01:32:20,800
then i can

1902
01:32:20,800 --> 01:32:24,960
presumably help you

1903
01:32:24,960 --> 01:32:28,000
now coming back to here and doing a

1904
01:32:28,000 --> 01:32:29,199
reload

1905
01:32:29,199 --> 01:32:32,000
then my

1906
01:32:32,320 --> 01:32:35,600
fancy tool is uh

1907
01:32:35,600 --> 01:32:37,600
adding one more ah i apparently

1908
01:32:37,600 --> 01:32:39,679
forgotten to remove the zip files which

1909
01:32:39,679 --> 01:32:40,560
is compressing

1910
01:32:40,560 --> 01:32:44,159
while i was preparing it but

1911
01:32:44,159 --> 01:32:46,080
we'll be seeing here that some of the

1912
01:32:46,080 --> 01:32:47,760
lines are now

1913
01:32:47,760 --> 01:32:51,920
also when you refresh the c timer php

1914
01:32:51,920 --> 01:32:55,679
file they are gray meaning that

1915
01:32:55,679 --> 01:32:58,880
they are of not imports they are in the

1916
01:32:58,880 --> 01:33:03,360
way with a whitelisted mb5

1917
01:33:03,360 --> 01:33:06,880
hash so in this way it's

1918
01:33:06,880 --> 01:33:11,679
easier to understand what

1919
01:33:12,800 --> 01:33:16,320
what parts of the changes are

1920
01:33:16,320 --> 01:33:19,600
naturally occurring updates and it has

1921
01:33:19,600 --> 01:33:20,800
actually really been

1922
01:33:20,800 --> 01:33:23,040
a real pain in us understanding when

1923
01:33:23,040 --> 01:33:24,239
looking at things and

1924
01:33:24,239 --> 01:33:27,760
guessing what looks like a

1925
01:33:27,760 --> 01:33:32,320
possible problem and what doesn't

1926
01:33:32,320 --> 01:33:36,159
but when i read

1927
01:33:36,159 --> 01:33:41,280
helsack presentation i think it was in

1928
01:33:41,280 --> 01:33:45,120
january i told you about how i learned

1929
01:33:45,120 --> 01:33:46,560
to

1930
01:33:46,560 --> 01:33:49,600
write jarrah rules for

1931
01:33:49,600 --> 01:33:52,719
detecting malware on websites

1932
01:33:52,719 --> 01:33:56,239
so this time i also

1933
01:33:56,239 --> 01:33:59,760
have additional file

1934
01:33:59,760 --> 01:34:05,120
which is the actual scan log of yara

1935
01:34:05,120 --> 01:34:08,480
and when i let's say

1936
01:34:08,480 --> 01:34:11,920
look at that then

1937
01:34:11,920 --> 01:34:14,960
it has

1938
01:34:16,400 --> 01:34:19,600
it is looking listing all of the files

1939
01:34:19,600 --> 01:34:21,120
that

1940
01:34:21,120 --> 01:34:25,679
have uh strange contents for example

1941
01:34:25,679 --> 01:34:27,360
these are base64

1942
01:34:27,360 --> 01:34:30,800
encoded common words

1943
01:34:30,800 --> 01:34:35,120
common wordpress functions and so on

1944
01:34:35,120 --> 01:34:38,960
and unfortunately i'm not yet ready to

1945
01:34:38,960 --> 01:34:43,040
share my urls

1946
01:34:43,040 --> 01:34:45,760
which are completely made for the

1947
01:34:45,760 --> 01:34:48,320
situation when it

1948
01:34:48,320 --> 01:34:52,080
doesn't work nicely to use grip because

1949
01:34:52,080 --> 01:34:54,800
most of the malware tends to be pretty

1950
01:34:54,800 --> 01:34:56,080
difficulty grippable

1951
01:34:56,080 --> 01:35:00,080
because the patterns are a bit

1952
01:35:00,080 --> 01:35:02,639
more complex and for that urls come

1953
01:35:02,639 --> 01:35:03,760
nicely

1954
01:35:03,760 --> 01:35:07,280
so in this case uh

1955
01:35:07,280 --> 01:35:09,119
when i have in the same folder the list

1956
01:35:09,119 --> 01:35:11,840
of euro scans

1957
01:35:11,840 --> 01:35:15,119
i can easily see also

1958
01:35:15,119 --> 01:35:18,800
what are the found shells

1959
01:35:18,800 --> 01:35:22,000
in this particular

1960
01:35:22,000 --> 01:35:26,400
installations and i can just

1961
01:35:27,600 --> 01:35:30,719
look for them so okay

1962
01:35:30,719 --> 01:35:34,080
here seems that also inside this part

1963
01:35:34,080 --> 01:35:34,719
that

1964
01:35:34,719 --> 01:35:38,800
was just like updated there

1965
01:35:38,800 --> 01:35:42,000
are presumably also different kinds

1966
01:35:42,000 --> 01:35:45,920
of uh backdrawers considering it's named

1967
01:35:45,920 --> 01:35:47,600
bacteria in estonia i think this is

1968
01:35:47,600 --> 01:35:48,960
something with what i have

1969
01:35:48,960 --> 01:35:52,239
uh left there on purpose but we are also

1970
01:35:52,239 --> 01:35:52,800
seeing

1971
01:35:52,800 --> 01:35:56,000
uh here some other backdoors or

1972
01:35:56,000 --> 01:35:59,679
shells uh there is

1973
01:35:59,679 --> 01:36:03,119
something inside this vp

1974
01:36:03,119 --> 01:36:06,480
wwp vcd from that time

1975
01:36:06,480 --> 01:36:10,080
and yeah that's probably all that it

1976
01:36:10,080 --> 01:36:12,500
uh found oh

1977
01:36:12,500 --> 01:36:13,679
[Music]

1978
01:36:13,679 --> 01:36:19,280
it's all because i in this case i just

1979
01:36:19,280 --> 01:36:21,920
checked the files in the main folder i

1980
01:36:21,920 --> 01:36:22,320
can

1981
01:36:22,320 --> 01:36:25,840
also very easily

1982
01:36:26,480 --> 01:36:30,560
go a level higher

1983
01:36:30,560 --> 01:36:33,440
and see if i know i'm not sure if it

1984
01:36:33,440 --> 01:36:33,840
will

1985
01:36:33,840 --> 01:36:37,040
match with the same search also but

1986
01:36:37,040 --> 01:36:40,159
okay seems it uh

1987
01:36:40,159 --> 01:36:43,610
did match so i'm seeing also

1988
01:36:43,610 --> 01:36:45,600
[Music]

1989
01:36:45,600 --> 01:36:48,960
aha okay that's

1990
01:36:48,960 --> 01:36:52,480
pretty strange name for a

1991
01:36:52,480 --> 01:36:55,760
file so yeah definitely i'm

1992
01:36:55,760 --> 01:36:58,960
seeing more matches now because i

1993
01:36:58,960 --> 01:37:03,280
because the matches were for a longer

1994
01:37:03,280 --> 01:37:06,480
path i mean oh i'm usually

1995
01:37:06,480 --> 01:37:09,600
actually getting the files uh or

1996
01:37:09,600 --> 01:37:12,719
these uh scans done

1997
01:37:12,719 --> 01:37:15,119
it's of course from uh command line

1998
01:37:15,119 --> 01:37:16,320
let's see if i

1999
01:37:16,320 --> 01:37:20,000
can show you

2000
01:37:20,000 --> 01:37:23,199
a example of that as well

2001
01:37:23,199 --> 01:37:24,950
my problem is that i

2002
01:37:24,950 --> 01:37:26,639
[Music]

2003
01:37:26,639 --> 01:37:29,679
don't want to show you exactly

2004
01:37:29,679 --> 01:37:32,800
the computer i'm

2005
01:37:32,800 --> 01:37:36,159
using at the moment so i'm

2006
01:37:36,159 --> 01:37:39,440
sharing it uh like that

2007
01:37:39,440 --> 01:37:43,040
so usually i'm uh

2008
01:37:43,040 --> 01:37:46,840
and the same rapport is using as the

2009
01:37:46,840 --> 01:37:49,280
same

2010
01:37:49,280 --> 01:37:53,280
scripts for shell scripts so i can do

2011
01:37:53,280 --> 01:37:54,560
also the same

2012
01:37:54,560 --> 01:37:58,960
things remotely

2013
01:37:58,960 --> 01:38:01,199
and from the shell accessing other

2014
01:38:01,199 --> 01:38:02,000
servers and

2015
01:38:02,000 --> 01:38:06,480
access the data the files the

2016
01:38:06,480 --> 01:38:10,400
scan file and the

2017
01:38:11,890 --> 01:38:14,719
[Music]

2018
01:38:14,719 --> 01:38:17,360
c see timer fire and then the jars can

2019
01:38:17,360 --> 01:38:18,320
file

2020
01:38:18,320 --> 01:38:21,679
uh again uh

2021
01:38:21,679 --> 01:38:24,719
done usually like that but uh

2022
01:38:24,719 --> 01:38:27,040
it's just a part of automations to make

2023
01:38:27,040 --> 01:38:28,400
things run faster

2024
01:38:28,400 --> 01:38:30,639
the anybody if anybody is uh interested

2025
01:38:30,639 --> 01:38:33,199
in in that part of getting their

2026
01:38:33,199 --> 01:38:36,320
work uh done faster than uh

2027
01:38:36,320 --> 01:38:39,520
we can later talk about and

2028
01:38:39,520 --> 01:38:44,719
about that a bit more

2029
01:38:44,719 --> 01:38:48,560
so this is uh

2030
01:38:49,040 --> 01:38:53,840
on that side about the

2031
01:38:55,600 --> 01:38:59,280
wuhan and finding how

2032
01:38:59,280 --> 01:39:03,840
it was cellphone the same pattern of

2033
01:39:03,840 --> 01:39:06,880
login and uploading is often very common

2034
01:39:06,880 --> 01:39:07,679
also not

2035
01:39:07,679 --> 01:39:10,320
when it's cell phone but also the result

2036
01:39:10,320 --> 01:39:12,320
of all of these

2037
01:39:12,320 --> 01:39:18,320
vp lodging login php and xmlrpc

2038
01:39:18,320 --> 01:39:20,719
tests

2039
01:39:21,600 --> 01:39:25,119
now let's see how we can

2040
01:39:25,119 --> 01:39:29,199
do the same things on the server side

2041
01:39:29,199 --> 01:39:32,960
and what else what what other kinds of

2042
01:39:32,960 --> 01:39:34,080
logs

2043
01:39:34,080 --> 01:39:38,000
we could analyze and which are

2044
01:39:38,000 --> 01:39:41,119
interesting for example

2045
01:39:41,119 --> 01:39:44,159
the same question as i showed you there

2046
01:39:44,159 --> 01:39:46,159
was a link to something called

2047
01:39:46,159 --> 01:39:49,520
dumb sec with the example 2

2048
01:39:49,520 --> 01:39:52,560
file and then

2049
01:39:52,560 --> 01:39:56,880
what the hell is dumpsic

2050
01:39:56,960 --> 01:40:00,239
dumpster was a tool that

2051
01:40:00,239 --> 01:40:04,000
i created when i was probably

2052
01:40:04,000 --> 01:40:07,600
really dumb so it's

2053
01:40:07,600 --> 01:40:11,520
basically a script which can be

2054
01:40:11,520 --> 01:40:15,119
auto prepended to

2055
01:40:15,760 --> 01:40:19,040
to php

2056
01:40:19,040 --> 01:40:23,119
using dot user.any to

2057
01:40:23,119 --> 01:40:28,320
run it and it will be logging everything

2058
01:40:28,320 --> 01:40:31,360
posted log file in a way to

2059
01:40:31,360 --> 01:40:34,239
make it possible to see whose password

2060
01:40:34,239 --> 01:40:34,880
has

2061
01:40:34,880 --> 01:40:37,280
leaked or something like that as i

2062
01:40:37,280 --> 01:40:39,840
mentioned

2063
01:40:39,920 --> 01:40:44,239
the guy who was on that site found that

2064
01:40:44,239 --> 01:40:47,760
and commented out the line used for

2065
01:40:47,760 --> 01:40:52,400
logging so not uh

2066
01:40:53,119 --> 01:40:56,239
not that clever dumpster is very dumb

2067
01:40:56,239 --> 01:40:56,880
solution

2068
01:40:56,880 --> 01:40:59,280
and if somebody gets in it's of course

2069
01:40:59,280 --> 01:41:00,960
very easy to

2070
01:41:00,960 --> 01:41:03,600
circumvent that it does have some

2071
01:41:03,600 --> 01:41:06,000
protections for

2072
01:41:06,000 --> 01:41:09,520
for uh not logging the passwords you can

2073
01:41:09,520 --> 01:41:13,360
of course make the arrays empty

2074
01:41:13,360 --> 01:41:15,600
and log all the passwords logging

2075
01:41:15,600 --> 01:41:16,719
passwords

2076
01:41:16,719 --> 01:41:19,600
on the user accessible server is not a

2077
01:41:19,600 --> 01:41:21,760
good life choice but

2078
01:41:21,760 --> 01:41:25,520
we make our choices of often

2079
01:41:25,520 --> 01:41:28,960
not thinking too much about that

2080
01:41:29,199 --> 01:41:32,239
and worse than that i do have also

2081
01:41:32,239 --> 01:41:36,559
another site which

2082
01:41:37,280 --> 01:41:40,800
has doom

2083
01:41:40,800 --> 01:41:44,080
dumpster look

2084
01:41:44,719 --> 01:41:47,840
so uh i have been actually trying to

2085
01:41:47,840 --> 01:41:48,880
understand

2086
01:41:48,880 --> 01:41:52,639
uh what the users uh

2087
01:41:52,639 --> 01:41:55,119
well what the attackers are trying to do

2088
01:41:55,119 --> 01:41:56,159
when they are doing

2089
01:41:56,159 --> 01:41:59,199
all of these wordpress login

2090
01:41:59,199 --> 01:42:03,920
attacks and here we are seeing

2091
01:42:03,920 --> 01:42:07,040
a lot of attempts that

2092
01:42:07,040 --> 01:42:11,119
all look very similar so

2093
01:42:11,119 --> 01:42:14,880
as we saw they have been collecting

2094
01:42:14,880 --> 01:42:18,000
or enumerating users

2095
01:42:18,000 --> 01:42:20,880
so what to do when you have users let's

2096
01:42:20,880 --> 01:42:21,679
just try

2097
01:42:21,679 --> 01:42:23,679
maybe the user has username also the

2098
01:42:23,679 --> 01:42:26,239
password

2099
01:42:26,480 --> 01:42:30,159
admin admin uh there is uh

2100
01:42:30,159 --> 01:42:33,520
uh this is now the version of uh xmr

2101
01:42:33,520 --> 01:42:36,800
rpc used for numer for

2102
01:42:36,800 --> 01:42:41,520
uh uh password brute forcing

2103
01:42:41,520 --> 01:42:44,960
so this is the simple

2104
01:42:44,960 --> 01:42:48,320
vp get user blocks used by i think there

2105
01:42:48,320 --> 01:42:48,639
is

2106
01:42:48,639 --> 01:42:52,000
a user is admin and trying a password

2107
01:42:52,000 --> 01:42:53,600
like that

2108
01:42:53,600 --> 01:42:56,800
here is a bit more interesting

2109
01:42:56,800 --> 01:43:00,560
version of using system multicall

2110
01:43:00,560 --> 01:43:04,560
to try different

2111
01:43:05,679 --> 01:43:09,440
logins when you actually look at this

2112
01:43:09,440 --> 01:43:11,119
method you will be seeing that the

2113
01:43:11,119 --> 01:43:12,639
username is

2114
01:43:12,639 --> 01:43:15,679
logging in square brackets

2115
01:43:15,679 --> 01:43:18,400
and the password is one two three login

2116
01:43:18,400 --> 01:43:18,960
so

2117
01:43:18,960 --> 01:43:22,159
apparently the clever hackers who are

2118
01:43:22,159 --> 01:43:22,960
using this

2119
01:43:22,960 --> 01:43:26,239
multi-core possibility are

2120
01:43:26,239 --> 01:43:29,840
completely wasting just everybody's type

2121
01:43:29,840 --> 01:43:33,119
here's also an interesting things

2122
01:43:33,119 --> 01:43:35,840
they think that my username is peter

2123
01:43:35,840 --> 01:43:36,400
missing

2124
01:43:36,400 --> 01:43:40,400
marvit i'm not missing and

2125
01:43:40,400 --> 01:43:42,800
when you google there is probably for

2126
01:43:42,800 --> 01:43:45,440
this missing there is

2127
01:43:45,440 --> 01:43:47,600
some specific case why it is i think

2128
01:43:47,600 --> 01:43:49,520
there is

2129
01:43:49,520 --> 01:43:52,000
some kind of charter encoding issue or

2130
01:43:52,000 --> 01:43:53,840
something like that

2131
01:43:53,840 --> 01:43:57,199
uh causing that in uh i think go

2132
01:43:57,199 --> 01:43:59,520
language browsers or some kind of

2133
01:43:59,520 --> 01:44:00,400
specific

2134
01:44:00,400 --> 01:44:03,520
scripts which are doing so again

2135
01:44:03,520 --> 01:44:06,239
we are seeing the same pattern same

2136
01:44:06,239 --> 01:44:06,960
pattern

2137
01:44:06,960 --> 01:44:10,400
over and over again

2138
01:44:10,400 --> 01:44:13,520
adding some year numbers and

2139
01:44:13,520 --> 01:44:18,960
doing absolutely the simplest possible

2140
01:44:18,960 --> 01:44:21,840
trustworth it's even not brute forcing

2141
01:44:21,840 --> 01:44:22,639
it's just

2142
01:44:22,639 --> 01:44:27,440
uh gentle forcing

2143
01:44:28,239 --> 01:44:31,280
and now

2144
01:44:32,239 --> 01:44:35,600
there are other ways to achieve that and

2145
01:44:35,600 --> 01:44:39,679
for that if somebody wants to try more

2146
01:44:39,679 --> 01:44:44,320
uh we can also try to see the same thing

2147
01:44:44,320 --> 01:44:48,639
on server side and

2148
01:44:48,639 --> 01:44:50,080
some more tricks that i can't

2149
01:44:50,080 --> 01:44:51,840
demonstrate

2150
01:44:51,840 --> 01:44:55,840
here for that i have

2151
01:44:55,840 --> 01:44:58,560
a way to

2152
01:44:59,520 --> 01:45:01,760
launch oh the name gun is just making

2153
01:45:01,760 --> 01:45:03,920
them

2154
01:45:03,920 --> 01:45:07,040
nice names and

2155
01:45:07,040 --> 01:45:09,679
zero detector t is actually something

2156
01:45:09,679 --> 01:45:10,639
that i

2157
01:45:10,639 --> 01:45:14,840
used couple of years ago for some

2158
01:45:14,840 --> 01:45:18,480
non-ctft-based ctf

2159
01:45:18,480 --> 01:45:21,360
so i

2160
01:45:22,639 --> 01:45:25,760
there is somewhere a zero day which you

2161
01:45:25,760 --> 01:45:28,880
can use to get into the wordpress

2162
01:45:28,880 --> 01:45:31,840
for today i also made you some users so

2163
01:45:31,840 --> 01:45:34,400
you don't need to find the 0d first

2164
01:45:34,400 --> 01:45:38,560
there is just this question of

2165
01:45:38,560 --> 01:45:43,040
booting up the target

2166
01:45:43,280 --> 01:45:46,800
vps on as a digitalocean

2167
01:45:46,800 --> 01:45:50,159
droplet so

2168
01:45:50,159 --> 01:45:54,320
i probably if somebody has wanted to

2169
01:45:54,320 --> 01:45:56,320
try that they have probably already done

2170
01:45:56,320 --> 01:45:58,480
that so i'll just show how you

2171
01:45:58,480 --> 01:46:02,639
how you can do that so it's a

2172
01:46:02,639 --> 01:46:08,080
kind of common really simple

2173
01:46:08,239 --> 01:46:12,000
first idiot trap

2174
01:46:12,000 --> 01:46:15,520
so we need to just

2175
01:46:16,480 --> 01:46:20,560
get in so let's say and i

2176
01:46:20,560 --> 01:46:22,800
if you just submit you'll be told that

2177
01:46:22,800 --> 01:46:23,840
you also need to

2178
01:46:23,840 --> 01:46:28,560
submit email and i'm just using

2179
01:46:28,560 --> 01:46:30,860
my

2180
01:46:30,860 --> 01:46:33,929
[Music]

2181
01:46:36,880 --> 01:46:41,520
my email with a so let's see if i get

2182
01:46:41,520 --> 01:46:44,880
a nice vps

2183
01:46:50,960 --> 01:46:55,199
yes and as you can probably

2184
01:46:55,199 --> 01:46:58,880
guess that creating uh vps

2185
01:46:58,880 --> 01:47:02,159
on a vps platform

2186
01:47:02,159 --> 01:47:05,520
is mostly about devising a

2187
01:47:05,520 --> 01:47:09,280
name for your host so

2188
01:47:09,280 --> 01:47:12,239
that took most of my time to for for

2189
01:47:12,239 --> 01:47:12,639
that

2190
01:47:12,639 --> 01:47:15,920
uh script so this is actually

2191
01:47:15,920 --> 01:47:19,360
a if you're looking for i think it's

2192
01:47:19,360 --> 01:47:21,760
fake video name video game name

2193
01:47:21,760 --> 01:47:23,119
generator

2194
01:47:23,119 --> 01:47:26,440
and another toolkit which is creating

2195
01:47:26,440 --> 01:47:28,400
alliterative

2196
01:47:28,400 --> 01:47:31,440
animal names

2197
01:47:31,440 --> 01:47:34,480
so but that's a server that was

2198
01:47:34,480 --> 01:47:35,600
generated for

2199
01:47:35,600 --> 01:47:40,239
me it if i

2200
01:47:40,239 --> 01:47:43,360
copy the address and

2201
01:47:43,360 --> 01:47:50,880
and to a

2202
01:47:50,880 --> 01:47:54,080
ping i should see okay

2203
01:47:54,080 --> 01:47:56,560
the link coping wasn't the smartest

2204
01:47:56,560 --> 01:47:58,239
thing

2205
01:47:58,239 --> 01:48:02,400
so let's see when it comes up and

2206
01:48:02,400 --> 01:48:06,719
i have there a couple of more

2207
01:48:06,719 --> 01:48:09,920
things that i'm using in these

2208
01:48:09,920 --> 01:48:13,040
occasions and also for what i'm using

2209
01:48:13,040 --> 01:48:16,560
okay we got up so

2210
01:48:16,560 --> 01:48:19,679
the trick now is to get in uh okay we

2211
01:48:19,679 --> 01:48:22,880
can also see what's there

2212
01:48:23,040 --> 01:48:26,719
there's probably a wordpress site

2213
01:48:26,719 --> 01:48:30,080
and which which

2214
01:48:30,080 --> 01:48:35,119
does have a really cool facebook

2215
01:48:36,480 --> 01:48:40,080
deserving zero day

2216
01:48:40,080 --> 01:48:43,679
again this server you are welcome to

2217
01:48:43,679 --> 01:48:47,040
trespa trash but don't try to

2218
01:48:47,040 --> 01:48:50,159
get wordpress security team to

2219
01:48:50,159 --> 01:48:54,080
remove this vulnerable plugin

2220
01:48:54,080 --> 01:48:57,520
from the repositories it has stayed

2221
01:48:57,520 --> 01:48:59,840
there for eight years

2222
01:48:59,840 --> 01:49:02,320
it's probably already going to school

2223
01:49:02,320 --> 01:49:04,239
and in a couple of years we'll be able

2224
01:49:04,239 --> 01:49:05,600
to participate in

2225
01:49:05,600 --> 01:49:09,840
voting so let's keep

2226
01:49:09,840 --> 01:49:13,440
zero days being zero days for

2227
01:49:13,440 --> 01:49:17,199
more years i think i found that in 2017

2228
01:49:17,199 --> 01:49:19,040
i have informed about that for a couple

2229
01:49:19,040 --> 01:49:22,080
of times so i have done all of the

2230
01:49:22,080 --> 01:49:24,560
responsible disclosure things so i can

2231
01:49:24,560 --> 01:49:25,199
now

2232
01:49:25,199 --> 01:49:29,040
happily just keep using it as my

2233
01:49:29,040 --> 01:49:32,159
sample zero day vulnerability for

2234
01:49:32,159 --> 01:49:35,440
five years so

2235
01:49:35,440 --> 01:49:38,800
but we can get into the server by doing

2236
01:49:38,800 --> 01:49:42,400
the ssh to mayhem at

2237
01:49:42,400 --> 01:49:46,480
uh whatever is the

2238
01:49:46,480 --> 01:49:49,679
computer you got up uh apparently you

2239
01:49:49,679 --> 01:49:50,320
cannot so

2240
01:49:50,320 --> 01:49:54,320
you see also my so you you can

2241
01:49:54,719 --> 01:49:59,280
come and trust that a password is

2242
01:50:00,960 --> 01:50:04,560
mayhem other way so

2243
01:50:04,560 --> 01:50:07,119
mechyam

2244
01:50:07,679 --> 01:50:10,719
reversed so uh

2245
01:50:10,719 --> 01:50:14,960
we got uh in here so

2246
01:50:14,960 --> 01:50:18,400
and i'll show you also

2247
01:50:18,400 --> 01:50:22,080
what's in there

2248
01:50:22,880 --> 01:50:25,840
from the

2249
01:50:28,639 --> 01:50:31,520
server side in to a better browseable

2250
01:50:31,520 --> 01:50:32,480
way i kind of

2251
01:50:32,480 --> 01:50:36,080
like to have things in

2252
01:50:36,840 --> 01:50:39,840
um

2253
01:50:43,679 --> 01:50:46,800
visual trees not pro thing around

2254
01:50:46,800 --> 01:50:51,040
so on this computer we have

2255
01:50:51,040 --> 01:50:53,840
somewhere in

2256
01:50:55,760 --> 01:50:59,040
war we will be

2257
01:50:59,040 --> 01:51:02,239
html we do have here

2258
01:51:02,239 --> 01:51:07,360
set up with these same

2259
01:51:07,360 --> 01:51:10,800
tools so if you want

2260
01:51:10,800 --> 01:51:14,159
you can play around here with

2261
01:51:14,159 --> 01:51:16,560
files this is also a place where you can

2262
01:51:16,560 --> 01:51:18,320
try to install the

2263
01:51:18,320 --> 01:51:22,400
wordpress plugin and see what

2264
01:51:22,400 --> 01:51:26,239
changes so if we go there

2265
01:51:26,239 --> 01:51:30,000
there and look at the c timer then we

2266
01:51:30,000 --> 01:51:34,880
probably have this file i have uh

2267
01:51:34,880 --> 01:51:38,000
touched all to the same moment so

2268
01:51:38,000 --> 01:51:41,040
uh to make it not easy to see

2269
01:51:41,040 --> 01:51:44,400
uh if there is anything uh problematic

2270
01:51:44,400 --> 01:51:46,880
because i'd like to finish this thing by

2271
01:51:46,880 --> 01:51:48,159
showing

2272
01:51:48,159 --> 01:51:51,360
another stupid script of my

2273
01:51:51,360 --> 01:51:54,480
mind to clean up the things but before

2274
01:51:54,480 --> 01:51:55,280
that

2275
01:51:55,280 --> 01:51:58,000
i've got here a couple of other things

2276
01:51:58,000 --> 01:51:58,639
first

2277
01:51:58,639 --> 01:52:02,400
there is the

2278
01:52:02,400 --> 01:52:05,679
dump sec which is

2279
01:52:05,679 --> 01:52:08,480
logging everything which you might be

2280
01:52:08,480 --> 01:52:09,280
interested

2281
01:52:09,280 --> 01:52:14,080
so if mayhem tries to

2282
01:52:15,520 --> 01:52:19,119
you can log in with the stupid password

2283
01:52:19,119 --> 01:52:22,080
and you are the one who has to tell the

2284
01:52:22,080 --> 01:52:23,440
user that

2285
01:52:23,440 --> 01:52:26,080
this is not a good life choice to have

2286
01:52:26,080 --> 01:52:28,840
such passwords

2287
01:52:28,840 --> 01:52:31,840
then

2288
01:52:32,960 --> 01:52:37,119
here currently the password is

2289
01:52:37,119 --> 01:52:40,320
masked but

2290
01:52:40,639 --> 01:52:43,760
if you want to be really evil you can of

2291
01:52:43,760 --> 01:52:44,239
course

2292
01:52:44,239 --> 01:52:47,759
change the dumpster to

2293
01:52:47,840 --> 01:52:50,880
show it fully but

2294
01:52:50,880 --> 01:52:53,840
i have here on this server another

2295
01:52:53,840 --> 01:52:56,080
interesting

2296
01:52:56,080 --> 01:52:59,679
setup namely it has mod security

2297
01:52:59,679 --> 01:53:01,840
that is configured to save all of the

2298
01:53:01,840 --> 01:53:03,119
post requests

2299
01:53:03,119 --> 01:53:05,119
again what could possibly go wrong by

2300
01:53:05,119 --> 01:53:06,880
saving uh

2301
01:53:06,880 --> 01:53:09,920
on sanitary's post requests but that's

2302
01:53:09,920 --> 01:53:11,760
the bravest thing i'm

2303
01:53:11,760 --> 01:53:15,440
doing for you so we can

2304
01:53:15,440 --> 01:53:18,080
actually go and see from the audit logs

2305
01:53:18,080 --> 01:53:18,880
and see

2306
01:53:18,880 --> 01:53:22,000
what was the password that was tried to

2307
01:53:22,000 --> 01:53:26,000
enter uh

2308
01:53:26,000 --> 01:53:30,320
but before that

2309
01:53:30,320 --> 01:53:33,040
i'll show you another thing which is uh

2310
01:53:33,040 --> 01:53:34,960
which you can

2311
01:53:34,960 --> 01:53:38,960
check how it's done on this server

2312
01:53:38,960 --> 01:53:42,800
namely as it has more security it often

2313
01:53:42,800 --> 01:53:44,480
also looks like people are thinking that

2314
01:53:44,480 --> 01:53:45,920
ah okay more security

2315
01:53:45,920 --> 01:53:49,040
let's put on also uh over

2316
01:53:49,040 --> 01:53:51,840
core rule set rules to make sure nobody

2317
01:53:51,840 --> 01:53:53,520
can hack my server

2318
01:53:53,520 --> 01:53:57,360
well bad news is that they still can

2319
01:53:57,360 --> 01:54:00,400
but the good users will probably

2320
01:54:00,400 --> 01:54:04,159
get some errors so let's put

2321
01:54:04,159 --> 01:54:06,480
myself once into the shoes of a good

2322
01:54:06,480 --> 01:54:09,280
user who is

2323
01:54:09,280 --> 01:54:13,440
coming to the website and

2324
01:54:13,440 --> 01:54:17,440
trying to search something so

2325
01:54:17,440 --> 01:54:19,679
let's say so it should be probably i

2326
01:54:19,679 --> 01:54:22,159
think the wordpress search is

2327
01:54:22,159 --> 01:54:25,119
something like that

2328
01:54:26,560 --> 01:54:29,840
yeah okay but we are not looking for

2329
01:54:29,840 --> 01:54:33,599
blah we are actually looking for ways to

2330
01:54:33,599 --> 01:54:37,599
execute to see if we can somehow

2331
01:54:37,599 --> 01:54:40,639
gain access from here to whatever let's

2332
01:54:40,639 --> 01:54:47,840
see vpconfig.php

2333
01:54:48,840 --> 01:54:51,840
sorry

2334
01:54:53,280 --> 01:54:56,320
oops apparently

2335
01:54:56,320 --> 01:55:01,199
there was a firewall action that

2336
01:55:01,199 --> 01:55:05,199
triggered and served to me a really nice

2337
01:55:05,199 --> 01:55:09,199
error page now

2338
01:55:09,280 --> 01:55:11,440
this is actually something that i copied

2339
01:55:11,440 --> 01:55:15,199
from what was done to estonian

2340
01:55:15,199 --> 01:55:17,280
government portals when they switched to

2341
01:55:17,280 --> 01:55:18,719
drupals and

2342
01:55:18,719 --> 01:55:21,599
forgot to pen test them before going

2343
01:55:21,599 --> 01:55:22,239
live

2344
01:55:22,239 --> 01:55:24,320
so they're starting to have a lot of

2345
01:55:24,320 --> 01:55:25,840
problems and the first

2346
01:55:25,840 --> 01:55:28,320
solution was to okay let's add more

2347
01:55:28,320 --> 01:55:30,719
security and web application fireball

2348
01:55:30,719 --> 01:55:33,280
and the second program was then the

2349
01:55:33,280 --> 01:55:34,719
actual users not

2350
01:55:34,719 --> 01:55:38,239
being able to do their work

2351
01:55:38,239 --> 01:55:42,159
so what they did was

2352
01:55:42,159 --> 01:55:46,320
create a very simple error handler

2353
01:55:46,320 --> 01:55:50,000
that is

2354
01:55:50,000 --> 01:55:52,639
i think they had a bit more obfuscated

2355
01:55:52,639 --> 01:55:53,280
than

2356
01:55:53,280 --> 01:55:57,280
my case that was running on users

2357
01:55:57,280 --> 01:56:00,560
who were able to run javascript

2358
01:56:00,560 --> 01:56:03,760
javascript turns out that despite search

2359
01:56:03,760 --> 01:56:05,440
engines being able to run also

2360
01:56:05,440 --> 01:56:06,480
javascript

2361
01:56:06,480 --> 01:56:10,159
now most of them

2362
01:56:10,159 --> 01:56:14,239
don't at least run requests like that

2363
01:56:14,239 --> 01:56:16,880
so i'm very rarely getting any false

2364
01:56:16,880 --> 01:56:18,960
positive notices

2365
01:56:18,960 --> 01:56:22,400
how would i get the false positive

2366
01:56:22,400 --> 01:56:23,679
notices

2367
01:56:23,679 --> 01:56:28,880
uh well that's a tool

2368
01:56:28,880 --> 01:56:32,880
that's sitting here in the vault handler

2369
01:56:32,880 --> 01:56:36,400
and it does have this

2370
01:56:36,400 --> 01:56:40,960
nice feature of when

2371
01:56:40,960 --> 01:56:45,760
somebody hits the

2372
01:56:46,159 --> 01:56:50,960
403 error they

2373
01:56:51,520 --> 01:56:54,320
send me an email yes this functionality

2374
01:56:54,320 --> 01:56:57,599
could be used to

2375
01:56:57,599 --> 01:57:00,960
trash my mailbox but don't do that

2376
01:57:00,960 --> 01:57:04,560
i'll just show how it works so

2377
01:57:04,560 --> 01:57:08,400
if i have it here

2378
01:57:08,560 --> 01:57:11,360
i think something like monitoring might

2379
01:57:11,360 --> 01:57:13,199
be lies

2380
01:57:13,199 --> 01:57:18,560
at gmail.com

2381
01:57:18,560 --> 01:57:21,679
so and now

2382
01:57:21,679 --> 01:57:25,840
that it's saved we can

2383
01:57:26,239 --> 01:57:31,040
try to where was my browser window

2384
01:57:31,040 --> 01:57:34,480
so we can just try to

2385
01:57:34,480 --> 01:57:37,199
use this one but now this one so let's

2386
01:57:37,199 --> 01:57:38,480
try to

2387
01:57:38,480 --> 01:57:40,639
do whatever maybe have a different kind

2388
01:57:40,639 --> 01:57:42,719
of

2389
01:57:42,719 --> 01:57:46,880
see if we can access something like that

2390
01:57:47,119 --> 01:57:50,560
again there's an error and if i look

2391
01:57:50,560 --> 01:57:53,840
to my

2392
01:58:06,239 --> 01:58:09,760
uh let's see

2393
01:58:09,760 --> 01:58:12,960
okay this probably went into spam i

2394
01:58:12,960 --> 01:58:15,080
think

2395
01:58:15,080 --> 01:58:19,760
yes it's of course in the spam

2396
01:58:19,760 --> 01:58:22,159
so i was looking for it in different

2397
01:58:22,159 --> 01:58:22,960
places

2398
01:58:22,960 --> 01:58:26,239
but here is the report

2399
01:58:26,239 --> 01:58:29,040
that has been sent

2400
01:58:29,360 --> 01:58:35,119
from from

2401
01:58:35,119 --> 01:58:39,520
this test server and is reporting that

2402
01:58:39,520 --> 01:58:44,239
there has been been bash in

2403
01:58:44,239 --> 01:58:48,080
search argument present

2404
01:58:48,080 --> 01:58:51,520
so this is uh what is

2405
01:58:51,520 --> 01:58:54,880
uh kind of

2406
01:58:54,880 --> 01:58:58,080
for me a user-friendly way

2407
01:58:58,080 --> 01:59:01,679
of protecting users from all kinds of

2408
01:59:01,679 --> 01:59:03,360
these

2409
01:59:03,360 --> 01:59:06,480
troubles of being caught by

2410
01:59:06,480 --> 01:59:12,400
by web application firewalls

2411
01:59:13,470 --> 01:59:14,840
[Music]

2412
01:59:14,840 --> 01:59:16,000
now

2413
01:59:16,000 --> 01:59:20,239
what else do we have on the server well

2414
01:59:20,239 --> 01:59:21,970
let's see where was my

2415
01:59:21,970 --> 01:59:25,249
[Music]

2416
01:59:26,639 --> 01:59:29,679
ftp client and

2417
01:59:29,679 --> 01:59:33,199
where where could we have log files

2418
01:59:33,199 --> 01:59:36,400
i think we have log files uh

2419
01:59:36,400 --> 01:59:39,920
log and i think it's under apache

2420
01:59:39,920 --> 01:59:43,040
and we have here again some more log

2421
01:59:43,040 --> 01:59:44,719
files which

2422
01:59:44,719 --> 01:59:48,480
brave people are probably tackling with

2423
01:59:48,480 --> 01:59:53,040
grip aux set and other cool tools

2424
01:59:53,040 --> 01:59:57,679
but maybe there is a better way

2425
01:59:57,679 --> 02:00:02,239
so here is the error log

2426
02:00:02,239 --> 02:00:06,960
and so mod security is

2427
02:00:06,960 --> 02:00:10,639
putting all of its in here

2428
02:00:10,639 --> 02:00:14,159
and actually the moment when

2429
02:00:14,159 --> 02:00:16,639
your content site people come screaming

2430
02:00:16,639 --> 02:00:17,199
that

2431
02:00:17,199 --> 02:00:20,000
the website editor doesn't work and they

2432
02:00:20,000 --> 02:00:21,199
can't actually publish

2433
02:00:21,199 --> 02:00:23,679
their whatever ministers or prime

2434
02:00:23,679 --> 02:00:25,760
minister's

2435
02:00:25,760 --> 02:00:30,080
speech then you need to actually

2436
02:00:30,080 --> 02:00:33,599
dig through this kind of error log

2437
02:00:33,599 --> 02:00:36,960
very quickly and if you are not a test

2438
02:00:36,960 --> 02:00:38,080
site then

2439
02:00:38,080 --> 02:00:41,440
it will be probably already megabytes of

2440
02:00:41,440 --> 02:00:44,480
log file to uh

2441
02:00:44,480 --> 02:00:47,840
troll through so uh

2442
02:00:47,840 --> 02:00:51,280
what to do is that uh there for that

2443
02:00:51,280 --> 02:00:54,639
i have again some

2444
02:00:54,639 --> 02:00:58,800
sample patterns that i'm using

2445
02:00:58,800 --> 02:01:01,920
and let's grab the correct

2446
02:01:01,920 --> 02:01:05,040
spectics and i have

2447
02:01:05,040 --> 02:01:09,679
okay i have here actually i have here uh

2448
02:01:09,679 --> 02:01:13,119
three laps the first one is which is

2449
02:01:13,119 --> 02:01:13,760
also

2450
02:01:13,760 --> 02:01:17,520
happening on this server

2451
02:01:17,520 --> 02:01:20,960
so as i mentioned at the beginning that

2452
02:01:20,960 --> 02:01:24,320
i'm using to find out

2453
02:01:24,320 --> 02:01:27,360
which calls are running php

2454
02:01:27,360 --> 02:01:30,639
by looking at some specific parameters

2455
02:01:30,639 --> 02:01:30,960
to

2456
02:01:30,960 --> 02:01:34,560
our hosting so what i

2457
02:01:34,560 --> 02:01:38,800
did here is i added

2458
02:01:38,800 --> 02:01:44,239
two generic apaches

2459
02:01:44,960 --> 02:01:47,679
log i didn't have i didn't have time to

2460
02:01:47,679 --> 02:01:49,199
find a nice way to

2461
02:01:49,199 --> 02:01:52,480
capture actually fbm's

2462
02:01:52,480 --> 02:01:56,480
time but i added the parameter

2463
02:01:56,480 --> 02:01:59,679
percentage big r

2464
02:01:59,679 --> 02:02:03,440
which is adding the information about

2465
02:02:03,440 --> 02:02:04,239
the handler

2466
02:02:04,239 --> 02:02:06,320
that apache was using to serve this

2467
02:02:06,320 --> 02:02:07,599
request

2468
02:02:07,599 --> 02:02:10,080
so basically there is redirect handler

2469
02:02:10,080 --> 02:02:10,800
there is

2470
02:02:10,800 --> 02:02:14,239
fbm uh proxy and

2471
02:02:14,239 --> 02:02:17,840
the minus means that there is

2472
02:02:17,840 --> 02:02:20,000
there was no handler that was a static

2473
02:02:20,000 --> 02:02:21,280
file so

2474
02:02:21,280 --> 02:02:23,520
uh the sample if you are taking the

2475
02:02:23,520 --> 02:02:24,960
files from

2476
02:02:24,960 --> 02:02:32,800
these vps vps then um

2477
02:02:32,800 --> 02:02:36,000
i'm trying to i have four monitors so

2478
02:02:36,000 --> 02:02:39,119
i'm sorry if i lose some of my

2479
02:02:39,119 --> 02:02:43,040
browser windows uh in my room so uh

2480
02:02:43,040 --> 02:02:47,760
here is the

2481
02:02:47,760 --> 02:02:50,239
better view handler and i'm using the

2482
02:02:50,239 --> 02:02:51,599
similar log file that

2483
02:02:51,599 --> 02:02:53,679
i was showing you but i have already

2484
02:02:53,679 --> 02:02:55,199
copied it to

2485
02:02:55,199 --> 02:02:58,400
my shared spectic server where

2486
02:02:58,400 --> 02:03:01,520
we can see

2487
02:03:01,520 --> 02:03:04,560
that we can

2488
02:03:04,560 --> 02:03:07,760
easily filter out the requests that

2489
02:03:07,760 --> 02:03:09,920
are only the ones which are running the

2490
02:03:09,920 --> 02:03:10,960
php

2491
02:03:10,960 --> 02:03:14,000
why faviconico is running php well there

2492
02:03:14,000 --> 02:03:16,159
is no favicon icon this server so

2493
02:03:16,159 --> 02:03:17,920
wordpress is catching over and dealing

2494
02:03:17,920 --> 02:03:20,400
with that but we are really seeing that

2495
02:03:20,400 --> 02:03:21,679
we are not

2496
02:03:21,679 --> 02:03:25,280
getting any images or css files

2497
02:03:25,280 --> 02:03:27,599
that's thanks to thanks to the fact that

2498
02:03:27,599 --> 02:03:29,199
i'm filtering here

2499
02:03:29,199 --> 02:03:31,920
the requests that don't that that have

2500
02:03:31,920 --> 02:03:32,639
this

2501
02:03:32,639 --> 02:03:36,239
handler as uh if you want to

2502
02:03:36,239 --> 02:03:39,280
play with that on your own then there is

2503
02:03:39,280 --> 02:03:42,239
also the specific

2504
02:03:42,239 --> 02:03:45,360
more slightly modified patches

2505
02:03:45,360 --> 02:03:48,719
log file here

2506
02:03:48,719 --> 02:03:52,000
but i came here to help you find

2507
02:03:52,000 --> 02:03:55,599
out how to find the errors

2508
02:03:55,599 --> 02:03:58,800
that are happening so for that i have

2509
02:03:58,800 --> 02:03:59,199
here

2510
02:03:59,199 --> 02:04:02,800
another example which is

2511
02:04:02,800 --> 02:04:06,400
taking this uh using apache's error log

2512
02:04:06,400 --> 02:04:09,040
taking the

2513
02:04:09,599 --> 02:04:12,880
hacky sites error lock again

2514
02:04:12,880 --> 02:04:15,679
copied during the preparations though

2515
02:04:15,679 --> 02:04:17,599
i'm not copying the one which

2516
02:04:17,599 --> 02:04:20,159
we saw here we could move that also

2517
02:04:20,159 --> 02:04:21,040
later

2518
02:04:21,040 --> 02:04:24,320
and uh here

2519
02:04:24,320 --> 02:04:27,360
we're seeing that

2520
02:04:27,599 --> 02:04:31,040
these are the requests in

2521
02:04:31,040 --> 02:04:35,119
fact i think i don't care about

2522
02:04:35,119 --> 02:04:38,159
these two ids which

2523
02:04:38,159 --> 02:04:42,400
are the ids of anomaly

2524
02:04:42,400 --> 02:04:46,239
scoring so we can just look at

2525
02:04:46,239 --> 02:04:49,840
the requests that are having trouble so

2526
02:04:49,840 --> 02:04:53,119
here is the data

2527
02:04:53,119 --> 02:04:55,679
which is actually causing the trouble

2528
02:04:55,679 --> 02:04:56,239
and

2529
02:04:56,239 --> 02:04:59,520
we can move with this information we can

2530
02:04:59,520 --> 02:05:00,639
move on

2531
02:05:00,639 --> 02:05:03,679
and write write list

2532
02:05:03,679 --> 02:05:07,599
rules to mod security

2533
02:05:07,599 --> 02:05:10,800
of us core rule set but this is not

2534
02:05:10,800 --> 02:05:14,400
a topic for today's

2535
02:05:14,400 --> 02:05:17,440
talk so

2536
02:05:17,440 --> 02:05:21,199
that's finding out now the interesting

2537
02:05:21,199 --> 02:05:22,560
part is

2538
02:05:22,560 --> 02:05:26,560
how that has been done because the log

2539
02:05:26,560 --> 02:05:27,119
file

2540
02:05:27,119 --> 02:05:30,480
is a bit stupid

2541
02:05:30,480 --> 02:05:34,320
the error log as i did show you is

2542
02:05:34,320 --> 02:05:38,320
mostly garbage so it starts with

2543
02:05:38,320 --> 02:05:41,360
some error level

2544
02:05:41,360 --> 02:05:45,280
process id which component caused it

2545
02:05:45,280 --> 02:05:48,639
and then the mod security is taking pain

2546
02:05:48,639 --> 02:05:49,360
to put

2547
02:05:49,360 --> 02:05:52,639
a lot of things in

2548
02:05:52,639 --> 02:05:55,440
square brackets which are basically key

2549
02:05:55,440 --> 02:05:56,480
uh

2550
02:05:56,480 --> 02:06:00,320
some form of key key value pairs

2551
02:06:00,320 --> 02:06:04,320
coming so in this case

2552
02:06:04,320 --> 02:06:07,360
the rule is error

2553
02:06:07,360 --> 02:06:11,040
log i think this is this sample

2554
02:06:11,040 --> 02:06:13,280
which is catching out everything from

2555
02:06:13,280 --> 02:06:14,239
the

2556
02:06:14,239 --> 02:06:18,239
key value pairs and

2557
02:06:18,239 --> 02:06:20,880
nicely when we earlier looked at all

2558
02:06:20,880 --> 02:06:22,320
kinds of

2559
02:06:22,320 --> 02:06:26,400
things which you can get out of spectics

2560
02:06:26,400 --> 02:06:31,440
by just having log information

2561
02:06:31,440 --> 02:06:34,960
by just discrete parts of logs

2562
02:06:34,960 --> 02:06:38,639
uh here it is uh

2563
02:06:38,639 --> 02:06:42,000
doing it in a way that

2564
02:06:42,000 --> 02:06:46,079
i have here already selected but if we

2565
02:06:46,079 --> 02:06:49,280
we probably need we can do it like that

2566
02:06:49,280 --> 02:06:52,960
so we can remove

2567
02:06:52,960 --> 02:06:56,719
that and see if we can see

2568
02:06:56,719 --> 02:07:00,320
so here is everything that we called

2569
02:07:00,320 --> 02:07:01,119
from the

2570
02:07:01,119 --> 02:07:04,560
log file is running

2571
02:07:04,560 --> 02:07:07,599
as nice the named array

2572
02:07:07,599 --> 02:07:10,880
in my case named attributes so

2573
02:07:10,880 --> 02:07:14,880
i can access all of these parts from

2574
02:07:14,880 --> 02:07:19,520
this uh log sheet

2575
02:07:19,520 --> 02:07:22,960
and uh actually for me

2576
02:07:22,960 --> 02:07:25,840
as i had to deal with the question from

2577
02:07:25,840 --> 02:07:26,880
one side

2578
02:07:26,880 --> 02:07:30,800
promoting user huge usage of

2579
02:07:30,800 --> 02:07:33,440
web application firewalls and dealing

2580
02:07:33,440 --> 02:07:34,800
with the customers

2581
02:07:34,800 --> 02:07:38,480
unhappy then this is a

2582
02:07:38,480 --> 02:07:41,760
really great way of getting the

2583
02:07:41,760 --> 02:07:44,239
information into easily visual

2584
02:07:44,239 --> 02:07:45,360
visualizable

2585
02:07:45,360 --> 02:07:50,320
way but there's also the question that

2586
02:07:50,320 --> 02:07:53,360
i did log some other information

2587
02:07:53,360 --> 02:07:55,839
into the

2588
02:07:57,360 --> 02:08:00,320
mod securities audit log namely

2589
02:08:00,320 --> 02:08:02,159
everything in the post requests

2590
02:08:02,159 --> 02:08:05,199
they are not in the error log

2591
02:08:05,199 --> 02:08:08,239
because in our zones configuration

2592
02:08:08,239 --> 02:08:11,679
platform configuration the log file is

2593
02:08:11,679 --> 02:08:15,040
usually uh accessible in the web server

2594
02:08:15,040 --> 02:08:15,360
for

2595
02:08:15,360 --> 02:08:17,599
clients meaning also for attackers so we

2596
02:08:17,599 --> 02:08:18,719
don't want

2597
02:08:18,719 --> 02:08:20,800
attackers to know that we're locking all

2598
02:08:20,800 --> 02:08:22,159
of the post requests

2599
02:08:22,159 --> 02:08:25,440
or this particular site is logging so

2600
02:08:25,440 --> 02:08:28,800
i'm using this only logging to

2601
02:08:28,800 --> 02:08:32,000
hidden audit log and there are

2602
02:08:32,000 --> 02:08:35,040
last sample i'm going to show you from

2603
02:08:35,040 --> 02:08:35,440
here

2604
02:08:35,440 --> 02:08:39,599
is exactly looking at these log files

2605
02:08:39,599 --> 02:08:42,560
i have here we can look at the

2606
02:08:42,560 --> 02:08:43,920
activities

2607
02:08:43,920 --> 02:08:47,840
sample but i have also here today's

2608
02:08:47,840 --> 02:08:51,280
requests for my own websites so the same

2609
02:08:51,280 --> 02:08:52,719
things you saw in the

2610
02:08:52,719 --> 02:08:56,719
dump sack and

2611
02:08:56,800 --> 02:09:01,040
again in this case i've configured the

2612
02:09:02,000 --> 02:09:05,360
apache to remote security to lock

2613
02:09:05,360 --> 02:09:08,800
audit log as json not as their

2614
02:09:08,800 --> 02:09:11,119
custom format which probably can also be

2615
02:09:11,119 --> 02:09:12,719
parsed but

2616
02:09:12,719 --> 02:09:16,470
isn't so nice and

2617
02:09:16,470 --> 02:09:17,840
[Music]

2618
02:09:17,840 --> 02:09:21,440
here i have oh sorry uh how do it log

2619
02:09:21,440 --> 02:09:22,639
and if i take a

2620
02:09:22,639 --> 02:09:26,639
row so here is all of the answer

2621
02:09:26,639 --> 02:09:29,520
of the all of the audit log of mod

2622
02:09:29,520 --> 02:09:30,960
security

2623
02:09:30,960 --> 02:09:34,480
available in nicely formatted way

2624
02:09:34,480 --> 02:09:35,440
because it's coming

2625
02:09:35,440 --> 02:09:38,800
as json we could also probably use a

2626
02:09:38,800 --> 02:09:40,079
json viewer

2627
02:09:40,079 --> 02:09:43,360
and yes on command line you can also

2628
02:09:43,360 --> 02:09:46,560
parse json and select

2629
02:09:46,560 --> 02:09:50,400
information from there but again

2630
02:09:50,400 --> 02:09:53,440
why use kazoostek when you can use

2631
02:09:53,440 --> 02:09:56,719
better tools that actually save you time

2632
02:09:56,719 --> 02:09:58,840
and also are more accessible to more

2633
02:09:58,840 --> 02:10:00,639
people because

2634
02:10:00,639 --> 02:10:04,480
finding people who are able to use scrap

2635
02:10:04,480 --> 02:10:07,520
it's it's it's uh this is a very

2636
02:10:07,520 --> 02:10:09,679
expensive kind of people who know

2637
02:10:09,679 --> 02:10:12,400
actually how to use crap i've been uh

2638
02:10:12,400 --> 02:10:14,719
maybe from our let's say experience with

2639
02:10:14,719 --> 02:10:16,480
40 000 websites

2640
02:10:16,480 --> 02:10:19,119
uh hundreds and hundreds and hundreds of

2641
02:10:19,119 --> 02:10:20,000
developers

2642
02:10:20,000 --> 02:10:22,960
if i get them to look at the log file in

2643
02:10:22,960 --> 02:10:23,360
uh

2644
02:10:23,360 --> 02:10:26,239
x in the format of excel export it from

2645
02:10:26,239 --> 02:10:27,040
spectix

2646
02:10:27,040 --> 02:10:31,040
i'm already in heaven

2647
02:10:31,040 --> 02:10:33,840
usually they're just coming back next

2648
02:10:33,840 --> 02:10:34,560
time

2649
02:10:34,560 --> 02:10:37,679
and asking me for a next excel file

2650
02:10:37,679 --> 02:10:39,280
which i'm happy to provide because it's

2651
02:10:39,280 --> 02:10:42,800
for me it's a couple of lines of shell

2652
02:10:42,800 --> 02:10:44,800
so but here we are seeing the request

2653
02:10:44,800 --> 02:10:46,400
that has come in in

2654
02:10:46,400 --> 02:10:49,599
and here we are seeing again

2655
02:10:49,599 --> 02:10:52,159
the same

2656
02:10:52,719 --> 02:10:56,079
login attempts that we saw earlier

2657
02:10:56,079 --> 02:11:00,560
in this dumpster clock but in this time

2658
02:11:00,560 --> 02:11:01,599
they are not locked

2659
02:11:01,599 --> 02:11:03,760
nicely in a place in a way which is

2660
02:11:03,760 --> 02:11:04,800
better to

2661
02:11:04,800 --> 02:11:08,560
handle a systematic and

2662
02:11:08,560 --> 02:11:12,320
what i especially like and what is my

2663
02:11:12,320 --> 02:11:15,360
i think one of my next projects uh when

2664
02:11:15,360 --> 02:11:16,000
i did the

2665
02:11:16,000 --> 02:11:17,840
presentation in january there was a

2666
02:11:17,840 --> 02:11:20,960
question about uh

2667
02:11:20,960 --> 02:11:24,000
next talk and i'm actually planning

2668
02:11:24,000 --> 02:11:27,920
uh something for end of uh

2669
02:11:27,920 --> 02:11:31,040
summer or fall

2670
02:11:31,040 --> 02:11:34,159
to work more on the question of using

2671
02:11:34,159 --> 02:11:35,360
exactly this way

2672
02:11:35,360 --> 02:11:38,719
of logging on honeypots the traffic

2673
02:11:38,719 --> 02:11:42,079
coming from scanners and looking for

2674
02:11:42,079 --> 02:11:44,000
different kinds of vulnerabilities

2675
02:11:44,000 --> 02:11:46,719
so i'm trying to turn this information

2676
02:11:46,719 --> 02:11:48,000
into

2677
02:11:48,000 --> 02:11:50,880
uh better mode security rules to protect

2678
02:11:50,880 --> 02:11:52,079
our

2679
02:11:52,079 --> 02:11:55,759
farm so okay

2680
02:11:58,079 --> 02:12:00,880
uh-huh okay yeah yeah you come here

2681
02:12:00,880 --> 02:12:03,360
mention me

2682
02:12:04,840 --> 02:12:06,000
um

2683
02:12:06,000 --> 02:12:10,239
there is a question uh

2684
02:12:10,320 --> 02:12:12,880
how you upload initially the log files

2685
02:12:12,880 --> 02:12:13,920
in

2686
02:12:13,920 --> 02:12:17,679
spectics okay

2687
02:12:18,000 --> 02:12:22,159
i'll show you in a second i think i can

2688
02:12:22,159 --> 02:12:27,440
do it in a way that let's see

2689
02:12:27,520 --> 02:12:30,400
i have my local spectic instance which

2690
02:12:30,400 --> 02:12:31,360
is probably

2691
02:12:31,360 --> 02:12:35,040
good for that and for that

2692
02:12:35,040 --> 02:12:38,560
i have configured here under uh

2693
02:12:38,560 --> 02:12:42,159
system a datastore

2694
02:12:42,159 --> 02:12:45,199
just by telling that datastore is

2695
02:12:45,199 --> 02:12:49,759
uh is uh

2696
02:12:50,159 --> 02:12:53,679
oh sorry uh data stores spectix

2697
02:12:53,679 --> 02:12:57,760
sorry uh i think configure

2698
02:12:57,760 --> 02:13:00,880
yeah so i have on my desktop

2699
02:13:00,880 --> 02:13:03,920
or whatever preferable location

2700
02:13:03,920 --> 02:13:07,679
i do have the log files

2701
02:13:07,679 --> 02:13:11,599
folders so basically with

2702
02:13:11,599 --> 02:13:14,880
all of these samples that work exactly

2703
02:13:14,880 --> 02:13:17,119
the same way on my local install and on

2704
02:13:17,119 --> 02:13:18,880
the remote install

2705
02:13:18,880 --> 02:13:22,000
i'm using in the samples which

2706
02:13:22,000 --> 02:13:25,360
are from here like these

2707
02:13:25,360 --> 02:13:28,880
i'm using here as the source location

2708
02:13:28,880 --> 02:13:31,760
file spectix which is just this data

2709
02:13:31,760 --> 02:13:32,480
store

2710
02:13:32,480 --> 02:13:34,800
that points to the folder on my desktop

2711
02:13:34,800 --> 02:13:37,920
yes my desktop looks like a total mess

2712
02:13:37,920 --> 02:13:42,159
and then this way all of the

2713
02:13:42,159 --> 02:13:45,360
log files are just accessible from this

2714
02:13:45,360 --> 02:13:47,840
location

2715
02:13:47,840 --> 02:13:51,679
as there are there is of course a lot of

2716
02:13:51,679 --> 02:13:56,079
better solutions for data stores

2717
02:13:56,079 --> 02:13:59,760
the list of these is here i

2718
02:13:59,760 --> 02:14:03,119
think they a lot of their

2719
02:14:03,119 --> 02:14:07,040
own examples are using

2720
02:14:07,159 --> 02:14:10,800
s3 you can

2721
02:14:10,800 --> 02:14:14,320
access files over ssh

2722
02:14:14,320 --> 02:14:16,960
which probably isn't the the best

2723
02:14:16,960 --> 02:14:18,079
solution for

2724
02:14:18,079 --> 02:14:21,360
processing large log files

2725
02:14:21,360 --> 02:14:24,880
and there is a

2726
02:14:24,880 --> 02:14:29,360
possibility to access elasticsearch

2727
02:14:29,360 --> 02:14:31,760
so i was experimenting with

2728
02:14:31,760 --> 02:14:32,719
elasticsearch

2729
02:14:32,719 --> 02:14:35,599
unfortunately i think i can't find the

2730
02:14:35,599 --> 02:14:37,199
example quickly

2731
02:14:37,199 --> 02:14:40,639
so we started doing some

2732
02:14:40,639 --> 02:14:44,719
internal scans for our farm to find

2733
02:14:44,719 --> 02:14:47,679
elastic instances forgotten open and

2734
02:14:47,679 --> 02:14:49,280
without password

2735
02:14:49,280 --> 02:14:53,599
so i just i i was thinking that hmm

2736
02:14:53,599 --> 02:14:55,440
how to access that what's the easiest

2737
02:14:55,440 --> 02:14:56,639
way to just

2738
02:14:56,639 --> 02:14:59,440
access the raw elasticsearch server and

2739
02:14:59,440 --> 02:15:01,840
of course it was just

2740
02:15:01,840 --> 02:15:06,159
using the spectix to connect to

2741
02:15:06,159 --> 02:15:09,040
this particular server we had found from

2742
02:15:09,040 --> 02:15:09,679
our

2743
02:15:09,679 --> 02:15:13,920
scan and can anybody predict

2744
02:15:13,920 --> 02:15:18,639
what we found inside elasticsearch

2745
02:15:20,840 --> 02:15:22,000
server

2746
02:15:22,000 --> 02:15:25,599
okay okay cool

2747
02:15:25,599 --> 02:15:28,800
yeah and

2748
02:15:28,800 --> 02:15:33,360
the the answer of what's inside a

2749
02:15:33,360 --> 02:15:36,239
common elasticsearch server without

2750
02:15:36,239 --> 02:15:37,760
password

2751
02:15:37,760 --> 02:15:42,000
is ransom note of course

2752
02:15:42,000 --> 02:15:45,119
so if there is a unprotected server you

2753
02:15:45,119 --> 02:15:47,040
probably are going to get

2754
02:15:47,040 --> 02:15:51,119
get a possibility to pay bitcoins to get

2755
02:15:51,119 --> 02:15:52,159
your server

2756
02:15:52,159 --> 02:15:55,520
back so this is how how it

2757
02:15:55,520 --> 02:15:59,440
works we are kindly nearing the time

2758
02:15:59,440 --> 02:16:02,719
of of uh

2759
02:16:02,719 --> 02:16:06,000
two and a half hours that

2760
02:16:06,000 --> 02:16:09,280
and i presume people already thinking

2761
02:16:09,280 --> 02:16:10,880
about

2762
02:16:10,880 --> 02:16:15,119
going and grabbing their beers

2763
02:16:15,119 --> 02:16:18,400
so a currently is a

2764
02:16:18,400 --> 02:16:21,599
nice point to ask

2765
02:16:21,599 --> 02:16:25,360
any questions on

2766
02:16:25,360 --> 02:16:29,520
workshop chapter questions

2767
02:16:29,520 --> 02:16:34,639
channel so i can possibly

2768
02:16:35,519 --> 02:16:39,040
find some more nuances to tell you about

2769
02:16:39,040 --> 02:16:40,318
the tools

2770
02:16:40,318 --> 02:16:44,240
but as i mentioned

2771
02:16:44,240 --> 02:16:47,840
all of the

2772
02:16:50,080 --> 02:16:53,439
yeah and uh everything is

2773
02:16:53,439 --> 02:16:57,280
on what it was see timer decaf

2774
02:16:57,280 --> 02:17:01,120
but you files

2775
02:17:01,120 --> 02:17:05,519
so there's the readme and

2776
02:17:06,398 --> 02:17:09,840
all of the things that i shoot

2777
02:17:09,840 --> 02:17:15,439
are accessible from

2778
02:17:15,439 --> 02:17:19,920
these guitar brappers or gists

2779
02:17:19,920 --> 02:17:24,160
and there may be with them

2780
02:17:24,160 --> 02:17:28,558
sometimes a problem that uh

2781
02:17:28,558 --> 02:17:31,679
some things may be a bit

2782
02:17:31,679 --> 02:17:35,679
specific to our platform

2783
02:17:35,679 --> 02:17:39,200
for example i noticed that my code here

2784
02:17:39,200 --> 02:17:39,840
of this

2785
02:17:39,840 --> 02:17:41,519
buff handler which is nicely sending

2786
02:17:41,519 --> 02:17:43,120
emails oh by the way

2787
02:17:43,120 --> 02:17:45,760
it also has support for slack channel

2788
02:17:45,760 --> 02:17:46,879
perhaps you

2789
02:17:46,879 --> 02:17:50,879
noticed from from code i

2790
02:17:50,879 --> 02:17:52,638
almost was coming to the point of

2791
02:17:52,638 --> 02:17:55,519
thinking how i can integrate that to the

2792
02:17:55,519 --> 02:18:00,398
today's chat

2793
02:18:00,398 --> 02:18:03,200
because there's also possibility to put

2794
02:18:03,200 --> 02:18:03,599
to

2795
02:18:03,599 --> 02:18:06,240
discord but i didn't have time for that

2796
02:18:06,240 --> 02:18:07,439
but anyway

2797
02:18:07,439 --> 02:18:11,280
some some of these may

2798
02:18:11,280 --> 02:18:14,318
yeah yeah and uh yeah joking is

2799
02:18:14,318 --> 02:18:16,799
mentioning i could actually

2800
02:18:16,799 --> 02:18:21,519
add this these links also to the chat so

2801
02:18:21,519 --> 02:18:25,840
so to summarize

2802
02:18:28,080 --> 02:18:31,200
try for yourself

2803
02:18:36,840 --> 02:18:40,398
so uh

2804
02:18:40,478 --> 02:18:43,519
yes let's see come on yes

2805
02:18:43,519 --> 02:18:47,040
so uh the link is also now on the

2806
02:18:47,040 --> 02:18:50,160
chat i should have actually added them

2807
02:18:50,160 --> 02:18:53,359
earlier also there i kind of forgot

2808
02:18:53,359 --> 02:18:56,318
with all of the monitors all of the

2809
02:18:56,318 --> 02:18:57,280
places

2810
02:18:57,280 --> 02:19:00,799
but uh yes

2811
02:19:00,799 --> 02:19:04,080
that's if there is no more questions

2812
02:19:04,080 --> 02:19:04,718
then

2813
02:19:04,718 --> 02:19:07,840
that's the story of

2814
02:19:07,840 --> 02:19:12,478
today i'll be leaving

2815
02:19:12,478 --> 02:19:16,718
all of the instances that you see here

2816
02:19:16,718 --> 02:19:20,959
up i will remove the

2817
02:19:20,959 --> 02:19:24,558
sea timer from the wuhan tomorrow

2818
02:19:24,558 --> 02:19:27,280
to just and please don't trust the

2819
02:19:27,280 --> 02:19:28,000
server

2820
02:19:28,000 --> 02:19:30,558
until that

2821
02:19:31,120 --> 02:19:34,240
but you can try and see all of the parts

2822
02:19:34,240 --> 02:19:37,760
for yourself and uh play with the

2823
02:19:37,760 --> 02:19:41,040
spectix instance or and get your

2824
02:19:41,040 --> 02:19:44,799
own versions because and i'm not uh

2825
02:19:44,799 --> 02:19:46,718
to make it clear i'm not a spectic

2826
02:19:46,718 --> 02:19:48,720
salesman i'm i think they're paying

2827
02:19:48,720 --> 02:19:49,920
customer number two

2828
02:19:49,920 --> 02:19:52,080
or something like that i had a very

2829
02:19:52,080 --> 02:19:53,040
special price

2830
02:19:53,040 --> 02:19:57,359
thanks to renee but uh i have been

2831
02:19:57,359 --> 02:20:00,319
really paying uh paying customer way

2832
02:20:00,319 --> 02:20:02,000
before they came out with

2833
02:20:02,000 --> 02:20:05,080
pricing plans that are accessible to

2834
02:20:05,080 --> 02:20:08,560
non-enterprise customers which i think

2835
02:20:08,560 --> 02:20:09,840
happened

2836
02:20:09,840 --> 02:20:13,520
uh now a couple of months ago

2837
02:20:13,520 --> 02:20:16,479
around the time when they also had the

2838
02:20:16,479 --> 02:20:18,000
chance to publish

2839
02:20:18,000 --> 02:20:22,720
some nice patterns for dealing with

2840
02:20:23,439 --> 02:20:27,760
the exchange problem

2841
02:20:27,760 --> 02:20:31,840
what was the name the chinese

2842
02:20:32,319 --> 02:20:34,160
extraditing the chinese from your

2843
02:20:34,160 --> 02:20:36,880
exchanges so

2844
02:20:36,880 --> 02:20:41,680
from that time i i'm really happy that

2845
02:20:41,680 --> 02:20:43,920
for past two years i had to tell that

2846
02:20:43,920 --> 02:20:45,520
okay this is a cool

2847
02:20:45,520 --> 02:20:47,680
cool tool go and find yourself an

2848
02:20:47,680 --> 02:20:49,760
enterprise shop where you can actually

2849
02:20:49,760 --> 02:20:52,160
get some people to buy that for you and

2850
02:20:52,160 --> 02:20:54,720
now i think the pricing for

2851
02:20:54,720 --> 02:20:58,560
entry-level commercial accounts is

2852
02:20:58,560 --> 02:21:00,880
comparable to let's say server license

2853
02:21:00,880 --> 02:21:02,640
for new relic

2854
02:21:02,640 --> 02:21:06,319
or another tool so it is very accessible

2855
02:21:06,319 --> 02:21:08,479
and

2856
02:21:09,120 --> 02:21:12,960
making my life much

2857
02:21:12,960 --> 02:21:16,880
easier making learning log analysis in

2858
02:21:16,880 --> 02:21:18,399
this way easier and

2859
02:21:18,399 --> 02:21:22,399
also making it possible to deal with

2860
02:21:22,399 --> 02:21:26,479
logs in a manner of incident handling

2861
02:21:26,479 --> 02:21:29,040
because while i could prepare a

2862
02:21:29,040 --> 02:21:31,120
possibility to send everything to

2863
02:21:31,120 --> 02:21:34,560
elk stack or somewhere i don't know

2864
02:21:34,560 --> 02:21:37,120
what and when exactly i need and i don't

2865
02:21:37,120 --> 02:21:39,040
know the questions i'm going to ask log

2866
02:21:39,040 --> 02:21:39,760
files

2867
02:21:39,760 --> 02:21:43,600
so i just like to run them against the

2868
02:21:43,600 --> 02:21:46,640
raw files and find the answers

2869
02:21:46,640 --> 02:21:55,840
basically like i d today

2870
02:21:58,640 --> 02:22:02,479
and as there don't seem to be any more

2871
02:22:02,479 --> 02:22:05,600
questions then

2872
02:22:05,600 --> 02:22:09,359
i will remain online i'll actually go

2873
02:22:09,359 --> 02:22:12,479
downstairs and grab a beer so

2874
02:22:12,479 --> 02:22:16,160
if there are any questions later in the

2875
02:22:16,160 --> 02:22:19,439
chat channels then hit me up i'll be

2876
02:22:19,439 --> 02:22:23,200
happy to answer in written form

2877
02:22:23,200 --> 02:22:27,840
and until that thanks for everybody for

2878
02:22:27,840 --> 02:22:31,280
joining and watching

2879
02:22:31,280 --> 02:22:34,479
i hope you learned something new

2880
02:22:34,479 --> 02:22:37,680
and i hope the presentation was

2881
02:22:37,680 --> 02:22:39,680
informative when you can actually copy

2882
02:22:39,680 --> 02:22:42,240
paste the components and try them out

2883
02:22:42,240 --> 02:22:46,160
on your mondays actual job

2884
02:22:46,160 --> 02:22:49,439
so with that i'm leaving you

2885
02:22:49,439 --> 02:22:51,600
with your beers i'm going to grab my

2886
02:22:51,600 --> 02:22:52,479
beer

2887
02:22:52,479 --> 02:22:56,319
and i think there is also a

2888
02:22:56,319 --> 02:22:59,760
closing video to be shown but i

2889
02:22:59,760 --> 02:23:02,880
recall i think the first video was

2890
02:23:02,880 --> 02:23:05,280
wrong one supposedly so maybe you are

2891
02:23:05,280 --> 02:23:07,359
going to get two videos for the price of

2892
02:23:07,359 --> 02:23:10,800
uh one so see you and

2893
02:23:10,800 --> 02:23:14,240
uh hopefully uh i can

2894
02:23:14,240 --> 02:23:16,640
show you something cool uh after the

2895
02:23:16,640 --> 02:23:31,840
summer break bye bye

2896
02:23:31,840 --> 02:23:43,200
[Music]

2897
02:23:43,200 --> 02:23:47,840
scare us

2898
02:23:50,340 --> 02:23:53,430
[Music]

2899
02:23:55,540 --> 02:24:02,589
[Music]

2900
02:24:06,230 --> 02:24:12,840
[Music]

2901
02:24:12,840 --> 02:24:15,840
again

2902
02:24:17,439 --> 02:24:19,520
you

