1
00:00:00,240 --> 00:00:03,280
i really hope that you will enjoy and uh

2
00:00:03,280 --> 00:00:06,720
please stay after the event uh for our

3
00:00:06,720 --> 00:00:08,160
after party it's gonna be

4
00:00:08,160 --> 00:00:11,599
epic and in and out

5
00:00:11,599 --> 00:00:17,920
cheers enjoy

6
00:00:27,370 --> 00:00:30,539
[Music]

7
00:00:36,850 --> 00:00:39,950
[Music]

8
00:00:48,719 --> 00:00:52,719
alrighty uh long time no see

9
00:00:52,719 --> 00:00:55,120
welcome to the uh from my point of view

10
00:00:55,120 --> 00:00:56,320
as well

11
00:00:56,320 --> 00:00:59,280
today we are going to have a forensics

12
00:00:59,280 --> 00:01:00,239
crash course

13
00:01:00,239 --> 00:01:03,280
uh which has been made to you by me

14
00:01:03,280 --> 00:01:06,400
with love of course and uh

15
00:01:06,400 --> 00:01:08,720
as this is the first iteration of this

16
00:01:08,720 --> 00:01:09,840
course uh

17
00:01:09,840 --> 00:01:13,600
there might be some hiccups so please be

18
00:01:13,600 --> 00:01:16,479
prepare yourself for those and uh if you

19
00:01:16,479 --> 00:01:18,560
have any feedback or questions

20
00:01:18,560 --> 00:01:20,720
please don't hesitate to ask them on the

21
00:01:20,720 --> 00:01:21,759
discord or

22
00:01:21,759 --> 00:01:24,880
twitch and somewhere i will

23
00:01:24,880 --> 00:01:27,360
probably see them and try to figure them

24
00:01:27,360 --> 00:01:30,479
out and of course my setup is

25
00:01:30,479 --> 00:01:34,320
still my own analysis setup for this

26
00:01:34,320 --> 00:01:37,680
course is still setting up so uh we will

27
00:01:37,680 --> 00:01:40,560
have to do it that as well in the first

28
00:01:40,560 --> 00:01:40,880
lap

29
00:01:40,880 --> 00:01:44,320
but let's uh start with the prestation

30
00:01:44,320 --> 00:01:47,360
why the slide is not moving okay so

31
00:01:47,360 --> 00:01:50,479
uh first of all uh this will be

32
00:01:50,479 --> 00:01:53,520
a pretty harsh two and a half hours i

33
00:01:53,520 --> 00:01:54,000
have tried

34
00:01:54,000 --> 00:01:57,360
to put a lot of stuff here so uh there

35
00:01:57,360 --> 00:01:58,320
might be

36
00:01:58,320 --> 00:02:00,719
uh after this some overhead on your side

37
00:02:00,719 --> 00:02:02,399
uh there is a lot of stuff

38
00:02:02,399 --> 00:02:06,000
and uh and so on so uh prepare yourself

39
00:02:06,000 --> 00:02:07,280
buckle up

40
00:02:07,280 --> 00:02:10,318
it's going to be a very bumpy ride

41
00:02:10,318 --> 00:02:13,440
at least for for for me so

42
00:02:13,440 --> 00:02:16,640
uh what we'll be cooking today uh i will

43
00:02:16,640 --> 00:02:18,480
give a short introduction to digital

44
00:02:18,480 --> 00:02:19,599
forensics and easy

45
00:02:19,599 --> 00:02:22,400
response then we will see some uh

46
00:02:22,400 --> 00:02:23,680
windows artifact

47
00:02:23,680 --> 00:02:27,200
stuff then hands-on lapse

48
00:02:27,200 --> 00:02:31,040
and in the end a ctf and as usual

49
00:02:31,040 --> 00:02:34,000
on my presentations there might be one

50
00:02:34,000 --> 00:02:34,840
or two

51
00:02:34,840 --> 00:02:37,920
memes uh between the slides uh

52
00:02:37,920 --> 00:02:41,280
sorry for that already so who am i

53
00:02:41,280 --> 00:02:43,200
uh my name is yuha yao here and my

54
00:02:43,200 --> 00:02:45,200
nickname is who is

55
00:02:45,200 --> 00:02:48,800
i'm 31 years old father of three

56
00:02:48,800 --> 00:02:51,840
cute kittos my

57
00:02:51,840 --> 00:02:55,440
studies were in the i.t

58
00:02:55,440 --> 00:02:57,680
in the in the university of applied

59
00:02:57,680 --> 00:03:00,560
sciences i graduated there from 2015 as

60
00:03:00,560 --> 00:03:02,400
a bachelor of engineering

61
00:03:02,400 --> 00:03:05,040
and now since then i have been doing the

62
00:03:05,040 --> 00:03:06,000
master's

63
00:03:06,000 --> 00:03:09,120
degree in university of turku and

64
00:03:09,120 --> 00:03:11,680
hopefully i will get my papers this year

65
00:03:11,680 --> 00:03:14,319
out of the school uh i have a few uh

66
00:03:14,319 --> 00:03:14,800
these

67
00:03:14,800 --> 00:03:18,480
uh upper approaches uh on me uh cisp

68
00:03:18,480 --> 00:03:19,200
oscp

69
00:03:19,200 --> 00:03:22,239
kremzy gzfa and gmon

70
00:03:22,239 --> 00:03:25,440
uh these are almost all of them are

71
00:03:25,440 --> 00:03:29,200
uh easy response related somehow

72
00:03:29,200 --> 00:03:31,360
and i have been doing digital forensics

73
00:03:31,360 --> 00:03:33,720
and easy response since 200

74
00:03:33,720 --> 00:03:37,599
2014 so uh around seven years

75
00:03:37,599 --> 00:03:40,159
this far i'm currently working for

76
00:03:40,159 --> 00:03:41,040
trafficom

77
00:03:41,040 --> 00:03:43,280
the national cyber security center of

78
00:03:43,280 --> 00:03:44,239
finland as

79
00:03:44,239 --> 00:03:45,760
information security specialists my

80
00:03:45,760 --> 00:03:47,599
tasks there are

81
00:03:47,599 --> 00:03:49,920
besides doing the normal operations

82
00:03:49,920 --> 00:03:52,640
malware analysis and some forensics as

83
00:03:52,640 --> 00:03:53,760
well

84
00:03:53,760 --> 00:03:57,439
i'm also ko founder of helsig

85
00:03:57,439 --> 00:04:00,239
so you might have seen my face in those

86
00:04:00,239 --> 00:04:01,200
events

87
00:04:01,200 --> 00:04:04,640
usually talking not that much

88
00:04:04,640 --> 00:04:08,080
tech stuff but more about the events

89
00:04:08,080 --> 00:04:11,200
shameless plug i also run uh

90
00:04:11,200 --> 00:04:13,280
this podcast turvakarayat which is

91
00:04:13,280 --> 00:04:15,040
encrypted in finnish so if you are

92
00:04:15,040 --> 00:04:16,720
finnish speaker

93
00:04:16,720 --> 00:04:19,120
you should give a try to that one as

94
00:04:19,120 --> 00:04:20,478
well

95
00:04:20,478 --> 00:04:23,759
my ko host antigurito is actually

96
00:04:23,759 --> 00:04:26,000
talking in the talk track during my

97
00:04:26,000 --> 00:04:28,639
presentation so unfortunately you and i

98
00:04:28,639 --> 00:04:30,479
cannot see it because of course you're

99
00:04:30,479 --> 00:04:31,440
staying here

100
00:04:31,440 --> 00:04:34,720
uh all the night long so uh uh that

101
00:04:34,720 --> 00:04:38,479
is that and also uh this course

102
00:04:38,479 --> 00:04:41,840
is actually i'm planning to make this

103
00:04:41,840 --> 00:04:43,040
same course

104
00:04:43,040 --> 00:04:46,880
a little bit wider i will make it

105
00:04:46,880 --> 00:04:50,960
a two or three day course sometime soon

106
00:04:50,960 --> 00:04:53,919
and we are go likely going to put it

107
00:04:53,919 --> 00:04:55,120
available

108
00:04:55,120 --> 00:04:58,320
for the national cyber defense

109
00:04:58,320 --> 00:05:00,560
training association of finland which is

110
00:05:00,560 --> 00:05:02,479
the ambek

111
00:05:02,479 --> 00:05:05,840
which logo is here so if you are i think

112
00:05:05,840 --> 00:05:07,440
you have to be finnish citizen to

113
00:05:07,440 --> 00:05:08,560
participate there

114
00:05:08,560 --> 00:05:11,199
but uh this course will be uh in in a

115
00:05:11,199 --> 00:05:12,240
wider level

116
00:05:12,240 --> 00:05:15,520
um there probably next

117
00:05:15,520 --> 00:05:18,560
year uh start of the next year and maybe

118
00:05:18,560 --> 00:05:21,840
uh if we get this all by someday back

119
00:05:21,840 --> 00:05:25,840
back to the uh scene after this uh

120
00:05:25,840 --> 00:05:28,880
horrible copy 19 situation

121
00:05:28,880 --> 00:05:32,080
probably we will uh we will have a

122
00:05:32,080 --> 00:05:35,039
course there as well so let's see

123
00:05:35,039 --> 00:05:36,880
before trafficking i was working for

124
00:05:36,880 --> 00:05:38,960
nixo which is finnish cyber security

125
00:05:38,960 --> 00:05:40,800
company i was doing their uh digital

126
00:05:40,800 --> 00:05:43,039
forensics incident response and malware

127
00:05:43,039 --> 00:05:46,320
analysis and before that at elisa

128
00:05:46,320 --> 00:05:48,639
same thing different title different

129
00:05:48,639 --> 00:05:50,240
company but but

130
00:05:50,240 --> 00:05:52,160
for the past 10 years i've been doing

131
00:05:52,160 --> 00:05:53,360
mostly the digital

132
00:05:53,360 --> 00:05:57,360
forensics and incent response

133
00:05:57,360 --> 00:05:59,759
the uh like marketing stuff and now we

134
00:05:59,759 --> 00:06:02,000
can get to the

135
00:06:02,000 --> 00:06:05,039
actual actual uh

136
00:06:05,039 --> 00:06:09,039
stuff forensic stuff first of all a

137
00:06:09,039 --> 00:06:10,240
disclaimer

138
00:06:10,240 --> 00:06:15,440
uh i'm holding this workshop as a

139
00:06:15,600 --> 00:06:19,440
as a person well as a private person so

140
00:06:19,440 --> 00:06:24,080
my views or my opinions are

141
00:06:24,080 --> 00:06:27,199
likely well may or may not be

142
00:06:27,199 --> 00:06:30,400
in in align with the uh finnish transfer

143
00:06:30,400 --> 00:06:32,800
and communications agency traffic com so

144
00:06:32,800 --> 00:06:33,600
please

145
00:06:33,600 --> 00:06:35,919
keep that in mind that i'm now speaking

146
00:06:35,919 --> 00:06:37,759
as a private person

147
00:06:37,759 --> 00:06:40,160
and this course material also includes

148
00:06:40,160 --> 00:06:41,600
malware

149
00:06:41,600 --> 00:06:43,919
so if you are planning to run it

150
00:06:43,919 --> 00:06:44,720
somewhere

151
00:06:44,720 --> 00:06:48,160
you probably will harm yourself and also

152
00:06:48,160 --> 00:06:51,280
others computers so repeating these

153
00:06:51,280 --> 00:06:52,000
tasks

154
00:06:52,000 --> 00:06:54,880
is it's it's on your own responsibility

155
00:06:54,880 --> 00:06:56,319
i'm not responsible

156
00:06:56,319 --> 00:06:58,000
on the actions you are doing during this

157
00:06:58,000 --> 00:07:00,000
work

158
00:07:00,000 --> 00:07:03,039
so what is the goal uh what what we want

159
00:07:03,039 --> 00:07:05,199
to achieve with this uh course we want

160
00:07:05,199 --> 00:07:07,280
to get more uh people interested in the

161
00:07:07,280 --> 00:07:08,560
digital forensics and

162
00:07:08,560 --> 00:07:10,720
get them going with the technical stuff

163
00:07:10,720 --> 00:07:11,919
stuff uh so

164
00:07:11,919 --> 00:07:14,160
i am not going to make you like super

165
00:07:14,160 --> 00:07:15,840
professionals during two and a half

166
00:07:15,840 --> 00:07:16,560
hours

167
00:07:16,560 --> 00:07:20,319
which is by the way absurd idea and

168
00:07:20,319 --> 00:07:21,919
but but i'm trying to give you some

169
00:07:21,919 --> 00:07:23,840
basic level information and

170
00:07:23,840 --> 00:07:27,440
maybe maybe uh some some something you

171
00:07:27,440 --> 00:07:28,000
can

172
00:07:28,000 --> 00:07:31,199
work work more in the

173
00:07:31,199 --> 00:07:33,520
future

174
00:07:37,680 --> 00:07:42,240
first of all i will introduce you

175
00:07:42,240 --> 00:07:45,280
forensics story why i will

176
00:07:45,280 --> 00:07:47,919
uh let you know about this in the in the

177
00:07:47,919 --> 00:07:49,440
first place

178
00:07:49,440 --> 00:07:52,000
it is because it was new to me as well

179
00:07:52,000 --> 00:07:52,960
it's a

180
00:07:52,960 --> 00:07:56,720
project that can actually you can use

181
00:07:56,720 --> 00:07:59,919
to collect forensic evidence in a single

182
00:07:59,919 --> 00:08:01,919
database file and then investigate the

183
00:08:01,919 --> 00:08:03,680
database file

184
00:08:03,680 --> 00:08:07,759
so this is basically

185
00:08:07,759 --> 00:08:10,479
one archive that has all the evidence

186
00:08:10,479 --> 00:08:10,800
from

187
00:08:10,800 --> 00:08:13,039
single machine and we are going to use

188
00:08:13,039 --> 00:08:14,800
it today so

189
00:08:14,800 --> 00:08:18,800
so uh what i would like you to do

190
00:08:18,800 --> 00:08:22,720
uh is to go to the github

191
00:08:22,720 --> 00:08:25,599
and install the uh install the

192
00:08:25,599 --> 00:08:27,440
elementary

193
00:08:27,440 --> 00:08:30,240
elementary tool on your machine i will

194
00:08:30,240 --> 00:08:32,159
do it when we get to the labs on my

195
00:08:32,159 --> 00:08:33,200
machine as well

196
00:08:33,200 --> 00:08:36,159
so if if you now are not willing to do

197
00:08:36,159 --> 00:08:37,120
it or cannot

198
00:08:37,120 --> 00:08:39,200
don't know how to do it you can wait

199
00:08:39,200 --> 00:08:40,159
until that

200
00:08:40,159 --> 00:08:43,039
but here is the stuff you should install

201
00:08:43,039 --> 00:08:43,440
uh

202
00:08:43,440 --> 00:08:45,760
elementary is uh is a tool that can

203
00:08:45,760 --> 00:08:47,440
analyze the forensic store

204
00:08:47,440 --> 00:08:51,200
files and uh for example we can actually

205
00:08:51,200 --> 00:08:54,160
unpack them as well these evidence has

206
00:08:54,160 --> 00:08:56,240
been taken out from the machines using

207
00:08:56,240 --> 00:08:58,800
the artifact collector so that's the way

208
00:08:58,800 --> 00:09:01,200
we are using the forensic store format

209
00:09:01,200 --> 00:09:03,600
in this analysis

210
00:09:03,600 --> 00:09:06,000
and do it now if you want to we are

211
00:09:06,000 --> 00:09:06,880
doing it

212
00:09:06,880 --> 00:09:09,600
in the first lab section as well so

213
00:09:09,600 --> 00:09:11,839
together so if you

214
00:09:11,839 --> 00:09:13,680
are not willing to do it now you can do

215
00:09:13,680 --> 00:09:17,680
it then wait a minute i'll open the

216
00:09:18,560 --> 00:09:22,000
this one as well so i can see

217
00:09:22,000 --> 00:09:25,279
the questions so no questions yet

218
00:09:25,279 --> 00:09:28,000
all right

219
00:09:29,200 --> 00:09:32,160
all right so uh let's talk about the

220
00:09:32,160 --> 00:09:33,920
digital forensics and incident

221
00:09:33,920 --> 00:09:37,519
response stuff as well

222
00:09:37,519 --> 00:09:40,560
it's a mystery i i i think a lot of

223
00:09:40,560 --> 00:09:41,040
people

224
00:09:41,040 --> 00:09:43,360
think it's it's some kind of uh black

225
00:09:43,360 --> 00:09:44,320
magic that

226
00:09:44,320 --> 00:09:46,320
people find out the stuff from the

227
00:09:46,320 --> 00:09:47,680
machines but it's

228
00:09:47,680 --> 00:09:50,959
actually pretty simple and uh

229
00:09:50,959 --> 00:09:54,000
it's basically digging uh

230
00:09:54,000 --> 00:09:56,959
i wouldn't say but it's digging uh

231
00:09:56,959 --> 00:09:58,480
like a needle from a

232
00:09:58,480 --> 00:10:01,279
hain stack so uh you just fine try to

233
00:10:01,279 --> 00:10:02,160
find uh

234
00:10:02,160 --> 00:10:04,720
some stuff from from a machine and uh

235
00:10:04,720 --> 00:10:05,440
the

236
00:10:05,440 --> 00:10:08,240
process is pretty straightforward so if

237
00:10:08,240 --> 00:10:10,079
you have any

238
00:10:10,079 --> 00:10:13,680
so if you have any any any uh

239
00:10:13,680 --> 00:10:16,959
doubts about it i i hope that today you

240
00:10:16,959 --> 00:10:19,279
lose them and uh realize that that it's

241
00:10:19,279 --> 00:10:20,959
it's it's not a black magic

242
00:10:20,959 --> 00:10:23,200
and uh it is actually something that

243
00:10:23,200 --> 00:10:25,440
everyone can do

244
00:10:25,440 --> 00:10:27,600
so why do we do forensics uh first of

245
00:10:27,600 --> 00:10:28,560
all uh

246
00:10:28,560 --> 00:10:31,360
this uh quote is from robert mueller who

247
00:10:31,360 --> 00:10:32,880
was fbi director

248
00:10:32,880 --> 00:10:35,519
back in the days uh he said that there

249
00:10:35,519 --> 00:10:36,320
are only two

250
00:10:36,320 --> 00:10:38,480
type of companies those that have been

251
00:10:38,480 --> 00:10:40,160
hacked and those that will be

252
00:10:40,160 --> 00:10:43,920
well i i don't think so because i i

253
00:10:43,920 --> 00:10:46,160
actually agree more with the uh john

254
00:10:46,160 --> 00:10:47,360
chambers from the

255
00:10:47,360 --> 00:10:50,720
cisco that he he thinks that there have

256
00:10:50,720 --> 00:10:54,720
there are two types of companies that uh

257
00:10:54,720 --> 00:10:57,040
that already have been hacked and those

258
00:10:57,040 --> 00:10:58,000
who don't know

259
00:10:58,000 --> 00:11:01,360
they have been hacked so uh this this

260
00:11:01,360 --> 00:11:03,440
statement uh difference between those

261
00:11:03,440 --> 00:11:04,720
these two quotes

262
00:11:04,720 --> 00:11:07,440
i i think uh perfectly describes the

263
00:11:07,440 --> 00:11:10,320
need of forensics because

264
00:11:10,320 --> 00:11:13,519
the companies are lacking uh skills of

265
00:11:13,519 --> 00:11:15,519
investigating the incident so that

266
00:11:15,519 --> 00:11:17,839
there are no people who can find out

267
00:11:17,839 --> 00:11:19,279
those incidents of what how

268
00:11:19,279 --> 00:11:21,440
wide they are so basically in the

269
00:11:21,440 --> 00:11:23,200
incident response part they're going

270
00:11:23,200 --> 00:11:25,120
straight from the identification to the

271
00:11:25,120 --> 00:11:26,720
remediation and recovery

272
00:11:26,720 --> 00:11:28,560
which is really bad and that's the

273
00:11:28,560 --> 00:11:30,720
reason why we need more forensics

274
00:11:30,720 --> 00:11:33,920
uh in in the in the industry

275
00:11:33,920 --> 00:11:37,120
and uh that's why why a company should

276
00:11:37,120 --> 00:11:38,959
pay attention to it so if you are

277
00:11:38,959 --> 00:11:40,560
working on a company or

278
00:11:40,560 --> 00:11:42,480
national level or any organization you

279
00:11:42,480 --> 00:11:44,720
should definitely say that we need this

280
00:11:44,720 --> 00:11:45,839
forensics

281
00:11:45,839 --> 00:11:49,440
skills in our company as well

282
00:11:50,000 --> 00:11:53,360
okay so uh let's talk about the

283
00:11:53,360 --> 00:11:55,519
anatomy of cyber attack this is actually

284
00:11:55,519 --> 00:11:56,880
from metra

285
00:11:56,880 --> 00:12:00,000
attack metrics uh this is uh

286
00:12:00,000 --> 00:12:03,040
how how would i say i i made it uh based

287
00:12:03,040 --> 00:12:03,760
on on

288
00:12:03,760 --> 00:12:07,279
on how how the intrusion is is

289
00:12:07,279 --> 00:12:10,320
done based on that matrix so

290
00:12:10,320 --> 00:12:12,200
basically it starts with the

291
00:12:12,200 --> 00:12:14,399
pre-exploitation uh recognition is

292
00:12:14,399 --> 00:12:16,880
scanning information gathering fishing

293
00:12:16,880 --> 00:12:18,800
for information so gathering

294
00:12:18,800 --> 00:12:21,920
uh data about the company

295
00:12:21,920 --> 00:12:25,200
os and so on so this this is the phase

296
00:12:25,200 --> 00:12:26,320
that

297
00:12:26,320 --> 00:12:28,399
all targets are basically or

298
00:12:28,399 --> 00:12:29,519
organizations are

299
00:12:29,519 --> 00:12:32,000
vulnerable to they are letting

300
00:12:32,000 --> 00:12:33,519
information online and

301
00:12:33,519 --> 00:12:36,880
uh attackers may collect it and uh plan

302
00:12:36,880 --> 00:12:39,200
and attack against the companies

303
00:12:39,200 --> 00:12:42,240
this is okay basically because there is

304
00:12:42,240 --> 00:12:43,760
um

305
00:12:43,760 --> 00:12:47,120
nothing basically hasn't yet happened so

306
00:12:47,120 --> 00:12:50,240
so we don't mind about that in when we

307
00:12:50,240 --> 00:12:52,240
talk about forensics of course this kind

308
00:12:52,240 --> 00:12:54,079
of information is nice to

309
00:12:54,079 --> 00:12:57,040
know when you start to investigate an

310
00:12:57,040 --> 00:12:59,360
incident for example if you know an apt

311
00:12:59,360 --> 00:13:02,480
has been scanning your network and

312
00:13:02,480 --> 00:13:06,160
so on so you you might want to collect

313
00:13:06,160 --> 00:13:09,920
ttps from that

314
00:13:09,920 --> 00:13:12,720
intruder uh to make attribution and and

315
00:13:12,720 --> 00:13:14,880
detect who is trying to attack you

316
00:13:14,880 --> 00:13:17,920
or who is attacking you then

317
00:13:17,920 --> 00:13:22,479
comes the uh what was that

318
00:13:22,720 --> 00:13:25,040
questions could you paste installation

319
00:13:25,040 --> 00:13:25,760
links

320
00:13:25,760 --> 00:13:28,480
including the ouija blah blah blah i

321
00:13:28,480 --> 00:13:30,320
will actually

322
00:13:30,320 --> 00:13:35,839
i will actually show you something

323
00:13:38,160 --> 00:13:41,519
so i will paste you something better

324
00:13:41,519 --> 00:13:44,800
i will paste you the slides

325
00:13:44,880 --> 00:13:49,760
so uh

326
00:13:49,760 --> 00:13:54,000
there you go there is the uh

327
00:13:54,000 --> 00:13:57,040
directory uh of of the files uh the

328
00:13:57,040 --> 00:13:59,360
first one is is the uh

329
00:13:59,360 --> 00:14:02,079
uh these lights of course some of them

330
00:14:02,079 --> 00:14:03,680
are redacted from that one

331
00:14:03,680 --> 00:14:06,800
and then there is this materials.7 chip

332
00:14:06,800 --> 00:14:09,519
you should download there is and also

333
00:14:09,519 --> 00:14:10,959
extract there is

334
00:14:10,959 --> 00:14:12,720
materials of the of the course we will

335
00:14:12,720 --> 00:14:14,320
go through them

336
00:14:14,320 --> 00:14:16,800
during the first lap but as i got asked

337
00:14:16,800 --> 00:14:18,320
now about the uh

338
00:14:18,320 --> 00:14:20,880
the uh instructions i decided to show

339
00:14:20,880 --> 00:14:23,120
you this one

340
00:14:23,120 --> 00:14:26,959
so i'll close that one and that one

341
00:14:26,959 --> 00:14:30,560
and okay that one can open

342
00:14:30,560 --> 00:14:33,040
all right so let's continue so uh where

343
00:14:33,040 --> 00:14:34,000
was i so

344
00:14:34,000 --> 00:14:37,519
uh the forensics basically start on the

345
00:14:37,519 --> 00:14:38,560
intrusion so

346
00:14:38,560 --> 00:14:41,120
this is the phase we want to see uh we

347
00:14:41,120 --> 00:14:42,880
want to catch the attacker

348
00:14:42,880 --> 00:14:44,959
well this is the first phase we would

349
00:14:44,959 --> 00:14:46,240
like to catch them

350
00:14:46,240 --> 00:14:48,800
and basically the preparation is the

351
00:14:48,800 --> 00:14:50,800
last part where we would like to catch

352
00:14:50,800 --> 00:14:51,279
them

353
00:14:51,279 --> 00:14:53,680
if we catch them after actions on

354
00:14:53,680 --> 00:14:54,959
objective

355
00:14:54,959 --> 00:14:57,279
we basically have lost the game but if

356
00:14:57,279 --> 00:14:58,320
we win

357
00:14:58,320 --> 00:15:01,199
if we detect them and kick them out and

358
00:15:01,199 --> 00:15:01,760
do the

359
00:15:01,760 --> 00:15:04,160
higher process before they could get to

360
00:15:04,160 --> 00:15:05,839
the actions of objective

361
00:15:05,839 --> 00:15:09,519
or objectives then we are the winners

362
00:15:09,519 --> 00:15:11,519
the blue team will race again and we

363
00:15:11,519 --> 00:15:12,639
will win so

364
00:15:12,639 --> 00:15:15,920
uh keep this in mind that when you are

365
00:15:15,920 --> 00:15:17,519
doing digital forensics and incident

366
00:15:17,519 --> 00:15:18,160
response

367
00:15:18,160 --> 00:15:21,440
that you need to uh you nee you should

368
00:15:21,440 --> 00:15:21,839
be

369
00:15:21,839 --> 00:15:25,199
as fast as possible but

370
00:15:25,199 --> 00:15:28,399
it is enough if you are faster than the

371
00:15:28,399 --> 00:15:28,880
uh

372
00:15:28,880 --> 00:15:32,399
attacker is is uh on their uh on their

373
00:15:32,399 --> 00:15:40,160
uh actions on your objective

374
00:15:40,160 --> 00:15:43,440
okay so uh so that was uh

375
00:15:43,440 --> 00:15:46,000
uh about the uh cyber attack but uh keep

376
00:15:46,000 --> 00:15:47,600
in mind when when detecting

377
00:15:47,600 --> 00:15:50,000
some some of the stuff from the uh from

378
00:15:50,000 --> 00:15:50,959
the evidence

379
00:15:50,959 --> 00:15:54,639
uh uh think which part of the attack i'm

380
00:15:54,639 --> 00:15:55,279
now

381
00:15:55,279 --> 00:15:58,160
trying to investigate and find out if

382
00:15:58,160 --> 00:15:58,480
you

383
00:15:58,480 --> 00:16:02,160
are able to uh do the uh

384
00:16:02,160 --> 00:16:06,639
process before the attacker tries to

385
00:16:06,639 --> 00:16:10,720
do the uh well steal the crown jewels

386
00:16:10,720 --> 00:16:14,320
and also uh you should be able to

387
00:16:14,320 --> 00:16:17,120
map those uh stuff what they are doing

388
00:16:17,120 --> 00:16:18,000
to these

389
00:16:18,000 --> 00:16:21,759
these faces of of a cyber attack

390
00:16:21,759 --> 00:16:25,519
so what is this metre attack uh

391
00:16:25,519 --> 00:16:29,839
well matrix uh it's a taxonomy for

392
00:16:29,839 --> 00:16:32,880
different uh different phases of the

393
00:16:32,880 --> 00:16:33,759
process

394
00:16:33,759 --> 00:16:36,079
and also different mechanisms that the

395
00:16:36,079 --> 00:16:37,279
attacker is using

396
00:16:37,279 --> 00:16:39,759
and i i have always said that this is

397
00:16:39,759 --> 00:16:41,839
actually important to understand from

398
00:16:41,839 --> 00:16:44,240
from both perspective the red team and

399
00:16:44,240 --> 00:16:45,680
also the blue team so

400
00:16:45,680 --> 00:16:48,560
so uh as a red team you will get some

401
00:16:48,560 --> 00:16:50,079
idea what should you do next

402
00:16:50,079 --> 00:16:53,360
and if you are a commercial red team

403
00:16:53,360 --> 00:16:55,759
doing red team assignments

404
00:16:55,759 --> 00:16:59,120
you would like to report your uh

405
00:16:59,120 --> 00:17:01,920
actions to the customer so that's the

406
00:17:01,920 --> 00:17:03,920
reason why

407
00:17:03,920 --> 00:17:07,280
why why

408
00:17:07,280 --> 00:17:09,919
why you should know this one and also

409
00:17:09,919 --> 00:17:11,039
this would easily

410
00:17:11,039 --> 00:17:14,079
make your life more easy when you do the

411
00:17:14,079 --> 00:17:16,400
reporting stuff so you can a map

412
00:17:16,400 --> 00:17:18,799
map your actions to these uh taxonomy

413
00:17:18,799 --> 00:17:21,520
taxonomy

414
00:17:22,959 --> 00:17:26,160
techniques and tactics

415
00:17:27,520 --> 00:17:30,400
and on the blue team side as i said you

416
00:17:30,400 --> 00:17:31,039
need to

417
00:17:31,039 --> 00:17:34,240
map the actions to these faces of an

418
00:17:34,240 --> 00:17:36,000
attack

419
00:17:36,000 --> 00:17:37,440
it's easier to do when you have this

420
00:17:37,440 --> 00:17:39,360
kind of taxonomy where you can just look

421
00:17:39,360 --> 00:17:41,760
uh what does this mean and if there is

422
00:17:41,760 --> 00:17:43,360
actually a number for it for the

423
00:17:43,360 --> 00:17:44,160
technique

424
00:17:44,160 --> 00:17:47,440
you can report the that one uh to the uh

425
00:17:47,440 --> 00:17:49,840
forward and and it is actually easier to

426
00:17:49,840 --> 00:17:51,360
direct if the uh

427
00:17:51,360 --> 00:17:54,960
if the uh uh attacker has finished their

428
00:17:54,960 --> 00:17:57,840
their objectives uh which are in the

429
00:17:57,840 --> 00:18:00,000
right corner the impact

430
00:18:00,000 --> 00:18:03,840
stuff so like i said

431
00:18:03,840 --> 00:18:06,400
a lot of companies lack of skills of

432
00:18:06,400 --> 00:18:07,760
detecting and

433
00:18:07,760 --> 00:18:10,559
also investigating intrusions so if if

434
00:18:10,559 --> 00:18:12,000
we think about

435
00:18:12,000 --> 00:18:15,840
this slide the fire eye entrance

436
00:18:15,840 --> 00:18:17,520
actually last year i haven't updated

437
00:18:17,520 --> 00:18:19,360
this light yet sorry for that

438
00:18:19,360 --> 00:18:22,559
but uh actually 2019 uh

439
00:18:22,559 --> 00:18:25,039
over 50 percent of instructions were

440
00:18:25,039 --> 00:18:27,039
detected by external parties so for

441
00:18:27,039 --> 00:18:29,360
example a company uh

442
00:18:29,360 --> 00:18:32,080
company uh on the other side of the

443
00:18:32,080 --> 00:18:32,799
globe

444
00:18:32,799 --> 00:18:34,880
lets you know that your data is by the

445
00:18:34,880 --> 00:18:36,799
way sells on the dark web

446
00:18:36,799 --> 00:18:39,600
or something else or for example if we

447
00:18:39,600 --> 00:18:40,320
take uh

448
00:18:40,320 --> 00:18:42,960
take the watchdom case as an example the

449
00:18:42,960 --> 00:18:43,679
uh

450
00:18:43,679 --> 00:18:47,280
actually run some random men was uh

451
00:18:47,280 --> 00:18:49,039
letting the company know that by the way

452
00:18:49,039 --> 00:18:50,240
two years ago i have

453
00:18:50,240 --> 00:18:53,360
downloaded all your stuff and so on so

454
00:18:53,360 --> 00:18:55,840
that's something that's something that

455
00:18:55,840 --> 00:18:57,360
companies should pay attention to

456
00:18:57,360 --> 00:18:57,840
because

457
00:18:57,840 --> 00:19:00,000
uh because uh need need for this kind of

458
00:19:00,000 --> 00:19:01,600
skills is uh

459
00:19:01,600 --> 00:19:04,640
very very very needed and uh

460
00:19:04,640 --> 00:19:07,760
to to get rid of uh these uh these

461
00:19:07,760 --> 00:19:09,520
this kind of big incidents and also

462
00:19:09,520 --> 00:19:11,200
getting uh the uh

463
00:19:11,200 --> 00:19:14,400
dwell time the number of days between

464
00:19:14,400 --> 00:19:16,160
the initial compromise and detection

465
00:19:16,160 --> 00:19:16,960
lower

466
00:19:16,960 --> 00:19:19,200
so always when you do forensics you

467
00:19:19,200 --> 00:19:20,720
provide some threat intelligence which

468
00:19:20,720 --> 00:19:22,320
you can use then to detect these

469
00:19:22,320 --> 00:19:24,320
incidents so that's that's the uh

470
00:19:24,320 --> 00:19:27,039
way how how these two uh support each

471
00:19:27,039 --> 00:19:29,039
other and uh that's the reason why

472
00:19:29,039 --> 00:19:30,880
we have a lot of to do in in the blue

473
00:19:30,880 --> 00:19:32,640
team still

474
00:19:32,640 --> 00:19:35,679
so what is incident response then uh

475
00:19:35,679 --> 00:19:39,200
basically it's uh the uh uh

476
00:19:39,200 --> 00:19:41,440
it's a process uh how how you rapidly

477
00:19:41,440 --> 00:19:43,840
detect and verify incidents and uh

478
00:19:43,840 --> 00:19:47,039
uh do the loss of destruction

479
00:19:47,039 --> 00:19:49,919
and so on and restore the id services so

480
00:19:49,919 --> 00:19:51,120
basically

481
00:19:51,120 --> 00:19:53,919
you properly handled handle security

482
00:19:53,919 --> 00:19:54,720
incidents and

483
00:19:54,720 --> 00:19:56,880
ensure that the business is continuing

484
00:19:56,880 --> 00:19:58,799
of course business is a bad word because

485
00:19:58,799 --> 00:20:00,160
not everyone works for

486
00:20:00,160 --> 00:20:03,200
uh private companies so

487
00:20:03,200 --> 00:20:05,840
in in organizational level as well uh

488
00:20:05,840 --> 00:20:06,400
this

489
00:20:06,400 --> 00:20:10,000
makes the uh process important

490
00:20:10,000 --> 00:20:12,960
and shortly uh i know this process stuff

491
00:20:12,960 --> 00:20:15,039
is boring but uh it's it's always good

492
00:20:15,039 --> 00:20:15,600
to know

493
00:20:15,600 --> 00:20:17,600
uh when you do some some some kind of

494
00:20:17,600 --> 00:20:19,840
stuff why are you doing because

495
00:20:19,840 --> 00:20:22,400
running somewhere isn't is not good if

496
00:20:22,400 --> 00:20:24,720
you have don't have any directions

497
00:20:24,720 --> 00:20:27,760
so basically the ir uh

498
00:20:27,760 --> 00:20:30,880
starts with preparations then you

499
00:20:30,880 --> 00:20:31,919
identificate

500
00:20:31,919 --> 00:20:34,720
in an in identify and sculpt the

501
00:20:34,720 --> 00:20:35,280
incident

502
00:20:35,280 --> 00:20:38,640
then you contain it remediate it recover

503
00:20:38,640 --> 00:20:40,880
from it and then you learn from it and

504
00:20:40,880 --> 00:20:43,760
this is the part where for example

505
00:20:43,760 --> 00:20:44,799
forensics

506
00:20:44,799 --> 00:20:47,760
provides the threat intel consumption a

507
00:20:47,760 --> 00:20:49,600
threat intel which you can then use to

508
00:20:49,600 --> 00:20:52,000
detect new incidents and share

509
00:20:52,000 --> 00:20:55,520
with other other people and of course

510
00:20:55,520 --> 00:20:57,440
like everything this is something you

511
00:20:57,440 --> 00:20:59,200
people and companies should

512
00:20:59,200 --> 00:21:03,280
practice uh practice a lot for example

513
00:21:03,280 --> 00:21:05,520
uh i have been doing seven years

514
00:21:05,520 --> 00:21:06,320
forensics

515
00:21:06,320 --> 00:21:09,280
and uh i i always keep my all skills at

516
00:21:09,280 --> 00:21:10,640
uh up to date by

517
00:21:10,640 --> 00:21:13,440
doing different ctfs and also

518
00:21:13,440 --> 00:21:15,280
participating for example in locket

519
00:21:15,280 --> 00:21:16,720
shields

520
00:21:16,720 --> 00:21:20,240
and so on so if if you are

521
00:21:20,240 --> 00:21:23,760
if you are willing to become

522
00:21:23,760 --> 00:21:25,919
really good in something and you want to

523
00:21:25,919 --> 00:21:27,440
upkeep your

524
00:21:27,440 --> 00:21:30,640
own skills at as high as possible keep

525
00:21:30,640 --> 00:21:31,520
practicing

526
00:21:31,520 --> 00:21:35,200
that thing and and eventually you will

527
00:21:35,200 --> 00:21:36,159
get better

528
00:21:36,159 --> 00:21:39,600
i promise and also take this note to

529
00:21:39,600 --> 00:21:40,480
your

530
00:21:40,480 --> 00:21:43,600
employees that employers that that

531
00:21:43,600 --> 00:21:46,000
of course the company should do this as

532
00:21:46,000 --> 00:21:47,440
well because if if

533
00:21:47,440 --> 00:21:49,679
uh if you don't practice your incident

534
00:21:49,679 --> 00:21:51,360
response processes

535
00:21:51,360 --> 00:21:54,400
you will likely get uh up when

536
00:21:54,400 --> 00:21:56,080
the incident happens everyone

537
00:21:56,080 --> 00:22:00,159
just starts running and nothing will

538
00:22:00,159 --> 00:22:03,919
happen and you will likely do a bad job

539
00:22:03,919 --> 00:22:06,799
uh handling the incident but where is

540
00:22:06,799 --> 00:22:08,880
the forensics in the engine's response

541
00:22:08,880 --> 00:22:12,000
basically it's there and it starts there

542
00:22:12,000 --> 00:22:14,559
and ends there it starts there and it

543
00:22:14,559 --> 00:22:16,000
ends there so

544
00:22:16,000 --> 00:22:20,159
it is uh it is

545
00:22:20,360 --> 00:22:23,440
simultaneous process of the ir

546
00:22:23,440 --> 00:22:25,919
so digital forensics goes with the hand

547
00:22:25,919 --> 00:22:26,640
in the hand

548
00:22:26,640 --> 00:22:28,880
with the ir and it starts when the

549
00:22:28,880 --> 00:22:30,720
actual uh

550
00:22:30,720 --> 00:22:33,600
the actual uh inside response process

551
00:22:33,600 --> 00:22:34,240
starts and

552
00:22:34,240 --> 00:22:36,400
ends when the actual incident response

553
00:22:36,400 --> 00:22:37,280
process

554
00:22:37,280 --> 00:22:40,720
ends so it is continuous process as well

555
00:22:40,720 --> 00:22:43,679
and uh it might actually end later than

556
00:22:43,679 --> 00:22:45,679
the actual incident reforms is

557
00:22:45,679 --> 00:22:47,600
ending because likely you will get a lot

558
00:22:47,600 --> 00:22:49,360
of data and analyzing that

559
00:22:49,360 --> 00:22:51,600
will take some time but you need to be

560
00:22:51,600 --> 00:22:52,400
able to

561
00:22:52,400 --> 00:22:54,880
uh provide some kind of good

562
00:22:54,880 --> 00:22:56,640
understanding what has happened during

563
00:22:56,640 --> 00:22:58,960
the incident so you are fast enough

564
00:22:58,960 --> 00:23:02,480
uh in in containing and uh scoping the

565
00:23:02,480 --> 00:23:04,640
incident

566
00:23:04,640 --> 00:23:08,159
so uh welcome whack-a-mole

567
00:23:08,159 --> 00:23:11,679
it's a game and how does it relate to

568
00:23:11,679 --> 00:23:14,640
the forensics

569
00:23:18,400 --> 00:23:21,520
if you look at this process

570
00:23:21,520 --> 00:23:23,360
and like i said a lot of companies are

571
00:23:23,360 --> 00:23:25,440
skipping the actual

572
00:23:25,440 --> 00:23:28,159
scoping and going straight from the

573
00:23:28,159 --> 00:23:30,880
identification to the recovery

574
00:23:30,880 --> 00:23:33,760
if you skip the scoping you will end up

575
00:23:33,760 --> 00:23:35,360
playing whack-a-mole against the

576
00:23:35,360 --> 00:23:37,120
attacker

577
00:23:37,120 --> 00:23:39,039
if you don't scope you don't know how

578
00:23:39,039 --> 00:23:40,960
they got in you know they are in but you

579
00:23:40,960 --> 00:23:43,039
don't know how they got him

580
00:23:43,039 --> 00:23:45,760
uh you don't know how what kind of

581
00:23:45,760 --> 00:23:48,080
persistence they have on your network

582
00:23:48,080 --> 00:23:51,039
you don't know which uh which computers

583
00:23:51,039 --> 00:23:51,360
are

584
00:23:51,360 --> 00:23:54,080
infected by the attacker uh you just

585
00:23:54,080 --> 00:23:54,640
know that

586
00:23:54,640 --> 00:23:57,440
for example if if you saw an incident on

587
00:23:57,440 --> 00:23:58,080
on one

588
00:23:58,080 --> 00:24:00,000
machine you don't know if if there has

589
00:24:00,000 --> 00:24:01,760
been lateral movement and the attacker

590
00:24:01,760 --> 00:24:02,960
has

591
00:24:02,960 --> 00:24:06,000
has gone uh wild in your network and

592
00:24:06,000 --> 00:24:09,200
compromised multiple systems so if you

593
00:24:09,200 --> 00:24:10,640
don't do forensics

594
00:24:10,640 --> 00:24:13,120
you will end up uh playing whack-a-mole

595
00:24:13,120 --> 00:24:14,159
against the uh

596
00:24:14,159 --> 00:24:17,440
attacker and uh the uh

597
00:24:17,440 --> 00:24:19,760
this this is frustrating because you

598
00:24:19,760 --> 00:24:21,279
will uh do

599
00:24:21,279 --> 00:24:23,200
well the incident response will start

600
00:24:23,200 --> 00:24:24,320
all over again

601
00:24:24,320 --> 00:24:26,400
every time a new machine that is

602
00:24:26,400 --> 00:24:27,760
compromised pops up

603
00:24:27,760 --> 00:24:31,039
and eventually the attacker will likely

604
00:24:31,039 --> 00:24:33,360
get to their objectives criticizing but

605
00:24:33,360 --> 00:24:35,200
i'm just pointing out that it can be

606
00:24:35,200 --> 00:24:35,679
hard

607
00:24:35,679 --> 00:24:37,600
and it's a good thing that people do and

608
00:24:37,600 --> 00:24:40,000
companies do the digital forensics

609
00:24:40,000 --> 00:24:42,080
but let's talk about the forensics

610
00:24:42,080 --> 00:24:43,200
workflow

611
00:24:43,200 --> 00:24:45,919
basically first when you start doing the

612
00:24:45,919 --> 00:24:47,200
forensics you need to

613
00:24:47,200 --> 00:24:51,120
gather evidence uh usually

614
00:24:51,120 --> 00:24:52,559
it's good to start with the memory

615
00:24:52,559 --> 00:24:54,640
forensics so you detect if there is

616
00:24:54,640 --> 00:24:56,799
something running up on the system

617
00:24:56,799 --> 00:25:00,559
and and then you will

618
00:25:00,559 --> 00:25:02,960
be able to identify something else you

619
00:25:02,960 --> 00:25:05,760
need to investigate more

620
00:25:05,760 --> 00:25:09,360
my own view is that there is

621
00:25:09,360 --> 00:25:11,760
there is not that many cases where you

622
00:25:11,760 --> 00:25:12,799
actually get

623
00:25:12,799 --> 00:25:15,760
good memory sample it is because people

624
00:25:15,760 --> 00:25:16,480
tend to

625
00:25:16,480 --> 00:25:19,840
boot their computers boot their servers

626
00:25:19,840 --> 00:25:22,960
or they just the 12 times is so large

627
00:25:22,960 --> 00:25:25,039
that that the memory has

628
00:25:25,039 --> 00:25:28,559
faded away uh from from the uh start of

629
00:25:28,559 --> 00:25:30,480
the incident so so

630
00:25:30,480 --> 00:25:33,440
you often the memory samples you get are

631
00:25:33,440 --> 00:25:34,400
bad

632
00:25:34,400 --> 00:25:37,440
or uh the computer has been viewed

633
00:25:37,440 --> 00:25:40,559
booted and the volatility memory is gone

634
00:25:40,559 --> 00:25:43,440
but in this case today we are

635
00:25:43,440 --> 00:25:45,679
investigating pretty good memory samples

636
00:25:45,679 --> 00:25:47,600
so there should be a lot of data

637
00:25:47,600 --> 00:25:49,520
available to you and of course

638
00:25:49,520 --> 00:25:52,640
if you can uh if

639
00:25:52,640 --> 00:25:55,600
there is ever a chance that you get

640
00:25:55,600 --> 00:25:56,720
memory

641
00:25:56,720 --> 00:25:59,840
sample from a client or the company it

642
00:25:59,840 --> 00:26:02,159
is always good and you should be

643
00:26:02,159 --> 00:26:05,840
you should you should

644
00:26:05,840 --> 00:26:09,200
investigate it it's worth of it then you

645
00:26:09,200 --> 00:26:10,400
usually extract

646
00:26:10,400 --> 00:26:13,520
extract files from the file system or

647
00:26:13,520 --> 00:26:14,159
either

648
00:26:14,159 --> 00:26:16,880
from the memory and analyze them this

649
00:26:16,880 --> 00:26:18,159
could be for example

650
00:26:18,159 --> 00:26:22,080
logs then it could be

651
00:26:22,080 --> 00:26:25,520
scheduled tasks from windows system uh

652
00:26:25,520 --> 00:26:28,480
windows registry and so on a lot of

653
00:26:28,480 --> 00:26:30,159
stuff you're gonna investigate and

654
00:26:30,159 --> 00:26:32,480
and uh we are also going to do them

655
00:26:32,480 --> 00:26:33,279
today

656
00:26:33,279 --> 00:26:37,120
then there is als also disk forensics

657
00:26:37,120 --> 00:26:40,640
when you acquire the whole

658
00:26:40,640 --> 00:26:42,799
hard disk of the system and start

659
00:26:42,799 --> 00:26:44,880
investigating it

660
00:26:44,880 --> 00:26:48,640
and last but not definitely the least

661
00:26:48,640 --> 00:26:50,840
you are doing a report of the

662
00:26:50,840 --> 00:26:52,640
investigation

663
00:26:52,640 --> 00:26:55,679
one wise man from

664
00:26:55,679 --> 00:26:59,520
f-secure and uh herrera's message called

665
00:26:59,520 --> 00:27:01,679
tommy tubman and once said to me that

666
00:27:01,679 --> 00:27:02,960
the forensicator is

667
00:27:02,960 --> 00:27:06,480
as good as their report is so if your

668
00:27:06,480 --> 00:27:07,679
report is

669
00:27:07,679 --> 00:27:09,840
your analysis is your if your

670
00:27:09,840 --> 00:27:10,880
report is good

671
00:27:10,880 --> 00:27:12,880
and your analysis is uh your

672
00:27:12,880 --> 00:27:14,799
analysis is good and if

673
00:27:14,799 --> 00:27:17,200
both of them are good you are excellent

674
00:27:17,200 --> 00:27:18,799
forensicator

675
00:27:18,799 --> 00:27:22,640
so please keep that in mind that your

676
00:27:22,640 --> 00:27:25,679
report should be top notch even though

677
00:27:25,679 --> 00:27:26,240
your

678
00:27:26,240 --> 00:27:29,440
analysis was not of course this is not

679
00:27:29,440 --> 00:27:31,440
good carrier advice you should be

680
00:27:31,440 --> 00:27:34,000
really good forensics if you want to do

681
00:27:34,000 --> 00:27:34,720
it

682
00:27:34,720 --> 00:27:37,679
but yeah today we are not going to

683
00:27:37,679 --> 00:27:38,559
investigate

684
00:27:38,559 --> 00:27:42,000
uh we are not going to do this so the

685
00:27:42,000 --> 00:27:44,080
evidence has been acquired already we

686
00:27:44,080 --> 00:27:45,919
are not going to do disk forensics

687
00:27:45,919 --> 00:27:46,880
because

688
00:27:46,880 --> 00:27:50,000
i would have to provide you a lot of

689
00:27:50,000 --> 00:27:52,960
stuff a lot of evidence and the process

690
00:27:52,960 --> 00:27:54,640
in time would be too long

691
00:27:54,640 --> 00:27:56,799
and of course we will not be definitely

692
00:27:56,799 --> 00:27:58,399
writing a report today

693
00:27:58,399 --> 00:28:01,039
so that's off the table so we are

694
00:28:01,039 --> 00:28:02,960
focusing on the memory forensics and

695
00:28:02,960 --> 00:28:06,159
uh analysis of selected files

696
00:28:06,159 --> 00:28:09,679
alrighty so let's start with the memory

697
00:28:09,679 --> 00:28:11,279
book recommendations if you have

698
00:28:11,279 --> 00:28:13,360
attended my memory forensics workshop in

699
00:28:13,360 --> 00:28:15,679
disobey you might know already these two

700
00:28:15,679 --> 00:28:16,399
but

701
00:28:16,399 --> 00:28:18,960
i still recommend both of them out of

702
00:28:18,960 --> 00:28:21,440
memory forensics i read them by

703
00:28:21,440 --> 00:28:23,760
light case level and walters it's it's a

704
00:28:23,760 --> 00:28:25,520
really good book there is also

705
00:28:25,520 --> 00:28:28,880
a lot of labs so if you are willing to

706
00:28:28,880 --> 00:28:30,240
learn more and more

707
00:28:30,240 --> 00:28:33,279
on memory forensics i suggest getting

708
00:28:33,279 --> 00:28:35,120
that book i think you can get it free

709
00:28:35,120 --> 00:28:37,440
online and also the labs are online so

710
00:28:37,440 --> 00:28:39,200
you can just download the

711
00:28:39,200 --> 00:28:41,039
evidence files and start reading the

712
00:28:41,039 --> 00:28:42,799
book and doing the forensics

713
00:28:42,799 --> 00:28:45,200
there and then of course the windows

714
00:28:45,200 --> 00:28:47,279
internal so if you are investigating

715
00:28:47,279 --> 00:28:49,440
windows you should know it like your own

716
00:28:49,440 --> 00:28:51,200
pockets i don't know it but

717
00:28:51,200 --> 00:28:53,600
i'm trying to learn uh it's it's a

718
00:28:53,600 --> 00:28:55,360
process of continuous learning

719
00:28:55,360 --> 00:28:57,360
but but that's that's a good book to

720
00:28:57,360 --> 00:28:59,360
have i think i have it

721
00:28:59,360 --> 00:29:02,640
on my on my bookshelf as well uh

722
00:29:02,640 --> 00:29:04,720
trying to read it but uh it's it's kind

723
00:29:04,720 --> 00:29:06,080
of um

724
00:29:06,080 --> 00:29:09,279
heavy text so just sometimes

725
00:29:09,279 --> 00:29:12,559
checking things from the book

726
00:29:12,559 --> 00:29:14,640
yes reading books is such a forensics

727
00:29:14,640 --> 00:29:16,480
and a good way to start

728
00:29:16,480 --> 00:29:20,399
so what about tools volatility

729
00:29:20,399 --> 00:29:22,880
is the one we are going to use today

730
00:29:22,880 --> 00:29:24,640
memory forensics in overall is pretty

731
00:29:24,640 --> 00:29:26,240
good and fun

732
00:29:26,240 --> 00:29:29,600
and volatility is its way to go

733
00:29:29,600 --> 00:29:32,240
today and in the near future but

734
00:29:32,240 --> 00:29:33,840
memphrock fs which is

735
00:29:33,840 --> 00:29:37,679
made by olaf frisk from sweden

736
00:29:37,679 --> 00:29:40,720
is getting pretty good

737
00:29:40,720 --> 00:29:44,000
and i heard that the swedish

738
00:29:44,000 --> 00:29:46,640
locket shield steam used in forensics

739
00:29:46,640 --> 00:29:48,480
only memphis

740
00:29:48,480 --> 00:29:52,240
so it is proven to be pretty

741
00:29:52,240 --> 00:29:55,840
effective tool as well

742
00:30:00,159 --> 00:30:03,520
okay i will answer that one later

743
00:30:03,520 --> 00:30:06,880
but yeah definitely something you should

744
00:30:06,880 --> 00:30:08,799
check out uh the main progress works

745
00:30:08,799 --> 00:30:10,240
only on windows

746
00:30:10,240 --> 00:30:13,120
machine host machine so it is off the

747
00:30:13,120 --> 00:30:15,520
scope for today as well

748
00:30:15,520 --> 00:30:17,679
uh and which volatility version we are

749
00:30:17,679 --> 00:30:19,679
going to use we are going to use version

750
00:30:19,679 --> 00:30:20,640
2

751
00:30:20,640 --> 00:30:23,279
because version 3 is released on

752
00:30:23,279 --> 00:30:24,240
february

753
00:30:24,240 --> 00:30:27,279
this year and it's it is pretty new one

754
00:30:27,279 --> 00:30:30,320
so uh well uh

755
00:30:30,320 --> 00:30:32,799
yeah it is really new one and it's

756
00:30:32,799 --> 00:30:33,760
missing a lot of

757
00:30:33,760 --> 00:30:38,159
uh a lot of uh plug-ins and

758
00:30:38,159 --> 00:30:42,080
and features that the volatility 2 which

759
00:30:42,080 --> 00:30:42,559
runs

760
00:30:42,559 --> 00:30:45,919
on on legacy python uh has

761
00:30:45,919 --> 00:30:48,000
so that's the reason why we are still

762
00:30:48,000 --> 00:30:51,039
sticking with the old one but

763
00:30:51,039 --> 00:30:53,840
in in future of course you should move

764
00:30:53,840 --> 00:30:54,559
on to the

765
00:30:54,559 --> 00:30:58,799
supported version of python 133 which is

766
00:30:58,799 --> 00:31:01,360
actually which runs on the python

767
00:31:01,360 --> 00:31:04,399
version 3.

768
00:31:04,399 --> 00:31:07,840
and then about the recall which was

769
00:31:07,840 --> 00:31:11,279
a pretty good uh memory forensics tool

770
00:31:11,279 --> 00:31:15,519
before uh it is discontinued so

771
00:31:15,519 --> 00:31:20,240
it is uh not anymore supported by google

772
00:31:20,240 --> 00:31:23,679
so it should be also

773
00:31:23,679 --> 00:31:26,640
it should be also

774
00:31:27,520 --> 00:31:30,240
[Music]

775
00:31:30,240 --> 00:31:32,559
ignored in this this phase because it is

776
00:31:32,559 --> 00:31:34,480
not supported by the developer

777
00:31:34,480 --> 00:31:36,880
anymore so rest in peace in pieces

778
00:31:36,880 --> 00:31:39,519
recall which was pretty good one

779
00:31:39,519 --> 00:31:42,720
so um why would we forensicate memory

780
00:31:42,720 --> 00:31:44,559
what can we find from there we can find

781
00:31:44,559 --> 00:31:46,559
a lot of stuff windows configuration

782
00:31:46,559 --> 00:31:47,760
files

783
00:31:47,760 --> 00:31:50,640
the files the user has opened a lot of

784
00:31:50,640 --> 00:31:52,880
secrets the user has configuration

785
00:31:52,880 --> 00:31:56,960
files so on so on running processes

786
00:31:56,960 --> 00:32:00,159
including malware network stuff we can

787
00:32:00,159 --> 00:32:02,080
actually extract packets from the memory

788
00:32:02,080 --> 00:32:03,360
as well we can see

789
00:32:03,360 --> 00:32:06,480
a pcap from the network traffic and so

790
00:32:06,480 --> 00:32:07,120
on

791
00:32:07,120 --> 00:32:09,360
so it's basically the best place to

792
00:32:09,360 --> 00:32:11,679
start analyzing the computer because

793
00:32:11,679 --> 00:32:14,559
all the recent stuff is there and more

794
00:32:14,559 --> 00:32:15,519
you have memory

795
00:32:15,519 --> 00:32:19,840
the more this stuff you have there

796
00:32:19,840 --> 00:32:22,320
we will have today two memory dumps one

797
00:32:22,320 --> 00:32:23,840
is two gigabytes and

798
00:32:23,840 --> 00:32:26,240
another one is eight gigabytes so we we

799
00:32:26,240 --> 00:32:27,679
you will see how

800
00:32:27,679 --> 00:32:31,120
big is the difference in the amount of

801
00:32:31,120 --> 00:32:34,159
data in the actual memory so how much

802
00:32:34,159 --> 00:32:35,919
you can find from the memory from the

803
00:32:35,919 --> 00:32:36,240
two

804
00:32:36,240 --> 00:32:38,480
two gigabyte memory dump and how much

805
00:32:38,480 --> 00:32:40,720
you can find from the eight gigabyte

806
00:32:40,720 --> 00:32:43,760
memory dump oh then

807
00:32:43,760 --> 00:32:48,799
uh there is this term fileless malware

808
00:32:48,799 --> 00:32:51,840
why why i'm putting it to what it is

809
00:32:51,840 --> 00:32:53,519
because

810
00:32:53,519 --> 00:32:56,799
there is a thing a thing called wireless

811
00:32:56,799 --> 00:32:57,919
malware but

812
00:32:57,919 --> 00:33:01,919
uh usually people mix it with the uh

813
00:33:01,919 --> 00:33:03,600
with the malware that doesn't leave

814
00:33:03,600 --> 00:33:05,840
evidence or traces onto the system this

815
00:33:05,840 --> 00:33:08,080
fileless malware is is basically the new

816
00:33:08,080 --> 00:33:09,440
normal so

817
00:33:09,440 --> 00:33:12,399
usually not that many stuff is being

818
00:33:12,399 --> 00:33:13,600
written on the disk

819
00:33:13,600 --> 00:33:16,720
they are either straightly

820
00:33:16,720 --> 00:33:20,000
downloaded to the memory or set up to

821
00:33:20,000 --> 00:33:22,159
the windows registry where it downloaded

822
00:33:22,159 --> 00:33:22,480
when

823
00:33:22,480 --> 00:33:25,919
where it downloads it on the each reboot

824
00:33:25,919 --> 00:33:27,679
time to the straight to the memory and

825
00:33:27,679 --> 00:33:28,559
so on

826
00:33:28,559 --> 00:33:30,880
so there is fileless malware and it is

827
00:33:30,880 --> 00:33:32,240
pretty uh common

828
00:33:32,240 --> 00:33:35,840
but there is no such a thing that uh

829
00:33:35,840 --> 00:33:37,600
like like a malware that doesn't leave

830
00:33:37,600 --> 00:33:39,200
any traces on the system

831
00:33:39,200 --> 00:33:42,240
so every malware will leave traces to

832
00:33:42,240 --> 00:33:43,039
the

833
00:33:43,039 --> 00:33:46,640
file system as well so there is

834
00:33:46,640 --> 00:33:49,760
basically well of course if you

835
00:33:49,760 --> 00:33:51,760
write it to the registry then it will

836
00:33:51,760 --> 00:33:54,559
get written into the registry hive files

837
00:33:54,559 --> 00:33:56,240
on the system which we will talk later

838
00:33:56,240 --> 00:33:58,159
on today more

839
00:33:58,159 --> 00:34:01,919
and so on so so i'm arguing that

840
00:34:01,919 --> 00:34:04,960
this kind of totally fireless is

841
00:34:04,960 --> 00:34:07,840
is not not possible and and usually

842
00:34:07,840 --> 00:34:09,520
there is also downloader files that

843
00:34:09,520 --> 00:34:11,520
download this malware and so on

844
00:34:11,520 --> 00:34:13,199
of course some shell goes that keep

845
00:34:13,199 --> 00:34:15,119
being injected straight to the memory

846
00:34:15,119 --> 00:34:15,599
can

847
00:34:15,599 --> 00:34:18,719
be considered as a fileless malware but

848
00:34:18,719 --> 00:34:21,918
let's not argue on that one more

849
00:34:21,918 --> 00:34:26,638
we have a few questions let's see

850
00:34:29,679 --> 00:34:31,760
so you can use kali linux for the actual

851
00:34:31,760 --> 00:34:33,119
workshop part

852
00:34:33,119 --> 00:34:36,879
uh yes i think

853
00:34:36,879 --> 00:34:39,040
we i will present the tools we are using

854
00:34:39,040 --> 00:34:40,159
you're gonna install them

855
00:34:40,159 --> 00:34:43,199
on any line oxy unix system

856
00:34:43,199 --> 00:34:46,239
why i recommend the shift and rim

857
00:34:46,239 --> 00:34:48,000
combination is because there is a lot of

858
00:34:48,000 --> 00:34:49,520
tools that you will

859
00:34:49,520 --> 00:34:53,280
that will not be presented

860
00:34:53,280 --> 00:34:57,040
but you will learn you will need to

861
00:34:57,040 --> 00:34:58,720
learn during the

862
00:34:58,720 --> 00:35:02,400
ctf if you want to get full points so

863
00:35:02,400 --> 00:35:05,680
the ctf is is uh beyond

864
00:35:05,680 --> 00:35:08,480
the skills that we are going through in

865
00:35:08,480 --> 00:35:11,280
in this worship

866
00:35:11,440 --> 00:35:13,920
even though we don't do can you avoid

867
00:35:13,920 --> 00:35:18,079
some material to learn more uh

868
00:35:18,720 --> 00:35:21,280
i can do it later on uh but in the

869
00:35:21,280 --> 00:35:23,359
course i'm going to give later on

870
00:35:23,359 --> 00:35:25,280
there will be a questions in part as

871
00:35:25,280 --> 00:35:26,720
well

872
00:35:26,720 --> 00:35:30,160
but i i will i will see see i i will

873
00:35:30,160 --> 00:35:32,560
uh point out some some tools that you

874
00:35:32,560 --> 00:35:33,599
can use for that

875
00:35:33,599 --> 00:35:35,680
that as well and how how you should do

876
00:35:35,680 --> 00:35:37,119
it it's it's a

877
00:35:37,119 --> 00:35:38,880
of course i cannot cover everything

878
00:35:38,880 --> 00:35:40,640
because it's it's different on virtual

879
00:35:40,640 --> 00:35:42,160
machines and it's different on physical

880
00:35:42,160 --> 00:35:44,160
machines and so on and it also depends

881
00:35:44,160 --> 00:35:47,760
on the operating system so what

882
00:35:47,760 --> 00:35:50,160
and one more question how much are you

883
00:35:50,160 --> 00:35:52,160
spending investigating windows machines

884
00:35:52,160 --> 00:35:55,040
compared to lineups unix ones in your

885
00:35:55,040 --> 00:35:56,079
forensics work

886
00:35:56,079 --> 00:35:57,920
and there is differences beside the

887
00:35:57,920 --> 00:36:00,079
observance between the forensics on the

888
00:36:00,079 --> 00:36:02,560
yes yes there is a lot of differences

889
00:36:02,560 --> 00:36:03,440
between the

890
00:36:03,440 --> 00:36:06,640
different uh operating systems for

891
00:36:06,640 --> 00:36:08,320
example windows has

892
00:36:08,320 --> 00:36:11,359
almost all all the configuration and log

893
00:36:11,359 --> 00:36:13,040
files in binary format

894
00:36:13,040 --> 00:36:14,960
so you need to parse them out while the

895
00:36:14,960 --> 00:36:16,160
uh linux

896
00:36:16,160 --> 00:36:18,640
stores almost everything to the uh the

897
00:36:18,640 --> 00:36:20,400
ascii readable text

898
00:36:20,400 --> 00:36:24,320
so that's that's a big difference

899
00:36:24,320 --> 00:36:28,320
i am not uh i haven't analyzed that many

900
00:36:28,320 --> 00:36:29,040
macs

901
00:36:29,040 --> 00:36:32,240
uh uh macintosh operating systems

902
00:36:32,240 --> 00:36:34,880
on my life i have only a few of them so

903
00:36:34,880 --> 00:36:35,920
i i

904
00:36:35,920 --> 00:36:37,440
cannot say that i'm a professional

905
00:36:37,440 --> 00:36:39,119
analyzing mac os

906
00:36:39,119 --> 00:36:43,599
x also some unix they are so rare

907
00:36:43,599 --> 00:36:46,000
in investigating investigations so so

908
00:36:46,000 --> 00:36:48,240
that i don't have a good touch on unix

909
00:36:48,240 --> 00:36:49,040
systems but

910
00:36:49,040 --> 00:36:52,839
linux and windows mostly only

911
00:36:52,839 --> 00:36:56,320
windows so um and uh

912
00:36:56,320 --> 00:36:59,040
well i can't tell the story when when i

913
00:36:59,040 --> 00:37:00,560
started in nixo

914
00:37:00,560 --> 00:37:03,760
uh a few years ago um i was

915
00:37:03,760 --> 00:37:06,240
on on a holiday before i started and

916
00:37:06,240 --> 00:37:07,599
when i got to the work

917
00:37:07,599 --> 00:37:10,880
my first task was uh to analyze i i

918
00:37:10,880 --> 00:37:12,000
think was it was

919
00:37:12,000 --> 00:37:15,359
80 linux red hat linux servers

920
00:37:15,359 --> 00:37:19,040
servers so so that was like a

921
00:37:19,040 --> 00:37:21,040
very interesting start at the new place

922
00:37:21,040 --> 00:37:23,760
that you have a lot of evidence on your

923
00:37:23,760 --> 00:37:25,680
work table and this is the first case

924
00:37:25,680 --> 00:37:26,800
you are going to do

925
00:37:26,800 --> 00:37:29,359
it was nice

926
00:37:35,040 --> 00:37:38,079
yep all right

927
00:37:38,079 --> 00:37:41,599
so um one few things about the uh

928
00:37:41,599 --> 00:37:44,079
memory

929
00:37:44,960 --> 00:37:47,359
uh about the memory structure uh there

930
00:37:47,359 --> 00:37:48,160
is uh

931
00:37:48,160 --> 00:37:50,640
the thing i want you to understand uh

932
00:37:50,640 --> 00:37:52,160
about the memory there

933
00:37:52,160 --> 00:37:54,960
are uh two different address spaces

934
00:37:54,960 --> 00:37:56,240
there is the physical

935
00:37:56,240 --> 00:37:58,800
address space which is the actual

936
00:37:58,800 --> 00:38:01,520
address base of the memory so how it is

937
00:38:01,520 --> 00:38:02,079
in

938
00:38:02,079 --> 00:38:05,119
in in reality in the memory uh

939
00:38:05,119 --> 00:38:07,920
memory in in blocks and then there is

940
00:38:07,920 --> 00:38:09,040
virtual address space

941
00:38:09,040 --> 00:38:11,839
which is the address space of the uh

942
00:38:11,839 --> 00:38:12,880
software

943
00:38:12,880 --> 00:38:15,440
so basically if you have program running

944
00:38:15,440 --> 00:38:16,800
this is the address space

945
00:38:16,800 --> 00:38:20,000
they know and they use and uh

946
00:38:20,000 --> 00:38:21,760
this is the physical address space where

947
00:38:21,760 --> 00:38:24,400
they are in reality in the in the memory

948
00:38:24,400 --> 00:38:24,800
and this

949
00:38:24,800 --> 00:38:29,200
is uh this is uh information that only

950
00:38:29,200 --> 00:38:30,560
the system knows

951
00:38:30,560 --> 00:38:34,480
so the actual process does not have

952
00:38:34,480 --> 00:38:38,320
real information where

953
00:38:38,320 --> 00:38:41,599
it is residing in the in the physical

954
00:38:41,599 --> 00:38:42,480
memory

955
00:38:42,480 --> 00:38:44,960
you will face the virtual address space

956
00:38:44,960 --> 00:38:46,480
and physical address space in

957
00:38:46,480 --> 00:38:48,720
in the memory forensics and you need to

958
00:38:48,720 --> 00:38:50,640
always consider which

959
00:38:50,640 --> 00:38:53,200
which uh address space you are

960
00:38:53,200 --> 00:38:54,240
investigating

961
00:38:54,240 --> 00:38:56,960
uh but you don't have to mind that much

962
00:38:56,960 --> 00:38:57,680
about it

963
00:38:57,680 --> 00:39:00,240
right now but just keep in mind that

964
00:39:00,240 --> 00:39:00,960
these are

965
00:39:00,960 --> 00:39:03,680
totally different address spaces uh this

966
00:39:03,680 --> 00:39:04,480
is of

967
00:39:04,480 --> 00:39:07,680
also uh also when you start analyzing

968
00:39:07,680 --> 00:39:09,680
malware uh this is something you should

969
00:39:09,680 --> 00:39:11,599
consider

970
00:39:11,599 --> 00:39:15,280
okay where is my

971
00:39:15,280 --> 00:39:18,720
okay yeah i think i thought i i did some

972
00:39:18,720 --> 00:39:21,839
yeah okay it was this cool effect so

973
00:39:21,839 --> 00:39:25,280
uh here is also another view

974
00:39:25,280 --> 00:39:29,839
well this is a view of windows

975
00:39:30,160 --> 00:39:32,560
user and kernel and so called so

976
00:39:32,560 --> 00:39:34,400
basically the uh

977
00:39:34,400 --> 00:39:36,079
process address space and system address

978
00:39:36,079 --> 00:39:37,599
space uh

979
00:39:37,599 --> 00:39:39,920
and and which which kind of what are we

980
00:39:39,920 --> 00:39:42,079
going to investigate today

981
00:39:42,079 --> 00:39:45,760
so here is the uh same same memory that

982
00:39:45,760 --> 00:39:47,920
that the process sees and and

983
00:39:47,920 --> 00:39:51,040
it has this peb processing right

984
00:39:51,040 --> 00:39:52,960
environment block which includes some

985
00:39:52,960 --> 00:39:55,040
information of the running process

986
00:39:55,040 --> 00:39:58,079
and then we have on the on the kernel

987
00:39:58,079 --> 00:39:59,520
side the system side

988
00:39:59,520 --> 00:40:02,000
an address space where is a process

989
00:40:02,000 --> 00:40:03,200
block that has

990
00:40:03,200 --> 00:40:05,680
all this information about the running

991
00:40:05,680 --> 00:40:06,480
process

992
00:40:06,480 --> 00:40:09,359
so for example we can see the process id

993
00:40:09,359 --> 00:40:11,119
the parent process id which process

994
00:40:11,119 --> 00:40:12,960
executed the process basically

995
00:40:12,960 --> 00:40:16,319
when it started when it exited

996
00:40:16,319 --> 00:40:20,400
also we have this e-process block there

997
00:40:20,400 --> 00:40:22,240
i think i have some data about it as

998
00:40:22,240 --> 00:40:25,599
well then we have handle table so on so

999
00:40:25,599 --> 00:40:27,359
on we have a lot of information about

1000
00:40:27,359 --> 00:40:29,520
the running process image file name

1001
00:40:29,520 --> 00:40:32,079
which image on the disk uh executed then

1002
00:40:32,079 --> 00:40:32,640
we have

1003
00:40:32,640 --> 00:40:34,480
we will have the command line as well

1004
00:40:34,480 --> 00:40:36,640
how it was executed and so on so

1005
00:40:36,640 --> 00:40:38,480
memory provides you a lot of information

1006
00:40:38,480 --> 00:40:40,160
about the running processes and and

1007
00:40:40,160 --> 00:40:41,520
that's a good place to start

1008
00:40:41,520 --> 00:40:43,359
investigating the uh

1009
00:40:43,359 --> 00:40:47,440
investigating the uh incidents

1010
00:40:50,880 --> 00:40:54,640
yes uh windows subsystem for linux

1011
00:40:54,640 --> 00:40:58,000
also works on flare flare

1012
00:40:58,000 --> 00:41:00,880
okay flare okay yeah oh well if the

1013
00:41:00,880 --> 00:41:02,640
flare is the host and the

1014
00:41:02,640 --> 00:41:06,560
vso2 is shift then um

1015
00:41:06,560 --> 00:41:09,599
yeah it will work as well i have also

1016
00:41:09,599 --> 00:41:14,319
uh as back as a backup system the vso2

1017
00:41:14,319 --> 00:41:18,240
and uh so this is also

1018
00:41:18,240 --> 00:41:20,400
what the e-process block has so it

1019
00:41:20,400 --> 00:41:21,400
basically has

1020
00:41:21,400 --> 00:41:24,400
a lot of information of of the

1021
00:41:24,400 --> 00:41:26,640
of the of the running process the

1022
00:41:26,640 --> 00:41:27,520
objects

1023
00:41:27,520 --> 00:41:29,359
handled on the handle table so for

1024
00:41:29,359 --> 00:41:33,279
example if if a process

1025
00:41:33,760 --> 00:41:37,920
if a process uh uh is is downloading

1026
00:41:37,920 --> 00:41:38,560
some

1027
00:41:38,560 --> 00:41:41,599
dlls importing some api

1028
00:41:41,599 --> 00:41:45,040
apis from the windows uh it will

1029
00:41:45,040 --> 00:41:47,920
import and dll which has the uh defined

1030
00:41:47,920 --> 00:41:48,480
the

1031
00:41:48,480 --> 00:41:51,680
api functions uh it it will

1032
00:41:51,680 --> 00:41:53,839
be seen on the handle table so there you

1033
00:41:53,839 --> 00:41:54,880
can actually uh

1034
00:41:54,880 --> 00:41:58,480
also think uh what kind of

1035
00:41:58,480 --> 00:42:01,359
what kind of uh

1036
00:42:01,599 --> 00:42:05,040
what kind of functions the malware for

1037
00:42:05,040 --> 00:42:06,000
example has

1038
00:42:06,000 --> 00:42:09,359
if it imports import some crucial

1039
00:42:09,359 --> 00:42:13,200
uh windows dlls for api calling

1040
00:42:13,200 --> 00:42:14,880
then you will see the security

1041
00:42:14,880 --> 00:42:16,560
identifiers and privileges

1042
00:42:16,560 --> 00:42:19,680
the the process has in the e-process

1043
00:42:19,680 --> 00:42:21,119
table and also threats

1044
00:42:21,119 --> 00:42:24,480
threats that the process has so a lot of

1045
00:42:24,480 --> 00:42:28,000
information can be found there also some

1046
00:42:28,000 --> 00:42:30,079
some ttps that can be found

1047
00:42:30,079 --> 00:42:32,400
from the memory if you analyze it you

1048
00:42:32,400 --> 00:42:35,359
can find uh some powershell execution

1049
00:42:35,359 --> 00:42:38,640
uh for example

1050
00:42:41,200 --> 00:42:44,880
so you can actually uh

1051
00:42:44,880 --> 00:42:47,920
abuse some abuse some uh attackers can

1052
00:42:47,920 --> 00:42:48,720
abuse some

1053
00:42:48,720 --> 00:42:51,040
power cell executions like i said the

1054
00:42:51,040 --> 00:42:52,400
fileless malware stuff

1055
00:42:52,400 --> 00:42:55,760
uh you can usually find out it find it

1056
00:42:55,760 --> 00:42:58,720
from the from the memory dump you can

1057
00:42:58,720 --> 00:42:59,760
extract the

1058
00:42:59,760 --> 00:43:02,000
actual commands and see the download for

1059
00:43:02,000 --> 00:43:03,119
example

1060
00:43:03,119 --> 00:43:05,520
so it is pretty good place to start

1061
00:43:05,520 --> 00:43:06,800
start

1062
00:43:06,800 --> 00:43:08,880
investigating this kind of incident then

1063
00:43:08,880 --> 00:43:10,800
you can see if if the attacker is

1064
00:43:10,800 --> 00:43:13,520
trying to bypass uac from handles for

1065
00:43:13,520 --> 00:43:15,119
example if the process is running on

1066
00:43:15,119 --> 00:43:16,319
higher level

1067
00:43:16,319 --> 00:43:19,440
then it should should you you can see it

1068
00:43:19,440 --> 00:43:20,800
from the memory as well

1069
00:43:20,800 --> 00:43:24,079
then of course persistence is in this

1070
00:43:24,079 --> 00:43:24,800
case

1071
00:43:24,800 --> 00:43:27,520
windows services you can detect the

1072
00:43:27,520 --> 00:43:29,760
malicious services from the memory dumps

1073
00:43:29,760 --> 00:43:30,079
and

1074
00:43:30,079 --> 00:43:32,960
and analyze how they were made there and

1075
00:43:32,960 --> 00:43:35,359
of course you need to

1076
00:43:35,359 --> 00:43:38,640
later on fulfill your investigation with

1077
00:43:38,640 --> 00:43:39,280
other

1078
00:43:39,280 --> 00:43:41,839
evidence files like the ones you can

1079
00:43:41,839 --> 00:43:44,160
extract from the disk or from the memory

1080
00:43:44,160 --> 00:43:45,200
so

1081
00:43:45,200 --> 00:43:47,119
these are examples you can run from the

1082
00:43:47,119 --> 00:43:48,880
memory then there is of course

1083
00:43:48,880 --> 00:43:52,079
these in-memory attacks only

1084
00:43:52,079 --> 00:43:54,480
which include a shell code injection if

1085
00:43:54,480 --> 00:43:57,520
if you are not aware of

1086
00:43:57,520 --> 00:43:59,520
of the term shell code it's basically a

1087
00:43:59,520 --> 00:44:00,800
short

1088
00:44:00,800 --> 00:44:04,240
code that that executes

1089
00:44:04,240 --> 00:44:06,400
tasks that the attacker wants for

1090
00:44:06,400 --> 00:44:08,240
example if they want to have reverse

1091
00:44:08,240 --> 00:44:09,119
cell they can

1092
00:44:09,119 --> 00:44:11,200
provide a shell code and for example in

1093
00:44:11,200 --> 00:44:13,359
buffer overflow vulnerability

1094
00:44:13,359 --> 00:44:15,920
execute the uh inject the shell code to

1095
00:44:15,920 --> 00:44:16,640
the uh

1096
00:44:16,640 --> 00:44:18,560
process memory and then the process will

1097
00:44:18,560 --> 00:44:19,839
execute it and

1098
00:44:19,839 --> 00:44:22,319
then it will be only on memory because

1099
00:44:22,319 --> 00:44:24,160
it wasn't

1100
00:44:24,160 --> 00:44:25,839
written on the disk of course the

1101
00:44:25,839 --> 00:44:27,359
attacker wants to get usually

1102
00:44:27,359 --> 00:44:28,400
persistence

1103
00:44:28,400 --> 00:44:31,760
so they will likely install some kind of

1104
00:44:31,760 --> 00:44:34,400
service or schedule a task or run key or

1105
00:44:34,400 --> 00:44:35,680
something else

1106
00:44:35,680 --> 00:44:38,800
to stay stay persistent on the system

1107
00:44:38,800 --> 00:44:41,599
then reflective dll injection so

1108
00:44:41,599 --> 00:44:42,400
basically

1109
00:44:42,400 --> 00:44:45,839
uh an uh exe

1110
00:44:45,839 --> 00:44:51,040
loads on dll and you can actually uh

1111
00:44:51,040 --> 00:44:55,119
change uh how how and where it uh uh

1112
00:44:55,119 --> 00:44:57,839
where where it injects the where it

1113
00:44:57,839 --> 00:44:58,800
loads the uh

1114
00:44:58,800 --> 00:45:02,240
load library where it loads the uh dll

1115
00:45:02,240 --> 00:45:05,359
and uh and uh by that you can

1116
00:45:05,359 --> 00:45:09,280
use uh the uh the uh

1117
00:45:09,280 --> 00:45:12,160
process to load some malicious dlls and

1118
00:45:12,160 --> 00:45:14,160
you have your own going to the memory

1119
00:45:14,160 --> 00:45:16,319
and also process all lowing which means

1120
00:45:16,319 --> 00:45:17,680
that the uh

1121
00:45:17,680 --> 00:45:19,839
you make the computer to start legit

1122
00:45:19,839 --> 00:45:21,280
process and and then

1123
00:45:21,280 --> 00:45:24,400
then you uh suspend it and after

1124
00:45:24,400 --> 00:45:25,599
suspending you

1125
00:45:25,599 --> 00:45:28,160
replace the binary with the malicious

1126
00:45:28,160 --> 00:45:29,280
one and then

1127
00:45:29,280 --> 00:45:30,960
continue the execution so that the

1128
00:45:30,960 --> 00:45:32,640
memory is shows that

1129
00:45:32,640 --> 00:45:34,480
it is legit binary running but the

1130
00:45:34,480 --> 00:45:36,480
actual binary is loaded from

1131
00:45:36,480 --> 00:45:40,480
other location on the disk

1132
00:45:40,480 --> 00:45:43,520
and of course uh uh there

1133
00:45:43,520 --> 00:45:46,960
are many others as well uh these

1134
00:45:46,960 --> 00:45:49,200
three and few others are presented

1135
00:45:49,200 --> 00:45:51,760
pretty good in the f-secure block so

1136
00:45:51,760 --> 00:45:54,000
go and check that out if you are

1137
00:45:54,000 --> 00:45:56,400
interested of those

1138
00:45:56,400 --> 00:45:59,680
uh so how you analyze memory basically

1139
00:45:59,680 --> 00:46:00,880
this is the uh

1140
00:46:00,880 --> 00:46:04,079
process that the science is providing so

1141
00:46:04,079 --> 00:46:06,560
it's a six phase process uh where you

1142
00:46:06,560 --> 00:46:07,839
first identify

1143
00:46:07,839 --> 00:46:10,880
then you analyze the the handles then

1144
00:46:10,880 --> 00:46:12,160
you

1145
00:46:12,160 --> 00:46:14,880
check the network stuff and then you see

1146
00:46:14,880 --> 00:46:16,079
code injections and

1147
00:46:16,079 --> 00:46:18,720
rootkits and then in the last phase you

1148
00:46:18,720 --> 00:46:19,440
extra

1149
00:46:19,440 --> 00:46:23,200
extract the stuff you were interested in

1150
00:46:23,200 --> 00:46:25,280
and start analyzing them or send them to

1151
00:46:25,280 --> 00:46:26,880
the analyzers for

1152
00:46:26,880 --> 00:46:30,079
other other analysts

1153
00:46:30,079 --> 00:46:32,640
or check the online services like

1154
00:46:32,640 --> 00:46:34,000
aristotle against

1155
00:46:34,000 --> 00:46:37,680
them and here is a cheat sheet which you

1156
00:46:37,680 --> 00:46:39,119
should be using

1157
00:46:39,119 --> 00:46:42,640
when you do the investigation

1158
00:46:42,640 --> 00:46:46,240
uh as i said this uh pdf

1159
00:46:46,240 --> 00:46:49,520
this will be available as a pdf format

1160
00:46:49,520 --> 00:46:52,800
in the files.dfir.fi and you can

1161
00:46:52,800 --> 00:46:56,400
check it there then

1162
00:46:56,400 --> 00:46:59,520
last but not least in the

1163
00:46:59,520 --> 00:47:02,400
memory forensics uh strings you can use

1164
00:47:02,400 --> 00:47:04,319
strings

1165
00:47:04,319 --> 00:47:07,200
they are pretty good uh investigating

1166
00:47:07,200 --> 00:47:07,839
some of the

1167
00:47:07,839 --> 00:47:12,000
stuff and you can find

1168
00:47:12,000 --> 00:47:15,119
for example c2 stuff from there you can

1169
00:47:15,119 --> 00:47:15,520
find

1170
00:47:15,520 --> 00:47:17,760
emails from the memory if if they are

1171
00:47:17,760 --> 00:47:19,280
not extractable

1172
00:47:19,280 --> 00:47:22,160
from the uh actual memory dump if the

1173
00:47:22,160 --> 00:47:23,359
volatility doesn't

1174
00:47:23,359 --> 00:47:25,359
detect them you can actually get a lot

1175
00:47:25,359 --> 00:47:26,400
of

1176
00:47:26,400 --> 00:47:29,760
information using strings but you must

1177
00:47:29,760 --> 00:47:30,559
understand

1178
00:47:30,559 --> 00:47:32,640
where you are getting this information

1179
00:47:32,640 --> 00:47:33,599
so if you just

1180
00:47:33,599 --> 00:47:36,480
run strings and make some assumptions

1181
00:47:36,480 --> 00:47:37,599
it's wrong

1182
00:47:37,599 --> 00:47:40,000
you need to you can use the strings to

1183
00:47:40,000 --> 00:47:40,880
fulfill your

1184
00:47:40,880 --> 00:47:42,800
investigation if you know that this kind

1185
00:47:42,800 --> 00:47:44,240
of stuff have happened and

1186
00:47:44,240 --> 00:47:46,960
for example no part of the string that

1187
00:47:46,960 --> 00:47:47,680
is

1188
00:47:47,680 --> 00:47:49,760
for example part of the comment that has

1189
00:47:49,760 --> 00:47:51,520
been

1190
00:47:51,520 --> 00:47:53,280
has been executed on the system but you

1191
00:47:53,280 --> 00:47:54,800
cannot see the uh

1192
00:47:54,800 --> 00:47:57,280
what the computer what what the output

1193
00:47:57,280 --> 00:47:58,800
of the comment was you

1194
00:47:58,800 --> 00:48:02,240
can potentially uh use strings and crap

1195
00:48:02,240 --> 00:48:04,720
uh to get it out of the memory but

1196
00:48:04,720 --> 00:48:05,680
remind that

1197
00:48:05,680 --> 00:48:08,240
you need to have the context always when

1198
00:48:08,240 --> 00:48:09,599
you are doing this this is not

1199
00:48:09,599 --> 00:48:11,599
you cannot just do strings and say that

1200
00:48:11,599 --> 00:48:13,280
you are a forensicator

1201
00:48:13,280 --> 00:48:16,000
or a reverse engineer you need to do

1202
00:48:16,000 --> 00:48:17,440
more analysis and

1203
00:48:17,440 --> 00:48:21,200
then you can fulfill the analysis or or

1204
00:48:21,200 --> 00:48:24,160
you can you can of course you can make

1205
00:48:24,160 --> 00:48:25,520
hypothesis on

1206
00:48:25,520 --> 00:48:29,280
on the strings and then confirm it by

1207
00:48:29,280 --> 00:48:32,720
investigating the memory other way

1208
00:48:32,720 --> 00:48:35,920
so it's time for action so let's

1209
00:48:35,920 --> 00:48:41,200
start with the memory dump let's see

1210
00:48:41,440 --> 00:48:45,680
where is my remnucks i removes here

1211
00:48:45,680 --> 00:48:48,880
i do not have shift yet

1212
00:48:48,880 --> 00:48:51,920
but i think i have velocity here

1213
00:48:51,920 --> 00:48:55,040
yes so i will go and

1214
00:48:55,040 --> 00:48:58,400
download the uh let's

1215
00:48:58,400 --> 00:49:03,839
close that one yes

1216
00:49:04,240 --> 00:49:07,280
yes so i will as well

1217
00:49:07,280 --> 00:49:11,040
go to the files.gear4.5

1218
00:49:11,040 --> 00:49:14,839
by the way i hope you can see my screen

1219
00:49:14,839 --> 00:49:16,240
well

1220
00:49:16,240 --> 00:49:19,680
i cannot see this one

1221
00:49:26,319 --> 00:49:28,800
how reliable is malware attack

1222
00:49:28,800 --> 00:49:30,079
attribution so you may

1223
00:49:30,079 --> 00:49:32,960
mean attribution that the who is behind

1224
00:49:32,960 --> 00:49:33,359
the

1225
00:49:33,359 --> 00:49:35,839
attack do you mean that by attribution

1226
00:49:35,839 --> 00:49:36,640
or

1227
00:49:36,640 --> 00:49:38,480
attributing the malware which which is

1228
00:49:38,480 --> 00:49:41,200
the malware

1229
00:49:41,200 --> 00:49:45,839
which is the malware type

1230
00:49:47,440 --> 00:49:50,960
so who is behind the attack

1231
00:49:52,559 --> 00:49:56,400
i wouldn't say it is well i haven't seen

1232
00:49:56,400 --> 00:49:58,559
of course i i am not a threat

1233
00:49:58,559 --> 00:49:59,839
intelligence

1234
00:49:59,839 --> 00:50:03,040
um specialist but

1235
00:50:03,040 --> 00:50:06,559
what i have seen uh it's it's kind of

1236
00:50:06,559 --> 00:50:07,920
foggy for me so

1237
00:50:07,920 --> 00:50:10,240
so there is a lot of assumptions and

1238
00:50:10,240 --> 00:50:10,960
stuff that

1239
00:50:10,960 --> 00:50:14,720
as a forensicator i don't really like so

1240
00:50:14,720 --> 00:50:18,079
that's the reason why i i

1241
00:50:18,079 --> 00:50:21,599
cannot comment if it's reliable or not

1242
00:50:21,599 --> 00:50:24,000
preferred evts browser for both windows

1243
00:50:24,000 --> 00:50:25,420
and linux windows

1244
00:50:25,420 --> 00:50:26,720
[Music]

1245
00:50:26,720 --> 00:50:30,640
wind evtx explorer and uh

1246
00:50:30,640 --> 00:50:33,920
no it's event explorer and on linux

1247
00:50:33,920 --> 00:50:37,680
evts dump and scrap

1248
00:50:38,880 --> 00:50:43,280
so uh make their uh mayhem

1249
00:50:43,680 --> 00:50:48,640
mayhem we get that one

1250
00:50:50,400 --> 00:50:53,359
it's getting downloaded it shouldn't

1251
00:50:53,359 --> 00:50:54,079
take that

1252
00:50:54,079 --> 00:50:57,680
long with my internet

1253
00:51:01,599 --> 00:51:08,800
yes it's good

1254
00:51:08,800 --> 00:51:23,370
i think it's better now

1255
00:51:23,370 --> 00:51:26,640
[Music]

1256
00:51:26,640 --> 00:51:29,760
so uh as the process

1257
00:51:29,760 --> 00:51:32,559
process and time would be would take a

1258
00:51:32,559 --> 00:51:33,119
lot of

1259
00:51:33,119 --> 00:51:36,720
lot uh i have already ran some plugins

1260
00:51:36,720 --> 00:51:38,559
against the memory dump and you

1261
00:51:38,559 --> 00:51:41,599
should find them from the uh

1262
00:51:41,599 --> 00:51:45,520
from the seven chip and uh

1263
00:51:45,520 --> 00:51:50,640
let's see when i get this downloaded

1264
00:51:50,640 --> 00:51:56,319
i will open it next i need to extract it

1265
00:52:00,319 --> 00:52:03,359
so there is inside the materials there

1266
00:52:03,359 --> 00:52:04,960
are two seven chips as well

1267
00:52:04,960 --> 00:52:08,160
uh one is the course.7 chip and another

1268
00:52:08,160 --> 00:52:08,920
one is

1269
00:52:08,920 --> 00:52:13,839
ctf.70 the ctf

1270
00:52:13,839 --> 00:52:16,000
password will be shown on my

1271
00:52:16,000 --> 00:52:17,200
presentation on the

1272
00:52:17,200 --> 00:52:20,160
last slide and it will be open 24 hours

1273
00:52:20,160 --> 00:52:22,800
after the uh after this workshop

1274
00:52:22,800 --> 00:52:25,440
and uh winners will get some healthsex

1275
00:52:25,440 --> 00:52:26,079
whack

1276
00:52:26,079 --> 00:52:28,640
so uh and i will announce the winners

1277
00:52:28,640 --> 00:52:30,480
tomorrow on my twitter

1278
00:52:30,480 --> 00:52:32,880
after i have checked the competition by

1279
00:52:32,880 --> 00:52:35,280
the way if you have any uh

1280
00:52:35,280 --> 00:52:37,680
problems with the later on with this etf

1281
00:52:37,680 --> 00:52:39,839
you can contact me on discord

1282
00:52:39,839 --> 00:52:43,520
and i will try to solve them out

1283
00:52:43,520 --> 00:52:46,400
so we have these files and then there i

1284
00:52:46,400 --> 00:52:46,800
think

1285
00:52:46,800 --> 00:52:49,760
this was for the uh for the uh course

1286
00:52:49,760 --> 00:52:52,000
one

1287
00:52:52,000 --> 00:52:55,359
and you can open it one and this

1288
00:52:55,359 --> 00:52:58,000
will take some time because there is

1289
00:52:58,000 --> 00:52:58,400
this

1290
00:52:58,400 --> 00:53:01,680
uh kind of large mem dump uh

1291
00:53:01,680 --> 00:53:05,359
this one is two gigabytes and the uh

1292
00:53:05,359 --> 00:53:08,240
and the one in this etf it will be eight

1293
00:53:08,240 --> 00:53:09,599
gigabytes

1294
00:53:09,599 --> 00:53:11,760
so that that's the that's the bigger one

1295
00:53:11,760 --> 00:53:13,280
and then there is a lot of

1296
00:53:13,280 --> 00:53:16,319
a lot of other stuff as well but these

1297
00:53:16,319 --> 00:53:19,280
somehow relate together and hopefully

1298
00:53:19,280 --> 00:53:23,040
you will find out the story as well

1299
00:53:24,960 --> 00:53:27,680
just a second my kids are probably

1300
00:53:27,680 --> 00:53:29,839
coming

1301
00:53:41,440 --> 00:53:44,480
okay so without

1302
00:53:44,480 --> 00:53:46,640
they told me that the sauna is warm but

1303
00:53:46,640 --> 00:53:48,720
i think i cannot go there now because i

1304
00:53:48,720 --> 00:53:51,440
have this workshop going on

1305
00:53:51,440 --> 00:53:54,640
or or of course i can but i won't

1306
00:53:54,640 --> 00:53:58,640
sorry for that well not sorry for that

1307
00:54:00,960 --> 00:54:03,680
okay so now i have the course material

1308
00:54:03,680 --> 00:54:04,480
here so

1309
00:54:04,480 --> 00:54:07,280
we you should see this kind of directory

1310
00:54:07,280 --> 00:54:08,720
where you have a

1311
00:54:08,720 --> 00:54:11,599
memory dump page file and evidence dot

1312
00:54:11,599 --> 00:54:13,280
forensics store

1313
00:54:13,280 --> 00:54:15,440
and like i said you need to install

1314
00:54:15,440 --> 00:54:17,200
first the

1315
00:54:17,200 --> 00:54:20,480
first the uh uh the

1316
00:54:20,480 --> 00:54:25,839
elementary what is it elementary

1317
00:54:28,559 --> 00:54:32,160
yes i read no it's not elementary what

1318
00:54:32,160 --> 00:54:33,520
was it

1319
00:54:33,520 --> 00:54:36,240
what was the name of the tool let me see

1320
00:54:36,240 --> 00:54:38,880
i need to check my own

1321
00:54:38,880 --> 00:54:39,400
own

1322
00:54:39,400 --> 00:54:42,880
[Music]

1323
00:54:42,880 --> 00:54:47,760
it was here forex store it was

1324
00:54:47,760 --> 00:54:49,200
it was elementary but different

1325
00:54:49,200 --> 00:54:52,079
elementary yes okay

1326
00:54:52,079 --> 00:54:54,480
so let's download that one that's the

1327
00:54:54,480 --> 00:54:56,960
newest one i think

1328
00:54:56,960 --> 00:55:02,319
that's uh glitch in the matrix

1329
00:55:04,839 --> 00:55:07,520
then

1330
00:55:07,520 --> 00:55:10,880
we need to install that one

1331
00:55:14,480 --> 00:55:16,720
and then we should have the elementary

1332
00:55:16,720 --> 00:55:19,440
tool on our system

1333
00:55:19,440 --> 00:55:23,040
so elementor

1334
00:55:23,280 --> 00:55:28,319
okay source

1335
00:55:28,480 --> 00:55:35,359
so we have it in our path

1336
00:55:35,359 --> 00:55:37,839
okay yeah

1337
00:55:38,960 --> 00:55:42,000
okay so it's installing it right now

1338
00:55:42,000 --> 00:55:45,200
oh let's wait a few

1339
00:55:45,200 --> 00:55:48,640
yeah now it's installed so

1340
00:55:48,640 --> 00:55:52,000
basically what we want to do first

1341
00:55:52,000 --> 00:55:54,720
we want to

1342
00:55:56,240 --> 00:55:59,680
unpack the evidence dot

1343
00:55:59,680 --> 00:56:02,559
forensics store so that we will have all

1344
00:56:02,559 --> 00:56:03,680
the uh

1345
00:56:03,680 --> 00:56:06,720
all the necessary information there and

1346
00:56:06,720 --> 00:56:11,200
i will now open another tab

1347
00:56:11,200 --> 00:56:14,400
put here here font as well because i

1348
00:56:14,400 --> 00:56:14,799
believe

1349
00:56:14,799 --> 00:56:17,280
that on the background and then on the

1350
00:56:17,280 --> 00:56:17,920
memory

1351
00:56:17,920 --> 00:56:22,400
memory directory we will have a lot of

1352
00:56:22,400 --> 00:56:25,040
plugins like the basic ones executed

1353
00:56:25,040 --> 00:56:27,200
already and

1354
00:56:27,200 --> 00:56:31,280
and you can you can uh

1355
00:56:31,280 --> 00:56:33,520
see see the information from here so

1356
00:56:33,520 --> 00:56:35,520
usually when you start investigating the

1357
00:56:35,520 --> 00:56:39,040
memory dump you want to find out which

1358
00:56:39,040 --> 00:56:42,319
which which

1359
00:56:42,319 --> 00:56:45,119
operating system it is taken from so the

1360
00:56:45,119 --> 00:56:46,079
kdb

1361
00:56:46,079 --> 00:56:48,640
scan is something you should run it will

1362
00:56:48,640 --> 00:56:49,680
likely look like

1363
00:56:49,680 --> 00:56:52,079
this one uh it will suggest a lot of

1364
00:56:52,079 --> 00:56:54,400
different profiles that match to this uh

1365
00:56:54,400 --> 00:56:59,839
this uh operating system but

1366
00:56:59,839 --> 00:57:04,319
check the version 64 uh value

1367
00:57:04,319 --> 00:57:06,880
this is the x hex and this is the first

1368
00:57:06,880 --> 00:57:07,520
one

1369
00:57:07,520 --> 00:57:10,720
we can see the major version is 15 and

1370
00:57:10,720 --> 00:57:11,520
the minor

1371
00:57:11,520 --> 00:57:15,359
is 10 586

1372
00:57:15,359 --> 00:57:17,839
and this is the correct answer so

1373
00:57:17,839 --> 00:57:18,480
basically

1374
00:57:18,480 --> 00:57:21,520
you should not uh you should not

1375
00:57:21,520 --> 00:57:26,160
uh pay attention to these ones

1376
00:57:26,160 --> 00:57:28,640
these are the suggestions by the by the

1377
00:57:28,640 --> 00:57:29,680
volatility

1378
00:57:29,680 --> 00:57:31,839
but this is the actual version so so

1379
00:57:31,839 --> 00:57:33,599
this uh looks like

1380
00:57:33,599 --> 00:57:36,880
it is it is this windows version uh this

1381
00:57:36,880 --> 00:57:37,520
uh this

1382
00:57:37,520 --> 00:57:40,880
uh current current version and

1383
00:57:40,880 --> 00:57:44,079
if we can then uh give uh use

1384
00:57:44,079 --> 00:57:48,079
the uh volatility

1385
00:57:48,079 --> 00:57:51,280
and give it to it the uh

1386
00:57:51,280 --> 00:57:55,200
oh sorry uh we need to do that one and

1387
00:57:55,200 --> 00:57:56,640
then we can craft

1388
00:57:56,640 --> 00:57:59,520
crap the uh

1389
00:58:00,079 --> 00:58:03,119
the minus minus info lists

1390
00:58:03,119 --> 00:58:06,240
all the stuff related to the uh

1391
00:58:06,240 --> 00:58:09,839
to the uh to the volatility so there is

1392
00:58:09,839 --> 00:58:12,559
uh pro installed profiles installer

1393
00:58:12,559 --> 00:58:15,280
plugins and so on so you can see

1394
00:58:15,280 --> 00:58:18,880
everything the volatility can do and uh

1395
00:58:18,880 --> 00:58:21,359
that's and i'm grabbing the windows

1396
00:58:21,359 --> 00:58:22,160
build number

1397
00:58:22,160 --> 00:58:24,559
from it so i can see that here is a

1398
00:58:24,559 --> 00:58:25,839
profile for

1399
00:58:25,839 --> 00:58:29,280
for for this build windows

1400
00:58:29,280 --> 00:58:33,040
uh windows and i'm going to use that one

1401
00:58:33,040 --> 00:58:36,000
while analyzing the uh analyzing the

1402
00:58:36,000 --> 00:58:37,200
memory dump so

1403
00:58:37,200 --> 00:58:39,520
i can now just give the profile to it

1404
00:58:39,520 --> 00:58:40,480
and then uh

1405
00:58:40,480 --> 00:58:43,359
for example uh run image info which

1406
00:58:43,359 --> 00:58:44,799
takes some time

1407
00:58:44,799 --> 00:58:47,440
and which will provide information about

1408
00:58:47,440 --> 00:58:48,839
the memory dump

1409
00:58:48,839 --> 00:58:52,400
like what

1410
00:58:52,400 --> 00:58:54,720
when the memory dump was taken what is

1411
00:58:54,720 --> 00:58:56,319
the time zone of the

1412
00:58:56,319 --> 00:58:59,520
of the computer and so so on so it will

1413
00:58:59,520 --> 00:59:02,400
provide a lot of information about the

1414
00:59:02,400 --> 00:59:05,839
target system and also uh if you run

1415
00:59:05,839 --> 00:59:08,480
it without the profile definition it

1416
00:59:08,480 --> 00:59:10,319
will take a lot of time

1417
00:59:10,319 --> 00:59:13,599
and it will suggest your profile

1418
00:59:13,599 --> 00:59:16,720
which is likely wrong so that's the

1419
00:59:16,720 --> 00:59:18,000
reason why i suggest

1420
00:59:18,000 --> 00:59:21,119
you to do the kdbg scan and then

1421
00:59:21,119 --> 00:59:23,280
uh okay well now it just is the right

1422
00:59:23,280 --> 00:59:24,640
profile likely because

1423
00:59:24,640 --> 00:59:26,880
uh i used the profile definition there

1424
00:59:26,880 --> 00:59:28,720
but but it will likely

1425
00:59:28,720 --> 00:59:30,480
such as your wrong profile and and

1426
00:59:30,480 --> 00:59:32,720
that's the reason and it will take some

1427
00:59:32,720 --> 00:59:33,280
time

1428
00:59:33,280 --> 00:59:36,559
and also the kdb g scan is much faster

1429
00:59:36,559 --> 00:59:40,880
and as you can see uh the

1430
00:59:40,880 --> 00:59:43,440
image info is also doing the profile

1431
00:59:43,440 --> 00:59:44,000
search

1432
00:59:44,000 --> 00:59:47,280
using the kdbg scan so

1433
00:59:47,280 --> 00:59:49,520
image info is just basically running

1434
00:59:49,520 --> 00:59:51,680
first the kdbg scan and acting

1435
00:59:51,680 --> 00:59:55,359
based on that and as we saw here these

1436
00:59:55,359 --> 00:59:57,680
were not the correct ones that it

1437
00:59:57,680 --> 00:59:58,960
suggested so

1438
00:59:58,960 --> 01:00:01,040
okay there is the correct one actually

1439
01:00:01,040 --> 01:00:03,839
as well but but most of them were not

1440
01:00:03,839 --> 01:00:07,119
the correct ones so so

1441
01:00:07,119 --> 01:00:08,640
that's the reason why you should use the

1442
01:00:08,640 --> 01:00:10,799
kdbc scan and manually

1443
01:00:10,799 --> 01:00:14,160
choose the profile there

1444
01:00:14,160 --> 01:00:16,880
okay so now now we know that the uh this

1445
01:00:16,880 --> 01:00:18,960
image was taken on that date

1446
01:00:18,960 --> 01:00:21,760
and uh the local time zone on that one

1447
01:00:21,760 --> 01:00:22,559
seems to be

1448
01:00:22,559 --> 01:00:25,119
um okay it's it's local time zone of my

1449
01:00:25,119 --> 01:00:26,839
machine

1450
01:00:26,839 --> 01:00:30,400
no okay i think it's image local yes

1451
01:00:30,400 --> 01:00:32,960
it's the uh image yeah sorry it's the

1452
01:00:32,960 --> 01:00:33,599
local

1453
01:00:33,599 --> 01:00:36,720
time of the computer computer that

1454
01:00:36,720 --> 01:00:39,280
uh was running running and where the

1455
01:00:39,280 --> 01:00:42,000
memory dump was taken so it it it was on

1456
01:00:42,000 --> 01:00:45,920
the helsinki time zone ees team

1457
01:00:45,920 --> 01:00:49,520
so uh it tells you uh basic information

1458
01:00:49,520 --> 01:00:51,680
about the system then you can run the ps

1459
01:00:51,680 --> 01:00:52,000
list

1460
01:00:52,000 --> 01:00:54,240
and so on which i have already executed

1461
01:00:54,240 --> 01:00:55,280
to you so

1462
01:00:55,280 --> 01:01:00,319
for example we can see the uh ps list

1463
01:01:00,400 --> 01:01:03,760
okay i will put little bit yes a little

1464
01:01:03,760 --> 01:01:04,079
bit

1465
01:01:04,079 --> 01:01:06,960
smaller the text because it will break

1466
01:01:06,960 --> 01:01:07,680
otherwise the

1467
01:01:07,680 --> 01:01:11,119
screen so uh this is the basically

1468
01:01:11,119 --> 01:01:13,200
the basic process list of the system uh

1469
01:01:13,200 --> 01:01:15,920
that we're running there is some kind of

1470
01:01:15,920 --> 01:01:18,240
interesting stuff uh about yeah about

1471
01:01:18,240 --> 01:01:20,960
the acquisition

1472
01:01:20,960 --> 01:01:24,000
this memory dump was taken using the ftk

1473
01:01:24,000 --> 01:01:28,160
imager so that's that's the tool i

1474
01:01:28,160 --> 01:01:31,200
always go uh go with when i

1475
01:01:31,200 --> 01:01:33,359
need to take memory dumps or if i need

1476
01:01:33,359 --> 01:01:35,520
to acquire the

1477
01:01:35,520 --> 01:01:39,520
whole disk of a windows system

1478
01:01:39,520 --> 01:01:42,319
and if if we think about the virtualized

1479
01:01:42,319 --> 01:01:44,799
systems then you can just take the

1480
01:01:44,799 --> 01:01:48,960
wemem vmsn files from the system

1481
01:01:48,960 --> 01:01:53,040
and also the flat vmdk disk

1482
01:01:53,040 --> 01:01:55,440
so so that's that's the way to go on

1483
01:01:55,440 --> 01:01:56,319
vmware

1484
01:01:56,319 --> 01:01:59,039
and also on different systems there are

1485
01:01:59,039 --> 01:01:59,599
different

1486
01:01:59,599 --> 01:02:01,599
acquisition tools so on on different

1487
01:02:01,599 --> 01:02:03,280
virtual machines and so on but on

1488
01:02:03,280 --> 01:02:04,640
windows

1489
01:02:04,640 --> 01:02:06,799
that is either physical or virtual it

1490
01:02:06,799 --> 01:02:08,400
doesn't matter to me i

1491
01:02:08,400 --> 01:02:12,400
usually use the ftk imager uh to acquire

1492
01:02:12,400 --> 01:02:15,039
acquire the memory and also the disk

1493
01:02:15,039 --> 01:02:15,599
image

1494
01:02:15,599 --> 01:02:18,559
and of course i start with the memory

1495
01:02:18,559 --> 01:02:20,000
because i can just store it

1496
01:02:20,000 --> 01:02:23,440
for example to the desktop of the user

1497
01:02:23,440 --> 01:02:25,920
and then just acquire the whole disk and

1498
01:02:25,920 --> 01:02:27,440
then i will have them both

1499
01:02:27,440 --> 01:02:29,680
the memory will be inside of the disk

1500
01:02:29,680 --> 01:02:31,520
image so it can be

1501
01:02:31,520 --> 01:02:35,520
extracted from there

1502
01:02:35,520 --> 01:02:38,480
questions well i answered that one

1503
01:02:38,480 --> 01:02:39,359
already

1504
01:02:39,359 --> 01:02:43,039
did we have questions on twitch site

1505
01:02:43,039 --> 01:02:47,119
nice internet uh

1506
01:02:47,119 --> 01:02:50,319
close to that not uh well the

1507
01:02:50,319 --> 01:02:53,520
upload is not that fast

1508
01:02:53,520 --> 01:03:03,839
i assume the teacher

1509
01:03:05,280 --> 01:03:08,880
okay nothing special there uh

1510
01:03:08,880 --> 01:03:11,359
then if we see the process list we will

1511
01:03:11,359 --> 01:03:12,160
see

1512
01:03:12,160 --> 01:03:14,799
another stuff that should be interesting

1513
01:03:14,799 --> 01:03:16,000
to us as well

1514
01:03:16,000 --> 01:03:19,440
for example the debt.exe

1515
01:03:19,440 --> 01:03:22,880
which is which is uh which is some

1516
01:03:22,880 --> 01:03:26,240
uh what suspicious uh and uh and uh

1517
01:03:26,240 --> 01:03:27,200
something that

1518
01:03:27,200 --> 01:03:29,599
we preferably would like to investigate

1519
01:03:29,599 --> 01:03:31,520
more

1520
01:03:31,520 --> 01:03:33,680
and a lot of other stuff as well i

1521
01:03:33,680 --> 01:03:35,039
usually too that

1522
01:03:35,039 --> 01:03:38,160
do that in my investigations that i go

1523
01:03:38,160 --> 01:03:39,599
through the uh

1524
01:03:39,599 --> 01:03:43,119
list and take uh take the

1525
01:03:43,119 --> 01:03:45,760
process id of such business processes or

1526
01:03:45,760 --> 01:03:47,680
processes that i don't

1527
01:03:47,680 --> 01:03:51,760
detect myself and then i use google

1528
01:03:51,760 --> 01:03:54,160
google to figure out what has happened

1529
01:03:54,160 --> 01:03:54,799
on the

1530
01:03:54,799 --> 01:03:58,079
on on the system then we have

1531
01:03:58,079 --> 01:04:02,079
a ps3 which is uh the process tree and

1532
01:04:02,079 --> 01:04:03,359
we can here see

1533
01:04:03,359 --> 01:04:06,880
that uh i'm not actually sure what what

1534
01:04:06,880 --> 01:04:07,359
this

1535
01:04:07,359 --> 01:04:10,480
u9 is is and why why it's here it seems

1536
01:04:10,480 --> 01:04:13,200
that the memory is somewhat broken

1537
01:04:13,200 --> 01:04:16,160
on on this system so uh no idea what's

1538
01:04:16,160 --> 01:04:16,559
that

1539
01:04:16,559 --> 01:04:19,200
because the timestamp is well is is

1540
01:04:19,200 --> 01:04:19,920
showing

1541
01:04:19,920 --> 01:04:23,680
something that is not current i'm not

1542
01:04:23,680 --> 01:04:25,280
sure if this has something to do with

1543
01:04:25,280 --> 01:04:27,280
the memory compression as the

1544
01:04:27,280 --> 01:04:29,599
system had only two gigabytes so so it

1545
01:04:29,599 --> 01:04:31,520
might be somewhat uh

1546
01:04:31,520 --> 01:04:34,720
somewhat uh compressed the memory and

1547
01:04:34,720 --> 01:04:37,039
then that's the reason why why we can't

1548
01:04:37,039 --> 01:04:39,760
see the uh truth here but here's the

1549
01:04:39,760 --> 01:04:40,720
death as well

1550
01:04:40,720 --> 01:04:42,799
and we can see the execution time when

1551
01:04:42,799 --> 01:04:44,799
it was executed so this is something i

1552
01:04:44,799 --> 01:04:46,720
would pay attention to

1553
01:04:46,720 --> 01:04:49,920
and uh also

1554
01:04:49,920 --> 01:04:51,920
uh if if we see some processes for

1555
01:04:51,920 --> 01:04:53,839
example running with the uh

1556
01:04:53,839 --> 01:04:57,440
with the suspicious uh suspicious uh

1557
01:04:57,440 --> 01:04:58,319
parent uh

1558
01:04:58,319 --> 01:05:00,160
processes uh that that should be

1559
01:05:00,160 --> 01:05:02,400
something that you could easily detect

1560
01:05:02,400 --> 01:05:03,599
from this view

1561
01:05:03,599 --> 01:05:05,920
we can also see that this user was using

1562
01:05:05,920 --> 01:05:06,960
thunderbird

1563
01:05:06,960 --> 01:05:10,160
so likely likely using email there

1564
01:05:10,160 --> 01:05:12,319
maybe something something can be figured

1565
01:05:12,319 --> 01:05:14,400
out from the emails and so on so that's

1566
01:05:14,400 --> 01:05:15,280
something we should

1567
01:05:15,280 --> 01:05:18,559
uh investigate microsoft edge okay

1568
01:05:18,559 --> 01:05:20,799
that's weird using edge who is using

1569
01:05:20,799 --> 01:05:22,160
edge nobody

1570
01:05:22,160 --> 01:05:25,039
uh and so on so a lot of lot of good

1571
01:05:25,039 --> 01:05:26,319
information in here

1572
01:05:26,319 --> 01:05:29,440
and i always recommend to check the ps3

1573
01:05:29,440 --> 01:05:30,559
dot

1574
01:05:30,559 --> 01:05:34,160
minus v so it's a v for verbose verb

1575
01:05:34,160 --> 01:05:36,799
so it will show the comment lines as

1576
01:05:36,799 --> 01:05:38,400
well and also the

1577
01:05:38,400 --> 01:05:41,680
paths of the uh actual file so if you

1578
01:05:41,680 --> 01:05:43,599
for example in process following i think

1579
01:05:43,599 --> 01:05:44,960
you should see here the

1580
01:05:44,960 --> 01:05:48,240
actual process path not just the uh

1581
01:05:48,240 --> 01:05:51,359
used path in in the execution

1582
01:05:51,359 --> 01:05:55,280
so we can see that debt.exe

1583
01:05:55,280 --> 01:05:58,880
is executed under docusign uh docusign

1584
01:05:58,880 --> 01:06:00,240
directory which

1585
01:06:00,240 --> 01:06:03,559
actually is suspicious if you have

1586
01:06:03,559 --> 01:06:04,720
investigated

1587
01:06:04,720 --> 01:06:07,359
uh if you have been investigated uh

1588
01:06:07,359 --> 01:06:08,480
phishing emails

1589
01:06:08,480 --> 01:06:10,799
uh lately in the past few years you have

1590
01:06:10,799 --> 01:06:12,960
seen that docusign has been used in the

1591
01:06:12,960 --> 01:06:13,680
uh

1592
01:06:13,680 --> 01:06:16,000
in the phishing emails and also in male

1593
01:06:16,000 --> 01:06:16,799
spam

1594
01:06:16,799 --> 01:06:20,079
so when tricking user to execute the

1595
01:06:20,079 --> 01:06:20,880
macros

1596
01:06:20,880 --> 01:06:23,440
so this could relate to that one i don't

1597
01:06:23,440 --> 01:06:24,480
know we should

1598
01:06:24,480 --> 01:06:26,480
investigate this more and see what is

1599
01:06:26,480 --> 01:06:27,760
the in the

1600
01:06:27,760 --> 01:06:30,799
user's download directory we can also

1601
01:06:30,799 --> 01:06:31,359
see that

1602
01:06:31,359 --> 01:06:34,319
this user at least was sponge so there

1603
01:06:34,319 --> 01:06:35,599
is this

1604
01:06:35,599 --> 01:06:40,079
user whose user account has been or is

1605
01:06:40,079 --> 01:06:43,440
named sponge y has been because if you

1606
01:06:43,440 --> 01:06:45,599
change the username in windows it will

1607
01:06:45,599 --> 01:06:46,400
leave the

1608
01:06:46,400 --> 01:06:50,079
home directory as is so the uh

1609
01:06:50,079 --> 01:06:53,520
as it was so it is the old old name of

1610
01:06:53,520 --> 01:06:55,599
the director

1611
01:06:55,599 --> 01:06:58,079
then we uh if we move on we would like

1612
01:06:58,079 --> 01:06:59,920
to see the uh

1613
01:06:59,920 --> 01:07:03,280
the handles so in this this um

1614
01:07:03,280 --> 01:07:06,720
uh case we were interested about oh okay

1615
01:07:06,720 --> 01:07:07,920
the ps can as well

1616
01:07:07,920 --> 01:07:10,720
let's forgot that one so uh let's see

1617
01:07:10,720 --> 01:07:12,480
the ps can so this should

1618
01:07:12,480 --> 01:07:15,520
uh this uh this uh

1619
01:07:15,520 --> 01:07:19,920
plugin is searching for the uh

1620
01:07:22,319 --> 01:07:25,920
this this uh this is this is searching

1621
01:07:25,920 --> 01:07:26,480
for the

1622
01:07:26,480 --> 01:07:29,359
uh e-process blocks from the memory so

1623
01:07:29,359 --> 01:07:30,000
it will

1624
01:07:30,000 --> 01:07:32,559
detect the uh processes that are trying

1625
01:07:32,559 --> 01:07:33,599
to hide from the

1626
01:07:33,599 --> 01:07:36,880
uh from the actual uh

1627
01:07:36,880 --> 01:07:39,119
from from the actual actual process list

1628
01:07:39,119 --> 01:07:41,280
as well that are hiding or that has been

1629
01:07:41,280 --> 01:07:44,799
already uh faded away uh and and stopped

1630
01:07:44,799 --> 01:07:47,920
exited so it should find those as well

1631
01:07:47,920 --> 01:07:50,160
so here are a few extra processes but i

1632
01:07:50,160 --> 01:07:50,960
think

1633
01:07:50,960 --> 01:07:54,640
all of these were in the uh in the uh

1634
01:07:54,640 --> 01:07:58,000
in the uh bs list as well and as we can

1635
01:07:58,000 --> 01:07:58,640
see that

1636
01:07:58,640 --> 01:08:02,000
here is no the uh you process which

1637
01:08:02,000 --> 01:08:04,640
which uh time stop timestamp was

1638
01:08:04,640 --> 01:08:05,119
up

1639
01:08:05,119 --> 01:08:08,880
so it's not here so uh as i said i think

1640
01:08:08,880 --> 01:08:10,640
it has something to do with the memory

1641
01:08:10,640 --> 01:08:11,680
compression

1642
01:08:11,680 --> 01:08:14,558
that the uh

1643
01:08:15,119 --> 01:08:19,439
as this uh yes as this as this

1644
01:08:19,439 --> 01:08:21,759
ps can is working while it looks for the

1645
01:08:21,759 --> 01:08:24,479
uh for the um

1646
01:08:24,479 --> 01:08:26,880
for the e process blocks uh a few

1647
01:08:26,880 --> 01:08:27,520
questions

1648
01:08:27,520 --> 01:08:30,640
uh in case others well it's a comment in

1649
01:08:30,640 --> 01:08:32,158
case others had trouble

1650
01:08:32,158 --> 01:08:36,238
running elementary in ubuntu uh 18.04

1651
01:08:36,238 --> 01:08:39,040
complaining the ellipses it works if you

1652
01:08:39,040 --> 01:08:41,000
download elementary

1653
01:08:41,000 --> 01:08:43,759
0.2.0 instead thank you

1654
01:08:43,759 --> 01:08:46,640
josh for that and it's a good hint for

1655
01:08:46,640 --> 01:08:47,600
people using

1656
01:08:47,600 --> 01:08:49,920
the recommended ubuntu version which i

1657
01:08:49,920 --> 01:08:51,520
am not using

1658
01:08:51,520 --> 01:08:54,799
so uh do that instead of downloading the

1659
01:08:54,799 --> 01:08:56,158
latest version

1660
01:08:56,158 --> 01:08:58,960
you can see it from the releases page of

1661
01:08:58,960 --> 01:09:00,479
the github

1662
01:09:00,479 --> 01:09:03,040
kimo is asking if this is a simulated

1663
01:09:03,040 --> 01:09:04,880
real-world case as we have douglas and

1664
01:09:04,880 --> 01:09:06,479
malspam

1665
01:09:06,479 --> 01:09:09,520
uh yes i have

1666
01:09:09,520 --> 01:09:12,158
used a lot of tools and tactics that i

1667
01:09:12,158 --> 01:09:12,880
have seen

1668
01:09:12,880 --> 01:09:17,440
in the past months in the field so

1669
01:09:19,359 --> 01:09:23,600
so so yes we will have uh

1670
01:09:23,600 --> 01:09:25,679
it is a real case simulation so we have

1671
01:09:25,679 --> 01:09:27,439
a lot of stuff that that

1672
01:09:27,439 --> 01:09:31,040
has been has been uh seen in the world

1673
01:09:31,040 --> 01:09:35,839
by the national cyber security center of

1674
01:09:39,279 --> 01:09:43,120
and especially in the uh in this edf

1675
01:09:43,120 --> 01:09:47,198
so there is a lot of good stuff

1676
01:09:47,198 --> 01:09:50,000
so that was the process we were

1677
01:09:50,000 --> 01:09:51,040
interested in so

1678
01:09:51,040 --> 01:09:53,120
uh i would say that in this point we

1679
01:09:53,120 --> 01:09:55,440
should focus our investigation

1680
01:09:55,440 --> 01:09:58,400
more on on that one so we are prepping

1681
01:09:58,400 --> 01:09:59,280
the uh

1682
01:09:59,280 --> 01:10:02,719
that uh pro society from the uh

1683
01:10:02,719 --> 01:10:05,360
from the handles as we are now looking

1684
01:10:05,360 --> 01:10:05,920
for the

1685
01:10:05,920 --> 01:10:09,920
uh for the uh uh for the resources of

1686
01:10:09,920 --> 01:10:10,640
that file

1687
01:10:10,640 --> 01:10:12,400
so we can see that there is uh this

1688
01:10:12,400 --> 01:10:14,880
directory docusign

1689
01:10:14,880 --> 01:10:19,040
which has been uh checked

1690
01:10:19,040 --> 01:10:22,640
what else it's it's a file

1691
01:10:22,640 --> 01:10:25,040
as you can see we can also see here uh

1692
01:10:25,040 --> 01:10:26,000
registry keys

1693
01:10:26,000 --> 01:10:29,040
what is using browsers if it has

1694
01:10:29,040 --> 01:10:30,719
multiple threads

1695
01:10:30,719 --> 01:10:35,040
we can see i think we can see network

1696
01:10:35,040 --> 01:10:37,600
traffic as well weight compocket yes we

1697
01:10:37,600 --> 01:10:39,199
can see that it's it's you

1698
01:10:39,199 --> 01:10:42,320
doing network uh events we can see the

1699
01:10:42,320 --> 01:10:46,239
user security id

1700
01:10:46,239 --> 01:10:48,320
of the of the user that has been running

1701
01:10:48,320 --> 01:10:49,360
it

1702
01:10:49,360 --> 01:10:52,239
we can see a lot of lot of different

1703
01:10:52,239 --> 01:10:53,040
stops

1704
01:10:53,040 --> 01:10:55,520
stuff so depending on the malware or the

1705
01:10:55,520 --> 01:10:56,840
software we are

1706
01:10:56,840 --> 01:10:59,760
investigating uh this will tell us

1707
01:10:59,760 --> 01:11:03,120
a lot we can see net framework uh

1708
01:11:03,120 --> 01:11:06,239
net net frame net net framework

1709
01:11:06,239 --> 01:11:09,360
uh register key handle there so it is

1710
01:11:09,360 --> 01:11:12,640
likely that this software or

1711
01:11:12,640 --> 01:11:19,360
malware is uh net.net malware

1712
01:11:19,520 --> 01:11:22,800
we can see a lot of

1713
01:11:22,800 --> 01:11:27,840
empty events um

1714
01:11:28,960 --> 01:11:33,440
user stuff some records triggers

1715
01:11:34,239 --> 01:11:40,320
five one six four

1716
01:11:40,320 --> 01:11:42,799
let's see

1717
01:11:44,560 --> 01:11:47,520
what else okay that was the file so uh

1718
01:11:47,520 --> 01:11:48,480
we got some more

1719
01:11:48,480 --> 01:11:50,960
information about it we know that the

1720
01:11:50,960 --> 01:11:52,719
which user id is running

1721
01:11:52,719 --> 01:11:56,000
running it then we will get the

1722
01:11:56,000 --> 01:11:59,120
get seats so we get the confirmation for

1723
01:11:59,120 --> 01:11:59,840
that

1724
01:11:59,840 --> 01:12:03,280
so we can see that the uh

1725
01:12:03,280 --> 01:12:06,480
don't mind of that the debt exe is being

1726
01:12:06,480 --> 01:12:06,800
run

1727
01:12:06,800 --> 01:12:10,159
on that that user id as we saw we can

1728
01:12:10,159 --> 01:12:11,920
also see that this

1729
01:12:11,920 --> 01:12:15,280
user is part of these groups so

1730
01:12:15,280 --> 01:12:18,080
this malware should also has has these

1731
01:12:18,080 --> 01:12:19,679
rights and we can see that

1732
01:12:19,679 --> 01:12:22,880
this is on the administrator group so

1733
01:12:22,880 --> 01:12:26,800
basically the malware could use

1734
01:12:26,800 --> 01:12:29,760
use the elevated access on the system

1735
01:12:29,760 --> 01:12:30,159
and

1736
01:12:30,159 --> 01:12:34,880
do bad stuff bad stuff against the user

1737
01:12:34,880 --> 01:12:39,440
next let's see the netscan

1738
01:12:39,440 --> 01:12:43,120
where is the netscan there it is

1739
01:12:43,120 --> 01:12:45,520
we can see the network information of

1740
01:12:45,520 --> 01:12:46,800
the of the system

1741
01:12:46,800 --> 01:12:48,880
of course here is not everything but

1742
01:12:48,880 --> 01:12:50,239
some of the some of the

1743
01:12:50,239 --> 01:12:53,040
stuff some of the uh some of the uh

1744
01:12:53,040 --> 01:12:54,239
detective stuff

1745
01:12:54,239 --> 01:12:58,560
okay there is dead looks bad well it

1746
01:12:58,560 --> 01:13:00,800
we can just see from here that it's

1747
01:13:00,800 --> 01:13:03,040
doing uh network traffic so

1748
01:13:03,040 --> 01:13:05,440
it is always just pieces why why this

1749
01:13:05,440 --> 01:13:07,280
called uh

1750
01:13:07,280 --> 01:13:10,719
this called uh filed us uh

1751
01:13:10,719 --> 01:13:14,159
networking let's scrap out from there

1752
01:13:14,159 --> 01:13:17,840
that dot exe boom we can see an

1753
01:13:17,840 --> 01:13:23,760
established connection to this 172 1024

1754
01:13:23,760 --> 01:13:27,199
243 ip address with the

1755
01:13:27,199 --> 01:13:30,480
very high port high port so

1756
01:13:30,480 --> 01:13:33,600
this is something i would uh definitely

1757
01:13:33,600 --> 01:13:36,719
take uh take out of here and uh start

1758
01:13:36,719 --> 01:13:38,159
investigating more because now we

1759
01:13:38,159 --> 01:13:40,800
already know that it is uh communicating

1760
01:13:40,800 --> 01:13:44,080
communicating to the uh to the

1761
01:13:44,080 --> 01:13:47,040
high port hyper server so which is

1762
01:13:47,040 --> 01:13:47,679
always

1763
01:13:47,679 --> 01:13:51,920
suspicious as it is it is on the

1764
01:13:51,920 --> 01:13:55,199
over 1 1024

1765
01:13:55,199 --> 01:14:00,239
so it is it is suspicious

1766
01:14:00,239 --> 01:14:02,880
and it is not a known protocol or known

1767
01:14:02,880 --> 01:14:04,080
software

1768
01:14:04,080 --> 01:14:06,000
of course we can see other stuff as here

1769
01:14:06,000 --> 01:14:09,199
here as well in the in the uh

1770
01:14:09,199 --> 01:14:14,090
the uh netscan we can see uh

1771
01:14:14,090 --> 01:14:17,040
[Music]

1772
01:14:17,040 --> 01:14:19,360
by the way now now that i remember i

1773
01:14:19,360 --> 01:14:21,600
highly recommend you to use this one

1774
01:14:21,600 --> 01:14:23,440
when you are doing memory forensics

1775
01:14:23,440 --> 01:14:25,040
analysis it's find

1776
01:14:25,040 --> 01:14:29,840
evil sons and

1777
01:14:30,080 --> 01:14:34,000
i think it's this one let's see

1778
01:14:34,800 --> 01:14:38,000
hunt for evil oh

1779
01:14:38,000 --> 01:14:42,080
size too weak

1780
01:14:42,080 --> 01:14:44,880
are all the movement blah blah blah no

1781
01:14:44,880 --> 01:14:45,360
it's

1782
01:14:45,360 --> 01:14:47,600
not this no yes it's this one sorry it

1783
01:14:47,600 --> 01:14:48,719
was the first page

1784
01:14:48,719 --> 01:14:50,719
i think it was in the older version vice

1785
01:14:50,719 --> 01:14:52,800
versa the second page was the process

1786
01:14:52,800 --> 01:14:53,280
tree

1787
01:14:53,280 --> 01:14:55,840
so here is the uh like normal one

1788
01:14:55,840 --> 01:14:56,719
windows

1789
01:14:56,719 --> 01:14:59,199
processes so basically you should see uh

1790
01:14:59,199 --> 01:15:01,120
for example how many instances of system

1791
01:15:01,120 --> 01:15:02,800
there should be and which should be the

1792
01:15:02,800 --> 01:15:04,480
start time and uh

1793
01:15:04,480 --> 01:15:08,080
which would be the user account and sms

1794
01:15:08,080 --> 01:15:10,560
exe and so on so a lot of good

1795
01:15:10,560 --> 01:15:12,320
information what is normal on the

1796
01:15:12,320 --> 01:15:14,000
windows so if you see these

1797
01:15:14,000 --> 01:15:16,480
this should be this can be ignored but

1798
01:15:16,480 --> 01:15:19,440
for example if you see easy and

1799
01:15:19,440 --> 01:15:22,800
elsa's you see two elsa's instances

1800
01:15:22,800 --> 01:15:26,480
so uh so uh elsa's if

1801
01:15:26,480 --> 01:15:29,520
you see two elsa elsa's processes you

1802
01:15:29,520 --> 01:15:30,239
should be

1803
01:15:30,239 --> 01:15:33,360
uh considering what is this this

1804
01:15:33,360 --> 01:15:35,840
what is the uh legit one and which one

1805
01:15:35,840 --> 01:15:37,040
is is not

1806
01:15:37,040 --> 01:15:38,880
so which is which you should pay

1807
01:15:38,880 --> 01:15:40,239
attention more

1808
01:15:40,239 --> 01:15:42,560
to and of course there is other stuff as

1809
01:15:42,560 --> 01:15:44,719
well and on the other page there is a

1810
01:15:44,719 --> 01:15:45,840
lot of

1811
01:15:45,840 --> 01:15:49,520
things you you can find from the windows

1812
01:15:49,520 --> 01:15:52,560
windows events and so on and with which

1813
01:15:52,560 --> 01:15:54,159
windows artifacts you should

1814
01:15:54,159 --> 01:15:56,640
check for for example remote access and

1815
01:15:56,640 --> 01:15:58,719
remote execution and so on so

1816
01:15:58,719 --> 01:16:00,880
it's it's a good place to start your

1817
01:16:00,880 --> 01:16:02,960
investigation so keep in mind this hunt

1818
01:16:02,960 --> 01:16:04,840
evil

1819
01:16:04,840 --> 01:16:08,320
final yeah this hunt evil uh poster

1820
01:16:08,320 --> 01:16:11,840
poster from the um suns forensics

1821
01:16:11,840 --> 01:16:14,640
it's it's it's it's a pretty good one

1822
01:16:14,640 --> 01:16:15,360
yeah

1823
01:16:15,360 --> 01:16:18,480
but yeah so uh uh and and from that

1824
01:16:18,480 --> 01:16:20,880
that i was also going to say that the

1825
01:16:20,880 --> 01:16:23,679
sbc hosts we see here i think it's here

1826
01:16:23,679 --> 01:16:25,280
it should be at least here as we see

1827
01:16:25,280 --> 01:16:27,040
hosts so uh

1828
01:16:27,040 --> 01:16:30,800
there can be as many uh as many

1829
01:16:30,800 --> 01:16:34,000
as as possible so so uh it

1830
01:16:34,000 --> 01:16:37,120
is not uh it is not surprising that we

1831
01:16:37,120 --> 01:16:37,440
have

1832
01:16:37,440 --> 01:16:41,360
svc host but if you see svc host without

1833
01:16:41,360 --> 01:16:42,960
any comment line

1834
01:16:42,960 --> 01:16:46,159
it is super suspicious so for example

1835
01:16:46,159 --> 01:16:47,280
here

1836
01:16:47,280 --> 01:16:51,280
we let's scrap crap

1837
01:16:51,280 --> 01:16:54,640
after one host

1838
01:16:54,640 --> 01:16:57,679
svc host

1839
01:16:57,679 --> 01:17:01,440
cmd line so for example we can see here

1840
01:17:01,440 --> 01:17:02,320
that

1841
01:17:02,320 --> 01:17:05,600
all of these svc hosts have a

1842
01:17:05,600 --> 01:17:08,320
comment line so they have some arguments

1843
01:17:08,320 --> 01:17:09,040
given

1844
01:17:09,040 --> 01:17:12,400
into the svc host exe

1845
01:17:12,400 --> 01:17:15,199
so please that in keep that in mind that

1846
01:17:15,199 --> 01:17:16,080
that

1847
01:17:16,080 --> 01:17:18,480
if you see svc hosts without any

1848
01:17:18,480 --> 01:17:19,280
arguments it's

1849
01:17:19,280 --> 01:17:21,199
super suspicious and should be always

1850
01:17:21,199 --> 01:17:22,560
investigated

1851
01:17:22,560 --> 01:17:25,199
and uh and this is pretty normal in in

1852
01:17:25,199 --> 01:17:25,840
malware

1853
01:17:25,840 --> 01:17:28,560
that that the svc host is being somewhat

1854
01:17:28,560 --> 01:17:30,000
exploited also

1855
01:17:30,000 --> 01:17:32,239
other of these processes so this is

1856
01:17:32,239 --> 01:17:33,679
really good really good

1857
01:17:33,679 --> 01:17:37,679
uh one uh the most common ones what i

1858
01:17:37,679 --> 01:17:39,440
have seen are the svc host and the

1859
01:17:39,440 --> 01:17:40,159
system

1860
01:17:40,159 --> 01:17:44,400
so these two are being being

1861
01:17:44,400 --> 01:17:46,719
how would i say mimicked by by the

1862
01:17:46,719 --> 01:17:50,080
malware so malware is trying to

1863
01:17:50,080 --> 01:17:52,800
fake that they are legit processes by by

1864
01:17:52,800 --> 01:17:59,440
using those

1865
01:17:59,440 --> 01:18:01,600
see i'm checking the time as well so one

1866
01:18:01,600 --> 01:18:02,719
and a half hours

1867
01:18:02,719 --> 01:18:05,440
gone and we are almost in the half way

1868
01:18:05,440 --> 01:18:06,080
so we

1869
01:18:06,080 --> 01:18:07,760
i think we need to continue with this

1870
01:18:07,760 --> 01:18:10,159
one uh

1871
01:18:10,159 --> 01:18:12,480
i will show you one more thing before we

1872
01:18:12,480 --> 01:18:14,800
continue

1873
01:18:14,800 --> 01:18:18,239
so from here

1874
01:18:18,239 --> 01:18:21,840
so uh i i will skip the number four and

1875
01:18:21,840 --> 01:18:23,280
five in the process and

1876
01:18:23,280 --> 01:18:26,800
go straight to the uh extraction

1877
01:18:26,800 --> 01:18:30,800
so we can dump registry hives

1878
01:18:30,800 --> 01:18:33,440
so i have dumped already them from the

1879
01:18:33,440 --> 01:18:34,239
memory

1880
01:18:34,239 --> 01:18:36,800
so here is the registry hive files from

1881
01:18:36,800 --> 01:18:38,000
the from this

1882
01:18:38,000 --> 01:18:40,000
from extracted from the memory you can

1883
01:18:40,000 --> 01:18:41,520
use volatility

1884
01:18:41,520 --> 01:18:45,120
it's the wall that

1885
01:18:46,159 --> 01:18:49,600
there is this ricky's tree no it's dump

1886
01:18:49,600 --> 01:18:51,199
registry

1887
01:18:51,199 --> 01:18:54,560
dump registry and it needs a

1888
01:18:54,560 --> 01:18:57,520
dump directory as parameter so you can

1889
01:18:57,520 --> 01:18:59,840
use for example output and then it will

1890
01:18:59,840 --> 01:19:01,920
take some time and output these files

1891
01:19:01,920 --> 01:19:03,920
there i'm saying this because we need

1892
01:19:03,920 --> 01:19:05,440
this in the next

1893
01:19:05,440 --> 01:19:08,480
next section of the of the course

1894
01:19:08,480 --> 01:19:11,520
and uh of also a good

1895
01:19:11,520 --> 01:19:14,320
thing to know is that we have this file

1896
01:19:14,320 --> 01:19:14,800
scan

1897
01:19:14,800 --> 01:19:18,560
command uh plugin which scans all the

1898
01:19:18,560 --> 01:19:20,320
files from the uh

1899
01:19:20,320 --> 01:19:22,960
from the memory and you can then use

1900
01:19:22,960 --> 01:19:25,199
other comments to extract files from

1901
01:19:25,199 --> 01:19:25,840
here so

1902
01:19:25,840 --> 01:19:27,520
let's see if we have for example that

1903
01:19:27,520 --> 01:19:30,000
exe here yes we do have

1904
01:19:30,000 --> 01:19:33,199
so we could basically well we are pretty

1905
01:19:33,199 --> 01:19:34,000
interested

1906
01:19:34,000 --> 01:19:36,960
what's in there so we can see that well

1907
01:19:36,960 --> 01:19:39,440
other files of of this directory are not

1908
01:19:39,440 --> 01:19:40,800
in the system but there is

1909
01:19:40,800 --> 01:19:44,320
actually the at least some parts of the

1910
01:19:44,320 --> 01:19:48,480
of the exe resides on the memory so you

1911
01:19:48,480 --> 01:19:50,159
can dump it and analyze them

1912
01:19:50,159 --> 01:19:53,679
that that for example so file scan

1913
01:19:53,679 --> 01:19:56,560
and dump registry things you should

1914
01:19:56,560 --> 01:19:57,520
remember

1915
01:19:57,520 --> 01:19:59,760
let's continue with the windows registry

1916
01:19:59,760 --> 01:20:01,920
analysis

1917
01:20:01,920 --> 01:20:04,880
so i think all of you have seen this uh

1918
01:20:04,880 --> 01:20:06,800
this registry editor at some

1919
01:20:06,800 --> 01:20:08,800
some point of your life of course you if

1920
01:20:08,800 --> 01:20:10,960
you are hardcore unix or linux user and

1921
01:20:10,960 --> 01:20:12,159
haven't seen windows for

1922
01:20:12,159 --> 01:20:14,400
years this probably doesn't look

1923
01:20:14,400 --> 01:20:16,000
familiar to you

1924
01:20:16,000 --> 01:20:18,400
but uh you should at least know know

1925
01:20:18,400 --> 01:20:19,920
that this exists

1926
01:20:19,920 --> 01:20:23,600
in the window so basically uh in windows

1927
01:20:23,600 --> 01:20:27,199
we have um five uh registry hives we

1928
01:20:27,199 --> 01:20:28,239
have the uh

1929
01:20:28,239 --> 01:20:31,920
uh hockey hawk k

1930
01:20:31,920 --> 01:20:35,280
c r h k c u h k l m

1931
01:20:35,280 --> 01:20:39,199
h k u and h k c c so these are different

1932
01:20:39,199 --> 01:20:39,600
uh

1933
01:20:39,600 --> 01:20:41,679
different uh hives that store different

1934
01:20:41,679 --> 01:20:43,199
information of the system

1935
01:20:43,199 --> 01:20:45,040
today we will be investigating more on

1936
01:20:45,040 --> 01:20:49,040
the hk hklm and hkcu

1937
01:20:49,040 --> 01:20:52,880
the hklm basically

1938
01:20:52,880 --> 01:20:54,719
has the information about the running

1939
01:20:54,719 --> 01:20:55,920
system

1940
01:20:55,920 --> 01:20:59,600
uh running i'm sorry the running system

1941
01:20:59,600 --> 01:21:02,560
and its configuration so basically all

1942
01:21:02,560 --> 01:21:04,480
the system configuration is stored to

1943
01:21:04,480 --> 01:21:06,719
that registry hive and the current user

1944
01:21:06,719 --> 01:21:08,880
has the user configuration

1945
01:21:08,880 --> 01:21:12,239
user behavior stored

1946
01:21:12,239 --> 01:21:15,520
in in that so these are the files that

1947
01:21:15,520 --> 01:21:16,320
you should be

1948
01:21:16,320 --> 01:21:18,239
well these are the hives you should be

1949
01:21:18,239 --> 01:21:19,840
investigating when you're investigating

1950
01:21:19,840 --> 01:21:20,320
uh

1951
01:21:20,320 --> 01:21:22,560
incident of course sometimes you need to

1952
01:21:22,560 --> 01:21:24,080
see for example the

1953
01:21:24,080 --> 01:21:28,159
hku hkcc or hkcr as well but today we

1954
01:21:28,159 --> 01:21:30,400
are focusing on these two ones

1955
01:21:30,400 --> 01:21:35,199
so the registry on windows

1956
01:21:35,199 --> 01:21:37,840
is uh pretty simple and straightforward

1957
01:21:37,840 --> 01:21:38,480
it has

1958
01:21:38,480 --> 01:21:41,760
registry hive which is the hklm in this

1959
01:21:41,760 --> 01:21:42,480
case

1960
01:21:42,480 --> 01:21:45,679
then we you have will have keys and then

1961
01:21:45,679 --> 01:21:48,159
sub keys as well if for example the run

1962
01:21:48,159 --> 01:21:49,360
has a

1963
01:21:49,360 --> 01:21:52,480
sub keys or or it would be listed down

1964
01:21:52,480 --> 01:21:53,360
there

1965
01:21:53,360 --> 01:21:56,239
then we have values for example this is

1966
01:21:56,239 --> 01:21:58,159
on my computer we have the logitech

1967
01:21:58,159 --> 01:22:00,639
presentation security health of windows

1968
01:22:00,639 --> 01:22:04,159
windows av running

1969
01:22:04,159 --> 01:22:06,480
running on the startup the run key is is

1970
01:22:06,480 --> 01:22:08,639
pretty common persistence for malware as

1971
01:22:08,639 --> 01:22:09,360
well

1972
01:22:09,360 --> 01:22:12,159
like it is for locket it saves uh are

1973
01:22:12,159 --> 01:22:12,880
these con

1974
01:22:12,880 --> 01:22:15,360
are these do do these two mean the same

1975
01:22:15,360 --> 01:22:16,080
thing no

1976
01:22:16,080 --> 01:22:17,840
but yeah so look at the presentation

1977
01:22:17,840 --> 01:22:20,480
which by the way i'm using right now

1978
01:22:20,480 --> 01:22:22,840
is uh is being executed during the

1979
01:22:22,840 --> 01:22:24,880
startup as well and

1980
01:22:24,880 --> 01:22:27,679
you can see here is the value type so it

1981
01:22:27,679 --> 01:22:28,080
has

1982
01:22:28,080 --> 01:22:29,760
multiple different types and then of

1983
01:22:29,760 --> 01:22:32,239
course the value so if you're executing

1984
01:22:32,239 --> 01:22:34,239
the binary from somewhere you can use

1985
01:22:34,239 --> 01:22:35,760
this one and if you

1986
01:22:35,760 --> 01:22:38,400
uh if you know about the penetration

1987
01:22:38,400 --> 01:22:40,400
testing there is a lot of

1988
01:22:40,400 --> 01:22:42,960
ways you can for example do persistence

1989
01:22:42,960 --> 01:22:44,239
using register keys

1990
01:22:44,239 --> 01:22:46,560
run is just one example you can for

1991
01:22:46,560 --> 01:22:47,280
example

1992
01:22:47,280 --> 01:22:50,719
use the set h c key so hotkeys

1993
01:22:50,719 --> 01:22:53,440
uh sticky keys so when you press sticky

1994
01:22:53,440 --> 01:22:54,960
keys you can open the

1995
01:22:54,960 --> 01:22:57,840
system shell on the system and bypassing

1996
01:22:57,840 --> 01:22:59,040
the windows login screen

1997
01:22:59,040 --> 01:23:01,040
so also you can play a lot around with

1998
01:23:01,040 --> 01:23:03,440
the registry and and do a lot of

1999
01:23:03,440 --> 01:23:06,560
nasty stuff for the user and also

2000
01:23:06,560 --> 01:23:10,400
uh the run once is also another one but

2001
01:23:10,400 --> 01:23:11,440
it's it's only run

2002
01:23:11,440 --> 01:23:14,159
run once when the user next time logins

2003
01:23:14,159 --> 01:23:14,639
but

2004
01:23:14,639 --> 01:23:17,440
if if it's on the run registry uh it

2005
01:23:17,440 --> 01:23:19,679
will be executed every time the user log

2006
01:23:19,679 --> 01:23:21,280
ons to the system

2007
01:23:21,280 --> 01:23:23,360
and this is called run key so if i talk

2008
01:23:23,360 --> 01:23:24,800
about run key is

2009
01:23:24,800 --> 01:23:28,239
that one so where are these uh registry

2010
01:23:28,239 --> 01:23:29,840
hives stored on the system

2011
01:23:29,840 --> 01:23:32,840
let me see i will open the discord as

2012
01:23:32,840 --> 01:23:35,840
well

2013
01:23:42,400 --> 01:23:45,679
any good tools to do for n64 boot sector

2014
01:23:45,679 --> 01:23:46,840
malware

2015
01:23:46,840 --> 01:23:49,840
huh

2016
01:23:50,560 --> 01:23:52,400
any good tools you forensics for the

2017
01:23:52,400 --> 01:23:53,600
books for

2018
01:23:53,600 --> 01:23:55,360
well you need of course it's it's a

2019
01:23:55,360 --> 01:23:56,719
system malware it's it's

2020
01:23:56,719 --> 01:23:59,120
it's usually what do you mean by boot

2021
01:23:59,120 --> 01:24:00,159
sector malware

2022
01:24:00,159 --> 01:24:02,880
something that resides on the efi or

2023
01:24:02,880 --> 01:24:04,159
wifi

2024
01:24:04,159 --> 01:24:07,360
section right so basically you need to

2025
01:24:07,360 --> 01:24:08,800
extract the malware there and

2026
01:24:08,800 --> 01:24:11,360
uh then then you can investigate it with

2027
01:24:11,360 --> 01:24:12,560
the normal tools

2028
01:24:12,560 --> 01:24:16,159
it is it is called like like any other

2029
01:24:16,159 --> 01:24:19,920
wires as well and uh what's the same

2030
01:24:19,920 --> 01:24:23,040
yes it was ftk imager uh the memory

2031
01:24:23,040 --> 01:24:23,679
dumper

2032
01:24:23,679 --> 01:24:26,880
and you can find it uh well the ar

2033
01:24:26,880 --> 01:24:29,120
also wrote it down but you can find it

2034
01:24:29,120 --> 01:24:31,440
from the slides as well

2035
01:24:31,440 --> 01:24:35,839
so where are the security hives stored

2036
01:24:36,480 --> 01:24:40,320
the the config

2037
01:24:40,320 --> 01:24:43,360
directory has four different

2038
01:24:43,360 --> 01:24:45,679
uh well it has a lot of different files

2039
01:24:45,679 --> 01:24:46,719
but uh

2040
01:24:46,719 --> 01:24:51,360
system file has the hklm

2041
01:24:51,360 --> 01:24:54,639
hklm hklm

2042
01:24:54,639 --> 01:24:57,199
system registry uh software has the

2043
01:24:57,199 --> 01:24:59,040
software security has the security and

2044
01:24:59,040 --> 01:25:00,320
some has the sum

2045
01:25:00,320 --> 01:25:03,440
some database is by the way the place

2046
01:25:03,440 --> 01:25:04,239
where micros

2047
01:25:04,239 --> 01:25:06,880
microsoft stores all the user local user

2048
01:25:06,880 --> 01:25:08,960
information and the groups they belong

2049
01:25:08,960 --> 01:25:09,360
to

2050
01:25:09,360 --> 01:25:12,400
so if you're investigating groups and

2051
01:25:12,400 --> 01:25:15,120
seats of any user or for example how

2052
01:25:15,120 --> 01:25:16,960
many times the user has logged onto the

2053
01:25:16,960 --> 01:25:19,120
system you can find it from the sam

2054
01:25:19,120 --> 01:25:23,040
hive then the

2055
01:25:23,040 --> 01:25:26,560
the current user stuff uh you can find

2056
01:25:26,560 --> 01:25:28,239
from the nd user dot

2057
01:25:28,239 --> 01:25:31,600
dot which is uh which which

2058
01:25:31,600 --> 01:25:34,639
is present on the user profile so if if

2059
01:25:34,639 --> 01:25:36,159
you are for example

2060
01:25:36,159 --> 01:25:39,840
uh sponge c users sponge should have the

2061
01:25:39,840 --> 01:25:42,639
entity user

2062
01:25:44,960 --> 01:25:48,719
it should have the uh it should have

2063
01:25:48,719 --> 01:25:52,000
the entity user dot

2064
01:25:52,000 --> 01:25:55,679
dot file then there is also

2065
01:25:55,679 --> 01:25:58,960
uh shellbacks userclass.dat

2066
01:25:58,960 --> 01:26:01,679
which has a lot of information which

2067
01:26:01,679 --> 01:26:03,760
directories the user has accessed and so

2068
01:26:03,760 --> 01:26:04,239
on

2069
01:26:04,239 --> 01:26:06,960
and it will be on the app.localmix

2070
01:26:06,960 --> 01:26:09,199
windows user class.d8t

2071
01:26:09,199 --> 01:26:11,120
so these are the files you can analyze

2072
01:26:11,120 --> 01:26:14,880
with the registry analysis tools

2073
01:26:15,520 --> 01:26:18,800
then uh one word about the transaction

2074
01:26:18,800 --> 01:26:19,360
log so

2075
01:26:19,360 --> 01:26:22,719
microsoft does not write all the

2076
01:26:22,719 --> 01:26:25,520
changes in the request straight to the

2077
01:26:25,520 --> 01:26:26,800
registry hive files

2078
01:26:26,800 --> 01:26:30,719
it will uh keep a journal type of file

2079
01:26:30,719 --> 01:26:34,000
uh that is called log and there can be

2080
01:26:34,000 --> 01:26:36,159
multiple of these files you can have log

2081
01:26:36,159 --> 01:26:38,400
one log two and so on

2082
01:26:38,400 --> 01:26:40,560
so if you are starting to analyze and

2083
01:26:40,560 --> 01:26:42,560
extracting these from the

2084
01:26:42,560 --> 01:26:45,679
disk you might want to

2085
01:26:45,679 --> 01:26:48,880
well you need to rebuild them as a one

2086
01:26:48,880 --> 01:26:51,679
file because otherwise you will only

2087
01:26:51,679 --> 01:26:52,400
have

2088
01:26:52,400 --> 01:26:55,840
old all the registry uh entries there

2089
01:26:55,840 --> 01:26:57,679
and for example the most recent ones

2090
01:26:57,679 --> 01:27:00,800
will likely not be part of the file

2091
01:27:00,800 --> 01:27:03,760
registry hive file so you can use a

2092
01:27:03,760 --> 01:27:05,360
recuper

2093
01:27:05,360 --> 01:27:07,600
tool uh that can be installed easily

2094
01:27:07,600 --> 01:27:08,800
with the

2095
01:27:08,800 --> 01:27:12,400
python bit version 3 and and

2096
01:27:12,400 --> 01:27:15,920
it will uh it will uh

2097
01:27:15,920 --> 01:27:19,760
include the transaction locks to the uh

2098
01:27:19,760 --> 01:27:22,080
hi files for example here is an example

2099
01:27:22,080 --> 01:27:24,320
of anti-user.dat

2100
01:27:24,320 --> 01:27:27,280
and you can use uh yeah you can use the

2101
01:27:27,280 --> 01:27:28,960
regis transaction locks

2102
01:27:28,960 --> 01:27:32,000
tool to recover the

2103
01:27:32,000 --> 01:27:33,920
whole whole entry usually that so you

2104
01:27:33,920 --> 01:27:35,440
will have a whole file and

2105
01:27:35,440 --> 01:27:38,960
all the uh necessary uh registries uh

2106
01:27:38,960 --> 01:27:41,199
there so please remind this when you are

2107
01:27:41,199 --> 01:27:43,360
doing registry analysis without this uh

2108
01:27:43,360 --> 01:27:44,960
you will get a lot of hate on twitter

2109
01:27:44,960 --> 01:27:46,560
like i did some time ago

2110
01:27:46,560 --> 01:27:49,679
from actually a developer of the

2111
01:27:49,679 --> 01:27:52,800
greg ripper 3.0 tool the key that

2112
01:27:52,800 --> 01:27:54,719
but let's not talk about that one let's

2113
01:27:54,719 --> 01:27:58,000
talk about how great direct referral is

2114
01:27:58,000 --> 01:28:00,480
it's pretty good one on especially on

2115
01:28:00,480 --> 01:28:01,199
linux

2116
01:28:01,199 --> 01:28:04,800
linux system so you can actually

2117
01:28:04,800 --> 01:28:07,440
easily extract the information you need

2118
01:28:07,440 --> 01:28:08,159
from the

2119
01:28:08,159 --> 01:28:12,239
registry samples of by using that tool

2120
01:28:12,239 --> 01:28:14,639
also if you're using windows as a host

2121
01:28:14,639 --> 01:28:17,040
system you can use the registry explorer

2122
01:28:17,040 --> 01:28:19,040
by eric chimerman his tools are

2123
01:28:19,040 --> 01:28:21,440
great by the way and uh he was also part

2124
01:28:21,440 --> 01:28:22,400
of that twitter

2125
01:28:22,400 --> 01:28:25,600
thread where where he told me something

2126
01:28:25,600 --> 01:28:27,520
but yeah it was a talk about the

2127
01:28:27,520 --> 01:28:29,440
transaction locks because

2128
01:28:29,440 --> 01:28:31,679
they are often overlooked and that's the

2129
01:28:31,679 --> 01:28:33,600
reason why i'm sharing this information

2130
01:28:33,600 --> 01:28:34,719
to you and saying that

2131
01:28:34,719 --> 01:28:37,120
do not overlook the transaction locks

2132
01:28:37,120 --> 01:28:38,239
because you will miss a lot of

2133
01:28:38,239 --> 01:28:39,760
information

2134
01:28:39,760 --> 01:28:42,000
and by the way the request to explore

2135
01:28:42,000 --> 01:28:43,520
the timmerman's tools

2136
01:28:43,520 --> 01:28:46,159
uh it will tell you if the transaction

2137
01:28:46,159 --> 01:28:48,239
locks have not been loaded to this

2138
01:28:48,239 --> 01:28:50,560
registry hive so if you are loading

2139
01:28:50,560 --> 01:28:52,960
the broken end user that to there it

2140
01:28:52,960 --> 01:28:54,159
will say that hey

2141
01:28:54,159 --> 01:28:56,320
hey you are missing some transaction

2142
01:28:56,320 --> 01:28:59,040
locks please give them to me and i will

2143
01:28:59,040 --> 01:29:00,800
build it to you and you can explore the

2144
01:29:00,800 --> 01:29:02,960
whole thing while the rec reaper doesn't

2145
01:29:02,960 --> 01:29:04,320
say anything and just

2146
01:29:04,320 --> 01:29:07,360
returns you the data from the

2147
01:29:07,360 --> 01:29:09,840
from the plugins you are running against

2148
01:29:09,840 --> 01:29:10,560
the

2149
01:29:10,560 --> 01:29:13,679
register high files but the

2150
01:29:13,679 --> 01:29:16,960
regripper has more specific plugins so

2151
01:29:16,960 --> 01:29:18,960
if you are searching for example the run

2152
01:29:18,960 --> 01:29:19,679
keys it's

2153
01:29:19,679 --> 01:29:23,040
easier to use it than on the registrar

2154
01:29:23,040 --> 01:29:25,600
explorer you need to browse to the uh

2155
01:29:25,600 --> 01:29:29,360
exact exact the uh

2156
01:29:29,360 --> 01:29:32,880
file and we are using recreater as

2157
01:29:32,880 --> 01:29:36,000
uh as a dmo and i i can also demo the

2158
01:29:36,000 --> 01:29:37,920
registry explorer if you want to but

2159
01:29:37,920 --> 01:29:38,400
it's

2160
01:29:38,400 --> 01:29:40,560
something you should learn or at least

2161
01:29:40,560 --> 01:29:41,760
know about

2162
01:29:41,760 --> 01:29:45,440
then of course we have a cheat sheet for

2163
01:29:45,440 --> 01:29:47,920
wreck rebar as well um use this while

2164
01:29:47,920 --> 01:29:49,520
analyzing the uh

2165
01:29:49,520 --> 01:29:53,679
actual actual forensics ctf

2166
01:29:53,679 --> 01:29:57,040
it's time for action so

2167
01:29:57,679 --> 01:30:00,800
let's go here i

2168
01:30:00,800 --> 01:30:04,480
think i don't have okay okay i will i

2169
01:30:04,480 --> 01:30:05,520
will show you

2170
01:30:05,520 --> 01:30:07,920
my on my backpack backup plan i will

2171
01:30:07,920 --> 01:30:09,040
show on my

2172
01:30:09,040 --> 01:30:11,760
local system

2173
01:30:14,960 --> 01:30:17,199
i'm in the wrong place i'm in the ctf

2174
01:30:17,199 --> 01:30:18,800
sorry

2175
01:30:18,800 --> 01:30:23,040
sorry for spoilers uh

2176
01:30:26,080 --> 01:30:28,320
yes

2177
01:30:30,159 --> 01:30:33,360
so uh i think i yes i have this

2178
01:30:33,360 --> 01:30:36,960
this system is uh

2179
01:30:37,199 --> 01:30:41,840
i think this is yes this is uh

2180
01:30:41,840 --> 01:30:45,040
uh the newest long-term

2181
01:30:45,040 --> 01:30:48,639
support uh ubuntu uh with the

2182
01:30:48,639 --> 01:30:51,440
shift and remnux tools installed on and

2183
01:30:51,440 --> 01:30:52,320
this is uh

2184
01:30:52,320 --> 01:30:55,040
we sell we associate them with zl2

2185
01:30:55,040 --> 01:30:57,280
actually

2186
01:30:57,280 --> 01:31:00,719
uh any opinion on timmerman's cape

2187
01:31:00,719 --> 01:31:04,080
or timeline explorer i will put

2188
01:31:04,080 --> 01:31:06,960
larger fonts here

2189
01:31:09,040 --> 01:31:12,560
yes i do have opinions cape is awesome i

2190
01:31:12,560 --> 01:31:15,840
like it and timeline explorer is not

2191
01:31:15,840 --> 01:31:16,719
that great

2192
01:31:16,719 --> 01:31:19,920
it's good for analyzing timelines but

2193
01:31:19,920 --> 01:31:22,239
it is there are better tools for that

2194
01:31:22,239 --> 01:31:23,199
for example

2195
01:31:23,199 --> 01:31:26,000
time sketch is really good for analyzing

2196
01:31:26,000 --> 01:31:26,960
timelines

2197
01:31:26,960 --> 01:31:31,440
so ditch the timeline explorer and use

2198
01:31:31,440 --> 01:31:35,199
uh use time sketch you can run the time

2199
01:31:35,199 --> 01:31:37,040
sketch on docker so it's it's pretty

2200
01:31:37,040 --> 01:31:38,960
easy to set up

2201
01:31:38,960 --> 01:31:40,880
of course the timeline explorer is

2202
01:31:40,880 --> 01:31:42,719
easier but uh

2203
01:31:42,719 --> 01:31:46,239
why wouldn't you want to run docker

2204
01:31:46,239 --> 01:31:50,320
so uh where was i so let's look at the

2205
01:31:50,320 --> 01:31:51,440
uh

2206
01:31:51,440 --> 01:31:54,560
file so here is the list of the

2207
01:31:54,560 --> 01:31:58,080
list of the uh

2208
01:31:58,080 --> 01:32:01,840
registries i have uh dumped

2209
01:32:01,840 --> 01:32:05,199
uh from the uh

2210
01:32:05,199 --> 01:32:08,800
from the uh memory so we have a lot of

2211
01:32:08,800 --> 01:32:10,880
nt as we can see we have a lot of nt

2212
01:32:10,880 --> 01:32:12,159
user dots here

2213
01:32:12,159 --> 01:32:15,280
so i think we should define first find

2214
01:32:15,280 --> 01:32:15,600
out

2215
01:32:15,600 --> 01:32:17,520
which one is the correct one i'm

2216
01:32:17,520 --> 01:32:18,960
starting from the bottom

2217
01:32:18,960 --> 01:32:22,560
and i'm doing uh oh windows copy paste

2218
01:32:22,560 --> 01:32:25,120
awesome and i will run a profiler

2219
01:32:25,120 --> 01:32:26,560
against it and i will

2220
01:32:26,560 --> 01:32:28,800
boom check that the first one was right

2221
01:32:28,800 --> 01:32:30,000
and i can see that this is

2222
01:32:30,000 --> 01:32:32,400
this is uh likely this punch user as the

2223
01:32:32,400 --> 01:32:33,280
onedrive

2224
01:32:33,280 --> 01:32:36,639
path is revealing that the this this

2225
01:32:36,639 --> 01:32:40,159
ng ng nt user d80

2226
01:32:40,159 --> 01:32:44,320
belongs to the uh user sponge

2227
01:32:44,320 --> 01:32:46,239
so now we know that this one is the

2228
01:32:46,239 --> 01:32:47,520
correct one and i

2229
01:32:47,520 --> 01:32:52,719
tend to uh i tend to

2230
01:32:52,800 --> 01:32:56,080
i tend to copy copy this one uh to

2231
01:32:56,080 --> 01:32:59,440
uh to uh remember it so i will do this

2232
01:32:59,440 --> 01:33:00,239
one

2233
01:33:00,239 --> 01:33:02,960
it will be now so it will be easier

2234
01:33:02,960 --> 01:33:05,199
easier to

2235
01:33:05,199 --> 01:33:09,120
now to see um

2236
01:33:09,120 --> 01:33:12,080
investigate it and uh one thing you

2237
01:33:12,080 --> 01:33:13,840
should remember about the

2238
01:33:13,840 --> 01:33:17,120
rec repair uh it's the minus c minus

2239
01:33:17,120 --> 01:33:20,239
l which will list the uh all the plugins

2240
01:33:20,239 --> 01:33:22,560
and then you can nicely just grab

2241
01:33:22,560 --> 01:33:26,080
the things you want uh grapple with eyes

2242
01:33:26,080 --> 01:33:29,280
so we don't care about the

2243
01:33:29,280 --> 01:33:32,639
uh how is written is it lower or

2244
01:33:32,639 --> 01:33:37,840
upper case case insensitive

2245
01:33:44,159 --> 01:33:47,760
so it's alphabetical order and now we

2246
01:33:47,760 --> 01:33:50,000
can see which tools are available on on

2247
01:33:50,000 --> 01:33:53,040
the uh to run against this

2248
01:33:53,040 --> 01:33:55,600
into user dot dot so first of all we

2249
01:33:55,600 --> 01:33:56,880
could see

2250
01:33:56,880 --> 01:33:59,760
for example the run key if we have any

2251
01:33:59,760 --> 01:34:01,679
uh

2252
01:34:01,679 --> 01:34:03,199
if we have any persistence by the

2253
01:34:03,199 --> 01:34:05,840
malware here we can see that we have

2254
01:34:05,840 --> 01:34:09,199
some windows malware onedrive installed

2255
01:34:09,199 --> 01:34:09,760
on the

2256
01:34:09,760 --> 01:34:11,840
system which by the way comes with the

2257
01:34:11,840 --> 01:34:13,120
windows i think

2258
01:34:13,120 --> 01:34:16,480
automatically but you're gonna i think

2259
01:34:16,480 --> 01:34:17,040
you can

2260
01:34:17,040 --> 01:34:20,080
remove it and uh

2261
01:34:20,080 --> 01:34:23,920
and uh and uh nothing else

2262
01:34:23,920 --> 01:34:27,520
here only one driver related stuff

2263
01:34:27,520 --> 01:34:31,600
by the way it is not that uncommon to

2264
01:34:31,600 --> 01:34:34,719
mimic to hide your malware by using

2265
01:34:34,719 --> 01:34:37,760
some kind of one drive related stuff and

2266
01:34:37,760 --> 01:34:38,320
also

2267
01:34:38,320 --> 01:34:42,239
it would it would also

2268
01:34:42,239 --> 01:34:44,800
uh be kind of misleading to

2269
01:34:44,800 --> 01:34:46,480
investigators so if you are

2270
01:34:46,480 --> 01:34:49,600
thinking of hiding malware onedrive is

2271
01:34:49,600 --> 01:34:51,920
a pretty good place and if you are a

2272
01:34:51,920 --> 01:34:54,400
forensicator

2273
01:34:54,400 --> 01:34:56,719
please pay attention to for example

2274
01:34:56,719 --> 01:34:59,280
these binaries if they are actually

2275
01:34:59,280 --> 01:35:03,040
one drive or not so

2276
01:35:03,040 --> 01:35:06,239
that's that's uh one one thing to check

2277
01:35:06,239 --> 01:35:08,239
when you are investigating then for

2278
01:35:08,239 --> 01:35:10,719
example runamero so we can see uh

2279
01:35:10,719 --> 01:35:13,119
you know the windows run dialog when you

2280
01:35:13,119 --> 01:35:14,400
press the windows button

2281
01:35:14,400 --> 01:35:17,520
and r you can run you would see here

2282
01:35:17,520 --> 01:35:19,600
what what the user has typed

2283
01:35:19,600 --> 01:35:24,320
word word it's the uh

2284
01:35:25,360 --> 01:35:29,199
it's the word wheel query so

2285
01:35:29,199 --> 01:35:34,080
it's the uh if if the user had used the

2286
01:35:34,080 --> 01:35:38,560
windows what is this called the windows

2287
01:35:38,560 --> 01:35:40,320
suppress the windows button and open the

2288
01:35:40,320 --> 01:35:42,080
windows menu this one

2289
01:35:42,080 --> 01:35:45,280
and if you search there those searches

2290
01:35:45,280 --> 01:35:45,840
would be

2291
01:35:45,840 --> 01:35:49,199
appear on the word wheel query as well

2292
01:35:49,199 --> 01:35:52,400
so this is pretty pretty cool to see

2293
01:35:52,400 --> 01:35:54,880
what kind of stuff here is so if the

2294
01:35:54,880 --> 01:35:56,880
user had used windchip

2295
01:35:56,880 --> 01:36:00,880
or if the user had used winrar

2296
01:36:00,880 --> 01:36:04,880
we can see these so as we can see here

2297
01:36:04,880 --> 01:36:06,560
is nothing

2298
01:36:06,560 --> 01:36:09,920
but let's see other stuff as well 70

2299
01:36:09,920 --> 01:36:11,840
would be nice i'm sure if there is a

2300
01:36:11,840 --> 01:36:13,760
plugin for that

2301
01:36:13,760 --> 01:36:15,840
seven chips there is let's see if there

2302
01:36:15,840 --> 01:36:18,800
is anything on this user

2303
01:36:18,800 --> 01:36:22,239
seven chip seven zip not

2304
01:36:22,239 --> 01:36:24,560
found okay so this is actually looking

2305
01:36:24,560 --> 01:36:25,280
from

2306
01:36:25,280 --> 01:36:28,960
soft yes this is uh

2307
01:36:28,960 --> 01:36:32,719
what what was it here as well

2308
01:36:32,719 --> 01:36:36,000
see the seven tip

2309
01:36:36,320 --> 01:36:39,199
yes it's using from an end user so so

2310
01:36:39,199 --> 01:36:40,480
here was no

2311
01:36:40,480 --> 01:36:43,440
entries about the seven tip seven tip on

2312
01:36:43,440 --> 01:36:43,840
this

2313
01:36:43,840 --> 01:36:46,400
machine we should we could see recent

2314
01:36:46,400 --> 01:36:49,040
docs if the user has opened any docs

2315
01:36:49,040 --> 01:36:51,199
uh i think there is some problems with

2316
01:36:51,199 --> 01:36:52,480
the uh

2317
01:36:52,480 --> 01:36:54,960
these uh uh well of course here is

2318
01:36:54,960 --> 01:36:55,520
something

2319
01:36:55,520 --> 01:36:58,239
there are some problems with the uh with

2320
01:36:58,239 --> 01:36:59,360
the uh

2321
01:36:59,360 --> 01:37:02,400
with this uh small memory dump as as the

2322
01:37:02,400 --> 01:37:02,880
wreckage

2323
01:37:02,880 --> 01:37:06,080
uh these uh hives might not al

2324
01:37:06,080 --> 01:37:08,800
also be in in their full size in the

2325
01:37:08,800 --> 01:37:09,840
memory

2326
01:37:09,840 --> 01:37:12,159
uh so so if you are making memory

2327
01:37:12,159 --> 01:37:14,080
forensic challenges please remind you

2328
01:37:14,080 --> 01:37:16,320
put at least eight gigabytes memory for

2329
01:37:16,320 --> 01:37:21,840
the for the virtual machine next

2330
01:37:23,600 --> 01:37:26,080
okay so here are some interesting

2331
01:37:26,080 --> 01:37:28,000
information we can see

2332
01:37:28,000 --> 01:37:30,800
that the user has opened docusign.chip

2333
01:37:30,800 --> 01:37:32,960
and if we remember that the

2334
01:37:32,960 --> 01:37:36,159
dot exe was executed uh

2335
01:37:36,159 --> 01:37:38,080
from docusign directory it is likely

2336
01:37:38,080 --> 01:37:40,639
that this has something to do with it

2337
01:37:40,639 --> 01:37:44,000
uh then there is this ask.txt which is

2338
01:37:44,000 --> 01:37:46,840
also interesting file then we have info

2339
01:37:46,840 --> 01:37:48,000
udladder.org

2340
01:37:48,000 --> 01:37:50,480
why would they have that one yes

2341
01:37:50,480 --> 01:37:52,159
coca-cola is very obvious

2342
01:37:52,159 --> 01:37:55,440
then we have a crusty crab step

2343
01:37:55,440 --> 01:37:59,520
some some kind of file then we have

2344
01:37:59,520 --> 01:38:03,199
some jpg jbq

2345
01:38:03,199 --> 01:38:06,480
files uh then we have the uh

2346
01:38:06,480 --> 01:38:08,560
this is actually the list of all files

2347
01:38:08,560 --> 01:38:10,400
and that we can see that the

2348
01:38:10,400 --> 01:38:13,920
last time this registry was written

2349
01:38:13,920 --> 01:38:16,440
was on this time so we know that the

2350
01:38:16,440 --> 01:38:19,440
docusign.chip has been open on that

2351
01:38:19,440 --> 01:38:21,520
specific time so this would be

2352
01:38:21,520 --> 01:38:22,560
interesting when

2353
01:38:22,560 --> 01:38:25,360
when we would be doing like forensics on

2354
01:38:25,360 --> 01:38:29,360
a real life scenario that which time the

2355
01:38:29,360 --> 01:38:32,960
which time the uh uh malware content

2356
01:38:32,960 --> 01:38:34,880
malware containing the carrier file was

2357
01:38:34,880 --> 01:38:37,760
opened and also we can see here uh

2358
01:38:37,760 --> 01:38:40,480
the last right time on the registry as

2359
01:38:40,480 --> 01:38:43,600
well so we know when these files were

2360
01:38:43,600 --> 01:38:46,320
created or opened by the user so this

2361
01:38:46,320 --> 01:38:48,400
info to the loadout.org

2362
01:38:48,400 --> 01:38:51,119
was written on that time and so on so

2363
01:38:51,119 --> 01:38:52,239
you can see here

2364
01:38:52,239 --> 01:38:59,520
what's going on alrighty

2365
01:38:59,520 --> 01:39:02,080
so let's move on to the some hive let's

2366
01:39:02,080 --> 01:39:02,719
see i

2367
01:39:02,719 --> 01:39:05,600
i'm pretty sure this is broken but let's

2368
01:39:05,600 --> 01:39:07,040
see

2369
01:39:07,040 --> 01:39:10,639
so you can read the sam hive

2370
01:39:10,639 --> 01:39:14,639
with and as we can see this is

2371
01:39:14,639 --> 01:39:18,639
broke so

2372
01:39:19,040 --> 01:39:21,679
there should be a list of users so in in

2373
01:39:21,679 --> 01:39:22,320
this

2374
01:39:22,320 --> 01:39:25,280
scenario in this computer we can't get

2375
01:39:25,280 --> 01:39:26,239
it working but

2376
01:39:26,239 --> 01:39:28,320
you should see the other one if you can

2377
01:39:28,320 --> 01:39:29,520
you if if

2378
01:39:29,520 --> 01:39:33,440
if it works on there

2379
01:39:33,679 --> 01:39:37,199
then we can see if we have system um

2380
01:39:37,199 --> 01:39:41,839
well if we want to know what the

2381
01:39:42,400 --> 01:39:45,360
let's see the computer name is we can

2382
01:39:45,360 --> 01:39:45,920
see

2383
01:39:45,920 --> 01:39:48,159
that there this system seems to be

2384
01:39:48,159 --> 01:39:49,840
broken as well

2385
01:39:49,840 --> 01:39:54,000
that's not so nice so uh

2386
01:39:54,000 --> 01:39:56,960
reminder to the everyone who is uh

2387
01:39:56,960 --> 01:39:58,560
posting this kind of stuff

2388
01:39:58,560 --> 01:40:02,320
uh please put enough memory to the uh

2389
01:40:02,320 --> 01:40:05,119
system also ip information on this one

2390
01:40:05,119 --> 01:40:07,119
is not working isp

2391
01:40:07,119 --> 01:40:11,760
key it's not isp store

2392
01:40:11,760 --> 01:40:15,600
not working that as well so there is uh

2393
01:40:15,600 --> 01:40:17,520
you should open this on the registry

2394
01:40:17,520 --> 01:40:19,840
explorer and see what there is because

2395
01:40:19,840 --> 01:40:22,960
they seem to be very limited on the

2396
01:40:22,960 --> 01:40:24,159
information side

2397
01:40:24,159 --> 01:40:28,400
but remember that the on the ctf

2398
01:40:28,400 --> 01:40:31,840
it is likely it is very likely that this

2399
01:40:31,840 --> 01:40:34,800
will work because it has more memory so

2400
01:40:34,800 --> 01:40:36,480
keep this

2401
01:40:36,480 --> 01:40:39,520
in mind and always use the secret hacker

2402
01:40:39,520 --> 01:40:40,400
tool google

2403
01:40:40,400 --> 01:40:44,239
to find out what different stuff means

2404
01:40:44,239 --> 01:40:46,000
then a few words about the prefetch

2405
01:40:46,000 --> 01:40:48,400
let's see how much i have time left

2406
01:40:48,400 --> 01:40:50,960
okay so it's we have been here almost

2407
01:40:50,960 --> 01:40:52,960
two hours soon

2408
01:40:52,960 --> 01:40:57,119
okay so brief it uh

2409
01:40:57,119 --> 01:41:00,159
prefetch is a windows component that

2410
01:41:00,159 --> 01:41:03,040
purpose is to catch uh files catch

2411
01:41:03,040 --> 01:41:04,400
information about

2412
01:41:04,400 --> 01:41:07,040
executable files so that next time they

2413
01:41:07,040 --> 01:41:08,159
open up

2414
01:41:08,159 --> 01:41:12,080
the actual uh

2415
01:41:12,080 --> 01:41:15,119
actual opening time will be faster so

2416
01:41:15,119 --> 01:41:18,159
basically it it speeds up the execution

2417
01:41:18,159 --> 01:41:20,000
of software so uh on the first

2418
01:41:20,000 --> 01:41:21,840
execution of a software it creates the

2419
01:41:21,840 --> 01:41:23,679
prefetch file under the system root

2420
01:41:23,679 --> 01:41:25,679
prefetch directory and

2421
01:41:25,679 --> 01:41:28,560
the virtual times it will use them to

2422
01:41:28,560 --> 01:41:30,639
speed up the process

2423
01:41:30,639 --> 01:41:34,000
uh the uh the uh prefetch file also has

2424
01:41:34,000 --> 01:41:37,920
a list of uh list of uh referenced files

2425
01:41:37,920 --> 01:41:38,480
so

2426
01:41:38,480 --> 01:41:41,679
and and directories so the uh places the

2427
01:41:41,679 --> 01:41:45,119
executable is touching or handling uh

2428
01:41:45,119 --> 01:41:48,080
accessing i think modifying or accessing

2429
01:41:48,080 --> 01:41:50,000
i think are the right terms for that

2430
01:41:50,000 --> 01:41:52,560
so you should see though there a lot of

2431
01:41:52,560 --> 01:41:53,920
information about the

2432
01:41:53,920 --> 01:41:57,119
binary execution and uh and uh and

2433
01:41:57,119 --> 01:42:00,159
make analyzes what the uh

2434
01:42:00,159 --> 01:42:02,719
what the binary has done on the system

2435
01:42:02,719 --> 01:42:03,600
for example in d

2436
01:42:03,600 --> 01:42:07,199
if word opens a document file you should

2437
01:42:07,199 --> 01:42:11,199
see on the prefetch file the docx file

2438
01:42:11,199 --> 01:42:12,080
as a reference

2439
01:42:12,080 --> 01:42:15,920
file here is an example from my actual

2440
01:42:15,920 --> 01:42:16,400
this

2441
01:42:16,400 --> 01:42:18,560
machine and you can tell that it's my

2442
01:42:18,560 --> 01:42:20,639
machine as you can see the cs go

2443
01:42:20,639 --> 01:42:23,119
and the counter strike and the uh phase

2444
01:42:23,119 --> 01:42:23,840
it and

2445
01:42:23,840 --> 01:42:27,040
discord and uh also esports client so

2446
01:42:27,040 --> 01:42:29,360
it will uh get a lot of information

2447
01:42:29,360 --> 01:42:31,440
about the software you are executing on

2448
01:42:31,440 --> 01:42:33,199
your system

2449
01:42:33,199 --> 01:42:36,719
and uh and store their configurations

2450
01:42:36,719 --> 01:42:38,560
here

2451
01:42:38,560 --> 01:42:41,679
uh you can parse these files

2452
01:42:41,679 --> 01:42:45,520
either by using um using

2453
01:42:45,520 --> 01:42:49,360
uh the this kind of python script which

2454
01:42:49,360 --> 01:42:50,320
i found

2455
01:42:50,320 --> 01:42:53,360
actually yesterday from from github

2456
01:42:53,360 --> 01:42:56,400
it is working on linux so you can

2457
01:42:56,400 --> 01:42:58,960
parse these prefetch files online so you

2458
01:42:58,960 --> 01:42:59,520
will get

2459
01:42:59,520 --> 01:43:01,679
a little bit limited information about

2460
01:43:01,679 --> 01:43:04,239
the pro

2461
01:43:04,239 --> 01:43:06,480
about the prefetch files but at least

2462
01:43:06,480 --> 01:43:07,760
it's working because

2463
01:43:07,760 --> 01:43:11,119
most of the windows 10 prefetch parsing

2464
01:43:11,119 --> 01:43:12,639
tools

2465
01:43:12,639 --> 01:43:16,000
on linux are not working

2466
01:43:16,000 --> 01:43:18,320
they they work on on previous windows

2467
01:43:18,320 --> 01:43:20,239
versions like windows 7 but

2468
01:43:20,239 --> 01:43:24,639
i think windows 10 is uh prefetch is uh

2469
01:43:24,639 --> 01:43:26,880
requires some some kind of special uh

2470
01:43:26,880 --> 01:43:29,280
dlls for for execution i don't know how

2471
01:43:29,280 --> 01:43:30,320
this uh

2472
01:43:30,320 --> 01:43:33,360
guy has bro or or a woman has made this

2473
01:43:33,360 --> 01:43:36,080
uh or whoever has made this uh windows

2474
01:43:36,080 --> 01:43:37,600
10 prefix person

2475
01:43:37,600 --> 01:43:40,400
and also timmerman has prefix positive

2476
01:43:40,400 --> 01:43:40,880
as well

2477
01:43:40,880 --> 01:43:43,360
pcmd which works on windows only and

2478
01:43:43,360 --> 01:43:45,040
it's it's a pretty good one here is

2479
01:43:45,040 --> 01:43:46,560
actually a photo

2480
01:43:46,560 --> 01:43:49,920
of the uh uh how the

2481
01:43:49,920 --> 01:43:53,040
windows 10 bf4 shows the source the

2482
01:43:53,040 --> 01:43:55,440
information about for example this cs go

2483
01:43:55,440 --> 01:43:56,639
i had there

2484
01:43:56,639 --> 01:43:59,280
uh it will show the run count and run

2485
01:43:59,280 --> 01:44:00,000
times when

2486
01:44:00,000 --> 01:44:03,760
it has been executed and also on the

2487
01:44:03,760 --> 01:44:07,199
on the psemd site it will show a lot of

2488
01:44:07,199 --> 01:44:08,400
more information and

2489
01:44:08,400 --> 01:44:12,320
uh for example the information about the

2490
01:44:12,320 --> 01:44:14,639
about the resource files and resources

2491
01:44:14,639 --> 01:44:16,960
directory so so the files that

2492
01:44:16,960 --> 01:44:19,199
it has touched accessed on the on the

2493
01:44:19,199 --> 01:44:21,839
file system

2494
01:44:22,400 --> 01:44:25,840
so time for action uh i think

2495
01:44:25,840 --> 01:44:29,119
we might even want to skip this one as i

2496
01:44:29,119 --> 01:44:30,639
had the screenshots

2497
01:44:30,639 --> 01:44:34,000
so uh we we have the basic idea of the

2498
01:44:34,000 --> 01:44:36,800
prefetch files of course i can show you

2499
01:44:36,800 --> 01:44:38,080
the uh

2500
01:44:38,080 --> 01:44:41,040
well i can show you i can show you the

2501
01:44:41,040 --> 01:44:42,920
uh

2502
01:44:42,920 --> 01:44:44,960
[Music]

2503
01:44:44,960 --> 01:44:49,679
the pretty

2504
01:44:49,679 --> 01:44:52,400
yes this one so i can show you how the

2505
01:44:52,400 --> 01:44:53,600
um

2506
01:44:53,600 --> 01:44:55,600
prefix parser is sewing so it has a lot

2507
01:44:55,600 --> 01:44:57,119
of it's kind of where but

2508
01:44:57,119 --> 01:45:00,840
the sorry

2509
01:45:00,840 --> 01:45:04,560
the uh output is kind of verbose so it

2510
01:45:04,560 --> 01:45:06,480
shows the directories references and

2511
01:45:06,480 --> 01:45:07,840
files references so if

2512
01:45:07,840 --> 01:45:10,639
it has uh any kind of uh api calls using

2513
01:45:10,639 --> 01:45:12,480
a vehicles we can see that uh there is a

2514
01:45:12,480 --> 01:45:13,119
lot of

2515
01:45:13,119 --> 01:45:16,960
imports from the dll so we can uh

2516
01:45:16,960 --> 01:45:19,119
based on these as well analyze a little

2517
01:45:19,119 --> 01:45:21,040
bit about the characteristics

2518
01:45:21,040 --> 01:45:23,840
such characteristics of the file that

2519
01:45:23,840 --> 01:45:26,239
what it does so for example if it is

2520
01:45:26,239 --> 01:45:27,360
importing

2521
01:45:27,360 --> 01:45:31,040
uh some of the windows windows dll files

2522
01:45:31,040 --> 01:45:32,400
we can for example

2523
01:45:32,400 --> 01:45:35,520
uh assume that it's using uh

2524
01:45:35,520 --> 01:45:39,040
internet connected stuff if we see

2525
01:45:39,040 --> 01:45:42,560
see uh some of the known windows yellows

2526
01:45:42,560 --> 01:45:45,119
and also uh here are the files it uses

2527
01:45:45,119 --> 01:45:47,920
by its own own dls and so on so a lot of

2528
01:45:47,920 --> 01:45:48,880
a lot of stuff that

2529
01:45:48,880 --> 01:45:51,679
uh it has been being uh handled by by

2530
01:45:51,679 --> 01:45:53,199
this

2531
01:45:53,199 --> 01:45:55,280
by this and also mfd this is something

2532
01:45:55,280 --> 01:45:56,400
when when we

2533
01:45:56,400 --> 01:45:58,880
go to the well we don't go there today

2534
01:45:58,880 --> 01:45:59,440
but

2535
01:45:59,440 --> 01:46:01,440
uh something you should be aware of that

2536
01:46:01,440 --> 01:46:03,679
the windows

2537
01:46:03,679 --> 01:46:07,520
has this ntfs file system and uh

2538
01:46:07,520 --> 01:46:10,000
ndfs is storing all the file

2539
01:46:10,000 --> 01:46:11,040
modifications and

2540
01:46:11,040 --> 01:46:14,000
creations of the mft file which is the

2541
01:46:14,000 --> 01:46:14,639
master

2542
01:46:14,639 --> 01:46:19,520
file table and it is on the

2543
01:46:19,520 --> 01:46:21,520
root folder of the of the operating

2544
01:46:21,520 --> 01:46:22,800
system there is this

2545
01:46:22,800 --> 01:46:26,080
mft it's hidden on the operating

2546
01:46:26,080 --> 01:46:28,639
system but it's there and it writes

2547
01:46:28,639 --> 01:46:29,199
there

2548
01:46:29,199 --> 01:46:31,440
any any creations and modifications on

2549
01:46:31,440 --> 01:46:32,960
the files so this is something you

2550
01:46:32,960 --> 01:46:34,000
should analyze

2551
01:46:34,000 --> 01:46:36,639
uh when you get to the uh file system

2552
01:46:36,639 --> 01:46:41,840
analyze part

2553
01:46:45,600 --> 01:46:50,480
all right so let's continue with the

2554
01:46:50,480 --> 01:46:54,320
windows event uh

2555
01:46:54,320 --> 01:46:58,080
files windows yes windows evtx

2556
01:46:58,080 --> 01:47:00,639
so i think a lot of people has als or

2557
01:47:00,639 --> 01:47:01,119
also

2558
01:47:01,119 --> 01:47:04,159
seen this one some sometimes so it is a

2559
01:47:04,159 --> 01:47:06,320
windows event viewer you can open on

2560
01:47:06,320 --> 01:47:08,480
your machine and see

2561
01:47:08,480 --> 01:47:12,080
see the uh log files and and browse them

2562
01:47:12,080 --> 01:47:12,560
and

2563
01:47:12,560 --> 01:47:15,199
find suspicious events from there so

2564
01:47:15,199 --> 01:47:15,840
what is

2565
01:47:15,840 --> 01:47:18,719
in the stored in the log files uh

2566
01:47:18,719 --> 01:47:20,800
windows source there's a lot of

2567
01:47:20,800 --> 01:47:22,560
different stuff a lot of

2568
01:47:22,560 --> 01:47:25,440
two different places there are a lot of

2569
01:47:25,440 --> 01:47:25,920
different

2570
01:47:25,920 --> 01:47:28,719
uh system uh well there are a lot of

2571
01:47:28,719 --> 01:47:30,560
different log files

2572
01:47:30,560 --> 01:47:36,000
which are stored to the system root uh

2573
01:47:36,000 --> 01:47:37,920
which are stored at this location uh

2574
01:47:37,920 --> 01:47:40,239
system 32 in evt

2575
01:47:40,239 --> 01:47:43,920
locks on on recent windows systems and

2576
01:47:43,920 --> 01:47:47,440
and by reason i mean

2577
01:47:48,639 --> 01:47:52,480
after uh windows xp so windows

2578
01:47:52,480 --> 01:47:56,800
we stand beyond that and uh

2579
01:47:56,800 --> 01:47:59,199
and uh and you can find there are a lot

2580
01:47:59,199 --> 01:47:59,840
of

2581
01:47:59,840 --> 01:48:03,280
evtx which is the windows xml event log

2582
01:48:03,280 --> 01:48:04,000
forward so

2583
01:48:04,000 --> 01:48:06,719
it's basically binary xml and you cannot

2584
01:48:06,719 --> 01:48:07,520
read it

2585
01:48:07,520 --> 01:48:11,360
without any pausers you can of course

2586
01:48:11,360 --> 01:48:12,480
write your own

2587
01:48:12,480 --> 01:48:15,520
and see see what it does but but there

2588
01:48:15,520 --> 01:48:15,920
are

2589
01:48:15,920 --> 01:48:18,719
also good tools for that so you can use

2590
01:48:18,719 --> 01:48:21,040
for example windows event weaver which

2591
01:48:21,040 --> 01:48:21,440
ships

2592
01:48:21,440 --> 01:48:23,679
with your windows installation which was

2593
01:48:23,679 --> 01:48:25,040
uh shown here

2594
01:48:25,040 --> 01:48:28,080
so you can just execute it with event

2595
01:48:28,080 --> 01:48:31,199
vwr comment on run dialog and we will

2596
01:48:31,199 --> 01:48:32,159
open this one

2597
01:48:32,159 --> 01:48:35,600
and you're gonna open during uh do

2598
01:48:35,600 --> 01:48:38,159
do the file dialogue you can open open

2599
01:48:38,159 --> 01:48:40,080
uh

2600
01:48:40,080 --> 01:48:42,080
custom files as well so you can use that

2601
01:48:42,080 --> 01:48:43,840
one uh it has

2602
01:48:43,840 --> 01:48:46,880
a limited uh limited filtering

2603
01:48:46,880 --> 01:48:48,800
options it has some kind of filtering

2604
01:48:48,800 --> 01:48:50,320
but it i feel it's

2605
01:48:50,320 --> 01:48:52,320
kind of bad and you cannot custom the

2606
01:48:52,320 --> 01:48:54,159
view you have there

2607
01:48:54,159 --> 01:48:57,280
um well you can but but

2608
01:48:57,280 --> 01:48:59,520
i i i don't think it's it's it's a good

2609
01:48:59,520 --> 01:49:00,560
one it's it's

2610
01:49:00,560 --> 01:49:02,560
i i think it's hard to use and it's

2611
01:49:02,560 --> 01:49:03,760
pretty slow

2612
01:49:03,760 --> 01:49:06,719
so uh preferably i would use uh if i

2613
01:49:06,719 --> 01:49:07,440
have a lot of

2614
01:49:07,440 --> 01:49:10,560
uh resources i would use elk splunk or

2615
01:49:10,560 --> 01:49:12,880
so on different kind of lock management

2616
01:49:12,880 --> 01:49:14,400
tools or

2617
01:49:14,400 --> 01:49:17,840
cms to harvest these or i can use

2618
01:49:17,840 --> 01:49:20,800
evts dump

2619
01:49:20,880 --> 01:49:24,639
either the python or the rust version

2620
01:49:24,639 --> 01:49:27,360
which can extract the evtx files to the

2621
01:49:27,360 --> 01:49:28,480
xml files and then

2622
01:49:28,480 --> 01:49:31,679
i can just grab them and find the stuff

2623
01:49:31,679 --> 01:49:32,239
i

2624
01:49:32,239 --> 01:49:35,519
i'm really interested in

2625
01:49:35,920 --> 01:49:38,639
there are also some visualization tools

2626
01:49:38,639 --> 01:49:39,040
for

2627
01:49:39,040 --> 01:49:40,800
for example security locks you can

2628
01:49:40,800 --> 01:49:42,560
visualize the um

2629
01:49:42,560 --> 01:49:45,920
the views there are

2630
01:49:45,920 --> 01:49:50,639
oh what is this tool called it's

2631
01:49:50,880 --> 01:49:53,360
can anyone remember it's it's based on

2632
01:49:53,360 --> 01:49:54,639
neo4j

2633
01:49:54,639 --> 01:49:58,400
it's the uh well i i will

2634
01:49:58,400 --> 01:50:00,080
dig it up later on it's it's some kind

2635
01:50:00,080 --> 01:50:01,599
of visualizer that that

2636
01:50:01,599 --> 01:50:04,000
visualization says the log on events and

2637
01:50:04,000 --> 01:50:05,199
so on so you can

2638
01:50:05,199 --> 01:50:08,719
investigate for example ad locks by

2639
01:50:08,719 --> 01:50:12,880
using that so

2640
01:50:12,960 --> 01:50:16,320
it's time to put evil flash to action

2641
01:50:16,320 --> 01:50:19,840
and move on to the ctf side

2642
01:50:19,840 --> 01:50:22,960
we have 30 minutes here during the

2643
01:50:22,960 --> 01:50:25,360
workshop so i would like to see people

2644
01:50:25,360 --> 01:50:27,520
registering there and get them going i

2645
01:50:27,520 --> 01:50:29,119
will be answering the questions but

2646
01:50:29,119 --> 01:50:30,239
before that

2647
01:50:30,239 --> 01:50:32,800
i will show also a few tools that you

2648
01:50:32,800 --> 01:50:34,000
should

2649
01:50:34,000 --> 01:50:37,360
investigate and see

2650
01:50:37,360 --> 01:50:41,119
timmerman tools like

2651
01:50:41,119 --> 01:50:43,760
asked before my opinion on timeline

2652
01:50:43,760 --> 01:50:45,119
explorer and cape

2653
01:50:45,119 --> 01:50:47,520
timeline explorer like i said should be

2654
01:50:47,520 --> 01:50:48,480
replaced with

2655
01:50:48,480 --> 01:50:51,119
time sketch and cape why three stars

2656
01:50:51,119 --> 01:50:52,800
because it's free only for

2657
01:50:52,800 --> 01:50:54,960
non-commercial use so if you're using

2658
01:50:54,960 --> 01:50:58,159
it in commerce you have to pay for it

2659
01:50:58,159 --> 01:50:59,840
so uh these are something you should

2660
01:50:59,840 --> 01:51:01,599
check uh they're pretty good

2661
01:51:01,599 --> 01:51:05,040
then the even explorer for the

2662
01:51:05,040 --> 01:51:06,400
for the windows lock so you can

2663
01:51:06,400 --> 01:51:08,639
basically there

2664
01:51:08,639 --> 01:51:12,320
make custom columns you can customize

2665
01:51:12,320 --> 01:51:13,119
the view

2666
01:51:13,119 --> 01:51:15,440
and you can actually remotely read the

2667
01:51:15,440 --> 01:51:17,840
logs from 80

2668
01:51:17,840 --> 01:51:20,960
radi and a lot of

2669
01:51:20,960 --> 01:51:23,840
a lot of other other stuff as well and

2670
01:51:23,840 --> 01:51:26,480
uh it it it costs 199

2671
01:51:26,480 --> 01:51:29,599
usd for standard edition so it's pretty

2672
01:51:29,599 --> 01:51:30,400
cheap

2673
01:51:30,400 --> 01:51:33,520
cheap it has it's pretty cheap for

2674
01:51:33,520 --> 01:51:35,760
companies remember that this is not

2675
01:51:35,760 --> 01:51:37,440
cheap if you are doing this on your free

2676
01:51:37,440 --> 01:51:37,920
time and

2677
01:51:37,920 --> 01:51:41,119
and for your own but if you are uh doing

2678
01:51:41,119 --> 01:51:43,119
it for a company this is not not a

2679
01:51:43,119 --> 01:51:46,880
lot of money for for a company and uh

2680
01:51:46,880 --> 01:51:49,280
it's bang for the buck so called and uh

2681
01:51:49,280 --> 01:51:50,960
you can you can also use it

2682
01:51:50,960 --> 01:51:53,920
uh uh 30 days with the trial license you

2683
01:51:53,920 --> 01:51:54,400
need to

2684
01:51:54,400 --> 01:51:57,040
you can download it from their website

2685
01:51:57,040 --> 01:51:58,960
then autopsy

2686
01:51:58,960 --> 01:52:01,119
uh when you do disk forensics it's

2687
01:52:01,119 --> 01:52:02,000
pretty good tool

2688
01:52:02,000 --> 01:52:04,880
it it indexes the data and you can

2689
01:52:04,880 --> 01:52:05,840
search

2690
01:52:05,840 --> 01:52:09,119
from it so it is pretty useful when

2691
01:52:09,119 --> 01:52:12,560
handling big data big data uh of

2692
01:52:12,560 --> 01:52:16,639
of big disks of of workstations

2693
01:52:16,639 --> 01:52:21,040
sorry i'm losing my voice

2694
01:52:23,840 --> 01:52:26,880
and i i don't think that coke is really

2695
01:52:26,880 --> 01:52:28,320
helping me

2696
01:52:28,320 --> 01:52:31,199
with the voice but yeah i need to drink

2697
01:52:31,199 --> 01:52:31,840
something

2698
01:52:31,840 --> 01:52:34,800
it's better than beer no it's not sorry

2699
01:52:34,800 --> 01:52:35,360
but yeah

2700
01:52:35,360 --> 01:52:38,239
uh and then uh about the timeline there

2701
01:52:38,239 --> 01:52:39,119
was a question

2702
01:52:39,119 --> 01:52:41,119
uh well another question question about

2703
01:52:41,119 --> 01:52:44,159
the timex timeline explorer and i told

2704
01:52:44,159 --> 01:52:46,239
about the timelines

2705
01:52:46,239 --> 01:52:49,280
so timelining

2706
01:52:49,280 --> 01:52:52,320
is very effective forensic way but

2707
01:52:52,320 --> 01:52:55,520
do the limitations on the time

2708
01:52:55,520 --> 01:52:58,560
today here we are not going through that

2709
01:52:58,560 --> 01:53:01,199
but you should keep in mind that uh this

2710
01:53:01,199 --> 01:53:01,760
kind of

2711
01:53:01,760 --> 01:53:05,199
tool that plus or log to timeline is is

2712
01:53:05,199 --> 01:53:08,159
available and you can actually run it

2713
01:53:08,159 --> 01:53:10,239
against a disk image and it will

2714
01:53:10,239 --> 01:53:12,239
parse out everything on the disk well

2715
01:53:12,239 --> 01:53:13,920
not everything everything that has been

2716
01:53:13,920 --> 01:53:14,880
written

2717
01:53:14,880 --> 01:53:19,119
parser to the plus all so it will

2718
01:53:19,119 --> 01:53:21,760
parse most of the evidence for you and

2719
01:53:21,760 --> 01:53:24,239
then if you import it to the time sketch

2720
01:53:24,239 --> 01:53:26,080
you can use elasticstack

2721
01:53:26,080 --> 01:53:29,520
to search the data so it is

2722
01:53:29,520 --> 01:53:33,040
really good tool for analyzing

2723
01:53:33,040 --> 01:53:37,679
for analyzing disk images

2724
01:53:37,679 --> 01:53:39,760
keep these two tools in your mind when

2725
01:53:39,760 --> 01:53:40,880
you're doing something

2726
01:53:40,880 --> 01:53:44,159
i'm nowadays every time i'm doing this

2727
01:53:44,159 --> 01:53:46,239
forensics i'm using time sketch and plus

2728
01:53:46,239 --> 01:53:47,440
oh

2729
01:53:47,440 --> 01:53:50,800
they are so good together so it's better

2730
01:53:50,800 --> 01:53:51,440
than

2731
01:53:51,440 --> 01:53:56,320
than some some paid tools like axiom or

2732
01:53:56,320 --> 01:53:59,199
or in case uh these are these are pretty

2733
01:53:59,199 --> 01:54:03,199
good ones and also the autopsy

2734
01:54:03,520 --> 01:54:06,239
then you probably need to analyze

2735
01:54:06,239 --> 01:54:08,000
malicious documents in some part

2736
01:54:08,000 --> 01:54:10,800
of your life so it's good to use the

2737
01:54:10,800 --> 01:54:11,760
remnux

2738
01:54:11,760 --> 01:54:15,199
and here is pretty good

2739
01:54:15,199 --> 01:54:18,239
cheatsheet for using the tools of course

2740
01:54:18,239 --> 01:54:21,360
and also some some uh

2741
01:54:21,360 --> 01:54:23,920
things that you should consider risk at

2742
01:54:23,920 --> 01:54:25,040
the files

2743
01:54:25,040 --> 01:54:28,560
so also uh keep in mind uh

2744
01:54:28,560 --> 01:54:31,280
these lenny child shares uh different

2745
01:54:31,280 --> 01:54:33,280
different uh cheat sheets

2746
01:54:33,280 --> 01:54:36,400
uh they he provides on on his website

2747
01:54:36,400 --> 01:54:39,199
for free for everyone uh lenny shelter

2748
01:54:39,199 --> 01:54:40,000
is by the way

2749
01:54:40,000 --> 01:54:43,840
uh the author of the sons forensics

2750
01:54:43,840 --> 01:54:47,280
uh six six

2751
01:54:47,280 --> 01:54:51,599
ten course the malware analysis course

2752
01:54:51,599 --> 01:54:54,880
so he knows a lot about the malware

2753
01:54:54,880 --> 01:54:57,679
analysis stuff

2754
01:54:58,080 --> 01:55:00,719
all right so final works so um after

2755
01:55:00,719 --> 01:55:03,119
after now that you have seen uh

2756
01:55:03,119 --> 01:55:06,239
something well in kind of fast forward

2757
01:55:06,239 --> 01:55:07,119
the way

2758
01:55:07,119 --> 01:55:10,400
i hope you are going uh towards

2759
01:55:10,400 --> 01:55:14,480
this one so you think uh you could

2760
01:55:14,480 --> 01:55:17,679
improve your skills and i hope that i i

2761
01:55:17,679 --> 01:55:20,000
have given you the opportunity to take

2762
01:55:20,000 --> 01:55:21,440
the first steps

2763
01:55:21,440 --> 01:55:26,239
and play the ctf so

2764
01:55:27,199 --> 01:55:31,040
the ctf will be open

2765
01:55:31,040 --> 01:55:34,000
oh what is the time what is the time

2766
01:55:34,000 --> 01:55:36,320
where is the time

2767
01:55:36,320 --> 01:55:39,920
it's seven yes so i will

2768
01:55:39,920 --> 01:55:43,040
go now and open the ctf

2769
01:55:43,040 --> 01:55:46,960
it will be held on the

2770
01:55:46,960 --> 01:55:49,440
on the

2771
01:55:50,880 --> 01:55:54,639
mayhem dot dfr dot f5

2772
01:55:54,639 --> 01:55:56,960
you can register there if you have any

2773
01:55:56,960 --> 01:55:57,679
problems

2774
01:55:57,679 --> 01:56:01,679
tell me i will go and

2775
01:56:01,679 --> 01:56:05,520
open it right now

2776
01:56:06,000 --> 01:56:15,840
if i can time

2777
01:56:23,440 --> 01:56:29,920
okay so let's see challenges

2778
01:56:29,920 --> 01:56:33,199
yes now it's open so

2779
01:56:33,199 --> 01:56:37,599
it's time for a cdf and

2780
01:56:37,599 --> 01:56:42,159
you should be able to solve

2781
01:56:42,159 --> 01:56:46,000
almost all of the tasks by using just

2782
01:56:46,000 --> 01:56:46,800
the tools

2783
01:56:46,800 --> 01:56:49,360
and stuff i told you in the past few

2784
01:56:49,360 --> 01:56:51,440
hours

2785
01:56:51,440 --> 01:56:54,320
a few rules do not attack the ctft

2786
01:56:54,320 --> 01:56:55,679
platform please

2787
01:56:55,679 --> 01:56:57,679
you can prove forced answers but you

2788
01:56:57,679 --> 01:56:59,599
have limited times of

2789
01:56:59,599 --> 01:57:02,960
limited number of answers uh answers

2790
01:57:02,960 --> 01:57:04,000
available

2791
01:57:04,000 --> 01:57:08,239
so it i think it won't be helpful to you

2792
01:57:08,239 --> 01:57:10,800
collaborate do it with your friends uh

2793
01:57:10,800 --> 01:57:12,159
go to the discord

2794
01:57:12,159 --> 01:57:15,199
chat with together share knowledge

2795
01:57:15,199 --> 01:57:19,280
uh find out the solos and uh have fun

2796
01:57:19,280 --> 01:57:21,440
that's the important one and the best

2797
01:57:21,440 --> 01:57:23,760
three if players will be awarded with

2798
01:57:23,760 --> 01:57:24,560
the hellseq

2799
01:57:24,560 --> 01:57:27,280
swag and of course i will try to get

2800
01:57:27,280 --> 01:57:28,800
some mayhem's back to

2801
01:57:28,800 --> 01:57:31,840
that package as well and

2802
01:57:31,840 --> 01:57:35,119
i will announce the winners tomorrow on

2803
01:57:35,119 --> 01:57:37,440
my twitter account

2804
01:57:37,440 --> 01:57:40,800
and uh yeah

2805
01:57:40,800 --> 01:57:43,840
and please when you register to the ctft

2806
01:57:43,840 --> 01:57:44,560
please use

2807
01:57:44,560 --> 01:57:46,639
an email address that works because i'm

2808
01:57:46,639 --> 01:57:50,560
using that to contact you after the uh

2809
01:57:50,560 --> 01:57:52,800
if you've finished uh on top three

2810
01:57:52,800 --> 01:57:53,679
places

2811
01:57:53,679 --> 01:57:56,960
uh you can use whatever email account

2812
01:57:56,960 --> 01:57:58,159
you want there

2813
01:57:58,159 --> 01:58:01,599
uh because the uh it doesn't check

2814
01:58:01,599 --> 01:58:03,920
uh if it works but if you want to get

2815
01:58:03,920 --> 01:58:05,760
your

2816
01:58:05,760 --> 01:58:10,480
awards please use a one that works

2817
01:58:10,480 --> 01:58:13,440
properly and here is also the password

2818
01:58:13,440 --> 01:58:15,919
for the

2819
01:58:16,480 --> 01:58:19,840
for the evidence it's uh crusty crap

2820
01:58:19,840 --> 01:58:21,239
yummy so the

2821
01:58:21,239 --> 01:58:23,599
ctf.7 chip should open with that

2822
01:58:23,599 --> 01:58:24,560
password

2823
01:58:24,560 --> 01:58:27,920
and please let me know if you have any

2824
01:58:27,920 --> 01:58:28,639
problems

2825
01:58:28,639 --> 01:58:32,480
with the ctfd or

2826
01:58:33,280 --> 01:58:37,119
cdfg or or any of the answers

2827
01:58:37,119 --> 01:58:40,400
if if it is highly unlikely that i have

2828
01:58:40,400 --> 01:58:41,760
screwed up

2829
01:58:41,760 --> 01:58:45,119
but it's always

2830
01:58:45,119 --> 01:58:48,480
always a possibility the

2831
01:58:48,480 --> 01:58:51,679
password is also the india

2832
01:58:51,679 --> 01:58:55,199
in the chat and yeah

2833
01:58:55,199 --> 01:58:57,199
if you have any questions don't hesitate

2834
01:58:57,199 --> 01:58:58,960
to contact me on discord

2835
01:58:58,960 --> 01:59:02,000
or on twitter or by using

2836
01:59:02,000 --> 01:59:05,520
email there is also my

2837
01:59:05,520 --> 01:59:07,840
my work email so if you have anything

2838
01:59:07,840 --> 01:59:09,679
related to national cyber security

2839
01:59:09,679 --> 01:59:12,560
finland center of finland that you want

2840
01:59:12,560 --> 01:59:14,080
to ask

2841
01:59:14,080 --> 01:59:16,159
if you want to report something please

2842
01:59:16,159 --> 01:59:17,520
use the official

2843
01:59:17,520 --> 01:59:19,280
ones but if you have any anything you

2844
01:59:19,280 --> 01:59:20,880
want to contact me in the

2845
01:59:20,880 --> 01:59:24,239
in the matters of us or or if you are

2846
01:59:24,239 --> 01:59:27,040
thinking of applying to us i can answer

2847
01:59:27,040 --> 01:59:28,719
your questions if you want to

2848
01:59:28,719 --> 01:59:32,000
and also uh you can use my health email

2849
01:59:32,000 --> 01:59:32,800
who is at

2850
01:59:32,800 --> 01:59:35,280
health dot fi but the best one is

2851
01:59:35,280 --> 01:59:38,000
twitter or the discord

2852
01:59:38,000 --> 01:59:40,800
yep i will be here uh watching the uh

2853
01:59:40,800 --> 01:59:41,679
ctf

2854
01:59:41,679 --> 01:59:45,920
uh d for a while and i will probably

2855
01:59:45,920 --> 01:59:48,719
put the scoreboard available as well let

2856
01:59:48,719 --> 01:59:52,159
me see okay we have uh

2857
01:59:52,880 --> 01:59:58,159
we have 17 users at the moment there so

2858
01:59:58,159 --> 02:00:01,119
let's put it here

2859
02:00:06,239 --> 02:00:08,480
yep

2860
02:00:09,520 --> 02:00:13,040
so here is the uh

2861
02:00:13,040 --> 02:00:15,679
current situation so we have had it we

2862
02:00:15,679 --> 02:00:16,320
had a

2863
02:00:16,320 --> 02:00:19,040
uh it's going pretty good this far and

2864
02:00:19,040 --> 02:00:21,199
uh we have

2865
02:00:21,199 --> 02:00:24,840
the most points is on yonah good job

2866
02:00:24,840 --> 02:00:27,840
bjorn

2867
02:00:29,440 --> 02:00:31,839
all right

2868
02:00:33,199 --> 02:00:35,440
but the scoreboard is also public so i

2869
02:00:35,440 --> 02:00:37,360
will i will post it to somewhere so

2870
02:00:37,360 --> 02:00:41,119
you can follow it as well

2871
02:00:41,119 --> 02:00:44,239
if you want to

2872
02:00:49,760 --> 02:00:53,440
so any questions on if if you have any

2873
02:00:53,440 --> 02:00:54,320
questions uh

2874
02:00:54,320 --> 02:00:57,440
you can ask ask on the on the twitch

2875
02:00:57,440 --> 02:01:01,199
or on the uh discord on the channels or

2876
02:01:01,199 --> 02:01:01,679
by

2877
02:01:01,679 --> 02:01:05,280
messaging me me on those but i'm guess

2878
02:01:05,280 --> 02:01:10,159
uh i'm done for today

2879
02:01:10,880 --> 02:01:14,480
thank you very much for joining the

2880
02:01:14,480 --> 02:01:16,239
workshop and uh hopefully you got

2881
02:01:16,239 --> 02:01:19,360
something out of it

2882
02:01:19,840 --> 02:01:22,960
i think i will

2883
02:01:22,960 --> 02:01:25,360
continue continue with the development

2884
02:01:25,360 --> 02:01:27,119
of this course and

2885
02:01:27,119 --> 02:01:29,520
as i said it will be available on at

2886
02:01:29,520 --> 02:01:31,040
least on the

2887
02:01:31,040 --> 02:01:33,679
national defense training association of

2888
02:01:33,679 --> 02:01:34,320
finland

2889
02:01:34,320 --> 02:01:38,080
mpk array so if you are interested uh

2890
02:01:38,080 --> 02:01:42,159
going to a three-day course

2891
02:01:42,239 --> 02:01:45,440
i will let you know

2892
02:01:45,440 --> 02:01:51,839
but probably it will be on next year

2893
02:02:08,239 --> 02:02:10,559
oh

