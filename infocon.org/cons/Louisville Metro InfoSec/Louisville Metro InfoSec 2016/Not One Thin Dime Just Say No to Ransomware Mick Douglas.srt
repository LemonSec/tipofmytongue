1
00:00:00,000 --> 00:00:07,649
wrong

2
00:00:08,309 --> 00:00:18,000
alright a internet a level i guess doing
alright grab how you guys doing here we

3
00:00:18,000 --> 00:00:21,448
go to do a cliche but I got to do you
know

4
00:00:21,449 --> 00:00:25,920
okay so we're gonna be talking about
ransomware and what you can do to

5
00:00:25,920 --> 00:00:29,670
prevent a little bit about Who I am

6
00:00:30,240 --> 00:00:35,280
what lockers like ransomware easy and
why you need to reframe your best

7
00:00:35,280 --> 00:00:41,850
strategies a little bit because he's
actually a neat hack on how attackers

8
00:00:41,850 --> 00:00:45,480
used to have to do their campaigns and
we're going to talk about some of the

9
00:00:45,480 --> 00:00:51,959
advantages though we're had for the bad
guys for your ass a little bit we're

10
00:00:51,960 --> 00:00:55,590
going to be spending a lot on prevention
and detection because quite frankly

11
00:00:55,590 --> 00:00:57,329
those are your best bets

12
00:00:57,329 --> 00:01:01,890
once the cryptolocker bomb has gone off
you get to play a game of helping my

13
00:01:01,890 --> 00:01:10,470
backups and i gotta tell you from the
caseload that I have it's not too great

14
00:01:10,470 --> 00:01:17,009
a lot of people have what i call right
only backups and they can't retrieve

15
00:01:17,009 --> 00:01:22,170
them so if there's any one good thing
about cryptolocker and ransom or so

16
00:01:22,170 --> 00:01:28,290
we're going to be seeing a resurgence in
back technologies and feeding the deer

17
00:01:28,290 --> 00:01:29,460
that sort of stuff

18
00:01:29,460 --> 00:01:36,119
finally this is a little bit cool
project that i think it's going on with

19
00:01:36,119 --> 00:01:40,320
you all might think it's silly but if
you want to play with me can we'll

20
00:01:40,320 --> 00:01:48,359
called suspect and it's a close reading
on github and the main reason why is not

21
00:01:48,360 --> 00:01:55,259
a coder and I have caused local service
with this school so I'm continuing to

22
00:01:55,259 --> 00:01:58,560
refactor the code and we'll get into
that later on

23
00:01:58,560 --> 00:02:04,350
we're going to talk so about myself hi
I'm Nick and I digital forensics

24
00:02:04,350 --> 00:02:09,329
incident response practice we at binary
defense lower ever have a good time

25
00:02:10,410 --> 00:02:20,609
Dave I said it there please release my
family just kidding with my copious

26
00:02:20,610 --> 00:02:26,670
spare time I teach first hands i teach a
class of primarily the the main class

27
00:02:26,670 --> 00:02:33,119
that teaches 504 and I've got coming
events in sunny san diego california in

28
00:02:33,120 --> 00:02:38,489
october and then I've also got one
coming up in for this so guess what you

29
00:02:38,489 --> 00:02:47,459
want more min construction by swing on
by those places so here's the

30
00:02:47,459 --> 00:02:53,010
cryptolocker traditional ransomware
alert there's different ones that give

31
00:02:53,010 --> 00:02:58,560
different words but the bottom line is a
lot of organizations are seeing this and

32
00:02:58,560 --> 00:03:04,470
all of a sudden feeling that sinking
feeling in the gut of oh no bad dancer

33
00:03:04,470 --> 00:03:10,230
in our network there including our files
and we're now being held hostage and

34
00:03:10,230 --> 00:03:19,500
this style of attack came out early 2014
and things that we do it by air defenses

35
00:03:19,500 --> 00:03:24,750
we do a lot of reconnaissance and red
monitoring to see what the bad guys are

36
00:03:24,750 --> 00:03:33,480
doing when this came out I was like lets
me attack but surely you know this is

37
00:03:33,480 --> 00:03:37,950
just going to be one of those
flash-in-the-pan things because ransom

38
00:03:37,950 --> 00:03:42,388
wire is really easy to detect
independents at least that's what i call

39
00:03:42,389 --> 00:03:49,410
so the news actually has a little truth
because we're seeing police

40
00:03:49,410 --> 00:03:53,400
organizations are seeing manufacturing
place for seeing hospitals mercy

41
00:03:53,400 --> 00:03:58,170
basically every single vertical is
falling for this and it's making me sad

42
00:03:58,170 --> 00:04:04,069
because getting back to this i thought
that this was going to be a really easy

43
00:04:04,069 --> 00:04:09,708
to defend against one of the reasons
that I gone that it was going to be so

44
00:04:09,709 --> 00:04:18,978
easy to defend against is that all of
the crypto cases that I've felt and seen

45
00:04:18,978 --> 00:04:23,690
one there has been ample evidence that
the attack was underwear there's been

46
00:04:23,690 --> 00:04:30,199
ample ways that you could have protected
it and yet people still fall for it and

47
00:04:30,199 --> 00:04:34,580
what we're going to talk about a little
bit is how to protect against that i'm

48
00:04:34,580 --> 00:04:41,990
basically I was long you know i'll admit
that's great you know totally totally

49
00:04:41,990 --> 00:04:47,030
wrong and now one of the things that I
find interesting is I'm part of the

50
00:04:47,030 --> 00:04:52,909
services that we have binary defense is
that we will help companies position

51
00:04:52,910 --> 00:04:56,030
themselves make sure that their
defensive fabric in there

52
00:04:56,030 --> 00:05:01,369
alerting and monitoring is set up
appropriately and in almost every single

53
00:05:01,370 --> 00:05:05,960
instance we have clients that come to me
and they say that

54
00:05:05,960 --> 00:05:10,729
how do we get Bitcoin and I tell them
why you got really scared or like no no

55
00:05:10,729 --> 00:05:11,990
no not yet

56
00:05:11,990 --> 00:05:15,199
we just need to prep like what

57
00:05:15,199 --> 00:05:20,900
no don't buy rains we don't pay for the
ransom like you're helping fun criminal

58
00:05:20,900 --> 00:05:25,849
activities or do that like doesn't
Kristin morals prevent you from doing

59
00:05:25,849 --> 00:05:26,870
that may go

60
00:05:26,870 --> 00:05:33,380
yeah but you know to prepare for it and
what no don't horrible shameless plug

61
00:05:33,380 --> 00:05:37,009
when you do i would recommend to go
through one of these two folks because

62
00:05:37,009 --> 00:05:42,530
they're the ones that our clients go
through when they're fortunate scenario

63
00:05:42,530 --> 00:05:48,559
don't do it don't pay for it if you use
going these because they're really easy

64
00:05:48,560 --> 00:05:57,229
so I'm clear auntie I'm feeling the pain
here i'll be honest I'm a little

65
00:05:57,229 --> 00:06:00,109
conflicted because I got perverse
incentive

66
00:06:00,110 --> 00:06:04,490
you know I certainly can make a lot of
money by cleaning up the aftermath of

67
00:06:04,490 --> 00:06:10,550
ransomware but that's not really the
right thing to do the right thing to do

68
00:06:10,550 --> 00:06:17,600
is to fix this issue so that we don't
face and the really good news the very

69
00:06:17,600 --> 00:06:23,480
good bit of info that i can give you is
that this is a fight we can win and it's

70
00:06:23,480 --> 00:06:28,760
actually very easy to win all use a
little bit of basic back to the basic

71
00:06:28,760 --> 00:06:34,460
stuff so why is this sort of attack so
popular

72
00:06:35,090 --> 00:06:43,250
whoa it's easy it's a lot of
capabilities that the bad guys didn't

73
00:06:43,250 --> 00:06:44,360
used to have

74
00:06:44,360 --> 00:06:50,930
it's a fire integrated sort of thing and
interestingly enough this also salts and

75
00:06:50,930 --> 00:07:00,950
on problem that malware authors so the
attacker problems are this if you've got

76
00:07:00,950 --> 00:07:06,050
his number if you've got exploit code
and you were in the business doing data

77
00:07:06,050 --> 00:07:15,080
and selling it on the black market you
know i'll be honest it's a horrible way

78
00:07:15,080 --> 00:07:18,530
to live and not just because you're
doing illegal things in stealing crew

79
00:07:18,530 --> 00:07:23,809
you know people it's hard to make money
and you know what the bolt the black

80
00:07:23,810 --> 00:07:30,350
market rate for credit card is in
literary sense sense

81
00:07:31,550 --> 00:07:38,840
yeah like if you have the visa black
parlan super create credit card he might

82
00:07:38,840 --> 00:07:45,109
do for five dollars my me-me-me exactly
is that

83
00:07:45,800 --> 00:07:50,330
that's like super ultra premium credit
cards one of the reasons that you're

84
00:07:50,330 --> 00:07:55,370
seeing when you read this breach report
there like 11 billion cards were stolen

85
00:07:55,370 --> 00:08:02,000
is they have to take 11 billion dollars
in my tacos because one of those are

86
00:08:02,000 --> 00:08:02,969
delicious

87
00:08:02,969 --> 00:08:09,959
to they're making so little money their
revenue is very thin now I'm not crying

88
00:08:09,959 --> 00:08:15,479
any tears over this but the fact of the
matter is credit cards are a real bad

89
00:08:15,479 --> 00:08:20,219
return on investment for the back a
better ones to go after health records

90
00:08:20,219 --> 00:08:24,029
records anybody know what that goes for
$MONEY on black market

91
00:08:24,029 --> 00:08:27,029
a hundred bucks

92
00:08:29,699 --> 00:08:39,300
whoo hwa insurance you have served no
health record you've got really good

93
00:08:39,299 --> 00:08:43,019
coverage will be around 200-250 box

94
00:08:43,019 --> 00:08:48,060
usually we're seeing it tho around
100-200 dollar range and what happens is

95
00:08:48,060 --> 00:08:54,119
the bad guys will bless you table by
health records and flip them to people

96
00:08:54,120 --> 00:08:58,620
who are underinsured they you know
making fraudulent health card they get

97
00:08:58,620 --> 00:09:04,860
whatever operation or whatever they done
and then going longer than mine

98
00:09:06,120 --> 00:09:12,209
the problem with this is the less you
the the markets for this very short lid

99
00:09:12,209 --> 00:09:18,420
so the bad guys are really interesting
people they have that's worth something

100
00:09:18,420 --> 00:09:23,910
but how to get rid of it can be very
tough trade secrets or even works if

101
00:09:23,910 --> 00:09:28,620
you're getting proprietary info for an
organization and trying to sell that

102
00:09:28,620 --> 00:09:33,720
good luck I hope that your
state-sponsored group if you're going

103
00:09:33,720 --> 00:09:38,009
into that power by the way internet
don't do that make is not saying that

104
00:09:38,009 --> 00:09:45,689
you should be a state-sponsored back but
the fact of batteries eats is actually

105
00:09:45,689 --> 00:09:48,149
hard to make money as a bad

106
00:09:48,149 --> 00:09:53,459
that's the whole point of this lot
they're very unpredictable when it comes

107
00:09:53,459 --> 00:09:54,649
to France more

108
00:09:54,649 --> 00:10:02,869
go boys that those Nets of ransomware
when that teacher when the launch goes

109
00:10:02,869 --> 00:10:08,720
active it phone homes and says hey I'm
about to do the nastiness they will

110
00:10:08,720 --> 00:10:13,429
track that and they know that the
install rate is then they can start

111
00:10:13,429 --> 00:10:19,429
tracking that particular account and
seeing hey are they paying a porno and

112
00:10:19,429 --> 00:10:24,290
then they can also start playing around
in doing analytics with how many men .

113
00:10:24,290 --> 00:10:27,050
recharge and you might save yourself

114
00:10:27,050 --> 00:10:31,998
wow that's really what we see that
binary is one of the things that our

115
00:10:31,999 --> 00:10:38,029
friend does is they will infiltrate
these dark markets in these hacker

116
00:10:38,029 --> 00:10:43,220
groups and they will see the discussions
on well should be asking for that I

117
00:10:43,220 --> 00:10:48,319
don't know no let's go to hear of what
about to propose you know it sir

118
00:10:48,319 --> 00:10:53,660
it's crazy but they're actually seeing
this in treatment as if you were a

119
00:10:53,660 --> 00:11:01,579
regular NBA trying to your proper max
message it's really sobering so don't

120
00:11:01,579 --> 00:11:05,420
comment on the fact that they're bad
guys thinking of the fact that they're

121
00:11:05,420 --> 00:11:08,779
doing is really crazy interesting man

122
00:11:10,040 --> 00:11:16,219
now another thing this really is our if
you think about it is malware authors

123
00:11:16,220 --> 00:11:23,059
one of the reasons that we're seeing
some proliferation of ransom wire is the

124
00:11:23,059 --> 00:11:29,449
malware authors for the first time in a
very very long time now have an

125
00:11:29,449 --> 00:11:34,729
incentive to write more code used to be
if you wrote your toolkit you wrote your

126
00:11:34,730 --> 00:11:41,059
attack tool bad guys would have in there
off to the races there you go now

127
00:11:42,170 --> 00:11:47,240
the authors but one thing to point out
is the people who write these sorts of

128
00:11:47,240 --> 00:11:52,879
toolkits are almost never the people who
conduct the campaign what they do is

129
00:11:52,879 --> 00:11:57,649
they will make the ransomware and then
they will sell it on a dark market and

130
00:11:57,649 --> 00:12:01,240
lease or say hey you know here's this
particular

131
00:12:01,240 --> 00:12:06,550
of malware that you can use antivirus
companies and other signature based

132
00:12:06,550 --> 00:12:11,649
tools are always on the lookout for
these sorts of tools or resources of a

133
00:12:11,649 --> 00:12:17,830
tools because they're so problematic for
clients so as a result what they do is

134
00:12:17,830 --> 00:12:24,040
they make signatures and they lock that
the author's the back at authors now

135
00:12:24,040 --> 00:12:30,670
love this because they can resell that
same tool around slightly to the bad

136
00:12:30,670 --> 00:12:35,800
guys and they now are having an ongoing
revenue stream you speed that you would

137
00:12:35,800 --> 00:12:42,130
read to and you're pretty much done now
they ok cool well you let that one hears

138
00:12:42,130 --> 00:12:48,760
the next installment so ask result we
got all kinds of weird perverse

139
00:12:48,760 --> 00:12:53,830
economics that are going on and when the
defensive side aren't really doing a

140
00:12:53,830 --> 00:12:59,770
good job thing of understanding those
economics and so we're saying well you

141
00:12:59,770 --> 00:13:06,610
know we're going to do good enough
defense we only have to be faster than

142
00:13:06,610 --> 00:13:12,430
the bat the worst version i was almost
bursting into infosec i was at a

143
00:13:12,430 --> 00:13:16,599
conference and this one guy who's like
you don't have to outrun the bear just

144
00:13:16,600 --> 00:13:20,260
backed out on the person that you're
hanging with guess how many folks have

145
00:13:20,260 --> 00:13:23,890
heard people talking about that with any
info SEC community

146
00:13:23,890 --> 00:13:27,970
come on raise your hand series yet so
there's a lot of folks there hear that a

147
00:13:27,970 --> 00:13:35,589
lot of organizations have that approach
you know what that no longer there's now

148
00:13:35,589 --> 00:13:40,779
people who are just writing out where
for you no matter how good fast

149
00:13:40,779 --> 00:13:46,870
everybody else is just for you work for
you or for you or for you and its high

150
00:13:46,870 --> 00:13:57,910
just lets it so now we got a situation
where we got ongoing attacks they're

151
00:13:57,910 --> 00:14:06,100
seeing the my you for us and just sit
back and wait so the results of this is

152
00:14:06,100 --> 00:14:07,420
there's a lot of money

153
00:14:07,420 --> 00:14:10,930
this is not going away

154
00:14:10,930 --> 00:14:12,689
I was really wrong

155
00:14:12,690 --> 00:14:18,750
and so you need to start understanding
that this is not the traditional or more

156
00:14:18,750 --> 00:14:23,160
people are doing like you just purchased
a ride they're not trying to tamper with

157
00:14:23,160 --> 00:14:25,230
the data they just want money

158
00:14:25,230 --> 00:14:29,940
how do you defend against this is
different than the attackers that used

159
00:14:29,940 --> 00:14:40,170
to defend against so why are we getting
be we have lost our way if you like

160
00:14:40,170 --> 00:14:45,959
we're able to cryogenically freeze
systems administrator it real common

161
00:14:45,960 --> 00:14:51,510
security admin from like mid nineties
and then flash walling out today it

162
00:14:51,510 --> 00:14:53,880
would freak out

163
00:14:53,880 --> 00:14:59,670
they want it i'll be honestly I've been
in this game long enough the I you know

164
00:14:59,670 --> 00:15:03,599
growing up with some of my mentors nexus
straight angry because they're like what

165
00:15:03,600 --> 00:15:08,010
do you mean you don't do it was easy
when it's offered five networking back

166
00:15:08,010 --> 00:15:13,620
off and they're like no this is
craziness you know what the right we

167
00:15:13,620 --> 00:15:15,150
have lost our way

168
00:15:15,150 --> 00:15:20,250
I have a shirt and you'll see it you're
a very kind of wherein sure it's a cloud

169
00:15:20,250 --> 00:15:26,700
and its got like a zipper on it says the
clouds just someone else's computer and

170
00:15:26,700 --> 00:15:30,210
yet somehow think oh we're going to push
it to the cloud save a lot of money

171
00:15:30,720 --> 00:15:33,870
what are you doing for access controls
hello

172
00:15:33,870 --> 00:15:38,550
now that's not access control and yet we
think somehow that just because it's

173
00:15:38,550 --> 00:15:41,880
somebody else's system is not our
problem

174
00:15:41,880 --> 00:15:49,439
all we need to do is get back to the
basics we lost our way and so if you

175
00:15:49,440 --> 00:15:50,670
want this like that

176
00:15:50,670 --> 00:15:55,560
come on seeing your email i'll be happy
to share with you these next couple

177
00:15:55,560 --> 00:15:59,400
slides are things that are passionate
about and I'm totally confused

178
00:15:59,400 --> 00:16:06,540
we've also wrote patches missing
passengers are there a any ransom or

179
00:16:06,540 --> 00:16:09,630
other using zero days

180
00:16:09,630 --> 00:16:15,750
no no in fact I saw one that I was
working with a couple months ago that it

181
00:16:15,750 --> 00:16:18,839
was a three-and-a-half-year-old
vulnerability

182
00:16:18,839 --> 00:16:22,930
ok you don't want to admit that is an
industry

183
00:16:22,930 --> 00:16:26,469
pretty much seen applying patches with
three and a half years

184
00:16:27,160 --> 00:16:32,800
come on if you don't have on me a
testing of your environment you're just

185
00:16:32,800 --> 00:16:38,589
begging to get kicked in the teeth and
the thing that kills me is there's a lot

186
00:16:38,589 --> 00:16:41,830
of organizations that when passengers
come here like you don't know that

187
00:16:41,830 --> 00:16:47,770
affect rod you know what there was a
tool released in the very late nineties

188
00:16:47,770 --> 00:16:52,810
by the Apache foundation cold chain look
into it

189
00:16:52,810 --> 00:16:57,910
jmeter is a java-based out with that
allows you to your application that

190
00:16:57,910 --> 00:17:02,170
allows you to record and rerun
transactions doesn't matter it's

191
00:17:02,170 --> 00:17:05,619
web-based doesn't matter if it's a state
of extreme section doesn't matter if

192
00:17:05,619 --> 00:17:09,909
it's in a few you can read on those
transactions and know with absolute

193
00:17:09,910 --> 00:17:16,030
certainty that the patch does or does
not break your environment and it's free

194
00:17:16,030 --> 00:17:20,559
it cost literally nothing you can also
use it as a little festival is one of

195
00:17:20,559 --> 00:17:25,149
the best-kept secrets and information
security and information technology

196
00:17:25,150 --> 00:17:31,870
patrickjr is awesome should be able to
know within minutes of how fast black

197
00:17:31,870 --> 00:17:37,780
patches we have one client that's super
proud of that BS on their past cycle

198
00:17:37,780 --> 00:17:42,760
from one legger soft releases a patch to
when they can know that it will work on

199
00:17:42,760 --> 00:17:44,410
all production systems

200
00:17:44,410 --> 00:17:51,520
I'm not kidding folks eat and a half
hours fully of a hundred percent

201
00:17:51,520 --> 00:17:57,070
certainty and just works party
decorations

202
00:17:58,330 --> 00:18:05,949
yeah question what is the name of the
tool again the tools thing is jmeter

203
00:18:05,950 --> 00:18:08,039
that is j as in

204
00:18:08,039 --> 00:18:13,379
yet and then Peter like the meter stick
and it's from apache they have a great

205
00:18:13,379 --> 00:18:17,789
wiki there's tons of awesome material
out there you can also use it for a load

206
00:18:17,789 --> 00:18:24,809
tester that's actually converse fell
into it i was five load balance at the

207
00:18:24,809 --> 00:18:30,178
time and I used it to stress test
environment and I was like hey in reruns

208
00:18:30,179 --> 00:18:34,830
actions through this thing and I was
like oh this is great can't wait to tell

209
00:18:34,830 --> 00:18:39,178
the community and I saw they have your
so your patch management with Jamie like

210
00:18:39,179 --> 00:18:51,330
oh so it's a great tool poor
configurations all alright if you know a

211
00:18:51,330 --> 00:18:55,619
pen tester like pluck them and say it's
going to be okay because this is where

212
00:18:55,619 --> 00:18:59,999
most pen testers live is a check for
weird configuration flaws in your

213
00:18:59,999 --> 00:19:05,220
environment if you're not handling check
your configurations for you i love the

214
00:19:05,220 --> 00:19:09,659
bad guys are they're just not fearing
the results so do the parents do the

215
00:19:09,659 --> 00:19:13,649
students check your configurations use
the Center for Internet Security

216
00:19:13,649 --> 00:19:17,758
guideline how many folks have read these
documents please put your hand up if

217
00:19:17,759 --> 00:19:23,609
you've read them all right is that if
you not read them or not heard of them

218
00:19:23,609 --> 00:19:28,199
don't feel bad they don't have to be
advertising budget it's a not-for-profit

219
00:19:28,200 --> 00:19:33,570
organization go out download these
benchmark tools please promise me that

220
00:19:33,570 --> 00:19:36,989
you're not going to be operating heavy
machinery while you read the benchmarks

221
00:19:36,989 --> 00:19:39,299
they are dry boring and dull

222
00:19:39,299 --> 00:19:45,029
however at running through one of the
best part templates you will have an OS

223
00:19:45,029 --> 00:19:50,879
that will bring a pen tester to
frustrate years there's benchmarks for

224
00:19:50,879 --> 00:19:55,080
every operating system application etc
that is not true to your environment

225
00:19:55,889 --> 00:20:03,059
yeah oh we account this is one of those
ones where the great years that have you

226
00:20:03,059 --> 00:20:08,639
first of all the amount they would lost
their mind it used to be that were

227
00:20:08,639 --> 00:20:11,889
pretty good as in industry and not
having to

228
00:20:11,890 --> 00:20:20,710
hands not having shared passwords boy
services really much data as pester

229
00:20:20,710 --> 00:20:28,780
pester let me tell you i love going
after I they're not like an authorized

230
00:20:28,780 --> 00:20:34,570
authorized access you know me so make
sure that people are sharing house make

231
00:20:34,570 --> 00:20:38,770
sure that the passwords are strong make
sure that you teach your users that

232
00:20:38,770 --> 00:20:43,870
passwords are dead at three o'clock
there's going to be a guy thinking this

233
00:20:43,870 --> 00:20:49,870
room actually Martin Boes use with my
sister company trusted sex and eat every

234
00:20:49,870 --> 00:20:57,189
year participates in the crack me if you
can challenge at last year not this sort

235
00:20:57,190 --> 00:21:09,100
of your for that and his team crafted 22
character password in three days out you

236
00:21:09,100 --> 00:21:13,330
gotta get better on account hygiene you
guys are doing what you need to do to

237
00:21:13,330 --> 00:21:20,439
defend monitoring is the one that always
brings me to tears when i come in and do

238
00:21:20,440 --> 00:21:26,440
a case against cryptolocker people will
come to me and i'll say maybe we had no

239
00:21:26,440 --> 00:21:32,080
idea that they were in our network
really really you didn't know that you

240
00:21:32,080 --> 00:21:35,860
had a workstation is doing other work
station workstation traffic

241
00:21:35,860 --> 00:21:40,570
well we were looking there ok that's
like um you didn't know that you had

242
00:21:40,570 --> 00:21:44,950
used for your environment that was a new
rating all the network shares all five

243
00:21:44,950 --> 00:21:47,890
starters they could and started
incremental going through every single

244
00:21:47,890 --> 00:21:48,910
file

245
00:21:48,910 --> 00:21:53,680
no really this hearing your event why is
where i'm seeing this take place

246
00:21:56,140 --> 00:22:03,370
look at your logs this is i also got
some the suspect we'll talk about is a

247
00:22:03,370 --> 00:22:06,620
very good tool for that but there's also
other commands

248
00:22:06,620 --> 00:22:10,909
don't have to just take me my tools
there's plenty of things out there that

249
00:22:10,910 --> 00:22:17,150
will help you find it that backup
practice please back up and this tears

250
00:22:17,150 --> 00:22:22,160
my heart out last week i was up at a
company and they were like what we have

251
00:22:22,160 --> 00:22:26,750
back up some like sweet let's take a
look at your backups it was a USB drive

252
00:22:26,750 --> 00:22:34,730
attached to the server not cryptolocker
found it so they had backup of the

253
00:22:34,730 --> 00:22:41,300
cryptographic stuff do your backups he
knows me

254
00:22:42,200 --> 00:22:48,980
it kills me that auditors now pretty
much stopped validating the facts are

255
00:22:48,980 --> 00:22:55,370
real i remember back in the early 2000s
the ernst & young's and other accounting

256
00:22:55,370 --> 00:23:01,100
firms were real stick wit as long as
they just don't care anymore start

257
00:23:01,100 --> 00:23:09,050
caring about this bugger back of that be
on the lookout for fishing a lot of the

258
00:23:09,050 --> 00:23:14,809
matter where these sorts of ransomware
comes in addition if you held a gun to a

259
00:23:14,809 --> 00:23:18,830
pen testers and said hey you gotta get
access to a network number one thing

260
00:23:18,830 --> 00:23:26,960
they say is fishing now I going to get a
little rant here than normally that is a

261
00:23:26,960 --> 00:23:30,710
lot of organizations when I go in and I
say hey they fish get this is how this

262
00:23:30,710 --> 00:23:33,740
malware happened you know here's the
timeline and they're like all those

263
00:23:33,740 --> 00:23:42,350
users users user excuse you know what
i'll be the first commit nice to do that

264
00:23:42,350 --> 00:23:45,830
I've changed my tune

265
00:23:46,640 --> 00:23:55,970
here's what um so my dad worked in the
steel very dangerous place and if

266
00:23:55,970 --> 00:23:59,450
somebody's walking on a catwalk and
they're not harvesting correctly they're

267
00:23:59,450 --> 00:24:00,500
going to fall to their death

268
00:24:00,500 --> 00:24:05,990
there's no ifs ands or buts about it you
fall under and you don't concrete you

269
00:24:05,990 --> 00:24:12,950
smush if somebody falls off of the
catwalk will be less than Bob kind of

270
00:24:12,950 --> 00:24:15,850
sucked but it seems

271
00:24:15,850 --> 00:24:19,209
catwalk a week later somebody else falls
over

272
00:24:20,500 --> 00:24:25,809
they don't start playing the users they
start laying the capital the harness the

273
00:24:25,809 --> 00:24:32,110
process fishing now is our problem as
technologies

274
00:24:32,679 --> 00:24:38,980
it's not a user I don't know what fixes
I got some ideas because you wanted to

275
00:24:38,980 --> 00:24:43,299
talk but you can't blame the users
anymore

276
00:24:43,299 --> 00:24:52,090
you've got to do a better job protecting
drive-by download you know it used to be

277
00:24:52,090 --> 00:24:55,059
when your uncle or some neighborhood

278
00:24:55,059 --> 00:24:59,320
friend or friend came to you and said
hey I got all these pop-ups appearing on

279
00:24:59,320 --> 00:25:05,799
my computer you like going wherever you
surfing right you guys know that you

280
00:25:05,799 --> 00:25:08,559
were the ones like making all these
pop-ups that's weird

281
00:25:08,559 --> 00:25:14,740
um that doesn't happen anymore Google is
serving up delicious it's not all the

282
00:25:14,740 --> 00:25:19,630
time but the bad guys will figure out
how to get around that um the major

283
00:25:19,630 --> 00:25:26,740
league baseball was serving up malware
PBS was serving up yet

284
00:25:26,740 --> 00:25:32,080
PS like the public television station
mr. Rogers is serving up malware from

285
00:25:32,080 --> 00:25:36,220
time to time so we need to start
waitlisting internet sites only and I

286
00:25:36,220 --> 00:25:40,000
see you guys me and that white let's be
bad

287
00:25:41,110 --> 00:25:47,979
not so real easy we do you hear that way
listing at least to cut down the risk

288
00:25:47,980 --> 00:25:49,390
potential is

289
00:25:49,390 --> 00:25:54,549
amazon bought alexis is a marketing firm
the alexa top million is released every

290
00:25:54,549 --> 00:26:00,610
three days really available that is a
list of the top million dns sites were

291
00:26:00,610 --> 00:26:06,399
sites that people go to onion right for
number one which is almost always

292
00:26:06,400 --> 00:26:11,530
facebook all the way down to the
1,000,001 asking you to you and this is

293
00:26:11,530 --> 00:26:13,840
a hack that I learned from John stream
event

294
00:26:13,840 --> 00:26:20,770
mine take some number ten thousand five
thousand one thousand i don't care say

295
00:26:20,770 --> 00:26:22,299
alright here's the hell

296
00:26:22,299 --> 00:26:25,929
everything about this automatically wait
you want to face

297
00:26:25,929 --> 00:26:30,220
good luck out now if your organization
wants to be a little tighter than that

298
00:26:30,880 --> 00:26:35,679
awesome but what I'm saying is you can
do internet waitlisting city's top-10

299
00:26:35,679 --> 00:26:40,179
thousands of automatically allowed no
questions asked and you will have a

300
00:26:40,179 --> 00:26:46,510
drastic in half on the amount of
drive-by downloads if you just get fixed

301
00:26:46,510 --> 00:26:53,289
these two things your organization is
going to be sitting real pretty real

302
00:26:53,289 --> 00:27:12,908
question and say well no I war started I
know there's some of those so here's the

303
00:27:12,909 --> 00:27:20,080
deal that so we're talking about adult
content the comment is are you going to

304
00:27:20,080 --> 00:27:24,730
lab it's all contents into a into an
organization

305
00:27:24,730 --> 00:27:28,990
probably not i'll be honest but i will
tell you this

306
00:27:29,679 --> 00:27:34,120
we got a lot of analysis and the ones
that make it to that great are not doing

307
00:27:34,120 --> 00:27:42,309
the cheese they are legit businesses
that are fulfilling a need started

308
00:27:42,309 --> 00:27:46,450
started to make a little fun that but
that's the case the folks that are

309
00:27:46,450 --> 00:27:52,570
fairly high up in that list are fairly
legit now here's another thing you guys

310
00:27:52,570 --> 00:27:56,139
might be safe hope that make you know
our organization we might have something

311
00:27:56,140 --> 00:28:00,250
that's late at a hundred thousand or
maybe not even all the top enlisted all

312
00:28:00,250 --> 00:28:02,020
and they needed for business

313
00:28:02,020 --> 00:28:08,889
holy cool absolutely here's what you do
you allow any user to contact the

314
00:28:08,890 --> 00:28:16,690
helpdesk and say- own so I this site and
here's why they get whatever reason they

315
00:28:16,690 --> 00:28:22,299
want and you report that stuff there
isn't an auditor that I talk to you that

316
00:28:22,299 --> 00:28:23,190
has said

317
00:28:23,190 --> 00:28:28,470
that because all you do is track
somebody said that they needed it

318
00:28:28,470 --> 00:28:32,850
why they needed it and what they needed
and you're good to go

319
00:28:32,850 --> 00:28:36,629
I know some organizations that goes so
far as to actually have a system where

320
00:28:36,630 --> 00:28:41,580
the help this can unlock that sleep
myself I don't know if I'd go that far

321
00:28:41,580 --> 00:28:50,879
but you know it is something longer so I
allow somebody to be my premises like

322
00:28:50,880 --> 00:28:58,020
I've got the message late your bag
access that site i have to do all the

323
00:28:58,020 --> 00:29:04,050
work so that the comment is why do you
allow somebody to go to the site that

324
00:29:04,050 --> 00:29:10,110
could affect them my comment is if you
got waitlisted and you've got really

325
00:29:10,110 --> 00:29:11,429
tight you're good

326
00:29:11,430 --> 00:29:15,570
a lot of organizations don't we have
organizations me see what's your

327
00:29:15,570 --> 00:29:23,220
internet usage in there like whatever
and it shocks me what I'm saying is

328
00:29:23,220 --> 00:29:27,210
those who are doing walk west whatever
you want to do is you want internet

329
00:29:27,210 --> 00:29:34,680
these days are done and you can make a
good argument human organization by

330
00:29:34,680 --> 00:29:38,760
saying this is the line the same we're
going to draw everything else and above

331
00:29:38,760 --> 00:29:44,040
automatically printed and find large
most of those people are fairly good

332
00:29:44,040 --> 00:29:49,260
late they're not causing problems me to
the shore Major League Baseball google

333
00:29:49,260 --> 00:29:54,330
etc are going to be targets for drive-by
download but what you're really doing

334
00:29:54,330 --> 00:29:58,860
like this is you're blocking the people
like especially the pictures that will

335
00:29:58,860 --> 00:30:05,250
setup a domain and start fishing camping
literally minutes later so doing just

336
00:30:05,250 --> 00:30:10,560
that have a dramatic impact awesome
special tonight going great

337
00:30:10,560 --> 00:30:15,240
alright so next i encode can run

338
00:30:16,770 --> 00:30:21,900
why are you kidding antivirus should be
dead

339
00:30:22,600 --> 00:30:26,918
and the reason we did is we should be
whitelisting only the applications the

340
00:30:26,919 --> 00:30:30,160
end users should know and I know this
sounds crazy

341
00:30:30,669 --> 00:30:34,990
there's a lot of organizations that this
might not be terribly practical for your

342
00:30:34,990 --> 00:30:40,210
entire user group but for certain
communities it's worth fighting this

343
00:30:40,210 --> 00:30:46,360
fight restrict the application so that
they can run to the set today for their

344
00:30:46,360 --> 00:30:52,600
business that's it a different client of
ours who's crazy they're absolutely

345
00:30:52,600 --> 00:30:58,270
bombers came up with a very interesting
setup with Windows app Locker and they

346
00:30:58,270 --> 00:31:05,110
said hey what if we did a situation
where we microsoft an untrusted

347
00:31:05,110 --> 00:31:11,559
publisher like white lady the OS more
run no equal now what we're going to do

348
00:31:11,559 --> 00:31:15,908
is we will whitelist the applications
needed for day-to-day use for a

349
00:31:15,909 --> 00:31:21,700
particular user and then admins who have
their gpo of policies that allow them to

350
00:31:21,700 --> 00:31:24,700
run things like community XD and Power
Cell txt etc

351
00:31:25,270 --> 00:31:29,020
they're good to go but normally users
are only able to run an office

352
00:31:29,020 --> 00:31:33,668
applications and use their web browser
and that's about it

353
00:31:33,669 --> 00:31:40,659
i'm here to tell you that whenever
somebody gets that has contract at

354
00:31:40,659 --> 00:31:46,120
trusted set were at other companies that
I we SAT with them about they start

355
00:31:46,120 --> 00:31:49,600
swearing softly because imagine as a
pastor

356
00:31:49,600 --> 00:31:55,449
you can even pop can see that you can
win this fight

357
00:31:55,450 --> 00:31:59,470
it's actually not that part profile user
executables especially now

358
00:31:59,470 --> 00:32:03,820
powershell this is a module within
suspect that all i'll be talking about

359
00:32:03,820 --> 00:32:07,240
understood network traffic

360
00:32:07,929 --> 00:32:13,690
whoa controls folks remember that
firewalls work both ways

361
00:32:14,409 --> 00:32:21,070
please users should only be allowed out
on e and 443 and that's about it

362
00:32:22,630 --> 00:32:26,860
hopefully they're actually only going to
your proxy and they don't have any

363
00:32:26,860 --> 00:32:29,439
internet out it's all going through your
proxy and that's

364
00:32:29,440 --> 00:32:33,820
it um watch your workstation and
workstations traffic if you don't have

365
00:32:33,820 --> 00:32:37,360
the ability to see workstation
workstation traffic your job is a lot

366
00:32:37,360 --> 00:32:41,500
harder than it needs to be now to be
sure there are times that workstation

367
00:32:41,500 --> 00:32:46,539
workstation track is legit and expected
but that should be relatively rare in

368
00:32:46,539 --> 00:32:52,539
your organization and you should be able
to account for that and no i don't get

369
00:32:52,539 --> 00:32:59,169
the antivirus i have now worked five
cases in the past order where we have

370
00:32:59,169 --> 00:33:05,710
had companies that were getting hit by
cryptolocker and the reason that they

371
00:33:05,710 --> 00:33:09,279
found out that the water was running
wild in their organization is the

372
00:33:09,279 --> 00:33:14,769
antivirus engine was triggering on
different points in their networks and

373
00:33:14,769 --> 00:33:19,330
hey these machines have a locker and I
was like well what about those machines

374
00:33:19,330 --> 00:33:28,418
are running 1800 here really like if
antivirus is too tough like going to say

375
00:33:28,419 --> 00:33:32,019
this like antivirus is not a very good
defense

376
00:33:32,019 --> 00:33:39,639
you know you know that by ass but man
what it it's not a hard need to sell its

377
00:33:39,639 --> 00:33:40,959
not itself

378
00:33:40,960 --> 00:33:45,940
finally the next two items that i want
to talk about file permissions

379
00:33:45,940 --> 00:33:51,820
why does everyone have full control on
your network chairs now you might be

380
00:33:51,820 --> 00:33:56,320
better than that and if so give yourself
a pat on back but one of the things that

381
00:33:56,320 --> 00:33:59,168
kills me is if you have full control

382
00:33:59,169 --> 00:34:03,850
there is a special little twist of the
knife that the bad guys are able to do

383
00:34:03,850 --> 00:34:08,770
to you when they're doing cryptolocker
attacking will delve into that slides

384
00:34:08,770 --> 00:34:15,129
don't get full control allows them to
alter the timestamps and then they do

385
00:34:15,129 --> 00:34:19,629
that to evade detection so don't get
full control so he needs to write all

386
00:34:19,629 --> 00:34:20,409
right

387
00:34:20,409 --> 00:34:30,369
the only only give them room finally the
final audit windows has one of the best

388
00:34:30,369 --> 00:34:32,200
in this mainly

389
00:34:32,199 --> 00:34:37,359
this is coming from somebody who's been
a to use unix and making I said well as

390
00:34:37,359 --> 00:34:43,480
a spectacular dialogue in fact it's one
of the better things about us turn it on

391
00:34:43,480 --> 00:34:51,609
for the love of God be targeted don't
don't turn on everywhere as anybody turn

392
00:34:51,609 --> 00:34:55,659
it on the entire like see directly at
them but what happens when you do that

393
00:34:55,659 --> 00:35:01,210
too much noise assistant slows down to a
crawl and in some cases automatic smoke

394
00:35:01,210 --> 00:35:05,349
comes out computer so you know where
there is a system in there are a lot of

395
00:35:05,349 --> 00:35:10,599
articles out there were people they do
turn on don't turn it on everywhere be

396
00:35:10,599 --> 00:35:15,490
targeted if you've got a folder where
your crown jewels are turn it on you

397
00:35:15,490 --> 00:35:21,368
should know looking at sort of elements
into assume it into a log management

398
00:35:21,369 --> 00:35:23,200
tools some sort

399
00:35:23,200 --> 00:35:29,589
any questions so far mi same crazy stuff
is this stuff get hurt before

400
00:35:30,280 --> 00:35:37,930
no sir only allow programs run

401
00:35:37,930 --> 00:35:43,419
yes have only program ready

402
00:35:44,020 --> 00:35:49,750
so the question is for application
whitelisting only allowing certain

403
00:35:49,750 --> 00:35:55,930
applications to run there's multiple
ways that you can allow applications to

404
00:35:55,930 --> 00:36:01,930
run the easiest and believe me this this
is a low-cost simple easy way to go is

405
00:36:01,930 --> 00:36:07,000
just say we're going to allow this
directory actually peoples from this

406
00:36:07,000 --> 00:36:13,030
directory and then you prevent you can
write to that directory so that any user

407
00:36:13,030 --> 00:36:17,770
can overwrite quick malicious stuff in
there that's a real easy then the next

408
00:36:17,770 --> 00:36:23,980
one is trusted publishers or trust
executables so there's multiple ways was

409
00:36:23,980 --> 00:36:33,970
doing at work till our government is I
are you know

410
00:36:33,970 --> 00:36:39,060
ah ok so so yes so that's it

411
00:36:39,060 --> 00:36:46,799
that's excellent comment in X 1 comment
that concern is um who's who is trusted

412
00:36:46,800 --> 00:36:58,260
in one cas please if you follow where is
it here if you follow this the Center

413
00:36:58,260 --> 00:37:01,500
for Internet Security guideline one of
the things for every Windows operating

414
00:37:01,500 --> 00:37:05,460
system and one of the things for linux
operating system for every back which

415
00:37:05,460 --> 00:37:10,320
hey that was just about everything tells
you to review your certificate trusts

416
00:37:10,320 --> 00:37:17,970
please review users trust for a while
the hall post office was a certificate

417
00:37:17,970 --> 00:37:23,129
already late and I'm not making that
like that was a real thing so you need

418
00:37:23,130 --> 00:37:29,730
to review that most organizations have
those the hapless lockdown are in great

419
00:37:29,730 --> 00:37:30,180
shape

420
00:37:30,180 --> 00:37:35,730
it's not hard to do and it's very that's
a great question

421
00:37:39,120 --> 00:37:46,140
any other questions are never gonna move
is more detection side of the house look

422
00:37:46,140 --> 00:37:47,609
for encrypted files

423
00:37:47,610 --> 00:37:51,060
this is a lot easier than you may think
it is

424
00:37:51,060 --> 00:37:57,330
normal files if you think about them
have character distribution is quite

425
00:37:57,330 --> 00:38:02,640
frankly board it looks something like
this in english language this is letter

426
00:38:02,640 --> 00:38:08,490
frequency of I think it was a snapshot
of wikipedia particular time

427
00:38:09,480 --> 00:38:17,400
programmatically this is very easy to
detect encrypted files as long as

428
00:38:17,400 --> 00:38:21,750
they're not doing like the substitution
cipher like we're doing modern

429
00:38:21,750 --> 00:38:28,500
cryptography that file that letter
frequency will be flat it will look all

430
00:38:28,500 --> 00:38:33,210
the same because they're making it so
that you can do better analysis

431
00:38:33,210 --> 00:38:39,630
political situation analysis so we all
look out for files the client . tax but

432
00:38:39,630 --> 00:38:42,589
having a character frequency that
doesn't match

433
00:38:42,589 --> 00:38:48,469
you would expect and that's a feature
within a suspect but we're talking about

434
00:38:48,469 --> 00:38:54,859
a bit lookout for mac time offsets this
is one of the things that sets my hair

435
00:38:54,859 --> 00:39:03,950
on fire and so am i love the ntfs the
microsoft five system there's better

436
00:39:03,950 --> 00:39:07,279
ones if you want to talk like five
system holy waters we can talk about

437
00:39:07,279 --> 00:39:12,499
that but there are some really really
neat features in ntfs and one of them is

438
00:39:12,499 --> 00:39:18,950
the mac timestamps modified access
create modified access create those

439
00:39:18,950 --> 00:39:26,210
three times stamps are on every single
five but there's actually two sets so

440
00:39:26,210 --> 00:39:30,979
you have one set that is exposed to
normal userland if you have full control

441
00:39:30,979 --> 00:39:36,769
on file you can alter these time streams
that's what a lot of the malware is

442
00:39:36,769 --> 00:39:43,399
doing is they will take that mac time
and they will encrypt the file and the

443
00:39:43,400 --> 00:39:49,910
mac time is different they will back
date to what that I was prior to when

444
00:39:49,910 --> 00:39:54,739
they started messing with that there's a
problem and this is a glorious problem

445
00:39:54,739 --> 00:39:57,109
because we use defenders capitalize on
this

446
00:39:57,109 --> 00:40:04,308
there's another set that is curl only
microsoft is not at least nobody knows

447
00:40:04,309 --> 00:40:10,009
how to alter those time seems all you
need to do is look and see if those

448
00:40:10,009 --> 00:40:18,950
timestamps matchup if they don't that's
weird there's an amazing amazing blog

449
00:40:18,950 --> 00:40:24,710
posting on this now the year 2014 we
know about how to detect this sort of

450
00:40:24,710 --> 00:40:25,969
thing for a while

451
00:40:25,969 --> 00:40:30,589
it's a great tool you can run your
organization on a fairly frequent basis

452
00:40:30,589 --> 00:40:35,509
most of the organization's i encourage
them to run this one hourly case against

453
00:40:35,509 --> 00:40:40,160
the officers are really scared about
where tax eat

454
00:40:40,710 --> 00:40:47,190
really that simple it's available on
github if you read the blog post that on

455
00:40:47,190 --> 00:40:51,060
the prior slide there's one at the
bottom . see changes depending on your

456
00:40:51,060 --> 00:40:55,770
version of PowerShell you may need to
import another time stamp reading

457
00:40:55,770 --> 00:41:01,530
feature but um what you can do is look
for these timestamp offsets now i'll be

458
00:41:01,530 --> 00:41:06,030
honest there are times you will get
false positives there are certain way

459
00:41:06,030 --> 00:41:10,320
ball editing tools that will do the same
thing but once you weren't listening out

460
00:41:10,320 --> 00:41:13,320
for them you're going to go

461
00:41:13,830 --> 00:41:22,740
this doesn't cost you in there also want
to look out for processes that use too

462
00:41:22,740 --> 00:41:26,700
much I of Windows has a pretty ok

463
00:41:26,700 --> 00:41:32,129
instrumentation step called perform you
can look for average reads an average

464
00:41:32,130 --> 00:41:37,410
rights that take place over time here
and if they go over to higher threshold

465
00:41:37,410 --> 00:41:42,450
you can take action on your juicing he's
going to like this to see what your

466
00:41:42,450 --> 00:41:53,160
topmost um resource-intensive in terms
of finals of files systems are you doing

467
00:41:53,160 --> 00:41:53,580
this

468
00:41:53,580 --> 00:41:59,098
get process sort descending select
process named resources special table

469
00:41:59,099 --> 00:42:04,290
should be named and then resources and
select first time that will tell you the

470
00:42:04,290 --> 00:42:11,009
top 10 most file reading and writing
executables now if that's something that

471
00:42:11,010 --> 00:42:15,300
you don't know on that system that's
something to investigate little by

472
00:42:15,300 --> 00:42:21,030
here's a neat thing you can do get
processed dash computer name and this

473
00:42:21,030 --> 00:42:27,300
will run remote so you can scan your
entire domain and do this very very

474
00:42:27,300 --> 00:42:34,619
easily running long time so what I'll do
is I'll just chat about this little bit

475
00:42:34,619 --> 00:42:38,210
there's a tool that I i'm writing called
suspect that

476
00:42:38,210 --> 00:42:44,060
couple times I it's on github its
private right now because it's bringing

477
00:42:44,060 --> 00:42:50,900
but what I'm doing is with this it will
monitor the processes running on your

478
00:42:50,900 --> 00:42:55,700
system it will check the hashes of the
executable and the DLLs that are being

479
00:42:55,700 --> 00:43:01,368
called by and I'm hoping to have a color
really soon

480
00:43:01,369 --> 00:43:08,960
realistically will probably use you but
it's really really cool it will find

481
00:43:08,960 --> 00:43:13,190
when you've got a new process right this
is this mode will actually help you

482
00:43:13,190 --> 00:43:17,420
build up your application whitelisting
using a blocker bored without whatever

483
00:43:17,420 --> 00:43:23,330
application with this means we had it
will also look for files that are over

484
00:43:23,330 --> 00:43:28,940
too high of an i/o thresholds so it will
look at what the average i/o and then

485
00:43:28,940 --> 00:43:34,820
max I o is for that process over a given
time frame and then it's using the

486
00:43:34,820 --> 00:43:41,780
powershell internals tool to suspend the
process and then you can unfreeze it

487
00:43:41,780 --> 00:43:47,270
that way if you accidentally have false
positive you know Western civilization

488
00:43:47,270 --> 00:43:53,359
doesn't and you can just unfreeze that
process and life is good for everyone so

489
00:43:53,359 --> 00:43:58,130
hopefully you know training out that's
my email

490
00:43:58,130 --> 00:44:02,839
don't spam me on that

491
00:44:02,839 --> 00:44:06,859
thank you for your time I appreciate the
questions guys got other questions let

492
00:44:06,859 --> 00:44:09,859
me now and then

493
00:44:13,180 --> 00:44:18,460
by the way thank the videographers

