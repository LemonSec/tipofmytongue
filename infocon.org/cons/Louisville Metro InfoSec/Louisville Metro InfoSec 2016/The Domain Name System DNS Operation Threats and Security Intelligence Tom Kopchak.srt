1
00:00:00,060 --> 00:00:03,060
what does laptop

2
00:00:04,180 --> 00:00:07,359
want to go

3
00:00:07,360 --> 00:00:10,360
making my weekend

4
00:00:18,210 --> 00:00:31,769
how many want to get started we'll be
able to get out there you're gonna get

5
00:00:31,769 --> 00:00:35,280
there about another vinegar so for some
people it's hard

6
00:00:42,340 --> 00:00:56,350
then

7
00:00:57,370 --> 00:01:03,269
yeah

8
00:01:03,270 --> 00:01:07,890
yeah

9
00:01:25,450 --> 00:01:29,740
good morning everyone on board

10
00:01:31,509 --> 00:01:35,799
no thank you very much for coming out
this is actually my first time in

11
00:01:35,799 --> 00:01:40,929
Kentucky from Cleveland hurricane labs
and I'm our director effective

12
00:01:40,929 --> 00:01:46,240
operations which basically means these
days is that just for office space i

13
00:01:46,240 --> 00:01:50,649
think the requirements for the customers
and give them the engineers used to do a

14
00:01:50,649 --> 00:01:53,079
lot more technical work on our network
side

15
00:01:53,079 --> 00:01:57,279
did someone administration now I get to
be the person individually responsible

16
00:01:57,280 --> 00:02:01,869
for making sure that all of our
customers work is done and that they're

17
00:02:01,869 --> 00:02:02,649
happy

18
00:02:02,649 --> 00:02:07,000
so whatever technical or managerial
things that need to be done are

19
00:02:07,000 --> 00:02:13,540
something that I get to do so it's very
rewarding and something I enjoy and the

20
00:02:13,540 --> 00:02:20,560
topic of something that is a very
fundamental part of how computers and

21
00:02:20,560 --> 00:02:24,579
the internet works but also something
that's very very interesting from a

22
00:02:24,579 --> 00:02:30,880
security operation may be talking today
about the domain name system dns as part

23
00:02:30,880 --> 00:02:36,370
of this talk I'm going to really make
some jokes that are pretty that which is

24
00:02:36,370 --> 00:02:37,540
kind of my trademark

25
00:02:37,540 --> 00:02:44,290
so I appreciate you flat for those does
anyone bring a broad now

26
00:02:44,290 --> 00:02:55,388
ok well I got some just a trial if
anyone wants to make sure you know if

27
00:02:55,389 --> 00:02:58,989
you're offended in any way to stop you
know I'm going to get one person in the

28
00:02:58,989 --> 00:03:01,989
center here on the road

29
00:03:02,970 --> 00:03:07,859
somehow i'm gonna sell this place in
here like don't make the bark side but

30
00:03:07,860 --> 00:03:12,180
as John mentioned the keynote just
before this pot that data is very

31
00:03:12,180 --> 00:03:21,720
important for security intelligence and
really I did that the MSPB login audio

32
00:03:21,720 --> 00:03:26,940
that's alive so it's jonathan you know
that is really important i think that

33
00:03:26,940 --> 00:03:31,440
the NSA is really one of the most
interesting and most useful forms of

34
00:03:31,440 --> 00:03:37,290
that mad at almost the home and we're
going to dive in through how dns works

35
00:03:37,290 --> 00:03:40,650
so that everyone can understand that you
might be review for some of you but it

36
00:03:40,650 --> 00:03:44,610
might nothing and really the goal of
what i wanted to write this presentation

37
00:03:44,610 --> 00:03:50,280
was I found myself I'm like a very
regular basis trying to explain the ns2

38
00:03:50,280 --> 00:03:55,050
people and finding that people who are
dns administrators opted exactly know

39
00:03:55,050 --> 00:03:58,350
how the technology works i really hope
that does not i just want you in this

40
00:03:58,350 --> 00:04:02,100
room but if it does it's fine you're
gonna leave here knowing a lot more

41
00:04:02,100 --> 00:04:06,510
about how dns operates I really i want
you to leave here with more knowledge

42
00:04:06,510 --> 00:04:11,549
about something that's really important
to the operation the internet so if that

43
00:04:11,550 --> 00:04:20,310
is what happens I've done my job so
let's get started to make figure out is

44
00:04:20,310 --> 00:04:24,419
a so why are we talking about us

45
00:04:24,419 --> 00:04:31,349
Oh name resolution is obviously
important how many of you here have had

46
00:04:31,350 --> 00:04:38,460
this question post you is here and now
some of you have had people ask that to

47
00:04:38,460 --> 00:04:38,909
you

48
00:04:38,910 --> 00:04:44,820
of course you almost makes me think of
back in college I was an apartment

49
00:04:44,820 --> 00:04:51,419
complex and all the internet was not
working except for mine and all my

50
00:04:51,419 --> 00:04:54,690
friends are like you know all means like
hey the Internet's down . it's fine

51
00:04:55,770 --> 00:04:59,940
what actually happened is the provider
of the isp for their apartment complex

52
00:04:59,940 --> 00:05:02,469
was having it now service attacks on
there

53
00:05:02,470 --> 00:05:07,480
servers are down i was running my own
dns server going through the dns process

54
00:05:07,480 --> 00:05:08,590
that we're going to talk about

55
00:05:08,590 --> 00:05:12,340
I didn't notice anything my neighborhood
solution was fine and my internet is

56
00:05:12,340 --> 00:05:13,299
working great

57
00:05:13,300 --> 00:05:19,330
everyone else was just blocked because
they were using another desperate so

58
00:05:19,330 --> 00:05:23,919
users really don't like it when you call
help this like at the Internet no it's

59
00:05:23,920 --> 00:05:28,360
fine just not having dns resolution go
to this IP addresses you get the upset

60
00:05:28,360 --> 00:05:34,060
doesn't work at all so people expect
name resolution to be the same as

61
00:05:34,060 --> 00:05:41,140
internetworking also i really really
like everyone to know how things work if

62
00:05:41,140 --> 00:05:44,890
were running something before
administering something I want us to be

63
00:05:44,890 --> 00:05:48,610
able to not only feel running but be
able to have some competent

64
00:05:48,610 --> 00:05:52,270
understanding of how it functions and
that's really my goal to be able to

65
00:05:52,270 --> 00:05:57,729
understand and explain to someone how
the internet or how many NS works and

66
00:05:57,730 --> 00:06:00,940
then since this is a security
presentation I want to talk about us

67
00:06:00,940 --> 00:06:06,340
confused by actress because it's such a
ubiquitous part of how every network

68
00:06:06,340 --> 00:06:10,840
functions captors love to use it for
very evil things and it can be

69
00:06:10,840 --> 00:06:15,849
definitely something that's leverage and
he's being actively lovers attacks and

70
00:06:15,850 --> 00:06:18,729
finally when we get into the metadata
side of things

71
00:06:18,729 --> 00:06:23,260
security intelligence and this is really
cool and interesting part of us we're

72
00:06:23,260 --> 00:06:25,450
going to start by understanding how it
works we're going to understand how

73
00:06:25,450 --> 00:06:28,780
characters use it but then we're going
to look at what we can do with security

74
00:06:28,780 --> 00:06:33,940
professionals delivered in s gotta to
either better secure organization to

75
00:06:33,940 --> 00:06:39,490
protect against potential capture
investigate acts were also to just get a

76
00:06:39,490 --> 00:06:42,760
better sense of what our users are doing
and what our routines are doing and

77
00:06:42,760 --> 00:06:45,760
forensically investigate what happened

78
00:06:46,390 --> 00:06:49,630
let's get started talking about the NS
truck

79
00:06:49,630 --> 00:06:55,300
PS is actually the best example of a
database in the world that's globally

80
00:06:55,300 --> 00:07:00,580
distributed how many of you either
currently or now run a database or

81
00:07:00,580 --> 00:07:07,240
function as a DBA some functionality of
some at least I saw one hand uh how did

82
00:07:07,240 --> 00:07:10,780
you at least understand the idea that
databases can be a pain

83
00:07:10,780 --> 00:07:19,090
administer yes so the fact that is works
is amazing because you have not just one

84
00:07:19,090 --> 00:07:22,840
database but everyone across the world
that runs the dns server is a part of

85
00:07:22,840 --> 00:07:27,340
this database and there's no single set
of the source of information this

86
00:07:27,340 --> 00:07:34,869
database is distributed across the world
in terms of dns technology terminology

87
00:07:34,870 --> 00:07:40,690
there's a lot of different types of dns
service different and we have the

88
00:07:40,690 --> 00:07:45,700
concept double local result that is your
dns server that lives locally on your

89
00:07:45,700 --> 00:07:46,360
network

90
00:07:46,360 --> 00:07:50,380
it's typically your DMS sir your
organization domain controller that's

91
00:07:50,380 --> 00:07:55,540
where your users are going to be go
locally for getting X we also have all

92
00:07:55,540 --> 00:08:00,580
of dns servers which your preservers
poorly configured it might be a public

93
00:08:00,580 --> 00:08:04,510
dns server and I could be bad we'll talk
about why but those are typically

94
00:08:04,510 --> 00:08:09,550
provision by ISPs or other providers the
best example being Google's white TS

95
00:08:09,550 --> 00:08:16,000
server caching is a technology or
technique that's used by the s in order

96
00:08:16,000 --> 00:08:20,050
to reduce the number of stories
basically every time something is to

97
00:08:20,050 --> 00:08:24,250
resolve in eight there's a lifetime for
time to live on that and that cash

98
00:08:24,250 --> 00:08:28,600
reduce some of the traffic on the
Internet as a result of that root

99
00:08:28,600 --> 00:08:32,140
servers are at the top of the dns tree
will talk about very shortly

100
00:08:32,799 --> 00:08:37,419
they do not provide every bit of
information about every domain name they

101
00:08:37,419 --> 00:08:42,819
only know where the top-level domains
are as this understanding but root

102
00:08:42,820 --> 00:08:46,660
servers can get you to the authoritative
name servers and that's what we would

103
00:08:46,660 --> 00:08:51,310
run if you are running to domain you
have you coordinated domain server for

104
00:08:51,310 --> 00:08:54,489
that name

105
00:08:54,490 --> 00:09:01,330
now the lab explain dns is a tree and
you want to look at it from the right to

106
00:09:01,330 --> 00:09:07,990
the left and he basically build up so so
at the top of every dns name are the top

107
00:09:07,990 --> 00:09:12,130
of the trees was invisible back here the
dns group you don't type that but it's

108
00:09:12,130 --> 00:09:17,230
implied and if you've ever configure dns
stone file you know how important your

109
00:09:17,230 --> 00:09:18,520
guitar

110
00:09:18,520 --> 00:09:23,380
what when I was a greater for nes
classic college there was the first lab

111
00:09:23,380 --> 00:09:28,209
report where is taking up . offer every
. that was next in the writing lab

112
00:09:28,209 --> 00:09:32,890
report and people were telling me like I
was a horrible person and dirt for doing

113
00:09:32,890 --> 00:09:36,699
this guy's when you get his own powers
you'll understand why . are important

114
00:09:36,700 --> 00:09:43,570
and then they appreciate i think but at
the top level you have multiple domains

115
00:09:43,570 --> 00:09:53,680
that you that info all of those so tree
root top level of every top-level you

116
00:09:53,680 --> 00:09:58,899
have individual domain names that are
delegated from the top level domain your

117
00:09:58,899 --> 00:10:05,230
labs your google all of that and then
individual domains delegate subdomains

118
00:10:05,230 --> 00:10:14,110
at they need them so basically each
level controls the next level now so the

119
00:10:14,110 --> 00:10:17,470
top level we know how to get to
hurricane labs and then working last

120
00:10:17,470 --> 00:10:22,930
rule everything that's a subdomain of
Hurricane laps so I want to walk you

121
00:10:22,930 --> 00:10:27,219
through what a DNS requests looks like
in the process of resolving it all the

122
00:10:27,220 --> 00:10:33,190
way that the US route so that you'll be
able to walk around it works let's just

123
00:10:33,190 --> 00:10:38,079
say that there's a client-server that
wants to go to hurricane last count i

124
00:10:38,079 --> 00:10:43,420
would recommend that every client wants
to do this . up this line has a request

125
00:10:43,420 --> 00:10:50,920
to local dns server say hey I want to go
to her out what the idea is local dns

126
00:10:50,920 --> 00:10:55,149
server since no one's ever going to that
this company doesn't know the domain so

127
00:10:55,149 --> 00:10:58,480
it wants to figure out how to get there

128
00:10:58,480 --> 00:11:00,490
in fact this will be necessary

129
00:11:00,490 --> 00:11:06,730
ever look up that before because it was
just for diner has FB cash so the local

130
00:11:06,730 --> 00:11:11,410
dns records going to go to the root
server and say where's that where's the

131
00:11:11,410 --> 00:11:15,910
authoritative name server for that the
rumors going to look towards list of

132
00:11:15,910 --> 00:11:20,020
that combat or all the top-level domains
and return the address of the

133
00:11:20,020 --> 00:11:25,149
authoritative name server product out
local dns sir and all of the root server

134
00:11:25,149 --> 00:11:28,930
does he doesn't tell you we're starting
last comment doesn't tell you where

135
00:11:28,930 --> 00:11:36,399
wwe.com the root server only knows about
top-level domains and that's really a

136
00:11:36,399 --> 00:11:39,970
function of keeping internet working
because if we had to update all

137
00:11:39,970 --> 00:11:44,560
information to the roots are completely
unmanageable and the level of traffic on

138
00:11:44,560 --> 00:11:48,910
those routes service will be including
national so next now that we know where

139
00:11:48,910 --> 00:11:54,550
that common is we're going to have our
local dns server go back and talk to the

140
00:11:54,550 --> 00:12:00,790
top level domain server for that top and
at that time that level domain server

141
00:12:00,790 --> 00:12:06,310
looks to its list of your domain certain
last google and facebook and returns the

142
00:12:06,310 --> 00:12:12,250
authoritative name server for her unless
you are local dns sir we're not done yet

143
00:12:12,250 --> 00:12:16,450
we only know how to get to the hurricane
lads name server we still have to make

144
00:12:16,450 --> 00:12:23,079
another request so now it'll be a super
good i'm here unfortunately have video

145
00:12:23,079 --> 00:12:27,370
freeze up but audio should resume and
about the 12 minutes 44 seconds mark

146
00:12:45,529 --> 00:12:50,149
and really this is a efficient and happy
because the actually needs to provide

147
00:12:50,149 --> 00:12:57,110
the body and agents a list of open
resolvers to use an HR be effective so

148
00:12:57,110 --> 00:13:00,649
what actually happens in this case the
attacker tells all the pocket

149
00:13:00,649 --> 00:13:05,600
hey this bag are this good guy i want
them to go away by watching and I'll

150
00:13:05,600 --> 00:13:12,350
service and these open resolvers are
things that I can probably send in a

151
00:13:12,350 --> 00:13:17,540
question and what it actually does is
all these bachmann agents will spook the

152
00:13:17,540 --> 00:13:21,920
source of the attack or Spruce spoof the
source IP address

153
00:13:21,920 --> 00:13:26,420
actually this victim sir so whatever
this IP address is that's where all

154
00:13:26,420 --> 00:13:30,920
these pockets are going to say traffic
is originating from the left traffic is

155
00:13:30,920 --> 00:13:34,699
going to be a DNS requests often at ens
any requests which has the largest

156
00:13:34,699 --> 00:13:40,370
return payload of any and you could also
do it with other DNS requests but you're

157
00:13:40,370 --> 00:13:44,509
not going to get the same back because
really want to create as much return

158
00:13:44,509 --> 00:13:49,069
traffic is possible for the smallest
amount of incoming track basically we're

159
00:13:49,069 --> 00:13:55,309
sending to all of these open resolvers a
hay list me everything that you have and

160
00:13:55,309 --> 00:13:57,259
throw it at this poor guy

161
00:13:57,259 --> 00:14:01,490
so naturally what's going to happen in
all dns servers with a lot of bandwidth

162
00:14:01,490 --> 00:14:05,930
are going to be sending tons of
unsolicited return DNS traffic

163
00:14:05,930 --> 00:14:13,819
respective server not get offline so
really these misconfigured systems

164
00:14:13,819 --> 00:14:18,319
contribute to this denial of service so
if you have an open resolver you can be

165
00:14:18,319 --> 00:14:24,199
part of denial of service attack not on
the bottom side or a cross-eyed as a

166
00:14:24,199 --> 00:14:30,139
contributor to the amount of traffic
coming in so at this point you're

167
00:14:30,139 --> 00:14:34,279
probably wondering how to stop it really
proper configuration is the way to do it

168
00:14:34,819 --> 00:14:38,400
unfortunately in front of every dns
server so squished

169
00:14:38,400 --> 00:14:42,630
turn off occurs you just press that
you're done but it's actually a config

170
00:14:42,630 --> 00:14:48,060
file change so you need a lot of
different domains that you own to be

171
00:14:48,060 --> 00:14:52,560
resolved but you don't want a lot of
recursion to be a lot so it's really a

172
00:14:52,560 --> 00:14:55,949
simple configuration change depending on
if you're running buying windows for

173
00:14:55,950 --> 00:14:59,730
your public facing dns you can do the
different configuration but it is a

174
00:14:59,730 --> 00:15:03,900
simple change and as long as you
correctly defined the things that you

175
00:15:03,900 --> 00:15:08,939
are owning it'll be something that you
can do you really think you remember for

176
00:15:08,940 --> 00:15:14,220
this is that you are an isp unless of
course you up so you don't want to be

177
00:15:14,220 --> 00:15:19,020
the nice guy in the internet here that
goes ahead and looks up randomly that

178
00:15:19,020 --> 00:15:22,800
other people ask because you only want
to provide responses for buildings that

179
00:15:22,800 --> 00:15:31,589
you'll other things that we can talk
about blind Craster's these are

180
00:15:31,590 --> 00:15:33,630
something that are back

181
00:15:33,630 --> 00:15:38,670
I mean or a zone transfer is a
fundamental operation for master and

182
00:15:38,670 --> 00:15:44,880
slave DNS configuration where we have
one system that is the authoritative for

183
00:15:44,880 --> 00:15:48,630
the master source of information and you
want all the other DNS service

184
00:15:48,630 --> 00:15:52,800
organization the same thing it's
expected for those to transfer

185
00:15:52,800 --> 00:15:56,790
information on a regular basis because
they need to be in said anything changes

186
00:15:57,450 --> 00:16:01,650
however you don't want some random
person on the internet to be able to be

187
00:16:01,650 --> 00:16:05,400
hey I'm now a name server and I want to
grab all of your domain information

188
00:16:05,400 --> 00:16:06,959
please

189
00:16:06,960 --> 00:16:11,790
even if they see please you don't want
that to work the reason that this can be

190
00:16:11,790 --> 00:16:17,219
used as if you're trying to do a test
from the outside or even inside the

191
00:16:17,220 --> 00:16:22,860
organization and the first thing you
want to know is what services are hosted

192
00:16:22,860 --> 00:16:27,960
we're so if I'm trying to look at
something from the outside and I get a

193
00:16:27,960 --> 00:16:32,940
list of all the domains and say I see
you know internet that you don't know

194
00:16:32,940 --> 00:16:38,250
there's a highlight the difference
probably an Internet same for your mail

195
00:16:38,250 --> 00:16:40,940
you already know what things are we now
have

196
00:16:40,940 --> 00:16:45,560
to do any sort of skin so like if you're
an investor that's one of the best tools

197
00:16:45,560 --> 00:16:48,439
that you can use to quickly get
information about an organization about

198
00:16:48,440 --> 00:16:52,490
what systems are valuable vulnerable
without having to do any sort of

199
00:16:52,490 --> 00:16:57,290
networks can be just another tool that
you can use so without having this

200
00:16:57,290 --> 00:17:00,110
information it makes you do a little bit
more work

201
00:17:00,110 --> 00:17:07,670
not a lot more work but it's at least
something that makes it not as the next

202
00:17:07,670 --> 00:17:12,589
kind of an act that you can see the idea
of building high and this has been

203
00:17:12,589 --> 00:17:17,300
leveraged in a couple of high-profile
attacks on new york times being a great

204
00:17:17,300 --> 00:17:18,409
example

205
00:17:18,410 --> 00:17:27,620
basically this is a pure social
engineering where some bad guy can say

206
00:17:27,619 --> 00:17:38,000
hey I own your x calm and you know we're
moving data centers and we're not in New

207
00:17:38,000 --> 00:17:42,740
York anymore were in Russia so can you
teach all of the record score up

208
00:17:42,740 --> 00:17:48,290
newyorktimes.com to point you to
register our Russia and everything will

209
00:17:48,290 --> 00:17:51,200
be cool and I just like sure that makes
perfect sense

210
00:17:51,200 --> 00:17:55,910
we'll just move all of New York Russia
and the registration is information is

211
00:17:55,910 --> 00:18:02,180
modified without your permission so that
can be an attack that is difficult

212
00:18:02,180 --> 00:18:07,520
prevent obviously because you're at the
mercy of the registrar doing their job

213
00:18:07,520 --> 00:18:11,780
so what are the best ways to prevent
something like this from happening is to

214
00:18:11,780 --> 00:18:16,550
detect for modifications to any of your
registration information and then

215
00:18:16,550 --> 00:18:20,480
immediately be able to contact the
regiment or to have that domain lock so

216
00:18:20,480 --> 00:18:24,290
that can change but even if something
locked there's a possibility that that

217
00:18:24,290 --> 00:18:28,250
can be social engineer as well but
that's definitely something that's been

218
00:18:28,250 --> 00:18:32,810
used in high-profile attacks for things
that a lot of people are going to go to

219
00:18:32,810 --> 00:18:40,700
New York being great example in this is
also an amazing / channel because it's

220
00:18:40,700 --> 00:18:45,920
something that is ubiquitous in almost a
form of networking because we have to

221
00:18:45,920 --> 00:18:47,210
result in order

222
00:18:47,210 --> 00:18:50,659
the legs work so dns is pretty much
allowed all the time

223
00:18:51,230 --> 00:18:54,980
that means that if there is something
that's preventing you from going to be

224
00:18:54,980 --> 00:18:59,240
internet normally like a captive portal
he asked specifically allowed works as

225
00:18:59,240 --> 00:19:04,580
expected and that will allow you to use
the NS a tunnel to transmit information

226
00:19:04,580 --> 00:19:10,309
out it's really one of the things that
pianist even seen as a harmless protocol

227
00:19:10,309 --> 00:19:17,600
really locked and even it tnx is
something that is restricted the way

228
00:19:17,600 --> 00:19:21,590
that dns works in a hierarchical
approach you're pretty much going to be

229
00:19:21,590 --> 00:19:26,029
able to resolve a name to talk to
another server and that other server

230
00:19:26,029 --> 00:19:30,919
that you ultimately control can be used
to do things that look like a nest

231
00:19:30,919 --> 00:19:33,440
request better actually bored

232
00:19:33,440 --> 00:19:37,549
the real question is what is the DNS
request more than just to be an extra

233
00:19:37,549 --> 00:19:42,830
cloth so in this case you can have a
client that's running the dns tunnel

234
00:19:42,830 --> 00:19:47,299
client application and probably one of
the best and easiest used easiest use

235
00:19:47,299 --> 00:19:52,220
versions of this is a tool called iodine
really called iodine is iodine mp3 on

236
00:19:52,220 --> 00:19:56,750
the periodic table and escort 53 so
someone's a little Club they're

237
00:19:56,750 --> 00:20:01,250
basically you can run be an ester aidel
server running the iodide server

238
00:20:01,250 --> 00:20:06,350
application your client can run that as
well you can send a bunch of DNS

239
00:20:06,350 --> 00:20:11,240
requests that look like a nest requests
that are typically tax records and it

240
00:20:11,240 --> 00:20:15,559
will go through the local dns server all
the way through the firewall through the

241
00:20:15,559 --> 00:20:23,658
internet and get here and you'll be able
to actually trade data for example so

242
00:20:23,659 --> 00:20:29,149
this is what this will often look like
you're looking at ens logs so let's just

243
00:20:29,149 --> 00:20:34,969
say I have my tunnel most didn't say
that is because every imposed is Kate

244
00:20:34,970 --> 00:20:40,309
again what and she take that info is
even more shade obviously you want to

245
00:20:40,309 --> 00:20:45,440
make this as small as possible so this
is probably for domain for actually

246
00:20:45,440 --> 00:20:47,650
excellent rating down and ask if you
want

247
00:20:47,650 --> 00:20:52,060
short of this kind of like tea that the
shortest daddy photomania find that

248
00:20:52,060 --> 00:20:55,360
would work better because it gives you
more room in the DNS request for a low

249
00:20:55,360 --> 00:20:59,949
but basically it look like this
happening in your network random

250
00:20:59,950 --> 00:21:05,110
characters that are basically encoding
information and that was requested for

251
00:21:05,110 --> 00:21:10,840
dns and make it to the destination you
can actually send out to waste and its

252
00:21:10,840 --> 00:21:14,980
really one of the most powerful ways to
exfiltrate data that works almost all

253
00:21:14,980 --> 00:21:22,240
the time so inevitably you're going to
be wondering how do we stop there's a

254
00:21:22,240 --> 00:21:26,860
lot of options for that and and we get
into the security intelligence we can

255
00:21:26,860 --> 00:21:31,270
talk more about that initially like
looking for

256
00:21:31,810 --> 00:21:37,929
I behavior and families and freshly dns
record volumes are options but a lot of

257
00:21:37,930 --> 00:21:41,440
these security intelligence that we can
do with analyzing DNS requests value

258
00:21:41,440 --> 00:21:46,630
really be used for this and that is
nicely into the final part of this

259
00:21:46,630 --> 00:21:51,250
presentation worries are talking about
being a security intelligence and this

260
00:21:51,250 --> 00:21:57,730
is really where we take ESS existing ask
this useful part of making internetwork

261
00:21:57,730 --> 00:22:02,830
we understand it's all are one better
than theirs price but what can we do

262
00:22:02,830 --> 00:22:07,149
with all the dns information
organization to provide better security

263
00:22:07,150 --> 00:22:12,730
and know what's happening and really if
there is any source of information that

264
00:22:12,730 --> 00:22:16,360
you want to bring in when you're doing a
security assessment or looking to

265
00:22:16,360 --> 00:22:20,500
implement security intelligence program
dns is probably one of the easiest ones

266
00:22:20,500 --> 00:22:24,610
to get and one of the most useful
because there's nothing else that

267
00:22:24,610 --> 00:22:30,969
provides the level of detail about what
clients are doing in a human

268
00:22:30,970 --> 00:22:38,920
understandable format and there's all
kinds of use cases and security that

269
00:22:38,920 --> 00:22:43,810
we're going to go through one of the
first ones going to be SSL encrypted

270
00:22:43,810 --> 00:22:49,540
traffic analysis with so many things
resulting or relying on HTS encrypted

271
00:22:49,540 --> 00:22:50,520
communication

272
00:22:50,520 --> 00:22:55,320
we can't rely on being able to dig in do
an HTTP request is pretty much anything

273
00:22:55,320 --> 00:23:00,510
these days then be encrypted and doing
man in the middle on SL is not always

274
00:23:00,510 --> 00:23:03,900
practical especially depending on how to
setup

275
00:23:03,900 --> 00:23:06,960
there's your systems if you don't
control for example you can push up

276
00:23:06,960 --> 00:23:13,530
certificate so being able to see what's
happening without having to break SL is

277
00:23:13,530 --> 00:23:20,670
very useful the threat intelligence to
understand what that actors are using

278
00:23:20,670 --> 00:23:25,650
lucky and s names and being able to
correlate request to actual that

279
00:23:25,650 --> 00:23:32,790
addresses forensic investigations of it
acts being able to find your patient

280
00:23:32,790 --> 00:23:37,920
zero figure out what that was set where
what systems they talk to and what other

281
00:23:37,920 --> 00:23:45,570
systems your organization might be also
comes to that unites detecting the

282
00:23:45,570 --> 00:23:50,760
exfiltration of that and easy and is
being used as a cover general in your

283
00:23:50,760 --> 00:23:56,190
organization or four just accessing
resources that should be resource and

284
00:23:56,190 --> 00:24:02,640
then also for threat research there's a
lot of research that can be done for

285
00:24:02,640 --> 00:24:07,050
letting bad actors understanding what
systems are compromised

286
00:24:07,050 --> 00:24:12,690
what bad things exist on the internet by
using the apps and its really one of the

287
00:24:12,690 --> 00:24:21,030
best sources of person that can be used
as well to talk about ssl traffic

288
00:24:21,030 --> 00:24:26,100
correlation really the problem that we
see is almost everything is included

289
00:24:26,610 --> 00:24:32,520
this could be just our normal request is
part of web browsing and using google

290
00:24:32,520 --> 00:24:37,260
for example using webmail well I like to
be something that's not allowed in the

291
00:24:37,260 --> 00:24:45,090
organization and you need to understand
the users are doing really the best

292
00:24:45,090 --> 00:24:51,209
solution for something like this without
breaking SL easy-to-understand correlate

293
00:24:51,210 --> 00:24:56,280
your ssl proxy logs your web proxy
larger firewall logs cheer dns locks

294
00:24:56,280 --> 00:24:57,928
because this issue

295
00:24:57,929 --> 00:25:03,210
rest your firewall IP address yes lawd
just give you a hostname and the

296
00:25:03,210 --> 00:25:08,669
associated IP address for that so you
already have a name and an IP address to

297
00:25:08,669 --> 00:25:13,080
know this user was doing this at this
time and you don't have to dig into

298
00:25:13,080 --> 00:25:25,559
trying to break the SLS real-time here
is also threat intelligence up there are

299
00:25:25,559 --> 00:25:33,059
a bajillion literally of dns or domain
name blacklist that exists everyone has

300
00:25:33,059 --> 00:25:37,168
their own black less how they generate
that it's all up to the person who

301
00:25:37,169 --> 00:25:42,570
creates that black but if we look for
the National ups or no malicious sites

302
00:25:42,570 --> 00:25:48,029
and logs we know that there could be
clients that are going to things that

303
00:25:48,029 --> 00:25:52,320
are in front left and we don't really
have to look for other details on that

304
00:25:52,320 --> 00:25:56,490
CD s request happening for something
that we know is posting malware for

305
00:25:56,490 --> 00:26:00,480
example or an oversight want that we
immediately know

306
00:26:00,990 --> 00:26:04,919
ok this client booked up this domain for
some reason this is something we need to

307
00:26:04,919 --> 00:26:10,320
investigate and just a quick bit of
information mystery question happen

308
00:26:10,320 --> 00:26:11,939
because this is bad

309
00:26:11,940 --> 00:26:16,649
we need this information and then also
looking for hosting providers associated

310
00:26:16,649 --> 00:26:22,529
with ransom so there are some hosting
providers that are notably shade that

311
00:26:22,529 --> 00:26:28,740
have a lot of ransomware associated with
them and these I very have lots of IP

312
00:26:28,740 --> 00:26:33,600
addresses that are associated with these
providers and just by doing hey i see

313
00:26:33,600 --> 00:26:37,860
this request for this domain that
results in this IP address this IP

314
00:26:37,860 --> 00:26:41,908
addresses from your provider that's
known to be able to stay trancewater the

315
00:26:41,909 --> 00:26:45,899
fact that i'm seeing this domain I'd
never seen before but it has high part

316
00:26:45,899 --> 00:26:50,580
of the probability of going back to this
provider that has this history that's

317
00:26:50,580 --> 00:26:55,439
something we want to look at as well so
using this data you can almost see in

318
00:26:55,440 --> 00:26:57,639
advance that something might be better

319
00:26:57,639 --> 00:27:01,899
has a high probability of being bad
without even knowing what the domain

320
00:27:01,899 --> 00:27:10,570
actually is look at it from the
forensics investigations dns can provide

321
00:27:10,570 --> 00:27:16,899
a lot of information about the timeline
walking through ok this client know

322
00:27:16,899 --> 00:27:22,359
looked up this domain and now as we saw
action in the initial presentation for

323
00:27:22,359 --> 00:27:26,379
the car black presentation where we saw
the whole to get help for example that

324
00:27:26,379 --> 00:27:30,189
was in the demonstration we see that
there be a DNS requests for that we

325
00:27:30,190 --> 00:27:36,519
might see DNS requests to other systems
and we might after we see that happen we

326
00:27:36,519 --> 00:27:39,729
might be other clients started to make
those requests and you can really walk

327
00:27:39,729 --> 00:27:43,029
through this is the first point that was
compromised it downloaded this

328
00:27:43,029 --> 00:27:47,679
executable from this domain now we see
another system going out that domain

329
00:27:47,679 --> 00:27:52,299
pulling on this executable we now we see
request going out to this other site a

330
00:27:52,299 --> 00:27:55,779
lot of requests that might be an
external for example the actual trading

331
00:27:55,779 --> 00:28:00,700
data and really just using dns combined
with other law we have to understand

332
00:28:00,700 --> 00:28:06,879
what's happening and you can also see
request for managing full serves so we

333
00:28:06,879 --> 00:28:13,958
have a list of either known cnc IP
addresses or melon cnc DNS names we can

334
00:28:13,959 --> 00:28:17,440
find a client that might be compromised
that are calling out to those systems

335
00:28:17,440 --> 00:28:25,539
and a regular basis we talk about
cuddling already but if we look for our

336
00:28:25,539 --> 00:28:30,158
logs and attacked an abnormally high
number of lookups first single domain

337
00:28:30,159 --> 00:28:32,349
that's going to be an animal

338
00:28:32,349 --> 00:28:37,329
normal you're not going to see hundreds
or thousands or millions of requests for

339
00:28:37,329 --> 00:28:42,279
very similar domains are subdomains on
the same domain in a very short period

340
00:28:42,279 --> 00:28:47,889
by now we definitely be an anomaly that
can be picked up and seen as something

341
00:28:47,889 --> 00:28:57,248
ok this client is literally doing some
data exfiltration through dns and we

342
00:28:57,249 --> 00:29:03,369
also have a threat intelligence research
which determine that one of our level 3

343
00:29:03,369 --> 00:29:04,999
and healthcare analyst ever

344
00:29:04,999 --> 00:29:07,999
laughs Tony Robinson likes to use is
guilty by association

345
00:29:08,539 --> 00:29:11,869
he actually have a really great
presentation Circle City Times walking

346
00:29:11,869 --> 00:29:16,639
through houses can be used and some of
this is very nicely into what I'm

347
00:29:16,639 --> 00:29:21,319
talking about here but really this is
the idea of using DNS data to determine

348
00:29:21,319 --> 00:29:26,389
I that are likely to host mouth and
really where other domains that are

349
00:29:26,389 --> 00:29:31,008
associated with the domain or those ip's
they're just significantly more likely

350
00:29:31,009 --> 00:29:38,359
to also the way we look at places let
you start we have this domain and and

351
00:29:38,359 --> 00:29:41,629
any of the names that are going to be
here and here they are not necessarily

352
00:29:41,629 --> 00:29:45,319
bad i just made him up as being
potentially that so that you may not be

353
00:29:45,319 --> 00:29:52,459
a perfectly good site you can check out
you get infected I'm sorry but obviously

354
00:29:52,459 --> 00:29:57,949
we're going to manually as idea dress
that's associated with it that is your

355
00:29:57,949 --> 00:30:06,379
mat so let's look at other sites that
clearly appeared to be bad that are

356
00:30:06,379 --> 00:30:11,029
associated we have no legal comment on
official said that context we get that

357
00:30:11,029 --> 00:30:17,569
net all these things that i dapped this
sequel that but then lifted start

358
00:30:17,569 --> 00:30:21,799
researching more domains that are
associated with that is so you know like

359
00:30:21,799 --> 00:30:25,939
three sunglasses for example that could
be a tight back into this idea of

360
00:30:25,939 --> 00:30:31,489
Russian ones that are you recognize that
CN cheekbones that you know all these

361
00:30:31,489 --> 00:30:35,899
sites they're not necessarily bad but
the fact that they are hosted on a site

362
00:30:35,899 --> 00:30:41,779
that's from a provider that has bad
things they're they're more likely to be

363
00:30:41,779 --> 00:30:49,669
sites that are something that could be a
friend so it's a kinda ristic idea of

364
00:30:49,669 --> 00:30:55,309
identified weird things clusters a bad
stuff that systems might be going to

365
00:30:55,309 --> 00:31:04,819
surely by using dns and the way that we
do a lot of the security threat

366
00:31:04,819 --> 00:31:10,579
intelligence research is based on dns
laws so the first thing you have to do

367
00:31:10,579 --> 00:31:12,370
in order to do this is flat

368
00:31:12,370 --> 00:31:19,629
really you want to have as much as
possible your old ass logs which can be

369
00:31:19,630 --> 00:31:22,480
something that is a little bit of a
challenge but there's different

370
00:31:22,480 --> 00:31:26,500
techniques that can use them a lot of
times if you're going to pull this in

371
00:31:26,500 --> 00:31:31,450
with like a slug order for example your
servers need to being basically default

372
00:31:31,450 --> 00:31:36,309
debugging motor look like a lot of times
your windows admins are going to little

373
00:31:36,309 --> 00:31:40,270
blog about that because a lot of volume
to be ready to walk because there's

374
00:31:40,270 --> 00:31:45,850
another option is back into the keynote
earlier

375
00:31:45,850 --> 00:31:52,360
yes gap for screen over the wire we're
up you can basically watch incoming DNS

376
00:31:52,360 --> 00:31:56,050
requests in your dns server and
immediately send that in this block

377
00:31:56,050 --> 00:32:01,750
logging purposes now my focus obviously
a hurricane is around books and that's

378
00:32:01,750 --> 00:32:05,290
what i'm most familiar with but other
sims have other ways for flaking this

379
00:32:05,290 --> 00:32:09,040
dad just if you have any questions about
that i can definitely help you with the

380
00:32:09,040 --> 00:32:14,590
books I'd just absolutely or the other
schools and really the idea is once we

381
00:32:14,590 --> 00:32:19,178
get these BS tool laws you want to make
them useful so even if you're reading

382
00:32:19,179 --> 00:32:23,110
all your dance log so flat file you can
do a lot of the correlation you can do a

383
00:32:23,110 --> 00:32:27,219
lot of statistics on those logs and
that's really where tool such as well or

384
00:32:27,220 --> 00:32:31,840
another data analytics tool is really
useful for understanding where are all

385
00:32:31,840 --> 00:32:36,070
my DNS requests coming from what are the
main sources of information and how do i

386
00:32:36,070 --> 00:32:40,510
love it stack for security purposes and
really that's where the magic happens

387
00:32:40,510 --> 00:32:45,670
there is so much information that can be
gleaned from the US results and dns slot

388
00:32:45,670 --> 00:32:50,140
that is one of the most important things
when we're setting up a security

389
00:32:50,140 --> 00:32:53,890
solution for our customers that we want
to make sure we have a firewall logs

390
00:32:53,890 --> 00:32:58,179
proxy large dns logs authentication
loves couple other sources of

391
00:32:58,179 --> 00:33:03,730
information can really help with making
security package that were 12 customer

392
00:33:03,730 --> 00:33:10,059
so would be remiss if i didn't just
mentioned a little bit about hurricane

393
00:33:10,059 --> 00:33:15,670
labs done and then we'll open up for
questions we do work as a MSP and we

394
00:33:15,670 --> 00:33:18,759
provide solutions in the area manager

395
00:33:18,759 --> 00:33:24,399
them punk rock services those are main
tools that we use pumping engine that

396
00:33:24,399 --> 00:33:30,309
powers a lot of this and then Fred
attaching volatility so with that I want

397
00:33:30,309 --> 00:33:35,469
to open up the floor for any questions
hopefully now you know how it is part of

398
00:33:35,469 --> 00:33:40,690
the internet works you'll be more power
to do your job and up do that

399
00:33:41,409 --> 00:33:44,440
yes

400
00:33:44,440 --> 00:33:52,089
so the question was what is the best
practice for keeping the logs for

401
00:33:52,089 --> 00:33:58,928
forensics that definitely depends what I
see drives a lot of that is retention

402
00:33:58,929 --> 00:34:05,889
periods for compliance so a lot of
people want to keep logs for pci or you

403
00:34:05,889 --> 00:34:10,268
know whatever type of compliance
purposes that you need that could be a

404
00:34:10,268 --> 00:34:17,678
year that's a lot of attic for you so it
really depends on the meantime for

405
00:34:17,679 --> 00:34:22,450
detecting something in the investigation
time . I find a lot of this is driven by

406
00:34:22,449 --> 00:34:26,138
allure so in some of the cases where
you're going to steal it

407
00:34:26,139 --> 00:34:29,829
I'll alert pretty quickly and take
action on investigating it

408
00:34:29,829 --> 00:34:33,549
you don't need that long of a retention
. but then again the industry average

409
00:34:33,549 --> 00:34:37,538
for finding a you know an attack or
something like this is something I've

410
00:34:37,539 --> 00:34:42,279
seem like six months or years so you
know if you don't discover and back

411
00:34:42,279 --> 00:34:45,309
until six months down the road you don't
have all that DNS data you're not going

412
00:34:45,309 --> 00:34:51,399
to be able to have this good idea what
happened so something like that spunk

413
00:34:51,399 --> 00:34:55,598
for example if you dump that bad to you
know just the compressed unsearchable

414
00:34:55,599 --> 00:34:59,589
version just archive it like Amazon
glacier something like that that's

415
00:34:59,589 --> 00:35:03,670
really cheap to keep that and scored for
a long period of time you don't have to

416
00:35:03,670 --> 00:35:07,359
actually keep it searchable something
comes off so that might be an option for

417
00:35:07,359 --> 00:35:12,640
that but generally i see the year time
frame is being a common applying

418
00:35:17,859 --> 00:35:20,859
any other questions

419
00:35:23,980 --> 00:35:30,549
ok well i brought my contact information
there if you have any questions

420
00:35:30,549 --> 00:35:31,900
afterwards and want to chat

421
00:35:31,900 --> 00:35:34,989
feel free to find me i also have
business cards here if you want to grab

422
00:35:34,989 --> 00:35:40,059
my contact information follow later via
email but thank you very much for coming

423
00:35:40,059 --> 00:35:41,890
enjoy the rest of the day and enjoy the
outlets

