1
00:00:06,820 --> 00:00:09,869
[Music]

2
00:00:13,040 --> 00:00:14,799
that's bright delight

3
00:00:14,799 --> 00:00:16,320
okay thanks for having me i think it's

4
00:00:16,320 --> 00:00:18,320
the second time around for insomniac the

5
00:00:18,320 --> 00:00:20,720
last time was about six seven years ago

6
00:00:20,720 --> 00:00:22,720
still at mandiant at that time

7
00:00:22,720 --> 00:00:25,039
and well i'm really happy that i can

8
00:00:25,039 --> 00:00:26,400
talk a little bit about managing large

9
00:00:26,400 --> 00:00:28,720
scale incident response because

10
00:00:28,720 --> 00:00:31,439
in the last few years um i've seen a lot

11
00:00:31,439 --> 00:00:33,520
of people doing really great incident

12
00:00:33,520 --> 00:00:35,760
response from a technical perspective

13
00:00:35,760 --> 00:00:37,440
but in the end they still fail to an

14
00:00:37,440 --> 00:00:39,360
extent the client is not super happy in

15
00:00:39,360 --> 00:00:41,920
the end and mostly that goes down to

16
00:00:41,920 --> 00:00:43,680
arrows in how you how you went through

17
00:00:43,680 --> 00:00:45,200
that whole engagement because it's more

18
00:00:45,200 --> 00:00:46,879
than just knowing your technical stuff

19
00:00:46,879 --> 00:00:48,480
there

20
00:00:48,480 --> 00:00:50,640
so first of all what do i consider

21
00:00:50,640 --> 00:00:53,600
large-scale incident response

22
00:00:53,600 --> 00:00:55,360
before i introduce myself i just say

23
00:00:55,360 --> 00:00:57,520
that first i don't think that there is a

24
00:00:57,520 --> 00:00:59,840
clear definition right so for some it's

25
00:00:59,840 --> 00:01:02,000
like a couple of hundred machines

26
00:01:02,000 --> 00:01:03,280
for some it's a couple of hundred

27
00:01:03,280 --> 00:01:04,720
thousand machines that does make a

28
00:01:04,720 --> 00:01:06,880
difference obviously not necessarily

29
00:01:06,880 --> 00:01:08,240
from the technical perspective that's

30
00:01:08,240 --> 00:01:09,920
the funny thing that is just something

31
00:01:09,920 --> 00:01:12,320
that comes down to tooling but if you

32
00:01:12,320 --> 00:01:13,520
have an organization with a couple of

33
00:01:13,520 --> 00:01:15,759
hundred thousand machines they just work

34
00:01:15,759 --> 00:01:17,200
a little bit more complex than an

35
00:01:17,200 --> 00:01:18,400
organization that has a couple of

36
00:01:18,400 --> 00:01:19,680
hundred machines

37
00:01:19,680 --> 00:01:21,520
so it's more that human factor that you

38
00:01:21,520 --> 00:01:23,439
have in there

39
00:01:23,439 --> 00:01:24,880
the only thing that i want to make clear

40
00:01:24,880 --> 00:01:26,640
is i'm not talking about

41
00:01:26,640 --> 00:01:28,960
a sock ticket incident response because

42
00:01:28,960 --> 00:01:31,119
you know most of the tools of those soar

43
00:01:31,119 --> 00:01:33,200
tools they also call that kind of

44
00:01:33,200 --> 00:01:34,560
incident response when you work on a

45
00:01:34,560 --> 00:01:35,680
socket ticket that's not what i'm

46
00:01:35,680 --> 00:01:37,439
talking about so i'm talking about a

47
00:01:37,439 --> 00:01:39,520
deep breach of a network where an attack

48
00:01:39,520 --> 00:01:41,200
was active moved laterally to a few

49
00:01:41,200 --> 00:01:43,360
machines maybe exfiltrated some data

50
00:01:43,360 --> 00:01:45,680
that's what i'm talking about here

51
00:01:45,680 --> 00:01:47,360
so the term is a little bit overused

52
00:01:47,360 --> 00:01:49,600
here

53
00:01:49,600 --> 00:01:51,759
it's very funny because from the sizing

54
00:01:51,759 --> 00:01:54,479
perspective there is actually an analogy

55
00:01:54,479 --> 00:01:56,960
that we can use here so when you go back

56
00:01:56,960 --> 00:02:01,200
to medical support in in big accidents a

57
00:02:01,200 --> 00:02:04,000
mass event is considered an event where

58
00:02:04,000 --> 00:02:06,079
the resources that are locally available

59
00:02:06,079 --> 00:02:08,720
are just too few to manage that response

60
00:02:08,720 --> 00:02:10,239
and i think that works pretty well here

61
00:02:10,239 --> 00:02:11,200
as well

62
00:02:11,200 --> 00:02:14,720
so it doesn't really depend on um on

63
00:02:14,720 --> 00:02:16,560
the size that you're facing but rather

64
00:02:16,560 --> 00:02:19,120
on how you work there uh what kind of

65
00:02:19,120 --> 00:02:20,640
people you have how many resources you

66
00:02:20,640 --> 00:02:23,040
have and so on so

67
00:02:23,040 --> 00:02:26,800
how do i i know that so why do i

68
00:02:26,800 --> 00:02:29,360
think that i can talk about that well

69
00:02:29,360 --> 00:02:31,120
first of all how do i learn all that

70
00:02:31,120 --> 00:02:32,160
stuff

71
00:02:32,160 --> 00:02:34,400
i make a ton of mistakes sometimes looks

72
00:02:34,400 --> 00:02:38,080
like this and over the last decade or so

73
00:02:38,080 --> 00:02:39,519
i don't make

74
00:02:39,519 --> 00:02:42,000
less mistakes probably but they're just

75
00:02:42,000 --> 00:02:44,800
not as big as they used to be and

76
00:02:44,800 --> 00:02:47,040
i also got lucky over the last few years

77
00:02:47,040 --> 00:02:48,560
because whenever i was about to make a

78
00:02:48,560 --> 00:02:50,000
bigger mistake there was someone holding

79
00:02:50,000 --> 00:02:51,599
me back

80
00:02:51,599 --> 00:02:52,959
that makes sure that i'm still in

81
00:02:52,959 --> 00:02:54,560
industry but when you do incident

82
00:02:54,560 --> 00:02:56,400
response you're always at the brink of

83
00:02:56,400 --> 00:02:58,800
losing reputation pretty quickly right

84
00:02:58,800 --> 00:03:00,080
so if you do something wrong if you

85
00:03:00,080 --> 00:03:03,040
declare an organization is super clean

86
00:03:03,040 --> 00:03:04,879
and they're not then that's a problem

87
00:03:04,879 --> 00:03:06,560
and that happens more and more

88
00:03:06,560 --> 00:03:09,200
uh the second uh thing where um i

89
00:03:09,200 --> 00:03:11,360
learned that is i'm teaching for sans um

90
00:03:11,360 --> 00:03:12,800
actually the the five weight advanced

91
00:03:12,800 --> 00:03:15,040
incident response class i'm authoring

92
00:03:15,040 --> 00:03:16,400
two more classes one for memory

93
00:03:16,400 --> 00:03:17,920
forensics and one for enterprise

94
00:03:17,920 --> 00:03:20,319
incident response and there we have on

95
00:03:20,319 --> 00:03:21,920
the sixth day always a capstone so

96
00:03:21,920 --> 00:03:23,519
people are confronted with a made-up

97
00:03:23,519 --> 00:03:25,840
case but that looks pretty real right to

98
00:03:25,840 --> 00:03:26,959
an extent

99
00:03:26,959 --> 00:03:29,280
and they need to present that case and

100
00:03:29,280 --> 00:03:30,640
the funny thing is you see the whole

101
00:03:30,640 --> 00:03:32,239
process so they are going to be grouped

102
00:03:32,239 --> 00:03:34,400
in groups of four or five people and

103
00:03:34,400 --> 00:03:36,720
they work on the data that they have and

104
00:03:36,720 --> 00:03:38,319
in the end they present what they have

105
00:03:38,319 --> 00:03:40,400
and even groups that are doing

106
00:03:40,400 --> 00:03:41,920
technically great and found a lot of

107
00:03:41,920 --> 00:03:42,879
stuff

108
00:03:42,879 --> 00:03:44,879
don't win in the end and the reason for

109
00:03:44,879 --> 00:03:46,640
that is sometimes they found something

110
00:03:46,640 --> 00:03:49,040
and then just forgot it forgot to put it

111
00:03:49,040 --> 00:03:50,799
into context and put it on their slides

112
00:03:50,799 --> 00:03:52,400
and stuff like that and that is

113
00:03:52,400 --> 00:03:53,840
something that happens in reality as

114
00:03:53,840 --> 00:03:54,799
well

115
00:03:54,799 --> 00:03:57,760
and the most concerning thing of how i

116
00:03:57,760 --> 00:04:00,159
learn is actually if well the easiest

117
00:04:00,159 --> 00:04:01,840
one for me because learning from other

118
00:04:01,840 --> 00:04:03,840
others mistakes is usually something

119
00:04:03,840 --> 00:04:06,239
that's less painful for you

120
00:04:06,239 --> 00:04:08,159
we're getting more and more called uh

121
00:04:08,159 --> 00:04:10,319
for a second opinion so either there is

122
00:04:10,319 --> 00:04:12,640
an investigation going on the client is

123
00:04:12,640 --> 00:04:14,799
not happy with the first vendor who went

124
00:04:14,799 --> 00:04:16,238
there

125
00:04:16,238 --> 00:04:19,440
secondly um we have um expert witness

126
00:04:19,440 --> 00:04:21,759
cases where we write reports about uh

127
00:04:21,759 --> 00:04:23,840
investigations that happen in the past

128
00:04:23,840 --> 00:04:26,000
and where something didn't went that

129
00:04:26,000 --> 00:04:28,080
well and where the clients use the

130
00:04:28,080 --> 00:04:30,560
provider so that happens more and more

131
00:04:30,560 --> 00:04:31,919
and

132
00:04:31,919 --> 00:04:33,360
the first case when it happened in the

133
00:04:33,360 --> 00:04:36,639
us i think was 2014 2015 around that

134
00:04:36,639 --> 00:04:37,919
time in the u.s

135
00:04:37,919 --> 00:04:40,320
had to do with my hotel and stuff but i

136
00:04:40,320 --> 00:04:43,520
can't go into details on that case

137
00:04:43,520 --> 00:04:46,160
having said that um to my history i've

138
00:04:46,160 --> 00:04:47,919
been doing incident response for over a

139
00:04:47,919 --> 00:04:50,320
decade now teaching for sense about a

140
00:04:50,320 --> 00:04:52,160
decade and

141
00:04:52,160 --> 00:04:53,520
i've been doing that pretty much all

142
00:04:53,520 --> 00:04:55,440
around the world except china maybe

143
00:04:55,440 --> 00:04:56,479
because

144
00:04:56,479 --> 00:04:58,080
all the companies i worked for were not

145
00:04:58,080 --> 00:05:00,560
happy working in china that much

146
00:05:00,560 --> 00:05:02,560
i used to work for german telecom for

147
00:05:02,560 --> 00:05:04,720
mandi and now i'm working for a swiss

148
00:05:04,720 --> 00:05:06,720
company running an incident response and

149
00:05:06,720 --> 00:05:08,880
intelligence team

150
00:05:08,880 --> 00:05:11,840
there but in another part of switzerland

151
00:05:11,840 --> 00:05:13,440
and i got a question uh because i want

152
00:05:13,440 --> 00:05:15,360
to know who i talked to here so who have

153
00:05:15,360 --> 00:05:17,280
you let incident response engagements in

154
00:05:17,280 --> 00:05:18,800
the past no matter if internal or

155
00:05:18,800 --> 00:05:20,240
external

156
00:05:20,240 --> 00:05:22,400
oh quite a few that's cool

157
00:05:22,400 --> 00:05:25,039
uh never hesitate to correct me or tell

158
00:05:25,039 --> 00:05:26,880
me your view on things right that's how

159
00:05:26,880 --> 00:05:28,240
we all learn right

160
00:05:28,240 --> 00:05:30,720
uh how many of you or who have you uh

161
00:05:30,720 --> 00:05:34,720
had investigations over a thousand hosts

162
00:05:35,039 --> 00:05:37,759
well most of you um that raised the hand

163
00:05:37,759 --> 00:05:40,240
before ten thousand

164
00:05:40,240 --> 00:05:41,110
hundred thousand

165
00:05:41,110 --> 00:05:42,320
[Music]

166
00:05:42,320 --> 00:05:44,160
that's where it gets um well a little

167
00:05:44,160 --> 00:05:46,320
bit more dicey because um

168
00:05:46,320 --> 00:05:47,680
they're not so many companies that have

169
00:05:47,680 --> 00:05:49,840
that many machines out there who's

170
00:05:49,840 --> 00:05:52,800
working for a competitor

171
00:05:52,800 --> 00:05:56,080
was nice meeting you goodbye

172
00:05:57,840 --> 00:05:58,960
okay

173
00:05:58,960 --> 00:06:00,400
so what we're going to walk through here

174
00:06:00,400 --> 00:06:02,960
is a few key success factors actually

175
00:06:02,960 --> 00:06:05,440
i'm sort of stealing the

176
00:06:05,440 --> 00:06:07,440
part of those slides from myself they're

177
00:06:07,440 --> 00:06:09,919
coming out of the six-way class it sends

178
00:06:09,919 --> 00:06:11,120
but

179
00:06:11,120 --> 00:06:12,479
well the information is going to be the

180
00:06:12,479 --> 00:06:14,400
same so it doesn't make sense to have a

181
00:06:14,400 --> 00:06:16,000
complete separate

182
00:06:16,000 --> 00:06:18,160
set of slides so those are the critical

183
00:06:18,160 --> 00:06:19,680
factors because when i had the

184
00:06:19,680 --> 00:06:22,000
opportunity to build my own team i could

185
00:06:22,000 --> 00:06:23,840
take whatever i learned before that and

186
00:06:23,840 --> 00:06:26,400
try to avoid the mistakes but that also

187
00:06:26,400 --> 00:06:30,240
means that you kind of need to formalize

188
00:06:30,240 --> 00:06:32,400
what you learned in a way to make that

189
00:06:32,400 --> 00:06:34,960
like a communicatable to someone else

190
00:06:34,960 --> 00:06:37,039
and those are the key points visibility

191
00:06:37,039 --> 00:06:38,960
we're gonna go into detail pretty soon

192
00:06:38,960 --> 00:06:40,240
efficiency

193
00:06:40,240 --> 00:06:42,240
technical skills of course

194
00:06:42,240 --> 00:06:44,800
documentation and also soft skills

195
00:06:44,800 --> 00:06:47,440
and the last part

196
00:06:47,440 --> 00:06:50,960
or all of these parts in in combination

197
00:06:50,960 --> 00:06:53,120
are very hard to find and usually it's

198
00:06:53,120 --> 00:06:54,560
either on a technical side or in the

199
00:06:54,560 --> 00:06:56,319
soft skill side but finding the

200
00:06:56,319 --> 00:06:58,080
resources that can do both very well

201
00:06:58,080 --> 00:07:00,240
that's a different uh

202
00:07:00,240 --> 00:07:02,000
story that's that's really difficult and

203
00:07:02,000 --> 00:07:03,599
it's giving us a hard time and probably

204
00:07:03,599 --> 00:07:06,080
many of you have the same problem

205
00:07:06,080 --> 00:07:08,240
so talking about visibility um that's a

206
00:07:08,240 --> 00:07:10,560
question i usually ask um also tool

207
00:07:10,560 --> 00:07:12,960
vendors very often uh i got like four

208
00:07:12,960 --> 00:07:15,280
questions here um if you're not a

209
00:07:15,280 --> 00:07:16,960
technical person never mind i'm going to

210
00:07:16,960 --> 00:07:18,400
explain a little bit what i'm asking for

211
00:07:18,400 --> 00:07:20,479
here and why i'm asking that but with

212
00:07:20,479 --> 00:07:21,919
the tool set that you

213
00:07:21,919 --> 00:07:24,080
use i think i put a size down here

214
00:07:24,080 --> 00:07:26,240
somewhere 8 000 hosts for example so

215
00:07:26,240 --> 00:07:28,479
you're faced with an intrusion 8 000

216
00:07:28,479 --> 00:07:30,400
hosts we're not talking ransomware here

217
00:07:30,400 --> 00:07:31,840
right so we're probably talking about

218
00:07:31,840 --> 00:07:34,000
someone who's interested in in your ip

219
00:07:34,000 --> 00:07:36,800
or something access broker whatever

220
00:07:36,800 --> 00:07:38,960
and the first question is which machines

221
00:07:38,960 --> 00:07:40,880
have executables on their users videos

222
00:07:40,880 --> 00:07:42,160
directory

223
00:07:42,160 --> 00:07:44,000
at the same time get their timestamps

224
00:07:44,000 --> 00:07:46,720
and checksums for these executables

225
00:07:46,720 --> 00:07:47,440
so

226
00:07:47,440 --> 00:07:48,879
could you do it how long would it take

227
00:07:48,879 --> 00:07:50,319
you

228
00:07:50,319 --> 00:07:52,160
so what do you think is an acceptable

229
00:07:52,160 --> 00:07:54,400
timing for for that information 8000

230
00:07:54,400 --> 00:07:56,319
hosts

231
00:07:56,319 --> 00:07:59,319
um

232
00:08:01,199 --> 00:08:03,120
yeah maximum for for the ones that are

233
00:08:03,120 --> 00:08:04,720
online obviously right

234
00:08:04,720 --> 00:08:05,919
i mean if you have to wait in

235
00:08:05,919 --> 00:08:07,919
international cases you oftentimes have

236
00:08:07,919 --> 00:08:09,280
to wait especially for clients to go

237
00:08:09,280 --> 00:08:10,560
online and stuff

238
00:08:10,560 --> 00:08:12,080
but that's that's about it minutes we're

239
00:08:12,080 --> 00:08:14,240
talking minutes here so whatever tooling

240
00:08:14,240 --> 00:08:15,840
you use in in a nutshell if you have the

241
00:08:15,840 --> 00:08:18,240
right visibility is just an extension of

242
00:08:18,240 --> 00:08:20,639
your brain right you ask questions and

243
00:08:20,639 --> 00:08:22,560
you get the answer you just phrase them

244
00:08:22,560 --> 00:08:24,400
right uh give i mean all the creation

245
00:08:24,400 --> 00:08:26,240
time stems of the profile folder of a

246
00:08:26,240 --> 00:08:28,879
specific user from all machines

247
00:08:28,879 --> 00:08:31,039
same thing pretty much right

248
00:08:31,039 --> 00:08:32,479
i think those two things that i just

249
00:08:32,479 --> 00:08:33,919
mentioned especially the second one you

250
00:08:33,919 --> 00:08:36,000
can do with pretty much any edr the

251
00:08:36,000 --> 00:08:37,599
first one i'm not totally sure about

252
00:08:37,599 --> 00:08:39,360
because you need like a wild card

253
00:08:39,360 --> 00:08:40,320
somewhere in the middle with the

254
00:08:40,320 --> 00:08:42,159
username that makes it a little bit more

255
00:08:42,159 --> 00:08:43,519
difficult

256
00:08:43,519 --> 00:08:45,519
the third one

257
00:08:45,519 --> 00:08:47,680
is a even more complex one find all

258
00:08:47,680 --> 00:08:49,120
machines that match a certain yara rule

259
00:08:49,120 --> 00:08:51,040
in their memory

260
00:08:51,040 --> 00:08:52,560
so that is what

261
00:08:52,560 --> 00:08:54,959
what would uh make me ask a question

262
00:08:54,959 --> 00:08:56,640
when we're talking about memory are we

263
00:08:56,640 --> 00:08:58,480
talking about the memory as a whole or

264
00:08:58,480 --> 00:08:59,920
are we talking about the process memory

265
00:08:59,920 --> 00:09:01,600
that's the difference right

266
00:09:01,600 --> 00:09:03,920
so in other terms if malware is in there

267
00:09:03,920 --> 00:09:06,240
and um there's some residue somewhere in

268
00:09:06,240 --> 00:09:07,440
the memory but it's not addressed

269
00:09:07,440 --> 00:09:09,519
anymore well then i will not find it if

270
00:09:09,519 --> 00:09:11,760
i just go for a process memory now the

271
00:09:11,760 --> 00:09:13,760
problem is many of the tools that are

272
00:09:13,760 --> 00:09:15,279
used out there which is going for the

273
00:09:15,279 --> 00:09:17,440
process memory right

274
00:09:17,440 --> 00:09:18,240
and

275
00:09:18,240 --> 00:09:20,720
especially the most user-friendly tools

276
00:09:20,720 --> 00:09:22,399
most user-friendly edrs out there don't

277
00:09:22,399 --> 00:09:24,320
give you that opportunity at all

278
00:09:24,320 --> 00:09:26,320
to look into the

279
00:09:26,320 --> 00:09:27,760
memory that's not attached to a certain

280
00:09:27,760 --> 00:09:28,720
process

281
00:09:28,720 --> 00:09:30,640
recover the rdb bitmap cache from a

282
00:09:30,640 --> 00:09:32,800
specific user on all servers where the

283
00:09:32,800 --> 00:09:35,519
user logged in after a certain date

284
00:09:35,519 --> 00:09:36,560
so you see

285
00:09:36,560 --> 00:09:39,200
um i keep combining more and more

286
00:09:39,200 --> 00:09:41,360
things more and more factors into what i

287
00:09:41,360 --> 00:09:42,800
want to have so first of all what is the

288
00:09:42,800 --> 00:09:45,200
rdp bitmap cache just for non lots of

289
00:09:45,200 --> 00:09:47,120
technical people there rdp that's a

290
00:09:47,120 --> 00:09:48,880
remote desktop protocol

291
00:09:48,880 --> 00:09:50,160
i guess most of you have used that

292
00:09:50,160 --> 00:09:51,839
before and you probably realized when

293
00:09:51,839 --> 00:09:53,920
the internet connection is pretty slow

294
00:09:53,920 --> 00:09:55,760
and you move your mouse right around the

295
00:09:55,760 --> 00:09:57,360
mouse you see that the resolution of the

296
00:09:57,360 --> 00:09:59,600
screen is different than on the rest of

297
00:09:59,600 --> 00:10:02,480
the screen and that's because

298
00:10:02,480 --> 00:10:04,880
this is the way how rdp updates your

299
00:10:04,880 --> 00:10:08,160
image it updates uh in small squares and

300
00:10:08,160 --> 00:10:09,760
it stores those squares in the rdp

301
00:10:09,760 --> 00:10:12,079
bitmap cache so that means that it get

302
00:10:12,079 --> 00:10:14,880
like small parts of the screen of an rdp

303
00:10:14,880 --> 00:10:16,320
session from these

304
00:10:16,320 --> 00:10:18,320
now when we notice a certain user

305
00:10:18,320 --> 00:10:20,160
account was used

306
00:10:20,160 --> 00:10:21,680
to

307
00:10:21,680 --> 00:10:24,720
to log in or move laterally using rdp

308
00:10:24,720 --> 00:10:27,519
we can get pieces out of that session

309
00:10:27,519 --> 00:10:29,279
but i don't want to do that manually so

310
00:10:29,279 --> 00:10:31,680
i need a way to to make that collection

311
00:10:31,680 --> 00:10:33,920
automatic and get that on a number of

312
00:10:33,920 --> 00:10:36,079
machines and also when i have a first

313
00:10:36,079 --> 00:10:37,680
date where i believe that that user was

314
00:10:37,680 --> 00:10:40,720
used in a malicious way that is another

315
00:10:40,720 --> 00:10:42,480
factor that i put in so i don't want to

316
00:10:42,480 --> 00:10:44,880
have the information from the legitimate

317
00:10:44,880 --> 00:10:47,680
user so visibility is important and i

318
00:10:47,680 --> 00:10:50,640
think um i usually try to to visualize

319
00:10:50,640 --> 00:10:52,959
that using geography in a certain way

320
00:10:52,959 --> 00:10:55,519
like uh length for example here

321
00:10:55,519 --> 00:10:57,360
um this is from a real case hundred and

322
00:10:57,360 --> 00:10:59,600
seventy thousand hosts that we did and

323
00:10:59,600 --> 00:11:01,680
out of those 105 turned out to be

324
00:11:01,680 --> 00:11:03,360
accessed by the attacker some with

325
00:11:03,360 --> 00:11:05,760
malware some are just accessed with

326
00:11:05,760 --> 00:11:08,320
living off the land tools and so on

327
00:11:08,320 --> 00:11:10,959
if we put that on on a 100 meter race

328
00:11:10,959 --> 00:11:13,680
track like olympic racetrack the whole

329
00:11:13,680 --> 00:11:16,079
machines only six centimeters of that

330
00:11:16,079 --> 00:11:19,440
would have been um infected by the user

331
00:11:19,440 --> 00:11:21,440
which well doesn't sound like a lot

332
00:11:21,440 --> 00:11:23,120
especially because those six centimeters

333
00:11:23,120 --> 00:11:24,399
are not together right they're spread a

334
00:11:24,399 --> 00:11:26,640
whole around the whole population

335
00:11:26,640 --> 00:11:28,560
that means you need to look very closely

336
00:11:28,560 --> 00:11:31,120
at everything because if you miss one

337
00:11:31,120 --> 00:11:32,640
thing they're going to be back so we're

338
00:11:32,640 --> 00:11:34,079
talking there about nation states there

339
00:11:34,079 --> 00:11:35,760
was a very funny case

340
00:11:35,760 --> 00:11:37,120
because they had three groups three

341
00:11:37,120 --> 00:11:38,560
different groups in there and they were

342
00:11:38,560 --> 00:11:40,160
battling each other

343
00:11:40,160 --> 00:11:42,480
do you get that information first

344
00:11:42,480 --> 00:11:44,640
and um they never got rid of the

345
00:11:44,640 --> 00:11:46,640
attacker by the way um they still have

346
00:11:46,640 --> 00:11:47,760
them in there

347
00:11:47,760 --> 00:11:50,240
because um it was impossible to

348
00:11:50,240 --> 00:11:52,480
completely remediate at least of all of

349
00:11:52,480 --> 00:11:54,320
these i think they later got rid of one

350
00:11:54,320 --> 00:11:56,000
of the attacker but not because of what

351
00:11:56,000 --> 00:11:57,920
they did but because of what another

352
00:11:57,920 --> 00:11:59,680
attacker group did so that was very

353
00:11:59,680 --> 00:12:01,120
funny

354
00:12:01,120 --> 00:12:02,320
we see that more and more by the way

355
00:12:02,320 --> 00:12:04,880
that attackers start to fix uh the

356
00:12:04,880 --> 00:12:06,399
initial holes how they got in right so

357
00:12:06,399 --> 00:12:08,160
they start patching your machines

358
00:12:08,160 --> 00:12:09,600
so if you don't do it never mind the

359
00:12:09,600 --> 00:12:11,600
attackers will do that for you

360
00:12:11,600 --> 00:12:13,040
question is if the price is right for

361
00:12:13,040 --> 00:12:15,360
that but that's another story if you

362
00:12:15,360 --> 00:12:17,680
look at the tool stack for for for that

363
00:12:17,680 --> 00:12:20,000
um what we're usually faced with is you

364
00:12:20,000 --> 00:12:22,320
have some sort of always on kind of

365
00:12:22,320 --> 00:12:24,560
thing so that means all data gets stored

366
00:12:24,560 --> 00:12:26,560
in in some sort of central repository

367
00:12:26,560 --> 00:12:28,320
like a sim or so

368
00:12:28,320 --> 00:12:30,240
uh you can collect it using sysmon

369
00:12:30,240 --> 00:12:31,920
whatever you get net flows from from

370
00:12:31,920 --> 00:12:34,000
network devices or whatever and you have

371
00:12:34,000 --> 00:12:36,720
the on-demand part so edrs are usually

372
00:12:36,720 --> 00:12:38,240
today

373
00:12:38,240 --> 00:12:40,320
depending on the exact product

374
00:12:40,320 --> 00:12:42,480
um a mix of those two right so they

375
00:12:42,480 --> 00:12:44,480
store some data locally but you can also

376
00:12:44,480 --> 00:12:46,959
actively demand data from the clients or

377
00:12:46,959 --> 00:12:48,720
servers if you want to

378
00:12:48,720 --> 00:12:50,320
so there is somewhere in the middle uh

379
00:12:50,320 --> 00:12:52,160
you can have enriched alerts with that

380
00:12:52,160 --> 00:12:54,880
uh you can collect pcaps so

381
00:12:54,880 --> 00:12:57,440
pcaps could be always on but that's very

382
00:12:57,440 --> 00:12:59,200
rarely the case right especially when

383
00:12:59,200 --> 00:13:01,120
it's about broad internet connections or

384
00:13:01,120 --> 00:13:02,639
connections at all

385
00:13:02,639 --> 00:13:04,560
you you have only very few organizations

386
00:13:04,560 --> 00:13:06,639
that really record pcaps

387
00:13:06,639 --> 00:13:08,000
in a broad sense

388
00:13:08,000 --> 00:13:09,839
unless you demand them to do that in a

389
00:13:09,839 --> 00:13:12,639
certain extent and forensic agents so

390
00:13:12,639 --> 00:13:14,639
what can you do um if you're internal

391
00:13:14,639 --> 00:13:16,399
for example to to get that whole thing

392
00:13:16,399 --> 00:13:18,320
better so first of all uh let's talk

393
00:13:18,320 --> 00:13:20,480
about threat hunting so threat hunting

394
00:13:20,480 --> 00:13:22,560
in a sense is like leaving incident

395
00:13:22,560 --> 00:13:24,560
response so the only difference in

396
00:13:24,560 --> 00:13:26,320
threat hunting is you don't know if the

397
00:13:26,320 --> 00:13:28,399
attacker is really in but well what do

398
00:13:28,399 --> 00:13:30,000
you know in a real attack right very

399
00:13:30,000 --> 00:13:31,519
often you find more attacker groups that

400
00:13:31,519 --> 00:13:33,760
you were aware of in the beginning so

401
00:13:33,760 --> 00:13:35,600
that's not different so you use the same

402
00:13:35,600 --> 00:13:37,519
techniques you use the same tools the

403
00:13:37,519 --> 00:13:39,839
highest form of

404
00:13:39,839 --> 00:13:41,279
threat hunting is hypothesis based

405
00:13:41,279 --> 00:13:43,600
hunting you set up a hypothesis so for

406
00:13:43,600 --> 00:13:44,720
example

407
00:13:44,720 --> 00:13:47,920
apt i don't know 28 that's could be very

408
00:13:47,920 --> 00:13:49,760
current is in our network so what do

409
00:13:49,760 --> 00:13:52,320
they usually do what tools do they use

410
00:13:52,320 --> 00:13:53,839
how would we identify them with our

411
00:13:53,839 --> 00:13:55,040
toolset

412
00:13:55,040 --> 00:13:57,199
and what i depict here is not correct

413
00:13:57,199 --> 00:13:59,120
right i say you have that hypothesis and

414
00:13:59,120 --> 00:14:00,880
you could either accept it or you could

415
00:14:00,880 --> 00:14:02,880
reject it but actually there's a third

416
00:14:02,880 --> 00:14:05,360
outcome and that is the well sometimes

417
00:14:05,360 --> 00:14:07,120
even more valuable one and that's the

418
00:14:07,120 --> 00:14:09,279
visibility is missing well this is the

419
00:14:09,279 --> 00:14:11,760
hypothesis this is how i would check but

420
00:14:11,760 --> 00:14:14,000
i can't with our toolset

421
00:14:14,000 --> 00:14:15,440
and it also tells you something right

422
00:14:15,440 --> 00:14:17,279
because usually when a threat hunters in

423
00:14:17,279 --> 00:14:19,360
an organization cannot uh really hunt

424
00:14:19,360 --> 00:14:21,199
for a certain threat you suck can't

425
00:14:21,199 --> 00:14:23,760
detect it either and that is not a good

426
00:14:23,760 --> 00:14:25,519
place to be right

427
00:14:25,519 --> 00:14:27,279
and that brings me to efficiency i have

428
00:14:27,279 --> 00:14:29,680
to to run through that a little bit

429
00:14:29,680 --> 00:14:31,839
obviously you can't get full disk images

430
00:14:31,839 --> 00:14:33,120
for all machines when we're talking

431
00:14:33,120 --> 00:14:35,440
about a couple thousand machines

432
00:14:35,440 --> 00:14:36,480
i'm not saying that there are not

433
00:14:36,480 --> 00:14:38,399
organizations out there who try

434
00:14:38,399 --> 00:14:41,440
but they usually fail i remember a case

435
00:14:41,440 --> 00:14:42,800
for

436
00:14:42,800 --> 00:14:44,720
a medium-sized company last year

437
00:14:44,720 --> 00:14:46,320
beginning of last year they have around

438
00:14:46,320 --> 00:14:48,160
30 000 endpoints

439
00:14:48,160 --> 00:14:50,800
and um we were again the second ones

440
00:14:50,800 --> 00:14:52,160
they called in so the whole thing

441
00:14:52,160 --> 00:14:53,920
started on wednesday they got another

442
00:14:53,920 --> 00:14:55,920
company in and

443
00:14:55,920 --> 00:14:57,680
till friday they didn't do anything

444
00:14:57,680 --> 00:14:59,120
because what they requested from the

445
00:14:59,120 --> 00:15:01,680
client was to set up a very beefy server

446
00:15:01,680 --> 00:15:03,279
right a lot of ram a lot of storage and

447
00:15:03,279 --> 00:15:05,519
so on and they wanted to have the images

448
00:15:05,519 --> 00:15:07,120
of the patients here of the suspected

449
00:15:07,120 --> 00:15:09,120
patients here delivered to that machine

450
00:15:09,120 --> 00:15:10,240
and you know how it is in big

451
00:15:10,240 --> 00:15:11,839
organizations you have like tons of

452
00:15:11,839 --> 00:15:13,760
outsourcing providers it's just

453
00:15:13,760 --> 00:15:15,279
something that does not work easily

454
00:15:15,279 --> 00:15:16,959
right to get that data from a to b

455
00:15:16,959 --> 00:15:18,240
quickly

456
00:15:18,240 --> 00:15:20,399
uh so they never established um

457
00:15:20,399 --> 00:15:22,399
visibility there and that's what we did

458
00:15:22,399 --> 00:15:23,920
in the end

459
00:15:23,920 --> 00:15:24,959
when they would have looked at the

460
00:15:24,959 --> 00:15:26,880
machine like maybe on saturday sunday

461
00:15:26,880 --> 00:15:28,240
whatever when they would have gotten it

462
00:15:28,240 --> 00:15:29,600
they would have realized that they would

463
00:15:29,600 --> 00:15:31,680
need to look at another 15 machines so

464
00:15:31,680 --> 00:15:33,600
would they then request 15 other images

465
00:15:33,600 --> 00:15:36,079
so what is their approach to that

466
00:15:36,079 --> 00:15:38,000
so it's it's just not going to work so

467
00:15:38,000 --> 00:15:40,160
that could have hurt that organization

468
00:15:40,160 --> 00:15:42,800
very much but in the end every resource

469
00:15:42,800 --> 00:15:45,360
that you want to spend and resources can

470
00:15:45,360 --> 00:15:46,959
be a lot right like storage but also

471
00:15:46,959 --> 00:15:49,279
human resources needs to be justified by

472
00:15:49,279 --> 00:15:50,560
a question that you need to answer with

473
00:15:50,560 --> 00:15:53,680
that i mean that's in in business that's

474
00:15:53,680 --> 00:15:55,519
i think a very logical thing right

475
00:15:55,519 --> 00:15:57,279
whatever you invest you expect some

476
00:15:57,279 --> 00:15:59,519
return on that investment and why not

477
00:15:59,519 --> 00:16:01,519
work the same here

478
00:16:01,519 --> 00:16:03,199
so what we're using in the different

479
00:16:03,199 --> 00:16:06,560
sense classes are actually those um

480
00:16:06,560 --> 00:16:09,680
uh those cones there so um basically

481
00:16:09,680 --> 00:16:11,519
that funnel starts on top right so at

482
00:16:11,519 --> 00:16:12,800
the beginning you look at a ton of

483
00:16:12,800 --> 00:16:15,920
machines uh which basically allows you

484
00:16:15,920 --> 00:16:18,480
to use a set of techniques

485
00:16:18,480 --> 00:16:20,079
then if you go down that funnel you

486
00:16:20,079 --> 00:16:21,360
select out certain machines where you

487
00:16:21,360 --> 00:16:23,759
use other techniques if you basically

488
00:16:23,759 --> 00:16:25,920
translate that to a sort of resource

489
00:16:25,920 --> 00:16:27,920
pools that's what we do

490
00:16:27,920 --> 00:16:29,440
you basically have the same amount of

491
00:16:29,440 --> 00:16:31,519
resources so that means you can look at

492
00:16:31,519 --> 00:16:34,240
very small data sets from many machines

493
00:16:34,240 --> 00:16:37,040
or you look at bigger or complex things

494
00:16:37,040 --> 00:16:38,800
for a few machines right

495
00:16:38,800 --> 00:16:40,959
and the funny thing is most cases begin

496
00:16:40,959 --> 00:16:42,320
somewhere in the middle

497
00:16:42,320 --> 00:16:44,000
right some machine is acting up it's

498
00:16:44,000 --> 00:16:46,320
still the case that very often in

499
00:16:46,320 --> 00:16:48,880
non-ransomware cases

500
00:16:48,880 --> 00:16:50,480
capacity management

501
00:16:50,480 --> 00:16:52,480
is one of the first things that tell the

502
00:16:52,480 --> 00:16:54,320
organization that they have a breach so

503
00:16:54,320 --> 00:16:56,480
it's not the av it's not their edr it's

504
00:16:56,480 --> 00:16:58,320
actually capacity management right so

505
00:16:58,320 --> 00:16:59,600
drive is running full because they're

506
00:16:59,600 --> 00:17:02,160
pulling together to gather some data

507
00:17:02,160 --> 00:17:04,400
maybe a process is going high because

508
00:17:04,400 --> 00:17:05,760
the attackers don't know how to use the

509
00:17:05,760 --> 00:17:07,919
tool properly so we had all of these

510
00:17:07,919 --> 00:17:10,079
right so for example one case they use

511
00:17:10,079 --> 00:17:12,480
the tool uh that's called recharge and

512
00:17:12,480 --> 00:17:14,799
that's basically um a proxy into the

513
00:17:14,799 --> 00:17:17,280
network uh where the the server side of

514
00:17:17,280 --> 00:17:20,000
the proxy can be whatever web

515
00:17:20,000 --> 00:17:21,520
web file that is so that could be an

516
00:17:21,520 --> 00:17:23,439
aspx that could be

517
00:17:23,439 --> 00:17:24,160
uh

518
00:17:24,160 --> 00:17:26,559
whatever could be uh any kind of java

519
00:17:26,559 --> 00:17:27,359
file

520
00:17:27,359 --> 00:17:29,360
and so on could be php and you just

521
00:17:29,360 --> 00:17:31,280
tunnel into the network but the thing is

522
00:17:31,280 --> 00:17:32,720
if you do that in apache and you keep

523
00:17:32,720 --> 00:17:34,720
that session open for too long it will

524
00:17:34,720 --> 00:17:37,520
uh it will peak out the cpu

525
00:17:37,520 --> 00:17:39,039
so if you use that before as a pen

526
00:17:39,039 --> 00:17:40,720
tester and

527
00:17:40,720 --> 00:17:42,799
were called in that situation you know

528
00:17:42,799 --> 00:17:45,039
that but if you just use the tool it

529
00:17:45,039 --> 00:17:46,640
works the same right even if the cpu

530
00:17:46,640 --> 00:17:48,640
peaks it works the same but if someone

531
00:17:48,640 --> 00:17:50,160
monitors that server they will realize

532
00:17:50,160 --> 00:17:51,679
that something is going on and if they

533
00:17:51,679 --> 00:17:54,160
are careful they will find that

534
00:17:54,160 --> 00:17:55,919
so that's what i'm saying so for example

535
00:17:55,919 --> 00:17:57,840
small data sets what could you do with

536
00:17:57,840 --> 00:17:59,520
that data stacking is one of the

537
00:17:59,520 --> 00:18:01,679
operations that we tend to use a lot so

538
00:18:01,679 --> 00:18:03,840
for example you can stack things like

539
00:18:03,840 --> 00:18:05,919
persistence because malware

540
00:18:05,919 --> 00:18:08,000
does not only need to run it also needs

541
00:18:08,000 --> 00:18:09,440
to keep running to a certain extent

542
00:18:09,440 --> 00:18:11,360
after reboot so what you can do is you

543
00:18:11,360 --> 00:18:13,440
can get all the different locations how

544
00:18:13,440 --> 00:18:15,600
malware could persist itself and then

545
00:18:15,600 --> 00:18:17,760
from there on stack that data because

546
00:18:17,760 --> 00:18:19,919
obviously a windows system looks pretty

547
00:18:19,919 --> 00:18:21,600
much like any other windows system to an

548
00:18:21,600 --> 00:18:24,320
extent so that means

549
00:18:24,320 --> 00:18:26,080
everything that's very unique will

550
00:18:26,080 --> 00:18:28,799
bubble up if you just count the

551
00:18:28,799 --> 00:18:31,440
occurrence count in the whole network so

552
00:18:31,440 --> 00:18:32,799
in other terms if you have like c

553
00:18:32,799 --> 00:18:35,600
mapper.exe it's probably not on on all

554
00:18:35,600 --> 00:18:38,080
8000 machines that we just discussed

555
00:18:38,080 --> 00:18:40,000
it's maybe just on 10.

556
00:18:40,000 --> 00:18:41,280
so that means if you sort by the

557
00:18:41,280 --> 00:18:42,720
occurrence throughout the whole network

558
00:18:42,720 --> 00:18:45,039
you will find it pretty easily um

559
00:18:45,039 --> 00:18:46,880
technical skills

560
00:18:46,880 --> 00:18:48,080
um it's i guess it's pretty

561
00:18:48,080 --> 00:18:49,679
straightforward that we're talking about

562
00:18:49,679 --> 00:18:52,080
some sort of technical work here as well

563
00:18:52,080 --> 00:18:54,400
so um the attacker the investigators

564
00:18:54,400 --> 00:18:56,720
really need to understand their tools

565
00:18:56,720 --> 00:18:58,320
and to be honest that's one of the

566
00:18:58,320 --> 00:19:00,320
things where i see most failures happen

567
00:19:00,320 --> 00:19:01,600
because

568
00:19:01,600 --> 00:19:03,760
people just overestimate their tools

569
00:19:03,760 --> 00:19:05,919
one of the most common things is that

570
00:19:05,919 --> 00:19:08,000
they use iocs for example let's take

571
00:19:08,000 --> 00:19:10,880
open ioc as a format open ioc allows you

572
00:19:10,880 --> 00:19:13,120
a ton of different parameters to specify

573
00:19:13,120 --> 00:19:14,000
right

574
00:19:14,000 --> 00:19:15,440
but that doesn't mean that every tool

575
00:19:15,440 --> 00:19:17,679
supports these so what they do is they

576
00:19:17,679 --> 00:19:19,840
shoot certain iocs at a tool

577
00:19:19,840 --> 00:19:22,240
and if that comes back negative they

578
00:19:22,240 --> 00:19:24,480
mean everything is clear but maybe the

579
00:19:24,480 --> 00:19:26,080
tool just didn't check every part of

580
00:19:26,080 --> 00:19:27,760
that ioc because it was not capable of

581
00:19:27,760 --> 00:19:29,600
doing that i just give you an example

582
00:19:29,600 --> 00:19:31,600
for example let's say you have an edr

583
00:19:31,600 --> 00:19:33,039
that for some reason that's a very made

584
00:19:33,039 --> 00:19:35,039
up example but that for some reason only

585
00:19:35,039 --> 00:19:37,360
allows you to create md5 checksums for

586
00:19:37,360 --> 00:19:40,320
files now your ioc includes a sha-1 hash

587
00:19:40,320 --> 00:19:42,799
for the file but not an md5 so you shoot

588
00:19:42,799 --> 00:19:44,480
it at the network it comes back negative

589
00:19:44,480 --> 00:19:47,039
because every file produces an empty

590
00:19:47,039 --> 00:19:48,960
hash because it can't do that and you

591
00:19:48,960 --> 00:19:50,720
think it's clean and that is very

592
00:19:50,720 --> 00:19:52,559
dangerous because the most dangerous

593
00:19:52,559 --> 00:19:54,320
thing for us is incident responders is

594
00:19:54,320 --> 00:19:56,799
false negatives right false positives

595
00:19:56,799 --> 00:19:59,200
are annoying i'll give you that right

596
00:19:59,200 --> 00:20:01,120
but false negatives that's what's going

597
00:20:01,120 --> 00:20:03,360
to break our necks right so if we think

598
00:20:03,360 --> 00:20:05,120
it's clean and it's not

599
00:20:05,120 --> 00:20:06,799
uh ttp's of the attacker they should

600
00:20:06,799 --> 00:20:08,880
know how attackers usually work so in

601
00:20:08,880 --> 00:20:10,480
other terms and that's something where i

602
00:20:10,480 --> 00:20:12,640
see some shortcomings with analysts who

603
00:20:12,640 --> 00:20:15,200
have never done pen testing um

604
00:20:15,200 --> 00:20:17,919
for example you end up on a machine

605
00:20:17,919 --> 00:20:19,919
like with one sort of your backdoor

606
00:20:19,919 --> 00:20:21,280
let's go back for conte they have the

607
00:20:21,280 --> 00:20:23,440
bazaar loader there let's assume you're

608
00:20:23,440 --> 00:20:25,520
on that machine and you have a normal

609
00:20:25,520 --> 00:20:27,919
local user so what are the steps that

610
00:20:27,919 --> 00:20:29,919
you could do to get a higher privileged

611
00:20:29,919 --> 00:20:30,960
accounts

612
00:20:30,960 --> 00:20:33,200
or higher privileged accounts if you end

613
00:20:33,200 --> 00:20:34,960
up as a local administrator what are the

614
00:20:34,960 --> 00:20:36,640
possible steps then

615
00:20:36,640 --> 00:20:38,720
and so on so if you have a normal user

616
00:20:38,720 --> 00:20:39,919
what you could do for example would be

617
00:20:39,919 --> 00:20:41,840
cover roasting right that

618
00:20:41,840 --> 00:20:43,120
works with a normal user if you have

619
00:20:43,120 --> 00:20:44,320
local admin you could think about

620
00:20:44,320 --> 00:20:46,240
something like lsa dump mimikats

621
00:20:46,240 --> 00:20:47,600
whatever

622
00:20:47,600 --> 00:20:49,600
and and that is something that you have

623
00:20:49,600 --> 00:20:51,280
to understand from the attacker's side

624
00:20:51,280 --> 00:20:53,200
because their options are limited based

625
00:20:53,200 --> 00:20:54,720
on what they have what privileges they

626
00:20:54,720 --> 00:20:56,480
have at this point in time

627
00:20:56,480 --> 00:20:58,000
artifacts all the different artifacts so

628
00:20:58,000 --> 00:21:00,000
how can you prove a certain point so

629
00:21:00,000 --> 00:21:01,760
what i always tell my people is the

630
00:21:01,760 --> 00:21:03,919
theory comes first and then there comes

631
00:21:03,919 --> 00:21:06,159
the way to prove it because

632
00:21:06,159 --> 00:21:08,480
uh other than that you have the risk of

633
00:21:08,480 --> 00:21:10,640
using the so-called golden hammer method

634
00:21:10,640 --> 00:21:11,840
so if

635
00:21:11,840 --> 00:21:13,440
the only tool you have is a hammer every

636
00:21:13,440 --> 00:21:15,120
problem looks like a nail even though it

637
00:21:15,120 --> 00:21:17,600
isn't and that is super dangerous in in

638
00:21:17,600 --> 00:21:19,440
that regard

639
00:21:19,440 --> 00:21:21,360
um enterprise architectures they need to

640
00:21:21,360 --> 00:21:23,360
understand how normal enterprise

641
00:21:23,360 --> 00:21:25,360
architectures work in their setup

642
00:21:25,360 --> 00:21:27,360
and then the most difficult thing

643
00:21:27,360 --> 00:21:29,760
sometimes is blueprint so that's the

644
00:21:29,760 --> 00:21:32,480
ideal company enterprise normal which is

645
00:21:32,480 --> 00:21:35,200
usually a little bit more messed up than

646
00:21:35,200 --> 00:21:37,679
unusual it's not necessarily bad and

647
00:21:37,679 --> 00:21:39,840
then really malicious so there it's it's

648
00:21:39,840 --> 00:21:42,799
not like a um a clear differentiation

649
00:21:42,799 --> 00:21:44,880
between those it's it's more like fluent

650
00:21:44,880 --> 00:21:47,120
uh in between those stages

651
00:21:47,120 --> 00:21:49,280
documentations and the questions that i

652
00:21:49,280 --> 00:21:50,960
asked there is when people say the

653
00:21:50,960 --> 00:21:53,520
document very well is did you ever write

654
00:21:53,520 --> 00:21:55,360
a report for a case that you didn't lead

655
00:21:55,360 --> 00:21:56,559
that someone else left and you were not

656
00:21:56,559 --> 00:21:58,640
on the case and you had to rely on their

657
00:21:58,640 --> 00:22:02,000
documentation did you ever do that

658
00:22:02,000 --> 00:22:04,240
if if not you're doing well because that

659
00:22:04,240 --> 00:22:06,000
means you you manage resources wisely

660
00:22:06,000 --> 00:22:07,440
unfortunately i had to do that very

661
00:22:07,440 --> 00:22:09,440
often and to be honest it sucked every

662
00:22:09,440 --> 00:22:11,200
single time

663
00:22:11,200 --> 00:22:13,360
before we went up um and and came along

664
00:22:13,360 --> 00:22:15,360
with some sort of standard uh

665
00:22:15,360 --> 00:22:16,880
documentation is not just important for

666
00:22:16,880 --> 00:22:18,159
writing the report that's one thing

667
00:22:18,159 --> 00:22:19,919
right but you also have to manage the

668
00:22:19,919 --> 00:22:21,600
stakeholders i mean if you're in there

669
00:22:21,600 --> 00:22:23,440
like an external entity and you already

670
00:22:23,440 --> 00:22:25,679
charge them like 200 300 hours but you

671
00:22:25,679 --> 00:22:28,000
need 100 more i need good grounds to

672
00:22:28,000 --> 00:22:30,240
discuss that with the client right so

673
00:22:30,240 --> 00:22:32,400
that is also one thing that is important

674
00:22:32,400 --> 00:22:34,400
the police might ask me something then

675
00:22:34,400 --> 00:22:36,000
it's important for resource planning i

676
00:22:36,000 --> 00:22:37,520
don't want to have too many people on

677
00:22:37,520 --> 00:22:40,080
the bench i mean having the worst thing

678
00:22:40,080 --> 00:22:41,760
as an external entity is when you have

679
00:22:41,760 --> 00:22:43,200
people on the bench and at the same time

680
00:22:43,200 --> 00:22:45,919
you turn down engagements right so that

681
00:22:45,919 --> 00:22:47,600
shouldn't happen because that's a really

682
00:22:47,600 --> 00:22:48,559
bad

683
00:22:48,559 --> 00:22:50,559
resource management there

684
00:22:50,559 --> 00:22:53,200
intelligence development so for us um

685
00:22:53,200 --> 00:22:55,039
i'll show you that later uh it's

686
00:22:55,039 --> 00:22:56,960
technically possible when we record

687
00:22:56,960 --> 00:22:59,039
something during an incident you put it

688
00:22:59,039 --> 00:23:00,960
into our documentation and we can put it

689
00:23:00,960 --> 00:23:03,360
on the on a feed pretty quickly like

690
00:23:03,360 --> 00:23:06,240
within hours right david about hours or

691
00:23:06,240 --> 00:23:08,320
within the hour depending on how much

692
00:23:08,320 --> 00:23:10,880
coffee you had right

693
00:23:10,880 --> 00:23:11,760
okay

694
00:23:11,760 --> 00:23:14,000
remediation uh i need to have a clear

695
00:23:14,000 --> 00:23:15,440
understanding what i need to clean up

696
00:23:15,440 --> 00:23:16,960
because rebuilding is not always an

697
00:23:16,960 --> 00:23:19,200
option that means i need to clear out as

698
00:23:19,200 --> 00:23:21,520
much as i can but that means also that i

699
00:23:21,520 --> 00:23:22,960
have to come up with a plan because in

700
00:23:22,960 --> 00:23:24,720
remediation also have limited amounts of

701
00:23:24,720 --> 00:23:27,440
resources liability prevention so if

702
00:23:27,440 --> 00:23:29,600
it's coming back to me um

703
00:23:29,600 --> 00:23:30,640
well

704
00:23:30,640 --> 00:23:31,840
you shouldn't be

705
00:23:31,840 --> 00:23:33,360
well someone else shouldn't be able to

706
00:23:33,360 --> 00:23:35,440
really disassemble what i did in a way

707
00:23:35,440 --> 00:23:37,039
that they say they did stupid things

708
00:23:37,039 --> 00:23:38,799
they missed this one they missed that

709
00:23:38,799 --> 00:23:41,120
one i should have recorded everything

710
00:23:41,120 --> 00:23:42,799
also all the things that the client told

711
00:23:42,799 --> 00:23:44,080
you so when a client tells you no i

712
00:23:44,080 --> 00:23:45,679
don't want you to do this uh you're not

713
00:23:45,679 --> 00:23:48,080
supposed to go this to this machine

714
00:23:48,080 --> 00:23:49,919
we're not gonna install your agent there

715
00:23:49,919 --> 00:23:51,360
then that's something i need to record

716
00:23:51,360 --> 00:23:53,760
right because later on that's how

717
00:23:53,760 --> 00:23:55,919
i can prevent liability there

718
00:23:55,919 --> 00:23:58,159
um a general rule of thumb there is if

719
00:23:58,159 --> 00:24:00,159
you don't document it it didn't happen

720
00:24:00,159 --> 00:24:02,320
right so

721
00:24:02,320 --> 00:24:03,679
obviously there's

722
00:24:03,679 --> 00:24:05,360
we also don't manage to get it right

723
00:24:05,360 --> 00:24:07,679
every single time but yeah

724
00:24:07,679 --> 00:24:09,919
soft skills uh so the most important one

725
00:24:09,919 --> 00:24:12,480
is right at the end pizza orders and

726
00:24:12,480 --> 00:24:13,919
coffee machine operating coffee machine

727
00:24:13,919 --> 00:24:15,919
is very important that was difficult

728
00:24:15,919 --> 00:24:18,480
during covet i'll give you that

729
00:24:18,480 --> 00:24:20,400
no but really a stakeholder management

730
00:24:20,400 --> 00:24:21,919
that's very important keeping the client

731
00:24:21,919 --> 00:24:23,600
happy it's it usually doesn't work very

732
00:24:23,600 --> 00:24:25,919
well no matter how good you are if you

733
00:24:25,919 --> 00:24:28,000
just say okay uh we roll out our agents

734
00:24:28,000 --> 00:24:29,840
then you go silent for two weeks and

735
00:24:29,840 --> 00:24:31,679
then you come back they will call you

736
00:24:31,679 --> 00:24:33,039
they will not be happy they want to be

737
00:24:33,039 --> 00:24:34,720
entertained right

738
00:24:34,720 --> 00:24:36,640
for uh to a certain part at least you're

739
00:24:36,640 --> 00:24:38,080
going to lose a resource on that that's

740
00:24:38,080 --> 00:24:39,520
for sure because those people who

741
00:24:39,520 --> 00:24:41,600
entertain the board are usually not able

742
00:24:41,600 --> 00:24:44,320
to work anymore on the case really

743
00:24:44,320 --> 00:24:46,400
but yeah that's just how it works in big

744
00:24:46,400 --> 00:24:48,000
organizations you have to manage the ir

745
00:24:48,000 --> 00:24:49,440
team i mean

746
00:24:49,440 --> 00:24:51,279
it's different for the client usually

747
00:24:51,279 --> 00:24:52,880
it's the first time or maybe second time

748
00:24:52,880 --> 00:24:54,880
they don't do that every day

749
00:24:54,880 --> 00:24:56,400
but it's not that thrilling for your

750
00:24:56,400 --> 00:24:58,640
investigators anymore if it's too

751
00:24:58,640 --> 00:25:00,240
thrilling for investigators you probably

752
00:25:00,240 --> 00:25:01,919
have an unexperienced team

753
00:25:01,919 --> 00:25:04,000
so they don't care if that case is super

754
00:25:04,000 --> 00:25:05,520
thrilling for the organization they want

755
00:25:05,520 --> 00:25:07,440
to go on vacation the next week right so

756
00:25:07,440 --> 00:25:09,120
you have to plan around that they do

757
00:25:09,120 --> 00:25:11,039
that every day so

758
00:25:11,039 --> 00:25:13,200
that is important to understand regular

759
00:25:13,200 --> 00:25:14,559
i.t teams

760
00:25:14,559 --> 00:25:16,080
i mean they could be in a very bad

761
00:25:16,080 --> 00:25:17,840
position depending on your client

762
00:25:17,840 --> 00:25:19,520
sometimes they get pressured because

763
00:25:19,520 --> 00:25:21,840
someone says they've basically put the

764
00:25:21,840 --> 00:25:23,600
organization at risk which most of the

765
00:25:23,600 --> 00:25:24,559
times

766
00:25:24,559 --> 00:25:26,320
is not necessarily true at least not

767
00:25:26,320 --> 00:25:28,159
alone

768
00:25:28,159 --> 00:25:29,600
so you have to take care of these people

769
00:25:29,600 --> 00:25:32,080
as well then they might have socks that

770
00:25:32,080 --> 00:25:34,320
work with you but sometimes they have

771
00:25:34,320 --> 00:25:36,000
them internally sometimes they have an

772
00:25:36,000 --> 00:25:37,760
external outsourcing provider

773
00:25:37,760 --> 00:25:39,120
they are also concerned about their

774
00:25:39,120 --> 00:25:40,799
liability so they probably not give you

775
00:25:40,799 --> 00:25:41,919
everything won't give you everything

776
00:25:41,919 --> 00:25:43,679
that you need and not in a way that you

777
00:25:43,679 --> 00:25:45,039
want to have it so that's also very

778
00:25:45,039 --> 00:25:46,080
difficult

779
00:25:46,080 --> 00:25:48,400
uh the breached entities clients you

780
00:25:48,400 --> 00:25:50,400
would wonder how how often i have to

781
00:25:50,400 --> 00:25:52,400
talk to partners clients and so on of

782
00:25:52,400 --> 00:25:54,480
our breached entities because they don't

783
00:25:54,480 --> 00:25:57,200
trust the entity themselves anymore but

784
00:25:57,200 --> 00:25:58,720
they oftentimes trust us because

785
00:25:58,720 --> 00:26:00,480
sometimes there are our clients already

786
00:26:00,480 --> 00:26:02,240
and they know how we work

787
00:26:02,240 --> 00:26:04,400
it's it's often about like reopening vpn

788
00:26:04,400 --> 00:26:05,760
tunnels and all that stuff to the

789
00:26:05,760 --> 00:26:07,919
breached organization

790
00:26:07,919 --> 00:26:10,240
um so how could you set up a team uh to

791
00:26:10,240 --> 00:26:12,240
make all that work from a

792
00:26:12,240 --> 00:26:14,880
human resource perspective so usually uh

793
00:26:14,880 --> 00:26:17,279
we have one ir lead who leads a case

794
00:26:17,279 --> 00:26:19,679
uh for smaller cases the lead is the

795
00:26:19,679 --> 00:26:21,360
only person you'll get and sometimes

796
00:26:21,360 --> 00:26:23,039
even that only for fifty percent

797
00:26:23,039 --> 00:26:25,200
depending on how how it works out right

798
00:26:25,200 --> 00:26:28,000
uh bigger bigger cases you you might get

799
00:26:28,000 --> 00:26:30,480
uh more analysts but they can pop in and

800
00:26:30,480 --> 00:26:33,279
pop out i don't have like

801
00:26:33,279 --> 00:26:34,960
people assigned a hundred percent to a

802
00:26:34,960 --> 00:26:36,960
case that makes it a little bit more

803
00:26:36,960 --> 00:26:39,120
difficult then we have cross function

804
00:26:39,120 --> 00:26:41,039
like malware reversing they don't care

805
00:26:41,039 --> 00:26:42,240
they need they don't need to be attached

806
00:26:42,240 --> 00:26:43,679
to a single case right they just work on

807
00:26:43,679 --> 00:26:44,799
malware

808
00:26:44,799 --> 00:26:46,480
intel analysts they need to be aware of

809
00:26:46,480 --> 00:26:48,640
any case and give you the information

810
00:26:48,640 --> 00:26:50,640
that they saw something that they also

811
00:26:50,640 --> 00:26:53,279
saw in another case before

812
00:26:53,279 --> 00:26:56,000
roles and duties so you have the ir lead

813
00:26:56,000 --> 00:26:58,640
who basically uh manages the engagement

814
00:26:58,640 --> 00:27:01,520
uh sometimes they also well

815
00:27:01,520 --> 00:27:03,039
do some sort of an analyst role

816
00:27:03,039 --> 00:27:05,360
depending on the case size again i mean

817
00:27:05,360 --> 00:27:06,880
if i have an engagement with 2000

818
00:27:06,880 --> 00:27:08,000
machines

819
00:27:08,000 --> 00:27:10,000
i don't really need a second analyst for

820
00:27:10,000 --> 00:27:12,400
that right that is what one person can

821
00:27:12,400 --> 00:27:14,320
normally do alone depending on what

822
00:27:14,320 --> 00:27:16,720
exactly happened you have analysts there

823
00:27:16,720 --> 00:27:18,960
that work on on that case uh date to the

824
00:27:18,960 --> 00:27:21,039
actual triage they do the hunting and so

825
00:27:21,039 --> 00:27:23,919
on on the shared functions you have the

826
00:27:23,919 --> 00:27:25,600
member analysts so they get married to

827
00:27:25,600 --> 00:27:28,000
analyze they tell you things about for

828
00:27:28,000 --> 00:27:30,000
example callbacks right because if they

829
00:27:30,000 --> 00:27:31,360
find an ip address the host name

830
00:27:31,360 --> 00:27:33,360
whatever you can go back and figure out

831
00:27:33,360 --> 00:27:35,840
um what other machines are connected to

832
00:27:35,840 --> 00:27:37,360
that c2

833
00:27:37,360 --> 00:27:39,440
c2 server

834
00:27:39,440 --> 00:27:40,799
based on firewall locks or whatever you

835
00:27:40,799 --> 00:27:41,760
have

836
00:27:41,760 --> 00:27:44,399
intelligence analysts first of all for

837
00:27:44,399 --> 00:27:47,120
us cater for our for our

838
00:27:47,120 --> 00:27:49,360
feed and secondly they

839
00:27:49,360 --> 00:27:51,120
sort of interconnect

840
00:27:51,120 --> 00:27:53,200
investigations so as soon as you get

841
00:27:53,200 --> 00:27:56,000
bigger it's difficult to have

842
00:27:56,000 --> 00:27:57,919
all analysts watch all the chat channels

843
00:27:57,919 --> 00:27:59,440
for the different engagements and if

844
00:27:59,440 --> 00:28:01,360
that happens we need someone to be in

845
00:28:01,360 --> 00:28:03,520
control and and make the connection if

846
00:28:03,520 --> 00:28:05,520
something is similar into different

847
00:28:05,520 --> 00:28:06,480
cases

848
00:28:06,480 --> 00:28:08,399
external entities that's super important

849
00:28:08,399 --> 00:28:09,679
to manage them

850
00:28:09,679 --> 00:28:11,360
you have so many different entities like

851
00:28:11,360 --> 00:28:13,120
law enforcement for example they can do

852
00:28:13,120 --> 00:28:15,200
things that we can do not necessarily

853
00:28:15,200 --> 00:28:16,559
because they're technically better but

854
00:28:16,559 --> 00:28:18,000
they have some legal means that they can

855
00:28:18,000 --> 00:28:21,200
use like freezing servers i mean in

856
00:28:21,200 --> 00:28:22,880
europe they cannot give you the server

857
00:28:22,880 --> 00:28:24,320
right away but at least they can make

858
00:28:24,320 --> 00:28:26,240
sure that the provider doesn't change it

859
00:28:26,240 --> 00:28:27,840
anymore right

860
00:28:27,840 --> 00:28:29,919
so they keep the server until you can

861
00:28:29,919 --> 00:28:31,919
legally get an image from them

862
00:28:31,919 --> 00:28:33,600
until that's sorted out so things like

863
00:28:33,600 --> 00:28:35,840
that can be very useful law firms that's

864
00:28:35,840 --> 00:28:38,720
especially difficult sometimes in in big

865
00:28:38,720 --> 00:28:40,880
international companies in the us it

866
00:28:40,880 --> 00:28:43,279
goes as far as that legally would have

867
00:28:43,279 --> 00:28:45,760
the obligation in some communities to

868
00:28:45,760 --> 00:28:48,080
even report a breach to the mayor of

869
00:28:48,080 --> 00:28:49,360
that city

870
00:28:49,360 --> 00:28:51,760
it even goes down no one does that right

871
00:28:51,760 --> 00:28:53,600
but technically you would be obliged so

872
00:28:53,600 --> 00:28:56,640
they have very different reporting

873
00:28:56,640 --> 00:28:58,960
obligations there coming communication

874
00:28:58,960 --> 00:29:00,480
firms it's all about communication

875
00:29:00,480 --> 00:29:03,120
remember there was breach in 2014 i

876
00:29:03,120 --> 00:29:03,919
believe for the british

877
00:29:03,919 --> 00:29:06,000
telecommunications provider the ceo went

878
00:29:06,000 --> 00:29:08,240
out and she said uh yeah we had a bridge

879
00:29:08,240 --> 00:29:09,760
but we didn't lose data the next day she

880
00:29:09,760 --> 00:29:11,520
came back well we might have lost like 7

881
00:29:11,520 --> 00:29:14,080
000 customer data sets

882
00:29:14,080 --> 00:29:16,080
next issue came back well maybe it was

883
00:29:16,080 --> 00:29:18,320
rather 60 000 or something

884
00:29:18,320 --> 00:29:20,080
and they kept finding new data until

885
00:29:20,080 --> 00:29:22,240
2019 that's when the bbc got back and

886
00:29:22,240 --> 00:29:24,000
found additional data

887
00:29:24,000 --> 00:29:26,399
she was there for another half year the

888
00:29:26,399 --> 00:29:28,159
organization was losing about 300

889
00:29:28,159 --> 00:29:30,720
millions in value so it was not a super

890
00:29:30,720 --> 00:29:33,120
good communications example here the

891
00:29:33,120 --> 00:29:34,640
important thing is communicate with one

892
00:29:34,640 --> 00:29:37,200
voice right either it's really one

893
00:29:37,200 --> 00:29:39,120
entity that communicates but if multiple

894
00:29:39,120 --> 00:29:40,399
entities communicate

895
00:29:40,399 --> 00:29:42,480
then do that with one voice

896
00:29:42,480 --> 00:29:44,159
going back to resource management real

897
00:29:44,159 --> 00:29:46,000
quick we have different types of

898
00:29:46,000 --> 00:29:49,440
resources so julius caesar uh divided

899
00:29:49,440 --> 00:29:52,399
impera so divide and conquer

900
00:29:52,399 --> 00:29:54,080
it's meant differently by the way so he

901
00:29:54,080 --> 00:29:56,559
meant that differently than we do uh but

902
00:29:56,559 --> 00:29:58,559
it's still very useful for us so we have

903
00:29:58,559 --> 00:30:00,559
the human resources like analysts and so

904
00:30:00,559 --> 00:30:03,919
on we have storage cpu uh you know for

905
00:30:03,919 --> 00:30:05,760
searching and stuff and we have tools

906
00:30:05,760 --> 00:30:07,760
process and content with content i mean

907
00:30:07,760 --> 00:30:10,240
iocs and all that that kind of stuff

908
00:30:10,240 --> 00:30:12,559
and only the middle one can be pro can

909
00:30:12,559 --> 00:30:14,559
be procured very easily i mean i can

910
00:30:14,559 --> 00:30:16,320
spin up as many machines with as many

911
00:30:16,320 --> 00:30:19,279
ram i want at amazon at azure whatever i

912
00:30:19,279 --> 00:30:20,880
want right that's easy

913
00:30:20,880 --> 00:30:21,679
but

914
00:30:21,679 --> 00:30:23,840
on the analyst side you got what you got

915
00:30:23,840 --> 00:30:26,159
and on the tooling side i mean i can buy

916
00:30:26,159 --> 00:30:28,159
a tool pretty quickly but that doesn't

917
00:30:28,159 --> 00:30:30,159
mean i can integrate it into my workflow

918
00:30:30,159 --> 00:30:31,440
that quickly

919
00:30:31,440 --> 00:30:34,000
so that is what i mean there

920
00:30:34,000 --> 00:30:35,440
so good resource management in a

921
00:30:35,440 --> 00:30:37,760
nutshell means bringing resources and

922
00:30:37,760 --> 00:30:40,080
tasks together with the minimum overlap

923
00:30:40,080 --> 00:30:41,039
right

924
00:30:41,039 --> 00:30:43,200
so on the other hand if if that is the

925
00:30:43,200 --> 00:30:45,440
the resources and that is the tasks the

926
00:30:45,440 --> 00:30:47,760
ideal match would be something like this

927
00:30:47,760 --> 00:30:49,120
if you do it like this you you're

928
00:30:49,120 --> 00:30:51,120
missing a lot of tasks you're not doing

929
00:30:51,120 --> 00:30:53,919
them and you are wasting resources

930
00:30:53,919 --> 00:30:55,760
so that's the general idea behind that

931
00:30:55,760 --> 00:30:57,760
and the key is standardization because

932
00:30:57,760 --> 00:31:01,039
only if everyone knows in the teams what

933
00:31:01,039 --> 00:31:03,519
someone else is talking about only then

934
00:31:03,519 --> 00:31:06,080
you can basically succeed there and for

935
00:31:06,080 --> 00:31:08,159
that you can predefine tasks like okay

936
00:31:08,159 --> 00:31:10,159
what is a sweep and hunt so i'm hunting

937
00:31:10,159 --> 00:31:12,080
for user assist for example so i create

938
00:31:12,080 --> 00:31:14,240
a stack out of all users these keys so

939
00:31:14,240 --> 00:31:17,200
users stores execution of gui tools

940
00:31:17,200 --> 00:31:19,519
right for example so this is something

941
00:31:19,519 --> 00:31:21,120
you could also hunt for

942
00:31:21,120 --> 00:31:23,760
triage that's another set and

943
00:31:23,760 --> 00:31:25,519
those sets always come with the timing

944
00:31:25,519 --> 00:31:26,960
involved right so what kind of skill

945
00:31:26,960 --> 00:31:28,799
sets do you need what resource can you

946
00:31:28,799 --> 00:31:31,039
put on that and how how long can that

947
00:31:31,039 --> 00:31:32,559
resource take for that

948
00:31:32,559 --> 00:31:34,480
and then you can in the end come up with

949
00:31:34,480 --> 00:31:36,320
something like this so for example

950
00:31:36,320 --> 00:31:38,640
analyst one is working on a triage two

951
00:31:38,640 --> 00:31:40,480
triashes we usually take around four or

952
00:31:40,480 --> 00:31:42,480
five hours for that to really be sure

953
00:31:42,480 --> 00:31:44,480
about what happened on a single machine

954
00:31:44,480 --> 00:31:46,880
so that's about the maximum for that uh

955
00:31:46,880 --> 00:31:48,720
so that analyst will be blocked if you

956
00:31:48,720 --> 00:31:50,480
talk about an eight to ten hour day

957
00:31:50,480 --> 00:31:52,640
another analyst has uh two has a

958
00:31:52,640 --> 00:31:54,799
persistent stack an execution stack and

959
00:31:54,799 --> 00:31:57,519
triage so also occupied the whole day

960
00:31:57,519 --> 00:31:59,200
then we have an analyst three who

961
00:31:59,200 --> 00:32:00,880
probably worked in a different case so

962
00:32:00,880 --> 00:32:02,960
we assigned like two hours three hours

963
00:32:02,960 --> 00:32:05,120
to familiarize himself with the case and

964
00:32:05,120 --> 00:32:07,440
after then one triage and then there's

965
00:32:07,440 --> 00:32:09,279
still some leftover from the other case

966
00:32:09,279 --> 00:32:11,360
and when you schedule people like this

967
00:32:11,360 --> 00:32:14,159
uh you you avoid too too big overlaps

968
00:32:14,159 --> 00:32:15,200
all right

969
00:32:15,200 --> 00:32:16,559
and it's not that we don't want to pay

970
00:32:16,559 --> 00:32:18,000
for more people we just don't get them

971
00:32:18,000 --> 00:32:19,279
and that means we need to manage them

972
00:32:19,279 --> 00:32:21,039
wisely and i think most of you are in

973
00:32:21,039 --> 00:32:23,279
the same situation i would wonder if not

974
00:32:23,279 --> 00:32:24,799
so if you're not in that situation then

975
00:32:24,799 --> 00:32:26,799
please let me know how you do that

976
00:32:26,799 --> 00:32:28,480
i would be really thrilled to know

977
00:32:28,480 --> 00:32:30,399
uh so never do anything without a

978
00:32:30,399 --> 00:32:32,399
guiding question right so everything you

979
00:32:32,399 --> 00:32:34,240
do should got a question because no

980
00:32:34,240 --> 00:32:36,320
question you can dive down into a

981
00:32:36,320 --> 00:32:38,559
forensic images for days weeks and

982
00:32:38,559 --> 00:32:41,440
months and still find new things

983
00:32:41,440 --> 00:32:44,799
but does it help the case uh mostly not

984
00:32:44,799 --> 00:32:46,640
right so that is you have to

985
00:32:46,640 --> 00:32:48,399
differentiate research that you can put

986
00:32:48,399 --> 00:32:50,720
on your block from from things that you

987
00:32:50,720 --> 00:32:52,240
do for your client or your organization

988
00:32:52,240 --> 00:32:54,240
that's very important there

989
00:32:54,240 --> 00:32:55,679
so questions could be what did the

990
00:32:55,679 --> 00:32:58,159
attacker do on system xyz which other

991
00:32:58,159 --> 00:32:59,679
machines have the attack the staging

992
00:32:59,679 --> 00:33:02,159
directory so for example if they use

993
00:33:02,159 --> 00:33:03,600
program data

994
00:33:03,600 --> 00:33:04,720
whatever

995
00:33:04,720 --> 00:33:06,320
then you can look for all the machines

996
00:33:06,320 --> 00:33:07,840
what data was that staged for

997
00:33:07,840 --> 00:33:10,000
exfiltration on host xyz things like

998
00:33:10,000 --> 00:33:10,720
that

999
00:33:10,720 --> 00:33:13,200
so in general you first formulate a

1000
00:33:13,200 --> 00:33:14,559
question

1001
00:33:14,559 --> 00:33:16,559
it's not that formal right in reality

1002
00:33:16,559 --> 00:33:19,440
it's hey analyst xyz can you really

1003
00:33:19,440 --> 00:33:21,279
quick check this and that in the chat

1004
00:33:21,279 --> 00:33:22,080
right

1005
00:33:22,080 --> 00:33:24,640
all the other stuff is implicit right so

1006
00:33:24,640 --> 00:33:26,240
um they know what i'm talking about

1007
00:33:26,240 --> 00:33:27,679
because they are usually technically

1008
00:33:27,679 --> 00:33:29,760
skilled um they understand my question

1009
00:33:29,760 --> 00:33:32,559
because i well asked them

1010
00:33:32,559 --> 00:33:34,240
they know what way to use to figure that

1011
00:33:34,240 --> 00:33:35,760
out usually

1012
00:33:35,760 --> 00:33:36,880
um

1013
00:33:36,880 --> 00:33:39,120
i already and i have the right analysts

1014
00:33:39,120 --> 00:33:40,399
and they do that and they give me the

1015
00:33:40,399 --> 00:33:42,159
results so it's not that formal such as

1016
00:33:42,159 --> 00:33:44,559
try to sort of formalize that in in some

1017
00:33:44,559 --> 00:33:45,919
sort of way

1018
00:33:45,919 --> 00:33:48,799
that brings me to to well the last

1019
00:33:48,799 --> 00:33:50,720
points their documentation and there are

1020
00:33:50,720 --> 00:33:52,399
some principles that we try to follow

1021
00:33:52,399 --> 00:33:54,480
there and again documentation especially

1022
00:33:54,480 --> 00:33:55,679
in high-pressure environments is

1023
00:33:55,679 --> 00:33:57,279
difficult but on the other hand

1024
00:33:57,279 --> 00:33:58,720
especially in high-pressure environments

1025
00:33:58,720 --> 00:34:00,480
you should document very well

1026
00:34:00,480 --> 00:34:01,519
so

1027
00:34:01,519 --> 00:34:03,039
as soon as you have breaches in big

1028
00:34:03,039 --> 00:34:05,519
organizations it's always a political

1029
00:34:05,519 --> 00:34:06,559
game

1030
00:34:06,559 --> 00:34:08,800
so what you can't do and what will make

1031
00:34:08,800 --> 00:34:11,440
you fail is and that is what almost made

1032
00:34:11,440 --> 00:34:13,359
me feel when i was a very young analyst

1033
00:34:13,359 --> 00:34:14,399
in uh

1034
00:34:14,399 --> 00:34:15,918
in that regard it was an organization

1035
00:34:15,918 --> 00:34:18,239
with around 200 000 hosts and i was

1036
00:34:18,239 --> 00:34:19,918
fortunately not leading that there were

1037
00:34:19,918 --> 00:34:21,918
so many political games going on and i

1038
00:34:21,918 --> 00:34:24,560
didn't understand them at this point

1039
00:34:24,560 --> 00:34:26,399
because i would thought okay everyone is

1040
00:34:26,399 --> 00:34:28,239
pulling on the same rope going into the

1041
00:34:28,239 --> 00:34:30,159
same direction and working for the best

1042
00:34:30,159 --> 00:34:31,839
of the client in the clients

1043
00:34:31,839 --> 00:34:33,599
organization that's not true

1044
00:34:33,599 --> 00:34:35,679
in reality it was a lot of infighting

1045
00:34:35,679 --> 00:34:37,760
they used that whole incident to kick

1046
00:34:37,760 --> 00:34:39,359
others out of their position and take

1047
00:34:39,359 --> 00:34:40,960
their position and so on

1048
00:34:40,960 --> 00:34:42,639
and that is something you don't want to

1049
00:34:42,639 --> 00:34:44,639
be drawn into much as an organization

1050
00:34:44,639 --> 00:34:47,199
you have to separate yourself from that

1051
00:34:47,199 --> 00:34:48,960
and and be aware of that and control the

1052
00:34:48,960 --> 00:34:51,040
situation

1053
00:34:51,040 --> 00:34:52,560
so what i try to do and that is

1054
00:34:52,560 --> 00:34:54,879
something we really do uh good our leads

1055
00:34:54,879 --> 00:34:56,399
can brief their staff but also the

1056
00:34:56,399 --> 00:34:58,560
clients and also all other stakeholders

1057
00:34:58,560 --> 00:35:00,079
at every given time

1058
00:35:00,079 --> 00:35:03,200
even if and that happens to me uh i have

1059
00:35:03,200 --> 00:35:04,720
clients that just want to talk to me

1060
00:35:04,720 --> 00:35:06,079
like some sort of escalation or

1061
00:35:06,079 --> 00:35:08,160
something i can call up our so-called

1062
00:35:08,160 --> 00:35:10,160
spreadsheet of doom i'll get to that and

1063
00:35:10,160 --> 00:35:11,599
i can brief them even though i have no

1064
00:35:11,599 --> 00:35:13,200
clue about the case

1065
00:35:13,200 --> 00:35:15,119
if the analysts

1066
00:35:15,119 --> 00:35:16,720
document documented right that is the

1067
00:35:16,720 --> 00:35:18,640
idea at every given point in time that

1068
00:35:18,640 --> 00:35:20,079
should be possible

1069
00:35:20,079 --> 00:35:22,560
um so usually especially in large cases

1070
00:35:22,560 --> 00:35:24,560
documenting takes time that's for sure

1071
00:35:24,560 --> 00:35:26,320
but it saves more time than it takes in

1072
00:35:26,320 --> 00:35:29,280
the end that is also something and don't

1073
00:35:29,280 --> 00:35:31,440
get me wrong i hate documenting i really

1074
00:35:31,440 --> 00:35:33,760
love hunting i hate documenting but i

1075
00:35:33,760 --> 00:35:35,520
hate it even more when i get confronted

1076
00:35:35,520 --> 00:35:37,520
with a badly documented case and i can't

1077
00:35:37,520 --> 00:35:39,680
say anything about it because then it's

1078
00:35:39,680 --> 00:35:41,200
usually embarrassing and i try to avoid

1079
00:35:41,200 --> 00:35:42,000
that

1080
00:35:42,000 --> 00:35:44,480
so as soon as uh documentation is

1081
00:35:44,480 --> 00:35:46,640
confirmed uh sorry information is

1082
00:35:46,640 --> 00:35:48,960
confirmed documented i'm not saying that

1083
00:35:48,960 --> 00:35:51,280
we for example always put it into um

1084
00:35:51,280 --> 00:35:54,160
into the the documentation software at

1085
00:35:54,160 --> 00:35:56,400
uh right away but at least we have it in

1086
00:35:56,400 --> 00:35:58,480
a chat and we mark it that it has to be

1087
00:35:58,480 --> 00:36:00,400
added right because sometimes when

1088
00:36:00,400 --> 00:36:02,079
you're on a call information keeps

1089
00:36:02,079 --> 00:36:03,839
coming in and you want to think about it

1090
00:36:03,839 --> 00:36:05,280
a little bit before you document it

1091
00:36:05,280 --> 00:36:07,599
right but then you still need to make

1092
00:36:07,599 --> 00:36:08,960
sure that it ends up in the

1093
00:36:08,960 --> 00:36:11,200
documentation in the end so spreadsheet

1094
00:36:11,200 --> 00:36:13,119
of doom is actually a name that came

1095
00:36:13,119 --> 00:36:14,640
from mandiant

1096
00:36:14,640 --> 00:36:16,320
we had it in sense as well that's why i

1097
00:36:16,320 --> 00:36:19,280
can even name that um

1098
00:36:19,280 --> 00:36:22,079
i think it was 2015 as well when mandy

1099
00:36:22,079 --> 00:36:23,359
and changed that name the reason for

1100
00:36:23,359 --> 00:36:26,000
that is we always send a redacted

1101
00:36:26,000 --> 00:36:27,359
version to the client for the weekly

1102
00:36:27,359 --> 00:36:29,920
status meetings and it always said sod

1103
00:36:29,920 --> 00:36:32,240
and then the case number it was done in

1104
00:36:32,240 --> 00:36:35,040
excel and unfortunately one client cared

1105
00:36:35,040 --> 00:36:36,880
to ask um

1106
00:36:36,880 --> 00:36:39,200
what does sod stand for and we said

1107
00:36:39,200 --> 00:36:40,880
spreadsheet of doom and they didn't find

1108
00:36:40,880 --> 00:36:42,640
it funny uh

1109
00:36:42,640 --> 00:36:44,000
that is the reason why they changed the

1110
00:36:44,000 --> 00:36:47,040
engagement management sheet but i'm

1111
00:36:47,040 --> 00:36:49,599
but i'm happy to keep that name there

1112
00:36:49,599 --> 00:36:52,480
okay so the idea is it's the the single

1113
00:36:52,480 --> 00:36:54,079
place of truth about the investigation

1114
00:36:54,079 --> 00:36:56,000
so i'm not saying distorted the the

1115
00:36:56,000 --> 00:36:57,680
actual malware in there but at least

1116
00:36:57,680 --> 00:37:00,000
references to it so it contains a master

1117
00:37:00,000 --> 00:37:01,839
timeline that tells you the whole story

1118
00:37:01,839 --> 00:37:03,760
about the case and that is also what i

1119
00:37:03,760 --> 00:37:06,320
see in those day six challenges at sans

1120
00:37:06,320 --> 00:37:08,400
usually the groups that fare best are

1121
00:37:08,400 --> 00:37:10,079
the ones that tell a story rather than

1122
00:37:10,079 --> 00:37:12,480
answering single questions i mean i just

1123
00:37:12,480 --> 00:37:14,640
said answer questions and so on right

1124
00:37:14,640 --> 00:37:16,640
but not in the presentation not in how

1125
00:37:16,640 --> 00:37:19,200
you basically then present the case tell

1126
00:37:19,200 --> 00:37:20,880
a story they came in via this

1127
00:37:20,880 --> 00:37:22,960
vulnerability on that server shortly

1128
00:37:22,960 --> 00:37:24,400
after that they p voted to somewhere

1129
00:37:24,400 --> 00:37:26,800
else um then there was nothing which

1130
00:37:26,800 --> 00:37:28,480
makes us believe that maybe that was an

1131
00:37:28,480 --> 00:37:30,480
access broker who later sold the excess

1132
00:37:30,480 --> 00:37:32,000
off to someone else that's how we

1133
00:37:32,000 --> 00:37:34,880
explained the the gap of one month in

1134
00:37:34,880 --> 00:37:36,400
between the first breach and

1135
00:37:36,400 --> 00:37:37,680
you know you know how it works right

1136
00:37:37,680 --> 00:37:39,520
those of you who do that know what i'm

1137
00:37:39,520 --> 00:37:41,119
talking about

1138
00:37:41,119 --> 00:37:42,160
uh

1139
00:37:42,160 --> 00:37:44,160
also it's a good a good way for resource

1140
00:37:44,160 --> 00:37:46,560
management because if you have like

1141
00:37:46,560 --> 00:37:48,880
machines piling up for triage for a

1142
00:37:48,880 --> 00:37:50,720
closer inspection

1143
00:37:50,720 --> 00:37:52,720
i need to know how fast i can work

1144
00:37:52,720 --> 00:37:54,640
through that so if i have two people i

1145
00:37:54,640 --> 00:37:56,640
know one person can do true triages a

1146
00:37:56,640 --> 00:37:57,599
day

1147
00:37:57,599 --> 00:37:59,920
and i have like eight machines piling up

1148
00:37:59,920 --> 00:38:01,760
i either invest the next four days doing

1149
00:38:01,760 --> 00:38:02,720
that

1150
00:38:02,720 --> 00:38:04,960
or i need to get more analysts whatever

1151
00:38:04,960 --> 00:38:06,640
works best in the setting of the case

1152
00:38:06,640 --> 00:38:07,520
right

1153
00:38:07,520 --> 00:38:09,440
and that is important to know because it

1154
00:38:09,440 --> 00:38:10,560
also is

1155
00:38:10,560 --> 00:38:12,320
uh it basically influences

1156
00:38:12,320 --> 00:38:14,560
prioritization because if i know that it

1157
00:38:14,560 --> 00:38:16,160
will take four days i need to think

1158
00:38:16,160 --> 00:38:18,000
about what do i need first that's

1159
00:38:18,000 --> 00:38:19,119
important

1160
00:38:19,119 --> 00:38:21,440
okay

1161
00:38:21,440 --> 00:38:23,680
so there's a basic rule for us

1162
00:38:23,680 --> 00:38:25,760
if it's too big then it doesn't go into

1163
00:38:25,760 --> 00:38:28,560
the sot but it will be referenced so for

1164
00:38:28,560 --> 00:38:30,640
example like large powershell payloads i

1165
00:38:30,640 --> 00:38:32,000
don't put them in the salt directly i

1166
00:38:32,000 --> 00:38:33,680
reference them by number put it in a

1167
00:38:33,680 --> 00:38:36,400
wiki or whatever you fancy for that

1168
00:38:36,400 --> 00:38:37,760
because um

1169
00:38:37,760 --> 00:38:40,160
for me when i tell the story i don't

1170
00:38:40,160 --> 00:38:41,440
need to have the full powershell i know

1171
00:38:41,440 --> 00:38:42,480
this is

1172
00:38:42,480 --> 00:38:44,079
the powershell implant cobra strike

1173
00:38:44,079 --> 00:38:46,880
implant or whatever right

1174
00:38:46,880 --> 00:38:48,560
so the problem that i was faced with is

1175
00:38:48,560 --> 00:38:51,280
at mandiant we try to create a tool to

1176
00:38:51,280 --> 00:38:52,320
make that

1177
00:38:52,320 --> 00:38:54,240
now you have a ton of very experienced

1178
00:38:54,240 --> 00:38:56,560
incident responders and no one works the

1179
00:38:56,560 --> 00:38:59,359
exact same way as the other one

1180
00:38:59,359 --> 00:39:01,280
so that means that they tried to come up

1181
00:39:01,280 --> 00:39:02,880
with a specification to have that

1182
00:39:02,880 --> 00:39:04,800
software written but they failed for

1183
00:39:04,800 --> 00:39:05,839
years

1184
00:39:05,839 --> 00:39:08,320
because too many big egos and so on so

1185
00:39:08,320 --> 00:39:10,560
it didn't work out they kept working on

1186
00:39:10,560 --> 00:39:13,839
excel and sharing that by

1187
00:39:13,839 --> 00:39:16,480
what is the predecessor of of git uh

1188
00:39:16,480 --> 00:39:18,000
uh

1189
00:39:18,000 --> 00:39:21,680
sir yes right uh cbn right

1190
00:39:21,680 --> 00:39:23,119
yeah because there you could lock the

1191
00:39:23,119 --> 00:39:24,880
files to indicate that no one else can

1192
00:39:24,880 --> 00:39:27,440
overwrite it's it's super annoying but

1193
00:39:27,440 --> 00:39:29,440
it works in the end

1194
00:39:29,440 --> 00:39:30,720
but the problem is that works with

1195
00:39:30,720 --> 00:39:32,240
experienced teams in the end you end up

1196
00:39:32,240 --> 00:39:33,440
with like

1197
00:39:33,440 --> 00:39:35,280
20 different versions of this sort one

1198
00:39:35,280 --> 00:39:37,599
has more columns one has less columns

1199
00:39:37,599 --> 00:39:39,599
one who who knows how to use spivo

1200
00:39:39,599 --> 00:39:41,440
tables uses pivot tables and all that

1201
00:39:41,440 --> 00:39:44,400
kind of thing right and it did the job

1202
00:39:44,400 --> 00:39:46,400
that that's for sure but it

1203
00:39:46,400 --> 00:39:48,480
is not suitable for not so experienced

1204
00:39:48,480 --> 00:39:51,040
teams right and it's it's particularly

1205
00:39:51,040 --> 00:39:52,640
hard and i know that because i came to

1206
00:39:52,640 --> 00:39:54,720
an organization who had that already

1207
00:39:54,720 --> 00:39:56,880
for someone new to get into that tune

1208
00:39:56,880 --> 00:39:59,680
that's super difficult so now when i had

1209
00:39:59,680 --> 00:40:01,280
the chance like five years ago to build

1210
00:40:01,280 --> 00:40:02,800
my own team i said okay i need to do

1211
00:40:02,800 --> 00:40:04,319
that differently

1212
00:40:04,319 --> 00:40:06,480
because if you give unexperienced people

1213
00:40:06,480 --> 00:40:08,400
too much freedom in documentation you

1214
00:40:08,400 --> 00:40:11,359
end up in a mess that's for sure

1215
00:40:11,359 --> 00:40:12,880
so i came up with the first version of

1216
00:40:12,880 --> 00:40:15,599
aurora ir that's what it looks like

1217
00:40:15,599 --> 00:40:17,839
and i sort of have to excuse myself to a

1218
00:40:17,839 --> 00:40:20,319
little bit here

1219
00:40:20,319 --> 00:40:21,920
the the biggest problem with that it's

1220
00:40:21,920 --> 00:40:24,240
not super handy when it comes to being

1221
00:40:24,240 --> 00:40:26,960
used by multiple analysts so the idea

1222
00:40:26,960 --> 00:40:28,960
it's it's basically pretty much the

1223
00:40:28,960 --> 00:40:31,119
thought that we had mentioned plus a few

1224
00:40:31,119 --> 00:40:34,400
things particularly um interconnections

1225
00:40:34,400 --> 00:40:35,839
visualizations and so on i'll get to

1226
00:40:35,839 --> 00:40:37,040
that at the moment

1227
00:40:37,040 --> 00:40:39,280
but it's a flat file it's a flat file

1228
00:40:39,280 --> 00:40:40,960
that you work on with the tool

1229
00:40:40,960 --> 00:40:42,640
the reason for that why i started out

1230
00:40:42,640 --> 00:40:44,640
and that's also one of the reasons why

1231
00:40:44,640 --> 00:40:47,280
they kept to excel is

1232
00:40:47,280 --> 00:40:48,640
i still had in the back of my mind's

1233
00:40:48,640 --> 00:40:50,400
cases where i was sitting for example in

1234
00:40:50,400 --> 00:40:52,880
some bunker in riyadh in saudi arabia

1235
00:40:52,880 --> 00:40:54,720
you did not have internet you had

1236
00:40:54,720 --> 00:40:57,040
nothing we literally had to leave the

1237
00:40:57,040 --> 00:40:58,800
machines there so they just paid for the

1238
00:40:58,800 --> 00:41:00,480
machines we had new machines we left

1239
00:41:00,480 --> 00:41:02,000
them there

1240
00:41:02,000 --> 00:41:03,599
when we wanted to check

1241
00:41:03,599 --> 00:41:06,240
iocs like you know md5 sums and so on

1242
00:41:06,240 --> 00:41:08,160
that we found we had to literally print

1243
00:41:08,160 --> 00:41:09,760
them out we had a printer there in that

1244
00:41:09,760 --> 00:41:11,680
bunker we had to print them out bring

1245
00:41:11,680 --> 00:41:15,599
them with us to the hotel ocr them which

1246
00:41:15,599 --> 00:41:17,520
not always worked very great

1247
00:41:17,520 --> 00:41:19,280
ocr and back can check it against our

1248
00:41:19,280 --> 00:41:22,240
data sets on other machines and in those

1249
00:41:22,240 --> 00:41:24,480
settings uh you know having something at

1250
00:41:24,480 --> 00:41:26,640
azure or somewhere else does not work

1251
00:41:26,640 --> 00:41:27,760
very well

1252
00:41:27,760 --> 00:41:29,119
and that is why i came up with that

1253
00:41:29,119 --> 00:41:32,560
second reason is i do well before coving

1254
00:41:32,560 --> 00:41:34,160
and now it's starting and i flew around

1255
00:41:34,160 --> 00:41:36,319
quite a lot

1256
00:41:36,319 --> 00:41:38,319
so when you want to write a report

1257
00:41:38,319 --> 00:41:39,599
you shouldn't be relying too much on the

1258
00:41:39,599 --> 00:41:41,200
internet to write that

1259
00:41:41,200 --> 00:41:42,480
because then you lose the time in the

1260
00:41:42,480 --> 00:41:44,640
airplane that's another reason for that

1261
00:41:44,640 --> 00:41:46,640
that's why it's monolithic you can use

1262
00:41:46,640 --> 00:41:48,800
it with multiple um analysts but in or

1263
00:41:48,800 --> 00:41:50,960
you could with um

1264
00:41:50,960 --> 00:41:53,119
just putting data on a share so super

1265
00:41:53,119 --> 00:41:55,440
easy that way um

1266
00:41:55,440 --> 00:41:58,079
no it's not but it works

1267
00:41:58,079 --> 00:42:00,319
um forget about that there's a new will

1268
00:42:00,319 --> 00:42:02,400
be a new version out pretty soon

1269
00:42:02,400 --> 00:42:03,760
one of the good things is you get visual

1270
00:42:03,760 --> 00:42:05,760
timelines and one important thing in

1271
00:42:05,760 --> 00:42:07,119
incident response is those false

1272
00:42:07,119 --> 00:42:08,480
negatives things that you miss right

1273
00:42:08,480 --> 00:42:10,800
those are the denture things so if a

1274
00:42:10,800 --> 00:42:12,960
timeline is inconsistent if there is an

1275
00:42:12,960 --> 00:42:15,200
indication that you miss something

1276
00:42:15,200 --> 00:42:16,640
you should see that graphically you

1277
00:42:16,640 --> 00:42:18,400
should visually see that i'll give an

1278
00:42:18,400 --> 00:42:20,880
example we saw exfiltration to mega with

1279
00:42:20,880 --> 00:42:23,599
our clone or something no mega sync

1280
00:42:23,599 --> 00:42:25,599
and it ended like

1281
00:42:25,599 --> 00:42:27,680
seven eight hours before encryption in

1282
00:42:27,680 --> 00:42:30,560
the ransomware case

1283
00:42:30,560 --> 00:42:33,280
ah sorry these water and

1284
00:42:33,280 --> 00:42:35,200
the thing about that is uh

1285
00:42:35,200 --> 00:42:36,960
we couldn't make sense of that did they

1286
00:42:36,960 --> 00:42:38,560
go on vacation or what was going on

1287
00:42:38,560 --> 00:42:39,520
there

1288
00:42:39,520 --> 00:42:42,000
and the thing was we then realized

1289
00:42:42,000 --> 00:42:44,000
because we saw that that they recovered

1290
00:42:44,000 --> 00:42:45,520
that machine from a backup that was

1291
00:42:45,520 --> 00:42:48,319
exactly seven hours older that was the

1292
00:42:48,319 --> 00:42:49,520
reason

1293
00:42:49,520 --> 00:42:51,760
so they got a little bit newer snapshot

1294
00:42:51,760 --> 00:42:53,280
which gave us a little bit more locks

1295
00:42:53,280 --> 00:42:55,119
about the exfiltration but we would have

1296
00:42:55,119 --> 00:42:56,400
missed that without the graphical

1297
00:42:56,400 --> 00:42:58,319
representation because if it's in a flat

1298
00:42:58,319 --> 00:43:00,800
table every distance between two lines

1299
00:43:00,800 --> 00:43:02,319
looks the same right

1300
00:43:02,319 --> 00:43:04,319
that is super dangerous

1301
00:43:04,319 --> 00:43:05,599
and you also get an idea about the

1302
00:43:05,599 --> 00:43:07,440
lateral movement and here we're looking

1303
00:43:07,440 --> 00:43:08,960
for islands so if you see lateral

1304
00:43:08,960 --> 00:43:11,280
movement between machine a and b and if

1305
00:43:11,280 --> 00:43:12,960
a big cluster like that then the

1306
00:43:12,960 --> 00:43:14,480
question is how is a and b connected

1307
00:43:14,480 --> 00:43:16,319
with the rest of the cluster we must be

1308
00:43:16,319 --> 00:43:17,680
missing something

1309
00:43:17,680 --> 00:43:19,599
that is also important and then we

1310
00:43:19,599 --> 00:43:22,880
hooked it up to other tools

1311
00:43:23,359 --> 00:43:25,920
like wires total or misp so we can shoot

1312
00:43:25,920 --> 00:43:27,520
every indicator right into miss so it

1313
00:43:27,520 --> 00:43:28,880
goes on the feet

1314
00:43:28,880 --> 00:43:30,800
right investigation

1315
00:43:30,800 --> 00:43:32,480
this is going to be the new version i'll

1316
00:43:32,480 --> 00:43:33,839
just show you real quick at least i

1317
00:43:33,839 --> 00:43:36,160
tried to

1318
00:43:36,160 --> 00:43:38,000
it's not out yet

1319
00:43:38,000 --> 00:43:40,079
because there's something in the ukraine

1320
00:43:40,079 --> 00:43:41,040
that

1321
00:43:41,040 --> 00:43:43,599
came in the way a little bit

1322
00:43:43,599 --> 00:43:45,520
that is

1323
00:43:45,520 --> 00:43:47,440
a mirror this is

1324
00:43:47,440 --> 00:43:48,880
oh great

1325
00:43:48,880 --> 00:43:51,680
let me just see

1326
00:43:51,680 --> 00:43:53,040
look i had to google how to mirror the

1327
00:43:53,040 --> 00:43:55,119
displays on the new macos uh this is

1328
00:43:55,119 --> 00:43:56,720
what it looks like um it's a little bit

1329
00:43:56,720 --> 00:43:58,480
different it's a web application as you

1330
00:43:58,480 --> 00:44:01,440
can see it will work on a um on a graph

1331
00:44:01,440 --> 00:44:03,200
database so there's neo4j in the

1332
00:44:03,200 --> 00:44:05,200
background of that whole thing and the

1333
00:44:05,200 --> 00:44:07,200
idea is the same right so you have like

1334
00:44:07,200 --> 00:44:08,640
the master timeline is the thing you

1335
00:44:08,640 --> 00:44:10,240
talk about but on the other hand if

1336
00:44:10,240 --> 00:44:11,680
you're new to a case you get some

1337
00:44:11,680 --> 00:44:13,440
information already right you start into

1338
00:44:13,440 --> 00:44:16,160
a case um we start a case with a

1339
00:44:16,160 --> 00:44:18,079
questionnaire so depending on what kind

1340
00:44:18,079 --> 00:44:19,920
of case that is we ask different

1341
00:44:19,920 --> 00:44:22,160
questions right we also ask

1342
00:44:22,160 --> 00:44:23,680
non-technical questions like are you

1343
00:44:23,680 --> 00:44:25,839
publicly traded because then we want to

1344
00:44:25,839 --> 00:44:28,480
know in which uh stock exchange if it's

1345
00:44:28,480 --> 00:44:29,599
in new york

1346
00:44:29,599 --> 00:44:30,880
we know we're gonna have to deal with

1347
00:44:30,880 --> 00:44:32,640
the sec and that's not fun

1348
00:44:32,640 --> 00:44:34,560
right so that is just um what i'm

1349
00:44:34,560 --> 00:44:36,640
talking about you get an indication so

1350
00:44:36,640 --> 00:44:37,839
that would be a typical case where you

1351
00:44:37,839 --> 00:44:39,760
have an access broker right

1352
00:44:39,760 --> 00:44:41,520
so you see like on the left hand side

1353
00:44:41,520 --> 00:44:43,040
some activity and then on the right

1354
00:44:43,040 --> 00:44:44,640
again and in between nothing so either

1355
00:44:44,640 --> 00:44:46,880
you're really missing a lot

1356
00:44:46,880 --> 00:44:49,520
or it was an excess broker you see how

1357
00:44:49,520 --> 00:44:51,359
long they have been breached so quite

1358
00:44:51,359 --> 00:44:54,160
long and

1359
00:44:54,160 --> 00:44:55,839
the other thing is it helps you

1360
00:44:55,839 --> 00:44:57,839
throughout the process so as i said you

1361
00:44:57,839 --> 00:44:59,760
can look through the timeline like this

1362
00:44:59,760 --> 00:45:01,359
but you also have the visual timeline

1363
00:45:01,359 --> 00:45:03,680
where you can later see gaps

1364
00:45:03,680 --> 00:45:06,160
so you see exactly what happened

1365
00:45:06,160 --> 00:45:08,400
let's walk through it real quick so we

1366
00:45:08,400 --> 00:45:09,760
had a web shell you know outlook

1367
00:45:09,760 --> 00:45:12,640
vulnerability we had tons of these

1368
00:45:12,640 --> 00:45:14,960
the attacker put in recharge with the

1369
00:45:14,960 --> 00:45:18,240
recharge the rdp to localhost that works

1370
00:45:18,240 --> 00:45:20,160
pretty well with the admin user that

1371
00:45:20,160 --> 00:45:22,319
they got right off the web server they

1372
00:45:22,319 --> 00:45:24,160
installed something kill av but then

1373
00:45:24,160 --> 00:45:26,160
they ran mimikats under the name x64

1374
00:45:26,160 --> 00:45:27,920
which is quite frequent

1375
00:45:27,920 --> 00:45:29,280
we got that

1376
00:45:29,280 --> 00:45:30,480
installation because that's when the

1377
00:45:30,480 --> 00:45:33,280
file got there we also got the execution

1378
00:45:33,280 --> 00:45:34,319
here

1379
00:45:34,319 --> 00:45:35,440
because they double clicked it on the

1380
00:45:35,440 --> 00:45:36,560
desktop

1381
00:45:36,560 --> 00:45:38,240
then they pivoted to the domain

1382
00:45:38,240 --> 00:45:39,839
controller they started cobalt strike

1383
00:45:39,839 --> 00:45:42,079
there and on that server we seen the

1384
00:45:42,079 --> 00:45:44,240
shellbacks that they were looking for a

1385
00:45:44,240 --> 00:45:46,560
file server or a server called f1 and

1386
00:45:46,560 --> 00:45:49,040
the finance share there that is as far

1387
00:45:49,040 --> 00:45:52,079
as it goes we can look at it from the um

1388
00:45:52,079 --> 00:45:53,920
from the lateral movement perspective if

1389
00:45:53,920 --> 00:45:55,359
we want to

1390
00:45:55,359 --> 00:45:57,359
it's not super complex it's an easy case

1391
00:45:57,359 --> 00:45:59,599
right i just made that up out of real

1392
00:45:59,599 --> 00:46:01,839
data but it's not a real case

1393
00:46:01,839 --> 00:46:03,280
and also it will help you in the future

1394
00:46:03,280 --> 00:46:05,200
and that's very new in cleaning up so

1395
00:46:05,200 --> 00:46:07,119
for example uh all the it's a graph

1396
00:46:07,119 --> 00:46:08,480
database right so everything can be

1397
00:46:08,480 --> 00:46:10,079
connected with everything

1398
00:46:10,079 --> 00:46:12,400
so in other terms uh before that we had

1399
00:46:12,400 --> 00:46:14,400
that that the timeline

1400
00:46:14,400 --> 00:46:16,400
and we had that malware stuff and we had

1401
00:46:16,400 --> 00:46:18,240
to go through the malware tab and filter

1402
00:46:18,240 --> 00:46:20,319
for hosts to make a cleanup plan for a

1403
00:46:20,319 --> 00:46:22,400
specific host now you just need to go

1404
00:46:22,400 --> 00:46:23,920
like for example this is the exchange

1405
00:46:23,920 --> 00:46:25,680
server go ahead and say okay what kind

1406
00:46:25,680 --> 00:46:27,040
of malware do we have on this server

1407
00:46:27,040 --> 00:46:28,400
okay those three things

1408
00:46:28,400 --> 00:46:30,079
get rid of these then we should be good

1409
00:46:30,079 --> 00:46:31,839
to go um

1410
00:46:31,839 --> 00:46:33,599
what is the specific timeline for this

1411
00:46:33,599 --> 00:46:34,640
machine

1412
00:46:34,640 --> 00:46:36,640
only for this machine and all of the

1413
00:46:36,640 --> 00:46:38,880
things can be well presented in any

1414
00:46:38,880 --> 00:46:41,119
given way which gives me a little bit

1415
00:46:41,119 --> 00:46:42,400
more flexibility

1416
00:46:42,400 --> 00:46:43,280
to

1417
00:46:43,280 --> 00:46:45,599
work on your suggestions before that it

1418
00:46:45,599 --> 00:46:46,960
was very difficult in the old version

1419
00:46:46,960 --> 00:46:49,599
because with data model now everything

1420
00:46:49,599 --> 00:46:51,440
is possible because we are talking about

1421
00:46:51,440 --> 00:46:54,800
a network here and

1422
00:46:54,800 --> 00:46:57,680
it's in the end all about um uh

1423
00:46:57,680 --> 00:46:59,440
the presentation and that can be changed

1424
00:46:59,440 --> 00:47:01,599
quickly the underlying data model that's

1425
00:47:01,599 --> 00:47:03,599
a different story but presentation

1426
00:47:03,599 --> 00:47:05,200
that's usually just a matter of time

1427
00:47:05,200 --> 00:47:06,480
nothing else

1428
00:47:06,480 --> 00:47:10,640
and uh well this is the idea there any

1429
00:47:10,640 --> 00:47:13,040
questions

1430
00:47:13,040 --> 00:47:15,280
oh it will be open sourced again uh the

1431
00:47:15,280 --> 00:47:17,440
problem with that is uh i just do that

1432
00:47:17,440 --> 00:47:18,640
once it's

1433
00:47:18,640 --> 00:47:20,480
far enough that pull request will not

1434
00:47:20,480 --> 00:47:24,800
kill me that is the idea

1435
00:47:24,800 --> 00:47:26,240
thank you matthias thank you

1436
00:47:26,240 --> 00:47:28,800
[Applause]

1437
00:47:28,800 --> 00:47:30,580
are there any questions in the room

1438
00:47:30,580 --> 00:47:33,670
[Applause]

1439
00:47:36,319 --> 00:47:39,280
hi thanks for the presentation uh i just

1440
00:47:39,280 --> 00:47:40,960
have one question related to resource

1441
00:47:40,960 --> 00:47:42,720
management so as you mentioned very

1442
00:47:42,720 --> 00:47:46,000
wisely so the the case is a

1443
00:47:46,000 --> 00:47:48,160
very important exciting event for the

1444
00:47:48,160 --> 00:47:49,200
customer

1445
00:47:49,200 --> 00:47:51,040
but it is less for the team who does

1446
00:47:51,040 --> 00:47:53,119
that every day so how do you manage

1447
00:47:53,119 --> 00:47:55,520
resource management uh in the face that

1448
00:47:55,520 --> 00:47:57,680
the customer expects people to work on

1449
00:47:57,680 --> 00:48:00,319
the case every time all night and just

1450
00:48:00,319 --> 00:48:02,400
people just have lives

1451
00:48:02,400 --> 00:48:03,760
on the side of that

1452
00:48:03,760 --> 00:48:06,079
the funny thing about that is that my

1453
00:48:06,079 --> 00:48:08,240
perception especially in switzerland is

1454
00:48:08,240 --> 00:48:10,160
very different than when working in

1455
00:48:10,160 --> 00:48:13,040
other countries so in switzerland i made

1456
00:48:13,040 --> 00:48:14,480
the experience that clients are very

1457
00:48:14,480 --> 00:48:16,240
relaxed and reasonable that's not always

1458
00:48:16,240 --> 00:48:19,200
the case in incident response

1459
00:48:19,200 --> 00:48:21,920
and uh there it works and otherwise it's

1460
00:48:21,920 --> 00:48:23,359
about it's the

1461
00:48:23,359 --> 00:48:25,200
the client will not be watching you work

1462
00:48:25,200 --> 00:48:27,359
what the client sees is progress

1463
00:48:27,359 --> 00:48:29,040
so what you need to make sure is that

1464
00:48:29,040 --> 00:48:30,640
whenever the client expects progress

1465
00:48:30,640 --> 00:48:32,480
they get to see progress no matter when

1466
00:48:32,480 --> 00:48:35,920
it was made and that could also mean if

1467
00:48:35,920 --> 00:48:36,800
it doesn't

1468
00:48:36,800 --> 00:48:39,200
that the the major uh thing is never

1469
00:48:39,200 --> 00:48:40,800
hurt the client

1470
00:48:40,800 --> 00:48:43,359
but if the client gets crazy that also

1471
00:48:43,359 --> 00:48:45,920
will hurt the client so in a nutshell it

1472
00:48:45,920 --> 00:48:48,640
also might mean dosing information

1473
00:48:48,640 --> 00:48:50,400
right so instead of just throwing

1474
00:48:50,400 --> 00:48:51,680
everything in a client sometimes it

1475
00:48:51,680 --> 00:48:53,440
helps the case to dose the information

1476
00:48:53,440 --> 00:48:55,359
wisely give the right information at the

1477
00:48:55,359 --> 00:48:58,160
right time not not basically over flat

1478
00:48:58,160 --> 00:48:59,680
the client

1479
00:48:59,680 --> 00:49:02,480
that is what helps there

1480
00:49:02,480 --> 00:49:06,160
we have time for two more questions

1481
00:49:07,520 --> 00:49:08,960
yeah thank you very much for those

1482
00:49:08,960 --> 00:49:11,280
awesome talk um i have two quick

1483
00:49:11,280 --> 00:49:13,520
questions hopefully first is

1484
00:49:13,520 --> 00:49:14,880
yeah it's interesting hearing your

1485
00:49:14,880 --> 00:49:16,480
experience building a team and getting

1486
00:49:16,480 --> 00:49:19,119
that all set up and sorted uh we're in

1487
00:49:19,119 --> 00:49:22,160
like similar situations typically and

1488
00:49:22,160 --> 00:49:23,920
we're finding it's a bit of a especially

1489
00:49:23,920 --> 00:49:25,520
if you're dealing with a lot of legacy

1490
00:49:25,520 --> 00:49:26,880
baggage and way things were done

1491
00:49:26,880 --> 00:49:29,839
especially with tooling

1492
00:49:29,839 --> 00:49:31,200
we're finding like there's a there's an

1493
00:49:31,200 --> 00:49:33,280
over over tooling in some ways where you

1494
00:49:33,280 --> 00:49:35,440
have so many tools and so many ways you

1495
00:49:35,440 --> 00:49:36,800
know people need to know how to use them

1496
00:49:36,800 --> 00:49:38,240
and they overlap in a lot of ways like

1497
00:49:38,240 --> 00:49:40,160
how do you avoid going down that rabbit

1498
00:49:40,160 --> 00:49:41,599
hole of over tooling and over

1499
00:49:41,599 --> 00:49:43,520
complicating things essentially

1500
00:49:43,520 --> 00:49:44,800
first of all congratulations to building

1501
00:49:44,800 --> 00:49:46,480
your own team that's a lot of fun

1502
00:49:46,480 --> 00:49:48,319
sometimes

1503
00:49:48,319 --> 00:49:50,000
secondly over tooling

1504
00:49:50,000 --> 00:49:52,480
my usual quota on that thing is a fool

1505
00:49:52,480 --> 00:49:54,400
with a tool is still a fool and that is

1506
00:49:54,400 --> 00:49:56,960
what we see very much and i i would like

1507
00:49:56,960 --> 00:49:58,720
to respond with the question based

1508
00:49:58,720 --> 00:50:01,119
approach so if the tool answers specific

1509
00:50:01,119 --> 00:50:02,160
questions

1510
00:50:02,160 --> 00:50:04,880
well then it has its legitimacy right

1511
00:50:04,880 --> 00:50:08,160
in in that case if it doesn't um or it's

1512
00:50:08,160 --> 00:50:09,520
like

1513
00:50:09,520 --> 00:50:11,119
also covered by three other tools then

1514
00:50:11,119 --> 00:50:13,119
you have to make your selection

1515
00:50:13,119 --> 00:50:15,280
but what the i like the question because

1516
00:50:15,280 --> 00:50:16,400
there's one thing that i didn't say

1517
00:50:16,400 --> 00:50:18,480
about that because obviously and i think

1518
00:50:18,480 --> 00:50:20,000
you know that oftentimes you get asked

1519
00:50:20,000 --> 00:50:21,359
by the client hey we bought that super

1520
00:50:21,359 --> 00:50:23,920
expensive tool why don't you use that

1521
00:50:23,920 --> 00:50:27,119
and some organizations too do and the

1522
00:50:27,119 --> 00:50:28,640
problem with that is then they're not as

1523
00:50:28,640 --> 00:50:30,400
efficient because how could you right

1524
00:50:30,400 --> 00:50:32,240
you're used to a certain approach and

1525
00:50:32,240 --> 00:50:34,079
you're only efficient if you use that

1526
00:50:34,079 --> 00:50:36,720
and that is uh some advice that i might

1527
00:50:36,720 --> 00:50:39,040
give you and that is something i said to

1528
00:50:39,040 --> 00:50:41,359
our ceo when i started that

1529
00:50:41,359 --> 00:50:43,599
i said you have to be prepared to turn

1530
00:50:43,599 --> 00:50:45,599
down cases because if we want to be

1531
00:50:45,599 --> 00:50:47,440
successful we do it our way if we have

1532
00:50:47,440 --> 00:50:50,000
to do it in another way we're just

1533
00:50:50,000 --> 00:50:51,839
one like the others right

1534
00:50:51,839 --> 00:50:53,839
and that means that if they don't want

1535
00:50:53,839 --> 00:50:55,359
it that way then well

1536
00:50:55,359 --> 00:50:57,040
try someone else and come back later

1537
00:50:57,040 --> 00:50:58,640
when they fail that's what we did very

1538
00:50:58,640 --> 00:51:00,800
often and they kept coming back trust

1539
00:51:00,800 --> 00:51:03,040
them great cool thanks and second

1540
00:51:03,040 --> 00:51:04,960
question is uh relating to the point you

1541
00:51:04,960 --> 00:51:06,960
made about where companies

1542
00:51:06,960 --> 00:51:09,440
more and more are uh you know

1543
00:51:09,440 --> 00:51:11,200
looking at the the legal stuff and like

1544
00:51:11,200 --> 00:51:12,559
they're looking more and more when an

1545
00:51:12,559 --> 00:51:14,000
incident happens it's very stressful

1546
00:51:14,000 --> 00:51:14,800
obviously

1547
00:51:14,800 --> 00:51:16,240
in some cases kind of for a scapegoat

1548
00:51:16,240 --> 00:51:17,920
for example so you come in and the risk

1549
00:51:17,920 --> 00:51:18,880
for the

1550
00:51:18,880 --> 00:51:20,640
for us is supporting we want to support

1551
00:51:20,640 --> 00:51:22,480
them but if things don't quite go so

1552
00:51:22,480 --> 00:51:23,839
smoothly or well they're looking for

1553
00:51:23,839 --> 00:51:25,280
someone to blame essentially how do we

1554
00:51:25,280 --> 00:51:27,440
reduce that risk of where we are blamed

1555
00:51:27,440 --> 00:51:28,800
where ultimately we're just trying to

1556
00:51:28,800 --> 00:51:30,160
help and support them right and how do

1557
00:51:30,160 --> 00:51:32,400
we reduce our risk exposure from that

1558
00:51:32,400 --> 00:51:34,640
well one of one of the things is um you

1559
00:51:34,640 --> 00:51:36,160
shouldn't deviate too much from the

1560
00:51:36,160 --> 00:51:37,440
industry standard

1561
00:51:37,440 --> 00:51:38,800
that is one thing because that's what

1562
00:51:38,800 --> 00:51:40,640
you're going to be measured so whenever

1563
00:51:40,640 --> 00:51:43,520
for example um i write an expert witness

1564
00:51:43,520 --> 00:51:46,000
report for for court or something for

1565
00:51:46,000 --> 00:51:47,520
for damage

1566
00:51:47,520 --> 00:51:49,119
things

1567
00:51:49,119 --> 00:51:51,680
then my reference is always uh the

1568
00:51:51,680 --> 00:51:53,440
industry standard at the time the

1569
00:51:53,440 --> 00:51:55,599
knowledge at that time i can compare i

1570
00:51:55,599 --> 00:51:57,200
just recently wrote something for for

1571
00:51:57,200 --> 00:51:59,680
for an incident that happened in 2019

1572
00:51:59,680 --> 00:52:02,160
um so the organization got on site they

1573
00:52:02,160 --> 00:52:04,160
charged like 10 000 a day for one person

1574
00:52:04,160 --> 00:52:06,880
which is quite a lot they got inside um

1575
00:52:06,880 --> 00:52:08,319
they investigated until friday and

1576
00:52:08,319 --> 00:52:10,079
friday they said you're clean now

1577
00:52:10,079 --> 00:52:12,079
on sunday they were fully encrypted

1578
00:52:12,079 --> 00:52:14,000
and so we're looking at day one right

1579
00:52:14,000 --> 00:52:16,880
knowledge of 2019. um they knew because

1580
00:52:16,880 --> 00:52:18,400
they had it in their daily report that

1581
00:52:18,400 --> 00:52:21,200
at this day they had uh emoted on one of

1582
00:52:21,200 --> 00:52:23,119
the domain controllers 2019 remember

1583
00:52:23,119 --> 00:52:25,200
sodino kiwi emotric but all that stuff

1584
00:52:25,200 --> 00:52:27,680
was was on that that time

1585
00:52:27,680 --> 00:52:29,920
and i found from that vendor i found a

1586
00:52:29,920 --> 00:52:31,440
blog article no actually it was a

1587
00:52:31,440 --> 00:52:34,480
webcast like two or three weeks prior to

1588
00:52:34,480 --> 00:52:37,680
that event where they said exactly

1589
00:52:37,680 --> 00:52:39,520
that's all nowadays it's always related

1590
00:52:39,520 --> 00:52:41,839
to those ransomware attacks right

1591
00:52:41,839 --> 00:52:43,760
so that means they didn't act after

1592
00:52:43,760 --> 00:52:46,640
after what they set themselves right and

1593
00:52:46,640 --> 00:52:48,559
that's the ideal thing right so you have

1594
00:52:48,559 --> 00:52:50,319
to basically just align to the industry

1595
00:52:50,319 --> 00:52:52,319
standard then they can't they can still

1596
00:52:52,319 --> 00:52:54,000
blame you but they cannot hurt you too

1597
00:52:54,000 --> 00:52:55,119
much

1598
00:52:55,119 --> 00:52:56,880
you can always say that this is it was

1599
00:52:56,880 --> 00:53:00,720
this was normal back then

1600
00:53:00,720 --> 00:53:02,400
so we are a bit limited for more

1601
00:53:02,400 --> 00:53:04,079
questions so i invite you to come

1602
00:53:04,079 --> 00:53:06,000
directly to matthias if you have any

1603
00:53:06,000 --> 00:53:07,680
more questions thank you thank you

1604
00:53:07,680 --> 00:53:11,160
matthias thank you

