1
00:00:06,810 --> 00:00:10,570
[Music]

2
00:00:12,879 --> 00:00:21,939
thank you this is actually my my second

3
00:00:18,080 --> 00:00:26,630
<font color="#CCCCCC">talk poor insomnia</font><font color="#E5E5E5"> I was here last</font><font color="#CCCCCC"> year</font>

4
00:00:21,939 --> 00:00:27,919
who attended my<font color="#E5E5E5"> top last year Oh most of</font>

5
00:00:26,630 --> 00:00:30,470
<font color="#E5E5E5">them are not here</font><font color="#CCCCCC"> anymore</font><font color="#E5E5E5"> because</font>

6
00:00:27,919 --> 00:00:33,740
probably they need they need<font color="#CCCCCC"> more coffee</font>

7
00:00:30,470 --> 00:00:36,589
<font color="#E5E5E5">and so I hope you had a good copy for</font>

8
00:00:33,740 --> 00:00:42,080
today I put<font color="#E5E5E5"> because you might need it at</font>

9
00:00:36,590 --> 00:00:45,400
the<font color="#E5E5E5"> middle of the slides ready</font><font color="#CCCCCC"> okay we</font>

10
00:00:42,080 --> 00:00:49,690
<font color="#E5E5E5">are going to talk about mostly</font><font color="#CCCCCC"> a</font>

11
00:00:45,400 --> 00:00:53,629
ransomware<font color="#E5E5E5"> name petia happier the</font><font color="#CCCCCC"> petia</font>

12
00:00:49,690 --> 00:00:56,510
yeah<font color="#E5E5E5"> anybody anyone that</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> Speicher</font>

13
00:00:53,630 --> 00:00:59,840
<font color="#E5E5E5">will know that it is have some some sort</font>

14
00:00:56,510 --> 00:01:03,650
<font color="#E5E5E5">of scare tactics</font><font color="#CCCCCC"> and so on but I'm</font><font color="#E5E5E5"> not</font>

15
00:00:59,840 --> 00:01:05,479
gonna<font color="#E5E5E5"> focus on the attackers or how they</font>

16
00:01:03,650 --> 00:01:09,110
do that what I'm going<font color="#CCCCCC"> to do is I'm</font>

17
00:01:05,479 --> 00:01:11,990
going<font color="#CCCCCC"> to look on how we can debug the</font>

18
00:01:09,110 --> 00:01:14,289
boot process<font color="#E5E5E5"> impacted by petia okay so</font>

19
00:01:11,990 --> 00:01:19,160
much<font color="#E5E5E5"> for</font><font color="#CCCCCC"> the before we do the technical</font>

20
00:01:14,290 --> 00:01:21,820
<font color="#E5E5E5">stop let's do some introduction I work</font>

21
00:01:19,160 --> 00:01:24,908
at<font color="#CCCCCC"> Port</font><font color="#E5E5E5"> Annette that's what we had</font>

22
00:01:21,820 --> 00:01:29,389
<font color="#E5E5E5">sponsored port for yesterday lunch</font>

23
00:01:24,909 --> 00:01:31,700
that's the the<font color="#CCCCCC"> bender pitch</font><font color="#E5E5E5"> he published</font>

24
00:01:29,390 --> 00:01:34,610
<font color="#CCCCCC">actually some articles</font><font color="#E5E5E5"> in bars bulletin</font>

25
00:01:31,700 --> 00:01:37,880
about<font color="#E5E5E5"> malware research and mostly I</font>

26
00:01:34,610 --> 00:01:40,850
wrote articles<font color="#E5E5E5"> also in our in our blood</font>

27
00:01:37,880 --> 00:01:43,130
<font color="#CCCCCC">okay those are some of my conferences</font>

28
00:01:40,850 --> 00:01:48,020
I've made some like conference matrix

29
00:01:43,130 --> 00:01:48,949
mostly<font color="#E5E5E5"> my profile pic is that guy but</font>

30
00:01:48,020 --> 00:01:51,048
when I do

31
00:01:48,950 --> 00:01:54,500
<font color="#CCCCCC">malware reversing</font><font color="#E5E5E5"> this is my last</font><font color="#CCCCCC"> major</font>

32
00:01:51,049 --> 00:01:58,180
<font color="#CCCCCC">class last</font><font color="#E5E5E5"> year</font><font color="#CCCCCC"> to it was</font><font color="#E5E5E5"> actually and</font>

33
00:01:54,500 --> 00:02:01,520
this guy deep inside when you do like

34
00:01:58,180 --> 00:02:04,280
reversing here<font color="#CCCCCC"> actually trying to look</font>

35
00:02:01,520 --> 00:02:07,149
<font color="#CCCCCC">like Batman oh I think</font><font color="#E5E5E5"> it's not Batman</font>

36
00:02:04,280 --> 00:02:10,158
anyway<font color="#E5E5E5"> okay before we talk on the</font>

37
00:02:07,149 --> 00:02:12,170
technical aspect of my presentation we

38
00:02:10,158 --> 00:02:16,159
try to talk about some<font color="#CCCCCC"> three BS</font>

39
00:02:12,170 --> 00:02:19,238
<font color="#CCCCCC">k be poor</font><font color="#E5E5E5"> way way a lot very long time</font>

40
00:02:16,159 --> 00:02:19,239
<font color="#E5E5E5">ago we use those things</font>

41
00:02:19,520 --> 00:02:25,490
<font color="#CCCCCC">kid anybody those are plopping this</font><font color="#E5E5E5"> were</font>

42
00:02:22,850 --> 00:02:27,470
in<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> they're called floppy because</font>

43
00:02:25,490 --> 00:02:30,980
they are kinda<font color="#E5E5E5"> you can actually bend</font>

44
00:02:27,470 --> 00:02:32,930
them okay and then but before<font color="#CCCCCC"> we have</font>

45
00:02:30,980 --> 00:02:36,619
<font color="#E5E5E5">that those are only</font><font color="#CCCCCC"> imagined you cannot</font>

46
00:02:32,930 --> 00:02:39,170
even<font color="#E5E5E5"> put an mp3 songs inside one of</font>

47
00:02:36,620 --> 00:02:41,240
<font color="#E5E5E5">those things but before we have games</font>

48
00:02:39,170 --> 00:02:43,579
and everything<font color="#CCCCCC"> we</font><font color="#E5E5E5"> have we have the</font>

49
00:02:41,240 --> 00:02:50,060
operating<font color="#E5E5E5"> system and so on and so forth</font>

50
00:02:43,580 --> 00:02:53,840
<font color="#CCCCCC">okay and IBM created</font><font color="#E5E5E5"> a one gigabyte hard</font>

51
00:02:50,060 --> 00:02:57,380
drive<font color="#E5E5E5"> in 1980 it is actually 75 pounds</font>

52
00:02:53,840 --> 00:03:02,840
imagine if you<font color="#CCCCCC"> wear</font><font color="#E5E5E5"> that hard drive</font><font color="#CCCCCC"> k</font>

53
00:02:57,380 --> 00:03:05,359
like if you had this 256 gigabytes<font color="#E5E5E5"> x</font>

54
00:03:02,840 --> 00:03:07,700
<font color="#E5E5E5">that one imagine you probably cannot</font>

55
00:03:05,360 --> 00:03:11,240
<font color="#CCCCCC">catwalk or you cannot even put them in</font>

56
00:03:07,700 --> 00:03:13,760
your car<font color="#E5E5E5"> so those are the evolution of</font>

57
00:03:11,240 --> 00:03:17,480
<font color="#E5E5E5">some of the our</font><font color="#CCCCCC"> technologists now we can</font>

58
00:03:13,760 --> 00:03:19,790
actually have like pipe terabytes<font color="#E5E5E5"> and so</font>

59
00:03:17,480 --> 00:03:23,239
on and support<font color="#CCCCCC"> where one one time when</font>

60
00:03:19,790 --> 00:03:26,390
during my college years<font color="#E5E5E5"> so many years</font>

61
00:03:23,240 --> 00:03:28,070
<font color="#CCCCCC">ago k we went to a conference were in we</font>

62
00:03:26,390 --> 00:03:33,559
went<font color="#E5E5E5"> to like exhibits</font><font color="#CCCCCC"> wherein they</font>

63
00:03:28,070 --> 00:03:35,450
showed us a much box<font color="#E5E5E5"> size 1 gigabyte</font><font color="#CCCCCC"> k</font>

64
00:03:33,560 --> 00:03:38,570
is like it's a very<font color="#E5E5E5"> impressive</font>

65
00:03:35,450 --> 00:03:41,209
technology<font color="#E5E5E5"> but now you can</font><font color="#CCCCCC"> actually hold</font>

66
00:03:38,570 --> 00:03:44,989
it in your in your keychain<font color="#CCCCCC"> okay but</font>

67
00:03:41,210 --> 00:03:48,230
even<font color="#CCCCCC"> though it it bulbs so much</font><font color="#E5E5E5"> they</font>

68
00:03:44,990 --> 00:03:50,930
<font color="#E5E5E5">always have what we call trap</font><font color="#CCCCCC"> zero</font><font color="#E5E5E5"> head</font>

69
00:03:48,230 --> 00:03:54,200
<font color="#CCCCCC">zero sector</font><font color="#E5E5E5"> one which is the very first</font>

70
00:03:50,930 --> 00:03:56,360
<font color="#CCCCCC">sector even in floppy or hard drive and</font>

71
00:03:54,200 --> 00:03:58,609
if you are<font color="#E5E5E5"> talking</font><font color="#CCCCCC"> about the hard drive</font>

72
00:03:56,360 --> 00:04:01,640
we have<font color="#E5E5E5"> what we call</font><font color="#CCCCCC"> the Master Boot</font>

73
00:03:58,610 --> 00:04:03,680
Record<font color="#CCCCCC"> even this one they</font><font color="#E5E5E5"> have the</font>

74
00:04:01,640 --> 00:04:09,190
Master Boot Record<font color="#E5E5E5"> it is always the very</font>

75
00:04:03,680 --> 00:04:14,240
per sector<font color="#CCCCCC"> we have what</font><font color="#E5E5E5"> we call now the</font>

76
00:04:09,190 --> 00:04:18,170
UEFI<font color="#E5E5E5"> that uses the GP p GP t and mb ER</font>

77
00:04:14,240 --> 00:04:22,070
<font color="#E5E5E5">they are</font><font color="#CCCCCC"> kinda different but in reality</font>

78
00:04:18,170 --> 00:04:25,130
they<font color="#CCCCCC"> are still a</font><font color="#E5E5E5"> bicycle drive</font><font color="#CCCCCC"> okay GPT</font>

79
00:04:22,070 --> 00:04:27,080
has what we<font color="#CCCCCC"> have what</font><font color="#E5E5E5"> we call the the</font>

80
00:04:25,130 --> 00:04:30,229
<font color="#E5E5E5">per sector is still what we call the</font>

81
00:04:27,080 --> 00:04:33,200
protective MBR<font color="#CCCCCC"> it is still an MBR</font><font color="#E5E5E5"> but it</font>

82
00:04:30,229 --> 00:04:36,710
is for just backward compatibility<font color="#E5E5E5"> okay</font>

83
00:04:33,200 --> 00:04:39,320
MBA is the<font color="#E5E5E5"> berry purse very per sector</font>

84
00:04:36,710 --> 00:04:42,940
in in a regular<font color="#CCCCCC"> Drive hard</font><font color="#E5E5E5"> drive</font>

85
00:04:39,320 --> 00:04:46,700
Kate uses the standard<font color="#CCCCCC"> BIOS GPT uses</font>

86
00:04:42,940 --> 00:04:50,180
UEFI<font color="#CCCCCC"> okay but they</font><font color="#E5E5E5"> both have the MBR</font>

87
00:04:46,700 --> 00:04:53,780
<font color="#CCCCCC">capered the GPT</font><font color="#E5E5E5"> the second and last</font>

88
00:04:50,180 --> 00:04:56,900
sectors holds the GPT headers<font color="#CCCCCC"> okay</font>

89
00:04:53,780 --> 00:05:00,229
they are some sort<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> replacement</font>

90
00:04:56,900 --> 00:05:02,719
for<font color="#E5E5E5"> the MBR ski so we have the per</font>

91
00:05:00,230 --> 00:05:05,390
sector is the MBR protective MBR the

92
00:05:02,720 --> 00:05:08,270
second<font color="#CCCCCC"> sector is actually the GPT</font>

93
00:05:05,390 --> 00:05:13,940
headers and it is mirrored<font color="#E5E5E5"> for the last</font>

94
00:05:08,270 --> 00:05:16,070
<font color="#CCCCCC">sector they are</font><font color="#E5E5E5"> the same okay let's see</font>

95
00:05:13,940 --> 00:05:19,760
<font color="#CCCCCC">now if we</font><font color="#E5E5E5"> can we can create how to</font>

96
00:05:16,070 --> 00:05:21,440
create an GPT<font color="#E5E5E5"> and MBR in your in your</font>

97
00:05:19,760 --> 00:05:24,469
Windows operating system using this

98
00:05:21,440 --> 00:05:28,580
management<font color="#CCCCCC"> ok you can see this you can</font>

99
00:05:24,470 --> 00:05:33,110
<font color="#CCCCCC">actually initialize this ok</font><font color="#E5E5E5"> and then you</font>

100
00:05:28,580 --> 00:05:36,320
can tell if you're creating an MBR<font color="#CCCCCC"> or a</font>

101
00:05:33,110 --> 00:05:38,360
<font color="#CCCCCC">GPP ok you</font><font color="#E5E5E5"> just have to click those</font>

102
00:05:36,320 --> 00:05:40,880
buttons and<font color="#E5E5E5"> so on</font><font color="#CCCCCC"> air support</font><font color="#E5E5E5"> and then</font>

103
00:05:38,360 --> 00:05:42,890
if you if in the meantime you<font color="#E5E5E5"> you want</font>

104
00:05:40,880 --> 00:05:44,830
to to change<font color="#E5E5E5"> them for example</font><font color="#CCCCCC"> you</font>

105
00:05:42,890 --> 00:05:47,659
decided oh I'm going<font color="#E5E5E5"> to use actually a</font>

106
00:05:44,830 --> 00:05:49,760
UEFI are you going to use the GPT but

107
00:05:47,660 --> 00:05:52,160
you already<font color="#E5E5E5"> have the MBR using the same</font>

108
00:05:49,760 --> 00:05:57,500
tool<font color="#E5E5E5"> this management you can actually</font>

109
00:05:52,160 --> 00:06:00,110
<font color="#E5E5E5">convert them to GPT to MBR and mb r to</font>

110
00:05:57,500 --> 00:06:02,750
<font color="#E5E5E5">DVD the</font><font color="#CCCCCC"> vice versa</font><font color="#E5E5E5"> those are just those</font>

111
00:06:00,110 --> 00:06:04,850
are this is the<font color="#CCCCCC"> dis</font><font color="#E5E5E5"> management that is</font>

112
00:06:02,750 --> 00:06:08,120
the<font color="#CCCCCC"> two that</font><font color="#E5E5E5"> exists in Windows operating</font>

113
00:06:04,850 --> 00:06:10,130
system which most of you probably is not

114
00:06:08,120 --> 00:06:16,130
using<font color="#CCCCCC"> because you're all Linux guys</font>

115
00:06:10,130 --> 00:06:18,500
mostly<font color="#CCCCCC"> Capel creating at this partition</font>

116
00:06:16,130 --> 00:06:21,800
<font color="#CCCCCC">ok the only problem that exists before</font>

117
00:06:18,500 --> 00:06:25,160
<font color="#E5E5E5">if you create a partition in MBR style</font>

118
00:06:21,800 --> 00:06:26,900
<font color="#E5E5E5">you can only create poor specific</font>

119
00:06:25,160 --> 00:06:29,720
partition if you want to create<font color="#E5E5E5"> more</font>

120
00:06:26,900 --> 00:06:32,599
<font color="#E5E5E5">partition it is now called logical</font>

121
00:06:29,720 --> 00:06:36,680
drives it is not directly a physical

122
00:06:32,600 --> 00:06:40,160
partition<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> son like this ok if this</font>

123
00:06:36,680 --> 00:06:42,290
one is your MBR<font color="#E5E5E5"> ok you can only create</font>

124
00:06:40,160 --> 00:06:44,870
poor partition and then this is actually

125
00:06:42,290 --> 00:06:47,030
<font color="#E5E5E5">one big partition but it contains</font>

126
00:06:44,870 --> 00:06:50,930
extended partition which we go

127
00:06:47,030 --> 00:06:53,869
logical drives<font color="#E5E5E5"> but poor GPT this okay</font>

128
00:06:50,930 --> 00:06:56,090
<font color="#E5E5E5">you can actually have GPT and</font><font color="#CCCCCC"> ambien</font>

129
00:06:53,870 --> 00:06:58,520
that<font color="#CCCCCC"> exists in one in one operating</font>

130
00:06:56,090 --> 00:07:02,570
system in one computer<font color="#CCCCCC"> okay you</font><font color="#E5E5E5"> can</font>

131
00:06:58,520 --> 00:07:06,229
actually<font color="#E5E5E5"> create as much partition as you</font>

132
00:07:02,570 --> 00:07:08,150
want<font color="#E5E5E5"> the limitation is is the size of</font>

133
00:07:06,230 --> 00:07:10,970
the partition is the size<font color="#E5E5E5"> of</font><font color="#CCCCCC"> your hard</font>

134
00:07:08,150 --> 00:07:13,789
drive<font color="#CCCCCC"> why do we do partitions sometimes</font>

135
00:07:10,970 --> 00:07:16,820
it is useful<font color="#E5E5E5"> to make accessing of your</font>

136
00:07:13,790 --> 00:07:19,060
drive faster<font color="#E5E5E5"> but because of the advent</font>

137
00:07:16,820 --> 00:07:21,860
of newer machines newer computers

138
00:07:19,060 --> 00:07:23,750
sometimes you<font color="#E5E5E5"> don't normally create</font>

139
00:07:21,860 --> 00:07:28,310
partitions in your hard drive<font color="#E5E5E5"> even my</font>

140
00:07:23,750 --> 00:07:30,830
computer doesn't have partitions using

141
00:07:28,310 --> 00:07:33,320
<font color="#E5E5E5">this part it is a</font><font color="#CCCCCC"> command-line</font><font color="#E5E5E5"> tool it</font>

142
00:07:30,830 --> 00:07:37,250
<font color="#E5E5E5">just shows you a purin that just shows</font>

143
00:07:33,320 --> 00:07:40,340
<font color="#E5E5E5">you which this our GPT if you have the</font>

144
00:07:37,250 --> 00:07:42,860
asterisk then it is actually a GPT just

145
00:07:40,340 --> 00:07:46,880
<font color="#CCCCCC">have to run this part ok that's the</font><font color="#E5E5E5"> only</font>

146
00:07:42,860 --> 00:07:49,970
purpose of the disks point<font color="#CCCCCC"> ok let's go</font>

147
00:07:46,880 --> 00:07:53,270
<font color="#CCCCCC">now to the structure</font><font color="#E5E5E5"> of the</font><font color="#CCCCCC"> disks</font><font color="#E5E5E5"> if</font>

148
00:07:49,970 --> 00:07:57,710
you're going to use MBR<font color="#CCCCCC"> ok we call</font><font color="#E5E5E5"> each</font>

149
00:07:53,270 --> 00:08:00,469
sector with<font color="#CCCCCC"> the</font><font color="#E5E5E5"> CH 0 the cylinder head</font>

150
00:07:57,710 --> 00:08:04,940
and<font color="#E5E5E5"> SEC door</font><font color="#CCCCCC"> the this one is definitely</font>

151
00:08:00,470 --> 00:08:07,520
<font color="#CCCCCC">developer sector and this one is the</font>

152
00:08:04,940 --> 00:08:12,230
very<font color="#CCCCCC"> first sector</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> AM MBR</font><font color="#E5E5E5"> but we</font>

153
00:08:07,520 --> 00:08:15,590
call them<font color="#CCCCCC"> LBA ok instead of</font><font color="#E5E5E5"> CHS and</font>

154
00:08:12,230 --> 00:08:17,750
there is some sort<font color="#E5E5E5"> of computation basing</font>

155
00:08:15,590 --> 00:08:21,289
up for example<font color="#CCCCCC"> you're talking about</font><font color="#E5E5E5"> MBR</font>

156
00:08:17,750 --> 00:08:24,320
which is the<font color="#E5E5E5"> very</font><font color="#CCCCCC"> first logical block</font>

157
00:08:21,290 --> 00:08:26,060
<font color="#E5E5E5">addressing 0 and then the CHS is the</font>

158
00:08:24,320 --> 00:08:28,640
ambient<font color="#CCCCCC"> then</font><font color="#E5E5E5"> so and support just a</font>

159
00:08:26,060 --> 00:08:30,980
different combination but still they we

160
00:08:28,640 --> 00:08:35,150
<font color="#E5E5E5">are talking of sectors and we are</font>

161
00:08:30,980 --> 00:08:37,510
talking<font color="#CCCCCC"> of physical</font><font color="#E5E5E5"> drive let's go</font><font color="#CCCCCC"> on</font>

162
00:08:35,150 --> 00:08:41,990
<font color="#CCCCCC">out to the malware</font>

163
00:08:37,510 --> 00:08:44,750
petia<font color="#E5E5E5"> is a malware</font><font color="#CCCCCC"> were in</font><font color="#E5E5E5"> its strike</font>

164
00:08:41,990 --> 00:08:47,780
similar to different kind of ransomware

165
00:08:44,750 --> 00:08:51,020
capers to avoid detection<font color="#CCCCCC"> it has it has</font>

166
00:08:47,780 --> 00:08:54,350
to generate regenerate its<font color="#E5E5E5"> executable</font>

167
00:08:51,020 --> 00:08:58,579
image in the memory<font color="#CCCCCC"> ok it runs</font><font color="#E5E5E5"> through</font>

168
00:08:54,350 --> 00:09:01,010
this process<font color="#CCCCCC"> this set of codes are only</font>

169
00:08:58,580 --> 00:09:04,670
decrypting a simple<font color="#CCCCCC"> D word it will</font>

170
00:09:01,010 --> 00:09:06,010
go back<font color="#E5E5E5"> look</font><font color="#CCCCCC"> back</font><font color="#E5E5E5"> they</font><font color="#CCCCCC"> cribs</font><font color="#E5E5E5"> another</font><font color="#CCCCCC"> D</font>

171
00:09:04,670 --> 00:09:09,490
<font color="#CCCCCC">word and so on and so forth until</font>

172
00:09:06,010 --> 00:09:10,670
everything is decrypted to the<font color="#E5E5E5"> memory</font>

173
00:09:09,490 --> 00:09:14,389
<font color="#E5E5E5">okay</font>

174
00:09:10,670 --> 00:09:16,880
when we run petia<font color="#E5E5E5"> it checks for the</font><font color="#CCCCCC"> NCAP</font>

175
00:09:14,389 --> 00:09:21,380
<font color="#E5E5E5">marker to make sure that it is actually</font>

176
00:09:16,880 --> 00:09:23,180
<font color="#E5E5E5">running the</font><font color="#CCCCCC"> actual copy of itself</font><font color="#E5E5E5"> okay</font>

177
00:09:21,380 --> 00:09:25,610
if<font color="#E5E5E5"> you're going to look into the actual</font>

178
00:09:23,180 --> 00:09:28,040
<font color="#E5E5E5">code</font><font color="#CCCCCC"> at first</font><font color="#E5E5E5"> it generates it tries to</font>

179
00:09:25,610 --> 00:09:31,190
<font color="#E5E5E5">resolve its</font><font color="#CCCCCC"> ApS</font><font color="#E5E5E5"> that it needs okay</font>

180
00:09:28,040 --> 00:09:34,339
because hiding the those<font color="#E5E5E5"> ap as it tries</font>

181
00:09:31,190 --> 00:09:36,680
to<font color="#E5E5E5"> hide from antivirus detection okay</font>

182
00:09:34,339 --> 00:09:40,490
that's why they try to resolve it<font color="#E5E5E5"> later</font>

183
00:09:36,680 --> 00:09:43,000
on<font color="#E5E5E5"> after</font><font color="#CCCCCC"> the decryption</font><font color="#E5E5E5"> okay and then</font>

184
00:09:40,490 --> 00:09:47,209
these<font color="#CCCCCC"> are the common API studied use</font>

185
00:09:43,000 --> 00:09:49,010
basically if<font color="#CCCCCC"> this ApS are exposed</font><font color="#E5E5E5"> the</font>

186
00:09:47,209 --> 00:09:52,069
anti your antivirus oh security system

187
00:09:49,010 --> 00:09:54,290
can easily<font color="#E5E5E5"> tuck them as malicious by</font>

188
00:09:52,070 --> 00:09:59,360
just the combinations of the API<font color="#E5E5E5"> that's</font>

189
00:09:54,290 --> 00:10:01,579
why<font color="#E5E5E5"> they usually hide them okay okay</font>

190
00:09:59,360 --> 00:10:05,260
petia has the this section this section

191
00:10:01,579 --> 00:10:07,099
is very important<font color="#E5E5E5"> it contains this one</font>

192
00:10:05,260 --> 00:10:09,529
the ransom note

193
00:10:07,100 --> 00:10:11,990
it contains the rest of the code<font color="#E5E5E5"> it</font>

194
00:10:09,529 --> 00:10:14,779
checks it the only<font color="#E5E5E5"> the decryption</font>

195
00:10:11,990 --> 00:10:17,480
routine is only this<font color="#E5E5E5"> one X or decryption</font>

196
00:10:14,779 --> 00:10:19,760
<font color="#E5E5E5">it is not very very complicated</font>

197
00:10:17,480 --> 00:10:22,899
the<font color="#CCCCCC"> conjugation</font><font color="#E5E5E5"> goes</font><font color="#CCCCCC"> through any trans</font>

198
00:10:19,760 --> 00:10:26,079
on the on the bias

199
00:10:22,899 --> 00:10:29,420
<font color="#CCCCCC">okay it it</font><font color="#E5E5E5"> looks for the bootable disk</font>

200
00:10:26,079 --> 00:10:31,699
<font color="#CCCCCC">okay in order</font><font color="#E5E5E5"> to to put what happened</font><font color="#CCCCCC"> is</font>

201
00:10:29,420 --> 00:10:33,709
when<font color="#E5E5E5"> you run your</font><font color="#CCCCCC"> Pecha we are in the</font>

202
00:10:31,699 --> 00:10:36,859
<font color="#E5E5E5">Windows</font><font color="#CCCCCC"> system</font><font color="#E5E5E5"> when you run your</font><font color="#CCCCCC"> Pecha</font>

203
00:10:33,709 --> 00:10:38,599
<font color="#CCCCCC">it will look for</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> PETA's escalated</font>

204
00:10:36,860 --> 00:10:42,730
<font color="#E5E5E5">privilege it will look for your physical</font>

205
00:10:38,600 --> 00:10:45,680
<font color="#E5E5E5">drive okay physical</font><font color="#CCCCCC"> drive zero this</font><font color="#E5E5E5"> one</font>

206
00:10:42,730 --> 00:10:47,779
<font color="#CCCCCC">okay and</font><font color="#E5E5E5"> then there is the drive see</font>

207
00:10:45,680 --> 00:10:50,388
usually the first<font color="#E5E5E5"> drive which is the</font>

208
00:10:47,779 --> 00:10:53,180
drive see the first hard drive contains

209
00:10:50,389 --> 00:10:57,470
the MBR<font color="#CCCCCC"> if it is a GPT it contains the</font>

210
00:10:53,180 --> 00:10:59,859
protected MBR<font color="#CCCCCC"> K what happens</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is how</font>

211
00:10:57,470 --> 00:11:02,569
you read<font color="#E5E5E5"> drive see if you want to do</font>

212
00:10:59,860 --> 00:11:04,130
programming if you want to read your MBR

213
00:11:02,569 --> 00:11:06,170
you have to check first<font color="#E5E5E5"> the physical</font>

214
00:11:04,130 --> 00:11:10,550
<font color="#CCCCCC">drive zero which is your very first</font>

215
00:11:06,170 --> 00:11:12,380
drive<font color="#E5E5E5"> if you happen to have able</font><font color="#CCCCCC"> to do a</font>

216
00:11:10,550 --> 00:11:14,750
representation<font color="#CCCCCC"> or</font><font color="#E5E5E5"> for example</font><font color="#CCCCCC"> you make</font>

217
00:11:12,380 --> 00:11:18,140
your drive D as your piece

218
00:11:14,750 --> 00:11:19,820
dr0<font color="#E5E5E5"> still if you happens to have if you</font>

219
00:11:18,140 --> 00:11:21,439
<font color="#E5E5E5">want</font><font color="#CCCCCC"> to access</font><font color="#E5E5E5"> the Barry Perce tribe you</font>

220
00:11:19,820 --> 00:11:26,210
<font color="#CCCCCC">have to access</font><font color="#E5E5E5"> it using the physical</font>

221
00:11:21,440 --> 00:11:29,540
drive<font color="#CCCCCC"> zero and you have to</font><font color="#E5E5E5"> include</font><font color="#CCCCCC"> the</font>

222
00:11:26,210 --> 00:11:32,120
bus<font color="#CCCCCC"> you</font><font color="#E5E5E5"> control API</font><font color="#CCCCCC"> it is wearing it is</font>

223
00:11:29,540 --> 00:11:35,300
the<font color="#CCCCCC"> one that basically access your</font>

224
00:11:32,120 --> 00:11:40,520
physical physical devices like your hard

225
00:11:35,300 --> 00:11:43,819
drive<font color="#CCCCCC"> okay this is how how it gets</font><font color="#E5E5E5"> try</font>

226
00:11:40,520 --> 00:11:45,770
it tries to<font color="#E5E5E5"> check it what what what is</font>

227
00:11:43,820 --> 00:11:49,010
your<font color="#CCCCCC"> physical drive that represents the</font>

228
00:11:45,770 --> 00:11:51,620
drive<font color="#CCCCCC"> zero</font><font color="#E5E5E5"> okay it uses for date checks</font>

229
00:11:49,010 --> 00:11:54,760
for the volume control get<font color="#E5E5E5"> volume this</font>

230
00:11:51,620 --> 00:11:58,130
extents and and those structure

231
00:11:54,760 --> 00:11:59,810
<font color="#E5E5E5">okay the initial call for create file a</font>

232
00:11:58,130 --> 00:12:02,420
<font color="#E5E5E5">in the bus</font><font color="#CCCCCC"> I'll control is just for</font>

233
00:11:59,810 --> 00:12:05,390
checking checking if you<font color="#CCCCCC"> can if the</font>

234
00:12:02,420 --> 00:12:09,020
malware<font color="#E5E5E5"> can access because if you are</font>

235
00:12:05,390 --> 00:12:11,000
actually<font color="#E5E5E5"> doesn't</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> privilege</font><font color="#CCCCCC"> ok the</font>

236
00:12:09,020 --> 00:12:14,030
malware cannot access<font color="#CCCCCC"> your drive</font><font color="#E5E5E5"> 0 that</font>

237
00:12:11,000 --> 00:12:17,180
means it cannot impact<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> if this one</font>

238
00:12:14,030 --> 00:12:19,579
<font color="#E5E5E5">this first check is successful it will</font>

239
00:12:17,180 --> 00:12:21,380
<font color="#E5E5E5">now proceed on the on the infection</font>

240
00:12:19,580 --> 00:12:25,190
<font color="#E5E5E5">first it checks for the physical drive</font>

241
00:12:21,380 --> 00:12:26,900
<font color="#CCCCCC">zero again that's the second time</font><font color="#E5E5E5"> okay</font>

242
00:12:25,190 --> 00:12:29,530
poor physical<font color="#CCCCCC"> drive zero poor backward</font>

243
00:12:26,900 --> 00:12:32,199
backward compatibility it is<font color="#E5E5E5"> also called</font>

244
00:12:29,530 --> 00:12:36,589
dr0<font color="#CCCCCC"> dr1</font>

245
00:12:32,200 --> 00:12:38,839
<font color="#E5E5E5">okay for n-type or of course still again</font>

246
00:12:36,589 --> 00:12:41,960
hardly<font color="#CCCCCC"> 0dr zero this lives are different</font>

247
00:12:38,839 --> 00:12:44,330
<font color="#E5E5E5">ways to to check or to name your</font>

248
00:12:41,960 --> 00:12:46,700
physical drive and to open<font color="#CCCCCC"> or to</font><font color="#E5E5E5"> create</font>

249
00:12:44,330 --> 00:12:50,089
to open<font color="#E5E5E5"> that pile it is actually</font>

250
00:12:46,700 --> 00:12:52,820
considered as a regular pile here MBR<font color="#CCCCCC"> is</font>

251
00:12:50,089 --> 00:12:55,250
considered as a regular regular pile

252
00:12:52,820 --> 00:12:58,490
which is create five physical drives

253
00:12:55,250 --> 00:13:01,820
here and then<font color="#E5E5E5"> call the device</font><font color="#CCCCCC"> I control</font>

254
00:12:58,490 --> 00:13:04,400
later<font color="#E5E5E5"> right you can actually use win obj</font>

255
00:13:01,820 --> 00:13:06,950
it is actually another tool<font color="#CCCCCC"> wherein you</font>

256
00:13:04,400 --> 00:13:10,069
can<font color="#CCCCCC"> actually tell which of your with</font>

257
00:13:06,950 --> 00:13:13,700
which of<font color="#E5E5E5"> which way your operating system</font>

258
00:13:10,070 --> 00:13:18,080
<font color="#E5E5E5">is calling your physical drive zero are</font>

259
00:13:13,700 --> 00:13:20,750
still with<font color="#E5E5E5"> me hey</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> is wind</font><font color="#CCCCCC"> obj</font>

260
00:13:18,080 --> 00:13:23,420
that's the tool<font color="#E5E5E5"> okay now this is not</font><font color="#CCCCCC"> the</font>

261
00:13:20,750 --> 00:13:26,260
how the malware<font color="#E5E5E5"> after the calls the</font>

262
00:13:23,420 --> 00:13:28,699
physical drive 0 so it is calling

263
00:13:26,260 --> 00:13:31,970
physical<font color="#E5E5E5"> drive</font><font color="#CCCCCC"> zero</font>

264
00:13:28,700 --> 00:13:34,730
<font color="#E5E5E5">okay by using create file and palette by</font>

265
00:13:31,970 --> 00:13:38,750
device IO control<font color="#E5E5E5"> okay this particular</font>

266
00:13:34,730 --> 00:13:44,090
<font color="#CCCCCC">code</font><font color="#E5E5E5"> for the</font><font color="#CCCCCC"> IO control it checks</font><font color="#E5E5E5"> a PR</font>

267
00:13:38,750 --> 00:13:47,900
you see MBR or GPT hey why wait why the

268
00:13:44,090 --> 00:13:50,510
<font color="#CCCCCC">malware</font><font color="#E5E5E5"> needs to check if it is MBR IGBT</font>

269
00:13:47,900 --> 00:13:54,020
because it will try to<font color="#E5E5E5"> embarrass GPT it</font>

270
00:13:50,510 --> 00:13:56,900
will try to<font color="#E5E5E5"> override the the berry purse</font>

271
00:13:54,020 --> 00:13:59,840
the remember that<font color="#E5E5E5"> GPT has the protected</font>

272
00:13:56,900 --> 00:14:01,760
and BR and then GPT headers from<font color="#CCCCCC"> the</font>

273
00:13:59,840 --> 00:14:03,920
front<font color="#E5E5E5"> and at the back of your drive</font><font color="#CCCCCC"> so</font>

274
00:14:01,760 --> 00:14:10,640
<font color="#CCCCCC">it will actually operate</font><font color="#E5E5E5"> power of them</font>

275
00:14:03,920 --> 00:14:12,620
<font color="#CCCCCC">ok later on so</font><font color="#E5E5E5"> this is the this</font><font color="#CCCCCC"> is how</font>

276
00:14:10,640 --> 00:14:14,630
<font color="#E5E5E5">it checks these are the informations you</font>

277
00:14:12,620 --> 00:14:19,700
<font color="#CCCCCC">can actually google it you can actually</font>

278
00:14:14,630 --> 00:14:21,590
<font color="#E5E5E5">find it in the MSDN</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> using process</font>

279
00:14:19,700 --> 00:14:25,250
<font color="#CCCCCC">Mart or it is another tool coming from</font>

280
00:14:21,590 --> 00:14:28,280
sysinternals<font color="#CCCCCC"> you can actually monitor up</font>

281
00:14:25,250 --> 00:14:31,580
your system<font color="#E5E5E5"> if your hard this is being</font>

282
00:14:28,280 --> 00:14:35,030
<font color="#E5E5E5">written to</font><font color="#CCCCCC"> ok it is using create by</font><font color="#E5E5E5"> a</font>

283
00:14:31,580 --> 00:14:38,000
<font color="#E5E5E5">radical in this it is using</font><font color="#CCCCCC"> crate pile</font>

284
00:14:35,030 --> 00:14:40,640
<font color="#CCCCCC">and device IO control</font><font color="#E5E5E5"> you can see that</font>

285
00:14:38,000 --> 00:14:51,010
it is<font color="#E5E5E5"> trying to access your physical</font>

286
00:14:40,640 --> 00:14:51,010
drive drive<font color="#E5E5E5"> 0 and now the the infection</font>

287
00:14:51,040 --> 00:14:59,060
the malware reads the MBR sector<font color="#E5E5E5"> 0</font><font color="#CCCCCC"> a</font>

288
00:14:55,570 --> 00:15:03,470
series<font color="#E5E5E5"> of instructions were in it tries</font>

289
00:14:59,060 --> 00:15:09,079
to to encrypt<font color="#E5E5E5"> your original MBR by by</font>

290
00:15:03,470 --> 00:15:11,630
just exhorting it with 37<font color="#CCCCCC"> 0 X 37 it</font><font color="#E5E5E5"> the</font>

291
00:15:09,080 --> 00:15:14,240
process is it creates it opens the the

292
00:15:11,630 --> 00:15:17,480
hard drive<font color="#E5E5E5"> using great path it says the</font>

293
00:15:14,240 --> 00:15:19,220
file pointer<font color="#E5E5E5"> to a particular sector</font><font color="#CCCCCC"> K</font>

294
00:15:17,480 --> 00:15:21,680
<font color="#E5E5E5">read the file read that means reading</font>

295
00:15:19,220 --> 00:15:24,200
<font color="#E5E5E5">the contents of the sector</font><font color="#CCCCCC"> X or it</font><font color="#E5E5E5"> it</font>

296
00:15:21,680 --> 00:15:26,660
opens<font color="#E5E5E5"> again and then writes the</font>

297
00:15:24,200 --> 00:15:31,370
encrypted<font color="#CCCCCC"> version to your to your</font>

298
00:15:26,660 --> 00:15:34,010
<font color="#E5E5E5">sectors ok and followed by copy writing</font>

299
00:15:31,370 --> 00:15:38,710
something or the new MBR which is the

300
00:15:34,010 --> 00:15:41,900
malware<font color="#CCCCCC"> kernel mode</font><font color="#E5E5E5"> and then after that</font>

301
00:15:38,710 --> 00:15:42,649
because<font color="#CCCCCC"> 1 mb o the MBR is</font><font color="#E5E5E5"> only one</font>

302
00:15:41,900 --> 00:15:45,290
<font color="#E5E5E5">sector it</font><font color="#CCCCCC"> is</font>

303
00:15:42,649 --> 00:15:48,860
not enough to to put<font color="#E5E5E5"> everything else</font>

304
00:15:45,290 --> 00:15:50,990
<font color="#CCCCCC">okay so</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> is starting at sector 22</font><font color="#E5E5E5"> it</font>

305
00:15:48,860 --> 00:15:56,660
will write the rest of the kernel kernel

306
00:15:50,990 --> 00:16:00,079
code<font color="#E5E5E5"> okay or just</font><font color="#CCCCCC"> for the MBR format</font>

307
00:15:56,660 --> 00:16:02,360
<font color="#E5E5E5">okay this is the MBR the MBR is actually</font>

308
00:16:00,079 --> 00:16:04,758
the boot sector contains usually the

309
00:16:02,360 --> 00:16:07,490
pipe pipe a a to make sure that it is

310
00:16:04,759 --> 00:16:10,369
<font color="#E5E5E5">the MBR</font><font color="#CCCCCC"> and then the rest are contains</font>

311
00:16:07,490 --> 00:16:12,949
this<font color="#CCCCCC"> okay if you have poor partitions</font>

312
00:16:10,369 --> 00:16:16,369
for your MBR<font color="#E5E5E5"> it will be written in the</font>

313
00:16:12,949 --> 00:16:19,368
MBR<font color="#E5E5E5"> format</font><font color="#CCCCCC"> okay but normally this one it</font>

314
00:16:16,369 --> 00:16:21,559
will<font color="#CCCCCC"> be overwritten by</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> MB by the</font>

315
00:16:19,369 --> 00:16:24,679
malware<font color="#CCCCCC"> okay but it is being copied</font><font color="#E5E5E5"> the</font>

316
00:16:21,559 --> 00:16:28,129
original MBR<font color="#E5E5E5"> or the protected MBR</font><font color="#CCCCCC"> is</font>

317
00:16:24,679 --> 00:16:30,679
also copied<font color="#E5E5E5"> to a certain sector</font><font color="#CCCCCC"> Spore</font><font color="#E5E5E5"> if</font>

318
00:16:28,129 --> 00:16:35,779
you happen to pay for the ransom note

319
00:16:30,679 --> 00:16:39,259
<font color="#E5E5E5">for the ransomware okay okay this is the</font>

320
00:16:35,779 --> 00:16:42,110
checking<font color="#CCCCCC"> this is your process monitor</font>

321
00:16:39,259 --> 00:16:44,869
wherein it tells you which particular

322
00:16:42,110 --> 00:16:47,179
<font color="#CCCCCC">offset is being written tree being</font><font color="#E5E5E5"> read</font>

323
00:16:44,869 --> 00:16:49,759
and everything<font color="#E5E5E5"> right so using process</font>

324
00:16:47,179 --> 00:16:52,160
monitor<font color="#E5E5E5"> this is the actual code</font><font color="#CCCCCC"> that</font>

325
00:16:49,759 --> 00:16:56,029
says the point<font color="#E5E5E5"> L pointer read the pipe</font>

326
00:16:52,160 --> 00:16:58,459
and then check for<font color="#E5E5E5"> the markers and this</font>

327
00:16:56,029 --> 00:17:01,610
now the process were in the<font color="#CCCCCC"> malware</font>

328
00:16:58,459 --> 00:17:05,029
tries to encrypt<font color="#CCCCCC"> your sectors and</font>

329
00:17:01,610 --> 00:17:08,959
including the MBR<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> there is another</font>

330
00:17:05,029 --> 00:17:11,449
tool HD hacker<font color="#CCCCCC"> this is not</font><font color="#E5E5E5"> the actual</font>

331
00:17:08,959 --> 00:17:13,760
hacker that<font color="#E5E5E5"> impacts here in beer this</font><font color="#CCCCCC"> is</font>

332
00:17:11,449 --> 00:17:16,189
another tool<font color="#CCCCCC"> way and you can download</font><font color="#E5E5E5"> it</font>

333
00:17:13,760 --> 00:17:19,220
online<font color="#E5E5E5"> I didn't include the link because</font>

334
00:17:16,189 --> 00:17:22,600
I<font color="#E5E5E5"> made give you the</font><font color="#CCCCCC"> uninfected link or</font>

335
00:17:19,220 --> 00:17:26,870
something<font color="#E5E5E5"> download it in your own risk</font>

336
00:17:22,599 --> 00:17:30,469
<font color="#CCCCCC">okay the HD hacker dist Atul this</font><font color="#E5E5E5"> is</font>

337
00:17:26,869 --> 00:17:33,020
actually and a snapshot of<font color="#E5E5E5"> the code from</font>

338
00:17:30,470 --> 00:17:36,200
<font color="#E5E5E5">the from the malware after for this one</font>

339
00:17:33,020 --> 00:17:39,289
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> it is actually similar wherein you</font>

340
00:17:36,200 --> 00:17:41,860
can<font color="#E5E5E5"> actually read okay you can</font><font color="#CCCCCC"> actually</font>

341
00:17:39,289 --> 00:17:44,870
read<font color="#E5E5E5"> your sectors</font><font color="#CCCCCC"> you can read your</font>

342
00:17:41,860 --> 00:17:46,729
physical<font color="#E5E5E5"> MBR you can read any sectors</font>

343
00:17:44,870 --> 00:17:49,428
that<font color="#E5E5E5"> you want and then you</font><font color="#CCCCCC"> can actually</font>

344
00:17:46,730 --> 00:17:54,639
<font color="#E5E5E5">save it into a pile you</font><font color="#CCCCCC"> can actually</font>

345
00:17:49,429 --> 00:17:56,330
<font color="#E5E5E5">impact or destroy your own MBR</font><font color="#CCCCCC"> K if your</font>

346
00:17:54,639 --> 00:17:58,969
<font color="#CCCCCC">Explorer enough</font>

347
00:17:56,330 --> 00:18:02,840
<font color="#E5E5E5">you can you can</font><font color="#CCCCCC"> write something</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> you</font>

348
00:17:58,970 --> 00:18:06,140
can load a file<font color="#E5E5E5"> okay and then you can</font>

349
00:18:02,840 --> 00:18:08,360
actually write<font color="#CCCCCC"> OB right your your</font><font color="#E5E5E5"> MBR</font>

350
00:18:06,140 --> 00:18:11,779
you can write any sector that<font color="#E5E5E5"> you want</font>

351
00:18:08,360 --> 00:18:14,330
if you happen to have for<font color="#CCCCCC"> example if you</font>

352
00:18:11,779 --> 00:18:17,149
go to<font color="#E5E5E5"> your if you want to to try</font><font color="#CCCCCC"> this</font>

353
00:18:14,330 --> 00:18:19,189
out okay<font color="#E5E5E5"> do not do not try</font><font color="#CCCCCC"> this in your</font>

354
00:18:17,149 --> 00:18:23,479
own computer<font color="#CCCCCC"> you can actually</font><font color="#E5E5E5"> go</font><font color="#CCCCCC"> to your</font>

355
00:18:19,190 --> 00:18:24,289
<font color="#CCCCCC">friend's house and just trying right</font><font color="#E5E5E5"> no</font>

356
00:18:23,480 --> 00:18:29,210
just kidding

357
00:18:24,289 --> 00:18:31,700
<font color="#E5E5E5">hey do not do not quote me on that okay</font>

358
00:18:29,210 --> 00:18:33,529
you can use<font color="#CCCCCC"> the HD hacker</font><font color="#E5E5E5"> okay so from</font>

359
00:18:31,700 --> 00:18:39,200
<font color="#E5E5E5">the HD hacker tool this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the output</font>

360
00:18:33,529 --> 00:18:41,539
<font color="#E5E5E5">okay we we we read the MBR week we put</font>

361
00:18:39,200 --> 00:18:44,840
<font color="#E5E5E5">it in a file and then if you're going to</font>

362
00:18:41,539 --> 00:18:48,139
<font color="#E5E5E5">impair the code coming from the petia</font>

363
00:18:44,840 --> 00:18:52,549
<font color="#CCCCCC">they're actually totally the same</font><font color="#E5E5E5"> okay</font>

364
00:18:48,139 --> 00:18:56,629
this is where it reads<font color="#E5E5E5"> the</font><font color="#CCCCCC"> the code and</font>

365
00:18:52,549 --> 00:18:59,990
from<font color="#E5E5E5"> your sector okay this is not the</font>

366
00:18:56,630 --> 00:19:02,000
code were in<font color="#CCCCCC"> I told you</font><font color="#E5E5E5"> earlier</font><font color="#CCCCCC"> that it</font>

367
00:18:59,990 --> 00:19:05,389
creates it<font color="#CCCCCC"> open</font><font color="#E5E5E5"> stop I'll read the</font>

368
00:19:02,000 --> 00:19:08,210
contents accelerate with<font color="#E5E5E5"> 37 okay</font><font color="#CCCCCC"> you can</font>

369
00:19:05,389 --> 00:19:10,010
<font color="#CCCCCC">actually if you</font><font color="#E5E5E5"> have the sample</font><font color="#CCCCCC"> I'm not</font>

370
00:19:08,210 --> 00:19:12,049
giving you the sample if you<font color="#E5E5E5"> happen to</font>

371
00:19:10,010 --> 00:19:14,720
have the<font color="#CCCCCC"> petiole malware sample</font>

372
00:19:12,049 --> 00:19:16,580
all you have<font color="#E5E5E5"> to do is once it encrypts</font>

373
00:19:14,720 --> 00:19:18,440
it decrypts<font color="#CCCCCC"> it's code already</font><font color="#E5E5E5"> in the</font>

374
00:19:16,580 --> 00:19:22,389
memory you can just search<font color="#CCCCCC"> for this code</font>

375
00:19:18,440 --> 00:19:26,480
then there is the start<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> MBR</font>

376
00:19:22,389 --> 00:19:28,189
infection<font color="#CCCCCC"> okay and then if you use at</font>

377
00:19:26,480 --> 00:19:30,200
the same<font color="#E5E5E5"> time while you're running while</font>

378
00:19:28,190 --> 00:19:33,019
you're trying to<font color="#E5E5E5"> debug</font><font color="#CCCCCC"> it what what</font><font color="#E5E5E5"> do</font>

379
00:19:30,200 --> 00:19:35,840
<font color="#E5E5E5">you usually do is you</font><font color="#CCCCCC"> run your malware</font>

380
00:19:33,019 --> 00:19:38,929
<font color="#E5E5E5">in a debugger</font><font color="#CCCCCC"> okay and then while you're</font>

381
00:19:35,840 --> 00:19:40,519
trying<font color="#E5E5E5"> to</font><font color="#CCCCCC"> while the mother is trying to</font>

382
00:19:38,929 --> 00:19:42,919
encrypt you can run it do<font color="#E5E5E5"> not run the</font>

383
00:19:40,519 --> 00:19:46,100
whole<font color="#CCCCCC"> thing all at once okay you can run</font>

384
00:19:42,919 --> 00:19:49,610
it<font color="#E5E5E5"> instruction</font><font color="#CCCCCC"> by instruction</font><font color="#E5E5E5"> using a</font>

385
00:19:46,100 --> 00:19:52,070
debugger<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then once it tries to to do</font>

386
00:19:49,610 --> 00:19:55,519
one infection<font color="#E5E5E5"> one sector infection you</font>

387
00:19:52,070 --> 00:19:57,230
can<font color="#CCCCCC"> actually use HD hacker</font><font color="#E5E5E5"> again to to</font>

388
00:19:55,519 --> 00:20:01,159
read the content<font color="#E5E5E5"> okay this is actually</font>

389
00:19:57,230 --> 00:20:04,850
<font color="#CCCCCC">Devon</font><font color="#E5E5E5"> 10 which</font><font color="#CCCCCC"> is now 37</font><font color="#E5E5E5"> is an ASCII</font>

390
00:20:01,159 --> 00:20:07,039
code<font color="#CCCCCC"> poor</font><font color="#E5E5E5"> seven it is now that means if</font>

391
00:20:04,850 --> 00:20:09,830
it<font color="#E5E5E5"> is if you see seven here that means</font>

392
00:20:07,039 --> 00:20:13,610
the original content<font color="#CCCCCC"> are</font>

393
00:20:09,830 --> 00:20:16,639
<font color="#CCCCCC">Chili's</font><font color="#E5E5E5"> zero</font><font color="#CCCCCC"> if you XOR 0</font><font color="#E5E5E5"> to the 37 you</font>

394
00:20:13,610 --> 00:20:19,908
will see just<font color="#CCCCCC"> all</font><font color="#E5E5E5"> seven</font><font color="#CCCCCC"> okay</font>

395
00:20:16,640 --> 00:20:22,480
and then it will continue you<font color="#E5E5E5"> can part</font>

396
00:20:19,909 --> 00:20:25,700
the infection actually using again

397
00:20:22,480 --> 00:20:28,789
process monitor you can<font color="#E5E5E5"> monitor by</font>

398
00:20:25,700 --> 00:20:31,279
sectors<font color="#CCCCCC"> you can see this okay the</font><font color="#E5E5E5"> length</font>

399
00:20:28,789 --> 00:20:38,720
the actual length of one sector<font color="#CCCCCC"> is</font>

400
00:20:31,279 --> 00:20:42,860
actually<font color="#E5E5E5"> 0 X 200k hexa 200 hex key so</font>

401
00:20:38,720 --> 00:20:45,740
every time it<font color="#E5E5E5"> tries to encrypt</font><font color="#CCCCCC"> okay it</font>

402
00:20:42,860 --> 00:20:47,840
encrypts your your sectors you can see

403
00:20:45,740 --> 00:20:50,389
<font color="#E5E5E5">you will</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> able</font><font color="#CCCCCC"> to see this they're</font>

404
00:20:47,840 --> 00:20:52,850
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> lots of things going on while</font>

405
00:20:50,389 --> 00:20:55,070
it does<font color="#CCCCCC"> that because process monitor</font>

406
00:20:52,850 --> 00:20:57,830
<font color="#E5E5E5">actually monitors everything</font><font color="#CCCCCC"> this</font>

407
00:20:55,070 --> 00:21:00,350
particular version<font color="#E5E5E5"> is actually the clean</font>

408
00:20:57,830 --> 00:21:03,500
clean version already<font color="#CCCCCC"> okay this is for</font>

409
00:21:00,350 --> 00:21:05,299
<font color="#E5E5E5">the presentation but you won't expect</font>

410
00:21:03,500 --> 00:21:07,309
when you run the process<font color="#CCCCCC"> monitor you</font>

411
00:21:05,299 --> 00:21:10,190
will see those things<font color="#E5E5E5"> you won't see</font><font color="#CCCCCC"> that</font>

412
00:21:07,309 --> 00:21:13,760
one<font color="#CCCCCC"> okay again</font><font color="#E5E5E5"> comparing the code it</font>

413
00:21:10,190 --> 00:21:17,929
tries the new MV R this is the the old

414
00:21:13,760 --> 00:21:20,899
<font color="#E5E5E5">MBR this is now the new MBR the new MBR</font>

415
00:21:17,929 --> 00:21:23,600
is is actually<font color="#CCCCCC"> coming</font><font color="#E5E5E5"> from the the</font>

416
00:21:20,899 --> 00:21:28,428
malware code<font color="#CCCCCC"> it is written on the on the</font>

417
00:21:23,600 --> 00:21:31,309
MBR<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> see so this is this is now the</font>

418
00:21:28,429 --> 00:21:34,130
content<font color="#CCCCCC"> ok you can see</font><font color="#E5E5E5"> that the content</font>

419
00:21:31,309 --> 00:21:37,279
<font color="#E5E5E5">of the new MBR</font><font color="#CCCCCC"> is almost similar to the</font>

420
00:21:34,130 --> 00:21:39,409
<font color="#CCCCCC">actual boot sequence ok we will see</font>

421
00:21:37,279 --> 00:21:42,440
those<font color="#E5E5E5"> things later on when</font><font color="#CCCCCC"> we do the</font>

422
00:21:39,409 --> 00:21:46,120
<font color="#E5E5E5">debugging of the the boot sequence ok so</font>

423
00:21:42,440 --> 00:21:51,529
this<font color="#E5E5E5"> is actually your your now impacted</font>

424
00:21:46,120 --> 00:21:53,989
<font color="#CCCCCC">kate the malware MBR</font><font color="#E5E5E5"> hey even though you</font>

425
00:21:51,529 --> 00:21:57,649
have it it doesn't matter<font color="#E5E5E5"> if you have</font>

426
00:21:53,990 --> 00:22:00,649
MBR style MBR in your hard drive or GPT

427
00:21:57,649 --> 00:22:03,529
when you are when you<font color="#CCCCCC"> have the Pecha</font><font color="#E5E5E5"> and</font>

428
00:22:00,649 --> 00:22:06,529
impacted your system<font color="#CCCCCC"> ok it</font><font color="#E5E5E5"> doesn't</font>

429
00:22:03,529 --> 00:22:09,289
<font color="#CCCCCC">matter they will both be impacted with a</font>

430
00:22:06,529 --> 00:22:12,860
Pecha<font color="#E5E5E5"> ok you'll be happy because you</font>

431
00:22:09,289 --> 00:22:15,889
<font color="#CCCCCC">have now</font><font color="#E5E5E5"> the malware</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> the thing is if</font>

432
00:22:12,860 --> 00:22:18,529
<font color="#E5E5E5">you run the malware k in your</font><font color="#CCCCCC"> windows</font>

433
00:22:15,889 --> 00:22:21,379
<font color="#CCCCCC">system k</font><font color="#E5E5E5"> you won't be able to see the</font>

434
00:22:18,529 --> 00:22:22,280
ransomware<font color="#CCCCCC"> or the ransom note first ok</font>

435
00:22:21,380 --> 00:22:24,620
<font color="#CCCCCC">it</font><font color="#E5E5E5"> has</font>

436
00:22:22,280 --> 00:22:26,930
<font color="#CCCCCC">do-it has to finish everything okay</font>

437
00:22:24,620 --> 00:22:29,120
<font color="#E5E5E5">you're going here you're looking</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> this</font>

438
00:22:26,930 --> 00:22:30,980
it is<font color="#CCCCCC"> not actually doing encryption</font>

439
00:22:29,120 --> 00:22:34,100
usually run somewhere when we talk about

440
00:22:30,980 --> 00:22:36,980
Branson where it is encrypting<font color="#E5E5E5"> Paris</font>

441
00:22:34,100 --> 00:22:40,250
okay<font color="#CCCCCC"> but this one it</font><font color="#E5E5E5"> is just encrypting</font>

442
00:22:36,980 --> 00:22:42,500
your sectors<font color="#CCCCCC"> okay so what happened is</font>

443
00:22:40,250 --> 00:22:45,260
after<font color="#E5E5E5"> encrypting the</font><font color="#CCCCCC"> sector's that it</font>

444
00:22:42,500 --> 00:22:48,320
needs<font color="#E5E5E5"> it will copy the rest of the</font>

445
00:22:45,260 --> 00:22:52,040
contents of<font color="#E5E5E5"> the kernel code from the</font>

446
00:22:48,320 --> 00:22:54,139
malware<font color="#E5E5E5"> itself is starting</font><font color="#CCCCCC"> to sector 22</font>

447
00:22:52,040 --> 00:22:57,139
<font color="#E5E5E5">so when you see this one</font>

448
00:22:54,140 --> 00:22:59,240
it is now<font color="#CCCCCC"> writing something</font><font color="#E5E5E5"> okay it is</font>

449
00:22:57,140 --> 00:23:01,610
now<font color="#E5E5E5"> writing the rest of the kernel code</font>

450
00:22:59,240 --> 00:23:07,670
<font color="#E5E5E5">from the malware from the patch itself</font>

451
00:23:01,610 --> 00:23:09,439
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> so once it's</font><font color="#CCCCCC"> done that okay so this</font>

452
00:23:07,670 --> 00:23:13,400
is now<font color="#CCCCCC"> we're just I'm just showing you</font>

453
00:23:09,440 --> 00:23:17,360
the other contents of the<font color="#E5E5E5"> the code</font><font color="#CCCCCC"> so</font>

454
00:23:13,400 --> 00:23:19,610
now it<font color="#CCCCCC"> cup is</font><font color="#E5E5E5"> the so I'm using HD hacker</font>

455
00:23:17,360 --> 00:23:22,580
to show you the the<font color="#CCCCCC"> contents that's</font>

456
00:23:19,610 --> 00:23:26,240
being written<font color="#E5E5E5"> this is actually the part</font>

457
00:23:22,580 --> 00:23:28,250
of the ransomware<font color="#E5E5E5"> part of the splashing</font>

458
00:23:26,240 --> 00:23:31,460
screen<font color="#E5E5E5"> later I will</font><font color="#CCCCCC"> show you what's</font>

459
00:23:28,250 --> 00:23:35,390
<font color="#CCCCCC">going to happen so now we have we have</font>

460
00:23:31,460 --> 00:23:39,070
now the impacted MBR<font color="#E5E5E5"> we now have the</font>

461
00:23:35,390 --> 00:23:42,770
infected sectors<font color="#E5E5E5"> what happens after</font>

462
00:23:39,070 --> 00:23:45,290
impacting the<font color="#CCCCCC"> sectors</font><font color="#E5E5E5"> okay</font>

463
00:23:42,770 --> 00:23:49,010
or this one is<font color="#E5E5E5"> showing the</font><font color="#CCCCCC"> the content</font>

464
00:23:45,290 --> 00:23:51,320
of the the onion address<font color="#CCCCCC"> I</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> just</font>

465
00:23:49,010 --> 00:23:53,810
put the receive so you don't need to to

466
00:23:51,320 --> 00:23:57,950
pay for me it's done<font color="#CCCCCC"> it already paid for</font>

467
00:23:53,810 --> 00:24:01,070
<font color="#CCCCCC">it</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is actually</font><font color="#CCCCCC"> the actually</font>

468
00:23:57,950 --> 00:24:07,550
the content<font color="#CCCCCC"> of the those links is</font>

469
00:24:01,070 --> 00:24:10,780
actually at sector<font color="#E5E5E5"> 36 okay</font><font color="#CCCCCC"> this is</font><font color="#E5E5E5"> now</font>

470
00:24:07,550 --> 00:24:13,730
what happened<font color="#E5E5E5"> once you are</font><font color="#CCCCCC"> impacted</font><font color="#E5E5E5"> so</font>

471
00:24:10,780 --> 00:24:16,430
you have your<font color="#CCCCCC"> Window System</font><font color="#E5E5E5"> you</font>

472
00:24:13,730 --> 00:24:21,080
<font color="#E5E5E5">double-click</font><font color="#CCCCCC"> your malware your</font><font color="#E5E5E5"> petia and</font>

473
00:24:16,430 --> 00:24:23,720
then from the<font color="#E5E5E5"> malware itself okay it</font>

474
00:24:21,080 --> 00:24:27,590
will actually again escalate the

475
00:24:23,720 --> 00:24:29,510
<font color="#E5E5E5">privilege okay check the different</font>

476
00:24:27,590 --> 00:24:34,189
people<font color="#CCCCCC"> just adjust the</font><font color="#E5E5E5"> top and privilege</font>

477
00:24:29,510 --> 00:24:34,940
<font color="#CCCCCC">to and then it will</font><font color="#E5E5E5"> issue this API this</font>

478
00:24:34,190 --> 00:24:37,910
API

479
00:24:34,940 --> 00:24:38,540
is<font color="#E5E5E5"> actually the reboot the reset</font><font color="#CCCCCC"> of the</font>

480
00:24:37,910 --> 00:24:41,120
system

481
00:24:38,540 --> 00:24:43,730
once everything is impacted once the

482
00:24:41,120 --> 00:24:46,850
malware code is read in the<font color="#E5E5E5"> sector once</font>

483
00:24:43,730 --> 00:24:49,700
because writing writing<font color="#E5E5E5"> something in</font>

484
00:24:46,850 --> 00:24:53,240
your<font color="#E5E5E5"> sector in your MBR in your hard</font>

485
00:24:49,700 --> 00:24:55,640
drive<font color="#E5E5E5"> will not be affected again the</font>

486
00:24:53,240 --> 00:24:59,180
system<font color="#CCCCCC"> ok you have</font><font color="#E5E5E5"> to restart</font><font color="#CCCCCC"> the system</font>

487
00:24:55,640 --> 00:25:01,490
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> so the malware</font><font color="#CCCCCC"> persists the</font><font color="#E5E5E5"> system</font>

488
00:24:59,180 --> 00:25:04,940
to restart<font color="#CCCCCC"> take note</font><font color="#E5E5E5"> if you're infected</font>

489
00:25:01,490 --> 00:25:07,010
<font color="#E5E5E5">we if</font><font color="#CCCCCC"> you have the malware itself until</font>

490
00:25:04,940 --> 00:25:10,340
it restarts<font color="#CCCCCC"> ok</font>

491
00:25:07,010 --> 00:25:12,920
your only infection is the<font color="#E5E5E5"> the sector</font>

492
00:25:10,340 --> 00:25:15,590
from<font color="#CCCCCC"> 20 to and you still have the rest</font>

493
00:25:12,920 --> 00:25:19,220
<font color="#E5E5E5">of your</font><font color="#CCCCCC"> files ok if you want to clean</font>

494
00:25:15,590 --> 00:25:21,260
your<font color="#E5E5E5"> system ok all you</font><font color="#CCCCCC"> have to do is to</font>

495
00:25:19,220 --> 00:25:23,960
stop the<font color="#CCCCCC"> infection</font><font color="#E5E5E5"> do not reboot the</font>

496
00:25:21,260 --> 00:25:26,420
system<font color="#CCCCCC"> if you</font><font color="#E5E5E5"> are fast enough to know</font>

497
00:25:23,960 --> 00:25:29,840
<font color="#CCCCCC">that you're actually impacting</font><font color="#E5E5E5"> yourself</font>

498
00:25:26,420 --> 00:25:32,630
or your neighbors with<font color="#E5E5E5"> petia</font><font color="#CCCCCC"> keep your</font>

499
00:25:29,840 --> 00:25:35,840
past<font color="#E5E5E5"> enough</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> you can actually stop the</font>

500
00:25:32,630 --> 00:25:38,480
infection<font color="#E5E5E5"> grab the hard drive</font><font color="#CCCCCC"> put it in</font>

501
00:25:35,840 --> 00:25:41,030
an<font color="#E5E5E5"> a derma in another computer ok and</font>

502
00:25:38,480 --> 00:25:43,100
then try<font color="#E5E5E5"> to scan the whole hard drive</font><font color="#CCCCCC"> as</font>

503
00:25:41,030 --> 00:25:45,590
a physical drive and then you can

504
00:25:43,100 --> 00:25:49,909
probably have some<font color="#CCCCCC"> forensic tools that</font>

505
00:25:45,590 --> 00:25:53,120
can grab the files in your<font color="#CCCCCC"> system</font><font color="#E5E5E5"> ok</font>

506
00:25:49,910 --> 00:25:56,330
make<font color="#E5E5E5"> sure that</font><font color="#CCCCCC"> you have not yet rebooted</font>

507
00:25:53,120 --> 00:26:00,370
or restarted the system but once they

508
00:25:56,330 --> 00:26:03,260
start the restarts<font color="#E5E5E5"> already triggered ok</font>

509
00:26:00,370 --> 00:26:06,020
you now have you don't have<font color="#CCCCCC"> any chance</font>

510
00:26:03,260 --> 00:26:08,450
of recovering<font color="#CCCCCC"> your system</font><font color="#E5E5E5"> ok as I've</font>

511
00:26:06,020 --> 00:26:11,560
said earlier<font color="#E5E5E5"> we are not going to do the</font>

512
00:26:08,450 --> 00:26:16,040
debugging<font color="#E5E5E5"> for your BIOS</font><font color="#CCCCCC"> ok there is a</font>

513
00:26:11,560 --> 00:26:19,129
<font color="#CCCCCC">open-source tool called</font><font color="#E5E5E5"> be och</font><font color="#CCCCCC"> I call it</font>

514
00:26:16,040 --> 00:26:22,550
box<font color="#E5E5E5"> ok I don't know how they how they</font>

515
00:26:19,130 --> 00:26:25,280
call it it is<font color="#CCCCCC"> actually an emulator ok</font>

516
00:26:22,550 --> 00:26:27,889
normally<font color="#E5E5E5"> when you're doing like an IOT</font>

517
00:26:25,280 --> 00:26:31,100
<font color="#CCCCCC">or</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> city</font><font color="#E5E5E5"> up or something usually have</font>

518
00:26:27,890 --> 00:26:35,150
an emulator this one is an emulator<font color="#E5E5E5"> it's</font>

519
00:26:31,100 --> 00:26:39,820
emulates Intel x86<font color="#E5E5E5"> computer you can also</font>

520
00:26:35,150 --> 00:26:42,620
use box<font color="#E5E5E5"> ok if you want to run all</font>

521
00:26:39,820 --> 00:26:46,340
computer programs<font color="#CCCCCC"> that doesn't run on</font>

522
00:26:42,620 --> 00:26:48,830
your Windows 7 or Windows<font color="#CCCCCC"> 8</font><font color="#E5E5E5"> or something</font>

523
00:26:46,340 --> 00:26:52,879
<font color="#E5E5E5">ok it can run those games</font>

524
00:26:48,830 --> 00:26:55,760
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> it can of</font><font color="#E5E5E5"> course debugs</font><font color="#CCCCCC"> your MBR</font>

525
00:26:52,880 --> 00:26:58,010
code<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> we're going to</font><font color="#CCCCCC"> use box</font><font color="#E5E5E5"> okay</font>

526
00:26:55,760 --> 00:27:00,470
I'm not going to do<font color="#E5E5E5"> it live because of</font>

527
00:26:58,010 --> 00:27:05,510
<font color="#E5E5E5">course it doesn't work</font><font color="#CCCCCC"> every time right</font>

528
00:27:00,470 --> 00:27:09,040
<font color="#E5E5E5">okay so usually</font><font color="#CCCCCC"> 7c</font><font color="#E5E5E5"> 0 contains the boot</font>

529
00:27:05,510 --> 00:27:12,650
sequence<font color="#E5E5E5"> but before reaching 7000</font>

530
00:27:09,040 --> 00:27:17,120
<font color="#E5E5E5">location in</font><font color="#CCCCCC"> your memory in your MBR</font><font color="#E5E5E5"> how</font>

531
00:27:12,650 --> 00:27:19,550
the memory<font color="#E5E5E5"> K it reaches based on the</font>

532
00:27:17,120 --> 00:27:21,590
sample<font color="#CCCCCC"> that I have and also</font><font color="#E5E5E5"> the the</font>

533
00:27:19,550 --> 00:27:24,740
operating system that<font color="#CCCCCC"> I use I use</font>

534
00:27:21,590 --> 00:27:29,230
actually<font color="#E5E5E5"> Windows XP on this one okay</font>

535
00:27:24,740 --> 00:27:32,690
I<font color="#CCCCCC"> step through</font><font color="#E5E5E5"> five million instructions</font>

536
00:27:29,230 --> 00:27:38,090
<font color="#CCCCCC">okay one by one</font><font color="#E5E5E5"> imagine it took me a</font>

537
00:27:32,690 --> 00:27:41,570
year just to go to 7000<font color="#CCCCCC"> ok upon reaching</font>

538
00:27:38,090 --> 00:27:45,290
that<font color="#E5E5E5"> one</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> I am now going to actually</font>

539
00:27:41,570 --> 00:27:47,990
load in a<font color="#E5E5E5"> regular computer system</font><font color="#CCCCCC"> ok</font>

540
00:27:45,290 --> 00:27:49,850
when you run<font color="#E5E5E5"> your system</font><font color="#CCCCCC"> actually the</font>

541
00:27:47,990 --> 00:27:54,200
<font color="#E5E5E5">computer still doesn't</font><font color="#CCCCCC"> know if you're</font>

542
00:27:49,850 --> 00:27:56,389
going<font color="#E5E5E5"> to use Linux or Windows right</font><font color="#CCCCCC"> ok</font>

543
00:27:54,200 --> 00:27:58,400
<font color="#E5E5E5">when you when you turn</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> your system it</font>

544
00:27:56,390 --> 00:28:00,710
doesn't<font color="#CCCCCC"> know which operating system</font>

545
00:27:58,400 --> 00:28:03,020
you're going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> use that means during</font>

546
00:28:00,710 --> 00:28:06,230
the the boot sequence you don't have

547
00:28:03,020 --> 00:28:09,830
<font color="#E5E5E5">Windows API during the boot sequence you</font>

548
00:28:06,230 --> 00:28:11,570
don't have<font color="#E5E5E5"> Linux API</font><font color="#CCCCCC"> that means all</font><font color="#E5E5E5"> you</font>

549
00:28:09,830 --> 00:28:14,600
<font color="#CCCCCC">only the only</font><font color="#E5E5E5"> thing that you have is</font>

550
00:28:11,570 --> 00:28:17,830
interrupts<font color="#E5E5E5"> okay so the malware actually</font>

551
00:28:14,600 --> 00:28:21,350
put a kernel code<font color="#E5E5E5"> wherein it only uses</font>

552
00:28:17,830 --> 00:28:23,870
interrupts<font color="#CCCCCC"> okay okay the</font><font color="#E5E5E5"> very</font><font color="#CCCCCC"> per</font><font color="#E5E5E5"> sector</font>

553
00:28:21,350 --> 00:28:25,969
<font color="#E5E5E5">is loaded when the boot sequence started</font>

554
00:28:23,870 --> 00:28:30,139
when<font color="#CCCCCC"> you reach seven six zero zero</font>

555
00:28:25,970 --> 00:28:32,770
okay when it is now loaded the<font color="#CCCCCC"> Pecha MBR</font>

556
00:28:30,140 --> 00:28:36,290
<font color="#CCCCCC">is the one loaded because</font><font color="#E5E5E5"> it is already</font>

557
00:28:32,770 --> 00:28:39,680
<font color="#E5E5E5">impacted right and then it will start</font>

558
00:28:36,290 --> 00:28:43,190
the initial reboot remember that we

559
00:28:39,680 --> 00:28:46,580
actually<font color="#E5E5E5"> dumped a Pecha uses the reboot</font>

560
00:28:43,190 --> 00:28:49,580
to to initiate the actual mother code

561
00:28:46,580 --> 00:28:52,429
<font color="#E5E5E5">okay this is actually</font><font color="#CCCCCC"> the code</font><font color="#E5E5E5"> that will</font>

562
00:28:49,580 --> 00:28:56,689
be executed when the<font color="#CCCCCC"> pager system</font>

563
00:28:52,430 --> 00:29:00,350
impacted will restarts<font color="#CCCCCC"> okay let's talk</font>

564
00:28:56,690 --> 00:29:02,210
<font color="#E5E5E5">about box</font><font color="#CCCCCC"> purrs when you run when</font><font color="#E5E5E5"> you</font>

565
00:29:00,350 --> 00:29:04,429
<font color="#E5E5E5">open box</font><font color="#CCCCCC"> okay this</font>

566
00:29:02,210 --> 00:29:07,070
after they<font color="#E5E5E5"> already</font><font color="#CCCCCC"> opened the</font><font color="#E5E5E5"> picture</font>

567
00:29:04,430 --> 00:29:09,830
<font color="#E5E5E5">this is not the petticoat on the it is</font>

568
00:29:07,070 --> 00:29:12,950
<font color="#E5E5E5">something like a regular debugger</font><font color="#CCCCCC"> okay</font>

569
00:29:09,830 --> 00:29:15,320
you can see your registers here you can

570
00:29:12,950 --> 00:29:18,050
see the<font color="#E5E5E5"> assembly code you can see the</font>

571
00:29:15,320 --> 00:29:21,230
the memory dump the<font color="#E5E5E5"> only problem with</font>

572
00:29:18,050 --> 00:29:26,210
<font color="#CCCCCC">that</font><font color="#E5E5E5"> is it is not</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> interesting hobby</font>

573
00:29:21,230 --> 00:29:28,760
use only<font color="#CCCCCC"> dbg immunity debugger okay</font><font color="#E5E5E5"> so</font>

574
00:29:26,210 --> 00:29:31,640
those<font color="#E5E5E5"> those the buggers are</font><font color="#CCCCCC"> interrupted</font>

575
00:29:28,760 --> 00:29:34,100
you<font color="#E5E5E5"> can actually</font><font color="#CCCCCC"> okay whenever</font><font color="#E5E5E5"> you you</font>

576
00:29:31,640 --> 00:29:36,500
run<font color="#E5E5E5"> an instruction or wherever whenever</font>

577
00:29:34,100 --> 00:29:38,480
you step on instruction it you will see

578
00:29:36,500 --> 00:29:40,480
the changes<font color="#E5E5E5"> in the dance you will see</font>

579
00:29:38,480 --> 00:29:43,940
the changes<font color="#E5E5E5"> in the register but this one</font>

580
00:29:40,480 --> 00:29:46,490
if you<font color="#E5E5E5"> want to see the changes here okay</font>

581
00:29:43,940 --> 00:29:49,670
you have actually<font color="#CCCCCC"> to to repress</font><font color="#E5E5E5"> this</font>

582
00:29:46,490 --> 00:29:52,130
particular part<font color="#CCCCCC"> that the dump window but</font>

583
00:29:49,670 --> 00:29:54,260
this one<font color="#E5E5E5"> okay even though you're going</font>

584
00:29:52,130 --> 00:29:56,540
to change this<font color="#E5E5E5"> you will only see some</font>

585
00:29:54,260 --> 00:30:00,500
changes in the in the registers it is

586
00:29:56,540 --> 00:30:02,740
kind<font color="#E5E5E5"> of harder to to execute but respond</font>

587
00:30:00,500 --> 00:30:05,660
<font color="#E5E5E5">because you're if you're debugging</font>

588
00:30:02,740 --> 00:30:07,820
<font color="#E5E5E5">debugging and MBR</font><font color="#CCCCCC"> okay here are just</font>

589
00:30:05,660 --> 00:30:10,850
<font color="#CCCCCC">some of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> people the few people that</font>

590
00:30:07,820 --> 00:30:14,000
can can debug the MBR because nobody

591
00:30:10,850 --> 00:30:16,280
wants to debug<font color="#E5E5E5"> damn beer I only tries to</font>

592
00:30:14,000 --> 00:30:21,020
<font color="#E5E5E5">I know</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> try to debug the MBR when I</font>

593
00:30:16,280 --> 00:30:24,020
had this at<font color="#E5E5E5"> the samples it's fun</font><font color="#CCCCCC"> okay so</font>

594
00:30:21,020 --> 00:30:28,310
you have<font color="#E5E5E5"> this debug window registers</font>

595
00:30:24,020 --> 00:30:31,670
window and dumb window<font color="#E5E5E5"> okay of course</font>

596
00:30:28,310 --> 00:30:35,300
<font color="#CCCCCC">I've said we don't</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> yet the the</font>

597
00:30:31,670 --> 00:30:39,710
<font color="#E5E5E5">api's it only uses if you want to</font>

598
00:30:35,300 --> 00:30:41,840
transfer a value from memory to<font color="#E5E5E5"> two</font>

599
00:30:39,710 --> 00:30:44,000
sectors<font color="#CCCCCC"> and sectors of memory</font><font color="#E5E5E5"> you use</font>

600
00:30:41,840 --> 00:30:46,429
<font color="#CCCCCC">interrupt 13 function 42</font>

601
00:30:44,000 --> 00:30:49,210
<font color="#E5E5E5">okay if you want to change screen</font>

602
00:30:46,430 --> 00:30:54,380
displays and<font color="#CCCCCC"> video</font><font color="#E5E5E5"> mode you use</font>

603
00:30:49,210 --> 00:30:57,980
<font color="#E5E5E5">interrupt</font><font color="#CCCCCC"> n</font><font color="#E5E5E5"> okay this is how you read</font>

604
00:30:54,380 --> 00:31:01,550
the<font color="#E5E5E5"> sectors from the drive okay it uses</font>

605
00:30:57,980 --> 00:31:04,400
<font color="#E5E5E5">interrupt 13 function 42 okay and then</font>

606
00:31:01,550 --> 00:31:06,350
we use<font color="#E5E5E5"> something like we called up this</font>

607
00:31:04,400 --> 00:31:08,660
address pocket these are the

608
00:31:06,350 --> 00:31:12,949
informations were in were to put that

609
00:31:08,660 --> 00:31:14,600
that value<font color="#CCCCCC"> were in memory how how big is</font>

610
00:31:12,950 --> 00:31:16,080
the how many<font color="#CCCCCC"> sectors</font>

611
00:31:14,600 --> 00:31:18,570
<font color="#E5E5E5">case being read</font>

612
00:31:16,080 --> 00:31:21,360
and support<font color="#CCCCCC"> so initially</font><font color="#E5E5E5"> pet just code</font>

613
00:31:18,570 --> 00:31:24,510
is going<font color="#CCCCCC"> to read this it</font><font color="#E5E5E5"> will read one</font>

614
00:31:21,360 --> 00:31:28,250
sector which is<font color="#E5E5E5"> your your wishes the</font><font color="#CCCCCC"> pet</font>

615
00:31:24,510 --> 00:31:33,629
<font color="#CCCCCC">embr okay and then and then it will be</font>

616
00:31:28,250 --> 00:31:35,820
<font color="#E5E5E5">executed</font><font color="#CCCCCC"> okay using interrupts 1342 it</font>

617
00:31:33,630 --> 00:31:38,549
reads the contents of<font color="#CCCCCC"> 200 bytes which is</font>

618
00:31:35,820 --> 00:31:43,080
the to decide the per sector from<font color="#E5E5E5"> the 20</font>

619
00:31:38,549 --> 00:31:46,500
to the<font color="#E5E5E5"> 20 to 20 2008 22 sectors contains</font>

620
00:31:43,080 --> 00:31:51,750
the the actual part of<font color="#E5E5E5"> the the</font><font color="#CCCCCC"> Pecha and</font>

621
00:31:46,500 --> 00:31:55,169
kernel code<font color="#E5E5E5"> okay this is what happens it</font>

622
00:31:51,750 --> 00:32:00,960
a<font color="#E5E5E5"> translate code and then it gets back</font>

623
00:31:55,169 --> 00:32:04,080
the content the<font color="#E5E5E5"> only problem with again</font>

624
00:32:00,960 --> 00:32:06,179
with<font color="#E5E5E5"> debugging</font><font color="#CCCCCC"> the MBR is</font><font color="#E5E5E5"> you you cannot</font>

625
00:32:04,080 --> 00:32:08,580
really the dump bodies are not

626
00:32:06,179 --> 00:32:10,320
<font color="#E5E5E5">interactive okay you cannot put comments</font>

627
00:32:08,580 --> 00:32:12,570
<font color="#CCCCCC">wherein you can</font><font color="#E5E5E5"> go back read the</font>

628
00:32:10,320 --> 00:32:14,850
comments again<font color="#E5E5E5"> okay and then you need to</font>

629
00:32:12,570 --> 00:32:17,668
constantly refresh the windows code

630
00:32:14,850 --> 00:32:20,719
windows<font color="#CCCCCC"> dump windows okay</font>

631
00:32:17,669 --> 00:32:25,500
<font color="#E5E5E5">okay this is now how it initializes the</font>

632
00:32:20,720 --> 00:32:29,130
<font color="#CCCCCC">big screen it</font><font color="#E5E5E5"> uses</font><font color="#CCCCCC"> interrupt</font><font color="#E5E5E5"> pen okay</font>

633
00:32:25,500 --> 00:32:31,500
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> similar to API calling you push the</font>

634
00:32:29,130 --> 00:32:36,299
values<font color="#E5E5E5"> this one you use registers to</font>

635
00:32:31,500 --> 00:32:39,960
have the values<font color="#E5E5E5"> okay this is where it</font>

636
00:32:36,299 --> 00:32:42,629
copies<font color="#CCCCCC"> the MBR to to a safe place</font>

637
00:32:39,960 --> 00:32:45,870
okay we're in<font color="#CCCCCC"> if you happen to to pay</font>

638
00:32:42,630 --> 00:32:46,590
you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> actually you can actually get</font>

639
00:32:45,870 --> 00:32:50,549
the actual

640
00:32:46,590 --> 00:32:53,129
MBR but not necessarily<font color="#E5E5E5"> hey I didn't</font>

641
00:32:50,549 --> 00:33:00,600
actually pay and then<font color="#CCCCCC"> you can get</font><font color="#E5E5E5"> this</font>

642
00:32:53,130 --> 00:33:03,179
content okay whenever<font color="#E5E5E5"> you for example it</font>

643
00:33:00,600 --> 00:33:05,039
reboots<font color="#CCCCCC"> and then you want</font><font color="#E5E5E5"> to stop the</font>

644
00:33:03,179 --> 00:33:07,049
reboot you reboot again<font color="#CCCCCC"> okay you</font>

645
00:33:05,039 --> 00:33:11,610
restarted again the system<font color="#E5E5E5"> the malware</font>

646
00:33:07,049 --> 00:33:12,570
knows<font color="#E5E5E5"> if it is already encrypted the the</font>

647
00:33:11,610 --> 00:33:15,360
system<font color="#E5E5E5"> okay</font>

648
00:33:12,570 --> 00:33:17,279
it has a certain marker<font color="#CCCCCC"> wherein if it is</font>

649
00:33:15,360 --> 00:33:19,469
<font color="#E5E5E5">zero that means</font><font color="#CCCCCC"> you're not yet impacted</font>

650
00:33:17,279 --> 00:33:22,320
if it is one<font color="#CCCCCC"> you're you're already</font>

651
00:33:19,470 --> 00:33:25,320
<font color="#E5E5E5">infected instead if it is 0 it will</font>

652
00:33:22,320 --> 00:33:28,850
impact your<font color="#E5E5E5"> system and then change the</font>

653
00:33:25,320 --> 00:33:31,460
plug<font color="#CCCCCC"> k if it is 1 K instead</font>

654
00:33:28,850 --> 00:33:37,459
been encrypting the system it will show

655
00:33:31,460 --> 00:33:40,250
you the<font color="#E5E5E5"> the flashing screen this</font><font color="#CCCCCC"> is not</font>

656
00:33:37,460 --> 00:33:45,860
<font color="#CCCCCC">the initial</font><font color="#E5E5E5"> display of the system can</font><font color="#CCCCCC"> I</font>

657
00:33:40,250 --> 00:33:52,700
<font color="#CCCCCC">pause this and a dozen doesn't pause</font><font color="#E5E5E5"> it</font>

658
00:33:45,860 --> 00:33:54,379
will try to show you something if your

659
00:33:52,700 --> 00:33:57,140
<font color="#E5E5E5">pom are you familiar with that</font><font color="#CCCCCC"> check</font>

660
00:33:54,380 --> 00:34:00,050
this it is like<font color="#E5E5E5"> a</font><font color="#CCCCCC"> utility that that</font>

661
00:33:57,140 --> 00:34:03,140
<font color="#E5E5E5">actually tried to to scan your system</font>

662
00:34:00,050 --> 00:34:06,830
<font color="#E5E5E5">for for errors okay so what picture did</font>

663
00:34:03,140 --> 00:34:10,670
is it<font color="#CCCCCC"> copies the</font><font color="#E5E5E5"> state of the system as</font>

664
00:34:06,830 --> 00:34:13,370
<font color="#E5E5E5">you can see</font><font color="#CCCCCC"> ok the</font><font color="#E5E5E5"> Box system</font><font color="#CCCCCC"> is</font>

665
00:34:10,670 --> 00:34:14,750
actually Gabe you gave you this screen

666
00:34:13,370 --> 00:34:18,440
<font color="#E5E5E5">it is actually the screen it is</font>

667
00:34:14,750 --> 00:34:20,780
emulating your your system<font color="#E5E5E5"> okay and then</font>

668
00:34:18,440 --> 00:34:23,840
on<font color="#CCCCCC"> the on the</font><font color="#E5E5E5"> right side it is actually</font>

669
00:34:20,780 --> 00:34:27,290
<font color="#CCCCCC">running the display</font><font color="#E5E5E5"> it is calling</font>

670
00:34:23,840 --> 00:34:29,120
<font color="#CCCCCC">interrupt</font><font color="#E5E5E5"> n okay okay to display each of</font>

671
00:34:27,290 --> 00:34:32,540
the letters for for<font color="#CCCCCC"> this</font><font color="#E5E5E5"> thing I am</font><font color="#CCCCCC"> just</font>

672
00:34:29,120 --> 00:34:36,199
<font color="#CCCCCC">showing</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> how actually</font><font color="#E5E5E5"> how it is being</font>

673
00:34:32,540 --> 00:34:38,360
<font color="#E5E5E5">executed in terms without the</font><font color="#CCCCCC"> api's</font><font color="#E5E5E5"> only</font>

674
00:34:36,199 --> 00:34:40,759
the<font color="#E5E5E5"> interrupts so</font><font color="#CCCCCC"> interrupting</font><font color="#E5E5E5"> is for</font>

675
00:34:38,360 --> 00:34:45,190
the display<font color="#CCCCCC"> of the screen</font><font color="#E5E5E5"> okay you can</font>

676
00:34:40,760 --> 00:34:48,680
see that<font color="#E5E5E5"> it is</font><font color="#CCCCCC"> actually almost the</font><font color="#E5E5E5"> same</font>

677
00:34:45,190 --> 00:34:51,679
<font color="#E5E5E5">copy or</font><font color="#CCCCCC"> the same way check this is</font>

678
00:34:48,679 --> 00:34:55,699
actually executed<font color="#E5E5E5"> the only problem with</font>

679
00:34:51,679 --> 00:34:58,180
<font color="#CCCCCC">that</font><font color="#E5E5E5"> is K once that particular screen</font>

680
00:34:55,699 --> 00:35:00,799
display<font color="#E5E5E5"> started it will now start</font>

681
00:34:58,180 --> 00:35:04,520
<font color="#E5E5E5">encrypting your system</font><font color="#CCCCCC"> okay</font>

682
00:35:00,800 --> 00:35:09,560
Petya ransomware<font color="#E5E5E5"> does not encrypt your</font>

683
00:35:04,520 --> 00:35:13,340
files<font color="#E5E5E5"> okay it encrypts your MEP MEP the</font>

684
00:35:09,560 --> 00:35:16,820
master file table mft<font color="#CCCCCC"> each point in your</font>

685
00:35:13,340 --> 00:35:20,810
system is actually<font color="#E5E5E5"> has a header</font><font color="#CCCCCC"> K like</font>

686
00:35:16,820 --> 00:35:25,690
an a metadata<font color="#CCCCCC"> K that header or metadata</font>

687
00:35:20,810 --> 00:35:31,180
is actually contained<font color="#E5E5E5"> in the MEP so each</font>

688
00:35:25,690 --> 00:35:34,599
content in the MEP is actually<font color="#E5E5E5"> robbing</font>

689
00:35:31,180 --> 00:35:38,288
it restarted so

690
00:35:34,599 --> 00:35:41,200
MFP contains contains data<font color="#CCCCCC"> for your</font>

691
00:35:38,289 --> 00:35:43,479
files<font color="#E5E5E5"> but it doesn't have the</font><font color="#CCCCCC"> actual</font>

692
00:35:41,200 --> 00:35:46,538
path just<font color="#E5E5E5"> a pointer to the pile</font>

693
00:35:43,479 --> 00:35:49,180
okay so<font color="#E5E5E5"> Pecha does not encrypt the files</font>

694
00:35:46,539 --> 00:35:51,130
it can flips the<font color="#CCCCCC"> MFP</font><font color="#E5E5E5"> so if you're</font>

695
00:35:49,180 --> 00:35:53,618
infected<font color="#CCCCCC"> you won't be</font><font color="#E5E5E5"> able to access</font>

696
00:35:51,130 --> 00:35:58,079
your<font color="#E5E5E5"> pass because the header itself is</font>

697
00:35:53,619 --> 00:35:58,079
encrypted so<font color="#CCCCCC"> that is the initial display</font>

698
00:36:00,119 --> 00:36:07,930
so this is not the check this<font color="#CCCCCC"> ok so the</font>

699
00:36:06,160 --> 00:36:10,538
check this the<font color="#CCCCCC"> the one displayed</font><font color="#E5E5E5"> earlier</font>

700
00:36:07,930 --> 00:36:14,140
<font color="#E5E5E5">is after it looks really similar to</font><font color="#CCCCCC"> the</font>

701
00:36:10,539 --> 00:36:17,019
<font color="#E5E5E5">paid check this okay</font>

702
00:36:14,140 --> 00:36:20,859
now after<font color="#CCCCCC"> showing that</font><font color="#E5E5E5"> fake check this</font>

703
00:36:17,019 --> 00:36:23,470
it will check the<font color="#CCCCCC"> 110 top</font><font color="#E5E5E5"> 36 it checks</font>

704
00:36:20,859 --> 00:36:25,720
for the marker<font color="#CCCCCC"> every zero as I said</font>

705
00:36:23,470 --> 00:36:28,598
earlier<font color="#CCCCCC"> okay that</font><font color="#E5E5E5"> means it is not yet</font>

706
00:36:25,720 --> 00:36:35,109
<font color="#E5E5E5">encrypted then less is now going</font><font color="#CCCCCC"> to</font>

707
00:36:28,599 --> 00:36:37,720
encrypt<font color="#CCCCCC"> your MFP it treats the</font><font color="#E5E5E5"> current</font>

708
00:36:35,109 --> 00:36:40,589
content of the location<font color="#E5E5E5"> okay it will</font>

709
00:36:37,720 --> 00:36:44,109
actually compute the number of sectors

710
00:36:40,589 --> 00:36:47,200
that contains the MEP<font color="#E5E5E5"> okay after</font>

711
00:36:44,109 --> 00:36:51,190
computing that<font color="#E5E5E5"> this is actually the W of</font>

712
00:36:47,200 --> 00:36:53,288
<font color="#E5E5E5">MEP this look at this NTFS</font><font color="#CCCCCC"> this is</font>

713
00:36:51,190 --> 00:36:58,479
actually the<font color="#E5E5E5"> content of your entire</font>

714
00:36:53,289 --> 00:37:01,239
press<font color="#CCCCCC"> okay so in the</font><font color="#E5E5E5"> MEP it is actually</font>

715
00:36:58,479 --> 00:37:03,189
in<font color="#E5E5E5"> the NTFS boot sector it contains at</font>

716
00:37:01,239 --> 00:37:06,009
least one at entry for every<font color="#E5E5E5"> pair</font>

717
00:37:03,190 --> 00:37:08,769
samples they have different or more than

718
00:37:06,009 --> 00:37:11,890
one entry<font color="#E5E5E5"> okay so what happens is the</font>

719
00:37:08,769 --> 00:37:15,399
malware computes the the number of

720
00:37:11,890 --> 00:37:17,920
sectors that contains the MEP then after

721
00:37:15,400 --> 00:37:20,289
initial display<font color="#CCCCCC"> okay it</font><font color="#E5E5E5"> is actually</font>

722
00:37:17,920 --> 00:37:23,799
going to<font color="#E5E5E5"> show you something</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> it is</font>

723
00:37:20,289 --> 00:37:26,559
like checking<font color="#E5E5E5"> the DES okay once this</font>

724
00:37:23,799 --> 00:37:29,710
particular<font color="#CCCCCC"> part starts counting that</font>

725
00:37:26,559 --> 00:37:32,229
means it<font color="#CCCCCC"> is now encrypting</font><font color="#E5E5E5"> your ma</font>

726
00:37:29,710 --> 00:37:34,930
please<font color="#CCCCCC"> okay that percentage is actually</font>

727
00:37:32,229 --> 00:37:37,089
real<font color="#CCCCCC"> it is not just the show</font><font color="#E5E5E5"> okay it</font>

728
00:37:34,930 --> 00:37:38,680
actually computes this particular

729
00:37:37,089 --> 00:37:42,160
numbers is actually the<font color="#CCCCCC"> number of</font>

730
00:37:38,680 --> 00:37:45,430
sectors that has the<font color="#CCCCCC"> ma piece</font><font color="#E5E5E5"> okay it</font>

731
00:37:42,160 --> 00:37:47,970
actually computes the the actual MEP<font color="#CCCCCC"> and</font>

732
00:37:45,430 --> 00:37:50,379
then it encrypts those things

733
00:37:47,970 --> 00:37:53,319
this is what<font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> show you there's a</font>

734
00:37:50,380 --> 00:37:56,590
video demo that<font color="#E5E5E5"> will show you how it</font>

735
00:37:53,320 --> 00:37:59,770
actually<font color="#CCCCCC"> okay this is the call we're in</font>

736
00:37:56,590 --> 00:38:04,360
it will try to to read the contents of

737
00:37:59,770 --> 00:38:09,250
your<font color="#E5E5E5"> M of T and then encrypts it okay</font>

738
00:38:04,360 --> 00:38:13,480
they are<font color="#CCCCCC"> all</font><font color="#E5E5E5"> in box they are</font><font color="#CCCCCC"> all K it is</font>

739
00:38:09,250 --> 00:38:16,180
<font color="#E5E5E5">just using a simple computation okay</font>

740
00:38:13,480 --> 00:38:20,320
it is not starting the sector<font color="#CCCCCC"> to sector</font>

741
00:38:16,180 --> 00:38:22,839
<font color="#E5E5E5">two</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> of the 32,000 sectors k</font>

742
00:38:20,320 --> 00:38:25,330
refreshing this again<font color="#CCCCCC"> I</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> have to</font>

743
00:38:22,840 --> 00:38:28,270
give so this one is actually a<font color="#E5E5E5"> sample of</font>

744
00:38:25,330 --> 00:38:30,580
<font color="#E5E5E5">an entry in your</font><font color="#CCCCCC"> m AP were in it</font>

745
00:38:28,270 --> 00:38:35,190
represents a<font color="#CCCCCC"> pile case starting with</font>

746
00:38:30,580 --> 00:38:35,190
this and then<font color="#E5E5E5"> after the encryption</font>

747
00:38:37,110 --> 00:38:45,460
there's the encryption part and then of

748
00:38:43,630 --> 00:38:47,490
<font color="#CCCCCC">course you have to repress again</font>

749
00:38:45,460 --> 00:38:49,720
<font color="#CCCCCC">okay as</font><font color="#E5E5E5"> I've said earlier that</font>

750
00:38:47,490 --> 00:38:51,189
<font color="#E5E5E5">everything that happens you have</font><font color="#CCCCCC"> to</font>

751
00:38:49,720 --> 00:38:55,230
refresh<font color="#E5E5E5"> because it's not very</font>

752
00:38:51,190 --> 00:38:59,410
<font color="#E5E5E5">interactive</font><font color="#CCCCCC"> it is not</font><font color="#E5E5E5"> the content</font><font color="#CCCCCC"> of the</font>

753
00:38:55,230 --> 00:39:02,890
<font color="#CCCCCC">AMA P it is now encrypted</font><font color="#E5E5E5"> okay</font>

754
00:38:59,410 --> 00:39:07,230
it will now keep encrypting your system

755
00:39:02,890 --> 00:39:10,540
<font color="#E5E5E5">okay until</font><font color="#CCCCCC"> it's which</font><font color="#E5E5E5"> hundred percent</font>

756
00:39:07,230 --> 00:39:13,300
the only problem is if<font color="#CCCCCC"> your try</font><font color="#E5E5E5"> if</font>

757
00:39:10,540 --> 00:39:16,300
<font color="#CCCCCC">you're if you got scared once you see</font>

758
00:39:13,300 --> 00:39:20,230
this<font color="#E5E5E5"> okay and then you stop in the</font>

759
00:39:16,300 --> 00:39:23,220
<font color="#CCCCCC">middle</font><font color="#E5E5E5"> okay and then you decided to pay</font>

760
00:39:20,230 --> 00:39:25,990
the ransom<font color="#E5E5E5"> where okay what will happen</font>

761
00:39:23,220 --> 00:39:29,500
okay<font color="#CCCCCC"> if you happen to pay the ransomware</font>

762
00:39:25,990 --> 00:39:32,379
and then you happen to have<font color="#CCCCCC"> just for in</font>

763
00:39:29,500 --> 00:39:34,540
theory<font color="#E5E5E5"> you get the decryption code and</font>

764
00:39:32,380 --> 00:39:37,630
because you<font color="#E5E5E5"> stopped in the</font><font color="#CCCCCC"> middle</font><font color="#E5E5E5"> of the</font>

765
00:39:34,540 --> 00:39:41,620
encryption<font color="#E5E5E5"> the malval will tag it as</font>

766
00:39:37,630 --> 00:39:43,840
encrypted so<font color="#E5E5E5"> 50</font><font color="#CCCCCC"> percent is encrypted 50</font>

767
00:39:41,620 --> 00:39:46,870
<font color="#E5E5E5">percent is that once you get the</font>

768
00:39:43,840 --> 00:39:49,960
decryption key<font color="#E5E5E5"> and then you execute the</font>

769
00:39:46,870 --> 00:39:53,620
the decryption routine<font color="#E5E5E5"> that 50 percent</font>

770
00:39:49,960 --> 00:39:57,340
encrypted will now be decrypted<font color="#E5E5E5"> the 50</font>

771
00:39:53,620 --> 00:40:02,029
<font color="#CCCCCC">percent not encrypted earlier will now</font>

772
00:39:57,340 --> 00:40:06,089
be encrypted<font color="#E5E5E5"> with your decryption key</font>

773
00:40:02,030 --> 00:40:10,050
you can you see the the<font color="#E5E5E5"> irony of the</font>

774
00:40:06,089 --> 00:40:15,170
your you<font color="#CCCCCC"> know pay for actually the</font>

775
00:40:10,050 --> 00:40:18,630
<font color="#E5E5E5">encryption of your not encrypted files</font>

776
00:40:15,170 --> 00:40:21,990
<font color="#CCCCCC">okay so that is now the the encryption</font>

777
00:40:18,630 --> 00:40:25,410
routine okay<font color="#CCCCCC"> so when it happens if you</font>

778
00:40:21,990 --> 00:40:27,569
went to<font color="#CCCCCC"> your your</font><font color="#E5E5E5"> neighbor's computer to</font>

779
00:40:25,410 --> 00:40:29,520
trying this out and then<font color="#E5E5E5"> you have to</font>

780
00:40:27,570 --> 00:40:31,589
make<font color="#E5E5E5"> sure that everything is encrypted</font>

781
00:40:29,520 --> 00:40:34,230
so<font color="#CCCCCC"> you have to make sure that it is</font>

782
00:40:31,589 --> 00:40:36,660
<font color="#E5E5E5">hundred percent encrypted because if you</font>

783
00:40:34,230 --> 00:40:39,570
try<font color="#E5E5E5"> to make</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that you want to to do</font>

784
00:40:36,660 --> 00:40:41,790
it again<font color="#E5E5E5"> then or you want to to load the</font>

785
00:40:39,570 --> 00:40:45,000
encryption or decryption routine then

786
00:40:41,790 --> 00:40:47,960
you have to be sure that 100%<font color="#E5E5E5"> encrypted</font>

787
00:40:45,000 --> 00:40:50,940
<font color="#E5E5E5">okay and then after</font><font color="#CCCCCC"> the encryption</font><font color="#E5E5E5"> again</font>

788
00:40:47,960 --> 00:40:54,180
<font color="#E5E5E5">okay the malware still is not showing</font>

789
00:40:50,940 --> 00:40:57,780
the the<font color="#E5E5E5"> ransomware note it will trigger</font>

790
00:40:54,180 --> 00:40:59,700
<font color="#CCCCCC">another reset another reboot so the</font>

791
00:40:57,780 --> 00:41:04,530
first reboot is from the malware code

792
00:40:59,700 --> 00:41:06,689
<font color="#CCCCCC">Kay</font><font color="#E5E5E5"> a reboot API</font><font color="#CCCCCC"> anti race hard</font><font color="#E5E5E5"> error or</font>

793
00:41:04,530 --> 00:41:08,580
<font color="#E5E5E5">something and then and then</font><font color="#CCCCCC"> it will</font>

794
00:41:06,690 --> 00:41:11,609
trigger the encryption when it executes

795
00:41:08,580 --> 00:41:16,259
the the<font color="#E5E5E5"> BIOS or the MBR the kernel</font><font color="#CCCCCC"> mode</font>

796
00:41:11,609 --> 00:41:18,839
and then it will now actually it will

797
00:41:16,260 --> 00:41:20,750
actually<font color="#CCCCCC"> trigger the</font><font color="#E5E5E5"> test second reboot</font>

798
00:41:18,839 --> 00:41:23,040
<font color="#E5E5E5">okay</font>

799
00:41:20,750 --> 00:41:25,500
just<font color="#E5E5E5"> during</font><font color="#CCCCCC"> the second reboot it</font>

800
00:41:23,040 --> 00:41:28,560
<font color="#CCCCCC">inertias any initializes the big screen</font>

801
00:41:25,500 --> 00:41:31,619
<font color="#CCCCCC">okay it</font><font color="#E5E5E5"> reads sector</font><font color="#CCCCCC"> zero and checks for</font>

802
00:41:28,560 --> 00:41:34,049
the encryption martyr<font color="#E5E5E5"> and because it</font>

803
00:41:31,619 --> 00:41:36,450
doesn't matter<font color="#CCCCCC"> if you if you encrypt it</font>

804
00:41:34,050 --> 00:41:39,270
<font color="#CCCCCC">a percent</font><font color="#E5E5E5"> 100 percent it will be tagged</font>

805
00:41:36,450 --> 00:41:39,839
as encrypted<font color="#E5E5E5"> okay and then if it</font><font color="#CCCCCC"> is</font>

806
00:41:39,270 --> 00:41:44,339
encrypted

807
00:41:39,839 --> 00:41:51,960
it will now show that<font color="#CCCCCC"> ransom note</font><font color="#E5E5E5"> which</font>

808
00:41:44,339 --> 00:41:52,830
is<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is how it actually</font><font color="#CCCCCC"> generates K</font>

809
00:41:51,960 --> 00:41:56,490
again

810
00:41:52,830 --> 00:41:59,310
the display is using<font color="#CCCCCC"> interrupt</font><font color="#E5E5E5"> n</font><font color="#CCCCCC"> okay</font>

811
00:41:56,490 --> 00:42:02,220
and then it is now showing some some

812
00:41:59,310 --> 00:42:06,599
graphics<font color="#CCCCCC"> K it's like an ASCII graphics</font>

813
00:42:02,220 --> 00:42:10,200
<font color="#CCCCCC">because</font><font color="#E5E5E5"> you don't have yet the the the</font>

814
00:42:06,599 --> 00:42:12,030
other other<font color="#CCCCCC"> ApS that</font><font color="#E5E5E5"> generates the 1080p</font>

815
00:42:10,200 --> 00:42:15,480
<font color="#E5E5E5">graphics and so on and so forth so those</font>

816
00:42:12,030 --> 00:42:19,560
are actually<font color="#CCCCCC"> just an</font><font color="#E5E5E5"> ASCII display</font>

817
00:42:15,480 --> 00:42:21,570
the one that scares people<font color="#E5E5E5"> is actually</font>

818
00:42:19,560 --> 00:42:24,390
just an<font color="#E5E5E5"> ASCII display it is being</font>

819
00:42:21,570 --> 00:42:27,180
executed<font color="#CCCCCC"> see I am actually</font><font color="#E5E5E5"> following the</font>

820
00:42:24,390 --> 00:42:30,990
<font color="#CCCCCC">actual code being gendered particular</font>

821
00:42:27,180 --> 00:42:35,879
part is being generated<font color="#CCCCCC"> okay the</font><font color="#E5E5E5"> ASCII</font>

822
00:42:30,990 --> 00:42:41,250
is this is that is the<font color="#E5E5E5"> ASCII skull it is</font>

823
00:42:35,880 --> 00:42:44,760
now going<font color="#E5E5E5"> to do some flashing again it</font>

824
00:42:41,250 --> 00:42:47,070
is using a normal interrupts<font color="#CCCCCC"> because you</font>

825
00:42:44,760 --> 00:42:50,490
are<font color="#E5E5E5"> just running the code</font><font color="#CCCCCC"> okay in your</font>

826
00:42:47,070 --> 00:42:53,610
in your<font color="#E5E5E5"> bias so you can see the that is</font>

827
00:42:50,490 --> 00:42:54,930
now the that is how<font color="#CCCCCC"> Pecha actually</font>

828
00:42:53,610 --> 00:42:57,660
<font color="#E5E5E5">encryption system</font>

829
00:42:54,930 --> 00:42:59,730
so when whenever it tries to if you

830
00:42:57,660 --> 00:43:03,120
tries to reboot the system<font color="#E5E5E5"> impacted with</font>

831
00:42:59,730 --> 00:43:05,250
<font color="#CCCCCC">Pecha</font><font color="#E5E5E5"> it is actually just checking if it</font>

832
00:43:03,120 --> 00:43:07,830
is already encrypted or not if it is and

833
00:43:05,250 --> 00:43:13,160
then you're going<font color="#CCCCCC"> to actually</font><font color="#E5E5E5"> have the</font>

834
00:43:07,830 --> 00:43:19,549
ransomware<font color="#E5E5E5"> node okay again I removed</font><font color="#CCCCCC"> the</font>

835
00:43:13,160 --> 00:43:19,549
oops I clicked the<font color="#CCCCCC"> wrong thing so</font>

836
00:43:20,360 --> 00:43:27,210
<font color="#CCCCCC">somewhere</font><font color="#E5E5E5"> here okay I tried some of the</font>

837
00:43:24,750 --> 00:43:29,880
combinations<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then because you</font><font color="#CCCCCC"> are in</font>

838
00:43:27,210 --> 00:43:33,810
a debugger<font color="#CCCCCC"> you can just jump somewhere</font>

839
00:43:29,880 --> 00:43:36,720
<font color="#CCCCCC">okay going</font><font color="#E5E5E5"> put the checking of the</font><font color="#CCCCCC"> code</font>

840
00:43:33,810 --> 00:43:39,960
and then put my<font color="#CCCCCC"> name there</font><font color="#E5E5E5"> as a key okay</font>

841
00:43:36,720 --> 00:43:42,359
<font color="#CCCCCC">because I just trick the system</font><font color="#E5E5E5"> that it</font>

842
00:43:39,960 --> 00:43:45,420
is the actual<font color="#E5E5E5"> key and then it will</font>

843
00:43:42,360 --> 00:43:47,250
actually if you<font color="#E5E5E5"> have the actual key it</font>

844
00:43:45,420 --> 00:43:49,830
will<font color="#CCCCCC"> actually run the regression similar</font>

845
00:43:47,250 --> 00:43:51,930
to the encryption<font color="#E5E5E5"> earlier but this one</font>

846
00:43:49,830 --> 00:43:54,750
because I just<font color="#CCCCCC"> tricked the system that</font>

847
00:43:51,930 --> 00:43:57,600
it is it is the<font color="#E5E5E5"> actual key it is not</font>

848
00:43:54,750 --> 00:44:01,530
actually decrypting the<font color="#E5E5E5"> the system okay</font>

849
00:43:57,600 --> 00:44:06,240
<font color="#E5E5E5">my my</font><font color="#CCCCCC"> MFT is still encrypted</font><font color="#E5E5E5"> and then</font>

850
00:44:01,530 --> 00:44:08,310
now once it the clips<font color="#E5E5E5"> it thinks that it</font>

851
00:44:06,240 --> 00:44:11,069
decrypts your system it is now asking

852
00:44:08,310 --> 00:44:13,100
<font color="#CCCCCC">you it doesn't actually reboot itself it</font>

853
00:44:11,070 --> 00:44:16,580
<font color="#E5E5E5">is now asking</font><font color="#CCCCCC"> you to reboot your system</font>

854
00:44:13,100 --> 00:44:18,930
<font color="#E5E5E5">because it thinks that you now</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> the</font>

855
00:44:16,580 --> 00:44:21,000
decrypted system<font color="#E5E5E5"> okay</font>

856
00:44:18,930 --> 00:44:23,190
the only problem with picture another

857
00:44:21,000 --> 00:44:25,230
problem with patient action is if you're

858
00:44:23,190 --> 00:44:28,859
<font color="#CCCCCC">infected</font><font color="#E5E5E5"> if you're a regular you said</font>

859
00:44:25,230 --> 00:44:31,380
user at home<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> infected okay</font>

860
00:44:28,859 --> 00:44:34,980
only have one machine<font color="#E5E5E5"> there is no way to</font>

861
00:44:31,380 --> 00:44:37,739
<font color="#E5E5E5">go online and paper the plan</font><font color="#CCCCCC"> somewhere</font>

862
00:44:34,980 --> 00:44:39,089
right<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> to to go again to</font><font color="#E5E5E5"> your</font>

863
00:44:37,739 --> 00:44:40,920
<font color="#CCCCCC">neighborhood that's why I</font><font color="#E5E5E5"> had to you</font>

864
00:44:39,089 --> 00:44:43,349
have<font color="#E5E5E5"> to impact</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> neighbor system so</font>

865
00:44:40,920 --> 00:44:46,680
that you can use your your other system

866
00:44:43,349 --> 00:44:49,710
to pay right<font color="#E5E5E5"> if you're working in an</font>

867
00:44:46,680 --> 00:44:51,629
<font color="#CCCCCC">environment where in you have machines</font>

868
00:44:49,710 --> 00:44:53,730
different<font color="#E5E5E5"> machines you can impact the</font>

869
00:44:51,630 --> 00:44:55,499
<font color="#CCCCCC">system other</font><font color="#E5E5E5"> system you can</font><font color="#CCCCCC"> use that</font><font color="#E5E5E5"> the</font>

870
00:44:53,730 --> 00:44:57,960
system to pay<font color="#E5E5E5"> okay</font>

871
00:44:55,499 --> 00:45:00,390
luckily there are different<font color="#E5E5E5"> versions of</font>

872
00:44:57,960 --> 00:45:02,759
<font color="#CCCCCC">patria we have done at Patea i think bad</font>

873
00:45:00,390 --> 00:45:05,940
rabbit<font color="#E5E5E5"> is also some sort</font><font color="#CCCCCC"> of a</font><font color="#E5E5E5"> page and</font>

874
00:45:02,759 --> 00:45:08,940
<font color="#CCCCCC">so</font><font color="#E5E5E5"> on the actual the the malware author</font>

875
00:45:05,940 --> 00:45:11,249
gave<font color="#E5E5E5"> away the master code if you're</font>

876
00:45:08,940 --> 00:45:13,440
infected<font color="#E5E5E5"> with still infected with Petra</font>

877
00:45:11,249 --> 00:45:15,269
<font color="#CCCCCC">okay you can actually use the master</font>

878
00:45:13,440 --> 00:45:18,720
<font color="#E5E5E5">code that's what they said happen</font>

879
00:45:15,269 --> 00:45:21,839
actually<font color="#CCCCCC"> his that and and actually if</font>

880
00:45:18,720 --> 00:45:24,749
<font color="#CCCCCC">your if your</font><font color="#E5E5E5"> machine is</font><font color="#CCCCCC"> already infected</font>

881
00:45:21,839 --> 00:45:27,690
<font color="#CCCCCC">before and then you just</font><font color="#E5E5E5"> already reset</font>

882
00:45:24,749 --> 00:45:31,078
<font color="#E5E5E5">the</font><font color="#CCCCCC"> system</font><font color="#E5E5E5"> or or reformatted it so you</font>

883
00:45:27,690 --> 00:45:37,369
<font color="#E5E5E5">would not be able to use the the</font>

884
00:45:31,079 --> 00:45:41,130
<font color="#E5E5E5">decryption code we're done</font><font color="#CCCCCC"> poppin ollie</font>

885
00:45:37,369 --> 00:45:43,650
<font color="#CCCCCC">okay Stage one pager</font><font color="#E5E5E5"> encrypting patch</font>

886
00:45:41,130 --> 00:45:46,680
and patient has different<font color="#E5E5E5"> stages stage</font>

887
00:45:43,650 --> 00:45:50,910
<font color="#E5E5E5">one it covers the MBR</font><font color="#CCCCCC"> mini kernel code</font>

888
00:45:46,680 --> 00:45:54,538
to the<font color="#E5E5E5"> hard drive initiates reboot</font><font color="#CCCCCC"> stage</font>

889
00:45:50,910 --> 00:45:57,839
<font color="#CCCCCC">two it</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> place the page check this and</font>

890
00:45:54,539 --> 00:46:01,200
<font color="#CCCCCC">Clips your</font><font color="#E5E5E5"> empty table initiates the</font>

891
00:45:57,839 --> 00:46:03,960
<font color="#E5E5E5">secondary boot okay in this place when</font>

892
00:46:01,200 --> 00:46:07,828
<font color="#E5E5E5">it wristed restarts this place your ask</font>

893
00:46:03,960 --> 00:46:11,599
is called and now<font color="#CCCCCC"> is for Bitcoin payment</font>

894
00:46:07,829 --> 00:46:14,999
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> I don't actually suggest</font><font color="#E5E5E5"> paying the</font>

895
00:46:11,599 --> 00:46:17,400
<font color="#CCCCCC">ransomware you know why if they know</font>

896
00:46:14,999 --> 00:46:20,368
that<font color="#E5E5E5"> you are when you</font><font color="#CCCCCC"> are infected</font><font color="#E5E5E5"> and</font>

897
00:46:17,400 --> 00:46:21,900
<font color="#CCCCCC">you pay they will creep impacting you</font>

898
00:46:20,369 --> 00:46:23,970
they<font color="#E5E5E5"> will tell the</font><font color="#CCCCCC"> other ransomware</font>

899
00:46:21,900 --> 00:46:29,999
<font color="#E5E5E5">authors to impact you because you pay</font>

900
00:46:23,970 --> 00:46:31,499
right<font color="#E5E5E5"> that's why never</font><font color="#CCCCCC"> pay and these are</font>

901
00:46:29,999 --> 00:46:36,118
some of the<font color="#E5E5E5"> tools that I use the disk</font>

902
00:46:31,499 --> 00:46:38,488
<font color="#E5E5E5">management only debug x64</font><font color="#CCCCCC"> DB g k if</font><font color="#E5E5E5"> you</font>

903
00:46:36,119 --> 00:46:41,460
are trying if you have a malware version

904
00:46:38,489 --> 00:46:42,750
which is<font color="#E5E5E5"> 64 only cannot cannot cannot</font>

905
00:46:41,460 --> 00:46:47,450
debug it so you

906
00:46:42,750 --> 00:46:50,910
use the x64<font color="#CCCCCC"> dbg</font><font color="#E5E5E5"> okay I have the</font><font color="#CCCCCC"> wind obj</font>

907
00:46:47,450 --> 00:47:01,580
process monitor<font color="#E5E5E5"> HD half and of course</font>

908
00:46:50,910 --> 00:47:01,580
our debugger<font color="#E5E5E5"> the emulator and that's it</font>

909
00:47:03,470 --> 00:47:12,930
thank you any question who wants to

910
00:47:10,890 --> 00:47:19,470
<font color="#CCCCCC">impact their system I'm not giving away</font>

911
00:47:12,930 --> 00:47:26,160
<font color="#E5E5E5">the sample question</font><font color="#CCCCCC"> oh you're sleeping</font>

912
00:47:19,470 --> 00:47:32,640
the whole<font color="#E5E5E5"> time come on</font><font color="#CCCCCC"> shun we have two</font>

913
00:47:26,160 --> 00:47:35,450
minutes or you're hungry already<font color="#E5E5E5"> it's</font>

914
00:47:32,640 --> 00:47:37,799
lunch time<font color="#E5E5E5"> right after this</font>

915
00:47:35,450 --> 00:47:39,600
come on<font color="#CCCCCC"> I came all the way from</font>

916
00:47:37,800 --> 00:47:43,410
<font color="#CCCCCC">Vancouver and</font><font color="#E5E5E5"> then you're not asking</font>

917
00:47:39,600 --> 00:47:46,040
<font color="#CCCCCC">questions</font><font color="#E5E5E5"> no questions</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> oh I'll give</font>

918
00:47:43,410 --> 00:47:46,040
<font color="#E5E5E5">you a copy later</font>

919
00:47:47,000 --> 00:47:54,030
so I guess what<font color="#CCCCCC"> paycheck doesn't encrypt</font>

920
00:47:51,030 --> 00:47:56,610
your<font color="#CCCCCC"> MFG we've keep at it stalls in the</font>

921
00:47:54,030 --> 00:47:59,280
harddrive<font color="#E5E5E5"> so it does it encrypt it with</font>

922
00:47:56,610 --> 00:48:01,740
<font color="#CCCCCC">a public</font><font color="#E5E5E5"> key</font><font color="#CCCCCC"> and then when you purchase</font>

923
00:47:59,280 --> 00:48:04,440
the heat a private key which<font color="#E5E5E5"> you can use</font>

924
00:48:01,740 --> 00:48:08,060
to decrypt<font color="#E5E5E5"> also finger</font><font color="#CCCCCC"> but you're asking</font>

925
00:48:04,440 --> 00:48:10,830
<font color="#CCCCCC">if</font><font color="#E5E5E5"> the duck is still installed in your</font>

926
00:48:08,060 --> 00:48:12,660
<font color="#E5E5E5">lab no no it's not installed in</font><font color="#CCCCCC"> your</font>

927
00:48:10,830 --> 00:48:14,520
<font color="#CCCCCC">heart that's</font><font color="#E5E5E5"> why you have to go to the</font>

928
00:48:12,660 --> 00:48:17,670
onion address<font color="#CCCCCC"> and then they will give</font>

929
00:48:14,520 --> 00:48:20,730
you the ducky<font color="#CCCCCC"> they you will give them</font>

930
00:48:17,670 --> 00:48:27,450
the code<font color="#E5E5E5"> so it's a is a private key</font><font color="#CCCCCC"> but</font>

931
00:48:20,730 --> 00:48:29,820
you<font color="#E5E5E5"> purchase yeah</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> there is a way in</font>

932
00:48:27,450 --> 00:48:32,870
which<font color="#CCCCCC"> for this</font><font color="#E5E5E5"> particular version of the</font>

933
00:48:29,820 --> 00:48:36,270
<font color="#CCCCCC">malware in were in</font><font color="#E5E5E5"> because it is only</font>

934
00:48:32,870 --> 00:48:38,490
encrypting your<font color="#CCCCCC"> mep</font><font color="#E5E5E5"> if you have time you</font>

935
00:48:36,270 --> 00:48:40,320
can actually<font color="#E5E5E5"> use forensic tools were in</font>

936
00:48:38,490 --> 00:48:43,709
it can just brute porsche your hard

937
00:48:40,320 --> 00:48:46,590
drive and<font color="#E5E5E5"> then grabs the your wife</font><font color="#CCCCCC"> you</font>

938
00:48:43,710 --> 00:48:47,070
<font color="#E5E5E5">can actually do that oh that's your</font>

939
00:48:46,590 --> 00:48:49,950
question

940
00:48:47,070 --> 00:48:52,200
see<font color="#CCCCCC"> i can read your mind so that is</font>

941
00:48:49,950 --> 00:48:56,519
supposed to be<font color="#CCCCCC"> his question but we can</font>

942
00:48:52,200 --> 00:48:58,808
<font color="#E5E5E5">just brute force the the drive yeah see</font>

943
00:48:56,519 --> 00:49:07,660
any other question I can read your

944
00:48:58,809 --> 00:49:09,609
question anybody<font color="#CCCCCC"> does it thank you very</font>

945
00:49:07,660 --> 00:49:10,430
<font color="#CCCCCC">much for</font><font color="#E5E5E5"> your time thank</font><font color="#CCCCCC"> you very much</font>

946
00:49:09,609 --> 00:49:14,489
<font color="#CCCCCC">foul</font>

947
00:49:10,430 --> 00:49:14,489
[Applause]

