1
00:00:06,810 --> 00:00:10,570
[Music]

2
00:00:13,040 --> 00:00:20,009
thank you<font color="#CCCCCC"> thank you very</font><font color="#E5E5E5"> much okay thank</font>

3
00:00:16,710 --> 00:00:24,390
you<font color="#CCCCCC"> for</font><font color="#E5E5E5"> coming back from lunch</font><font color="#CCCCCC"> I hope to</font>

4
00:00:20,010 --> 00:00:29,939
keep<font color="#E5E5E5"> you guys awake</font><font color="#CCCCCC"> okay so my name is</font>

5
00:00:24,390 --> 00:00:33,600
tal and I hope you can see<font color="#E5E5E5"> so we will</font>

6
00:00:29,939 --> 00:00:36,810
discuss<font color="#CCCCCC"> in this in this lecture</font><font color="#E5E5E5"> I will</font>

7
00:00:33,600 --> 00:00:41,300
<font color="#CCCCCC">demonstrate</font><font color="#E5E5E5"> how we can use the</font>

8
00:00:36,810 --> 00:00:46,440
<font color="#E5E5E5">insecurities of Bluetooth smart to hack</font>

9
00:00:41,300 --> 00:00:50,309
<font color="#E5E5E5">well to hack smartphones using the</font>

10
00:00:46,440 --> 00:00:53,968
application level<font color="#E5E5E5"> we will briefly go</font>

11
00:00:50,309 --> 00:00:58,289
over the Bluetooth<font color="#E5E5E5"> security aspects and</font>

12
00:00:53,969 --> 00:01:00,260
then we will see how we<font color="#CCCCCC"> can perform</font><font color="#E5E5E5"> an</font>

13
00:00:58,289 --> 00:01:05,340
in the<font color="#E5E5E5"> middle active</font><font color="#CCCCCC"> man in the middle</font>

14
00:01:00,260 --> 00:01:08,550
attack between the device to<font color="#E5E5E5"> the app to</font>

15
00:01:05,340 --> 00:01:11,580
designate it<font color="#E5E5E5"> up or any app and then we</font>

16
00:01:08,550 --> 00:01:14,369
see<font color="#CCCCCC"> we'll see a few tools and how we can</font>

17
00:01:11,580 --> 00:01:17,840
tamper with the data or<font color="#CCCCCC"> perform replay</font>

18
00:01:14,369 --> 00:01:23,759
attack that eventually<font color="#E5E5E5"> will perform</font>

19
00:01:17,840 --> 00:01:29,250
actions on our<font color="#E5E5E5"> smartphone</font><font color="#CCCCCC"> ok so my name</font>

20
00:01:23,759 --> 00:01:31,079
<font color="#CCCCCC">is tal been working in the InfoSec cyber</font>

21
00:01:29,250 --> 00:01:34,229
<font color="#CCCCCC">security how you want to call it</font><font color="#E5E5E5"> for</font>

22
00:01:31,079 --> 00:01:36,990
<font color="#CCCCCC">more than</font><font color="#E5E5E5"> 12 years currently I'm working</font>

23
00:01:34,229 --> 00:01:42,420
with few companies<font color="#E5E5E5"> up seek labs in</font>

24
00:01:36,990 --> 00:01:46,130
Israel<font color="#CCCCCC"> see knack if you know by private</font>

25
00:01:42,420 --> 00:01:50,610
<font color="#E5E5E5">but bug bounty bug bounty services and</font>

26
00:01:46,130 --> 00:01:55,710
<font color="#CCCCCC">fbk she's research european research</font>

27
00:01:50,610 --> 00:01:58,619
facility in italy<font color="#CCCCCC"> i also established</font>

28
00:01:55,710 --> 00:01:59,880
<font color="#E5E5E5">besides toronto we'll talk about it</font>

29
00:01:58,619 --> 00:02:02,670
later

30
00:01:59,880 --> 00:02:06,810
previously<font color="#CCCCCC"> I've been working with RSA</font>

31
00:02:02,670 --> 00:02:11,130
and checkpoint<font color="#CCCCCC"> and you can</font><font color="#E5E5E5"> follow me at</font>

32
00:02:06,810 --> 00:02:18,590
my website<font color="#CCCCCC"> AB 6.80 or</font><font color="#E5E5E5"> my twin</font><font color="#CCCCCC"> twitter</font>

33
00:02:11,130 --> 00:02:18,590
<font color="#E5E5E5">handle</font><font color="#CCCCCC"> okay let me just</font><font color="#E5E5E5"> can you see</font>

34
00:02:19,879 --> 00:02:27,649
<font color="#E5E5E5">okay let me</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> explain to you</font><font color="#CCCCCC"> guys so</font>

35
00:02:24,290 --> 00:02:32,489
<font color="#E5E5E5">just a few words about myself so I'm</font>

36
00:02:27,650 --> 00:02:36,209
from<font color="#E5E5E5"> Israel originally recently I've</font>

37
00:02:32,489 --> 00:02:40,319
moved<font color="#E5E5E5"> to Trento Italy</font><font color="#CCCCCC"> which is a very</font>

38
00:02:36,209 --> 00:02:45,060
<font color="#E5E5E5">north city in Italy on the on the</font>

39
00:02:40,319 --> 00:02:47,730
<font color="#CCCCCC">Dolomites and I moved there because my</font>

40
00:02:45,060 --> 00:02:52,680
wife<font color="#CCCCCC"> it is my wife's hometown and</font><font color="#E5E5E5"> we</font>

41
00:02:47,730 --> 00:02:56,670
<font color="#E5E5E5">just had our</font><font color="#CCCCCC"> first baby there and so I</font>

42
00:02:52,680 --> 00:02:59,370
thought Geneva<font color="#CCCCCC"> tend to very close to</font>

43
00:02:56,670 --> 00:03:02,129
each<font color="#CCCCCC"> other</font><font color="#E5E5E5"> would</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> very easy to go here</font>

44
00:02:59,370 --> 00:03:05,730
<font color="#CCCCCC">so I thought what would be</font><font color="#E5E5E5"> the best</font>

45
00:03:02,129 --> 00:03:09,590
<font color="#CCCCCC">solution to to get there it's a</font><font color="#E5E5E5"> one-hour</font>

46
00:03:05,730 --> 00:03:12,358
<font color="#CCCCCC">flight if you measure the distance so</font>

47
00:03:09,590 --> 00:03:19,169
the problem was<font color="#CCCCCC"> that Trento doesn't have</font>

48
00:03:12,359 --> 00:03:21,329
an airport<font color="#E5E5E5"> so this plan went went away</font>

49
00:03:19,169 --> 00:03:24,659
so<font color="#E5E5E5"> I thought about</font><font color="#CCCCCC"> okay next best</font>

50
00:03:21,329 --> 00:03:27,269
solution<font color="#CCCCCC"> would be</font><font color="#E5E5E5"> one drive to Verona</font>

51
00:03:24,659 --> 00:03:30,929
<font color="#CCCCCC">which is one hour</font><font color="#E5E5E5"> away from 10th oh and</font>

52
00:03:27,269 --> 00:03:34,109
then one<font color="#CCCCCC"> hour</font><font color="#E5E5E5"> flight to Geneva but no</font>

53
00:03:30,930 --> 00:03:37,470
direct<font color="#CCCCCC"> flights</font><font color="#E5E5E5"> from Rome to Geneva</font><font color="#CCCCCC"> okay</font>

54
00:03:34,109 --> 00:03:38,729
what would be the second<font color="#E5E5E5"> best or the the</font>

55
00:03:37,470 --> 00:03:41,010
other<font color="#CCCCCC"> the</font><font color="#E5E5E5"> possibly the real</font>

56
00:03:38,729 --> 00:03:43,379
possibilities so what should<font color="#E5E5E5"> that what</font>

57
00:03:41,010 --> 00:03:47,819
would have happened is that<font color="#CCCCCC"> I plan to</font>

58
00:03:43,379 --> 00:03:49,500
leave<font color="#CCCCCC"> to enter</font><font color="#E5E5E5"> to Verona</font><font color="#CCCCCC"> and then take</font>

59
00:03:47,819 --> 00:03:52,290
the flight from<font color="#E5E5E5"> there with</font><font color="#CCCCCC"> Direction</font>

60
00:03:49,500 --> 00:03:55,889
<font color="#E5E5E5">connection</font><font color="#CCCCCC"> flight and land in Geneva at</font>

61
00:03:52,290 --> 00:03:58,349
<font color="#E5E5E5">5</font><font color="#CCCCCC"> p.m. so one hour drive to Verona one</font>

62
00:03:55,889 --> 00:04:00,900
hour<font color="#CCCCCC"> I gave myself a security gap for</font>

63
00:03:58,349 --> 00:04:02,608
the security checks checking and traffic

64
00:04:00,900 --> 00:04:04,650
possibilities<font color="#CCCCCC"> one hour flight to</font>

65
00:04:02,609 --> 00:04:07,459
Frankfurt<font color="#E5E5E5"> one hour connection and</font>

66
00:04:04,650 --> 00:04:11,189
another hour flight to<font color="#E5E5E5"> Geneva</font><font color="#CCCCCC"> total time</font>

67
00:04:07,459 --> 00:04:12,949
<font color="#CCCCCC">five point five hours okay it's not</font>

68
00:04:11,189 --> 00:04:17,459
great<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> not that bad</font>

69
00:04:12,949 --> 00:04:20,310
but what actually happened is that 11:30

70
00:04:17,459 --> 00:04:23,240
a.m.<font color="#E5E5E5"> I was living to enter one hour</font>

71
00:04:20,310 --> 00:04:26,099
later I arrived at the Verona Airport

72
00:04:23,240 --> 00:04:28,139
<font color="#E5E5E5">then after doing the</font><font color="#CCCCCC"> security checks I</font>

73
00:04:26,099 --> 00:04:31,560
<font color="#E5E5E5">realized I forgot my passport</font><font color="#CCCCCC"> at home</font>

74
00:04:28,139 --> 00:04:33,120
and there was<font color="#E5E5E5"> no way for</font><font color="#CCCCCC"> me to go back</font>

75
00:04:31,560 --> 00:04:38,100
<font color="#CCCCCC">and forth because I had no</font>

76
00:04:33,120 --> 00:04:39,990
time left<font color="#CCCCCC"> so I</font><font color="#E5E5E5"> was thinking about the</font>

77
00:04:38,100 --> 00:04:42,710
solution<font color="#CCCCCC"> after trying to</font><font color="#E5E5E5"> convince them</font>

78
00:04:39,990 --> 00:04:44,910
to let<font color="#CCCCCC"> me fly anyway but it didn't work</font>

79
00:04:42,710 --> 00:04:48,030
so I was<font color="#E5E5E5"> thinking checking trains</font>

80
00:04:44,910 --> 00:04:48,360
everything nothing really came came out

81
00:04:48,030 --> 00:04:52,169
great

82
00:04:48,360 --> 00:04:54,860
<font color="#E5E5E5">at</font><font color="#CCCCCC"> 2</font><font color="#E5E5E5"> p.m. I found</font><font color="#CCCCCC"> a solution I will go</font>

83
00:04:52,169 --> 00:04:59,430
back<font color="#E5E5E5"> to</font><font color="#CCCCCC"> tanto</font><font color="#E5E5E5"> I have take my passport</font>

84
00:04:54,860 --> 00:05:01,590
<font color="#CCCCCC">get on a train to Verona from Verona</font>

85
00:04:59,430 --> 00:05:06,389
I will go to Geneva<font color="#CCCCCC"> but</font><font color="#E5E5E5"> the problem is</font>

86
00:05:01,590 --> 00:05:10,469
<font color="#E5E5E5">it's seven hours</font><font color="#CCCCCC"> drain</font><font color="#E5E5E5"> plus it was late</font>

87
00:05:06,389 --> 00:05:14,010
<font color="#CCCCCC">so I arrived</font><font color="#E5E5E5"> not at 11:30 but actually</font>

88
00:05:10,470 --> 00:05:17,190
at 1:00<font color="#CCCCCC"> I am at the</font><font color="#E5E5E5"> hotel so instead of</font>

89
00:05:14,010 --> 00:05:19,440
one hour flight or<font color="#E5E5E5"> which would be the</font>

90
00:05:17,190 --> 00:05:22,550
best<font color="#E5E5E5"> option</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> took me more than 12</font>

91
00:05:19,440 --> 00:05:27,240
hours<font color="#E5E5E5"> to get here but I'm still here</font>

92
00:05:22,550 --> 00:05:29,880
<font color="#CCCCCC">okay I made everything to be</font><font color="#E5E5E5"> now thank</font>

93
00:05:27,240 --> 00:05:32,760
<font color="#E5E5E5">you thank you made every made sure that</font>

94
00:05:29,880 --> 00:05:36,330
you'll<font color="#CCCCCC"> be</font><font color="#E5E5E5"> able to see this</font><font color="#CCCCCC"> this talk</font>

95
00:05:32,760 --> 00:05:39,330
okay so just<font color="#E5E5E5"> short</font><font color="#CCCCCC"> acknowledgments so</font>

96
00:05:36,330 --> 00:05:44,820
I've been<font color="#E5E5E5"> doing this</font><font color="#CCCCCC"> research at Absa</font>

97
00:05:39,330 --> 00:05:46,919
collabs<font color="#CCCCCC"> we specialize at OPSEC so IOT is</font>

98
00:05:44,820 --> 00:05:49,169
one<font color="#E5E5E5"> aspect of it and</font><font color="#CCCCCC"> we've</font><font color="#E5E5E5"> been</font><font color="#CCCCCC"> doing a</font>

99
00:05:46,919 --> 00:05:51,659
<font color="#CCCCCC">lot of research in this field</font><font color="#E5E5E5"> and this</font>

100
00:05:49,169 --> 00:05:55,680
<font color="#E5E5E5">is just part of it</font><font color="#CCCCCC"> I would also</font><font color="#E5E5E5"> like to</font>

101
00:05:51,660 --> 00:05:59,610
<font color="#E5E5E5">thanks</font><font color="#CCCCCC"> Slav Amir which is one of the</font>

102
00:05:55,680 --> 00:06:04,050
pioneers<font color="#CCCCCC"> of this field of the ble</font>

103
00:05:59,610 --> 00:06:05,190
security which you can follow there<font color="#CCCCCC"> ok</font>

104
00:06:04,050 --> 00:06:08,340
<font color="#E5E5E5">let's start</font>

105
00:06:05,190 --> 00:06:10,889
<font color="#E5E5E5">what is ble</font><font color="#CCCCCC"> short cut for</font><font color="#E5E5E5"> Bluetooth Low</font>

106
00:06:08,340 --> 00:06:15,359
<font color="#E5E5E5">Energy</font><font color="#CCCCCC"> also called</font><font color="#E5E5E5"> Bluetooth smart</font><font color="#CCCCCC"> hence</font>

107
00:06:10,889 --> 00:06:18,810
<font color="#E5E5E5">that title</font><font color="#CCCCCC"> it was part it is part of</font>

108
00:06:15,360 --> 00:06:21,090
Bluetooth 4.0<font color="#CCCCCC"> ok it is designed to be</font>

109
00:06:18,810 --> 00:06:25,500
<font color="#E5E5E5">power efficient and smaller and</font><font color="#CCCCCC"> cheaper</font>

110
00:06:21,090 --> 00:06:28,138
<font color="#CCCCCC">so now with the well IOT now is</font>

111
00:06:25,500 --> 00:06:30,360
everywhere<font color="#E5E5E5"> I'm pretty sure that half of</font>

112
00:06:28,139 --> 00:06:35,630
you wear<font color="#E5E5E5"> something that is related to</font>

113
00:06:30,360 --> 00:06:39,090
IOT<font color="#CCCCCC"> so it's designed</font><font color="#E5E5E5"> to be smaller more</font>

114
00:06:35,630 --> 00:06:41,909
<font color="#CCCCCC">efficient</font><font color="#E5E5E5"> low-cost so we can actually</font>

115
00:06:39,090 --> 00:06:46,919
<font color="#E5E5E5">start developing a lot of a lot of stuff</font>

116
00:06:41,909 --> 00:06:48,060
using ble so we

117
00:06:46,920 --> 00:06:52,380
can find<font color="#CCCCCC"> it everywhere</font><font color="#E5E5E5"> of course</font>

118
00:06:48,060 --> 00:06:56,130
wearables watches<font color="#CCCCCC"> and then</font><font color="#E5E5E5"> at home smart</font>

119
00:06:52,380 --> 00:06:58,830
<font color="#E5E5E5">homes</font><font color="#CCCCCC"> light bulbs</font><font color="#E5E5E5"> smart plugs medical</font>

120
00:06:56,130 --> 00:07:02,790
devices<font color="#E5E5E5"> any other thing that you can</font>

121
00:06:58,830 --> 00:07:04,979
<font color="#CCCCCC">think of think of</font><font color="#E5E5E5"> okay what is the</font>

122
00:07:02,790 --> 00:07:06,750
difference between<font color="#E5E5E5"> Bluetooth classic</font>

123
00:07:04,980 --> 00:07:09,870
<font color="#E5E5E5">that the original boot is that we know</font>

124
00:07:06,750 --> 00:07:11,880
and<font color="#CCCCCC"> Billie so they totally different</font>

125
00:07:09,870 --> 00:07:15,420
<font color="#E5E5E5">they cannot talk with each other it's a</font>

126
00:07:11,880 --> 00:07:16,890
different protocol<font color="#E5E5E5"> they have different</font>

127
00:07:15,420 --> 00:07:19,140
architecture different modulation

128
00:07:16,890 --> 00:07:22,860
<font color="#E5E5E5">different channels different</font><font color="#CCCCCC"> packet</font>

129
00:07:19,140 --> 00:07:26,909
formats etc etc so when we talk about

130
00:07:22,860 --> 00:07:29,490
ble<font color="#E5E5E5"> it's actually</font><font color="#CCCCCC"> bluetooth</font><font color="#E5E5E5"> but it's a</font>

131
00:07:26,910 --> 00:07:31,200
different protocol so it<font color="#E5E5E5"> doesn't it's</font>

132
00:07:29,490 --> 00:07:34,500
not<font color="#E5E5E5"> compatible back it's not backward</font>

133
00:07:31,200 --> 00:07:36,030
<font color="#CCCCCC">compatible okay so where is the</font><font color="#E5E5E5"> risk is</font>

134
00:07:34,500 --> 00:07:40,820
everywhere<font color="#E5E5E5"> actually</font>

135
00:07:36,030 --> 00:07:42,239
so just probably<font color="#E5E5E5"> seen a lot lately with</font>

136
00:07:40,820 --> 00:07:44,490
smart locks

137
00:07:42,240 --> 00:07:47,220
<font color="#E5E5E5">there are many smart locks with</font>

138
00:07:44,490 --> 00:07:50,070
<font color="#CCCCCC">Bluetooth that based on bluetooth most</font>

139
00:07:47,220 --> 00:07:54,030
of them don't<font color="#E5E5E5"> work well I mean they work</font>

140
00:07:50,070 --> 00:07:56,159
but not security wise but and if they

141
00:07:54,030 --> 00:07:58,679
are locks<font color="#E5E5E5"> and</font><font color="#CCCCCC"> they're not working</font>

142
00:07:56,160 --> 00:08:01,920
<font color="#E5E5E5">security wise well then they are not</font>

143
00:07:58,680 --> 00:08:03,840
actually working<font color="#CCCCCC"> so most of the locks</font>

144
00:08:01,920 --> 00:08:06,360
<font color="#E5E5E5">I'm not saying that all</font><font color="#CCCCCC"> of them but</font><font color="#E5E5E5"> I've</font>

145
00:08:03,840 --> 00:08:10,500
tested a few<font color="#E5E5E5"> most of the locks would be</font>

146
00:08:06,360 --> 00:08:12,870
just we'll get to that later<font color="#CCCCCC"> download</font>

147
00:08:10,500 --> 00:08:15,420
some general generic ble application

148
00:08:12,870 --> 00:08:19,980
scanner<font color="#E5E5E5"> send data to the</font><font color="#CCCCCC"> lock</font><font color="#E5E5E5"> try to</font>

149
00:08:15,420 --> 00:08:23,580
<font color="#E5E5E5">open it or any other method that we'll</font>

150
00:08:19,980 --> 00:08:26,160
see<font color="#CCCCCC"> later but you can see now</font><font color="#E5E5E5"> ble</font>

151
00:08:23,580 --> 00:08:28,950
devices everywhere<font color="#E5E5E5"> so it's come medical</font>

152
00:08:26,160 --> 00:08:31,920
equipment<font color="#CCCCCC"> I don't have to elaborate on</font>

153
00:08:28,950 --> 00:08:33,659
<font color="#CCCCCC">that but</font><font color="#E5E5E5"> just imagine that you have and</font>

154
00:08:31,920 --> 00:08:36,120
these products are real so imagine that

155
00:08:33,659 --> 00:08:39,510
<font color="#E5E5E5">you have some insulin patch on yourself</font>

156
00:08:36,120 --> 00:08:42,419
<font color="#E5E5E5">and with the</font><font color="#CCCCCC"> app you can</font><font color="#E5E5E5"> inject medicine</font>

157
00:08:39,510 --> 00:08:45,950
to your body so if someone hacks that

158
00:08:42,419 --> 00:08:49,680
yeah that's going to<font color="#E5E5E5"> be great</font>

159
00:08:45,950 --> 00:08:53,310
<font color="#CCCCCC">ok so let's really</font><font color="#E5E5E5"> review the</font>

160
00:08:49,680 --> 00:08:57,060
architecture<font color="#CCCCCC"> of Billy it is based on</font>

161
00:08:53,310 --> 00:09:00,689
three layers<font color="#CCCCCC"> controller where all the</font>

162
00:08:57,060 --> 00:09:01,079
actual controls are there so physical

163
00:09:00,690 --> 00:09:03,960
layer

164
00:09:01,080 --> 00:09:06,450
all the chips<font color="#CCCCCC"> etc and the interface for</font>

165
00:09:03,960 --> 00:09:09,530
their host the host is actually

166
00:09:06,450 --> 00:09:13,980
providing the<font color="#E5E5E5"> API for their controllers</font>

167
00:09:09,530 --> 00:09:16,800
<font color="#CCCCCC">so we will be</font><font color="#E5E5E5"> able to use them and then</font>

168
00:09:13,980 --> 00:09:20,840
<font color="#E5E5E5">there its hold also the infrastructure</font>

169
00:09:16,800 --> 00:09:23,939
which holds a security manager and other

170
00:09:20,840 --> 00:09:27,600
security controls<font color="#CCCCCC"> and we will get</font><font color="#E5E5E5"> to</font>

171
00:09:23,940 --> 00:09:30,360
that and the let's<font color="#CCCCCC"> call</font><font color="#E5E5E5"> it the interface</font>

172
00:09:27,600 --> 00:09:33,270
for the<font color="#CCCCCC"> up layer so eventually we want</font>

173
00:09:30,360 --> 00:09:36,840
<font color="#E5E5E5">to build apps that</font><font color="#CCCCCC"> will</font><font color="#E5E5E5"> be able to</font>

174
00:09:33,270 --> 00:09:39,030
<font color="#CCCCCC">communicate with the devices</font><font color="#E5E5E5"> so these</font>

175
00:09:36,840 --> 00:09:41,220
apps are<font color="#E5E5E5"> built on top on the host and</font>

176
00:09:39,030 --> 00:09:43,410
<font color="#E5E5E5">are using the specification</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> the</font>

177
00:09:41,220 --> 00:09:47,250
host provides it<font color="#E5E5E5"> okay the security</font>

178
00:09:43,410 --> 00:09:52,439
manager is the part in<font color="#CCCCCC"> the belly that</font><font color="#E5E5E5"> is</font>

179
00:09:47,250 --> 00:09:55,440
in<font color="#E5E5E5"> charge of the security of the device</font>

180
00:09:52,440 --> 00:09:58,590
<font color="#CCCCCC">oh it's in charge</font><font color="#E5E5E5"> of the pairing process</font>

181
00:09:55,440 --> 00:10:00,800
which will get that<font color="#E5E5E5"> and the key</font>

182
00:09:58,590 --> 00:10:09,840
generation<font color="#E5E5E5"> and the key exchange and</font>

183
00:10:00,800 --> 00:10:14,339
other crypto features it has a<font color="#CCCCCC"> s 128</font>

184
00:10:09,840 --> 00:10:16,560
capabilities<font color="#E5E5E5"> it uses different types of</font>

185
00:10:14,340 --> 00:10:20,040
key distribution<font color="#E5E5E5"> so here I'm going</font><font color="#CCCCCC"> to</font>

186
00:10:16,560 --> 00:10:23,790
distinguish<font color="#E5E5E5"> that this talk</font><font color="#CCCCCC"> is going</font><font color="#E5E5E5"> to</font>

187
00:10:20,040 --> 00:10:26,610
discuss ble 4.0 which is the most

188
00:10:23,790 --> 00:10:29,790
current<font color="#E5E5E5"> used protocol</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> version of the</font>

189
00:10:26,610 --> 00:10:32,730
protocol<font color="#CCCCCC"> a more</font><font color="#E5E5E5"> secure protocol was</font>

190
00:10:29,790 --> 00:10:35,819
already<font color="#E5E5E5"> implemented</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> barely</font><font color="#CCCCCC"> four</font>

191
00:10:32,730 --> 00:10:41,310
<font color="#E5E5E5">point</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> and five which is just now</font>

192
00:10:35,820 --> 00:10:44,220
getting<font color="#E5E5E5"> out and so it is already proved</font>

193
00:10:41,310 --> 00:10:46,229
that<font color="#E5E5E5"> the key exchange of 4.0 is not</font>

194
00:10:44,220 --> 00:10:50,100
secured we're not going to<font color="#E5E5E5"> discuss</font><font color="#CCCCCC"> that</font>

195
00:10:46,230 --> 00:10:53,040
you can see<font color="#CCCCCC"> a talks from mike ryan</font><font color="#E5E5E5"> and</font>

196
00:10:50,100 --> 00:10:56,990
other great talks that demonstrated<font color="#E5E5E5"> how</font>

197
00:10:53,040 --> 00:10:59,969
you can hack the connection link between

198
00:10:56,990 --> 00:11:05,330
of<font color="#E5E5E5"> bluetooth bluetooth smart bluetooth</font>

199
00:10:59,970 --> 00:11:09,600
4.0 and the pairing process<font color="#E5E5E5"> which is</font>

200
00:11:05,330 --> 00:11:11,880
which uses a key to determine the

201
00:11:09,600 --> 00:11:14,520
connection link that will then encrypt

202
00:11:11,880 --> 00:11:16,170
<font color="#E5E5E5">that the layer the communication layer</font>

203
00:11:14,520 --> 00:11:19,140
so the first thing that<font color="#E5E5E5"> you want to</font><font color="#CCCCCC"> do</font>

204
00:11:16,170 --> 00:11:21,719
when you try<font color="#CCCCCC"> to go that</font><font color="#E5E5E5"> you're doing</font>

205
00:11:19,140 --> 00:11:24,000
<font color="#E5E5E5">that when you try to connect your app to</font>

206
00:11:21,720 --> 00:11:28,050
your device<font color="#E5E5E5"> is to pair to</font><font color="#CCCCCC"> the device</font>

207
00:11:24,000 --> 00:11:30,450
hopefully<font color="#E5E5E5"> I</font><font color="#CCCCCC"> already seen many devices</font>

208
00:11:28,050 --> 00:11:33,689
<font color="#E5E5E5">that doesn't even use the pairing that</font>

209
00:11:30,450 --> 00:11:36,720
means that you can<font color="#E5E5E5"> just connect them so</font>

210
00:11:33,690 --> 00:11:41,910
<font color="#E5E5E5">no pairing you can just scan them read</font>

211
00:11:36,720 --> 00:11:45,200
<font color="#CCCCCC">data</font><font color="#E5E5E5"> and data etc so the the pairing is</font>

212
00:11:41,910 --> 00:11:48,990
a<font color="#CCCCCC"> three layer a three phase process</font>

213
00:11:45,200 --> 00:11:51,270
<font color="#E5E5E5">pairing feature exchange then short or</font>

214
00:11:48,990 --> 00:11:56,089
long term kicks<font color="#E5E5E5"> generation depends on</font>

215
00:11:51,270 --> 00:11:59,220
the protocol<font color="#E5E5E5"> and transport of the key</font>

216
00:11:56,089 --> 00:12:02,010
I'm<font color="#CCCCCC"> going to shortly review it and</font><font color="#E5E5E5"> then</font>

217
00:11:59,220 --> 00:12:08,820
<font color="#CCCCCC">we'll get</font><font color="#E5E5E5"> to the</font><font color="#CCCCCC"> interesting application</font>

218
00:12:02,010 --> 00:12:11,520
layer sorry<font color="#E5E5E5"> okay so the first step when</font>

219
00:12:08,820 --> 00:12:14,640
you want to<font color="#E5E5E5"> connect to</font><font color="#CCCCCC"> a device is that</font>

220
00:12:11,520 --> 00:12:16,860
the device let's<font color="#E5E5E5"> say that we have an</font>

221
00:12:14,640 --> 00:12:20,300
application<font color="#CCCCCC"> that is going to talk</font><font color="#E5E5E5"> to a</font>

222
00:12:16,860 --> 00:12:23,190
Bluetooth<font color="#CCCCCC"> device and so they exchange</font>

223
00:12:20,300 --> 00:12:24,959
<font color="#E5E5E5">capabilities</font><font color="#CCCCCC"> what is the capabilities is</font>

224
00:12:23,190 --> 00:12:28,470
that each device<font color="#CCCCCC"> has different</font>

225
00:12:24,959 --> 00:12:31,439
<font color="#E5E5E5">capabilities of pairing</font><font color="#CCCCCC"> and we'll see</font>

226
00:12:28,470 --> 00:12:35,040
three types of capabilities<font color="#CCCCCC"> in a second</font>

227
00:12:31,440 --> 00:12:39,360
<font color="#E5E5E5">after</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> decide which are the what is</font>

228
00:12:35,040 --> 00:12:43,800
the preferred capability of each or

229
00:12:39,360 --> 00:12:48,480
let's say<font color="#E5E5E5"> pairing method that they can</font>

230
00:12:43,800 --> 00:12:52,640
support<font color="#CCCCCC"> they initiate the pairing</font>

231
00:12:48,480 --> 00:12:56,250
process<font color="#CCCCCC"> so the second phase is</font><font color="#E5E5E5"> that the</font>

232
00:12:52,640 --> 00:12:59,579
the master<font color="#E5E5E5"> which is the the hosting</font>

233
00:12:56,250 --> 00:13:02,130
device is generating a<font color="#E5E5E5"> short term key</font>

234
00:12:59,579 --> 00:13:07,589
the<font color="#CCCCCC"> Shawn tank</font><font color="#E5E5E5"> the short term key is</font>

235
00:13:02,130 --> 00:13:11,279
derived from the from the pin<font color="#CCCCCC"> that that</font>

236
00:13:07,589 --> 00:13:14,120
is part of the pairing method and then

237
00:13:11,279 --> 00:13:17,640
after they<font color="#E5E5E5"> determine the short term key</font>

238
00:13:14,120 --> 00:13:20,100
they're sending they generate the<font color="#E5E5E5"> key</font>

239
00:13:17,640 --> 00:13:22,319
and then they<font color="#E5E5E5"> con</font><font color="#CCCCCC"> phase one second</font><font color="#E5E5E5"> on</font>

240
00:13:20,100 --> 00:13:25,440
<font color="#CCCCCC">Phase three then they distribute it</font>

241
00:13:22,320 --> 00:13:28,290
between the devices so they can<font color="#E5E5E5"> continue</font>

242
00:13:25,440 --> 00:13:31,290
<font color="#CCCCCC">to communicate</font><font color="#E5E5E5"> over a secured link</font>

243
00:13:28,290 --> 00:13:39,228
okay so how does<font color="#E5E5E5"> that key is determined</font>

244
00:13:31,290 --> 00:13:42,959
there are three main methods<font color="#CCCCCC"> of</font><font color="#E5E5E5"> pairing</font>

245
00:13:39,229 --> 00:13:45,089
<font color="#E5E5E5">methods</font><font color="#CCCCCC"> between the device and</font><font color="#E5E5E5"> the and</font>

246
00:13:42,959 --> 00:13:49,469
the application the<font color="#CCCCCC"> first one is just</font>

247
00:13:45,089 --> 00:13:51,299
works<font color="#CCCCCC"> great</font><font color="#E5E5E5"> great name</font><font color="#CCCCCC"> the fact that it</font>

248
00:13:49,470 --> 00:13:57,089
just<font color="#CCCCCC"> works it's because the key is a</font>

249
00:13:51,299 --> 00:14:00,269
bunch of<font color="#E5E5E5"> zeros</font><font color="#CCCCCC"> okay this is actually it</font>

250
00:13:57,089 --> 00:14:05,609
sounds funny<font color="#CCCCCC"> but this is actually</font><font color="#E5E5E5"> I'd</font>

251
00:14:00,269 --> 00:14:08,399
say<font color="#CCCCCC"> about 90% of the devices use that</font>

252
00:14:05,609 --> 00:14:11,609
<font color="#E5E5E5">why because most of the devices doesn't</font>

253
00:14:08,399 --> 00:14:14,879
don't have a screen to<font color="#CCCCCC"> show you another</font>

254
00:14:11,609 --> 00:14:17,850
pin code<font color="#E5E5E5"> or even if they do they prefer</font>

255
00:14:14,879 --> 00:14:20,910
<font color="#E5E5E5">not</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> so this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the most common method</font>

256
00:14:17,850 --> 00:14:25,829
<font color="#CCCCCC">really insecure the second one is a six</font>

257
00:14:20,910 --> 00:14:28,410
digit<font color="#E5E5E5"> PIN you</font><font color="#CCCCCC"> might seen it may be when</font>

258
00:14:25,829 --> 00:14:30,689
you're trying to<font color="#E5E5E5"> connect your car then</font>

259
00:14:28,410 --> 00:14:33,389
<font color="#E5E5E5">you have a nice multimedia screen and</font>

260
00:14:30,689 --> 00:14:36,839
when you want<font color="#E5E5E5"> to connect it present six</font>

261
00:14:33,389 --> 00:14:39,720
digits<font color="#E5E5E5"> pin code where you need to enter</font>

262
00:14:36,839 --> 00:14:43,559
on<font color="#CCCCCC"> your phone and then you</font><font color="#E5E5E5"> can connect</font>

263
00:14:39,720 --> 00:14:47,309
to it<font color="#E5E5E5"> okay still</font><font color="#CCCCCC"> six digits 1 million</font>

264
00:14:43,559 --> 00:14:50,189
options<font color="#E5E5E5"> still</font><font color="#CCCCCC"> brute-force we can still</font>

265
00:14:47,309 --> 00:14:53,608
root for that<font color="#E5E5E5"> again we're</font><font color="#CCCCCC"> not going to</font>

266
00:14:50,189 --> 00:14:56,969
<font color="#E5E5E5">to go into that and the third method is</font>

267
00:14:53,609 --> 00:15:02,699
out<font color="#CCCCCC"> of</font><font color="#E5E5E5"> band out</font><font color="#CCCCCC"> of band means actually</font>

268
00:14:56,970 --> 00:15:06,059
using a different way<font color="#E5E5E5"> of key exchange so</font>

269
00:15:02,699 --> 00:15:10,949
that<font color="#CCCCCC"> we cry</font><font color="#E5E5E5"> we that we cry requires</font>

270
00:15:06,059 --> 00:15:15,029
sorry<font color="#CCCCCC"> that requires the device to have</font>

271
00:15:10,949 --> 00:15:16,829
another way of communicating<font color="#E5E5E5"> the key it</font>

272
00:15:15,029 --> 00:15:19,379
would<font color="#E5E5E5"> have been</font><font color="#CCCCCC"> secured if the device</font>

273
00:15:16,829 --> 00:15:22,378
would also be will also have let's say

274
00:15:19,379 --> 00:15:24,689
NFC to exchange the key over<font color="#CCCCCC"> a</font><font color="#E5E5E5"> different</font>

275
00:15:22,379 --> 00:15:26,819
<font color="#E5E5E5">medium</font><font color="#CCCCCC"> over a different</font><font color="#E5E5E5"> protocol</font><font color="#CCCCCC"> but</font>

276
00:15:24,689 --> 00:15:30,349
that doesn't happen because<font color="#E5E5E5"> Bluetooth</font>

277
00:15:26,819 --> 00:15:32,728
devices have<font color="#CCCCCC"> bluetooth</font><font color="#E5E5E5"> protocols only</font>

278
00:15:30,350 --> 00:15:35,249
<font color="#E5E5E5">bluetooth chips</font><font color="#CCCCCC"> so they can only</font>

279
00:15:32,729 --> 00:15:37,739
communicate over<font color="#CCCCCC"> bluetooth so I never</font>

280
00:15:35,249 --> 00:15:40,289
<font color="#E5E5E5">actually seen that it's in the</font>

281
00:15:37,739 --> 00:15:41,959
specification but of the protocol<font color="#CCCCCC"> but I</font>

282
00:15:40,289 --> 00:15:47,699
haven't<font color="#E5E5E5"> seen</font><font color="#CCCCCC"> that</font>

283
00:15:41,959 --> 00:15:52,768
tested<font color="#E5E5E5"> few hundreds devices</font><font color="#CCCCCC"> and I</font><font color="#E5E5E5"> never</font>

284
00:15:47,699 --> 00:15:56,819
seen that<font color="#E5E5E5"> okay so after actually if you</font>

285
00:15:52,769 --> 00:15:58,740
go to the<font color="#CCCCCC"> the documentation its says</font>

286
00:15:56,819 --> 00:16:00,029
<font color="#E5E5E5">that word by word</font>

287
00:15:58,740 --> 00:16:01,709
none of the<font color="#CCCCCC"> pairing method provide</font>

288
00:16:00,029 --> 00:16:04,649
protection against passive eavesdropper

289
00:16:01,709 --> 00:16:07,920
<font color="#E5E5E5">that's great what were you thinking when</font>

290
00:16:04,649 --> 00:16:10,529
you<font color="#E5E5E5"> were creating this protocol okay</font>

291
00:16:07,920 --> 00:16:13,620
<font color="#CCCCCC">don't</font><font color="#E5E5E5"> worry because the</font><font color="#CCCCCC"> future</font><font color="#E5E5E5"> version</font>

292
00:16:10,529 --> 00:16:16,949
will<font color="#E5E5E5"> acts will will implement</font>

293
00:16:13,620 --> 00:16:19,470
<font color="#E5E5E5">diffie-hellman key exchange that's very</font>

294
00:16:16,949 --> 00:16:22,079
great of you but I<font color="#CCCCCC"> already</font><font color="#E5E5E5"> bought the</font>

295
00:16:19,470 --> 00:16:24,839
<font color="#CCCCCC">device what will I do now</font>

296
00:16:22,079 --> 00:16:29,638
<font color="#E5E5E5">okay so I'm left with</font><font color="#CCCCCC"> unsecure</font><font color="#E5E5E5"> device</font>

297
00:16:24,839 --> 00:16:35,040
and with no way of<font color="#E5E5E5"> protecting of</font>

298
00:16:29,639 --> 00:16:39,930
protecting it okay so is it<font color="#E5E5E5"> secure or</font>

299
00:16:35,040 --> 00:16:43,500
<font color="#CCCCCC">not in practice</font><font color="#E5E5E5"> I say I'd say that most</font>

300
00:16:39,930 --> 00:16:45,709
of the devices doesn't use any type<font color="#CCCCCC"> of</font>

301
00:16:43,500 --> 00:16:48,300
encryption<font color="#E5E5E5"> or any type of protection</font>

302
00:16:45,709 --> 00:16:49,768
just like<font color="#E5E5E5"> application any other</font>

303
00:16:48,300 --> 00:16:52,589
applications<font color="#E5E5E5"> that you</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> going to use</font>

304
00:16:49,769 --> 00:16:55,380
or any other technology<font color="#E5E5E5"> they just come</font>

305
00:16:52,589 --> 00:16:58,380
<font color="#CCCCCC">insecure people don't bother of</font>

306
00:16:55,380 --> 00:17:00,660
implementing security<font color="#E5E5E5"> of course not</font>

307
00:16:58,380 --> 00:17:03,209
<font color="#E5E5E5">security</font><font color="#CCCCCC"> people but when we go to</font>

308
00:17:00,660 --> 00:17:06,928
developers<font color="#E5E5E5"> they don't do that why do</font>

309
00:17:03,209 --> 00:17:11,668
they don't do that<font color="#E5E5E5"> as always it comes on</font>

310
00:17:06,929 --> 00:17:15,240
comes in<font color="#E5E5E5"> way behind the</font><font color="#CCCCCC"> priorities and</font>

311
00:17:11,669 --> 00:17:18,360
schedule<font color="#E5E5E5"> but there are other other</font>

312
00:17:15,240 --> 00:17:21,390
reasons as<font color="#CCCCCC"> well one</font><font color="#E5E5E5"> of them is that</font>

313
00:17:18,359 --> 00:17:23,339
sometimes there<font color="#E5E5E5"> are different users or</font>

314
00:17:21,390 --> 00:17:26,850
<font color="#E5E5E5">different apps that needs to communicate</font>

315
00:17:23,339 --> 00:17:29,070
<font color="#E5E5E5">with the device</font><font color="#CCCCCC"> sometimes</font><font color="#E5E5E5"> the devices</font>

316
00:17:26,849 --> 00:17:34,230
are public some terminals or I don't

317
00:17:29,070 --> 00:17:37,860
<font color="#CCCCCC">know what</font><font color="#E5E5E5"> let's say</font><font color="#CCCCCC"> a cashier or some of</font>

318
00:17:34,230 --> 00:17:41,400
a kind<font color="#E5E5E5"> and of course sometimes security</font>

319
00:17:37,860 --> 00:17:45,030
doesn't<font color="#E5E5E5"> come hand-in-hand with the</font>

320
00:17:41,400 --> 00:17:47,340
requirements<font color="#E5E5E5"> of the capabilities etc but</font>

321
00:17:45,030 --> 00:17:52,350
mostly it's lazy developers<font color="#E5E5E5"> okay so</font>

322
00:17:47,340 --> 00:17:55,909
security<font color="#CCCCCC"> IOT in IOT is like everywhere</font>

323
00:17:52,350 --> 00:18:01,980
<font color="#CCCCCC">else</font><font color="#E5E5E5"> security not always implemented</font>

324
00:17:55,910 --> 00:18:04,919
<font color="#E5E5E5">okay so we're going to discuss not the</font>

325
00:18:01,980 --> 00:18:06,690
protocol layer and we're<font color="#CCCCCC"> going to see</font>

326
00:18:04,919 --> 00:18:08,280
<font color="#CCCCCC">actually how we're going</font><font color="#E5E5E5"> to use the</font>

327
00:18:06,690 --> 00:18:12,660
<font color="#CCCCCC">application layer or the communication</font>

328
00:18:08,280 --> 00:18:15,980
<font color="#E5E5E5">layer to hack the device let's say or</font>

329
00:18:12,660 --> 00:18:18,660
the<font color="#E5E5E5"> mobile application that is</font>

330
00:18:15,980 --> 00:18:20,640
communicating with the<font color="#E5E5E5"> device to</font>

331
00:18:18,660 --> 00:18:23,640
understand<font color="#E5E5E5"> that we</font><font color="#CCCCCC"> need to</font><font color="#E5E5E5"> understand</font>

332
00:18:20,640 --> 00:18:30,140
the<font color="#E5E5E5"> the generic attribute profile so</font>

333
00:18:23,640 --> 00:18:32,880
each<font color="#CCCCCC"> each ble device needs to implement</font>

334
00:18:30,140 --> 00:18:34,919
<font color="#CCCCCC">according to the specification</font><font color="#E5E5E5"> some kind</font>

335
00:18:32,880 --> 00:18:37,890
<font color="#E5E5E5">of it's called generic attribute profile</font>

336
00:18:34,919 --> 00:18:45,860
<font color="#E5E5E5">or in shortcut you</font><font color="#CCCCCC"> can barely see the</font>

337
00:18:37,890 --> 00:18:48,480
green titles<font color="#CCCCCC"> so these these let's say</font>

338
00:18:45,860 --> 00:18:54,059
<font color="#CCCCCC">requirements specified the services and</font>

339
00:18:48,480 --> 00:18:58,350
characteristics<font color="#E5E5E5"> and way means or type of</font>

340
00:18:54,059 --> 00:19:01,700
data that<font color="#E5E5E5"> the</font><font color="#CCCCCC"> device is going to</font><font color="#E5E5E5"> to</font>

341
00:18:58,350 --> 00:19:05,399
serve so if it's of<font color="#E5E5E5"> course if it's a</font>

342
00:19:01,700 --> 00:19:08,400
phone<font color="#E5E5E5"> or sorry a SmartWatch</font><font color="#CCCCCC"> and you have</font>

343
00:19:05,400 --> 00:19:10,679
other features<font color="#CCCCCC"> like emails etc so you</font>

344
00:19:08,400 --> 00:19:14,190
need to be<font color="#CCCCCC"> able to communicate with it</font>

345
00:19:10,679 --> 00:19:17,730
<font color="#E5E5E5">so how the app knows what type of data</font>

346
00:19:14,190 --> 00:19:20,900
to send<font color="#CCCCCC"> worth which service to to</font>

347
00:19:17,730 --> 00:19:24,690
connect to so this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> all this all is</font><font color="#E5E5E5"> a</font>

348
00:19:20,900 --> 00:19:27,120
<font color="#E5E5E5">is defined in the characteristics and of</font>

349
00:19:24,690 --> 00:19:32,610
the gut<font color="#E5E5E5"> okay so you have a service it</font>

350
00:19:27,120 --> 00:19:35,250
has<font color="#E5E5E5"> its decrypt this description so is</font>

351
00:19:32,610 --> 00:19:38,129
it a battery service so maybe it's a

352
00:19:35,250 --> 00:19:40,890
notification<font color="#E5E5E5"> service</font><font color="#CCCCCC"> etc what are the</font>

353
00:19:38,130 --> 00:19:43,559
<font color="#E5E5E5">properties that the service serve so you</font>

354
00:19:40,890 --> 00:19:45,539
can read to read from it you can<font color="#CCCCCC"> write</font>

355
00:19:43,559 --> 00:19:47,850
to<font color="#E5E5E5"> it and you can register to it</font>

356
00:19:45,539 --> 00:19:50,280
it's called notification where you

357
00:19:47,850 --> 00:19:55,379
register to<font color="#E5E5E5"> a service and then you</font><font color="#CCCCCC"> keep</font>

358
00:19:50,280 --> 00:19:58,799
getting<font color="#E5E5E5"> information</font><font color="#CCCCCC"> okay and then for</font>

359
00:19:55,380 --> 00:20:00,390
each service<font color="#E5E5E5"> this is how it's how that</font>

360
00:19:58,799 --> 00:20:04,400
the application knows how to<font color="#E5E5E5"> communicate</font>

361
00:20:00,390 --> 00:20:09,000
<font color="#E5E5E5">with the device typical flow of the</font>

362
00:20:04,400 --> 00:20:13,169
Bluetooth<font color="#E5E5E5"> communication so</font><font color="#CCCCCC"> I be</font>

363
00:20:09,000 --> 00:20:16,140
is because it's so power efficient and

364
00:20:13,169 --> 00:20:19,049
low costs<font color="#E5E5E5"> and doesn't require much</font>

365
00:20:16,140 --> 00:20:22,980
battery it's continuous<font color="#CCCCCC"> continuously</font>

366
00:20:19,049 --> 00:20:25,620
advertising itself<font color="#CCCCCC"> so if</font><font color="#E5E5E5"> I want to</font>

367
00:20:22,980 --> 00:20:28,740
communicate to connect to a device<font color="#E5E5E5"> here</font>

368
00:20:25,620 --> 00:20:33,809
I have a SmartWatch we'll see later how

369
00:20:28,740 --> 00:20:36,870
we interact<font color="#CCCCCC"> with it then well I'll say</font>

370
00:20:33,809 --> 00:20:39,960
it's not that<font color="#CCCCCC"> smart</font><font color="#E5E5E5"> but it's called that</font>

371
00:20:36,870 --> 00:20:42,719
way<font color="#E5E5E5"> so it continuously</font><font color="#CCCCCC"> advertise itself</font>

372
00:20:39,960 --> 00:20:45,990
<font color="#CCCCCC">whoo hello</font><font color="#E5E5E5"> everyone I'm here</font><font color="#CCCCCC"> if you</font><font color="#E5E5E5"> want</font>

373
00:20:42,720 --> 00:20:49,020
to connect<font color="#CCCCCC"> to it to me</font><font color="#E5E5E5"> these are</font><font color="#CCCCCC"> my this</font>

374
00:20:45,990 --> 00:20:51,120
<font color="#E5E5E5">is my</font><font color="#CCCCCC"> ID</font><font color="#E5E5E5"> and when we want to connect to</font>

375
00:20:49,020 --> 00:20:54,179
it we<font color="#CCCCCC"> just scan for Bluetooth devices on</font>

376
00:20:51,120 --> 00:20:55,889
our mobile app and then when we see the

377
00:20:54,179 --> 00:20:59,340
<font color="#CCCCCC">device we want</font><font color="#E5E5E5"> to connect to we just</font>

378
00:20:55,890 --> 00:21:02,039
click on it<font color="#CCCCCC"> there</font><font color="#E5E5E5"> they're exchanging and</font>

379
00:20:59,340 --> 00:21:04,668
trying to pair bond<font color="#E5E5E5"> depends on the</font>

380
00:21:02,039 --> 00:21:06,600
capabilities<font color="#E5E5E5"> of the device and then</font>

381
00:21:04,669 --> 00:21:08,700
after they<font color="#CCCCCC"> establish</font><font color="#E5E5E5"> the the</font>

382
00:21:06,600 --> 00:21:14,490
<font color="#E5E5E5">communication link they start</font>

383
00:21:08,700 --> 00:21:18,600
communicate<font color="#E5E5E5"> send data over it</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so how</font>

384
00:21:14,490 --> 00:21:21,780
do<font color="#E5E5E5"> we know let's say I just</font><font color="#CCCCCC"> found a</font>

385
00:21:18,600 --> 00:21:25,530
<font color="#E5E5E5">device I want to connect to</font><font color="#CCCCCC"> I don't know</font>

386
00:21:21,780 --> 00:21:27,928
what it<font color="#E5E5E5"> is I want to know what I can do</font>

387
00:21:25,530 --> 00:21:31,549
with<font color="#CCCCCC"> it or how I</font><font color="#E5E5E5"> can connect to</font><font color="#CCCCCC"> it so I</font>

388
00:21:27,929 --> 00:21:34,230
can do<font color="#E5E5E5"> something</font><font color="#CCCCCC"> lights like that calls</font>

389
00:21:31,549 --> 00:21:38,879
<font color="#E5E5E5">discovering it's discovering services so</font>

390
00:21:34,230 --> 00:21:40,799
after I connect<font color="#E5E5E5"> to it</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> ask the device</font>

391
00:21:38,880 --> 00:21:45,030
to give me all the services<font color="#CCCCCC"> and</font>

392
00:21:40,799 --> 00:21:46,250
characteristics<font color="#E5E5E5"> of its services</font><font color="#CCCCCC"> so I can</font>

393
00:21:45,030 --> 00:21:51,120
communicate<font color="#CCCCCC"> with it</font>

394
00:21:46,250 --> 00:21:52,950
so here for example<font color="#E5E5E5"> you can see default</font>

395
00:21:51,120 --> 00:21:54,870
just<font color="#E5E5E5"> a scanner ble scanner it's a</font>

396
00:21:52,950 --> 00:21:59,370
<font color="#E5E5E5">generic app you can download from</font><font color="#CCCCCC"> the</font>

397
00:21:54,870 --> 00:22:03,059
market it it works on all the<font color="#CCCCCC"> type of</font>

398
00:21:59,370 --> 00:22:06,270
devices<font color="#E5E5E5"> and you can just connect to any</font>

399
00:22:03,059 --> 00:22:08,129
device<font color="#E5E5E5"> of course if no security first</font>

400
00:22:06,270 --> 00:22:11,940
the security is implemented and then

401
00:22:08,130 --> 00:22:17,360
start reading<font color="#CCCCCC"> or data or writing data to</font>

402
00:22:11,940 --> 00:22:17,360
<font color="#CCCCCC">it</font><font color="#E5E5E5"> so let's</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> just a short explanation</font>

403
00:22:19,340 --> 00:22:35,570
<font color="#E5E5E5">okay okay</font><font color="#CCCCCC"> so this is the phone I'm</font><font color="#E5E5E5"> going</font>

404
00:22:30,080 --> 00:22:37,129
to use okay so I downloaded<font color="#CCCCCC"> I don't know</font>

405
00:22:35,570 --> 00:22:41,960
if you can see here there<font color="#E5E5E5"> are many</font>

406
00:22:37,129 --> 00:22:44,658
generic ble scanners<font color="#CCCCCC"> just the most</font>

407
00:22:41,960 --> 00:22:47,179
generic<font color="#E5E5E5"> of them ble scanner it's called</font>

408
00:22:44,659 --> 00:22:52,789
<font color="#E5E5E5">okay of</font><font color="#CCCCCC"> course I</font><font color="#E5E5E5"> need</font><font color="#CCCCCC"> to enable</font><font color="#E5E5E5"> really a</font>

409
00:22:47,179 --> 00:22:56,389
<font color="#CCCCCC">bluetooth on the device and</font><font color="#E5E5E5"> then I'll</font>

410
00:22:52,789 --> 00:23:02,779
start<font color="#E5E5E5"> to scan</font><font color="#CCCCCC"> there are many devices</font>

411
00:22:56,389 --> 00:23:07,129
here<font color="#CCCCCC"> okay yeah</font><font color="#E5E5E5"> I haven't seen</font><font color="#CCCCCC"> that many</font>

412
00:23:02,779 --> 00:23:10,519
<font color="#CCCCCC">in anywhere</font><font color="#E5E5E5"> so I'll just see</font><font color="#CCCCCC"> what</font>

413
00:23:07,129 --> 00:23:12,230
happens when<font color="#E5E5E5"> I go to the first one okay</font>

414
00:23:10,519 --> 00:23:14,330
<font color="#CCCCCC">you can see it says discovering services</font>

415
00:23:12,230 --> 00:23:16,909
and then I can start<font color="#CCCCCC"> reading</font><font color="#E5E5E5"> from it so</font>

416
00:23:14,330 --> 00:23:18,619
let's see what device is it if you

417
00:23:16,909 --> 00:23:20,509
recognize it<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> worry</font>

418
00:23:18,619 --> 00:23:30,769
I don't<font color="#E5E5E5"> not going to do anything</font><font color="#CCCCCC"> okay</font>

419
00:23:20,509 --> 00:23:35,570
<font color="#CCCCCC">it's an Apple device iPhone 8.4 yeah I</font>

420
00:23:30,769 --> 00:23:39,190
narrow it<font color="#CCCCCC"> down</font><font color="#E5E5E5"> okay other services</font><font color="#CCCCCC"> okay</font>

421
00:23:35,570 --> 00:23:42,740
so I can start<font color="#CCCCCC"> reading these values</font>

422
00:23:39,190 --> 00:23:46,249
<font color="#CCCCCC">they're represented in hacks I don't</font>

423
00:23:42,740 --> 00:23:49,700
really<font color="#E5E5E5"> know what they are but it's not</font>

424
00:23:46,249 --> 00:23:52,639
<font color="#CCCCCC">that</font><font color="#E5E5E5"> hard to understand what they</font><font color="#CCCCCC"> are</font>

425
00:23:49,700 --> 00:23:55,940
<font color="#E5E5E5">okay so this is the battery level let's</font>

426
00:23:52,639 --> 00:23:57,799
see if I can read that and<font color="#E5E5E5"> no</font>

427
00:23:55,940 --> 00:24:00,740
<font color="#CCCCCC">information</font><font color="#E5E5E5"> okay and then there are many</font>

428
00:23:57,799 --> 00:24:04,279
custom services<font color="#E5E5E5"> which are not the</font>

429
00:24:00,740 --> 00:24:06,499
generic of all the devices<font color="#E5E5E5"> but specific</font>

430
00:24:04,279 --> 00:24:09,259
for these<font color="#E5E5E5"> devices and here you can see</font>

431
00:24:06,499 --> 00:24:11,240
that I<font color="#CCCCCC"> can try</font><font color="#E5E5E5"> to read I'm not</font>

432
00:24:09,259 --> 00:24:14,720
necessarily going to<font color="#E5E5E5"> succeed sometimes</font>

433
00:24:11,240 --> 00:24:16,999
they require<font color="#E5E5E5"> some bonding or pairing but</font>

434
00:24:14,720 --> 00:24:20,419
not always<font color="#E5E5E5"> and I can also write that so</font>

435
00:24:16,999 --> 00:24:22,429
I can<font color="#E5E5E5"> just send data to one of them I'm</font>

436
00:24:20,419 --> 00:24:24,980
<font color="#E5E5E5">not going to do that because they</font><font color="#CCCCCC"> don't</font>

437
00:24:22,429 --> 00:24:30,230
know what's<font color="#E5E5E5"> going to</font><font color="#CCCCCC"> happen and don't</font>

438
00:24:24,980 --> 00:24:32,720
<font color="#E5E5E5">want to</font><font color="#CCCCCC"> ring your devices</font><font color="#E5E5E5"> so but</font><font color="#CCCCCC"> okay so</font>

439
00:24:30,230 --> 00:24:36,169
I have all<font color="#CCCCCC"> these information these</font>

440
00:24:32,720 --> 00:24:39,200
really some you<font color="#E5E5E5"> gooood</font><font color="#CCCCCC"> nah</font><font color="#E5E5E5"> IDs I don't</font>

441
00:24:36,169 --> 00:24:42,799
know what they do<font color="#E5E5E5"> how the hell do I</font><font color="#CCCCCC"> need</font>

442
00:24:39,200 --> 00:24:47,659
to understand what I<font color="#E5E5E5"> need to do with</font>

443
00:24:42,799 --> 00:24:52,700
them<font color="#E5E5E5"> so first if it's an apple an iPhone</font>

444
00:24:47,659 --> 00:24:55,640
<font color="#E5E5E5">I can just try using my own device and</font>

445
00:24:52,700 --> 00:24:57,950
see what what they do and then when I

446
00:24:55,640 --> 00:25:00,169
<font color="#E5E5E5">want to do that on someone else I</font>

447
00:24:57,950 --> 00:25:01,700
already know what they are and<font color="#E5E5E5"> the</font>

448
00:25:00,169 --> 00:25:05,330
second is<font color="#CCCCCC"> that the protocol provides</font>

449
00:25:01,700 --> 00:25:08,600
<font color="#E5E5E5">this it's not just</font><font color="#CCCCCC"> invented okay</font><font color="#E5E5E5"> so this</font>

450
00:25:05,330 --> 00:25:11,418
is part of the protocol specification<font color="#E5E5E5"> so</font>

451
00:25:08,600 --> 00:25:16,668
if I'm going<font color="#E5E5E5"> to take this ID at least</font>

452
00:25:11,419 --> 00:25:18,919
<font color="#E5E5E5">the first</font><font color="#CCCCCC"> part</font><font color="#E5E5E5"> of the idea or yeah the</font>

453
00:25:16,669 --> 00:25:26,020
first part<font color="#E5E5E5"> of the ID and then I'm going</font>

454
00:25:18,919 --> 00:25:34,510
<font color="#E5E5E5">to look on</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> look for it on the sorry</font>

455
00:25:26,020 --> 00:25:38,179
on the<font color="#E5E5E5"> Bluetooth website then I can see</font>

456
00:25:34,510 --> 00:25:40,490
what<font color="#CCCCCC"> is idea these IDs</font><font color="#E5E5E5"> actually mean so</font>

457
00:25:38,179 --> 00:25:46,190
I can see<font color="#E5E5E5"> that battery services start</font>

458
00:25:40,490 --> 00:25:51,650
with<font color="#E5E5E5"> one</font><font color="#CCCCCC"> IDF</font><font color="#E5E5E5"> and I can see that cycling</font>

459
00:25:46,190 --> 00:25:53,809
power is<font color="#E5E5E5"> 1819 etcetera etcetera</font><font color="#CCCCCC"> so I can</font>

460
00:25:51,650 --> 00:25:55,370
assume<font color="#CCCCCC"> I can start</font><font color="#E5E5E5"> to understand what</font>

461
00:25:53,809 --> 00:26:00,350
these<font color="#CCCCCC"> services are of course</font><font color="#E5E5E5"> this</font>

462
00:25:55,370 --> 00:26:03,649
requires<font color="#CCCCCC"> some type of of reversing or</font>

463
00:26:00,350 --> 00:26:07,189
how do you how you want<font color="#E5E5E5"> to call it but</font>

464
00:26:03,650 --> 00:26:09,530
<font color="#E5E5E5">the thing</font><font color="#CCCCCC"> is that in many cases</font><font color="#E5E5E5"> these</font>

465
00:26:07,190 --> 00:26:12,710
services are open<font color="#E5E5E5"> for</font><font color="#CCCCCC"> everyone to just</font>

466
00:26:09,530 --> 00:26:17,960
connect to<font color="#CCCCCC"> them read</font><font color="#E5E5E5"> data or</font><font color="#CCCCCC"> even worse</font>

467
00:26:12,710 --> 00:26:21,260
<font color="#CCCCCC">send that asset to the device and they</font>

468
00:26:17,960 --> 00:26:25,610
are just waiting<font color="#E5E5E5"> for any device or yeah</font>

469
00:26:21,260 --> 00:26:28,879
<font color="#CCCCCC">any</font><font color="#E5E5E5"> application to connect to it</font><font color="#CCCCCC"> okay</font>

470
00:26:25,610 --> 00:26:35,299
basic<font color="#CCCCCC"> Billie commands that we need to</font>

471
00:26:28,880 --> 00:26:36,860
know<font color="#E5E5E5"> okay there are a few tools that you</font>

472
00:26:35,299 --> 00:26:38,929
can<font color="#E5E5E5"> there are built in in the</font>

473
00:26:36,860 --> 00:26:43,820
environment of course<font color="#E5E5E5"> after you install</font>

474
00:26:38,929 --> 00:26:46,380
all the<font color="#E5E5E5"> ble libraries</font><font color="#CCCCCC"> ití config where</font>

475
00:26:43,820 --> 00:26:49,830
you can configure your

476
00:26:46,380 --> 00:26:52,830
your interface<font color="#E5E5E5"> HCI tool has many</font>

477
00:26:49,830 --> 00:26:58,770
functionalities<font color="#CCCCCC"> to scan devices you use</font>

478
00:26:52,830 --> 00:27:01,260
<font color="#CCCCCC">le scan and ATI dump</font><font color="#E5E5E5"> which gives you a</font>

479
00:26:58,770 --> 00:27:05,810
dump of<font color="#CCCCCC"> the communication over a</font>

480
00:27:01,260 --> 00:27:18,480
specific<font color="#E5E5E5"> interface these are examples so</font>

481
00:27:05,810 --> 00:27:21,020
second<font color="#CCCCCC"> ok I'll get to it in a second</font><font color="#E5E5E5"> ok</font>

482
00:27:18,480 --> 00:27:24,740
there is another tool<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can really see</font>

483
00:27:21,020 --> 00:27:29,580
it's called got<font color="#E5E5E5"> tool got from the</font>

484
00:27:24,740 --> 00:27:34,590
generic attribute and it<font color="#E5E5E5"> actually lets</font>

485
00:27:29,580 --> 00:27:37,409
<font color="#E5E5E5">you communicate with command</font><font color="#CCCCCC"> line with</font>

486
00:27:34,590 --> 00:27:39,179
the device<font color="#E5E5E5"> so got to you set the device</font>

487
00:27:37,410 --> 00:27:42,390
MAC address you can't really see that

488
00:27:39,180 --> 00:27:44,430
<font color="#E5E5E5">later</font><font color="#CCCCCC"> the presentation will be uploaded</font>

489
00:27:42,390 --> 00:27:45,030
<font color="#E5E5E5">and you can see and then</font><font color="#CCCCCC"> you can connect</font>

490
00:27:44,430 --> 00:27:47,310
to it

491
00:27:45,030 --> 00:27:50,190
scan the services<font color="#CCCCCC"> so here you</font><font color="#E5E5E5"> can see</font>

492
00:27:47,310 --> 00:27:52,620
whatever<font color="#E5E5E5"> we saw on the ble scanner</font><font color="#CCCCCC"> all</font>

493
00:27:50,190 --> 00:27:56,730
the<font color="#E5E5E5"> services and</font><font color="#CCCCCC"> there you IDs and then</font>

494
00:27:52,620 --> 00:27:58,949
I can just read these values or I can

495
00:27:56,730 --> 00:28:01,520
try to write to them

496
00:27:58,950 --> 00:28:07,320
<font color="#E5E5E5">this is regular communication between</font>

497
00:28:01,520 --> 00:28:09,780
with the<font color="#E5E5E5"> device using command line</font><font color="#CCCCCC"> ok</font>

498
00:28:07,320 --> 00:28:12,330
<font color="#E5E5E5">but this</font><font color="#CCCCCC"> is not what we hear ok of</font>

499
00:28:09,780 --> 00:28:14,490
course we can connect<font color="#E5E5E5"> to them</font><font color="#CCCCCC"> but we</font>

500
00:28:12,330 --> 00:28:18,449
<font color="#E5E5E5">want to see how we can set them and in</font>

501
00:28:14,490 --> 00:28:21,000
the middle<font color="#CCCCCC"> okay so</font><font color="#E5E5E5"> why regular</font><font color="#CCCCCC"> man</font><font color="#E5E5E5"> what</font>

502
00:28:18,450 --> 00:28:23,580
is it<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> regular</font><font color="#CCCCCC"> man in</font>

503
00:28:21,000 --> 00:28:25,230
the middle the the the<font color="#E5E5E5"> traditional man</font>

504
00:28:23,580 --> 00:28:27,810
in the middle<font color="#E5E5E5"> is not going to work here</font>

505
00:28:25,230 --> 00:28:29,160
<font color="#CCCCCC">the</font><font color="#E5E5E5"> traditional man in the middle</font><font color="#CCCCCC"> we</font>

506
00:28:27,810 --> 00:28:32,580
stand in the middle of between the

507
00:28:29,160 --> 00:28:35,550
application<font color="#E5E5E5"> and device and then send</font>

508
00:28:32,580 --> 00:28:37,649
playing the both roles for<font color="#CCCCCC"> each other</font><font color="#E5E5E5"> so</font>

509
00:28:35,550 --> 00:28:40,470
<font color="#E5E5E5">we're going to play the server or</font><font color="#CCCCCC"> the</font>

510
00:28:37,650 --> 00:28:42,480
device to<font color="#E5E5E5"> the user and then vice</font><font color="#CCCCCC"> versa</font>

511
00:28:40,470 --> 00:28:45,210
<font color="#E5E5E5">but in this case it's not</font><font color="#CCCCCC"> going to work</font>

512
00:28:42,480 --> 00:28:49,620
<font color="#CCCCCC">why is</font><font color="#E5E5E5"> it not going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> work because ble</font>

513
00:28:45,210 --> 00:28:53,220
as a protocol<font color="#E5E5E5"> can only serve one one</font>

514
00:28:49,620 --> 00:28:55,110
purpose so if if this device<font color="#E5E5E5"> is</font>

515
00:28:53,220 --> 00:28:57,120
connected<font color="#E5E5E5"> to some other to some</font>

516
00:28:55,110 --> 00:28:58,979
application<font color="#E5E5E5"> you won't be</font><font color="#CCCCCC"> able to</font>

517
00:28:57,120 --> 00:29:00,739
communicate<font color="#E5E5E5"> to communicate with it</font>

518
00:28:58,980 --> 00:29:03,990
further so any other

519
00:29:00,740 --> 00:29:06,539
any anyone tries to scan this device

520
00:29:03,990 --> 00:29:09,990
will not find it<font color="#E5E5E5"> if I'm if it's already</font>

521
00:29:06,539 --> 00:29:14,519
<font color="#CCCCCC">connected to to the app ok so it can</font>

522
00:29:09,990 --> 00:29:17,250
only once it's connected<font color="#CCCCCC"> it cannot</font><font color="#E5E5E5"> so it</font>

523
00:29:14,519 --> 00:29:20,309
cannot communicate over ble so if I'm

524
00:29:17,250 --> 00:29:22,860
here using<font color="#CCCCCC"> Bluetooth and I'm connected</font>

525
00:29:20,309 --> 00:29:27,120
<font color="#CCCCCC">to</font><font color="#E5E5E5"> the device</font><font color="#CCCCCC"> I can no longer</font><font color="#E5E5E5"> connect</font>

526
00:29:22,860 --> 00:29:29,719
with the other side<font color="#CCCCCC"> ok so this sets</font><font color="#E5E5E5"> the</font>

527
00:29:27,120 --> 00:29:32,610
limitation<font color="#E5E5E5"> for the original traditional</font>

528
00:29:29,720 --> 00:29:37,860
<font color="#CCCCCC">man-in-the-middle</font><font color="#E5E5E5"> so what we need to do</font>

529
00:29:32,610 --> 00:29:43,289
is to<font color="#E5E5E5"> have two components or two black</font>

530
00:29:37,860 --> 00:29:46,830
men<font color="#E5E5E5"> in the middle yeah</font><font color="#CCCCCC"> that going to</font>

531
00:29:43,289 --> 00:29:49,139
serve the other way the<font color="#CCCCCC"> other side for</font>

532
00:29:46,830 --> 00:29:51,750
each other<font color="#CCCCCC"> so</font><font color="#E5E5E5"> we're going to have one</font>

533
00:29:49,139 --> 00:29:53,490
Bluetooth device<font color="#E5E5E5"> sorry</font><font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> one</font>

534
00:29:51,750 --> 00:29:56,070
<font color="#E5E5E5">Bluetooth device here going to connect</font>

535
00:29:53,490 --> 00:29:58,380
to<font color="#CCCCCC"> the actual device and serve as the</font>

536
00:29:56,070 --> 00:30:02,490
client or the<font color="#CCCCCC"> mobile app let's say and</font>

537
00:29:58,380 --> 00:30:04,860
the other ble device<font color="#CCCCCC"> don't go</font><font color="#E5E5E5"> that is</font>

538
00:30:02,490 --> 00:30:08,399
going to connect to<font color="#E5E5E5"> the app and going to</font>

539
00:30:04,860 --> 00:30:10,110
serve as<font color="#E5E5E5"> the device now how are they are</font>

540
00:30:08,399 --> 00:30:12,600
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to connect with each</font><font color="#E5E5E5"> other if they</font>

541
00:30:10,110 --> 00:30:14,549
are<font color="#E5E5E5"> cannot use ble we need to use a</font>

542
00:30:12,600 --> 00:30:16,889
different<font color="#E5E5E5"> protocol that's great we can</font>

543
00:30:14,549 --> 00:30:20,070
use any<font color="#E5E5E5"> other protocol for example</font>

544
00:30:16,889 --> 00:30:23,340
<font color="#E5E5E5">WebSocket WebSocket is would</font><font color="#CCCCCC"> be really</font>

545
00:30:20,070 --> 00:30:26,250
easy<font color="#E5E5E5"> in that case</font><font color="#CCCCCC"> so what we are going</font>

546
00:30:23,340 --> 00:30:28,289
to<font color="#E5E5E5"> do is to use two components</font><font color="#CCCCCC"> - bili</font>

547
00:30:26,250 --> 00:30:31,289
<font color="#E5E5E5">components to connect to the to the</font>

548
00:30:28,289 --> 00:30:34,950
actual ble devices<font color="#E5E5E5"> and then use the belt</font>

549
00:30:31,289 --> 00:30:37,080
<font color="#CCCCCC">man-in-the-middle over a</font><font color="#E5E5E5"> web socket this</font>

550
00:30:34,950 --> 00:30:38,639
gives us the<font color="#CCCCCC"> ability to perform</font><font color="#E5E5E5"> an</font>

551
00:30:37,080 --> 00:30:43,168
actual man in the middle<font color="#E5E5E5"> between the</font>

552
00:30:38,639 --> 00:30:45,959
device<font color="#CCCCCC"> and a mobile</font><font color="#E5E5E5"> okay how do we</font><font color="#CCCCCC"> and</font>

553
00:30:43,169 --> 00:30:48,480
<font color="#E5E5E5">we are going to do that very easy so</font>

554
00:30:45,960 --> 00:30:49,830
<font color="#E5E5E5">I've got here</font><font color="#CCCCCC"> two dongles</font><font color="#E5E5E5"> there are</font>

555
00:30:48,480 --> 00:30:52,049
really<font color="#E5E5E5"> small you're not going to see</font>

556
00:30:49,830 --> 00:30:57,870
them but<font color="#CCCCCC"> you can buy them</font><font color="#E5E5E5"> on Aliexpress</font>

557
00:30:52,049 --> 00:31:02,070
in<font color="#E5E5E5"> $1.99 so they are very</font><font color="#CCCCCC"> cheap actually</font>

558
00:30:57,870 --> 00:31:06,989
<font color="#CCCCCC">it can work with one device but it is</font>

559
00:31:02,070 --> 00:31:09,210
not<font color="#E5E5E5"> that stable so easy</font><font color="#CCCCCC"> spend</font><font color="#E5E5E5"> two</font>

560
00:31:06,990 --> 00:31:12,720
<font color="#E5E5E5">dollars</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> and then it would be</font><font color="#CCCCCC"> much</font>

561
00:31:09,210 --> 00:31:14,370
easier<font color="#CCCCCC"> so</font><font color="#E5E5E5"> we have this device devices or</font>

562
00:31:12,720 --> 00:31:17,670
let's say don't go

563
00:31:14,370 --> 00:31:20,189
or adapters<font color="#CCCCCC"> and then we're going to use</font>

564
00:31:17,670 --> 00:31:23,100
two different VMs that are<font color="#CCCCCC"> going to</font>

565
00:31:20,190 --> 00:31:27,120
<font color="#E5E5E5">serve as both parties</font><font color="#CCCCCC"> so I'm going I</font>

566
00:31:23,100 --> 00:31:30,030
downloaded<font color="#E5E5E5"> Kali Linux which comes ready</font>

567
00:31:27,120 --> 00:31:31,949
or not<font color="#E5E5E5"> really ready</font><font color="#CCCCCC"> but with a lot of</font>

568
00:31:30,030 --> 00:31:34,260
tools that<font color="#E5E5E5"> I'm going to</font><font color="#CCCCCC"> use later</font><font color="#E5E5E5"> and</font>

569
00:31:31,950 --> 00:31:37,680
<font color="#E5E5E5">then I only needed to</font><font color="#CCCCCC"> install some</font>

570
00:31:34,260 --> 00:31:42,710
additional tools and<font color="#E5E5E5"> libraries and then</font>

571
00:31:37,680 --> 00:31:48,750
I cloned this this VM<font color="#E5E5E5"> so I have two VMs</font>

572
00:31:42,710 --> 00:31:53,059
<font color="#CCCCCC">and then what I'm</font><font color="#E5E5E5"> going to do is let's</font>

573
00:31:48,750 --> 00:31:56,760
try to do<font color="#E5E5E5"> that okay so I have one device</font>

574
00:31:53,059 --> 00:32:00,059
<font color="#E5E5E5">second</font><font color="#CCCCCC"> ok so I'm going to connect this</font>

575
00:31:56,760 --> 00:32:02,190
<font color="#CCCCCC">really take into consideration</font><font color="#E5E5E5"> that</font>

576
00:32:00,059 --> 00:32:05,340
<font color="#E5E5E5">everything here bought on aliexpress so</font>

577
00:32:02,190 --> 00:32:09,780
they don't really work that<font color="#E5E5E5"> well</font><font color="#CCCCCC"> but</font>

578
00:32:05,340 --> 00:32:11,699
they work<font color="#E5E5E5"> eventually so I just connected</font>

579
00:32:09,780 --> 00:32:15,720
<font color="#E5E5E5">them to the computer</font><font color="#CCCCCC"> now I'm going to</font>

580
00:32:11,700 --> 00:32:20,870
use<font color="#CCCCCC"> to connect them to</font><font color="#E5E5E5"> the VM</font><font color="#CCCCCC"> ok so I'm</font>

581
00:32:15,720 --> 00:32:25,110
going<font color="#CCCCCC"> to connect one of them to this VM</font>

582
00:32:20,870 --> 00:32:31,580
<font color="#CCCCCC">ok I can see that the</font><font color="#E5E5E5"> interface is is</font>

583
00:32:25,110 --> 00:32:31,580
here<font color="#E5E5E5"> we just</font><font color="#CCCCCC"> need to go up to raise it</font>

584
00:32:37,100 --> 00:32:49,730
yeah up and running<font color="#CCCCCC"> let's see that it</font>

585
00:32:39,659 --> 00:32:49,730
works<font color="#E5E5E5"> so great so it works</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> other VM</font>

586
00:32:51,230 --> 00:32:59,149
I'm going to connect the<font color="#CCCCCC"> other</font><font color="#E5E5E5"> ble</font>

587
00:32:54,600 --> 00:32:59,149
device or adapter

588
00:33:09,950 --> 00:33:15,640
<font color="#CCCCCC">Yeah right</font><font color="#E5E5E5"> okay so I connected each of</font>

589
00:33:13,850 --> 00:33:24,500
the adapter<font color="#CCCCCC"> to each of the deer to the</font>

590
00:33:15,640 --> 00:33:29,000
devices<font color="#CCCCCC"> so to the</font><font color="#E5E5E5"> VMS okay so now I'm</font>

591
00:33:24,500 --> 00:33:32,720
going<font color="#CCCCCC"> to use a tool written by</font><font color="#E5E5E5"> Slava</font><font color="#CCCCCC"> Mir</font>

592
00:33:29,000 --> 00:33:35,240
which<font color="#CCCCCC"> i mentioned earlier really great</font>

593
00:33:32,720 --> 00:33:39,640
tool it's called<font color="#CCCCCC"> got occur got</font><font color="#E5E5E5"> Tucker</font>

594
00:33:35,240 --> 00:33:42,410
<font color="#E5E5E5">and it allows</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> to perform</font>

595
00:33:39,640 --> 00:33:47,990
<font color="#E5E5E5">man-in-the-middle the same architecture</font>

596
00:33:42,410 --> 00:33:50,080
as I showed earlier<font color="#CCCCCC"> two components come</font>

597
00:33:47,990 --> 00:33:56,840
communicating with each<font color="#E5E5E5"> other over</font>

598
00:33:50,080 --> 00:34:08,690
WebSocket okay so let's start<font color="#CCCCCC"> okay so</font>

599
00:33:56,840 --> 00:34:11,840
<font color="#E5E5E5">I'm running one so the slave is going to</font>

600
00:34:08,690 --> 00:34:15,800
be here<font color="#E5E5E5"> and then let's start</font>

601
00:34:11,840 --> 00:34:19,070
<font color="#CCCCCC">and now the scan okay</font><font color="#E5E5E5"> and then you can</font>

602
00:34:15,800 --> 00:34:20,960
<font color="#CCCCCC">see</font><font color="#E5E5E5"> that I scan a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> devices</font><font color="#CCCCCC"> what</font>

603
00:34:19,070 --> 00:34:24,200
I'm<font color="#E5E5E5"> doing here what the scan does here</font>

604
00:34:20,960 --> 00:34:27,980
is<font color="#E5E5E5"> that it scans the all the ble devices</font>

605
00:34:24,199 --> 00:34:30,049
that you can<font color="#E5E5E5"> reach and then stores their</font>

606
00:34:27,980 --> 00:34:33,350
advertisement<font color="#E5E5E5"> the advertisement file is</font>

607
00:34:30,050 --> 00:34:36,350
the the name and properties<font color="#E5E5E5"> of the</font>

608
00:34:33,350 --> 00:34:39,259
device<font color="#E5E5E5"> the one that shows the name of</font>

609
00:34:36,350 --> 00:34:42,080
<font color="#CCCCCC">the device</font><font color="#E5E5E5"> basically</font><font color="#CCCCCC"> and the version</font><font color="#E5E5E5"> etc</font>

610
00:34:39,260 --> 00:34:46,760
<font color="#E5E5E5">and then it stores it locally on the</font>

611
00:34:42,080 --> 00:34:48,650
computer and then now I<font color="#E5E5E5"> have the the</font>

612
00:34:46,760 --> 00:34:51,440
advertisement file<font color="#E5E5E5"> the</font><font color="#CCCCCC"> advertisement</font>

613
00:34:48,650 --> 00:34:54,560
file is just the one<font color="#E5E5E5"> that is advertising</font>

614
00:34:51,440 --> 00:34:57,230
<font color="#E5E5E5">itself so when you scan these devices</font>

615
00:34:54,560 --> 00:34:59,960
keep keep advertising<font color="#E5E5E5"> itself</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is the</font>

616
00:34:57,230 --> 00:35:03,980
this is the the file so what I'm<font color="#E5E5E5"> going</font>

617
00:34:59,960 --> 00:35:07,190
to do is I'm<font color="#CCCCCC"> going to play or to</font><font color="#E5E5E5"> mimic</font>

618
00:35:03,980 --> 00:35:09,500
<font color="#E5E5E5">this behavior from my VM so that when an</font>

619
00:35:07,190 --> 00:35:12,020
application wants<font color="#E5E5E5"> to connect to the</font>

620
00:35:09,500 --> 00:35:15,680
<font color="#E5E5E5">device it will see my advertisement</font>

621
00:35:12,020 --> 00:35:20,420
first why will it connect<font color="#E5E5E5"> to my computer</font>

622
00:35:15,680 --> 00:35:23,870
not to<font color="#CCCCCC"> the original device because I</font>

623
00:35:20,420 --> 00:35:25,610
<font color="#E5E5E5">already got I will already connect to</font>

624
00:35:23,870 --> 00:35:28,670
so it will not<font color="#E5E5E5"> be able to advertise</font>

625
00:35:25,610 --> 00:35:32,200
itself<font color="#CCCCCC"> anymore</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so once I</font><font color="#E5E5E5"> connected</font>

626
00:35:28,670 --> 00:35:34,340
the device it<font color="#E5E5E5"> is off limit of any other</font>

627
00:35:32,200 --> 00:35:38,799
application wants<font color="#E5E5E5"> to</font><font color="#CCCCCC"> communicate with it</font>

628
00:35:34,340 --> 00:35:43,340
but<font color="#E5E5E5"> my VM my other VM will publish</font>

629
00:35:38,800 --> 00:35:46,670
itself as if it was the device so now I

630
00:35:43,340 --> 00:35:48,340
want to<font color="#CCCCCC"> scan</font><font color="#E5E5E5"> the services and properties</font>

631
00:35:46,670 --> 00:35:54,200
of<font color="#CCCCCC"> the device okay</font>

632
00:35:48,340 --> 00:36:03,590
so I'm<font color="#E5E5E5"> just going to you I need to the I</font>

633
00:35:54,200 --> 00:36:14,770
need<font color="#CCCCCC"> the MAC address of</font><font color="#E5E5E5"> the device okay</font>

634
00:36:03,590 --> 00:36:14,770
that's something<font color="#CCCCCC"> else</font><font color="#E5E5E5"> okay sorry</font>

635
00:36:20,750 --> 00:36:27,150
<font color="#E5E5E5">okay and services files are saved</font>

636
00:36:25,160 --> 00:36:30,629
<font color="#E5E5E5">services file is what I showed you</font>

637
00:36:27,150 --> 00:36:34,319
<font color="#CCCCCC">earlier all the properties custom</font>

638
00:36:30,630 --> 00:36:38,549
services<font color="#E5E5E5"> battery services</font><font color="#CCCCCC"> etc so now I</font>

639
00:36:34,319 --> 00:36:42,329
have<font color="#CCCCCC"> everything that I need</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> mimic the</font>

640
00:36:38,549 --> 00:36:43,619
behavior of the device<font color="#E5E5E5"> so what I'm going</font>

641
00:36:42,329 --> 00:36:49,020
<font color="#E5E5E5">to do now is</font><font color="#CCCCCC"> note</font>

642
00:36:43,619 --> 00:36:53,569
<font color="#CCCCCC">advertised</font><font color="#E5E5E5"> and then use these these</font>

643
00:36:49,020 --> 00:36:53,569
files<font color="#E5E5E5"> that I stored</font><font color="#CCCCCC"> when I scan them</font>

644
00:37:14,570 --> 00:37:18,220
and the services

645
00:37:26,040 --> 00:37:29,040
<font color="#E5E5E5">okay</font>

646
00:37:31,830 --> 00:37:37,319
I hope it works now what happened is

647
00:37:33,990 --> 00:37:38,129
that<font color="#E5E5E5"> this tool can connected to the to</font>

648
00:37:37,320 --> 00:37:48,180
the device

649
00:37:38,130 --> 00:37:54,000
now comes the<font color="#E5E5E5"> other party yes so I have</font>

650
00:37:48,180 --> 00:37:56,580
<font color="#E5E5E5">when I bought this device</font><font color="#CCCCCC"> I was</font><font color="#E5E5E5"> I've</font>

651
00:37:54,000 --> 00:37:59,010
<font color="#CCCCCC">been told go to the market and download</font>

652
00:37:56,580 --> 00:38:01,259
this power sensor<font color="#CCCCCC"> app which has all the</font>

653
00:37:59,010 --> 00:38:07,050
capabilities<font color="#CCCCCC"> that work with the device</font>

654
00:38:01,260 --> 00:38:11,490
so services basically<font color="#E5E5E5"> it's like a sport</font>

655
00:38:07,050 --> 00:38:14,850
bracelet<font color="#E5E5E5"> so it can</font><font color="#CCCCCC"> count</font><font color="#E5E5E5"> your your</font>

656
00:38:11,490 --> 00:38:18,649
calories<font color="#E5E5E5"> and measure the time and how</font>

657
00:38:14,850 --> 00:38:23,160
many pushups you're going you're doing

658
00:38:18,650 --> 00:38:29,670
<font color="#CCCCCC">etc so I'm going</font><font color="#E5E5E5"> to use this app</font><font color="#CCCCCC"> to scan</font>

659
00:38:23,160 --> 00:38:32,759
for the device<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> now I can</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> that I</font>

660
00:38:29,670 --> 00:38:36,690
the power<font color="#E5E5E5"> watch here</font><font color="#CCCCCC"> I can see to power</font>

661
00:38:32,760 --> 00:38:39,020
<font color="#E5E5E5">watches</font><font color="#CCCCCC"> one second it's because it's</font>

662
00:38:36,690 --> 00:38:42,720
disconnected

663
00:38:39,020 --> 00:38:45,150
<font color="#E5E5E5">ok yeah I can see the power watch and</font>

664
00:38:42,720 --> 00:38:49,049
when I connect to<font color="#E5E5E5"> it I actually actually</font>

665
00:38:45,150 --> 00:38:51,480
<font color="#E5E5E5">connect to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> VM so now this VM is</font>

666
00:38:49,050 --> 00:38:56,970
actually<font color="#E5E5E5"> man in the middle between the</font>

667
00:38:51,480 --> 00:39:01,710
device and<font color="#CCCCCC"> the mobile</font><font color="#E5E5E5"> so but one thing</font>

668
00:38:56,970 --> 00:39:04,890
to mention<font color="#E5E5E5"> we can see here well I can</font>

669
00:39:01,710 --> 00:39:06,960
see you cannot really see that but<font color="#E5E5E5"> it</font>

670
00:39:04,890 --> 00:39:11,339
specifies the MAC address<font color="#CCCCCC"> of the device</font>

671
00:39:06,960 --> 00:39:14,400
<font color="#E5E5E5">so basically how those devices remember</font>

672
00:39:11,340 --> 00:39:16,830
<font color="#E5E5E5">who they are talking</font><font color="#CCCCCC"> to or who their</font>

673
00:39:14,400 --> 00:39:20,340
word<font color="#E5E5E5"> be have been talking</font><font color="#CCCCCC"> to is</font>

674
00:39:16,830 --> 00:39:23,340
according to<font color="#E5E5E5"> their MAC address</font><font color="#CCCCCC"> ok so of</font>

675
00:39:20,340 --> 00:39:26,609
course if I'm going to present a false

676
00:39:23,340 --> 00:39:31,140
or different MAC address<font color="#E5E5E5"> when I'm doing</font>

677
00:39:26,609 --> 00:39:32,880
the the men in the middle<font color="#E5E5E5"> then one of</font>

678
00:39:31,140 --> 00:39:36,150
them can get suspicious

679
00:39:32,880 --> 00:39:38,400
and say wait<font color="#E5E5E5"> how can can it be a</font>

680
00:39:36,150 --> 00:39:41,730
<font color="#E5E5E5">different device how does the MAC</font>

681
00:39:38,400 --> 00:39:45,450
address<font color="#E5E5E5"> change so what</font><font color="#CCCCCC"> I will have to do</font>

682
00:39:41,730 --> 00:39:48,390
which<font color="#CCCCCC"> is kind of easy</font><font color="#E5E5E5"> is a</font>

683
00:39:45,450 --> 00:39:51,000
Mack spoofing<font color="#CCCCCC"> this tool</font><font color="#E5E5E5"> also provide</font>

684
00:39:48,390 --> 00:39:55,348
<font color="#E5E5E5">that but that requires some reset of</font><font color="#CCCCCC"> the</font>

685
00:39:51,000 --> 00:39:58,320
of the<font color="#E5E5E5"> Bluetooth so to save time I'm not</font>

686
00:39:55,349 --> 00:40:01,290
going to do that and then I'm<font color="#CCCCCC"> going to</font>

687
00:39:58,320 --> 00:40:04,380
use the same just let the device connect

688
00:40:01,290 --> 00:40:06,960
to a<font color="#CCCCCC"> different MAC address ok so we can</font>

689
00:40:04,380 --> 00:40:09,810
<font color="#E5E5E5">see that the device this device keeps</font>

690
00:40:06,960 --> 00:40:11,609
sending data to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> mobile app we don't</font>

691
00:40:09,810 --> 00:40:16,440
<font color="#E5E5E5">really know</font><font color="#CCCCCC"> yet what it what they are</font>

692
00:40:11,609 --> 00:40:24,319
but if we go to the<font color="#CCCCCC"> activity you</font><font color="#E5E5E5"> don't</font>

693
00:40:16,440 --> 00:40:24,320
see that<font color="#E5E5E5"> second let's put that</font><font color="#CCCCCC"> here that</font>

694
00:40:24,349 --> 00:40:38,730
<font color="#CCCCCC">here</font><font color="#E5E5E5"> sorry</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so I'm just going to jump</font>

695
00:40:34,170 --> 00:40:42,210
rope<font color="#CCCCCC"> ok so I play</font><font color="#E5E5E5"> press play here</font><font color="#CCCCCC"> and</font>

696
00:40:38,730 --> 00:40:46,700
here<font color="#E5E5E5"> of course</font><font color="#CCCCCC"> I need</font><font color="#E5E5E5"> to jump ok so when</font>

697
00:40:42,210 --> 00:40:49,500
I jump<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> see the values here</font><font color="#E5E5E5"> and</font>

698
00:40:46,700 --> 00:40:54,118
<font color="#CCCCCC">then you</font><font color="#E5E5E5"> can see that it actually</font><font color="#CCCCCC"> counts</font>

699
00:40:49,500 --> 00:40:56,760
<font color="#E5E5E5">my number of jumps yeah ok so this is</font>

700
00:40:54,119 --> 00:41:00,660
the<font color="#E5E5E5"> regular behavior</font><font color="#CCCCCC"> now I want</font><font color="#E5E5E5"> to</font>

701
00:40:56,760 --> 00:41:07,170
modify<font color="#E5E5E5"> this behavior so what I need</font><font color="#CCCCCC"> to</font>

702
00:41:00,660 --> 00:41:11,420
<font color="#E5E5E5">do is hook to this service and then run</font>

703
00:41:07,170 --> 00:41:11,420
a script<font color="#CCCCCC"> that modifies it in the middle</font>

704
00:41:12,650 --> 00:41:17,150
so I already<font color="#E5E5E5"> done that</font><font color="#CCCCCC"> but</font>

705
00:41:22,819 --> 00:41:30,109
<font color="#E5E5E5">okay so this is the function this short</font>

706
00:41:26,040 --> 00:41:33,210
script<font color="#E5E5E5"> that is a treadmill hook that</font>

707
00:41:30,109 --> 00:41:36,839
<font color="#E5E5E5">basically what I did here is that I told</font>

708
00:41:33,210 --> 00:41:40,500
him every<font color="#E5E5E5"> time that you see these values</font>

709
00:41:36,839 --> 00:41:41,369
sorry<font color="#E5E5E5"> these values in the in the data in</font>

710
00:41:40,500 --> 00:41:45,450
the communication

711
00:41:41,369 --> 00:41:50,130
these are hex values just<font color="#E5E5E5"> add replace</font>

712
00:41:45,450 --> 00:42:02,279
the last two<font color="#E5E5E5"> zeros with once okay simple</font>

713
00:41:50,130 --> 00:42:05,609
<font color="#CCCCCC">hook okay now it's not going to work</font>

714
00:42:02,280 --> 00:42:08,809
because this device is already<font color="#E5E5E5"> connected</font>

715
00:42:05,609 --> 00:42:08,808
so one second

716
00:42:24,480 --> 00:42:31,130
<font color="#E5E5E5">yes of</font><font color="#CCCCCC"> course I'm going to do that in</font>

717
00:42:26,849 --> 00:42:31,130
the<font color="#CCCCCC"> beginning because I must</font>

718
00:42:34,730 --> 00:42:37,730
<font color="#E5E5E5">okay</font>

719
00:42:42,770 --> 00:42:52,210
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> so now I pre hooked the treadmill</font>

720
00:42:46,850 --> 00:42:57,770
activity<font color="#E5E5E5"> it's on now I'm going to run</font>

721
00:42:52,210 --> 00:43:01,369
but what I<font color="#CCCCCC"> don't show you that I</font><font color="#E5E5E5"> run</font>

722
00:42:57,770 --> 00:43:05,200
really<font color="#E5E5E5"> fast</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> and then I just of</font>

723
00:43:01,369 --> 00:43:09,500
course in this<font color="#CCCCCC"> case</font><font color="#E5E5E5"> no harm was really</font>

724
00:43:05,200 --> 00:43:14,569
made nor for the<font color="#E5E5E5"> device or</font><font color="#CCCCCC"> to the</font><font color="#E5E5E5"> to the</font>

725
00:43:09,500 --> 00:43:17,690
mobile app but it's it's<font color="#E5E5E5"> working here on</font>

726
00:43:14,570 --> 00:43:21,020
this<font color="#CCCCCC"> this sport device it might</font><font color="#E5E5E5"> work on</font>

727
00:43:17,690 --> 00:43:26,560
more critical devices<font color="#E5E5E5"> critical or in</font>

728
00:43:21,020 --> 00:43:31,060
terms of security or medical etc okay so

729
00:43:26,560 --> 00:43:34,940
it keeps counting but I just add a few

730
00:43:31,060 --> 00:43:38,330
modified a<font color="#E5E5E5"> few bits there and</font><font color="#CCCCCC"> modified</font>

731
00:43:34,940 --> 00:43:40,820
<font color="#CCCCCC">the data</font><font color="#E5E5E5"> okay</font>

732
00:43:38,330 --> 00:43:44,200
so<font color="#E5E5E5"> this is less interesting actually the</font>

733
00:43:40,820 --> 00:43:48,200
<font color="#E5E5E5">more interesting is that in</font><font color="#CCCCCC"> addition</font>

734
00:43:44,200 --> 00:43:50,480
because<font color="#E5E5E5"> we all love surf is so much then</font>

735
00:43:48,200 --> 00:43:54,140
this<font color="#E5E5E5"> device now</font><font color="#CCCCCC"> because you are going to</font>

736
00:43:50,480 --> 00:43:57,350
<font color="#E5E5E5">use it to run in many in many cases so</font>

737
00:43:54,140 --> 00:44:02,118
this device also<font color="#E5E5E5"> allows me to</font><font color="#CCCCCC"> take</font>

738
00:43:57,350 --> 00:44:04,540
<font color="#CCCCCC">pictures and then is where the part</font>

739
00:44:02,119 --> 00:44:06,980
where it gets<font color="#E5E5E5"> sorry</font>

740
00:44:04,540 --> 00:44:09,710
interesting so if you don't want to be

741
00:44:06,980 --> 00:44:14,090
on the picture it's that the time to

742
00:44:09,710 --> 00:44:19,720
cover yourself<font color="#E5E5E5"> yeah and then I'm going</font>

743
00:44:14,090 --> 00:44:19,720
<font color="#CCCCCC">to</font><font color="#E5E5E5"> okay I'll flip that later</font>

744
00:44:23,170 --> 00:44:36,860
<font color="#CCCCCC">at second some coordination Appa and</font><font color="#E5E5E5"> I</font>

745
00:44:32,600 --> 00:44:40,640
<font color="#E5E5E5">took the picture don't know if you can</font>

746
00:44:36,860 --> 00:44:44,360
see that but every time<font color="#E5E5E5"> I click I take a</font>

747
00:44:40,640 --> 00:44:47,660
picture<font color="#CCCCCC"> okay so of course now it becomes</font>

748
00:44:44,360 --> 00:44:49,640
more<font color="#CCCCCC"> interesting what I'm going to</font>

749
00:44:47,660 --> 00:44:51,500
change the data<font color="#CCCCCC"> now in</font><font color="#E5E5E5"> this case I'm not</font>

750
00:44:49,640 --> 00:44:56,210
<font color="#CCCCCC">going to change the data</font><font color="#E5E5E5"> so I'm going</font><font color="#CCCCCC"> to</font>

751
00:44:51,500 --> 00:44:58,310
use<font color="#CCCCCC"> different tool now although now the</font>

752
00:44:56,210 --> 00:45:01,070
newest version<font color="#E5E5E5"> of the Tucker also</font>

753
00:44:58,310 --> 00:45:07,460
support<font color="#E5E5E5"> replay attack I'm going to show</font>

754
00:45:01,070 --> 00:45:12,740
<font color="#E5E5E5">another great tool yeah</font><font color="#CCCCCC"> okay</font>

755
00:45:07,460 --> 00:45:14,650
it's called<font color="#CCCCCC"> beetlejuice we're</font><font color="#E5E5E5"> very</font>

756
00:45:12,740 --> 00:45:17,709
creative with<font color="#E5E5E5"> the names</font>

757
00:45:14,650 --> 00:45:17,709
[Music]

758
00:45:27,710 --> 00:45:30,710
yeah

759
00:45:42,720 --> 00:45:46,649
oh I forgot<font color="#CCCCCC"> to mention I'm not going to</font>

760
00:45:45,090 --> 00:45:51,060
show<font color="#E5E5E5"> that because I might see that I'm</font>

761
00:45:46,650 --> 00:45:55,620
sure it in time but so WebSockets<font color="#CCCCCC"> really</font>

762
00:45:51,060 --> 00:45:59,029
easy to use burp<font color="#CCCCCC"> because burp supports</font>

763
00:45:55,620 --> 00:46:01,680
WebSocket so all we need<font color="#E5E5E5"> to do is</font>

764
00:45:59,030 --> 00:46:04,380
traffic the communication from<font color="#CCCCCC"> the</font>

765
00:46:01,680 --> 00:46:07,680
computer to<font color="#CCCCCC"> burp</font><font color="#E5E5E5"> and then route it to</font>

766
00:46:04,380 --> 00:46:11,430
<font color="#E5E5E5">the to the device and then we can use</font>

767
00:46:07,680 --> 00:46:14,970
the WebSocket feature of<font color="#E5E5E5"> burp to just</font>

768
00:46:11,430 --> 00:46:16,950
<font color="#E5E5E5">modify the data in runtime</font><font color="#CCCCCC"> ok so instead</font>

769
00:46:14,970 --> 00:46:21,770
<font color="#CCCCCC">of hooking to the data we</font><font color="#E5E5E5"> can just</font>

770
00:46:16,950 --> 00:46:25,580
modifying each request at a time<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so</font>

771
00:46:21,770 --> 00:46:25,580
<font color="#CCCCCC">back</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> beetlejuice</font>

772
00:46:41,500 --> 00:46:45,210
<font color="#E5E5E5">yes great</font>

773
00:46:55,700 --> 00:47:02,480
<font color="#E5E5E5">okay Beetlejuice also has a web</font>

774
00:46:58,940 --> 00:47:07,450
interface<font color="#CCCCCC"> so now I need to</font><font color="#E5E5E5"> select the</font>

775
00:47:02,480 --> 00:47:07,450
target let's see that the device<font color="#CCCCCC"> is on</font>

776
00:47:25,790 --> 00:47:38,380
<font color="#E5E5E5">okay just light</font><font color="#CCCCCC"> it up let's hope I can</font>

777
00:47:29,870 --> 00:47:38,380
<font color="#E5E5E5">find it Wow</font>

778
00:47:47,840 --> 00:47:55,310
there it is okay<font color="#CCCCCC"> so this app now</font><font color="#E5E5E5"> it's</font>

779
00:47:53,630 --> 00:47:59,030
doing<font color="#E5E5E5"> the same is discovering the</font>

780
00:47:55,310 --> 00:48:06,250
services<font color="#E5E5E5"> didn't connect</font><font color="#CCCCCC"> okay and copying</font>

781
00:47:59,030 --> 00:48:06,250
<font color="#E5E5E5">the services and publishing it by itself</font>

782
00:48:16,210 --> 00:48:20,970
come on you can do it

783
00:48:27,099 --> 00:48:29,160
<font color="#E5E5E5">you</font>

784
00:48:39,000 --> 00:48:47,640
last<font color="#CCCCCC"> Drive not I'm</font><font color="#E5E5E5"> going to have</font>

785
00:48:43,240 --> 00:48:47,640
prepared<font color="#E5E5E5"> a</font><font color="#CCCCCC"> video of course</font>

786
00:49:17,890 --> 00:49:31,029
<font color="#E5E5E5">okay that was the most more interesting</font>

787
00:49:25,369 --> 00:49:31,030
part<font color="#E5E5E5"> let's see last last try</font>

788
00:49:41,510 --> 00:49:54,359
<font color="#E5E5E5">okay so I'm going to move</font><font color="#CCCCCC"> to the back-up</font>

789
00:49:45,630 --> 00:49:56,700
<font color="#E5E5E5">plan and show you the video okay camera</font>

790
00:49:54,359 --> 00:50:00,930
replay attack<font color="#CCCCCC"> we don't need the</font>

791
00:49:56,700 --> 00:50:03,689
preparation<font color="#E5E5E5"> okay so I'm going</font><font color="#CCCCCC"> to select</font>

792
00:50:00,930 --> 00:50:07,460
the same watch and then connect<font color="#CCCCCC"> to it</font>

793
00:50:03,690 --> 00:50:10,109
<font color="#E5E5E5">now every time I'm going to click</font><font color="#CCCCCC"> and</font>

794
00:50:07,460 --> 00:50:12,329
start the camera here it's going<font color="#E5E5E5"> to send</font>

795
00:50:10,109 --> 00:50:24,089
a<font color="#CCCCCC"> request and</font><font color="#E5E5E5"> you can see here the data</font>

796
00:50:12,329 --> 00:50:25,710
here<font color="#E5E5E5"> and then with this tool okay so I</font>

797
00:50:24,089 --> 00:50:30,540
<font color="#E5E5E5">don't have to be on the camera to start</font>

798
00:50:25,710 --> 00:50:33,599
<font color="#E5E5E5">the camera and then I take the picture</font>

799
00:50:30,540 --> 00:50:36,690
<font color="#E5E5E5">and I can see the request here let's</font>

800
00:50:33,599 --> 00:50:40,520
call<font color="#E5E5E5"> it request okay</font><font color="#CCCCCC"> the the data here</font>

801
00:50:36,690 --> 00:50:44,910
<font color="#E5E5E5">and then I can simply select one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> them</font>

802
00:50:40,520 --> 00:50:47,700
<font color="#E5E5E5">right click and replay it and then every</font>

803
00:50:44,910 --> 00:50:50,069
time I'm going<font color="#E5E5E5"> to click the picture</font><font color="#CCCCCC"> it's</font>

804
00:50:47,700 --> 00:50:52,950
going to take a picture<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the on the</font>

805
00:50:50,069 --> 00:50:56,099
device<font color="#E5E5E5"> so I don't have to be there</font><font color="#CCCCCC"> I can</font>

806
00:50:52,950 --> 00:50:58,828
<font color="#E5E5E5">just start once I have this this let's</font>

807
00:50:56,099 --> 00:51:01,560
call<font color="#E5E5E5"> it request</font><font color="#CCCCCC"> I can start taking</font>

808
00:50:58,829 --> 00:51:04,349
picture on pictures on your phone<font color="#E5E5E5"> and it</font>

809
00:51:01,560 --> 00:51:06,480
doesn't hand with pictures because the

810
00:51:04,349 --> 00:51:09,930
device also allows to<font color="#E5E5E5"> play music on the</font>

811
00:51:06,480 --> 00:51:20,329
phone so I<font color="#CCCCCC"> can</font><font color="#E5E5E5"> also let's see if I have</font>

812
00:51:09,930 --> 00:51:26,160
<font color="#CCCCCC">that yeah so we have</font><font color="#E5E5E5"> audio if</font><font color="#CCCCCC"> I connect</font>

813
00:51:20,329 --> 00:51:32,750
the let's try probably<font color="#E5E5E5"> going to make a</font>

814
00:51:26,160 --> 00:51:32,750
lot of noise<font color="#E5E5E5"> does it work</font>

815
00:51:36,020 --> 00:51:42,950
okay<font color="#E5E5E5"> let's</font><font color="#CCCCCC"> you'll have to imagine that</font>

816
00:51:40,490 --> 00:51:46,069
<font color="#CCCCCC">visualize though you can see that when I</font>

817
00:51:42,950 --> 00:51:48,290
sent it it started the<font color="#E5E5E5"> music so I can</font>

818
00:51:46,070 --> 00:51:52,070
start playing<font color="#E5E5E5"> don't know if you can see</font>

819
00:51:48,290 --> 00:51:55,400
but the the songs are<font color="#E5E5E5"> going to change</font>

820
00:51:52,070 --> 00:51:59,900
here and I<font color="#E5E5E5"> don't have to be on the app</font>

821
00:51:55,400 --> 00:52:01,400
<font color="#E5E5E5">to be to do</font><font color="#CCCCCC"> that so once I have that if</font>

822
00:51:59,900 --> 00:52:04,190
I'm<font color="#E5E5E5"> sitting in the next room</font>

823
00:52:01,400 --> 00:52:08,330
<font color="#CCCCCC">and someone is now presenting his talk</font><font color="#E5E5E5"> I</font>

824
00:52:04,190 --> 00:52:11,390
can start<font color="#E5E5E5"> this music on the phone from</font>

825
00:52:08,330 --> 00:52:13,540
<font color="#CCCCCC">the room nearby okay so you</font><font color="#E5E5E5"> can see that</font>

826
00:52:11,390 --> 00:52:16,520
every<font color="#E5E5E5"> time</font><font color="#CCCCCC"> I click the notify here it</font>

827
00:52:13,540 --> 00:52:21,859
changed<font color="#CCCCCC"> the band here or there's the</font>

828
00:52:16,520 --> 00:52:23,660
song here and I can start and stop<font color="#CCCCCC"> I'm</font>

829
00:52:21,859 --> 00:52:26,720
sorry<font color="#CCCCCC"> that the demo</font><font color="#E5E5E5"> didn't there's a</font>

830
00:52:23,660 --> 00:52:29,540
live demo didn't work<font color="#CCCCCC"> ten minutes okay</font>

831
00:52:26,720 --> 00:52:34,848
<font color="#CCCCCC">so I'm</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> in to wrap up</font><font color="#E5E5E5"> so we've seen</font>

832
00:52:29,540 --> 00:52:37,580
attacker yeah okay so we've seen

833
00:52:34,849 --> 00:52:41,710
<font color="#E5E5E5">attacker a great tool but slam</font><font color="#CCCCCC"> slam here</font>

834
00:52:37,580 --> 00:52:44,750
which allows us to hook<font color="#CCCCCC"> to devices and</font>

835
00:52:41,710 --> 00:52:45,710
also in the newer version allows us to

836
00:52:44,750 --> 00:52:48,140
<font color="#CCCCCC">replay</font>

837
00:52:45,710 --> 00:52:51,560
we're from the replay attack<font color="#E5E5E5"> that we can</font>

838
00:52:48,140 --> 00:52:54,589
also use it<font color="#CCCCCC"> to to use</font><font color="#E5E5E5"> burp so we can</font>

839
00:52:51,560 --> 00:52:57,980
just route the the data to our computer

840
00:52:54,589 --> 00:53:01,670
to burp<font color="#E5E5E5"> and then modify</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> data in in</font>

841
00:52:57,980 --> 00:53:05,089
<font color="#E5E5E5">real time and then we saw</font><font color="#CCCCCC"> be Beetlejuice</font>

842
00:53:01,670 --> 00:53:08,270
which has a nice web interface<font color="#CCCCCC"> doesn't</font>

843
00:53:05,089 --> 00:53:12,109
<font color="#E5E5E5">also always work but when it does it's</font>

844
00:53:08,270 --> 00:53:17,060
great<font color="#E5E5E5"> needs is one click from replaying</font>

845
00:53:12,109 --> 00:53:21,500
<font color="#E5E5E5">at replay attack okay so we saw that</font>

846
00:53:17,060 --> 00:53:24,920
<font color="#E5E5E5">it's not secure what can we do</font><font color="#CCCCCC"> well if</font>

847
00:53:21,500 --> 00:53:26,390
we're using insecure protocol<font color="#CCCCCC"> then we</font>

848
00:53:24,920 --> 00:53:29,660
are<font color="#E5E5E5"> left on the application side to</font>

849
00:53:26,390 --> 00:53:32,660
protect<font color="#CCCCCC"> of course on both side we need</font>

850
00:53:29,660 --> 00:53:35,720
<font color="#CCCCCC">to not rely on</font><font color="#E5E5E5"> the data perform input</font>

851
00:53:32,660 --> 00:53:38,029
validation<font color="#E5E5E5"> if we can and most</font>

852
00:53:35,720 --> 00:53:39,980
importantly and for some access control

853
00:53:38,030 --> 00:53:43,580
so the device cannot just connect<font color="#E5E5E5"> to</font>

854
00:53:39,980 --> 00:53:45,830
<font color="#E5E5E5">anyone</font><font color="#CCCCCC"> we can start serve user token on</font>

855
00:53:43,580 --> 00:53:48,589
the first<font color="#E5E5E5"> connection so the first time</font>

856
00:53:45,830 --> 00:53:49,460
the first time<font color="#CCCCCC"> we have to click let's</font>

857
00:53:48,589 --> 00:53:52,369
say on

858
00:53:49,460 --> 00:53:54,380
button then they bond<font color="#E5E5E5"> the pair for the</font>

859
00:53:52,369 --> 00:53:56,390
first time then we store token and then

860
00:53:54,380 --> 00:53:58,790
without<font color="#E5E5E5"> this token all without resetting</font>

861
00:53:56,390 --> 00:54:02,000
the device we cannot further communicate

862
00:53:58,790 --> 00:54:06,259
it<font color="#E5E5E5"> but most importantly as always</font>

863
00:54:02,000 --> 00:54:08,359
<font color="#E5E5E5">encrypt sign verify it's all it's these</font>

864
00:54:06,260 --> 00:54:11,720
possibilities are provided by the

865
00:54:08,359 --> 00:54:17,119
protocol even 4.0<font color="#CCCCCC"> but they are not used</font>

866
00:54:11,720 --> 00:54:20,660
<font color="#E5E5E5">so</font><font color="#CCCCCC"> do</font><font color="#E5E5E5"> that and we're seven minutes</font><font color="#CCCCCC"> from</font>

867
00:54:17,119 --> 00:54:24,230
finish<font color="#E5E5E5"> so one last word</font><font color="#CCCCCC"> so I told you</font><font color="#E5E5E5"> I</font>

868
00:54:20,660 --> 00:54:27,890
just<font color="#E5E5E5"> moved to Toronto recently sorry but</font>

869
00:54:24,230 --> 00:54:29,180
I have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> I'm going to we're</font><font color="#CCCCCC"> going to</font>

870
00:54:27,890 --> 00:54:31,520
<font color="#E5E5E5">lunch</font>

871
00:54:29,180 --> 00:54:33,848
besides event on Toronto<font color="#E5E5E5"> in Toronto it's</font>

872
00:54:31,520 --> 00:54:35,750
not going to be that big<font color="#CCCCCC"> but it's</font>

873
00:54:33,849 --> 00:54:37,310
<font color="#E5E5E5">hopefully it's going to be nice we're</font>

874
00:54:35,750 --> 00:54:41,089
<font color="#E5E5E5">going to have some workshops and capture</font>

875
00:54:37,310 --> 00:54:43,790
the<font color="#E5E5E5"> flag</font><font color="#CCCCCC"> maybe not as cool as the ones</font>

876
00:54:41,089 --> 00:54:45,560
Jordan shows<font color="#E5E5E5"> showed us earlier but</font>

877
00:54:43,790 --> 00:54:49,160
hopefully it's going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be fun</font>

878
00:54:45,560 --> 00:54:51,589
it's<font color="#E5E5E5"> gonna be in November this year stay</font>

879
00:54:49,160 --> 00:54:54,170
tuned we're just preparing<font color="#E5E5E5"> starting now</font>

880
00:54:51,589 --> 00:54:57,770
launching it now so<font color="#E5E5E5"> you can follow us on</font>

881
00:54:54,170 --> 00:55:01,790
our website or<font color="#E5E5E5"> our on our Twitter at</font>

882
00:54:57,770 --> 00:55:03,560
Twitter handle<font color="#CCCCCC"> and that's it thank you</font>

883
00:55:01,790 --> 00:55:06,369
<font color="#CCCCCC">very much</font><font color="#E5E5E5"> thank you for coming</font>

884
00:55:03,560 --> 00:55:10,820
most of you are<font color="#CCCCCC"> still</font><font color="#E5E5E5"> awake that's good</font>

885
00:55:06,369 --> 00:55:11,240
<font color="#CCCCCC">and enjoy the</font><font color="#E5E5E5"> conference the rest of the</font>

886
00:55:10,820 --> 00:55:13,690
conference

887
00:55:11,240 --> 00:55:13,689
thank you very<font color="#CCCCCC"> much</font>

888
00:55:17,110 --> 00:55:22,570
questions<font color="#E5E5E5"> thank you very much yeah we</font>

889
00:55:19,310 --> 00:55:22,570
still have a few minutes<font color="#CCCCCC"> for questions</font>

890
00:55:24,100 --> 00:55:43,130
yeah so you said earlier that you had to

891
00:55:39,080 --> 00:55:46,130
have two separate devices<font color="#E5E5E5"> because it was</font>

892
00:55:43,130 --> 00:55:48,380
using<font color="#CCCCCC"> one side was</font><font color="#E5E5E5"> the slave</font><font color="#CCCCCC"> the other</font>

893
00:55:46,130 --> 00:55:50,750
was the<font color="#E5E5E5"> master so you could not connect</font>

894
00:55:48,380 --> 00:55:54,350
directly and<font color="#E5E5E5"> do</font><font color="#CCCCCC"> an mine man in the</font>

895
00:55:50,750 --> 00:55:56,180
<font color="#E5E5E5">middle right so my question is if the</font>

896
00:55:54,350 --> 00:56:00,440
device<font color="#CCCCCC"> is already</font><font color="#E5E5E5"> connected</font><font color="#CCCCCC"> to some</font>

897
00:55:56,180 --> 00:56:02,270
other same thing you cannot do any man

898
00:56:00,440 --> 00:56:05,150
in the<font color="#E5E5E5"> middle because you will have</font><font color="#CCCCCC"> to</font>

899
00:56:02,270 --> 00:56:09,170
kind of do the same<font color="#CCCCCC"> thing as we doing</font>

900
00:56:05,150 --> 00:56:12,020
with Wi-Fi which is beyond 2050 do I

901
00:56:09,170 --> 00:56:14,600
know that<font color="#CCCCCC"> I can then we</font><font color="#E5E5E5"> bang yeah if</font>

902
00:56:12,020 --> 00:56:16,970
they are or if<font color="#E5E5E5"> they are on</font><font color="#CCCCCC"> the state</font>

903
00:56:14,600 --> 00:56:17,569
<font color="#E5E5E5">that they</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> completely</font><font color="#CCCCCC"> connected to</font>

904
00:56:16,970 --> 00:56:20,990
each<font color="#E5E5E5"> other</font>

905
00:56:17,570 --> 00:56:23,750
you would have to cause them to D

906
00:56:20,990 --> 00:56:27,589
connect<font color="#E5E5E5"> and yeah how would you do that</font>

907
00:56:23,750 --> 00:56:30,770
<font color="#CCCCCC">okay so there are a</font><font color="#E5E5E5"> few methods</font><font color="#CCCCCC"> okay so</font>

908
00:56:27,590 --> 00:56:33,230
first of all<font color="#E5E5E5"> they're not always</font>

909
00:56:30,770 --> 00:56:36,680
<font color="#CCCCCC">connected to</font><font color="#E5E5E5"> each other</font><font color="#CCCCCC"> because in order</font>

910
00:56:33,230 --> 00:56:38,480
<font color="#CCCCCC">to not consume all the power once they</font>

911
00:56:36,680 --> 00:56:40,700
are not in reach they are<font color="#E5E5E5"> going to</font>

912
00:56:38,480 --> 00:56:43,190
disconnect<font color="#E5E5E5"> you can wait for that period</font>

913
00:56:40,700 --> 00:56:46,609
<font color="#E5E5E5">time</font><font color="#CCCCCC"> period but there are also methods</font>

914
00:56:43,190 --> 00:56:50,180
of cutting<font color="#E5E5E5"> them to</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> to D connect</font>

915
00:56:46,610 --> 00:56:53,420
<font color="#E5E5E5">there are few methods you can jam you</font>

916
00:56:50,180 --> 00:56:57,290
<font color="#CCCCCC">can start</font><font color="#E5E5E5"> a no broadcast really strong</font>

917
00:56:53,420 --> 00:57:00,820
with your with more device more<font color="#E5E5E5"> adapters</font>

918
00:56:57,290 --> 00:57:04,910
and let the device connect to you

919
00:57:00,820 --> 00:57:07,550
confuse instead of the<font color="#E5E5E5"> original device</font>

920
00:57:04,910 --> 00:57:11,500
but<font color="#E5E5E5"> yeah you would have to cause them to</font>

921
00:57:07,550 --> 00:57:11,500
<font color="#CCCCCC">reconnect to</font><font color="#E5E5E5"> D connect from each other</font>

922
00:57:12,760 --> 00:57:20,170
any<font color="#E5E5E5"> other questions thank you</font><font color="#CCCCCC"> very much</font>

923
00:57:20,590 --> 00:57:27,469
<font color="#CCCCCC">okay thank you</font><font color="#E5E5E5"> very much</font>

924
00:57:22,510 --> 00:57:27,469
[Applause]

