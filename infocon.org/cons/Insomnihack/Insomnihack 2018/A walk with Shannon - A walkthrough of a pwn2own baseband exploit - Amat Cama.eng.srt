1
00:00:07,250 --> 00:00:10,619
[Music]

2
00:00:13,209 --> 00:00:19,669
<font color="#E5E5E5">all right hi everybody</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going to talk</font>

3
00:00:17,150 --> 00:00:22,759
<font color="#CCCCCC">about base point</font><font color="#E5E5E5"> base band exploitation</font>

4
00:00:19,669 --> 00:00:25,849
today and mainly I'll talk about the

5
00:00:22,759 --> 00:00:28,430
<font color="#CCCCCC">samsung Shannon baseband and how I was</font>

6
00:00:25,849 --> 00:00:33,140
<font color="#E5E5E5">able to exploit it for mobile</font><font color="#CCCCCC"> phone to</font>

7
00:00:28,430 --> 00:00:36,289
<font color="#CCCCCC">own last year in Tokyo so this is the</font>

8
00:00:33,140 --> 00:00:39,260
structure<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> talk basically I'll</font>

9
00:00:36,289 --> 00:00:42,170
<font color="#CCCCCC">just give a brief introduction</font><font color="#E5E5E5"> about me</font>

10
00:00:39,260 --> 00:00:45,920
<font color="#CCCCCC">you know I also talked about some</font><font color="#E5E5E5"> prior</font>

11
00:00:42,170 --> 00:00:47,810
work that has been done<font color="#E5E5E5"> for this on this</font>

12
00:00:45,920 --> 00:00:49,910
topic and<font color="#E5E5E5"> basically I'll give you a</font>

13
00:00:47,810 --> 00:00:52,250
<font color="#E5E5E5">summary of what a cellular network is</font>

14
00:00:49,910 --> 00:00:54,890
because I'm pretty<font color="#E5E5E5"> sure some people here</font>

15
00:00:52,250 --> 00:00:56,809
don't<font color="#E5E5E5"> know and with then we'll talk</font>

16
00:00:54,890 --> 00:01:00,140
<font color="#E5E5E5">about the</font><font color="#CCCCCC"> Shannon baseband</font><font color="#E5E5E5"> and finding</font>

17
00:00:56,809 --> 00:01:06,908
some bugs in it and I'll do a demo in

18
00:01:00,140 --> 00:01:09,500
it's a video<font color="#E5E5E5"> so my name is</font><font color="#CCCCCC"> Ahmad kama</font>

19
00:01:06,909 --> 00:01:11,770
<font color="#E5E5E5">right now I'm an independent security</font>

20
00:01:09,500 --> 00:01:17,329
researcher<font color="#E5E5E5"> it basically means unemployed</font>

21
00:01:11,770 --> 00:01:19,908
but I play<font color="#E5E5E5"> CDF with shellfish and my</font>

22
00:01:17,329 --> 00:01:23,389
main focus is exploitation<font color="#E5E5E5"> and reverse</font>

23
00:01:19,909 --> 00:01:26,409
engineering<font color="#E5E5E5"> and currently I'm focusing</font>

24
00:01:23,389 --> 00:01:29,779
on hypervisors and baseband<font color="#E5E5E5"> and</font>

25
00:01:26,409 --> 00:01:32,389
previously I worked at virtual<font color="#CCCCCC"> security</font>

26
00:01:29,779 --> 00:01:36,079
research issues which is a pen testing

27
00:01:32,389 --> 00:01:39,048
company in<font color="#E5E5E5"> Boston then I went to UCSB</font><font color="#CCCCCC"> as</font>

28
00:01:36,079 --> 00:01:42,048
a research assistant<font color="#CCCCCC"> but it was an</font>

29
00:01:39,049 --> 00:01:44,779
internship and I also worked for

30
00:01:42,049 --> 00:01:47,029
Qualcomm<font color="#E5E5E5"> as a product security engineer</font>

31
00:01:44,779 --> 00:01:50,719
mainly focusing on Wi-Fi and<font color="#CCCCCC"> Bluetooth</font>

32
00:01:47,029 --> 00:01:52,639
and then last<font color="#E5E5E5"> year I was in</font><font color="#CCCCCC"> China</font><font color="#E5E5E5"> for a</font>

33
00:01:50,719 --> 00:01:55,158
few months working<font color="#E5E5E5"> as a security</font>

34
00:01:52,639 --> 00:01:57,740
<font color="#CCCCCC">researcher and basically we</font><font color="#E5E5E5"> were</font>

35
00:01:55,159 --> 00:01:59,799
focusing<font color="#E5E5E5"> on ponchione and things like</font>

36
00:01:57,740 --> 00:01:59,798
<font color="#E5E5E5">that</font>

37
00:02:01,029 --> 00:02:07,369
<font color="#CCCCCC">all right so about</font><font color="#E5E5E5"> the prior work</font><font color="#CCCCCC"> I</font>

38
00:02:04,599 --> 00:02:11,150
don't<font color="#CCCCCC"> know</font><font color="#E5E5E5"> if any of you have seen this</font>

39
00:02:07,369 --> 00:02:13,040
talk but it's pretty<font color="#E5E5E5"> good at least if</font>

40
00:02:11,150 --> 00:02:16,670
<font color="#E5E5E5">you're interested in the</font><font color="#CCCCCC"> Samsung</font>

41
00:02:13,040 --> 00:02:21,599
<font color="#CCCCCC">baseband</font><font color="#E5E5E5"> because they really make the</font>

42
00:02:16,670 --> 00:02:23,760
process easier by basically all the

43
00:02:21,599 --> 00:02:27,119
annoying work they<font color="#E5E5E5"> would show you how to</font>

44
00:02:23,760 --> 00:02:28,888
do it easily<font color="#E5E5E5"> so really if you want to do</font>

45
00:02:27,120 --> 00:02:31,950
some research on<font color="#E5E5E5"> samsung baseband you</font>

46
00:02:28,889 --> 00:02:33,749
should you should<font color="#E5E5E5"> read this paper and I</font>

47
00:02:31,950 --> 00:02:36,388
mean you should have<font color="#CCCCCC"> a look at this talk</font>

48
00:02:33,749 --> 00:02:39,150
and<font color="#E5E5E5"> I'm also gonna be referring to</font><font color="#CCCCCC"> it</font>

49
00:02:36,389 --> 00:02:40,799
because I won't<font color="#E5E5E5"> be describing some of</font>

50
00:02:39,150 --> 00:02:42,980
<font color="#CCCCCC">the</font><font color="#E5E5E5"> things they</font><font color="#CCCCCC"> already described in</font>

51
00:02:40,799 --> 00:02:42,980
<font color="#E5E5E5">there</font>

52
00:02:43,939 --> 00:02:49,620
so<font color="#E5E5E5"> um why why do we want to</font><font color="#CCCCCC"> look at</font>

53
00:02:46,950 --> 00:02:53,399
baseband<font color="#CCCCCC"> I guess because it's fun first</font>

54
00:02:49,620 --> 00:02:56,669
<font color="#E5E5E5">of all and it's a unexplored area I</font><font color="#CCCCCC"> will</font>

55
00:02:53,400 --> 00:02:58,379
<font color="#E5E5E5">say is</font><font color="#CCCCCC"> its new but it doesn't</font><font color="#E5E5E5"> seem like</font>

56
00:02:56,669 --> 00:03:01,939
there's a lot of research being<font color="#E5E5E5"> done</font><font color="#CCCCCC"> in</font>

57
00:02:58,379 --> 00:03:03,989
there and as a security<font color="#E5E5E5"> researcher</font>

58
00:03:01,939 --> 00:03:07,049
unemployed<font color="#E5E5E5"> one you want to find some</font>

59
00:03:03,989 --> 00:03:09,209
bugs<font color="#CCCCCC"> so if you know that nobody's</font>

60
00:03:07,049 --> 00:03:11,010
<font color="#CCCCCC">looking over there you want to you know</font>

61
00:03:09,209 --> 00:03:13,590
it's a good it's<font color="#E5E5E5"> a good</font><font color="#CCCCCC"> opportunity to</font>

62
00:03:11,010 --> 00:03:16,230
<font color="#E5E5E5">find</font><font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> bugs</font><font color="#CCCCCC"> and I guess</font><font color="#E5E5E5"> learn a</font>

63
00:03:13,590 --> 00:03:20,639
lot of<font color="#E5E5E5"> things</font><font color="#CCCCCC"> also it has a pretty big</font>

64
00:03:16,230 --> 00:03:22,649
<font color="#E5E5E5">impact because I guess everybody here</font>

65
00:03:20,639 --> 00:03:25,560
has a phone<font color="#CCCCCC"> and it's connecting</font><font color="#E5E5E5"> to some</font>

66
00:03:22,650 --> 00:03:28,439
cellular<font color="#E5E5E5"> network so if you can find bugs</font>

67
00:03:25,560 --> 00:03:30,030
in the<font color="#E5E5E5"> base</font><font color="#CCCCCC"> band of different phones</font>

68
00:03:28,439 --> 00:03:33,509
then you can really attack a lot<font color="#E5E5E5"> of</font>

69
00:03:30,030 --> 00:03:35,609
people and it just<font color="#E5E5E5"> sounds cool to hack a</font>

70
00:03:33,509 --> 00:03:43,129
phone by having it connect<font color="#CCCCCC"> to a</font><font color="#E5E5E5"> serial</font>

71
00:03:35,609 --> 00:03:46,169
network so<font color="#E5E5E5"> um what is a cellular network</font>

72
00:03:43,129 --> 00:03:49,560
<font color="#E5E5E5">so it's basically just a</font><font color="#CCCCCC"> mobile</font>

73
00:03:46,169 --> 00:03:51,659
communication network and the cells in

74
00:03:49,560 --> 00:03:54,299
the name is basically land areas and

75
00:03:51,659 --> 00:03:58,319
they're covered<font color="#E5E5E5"> by transceivers base</font>

76
00:03:54,299 --> 00:04:01,650
transceiver<font color="#E5E5E5"> station</font><font color="#CCCCCC"> and basically they</font>

77
00:03:58,319 --> 00:04:04,018
join different<font color="#E5E5E5"> cells to cover a large</font>

78
00:04:01,650 --> 00:04:07,019
area<font color="#E5E5E5"> and that's why it's called a</font>

79
00:04:04,019 --> 00:04:09,689
cellular network<font color="#E5E5E5"> and technically it</font>

80
00:04:07,019 --> 00:04:11,639
could be any<font color="#E5E5E5"> kind of network but today</font>

81
00:04:09,689 --> 00:04:13,828
we only<font color="#CCCCCC"> talk about</font><font color="#E5E5E5"> mobile phone networks</font>

82
00:04:11,639 --> 00:04:18,180
<font color="#E5E5E5">but there are other kinds of cellular</font>

83
00:04:13,829 --> 00:04:22,199
networks<font color="#E5E5E5"> and I guess interesting thing</font>

84
00:04:18,180 --> 00:04:24,360
is interesting<font color="#E5E5E5"> property is that</font><font color="#CCCCCC"> you</font>

85
00:04:22,199 --> 00:04:27,120
<font color="#E5E5E5">should be able to roam around the whole</font>

86
00:04:24,360 --> 00:04:29,729
network<font color="#CCCCCC"> without</font><font color="#E5E5E5"> having to disconnect and</font>

87
00:04:27,120 --> 00:04:32,039
reconnect<font color="#E5E5E5"> every time you you know move</font>

88
00:04:29,729 --> 00:04:34,320
from one cell to<font color="#CCCCCC"> another so I guess</font>

89
00:04:32,039 --> 00:04:36,960
that's<font color="#E5E5E5"> the</font><font color="#CCCCCC"> whole purpose</font><font color="#E5E5E5"> of this whole</font>

90
00:04:34,320 --> 00:04:39,330
<font color="#E5E5E5">sell your network kind of having all</font>

91
00:04:36,960 --> 00:04:41,340
these<font color="#CCCCCC"> different</font><font color="#E5E5E5"> cells all working</font>

92
00:04:39,330 --> 00:04:45,870
together to cover every the whole

93
00:04:41,340 --> 00:04:48,630
country or<font color="#E5E5E5"> whatever so there are a bunch</font>

94
00:04:45,870 --> 00:04:50,430
<font color="#CCCCCC">of technologies</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> standards that have</font>

95
00:04:48,630 --> 00:04:55,710
been<font color="#CCCCCC"> developed for the</font><font color="#E5E5E5"> mobile phone</font>

96
00:04:50,430 --> 00:04:57,540
networks<font color="#E5E5E5"> and I guess as as time went on</font>

97
00:04:55,710 --> 00:05:00,659
<font color="#CCCCCC">people started requiring more</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> more</font>

98
00:04:57,540 --> 00:05:03,300
throughput<font color="#CCCCCC"> or faster speeds and so</font>

99
00:05:00,660 --> 00:05:07,710
basically you have different generations

100
00:05:03,300 --> 00:05:10,710
that have<font color="#E5E5E5"> been put forth so let's have a</font>

101
00:05:07,710 --> 00:05:13,289
<font color="#E5E5E5">look at those generations so basically</font>

102
00:05:10,710 --> 00:05:16,560
there are two branches<font color="#E5E5E5"> the</font><font color="#CCCCCC"> gsm branch</font>

103
00:05:13,290 --> 00:05:20,880
and the CDMA branch<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> the CDMA</font>

104
00:05:16,560 --> 00:05:22,680
branch was started by Qualcomm and today

105
00:05:20,880 --> 00:05:25,170
we're<font color="#CCCCCC"> only going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> talking about the</font>

106
00:05:22,680 --> 00:05:29,160
<font color="#E5E5E5">gsm branch but both of them share the</font>

107
00:05:25,170 --> 00:05:32,130
LTE LTE<font color="#E5E5E5"> as the fourth</font><font color="#CCCCCC"> generation and the</font>

108
00:05:29,160 --> 00:05:35,160
main differences are<font color="#CCCCCC"> I don't know</font><font color="#E5E5E5"> if</font>

109
00:05:32,130 --> 00:05:38,130
there<font color="#CCCCCC"> are CDMA phones in the US but</font><font color="#E5E5E5"> NASA</font>

110
00:05:35,160 --> 00:05:41,280
<font color="#CCCCCC">in the Europe in Europe but generally</font>

111
00:05:38,130 --> 00:05:43,740
those phones don't<font color="#E5E5E5"> have</font><font color="#CCCCCC"> sim cards so if</font>

112
00:05:41,280 --> 00:05:48,359
you have a phone<font color="#CCCCCC"> that works</font><font color="#E5E5E5"> without a</font>

113
00:05:43,740 --> 00:05:52,410
SIM card<font color="#E5E5E5"> is CDM anyone and yeah I guess</font>

114
00:05:48,360 --> 00:05:55,890
that's that's all<font color="#E5E5E5"> about now so there's</font>

115
00:05:52,410 --> 00:05:59,010
this collaboration<font color="#E5E5E5"> called the 3gpp</font><font color="#CCCCCC"> and</font>

116
00:05:55,890 --> 00:06:02,159
they are the ones<font color="#CCCCCC"> that are in charge of</font>

117
00:05:59,010 --> 00:06:05,670
you know developing and maintaining the

118
00:06:02,160 --> 00:06:07,200
technical standards which are actually

119
00:06:05,670 --> 00:06:10,680
<font color="#CCCCCC">the documents describing</font><font color="#E5E5E5"> how the</font>

120
00:06:07,200 --> 00:06:16,320
protocols work in depth<font color="#E5E5E5"> so you have one</font>

121
00:06:10,680 --> 00:06:19,770
<font color="#CCCCCC">for gsm/gprs you know UMTS</font><font color="#E5E5E5"> LTE and there</font>

122
00:06:16,320 --> 00:06:21,630
are bodies in there such<font color="#CCCCCC"> as the Etsy the</font>

123
00:06:19,770 --> 00:06:24,419
European telecommunications<font color="#E5E5E5"> standards</font>

124
00:06:21,630 --> 00:06:26,400
Institute<font color="#CCCCCC"> and there's</font><font color="#E5E5E5"> a bunch of other</font>

125
00:06:24,420 --> 00:06:30,420
countries<font color="#E5E5E5"> that have their own bodies</font>

126
00:06:26,400 --> 00:06:32,340
inside and I guess the technical

127
00:06:30,420 --> 00:06:34,500
<font color="#CCCCCC">standards I mean we care about them</font>

128
00:06:32,340 --> 00:06:40,619
<font color="#CCCCCC">because we get in-depth information</font>

129
00:06:34,500 --> 00:06:44,720
<font color="#E5E5E5">about what the protocols look like so I</font>

130
00:06:40,620 --> 00:06:48,120
have<font color="#CCCCCC"> this</font><font color="#E5E5E5"> scary-lookin diagram for you</font>

131
00:06:44,720 --> 00:06:52,949
<font color="#E5E5E5">but you should worry about it because</font>

132
00:06:48,120 --> 00:06:55,590
I mean another<font color="#E5E5E5"> something happens is this</font>

133
00:06:52,949 --> 00:06:58,260
diagram<font color="#CCCCCC"> is pretty wrong but we don't</font>

134
00:06:55,590 --> 00:07:00,210
<font color="#E5E5E5">care about that</font><font color="#CCCCCC"> because basically it</font>

135
00:06:58,260 --> 00:07:01,830
only<font color="#E5E5E5"> shows what we're interested in as</font>

136
00:07:00,210 --> 00:07:04,049
as researchers if we want to<font color="#E5E5E5"> find bugs</font>

137
00:07:01,830 --> 00:07:06,900
but normally it should<font color="#E5E5E5"> be much more</font>

138
00:07:04,050 --> 00:07:09,360
complicated than<font color="#CCCCCC"> that but basically what</font>

139
00:07:06,900 --> 00:07:14,310
I want you<font color="#E5E5E5"> guys to understand here is</font>

140
00:07:09,360 --> 00:07:18,360
that<font color="#E5E5E5"> between from</font><font color="#CCCCCC"> gsm to LTE meaning 2g</font>

141
00:07:14,310 --> 00:07:20,040
to 4G<font color="#CCCCCC"> the stack is kind</font><font color="#E5E5E5"> of similar and</font>

142
00:07:18,360 --> 00:07:24,810
nothing prevents<font color="#CCCCCC"> them from working</font>

143
00:07:20,040 --> 00:07:27,630
<font color="#E5E5E5">between each other just that uh just</font>

144
00:07:24,810 --> 00:07:29,550
<font color="#E5E5E5">that</font><font color="#CCCCCC"> I guess they've been improved up I</font>

145
00:07:27,630 --> 00:07:32,040
mean one generation<font color="#E5E5E5"> improves on the</font>

146
00:07:29,550 --> 00:07:35,880
<font color="#E5E5E5">previous one</font><font color="#CCCCCC"> by adding new protocols and</font>

147
00:07:32,040 --> 00:07:40,530
stuff like that<font color="#E5E5E5"> and basically you see</font>

148
00:07:35,880 --> 00:07:44,190
that GPRS<font color="#E5E5E5"> is pretty much the same as as</font>

149
00:07:40,530 --> 00:07:45,960
a<font color="#E5E5E5"> GSM on the third layer except that the</font>

150
00:07:44,190 --> 00:07:48,350
connection<font color="#E5E5E5"> management has been changed</font>

151
00:07:45,960 --> 00:07:52,409
to session management<font color="#E5E5E5"> meaning that</font>

152
00:07:48,350 --> 00:07:54,900
instead<font color="#CCCCCC"> of going</font><font color="#E5E5E5"> from ceará we're going</font>

153
00:07:52,410 --> 00:07:57,750
from<font color="#E5E5E5"> circuit switched Network to like a</font>

154
00:07:54,900 --> 00:08:01,710
packet<font color="#CCCCCC"> switched network and by that I</font>

155
00:07:57,750 --> 00:08:04,500
<font color="#E5E5E5">mean packets which is basically now</font>

156
00:08:01,710 --> 00:08:05,190
phones<font color="#CCCCCC"> communicate by sending</font><font color="#E5E5E5"> packets to</font>

157
00:08:04,500 --> 00:08:06,960
each other

158
00:08:05,190 --> 00:08:09,360
you<font color="#E5E5E5"> know and the address destination is</font>

159
00:08:06,960 --> 00:08:13,409
inside the packet<font color="#CCCCCC"> whereas when he was a</font>

160
00:08:09,360 --> 00:08:15,000
<font color="#CCCCCC">circuits</font><font color="#E5E5E5"> which is just and linked the</font>

161
00:08:13,410 --> 00:08:22,680
phones were linked<font color="#E5E5E5"> from one phone to</font>

162
00:08:15,000 --> 00:08:24,389
another so what<font color="#E5E5E5"> is the baseband</font><font color="#CCCCCC"> if we</font>

163
00:08:22,680 --> 00:08:25,800
were to talk about the baseband because

164
00:08:24,389 --> 00:08:28,260
that's what<font color="#E5E5E5"> we were gonna be looking at</font>

165
00:08:25,800 --> 00:08:31,050
and it's basically the component of the

166
00:08:28,260 --> 00:08:36,000
phone<font color="#E5E5E5"> that handles communicating with</font>

167
00:08:31,050 --> 00:08:38,039
the<font color="#E5E5E5"> mobile network</font><font color="#CCCCCC"> I guess</font><font color="#E5E5E5"> really is the</font>

168
00:08:36,000 --> 00:08:40,289
phone part of the phone because<font color="#E5E5E5"> nowadays</font>

169
00:08:38,039 --> 00:08:42,390
you<font color="#E5E5E5"> know we have all these</font><font color="#CCCCCC"> browsers and</font>

170
00:08:40,289 --> 00:08:45,900
stuff which aren't<font color="#E5E5E5"> really</font><font color="#CCCCCC"> needed for a</font>

171
00:08:42,390 --> 00:08:48,330
phone to<font color="#E5E5E5"> work so it deals with the</font>

172
00:08:45,900 --> 00:08:51,390
low-level radio<font color="#E5E5E5"> signaling and all those</font>

173
00:08:48,330 --> 00:08:53,010
things and<font color="#E5E5E5"> it supports all the standards</font>

174
00:08:51,390 --> 00:08:55,040
we talked<font color="#CCCCCC"> about I mean I guess it</font>

175
00:08:53,010 --> 00:08:57,420
depends on the phone you<font color="#E5E5E5"> buy button</font>

176
00:08:55,040 --> 00:09:00,230
let's just say they all support all

177
00:08:57,420 --> 00:09:00,229
these standards

178
00:09:02,930 --> 00:09:08,160
so there<font color="#E5E5E5"> are a number of different</font>

179
00:09:05,270 --> 00:09:10,829
implementations<font color="#CCCCCC"> qualcomm owns most of</font>

180
00:09:08,160 --> 00:09:14,010
<font color="#E5E5E5">the market so basically as you</font><font color="#CCCCCC"> can see</font>

181
00:09:10,830 --> 00:09:16,020
this huge list<font color="#E5E5E5"> of phones and most of</font>

182
00:09:14,010 --> 00:09:18,450
them are using<font color="#CCCCCC"> qualcomm phones so</font><font color="#E5E5E5"> i</font>

183
00:09:16,020 --> 00:09:22,020
guess one thing<font color="#E5E5E5"> to point out is you see</font>

184
00:09:18,450 --> 00:09:24,540
<font color="#E5E5E5">galaxy under Samsung and Qualcomm</font><font color="#CCCCCC"> the</font>

185
00:09:22,020 --> 00:09:27,449
<font color="#CCCCCC">the difference is that</font><font color="#E5E5E5"> the u.s. Samsung</font>

186
00:09:24,540 --> 00:09:30,660
Galaxy phones are using this Qualcomm

187
00:09:27,450 --> 00:09:32,730
basement while the rest of<font color="#E5E5E5"> the world is</font>

188
00:09:30,660 --> 00:09:36,150
pretty<font color="#E5E5E5"> much using the one from Samsung</font>

189
00:09:32,730 --> 00:09:39,270
<font color="#E5E5E5">and nowadays</font><font color="#CCCCCC"> there's the new Intel I</font>

190
00:09:36,150 --> 00:09:41,160
don't know if it's new but at least it

191
00:09:39,270 --> 00:09:43,470
has<font color="#E5E5E5"> just been recently started being</font>

192
00:09:41,160 --> 00:09:48,180
<font color="#E5E5E5">used in phones so such as the iPhone X</font>

193
00:09:43,470 --> 00:09:50,730
<font color="#E5E5E5">iPhone 8 and also there's</font><font color="#CCCCCC"> wali</font><font color="#E5E5E5"> and I</font>

194
00:09:48,180 --> 00:09:53,160
don't know how long<font color="#E5E5E5"> there's this</font><font color="#CCCCCC"> van</font><font color="#E5E5E5"> has</font>

195
00:09:50,730 --> 00:09:55,320
been<font color="#CCCCCC"> around</font><font color="#E5E5E5"> but they also started using</font>

196
00:09:53,160 --> 00:09:57,240
<font color="#E5E5E5">their own instead of Qualcomm</font><font color="#CCCCCC"> it used to</font>

197
00:09:55,320 --> 00:09:59,700
be that pretty<font color="#E5E5E5"> much all these phones is</font>

198
00:09:57,240 --> 00:10:01,590
to use<font color="#E5E5E5"> Qualcomm</font><font color="#CCCCCC"> baseman's but now it</font>

199
00:09:59,700 --> 00:10:08,340
seems<font color="#CCCCCC"> like they</font><font color="#E5E5E5"> started shifting towards</font>

200
00:10:01,590 --> 00:10:10,640
their own<font color="#E5E5E5"> perhaps</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> to cut costs so</font>

201
00:10:08,340 --> 00:10:13,950
the most common architecture<font color="#E5E5E5"> today is</font>

202
00:10:10,640 --> 00:10:16,110
like this so you have<font color="#CCCCCC"> a chip that's</font>

203
00:10:13,950 --> 00:10:17,970
dedicated<font color="#E5E5E5"> for the</font><font color="#CCCCCC"> baseband</font><font color="#E5E5E5"> and then you</font>

204
00:10:16,110 --> 00:10:20,910
have another<font color="#E5E5E5"> one which is</font><font color="#CCCCCC"> the</font>

205
00:10:17,970 --> 00:10:22,680
<font color="#CCCCCC">application processor so we</font>

206
00:10:20,910 --> 00:10:24,719
differentiate<font color="#E5E5E5"> between the cellular</font>

207
00:10:22,680 --> 00:10:26,670
processor and the application processor

208
00:10:24,720 --> 00:10:29,370
but it seems like in the<font color="#CCCCCC"> past in the</font>

209
00:10:26,670 --> 00:10:32,880
past<font color="#E5E5E5"> it</font><font color="#CCCCCC"> used to be that it would</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> just</font>

210
00:10:29,370 --> 00:10:35,610
one processor<font color="#CCCCCC"> doing both and in that</font>

211
00:10:32,880 --> 00:10:37,860
case it would be interesting<font color="#E5E5E5"> because if</font>

212
00:10:35,610 --> 00:10:41,190
you own the baseband<font color="#E5E5E5"> it means you</font>

213
00:10:37,860 --> 00:10:44,550
directly<font color="#E5E5E5"> on the phone so the code is</font>

214
00:10:41,190 --> 00:10:47,900
generally written<font color="#E5E5E5"> in C</font><font color="#CCCCCC"> C++</font><font color="#E5E5E5"> which is a</font>

215
00:10:44,550 --> 00:10:50,640
good<font color="#E5E5E5"> thing for us</font><font color="#CCCCCC"> as researchers and</font>

216
00:10:47,900 --> 00:10:53,160
another thing is there's a communication

217
00:10:50,640 --> 00:10:54,870
interface between the<font color="#CCCCCC"> base</font><font color="#E5E5E5"> the cellular</font>

218
00:10:53,160 --> 00:10:58,680
processor and the application processor

219
00:10:54,870 --> 00:11:01,290
<font color="#CCCCCC">and usually</font><font color="#E5E5E5"> they they'll be like a</font>

220
00:10:58,680 --> 00:11:03,239
serial link<font color="#E5E5E5"> you know and also they use</font>

221
00:11:01,290 --> 00:11:09,990
shared memory for transferring large

222
00:11:03,240 --> 00:11:11,139
<font color="#E5E5E5">amounts of data so like I said you</font><font color="#CCCCCC"> know</font>

223
00:11:09,990 --> 00:11:13,299
getting

224
00:11:11,139 --> 00:11:15,220
this architecture getting code execution

225
00:11:13,299 --> 00:11:17,980
on<font color="#CCCCCC"> the cellular processor doesn't</font><font color="#E5E5E5"> mean</font>

226
00:11:15,220 --> 00:11:20,410
you own the<font color="#CCCCCC"> entire phone you know the</font>

227
00:11:17,980 --> 00:11:22,989
whole device but still a<font color="#E5E5E5"> number of</font>

228
00:11:20,410 --> 00:11:26,319
attacks can<font color="#CCCCCC"> be performed</font><font color="#E5E5E5"> you know you</font>

229
00:11:22,989 --> 00:11:29,109
can redirect phone calls<font color="#E5E5E5"> redirect SMS or</font>

230
00:11:26,319 --> 00:11:31,929
modify<font color="#CCCCCC"> internet traffic</font><font color="#E5E5E5"> and I guess</font>

231
00:11:29,109 --> 00:11:34,720
modifying<font color="#E5E5E5"> Internet traffic can also mean</font>

232
00:11:31,929 --> 00:11:37,689
injecting exploits for browsers<font color="#E5E5E5"> or</font>

233
00:11:34,720 --> 00:11:39,579
something<font color="#E5E5E5"> and a step further you can</font>

234
00:11:37,689 --> 00:11:41,799
<font color="#E5E5E5">take it is you can attack</font><font color="#CCCCCC"> the</font>

235
00:11:39,579 --> 00:11:47,649
application<font color="#E5E5E5"> processor to those IPC</font>

236
00:11:41,799 --> 00:11:51,809
mechanisms so now let's talk about the

237
00:11:47,649 --> 00:11:54,249
<font color="#E5E5E5">Shannon baseband so this is Samsung's</font>

238
00:11:51,809 --> 00:11:58,269
implementation typically ships with

239
00:11:54,249 --> 00:12:00,549
phones featuring the Exynos SOC<font color="#E5E5E5"> and like</font>

240
00:11:58,269 --> 00:12:02,589
I said<font color="#CCCCCC"> it's most non</font><font color="#E5E5E5"> Galaxy phones or</font>

241
00:12:00,549 --> 00:12:06,939
most basically most<font color="#E5E5E5"> Samsung phones that</font>

242
00:12:02,589 --> 00:12:09,040
<font color="#CCCCCC">aren't there aren't us-based</font><font color="#E5E5E5"> and it's a</font>

243
00:12:06,939 --> 00:12:12,549
real-time<font color="#CCCCCC"> operating</font><font color="#E5E5E5"> system running on an</font>

244
00:12:09,040 --> 00:12:15,639
ARM Cortex<font color="#CCCCCC"> r7</font><font color="#E5E5E5"> at least in</font><font color="#CCCCCC"> recent phones</font>

245
00:12:12,549 --> 00:12:21,610
is<font color="#E5E5E5"> r7 I guess it used to be our</font><font color="#CCCCCC"> for a</font>

246
00:12:15,639 --> 00:12:24,160
while<font color="#E5E5E5"> a while</font><font color="#CCCCCC"> ago so what's interesting</font>

247
00:12:21,610 --> 00:12:28,239
I guess<font color="#CCCCCC"> before we can do the research</font><font color="#E5E5E5"> is</font>

248
00:12:24,160 --> 00:12:31,179
obtaining the code so luckily<font color="#CCCCCC"> for us</font>

249
00:12:28,239 --> 00:12:34,360
<font color="#E5E5E5">it's it's it's not</font><font color="#CCCCCC"> that hard</font>

250
00:12:31,179 --> 00:12:37,119
<font color="#CCCCCC">so the firmware on the in the Android</font>

251
00:12:34,360 --> 00:12:39,189
firmware packages images there's the

252
00:12:37,119 --> 00:12:41,769
modem binary but it's actually<font color="#E5E5E5"> encrypted</font>

253
00:12:39,189 --> 00:12:45,009
so and I<font color="#CCCCCC"> don't know</font><font color="#E5E5E5"> I have any easy way</font>

254
00:12:41,769 --> 00:12:48,279
<font color="#E5E5E5">to decrypt that but at least we can get</font>

255
00:12:45,009 --> 00:12:51,939
we can generate<font color="#CCCCCC"> RAM dumps from</font><font color="#E5E5E5"> the phone</font>

256
00:12:48,279 --> 00:12:55,059
<font color="#E5E5E5">directly in order</font><font color="#CCCCCC"> to get the code</font><font color="#E5E5E5"> that's</font>

257
00:12:51,939 --> 00:12:57,279
already decrypted<font color="#E5E5E5"> in memory so what it</font>

258
00:12:55,059 --> 00:13:00,459
looks<font color="#CCCCCC"> like is you</font><font color="#E5E5E5"> just use this this</font>

259
00:12:57,279 --> 00:13:05,139
this special code it works on<font color="#E5E5E5"> pretty</font>

260
00:13:00,459 --> 00:13:07,929
much all<font color="#E5E5E5"> Samsung devices and this is</font>

261
00:13:05,139 --> 00:13:14,529
what the menu looks like so first we

262
00:13:07,929 --> 00:13:19,360
want to<font color="#E5E5E5"> turn on okay so first we want to</font>

263
00:13:14,529 --> 00:13:24,430
turn on<font color="#CCCCCC"> RAM logging and then we can</font>

264
00:13:19,360 --> 00:13:27,700
enable<font color="#E5E5E5"> then we can enable debugging the</font>

265
00:13:24,430 --> 00:13:31,930
<font color="#CCCCCC">but levels to make it you know</font><font color="#E5E5E5"> spew more</font>

266
00:13:27,700 --> 00:13:34,930
information and then run CP<font color="#E5E5E5"> forced crash</font>

267
00:13:31,930 --> 00:13:39,130
<font color="#E5E5E5">dump basically this will cause</font><font color="#CCCCCC"> the modem</font>

268
00:13:34,930 --> 00:13:42,270
<font color="#CCCCCC">to crash and generate a random</font><font color="#E5E5E5"> and after</font>

269
00:13:39,130 --> 00:13:45,910
<font color="#E5E5E5">that we can call we can click on this</font>

270
00:13:42,270 --> 00:13:49,620
copy to SD card which actually makes the

271
00:13:45,910 --> 00:13:53,319
random available available<font color="#CCCCCC"> to us</font><font color="#E5E5E5"> and</font>

272
00:13:49,620 --> 00:13:55,089
yeah that's<font color="#CCCCCC"> pretty much</font><font color="#E5E5E5"> it so</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is a</font>

273
00:13:53,320 --> 00:13:57,940
slide with a lot of<font color="#E5E5E5"> text basically it</font>

274
00:13:55,089 --> 00:14:01,480
just<font color="#CCCCCC"> describes what I just said so we'll</font>

275
00:13:57,940 --> 00:14:04,480
just keep it and after the modem crashes

276
00:14:01,480 --> 00:14:06,310
this<font color="#E5E5E5"> is what you get so first you get</font>

277
00:14:04,480 --> 00:14:08,920
this<font color="#E5E5E5"> popup menu telling you you know</font>

278
00:14:06,310 --> 00:14:11,800
<font color="#E5E5E5">modern crash do we</font><font color="#CCCCCC"> Ram them and you</font>

279
00:14:08,920 --> 00:14:13,959
gotta wait<font color="#E5E5E5"> about 10</font><font color="#CCCCCC"> minutes</font><font color="#E5E5E5"> so basically</font>

280
00:14:11,800 --> 00:14:16,949
every time<font color="#CCCCCC"> you crash the modem you're</font>

281
00:14:13,959 --> 00:14:19,689
<font color="#E5E5E5">gonna have to wait so really you should</font>

282
00:14:16,950 --> 00:14:21,310
only try to make it<font color="#E5E5E5"> crash when you're</font>

283
00:14:19,690 --> 00:14:22,630
sure you<font color="#E5E5E5"> know</font><font color="#CCCCCC"> that you're gonna get</font>

284
00:14:21,310 --> 00:14:25,689
something<font color="#E5E5E5"> good out of it because it's</font>

285
00:14:22,630 --> 00:14:30,459
pretty annoying<font color="#CCCCCC"> to wait all that time</font>

286
00:14:25,690 --> 00:14:32,830
and once it actually<font color="#E5E5E5"> once the phone</font>

287
00:14:30,459 --> 00:14:35,770
turns off you get to this weird screen

288
00:14:32,830 --> 00:14:38,529
which is the<font color="#E5E5E5"> crash upload mode</font><font color="#CCCCCC"> I don't</font>

289
00:14:35,770 --> 00:14:41,730
really know what it does<font color="#CCCCCC"> I guess this is</font>

290
00:14:38,529 --> 00:14:44,290
<font color="#CCCCCC">probably some</font><font color="#E5E5E5"> they must have some</font>

291
00:14:41,730 --> 00:14:45,900
proprietary way of communicating with

292
00:14:44,290 --> 00:14:48,339
<font color="#CCCCCC">the phone when it's in</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> state but</font>

293
00:14:45,900 --> 00:14:49,750
when it once it reaches<font color="#E5E5E5"> this state all</font>

294
00:14:48,339 --> 00:14:52,140
you have to do is turn off<font color="#E5E5E5"> the</font><font color="#CCCCCC"> phone</font>

295
00:14:49,750 --> 00:14:57,550
again<font color="#CCCCCC"> and then put it back</font><font color="#E5E5E5"> to the normal</font>

296
00:14:52,140 --> 00:14:59,800
<font color="#E5E5E5">interface so</font><font color="#CCCCCC"> ok now that</font><font color="#E5E5E5"> we've</font><font color="#CCCCCC"> got the</font>

297
00:14:57,550 --> 00:15:02,079
RAM<font color="#E5E5E5"> dump we want to load it in</font><font color="#CCCCCC"> Ida so</font>

298
00:14:59,800 --> 00:15:04,449
there is the CP boot<font color="#E5E5E5"> daemon which is</font>

299
00:15:02,080 --> 00:15:06,690
part of the<font color="#E5E5E5"> file system basically it</font>

300
00:15:04,450 --> 00:15:09,400
handles powering on the modem<font color="#CCCCCC"> and</font>

301
00:15:06,690 --> 00:15:12,310
processing<font color="#CCCCCC"> RAM dumps amongst other</font>

302
00:15:09,400 --> 00:15:15,670
<font color="#CCCCCC">things</font><font color="#E5E5E5"> and by reversing it we can see</font>

303
00:15:12,310 --> 00:15:18,790
how it processes<font color="#E5E5E5"> the randoms it receives</font>

304
00:15:15,670 --> 00:15:21,370
from<font color="#CCCCCC"> the modem and this way we can know</font>

305
00:15:18,790 --> 00:15:24,640
how to<font color="#E5E5E5"> translate</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> huge</font><font color="#CCCCCC"> Reb the file</font>

306
00:15:21,370 --> 00:15:27,430
we get to actual<font color="#E5E5E5"> virtual addresses in</font>

307
00:15:24,640 --> 00:15:31,240
either because otherwise the disassembly

308
00:15:27,430 --> 00:15:33,219
won't be right<font color="#E5E5E5"> and this is described in</font>

309
00:15:31,240 --> 00:15:35,910
the talk I mentioned earlier the<font color="#CCCCCC"> braking</font>

310
00:15:33,220 --> 00:15:38,889
band<font color="#E5E5E5"> talk and</font>

311
00:15:35,910 --> 00:15:40,509
they also provide a script to load in

312
00:15:38,889 --> 00:15:43,689
either<font color="#E5E5E5"> I mean they provide one for</font>

313
00:15:40,509 --> 00:15:49,360
<font color="#CCCCCC">galaxy s6 but it's easily changeable to</font>

314
00:15:43,689 --> 00:15:51,849
work for the SAT so now now<font color="#E5E5E5"> that we have</font>

315
00:15:49,360 --> 00:15:54,160
the code loaded in either<font color="#CCCCCC"> and we know</font>

316
00:15:51,850 --> 00:15:56,529
this is a real-time<font color="#CCCCCC"> operating system we</font>

317
00:15:54,160 --> 00:16:00,100
basically want to<font color="#CCCCCC"> identify the</font><font color="#E5E5E5"> different</font>

318
00:15:56,529 --> 00:16:03,790
tasks that<font color="#CCCCCC"> the operating system runs</font><font color="#E5E5E5"> and</font>

319
00:16:00,100 --> 00:16:06,489
we can start by reversing from the reset

320
00:16:03,790 --> 00:16:09,429
handler<font color="#CCCCCC"> which is basically the very</font>

321
00:16:06,489 --> 00:16:12,939
first part<font color="#E5E5E5"> of the code and after a while</font>

322
00:16:09,429 --> 00:16:15,360
we'll end up<font color="#E5E5E5"> seeing that there is a</font>

323
00:16:12,939 --> 00:16:20,110
linked<font color="#CCCCCC"> list that</font><font color="#E5E5E5"> contains all the tasks</font>

324
00:16:15,360 --> 00:16:22,360
all the tasks that the<font color="#E5E5E5"> OS runs so you</font>

325
00:16:20,110 --> 00:16:24,360
know it describes<font color="#E5E5E5"> then it's got a name</font>

326
00:16:22,360 --> 00:16:27,759
<font color="#CCCCCC">for the task it's got the</font><font color="#E5E5E5"> entry point</font>

327
00:16:24,360 --> 00:16:30,879
the stack frames and stuff<font color="#CCCCCC"> like that and</font>

328
00:16:27,759 --> 00:16:33,819
by traversing<font color="#E5E5E5"> this list</font><font color="#CCCCCC"> we can just list</font>

329
00:16:30,879 --> 00:16:36,129
all<font color="#E5E5E5"> the tasks and the names of the</font>

330
00:16:33,819 --> 00:16:39,699
different<font color="#E5E5E5"> tasks are pretty useful in</font>

331
00:16:36,129 --> 00:16:42,670
reversing<font color="#CCCCCC"> and these are</font><font color="#E5E5E5"> examples of what</font>

332
00:16:39,699 --> 00:16:44,498
they look like<font color="#E5E5E5"> so I don't know if you</font>

333
00:16:42,670 --> 00:16:47,139
<font color="#CCCCCC">remember that diagram</font><font color="#E5E5E5"> I showed</font><font color="#CCCCCC"> earlier</font>

334
00:16:44,499 --> 00:16:49,689
but there's mm which<font color="#CCCCCC"> is mobility</font>

335
00:16:47,139 --> 00:16:52,569
<font color="#E5E5E5">management which is part of the third</font>

336
00:16:49,689 --> 00:16:54,969
layer of<font color="#E5E5E5"> GSM and there's</font><font color="#CCCCCC"> other things</font>

337
00:16:52,569 --> 00:16:57,339
<font color="#E5E5E5">here that are interesting like</font><font color="#CCCCCC"> CC is</font>

338
00:16:54,970 --> 00:17:00,129
also part of the third layer<font color="#CCCCCC"> of GSM and</font>

339
00:16:57,339 --> 00:17:04,600
so is an<font color="#CCCCCC"> SM is part of</font><font color="#E5E5E5"> the third layer</font>

340
00:17:00,129 --> 00:17:06,339
of GPRS<font color="#E5E5E5"> so just the task names allow us</font>

341
00:17:04,599 --> 00:17:10,510
to know<font color="#CCCCCC"> that</font><font color="#E5E5E5"> oh we don't have to reverse</font>

342
00:17:06,339 --> 00:17:14,799
the whole 30 megabytes of code<font color="#E5E5E5"> and start</font>

343
00:17:10,510 --> 00:17:16,658
looking<font color="#E5E5E5"> in those areas so so what are</font>

344
00:17:14,799 --> 00:17:18,908
these tasks what do they look like<font color="#CCCCCC"> so</font>

345
00:17:16,659 --> 00:17:22,899
different<font color="#CCCCCC"> tasks are used for different</font>

346
00:17:18,909 --> 00:17:26,709
<font color="#CCCCCC">components different</font><font color="#E5E5E5"> layers and protocol</font>

347
00:17:22,898 --> 00:17:28,979
<font color="#E5E5E5">stacks and</font><font color="#CCCCCC"> the tasks communicate with</font>

348
00:17:26,709 --> 00:17:32,639
each<font color="#E5E5E5"> other using a mailbox system</font>

349
00:17:28,980 --> 00:17:34,809
basically all the tasks are loops and

350
00:17:32,639 --> 00:17:36,490
they're checking<font color="#E5E5E5"> their mail in their</font>

351
00:17:34,809 --> 00:17:38,110
mailbox all the time to make sure<font color="#CCCCCC"> that</font>

352
00:17:36,490 --> 00:17:41,260
<font color="#CCCCCC">you know to check</font><font color="#E5E5E5"> if there's a message</font>

353
00:17:38,110 --> 00:17:43,120
<font color="#E5E5E5">and if they pop one message out</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

354
00:17:41,260 --> 00:17:45,460
mailbox<font color="#E5E5E5"> they'll process it and sometimes</font>

355
00:17:43,120 --> 00:17:47,949
<font color="#E5E5E5">they'll end up sending a message to</font>

356
00:17:45,460 --> 00:17:52,450
<font color="#CCCCCC">another</font><font color="#E5E5E5"> task through that tasks mailbox</font>

357
00:17:47,950 --> 00:17:56,220
so<font color="#E5E5E5"> I guess this</font><font color="#CCCCCC"> is pretty much this is a</font>

358
00:17:52,450 --> 00:17:58,750
very very simple<font color="#E5E5E5"> design so maybe is</font>

359
00:17:56,220 --> 00:18:01,960
standard for all<font color="#CCCCCC"> our tea oasis</font><font color="#E5E5E5"> I guess</font>

360
00:17:58,750 --> 00:18:04,870
<font color="#E5E5E5">actually it is</font><font color="#CCCCCC"> because I remember</font>

361
00:18:01,960 --> 00:18:11,140
looking<font color="#E5E5E5"> at Huawei and they're using a</font>

362
00:18:04,870 --> 00:18:13,570
similar design so basically you pick<font color="#E5E5E5"> a</font>

363
00:18:11,140 --> 00:18:15,190
task and<font color="#CCCCCC"> you</font><font color="#E5E5E5"> start reversing the code is</font>

364
00:18:13,570 --> 00:18:19,810
<font color="#E5E5E5">pretty generous and it's got a lot of</font>

365
00:18:15,190 --> 00:18:21,730
<font color="#E5E5E5">strings so so now we could get to</font>

366
00:18:19,810 --> 00:18:25,840
<font color="#E5E5E5">something more interesting</font><font color="#CCCCCC"> is hunting</font>

367
00:18:21,730 --> 00:18:28,600
<font color="#CCCCCC">for bugs the first challenge is setting</font>

368
00:18:25,840 --> 00:18:31,030
up<font color="#E5E5E5"> the environment</font><font color="#CCCCCC"> because how do</font><font color="#E5E5E5"> we set</font>

369
00:18:28,600 --> 00:18:33,189
<font color="#CCCCCC">up our own cellular network</font><font color="#E5E5E5"> and start</font>

370
00:18:31,030 --> 00:18:35,830
doing actual research<font color="#E5E5E5"> because if we</font>

371
00:18:33,190 --> 00:18:38,140
can't do that<font color="#E5E5E5"> it's pointless and luckily</font>

372
00:18:35,830 --> 00:18:40,060
<font color="#CCCCCC">for us</font><font color="#E5E5E5"> it's not as expensive as it used</font>

373
00:18:38,140 --> 00:18:43,420
to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> because I think</font><font color="#E5E5E5"> in the past</font>

374
00:18:40,060 --> 00:18:46,810
<font color="#E5E5E5">basically individual could hardly get</font>

375
00:18:43,420 --> 00:18:50,470
their hands on working cellular network

376
00:18:46,810 --> 00:18:54,100
but now we can achieve the same<font color="#E5E5E5"> goal by</font>

377
00:18:50,470 --> 00:18:57,430
using software-defined radios or<font color="#E5E5E5"> SDR</font><font color="#CCCCCC"> so</font>

378
00:18:54,100 --> 00:18:59,560
basically then the<font color="#E5E5E5"> network stack is</font>

379
00:18:57,430 --> 00:19:02,040
implemented in software running on our

380
00:18:59,560 --> 00:19:05,830
computer or<font color="#E5E5E5"> another embedded device and</font>

381
00:19:02,040 --> 00:19:08,080
<font color="#E5E5E5">the SDR which is the transceiver itself</font>

382
00:19:05,830 --> 00:19:10,750
<font color="#E5E5E5">you know just some</font><font color="#CCCCCC"> general-purpose</font>

383
00:19:08,080 --> 00:19:22,230
transceiver<font color="#E5E5E5"> that supports a number of</font>

384
00:19:10,750 --> 00:19:25,780
<font color="#CCCCCC">different frequencies so here are a few</font>

385
00:19:22,230 --> 00:19:27,940
SDR that you guys can<font color="#E5E5E5"> try to get your</font>

386
00:19:25,780 --> 00:19:30,700
hands on I mean they look kind of

387
00:19:27,940 --> 00:19:32,710
expensive<font color="#CCCCCC"> but I think</font><font color="#E5E5E5"> they're not</font>

388
00:19:30,700 --> 00:19:37,750
<font color="#E5E5E5">compared to</font><font color="#CCCCCC"> what the prices used to be</font>

389
00:19:32,710 --> 00:19:40,240
so I have a blade<font color="#E5E5E5"> RF and it costs a</font>

390
00:19:37,750 --> 00:19:43,780
pretty penny<font color="#E5E5E5"> but it's pretty good pretty</font>

391
00:19:40,240 --> 00:19:46,840
stable and pretty easy<font color="#CCCCCC"> to use and other</font>

392
00:19:43,780 --> 00:19:50,080
good ones<font color="#E5E5E5"> are like the</font><font color="#CCCCCC"> u.s. RP b200 it</font>

393
00:19:46,840 --> 00:19:53,439
seems to be<font color="#CCCCCC"> us RP devices seem to be the</font>

394
00:19:50,080 --> 00:19:54,909
more powerful ones and by powerful<font color="#CCCCCC"> I</font>

395
00:19:53,440 --> 00:19:58,060
don't even know what<font color="#CCCCCC"> that means but</font>

396
00:19:54,910 --> 00:20:00,130
basically is the most popular ones<font color="#E5E5E5"> and</font>

397
00:19:58,060 --> 00:20:01,810
the most<font color="#E5E5E5"> reliable ones people</font><font color="#CCCCCC"> like to</font>

398
00:20:00,130 --> 00:20:05,100
use<font color="#CCCCCC"> u.s. RP</font>

399
00:20:01,810 --> 00:20:08,440
I'm SDR is<font color="#E5E5E5"> pretty new they had a crowd</font>

400
00:20:05,100 --> 00:20:11,709
crowdsourcing campaign last<font color="#E5E5E5"> year and I</font>

401
00:20:08,440 --> 00:20:14,950
contributed<font color="#CCCCCC"> to that and I still</font><font color="#E5E5E5"> haven't</font>

402
00:20:11,710 --> 00:20:20,410
been<font color="#E5E5E5"> able to make it run so I don't know</font>

403
00:20:14,950 --> 00:20:23,290
and um TRX<font color="#E5E5E5"> is I have no idea um TRX</font><font color="#CCCCCC"> used</font>

404
00:20:20,410 --> 00:20:25,330
to be GS dedicated for<font color="#CCCCCC"> GSM at least</font>

405
00:20:23,290 --> 00:20:30,820
that's what<font color="#CCCCCC"> they</font><font color="#E5E5E5"> claim but it's just too</font>

406
00:20:25,330 --> 00:20:33,010
expensive so I guess once you<font color="#E5E5E5"> have the</font>

407
00:20:30,820 --> 00:20:35,050
SDR you need the<font color="#E5E5E5"> actual stack that</font>

408
00:20:33,010 --> 00:20:37,420
<font color="#E5E5E5">you're gonna run on it and there's a</font>

409
00:20:35,050 --> 00:20:40,480
bunch of there's a bunch<font color="#E5E5E5"> of them out</font>

410
00:20:37,420 --> 00:20:43,270
there yet BTS is the one I like the<font color="#CCCCCC"> most</font>

411
00:20:40,480 --> 00:20:46,210
<font color="#E5E5E5">because the code is clean and it's easy</font>

412
00:20:43,270 --> 00:20:49,629
to<font color="#E5E5E5"> modify it has good support for the</font>

413
00:20:46,210 --> 00:20:52,330
blade RF and but it only<font color="#CCCCCC"> supports GSM</font>

414
00:20:49,630 --> 00:20:55,000
and GPRS<font color="#E5E5E5"> and it's easy to compile that</font>

415
00:20:52,330 --> 00:20:58,689
<font color="#E5E5E5">run actually is one of the few</font><font color="#CCCCCC"> stacks</font>

416
00:20:55,000 --> 00:20:59,200
<font color="#E5E5E5">that actually compiles so you know it's</font>

417
00:20:58,690 --> 00:21:02,710
pretty good

418
00:20:59,200 --> 00:21:06,040
the other one is open BTS it also

419
00:21:02,710 --> 00:21:09,910
compiles and the code is<font color="#CCCCCC"> clean and but</font>

420
00:21:06,040 --> 00:21:14,139
it only supports<font color="#CCCCCC"> USRP and um TRX</font><font color="#E5E5E5"> at</font>

421
00:21:09,910 --> 00:21:16,480
least that's<font color="#E5E5E5"> the easier ones you're</font>

422
00:21:14,140 --> 00:21:18,700
gonna be able<font color="#CCCCCC"> to run them on but it it</font>

423
00:21:16,480 --> 00:21:21,370
<font color="#E5E5E5">goes all the way to 3G so if you want to</font>

424
00:21:18,700 --> 00:21:26,620
do some<font color="#E5E5E5"> 3G research it's a good idea</font><font color="#CCCCCC"> to</font>

425
00:21:21,370 --> 00:21:29,909
use the open<font color="#E5E5E5"> BTS and another thing is</font>

426
00:21:26,620 --> 00:21:32,889
open<font color="#E5E5E5"> beat the GSM part of the open BTS</font>

427
00:21:29,910 --> 00:21:35,380
is<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> kind of cheating</font><font color="#CCCCCC"> you won't</font>

428
00:21:32,890 --> 00:21:38,110
see the full you won't see the full

429
00:21:35,380 --> 00:21:40,060
implementation in there because they're

430
00:21:38,110 --> 00:21:43,479
basically<font color="#E5E5E5"> just turning the phone into a</font>

431
00:21:40,060 --> 00:21:45,550
<font color="#CCCCCC">internet phone so they're</font><font color="#E5E5E5"> skipping over</font>

432
00:21:43,480 --> 00:21:47,680
a lot<font color="#E5E5E5"> of it so if you really want to do</font>

433
00:21:45,550 --> 00:21:53,560
gsm research is better to<font color="#CCCCCC"> use</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> eight</font>

434
00:21:47,680 --> 00:21:56,740
BTS these are a few other ones<font color="#E5E5E5"> open BSC</font>

435
00:21:53,560 --> 00:22:00,310
<font color="#E5E5E5">that one I was compiling it was very</font>

436
00:21:56,740 --> 00:22:03,580
hard<font color="#CCCCCC"> and but it supports also a good</font>

437
00:22:00,310 --> 00:22:07,240
number<font color="#E5E5E5"> of those</font><font color="#CCCCCC"> sdrs the code is</font><font color="#E5E5E5"> very</font>

438
00:22:03,580 --> 00:22:11,439
clean<font color="#E5E5E5"> and it supports GSM and GPRS so</font>

439
00:22:07,240 --> 00:22:15,460
open air interface and open LTE<font color="#E5E5E5"> our 3G</font><font color="#CCCCCC"> I</font>

440
00:22:11,440 --> 00:22:18,180
mean are both 4G stacks<font color="#E5E5E5"> and to be honest</font>

441
00:22:15,460 --> 00:22:20,440
was never<font color="#E5E5E5"> able to compile them so I</font>

442
00:22:18,180 --> 00:22:26,560
don't know I<font color="#E5E5E5"> don't</font><font color="#CCCCCC"> know how good they</font>

443
00:22:20,440 --> 00:22:30,040
<font color="#CCCCCC">are</font><font color="#E5E5E5"> so some other things</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you want</font>

444
00:22:26,560 --> 00:22:31,659
is SIM cards that you can program or

445
00:22:30,040 --> 00:22:35,139
some that<font color="#E5E5E5"> are already provisioned</font>

446
00:22:31,660 --> 00:22:38,470
<font color="#E5E5E5">because for 3G and 4G</font><font color="#CCCCCC"> you can't just</font>

447
00:22:35,140 --> 00:22:40,510
connect<font color="#CCCCCC"> to any not network</font><font color="#E5E5E5"> because there</font>

448
00:22:38,470 --> 00:22:42,460
are secrets and there's authentication

449
00:22:40,510 --> 00:22:45,160
basically<font color="#E5E5E5"> between the phone and</font><font color="#CCCCCC"> the</font>

450
00:22:42,460 --> 00:22:47,590
<font color="#CCCCCC">network so if you want to</font><font color="#E5E5E5"> do 3G or 4G</font>

451
00:22:45,160 --> 00:22:51,640
research I would<font color="#E5E5E5"> advise</font><font color="#CCCCCC"> you to get some</font>

452
00:22:47,590 --> 00:22:55,209
<font color="#CCCCCC">SIM cards also</font><font color="#E5E5E5"> fired a cage or I have</font>

453
00:22:51,640 --> 00:22:58,390
enclosed<font color="#CCCCCC"> because is</font><font color="#E5E5E5"> illegal to run</font><font color="#CCCCCC"> a</font>

454
00:22:55,210 --> 00:23:00,810
cellular network<font color="#CCCCCC"> in most countries</font><font color="#E5E5E5"> so</font>

455
00:22:58,390 --> 00:23:00,810
don't do it

456
00:23:02,220 --> 00:23:07,270
also another note about<font color="#CCCCCC"> SIM cards is</font>

457
00:23:05,290 --> 00:23:11,080
that<font color="#E5E5E5"> they'll make</font><font color="#CCCCCC"> it easy</font><font color="#E5E5E5"> they'll make</font>

458
00:23:07,270 --> 00:23:13,090
it<font color="#E5E5E5"> easier for you if you have a</font><font color="#CCCCCC"> forum</font>

459
00:23:11,080 --> 00:23:14,590
for<font color="#E5E5E5"> GSM at least if you</font><font color="#CCCCCC"> have a</font><font color="#E5E5E5"> SIM</font><font color="#CCCCCC"> card</font>

460
00:23:13,090 --> 00:23:16,389
that<font color="#CCCCCC"> you've programmed</font><font color="#E5E5E5"> to match your</font>

461
00:23:14,590 --> 00:23:22,750
custom<font color="#CCCCCC"> Network</font><font color="#E5E5E5"> it's going to be easier</font>

462
00:23:16,390 --> 00:23:26,250
for<font color="#E5E5E5"> that phone to connect so now let's</font>

463
00:23:22,750 --> 00:23:29,200
talk about digging<font color="#E5E5E5"> into the code so</font>

464
00:23:26,250 --> 00:23:31,600
basically back to<font color="#CCCCCC"> picking a task</font><font color="#E5E5E5"> and get</font>

465
00:23:29,200 --> 00:23:34,000
it having a closer<font color="#E5E5E5"> look at it an</font>

466
00:23:31,600 --> 00:23:36,820
<font color="#E5E5E5">interesting approach I guess</font><font color="#CCCCCC"> my approach</font>

467
00:23:34,000 --> 00:23:38,950
<font color="#E5E5E5">when I was looking at this was the</font>

468
00:23:36,820 --> 00:23:41,980
<font color="#CCCCCC">following basically I know that layer 3</font>

469
00:23:38,950 --> 00:23:43,960
messages<font color="#E5E5E5"> are comprised of information</font>

470
00:23:41,980 --> 00:23:47,950
elements<font color="#E5E5E5"> information</font><font color="#CCCCCC"> elements are</font>

471
00:23:43,960 --> 00:23:53,830
basically values<font color="#CCCCCC"> lengths value or type</font>

472
00:23:47,950 --> 00:23:56,140
<font color="#E5E5E5">length value so basically most of for</font>

473
00:23:53,830 --> 00:23:58,449
<font color="#CCCCCC">example</font><font color="#E5E5E5"> the length value and</font><font color="#CCCCCC"> TLV map and</font>

474
00:23:56,140 --> 00:24:01,240
value messages will be<font color="#E5E5E5"> will contain the</font>

475
00:23:58,450 --> 00:24:03,010
length of the message inside and that

476
00:24:01,240 --> 00:24:05,940
makes it interesting<font color="#E5E5E5"> because if you got</font>

477
00:24:03,010 --> 00:24:08,860
<font color="#CCCCCC">a parser that's</font><font color="#E5E5E5"> relying on the length</font>

478
00:24:05,940 --> 00:24:11,560
you know we<font color="#CCCCCC"> got both of</font><font color="#E5E5E5"> those all over</font>

479
00:24:08,860 --> 00:24:13,209
<font color="#CCCCCC">the place what are different</font><font color="#E5E5E5"> messages</font>

480
00:24:11,560 --> 00:24:15,190
<font color="#E5E5E5">also you want to</font><font color="#CCCCCC"> figure out</font><font color="#E5E5E5"> what are the</font>

481
00:24:13,210 --> 00:24:17,380
different<font color="#CCCCCC"> messages that can</font><font color="#E5E5E5"> be sent to</font>

482
00:24:15,190 --> 00:24:19,180
<font color="#CCCCCC">different</font><font color="#E5E5E5"> components and then you</font>

483
00:24:17,380 --> 00:24:21,310
cross-reference<font color="#E5E5E5"> those technical</font>

484
00:24:19,180 --> 00:24:25,690
standards<font color="#E5E5E5"> you remember the ones written</font>

485
00:24:21,310 --> 00:24:27,429
<font color="#CCCCCC">by 3gpp and</font><font color="#E5E5E5"> you know that way you know</font>

486
00:24:25,690 --> 00:24:28,470
what are<font color="#E5E5E5"> different</font><font color="#CCCCCC"> messages and then you</font>

487
00:24:27,430 --> 00:24:31,620
read<font color="#CCCCCC"> the description</font>

488
00:24:28,470 --> 00:24:35,340
of those<font color="#E5E5E5"> messages</font><font color="#CCCCCC"> and try to figure out</font>

489
00:24:31,620 --> 00:24:38,070
which ones have tlvs or<font color="#CCCCCC"> LVS</font><font color="#E5E5E5"> and then</font>

490
00:24:35,340 --> 00:24:39,600
then<font color="#E5E5E5"> you go back to the code</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> try to</font>

491
00:24:38,070 --> 00:24:42,500
identify the parts of the<font color="#E5E5E5"> code</font>

492
00:24:39,600 --> 00:24:45,780
processing those messages<font color="#CCCCCC"> I've</font><font color="#E5E5E5"> been a</font>

493
00:24:42,500 --> 00:24:49,799
<font color="#E5E5E5">number of books you can</font><font color="#CCCCCC"> find this way to</font>

494
00:24:45,780 --> 00:24:53,639
be honest and I guess let's make it

495
00:24:49,799 --> 00:24:56,460
<font color="#E5E5E5">clear</font><font color="#CCCCCC"> with an example so</font><font color="#E5E5E5"> we saw that</font>

496
00:24:53,640 --> 00:24:58,260
there was<font color="#CCCCCC"> a CC CC task that we</font><font color="#E5E5E5"> found</font>

497
00:24:56,460 --> 00:25:01,200
when we were<font color="#CCCCCC"> iterating over the</font><font color="#E5E5E5"> linked</font>

498
00:24:58,260 --> 00:25:03,000
<font color="#E5E5E5">list</font><font color="#CCCCCC"> of tasks called</font><font color="#E5E5E5"> control and it</font>

499
00:25:01,200 --> 00:25:06,140
<font color="#E5E5E5">probably stands for call control</font><font color="#CCCCCC"> this</font>

500
00:25:03,000 --> 00:25:08,580
would assume and call<font color="#E5E5E5"> control is part of</font>

501
00:25:06,140 --> 00:25:11,429
connection<font color="#E5E5E5"> management which is part of</font>

502
00:25:08,580 --> 00:25:13,260
the third<font color="#E5E5E5"> layer</font><font color="#CCCCCC"> of GSM and now the</font>

503
00:25:11,429 --> 00:25:16,919
<font color="#E5E5E5">question is what are the different</font><font color="#CCCCCC"> CC</font>

504
00:25:13,260 --> 00:25:19,500
messages that we can send so in the

505
00:25:16,919 --> 00:25:21,350
technical standards we find this in<font color="#CCCCCC"> the</font>

506
00:25:19,500 --> 00:25:23,850
technical standards we find this table

507
00:25:21,350 --> 00:25:27,870
<font color="#E5E5E5">which basically lists all the different</font>

508
00:25:23,850 --> 00:25:30,030
messages<font color="#CCCCCC"> you can send</font><font color="#E5E5E5"> in the</font><font color="#CCCCCC"> call</font>

509
00:25:27,870 --> 00:25:33,899
control<font color="#E5E5E5"> in the call control component</font>

510
00:25:30,030 --> 00:25:36,870
and my approach<font color="#E5E5E5"> was just to go</font><font color="#CCCCCC"> through</font>

511
00:25:33,900 --> 00:25:39,059
each<font color="#CCCCCC"> one of them and you know identify</font>

512
00:25:36,870 --> 00:25:43,219
the contents but for example<font color="#CCCCCC"> let's look</font>

513
00:25:39,059 --> 00:25:47,340
<font color="#E5E5E5">at the progress one the progress message</font>

514
00:25:43,220 --> 00:25:49,320
<font color="#E5E5E5">the progress message is is is is</font><font color="#CCCCCC"> the</font>

515
00:25:47,340 --> 00:25:55,490
<font color="#CCCCCC">following and we can see you there's</font><font color="#E5E5E5"> LV</font>

516
00:25:49,320 --> 00:25:57,990
<font color="#E5E5E5">and</font><font color="#CCCCCC"> TLV and this is actually the</font><font color="#E5E5E5"> the</font>

517
00:25:55,490 --> 00:26:00,419
paper I<font color="#E5E5E5"> was talking about the talk I was</font>

518
00:25:57,990 --> 00:26:02,760
talking about<font color="#CCCCCC"> breaking</font><font color="#E5E5E5"> band</font><font color="#CCCCCC"> they</font>

519
00:26:00,419 --> 00:26:05,250
<font color="#E5E5E5">actually found a bug in</font><font color="#CCCCCC"> the parsing</font><font color="#E5E5E5"> of</font>

520
00:26:02,760 --> 00:26:07,919
this message which was in the progress

521
00:26:05,250 --> 00:26:10,280
<font color="#E5E5E5">indicator fields and that's the book</font>

522
00:26:07,919 --> 00:26:15,600
they<font color="#CCCCCC"> talked about</font><font color="#E5E5E5"> in their presentation</font>

523
00:26:10,280 --> 00:26:18,000
<font color="#CCCCCC">and</font><font color="#E5E5E5"> really using this approach you can</font>

524
00:26:15,600 --> 00:26:20,850
find a lot of<font color="#E5E5E5"> bugs so if you want to</font>

525
00:26:18,000 --> 00:26:24,299
find<font color="#E5E5E5"> bugs today you should try this</font><font color="#CCCCCC"> so</font>

526
00:26:20,850 --> 00:26:27,870
the problem is<font color="#E5E5E5"> that I wanted to take</font>

527
00:26:24,299 --> 00:26:30,240
<font color="#CCCCCC">part in phone to Owen and I felt finding</font>

528
00:26:27,870 --> 00:26:33,479
bugs like this<font color="#CCCCCC"> it was just too</font><font color="#E5E5E5"> trivial</font>

529
00:26:30,240 --> 00:26:36,539
and I assumed<font color="#E5E5E5"> all the other teams would</font>

530
00:26:33,480 --> 00:26:41,770
find these bugs so I wanted<font color="#E5E5E5"> to find</font>

531
00:26:36,539 --> 00:26:44,740
something I guess less trivial so

532
00:26:41,770 --> 00:26:47,740
<font color="#E5E5E5">now I'll describe the mobile phones on</font>

533
00:26:44,740 --> 00:26:52,330
dog that I use so I decided<font color="#E5E5E5"> to look at</font>

534
00:26:47,740 --> 00:26:55,539
GPRS<font color="#E5E5E5"> it was any particular reason but I</font>

535
00:26:52,330 --> 00:26:58,000
just felt it it sounded complicated so I

536
00:26:55,539 --> 00:27:00,940
was like probably the<font color="#E5E5E5"> parcels will be</font>

537
00:26:58,000 --> 00:27:04,149
pretty<font color="#E5E5E5"> bad so I started by reading the</font>

538
00:27:00,940 --> 00:27:07,990
technical standards and I ended<font color="#E5E5E5"> up</font>

539
00:27:04,149 --> 00:27:10,750
looking at GPRS session management<font color="#E5E5E5"> so</font>

540
00:27:07,990 --> 00:27:13,840
this little this little graph here<font color="#E5E5E5"> is</font>

541
00:27:10,750 --> 00:27:16,029
actually<font color="#E5E5E5"> part of the</font><font color="#CCCCCC"> earlier one and it</font>

542
00:27:13,840 --> 00:27:18,549
shows the layer<font color="#CCCCCC"> three of</font><font color="#E5E5E5"> GPRS and</font>

543
00:27:16,029 --> 00:27:23,649
session<font color="#E5E5E5"> management is at the very top</font><font color="#CCCCCC"> it</font>

544
00:27:18,549 --> 00:27:25,480
<font color="#CCCCCC">baked basically</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> there for since I</font>

545
00:27:23,649 --> 00:27:28,080
said<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> packets which is therefore you</font>

546
00:27:25,480 --> 00:27:30,760
know<font color="#E5E5E5"> establishing connections and then</font>

547
00:27:28,080 --> 00:27:37,689
maintain maintaining<font color="#E5E5E5"> connections is</font><font color="#CCCCCC"> that</font>

548
00:27:30,760 --> 00:27:41,470
kind of stuff<font color="#CCCCCC"> so one of the</font><font color="#E5E5E5"> messages you</font>

549
00:27:37,690 --> 00:27:45,630
can send<font color="#E5E5E5"> in session management is the</font>

550
00:27:41,470 --> 00:27:48,880
activate PDP context<font color="#CCCCCC"> except message and</font>

551
00:27:45,630 --> 00:27:51,130
when<font color="#E5E5E5"> I saw this table I was like oh man</font>

552
00:27:48,880 --> 00:27:54,820
<font color="#CCCCCC">this looks</font><font color="#E5E5E5"> good because there's a lot of</font>

553
00:27:51,130 --> 00:28:02,529
<font color="#E5E5E5">LVS</font><font color="#CCCCCC"> tlvs and stuff like that and I don't</font>

554
00:27:54,820 --> 00:28:05,139
<font color="#E5E5E5">know it</font><font color="#CCCCCC"> just looks good and</font><font color="#E5E5E5"> then so I</font>

555
00:28:02,529 --> 00:28:07,059
decided<font color="#E5E5E5"> to look at the SM task which is</font>

556
00:28:05,140 --> 00:28:09,580
<font color="#CCCCCC">also one of the</font><font color="#E5E5E5"> tasks in the list a</font>

557
00:28:07,059 --> 00:28:12,970
linked<font color="#E5E5E5"> list and I assumed it was for</font>

558
00:28:09,580 --> 00:28:15,189
session management<font color="#E5E5E5"> luckily it was and we</font>

559
00:28:12,970 --> 00:28:18,850
find the different handlers by reversing

560
00:28:15,190 --> 00:28:21,399
that and I guess we find one<font color="#CCCCCC"> of the</font>

561
00:28:18,850 --> 00:28:23,649
handler for<font color="#CCCCCC"> that</font><font color="#E5E5E5"> message type and one</font>

562
00:28:21,399 --> 00:28:25,600
part of<font color="#E5E5E5"> that message seems to be</font>

563
00:28:23,649 --> 00:28:29,350
interesting is the protocol

564
00:28:25,600 --> 00:28:33,100
configuration options<font color="#E5E5E5"> so basically that</font>

565
00:28:29,350 --> 00:28:35,289
part is there for so the protocol

566
00:28:33,100 --> 00:28:38,260
configuration options are<font color="#E5E5E5"> basically</font>

567
00:28:35,289 --> 00:28:41,230
<font color="#CCCCCC">Internet Protocol related so you can</font>

568
00:28:38,260 --> 00:28:45,520
send<font color="#E5E5E5"> information about the network DNS</font>

569
00:28:41,230 --> 00:28:48,299
and etc<font color="#E5E5E5"> routers in router</font>

570
00:28:45,520 --> 00:28:52,779
I mean gateway address and those<font color="#E5E5E5"> things</font>

571
00:28:48,299 --> 00:28:54,429
so I don't<font color="#CCCCCC"> know if you guys can see</font><font color="#E5E5E5"> this</font>

572
00:28:52,779 --> 00:29:00,440
<font color="#CCCCCC">is it too small</font>

573
00:28:54,429 --> 00:29:03,400
maybe yeah I can see it either<font color="#E5E5E5"> but but</font>

574
00:29:00,440 --> 00:29:05,960
but<font color="#CCCCCC"> basically this is</font><font color="#E5E5E5"> the the code that</font>

575
00:29:03,400 --> 00:29:09,770
parses that<font color="#E5E5E5"> protocol configuration</font>

576
00:29:05,960 --> 00:29:12,169
options field<font color="#E5E5E5"> and I mean I don't expect</font>

577
00:29:09,770 --> 00:29:15,770
<font color="#CCCCCC">you to read all of</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> it it looks</font>

578
00:29:12,169 --> 00:29:17,809
complicated right<font color="#CCCCCC"> and</font><font color="#E5E5E5"> the little red box</font>

579
00:29:15,770 --> 00:29:21,500
there<font color="#E5E5E5"> if you can see it is a</font><font color="#CCCCCC"> four loop</font>

580
00:29:17,809 --> 00:29:24,950
<font color="#E5E5E5">that basically relies on some fields of</font>

581
00:29:21,500 --> 00:29:28,250
<font color="#E5E5E5">our data and just copies to</font><font color="#CCCCCC"> the stack so</font>

582
00:29:24,950 --> 00:29:29,870
<font color="#CCCCCC">I don't know and to be honest when I was</font>

583
00:29:28,250 --> 00:29:32,179
looking<font color="#CCCCCC"> at this I didn't even know what</font>

584
00:29:29,870 --> 00:29:34,189
this field was but it looks<font color="#E5E5E5"> like CTF</font>

585
00:29:32,179 --> 00:29:37,070
<font color="#E5E5E5">challenged where you know craft a packet</font>

586
00:29:34,190 --> 00:29:42,490
and get a buffer overflow<font color="#CCCCCC"> and it was a</font>

587
00:29:37,070 --> 00:29:48,439
stack buffer overflow so yeah<font color="#E5E5E5"> so</font>

588
00:29:42,490 --> 00:29:50,900
<font color="#E5E5E5">actually yeah actually it turns out that</font>

589
00:29:48,440 --> 00:29:53,870
this<font color="#CCCCCC"> is parsing something called IP</font>

590
00:29:50,900 --> 00:30:00,130
<font color="#E5E5E5">control protocol headers yeah that's</font>

591
00:29:53,870 --> 00:30:04,428
what I figured<font color="#CCCCCC"> out</font><font color="#E5E5E5"> later so basically</font>

592
00:30:00,130 --> 00:30:06,140
the protocol configuration options are

593
00:30:04,429 --> 00:30:08,929
sent by<font color="#CCCCCC"> the network like I said you know</font>

594
00:30:06,140 --> 00:30:12,559
you specify parameters DNS default

595
00:30:08,929 --> 00:30:17,630
gateway and the problem now is<font color="#CCCCCC"> that the</font>

596
00:30:12,559 --> 00:30:19,789
phone will<font color="#E5E5E5"> never process this activate</font>

597
00:30:17,630 --> 00:30:21,250
contact<font color="#CCCCCC"> except message that we want to</font>

598
00:30:19,789 --> 00:30:25,158
send in order to trigger this

599
00:30:21,250 --> 00:30:28,100
vulnerability<font color="#E5E5E5"> because I one thing you'll</font>

600
00:30:25,159 --> 00:30:29,720
find<font color="#E5E5E5"> is with all this GM GSM and</font>

601
00:30:28,100 --> 00:30:32,570
cellular stuff is a bunch<font color="#E5E5E5"> of state</font>

602
00:30:29,720 --> 00:30:34,669
machines<font color="#E5E5E5"> and you can't just tend send</font>

603
00:30:32,570 --> 00:30:37,520
any message at any<font color="#E5E5E5"> time the phone needs</font>

604
00:30:34,669 --> 00:30:41,380
to<font color="#E5E5E5"> be in the correct state before</font><font color="#CCCCCC"> it</font>

605
00:30:37,520 --> 00:30:45,049
even processes any of<font color="#E5E5E5"> those messages</font><font color="#CCCCCC"> so</font>

606
00:30:41,380 --> 00:30:48,770
the problem for<font color="#E5E5E5"> me was</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> the phone</font>

607
00:30:45,049 --> 00:30:51,320
<font color="#E5E5E5">could be made</font><font color="#CCCCCC"> to send this request</font><font color="#E5E5E5"> made</font>

608
00:30:48,770 --> 00:30:53,720
to<font color="#E5E5E5"> be in the correct</font><font color="#CCCCCC"> state by actually</font>

609
00:30:51,320 --> 00:30:56,809
going on the phone and configuring a

610
00:30:53,720 --> 00:31:00,230
access point name but this is not

611
00:30:56,809 --> 00:31:02,330
allowed<font color="#E5E5E5"> for point alone so I</font><font color="#CCCCCC"> spent</font><font color="#E5E5E5"> some</font>

612
00:31:00,230 --> 00:31:05,590
<font color="#CCCCCC">time reading the standards again and I</font>

613
00:31:02,330 --> 00:31:07,060
figured out<font color="#CCCCCC"> that if you stand</font><font color="#E5E5E5"> request</font>

614
00:31:05,590 --> 00:31:09,370
<font color="#E5E5E5">PDP</font><font color="#CCCCCC"> count</font>

615
00:31:07,060 --> 00:31:11,830
<font color="#CCCCCC">activision actually all these names are</font>

616
00:31:09,370 --> 00:31:14,379
pretty misleading<font color="#E5E5E5"> and weird but that's</font>

617
00:31:11,830 --> 00:31:16,540
what they are<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> standard but the</font>

618
00:31:14,380 --> 00:31:19,390
<font color="#E5E5E5">network can ask the phone</font><font color="#CCCCCC"> to request a</font>

619
00:31:16,540 --> 00:31:22,450
PDP context<font color="#E5E5E5"> activation and at that point</font>

620
00:31:19,390 --> 00:31:24,790
<font color="#E5E5E5">the phone will send the activate</font>

621
00:31:22,450 --> 00:31:28,240
requests and then the network<font color="#E5E5E5"> will send</font>

622
00:31:24,790 --> 00:31:32,820
a activate accept message and trigger

623
00:31:28,240 --> 00:31:32,820
the bug so it basically looks like<font color="#E5E5E5"> this</font>

624
00:31:33,120 --> 00:31:39,070
<font color="#E5E5E5">you know send the request get the phone</font>

625
00:31:36,160 --> 00:31:46,720
<font color="#E5E5E5">to request it and then accept with the</font>

626
00:31:39,070 --> 00:31:49,510
crafted payload so in order<font color="#CCCCCC"> to implement</font>

627
00:31:46,720 --> 00:31:51,880
the attack<font color="#E5E5E5"> we</font><font color="#CCCCCC"> need to</font><font color="#E5E5E5"> modify the source</font>

628
00:31:49,510 --> 00:31:56,080
code<font color="#E5E5E5"> of</font><font color="#CCCCCC"> v8 BTS so I told you it's pretty</font>

629
00:31:51,880 --> 00:31:58,540
<font color="#E5E5E5">clean and</font><font color="#CCCCCC"> actually reading the code</font>

630
00:31:56,080 --> 00:32:01,899
helped me a lot in understanding<font color="#E5E5E5"> what</font>

631
00:31:58,540 --> 00:32:04,659
the messages<font color="#E5E5E5"> look like for</font><font color="#CCCCCC"> GSM for the</font>

632
00:32:01,900 --> 00:32:07,540
<font color="#CCCCCC">GSM protocol stack and for this attack</font>

633
00:32:04,660 --> 00:32:13,090
<font color="#E5E5E5">I'll give you a hint you need to modify</font>

634
00:32:07,540 --> 00:32:14,980
<font color="#E5E5E5">that file and you</font><font color="#CCCCCC"> can try</font><font color="#E5E5E5"> it and the</font>

635
00:32:13,090 --> 00:32:18,459
exploit itself<font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> think it matters</font>

636
00:32:14,980 --> 00:32:20,710
<font color="#CCCCCC">that much because</font><font color="#E5E5E5"> I mean it's the stack</font>

637
00:32:18,460 --> 00:32:23,680
buffer overflow and you get good

638
00:32:20,710 --> 00:32:27,640
execution<font color="#E5E5E5"> in the basement the rest is up</font>

639
00:32:23,680 --> 00:32:29,530
<font color="#CCCCCC">to your</font><font color="#E5E5E5"> imagination</font><font color="#CCCCCC"> what I did for 4.1</font>

640
00:32:27,640 --> 00:32:31,330
was to write I mean<font color="#CCCCCC"> I needed to</font>

641
00:32:29,530 --> 00:32:34,149
demonstrate<font color="#E5E5E5"> that I actually had code</font>

642
00:32:31,330 --> 00:32:36,220
execution<font color="#E5E5E5"> so I just wrote</font><font color="#CCCCCC"> to a file on</font>

643
00:32:34,150 --> 00:32:39,720
the file system<font color="#CCCCCC"> and I'll show you</font><font color="#E5E5E5"> in the</font>

644
00:32:36,220 --> 00:32:39,720
<font color="#E5E5E5">demo right now when it looks like</font>

645
00:32:48,880 --> 00:32:51,919
[Music]

646
00:32:54,780 --> 00:32:59,639
<font color="#E5E5E5">is it on the screen is it on the screen</font>

647
00:33:11,850 --> 00:33:19,418
and now it's all black<font color="#CCCCCC"> oh wait</font><font color="#E5E5E5"> actually</font>

648
00:33:16,929 --> 00:33:22,240
<font color="#CCCCCC">I</font><font color="#E5E5E5"> mean if you look at the top you can</font>

649
00:33:19,419 --> 00:33:24,010
<font color="#E5E5E5">see I'm sorry my font is very small and</font>

650
00:33:22,240 --> 00:33:27,159
I didn't know it was gonna<font color="#E5E5E5"> be so small</font>

651
00:33:24,010 --> 00:33:29,799
on the<font color="#CCCCCC"> screen so</font><font color="#E5E5E5"> basically this is</font><font color="#CCCCCC"> just</font>

652
00:33:27,159 --> 00:33:34,630
on<font color="#CCCCCC"> the right you have the screen which</font>

653
00:33:29,799 --> 00:33:36,940
<font color="#E5E5E5">is connected to ADB you have a terminal</font>

654
00:33:34,630 --> 00:33:41,890
<font color="#CCCCCC">which is</font><font color="#E5E5E5"> connected to a</font><font color="#CCCCCC"> TV</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> the phone</font>

655
00:33:36,940 --> 00:33:47,650
and<font color="#E5E5E5"> on the left is VTS running so let's</font>

656
00:33:41,890 --> 00:33:50,740
<font color="#E5E5E5">see so basically I'm</font><font color="#CCCCCC"> just doing a watch</font>

657
00:33:47,650 --> 00:33:55,210
command of the<font color="#E5E5E5"> ADB checking the</font>

658
00:33:50,740 --> 00:34:10,199
<font color="#CCCCCC">filesystem and as soon as the phone</font>

659
00:33:55,210 --> 00:34:10,199
connects<font color="#E5E5E5"> basically the nice very good</font>

660
00:34:11,489 --> 00:34:16,299
yeah so<font color="#CCCCCC"> like I said</font><font color="#E5E5E5"> on the right is a</font>

661
00:34:13,869 --> 00:34:18,609
<font color="#CCCCCC">ADB</font><font color="#E5E5E5"> watch command</font><font color="#CCCCCC"> to see if there's</font>

662
00:34:16,300 --> 00:34:22,980
anything on the<font color="#CCCCCC"> phones</font><font color="#E5E5E5"> filesystem and</font>

663
00:34:18,609 --> 00:34:22,980
<font color="#E5E5E5">all the right is a BTS running</font>

664
00:34:36,780 --> 00:34:41,510
yeah you see the<font color="#CCCCCC"> father's created over</font>

665
00:34:39,210 --> 00:34:41,510
there

666
00:34:41,969 --> 00:34:47,749
[Applause]

667
00:35:20,060 --> 00:35:24,770
so I guess that's<font color="#CCCCCC"> pretty</font><font color="#E5E5E5"> much the whole</font>

668
00:35:22,790 --> 00:35:29,090
talk now I'll<font color="#CCCCCC"> just point out</font><font color="#E5E5E5"> a few</font>

669
00:35:24,770 --> 00:35:31,520
<font color="#E5E5E5">things as conclusions so really what I</font>

670
00:35:29,090 --> 00:35:33,590
wanted to show with<font color="#CCCCCC"> that the base base</font>

671
00:35:31,520 --> 00:35:36,410
point<font color="#E5E5E5"> base band exploitation isn't that</font>

672
00:35:33,590 --> 00:35:38,060
<font color="#E5E5E5">it just looks scary and there are all</font>

673
00:35:36,410 --> 00:35:40,190
these things<font color="#CCCCCC"> that people think they</font>

674
00:35:38,060 --> 00:35:43,070
<font color="#CCCCCC">should know about cellular networks</font><font color="#E5E5E5"> and</font>

675
00:35:40,190 --> 00:35:46,970
stuff like that<font color="#E5E5E5"> but it's</font><font color="#CCCCCC"> really is</font>

676
00:35:43,070 --> 00:35:48,950
<font color="#E5E5E5">really just another CTF challenge so you</font>

677
00:35:46,970 --> 00:35:50,569
really<font color="#E5E5E5"> don't need too</font><font color="#CCCCCC"> much</font><font color="#E5E5E5"> to know much</font>

678
00:35:48,950 --> 00:35:54,140
about cellular networks in order<font color="#E5E5E5"> to</font>

679
00:35:50,570 --> 00:35:56,360
exploit them and I'm hoping to<font color="#CCCCCC"> see a</font>

680
00:35:54,140 --> 00:35:58,509
full remote compromise through<font color="#E5E5E5"> the base</font>

681
00:35:56,360 --> 00:36:00,980
<font color="#E5E5E5">band you know all the way from a</font>

682
00:35:58,510 --> 00:36:03,140
cellular<font color="#CCCCCC"> network that</font><font color="#E5E5E5"> routes your phone</font>

683
00:36:00,980 --> 00:36:06,440
and there are many targets<font color="#CCCCCC"> out there</font>

684
00:36:03,140 --> 00:36:38,660
Huawei Intel<font color="#E5E5E5"> Qualcomm and hopefully one</font>

685
00:36:06,440 --> 00:36:45,140
of<font color="#E5E5E5"> you guys will and that's it okay so I</font>

686
00:36:38,660 --> 00:36:48,279
guess the<font color="#E5E5E5"> most straightforward way to</font>

687
00:36:45,140 --> 00:36:51,170
<font color="#E5E5E5">debug was through the crash dumps so</font>

688
00:36:48,280 --> 00:36:53,600
whenever you crash the phone you<font color="#E5E5E5"> get the</font>

689
00:36:51,170 --> 00:36:55,460
RAM dump<font color="#E5E5E5"> you can look at memory but I</font>

690
00:36:53,600 --> 00:36:58,310
guess and something I didn't point out

691
00:36:55,460 --> 00:37:00,410
was once in<font color="#E5E5E5"> the random you get the</font><font color="#CCCCCC"> safe</font>

692
00:36:58,310 --> 00:37:03,799
state of registers when it crashed so

693
00:37:00,410 --> 00:37:08,930
that's also<font color="#CCCCCC"> very useful</font><font color="#E5E5E5"> so yeah you can</font>

694
00:37:03,800 --> 00:37:11,690
debug<font color="#E5E5E5"> every</font><font color="#CCCCCC"> 10</font><font color="#E5E5E5"> minutes</font><font color="#CCCCCC"> that way I guess</font>

695
00:37:08,930 --> 00:37:15,100
<font color="#E5E5E5">one thing you can try is through an</font>

696
00:37:11,690 --> 00:37:18,710
exploit you can just try<font color="#E5E5E5"> to you know</font>

697
00:37:15,100 --> 00:37:21,950
implement your own debugger<font color="#CCCCCC"> and write to</font>

698
00:37:18,710 --> 00:37:25,210
the file<font color="#CCCCCC"> system but</font><font color="#E5E5E5"> yeah I think that's</font>

699
00:37:21,950 --> 00:37:25,210
a<font color="#E5E5E5"> lot of work but it's doable</font>

700
00:37:33,119 --> 00:37:37,960
so when you exploit your way to the file

701
00:37:35,529 --> 00:37:39,789
system<font color="#CCCCCC"> has the baseband CPU access to</font>

702
00:37:37,960 --> 00:37:42,400
the file system<font color="#E5E5E5"> or do you either exploit</font>

703
00:37:39,789 --> 00:37:44,769
to go to the application processor<font color="#E5E5E5"> yeah</font>

704
00:37:42,400 --> 00:37:46,569
so the base<font color="#E5E5E5"> no I mean no I didn't I</font>

705
00:37:44,769 --> 00:37:49,328
<font color="#CCCCCC">don't have exploit to the application</font>

706
00:37:46,569 --> 00:37:51,250
<font color="#CCCCCC">processor the</font><font color="#E5E5E5"> basement has access</font><font color="#CCCCCC"> to the</font>

707
00:37:49,329 --> 00:37:54,519
file system basically there's this<font color="#E5E5E5"> thing</font>

708
00:37:51,250 --> 00:37:56,410
called non-volatile<font color="#E5E5E5"> items and it</font>

709
00:37:54,519 --> 00:37:59,640
basically<font color="#CCCCCC"> means</font><font color="#E5E5E5"> the baseband should be</font>

710
00:37:56,410 --> 00:38:02,828
<font color="#CCCCCC">able</font><font color="#E5E5E5"> to save permanent permanent</font>

711
00:37:59,640 --> 00:38:05,319
<font color="#E5E5E5">configuration options or whatever so the</font>

712
00:38:02,829 --> 00:38:07,420
way they did it was<font color="#E5E5E5"> true of accessing</font>

713
00:38:05,319 --> 00:38:29,650
some portion of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> filesystem</font><font color="#E5E5E5"> on the</font>

714
00:38:07,420 --> 00:38:33,839
<font color="#E5E5E5">Android device and did you mention</font>

715
00:38:29,650 --> 00:38:36,369
something<font color="#E5E5E5"> about security mitigation for</font>

716
00:38:33,839 --> 00:38:40,690
<font color="#CCCCCC">yeah</font><font color="#E5E5E5"> so I didn't</font><font color="#CCCCCC"> mention any because</font>

717
00:38:36,369 --> 00:38:42,819
there are any so yeah you shouldn't

718
00:38:40,690 --> 00:38:47,740
worry<font color="#CCCCCC"> about them they</font><font color="#E5E5E5"> don't exist in</font>

719
00:38:42,819 --> 00:38:51,400
this thing okay so the<font color="#CCCCCC"> rob chain is</font>

720
00:38:47,740 --> 00:38:56,200
because of arm caching issues<font color="#CCCCCC"> so if I</font>

721
00:38:51,400 --> 00:38:58,599
<font color="#E5E5E5">just jumped to some data it wouldn't</font>

722
00:38:56,200 --> 00:39:02,259
have been flushed to<font color="#CCCCCC"> the code to the</font>

723
00:38:58,599 --> 00:39:05,230
<font color="#E5E5E5">code cache and basically you start by</font>

724
00:39:02,259 --> 00:39:08,680
Rob<font color="#E5E5E5"> copy or your shellcode somewhere and</font>

725
00:39:05,230 --> 00:39:10,539
flush the caches<font color="#E5E5E5"> and that's that's</font>

726
00:39:08,680 --> 00:39:15,808
that's<font color="#E5E5E5"> why you need Rob in the beginning</font>

727
00:39:10,539 --> 00:39:15,809
at least to the 90s

728
00:39:27,620 --> 00:39:43,660
any questions<font color="#E5E5E5"> thank you for</font>

729
00:39:37,930 --> 00:39:43,660
[Applause]

