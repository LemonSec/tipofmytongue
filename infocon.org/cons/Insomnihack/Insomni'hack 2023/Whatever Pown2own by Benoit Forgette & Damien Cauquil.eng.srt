1
00:00:04,040 --> 00:00:06,420
so hello everyone we would like to talk

2
00:00:06,420 --> 00:00:09,360
about our journey to the Pontoon contest

3
00:00:09,360 --> 00:00:11,400
oops

4
00:00:11,400 --> 00:00:12,540
sorry

5
00:00:12,540 --> 00:00:16,560
just a mistake so for this context we

6
00:00:16,560 --> 00:00:19,820
were Forest uh so it was

7
00:00:19,820 --> 00:00:23,520
just here and present uh Robin Devine

8
00:00:23,520 --> 00:00:24,900
and me

9
00:00:24,900 --> 00:00:27,359
we work mainly as a hardware and

10
00:00:27,359 --> 00:00:30,599
software reversal and we will see we

11
00:00:30,599 --> 00:00:33,120
will really like the NBD devices and

12
00:00:33,120 --> 00:00:35,480
it's why we

13
00:00:35,480 --> 00:00:37,260
contest

14
00:00:37,260 --> 00:00:39,960
so just to run rules we may not be

15
00:00:39,960 --> 00:00:42,239
familiar with it pontoon is a worldwide

16
00:00:42,239 --> 00:00:44,160
contest that includes multiple targets

17
00:00:44,160 --> 00:00:48,079
as Automotive routers dermatic equipment

18
00:00:48,079 --> 00:00:51,539
operating system among others the goal

19
00:00:51,539 --> 00:00:53,820
is to export these devices to gain root

20
00:00:53,820 --> 00:00:54,899
access

21
00:00:54,899 --> 00:00:57,539
in less than five minutes while

22
00:00:57,539 --> 00:01:00,300
feminists seems a lot of time in export

23
00:01:00,300 --> 00:01:04,199
world you will see but it's not actually

24
00:01:04,199 --> 00:01:09,360
so long for us so you will see

25
00:01:09,360 --> 00:01:12,000
to go deeper into the world for local

26
00:01:12,000 --> 00:01:14,159
devices only one type of energy was

27
00:01:14,159 --> 00:01:17,220
accepted remote code execution and for

28
00:01:17,220 --> 00:01:19,500
the router's category there were two

29
00:01:19,500 --> 00:01:22,200
possible vectors we via the land side

30
00:01:22,200 --> 00:01:25,320
and the one side with a i o cache price

31
00:01:25,320 --> 00:01:28,860
for relators and so the one wide area

32
00:01:28,860 --> 00:01:32,640
network is the side quality to the

33
00:01:32,640 --> 00:01:34,740
internet which means that anyone around

34
00:01:34,740 --> 00:01:37,020
the world can access to it

35
00:01:37,020 --> 00:01:39,299
in comparison to the land side local

36
00:01:39,299 --> 00:01:41,640
area networks can only be accessed by

37
00:01:41,640 --> 00:01:44,040
diversity device directly connected to

38
00:01:44,040 --> 00:01:48,860
the routers and or devices

39
00:01:48,860 --> 00:01:53,759
communicate with routers from the lab

40
00:01:53,759 --> 00:01:57,720
so here you will see the router that we

41
00:01:57,720 --> 00:01:59,220
will attack

42
00:01:59,220 --> 00:02:02,280
and visual ideas and introduced an

43
00:02:02,280 --> 00:02:04,680
interesting new category called Smash Up

44
00:02:04,680 --> 00:02:07,200
the goal is to compromise a device from

45
00:02:07,200 --> 00:02:10,619
the voters category and then pivot to

46
00:02:10,619 --> 00:02:12,000
local devices

47
00:02:12,000 --> 00:02:14,879
and for this category the exploit must

48
00:02:14,879 --> 00:02:18,379
be executing within 10 minutes

49
00:02:18,480 --> 00:02:20,940
so now let's focus on our organization

50
00:02:20,940 --> 00:02:23,400
to participate in the competition the

51
00:02:23,400 --> 00:02:24,900
context published a list of a Target

52
00:02:24,900 --> 00:02:28,620
around August and we began to review

53
00:02:28,620 --> 00:02:31,860
them only on 22 September

54
00:02:31,860 --> 00:02:36,000
and he took us around the one month to

55
00:02:36,000 --> 00:02:38,700
choose the potassium targets the Netgear

56
00:02:38,700 --> 00:02:42,720
x30 and the standard Originals as a part

57
00:02:42,720 --> 00:02:44,700
of our team we only focus on the Netgear

58
00:02:44,700 --> 00:02:48,180
rx30 so we will only discuss on doing

59
00:02:48,180 --> 00:02:53,160
this conference on Netgear rx-30

60
00:02:53,160 --> 00:02:55,920
so we began to working on the device on

61
00:02:55,920 --> 00:02:59,180
October 31st within a week we found some

62
00:02:59,180 --> 00:03:02,160
varieties although they were not

63
00:03:02,160 --> 00:03:04,680
eligible for the context for instance we

64
00:03:04,680 --> 00:03:06,900
got multi-part crash that implied those

65
00:03:06,900 --> 00:03:11,040
other routers but we were here only to

66
00:03:11,040 --> 00:03:13,680
go to Wood access so

67
00:03:13,680 --> 00:03:16,319
just to begin we

68
00:03:16,319 --> 00:03:19,800
we begin to to get a good access with

69
00:03:19,800 --> 00:03:21,480
physical access

70
00:03:21,480 --> 00:03:24,180
so it was not really difficult because

71
00:03:24,180 --> 00:03:27,659
we just need to type slash bin sh and

72
00:03:27,659 --> 00:03:30,540
again it would access whoa that was a

73
00:03:30,540 --> 00:03:32,720
change

74
00:03:32,819 --> 00:03:35,159
the next weeks were pretty great but the

75
00:03:35,159 --> 00:03:37,920
following week we discover a way to

76
00:03:37,920 --> 00:03:40,440
achieve a romantical decision

77
00:03:40,440 --> 00:03:44,840
on the device but you you will see

78
00:03:44,840 --> 00:03:48,659
that was not actually works in our case

79
00:03:48,659 --> 00:03:51,860
but never mind

80
00:03:51,860 --> 00:03:55,379
uh we found four of our way to achieve a

81
00:03:55,379 --> 00:03:57,798
remote connection

82
00:03:57,840 --> 00:04:01,620
three four one and one for the land

83
00:04:01,620 --> 00:04:04,319
so we had 15 days to

84
00:04:04,319 --> 00:04:06,840
to prepare a contest

85
00:04:06,840 --> 00:04:10,200
um I think you we are LED it's cool but

86
00:04:10,200 --> 00:04:13,080
before the end let's begin

87
00:04:13,080 --> 00:04:16,380
our strategy for this contest

88
00:04:16,380 --> 00:04:19,500
so what do we want when we go to this

89
00:04:19,500 --> 00:04:21,540
type of book contest

90
00:04:21,540 --> 00:04:24,120
we are here for the glory we are here

91
00:04:24,120 --> 00:04:27,840
for the money yes maybe but if you give

92
00:04:27,840 --> 00:04:29,340
a go there for the money would like to

93
00:04:29,340 --> 00:04:31,440
minimize the research time and maximize

94
00:04:31,440 --> 00:04:33,840
the gain but if again is high probably

95
00:04:33,840 --> 00:04:35,940
it's more difficult

96
00:04:35,940 --> 00:04:38,759
and we will look our organize our

97
00:04:38,759 --> 00:04:41,400
research time to to get the best way uh

98
00:04:41,400 --> 00:04:44,220
to to gain money

99
00:04:44,220 --> 00:04:47,400
so Financial resource and strategy

100
00:04:47,400 --> 00:04:49,680
when we look at the one side in general

101
00:04:49,680 --> 00:04:53,580
we only have a few Services exposed in

102
00:04:53,580 --> 00:04:55,680
some cases none of them were exposed

103
00:04:55,680 --> 00:04:58,080
typically we found we can found a

104
00:04:58,080 --> 00:05:00,060
web-based Administration interface and

105
00:05:00,060 --> 00:05:02,639
SSH services and some of our services

106
00:05:02,639 --> 00:05:05,759
were and not necessarily exposed due to

107
00:05:05,759 --> 00:05:07,380
a filtering error

108
00:05:07,380 --> 00:05:10,620
however for our device none of these

109
00:05:10,620 --> 00:05:14,460
were exposure so another way to access

110
00:05:14,460 --> 00:05:17,220
to these devices for it's for the block

111
00:05:17,220 --> 00:05:19,380
knocking feature so when you're

112
00:05:19,380 --> 00:05:21,240
connecting classic scan there are

113
00:05:21,240 --> 00:05:23,759
nothing up here but when you follow

114
00:05:23,759 --> 00:05:28,919
a strange uh strength instruction

115
00:05:28,919 --> 00:05:32,900
magical Services appear

116
00:05:33,780 --> 00:05:36,600
the last thing we can play with is the

117
00:05:36,600 --> 00:05:39,000
outgoing traffic nowadays other traffic

118
00:05:39,000 --> 00:05:41,460
is encrypted so anything is possible

119
00:05:41,460 --> 00:05:44,039
unless if you found the vulnerability

120
00:05:44,039 --> 00:05:46,620
inside your encryption or if you can

121
00:05:46,620 --> 00:05:49,680
inject some malform packets

122
00:05:49,680 --> 00:05:52,860
however it's possible to evaluate the

123
00:05:52,860 --> 00:05:55,740
identity of a DNS server not not the

124
00:05:55,740 --> 00:05:58,080
dinosaur but the access server

125
00:05:58,080 --> 00:06:01,740
so on this example the router access to

126
00:06:01,740 --> 00:06:06,060
the DNA server to ask an address of

127
00:06:06,060 --> 00:06:08,460
whichever he would like to contact

128
00:06:08,460 --> 00:06:10,940
but

129
00:06:11,280 --> 00:06:14,940
if our DNS server answer before they

130
00:06:14,940 --> 00:06:17,160
will then well then server voter will

131
00:06:17,160 --> 00:06:20,600
access to the wrong server

132
00:06:20,940 --> 00:06:23,039
these little tricks should not work

133
00:06:23,039 --> 00:06:25,080
because the water normally has a list of

134
00:06:25,080 --> 00:06:26,360
certificate

135
00:06:26,360 --> 00:06:29,580
to verify the anonymity of the server

136
00:06:29,580 --> 00:06:33,419
and that's called pinning and however in

137
00:06:33,419 --> 00:06:35,100
some cases the very classification is

138
00:06:35,100 --> 00:06:36,660
ignore

139
00:06:36,660 --> 00:06:39,120
let's talk about one of his case when

140
00:06:39,120 --> 00:06:42,060
you use for instance your binary

141
00:06:42,060 --> 00:06:44,819
to retrieve a web page here with a fiber

142
00:06:44,819 --> 00:06:47,280
entity of a server before accessing the

143
00:06:47,280 --> 00:06:50,940
data but when you use the minuscape um

144
00:06:50,940 --> 00:06:54,720
minor minus minus in your uh no I know

145
00:06:54,720 --> 00:06:58,020
you know insecure

146
00:06:58,020 --> 00:07:00,479
you don't verify yourself yet for

147
00:07:00,479 --> 00:07:02,699
instance when you have a self-signed

148
00:07:02,699 --> 00:07:04,740
certificate you don't want to verify

149
00:07:04,740 --> 00:07:06,660
yourself yet because you know but it's

150
00:07:06,660 --> 00:07:09,240
not actually works

151
00:07:09,240 --> 00:07:11,940
so we will focus on this minority and we

152
00:07:11,940 --> 00:07:14,699
see how we can automatic the research at

153
00:07:14,699 --> 00:07:17,220
the binary level

154
00:07:17,220 --> 00:07:20,400
at QuickTime we have a tool called podua

155
00:07:20,400 --> 00:07:23,400
and pontoon is a first time we use this

156
00:07:23,400 --> 00:07:25,680
tool in a real world scenario

157
00:07:25,680 --> 00:07:27,900
to explain what these tools can do let

158
00:07:27,900 --> 00:07:31,020
me outline the difference feature so we

159
00:07:31,020 --> 00:07:34,319
have extraction analysis and this thing

160
00:07:34,319 --> 00:07:36,840
with extraction we can provide the tool

161
00:07:36,840 --> 00:07:38,639
with another VMware to extract the

162
00:07:38,639 --> 00:07:40,440
firmware start system and create a tree

163
00:07:40,440 --> 00:07:43,080
view of the extra cheat data

164
00:07:43,080 --> 00:07:45,479
sometimes the extraction goes wrong and

165
00:07:45,479 --> 00:07:48,060
in this case we just need to explain how

166
00:07:48,060 --> 00:07:51,780
we should extract the VMware and for the

167
00:07:51,780 --> 00:07:55,440
further VMware it will be extract at the

168
00:07:55,440 --> 00:07:56,819
same manner

169
00:07:56,819 --> 00:07:59,639
and that's it really cool

170
00:07:59,639 --> 00:08:01,680
after completing the restoration step we

171
00:08:01,680 --> 00:08:03,599
can move on the analysis

172
00:08:03,599 --> 00:08:06,300
and we can examine the file system by

173
00:08:06,300 --> 00:08:08,520
resolving steam link to dig deeper into

174
00:08:08,520 --> 00:08:10,440
the analysis of binary and add some

175
00:08:10,440 --> 00:08:11,699
record

176
00:08:11,699 --> 00:08:14,819
and finally with DC we can identify

177
00:08:14,819 --> 00:08:15,900
change

178
00:08:15,900 --> 00:08:20,220
in astriction a level and see if some

179
00:08:20,220 --> 00:08:22,259
binary was changed and where

180
00:08:22,259 --> 00:08:25,199
so this story can request an analysis of

181
00:08:25,199 --> 00:08:27,479
the firmware examine its fact system and

182
00:08:27,479 --> 00:08:30,539
it is it's called a deeper level and in

183
00:08:30,539 --> 00:08:33,860
termsify change and difference

184
00:08:34,080 --> 00:08:36,419
so let's take an example

185
00:08:36,419 --> 00:08:39,958
if we take us our case for firmware

186
00:08:39,958 --> 00:08:41,760
let's say a certificate winning for 20

187
00:08:41,760 --> 00:08:44,700
we can try to identify it for instance

188
00:08:44,700 --> 00:08:47,399
we can look for all instance of leap

189
00:08:47,399 --> 00:08:49,140
year but don't check the certificate of

190
00:08:49,140 --> 00:08:50,940
the URL

191
00:08:50,940 --> 00:08:53,519
but the equivalent of minus minus

192
00:08:53,519 --> 00:08:56,220
insecure or minus clear so first we

193
00:08:56,220 --> 00:08:57,899
extract the firmware list of all

194
00:08:57,899 --> 00:09:00,779
binaries that use leap year library and

195
00:09:00,779 --> 00:09:04,620
then analyze all call all of the car

196
00:09:04,620 --> 00:09:07,560
easy set up and verify if you score set

197
00:09:07,560 --> 00:09:11,160
verify peer or verify host to 0.

198
00:09:11,160 --> 00:09:13,680
it's equivalent to minus minus in Secure

199
00:09:13,680 --> 00:09:16,019
or minus K and then just list all

200
00:09:16,019 --> 00:09:18,959
functions of all banneries but have a

201
00:09:18,959 --> 00:09:21,600
variable call by following this step we

202
00:09:21,600 --> 00:09:23,220
can identify an instance of certificate

203
00:09:23,220 --> 00:09:27,080
winning issue in this summer

204
00:09:27,540 --> 00:09:32,480
so now we'll Target in LAN

205
00:09:33,959 --> 00:09:35,820
thank you so

206
00:09:35,820 --> 00:09:36,480
um

207
00:09:36,480 --> 00:09:38,399
when it comes to to attacking the land

208
00:09:38,399 --> 00:09:41,880
side of the router one thing we don't

209
00:09:41,880 --> 00:09:43,980
want to find is the dinner of denial of

210
00:09:43,980 --> 00:09:46,260
service attack because this got this

211
00:09:46,260 --> 00:09:48,779
kind of bug yeah it's not very useful

212
00:09:48,779 --> 00:09:50,580
when you want to achieve remote code

213
00:09:50,580 --> 00:09:52,380
execution but in fact it gives you a

214
00:09:52,380 --> 00:09:54,540
good idea of the security of the water

215
00:09:54,540 --> 00:09:57,480
and mostly the security aspect of the

216
00:09:57,480 --> 00:09:58,760
code

217
00:09:58,760 --> 00:10:02,100
the firmware uses so basically you can

218
00:10:02,100 --> 00:10:04,560
find some local service crash so you're

219
00:10:04,560 --> 00:10:08,220
just a craft a specific service through

220
00:10:08,220 --> 00:10:10,920
a buff overflow maybe or sometimes we

221
00:10:10,920 --> 00:10:13,399
don't know exactly why the system is

222
00:10:13,399 --> 00:10:16,680
crashes but yeah that's it that's a

223
00:10:16,680 --> 00:10:18,720
simple bag it could be useful to to stop

224
00:10:18,720 --> 00:10:22,019
a given service for instance also we can

225
00:10:22,019 --> 00:10:24,779
look for system crash by injecting uh

226
00:10:24,779 --> 00:10:26,640
some specific Network packet for

227
00:10:26,640 --> 00:10:29,399
instance and in this way you may kill

228
00:10:29,399 --> 00:10:31,380
the device and you need to reboot the

229
00:10:31,380 --> 00:10:33,899
device to to get access so again this is

230
00:10:33,899 --> 00:10:36,120
not really useful when you're trying to

231
00:10:36,120 --> 00:10:40,260
achieve very execution and last but not

232
00:10:40,260 --> 00:10:42,660
least there is also a system resources

233
00:10:42,660 --> 00:10:45,480
exertion scenario you can trigger doing

234
00:10:45,480 --> 00:10:48,959
this if you manage to hit too much RAM

235
00:10:48,959 --> 00:10:50,040
or

236
00:10:50,040 --> 00:10:53,399
busy the CPU enough to get the system

237
00:10:53,399 --> 00:10:55,500
stuck at some point

238
00:10:55,500 --> 00:10:57,180
well

239
00:10:57,180 --> 00:11:00,500
looking at the code of this formula

240
00:11:00,720 --> 00:11:01,860
firmware specific

241
00:11:01,860 --> 00:11:05,820
fix here fired that under file upload

242
00:11:05,820 --> 00:11:08,399
on the web interface so this one was

243
00:11:08,399 --> 00:11:10,740
obviously on the line side and it was

244
00:11:10,740 --> 00:11:13,140
unauthenticated so it's an anybody can

245
00:11:13,140 --> 00:11:15,779
just trigger this uh this piece of Code

246
00:11:15,779 --> 00:11:18,300
by uploading a file and if you have a

247
00:11:18,300 --> 00:11:20,839
look at this figure the compiled C code

248
00:11:20,839 --> 00:11:24,019
there is something wrong because

249
00:11:24,019 --> 00:11:27,720
this CGI stores the updated data into

250
00:11:27,720 --> 00:11:30,300
one file which is called depending on

251
00:11:30,300 --> 00:11:32,959
some conditions

252
00:11:33,140 --> 00:11:36,180
file or slash TMP slash multipart file

253
00:11:36,180 --> 00:11:38,399
depending on the uh on the fact that the

254
00:11:38,399 --> 00:11:41,760
file is a multi-part on coded or not but

255
00:11:41,760 --> 00:11:44,940
in fact there is a for Loop and and the

256
00:11:44,940 --> 00:11:48,079
this firmware will write into this file

257
00:11:48,079 --> 00:11:50,640
whatever you sign in the body of the

258
00:11:50,640 --> 00:11:54,180
request so if you send a lot of data a

259
00:11:54,180 --> 00:11:57,019
lot of data ends up in this file and

260
00:11:57,019 --> 00:12:00,060
normally most of you must know but the

261
00:12:00,060 --> 00:12:03,000
slash GMP slash file system is hosted in

262
00:12:03,000 --> 00:12:04,920
Ram so basically if you open the one

263
00:12:04,920 --> 00:12:08,820
gigabyte file through the land side the

264
00:12:08,820 --> 00:12:11,660
system is totally stuck so this was a

265
00:12:11,660 --> 00:12:14,459
yeah some interesting finding but yeah

266
00:12:14,459 --> 00:12:16,380
this is not really useful to achieve a

267
00:12:16,380 --> 00:12:18,540
remote code addiction but in fact this

268
00:12:18,540 --> 00:12:20,339
is something funny because it gives you

269
00:12:20,339 --> 00:12:23,700
an idea about the uh security skills of

270
00:12:23,700 --> 00:12:26,279
the developers of this firmware

271
00:12:26,279 --> 00:12:29,519
so we got a temporary file that may eat

272
00:12:29,519 --> 00:12:31,140
a lot of RAM and another certificate

273
00:12:31,140 --> 00:12:34,220
upload so uh

274
00:12:34,860 --> 00:12:38,640
um deny your service vulnerability and

275
00:12:38,640 --> 00:12:40,740
then we had a look at another part of

276
00:12:40,740 --> 00:12:43,320
the web server and we found a way to

277
00:12:43,320 --> 00:12:45,660
bypass the user authentication required

278
00:12:45,660 --> 00:12:47,700
to access the admin Administration panel

279
00:12:47,700 --> 00:12:49,740
so basically you have to log into the

280
00:12:49,740 --> 00:12:52,200
system with the admin username or maybe

281
00:12:52,200 --> 00:12:54,480
it can be changed no no I don't remember

282
00:12:54,480 --> 00:12:57,480
if it can be changed anyway with this

283
00:12:57,480 --> 00:12:59,700
user authentication panel and you have

284
00:12:59,700 --> 00:13:01,860
to log in and of course there is a

285
00:13:01,860 --> 00:13:04,320
password reset feature available because

286
00:13:04,320 --> 00:13:06,180
you know uh

287
00:13:06,180 --> 00:13:09,360
we usually lose password so why not and

288
00:13:09,360 --> 00:13:12,120
this password wizard feature requires

289
00:13:12,120 --> 00:13:14,700
the user to enter a secret question and

290
00:13:14,700 --> 00:13:17,220
the answer to the secret question and

291
00:13:17,220 --> 00:13:19,260
what happens if you don't provide the

292
00:13:19,260 --> 00:13:22,620
answer in the Json data well in fact

293
00:13:22,620 --> 00:13:25,139
it's just with the password

294
00:13:25,139 --> 00:13:27,800
so secret secret

295
00:13:27,800 --> 00:13:30,060
but I mean

296
00:13:30,060 --> 00:13:32,220
the answer to the secret question is not

297
00:13:32,220 --> 00:13:35,519
very useful so yeah if we had a way to

298
00:13:35,519 --> 00:13:40,260
get uh access to this animation panel

299
00:13:40,260 --> 00:13:42,540
um yeah there are most uh more of an

300
00:13:42,540 --> 00:13:44,040
objectives to come

301
00:13:44,040 --> 00:13:46,620
uh we also had a look at the uh former

302
00:13:46,620 --> 00:13:48,779
signature mechanism

303
00:13:48,779 --> 00:13:50,820
yeah there are some parts redacted here

304
00:13:50,820 --> 00:13:53,940
because yeah we

305
00:13:53,940 --> 00:13:56,399
we don't bought the water people to

306
00:13:56,399 --> 00:13:59,579
break into this stuff but yeah we know

307
00:13:59,579 --> 00:14:04,380
you we do anyway so uh this uh firmware

308
00:14:04,380 --> 00:14:07,860
signature system where we usually we

309
00:14:07,860 --> 00:14:10,260
Face a lot of different mechanisms and

310
00:14:10,260 --> 00:14:13,620
one of the most secure is to use uh Osa

311
00:14:13,620 --> 00:14:15,779
or public encryption just to be sure

312
00:14:15,779 --> 00:14:20,519
that nobody can break it oh normally and

313
00:14:20,519 --> 00:14:24,540
in this case they used a sha-256

314
00:14:24,540 --> 00:14:27,959
Ash algorithm with some secret values

315
00:14:27,959 --> 00:14:30,959
well once we get the the firmware the

316
00:14:30,959 --> 00:14:32,820
sequence value are not secret anymore so

317
00:14:32,820 --> 00:14:35,459
we got these values and we found a way

318
00:14:35,459 --> 00:14:38,820
to unpack a firmware totally to get all

319
00:14:38,820 --> 00:14:40,680
the with file systems the kernels and so

320
00:14:40,680 --> 00:14:42,779
on and to repack it with the correct

321
00:14:42,779 --> 00:14:45,000
valid and correct signature and valid

322
00:14:45,000 --> 00:14:48,660
signature so using this we could exploit

323
00:14:48,660 --> 00:14:52,199
a specific not export we could use or

324
00:14:52,199 --> 00:14:54,899
abuse a specific mechanism which is the

325
00:14:54,899 --> 00:14:58,079
firmware update feature available in the

326
00:14:58,079 --> 00:15:00,720
administration panel to install a new

327
00:15:00,720 --> 00:15:02,880
firmware so

328
00:15:02,880 --> 00:15:05,639
we will summarize we got uh almost not

329
00:15:05,639 --> 00:15:08,339
get it from your upload so the odd

330
00:15:08,339 --> 00:15:11,000
bypass we can use this uh

331
00:15:11,000 --> 00:15:13,019
unauthenticated from airport to break

332
00:15:13,019 --> 00:15:16,079
the device if we just uh install a wrong

333
00:15:16,079 --> 00:15:18,180
firmware or some code that just kills

334
00:15:18,180 --> 00:15:20,579
the device we can also deploy it deploy

335
00:15:20,579 --> 00:15:22,440
your back door to access the remotely

336
00:15:22,440 --> 00:15:24,959
the device or why not if you want you

337
00:15:24,959 --> 00:15:27,480
can install openwrt if you want to own

338
00:15:27,480 --> 00:15:30,240
the device and use it without the

339
00:15:30,240 --> 00:15:32,639
Netgear firmware which is well

340
00:15:32,639 --> 00:15:34,560
vulnerable

341
00:15:34,560 --> 00:15:37,740
so it was all good and

342
00:15:37,740 --> 00:15:40,620
and we notice we were not working on the

343
00:15:40,620 --> 00:15:43,139
latest version of the firmware of course

344
00:15:43,139 --> 00:15:45,660
you know your when you are doing this

345
00:15:45,660 --> 00:15:47,820
video you are in a version just focus on

346
00:15:47,820 --> 00:15:50,820
the firmware files and so on and oh have

347
00:15:50,820 --> 00:15:52,980
you seen that the gear released a

348
00:15:52,980 --> 00:15:57,600
specific update oh no well

349
00:15:57,779 --> 00:16:00,300
it was yeah maybe a little pissed

350
00:16:00,300 --> 00:16:01,800
because of this

351
00:16:01,800 --> 00:16:04,860
um and some some minorities we've

352
00:16:04,860 --> 00:16:07,380
previously found uh we are corrected

353
00:16:07,380 --> 00:16:11,339
were fixed by this uh new firmware this

354
00:16:11,339 --> 00:16:13,560
new version of the firmware so we had to

355
00:16:13,560 --> 00:16:16,560
find all the ways to achieve remote code

356
00:16:16,560 --> 00:16:19,040
execution

357
00:16:19,260 --> 00:16:23,220
so we look on the soap server it's like

358
00:16:23,220 --> 00:16:25,260
a proxy server but it was not uh

359
00:16:25,260 --> 00:16:28,320
normally used for by a user it's just an

360
00:16:28,320 --> 00:16:31,800
internal services but it was exposed

361
00:16:31,800 --> 00:16:36,420
on the 0.0.0 so anyone can access on the

362
00:16:36,420 --> 00:16:37,380
line

363
00:16:37,380 --> 00:16:41,160
and we see here as can have a function

364
00:16:41,160 --> 00:16:44,279
that was dangerous and something

365
00:16:44,279 --> 00:16:46,500
interesting it's not like the percentage

366
00:16:46,500 --> 00:16:48,839
as we probably know it's like a

367
00:16:48,839 --> 00:16:51,959
percentage and a bracket and after just

368
00:16:51,959 --> 00:16:55,920
avoid some character and so if we just

369
00:16:55,920 --> 00:16:59,699
it ended when you put a space or if you

370
00:16:59,699 --> 00:17:02,399
have a end of a string so if you have

371
00:17:02,399 --> 00:17:04,099
use of this uh

372
00:17:04,099 --> 00:17:07,980
this characteristic we can just write a

373
00:17:07,980 --> 00:17:11,720
buffer overflow and so we can

374
00:17:11,720 --> 00:17:13,439
here

375
00:17:13,439 --> 00:17:15,419
but uh

376
00:17:15,419 --> 00:17:18,179
find this variety is easy about export

377
00:17:18,179 --> 00:17:21,059
it is more difficult and we have here

378
00:17:21,059 --> 00:17:24,000
there are some update of Netgear so we

379
00:17:24,000 --> 00:17:27,299
just wait to have the last update and

380
00:17:27,299 --> 00:17:29,940
see you when we uh exploit it because uh

381
00:17:29,940 --> 00:17:33,480
if we exploit the binary and uh you

382
00:17:33,480 --> 00:17:35,820
found your your Gadget and something

383
00:17:35,820 --> 00:17:37,919
like that and just they recompile the

384
00:17:37,919 --> 00:17:40,260
the binary but the function is always

385
00:17:40,260 --> 00:17:41,700
vulnerable

386
00:17:41,700 --> 00:17:46,320
you uh Gadget was probably not be the

387
00:17:46,320 --> 00:17:48,960
same and so you need to research so we

388
00:17:48,960 --> 00:17:51,539
want to economize our research time so

389
00:17:51,539 --> 00:17:53,760
we just put aside and

390
00:17:53,760 --> 00:17:57,660
now we just uh look what the result of

391
00:17:57,660 --> 00:18:00,539
the automatization look like

392
00:18:00,539 --> 00:18:02,299
so uh

393
00:18:02,299 --> 00:18:05,640
if we take a closer look at the result

394
00:18:05,640 --> 00:18:08,460
of automatic research on the one side we

395
00:18:08,460 --> 00:18:11,160
have found an interesting binary core

396
00:18:11,160 --> 00:18:14,700
few cfu and that doesn't verify the

397
00:18:14,700 --> 00:18:17,460
certificate of where we just asked

398
00:18:17,460 --> 00:18:20,220
so easy if you want to explore this

399
00:18:20,220 --> 00:18:22,860
similarity all we need is to use a DNS

400
00:18:22,860 --> 00:18:25,080
mask and provide the host we want to

401
00:18:25,080 --> 00:18:27,900
spoof and pu say if you ask for the URL

402
00:18:27,900 --> 00:18:30,500
that can be used to update the routers

403
00:18:30,500 --> 00:18:33,539
however we now need to determine which

404
00:18:33,539 --> 00:18:36,660
binary use puc Fu and we don't try to

405
00:18:36,660 --> 00:18:40,500
Binary that call puf the value of grade

406
00:18:40,500 --> 00:18:43,760
and prior update

407
00:18:44,160 --> 00:18:48,480
so uh if we look per update it's called

408
00:18:48,480 --> 00:18:50,340
effectively pure cfu and then column

409
00:18:50,340 --> 00:18:53,100
function that call download file twice

410
00:18:53,100 --> 00:18:56,100
so just look a little bit at this

411
00:18:56,100 --> 00:18:56,940
function

412
00:18:56,940 --> 00:18:59,460
uh this function verify we already begin

413
00:18:59,460 --> 00:19:02,520
with https oh so it's cool and concur

414
00:19:02,520 --> 00:19:05,820
again with a minus minus insecure

415
00:19:05,820 --> 00:19:07,140
um

416
00:19:07,140 --> 00:19:11,039
so if you're very beginning with http

417
00:19:11,039 --> 00:19:13,020
so every time this function is called

418
00:19:13,020 --> 00:19:16,440
and we can control the data receive we

419
00:19:16,440 --> 00:19:20,220
can just put HTTP and not https and

420
00:19:20,220 --> 00:19:22,500
that's all it's uh don't verify the

421
00:19:22,500 --> 00:19:24,179
certificate or something like that it's

422
00:19:24,179 --> 00:19:25,919
okay

423
00:19:25,919 --> 00:19:28,919
so now if we try to imitate the behavior

424
00:19:28,919 --> 00:19:31,799
of a whale server we see that any

425
00:19:31,799 --> 00:19:33,419
prediction prevents us from the

426
00:19:33,419 --> 00:19:35,580
replacing the actual binary and download

427
00:19:35,580 --> 00:19:38,700
download and we only need to recompute

428
00:19:38,700 --> 00:19:42,960
the ash of a binary and that's it so if

429
00:19:42,960 --> 00:19:45,440
we summarize the behavior of a binary

430
00:19:45,440 --> 00:19:48,539
we just requests to get a get final

431
00:19:48,539 --> 00:19:51,059
four.txt and that contains the ash the

432
00:19:51,059 --> 00:19:52,799
size and the name of the file so we just

433
00:19:52,799 --> 00:19:59,280
rewrite this file and we create our AR r

434
00:19:59,280 --> 00:20:02,820
i e binary and that's it we can check

435
00:20:02,820 --> 00:20:05,760
and run the binary and so we got a

436
00:20:05,760 --> 00:20:07,380
remote execution

437
00:20:07,380 --> 00:20:12,919
so we got the first one uh earthy

438
00:20:13,080 --> 00:20:15,240
but if you look deeper inside the

439
00:20:15,240 --> 00:20:17,760
function download file we have a number

440
00:20:17,760 --> 00:20:20,220
of things really interesting

441
00:20:20,220 --> 00:20:22,260
but we provide the URL as the second

442
00:20:22,260 --> 00:20:26,039
argument uh like in the SM princet you

443
00:20:26,039 --> 00:20:28,799
can see that all the common is exactly

444
00:20:28,799 --> 00:20:31,320
passed as a share command

445
00:20:31,320 --> 00:20:34,320
so what's wrong here hmm

446
00:20:34,320 --> 00:20:37,879
I think we can just uh

447
00:20:37,919 --> 00:20:41,160
do something like that

448
00:20:41,160 --> 00:20:44,100
so we just put inside the real uh

449
00:20:44,100 --> 00:20:47,700
uh semicolon and just a argument to

450
00:20:47,700 --> 00:20:49,740
execute and here we just recreate the

451
00:20:49,740 --> 00:20:55,100
a.csh file and execute it it's simple

452
00:20:55,620 --> 00:20:59,039
now we can look at the overall binary

453
00:20:59,039 --> 00:21:01,980
pfu WL guide and it slightly different

454
00:21:01,980 --> 00:21:03,960
from Pure update

455
00:21:03,960 --> 00:21:06,960
its launched at uh during uh during the

456
00:21:06,960 --> 00:21:10,380
each during the early Boot and but it's

457
00:21:10,380 --> 00:21:14,660
not uh it's not like the core the the

458
00:21:14,660 --> 00:21:18,840
remote server it just schedule when it

459
00:21:18,840 --> 00:21:21,660
would like to uh to to execute the

460
00:21:21,660 --> 00:21:22,740
binary

461
00:21:22,740 --> 00:21:26,280
so we don't know exactly when uh it will

462
00:21:26,280 --> 00:21:31,700
be executed it's a random value

463
00:21:32,880 --> 00:21:35,340
but they would don't have real time

464
00:21:35,340 --> 00:21:39,900
clock and we can just spoof the value

465
00:21:39,900 --> 00:21:42,900
even if it's random you can perhaps try

466
00:21:42,900 --> 00:21:45,840
a candidate and see if you can execute

467
00:21:45,840 --> 00:21:48,678
at the correct time

468
00:21:49,140 --> 00:21:52,559
and then if you the very Greg work

469
00:21:52,559 --> 00:21:54,299
slightly different from Pure update like

470
00:21:54,299 --> 00:21:57,600
I said before it's not only a simple

471
00:21:57,600 --> 00:22:00,600
binary it's the world VMware

472
00:22:00,600 --> 00:22:04,080
the wolf humor it's really important

473
00:22:04,080 --> 00:22:07,140
so we can just replace all the VMware

474
00:22:07,140 --> 00:22:11,640
and we referral also how to make a a

475
00:22:11,640 --> 00:22:13,740
firmware so it's great we can just

476
00:22:13,740 --> 00:22:16,260
upgrade via the one

477
00:22:16,260 --> 00:22:20,520
but we can something to add pfu upgrade

478
00:22:20,520 --> 00:22:24,000
don't check the signal signature so

479
00:22:24,000 --> 00:22:26,039
we have do some work to just reverse the

480
00:22:26,039 --> 00:22:28,140
signature but

481
00:22:28,140 --> 00:22:30,539
we don't need to do that we just need to

482
00:22:30,539 --> 00:22:33,419
put zero at this signature and it's okay

483
00:22:33,419 --> 00:22:35,159
it's validate

484
00:22:35,159 --> 00:22:38,340
the problem with this virality uh it

485
00:22:38,340 --> 00:22:40,860
takes around 4 minutes and 20 seconds to

486
00:22:40,860 --> 00:22:43,919
be executed and if you correctly

487
00:22:43,919 --> 00:22:46,740
remember I say we have five minutes to

488
00:22:46,740 --> 00:22:51,120
be execute our finality so it's really

489
00:22:51,120 --> 00:22:53,700
short and we need to to be stressed to

490
00:22:53,700 --> 00:22:57,740
when we want to execute this visuality

491
00:22:57,740 --> 00:23:02,520
and the the spoof time uh the time we

492
00:23:02,520 --> 00:23:04,799
push sorry

493
00:23:04,799 --> 00:23:07,799
NTV

494
00:23:08,760 --> 00:23:12,360
is not be sure that it's the correct one

495
00:23:12,360 --> 00:23:14,820
so we put a sign visibility because it's

496
00:23:14,820 --> 00:23:17,480
too much random

497
00:23:17,940 --> 00:23:21,299
so just check and then

498
00:23:21,299 --> 00:23:24,539
you have your main system

499
00:23:24,539 --> 00:23:25,940
so

500
00:23:25,940 --> 00:23:30,360
uh we have four SEO on the device which

501
00:23:30,360 --> 00:23:31,559
is fine

502
00:23:31,559 --> 00:23:34,740
but everything goes wrong Netgear

503
00:23:34,740 --> 00:23:38,100
publish and Netflix

504
00:23:38,100 --> 00:23:41,940
tests one day before

505
00:23:41,940 --> 00:23:44,100
the contest

506
00:23:44,100 --> 00:23:48,179
and three of our vulnerability was just

507
00:23:48,179 --> 00:23:51,320
a wipe

508
00:23:52,460 --> 00:23:56,100
just was removed by an exact view so we

509
00:23:56,100 --> 00:23:58,980
cannot uh do any more uh some injection

510
00:23:58,980 --> 00:24:00,600
and

511
00:24:00,600 --> 00:24:02,340
fewer updates

512
00:24:02,340 --> 00:24:05,340
don't use any more puc Fu they just

513
00:24:05,340 --> 00:24:07,799
updated the the URL

514
00:24:07,799 --> 00:24:12,179
so we cannot uh do a uh just update this

515
00:24:12,179 --> 00:24:15,720
binary and we just only got the linear

516
00:24:15,720 --> 00:24:19,440
CU and the one F2 but to learn as I said

517
00:24:19,440 --> 00:24:22,860
before uh it takes more time and you

518
00:24:22,860 --> 00:24:26,400
have just one day to just export it so

519
00:24:26,400 --> 00:24:29,760
we give up visuality and we focus on the

520
00:24:29,760 --> 00:24:32,100
random variability

521
00:24:32,100 --> 00:24:33,840
so Lana one

522
00:24:33,840 --> 00:24:35,220
Plan B

523
00:24:35,220 --> 00:24:39,720
okay I'm going to describe the way we

524
00:24:39,720 --> 00:24:43,020
took this decision to still attend a

525
00:24:43,020 --> 00:24:45,659
participate in the contest so

526
00:24:45,659 --> 00:24:46,500
um

527
00:24:46,500 --> 00:24:51,059
we had to to to elaborate a plan BS just

528
00:24:51,059 --> 00:24:53,720
a backup option so how to do this

529
00:24:53,720 --> 00:24:56,460
remember this over the year firmware

530
00:24:56,460 --> 00:25:00,380
check using GPU FW upgrade so this

531
00:25:00,380 --> 00:25:04,200
command is installed as a scheduled task

532
00:25:04,200 --> 00:25:07,980
during the boot and this

533
00:25:07,980 --> 00:25:10,740
this this is a current type Chrome setup

534
00:25:10,740 --> 00:25:12,720
by the by the system and the value is

535
00:25:12,720 --> 00:25:15,780
used to determine the minutes and the

536
00:25:15,780 --> 00:25:17,880
errors at which the system will be

537
00:25:17,880 --> 00:25:19,860
launched or

538
00:25:19,860 --> 00:25:20,400
um

539
00:25:20,400 --> 00:25:23,280
chosen in a way it seemed random at the

540
00:25:23,280 --> 00:25:25,559
time we looked at this code but if we

541
00:25:25,559 --> 00:25:28,799
have a better look at the code there is

542
00:25:28,799 --> 00:25:30,419
something interesting

543
00:25:30,419 --> 00:25:32,539
because

544
00:25:32,539 --> 00:25:35,580
the machine this water has no ntp at

545
00:25:35,580 --> 00:25:38,039
good time so basically the date and time

546
00:25:38,039 --> 00:25:40,620
set up by the system when it boots is

547
00:25:40,620 --> 00:25:43,380
just the compile time of the kernel and

548
00:25:43,380 --> 00:25:46,020
if it will work it creates a seed using

549
00:25:46,020 --> 00:25:48,900
the time function in C using a null

550
00:25:48,900 --> 00:25:51,539
parameter which is basically how to get

551
00:25:51,539 --> 00:25:55,200
the timestamp from the system on a

552
00:25:55,200 --> 00:26:00,740
32-bit integer and then it uses the S1

553
00:26:00,740 --> 00:26:04,140
seed initialization function which is

554
00:26:04,140 --> 00:26:06,179
not very secure

555
00:26:06,179 --> 00:26:08,820
so basically we got here some

556
00:26:08,820 --> 00:26:12,299
predictable prng used on this system and

557
00:26:12,299 --> 00:26:15,659
since we know exactly the timestamp

558
00:26:15,659 --> 00:26:19,200
generated by uh well the date and time

559
00:26:19,200 --> 00:26:21,360
at which the system boots yeah maybe

560
00:26:21,360 --> 00:26:24,419
there is something to do so uh there is

561
00:26:24,419 --> 00:26:27,120
no crypto energy so exporting this uh

562
00:26:27,120 --> 00:26:29,880
this uh feature is uh yeah it was not

563
00:26:29,880 --> 00:26:33,000
really easy because uh we don't we

564
00:26:33,000 --> 00:26:36,960
didn't know at this time uh when exactly

565
00:26:36,960 --> 00:26:41,159
this pu FW upgrade schedule task was

566
00:26:41,159 --> 00:26:44,400
installed during boot so it may be at

567
00:26:44,400 --> 00:26:46,200
the during the early boot maybe two

568
00:26:46,200 --> 00:26:47,580
minutes after the first time the system

569
00:26:47,580 --> 00:26:49,919
boots so we did we didn't know so we had

570
00:26:49,919 --> 00:26:52,559
to check and the only way we we had to

571
00:26:52,559 --> 00:26:56,159
to do this uh was to compute all the

572
00:26:56,159 --> 00:26:58,740
possible values we can get from this

573
00:26:58,740 --> 00:27:01,260
random generator starting from the

574
00:27:01,260 --> 00:27:03,900
attempt stamp we got at extracting from

575
00:27:03,900 --> 00:27:06,419
the kernel compilation time so we look

576
00:27:06,419 --> 00:27:08,580
at this we generated a huge file with

577
00:27:08,580 --> 00:27:10,380
all the possible values and we started

578
00:27:10,380 --> 00:27:12,960
booting up our router and since we had

579
00:27:12,960 --> 00:27:15,360
access to the woods file system uh

580
00:27:15,360 --> 00:27:19,140
through the serial Port using this shell

581
00:27:19,140 --> 00:27:23,159
trick we we were able to extract a lot

582
00:27:23,159 --> 00:27:25,200
of possible values after a lot of

583
00:27:25,200 --> 00:27:28,380
reboots so took some time to to get

584
00:27:28,380 --> 00:27:32,580
these values and we had a very small set

585
00:27:32,580 --> 00:27:34,620
um like 10 possible values observed

586
00:27:34,620 --> 00:27:37,200
during these boots and we compared these

587
00:27:37,200 --> 00:27:38,100
values

588
00:27:38,100 --> 00:27:39,059
um

589
00:27:39,059 --> 00:27:41,820
from the one we got in this huge file

590
00:27:41,820 --> 00:27:46,620
and we found a very small time scale one

591
00:27:46,620 --> 00:27:48,600
of these where these values appeared in

592
00:27:48,600 --> 00:27:51,480
in office so it was pretty uh obvious

593
00:27:51,480 --> 00:27:54,179
that the the time spent by the system

594
00:27:54,179 --> 00:27:57,539
before starting this pu FW upgrades

595
00:27:57,539 --> 00:28:01,260
command uh the scheduled task uh took

596
00:28:01,260 --> 00:28:04,799
between 87 seconds and 96 seconds

597
00:28:04,799 --> 00:28:07,740
starting from root

598
00:28:07,740 --> 00:28:09,600
um in the meantime since Netgear

599
00:28:09,600 --> 00:28:12,600
published the outfix a lot of teams uh

600
00:28:12,600 --> 00:28:16,860
just decided not to compete and the yeah

601
00:28:16,860 --> 00:28:18,779
we don't know exactly but because uh

602
00:28:18,779 --> 00:28:21,299
some uh some critics talk with this

603
00:28:21,299 --> 00:28:24,600
these guys but uh the guys from Star

604
00:28:24,600 --> 00:28:26,820
Labs decided to publish a blog post

605
00:28:26,820 --> 00:28:30,480
before the contest with all

606
00:28:30,480 --> 00:28:33,140
vulnerabilities they found so yeah it's

607
00:28:33,140 --> 00:28:36,120
it was very particular but it but in

608
00:28:36,120 --> 00:28:38,039
this specific blog post they published

609
00:28:38,039 --> 00:28:41,520
uh they gave some values they observed

610
00:28:41,520 --> 00:28:44,760
in this same contact file and we had the

611
00:28:44,760 --> 00:28:48,240
confirmation that the 59 and 3 were in

612
00:28:48,240 --> 00:28:49,799
The Times Square we were looking at so

613
00:28:49,799 --> 00:28:51,840
it was just a confirmation that this

614
00:28:51,840 --> 00:28:53,640
track may be the one to get a remote

615
00:28:53,640 --> 00:28:57,240
code execution yeah during our attempts

616
00:28:57,240 --> 00:29:00,659
and our tests we from from our side we

617
00:29:00,659 --> 00:29:04,860
got a lot of two a lot of specific pair

618
00:29:04,860 --> 00:29:07,440
of values which was zero and three so

619
00:29:07,440 --> 00:29:10,020
zero minutes and three hours uh in uh

620
00:29:10,020 --> 00:29:12,299
alphabet twice so it was a pretty

621
00:29:12,299 --> 00:29:14,039
interesting value that means if you want

622
00:29:14,039 --> 00:29:16,860
to participate in the at pan to run we

623
00:29:16,860 --> 00:29:18,659
we you have three attempts of five

624
00:29:18,659 --> 00:29:21,480
minutes each so uh maybe if you're lucky

625
00:29:21,480 --> 00:29:23,880
and you try again and again three times

626
00:29:23,880 --> 00:29:27,000
maybe it will work on the device

627
00:29:27,000 --> 00:29:29,460
yeah for fifty percent chance it's not

628
00:29:29,460 --> 00:29:31,020
that much so

629
00:29:31,020 --> 00:29:34,500
um yeah we need to weaponize this I mean

630
00:29:34,500 --> 00:29:37,679
we we needed to figure out a way a

631
00:29:37,679 --> 00:29:39,779
reliable way to exploit this and to get

632
00:29:39,779 --> 00:29:42,960
uh more than 50 chance of success uh to

633
00:29:42,960 --> 00:29:45,480
export this this bag so we need to

634
00:29:45,480 --> 00:29:47,940
really able to guess these values uh we

635
00:29:47,940 --> 00:29:49,860
know exactly how to change the routers

636
00:29:49,860 --> 00:29:52,380
date and time since we know how to spoof

637
00:29:52,380 --> 00:29:55,260
MTP so it was not a very big deal here

638
00:29:55,260 --> 00:29:57,659
to do to get the the correct date and

639
00:29:57,659 --> 00:29:59,700
date and time or most of the time here

640
00:29:59,700 --> 00:30:02,520
because the date doesn't matter uh the

641
00:30:02,520 --> 00:30:04,980
idea was to install a work firmware like

642
00:30:04,980 --> 00:30:07,440
Bruno said it takes around four minutes

643
00:30:07,440 --> 00:30:09,360
and a half to get installed on the

644
00:30:09,360 --> 00:30:12,120
system and reboot it fully Rebooted so

645
00:30:12,120 --> 00:30:14,399
the time is very short for using things

646
00:30:14,399 --> 00:30:16,080
but if we manage to do this we can

647
00:30:16,080 --> 00:30:19,380
Implement some light show Led show and

648
00:30:19,380 --> 00:30:21,179
make the LEDs blinked and then we

649
00:30:21,179 --> 00:30:22,860
celebrate we get the money and yeah

650
00:30:22,860 --> 00:30:25,679
success so we had to we decided to

651
00:30:25,679 --> 00:30:28,020
create a network something that monitors

652
00:30:28,020 --> 00:30:30,539
some metrics some some events from the

653
00:30:30,539 --> 00:30:33,000
router in order to compute to deduce the

654
00:30:33,000 --> 00:30:36,059
values uh generated by this random

655
00:30:36,059 --> 00:30:37,500
number generator

656
00:30:37,500 --> 00:30:40,220
and we started looking at some

657
00:30:40,220 --> 00:30:43,080
information we could get from the router

658
00:30:43,080 --> 00:30:45,179
at boot time and one of these

659
00:30:45,179 --> 00:30:47,760
information was the jtp request the

660
00:30:47,760 --> 00:30:49,460
system sent

661
00:30:49,460 --> 00:30:52,700
some time afterwards and we

662
00:30:52,700 --> 00:30:56,640
we made the appetizers at this the the

663
00:30:56,640 --> 00:30:58,679
time between the JCP request and the

664
00:30:58,679 --> 00:31:01,559
time at which the Pud FW upgrade dash s

665
00:31:01,559 --> 00:31:03,779
option so which is the command that set

666
00:31:03,779 --> 00:31:06,600
up the schedule task for the firmware

667
00:31:06,600 --> 00:31:10,500
upgrade this time the secret time was

668
00:31:10,500 --> 00:31:13,559
constant so this is just something we

669
00:31:13,559 --> 00:31:17,580
guessed uh we hoped hopefully and we

670
00:31:17,580 --> 00:31:20,100
started measuring this uh this uh T and

671
00:31:20,100 --> 00:31:23,039
team and secret times uh we these times

672
00:31:23,039 --> 00:31:27,299
are supposed to be constantial and we

673
00:31:27,299 --> 00:31:29,340
did a lot of tests

674
00:31:29,340 --> 00:31:32,220
we created this record and we compared

675
00:31:32,220 --> 00:31:34,919
the output of the Oracle with the output

676
00:31:34,919 --> 00:31:37,860
of the files which were the truth uh

677
00:31:37,860 --> 00:31:40,559
because uh and we did a lot of tests and

678
00:31:40,559 --> 00:31:42,899
in fact the success rate of this method

679
00:31:42,899 --> 00:31:45,480
was just about 30 percent chance of

680
00:31:45,480 --> 00:31:46,820
success so

681
00:31:46,820 --> 00:31:51,440
yeah uh it was a pretty good idea

682
00:31:51,440 --> 00:31:54,059
sounded like clever but no that doesn't

683
00:31:54,059 --> 00:31:56,820
work so anyway

684
00:31:56,820 --> 00:32:00,419
s we noticed that the pair of zero and

685
00:32:00,419 --> 00:32:03,059
three was very common and we got it a

686
00:32:03,059 --> 00:32:07,559
lot of time so we in a more test we made

687
00:32:07,559 --> 00:32:11,279
we got a 70 chances of success so it was

688
00:32:11,279 --> 00:32:13,620
pretty good and these values seemed to

689
00:32:13,620 --> 00:32:16,620
be quite stable when we did this test so

690
00:32:16,620 --> 00:32:19,440
yeah why not 70 percent of chances yeah

691
00:32:19,440 --> 00:32:22,140
that's pretty good let's go 2.21 we have

692
00:32:22,140 --> 00:32:25,880
a chance but yeah still we have a 70

693
00:32:25,880 --> 00:32:28,559
chance of success

694
00:32:28,559 --> 00:32:30,299
we may fail

695
00:32:30,299 --> 00:32:33,000
so anyway let's let's give it a shot we

696
00:32:33,000 --> 00:32:35,220
are we are going to test it so we

697
00:32:35,220 --> 00:32:39,059
developed a specific explored we um we

698
00:32:39,059 --> 00:32:42,059
took a lot of efforts to create a very

699
00:32:42,059 --> 00:32:45,120
reliable exploit so here we have the uh

700
00:32:45,120 --> 00:32:48,000
Target the wax 30 router from uh from

701
00:32:48,000 --> 00:32:50,700
Netgear and remember when we explored

702
00:32:50,700 --> 00:32:53,820
this the firmware takes

703
00:32:53,820 --> 00:32:55,919
about four minutes and a half to be

704
00:32:55,919 --> 00:32:59,220
installed and fully rebooted so we need

705
00:32:59,220 --> 00:33:01,020
it to be quick we need to be fast during

706
00:33:01,020 --> 00:33:03,000
the execution the expectation so we

707
00:33:03,000 --> 00:33:04,919
maximize the alternative success and we

708
00:33:04,919 --> 00:33:07,860
finally got the LED show on the uh on

709
00:33:07,860 --> 00:33:09,840
the router so yeah it was cool we had

710
00:33:09,840 --> 00:33:11,159
something working but the walking

711
00:33:11,159 --> 00:33:14,600
exploit so yeah

712
00:33:20,600 --> 00:33:23,760
uh so yeah we got an emergency meeting

713
00:33:23,760 --> 00:33:26,340
uh I don't just before the day before

714
00:33:26,340 --> 00:33:30,179
the the the attempts because uh at the

715
00:33:30,179 --> 00:33:32,700
early morning and everyone was just uh

716
00:33:32,700 --> 00:33:36,419
entire yeah because uh the um the order

717
00:33:36,419 --> 00:33:39,419
of Passage is random you don't choose

718
00:33:39,419 --> 00:33:41,880
your when you are going to to try your

719
00:33:41,880 --> 00:33:42,840
your

720
00:33:42,840 --> 00:33:46,500
your attacks uh so uh we all agree we

721
00:33:46,500 --> 00:33:48,360
are going to use the zero and three

722
00:33:48,360 --> 00:33:50,700
values uh yes and we are the yes

723
00:33:50,700 --> 00:33:53,100
absolutely yeah we don't change okay so

724
00:33:53,100 --> 00:33:54,659
we stick with zero three this is the

725
00:33:54,659 --> 00:33:57,840
best option we have so we attempted our

726
00:33:57,840 --> 00:34:00,720
first exploitation of this router uh and

727
00:34:00,720 --> 00:34:03,240
this first attempt fade

728
00:34:03,240 --> 00:34:06,539
uh it was a bit stressful during this

729
00:34:06,539 --> 00:34:08,580
attempt so just to be more precise um

730
00:34:08,580 --> 00:34:11,580
there are two others who flew to Toronto

731
00:34:11,580 --> 00:34:14,820
uh to be uh you know near the devices

732
00:34:14,820 --> 00:34:16,560
just to be sure that everything is okay

733
00:34:16,560 --> 00:34:18,300
and that nothing goes wrong with the

734
00:34:18,300 --> 00:34:20,969
hardware and uh

735
00:34:20,969 --> 00:34:23,960
[Music]

736
00:34:23,960 --> 00:34:26,460
and we if we had one of the colleagues

737
00:34:26,460 --> 00:34:28,800
just streaming the the attempts so yeah

738
00:34:28,800 --> 00:34:31,379
a bit more stressful to be uh you know

739
00:34:31,379 --> 00:34:35,219
to be remote and not being able to do

740
00:34:35,219 --> 00:34:38,399
anything to make it more easy for for

741
00:34:38,399 --> 00:34:41,280
Success so uh yeah we had also the old

742
00:34:41,280 --> 00:34:44,520
team behind us uh yeah with a lot of

743
00:34:44,520 --> 00:34:45,239
Hope

744
00:34:45,239 --> 00:34:48,719
yeah go on trophy go uh second attempt

745
00:34:48,719 --> 00:34:52,260
fail too so yeah it was time to yeah

746
00:34:52,260 --> 00:34:54,960
before uh attempting the third time just

747
00:34:54,960 --> 00:34:56,879
to have a little meeting and wait wait

748
00:34:56,879 --> 00:34:59,280
wait wait wait what would we do uh yeah

749
00:34:59,280 --> 00:35:01,680
we modified the operative video you know

750
00:35:01,680 --> 00:35:04,560
we decided to change these zero and

751
00:35:04,560 --> 00:35:07,320
three values to something else because

752
00:35:07,320 --> 00:35:10,740
our exploitation included some Metric uh

753
00:35:10,740 --> 00:35:13,079
some monitoring and we were monitoring

754
00:35:13,079 --> 00:35:15,960
the boot time of the router and the two

755
00:35:15,960 --> 00:35:18,000
previous attempts we got different

756
00:35:18,000 --> 00:35:20,160
values that the one we got when we

757
00:35:20,160 --> 00:35:22,500
tested it on our water so we decided

758
00:35:22,500 --> 00:35:24,599
that maybe this is not exactly the same

759
00:35:24,599 --> 00:35:27,119
Hardware or the exactly the same context

760
00:35:27,119 --> 00:35:29,940
during the expectation and we decided to

761
00:35:29,940 --> 00:35:32,280
change this value

762
00:35:32,280 --> 00:35:35,700
because why not and in fact the third

763
00:35:35,700 --> 00:35:38,760
attempt trade too so we had three shots

764
00:35:38,760 --> 00:35:41,820
three shots failed this is uh yeah no

765
00:35:41,820 --> 00:35:43,619
leg

766
00:35:43,619 --> 00:35:46,440
um but the saddest part of it is that

767
00:35:46,440 --> 00:35:48,300
the last during the last attempt the

768
00:35:48,300 --> 00:35:51,000
values we got from our script

769
00:35:51,000 --> 00:35:54,500
were exactly the one we got during our

770
00:35:54,500 --> 00:35:57,660
Expedition attempts at home

771
00:35:57,660 --> 00:36:00,060
so yeah a bit disappointing here but

772
00:36:00,060 --> 00:36:02,520
anyway so just to conclude this talk I

773
00:36:02,520 --> 00:36:04,579
don't know

774
00:36:05,660 --> 00:36:08,940
so there are some takeaways here to for

775
00:36:08,940 --> 00:36:12,060
you guys if you want to to attempt uh

776
00:36:12,060 --> 00:36:14,640
pulling stuff at point to owner uh the

777
00:36:14,640 --> 00:36:16,440
first one is that you should not focus

778
00:36:16,440 --> 00:36:19,320
on uh on on three valve innovities but

779
00:36:19,320 --> 00:36:21,000
more on non-trivial reasonabilities

780
00:36:21,000 --> 00:36:23,280
because other teams will easily found

781
00:36:23,280 --> 00:36:25,680
this uh find this whenever it is and if

782
00:36:25,680 --> 00:36:30,000
you stick to what is not a search or

783
00:36:30,000 --> 00:36:31,980
looked at by other teams or the

784
00:36:31,980 --> 00:36:34,380
mainstream teams this uh this is your

785
00:36:34,380 --> 00:36:36,119
best chance to to get something unique

786
00:36:36,119 --> 00:36:39,000
and something that won't be patched by

787
00:36:39,000 --> 00:36:41,700
Netgear when a day before and moreover

788
00:36:41,700 --> 00:36:45,240
uh if you if a team was dropped over the

789
00:36:45,240 --> 00:36:48,599
just a drop before you they will use

790
00:36:48,599 --> 00:36:51,119
this virability and so we will be just

791
00:36:51,119 --> 00:36:54,240
only on collision and not a fuller yes

792
00:36:54,240 --> 00:36:55,740
and to get the Bounty you need to be the

793
00:36:55,740 --> 00:36:57,480
first team to exploit the this

794
00:36:57,480 --> 00:36:59,400
vulnerability so if you are not lucky

795
00:36:59,400 --> 00:37:01,619
like we we were at this time because we

796
00:37:01,619 --> 00:37:04,520
were the last day

797
00:37:08,839 --> 00:37:11,099
you will maximize your sense of success

798
00:37:11,099 --> 00:37:13,800
uh also find as much expert past as

799
00:37:13,800 --> 00:37:15,780
possible because if you get just one

800
00:37:15,780 --> 00:37:18,720
path and it got blocked by an update or

801
00:37:18,720 --> 00:37:22,980
anything then you're doomed it

802
00:37:22,980 --> 00:37:24,119
uh

803
00:37:24,119 --> 00:37:27,240
and yes you follow a similar technology

804
00:37:27,240 --> 00:37:30,000
so if you have a you just to take

805
00:37:30,000 --> 00:37:34,020
research time to uh see a different path

806
00:37:34,020 --> 00:37:36,480
of reality you can try it's the best way

807
00:37:36,480 --> 00:37:38,400
because you just can multiply the same

808
00:37:38,400 --> 00:37:40,619
methodology on multiple Target and so

809
00:37:40,619 --> 00:37:43,980
the don't don't focus on one single

810
00:37:43,980 --> 00:37:46,880
Target it's better

811
00:37:46,880 --> 00:37:48,420
so

812
00:37:48,420 --> 00:37:51,480
then uh I will just encourage you to

813
00:37:51,480 --> 00:37:53,520
just participate even remotely because

814
00:37:53,520 --> 00:37:56,820
you can just uh provide the script to

815
00:37:56,820 --> 00:38:01,020
execute your your exploit and uh it

816
00:38:01,020 --> 00:38:03,420
could be works but in Hardware it's um

817
00:38:03,420 --> 00:38:06,000
slightly difficult like you see uh there

818
00:38:06,000 --> 00:38:08,940
are a lot of uh parameters that could

819
00:38:08,940 --> 00:38:12,000
not work so we prefer to to participate

820
00:38:12,000 --> 00:38:14,040
in the present but

821
00:38:14,040 --> 00:38:16,320
if you have not the money or not the

822
00:38:16,320 --> 00:38:19,680
time to go remote to go on site just to

823
00:38:19,680 --> 00:38:22,079
go remotely and it works

824
00:38:22,079 --> 00:38:25,920
and then remember that failure is always

825
00:38:25,920 --> 00:38:27,180
an option

826
00:38:27,180 --> 00:38:30,618
like you like yours

827
00:38:30,720 --> 00:38:33,480
so uh do you have any question on the

828
00:38:33,480 --> 00:38:35,640
story and if you have uh want to have

829
00:38:35,640 --> 00:38:39,000
more details on our research you can go

830
00:38:39,000 --> 00:38:41,940
to the blog post we have just published

831
00:38:41,940 --> 00:38:43,560
this morning

832
00:38:43,560 --> 00:38:47,000
so thank you

833
00:38:47,000 --> 00:38:50,929
[Applause]

834
00:38:52,920 --> 00:38:57,119
thank you I will q a session now

835
00:38:57,119 --> 00:39:00,000
is there any question

836
00:39:00,000 --> 00:39:02,780
also in the front

837
00:39:03,599 --> 00:39:06,200
okay

838
00:39:06,839 --> 00:39:09,240
thank you very much for your talk first

839
00:39:09,240 --> 00:39:11,940
I don't think you're a failure or that

840
00:39:11,940 --> 00:39:15,420
you failed how you said and one thing

841
00:39:15,420 --> 00:39:18,000
that came from my professional paranoia

842
00:39:18,000 --> 00:39:20,339
it was that since this is a competition

843
00:39:20,339 --> 00:39:23,280
and there are other people involved do

844
00:39:23,280 --> 00:39:24,900
you think someone informed the

845
00:39:24,900 --> 00:39:27,500
manufacturer a borrow about certain

846
00:39:27,500 --> 00:39:30,839
vulnerabilities that were more easily to

847
00:39:30,839 --> 00:39:34,440
find so they would attack indirectly

848
00:39:34,440 --> 00:39:36,839
other competitors yeah it could be a

849
00:39:36,839 --> 00:39:38,700
strategy we have no proof that other

850
00:39:38,700 --> 00:39:41,160
teams did this but uh it's a possibility

851
00:39:41,160 --> 00:39:44,940
and it could be useful if you are quite

852
00:39:44,940 --> 00:39:47,579
sure that you have something unique and

853
00:39:47,579 --> 00:39:50,099
you can just uh drop all of the other

854
00:39:50,099 --> 00:39:53,220
teams by just releasing the trivial

855
00:39:53,220 --> 00:39:55,619
vulnerabilities you found to the to the

856
00:39:55,619 --> 00:39:59,760
vendor hoping it will publish the a not

857
00:39:59,760 --> 00:40:02,700
fix or an upgrade some days before the

858
00:40:02,700 --> 00:40:05,220
contest starts exactly because those

859
00:40:05,220 --> 00:40:07,380
patches seemed very

860
00:40:07,380 --> 00:40:10,619
specific in my opinion maybe they were

861
00:40:10,619 --> 00:40:13,440
not and for instance uh Netgear have a

862
00:40:13,440 --> 00:40:16,920
bug Bunty program so it probably uh just

863
00:40:16,920 --> 00:40:18,500
uh you can

864
00:40:18,500 --> 00:40:21,480
provide a lot of gravity just before by

865
00:40:21,480 --> 00:40:23,040
the broadbently program and then

866
00:40:23,040 --> 00:40:25,800
participate to uh the DI contest and you

867
00:40:25,800 --> 00:40:28,320
have a lot of money so it could be Works

868
00:40:28,320 --> 00:40:29,960
yes the Netgear liability program

869
00:40:29,960 --> 00:40:33,599
rewards were not that not as attractive

870
00:40:33,599 --> 00:40:37,320
as the 0.1 rewards for the same problem

871
00:40:37,320 --> 00:40:40,280
it is I guess so

872
00:40:41,359 --> 00:40:46,339
we don't know thank you

873
00:40:47,040 --> 00:40:50,060
and your result question

874
00:40:51,599 --> 00:40:53,760
hey uh thank you for the great talk so

875
00:40:53,760 --> 00:40:56,040
um what was the potential cash price and

876
00:40:56,040 --> 00:40:58,380
did they offer you anything for uh the

877
00:40:58,380 --> 00:40:59,700
failure

878
00:40:59,700 --> 00:41:01,320
because as far as I know they sometimes

879
00:41:01,320 --> 00:41:03,960
offer some money in any way if you

880
00:41:03,960 --> 00:41:06,119
manage to get a remote code execution

881
00:41:06,119 --> 00:41:09,480
and the uh from the one side it was a

882
00:41:09,480 --> 00:41:12,359
20K yes and from the line sign it was

883
00:41:12,359 --> 00:41:15,839
the the valve so it's 10K and can you

884
00:41:15,839 --> 00:41:17,880
gain both of those prices

885
00:41:17,880 --> 00:41:20,839
sorry can you gain both of those

886
00:41:20,839 --> 00:41:24,180
you can gain both you have to register

887
00:41:24,180 --> 00:41:27,000
for both if you register for the one for

888
00:41:27,000 --> 00:41:29,579
one attempt for for the one side and you

889
00:41:29,579 --> 00:41:31,680
can also register one for the land sign

890
00:41:31,680 --> 00:41:34,800
and you can yeah again both and if you

891
00:41:34,800 --> 00:41:37,020
you can attempt also maybe two or three

892
00:41:37,020 --> 00:41:38,579
varieties on the line sign if they are

893
00:41:38,579 --> 00:41:42,240
unique you get three times 10K

894
00:41:42,240 --> 00:41:43,500
and did they offer you anything

895
00:41:43,500 --> 00:41:46,880
eventually they offer the something

896
00:41:46,880 --> 00:41:51,599
which uh you didn't accept and did you

897
00:41:51,599 --> 00:41:52,859
accept her

898
00:41:52,859 --> 00:41:54,960
um yeah we accepted the mostly to cover

899
00:41:54,960 --> 00:41:58,280
or or cost because we send two people uh

900
00:41:58,280 --> 00:42:02,460
in Toronto but in fact yeah the the this

901
00:42:02,460 --> 00:42:04,920
was not exactly the same amount that you

902
00:42:04,920 --> 00:42:07,320
can gain if you manage to get a remote

903
00:42:07,320 --> 00:42:09,300
code execution during the contest but

904
00:42:09,300 --> 00:42:12,359
yeah we reported all of these Star Labs

905
00:42:12,359 --> 00:42:14,760
privileged a blog post with most of the

906
00:42:14,760 --> 00:42:17,280
venalities also we found we may have

907
00:42:17,280 --> 00:42:20,820
found some extra availabilities but we

908
00:42:20,820 --> 00:42:23,220
are not sure that the startups to did

909
00:42:23,220 --> 00:42:26,299
not publish all the

910
00:42:28,160 --> 00:42:30,420
yes and we are currently in description

911
00:42:30,420 --> 00:42:33,480
with netios for some variety so yeah and

912
00:42:33,480 --> 00:42:36,540
some realities have been reported but uh

913
00:42:36,540 --> 00:42:38,940
yeah not published yet yes

914
00:42:38,940 --> 00:42:41,579
so yeah this was a great experience from

915
00:42:41,579 --> 00:42:43,320
our side because we learned a lot and

916
00:42:43,320 --> 00:42:45,599
from the strategy point of view and also

917
00:42:45,599 --> 00:42:47,280
the technical detail technical point of

918
00:42:47,280 --> 00:42:49,200
view because it was yeah quite

919
00:42:49,200 --> 00:42:51,300
interesting to see that such a router

920
00:42:51,300 --> 00:42:53,820
had so much vulnerabilities and so much

921
00:42:53,820 --> 00:42:56,220
rules uh but in fact

922
00:42:56,220 --> 00:42:59,579
um yeah the strategy was something we

923
00:42:59,579 --> 00:43:02,099
yeah we did not consider at this time

924
00:43:02,099 --> 00:43:03,900
when we started the research on this

925
00:43:03,900 --> 00:43:06,540
device but uh yeah for next uh

926
00:43:06,540 --> 00:43:09,359
one-to-one participation this will yeah

927
00:43:09,359 --> 00:43:11,579
we will take care of this a bit more

928
00:43:11,579 --> 00:43:13,800
than we did last time

929
00:43:13,800 --> 00:43:16,280
thank you

930
00:43:18,119 --> 00:43:21,260
use this question

931
00:43:25,520 --> 00:43:29,640
hi um thanks to since you failed I'm

932
00:43:29,640 --> 00:43:32,300
sorry did uh set the eyes

933
00:43:32,300 --> 00:43:35,040
the Setia is still do the disclosure

934
00:43:35,040 --> 00:43:36,900
process for you and with you or how did

935
00:43:36,900 --> 00:43:40,460
that look like in this case uh

936
00:43:40,460 --> 00:43:42,619
and yes

937
00:43:42,619 --> 00:43:46,640
between us and Netgear

938
00:43:51,780 --> 00:43:53,700
so I think we have time for one more

939
00:43:53,700 --> 00:43:55,619
question here and eventually a second

940
00:43:55,619 --> 00:43:57,780
one we'll see

941
00:43:57,780 --> 00:43:59,880
uh really nice talk thank you very much

942
00:43:59,880 --> 00:44:01,980
uh have you come because you said that

943
00:44:01,980 --> 00:44:03,900
the up the great time took like four and

944
00:44:03,900 --> 00:44:06,300
a half minutes and you had to be really

945
00:44:06,300 --> 00:44:08,400
quick did you consider slimming down the

946
00:44:08,400 --> 00:44:10,020
firmware so it boots faster and stuff

947
00:44:10,020 --> 00:44:12,359
like because you do not need to ship all

948
00:44:12,359 --> 00:44:14,640
the binaries all you need is to get the

949
00:44:14,640 --> 00:44:18,119
light show yes it's it's why uh we um we

950
00:44:18,119 --> 00:44:19,680
are just modified a little bit the

951
00:44:19,680 --> 00:44:22,079
firmware to uh to uh to be at the

952
00:44:22,079 --> 00:44:25,500
earlier reboot and not necessary to just

953
00:44:25,500 --> 00:44:28,319
have a full boot but it takes four

954
00:44:28,319 --> 00:44:30,720
minutes and a half with this technique

955
00:44:30,720 --> 00:44:33,119
but uh with more it's like more five

956
00:44:33,119 --> 00:44:36,359
minutes the side of the firmware doesn't

957
00:44:36,359 --> 00:44:38,880
um yeah it doesn't matter a lot because

958
00:44:38,880 --> 00:44:41,940
the the time spent the the four minutes

959
00:44:41,940 --> 00:44:44,640
and a half is just not a four minutes to

960
00:44:44,640 --> 00:44:46,560
upload the firmware on the 30 seconds to

961
00:44:46,560 --> 00:44:48,900
reboot it's mostly the reboot time so

962
00:44:48,900 --> 00:44:50,640
you have to wait for all the services to

963
00:44:50,640 --> 00:44:53,040
come up again and then this uh this is a

964
00:44:53,040 --> 00:44:55,859
quite long process uh before this binary

965
00:44:55,859 --> 00:44:58,079
is called so yeah we could have

966
00:44:58,079 --> 00:45:00,420
developed a specific kernel in order to

967
00:45:00,420 --> 00:45:04,859
drive the LEDs you know just a shorter

968
00:45:04,859 --> 00:45:08,760
time but uh it was not that easy to

969
00:45:08,760 --> 00:45:11,700
drive gpios without any documentation on

970
00:45:11,700 --> 00:45:15,180
this device so we would have reversed

971
00:45:15,180 --> 00:45:18,180
the hardware part and so on so we since

972
00:45:18,180 --> 00:45:20,460
we were quite in a hurry during this we

973
00:45:20,460 --> 00:45:23,460
just like the timeline mentioned in the

974
00:45:23,460 --> 00:45:26,040
slide we decided to just go to the

975
00:45:26,040 --> 00:45:28,380
simplest solution at this time and since

976
00:45:28,380 --> 00:45:31,079
it yeah it fit in in this five minutes

977
00:45:31,079 --> 00:45:34,020
slot yeah we considered that it was

978
00:45:34,020 --> 00:45:36,660
doable to to expect and just to add a

979
00:45:36,660 --> 00:45:38,700
more Precision uh when you modify a

980
00:45:38,700 --> 00:45:41,339
little bit with firmware uh when we

981
00:45:41,339 --> 00:45:44,220
begin to boot uh we just wait 30 seconds

982
00:45:44,220 --> 00:45:47,720
to have a lecture

983
00:45:47,900 --> 00:45:50,700
okay and the second question quickly

984
00:45:50,700 --> 00:45:54,480
because before organizers they take the

985
00:45:54,480 --> 00:45:56,579
microphone because you said you could

986
00:45:56,579 --> 00:45:59,339
isolate the router from ntp to break

987
00:45:59,339 --> 00:46:02,400
crypto yeah have you considered

988
00:46:02,400 --> 00:46:06,420
using that as a leverage to

989
00:46:06,420 --> 00:46:09,060
you use https and break the

990
00:46:09,060 --> 00:46:11,640
cryptographic communication there

991
00:46:11,640 --> 00:46:15,379
instead of no verify only

992
00:46:17,960 --> 00:46:20,220
I think it's a little bit more

993
00:46:20,220 --> 00:46:22,380
complicated and you're probably you're

994
00:46:22,380 --> 00:46:25,640
like a buzzword like your IA

995
00:46:25,640 --> 00:46:28,920
but uh perhaps but I don't know

996
00:46:28,920 --> 00:46:31,619
I mostly uh yeah breaking crypto with

997
00:46:31,619 --> 00:46:33,540
the control of this uh this date and

998
00:46:33,540 --> 00:46:36,119
time there was another question we had

999
00:46:36,119 --> 00:46:38,480
at this time if it was possible to

1000
00:46:38,480 --> 00:46:41,520
modify the date and the time many times

1001
00:46:41,520 --> 00:46:44,160
during the times so we could Implement

1002
00:46:44,160 --> 00:46:45,780
some kind of grid Force for the values

1003
00:46:45,780 --> 00:46:48,660
but in fact the router only makes one

1004
00:46:48,660 --> 00:46:51,060
ntp request and that's it it was not

1005
00:46:51,060 --> 00:46:53,339
possible to to force the router to

1006
00:46:53,339 --> 00:46:55,020
change its time multiple time so it

1007
00:46:55,020 --> 00:46:57,839
wasn't possible but yes maybe a crypto

1008
00:46:57,839 --> 00:46:59,460
attack may work but we didn't have time

1009
00:46:59,460 --> 00:47:03,859
to to figure it out yeah sure thank you

1010
00:47:03,920 --> 00:47:06,420
well thank you very much I think it's

1011
00:47:06,420 --> 00:47:08,819
time to close this talk uh thank you for

1012
00:47:08,819 --> 00:47:11,560
for this great talk actually

1013
00:47:11,560 --> 00:47:14,630
[Music]

