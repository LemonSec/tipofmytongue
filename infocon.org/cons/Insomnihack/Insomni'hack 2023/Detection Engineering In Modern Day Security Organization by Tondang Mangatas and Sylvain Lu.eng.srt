1
00:00:03,540 --> 00:00:06,000
now we can start a presentation so good

2
00:00:06,000 --> 00:00:08,280
afternoon and I would like to extend my

3
00:00:08,280 --> 00:00:10,740
thanks to the uh even organizer and to

4
00:00:10,740 --> 00:00:13,139
everyone that's here so I am Taz and

5
00:00:13,139 --> 00:00:14,820
this is Sylvia and my friend we are both

6
00:00:14,820 --> 00:00:16,619
not from here as you can tell we're

7
00:00:16,619 --> 00:00:19,080
speaking English uh we are from Canada

8
00:00:19,080 --> 00:00:21,359
and we will be talking about detection

9
00:00:21,359 --> 00:00:24,300
engineering uh and yeah pretty much

10
00:00:24,300 --> 00:00:25,980
everything about it so yeah I'm tasked

11
00:00:25,980 --> 00:00:29,460
I'm working currently at Microsoft I am

12
00:00:29,460 --> 00:00:30,960
one of their security researchers in the

13
00:00:30,960 --> 00:00:34,260
cloud space I am also part of the

14
00:00:34,260 --> 00:00:36,300
collective called the DFI report I think

15
00:00:36,300 --> 00:00:37,500
you probably know about it from Twitter

16
00:00:37,500 --> 00:00:39,840
and also the curator intro member and

17
00:00:39,840 --> 00:00:41,940
Sylvan you can introduce yourself yeah

18
00:00:41,940 --> 00:00:44,940
hey uh good afternoon guys my name is

19
00:00:44,940 --> 00:00:47,640
sylvain uh or silvai if you're

20
00:00:47,640 --> 00:00:50,219
francophone uh I'm currently working as

21
00:00:50,219 --> 00:00:52,020
a security developer for an MDR company

22
00:00:52,020 --> 00:00:53,700
called arctic wolf

23
00:00:53,700 --> 00:00:58,199
um and uh yeah so yeah so let's go uh

24
00:00:58,199 --> 00:01:00,120
next slide please

25
00:01:00,120 --> 00:01:02,039
uh just some disclaimers so anything

26
00:01:02,039 --> 00:01:04,860
that we say is that doesn't represent of

27
00:01:04,860 --> 00:01:08,700
our our employer views and please use

28
00:01:08,700 --> 00:01:10,979
this contents as a guidance not like

29
00:01:10,979 --> 00:01:12,600
ultimate

30
00:01:12,600 --> 00:01:14,460
thing to make everything works it will

31
00:01:14,460 --> 00:01:17,880
not work it's security overall so yeah

32
00:01:17,880 --> 00:01:19,500
and nothing works out of the box right

33
00:01:19,500 --> 00:01:21,659
away right

34
00:01:21,659 --> 00:01:22,920
um yeah so first I'll talk about

35
00:01:22,920 --> 00:01:24,720
detection engineering for organizations

36
00:01:24,720 --> 00:01:26,820
right so just understanding what you

37
00:01:26,820 --> 00:01:28,680
know detection engineering is and what

38
00:01:28,680 --> 00:01:31,560
that looks like in an organization

39
00:01:31,560 --> 00:01:34,140
uh so yeah so you know firstly there's

40
00:01:34,140 --> 00:01:35,579
you know you got to create the detection

41
00:01:35,579 --> 00:01:38,280
manage and improve it uh you know work

42
00:01:38,280 --> 00:01:40,079
on the detections themselves and of

43
00:01:40,079 --> 00:01:42,720
course work on the platform uh but then

44
00:01:42,720 --> 00:01:44,579
ultimately right you'll see that like

45
00:01:44,579 --> 00:01:46,320
it's all about building relations with

46
00:01:46,320 --> 00:01:48,299
your key stakeholders right

47
00:01:48,299 --> 00:01:51,659
um whether it's internal or external

48
00:01:51,659 --> 00:01:52,560
um

49
00:01:52,560 --> 00:01:54,899
and part of detection engineering could

50
00:01:54,899 --> 00:01:57,180
be a dedicated role but we find that

51
00:01:57,180 --> 00:01:59,520
it's kind of like expands from that and

52
00:01:59,520 --> 00:02:01,020
it can include like other roles like

53
00:02:01,020 --> 00:02:02,460
threat hunting or just you know security

54
00:02:02,460 --> 00:02:04,680
engineering as a whole

55
00:02:04,680 --> 00:02:07,079
uh so yeah what are some requirements uh

56
00:02:07,079 --> 00:02:08,639
of course there's many more but these

57
00:02:08,639 --> 00:02:10,619
are some key ones uh at the core of it

58
00:02:10,619 --> 00:02:11,700
you know you need to rely on your

59
00:02:11,700 --> 00:02:13,620
subject matter experts these are the

60
00:02:13,620 --> 00:02:15,900
people that are you know uh key and

61
00:02:15,900 --> 00:02:18,000
vital to uh driving like the operation

62
00:02:18,000 --> 00:02:19,680
right so they need to have environmental

63
00:02:19,680 --> 00:02:21,060
awareness you need to have a good

64
00:02:21,060 --> 00:02:22,739
understanding with the logs and the data

65
00:02:22,739 --> 00:02:24,720
that they're working with the platform

66
00:02:24,720 --> 00:02:26,459
uh and you know have like just

67
00:02:26,459 --> 00:02:28,260
organizational knowledge whether it's

68
00:02:28,260 --> 00:02:30,360
You're Building detection for your uh

69
00:02:30,360 --> 00:02:33,060
internal or just uh for whichever

70
00:02:33,060 --> 00:02:35,220
vertical you want to cover uh they need

71
00:02:35,220 --> 00:02:37,200
to understand the risk and the threat

72
00:02:37,200 --> 00:02:39,959
awareness or like the landscape

73
00:02:39,959 --> 00:02:41,640
um you need to have data right so you

74
00:02:41,640 --> 00:02:43,260
need to work with logs and Telemetry if

75
00:02:43,260 --> 00:02:45,060
you don't have that then you're just

76
00:02:45,060 --> 00:02:47,099
imagining things

77
00:02:47,099 --> 00:02:49,140
um you need to have logs from all all

78
00:02:49,140 --> 00:02:51,060
sorts of data sources

79
00:02:51,060 --> 00:02:52,800
um it's better if you're working with

80
00:02:52,800 --> 00:02:54,599
like a data engineer that can you know

81
00:02:54,599 --> 00:02:57,420
kind of like massage it so that way uh

82
00:02:57,420 --> 00:02:58,500
you have something to work with that's

83
00:02:58,500 --> 00:03:00,599
very easy and of course ideally it's

84
00:03:00,599 --> 00:03:03,239
centralized using a platform such as

85
00:03:03,239 --> 00:03:05,700
like a Sim transition so that it's nice

86
00:03:05,700 --> 00:03:07,379
to have platform Engineers or detection

87
00:03:07,379 --> 00:03:09,420
Engineers uh to support this

88
00:03:09,420 --> 00:03:11,340
infrastructure

89
00:03:11,340 --> 00:03:12,360
um

90
00:03:12,360 --> 00:03:15,420
yeah and then uh of course like you want

91
00:03:15,420 --> 00:03:18,000
to mature this process have like a key

92
00:03:18,000 --> 00:03:20,459
stakeholder key stakeholder involvement

93
00:03:20,459 --> 00:03:22,500
and of course have good relations with

94
00:03:22,500 --> 00:03:23,819
the people that are going to be using

95
00:03:23,819 --> 00:03:26,519
your detections right so that's your

96
00:03:26,519 --> 00:03:29,480
stock or the

97
00:03:29,480 --> 00:03:33,300
mssp or MGR teams that you have so yeah

98
00:03:33,300 --> 00:03:34,319
so

99
00:03:34,319 --> 00:03:37,739
uh who who are part of the the detection

100
00:03:37,739 --> 00:03:40,140
engineering teams uh there's the

101
00:03:40,140 --> 00:03:41,700
researchers so that's what who you

102
00:03:41,700 --> 00:03:43,440
initially think of like as a detection

103
00:03:43,440 --> 00:03:45,599
engineer so like your developers your

104
00:03:45,599 --> 00:03:47,819
threat Hunters uh people that might work

105
00:03:47,819 --> 00:03:50,220
in like dfir or threat Intel analysts

106
00:03:50,220 --> 00:03:53,099
the red teamers uh your vulnerable

107
00:03:53,099 --> 00:03:55,920
vulnerability management teams uh but

108
00:03:55,920 --> 00:03:57,900
you know there's also like uh of course

109
00:03:57,900 --> 00:03:59,640
like the the people that are receiving

110
00:03:59,640 --> 00:04:01,920
the alerts so that's like operations so

111
00:04:01,920 --> 00:04:05,459
your internal sock the MDR mssp uh you

112
00:04:05,459 --> 00:04:06,959
need people to support these These are

113
00:04:06,959 --> 00:04:08,580
honestly like

114
00:04:08,580 --> 00:04:10,439
um the unsung heroes of the whole

115
00:04:10,439 --> 00:04:12,540
detection engineering uh kind of like

116
00:04:12,540 --> 00:04:14,580
function it's your engineers and the

117
00:04:14,580 --> 00:04:16,260
people that do logging right so without

118
00:04:16,260 --> 00:04:19,380
them like honestly like just if you meet

119
00:04:19,380 --> 00:04:21,660
them give them a nice coffee and uh

120
00:04:21,660 --> 00:04:23,520
words of appreciation just because like

121
00:04:23,520 --> 00:04:27,660
they're the people that make it run so

122
00:04:27,660 --> 00:04:29,940
um yeah

123
00:04:29,940 --> 00:04:32,520
uh talking a little bit about the life

124
00:04:32,520 --> 00:04:34,320
cycle task is going to go over kind of

125
00:04:34,320 --> 00:04:36,060
like these steps into like a little bit

126
00:04:36,060 --> 00:04:38,040
more pragmatic or

127
00:04:38,040 --> 00:04:40,500
within an example

128
00:04:40,500 --> 00:04:42,419
adding for this particular one is

129
00:04:42,419 --> 00:04:44,520
specifically for organization so there's

130
00:04:44,520 --> 00:04:46,740
going to be different the perspective as

131
00:04:46,740 --> 00:04:48,479
if you are as a detection engineer like

132
00:04:48,479 --> 00:04:51,240
as we are Developer researcher whatever

133
00:04:51,240 --> 00:04:53,040
they call it and this is like from

134
00:04:53,040 --> 00:04:54,660
organization if you want to implement

135
00:04:54,660 --> 00:04:56,460
detection engineering this is probably

136
00:04:56,460 --> 00:04:58,199
the best way to do it based on

137
00:04:58,199 --> 00:05:00,600
experience of what we had we share so

138
00:05:00,600 --> 00:05:03,620
many experience talk mssp MDR uh so yeah

139
00:05:03,620 --> 00:05:06,780
yeah so um I mean not all of these steps

140
00:05:06,780 --> 00:05:08,340
in here are like things that you do

141
00:05:08,340 --> 00:05:10,620
every single cycle but you know it's

142
00:05:10,620 --> 00:05:12,479
good to uh kitties in mind so of course

143
00:05:12,479 --> 00:05:13,979
you need to have like a proper platform

144
00:05:13,979 --> 00:05:17,280
to work with uh you need to have a work

145
00:05:17,280 --> 00:05:18,600
within like a framework where everyone

146
00:05:18,600 --> 00:05:20,220
agrees on like the terminologies and

147
00:05:20,220 --> 00:05:21,600
such

148
00:05:21,600 --> 00:05:23,419
um have like planning

149
00:05:23,419 --> 00:05:26,880
to some uh data engineering and

150
00:05:26,880 --> 00:05:29,880
selecting like what data you want

151
00:05:29,880 --> 00:05:32,880
um and then do some research in terms of

152
00:05:32,880 --> 00:05:34,919
like uh what threats that you want to

153
00:05:34,919 --> 00:05:36,479
cover right like does it make sense to

154
00:05:36,479 --> 00:05:38,280
cover these threats for your

155
00:05:38,280 --> 00:05:40,500
organization and with the data that you

156
00:05:40,500 --> 00:05:41,880
have

157
00:05:41,880 --> 00:05:43,560
um you know you also want to select

158
00:05:43,560 --> 00:05:44,880
threats that are essentially relevant

159
00:05:44,880 --> 00:05:46,199
right to your

160
00:05:46,199 --> 00:05:49,080
um vertical uh then you want to work on

161
00:05:49,080 --> 00:05:52,860
the implementation testing so you want

162
00:05:52,860 --> 00:05:54,300
to select the appropriate detection

163
00:05:54,300 --> 00:05:56,039
mechanisms we can talk about that a

164
00:05:56,039 --> 00:05:57,600
little bit later

165
00:05:57,600 --> 00:05:59,759
um and you also want to work on the

166
00:05:59,759 --> 00:06:01,680
documentation right so these are like

167
00:06:01,680 --> 00:06:04,320
how you triage it what do you do when

168
00:06:04,320 --> 00:06:06,060
you get an alert how do you respond to

169
00:06:06,060 --> 00:06:08,820
it uh how do you respond to it if it's a

170
00:06:08,820 --> 00:06:10,080
false positive right because you're

171
00:06:10,080 --> 00:06:12,120
going to have a lot of those

172
00:06:12,120 --> 00:06:13,080
um

173
00:06:13,080 --> 00:06:15,300
and some details on like the threats

174
00:06:15,300 --> 00:06:17,639
itself what what can they do and yeah

175
00:06:17,639 --> 00:06:20,699
just some additional details

176
00:06:20,699 --> 00:06:24,120
uh oh sorry I'm just uh you also this is

177
00:06:24,120 --> 00:06:27,180
a uh you know it's a buzzer but the cicd

178
00:06:27,180 --> 00:06:29,039
is it is important like these detections

179
00:06:29,039 --> 00:06:32,039
but

180
00:06:32,639 --> 00:06:34,500
um once you like send a detection into

181
00:06:34,500 --> 00:06:36,419
production you know it's not done from

182
00:06:36,419 --> 00:06:38,220
there right like you need to make sure

183
00:06:38,220 --> 00:06:41,120
that uh it's still relevant that the uh

184
00:06:41,120 --> 00:06:43,740
the metrics are good like in terms of

185
00:06:43,740 --> 00:06:46,500
false positive to True positive

186
00:06:46,500 --> 00:06:47,280
um

187
00:06:47,280 --> 00:06:49,199
also you want to validate that you're

188
00:06:49,199 --> 00:06:51,720
getting some true positives right so uh

189
00:06:51,720 --> 00:06:53,819
that's like a very important thing

190
00:06:53,819 --> 00:06:56,220
um so yeah

191
00:06:56,220 --> 00:06:58,080
okay so here we're going to talk about

192
00:06:58,080 --> 00:06:59,400
detection engineering for the

193
00:06:59,400 --> 00:07:01,440
individuals so like what can you do to

194
00:07:01,440 --> 00:07:03,900
uh you know get involved and maybe you

195
00:07:03,900 --> 00:07:05,580
don't even know it already but you might

196
00:07:05,580 --> 00:07:07,440
be already involved

197
00:07:07,440 --> 00:07:08,280
um

198
00:07:08,280 --> 00:07:10,259
so yeah this is a

199
00:07:10,259 --> 00:07:11,580
I don't know if you made it up or it's

200
00:07:11,580 --> 00:07:14,460
my quote yeah okay so it's quote so

201
00:07:14,460 --> 00:07:16,979
Master one or two understand some know

202
00:07:16,979 --> 00:07:18,360
the rest right when we say know the rest

203
00:07:18,360 --> 00:07:20,940
it's like at least like recognize the

204
00:07:20,940 --> 00:07:23,099
buzzwords and like have a good idea of

205
00:07:23,099 --> 00:07:26,340
like maybe which direction that's going

206
00:07:26,340 --> 00:07:29,039
into right um You may not be an expert

207
00:07:29,039 --> 00:07:32,280
in it but it's good to have the context

208
00:07:32,280 --> 00:07:33,780
um and that's kind of like what we feel

209
00:07:33,780 --> 00:07:35,580
like the modern day threat analyst is

210
00:07:35,580 --> 00:07:36,720
like

211
00:07:36,720 --> 00:07:38,759
um like the good ones that we see like

212
00:07:38,759 --> 00:07:40,440
these don't just stick to you know

213
00:07:40,440 --> 00:07:42,300
responding to tickets and just doing

214
00:07:42,300 --> 00:07:44,460
like the peer security analyst work they

215
00:07:44,460 --> 00:07:46,080
also maybe get involved in like the

216
00:07:46,080 --> 00:07:48,120
incident response aspect uh they might

217
00:07:48,120 --> 00:07:49,380
do like their own threat intelligence

218
00:07:49,380 --> 00:07:52,440
and you know uh see uh what what's out

219
00:07:52,440 --> 00:07:54,539
there and understand like what they

220
00:07:54,539 --> 00:07:55,979
should be on the lookout for maybe

221
00:07:55,979 --> 00:07:57,479
they'll be more proactive and do some

222
00:07:57,479 --> 00:08:00,180
threat hunting but also be engaged in

223
00:08:00,180 --> 00:08:02,220
the detection engineering Pipeline and

224
00:08:02,220 --> 00:08:04,199
process yeah maybe a quick poll like

225
00:08:04,199 --> 00:08:07,080
who's here from The Blue Team sock MDR

226
00:08:07,080 --> 00:08:09,840
mssb put your hands up so you'll

227
00:08:09,840 --> 00:08:12,240
probably see like this role like it's

228
00:08:12,240 --> 00:08:15,060
the the line is blur like one person do

229
00:08:15,060 --> 00:08:17,280
multiple of this right so that's that's

230
00:08:17,280 --> 00:08:19,319
kind of the idea of modern analysts

231
00:08:19,319 --> 00:08:21,120
you're not like just managing ticket

232
00:08:21,120 --> 00:08:22,979
you're doing pretty much everything and

233
00:08:22,979 --> 00:08:25,680
you gotta be ready for it so yeah yeah

234
00:08:25,680 --> 00:08:28,440
so

235
00:08:28,440 --> 00:08:30,300
um yeah just to maybe uh focus on like

236
00:08:30,300 --> 00:08:33,120
three aspects uh the threat the data and

237
00:08:33,120 --> 00:08:34,740
the detection these are things that you

238
00:08:34,740 --> 00:08:36,899
want to keep in mind when uh getting

239
00:08:36,899 --> 00:08:39,240
involved in detection engineering

240
00:08:39,240 --> 00:08:41,700
um I don't know if that's clear for you

241
00:08:41,700 --> 00:08:44,880
guys but this is uh just a sample uh job

242
00:08:44,880 --> 00:08:48,540
posting on LinkedIn for Uber this is a

243
00:08:48,540 --> 00:08:50,160
job posting from Uber a few days after

244
00:08:50,160 --> 00:08:51,779
they get breached so a little bit too

245
00:08:51,779 --> 00:08:54,120
late but it's a good it's a good job

246
00:08:54,120 --> 00:08:55,920
description I used to wear all the time

247
00:08:55,920 --> 00:08:57,600
I don't hate Uber or anything

248
00:08:57,600 --> 00:09:00,600
disclaimers yeah

249
00:09:00,600 --> 00:09:02,640
um yeah so like uh just to highlight the

250
00:09:02,640 --> 00:09:04,260
three points that we mentioned earlier

251
00:09:04,260 --> 00:09:06,120
right so one of them is uh you need

252
00:09:06,120 --> 00:09:08,700
they're looking for people that have

253
00:09:08,700 --> 00:09:10,260
knowledge or in-depth knowledge in the

254
00:09:10,260 --> 00:09:12,839
data right so whatever data sources that

255
00:09:12,839 --> 00:09:15,480
uh they might have uh have a good

256
00:09:15,480 --> 00:09:16,740
understanding like detection and

257
00:09:16,740 --> 00:09:18,839
detection mechanisms uh we'll talk about

258
00:09:18,839 --> 00:09:22,140
that also afterwards and of course like

259
00:09:22,140 --> 00:09:23,880
have some familiarity with like the

260
00:09:23,880 --> 00:09:26,220
current threat landscape right

261
00:09:26,220 --> 00:09:27,720
um so yeah

262
00:09:27,720 --> 00:09:29,700
see

263
00:09:29,700 --> 00:09:32,160
okay let's talk first about threats or

264
00:09:32,160 --> 00:09:35,399
gtps and risks right so uh there's a lot

265
00:09:35,399 --> 00:09:37,440
of great resources out there

266
00:09:37,440 --> 00:09:39,779
um from our experience we found that

267
00:09:39,779 --> 00:09:41,580
like the matter attack framework is

268
00:09:41,580 --> 00:09:43,560
probably like the gold standard right

269
00:09:43,560 --> 00:09:45,959
now like everyone speaks like miter or

270
00:09:45,959 --> 00:09:48,360
the TTP so it's very easy to communicate

271
00:09:48,360 --> 00:09:50,160
with but where you can learn about

272
00:09:50,160 --> 00:09:51,959
threats that might be more relevant to

273
00:09:51,959 --> 00:09:53,220
you is maybe from your previous

274
00:09:53,220 --> 00:09:55,740
incidents or breaches or

275
00:09:55,740 --> 00:09:56,760
um you know could be you could learn

276
00:09:56,760 --> 00:09:58,320
from other incidents and breaches that

277
00:09:58,320 --> 00:10:00,540
in your industry that are relevant to

278
00:10:00,540 --> 00:10:01,620
you

279
00:10:01,620 --> 00:10:02,279
um

280
00:10:02,279 --> 00:10:04,620
but yeah so understanding the threat is

281
00:10:04,620 --> 00:10:06,899
knowing what to detect right

282
00:10:06,899 --> 00:10:08,760
um

283
00:10:08,760 --> 00:10:11,000
yeah yeah I think to add to that right

284
00:10:11,000 --> 00:10:13,380
sure you can have like kernel

285
00:10:13,380 --> 00:10:15,660
exploitation on the wall on Linux but

286
00:10:15,660 --> 00:10:17,339
you don't use Linux does that really

287
00:10:17,339 --> 00:10:19,080
matter to you so it's like understanding

288
00:10:19,080 --> 00:10:21,779
what's right applies to you if it's just

289
00:10:21,779 --> 00:10:24,899
the usual BEC phishing it's still

290
00:10:24,899 --> 00:10:26,820
something that you want to look into

291
00:10:26,820 --> 00:10:29,640
more compared to some fancy exploitation

292
00:10:29,640 --> 00:10:32,160
so just some notes on that

293
00:10:32,160 --> 00:10:34,500
yeah speaking of PC so

294
00:10:34,500 --> 00:10:38,399
um this is a um a email compromise so

295
00:10:38,399 --> 00:10:41,279
email server compromise just a very high

296
00:10:41,279 --> 00:10:43,440
level and the attacker is trying to

297
00:10:43,440 --> 00:10:45,180
exploit their uh

298
00:10:45,180 --> 00:10:49,260
like their mailbox to deliver spam

299
00:10:49,260 --> 00:10:51,180
um maybe it's very quickly just trying

300
00:10:51,180 --> 00:10:53,519
to like identify maybe brainstorm on

301
00:10:53,519 --> 00:10:55,019
like what types of detections that you

302
00:10:55,019 --> 00:10:56,399
want we'll probably ask you guys for

303
00:10:56,399 --> 00:10:58,620
some uh maybe suggestions or some ideas

304
00:10:58,620 --> 00:11:01,320
and yeah so for example you see some

305
00:11:01,320 --> 00:11:02,760
somebody get fish in your organization

306
00:11:02,760 --> 00:11:04,980
you want to know how they get fish how

307
00:11:04,980 --> 00:11:06,420
do you open the attachment how do you

308
00:11:06,420 --> 00:11:08,519
find open the OneNote file arrival right

309
00:11:08,519 --> 00:11:10,140
so you transfer back through your logs

310
00:11:10,140 --> 00:11:11,459
you check your email logs where they

311
00:11:11,459 --> 00:11:13,200
come from who's the sender are they

312
00:11:13,200 --> 00:11:15,600
sending it to other people so the idea

313
00:11:15,600 --> 00:11:17,040
is to understand the threat is to

314
00:11:17,040 --> 00:11:19,019
explore so incident response is a big

315
00:11:19,019 --> 00:11:22,860
part of it for example so you can look

316
00:11:22,860 --> 00:11:24,600
in the bigger picture and you determine

317
00:11:24,600 --> 00:11:26,220
okay this is the steps will attack which

318
00:11:26,220 --> 00:11:28,740
is like pretty much like miter attack uh

319
00:11:28,740 --> 00:11:31,560
the kill chain but this is like uh you

320
00:11:31,560 --> 00:11:35,119
have to tailor it to your needs

321
00:11:35,820 --> 00:11:38,880
so maybe getting to more details so

322
00:11:38,880 --> 00:11:41,459
speaking of data and logs in Telemetry

323
00:11:41,459 --> 00:11:43,800
uh so we've identified kind of like

324
00:11:43,800 --> 00:11:46,260
maybe three types or three uh surfaces

325
00:11:46,260 --> 00:11:48,720
if you will uh so there's Network right

326
00:11:48,720 --> 00:11:51,240
those are like your firewalls and like

327
00:11:51,240 --> 00:11:52,440
well actually I'll give you some

328
00:11:52,440 --> 00:11:54,480
examples later but there's host and

329
00:11:54,480 --> 00:11:55,860
there's Cloud these are kind of like the

330
00:11:55,860 --> 00:11:59,160
three major areas of of logs that you

331
00:11:59,160 --> 00:12:01,680
can look into and understanding the data

332
00:12:01,680 --> 00:12:02,880
is really important because that's no

333
00:12:02,880 --> 00:12:04,800
you need to know where you can detect

334
00:12:04,800 --> 00:12:07,500
the threat right

335
00:12:07,500 --> 00:12:10,019
um so yeah so some examples for some uh

336
00:12:10,019 --> 00:12:11,760
Network logs so there's all sorts of

337
00:12:11,760 --> 00:12:14,640
appliances uh so firewall anti-ddos load

338
00:12:14,640 --> 00:12:18,720
balancer uh router uh and DNS right so

339
00:12:18,720 --> 00:12:22,680
and nids uh yeah

340
00:12:22,680 --> 00:12:26,579
and for uh host or uh endpoint logs

341
00:12:26,579 --> 00:12:30,899
there's like his EDR AV logs right so uh

342
00:12:30,899 --> 00:12:32,880
one that's pretty popular is like sysmon

343
00:12:32,880 --> 00:12:36,440
uh OS query MD and you know you can also

344
00:12:36,440 --> 00:12:40,800
use EDR logs from your vendor of choice

345
00:12:40,800 --> 00:12:43,320
right uh but what's important about

346
00:12:43,320 --> 00:12:46,019
these logs is that it's uh hosts kind of

347
00:12:46,019 --> 00:12:48,060
like Telemetry so like you get process

348
00:12:48,060 --> 00:12:50,459
activity that's really important uh file

349
00:12:50,459 --> 00:12:53,700
activity registry key activity

350
00:12:53,700 --> 00:12:55,500
um and sure they'll include some network

351
00:12:55,500 --> 00:12:57,839
activity as well some then you'll also

352
00:12:57,839 --> 00:13:01,560
want some uh like host specific logs but

353
00:13:01,560 --> 00:13:04,320
like yeah so Windows have their own uh

354
00:13:04,320 --> 00:13:05,760
ambient for like Powershell and such

355
00:13:05,760 --> 00:13:10,260
Linux Mac OS if you have those

356
00:13:10,260 --> 00:13:11,040
um

357
00:13:11,040 --> 00:13:13,079
yeah so

358
00:13:13,079 --> 00:13:15,959
uh let's see for cloud yeah so cloud is

359
00:13:15,959 --> 00:13:18,540
a little bit more uh new and it's a

360
00:13:18,540 --> 00:13:20,040
little bit more uh actually I gotta talk

361
00:13:20,040 --> 00:13:22,200
to it yeah his side is like uh endpoint

362
00:13:22,200 --> 00:13:24,779
inside so don't don't blame him uh so

363
00:13:24,779 --> 00:13:27,060
yeah for for the clouds it's uh cloud is

364
00:13:27,060 --> 00:13:29,339
just like someone else server right you

365
00:13:29,339 --> 00:13:31,680
don't have visibility to it uh you just

366
00:13:31,680 --> 00:13:33,540
trust whatever logs they have so just

367
00:13:33,540 --> 00:13:35,459
look into it you can submit like if you

368
00:13:35,459 --> 00:13:37,260
need to know more information about it

369
00:13:37,260 --> 00:13:39,420
but the main one that we use these days

370
00:13:39,420 --> 00:13:42,120
like a lot of people use Azure 80 OCTA

371
00:13:42,120 --> 00:13:44,700
uh some other authentication application

372
00:13:44,700 --> 00:13:48,120
so uh the logs will be as important as

373
00:13:48,120 --> 00:13:51,060
the like the on-premise 80. so we're

374
00:13:51,060 --> 00:13:52,500
talking about rubber roasting they can

375
00:13:52,500 --> 00:13:54,300
do Kerber roasting on the card not

376
00:13:54,300 --> 00:13:55,560
really crab rushing but something else

377
00:13:55,560 --> 00:13:58,139
like the golden Samo and all the stuff

378
00:13:58,139 --> 00:13:59,399
but it's kind of like similar it's

379
00:13:59,399 --> 00:14:01,500
similar mentality understanding those

380
00:14:01,500 --> 00:14:04,260
logs and then user admin activity okay

381
00:14:04,260 --> 00:14:06,480
we change the user password we reset the

382
00:14:06,480 --> 00:14:09,060
password where when who uh which IP

383
00:14:09,060 --> 00:14:11,519
address and then for like Microsoft

384
00:14:11,519 --> 00:14:13,440
there like Cloud security solution so

385
00:14:13,440 --> 00:14:17,940
like uh caspi or some other things uh

386
00:14:17,940 --> 00:14:21,360
like even also like uh DLP Solution on

387
00:14:21,360 --> 00:14:22,740
the cloud so those are things that you

388
00:14:22,740 --> 00:14:25,680
can also look into because uh if you're

389
00:14:25,680 --> 00:14:27,899
uh you know connecting all the dots of

390
00:14:27,899 --> 00:14:29,760
the attacks you need to look from

391
00:14:29,760 --> 00:14:32,220
different perspective uh if you're able

392
00:14:32,220 --> 00:14:34,260
to but you should start from one point

393
00:14:34,260 --> 00:14:38,399
and then Cloud app so the emails uh uh

394
00:14:38,399 --> 00:14:40,980
the what other tools authentication

395
00:14:40,980 --> 00:14:42,959
right no no authentication it's more

396
00:14:42,959 --> 00:14:46,199
like the apps like even excels words uh

397
00:14:46,199 --> 00:14:49,320
SharePoint if someone xfill file from

398
00:14:49,320 --> 00:14:51,060
SharePoint you can see it on the log so

399
00:14:51,060 --> 00:14:52,500
that's that's one thing that you want to

400
00:14:52,500 --> 00:14:54,720
pay attention again it's almost the same

401
00:14:54,720 --> 00:14:57,120
it's like kind of like endpoint but uh

402
00:14:57,120 --> 00:14:59,519
on the cloud I guess and yeah

403
00:14:59,519 --> 00:15:01,680
thank you

404
00:15:01,680 --> 00:15:03,540
so yeah so the detection so these are

405
00:15:03,540 --> 00:15:05,699
kind of like the mechanisms for uh

406
00:15:05,699 --> 00:15:08,160
detecting the the threat right so it

407
00:15:08,160 --> 00:15:09,600
depends on your data depends on your

408
00:15:09,600 --> 00:15:11,399
Tech stack and what's uh how much

409
00:15:11,399 --> 00:15:13,260
resources you have can be simple or

410
00:15:13,260 --> 00:15:14,519
complex right you can just work with

411
00:15:14,519 --> 00:15:17,820
like basic iocs and you should at the

412
00:15:17,820 --> 00:15:19,680
very start at least

413
00:15:19,680 --> 00:15:20,880
um then you want to move on to like

414
00:15:20,880 --> 00:15:24,420
working on detecting on like ttps right

415
00:15:24,420 --> 00:15:26,699
um and there's definitely different

416
00:15:26,699 --> 00:15:28,380
mechanisms for that like correlation

417
00:15:28,380 --> 00:15:31,620
some dashboards uh thresholds right

418
00:15:31,620 --> 00:15:34,220
using some ml

419
00:15:34,220 --> 00:15:37,079
algorithms algorithms and such but yeah

420
00:15:37,079 --> 00:15:38,760
so to understanding the detection right

421
00:15:38,760 --> 00:15:41,519
you need that's essentially to know how

422
00:15:41,519 --> 00:15:44,120
to detect it so

423
00:15:44,120 --> 00:15:47,100
oh yeah so uh back to this example so

424
00:15:47,100 --> 00:15:50,279
any uh any takers on some ideas on what

425
00:15:50,279 --> 00:15:53,160
we can detect if anyone has experience

426
00:15:53,160 --> 00:15:55,740
with cloud or anything you see two steps

427
00:15:55,740 --> 00:15:57,300
anything

428
00:15:57,300 --> 00:15:59,579
is fine

429
00:15:59,579 --> 00:16:03,300
going once twice third let's go yeah

430
00:16:03,300 --> 00:16:06,300
uh

431
00:16:08,600 --> 00:16:11,699
it's actually me uh yeah so for example

432
00:16:11,699 --> 00:16:15,300
uh on the login as I mentioned just like

433
00:16:15,300 --> 00:16:18,839
uh on-premise ad you can see like who's

434
00:16:18,839 --> 00:16:21,060
logging in which IP so here we can

435
00:16:21,060 --> 00:16:23,699
detect unusual login on Azure ad locks

436
00:16:23,699 --> 00:16:26,760
Microsoft provided actually like alerts

437
00:16:26,760 --> 00:16:28,740
on that but you can build on top of that

438
00:16:28,740 --> 00:16:29,940
too if you have seen we can actually

439
00:16:29,940 --> 00:16:32,000
ship Deluxe crcm you can make your own

440
00:16:32,000 --> 00:16:35,940
correlation uh you can uh you know like

441
00:16:35,940 --> 00:16:39,000
make a deny list on certain range of IP

442
00:16:39,000 --> 00:16:41,339
addresses I don't know maybe from ovah

443
00:16:41,339 --> 00:16:45,019
or from some countries and then on the

444
00:16:45,019 --> 00:16:48,480
application side uh malicious all so

445
00:16:48,480 --> 00:16:52,019
it's a lot is like uh pretty much uh you

446
00:16:52,019 --> 00:16:53,459
know like the login things that they do

447
00:16:53,459 --> 00:16:55,860
so they contact Microsoft hey this is is

448
00:16:55,860 --> 00:16:57,779
this user access can I log into these

449
00:16:57,779 --> 00:16:59,779
apps and then blah blah blah blah blah

450
00:16:59,779 --> 00:17:03,480
uh yeah so all of those activities who's

451
00:17:03,480 --> 00:17:05,520
requesting tickets Etc they have the

452
00:17:05,520 --> 00:17:06,599
lock so

453
00:17:06,599 --> 00:17:08,459
it's not easy things to do I don't even

454
00:17:08,459 --> 00:17:10,500
understand about that I'm working more

455
00:17:10,500 --> 00:17:12,839
on the email side on Microsoft but if

456
00:17:12,839 --> 00:17:14,459
you have spent some time to explore that

457
00:17:14,459 --> 00:17:16,859
that will be a great detection because

458
00:17:16,859 --> 00:17:19,439
if you stop it on the first one or on

459
00:17:19,439 --> 00:17:21,119
the second one it doesn't really care

460
00:17:21,119 --> 00:17:22,740
about the rest like because they're

461
00:17:22,740 --> 00:17:24,240
stopped right like you don't you don't

462
00:17:24,240 --> 00:17:26,459
need to spend more resources on the

463
00:17:26,459 --> 00:17:29,280
detecting the other stuff so we get the

464
00:17:29,280 --> 00:17:31,380
third one is a creation of email

465
00:17:31,380 --> 00:17:33,780
connectors so like application

466
00:17:33,780 --> 00:17:36,419
have a connectors they call it so it's a

467
00:17:36,419 --> 00:17:38,220
capability to do something on some other

468
00:17:38,220 --> 00:17:41,039
tools uh in this style in this

469
00:17:41,039 --> 00:17:42,900
particular example so the

470
00:17:42,900 --> 00:17:45,900
the application can send emails using

471
00:17:45,900 --> 00:17:48,539
Outlook so if you identify

472
00:17:48,539 --> 00:17:50,160
an application creating that and then

473
00:17:50,160 --> 00:17:52,440
you ask your admins who did this is this

474
00:17:52,440 --> 00:17:55,020
our work if not then it's something

475
00:17:55,020 --> 00:17:57,600
fishy and you can create detection there

476
00:17:57,600 --> 00:17:59,520
you can stop it there if you're unable

477
00:17:59,520 --> 00:18:02,160
to stop it in the other two or if one of

478
00:18:02,160 --> 00:18:03,900
your detection is broken it's always the

479
00:18:03,900 --> 00:18:06,360
case it's always broken uh and then

480
00:18:06,360 --> 00:18:09,059
lastly you can detect like initial ad

481
00:18:09,059 --> 00:18:11,880
run from email logs so doesn't have to

482
00:18:11,880 --> 00:18:13,740
be Outlook could be your Gmail could be

483
00:18:13,740 --> 00:18:17,640
your own email system but there's there

484
00:18:17,640 --> 00:18:19,080
these are the places that you can

485
00:18:19,080 --> 00:18:22,220
actually play around with

486
00:18:22,460 --> 00:18:26,820
and yeah let's let's uh let's do like a

487
00:18:26,820 --> 00:18:28,919
walkthrough as a detection engineer like

488
00:18:28,919 --> 00:18:31,740
what will you do uh while you're doing

489
00:18:31,740 --> 00:18:34,440
the texting engineering so there are uh

490
00:18:34,440 --> 00:18:37,260
six steps uh pretty similar to the one

491
00:18:37,260 --> 00:18:39,480
with the in the organization sites so

492
00:18:39,480 --> 00:18:41,400
here you'll do preparation I will talk

493
00:18:41,400 --> 00:18:43,860
about it more we do threat research so

494
00:18:43,860 --> 00:18:47,460
threat research uh it's can we skip

495
00:18:47,460 --> 00:18:49,320
really easy there's like a lot of Open

496
00:18:49,320 --> 00:18:51,600
Source resources these days uh same with

497
00:18:51,600 --> 00:18:54,000
the detection research uh

498
00:18:54,000 --> 00:18:56,520
so that can go fairly quick and then

499
00:18:56,520 --> 00:18:57,960
implementation is going to take the

500
00:18:57,960 --> 00:18:59,400
longest especially if you have no

501
00:18:59,400 --> 00:19:01,500
platform at all it's going to take some

502
00:19:01,500 --> 00:19:02,820
time to implement it and then

503
00:19:02,820 --> 00:19:05,160
documentation and CI CD which is

504
00:19:05,160 --> 00:19:06,900
continuous Improvement and continuous

505
00:19:06,900 --> 00:19:07,919
development

506
00:19:07,919 --> 00:19:09,480
yeah well I would say for the threat

507
00:19:09,480 --> 00:19:11,520
research like uh maybe not skipped in

508
00:19:11,520 --> 00:19:13,140
type but like it's a good Kickstarter

509
00:19:13,140 --> 00:19:14,880
right like you'll definitely want to

510
00:19:14,880 --> 00:19:17,160
leverage these open sources open source

511
00:19:17,160 --> 00:19:18,900
tools or depressions that's out there

512
00:19:18,900 --> 00:19:22,080
yeah so preparation uh the idea of

513
00:19:22,080 --> 00:19:24,720
detection engineering is uh your

514
00:19:24,720 --> 00:19:27,600
detection have to be proven to catch

515
00:19:27,600 --> 00:19:29,640
those attacks

516
00:19:29,640 --> 00:19:33,480
and also not catching everything else so

517
00:19:33,480 --> 00:19:35,039
the the best way is to have a lab

518
00:19:35,039 --> 00:19:36,780
environment or maybe like a one machine

519
00:19:36,780 --> 00:19:38,280
in your network that you can play around

520
00:19:38,280 --> 00:19:40,860
with and has to be in a clean state so

521
00:19:40,860 --> 00:19:43,320
there are no malware already running in

522
00:19:43,320 --> 00:19:45,360
there changing the registry key and such

523
00:19:45,360 --> 00:19:47,520
uh and then you make sure all your

524
00:19:47,520 --> 00:19:49,380
logging tools are capturing the activity

525
00:19:49,380 --> 00:19:51,900
so for example use this one and you

526
00:19:51,900 --> 00:19:53,340
check your sim you're not seeing system

527
00:19:53,340 --> 00:19:55,559
unlocks don't even move forward anywhere

528
00:19:55,559 --> 00:19:57,660
you just try to fix why the system is

529
00:19:57,660 --> 00:20:00,299
not sending the logs uh and then yeah

530
00:20:00,299 --> 00:20:01,620
from there you can decide which lock

531
00:20:01,620 --> 00:20:03,900
you're going to use scoping is important

532
00:20:03,900 --> 00:20:06,960
especially like uh yeah like how long

533
00:20:06,960 --> 00:20:09,299
you want to scope the detection what's

534
00:20:09,299 --> 00:20:11,340
our coverage is it the whole company is

535
00:20:11,340 --> 00:20:13,559
it one business unit especially if

536
00:20:13,559 --> 00:20:15,660
you're in the mssp or like MDR

537
00:20:15,660 --> 00:20:17,880
Consulting business you might want to

538
00:20:17,880 --> 00:20:19,740
split it in different sets of companies

539
00:20:19,740 --> 00:20:21,600
uh

540
00:20:21,600 --> 00:20:23,820
yeah so there's a blog post by Specter

541
00:20:23,820 --> 00:20:27,200
Ops it's really good on deciding how to

542
00:20:27,200 --> 00:20:31,740
uh prioritize the detection

543
00:20:31,740 --> 00:20:34,679
so for this example uh we're gonna talk

544
00:20:34,679 --> 00:20:36,900
about how we are detecting or like how

545
00:20:36,900 --> 00:20:38,820
we are building detection for info

546
00:20:38,820 --> 00:20:40,919
sharefinder if you don't know infoction

547
00:20:40,919 --> 00:20:43,620
finder is a tool that is allow you to

548
00:20:43,620 --> 00:20:46,380
explore uh different shares in the

549
00:20:46,380 --> 00:20:48,260
network this is part of

550
00:20:48,260 --> 00:20:50,000
[Music]

551
00:20:50,000 --> 00:20:53,039
another Tool uh power supply power

552
00:20:53,039 --> 00:20:56,700
supply yes so you can see stuff you can

553
00:20:56,700 --> 00:20:59,120
see traces on network side on whole side

554
00:20:59,120 --> 00:21:02,580
uh for in this example my Organization

555
00:21:02,580 --> 00:21:05,160
for example we want to detect this we

556
00:21:05,160 --> 00:21:07,440
are trying to cover Discovery ttps right

557
00:21:07,440 --> 00:21:09,299
now

558
00:21:09,299 --> 00:21:13,020
uh yeah so I just go so the fir report

559
00:21:13,020 --> 00:21:16,080
it's a website or like a team that

560
00:21:16,080 --> 00:21:19,799
shares different uh traces of malware

561
00:21:19,799 --> 00:21:23,880
attacks so I look up for infraction

562
00:21:23,880 --> 00:21:26,820
finder in their repository and iPhone at

563
00:21:26,820 --> 00:21:29,700
least six articles so I guess this is

564
00:21:29,700 --> 00:21:31,020
pretty prominent threats for my

565
00:21:31,020 --> 00:21:32,940
organization

566
00:21:32,940 --> 00:21:35,760
and yeah and I do research uh what is

567
00:21:35,760 --> 00:21:38,159
what what exactly happening when

568
00:21:38,159 --> 00:21:41,100
somebody say when someone run uh the

569
00:21:41,100 --> 00:21:43,980
tools itself so you need to know how to

570
00:21:43,980 --> 00:21:46,320
run it properly uh

571
00:21:46,320 --> 00:21:48,000
and you need to learn it sometimes you

572
00:21:48,000 --> 00:21:51,059
can even ask for some other team to run

573
00:21:51,059 --> 00:21:54,900
it like the red teams pen testers

574
00:21:54,900 --> 00:21:56,640
and then you see the behaviors of the

575
00:21:56,640 --> 00:21:59,820
tools what can you see from your logs in

576
00:21:59,820 --> 00:22:00,900
this case we're going to check the

577
00:22:00,900 --> 00:22:03,299
network and the host and then what a

578
00:22:03,299 --> 00:22:05,280
successful operation looks like does it

579
00:22:05,280 --> 00:22:07,559
generate like a file does it alter

580
00:22:07,559 --> 00:22:10,980
something in the system and yeah and you

581
00:22:10,980 --> 00:22:12,659
can also do code review so it's an open

582
00:22:12,659 --> 00:22:14,400
source tool so you can see like what

583
00:22:14,400 --> 00:22:18,380
component of the tool or the tool itself

584
00:22:18,659 --> 00:22:22,200
so on in this share finder uh so in

585
00:22:22,200 --> 00:22:24,299
function finder is part of the power

586
00:22:24,299 --> 00:22:27,020
supply which is a Powershell based tools

587
00:22:27,020 --> 00:22:30,480
uh or power for you so you know it's

588
00:22:30,480 --> 00:22:32,820
using Powershell and you know there's a

589
00:22:32,820 --> 00:22:35,460
lock for Powershell and yeah you just

590
00:22:35,460 --> 00:22:37,020
that's that's the first question that

591
00:22:37,020 --> 00:22:39,299
we're gonna ask like okay can we see

592
00:22:39,299 --> 00:22:42,059
anything from powershare uh based on the

593
00:22:42,059 --> 00:22:45,120
open source resource on the code it has

594
00:22:45,120 --> 00:22:48,059
Elias called find domain share so what

595
00:22:48,059 --> 00:22:49,919
if attacked her instead of typing info

596
00:22:49,919 --> 00:22:52,860
sharefinder they type this uh is that

597
00:22:52,860 --> 00:22:55,440
within your scope or not and the

598
00:22:55,440 --> 00:22:59,179
function is to enumerate file share

599
00:22:59,400 --> 00:23:01,500
so yeah so this is this is I'm running

600
00:23:01,500 --> 00:23:05,340
the 84 sharefinder in the lab so I can

601
00:23:05,340 --> 00:23:07,620
generate it the txt file with all the

602
00:23:07,620 --> 00:23:10,440
domains in there uh so yeah it's just

603
00:23:10,440 --> 00:23:14,240
like making sure I run it properly

604
00:23:14,299 --> 00:23:16,860
and then detection research should go is

605
00:23:16,860 --> 00:23:19,400
to you know detect the tools without

606
00:23:19,400 --> 00:23:21,539
introducing false positive or false

607
00:23:21,539 --> 00:23:24,179
negative uh you you need to decide the

608
00:23:24,179 --> 00:23:26,820
scope again uh and then yeah review the

609
00:23:26,820 --> 00:23:28,559
logs so just keep going I think it's

610
00:23:28,559 --> 00:23:30,620
just the same thing

611
00:23:30,620 --> 00:23:33,059
uh so for example for Powershell okay

612
00:23:33,059 --> 00:23:36,179
there is a partial locks uh it's from

613
00:23:36,179 --> 00:23:40,200
Windows 4104 4103 uh we'll talk about it

614
00:23:40,200 --> 00:23:43,679
on the next slide more uh but on the DFI

615
00:23:43,679 --> 00:23:45,659
report the six articles that I mentioned

616
00:23:45,659 --> 00:23:48,780
I see something interesting uh that it's

617
00:23:48,780 --> 00:23:50,940
actually launched by Beacon and when

618
00:23:50,940 --> 00:23:53,820
it's launched by Beacon it has a

619
00:23:53,820 --> 00:23:55,740
combination with the IEX which is like a

620
00:23:55,740 --> 00:23:57,659
Powershell download function so that

621
00:23:57,659 --> 00:23:59,400
might be something that we can do

622
00:23:59,400 --> 00:24:01,820
something about

623
00:24:02,900 --> 00:24:06,900
uh and then yeah 4104 uh four one zero

624
00:24:06,900 --> 00:24:10,679
three so you can see uh over there up

625
00:24:10,679 --> 00:24:13,380
there uh it's a long straight Block tax

626
00:24:13,380 --> 00:24:16,980
uh if you can see it's 41 or 47 so

627
00:24:16,980 --> 00:24:18,659
normally you don't have that long screen

628
00:24:18,659 --> 00:24:21,659
uh scriptbook text so you might want to

629
00:24:21,659 --> 00:24:24,179
pay attention on that uh and then you

630
00:24:24,179 --> 00:24:25,799
know like harm toy the creator of the

631
00:24:25,799 --> 00:24:28,679
tools his name is literally there on the

632
00:24:28,679 --> 00:24:30,720
log so if you see his Tools in your

633
00:24:30,720 --> 00:24:32,400
locks maybe I don't think that's a good

634
00:24:32,400 --> 00:24:33,140
thing

635
00:24:33,140 --> 00:24:35,880
so we can move forward

636
00:24:35,880 --> 00:24:37,980
[Music]

637
00:24:37,980 --> 00:24:40,260
uh another thing from the network side

638
00:24:40,260 --> 00:24:43,320
we are seeing a lot of interesting uh

639
00:24:43,320 --> 00:24:45,720
from system93 you can even see something

640
00:24:45,720 --> 00:24:47,760
from firewall or some other Network

641
00:24:47,760 --> 00:24:50,419
Tools uh we are seeing some connection

642
00:24:50,419 --> 00:24:54,720
uh from port 389 which is ldap which is

643
00:24:54,720 --> 00:24:55,679
kind of makes sense when you're

644
00:24:55,679 --> 00:24:57,419
enumerating shares you're probably gonna

645
00:24:57,419 --> 00:25:00,960
talk to the uh using ldap protocol from

646
00:25:00,960 --> 00:25:03,840
Powershell process uh is is that a

647
00:25:03,840 --> 00:25:05,640
normal thing in your organization yes or

648
00:25:05,640 --> 00:25:07,799
no it's it depends to you but if it's

649
00:25:07,799 --> 00:25:09,900
not it's something that you want to look

650
00:25:09,900 --> 00:25:12,320
into more

651
00:25:13,500 --> 00:25:16,140
but the thing is uh

652
00:25:16,140 --> 00:25:17,700
you can actually

653
00:25:17,700 --> 00:25:19,980
bypass all those things research because

654
00:25:19,980 --> 00:25:22,080
it's already there for example if you go

655
00:25:22,080 --> 00:25:25,039
to Sigma Sigma is like a repository for

656
00:25:25,039 --> 00:25:28,320
detection for a lot of platforms uh

657
00:25:28,320 --> 00:25:29,480
Defender

658
00:25:29,480 --> 00:25:33,480
Windows Linux apple and everything and

659
00:25:33,480 --> 00:25:36,000
also there's like a like a timeline of

660
00:25:36,000 --> 00:25:38,940
attack so you know like which uh action

661
00:25:38,940 --> 00:25:40,460
being

662
00:25:40,460 --> 00:25:44,539
used by the attacker

663
00:25:46,820 --> 00:25:49,200
itself uh there's already a signal

664
00:25:49,200 --> 00:25:51,779
detection for it so you can easily

665
00:25:51,779 --> 00:25:55,700
implement this into your platform

666
00:25:56,539 --> 00:26:00,840
and yeah for the Powershell the IEX the

667
00:26:00,840 --> 00:26:02,880
dollar execute is already there also if

668
00:26:02,880 --> 00:26:05,700
you implement it it's probably uh also a

669
00:26:05,700 --> 00:26:08,179
good idea

670
00:26:08,940 --> 00:26:13,080
and then on the implementation itself uh

671
00:26:13,080 --> 00:26:14,640
this is the most important thing like

672
00:26:14,640 --> 00:26:16,020
will you

673
00:26:16,020 --> 00:26:18,600
move those detection into a working

674
00:26:18,600 --> 00:26:21,960
state right uh so there are some free

675
00:26:21,960 --> 00:26:23,700
examples out there if you're you

676
00:26:23,700 --> 00:26:25,799
probably use most of the security

677
00:26:25,799 --> 00:26:28,260
organization use these tools it will

678
00:26:28,260 --> 00:26:30,059
last the accented or Splunk and maybe

679
00:26:30,059 --> 00:26:32,820
some other SIM like carbon black and

680
00:26:32,820 --> 00:26:36,659
such but it's easily translatable so you

681
00:26:36,659 --> 00:26:40,080
can pretty much convert it easily but

682
00:26:40,080 --> 00:26:42,840
there's also like open source or like uh

683
00:26:42,840 --> 00:26:44,700
public uh

684
00:26:44,700 --> 00:26:48,360
commonly used signature repository such

685
00:26:48,360 --> 00:26:52,799
as Sigma Yara Yara is for like file uh

686
00:26:52,799 --> 00:26:56,480
snort sorry it's for network

687
00:26:56,480 --> 00:26:58,799
and of course you can make your own

688
00:26:58,799 --> 00:27:01,200
custom protection platform but it's I

689
00:27:01,200 --> 00:27:02,520
don't recommend it because it's a pain

690
00:27:02,520 --> 00:27:04,260
in the ass to manage

691
00:27:04,260 --> 00:27:06,600
smart

692
00:27:06,600 --> 00:27:09,419
uh yeah and then the the key of

693
00:27:09,419 --> 00:27:11,400
implementation is actually validating

694
00:27:11,400 --> 00:27:14,520
that your alert Works uh so you need to

695
00:27:14,520 --> 00:27:16,260
run a simulation so you deploy your

696
00:27:16,260 --> 00:27:19,080
detection you need to trigger the

697
00:27:19,080 --> 00:27:21,000
detection if it doesn't trigger then

698
00:27:21,000 --> 00:27:22,919
your detection not work or you're not

699
00:27:22,919 --> 00:27:25,200
using the tools the right way so either

700
00:27:25,200 --> 00:27:27,059
way both of them are bad well we need to

701
00:27:27,059 --> 00:27:28,760
make sure that we're not doing that

702
00:27:28,760 --> 00:27:30,900
so there's a lot of things that can go

703
00:27:30,900 --> 00:27:32,700
wrong and as I mentioned earlier

704
00:27:32,700 --> 00:27:34,980
everything goes wrong in security so

705
00:27:34,980 --> 00:27:37,980
your logging problem data schema problem

706
00:27:37,980 --> 00:27:40,200
there's a delay in data ingestion

707
00:27:40,200 --> 00:27:43,200
somebody change the network uh you know

708
00:27:43,200 --> 00:27:45,480
like a diagram and one of the network

709
00:27:45,480 --> 00:27:47,700
engineers engine you don't even know and

710
00:27:47,700 --> 00:27:49,799
then of course host issue likes the user

711
00:27:49,799 --> 00:27:53,700
tried to disable the tools uh it's not

712
00:27:53,700 --> 00:27:56,279
reachable or whatever reason so it's

713
00:27:56,279 --> 00:28:00,020
always good to verify your detection

714
00:28:00,539 --> 00:28:03,600
and documentation is something that is

715
00:28:03,600 --> 00:28:06,840
not everyone like it did you know

716
00:28:06,840 --> 00:28:08,580
everyone like doing documentation but it

717
00:28:08,580 --> 00:28:10,799
is a

718
00:28:10,799 --> 00:28:13,620
a good place to uh you know to store

719
00:28:13,620 --> 00:28:14,940
everything that you know about detection

720
00:28:14,940 --> 00:28:17,100
because your detection engineer can

721
00:28:17,100 --> 00:28:18,840
leave at any time somebody offer them

722
00:28:18,840 --> 00:28:21,779
better money they'll leave uh or maybe

723
00:28:21,779 --> 00:28:24,059
even your company tell you to fire your

724
00:28:24,059 --> 00:28:25,740
detection engineer like these days like

725
00:28:25,740 --> 00:28:28,140
there's a lot of layers and stuff uh you

726
00:28:28,140 --> 00:28:30,299
never know uh so it's always good to

727
00:28:30,299 --> 00:28:32,340
keep the knowledge so you can have that

728
00:28:32,340 --> 00:28:34,860
database of detection so detection

729
00:28:34,860 --> 00:28:37,320
covering you know Cloud covering house

730
00:28:37,320 --> 00:28:40,080
Etc just to answer visibility and you

731
00:28:40,080 --> 00:28:43,500
can use it as a metric for the executive

732
00:28:43,500 --> 00:28:46,140
so we made this many and we are covering

733
00:28:46,140 --> 00:28:47,400
more in the cloud we are covering more

734
00:28:47,400 --> 00:28:49,020
on the host more on the network blah

735
00:28:49,020 --> 00:28:51,480
blah blah and then for the details and

736
00:28:51,480 --> 00:28:54,240
query uh we I would personally recommend

737
00:28:54,240 --> 00:28:58,260
ads uh or the sigma itself because it

738
00:28:58,260 --> 00:28:59,820
contains the information so there's

739
00:28:59,820 --> 00:29:03,020
three types of information

740
00:29:04,380 --> 00:29:06,779
so contextual information so it's

741
00:29:06,779 --> 00:29:08,880
information that give you context so

742
00:29:08,880 --> 00:29:10,260
what is this attack what is this

743
00:29:10,260 --> 00:29:13,320
detection why are we doing this uh it's

744
00:29:13,320 --> 00:29:15,360
just giving the analysts or like whoever

745
00:29:15,360 --> 00:29:19,799
responding to the alert more context uh

746
00:29:19,799 --> 00:29:21,179
and then there's technical information

747
00:29:21,179 --> 00:29:23,880
so like tools like what what is these

748
00:29:23,880 --> 00:29:26,039
tools like how do you use it what about

749
00:29:26,039 --> 00:29:27,899
the commander to run it uh what about

750
00:29:27,899 --> 00:29:29,760
the detection itself the code and Etc

751
00:29:29,760 --> 00:29:31,200
and then there's support information

752
00:29:31,200 --> 00:29:33,779
such as blind spot so for example if you

753
00:29:33,779 --> 00:29:35,399
are excluding certain hosts if you're

754
00:29:35,399 --> 00:29:38,820
excluding certain uh slice of your uh

755
00:29:38,820 --> 00:29:42,120
what do you call it like a clients you

756
00:29:42,120 --> 00:29:43,919
know why it's not firing and there's

757
00:29:43,919 --> 00:29:45,840
like false positive okay we know that

758
00:29:45,840 --> 00:29:48,240
this application is doing this also but

759
00:29:48,240 --> 00:29:50,460
it's it's benign so that's a good thing

760
00:29:50,460 --> 00:29:50,920
to know

761
00:29:50,920 --> 00:29:53,460
[Music]

762
00:29:53,460 --> 00:29:57,380
and then cicd aka the detection is alive

763
00:29:57,380 --> 00:30:00,000
uh because

764
00:30:00,000 --> 00:30:02,279
it is a continuous process it's a

765
00:30:02,279 --> 00:30:04,679
deduction life cycle uh it's not just

766
00:30:04,679 --> 00:30:06,240
like you made it and then you sign it

767
00:30:06,240 --> 00:30:07,740
off and then you don't even look at it

768
00:30:07,740 --> 00:30:09,179
anymore

769
00:30:09,179 --> 00:30:13,200
yeah uh and then uh yeah you need to

770
00:30:13,200 --> 00:30:15,240
continue to improve and develop the

771
00:30:15,240 --> 00:30:17,159
detection so you need to review

772
00:30:17,159 --> 00:30:20,100
periodically uh the volume of the alert

773
00:30:20,100 --> 00:30:22,799
false positive through positive uh

774
00:30:22,799 --> 00:30:25,799
benign to positive so the alert fires

775
00:30:25,799 --> 00:30:27,659
but it is actually one of your admin

776
00:30:27,659 --> 00:30:29,700
doing it so I don't know maybe they're

777
00:30:29,700 --> 00:30:32,399
using was it was it mimikets or

778
00:30:32,399 --> 00:30:35,039
something no uh

779
00:30:35,039 --> 00:30:37,620
Empire Powershell Empire there's admin

780
00:30:37,620 --> 00:30:42,360
using Empire to update machines in the

781
00:30:42,360 --> 00:30:45,960
in the network which is like crazy just

782
00:30:45,960 --> 00:30:48,179
just a library on this story so there's

783
00:30:48,179 --> 00:30:50,399
a network admin uh he was using Empire

784
00:30:50,399 --> 00:30:52,559
to manage his his endpoints because it

785
00:30:52,559 --> 00:30:54,059
was more reliable than whichever

786
00:30:54,059 --> 00:30:56,220
solution that was available to him so

787
00:30:56,220 --> 00:30:59,820
yeah so it's like uh that things happen

788
00:30:59,820 --> 00:31:02,520
so yeah uh so yeah by reviewing your

789
00:31:02,520 --> 00:31:04,559
alerts you know like what's going on

790
00:31:04,559 --> 00:31:06,299
inside a performance on the platform

791
00:31:06,299 --> 00:31:09,419
does it make sense money wise to deploy

792
00:31:09,419 --> 00:31:11,399
one detection for example on the network

793
00:31:11,399 --> 00:31:13,380
or is it cheaper if you deploy it on the

794
00:31:13,380 --> 00:31:14,640
host so that's something that you can

795
00:31:14,640 --> 00:31:18,059
think about and then event to alert time

796
00:31:18,059 --> 00:31:20,340
differences delay sometimes you collect

797
00:31:20,340 --> 00:31:21,539
the data now

798
00:31:21,539 --> 00:31:24,120
you send it to the other engine and the

799
00:31:24,120 --> 00:31:26,220
alert time the next day is it good

800
00:31:26,220 --> 00:31:28,860
enough are you are you able to tolerate

801
00:31:28,860 --> 00:31:31,860
that and anything that is not efficient

802
00:31:31,860 --> 00:31:33,659
anything that's bad performing you want

803
00:31:33,659 --> 00:31:35,399
to take it out or you want to update it

804
00:31:35,399 --> 00:31:37,620
or you want to add new function you want

805
00:31:37,620 --> 00:31:40,140
to correlate it with some other stuff

806
00:31:40,140 --> 00:31:42,120
you can do complete rework or you can

807
00:31:42,120 --> 00:31:44,520
just like throw it to the bin because

808
00:31:44,520 --> 00:31:47,418
it's not working anymore

809
00:31:48,179 --> 00:31:50,700
so yeah so if we check the open source

810
00:31:50,700 --> 00:31:52,380
even the open source detection they have

811
00:31:52,380 --> 00:31:54,539
that CI CD so you can see

812
00:31:54,539 --> 00:31:57,419
okay Decay new rules okay the update

813
00:31:57,419 --> 00:32:00,240
rules because the logic is wrong and

814
00:32:00,240 --> 00:32:02,039
then they make big update it's not clear

815
00:32:02,039 --> 00:32:03,659
what we can be but they change something

816
00:32:03,659 --> 00:32:05,880
you can see on the code so using tools

817
00:32:05,880 --> 00:32:08,159
like gitlab or GitHub it's a good place

818
00:32:08,159 --> 00:32:09,840
for you to

819
00:32:09,840 --> 00:32:14,220
do CI CD as intended I guess and then

820
00:32:14,220 --> 00:32:15,779
yeah

821
00:32:15,779 --> 00:32:19,020
and then this is are some resources that

822
00:32:19,020 --> 00:32:20,179
you can

823
00:32:20,179 --> 00:32:23,399
ponder upon you can check it later so

824
00:32:23,399 --> 00:32:25,380
open source detection as I mentioned

825
00:32:25,380 --> 00:32:28,559
before Sigma era and snore There's the

826
00:32:28,559 --> 00:32:30,960
link for that and what they are okay go

827
00:32:30,960 --> 00:32:33,899
to the next slide uh again the

828
00:32:33,899 --> 00:32:36,960
difference the popular I always say like

829
00:32:36,960 --> 00:32:40,399
uh CM or like tools

830
00:32:40,399 --> 00:32:43,140
they have detection in there so you can

831
00:32:43,140 --> 00:32:45,000
open the links later when you have the

832
00:32:45,000 --> 00:32:47,419
slides

833
00:32:47,760 --> 00:32:50,460
uh this is just open source community so

834
00:32:50,460 --> 00:32:55,380
oicd is uh so if you would like to

835
00:32:55,380 --> 00:32:58,559
participate creating detection with

836
00:32:58,559 --> 00:33:02,159
random people in the world from random

837
00:33:02,159 --> 00:33:04,500
resources but you should trust it uh

838
00:33:04,500 --> 00:33:06,600
that's that's a place where you can do

839
00:33:06,600 --> 00:33:09,059
it so it's not let's say you you you can

840
00:33:09,059 --> 00:33:10,620
do it in your organization but you want

841
00:33:10,620 --> 00:33:13,740
to do it you can try to play with that

842
00:33:13,740 --> 00:33:17,460
OTR or trf it's more like uh bringing

843
00:33:17,460 --> 00:33:19,620
security from different backgrounds so

844
00:33:19,620 --> 00:33:21,899
it's like Fender agnostic so you get all

845
00:33:21,899 --> 00:33:24,840
the information about uh data this is

846
00:33:24,840 --> 00:33:27,000
mainly data like how to use the data so

847
00:33:27,000 --> 00:33:29,340
like Windows logs what are those what is

848
00:33:29,340 --> 00:33:31,679
lock even ID one two three blah blah

849
00:33:31,679 --> 00:33:33,360
blah so they have it in there so the

850
00:33:33,360 --> 00:33:35,480
link is there also

851
00:33:35,480 --> 00:33:38,580
uh yeah just organization that is doing

852
00:33:38,580 --> 00:33:40,640
great detection engineering DFI report

853
00:33:40,640 --> 00:33:43,559
uh Red Canary they just released like a

854
00:33:43,559 --> 00:33:45,960
new threat detection report Microsoft

855
00:33:45,960 --> 00:33:48,240
Specter Ops uh Specter office really

856
00:33:48,240 --> 00:33:49,440
like

857
00:33:49,440 --> 00:33:51,779
they're creating the fundamentals of

858
00:33:51,779 --> 00:33:53,279
detection engineering and thread hunting

859
00:33:53,279 --> 00:33:55,380
in generals so it's really great to

860
00:33:55,380 --> 00:33:55,650
follow

861
00:33:55,650 --> 00:33:57,740
[Music]

862
00:33:57,740 --> 00:33:59,760
uh and then detection engineering

863
00:33:59,760 --> 00:34:02,519
repository awesome is like the it's data

864
00:34:02,519 --> 00:34:04,679
it's related to the data and log so they

865
00:34:04,679 --> 00:34:06,240
get some and I don't think they get

866
00:34:06,240 --> 00:34:07,679
samples but it's more like data

867
00:34:07,679 --> 00:34:09,659
dictionary so if you if you have any

868
00:34:09,659 --> 00:34:10,918
question about your data that you're

869
00:34:10,918 --> 00:34:13,020
seeing your Linux your Mac OS your

870
00:34:13,020 --> 00:34:14,760
windows you can check that hopefully

871
00:34:14,760 --> 00:34:16,600
they have it and

872
00:34:16,600 --> 00:34:18,540
[Music]

873
00:34:18,540 --> 00:34:21,418
yeah there's some readings uh some new

874
00:34:21,418 --> 00:34:24,540
readings fairly new uh I like actually

875
00:34:24,540 --> 00:34:29,580
the Zach Allen uh like a weekly news so

876
00:34:29,580 --> 00:34:31,020
it shares everything about detection

877
00:34:31,020 --> 00:34:32,760
engineering different articles written

878
00:34:32,760 --> 00:34:35,520
by other folks and it's just a great but

879
00:34:35,520 --> 00:34:38,280
everything else here is great

880
00:34:38,280 --> 00:34:41,159
and some people that I talk personally

881
00:34:41,159 --> 00:34:43,859
uh really great people if you want to

882
00:34:43,859 --> 00:34:47,399
follow them on in Twitter uh link will

883
00:34:47,399 --> 00:34:49,260
go to Twitter or LinkedIn I'm not sure

884
00:34:49,260 --> 00:34:52,379
but it will go somewhere uh yeah

885
00:34:52,379 --> 00:34:55,679
it's not malware I promise

886
00:34:55,679 --> 00:34:57,599
so yeah so that's pretty much our talk

887
00:34:57,599 --> 00:34:59,580
uh it's rather fast it's a big topic

888
00:34:59,580 --> 00:35:03,900
where we go fast uh we get oh anyways

889
00:35:03,900 --> 00:35:05,460
for a question like

890
00:35:05,460 --> 00:35:07,500
10 minutes for a question something like

891
00:35:07,500 --> 00:35:08,580
that

892
00:35:08,580 --> 00:35:10,140
yeah thank you so much everyone thank

893
00:35:10,140 --> 00:35:12,980
you I really appreciate it

894
00:35:13,740 --> 00:35:16,560
thank you for this presentation we will

895
00:35:16,560 --> 00:35:18,260
take um

896
00:35:18,260 --> 00:35:23,720
a few questions some someone somebody

897
00:35:36,200 --> 00:35:39,420
does it work yeah thanks guys uh good

898
00:35:39,420 --> 00:35:41,640
talk topic close to my heart because we

899
00:35:41,640 --> 00:35:44,339
are running uh detection content team

900
00:35:44,339 --> 00:35:46,560
um a bit about the stakeholder

901
00:35:46,560 --> 00:35:50,339
management how do you guys manage

902
00:35:50,339 --> 00:35:51,720
um and see conversations with the stock

903
00:35:51,720 --> 00:35:53,820
team have the feedback from the stock

904
00:35:53,820 --> 00:35:57,060
helps with improving the detection

905
00:35:57,060 --> 00:35:59,040
yeah sure I can take this one so yeah

906
00:35:59,040 --> 00:36:00,720
like it's it's very important to have a

907
00:36:00,720 --> 00:36:02,579
good relationship with uh your sock team

908
00:36:02,579 --> 00:36:04,020
right like

909
00:36:04,020 --> 00:36:05,760
um you need to be in their shoes and

910
00:36:05,760 --> 00:36:08,280
understand like you know they need to

911
00:36:08,280 --> 00:36:09,420
understand like you're thinking on their

912
00:36:09,420 --> 00:36:11,820
behalf as well like in the sense of uh

913
00:36:11,820 --> 00:36:13,560
you know we're here to just catch like

914
00:36:13,560 --> 00:36:15,599
the true positives we also don't want

915
00:36:15,599 --> 00:36:17,820
like false positives and it needs to

916
00:36:17,820 --> 00:36:19,740
come to a like an agreement on like what

917
00:36:19,740 --> 00:36:22,020
is like a good uh true positive to noise

918
00:36:22,020 --> 00:36:25,200
ratio uh making sure that like they have

919
00:36:25,200 --> 00:36:26,700
like a very seamless experience right

920
00:36:26,700 --> 00:36:27,900
because they're always being flooded

921
00:36:27,900 --> 00:36:29,940
with tickets and uh you need to really

922
00:36:29,940 --> 00:36:31,920
like like sympathize and empathize with

923
00:36:31,920 --> 00:36:34,200
that right so uh making sure that your

924
00:36:34,200 --> 00:36:36,060
documentation is clear and that like

925
00:36:36,060 --> 00:36:38,460
it's as easy as possible

926
00:36:38,460 --> 00:36:40,980
um in terms of like uh how like how to

927
00:36:40,980 --> 00:36:42,060
do that

928
00:36:42,060 --> 00:36:43,320
um you know definitely have them

929
00:36:43,320 --> 00:36:46,560
involved in the the detection uh

930
00:36:46,560 --> 00:36:48,599
pipeline process so like while you're

931
00:36:48,599 --> 00:36:50,400
tuning you have the conversation with

932
00:36:50,400 --> 00:36:52,859
them and have some analysts see like hey

933
00:36:52,859 --> 00:36:54,359
um these are some false positives that

934
00:36:54,359 --> 00:36:56,520
we've tuned down uh this is the state of

935
00:36:56,520 --> 00:36:59,280
the rule now like is uh are we like in

936
00:36:59,280 --> 00:37:01,740
agreement that like this is a good State

937
00:37:01,740 --> 00:37:02,820
um of course like have them walk through

938
00:37:02,820 --> 00:37:04,740
the documentation with you and you know

939
00:37:04,740 --> 00:37:07,020
like that they're okay with it

940
00:37:07,020 --> 00:37:08,099
um but yeah like the more that they're

941
00:37:08,099 --> 00:37:09,540
involved you know like the more that

942
00:37:09,540 --> 00:37:12,180
it's less like of a like of a burden

943
00:37:12,180 --> 00:37:13,440
that they're receiving and more that

944
00:37:13,440 --> 00:37:15,000
like hey this is something that like we

945
00:37:15,000 --> 00:37:16,320
want to have and that we've worked on

946
00:37:16,320 --> 00:37:18,500
together

947
00:37:19,280 --> 00:37:21,720
so I just want to add something to like

948
00:37:21,720 --> 00:37:23,640
it's I've I've worked with good stock

949
00:37:23,640 --> 00:37:26,400
I've worked with but bad song like uh

950
00:37:26,400 --> 00:37:28,200
We've we send alert great alert they

951
00:37:28,200 --> 00:37:29,460
don't respond to it they just like say

952
00:37:29,460 --> 00:37:31,920
yeah we close it like what would you do

953
00:37:31,920 --> 00:37:34,200
yeah we just close it like they don't

954
00:37:34,200 --> 00:37:36,000
have understanding so I think the most

955
00:37:36,000 --> 00:37:37,140
important part is to build that

956
00:37:37,140 --> 00:37:39,060
conversation with them so you you create

957
00:37:39,060 --> 00:37:40,980
a meeting with the managers you let them

958
00:37:40,980 --> 00:37:42,960
know what coming to them what detection

959
00:37:42,960 --> 00:37:45,720
coming how do you respond to it if

960
00:37:45,720 --> 00:37:47,520
something wrong if something is bad like

961
00:37:47,520 --> 00:37:50,280
how can they contact us I think once

962
00:37:50,280 --> 00:37:52,800
once that process is in there it's just

963
00:37:52,800 --> 00:37:56,099
uh you just need to slowly going slowly

964
00:37:56,099 --> 00:37:58,440
together and then eventually it will

965
00:37:58,440 --> 00:38:00,480
just run like that uh so yeah

966
00:38:00,480 --> 00:38:02,220
communication I guess like a

967
00:38:02,220 --> 00:38:04,859
documentation uh which not everybody

968
00:38:04,859 --> 00:38:07,140
loves to do but it's it's still

969
00:38:07,140 --> 00:38:08,460
important part

970
00:38:08,460 --> 00:38:12,619
thanks a lot can I ask another one

971
00:38:13,940 --> 00:38:17,339
hey I'm very good talk uh what is in

972
00:38:17,339 --> 00:38:19,140
your opinion the best way to reduce the

973
00:38:19,140 --> 00:38:20,820
noise in the detections for example

974
00:38:20,820 --> 00:38:23,880
exclusion risk how is the best way in

975
00:38:23,880 --> 00:38:26,280
your opinion or experience to reduce the

976
00:38:26,280 --> 00:38:28,619
false positive and the noise in the

977
00:38:28,619 --> 00:38:30,660
detection some of them are super noisy

978
00:38:30,660 --> 00:38:32,820
right how are you dealing with in your

979
00:38:32,820 --> 00:38:35,400
experience in the best way

980
00:38:35,400 --> 00:38:37,500
okay I'll start and then I'll pass it to

981
00:38:37,500 --> 00:38:39,240
you so uh

982
00:38:39,240 --> 00:38:41,940
again it's it's or every organization

983
00:38:41,940 --> 00:38:44,940
it's different uh we have this we call

984
00:38:44,940 --> 00:38:48,359
it like uh false false positive appetite

985
00:38:48,359 --> 00:38:51,480
so what what is your appetite for false

986
00:38:51,480 --> 00:38:54,240
positive okay I can take 70 I work in

987
00:38:54,240 --> 00:38:57,480
organization that take like 50 so even

988
00:38:57,480 --> 00:38:59,940
it's bad but they go through it uh so

989
00:38:59,940 --> 00:39:01,859
first thing you need to know if if your

990
00:39:01,859 --> 00:39:03,720
client or your organization what is your

991
00:39:03,720 --> 00:39:07,260
risk appetite once you know that uh then

992
00:39:07,260 --> 00:39:08,820
you have to stick to that I guess like

993
00:39:08,820 --> 00:39:11,040
you build high quality detection so you

994
00:39:11,040 --> 00:39:13,920
have you have low low uh confidence

995
00:39:13,920 --> 00:39:16,320
detection figure out a way how to make

996
00:39:16,320 --> 00:39:19,380
it higher if it's uh it could be

997
00:39:19,380 --> 00:39:21,540
correlation could be a combining

998
00:39:21,540 --> 00:39:23,700
multiple detection I think that's pretty

999
00:39:23,700 --> 00:39:24,780
popular they say they call it

1000
00:39:24,780 --> 00:39:26,640
observations so like

1001
00:39:26,640 --> 00:39:29,040
okay I get IP from China

1002
00:39:29,040 --> 00:39:32,579
10 years ago that's bad now it's it's

1003
00:39:32,579 --> 00:39:34,339
someone on vacation checking their email

1004
00:39:34,339 --> 00:39:37,260
and then you connect that you connect

1005
00:39:37,260 --> 00:39:39,599
the dot what are they doing after are

1006
00:39:39,599 --> 00:39:41,760
they allow going to email what are they

1007
00:39:41,760 --> 00:39:43,320
do what are they doing in email okay

1008
00:39:43,320 --> 00:39:45,000
they're sending they're sending an email

1009
00:39:45,000 --> 00:39:47,820
okay that should be fine if they are

1010
00:39:47,820 --> 00:39:50,700
creating Outlook rules to send any

1011
00:39:50,700 --> 00:39:53,099
emails that come in to some other emails

1012
00:39:53,099 --> 00:39:55,680
that's that's suspicious so you kind of

1013
00:39:55,680 --> 00:39:57,960
like Trace back the okay what's next can

1014
00:39:57,960 --> 00:39:59,820
be done or what before that can be done

1015
00:39:59,820 --> 00:40:02,040
and kind of combine it together it might

1016
00:40:02,040 --> 00:40:03,060
be hard if you don't have direct

1017
00:40:03,060 --> 00:40:05,400
platform but I guess to improve it I

1018
00:40:05,400 --> 00:40:07,980
think that's the best way to do it

1019
00:40:07,980 --> 00:40:10,800
yeah um maybe on like a more scalable

1020
00:40:10,800 --> 00:40:13,440
kind of like mindset like uh maybe uh

1021
00:40:13,440 --> 00:40:15,480
like to test this point about like um

1022
00:40:15,480 --> 00:40:17,339
risk appetite you kind of need to

1023
00:40:17,339 --> 00:40:19,440
justify like the false positives right

1024
00:40:19,440 --> 00:40:21,060
so like maybe having a good

1025
00:40:21,060 --> 00:40:22,260
understanding of like what is like the

1026
00:40:22,260 --> 00:40:24,480
severity of this uh of this detection or

1027
00:40:24,480 --> 00:40:27,060
this threat that it's trying to detect

1028
00:40:27,060 --> 00:40:28,920
um and you maybe can think of like a

1029
00:40:28,920 --> 00:40:30,300
score for that and then just like

1030
00:40:30,300 --> 00:40:33,060
painting like a a good ratio for that to

1031
00:40:33,060 --> 00:40:35,520
justify the uh the false positive but

1032
00:40:35,520 --> 00:40:36,540
also

1033
00:40:36,540 --> 00:40:38,160
um sometimes like you need to start like

1034
00:40:38,160 --> 00:40:39,780
from the very start and think like is

1035
00:40:39,780 --> 00:40:41,640
this the right detection mechanism for

1036
00:40:41,640 --> 00:40:42,599
it right

1037
00:40:42,599 --> 00:40:44,640
um some detection mechanisms are a lot

1038
00:40:44,640 --> 00:40:46,800
more noisy like maybe uh like if you use

1039
00:40:46,800 --> 00:40:49,320
thresholds right if you're working with

1040
00:40:49,320 --> 00:40:50,940
like multi-tenant like it doesn't make

1041
00:40:50,940 --> 00:40:53,099
sense to have uh like a static number

1042
00:40:53,099 --> 00:40:55,380
threshold uh because like if you use

1043
00:40:55,380 --> 00:40:57,720
this for like a small organization

1044
00:40:57,720 --> 00:40:59,760
um it'll it'll never trigger if you've

1045
00:40:59,760 --> 00:41:01,560
tuned it for like a large organization

1046
00:41:01,560 --> 00:41:03,300
right so

1047
00:41:03,300 --> 00:41:04,859
um you need to really understand like

1048
00:41:04,859 --> 00:41:06,720
the detection mechanisms that you're

1049
00:41:06,720 --> 00:41:08,520
working with and those limitations right

1050
00:41:08,520 --> 00:41:11,040
and that's kind of like uh I guess like

1051
00:41:11,040 --> 00:41:13,680
the balance of or the art of detection

1052
00:41:13,680 --> 00:41:15,599
engineering so

1053
00:41:15,599 --> 00:41:18,440
any other questions

1054
00:41:19,380 --> 00:41:22,380
foreign

1055
00:41:25,740 --> 00:41:28,520
yes

1056
00:41:33,660 --> 00:41:35,520
thank you very much for my interesting

1057
00:41:35,520 --> 00:41:37,640
talk you opened a whole new world for me

1058
00:41:37,640 --> 00:41:40,859
uh I have a background web application

1059
00:41:40,859 --> 00:41:43,560
firewalls where the appetite for false

1060
00:41:43,560 --> 00:41:45,300
positive an organization is extremely

1061
00:41:45,300 --> 00:41:46,500
low

1062
00:41:46,500 --> 00:41:49,980
but you talk about detection do you ever

1063
00:41:49,980 --> 00:41:52,560
get into a situation where you think

1064
00:41:52,560 --> 00:41:55,500
your detection is now so good did you

1065
00:41:55,500 --> 00:41:57,420
make it into a blocking rule for going

1066
00:41:57,420 --> 00:41:59,940
forward or is that like unattainable

1067
00:41:59,940 --> 00:42:01,920
based on your data

1068
00:42:01,920 --> 00:42:05,099
uh at Microsoft yes we do have that kind

1069
00:42:05,099 --> 00:42:08,640
of things we call it

1070
00:42:08,640 --> 00:42:11,400
yes blocking let's let's call it

1071
00:42:11,400 --> 00:42:12,800
blocking

1072
00:42:12,800 --> 00:42:15,480
response something like that so we know

1073
00:42:15,480 --> 00:42:18,500
for sure they are bad we block it uh

1074
00:42:18,500 --> 00:42:20,880
we're not we don't talk about it too

1075
00:42:20,880 --> 00:42:23,160
much here because that's kind of like

1076
00:42:23,160 --> 00:42:25,980
active response store kind of thing but

1077
00:42:25,980 --> 00:42:27,420
if you have the infrastructure fire

1078
00:42:27,420 --> 00:42:28,859
alerts send it to the ticketing system

1079
00:42:28,859 --> 00:42:32,339
ticketing system send it to the store

1080
00:42:32,339 --> 00:42:34,079
that that happened that happened all the

1081
00:42:34,079 --> 00:42:36,960
time in many organizations uh for

1082
00:42:36,960 --> 00:42:38,460
example

1083
00:42:38,460 --> 00:42:41,040
if even if you're like logging in to

1084
00:42:41,040 --> 00:42:44,280
certain like to Azure ID you're logged

1085
00:42:44,280 --> 00:42:47,040
in from different uh area and then the

1086
00:42:47,040 --> 00:42:48,839
Azure ID just doesn't like it and then

1087
00:42:48,839 --> 00:42:50,099
they block your connection or contact

1088
00:42:50,099 --> 00:42:51,960
admin something like that right so

1089
00:42:51,960 --> 00:42:53,400
that's already there it's already

1090
00:42:53,400 --> 00:42:57,000
rolling uh so yeah so if you able to do

1091
00:42:57,000 --> 00:42:59,160
that that's great because you don't need

1092
00:42:59,160 --> 00:43:01,319
to worry about it you just like uh okay

1093
00:43:01,319 --> 00:43:03,240
stop it so that's generally a

1094
00:43:03,240 --> 00:43:04,940
perspective you're kind of working

1095
00:43:04,940 --> 00:43:08,520
towards yeah when when possible but not

1096
00:43:08,520 --> 00:43:10,680
every not every thing is possible

1097
00:43:10,680 --> 00:43:12,420
especially with machine learning stuff

1098
00:43:12,420 --> 00:43:14,760
right you you might want to double

1099
00:43:14,760 --> 00:43:16,980
verify because they they don't have

1100
00:43:16,980 --> 00:43:19,079
contacts they just know this looks bad

1101
00:43:19,079 --> 00:43:21,839
and then again are we gonna yeah we

1102
00:43:21,839 --> 00:43:24,060
alert on this

1103
00:43:24,060 --> 00:43:26,280
that yeah also that's why we are not

1104
00:43:26,280 --> 00:43:29,460
scared about our job because the the

1105
00:43:29,460 --> 00:43:31,380
machine learning AI whatever you call

1106
00:43:31,380 --> 00:43:34,140
it's lacking that point like

1107
00:43:34,140 --> 00:43:36,119
human can see it easily but machine

1108
00:43:36,119 --> 00:43:37,680
learning sure they can process a lot of

1109
00:43:37,680 --> 00:43:40,740
data but they will come to like some

1110
00:43:40,740 --> 00:43:42,900
mistakes at some point

1111
00:43:42,900 --> 00:43:44,819
yeah maybe on a little bit more on that

1112
00:43:44,819 --> 00:43:46,020
point like

1113
00:43:46,020 --> 00:43:48,000
um I just see as like a an additional

1114
00:43:48,000 --> 00:43:49,859
like mechanism or tool right it's not

1115
00:43:49,859 --> 00:43:51,660
something that is here to like replace

1116
00:43:51,660 --> 00:43:53,760
jobs right but

1117
00:43:53,760 --> 00:43:54,380
um yeah

1118
00:43:54,380 --> 00:43:56,280
[Music]

1119
00:43:56,280 --> 00:44:00,599
any other question the last one please

1120
00:44:00,599 --> 00:44:02,960
yes

1121
00:44:11,780 --> 00:44:15,180
yeah just question from me uh how do you

1122
00:44:15,180 --> 00:44:18,599
practically manage uh testing of the of

1123
00:44:18,599 --> 00:44:20,339
the detection use cases do you have some

1124
00:44:20,339 --> 00:44:23,040
I don't like uh

1125
00:44:23,040 --> 00:44:25,619
scripts running that basically just try

1126
00:44:25,619 --> 00:44:28,079
to you know break stuff or do you just

1127
00:44:28,079 --> 00:44:29,700
believe that it

1128
00:44:29,700 --> 00:44:32,220
so we'll keep detecting what's your

1129
00:44:32,220 --> 00:44:35,839
approach yeah great question

1130
00:44:36,540 --> 00:44:39,300
yeah first never believe uh trust and

1131
00:44:39,300 --> 00:44:41,160
verify right

1132
00:44:41,160 --> 00:44:42,900
um so yeah like there's uh there are

1133
00:44:42,900 --> 00:44:45,839
platforms to facilitate this uh like uh

1134
00:44:45,839 --> 00:44:48,359
purple teaming platforms I of course

1135
00:44:48,359 --> 00:44:50,220
like you need to have like your uh

1136
00:44:50,220 --> 00:44:52,619
endpoint logging or your blocking

1137
00:44:52,619 --> 00:44:54,599
mechanisms like on the the tester

1138
00:44:54,599 --> 00:44:56,579
machines that you have

1139
00:44:56,579 --> 00:45:00,119
um and then uh ideally you have like a

1140
00:45:00,119 --> 00:45:01,680
platform that already has like these uh

1141
00:45:01,680 --> 00:45:03,480
these threats that can just press a

1142
00:45:03,480 --> 00:45:05,579
button and it'll run it

1143
00:45:05,579 --> 00:45:06,180
um

1144
00:45:06,180 --> 00:45:08,220
but if you don't have access to these

1145
00:45:08,220 --> 00:45:10,380
tools uh yeah for sure like uh building

1146
00:45:10,380 --> 00:45:11,640
your own scripts there's also like open

1147
00:45:11,640 --> 00:45:14,160
source Frameworks for this right like

1148
00:45:14,160 --> 00:45:17,280
um from record art yeah like uh from

1149
00:45:17,280 --> 00:45:20,400
Canary or our uh

1150
00:45:20,400 --> 00:45:24,660
RTA Atomic uh red team and such so

1151
00:45:24,660 --> 00:45:26,160
there's there's a lot of like open

1152
00:45:26,160 --> 00:45:27,960
source uh like tools that's available

1153
00:45:27,960 --> 00:45:30,420
that you can run these scripts

1154
00:45:30,420 --> 00:45:31,140
um

1155
00:45:31,140 --> 00:45:33,599
let's see and yeah for for sure like uh

1156
00:45:33,599 --> 00:45:36,060
we'll run the detections ourselves so

1157
00:45:36,060 --> 00:45:38,460
there's actually like multiple tests

1158
00:45:38,460 --> 00:45:40,260
that you should be doing there's like

1159
00:45:40,260 --> 00:45:42,000
well maybe we can call like unit testing

1160
00:45:42,000 --> 00:45:45,180
or sanity checking so like uh it could

1161
00:45:45,180 --> 00:45:47,460
be like a modified or like dummy Json

1162
00:45:47,460 --> 00:45:52,020
file uh and uh it's just gonna like uh

1163
00:45:52,020 --> 00:45:53,579
periodically run through your pipeline

1164
00:45:53,579 --> 00:45:55,560
just to you know hey make sure that it's

1165
00:45:55,560 --> 00:45:57,780
going to alert on it and all the bells

1166
00:45:57,780 --> 00:45:59,700
are working and such uh but then there's

1167
00:45:59,700 --> 00:46:01,740
also like real world attacking emulation

1168
00:46:01,740 --> 00:46:04,140
so like maybe you'll have uh like those

1169
00:46:04,140 --> 00:46:07,020
tools that I mentioned uh or yeah like

1170
00:46:07,020 --> 00:46:09,300
have like a an external maybe not

1171
00:46:09,300 --> 00:46:11,339
external but

1172
00:46:11,339 --> 00:46:13,680
whichever like uh like a purple team on

1173
00:46:13,680 --> 00:46:16,619
your uh that can uh do real world uh

1174
00:46:16,619 --> 00:46:18,960
emulation right so

1175
00:46:18,960 --> 00:46:22,380
yeah I think just to kind of like uh

1176
00:46:22,380 --> 00:46:24,599
make make sense like uh conclude

1177
00:46:24,599 --> 00:46:26,700
everything it's like uh there's multiple

1178
00:46:26,700 --> 00:46:28,260
steps right you

1179
00:46:28,260 --> 00:46:31,500
you crawl you walk you run so you crawl

1180
00:46:31,500 --> 00:46:33,180
when you crawl you can just start by

1181
00:46:33,180 --> 00:46:34,859
having a machine could be your own

1182
00:46:34,859 --> 00:46:38,280
machine and just well not not suggested

1183
00:46:38,280 --> 00:46:40,560
to do that but you can run certain tools

1184
00:46:40,560 --> 00:46:42,660
in there and then make sure that you the

1185
00:46:42,660 --> 00:46:44,460
logs are like the detection it's firing

1186
00:46:44,460 --> 00:46:45,960
on the other end when you're doing that

1187
00:46:45,960 --> 00:46:48,240
uh the second one you can also have your

1188
00:46:48,240 --> 00:46:51,060
own lab that is having all the ages that

1189
00:46:51,060 --> 00:46:52,980
you have having the firewall on that

1190
00:46:52,980 --> 00:46:55,079
side so you do like full-blown

1191
00:46:55,079 --> 00:46:56,819
activities in there and you can see if

1192
00:46:56,819 --> 00:46:58,980
everything is uh working as fine and

1193
00:46:58,980 --> 00:47:00,480
then yeah for the Running part you can

1194
00:47:00,480 --> 00:47:03,300
actually just uh get a fender to do that

1195
00:47:03,300 --> 00:47:06,420
like install all the infrastructure uh

1196
00:47:06,420 --> 00:47:08,880
you can create your separate environment

1197
00:47:08,880 --> 00:47:11,520
like 10 and wise and then like do

1198
00:47:11,520 --> 00:47:12,960
everything in there you can have direct

1199
00:47:12,960 --> 00:47:17,040
theming routine exercise uh yeah it's

1200
00:47:17,040 --> 00:47:19,020
just like how

1201
00:47:19,020 --> 00:47:21,119
like how capable your organization is I

1202
00:47:21,119 --> 00:47:25,020
guess the the question uh now and yeah I

1203
00:47:25,020 --> 00:47:26,579
think that's mainly how to do it there's

1204
00:47:26,579 --> 00:47:28,859
you can start small you can go big it's

1205
00:47:28,859 --> 00:47:31,680
it's it depends on your organization and

1206
00:47:31,680 --> 00:47:33,780
there's a lot of surfaces out there if

1207
00:47:33,780 --> 00:47:35,460
you would like to pay and there's like

1208
00:47:35,460 --> 00:47:37,260
some open source if you like some free

1209
00:47:37,260 --> 00:47:41,780
ones too yeah foreign

1210
00:47:46,619 --> 00:47:51,619
so thank you both for this presentation

1211
00:47:52,020 --> 00:47:56,240
become not close thanks everyone

