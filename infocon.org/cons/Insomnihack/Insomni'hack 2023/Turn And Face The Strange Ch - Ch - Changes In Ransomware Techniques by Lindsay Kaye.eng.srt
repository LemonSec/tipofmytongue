1
00:00:03,240 --> 00:00:05,400
all right hi everyone thank you so much

2
00:00:05,400 --> 00:00:07,080
for coming to my talk today I'm going to

3
00:00:07,080 --> 00:00:08,039
tell you a little bit about some of the

4
00:00:08,039 --> 00:00:09,599
ransomware TTP changes that we've

5
00:00:09,599 --> 00:00:12,800
observed over the past couple years

6
00:00:13,679 --> 00:00:15,660
my name is Lindsey K I'm the senior

7
00:00:15,660 --> 00:00:17,160
director of the advanced reversing

8
00:00:17,160 --> 00:00:18,840
malware operations and reconnaissance

9
00:00:18,840 --> 00:00:21,240
group at instant group report future so

10
00:00:21,240 --> 00:00:22,680
I run the technical arm of our threat

11
00:00:22,680 --> 00:00:24,180
intelligence team and by train I'm a

12
00:00:24,180 --> 00:00:26,760
malware analyst and reverse engineer

13
00:00:26,760 --> 00:00:28,560
so we have to start by the premise that

14
00:00:28,560 --> 00:00:30,539
just like every one of us ransomware

15
00:00:30,539 --> 00:00:32,220
groups are also subject to the realities

16
00:00:32,220 --> 00:00:35,219
of the economy and as as a result we see

17
00:00:35,219 --> 00:00:36,540
many of them innovate their tools or

18
00:00:36,540 --> 00:00:37,980
behavior because they want to remain

19
00:00:37,980 --> 00:00:39,540
successful in a very competitive market

20
00:00:39,540 --> 00:00:41,399
it's not that they can just build it in

21
00:00:41,399 --> 00:00:43,680
the Affiliates will come but like some

22
00:00:43,680 --> 00:00:45,360
other innovations that didn't quite go

23
00:00:45,360 --> 00:00:47,280
as planned sometimes these changes don't

24
00:00:47,280 --> 00:00:48,480
work out the way the threat actors

25
00:00:48,480 --> 00:00:50,340
intended and sometimes we actually see

26
00:00:50,340 --> 00:00:51,539
them backfire

27
00:00:51,539 --> 00:00:52,920
so today I'm going to tell you about

28
00:00:52,920 --> 00:00:54,420
some of the innovations that we've

29
00:00:54,420 --> 00:00:55,920
observed in ransomware and talk about

30
00:00:55,920 --> 00:00:57,600
what made them either highly successful

31
00:00:57,600 --> 00:01:00,360
or less so

32
00:01:00,360 --> 00:01:02,160
so over the past couple years there are

33
00:01:02,160 --> 00:01:03,660
kind of a couple different categories of

34
00:01:03,660 --> 00:01:05,280
ways that we've seen

35
00:01:05,280 --> 00:01:07,619
um lockers evolve and the ransomware

36
00:01:07,619 --> 00:01:09,780
actor tdps change for a variety of

37
00:01:09,780 --> 00:01:12,119
threat actors so things like new lockers

38
00:01:12,119 --> 00:01:14,520
spin up and spin down we see feature

39
00:01:14,520 --> 00:01:16,040
additions to some of the existing ones

40
00:01:16,040 --> 00:01:18,420
there have been new ways of deploying

41
00:01:18,420 --> 00:01:20,040
and spreading them

42
00:01:20,040 --> 00:01:22,140
um it's not also just seeing C plus plus

43
00:01:22,140 --> 00:01:23,580
anymore which we were used to a couple

44
00:01:23,580 --> 00:01:25,500
years ago now we've seen languages like

45
00:01:25,500 --> 00:01:28,140
golang rust and python as well we've

46
00:01:28,140 --> 00:01:29,400
seen the use of additional extortion

47
00:01:29,400 --> 00:01:31,500
methods to really get people to pay and

48
00:01:31,500 --> 00:01:32,880
we've also seen some threat actors

49
00:01:32,880 --> 00:01:36,080
Target additional types of hardware

50
00:01:37,500 --> 00:01:38,640
some of them worked actually

51
00:01:38,640 --> 00:01:40,200
particularly well so here's a couple of

52
00:01:40,200 --> 00:01:42,540
categories so first the way that people

53
00:01:42,540 --> 00:01:45,060
deploy their lockers so one of the

54
00:01:45,060 --> 00:01:46,079
things that we started seeing people

55
00:01:46,079 --> 00:01:48,600
move towards is using things like msps

56
00:01:48,600 --> 00:01:49,860
and other benign tools to start

57
00:01:49,860 --> 00:01:51,420
spreading them so as you can imagine

58
00:01:51,420 --> 00:01:53,579
rather than using a custom set of tools

59
00:01:53,579 --> 00:01:55,079
now you have stuff that actually should

60
00:01:55,079 --> 00:01:56,939
be on the computers and within the

61
00:01:56,939 --> 00:01:58,439
organization and that's a little bit

62
00:01:58,439 --> 00:01:59,880
harder to detect than something that's

63
00:01:59,880 --> 00:02:01,140
no malicious

64
00:02:01,140 --> 00:02:03,360
additionally kind of on the same vein

65
00:02:03,360 --> 00:02:04,979
we've seen them do some more lateral

66
00:02:04,979 --> 00:02:06,960
movement using things like SMB shares

67
00:02:06,960 --> 00:02:09,419
cifs and NFS so effectively using the

68
00:02:09,419 --> 00:02:10,979
way that the computers operate against

69
00:02:10,979 --> 00:02:13,319
them and then finally what we've seen is

70
00:02:13,319 --> 00:02:15,120
some threat actors like Alpha and some

71
00:02:15,120 --> 00:02:16,980
others start building impersonation

72
00:02:16,980 --> 00:02:19,319
tokens into the locker to allow them to

73
00:02:19,319 --> 00:02:21,180
spread the allow the locker to spread

74
00:02:21,180 --> 00:02:22,200
itself

75
00:02:22,200 --> 00:02:24,120
Additionally the optimization of some of

76
00:02:24,120 --> 00:02:26,280
their current offerings so a lot of

77
00:02:26,280 --> 00:02:28,020
people are using intermittent encryption

78
00:02:28,020 --> 00:02:29,879
because they want to make lockers faster

79
00:02:29,879 --> 00:02:32,040
faster is better more damage more profit

80
00:02:32,040 --> 00:02:34,319
and adding additional functionality to

81
00:02:34,319 --> 00:02:35,940
lockers based on affiliate demand and

82
00:02:35,940 --> 00:02:36,959
kind of like looking at what other

83
00:02:36,959 --> 00:02:38,459
people have and you know ultimately you

84
00:02:38,459 --> 00:02:40,319
want to attract people

85
00:02:40,319 --> 00:02:42,660
additionally seeing people fill the gaps

86
00:02:42,660 --> 00:02:44,879
in the ecosystem so one kind of really

87
00:02:44,879 --> 00:02:46,980
well-known example here would be black

88
00:02:46,980 --> 00:02:48,720
matter and Conti coming out with a Linux

89
00:02:48,720 --> 00:02:51,060
and esxi Locker after Revel and Darkseid

90
00:02:51,060 --> 00:02:52,680
disbanded and there weren't really any

91
00:02:52,680 --> 00:02:54,300
of those offerings out there

92
00:02:54,300 --> 00:02:56,459
additionally using Alpha looking at

93
00:02:56,459 --> 00:02:58,200
Alpha's edition of the chat access code

94
00:02:58,200 --> 00:02:59,700
to prevent chat hijacking which I'll

95
00:02:59,700 --> 00:03:01,140
talk about later

96
00:03:01,140 --> 00:03:03,120
they also have a victim files index site

97
00:03:03,120 --> 00:03:05,280
so being able to search the victim's

98
00:03:05,280 --> 00:03:08,040
files and see if see them more easily

99
00:03:08,040 --> 00:03:09,480
makes it easier for other threat actors

100
00:03:09,480 --> 00:03:10,739
to kind of look around

101
00:03:10,739 --> 00:03:12,599
and then finally making their panels

102
00:03:12,599 --> 00:03:14,459
more user friendly so how can that hurt

103
00:03:14,459 --> 00:03:17,220
so adding things like Bitcoin mixers

104
00:03:17,220 --> 00:03:18,540
um letting Affiliates put in support

105
00:03:18,540 --> 00:03:20,459
tickets if something's broken or the

106
00:03:20,459 --> 00:03:22,080
features or things like that and then

107
00:03:22,080 --> 00:03:24,180
helping them moderate their victims

108
00:03:24,180 --> 00:03:26,400
additionally really trying to make the

109
00:03:26,400 --> 00:03:28,200
victims pay so we've seen some

110
00:03:28,200 --> 00:03:30,599
additional extortion techniques so

111
00:03:30,599 --> 00:03:32,760
things like ddosing victims who won't

112
00:03:32,760 --> 00:03:35,280
pay calling their board members their

113
00:03:35,280 --> 00:03:37,319
customers clients things like that and

114
00:03:37,319 --> 00:03:38,819
contacting the media to really kind of

115
00:03:38,819 --> 00:03:40,500
make it way more well known that

116
00:03:40,500 --> 00:03:42,480
something bad has happened

117
00:03:42,480 --> 00:03:44,099
and I know we all think it's kind of

118
00:03:44,099 --> 00:03:45,959
amusing but printing the ransomware

119
00:03:45,959 --> 00:03:47,519
notes to actual physical printers has

120
00:03:47,519 --> 00:03:49,980
kind of a an incentivization purpose as

121
00:03:49,980 --> 00:03:52,200
well so it's much harder to hide a

122
00:03:52,200 --> 00:03:55,440
ransomware attack from the employees if

123
00:03:55,440 --> 00:03:57,060
it's coming if the ransom notes coming

124
00:03:57,060 --> 00:03:58,620
out of all the printers rather than just

125
00:03:58,620 --> 00:04:02,180
appearing on a couple people's screens

126
00:04:02,780 --> 00:04:05,400
so some things actually let something to

127
00:04:05,400 --> 00:04:07,980
be desired so I know as like developers

128
00:04:07,980 --> 00:04:09,299
we often say like don't roll your own

129
00:04:09,299 --> 00:04:11,519
crypto no seriously really don't

130
00:04:11,519 --> 00:04:12,840
um dark side and black matter both had

131
00:04:12,840 --> 00:04:15,180
encryption flaws that made people

132
00:04:15,180 --> 00:04:16,380
um not have to pay their ransoms to

133
00:04:16,380 --> 00:04:18,600
decrypt very bad for business we've seen

134
00:04:18,600 --> 00:04:20,519
several actors in The like past year or

135
00:04:20,519 --> 00:04:21,298
so

136
00:04:21,298 --> 00:04:22,740
um really try to do that false flag

137
00:04:22,740 --> 00:04:24,600
attribution thing so I'll talk more

138
00:04:24,600 --> 00:04:26,100
about these but a couple groups include

139
00:04:26,100 --> 00:04:27,780
lockbit

140
00:04:27,780 --> 00:04:30,120
um Zing Xiao ransomware and then a

141
00:04:30,120 --> 00:04:31,620
couple other things that came along with

142
00:04:31,620 --> 00:04:32,759
that

143
00:04:32,759 --> 00:04:34,500
sometimes you see some threat actors

144
00:04:34,500 --> 00:04:36,120
trying to make their malware harder to

145
00:04:36,120 --> 00:04:38,520
reverse engineer but kind of as an

146
00:04:38,520 --> 00:04:40,259
artifact of it make it more sanitrable

147
00:04:40,259 --> 00:04:41,759
so I'll talk a little bit about the

148
00:04:41,759 --> 00:04:43,919
alphamorph Linux variant

149
00:04:43,919 --> 00:04:45,120
um locked it black and then everybody

150
00:04:45,120 --> 00:04:47,100
else using the leaked black matter code

151
00:04:47,100 --> 00:04:48,840
and then the use of automated

152
00:04:48,840 --> 00:04:51,479
obfuscation like play an alpha did

153
00:04:51,479 --> 00:04:54,000
additionally making your tools so secure

154
00:04:54,000 --> 00:04:55,979
that nobody can actually use it also not

155
00:04:55,979 --> 00:04:58,560
great for business so you can see on the

156
00:04:58,560 --> 00:05:01,340
right uh part of the

157
00:05:01,340 --> 00:05:04,620
panel to get into

158
00:05:04,620 --> 00:05:06,600
um to get into the affiliate panel so it

159
00:05:06,600 --> 00:05:08,040
required a tour private key which is

160
00:05:08,040 --> 00:05:09,600
significantly more challenging to

161
00:05:09,600 --> 00:05:12,600
implement than not so harder to harder

162
00:05:12,600 --> 00:05:14,940
to do and then finally when you let

163
00:05:14,940 --> 00:05:17,400
politics get involved so Conti sided

164
00:05:17,400 --> 00:05:18,900
with Russia and Russia Ukraine Invasion

165
00:05:18,900 --> 00:05:21,979
and we'll talk about what happened after

166
00:05:22,860 --> 00:05:25,139
so in kind of the spirit of Dua Lipa I'm

167
00:05:25,139 --> 00:05:26,160
going to talk a little bit about the new

168
00:05:26,160 --> 00:05:27,960
rules of being a successful ransomware

169
00:05:27,960 --> 00:05:31,280
threat actor in this day and age

170
00:05:31,500 --> 00:05:33,900
so first play ransomware so in case

171
00:05:33,900 --> 00:05:35,759
you're not familiar play is a relatively

172
00:05:35,759 --> 00:05:37,800
new but fairly active ransomware variant

173
00:05:37,800 --> 00:05:40,440
that we first observed in June 2022.

174
00:05:40,440 --> 00:05:41,759
like many kind of more traditional

175
00:05:41,759 --> 00:05:43,800
ransomware variants it's written in C

176
00:05:43,800 --> 00:05:46,440
plus plus and was first used in August

177
00:05:46,440 --> 00:05:49,199
2022 against the Argentina Cordoba and

178
00:05:49,199 --> 00:05:50,160
then you can see some of their other

179
00:05:50,160 --> 00:05:51,419
victims there

180
00:05:51,419 --> 00:05:53,400
some of the notable features include so

181
00:05:53,400 --> 00:05:55,139
the minimal Ransom note so if you've

182
00:05:55,139 --> 00:05:56,580
ever seen kind of a ransom note before

183
00:05:56,580 --> 00:05:58,500
usually there's a lot of verbiage of who

184
00:05:58,500 --> 00:06:00,060
did it what happens if you don't pay

185
00:06:00,060 --> 00:06:04,259
very detailed instructions of how to pay

186
00:06:04,259 --> 00:06:05,580
um you can see on the bottom on the

187
00:06:05,580 --> 00:06:07,740
right the play Ransom note so very

188
00:06:07,740 --> 00:06:09,840
minimal just says play and gives you an

189
00:06:09,840 --> 00:06:11,340
email to contact

190
00:06:11,340 --> 00:06:12,600
additionally we'll talk about the

191
00:06:12,600 --> 00:06:15,419
addition of return on age of programming

192
00:06:15,419 --> 00:06:17,460
and other added obfuscations and

193
00:06:17,460 --> 00:06:19,680
intermittent encryption

194
00:06:19,680 --> 00:06:21,660
yeah so I really did say Rob and

195
00:06:21,660 --> 00:06:22,979
ransomware so in case you're not super

196
00:06:22,979 --> 00:06:24,479
familiar with how returning into

197
00:06:24,479 --> 00:06:26,340
programming Works

198
00:06:26,340 --> 00:06:28,740
um effectively it takes uh advantage of

199
00:06:28,740 --> 00:06:30,600
the art how the rhet instruction works

200
00:06:30,600 --> 00:06:33,720
so you can see on the right you have you

201
00:06:33,720 --> 00:06:36,060
increment stack pointer then you do your

202
00:06:36,060 --> 00:06:38,220
turn effectively what happens is this

203
00:06:38,220 --> 00:06:40,979
causes a jump to the real code which you

204
00:06:40,979 --> 00:06:43,259
can see on the bottom so this is kind of

205
00:06:43,259 --> 00:06:45,960
how play implemented their return rate

206
00:06:45,960 --> 00:06:47,460
to programming which effectively makes

207
00:06:47,460 --> 00:06:49,259
it harder to both statically and

208
00:06:49,259 --> 00:06:50,880
dynamically reverse engineer not

209
00:06:50,880 --> 00:06:52,740
impossible but that's what it looks like

210
00:06:52,740 --> 00:06:54,060
and then they have a bunch of kind of

211
00:06:54,060 --> 00:06:55,500
garbage code bites so it makes a little

212
00:06:55,500 --> 00:06:57,240
bit harder for computer to kind of

213
00:06:57,240 --> 00:06:58,500
figure out what's going on

214
00:06:58,500 --> 00:07:00,300
and a little bit of manual fix up is

215
00:07:00,300 --> 00:07:01,259
required

216
00:07:01,259 --> 00:07:03,960
so you can see on the left before play

217
00:07:03,960 --> 00:07:06,660
added the wrap what their code looked

218
00:07:06,660 --> 00:07:08,340
like so pretty straightforward pretty

219
00:07:08,340 --> 00:07:09,720
easy to understand but that should give

220
00:07:09,720 --> 00:07:12,600
you some idea of what the difference is

221
00:07:12,600 --> 00:07:14,280
so if you're a threat actor adding

222
00:07:14,280 --> 00:07:16,020
obvious question is great but definitely

223
00:07:16,020 --> 00:07:18,240
consider doing it from the start so the

224
00:07:18,240 --> 00:07:20,340
first place sample that we looked at was

225
00:07:20,340 --> 00:07:22,919
from about mid-june 2022 so it had a

226
00:07:22,919 --> 00:07:24,900
couple things so string obfuscation so

227
00:07:24,900 --> 00:07:26,639
you can see on the top right an example

228
00:07:26,639 --> 00:07:28,560
of the string obfuscation not wildly

229
00:07:28,560 --> 00:07:30,120
challenging but that's kind of the

230
00:07:30,120 --> 00:07:32,099
algorithm that they used they also had

231
00:07:32,099 --> 00:07:34,020
an API hashing technique so making it a

232
00:07:34,020 --> 00:07:35,639
little bit more challenging to do some

233
00:07:35,639 --> 00:07:37,979
of the static reverse engineering But

234
00:07:37,979 --> 00:07:39,599
ultimately outside of these two things

235
00:07:39,599 --> 00:07:41,639
pretty easy to reverse engineering

236
00:07:41,639 --> 00:07:42,960
pretty straightforward

237
00:07:42,960 --> 00:07:44,759
so the additional obfuscations first

238
00:07:44,759 --> 00:07:47,520
came in in August 2022 so like I

239
00:07:47,520 --> 00:07:49,319
mentioned the wrap and then they also

240
00:07:49,319 --> 00:07:50,520
started doing some garbage code

241
00:07:50,520 --> 00:07:52,800
insertion so you can see an example of

242
00:07:52,800 --> 00:07:54,360
the garbage code insertion so really

243
00:07:54,360 --> 00:07:56,280
what this just functions to do is

244
00:07:56,280 --> 00:07:57,479
do nothing

245
00:07:57,479 --> 00:07:59,819
um and or nothing of use really and just

246
00:07:59,819 --> 00:08:01,319
make it more like you have to look at

247
00:08:01,319 --> 00:08:03,419
more stuff so that's what the automated

248
00:08:03,419 --> 00:08:05,160
code insertion looks like

249
00:08:05,160 --> 00:08:07,680
so while Rob is definitely a positive a

250
00:08:07,680 --> 00:08:09,419
positive addition for them to have made

251
00:08:09,419 --> 00:08:11,819
and makes the code effectively hard to

252
00:08:11,819 --> 00:08:14,460
reverse engineer it's notable that the

253
00:08:14,460 --> 00:08:15,780
underlying functionality really didn't

254
00:08:15,780 --> 00:08:17,460
change so if you reverse engineered

255
00:08:17,460 --> 00:08:19,020
unofficecated one which pretty easy to

256
00:08:19,020 --> 00:08:20,699
find on the internet then it really kind

257
00:08:20,699 --> 00:08:21,599
of gives you an idea of what you're

258
00:08:21,599 --> 00:08:23,039
looking for in the second one it's easy

259
00:08:23,039 --> 00:08:24,900
to match up

260
00:08:24,900 --> 00:08:26,639
additionally looking at that automated

261
00:08:26,639 --> 00:08:28,680
garbage code insertion um it was

262
00:08:28,680 --> 00:08:30,300
actually pretty signature so I was able

263
00:08:30,300 --> 00:08:32,159
to write a signature looking for how

264
00:08:32,159 --> 00:08:34,799
they did that so to find other copies so

265
00:08:34,799 --> 00:08:35,760
if you're trying to make your malware

266
00:08:35,760 --> 00:08:37,260
less signageable

267
00:08:37,260 --> 00:08:40,760
not really super successful

268
00:08:45,300 --> 00:08:47,580
so additionally if you're a threat actor

269
00:08:47,580 --> 00:08:48,660
you really want to kind of give the

270
00:08:48,660 --> 00:08:50,760
people what they want so intermittent

271
00:08:50,760 --> 00:08:52,200
encryption is something a play

272
00:08:52,200 --> 00:08:54,420
implements and what we've seen is that

273
00:08:54,420 --> 00:08:56,279
like some other fat actors they'll

274
00:08:56,279 --> 00:08:58,680
encrypt every other one megabyte of data

275
00:08:58,680 --> 00:09:00,839
so this is something that they

276
00:09:00,839 --> 00:09:03,480
introduced in June 2022 so it's been

277
00:09:03,480 --> 00:09:05,040
there from the beginning and the reason

278
00:09:05,040 --> 00:09:06,540
you want to be able to do this is

279
00:09:06,540 --> 00:09:08,040
because you want to encrypt as much as

280
00:09:08,040 --> 00:09:10,140
you can as fast as you can so as you can

281
00:09:10,140 --> 00:09:11,339
imagine if you're conducting a

282
00:09:11,339 --> 00:09:12,720
ransomware attack the more you can

283
00:09:12,720 --> 00:09:14,040
encrypt the quicker you can encrypt

284
00:09:14,040 --> 00:09:15,300
before somebody figures out what you're

285
00:09:15,300 --> 00:09:17,399
doing and stops you the better so more

286
00:09:17,399 --> 00:09:19,500
damage more likely to pay

287
00:09:19,500 --> 00:09:20,760
so

288
00:09:20,760 --> 00:09:22,920
doing it this way also makes it less

289
00:09:22,920 --> 00:09:24,779
recoverable than just encrypting the

290
00:09:24,779 --> 00:09:27,240
first however many bytes so some threat

291
00:09:27,240 --> 00:09:28,740
actors would encrypt the first let's say

292
00:09:28,740 --> 00:09:30,600
10 megabytes and then just leave the

293
00:09:30,600 --> 00:09:32,519
rest of the file great on small files

294
00:09:32,519 --> 00:09:34,500
not so great on files that are like five

295
00:09:34,500 --> 00:09:36,480
six seven gigs because more data to

296
00:09:36,480 --> 00:09:37,980
recover

297
00:09:37,980 --> 00:09:39,420
um other Fred actor groups are also

298
00:09:39,420 --> 00:09:40,920
implementing this so some very well

299
00:09:40,920 --> 00:09:43,080
known ones like agenda Alpha and black

300
00:09:43,080 --> 00:09:45,180
bastard name a few and you can see what

301
00:09:45,180 --> 00:09:47,880
the um encryption looks like kind of the

302
00:09:47,880 --> 00:09:50,899
file perspective

303
00:09:50,899 --> 00:09:53,160
So speaking of alpha

304
00:09:53,160 --> 00:09:55,200
um they're a rebranded black matter so

305
00:09:55,200 --> 00:09:57,420
back in the day we had Darkseid they

306
00:09:57,420 --> 00:09:59,940
attacked Colonial pipeline got a lot of

307
00:09:59,940 --> 00:10:01,440
law enforcement attention because that

308
00:10:01,440 --> 00:10:03,480
was very bad so the group ultimately

309
00:10:03,480 --> 00:10:04,740
disbanded because there was too much

310
00:10:04,740 --> 00:10:07,140
attention on them later they re-energis

311
00:10:07,140 --> 00:10:08,700
black matter who had some decryption

312
00:10:08,700 --> 00:10:10,980
issues of their ransomware so people

313
00:10:10,980 --> 00:10:13,560
weren't having to pay the ransom to get

314
00:10:13,560 --> 00:10:15,360
their files decrypted not great for

315
00:10:15,360 --> 00:10:17,820
business either so we later saw them pop

316
00:10:17,820 --> 00:10:20,580
back up as Alpha and we first started to

317
00:10:20,580 --> 00:10:21,660
see something that ransomware in

318
00:10:21,660 --> 00:10:23,100
December 2021

319
00:10:23,100 --> 00:10:24,779
so they're known for a lot of their

320
00:10:24,779 --> 00:10:27,300
attacks and infrastructure so Colonial

321
00:10:27,300 --> 00:10:28,860
pipeline as I mentioned is dark side as

322
00:10:28,860 --> 00:10:30,060
well as some other ones that you can see

323
00:10:30,060 --> 00:10:31,320
listed there

324
00:10:31,320 --> 00:10:32,940
so some of their notable features here

325
00:10:32,940 --> 00:10:34,500
that I'll talk about is that they were

326
00:10:34,500 --> 00:10:36,540
the first big ransomware that was

327
00:10:36,540 --> 00:10:38,339
written in Rust they were the first big

328
00:10:38,339 --> 00:10:40,320
ransomware variant with an arm lock or

329
00:10:40,320 --> 00:10:41,760
kind of mainstream

330
00:10:41,760 --> 00:10:43,440
and they have this thing called the

331
00:10:43,440 --> 00:10:45,180
build time obfuscation toolkit more

332
00:10:45,180 --> 00:10:47,459
fiddle talk about as well use chat

333
00:10:47,459 --> 00:10:49,140
access tokens and then the alpha

334
00:10:49,140 --> 00:10:51,180
collections blog so the searchable

335
00:10:51,180 --> 00:10:55,699
victim files index

336
00:10:56,220 --> 00:10:59,339
so access tokens so another thing that

337
00:10:59,339 --> 00:11:00,720
happened when the group was known as

338
00:11:00,720 --> 00:11:03,839
black matter is researchers happen to

339
00:11:03,839 --> 00:11:06,120
find a copy of their ransomware buyers

340
00:11:06,120 --> 00:11:08,100
total or the internet or something they

341
00:11:08,100 --> 00:11:10,140
looked at the victim portal link first

342
00:11:10,140 --> 00:11:12,420
engineered it clicked on it and accessed

343
00:11:12,420 --> 00:11:13,980
it so the problem was there was an

344
00:11:13,980 --> 00:11:15,540
active victim negotiation at that time

345
00:11:15,540 --> 00:11:18,000
and then everybody from the internet

346
00:11:18,000 --> 00:11:20,339
also joined in on that negotiation which

347
00:11:20,339 --> 00:11:21,899
was very frustrating upsetting to the

348
00:11:21,899 --> 00:11:24,300
threat actor so at this point uh the

349
00:11:24,300 --> 00:11:25,800
victim chat was useless they couldn't

350
00:11:25,800 --> 00:11:27,420
negotiate figure out who the victim was

351
00:11:27,420 --> 00:11:29,519
so as a result they had to close it down

352
00:11:29,519 --> 00:11:31,019
and then try and figure out who the real

353
00:11:31,019 --> 00:11:34,380
victim was so they required the the

354
00:11:34,380 --> 00:11:36,360
actual victim to provide domain

355
00:11:36,360 --> 00:11:37,980
controller names and domain admin names

356
00:11:37,980 --> 00:11:39,660
in order to kind of restart the

357
00:11:39,660 --> 00:11:41,519
negotiation but obviously this isn't

358
00:11:41,519 --> 00:11:44,220
great so when the group popped back up

359
00:11:44,220 --> 00:11:45,959
as Alpha they implemented something

360
00:11:45,959 --> 00:11:47,940
called the access token as a locker

361
00:11:47,940 --> 00:11:50,519
parameter so at build time when you

362
00:11:50,519 --> 00:11:53,399
build your copy as an affiliate you get

363
00:11:53,399 --> 00:11:56,120
a an access token so your particular

364
00:11:56,120 --> 00:11:58,800
binary and your access token and what

365
00:11:58,800 --> 00:12:00,540
this does is when you run the ransomware

366
00:12:00,540 --> 00:12:01,800
you have to provide that proper access

367
00:12:01,800 --> 00:12:03,839
token to generate the correct victim

368
00:12:03,839 --> 00:12:06,600
link so you can run it with kind of any

369
00:12:06,600 --> 00:12:08,279
access token but you won't get to the

370
00:12:08,279 --> 00:12:10,260
right link so unless you have both

371
00:12:10,260 --> 00:12:12,899
pieces if this prevents researchers from

372
00:12:12,899 --> 00:12:15,540
being able to you know find your Ransom

373
00:12:15,540 --> 00:12:16,920
on the internet and then also do the

374
00:12:16,920 --> 00:12:18,600
same thing that happened before

375
00:12:18,600 --> 00:12:20,399
so effectively now you're creating a

376
00:12:20,399 --> 00:12:21,839
more secure line of communication with

377
00:12:21,839 --> 00:12:24,360
your victims you can't just find the

378
00:12:24,360 --> 00:12:27,860
victim page through sample.nation

379
00:12:27,980 --> 00:12:31,740
so rust so this again is the first big

380
00:12:31,740 --> 00:12:34,440
ransomware written in Rust so previously

381
00:12:34,440 --> 00:12:36,420
we would generally saw things like CC

382
00:12:36,420 --> 00:12:38,220
plus plus sometimes you'll see Delphi

383
00:12:38,220 --> 00:12:40,860
off and you'll see going lately

384
00:12:40,860 --> 00:12:42,959
umickerstealer is written in Rust as

385
00:12:42,959 --> 00:12:45,779
well pretty popular stealer but in terms

386
00:12:45,779 --> 00:12:47,339
of ransomware that was kind of really it

387
00:12:47,339 --> 00:12:48,540
at the time

388
00:12:48,540 --> 00:12:50,579
so part of the benefit of using rust is

389
00:12:50,579 --> 00:12:52,680
that it's cross compilable so you write

390
00:12:52,680 --> 00:12:54,240
one set of code and then you can get out

391
00:12:54,240 --> 00:12:56,040
of it at Windows Linux and arm logger

392
00:12:56,040 --> 00:12:57,360
which is pretty good

393
00:12:57,360 --> 00:12:59,880
and as a bonus one I'm very familiar

394
00:12:59,880 --> 00:13:01,680
with is the reverse engineering at the

395
00:13:01,680 --> 00:13:03,240
time was significantly more challenging

396
00:13:03,240 --> 00:13:05,519
for a couple reasons so Library

397
00:13:05,519 --> 00:13:07,860
functions um it's not always apparent

398
00:13:07,860 --> 00:13:10,139
that it is a library function so

399
00:13:10,139 --> 00:13:11,760
sometimes they'll look like non-library

400
00:13:11,760 --> 00:13:13,320
interesting code so if you're trying to

401
00:13:13,320 --> 00:13:14,940
reverse engineer a very large binary

402
00:13:14,940 --> 00:13:16,920
which generally the rest ones are and

403
00:13:16,920 --> 00:13:17,760
you're trying to find kind of the

404
00:13:17,760 --> 00:13:19,019
interesting stuff to look at it's a

405
00:13:19,019 --> 00:13:20,579
little more complicated than like CC

406
00:13:20,579 --> 00:13:23,399
plus stuff like that additionally you'll

407
00:13:23,399 --> 00:13:24,899
see a lot of the runtime code in the

408
00:13:24,899 --> 00:13:26,760
binary so things like error handling so

409
00:13:26,760 --> 00:13:28,800
if you can see in the top image you see

410
00:13:28,800 --> 00:13:30,360
kind of the code and then you see a lot

411
00:13:30,360 --> 00:13:32,760
of that error handling code in that so

412
00:13:32,760 --> 00:13:34,560
what it functions to do is just make a

413
00:13:34,560 --> 00:13:36,660
binary kind of bigger more stuff to look

414
00:13:36,660 --> 00:13:37,920
at and you have to kind of scroll

415
00:13:37,920 --> 00:13:40,380
through it and kind of ignore that as

416
00:13:40,380 --> 00:13:42,779
you start doing reverse engineering

417
00:13:42,779 --> 00:13:44,160
additionally if you're familiar with

418
00:13:44,160 --> 00:13:45,240
golang

419
00:13:45,240 --> 00:13:47,339
um like golang the strings are not null

420
00:13:47,339 --> 00:13:49,139
terminated so what this does is you can

421
00:13:49,139 --> 00:13:51,000
see in the bottom edge here so it runs

422
00:13:51,000 --> 00:13:53,360
them all together requires some kind of

423
00:13:53,360 --> 00:13:56,339
pre-processing like fix up that you have

424
00:13:56,339 --> 00:13:57,839
to do to start figuring out where all

425
00:13:57,839 --> 00:13:58,980
the strings go

426
00:13:58,980 --> 00:14:01,260
and kind of on that same vein right now

427
00:14:01,260 --> 00:14:03,480
the fix up tools are significantly more

428
00:14:03,480 --> 00:14:05,880
nascent than if golang so when golang

429
00:14:05,880 --> 00:14:07,800
started being a big thing

430
00:14:07,800 --> 00:14:09,000
um didn't really have a lot of fix-up

431
00:14:09,000 --> 00:14:10,320
tools so we're kind of in that stage

432
00:14:10,320 --> 00:14:12,720
with rust

433
00:14:12,720 --> 00:14:15,260
okay

434
00:14:18,240 --> 00:14:21,600
so yeah continuing I did in fact say an

435
00:14:21,600 --> 00:14:23,519
arm Locker so the way that the group

436
00:14:23,519 --> 00:14:26,279
advertises this is that you can use this

437
00:14:26,279 --> 00:14:29,160
to Target different Nas devices so qnap

438
00:14:29,160 --> 00:14:31,860
Synology and other ones like that

439
00:14:31,860 --> 00:14:33,660
um it's meant to be used in parallel to

440
00:14:33,660 --> 00:14:36,480
your windows and Linux and esxi lockers

441
00:14:36,480 --> 00:14:39,000
so obviously you can lock window systems

442
00:14:39,000 --> 00:14:41,100
or Linux and esxi ones where people

443
00:14:41,100 --> 00:14:42,779
might host a lot of their infrastructure

444
00:14:42,779 --> 00:14:45,000
things like that but now you can also go

445
00:14:45,000 --> 00:14:46,920
after their backups and uncommon file

446
00:14:46,920 --> 00:14:49,620
share types so really what this the

447
00:14:49,620 --> 00:14:51,360
purpose of this is to increase the

448
00:14:51,360 --> 00:14:52,860
ultimate effectiveness of a ransomware

449
00:14:52,860 --> 00:14:55,019
attack so obviously the more you can

450
00:14:55,019 --> 00:14:57,000
encrypt the less kind of recoverable it

451
00:14:57,000 --> 00:14:59,100
is for the company and

452
00:14:59,100 --> 00:15:00,480
previously if you weren't able to

453
00:15:00,480 --> 00:15:01,620
encrypt kind of their backups and

454
00:15:01,620 --> 00:15:03,600
uncommon file shares now you are so

455
00:15:03,600 --> 00:15:05,519
that's kind of one more sort of safety

456
00:15:05,519 --> 00:15:07,380
that the company might have had that now

457
00:15:07,380 --> 00:15:09,300
don't have any more

458
00:15:09,300 --> 00:15:11,100
so today I haven't really seen it used

459
00:15:11,100 --> 00:15:12,420
in a while at all

460
00:15:12,420 --> 00:15:13,800
um that's not to say that it won't be

461
00:15:13,800 --> 00:15:15,180
but

462
00:15:15,180 --> 00:15:17,940
so far so that's where we are

463
00:15:17,940 --> 00:15:19,500
um and ultimately though arm lockers

464
00:15:19,500 --> 00:15:21,720
really aren't super common to see

465
00:15:21,720 --> 00:15:23,459
um especially not by like big ransomware

466
00:15:23,459 --> 00:15:25,500
groups so chaos ransomware and some

467
00:15:25,500 --> 00:15:27,660
other groups also have one but in terms

468
00:15:27,660 --> 00:15:29,399
of kind of those big names um this is

469
00:15:29,399 --> 00:15:30,839
the first one we've seen

470
00:15:30,839 --> 00:15:32,459
foreign

471
00:15:32,459 --> 00:15:34,980
so moving on to alphamorph so alphamorph

472
00:15:34,980 --> 00:15:37,320
was advertised as an obfuscation toolkit

473
00:15:37,320 --> 00:15:39,420
so both for their windows and their

474
00:15:39,420 --> 00:15:41,639
Linux so the way that they advertised it

475
00:15:41,639 --> 00:15:42,600
is

476
00:15:42,600 --> 00:15:45,120
it will help the malware evade AV

477
00:15:45,120 --> 00:15:46,620
detection

478
00:15:46,620 --> 00:15:48,240
um kind of through the automated

479
00:15:48,240 --> 00:15:50,760
obfuscation of strings and garbage code

480
00:15:50,760 --> 00:15:51,660
Edition

481
00:15:51,660 --> 00:15:53,880
so as promised the windows version did

482
00:15:53,880 --> 00:15:56,339
in fact have string obfuscation

483
00:15:56,339 --> 00:15:59,220
so the way that they do it is at a very

484
00:15:59,220 --> 00:16:01,740
simple one byte xor so randomly chosen

485
00:16:01,740 --> 00:16:04,680
sink bite and then randomly generated

486
00:16:04,680 --> 00:16:07,860
code to Deoxys get it so you can see on

487
00:16:07,860 --> 00:16:09,420
the left

488
00:16:09,420 --> 00:16:10,860
um the de obfuscation function for the

489
00:16:10,860 --> 00:16:12,899
strings really the only kind of salient

490
00:16:12,899 --> 00:16:15,899
point is the X Y value with eight uh the

491
00:16:15,899 --> 00:16:18,360
rest fits garbage code so when you kind

492
00:16:18,360 --> 00:16:21,000
of look at Alpha Morph generated files

493
00:16:21,000 --> 00:16:23,160
in general what you'll see is you'll see

494
00:16:23,160 --> 00:16:25,139
like a lot of like Global kind of

495
00:16:25,139 --> 00:16:27,420
arithmetic operations that have no

496
00:16:27,420 --> 00:16:28,920
purpose and you can kind of see some of

497
00:16:28,920 --> 00:16:31,260
them there so generally with their

498
00:16:31,260 --> 00:16:33,300
garbage code insertion looks like

499
00:16:33,300 --> 00:16:34,920
another thing that's notable about the

500
00:16:34,920 --> 00:16:37,500
windows morph obfuscation is that the

501
00:16:37,500 --> 00:16:39,060
binaries were now over four times the

502
00:16:39,060 --> 00:16:40,920
size of their unobvious data versions so

503
00:16:40,920 --> 00:16:42,180
the rest binders are actually pretty big

504
00:16:42,180 --> 00:16:44,339
right they're about three megabytes and

505
00:16:44,339 --> 00:16:46,139
the obvious Gator versions were about

506
00:16:46,139 --> 00:16:49,740
14. so significantly bigger and most of

507
00:16:49,740 --> 00:16:52,259
the size increase was in the text data

508
00:16:52,259 --> 00:16:53,820
and relocation section

509
00:16:53,820 --> 00:16:55,380
primarily because of how I guess this

510
00:16:55,380 --> 00:16:57,240
obstacation does work so that's where

511
00:16:57,240 --> 00:16:59,940
the biggest increases are

512
00:16:59,940 --> 00:17:01,320
so

513
00:17:01,320 --> 00:17:02,820
it's really important as a threat actor

514
00:17:02,820 --> 00:17:05,160
though to check your work so they also

515
00:17:05,160 --> 00:17:07,380
offered it for their Linux and esxi

516
00:17:07,380 --> 00:17:10,619
builds so looking at it um didn't

517
00:17:10,619 --> 00:17:12,299
actually see any string obfuscation at

518
00:17:12,299 --> 00:17:14,459
all so that was not as promised however

519
00:17:14,459 --> 00:17:16,679
if you look at the Linux x64 morph

520
00:17:16,679 --> 00:17:18,780
obfuscated samples now what you see is

521
00:17:18,780 --> 00:17:20,819
like if you're familiar with the com uh

522
00:17:20,819 --> 00:17:23,160
the concept of name angling you start to

523
00:17:23,160 --> 00:17:24,839
see instead of kind of the scrub names

524
00:17:24,839 --> 00:17:26,699
you start to see like versions of sort

525
00:17:26,699 --> 00:17:29,280
of name angle function names so you can

526
00:17:29,280 --> 00:17:31,740
see on the left for the unobfuscated

527
00:17:31,740 --> 00:17:33,299
Linux versions

528
00:17:33,299 --> 00:17:35,280
um functions don't have any names with

529
00:17:35,280 --> 00:17:36,780
the word Locker in it

530
00:17:36,780 --> 00:17:38,880
um those are all the exported variables

531
00:17:38,880 --> 00:17:40,919
nothing kind of untoward or that really

532
00:17:40,919 --> 00:17:42,179
gives you some idea of what this is

533
00:17:42,179 --> 00:17:43,440
doing

534
00:17:43,440 --> 00:17:45,660
however if you look on the right you can

535
00:17:45,660 --> 00:17:48,480
see the obfuscated x64 Linux and es6i

536
00:17:48,480 --> 00:17:49,860
samples so you start to see some of

537
00:17:49,860 --> 00:17:51,120
those function names kind of coming out

538
00:17:51,120 --> 00:17:52,679
which feature reverse engineering you're

539
00:17:52,679 --> 00:17:54,240
like yes now I can start figuring out

540
00:17:54,240 --> 00:17:55,620
what's going on function names are very

541
00:17:55,620 --> 00:17:57,660
helpful but very rarely seen so you

542
00:17:57,660 --> 00:17:59,160
start to see like some of the locker

543
00:17:59,160 --> 00:18:01,740
core kind of concept stuff and you start

544
00:18:01,740 --> 00:18:04,679
to see in the 32-bit samples the

545
00:18:04,679 --> 00:18:07,080
exported variables from the obfuscated

546
00:18:07,080 --> 00:18:09,120
ones you can start to see some of that

547
00:18:09,120 --> 00:18:12,240
similar name angling so they no longer

548
00:18:12,240 --> 00:18:14,280
offer this I'm not entirely sure why but

549
00:18:14,280 --> 00:18:18,200
so it's not available anymore

550
00:18:18,780 --> 00:18:20,640
but yeah no really checking your work is

551
00:18:20,640 --> 00:18:22,260
actually super important

552
00:18:22,260 --> 00:18:24,539
um if you are going to build a locker

553
00:18:24,539 --> 00:18:27,000
especially so something that we've seen

554
00:18:27,000 --> 00:18:29,280
is that fully testing the encryption and

555
00:18:29,280 --> 00:18:31,980
decryption while very critical

556
00:18:31,980 --> 00:18:33,240
um there have been several mistakes over

557
00:18:33,240 --> 00:18:35,520
the past couple years so again this is

558
00:18:35,520 --> 00:18:36,660
something to track because that's how

559
00:18:36,660 --> 00:18:38,640
you make money corrupting people's files

560
00:18:38,640 --> 00:18:41,039
so a very kind of recent example if

561
00:18:41,039 --> 00:18:42,720
everybody remembers the ESX irgs from

562
00:18:42,720 --> 00:18:45,660
like a month ago the first version what

563
00:18:45,660 --> 00:18:47,820
they were doing is they were again using

564
00:18:47,820 --> 00:18:49,919
intermittent encryption however they

565
00:18:49,919 --> 00:18:51,960
would encrypt one megabyte and then skip

566
00:18:51,960 --> 00:18:54,419
X based on some calculation that

567
00:18:54,419 --> 00:18:56,580
determined that X is approximately one

568
00:18:56,580 --> 00:18:59,520
percent of the file size so great again

569
00:18:59,520 --> 00:19:01,200
if the file is small but if you have a

570
00:19:01,200 --> 00:19:05,640
450 gigabyte like VM image let's say

571
00:19:05,640 --> 00:19:07,740
um which might be on esxi um you'd

572
00:19:07,740 --> 00:19:09,840
encrypt one megabyte skip about four and

573
00:19:09,840 --> 00:19:11,160
a half gigs and then encrypt one

574
00:19:11,160 --> 00:19:13,260
megabyte so what happened is this made

575
00:19:13,260 --> 00:19:15,240
it recovery possible for those very

576
00:19:15,240 --> 00:19:17,160
large files because it was so small the

577
00:19:17,160 --> 00:19:19,080
amount that they're encrypting at a time

578
00:19:19,080 --> 00:19:22,200
version two actually fixed this bug

579
00:19:22,200 --> 00:19:25,200
next Luna ransomware so they had an es6i

580
00:19:25,200 --> 00:19:28,500
Locker in about 2022. and generally if

581
00:19:28,500 --> 00:19:30,900
you look at esxi lockers what happens is

582
00:19:30,900 --> 00:19:33,240
they find all the VMS they will shut

583
00:19:33,240 --> 00:19:34,799
them down and then they will encrypt

584
00:19:34,799 --> 00:19:36,840
them so what Luna did is they did not do

585
00:19:36,840 --> 00:19:38,880
this they just encrypted them without

586
00:19:38,880 --> 00:19:40,559
shutting them down which is you're

587
00:19:40,559 --> 00:19:42,539
probably familiar with might mean that

588
00:19:42,539 --> 00:19:43,919
when you try to decrypt them they are

589
00:19:43,919 --> 00:19:46,200
now corrupted also very bad for business

590
00:19:46,200 --> 00:19:47,880
if you're not actually encrypting

591
00:19:47,880 --> 00:19:49,380
people's files after you've made them

592
00:19:49,380 --> 00:19:51,960
pay and you promised to do so

593
00:19:51,960 --> 00:19:54,480
next black matter dark side I alluded to

594
00:19:54,480 --> 00:19:56,880
this before so

595
00:19:56,880 --> 00:19:58,320
um because they decided to roll their

596
00:19:58,320 --> 00:20:01,020
own crypto what this meant is that there

597
00:20:01,020 --> 00:20:03,120
was a cryptographic flaw that allowed

598
00:20:03,120 --> 00:20:04,679
researchers to help decrypt some of

599
00:20:04,679 --> 00:20:06,720
their victims without payment so

600
00:20:06,720 --> 00:20:09,360
obviously super embarrassing in addition

601
00:20:09,360 --> 00:20:10,440
to some of the other stuff that happened

602
00:20:10,440 --> 00:20:12,539
to black matter ultimately led to them

603
00:20:12,539 --> 00:20:14,400
rebranding of

604
00:20:14,400 --> 00:20:16,200
and then finally Rue Grant somewhere in

605
00:20:16,200 --> 00:20:18,720
about 2019. so they had a buggy

606
00:20:18,720 --> 00:20:19,919
decrypter that didn't work on a lot of

607
00:20:19,919 --> 00:20:22,140
Trials again also bad for business

608
00:20:22,140 --> 00:20:24,720
so um this is definitely something that

609
00:20:24,720 --> 00:20:27,600
well not like a super big Trend keeps

610
00:20:27,600 --> 00:20:29,340
happening so potentially in the future

611
00:20:29,340 --> 00:20:31,559
as ransomware actors keep riding their

612
00:20:31,559 --> 00:20:32,640
lockers

613
00:20:32,640 --> 00:20:34,559
um something that we expect to maybe see

614
00:20:34,559 --> 00:20:36,860
in the future

615
00:20:36,860 --> 00:20:39,600
so moving on to lock bit so they're one

616
00:20:39,600 --> 00:20:41,280
of the most active ransomware groups

617
00:20:41,280 --> 00:20:44,039
today so their original version was

618
00:20:44,039 --> 00:20:46,080
written in urgency and they've been

619
00:20:46,080 --> 00:20:48,240
around since September 2019. so here's a

620
00:20:48,240 --> 00:20:49,679
couple other victims

621
00:20:49,679 --> 00:20:51,900
um but they've had many over the past

622
00:20:51,900 --> 00:20:53,280
four years

623
00:20:53,280 --> 00:20:54,840
so some of their notable features are

624
00:20:54,840 --> 00:20:56,460
steel bit the automated data

625
00:20:56,460 --> 00:20:58,500
exfiltration tool the recruiting of

626
00:20:58,500 --> 00:21:00,720
insiders so we haven't seen other victim

627
00:21:00,720 --> 00:21:02,820
other ransomware groups do this but they

628
00:21:02,820 --> 00:21:05,700
were offering money payment jobs to

629
00:21:05,700 --> 00:21:07,919
people who are in organizations to

630
00:21:07,919 --> 00:21:09,299
provide initial access to that

631
00:21:09,299 --> 00:21:12,120
organization so if you provide a way in

632
00:21:12,120 --> 00:21:14,039
for lockbit to your organization they'll

633
00:21:14,039 --> 00:21:15,539
pay you it's not something we've seen

634
00:21:15,539 --> 00:21:17,520
other people do in additionally I'll

635
00:21:17,520 --> 00:21:18,660
talk about what happened when their

636
00:21:18,660 --> 00:21:21,419
Builder got leaked

637
00:21:21,419 --> 00:21:22,799
so

638
00:21:22,799 --> 00:21:24,480
um after black matter fired all the

639
00:21:24,480 --> 00:21:25,799
developers after all the decryption

640
00:21:25,799 --> 00:21:27,299
issues and then got the new guy who

641
00:21:27,299 --> 00:21:28,799
writes rust

642
00:21:28,799 --> 00:21:30,900
um lockbit seems to have acquired the

643
00:21:30,900 --> 00:21:32,460
code so

644
00:21:32,460 --> 00:21:34,380
this spun up a variant of lock bit

645
00:21:34,380 --> 00:21:36,780
called lock bit black

646
00:21:36,780 --> 00:21:37,799
um

647
00:21:37,799 --> 00:21:41,100
rumor has it though after

648
00:21:41,100 --> 00:21:43,640
um the developer it was higher the code

649
00:21:43,640 --> 00:21:46,860
was used uh was disgruntled for whatever

650
00:21:46,860 --> 00:21:49,500
reason and then he then leaked some

651
00:21:49,500 --> 00:21:51,720
locked mid black code so what this now

652
00:21:51,720 --> 00:21:53,280
means this is available to anybody who

653
00:21:53,280 --> 00:21:54,900
wants it and because it has a

654
00:21:54,900 --> 00:21:57,120
customizable configuration anybody can

655
00:21:57,120 --> 00:21:59,640
actually modify it so now we start

656
00:21:59,640 --> 00:22:01,500
seeing some ransomware group spin-offs

657
00:22:01,500 --> 00:22:03,299
such as bloody ransomware who can now

658
00:22:03,299 --> 00:22:04,500
use this

659
00:22:04,500 --> 00:22:06,960
um pretty easily

660
00:22:06,960 --> 00:22:08,940
kind of in a similar vein the most

661
00:22:08,940 --> 00:22:10,320
recent sort of lock bit variant that

662
00:22:10,320 --> 00:22:12,960
we've seen is called lock bit green

663
00:22:12,960 --> 00:22:14,580
um so Conti's leak Source Code by the

664
00:22:14,580 --> 00:22:16,980
Ukrainian researcher now looks like

665
00:22:16,980 --> 00:22:19,260
lockbit acquired it and then built their

666
00:22:19,260 --> 00:22:20,400
own variant

667
00:22:20,400 --> 00:22:22,799
um so the reason we think that this is

668
00:22:22,799 --> 00:22:25,620
now not Conti right is there's a new

669
00:22:25,620 --> 00:22:28,500
esxi variant for it and looking at some

670
00:22:28,500 --> 00:22:30,360
of the tour based URLs in lock but

671
00:22:30,360 --> 00:22:33,059
samples they belong to lockbit not Conti

672
00:22:33,059 --> 00:22:34,740
so now there's kind of three major

673
00:22:34,740 --> 00:22:38,539
variants green black and original

674
00:22:38,940 --> 00:22:41,460
so looking at lock bit black so I looked

675
00:22:41,460 --> 00:22:43,080
substantially a black matter ransomware

676
00:22:43,080 --> 00:22:45,000
so when lock I put black came out I was

677
00:22:45,000 --> 00:22:47,520
very curious so here are both of the

678
00:22:47,520 --> 00:22:50,580
entry functions so lock the black looked

679
00:22:50,580 --> 00:22:52,260
at least from the outset very much like

680
00:22:52,260 --> 00:22:54,240
black matter ransomware so you can kind

681
00:22:54,240 --> 00:22:56,940
of see pretty similar the only kind of

682
00:22:56,940 --> 00:22:58,679
really big Salient difference is the due

683
00:22:58,679 --> 00:23:00,840
to Crypt in lock bit at the top which

684
00:23:00,840 --> 00:23:03,320
I'll talk about

685
00:23:03,659 --> 00:23:06,059
but this wasn't all of it so if you're

686
00:23:06,059 --> 00:23:07,740
an aspiring fan actor totally fine to

687
00:23:07,740 --> 00:23:08,820
borrow other people's code and

688
00:23:08,820 --> 00:23:10,380
definitely find opportunities for

689
00:23:10,380 --> 00:23:12,539
improvement where you can so there are

690
00:23:12,539 --> 00:23:15,240
other similarities there too so kind of

691
00:23:15,240 --> 00:23:17,100
outside just that entry function the

692
00:23:17,100 --> 00:23:18,600
high level structure of the code was

693
00:23:18,600 --> 00:23:20,400
extremely similar

694
00:23:20,400 --> 00:23:22,200
um the API hashing technique that they

695
00:23:22,200 --> 00:23:24,360
use their string hashing for the command

696
00:23:24,360 --> 00:23:26,220
line options so you can see what that

697
00:23:26,220 --> 00:23:28,740
looks like the string hash is on the top

698
00:23:28,740 --> 00:23:32,159
so instead of saying comparing like an

699
00:23:32,159 --> 00:23:33,960
ASCII string to an ASCII string to

700
00:23:33,960 --> 00:23:35,940
whatever came in what they do is they

701
00:23:35,940 --> 00:23:38,220
hash the string that they're looking for

702
00:23:38,220 --> 00:23:41,580
and hash the input compare those so it

703
00:23:41,580 --> 00:23:42,600
just makes it a little more challenging

704
00:23:42,600 --> 00:23:43,919
to statically reverse engineer because

705
00:23:43,919 --> 00:23:45,000
then you have to figure out all your

706
00:23:45,000 --> 00:23:47,640
different options there

707
00:23:47,640 --> 00:23:49,380
um the configuration file decryption

708
00:23:49,380 --> 00:23:50,880
also

709
00:23:50,880 --> 00:23:51,600
um

710
00:23:51,600 --> 00:23:53,820
pretty much the same as some of the

711
00:23:53,820 --> 00:23:55,620
newer versions of black matter and then

712
00:23:55,620 --> 00:23:57,840
finally the anti-debugging techniques

713
00:23:57,840 --> 00:24:00,059
and the combination thereof they used so

714
00:24:00,059 --> 00:24:01,620
one kind of well-known example is the

715
00:24:01,620 --> 00:24:03,179
crash if a breakpoint is placed on

716
00:24:03,179 --> 00:24:04,320
thread

717
00:24:04,320 --> 00:24:07,260
so there are some differences as well so

718
00:24:07,260 --> 00:24:09,000
some of the locket black versions

719
00:24:09,000 --> 00:24:11,100
require password to decrypt so if you

720
00:24:11,100 --> 00:24:12,720
don't provide the right password can't

721
00:24:12,720 --> 00:24:15,179
Crypt won't run so other groups have

722
00:24:15,179 --> 00:24:17,400
done this in the past um a Gregor kind

723
00:24:17,400 --> 00:24:19,620
of a well-known one but some of these

724
00:24:19,620 --> 00:24:21,900
versions require that in addition they

725
00:24:21,900 --> 00:24:23,159
started accepting additional command

726
00:24:23,159 --> 00:24:24,780
line parameters so adding additional

727
00:24:24,780 --> 00:24:26,520
functionality that you as an affiliate

728
00:24:26,520 --> 00:24:28,620
can use to run their ransomware so a

729
00:24:28,620 --> 00:24:29,940
couple examples of the group policy

730
00:24:29,940 --> 00:24:31,980
modification and self-deletion so you

731
00:24:31,980 --> 00:24:33,480
can see on the bottom

732
00:24:33,480 --> 00:24:36,179
um the lock bit black kind of program

733
00:24:36,179 --> 00:24:38,400
command line argument parsing so you can

734
00:24:38,400 --> 00:24:39,539
see some of those additional options

735
00:24:39,539 --> 00:24:42,120
there structure very very similar to how

736
00:24:42,120 --> 00:24:44,220
black matter did it but now with these

737
00:24:44,220 --> 00:24:45,659
additional options you can see that

738
00:24:45,659 --> 00:24:48,240
string comparison or the hash comparison

739
00:24:48,240 --> 00:24:50,159
as well

740
00:24:50,159 --> 00:24:52,380
then finally um the configuration data

741
00:24:52,380 --> 00:24:54,900
Flags so in response to kind of this

742
00:24:54,900 --> 00:24:56,700
additional functionality there were some

743
00:24:56,700 --> 00:24:58,140
additional configuration data flags that

744
00:24:58,140 --> 00:25:02,000
were required so those also appeared

745
00:25:02,340 --> 00:25:05,100
so also consider keeping on improving so

746
00:25:05,100 --> 00:25:06,780
after I release the vlogbook black and I

747
00:25:06,780 --> 00:25:08,400
guess lock pick Green

748
00:25:08,400 --> 00:25:09,240
um they've been actually pretty

749
00:25:09,240 --> 00:25:10,380
consistent

750
00:25:10,380 --> 00:25:11,700
um so we don't see as much change over

751
00:25:11,700 --> 00:25:13,620
time kind of that original loggers other

752
00:25:13,620 --> 00:25:15,600
groups so maybe their ammo is going to

753
00:25:15,600 --> 00:25:17,820
be acquiring other kind of leaked code

754
00:25:17,820 --> 00:25:19,440
and building variants from that it's

755
00:25:19,440 --> 00:25:21,840
unclear right now

756
00:25:21,840 --> 00:25:23,580
um so as I alluded to some of the

757
00:25:23,580 --> 00:25:25,740
samples had the requirement of the

758
00:25:25,740 --> 00:25:27,840
decrypt function

759
00:25:27,840 --> 00:25:30,000
um some of the newer ones don't uh this

760
00:25:30,000 --> 00:25:31,799
seems like to be like a builder option

761
00:25:31,799 --> 00:25:33,419
so you can choose to include it or not

762
00:25:33,419 --> 00:25:35,039
include it so I'll probably continue to

763
00:25:35,039 --> 00:25:36,179
see both

764
00:25:36,179 --> 00:25:38,220
uh like I mentioned a Gregor used the

765
00:25:38,220 --> 00:25:39,659
passer-based decryption of their malware

766
00:25:39,659 --> 00:25:41,880
pretty successfully so it was hard

767
00:25:41,880 --> 00:25:43,260
enough to find kind of McGregor sample

768
00:25:43,260 --> 00:25:44,340
that you could reverse engineer because

769
00:25:44,340 --> 00:25:45,659
you also had the correct Pat have to

770
00:25:45,659 --> 00:25:46,860
have the correct password or you can't

771
00:25:46,860 --> 00:25:48,539
decrypt it so if you're trying to

772
00:25:48,539 --> 00:25:49,919
prevent people from first engineering

773
00:25:49,919 --> 00:25:52,080
your actual kind of ransomware it's kind

774
00:25:52,080 --> 00:25:53,520
of a useful feature

775
00:25:53,520 --> 00:25:56,580
and as a bonus I mentioned steel bit so

776
00:25:56,580 --> 00:25:58,620
a lot of ransomware groups obviously to

777
00:25:58,620 --> 00:26:00,539
extort their victims want to take victim

778
00:26:00,539 --> 00:26:02,520
files and exfiltrate them so they can

779
00:26:02,520 --> 00:26:04,559
use them in the extortion process so

780
00:26:04,559 --> 00:26:06,120
lockbit has something called steel bit

781
00:26:06,120 --> 00:26:07,919
so it just automates the data

782
00:26:07,919 --> 00:26:10,260
exfiltration process of the victim files

783
00:26:10,260 --> 00:26:11,760
and then it uploads them to a league

784
00:26:11,760 --> 00:26:15,440
site for the affiliate very handy

785
00:26:16,140 --> 00:26:18,059
so I also talked a little bit about

786
00:26:18,059 --> 00:26:20,700
something that was false flag so lockbit

787
00:26:20,700 --> 00:26:22,679
is one of the groups that does this so

788
00:26:22,679 --> 00:26:24,240
when recorded feature interviewed them

789
00:26:24,240 --> 00:26:26,400
lock bit of eyes they definitely live in

790
00:26:26,400 --> 00:26:27,900
China none of their Affiliates live in

791
00:26:27,900 --> 00:26:29,700
the United States or Russia so the

792
00:26:29,700 --> 00:26:30,960
concerns that we're raising to them

793
00:26:30,960 --> 00:26:33,059
about you know for people who live in

794
00:26:33,059 --> 00:26:35,580
Russia the US and stuff definitely did

795
00:26:35,580 --> 00:26:37,860
not apply to them

796
00:26:37,860 --> 00:26:40,140
um we also see some threat actors kind

797
00:26:40,140 --> 00:26:43,159
of try and do or kind of false flag is

798
00:26:43,159 --> 00:26:45,299
china-based or China Associated threat

799
00:26:45,299 --> 00:26:46,260
actors

800
00:26:46,260 --> 00:26:47,580
um you'll see them post some machine

801
00:26:47,580 --> 00:26:49,860
translated Chinese asking about

802
00:26:49,860 --> 00:26:51,720
ransomware so you can see on the bottom

803
00:26:51,720 --> 00:26:53,640
here an example of the post so I don't

804
00:26:53,640 --> 00:26:55,320
eat Chinese but I talked to one of my

805
00:26:55,320 --> 00:26:56,940
co-workers who does and he advises it's

806
00:26:56,940 --> 00:26:58,679
definitely not correct so this gives you

807
00:26:58,679 --> 00:26:59,880
some idea of kind of what you're looking

808
00:26:59,880 --> 00:27:03,299
at for when I'm talking about that

809
00:27:03,299 --> 00:27:06,179
so a forum ramp also welcomes Chinese

810
00:27:06,179 --> 00:27:08,159
speakers so they're trying to attack

811
00:27:08,159 --> 00:27:10,020
attract some Chinese threat actors or

812
00:27:10,020 --> 00:27:11,940
ransomware gangs not entirely sure why

813
00:27:11,940 --> 00:27:14,700
but that's kind of what uh it looks like

814
00:27:14,700 --> 00:27:17,900
on the bottom left

815
00:27:19,080 --> 00:27:20,400
so

816
00:27:20,400 --> 00:27:21,840
um sometimes this just doesn't work out

817
00:27:21,840 --> 00:27:24,360
they don't really super false flag very

818
00:27:24,360 --> 00:27:27,480
effectively in general so young luang

819
00:27:27,480 --> 00:27:29,880
was a ransomware group reporting to be

820
00:27:29,880 --> 00:27:31,679
trying to Associated but what happened

821
00:27:31,679 --> 00:27:33,419
is that some of the chats belonging to

822
00:27:33,419 --> 00:27:36,059
them their group were leaked so they

823
00:27:36,059 --> 00:27:37,919
were not in fact Chinese and all the

824
00:27:37,919 --> 00:27:39,720
chats were in Russian so they're Russian

825
00:27:39,720 --> 00:27:41,700
speakers so kind of one great way to

826
00:27:41,700 --> 00:27:43,919
reveal yourself

827
00:27:43,919 --> 00:27:46,020
but we can sometimes also see it in

828
00:27:46,020 --> 00:27:48,900
their code so for example I looked at

829
00:27:48,900 --> 00:27:50,880
something that purported to be shall

830
00:27:50,880 --> 00:27:54,539
ransomware great drops this note

831
00:27:54,539 --> 00:27:56,580
um doesn't explicitly call out being

832
00:27:56,580 --> 00:27:58,260
trying to try and Associated but that

833
00:27:58,260 --> 00:28:00,240
was some kind of some of the form and

834
00:28:00,240 --> 00:28:01,679
branding and stuff like that but you can

835
00:28:01,679 --> 00:28:04,080
kind of see the note there so looking at

836
00:28:04,080 --> 00:28:05,880
where I ran it

837
00:28:05,880 --> 00:28:07,140
um looking at the command line output

838
00:28:07,140 --> 00:28:10,620
you can see that it says revix 1.1 so

839
00:28:10,620 --> 00:28:12,840
back in the day when Revolt was still

840
00:28:12,840 --> 00:28:14,159
kind of very active in their sort of

841
00:28:14,159 --> 00:28:16,260
original form they had a Linux Locker

842
00:28:16,260 --> 00:28:18,059
called revex

843
00:28:18,059 --> 00:28:20,640
um so it had the exact same kind of

844
00:28:20,640 --> 00:28:22,799
printout I recognized that it was a

845
00:28:22,799 --> 00:28:25,320
little confused so obviously this is not

846
00:28:25,320 --> 00:28:26,820
Chow seems like they just kind of

847
00:28:26,820 --> 00:28:28,919
reskinned the original revix suggesting

848
00:28:28,919 --> 00:28:31,559
maybe they acquired the code or maybe

849
00:28:31,559 --> 00:28:34,639
related actors

850
00:28:34,860 --> 00:28:37,380
so talked a lot about all these changes

851
00:28:37,380 --> 00:28:41,159
and we as kind of Defenders want to hunt

852
00:28:41,159 --> 00:28:44,159
them so kind of the way that I would

853
00:28:44,159 --> 00:28:47,400
advise is face a strange right so

854
00:28:47,400 --> 00:28:49,320
looking at for what's weird or kind of

855
00:28:49,320 --> 00:28:50,820
what's unique or kind of interesting and

856
00:28:50,820 --> 00:28:53,520
fun about a lot of this stuff is kind of

857
00:28:53,520 --> 00:28:55,620
a great way to track them so

858
00:28:55,620 --> 00:28:57,059
as I mentioned some of the automated

859
00:28:57,059 --> 00:28:58,980
obfuscation techniques they'll often

860
00:28:58,980 --> 00:29:02,460
leave artifacts so like play and Alpha

861
00:29:02,460 --> 00:29:03,120
um

862
00:29:03,120 --> 00:29:05,100
maybe they were custom maybe they

863
00:29:05,100 --> 00:29:07,559
weren't but this automated way of doing

864
00:29:07,559 --> 00:29:08,880
it allows you to start creating

865
00:29:08,880 --> 00:29:10,320
signatures to look for other versions

866
00:29:10,320 --> 00:29:12,179
maybe other people are using that same

867
00:29:12,179 --> 00:29:13,440
technique

868
00:29:13,440 --> 00:29:14,580
um to start kind of looking for other

869
00:29:14,580 --> 00:29:16,500
variants there as well while it is

870
00:29:16,500 --> 00:29:18,059
better for their custom because that

871
00:29:18,059 --> 00:29:20,220
kind of is more group Associated still

872
00:29:20,220 --> 00:29:21,600
pretty entertaining to find other people

873
00:29:21,600 --> 00:29:23,340
using that same technique

874
00:29:23,340 --> 00:29:26,580
also looking for inconsistencies in some

875
00:29:26,580 --> 00:29:28,860
language or strings so especially their

876
00:29:28,860 --> 00:29:31,880
Ransom notes so agenda for example

877
00:29:31,880 --> 00:29:35,220
purported to have a Linux version

878
00:29:35,220 --> 00:29:36,659
um I haven't really seen it published on

879
00:29:36,659 --> 00:29:38,399
in the wild extensively so I want to

880
00:29:38,399 --> 00:29:40,260
find one so what we did was we looked in

881
00:29:40,260 --> 00:29:41,460
the ransom note there was kind of some

882
00:29:41,460 --> 00:29:43,080
weird verbiage and sort of misspellings

883
00:29:43,080 --> 00:29:44,580
being able to sort of pivot off that

884
00:29:44,580 --> 00:29:46,080
allowed us to find one which was really

885
00:29:46,080 --> 00:29:46,919
cool

886
00:29:46,919 --> 00:29:48,919
I'm also looking at some of the

887
00:29:48,919 --> 00:29:51,240
anti-debugging anti-analysis and anti-re

888
00:29:51,240 --> 00:29:53,460
techniques not necessarily just kind of

889
00:29:53,460 --> 00:29:54,299
in

890
00:29:54,299 --> 00:29:56,580
individual but sometimes the combination

891
00:29:56,580 --> 00:29:59,120
thereof so if they're using a enough

892
00:29:59,120 --> 00:30:01,260
combination of them and like kind of

893
00:30:01,260 --> 00:30:03,120
custom ones especially like the string

894
00:30:03,120 --> 00:30:05,340
off use cases generally seem to be

895
00:30:05,340 --> 00:30:06,779
pretty unique that's a good way to start

896
00:30:06,779 --> 00:30:09,120
finding other ones

897
00:30:09,120 --> 00:30:10,679
um the implementation of the crypto

898
00:30:10,679 --> 00:30:12,840
algorithms so one of the things that

899
00:30:12,840 --> 00:30:14,580
black matter and Darkseid did was they

900
00:30:14,580 --> 00:30:17,100
had kind of a strange combination of

901
00:30:17,100 --> 00:30:18,779
crypto algorithms that were only really

902
00:30:18,779 --> 00:30:20,220
seen before

903
00:30:20,220 --> 00:30:22,440
um so the one in black matter was only

904
00:30:22,440 --> 00:30:24,600
seen necessarily before dark side kind

905
00:30:24,600 --> 00:30:25,860
of a good way to start looking at some

906
00:30:25,860 --> 00:30:27,299
of that overlap there

907
00:30:27,299 --> 00:30:30,960
any other buggy anomalies so code that

908
00:30:30,960 --> 00:30:33,059
should work that doesn't

909
00:30:33,059 --> 00:30:34,799
um code that doesn't really do anything

910
00:30:34,799 --> 00:30:36,720
but looks like it should do something

911
00:30:36,720 --> 00:30:39,360
that they just I guess left in there and

912
00:30:39,360 --> 00:30:41,580
doesn't really have any effect so kind

913
00:30:41,580 --> 00:30:43,919
of some fun things to track there

914
00:30:43,919 --> 00:30:45,120
um and being able to stay up on the

915
00:30:45,120 --> 00:30:47,700
latest affiliate news so um you can see

916
00:30:47,700 --> 00:30:50,159
Alpha's announcement of morph right so

917
00:30:50,159 --> 00:30:51,299
you start to get an idea of like okay

918
00:30:51,299 --> 00:30:53,399
they've come out with this new thing let

919
00:30:53,399 --> 00:30:54,659
me start looking for it let me figure

920
00:30:54,659 --> 00:30:56,460
out how to get it and signature it so to

921
00:30:56,460 --> 00:30:57,659
kind of get an idea of kind of what's

922
00:30:57,659 --> 00:30:59,460
coming out now

923
00:30:59,460 --> 00:31:01,080
and if you want to start looking for

924
00:31:01,080 --> 00:31:02,700
some of the similarities

925
00:31:02,700 --> 00:31:04,140
um like I mentioned a lot of these

926
00:31:04,140 --> 00:31:05,880
Builders are leaked some are improved

927
00:31:05,880 --> 00:31:07,919
upon some are not so looking for code

928
00:31:07,919 --> 00:31:10,200
reads between families so if there's

929
00:31:10,200 --> 00:31:11,340
leak Builder and you're trying to look

930
00:31:11,340 --> 00:31:13,500
for other groups that may be using this

931
00:31:13,500 --> 00:31:15,179
Builder being able to signature for that

932
00:31:15,179 --> 00:31:17,460
and start mapping that out that way

933
00:31:17,460 --> 00:31:19,620
and also if you're trying to look for

934
00:31:19,620 --> 00:31:21,720
ransomware maybe some not super huge

935
00:31:21,720 --> 00:31:23,580
ones or kind of newer variants being

936
00:31:23,580 --> 00:31:24,720
able to look for some of that rants

937
00:31:24,720 --> 00:31:27,000
middle language it's all pretty common I

938
00:31:27,000 --> 00:31:28,919
would say so things like what happened

939
00:31:28,919 --> 00:31:30,899
your network and tour project are a

940
00:31:30,899 --> 00:31:32,700
couple examples there

941
00:31:32,700 --> 00:31:36,310
and with that thank you so much

942
00:31:36,310 --> 00:31:40,500
[Applause]

943
00:31:40,500 --> 00:31:43,399
any questions

944
00:31:44,700 --> 00:31:47,659
about the impact

945
00:31:49,460 --> 00:31:51,779
so there's a couple different ones that

946
00:31:51,779 --> 00:31:53,580
they use for initial access so obviously

947
00:31:53,580 --> 00:31:56,279
phishing is super popular so they will

948
00:31:56,279 --> 00:31:57,960
also look to do some sort of

949
00:31:57,960 --> 00:31:59,640
exploitation of like some of the

950
00:31:59,640 --> 00:32:02,100
internet facing services so with the

951
00:32:02,100 --> 00:32:03,960
whole move a couple years ago to

952
00:32:03,960 --> 00:32:05,159
everybody starting to work from home

953
00:32:05,159 --> 00:32:07,559
with a pandemic we saw a lot of people

954
00:32:07,559 --> 00:32:09,179
exploiting vulnerabilities for those

955
00:32:09,179 --> 00:32:11,159
kind of like uh perimeter type devices

956
00:32:11,159 --> 00:32:12,980
and any of the remote work tools as well

957
00:32:12,980 --> 00:32:15,779
but yeah phishing is really popular I'm

958
00:32:15,779 --> 00:32:18,779
going to say very effective

959
00:32:18,779 --> 00:32:21,500
anybody else

960
00:32:21,779 --> 00:32:24,539
okay well thank you so much

961
00:32:24,539 --> 00:32:27,539
foreign

