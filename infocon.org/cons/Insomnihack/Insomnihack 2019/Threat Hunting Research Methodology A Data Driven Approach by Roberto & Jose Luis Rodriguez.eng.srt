1
00:00:07,250 --> 00:00:10,619
[Music]

2
00:00:13,160 --> 00:00:17,010
so thank you very much

3
00:00:15,450 --> 00:00:18,540
you know we're really happy to be here I

4
00:00:17,010 --> 00:00:19,860
mean it's our first time here I'm in

5
00:00:18,540 --> 00:00:21,330
Geneva and also part of this conference

6
00:00:19,860 --> 00:00:23,099
so you thank you very much for the

7
00:00:21,330 --> 00:00:25,229
people that you made it possible for us

8
00:00:23,099 --> 00:00:26,250
also to come all the way here today

9
00:00:25,230 --> 00:00:28,140
we're going to be talking about three

10
00:00:26,250 --> 00:00:29,880
hunting research a data-driven approach

11
00:00:28,140 --> 00:00:31,230
and we're gonna share a little bit of a

12
00:00:29,880 --> 00:00:32,820
couple things that we've been doing and

13
00:00:31,230 --> 00:00:35,460
also releasing an open source project

14
00:00:32,820 --> 00:00:36,989
today as well and tell you how a lot of

15
00:00:35,460 --> 00:00:39,149
things that we do can be put together

16
00:00:36,989 --> 00:00:41,910
and can also be even replicated at home

17
00:00:39,149 --> 00:00:43,260
or in your own organization as well once

18
00:00:41,910 --> 00:00:45,089
again my name is Roberto Rodriguez you

19
00:00:43,260 --> 00:00:47,400
can follow me in Twitter that's my

20
00:00:45,090 --> 00:00:49,080
handle and I'm also have a couple of

21
00:00:47,400 --> 00:00:50,670
github projects that link is at the

22
00:00:49,080 --> 00:00:53,339
bottom so if you have any questions

23
00:00:50,670 --> 00:00:55,890
please I love to talk about all these

24
00:00:53,340 --> 00:00:57,090
projects so if you want to probably you

25
00:00:55,890 --> 00:00:59,930
know get interested in something please

26
00:00:57,090 --> 00:01:02,840
just let me know and I'm also a

27
00:00:59,930 --> 00:01:05,909
detection researcher for a company in

28
00:01:02,840 --> 00:01:08,880
the United States you know based in

29
00:01:05,909 --> 00:01:10,770
Seattle which is Specter ops and also

30
00:01:08,880 --> 00:01:14,189
I'm a former trade hunter for Capital

31
00:01:10,770 --> 00:01:18,749
One a financial industry I'm also in

32
00:01:14,189 --> 00:01:21,538
Virginia everyone my name is Lou Solis I

33
00:01:18,749 --> 00:01:23,908
go by cyber panda in Twitter I'm a

34
00:01:21,539 --> 00:01:27,359
cybersecurity student at North Virginia

35
00:01:23,909 --> 00:01:29,850
Community College in the US as Roberta

36
00:01:27,359 --> 00:01:33,509
told you we are releasing today our last

37
00:01:29,850 --> 00:01:35,699
project mortar and I also like to

38
00:01:33,509 --> 00:01:37,979
contribute to open source projects that

39
00:01:35,700 --> 00:01:39,869
we are working with Roberto and I'm a

40
00:01:37,979 --> 00:01:43,499
former senior business intelligence

41
00:01:39,869 --> 00:01:45,179
analyst from unison Peru yes so we're

42
00:01:43,499 --> 00:01:47,639
both from Peru actually you know but we

43
00:01:45,179 --> 00:01:49,340
reside in the United States so just this

44
00:01:47,639 --> 00:01:51,389
in case you guys probably my wondering

45
00:01:49,340 --> 00:01:52,889
alright so what are we here you know

46
00:01:51,389 --> 00:01:55,170
today we're gonna be talking about furs

47
00:01:52,889 --> 00:01:56,670
in to what we've seen and what I've seen

48
00:01:55,170 --> 00:01:58,950
also traveling around different

49
00:01:56,670 --> 00:02:00,719
companies you know trying to apply three

50
00:01:58,950 --> 00:02:02,520
hunting methodologies and frameworks and

51
00:02:00,719 --> 00:02:04,469
things like that all the way to started

52
00:02:02,520 --> 00:02:07,139
talking about a data-driven methodology

53
00:02:04,469 --> 00:02:08,669
and why we even care about data in this

54
00:02:07,139 --> 00:02:10,679
aspect and also we're going to be

55
00:02:08,669 --> 00:02:12,208
applying a couple demos and things like

56
00:02:10,679 --> 00:02:14,940
that and of course you know releasing

57
00:02:12,209 --> 00:02:17,130
one of our projects at the end so

58
00:02:14,940 --> 00:02:18,600
currently threat hunting before we even

59
00:02:17,130 --> 00:02:20,100
talked about that I think it's important

60
00:02:18,600 --> 00:02:20,799
to understand exactly the differences

61
00:02:20,100 --> 00:02:23,170
between B

62
00:02:20,800 --> 00:02:25,240
effective efficient there is a lot of

63
00:02:23,170 --> 00:02:27,519
people that use these concepts in

64
00:02:25,240 --> 00:02:29,170
different way which makes it really hard

65
00:02:27,520 --> 00:02:31,150
to understand how you're actually being

66
00:02:29,170 --> 00:02:32,679
effective and the reason why I want to

67
00:02:31,150 --> 00:02:35,080
do this is because these concepts will

68
00:02:32,680 --> 00:02:36,700
be applied across our you know

69
00:02:35,080 --> 00:02:37,900
methodology right because we want to

70
00:02:36,700 --> 00:02:40,359
make sure that whatever we do what our

71
00:02:37,900 --> 00:02:42,100
data is being done in a most efficient

72
00:02:40,360 --> 00:02:44,620
way so we can achieve also we're

73
00:02:42,100 --> 00:02:46,180
effectiveness efficiency here comes from

74
00:02:44,620 --> 00:02:49,450
how can you make the best sort of the

75
00:02:46,180 --> 00:02:52,210
resources that you have and you know in

76
00:02:49,450 --> 00:02:54,869
a let's call like an optimal way and

77
00:02:52,210 --> 00:02:57,400
efficacy is pretty much when you are

78
00:02:54,870 --> 00:03:00,010
setting yourself a goal and you achieve

79
00:02:57,400 --> 00:03:02,170
that goal no matter what right so the

80
00:03:00,010 --> 00:03:04,120
combination which of these two is

81
00:03:02,170 --> 00:03:06,579
supposed to be part of the effectiveness

82
00:03:04,120 --> 00:03:08,050
you know concept so this translate into

83
00:03:06,580 --> 00:03:10,270
several security kind of like getting

84
00:03:08,050 --> 00:03:12,130
into the topic being efficient is not

85
00:03:10,270 --> 00:03:13,810
just having that you know tools or

86
00:03:12,130 --> 00:03:15,460
having people it's actually having the

87
00:03:13,810 --> 00:03:17,710
right people the right data and the

88
00:03:15,460 --> 00:03:19,450
right tools and then that will help you

89
00:03:17,710 --> 00:03:21,580
of course to achieve your objective a

90
00:03:19,450 --> 00:03:23,260
lot of people just want to focus on try

91
00:03:21,580 --> 00:03:25,000
to you know find something in

92
00:03:23,260 --> 00:03:26,769
environment and they're happy with that

93
00:03:25,000 --> 00:03:28,480
without even caring or understanding

94
00:03:26,770 --> 00:03:31,750
exactly how they can be more efficient

95
00:03:28,480 --> 00:03:33,459
at doing that so when I go to several

96
00:03:31,750 --> 00:03:35,080
organizations there are different ways

97
00:03:33,459 --> 00:03:37,030
that you can do tread hunting and I can

98
00:03:35,080 --> 00:03:38,920
just summarize this in a few steps right

99
00:03:37,030 --> 00:03:41,620
all the way from generating hypotheses

100
00:03:38,920 --> 00:03:43,390
trying to define your specific goal what

101
00:03:41,620 --> 00:03:45,700
it is that you want to hunt for all the

102
00:03:43,390 --> 00:03:47,799
way to you know trying to document our

103
00:03:45,700 --> 00:03:50,200
results and also try to reach your

104
00:03:47,800 --> 00:03:52,180
security controls that you have so we go

105
00:03:50,200 --> 00:03:53,589
a little bit into these steps I see a

106
00:03:52,180 --> 00:03:56,110
lot of organizations using their own

107
00:03:53,590 --> 00:03:57,760
intelligence internal or external in

108
00:03:56,110 --> 00:04:00,310
order to understand what it is that you

109
00:03:57,760 --> 00:04:02,140
know they can hunt for I don't see too

110
00:04:00,310 --> 00:04:03,370
many people using the data that they

111
00:04:02,140 --> 00:04:05,260
have right you know they don't

112
00:04:03,370 --> 00:04:07,570
understand exactly what they have so

113
00:04:05,260 --> 00:04:09,459
they do not use it to define what it is

114
00:04:07,570 --> 00:04:12,579
that they can see in their environment I

115
00:04:09,459 --> 00:04:14,470
see only a few people - in them and then

116
00:04:12,580 --> 00:04:16,120
some organizations focus more on the

117
00:04:14,470 --> 00:04:18,970
critical infrastructure and need some

118
00:04:16,120 --> 00:04:20,410
mix of using intelligence with entity

119
00:04:18,970 --> 00:04:22,450
driven and that's what they do they're

120
00:04:20,410 --> 00:04:24,520
hunted engagements every quarter or you

121
00:04:22,450 --> 00:04:26,080
know - the whole year and of course I've

122
00:04:24,520 --> 00:04:28,299
seen a lot of companies using business

123
00:04:26,080 --> 00:04:30,550
goal driven and in this part right here

124
00:04:28,300 --> 00:04:32,320
it's very interesting because you have a

125
00:04:30,550 --> 00:04:33,980
lot of organizations just trying to

126
00:04:32,320 --> 00:04:35,750
follow regulations right I don't

127
00:04:33,980 --> 00:04:37,760
if this is not a critical infrastructure

128
00:04:35,750 --> 00:04:39,680
I just need to check a box and this

129
00:04:37,760 --> 00:04:41,570
happens of course across several

130
00:04:39,680 --> 00:04:43,880
industries and of course applies also to

131
00:04:41,570 --> 00:04:46,700
you know to tree hunting and it's not

132
00:04:43,880 --> 00:04:48,140
the right way to do it some of the

133
00:04:46,700 --> 00:04:49,460
problems that I see a lot and this is

134
00:04:48,140 --> 00:04:51,380
why we decided to build this

135
00:04:49,460 --> 00:04:54,169
presentation was to define what it is

136
00:04:51,380 --> 00:04:56,900
that I need for my hunting engagement

137
00:04:54,170 --> 00:04:59,360
and the question keeps getting you know

138
00:04:56,900 --> 00:05:00,890
repeated over and over every time I go

139
00:04:59,360 --> 00:05:02,480
to a company they always have the same

140
00:05:00,890 --> 00:05:04,039
question and it's because they don't

141
00:05:02,480 --> 00:05:05,810
understand first how they're gonna be

142
00:05:04,040 --> 00:05:07,910
using their current infrastructure and

143
00:05:05,810 --> 00:05:10,640
their current data to start hunting for

144
00:05:07,910 --> 00:05:12,500
any type of activity and of course some

145
00:05:10,640 --> 00:05:13,460
organizations like to be more organized

146
00:05:12,500 --> 00:05:15,230
right

147
00:05:13,460 --> 00:05:17,510
they have roles and responsibilities and

148
00:05:15,230 --> 00:05:19,490
others have just ad hoc queries where

149
00:05:17,510 --> 00:05:20,780
they just you know give the analyst a

150
00:05:19,490 --> 00:05:22,730
search bar and they just start running

151
00:05:20,780 --> 00:05:24,349
queries whenever they have time and this

152
00:05:22,730 --> 00:05:26,630
of course the fits the purpose of the

153
00:05:24,350 --> 00:05:28,550
whole you know problem you know

154
00:05:26,630 --> 00:05:30,409
framework and of course they documented

155
00:05:28,550 --> 00:05:32,780
and they of course try to you know

156
00:05:30,410 --> 00:05:34,760
enrich the security controls a once

157
00:05:32,780 --> 00:05:36,739
again the realities because I'm guessing

158
00:05:34,760 --> 00:05:38,900
here that even though everybody wants to

159
00:05:36,740 --> 00:05:41,000
get this nice straight hunting framework

160
00:05:38,900 --> 00:05:44,030
at the end of the day you just give the

161
00:05:41,000 --> 00:05:45,800
analyst a platform with a search bar

162
00:05:44,030 --> 00:05:47,510
where you can just run anything that you

163
00:05:45,800 --> 00:05:50,050
want to and most of the time is defined

164
00:05:47,510 --> 00:05:52,640
by the expertise right level of

165
00:05:50,050 --> 00:05:55,130
expertise and also what you might see

166
00:05:52,640 --> 00:05:57,320
out there in the internet right and your

167
00:05:55,130 --> 00:05:58,820
queries might not be as efficient so

168
00:05:57,320 --> 00:06:02,240
there needs to be a methodology to

169
00:05:58,820 --> 00:06:04,310
understand how you can be how you could

170
00:06:02,240 --> 00:06:06,740
be like efficient and also the em being

171
00:06:04,310 --> 00:06:08,300
effective hunting engagements and of

172
00:06:06,740 --> 00:06:09,530
course I hope that this presentation at

173
00:06:08,300 --> 00:06:11,240
the end will allow you to understand

174
00:06:09,530 --> 00:06:13,250
that when you do a hunting engagement

175
00:06:11,240 --> 00:06:15,560
everybody just wants to spend their

176
00:06:13,250 --> 00:06:17,870
whole time running queries trying to

177
00:06:15,560 --> 00:06:19,310
find for any potential adversaries but

178
00:06:17,870 --> 00:06:21,290
reality at the end is that there is a

179
00:06:19,310 --> 00:06:24,710
lot of pre hunt activities that need to

180
00:06:21,290 --> 00:06:27,290
happen before you even try to deploy a

181
00:06:24,710 --> 00:06:29,049
hunt in or start a hunting engagement in

182
00:06:27,290 --> 00:06:31,790
your environment and it's gonna be more

183
00:06:29,050 --> 00:06:35,090
um it's gonna make some more sense once

184
00:06:31,790 --> 00:06:36,710
we go through the whole methodology so

185
00:06:35,090 --> 00:06:38,510
it data-driven approach and why do we

186
00:06:36,710 --> 00:06:41,060
even care about this right so let's just

187
00:06:38,510 --> 00:06:42,469
go back to the basics an adversary is

188
00:06:41,060 --> 00:06:44,990
building their own tactics techniques

189
00:06:42,470 --> 00:06:47,060
and procedures and they're trying to you

190
00:06:44,990 --> 00:06:47,810
know bypass detections every time they

191
00:06:47,060 --> 00:06:49,970
do

192
00:06:47,810 --> 00:06:52,280
a simple action on the endpoint is going

193
00:06:49,970 --> 00:06:54,320
to generate data that data gets it's

194
00:06:52,280 --> 00:06:56,059
gonna you know be fed to a central

195
00:06:54,320 --> 00:06:58,340
repository then you can start analyzing

196
00:06:56,060 --> 00:07:00,290
the data security analyst starts

197
00:06:58,340 --> 00:07:01,940
learning about those TTP's and then

198
00:07:00,290 --> 00:07:03,410
you're gonna start running queries and

199
00:07:01,940 --> 00:07:05,469
inside that this is just the basic

200
00:07:03,410 --> 00:07:08,180
concept the problem is that

201
00:07:05,470 --> 00:07:09,590
organizations are really not

202
00:07:08,180 --> 00:07:13,660
understanding if you're getting the best

203
00:07:09,590 --> 00:07:16,489
out of these data pages collect the data

204
00:07:13,660 --> 00:07:18,290
they put in a central payout place and

205
00:07:16,490 --> 00:07:21,290
they don't even understand exactly what

206
00:07:18,290 --> 00:07:24,169
it is that they can do with that they

207
00:07:21,290 --> 00:07:26,210
are more interested on creating rules

208
00:07:24,169 --> 00:07:28,130
signature kinda like brute force in

209
00:07:26,210 --> 00:07:30,289
detection trying to find a specific

210
00:07:28,130 --> 00:07:32,659
strings and specific things that they

211
00:07:30,290 --> 00:07:36,200
see online like people talk about it in

212
00:07:32,660 --> 00:07:38,930
conferences things like that but they

213
00:07:36,200 --> 00:07:41,360
probably are not using other ways to

214
00:07:38,930 --> 00:07:42,889
analyze the data right which could go

215
00:07:41,360 --> 00:07:45,200
all the way to the statistical model

216
00:07:42,889 --> 00:07:47,240
trying to find more information and more

217
00:07:45,200 --> 00:07:48,440
insights from the data and this is what

218
00:07:47,240 --> 00:07:51,680
this presentation is going to be about

219
00:07:48,440 --> 00:07:55,820
as well so the end we won't understand

220
00:07:51,680 --> 00:07:58,039
the potential of our data as a whole so

221
00:07:55,820 --> 00:07:59,510
this is gonna be our you know basic

222
00:07:58,039 --> 00:08:01,550
steps to start going through the whole

223
00:07:59,510 --> 00:08:03,349
methodology and for you guys this might

224
00:08:01,550 --> 00:08:05,090
be a little high level and some of you

225
00:08:03,350 --> 00:08:07,550
might see these as basic but we're going

226
00:08:05,090 --> 00:08:09,469
to go actually deeper into each stage

227
00:08:07,550 --> 00:08:11,750
and we'll allow us to see what it is

228
00:08:09,470 --> 00:08:14,270
that you can do you know to improve your

229
00:08:11,750 --> 00:08:16,639
detection so the first thing is going to

230
00:08:14,270 --> 00:08:18,409
be defining a research goal and as I

231
00:08:16,639 --> 00:08:20,900
explained before you can do it in soil

232
00:08:18,410 --> 00:08:22,610
of different ways defined by Intel or

233
00:08:20,900 --> 00:08:25,370
defined by data but when you want to

234
00:08:22,610 --> 00:08:27,680
focus on data you have to at least ask

235
00:08:25,370 --> 00:08:30,380
yourself a question do I understand my

236
00:08:27,680 --> 00:08:33,260
data do I have a document this song

237
00:08:30,380 --> 00:08:35,450
where you need to have that somewhere in

238
00:08:33,260 --> 00:08:37,819
your environment otherwise you will not

239
00:08:35,450 --> 00:08:39,349
be able to start asking questions about

240
00:08:37,820 --> 00:08:41,270
your data and what it is you can hunt

241
00:08:39,349 --> 00:08:43,880
and of course and here's where you have

242
00:08:41,270 --> 00:08:47,089
to start mapping certain data logs or

243
00:08:43,880 --> 00:08:48,529
events to adversary activity this might

244
00:08:47,089 --> 00:08:49,700
not make sense for you right now but

245
00:08:48,529 --> 00:08:51,529
it's gonna make sense in a little bit

246
00:08:49,700 --> 00:08:54,820
once we go through the stages but idea

247
00:08:51,529 --> 00:08:57,650
of building your hypothesis is to start

248
00:08:54,820 --> 00:08:59,720
grabbing the knowledge about adversary

249
00:08:57,650 --> 00:09:01,459
technique and start putting that

250
00:08:59,720 --> 00:09:03,020
together in a data

251
00:09:01,460 --> 00:09:04,970
and of course you got a document

252
00:09:03,020 --> 00:09:07,100
hypothesis and respect it through the

253
00:09:04,970 --> 00:09:08,690
whole methodology and this is going to

254
00:09:07,100 --> 00:09:11,450
apply to our effectiveness efficiency

255
00:09:08,690 --> 00:09:14,170
and efficacy concepts because now with

256
00:09:11,450 --> 00:09:16,730
our hypothesis we are defining how the

257
00:09:14,170 --> 00:09:18,020
efficacy the specific goal you know what

258
00:09:16,730 --> 00:09:19,820
it is that we want to hunt for and

259
00:09:18,020 --> 00:09:21,860
respect that at the end and of course

260
00:09:19,820 --> 00:09:23,570
from an efficiency perspective now we

261
00:09:21,860 --> 00:09:25,700
have to start defining what resources

262
00:09:23,570 --> 00:09:30,110
and relevant data we're going to be

263
00:09:25,700 --> 00:09:32,270
using for this detection the questions

264
00:09:30,110 --> 00:09:34,490
that I have a lot are how specific do I

265
00:09:32,270 --> 00:09:37,490
have to be in order to build my

266
00:09:34,490 --> 00:09:42,050
hypothesis my goal right do I go very

267
00:09:37,490 --> 00:09:43,880
specific or very while I think that that

268
00:09:42,050 --> 00:09:45,529
question can be also answered with the

269
00:09:43,880 --> 00:09:47,779
next question which is how many

270
00:09:45,529 --> 00:09:50,899
techniques from an adversary do I have

271
00:09:47,779 --> 00:09:53,060
to cover in my hunting engagement in

272
00:09:50,899 --> 00:09:55,160
this case for example you can be very

273
00:09:53,060 --> 00:09:57,260
specific let's look for adversaries that

274
00:09:55,160 --> 00:09:58,850
are enumerated for example the Active

275
00:09:57,260 --> 00:10:00,410
Directory group domain admins and

276
00:09:58,850 --> 00:10:02,540
they're using for example security

277
00:10:00,410 --> 00:10:05,329
account manager near remote protocol

278
00:10:02,540 --> 00:10:07,130
that's very specific right there are

279
00:10:05,330 --> 00:10:09,110
different ways you can enumerate an ad

280
00:10:07,130 --> 00:10:11,270
group right these Active Directory group

281
00:10:09,110 --> 00:10:13,339
members you can do it through Sam in

282
00:10:11,270 --> 00:10:14,930
this case the cuticle manager or you can

283
00:10:13,339 --> 00:10:17,930
do it probably through other services

284
00:10:14,930 --> 00:10:19,880
you can use for example LDAP to query

285
00:10:17,930 --> 00:10:21,050
directly the Active Directory object and

286
00:10:19,880 --> 00:10:23,180
get that information

287
00:10:21,050 --> 00:10:24,620
so that's how you start defining how

288
00:10:23,180 --> 00:10:26,630
many techniques you can start applying

289
00:10:24,620 --> 00:10:29,630
to your hypothesis and please remember

290
00:10:26,630 --> 00:10:31,459
that when you execute something in your

291
00:10:29,630 --> 00:10:33,200
environment like an adversary executes

292
00:10:31,459 --> 00:10:35,989
something in the environment they need

293
00:10:33,200 --> 00:10:39,650
some type of techniques that allows them

294
00:10:35,990 --> 00:10:41,720
to enable that execution the execution

295
00:10:39,650 --> 00:10:43,939
what does that mean if I'm trying to win

296
00:10:41,720 --> 00:10:46,850
you know to enumerate the members of an

297
00:10:43,940 --> 00:10:48,770
Active Directory group something needs

298
00:10:46,850 --> 00:10:52,010
to happen on the endpoint to allow the

299
00:10:48,770 --> 00:10:53,990
attacker to make that enumeration this

300
00:10:52,010 --> 00:10:55,339
could be done through PowerShell to be

301
00:10:53,990 --> 00:10:57,230
done through that net right through

302
00:10:55,339 --> 00:10:59,600
Python you can do it through any other

303
00:10:57,230 --> 00:11:01,430
different ways but the main goal is the

304
00:10:59,600 --> 00:11:03,020
same so you have to consider that when

305
00:11:01,430 --> 00:11:05,779
you start thinking about your hypothesis

306
00:11:03,020 --> 00:11:09,709
am i focusing on the enabler or I'm

307
00:11:05,779 --> 00:11:12,050
focusing more on the main behavior and

308
00:11:09,709 --> 00:11:14,029
of course at the end the outputs of this

309
00:11:12,050 --> 00:11:15,089
first step this which is more

310
00:11:14,029 --> 00:11:16,860
documentation and

311
00:11:15,089 --> 00:11:18,899
research and learning about the attack

312
00:11:16,860 --> 00:11:21,180
it's gonna be a full documented

313
00:11:18,899 --> 00:11:23,790
hypothesis it's gonna be knowledge about

314
00:11:21,180 --> 00:11:25,559
the adversary and you're gonna see why

315
00:11:23,790 --> 00:11:27,300
this is important at the in the next

316
00:11:25,559 --> 00:11:28,800
couple steps and of course you gotta

317
00:11:27,300 --> 00:11:31,680
provide some relevant data

318
00:11:28,800 --> 00:11:35,339
if you hypothesis is about an adversary

319
00:11:31,680 --> 00:11:37,019
creating a service remotely right away

320
00:11:35,339 --> 00:11:38,970
without even looking at the data you

321
00:11:37,019 --> 00:11:41,639
know that there is going to be some

322
00:11:38,970 --> 00:11:44,100
service creation added in that you will

323
00:11:41,639 --> 00:11:45,629
need to take a look at right so that's

324
00:11:44,100 --> 00:11:47,189
when I say relevant data

325
00:11:45,629 --> 00:11:49,470
the initial relevant data of your

326
00:11:47,189 --> 00:11:51,599
research could be defined but the data

327
00:11:49,470 --> 00:11:53,699
that you have but if you don't know what

328
00:11:51,600 --> 00:11:55,829
you have there's gonna be a problem

329
00:11:53,699 --> 00:11:57,089
right so you know in this step you have

330
00:11:55,829 --> 00:11:58,979
to start at least understanding that

331
00:11:57,089 --> 00:12:01,110
there is some type of data that will be

332
00:11:58,980 --> 00:12:03,839
mapped to certain behaviors in your

333
00:12:01,110 --> 00:12:05,399
research goal so you think about this

334
00:12:03,839 --> 00:12:07,439
hypothesis right here that'll move from

335
00:12:05,399 --> 00:12:09,059
BIA double your mind and I'm gonna start

336
00:12:07,439 --> 00:12:10,740
sharing some of the knowledge things

337
00:12:09,059 --> 00:12:12,469
that I'm learning about this specific

338
00:12:10,740 --> 00:12:14,670
technique and and tactic and technique

339
00:12:12,470 --> 00:12:16,110
in this case I want to be very specific

340
00:12:14,670 --> 00:12:19,439
I want to start looking for lateral

341
00:12:16,110 --> 00:12:22,920
movement BIA WMI that is going to create

342
00:12:19,439 --> 00:12:24,990
a new process on the destination which

343
00:12:22,920 --> 00:12:26,639
would allow me to create you know to get

344
00:12:24,990 --> 00:12:29,220
a new connection back to my command and

345
00:12:26,639 --> 00:12:31,529
control this could be done through of

346
00:12:29,220 --> 00:12:33,569
course the W my class win32 underscore

347
00:12:31,529 --> 00:12:35,220
process and you can use the method

348
00:12:33,569 --> 00:12:37,679
create which is the matter that allows

349
00:12:35,220 --> 00:12:40,439
you to execute things locally and also

350
00:12:37,679 --> 00:12:42,629
remotely when this happens on the

351
00:12:40,439 --> 00:12:46,290
destination on the end point where I'm

352
00:12:42,629 --> 00:12:48,110
executing my my code to then generate a

353
00:12:46,290 --> 00:12:51,748
new connection to my commanding control

354
00:12:48,110 --> 00:12:53,639
that execution is going to be hosted by

355
00:12:51,749 --> 00:12:57,749
the WMI prpsc

356
00:12:53,639 --> 00:12:59,939
process so without even run in any code

357
00:12:57,749 --> 00:13:01,860
or collecting any data

358
00:12:59,939 --> 00:13:04,349
I'm already understanding a little bit

359
00:13:01,860 --> 00:13:06,209
what it is that I need I'm gonna be

360
00:13:04,350 --> 00:13:08,370
looking for some network activity for

361
00:13:06,209 --> 00:13:09,929
example some authentication going on I'm

362
00:13:08,370 --> 00:13:12,449
looking for a process creating another

363
00:13:09,929 --> 00:13:13,709
process and that same process is making

364
00:13:12,449 --> 00:13:16,829
a network connection like I'm just

365
00:13:13,709 --> 00:13:20,160
learning about this adversary activity

366
00:13:16,829 --> 00:13:22,258
and trying to map it to data the next

367
00:13:20,160 --> 00:13:24,059
step is going to be now start modeling

368
00:13:22,259 --> 00:13:25,559
this data let's just our understanding

369
00:13:24,059 --> 00:13:28,860
how we can find relationships and then

370
00:13:25,559 --> 00:13:32,390
start mapping my data to an adversary in

371
00:13:28,860 --> 00:13:35,730
more direct way and more easy to follow

372
00:13:32,390 --> 00:13:38,699
so in this case is where we start now

373
00:13:35,730 --> 00:13:40,650
getting more deeper into what it is you

374
00:13:38,700 --> 00:13:43,080
know that you can use from what you're

375
00:13:40,650 --> 00:13:46,260
collecting your environment in order to

376
00:13:43,080 --> 00:13:48,780
spot the adversary behavior if you have

377
00:13:46,260 --> 00:13:50,640
not done any type of documentation in

378
00:13:48,780 --> 00:13:53,310
your environment about data sources that

379
00:13:50,640 --> 00:13:54,569
you collect here's the step where you

380
00:13:53,310 --> 00:13:56,130
will have to do it no matter what

381
00:13:54,570 --> 00:13:58,110
because if you don't do it you'll just

382
00:13:56,130 --> 00:13:59,880
keep pushing yourself more and more

383
00:13:58,110 --> 00:14:01,350
towards the next steps where you're

384
00:13:59,880 --> 00:14:04,410
gonna need some knowledge about your

385
00:14:01,350 --> 00:14:05,820
data so let's just start first with data

386
00:14:04,410 --> 00:14:08,880
sources right what does that mean when I

387
00:14:05,820 --> 00:14:10,500
talk about data sources in here from a

388
00:14:08,880 --> 00:14:12,750
basic concept data sources are coming

389
00:14:10,500 --> 00:14:15,120
from Freud say like this EBT X file

390
00:14:12,750 --> 00:14:16,470
which contains events that are generated

391
00:14:15,120 --> 00:14:17,550
on the environment this is what

392
00:14:16,470 --> 00:14:19,500
everybody knows right everybody

393
00:14:17,550 --> 00:14:21,569
understands this Constance is just basic

394
00:14:19,500 --> 00:14:23,130
this EBT x-files when you can pull them

395
00:14:21,570 --> 00:14:24,900
out at the endpoint you can do some

396
00:14:23,130 --> 00:14:26,580
forensics you can learn about what

397
00:14:24,900 --> 00:14:28,560
happened in environment but this is

398
00:14:26,580 --> 00:14:31,080
generated by what is called the you know

399
00:14:28,560 --> 00:14:34,079
the event tracing for Windows egw

400
00:14:31,080 --> 00:14:36,330
providers this data gets generated in

401
00:14:34,080 --> 00:14:39,690
this case this security event log is

402
00:14:36,330 --> 00:14:42,660
generated by this etw provider and this

403
00:14:39,690 --> 00:14:45,320
is done also the way how you send data

404
00:14:42,660 --> 00:14:47,819
from an e-2 though your provider to a

405
00:14:45,320 --> 00:14:51,990
specific log file like a you know

406
00:14:47,820 --> 00:14:54,240
security event log is done via the event

407
00:14:51,990 --> 00:14:57,750
tracing sessions and this is the basics

408
00:14:54,240 --> 00:14:59,430
of etw infrastructure why I'm talking

409
00:14:57,750 --> 00:15:00,900
about ITW because it's very important to

410
00:14:59,430 --> 00:15:04,020
understand where the data that is

411
00:15:00,900 --> 00:15:05,430
available from because you will be able

412
00:15:04,020 --> 00:15:07,920
to also understand that there are

413
00:15:05,430 --> 00:15:11,010
certain etw providers that would allow

414
00:15:07,920 --> 00:15:13,319
you to get some unknown data and not

415
00:15:11,010 --> 00:15:15,420
practical available for you to consume

416
00:15:13,320 --> 00:15:18,060
why is this so important it's because

417
00:15:15,420 --> 00:15:20,849
nowadays adversaries are moving from

418
00:15:18,060 --> 00:15:23,160
using things like PowerShell for example

419
00:15:20,850 --> 00:15:26,010
because there is already full auditing

420
00:15:23,160 --> 00:15:28,079
on PowerShell activity so now they're

421
00:15:26,010 --> 00:15:30,450
starting to use for example dotnet I'm

422
00:15:28,080 --> 00:15:32,370
in order to bypass those detections now

423
00:15:30,450 --> 00:15:34,380
there is certain interview providers

424
00:15:32,370 --> 00:15:37,500
that will provide that information about

425
00:15:34,380 --> 00:15:39,750
that net activity so just basic concepts

426
00:15:37,500 --> 00:15:42,210
but this is not easy to consume you can

427
00:15:39,750 --> 00:15:42,790
now just you know get a file from DC to

428
00:15:42,210 --> 00:15:46,470
w-4

429
00:15:42,790 --> 00:15:49,900
and consuming some people call this

430
00:15:46,470 --> 00:15:53,470
concept of using unknown data sources or

431
00:15:49,900 --> 00:15:57,069
not practicable etw providers a very

432
00:15:53,470 --> 00:15:59,440
advanced immature way to collect data to

433
00:15:57,070 --> 00:16:01,780
me it depends on the goal what is the

434
00:15:59,440 --> 00:16:03,970
goal is the goal in our detection

435
00:16:01,780 --> 00:16:06,670
methodology to look for that net

436
00:16:03,970 --> 00:16:09,270
activity or the main goal is to start

437
00:16:06,670 --> 00:16:12,729
focusing on the behavior of the attacker

438
00:16:09,270 --> 00:16:15,310
right the behavior of my basic

439
00:16:12,730 --> 00:16:17,800
hypothesis was to look for Doby am i you

440
00:16:15,310 --> 00:16:21,160
know using lot using w mindful lateral

441
00:16:17,800 --> 00:16:23,770
movement do I care a hundred percent or

442
00:16:21,160 --> 00:16:26,530
make the primary goal to detect that net

443
00:16:23,770 --> 00:16:28,240
or lateral movement over W mind so you

444
00:16:26,530 --> 00:16:30,280
gotta ask those questions and that's

445
00:16:28,240 --> 00:16:31,870
what you define exactly how advanced or

446
00:16:30,280 --> 00:16:34,660
mature you want to be when collecting

447
00:16:31,870 --> 00:16:36,610
your data and of course you need to know

448
00:16:34,660 --> 00:16:39,100
what you have in order to know your gaps

449
00:16:36,610 --> 00:16:41,350
otherwise you cannot say I need to use

450
00:16:39,100 --> 00:16:44,200
unknown data sources or not available

451
00:16:41,350 --> 00:16:45,550
each of your providers if you don't know

452
00:16:44,200 --> 00:16:47,800
that you might be getting similar data

453
00:16:45,550 --> 00:16:48,689
already from available known data

454
00:16:47,800 --> 00:16:50,530
sources

455
00:16:48,690 --> 00:16:52,540
in this case I'm going to show you a

456
00:16:50,530 --> 00:16:55,750
quick demo into what that actually means

457
00:16:52,540 --> 00:16:57,699
how can we collect etw data from etw

458
00:16:55,750 --> 00:17:00,100
providers that are not practical

459
00:16:57,700 --> 00:17:05,230
available directly for you to consume at

460
00:17:00,100 --> 00:17:08,380
scale an example I'm gonna be using is

461
00:17:05,230 --> 00:17:10,180
this is sync and this is saying

462
00:17:08,380 --> 00:17:13,959
basically what what happens in here is

463
00:17:10,180 --> 00:17:15,910
that the adversary well first like in

464
00:17:13,959 --> 00:17:18,459
general the basic concept of you know

465
00:17:15,910 --> 00:17:20,320
replication happens across domain

466
00:17:18,459 --> 00:17:22,480
controllers you have a domain controller

467
00:17:20,319 --> 00:17:23,679
that could be here in Geneva you have a

468
00:17:22,480 --> 00:17:25,900
domain controller that could be in the

469
00:17:23,680 --> 00:17:29,320
United States they both need to have the

470
00:17:25,900 --> 00:17:31,480
same data so if something happens on the

471
00:17:29,320 --> 00:17:33,820
Geneva domain controller we add a user

472
00:17:31,480 --> 00:17:36,220
we create new configurations that needs

473
00:17:33,820 --> 00:17:38,230
to be replicated somewhere right to the

474
00:17:36,220 --> 00:17:39,430
other domain controller so that type of

475
00:17:38,230 --> 00:17:42,280
activity is normal

476
00:17:39,430 --> 00:17:44,470
nothing is broken in here so but an

477
00:17:42,280 --> 00:17:48,520
adversary can abuse the Active Directory

478
00:17:44,470 --> 00:17:51,130
replication API is in order to request

479
00:17:48,520 --> 00:17:52,660
for those changes you can say hey I'm a

480
00:17:51,130 --> 00:17:54,640
domain controller and I would like to

481
00:17:52,660 --> 00:17:56,380
get the password of this user please

482
00:17:54,640 --> 00:17:58,990
send it to me because I want that

483
00:17:56,380 --> 00:18:00,640
vacation to happen towards me so

484
00:17:58,990 --> 00:18:01,990
adversary can be using that in the

485
00:18:00,640 --> 00:18:03,220
permissions that you see over there are

486
00:18:01,990 --> 00:18:08,560
the permissions that are going to be

487
00:18:03,220 --> 00:18:11,560
used in order to execute this attack so

488
00:18:08,560 --> 00:18:13,030
let's do this quick demo in this case

489
00:18:11,560 --> 00:18:14,710
we're gonna be using this is saying the

490
00:18:13,030 --> 00:18:17,820
compromised user is Petrov we're gonna

491
00:18:14,710 --> 00:18:21,310
try to get information about the krbtgt

492
00:18:17,820 --> 00:18:24,100
account and we're going to use the

493
00:18:21,310 --> 00:18:26,500
invoke mimikatz script in order to

494
00:18:24,100 --> 00:18:27,699
perform the deceasing attack we're going

495
00:18:26,500 --> 00:18:29,830
to perform the attack but at the same

496
00:18:27,700 --> 00:18:32,890
time we're going to start using an e GW

497
00:18:29,830 --> 00:18:34,600
provider which is the RPC provider I'm

498
00:18:32,890 --> 00:18:37,840
gonna explain to you why I use this one

499
00:18:34,600 --> 00:18:39,580
but in this case we have our computer

500
00:18:37,840 --> 00:18:41,320
that was already compromised this is

501
00:18:39,580 --> 00:18:42,669
gonna be able to main controller so we

502
00:18:41,320 --> 00:18:44,860
just kind of make sure we check the name

503
00:18:42,670 --> 00:18:46,240
in there and let's just explore it it'll

504
00:18:44,860 --> 00:18:48,219
be a little bit right because when you

505
00:18:46,240 --> 00:18:50,830
say how do i explore my own own data

506
00:18:48,220 --> 00:18:52,930
sources let's do some etw stuff

507
00:18:50,830 --> 00:18:54,879
basically let's start with numerating

508
00:18:52,930 --> 00:18:58,210
the tracing sessions that are available

509
00:18:54,880 --> 00:19:01,360
new computer remember a tracing session

510
00:18:58,210 --> 00:19:04,510
is what makes events go from an etw

511
00:19:01,360 --> 00:19:08,740
provider all the way to a log file so

512
00:19:04,510 --> 00:19:10,510
you can start at least query in this you

513
00:19:08,740 --> 00:19:13,600
know tracings and you can understand

514
00:19:10,510 --> 00:19:15,220
exactly what's being pushed to a lot of

515
00:19:13,600 --> 00:19:17,620
files and things like that but let's

516
00:19:15,220 --> 00:19:19,180
pull all the you know e 2w providers

517
00:19:17,620 --> 00:19:21,310
available in the computer let's save

518
00:19:19,180 --> 00:19:24,550
that to a variable and after that we're

519
00:19:21,310 --> 00:19:27,550
gonna start looking for etw providers

520
00:19:24,550 --> 00:19:30,520
that do have the word RPC the reason why

521
00:19:27,550 --> 00:19:34,240
I look for this is because if I did the

522
00:19:30,520 --> 00:19:36,670
research about this Inc Active Directory

523
00:19:34,240 --> 00:19:37,990
replication services when a domain

524
00:19:36,670 --> 00:19:39,790
controller communicates with our domain

525
00:19:37,990 --> 00:19:43,150
controller are pretty much using RPC

526
00:19:39,790 --> 00:19:45,580
interfaces so I would love to know if

527
00:19:43,150 --> 00:19:48,880
there is any RPC activity that I could

528
00:19:45,580 --> 00:19:51,159
actually track with an RPC etw provider

529
00:19:48,880 --> 00:19:52,720
right that's my goal that's what I look

530
00:19:51,160 --> 00:19:55,420
for that so let's pick the first one

531
00:19:52,720 --> 00:19:57,400
right this actually was doing some

532
00:19:55,420 --> 00:20:01,060
testing with his new tools that came out

533
00:19:57,400 --> 00:20:02,620
the yesterday and that was awesome

534
00:20:01,060 --> 00:20:04,810
because I was able to update my slides

535
00:20:02,620 --> 00:20:05,530
and show it to you so this is a tool

536
00:20:04,810 --> 00:20:08,470
called silk

537
00:20:05,530 --> 00:20:10,320
etw you can find it in github and it's

538
00:20:08,470 --> 00:20:14,580
actually created by Reuben

539
00:20:10,320 --> 00:20:17,970
and his handle is fussy sec but just

540
00:20:14,580 --> 00:20:19,470
look for silk etw from fire i company

541
00:20:17,970 --> 00:20:21,630
and they have that already in github

542
00:20:19,470 --> 00:20:24,180
it's open source so in this case I'm

543
00:20:21,630 --> 00:20:26,670
using this tool and I'm pointing that to

544
00:20:24,180 --> 00:20:28,890
in a specific ECW provider in this case

545
00:20:26,670 --> 00:20:31,230
it's going to be the RPC one and I'm

546
00:20:28,890 --> 00:20:33,870
telling it to please write all the data

547
00:20:31,230 --> 00:20:36,090
to a file you already can see how this

548
00:20:33,870 --> 00:20:37,620
is not as practical to scale but at

549
00:20:36,090 --> 00:20:40,020
least from a research perspective allows

550
00:20:37,620 --> 00:20:41,729
me to see what else I can get in this

551
00:20:40,020 --> 00:20:44,100
case we've got that running and you can

552
00:20:41,730 --> 00:20:47,040
see that this kind of events actually

553
00:20:44,100 --> 00:20:49,320
being you know capture even though I'm

554
00:20:47,040 --> 00:20:51,659
not executing this is sync and that's

555
00:20:49,320 --> 00:20:54,570
because RPC is not only used by these

556
00:20:51,660 --> 00:20:57,120
attack by RPC is used in general by you

557
00:20:54,570 --> 00:20:59,490
know just sort of things happening in

558
00:20:57,120 --> 00:21:01,260
the computer so if I execute this attack

559
00:20:59,490 --> 00:21:06,450
so you can see the events are just keep

560
00:21:01,260 --> 00:21:09,810
going up and so I'm successfully capable

561
00:21:06,450 --> 00:21:11,670
now to write to get the the ntlm hash of

562
00:21:09,810 --> 00:21:13,980
the specific account that I wanted so my

563
00:21:11,670 --> 00:21:18,270
attack it worked and I can just stop my

564
00:21:13,980 --> 00:21:21,210
atw provider and then after that I can

565
00:21:18,270 --> 00:21:25,850
start proudly reading these contents of

566
00:21:21,210 --> 00:21:29,010
this file but this is not of course as

567
00:21:25,850 --> 00:21:30,600
to me as sufficient to be doing going

568
00:21:29,010 --> 00:21:32,430
through this and doing control apps and

569
00:21:30,600 --> 00:21:35,610
things like that so what I do is I just

570
00:21:32,430 --> 00:21:37,710
push that into my own elf stack which is

571
00:21:35,610 --> 00:21:39,300
just a platform that allows me to you

572
00:21:37,710 --> 00:21:41,040
know centralize my data and start

573
00:21:39,300 --> 00:21:44,310
running some queries through Cabana and

574
00:21:41,040 --> 00:21:46,860
Cabana uses you know Lucene syntax so

575
00:21:44,310 --> 00:21:50,159
it's that's limited but at least it

576
00:21:46,860 --> 00:21:53,159
gives you a good platform to export your

577
00:21:50,160 --> 00:21:54,810
data this is easy to import and at the

578
00:21:53,160 --> 00:21:56,690
end I'll show you how you can just in

579
00:21:54,810 --> 00:21:59,040
some of that with our new project I

580
00:21:56,690 --> 00:22:00,780
imported that to my old stack I have

581
00:21:59,040 --> 00:22:02,730
that in an index half of this data in

582
00:22:00,780 --> 00:22:05,700
there and then I can just go through all

583
00:22:02,730 --> 00:22:07,770
all this information but first I gotta

584
00:22:05,700 --> 00:22:09,330
go back to my knowledge base that I was

585
00:22:07,770 --> 00:22:12,690
trying to acquire when I build my

586
00:22:09,330 --> 00:22:15,600
hypothesis let's read about replication

587
00:22:12,690 --> 00:22:17,220
services remote protocols there is some

588
00:22:15,600 --> 00:22:19,500
operations that I need to happen right

589
00:22:17,220 --> 00:22:21,240
from DC to DC from the main controller

590
00:22:19,500 --> 00:22:23,890
to the main controller so I need to

591
00:22:21,240 --> 00:22:26,500
learn about that once again I don't know

592
00:22:23,890 --> 00:22:27,850
of this right and as you - if you go to

593
00:22:26,500 --> 00:22:29,740
your company you want to look for a

594
00:22:27,850 --> 00:22:31,780
specific adversary technique you will

595
00:22:29,740 --> 00:22:33,880
not not run away a hundred percent what

596
00:22:31,780 --> 00:22:35,320
it is doing so you have to do some

597
00:22:33,880 --> 00:22:38,260
really microcell have a lot of good

598
00:22:35,320 --> 00:22:39,550
documentation as you can see in there in

599
00:22:38,260 --> 00:22:42,550
order to connect the domain controller

600
00:22:39,550 --> 00:22:45,430
is gonna use a director replication

601
00:22:42,550 --> 00:22:48,970
service RPC interface within specific

602
00:22:45,430 --> 00:22:51,910
GUI and that good is pretty much a sign

603
00:22:48,970 --> 00:22:53,560
of you know communication be a Directory

604
00:22:51,910 --> 00:22:56,110
replication services with a domain

605
00:22:53,560 --> 00:22:59,320
controller so what I do is I just look

606
00:22:56,110 --> 00:23:01,120
at my etw provider events and I start

607
00:22:59,320 --> 00:23:03,760
trying to figure out where can I find

608
00:23:01,120 --> 00:23:05,909
that information and I and of course

609
00:23:03,760 --> 00:23:09,520
there is already an interface of field

610
00:23:05,910 --> 00:23:12,850
in my data as you can see in there and I

611
00:23:09,520 --> 00:23:15,040
happen in specific Google in there so I

612
00:23:12,850 --> 00:23:17,500
can stack those values see what I have

613
00:23:15,040 --> 00:23:19,149
based on my DW provider but of course I

614
00:23:17,500 --> 00:23:20,980
can jump directly straight to the one

615
00:23:19,150 --> 00:23:24,160
that I was looking for that I know it's

616
00:23:20,980 --> 00:23:26,350
part of my you know RPC communication

617
00:23:24,160 --> 00:23:28,690
with a domain controller for director of

618
00:23:26,350 --> 00:23:32,260
replication services this is very

619
00:23:28,690 --> 00:23:33,760
interesting because until today online

620
00:23:32,260 --> 00:23:35,020
if you go to a Twitter or you know

621
00:23:33,760 --> 00:23:37,990
anything like that when you talk about

622
00:23:35,020 --> 00:23:40,120
detection of this is sync they focus a

623
00:23:37,990 --> 00:23:41,770
lot on the network layer on trying to

624
00:23:40,120 --> 00:23:43,719
you know pull a peek app and trying to

625
00:23:41,770 --> 00:23:45,610
understand the specific communication

626
00:23:43,720 --> 00:23:47,680
happening and most of the data that you

627
00:23:45,610 --> 00:23:49,439
collect for this is synced happens on

628
00:23:47,680 --> 00:23:52,320
the destination on the domain controller

629
00:23:49,440 --> 00:23:55,840
that domain controller tells you hey

630
00:23:52,320 --> 00:23:57,600
someone is asking for permissions to

631
00:23:55,840 --> 00:24:00,550
something and is using replication

632
00:23:57,600 --> 00:24:02,560
permission so take a look at it right

633
00:24:00,550 --> 00:24:04,570
you always get that from a domain

634
00:24:02,560 --> 00:24:06,280
controller that's consumable data that

635
00:24:04,570 --> 00:24:08,320
you can get right away but this is

636
00:24:06,280 --> 00:24:11,410
important to note that you can also get

637
00:24:08,320 --> 00:24:13,480
information from the client in this case

638
00:24:11,410 --> 00:24:17,140
you can get it through RPC e2w providers

639
00:24:13,480 --> 00:24:20,590
tools like Microsoft for example W is

640
00:24:17,140 --> 00:24:23,290
called Windows Defender Windows Defender

641
00:24:20,590 --> 00:24:26,020
advanced threat protection they use

642
00:24:23,290 --> 00:24:27,970
these etw providers through their tools

643
00:24:26,020 --> 00:24:30,639
to give you that data so now that you

644
00:24:27,970 --> 00:24:32,560
know that you can find this is synced

645
00:24:30,640 --> 00:24:35,350
from the client side and not just only

646
00:24:32,560 --> 00:24:37,389
the server side you can probably utilize

647
00:24:35,350 --> 00:24:37,709
that in your tools but if you don't do

648
00:24:37,390 --> 00:24:39,690
this

649
00:24:37,710 --> 00:24:43,559
you don't know where you can find this

650
00:24:39,690 --> 00:24:46,580
data the same thing happens for other

651
00:24:43,559 --> 00:24:49,740
attacks I've Power View enumerate in

652
00:24:46,580 --> 00:24:54,029
Active Directory group members for

653
00:24:49,740 --> 00:24:55,980
example using LDAP there is not

654
00:24:54,029 --> 00:24:58,140
information directly available about

655
00:24:55,980 --> 00:25:00,539
LDAP locally to tell you that there is a

656
00:24:58,140 --> 00:25:02,490
filter or a search going on that is

657
00:25:00,539 --> 00:25:05,520
going to look for domain admins if you

658
00:25:02,490 --> 00:25:08,610
look for this etw provider which is the

659
00:25:05,520 --> 00:25:10,649
Microsoft Windows LDAP client you can

660
00:25:08,610 --> 00:25:12,539
start listening to these going through

661
00:25:10,649 --> 00:25:14,820
the same process that I did and you can

662
00:25:12,539 --> 00:25:17,370
pretty much find a specific LDAP queries

663
00:25:14,820 --> 00:25:18,330
at a client level where you can see how

664
00:25:17,370 --> 00:25:20,250
they're started looking for domain

665
00:25:18,330 --> 00:25:21,928
admins and things like that this is very

666
00:25:20,250 --> 00:25:24,330
interesting so you're gonna start

667
00:25:21,929 --> 00:25:26,220
defining based on your research you have

668
00:25:24,330 --> 00:25:28,740
a goal you have available data sources

669
00:25:26,220 --> 00:25:30,840
but you also have you know unknown data

670
00:25:28,740 --> 00:25:32,010
sources that might be useful and you

671
00:25:30,840 --> 00:25:33,840
might probably have to do some more

672
00:25:32,010 --> 00:25:38,760
research to know how you can consume

673
00:25:33,840 --> 00:25:40,139
that at scale right so when we start

674
00:25:38,760 --> 00:25:41,669
thinking about data modeling now that we

675
00:25:40,140 --> 00:25:43,500
understand what our data comes from

676
00:25:41,669 --> 00:25:45,299
which as you know is very interesting to

677
00:25:43,500 --> 00:25:47,580
know what your data confirm so you can

678
00:25:45,299 --> 00:25:49,710
start now doing some documentation you

679
00:25:47,580 --> 00:25:51,510
might be asking yourself before how do I

680
00:25:49,710 --> 00:25:52,620
do the documentation you are you really

681
00:25:51,510 --> 00:25:53,480
telling me to do it but what does that

682
00:25:52,620 --> 00:25:56,129
look like

683
00:25:53,480 --> 00:25:58,140
so data documentation of course you're

684
00:25:56,130 --> 00:26:00,419
gonna have different data sources in

685
00:25:58,140 --> 00:26:02,370
your environment but each data source in

686
00:26:00,419 --> 00:26:05,010
your environment needs to mean something

687
00:26:02,370 --> 00:26:06,928
needs to be mapped to an event in this

688
00:26:05,010 --> 00:26:09,570
case priced monitoring can be mapped to

689
00:26:06,929 --> 00:26:11,760
40 CDA from Windows security event logs

690
00:26:09,570 --> 00:26:13,139
it could be process termination as well

691
00:26:11,760 --> 00:26:15,390
because we're not just focusing on

692
00:26:13,140 --> 00:26:16,890
creation of processes it will come from

693
00:26:15,390 --> 00:26:19,440
other data sources like system or

694
00:26:16,890 --> 00:26:22,590
process accessing at the end of the day

695
00:26:19,440 --> 00:26:24,270
you have to understand each event of the

696
00:26:22,590 --> 00:26:25,740
relevant data sources that you're

697
00:26:24,270 --> 00:26:27,570
defining and you have to understand that

698
00:26:25,740 --> 00:26:29,850
data in this case putting data

699
00:26:27,570 --> 00:26:31,529
dictionaries this might be a little

700
00:26:29,850 --> 00:26:34,709
tedious where you have to do a lot of

701
00:26:31,529 --> 00:26:35,279
reading going by going one by one and do

702
00:26:34,710 --> 00:26:36,750
it believe me

703
00:26:35,279 --> 00:26:39,990
a lot of people that I talk to about

704
00:26:36,750 --> 00:26:41,399
these in companies they'd rather pay or

705
00:26:39,990 --> 00:26:42,840
they'd rather just not do it at all

706
00:26:41,399 --> 00:26:45,629
because they feel there is a lot of work

707
00:26:42,840 --> 00:26:48,389
but this type of documentation happens

708
00:26:45,630 --> 00:26:50,220
most of the time once and then you

709
00:26:48,389 --> 00:26:51,559
pretty much just maintain your data wiki

710
00:26:50,220 --> 00:26:53,990
you lift-me this might be

711
00:26:51,559 --> 00:26:55,789
simple but this is very useful and a lot

712
00:26:53,990 --> 00:26:58,669
of companies do not even have this level

713
00:26:55,789 --> 00:27:00,230
of documentation so the end there is a

714
00:26:58,669 --> 00:27:02,120
project called awesome that my brother

715
00:27:00,230 --> 00:27:04,009
and I put together which at least give

716
00:27:02,120 --> 00:27:05,479
you some data dictionaries and allows

717
00:27:04,009 --> 00:27:07,970
you to see how you can categorize your

718
00:27:05,480 --> 00:27:09,649
data and document it in all that the

719
00:27:07,970 --> 00:27:11,870
link is at the bottom we're going to

720
00:27:09,649 --> 00:27:15,258
release the the slides also later so you

721
00:27:11,870 --> 00:27:16,850
can just take a look item later that's

722
00:27:15,259 --> 00:27:18,919
going to take us to the next step of our

723
00:27:16,850 --> 00:27:21,320
data modeling whole concept which is

724
00:27:18,919 --> 00:27:22,909
gonna be standardizing our data why do

725
00:27:21,320 --> 00:27:24,259
we care about this right some people

726
00:27:22,909 --> 00:27:26,869
fall asleep when I talk about these type

727
00:27:24,259 --> 00:27:29,299
of things and that's because nobody

728
00:27:26,869 --> 00:27:31,279
wants to if right everybody wants to do

729
00:27:29,299 --> 00:27:32,720
a cool stuff with egw providers and

730
00:27:31,279 --> 00:27:34,820
finding I don't date everybody wants to

731
00:27:32,720 --> 00:27:37,009
do that right but you have to do this as

732
00:27:34,820 --> 00:27:40,189
well you have to understand how you can

733
00:27:37,009 --> 00:27:41,570
create a standard schema for several of

734
00:27:40,190 --> 00:27:43,789
the data sources that you're collecting

735
00:27:41,570 --> 00:27:46,249
otherwise it's gonna be hard to query

736
00:27:43,789 --> 00:27:49,340
your data at scale across several data

737
00:27:46,249 --> 00:27:51,950
sources in this case how do we do this

738
00:27:49,340 --> 00:27:55,039
each event log is gonna have what we

739
00:27:51,950 --> 00:27:56,360
call an entity what means is that if you

740
00:27:55,039 --> 00:27:59,629
have an event log that gives you

741
00:27:56,360 --> 00:28:02,389
information about a user that informated

742
00:27:59,629 --> 00:28:04,549
user feel should be part of a whole

743
00:28:02,389 --> 00:28:06,498
global schema if you have information

744
00:28:04,549 --> 00:28:08,990
about a process that needs to have a

745
00:28:06,499 --> 00:28:10,789
global scheme as well so next time you

746
00:28:08,990 --> 00:28:13,190
get a data source that gives you process

747
00:28:10,789 --> 00:28:16,129
or gives you user information you

748
00:28:13,190 --> 00:28:19,039
already know how to name that feel okay

749
00:28:16,129 --> 00:28:21,110
so if we go to the user entity we have a

750
00:28:19,039 --> 00:28:22,879
lot of different definitions and field

751
00:28:21,110 --> 00:28:24,229
names for user right and this might

752
00:28:22,879 --> 00:28:27,649
change in your environment but at least

753
00:28:24,230 --> 00:28:29,299
is important to know what it is let's

754
00:28:27,649 --> 00:28:32,090
pick the first two and imma show you why

755
00:28:29,299 --> 00:28:34,490
it's important user name to me as a

756
00:28:32,090 --> 00:28:37,100
field name in an event log should be the

757
00:28:34,490 --> 00:28:39,499
user that is performing the main action

758
00:28:37,100 --> 00:28:41,689
in the event in the user reporter name

759
00:28:39,499 --> 00:28:45,169
as its name says it is use a user of the

760
00:28:41,690 --> 00:28:47,330
reports that even happen if we get two

761
00:28:45,169 --> 00:28:48,740
events for 6:24 phone security and four

762
00:28:47,330 --> 00:28:51,289
six four six four the air phone security

763
00:28:48,740 --> 00:28:54,499
we do have two fuel names that are the

764
00:28:51,289 --> 00:28:56,570
same name but they mean two different

765
00:28:54,499 --> 00:28:59,629
things so if I don't put if I do not

766
00:28:56,570 --> 00:29:02,990
parse my data or standardized they all

767
00:28:59,629 --> 00:29:05,270
have an ax schema your security a knows

768
00:29:02,990 --> 00:29:07,550
which will trade this to fill

769
00:29:05,270 --> 00:29:11,570
the same as if they were the same but

770
00:29:07,550 --> 00:29:13,129
they're not in for 624 the subject

771
00:29:11,570 --> 00:29:16,129
username is the user that reports

772
00:29:13,130 --> 00:29:18,170
activity and you for 640 a is the user

773
00:29:16,130 --> 00:29:20,030
that actually performs the action and

774
00:29:18,170 --> 00:29:22,640
request a new logon session with

775
00:29:20,030 --> 00:29:24,560
explicit credentials so that's pretty

776
00:29:22,640 --> 00:29:26,660
big deal you have to know exactly what

777
00:29:24,560 --> 00:29:29,600
your query otherwise you're gonna have a

778
00:29:26,660 --> 00:29:32,120
lot of values in your queries or when

779
00:29:29,600 --> 00:29:35,629
you stack your values that will not make

780
00:29:32,120 --> 00:29:37,040
sense in the context once we do that

781
00:29:35,630 --> 00:29:39,740
then now we can start thinking about

782
00:29:37,040 --> 00:29:41,899
data model and data modeling as a whole

783
00:29:39,740 --> 00:29:43,730
is just basic defining instruction of

784
00:29:41,900 --> 00:29:45,860
your data and also relationship that you

785
00:29:43,730 --> 00:29:49,310
can find in him there's a company called

786
00:29:45,860 --> 00:29:51,679
mitre well that's a nonprofit in the

787
00:29:49,310 --> 00:29:53,510
United States it is the mitre

788
00:29:51,680 --> 00:29:55,790
corporation and they build their own

789
00:29:53,510 --> 00:29:57,950
data models and they are inspired by box

790
00:29:55,790 --> 00:30:01,070
and it sticks syntax which is used for

791
00:29:57,950 --> 00:30:03,380
three intelligence but let's just go

792
00:30:01,070 --> 00:30:05,120
straight to what it is right this is

793
00:30:03,380 --> 00:30:06,530
used for cyber threat intelligence where

794
00:30:05,120 --> 00:30:09,530
you're gonna start building this like

795
00:30:06,530 --> 00:30:11,330
basic knowledge graphs where you can say

796
00:30:09,530 --> 00:30:12,800
an adversary can be mapped to a piece of

797
00:30:11,330 --> 00:30:14,689
malware and you know things like that

798
00:30:12,800 --> 00:30:17,810
and you're gonna start adding some

799
00:30:14,690 --> 00:30:20,780
properties to these specific notes on

800
00:30:17,810 --> 00:30:22,490
your graph on your knowledge graph this

801
00:30:20,780 --> 00:30:24,530
can be applied also to Windows security

802
00:30:22,490 --> 00:30:26,600
event logs or any other event log in

803
00:30:24,530 --> 00:30:28,220
general because you have also files

804
00:30:26,600 --> 00:30:30,800
processes IPs

805
00:30:28,220 --> 00:30:32,750
remember the concept of entities in a

806
00:30:30,800 --> 00:30:34,490
data model and you use those concepts as

807
00:30:32,750 --> 00:30:36,320
well and there must be some

808
00:30:34,490 --> 00:30:39,170
relationships across this because by

809
00:30:36,320 --> 00:30:41,960
nature a file does not get created by

810
00:30:39,170 --> 00:30:44,420
itself a file gets created by some by

811
00:30:41,960 --> 00:30:46,610
something in this case our data tells us

812
00:30:44,420 --> 00:30:49,060
that is created by a process a process

813
00:30:46,610 --> 00:30:51,830
when it connects to an external location

814
00:30:49,060 --> 00:30:54,590
technically the process connecting to an

815
00:30:51,830 --> 00:30:56,990
external IP and if you start adding

816
00:30:54,590 --> 00:31:00,439
properties and attributes to this based

817
00:30:56,990 --> 00:31:01,730
on your data dictionaries you're gonna

818
00:31:00,440 --> 00:31:04,160
start identifying that there could be

819
00:31:01,730 --> 00:31:06,850
some relationships across there specific

820
00:31:04,160 --> 00:31:09,860
you know event log sent inside that so

821
00:31:06,850 --> 00:31:11,750
this is basic but this is this specific

822
00:31:09,860 --> 00:31:13,820
model what allow you to start building

823
00:31:11,750 --> 00:31:16,640
things like this this is the system on

824
00:31:13,820 --> 00:31:18,080
Windows Windows system on data model

825
00:31:16,640 --> 00:31:19,130
which tells you all the different

826
00:31:18,080 --> 00:31:22,399
relationships

827
00:31:19,130 --> 00:31:23,840
you can find in sis Mon event logs so

828
00:31:22,400 --> 00:31:25,910
the process creating a process

829
00:31:23,840 --> 00:31:28,310
relationship is provided by the event ID

830
00:31:25,910 --> 00:31:30,920
one process creating a file is created

831
00:31:28,310 --> 00:31:33,169
by event ID 11 and so on so you can

832
00:31:30,920 --> 00:31:35,320
create this nice graph that at the end

833
00:31:33,170 --> 00:31:37,940
would allow you to start mapping

834
00:31:35,320 --> 00:31:40,639
activity of an adversary to and a

835
00:31:37,940 --> 00:31:41,630
specific data source of event law so

836
00:31:40,640 --> 00:31:43,640
let's think about this there is a

837
00:31:41,630 --> 00:31:47,540
technique on the light on the right of

838
00:31:43,640 --> 00:31:49,670
you that's the ID and then you have a

839
00:31:47,540 --> 00:31:51,649
couple data sources but you have to make

840
00:31:49,670 --> 00:31:53,450
sense of process monitoring now with

841
00:31:51,650 --> 00:31:55,580
your knowledge of data model and a

842
00:31:53,450 --> 00:31:58,970
little bit in beta dictionaries you can

843
00:31:55,580 --> 00:32:00,980
right away say process monitoring I have

844
00:31:58,970 --> 00:32:04,760
information from creation all the way to

845
00:32:00,980 --> 00:32:06,740
access each is specific you know sub

846
00:32:04,760 --> 00:32:08,750
data source in there or the relationship

847
00:32:06,740 --> 00:32:11,600
created that should be mapped to

848
00:32:08,750 --> 00:32:13,490
specific events because the moment I

849
00:32:11,600 --> 00:32:15,770
asked myself where I asked you

850
00:32:13,490 --> 00:32:18,260
hey do we have anything that tells you

851
00:32:15,770 --> 00:32:20,690
when a process accesses another process

852
00:32:18,260 --> 00:32:23,810
you should answer that question say yes

853
00:32:20,690 --> 00:32:25,040
that comes from system event ID 10 that

854
00:32:23,810 --> 00:32:27,770
relationship that you're looking for

855
00:32:25,040 --> 00:32:30,050
it's mapped to my specific event 10 and

856
00:32:27,770 --> 00:32:31,610
that's what you start defining also

857
00:32:30,050 --> 00:32:35,240
relevant data that you can use for a

858
00:32:31,610 --> 00:32:38,719
hunting engagement so you are taking the

859
00:32:35,240 --> 00:32:41,150
whole expertise a little bit away from

860
00:32:38,720 --> 00:32:43,010
this whole methodology why is that I

861
00:32:41,150 --> 00:32:44,750
work with people that tell me I don't

862
00:32:43,010 --> 00:32:47,660
need this because I know what I'm

863
00:32:44,750 --> 00:32:49,370
looking for and I'm an expert it to me

864
00:32:47,660 --> 00:32:50,960
is like no one is an expert there's

865
00:32:49,370 --> 00:32:53,389
always a lot of things that you need to

866
00:32:50,960 --> 00:32:54,800
learn and in this case obviously there's

867
00:32:53,390 --> 00:32:56,660
a couple things you need to learn from

868
00:32:54,800 --> 00:32:59,120
how you can map your data to specific

869
00:32:56,660 --> 00:33:02,330
techniques right this would allow you to

870
00:32:59,120 --> 00:33:04,399
start mapping in a more factual way an

871
00:33:02,330 --> 00:33:06,919
event ID all the way to a potential

872
00:33:04,400 --> 00:33:09,050
technique from an adversary and I expect

873
00:33:06,920 --> 00:33:11,180
that to be of course documented in this

874
00:33:09,050 --> 00:33:12,889
type of format for example if you go to

875
00:33:11,180 --> 00:33:14,690
that link over there once again it's

876
00:33:12,890 --> 00:33:17,570
going to be sure later and he's part of

877
00:33:14,690 --> 00:33:19,790
the ocean project I already have a

878
00:33:17,570 --> 00:33:22,399
couple of data relationships mapped to

879
00:33:19,790 --> 00:33:24,200
event IDs all the way to the specific

880
00:33:22,400 --> 00:33:26,450
configurations that you need to enable

881
00:33:24,200 --> 00:33:28,790
in your environment to also collect the

882
00:33:26,450 --> 00:33:30,350
data so some of the works already been

883
00:33:28,790 --> 00:33:32,180
done out there so probably you can use

884
00:33:30,350 --> 00:33:32,490
that to start and then build it with

885
00:33:32,180 --> 00:33:36,059
your

886
00:33:32,490 --> 00:33:38,220
data sources so what does that mean data

887
00:33:36,059 --> 00:33:39,899
modelling with the adversary behavior

888
00:33:38,220 --> 00:33:41,730
right some of you might be saying it

889
00:33:39,900 --> 00:33:44,580
doesn't make sense it still this guy's

890
00:33:41,730 --> 00:33:47,340
not explaining a problem right so let's

891
00:33:44,580 --> 00:33:49,800
go back to or WMI activity we know that

892
00:33:47,340 --> 00:33:51,510
the main goal is to move laterally we

893
00:33:49,800 --> 00:33:52,909
know that this could be accomplished by

894
00:33:51,510 --> 00:33:56,460
the windows management instrumentation

895
00:33:52,910 --> 00:33:58,860
framework and if I want more detail this

896
00:33:56,460 --> 00:34:02,610
can be done by your win32 process class

897
00:33:58,860 --> 00:34:04,169
with it class with method create and of

898
00:34:02,610 --> 00:34:07,469
course that specific procedure that

899
00:34:04,170 --> 00:34:09,780
we're looking for is a new agent a new

900
00:34:07,470 --> 00:34:12,960
connection talking back to a commanding

901
00:34:09,780 --> 00:34:14,639
control meanwhile the adversary has

902
00:34:12,960 --> 00:34:16,409
their own tools their own infrastructure

903
00:34:14,639 --> 00:34:19,020
and they see some of these probably like

904
00:34:16,409 --> 00:34:20,610
with some cool graphs trying to you know

905
00:34:19,020 --> 00:34:23,399
waiting for that beacon to you know to

906
00:34:20,610 --> 00:34:26,280
call back I look at it from this

907
00:34:23,399 --> 00:34:29,850
perspective without even running the

908
00:34:26,280 --> 00:34:32,250
attack without even collecting data just

909
00:34:29,850 --> 00:34:34,918
by documenting and modeling my data I

910
00:34:32,250 --> 00:34:36,899
can start understanding based on my

911
00:34:34,918 --> 00:34:39,690
knowledge our process when I connect to

912
00:34:36,899 --> 00:34:41,279
a host that's when I create a a

913
00:34:39,690 --> 00:34:43,440
potential authentication so I'm

914
00:34:41,280 --> 00:34:45,149
expecting a poor 6:24 there's gonna be

915
00:34:43,440 --> 00:34:47,700
some process talking to an external IP

916
00:34:45,149 --> 00:34:50,668
that's gonna be an event ID 3 because I

917
00:34:47,699 --> 00:34:54,359
know a process to an IP is an event ID 3

918
00:34:50,668 --> 00:34:56,009
Francisco hmm we know the WMI prpsc is

919
00:34:54,359 --> 00:34:58,140
basically the process that will be

920
00:34:56,010 --> 00:35:00,869
executing whatever you wanted to execute

921
00:34:58,140 --> 00:35:04,680
on the destination well if I have event

922
00:35:00,869 --> 00:35:07,170
ID 1 I can have my W my peer peer vs C

923
00:35:04,680 --> 00:35:08,940
as my parent and then my child I don't

924
00:35:07,170 --> 00:35:10,320
care about the child but the child is

925
00:35:08,940 --> 00:35:12,960
going to be they make a connection to a

926
00:35:10,320 --> 00:35:14,490
network so you can see how important it

927
00:35:12,960 --> 00:35:16,800
is to understand your data so you can

928
00:35:14,490 --> 00:35:18,959
map potential behaviors to your data

929
00:35:16,800 --> 00:35:23,010
right without even starting to analyze

930
00:35:18,960 --> 00:35:26,580
the data based on your data modeling you

931
00:35:23,010 --> 00:35:29,310
can then say well 1 & 3 are actually

932
00:35:26,580 --> 00:35:31,890
related to each other by a specific

933
00:35:29,310 --> 00:35:34,830
field called the process gooood that's

934
00:35:31,890 --> 00:35:38,250
provided by sis Mon so sis Mon gives you

935
00:35:34,830 --> 00:35:41,310
already that relationship so if you did

936
00:35:38,250 --> 00:35:43,050
your due diligence is and you wrote your

937
00:35:41,310 --> 00:35:45,799
dictionary about 1 & 3

938
00:35:43,050 --> 00:35:47,780
you understand why process gooood

939
00:35:45,800 --> 00:35:50,960
it's the unique value that would allow

940
00:35:47,780 --> 00:35:54,290
you to link to event IDs this is how you

941
00:35:50,960 --> 00:35:58,280
model data and also you model that data

942
00:35:54,290 --> 00:35:59,240
to an adversary behavior so in this is

943
00:35:58,280 --> 00:36:01,250
step now we're going to start simulating

944
00:35:59,240 --> 00:36:02,839
the data and we're not spending too much

945
00:36:01,250 --> 00:36:04,040
time on this because I believe this is

946
00:36:02,840 --> 00:36:05,660
just makes sense you're gonna simulate

947
00:36:04,040 --> 00:36:07,400
an attack you need a research

948
00:36:05,660 --> 00:36:08,779
environment this is part of the project

949
00:36:07,400 --> 00:36:10,550
the project that were going to be

950
00:36:08,780 --> 00:36:12,860
releasing today so you're gonna get more

951
00:36:10,550 --> 00:36:15,110
information about that and you need to

952
00:36:12,860 --> 00:36:16,970
have a plan one of the best plans out

953
00:36:15,110 --> 00:36:20,690
there that I've seen public and open

954
00:36:16,970 --> 00:36:23,959
source is the mitre attacks team apt 3

955
00:36:20,690 --> 00:36:26,510
apt 3 emulation plan once again if you

956
00:36:23,960 --> 00:36:28,310
wanna you know simulate one technique or

957
00:36:26,510 --> 00:36:30,260
two techniques or a whole campaign up to

958
00:36:28,310 --> 00:36:32,270
you depends on your goal you might

959
00:36:30,260 --> 00:36:35,240
probably might want to do some in

960
00:36:32,270 --> 00:36:36,500
something like this at the end when you

961
00:36:35,240 --> 00:36:37,879
start executing your attack there's

962
00:36:36,500 --> 00:36:39,980
gonna be vents that are going to be

963
00:36:37,880 --> 00:36:42,560
generated remember at the beginning you

964
00:36:39,980 --> 00:36:46,280
define relevant data sources that you

965
00:36:42,560 --> 00:36:48,529
need and when I show you the data this

966
00:36:46,280 --> 00:36:50,140
specific picture from a data model in

967
00:36:48,530 --> 00:36:54,170
perspective you at least have an idea

968
00:36:50,140 --> 00:36:56,480
what you will be expecting but when you

969
00:36:54,170 --> 00:36:59,690
are working on a lap environment I will

970
00:36:56,480 --> 00:37:01,490
highly recommend to get more context so

971
00:36:59,690 --> 00:37:03,620
you can be a little bit more creative if

972
00:37:01,490 --> 00:37:06,379
your relevant data sources does not tell

973
00:37:03,620 --> 00:37:08,240
you much you can use other data sources

974
00:37:06,380 --> 00:37:10,040
available for context when the attack

975
00:37:08,240 --> 00:37:12,560
gets executed but make sure you document

976
00:37:10,040 --> 00:37:14,840
those specific events some basic

977
00:37:12,560 --> 00:37:16,970
concepts in there are you know today we

978
00:37:14,840 --> 00:37:18,650
can start defining a detection model

979
00:37:16,970 --> 00:37:20,750
right we're gonna start now

980
00:37:18,650 --> 00:37:25,130
going into how we're gonna hunt for this

981
00:37:20,750 --> 00:37:27,500
right we can use our initial data

982
00:37:25,130 --> 00:37:29,300
modelling we were able to validate the

983
00:37:27,500 --> 00:37:31,730
relevant data sources that I needed when

984
00:37:29,300 --> 00:37:33,890
I know simulated attack I can come up

985
00:37:31,730 --> 00:37:35,990
with this query you know like a sequel I

986
00:37:33,890 --> 00:37:39,020
type of query I'm collecting information

987
00:37:35,990 --> 00:37:41,089
from two events and the reason how I can

988
00:37:39,020 --> 00:37:43,100
do this is because I can actually use

989
00:37:41,090 --> 00:37:46,520
the process GUI to join these two events

990
00:37:43,100 --> 00:37:49,190
and I can filter this data by WMI prvs

991
00:37:46,520 --> 00:37:51,020
II because remember my knowledge was

992
00:37:49,190 --> 00:37:54,200
telling me that whatever happens on the

993
00:37:51,020 --> 00:37:55,700
destination is hosted by WMI prpsc

994
00:37:54,200 --> 00:37:57,529
the attacker can now control that

995
00:37:55,700 --> 00:37:59,540
directly that's just how the computer

996
00:37:57,530 --> 00:38:01,700
behaves the company

997
00:37:59,540 --> 00:38:03,740
attacker can control the child the

998
00:38:01,700 --> 00:38:06,169
attacker can control what is executed by

999
00:38:03,740 --> 00:38:10,339
w my PR Biasi by the attacker cannot

1000
00:38:06,170 --> 00:38:12,050
change directly w my prpsc process on

1001
00:38:10,340 --> 00:38:14,870
the destination because that's just a

1002
00:38:12,050 --> 00:38:17,330
way how w my works having the knowledge

1003
00:38:14,870 --> 00:38:20,630
i can easily put that w my PR VSC

1004
00:38:17,330 --> 00:38:23,330
stirring dinner the idea is to be able

1005
00:38:20,630 --> 00:38:25,580
to collect this data and then test it in

1006
00:38:23,330 --> 00:38:27,740
my lab environment and of course is a

1007
00:38:25,580 --> 00:38:29,690
lab environment so I expect that to be

1008
00:38:27,740 --> 00:38:31,850
true if I'm trying to detect for that

1009
00:38:29,690 --> 00:38:34,850
specific activity in this case we do

1010
00:38:31,850 --> 00:38:37,640
have a process map to an IP to a process

1011
00:38:34,850 --> 00:38:40,430
command line in the command line of

1012
00:38:37,640 --> 00:38:42,200
course it's just a basic you know

1013
00:38:40,430 --> 00:38:43,549
payload the pail of being used in order

1014
00:38:42,200 --> 00:38:45,649
to communicate with the command and

1015
00:38:43,550 --> 00:38:49,370
control and start the whole you know

1016
00:38:45,650 --> 00:38:50,750
handshake to start the connection so the

1017
00:38:49,370 --> 00:38:53,240
process command line is not actually

1018
00:38:50,750 --> 00:38:55,970
available on system 11:33 it's available

1019
00:38:53,240 --> 00:38:57,500
it is available in one because one is

1020
00:38:55,970 --> 00:38:59,060
process creation and gives you

1021
00:38:57,500 --> 00:39:01,400
information about the process command

1022
00:38:59,060 --> 00:39:03,770
line but since i'm joining these two to

1023
00:39:01,400 --> 00:39:06,530
log files i can get that information

1024
00:39:03,770 --> 00:39:10,100
together and run a query on the top of

1025
00:39:06,530 --> 00:39:13,160
that joint if you do not find anything

1026
00:39:10,100 --> 00:39:14,480
right this process is not a one-way you

1027
00:39:13,160 --> 00:39:16,490
will have to probably go back to your

1028
00:39:14,480 --> 00:39:18,110
research goal and adjust it a little bit

1029
00:39:16,490 --> 00:39:19,549
probably you're being too white there's

1030
00:39:18,110 --> 00:39:21,590
a lot of false positives in here

1031
00:39:19,550 --> 00:39:24,410
probably get a little bit more detail

1032
00:39:21,590 --> 00:39:26,090
right check your data model check if

1033
00:39:24,410 --> 00:39:28,069
you're missing anything from a relevant

1034
00:39:26,090 --> 00:39:29,480
data information and probably simulate

1035
00:39:28,070 --> 00:39:31,490
it again you probably miss a couple of

1036
00:39:29,480 --> 00:39:33,140
configurations so this is a kind of

1037
00:39:31,490 --> 00:39:35,930
repetitive process that you have to do

1038
00:39:33,140 --> 00:39:40,400
if you get a lot of events after you run

1039
00:39:35,930 --> 00:39:42,200
your analytic so now it's time to start

1040
00:39:40,400 --> 00:39:44,150
validating this in production because in

1041
00:39:42,200 --> 00:39:45,620
your lab environment is not to be the

1042
00:39:44,150 --> 00:39:46,280
same as in production right it's just

1043
00:39:45,620 --> 00:39:49,880
common sense

1044
00:39:46,280 --> 00:39:51,590
when you do that before you do that this

1045
00:39:49,880 --> 00:39:53,300
is why these methodologies that they are

1046
00:39:51,590 --> 00:39:56,090
three methodology you need to think

1047
00:39:53,300 --> 00:39:58,010
about your data quality don't go and

1048
00:39:56,090 --> 00:40:00,830
hunt or run queries in your environment

1049
00:39:58,010 --> 00:40:04,240
without caring about the data quality of

1050
00:40:00,830 --> 00:40:06,830
your acquired data what does that mean

1051
00:40:04,240 --> 00:40:08,330
according to the DoD Department of

1052
00:40:06,830 --> 00:40:09,920
Defense of the United States there is a

1053
00:40:08,330 --> 00:40:11,360
couple of different quality dimensions

1054
00:40:09,920 --> 00:40:13,490
that you should consider when looking at

1055
00:40:11,360 --> 00:40:15,260
your data all the way from the data

1056
00:40:13,490 --> 00:40:17,750
being accurate all the way probably to

1057
00:40:15,260 --> 00:40:19,369
the data to be unique this might apply

1058
00:40:17,750 --> 00:40:22,100
to certain data sources but for

1059
00:40:19,369 --> 00:40:24,440
cybersecurity at least focus on these

1060
00:40:22,100 --> 00:40:27,319
three data completeness would allow you

1061
00:40:24,440 --> 00:40:30,110
to know when your data you're collecting

1062
00:40:27,320 --> 00:40:32,150
is first configured properly to give you

1063
00:40:30,110 --> 00:40:34,910
whatever you want to collect complete

1064
00:40:32,150 --> 00:40:37,100
and also that you are collecting the

1065
00:40:34,910 --> 00:40:38,960
data across the scope of your hunting

1066
00:40:37,100 --> 00:40:40,549
engagement if you say I'm collecting

1067
00:40:38,960 --> 00:40:42,590
system and you have a hundred thousand

1068
00:40:40,550 --> 00:40:46,100
endpoints in your early collected four

1069
00:40:42,590 --> 00:40:48,290
five from five you're not being very

1070
00:40:46,100 --> 00:40:50,118
much effective at what you do it right

1071
00:40:48,290 --> 00:40:52,640
so that's the completeness is about as

1072
00:40:50,119 --> 00:40:53,980
well and then data consistency is how

1073
00:40:52,640 --> 00:40:56,779
you're going to be checking constantly

1074
00:40:53,980 --> 00:40:59,540
that your standardization that you did

1075
00:40:56,780 --> 00:41:02,600
before is constantly let's say up to day

1076
00:40:59,540 --> 00:41:05,000
or of quality and the timeliness is

1077
00:41:02,600 --> 00:41:07,310
let's say let's do a hunt for 30 days

1078
00:41:05,000 --> 00:41:10,130
and you only have data for five days

1079
00:41:07,310 --> 00:41:12,710
hey the data's not of quality you cannot

1080
00:41:10,130 --> 00:41:14,960
validate something that has happened in

1081
00:41:12,710 --> 00:41:18,140
the past 30 days so that's the basic

1082
00:41:14,960 --> 00:41:20,210
scale you can start assessing the

1083
00:41:18,140 --> 00:41:22,160
quality of your data and understand if

1084
00:41:20,210 --> 00:41:26,869
you're ready or not to start testing

1085
00:41:22,160 --> 00:41:30,049
things in production so after we finish

1086
00:41:26,869 --> 00:41:33,859
our data quality assessment we are ready

1087
00:41:30,050 --> 00:41:36,920
to prove if our they are analytic works

1088
00:41:33,859 --> 00:41:39,080
in production environment so what are

1089
00:41:36,920 --> 00:41:42,260
the possible results after the validate

1090
00:41:39,080 --> 00:41:45,830
after this validation process we can get

1091
00:41:42,260 --> 00:41:49,520
zero hits or at least one hit if we get

1092
00:41:45,830 --> 00:41:53,779
zero hits this means that the specific

1093
00:41:49,520 --> 00:41:57,160
adversary behavior that we validate in

1094
00:41:53,780 --> 00:41:59,780
our lab you know in our lab environment

1095
00:41:57,160 --> 00:42:04,250
is not happening in your production

1096
00:41:59,780 --> 00:42:08,650
environment so because we validate that

1097
00:42:04,250 --> 00:42:14,990
the we validate that our data analytic

1098
00:42:08,650 --> 00:42:18,619
can identify the adversary in our in our

1099
00:42:14,990 --> 00:42:23,589
environment we can define this data

1100
00:42:18,619 --> 00:42:25,029
analytic as a high fidelity analytic now

1101
00:42:23,590 --> 00:42:30,699
on the other

1102
00:42:25,029 --> 00:42:34,559
and if we just if we just get a few hits

1103
00:42:30,699 --> 00:42:37,689
right it is really easy to us to

1104
00:42:34,559 --> 00:42:40,329
investigate each event log let's say for

1105
00:42:37,689 --> 00:42:42,098
example you just you round your your

1106
00:42:40,329 --> 00:42:47,969
date analytic and you get maybe three

1107
00:42:42,099 --> 00:42:52,390
five or ten event logs okay so this

1108
00:42:47,969 --> 00:42:54,009
quantity of event logs is really small

1109
00:42:52,390 --> 00:42:55,989
so we can just take the time and

1110
00:42:54,009 --> 00:42:58,390
investigate each event log to understand

1111
00:42:55,989 --> 00:43:01,559
what is happening which are false

1112
00:42:58,390 --> 00:43:03,549
positive and which apart may be

1113
00:43:01,559 --> 00:43:07,749
indicators of the UM borromini's

1114
00:43:03,549 --> 00:43:10,059
compromised ID and the last option is

1115
00:43:07,749 --> 00:43:12,759
what's happening if after we apply our

1116
00:43:10,059 --> 00:43:16,179
data analytic and we get a lot of hits

1117
00:43:12,759 --> 00:43:18,969
okay so an additional data exploration

1118
00:43:16,179 --> 00:43:20,739
process might be recommended that

1119
00:43:18,969 --> 00:43:22,689
happens a lot actually you know every

1120
00:43:20,739 --> 00:43:23,949
time I go to an environment and we just

1121
00:43:22,689 --> 00:43:25,239
come up with these you know nice

1122
00:43:23,949 --> 00:43:27,099
analytic and you know something that we

1123
00:43:25,239 --> 00:43:28,479
can use you know the day is a lot of

1124
00:43:27,099 --> 00:43:30,519
different hits that happen because an

1125
00:43:28,479 --> 00:43:32,558
environment somewhat activity might be

1126
00:43:30,519 --> 00:43:34,209
just your normal activity as you know

1127
00:43:32,559 --> 00:43:36,789
anybody of you probably have experience

1128
00:43:34,209 --> 00:43:38,408
so most of the time happens which is the

1129
00:43:36,789 --> 00:43:41,079
last one where you need some some

1130
00:43:38,409 --> 00:43:42,699
additional exploration of the data so

1131
00:43:41,079 --> 00:43:46,449
what does additional data exploration

1132
00:43:42,699 --> 00:43:49,599
mean roberto already told us that we can

1133
00:43:46,449 --> 00:43:51,159
understand our data creating the data

1134
00:43:49,599 --> 00:43:53,769
dictionaries and we are going to

1135
00:43:51,159 --> 00:43:56,019
understand our event logs from the

1136
00:43:53,769 --> 00:44:00,359
script from a description perspective

1137
00:43:56,019 --> 00:44:03,069
okay but if we are getting a lot of

1138
00:44:00,359 --> 00:44:06,279
event logs after we apply our data

1139
00:44:03,069 --> 00:44:09,329
analytic we have different options we

1140
00:44:06,279 --> 00:44:12,189
can go back to our initial steps and

1141
00:44:09,329 --> 00:44:14,979
review if there is something that we can

1142
00:44:12,189 --> 00:44:17,859
improve to improve of course our data

1143
00:44:14,979 --> 00:44:21,729
analytic or maybe we can use a different

1144
00:44:17,859 --> 00:44:26,259
approach to get more context from our

1145
00:44:21,729 --> 00:44:30,189
data so let's

1146
00:44:26,260 --> 00:44:33,460
a statistical method to get more content

1147
00:44:30,190 --> 00:44:35,530
from our data and to do these what we

1148
00:44:33,460 --> 00:44:37,660
need to the main question here that we

1149
00:44:35,530 --> 00:44:41,560
need to answer is what type of data we

1150
00:44:37,660 --> 00:44:43,299
have in our in our environment so we are

1151
00:44:41,560 --> 00:44:46,060
going to use two basic concepts to

1152
00:44:43,300 --> 00:44:48,180
describe up with our data the first one

1153
00:44:46,060 --> 00:44:51,640
is related to the structure or the

1154
00:44:48,180 --> 00:44:54,339
organization of our data values and the

1155
00:44:51,640 --> 00:44:59,259
other one is the numerical description

1156
00:44:54,340 --> 00:45:03,250
that you can use to with your values now

1157
00:44:59,260 --> 00:45:05,820
this process is not only going to help

1158
00:45:03,250 --> 00:45:07,990
us to understand what statistical

1159
00:45:05,820 --> 00:45:10,960
methods or concepts you can apply with

1160
00:45:07,990 --> 00:45:12,580
your data you can also learn more from

1161
00:45:10,960 --> 00:45:15,820
your data because you are using a

1162
00:45:12,580 --> 00:45:19,869
different perspective so how can we

1163
00:45:15,820 --> 00:45:23,050
identify if we have a structure or

1164
00:45:19,869 --> 00:45:24,970
unstructured data it's really easy if

1165
00:45:23,050 --> 00:45:26,920
you have values in your in your

1166
00:45:24,970 --> 00:45:29,618
environment that are following a

1167
00:45:26,920 --> 00:45:33,369
specific rule right to create to create

1168
00:45:29,619 --> 00:45:35,680
to create every value for example the

1169
00:45:33,369 --> 00:45:37,480
computer name field is a good example of

1170
00:45:35,680 --> 00:45:39,549
organized data because in this case we

1171
00:45:37,480 --> 00:45:43,650
are using the first two characters to

1172
00:45:39,550 --> 00:45:46,000
identify a specific Department of

1173
00:45:43,650 --> 00:45:49,570
organization and we are using the other

1174
00:45:46,000 --> 00:45:51,160
three characters to identify maybe the

1175
00:45:49,570 --> 00:45:53,859
number of computers we have on each

1176
00:45:51,160 --> 00:45:56,529
department and a good examples of

1177
00:45:53,859 --> 00:45:59,380
unorganized data is the process

1178
00:45:56,530 --> 00:46:02,920
command-line field because every value

1179
00:45:59,380 --> 00:46:05,200
you can get on that specific field is

1180
00:46:02,920 --> 00:46:09,160
not following any rule or any standard

1181
00:46:05,200 --> 00:46:13,240
organization hierarchy so for example

1182
00:46:09,160 --> 00:46:16,118
what metals can use with an organized

1183
00:46:13,240 --> 00:46:17,830
data if we have a value for from this is

1184
00:46:16,119 --> 00:46:20,200
an example of a process command line

1185
00:46:17,830 --> 00:46:22,569
value so we can start calculating the

1186
00:46:20,200 --> 00:46:25,540
length of the value so it means how many

1187
00:46:22,570 --> 00:46:27,910
characters we'll have in this command

1188
00:46:25,540 --> 00:46:31,090
line value or maybe for example we can

1189
00:46:27,910 --> 00:46:33,759
just create new information just looking

1190
00:46:31,090 --> 00:46:35,710
for specific characters do we have any

1191
00:46:33,760 --> 00:46:39,750
specific character in this value of

1192
00:46:35,710 --> 00:46:42,790
command line and an additional

1193
00:46:39,750 --> 00:46:45,370
method that we can use is just add extra

1194
00:46:42,790 --> 00:46:48,730
context so it's like you can tack this

1195
00:46:45,370 --> 00:46:52,540
even this value for example

1196
00:46:48,730 --> 00:46:54,280
this value is using WMI processes in

1197
00:46:52,540 --> 00:46:58,779
your computer so you're just adding

1198
00:46:54,280 --> 00:47:01,180
extra information about this so we got a

1199
00:46:58,780 --> 00:47:04,180
lot of even logs after we'd apply our

1200
00:47:01,180 --> 00:47:07,450
data analytic now if we see all these

1201
00:47:04,180 --> 00:47:10,509
values we can start sorting our values

1202
00:47:07,450 --> 00:47:13,720
okay so let's focus only my hypothesis

1203
00:47:10,510 --> 00:47:17,410
is related to WMI processes okay we can

1204
00:47:13,720 --> 00:47:20,939
start categorizing about data now what

1205
00:47:17,410 --> 00:47:25,299
what about and what about organized data

1206
00:47:20,940 --> 00:47:27,460
so to start that to to start that

1207
00:47:25,300 --> 00:47:30,340
analysis we need to understand a basic

1208
00:47:27,460 --> 00:47:32,620
concept first what is quantitative data

1209
00:47:30,340 --> 00:47:34,480
and what is qualitative data there is

1210
00:47:32,620 --> 00:47:36,130
really basic quantitative data is data

1211
00:47:34,480 --> 00:47:38,380
that you can represent with numbers and

1212
00:47:36,130 --> 00:47:40,300
qualitative data is data that you can

1213
00:47:38,380 --> 00:47:42,430
not only use number you can also use

1214
00:47:40,300 --> 00:47:45,090
characters or symbols to represent the

1215
00:47:42,430 --> 00:47:48,310
values so what method can we use with

1216
00:47:45,090 --> 00:47:51,130
qualitative data for example for example

1217
00:47:48,310 --> 00:47:53,170
if we use the user name we can start we

1218
00:47:51,130 --> 00:47:57,940
can start adding more context to

1219
00:47:53,170 --> 00:48:01,540
identify which of the user are related

1220
00:47:57,940 --> 00:48:05,530
to user account or computer accounts and

1221
00:48:01,540 --> 00:48:08,890
we can also start using or perform add I

1222
00:48:05,530 --> 00:48:10,570
start counting procedure so you may be

1223
00:48:08,890 --> 00:48:12,670
if you see your hypothesis you're

1224
00:48:10,570 --> 00:48:14,890
looking for the most frequent or less

1225
00:48:12,670 --> 00:48:17,140
frequent values and there are also

1226
00:48:14,890 --> 00:48:19,060
another methods that you can use like

1227
00:48:17,140 --> 00:48:21,310
again the Lang or maybe your interesting

1228
00:48:19,060 --> 00:48:23,710
or specific unique values or maybe you

1229
00:48:21,310 --> 00:48:27,040
can only you're interested in the

1230
00:48:23,710 --> 00:48:31,030
frequency of this username over over the

1231
00:48:27,040 --> 00:48:33,700
time then something interesting about

1232
00:48:31,030 --> 00:48:35,470
qualitative data is that if you see all

1233
00:48:33,700 --> 00:48:38,350
these values that we have for the the

1234
00:48:35,470 --> 00:48:41,470
field username we know that they are

1235
00:48:38,350 --> 00:48:45,279
different we know that they are what

1236
00:48:41,470 --> 00:48:49,680
they are allowing us to identify each

1237
00:48:45,280 --> 00:48:51,430
value but we cannot make any other

1238
00:48:49,680 --> 00:48:52,440
analysis we just know that they are

1239
00:48:51,430 --> 00:48:55,200
different

1240
00:48:52,440 --> 00:48:57,869
so we can add more information about the

1241
00:48:55,200 --> 00:49:01,470
username for example the wheels a

1242
00:48:57,869 --> 00:49:04,260
privilege tag we can start identifying

1243
00:49:01,470 --> 00:49:05,700
which username has privileges a domain

1244
00:49:04,260 --> 00:49:07,890
admin or maybe as a domain controller

1245
00:49:05,700 --> 00:49:10,078
but what is the difference between these

1246
00:49:07,890 --> 00:49:12,509
data and the other one is that now we

1247
00:49:10,079 --> 00:49:15,800
can rank our data and we can compare it

1248
00:49:12,510 --> 00:49:21,210
okay so our hypothesis is related to

1249
00:49:15,800 --> 00:49:24,690
users that that high privilege yeah the

1250
00:49:21,210 --> 00:49:26,150
high privilege as a domain controller or

1251
00:49:24,690 --> 00:49:31,920
maybe as a regular user

1252
00:49:26,150 --> 00:49:33,119
now what about quantitative data we need

1253
00:49:31,920 --> 00:49:35,190
to understand that there are two type of

1254
00:49:33,119 --> 00:49:37,680
quantitative data so are there are

1255
00:49:35,190 --> 00:49:40,319
discrete values and continuous value so

1256
00:49:37,680 --> 00:49:42,930
discrete values is you have you used

1257
00:49:40,319 --> 00:49:45,060
numbers that you can count on a specific

1258
00:49:42,930 --> 00:49:49,069
range of data let's say between 1 and 10

1259
00:49:45,060 --> 00:49:52,650
you have only 10 options but when you

1260
00:49:49,069 --> 00:49:55,020
have data that let's let's say for

1261
00:49:52,650 --> 00:49:57,960
example between 1 and 10 but you are

1262
00:49:55,020 --> 00:50:01,380
considering maybe decimals right you

1263
00:49:57,960 --> 00:50:10,290
will have infinite possibilities to use

1264
00:50:01,380 --> 00:50:11,790
for each value of your data so what what

1265
00:50:10,290 --> 00:50:14,460
kind of method can we use will quantity

1266
00:50:11,790 --> 00:50:17,910
quantity quantity of discrete values we

1267
00:50:14,460 --> 00:50:20,790
can also again we can we can perform a

1268
00:50:17,910 --> 00:50:23,490
master counting procedure and also

1269
00:50:20,790 --> 00:50:25,440
understand the frequency and because we

1270
00:50:23,490 --> 00:50:27,629
are using numbers in quantitative data

1271
00:50:25,440 --> 00:50:30,180
we can also calculate descriptive

1272
00:50:27,630 --> 00:50:33,540
statistics such as the average or the

1273
00:50:30,180 --> 00:50:35,460
minimum maximum value or the mode but in

1274
00:50:33,540 --> 00:50:39,660
this case if we see our data is related

1275
00:50:35,460 --> 00:50:43,490
to IP IP ports if we find the average of

1276
00:50:39,660 --> 00:50:45,180
several IP port numbers this data

1277
00:50:43,490 --> 00:50:49,439
doesn't make sense

1278
00:50:45,180 --> 00:50:52,950
right but if we see another example for

1279
00:50:49,440 --> 00:50:56,099
the values of bytes in or out from our

1280
00:50:52,950 --> 00:50:59,339
network data these values this is this

1281
00:50:56,099 --> 00:51:01,319
descriptive statistic now are going to

1282
00:50:59,339 --> 00:51:03,990
make sense for us for example what is

1283
00:51:01,319 --> 00:51:05,320
the mean what is the standard deviation

1284
00:51:03,990 --> 00:51:08,080
of the values

1285
00:51:05,320 --> 00:51:09,460
which is the maximum or the minimum so

1286
00:51:08,080 --> 00:51:12,700
the idea of a standard deviation here

1287
00:51:09,460 --> 00:51:15,640
for example is the standard deviation

1288
00:51:12,700 --> 00:51:18,220
give you an idea how similar are your

1289
00:51:15,640 --> 00:51:23,080
values of how distance argue values so

1290
00:51:18,220 --> 00:51:26,290
if we graph these values using our box a

1291
00:51:23,080 --> 00:51:32,680
box pull up graph we can identify if you

1292
00:51:26,290 --> 00:51:36,070
see on the on the Left most of the data

1293
00:51:32,680 --> 00:51:38,649
is on the left side that means that the

1294
00:51:36,070 --> 00:51:41,350
the number of bytes that are transferred

1295
00:51:38,650 --> 00:51:45,990
are between three bytes all the way to

1296
00:51:41,350 --> 00:51:48,520
maybe 125 bytes but you have values of

1297
00:51:45,990 --> 00:51:52,450
bytes that are transferred that really

1298
00:51:48,520 --> 00:51:54,610
be there on the right so using this box

1299
00:51:52,450 --> 00:51:57,520
Pro graph we can consider these these

1300
00:51:54,610 --> 00:51:59,710
values as an outliers and maybe we can

1301
00:51:57,520 --> 00:52:02,350
start from all the data we can after

1302
00:51:59,710 --> 00:52:05,830
applying our data analytic we can maybe

1303
00:52:02,350 --> 00:52:07,509
start focusing on this one yes so that

1304
00:52:05,830 --> 00:52:09,009
was very interesting because for example

1305
00:52:07,510 --> 00:52:10,870
when I was doing a couple of you know

1306
00:52:09,010 --> 00:52:13,210
different engagements you know most of

1307
00:52:10,870 --> 00:52:15,040
the queries or analytics that you come

1308
00:52:13,210 --> 00:52:17,980
up with are usually a rule where you

1309
00:52:15,040 --> 00:52:21,070
focus on if this is string with this

1310
00:52:17,980 --> 00:52:23,080
string does this then is malicious or

1311
00:52:21,070 --> 00:52:24,220
potentially malicious right and that

1312
00:52:23,080 --> 00:52:26,590
could be translated all the way to a

1313
00:52:24,220 --> 00:52:28,120
basic signature this concept right here

1314
00:52:26,590 --> 00:52:30,790
allows you to think about your detection

1315
00:52:28,120 --> 00:52:33,190
out with that kind of improving the way

1316
00:52:30,790 --> 00:52:35,230
how you look at data I've seen actually

1317
00:52:33,190 --> 00:52:39,430
analyst calculating the medium or the

1318
00:52:35,230 --> 00:52:41,620
average right of a port all right can

1319
00:52:39,430 --> 00:52:45,759
you do can you connect to a poor you

1320
00:52:41,620 --> 00:52:47,290
know 0.5 right you cannot do that so

1321
00:52:45,760 --> 00:52:49,150
that's why it's important to understand

1322
00:52:47,290 --> 00:52:51,430
that you cannot do certain things to

1323
00:52:49,150 --> 00:52:52,960
specific data types and this is so

1324
00:52:51,430 --> 00:52:54,879
important because this allows the

1325
00:52:52,960 --> 00:52:57,190
methodology not just to focus on basic

1326
00:52:54,880 --> 00:52:59,110
rules but the umpires start getting this

1327
00:52:57,190 --> 00:53:01,000
statistical way which is the basics also

1328
00:52:59,110 --> 00:53:03,640
to start getting into potential machine

1329
00:53:01,000 --> 00:53:06,340
learning models not every technique

1330
00:53:03,640 --> 00:53:09,339
detection will need a machine learning

1331
00:53:06,340 --> 00:53:11,380
model or a statistical analysis but this

1332
00:53:09,340 --> 00:53:14,110
is a way where you can now take the

1333
00:53:11,380 --> 00:53:16,240
other route if you cannot of course you

1334
00:53:14,110 --> 00:53:18,160
know detect it with your own basic rules

1335
00:53:16,240 --> 00:53:18,910
so the next step is going to be of

1336
00:53:18,160 --> 00:53:21,759
course document

1337
00:53:18,910 --> 00:53:24,129
and how we like to document the history

1338
00:53:21,760 --> 00:53:26,829
300 play books and there's a project

1339
00:53:24,130 --> 00:53:29,079
actually that we bolts also host a host

1340
00:53:26,829 --> 00:53:32,260
which allows you to put together a

1341
00:53:29,079 --> 00:53:33,609
couple of fields and you have to pretty

1342
00:53:32,260 --> 00:53:35,559
much document everything that you did

1343
00:53:33,609 --> 00:53:37,598
with these fields we can go all the way

1344
00:53:35,559 --> 00:53:39,069
to the title of the play book all the

1345
00:53:37,599 --> 00:53:41,109
way to the potential data model the

1346
00:53:39,069 --> 00:53:42,730
relevant data sources you know what you

1347
00:53:41,109 --> 00:53:44,319
do from a data analytics perspective do

1348
00:53:42,730 --> 00:53:46,210
you need a rule do you need any

1349
00:53:44,319 --> 00:53:47,740
statistical model you know what is it

1350
00:53:46,210 --> 00:53:49,990
that you need through your hole

1351
00:53:47,740 --> 00:53:51,578
detection capability now this can be of

1352
00:53:49,990 --> 00:53:53,169
course translated into a nice you know

1353
00:53:51,579 --> 00:53:54,970
either markdown whatever you want to do

1354
00:53:53,170 --> 00:53:58,599
and I'm gonna show you how these could

1355
00:53:54,970 --> 00:54:00,939
of course you know be put together in a

1356
00:53:58,599 --> 00:54:03,190
little bit so at the end we talked about

1357
00:54:00,940 --> 00:54:04,569
a whole methodology right and as you can

1358
00:54:03,190 --> 00:54:06,369
see even though it looked a little

1359
00:54:04,569 --> 00:54:07,720
high-level the beginning there is a lot

1360
00:54:06,369 --> 00:54:09,549
of steps that you have to do in the

1361
00:54:07,720 --> 00:54:12,609
middle which would allow you to be ready

1362
00:54:09,549 --> 00:54:14,859
to then be sure and say we created this

1363
00:54:12,609 --> 00:54:17,020
data analytic we look at the data

1364
00:54:14,859 --> 00:54:19,359
quality before we even went into

1365
00:54:17,020 --> 00:54:21,788
production so we are sure that if we do

1366
00:54:19,359 --> 00:54:23,500
not find anything in production I'm sure

1367
00:54:21,789 --> 00:54:25,510
that I pretty much was collecting the

1368
00:54:23,500 --> 00:54:28,990
right data so I can be a little bit more

1369
00:54:25,510 --> 00:54:31,029
sure that the attacker did not happen or

1370
00:54:28,990 --> 00:54:33,339
the adversary pretty much was using a

1371
00:54:31,029 --> 00:54:35,650
different variant i bypass my hypothesis

1372
00:54:33,339 --> 00:54:37,480
but that's why I have all the hypotheses

1373
00:54:35,650 --> 00:54:38,920
that I can create when I say that you

1374
00:54:37,480 --> 00:54:41,200
can do it yourself is because there is a

1375
00:54:38,920 --> 00:54:42,880
lot of projects that we host it's open

1376
00:54:41,200 --> 00:54:44,980
source right and as you can see we love

1377
00:54:42,880 --> 00:54:48,490
animals right and you know we love our

1378
00:54:44,980 --> 00:54:49,779
logos and we have the awesome project

1379
00:54:48,490 --> 00:54:51,520
the awesome project is going to focus a

1380
00:54:49,779 --> 00:54:54,220
lot in providing information data

1381
00:54:51,520 --> 00:54:56,970
dictionaries things that you can do with

1382
00:54:54,220 --> 00:54:58,689
your data documented data modeling a

1383
00:54:56,970 --> 00:55:01,660
specific documentation

1384
00:54:58,690 --> 00:55:03,520
I'm also standardization showing you a

1385
00:55:01,660 --> 00:55:05,170
basic common information model all that

1386
00:55:03,520 --> 00:55:07,240
is in awesome so if you want to learn

1387
00:55:05,170 --> 00:55:09,000
about that without doing the heavy work

1388
00:55:07,240 --> 00:55:12,279
I've already parsed I think at least

1389
00:55:09,000 --> 00:55:13,660
almost like you know 200 event IDs so

1390
00:55:12,279 --> 00:55:15,220
probably you can at least learn from

1391
00:55:13,660 --> 00:55:17,500
that and probably apply it to your own

1392
00:55:15,220 --> 00:55:19,899
company and it's very important to have

1393
00:55:17,500 --> 00:55:22,990
data wiki no idea how you know easy days

1394
00:55:19,900 --> 00:55:26,319
and useful for engagement we use help

1395
00:55:22,990 --> 00:55:28,419
which is our the analytic platform that

1396
00:55:26,319 --> 00:55:29,710
allows us to of course you know go to

1397
00:55:28,420 --> 00:55:31,510
the data in

1398
00:55:29,710 --> 00:55:34,089
and start analyzing it but he'll what it

1399
00:55:31,510 --> 00:55:36,849
has it also goes beyond the search bar

1400
00:55:34,089 --> 00:55:40,890
concept it gives you Jupiter notebooks

1401
00:55:36,849 --> 00:55:43,119
which allows you to do a more scientific

1402
00:55:40,890 --> 00:55:44,500
analysis of the data and of course

1403
00:55:43,119 --> 00:55:46,330
Jupiter notebooks are used by data

1404
00:55:44,500 --> 00:55:48,790
science is to perform their daily jobs

1405
00:55:46,330 --> 00:55:50,200
and the 300 playbook is another project

1406
00:55:48,790 --> 00:55:51,759
which is that love well you guys

1407
00:55:50,200 --> 00:55:53,259
actually the first people that are

1408
00:55:51,760 --> 00:55:57,310
seeing this new logo it's actually my

1409
00:55:53,260 --> 00:55:59,770
dog the passive way unfortunately but so

1410
00:55:57,310 --> 00:56:01,359
in memory that's the 300 playbook level

1411
00:55:59,770 --> 00:56:05,380
so the project that we're going to show

1412
00:56:01,359 --> 00:56:06,880
today is Mordor and the reason why is

1413
00:56:05,380 --> 00:56:08,770
because we're still missing and step

1414
00:56:06,880 --> 00:56:10,330
over there we're missing the step that a

1415
00:56:08,770 --> 00:56:12,460
lot of people say I don't know how to

1416
00:56:10,330 --> 00:56:14,200
you know replicate the attack I don't

1417
00:56:12,460 --> 00:56:15,690
have this skill so start running my own

1418
00:56:14,200 --> 00:56:19,029
commanding controls and things like that

1419
00:56:15,690 --> 00:56:20,859
we have more though which is of course a

1420
00:56:19,030 --> 00:56:24,250
tool that allows you to replay adversary

1421
00:56:20,859 --> 00:56:26,020
behavior and this of course from the

1422
00:56:24,250 --> 00:56:28,030
awesome films and books of the Lord of

1423
00:56:26,020 --> 00:56:30,009
the Rings I love that so I figure I'll

1424
00:56:28,030 --> 00:56:31,390
be good to have a mortar gate because

1425
00:56:30,010 --> 00:56:33,310
we're pretty much collecting malicious

1426
00:56:31,390 --> 00:56:36,580
activity so more lorries were you know

1427
00:56:33,310 --> 00:56:39,400
you know thus our own forces lived it

1428
00:56:36,580 --> 00:56:41,290
makes sense right so the reason why I

1429
00:56:39,400 --> 00:56:43,720
say this is because if you use one

1430
00:56:41,290 --> 00:56:45,580
specific atomic right team toolkit out

1431
00:56:43,720 --> 00:56:48,459
there which exists there are open source

1432
00:56:45,580 --> 00:56:49,720
and you execute this is sync at the

1433
00:56:48,460 --> 00:56:52,450
domain control level you're going to get

1434
00:56:49,720 --> 00:56:54,339
that look if you execute several

1435
00:56:52,450 --> 00:56:56,830
different you know Red Team toolkits and

1436
00:56:54,339 --> 00:56:58,240
you're going to get the same law if you

1437
00:56:56,830 --> 00:57:01,210
execute the PowerShell you're gonna get

1438
00:56:58,240 --> 00:57:02,549
the same log if you secure to.net but

1439
00:57:01,210 --> 00:57:05,650
Python you're gonna get the same law

1440
00:57:02,550 --> 00:57:07,000
right on the domain controller the main

1441
00:57:05,650 --> 00:57:09,700
behavior that I'm looking for it's gonna

1442
00:57:07,000 --> 00:57:11,440
be the same law I can use other

1443
00:57:09,700 --> 00:57:14,169
frameworks or probably you know mimic

1444
00:57:11,440 --> 00:57:18,310
ads to execute this is Inc it's gonna

1445
00:57:14,170 --> 00:57:19,960
generate the same law right so now you

1446
00:57:18,310 --> 00:57:21,700
know let's just pick one of the ways to

1447
00:57:19,960 --> 00:57:23,380
generate that data let's push it to

1448
00:57:21,700 --> 00:57:25,419
Mordor and that's the law go by the way

1449
00:57:23,380 --> 00:57:27,220
which is a is working progress so please

1450
00:57:25,420 --> 00:57:29,260
don't judge me by the logo which is a

1451
00:57:27,220 --> 00:57:30,848
work in progress actually the latest

1452
00:57:29,260 --> 00:57:32,020
send it to me two days ago and I was

1453
00:57:30,849 --> 00:57:34,420
like alright this is what I can work

1454
00:57:32,020 --> 00:57:36,190
with so that's fine anyways but this

1455
00:57:34,420 --> 00:57:38,619
mortar will pretty much restore that

1456
00:57:36,190 --> 00:57:40,390
data and give it to you directly there

1457
00:57:38,619 --> 00:57:41,950
is no need to be doing all this stuff on

1458
00:57:40,390 --> 00:57:43,180
the Left you can just have it directly

1459
00:57:41,950 --> 00:57:44,980
to you

1460
00:57:43,180 --> 00:57:47,109
right so that's model allows you to the

1461
00:57:44,980 --> 00:57:49,660
inquiry data and not just one event I'm

1462
00:57:47,109 --> 00:57:52,029
not just giving you 462 are giving you a

1463
00:57:49,660 --> 00:57:54,190
whole time window of events with several

1464
00:57:52,030 --> 00:57:57,010
events that go around this is think for

1465
00:57:54,190 --> 00:57:58,540
example context and you might ask

1466
00:57:57,010 --> 00:58:00,309
yourself how do I consume that right how

1467
00:57:58,540 --> 00:58:02,349
do I get that data from order and send

1468
00:58:00,309 --> 00:58:07,059
it to my elk stack or to my analytic

1469
00:58:02,349 --> 00:58:07,420
platform well I give you capita common

1470
00:58:07,059 --> 00:58:09,609
lines

1471
00:58:07,420 --> 00:58:11,829
Kafka is a tool that allows you to push

1472
00:58:09,609 --> 00:58:14,259
data as a producer to a Kafka

1473
00:58:11,829 --> 00:58:16,720
infrastructure Kafka is a publish in

1474
00:58:14,260 --> 00:58:18,339
subscribe infrastructure right you can

1475
00:58:16,720 --> 00:58:20,049
publish your data to Kafka and then you

1476
00:58:18,339 --> 00:58:22,089
can subscribe to the Kafka and improve

1477
00:58:20,050 --> 00:58:24,400
the data out with any other tool outside

1478
00:58:22,089 --> 00:58:26,200
Jupiter notebooks k sequel and things

1479
00:58:24,400 --> 00:58:28,930
like that so tough cacao allows you to

1480
00:58:26,200 --> 00:58:31,808
then pick one of the model files and

1481
00:58:28,930 --> 00:58:34,509
then replicate it back send it to Kafka

1482
00:58:31,809 --> 00:58:37,119
broker so you avoid a whole execution in

1483
00:58:34,510 --> 00:58:39,790
simulation and you pretty much can have

1484
00:58:37,119 --> 00:58:42,790
it as if it was being loaded in your

1485
00:58:39,790 --> 00:58:45,279
environment so you can see I'm loading a

1486
00:58:42,790 --> 00:58:47,349
whole series of events as if pretty much

1487
00:58:45,280 --> 00:58:49,569
happen so I'm simulating the the

1488
00:58:47,349 --> 00:58:51,730
specific attack but from a data

1489
00:58:49,569 --> 00:58:53,619
perspective I'm not worried about all

1490
00:58:51,730 --> 00:58:55,839
these other techniques once again I care

1491
00:58:53,619 --> 00:58:57,640
more about the main behavior if you do

1492
00:58:55,839 --> 00:58:59,078
it with PowerShell with.net or Python

1493
00:58:57,640 --> 00:59:00,609
good for you

1494
00:58:59,079 --> 00:59:03,160
right and I'll be awesome to have

1495
00:59:00,609 --> 00:59:05,140
different versions of the model file and

1496
00:59:03,160 --> 00:59:08,020
that's the next step I'm gonna have a

1497
00:59:05,140 --> 00:59:10,690
file from from PowerShell Empire a file

1498
00:59:08,020 --> 00:59:12,430
from covenant which uses that net and so

1499
00:59:10,690 --> 00:59:14,829
the way you can see that the main goal

1500
00:59:12,430 --> 00:59:16,899
the end goal of my detection will still

1501
00:59:14,829 --> 00:59:18,369
be the same but then you can help of the

1502
00:59:16,900 --> 00:59:20,829
context around different tools that

1503
00:59:18,369 --> 00:59:22,030
allow you to execute that attack and of

1504
00:59:20,829 --> 00:59:23,440
course now at the end you can do

1505
00:59:22,030 --> 00:59:24,700
yourself right because now you have all

1506
00:59:23,440 --> 00:59:27,549
the tools this is going to be released

1507
00:59:24,700 --> 00:59:31,240
tonight so keep an eye on that github

1508
00:59:27,549 --> 00:59:32,500
link over there so real quick I'm just

1509
00:59:31,240 --> 00:59:35,740
going to show you more in action because

1510
00:59:32,500 --> 00:59:38,099
we have two minutes so this is Mordor so

1511
00:59:35,740 --> 00:59:40,750
you can just go and you know download it

1512
00:59:38,099 --> 00:59:43,510
you you have the goals and everything

1513
00:59:40,750 --> 00:59:46,930
from Mordor each file as you can see in

1514
00:59:43,510 --> 00:59:48,880
here this is a DC sync file if you can

1515
00:59:46,930 --> 00:59:53,049
click on the DC sync come on click

1516
00:59:48,880 --> 00:59:54,190
Roberto man taking forever alright so we

1517
00:59:53,049 --> 00:59:56,049
click on that file then we get

1518
00:59:54,190 --> 00:59:57,010
information about this scene or get

1519
00:59:56,049 --> 00:59:59,560
information about

1520
00:59:57,010 --> 01:00:01,420
created it the data set the specific

1521
00:59:59,560 --> 01:00:03,790
Network environment when he happened

1522
01:00:01,420 --> 01:00:05,350
because if you ingest this data it's

1523
01:00:03,790 --> 01:00:07,210
gonna have a specific time window of

1524
01:00:05,350 --> 01:00:08,740
Stine stamps so you have to know where

1525
01:00:07,210 --> 01:00:12,100
it was taken so you can at least you

1526
01:00:08,740 --> 01:00:14,470
know adjust your tank query and then

1527
01:00:12,100 --> 01:00:18,190
from there I give you the specific event

1528
01:00:14,470 --> 01:00:21,040
ID no specific data categories and data

1529
01:00:18,190 --> 01:00:23,170
sources and how many records you get per

1530
01:00:21,040 --> 01:00:24,460
file but this very interesting because

1531
01:00:23,170 --> 01:00:26,170
now I'm giving you some basic

1532
01:00:24,460 --> 01:00:28,330
information so you can work with all

1533
01:00:26,170 --> 01:00:30,280
these files and you might you and you

1534
01:00:28,330 --> 01:00:32,680
might be able to come up with a new way

1535
01:00:30,280 --> 01:00:35,470
to query that data once okay I'm giving

1536
01:00:32,680 --> 01:00:37,000
you let's say this is seen for 662 but

1537
01:00:35,470 --> 01:00:39,040
if there is any other context I don't

1538
01:00:37,000 --> 01:00:40,810
missing you have the data to do your own

1539
01:00:39,040 --> 01:00:43,360
analysis and probably do so mystical

1540
01:00:40,810 --> 01:00:45,190
analysis well so you can see I'll show

1541
01:00:43,360 --> 01:00:47,320
you exactly how I executed it so that

1542
01:00:45,190 --> 01:00:49,240
way you know how I was able to do it so

1543
01:00:47,320 --> 01:00:51,310
you can learn as well if you want to do

1544
01:00:49,240 --> 01:00:53,830
it yourself and of course there are

1545
01:00:51,310 --> 01:00:57,610
results there's going to be a read the

1546
01:00:53,830 --> 01:00:59,560
docs document which you'll be able to

1547
01:00:57,610 --> 01:01:01,810
see exactly how the environment was

1548
01:00:59,560 --> 01:01:04,120
created and you know what it is the

1549
01:01:01,810 --> 01:01:05,549
endpoints and stuff like that and I'm

1550
01:01:04,120 --> 01:01:08,140
gonna show you how to consume the data

1551
01:01:05,550 --> 01:01:10,960
you can go to look after cut style and

1552
01:01:08,140 --> 01:01:11,500
you can learn exactly how to do it it's

1553
01:01:10,960 --> 01:01:13,150
very easy

1554
01:01:11,500 --> 01:01:17,770
we're gonna go straight to how to do it

1555
01:01:13,150 --> 01:01:19,600
I download the project model I already

1556
01:01:17,770 --> 01:01:22,300
have my elf stack which already gives

1557
01:01:19,600 --> 01:01:26,589
you a a to commands to create this

1558
01:01:22,300 --> 01:01:29,770
specific step and then I pick my file

1559
01:01:26,590 --> 01:01:31,570
and I decompress it and once I they

1560
01:01:29,770 --> 01:01:34,690
compress it then I can run this Cal Cal

1561
01:01:31,570 --> 01:01:37,780
Cal query B means the broker where I'm

1562
01:01:34,690 --> 01:01:40,510
sending the data t means the topic where

1563
01:01:37,780 --> 01:01:43,120
the data is gonna be sore ap means that

1564
01:01:40,510 --> 01:01:45,220
Kafka CAD is gonna be a producer it's

1565
01:01:43,120 --> 01:01:48,130
gonna send the data as if it was being

1566
01:01:45,220 --> 01:01:51,220
ingested in real time and of course I

1567
01:01:48,130 --> 01:01:53,080
point into the file so at the end I

1568
01:01:51,220 --> 01:01:55,810
could just go to my small datasets

1569
01:01:53,080 --> 01:01:59,860
windows all these data is categorized by

1570
01:01:55,810 --> 01:02:02,290
platform tactic and technique and then I

1571
01:01:59,860 --> 01:02:05,530
can choose as you can see there is

1572
01:02:02,290 --> 01:02:08,770
nothing in there but once I I send the

1573
01:02:05,530 --> 01:02:10,119
data we capture card I can automatically

1574
01:02:08,770 --> 01:02:11,859
start saying

1575
01:02:10,119 --> 01:02:15,670
this specific events over there in my

1576
01:02:11,859 --> 01:02:18,130
LTAC and if I run my query for this is

1577
01:02:15,670 --> 01:02:20,289
sink I can find this is sink in this

1578
01:02:18,130 --> 01:02:22,359
data set by looking for a specific

1579
01:02:20,289 --> 01:02:24,970
replication permission that gets created

1580
01:02:22,359 --> 01:02:26,740
for 4-6 6-2 so I just replicated the

1581
01:02:24,970 --> 01:02:36,788
data right away straight to the old

1582
01:02:26,740 --> 01:02:38,799
stack and thank you very much if you

1583
01:02:36,789 --> 01:02:40,869
have any questions I think we're out of

1584
01:02:38,799 --> 01:02:46,259
time right yeah if you have one of two

1585
01:02:40,869 --> 01:02:48,999
questions you are welcome of course hope

1586
01:02:46,259 --> 01:02:50,829
all right if we're going to be around

1587
01:02:48,999 --> 01:02:52,749
just in case you guys have any questions

1588
01:02:50,829 --> 01:02:54,730
we're gonna be around if you wanna talk

1589
01:02:52,749 --> 01:02:56,140
about data just let me know if you're

1590
01:02:54,730 --> 01:02:57,220
not talk about more or let me know as

1591
01:02:56,140 --> 01:02:58,779
well because I would like to play I have

1592
01:02:57,220 --> 01:03:00,399
some ideas or you might have some ideas

1593
01:02:58,779 --> 01:03:02,060
that I might not consider so thank you

1594
01:03:00,400 --> 01:03:06,320
very much appreciate it here thank you

1595
01:03:02,060 --> 01:03:06,320
[Applause]

