1
00:00:07,250 --> 00:00:10,619
[Music]

2
00:00:12,360 --> 00:00:18,039
so welcome to a dear blue team this is

3
00:00:15,219 --> 00:00:19,900
basically advice from someone with a

4
00:00:18,039 --> 00:00:22,750
forensics experience to help expedite

5
00:00:19,900 --> 00:00:24,009
your capabilities within D ferdi fi our

6
00:00:22,750 --> 00:00:26,529
forensics whatever you want to call it

7
00:00:24,009 --> 00:00:28,419
so before we get started the thoughts

8
00:00:26,529 --> 00:00:31,419
and opinions are mine and not those of

9
00:00:28,419 --> 00:00:33,060
IBM the reason I say this is because I'm

10
00:00:31,419 --> 00:00:36,280
a senior security architect at IBM

11
00:00:33,060 --> 00:00:38,170
outside of the forensics world

12
00:00:36,280 --> 00:00:40,300
I'm the 2017 der beek on social

13
00:00:38,170 --> 00:00:42,250
engineering capture the flag winner my

14
00:00:40,300 --> 00:00:43,779
team the password inspection agency got

15
00:00:42,250 --> 00:00:46,480
third place in last year's NOLA con

16
00:00:43,780 --> 00:00:47,019
ascent capture the flag I've got some

17
00:00:46,480 --> 00:00:49,269
certs

18
00:00:47,019 --> 00:00:50,559
I'm a regular Forbes contributor I'm

19
00:00:49,269 --> 00:00:51,969
currently under contract to write an

20
00:00:50,559 --> 00:00:55,089
assent and social engineering book with

21
00:00:51,969 --> 00:00:56,879
no starch press probably fourth quarter

22
00:00:55,090 --> 00:00:59,350
this year first quarter next year and

23
00:00:56,879 --> 00:01:01,059
I've started offering some ascent

24
00:00:59,350 --> 00:01:05,290
training via what I call ascent

25
00:01:01,059 --> 00:01:10,300
associates so why this topic and this

26
00:01:05,290 --> 00:01:13,390
talk basically in the process of going

27
00:01:10,300 --> 00:01:15,990
through sans forensics 508 the advanced

28
00:01:13,390 --> 00:01:20,619
IR forensics and threat hunting course

29
00:01:15,990 --> 00:01:21,100
which is G CFA I I was reflecting on

30
00:01:20,619 --> 00:01:24,159
things

31
00:01:21,100 --> 00:01:25,839
I apologize for sounding academic at

32
00:01:24,159 --> 00:01:29,350
least I didn't say I was a promoting

33
00:01:25,840 --> 00:01:31,329
synergy right but I was thinking about

34
00:01:29,350 --> 00:01:33,220
the things I had learned and I came to

35
00:01:31,329 --> 00:01:34,329
the conclusion that some of these things

36
00:01:33,220 --> 00:01:36,340
you don't have to wait until there's an

37
00:01:34,329 --> 00:01:37,779
incident to actually do them and if you

38
00:01:36,340 --> 00:01:40,719
do them in advance it's gonna make your

39
00:01:37,780 --> 00:01:43,119
life a lot easier and I specifically

40
00:01:40,719 --> 00:01:46,600
want to say that this is not threat

41
00:01:43,119 --> 00:01:48,189
hunting so that's in above itself we'll

42
00:01:46,600 --> 00:01:50,949
talk about thread hunting but this is

43
00:01:48,189 --> 00:01:53,169
not on that topic so basically this talk

44
00:01:50,950 --> 00:01:54,579
is the outcome of those thoughts so to

45
00:01:53,170 --> 00:01:55,960
get the baseline knowledge just to make

46
00:01:54,579 --> 00:01:59,500
sure that we have a level playing field

47
00:01:55,960 --> 00:02:02,439
what is D F IR this digital forensics

48
00:01:59,500 --> 00:02:04,000
and Incident Response often will

49
00:02:02,439 --> 00:02:06,850
actually confuse the terms Incident

50
00:02:04,000 --> 00:02:08,350
Response and incident handling Incident

51
00:02:06,850 --> 00:02:11,170
Response deals with all of the technical

52
00:02:08,350 --> 00:02:13,180
components and the incident handling it

53
00:02:11,170 --> 00:02:15,250
deals with it at a much broader level

54
00:02:13,180 --> 00:02:17,530
dealing with things such as planning and

55
00:02:15,250 --> 00:02:19,540
the communications and all that fun

56
00:02:17,530 --> 00:02:21,939
stuff and that sourced from saying

57
00:02:19,540 --> 00:02:25,209
Internet storm center so with the

58
00:02:21,939 --> 00:02:27,430
incident response process the majority

59
00:02:25,209 --> 00:02:31,239
of what we're going to do here is based

60
00:02:27,430 --> 00:02:34,180
on the preparation phase we'll do some

61
00:02:31,239 --> 00:02:35,950
stuff from lessons learned a little bit

62
00:02:34,180 --> 00:02:40,060
with recovery but the vast majority of

63
00:02:35,950 --> 00:02:42,488
this is in the preparation phase so this

64
00:02:40,060 --> 00:02:44,439
process is we commonly refer to as Pi

65
00:02:42,489 --> 00:02:47,349
curl so you have preparation

66
00:02:44,439 --> 00:02:50,828
identification containment eradication

67
00:02:47,349 --> 00:02:52,298
recovery and lessons learned so as we

68
00:02:50,829 --> 00:02:54,250
dive into this let's go ahead and talk

69
00:02:52,299 --> 00:02:55,959
about threat intelligence so we have

70
00:02:54,250 --> 00:02:58,720
threat intelligence and cyber threat

71
00:02:55,959 --> 00:03:00,730
intelligence if you're like me the word

72
00:02:58,720 --> 00:03:03,659
cyber just makes you makes your skin

73
00:03:00,730 --> 00:03:06,369
crawl but it's the term for it right now

74
00:03:03,659 --> 00:03:08,950
so basically a few questions associated

75
00:03:06,370 --> 00:03:11,650
with it you know where does this threat

76
00:03:08,950 --> 00:03:14,230
intelligence fit into our process well

77
00:03:11,650 --> 00:03:15,579
in this case with the process of this

78
00:03:14,230 --> 00:03:16,959
talk it's not really going to fit in

79
00:03:15,579 --> 00:03:19,840
much at all because we're not really too

80
00:03:16,959 --> 00:03:22,239
concerned with that initially within the

81
00:03:19,840 --> 00:03:24,220
D fear process it's actually going to

82
00:03:22,239 --> 00:03:26,530
help you identify your adversary in some

83
00:03:24,220 --> 00:03:28,478
cases or at least identify what you're

84
00:03:26,530 --> 00:03:31,870
up against in terms of what kind of

85
00:03:28,479 --> 00:03:34,959
malware in terms of the vectors used and

86
00:03:31,870 --> 00:03:36,639
all of that fun stuff because I mean

87
00:03:34,959 --> 00:03:38,500
we're humans we operate in patterns we

88
00:03:36,639 --> 00:03:39,970
we typically do the same thing we wake

89
00:03:38,500 --> 00:03:42,389
up around the same time every day

90
00:03:39,970 --> 00:03:45,519
we get out of bed we go brush our teeth

91
00:03:42,389 --> 00:03:48,040
hopefully put deodorant on I've been to

92
00:03:45,519 --> 00:03:49,840
Def Con so III know there's a lot of

93
00:03:48,040 --> 00:03:52,030
people who don't so if I ever start a

94
00:03:49,840 --> 00:03:56,049
company my company swag is going to be

95
00:03:52,030 --> 00:03:59,049
deodorant you heard it here first but

96
00:03:56,049 --> 00:04:00,699
anyway we do that and then we get

97
00:03:59,049 --> 00:04:02,859
dressed or we hop in the shower and I

98
00:04:00,699 --> 00:04:04,959
mean we all we do things differently but

99
00:04:02,859 --> 00:04:07,090
we all do it in a similar pattern

100
00:04:04,959 --> 00:04:09,819
basically the threat intelligence is

101
00:04:07,090 --> 00:04:11,500
taking into account that pattern so we

102
00:04:09,819 --> 00:04:13,869
have indicators have compromised that

103
00:04:11,500 --> 00:04:15,489
that is nothing more than a technical

104
00:04:13,870 --> 00:04:18,759
pieces that go with that that's going to

105
00:04:15,489 --> 00:04:21,759
be your mutexes your regular expressions

106
00:04:18,759 --> 00:04:25,139
any hashes or IP addresses or domains or

107
00:04:21,759 --> 00:04:27,400
email addresses associated with it true

108
00:04:25,139 --> 00:04:29,580
threat intelligence that's actually

109
00:04:27,400 --> 00:04:32,169
actionable will take into account that

110
00:04:29,580 --> 00:04:33,400
tactics techniques and procedures the

111
00:04:32,169 --> 00:04:36,039
TTP's

112
00:04:33,400 --> 00:04:38,469
the adversary so within that that's

113
00:04:36,040 --> 00:04:42,389
taking it a step further so moving

114
00:04:38,470 --> 00:04:47,830
forward is d fear and CTI the same thing

115
00:04:42,389 --> 00:04:51,520
know which came first the chicken or the

116
00:04:47,830 --> 00:04:54,969
egg the D fear or the CTI the answer to

117
00:04:51,520 --> 00:04:57,099
that is yes because sometimes if it's a

118
00:04:54,970 --> 00:04:59,050
known adversary the threat intelligence

119
00:04:57,100 --> 00:05:01,180
triggers the response through your sim

120
00:04:59,050 --> 00:05:02,949
or whatever and then you go through your

121
00:05:01,180 --> 00:05:05,110
forensics process in some cases

122
00:05:02,949 --> 00:05:07,060
especially if you're in certain sectors

123
00:05:05,110 --> 00:05:08,800
you will actually be on the bleeding

124
00:05:07,060 --> 00:05:10,120
edge and you will produce threat

125
00:05:08,800 --> 00:05:13,030
intelligence that no one else has seen

126
00:05:10,120 --> 00:05:15,960
before I like to refer to that kind of

127
00:05:13,030 --> 00:05:19,599
as the arms race so you have your major

128
00:05:15,960 --> 00:05:20,888
firms and companies that are always

129
00:05:19,600 --> 00:05:22,720
trying to be the first to get the

130
00:05:20,889 --> 00:05:24,220
intelligence so they've got all their

131
00:05:22,720 --> 00:05:27,070
listeners out on the dark web they've

132
00:05:24,220 --> 00:05:29,650
got all their honey pots all that fun

133
00:05:27,070 --> 00:05:34,570
stuff and they want to be first to drop

134
00:05:29,650 --> 00:05:37,330
it so in that case it's all a matter of

135
00:05:34,570 --> 00:05:40,450
who did it first so when we talk about

136
00:05:37,330 --> 00:05:41,889
types of forensics whenever I took this

137
00:05:40,450 --> 00:05:43,479
course the only types of forensics I

138
00:05:41,889 --> 00:05:45,370
haven't really thought about was network

139
00:05:43,479 --> 00:05:47,169
forensics and file system forensics I

140
00:05:45,370 --> 00:05:49,780
didn't even think about memory forensics

141
00:05:47,169 --> 00:05:51,219
so with that there are some tools you

142
00:05:49,780 --> 00:05:53,380
can use with this and I'm a huge fan of

143
00:05:51,220 --> 00:05:55,930
like not talking about tools that are

144
00:05:53,380 --> 00:05:57,610
expensive or even for the most part I

145
00:05:55,930 --> 00:05:59,770
don't try to talk about only free tools

146
00:05:57,610 --> 00:06:01,599
especially when I'm talking about social

147
00:05:59,770 --> 00:06:03,930
engineering or ascent so with this

148
00:06:01,599 --> 00:06:07,050
there's still a lot of things that are

149
00:06:03,930 --> 00:06:09,700
free that you can use so sleuth kit

150
00:06:07,050 --> 00:06:11,710
autopsy autopsy is nothing more than a

151
00:06:09,700 --> 00:06:14,169
gooey wrapper of sleuth kit you've got

152
00:06:11,710 --> 00:06:16,479
scalpel and foremost which basically

153
00:06:14,169 --> 00:06:18,669
help you with file carving volatility

154
00:06:16,479 --> 00:06:19,810
can do some stuff with it but not too

155
00:06:18,669 --> 00:06:21,219
terribly much that's not where you're

156
00:06:19,810 --> 00:06:25,389
going to get the horsepower from it and

157
00:06:21,220 --> 00:06:28,060
then ftk there is ftk paid and ftk

158
00:06:25,389 --> 00:06:30,849
imager light within the networking side

159
00:06:28,060 --> 00:06:32,080
your big one is Wireshark I don't know

160
00:06:30,849 --> 00:06:33,870
if you can see the sticker but I've got

161
00:06:32,080 --> 00:06:36,460
a sticker on my laptop now that's

162
00:06:33,870 --> 00:06:40,479
Wireshark to do to do to do with the

163
00:06:36,460 --> 00:06:43,090
whole baby shark thing but you also have

164
00:06:40,479 --> 00:06:44,650
things like NetFlow your IDs is going to

165
00:06:43,090 --> 00:06:46,369
help you with that and something I'm a

166
00:06:44,650 --> 00:06:49,640
huge fan of and that's network

167
00:06:46,370 --> 00:06:53,720
so within the memory forensics world

168
00:06:49,640 --> 00:06:55,640
yeah volatility redline recall which

169
00:06:53,720 --> 00:06:57,830
basically is a fork of volatility that's

170
00:06:55,640 --> 00:07:00,860
now maintained by Google and an ftk

171
00:06:57,830 --> 00:07:03,560
imager in terms of the operating systems

172
00:07:00,860 --> 00:07:06,550
your big ones are going to be sift and

173
00:07:03,560 --> 00:07:09,220
rim knucks there are others out there

174
00:07:06,550 --> 00:07:11,300
such as cane the computer-aided

175
00:07:09,220 --> 00:07:13,130
investigative network environment I

176
00:07:11,300 --> 00:07:15,470
don't think it's maintained anymore but

177
00:07:13,130 --> 00:07:16,760
it is still there there's a couple

178
00:07:15,470 --> 00:07:20,030
others that I'm just not familiar with

179
00:07:16,760 --> 00:07:23,090
and then to a limited capacity yes Cali

180
00:07:20,030 --> 00:07:26,539
can do it I don't necessarily know that

181
00:07:23,090 --> 00:07:28,549
I would recommend that but I have

182
00:07:26,540 --> 00:07:29,960
another talk that's called social for

183
00:07:28,550 --> 00:07:32,600
indication where actually weaponized

184
00:07:29,960 --> 00:07:35,450
digital forensics so in that case I

185
00:07:32,600 --> 00:07:37,880
break in as a social engineer I steal a

186
00:07:35,450 --> 00:07:41,120
memory image and walk out the door and I

187
00:07:37,880 --> 00:07:43,250
use volatility so it is in Cali but I've

188
00:07:41,120 --> 00:07:46,310
done a side-by-side comparison of the

189
00:07:43,250 --> 00:07:50,240
built in modules and Cali just doesn't

190
00:07:46,310 --> 00:07:53,600
have quite the same verbosity and

191
00:07:50,240 --> 00:07:56,510
robustness that SIF does so I would say

192
00:07:53,600 --> 00:07:58,400
you sift for that so in terms of thread

193
00:07:56,510 --> 00:08:00,890
hunting we have our tools and techniques

194
00:07:58,400 --> 00:08:04,340
our benefits and the maturity so in

195
00:08:00,890 --> 00:08:06,590
terms of tools and techniques I'm gonna

196
00:08:04,340 --> 00:08:10,609
say something that's probably gonna be a

197
00:08:06,590 --> 00:08:11,659
major surprise or probably not the tools

198
00:08:10,610 --> 00:08:13,550
and techniques you're going to use for

199
00:08:11,660 --> 00:08:14,900
thread hunting basically are the same

200
00:08:13,550 --> 00:08:17,450
that you're going to use for a forensics

201
00:08:14,900 --> 00:08:18,830
investigation after the fact you're

202
00:08:17,450 --> 00:08:20,060
going to use your sim you're going to

203
00:08:18,830 --> 00:08:21,440
use the tools you're going to test for

204
00:08:20,060 --> 00:08:25,700
certain things you're going to see what

205
00:08:21,440 --> 00:08:27,590
what outcomes come from this in terms of

206
00:08:25,700 --> 00:08:30,229
doing thread hunting that's going to be

207
00:08:27,590 --> 00:08:33,319
forensics before the incident whereas

208
00:08:30,230 --> 00:08:37,039
regular D fair deals with forensics

209
00:08:33,320 --> 00:08:38,900
after the event in terms of the benefits

210
00:08:37,039 --> 00:08:43,189
of it it can certainly slice your

211
00:08:38,900 --> 00:08:44,420
incident response time in pretty

212
00:08:43,190 --> 00:08:46,310
dramatically I don't wanna say in half

213
00:08:44,420 --> 00:08:49,310
it varies from organization to

214
00:08:46,310 --> 00:08:51,589
organization but it'll actually help you

215
00:08:49,310 --> 00:08:53,989
expedite that and it will actually cut

216
00:08:51,590 --> 00:08:56,150
down on actual true incidents so that's

217
00:08:53,990 --> 00:08:57,500
something to keep in mind but the big

218
00:08:56,150 --> 00:08:59,180
key with this and the reason why I'm not

219
00:08:57,500 --> 00:08:59,810
advocating heavily for thread hunting is

220
00:08:59,180 --> 00:09:01,550
there's

221
00:08:59,810 --> 00:09:04,040
level of maturity associated with it

222
00:09:01,550 --> 00:09:05,689
threat hunting is all based on finding

223
00:09:04,040 --> 00:09:06,939
the deviations from what is considered

224
00:09:05,690 --> 00:09:09,290
normal

225
00:09:06,940 --> 00:09:11,600
having been a consultant in the past I

226
00:09:09,290 --> 00:09:14,300
think it would be very hard to go in on

227
00:09:11,600 --> 00:09:16,160
a say 40 hour engagement and truly

228
00:09:14,300 --> 00:09:18,199
understand what is considered normal in

229
00:09:16,160 --> 00:09:20,000
that environment so that you could find

230
00:09:18,200 --> 00:09:21,680
the Delta sure you could go in with some

231
00:09:20,000 --> 00:09:24,380
indicators of compromise and find a few

232
00:09:21,680 --> 00:09:26,420
things but at the same time you're not

233
00:09:24,380 --> 00:09:28,550
gonna find it quite as much because you

234
00:09:26,420 --> 00:09:30,890
you don't know they may have a job that

235
00:09:28,550 --> 00:09:32,660
runs on the 13th of every month that

236
00:09:30,890 --> 00:09:34,970
spikes their network traffic through the

237
00:09:32,660 --> 00:09:36,800
roof if they don't tell you or you're

238
00:09:34,970 --> 00:09:38,120
not aware of that you're gonna waste 40

239
00:09:36,800 --> 00:09:40,880
hours investigating why they have a

240
00:09:38,120 --> 00:09:41,990
network spike on the 13th of every month

241
00:09:40,880 --> 00:09:44,060
you're probably going to try to

242
00:09:41,990 --> 00:09:47,690
quarantine that software as malicious

243
00:09:44,060 --> 00:09:49,640
until you find out otherwise so I always

244
00:09:47,690 --> 00:09:53,720
advocate doing that on an internal team

245
00:09:49,640 --> 00:09:57,050
not having an external entity do it so

246
00:09:53,720 --> 00:09:58,910
doing the comparisons with dafair there

247
00:09:57,050 --> 00:10:01,069
are a few prerequisites typically the

248
00:09:58,910 --> 00:10:05,060
prerequisite to do d-- fear is to have

249
00:10:01,070 --> 00:10:07,850
an adverse event that would become the

250
00:10:05,060 --> 00:10:11,420
incident to respond to it's reactive in

251
00:10:07,850 --> 00:10:13,880
nature in the US Jason Street makes a

252
00:10:11,420 --> 00:10:16,699
joke that Brian Krebs should not be your

253
00:10:13,880 --> 00:10:17,810
intrusion detection system the FBI

254
00:10:16,700 --> 00:10:20,630
should not be your intrusion detection

255
00:10:17,810 --> 00:10:22,250
system but typically organizations are

256
00:10:20,630 --> 00:10:23,780
that's how they find out Brian Krebs

257
00:10:22,250 --> 00:10:24,890
contacts them says hey I'm about to

258
00:10:23,780 --> 00:10:27,500
write an article about you what do you

259
00:10:24,890 --> 00:10:31,400
have to say about yourself or the FBI

260
00:10:27,500 --> 00:10:33,800
knocks on your door hey by the way but

261
00:10:31,400 --> 00:10:35,630
anyway with regards to the actual

262
00:10:33,800 --> 00:10:38,599
traditional D fare process you're trying

263
00:10:35,630 --> 00:10:40,850
to restore operations as quickly as

264
00:10:38,600 --> 00:10:42,740
possible so you're not going to have the

265
00:10:40,850 --> 00:10:46,459
time to really sit down and do the

266
00:10:42,740 --> 00:10:48,650
analysis on the fly you're going to have

267
00:10:46,459 --> 00:10:50,239
to get images make backups do whatever

268
00:10:48,650 --> 00:10:52,040
you need to do so that you can get this

269
00:10:50,240 --> 00:10:53,630
back up and running management may say

270
00:10:52,040 --> 00:10:56,360
that you don't even have time to like

271
00:10:53,630 --> 00:10:58,880
make clothes just restore from good

272
00:10:56,360 --> 00:11:04,130
clean media and call it good that may be

273
00:10:58,880 --> 00:11:05,630
the case with thread hunting everything

274
00:11:04,130 --> 00:11:08,570
deals with maturity size and

275
00:11:05,630 --> 00:11:12,620
capabilities if you do not have probably

276
00:11:08,570 --> 00:11:13,050
I would say 13 or 14 of the Center for

277
00:11:12,620 --> 00:11:14,430
Internet

278
00:11:13,050 --> 00:11:16,319
security-critical security controls

279
00:11:14,430 --> 00:11:18,569
formerly known as the sans top 20 if you

280
00:11:16,320 --> 00:11:20,990
don't have 13 to 14 of those chances are

281
00:11:18,570 --> 00:11:23,790
this is not for you if you don't have a

282
00:11:20,990 --> 00:11:26,100
robust incident response process already

283
00:11:23,790 --> 00:11:30,510
and a dedicated team it's not for you

284
00:11:26,100 --> 00:11:31,680
it's proactive in nature it's based

285
00:11:30,510 --> 00:11:33,209
around what's normal it's going to

286
00:11:31,680 --> 00:11:35,790
consume that threat intelligence and try

287
00:11:33,209 --> 00:11:37,170
to find those anomalies and within

288
00:11:35,790 --> 00:11:39,599
reason it's not based on a time

289
00:11:37,170 --> 00:11:41,519
objective where as Incident Response the

290
00:11:39,600 --> 00:11:44,519
time objective is get this fixed to get

291
00:11:41,519 --> 00:11:46,350
it up fast and that's that final bullet

292
00:11:44,519 --> 00:11:48,540
on the threat hunting side is the exact

293
00:11:46,350 --> 00:11:50,010
reason why I'm not an advocate for

294
00:11:48,540 --> 00:11:53,610
external entities coming in and doing

295
00:11:50,010 --> 00:11:55,200
threat hunting so here we have our

296
00:11:53,610 --> 00:11:57,450
standard D fair talk and this pretty

297
00:11:55,200 --> 00:11:59,399
much is the the end of the standard

298
00:11:57,450 --> 00:12:02,430
default before we actually catch the

299
00:11:59,399 --> 00:12:04,410
true deer Blue team stuff so everything

300
00:12:02,430 --> 00:12:06,239
we hear you should be doing logging you

301
00:12:04,410 --> 00:12:09,209
should do it verbose you should send

302
00:12:06,240 --> 00:12:11,640
remote logs somewhere preferably to

303
00:12:09,209 --> 00:12:14,040
another host whether it be another host

304
00:12:11,640 --> 00:12:15,569
within your own architecture or another

305
00:12:14,040 --> 00:12:18,540
host that belongs to someone else via

306
00:12:15,570 --> 00:12:19,890
the cloud they can make you or break you

307
00:12:18,540 --> 00:12:21,449
if you don't have the logs you have

308
00:12:19,890 --> 00:12:23,550
nothing to bounce it off of you're going

309
00:12:21,450 --> 00:12:26,670
to have to create your own logs so

310
00:12:23,550 --> 00:12:28,290
within that inventory everything that's

311
00:12:26,670 --> 00:12:30,060
number one and number two on the

312
00:12:28,290 --> 00:12:32,939
critical security controls have an

313
00:12:30,060 --> 00:12:36,060
inventory of authorized and unauthorized

314
00:12:32,940 --> 00:12:37,649
hardware and software if you don't know

315
00:12:36,060 --> 00:12:38,279
what's on your network how can you

316
00:12:37,649 --> 00:12:40,380
defend it

317
00:12:38,279 --> 00:12:41,399
how can you monitor how can you know if

318
00:12:40,380 --> 00:12:46,410
it's something you actually need to

319
00:12:41,399 --> 00:12:47,730
respond to there's a powerful tool

320
00:12:46,410 --> 00:12:49,800
called console that will actually help

321
00:12:47,730 --> 00:12:51,300
you with that in the Windows environment

322
00:12:49,800 --> 00:12:52,920
there are a few things in the Linux side

323
00:12:51,300 --> 00:12:53,219
I'm just not familiar with them at this

324
00:12:52,920 --> 00:12:56,329
time

325
00:12:53,220 --> 00:12:58,560
but concept basically will use WMI and

326
00:12:56,329 --> 00:13:03,149
interrogate your hosts and collect all

327
00:12:58,560 --> 00:13:05,880
the data put it at a nice little pretty

328
00:13:03,149 --> 00:13:09,329
format and you'll be on your way but

329
00:13:05,880 --> 00:13:11,730
even with that inventory you know it's

330
00:13:09,329 --> 00:13:14,160
like in the US we there's a commercial

331
00:13:11,730 --> 00:13:16,199
that comes on TV all the time and this

332
00:13:14,160 --> 00:13:18,569
woman has had her credit score tattooed

333
00:13:16,199 --> 00:13:22,020
on her arm and she said oh I can get a

334
00:13:18,570 --> 00:13:24,360
proof for that because I'm a 789 not

335
00:13:22,020 --> 00:13:26,699
factoring in that it changes so

336
00:13:24,360 --> 00:13:28,110
inventory once a year

337
00:13:26,700 --> 00:13:29,880
around the time you have to do whatever

338
00:13:28,110 --> 00:13:32,910
you need to do for regulatory compliance

339
00:13:29,880 --> 00:13:34,650
that's not an inventory that's that's a

340
00:13:32,910 --> 00:13:36,360
single inventory you don't have an

341
00:13:34,650 --> 00:13:38,400
inventory program so you should do it

342
00:13:36,360 --> 00:13:40,380
frequently if you use a vulnerability

343
00:13:38,400 --> 00:13:42,270
scanner you could actually do discovery

344
00:13:40,380 --> 00:13:44,760
scans with that it doesn't take anything

345
00:13:42,270 --> 00:13:46,890
more than a pink sweep really you could

346
00:13:44,760 --> 00:13:48,870
go a little bit further and identify the

347
00:13:46,890 --> 00:13:51,600
operating system the hostname maybe if

348
00:13:48,870 --> 00:13:53,100
you want to go that far but you need to

349
00:13:51,600 --> 00:13:55,080
know what's there and then have some

350
00:13:53,100 --> 00:13:57,930
sort of network time if you're in the

351
00:13:55,080 --> 00:13:59,670
same time zone like I'm not familiar

352
00:13:57,930 --> 00:14:03,329
with the time zone here everything in

353
00:13:59,670 --> 00:14:04,829
Switzerland is in CET correct okay so

354
00:14:03,330 --> 00:14:07,080
within that case if you operate

355
00:14:04,830 --> 00:14:11,070
exclusively in Switzerland you could use

356
00:14:07,080 --> 00:14:13,740
CET or GMT it doesn't matter but if you

357
00:14:11,070 --> 00:14:17,520
open up an office in say Los Angeles or

358
00:14:13,740 --> 00:14:18,900
Rio you need to have some sort of time

359
00:14:17,520 --> 00:14:20,670
sync and that's it

360
00:14:18,900 --> 00:14:22,740
one of the cases where your logs may you

361
00:14:20,670 --> 00:14:23,699
might want to put your logs into GMT you

362
00:14:22,740 --> 00:14:24,930
don't want to be in the middle of an

363
00:14:23,700 --> 00:14:26,220
incident counting on your fingers and

364
00:14:24,930 --> 00:14:28,469
your toes to figure out what the time

365
00:14:26,220 --> 00:14:31,170
difference is between here and there or

366
00:14:28,470 --> 00:14:34,890
wherever it happened so something like

367
00:14:31,170 --> 00:14:37,290
NTP you can't go wrong with UTC UTC and

368
00:14:34,890 --> 00:14:38,910
GMT same thing baselines we'll talk more

369
00:14:37,290 --> 00:14:41,910
about that that's going to be some meat

370
00:14:38,910 --> 00:14:44,550
and potatoes of this so the softest the

371
00:14:41,910 --> 00:14:46,800
soft ish skills you need to know who to

372
00:14:44,550 --> 00:14:49,410
notify how to notify them and when to

373
00:14:46,800 --> 00:14:52,290
notify them I tell people through my

374
00:14:49,410 --> 00:14:54,240
awareness training that whenever you're

375
00:14:52,290 --> 00:14:55,500
actually when you think something's

376
00:14:54,240 --> 00:14:57,390
wrong and you need to notify the

377
00:14:55,500 --> 00:14:59,340
security team you need to know how to do

378
00:14:57,390 --> 00:15:00,840
it if you've clicked on a fish there's a

379
00:14:59,340 --> 00:15:02,910
good chance that sending it a

380
00:15:00,840 --> 00:15:05,550
notification to the appropriate party

381
00:15:02,910 --> 00:15:07,290
via email is the wrong answer because if

382
00:15:05,550 --> 00:15:08,609
you've clicked a fish there's a good

383
00:15:07,290 --> 00:15:10,230
chance that your email is now

384
00:15:08,610 --> 00:15:12,960
compromised depending on what the fish

385
00:15:10,230 --> 00:15:15,210
is trying to do so something to that

386
00:15:12,960 --> 00:15:19,380
effect you might want to use smoke

387
00:15:15,210 --> 00:15:21,720
signals carrier pigeons text signal

388
00:15:19,380 --> 00:15:23,220
whatsapp anything along those lines or

389
00:15:21,720 --> 00:15:25,470
if you're in the same office just walk

390
00:15:23,220 --> 00:15:27,750
over face to face but you need to define

391
00:15:25,470 --> 00:15:28,710
this and I can't tell you the right

392
00:15:27,750 --> 00:15:34,170
answer because I don't know your

393
00:15:28,710 --> 00:15:35,580
organization if you if you are keen in

394
00:15:34,170 --> 00:15:37,319
Morse code you could do that as well

395
00:15:35,580 --> 00:15:39,030
there's so many different ways you don't

396
00:15:37,320 --> 00:15:41,160
have to do it a conventional way you

397
00:15:39,030 --> 00:15:44,459
could just set up a hotline and say hey

398
00:15:41,160 --> 00:15:46,920
if you have a problem call security

399
00:15:44,460 --> 00:15:49,680
here's the number like in the US

400
00:15:46,920 --> 00:15:51,120
military when I was active duty next to

401
00:15:49,680 --> 00:15:54,120
every single phone we had a thing called

402
00:15:51,120 --> 00:15:56,040
the bomb threat worksheet it was nothing

403
00:15:54,120 --> 00:15:57,510
but a list of questions that if you

404
00:15:56,040 --> 00:15:59,189
answer the phone and there are someone

405
00:15:57,510 --> 00:16:00,510
calling it a bomb threat it's a list of

406
00:15:59,190 --> 00:16:01,740
questions that you're supposed to ask

407
00:16:00,510 --> 00:16:04,020
the person on the other end of the phone

408
00:16:01,740 --> 00:16:06,060
why are you doing this who are you

409
00:16:04,020 --> 00:16:07,230
what's going to trigger it is there any

410
00:16:06,060 --> 00:16:08,760
way I can talk you out of it and you're

411
00:16:07,230 --> 00:16:10,290
supposed to talk this person in circles

412
00:16:08,760 --> 00:16:12,470
until you get all the answers and then

413
00:16:10,290 --> 00:16:14,910
continue while notifying someone else

414
00:16:12,470 --> 00:16:17,850
why are we not doing this for the

415
00:16:14,910 --> 00:16:18,930
forensics perspective you don't have to

416
00:16:17,850 --> 00:16:20,910
call it a bomb threat worksheet you

417
00:16:18,930 --> 00:16:23,010
could call it a I don't know an incident

418
00:16:20,910 --> 00:16:26,100
response worksheet that would probably

419
00:16:23,010 --> 00:16:27,420
be highly appropriate and basically the

420
00:16:26,100 --> 00:16:28,860
questions you might want to ask for this

421
00:16:27,420 --> 00:16:30,599
would be what were you doing when this

422
00:16:28,860 --> 00:16:33,240
happened were you doing anything

423
00:16:30,600 --> 00:16:35,670
if you were on a website what website

424
00:16:33,240 --> 00:16:38,690
list the exact URL did you click

425
00:16:35,670 --> 00:16:41,610
anything was this via email who sent it

426
00:16:38,690 --> 00:16:44,190
these are all things that as forensic

427
00:16:41,610 --> 00:16:45,960
investigators we need to know and if

428
00:16:44,190 --> 00:16:48,840
someone can tell us this instead of us

429
00:16:45,960 --> 00:16:51,600
having to go synthesize the whole file

430
00:16:48,840 --> 00:16:54,030
system through sleuth kit run the play

431
00:16:51,600 --> 00:16:55,770
so dump scripts against it and then drop

432
00:16:54,030 --> 00:17:00,060
it in a timeline so that we can go and

433
00:16:55,770 --> 00:17:01,949
hopefully find the email header if they

434
00:17:00,060 --> 00:17:05,849
can just tell us think of how much time

435
00:17:01,950 --> 00:17:07,560
that saves and at that point you've got

436
00:17:05,849 --> 00:17:10,319
to really work with your user base

437
00:17:07,560 --> 00:17:11,639
because too often security people we

438
00:17:10,319 --> 00:17:14,250
tend to want to beat people over the

439
00:17:11,640 --> 00:17:15,959
head and like there's people in industry

440
00:17:14,250 --> 00:17:18,569
now that are so quick to say users are

441
00:17:15,959 --> 00:17:20,910
dumb you're dumb dumb dumb and I mean

442
00:17:18,569 --> 00:17:23,369
let's face it they're are dumb users but

443
00:17:20,910 --> 00:17:25,440
the vast majority are not dumb they're

444
00:17:23,369 --> 00:17:27,989
just not informed they're not trained

445
00:17:25,440 --> 00:17:30,150
and I actually put the burden more on us

446
00:17:27,990 --> 00:17:32,310
as security professionals because a it

447
00:17:30,150 --> 00:17:33,680
is our job to build or bust systems that

448
00:17:32,310 --> 00:17:35,310
protect the user as much as possible

449
00:17:33,680 --> 00:17:38,280
understanding that we cannot fully

450
00:17:35,310 --> 00:17:39,929
protect them from everything and then

451
00:17:38,280 --> 00:17:41,910
for instances when we can't fully

452
00:17:39,930 --> 00:17:45,960
protect them train them to the extent

453
00:17:41,910 --> 00:17:48,600
possible to be able to help protect

454
00:17:45,960 --> 00:17:51,150
themselves protect the company and

455
00:17:48,600 --> 00:17:52,919
report when it doesn't add up

456
00:17:51,150 --> 00:17:54,330
and

457
00:17:52,920 --> 00:17:56,880
just like availability there's no such

458
00:17:54,330 --> 00:18:01,320
thing as 100% availability we hear a lot

459
00:17:56,880 --> 00:18:02,430
about five 9s right 99.999% that's what

460
00:18:01,320 --> 00:18:04,139
you're striving to get towards you're

461
00:18:02,430 --> 00:18:07,920
trying to add an extra nine to the end

462
00:18:04,140 --> 00:18:10,500
of that with the efficiency and security

463
00:18:07,920 --> 00:18:13,680
of your system but it's a multi-pronged

464
00:18:10,500 --> 00:18:15,900
approach so you want to you want to be

465
00:18:13,680 --> 00:18:18,810
able to tell users within this worksheet

466
00:18:15,900 --> 00:18:20,550
the actions to take do you want them to

467
00:18:18,810 --> 00:18:22,800
shut the system down that could

468
00:18:20,550 --> 00:18:23,730
compromise your memory forensics do you

469
00:18:22,800 --> 00:18:26,580
want them to send it into hibernation

470
00:18:23,730 --> 00:18:28,890
mode that can be really good for you do

471
00:18:26,580 --> 00:18:31,110
you want them to log out lock the screen

472
00:18:28,890 --> 00:18:33,570
do nothing unplug it from the network

473
00:18:31,110 --> 00:18:35,310
unplug it from the wall these are all

474
00:18:33,570 --> 00:18:37,439
things that you could do I think of

475
00:18:35,310 --> 00:18:39,570
things from the perspective of I'm on

476
00:18:37,440 --> 00:18:41,730
the phone talking to my 60 year old

477
00:18:39,570 --> 00:18:44,520
mother and I'm trying to convince her to

478
00:18:41,730 --> 00:18:47,070
do something if I say hey on your

479
00:18:44,520 --> 00:18:49,250
desktop unplug the network cable every

480
00:18:47,070 --> 00:18:52,439
single cable is going to get unplugged

481
00:18:49,250 --> 00:18:56,280
she's tech illiterate I mean that's just

482
00:18:52,440 --> 00:18:58,320
the way it is but if I if I use a

483
00:18:56,280 --> 00:19:00,810
specific color network Kay will say

484
00:18:58,320 --> 00:19:03,659
yellow and I say hey if something

485
00:19:00,810 --> 00:19:05,190
happens unplug that yellow cable she can

486
00:19:03,660 --> 00:19:06,660
do that I'm not saying that everybody

487
00:19:05,190 --> 00:19:09,290
needs to go off and buy yellow cat5e

488
00:19:06,660 --> 00:19:13,440
cat6 but if you can use the same color

489
00:19:09,290 --> 00:19:17,100
uniformly or a series of colors anything

490
00:19:13,440 --> 00:19:23,340
but black or white whatever whatever

491
00:19:17,100 --> 00:19:24,540
your ecosystem uses use it and the

492
00:19:23,340 --> 00:19:26,510
actions not to take that's going to

493
00:19:24,540 --> 00:19:29,010
depend on your policies and procedures

494
00:19:26,510 --> 00:19:30,720
keep in mind that if this is something

495
00:19:29,010 --> 00:19:32,070
that's going to go to court you want to

496
00:19:30,720 --> 00:19:33,240
maintain your chain of custody your

497
00:19:32,070 --> 00:19:35,399
chain of evidence you don't want to

498
00:19:33,240 --> 00:19:39,120
contaminate that because depending on

499
00:19:35,400 --> 00:19:41,310
what you're dealing with the legal route

500
00:19:39,120 --> 00:19:43,080
may be exactly what you're pursuing like

501
00:19:41,310 --> 00:19:46,169
if you're dealing with something it's a

502
00:19:43,080 --> 00:19:49,080
child pornography that's inevitably

503
00:19:46,170 --> 00:19:50,970
going to go to court and inevitably I

504
00:19:49,080 --> 00:19:52,320
think the majority if not all of us

505
00:19:50,970 --> 00:19:55,140
could agree that we don't want to do

506
00:19:52,320 --> 00:19:58,590
anything that would allow someone who's

507
00:19:55,140 --> 00:20:00,750
a known pedophile to walk so in that

508
00:19:58,590 --> 00:20:04,679
regard make sure that you respect the

509
00:20:00,750 --> 00:20:05,940
chain of custody and that so something

510
00:20:04,680 --> 00:20:07,550
that I hear system admins do quite

511
00:20:05,940 --> 00:20:10,470
frequently during in

512
00:20:07,550 --> 00:20:13,530
when an account becomes compromised they

513
00:20:10,470 --> 00:20:14,580
change the password well because the

514
00:20:13,530 --> 00:20:16,050
system admin changed the password

515
00:20:14,580 --> 00:20:18,060
there's a good chance it's not going to

516
00:20:16,050 --> 00:20:20,520
hold up in court anymore you've

517
00:20:18,060 --> 00:20:22,820
basically contaminated your evidence so

518
00:20:20,520 --> 00:20:26,580
instead of changing the users password

519
00:20:22,820 --> 00:20:28,370
either deactivate the account or set the

520
00:20:26,580 --> 00:20:30,419
login hours to zero

521
00:20:28,370 --> 00:20:32,370
actually if you want a free honeypot

522
00:20:30,420 --> 00:20:35,130
I'll give you one right here it's very

523
00:20:32,370 --> 00:20:38,520
easy you know conventional wisdom says

524
00:20:35,130 --> 00:20:41,130
to disable the built-in administrator

525
00:20:38,520 --> 00:20:44,639
account right that's what most security

526
00:20:41,130 --> 00:20:48,330
guides like I know the u.s. dod's forms

527
00:20:44,640 --> 00:20:50,310
all say to do that and I think the SIS

528
00:20:48,330 --> 00:20:53,370
benchmarks say the same thing I'm gonna

529
00:20:50,310 --> 00:20:56,790
tell you to do the opposite enable that

530
00:20:53,370 --> 00:20:58,379
administrator account set a very simple

531
00:20:56,790 --> 00:21:01,700
password that meets the minimum

532
00:20:58,380 --> 00:21:04,590
complexity required in your organization

533
00:21:01,700 --> 00:21:05,100
okay yeah you all are looking at me like

534
00:21:04,590 --> 00:21:09,000
I'm crazy

535
00:21:05,100 --> 00:21:10,709
you set the logon hours to zero so now

536
00:21:09,000 --> 00:21:12,150
in your sim you can actually set it up

537
00:21:10,710 --> 00:21:13,830
to where if you get an alert of any

538
00:21:12,150 --> 00:21:16,440
successful login from this account you

539
00:21:13,830 --> 00:21:18,060
know something is compromised the system

540
00:21:16,440 --> 00:21:20,610
from which it logged in on is

541
00:21:18,060 --> 00:21:22,350
compromised nothing can happen it's a

542
00:21:20,610 --> 00:21:24,750
successful login but they're not going

543
00:21:22,350 --> 00:21:27,330
to be able to go further and actually do

544
00:21:24,750 --> 00:21:31,020
any harm but that's a honeypot you could

545
00:21:27,330 --> 00:21:32,550
run for free another thing and this is

546
00:21:31,020 --> 00:21:38,460
from a scenario that I actually dealt

547
00:21:32,550 --> 00:21:40,590
with a former customer they had an RDP

548
00:21:38,460 --> 00:21:44,900
server running as a virtual machine on

549
00:21:40,590 --> 00:21:47,429
the public internet not behind a VPN

550
00:21:44,900 --> 00:21:49,890
logging in as administrator with a

551
00:21:47,430 --> 00:21:53,400
four-character password I can't make

552
00:21:49,890 --> 00:21:55,440
this up so the company I worked for got

553
00:21:53,400 --> 00:21:57,150
called in to do Incident Response so I

554
00:21:55,440 --> 00:21:59,340
Drive to the location it was about an

555
00:21:57,150 --> 00:22:00,840
hour away and I'm like hey could I could

556
00:21:59,340 --> 00:22:02,010
I see the host I want to I want to look

557
00:22:00,840 --> 00:22:04,980
through the logs I want to look through

558
00:22:02,010 --> 00:22:06,470
some other things he's like no okay well

559
00:22:04,980 --> 00:22:10,290
you're the customer you're right I

560
00:22:06,470 --> 00:22:11,910
deleted the VM so if you're using

561
00:22:10,290 --> 00:22:13,830
virtualized environments for things like

562
00:22:11,910 --> 00:22:16,620
this if something gets compromised don't

563
00:22:13,830 --> 00:22:18,120
delete the VM take it offline power it

564
00:22:16,620 --> 00:22:18,959
off pause it do whatever you want just

565
00:22:18,120 --> 00:22:21,979
don't delete it

566
00:22:18,960 --> 00:22:21,980
don't delete evidence

567
00:22:22,380 --> 00:22:26,260
so now we're getting into the cool stuff

568
00:22:24,460 --> 00:22:28,780
so memory analysis that's what this is

569
00:22:26,260 --> 00:22:30,730
really the meat and potatoes of this so

570
00:22:28,780 --> 00:22:32,410
you can do it various ways to collect

571
00:22:30,730 --> 00:22:34,990
your memory image you can use things

572
00:22:32,410 --> 00:22:37,960
like ftk imager ftk imager light which

573
00:22:34,990 --> 00:22:42,970
is free recall can collect memory as

574
00:22:37,960 --> 00:22:46,090
well Lyme works for linux so recall will

575
00:22:42,970 --> 00:22:50,080
work on mac and it is also integrated

576
00:22:46,090 --> 00:22:53,649
into google rapid-response go mandiant

577
00:22:50,080 --> 00:22:55,210
has Mir that also works so there's

578
00:22:53,650 --> 00:22:56,890
various ways you can do it there's no

579
00:22:55,210 --> 00:22:58,510
right or wrong way as long as it's

580
00:22:56,890 --> 00:23:01,630
compatible with your operating system

581
00:22:58,510 --> 00:23:03,970
but then with regards to the actual

582
00:23:01,630 --> 00:23:05,920
assessment of it you can do it with

583
00:23:03,970 --> 00:23:10,960
recall or volatility from the command

584
00:23:05,920 --> 00:23:15,880
line or you could use red line from the

585
00:23:10,960 --> 00:23:21,160
GUI there's a feature that went away in

586
00:23:15,880 --> 00:23:26,290
version 1.2 zero and that is the MRI the

587
00:23:21,160 --> 00:23:29,500
malware risk index so I tried to find a

588
00:23:26,290 --> 00:23:31,389
version of 1.14 I've not been able to

589
00:23:29,500 --> 00:23:32,680
find it from anything reputable I

590
00:23:31,390 --> 00:23:35,650
haven't tried looking into Google cache

591
00:23:32,680 --> 00:23:37,690
the Wayback Machine everything fireEye

592
00:23:35,650 --> 00:23:40,450
mandiant they've taken it down you can't

593
00:23:37,690 --> 00:23:44,290
find it so if you know anyone who has it

594
00:23:40,450 --> 00:23:46,270
or has taken the sans 508 course it's

595
00:23:44,290 --> 00:23:49,389
probably on that thumb drive so that

596
00:23:46,270 --> 00:23:54,100
version is 1.14 and basically what the

597
00:23:49,390 --> 00:23:56,880
MRI does is it's a little pie chart that

598
00:23:54,100 --> 00:23:59,740
goes to the left of everything that

599
00:23:56,880 --> 00:24:03,280
based on certain heuristic checks that

600
00:23:59,740 --> 00:24:05,980
red line does it assigns a value between

601
00:24:03,280 --> 00:24:09,010
0 and 100 and the higher it is the more

602
00:24:05,980 --> 00:24:11,920
the more likely it is to be malicious or

603
00:24:09,010 --> 00:24:13,930
malware so that's something that you

604
00:24:11,920 --> 00:24:16,900
certainly want to take a look at so

605
00:24:13,930 --> 00:24:19,210
within memory analysis the purpose

606
00:24:16,900 --> 00:24:21,730
basically we could spoof things all day

607
00:24:19,210 --> 00:24:23,170
but if it's in memory its truth you're

608
00:24:21,730 --> 00:24:26,590
gonna find out what's actually running

609
00:24:23,170 --> 00:24:28,240
on the live system of course you do have

610
00:24:26,590 --> 00:24:30,639
to have administrative privileges to be

611
00:24:28,240 --> 00:24:32,350
able to capture the memory but we're

612
00:24:30,640 --> 00:24:33,779
going to find evidence outside of syslog

613
00:24:32,350 --> 00:24:38,309
which could have been tampered with

614
00:24:33,779 --> 00:24:39,659
or anything else about execution there

615
00:24:38,309 --> 00:24:42,299
are a few other files that we can look

616
00:24:39,659 --> 00:24:44,759
at that are somewhat protected and we'll

617
00:24:42,299 --> 00:24:49,049
talk about them as well but we're gonna

618
00:24:44,759 --> 00:24:50,639
find that we can do things off-site and

619
00:24:49,049 --> 00:24:52,559
out of the system that will replace a

620
00:24:50,639 --> 00:24:54,299
lot of the windows sis internal process

621
00:24:52,559 --> 00:24:56,369
and that's going to be plugins like

622
00:24:54,299 --> 00:24:58,168
barackman and proc dump within

623
00:24:56,369 --> 00:25:01,168
volatility

624
00:24:58,169 --> 00:25:03,330
we've you cross-reference this so as

625
00:25:01,169 --> 00:25:05,969
with everything if you see something in

626
00:25:03,330 --> 00:25:06,869
memory you can see does this correspond

627
00:25:05,969 --> 00:25:09,299
to something that happened on the

628
00:25:06,869 --> 00:25:11,488
network does this correspond with a file

629
00:25:09,299 --> 00:25:13,139
that we were able to recover using

630
00:25:11,489 --> 00:25:17,879
scalpel or something that we see in

631
00:25:13,139 --> 00:25:19,589
sleuth kit you can feed this into a

632
00:25:17,879 --> 00:25:20,849
timeline as well so there's actually a

633
00:25:19,589 --> 00:25:22,830
plugin called time liner that will

634
00:25:20,849 --> 00:25:25,710
actually help you create a play so a

635
00:25:22,830 --> 00:25:28,468
file that you can then append to your

636
00:25:25,710 --> 00:25:31,440
other your file system play so file

637
00:25:28,469 --> 00:25:34,669
which that's a log to timeline uses the

638
00:25:31,440 --> 00:25:36,899
play so dump format and in doing so

639
00:25:34,669 --> 00:25:40,249
you're basically able to see the two on

640
00:25:36,899 --> 00:25:44,758
top of each other and then beyond that

641
00:25:40,249 --> 00:25:47,820
you can assess your processes you could

642
00:25:44,759 --> 00:25:50,879
do Windows registry analysis Robley the

643
00:25:47,820 --> 00:25:53,249
author of the 508 course he brought up a

644
00:25:50,879 --> 00:25:55,978
point that at this time there's no known

645
00:25:53,249 --> 00:25:58,499
adversary they can spoof a registry key

646
00:25:55,979 --> 00:26:00,299
creation date and if you know the

647
00:25:58,499 --> 00:26:01,799
specific registry key you're looking for

648
00:26:00,299 --> 00:26:03,389
you can actually query that in

649
00:26:01,799 --> 00:26:07,049
volatility and get the actual creation

650
00:26:03,389 --> 00:26:08,939
date and it will not be one one 1970 so

651
00:26:07,049 --> 00:26:11,399
you will actually find out the real date

652
00:26:08,940 --> 00:26:13,469
that this was installed and then of

653
00:26:11,399 --> 00:26:15,748
course there are plugins associated with

654
00:26:13,469 --> 00:26:17,309
finding malware so talking about other

655
00:26:15,749 --> 00:26:19,739
capabilities and specific modules

656
00:26:17,309 --> 00:26:23,149
associated with those you can do hash

657
00:26:19,739 --> 00:26:25,979
dump or me me cats directly out of this

658
00:26:23,149 --> 00:26:27,508
I've tested it on Windows 10 it's not

659
00:26:25,979 --> 00:26:30,570
very effective with that at this time

660
00:26:27,509 --> 00:26:32,989
with the two versions I've tested but

661
00:26:30,570 --> 00:26:35,249
it's always the game of cat and mouse

662
00:26:32,989 --> 00:26:37,279
you know gentle Kiwi is always going to

663
00:26:35,249 --> 00:26:39,450
come up with something new and then

664
00:26:37,279 --> 00:26:40,200
Microsoft's gonna see it fix it and he's

665
00:26:39,450 --> 00:26:41,909
gonna have to come up with something

666
00:26:40,200 --> 00:26:45,479
else it's just the nature of the beast

667
00:26:41,909 --> 00:26:47,280
you can look at rogue processes so

668
00:26:45,479 --> 00:26:50,100
you've got PS

669
00:26:47,280 --> 00:26:51,840
tree EPS list and PS skin within sans

670
00:26:50,100 --> 00:26:53,969
they also I think you can get it from

671
00:26:51,840 --> 00:26:55,740
their github there's PS total that's

672
00:26:53,970 --> 00:26:57,090
going to take all of that into account

673
00:26:55,740 --> 00:26:59,520
and it's actually going to create a

674
00:26:57,090 --> 00:27:01,350
graphic for you and it's going to color

675
00:26:59,520 --> 00:27:03,960
code processes that don't look right

676
00:27:01,350 --> 00:27:05,850
that you need to take a look at so

677
00:27:03,960 --> 00:27:06,270
that's something that can help you as

678
00:27:05,850 --> 00:27:09,540
well

679
00:27:06,270 --> 00:27:10,590
you can pull DLLs carve them that

680
00:27:09,540 --> 00:27:12,180
actually works if you're trying to be a

681
00:27:10,590 --> 00:27:13,949
malicious actor as well because then you

682
00:27:12,180 --> 00:27:16,680
can determine what dll's are there so if

683
00:27:13,950 --> 00:27:18,420
you want to do like a deal a hijacking

684
00:27:16,680 --> 00:27:19,920
attack now you know which ones are there

685
00:27:18,420 --> 00:27:26,700
so you can determine which ones are

686
00:27:19,920 --> 00:27:28,350
vulnerable carve processes the get key

687
00:27:26,700 --> 00:27:31,440
that's the registry key creation date

688
00:27:28,350 --> 00:27:33,780
the timeline and then known malware

689
00:27:31,440 --> 00:27:36,990
mouses proc mal fine there's a few

690
00:27:33,780 --> 00:27:38,790
others as well beyond that so here's

691
00:27:36,990 --> 00:27:41,250
some other stuff so there's files i

692
00:27:38,790 --> 00:27:43,320
mentioned that are not in memory that

693
00:27:41,250 --> 00:27:45,750
you could still reference here they are

694
00:27:43,320 --> 00:27:47,879
and this one is the pre fetch and

695
00:27:45,750 --> 00:27:48,540
basically it came out in XP it's still

696
00:27:47,880 --> 00:27:51,750
in use today

697
00:27:48,540 --> 00:27:54,899
and it just collects and stores specific

698
00:27:51,750 --> 00:27:58,500
data to help everything to run faster

699
00:27:54,900 --> 00:28:03,390
starts faster basically so it's a cache

700
00:27:58,500 --> 00:28:04,920
if you will if you go looking through a

701
00:28:03,390 --> 00:28:07,500
host and you don't see prefetch files

702
00:28:04,920 --> 00:28:10,200
first check your registry to make sure

703
00:28:07,500 --> 00:28:12,090
that it's enabled secondly if it is

704
00:28:10,200 --> 00:28:14,220
enabled uh-oh

705
00:28:12,090 --> 00:28:16,020
there's a boo-boo there you're probably

706
00:28:14,220 --> 00:28:18,150
going to want to take a file system

707
00:28:16,020 --> 00:28:20,430
image and try to carve those out using

708
00:28:18,150 --> 00:28:22,790
scalpel or for most because there's a

709
00:28:20,430 --> 00:28:25,110
good chance that they've been deleted

710
00:28:22,790 --> 00:28:26,820
another similar thing is called the shim

711
00:28:25,110 --> 00:28:28,889
cache also known as the application

712
00:28:26,820 --> 00:28:31,860
compatibility cache it's gonna look at

713
00:28:28,890 --> 00:28:34,740
things and it's not so much for speed

714
00:28:31,860 --> 00:28:37,139
it's more for compatibility but it's

715
00:28:34,740 --> 00:28:40,100
going to take certain data points like

716
00:28:37,140 --> 00:28:43,920
the full file path standard information

717
00:28:40,100 --> 00:28:45,750
and then the process execution flag and

718
00:28:43,920 --> 00:28:47,850
it's going to actually store that in a

719
00:28:45,750 --> 00:28:50,960
file so you can treat it very similar to

720
00:28:47,850 --> 00:28:54,990
prefetch in terms of your analysis so

721
00:28:50,960 --> 00:28:57,150
other things with processes and this is

722
00:28:54,990 --> 00:28:58,530
something that I wish I saw more of and

723
00:28:57,150 --> 00:29:00,540
you could accomplish it with a very

724
00:28:58,530 --> 00:29:02,639
simple for loop so

725
00:29:00,540 --> 00:29:05,250
determine which directories you care

726
00:29:02,640 --> 00:29:07,380
about so in the Windows environment I

727
00:29:05,250 --> 00:29:10,020
would say system 32 and probably the

728
00:29:07,380 --> 00:29:12,240
user space at a minimum but you could

729
00:29:10,020 --> 00:29:17,070
write a for loop so for file in

730
00:29:12,240 --> 00:29:19,110
directory or in directories take an

731
00:29:17,070 --> 00:29:21,899
empty five hash of the file write it to

732
00:29:19,110 --> 00:29:24,689
another file this is basically file

733
00:29:21,900 --> 00:29:26,160
integrity monitoring you take the you

734
00:29:24,690 --> 00:29:28,740
take the hash of it it doesn't matter

735
00:29:26,160 --> 00:29:30,780
you're not you don't worry about oh I'm

736
00:29:28,740 --> 00:29:33,060
using md5 md5 is weak it can be broken

737
00:29:30,780 --> 00:29:35,070
no it doesn't matter because you're not

738
00:29:33,060 --> 00:29:36,450
we don't care if there's a collision we

739
00:29:35,070 --> 00:29:39,450
just need to know what the hash of this

740
00:29:36,450 --> 00:29:41,730
file was at this date and time but take

741
00:29:39,450 --> 00:29:43,110
it a step further by a show of hands who

742
00:29:41,730 --> 00:29:47,190
in here is familiar with the concept of

743
00:29:43,110 --> 00:29:50,010
fuzzy hashing okay so there's a tool

744
00:29:47,190 --> 00:29:52,890
called SSD and it does byte by byte

745
00:29:50,010 --> 00:29:56,220
hashing that's known as fuzzy hashing so

746
00:29:52,890 --> 00:29:59,400
basically you get an md5 of the file and

747
00:29:56,220 --> 00:30:01,560
then an SSD p-- of the file now if the

748
00:29:59,400 --> 00:30:02,370
md5 matches move on to the next and when

749
00:30:01,560 --> 00:30:05,070
you're doing your file integrity

750
00:30:02,370 --> 00:30:07,080
monitoring if it doesn't match then

751
00:30:05,070 --> 00:30:09,300
compare the SS deep and you can find the

752
00:30:07,080 --> 00:30:12,659
byte by byte where it changed so it's

753
00:30:09,300 --> 00:30:17,010
basically a diff so you can accomplish

754
00:30:12,660 --> 00:30:20,160
that via a very simple for loop with the

755
00:30:17,010 --> 00:30:21,600
registry catalog the registry keys

756
00:30:20,160 --> 00:30:23,840
get the creation dates when you can you

757
00:30:21,600 --> 00:30:25,830
can script this as well PowerShell

758
00:30:23,840 --> 00:30:27,810
should be able to help you do that as

759
00:30:25,830 --> 00:30:29,510
well you can use regular expressions to

760
00:30:27,810 --> 00:30:32,100
parse the keys and the dates out of that

761
00:30:29,510 --> 00:30:34,730
another thing is probably get a hash of

762
00:30:32,100 --> 00:30:37,050
your actual registry hives themselves

763
00:30:34,730 --> 00:30:39,480
that way you know when things change if

764
00:30:37,050 --> 00:30:41,550
you have a very lockdown system that

765
00:30:39,480 --> 00:30:42,720
regular users can't install things on

766
00:30:41,550 --> 00:30:45,510
and it has to be a system administrator

767
00:30:42,720 --> 00:30:48,780
and you only release updates once a

768
00:30:45,510 --> 00:30:50,580
month then you can take that hash once a

769
00:30:48,780 --> 00:30:52,790
month and do a file integrity check hey

770
00:30:50,580 --> 00:30:55,830
has anything changed in this registry in

771
00:30:52,790 --> 00:30:58,500
the 29 days since the last time we

772
00:30:55,830 --> 00:31:00,449
updated anything if the answer is yes

773
00:30:58,500 --> 00:31:03,840
then take a closer look see what

774
00:31:00,450 --> 00:31:06,330
happened I mentioned baselines earlier

775
00:31:03,840 --> 00:31:08,550
and within volatility there are three

776
00:31:06,330 --> 00:31:11,070
modules you have process baseline

777
00:31:08,550 --> 00:31:14,460
service baseline and Driver baseline so

778
00:31:11,070 --> 00:31:16,830
process DL driver DL so forth and so on

779
00:31:14,460 --> 00:31:18,330
and this is really if there's one thing

780
00:31:16,830 --> 00:31:20,549
to take away from this this is the part

781
00:31:18,330 --> 00:31:22,168
I would like for you to take away so we

782
00:31:20,549 --> 00:31:24,330
hear all this talk about golden images

783
00:31:22,169 --> 00:31:27,899
and inventories right what does that

784
00:31:24,330 --> 00:31:29,340
consist of okay a golden image you have

785
00:31:27,899 --> 00:31:32,879
an image that you push to your entire

786
00:31:29,340 --> 00:31:35,549
network what does it consist of well

787
00:31:32,879 --> 00:31:36,600
your golden image it's going to have all

788
00:31:35,549 --> 00:31:39,269
your software it's gonna have your

789
00:31:36,600 --> 00:31:41,969
configurations your GP or whatever but

790
00:31:39,269 --> 00:31:44,879
with that you should also be cataloging

791
00:31:41,970 --> 00:31:47,129
the specific software versions any

792
00:31:44,879 --> 00:31:50,939
specific configurations and all that fun

793
00:31:47,129 --> 00:31:53,549
stuff but what do we do beyond that

794
00:31:50,940 --> 00:31:55,889
besides just push it well if you're

795
00:31:53,549 --> 00:31:58,769
using identical profiles then you could

796
00:31:55,889 --> 00:32:01,850
actually capture a memory image of your

797
00:31:58,769 --> 00:32:04,919
golden image when you create it save it

798
00:32:01,850 --> 00:32:08,100
then push the image out something

799
00:32:04,919 --> 00:32:09,570
happens a machine is compromised you can

800
00:32:08,100 --> 00:32:11,480
now take a memory image of it and

801
00:32:09,570 --> 00:32:14,490
compare it to the your golden images

802
00:32:11,480 --> 00:32:17,700
memory using the three baseline

803
00:32:14,490 --> 00:32:19,080
volatility modules so instead of

804
00:32:17,700 --> 00:32:20,730
guessing what's supposed to be there

805
00:32:19,080 --> 00:32:22,199
looking at your documentation that

806
00:32:20,730 --> 00:32:24,240
what's supposed to be there now you have

807
00:32:22,200 --> 00:32:27,179
technical evidence of what exactly has

808
00:32:24,240 --> 00:32:31,259
changed within processes drivers and

809
00:32:27,179 --> 00:32:33,749
services keep in mind though that if you

810
00:32:31,259 --> 00:32:35,909
have a system like this Mac has 16 gigs

811
00:32:33,749 --> 00:32:38,070
of RAM if I take a memory image of that

812
00:32:35,909 --> 00:32:40,649
it's going to require at least 16 gigs

813
00:32:38,070 --> 00:32:43,080
of storage so I'm gonna have to have I

814
00:32:40,649 --> 00:32:44,580
think they make 24 gig drives I know

815
00:32:43,080 --> 00:32:46,049
they make 32 I'm gonna have to have one

816
00:32:44,580 --> 00:32:50,309
or the other because you typically want

817
00:32:46,049 --> 00:32:51,330
at least 110 percent so with that I'm

818
00:32:50,309 --> 00:32:54,450
going to need at least that much of

819
00:32:51,330 --> 00:32:56,220
space and say for example within your

820
00:32:54,450 --> 00:32:58,409
organisation you have your standard

821
00:32:56,220 --> 00:33:00,929
baseline your HR baseline your IT

822
00:32:58,409 --> 00:33:07,590
baseline your senior executive baseline

823
00:33:00,929 --> 00:33:09,779
there's four baselines so 16 gigs now

824
00:33:07,590 --> 00:33:12,149
you're talking you've got to have 64

825
00:33:09,779 --> 00:33:15,029
gigs of storage for this which if you're

826
00:33:12,149 --> 00:33:17,549
doing it on a per golden image basis

827
00:33:15,029 --> 00:33:19,799
that's very manageable if you're a small

828
00:33:17,549 --> 00:33:21,509
organization with like less than ten

829
00:33:19,799 --> 00:33:23,908
employees and a little bit of an

830
00:33:21,509 --> 00:33:25,529
appetite and budget for some cloud

831
00:33:23,909 --> 00:33:27,700
storage you could do it to every host as

832
00:33:25,529 --> 00:33:28,840
well but as

833
00:33:27,700 --> 00:33:30,700
growing to larger enterprises

834
00:33:28,840 --> 00:33:34,539
multinational companies that's just not

835
00:33:30,700 --> 00:33:36,279
attainable seeing as using IBM as an

836
00:33:34,539 --> 00:33:38,590
example they have half a million

837
00:33:36,279 --> 00:33:41,710
employees every employees issued at

838
00:33:38,590 --> 00:33:45,580
least one computer I don't even have an

839
00:33:41,710 --> 00:33:47,620
idea on the server count minimum spec on

840
00:33:45,580 --> 00:33:49,830
a computer right now is what six gigs

841
00:33:47,620 --> 00:33:52,120
are REM maybe even eight right now and

842
00:33:49,830 --> 00:33:55,570
then you've probably got some people who

843
00:33:52,120 --> 00:33:56,918
have scratched and clawed not to upgrade

844
00:33:55,570 --> 00:33:59,408
their computer in a few years and they

845
00:33:56,919 --> 00:34:01,360
only have like two or four gigs but half

846
00:33:59,409 --> 00:34:05,409
a million employees and we'll just say

847
00:34:01,360 --> 00:34:06,879
on average four gigs of RAM that's a

848
00:34:05,409 --> 00:34:10,659
pretty big data center just to maintain

849
00:34:06,880 --> 00:34:11,859
memory images so it's not attainable so

850
00:34:10,659 --> 00:34:13,629
that's why you go with the golden image

851
00:34:11,859 --> 00:34:15,909
you can even script it if you want to do

852
00:34:13,629 --> 00:34:18,759
it on every host but again it's a

853
00:34:15,909 --> 00:34:20,589
storage nightmare with peak apps they

854
00:34:18,760 --> 00:34:22,089
come from the same vein take pcaps as

855
00:34:20,589 --> 00:34:23,828
often as possible for as long as

856
00:34:22,089 --> 00:34:26,619
possible and store for as long as

857
00:34:23,829 --> 00:34:27,790
possible again peak apps are going to

858
00:34:26,619 --> 00:34:29,440
take up space they're not going to take

859
00:34:27,790 --> 00:34:34,389
up as much space as memory images but

860
00:34:29,440 --> 00:34:35,859
they're going to take up space integrate

861
00:34:34,389 --> 00:34:40,540
with your sim if you're not using

862
00:34:35,859 --> 00:34:42,879
NetFlow use NetFlow we all talk we may

863
00:34:40,540 --> 00:34:45,520
recall when Edward Snowden released the

864
00:34:42,879 --> 00:34:46,810
stuff about NSA it was all metadata and

865
00:34:45,520 --> 00:34:49,300
NSA's like well this isn't a problem

866
00:34:46,810 --> 00:34:52,449
it's metadata well what it actually is

867
00:34:49,300 --> 00:34:54,399
metadata so NetFlow collects metadata

868
00:34:52,449 --> 00:34:56,259
and it's going to depending on if you're

869
00:34:54,399 --> 00:34:58,450
using NetFlow version 5 or version 7

870
00:34:56,260 --> 00:35:01,810
it's going to catalog who communicated

871
00:34:58,450 --> 00:35:04,419
with who for how long with what protocol

872
00:35:01,810 --> 00:35:08,170
how much data was sent one way or the

873
00:35:04,420 --> 00:35:09,790
other and all of that that's a lot of

874
00:35:08,170 --> 00:35:11,470
useful information if nothing else that

875
00:35:09,790 --> 00:35:13,509
can help you identify anomalies and

876
00:35:11,470 --> 00:35:14,649
attack periods specifically denial of

877
00:35:13,510 --> 00:35:16,480
services because you're gonna see those

878
00:35:14,650 --> 00:35:18,310
spikes but NetFlow is the other thing

879
00:35:16,480 --> 00:35:19,810
that you can use to see that that job

880
00:35:18,310 --> 00:35:22,450
runs on the 13th of every month the

881
00:35:19,810 --> 00:35:25,359
spikes the network so that's something

882
00:35:22,450 --> 00:35:27,720
useful logs of course pcaps

883
00:35:25,359 --> 00:35:29,920
vulnerability data I mean most sims

884
00:35:27,720 --> 00:35:31,720
allow you to import it if they don't

885
00:35:29,920 --> 00:35:32,400
have it already built in I'm very

886
00:35:31,720 --> 00:35:36,250
familiar with

887
00:35:32,400 --> 00:35:39,670
tinna Bull's Security Center I think

888
00:35:36,250 --> 00:35:40,940
it's like nessus IO now and alienvault

889
00:35:39,670 --> 00:35:42,680
USM and

890
00:35:40,940 --> 00:35:45,260
both of them actually have built and

891
00:35:42,680 --> 00:35:47,328
vulnerability scanning components so

892
00:35:45,260 --> 00:35:49,700
with your peek apps you can use things

893
00:35:47,329 --> 00:35:51,079
like Wireshark and network miner

894
00:35:49,700 --> 00:35:52,939
originally I was gonna demonstrate

895
00:35:51,079 --> 00:35:54,470
network miner but I forgot and actually

896
00:35:52,940 --> 00:35:57,319
shut down my Windows VM that had it

897
00:35:54,470 --> 00:35:59,629
running so I may be able to get it back

898
00:35:57,319 --> 00:36:01,819
up in time but anyway you can actually

899
00:35:59,630 --> 00:36:03,950
carve files out of packet captures using

900
00:36:01,819 --> 00:36:06,440
things like that with network miner it's

901
00:36:03,950 --> 00:36:09,500
so ridiculously easy which actually

902
00:36:06,440 --> 00:36:24,650
brings us up to the demonstration period

903
00:36:09,500 --> 00:36:27,339
so let me get that VM started oh here we

904
00:36:24,650 --> 00:36:27,339
go it's coming up quick

905
00:36:28,569 --> 00:36:40,180
just enter the password then I'll change

906
00:36:31,790 --> 00:36:40,180
the view if I can remember the password

907
00:36:44,859 --> 00:36:53,060
okay fortunately I just fat-fingered oh

908
00:36:48,859 --> 00:36:54,799
it read updates overnight wonderful so

909
00:36:53,060 --> 00:36:56,450
maybe not on network minor thanks

910
00:36:54,800 --> 00:37:01,430
Windows there's a reason I upgraded to a

911
00:36:56,450 --> 00:37:02,328
Mac and it's saying this may take

912
00:37:01,430 --> 00:37:05,868
several minutes

913
00:37:02,329 --> 00:37:14,530
so okay in the meantime let's take a

914
00:37:05,869 --> 00:37:23,200
look at some you see if I can change the

915
00:37:14,530 --> 00:37:23,200
No so just gonna move this over here

916
00:37:30,160 --> 00:37:33,649
okay

917
00:37:31,310 --> 00:37:35,900
I'll just leave it at that size but

918
00:37:33,650 --> 00:37:39,260
anyway this is just showing taking a

919
00:37:35,900 --> 00:37:42,589
memory image with ftk imager light so

920
00:37:39,260 --> 00:37:45,619
there you got to run as admin and I sped

921
00:37:42,589 --> 00:37:47,210
up the process based on my research for

922
00:37:45,619 --> 00:37:49,940
the other talk I was talking about the

923
00:37:47,210 --> 00:37:53,510
social forensic ation typically I've

924
00:37:49,940 --> 00:37:54,920
determined that it's about two to two

925
00:37:53,510 --> 00:37:59,089
and a quarter

926
00:37:54,920 --> 00:38:01,970
times the amount of storage in minutes

927
00:37:59,089 --> 00:38:05,150
so two gig hard drive took me about four

928
00:38:01,970 --> 00:38:07,029
and a half minutes 12 gig or two gigs of

929
00:38:05,150 --> 00:38:11,770
RAM took about four and a half minutes

930
00:38:07,030 --> 00:38:14,270
12 gigs took me right at 26 minutes so

931
00:38:11,770 --> 00:38:15,349
very simple process with that it's very

932
00:38:14,270 --> 00:38:20,240
point-and-click from the Windows

933
00:38:15,349 --> 00:38:21,470
environment what you can do is on the

934
00:38:20,240 --> 00:38:22,939
external hard drive or the thumb drive

935
00:38:21,470 --> 00:38:24,680
whatever you're using to collect it if

936
00:38:22,940 --> 00:38:27,109
you know you're dealing with 16 gigs

937
00:38:24,680 --> 00:38:29,000
walk up with a 32 gig drive you can have

938
00:38:27,109 --> 00:38:31,150
ftk imager on it already

939
00:38:29,000 --> 00:38:34,130
ftk imager like it's an executable

940
00:38:31,150 --> 00:38:35,780
double-click it choose capture image you

941
00:38:34,130 --> 00:38:39,319
can select if you want to go with an 81

942
00:38:35,780 --> 00:38:42,319
or the page file dices as well those are

943
00:38:39,319 --> 00:38:45,259
81 is access data proprietary format

944
00:38:42,319 --> 00:38:46,940
that's who makes ftk page file there are

945
00:38:45,260 --> 00:38:48,710
some volatility modules you can do with

946
00:38:46,940 --> 00:38:51,950
it especially as well but you're also

947
00:38:48,710 --> 00:38:53,270
going to get your memory file itself so

948
00:38:51,950 --> 00:38:56,779
you can actually store to the same drive

949
00:38:53,270 --> 00:39:01,089
you're running it off of so that's one

950
00:38:56,780 --> 00:39:01,089
piece of demonstration

951
00:39:01,450 --> 00:39:13,310
let me windows is asking a few questions

952
00:39:11,170 --> 00:39:33,410
I'm having to opt out of all their

953
00:39:13,310 --> 00:39:43,970
privacy invasions just a moment okay

954
00:39:33,410 --> 00:39:46,868
so I have that in a open Network minor

955
00:39:43,970 --> 00:39:46,868
really quick in this

956
00:39:51,440 --> 00:40:02,839
and just got a shrink the thing a little

957
00:39:58,970 --> 00:40:05,480
bit before I move it over so here we've

958
00:40:02,839 --> 00:40:07,549
got it's playing with parallels so we

959
00:40:05,480 --> 00:40:14,630
really don't care about that but this is

960
00:40:07,549 --> 00:40:16,369
network minor III I can't tell what that

961
00:40:14,630 --> 00:40:19,280
says so I think it's asking me something

962
00:40:16,369 --> 00:40:23,690
about settings but anyway so with

963
00:40:19,280 --> 00:40:34,329
network minor I can't tell what it says

964
00:40:23,690 --> 00:40:36,200
let's see here no so I'm looking for

965
00:40:34,329 --> 00:40:39,640
still relatively new to the Mac

966
00:40:36,200 --> 00:40:45,169
ecosystem so just bear with me a moment

967
00:40:39,640 --> 00:40:49,750
so here we'll just load a file so we'll

968
00:40:45,170 --> 00:40:55,970
open and I don't have my glasses on but

969
00:40:49,750 --> 00:40:58,539
this is assist documents correct okay it

970
00:40:55,970 --> 00:41:05,270
does so we're gonna go to desktop I

971
00:40:58,539 --> 00:41:08,779
restored this from Backblaze image so

972
00:41:05,270 --> 00:41:11,480
here within this we see the stupid icon

973
00:41:08,779 --> 00:41:12,529
we'll move that over here so we see the

974
00:41:11,480 --> 00:41:15,020
host that it communicated with I

975
00:41:12,529 --> 00:41:16,069
apologize I can't zoom in or out with

976
00:41:15,020 --> 00:41:17,750
this because this is the free version

977
00:41:16,069 --> 00:41:20,270
for the paid version you pay them like

978
00:41:17,750 --> 00:41:23,329
$1300 and they send you a thumb drive so

979
00:41:20,270 --> 00:41:25,849
I'm gonna go with 399 so we see the two

980
00:41:23,329 --> 00:41:30,460
hosts that communicated we can expand

981
00:41:25,849 --> 00:41:33,589
that and see we can go okay there's some

982
00:41:30,460 --> 00:41:36,529
addresses additional information here

983
00:41:33,589 --> 00:41:37,640
but what I really want to show you it's

984
00:41:36,529 --> 00:41:39,950
right here files

985
00:41:37,640 --> 00:41:42,259
so notice nowhere in here do I have

986
00:41:39,950 --> 00:41:46,460
putty installed this is just a packet

987
00:41:42,260 --> 00:41:54,380
capture of an SMB transfer so within

988
00:41:46,460 --> 00:41:58,490
this what's that oh oh yeah

989
00:41:54,380 --> 00:42:03,190
thanks I blow off notifications all the

990
00:41:58,490 --> 00:42:06,430
time so

991
00:42:03,190 --> 00:42:09,460
let's see you have to right-click it and

992
00:42:06,430 --> 00:42:16,509
I'm trying my hotkeys for that here and

993
00:42:09,460 --> 00:42:19,410
it's not cooperating go back to file ok

994
00:42:16,510 --> 00:42:19,410
let's try this

995
00:42:21,900 --> 00:42:27,720
nope that's not the droids I'm looking

996
00:42:24,190 --> 00:42:30,760
for alright one last shot and I'll just

997
00:42:27,720 --> 00:42:36,850
okay I'm going to double click it and

998
00:42:30,760 --> 00:42:38,410
see if that works and lo and behold I

999
00:42:36,850 --> 00:42:43,900
actually have an external mouse with me

1000
00:42:38,410 --> 00:42:46,509
but I left in the hotel room see if we

1001
00:42:43,900 --> 00:42:51,010
can do it over here one thing we do see

1002
00:42:46,510 --> 00:42:52,510
here since this isn't working is we have

1003
00:42:51,010 --> 00:42:55,540
a hash of the file that was transferred

1004
00:42:52,510 --> 00:42:57,580
so if we're carving this from a peak app

1005
00:42:55,540 --> 00:43:00,670
that could potentially contain malicious

1006
00:42:57,580 --> 00:43:03,009
data we can actually get the md5 the

1007
00:43:00,670 --> 00:43:06,070
shot one two sha-256 and I think the 512

1008
00:43:03,010 --> 00:43:07,390
but ultimately had I actually had my

1009
00:43:06,070 --> 00:43:08,980
external Mouse and had this actually

1010
00:43:07,390 --> 00:43:10,720
cooperated with me I apologize for not

1011
00:43:08,980 --> 00:43:12,990
sacrificing to the demo gods I'll do

1012
00:43:10,720 --> 00:43:16,629
better next time I promise

1013
00:43:12,990 --> 00:43:21,279
in right-clicking and you would get a

1014
00:43:16,630 --> 00:43:23,590
menu that would say view file run file

1015
00:43:21,280 --> 00:43:25,480
or get hashes so get hashes that's where

1016
00:43:23,590 --> 00:43:26,770
you're gonna see more than the md5 you

1017
00:43:25,480 --> 00:43:28,390
can run the file and what was going to

1018
00:43:26,770 --> 00:43:31,390
happen as putties not installed on this

1019
00:43:28,390 --> 00:43:33,759
vm putty was gonna pop up that's what

1020
00:43:31,390 --> 00:43:36,100
was going to happen but my right clicker

1021
00:43:33,760 --> 00:43:40,990
is not working today so I apologize for

1022
00:43:36,100 --> 00:43:46,240
that so coming back over for some more

1023
00:43:40,990 --> 00:43:50,350
analysis I've got a video that I have

1024
00:43:46,240 --> 00:43:55,060
recorded of Windows 7 memory analysis

1025
00:43:50,350 --> 00:43:57,370
within sift so I'm just gonna pull this

1026
00:43:55,060 --> 00:43:58,870
down here and this is just going to run

1027
00:43:57,370 --> 00:44:01,930
through very quickly I'm setting the

1028
00:43:58,870 --> 00:44:03,400
volatility location so that what this is

1029
00:44:01,930 --> 00:44:06,970
going to do is it keeps you from having

1030
00:44:03,400 --> 00:44:11,860
to announce to volatility every time you

1031
00:44:06,970 --> 00:44:13,029
run it specifically what the file is and

1032
00:44:11,860 --> 00:44:14,590
you can do the same thing with the

1033
00:44:13,030 --> 00:44:17,240
profile you have to define that every

1034
00:44:14,590 --> 00:44:20,750
time here we let me go back

1035
00:44:17,240 --> 00:44:22,850
but we actually saw Mimi cats running so

1036
00:44:20,750 --> 00:44:26,960
the location that's just saying the file

1037
00:44:22,850 --> 00:44:30,140
and it is three slashes so we have that

1038
00:44:26,960 --> 00:44:34,310
now we run Mimi cats so there are some

1039
00:44:30,140 --> 00:44:37,910
passwords that were pulled from that so

1040
00:44:34,310 --> 00:44:44,270
net scan basically it's running net stat

1041
00:44:37,910 --> 00:44:45,440
for you command scan this is looking at

1042
00:44:44,270 --> 00:44:47,630
everything that is parsed on the command

1043
00:44:45,440 --> 00:44:50,990
line get SIDS that's giving you all your

1044
00:44:47,630 --> 00:44:53,090
user data that right there is basically

1045
00:44:50,990 --> 00:44:57,049
all your processes so you're seeing

1046
00:44:53,090 --> 00:44:59,590
what's running with this am cache

1047
00:44:57,050 --> 00:45:03,860
there's nothing there

1048
00:44:59,590 --> 00:45:06,020
so I created a directory to drop dll's

1049
00:45:03,860 --> 00:45:11,600
in so this is just carving all the dll's

1050
00:45:06,020 --> 00:45:13,780
into that directory we can do the same

1051
00:45:11,600 --> 00:45:16,160
thing we can dump RSA certificates

1052
00:45:13,780 --> 00:45:18,740
public keys any of that fun stuff as

1053
00:45:16,160 --> 00:45:25,129
well so a little bit of everything and

1054
00:45:18,740 --> 00:45:26,990
so here's the certs so there's all those

1055
00:45:25,130 --> 00:45:32,630
public certs you might be able to do

1056
00:45:26,990 --> 00:45:36,500
something with those as well and that's

1057
00:45:32,630 --> 00:45:39,250
it within the windows 7 environment I've

1058
00:45:36,500 --> 00:45:42,680
got a Windows 10 one here as well and

1059
00:45:39,250 --> 00:45:44,240
it's not quite as cooperative we're

1060
00:45:42,680 --> 00:45:45,890
gonna get some stuff out of it but we're

1061
00:45:44,240 --> 00:45:50,600
not going to get nearly the treasure

1062
00:45:45,890 --> 00:45:52,100
trove that we got with the Windows 7 so

1063
00:45:50,600 --> 00:45:53,299
if this one is a slightly longer video

1064
00:45:52,100 --> 00:45:55,279
what we're to do the same thing we're

1065
00:45:53,300 --> 00:45:58,190
gonna export the volatility location and

1066
00:45:55,280 --> 00:46:01,340
the volatility profile with Windows 7

1067
00:45:58,190 --> 00:46:05,660
you denote it as Windows 7 service pack

1068
00:46:01,340 --> 00:46:08,180
this underscore 32 or 64 gig with

1069
00:46:05,660 --> 00:46:09,830
Windows 10 you're gonna have to put the

1070
00:46:08,180 --> 00:46:10,520
version number after it so you need to

1071
00:46:09,830 --> 00:46:12,680
know what that is

1072
00:46:10,520 --> 00:46:17,990
there we ran Mimi cats we've got nothing

1073
00:46:12,680 --> 00:46:19,368
nothing on the hash dump net scan now

1074
00:46:17,990 --> 00:46:22,930
we're getting some stuff there so we can

1075
00:46:19,369 --> 00:46:27,080
see what's running and that fun stuff

1076
00:46:22,930 --> 00:46:30,950
command scan nothing PS lists now we're

1077
00:46:27,080 --> 00:46:34,369
getting stuff out of that maybe yep

1078
00:46:30,950 --> 00:46:36,169
so it's the same things PS scan versus

1079
00:46:34,369 --> 00:46:37,520
PS list it's just giving you different

1080
00:46:36,170 --> 00:46:46,010
pieces of information that you can

1081
00:46:37,520 --> 00:46:47,359
analyze in different ways and I I don't

1082
00:46:46,010 --> 00:46:49,369
want to burst anyone's bubble but when

1083
00:46:47,359 --> 00:46:51,890
you're running this analysis it's going

1084
00:46:49,369 --> 00:46:54,500
to take a lot longer than this I

1085
00:46:51,890 --> 00:46:57,140
recorded it and cut pieces out and sped

1086
00:46:54,500 --> 00:46:59,119
it up so that it would be for the sake

1087
00:46:57,140 --> 00:47:05,210
of time same thing with the DLLs were

1088
00:46:59,119 --> 00:47:14,450
able to get those just waiting on this

1089
00:47:05,210 --> 00:47:16,160
to finish it's just showing some of the

1090
00:47:14,450 --> 00:47:19,569
stuff that you can actually take from

1091
00:47:16,160 --> 00:47:22,970
memory that could actually be used

1092
00:47:19,570 --> 00:47:29,690
proactively alright we're pretty much

1093
00:47:22,970 --> 00:47:32,270
finished with this all right and go back

1094
00:47:29,690 --> 00:47:34,160
to this so we looked at Network minor we

1095
00:47:32,270 --> 00:47:37,430
looked at the memory friends of the

1096
00:47:34,160 --> 00:47:41,770
memory acquisition and we looked at

1097
00:47:37,430 --> 00:47:44,089
volatility going a little bit further I

1098
00:47:41,770 --> 00:47:45,349
alongside Brian Austin co-founded a

1099
00:47:44,089 --> 00:47:48,680
thing called through the hacking glass

1100
00:47:45,349 --> 00:47:53,329
it's a mentorship platform we're looking

1101
00:47:48,680 --> 00:47:55,669
at doing it for system hardening system

1102
00:47:53,329 --> 00:47:58,510
monitoring so like sock pin testing and

1103
00:47:55,670 --> 00:48:00,950
incident response varying levels of

1104
00:47:58,510 --> 00:48:02,240
complexity and difficulty we've got

1105
00:48:00,950 --> 00:48:04,399
about three hundred people signed up

1106
00:48:02,240 --> 00:48:06,109
right now but only a about 8% of those

1107
00:48:04,400 --> 00:48:08,060
have signed up to be mentors so

1108
00:48:06,109 --> 00:48:10,460
regardless if you want to be a mentor or

1109
00:48:08,060 --> 00:48:13,339
mentee feel free to sign up there's the

1110
00:48:10,460 --> 00:48:15,410
information for that we're about to

1111
00:48:13,339 --> 00:48:17,240
start pairing people soon if you already

1112
00:48:15,410 --> 00:48:18,259
have a mentor feel free to bring them

1113
00:48:17,240 --> 00:48:20,299
with you

1114
00:48:18,260 --> 00:48:24,290
so but right now it looks like we're

1115
00:48:20,300 --> 00:48:26,150
gonna have to do it in cohorts upcoming

1116
00:48:24,290 --> 00:48:29,119
speaking engagements the nearest one to

1117
00:48:26,150 --> 00:48:31,040
here will be hack in Paris in June where

1118
00:48:29,119 --> 00:48:37,010
I will be presenting social forensic

1119
00:48:31,040 --> 00:48:42,829
ation so there's that and then any

1120
00:48:37,010 --> 00:48:44,800
questions questions concerns complaints

1121
00:48:42,829 --> 00:48:52,670
grievances

1122
00:48:44,800 --> 00:48:54,320
don't be shy any questions anything okay

1123
00:48:52,670 --> 00:48:55,970
well here's a coupon code for my

1124
00:48:54,320 --> 00:48:58,580
upcoming Oh cent training if you want it

1125
00:48:55,970 --> 00:49:02,959
it will be from eighteen to twenty-two

1126
00:48:58,580 --> 00:49:04,730
hundred CET on April 13th it's a four

1127
00:49:02,960 --> 00:49:07,340
hour introduction to social media ascent

1128
00:49:04,730 --> 00:49:10,580
so if you use that coupon code you'll

1129
00:49:07,340 --> 00:49:12,370
get a discount it's about a thirty three

1130
00:49:10,580 --> 00:49:16,040
percent discount if I recall correctly

1131
00:49:12,370 --> 00:49:19,759
so pretty decent but if there are no

1132
00:49:16,040 --> 00:49:25,529
questions that's all folks

1133
00:49:19,760 --> 00:49:25,529
[Applause]

