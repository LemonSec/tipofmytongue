1
00:00:07,290 --> 00:00:10,529
[Music]

2
00:00:12,460 --> 00:00:19,970
yeah it's okay yeah so nice to meet you

3
00:00:16,970 --> 00:00:23,570
I'm happy to be here this year I

4
00:00:19,970 --> 00:00:25,880
remember when I was at insomniac for the

5
00:00:23,570 --> 00:00:29,630
first time as a speaker it was in the

6
00:00:25,880 --> 00:00:32,180
city center and university very small

7
00:00:29,630 --> 00:00:34,670
area and today we are here I don't know

8
00:00:32,180 --> 00:00:38,809
me hundred people are here and it's it's

9
00:00:34,670 --> 00:00:43,130
really really nice so yep my name is

10
00:00:38,809 --> 00:00:45,980
Paula Scania I'm research at Cisco Telus

11
00:00:43,130 --> 00:00:49,489
so is it basically the site Intel team

12
00:00:45,980 --> 00:00:53,989
inside of of Cisco we provide such intel

13
00:00:49,489 --> 00:00:57,879
on every Cisco products so I normally

14
00:00:53,989 --> 00:01:02,780
mainly work on apt stuff I work a lot on

15
00:00:57,879 --> 00:01:06,020
Group one two three or if you if you are

16
00:01:02,780 --> 00:01:08,630
here yesterday your interagency spoke a

17
00:01:06,020 --> 00:01:12,380
lot about your AHA boss I work a lot on

18
00:01:08,630 --> 00:01:13,908
this topic and several other topic so

19
00:01:12,380 --> 00:01:17,390
yeah it's picture of me when I have to

20
00:01:13,909 --> 00:01:18,950
deliver us Delfy malware I think if some

21
00:01:17,390 --> 00:01:22,210
of you already did it you perfectly

22
00:01:18,950 --> 00:01:25,850
understand why I will just kind of mask

23
00:01:22,210 --> 00:01:29,630
so just before starting a few statement

24
00:01:25,850 --> 00:01:32,720
this talk is about iOS and not about iOS

25
00:01:29,630 --> 00:01:35,298
so if you are looking for a talk with an

26
00:01:32,720 --> 00:01:38,590
eye in uppercase it's not a good place

27
00:01:35,299 --> 00:01:41,030
sorry for that I'm nothing iOS expert

28
00:01:38,590 --> 00:01:44,000
Jannik I don't know why you are good to

29
00:01:41,030 --> 00:01:47,630
lighten my yeah so no I'm not on iOS or

30
00:01:44,000 --> 00:01:51,229
expert I touch an iPhone for the first

31
00:01:47,630 --> 00:01:53,960
time in nine months ago so I'm not

32
00:01:51,229 --> 00:01:55,899
really an expert I simply have to

33
00:01:53,960 --> 00:01:57,679
investigate compromised device

34
00:01:55,899 --> 00:02:00,950
understand how it works

35
00:01:57,680 --> 00:02:03,439
find the tool understand the tool and be

36
00:02:00,950 --> 00:02:06,469
able to do my work and the presentation

37
00:02:03,439 --> 00:02:10,160
is more about sharing my experience

38
00:02:06,469 --> 00:02:12,109
about wholesale I had when I tried the

39
00:02:10,160 --> 00:02:14,630
stuff I discovered on iOS because I

40
00:02:12,110 --> 00:02:17,690
didn't know how it worked basically and

41
00:02:14,630 --> 00:02:19,950
stuff like that so no jailbreak I'm not

42
00:02:17,690 --> 00:02:22,410
part of Jarek community

43
00:02:19,950 --> 00:02:24,420
and and yeah so if you are disappointed

44
00:02:22,410 --> 00:02:26,520
I think you have a few minutes to go on

45
00:02:24,420 --> 00:02:29,910
under the rooms no big deal I won't be

46
00:02:26,520 --> 00:02:32,430
offense but yeah it's it's the purpose

47
00:02:29,910 --> 00:02:35,010
of my presentation on the presentation I

48
00:02:32,430 --> 00:02:39,330
will only speak of real malware I had to

49
00:02:35,010 --> 00:02:42,149
work on so basically I know malware on

50
00:02:39,330 --> 00:02:46,890
iOS does not exist but I would present

51
00:02:42,150 --> 00:02:50,280
man where I really work on presentation

52
00:02:46,890 --> 00:02:52,829
of agenda of the presentation we quickly

53
00:02:50,280 --> 00:02:54,959
speak about iOS architecture so not in

54
00:02:52,830 --> 00:02:56,910
detail I'm not sure to explain you how

55
00:02:54,959 --> 00:02:59,400
well the kernel and stuff like that but

56
00:02:56,910 --> 00:03:01,140
you cannot really understand how to

57
00:02:59,400 --> 00:03:04,440
analyze a compromised device if you

58
00:03:01,140 --> 00:03:04,890
don't have a basic knowledge of how it

59
00:03:04,440 --> 00:03:08,220
works

60
00:03:04,890 --> 00:03:12,750
iOS I will speak about jailbreak because

61
00:03:08,220 --> 00:03:15,500
it's it's really a topic you you need to

62
00:03:12,750 --> 00:03:18,360
think about when you have to analyze

63
00:03:15,500 --> 00:03:21,390
compromised device because you will see

64
00:03:18,360 --> 00:03:24,450
the security put in place by Apple is

65
00:03:21,390 --> 00:03:27,869
very very efficient and it can generate

66
00:03:24,450 --> 00:03:30,089
issue from a fine SiC point of view I

67
00:03:27,870 --> 00:03:33,180
will speak about the to LeDoux's the

68
00:03:30,090 --> 00:03:35,940
good one the bad one and and we will we

69
00:03:33,180 --> 00:03:39,120
will see a few example of how I use is

70
00:03:35,940 --> 00:03:42,290
specific to I will speak about malware

71
00:03:39,120 --> 00:03:45,930
develop development know deployment and

72
00:03:42,290 --> 00:03:47,970
basically in my cases how the compromise

73
00:03:45,930 --> 00:03:49,380
device was compromised how the attackers

74
00:03:47,970 --> 00:03:51,900
deployed the malware on these devices

75
00:03:49,380 --> 00:03:54,299
and finally I will show you a few

76
00:03:51,900 --> 00:03:55,980
malware a few few video and stuff like

77
00:03:54,299 --> 00:03:59,489
that cause I got one hour or so

78
00:03:55,980 --> 00:04:02,220
I did some video so I always

79
00:03:59,489 --> 00:04:06,780
architecture first so it's a unique

80
00:04:02,220 --> 00:04:09,329
system so in ideal world you could have

81
00:04:06,780 --> 00:04:11,579
a shell you can have all UNIX command

82
00:04:09,329 --> 00:04:13,709
you've got five system and the design is

83
00:04:11,579 --> 00:04:17,370
a little bit too saved on UNIX you have

84
00:04:13,709 --> 00:04:21,389
a clear space user none and you have a

85
00:04:17,370 --> 00:04:24,419
lot of different framework API some API

86
00:04:21,389 --> 00:04:26,880
can be used by iOS application

87
00:04:24,419 --> 00:04:29,969
developers it's provided to help them to

88
00:04:26,880 --> 00:04:33,030
do the job and some API are private and

89
00:04:29,970 --> 00:04:36,810
can only be used by z/os for example and

90
00:04:33,030 --> 00:04:40,679
and stuff like that so yeah it's pretty

91
00:04:36,810 --> 00:04:44,520
common nothing really new in this in in

92
00:04:40,680 --> 00:04:47,640
this design the biggest difference if

93
00:04:44,520 --> 00:04:51,210
you compare it to annoyed for example or

94
00:04:47,640 --> 00:04:53,760
a classical Linux system is directly you

95
00:04:51,210 --> 00:04:55,950
not have a hood access you cannot

96
00:04:53,760 --> 00:04:59,490
execute something with UID 0

97
00:04:55,950 --> 00:05:01,500
it's normally impossible you don't have

98
00:04:59,490 --> 00:05:05,580
direct access to file system so you

99
00:05:01,500 --> 00:05:08,910
cannot list file on your file system you

100
00:05:05,580 --> 00:05:11,550
must choose a Apple API to do that and

101
00:05:08,910 --> 00:05:14,700
directly you are not allowed to to check

102
00:05:11,550 --> 00:05:17,490
what is in the file system every

103
00:05:14,700 --> 00:05:19,800
application asks sandbox so they learn

104
00:05:17,490 --> 00:05:22,530
on their own on the environment and they

105
00:05:19,800 --> 00:05:24,480
cannot read for example said that of

106
00:05:22,530 --> 00:05:26,700
another application you cannot say I

107
00:05:24,480 --> 00:05:28,170
want to read this stuff on life on the

108
00:05:26,700 --> 00:05:33,810
file system it's not possible and

109
00:05:28,170 --> 00:05:36,240
everything is on its own sandbox

110
00:05:33,810 --> 00:05:38,940
another thing it doesn't really change

111
00:05:36,240 --> 00:05:40,380
for 46 point of view but the hood file

112
00:05:38,940 --> 00:05:42,270
system is in your head only so you

113
00:05:40,380 --> 00:05:44,130
cannot modify something of the hood file

114
00:05:42,270 --> 00:05:46,590
system it's not possible but you have

115
00:05:44,130 --> 00:05:50,159
the same thing on other way if normally

116
00:05:46,590 --> 00:05:52,229
you are the same thing one of the most

117
00:05:50,160 --> 00:05:54,720
important part is a code signing so you

118
00:05:52,230 --> 00:05:56,850
cannot find application if it's not

119
00:05:54,720 --> 00:06:00,150
signed but you cannot find the binary if

120
00:05:56,850 --> 00:06:02,160
it's not signed so if by an expert you

121
00:06:00,150 --> 00:06:05,549
are able to drop a file on the file

122
00:06:02,160 --> 00:06:08,370
system if it's not signed correctly you

123
00:06:05,550 --> 00:06:11,970
cannot execute this binary so yeah

124
00:06:08,370 --> 00:06:13,290
that's a lot of protection from defense

125
00:06:11,970 --> 00:06:16,110
point of view it's really interesting

126
00:06:13,290 --> 00:06:19,380
it's very hard to to jail by an iPhone

127
00:06:16,110 --> 00:06:21,630
you need someone risk in if you want to

128
00:06:19,380 --> 00:06:22,980
create your own jailbreak so from

129
00:06:21,630 --> 00:06:25,740
security point of view it's really nice

130
00:06:22,980 --> 00:06:28,470
it's a huge work and already efficient

131
00:06:25,740 --> 00:06:31,560
but from a point sick point of view it

132
00:06:28,470 --> 00:06:32,040
can be a pain in the ass to to analyze

133
00:06:31,560 --> 00:06:34,920
some

134
00:06:32,040 --> 00:06:37,440
Samara I will explain you why and what

135
00:06:34,920 --> 00:06:42,210
kind of limitation I had to choose this

136
00:06:37,440 --> 00:06:44,820
protection so one thing is should I like

137
00:06:42,210 --> 00:06:46,560
my device so you have a device you have

138
00:06:44,820 --> 00:06:48,659
a customer's or whatever that's a

139
00:06:46,560 --> 00:06:53,790
device you expect to you I know is

140
00:06:48,660 --> 00:06:56,520
compromised for XY reason and do you

141
00:06:53,790 --> 00:07:03,720
need to J buy this device to be able to

142
00:06:56,520 --> 00:07:06,750
work so the problem is with the current

143
00:07:03,720 --> 00:07:09,900
design it's impossible technically to

144
00:07:06,750 --> 00:07:13,080
get the application if your device is

145
00:07:09,900 --> 00:07:15,020
not a J pocket so you know this

146
00:07:13,080 --> 00:07:18,180
application is malicious you can know

147
00:07:15,020 --> 00:07:21,960
this application come from this URL or

148
00:07:18,180 --> 00:07:24,930
whatever your customer can say yeah look

149
00:07:21,960 --> 00:07:27,000
I know it's malicious but in fact you

150
00:07:24,930 --> 00:07:28,229
cannot help him because you cannot get

151
00:07:27,000 --> 00:07:30,240
the application it's technically

152
00:07:28,229 --> 00:07:32,849
impossible the application store on a

153
00:07:30,240 --> 00:07:36,930
file system that is not available

154
00:07:32,850 --> 00:07:40,530
accessible and you cannot get the IPA

155
00:07:36,930 --> 00:07:43,889
which is a pica equivalent on on on

156
00:07:40,530 --> 00:07:46,260
Apple you cannot make me movie dump and

157
00:07:43,889 --> 00:07:51,930
you cannot make this dump and stuff

158
00:07:46,260 --> 00:07:54,300
stuff like that so in my case I work on

159
00:07:51,930 --> 00:07:56,550
case where I was able to download the

160
00:07:54,300 --> 00:07:59,130
IPA on the internet so in this case I

161
00:07:56,550 --> 00:08:01,580
can download it and analyze on a

162
00:07:59,130 --> 00:08:05,039
standard phone it's technically possible

163
00:08:01,580 --> 00:08:07,530
but I've got the circus was where I

164
00:08:05,039 --> 00:08:09,270
didn't get the IPF file from the

165
00:08:07,530 --> 00:08:10,919
internet so it was on the internet but

166
00:08:09,270 --> 00:08:14,789
when I start the investigation

167
00:08:10,919 --> 00:08:16,859
I got 404 it was not online anymore I

168
00:08:14,789 --> 00:08:19,320
know the application is here on my phone

169
00:08:16,860 --> 00:08:20,430
and if my phone is up-to-date and I

170
00:08:19,320 --> 00:08:24,240
don't have any jet bike

171
00:08:20,430 --> 00:08:26,580
I simply cannot work I need to switch

172
00:08:24,240 --> 00:08:28,289
off the phone and wait for the next gen

173
00:08:26,580 --> 00:08:31,409
Mike it could be in one week one month

174
00:08:28,289 --> 00:08:35,189
two months six months ago or never so

175
00:08:31,410 --> 00:08:38,789
it's one of the main issue I had is how

176
00:08:35,190 --> 00:08:41,909
to get IP a application from from a

177
00:08:38,789 --> 00:08:45,779
device if you can have the application

178
00:08:41,909 --> 00:08:48,569
from a website or whatever how you can

179
00:08:45,779 --> 00:08:50,670
get it you can analyze it without

180
00:08:48,570 --> 00:08:52,500
jailbreaking you device for example

181
00:08:50,670 --> 00:08:54,900
Freda I will speak about this

182
00:08:52,500 --> 00:08:57,390
application later works on jailbroken

183
00:08:54,900 --> 00:08:59,370
and standard phone so if you have the

184
00:08:57,390 --> 00:09:00,480
application you can reverse it you can

185
00:08:59,370 --> 00:09:03,960
analyze it

186
00:09:00,480 --> 00:09:07,250
without opening your your device if we

187
00:09:03,960 --> 00:09:10,500
need to jailbreak your device today

188
00:09:07,250 --> 00:09:12,840
there is two tools elect high and cover

189
00:09:10,500 --> 00:09:16,310
and cover is probably the best choice

190
00:09:12,840 --> 00:09:18,900
because you can generate phone up to

191
00:09:16,310 --> 00:09:21,900
12.1 the two versions so it's it's

192
00:09:18,900 --> 00:09:25,620
pretty it's not the last one obviously

193
00:09:21,900 --> 00:09:27,030
just before and if the device is

194
00:09:25,620 --> 00:09:29,760
up-to-date you don't have a lot of

195
00:09:27,030 --> 00:09:32,280
solution you can ping syllabi right if

196
00:09:29,760 --> 00:09:34,650
you have a lot of money or you can

197
00:09:32,280 --> 00:09:37,170
simply stop the device change the

198
00:09:34,650 --> 00:09:37,980
profile to avoid the automatic update

199
00:09:37,170 --> 00:09:41,310
and stuff like that

200
00:09:37,980 --> 00:09:45,690
typically if I want to disable update I

201
00:09:41,310 --> 00:09:49,140
set a TV OS for five so I say to my

202
00:09:45,690 --> 00:09:51,870
phone I'm a Apple TV and if you try to

203
00:09:49,140 --> 00:09:54,060
update Apple detect no you are not an

204
00:09:51,870 --> 00:09:57,030
Apple TV and don't do anything so that's

205
00:09:54,060 --> 00:09:59,609
the best way to stop update on iOS 5

206
00:09:57,030 --> 00:10:03,390
it's my way to stop update on on on iOS

207
00:09:59,610 --> 00:10:06,120
cross on the since I was 12

208
00:10:03,390 --> 00:10:06,600
Apple implemented auto update so if take

209
00:10:06,120 --> 00:10:10,080
care

210
00:10:06,600 --> 00:10:12,480
use disable auto update if if you want

211
00:10:10,080 --> 00:10:14,250
to do to freeze a device to analyze it

212
00:10:12,480 --> 00:10:17,790
later when I urge a bike would be

213
00:10:14,250 --> 00:10:20,730
available one of the problem I have as I

214
00:10:17,790 --> 00:10:23,760
said nine months ago when I try to work

215
00:10:20,730 --> 00:10:27,920
on this case by accident I did not have

216
00:10:23,760 --> 00:10:30,960
a single iOS device so I had to find

217
00:10:27,920 --> 00:10:34,439
iPhone basically what I pod or iPad it's

218
00:10:30,960 --> 00:10:37,770
the same OS you can use one of these

219
00:10:34,440 --> 00:10:40,230
device or another one I wanted a very

220
00:10:37,770 --> 00:10:43,350
specific version because I wanted a

221
00:10:40,230 --> 00:10:45,660
version I can get like so and when you

222
00:10:43,350 --> 00:10:47,790
go on your Apple Store supermarket you

223
00:10:45,660 --> 00:10:51,089
can say I want the old version this one

224
00:10:47,790 --> 00:10:56,280
because I want to jailbreak it the best

225
00:10:51,090 --> 00:10:58,860
way I found there is to wear eBay but

226
00:10:56,280 --> 00:11:00,780
it's crazy expensive people make a lot

227
00:10:58,860 --> 00:11:03,810
of money by selling old version of

228
00:11:00,780 --> 00:11:05,939
iPhone all the other ways to get the

229
00:11:03,810 --> 00:11:07,949
same number and in fact on the serial

230
00:11:05,940 --> 00:11:11,100
number you've got the week where the

231
00:11:07,950 --> 00:11:13,330
device was a design and flash and based

232
00:11:11,100 --> 00:11:16,840
on the week you can guess a version of

233
00:11:13,330 --> 00:11:20,470
of the phone so if your is an example

234
00:11:16,840 --> 00:11:23,950
for example of the website so you put W

235
00:11:20,470 --> 00:11:26,610
W on this week manufacture field and you

236
00:11:23,950 --> 00:11:31,180
know it's probably more than probably 11

237
00:11:26,610 --> 00:11:32,920
4.4 a poor tip if you can supermarket

238
00:11:31,180 --> 00:11:35,260
and you ask to the guy can I see the

239
00:11:32,920 --> 00:11:39,160
serial number of the phone is a little

240
00:11:35,260 --> 00:11:42,100
bit suspicious and how I managed to have

241
00:11:39,160 --> 00:11:45,250
someone more easy with me I simply say I

242
00:11:42,100 --> 00:11:47,080
buy two phone if you let me do he give

243
00:11:45,250 --> 00:11:52,930
me access to the cell number across to

244
00:11:47,080 --> 00:11:55,090
iPhone it's it's a lot of money so I

245
00:11:52,930 --> 00:11:56,890
want you you have your phone you have

246
00:11:55,090 --> 00:11:59,620
the good version you are lucky you have

247
00:11:56,890 --> 00:12:01,900
the jailbreak application so a jailbreak

248
00:11:59,620 --> 00:12:03,070
is simply an IP an application you

249
00:12:01,900 --> 00:12:05,230
install the application on your phone

250
00:12:03,070 --> 00:12:07,120
you click on it you wait it should work

251
00:12:05,230 --> 00:12:11,370
and you have full access or on the

252
00:12:07,120 --> 00:12:13,330
device today all the jail by car

253
00:12:11,370 --> 00:12:16,930
non-persistent so if your hope with your

254
00:12:13,330 --> 00:12:20,740
phone you need to hold on G application

255
00:12:16,930 --> 00:12:22,959
and NJ back it again because it doesn't

256
00:12:20,740 --> 00:12:24,670
change as a file system to avoid liking

257
00:12:22,960 --> 00:12:32,080
signatures and your device doesn't boot

258
00:12:24,670 --> 00:12:35,339
anymore so if the purpose of my work was

259
00:12:32,080 --> 00:12:39,100
to analyze malicious application on iOS

260
00:12:35,340 --> 00:12:41,320
so you have several tools to do those so

261
00:12:39,100 --> 00:12:43,420
if you use Ida Pro it works perfectly if

262
00:12:41,320 --> 00:12:45,610
you have a license and you are used to

263
00:12:43,420 --> 00:12:49,240
use the Ida Pro it's it's not a problem

264
00:12:45,610 --> 00:12:53,800
a less expensive alternative but ready

265
00:12:49,240 --> 00:12:58,390
with good output is Papa Cooper and I

266
00:12:53,800 --> 00:13:00,880
think this one it's 100 euros so it's

267
00:12:58,390 --> 00:13:03,130
it's pretty cheap compared to write a

268
00:13:00,880 --> 00:13:06,790
pro and the perfect issue both

269
00:13:03,130 --> 00:13:10,900
objective-c or Swift code so you can

270
00:13:06,790 --> 00:13:12,880
have this kind of of output on on Ida so

271
00:13:10,900 --> 00:13:15,910
you can get directly the class name and

272
00:13:12,880 --> 00:13:17,410
the method name accessory so if the

273
00:13:15,910 --> 00:13:19,540
developer doesn't put a lot of

274
00:13:17,410 --> 00:13:23,339
appreciation simply by looking the name

275
00:13:19,540 --> 00:13:27,069
you can guess what the matter is doing

276
00:13:23,340 --> 00:13:29,740
so to I'm user must on

277
00:13:27,070 --> 00:13:32,170
i OS investigation is Frieda it's an

278
00:13:29,740 --> 00:13:36,940
open source instrumentation framework

279
00:13:32,170 --> 00:13:39,040
and he does a very very great job so I

280
00:13:36,940 --> 00:13:43,060
will show you some example how I use

281
00:13:39,040 --> 00:13:45,370
Frieda in this context the advantage of

282
00:13:43,060 --> 00:13:47,829
Frieda is what I said you can use it on

283
00:13:45,370 --> 00:13:50,290
Jarek on device so you put it on the

284
00:13:47,830 --> 00:13:53,860
device and you said I want to debug this

285
00:13:50,290 --> 00:13:55,689
application it's the easy way but if you

286
00:13:53,860 --> 00:13:58,570
don't have a jailbroken device you can

287
00:13:55,690 --> 00:14:01,840
use Frieda you can take the malicious

288
00:13:58,570 --> 00:14:04,330
application you compile it by injecting

289
00:14:01,840 --> 00:14:05,770
Frieda inside of the application and

290
00:14:04,330 --> 00:14:08,770
when you execute the application on your

291
00:14:05,770 --> 00:14:10,870
device with the will on inside of the

292
00:14:08,770 --> 00:14:12,939
malicious application you want to 200 so

293
00:14:10,870 --> 00:14:15,310
it's it's very convenient from this

294
00:14:12,940 --> 00:14:17,770
point of view you can see a lot of video

295
00:14:15,310 --> 00:14:20,939
on YouTube about how I on this

296
00:14:17,770 --> 00:14:26,110
famous game by using Frieda

297
00:14:20,940 --> 00:14:31,660
so I found a specific class and named

298
00:14:26,110 --> 00:14:35,560
web GL and which means web download link

299
00:14:31,660 --> 00:14:39,730
and in the red I don't know oh yeah you

300
00:14:35,560 --> 00:14:43,180
can read it it's in fact the URL of the

301
00:14:39,730 --> 00:14:44,830
c2 server obfuscated so in this case the

302
00:14:43,180 --> 00:14:47,560
attacker doesn't put the HTTP my

303
00:14:44,830 --> 00:14:50,050
malicious website con that put some

304
00:14:47,560 --> 00:14:53,829
obfuscation to avoid reading it very

305
00:14:50,050 --> 00:14:56,650
easily so I will show you with FINA how

306
00:14:53,830 --> 00:15:01,630
you can manage this thing with maybe six

307
00:14:56,650 --> 00:15:07,180
line of god so yeah so basically I

308
00:15:01,630 --> 00:15:13,000
decided to attach my free decision to

309
00:15:07,180 --> 00:15:16,449
this specific method and I display the

310
00:15:13,000 --> 00:15:19,630
output of the function simply each time

311
00:15:16,450 --> 00:15:22,810
the function is executed my god my hook

312
00:15:19,630 --> 00:15:25,300
it is executed and I go at the end of

313
00:15:22,810 --> 00:15:28,239
the function I display the output of the

314
00:15:25,300 --> 00:15:32,650
function and you can see at the bottom

315
00:15:28,240 --> 00:15:36,450
here each time I enter on this web

316
00:15:32,650 --> 00:15:40,110
download link method I read as a high

317
00:15:36,450 --> 00:15:42,510
tech mat.com website so

318
00:15:40,110 --> 00:15:44,550
without understanding this algorithm I

319
00:15:42,510 --> 00:15:46,620
can simply with Frida say I want the

320
00:15:44,550 --> 00:15:50,550
output of this method this one or this

321
00:15:46,620 --> 00:15:55,260
one and understand really how summerwear

322
00:15:50,550 --> 00:15:59,459
works if we decided to be a more stupid

323
00:15:55,260 --> 00:16:02,970
you can do it directly by hooking UN

324
00:15:59,459 --> 00:16:08,099
requests from the iOS API so instead of

325
00:16:02,970 --> 00:16:10,260
saying I want to hook this method inside

326
00:16:08,100 --> 00:16:13,709
of this malware I decide to hook

327
00:16:10,260 --> 00:16:16,860
directly iOS API and see each time to a

328
00:16:13,709 --> 00:16:19,349
PPC application perform request on a

329
00:16:16,860 --> 00:16:21,660
specific URL and in this case you've got

330
00:16:19,350 --> 00:16:26,190
the same thing unbuttoned you've got the

331
00:16:21,660 --> 00:16:29,640
URL so for me today it's the only really

332
00:16:26,190 --> 00:16:32,730
good tools for dynamic analysis on iOS

333
00:16:29,640 --> 00:16:36,089
we don't really have choice but Apple

334
00:16:32,730 --> 00:16:39,959
provide a debugger so trust me I'm a

335
00:16:36,089 --> 00:16:45,260
windbg user and this stuff is a new

336
00:16:39,959 --> 00:16:49,290
table so the syntax is really weird and

337
00:16:45,260 --> 00:16:51,930
and yeah I had a lot of issue to to use

338
00:16:49,290 --> 00:16:56,040
it so it's not if it's provided by Apple

339
00:16:51,930 --> 00:16:58,140
and in fact when you use the official ID

340
00:16:56,040 --> 00:17:01,380
from Apple to develop your application

341
00:16:58,140 --> 00:17:03,390
behind he used this application but it's

342
00:17:01,380 --> 00:17:07,709
hiding inside of the beautiful interface

343
00:17:03,390 --> 00:17:09,869
and and yeah you can do the same thing

344
00:17:07,709 --> 00:17:12,689
make some back point and memorialize and

345
00:17:09,869 --> 00:17:15,000
display the value but finally it was so

346
00:17:12,689 --> 00:17:19,380
much easier to use Frida than I didn't

347
00:17:15,000 --> 00:17:21,660
choose this debugger something very

348
00:17:19,380 --> 00:17:27,720
interesting with Frida for example if

349
00:17:21,660 --> 00:17:32,549
you got my github I create a script to

350
00:17:27,720 --> 00:17:36,390
dump the memory of my running process so

351
00:17:32,549 --> 00:17:38,639
the advantage for me is I worked on the

352
00:17:36,390 --> 00:17:40,740
malware I will probably explain it later

353
00:17:38,640 --> 00:17:44,460
but I work on the manuals that inject

354
00:17:40,740 --> 00:17:48,120
HTML inside of website so the manual

355
00:17:44,460 --> 00:17:50,220
display web site and add JavaScript

356
00:17:48,120 --> 00:17:53,010
inside of the website so you are on the

357
00:17:50,220 --> 00:17:53,700
real website good you are Alex turbot

358
00:17:53,010 --> 00:17:58,379
the mer

359
00:17:53,700 --> 00:18:02,100
inject JavaScript on the page and thanks

360
00:17:58,380 --> 00:18:05,309
to this wet memory I directly get the

361
00:18:02,100 --> 00:18:08,820
modified web page with injected good

362
00:18:05,309 --> 00:18:11,220
directly from memory so it was very easy

363
00:18:08,820 --> 00:18:13,350
to get as a modified web page directly

364
00:18:11,220 --> 00:18:17,519
by memory them by doing memory nap

365
00:18:13,350 --> 00:18:20,279
so yeah it works pretty well if you have

366
00:18:17,519 --> 00:18:22,649
to work on this kind of off case and it

367
00:18:20,279 --> 00:18:28,590
works for Andre - for this specific

368
00:18:22,649 --> 00:18:32,489
slide what I do I have dedicated the hot

369
00:18:28,590 --> 00:18:35,970
spot at home and this odd spot I create

370
00:18:32,490 --> 00:18:39,779
pre cap and I bind my device my iPhone

371
00:18:35,970 --> 00:18:43,230
on this hot spot so I download all the

372
00:18:39,779 --> 00:18:45,149
pcap of my iPhone doing requests on the

373
00:18:43,230 --> 00:18:47,220
internet extra of course you can have

374
00:18:45,149 --> 00:18:49,889
HTTP and it's not really useful to have

375
00:18:47,220 --> 00:18:51,960
encrypted pickup and in this case I used

376
00:18:49,889 --> 00:18:53,820
burp and I make many in the winner I

377
00:18:51,960 --> 00:18:56,909
trust a certificate

378
00:18:53,820 --> 00:18:59,668
SSL certificate of my web server and I

379
00:18:56,909 --> 00:19:03,419
dump every web request by doing man in

380
00:18:59,669 --> 00:19:05,970
the middle so if you download the app

381
00:19:03,419 --> 00:19:07,649
you have a documentation about how to do

382
00:19:05,970 --> 00:19:09,690
that on iphone so you don't have to

383
00:19:07,649 --> 00:19:12,059
think you simply follow the

384
00:19:09,690 --> 00:19:14,250
documentation and it works really well

385
00:19:12,059 --> 00:19:17,220
so I'm able to have pickup I'm able to

386
00:19:14,250 --> 00:19:18,809
have HTTP HTTPS and generally it's good

387
00:19:17,220 --> 00:19:22,230
enough from a network point of view on a

388
00:19:18,809 --> 00:19:26,730
dedicated spot cause I don't want to add

389
00:19:22,230 --> 00:19:28,889
noise with my other device basically and

390
00:19:26,730 --> 00:19:36,889
potentially I want to use a VPN auto

391
00:19:28,889 --> 00:19:39,779
record so much deployment so many lapses

392
00:19:36,889 --> 00:19:41,428
in this part it's basically how

393
00:19:39,779 --> 00:19:43,500
malicious application was deployed

394
00:19:41,429 --> 00:19:45,210
during my investigation but to

395
00:19:43,500 --> 00:19:47,250
understand that you need to understand a

396
00:19:45,210 --> 00:19:52,850
little bit how you can legitimately

397
00:19:47,250 --> 00:19:56,490
deploy application on a phone so

398
00:19:52,850 --> 00:19:59,699
basically there is not a lot of way to

399
00:19:56,490 --> 00:20:03,799
do it an application must be signed

400
00:19:59,700 --> 00:20:05,940
it's a routes you cannot have Apple

401
00:20:03,799 --> 00:20:07,580
application on your device if it's not

402
00:20:05,940 --> 00:20:10,860
signed

403
00:20:07,580 --> 00:20:14,280
and during my investigation I found

404
00:20:10,860 --> 00:20:16,889
several way to to sign an application

405
00:20:14,280 --> 00:20:19,020
you can sign it with an official

406
00:20:16,890 --> 00:20:20,760
certificate you pay at Apple and you're

407
00:20:19,020 --> 00:20:21,570
on the store and you sign with this

408
00:20:20,760 --> 00:20:25,170
application

409
00:20:21,570 --> 00:20:27,540
it's how works all application but it's

410
00:20:25,170 --> 00:20:29,970
not so easy to be in the Apple Store you

411
00:20:27,540 --> 00:20:32,370
cannot develop the manual and put it on

412
00:20:29,970 --> 00:20:34,760
the upper side it's a lot of work I

413
00:20:32,370 --> 00:20:38,429
don't say it's impossible but it's

414
00:20:34,760 --> 00:20:41,820
really really not as easy as for Google

415
00:20:38,430 --> 00:20:44,940
stuff or for example another way to do

416
00:20:41,820 --> 00:20:47,850
it is a developer certificate so a

417
00:20:44,940 --> 00:20:50,700
developer certificate I've got one for

418
00:20:47,850 --> 00:20:55,290
example it cost 100 euros so it's rich

419
00:20:50,700 --> 00:20:58,520
cheap and you can deploy application on

420
00:20:55,290 --> 00:21:02,430
the device but you must manually trust

421
00:20:58,520 --> 00:21:05,430
this certificate so the user must say ok

422
00:21:02,430 --> 00:21:08,160
I trust this developer certificate and I

423
00:21:05,430 --> 00:21:10,380
install it on my on my device at this

424
00:21:08,160 --> 00:21:15,690
time you can install all the application

425
00:21:10,380 --> 00:21:20,340
signed by this certificate another way

426
00:21:15,690 --> 00:21:25,050
it's used by developers too is to create

427
00:21:20,340 --> 00:21:28,679
a profile with ug ID so how does it

428
00:21:25,050 --> 00:21:31,080
works you can say this application can

429
00:21:28,680 --> 00:21:35,910
be only installed on this specific

430
00:21:31,080 --> 00:21:37,560
device based on this unique ID it's used

431
00:21:35,910 --> 00:21:40,920
a lot by developers since the developers

432
00:21:37,560 --> 00:21:43,250
have a lot of iPhone every version every

433
00:21:40,920 --> 00:21:45,930
model every size of screen extra and

434
00:21:43,250 --> 00:21:48,690
they develop the application and put a

435
00:21:45,930 --> 00:21:50,460
cell number of holds a phone and you

436
00:21:48,690 --> 00:21:52,830
play it on all the phone and check if

437
00:21:50,460 --> 00:21:56,700
the font are aligned if you everything

438
00:21:52,830 --> 00:21:59,280
is beautiful and worked correctly yeah

439
00:21:56,700 --> 00:22:02,300
that's how they work basically it's it's

440
00:21:59,280 --> 00:22:04,889
a it's a very interesting feature from a

441
00:22:02,300 --> 00:22:07,860
developer point of view we saw some

442
00:22:04,890 --> 00:22:10,080
malware deployed with this text the

443
00:22:07,860 --> 00:22:14,010
attackers knew the idea of the phone I

444
00:22:10,080 --> 00:22:16,919
will show you how and signed application

445
00:22:14,010 --> 00:22:19,200
with the developer certificate dedicated

446
00:22:16,920 --> 00:22:25,410
to this

447
00:22:19,200 --> 00:22:27,330
phone yeah is for example a fake

448
00:22:25,410 --> 00:22:30,720
certificate a developer certificate

449
00:22:27,330 --> 00:22:33,990
don't so you must understand that this

450
00:22:30,720 --> 00:22:36,090
certificate was delivered by Apple but

451
00:22:33,990 --> 00:22:37,470
it's not a production certificate to

452
00:22:36,090 --> 00:22:40,560
develop a certificate you need to

453
00:22:37,470 --> 00:22:45,000
install it manually so it's combo at

454
00:22:40,560 --> 00:22:47,159
university but in fact it was in I don't

455
00:22:45,000 --> 00:22:48,110
remember in somewhere in Middle East I

456
00:22:47,160 --> 00:22:50,760
don't remember

457
00:22:48,110 --> 00:22:53,459
in fact it's not a complete University

458
00:22:50,760 --> 00:22:55,650
at all but they buy this developed or

459
00:22:53,460 --> 00:22:59,820
certificate sign malicious application

460
00:22:55,650 --> 00:23:04,170
with it and ere we go here is for

461
00:22:59,820 --> 00:23:07,080
example a profile including unique ID

462
00:23:04,170 --> 00:23:10,170
from specific device so it's simply a

463
00:23:07,080 --> 00:23:12,659
strings with this ID this idea this idea

464
00:23:10,170 --> 00:23:14,850
and the application can only be

465
00:23:12,660 --> 00:23:17,340
installed on this list of device if you

466
00:23:14,850 --> 00:23:22,020
try to insert it on another one it would

467
00:23:17,340 --> 00:23:24,149
say no it doesn't work here is for

468
00:23:22,020 --> 00:23:28,910
example a github project to get the UT

469
00:23:24,150 --> 00:23:31,860
ID of a user so it's a webpage that

470
00:23:28,910 --> 00:23:36,600
that's and when user users go on this

471
00:23:31,860 --> 00:23:39,209
webpage it push a profile file iOS

472
00:23:36,600 --> 00:23:41,429
interpret this profile file ask to the

473
00:23:39,210 --> 00:23:43,440
user or be careful the website want to

474
00:23:41,430 --> 00:23:46,500
have information of your device are you

475
00:23:43,440 --> 00:23:49,110
ok if you say ok it will send the unique

476
00:23:46,500 --> 00:23:51,890
ID to the server if you say no of course

477
00:23:49,110 --> 00:23:51,889
you won't do anything

478
00:23:52,940 --> 00:24:02,880
yeah so it's nothing new

479
00:23:58,610 --> 00:24:03,540
extra so another way the most common way

480
00:24:02,880 --> 00:24:06,420
with soda

481
00:24:03,540 --> 00:24:10,290
last year during our investigation is to

482
00:24:06,420 --> 00:24:12,900
use an MDM so malicious endian Malwa

483
00:24:10,290 --> 00:24:16,500
multi device management I think

484
00:24:12,900 --> 00:24:19,350
something like that so if you work for

485
00:24:16,500 --> 00:24:21,390
for a big company I think all and you

486
00:24:19,350 --> 00:24:23,459
have an iPhone even in Android but on

487
00:24:21,390 --> 00:24:25,530
iphone specifically you are probably

488
00:24:23,460 --> 00:24:27,810
already on the hold on and the end so

489
00:24:25,530 --> 00:24:30,920
your company manage your phone remotely

490
00:24:27,810 --> 00:24:32,760
and is able to my oh no maybe

491
00:24:30,920 --> 00:24:36,600
wipe your phone

492
00:24:32,760 --> 00:24:39,740
if you lost it to avoid losing sensitive

493
00:24:36,600 --> 00:24:39,740
documents and stuff like that

494
00:24:41,660 --> 00:24:46,500
MDM on Android and MDM on iPhone is

495
00:24:45,210 --> 00:24:49,680
completely different

496
00:24:46,500 --> 00:24:52,440
on Android MDM is basically an

497
00:24:49,680 --> 00:24:54,870
application and you decide what you want

498
00:24:52,440 --> 00:24:58,680
to do if you have you asked for all the

499
00:24:54,870 --> 00:25:04,139
permission and you do the application do

500
00:24:58,680 --> 00:25:07,410
everything does everything on on iOS MDM

501
00:25:04,140 --> 00:25:09,870
is not an application it it's part of

502
00:25:07,410 --> 00:25:12,030
the operating system so you cannot

503
00:25:09,870 --> 00:25:15,270
choose which feature you want so feature

504
00:25:12,030 --> 00:25:17,310
provided by Apple Apple design the MDM

505
00:25:15,270 --> 00:25:19,920
and say with an MDM you can do that you

506
00:25:17,310 --> 00:25:22,080
can do that here is a IP API to do that

507
00:25:19,920 --> 00:25:24,750
accessorize nothing more nothing less

508
00:25:22,080 --> 00:25:26,790
it's provided by Apple documented by

509
00:25:24,750 --> 00:25:31,050
Apple and you don't need to develop your

510
00:25:26,790 --> 00:25:33,060
own application to be a MDM from one

511
00:25:31,050 --> 00:25:34,620
point of view on on originary you

512
00:25:33,060 --> 00:25:38,330
install a specific application and this

513
00:25:34,620 --> 00:25:47,449
application is used to manage your phone

514
00:25:38,330 --> 00:25:47,449
by your company so how does it work if

515
00:25:51,920 --> 00:25:57,270
you would see to be on the whole on MDM

516
00:25:54,690 --> 00:26:02,250
on Apple you need a lot of click but

517
00:25:57,270 --> 00:26:05,129
when I say a lot it's a lot yeah URL be

518
00:26:02,250 --> 00:26:09,510
careful you see I really want to change

519
00:26:05,130 --> 00:26:11,520
your configuration after you have the

520
00:26:09,510 --> 00:26:13,790
certificate you say ok I want to trust

521
00:26:11,520 --> 00:26:18,090
this certificate I want to install it

522
00:26:13,790 --> 00:26:21,300
yeah so I think for the moment it's four

523
00:26:18,090 --> 00:26:28,520
or five click and a six week later you

524
00:26:21,300 --> 00:26:32,399
are on all on the MDM so in our case we

525
00:26:28,520 --> 00:26:38,120
assume that the attacker had a physical

526
00:26:32,400 --> 00:26:40,950
access to the device of the targets I

527
00:26:38,120 --> 00:26:43,949
can't really explain how but we have

528
00:26:40,950 --> 00:26:46,029
some clue that the attacker had access

529
00:26:43,950 --> 00:26:48,190
to the device had been cut and

530
00:26:46,029 --> 00:26:51,399
was able to indulge the people because

531
00:26:48,190 --> 00:26:56,669
finally it's five-click but its 32nd so

532
00:26:51,399 --> 00:26:58,629
you can easily on all someone on on it

533
00:26:56,669 --> 00:27:04,179
something very interesting

534
00:26:58,629 --> 00:27:06,580
so Apple didn't implement a way to

535
00:27:04,179 --> 00:27:08,499
remove application so basically if your

536
00:27:06,580 --> 00:27:10,299
company doesn't like this

537
00:27:08,499 --> 00:27:12,489
chat application you have on your phone

538
00:27:10,299 --> 00:27:14,229
it's technically impossible for your

539
00:27:12,489 --> 00:27:17,440
company to remove this application if

540
00:27:14,229 --> 00:27:17,979
it's done load from the star it's your

541
00:27:17,440 --> 00:27:19,330
choice

542
00:27:17,979 --> 00:27:22,599
your company cannot remove this

543
00:27:19,330 --> 00:27:26,080
application in our case what was the

544
00:27:22,599 --> 00:27:29,320
goal of of the attackers it was to

545
00:27:26,080 --> 00:27:30,129
install fake chat application for

546
00:27:29,320 --> 00:27:33,549
example what's up

547
00:27:30,129 --> 00:27:41,968
so the attackers deployed a fake website

548
00:27:33,549 --> 00:27:41,969
whatsapp on the phone so one second

549
00:27:42,749 --> 00:27:51,909
so the MGM asked the phone I want to

550
00:27:46,359 --> 00:27:54,509
deploy an application and finally the

551
00:27:51,909 --> 00:28:00,119
application will appear on your phone

552
00:27:54,509 --> 00:28:03,339
it's downloading and there we go

553
00:28:00,119 --> 00:28:05,439
you've got to whatsapp the real one from

554
00:28:03,339 --> 00:28:08,769
the stuff and the fake one from the

555
00:28:05,440 --> 00:28:10,690
malicious MDM the attackers is not able

556
00:28:08,769 --> 00:28:12,909
to remove the legitimate application

557
00:28:10,690 --> 00:28:15,429
because it come from the store and it

558
00:28:12,909 --> 00:28:16,570
doesn't have any power against the

559
00:28:15,429 --> 00:28:19,299
system

560
00:28:16,570 --> 00:28:21,789
how is the attackers force the users to

561
00:28:19,299 --> 00:28:27,309
use the malicious application and does

562
00:28:21,789 --> 00:28:32,440
not use the real one here is you have

563
00:28:27,309 --> 00:28:42,099
two words app application and I got

564
00:28:32,440 --> 00:28:45,940
normally a refresh of my screen mm-hmm

565
00:28:42,099 --> 00:28:48,609
yeah and if I come back I only have one

566
00:28:45,940 --> 00:28:50,919
application how the attackers do that

567
00:28:48,609 --> 00:28:56,189
one of the feature provided by a pair on

568
00:28:50,919 --> 00:28:59,139
MDM is you can set age restriction and

569
00:28:56,190 --> 00:28:59,710
in our case the attacker said okay is

570
00:28:59,139 --> 00:29:02,830
this for

571
00:28:59,710 --> 00:29:05,140
is limited at 9 years old what's up it's

572
00:29:02,830 --> 00:29:06,639
12 says the application disappear but

573
00:29:05,140 --> 00:29:09,160
the fake application developed by the

574
00:29:06,640 --> 00:29:11,350
guy but guys doesn't have any age

575
00:29:09,160 --> 00:29:14,290
restriction so the only application that

576
00:29:11,350 --> 00:29:18,159
stay on your phone visually is a fake

577
00:29:14,290 --> 00:29:20,110
application but the real one is is

578
00:29:18,160 --> 00:29:21,520
installed it doesn't remove it but you

579
00:29:20,110 --> 00:29:24,070
cannot open it anymore

580
00:29:21,520 --> 00:29:28,600
so that's how in this specific campaign

581
00:29:24,070 --> 00:29:30,250
see Atticus remove remove legitimate

582
00:29:28,600 --> 00:29:32,429
whatsapp and that only is a fake

583
00:29:30,250 --> 00:29:44,230
whatsapp running

584
00:29:32,430 --> 00:29:47,740
yeah just for the curious you can see

585
00:29:44,230 --> 00:29:55,480
here how you can check your profile on

586
00:29:47,740 --> 00:29:57,280
your phone y'all got one hour so yeah

587
00:29:55,480 --> 00:30:12,130
here you can see I'm on all on this

588
00:29:57,280 --> 00:30:14,860
specific MDM and if I click on it on the

589
00:30:12,130 --> 00:30:18,110
video is there is a lot of blah blah

590
00:30:14,860 --> 00:30:18,110
[Music]

591
00:30:21,000 --> 00:30:28,780
yeah so you can see the malicious of the

592
00:30:25,450 --> 00:30:31,060
MDM so maybe a legitimate one maybe a

593
00:30:28,780 --> 00:30:32,920
malicious one and you can see apps with

594
00:30:31,060 --> 00:30:36,909
the number one I've got a whatsapp

595
00:30:32,920 --> 00:30:39,610
installed by this specific MDM and if

596
00:30:36,910 --> 00:30:43,330
you check on the restriction you can see

597
00:30:39,610 --> 00:30:47,199
I got upgrade ting on for subscriptions

598
00:30:43,330 --> 00:30:49,659
that means it's age restriction if I go

599
00:30:47,200 --> 00:30:53,560
on on the restriction menu I can see

600
00:30:49,660 --> 00:30:58,900
it's limited to application lower than

601
00:30:53,560 --> 00:31:04,510
nine years old just here you can see

602
00:30:58,900 --> 00:31:06,430
apps 9 so every application for more

603
00:31:04,510 --> 00:31:09,340
than nine years or will disappear from

604
00:31:06,430 --> 00:31:13,140
your phone basically yeah that's how

605
00:31:09,340 --> 00:31:13,139
easy Atticus this

606
00:31:13,500 --> 00:31:19,960
okay another word deploy application if

607
00:31:16,870 --> 00:31:23,020
you're really rich you can have zero day

608
00:31:19,960 --> 00:31:27,190
of course the hot German and and use

609
00:31:23,020 --> 00:31:29,530
your money to do so but on the case I

610
00:31:27,190 --> 00:31:31,780
work on these it didn't need that they

611
00:31:29,530 --> 00:31:33,610
simply have access or do such

612
00:31:31,780 --> 00:31:36,010
engineering or whatever but they don't

613
00:31:33,610 --> 00:31:41,500
have to spend a lot of money on on zero

614
00:31:36,010 --> 00:31:43,180
day and magic stuff so no I speak about

615
00:31:41,500 --> 00:31:44,530
deployment I'm going to show you a

616
00:31:43,180 --> 00:31:49,150
little bit how works the man where I

617
00:31:44,530 --> 00:31:53,560
work on these investigations so first

618
00:31:49,150 --> 00:31:56,440
thing some application can be encrypted

619
00:31:53,560 --> 00:32:01,649
so it's provided by Apple

620
00:31:56,440 --> 00:32:05,410
it's the GIM stuff but if your device is

621
00:32:01,650 --> 00:32:07,030
shared walking you can use bf inject to

622
00:32:05,410 --> 00:32:08,740
decrypt application so basically it's

623
00:32:07,030 --> 00:32:10,720
encrypted but it's decrypted in memory

624
00:32:08,740 --> 00:32:14,050
we have injected the memory don't

625
00:32:10,720 --> 00:32:16,000
extract the unpacked decrypted

626
00:32:14,050 --> 00:32:20,950
application and you can analyze it so

627
00:32:16,000 --> 00:32:23,650
it's never an issue to be honest so here

628
00:32:20,950 --> 00:32:25,660
is a free common techniques I saw last

629
00:32:23,650 --> 00:32:28,090
year the first one is the library in the

630
00:32:25,660 --> 00:32:30,580
injection I will show you exactly what

631
00:32:28,090 --> 00:32:33,429
it is so second one is a web people with

632
00:32:30,580 --> 00:32:36,850
WebKit interception in this case the

633
00:32:33,430 --> 00:32:40,150
attackers add JavaScript inside of web

634
00:32:36,850 --> 00:32:43,060
page and intercept in JavaScript what

635
00:32:40,150 --> 00:32:44,590
you are doing and the last one I will

636
00:32:43,060 --> 00:32:46,810
show you how works keylogger

637
00:32:44,590 --> 00:32:50,080
on on my phone because you can develop

638
00:32:46,810 --> 00:32:52,290
kilogram for iPhone so the library

639
00:32:50,080 --> 00:32:55,810
injection basically you take an app and

640
00:32:52,290 --> 00:32:58,000
you have compiled it with your own

641
00:32:55,810 --> 00:33:00,040
library and this library will be

642
00:32:58,000 --> 00:33:02,490
injected in the app and you put some

643
00:33:00,040 --> 00:33:06,399
hook on this function you want to

644
00:33:02,490 --> 00:33:08,170
intercept to get value for example

645
00:33:06,400 --> 00:33:10,030
that's what happened on the fake

646
00:33:08,170 --> 00:33:12,010
whatsapp application as you can imagine

647
00:33:10,030 --> 00:33:14,560
the developer didn't develop whatsapp

648
00:33:12,010 --> 00:33:16,810
from scratch he took the application

649
00:33:14,560 --> 00:33:20,700
used the library injection inject his

650
00:33:16,810 --> 00:33:23,310
god inside of the whatsapp application

651
00:33:20,700 --> 00:33:26,100
on several function to be able to get

652
00:33:23,310 --> 00:33:27,780
your contact because whatsapp have the

653
00:33:26,100 --> 00:33:31,020
whatsapp application have access to your

654
00:33:27,780 --> 00:33:33,120
contact get your chat history your

655
00:33:31,020 --> 00:33:34,770
pictures because what's up you can share

656
00:33:33,120 --> 00:33:36,840
picture so if you are low what's up to

657
00:33:34,770 --> 00:33:38,850
share picture the attackers have access

658
00:33:36,840 --> 00:33:40,470
because he's inside of the application

659
00:33:38,850 --> 00:33:44,310
so if you already application you allow

660
00:33:40,470 --> 00:33:46,200
some malicious code to get the data he

661
00:33:44,310 --> 00:33:54,120
was able to get information on you your

662
00:33:46,200 --> 00:33:57,900
phone number etc it seems to be useless

663
00:33:54,120 --> 00:34:00,330
to support injection like that but today

664
00:33:57,900 --> 00:34:03,510
Apple support it and it's used massively

665
00:34:00,330 --> 00:34:05,100
by the tweak community so it's basically

666
00:34:03,510 --> 00:34:08,909
people that modified legitimate

667
00:34:05,100 --> 00:34:11,670
application to add features I spend a

668
00:34:08,909 --> 00:34:16,350
lot of time looking at the application

669
00:34:11,670 --> 00:34:19,680
from a lot of tweak community forum and

670
00:34:16,350 --> 00:34:22,560
stuff like that all the time it's really

671
00:34:19,679 --> 00:34:24,659
it's not malicious all the application I

672
00:34:22,560 --> 00:34:27,779
analyzed from this community simply add

673
00:34:24,659 --> 00:34:30,270
feature cuz I don't know you have a chat

674
00:34:27,780 --> 00:34:32,250
application that does not support gif so

675
00:34:30,270 --> 00:34:36,170
they tweak the application to support

676
00:34:32,250 --> 00:34:40,290
gif what's up you can only have one

677
00:34:36,170 --> 00:34:42,990
account on whatsapp is based on your SIM

678
00:34:40,290 --> 00:34:45,480
card so you can only have one account

679
00:34:42,989 --> 00:34:47,129
and I so tweak application of whatsapp

680
00:34:45,480 --> 00:34:49,139
that she brought to account with the tab

681
00:34:47,130 --> 00:34:52,980
so you can use two different account

682
00:34:49,139 --> 00:34:56,730
extra so it's legit they simply tweak

683
00:34:52,980 --> 00:34:59,400
application so it's more or less like

684
00:34:56,730 --> 00:35:04,200
elda Libre I pass on online nooks but

685
00:34:59,400 --> 00:35:07,710
yeah they simply modify application yeah

686
00:35:04,200 --> 00:35:11,310
it's exactly what I said the other

687
00:35:07,710 --> 00:35:14,250
approach is a web keep in reception so

688
00:35:11,310 --> 00:35:16,980
in this case I had an application it was

689
00:35:14,250 --> 00:35:20,540
a fake Instagram and you need to log on

690
00:35:16,980 --> 00:35:24,930
Instagram so the application perform

691
00:35:20,540 --> 00:35:27,660
HTTP request to the Instagram web server

692
00:35:24,930 --> 00:35:31,350
display the Instagram authentication

693
00:35:27,660 --> 00:35:33,348
page it was a real page from Instagram

694
00:35:31,350 --> 00:35:39,319
but the attackers had

695
00:35:33,349 --> 00:35:41,150
javascript and basically a WebKit event

696
00:35:39,319 --> 00:35:44,180
so when you click on the button when you

697
00:35:41,150 --> 00:35:46,579
want to log on Instagram and event is

698
00:35:44,180 --> 00:35:49,578
tagged and your application takes a

699
00:35:46,579 --> 00:35:52,329
control and take the parameters and to

700
00:35:49,579 --> 00:35:53,839
Instagram so it will be easy

701
00:35:52,329 --> 00:35:56,209
straightforward

702
00:35:53,839 --> 00:35:58,999
it's simply code injection JavaScript

703
00:35:56,209 --> 00:36:01,578
injection when you display web page and

704
00:35:58,999 --> 00:36:03,709
in this case the purpose was to state

705
00:36:01,579 --> 00:36:05,539
current shell from from the users so

706
00:36:03,709 --> 00:36:10,669
they get user name password when you

707
00:36:05,539 --> 00:36:14,779
first connect on Instagram the last one

708
00:36:10,670 --> 00:36:17,420
is a feature I don't really know why is

709
00:36:14,779 --> 00:36:22,369
it provides this feature but you can

710
00:36:17,420 --> 00:36:24,949
develop Tristram keyboard on on on iOS

711
00:36:22,369 --> 00:36:27,109
so you can say I don't want to use the

712
00:36:24,949 --> 00:36:29,449
legitimate keyboard cause you know it's

713
00:36:27,109 --> 00:36:32,239
it's bad keyboard so I'm going to create

714
00:36:29,449 --> 00:36:34,339
my own key bond here is an example of

715
00:36:32,239 --> 00:36:41,059
custom cable is custom I add a stylish

716
00:36:34,339 --> 00:36:46,308
here our and you can see each time

717
00:36:41,059 --> 00:36:48,109
I click on someone touch it appear on on

718
00:36:46,309 --> 00:36:49,670
the other application here so it's

719
00:36:48,109 --> 00:36:55,519
basically a keylogger based on like

720
00:36:49,670 --> 00:36:58,699
christum keyboard so i did a good job

721
00:36:55,519 --> 00:37:02,118
concerning this point because typically

722
00:36:58,699 --> 00:37:05,299
if you develop a custom keyboard and you

723
00:37:02,119 --> 00:37:07,009
use the network API basically you send

724
00:37:05,299 --> 00:37:08,809
information on the internet based on the

725
00:37:07,009 --> 00:37:10,969
keyboard it would be automatically

726
00:37:08,809 --> 00:37:14,660
reject from the stop so it's impossible

727
00:37:10,969 --> 00:37:16,549
to push a custom keyboard with network

728
00:37:14,660 --> 00:37:18,649
activities on the store but you can use

729
00:37:16,549 --> 00:37:21,079
it on your MDM because there is no

730
00:37:18,650 --> 00:37:25,009
control from app and in this case

731
00:37:21,079 --> 00:37:27,440
another clever stuff by Apple is the

732
00:37:25,009 --> 00:37:29,989
custom keyboard you can use it but if

733
00:37:27,440 --> 00:37:33,170
you enter password on the password field

734
00:37:29,989 --> 00:37:34,999
on a web application automatically the

735
00:37:33,170 --> 00:37:37,789
Christian keyboard disappear and it's a

736
00:37:34,999 --> 00:37:40,430
real keyboard you type your password and

737
00:37:37,789 --> 00:37:42,650
if you go on another field the custom

738
00:37:40,430 --> 00:37:45,169
keyboard reappear so they can't still

739
00:37:42,650 --> 00:37:46,970
password with this stuff

740
00:37:45,170 --> 00:37:48,800
but you can see your distribution

741
00:37:46,970 --> 00:37:50,330
on whatsapp it depend of the purpose of

742
00:37:48,800 --> 00:37:52,400
of the attackers in this case it was

743
00:37:50,330 --> 00:37:55,940
clearly not to steal password it was to

744
00:37:52,400 --> 00:37:58,780
spy users and get get detail about

745
00:37:55,940 --> 00:38:04,640
discussion with some other people

746
00:37:58,780 --> 00:38:07,510
so yeah conclusion so as I said I

747
00:38:04,640 --> 00:38:11,330
touched my first iPhone nine months ago

748
00:38:07,510 --> 00:38:13,700
so it was a completely new domain for me

749
00:38:11,330 --> 00:38:15,529
I didn't know it works I'd never dare

750
00:38:13,700 --> 00:38:17,810
microphone accessory so I'd need to

751
00:38:15,530 --> 00:38:20,330
spend a lot of time there is a lot of

752
00:38:17,810 --> 00:38:22,160
documentation about share bike and

753
00:38:20,330 --> 00:38:24,290
vulnerability and stuff like that and

754
00:38:22,160 --> 00:38:26,810
they make a really crazy job and amazing

755
00:38:24,290 --> 00:38:30,529
work but it doesn't really help for fine

756
00:38:26,810 --> 00:38:32,390
thick or for malware analysis and there

757
00:38:30,530 --> 00:38:34,910
is not a lot of documentation not a lot

758
00:38:32,390 --> 00:38:38,029
of case to be honest it's not so common

759
00:38:34,910 --> 00:38:39,440
to have iOS malware we had to work on

760
00:38:38,030 --> 00:38:41,870
the first case it was a little bit

761
00:38:39,440 --> 00:38:43,400
magnetic so a lot of other people arrive

762
00:38:41,870 --> 00:38:47,330
and say oh maybe I've got something and

763
00:38:43,400 --> 00:38:49,940
we we start to work like that it's more

764
00:38:47,330 --> 00:38:52,370
snowball effect than something else so

765
00:38:49,940 --> 00:38:56,060
it's not something massive and as we can

766
00:38:52,370 --> 00:38:59,170
see on annoyed the market for example I

767
00:38:56,060 --> 00:39:02,270
can make did a lot of work on security

768
00:38:59,170 --> 00:39:05,330
for users but in our case it generate

769
00:39:02,270 --> 00:39:07,400
issue for our work but the goal is

770
00:39:05,330 --> 00:39:10,730
clearly not to help me but to protect

771
00:39:07,400 --> 00:39:12,710
stuff so but but they were already

772
00:39:10,730 --> 00:39:16,160
really nice we work with them without

773
00:39:12,710 --> 00:39:18,560
big issue they typically blacklist

774
00:39:16,160 --> 00:39:20,480
developers certificate once we share the

775
00:39:18,560 --> 00:39:22,520
sample and show you a look it's my shirt

776
00:39:20,480 --> 00:39:24,530
is doing that extra so they revoke

777
00:39:22,520 --> 00:39:29,480
certificate of the bad guys pretty

778
00:39:24,530 --> 00:39:32,920
quickly and and finally it was a nice

779
00:39:29,480 --> 00:39:37,160
journey on on iOS malware and malicious

780
00:39:32,920 --> 00:39:41,660
MDM so if you have question I think we

781
00:39:37,160 --> 00:39:43,490
have few minutes and if you are shy and

782
00:39:41,660 --> 00:39:48,859
you want to speak outside I will stay

783
00:39:43,490 --> 00:39:51,339
here so no big deal let's give another

784
00:39:48,860 --> 00:39:51,340
place

785
00:39:53,350 --> 00:39:57,259
[Applause]

786
00:40:03,660 --> 00:40:10,390
yes sir the question about the MTM the

787
00:40:06,760 --> 00:40:13,600
MD way way to inject malware once you

788
00:40:10,390 --> 00:40:15,009
fool the user to you to pick up I don't

789
00:40:13,600 --> 00:40:18,210
know like your company and companies

790
00:40:15,010 --> 00:40:22,930
tell us so if you get at a loose MDM

791
00:40:18,210 --> 00:40:25,270
then it's it's jackpot meaning yeah

792
00:40:22,930 --> 00:40:26,919
they control sir Apple control strictly

793
00:40:25,270 --> 00:40:28,150
the applications but in the MDM they

794
00:40:26,920 --> 00:40:31,360
have no way too young

795
00:40:28,150 --> 00:40:33,700
yeah if if fanáticos controls the MDM of

796
00:40:31,360 --> 00:40:37,540
your company yeah yeah you will spend

797
00:40:33,700 --> 00:40:41,290
but this because yeah yeah he has a

798
00:40:37,540 --> 00:40:43,870
control of all your devices but there

799
00:40:41,290 --> 00:40:46,960
was not a question if the attacker fools

800
00:40:43,870 --> 00:40:51,160
oh yeah but into download in MDM that

801
00:40:46,960 --> 00:40:53,680
looks like but in this case it's a

802
00:40:51,160 --> 00:40:55,390
engineering so yeah he can try to looks

803
00:40:53,680 --> 00:41:00,609
like your company of the fact that of

804
00:40:55,390 --> 00:41:03,970
course it's possible I I think your

805
00:41:00,610 --> 00:41:06,490
company can list your profile so it's

806
00:41:03,970 --> 00:41:08,290
I'm not sure what I'm saying just right

807
00:41:06,490 --> 00:41:10,479
now but I think your company if you are

808
00:41:08,290 --> 00:41:13,029
on the whole on and MDM is able to check

809
00:41:10,480 --> 00:41:15,220
if there is other MDM that manager phone

810
00:41:13,030 --> 00:41:23,170
cause you can be managed by several MDM

811
00:41:15,220 --> 00:41:25,060
it's reported furthermore but yeah but

812
00:41:23,170 --> 00:41:30,180
from an ethical point of view targeting

813
00:41:25,060 --> 00:41:30,180
MDM infrastructure is pretty interesting

814
00:41:33,180 --> 00:41:44,460
other questions yeah so thank you

815
00:41:42,350 --> 00:41:46,520
[Applause]

816
00:41:44,460 --> 00:41:46,520
you

