1
00:00:17,460 --> 00:00:22,890
<font color="#E5E5E5">okay so we're going to really cover more</font>

2
00:00:20,519 --> 00:00:23,788
about real mobile hacking and I'm so I'm

3
00:00:22,890 --> 00:00:26,640
going to kind of run through a few

4
00:00:23,789 --> 00:00:28,140
things first it's just understanding a

5
00:00:26,640 --> 00:00:31,410
little bit about how to get set up doing

6
00:00:28,140 --> 00:00:33,780
mobile hacking most people are really

7
00:00:31,410 --> 00:00:35,010
focused well so what I'll do is I'm

8
00:00:33,780 --> 00:00:36,300
going to<font color="#E5E5E5"> run through some basics and</font>

9
00:00:35,010 --> 00:00:40,079
then I'm<font color="#E5E5E5"> going to go through these what</font>

10
00:00:36,300 --> 00:00:41,940
I call these seven deadly sins on<font color="#E5E5E5"> the</font>

11
00:00:40,079 --> 00:00:44,100
mistakes that most mobile app developers

12
00:00:41,940 --> 00:00:46,079
are making and then go through some

13
00:00:44,100 --> 00:00:48,809
example hacks that I found I kind<font color="#CCCCCC"> of</font>

14
00:00:46,079 --> 00:00:52,530
play with the ideas of<font color="#E5E5E5"> the seven</font><font color="#CCCCCC"> deadly</font>

15
00:00:48,809 --> 00:00:56,968
sins so first thing with mobile hacking

16
00:00:52,530 --> 00:00:59,190
is generally step one is to look beyond

17
00:00:56,969 --> 00:01:02,190
the device in your hand most people are

18
00:00:59,190 --> 00:01:04,319
really focused on the mobile apps on the

19
00:01:02,190 --> 00:01:06,149
device itself there's some great talks

20
00:01:04,319 --> 00:01:10,408
about<font color="#CCCCCC"> them and all the things</font><font color="#E5E5E5"> you can</font>

21
00:01:06,149 --> 00:01:12,780
extract from the apps that's all fun but

22
00:01:10,409 --> 00:01:15,539
to me really<font color="#E5E5E5"> that the real treasure</font>

23
00:01:12,780 --> 00:01:18,750
trove is behind the<font color="#CCCCCC"> scenes where these</font>

24
00:01:15,539 --> 00:01:20,520
apps are talking to their their<font color="#E5E5E5"> back-end</font>

25
00:01:18,750 --> 00:01:22,890
right the mobile app is usually just a

26
00:01:20,520 --> 00:01:24,949
little shell to go off and get real data

27
00:01:22,890 --> 00:01:26,850
off<font color="#CCCCCC"> the back end that's what I play with</font>

28
00:01:24,950 --> 00:01:28,979
so we're<font color="#E5E5E5"> going to understand how to</font>

29
00:01:26,850 --> 00:01:31,559
start<font color="#CCCCCC"> collecting traffic we're going to</font>

30
00:01:28,979 --> 00:01:34,500
<font color="#E5E5E5">go through</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> process of understanding</font>

31
00:01:31,560 --> 00:01:36,869
what the<font color="#CCCCCC"> format's look like and</font><font color="#E5E5E5"> then</font>

32
00:01:34,500 --> 00:01:39,960
<font color="#E5E5E5">we'll start hacking and I'll show you</font>

33
00:01:36,869 --> 00:01:42,420
<font color="#CCCCCC">what I've done there first up they start</font>

34
00:01:39,960 --> 00:01:44,280
getting data<font color="#E5E5E5"> okay we have to first start</font>

35
00:01:42,420 --> 00:01:46,530
to understand how to grab the mobile

36
00:01:44,280 --> 00:01:49,200
data you don't need<font color="#E5E5E5"> a lot of expensive</font>

37
00:01:46,530 --> 00:01:51,960
equipment generally<font color="#E5E5E5"> what I do is I will</font>

38
00:01:49,200 --> 00:01:54,270
take my laptop I'll take an internet

39
00:01:51,960 --> 00:01:55,890
internet connection what I'll do<font color="#CCCCCC"> is I'll</font>

40
00:01:54,270 --> 00:01:58,979
actually take this I go mobile with this

41
00:01:55,890 --> 00:02:01,079
so I'll bring my little you know a

42
00:01:58,979 --> 00:02:03,240
little t mobile hotspot here so<font color="#E5E5E5"> I can</font>

43
00:02:01,079 --> 00:02:07,469
have some internet access take my laptop

44
00:02:03,240 --> 00:02:09,090
I got<font color="#CCCCCC"> a Wi-Fi pineapple if you haven't</font>

45
00:02:07,469 --> 00:02:11,549
had if<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> one of these it's</font>

46
00:02:09,090 --> 00:02:14,160
worth 100 dollar investment<font color="#E5E5E5"> okay very</font>

47
00:02:11,549 --> 00:02:16,950
cheap little device this little<font color="#E5E5E5"> guy here</font>

48
00:02:14,160 --> 00:02:20,280
very portable and it basically allows

49
00:02:16,950 --> 00:02:23,190
you to create a hotspot ok so<font color="#E5E5E5"> I'll set</font>

50
00:02:20,280 --> 00:02:25,829
all this up and i'll have<font color="#E5E5E5"> it start</font>

51
00:02:23,190 --> 00:02:27,359
broadcasting as like a TTYL fine it can

52
00:02:25,829 --> 00:02:30,240
it can broadcast as whatever<font color="#E5E5E5"> you want</font>

53
00:02:27,359 --> 00:02:32,550
give it a CID it also has a feat

54
00:02:30,240 --> 00:02:35,100
sure that is really handy called karma

55
00:02:32,550 --> 00:02:38,700
mode which allows it to<font color="#E5E5E5"> listen for</font>

56
00:02:35,100 --> 00:02:40,049
probes<font color="#E5E5E5"> of you know any kind of Wi-Fi</font>

57
00:02:38,700 --> 00:02:42,329
device so it's looking for their home

58
00:02:40,050 --> 00:02:44,700
network or whatever it'll see those and

59
00:02:42,330 --> 00:02:47,570
it will answer and say sure that's<font color="#E5E5E5"> me</font>

60
00:02:44,700 --> 00:02:49,769
and<font color="#E5E5E5"> if it's an unencrypted Wi-Fi</font>

61
00:02:47,570 --> 00:02:52,380
connection then all sudden you've<font color="#CCCCCC"> got</font>

62
00:02:49,770 --> 00:02:56,490
them paired up<font color="#CCCCCC"> ok I'll do</font><font color="#E5E5E5"> this I'll set</font>

63
00:02:52,380 --> 00:02:57,990
this up at the mall<font color="#E5E5E5"> ok and I'll just sit</font>

64
00:02:56,490 --> 00:03:00,060
<font color="#CCCCCC">down you know in a corner somewhere</font>

65
00:02:57,990 --> 00:03:01,560
somewhere you know actually usually like

66
00:03:00,060 --> 00:03:04,110
in the<font color="#E5E5E5"> middle of the mall I'll set up my</font>

67
00:03:01,560 --> 00:03:05,910
laptop got my Wi-Fi pineapple my mobile

68
00:03:04,110 --> 00:03:10,020
hotspot I'll start providing real

69
00:03:05,910 --> 00:03:12,000
internet access ok and I'll sit there

70
00:03:10,020 --> 00:03:14,100
I'll<font color="#CCCCCC"> come back to this so I'll sit there</font>

71
00:03:12,000 --> 00:03:16,860
in the mall set up real internet access

72
00:03:14,100 --> 00:03:18,390
and all kinds of devices start

73
00:03:16,860 --> 00:03:20,970
connecting to me there's all these

74
00:03:18,390 --> 00:03:24,359
devices in women's purses guys pockets

75
00:03:20,970 --> 00:03:25,890
whatever mobile phones iPads all sorts

76
00:03:24,360 --> 00:03:28,380
of things also they've got a live

77
00:03:25,890 --> 00:03:30,869
connection right here at the mall mobile

78
00:03:28,380 --> 00:03:33,269
network sometimes a little spotty most

79
00:03:30,870 --> 00:03:35,460
<font color="#CCCCCC">devices are set up to prioritize traffic</font>

80
00:03:33,270 --> 00:03:37,170
over Wi-Fi once connected right does

81
00:03:35,460 --> 00:03:40,200
they want to get<font color="#E5E5E5"> the traffic off the</font>

82
00:03:37,170 --> 00:03:41,670
mobile network so all of a sudden I've

83
00:03:40,200 --> 00:03:43,200
got all these devices connected to me

84
00:03:41,670 --> 00:03:45,209
they're<font color="#E5E5E5"> going off and doing whatever</font>

85
00:03:43,200 --> 00:03:47,880
they're supposed to do i'm now watching

86
00:03:45,210 --> 00:03:49,410
all that traffic<font color="#E5E5E5"> ok going back to my</font>

87
00:03:47,880 --> 00:03:52,680
<font color="#E5E5E5">setup i'll be running something like</font>

88
00:03:49,410 --> 00:03:55,070
burp suite on my laptop and I'll route

89
00:03:52,680 --> 00:03:58,080
all of the traffic you know do some

90
00:03:55,070 --> 00:03:59,760
commands<font color="#E5E5E5"> to you know basically a simple</font>

91
00:03:58,080 --> 00:04:01,800
port<font color="#E5E5E5"> forwarder right to go through my</font>

92
00:03:59,760 --> 00:04:04,320
Burt proxy on my laptop and I can start

93
00:04:01,800 --> 00:04:06,540
<font color="#E5E5E5">seeing all of their traffic and just</font>

94
00:04:04,320 --> 00:04:09,359
simply having it record in<font color="#CCCCCC"> burb I can</font>

95
00:04:06,540 --> 00:04:11,579
save this play with it later very easy

96
00:04:09,360 --> 00:04:14,370
to get this<font color="#CCCCCC"> setup you don't have to get</font>

97
00:04:11,580 --> 00:04:15,300
a<font color="#CCCCCC"> you know a rogue cell tower type of</font>

98
00:04:14,370 --> 00:04:18,239
thing you're not to spend a couple

99
00:04:15,300 --> 00:04:21,030
thousand dollars to do that<font color="#CCCCCC"> $100 with</font>

100
00:04:18,238 --> 00:04:22,409
the pineapple works so then you have to

101
00:04:21,029 --> 00:04:25,770
start understanding what you're looking

102
00:04:22,410 --> 00:04:27,720
at most of this<font color="#E5E5E5"> traffic is going to be</font>

103
00:04:25,770 --> 00:04:32,099
one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the various formats that are very</font>

104
00:04:27,720 --> 00:04:34,410
popular you<font color="#E5E5E5"> know we still in web apps</font>

105
00:04:32,100 --> 00:04:36,330
there's always<font color="#E5E5E5"> been these key or name</font>

106
00:04:34,410 --> 00:04:39,630
equal value pairs right key and value

107
00:04:36,330 --> 00:04:43,229
pairs standard language of web apps for

108
00:04:39,630 --> 00:04:43,950
ages that will still be used you know

109
00:04:43,229 --> 00:04:44,789
things

110
00:04:43,950 --> 00:04:46,560
doing simple cross-site scripting

111
00:04:44,790 --> 00:04:48,680
attacks don't<font color="#E5E5E5"> really work that well</font>

112
00:04:46,560 --> 00:04:50,760
<font color="#E5E5E5">because it's being used by a mobile app</font>

113
00:04:48,680 --> 00:04:53,310
but that's really<font color="#E5E5E5"> kind of what we're all</font>

114
00:04:50,760 --> 00:04:55,530
used to write dealing with web apps with

115
00:04:53,310 --> 00:04:58,590
mobile we started dealing with a lot of

116
00:04:55,530 --> 00:05:00,390
other formats you've got some JSON

117
00:04:58,590 --> 00:05:04,049
traffic you've got various rest

118
00:05:00,390 --> 00:05:06,750
interfaces could be XML I'll get<font color="#E5E5E5"> to some</font>

119
00:05:04,050 --> 00:05:08,670
examples<font color="#E5E5E5"> there's a MF this is a for</font>

120
00:05:06,750 --> 00:05:12,420
flash apps so<font color="#E5E5E5"> I'll see</font><font color="#CCCCCC"> that with some</font>

121
00:05:08,670 --> 00:05:15,300
online games so I'm<font color="#CCCCCC"> going to break these</font>

122
00:05:12,420 --> 00:05:18,480
down real quick JSON this was initially

123
00:05:15,300 --> 00:05:20,520
created for<font color="#E5E5E5"> JavaScript or at least it</font>

124
00:05:18,480 --> 00:05:23,700
was used by<font color="#CCCCCC"> javascript developers early</font>

125
00:05:20,520 --> 00:05:25,680
on it is a very<font color="#CCCCCC"> nice format because it's</font>

126
00:05:23,700 --> 00:05:28,170
basically<font color="#E5E5E5"> you know what they call it is</font>

127
00:05:25,680 --> 00:05:30,180
the fat free alternative to xml it still

128
00:05:28,170 --> 00:05:32,850
allows nested data structures complex

129
00:05:30,180 --> 00:05:36,330
data structures to be sent but it's a

130
00:05:32,850 --> 00:05:38,580
<font color="#E5E5E5">lot less fluffy all right XML has you</font>

131
00:05:36,330 --> 00:05:42,539
know all kinds of extra text in there to

132
00:05:38,580 --> 00:05:44,430
kind of open and close tags so<font color="#E5E5E5"> JSON is</font>

133
00:05:42,540 --> 00:05:47,250
really the<font color="#CCCCCC"> most popular that I see out</font>

134
00:05:44,430 --> 00:05:48,840
there again usually you're going to see

135
00:05:47,250 --> 00:05:51,600
it like on the bottom here where it's

136
00:05:48,840 --> 00:05:54,539
one long string but brought you know

137
00:05:51,600 --> 00:05:56,970
expand it out<font color="#CCCCCC"> this is the same JSON</font>

138
00:05:54,540 --> 00:05:59,490
string formatted nicely on top again

139
00:05:56,970 --> 00:06:02,370
very nested data structures could be a

140
00:05:59,490 --> 00:06:04,470
lot of<font color="#E5E5E5"> data in there and it's very</font><font color="#CCCCCC"> handy</font>

141
00:06:02,370 --> 00:06:06,330
to use for mobile apps because it makes

142
00:06:04,470 --> 00:06:08,240
it very<font color="#E5E5E5"> easy for them to take</font><font color="#CCCCCC"> a you know</font>

143
00:06:06,330 --> 00:06:10,200
an array of data and shove it out there

144
00:06:08,240 --> 00:06:13,980
and then on the server it will get

145
00:06:10,200 --> 00:06:15,780
parsed the JSON can be shoved in

146
00:06:13,980 --> 00:06:18,510
different locations it could be actually

147
00:06:15,780 --> 00:06:20,400
the value of a get parameter it could be

148
00:06:18,510 --> 00:06:22,230
shoved into the post data doesn't really

149
00:06:20,400 --> 00:06:24,299
matter they just put it wherever they

150
00:06:22,230 --> 00:06:27,300
want to<font color="#E5E5E5"> put it and deal with it so you</font>

151
00:06:24,300 --> 00:06:29,130
got any comfortable with it rest is the

152
00:06:27,300 --> 00:06:32,280
other one rest is not really a format

153
00:06:29,130 --> 00:06:35,010
per se it's not<font color="#E5E5E5"> a standard it's a style</font>

154
00:06:32,280 --> 00:06:38,489
of building apps json would fit under

155
00:06:35,010 --> 00:06:40,349
the rest model but rest has a lot of

156
00:06:38,490 --> 00:06:41,760
<font color="#CCCCCC">different flavors and this is really</font>

157
00:06:40,350 --> 00:06:43,320
<font color="#CCCCCC">what</font><font color="#E5E5E5"> 10 ends up tripping people up is</font>

158
00:06:41,760 --> 00:06:45,210
they don't understand that<font color="#CCCCCC"> it's you know</font>

159
00:06:43,320 --> 00:06:48,180
if you<font color="#CCCCCC"> just look</font><font color="#E5E5E5"> at it long it's you can</font>

160
00:06:45,210 --> 00:06:50,370
start understanding what to do usually

161
00:06:48,180 --> 00:06:51,600
when you're dealing with rest part of

162
00:06:50,370 --> 00:06:54,540
the goal<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that it's</font><font color="#E5E5E5"> kind of human</font>

163
00:06:51,600 --> 00:06:57,540
readable and it's understandable you

164
00:06:54,540 --> 00:06:59,670
could have URL structures so you know

165
00:06:57,540 --> 00:07:01,830
you may see you know rest searched items

166
00:06:59,670 --> 00:07:03,450
shirt is actually parameter color blue

167
00:07:01,830 --> 00:07:05,990
you know those are<font color="#E5E5E5"> named equal value</font>

168
00:07:03,450 --> 00:07:07,890
pairs structure to look like a directory

169
00:07:05,990 --> 00:07:10,440
so you can have<font color="#E5E5E5"> them in the classic</font>

170
00:07:07,890 --> 00:07:13,380
format it can be sending<font color="#CCCCCC"> XML documents</font>

171
00:07:10,440 --> 00:07:15,600
you could have combinations or it's

172
00:07:13,380 --> 00:07:20,219
sending an XML document and getting<font color="#E5E5E5"> like</font>

173
00:07:15,600 --> 00:07:22,230
a CSV response back you know you could

174
00:07:20,220 --> 00:07:24,540
have<font color="#E5E5E5"> the classic name equal value pair</font>

175
00:07:22,230 --> 00:07:28,040
format in<font color="#CCCCCC"> the request and</font><font color="#E5E5E5"> JSON response</font>

176
00:07:24,540 --> 00:07:30,930
coming back it really doesn't matter

177
00:07:28,040 --> 00:07:33,300
it's again rest is very flexible<font color="#CCCCCC"> in that</font>

178
00:07:30,930 --> 00:07:36,420
way you know<font color="#E5E5E5"> Google web toolkit is also</font>

179
00:07:33,300 --> 00:07:39,240
another restful interface and that has

180
00:07:36,420 --> 00:07:41,430
has like value pipe value pipe it

181
00:07:39,240 --> 00:07:43,050
doesn't have the<font color="#E5E5E5"> keys those are all on</font>

182
00:07:41,430 --> 00:07:45,300
<font color="#CCCCCC">the server side so</font><font color="#E5E5E5"> it's positionally</font>

183
00:07:43,050 --> 00:07:48,270
aware and usually they'll respond with

184
00:07:45,300 --> 00:07:50,490
<font color="#CCCCCC">JSON so as you start to see these</font>

185
00:07:48,270 --> 00:07:52,440
formats you got to get comfortable<font color="#E5E5E5"> with</font>

186
00:07:50,490 --> 00:07:53,760
<font color="#E5E5E5">them because what you end up being able</font>

187
00:07:52,440 --> 00:07:55,260
to do later is really start attacking

188
00:07:53,760 --> 00:07:56,969
them if you can<font color="#E5E5E5"> get comfortable with the</font>

189
00:07:55,260 --> 00:07:59,900
<font color="#E5E5E5">idea that the format is a little</font>

190
00:07:56,970 --> 00:08:04,950
different<font color="#CCCCCC"> amf is a little more</font><font color="#E5E5E5"> difficult</font>

191
00:07:59,900 --> 00:08:08,880
amf is a a binary object that's been

192
00:08:04,950 --> 00:08:11,729
serialized and it's the kind of<font color="#E5E5E5"> for</font>

193
00:08:08,880 --> 00:08:13,890
flash remoting see flash apps it's

194
00:08:11,730 --> 00:08:15,600
<font color="#CCCCCC">usually going to</font><font color="#E5E5E5"> have like the pages</font>

195
00:08:13,890 --> 00:08:18,419
there just to load up the Swift file and

196
00:08:15,600 --> 00:08:20,220
then the<font color="#CCCCCC"> AMF requests are going to start</font>

197
00:08:18,420 --> 00:08:25,050
being sent and those<font color="#E5E5E5"> are all like binary</font>

198
00:08:20,220 --> 00:08:27,750
type of requests<font color="#E5E5E5"> okay this is actually</font>

199
00:08:25,050 --> 00:08:33,419
what kind of led me down this path I was

200
00:08:27,750 --> 00:08:38,789
I was given the call on like<font color="#E5E5E5"> Friday</font>

201
00:08:33,419 --> 00:08:40,348
afternoon a<font color="#E5E5E5"> couple years back and this</font>

202
00:08:38,789 --> 00:08:43,020
customer was trying to run our scan our

203
00:08:40,349 --> 00:08:45,570
<font color="#E5E5E5">scanner against their app we build a web</font>

204
00:08:43,020 --> 00:08:47,310
app scanner so they're trying<font color="#CCCCCC"> to build</font>

205
00:08:45,570 --> 00:08:48,600
it or run the scan and nothing was

206
00:08:47,310 --> 00:08:51,060
happening and they told<font color="#E5E5E5"> me to take a</font>

207
00:08:48,600 --> 00:08:52,620
look<font color="#E5E5E5"> at it so I pull</font><font color="#CCCCCC"> up the site and</font>

208
00:08:51,060 --> 00:08:55,199
basically it's just loading a swift app

209
00:08:52,620 --> 00:08:56,550
right and all<font color="#E5E5E5"> of a</font><font color="#CCCCCC"> sudden there's this</font>

210
00:08:55,200 --> 00:08:59,220
request<font color="#E5E5E5"> being sent and they said okay</font>

211
00:08:56,550 --> 00:09:01,380
<font color="#E5E5E5">well why is your skin or not working so</font>

212
00:08:59,220 --> 00:09:03,240
well our scanner doesn't support you

213
00:09:01,380 --> 00:09:05,520
know amf requests it doesn't deal with

214
00:09:03,240 --> 00:09:06,380
that stuff so<font color="#E5E5E5"> I asked what tool does and</font>

215
00:09:05,520 --> 00:09:07,970
I said I have<font color="#E5E5E5"> no idea</font>

216
00:09:06,380 --> 00:09:13,280
you have to manually do this there's<font color="#E5E5E5"> no</font>

217
00:09:07,970 --> 00:09:16,340
such tool so I started<font color="#E5E5E5"> digging in berk</font>

218
00:09:13,280 --> 00:09:19,490
proxy actually has a decoder for a MF so

219
00:09:16,340 --> 00:09:21,080
<font color="#E5E5E5">I started decoding the requests and it</font>

220
00:09:19,490 --> 00:09:23,180
could<font color="#CCCCCC"> encode it but actually purpose</font>

221
00:09:21,080 --> 00:09:26,390
encoder was broken so I was<font color="#E5E5E5"> having like</font>

222
00:09:23,180 --> 00:09:30,170
I had<font color="#E5E5E5"> to go get a library for creating a</font>

223
00:09:26,390 --> 00:09:31,610
MF requite or packets and manually doing

224
00:09:30,170 --> 00:09:33,680
it but it was a pain<font color="#CCCCCC"> I started looking</font>

225
00:09:31,610 --> 00:09:37,370
and there are still<font color="#E5E5E5"> named equal value</font>

226
00:09:33,680 --> 00:09:38,810
pairs nested in here so i manually

227
00:09:37,370 --> 00:09:40,730
started going in and attacking this app

228
00:09:38,810 --> 00:09:43,339
creating some sequel injection attacks

229
00:09:40,730 --> 00:09:45,890
you know simple ones like we were seeing

230
00:09:43,340 --> 00:09:48,140
<font color="#E5E5E5">in the last talked and it's wide open a</font>

231
00:09:45,890 --> 00:09:50,990
sequel injection the developer<font color="#CCCCCC"> is just</font>

232
00:09:48,140 --> 00:09:53,060
<font color="#E5E5E5">taking the data from the</font><font color="#CCCCCC"> MF requests I</font>

233
00:09:50,990 --> 00:09:56,180
see<font color="#E5E5E5"> this with JSON requests they take</font>

234
00:09:53,060 --> 00:09:58,369
<font color="#CCCCCC">that data and they trust it</font><font color="#E5E5E5"> and so I</font>

235
00:09:56,180 --> 00:10:00,349
<font color="#CCCCCC">ended up seeing the sequel errors i</font>

236
00:09:58,370 --> 00:10:04,150
found that<font color="#E5E5E5"> they were using PHP and</font>

237
00:10:00,350 --> 00:10:07,250
they're<font color="#E5E5E5"> using this PHP amf library and</font>

238
00:10:04,150 --> 00:10:09,530
it was just wide open so the developer

239
00:10:07,250 --> 00:10:11,420
gets on the<font color="#E5E5E5"> phone he ends up jumping on</font>

240
00:10:09,530 --> 00:10:13,699
gotomeeting to show me his code and I

241
00:10:11,420 --> 00:10:15,170
help them<font color="#E5E5E5"> fix it it took like almost</font>

242
00:10:13,700 --> 00:10:18,350
three hours to go through<font color="#CCCCCC"> this entire</font>

243
00:10:15,170 --> 00:10:20,150
process of finding the bones and

244
00:10:18,350 --> 00:10:21,980
actually<font color="#E5E5E5"> having them correct this code</font>

245
00:10:20,150 --> 00:10:23,449
and getting it fixed<font color="#E5E5E5"> and then they went</font>

246
00:10:21,980 --> 00:10:25,580
off and the reason I actually gave him

247
00:10:23,450 --> 00:10:28,160
this much attention was because this was

248
00:10:25,580 --> 00:10:30,770
the feature of their Super Bowl campaign

249
00:10:28,160 --> 00:10:35,150
the following<font color="#CCCCCC"> Sunday they start testing</font>

250
00:10:30,770 --> 00:10:36,620
Friday great so<font color="#CCCCCC"> now you know I got to</font>

251
00:10:35,150 --> 00:10:39,800
<font color="#E5E5E5">watch the game and see the commercials</font>

252
00:10:36,620 --> 00:10:42,170
and got a good laugh out of it but this

253
00:10:39,800 --> 00:10:44,150
<font color="#E5E5E5">I was starting to see this pattern it</font>

254
00:10:42,170 --> 00:10:47,150
was a format that people weren't weren't

255
00:10:44,150 --> 00:10:49,220
used to<font color="#E5E5E5"> but it's just another format for</font>

256
00:10:47,150 --> 00:10:51,860
sending data so that's really<font color="#E5E5E5"> what got</font>

257
00:10:49,220 --> 00:10:53,840
me interested in<font color="#E5E5E5"> going down this path so</font>

258
00:10:51,860 --> 00:10:55,430
given<font color="#CCCCCC"> that this is traffic from words</font>

259
00:10:53,840 --> 00:10:59,450
with friends any idea what format that

260
00:10:55,430 --> 00:11:01,010
is very easy right and you'll notice

261
00:10:59,450 --> 00:11:04,490
<font color="#CCCCCC">this is</font><font color="#E5E5E5"> this is actually just for their</font>

262
00:11:01,010 --> 00:11:06,970
banner ad it sends a ton of data just to

263
00:11:04,490 --> 00:11:12,290
get a banner ad since you know what

264
00:11:06,970 --> 00:11:16,070
carrier i'm using right there what

265
00:11:12,290 --> 00:11:18,760
<font color="#E5E5E5">version of phone I've got what my GPS</font>

266
00:11:16,070 --> 00:11:18,760
coordinates are

267
00:11:18,950 --> 00:11:23,180
it's got all<font color="#CCCCCC"> kinds of information in</font>

268
00:11:20,960 --> 00:11:24,980
there somewhere is the string that this

269
00:11:23,180 --> 00:11:26,989
is a words with friends I put<font color="#E5E5E5"> some words</font>

270
00:11:24,980 --> 00:11:29,630
on the board it actually has<font color="#E5E5E5"> the word in</font>

271
00:11:26,990 --> 00:11:31,010
<font color="#E5E5E5">there somewhere I can't find it now but</font>

272
00:11:29,630 --> 00:11:32,930
they can even<font color="#E5E5E5"> have the banner ad like</font>

273
00:11:31,010 --> 00:11:36,020
context sensitive to what I<font color="#E5E5E5"> just put on</font>

274
00:11:32,930 --> 00:11:40,430
the<font color="#E5E5E5"> board it's crazy but this is what</font>

275
00:11:36,020 --> 00:11:41,780
we're seeing<font color="#CCCCCC"> ok very attackable stuff so</font>

276
00:11:40,430 --> 00:11:43,699
now let's start thinking about how do<font color="#E5E5E5"> we</font>

277
00:11:41,780 --> 00:11:45,829
actually look at these mobile apps and

278
00:11:43,700 --> 00:11:47,720
what I've done is I've looked at ways

279
00:11:45,830 --> 00:11:49,820
that I've broken these apps given that

280
00:11:47,720 --> 00:11:52,640
<font color="#E5E5E5">the format is not a hindrance to me at</font>

281
00:11:49,820 --> 00:11:53,690
all format I can deal with I need to

282
00:11:52,640 --> 00:11:57,020
know how I'm gonna be<font color="#E5E5E5"> able to put my</font>

283
00:11:53,690 --> 00:11:58,100
attack payloads in there so we're gonna

284
00:11:57,020 --> 00:12:00,439
have<font color="#E5E5E5"> to talk a little bit about how</font>

285
00:11:58,100 --> 00:12:04,640
mobile apps deal with session management

286
00:12:00,440 --> 00:12:06,020
and my seven deadly sins here the

287
00:12:04,640 --> 00:12:08,780
problem<font color="#E5E5E5"> I tend to see and it always</font>

288
00:12:06,020 --> 00:12:12,890
starts off as the first one is trusting

289
00:12:08,780 --> 00:12:14,300
the client you know they're getting data

290
00:12:12,890 --> 00:12:17,090
back and forth they just trust the

291
00:12:14,300 --> 00:12:18,560
client always the first problem not

292
00:12:17,090 --> 00:12:20,420
requiring encryption I'll<font color="#E5E5E5"> going to each</font>

293
00:12:18,560 --> 00:12:22,489
of these in detail not<font color="#E5E5E5"> requiring</font>

294
00:12:20,420 --> 00:12:26,030
encryption allowing lifetime sessions

295
00:12:22,490 --> 00:12:27,290
not keeping secrets there's a<font color="#E5E5E5"> reason you</font>

296
00:12:26,030 --> 00:12:31,430
want to<font color="#E5E5E5"> keep secrets from going over the</font>

297
00:12:27,290 --> 00:12:33,260
wire allowing repeat requests not<font color="#E5E5E5"> having</font>

298
00:12:31,430 --> 00:12:34,849
a curfew on these requests and then

299
00:12:33,260 --> 00:12:36,410
failing to prevent altered requests so

300
00:12:34,850 --> 00:12:39,170
let's go<font color="#CCCCCC"> through each</font><font color="#E5E5E5"> one of these first</font>

301
00:12:36,410 --> 00:12:41,959
one trust in the client I said it always

302
00:12:39,170 --> 00:12:45,829
starts here this<font color="#E5E5E5"> is always</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> the core</font>

303
00:12:41,960 --> 00:12:50,150
mistake<font color="#E5E5E5"> especially when we're starting</font>

304
00:12:45,830 --> 00:12:51,500
to see this traffic in new formats this

305
00:12:50,150 --> 00:12:53,480
ends up being the big problem because

306
00:12:51,500 --> 00:12:55,130
they're<font color="#E5E5E5"> just taking you know the JSON</font>

307
00:12:53,480 --> 00:12:57,410
string shoving it through a parser and

308
00:12:55,130 --> 00:12:59,720
it comes out as an array internally or

309
00:12:57,410 --> 00:13:02,060
an object and then they<font color="#E5E5E5"> just use the</font>

310
00:12:59,720 --> 00:13:04,970
data<font color="#CCCCCC"> okay they</font><font color="#E5E5E5"> don't often think that</font>

311
00:13:02,060 --> 00:13:08,839
that could be malicious so this is<font color="#E5E5E5"> one</font>

312
00:13:04,970 --> 00:13:12,260
of<font color="#E5E5E5"> the big keys the next is we're not</font>

313
00:13:08,840 --> 00:13:15,620
requiring encryption it is<font color="#CCCCCC"> scary how few</font>

314
00:13:12,260 --> 00:13:17,480
mobile apps actually use SSL use HTTPS

315
00:13:15,620 --> 00:13:21,770
most of which is going to write over a

316
00:13:17,480 --> 00:13:24,110
port 80 total<font color="#E5E5E5"> plaintext have no idea and</font>

317
00:13:21,770 --> 00:13:25,939
some<font color="#CCCCCC"> of the ones that do use SSL they do</font>

318
00:13:24,110 --> 00:13:28,220
it wrong and that they're not doing any

319
00:13:25,940 --> 00:13:31,130
kind of Sir pinning they don't do any

320
00:13:28,220 --> 00:13:34,460
certificate authority look up and

321
00:13:31,130 --> 00:13:37,760
NE sert will work so like burps you know

322
00:13:34,460 --> 00:13:39,170
ssl cert<font color="#E5E5E5"> it'll accept it just fine</font><font color="#CCCCCC"> all</font>

323
00:13:37,760 --> 00:13:44,240
<font color="#CCCCCC">right most of these</font><font color="#E5E5E5"> apps are not</font>

324
00:13:39,170 --> 00:13:45,589
requiring a valid cert as we're getting

325
00:13:44,240 --> 00:13:47,720
further<font color="#E5E5E5"> along this is getting less and</font>

326
00:13:45,590 --> 00:13:49,670
less<font color="#E5E5E5"> of a problem with people requiring</font>

327
00:13:47,720 --> 00:13:51,080
valid search but even so you can fake

328
00:13:49,670 --> 00:13:52,310
the cert authority if you wanted to

329
00:13:51,080 --> 00:13:56,930
especially if you're sending<font color="#E5E5E5"> their</font>

330
00:13:52,310 --> 00:13:58,939
<font color="#CCCCCC">man-in-the-middle anyway one</font><font color="#E5E5E5"> of the</font>

331
00:13:56,930 --> 00:14:01,160
other keys here that is a problem is

332
00:13:58,940 --> 00:14:03,650
that users<font color="#E5E5E5"> are totally left unaware when</font>

333
00:14:01,160 --> 00:14:04,760
you're dealing with web apps you know

334
00:14:03,650 --> 00:14:06,709
when you're doing what you go with your

335
00:14:04,760 --> 00:14:09,680
web browser go to a site if you're on a

336
00:14:06,710 --> 00:14:12,080
secure site it has the lock icon mobile

337
00:14:09,680 --> 00:14:16,130
apps have no analogous feature so you

338
00:14:12,080 --> 00:14:19,400
<font color="#E5E5E5">have no clue</font><font color="#CCCCCC"> if your app is using you</font>

339
00:14:16,130 --> 00:14:22,370
know https connections or<font color="#CCCCCC"> not so this is</font>

340
00:14:19,400 --> 00:14:25,699
one<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> next problems here the next</font>

341
00:14:22,370 --> 00:14:28,130
one is allowing lifetime sessions this

342
00:14:25,700 --> 00:14:30,080
is a big problem<font color="#CCCCCC"> because mobile apps 10</font>

343
00:14:28,130 --> 00:14:33,110
once you once you get configured you get

344
00:14:30,080 --> 00:14:37,520
your app logged in it rarely ever

345
00:14:33,110 --> 00:14:38,870
expires your session and there's reasons

346
00:14:37,520 --> 00:14:40,550
for this one of the reasons is<font color="#E5E5E5"> that</font>

347
00:14:38,870 --> 00:14:42,260
users kind of expect that they want to

348
00:14:40,550 --> 00:14:43,819
click on the app and have it load up and

349
00:14:42,260 --> 00:14:46,610
do its thing they<font color="#E5E5E5"> don't want to be</font>

350
00:14:43,820 --> 00:14:51,700
prompted for a password every time and

351
00:14:46,610 --> 00:14:54,110
the user and<font color="#E5E5E5"> the you know the phone's</font>

352
00:14:51,700 --> 00:14:55,730
design doesn't really work well for

353
00:14:54,110 --> 00:14:57,950
entering password so it's kind of a pain

354
00:14:55,730 --> 00:15:00,260
<font color="#CCCCCC">to type in</font><font color="#E5E5E5"> into the keyboard you know a</font>

355
00:14:57,950 --> 00:15:02,060
little on-screen keyboard entering

356
00:15:00,260 --> 00:15:04,880
passwords the form factor is terrible

357
00:15:02,060 --> 00:15:06,739
for that<font color="#E5E5E5"> so even if they do require</font><font color="#CCCCCC"> a</font>

358
00:15:04,880 --> 00:15:08,930
password<font color="#E5E5E5"> usually users going to put a</font>

359
00:15:06,740 --> 00:15:13,040
<font color="#E5E5E5">very simple pin like password on there</font>

360
00:15:08,930 --> 00:15:15,170
so<font color="#E5E5E5"> that's another problem this opens us</font>

361
00:15:13,040 --> 00:15:18,260
up to also a scenario where a lot of

362
00:15:15,170 --> 00:15:19,130
apps the way that they you know given

363
00:15:18,260 --> 00:15:21,110
that they're not<font color="#E5E5E5"> going to ever expire</font>

364
00:15:19,130 --> 00:15:24,230
this session anyway I see a<font color="#E5E5E5"> lot of apps</font>

365
00:15:21,110 --> 00:15:27,110
using existing data off the<font color="#E5E5E5"> phone to</font>

366
00:15:24,230 --> 00:15:29,810
identify the the app<font color="#CCCCCC"> and the user they</font>

367
00:15:27,110 --> 00:15:33,140
might use like that mi ye or you know

368
00:15:29,810 --> 00:15:36,650
the imei the ESN whatever they'll use

369
00:15:33,140 --> 00:15:39,199
the phones you know ID itself as a way

370
00:15:36,650 --> 00:15:41,180
to identify that phone again very very

371
00:15:39,200 --> 00:15:42,590
<font color="#E5E5E5">bad practices because they're not going</font>

372
00:15:41,180 --> 00:15:46,670
to they're not dealing<font color="#E5E5E5"> with session man</font>

373
00:15:42,590 --> 00:15:50,930
in any way so the<font color="#E5E5E5"> next one here is not</font>

374
00:15:46,670 --> 00:15:55,599
keeping secrets a lot of<font color="#E5E5E5"> web web app</font>

375
00:15:50,930 --> 00:15:55,599
developers have moved over to mobile and

376
00:15:56,260 --> 00:16:00,220
the problem<font color="#E5E5E5"> I see there is that they've</font>

377
00:15:58,580 --> 00:16:02,450
carried over all the bad practices

378
00:16:00,220 --> 00:16:04,700
everything<font color="#CCCCCC"> that was</font><font color="#E5E5E5"> really a problem</font>

379
00:16:02,450 --> 00:16:06,230
with web apps that were stuck with you

380
00:16:04,700 --> 00:16:07,700
know things<font color="#E5E5E5"> like you know if you have a</font>

381
00:16:06,230 --> 00:16:12,770
session<font color="#E5E5E5"> token' you shove it in a cookie</font>

382
00:16:07,700 --> 00:16:15,290
right and then those<font color="#E5E5E5"> cookies get sent on</font>

383
00:16:12,770 --> 00:16:18,230
every request there's no real place on a

384
00:16:15,290 --> 00:16:19,849
browser to store like secret data that's

385
00:16:18,230 --> 00:16:21,110
never going to<font color="#E5E5E5"> be sent in a request it's</font>

386
00:16:19,850 --> 00:16:24,500
always going back and forth over the

387
00:16:21,110 --> 00:16:25,820
wire that's a that's a problem because

388
00:16:24,500 --> 00:16:28,130
if you have a remand in the middle<font color="#CCCCCC"> you</font>

389
00:16:25,820 --> 00:16:30,530
have everything you need to<font color="#CCCCCC"> take over</font>

390
00:16:28,130 --> 00:16:31,610
<font color="#E5E5E5">that session well mobile apps have an</font>

391
00:16:30,530 --> 00:16:33,980
opportunity to do this<font color="#E5E5E5"> a little</font>

392
00:16:31,610 --> 00:16:36,920
different they can store some something

393
00:16:33,980 --> 00:16:39,770
<font color="#E5E5E5">on the on the mobile device store a you</font>

394
00:16:36,920 --> 00:16:41,630
<font color="#E5E5E5">know a client key you can have kind of</font>

395
00:16:39,770 --> 00:16:44,270
<font color="#E5E5E5">like a private-public quiche you know</font>

396
00:16:41,630 --> 00:16:45,800
pairs whatever you can once you

397
00:16:44,270 --> 00:16:47,449
establish your session you can have

398
00:16:45,800 --> 00:16:49,939
something<font color="#E5E5E5"> that both the server and the</font>

399
00:16:47,450 --> 00:16:52,220
client know but is never ever going to

400
00:16:49,940 --> 00:16:53,660
<font color="#E5E5E5">go over the wire again so any man in the</font>

401
00:16:52,220 --> 00:16:58,010
middle wouldn't have that data to work

402
00:16:53,660 --> 00:16:59,089
from so this allows us to encrypt some

403
00:16:58,010 --> 00:17:03,319
of the request and<font color="#CCCCCC"> I'll get into that</font>

404
00:16:59,090 --> 00:17:04,730
but having something on the client that

405
00:17:03,320 --> 00:17:07,880
<font color="#CCCCCC">you know the client server can kind</font><font color="#E5E5E5"> of</font>

406
00:17:04,730 --> 00:17:12,829
negotiate on is very<font color="#CCCCCC"> valuable and</font><font color="#E5E5E5"> most</font>

407
00:17:07,880 --> 00:17:15,380
apps aren't doing it the next thing is

408
00:17:12,829 --> 00:17:17,119
allowing repeat request so I very easily

409
00:17:15,380 --> 00:17:20,480
been man in the<font color="#E5E5E5"> middle I could see the</font>

410
00:17:17,119 --> 00:17:22,550
request now i can resend them most apps

411
00:17:20,480 --> 00:17:25,490
most<font color="#CCCCCC"> back-end services don't prevent</font>

412
00:17:22,550 --> 00:17:27,980
this so an attacker could easily take a

413
00:17:25,490 --> 00:17:33,050
request and replay it so I was actually

414
00:17:27,980 --> 00:17:35,210
doing<font color="#CCCCCC"> a live demo at RSA of doing some</font>

415
00:17:33,050 --> 00:17:37,760
mobile hacking and I ran into Twitter

416
00:17:35,210 --> 00:17:39,680
seen since some<font color="#E5E5E5"> Twitter traffic going on</font>

417
00:17:37,760 --> 00:17:42,530
and I was able to<font color="#E5E5E5"> see what was you know</font>

418
00:17:39,680 --> 00:17:44,420
what the traffic was and I saw the it

419
00:17:42,530 --> 00:17:47,149
was checking messages and then it

420
00:17:44,420 --> 00:17:49,790
somebody sent out a tweet so actually

421
00:17:47,150 --> 00:17:52,400
<font color="#CCCCCC">we're grab that and burp shoved it into</font>

422
00:17:49,790 --> 00:17:53,520
repeater resent it<font color="#E5E5E5"> and of course</font><font color="#CCCCCC"> the</font>

423
00:17:52,400 --> 00:17:57,300
tweet<font color="#CCCCCC"> worked again</font>

424
00:17:53,520 --> 00:18:00,810
<font color="#E5E5E5">okay so that's annoying I was also able</font>

425
00:17:57,300 --> 00:18:02,520
to their direct messages requests I was

426
00:18:00,810 --> 00:18:04,139
able<font color="#E5E5E5"> to see that and then just</font><font color="#CCCCCC"> keep</font>

427
00:18:02,520 --> 00:18:05,520
resending that keep monitoring their

428
00:18:04,140 --> 00:18:09,300
direct messages for a while<font color="#E5E5E5"> that was</font>

429
00:18:05,520 --> 00:18:10,830
kind of fun just repeating the request

430
00:18:09,300 --> 00:18:13,590
could<font color="#E5E5E5"> be a little bit annoying you know</font>

431
00:18:10,830 --> 00:18:16,020
if<font color="#E5E5E5"> it's Twitter and now the new Twitter</font>

432
00:18:13,590 --> 00:18:18,120
<font color="#E5E5E5">API uses ssl and it's got some other</font>

433
00:18:16,020 --> 00:18:20,820
security mechanisms and they<font color="#E5E5E5"> finally</font>

434
00:18:18,120 --> 00:18:23,399
shut down the old interface but if<font color="#E5E5E5"> it's</font>

435
00:18:20,820 --> 00:18:26,340
Twitter it's annoying if this is a

436
00:18:23,400 --> 00:18:28,020
banking request and it's a like wire

437
00:18:26,340 --> 00:18:29,370
transfer and then i can resend the

438
00:18:28,020 --> 00:18:33,000
transfer that becomes a little more

439
00:18:29,370 --> 00:18:34,949
dangerous right this is easily solvable

440
00:18:33,000 --> 00:18:37,530
with something like a nonce type of

441
00:18:34,950 --> 00:18:40,050
solution where you're sending a in each

442
00:18:37,530 --> 00:18:41,580
request your encode<font color="#E5E5E5"> your tagging it</font>

443
00:18:40,050 --> 00:18:44,730
right you're giving it<font color="#E5E5E5"> a unique number</font>

444
00:18:41,580 --> 00:18:46,080
or value that's in the request and the

445
00:18:44,730 --> 00:18:48,330
server is<font color="#CCCCCC"> going to keep track of those</font>

446
00:18:46,080 --> 00:18:51,000
so that<font color="#E5E5E5"> if you have a resend a request</font>

447
00:18:48,330 --> 00:18:52,320
with the same knots then it would just

448
00:18:51,000 --> 00:18:53,490
<font color="#E5E5E5">immediately reject it because it would</font>

449
00:18:52,320 --> 00:18:56,310
say wait I already dealt with<font color="#E5E5E5"> this</font>

450
00:18:53,490 --> 00:19:01,800
request so you can use a nonce number

451
00:18:56,310 --> 00:19:03,980
used once to prevent repeat request<font color="#E5E5E5"> all</font>

452
00:19:01,800 --> 00:19:07,080
<font color="#E5E5E5">right next one no curfew for</font><font color="#CCCCCC"> a request</font>

453
00:19:03,980 --> 00:19:09,510
as discuss the sessions last for a long

454
00:19:07,080 --> 00:19:11,250
time but<font color="#CCCCCC"> also the requests the</font>

455
00:19:09,510 --> 00:19:14,760
individual requests last for a long time

456
00:19:11,250 --> 00:19:17,610
so let's say a man in the middle<font color="#E5E5E5"> I grab</font>

457
00:19:14,760 --> 00:19:19,230
a request I'm worried<font color="#CCCCCC"> about the nonce so</font>

458
00:19:17,610 --> 00:19:20,909
what I'm going to do is just not allow

459
00:19:19,230 --> 00:19:23,580
it<font color="#CCCCCC"> to go through</font><font color="#E5E5E5"> but I'm going to hang</font>

460
00:19:20,910 --> 00:19:27,380
on to it now I might want<font color="#E5E5E5"> to manipulate</font>

461
00:19:23,580 --> 00:19:30,990
it and send it later do something else

462
00:19:27,380 --> 00:19:33,060
but most apps allow that request to just

463
00:19:30,990 --> 00:19:36,750
live forever eventually it will get<font color="#E5E5E5"> to</font>

464
00:19:33,060 --> 00:19:39,770
the server<font color="#E5E5E5"> and it will get processed one</font>

465
00:19:36,750 --> 00:19:42,030
of the reasons for<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> the</font>

466
00:19:39,770 --> 00:19:43,920
mobile apps kind of have a<font color="#CCCCCC"> problem in</font>

467
00:19:42,030 --> 00:19:46,590
that their connectivity is all sometimes

468
00:19:43,920 --> 00:19:48,510
the limited the connectivity you know it

469
00:19:46,590 --> 00:19:51,449
<font color="#E5E5E5">could be an elevator in a parking lot</font>

470
00:19:48,510 --> 00:19:53,070
whatever<font color="#E5E5E5"> you have no connection so the</font>

471
00:19:51,450 --> 00:19:54,990
request has<font color="#E5E5E5"> to kind of be allowed to</font>

472
00:19:53,070 --> 00:19:56,879
hang out for a little while but by

473
00:19:54,990 --> 00:19:59,550
allowing them to last forever<font color="#E5E5E5"> and for</font>

474
00:19:56,880 --> 00:20:02,250
very long<font color="#CCCCCC"> time you open yourselves up to</font>

475
00:19:59,550 --> 00:20:04,050
attack so very simple<font color="#E5E5E5"> solution is to</font>

476
00:20:02,250 --> 00:20:04,720
timestamp for<font color="#CCCCCC"> request and say you know</font>

477
00:20:04,050 --> 00:20:07,059
after an

478
00:20:04,720 --> 00:20:10,330
it's no longer<font color="#E5E5E5"> valid okay that request</font>

479
00:20:07,059 --> 00:20:12,639
<font color="#E5E5E5">is dead and the app should be aware of</font>

480
00:20:10,330 --> 00:20:15,039
that<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that if it's been more than an</font>

481
00:20:12,640 --> 00:20:16,900
hour and the request<font color="#CCCCCC"> hasn't come</font><font color="#E5E5E5"> back it</font>

482
00:20:15,039 --> 00:20:19,390
should just regenerate a request with a

483
00:20:16,900 --> 00:20:24,280
new<font color="#E5E5E5"> time stamp</font><font color="#CCCCCC"> okay very simple thing to</font>

484
00:20:19,390 --> 00:20:27,760
do so the<font color="#CCCCCC"> next is to prevent altered</font>

485
00:20:24,280 --> 00:20:29,440
requests it's<font color="#E5E5E5"> very easy to be a</font>

486
00:20:27,760 --> 00:20:31,720
man-in-the-middle take a request and

487
00:20:29,440 --> 00:20:33,880
then try to alter it in some way right

488
00:20:31,720 --> 00:20:36,520
if this is<font color="#E5E5E5"> Twitter and I can change the</font>

489
00:20:33,880 --> 00:20:39,520
the tweet itself again that's kind of

490
00:20:36,520 --> 00:20:41,289
fun if it's a baking app and I can see

491
00:20:39,520 --> 00:20:42,850
<font color="#E5E5E5">that wire transfer and I change it to</font>

492
00:20:41,289 --> 00:20:47,740
you know transfer the money to my

493
00:20:42,850 --> 00:20:50,709
account now that's a lot funner so it's

494
00:20:47,740 --> 00:20:52,510
very easy<font color="#E5E5E5"> to prevent this and most apps</font>

495
00:20:50,710 --> 00:20:55,390
are not doing this a Twitter actually

496
00:20:52,510 --> 00:20:57,520
was preventing me from altering the

497
00:20:55,390 --> 00:20:58,330
tweet i could just resend it and one of

498
00:20:57,520 --> 00:21:00,820
<font color="#E5E5E5">the things that we're doing is just</font>

499
00:20:58,330 --> 00:21:02,970
signing the request so this<font color="#E5E5E5"> is where you</font>

500
00:21:00,820 --> 00:21:06,700
becomes very easy to prevent all of this

501
00:21:02,970 --> 00:21:08,559
if I've<font color="#E5E5E5"> said the knots you know the</font>

502
00:21:06,700 --> 00:21:10,330
nonce could potentially been manipulated

503
00:21:08,559 --> 00:21:12,158
if there's a timestamp in there that

504
00:21:10,330 --> 00:21:14,590
could be manipulated but<font color="#CCCCCC"> I can solve</font>

505
00:21:12,159 --> 00:21:16,480
this with the secret key so going<font color="#CCCCCC"> back</font>

506
00:21:14,590 --> 00:21:19,270
to<font color="#CCCCCC"> the idea that I have something on the</font>

507
00:21:16,480 --> 00:21:21,970
client that<font color="#CCCCCC"> is secret</font><font color="#E5E5E5"> that is not being</font>

508
00:21:19,270 --> 00:21:24,700
sent over the wire the server and client

509
00:21:21,970 --> 00:21:27,100
can negotiate on it's very<font color="#CCCCCC"> easy to take</font>

510
00:21:24,700 --> 00:21:29,890
the<font color="#CCCCCC"> User Content take the nonce take the</font>

511
00:21:27,100 --> 00:21:32,770
timestamp you know make a big string out

512
00:21:29,890 --> 00:21:37,450
of it hash it and then attach this to

513
00:21:32,770 --> 00:21:38,950
the request okay so here's a simpler way

514
00:21:37,450 --> 00:21:40,809
to look at this so I've got the content

515
00:21:38,950 --> 00:21:43,179
I got the nonce I got the timestamp

516
00:21:40,809 --> 00:21:45,399
they're all in the request but then I'm

517
00:21:43,179 --> 00:21:47,590
also got this content hash and that's

518
00:21:45,400 --> 00:21:49,299
the collection of all those<font color="#CCCCCC"> things so</font>

519
00:21:47,590 --> 00:21:51,850
all of the rest<font color="#E5E5E5"> of the request is left</font>

520
00:21:49,299 --> 00:21:54,700
<font color="#E5E5E5">there fine the server can now get this</font>

521
00:21:51,850 --> 00:21:56,770
data and actually recalculate and

522
00:21:54,700 --> 00:21:58,900
compare that<font color="#E5E5E5"> hash to make sure it's</font>

523
00:21:56,770 --> 00:22:00,760
never been manipulated and nobody else

524
00:21:58,900 --> 00:22:03,309
could generate that request because they

525
00:22:00,760 --> 00:22:05,919
<font color="#E5E5E5">wouldn't have the</font><font color="#CCCCCC"> secret key</font><font color="#E5E5E5"> right they</font>

526
00:22:03,309 --> 00:22:07,960
would not<font color="#CCCCCC"> be</font><font color="#E5E5E5"> able to in any way be able</font>

527
00:22:05,919 --> 00:22:09,820
to create<font color="#CCCCCC"> on their own just having the</font>

528
00:22:07,960 --> 00:22:12,250
session token they wouldn't be<font color="#E5E5E5"> able</font><font color="#CCCCCC"> to</font>

529
00:22:09,820 --> 00:22:17,418
change an existing request it's all<font color="#CCCCCC"> very</font>

530
00:22:12,250 --> 00:22:19,410
solvable very few apps are doing this so

531
00:22:17,419 --> 00:22:21,360
here's the<font color="#E5E5E5"> things that we need</font><font color="#CCCCCC"> to do to</font>

532
00:22:19,410 --> 00:22:23,429
solve it very easy take these seven

533
00:22:21,360 --> 00:22:26,189
things you never trust the client use

534
00:22:23,429 --> 00:22:29,910
encryption limit the session lifetime

535
00:22:26,190 --> 00:22:32,429
use a secret<font color="#E5E5E5"> key use nonces timestamps</font>

536
00:22:29,910 --> 00:22:34,620
and hash all this together ok this is

537
00:22:32,429 --> 00:22:36,510
what should be done now understanding

538
00:22:34,620 --> 00:22:38,549
what should be done and what's not being

539
00:22:36,510 --> 00:22:44,210
done allows<font color="#CCCCCC"> me to start attacking apps</font>

540
00:22:38,549 --> 00:22:46,500
what's our time I got time<font color="#E5E5E5"> ok cool so</font>

541
00:22:44,210 --> 00:22:48,510
what I did is I was once I understood

542
00:22:46,500 --> 00:22:50,429
what<font color="#E5E5E5"> I what should be happening and</font>

543
00:22:48,510 --> 00:22:51,629
where people were failing I started

544
00:22:50,429 --> 00:22:53,850
going through<font color="#E5E5E5"> and attacking things</font>

545
00:22:51,630 --> 00:22:57,539
looking<font color="#E5E5E5"> at apps looking at traffic</font>

546
00:22:53,850 --> 00:23:00,090
figuring<font color="#E5E5E5"> out what's possible now so some</font>

547
00:22:57,539 --> 00:23:02,158
of the simple things just looking<font color="#E5E5E5"> at</font>

548
00:23:00,090 --> 00:23:04,139
traffic I'm seeing name equal you know

549
00:23:02,159 --> 00:23:07,289
name and username and passwords being

550
00:23:04,140 --> 00:23:11,159
sent a lot<font color="#E5E5E5"> of times some apps will</font>

551
00:23:07,289 --> 00:23:13,919
actually use like you know<font color="#E5E5E5"> a basic auth</font>

552
00:23:11,159 --> 00:23:17,039
right standard old HTTP basic off so

553
00:23:13,919 --> 00:23:20,520
that's<font color="#CCCCCC"> just a base64 encoded you know</font>

554
00:23:17,039 --> 00:23:22,620
header stirring decode that trivially

555
00:23:20,520 --> 00:23:26,730
and I've got username<font color="#CCCCCC"> and passwords I</font>

556
00:23:22,620 --> 00:23:29,820
see apps that like there's one here

557
00:23:26,730 --> 00:23:32,640
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> my backup pro it actually asks</font>

558
00:23:29,820 --> 00:23:34,620
for a password when you open<font color="#CCCCCC"> it I you</font>

559
00:23:32,640 --> 00:23:36,270
<font color="#E5E5E5">know put in a pin and some Thai was</font>

560
00:23:34,620 --> 00:23:38,939
looking at the<font color="#CCCCCC"> traffic</font><font color="#E5E5E5"> and there was</font>

561
00:23:36,270 --> 00:23:41,370
this<font color="#E5E5E5"> base64 encoded password being you</font>

562
00:23:38,940 --> 00:23:43,320
know credentials being sent well it

563
00:23:41,370 --> 00:23:47,760
turns<font color="#CCCCCC"> out I decode that and it just said</font>

564
00:23:43,320 --> 00:23:50,129
like my backup colon pro right and that

565
00:23:47,760 --> 00:23:51,780
was static it never you know it was

566
00:23:50,130 --> 00:23:53,460
asking me for a password to open the app

567
00:23:51,780 --> 00:23:55,289
but that was never part of its

568
00:23:53,460 --> 00:24:00,080
communication with the server it was

569
00:23:55,289 --> 00:24:02,908
identifying the device by its meid and

570
00:24:00,080 --> 00:24:04,289
so just<font color="#E5E5E5"> having a collection of those I</font>

571
00:24:02,909 --> 00:24:06,000
when I was watching other traffic got a

572
00:24:04,289 --> 00:24:07,260
big collection of<font color="#E5E5E5"> those and just ran</font><font color="#CCCCCC"> to</font>

573
00:24:06,000 --> 00:24:09,539
their server and started seeing who's

574
00:24:07,260 --> 00:24:13,200
using this service<font color="#CCCCCC"> ok and I grabbed</font>

575
00:24:09,539 --> 00:24:17,730
their data all I want it's great address

576
00:24:13,200 --> 00:24:20,330
book pro was doing the same thing words

577
00:24:17,730 --> 00:24:23,490
with friends I was playing with that and

578
00:24:20,330 --> 00:24:25,379
they<font color="#E5E5E5"> changed their API now so it's a lot</font>

579
00:24:23,490 --> 00:24:28,950
<font color="#CCCCCC">more secure so I could I talk</font><font color="#E5E5E5"> about this</font>

580
00:24:25,380 --> 00:24:29,660
<font color="#E5E5E5">one a lot but earlier</font><font color="#CCCCCC"> on you guys</font><font color="#E5E5E5"> are</font>

581
00:24:28,950 --> 00:24:33,110
all familiar with

582
00:24:29,660 --> 00:24:34,430
friends right so when you<font color="#E5E5E5"> put it your</font>

583
00:24:33,110 --> 00:24:36,379
word on<font color="#E5E5E5"> the board it goes out and makes</font>

584
00:24:34,430 --> 00:24:38,990
a server request to find out what the

585
00:24:36,380 --> 00:24:40,790
you know if this word was valid<font color="#E5E5E5"> okay and</font>

586
00:24:38,990 --> 00:24:42,260
it gets back a you know that you know

587
00:24:40,790 --> 00:24:45,500
valid response or an invalid response

588
00:24:42,260 --> 00:24:46,850
and then based on that it will<font color="#E5E5E5"> decide</font>

589
00:24:45,500 --> 00:24:49,880
okay if I'm going to actually submit it

590
00:24:46,850 --> 00:24:51,409
so I was<font color="#E5E5E5"> seeing that it was two separate</font>

591
00:24:49,880 --> 00:24:53,150
requests when to<font color="#E5E5E5"> check the if the word</font>

592
00:24:51,410 --> 00:24:55,190
was valid and another actually just

593
00:24:53,150 --> 00:24:57,770
submitted on the<font color="#E5E5E5"> board so that became</font>

594
00:24:55,190 --> 00:24:58,940
easy so I<font color="#E5E5E5"> just recorded the valid word</font>

595
00:24:57,770 --> 00:25:02,180
response and I put something now that

596
00:24:58,940 --> 00:25:04,310
<font color="#E5E5E5">was right saw what</font><font color="#CCCCCC"> that looked like save</font>

597
00:25:02,180 --> 00:25:06,430
that then I took also have letters off

598
00:25:04,310 --> 00:25:08,740
my trade dumped him<font color="#E5E5E5"> on the board and</font>

599
00:25:06,430 --> 00:25:11,420
intercepted the response replaced it out

600
00:25:08,740 --> 00:25:14,210
let through right so i was playing by my

601
00:25:11,420 --> 00:25:15,560
cousin he gets this garbage word he

602
00:25:14,210 --> 00:25:18,550
starts freaking out i get a phone<font color="#CCCCCC"> call</font>

603
00:25:15,560 --> 00:25:21,409
like what the hell just happened right

604
00:25:18,550 --> 00:25:23,720
because these formats are very<font color="#E5E5E5"> simple</font>

605
00:25:21,410 --> 00:25:25,400
<font color="#E5E5E5">and the apps are not verifying that</font>

606
00:25:23,720 --> 00:25:29,930
somebody can manipulate these requests

607
00:25:25,400 --> 00:25:32,780
in any way<font color="#CCCCCC"> I was doing and I'll</font><font color="#E5E5E5"> get to</font>

608
00:25:29,930 --> 00:25:35,890
<font color="#CCCCCC">the fantasy football in a minute you</font>

609
00:25:32,780 --> 00:25:39,770
know looking at simple ones this is the

610
00:25:35,890 --> 00:25:41,930
associated press in a mobile<font color="#E5E5E5"> app it's</font>

611
00:25:39,770 --> 00:25:44,650
got a little rest interface all right

612
00:25:41,930 --> 00:25:46,760
now this is<font color="#E5E5E5"> using name equal value pairs</font>

613
00:25:44,650 --> 00:25:50,540
you know classic web app style

614
00:25:46,760 --> 00:25:51,800
responding with<font color="#CCCCCC"> json responses of course</font>

615
00:25:50,540 --> 00:25:54,560
you're going<font color="#E5E5E5"> to have to try some sequel</font>

616
00:25:51,800 --> 00:25:57,290
injection<font color="#CCCCCC"> BAM there you know vulnerable</font>

617
00:25:54,560 --> 00:25:59,149
<font color="#E5E5E5">the sequel injection and this associated</font>

618
00:25:57,290 --> 00:26:02,240
<font color="#E5E5E5">press my gokulam hack in</font><font color="#CCCCCC"> the news now</font>

619
00:25:59,150 --> 00:26:04,280
there wasn't a way to inject anything in

620
00:26:02,240 --> 00:26:05,450
this table why the account running<font color="#E5E5E5"> on</font>

621
00:26:04,280 --> 00:26:07,520
this rest interface didn't have any

622
00:26:05,450 --> 00:26:08,600
update permissions but<font color="#E5E5E5"> I was like</font>

623
00:26:07,520 --> 00:26:12,530
<font color="#E5E5E5">starting to dig through their database</font>

624
00:26:08,600 --> 00:26:15,639
and look at what records were there<font color="#CCCCCC"> all</font>

625
00:26:12,530 --> 00:26:15,639
<font color="#CCCCCC">right so fantasy football</font>

626
00:26:18,750 --> 00:26:25,950
the the way fantasy football works

627
00:26:20,990 --> 00:26:28,890
generally is that you go to<font color="#E5E5E5"> the web app</font>

628
00:26:25,950 --> 00:26:30,210
and you set up your team<font color="#CCCCCC"> all right any</font>

629
00:26:28,890 --> 00:26:33,450
of you play fantasy football and<font color="#E5E5E5"> raise</font>

630
00:26:30,210 --> 00:26:36,240
<font color="#E5E5E5">your hands all right so for those that</font>

631
00:26:33,450 --> 00:26:38,060
that don't<font color="#E5E5E5"> play the way this generally</font>

632
00:26:36,240 --> 00:26:46,260
works let me see if I mouse works is

633
00:26:38,060 --> 00:26:48,659
that I'll have a team and I've got all

634
00:26:46,260 --> 00:26:51,780
my players and Kaepernick's not doing

635
00:26:48,660 --> 00:26:53,220
that well this<font color="#E5E5E5"> year but so it I'm</font>

636
00:26:51,780 --> 00:26:56,250
actually then playing against the denim

637
00:26:53,220 --> 00:26:58,200
group guys today or this week so this is

638
00:26:56,250 --> 00:26:59,790
<font color="#CCCCCC">my team what you do is you end up</font>

639
00:26:58,200 --> 00:27:01,950
picking teams on draft day from

640
00:26:59,790 --> 00:27:03,930
different players from from players from

641
00:27:01,950 --> 00:27:05,670
all over the league right so you'll want

642
00:27:03,930 --> 00:27:08,280
to get a quarterback from some team and

643
00:27:05,670 --> 00:27:10,110
<font color="#CCCCCC">wide receivers running backs whatever</font>

644
00:27:08,280 --> 00:27:14,490
there's positional players skilled

645
00:27:10,110 --> 00:27:16,649
players then during the week you<font color="#CCCCCC"> you set</font>

646
00:27:14,490 --> 00:27:18,990
your lineup<font color="#E5E5E5"> okay you want all your best</font>

647
00:27:16,650 --> 00:27:20,310
<font color="#E5E5E5">guys some guys have bye weeks so like</font>

648
00:27:18,990 --> 00:27:21,960
some of<font color="#E5E5E5"> my guys right now when I'm by</font>

649
00:27:20,310 --> 00:27:25,440
<font color="#CCCCCC">that means that their teams not playing</font>

650
00:27:21,960 --> 00:27:27,990
this week but anyway you said you kind

651
00:27:25,440 --> 00:27:29,580
of manage your roster<font color="#E5E5E5"> okay and you want</font>

652
00:27:27,990 --> 00:27:32,340
to put your best guys in every week and

653
00:27:29,580 --> 00:27:34,350
then you play against<font color="#E5E5E5"> one of the other</font>

654
00:27:32,340 --> 00:27:36,780
teams so I'm playing against<font color="#CCCCCC"> the as a</font>

655
00:27:34,350 --> 00:27:40,469
hash crackers and that's the guys from

656
00:27:36,780 --> 00:27:42,600
the denim group and we have to try to

657
00:27:40,470 --> 00:27:45,030
outscore each other right each player

658
00:27:42,600 --> 00:27:46,439
gets points based on how much how well

659
00:27:45,030 --> 00:27:48,540
they contribute to<font color="#CCCCCC"> the success of the</font>

660
00:27:46,440 --> 00:27:50,700
team<font color="#CCCCCC"> right how far the running back runs</font>

661
00:27:48,540 --> 00:27:52,590
and we catches the wide receiver makes

662
00:27:50,700 --> 00:27:55,470
you know touchdowns all that stuff

663
00:27:52,590 --> 00:27:57,240
they'll factor into their score so you

664
00:27:55,470 --> 00:27:58,830
want to have higher score at the end of

665
00:27:57,240 --> 00:28:01,410
<font color="#E5E5E5">the week than</font><font color="#CCCCCC"> the other team okay that's</font>

666
00:27:58,830 --> 00:28:06,030
the general premise and it's<font color="#CCCCCC"> it's a lot</font>

667
00:28:01,410 --> 00:28:08,310
of<font color="#E5E5E5"> fun just goofin with everybody so</font><font color="#CCCCCC"> I</font>

668
00:28:06,030 --> 00:28:10,290
tried hacking the mobile app itself I

669
00:28:08,310 --> 00:28:11,550
wasn't<font color="#E5E5E5"> working out very well the app</font>

670
00:28:10,290 --> 00:28:12,930
seem to be doing a lot<font color="#E5E5E5"> of the right</font>

671
00:28:11,550 --> 00:28:15,480
<font color="#CCCCCC">things those developers</font><font color="#E5E5E5"> have done a</font>

672
00:28:12,930 --> 00:28:17,400
decent job<font color="#CCCCCC"> and I didn't want to</font><font color="#E5E5E5"> spend a</font>

673
00:28:15,480 --> 00:28:19,920
lot of time on it so I moved on they

674
00:28:17,400 --> 00:28:22,050
have a mobile app the mobile app allows

675
00:28:19,920 --> 00:28:24,120
a lot of the same functionality so of

676
00:28:22,050 --> 00:28:25,889
course<font color="#E5E5E5"> I'm looking at the traffic</font><font color="#CCCCCC"> and I</font>

677
00:28:24,120 --> 00:28:28,020
start looking and trying to<font color="#E5E5E5"> figure out</font>

678
00:28:25,890 --> 00:28:29,549
<font color="#E5E5E5">what is what are they doing to validate</font>

679
00:28:28,020 --> 00:28:32,340
that the traffic

680
00:28:29,549 --> 00:28:33,960
coming from me right<font color="#CCCCCC"> I found</font><font color="#E5E5E5"> that the</font>

681
00:28:32,340 --> 00:28:36,539
sessions I you<font color="#CCCCCC"> know I had noticed this</font>

682
00:28:33,960 --> 00:28:38,879
myself it was never asking me to relog

683
00:28:36,539 --> 00:28:41,340
in all right like almost never asked for

684
00:28:38,879 --> 00:28:43,918
<font color="#E5E5E5">my password again there was no ssl</font><font color="#CCCCCC"> I</font>

685
00:28:41,340 --> 00:28:46,019
started looking at my own requests and

686
00:28:43,919 --> 00:28:49,169
they were not being tagged with any kind

687
00:28:46,019 --> 00:28:50,759
of<font color="#E5E5E5"> nantes there was no hashing no</font>

688
00:28:49,169 --> 00:28:54,679
signatures no Krypto anywhere I could

689
00:28:50,759 --> 00:28:57,210
see so I'm looking at<font color="#E5E5E5"> the request and</font>

690
00:28:54,679 --> 00:28:59,929
you see the cookies up on top it's still

691
00:28:57,210 --> 00:29:03,659
using classic web app model of cookies

692
00:28:59,929 --> 00:29:06,629
<font color="#E5E5E5">and then you look at the request it's</font>

693
00:29:03,659 --> 00:29:10,320
doing<font color="#E5E5E5"> a Q equals update set and body</font>

694
00:29:06,629 --> 00:29:11,459
looks<font color="#E5E5E5"> like a sequel statement right so I</font>

695
00:29:10,320 --> 00:29:15,119
start going<font color="#CCCCCC"> okay well this</font><font color="#E5E5E5"> is</font>

696
00:29:11,460 --> 00:29:17,220
interesting you know right from mobile

697
00:29:15,119 --> 00:29:18,809
app getting sequel statements so I start

698
00:29:17,220 --> 00:29:20,309
trying<font color="#E5E5E5"> to play with it I couldn't find</font>

699
00:29:18,809 --> 00:29:24,869
an easy way and he's trying to<font color="#E5E5E5"> see if</font>

700
00:29:20,309 --> 00:29:26,309
I'm hacking his account right now so I

701
00:29:24,869 --> 00:29:27,570
started looking to trying to see is you

702
00:29:26,309 --> 00:29:29,129
know can I do sequel injection and

703
00:29:27,570 --> 00:29:31,379
apparently this is<font color="#E5E5E5"> using something</font>

704
00:29:29,129 --> 00:29:33,359
called<font color="#E5E5E5"> why sequel so their own variant</font>

705
00:29:31,379 --> 00:29:34,709
it seems to have its own protections so

706
00:29:33,359 --> 00:29:36,269
again I didn't want<font color="#E5E5E5"> to waste too much</font>

707
00:29:34,710 --> 00:29:38,399
time on that I start looking at a little

708
00:29:36,269 --> 00:29:40,619
bit ok this is this and I put it<font color="#E5E5E5"> in</font>

709
00:29:38,399 --> 00:29:43,439
green<font color="#E5E5E5"> there's this M body equals and</font>

710
00:29:40,619 --> 00:29:47,999
then there's this big green text what

711
00:29:43,440 --> 00:29:50,489
that is is<font color="#E5E5E5"> a XML document</font><font color="#CCCCCC"> okay this XML</font>

712
00:29:47,999 --> 00:29:52,320
document is a list of<font color="#E5E5E5"> all of the</font>

713
00:29:50,489 --> 00:29:55,350
different players and the positions that

714
00:29:52,320 --> 00:29:56,820
i have them in<font color="#CCCCCC"> okay so when I pick it</font>

715
00:29:55,350 --> 00:29:58,649
it's choosing on the client side to let

716
00:29:56,820 --> 00:30:02,939
me reshuffle everything and then it

717
00:29:58,649 --> 00:30:06,449
submits this traffic and it's setting my

718
00:30:02,940 --> 00:30:08,519
lineup<font color="#E5E5E5"> okay so what I started doing is I</font>

719
00:30:06,450 --> 00:30:10,200
started kind of planning right as I was

720
00:30:08,519 --> 00:30:12,749
getting ready<font color="#E5E5E5"> to go into the season next</font>

721
00:30:10,200 --> 00:30:14,669
season like okay all i need is session

722
00:30:12,749 --> 00:30:18,590
tokens once<font color="#E5E5E5"> i have a session tokens i</font>

723
00:30:14,669 --> 00:30:22,970
can do a lot so draft day comes around<font color="#E5E5E5"> i</font>

724
00:30:18,590 --> 00:30:26,010
provide Wi-Fi access right

725
00:30:22,970 --> 00:30:27,540
so I get all<font color="#E5E5E5"> of these session tokens</font>

726
00:30:26,010 --> 00:30:28,679
right everybody set their lineup on

727
00:30:27,540 --> 00:30:31,350
draft day and<font color="#E5E5E5"> you know we're all</font>

728
00:30:28,679 --> 00:30:33,660
<font color="#CCCCCC">laughing and quietly my pineapple and</font>

729
00:30:31,350 --> 00:30:37,379
<font color="#CCCCCC">Burt proxy are recording everything ok</font>

730
00:30:33,660 --> 00:30:39,720
so I steal everybody session<font color="#E5E5E5"> token now</font>

731
00:30:37,380 --> 00:30:42,690
<font color="#E5E5E5">during the season it's trivial I come in</font>

732
00:30:39,720 --> 00:30:44,820
I pull<font color="#CCCCCC"> up their rosters right I get the</font>

733
00:30:42,690 --> 00:30:47,400
<font color="#CCCCCC">XML document I could then take you know</font>

734
00:30:44,820 --> 00:30:49,950
their their top quarterback stick them

735
00:30:47,400 --> 00:30:52,190
on<font color="#CCCCCC"> the bench right take some of the guys</font>

736
00:30:49,950 --> 00:30:55,380
<font color="#CCCCCC">that are on bye week put them into play</font>

737
00:30:52,190 --> 00:30:57,150
<font color="#E5E5E5">right before</font><font color="#CCCCCC"> the game starts you know as</font>

738
00:30:55,380 --> 00:30:59,850
<font color="#E5E5E5">soon as the game starts it logs she do</font>

739
00:30:57,150 --> 00:31:02,340
this like 15 minutes beforehand submit

740
00:30:59,850 --> 00:31:05,659
it it's now locked they're freaking out

741
00:31:02,340 --> 00:31:08,040
like<font color="#CCCCCC"> think it would happen who did this</font>

742
00:31:05,660 --> 00:31:11,970
most no I'm insecurities they blame me

743
00:31:08,040 --> 00:31:13,530
<font color="#E5E5E5">pretty quickly but</font><font color="#CCCCCC"> it was fun actually</font>

744
00:31:11,970 --> 00:31:15,210
<font color="#CCCCCC">before I started messing with people's</font>

745
00:31:13,530 --> 00:31:16,980
lineups I was met there's like a message

746
00:31:15,210 --> 00:31:19,049
board usually where people kind of trash

747
00:31:16,980 --> 00:31:21,090
talk so<font color="#E5E5E5"> i was submitting you know it's</font>

748
00:31:19,049 --> 00:31:22,559
causing trouble on the boards you know

749
00:31:21,090 --> 00:31:24,299
getting people to start arguments with

750
00:31:22,559 --> 00:31:27,840
each other it was<font color="#E5E5E5"> just fun just haven't</font>

751
00:31:24,299 --> 00:31:30,330
havoc the whole time so very simple

752
00:31:27,840 --> 00:31:32,699
starting to look at these requests not

753
00:31:30,330 --> 00:31:34,379
<font color="#E5E5E5">allowing the formats to distract us you</font>

754
00:31:32,700 --> 00:31:36,030
know automated tools out there a lot<font color="#E5E5E5"> of</font>

755
00:31:34,380 --> 00:31:38,460
your you know any of<font color="#E5E5E5"> the script</font><font color="#CCCCCC"> Kitty</font>

756
00:31:36,030 --> 00:31:40,559
tools most commercial tools they don't

757
00:31:38,460 --> 00:31:41,730
handle these formats very well so you're

758
00:31:40,559 --> 00:31:43,740
going<font color="#E5E5E5"> to have to manually get in there</font>

759
00:31:41,730 --> 00:31:44,880
and do this you know we're still trying

760
00:31:43,740 --> 00:31:46,740
to<font color="#E5E5E5"> figure</font><font color="#CCCCCC"> out how to put a lot of this</font>

761
00:31:44,880 --> 00:31:48,120
into our scanner I can handle most of

762
00:31:46,740 --> 00:31:50,940
the formats but the session management

763
00:31:48,120 --> 00:31:52,080
stuff our scanner can't do but<font color="#E5E5E5"> this is</font>

764
00:31:50,940 --> 00:31:56,040
where it<font color="#E5E5E5"> gets interesting there's other</font>

765
00:31:52,080 --> 00:31:58,260
examples<font color="#E5E5E5"> gets familiar with bump</font><font color="#CCCCCC"> it's</font>

766
00:31:56,040 --> 00:31:59,970
kind<font color="#E5E5E5"> of fallen by the wayside a bit but</font>

767
00:31:58,260 --> 00:32:02,640
its height of popularity became very

768
00:31:59,970 --> 00:32:05,730
interesting to look at because<font color="#E5E5E5"> this is</font>

769
00:32:02,640 --> 00:32:08,610
another<font color="#E5E5E5"> one where is not tracking the</font>

770
00:32:05,730 --> 00:32:10,500
user in any way so the way bump works is

771
00:32:08,610 --> 00:32:11,969
you take your two phones and you bump

772
00:32:10,500 --> 00:32:13,740
them together and then they give they

773
00:32:11,970 --> 00:32:15,120
share contact information right so

774
00:32:13,740 --> 00:32:17,429
instead of<font color="#E5E5E5"> handy a business card you</font>

775
00:32:15,120 --> 00:32:19,580
<font color="#E5E5E5">just bump your phones together it's not</font>

776
00:32:17,429 --> 00:32:22,200
actually sending from phone<font color="#CCCCCC"> to phone</font>

777
00:32:19,580 --> 00:32:25,020
both phones<font color="#E5E5E5"> I'm gone when the bump</font>

778
00:32:22,200 --> 00:32:28,140
happens both<font color="#E5E5E5"> phones send up to the bump</font>

779
00:32:25,020 --> 00:32:30,210
servers that they<font color="#E5E5E5"> just bumped and they</font>

780
00:32:28,140 --> 00:32:33,120
send their position right GPS

781
00:32:30,210 --> 00:32:35,370
coordinates or whatever and then based

782
00:32:33,120 --> 00:32:36,239
on that bump kind of pairs them up right

783
00:32:35,370 --> 00:32:38,189
based on time

784
00:32:36,240 --> 00:32:40,500
and position<font color="#CCCCCC"> it says okay you guys</font>

785
00:32:38,190 --> 00:32:44,270
probably bumped each other so we've got

786
00:32:40,500 --> 00:32:47,490
<font color="#CCCCCC">that so an MJ key found this initially</font>

787
00:32:44,270 --> 00:32:49,980
and what he found is that in there the

788
00:32:47,490 --> 00:32:52,260
GPS coordinates you know you could

789
00:32:49,980 --> 00:32:55,140
change<font color="#E5E5E5"> those all you want and there's</font>

790
00:32:52,260 --> 00:32:57,750
also a range right GPS coordinates or

791
00:32:55,140 --> 00:33:00,330
your position is accurate up to a range

792
00:32:57,750 --> 00:33:04,200
right mostly it's<font color="#E5E5E5"> like</font><font color="#CCCCCC"> 9 feet</font><font color="#E5E5E5"> or</font>

793
00:33:00,330 --> 00:33:06,510
something<font color="#E5E5E5"> but bump actually didn't set a</font>

794
00:33:04,200 --> 00:33:09,179
hard limit so I was able<font color="#E5E5E5"> to sit there</font>

795
00:33:06,510 --> 00:33:11,040
<font color="#E5E5E5">and</font><font color="#CCCCCC"> go and change the my accuracy range</font>

796
00:33:09,179 --> 00:33:14,429
for my coordinates to like three miles

797
00:33:11,040 --> 00:33:16,740
right so what I actually did there's a

798
00:33:14,429 --> 00:33:19,950
conference center the Moscone Center in

799
00:33:16,740 --> 00:33:21,390
San Francisco doing conferences all the

800
00:33:19,950 --> 00:33:24,179
time that's where our essay is<font color="#E5E5E5"> that's</font>

801
00:33:21,390 --> 00:33:26,130
held that so<font color="#E5E5E5"> I actually started i wrote</font>

802
00:33:24,179 --> 00:33:28,559
a little perl script that just kept

803
00:33:26,130 --> 00:33:30,420
sending that bump request saying i'm at

804
00:33:28,559 --> 00:33:33,330
the moscone within an accuracy of three

805
00:33:30,420 --> 00:33:36,179
miles right I'm starting to get all

806
00:33:33,330 --> 00:33:37,350
kinds of responses right as my scripts

807
00:33:36,179 --> 00:33:39,390
are running pretty quickly just in a

808
00:33:37,350 --> 00:33:40,559
loop they didn't<font color="#E5E5E5"> even seem to notice I'm</font>

809
00:33:39,390 --> 00:33:42,240
you<font color="#E5E5E5"> know at some point I'm sure an</font>

810
00:33:40,559 --> 00:33:43,980
Adventist would have hopefully noticed

811
00:33:42,240 --> 00:33:46,140
this but I'm<font color="#E5E5E5"> just going over and over</font>

812
00:33:43,980 --> 00:33:48,809
I'd get bumps I would often<font color="#CCCCCC"> get both</font>

813
00:33:46,140 --> 00:33:51,120
bumps<font color="#CCCCCC"> okay so now let's say you bump</font>

814
00:33:48,809 --> 00:33:56,070
with her all right you too bumpy your

815
00:33:51,120 --> 00:33:58,979
bump your phone's not each other and i

816
00:33:56,070 --> 00:34:01,050
will get both of them<font color="#CCCCCC"> okay i</font><font color="#E5E5E5"> can now</font>

817
00:33:58,980 --> 00:34:03,000
record those both<font color="#CCCCCC"> i'll take them and</font>

818
00:34:01,050 --> 00:34:05,790
i'll actually storm and i'll send back

819
00:34:03,000 --> 00:34:07,679
an invalid response right all sounds

820
00:34:05,790 --> 00:34:08,759
like<font color="#E5E5E5"> it's like a vcard response i'll</font>

821
00:34:07,679 --> 00:34:10,619
<font color="#E5E5E5">just</font><font color="#CCCCCC"> send one that's like err err err</font>

822
00:34:08,760 --> 00:34:12,030
err err so what you would probably do is

823
00:34:10,619 --> 00:34:15,000
look at then go what the<font color="#E5E5E5"> hell try this</font>

824
00:34:12,030 --> 00:34:16,590
again right you bump again so then what

825
00:34:15,000 --> 00:34:18,330
i would do is switch them<font color="#CCCCCC"> okay so now</font>

826
00:34:16,590 --> 00:34:19,710
I'd give<font color="#CCCCCC"> you each other's data but I</font>

827
00:34:18,330 --> 00:34:21,569
could<font color="#E5E5E5"> change anything i want in the</font>

828
00:34:19,710 --> 00:34:24,119
middle insert a malicious string as the

829
00:34:21,570 --> 00:34:25,830
website URL the contact you know change

830
00:34:24,119 --> 00:34:27,600
the phone number if<font color="#E5E5E5"> i wanted but i can</font>

831
00:34:25,830 --> 00:34:29,219
get some you know<font color="#E5E5E5"> I'd steal contact</font>

832
00:34:27,600 --> 00:34:31,618
information and i can give you guys

833
00:34:29,219 --> 00:34:32,969
invalid contact information back but

834
00:34:31,619 --> 00:34:36,359
it's kind of fun just<font color="#E5E5E5"> kind of mess</font><font color="#CCCCCC"> with</font>

835
00:34:32,969 --> 00:34:37,980
people right you know<font color="#CCCCCC"> i put like it one</font>

836
00:34:36,359 --> 00:34:39,449
of them in the notes like you know he is

837
00:34:37,980 --> 00:34:43,530
the devil watch out or something<font color="#CCCCCC"> like</font>

838
00:34:39,449 --> 00:34:45,779
that<font color="#E5E5E5"> you know just have fun so anyway as</font>

839
00:34:43,530 --> 00:34:47,340
you're going through these apps as you

840
00:34:45,780 --> 00:34:48,270
start hopefully looking at traffic i

841
00:34:47,340 --> 00:34:49,470
don't know how<font color="#CCCCCC"> many of you are actually</font>

842
00:34:48,270 --> 00:34:51,869
<font color="#E5E5E5">doing this yet</font>

843
00:34:49,469 --> 00:34:53,939
you know getting in the middle of mobile

844
00:34:51,869 --> 00:34:57,660
apps but there<font color="#E5E5E5"> was a</font><font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> a lot of fun</font>

845
00:34:53,940 --> 00:34:59,760
stuff to see you know getting in there

846
00:34:57,660 --> 00:35:02,040
have fun with it I really think this<font color="#CCCCCC"> is</font>

847
00:34:59,760 --> 00:35:05,910
the biggest emerging threat you<font color="#E5E5E5"> know I'm</font>

848
00:35:02,040 --> 00:35:07,529
a web app guy but I'm very quickly

849
00:35:05,910 --> 00:35:09,180
<font color="#E5E5E5">becoming a mobile guy because this is</font>

850
00:35:07,530 --> 00:35:12,090
really where the fun is at this is how

851
00:35:09,180 --> 00:35:13,890
things<font color="#CCCCCC"> are moving even web apps you know</font>

852
00:35:12,090 --> 00:35:17,010
are becoming more Ajax driven they have

853
00:35:13,890 --> 00:35:18,480
a lot of<font color="#E5E5E5"> the same problem so they have</font>

854
00:35:17,010 --> 00:35:20,280
interfaces in the back end they're very

855
00:35:18,480 --> 00:35:23,130
easy to hack so start watching the

856
00:35:20,280 --> 00:35:25,109
traffic understand those seven deadly

857
00:35:23,130 --> 00:35:27,480
sins and start going off and attacking

858
00:35:25,109 --> 00:35:30,180
it you know there's the seven deadly

859
00:35:27,480 --> 00:35:33,690
sins understand them understand where

860
00:35:30,180 --> 00:35:35,430
you know combinations of mistakes<font color="#E5E5E5"> all</font>

861
00:35:33,690 --> 00:35:37,230
<font color="#E5E5E5">right not using encryption and not</font>

862
00:35:35,430 --> 00:35:39,480
having a hash signing or you know<font color="#CCCCCC"> any</font>

863
00:35:37,230 --> 00:35:41,220
series of anyone anytime they mess up on

864
00:35:39,480 --> 00:35:42,990
one<font color="#E5E5E5"> of the seven it just weakens our</font>

865
00:35:41,220 --> 00:35:46,770
security profile makes it easier to

866
00:35:42,990 --> 00:35:49,560
attack so any<font color="#CCCCCC"> questions comments if you</font>

867
00:35:46,770 --> 00:35:54,900
want the slides there's the URL for a

868
00:35:49,560 --> 00:36:02,820
copy of the slides any questions how

869
00:35:54,900 --> 00:36:06,870
many of<font color="#E5E5E5"> you are doing this stuff but you</font>

870
00:36:02,820 --> 00:36:08,610
could you could get<font color="#E5E5E5"> a tower</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> no</font>

871
00:36:06,870 --> 00:36:13,380
it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> that bad i mean for like a</font>

872
00:36:08,610 --> 00:36:14,520
low-end you know<font color="#E5E5E5"> i forget what the yeah</font>

873
00:36:13,380 --> 00:36:22,440
it's like about<font color="#E5E5E5"> two grand for a cell</font>

874
00:36:14,520 --> 00:36:24,060
tower that's not terrible yeah that's

875
00:36:22,440 --> 00:36:25,380
what<font color="#E5E5E5"> I'm talking get some of those for</font>

876
00:36:24,060 --> 00:36:27,330
like<font color="#E5E5E5"> two grand and then you you know you</font>

877
00:36:25,380 --> 00:36:29,100
go to the mall and you do that what I'll

878
00:36:27,330 --> 00:36:32,000
do a lot of times is<font color="#CCCCCC"> I've got i usually</font>

879
00:36:29,100 --> 00:36:35,299
take this but once a while you know

880
00:36:32,000 --> 00:36:39,450
somehow in my bag will<font color="#CCCCCC"> be one of</font><font color="#E5E5E5"> those</font>

881
00:36:35,300 --> 00:36:41,700
wife are<font color="#CCCCCC"> the mobile network disruptors</font>

882
00:36:39,450 --> 00:36:44,609
right get one<font color="#E5E5E5"> of those from</font><font color="#CCCCCC"> china for a</font>

883
00:36:41,700 --> 00:36:47,430
couple hundred<font color="#CCCCCC"> bucks and and then you</font>

884
00:36:44,610 --> 00:36:50,160
just mess up every you<font color="#E5E5E5"> know cell</font>

885
00:36:47,430 --> 00:36:51,870
connection and then and<font color="#CCCCCC"> then they got to</font>

886
00:36:50,160 --> 00:36:54,299
go Wi-Fi and say you'll get traffic that

887
00:36:51,870 --> 00:36:56,160
way too but yeah Wi-Fi is just the

888
00:36:54,300 --> 00:36:59,490
cheapest easiest way to do it and just

889
00:36:56,160 --> 00:37:02,399
go into public locations right I even

890
00:36:59,490 --> 00:37:04,799
talked illegal about it and they said

891
00:37:02,400 --> 00:37:05,970
because you<font color="#CCCCCC"> know I'm I'm you know</font>

892
00:37:04,800 --> 00:37:09,510
watching<font color="#E5E5E5"> people's traffic as like is</font>

893
00:37:05,970 --> 00:37:10,830
<font color="#E5E5E5">this legal and said well you might want</font>

894
00:37:09,510 --> 00:37:12,720
<font color="#E5E5E5">to give them like a you know like a</font>

895
00:37:10,830 --> 00:37:15,690
terms of agreement for the connection

896
00:37:12,720 --> 00:37:17,310
but there's no real default terms of

897
00:37:15,690 --> 00:37:19,680
agreement if you're providing internet

898
00:37:17,310 --> 00:37:29,130
access which you know I'm providing

899
00:37:19,680 --> 00:37:32,930
internet access the you know yes that's

900
00:37:29,130 --> 00:37:32,930
true but you know

901
00:37:34,190 --> 00:37:37,530
how many of<font color="#E5E5E5"> you have been kind of</font>

902
00:37:36,090 --> 00:37:41,010
messing with mobile and anybody see a

903
00:37:37,530 --> 00:37:42,390
lot of the same sort of thing it's been

904
00:37:41,010 --> 00:37:45,660
too kind of a new space that you know

905
00:37:42,390 --> 00:37:47,940
<font color="#CCCCCC">even as you know apset people most</font>

906
00:37:45,660 --> 00:37:49,350
people haven't made the shift yet and so

907
00:37:47,940 --> 00:37:58,290
there's a lot<font color="#E5E5E5"> of fun stuff to be had</font>

908
00:37:49,350 --> 00:38:01,500
here but any<font color="#E5E5E5"> other questions I actually</font>

909
00:37:58,290 --> 00:38:03,060
the the league<font color="#CCCCCC"> that I hacked mostly was</font>

910
00:38:01,500 --> 00:38:05,670
our church league in<font color="#E5E5E5"> this like 20 bucks</font>

911
00:38:03,060 --> 00:38:08,490
player so I didn't do<font color="#CCCCCC"> it I didn't do it</font>

912
00:38:05,670 --> 00:38:13,710
against<font color="#E5E5E5"> our I have it I knew they would</font>

913
00:38:08,490 --> 00:38:15,270
forgive me ok so now I play in pro

914
00:38:13,710 --> 00:38:19,740
leagues and stuff but I I don't want to

915
00:38:15,270 --> 00:38:21,950
do it there<font color="#CCCCCC"> all right well thank you</font>

916
00:38:19,740 --> 00:38:21,950
everybody

