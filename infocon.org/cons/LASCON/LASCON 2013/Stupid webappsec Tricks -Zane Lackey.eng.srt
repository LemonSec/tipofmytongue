1
00:00:16,340 --> 00:00:20,570
all right there are a bunch<font color="#CCCCCC"> of</font>

2
00:00:18,470 --> 00:00:22,759
intelligent talks by really smart people

3
00:00:20,570 --> 00:00:24,050
on completely<font color="#CCCCCC"> industry-changing</font><font color="#E5E5E5"> ideas</font>

4
00:00:22,760 --> 00:00:26,750
and methodologies and things like that

5
00:00:24,050 --> 00:00:29,810
that is not one of these talks that's

6
00:00:26,750 --> 00:00:32,558
absolutely<font color="#CCCCCC"> not this talk is</font><font color="#E5E5E5"> really just</font>

7
00:00:29,810 --> 00:00:35,680
going to be a bunch of super practical

8
00:00:32,558 --> 00:00:38,120
oftentimes<font color="#E5E5E5"> hilariously simple and stupid</font>

9
00:00:35,680 --> 00:00:39,140
techniques that work in web app<font color="#CCCCCC"> sex so</font>

10
00:00:38,120 --> 00:00:41,750
I'm just going to burn a bunch of our

11
00:00:39,140 --> 00:00:46,519
defensive techniques because yeah yellow

12
00:00:41,750 --> 00:00:48,590
as the<font color="#E5E5E5"> kids say cool all right well I</font>

13
00:00:46,519 --> 00:00:50,239
<font color="#E5E5E5">said I run security engineering at</font><font color="#CCCCCC"> etsy</font>

14
00:00:48,590 --> 00:00:53,120
which is a few different<font color="#E5E5E5"> teams there I</font>

15
00:00:50,239 --> 00:00:54,709
<font color="#E5E5E5">spend most my background in offense and</font>

16
00:00:53,120 --> 00:00:56,660
I want<font color="#CCCCCC"> to give a</font><font color="#E5E5E5"> shout out to the full</font>

17
00:00:54,710 --> 00:00:58,790
team because they're like I may be<font color="#E5E5E5"> the</font>

18
00:00:56,660 --> 00:01:00,739
<font color="#CCCCCC">one up here talking but it's</font><font color="#E5E5E5"> the vast</font>

19
00:00:58,790 --> 00:01:03,559
majority stock of this talk was Lizzie's

20
00:01:00,739 --> 00:01:05,929
guys so excited<font color="#CCCCCC"> obviously they're</font>

21
00:01:03,559 --> 00:01:07,520
oftentimes amusingly simple techniques

22
00:01:05,930 --> 00:01:09,289
that actually work in<font color="#E5E5E5"> the real world so</font>

23
00:01:07,520 --> 00:01:11,810
everything we talked about here finds

24
00:01:09,289 --> 00:01:13,490
<font color="#E5E5E5">real bugs and real homes and</font>

25
00:01:11,810 --> 00:01:15,649
specifically we're going to focus on how

26
00:01:13,490 --> 00:01:19,130
do you detect when vulnerabilities get

27
00:01:15,649 --> 00:01:20,929
discovered so knowing when Oh Simon<font color="#CCCCCC"> all</font>

28
00:01:19,130 --> 00:01:22,729
<font color="#CCCCCC">right so how do you know</font><font color="#E5E5E5"> when someone's</font>

29
00:01:20,929 --> 00:01:24,380
looking at your app and just found a

30
00:01:22,729 --> 00:01:25,789
vole and we're going<font color="#CCCCCC"> to run through</font><font color="#E5E5E5"> that</font>

31
00:01:24,380 --> 00:01:26,750
for some different<font color="#CCCCCC"> bone classes and then</font>

32
00:01:25,789 --> 00:01:28,670
we're going<font color="#E5E5E5"> to talk at the very end</font>

33
00:01:26,750 --> 00:01:29,990
about how do you increase attacker<font color="#CCCCCC"> costs</font>

34
00:01:28,670 --> 00:01:31,310
in a few different ways how do we make

35
00:01:29,990 --> 00:01:33,920
<font color="#CCCCCC">it more expensive for somebody to go</font>

36
00:01:31,310 --> 00:01:35,420
find bones and you're out so like I said

37
00:01:33,920 --> 00:01:37,880
how do I know when someone just found a

38
00:01:35,420 --> 00:01:39,619
bone the joking name that we get<font color="#CCCCCC"> to use</font>

39
00:01:37,880 --> 00:01:43,490
for that is unintentionally responsible

40
00:01:39,619 --> 00:01:45,110
disclosure so thinking about<font color="#E5E5E5"> it and</font>

41
00:01:43,490 --> 00:01:46,429
here's probably the only one of the few

42
00:01:45,110 --> 00:01:48,560
parts of this talk that's kind of

43
00:01:46,429 --> 00:01:50,720
methodology side and kind of bigger

44
00:01:48,560 --> 00:01:52,700
picture sizes thinking from your

45
00:01:50,720 --> 00:01:55,130
different vulnerability classes what

46
00:01:52,700 --> 00:01:56,569
signals get created when a vulnerability

47
00:01:55,130 --> 00:01:58,610
is discovered and<font color="#E5E5E5"> then one of ulnar</font>

48
00:01:56,569 --> 00:01:59,840
abilities actually exploited and taking

49
00:01:58,610 --> 00:02:01,399
a look<font color="#E5E5E5"> at it from that side of thinking</font>

50
00:01:59,840 --> 00:02:03,229
every Volm cost is actually going to

51
00:02:01,399 --> 00:02:04,489
trigger some sort of signal in<font color="#CCCCCC"> your</font>

52
00:02:03,229 --> 00:02:06,500
application that's being discovered

53
00:02:04,489 --> 00:02:07,819
that's being exploited and let's run

54
00:02:06,500 --> 00:02:09,139
through some of those signals and come

55
00:02:07,819 --> 00:02:11,930
up with<font color="#E5E5E5"> some practical things for that</font>

56
00:02:09,139 --> 00:02:12,950
and your instrument it's not<font color="#E5E5E5"> just a</font>

57
00:02:11,930 --> 00:02:14,540
<font color="#E5E5E5">server side that's what's kind of</font>

58
00:02:12,950 --> 00:02:16,458
interesting is you don't<font color="#E5E5E5"> just instrument</font>

59
00:02:14,540 --> 00:02:18,980
the server in places where you can you

60
00:02:16,459 --> 00:02:20,890
instrument<font color="#E5E5E5"> the client to even when the</font>

61
00:02:18,980 --> 00:02:23,599
attack<font color="#E5E5E5"> even when the client is hostile</font>

62
00:02:20,890 --> 00:02:26,599
it shockingly works a lot of times to

63
00:02:23,599 --> 00:02:28,010
instrument a hostile client to maybe

64
00:02:26,599 --> 00:02:29,810
give you a heads<font color="#E5E5E5"> up that they just don't</font>

65
00:02:28,010 --> 00:02:31,489
you so

66
00:02:29,810 --> 00:02:34,880
<font color="#CCCCCC">going to run through</font><font color="#E5E5E5"> examples for XSS</font>

67
00:02:31,489 --> 00:02:36,530
sequel I and remote code execution and

68
00:02:34,880 --> 00:02:39,109
then I'm going<font color="#E5E5E5"> to jump into the at the</font>

69
00:02:36,530 --> 00:02:41,239
end<font color="#CCCCCC"> of the talk about about increasing</font>

70
00:02:39,110 --> 00:02:43,819
costs and I hope that<font color="#CCCCCC"> I time this talk</font>

71
00:02:41,239 --> 00:02:45,590
right so that there's probably probably

72
00:02:43,819 --> 00:02:46,730
fairly quick and we'll have example or

73
00:02:45,590 --> 00:02:49,489
<font color="#CCCCCC">we'll have questions and things like</font>

74
00:02:46,730 --> 00:02:50,780
that because i'm sure that statements

75
00:02:49,489 --> 00:02:52,310
like these are going to cause questions

76
00:02:50,780 --> 00:02:54,440
in fact you know what it's<font color="#E5E5E5"> probably</font>

77
00:02:52,310 --> 00:02:55,849
going to run quick enough that<font color="#E5E5E5"> shout out</font>

78
00:02:54,440 --> 00:03:00,440
questions shout out when you

79
00:02:55,849 --> 00:03:02,030
think it's<font color="#E5E5E5"> go</font><font color="#CCCCCC"> okay let's</font><font color="#E5E5E5"> take</font>

80
00:03:00,440 --> 00:03:04,489
<font color="#E5E5E5">the most common we're jumping into XS s</font>

81
00:03:02,030 --> 00:03:05,959
first let's<font color="#E5E5E5"> take the most caught this is</font>

82
00:03:04,489 --> 00:03:07,910
the most common testing pattern from

83
00:03:05,959 --> 00:03:09,470
from looking<font color="#E5E5E5"> our data so this is</font><font color="#CCCCCC"> the</font>

84
00:03:07,910 --> 00:03:11,450
<font color="#CCCCCC">most</font><font color="#E5E5E5"> common nexus s testing pattern that</font>

85
00:03:09,470 --> 00:03:13,760
we see in our application it's the very

86
00:03:11,450 --> 00:03:16,310
trivial one right you<font color="#E5E5E5"> inject this HTML</font>

87
00:03:13,760 --> 00:03:18,530
there's no image name XO it triggers an

88
00:03:16,310 --> 00:03:20,150
alert it triggers an error that<font color="#E5E5E5"> triggers</font>

89
00:03:18,530 --> 00:03:21,650
an alert you pop that up and you're like

90
00:03:20,150 --> 00:03:24,650
<font color="#E5E5E5">okay great I just got I just</font><font color="#CCCCCC"> got</font>

91
00:03:21,650 --> 00:03:25,730
execution from each<font color="#E5E5E5"> male side so what's</font>

92
00:03:24,650 --> 00:03:28,880
the first thing let's break this down

93
00:03:25,730 --> 00:03:31,220
into how this actually works you're

94
00:03:28,880 --> 00:03:33,260
inserting if this if this tag actually

95
00:03:31,220 --> 00:03:35,150
execute if you win is an attacker here

96
00:03:33,260 --> 00:03:37,820
it's because<font color="#CCCCCC"> this image tag just</font>

97
00:03:35,150 --> 00:03:40,010
<font color="#E5E5E5">executed in your browser what happens</font>

98
00:03:37,820 --> 00:03:43,250
there well the first<font color="#CCCCCC"> part that happens</font>

99
00:03:40,010 --> 00:03:44,600
is you try to load an image named x what

100
00:03:43,250 --> 00:03:46,850
does that<font color="#E5E5E5"> look like on the</font><font color="#CCCCCC"> server side</font>

101
00:03:44,600 --> 00:03:48,620
there's a get 2x what does it<font color="#E5E5E5"> almost</font>

102
00:03:46,850 --> 00:03:51,500
certainly look<font color="#CCCCCC"> like a 404 in your</font>

103
00:03:48,620 --> 00:03:54,290
application because that X doesn't

104
00:03:51,500 --> 00:03:55,790
actually exist in<font color="#E5E5E5"> your application so we</font>

105
00:03:54,290 --> 00:03:58,400
went back<font color="#CCCCCC"> and we pulled 30 days of</font>

106
00:03:55,790 --> 00:04:00,500
attack data out of<font color="#E5E5E5"> our app and we took a</font>

107
00:03:58,400 --> 00:04:04,400
look at they were in the 30 days there

108
00:04:00,500 --> 00:04:06,769
were 75 almost 7600 attempts to inject

109
00:04:04,400 --> 00:04:09,290
an image tag there were only 72

110
00:04:06,769 --> 00:04:11,359
different source targets for that almost

111
00:04:09,290 --> 00:04:14,630
what fifty percent of them when you walk

112
00:04:11,359 --> 00:04:17,989
out are three things do<font color="#CCCCCC"> you</font><font color="#E5E5E5"> think in a</font>

113
00:04:14,630 --> 00:04:22,520
major<font color="#E5E5E5"> web application</font><font color="#CCCCCC"> XYZ X or one</font>

114
00:04:17,988 --> 00:04:24,409
exists as an<font color="#CCCCCC"> endpoint they don't we ran</font>

115
00:04:22,520 --> 00:04:26,120
an experiment on this and<font color="#CCCCCC"> the things</font>

116
00:04:24,410 --> 00:04:28,639
<font color="#E5E5E5">that we learned out of this were that</font>

117
00:04:26,120 --> 00:04:31,460
this hilariously found people finding

118
00:04:28,639 --> 00:04:33,950
XSS because what happens is when you

119
00:04:31,460 --> 00:04:36,020
inject that image tag and it works your

120
00:04:33,950 --> 00:04:38,450
browser does it get to / x there is no

121
00:04:36,020 --> 00:04:41,390
/x in your application if you alert off

122
00:04:38,450 --> 00:04:43,789
of 404<font color="#E5E5E5"> is 2 /x you just notice that</font>

123
00:04:41,390 --> 00:04:46,110
somebody found it found a<font color="#E5E5E5"> texas</font>

124
00:04:43,789 --> 00:04:47,759
the<font color="#E5E5E5"> majority of false positives when you</font>

125
00:04:46,110 --> 00:04:49,169
turn this on all come from one class

126
00:04:47,759 --> 00:04:51,030
they all come from<font color="#E5E5E5"> search engine for</font>

127
00:04:49,169 --> 00:04:52,349
always<font color="#E5E5E5"> you can in the first 24 hours</font>

128
00:04:51,030 --> 00:04:54,000
white list all of your search engine

129
00:04:52,349 --> 00:04:55,620
<font color="#E5E5E5">crawlers on this and then the only</font>

130
00:04:54,000 --> 00:04:58,370
<font color="#CCCCCC">things that comes in that come in are</font>

131
00:04:55,620 --> 00:05:01,020
actually real bugs it's hilarious

132
00:04:58,370 --> 00:05:04,289
<font color="#E5E5E5">alerting off of a request</font><font color="#CCCCCC"> to slash X in</font>

133
00:05:01,020 --> 00:05:05,340
your application actually works<font color="#CCCCCC"> alright</font>

134
00:05:04,289 --> 00:05:09,810
let's go back and let's look at this

135
00:05:05,340 --> 00:05:13,229
again what happens next after you do the

136
00:05:09,810 --> 00:05:15,300
get 4 /x what happens chat apps not<font color="#E5E5E5"> a</font>

137
00:05:13,229 --> 00:05:17,969
trick<font color="#CCCCCC"> question straightforward there's</font>

138
00:05:15,300 --> 00:05:19,800
an error right it<font color="#E5E5E5"> doesn't load so you</font>

139
00:05:17,969 --> 00:05:24,810
fire the on error event handler you do

140
00:05:19,800 --> 00:05:25,979
an alert one right cool<font color="#E5E5E5"> so what I just</font>

141
00:05:24,810 --> 00:05:27,479
said a minute ago of don't just

142
00:05:25,979 --> 00:05:29,310
instrument the server side it's rent the

143
00:05:27,479 --> 00:05:31,050
client side<font color="#E5E5E5"> to what happens here and</font>

144
00:05:29,310 --> 00:05:32,610
alert one fires how often do you think

145
00:05:31,050 --> 00:05:35,520
an alert one fires in a real web

146
00:05:32,610 --> 00:05:37,699
application oh well actually<font color="#E5E5E5"> I'll</font><font color="#CCCCCC"> get</font>

147
00:05:35,520 --> 00:05:41,520
too bad a minute funny funny story um

148
00:05:37,699 --> 00:05:44,009
but write your first approach then is ok

149
00:05:41,520 --> 00:05:45,599
this never happens let's override alert

150
00:05:44,009 --> 00:05:46,889
and let's tell if it phone home anytime

151
00:05:45,599 --> 00:05:48,870
and ever execute<font color="#CCCCCC"> to</font><font color="#E5E5E5"> my application</font>

152
00:05:46,889 --> 00:05:51,090
because alert one should never ever

153
00:05:48,870 --> 00:05:53,129
happen I want<font color="#E5E5E5"> to give props words do</font>

154
00:05:51,090 --> 00:05:55,020
here facebook we had some discussions

155
00:05:53,129 --> 00:05:57,449
with him turns out they they came<font color="#CCCCCC"> up</font>

156
00:05:55,020 --> 00:06:00,479
<font color="#E5E5E5">with this in 2007 we came up with this</font>

157
00:05:57,449 --> 00:06:02,310
independently in 2012 one of the awesome

158
00:06:00,479 --> 00:06:04,800
dudes at Facebook mine frame on twitter

159
00:06:02,310 --> 00:06:06,389
if<font color="#E5E5E5"> you don't follow me should did a talk</font>

160
00:06:04,800 --> 00:06:07,680
a trucks<font color="#E5E5E5"> con last year that was awesome</font>

161
00:06:06,389 --> 00:06:09,089
and<font color="#E5E5E5"> this was one</font><font color="#CCCCCC"> of the slides and then</font>

162
00:06:07,680 --> 00:06:11,400
right oh<font color="#E5E5E5"> well they just burned it</font>

163
00:06:09,089 --> 00:06:12,690
so we'll talk about it now too and we

164
00:06:11,400 --> 00:06:14,429
<font color="#E5E5E5">went back and</font><font color="#CCCCCC"> forth</font><font color="#E5E5E5"> on Twitter a little</font>

165
00:06:12,690 --> 00:06:15,870
bit<font color="#E5E5E5"> and then we rolled it out and so</font>

166
00:06:14,430 --> 00:06:17,909
that's<font color="#E5E5E5"> what I want to talk about is is</font>

167
00:06:15,870 --> 00:06:21,089
the results these are the actual results

168
00:06:17,909 --> 00:06:23,940
of overriding alert and having it phone

169
00:06:21,089 --> 00:06:25,650
home whenever whenever it executes it's

170
00:06:23,940 --> 00:06:29,219
a highly technical diagram as you can

171
00:06:25,650 --> 00:06:31,429
see here so let's go<font color="#E5E5E5"> back this failed</font>

172
00:06:29,219 --> 00:06:34,979
spectacularly because of false positives

173
00:06:31,430 --> 00:06:38,849
we turned it on and it just just started

174
00:06:34,979 --> 00:06:40,500
flooding instantly and the<font color="#E5E5E5"> reason why is</font>

175
00:06:38,849 --> 00:06:41,969
when<font color="#E5E5E5"> I said a minute ago how many times</font>

176
00:06:40,500 --> 00:06:43,560
<font color="#CCCCCC">you think your application really calls</font>

177
00:06:41,969 --> 00:06:45,599
alert one well we should have checked

178
00:06:43,560 --> 00:06:47,330
that actually before<font color="#E5E5E5"> we turn that on to</font>

179
00:06:45,599 --> 00:06:49,620
their an application called alert one a

180
00:06:47,330 --> 00:06:53,159
decent amount of times which is

181
00:06:49,620 --> 00:06:54,729
embarrassing so let's go<font color="#CCCCCC"> back and</font><font color="#E5E5E5"> this</font>

182
00:06:53,159 --> 00:06:56,498
<font color="#E5E5E5">is going to be one</font><font color="#CCCCCC"> of them</font>

183
00:06:54,729 --> 00:06:58,808
major themes that to walk out here with

184
00:06:56,499 --> 00:07:00,279
which is that the whole kind of let me

185
00:06:58,809 --> 00:07:02,080
get<font color="#E5E5E5"> buzz-worthy for a second but it's a</font>

186
00:07:00,279 --> 00:07:04,029
shortest way<font color="#E5E5E5"> to say this data-driven</font>

187
00:07:02,080 --> 00:07:05,740
security taking a look at your data and

188
00:07:04,029 --> 00:07:08,050
<font color="#E5E5E5">not just the assumptions of how you</font>

189
00:07:05,740 --> 00:07:09,729
think a tax work because often we're

190
00:07:08,050 --> 00:07:10,509
totally wrong or we have we think that

191
00:07:09,729 --> 00:07:11,589
<font color="#E5E5E5">they're going to work with this way</font>

192
00:07:10,509 --> 00:07:13,300
they're<font color="#E5E5E5"> going to work a different way or</font>

193
00:07:11,589 --> 00:07:15,009
they do work that<font color="#E5E5E5"> way but there's also</font>

194
00:07:13,300 --> 00:07:17,050
times<font color="#CCCCCC"> of false positives</font><font color="#E5E5E5"> there so</font>

195
00:07:15,009 --> 00:07:18,520
looking at your data collecting that

196
00:07:17,050 --> 00:07:20,080
data then looking at that data<font color="#E5E5E5"> and see</font>

197
00:07:18,520 --> 00:07:21,969
how attacks are actually happening and

198
00:07:20,080 --> 00:07:25,508
what are the unique signals out of that

199
00:07:21,969 --> 00:07:29,229
attack data so overriding common methods

200
00:07:25,509 --> 00:07:30,819
cool but we're only interested in<font color="#E5E5E5"> really</font>

201
00:07:29,229 --> 00:07:32,469
what are<font color="#CCCCCC"> the what are the payloads to</font>

202
00:07:30,819 --> 00:07:34,509
<font color="#E5E5E5">those that's where it starts get to</font>

203
00:07:32,469 --> 00:07:37,029
unique so we pulled 30 days of attack

204
00:07:34,509 --> 00:07:40,059
data again and we looked at there were

205
00:07:37,029 --> 00:07:41,710
<font color="#E5E5E5">8500 XSS attempts in that with alert</font>

206
00:07:40,059 --> 00:07:46,300
prompter confirm those are the those<font color="#E5E5E5"> are</font>

207
00:07:41,710 --> 00:07:47,529
<font color="#E5E5E5">the big three that's 99.999% of your</font>

208
00:07:46,300 --> 00:07:51,129
exes s attempts are going to<font color="#E5E5E5"> use one</font><font color="#CCCCCC"> of</font>

209
00:07:47,529 --> 00:07:52,808
those three they were these numbers are

210
00:07:51,129 --> 00:07:55,839
a little bit misleading quite honestly

211
00:07:52,809 --> 00:07:57,370
because the huge spike in prompt on<font color="#E5E5E5"> that</font>

212
00:07:55,839 --> 00:08:00,490
is not what<font color="#E5E5E5"> you actually see in a real</font>

213
00:07:57,370 --> 00:08:02,379
web app the majority<font color="#CCCCCC"> is still alert it's</font>

214
00:08:00,490 --> 00:08:03,939
followed by prompt and confirm it

215
00:08:02,379 --> 00:08:06,490
happened to be during that those 30 days

216
00:08:03,939 --> 00:08:08,439
there was this one just astronomically

217
00:08:06,490 --> 00:08:11,439
large scan that happen to use prompt so

218
00:08:08,439 --> 00:08:13,599
it's<font color="#E5E5E5"> Q the data there and then sometimes</font>

219
00:08:11,439 --> 00:08:15,969
<font color="#E5E5E5">you actually see them with both or with</font>

220
00:08:13,599 --> 00:08:18,610
multiple ones you'll see like a long

221
00:08:15,969 --> 00:08:19,810
string that that in one area attempts to

222
00:08:18,610 --> 00:08:22,689
do in alberton the other attempts to do

223
00:08:19,810 --> 00:08:25,209
a prompt I have no<font color="#CCCCCC"> idea why but you see</font>

224
00:08:22,689 --> 00:08:26,439
it so let's look<font color="#E5E5E5"> at the data from there</font>

225
00:08:25,209 --> 00:08:29,169
what<font color="#CCCCCC"> are the payloads were interested in</font>

226
00:08:26,439 --> 00:08:30,459
again you watch this just you watch the

227
00:08:29,169 --> 00:08:32,260
top ones happen and then you watch it

228
00:08:30,459 --> 00:08:33,760
fall off<font color="#CCCCCC"> a cliff of just long tails and</font>

229
00:08:32,260 --> 00:08:36,990
ones that you could never<font color="#E5E5E5"> hope to</font>

230
00:08:33,760 --> 00:08:40,029
instrument far and<font color="#E5E5E5"> away xss</font>

231
00:08:36,990 --> 00:08:42,190
document.cookie and then integers this

232
00:08:40,029 --> 00:08:43,990
is integers or because of scanners so

233
00:08:42,190 --> 00:08:45,010
when you do a scanner<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you're you</font>

234
00:08:43,990 --> 00:08:46,720
know it's a<font color="#CCCCCC"> headless thing that's</font>

235
00:08:45,010 --> 00:08:49,000
crawling all over a web app you need to

236
00:08:46,720 --> 00:08:50,889
if you trigger execution for XSS you

237
00:08:49,000 --> 00:08:52,480
need a way to map that back to what form

238
00:08:50,889 --> 00:08:54,069
field that was or what input that was so

239
00:08:52,480 --> 00:08:56,290
you do a unique<font color="#CCCCCC"> identifier for each one</font>

240
00:08:54,069 --> 00:08:57,699
and<font color="#CCCCCC"> then you keep it you keep</font><font color="#E5E5E5"> in a you</font>

241
00:08:56,290 --> 00:08:59,050
know a dictionary<font color="#E5E5E5"> of that and then you</font>

242
00:08:57,699 --> 00:09:03,099
see the results come back<font color="#E5E5E5"> and you say</font>

243
00:08:59,050 --> 00:09:05,949
<font color="#E5E5E5">okay 1153 just fired that was this input</font>

244
00:09:03,100 --> 00:09:07,730
let me throw<font color="#CCCCCC"> that into my results and</font>

245
00:09:05,949 --> 00:09:09,019
you would<font color="#CCCCCC"> just watching criminal</font>

246
00:09:07,730 --> 00:09:11,959
go by and<font color="#E5E5E5"> you're like okay cool it's a</font>

247
00:09:09,019 --> 00:09:14,240
scanner one wouldn't like weird lesson

248
00:09:11,959 --> 00:09:16,638
we learned out a document cookie is you

249
00:09:14,240 --> 00:09:19,130
can't<font color="#E5E5E5"> just look for that string any of</font>

250
00:09:16,639 --> 00:09:21,230
the any of the document objects in

251
00:09:19,130 --> 00:09:22,760
<font color="#E5E5E5">JavaScript by the time you can go and do</font>

252
00:09:21,230 --> 00:09:24,410
like a string match on this it<font color="#E5E5E5"> won't be</font>

253
00:09:22,760 --> 00:09:26,089
document.cookie you'll be the contents

254
00:09:24,410 --> 00:09:27,649
of and so<font color="#CCCCCC"> what you actually have to</font>

255
00:09:26,089 --> 00:09:29,180
match on for document.cookie and

256
00:09:27,649 --> 00:09:31,279
document domain and things like that are

257
00:09:29,180 --> 00:09:33,680
the<font color="#E5E5E5"> contents</font><font color="#CCCCCC"> of so any if you want to</font>

258
00:09:31,279 --> 00:09:35,089
match on document.cookie find one of<font color="#E5E5E5"> the</font>

259
00:09:33,680 --> 00:09:37,550
unique cookies in your environment and

260
00:09:35,089 --> 00:09:38,600
match on<font color="#CCCCCC"> that string because that's the</font>

261
00:09:37,550 --> 00:09:42,319
only thing that<font color="#CCCCCC"> you actually can match</font>

262
00:09:38,600 --> 00:09:44,180
on same with domain match on your

263
00:09:42,320 --> 00:09:45,079
domains not not on the literal string we

264
00:09:44,180 --> 00:09:46,459
couldn't figure out why that wasn't

265
00:09:45,079 --> 00:09:49,339
firing for the first day or so when we

266
00:09:46,459 --> 00:09:53,630
were<font color="#E5E5E5"> testing and then we the magic and</font>

267
00:09:49,339 --> 00:09:57,160
<font color="#E5E5E5">printf debugging you learn so we ran an</font>

268
00:09:53,630 --> 00:10:00,290
experiment off of off<font color="#CCCCCC"> of these three</font>

269
00:09:57,160 --> 00:10:02,329
hilariously finds real bugs we thought

270
00:10:00,290 --> 00:10:04,250
<font color="#CCCCCC">that this would find a real bug once and</font>

271
00:10:02,329 --> 00:10:07,329
then there would immediately be a blog

272
00:10:04,250 --> 00:10:09,769
post on us doing<font color="#E5E5E5"> this there hasn't been</font>

273
00:10:07,329 --> 00:10:13,760
which is<font color="#CCCCCC"> awesome no one take that as a</font>

274
00:10:09,769 --> 00:10:16,730
challenge or a thing to tweet just being

275
00:10:13,760 --> 00:10:20,839
open it needs adjustments in the first

276
00:10:16,730 --> 00:10:22,880
few days you'll have areas of your app

277
00:10:20,839 --> 00:10:24,230
that<font color="#E5E5E5"> or maybe like you think or debug</font>

278
00:10:22,880 --> 00:10:26,329
code or something like that but<font color="#E5E5E5"> turns</font>

279
00:10:24,230 --> 00:10:28,760
out it gets hit by one percent of your

280
00:10:26,329 --> 00:10:31,459
user base and that at scale that becomes

281
00:10:28,760 --> 00:10:34,100
a ton of data<font color="#CCCCCC"> you're whitelisted real</font>

282
00:10:31,459 --> 00:10:35,768
fast though like this in our case<font color="#CCCCCC"> it was</font>

283
00:10:34,100 --> 00:10:38,319
spend about<font color="#CCCCCC"> the first 24 hours on it</font>

284
00:10:35,769 --> 00:10:40,130
<font color="#E5E5E5">whitelist a few things and you're good</font>

285
00:10:38,319 --> 00:10:41,630
so what else does a good job of

286
00:10:40,130 --> 00:10:43,490
<font color="#CCCCCC">detecting access and we're gonna stay on</font>

287
00:10:41,630 --> 00:10:45,649
<font color="#E5E5E5">the client side for a bit I want to give</font>

288
00:10:43,490 --> 00:10:48,050
them<font color="#E5E5E5"> a shout out google chrome's XSS</font>

289
00:10:45,649 --> 00:10:50,120
auditor thing sounded like a laughable

290
00:10:48,050 --> 00:10:52,010
idea when when first heard it it's

291
00:10:50,120 --> 00:10:56,480
totally awesome like props to them it's

292
00:10:52,010 --> 00:10:58,370
good stuff it is so chrome XSS auditor<font color="#E5E5E5"> I</font>

293
00:10:56,480 --> 00:10:59,269
could probably spend too long on<font color="#E5E5E5"> this</font>

294
00:10:58,370 --> 00:11:04,040
and I'm<font color="#E5E5E5"> probably gonna get this wrong</font>

295
00:10:59,269 --> 00:11:05,600
anyway the TLDR is that there's some

296
00:11:04,040 --> 00:11:09,319
code built into google chrome that

297
00:11:05,600 --> 00:11:11,060
essentially it it's scoped for a very

298
00:11:09,319 --> 00:11:12,290
narrow set of attacks but it does a

299
00:11:11,060 --> 00:11:15,050
pretty good job of them which are

300
00:11:12,290 --> 00:11:17,870
reflected XSS attacks that happen in

301
00:11:15,050 --> 00:11:19,640
HTML so either inside HTML or the

302
00:11:17,870 --> 00:11:20,960
creation of new HTML elements they don't

303
00:11:19,640 --> 00:11:23,900
try<font color="#E5E5E5"> to solve javascript because</font>

304
00:11:20,960 --> 00:11:24,920
actually very hard and so they focus it

305
00:11:23,900 --> 00:11:27,470
for this and they did really<font color="#E5E5E5"> good job of</font>

306
00:11:24,920 --> 00:11:28,610
it so you you essentially and this is

307
00:11:27,470 --> 00:11:31,250
the part<font color="#E5E5E5"> I may have wrong but</font>

308
00:11:28,610 --> 00:11:32,720
conceptually it's close enough you

309
00:11:31,250 --> 00:11:34,850
record the parameters that are sent in a

310
00:11:32,720 --> 00:11:36,860
request that compass ostensibly come

311
00:11:34,850 --> 00:11:38,750
from the user and then you compare about

312
00:11:36,860 --> 00:11:39,920
what shows up in the<font color="#CCCCCC"> DOM and</font><font color="#E5E5E5"> if there's</font>

313
00:11:38,750 --> 00:11:42,380
something that comes from the user

314
00:11:39,920 --> 00:11:44,719
<font color="#E5E5E5">request that then creates like an HTML</font>

315
00:11:42,380 --> 00:11:48,250
element like that ah you strip them out

316
00:11:44,720 --> 00:11:50,780
and so this<font color="#CCCCCC"> is this is like your classic</font>

317
00:11:48,250 --> 00:11:53,510
you know search engine thing of like<font color="#E5E5E5"> Q</font>

318
00:11:50,780 --> 00:11:55,910
equals script alert<font color="#E5E5E5"> one when that comes</font>

319
00:11:53,510 --> 00:11:58,490
back<font color="#E5E5E5"> into the DOM and triggers as HTML</font>

320
00:11:55,910 --> 00:11:59,870
and execute they strip it out that's why

321
00:11:58,490 --> 00:12:01,520
when you're when you're doing like pen

322
00:11:59,870 --> 00:12:03,500
testing with chrome you go in and you

323
00:12:01,520 --> 00:12:05,540
disable this feature as the<font color="#E5E5E5"> browser's</font>

324
00:12:03,500 --> 00:12:06,890
are doing<font color="#E5E5E5"> more and more of this and I</font>

325
00:12:05,540 --> 00:12:09,410
think Firefox is starting to do<font color="#E5E5E5"> this too</font>

326
00:12:06,890 --> 00:12:11,150
I know no script does something similar

327
00:12:09,410 --> 00:12:14,390
like that it's awesome<font color="#CCCCCC"> they really</font>

328
00:12:11,150 --> 00:12:16,100
<font color="#E5E5E5">deserve a shout out on that the problem</font>

329
00:12:14,390 --> 00:12:18,890
<font color="#E5E5E5">here is that ultimately you're running a</font>

330
00:12:16,100 --> 00:12:19,940
losing game well you're winning the game

331
00:12:18,890 --> 00:12:21,740
that<font color="#E5E5E5"> you're trying to that you're trying</font>

332
00:12:19,940 --> 00:12:24,860
<font color="#E5E5E5">to play but ultimately</font><font color="#CCCCCC"> they can't chrome</font>

333
00:12:21,740 --> 00:12:26,570
can't fix xss in your application and

334
00:12:24,860 --> 00:12:28,280
the user<font color="#E5E5E5"> can like you can you can defend</font>

335
00:12:26,570 --> 00:12:29,570
the user against<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of like basic</font>

336
00:12:28,280 --> 00:12:32,270
things and that's<font color="#CCCCCC"> awesome and</font><font color="#E5E5E5"> we should</font>

337
00:12:29,570 --> 00:12:34,730
be doing<font color="#E5E5E5"> that but how can</font><font color="#CCCCCC"> we as</font>

338
00:12:32,270 --> 00:12:36,410
application owners and defenders use

339
00:12:34,730 --> 00:12:38,930
this same principle and get some like

340
00:12:36,410 --> 00:12:40,730
cool value out of it so you can use the

341
00:12:38,930 --> 00:12:43,819
same you can use the same thing how can

342
00:12:40,730 --> 00:12:47,480
<font color="#E5E5E5">we do</font><font color="#CCCCCC"> it on the server side what you do</font>

343
00:12:43,820 --> 00:12:48,920
is you scan you scan input you know gets

344
00:12:47,480 --> 00:12:51,680
in your posts and<font color="#E5E5E5"> things like that for</font>

345
00:12:48,920 --> 00:12:54,349
HTML escapes and for tag creation if it

346
00:12:51,680 --> 00:12:57,109
exists you set a flag and you say<font color="#CCCCCC"> okay</font>

347
00:12:54,350 --> 00:12:58,400
this input was potentially hostile here

348
00:12:57,110 --> 00:13:01,070
trying<font color="#E5E5E5"> to escape</font><font color="#CCCCCC"> it's trying</font><font color="#E5E5E5"> to create</font>

349
00:12:58,400 --> 00:13:03,050
cool set that flag to true<font color="#E5E5E5"> and then</font>

350
00:13:01,070 --> 00:13:05,210
build up an array of what all of<font color="#CCCCCC"> those</font>

351
00:13:03,050 --> 00:13:07,550
look like so there was a double<font color="#E5E5E5"> quote</font>

352
00:13:05,210 --> 00:13:10,520
closed bracket script alert<font color="#CCCCCC"> open bracket</font>

353
00:13:07,550 --> 00:13:12,650
script alert one there was a quote on

354
00:13:10,520 --> 00:13:15,680
error equals alert one whatever it was

355
00:13:12,650 --> 00:13:17,569
<font color="#E5E5E5">build that up into an array at output</font>

356
00:13:15,680 --> 00:13:20,270
time right is your as your outputs

357
00:13:17,570 --> 00:13:23,420
flying out the door check that flag if

358
00:13:20,270 --> 00:13:25,730
it was true then iterate through the

359
00:13:23,420 --> 00:13:27,319
page that's<font color="#E5E5E5"> going out and see if any of</font>

360
00:13:25,730 --> 00:13:30,740
the hostile input that was in<font color="#CCCCCC"> that array</font>

361
00:13:27,320 --> 00:13:32,870
is actually as valid HTML in the page if

362
00:13:30,740 --> 00:13:34,200
it's live inside of<font color="#CCCCCC"> a tag if it's it's</font>

363
00:13:32,870 --> 00:13:36,410
<font color="#E5E5E5">own tag whatever</font>

364
00:13:34,200 --> 00:13:38,670
and if<font color="#E5E5E5"> it is you fail open here actually</font>

365
00:13:36,410 --> 00:13:40,380
there may<font color="#CCCCCC"> come a point where too early</font>

366
00:13:38,670 --> 00:13:42,870
and<font color="#CCCCCC"> are testing on this to say for</font>

367
00:13:40,380 --> 00:13:44,189
certain what what comes of this there

368
00:13:42,870 --> 00:13:45,420
may<font color="#CCCCCC"> come a point where you start to do</font>

369
00:13:44,190 --> 00:13:48,720
<font color="#E5E5E5">the Google approach and just strip it</font>

370
00:13:45,420 --> 00:13:51,540
out and get like get very proactive

371
00:13:48,720 --> 00:13:53,730
there I'd<font color="#CCCCCC"> be shocked if we end</font><font color="#E5E5E5"> up doing</font>

372
00:13:51,540 --> 00:13:54,990
<font color="#E5E5E5">that just because the cost of failure is</font>

373
00:13:53,730 --> 00:13:58,620
kind of high they're kind of breaking

374
00:13:54,990 --> 00:14:00,660
your app but you can sure alert like you

375
00:13:58,620 --> 00:14:02,040
go from here and if<font color="#CCCCCC"> that's valid HTML</font>

376
00:14:00,660 --> 00:14:03,420
it's going<font color="#E5E5E5"> out the door thats in one of</font>

377
00:14:02,040 --> 00:14:06,360
those requests you just found reflected

378
00:14:03,420 --> 00:14:09,240
XSS in your app<font color="#E5E5E5"> and then the important</font>

379
00:14:06,360 --> 00:14:11,610
part here is maybe you go maybe<font color="#E5E5E5"> you do</font>

380
00:14:09,240 --> 00:14:13,530
the risk trade-off of maybe I'll break

381
00:14:11,610 --> 00:14:15,810
my app but<font color="#E5E5E5"> I'll stop some reflected XSS</font>

382
00:14:13,530 --> 00:14:17,010
if your time to patch is very high but

383
00:14:15,810 --> 00:14:18,599
if you're<font color="#E5E5E5"> doing with an app that's got</font>

384
00:14:17,010 --> 00:14:20,310
it on a six-month release cycle or

385
00:14:18,600 --> 00:14:22,170
something in the same<font color="#E5E5E5"> way that you then</font>

386
00:14:20,310 --> 00:14:24,359
use laughs and those sort of things

387
00:14:22,170 --> 00:14:26,520
there if your time to release is very

388
00:14:24,360 --> 00:14:28,950
quick right if pushing<font color="#CCCCCC"> the production</font>

389
00:14:26,520 --> 00:14:31,020
takes 20 minutes then cool detection

390
00:14:28,950 --> 00:14:32,940
works works great<font color="#E5E5E5"> they're right by the</font>

391
00:14:31,020 --> 00:14:33,870
<font color="#CCCCCC">time you discover this XSS and by the</font>

392
00:14:32,940 --> 00:14:35,400
time you<font color="#CCCCCC"> actually attack your target</font>

393
00:14:33,870 --> 00:14:36,900
it's almost certainly going to be<font color="#E5E5E5"> more</font>

394
00:14:35,400 --> 00:14:38,160
than 20<font color="#E5E5E5"> minutes you got to go build up</font>

395
00:14:36,900 --> 00:14:40,079
the payload that you really want like

396
00:14:38,160 --> 00:14:41,670
you just found XSS with with script

397
00:14:40,080 --> 00:14:44,100
alert one you need<font color="#E5E5E5"> to go build up the</font>

398
00:14:41,670 --> 00:14:45,479
table that<font color="#CCCCCC"> you want you need to get your</font>

399
00:14:44,100 --> 00:14:47,010
target to click on that if<font color="#E5E5E5"> that's like a</font>

400
00:14:45,480 --> 00:14:48,270
targeted attack or you need to build<font color="#E5E5E5"> up</font>

401
00:14:47,010 --> 00:14:52,800
some sort of worm if you're trying to

402
00:14:48,270 --> 00:14:54,030
just go<font color="#CCCCCC"> for mass propagation and yeah if</font>

403
00:14:52,800 --> 00:14:56,189
you can patch quick enough then<font color="#CCCCCC"> you just</font>

404
00:14:54,030 --> 00:14:58,579
patch you kill it<font color="#E5E5E5"> all right let's talk</font>

405
00:14:56,190 --> 00:15:03,270
<font color="#E5E5E5">about bottom tables so favorite friends</font>

406
00:14:58,580 --> 00:15:05,640
let's go to sequel injection so let's

407
00:15:03,270 --> 00:15:09,300
talk about anomalies along the actual

408
00:15:05,640 --> 00:15:11,370
attack chain of sequel injection there's

409
00:15:09,300 --> 00:15:13,229
kind of this<font color="#E5E5E5"> I don't think it's a</font>

410
00:15:11,370 --> 00:15:16,710
misunderstanding I think it's that we

411
00:15:13,230 --> 00:15:17,880
<font color="#E5E5E5">just kind of gloss over the fact of from</font>

412
00:15:16,710 --> 00:15:19,710
when you discover sequel injection

413
00:15:17,880 --> 00:15:22,590
vulnerabilities to when you actually the

414
00:15:19,710 --> 00:15:25,140
<font color="#CCCCCC">time from tick or one equals one to</font>

415
00:15:22,590 --> 00:15:27,450
paste bin is actually a timeline right

416
00:15:25,140 --> 00:15:29,430
it's<font color="#E5E5E5"> not instant it's not i just found</font>

417
00:15:27,450 --> 00:15:31,140
is a verbose equal error message and now

418
00:15:29,430 --> 00:15:32,880
<font color="#E5E5E5">i've got the full table there's an</font>

419
00:15:31,140 --> 00:15:34,650
attack chain there and we can instrument

420
00:15:32,880 --> 00:15:36,540
that attack chain there so it starts<font color="#CCCCCC"> out</font>

421
00:15:34,650 --> 00:15:38,610
with this this isn't<font color="#CCCCCC"> the attack this is</font>

422
00:15:36,540 --> 00:15:41,579
the discovery this is sequel syntax

423
00:15:38,610 --> 00:15:43,020
error showing up I've talked about a few

424
00:15:41,580 --> 00:15:44,430
of the things in the section in some

425
00:15:43,020 --> 00:15:46,600
previous talks but I think they're both

426
00:15:44,430 --> 00:15:48,370
a really important and<font color="#E5E5E5"> be</font>

427
00:15:46,600 --> 00:15:50,980
really effective and so<font color="#E5E5E5"> I'm going to go</font>

428
00:15:48,370 --> 00:15:52,509
<font color="#CCCCCC">back over a</font><font color="#E5E5E5"> few of these because this is</font>

429
00:15:50,980 --> 00:15:54,630
one of<font color="#E5E5E5"> the best things you can do that</font>

430
00:15:52,509 --> 00:15:57,069
<font color="#E5E5E5">you can almost certainly turn on today</font>

431
00:15:54,630 --> 00:15:58,600
alerting on sequel syntax<font color="#E5E5E5"> errors showing</font>

432
00:15:57,069 --> 00:16:00,779
up in your application it's<font color="#E5E5E5"> almost</font>

433
00:15:58,600 --> 00:16:03,519
certainly already in your area log it's

434
00:16:00,779 --> 00:16:07,449
incredibly high value even if it isn't a

435
00:16:03,519 --> 00:16:09,130
right<font color="#E5E5E5"> this is near that that's that's</font>

436
00:16:07,449 --> 00:16:11,109
some generic bug that well knowing

437
00:16:09,130 --> 00:16:13,540
knowing what I know about our stack this

438
00:16:11,110 --> 00:16:15,220
isn't exploitable but it's still<font color="#E5E5E5"> above</font>

439
00:16:13,540 --> 00:16:18,310
right and you'll start<font color="#CCCCCC"> to see that in</font>

440
00:16:15,220 --> 00:16:19,750
your stack very quickly<font color="#E5E5E5"> okay here's a</font>

441
00:16:18,310 --> 00:16:21,939
here's a bug that's<font color="#E5E5E5"> not exploitable</font>

442
00:16:19,750 --> 00:16:23,740
let's fix it here's one that oh wow yeah

443
00:16:21,940 --> 00:16:26,170
okay that one is exploitable let's go

444
00:16:23,740 --> 00:16:27,639
fix out immediately and<font color="#E5E5E5"> the important</font>

445
00:16:26,170 --> 00:16:28,750
point is<font color="#CCCCCC"> there</font><font color="#E5E5E5"> they're all bugs some of</font>

446
00:16:27,639 --> 00:16:32,649
them have serious security implications

447
00:16:28,750 --> 00:16:34,089
some don't they're all bugs moving down

448
00:16:32,649 --> 00:16:35,560
the attack chain this<font color="#E5E5E5"> is looking from</font>

449
00:16:34,089 --> 00:16:37,959
<font color="#CCCCCC">the attack side is you need to figure</font>

450
00:16:35,560 --> 00:16:39,008
<font color="#E5E5E5">out what</font><font color="#CCCCCC"> that database is what hair are</font>

451
00:16:37,959 --> 00:16:40,508
the tables that contain the information

452
00:16:39,009 --> 00:16:42,370
that<font color="#E5E5E5"> you want what are you actually</font>

453
00:16:40,509 --> 00:16:44,889
going after you need to map out all the

454
00:16:42,370 --> 00:16:46,149
table names and things like that from

455
00:16:44,889 --> 00:16:47,589
the defense<font color="#E5E5E5"> side what does that signal</font>

456
00:16:46,149 --> 00:16:50,050
look like almost certainly your

457
00:16:47,589 --> 00:16:51,569
application doesn't request sensitive

458
00:16:50,050 --> 00:16:54,339
table names as part of a get parameter

459
00:16:51,569 --> 00:16:56,199
when your user sessions table shows up

460
00:16:54,339 --> 00:16:58,600
as a get parameter to your search query

461
00:16:56,199 --> 00:17:01,389
uh you probably want<font color="#E5E5E5"> to know about that</font>

462
00:16:58,600 --> 00:17:02,410
<font color="#E5E5E5">one probably a little unique and the</font>

463
00:17:01,389 --> 00:17:03,639
important<font color="#E5E5E5"> point there is actually the</font>

464
00:17:02,410 --> 00:17:05,530
<font color="#E5E5E5">fact that that's unique and not even</font>

465
00:17:03,639 --> 00:17:08,039
necessarily an attack and that's what's

466
00:17:05,530 --> 00:17:10,059
cool about thinking<font color="#E5E5E5"> about this from</font>

467
00:17:08,039 --> 00:17:12,569
anomalous signals and looking for

468
00:17:10,059 --> 00:17:15,699
anomalies is that if they<font color="#CCCCCC"> are anomalies</font>

469
00:17:12,569 --> 00:17:17,199
<font color="#E5E5E5">false positive cost is extremely low the</font>

470
00:17:15,699 --> 00:17:19,209
cost of looking at an email that says

471
00:17:17,199 --> 00:17:21,100
sensitive table names just showed up and

472
00:17:19,209 --> 00:17:22,929
you're in a request here is almost

473
00:17:21,099 --> 00:17:24,069
<font color="#E5E5E5">nothing if it happens once a week</font>

474
00:17:22,929 --> 00:17:25,959
<font color="#E5E5E5">because you look at me like oh yeah</font>

475
00:17:24,069 --> 00:17:27,849
that's false positive obviously or

476
00:17:25,959 --> 00:17:31,059
what's that<font color="#E5E5E5"> I need to go check</font><font color="#CCCCCC"> that out</font>

477
00:17:27,849 --> 00:17:34,240
when<font color="#E5E5E5"> the cost is so low it's it's</font><font color="#CCCCCC"> crazy</font>

478
00:17:31,059 --> 00:17:35,710
to not do it finally kind of near the

479
00:17:34,240 --> 00:17:38,080
<font color="#E5E5E5">end of the attack chain and I'm kind of</font>

480
00:17:35,710 --> 00:17:40,600
kind of jumping over a few things here

481
00:17:38,080 --> 00:17:42,580
but<font color="#E5E5E5"> at the end of it a response</font>

482
00:17:40,600 --> 00:17:44,230
containing your database is orders of

483
00:17:42,580 --> 00:17:47,559
magnitude larger than a normal response

484
00:17:44,230 --> 00:17:50,679
<font color="#E5E5E5">right a search for kittens and select</font>

485
00:17:47,559 --> 00:17:53,950
star from user table<font color="#CCCCCC"> uh wildly different</font>

486
00:17:50,679 --> 00:17:55,330
response sizes when anomalously large

487
00:17:53,950 --> 00:17:57,460
responses start going out the door

488
00:17:55,330 --> 00:18:00,080
that's another incredibly interesting

489
00:17:57,460 --> 00:18:02,029
alert in

490
00:18:00,080 --> 00:18:03,889
modern applications where that starts to

491
00:18:02,029 --> 00:18:06,350
the little devil in the details and the

492
00:18:03,890 --> 00:18:08,059
trick on this one is<font color="#E5E5E5"> that lots of our</font>

493
00:18:06,350 --> 00:18:10,459
<font color="#E5E5E5">applications do have endpoints that are</font>

494
00:18:08,059 --> 00:18:11,779
that result<font color="#E5E5E5"> in huge response sizes you</font>

495
00:18:10,460 --> 00:18:12,919
either whitelist those out because

496
00:18:11,779 --> 00:18:15,049
you've code reviewed them enough that

497
00:18:12,919 --> 00:18:16,850
you're like<font color="#E5E5E5"> alright that's cool it's job</font>

498
00:18:15,049 --> 00:18:18,799
is to return this one file or this one

499
00:18:16,850 --> 00:18:21,740
thing it's going<font color="#E5E5E5"> to be a large spots</font>

500
00:18:18,799 --> 00:18:23,480
responses but I'm cool with<font color="#E5E5E5"> it</font><font color="#CCCCCC"> I think</font>

501
00:18:21,740 --> 00:18:24,830
it's good and<font color="#E5E5E5"> so that's how you actually</font>

502
00:18:23,480 --> 00:18:27,230
that's what you deal with in the<font color="#E5E5E5"> first</font>

503
00:18:24,830 --> 00:18:30,199
week or so of this as that functionality

504
00:18:27,230 --> 00:18:32,419
gets found<font color="#E5E5E5"> whitelist those you go from</font>

505
00:18:30,200 --> 00:18:34,190
<font color="#E5E5E5">there the point of all this is</font><font color="#CCCCCC"> not to</font>

506
00:18:32,419 --> 00:18:36,529
just<font color="#E5E5E5"> alert in one spot all these</font><font color="#CCCCCC"> are</font>

507
00:18:34,190 --> 00:18:40,580
interesting by themselves but they're

508
00:18:36,529 --> 00:18:42,139
incredibly valuable in a chain the more

509
00:18:40,580 --> 00:18:43,399
that you do the more context you<font color="#CCCCCC"> have</font>

510
00:18:42,139 --> 00:18:46,070
when you start to look at it and we're

511
00:18:43,399 --> 00:18:47,239
clarity you have because like I said

512
00:18:46,070 --> 00:18:48,559
false positives happen and they happen

513
00:18:47,240 --> 00:18:50,600
all the time in<font color="#E5E5E5"> production</font>

514
00:18:48,559 --> 00:18:52,220
infrastructure so like let's look at

515
00:18:50,600 --> 00:18:54,830
this from the alerts I was talking about

516
00:18:52,220 --> 00:18:55,940
<font color="#E5E5E5">here you have you have a sequel syntax</font>

517
00:18:54,830 --> 00:18:58,309
errors alert in place that's

518
00:18:55,940 --> 00:19:00,350
deliberately great it doesn't go off you

519
00:18:58,309 --> 00:19:04,070
have a database<font color="#CCCCCC"> table names alert in</font>

520
00:19:00,350 --> 00:19:05,360
place it suddenly<font color="#CCCCCC"> goes off I know large</font>

521
00:19:04,070 --> 00:19:06,889
response size has ever go out the door

522
00:19:05,360 --> 00:19:10,219
obviously I'm over simplifying here a

523
00:19:06,889 --> 00:19:11,990
bit<font color="#E5E5E5"> but this is false positive right but</font>

524
00:19:10,220 --> 00:19:14,690
the fact<font color="#CCCCCC"> that you have these three</font>

525
00:19:11,990 --> 00:19:16,100
alerts or n alerts means that when you

526
00:19:14,690 --> 00:19:17,929
get when you feel that<font color="#E5E5E5"> you've</font>

527
00:19:16,100 --> 00:19:21,559
instrumented the attack chain fairly

528
00:19:17,929 --> 00:19:23,600
well and one in<font color="#E5E5E5"> the middle goes off then</font>

529
00:19:21,559 --> 00:19:25,010
you know like okay well this odds are

530
00:19:23,600 --> 00:19:26,330
this is<font color="#CCCCCC"> a false positive I'm so</font>

531
00:19:25,010 --> 00:19:27,710
obviously going to treat<font color="#E5E5E5"> this as real</font>

532
00:19:26,330 --> 00:19:31,460
and go analyze it go take a look at it

533
00:19:27,710 --> 00:19:33,019
but the fact<font color="#CCCCCC"> that sequel syntax are like</font>

534
00:19:31,460 --> 00:19:34,940
thinking from<font color="#E5E5E5"> the other side if sequel</font>

535
00:19:33,019 --> 00:19:36,289
syntax errors goes off and then data

536
00:19:34,940 --> 00:19:38,240
database table names start appearing

537
00:19:36,289 --> 00:19:40,340
like a<font color="#E5E5E5"> couple hours</font><font color="#CCCCCC"> later and then a few</font>

538
00:19:38,240 --> 00:19:41,299
<font color="#CCCCCC">minutes later large response sizes start</font>

539
00:19:40,340 --> 00:19:42,769
appearing and then around<font color="#E5E5E5"> the</font>

540
00:19:41,299 --> 00:19:44,629
organization this face starts appearing

541
00:19:42,769 --> 00:19:47,419
you know that something is<font color="#E5E5E5"> actually</font>

542
00:19:44,630 --> 00:19:49,159
going on right and every alert<font color="#E5E5E5"> that you</font>

543
00:19:47,419 --> 00:19:50,570
have along this chain increases your

544
00:19:49,159 --> 00:19:53,450
confidence that you know that

545
00:19:50,570 --> 00:19:55,908
something's going<font color="#CCCCCC"> on all right no code</font>

546
00:19:53,450 --> 00:19:59,299
execution like said shout out with

547
00:19:55,909 --> 00:20:00,350
questions<font color="#E5E5E5"> I'm flying through so does</font>

548
00:19:59,299 --> 00:20:02,269
<font color="#CCCCCC">anyone remember this reddit post from</font>

549
00:20:00,350 --> 00:20:03,918
like a month or so ago it was<font color="#CCCCCC"> like</font>

550
00:20:02,269 --> 00:20:05,750
everyone just started rolling<font color="#CCCCCC"> with it</font>

551
00:20:03,919 --> 00:20:07,700
was amazing if somebody asking<font color="#E5E5E5"> like hey</font>

552
00:20:05,750 --> 00:20:09,799
it's just good to create users for my

553
00:20:07,700 --> 00:20:11,480
web application it would just pipe input

554
00:20:09,799 --> 00:20:11,950
directly into the shell<font color="#E5E5E5"> and so the</font>

555
00:20:11,480 --> 00:20:14,350
reddit com

556
00:20:11,950 --> 00:20:17,500
we're just it's just an entire thread of

557
00:20:14,350 --> 00:20:18,850
this<font color="#E5E5E5"> it was spectacular I like I like</font>

558
00:20:17,500 --> 00:20:20,289
<font color="#E5E5E5">the one about the permission to is like</font>

559
00:20:18,850 --> 00:20:21,760
<font color="#E5E5E5">something like it's going to create a</font>

560
00:20:20,289 --> 00:20:24,309
user account first so I just<font color="#E5E5E5"> like to</font>

561
00:20:21,760 --> 00:20:27,309
ID'd everything or yeah<font color="#CCCCCC"> Souter is yeah</font>

562
00:20:24,309 --> 00:20:32,678
it's awesome yeah yeah it's called<font color="#E5E5E5"> Yolo</font>

563
00:20:27,309 --> 00:20:34,389
dot PHP okay let<font color="#E5E5E5"> me let me go from</font>

564
00:20:32,679 --> 00:20:37,299
making<font color="#E5E5E5"> fun of someone else to making fun</font>

565
00:20:34,389 --> 00:20:39,039
of myself which is learn<font color="#CCCCCC"> from our pain</font>

566
00:20:37,299 --> 00:20:41,799
<font color="#E5E5E5">on this one so</font><font color="#CCCCCC"> if i can give you one</font>

567
00:20:39,039 --> 00:20:43,240
statement here it's even<font color="#CCCCCC"> the code that</font>

568
00:20:41,799 --> 00:20:45,279
you want to be<font color="#E5E5E5"> permanent in production</font>

569
00:20:43,240 --> 00:20:46,929
is nowhere near as permanent as your

570
00:20:45,279 --> 00:20:50,409
temporary debug code that you forgot

571
00:20:46,929 --> 00:20:52,750
about one of<font color="#E5E5E5"> the worst</font><font color="#CCCCCC"> volens we ever</font>

572
00:20:50,409 --> 00:20:54,429
had was some temporary debug code that

573
00:20:52,750 --> 00:20:56,230
was in production and we went and we

574
00:20:54,429 --> 00:20:58,200
looked at<font color="#CCCCCC"> it and it essentially allowed</font>

575
00:20:56,230 --> 00:21:01,480
this is again where it gets embarrassing

576
00:20:58,200 --> 00:21:03,250
it essentially just took just like the

577
00:21:01,480 --> 00:21:05,559
previous<font color="#E5E5E5"> one it took a youth elite took</font>

578
00:21:03,250 --> 00:21:06,789
like a URL parameter and just piped it

579
00:21:05,559 --> 00:21:09,279
to system like it<font color="#CCCCCC"> just</font><font color="#E5E5E5"> straight-up</font>

580
00:21:06,789 --> 00:21:11,289
executed and it was<font color="#E5E5E5"> behind a bunch of</font>

581
00:21:09,279 --> 00:21:12,580
things that you<font color="#E5E5E5"> had to you had to have</font>

582
00:21:11,289 --> 00:21:16,570
some special access<font color="#CCCCCC"> to get there</font><font color="#E5E5E5"> and</font>

583
00:21:12,580 --> 00:21:18,189
stuff like that<font color="#E5E5E5"> but it</font><font color="#CCCCCC"> was it had like</font><font color="#E5E5E5"> a</font>

584
00:21:16,570 --> 00:21:19,990
<font color="#E5E5E5">specific ticket number in the code like</font>

585
00:21:18,190 --> 00:21:21,880
oh this is to do with this deployment

586
00:21:19,990 --> 00:21:23,649
because this is the<font color="#CCCCCC"> only way we can test</font>

587
00:21:21,880 --> 00:21:25,600
this one thing that it's out on<font color="#CCCCCC"> this</font>

588
00:21:23,649 --> 00:21:26,979
certain web server and like it's totally

589
00:21:25,600 --> 00:21:28,449
with<font color="#E5E5E5"> the best of intentions it wasn't</font>

590
00:21:26,980 --> 00:21:29,590
just<font color="#E5E5E5"> like somebody pushed something like</font>

591
00:21:28,450 --> 00:21:31,539
that to production not thinking<font color="#CCCCCC"> about it</font>

592
00:21:29,590 --> 00:21:33,459
they knew it<font color="#CCCCCC"> was dangerous it referenced</font>

593
00:21:31,539 --> 00:21:36,340
like a whole ticket around that it was

594
00:21:33,460 --> 00:21:38,620
like remove this in a week the date

595
00:21:36,340 --> 00:21:41,860
stamp on that was a year and a<font color="#CCCCCC"> half two</font>

596
00:21:38,620 --> 00:21:43,239
years so ago it's one of<font color="#E5E5E5"> those what's</font>

597
00:21:41,860 --> 00:21:44,529
<font color="#E5E5E5">great about this is it had the easiest</font>

598
00:21:43,240 --> 00:21:47,380
patch you ever get to do which is just

599
00:21:44,529 --> 00:21:49,000
get RM right and it's just gone but it

600
00:21:47,380 --> 00:21:51,039
got us thinking about<font color="#E5E5E5"> this like holy</font>

601
00:21:49,000 --> 00:21:52,929
<font color="#E5E5E5">crap that's scary right this is one of</font>

602
00:21:51,039 --> 00:21:54,490
<font color="#E5E5E5">the worst phones we've ever had and it</font>

603
00:21:52,929 --> 00:21:56,710
was one of<font color="#E5E5E5"> the simplest and it was just</font>

604
00:21:54,490 --> 00:21:58,659
absurd how do<font color="#E5E5E5"> we how we go about</font>

605
00:21:56,710 --> 00:22:00,279
automating this to try to<font color="#E5E5E5"> find this like</font>

606
00:21:58,659 --> 00:22:01,360
<font color="#E5E5E5">this should have what are the alerts</font>

607
00:22:00,279 --> 00:22:02,500
that should have woken us up in<font color="#E5E5E5"> the</font>

608
00:22:01,360 --> 00:22:05,139
middle of<font color="#E5E5E5"> the night if something like</font>

609
00:22:02,500 --> 00:22:07,120
this ever existed again and it turns out

610
00:22:05,139 --> 00:22:09,399
you<font color="#E5E5E5"> I'd say everyone in this room</font>

611
00:22:07,120 --> 00:22:10,779
already has the tools to find<font color="#CCCCCC"> exactly</font>

612
00:22:09,399 --> 00:22:13,928
that sort of vulnerability pattern and

613
00:22:10,779 --> 00:22:16,210
it's your access log um I'm jumping

614
00:22:13,929 --> 00:22:18,070
<font color="#E5E5E5">ahead a few slides but looking at where</font>

615
00:22:16,210 --> 00:22:21,190
your traffic goes and alerting where it

616
00:22:18,070 --> 00:22:23,740
doesn't<font color="#E5E5E5"> so what you do is you map so you</font>

617
00:22:21,190 --> 00:22:25,389
you take your your<font color="#CCCCCC"> htdocs</font><font color="#E5E5E5"> or your your</font>

618
00:22:23,740 --> 00:22:26,649
production<font color="#CCCCCC"> reading right you</font>

619
00:22:25,389 --> 00:22:28,389
level with<font color="#E5E5E5"> the files in that and then</font>

620
00:22:26,649 --> 00:22:32,079
<font color="#CCCCCC">you take</font><font color="#E5E5E5"> a look at your access log and</font>

621
00:22:28,389 --> 00:22:33,879
you map requests<font color="#E5E5E5"> to end points and end</font>

622
00:22:32,079 --> 00:22:36,219
points that don't get requests or

623
00:22:33,879 --> 00:22:38,408
anomalous if you have a if you have a

624
00:22:36,219 --> 00:22:40,599
production website that has an<font color="#E5E5E5"> end point</font>

625
00:22:38,409 --> 00:22:42,249
that has had less then I'll make up a

626
00:22:40,599 --> 00:22:44,799
number a thousand requests in a month

627
00:22:42,249 --> 00:22:46,299
that's dead code like that is<font color="#E5E5E5"> completely</font>

628
00:22:44,799 --> 00:22:47,829
dead code go look at the access<font color="#CCCCCC"> log</font>

629
00:22:46,299 --> 00:22:49,899
that's<font color="#E5E5E5"> going to be entirely search</font>

630
00:22:47,829 --> 00:22:50,829
crawlers and things like that hopefully

631
00:22:49,899 --> 00:22:52,299
not search crawlers because then

632
00:22:50,829 --> 00:22:55,839
somebody can<font color="#CCCCCC"> find you but probably</font>

633
00:22:52,299 --> 00:22:58,059
search crawlers dead code kill<font color="#CCCCCC"> it don't</font>

634
00:22:55,839 --> 00:22:59,769
kill it automatically alert off it but

635
00:22:58,059 --> 00:23:02,229
the the awesome thing about this and

636
00:22:59,769 --> 00:23:04,269
alerting off of it um yeah like sit

637
00:23:02,229 --> 00:23:06,009
still reachable and everything the

638
00:23:04,269 --> 00:23:08,979
awesome thing here is you pay a one-time

639
00:23:06,009 --> 00:23:10,839
<font color="#E5E5E5">ah you pay a one-time hit to go review</font>

640
00:23:08,979 --> 00:23:12,909
all this so your fur<font color="#CCCCCC"> you build this you</font>

641
00:23:10,839 --> 00:23:14,440
build an alerting mechanism that says

642
00:23:12,909 --> 00:23:17,019
anything in the<font color="#E5E5E5"> last month less than a</font>

643
00:23:14,440 --> 00:23:19,690
thousand hits alert that first month you

644
00:23:17,019 --> 00:23:21,729
get a whole array of<font color="#E5E5E5"> like files to go</font>

645
00:23:19,690 --> 00:23:22,959
check out that's your that's your code

646
00:23:21,729 --> 00:23:24,429
reviews from the next couple<font color="#E5E5E5"> days it's</font>

647
00:23:22,959 --> 00:23:26,979
really nice because you can look at<font color="#CCCCCC"> Indy</font>

648
00:23:24,429 --> 00:23:29,440
like no dead code gone clearly debug

649
00:23:26,979 --> 00:23:31,570
file gone it's like<font color="#E5E5E5"> very quick code</font>

650
00:23:29,440 --> 00:23:33,579
reviews but then the incremental change

651
00:23:31,570 --> 00:23:34,899
off of that is almost<font color="#E5E5E5"> nothing right your</font>

652
00:23:33,579 --> 00:23:37,359
one-time heat is bad you spend a couple

653
00:23:34,899 --> 00:23:39,309
days for<font color="#CCCCCC"> your app sec team and then</font><font color="#E5E5E5"> next</font>

654
00:23:37,359 --> 00:23:42,189
month<font color="#E5E5E5"> you</font><font color="#CCCCCC"> have one file or two files</font>

655
00:23:39,309 --> 00:23:45,309
like it just drops off<font color="#E5E5E5"> a cliff</font><font color="#CCCCCC"> alright</font>

656
00:23:42,190 --> 00:23:47,889
let's make it rain for attackers<font color="#E5E5E5"> alright</font>

657
00:23:45,309 --> 00:23:51,969
cheapest way to find web app phones one

658
00:23:47,889 --> 00:23:54,309
word what Sandra hmm Google yeah that's

659
00:23:51,969 --> 00:23:56,950
right<font color="#CCCCCC"> ok there's</font><font color="#E5E5E5"> apparently a lot of one</font>

660
00:23:54,309 --> 00:23:57,969
words that are good answer right I was

661
00:23:56,950 --> 00:24:01,719
stalling because I needed<font color="#E5E5E5"> to take a</font>

662
00:23:57,969 --> 00:24:04,719
drink automation so yeah kind of Google

663
00:24:01,719 --> 00:24:07,839
if we want to think about this from<font color="#E5E5E5"> a</font>

664
00:24:04,719 --> 00:24:09,459
way of economic costs for attackers the

665
00:24:07,839 --> 00:24:12,009
more they can automate the cheaper that

666
00:24:09,459 --> 00:24:14,139
it is just like for the rest of us think

667
00:24:12,009 --> 00:24:16,779
about it from<font color="#E5E5E5"> the economic side so how</font>

668
00:24:14,139 --> 00:24:19,059
do you kill the spot in their tooling

669
00:24:16,779 --> 00:24:21,429
like in their tool chains so that

670
00:24:19,059 --> 00:24:23,229
automation goes away in as many places

671
00:24:21,429 --> 00:24:26,919
as you can kill it how do we<font color="#E5E5E5"> force</font>

672
00:24:23,229 --> 00:24:28,719
attackers to be manual now some<font color="#E5E5E5"> of the</font>

673
00:24:26,919 --> 00:24:30,339
dirty<font color="#E5E5E5"> secret of what I'm going to say</font>

674
00:24:28,719 --> 00:24:31,329
here<font color="#E5E5E5"> is that well your best attackers</font>

675
00:24:30,339 --> 00:24:33,399
are actually doing things manually

676
00:24:31,329 --> 00:24:35,019
anyway that's fine what you're trying to

677
00:24:33,399 --> 00:24:37,029
do is raise the cost of attacking your

678
00:24:35,019 --> 00:24:37,869
application because a lot of your

679
00:24:37,029 --> 00:24:38,509
attackers are going to be financially

680
00:24:37,869 --> 00:24:40,158
<font color="#CCCCCC">motive</font>

681
00:24:38,509 --> 00:24:42,289
and the more<font color="#E5E5E5"> costs if I have to go</font>

682
00:24:40,159 --> 00:24:44,179
develop<font color="#E5E5E5"> custom tooling to attack that</font>

683
00:24:42,289 --> 00:24:45,649
person and I can do everything off the

684
00:24:44,179 --> 00:24:47,239
shelf and attack<font color="#CCCCCC"> that person and I'm</font>

685
00:24:45,649 --> 00:24:51,619
financially motivated I'm going<font color="#E5E5E5"> after</font>

686
00:24:47,239 --> 00:24:53,119
<font color="#E5E5E5">that guy require manual effort so let's</font>

687
00:24:51,619 --> 00:24:54,889
talk about breaking off<font color="#CCCCCC"> the shelf</font>

688
00:24:53,119 --> 00:24:58,339
scanners for for a large-scale web

689
00:24:54,889 --> 00:24:59,689
application is<font color="#E5E5E5"> going to sound tribute at</font>

690
00:24:58,339 --> 00:25:02,418
first it gets there's a<font color="#E5E5E5"> little bit</font>

691
00:24:59,690 --> 00:25:05,299
clever bit near the end which is that so

692
00:25:02,419 --> 00:25:07,190
every off-the-shelf scanner all of them

693
00:25:05,299 --> 00:25:08,719
give off incredibly strong detection

694
00:25:07,190 --> 00:25:10,429
skills there isn't I don't think a

695
00:25:08,719 --> 00:25:12,649
single one on the planet whose job is to

696
00:25:10,429 --> 00:25:15,499
evade detection because they have to<font color="#E5E5E5"> get</font>

697
00:25:12,649 --> 00:25:17,899
<font color="#E5E5E5">that breath in that coverage and it you</font>

698
00:25:15,499 --> 00:25:19,190
know it's things as basic as user agents

699
00:25:17,899 --> 00:25:20,359
like we're all familiar with although

700
00:25:19,190 --> 00:25:22,129
what's hilarious is the number<font color="#CCCCCC"> of people</font>

701
00:25:20,359 --> 00:25:23,869
<font color="#E5E5E5">who don't change user agents on their</font>

702
00:25:22,129 --> 00:25:25,698
scanners and you're just<font color="#E5E5E5"> like oh hi</font>

703
00:25:23,869 --> 00:25:29,269
sequel map it's<font color="#E5E5E5"> been second since I've</font>

704
00:25:25,699 --> 00:25:31,190
seen you how's it<font color="#CCCCCC"> going to attack</font>

705
00:25:29,269 --> 00:25:33,229
patterns I forget<font color="#E5E5E5"> which tool this is I</font>

706
00:25:31,190 --> 00:25:35,059
meant to look this up someone in<font color="#E5E5E5"> this</font>

707
00:25:33,229 --> 00:25:37,519
room<font color="#E5E5E5"> probably knows there's one of the</font>

708
00:25:35,059 --> 00:25:39,079
security scanners it tries<font color="#E5E5E5"> its brute</font>

709
00:25:37,519 --> 00:25:41,889
force protection or<font color="#E5E5E5"> its brute force</font>

710
00:25:39,079 --> 00:25:44,779
detection by logging into Smith account

711
00:25:41,889 --> 00:25:46,189
just watch these things all day<font color="#E5E5E5"> every</font>

712
00:25:44,779 --> 00:25:49,069
day it's like somebody really loves the

713
00:25:46,190 --> 00:25:51,049
Smith account totally thought about

714
00:25:49,069 --> 00:25:53,178
steady finding that tool seeing what the

715
00:25:51,049 --> 00:25:54,679
first password it rises and just setting

716
00:25:53,179 --> 00:25:56,569
that password for a generic Smith

717
00:25:54,679 --> 00:26:03,919
account that means nothing just a troll

718
00:25:56,569 --> 00:26:05,599
it but yeah<font color="#E5E5E5"> cameras on right yeah and</font>

719
00:26:03,919 --> 00:26:07,459
<font color="#CCCCCC">then things which just flat out don't</font>

720
00:26:05,599 --> 00:26:09,979
exist right you're a<font color="#CCCCCC"> Java shop or you're</font>

721
00:26:07,459 --> 00:26:12,709
a PHP shop request the ASP those aren't

722
00:26:09,979 --> 00:26:14,179
legit period end<font color="#E5E5E5"> of story</font><font color="#CCCCCC"> request for</font>

723
00:26:12,709 --> 00:26:18,109
any<font color="#E5E5E5"> sort of technology stack which you</font>

724
00:26:14,179 --> 00:26:19,909
<font color="#E5E5E5">don't use they're not legit so these</font><font color="#CCCCCC"> are</font>

725
00:26:18,109 --> 00:26:21,649
some<font color="#E5E5E5"> of the incredibly strong signals</font>

726
00:26:19,909 --> 00:26:24,019
there are weaker signals and there are

727
00:26:21,649 --> 00:26:26,299
different signals too but thinking in

728
00:26:24,019 --> 00:26:28,789
terms of categories these are these<font color="#CCCCCC"> are</font>

729
00:26:26,299 --> 00:26:30,199
kind<font color="#E5E5E5"> of where it's at that's that's the</font>

730
00:26:28,789 --> 00:26:34,399
trivial bit right detecting scan<font color="#E5E5E5"> it</font>

731
00:26:30,199 --> 00:26:36,019
detecting a user agent not hard and your

732
00:26:34,399 --> 00:26:38,539
first intention there is like okay<font color="#E5E5E5"> well</font>

733
00:26:36,019 --> 00:26:40,449
cool I detected I block that breaks

734
00:26:38,539 --> 00:26:42,859
things that breaks things really quickly

735
00:26:40,449 --> 00:26:44,809
it's one<font color="#E5E5E5"> of those it seems easy on the</font>

736
00:26:42,859 --> 00:26:47,199
surface shared corporate firewalls

737
00:26:44,809 --> 00:26:49,579
mobile gateways eat like you're going<font color="#E5E5E5"> to</font>

738
00:26:47,200 --> 00:26:50,010
legitimately break way more stuff than

739
00:26:49,579 --> 00:26:52,110
you

740
00:26:50,010 --> 00:26:54,060
if you<font color="#CCCCCC"> just go do that so what we what</font>

741
00:26:52,110 --> 00:26:56,760
we stepped back and realized is we<font color="#E5E5E5"> don't</font>

742
00:26:54,060 --> 00:26:58,860
want to block IPS IPS are not a strong

743
00:26:56,760 --> 00:27:01,140
correlation to identity anymore they

744
00:26:58,860 --> 00:27:05,189
might<font color="#CCCCCC"> not have ever been what we want to</font>

745
00:27:01,140 --> 00:27:07,830
break our scanners and only<font color="#E5E5E5"> that how do</font>

746
00:27:05,190 --> 00:27:10,170
<font color="#E5E5E5">we</font><font color="#CCCCCC"> focus on that so what we did is we</font>

747
00:27:07,830 --> 00:27:12,149
went back and we said okay for every

748
00:27:10,170 --> 00:27:13,500
request entering the stack which sounds

749
00:27:12,150 --> 00:27:16,560
like a performance nightmare and

750
00:27:13,500 --> 00:27:18,180
actually shockingly is not classify<font color="#E5E5E5"> a</font>

751
00:27:16,560 --> 00:27:21,960
request when it comes in is at the

752
00:27:18,180 --> 00:27:23,400
scanner<font color="#CCCCCC"> not bouillon yes now if it is a</font>

753
00:27:21,960 --> 00:27:25,530
sign<font color="#CCCCCC"> of weight to that based on</font>

754
00:27:23,400 --> 00:27:27,600
confidence so some of these<font color="#E5E5E5"> things I</font>

755
00:27:25,530 --> 00:27:30,780
don't I don't map this back<font color="#E5E5E5"> incredibly</font>

756
00:27:27,600 --> 00:27:32,550
well but a request with sequel map as a

757
00:27:30,780 --> 00:27:35,100
user agent that's a scanner period end

758
00:27:32,550 --> 00:27:37,320
<font color="#E5E5E5">of story um</font><font color="#CCCCCC"> your ones that are like</font><font color="#E5E5E5"> reg</font>

759
00:27:35,100 --> 00:27:39,840
<font color="#CCCCCC">exes for</font><font color="#E5E5E5"> cross-site scripting patterns</font>

760
00:27:37,320 --> 00:27:42,480
and things like that<font color="#E5E5E5"> you assign less</font>

761
00:27:39,840 --> 00:27:46,110
confidence for it but what<font color="#E5E5E5"> you do is you</font>

762
00:27:42,480 --> 00:27:49,110
then request when the press comes in you

763
00:27:46,110 --> 00:27:51,719
say scanner yes or no if yes feed<font color="#CCCCCC"> that</font>

764
00:27:49,110 --> 00:27:52,949
into a rate limiter you never thought<font color="#E5E5E5"> a</font>

765
00:27:51,720 --> 00:27:54,720
talk on rate limiting could be

766
00:27:52,950 --> 00:27:56,880
interesting until you went and<font color="#E5E5E5"> read mr.</font>

767
00:27:54,720 --> 00:27:58,260
<font color="#E5E5E5">Nick jeez talk on rate limiting it's</font>

768
00:27:56,880 --> 00:28:00,090
<font color="#E5E5E5">actually awesome and it's something</font><font color="#CCCCCC"> that</font>

769
00:27:58,260 --> 00:28:02,610
you should be using so extensively in

770
00:28:00,090 --> 00:28:04,470
your application like everywhere it's

771
00:28:02,610 --> 00:28:06,270
one of them it's like graphene right it

772
00:28:04,470 --> 00:28:07,590
may<font color="#E5E5E5"> not be somebody somebody may not be</font>

773
00:28:06,270 --> 00:28:08,970
watching that graph but you want that

774
00:28:07,590 --> 00:28:10,649
graph<font color="#E5E5E5"> there for when you need it rate</font>

775
00:28:08,970 --> 00:28:12,360
limit needs the same way it costs once

776
00:28:10,650 --> 00:28:14,100
you develop like a good rate limiting

777
00:28:12,360 --> 00:28:15,990
library in your framework it costs

778
00:28:14,100 --> 00:28:17,850
almost nothing to deploy it everywhere

779
00:28:15,990 --> 00:28:21,930
in application it's awesome absolutely

780
00:28:17,850 --> 00:28:23,879
do it nick has<font color="#E5E5E5"> a good talk on it so feed</font>

781
00:28:21,930 --> 00:28:25,380
a request this this request is a bad

782
00:28:23,880 --> 00:28:27,360
<font color="#CCCCCC">frequent bad request right a scan a</font>

783
00:28:25,380 --> 00:28:29,220
request feed<font color="#E5E5E5"> it into a rate wonder if</font>

784
00:28:27,360 --> 00:28:30,929
the rate limiter is above a certain

785
00:28:29,220 --> 00:28:33,090
threshold so we've done we've seen a

786
00:28:30,930 --> 00:28:36,000
number of bad request number of scanner

787
00:28:33,090 --> 00:28:38,040
<font color="#CCCCCC">requests from this IP cool drop it it's</font>

788
00:28:36,000 --> 00:28:39,690
<font color="#E5E5E5">done right above the search request you</font>

789
00:28:38,040 --> 00:28:42,210
just lost that IP for your scanner and

790
00:28:39,690 --> 00:28:43,530
this is how you start to this<font color="#E5E5E5"> is this is</font>

791
00:28:42,210 --> 00:28:46,650
a bit that didn't go into in the slides

792
00:28:43,530 --> 00:28:48,480
but this is this is how you increase

793
00:28:46,650 --> 00:28:50,070
costs on it is you start to make them if

794
00:28:48,480 --> 00:28:52,380
you feel that you have a pretty good

795
00:28:50,070 --> 00:28:54,510
handle on mass registration and things

796
00:28:52,380 --> 00:28:57,840
like that you're in your systems you

797
00:28:54,510 --> 00:29:00,420
want a expensive<font color="#E5E5E5"> resource for attackers</font>

798
00:28:57,840 --> 00:29:02,620
is IPS not necessarily<font color="#CCCCCC"> at like one or</font>

799
00:29:00,420 --> 00:29:05,140
two<font color="#E5E5E5"> ip's but if you suddenly</font>

800
00:29:02,620 --> 00:29:06,729
<font color="#E5E5E5">can get I'm throwing arbitrary numbers</font>

801
00:29:05,140 --> 00:29:08,860
here but if you can suddenly do 20

802
00:29:06,730 --> 00:29:10,360
requests out of Nick<font color="#E5E5E5"> doe or some</font>

803
00:29:08,860 --> 00:29:12,520
off-the-shelf scanner and then you have

804
00:29:10,360 --> 00:29:14,350
to<font color="#E5E5E5"> cycle an IP and that tool is going to</font>

805
00:29:12,520 --> 00:29:16,240
generate like by default you know a

806
00:29:14,350 --> 00:29:17,620
million requests good luck you're done

807
00:29:16,240 --> 00:29:18,550
right you're not going to generate

808
00:29:17,620 --> 00:29:20,199
enough you're<font color="#E5E5E5"> not going to go through</font>

809
00:29:18,550 --> 00:29:22,270
enough<font color="#E5E5E5"> eye peas and develop the custom</font>

810
00:29:20,200 --> 00:29:23,950
tooling to<font color="#E5E5E5"> have to do that to just scan</font>

811
00:29:22,270 --> 00:29:25,570
a site like forget it i'm<font color="#CCCCCC"> not going to</font>

812
00:29:23,950 --> 00:29:30,370
scan it i'll go like just poke around

813
00:29:25,570 --> 00:29:31,990
and type script alert one not that so if

814
00:29:30,370 --> 00:29:33,909
it's about<font color="#E5E5E5"> that threshold drop oh my god</font>

815
00:29:31,990 --> 00:29:36,280
<font color="#CCCCCC">i</font><font color="#E5E5E5"> forgot to put in the most awesome part</font>

816
00:29:33,910 --> 00:29:38,530
so when we drop them we actually uh so

817
00:29:36,280 --> 00:29:40,540
from etsy<font color="#E5E5E5"> etsy</font><font color="#CCCCCC"> saul handmade and vintage</font>

818
00:29:38,530 --> 00:29:43,080
and everything like that right when you

819
00:29:40,540 --> 00:29:46,870
trigger the threshold we now return<font color="#E5E5E5"> HTTP</font>

820
00:29:43,080 --> 00:29:48,970
439 request not handmade for scanners

821
00:29:46,870 --> 00:29:50,020
it's<font color="#E5E5E5"> awesome that was there there were</font>

822
00:29:48,970 --> 00:29:52,840
high fives around the office when

823
00:29:50,020 --> 00:29:55,330
somebody thought of that one so it's

824
00:29:52,840 --> 00:29:58,330
<font color="#E5E5E5">cool you don't walk the entire IP you</font>

825
00:29:55,330 --> 00:30:00,330
block scanners ah via that now the

826
00:29:58,330 --> 00:30:02,320
design goal of<font color="#E5E5E5"> all of this was this</font>

827
00:30:00,330 --> 00:30:05,110
don't worry about the text on there it's

828
00:30:02,320 --> 00:30:07,720
<font color="#E5E5E5">not important the the design goal was</font>

829
00:30:05,110 --> 00:30:09,459
that if<font color="#E5E5E5"> you are scanning in your</font>

830
00:30:07,720 --> 00:30:11,470
terminal window and browsing etsy in a

831
00:30:09,460 --> 00:30:13,240
browser your browser should not be

832
00:30:11,470 --> 00:30:14,800
impacted in any way you should<font color="#E5E5E5"> still be</font>

833
00:30:13,240 --> 00:30:17,800
able to<font color="#E5E5E5"> use</font><font color="#CCCCCC"> the Site legitimately and</font>

834
00:30:14,800 --> 00:30:19,030
just illegitimate use drops off and the

835
00:30:17,800 --> 00:30:19,928
funny<font color="#CCCCCC"> thing is what we've seen from some</font>

836
00:30:19,030 --> 00:30:21,100
of these scanners is that they don't

837
00:30:19,929 --> 00:30:23,559
<font color="#CCCCCC">even really realize that they suddenly</font>

838
00:30:21,100 --> 00:30:25,000
just<font color="#E5E5E5"> hit a wall of you know HP whatever</font>

839
00:30:23,559 --> 00:30:26,678
response code so they<font color="#CCCCCC"> just keep scanning</font>

840
00:30:25,000 --> 00:30:30,280
what's fine because you've completely

841
00:30:26,679 --> 00:30:33,240
killed that data set lessons learned

842
00:30:30,280 --> 00:30:36,220
<font color="#E5E5E5">from it set your initial threshold tie</font>

843
00:30:33,240 --> 00:30:39,490
the cost of you don't care if or if a

844
00:30:36,220 --> 00:30:40,870
scanner gets 50 requests or 20<font color="#CCCCCC"> or 100 or</font>

845
00:30:39,490 --> 00:30:42,520
something like that what you're killing

846
00:30:40,870 --> 00:30:45,550
is the aggregate you're killing the two

847
00:30:42,520 --> 00:30:46,960
million requests your automated scanners

848
00:30:45,550 --> 00:30:48,580
are going to go nuts on this anyway like

849
00:30:46,960 --> 00:30:51,040
they're going to trigger enough to

850
00:30:48,580 --> 00:30:52,419
trigger your thresholds start high work

851
00:30:51,040 --> 00:30:54,520
your way down if you feel<font color="#E5E5E5"> comfortable on</font>

852
00:30:52,420 --> 00:30:56,500
that definitely wait based on confidence

853
00:30:54,520 --> 00:30:58,510
some things are high confidence some

854
00:30:56,500 --> 00:31:00,580
things are not just by the<font color="#E5E5E5"> nature of</font>

855
00:30:58,510 --> 00:31:03,460
them that's fine just build that into

856
00:31:00,580 --> 00:31:05,080
your system and be ready<font color="#CCCCCC"> i'm going to go</font>

857
00:31:03,460 --> 00:31:07,059
into<font color="#E5E5E5"> it an interesting failure we had</font>

858
00:31:05,080 --> 00:31:10,720
right now because<font color="#CCCCCC"> this be ready for the</font>

859
00:31:07,059 --> 00:31:13,030
weirdness that is the internet let me

860
00:31:10,720 --> 00:31:15,580
just give you an example so how else

861
00:31:13,030 --> 00:31:16,100
could we<font color="#E5E5E5"> increase</font><font color="#CCCCCC"> costs hey if someone's</font>

862
00:31:15,580 --> 00:31:17,600
doing something

863
00:31:16,100 --> 00:31:19,549
add why are they even<font color="#E5E5E5"> there in the first</font>

864
00:31:17,600 --> 00:31:21,740
place how can we just auto ban accounts

865
00:31:19,549 --> 00:31:23,690
that are that are doing scanning and so

866
00:31:21,740 --> 00:31:26,450
we did<font color="#E5E5E5"> that as a hypothesis we thought</font>

867
00:31:23,690 --> 00:31:27,770
<font color="#E5E5E5">okay some attackers are going to do an</font>

868
00:31:26,450 --> 00:31:29,090
authenticated scanning some are<font color="#E5E5E5"> going to</font>

869
00:31:27,770 --> 00:31:31,340
do authenticate it because in any

870
00:31:29,090 --> 00:31:32,928
application you can get way more way

871
00:31:31,340 --> 00:31:34,909
more exercise of the application by

872
00:31:32,929 --> 00:31:37,610
authenticated scans so we went<font color="#E5E5E5"> back and</font>

873
00:31:34,910 --> 00:31:40,039
we looked at<font color="#CCCCCC"> the numbers and</font><font color="#E5E5E5"> that the</font>

874
00:31:37,610 --> 00:31:41,600
thought was here that if we can<font color="#E5E5E5"> force</font>

875
00:31:40,039 --> 00:31:43,190
attackers to constantly create new

876
00:31:41,600 --> 00:31:45,289
accounts in addition<font color="#CCCCCC"> to having</font><font color="#E5E5E5"> to</font>

877
00:31:43,190 --> 00:31:46,970
Cyclopes that's a real cost and

878
00:31:45,289 --> 00:31:48,140
especially if on the<font color="#E5E5E5"> defensive side you</font>

879
00:31:46,970 --> 00:31:49,640
feel like you've gotten pretty<font color="#CCCCCC"> good</font>

880
00:31:48,140 --> 00:31:53,120
tooling around detecting mass

881
00:31:49,640 --> 00:31:54,530
registration and things like that so<font color="#E5E5E5"> hey</font>

882
00:31:53,120 --> 00:31:56,000
if we're going to<font color="#E5E5E5"> be able to work force</font>

883
00:31:54,530 --> 00:31:57,740
them to have to<font color="#E5E5E5"> create thousands of new</font>

884
00:31:56,000 --> 00:31:59,450
accounts and we feel that we're all

885
00:31:57,740 --> 00:32:01,039
right at detecting<font color="#E5E5E5"> that and we can close</font>

886
00:31:59,450 --> 00:32:03,890
them pretty quickly cool that's another

887
00:32:01,039 --> 00:32:06,020
source of cost so<font color="#E5E5E5"> actually was</font>

888
00:32:03,890 --> 00:32:07,370
house-sitting in<font color="#CCCCCC"> annex keynote this</font>

889
00:32:06,020 --> 00:32:09,770
morning<font color="#E5E5E5"> I pulled our last seven days of</font>

890
00:32:07,370 --> 00:32:11,600
data which you may extrapolate from that

891
00:32:09,770 --> 00:32:14,990
that<font color="#CCCCCC"> I was finishing these slides few</font>

892
00:32:11,600 --> 00:32:16,699
hours ago but don't focus on that from

893
00:32:14,990 --> 00:32:19,549
<font color="#E5E5E5">our last seven days of data as of this</font>

894
00:32:16,700 --> 00:32:20,750
morning 437 scanners how many of<font color="#E5E5E5"> them</font>

895
00:32:19,549 --> 00:32:24,230
<font color="#E5E5E5">were authenticated anybody want to take</font>

896
00:32:20,750 --> 00:32:30,679
a<font color="#CCCCCC"> guess good</font><font color="#E5E5E5"> okay were you seeing next</font>

897
00:32:24,230 --> 00:32:35,419
me where was I it's<font color="#CCCCCC"> ten awesome you yeah</font>

898
00:32:30,679 --> 00:32:40,580
exam ate a minute suspiciously<font color="#CCCCCC"> Anna why</font>

899
00:32:35,419 --> 00:32:41,780
did they all say it home<font color="#E5E5E5"> okay um I want</font>

900
00:32:40,580 --> 00:32:44,389
<font color="#E5E5E5">to guess what</font><font color="#CCCCCC"> are false positive rate on</font>

901
00:32:41,780 --> 00:32:49,309
this was<font color="#E5E5E5"> or are we</font><font color="#CCCCCC"> would not have wanted</font>

902
00:32:44,390 --> 00:32:51,590
<font color="#E5E5E5">to ban them right yeah hmm yeah how many</font>

903
00:32:49,309 --> 00:32:55,129
<font color="#CCCCCC">james wicket one through ten accounts</font>

904
00:32:51,590 --> 00:32:59,299
did we know it was fifty percent it's

905
00:32:55,130 --> 00:33:02,630
crazy<font color="#E5E5E5"> um these were legitimate users</font>

906
00:32:59,299 --> 00:33:04,190
this blew our minds like we expected

907
00:33:02,630 --> 00:33:05,809
this number right you expect it<font color="#E5E5E5"> to be</font>

908
00:33:04,190 --> 00:33:07,220
low even lower than you think of like

909
00:33:05,809 --> 00:33:09,230
people<font color="#CCCCCC"> are going to create an account</font>

910
00:33:07,220 --> 00:33:10,250
<font color="#E5E5E5">type into session cookies and fly</font>

911
00:33:09,230 --> 00:33:11,750
through their scanner and things like

912
00:33:10,250 --> 00:33:15,020
that cuz sessions<font color="#E5E5E5"> timeout it's a pain</font>

913
00:33:11,750 --> 00:33:16,429
like white hot guys know<font color="#CCCCCC"> that you have</font>

914
00:33:15,020 --> 00:33:19,490
to deal with<font color="#E5E5E5"> that commercially it sucked</font>

915
00:33:16,429 --> 00:33:23,630
it's a pain this we were not prepared to

916
00:33:19,490 --> 00:33:25,790
deal with this is<font color="#CCCCCC"> AA like browser</font>

917
00:33:23,630 --> 00:33:27,770
<font color="#CCCCCC">plug-ins</font><font color="#E5E5E5"> is honestly our best guess best</font>

918
00:33:25,790 --> 00:33:29,720
guess we're pretty sure on that but you

919
00:33:27,770 --> 00:33:29,929
can go back and<font color="#E5E5E5"> fifty percent of those</font>

920
00:33:29,720 --> 00:33:31,639
you

921
00:33:29,929 --> 00:33:33,080
<font color="#E5E5E5">sirs were clearly legitimate they were</font>

922
00:33:31,639 --> 00:33:35,299
users who had been there<font color="#CCCCCC"> for years who</font>

923
00:33:33,080 --> 00:33:37,789
have made purchases like they were as

924
00:33:35,299 --> 00:33:39,740
legitimate as users could be they

925
00:33:37,789 --> 00:33:41,509
weren't doing anything bad on the site

926
00:33:39,740 --> 00:33:45,019
in any other place it was clear that

927
00:33:41,509 --> 00:33:46,490
their browser was<font color="#E5E5E5"> owned and so if you're</font>

928
00:33:45,019 --> 00:33:49,309
going to auto<font color="#CCCCCC"> ban accounts it turns out</font>

929
00:33:46,490 --> 00:33:51,499
nope that face bomb right that would

930
00:33:49,309 --> 00:33:54,259
totally fail you would start banning

931
00:33:51,499 --> 00:33:55,850
legitimate users all over the place and

932
00:33:54,259 --> 00:33:57,200
the point of all of this and my closing

933
00:33:55,850 --> 00:34:00,168
thought this is as close<font color="#E5E5E5"> to a conclusion</font>

934
00:33:57,200 --> 00:34:02,240
as it gets is that attacks<font color="#E5E5E5"> don't always</font>

935
00:34:00,169 --> 00:34:04,490
happen like like you expect going<font color="#CCCCCC"> back</font>

936
00:34:02,240 --> 00:34:06,049
and looking at<font color="#E5E5E5"> the data and hopefully</font>

937
00:34:04,490 --> 00:34:07,340
looking<font color="#E5E5E5"> at the data before you make</font>

938
00:34:06,049 --> 00:34:09,440
those<font color="#E5E5E5"> decisions if we have just decided</font>

939
00:34:07,340 --> 00:34:11,389
to start auto<font color="#E5E5E5"> banding because it on the</font>

940
00:34:09,440 --> 00:34:12,918
surface<font color="#CCCCCC"> it seems legit we would</font><font color="#E5E5E5"> have</font>

941
00:34:11,389 --> 00:34:15,050
started just breaking users left and

942
00:34:12,918 --> 00:34:16,819
right and the more instrumentation that

943
00:34:15,050 --> 00:34:18,319
you have gives you the context<font color="#E5E5E5"> and the</font>

944
00:34:16,819 --> 00:34:27,290
<font color="#E5E5E5">confidence to actually make those</font>

945
00:34:18,319 --> 00:34:32,469
decisions and you're<font color="#CCCCCC"> awesome go for no</font>

946
00:34:27,290 --> 00:34:35,168
idea yeah it was nuts it's like they do

947
00:34:32,469 --> 00:34:37,158
they do<font color="#CCCCCC"> requests that would trigger</font><font color="#E5E5E5"> this</font>

948
00:34:35,168 --> 00:34:40,368
mean fall backwards I'll even show you

949
00:34:37,159 --> 00:34:41,750
some examples they do<font color="#E5E5E5"> request that that</font>

950
00:34:40,369 --> 00:34:45,190
definitely trigger this that look that

951
00:34:41,750 --> 00:34:47,030
are clearly not initiated by<font color="#E5E5E5"> the user</font>

952
00:34:45,190 --> 00:34:48,950
almost certainly coming<font color="#E5E5E5"> from their</font>

953
00:34:47,030 --> 00:34:50,419
browser we can't<font color="#E5E5E5"> actually tell that</font>

954
00:34:48,949 --> 00:34:51,888
because it may just be coming from

955
00:34:50,418 --> 00:34:53,239
network like living on the<font color="#E5E5E5"> host hitting</font>

956
00:34:51,889 --> 00:34:57,549
us directly that doesn't<font color="#E5E5E5"> really make any</font>

957
00:34:53,239 --> 00:34:57,549
sense like<font color="#E5E5E5"> it should</font><font color="#CCCCCC"> be in</font><font color="#E5E5E5"> the browser</font>

958
00:34:59,410 --> 00:35:03,470
they weren't but I don't have numbers

959
00:35:02,030 --> 00:35:08,900
<font color="#CCCCCC">for you this is actually something we</font>

960
00:35:03,470 --> 00:35:11,149
were packing on the last<font color="#E5E5E5"> few days so the</font>

961
00:35:08,900 --> 00:35:14,660
pattern we saw a<font color="#CCCCCC"> lot of different</font>

962
00:35:11,150 --> 00:35:16,670
patterns so I<font color="#E5E5E5"> don't think that it was</font>

963
00:35:14,660 --> 00:35:19,339
<font color="#E5E5E5">all the same thing because you see some</font>

964
00:35:16,670 --> 00:35:23,480
that are like clearly<font color="#E5E5E5"> one thing one this</font>

965
00:35:19,339 --> 00:35:26,328
one thing like requests xml r /<font color="#CCCCCC"> xmlrpc</font>

966
00:35:23,480 --> 00:35:28,940
all the time clearly widget users

967
00:35:26,329 --> 00:35:33,589
clearly legit browsers does thousands of

968
00:35:28,940 --> 00:35:37,760
requests to slash<font color="#CCCCCC"> xmlrpc yeah no idea</font>

969
00:35:33,589 --> 00:35:38,640
<font color="#E5E5E5">what</font><font color="#CCCCCC"> that is yeah</font><font color="#E5E5E5"> Magna dem two</font>

970
00:35:37,760 --> 00:35:42,630
questions

971
00:35:38,640 --> 00:35:44,220
for the last part it wouldn't is it so

972
00:35:42,630 --> 00:35:45,359
enough positive to do that maybe you a

973
00:35:44,220 --> 00:35:47,279
<font color="#E5E5E5">temporary bandage maybe we're hours</font>

974
00:35:45,359 --> 00:35:49,019
using like that and I'll work the user

975
00:35:47,279 --> 00:35:51,240
that you will they might be compromised

976
00:35:49,019 --> 00:35:54,180
wouldn't this will be a kind<font color="#E5E5E5"> of ends on</font>

977
00:35:51,240 --> 00:35:57,319
your site yeah ah you're a discussion

978
00:35:54,180 --> 00:36:00,240
forum maybe are you an e-commerce site

979
00:35:57,319 --> 00:36:01,740
and my second one<font color="#E5E5E5"> is where are you doing</font>

980
00:36:00,240 --> 00:36:05,098
the instrumentation on the<font color="#E5E5E5"> rate limiting</font>

981
00:36:01,740 --> 00:36:09,299
the detection of scanners and the<font color="#CCCCCC"> the</font>

982
00:36:05,099 --> 00:36:13,289
check<font color="#E5E5E5"> looking at the input for for bed</font>

983
00:36:09,299 --> 00:36:14,670
bed<font color="#CCCCCC"> scanner bad news yeah yeah um the</font>

984
00:36:13,289 --> 00:36:15,839
question was like where are we where are

985
00:36:14,670 --> 00:36:16,920
we doing this we're doing it in our

986
00:36:15,839 --> 00:36:18,869
framework it's one of the<font color="#E5E5E5"> first things</font>

987
00:36:16,920 --> 00:36:21,240
that when a request comes into our staff

988
00:36:18,869 --> 00:36:22,289
that a run-through so it's<font color="#E5E5E5"> right a pop</font>

989
00:36:21,240 --> 00:36:24,479
it's really<font color="#E5E5E5"> before you even hit a</font>

990
00:36:22,289 --> 00:36:26,700
general application cover though we did

991
00:36:24,480 --> 00:36:28,559
you check the<font color="#E5E5E5"> inputs and comparative</font>

992
00:36:26,700 --> 00:36:30,750
what comes out<font color="#CCCCCC"> okay where do</font><font color="#E5E5E5"> you do</font><font color="#CCCCCC"> that</font>

993
00:36:28,559 --> 00:36:33,630
ah the check at the end goes out in your

994
00:36:30,750 --> 00:36:34,950
templating so it's watching there and

995
00:36:33,630 --> 00:36:39,900
the check and be getting<font color="#CCCCCC"> is in the</font>

996
00:36:34,950 --> 00:36:42,419
framework more<font color="#CCCCCC"> presents yet as</font><font color="#E5E5E5"> kenny's</font>

997
00:36:39,900 --> 00:36:44,519
thing on content security yeah also this

998
00:36:42,420 --> 00:36:46,559
when you<font color="#CCCCCC"> talk quite a bit about XSS</font>

999
00:36:44,519 --> 00:36:49,229
probably too much now what what are<font color="#E5E5E5"> you</font>

1000
00:36:46,559 --> 00:36:50,549
<font color="#E5E5E5">guys seeing as exploitation I mean</font>

1001
00:36:49,230 --> 00:36:54,150
you're<font color="#E5E5E5"> talking about detection but</font>

1002
00:36:50,549 --> 00:36:55,650
clearly somebody's trying to get exploit

1003
00:36:54,150 --> 00:36:58,230
<font color="#CCCCCC">running on you guys so what do you see</font>

1004
00:36:55,650 --> 00:36:59,910
yeah so we have one<font color="#E5E5E5"> of the nice way to</font>

1005
00:36:58,230 --> 00:37:02,099
generate all this data is run a bug

1006
00:36:59,910 --> 00:37:05,700
memory program uh-huh and the internet

1007
00:37:02,099 --> 00:37:08,339
shows up it's great<font color="#E5E5E5"> if you really hate</font>

1008
00:37:05,700 --> 00:37:09,569
sleeping i recommend it highly so that

1009
00:37:08,339 --> 00:37:11,640
definitely generates a lot of<font color="#E5E5E5"> things</font>

1010
00:37:09,569 --> 00:37:15,750
<font color="#E5E5E5">that we see the bug bounty program we've</font>

1011
00:37:11,640 --> 00:37:18,839
seen knock on<font color="#CCCCCC"> wood we've seen almost</font>

1012
00:37:15,750 --> 00:37:21,509
entirely white hat behavior but<font color="#E5E5E5"> you</font>

1013
00:37:18,839 --> 00:37:23,069
don't know that and the ones that like

1014
00:37:21,509 --> 00:37:24,599
the ones that<font color="#E5E5E5"> are some of the most</font>

1015
00:37:23,069 --> 00:37:27,779
vexing things that i'd love<font color="#E5E5E5"> to figure</font>

1016
00:37:24,599 --> 00:37:30,029
out<font color="#CCCCCC"> but never will</font><font color="#E5E5E5"> our we've watched</font>

1017
00:37:27,779 --> 00:37:31,589
people find bones on the site<font color="#E5E5E5"> and then</font>

1018
00:37:30,029 --> 00:37:33,450
never<font color="#E5E5E5"> right like we know</font><font color="#CCCCCC"> that they found</font>

1019
00:37:31,589 --> 00:37:37,319
him and then they<font color="#E5E5E5"> never right into down</font>

1020
00:37:33,450 --> 00:37:41,279
<font color="#E5E5E5">he or anything like that um that I don't</font>

1021
00:37:37,319 --> 00:37:46,230
know like we fix them quick and like we

1022
00:37:41,279 --> 00:37:48,660
burned their they're vulnerable to that

1023
00:37:46,230 --> 00:37:49,839
even later on it's like you definitely

1024
00:37:48,660 --> 00:37:53,078
found

1025
00:37:49,839 --> 00:37:55,808
xss there you didn't write in what's

1026
00:37:53,079 --> 00:37:56,890
going<font color="#E5E5E5"> on there um that's that's an</font>

1027
00:37:55,809 --> 00:37:58,390
interesting one so I know they're not

1028
00:37:56,890 --> 00:38:00,808
what if these folks that are<font color="#CCCCCC"> working on</font>

1029
00:37:58,390 --> 00:38:03,160
like bots that they can<font color="#CCCCCC"> run through</font>

1030
00:38:00,809 --> 00:38:06,069
exercise balls and I'm just<font color="#E5E5E5"> wondering if</font>

1031
00:38:03,160 --> 00:38:07,749
you're seeing that behavior ah like

1032
00:38:06,069 --> 00:38:10,538
automated detection<font color="#CCCCCC"> or like thoughts</font>

1033
00:38:07,749 --> 00:38:13,419
dead Russ I running<font color="#E5E5E5"> BOTS to do anything</font>

1034
00:38:10,539 --> 00:38:15,489
<font color="#E5E5E5">so they're just using your cross site</font>

1035
00:38:13,420 --> 00:38:20,140
scripting problem as a way to either

1036
00:38:15,489 --> 00:38:21,819
feed a bot<font color="#CCCCCC"> rana</font><font color="#E5E5E5"> bah oh ok yeah ok yeah</font>

1037
00:38:20,140 --> 00:38:25,660
<font color="#E5E5E5">distribute malware sure sure sure sure</font>

1038
00:38:21,819 --> 00:38:29,079
um yeah that's good thought could

1039
00:38:25,660 --> 00:38:30,759
<font color="#E5E5E5">Bennett it's weird because you'll</font><font color="#CCCCCC"> never</font>

1040
00:38:29,079 --> 00:38:32,829
know on that one<font color="#CCCCCC"> right like someone</font>

1041
00:38:30,759 --> 00:38:35,559
found a bone they never<font color="#CCCCCC"> told you about</font>

1042
00:38:32,829 --> 00:38:38,140
it<font color="#CCCCCC"> yoga more that we had there that were</font>

1043
00:38:35,559 --> 00:38:40,839
nice with in the beginning<font color="#E5E5E5"> that's one</font>

1044
00:38:38,140 --> 00:38:43,779
dude Damon he's awesome found this this

1045
00:38:40,839 --> 00:38:45,640
accessible I'm like a<font color="#E5E5E5"> Friday he wrote it</font>

1046
00:38:43,779 --> 00:38:47,910
up on credit netsec like a year year and

1047
00:38:45,640 --> 00:38:50,319
<font color="#E5E5E5">a half ago it was really cool because</font>

1048
00:38:47,910 --> 00:38:53,229
Nick day after day and<font color="#E5E5E5"> I were hanging</font>

1049
00:38:50,319 --> 00:38:54,910
out and<font color="#CCCCCC"> watch this guy fine to find an</font>

1050
00:38:53,229 --> 00:38:56,439
XSS and it was cool<font color="#E5E5E5"> you and then he like</font>

1051
00:38:54,910 --> 00:38:58,690
<font color="#E5E5E5">they spend</font><font color="#CCCCCC"> time building up like a</font>

1052
00:38:56,440 --> 00:38:59,890
really<font color="#E5E5E5"> good payload to show like a</font>

1053
00:38:58,690 --> 00:39:01,809
really<font color="#E5E5E5"> good proof of concept this was</font>

1054
00:38:59,890 --> 00:39:03,549
before we had the bounty program um

1055
00:39:01,809 --> 00:39:06,309
build up a<font color="#E5E5E5"> really cool proof-of-concept</font>

1056
00:39:03,549 --> 00:39:07,809
<font color="#E5E5E5">show like oh here's me</font><font color="#CCCCCC"> you click this</font>

1057
00:39:06,309 --> 00:39:09,640
link it'll flip your privacy settings so

1058
00:39:07,809 --> 00:39:11,380
everything becomes public and extract

1059
00:39:09,640 --> 00:39:12,460
like an email address and like is good

1060
00:39:11,380 --> 00:39:15,400
he spent a lot of time on and everything

1061
00:39:12,460 --> 00:39:16,719
like that we watched and fine and<font color="#CCCCCC"> we</font>

1062
00:39:15,400 --> 00:39:19,089
push to fix before you<font color="#CCCCCC"> had a chance to</font>

1063
00:39:16,719 --> 00:39:21,279
report it to us which was fun in like a

1064
00:39:19,089 --> 00:39:23,650
really exciting point in my early upset

1065
00:39:21,279 --> 00:39:27,279
career and then he wrote in on like the

1066
00:39:23,650 --> 00:39:28,690
<font color="#E5E5E5">Monday any more days like this my proof</font>

1067
00:39:27,279 --> 00:39:31,239
<font color="#E5E5E5">of concept stopped working over the</font>

1068
00:39:28,690 --> 00:39:34,150
weekend<font color="#CCCCCC"> that seems a little bit</font>

1069
00:39:31,239 --> 00:39:36,130
suspicious timing I want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> let</font><font color="#CCCCCC"> you guys</font>

1070
00:39:34,150 --> 00:39:37,779
know I was not black adding here like

1071
00:39:36,130 --> 00:39:40,450
just so we're gonna cool about this

1072
00:39:37,779 --> 00:39:42,849
that's my home IP like everything's

1073
00:39:40,450 --> 00:39:44,140
legit and here's the details of the bug

1074
00:39:42,849 --> 00:39:46,660
report that had ready<font color="#E5E5E5"> to go for you guys</font>

1075
00:39:44,140 --> 00:39:48,729
on Monday<font color="#CCCCCC"> morning it was cool we have</font>

1076
00:39:46,660 --> 00:39:49,399
like a really good dynamic with them and

1077
00:39:48,729 --> 00:39:51,589
actually

1078
00:39:49,400 --> 00:39:53,150
things<font color="#E5E5E5"> I'm most proud of in our security</font>

1079
00:39:51,590 --> 00:39:54,290
<font color="#E5E5E5">program was that when we launched our</font>

1080
00:39:53,150 --> 00:39:56,990
bounty program we went back and

1081
00:39:54,290 --> 00:39:58,430
retroactively<font color="#E5E5E5"> Li Dao need him in a few</font>

1082
00:39:56,990 --> 00:40:02,060
<font color="#E5E5E5">of the other guys you into it found cool</font>

1083
00:39:58,430 --> 00:40:08,000
stuff before we have<font color="#E5E5E5"> the program cool</font>

1084
00:40:02,060 --> 00:40:10,420
more oh just drop or do you

1085
00:40:08,000 --> 00:40:16,310
throwing the random<font color="#CCCCCC"> sleep one in there</font>

1086
00:40:10,420 --> 00:40:19,430
that's<font color="#E5E5E5"> okay I could experimental</font><font color="#CCCCCC"> eat oh</font>

1087
00:40:16,310 --> 00:40:22,160
yeah this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> not an offer to anyone</font>

1088
00:40:19,430 --> 00:40:23,480
we're going to find<font color="#E5E5E5"> that yeah that's the</font>

1089
00:40:22,160 --> 00:40:26,089
part I may be intentionally or

1090
00:40:23,480 --> 00:40:27,680
unintentionally not included is cool

1091
00:40:26,090 --> 00:40:29,810
this is this is all about<font color="#E5E5E5"> increasing</font>

1092
00:40:27,680 --> 00:40:31,129
costs right the<font color="#E5E5E5"> next one of the mex</font>

1093
00:40:29,810 --> 00:40:33,200
illogical steps you can come to

1094
00:40:31,130 --> 00:40:35,450
increasing<font color="#E5E5E5"> costs is injecting false</font>

1095
00:40:33,200 --> 00:40:56,330
results in two<font color="#E5E5E5"> data sets and with that I</font>

1096
00:40:35,450 --> 00:40:59,629
will shut the hell up oh when we're

1097
00:40:56,330 --> 00:41:01,700
testing for XSS yeah um so the<font color="#E5E5E5"> way that</font>

1098
00:40:59,630 --> 00:41:03,200
<font color="#E5E5E5">we approach this neither previous talk</font>

1099
00:41:01,700 --> 00:41:04,669
on that it talks about how you go about

1100
00:41:03,200 --> 00:41:05,779
trying<font color="#E5E5E5"> to do that at the framework level</font>

1101
00:41:04,670 --> 00:41:07,850
and a lot of<font color="#E5E5E5"> people doing really</font>

1102
00:41:05,780 --> 00:41:11,000
interesting work there like far as I'm

1103
00:41:07,850 --> 00:41:13,250
from us um but an hour in our platform

1104
00:41:11,000 --> 00:41:15,680
bit mostly XSS is mostly killed by

1105
00:41:13,250 --> 00:41:17,120
default in the<font color="#E5E5E5"> framework level and then</font>

1106
00:41:15,680 --> 00:41:20,149
you can grep for exceptions to that

1107
00:41:17,120 --> 00:41:22,250
which is<font color="#E5E5E5"> what's fantastic right so if</font>

1108
00:41:20,150 --> 00:41:24,530
everything's escaped by default you grep

1109
00:41:22,250 --> 00:41:26,060
for what's on escape or what what has

1110
00:41:24,530 --> 00:41:27,110
made that output beyond escape and

1111
00:41:26,060 --> 00:41:32,390
that's<font color="#E5E5E5"> how you that's how we look for</font>

1112
00:41:27,110 --> 00:41:38,150
excess yes Abby is prepping the coq back

1113
00:41:32,390 --> 00:41:39,319
so you're using<font color="#E5E5E5"> the</font><font color="#CCCCCC"> oh it for that one</font>

1114
00:41:38,150 --> 00:41:41,150
that we're<font color="#CCCCCC"> doing for</font><font color="#E5E5E5"> the reflected</font>

1115
00:41:39,320 --> 00:41:43,100
<font color="#CCCCCC">exodus yeah we're using</font><font color="#E5E5E5"> users we're</font>

1116
00:41:41,150 --> 00:41:44,630
using the<font color="#E5E5E5"> user traffic because you look</font>

1117
00:41:43,100 --> 00:41:46,130
at the hospital input come in and you

1118
00:41:44,630 --> 00:41:47,540
look<font color="#E5E5E5"> and see if it went out on escape</font>

1119
00:41:46,130 --> 00:41:48,490
and<font color="#CCCCCC"> then you know that</font><font color="#E5E5E5"> something</font>

1120
00:41:47,540 --> 00:41:50,410
happened there we miss

1121
00:41:48,490 --> 00:41:54,569
the code it came out<font color="#E5E5E5"> an escape and</font>

1122
00:41:50,410 --> 00:41:56,830
actually fired its HP now<font color="#CCCCCC"> okay cool</font>

1123
00:41:54,570 --> 00:41:58,600
keeping up more yeah I think<font color="#E5E5E5"> I got a</font>

1124
00:41:56,830 --> 00:42:01,210
couple minutes<font color="#E5E5E5"> on</font><font color="#CCCCCC"> Kiawah to make energy</font>

1125
00:41:58,600 --> 00:42:03,910
<font color="#CCCCCC">decline one you have that doesn't or</font>

1126
00:42:01,210 --> 00:42:05,470
maybe that's afterwards like that I mean

1127
00:42:03,910 --> 00:42:07,029
<font color="#CCCCCC">that</font><font color="#E5E5E5"> alert is completely automated like</font>

1128
00:42:05,470 --> 00:42:11,080
all of<font color="#E5E5E5"> that all that happens on every</font>

1129
00:42:07,030 --> 00:42:13,510
request and then if it<font color="#E5E5E5"> then logs result</font>

1130
00:42:11,080 --> 00:42:15,549
if it like oh just<font color="#E5E5E5"> fat like reflected</font>

1131
00:42:13,510 --> 00:42:20,950
exercise and that triggers<font color="#CCCCCC"> an alert and</font>

1132
00:42:15,550 --> 00:42:22,930
that bubbles up<font color="#E5E5E5"> okay yeah you guys run</font>

1133
00:42:20,950 --> 00:42:25,868
<font color="#E5E5E5">your own automated scanners for all</font>

1134
00:42:22,930 --> 00:42:28,600
these types of attacks and so are you

1135
00:42:25,869 --> 00:42:35,320
white listing them or you say we need in

1136
00:42:28,600 --> 00:42:36,910
the tanner we have all of someplace yeah

1137
00:42:35,320 --> 00:42:39,250
yeah the<font color="#E5E5E5"> Internet is a really good</font>

1138
00:42:36,910 --> 00:42:40,540
automated scanner turns out it's

1139
00:42:39,250 --> 00:42:45,369
sometimes you just don't get the

1140
00:42:40,540 --> 00:42:47,650
vulnerability reports we don't<font color="#E5E5E5"> we've</font>

1141
00:42:45,369 --> 00:42:49,480
experimented with them in the past we've

1142
00:42:47,650 --> 00:42:50,830
done in the past honestly that to set up

1143
00:42:49,480 --> 00:42:54,010
the infrastructure forward to be<font color="#CCCCCC"> able to</font>

1144
00:42:50,830 --> 00:42:55,720
really have it be fully automated and

1145
00:42:54,010 --> 00:42:58,840
not<font color="#E5E5E5"> something that somebody has to tend</font>

1146
00:42:55,720 --> 00:43:00,580
to manually at all they do we didn't

1147
00:42:58,840 --> 00:43:02,140
spend the<font color="#E5E5E5"> time on it it was a we felt</font>

1148
00:43:00,580 --> 00:43:04,690
like<font color="#E5E5E5"> it was a bit of a time sink and we</font>

1149
00:43:02,140 --> 00:43:06,129
focused on some other efforts there not

1150
00:43:04,690 --> 00:43:07,990
to say that<font color="#CCCCCC"> we won't go back to do it</font>

1151
00:43:06,130 --> 00:43:09,940
and explicitly not say that<font color="#E5E5E5"> it doesn't</font>

1152
00:43:07,990 --> 00:43:13,180
have value in other environments because

1153
00:43:09,940 --> 00:43:14,710
I've seen<font color="#CCCCCC"> a value in ours it wasn't the</font>

1154
00:43:13,180 --> 00:43:16,779
<font color="#CCCCCC">right place it wasn't very time and we</font>

1155
00:43:14,710 --> 00:43:22,450
feel that we're<font color="#CCCCCC"> getting good coverage</font>

1156
00:43:16,780 --> 00:43:24,369
and value in other spots or yeah have

1157
00:43:22,450 --> 00:43:26,410
you guys thought<font color="#E5E5E5"> of your tried using a</font>

1158
00:43:24,369 --> 00:43:28,660
web to kind of find some<font color="#E5E5E5"> of the same</font>

1159
00:43:26,410 --> 00:43:29,680
stuff that you're finding sure the

1160
00:43:28,660 --> 00:43:31,960
question<font color="#E5E5E5"> was to have you thought of</font>

1161
00:43:29,680 --> 00:43:33,730
using a web we've taken the concepts of

1162
00:43:31,960 --> 00:43:36,550
a whack that we<font color="#E5E5E5"> like and built them into</font>

1163
00:43:33,730 --> 00:43:38,410
our application that's part um and where

1164
00:43:36,550 --> 00:43:39,670
I where I actually see I used<font color="#CCCCCC"> to I mean</font>

1165
00:43:38,410 --> 00:43:41,170
<font color="#E5E5E5">I used</font><font color="#CCCCCC"> to be an often so when you like</font>

1166
00:43:39,670 --> 00:43:44,200
that<font color="#E5E5E5"> probably would have set me off</font>

1167
00:43:41,170 --> 00:43:47,109
before right<font color="#CCCCCC"> oh why anyone all offense</font>

1168
00:43:44,200 --> 00:43:49,660
just has a generally a different opinion

1169
00:43:47,109 --> 00:43:51,400
about laughs the one thing that I<font color="#CCCCCC"> think</font>

1170
00:43:49,660 --> 00:43:52,600
that<font color="#CCCCCC"> they can conceptually do well is in</font>

1171
00:43:51,400 --> 00:43:55,000
environments where you can't patch

1172
00:43:52,600 --> 00:43:57,580
quickly and it's a very kind<font color="#E5E5E5"> of clean</font>

1173
00:43:55,000 --> 00:43:58,140
bug in that light this is a zip code

1174
00:43:57,580 --> 00:44:00,359
field

1175
00:43:58,140 --> 00:44:02,098
has sequel injection well it's<font color="#E5E5E5"> pretty</font>

1176
00:44:00,359 --> 00:44:03,900
easy to then apply the regex it says you

1177
00:44:02,099 --> 00:44:06,240
get five digits or you get nine digits

1178
00:44:03,900 --> 00:44:08,910
and that's it you only get digits I

1179
00:44:06,240 --> 00:44:11,038
think laughs have value they're like hey

1180
00:44:08,910 --> 00:44:12,450
<font color="#CCCCCC">I can't patch like this app has a</font><font color="#E5E5E5"> six</font>

1181
00:44:11,039 --> 00:44:14,190
<font color="#E5E5E5">month release cycle so even though the</font>

1182
00:44:12,450 --> 00:44:17,038
patch is clean it's going to go out<font color="#E5E5E5"> in</font>

1183
00:44:14,190 --> 00:44:21,210
December and that's where<font color="#CCCCCC"> a fkin can do</font>

1184
00:44:17,039 --> 00:44:22,740
well um the the<font color="#E5E5E5"> other sides of it we</font>

1185
00:44:21,210 --> 00:44:24,660
solve<font color="#E5E5E5"> that capability by being able to</font>

1186
00:44:22,740 --> 00:44:26,368
deploy quick so be if you<font color="#E5E5E5"> don't know</font>

1187
00:44:24,660 --> 00:44:29,549
like the SHPO we deploy to production

1188
00:44:26,369 --> 00:44:31,410
<font color="#E5E5E5">about 30 times a day and so we can</font>

1189
00:44:29,549 --> 00:44:34,559
respond pretty quickly on on those where

1190
00:44:31,410 --> 00:44:35,700
we want<font color="#E5E5E5"> to and then for detection and</font>

1191
00:44:34,559 --> 00:44:37,170
instrumentation things like that we've

1192
00:44:35,700 --> 00:44:43,680
really kind of we focused on building

1193
00:44:37,170 --> 00:44:48,029
that in yeah this field was accepting

1194
00:44:43,680 --> 00:44:50,819
cross<font color="#E5E5E5"> they have you found any</font>

1195
00:44:48,029 --> 00:44:52,650
large-scale designer architecture stuff

1196
00:44:50,819 --> 00:44:57,210
and so maybe we need<font color="#CCCCCC"> to put this behind</font>

1197
00:44:52,650 --> 00:45:00,450
login screen it's as if<font color="#E5E5E5"> led to any sort</font>

1198
00:44:57,210 --> 00:45:02,130
<font color="#E5E5E5">of learner assessment yeah certainly</font>

1199
00:45:00,450 --> 00:45:04,649
<font color="#E5E5E5">areas that trigger bones that you don't</font>

1200
00:45:02,130 --> 00:45:06,960
<font color="#E5E5E5">expect your stack to have trigger much</font>

1201
00:45:04,650 --> 00:45:09,420
larger security assessments on that's

1202
00:45:06,960 --> 00:45:11,670
one of the that's one of the big

1203
00:45:09,420 --> 00:45:14,220
takeaways of a bug bounty program is

1204
00:45:11,670 --> 00:45:16,619
that<font color="#E5E5E5"> before</font><font color="#CCCCCC"> you launch or not to view</font>

1205
00:45:14,220 --> 00:45:17,910
this<font color="#E5E5E5"> too too hard but before you want to</font>

1206
00:45:16,619 --> 00:45:19,289
bug bounty program come up with a list

1207
00:45:17,910 --> 00:45:21,180
come up with a list of vulnerability

1208
00:45:19,289 --> 00:45:22,380
classes that you expect to have and kind

1209
00:45:21,180 --> 00:45:24,629
of<font color="#E5E5E5"> a weighting of that I expect a</font>

1210
00:45:22,380 --> 00:45:27,359
million<font color="#E5E5E5"> dawn XSS I expect</font><font color="#CCCCCC"> to sequel</font>

1211
00:45:24,630 --> 00:45:29,549
injection and then match reality to that

1212
00:45:27,359 --> 00:45:31,319
a month out holy crap I'd 50 sequel

1213
00:45:29,549 --> 00:45:32,849
injection I have<font color="#E5E5E5"> that systemically I</font>

1214
00:45:31,319 --> 00:45:34,500
need to go do something more<font color="#E5E5E5"> about that</font>

1215
00:45:32,849 --> 00:45:37,380
we've absolutely had it both on a

1216
00:45:34,500 --> 00:45:40,230
vulnerability class level and on an area

1217
00:45:37,380 --> 00:45:41,789
<font color="#CCCCCC">of the code base level of like i</font><font color="#E5E5E5"> would</font>

1218
00:45:40,230 --> 00:45:44,339
give you like a<font color="#E5E5E5"> brutal example that is</font>

1219
00:45:41,789 --> 00:45:46,619
like a voman report will come in it will

1220
00:45:44,339 --> 00:45:48,599
look very real and you look at it<font color="#E5E5E5"> and go</font>

1221
00:45:46,619 --> 00:45:50,400
not that like oh that bug is worthless

1222
00:45:48,599 --> 00:45:52,740
or something like that but what is that

1223
00:45:50,400 --> 00:45:53,849
<font color="#E5E5E5">endpoint like what is</font><font color="#CCCCCC"> that function</font>

1224
00:45:52,740 --> 00:45:55,740
everyone looks around the table is like

1225
00:45:53,849 --> 00:45:57,900
I've never<font color="#E5E5E5"> even heard of that and that</font>

1226
00:45:55,740 --> 00:45:58,850
goes in trigger is very<font color="#E5E5E5"> very quick</font>

1227
00:45:57,900 --> 00:46:01,400
internal pen test

1228
00:45:58,850 --> 00:46:03,470
things like<font color="#CCCCCC"> that like what</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> that area</font>

1229
00:46:01,400 --> 00:46:05,690
<font color="#CCCCCC">of the code base is that in like a</font>

1230
00:46:03,470 --> 00:46:09,259
completely different repo but publicly

1231
00:46:05,690 --> 00:46:10,910
accessible definitely it like you<font color="#E5E5E5"> should</font>

1232
00:46:09,260 --> 00:46:12,950
absolutely be using your vulnerability

1233
00:46:10,910 --> 00:46:15,440
information not just at like tactically

1234
00:46:12,950 --> 00:46:16,850
a spot fixes but driving both what do I

1235
00:46:15,440 --> 00:46:18,440
have systemically and what do I don't

1236
00:46:16,850 --> 00:46:20,990
what do I not so that I can address that

1237
00:46:18,440 --> 00:46:22,160
a framework level and where what are the

1238
00:46:20,990 --> 00:46:23,720
dangerous areas in<font color="#E5E5E5"> my code base in</font>

1239
00:46:22,160 --> 00:46:24,920
general like in aggregate like that area

1240
00:46:23,720 --> 00:46:26,990
over there's dangerous has a lot of

1241
00:46:24,920 --> 00:46:28,280
<font color="#E5E5E5">wounds this area's new clean code that</font>

1242
00:46:26,990 --> 00:46:32,600
doesn't what should I be doing over

1243
00:46:28,280 --> 00:46:34,310
<font color="#E5E5E5">there all right I'm probably totally out</font>

1244
00:46:32,600 --> 00:46:38,920
of time<font color="#CCCCCC"> I'll stand i'll stand outside</font>

1245
00:46:34,310 --> 00:46:38,920
the<font color="#E5E5E5"> room guys have questions thank you</font>

