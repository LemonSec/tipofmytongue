1
00:00:17,840 --> 00:00:19,359
all right it looks like it's about two

2
00:00:19,359 --> 00:00:22,560
o'clock uh there's a break at 2 45 so if

3
00:00:22,560 --> 00:00:24,320
i don't get going you don't get a break

4
00:00:24,320 --> 00:00:26,880
right so i better get going

5
00:00:26,880 --> 00:00:29,679
my name is jason kent i'm a hacker in

6
00:00:29,679 --> 00:00:31,439
residence at a company called sequence

7
00:00:31,439 --> 00:00:33,680
security we do automated attack

8
00:00:33,680 --> 00:00:35,280
mitigation

9
00:00:35,280 --> 00:00:38,399
and we do api security strategies that

10
00:00:38,399 --> 00:00:41,440
include things like you publish a spec

11
00:00:41,440 --> 00:00:43,680
we check spec informants

12
00:00:43,680 --> 00:00:46,000
with traffic that's live

13
00:00:46,000 --> 00:00:48,320
so i spend a lot of my time looking at

14
00:00:48,320 --> 00:00:50,640
customers and watching my customers get

15
00:00:50,640 --> 00:00:52,239
attacked

16
00:00:52,239 --> 00:00:53,760
and we spend a lot of time trying to

17
00:00:53,760 --> 00:00:55,600
figure out well how is it that they

18
00:00:55,600 --> 00:00:56,800
figured out

19
00:00:56,800 --> 00:00:58,960
to attack that end point

20
00:00:58,960 --> 00:01:00,640
sometimes it's easy it's just the

21
00:01:00,640 --> 00:01:02,719
trailing slash on an endpoint that they

22
00:01:02,719 --> 00:01:04,640
didn't realize was on

23
00:01:04,640 --> 00:01:06,159
sometimes it's a little bit harder in

24
00:01:06,159 --> 00:01:09,200
that it's a p12 file or it's

25
00:01:09,200 --> 00:01:11,280
you know some other thing that was left

26
00:01:11,280 --> 00:01:13,760
as a default install whatever that might

27
00:01:13,760 --> 00:01:15,920
be

28
00:01:16,240 --> 00:01:18,720
so like i said my name is jason i've

29
00:01:18,720 --> 00:01:21,040
been doing this about 20 years i threw

30
00:01:21,040 --> 00:01:23,759
my first angry tick mark at a website in

31
00:01:23,759 --> 00:01:27,119
about 98 99 somewhere in there

32
00:01:27,119 --> 00:01:29,360
um i've spoken actually at last con

33
00:01:29,360 --> 00:01:31,040
quite a few times and typically when i

34
00:01:31,040 --> 00:01:33,040
come here i'm here to talk about a

35
00:01:33,040 --> 00:01:34,640
responsible disclosure that i just

36
00:01:34,640 --> 00:01:36,159
finished

37
00:01:36,159 --> 00:01:38,560
this time it's going to be more of a

38
00:01:38,560 --> 00:01:40,720
i submitted a responsible disclosure and

39
00:01:40,720 --> 00:01:42,320
they told me it isn't

40
00:01:42,320 --> 00:01:44,240
and now i get the court of public

41
00:01:44,240 --> 00:01:46,079
opinion to tell me if you guys think

42
00:01:46,079 --> 00:01:47,840
it's uh worthy of a responsible

43
00:01:47,840 --> 00:01:49,759
disclosure and i'll show it to you

44
00:01:49,759 --> 00:01:51,840
uh here in a bit

45
00:01:51,840 --> 00:01:54,560
like i said i do a lot with bots

46
00:01:54,560 --> 00:01:56,240
i do a lot of like

47
00:01:56,240 --> 00:02:00,240
hype sale type bot work so sneakers ps5s

48
00:02:00,240 --> 00:02:01,840
that kind of thing

49
00:02:01,840 --> 00:02:04,240
keeping all of those guys at bay and

50
00:02:04,240 --> 00:02:07,119
trying my best to to make sure that we

51
00:02:07,119 --> 00:02:08,878
understand that they can't be buying

52
00:02:08,878 --> 00:02:10,479
everything we we should be able to buy

53
00:02:10,479 --> 00:02:13,039
everything right

54
00:02:13,760 --> 00:02:14,959
all right so

55
00:02:14,959 --> 00:02:17,840
the whole concept behind this talk was

56
00:02:17,840 --> 00:02:19,920
i was i was chatting with one of the

57
00:02:19,920 --> 00:02:21,120
people that works in our marketing

58
00:02:21,120 --> 00:02:22,959
department and they were like all of

59
00:02:22,959 --> 00:02:25,840
these things that we see come from

60
00:02:25,840 --> 00:02:28,239
too much information inside of the api

61
00:02:28,239 --> 00:02:30,000
responses and i was like you know what

62
00:02:30,000 --> 00:02:31,920
that's not a bad talk track so we're

63
00:02:31,920 --> 00:02:34,480
going to call this tmi api

64
00:02:34,480 --> 00:02:37,760
and what it is is this apis that are

65
00:02:37,760 --> 00:02:39,280
easy to get to

66
00:02:39,280 --> 00:02:42,319
uh that are talking way too loud so

67
00:02:42,319 --> 00:02:43,840
you'll be able to see

68
00:02:43,840 --> 00:02:45,280
interesting error messages you're going

69
00:02:45,280 --> 00:02:48,560
to be able to see things like routes

70
00:02:48,560 --> 00:02:50,879
endpoints stuff that we thought was hard

71
00:02:50,879 --> 00:02:52,800
to do with api is actually pretty easy

72
00:02:52,800 --> 00:02:55,840
to do with apis because of mistakes

73
00:02:55,840 --> 00:02:57,599
and so we're going to go through that

74
00:02:57,599 --> 00:02:59,440
i'm going to talk about how people find

75
00:02:59,440 --> 00:03:00,720
apis

76
00:03:00,720 --> 00:03:02,800
i'm going to talk about the api top 10

77
00:03:02,800 --> 00:03:05,920
mistakes that i actually see live

78
00:03:05,920 --> 00:03:08,239
problems right this a lot of this comes

79
00:03:08,239 --> 00:03:09,200
from

80
00:03:09,200 --> 00:03:10,720
my customers this isn't really a

81
00:03:10,720 --> 00:03:13,040
schadenfreude talk though i do throw a

82
00:03:13,040 --> 00:03:14,800
bit of that in there

83
00:03:14,800 --> 00:03:16,640
and i've done that in the past this is

84
00:03:16,640 --> 00:03:18,800
more of a here's what real live attacks

85
00:03:18,800 --> 00:03:20,400
look like and if you're worried about

86
00:03:20,400 --> 00:03:22,080
attacks you may be worried about these

87
00:03:22,080 --> 00:03:23,599
things

88
00:03:23,599 --> 00:03:25,920
who are the attackers um and then i'm

89
00:03:25,920 --> 00:03:28,319
going to go through a bunch of examples

90
00:03:28,319 --> 00:03:30,720
of things

91
00:03:30,840 --> 00:03:35,599
so how do people find public apis well

92
00:03:35,599 --> 00:03:38,080
dns searches are pretty easy right i can

93
00:03:38,080 --> 00:03:40,400
just look for api dot and then whatever

94
00:03:40,400 --> 00:03:42,879
top level domain and i'll probably find

95
00:03:42,879 --> 00:03:45,360
something i can probably also find dev

96
00:03:45,360 --> 00:03:47,440
dash api or

97
00:03:47,440 --> 00:03:49,519
something of that ilk

98
00:03:49,519 --> 00:03:51,920
so dns searches are going to go

99
00:03:51,920 --> 00:03:53,599
pretty well we're going to find a lot of

100
00:03:53,599 --> 00:03:56,159
public apis through that

101
00:03:56,159 --> 00:03:57,840
what we're starting to see now is more

102
00:03:57,840 --> 00:04:00,560
instrumented tools that can go out and

103
00:04:00,560 --> 00:04:02,720
find things and

104
00:04:02,720 --> 00:04:04,159
if you guys have been paying attention

105
00:04:04,159 --> 00:04:06,319
to the space at all kite runner came out

106
00:04:06,319 --> 00:04:08,000
in april

107
00:04:08,000 --> 00:04:10,080
kite runner is this neat new tool that

108
00:04:10,080 --> 00:04:14,000
does content discovery um it goes and

109
00:04:14,000 --> 00:04:16,399
finds apis and it actually says here are

110
00:04:16,399 --> 00:04:18,639
all your api endpoints here's the ones i

111
00:04:18,639 --> 00:04:22,800
got a 200 off of etc and so forth

112
00:04:22,800 --> 00:04:25,199
but really the power behind kite runner

113
00:04:25,199 --> 00:04:28,479
is this massive word list that they have

114
00:04:28,479 --> 00:04:31,360
all of the slash swagger endpoints all

115
00:04:31,360 --> 00:04:33,759
of the um you know different kinds of

116
00:04:33,759 --> 00:04:36,560
api endpoints that you probably

117
00:04:36,560 --> 00:04:39,120
don't want people touching um are loaded

118
00:04:39,120 --> 00:04:40,880
as part of kite runner kite runner's

119
00:04:40,880 --> 00:04:44,320
word list asset note is who put this out

120
00:04:44,320 --> 00:04:46,240
and their word lists are available so if

121
00:04:46,240 --> 00:04:48,160
you guys want to you know run kite

122
00:04:48,160 --> 00:04:50,400
runner yourselves or build your own

123
00:04:50,400 --> 00:04:52,240
um you know you can just use their word

124
00:04:52,240 --> 00:04:54,720
list as part of it

125
00:04:54,720 --> 00:04:58,000
the other searching for public apis that

126
00:04:58,000 --> 00:04:58,960
happens

127
00:04:58,960 --> 00:05:00,880
is people that are doing things like bug

128
00:05:00,880 --> 00:05:03,199
bounty searches where they're looking

129
00:05:03,199 --> 00:05:06,000
for very specific things that they know

130
00:05:06,000 --> 00:05:08,320
almost every company leaves on

131
00:05:08,320 --> 00:05:09,960
right so your

132
00:05:09,960 --> 00:05:13,160
wp-admin file on a wordpress site or

133
00:05:13,160 --> 00:05:15,759
xmlrpc.php on a wordpress site these are

134
00:05:15,759 --> 00:05:19,680
really common attack locations we see

135
00:05:19,680 --> 00:05:22,320
uh attack automation constantly banging

136
00:05:22,320 --> 00:05:24,240
on these things

137
00:05:24,240 --> 00:05:26,479
and what's interesting about it

138
00:05:26,479 --> 00:05:28,479
especially in a bug bounty i mean i

139
00:05:28,479 --> 00:05:30,880
actually had somebody in pakistan send

140
00:05:30,880 --> 00:05:33,080
me a hey you left your

141
00:05:33,080 --> 00:05:35,520
xmlrpc.php file open it's got

142
00:05:35,520 --> 00:05:37,840
pingback.ping on it

143
00:05:37,840 --> 00:05:39,759
on a site that had nothing to do with

144
00:05:39,759 --> 00:05:41,680
anything and i didn't care

145
00:05:41,680 --> 00:05:43,280
and i replied back to him and said okay

146
00:05:43,280 --> 00:05:44,720
i'll take it off and he's like where's

147
00:05:44,720 --> 00:05:47,039
my money

148
00:05:47,039 --> 00:05:48,800
right

149
00:05:48,800 --> 00:05:50,400
we weren't registered in a bug down

150
00:05:50,400 --> 00:05:52,800
anywhere real important that we be

151
00:05:52,800 --> 00:05:54,240
registered in a bug bounty if you're

152
00:05:54,240 --> 00:05:56,000
gonna go try chasing somebody up for

153
00:05:56,000 --> 00:05:57,199
money

154
00:05:57,199 --> 00:05:59,680
but there it is

155
00:05:59,680 --> 00:06:01,360
some other ways that we find all this

156
00:06:01,360 --> 00:06:03,919
stuff right just messing around with web

157
00:06:03,919 --> 00:06:05,280
applications

158
00:06:05,280 --> 00:06:08,319
look at your email anymore right buy

159
00:06:08,319 --> 00:06:10,240
something from anyone you're going to

160
00:06:10,240 --> 00:06:12,400
get an email that's a purchase

161
00:06:12,400 --> 00:06:14,240
experience email that says thanks for

162
00:06:14,240 --> 00:06:15,840
your order and here's your tracking

163
00:06:15,840 --> 00:06:17,840
number and all that and if you look

164
00:06:17,840 --> 00:06:20,240
you're calling some api on on someone's

165
00:06:20,240 --> 00:06:22,479
back end that's part of that experience

166
00:06:22,479 --> 00:06:23,919
company

167
00:06:23,919 --> 00:06:25,680
so just looking at

168
00:06:25,680 --> 00:06:28,240
the stuff that you do every day is going

169
00:06:28,240 --> 00:06:30,479
to lead you down this path

170
00:06:30,479 --> 00:06:32,160
mobile applications there's a couple of

171
00:06:32,160 --> 00:06:34,319
different ways we can get api endpoints

172
00:06:34,319 --> 00:06:35,600
out of them

173
00:06:35,600 --> 00:06:38,160
you can instrument burp right you can

174
00:06:38,160 --> 00:06:39,919
and i'll show you guys how to turn on

175
00:06:39,919 --> 00:06:42,080
burp and what you need to set it up

176
00:06:42,080 --> 00:06:43,280
uh to

177
00:06:43,280 --> 00:06:44,960
intercept your phone

178
00:06:44,960 --> 00:06:46,479
in case you want to look at your mobile

179
00:06:46,479 --> 00:06:48,639
applications

180
00:06:48,639 --> 00:06:51,599
as well as you can take the apk files

181
00:06:51,599 --> 00:06:52,720
from the

182
00:06:52,720 --> 00:06:54,560
android install

183
00:06:54,560 --> 00:06:56,479
and you can take them apart right

184
00:06:56,479 --> 00:06:58,240
there's a bunch of apk tools that are

185
00:06:58,240 --> 00:06:59,759
out there that'll give you lists of

186
00:06:59,759 --> 00:07:02,080
endpoints so finding the public

187
00:07:02,080 --> 00:07:04,560
endpoints is not that hard

188
00:07:04,560 --> 00:07:07,039
there's a site called api's guru

189
00:07:07,039 --> 00:07:09,360
apis.guru

190
00:07:09,360 --> 00:07:10,720
that has

191
00:07:10,720 --> 00:07:12,720
api listings if you want to try to go

192
00:07:12,720 --> 00:07:14,639
see if your company's up there and

193
00:07:14,639 --> 00:07:16,560
github is another one and if you haven't

194
00:07:16,560 --> 00:07:20,000
used bigquery to query into github i

195
00:07:20,000 --> 00:07:21,919
recommend that you go look for kite

196
00:07:21,919 --> 00:07:24,160
runners

197
00:07:24,160 --> 00:07:26,080
their landing page and asset note

198
00:07:26,080 --> 00:07:27,840
they'll take you through how to use

199
00:07:27,840 --> 00:07:30,639
bigquery to query github and it's a

200
00:07:30,639 --> 00:07:32,400
really interesting thing

201
00:07:32,400 --> 00:07:34,319
if you want to go look for

202
00:07:34,319 --> 00:07:37,919
api keys or passwords buried in github

203
00:07:37,919 --> 00:07:40,000
bigquery will get them out pretty fast

204
00:07:40,000 --> 00:07:41,840
same with you know swagger files and

205
00:07:41,840 --> 00:07:43,520
that kind of stuff that's why

206
00:07:43,520 --> 00:07:46,560
kite runners out there

207
00:07:46,720 --> 00:07:47,759
so we're going to

208
00:07:47,759 --> 00:07:50,400
talk a little bit about the owasp api

209
00:07:50,400 --> 00:07:52,560
top 10 and some of the mistakes that i

210
00:07:52,560 --> 00:07:54,400
commonly see

211
00:07:54,400 --> 00:07:57,120
in my customers i spend

212
00:07:57,120 --> 00:07:59,599
a lot of my time taking an adversarial

213
00:07:59,599 --> 00:08:00,879
look at how

214
00:08:00,879 --> 00:08:02,160
their

215
00:08:02,160 --> 00:08:04,240
transactions are flowing

216
00:08:04,240 --> 00:08:06,560
i've got a lot of retailers that i'll go

217
00:08:06,560 --> 00:08:08,960
look and say okay

218
00:08:08,960 --> 00:08:11,199
when i sign up for your registration

219
00:08:11,199 --> 00:08:13,759
page it tells me whether or not my

220
00:08:13,759 --> 00:08:16,080
account already exists

221
00:08:16,080 --> 00:08:18,000
if my account already exists and i know

222
00:08:18,000 --> 00:08:20,000
my account already exists then i can

223
00:08:20,000 --> 00:08:22,319
just sit there and enumerate accounts

224
00:08:22,319 --> 00:08:25,520
right that's leads to account takeover

225
00:08:25,520 --> 00:08:27,440
and so that's just a simple error

226
00:08:27,440 --> 00:08:29,759
message that is something that needs to

227
00:08:29,759 --> 00:08:32,399
be you know fixed so those are the kinds

228
00:08:32,399 --> 00:08:35,120
of mistakes that we'll talk about

229
00:08:35,120 --> 00:08:36,799
we'll look at the attacks that come

230
00:08:36,799 --> 00:08:38,958
after you've made those mistakes

231
00:08:38,958 --> 00:08:41,360
um and then we'll try to figure out what

232
00:08:41,360 --> 00:08:43,440
are these attackers doing

233
00:08:43,440 --> 00:08:46,560
and why do apis enable this attack

234
00:08:46,560 --> 00:08:49,040
automation

235
00:08:49,200 --> 00:08:51,519
so the biggest mistakes the two biggest

236
00:08:51,519 --> 00:08:53,200
mistakes that we see

237
00:08:53,200 --> 00:08:55,040
our authentication and authorization

238
00:08:55,040 --> 00:08:57,920
makes sense the top two in the top ten

239
00:08:57,920 --> 00:09:00,800
um but in reality what it looks like on

240
00:09:00,800 --> 00:09:02,320
the back side

241
00:09:02,320 --> 00:09:04,240
uh is things like

242
00:09:04,240 --> 00:09:06,480
authentication headers not actually

243
00:09:06,480 --> 00:09:10,080
functioning correctly um and so in my

244
00:09:10,080 --> 00:09:12,160
disclosure that i made to this company

245
00:09:12,160 --> 00:09:13,839
called lithium

246
00:09:13,839 --> 00:09:16,160
i said listen i can just take the

247
00:09:16,160 --> 00:09:18,240
authentication header out

248
00:09:18,240 --> 00:09:20,800
and be authenticated and they said not

249
00:09:20,800 --> 00:09:24,240
that's normal right and i went

250
00:09:24,240 --> 00:09:27,760
it's not quite normal especially since

251
00:09:27,760 --> 00:09:30,080
your multi-tenant platform and i can use

252
00:09:30,080 --> 00:09:32,720
my authentication from one tenant

253
00:09:32,720 --> 00:09:35,600
to go to the next tenant right

254
00:09:35,600 --> 00:09:36,800
and they were like

255
00:09:36,800 --> 00:09:39,200
public data totally normal

256
00:09:39,200 --> 00:09:40,880
and i said all right well

257
00:09:40,880 --> 00:09:43,200
after 90 days i you know kept bugging

258
00:09:43,200 --> 00:09:44,959
them and finally i just wrote a blog

259
00:09:44,959 --> 00:09:46,560
post about it said i'm just going to go

260
00:09:46,560 --> 00:09:48,160
tell everybody about this

261
00:09:48,160 --> 00:09:51,279
um but authentication and authorization

262
00:09:51,279 --> 00:09:53,600
are difficult concepts

263
00:09:53,600 --> 00:09:55,279
because most people

264
00:09:55,279 --> 00:09:57,200
don't try to roll their own which you

265
00:09:57,200 --> 00:09:58,160
shouldn't

266
00:09:58,160 --> 00:10:00,080
um they try to grab something that's

267
00:10:00,080 --> 00:10:03,279
going to work for them and oftentimes

268
00:10:03,279 --> 00:10:06,000
they set something up wrong to use that

269
00:10:06,000 --> 00:10:07,279
piece

270
00:10:07,279 --> 00:10:09,360
so if you're authenticating off of some

271
00:10:09,360 --> 00:10:11,360
other api using saml using something

272
00:10:11,360 --> 00:10:12,640
else

273
00:10:12,640 --> 00:10:14,240
and you don't have that set up correctly

274
00:10:14,240 --> 00:10:15,920
if you're not checking for the headers

275
00:10:15,920 --> 00:10:18,480
on the on the other side then

276
00:10:18,480 --> 00:10:20,240
authentication is really not actually

277
00:10:20,240 --> 00:10:22,399
needed

278
00:10:22,399 --> 00:10:25,040
error messages are going to change the

279
00:10:25,040 --> 00:10:26,800
way we look at things

280
00:10:26,800 --> 00:10:28,480
i was talking to some guys last night

281
00:10:28,480 --> 00:10:31,200
and i was saying that the state of api

282
00:10:31,200 --> 00:10:33,200
security is right about where web

283
00:10:33,200 --> 00:10:36,240
security was in 2009

284
00:10:36,240 --> 00:10:39,279
um we are aware it's there and we got a

285
00:10:39,279 --> 00:10:41,200
whole bunch of crap coming right

286
00:10:41,200 --> 00:10:43,120
remember 2013

287
00:10:43,120 --> 00:10:45,440
we started to see a lot more breaches

288
00:10:45,440 --> 00:10:47,760
and absec related stuff we're starting

289
00:10:47,760 --> 00:10:50,240
to see more and more api related stuff

290
00:10:50,240 --> 00:10:51,839
now

291
00:10:51,839 --> 00:10:53,839
you guys familiar with brewdog anybody

292
00:10:53,839 --> 00:10:55,360
know who brewdog is

293
00:10:55,360 --> 00:10:57,600
yeah they got beer

294
00:10:57,600 --> 00:10:59,279
and an open api that has bad

295
00:10:59,279 --> 00:11:00,880
authorization on it and if you want to

296
00:11:00,880 --> 00:11:02,959
go just generate unlimited coupons and

297
00:11:02,959 --> 00:11:05,600
have all the beer you want you can

298
00:11:05,600 --> 00:11:06,399
right

299
00:11:06,399 --> 00:11:09,120
this is where our api security is

300
00:11:09,120 --> 00:11:10,800
error messages are going to tell us a

301
00:11:10,800 --> 00:11:14,160
lot and when i used to teach

302
00:11:14,160 --> 00:11:16,000
developer training classes security

303
00:11:16,000 --> 00:11:18,800
classes to developers i would tell them

304
00:11:18,800 --> 00:11:21,200
go find one error message you like

305
00:11:21,200 --> 00:11:23,839
and make that your only error message

306
00:11:23,839 --> 00:11:26,720
it confuses attackers it confuses the

307
00:11:26,720 --> 00:11:28,640
people that are there and you don't want

308
00:11:28,640 --> 00:11:30,560
to provide them any help

309
00:11:30,560 --> 00:11:32,240
and i'll show you a few examples of this

310
00:11:32,240 --> 00:11:33,680
as we get going

311
00:11:33,680 --> 00:11:35,279
um

312
00:11:35,279 --> 00:11:38,079
default or vulnerable components left on

313
00:11:38,079 --> 00:11:38,959
right

314
00:11:38,959 --> 00:11:40,480
how many of you guys

315
00:11:40,480 --> 00:11:42,800
have a wordpress site or have used one

316
00:11:42,800 --> 00:11:44,560
in the past

317
00:11:44,560 --> 00:11:46,959
right so you can go to wp-admin and

318
00:11:46,959 --> 00:11:48,720
there's the admin page did you know you

319
00:11:48,720 --> 00:11:51,200
can change that location i mean that's

320
00:11:51,200 --> 00:11:53,920
security by obscurity but it definitely

321
00:11:53,920 --> 00:11:55,600
if i don't know where the admin page is

322
00:11:55,600 --> 00:11:58,560
i cannot log in right

323
00:11:58,560 --> 00:12:00,639
and that makes that a lot easier

324
00:12:00,639 --> 00:12:02,800
there's lots of default components that

325
00:12:02,800 --> 00:12:06,079
get left on in apis as well

326
00:12:06,079 --> 00:12:08,480
and it's stuff that we have to

327
00:12:08,480 --> 00:12:12,320
kind of take a consideration for

328
00:12:12,639 --> 00:12:13,440
so

329
00:12:13,440 --> 00:12:15,760
by far and away the biggest attack that

330
00:12:15,760 --> 00:12:17,600
i see at my customers is account

331
00:12:17,600 --> 00:12:18,800
takeover

332
00:12:18,800 --> 00:12:21,360
uh it's usually happens through some

333
00:12:21,360 --> 00:12:24,480
kind of credential stuffing attack but

334
00:12:24,480 --> 00:12:26,880
sometimes it's completely validated

335
00:12:26,880 --> 00:12:28,480
results

336
00:12:28,480 --> 00:12:31,040
how does somebody get a valid list of

337
00:12:31,040 --> 00:12:33,920
credentials for your site

338
00:12:33,920 --> 00:12:36,399
any ideas

339
00:12:36,399 --> 00:12:38,639
you can buy them yeah

340
00:12:38,639 --> 00:12:39,600
um

341
00:12:39,600 --> 00:12:42,079
you can buy them from a bunch of places

342
00:12:42,079 --> 00:12:45,360
that process of generating those lists

343
00:12:45,360 --> 00:12:47,519
is called cracking

344
00:12:47,519 --> 00:12:50,079
so if you google the term cracking

345
00:12:50,079 --> 00:12:51,760
you're gonna find a bunch of sites where

346
00:12:51,760 --> 00:12:53,360
there are credential lists that you can

347
00:12:53,360 --> 00:12:54,880
buy

348
00:12:54,880 --> 00:12:56,880
but what you probably don't know is

349
00:12:56,880 --> 00:12:58,560
there's tools that are already built to

350
00:12:58,560 --> 00:13:01,120
go attack your site those lists are

351
00:13:01,120 --> 00:13:02,880
sitting in a config file that you just

352
00:13:02,880 --> 00:13:05,440
load onto the tool and run

353
00:13:05,440 --> 00:13:07,839
and a lot of my retail customers have

354
00:13:07,839 --> 00:13:10,079
these problems because they have rewards

355
00:13:10,079 --> 00:13:11,360
programs

356
00:13:11,360 --> 00:13:14,079
or they store purchase informations to

357
00:13:14,079 --> 00:13:16,959
make purchase faster right so your

358
00:13:16,959 --> 00:13:19,440
favorite pizza place if you can log into

359
00:13:19,440 --> 00:13:21,680
it and hit buy now

360
00:13:21,680 --> 00:13:23,519
your credit card is stored there and

361
00:13:23,519 --> 00:13:26,000
it's going to perform that transaction

362
00:13:26,000 --> 00:13:26,800
so

363
00:13:26,800 --> 00:13:29,440
you end up with a situation where

364
00:13:29,440 --> 00:13:31,040
account takeover

365
00:13:31,040 --> 00:13:35,760
actually turns into fraud right or theft

366
00:13:35,760 --> 00:13:38,720
so we see this a lot rewards programs

367
00:13:38,720 --> 00:13:40,959
were getting hit right before covid

368
00:13:40,959 --> 00:13:42,800
really heavily

369
00:13:42,800 --> 00:13:45,120
and then as kovit came along

370
00:13:45,120 --> 00:13:46,720
we lost that

371
00:13:46,720 --> 00:13:49,279
we don't see as much reward program

372
00:13:49,279 --> 00:13:50,560
problems

373
00:13:50,560 --> 00:13:52,480
because most of the retailers we worked

374
00:13:52,480 --> 00:13:54,720
with required rewards to be spent

375
00:13:54,720 --> 00:13:56,880
in-house and all the brick and mortars

376
00:13:56,880 --> 00:13:58,480
closed so

377
00:13:58,480 --> 00:13:59,440
that

378
00:13:59,440 --> 00:14:02,000
that started to wane but what we are

379
00:14:02,000 --> 00:14:03,760
seeing a lot of is

380
00:14:03,760 --> 00:14:06,000
purchasing right somebody getting logged

381
00:14:06,000 --> 00:14:06,959
in

382
00:14:06,959 --> 00:14:09,760
and buying things

383
00:14:09,760 --> 00:14:12,639
we also see a lot of inventory control

384
00:14:12,639 --> 00:14:15,279
or what we call seat spinning

385
00:14:15,279 --> 00:14:17,839
in in our customers and what all this is

386
00:14:17,839 --> 00:14:19,519
is somebody going in and saying add that

387
00:14:19,519 --> 00:14:22,160
to my cart depending on how the back end

388
00:14:22,160 --> 00:14:24,880
of that application works it may lock

389
00:14:24,880 --> 00:14:27,600
that record and it may lock that item

390
00:14:27,600 --> 00:14:31,120
or it may not it really depends um

391
00:14:31,120 --> 00:14:33,680
seat spinning the idea behind seat

392
00:14:33,680 --> 00:14:35,680
spinning originates from

393
00:14:35,680 --> 00:14:38,079
credit card fraud does anybody here ever

394
00:14:38,079 --> 00:14:39,839
had their credit card stolen and they

395
00:14:39,839 --> 00:14:41,360
end up with airline tickets being

396
00:14:41,360 --> 00:14:42,800
purchased

397
00:14:42,800 --> 00:14:44,399
so this is how it works

398
00:14:44,399 --> 00:14:48,000
i advertise on facebook that there's

399
00:14:48,000 --> 00:14:49,279
a 400

400
00:14:49,279 --> 00:14:51,680
flight to somewhere in europe and first

401
00:14:51,680 --> 00:14:52,959
class

402
00:14:52,959 --> 00:14:55,360
sounds great does anybody here think

403
00:14:55,360 --> 00:14:56,880
they're getting that ticket if they buy

404
00:14:56,880 --> 00:14:57,760
it

405
00:14:57,760 --> 00:14:58,959
good

406
00:14:58,959 --> 00:14:59,920
so

407
00:14:59,920 --> 00:15:01,519
what's actually happening is there's

408
00:15:01,519 --> 00:15:04,560
somebody sitting on the airline website

409
00:15:04,560 --> 00:15:06,240
holding a seat

410
00:15:06,240 --> 00:15:09,360
they put that advertisement on facebook

411
00:15:09,360 --> 00:15:11,680
somebody goes and buys it

412
00:15:11,680 --> 00:15:13,040
sort of

413
00:15:13,040 --> 00:15:14,399
they just scrape the credit card

414
00:15:14,399 --> 00:15:16,720
information and then go buy the seat

415
00:15:16,720 --> 00:15:18,399
that's how you ended up buying a bunch

416
00:15:18,399 --> 00:15:20,480
of airline tickets

417
00:15:20,480 --> 00:15:22,320
but what the attacker then is going to

418
00:15:22,320 --> 00:15:24,880
do is try to transfer that ticket out of

419
00:15:24,880 --> 00:15:27,440
their name or

420
00:15:27,440 --> 00:15:29,040
they've purchased it for somebody that

421
00:15:29,040 --> 00:15:30,399
they already know

422
00:15:30,399 --> 00:15:32,079
everything for

423
00:15:32,079 --> 00:15:34,320
but seat spinning is just that concept

424
00:15:34,320 --> 00:15:37,680
of i've got it locked i've got this item

425
00:15:37,680 --> 00:15:38,800
of the

426
00:15:38,800 --> 00:15:40,320
inventory locked up and then i'm going

427
00:15:40,320 --> 00:15:43,600
to do something with it later

428
00:15:45,839 --> 00:15:47,759
the biggest financial benefits that come

429
00:15:47,759 --> 00:15:50,160
out of these attacks are usually things

430
00:15:50,160 --> 00:15:53,360
like gift cards or credit cards

431
00:15:53,360 --> 00:15:54,959
sometimes it's rewards points like i

432
00:15:54,959 --> 00:15:57,279
said we're seeing that kind of decrease

433
00:15:57,279 --> 00:15:59,920
um but gift cards and credit card

434
00:15:59,920 --> 00:16:02,240
purchasing are you know by far and away

435
00:16:02,240 --> 00:16:04,639
the largest pieces of fraud

436
00:16:04,639 --> 00:16:08,560
i have a customer that has a gift card

437
00:16:08,560 --> 00:16:10,320
test endpoint where you can go see what

438
00:16:10,320 --> 00:16:11,920
your balance is

439
00:16:11,920 --> 00:16:14,160
and we've actually watched people go in

440
00:16:14,160 --> 00:16:15,120
there

441
00:16:15,120 --> 00:16:17,680
put ten thousand gift card numbers in

442
00:16:17,680 --> 00:16:20,320
just by sequentially guessing

443
00:16:20,320 --> 00:16:22,160
when they get back hits that say that

444
00:16:22,160 --> 00:16:24,160
there's value on those cards then they

445
00:16:24,160 --> 00:16:25,839
start hunting for the accounts so that

446
00:16:25,839 --> 00:16:28,560
they can transfer the money off

447
00:16:28,560 --> 00:16:30,639
so being able to get onto those

448
00:16:30,639 --> 00:16:33,600
authentication endpoints get on to those

449
00:16:33,600 --> 00:16:35,199
gift card endpoints

450
00:16:35,199 --> 00:16:38,240
means something is going to happen

451
00:16:38,240 --> 00:16:40,240
and then the last

452
00:16:40,240 --> 00:16:43,040
reason why we're seeing higher amounts

453
00:16:43,040 --> 00:16:45,279
of the tax on apis especially with our

454
00:16:45,279 --> 00:16:46,720
client base

455
00:16:46,720 --> 00:16:48,800
is hot stock items

456
00:16:48,800 --> 00:16:51,839
anybody here shoes do shoes

457
00:16:51,839 --> 00:16:54,160
any chefs in the crowd

458
00:16:54,160 --> 00:16:57,759
cop a lot of shoes no right um if you

459
00:16:57,759 --> 00:17:00,480
look up chefs you're gonna find cook

460
00:17:00,480 --> 00:17:01,440
groups

461
00:17:01,440 --> 00:17:03,600
um and these are people that are trying

462
00:17:03,600 --> 00:17:06,480
to buy shoes and then sell them on ebay

463
00:17:06,480 --> 00:17:08,400
they're 15 year old kids that live in

464
00:17:08,400 --> 00:17:10,880
their parents basement they make 200 000

465
00:17:10,880 --> 00:17:11,919
a year

466
00:17:11,919 --> 00:17:14,319
reselling brand new sneakers

467
00:17:14,319 --> 00:17:16,640
right it's a crazy market and it's

468
00:17:16,640 --> 00:17:19,679
really interesting to get involved in um

469
00:17:19,679 --> 00:17:22,319
the reason that these things are working

470
00:17:22,319 --> 00:17:23,520
is

471
00:17:23,520 --> 00:17:25,119
everybody's trying to fight this bot

472
00:17:25,119 --> 00:17:27,119
problems they do stuff like

473
00:17:27,119 --> 00:17:29,919
put the regular users in a waiting room

474
00:17:29,919 --> 00:17:32,000
right anybody here try to buy a ps5 or

475
00:17:32,000 --> 00:17:33,679
done the waiting room trip

476
00:17:33,679 --> 00:17:35,360
right you're standing in line like it's

477
00:17:35,360 --> 00:17:37,840
the 70s and you're trying to buy gas

478
00:17:37,840 --> 00:17:40,080
right like this isn't how it's supposed

479
00:17:40,080 --> 00:17:41,679
to work the internet's supposed to go

480
00:17:41,679 --> 00:17:43,280
way faster than this

481
00:17:43,280 --> 00:17:44,960
um and inner

482
00:17:44,960 --> 00:17:49,120
apis do go way faster than this

483
00:17:49,360 --> 00:17:51,200
we see a lot of

484
00:17:51,200 --> 00:17:53,200
times customers will come to us and

485
00:17:53,200 --> 00:17:54,480
they'll say all right well when we do a

486
00:17:54,480 --> 00:17:56,640
hot stock drop the first thing we do is

487
00:17:56,640 --> 00:17:59,280
we shut off our mobile app

488
00:17:59,280 --> 00:18:01,120
because we can't instrument

489
00:18:01,120 --> 00:18:03,280
the mobile app to understand you know

490
00:18:03,280 --> 00:18:04,880
with any kind of telemetry to understand

491
00:18:04,880 --> 00:18:06,960
is that a bot or is that a human so we

492
00:18:06,960 --> 00:18:09,200
leave only the website up

493
00:18:09,200 --> 00:18:11,200
which is kind of an odd thing do you

494
00:18:11,200 --> 00:18:12,720
know who knows how to get out of line

495
00:18:12,720 --> 00:18:15,600
faster on a website than you do bots

496
00:18:15,600 --> 00:18:16,799
that's who

497
00:18:16,799 --> 00:18:18,080
um

498
00:18:18,080 --> 00:18:20,160
if they leave the apis up

499
00:18:20,160 --> 00:18:22,240
apis are meant for speed

500
00:18:22,240 --> 00:18:23,840
right this is computer to commuter

501
00:18:23,840 --> 00:18:25,679
communication so the bots are going to

502
00:18:25,679 --> 00:18:26,840
win there

503
00:18:26,840 --> 00:18:28,799
too so

504
00:18:28,799 --> 00:18:30,559
if you ever want to figure out how do i

505
00:18:30,559 --> 00:18:33,039
beat the bots uh there's a

506
00:18:33,039 --> 00:18:35,760
interesting um article on this where

507
00:18:35,760 --> 00:18:37,200
this guy

508
00:18:37,200 --> 00:18:39,200
does what a bot does you know he's got

509
00:18:39,200 --> 00:18:41,200
50 tabs open on his computer and he's

510
00:18:41,200 --> 00:18:43,039
got all these accounts and all this kind

511
00:18:43,039 --> 00:18:44,320
of stuff

512
00:18:44,320 --> 00:18:47,360
and he ended up buying a ps5 that way

513
00:18:47,360 --> 00:18:49,360
i did a very similar activity where i

514
00:18:49,360 --> 00:18:51,520
sat in front of my local police station

515
00:18:51,520 --> 00:18:53,919
creating gmail accounts using their free

516
00:18:53,919 --> 00:18:55,679
wi-fi

517
00:18:55,679 --> 00:18:56,720
and

518
00:18:56,720 --> 00:18:59,440
to become a bot as a human is really

519
00:18:59,440 --> 00:19:01,039
crazy

520
00:19:01,039 --> 00:19:02,720
to go to the last talk that was in here

521
00:19:02,720 --> 00:19:05,360
the automation is important right

522
00:19:05,360 --> 00:19:09,280
instead of trying to do it one at a time

523
00:19:09,520 --> 00:19:10,960
all right so

524
00:19:10,960 --> 00:19:13,200
we've covered why automation may be

525
00:19:13,200 --> 00:19:15,760
working on your api right

526
00:19:15,760 --> 00:19:17,840
authentication authorization issues

527
00:19:17,840 --> 00:19:18,960
errors

528
00:19:18,960 --> 00:19:21,200
possibly forgotten endpoints

529
00:19:21,200 --> 00:19:23,440
and maybe assumptions of how users

530
00:19:23,440 --> 00:19:25,600
should work

531
00:19:25,600 --> 00:19:26,480
so

532
00:19:26,480 --> 00:19:28,559
this is a this is an example of an

533
00:19:28,559 --> 00:19:31,039
authorization problem

534
00:19:31,039 --> 00:19:32,480
i'm logged in

535
00:19:32,480 --> 00:19:34,000
to fitbit

536
00:19:34,000 --> 00:19:35,600
i'm going to pick on fitbit a lot

537
00:19:35,600 --> 00:19:37,919
because they're using this company

538
00:19:37,919 --> 00:19:40,080
lithium's platform

539
00:19:40,080 --> 00:19:41,440
and that's where my

540
00:19:41,440 --> 00:19:43,120
that's the problem that i found

541
00:19:43,120 --> 00:19:46,960
so you can see here uh i'm logged in

542
00:19:46,960 --> 00:19:47,919
and then

543
00:19:47,919 --> 00:19:50,320
i can search for

544
00:19:50,320 --> 00:19:53,840
myself or other users and so if you look

545
00:19:53,840 --> 00:19:56,000
at this weird string that's down here

546
00:19:56,000 --> 00:19:58,160
this is actually the request

547
00:19:58,160 --> 00:20:00,880
to look at my profile

548
00:20:00,880 --> 00:20:03,679
except i've changed out

549
00:20:03,679 --> 00:20:05,760
select splat

550
00:20:05,760 --> 00:20:06,559
and

551
00:20:06,559 --> 00:20:10,240
i'm looking at profile id one

552
00:20:10,240 --> 00:20:13,520
what's profile id one going to be

553
00:20:13,520 --> 00:20:15,760
if it's not zero

554
00:20:15,760 --> 00:20:17,120
this is gonna be the admin right like

555
00:20:17,120 --> 00:20:18,320
it's gonna be the first account that

556
00:20:18,320 --> 00:20:19,440
gets built

557
00:20:19,440 --> 00:20:22,400
um and so what i wanted to see was can i

558
00:20:22,400 --> 00:20:25,600
actually pull the data for user one

559
00:20:25,600 --> 00:20:27,760
logged in as myself right this is how an

560
00:20:27,760 --> 00:20:29,440
attacker is going to look at your site

561
00:20:29,440 --> 00:20:31,600
when they land on it

562
00:20:31,600 --> 00:20:34,880
and sure enough author id one

563
00:20:34,880 --> 00:20:37,360
um it says

564
00:20:37,360 --> 00:20:39,200
lithium admin

565
00:20:39,200 --> 00:20:41,440
uh as the user account

566
00:20:41,440 --> 00:20:44,320
so is this an authorization problem

567
00:20:44,320 --> 00:20:45,840
right i just

568
00:20:45,840 --> 00:20:48,240
looked at someone else's profile by

569
00:20:48,240 --> 00:20:50,799
guessing it right

570
00:20:50,799 --> 00:20:52,799
i probably shouldn't be able to see this

571
00:20:52,799 --> 00:20:53,840
profile

572
00:20:53,840 --> 00:20:55,760
though when i reported this to lithium

573
00:20:55,760 --> 00:20:58,879
they said no that's normal

574
00:20:59,200 --> 00:21:02,240
but in reality what's happened here

575
00:21:02,240 --> 00:21:04,640
is i sent that request in

576
00:21:04,640 --> 00:21:06,640
all of this stuff up here

577
00:21:06,640 --> 00:21:08,960
where it says lithium session id

578
00:21:08,960 --> 00:21:10,799
is the authentication token that i'm

579
00:21:10,799 --> 00:21:12,320
passing

580
00:21:12,320 --> 00:21:14,880
it's a platform authentication token

581
00:21:14,880 --> 00:21:19,440
it's not just for this particular tenant

582
00:21:19,440 --> 00:21:22,880
and so i was able to go look at

583
00:21:22,880 --> 00:21:24,640
the other things on there

584
00:21:24,640 --> 00:21:26,240
that are in the platform and we'll come

585
00:21:26,240 --> 00:21:29,200
back to this in a sec

586
00:21:29,360 --> 00:21:30,720
one of the other

587
00:21:30,720 --> 00:21:33,520
problems that i see a lot of is this

588
00:21:33,520 --> 00:21:35,200
exact example

589
00:21:35,200 --> 00:21:37,200
you'd sign up for something

590
00:21:37,200 --> 00:21:39,200
and then go back and try to sign up

591
00:21:39,200 --> 00:21:40,960
again and put your email address in

592
00:21:40,960 --> 00:21:42,320
again

593
00:21:42,320 --> 00:21:44,880
somewhere it's going to tell you that

594
00:21:44,880 --> 00:21:46,960
account already exists

595
00:21:46,960 --> 00:21:49,760
um and this is up in this uh error

596
00:21:49,760 --> 00:21:51,760
message here or down at the bottom there

597
00:21:51,760 --> 00:21:53,679
it says email exists

598
00:21:53,679 --> 00:21:55,600
this is how an attacker is going to

599
00:21:55,600 --> 00:21:57,760
enumerate all of the user accounts in

600
00:21:57,760 --> 00:21:59,760
your environment right

601
00:21:59,760 --> 00:22:02,640
so if you see a single ip address

602
00:22:02,640 --> 00:22:05,840
trying 10 000 usernames and generating

603
00:22:05,840 --> 00:22:07,919
this error message a lot

604
00:22:07,919 --> 00:22:09,520
that's somebody that's trying to figure

605
00:22:09,520 --> 00:22:11,200
out the accounts right

606
00:22:11,200 --> 00:22:12,400
so what's a better

607
00:22:12,400 --> 00:22:15,200
solution here

608
00:22:17,200 --> 00:22:19,520
a generic error message

609
00:22:19,520 --> 00:22:22,080
is better

610
00:22:22,400 --> 00:22:24,840
being being that i had to go through

611
00:22:24,840 --> 00:22:27,440
this the best thing that you can do is

612
00:22:27,440 --> 00:22:29,760
require all these fields because that's

613
00:22:29,760 --> 00:22:31,280
going to tie up somebody that's trying

614
00:22:31,280 --> 00:22:34,400
to attack you right

615
00:22:34,400 --> 00:22:35,840
but they're going to figure out an api

616
00:22:35,840 --> 00:22:37,600
endpoint that you have anyway and use

617
00:22:37,600 --> 00:22:39,280
that

618
00:22:39,280 --> 00:22:41,440
so something went wrong is a better

619
00:22:41,440 --> 00:22:43,520
better way to do this

620
00:22:43,520 --> 00:22:44,400
um

621
00:22:44,400 --> 00:22:46,799
most applications have routes folders

622
00:22:46,799 --> 00:22:48,960
now you can go find the routes it's

623
00:22:48,960 --> 00:22:51,280
going to tell you where everything is

624
00:22:51,280 --> 00:22:53,760
anybody here run a dynamic application

625
00:22:53,760 --> 00:22:56,799
security testing tool a dashed scanner

626
00:22:56,799 --> 00:22:59,760
like qualis or any of those tools

627
00:22:59,760 --> 00:23:02,559
see some heads nodding

628
00:23:02,559 --> 00:23:06,080
you can't scan an api why

629
00:23:06,080 --> 00:23:08,640
no ahrefs right i don't know where the

630
00:23:08,640 --> 00:23:11,440
next thing is so i have to give it some

631
00:23:11,440 --> 00:23:13,360
kind of information in order to figure

632
00:23:13,360 --> 00:23:14,799
that out

633
00:23:14,799 --> 00:23:17,120
a lot of the scanners now are accepting

634
00:23:17,120 --> 00:23:19,039
spec documentation and they just want

635
00:23:19,039 --> 00:23:21,039
you to point at it right so you have

636
00:23:21,039 --> 00:23:23,039
some public repository somewhere with

637
00:23:23,039 --> 00:23:25,200
your specs in it and we point at it

638
00:23:25,200 --> 00:23:27,840
um there's some danger that goes along

639
00:23:27,840 --> 00:23:29,440
with that as well

640
00:23:29,440 --> 00:23:31,440
but we are seeing more and more data

641
00:23:31,440 --> 00:23:33,520
that comes out in this stuff and like if

642
00:23:33,520 --> 00:23:35,600
you look at this this is chow now we'll

643
00:23:35,600 --> 00:23:37,679
take a look at these guys in a bit

644
00:23:37,679 --> 00:23:40,640
um there's an awful lot of data about

645
00:23:40,640 --> 00:23:43,679
each one of the profiles that's in here

646
00:23:43,679 --> 00:23:46,559
gps coordinates addresses

647
00:23:46,559 --> 00:23:49,360
their membership level inside of this

648
00:23:49,360 --> 00:23:50,720
environment

649
00:23:50,720 --> 00:23:53,520
there's a lot of potentially if there's

650
00:23:53,520 --> 00:23:55,200
a competitor wanted to look at this a

651
00:23:55,200 --> 00:23:57,520
competitor could go scrape this and

652
00:23:57,520 --> 00:23:59,600
you know really bear competition against

653
00:23:59,600 --> 00:24:01,120
them because they would know everything

654
00:24:01,120 --> 00:24:02,720
about every client

655
00:24:02,720 --> 00:24:05,440
now as this is chow now has anybody here

656
00:24:05,440 --> 00:24:08,400
used ciao now or do you know

657
00:24:08,400 --> 00:24:10,799
did any of your favorite bars that have

658
00:24:10,799 --> 00:24:12,799
a really good hamburger suddenly have a

659
00:24:12,799 --> 00:24:14,240
way to buy it and deliver it to your

660
00:24:14,240 --> 00:24:15,520
house

661
00:24:15,520 --> 00:24:17,679
that's probably chow now or toast one of

662
00:24:17,679 --> 00:24:18,720
the two

663
00:24:18,720 --> 00:24:21,039
um and this is how i found it my

664
00:24:21,039 --> 00:24:24,080
favorite burger place down the road

665
00:24:24,080 --> 00:24:26,240
during the pandemic i said how do i get

666
00:24:26,240 --> 00:24:27,760
my burger

667
00:24:27,760 --> 00:24:29,600
and they said well we got an app

668
00:24:29,600 --> 00:24:33,360
and i was like oh really

669
00:24:33,360 --> 00:24:36,559
and then i had two problems

670
00:24:39,039 --> 00:24:40,640
one of the other

671
00:24:40,640 --> 00:24:43,279
really odd things that we see and if you

672
00:24:43,279 --> 00:24:45,279
watch it's funny if you watch any of the

673
00:24:45,279 --> 00:24:47,840
youtube videos on how to do api security

674
00:24:47,840 --> 00:24:49,840
testing or anything like that

675
00:24:49,840 --> 00:24:51,760
they're going to tell you always look

676
00:24:51,760 --> 00:24:52,880
for

677
00:24:52,880 --> 00:24:53,840
you know

678
00:24:53,840 --> 00:24:55,600
lower version numbers

679
00:24:55,600 --> 00:24:58,480
if v15 is available v1 for sure is out

680
00:24:58,480 --> 00:25:00,640
there two or three

681
00:25:00,640 --> 00:25:02,559
i've had customers come to us and say

682
00:25:02,559 --> 00:25:05,039
we're being attacked i don't understand

683
00:25:05,039 --> 00:25:07,200
how they're getting to this end point

684
00:25:07,200 --> 00:25:09,520
and it's just got a trailing slash they

685
00:25:09,520 --> 00:25:11,200
didn't realize that they had left that

686
00:25:11,200 --> 00:25:13,039
endpoint open

687
00:25:13,039 --> 00:25:14,960
and they have to go in and you know turn

688
00:25:14,960 --> 00:25:16,880
the endpoint off

689
00:25:16,880 --> 00:25:19,360
but there's a lot of obvious endpoints

690
00:25:19,360 --> 00:25:20,640
that are out there

691
00:25:20,640 --> 00:25:24,320
login etc um that you're going to see a

692
00:25:24,320 --> 00:25:26,559
lot of traffic on it's the

693
00:25:26,559 --> 00:25:28,799
endpoints that probably shouldn't have

694
00:25:28,799 --> 00:25:30,799
any traffic on them

695
00:25:30,799 --> 00:25:32,159
that are going to tell you where the bad

696
00:25:32,159 --> 00:25:34,720
guys are right and a lot of times you

697
00:25:34,720 --> 00:25:37,440
can just scrape the ip addresses of

698
00:25:37,440 --> 00:25:39,679
the weird traffic that's coming in and

699
00:25:39,679 --> 00:25:41,120
just go block it

700
00:25:41,120 --> 00:25:42,400
right if you

701
00:25:42,400 --> 00:25:44,960
really want to be like that i tend to

702
00:25:44,960 --> 00:25:48,480
send people to this deceptive responses

703
00:25:48,480 --> 00:25:50,080
so they spend all day thinking they're

704
00:25:50,080 --> 00:25:51,840
on some site that they're the admin on

705
00:25:51,840 --> 00:25:54,240
but they're not

706
00:25:54,240 --> 00:25:56,240
i prefer that

707
00:25:56,240 --> 00:25:59,520
i pick on wordpress a lot because

708
00:25:59,520 --> 00:26:01,760
i have customers that have built entire

709
00:26:01,760 --> 00:26:04,559
ecommerce platforms out of wordpress

710
00:26:04,559 --> 00:26:08,080
and when they tell me that i say

711
00:26:08,080 --> 00:26:10,880
that's an interesting choice uh and as a

712
00:26:10,880 --> 00:26:12,880
minnesotan and somebody from the midwest

713
00:26:12,880 --> 00:26:14,799
whenever you say interesting

714
00:26:14,799 --> 00:26:16,799
uh that usually means bad

715
00:26:16,799 --> 00:26:17,600
right

716
00:26:17,600 --> 00:26:21,120
um but it's a really weird way to do it

717
00:26:21,120 --> 00:26:22,799
one of the challenges

718
00:26:22,799 --> 00:26:25,679
is that wp json file gives you all of

719
00:26:25,679 --> 00:26:27,200
the endpoints that are available the

720
00:26:27,200 --> 00:26:29,279
authentication that's available to them

721
00:26:29,279 --> 00:26:31,600
what kind of methods you can use it just

722
00:26:31,600 --> 00:26:33,120
goes on and on and on it's like a

723
00:26:33,120 --> 00:26:35,520
manifest of how to attack the thing

724
00:26:35,520 --> 00:26:36,840
if you've got

725
00:26:36,840 --> 00:26:39,679
xmlrpc.php open

726
00:26:39,679 --> 00:26:41,919
then i can turn you into a proxy

727
00:26:41,919 --> 00:26:43,039
endpoint

728
00:26:43,039 --> 00:26:44,559
and

729
00:26:44,559 --> 00:26:46,559
i know that you have that just by simple

730
00:26:46,559 --> 00:26:48,720
testing right and i'll show you guys how

731
00:26:48,720 --> 00:26:51,679
to do this in a sec

732
00:26:51,679 --> 00:26:54,799
so whenever i pick on these guys it's

733
00:26:54,799 --> 00:26:57,200
not because wordpress is terrible

734
00:26:57,200 --> 00:26:59,120
wordpress has a lot of problems and it's

735
00:26:59,120 --> 00:27:00,159
weird but

736
00:27:00,159 --> 00:27:02,080
this is the kind of stuff that's making

737
00:27:02,080 --> 00:27:05,600
it weird right leaving your defaults on

738
00:27:05,600 --> 00:27:07,520
we got rid of uh

739
00:27:07,520 --> 00:27:09,600
flash on websites you guys remember

740
00:27:09,600 --> 00:27:10,880
flash

741
00:27:10,880 --> 00:27:14,320
why did we get rid of flash

742
00:27:14,559 --> 00:27:16,799
anybody know

743
00:27:16,799 --> 00:27:18,720
it was an awesome malware platform like

744
00:27:18,720 --> 00:27:20,240
we could load malware because it's

745
00:27:20,240 --> 00:27:22,399
deeply embedded into your machine right

746
00:27:22,399 --> 00:27:24,240
but why did we have to get rid of it

747
00:27:24,240 --> 00:27:26,399
couldn't we just stop that well it turns

748
00:27:26,399 --> 00:27:28,399
out there were mechanisms to stop it

749
00:27:28,399 --> 00:27:31,200
it's called a crossdomain.xml file and

750
00:27:31,200 --> 00:27:32,799
that tells you where you're allowed to

751
00:27:32,799 --> 00:27:34,960
pull the flash from and you know how

752
00:27:34,960 --> 00:27:36,720
everybody configured it

753
00:27:36,720 --> 00:27:38,240
splat

754
00:27:38,240 --> 00:27:41,279
pull all flash right which had malware

755
00:27:41,279 --> 00:27:42,640
in it

756
00:27:42,640 --> 00:27:43,840
it's just

757
00:27:43,840 --> 00:27:46,240
hygiene right these are simple hygiene

758
00:27:46,240 --> 00:27:48,559
things

759
00:27:48,559 --> 00:27:51,039
so here's a few questions that are

760
00:27:51,039 --> 00:27:53,440
um obvious attacks that are going

761
00:27:53,440 --> 00:27:55,919
against api endpoints

762
00:27:55,919 --> 00:27:57,440
but

763
00:27:57,440 --> 00:27:59,039
this is the kind of stuff that we see

764
00:27:59,039 --> 00:28:00,480
all the time right

765
00:28:00,480 --> 00:28:01,360
um

766
00:28:01,360 --> 00:28:05,039
240 different 247 different ip addresses

767
00:28:05,039 --> 00:28:07,520
in two minutes same user from all over

768
00:28:07,520 --> 00:28:08,559
the world

769
00:28:08,559 --> 00:28:09,440
right

770
00:28:09,440 --> 00:28:10,960
um

771
00:28:10,960 --> 00:28:13,360
the ml that we use picks this stuff up

772
00:28:13,360 --> 00:28:14,840
pretty easily

773
00:28:14,840 --> 00:28:17,840
um this is a the second one is a really

774
00:28:17,840 --> 00:28:19,279
good one and i've been dealing with this

775
00:28:19,279 --> 00:28:21,279
at a client

776
00:28:21,279 --> 00:28:23,840
should you see the regular chrome user

777
00:28:23,840 --> 00:28:24,720
agent

778
00:28:24,720 --> 00:28:27,679
touching the mobile app endpoints

779
00:28:27,679 --> 00:28:30,159
typically you name that as a user agent

780
00:28:30,159 --> 00:28:33,279
right i call it my cool app or whatever

781
00:28:33,279 --> 00:28:35,039
and that's what the user agent i see

782
00:28:35,039 --> 00:28:36,640
that's the browser that i should see

783
00:28:36,640 --> 00:28:38,320
hitting those endpoints

784
00:28:38,320 --> 00:28:40,880
if i'm seeing chrome it's one of two

785
00:28:40,880 --> 00:28:41,919
things

786
00:28:41,919 --> 00:28:44,080
it's a developer testing to see if

787
00:28:44,080 --> 00:28:45,760
something works

788
00:28:45,760 --> 00:28:47,760
or attacker

789
00:28:47,760 --> 00:28:48,720
right

790
00:28:48,720 --> 00:28:50,399
there's only really two reasons you'd do

791
00:28:50,399 --> 00:28:52,559
that

792
00:28:52,640 --> 00:28:55,120
this last one is one that i've been

793
00:28:55,120 --> 00:28:57,200
dealing with with a customer minus in

794
00:28:57,200 --> 00:28:59,520
canada they only do business in canada

795
00:28:59,520 --> 00:29:01,600
they're a canadian company they only

796
00:29:01,600 --> 00:29:03,919
should have traffic from canada and you

797
00:29:03,919 --> 00:29:05,440
go look at the traffic hitting their

798
00:29:05,440 --> 00:29:06,880
site and it's from everywhere in the

799
00:29:06,880 --> 00:29:07,840
world

800
00:29:07,840 --> 00:29:10,640
right china russia ukraine

801
00:29:10,640 --> 00:29:13,520
all places that you would not expect

802
00:29:13,520 --> 00:29:16,000
them to be ordering you know food or

803
00:29:16,000 --> 00:29:17,039
whatever

804
00:29:17,039 --> 00:29:18,080
from them

805
00:29:18,080 --> 00:29:19,760
so should everyone in the world be able

806
00:29:19,760 --> 00:29:22,000
to get on your site this is the kind of

807
00:29:22,000 --> 00:29:23,120
stuff that

808
00:29:23,120 --> 00:29:24,960
if you're looking at the way that your

809
00:29:24,960 --> 00:29:27,520
site manages itself

810
00:29:27,520 --> 00:29:29,919
it's a good idea to ask

811
00:29:29,919 --> 00:29:32,399
so in this automation example

812
00:29:32,399 --> 00:29:34,720
if we look at that a little client

813
00:29:34,720 --> 00:29:36,140
user agent that's up there

814
00:29:36,140 --> 00:29:37,440
[Music]

815
00:29:37,440 --> 00:29:39,919
this was hitting a regular web endpoint

816
00:29:39,919 --> 00:29:42,799
right and i saw about 350 requests in

817
00:29:42,799 --> 00:29:44,240
two weeks

818
00:29:44,240 --> 00:29:46,559
so this is kind of a low and slow they

819
00:29:46,559 --> 00:29:48,799
were just looking at php files trying to

820
00:29:48,799 --> 00:29:50,799
find are there any vulnerabilities in

821
00:29:50,799 --> 00:29:52,640
here and this is the kind of stuff that

822
00:29:52,640 --> 00:29:54,960
we see constantly

823
00:29:54,960 --> 00:29:56,640
another one of these is

824
00:29:56,640 --> 00:29:59,200
um order numbers right this is somebody

825
00:29:59,200 --> 00:30:01,520
just iterating through order numbers you

826
00:30:01,520 --> 00:30:04,159
notice they're not sequential

827
00:30:04,159 --> 00:30:07,360
and we saw this two ips generated

828
00:30:07,360 --> 00:30:10,000
twice of this many requests

829
00:30:10,000 --> 00:30:12,559
in about 20 minutes and then went away

830
00:30:12,559 --> 00:30:13,600
right

831
00:30:13,600 --> 00:30:16,080
what this is is somebody had ordered

832
00:30:16,080 --> 00:30:18,799
shoes and they were checking to see if

833
00:30:18,799 --> 00:30:20,640
they had shipped

834
00:30:20,640 --> 00:30:21,520
right

835
00:30:21,520 --> 00:30:23,919
so what ended up happening is

836
00:30:23,919 --> 00:30:25,520
we realized that they got through and

837
00:30:25,520 --> 00:30:26,799
bought a bunch of shoes and shut all

838
00:30:26,799 --> 00:30:28,240
their orders down on the back side when

839
00:30:28,240 --> 00:30:29,520
they started running their tracking

840
00:30:29,520 --> 00:30:30,880
program on it

841
00:30:30,880 --> 00:30:33,360
um and you know

842
00:30:33,360 --> 00:30:35,279
then they do a restock and

843
00:30:35,279 --> 00:30:37,520
the bach guys get mad

844
00:30:37,520 --> 00:30:40,240
what are you going to do

845
00:30:40,399 --> 00:30:42,320
i had a responsible disclosure right

846
00:30:42,320 --> 00:30:44,480
before covet started

847
00:30:44,480 --> 00:30:45,600
where

848
00:30:45,600 --> 00:30:48,240
i bought this webcam

849
00:30:48,240 --> 00:30:50,559
something was eating my cucumbers

850
00:30:50,559 --> 00:30:53,600
and i know you all can relate to this um

851
00:30:53,600 --> 00:30:55,200
right out in my greenhouse something ate

852
00:30:55,200 --> 00:30:57,039
all my cucumbers it was aggravating they

853
00:30:57,039 --> 00:30:58,399
were eating the plants they weren't

854
00:30:58,399 --> 00:31:00,320
eating the fruit the plants right down

855
00:31:00,320 --> 00:31:02,000
to the grounds annoying

856
00:31:02,000 --> 00:31:04,559
so i put a i bought this camera and i

857
00:31:04,559 --> 00:31:06,640
had a web app that's fun

858
00:31:06,640 --> 00:31:07,919
um and

859
00:31:07,919 --> 00:31:09,919
so i started playing around with the api

860
00:31:09,919 --> 00:31:12,559
endpoints and i realized that if i gave

861
00:31:12,559 --> 00:31:15,120
you a a bad account name

862
00:31:15,120 --> 00:31:16,880
it gave me an error message and if i

863
00:31:16,880 --> 00:31:18,799
gave you a bad password it gave me a

864
00:31:18,799 --> 00:31:20,399
different error message

865
00:31:20,399 --> 00:31:22,399
man talk about a system that makes it

866
00:31:22,399 --> 00:31:24,399
easy to go figure out what the usernames

867
00:31:24,399 --> 00:31:26,720
and passwords are i mean it just kept

868
00:31:26,720 --> 00:31:28,880
generating all these error messages

869
00:31:28,880 --> 00:31:30,640
so i did a responsible disclosure with

870
00:31:30,640 --> 00:31:32,480
them and you know what they did they

871
00:31:32,480 --> 00:31:34,640
made this error message the only error

872
00:31:34,640 --> 00:31:36,960
message

873
00:31:37,360 --> 00:31:38,320
so

874
00:31:38,320 --> 00:31:40,159
people will be confused

875
00:31:40,159 --> 00:31:42,960
it was a good idea

876
00:31:43,279 --> 00:31:44,320
all right so now i'm going to do

877
00:31:44,320 --> 00:31:46,559
something that's uh possibly a little

878
00:31:46,559 --> 00:31:48,640
controversial but i haven't had a live

879
00:31:48,640 --> 00:31:50,880
demo fail in years right because we

880
00:31:50,880 --> 00:31:53,279
haven't been out walking around uh too

881
00:31:53,279 --> 00:31:54,640
much so

882
00:31:54,640 --> 00:31:56,399
i think i'm gonna you know tempt the

883
00:31:56,399 --> 00:31:59,039
demo gods and see if i can't get some of

884
00:31:59,039 --> 00:32:00,399
this to work

885
00:32:00,399 --> 00:32:02,159
so what i'm gonna do

886
00:32:02,159 --> 00:32:05,120
um is i'm going to set up burp

887
00:32:05,120 --> 00:32:08,000
so i've got burp here

888
00:32:08,000 --> 00:32:09,919
and

889
00:32:09,919 --> 00:32:14,120
it's not displaying it on the screen

890
00:32:14,320 --> 00:32:16,720
because

891
00:32:16,720 --> 00:32:19,600
i need to do that

892
00:32:19,919 --> 00:32:21,360
see i haven't had to do all this in a

893
00:32:21,360 --> 00:32:22,799
long time either i'm sitting home with

894
00:32:22,799 --> 00:32:24,870
two monitors usually

895
00:32:24,870 --> 00:32:28,050
[Music]

896
00:32:28,240 --> 00:32:29,200
yeah

897
00:32:29,200 --> 00:32:30,799
so this is burp

898
00:32:30,799 --> 00:32:33,440
anybody here use burp

899
00:32:33,440 --> 00:32:36,000
yeah anybody here use burp

900
00:32:36,000 --> 00:32:37,840
for machines that are not the machine

901
00:32:37,840 --> 00:32:40,159
burps running on so proxying things

902
00:32:40,159 --> 00:32:42,960
through your machine okay so the way

903
00:32:42,960 --> 00:32:45,679
that you do that is up at the top i'm in

904
00:32:45,679 --> 00:32:48,799
proxy options so if you aren't familiar

905
00:32:48,799 --> 00:32:50,799
with burp there's kind of primary

906
00:32:50,799 --> 00:32:53,120
secondary navigation that happens on the

907
00:32:53,120 --> 00:32:55,919
page so i'm in the proxy settings under

908
00:32:55,919 --> 00:32:58,559
options and what i've done is i've added

909
00:32:58,559 --> 00:33:00,399
port 8100

910
00:33:00,399 --> 00:33:02,720
to all interfaces

911
00:33:02,720 --> 00:33:04,399
then what i can do is go into my mobile

912
00:33:04,399 --> 00:33:07,200
phone and say i have a proxy it's port

913
00:33:07,200 --> 00:33:09,600
8100 and it's the ip address of my

914
00:33:09,600 --> 00:33:10,720
machine

915
00:33:10,720 --> 00:33:12,399
that way my mobile phone will proxy

916
00:33:12,399 --> 00:33:14,000
everything through there if i want to

917
00:33:14,000 --> 00:33:15,519
start looking at api endpoints or

918
00:33:15,519 --> 00:33:18,559
whatever i can do that

919
00:33:19,760 --> 00:33:20,880
so

920
00:33:20,880 --> 00:33:24,159
let's look at some stuff

921
00:33:24,159 --> 00:33:26,240
this is uh fitbit

922
00:33:26,240 --> 00:33:28,000
um like i said i pick on them quite a

923
00:33:28,000 --> 00:33:29,760
bit because you know

924
00:33:29,760 --> 00:33:32,320
i found this problem with lithium

925
00:33:32,320 --> 00:33:34,320
once i get logged in here i'm

926
00:33:34,320 --> 00:33:36,559
authenticated onto their platform

927
00:33:36,559 --> 00:33:37,519
but i'm

928
00:33:37,519 --> 00:33:39,360
not just authenticated on the fitbit's

929
00:33:39,360 --> 00:33:41,200
platform i'm like i said i'm

930
00:33:41,200 --> 00:33:43,200
authenticated to everything that lithium

931
00:33:43,200 --> 00:33:44,640
has

932
00:33:44,640 --> 00:33:47,600
and the reason that that's important to

933
00:33:47,600 --> 00:33:50,720
sort of note is when you go look at

934
00:33:50,720 --> 00:33:53,519
proxy http history

935
00:33:53,519 --> 00:33:56,000
when i go look at this actual post that

936
00:33:56,000 --> 00:33:57,760
logged me in

937
00:33:57,760 --> 00:34:00,320
where you at

938
00:34:03,760 --> 00:34:05,919
it made a request to go get my

939
00:34:05,919 --> 00:34:08,559
information

940
00:34:08,560 --> 00:34:09,918
really small

941
00:34:09,918 --> 00:34:11,520
i tried to blow this up as big as i

942
00:34:11,520 --> 00:34:14,560
could but still kind of small but inside

943
00:34:14,560 --> 00:34:16,639
of this query it's just simply going and

944
00:34:16,639 --> 00:34:19,119
getting my user profile information that

945
00:34:19,119 --> 00:34:20,480
kind of stuff

946
00:34:20,480 --> 00:34:21,359
so

947
00:34:21,359 --> 00:34:24,000
what i can do is take a look at the

948
00:34:24,000 --> 00:34:26,079
requests that go out and the responses

949
00:34:26,079 --> 00:34:28,000
that come back and see can i make

950
00:34:28,000 --> 00:34:29,199
changes

951
00:34:29,199 --> 00:34:31,918
and so in this case i can see that i'm

952
00:34:31,918 --> 00:34:34,159
making a request

953
00:34:34,159 --> 00:34:37,040
to get information after i authenticate

954
00:34:37,040 --> 00:34:39,520
and then

955
00:34:43,359 --> 00:34:47,560
all right and then the request

956
00:34:52,320 --> 00:34:54,800
here it is

957
00:34:56,879 --> 00:35:00,078
sent to repeat

958
00:35:00,320 --> 00:35:01,760
so here's the request after i

959
00:35:01,760 --> 00:35:03,200
authenticate

960
00:35:03,200 --> 00:35:05,359
and up there you can see that select id

961
00:35:05,359 --> 00:35:06,720
if you got really good eyes you can see

962
00:35:06,720 --> 00:35:10,000
select id avatar profile etc and so

963
00:35:10,000 --> 00:35:12,400
forth and my profile id

964
00:35:12,400 --> 00:35:15,040
doesn't that look like sql

965
00:35:15,040 --> 00:35:17,760
remember that thing i showed you earlier

966
00:35:17,760 --> 00:35:18,560
um

967
00:35:18,560 --> 00:35:22,640
select id login avatar where users etc

968
00:35:22,640 --> 00:35:24,720
right this looks a lot like sql to me

969
00:35:24,720 --> 00:35:26,400
when i sent this in i said listen you

970
00:35:26,400 --> 00:35:28,079
guys have our string concatenating

971
00:35:28,079 --> 00:35:29,680
directly into sql you should never do

972
00:35:29,680 --> 00:35:32,720
that they said it's not sql

973
00:35:32,720 --> 00:35:33,800
that's

974
00:35:33,800 --> 00:35:35,440
liql

975
00:35:35,440 --> 00:35:37,760
it's lithium query language

976
00:35:37,760 --> 00:35:39,599
not sql at all

977
00:35:39,599 --> 00:35:41,920
and you can't do anything with it and i

978
00:35:41,920 --> 00:35:44,400
went oh okay

979
00:35:44,400 --> 00:35:45,680
if you

980
00:35:45,680 --> 00:35:48,960
were to zoom in on this a little better

981
00:35:48,960 --> 00:35:50,960
you'd notice up in the

982
00:35:50,960 --> 00:35:53,599
in the query string there's this weird

983
00:35:53,599 --> 00:35:56,720
alphanumeric character set

984
00:35:56,720 --> 00:35:58,560
and i looked at this and i thought well

985
00:35:58,560 --> 00:36:00,960
what is that what what on earth is this

986
00:36:00,960 --> 00:36:02,640
weird alphanumeric

987
00:36:02,640 --> 00:36:05,119
numeric character set that's up there

988
00:36:05,119 --> 00:36:08,880
and if we look at it it's

989
00:36:10,040 --> 00:36:13,839
x-m-n-u-z whatever

990
00:36:14,160 --> 00:36:16,800
so i went and did a dns query

991
00:36:16,800 --> 00:36:18,720
and i figured out that that's

992
00:36:18,720 --> 00:36:21,680
fitbit's community

993
00:36:21,680 --> 00:36:23,359
and what i can do

994
00:36:23,359 --> 00:36:24,839
is just

995
00:36:24,839 --> 00:36:28,000
change the string in the front and it'll

996
00:36:28,000 --> 00:36:31,280
change the community that i'm looking at

997
00:36:31,280 --> 00:36:34,079
because it's a multi-tenant platform

998
00:36:34,079 --> 00:36:36,240
so what i've done now is i've changed it

999
00:36:36,240 --> 00:36:39,280
to a different one i now need to change

1000
00:36:39,280 --> 00:36:42,640
probably the host that it's going to

1001
00:36:42,640 --> 00:36:47,200
because this is actually roku

1002
00:36:49,359 --> 00:36:51,520
and i send in the query and it sends me

1003
00:36:51,520 --> 00:36:53,200
back success

1004
00:36:53,200 --> 00:36:56,320
i was looking for myself if i go throw a

1005
00:36:56,320 --> 00:36:58,720
splat in there it's gonna go get

1006
00:36:58,720 --> 00:36:59,839
everything

1007
00:36:59,839 --> 00:37:03,280
um and so what i've done is i've

1008
00:37:03,280 --> 00:37:05,839
you know pre-set up this query so that

1009
00:37:05,839 --> 00:37:09,839
way it'll be a little faster up here but

1010
00:37:10,640 --> 00:37:13,040
just do

1011
00:37:13,040 --> 00:37:16,040
this

1012
00:37:22,160 --> 00:37:24,000
and now i've got the api sending me

1013
00:37:24,000 --> 00:37:26,400
everything what it's done now is sent me

1014
00:37:26,400 --> 00:37:28,400
a list of all users

1015
00:37:28,400 --> 00:37:30,400
so i'm authenticated onto fitbit's

1016
00:37:30,400 --> 00:37:33,280
platform and i just requested all users

1017
00:37:33,280 --> 00:37:36,960
by changing the sql query on roku's

1018
00:37:36,960 --> 00:37:39,280
platform

1019
00:37:39,280 --> 00:37:42,240
anybody think this is wrong

1020
00:37:42,240 --> 00:37:44,240
because lithium didn't

1021
00:37:44,240 --> 00:37:46,000
and

1022
00:37:46,000 --> 00:37:47,599
when i sent it to him they thought it

1023
00:37:47,599 --> 00:37:49,440
was completely normal and i was like

1024
00:37:49,440 --> 00:37:51,440
okay

1025
00:37:51,440 --> 00:37:53,520
so this is ciao now

1026
00:37:53,520 --> 00:37:55,839
i also sent them a bunch of stuff about

1027
00:37:55,839 --> 00:37:59,359
this this is a really wordy response

1028
00:37:59,359 --> 00:38:01,599
site they have a lot of things that come

1029
00:38:01,599 --> 00:38:04,160
out on their responses each one of these

1030
00:38:04,160 --> 00:38:06,640
numbers up here represents one of their

1031
00:38:06,640 --> 00:38:09,200
customers so you can literally get all

1032
00:38:09,200 --> 00:38:11,760
of their customers their gps coordinates

1033
00:38:11,760 --> 00:38:13,280
their addresses

1034
00:38:13,280 --> 00:38:15,760
who the administrator is for this stuff

1035
00:38:15,760 --> 00:38:18,000
it's a lot of things that shouldn't be

1036
00:38:18,000 --> 00:38:19,920
accessible to me

1037
00:38:19,920 --> 00:38:23,119
as somebody that's out there

1038
00:38:23,520 --> 00:38:25,839
yesterday i

1039
00:38:25,839 --> 00:38:27,440
i did a talk

1040
00:38:27,440 --> 00:38:30,480
on api specs

1041
00:38:30,480 --> 00:38:33,839
for api world uh which was a conference

1042
00:38:33,839 --> 00:38:36,320
that occurred as a virtual conference

1043
00:38:36,320 --> 00:38:39,760
and they use a system called hop in

1044
00:38:39,760 --> 00:38:41,599
uh as their

1045
00:38:41,599 --> 00:38:43,520
zoom if you will the conference

1046
00:38:43,520 --> 00:38:45,520
management software

1047
00:38:45,520 --> 00:38:46,880
and so

1048
00:38:46,880 --> 00:38:49,280
while i was waiting to to give the talk

1049
00:38:49,280 --> 00:38:51,760
i ran one of our new tools against hop

1050
00:38:51,760 --> 00:38:53,760
in and and i went and found their api

1051
00:38:53,760 --> 00:38:55,040
specs

1052
00:38:55,040 --> 00:38:55,760
right

1053
00:38:55,760 --> 00:38:57,760
their specs now tell me all of the

1054
00:38:57,760 --> 00:38:59,599
things that i need to know how they

1055
00:38:59,599 --> 00:39:01,280
authenticate

1056
00:39:01,280 --> 00:39:03,920
and interestingly like if you go digging

1057
00:39:03,920 --> 00:39:05,520
through all this stuff

1058
00:39:05,520 --> 00:39:07,359
it'll tell you like

1059
00:39:07,359 --> 00:39:09,200
here is how our authentication is

1060
00:39:09,200 --> 00:39:11,200
supposed to work it's supposed to be a

1061
00:39:11,200 --> 00:39:15,040
jwt in this header right so now i know

1062
00:39:15,040 --> 00:39:17,200
quite a bit about how the authentication

1063
00:39:17,200 --> 00:39:18,960
is going to function here

1064
00:39:18,960 --> 00:39:21,680
and i know a lot about all of the routes

1065
00:39:21,680 --> 00:39:23,280
that they have where their documents are

1066
00:39:23,280 --> 00:39:26,000
hidden and all that kind of stuff

1067
00:39:26,000 --> 00:39:29,119
what makes it nice um is that i've been

1068
00:39:29,119 --> 00:39:32,400
doing this with a tool that my company

1069
00:39:32,400 --> 00:39:34,960
is just now starting to put together

1070
00:39:34,960 --> 00:39:37,599
um so this is api fury

1071
00:39:37,599 --> 00:39:40,560
um and all this is is we are taking this

1072
00:39:40,560 --> 00:39:42,000
concept that kite runner has put

1073
00:39:42,000 --> 00:39:43,200
together

1074
00:39:43,200 --> 00:39:45,440
and adding a bunch of stuff to it based

1075
00:39:45,440 --> 00:39:47,599
on what our customers want so you can

1076
00:39:47,599 --> 00:39:50,320
see i put in hop in that's the the

1077
00:39:50,320 --> 00:39:52,000
organization the conference running

1078
00:39:52,000 --> 00:39:53,119
software

1079
00:39:53,119 --> 00:39:55,200
and it told me here are all your open

1080
00:39:55,200 --> 00:39:57,280
api swagger endpoints there's a bunch of

1081
00:39:57,280 --> 00:39:59,280
exposed files that come out of this all

1082
00:39:59,280 --> 00:40:01,760
the rest api services that we could find

1083
00:40:01,760 --> 00:40:03,760
um all the different pieces that i would

1084
00:40:03,760 --> 00:40:06,880
need to move to the next phase right

1085
00:40:06,880 --> 00:40:07,839
so

1086
00:40:07,839 --> 00:40:09,040
what i'm

1087
00:40:09,040 --> 00:40:10,960
now

1088
00:40:10,960 --> 00:40:13,680
trying to illustrate to folks is that

1089
00:40:13,680 --> 00:40:15,520
this information

1090
00:40:15,520 --> 00:40:17,280
these apis that are out there that are

1091
00:40:17,280 --> 00:40:19,599
making all of this noise

1092
00:40:19,599 --> 00:40:20,640
um

1093
00:40:20,640 --> 00:40:22,839
they're easier and easier to

1094
00:40:22,839 --> 00:40:26,319
find in addition to that more of us are

1095
00:40:26,319 --> 00:40:29,359
putting out specs or documents that tell

1096
00:40:29,359 --> 00:40:33,040
us how to interact with the api

1097
00:40:33,040 --> 00:40:34,160
and

1098
00:40:34,160 --> 00:40:37,040
not necessarily as a human as computer

1099
00:40:37,040 --> 00:40:39,040
to computer interaction

1100
00:40:39,040 --> 00:40:41,520
um so if you just google go out and

1101
00:40:41,520 --> 00:40:43,599
google and look for things like

1102
00:40:43,599 --> 00:40:46,160
app api docs

1103
00:40:46,160 --> 00:40:49,200
or slash swagger.json or any of those

1104
00:40:49,200 --> 00:40:50,400
kinds of things

1105
00:40:50,400 --> 00:40:53,599
you're gonna start to see spec sheets

1106
00:40:53,599 --> 00:40:55,520
and you're going to start to see

1107
00:40:55,520 --> 00:40:57,599
information that's going to lead you to

1108
00:40:57,599 --> 00:40:59,599
the what would be the next phase of the

1109
00:40:59,599 --> 00:41:01,520
attack

1110
00:41:01,520 --> 00:41:04,079
open api files

1111
00:41:04,079 --> 00:41:06,160
i recommend that you have them you

1112
00:41:06,160 --> 00:41:08,560
should have them for your security teams

1113
00:41:08,560 --> 00:41:11,680
definitely it should be a review process

1114
00:41:11,680 --> 00:41:13,520
that goes along with that but it

1115
00:41:13,520 --> 00:41:15,200
definitely shouldn't be something that's

1116
00:41:15,200 --> 00:41:17,359
open to the public

1117
00:41:17,359 --> 00:41:20,160
i believe that if you're going to be

1118
00:41:20,160 --> 00:41:22,560
publishing an open api spec or a swagger

1119
00:41:22,560 --> 00:41:24,960
spec for your apis

1120
00:41:24,960 --> 00:41:27,680
receiving that should require an mba

1121
00:41:27,680 --> 00:41:28,640
right

1122
00:41:28,640 --> 00:41:30,880
um just simply because

1123
00:41:30,880 --> 00:41:32,240
you don't want to have it out in the

1124
00:41:32,240 --> 00:41:33,119
public

1125
00:41:33,119 --> 00:41:35,119
because people can find them

1126
00:41:35,119 --> 00:41:36,800
so in addition to

1127
00:41:36,800 --> 00:41:39,040
simple dns queries simple searches

1128
00:41:39,040 --> 00:41:41,040
through your mobile applications

1129
00:41:41,040 --> 00:41:42,960
if i know your top level domain i can

1130
00:41:42,960 --> 00:41:45,040
start sweeping it for

1131
00:41:45,040 --> 00:41:46,720
specs

1132
00:41:46,720 --> 00:41:49,200
once you have a spec though being able

1133
00:41:49,200 --> 00:41:50,960
to do things like monitor for spec

1134
00:41:50,960 --> 00:41:52,560
conformance

1135
00:41:52,560 --> 00:41:54,240
is the app actually doing what you

1136
00:41:54,240 --> 00:41:57,119
expect it to do our users actually

1137
00:41:57,119 --> 00:41:58,960
making proper requests to the

1138
00:41:58,960 --> 00:42:01,599
application that kind of stuff

1139
00:42:01,599 --> 00:42:04,000
you're going to start to see

1140
00:42:04,000 --> 00:42:06,960
your api security is going to get a lot

1141
00:42:06,960 --> 00:42:08,480
more robust

1142
00:42:08,480 --> 00:42:09,920
and you're going to see the attackers

1143
00:42:09,920 --> 00:42:12,240
coming less

1144
00:42:12,240 --> 00:42:13,680
i always recommend to people that they

1145
00:42:13,680 --> 00:42:15,119
go out and they teach themselves about

1146
00:42:15,119 --> 00:42:17,359
these things

1147
00:42:17,359 --> 00:42:19,280
simply googling yourself and having a

1148
00:42:19,280 --> 00:42:20,880
good amount of google foo is a great

1149
00:42:20,880 --> 00:42:22,160
idea

1150
00:42:22,160 --> 00:42:24,079
test for errors in your applications

1151
00:42:24,079 --> 00:42:25,520
what are the things that you're telling

1152
00:42:25,520 --> 00:42:27,040
people

1153
00:42:27,040 --> 00:42:28,640
run your apps and your mobile apps

1154
00:42:28,640 --> 00:42:30,640
through proxy

1155
00:42:30,640 --> 00:42:32,800
and try to find any of the endpoints

1156
00:42:32,800 --> 00:42:34,560
that might still be stuck or that are

1157
00:42:34,560 --> 00:42:37,359
out there look at your logs

1158
00:42:37,359 --> 00:42:40,720
and if you don't have logs get logs

1159
00:42:40,720 --> 00:42:42,400
they're great

1160
00:42:42,400 --> 00:42:44,640
and they let you look for things like

1161
00:42:44,640 --> 00:42:46,560
do i have endpoints that are open that

1162
00:42:46,560 --> 00:42:48,079
people are using

1163
00:42:48,079 --> 00:42:50,160
right that makes it very easy to figure

1164
00:42:50,160 --> 00:42:52,000
that stuff out on your own

1165
00:42:52,000 --> 00:42:54,079
and finally if you're interested in api

1166
00:42:54,079 --> 00:42:55,839
security and you want to learn more

1167
00:42:55,839 --> 00:42:57,760
about this there's an application out

1168
00:42:57,760 --> 00:43:00,560
there if you've ever used web goat or

1169
00:43:00,560 --> 00:43:04,079
juice shop there's an api specific

1170
00:43:04,079 --> 00:43:06,480
vulnerable app called crappy

1171
00:43:06,480 --> 00:43:07,920
uh it's a

1172
00:43:07,920 --> 00:43:10,880
completely ridiculous api

1173
00:43:10,880 --> 00:43:13,440
but crappy's got some uh really neat

1174
00:43:13,440 --> 00:43:15,280
features in it and it's a very good

1175
00:43:15,280 --> 00:43:17,440
education tool if you have a group of

1176
00:43:17,440 --> 00:43:20,079
developers uh back at the office that

1177
00:43:20,079 --> 00:43:22,800
you'd like to teach about api security

1178
00:43:22,800 --> 00:43:24,560
have them install zap have them install

1179
00:43:24,560 --> 00:43:26,720
burp install crappy

1180
00:43:26,720 --> 00:43:28,560
and work through the challenges it's a

1181
00:43:28,560 --> 00:43:32,000
it's a pretty good system in my opinion

1182
00:43:32,000 --> 00:43:34,240
like i said be on the lookout for our

1183
00:43:34,240 --> 00:43:36,800
api fury if you're looking to do some

1184
00:43:36,800 --> 00:43:38,960
discovery on your apis that'll be coming

1185
00:43:38,960 --> 00:43:41,760
out here in the next month or so

1186
00:43:41,760 --> 00:43:43,440
you can find me on linkedin

1187
00:43:43,440 --> 00:43:45,599
uh or shoot me an email

1188
00:43:45,599 --> 00:43:48,400
jason.kent at sequence.ai

1189
00:43:48,400 --> 00:43:50,000
i think this is the fourth time i've

1190
00:43:50,000 --> 00:43:52,560
spoken at this conference and every year

1191
00:43:52,560 --> 00:43:55,040
it's just as fun as the last so i really

1192
00:43:55,040 --> 00:43:56,480
enjoyed being here

1193
00:43:56,480 --> 00:43:58,079
if you guys have any questions i'll be

1194
00:43:58,079 --> 00:43:59,359
sticking around for a little while and

1195
00:43:59,359 --> 00:44:01,280
then run into the airport so

1196
00:44:01,280 --> 00:44:03,200
i really appreciate the time you spent

1197
00:44:03,200 --> 00:44:05,440
with me today and i hope your apis are

1198
00:44:05,440 --> 00:44:07,600
safe and secure

1199
00:44:07,600 --> 00:44:14,029
[Applause]

