1
00:00:06,899 --> 00:00:09,080
foreign

2
00:00:17,730 --> 00:00:20,850
[Music]

3
00:00:30,430 --> 00:00:33,489
[Music]

4
00:00:37,280 --> 00:00:45,520
[Music]

5
00:00:51,100 --> 00:00:53,719
[Music]

6
00:00:53,719 --> 00:00:56,399
I'm here to talk about apis how many of

7
00:00:56,399 --> 00:00:57,719
you are sitting here because it says

8
00:00:57,719 --> 00:01:01,140
apis in the title see I do that every

9
00:01:01,140 --> 00:01:03,920
time now how many of you are hiring

10
00:01:03,920 --> 00:01:06,960
anybody anybody hiring there's one

11
00:01:06,960 --> 00:01:09,840
anybody else hiring I like to ask who's

12
00:01:09,840 --> 00:01:11,520
hiring rather than who's looking to get

13
00:01:11,520 --> 00:01:12,900
hired because you might be sitting next

14
00:01:12,900 --> 00:01:14,280
to your co-worker who doesn't know

15
00:01:14,280 --> 00:01:15,680
anything

16
00:01:15,680 --> 00:01:18,420
I tried I'm not looking no I got it I

17
00:01:18,420 --> 00:01:20,880
got a great job and love it right like

18
00:01:20,880 --> 00:01:22,860
all right so I've been doing a lot of

19
00:01:22,860 --> 00:01:24,659
research lately and the research that

20
00:01:24,659 --> 00:01:27,000
I've been doing is how come you guys are

21
00:01:27,000 --> 00:01:29,100
leaving all these public endpoints out

22
00:01:29,100 --> 00:01:31,979
there that have things on them that I

23
00:01:31,979 --> 00:01:33,900
can use to attack you that's the

24
00:01:33,900 --> 00:01:36,840
question right so here's a first is

25
00:01:36,840 --> 00:01:38,340
anybody work for BMW

26
00:01:38,340 --> 00:01:39,840
hahaha

27
00:01:39,840 --> 00:01:41,220
all right

28
00:01:41,220 --> 00:01:45,240
so this is BMW's website uh CD Dash you

29
00:01:45,240 --> 00:01:46,920
all right so this is one of their

30
00:01:46,920 --> 00:01:49,619
websites right and if I go to The Domain

31
00:01:49,619 --> 00:01:52,920
entry I get a 404 error right what

32
00:01:52,920 --> 00:01:55,079
happens if I go to that domain entry but

33
00:01:55,079 --> 00:01:56,939
I start to look for a resource one that

34
00:01:56,939 --> 00:02:00,079
I know may be there

35
00:02:03,400 --> 00:02:05,360
[Music]

36
00:02:05,360 --> 00:02:08,399
how do I find these things well I've got

37
00:02:08,399 --> 00:02:10,380
a neat little word list

38
00:02:10,380 --> 00:02:13,680
and a bunch of domains out there so this

39
00:02:13,680 --> 00:02:15,480
is the problem that I'm here to talk

40
00:02:15,480 --> 00:02:18,840
about right I can go to websites all

41
00:02:18,840 --> 00:02:21,599
over the place and I can find resources

42
00:02:21,599 --> 00:02:24,720
I shouldn't be able to find right and

43
00:02:24,720 --> 00:02:26,040
I'm going to go into a couple more of

44
00:02:26,040 --> 00:02:28,080
them as I go through my talk

45
00:02:28,080 --> 00:02:29,819
but it definitely is one of those things

46
00:02:29,819 --> 00:02:31,860
that we all need to have a little bit of

47
00:02:31,860 --> 00:02:33,239
Consciousness about

48
00:02:33,239 --> 00:02:35,280
so

49
00:02:35,280 --> 00:02:38,599
having said all that

50
00:02:40,459 --> 00:02:42,660
it's me

51
00:02:42,660 --> 00:02:44,580
my name is Jason if you haven't seen me

52
00:02:44,580 --> 00:02:46,680
speak before I've spoke at this

53
00:02:46,680 --> 00:02:48,000
conference a bunch of times I think it's

54
00:02:48,000 --> 00:02:49,500
my first time in this room but this may

55
00:02:49,500 --> 00:02:51,000
be the last room I've done you know I

56
00:02:51,000 --> 00:02:52,980
think I've done them all now

57
00:02:52,980 --> 00:02:53,700
um

58
00:02:53,700 --> 00:02:57,239
so I work for a sequence security we do

59
00:02:57,239 --> 00:02:59,280
API protection so obviously I'm in the

60
00:02:59,280 --> 00:03:01,200
API space quite a bit but I have been

61
00:03:01,200 --> 00:03:03,840
for a long time first talk I did here

62
00:03:03,840 --> 00:03:06,720
was on the Chamberlain garage door API I

63
00:03:06,720 --> 00:03:08,819
opened my garage and then a friend of

64
00:03:08,819 --> 00:03:10,500
mine in California I called him up and

65
00:03:10,500 --> 00:03:12,959
said hey I need the ID number off the

66
00:03:12,959 --> 00:03:15,300
Box on your garage door opener just for

67
00:03:15,300 --> 00:03:17,519
a sec and then I opened his garage and

68
00:03:17,519 --> 00:03:20,099
he's like how do you do this stuff

69
00:03:20,099 --> 00:03:23,640
and I said it's API Security man

70
00:03:23,640 --> 00:03:26,940
uh last year I had a groundhog eating my

71
00:03:26,940 --> 00:03:28,620
cucumbers while I had something eating

72
00:03:28,620 --> 00:03:30,840
my cucumbers I had no idea what it was

73
00:03:30,840 --> 00:03:32,879
uh and so I bought one of those little

74
00:03:32,879 --> 00:03:34,800
security cameras you know you hook it to

75
00:03:34,800 --> 00:03:36,180
the Wi-Fi and plug it into walls like

76
00:03:36,180 --> 00:03:39,959
baby monitor and uh signed up for the

77
00:03:39,959 --> 00:03:43,920
account I found the apis I ended up in a

78
00:03:43,920 --> 00:03:45,599
responsible disclosure with them on a

79
00:03:45,599 --> 00:03:47,400
flaw that I found that I promised I

80
00:03:47,400 --> 00:03:49,379
wouldn't talk about but I will say this

81
00:03:49,379 --> 00:03:53,640
if your error message says bad password

82
00:03:53,640 --> 00:03:56,940
it's way easier to enumerate good

83
00:03:56,940 --> 00:03:59,720
passwords

84
00:04:01,440 --> 00:04:02,640
I've written a couple of different

85
00:04:02,640 --> 00:04:04,379
appsec tools

86
00:04:04,379 --> 00:04:06,000
probably the one that you might have

87
00:04:06,000 --> 00:04:09,000
used as I T I taught an OAS class last

88
00:04:09,000 --> 00:04:11,580
summer on how to take apart APK files

89
00:04:11,580 --> 00:04:14,580
pull apis out of them and then go attack

90
00:04:14,580 --> 00:04:16,978
them right I'm extending that a little

91
00:04:16,978 --> 00:04:18,600
bit with you don't have to do that

92
00:04:18,600 --> 00:04:20,279
because I found their Swagger files and

93
00:04:20,279 --> 00:04:21,839
we can just have them tell us where the

94
00:04:21,839 --> 00:04:23,160
endpoints are

95
00:04:23,160 --> 00:04:26,040
I do things with o wasp and Issa and all

96
00:04:26,040 --> 00:04:27,300
of that

97
00:04:27,300 --> 00:04:29,759
why are we talking about this people get

98
00:04:29,759 --> 00:04:31,740
breached

99
00:04:31,740 --> 00:04:34,680
anybody hear about the Peloton reach do

100
00:04:34,680 --> 00:04:37,139
you guys hear about it a few people did

101
00:04:37,139 --> 00:04:38,880
when the researcher found the the

102
00:04:38,880 --> 00:04:41,880
problem at Peloton he contacted Peloton

103
00:04:41,880 --> 00:04:44,280
and said I found a problem and they said

104
00:04:44,280 --> 00:04:45,840
so

105
00:04:45,840 --> 00:04:48,900
and so he contacted a reporter and said

106
00:04:48,900 --> 00:04:53,060
I found your information on Peloton

107
00:04:53,240 --> 00:04:55,620
And the reporter said I would love to do

108
00:04:55,620 --> 00:04:58,320
a story about that

109
00:04:58,320 --> 00:05:00,600
and that's an example of you don't get

110
00:05:00,600 --> 00:05:02,160
to control the narrative at some point

111
00:05:02,160 --> 00:05:04,919
right uh Brew dog you could get

112
00:05:04,919 --> 00:05:07,680
basically unlimited coupons right you

113
00:05:07,680 --> 00:05:09,300
could just enumerate through people's

114
00:05:09,300 --> 00:05:11,100
accounts find people that had coupons

115
00:05:11,100 --> 00:05:12,960
and print the coupons out just walk into

116
00:05:12,960 --> 00:05:15,000
brewdog and get free beer

117
00:05:15,000 --> 00:05:16,440
uh

118
00:05:16,440 --> 00:05:18,979
free as in beer

119
00:05:18,979 --> 00:05:22,800
smart door locks uh very much in the

120
00:05:22,800 --> 00:05:24,840
same vein of my attack on the

121
00:05:24,840 --> 00:05:27,600
Chamberlain garage door API uh this guy

122
00:05:27,600 --> 00:05:29,699
found that you know those smart door

123
00:05:29,699 --> 00:05:31,380
locks the ones that they say Hey you can

124
00:05:31,380 --> 00:05:34,500
just let your UPS guy right in uh when

125
00:05:34,500 --> 00:05:36,960
you do that you can horizontally

126
00:05:36,960 --> 00:05:39,000
privilege escalate and become admin add

127
00:05:39,000 --> 00:05:41,220
all the accounts you want and anybody

128
00:05:41,220 --> 00:05:44,580
can get in right uh so and this is all

129
00:05:44,580 --> 00:05:46,800
happening on the API surface this is all

130
00:05:46,800 --> 00:05:48,120
applications that are out there that

131
00:05:48,120 --> 00:05:51,120
have problems look at Experian clubhouse

132
00:05:51,120 --> 00:05:54,120
right it just goes on and on John Deere

133
00:05:54,120 --> 00:05:57,419
had multiple problems right their apis

134
00:05:57,419 --> 00:06:00,120
were easily accessed but also they

135
00:06:00,120 --> 00:06:01,860
decided hey do you know where you can

136
00:06:01,860 --> 00:06:03,900
get a copy of a database that looks like

137
00:06:03,900 --> 00:06:05,940
our production database

138
00:06:05,940 --> 00:06:09,479
in production you just copy it right uh

139
00:06:09,479 --> 00:06:11,280
and the devs were on there and they're

140
00:06:11,280 --> 00:06:13,199
like we see all the tractor owners and

141
00:06:13,199 --> 00:06:14,820
everything

142
00:06:14,820 --> 00:06:16,680
all right so how did we end up here

143
00:06:16,680 --> 00:06:18,360
right

144
00:06:18,360 --> 00:06:19,320
um

145
00:06:19,320 --> 00:06:21,720
API security somebody asked me about

146
00:06:21,720 --> 00:06:23,520
this the other day and I said remember

147
00:06:23,520 --> 00:06:27,180
in 2013 when suddenly web security was a

148
00:06:27,180 --> 00:06:28,740
thing and people were just getting owned

149
00:06:28,740 --> 00:06:30,240
left and right

150
00:06:30,240 --> 00:06:33,060
API security is about at that age right

151
00:06:33,060 --> 00:06:35,460
we're right about there

152
00:06:35,460 --> 00:06:37,800
um and it's not for us

153
00:06:37,800 --> 00:06:41,520
trying right we've been trying we have

154
00:06:41,520 --> 00:06:43,919
code reviews and we've got all of these

155
00:06:43,919 --> 00:06:45,840
different things that are in this stack

156
00:06:45,840 --> 00:06:48,720
of security right we started with code

157
00:06:48,720 --> 00:06:50,520
reviews then we started doing code

158
00:06:50,520 --> 00:06:52,680
reviews automatically right using

159
00:06:52,680 --> 00:06:54,600
something like a static analysis tool

160
00:06:54,600 --> 00:06:56,940
and from there then we moved into well

161
00:06:56,940 --> 00:06:58,860
we need to hit it on the dynamic side

162
00:06:58,860 --> 00:07:00,960
though we need to actually hit the stood

163
00:07:00,960 --> 00:07:03,180
up site we'll pen test it right so we

164
00:07:03,180 --> 00:07:05,100
move to that kind of thing and people

165
00:07:05,100 --> 00:07:07,080
still do all this stuff we get some

166
00:07:07,080 --> 00:07:08,759
Dynamic analysis out there though in

167
00:07:08,759 --> 00:07:11,100
apis it's a little less

168
00:07:11,100 --> 00:07:14,400
uh simple to do Dynamic analysis because

169
00:07:14,400 --> 00:07:16,620
you don't know where the next API

170
00:07:16,620 --> 00:07:19,560
endpoint is Right unless you can tell it

171
00:07:19,560 --> 00:07:22,979
somehow with the Swagger file and so I

172
00:07:22,979 --> 00:07:24,300
spend a bunch of time telling people

173
00:07:24,300 --> 00:07:27,479
generate Swagger files you need to do

174
00:07:27,479 --> 00:07:29,220
this so that you can feed your security

175
00:07:29,220 --> 00:07:32,520
tools and then I forgot to tell

176
00:07:32,520 --> 00:07:36,979
everybody but don't make them publish

177
00:07:37,199 --> 00:07:40,020
there you go so we started into that and

178
00:07:40,020 --> 00:07:42,060
now we've got you know people saying

179
00:07:42,060 --> 00:07:45,840
that we got to go left right uh NASCAR

180
00:07:45,840 --> 00:07:48,740
likes to go left

181
00:07:48,740 --> 00:07:51,180
I think it's the devsecup yeah we're

182
00:07:51,180 --> 00:07:54,300
moving the SEC left I guess something we

183
00:07:54,300 --> 00:07:56,340
have all of these ideas for security

184
00:07:56,340 --> 00:07:58,680
right and yet we still end up with all

185
00:07:58,680 --> 00:08:00,419
these these problems and there's a

186
00:08:00,419 --> 00:08:02,280
reason why

187
00:08:02,280 --> 00:08:03,900
scanners

188
00:08:03,900 --> 00:08:06,720
Dynamic scanners when they scan a

189
00:08:06,720 --> 00:08:09,180
website they follow the hrefs right

190
00:08:09,180 --> 00:08:10,680
humans need to be able to click the next

191
00:08:10,680 --> 00:08:12,479
link so the scanner goes and looks for

192
00:08:12,479 --> 00:08:15,180
the next link so it can click it

193
00:08:15,180 --> 00:08:17,280
we don't have site maps for apis unless

194
00:08:17,280 --> 00:08:20,000
they're in your Swagger file right

195
00:08:20,000 --> 00:08:22,440
or something like that you've got to

196
00:08:22,440 --> 00:08:24,960
have something to tell us where all the

197
00:08:24,960 --> 00:08:27,900
API endpoints are it's possible that you

198
00:08:27,900 --> 00:08:29,699
could do this through an automated tool

199
00:08:29,699 --> 00:08:31,800
grabbing an APK for your mobile app

200
00:08:31,800 --> 00:08:33,958
decomposing it pulling out all of the

201
00:08:33,958 --> 00:08:36,779
anything with a slash right and and do

202
00:08:36,779 --> 00:08:39,140
that it's possible

203
00:08:39,140 --> 00:08:42,120
less likely though

204
00:08:42,120 --> 00:08:42,719
um

205
00:08:42,719 --> 00:08:44,399
I don't know if it was Matt's Hawk

206
00:08:44,399 --> 00:08:45,920
yesterday or somebody's talk yesterday

207
00:08:45,920 --> 00:08:49,080
talked about uh no it wasn't mad it was

208
00:08:49,080 --> 00:08:51,480
another guy but he talked about just do

209
00:08:51,480 --> 00:08:54,420
the Deltas right look at your APK files

210
00:08:54,420 --> 00:08:55,740
for your mobile app from the last

211
00:08:55,740 --> 00:08:58,080
version and this version and Pen test

212
00:08:58,080 --> 00:09:00,600
the Delta scan the Deltas that makes the

213
00:09:00,600 --> 00:09:02,580
list a lot smaller

214
00:09:02,580 --> 00:09:04,080
but we have to be able to teach the

215
00:09:04,080 --> 00:09:06,660
endpoints somehow we can do this

216
00:09:06,660 --> 00:09:08,519
automatically if we're in line right

217
00:09:08,519 --> 00:09:11,220
nginx logs are nice they can give us all

218
00:09:11,220 --> 00:09:13,500
the endpoints people are going to so

219
00:09:13,500 --> 00:09:15,660
that's a really nice Dynamic way to kind

220
00:09:15,660 --> 00:09:17,700
of figure this out but we don't have

221
00:09:17,700 --> 00:09:19,380
really good ways to do this and this is

222
00:09:19,380 --> 00:09:22,440
the challenge that we have right so

223
00:09:22,440 --> 00:09:25,440
if you have an API you're probably going

224
00:09:25,440 --> 00:09:27,660
to have tools touching it and you're

225
00:09:27,660 --> 00:09:29,220
probably going to have humans touching

226
00:09:29,220 --> 00:09:32,339
it in some way right so both tools and

227
00:09:32,339 --> 00:09:34,019
humans need a map they got to be able to

228
00:09:34,019 --> 00:09:35,279
figure out how to get to these things

229
00:09:35,279 --> 00:09:39,240
tools a little easier uh Maps aren't

230
00:09:39,240 --> 00:09:41,279
so what kind of documents

231
00:09:41,279 --> 00:09:45,060
are created right four apis now think

232
00:09:45,060 --> 00:09:47,339
about this when you're documenting an

233
00:09:47,339 --> 00:09:49,680
API you're going to publish this to

234
00:09:49,680 --> 00:09:51,660
someone or something

235
00:09:51,660 --> 00:09:54,839
the idea is if you want users to come

236
00:09:54,839 --> 00:09:56,700
use your API if that's what you're in

237
00:09:56,700 --> 00:09:58,740
the business of you have to produce

238
00:09:58,740 --> 00:10:00,959
documentation that's going to explain to

239
00:10:00,959 --> 00:10:02,580
them how to use it a lot of people do

240
00:10:02,580 --> 00:10:05,279
things like curl and python examples you

241
00:10:05,279 --> 00:10:07,140
know in a little web page nice and easy

242
00:10:07,140 --> 00:10:09,959
documented and that makes it all simple

243
00:10:09,959 --> 00:10:12,899
great then I know how to make proper

244
00:10:12,899 --> 00:10:15,420
calls which is a huge part of trying to

245
00:10:15,420 --> 00:10:17,279
figure out how to Recon an API is

246
00:10:17,279 --> 00:10:19,560
figuring out how do I authenticate and

247
00:10:19,560 --> 00:10:22,260
use the thing right but I also need to

248
00:10:22,260 --> 00:10:25,080
know where are all the endpoints

249
00:10:25,080 --> 00:10:27,180
so there are different kinds of API

250
00:10:27,180 --> 00:10:30,000
documentation that are out there API

251
00:10:30,000 --> 00:10:32,940
docs are usually consumed by either

252
00:10:32,940 --> 00:10:36,660
humans or developers that are in line

253
00:10:36,660 --> 00:10:38,459
with whatever this product that they're

254
00:10:38,459 --> 00:10:40,620
trying to extend right

255
00:10:40,620 --> 00:10:42,660
um typically there's a lot of getting

256
00:10:42,660 --> 00:10:45,060
started kind of things in here but most

257
00:10:45,060 --> 00:10:46,440
importantly there's syntactically

258
00:10:46,440 --> 00:10:49,260
correct calls right so you can see the

259
00:10:49,260 --> 00:10:51,000
methods and the calls that you can do to

260
00:10:51,000 --> 00:10:52,740
get there

261
00:10:52,740 --> 00:10:54,240
this though

262
00:10:54,240 --> 00:10:56,820
has a little bit of effort that goes

263
00:10:56,820 --> 00:10:58,260
with it right somebody's got to actively

264
00:10:58,260 --> 00:11:00,959
maintain these things uh in order for it

265
00:11:00,959 --> 00:11:02,220
to work

266
00:11:02,220 --> 00:11:04,980
API definitions

267
00:11:04,980 --> 00:11:10,140
um like uh Swagger and things like that

268
00:11:10,140 --> 00:11:13,860
um you create these to tune something

269
00:11:13,860 --> 00:11:16,980
else right most of you probably not even

270
00:11:16,980 --> 00:11:19,260
heard of this before right anybody here

271
00:11:19,260 --> 00:11:23,220
of an API definition right okay so if

272
00:11:23,220 --> 00:11:25,800
you're creating a apogee API Gateway and

273
00:11:25,800 --> 00:11:27,360
you want to tell that Gateway what your

274
00:11:27,360 --> 00:11:29,100
endpoints look like you use an API

275
00:11:29,100 --> 00:11:31,140
definition right so this is an automatic

276
00:11:31,140 --> 00:11:34,500
way to tune some piece of Machinery

277
00:11:34,500 --> 00:11:37,880
that's running in your environment

278
00:11:37,920 --> 00:11:41,519
and then you have an API spec

279
00:11:41,519 --> 00:11:43,500
we called these Swagger files for a

280
00:11:43,500 --> 00:11:46,200
while uh now it's called open API not

281
00:11:46,200 --> 00:11:48,480
Swagger but

282
00:11:48,480 --> 00:11:51,180
all of that terminology Swagger and open

283
00:11:51,180 --> 00:11:53,220
API is completely interchangeable it all

284
00:11:53,220 --> 00:11:55,680
still exists in the same places right

285
00:11:55,680 --> 00:11:57,660
um so you can still refer to things as a

286
00:11:57,660 --> 00:12:00,180
Swagger file pretty easily but it

287
00:12:00,180 --> 00:12:02,180
explains how the API is going to behave

288
00:12:02,180 --> 00:12:04,320
identifies the objects that are there

289
00:12:04,320 --> 00:12:06,420
how to call those objects or how to

290
00:12:06,420 --> 00:12:09,420
delete those objects or whatever and if

291
00:12:09,420 --> 00:12:11,040
you can consume this in your dash

292
00:12:11,040 --> 00:12:13,800
scanner it will tell it where to go

293
00:12:13,800 --> 00:12:16,380
which is nice if you have a good Dash

294
00:12:16,380 --> 00:12:18,899
scanner but it depends

295
00:12:18,899 --> 00:12:21,120
so

296
00:12:21,120 --> 00:12:24,300
what do we do to protect ourselves from

297
00:12:24,300 --> 00:12:25,740
this well

298
00:12:25,740 --> 00:12:30,120
I found a public Swagger file right I

299
00:12:30,120 --> 00:12:31,620
showed it to you before we started you

300
00:12:31,620 --> 00:12:33,180
remember that it was back that a few

301
00:12:33,180 --> 00:12:34,860
minutes ago

302
00:12:34,860 --> 00:12:36,779
just seeing if you're there uh so I put

303
00:12:36,779 --> 00:12:38,459
the Swagger file up on the screen while

304
00:12:38,459 --> 00:12:40,260
I found a public API I found some

305
00:12:40,260 --> 00:12:41,760
documentation on the heck I found the

306
00:12:41,760 --> 00:12:44,339
spec next thing to do is to start poking

307
00:12:44,339 --> 00:12:46,980
at this thing right now I don't have

308
00:12:46,980 --> 00:12:49,320
permission to go poking on BMW's website

309
00:12:49,320 --> 00:12:52,860
I just happen to find that so I'm

310
00:12:52,860 --> 00:12:54,600
probably not going to go poking around

311
00:12:54,600 --> 00:12:56,120
on their website

312
00:12:56,120 --> 00:12:58,700
but I'll give you examples

313
00:12:58,700 --> 00:13:01,500
but I'll give you examples of

314
00:13:01,500 --> 00:13:03,600
how you could go about finding these

315
00:13:03,600 --> 00:13:05,000
things right

316
00:13:05,000 --> 00:13:08,399
apis Guru programmable web or old sites

317
00:13:08,399 --> 00:13:10,500
that have a lot of these things listed

318
00:13:10,500 --> 00:13:11,880
out on them

319
00:13:11,880 --> 00:13:12,899
um

320
00:13:12,899 --> 00:13:14,579
but you can also use things like a

321
00:13:14,579 --> 00:13:16,620
reverse proxy to see what is it that's

322
00:13:16,620 --> 00:13:18,300
going on in the background when I'm

323
00:13:18,300 --> 00:13:19,980
trying to call stuff to figure out where

324
00:13:19,980 --> 00:13:22,079
the API endpoints are

325
00:13:22,079 --> 00:13:25,019
Partners if the Target that you have

326
00:13:25,019 --> 00:13:26,940
partners with somebody that's going to

327
00:13:26,940 --> 00:13:29,220
be sharing their data I'd be willing to

328
00:13:29,220 --> 00:13:30,660
bet there's a partner portal somewhere

329
00:13:30,660 --> 00:13:32,779
with API documentation

330
00:13:32,779 --> 00:13:37,200
so go look for that DNS searches if you

331
00:13:37,200 --> 00:13:41,399
look me up on OAS training Pages you'll

332
00:13:41,399 --> 00:13:44,000
find my list of tools that that I have

333
00:13:44,000 --> 00:13:47,279
to do APK mining basically you're going

334
00:13:47,279 --> 00:13:50,760
to go to a website poll APK down and

335
00:13:50,760 --> 00:13:53,040
then it's going to rip it apart and run

336
00:13:53,040 --> 00:13:55,740
you'll run a big grep on it that'll dump

337
00:13:55,740 --> 00:13:59,279
out all of the API endpoints

338
00:13:59,279 --> 00:14:01,260
pretty nice way to do it

339
00:14:01,260 --> 00:14:03,000
and then there's a site out there called

340
00:14:03,000 --> 00:14:04,980
cracking and I mentioned cracking

341
00:14:04,980 --> 00:14:08,700
specifically but there are lots of sites

342
00:14:08,700 --> 00:14:10,320
like this

343
00:14:10,320 --> 00:14:11,579
um

344
00:14:11,579 --> 00:14:13,200
which one is it anybody here work for

345
00:14:13,200 --> 00:14:14,540
Domino's Pizza

346
00:14:14,540 --> 00:14:16,800
no all right

347
00:14:16,800 --> 00:14:18,360
so because that's the example I'm giving

348
00:14:18,360 --> 00:14:21,540
up here cracking is a site that shows

349
00:14:21,540 --> 00:14:23,700
you how to automatically attack an API

350
00:14:23,700 --> 00:14:25,860
so if you have a specific Target and

351
00:14:25,860 --> 00:14:27,660
somebody's already generated an attack

352
00:14:27,660 --> 00:14:31,860
for them right free pizzas then you go

353
00:14:31,860 --> 00:14:34,019
down to cracking and you download What's

354
00:14:34,019 --> 00:14:37,200
called a config file for a tool like

355
00:14:37,200 --> 00:14:40,740
Sentry MBA or open bullet or one of

356
00:14:40,740 --> 00:14:42,959
these framework attack tools this is

357
00:14:42,959 --> 00:14:44,639
you're downloading the config to make

358
00:14:44,639 --> 00:14:47,339
that framework work so

359
00:14:47,339 --> 00:14:50,699
I bring this up as a cautionary tale for

360
00:14:50,699 --> 00:14:52,199
everyone

361
00:14:52,199 --> 00:14:56,040
to say if you are on this website you're

362
00:14:56,040 --> 00:14:57,839
already under attack and everyone's

363
00:14:57,839 --> 00:15:00,720
figured everything out right so you

364
00:15:00,720 --> 00:15:02,100
definitely have a security incident

365
00:15:02,100 --> 00:15:04,500
going on and you need to go address it

366
00:15:04,500 --> 00:15:08,579
or lose the money either way right but

367
00:15:08,579 --> 00:15:10,260
if you've made it onto this page

368
00:15:10,260 --> 00:15:13,260
somebody's already figured you out

369
00:15:13,260 --> 00:15:16,199
it's a nice little Canary right to

370
00:15:16,199 --> 00:15:19,079
figure out if they've got you

371
00:15:19,079 --> 00:15:23,399
so we find a public API

372
00:15:23,399 --> 00:15:25,139
and then we check to see if it has a

373
00:15:25,139 --> 00:15:28,079
spec and you saw I found a public API

374
00:15:28,079 --> 00:15:31,800
and I put in a really hackeresque

375
00:15:31,800 --> 00:15:36,060
command into the URL bar right I had to

376
00:15:36,060 --> 00:15:37,680
pull the hood up you saw me pull my

377
00:15:37,680 --> 00:15:39,180
black hoodie out and pull the hood up

378
00:15:39,180 --> 00:15:42,720
right when I typed Swagger

379
00:15:42,720 --> 00:15:45,959
on there and got the Swagger file right

380
00:15:45,959 --> 00:15:47,399
so

381
00:15:47,399 --> 00:15:50,760
it's really difficult and repetitive to

382
00:15:50,760 --> 00:15:53,399
do this manually a lot not a lot of

383
00:15:53,399 --> 00:15:54,720
people are going to want to do this

384
00:15:54,720 --> 00:15:56,160
right they're not going to want to sit

385
00:15:56,160 --> 00:15:58,139
down and all right let's see if I can

386
00:15:58,139 --> 00:16:00,180
find it is it under API docs you know

387
00:16:00,180 --> 00:16:01,860
which version of open API are you

388
00:16:01,860 --> 00:16:03,180
running because that's going to tell me

389
00:16:03,180 --> 00:16:05,399
where your Swagger files are because

390
00:16:05,399 --> 00:16:08,279
they're sitting on that server or do I

391
00:16:08,279 --> 00:16:09,839
have to go digging into more things

392
00:16:09,839 --> 00:16:14,279
right do I have to go find bigger word

393
00:16:14,279 --> 00:16:16,079
lists in order to to get through this

394
00:16:16,079 --> 00:16:18,360
thing so I'm going to pause for a few

395
00:16:18,360 --> 00:16:20,699
minutes and I'm going to talk about Kite

396
00:16:20,699 --> 00:16:22,199
Runner and Matt brought this up

397
00:16:22,199 --> 00:16:24,779
yesterday when he was talking about this

398
00:16:24,779 --> 00:16:28,740
so these guys in Australia uh came up

399
00:16:28,740 --> 00:16:31,199
with this idea that well maybe we could

400
00:16:31,199 --> 00:16:34,680
just find endpoints by guessing right

401
00:16:34,680 --> 00:16:37,139
it's like inference scanning

402
00:16:37,139 --> 00:16:40,139
um and so what Kite Runner does is it

403
00:16:40,139 --> 00:16:42,540
has this massive word list

404
00:16:42,540 --> 00:16:45,360
and just like me typing slash Swagger

405
00:16:45,360 --> 00:16:49,079
it's going to try that right uh and 1400

406
00:16:49,079 --> 00:16:51,959
others right so it's basically all of

407
00:16:51,959 --> 00:16:53,540
the different kinds of implementations

408
00:16:53,540 --> 00:16:56,579
of default behaviors that are out there

409
00:16:56,579 --> 00:16:58,680
they've got this programmed into a

410
00:16:58,680 --> 00:17:00,180
scanner

411
00:17:00,180 --> 00:17:03,140
and realistically

412
00:17:03,140 --> 00:17:05,819
the scanning solution itself is quite

413
00:17:05,819 --> 00:17:08,520
simplistic the thing that you want out

414
00:17:08,520 --> 00:17:11,459
of this is their word lists right the

415
00:17:11,459 --> 00:17:13,260
the directories that they're going after

416
00:17:13,260 --> 00:17:15,419
and all of that kind of stuff

417
00:17:15,419 --> 00:17:17,640
um and those word lists are you know

418
00:17:17,640 --> 00:17:19,919
incredibly valuable when you start to

419
00:17:19,919 --> 00:17:21,000
look at them

420
00:17:21,000 --> 00:17:23,280
but what I would challenge you to do if

421
00:17:23,280 --> 00:17:25,199
you feel like learning something and I

422
00:17:25,199 --> 00:17:28,860
did when I did this uh is I went out and

423
00:17:28,860 --> 00:17:31,620
and ran bigquery against GitHub this is

424
00:17:31,620 --> 00:17:33,480
how they did it so follow their blog

425
00:17:33,480 --> 00:17:36,120
post right go run bigquery against

426
00:17:36,120 --> 00:17:38,400
GitHub and look at all of the different

427
00:17:38,400 --> 00:17:40,440
kinds of spec files that are sitting

428
00:17:40,440 --> 00:17:43,799
there right there's huge numbers of them

429
00:17:43,799 --> 00:17:46,320
so it dumps these big word lists out and

430
00:17:46,320 --> 00:17:49,080
then you can use them to go attack the

431
00:17:49,080 --> 00:17:52,200
Target right so one of the things that

432
00:17:52,200 --> 00:17:53,940
I've been you know sort of playing with

433
00:17:53,940 --> 00:17:56,400
a lot lately

434
00:17:56,400 --> 00:17:58,260
is graphql

435
00:17:58,260 --> 00:18:00,179
right so we're a little off Swagger

436
00:18:00,179 --> 00:18:01,559
files but we're going to be talking

437
00:18:01,559 --> 00:18:05,160
about something just as worse

438
00:18:05,160 --> 00:18:07,980
um so how many of you guys use graphql

439
00:18:07,980 --> 00:18:09,539
in your environment

440
00:18:09,539 --> 00:18:11,660
how many of you know what graphql is

441
00:18:11,660 --> 00:18:15,480
okay so that's about half the room a

442
00:18:15,480 --> 00:18:17,760
couple people have it at work

443
00:18:17,760 --> 00:18:19,980
here's a funny thing

444
00:18:19,980 --> 00:18:23,100
a lot of the stuff that you install to

445
00:18:23,100 --> 00:18:25,559
make your devops environments work also

446
00:18:25,559 --> 00:18:28,799
have graphql endpoints so that you can

447
00:18:28,799 --> 00:18:31,980
go query and pull data out of them

448
00:18:31,980 --> 00:18:35,280
so here's a fairly interesting example

449
00:18:35,280 --> 00:18:37,260
this is fly.io

450
00:18:37,260 --> 00:18:41,100
this is it's not on the screen because

451
00:18:41,100 --> 00:18:44,418
I left the PowerPoint running

452
00:18:49,980 --> 00:18:52,320
just give me a second

453
00:18:52,320 --> 00:18:55,440
all right this is fly.io

454
00:18:55,440 --> 00:18:58,140
so I use this as an example because I

455
00:18:58,140 --> 00:18:59,760
saw some YouTube video of a guy hacking

456
00:18:59,760 --> 00:19:02,100
graphql and and I was like wow they

457
00:19:02,100 --> 00:19:04,500
leave that on but this is a really great

458
00:19:04,500 --> 00:19:06,000
site because they're demonstrating

459
00:19:06,000 --> 00:19:08,940
graphql so it's not like you can do

460
00:19:08,940 --> 00:19:10,500
anything to them it's just a way for you

461
00:19:10,500 --> 00:19:12,299
to do like you know introspector queries

462
00:19:12,299 --> 00:19:15,120
and stuff like that so here we are flat

463
00:19:15,120 --> 00:19:17,940
fly.io so I think to myself well I

464
00:19:17,940 --> 00:19:18,960
wonder

465
00:19:18,960 --> 00:19:21,419
is there an API Dot

466
00:19:21,419 --> 00:19:23,460
subdomain

467
00:19:23,460 --> 00:19:26,760
and I get a 404.

468
00:19:26,760 --> 00:19:29,660
what do I know

469
00:19:30,600 --> 00:19:34,260
I know it exists and

470
00:19:34,260 --> 00:19:36,419
it has no slash right it doesn't have

471
00:19:36,419 --> 00:19:38,640
any default or index so I know it

472
00:19:38,640 --> 00:19:40,860
probably is an API right like because

473
00:19:40,860 --> 00:19:42,600
it's not giving me anything else no

474
00:19:42,600 --> 00:19:44,460
favic on no like nothing's coming right

475
00:19:44,460 --> 00:19:47,340
all right so if I think this is an API

476
00:19:47,340 --> 00:19:51,179
then I can start doing queries right

477
00:19:51,179 --> 00:19:53,400
by just typing things into the URL bar

478
00:19:53,400 --> 00:19:55,799
to see am I going to get anything back

479
00:19:55,799 --> 00:19:57,120
off of this

480
00:19:57,120 --> 00:19:59,520
so those of you that are familiar with

481
00:19:59,520 --> 00:20:01,500
graphql may be familiar with a concept

482
00:20:01,500 --> 00:20:04,140
called The graphql Playground right this

483
00:20:04,140 --> 00:20:06,240
is sort of the user interface to create

484
00:20:06,240 --> 00:20:07,679
queries that you're going to probably

485
00:20:07,679 --> 00:20:10,140
programmatically make later but this is

486
00:20:10,140 --> 00:20:12,120
sort of your burp Suite into the graphql

487
00:20:12,120 --> 00:20:14,280
right I can do a bunch of stuff with

488
00:20:14,280 --> 00:20:16,980
this and that's a really great idea

489
00:20:16,980 --> 00:20:19,980
except what's wrong

490
00:20:19,980 --> 00:20:21,539
is public

491
00:20:21,539 --> 00:20:22,860
right

492
00:20:22,860 --> 00:20:24,720
does anyone know how authentication

493
00:20:24,720 --> 00:20:26,640
Works off of this

494
00:20:26,640 --> 00:20:29,460
your admin

495
00:20:29,460 --> 00:20:31,440
if you can get the playground you're the

496
00:20:31,440 --> 00:20:33,660
admin

497
00:20:33,660 --> 00:20:35,520
so if you hang your playground out in

498
00:20:35,520 --> 00:20:36,480
the public

499
00:20:36,480 --> 00:20:38,299
the administrators are the public now

500
00:20:38,299 --> 00:20:41,400
right and you get some of that uh what

501
00:20:41,400 --> 00:20:43,640
is that free pen testing

502
00:20:43,640 --> 00:20:47,720
where you don't get the reports

503
00:20:47,770 --> 00:20:49,440
[Laughter]

504
00:20:49,440 --> 00:20:51,539
all right so here's another one right so

505
00:20:51,539 --> 00:20:53,640
I'm going to uh I don't know some place

506
00:20:53,640 --> 00:20:58,919
I found uh Slash graphql and I get this

507
00:20:58,919 --> 00:21:00,720
what happened

508
00:21:00,720 --> 00:21:03,440
anybody

509
00:21:03,900 --> 00:21:06,360
well I sent it a get

510
00:21:06,360 --> 00:21:08,340
and it's telling me my query string is

511
00:21:08,340 --> 00:21:10,919
missing right you you forgot your query

512
00:21:10,919 --> 00:21:13,380
string in this git I didn't even intend

513
00:21:13,380 --> 00:21:15,059
to do it yet I just wanted to see if it

514
00:21:15,059 --> 00:21:16,980
was answer all right fine

515
00:21:16,980 --> 00:21:19,380
so what am I going to do well

516
00:21:19,380 --> 00:21:21,419
I have a git query string that I keep in

517
00:21:21,419 --> 00:21:24,380
a text file here

518
00:21:24,419 --> 00:21:25,919
now what do I what do I have to do

519
00:21:25,919 --> 00:21:27,600
everybody what do I have to do if I want

520
00:21:27,600 --> 00:21:30,659
to throw a query string in this

521
00:21:30,659 --> 00:21:32,159
question mark

522
00:21:32,159 --> 00:21:34,679
so maybe I'll do a slash question mark

523
00:21:34,679 --> 00:21:37,140
and then that does that look like a lot

524
00:21:37,140 --> 00:21:38,520
it's not

525
00:21:38,520 --> 00:21:40,080
and then I hit enter

526
00:21:40,080 --> 00:21:43,679
and I get the schema for the database

527
00:21:43,679 --> 00:21:45,720
right so

528
00:21:45,720 --> 00:21:48,000
the playground is dangerous

529
00:21:48,000 --> 00:21:50,840
but misconfiguring graphql is dangerous

530
00:21:50,840 --> 00:21:53,940
right I can now do a get query against

531
00:21:53,940 --> 00:21:56,760
this is an introspection query so this

532
00:21:56,760 --> 00:21:58,620
is every possible thing that's available

533
00:21:58,620 --> 00:22:00,360
in the database right it's the whole

534
00:22:00,360 --> 00:22:02,700
schema of the database

535
00:22:02,700 --> 00:22:04,799
um that is one of those things that

536
00:22:04,799 --> 00:22:06,720
should make you go

537
00:22:06,720 --> 00:22:10,440
I wonder if we have graphql right um and

538
00:22:10,440 --> 00:22:14,100
and run out of the room and go see uh

539
00:22:14,100 --> 00:22:16,559
but you know maybe maybe a little late

540
00:22:16,559 --> 00:22:18,360
all right so let's

541
00:22:18,360 --> 00:22:22,399
get back to the deck where am I at

542
00:22:23,520 --> 00:22:26,760
so Kite Runner uh one of their word list

543
00:22:26,760 --> 00:22:29,100
sections is how to find those graphql

544
00:22:29,100 --> 00:22:31,320
endpoints because it's not always just

545
00:22:31,320 --> 00:22:33,900
slash graphql right obviously I have

546
00:22:33,900 --> 00:22:36,000
staged these things to give this talk

547
00:22:36,000 --> 00:22:39,059
and hope they work uh and try to make

548
00:22:39,059 --> 00:22:40,559
them as simple as possible so that it

549
00:22:40,559 --> 00:22:42,059
wouldn't fail

550
00:22:42,059 --> 00:22:45,059
um obviously right but when you look at

551
00:22:45,059 --> 00:22:46,679
the word lists that Kite Runner

552
00:22:46,679 --> 00:22:49,260
generates to look at how you can go pull

553
00:22:49,260 --> 00:22:51,780
endpoints like that and if you go look

554
00:22:51,780 --> 00:22:53,940
around on the internet for how to pull

555
00:22:53,940 --> 00:22:56,280
introspection endpoints

556
00:22:56,280 --> 00:22:58,260
um you can generate a word list that

557
00:22:58,260 --> 00:23:00,440
will find you every graphql playground

558
00:23:00,440 --> 00:23:04,740
in like 35 or 40 words it's not a huge

559
00:23:04,740 --> 00:23:07,080
list right because there's not a lot of

560
00:23:07,080 --> 00:23:08,880
people that are making it right so

561
00:23:08,880 --> 00:23:12,059
there's only a few places but some of

562
00:23:12,059 --> 00:23:13,620
them are interesting right like the

563
00:23:13,620 --> 00:23:16,380
first one that's in my list is Altair

564
00:23:16,380 --> 00:23:19,200
right slash Altair if you're running on

565
00:23:19,200 --> 00:23:21,299
specific platforms that's the graphql

566
00:23:21,299 --> 00:23:24,059
playground you know launch

567
00:23:24,059 --> 00:23:25,500
all right

568
00:23:25,500 --> 00:23:28,559
so how do you not become a Target

569
00:23:28,559 --> 00:23:30,960
is a good question right because I've

570
00:23:30,960 --> 00:23:33,780
showed you that using just like DNS

571
00:23:33,780 --> 00:23:36,419
queries and a few words I can hit

572
00:23:36,419 --> 00:23:38,340
endpoints that are going to be very

573
00:23:38,340 --> 00:23:40,700
interesting to me right

574
00:23:40,700 --> 00:23:44,419
so obvious endpoint names

575
00:23:44,419 --> 00:23:47,100
are one of those things that you know if

576
00:23:47,100 --> 00:23:48,740
your API is on

577
00:23:48,740 --> 00:23:52,080
api.yourdomain.com uh I know where it is

578
00:23:52,080 --> 00:23:54,659
right right

579
00:23:54,659 --> 00:23:58,020
so protect that endpoint be cognizant of

580
00:23:58,020 --> 00:23:59,820
it understand the routes that are on

581
00:23:59,820 --> 00:24:01,799
that endpoint understand what it does

582
00:24:01,799 --> 00:24:05,100
right and understand how to authenticate

583
00:24:05,100 --> 00:24:08,220
onto that endpoint and make sure uh that

584
00:24:08,220 --> 00:24:10,260
you're pushing that as much as you can

585
00:24:10,260 --> 00:24:12,419
but then start to look at stuff like

586
00:24:12,419 --> 00:24:16,860
this right slash graphql is an easy one

587
00:24:16,860 --> 00:24:18,960
um swagger.json

588
00:24:18,960 --> 00:24:21,980
health check

589
00:24:22,080 --> 00:24:24,000
there are a couple of health check

590
00:24:24,000 --> 00:24:25,860
services out there it's another one that

591
00:24:25,860 --> 00:24:26,940
I've been playing with quite a bit

592
00:24:26,940 --> 00:24:29,100
lately there are health check services

593
00:24:29,100 --> 00:24:31,500
that will send you a text file that says

594
00:24:31,500 --> 00:24:32,940
okay

595
00:24:32,940 --> 00:24:35,760
when you ask it are you online you get a

596
00:24:35,760 --> 00:24:38,640
text file back a text file

597
00:24:38,640 --> 00:24:41,340
if I ask it a billion times if it's

598
00:24:41,340 --> 00:24:43,140
online what do I get

599
00:24:43,140 --> 00:24:45,360
well I get a billion text files right

600
00:24:45,360 --> 00:24:49,020
this sounds like a Dos scenario to me if

601
00:24:49,020 --> 00:24:50,520
I'm making your server generate

602
00:24:50,520 --> 00:24:52,500
something and give it to me unless it's

603
00:24:52,500 --> 00:24:54,600
cash but you wouldn't cash a health

604
00:24:54,600 --> 00:24:55,980
check

605
00:24:55,980 --> 00:25:00,380
right I mean that would be stupid

606
00:25:00,539 --> 00:25:01,980
so

607
00:25:01,980 --> 00:25:03,960
what happens if I try to go to an end

608
00:25:03,960 --> 00:25:05,580
point that there's nothing there right

609
00:25:05,580 --> 00:25:07,799
like I just randomly type keyboard Smash

610
00:25:07,799 --> 00:25:10,919
in and hit enter right what I get off of

611
00:25:10,919 --> 00:25:14,880
that maybe it's on right and that keeps

612
00:25:14,880 --> 00:25:17,159
me there a little bit longer

613
00:25:17,159 --> 00:25:20,220
um what I really like to do for clients

614
00:25:20,220 --> 00:25:22,080
that we have that we that have this

615
00:25:22,080 --> 00:25:24,600
scenario in mind is I push Splats

616
00:25:24,600 --> 00:25:26,580
anything that that wouldn't fall into

617
00:25:26,580 --> 00:25:30,299
their category into a Honey Trap

618
00:25:30,299 --> 00:25:32,400
and then I play with them right so

619
00:25:32,400 --> 00:25:35,039
they'll get the administrative interface

620
00:25:35,039 --> 00:25:37,440
for WordPress and if they try to enter

621
00:25:37,440 --> 00:25:39,240
anything they get the administrative

622
00:25:39,240 --> 00:25:42,380
interface for Joomla

623
00:25:42,659 --> 00:25:44,279
and they just keeps sending CMS

624
00:25:44,279 --> 00:25:47,100
interfaces at them it's fun

625
00:25:47,100 --> 00:25:49,080
um and when you see somebody constantly

626
00:25:49,080 --> 00:25:51,120
keyboard smash on those you just know

627
00:25:51,120 --> 00:25:53,039
they're not doing anything productive

628
00:25:53,039 --> 00:25:56,520
right and it feels a little better

629
00:25:56,520 --> 00:25:57,419
um

630
00:25:57,419 --> 00:26:00,120
some of these targets you know obvious

631
00:26:00,120 --> 00:26:02,700
potential targets like your Swagger file

632
00:26:02,700 --> 00:26:04,440
you want to make sure that you protect

633
00:26:04,440 --> 00:26:06,779
that in some way and what I like to tell

634
00:26:06,779 --> 00:26:08,940
people is this is one of those things

635
00:26:08,940 --> 00:26:10,919
that should only be given to others

636
00:26:10,919 --> 00:26:13,940
under NDA

637
00:26:14,039 --> 00:26:16,260
take whatever controls you have for

638
00:26:16,260 --> 00:26:19,200
those types of items and apply it here

639
00:26:19,200 --> 00:26:21,120
right so if you normally would only

640
00:26:21,120 --> 00:26:23,100
share this under NDA don't host it

641
00:26:23,100 --> 00:26:26,340
publicly right take it down put it

642
00:26:26,340 --> 00:26:28,200
behind some kind of gate whatever that

643
00:26:28,200 --> 00:26:30,480
is right maybe I've got to log in to get

644
00:26:30,480 --> 00:26:32,700
to the thing but that just slows them

645
00:26:32,700 --> 00:26:35,460
down right you got to remember

646
00:26:35,460 --> 00:26:38,460
security is all about you have to be

647
00:26:38,460 --> 00:26:40,880
this tall to ride the ride

648
00:26:40,880 --> 00:26:43,020
but tomorrow you're going to need to be

649
00:26:43,020 --> 00:26:45,720
this tall right and to next day you got

650
00:26:45,720 --> 00:26:47,400
to be a little taller we need to improve

651
00:26:47,400 --> 00:26:49,620
all the time and these are the little

652
00:26:49,620 --> 00:26:52,140
improvements that remove a lot of your

653
00:26:52,140 --> 00:26:55,380
attack surface right so what we try to

654
00:26:55,380 --> 00:26:57,419
do is make sure that we know where

655
00:26:57,419 --> 00:27:00,480
everything is as kind of the first thing

656
00:27:00,480 --> 00:27:03,659
what we've noticed uh is there's a lot

657
00:27:03,659 --> 00:27:07,020
of organizations that are being attacked

658
00:27:07,020 --> 00:27:09,960
on endpoints that they're unaware of or

659
00:27:09,960 --> 00:27:11,520
thought they turned off

660
00:27:11,520 --> 00:27:15,299
right so if you think of a path in an

661
00:27:15,299 --> 00:27:18,539
API and it's like V1 like slash login

662
00:27:18,539 --> 00:27:21,179
right and then there's a V5 slash login

663
00:27:21,179 --> 00:27:23,940
and there's a V16 login well if you're

664
00:27:23,940 --> 00:27:26,100
sitting at V16 did you shut all those

665
00:27:26,100 --> 00:27:27,480
other ones off

666
00:27:27,480 --> 00:27:30,480
right and if you didn't uh you need to

667
00:27:30,480 --> 00:27:32,340
or you need to do something about it

668
00:27:32,340 --> 00:27:34,799
right because that's going to end up

669
00:27:34,799 --> 00:27:37,620
being something bad for you

670
00:27:37,620 --> 00:27:38,820
all right

671
00:27:38,820 --> 00:27:41,220
so you got your target what's gonna

672
00:27:41,220 --> 00:27:43,559
happen well

673
00:27:43,559 --> 00:27:45,419
I'm gonna have to have a bunch of things

674
00:27:45,419 --> 00:27:48,120
in order to attack you right

675
00:27:48,120 --> 00:27:50,100
um I have to have some kind of

676
00:27:50,100 --> 00:27:51,539
infrastructure

677
00:27:51,539 --> 00:27:53,340
I've got to have IP addresses to come

678
00:27:53,340 --> 00:27:54,980
from that aren't the one from my house

679
00:27:54,980 --> 00:27:59,580
right or off my phone or whatever

680
00:27:59,580 --> 00:28:03,320
where can I go get IP addresses

681
00:28:03,360 --> 00:28:05,120
anyone

682
00:28:05,120 --> 00:28:07,980
I could go on to an ec2 cluster that

683
00:28:07,980 --> 00:28:09,299
would be an easy way to do it I pay for

684
00:28:09,299 --> 00:28:11,640
it I'm there anybody else

685
00:28:11,640 --> 00:28:15,720
proxy Services man proxy Services you

686
00:28:15,720 --> 00:28:18,059
can buy proxy services and use IP

687
00:28:18,059 --> 00:28:21,360
addresses so in my world when we see a

688
00:28:21,360 --> 00:28:23,580
tax hit somebody they come in as a

689
00:28:23,580 --> 00:28:24,960
single request

690
00:28:24,960 --> 00:28:27,480
one request from that IP address one

691
00:28:27,480 --> 00:28:30,059
request but they're going to use 12

692
00:28:30,059 --> 00:28:32,520
million IP addresses I'm going to get 12

693
00:28:32,520 --> 00:28:34,860
million packets but it's all going to

694
00:28:34,860 --> 00:28:37,700
look like one request right so

695
00:28:37,700 --> 00:28:39,900
infrastructure is important to these

696
00:28:39,900 --> 00:28:42,360
guys right when they attacking you they

697
00:28:42,360 --> 00:28:44,460
have to have decent infrastructure but

698
00:28:44,460 --> 00:28:46,020
good infrastructure is expensive

699
00:28:46,020 --> 00:28:48,120
infrastructure if you go to uh

700
00:28:48,120 --> 00:28:51,120
Illuminati who's now called bright

701
00:28:51,120 --> 00:28:55,140
something they have really expensive

702
00:28:55,140 --> 00:28:57,240
infrastructure that you can rent

703
00:28:57,240 --> 00:28:59,279
and what it is

704
00:28:59,279 --> 00:29:01,620
how many of you guys have seen

705
00:29:01,620 --> 00:29:05,100
advertisements for VPN services that are

706
00:29:05,100 --> 00:29:07,340
free

707
00:29:08,940 --> 00:29:13,380
okay so if you read I and there's one

708
00:29:13,380 --> 00:29:16,500
out there called whole Ola h-o-l-a VPN

709
00:29:16,500 --> 00:29:18,480
if you read their terms and conditions

710
00:29:18,480 --> 00:29:20,340
it explicitly says in there that you are

711
00:29:20,340 --> 00:29:22,620
now a proxy endpoint in the bright

712
00:29:22,620 --> 00:29:25,100
Network

713
00:29:25,380 --> 00:29:29,100
they promise not to roll your phone over

714
00:29:29,100 --> 00:29:31,320
and they're very guarded about it like I

715
00:29:31,320 --> 00:29:32,940
went and ran an infrastructure from them

716
00:29:32,940 --> 00:29:35,039
and and set a website up and attacked

717
00:29:35,039 --> 00:29:36,480
myself through their infrastructure so I

718
00:29:36,480 --> 00:29:38,820
could see what their IP addresses were

719
00:29:38,820 --> 00:29:40,799
and they got really mad when I throttled

720
00:29:40,799 --> 00:29:42,960
it up real high and told me I had to

721
00:29:42,960 --> 00:29:44,940
stop and then they realized who I was

722
00:29:44,940 --> 00:29:46,380
and they were like you have to get off

723
00:29:46,380 --> 00:29:47,760
our Network

724
00:29:47,760 --> 00:29:48,419
um

725
00:29:48,419 --> 00:29:49,980
but it you know it didn't matter I got

726
00:29:49,980 --> 00:29:51,899
the IPS

727
00:29:51,899 --> 00:29:54,000
I'm gonna need some kind of tooling

728
00:29:54,000 --> 00:29:56,039
could be burp sweet I could just be

729
00:29:56,039 --> 00:29:58,260
running Intruder scripts right or I

730
00:29:58,260 --> 00:29:59,940
could sit down and write some Python and

731
00:29:59,940 --> 00:30:02,399
you know figure this thing out

732
00:30:02,399 --> 00:30:03,779
Behavior

733
00:30:03,779 --> 00:30:05,640
remember that single request attack I

734
00:30:05,640 --> 00:30:07,200
talked about that's a behavior type

735
00:30:07,200 --> 00:30:10,320
right rotating user agents is a behavior

736
00:30:10,320 --> 00:30:13,559
type uh doing things like

737
00:30:13,559 --> 00:30:14,279
um

738
00:30:14,279 --> 00:30:16,740
trying to report that you are three or

739
00:30:16,740 --> 00:30:18,720
four different operating systems even

740
00:30:18,720 --> 00:30:21,600
within those user agent strings right is

741
00:30:21,600 --> 00:30:23,580
a behavior type and if we see that we

742
00:30:23,580 --> 00:30:25,799
can always you know ml just surfaces

743
00:30:25,799 --> 00:30:28,159
that stuff nicely

744
00:30:28,159 --> 00:30:31,620
credentials I'm going to have to log in

745
00:30:31,620 --> 00:30:33,240
I was telling somebody about this

746
00:30:33,240 --> 00:30:35,220
exercise I did

747
00:30:35,220 --> 00:30:38,460
um during covid where what I wanted to

748
00:30:38,460 --> 00:30:41,580
do was be a bot

749
00:30:41,580 --> 00:30:43,919
as a human

750
00:30:43,919 --> 00:30:45,659
because I thought it would be fun to

751
00:30:45,659 --> 00:30:47,340
figure out what are all the pieces that

752
00:30:47,340 --> 00:30:50,159
they've automated like let's unautomate

753
00:30:50,159 --> 00:30:52,260
them and see how painful they are so the

754
00:30:52,260 --> 00:30:53,460
first thing I need to do is get email

755
00:30:53,460 --> 00:30:56,760
addresses where am I going to go

756
00:30:56,760 --> 00:30:59,159
Google go get some Gmail addresses right

757
00:30:59,159 --> 00:31:01,919
so you sit down with a web browser and

758
00:31:01,919 --> 00:31:03,960
you sign up for Google and it asks you

759
00:31:03,960 --> 00:31:05,880
for a phone number and if you put the

760
00:31:05,880 --> 00:31:08,520
next one same phone number

761
00:31:08,520 --> 00:31:10,740
it won't let you create that account

762
00:31:10,740 --> 00:31:13,260
because too many phone number too many

763
00:31:13,260 --> 00:31:14,460
accounts of the same phone number is

764
00:31:14,460 --> 00:31:16,380
something they don't allow

765
00:31:16,380 --> 00:31:17,520
dang it

766
00:31:17,520 --> 00:31:19,380
ah but if you sign up through a

767
00:31:19,380 --> 00:31:20,820
Chromebook

768
00:31:20,820 --> 00:31:24,360
it doesn't ask you for the phone number

769
00:31:24,360 --> 00:31:27,500
so I went bought a Chromebook

770
00:31:27,899 --> 00:31:29,760
sat down in my house

771
00:31:29,760 --> 00:31:31,100
I put in

772
00:31:31,100 --> 00:31:33,779
marysmith.gmail.com Bob Smith gmail.com

773
00:31:33,779 --> 00:31:36,539
and big spreadsheet of passwords and a

774
00:31:36,539 --> 00:31:38,820
big spreadsheet of emails and I got to

775
00:31:38,820 --> 00:31:41,159
the fifth create and

776
00:31:41,159 --> 00:31:43,679
it wouldn't let me create it

777
00:31:43,679 --> 00:31:45,840
and it gave me a captcha

778
00:31:45,840 --> 00:31:48,779
and it started asking me questions and I

779
00:31:48,779 --> 00:31:51,419
said I can only create five accounts at

780
00:31:51,419 --> 00:31:52,919
a time

781
00:31:52,919 --> 00:31:54,419
crap

782
00:31:54,419 --> 00:31:55,980
so I drove over to the police station

783
00:31:55,980 --> 00:31:59,580
and got on their Wi-Fi and created five

784
00:31:59,580 --> 00:32:01,200
more accounts

785
00:32:01,200 --> 00:32:03,000
it was IP based

786
00:32:03,000 --> 00:32:04,799
so I'm running through proxy wait I'm

787
00:32:04,799 --> 00:32:06,419
not I'm not a bot I can't do that crap

788
00:32:06,419 --> 00:32:08,820
so then I had to drive to McDonald's and

789
00:32:08,820 --> 00:32:11,100
then I had to go to the library and uh

790
00:32:11,100 --> 00:32:12,779
you know I enriched myself in all of

791
00:32:12,779 --> 00:32:15,539
these places but this is what it takes

792
00:32:15,539 --> 00:32:18,059
to do this kind of stuff I gotta have a

793
00:32:18,059 --> 00:32:20,159
bunch of credentials so that I can log

794
00:32:20,159 --> 00:32:23,039
into these sites and do testing right my

795
00:32:23,039 --> 00:32:24,720
targets the places that I'm gonna go

796
00:32:24,720 --> 00:32:27,960
things like logins right I'm trying to

797
00:32:27,960 --> 00:32:30,000
do credential stuffing attack or

798
00:32:30,000 --> 00:32:32,399
whatever it is that I'm trying to do on

799
00:32:32,399 --> 00:32:35,340
the API you're gonna see it on the login

800
00:32:35,340 --> 00:32:37,200
flow

801
00:32:37,200 --> 00:32:40,320
similarly things like profile reads

802
00:32:40,320 --> 00:32:44,340
right what's OAS API security number one

803
00:32:44,340 --> 00:32:48,059
in the top 10 list Bola right profile

804
00:32:48,059 --> 00:32:49,919
reads or how you figure out if you

805
00:32:49,919 --> 00:32:52,140
you've got Bola right

806
00:32:52,140 --> 00:32:54,960
um document enumeration are they asking

807
00:32:54,960 --> 00:32:57,419
for your Swagger endpoints from the same

808
00:32:57,419 --> 00:32:59,640
IP address because if they are it's not

809
00:32:59,640 --> 00:33:02,640
me right it's somebody else

810
00:33:02,640 --> 00:33:04,440
and then you know we're going to try to

811
00:33:04,440 --> 00:33:07,320
figure out are there logic attacks here

812
00:33:07,320 --> 00:33:09,539
what's a logic attack

813
00:33:09,539 --> 00:33:12,200
anybody

814
00:33:12,360 --> 00:33:14,820
it's business logic abuse is what we've

815
00:33:14,820 --> 00:33:17,340
determined in the industry but logic

816
00:33:17,340 --> 00:33:19,260
attacks are things like

817
00:33:19,260 --> 00:33:22,320
I wonder if you have something in the

818
00:33:22,320 --> 00:33:24,360
back end that's going to catch me doing

819
00:33:24,360 --> 00:33:25,380
this

820
00:33:25,380 --> 00:33:27,779
is a good example you remember the iPod

821
00:33:27,779 --> 00:33:30,440
does anybody remember the iPod

822
00:33:30,440 --> 00:33:33,600
the the Nano there was one that was like

823
00:33:33,600 --> 00:33:35,640
this big that got so small you'd lose

824
00:33:35,640 --> 00:33:37,740
them but the guy was like that big and

825
00:33:37,740 --> 00:33:39,299
it had a bad battery

826
00:33:39,299 --> 00:33:41,700
and so Apple didn't want to have to deal

827
00:33:41,700 --> 00:33:43,380
with a whole bunch of people they don't

828
00:33:43,380 --> 00:33:46,500
like that right it's expensive and a

829
00:33:46,500 --> 00:33:47,700
bunch of other reasons so what they did

830
00:33:47,700 --> 00:33:49,980
is they set up a website and they said

831
00:33:49,980 --> 00:33:51,840
give us a credit card

832
00:33:51,840 --> 00:33:54,779
type your serial number in if it's a bad

833
00:33:54,779 --> 00:33:57,480
one we'll send you a new one and you

834
00:33:57,480 --> 00:33:58,860
send us the old one back and if you

835
00:33:58,860 --> 00:34:00,480
don't send us the old one back we're

836
00:34:00,480 --> 00:34:02,100
charging you for it

837
00:34:02,100 --> 00:34:04,080
and this guy sat down and he didn't have

838
00:34:04,080 --> 00:34:06,000
a credit card but he had a nano with bad

839
00:34:06,000 --> 00:34:07,440
battery

840
00:34:07,440 --> 00:34:09,480
so we went down to this gas station and

841
00:34:09,480 --> 00:34:12,060
he got a Visa gift card

842
00:34:12,060 --> 00:34:15,179
five bucks on it he went back home he

843
00:34:15,179 --> 00:34:17,520
typed the number in Loon algorithm said

844
00:34:17,520 --> 00:34:19,379
yep that's a valid number

845
00:34:19,379 --> 00:34:21,599
he ordered himself another one

846
00:34:21,599 --> 00:34:24,179
and then what did he think

847
00:34:24,179 --> 00:34:26,820
I wonder if I can do it again

848
00:34:26,820 --> 00:34:28,560
I wonder if I can attack the business

849
00:34:28,560 --> 00:34:30,960
logic in this flow

850
00:34:30,960 --> 00:34:36,199
he sent himself 500 iPod Nanos

851
00:34:37,320 --> 00:34:39,960
to his house

852
00:34:39,960 --> 00:34:43,159
that's how he ended up in jail

853
00:34:43,159 --> 00:34:46,080
come on just send it to McDonald's and

854
00:34:46,080 --> 00:34:48,060
walk in and go did you get a box for me

855
00:34:48,060 --> 00:34:49,619
they said it's embroidered here I don't

856
00:34:49,619 --> 00:34:50,580
know

857
00:34:50,580 --> 00:34:52,918
all right so the attack examples we're

858
00:34:52,918 --> 00:34:55,379
gonna go find an endpoint I see a spec

859
00:34:55,379 --> 00:34:57,780
and I can understand that maybe there's

860
00:34:57,780 --> 00:34:59,640
a thing in there that allows for me to

861
00:34:59,640 --> 00:35:02,160
create edit delete a user account a

862
00:35:02,160 --> 00:35:04,320
profile a something so I want to go

863
00:35:04,320 --> 00:35:07,080
after Bola right so what am I going to

864
00:35:07,080 --> 00:35:08,940
do I'm going to log in and I'm going to

865
00:35:08,940 --> 00:35:11,339
use the API as intended

866
00:35:11,339 --> 00:35:14,160
authentication works I get a session

867
00:35:14,160 --> 00:35:16,020
token or however you're doing your stuff

868
00:35:16,020 --> 00:35:17,640
nice

869
00:35:17,640 --> 00:35:19,859
then what I'm going to do is I'm going

870
00:35:19,859 --> 00:35:22,260
to delete that header and I'm going to

871
00:35:22,260 --> 00:35:25,020
try to get there again without it

872
00:35:25,020 --> 00:35:26,940
you'd be shocked how many times this

873
00:35:26,940 --> 00:35:29,220
works completely deleting the

874
00:35:29,220 --> 00:35:31,560
authentication token header oftentimes

875
00:35:31,560 --> 00:35:34,280
makes you an admin

876
00:35:34,280 --> 00:35:37,920
it's fun and then what I'm going to try

877
00:35:37,920 --> 00:35:39,960
to do is go horizontal right I'm going

878
00:35:39,960 --> 00:35:41,579
to try to see can I see someone else's

879
00:35:41,579 --> 00:35:42,900
stuff

880
00:35:42,900 --> 00:35:45,540
normally when I'm doing this as a as a

881
00:35:45,540 --> 00:35:49,320
tester as a researcher I sign up for a

882
00:35:49,320 --> 00:35:50,940
couple accounts and I mess with my own

883
00:35:50,940 --> 00:35:54,300
accounts right but if that isn't the

884
00:35:54,300 --> 00:35:56,400
case always because it isn't the case

885
00:35:56,400 --> 00:35:59,760
always what I try to do is go after IDs

886
00:35:59,760 --> 00:36:01,980
that are very low in number right

887
00:36:01,980 --> 00:36:03,839
because those are like the admins or the

888
00:36:03,839 --> 00:36:05,460
original people that set this thing up

889
00:36:05,460 --> 00:36:07,500
or whatever and I'm really not messing

890
00:36:07,500 --> 00:36:10,640
with anybody's stuff then

891
00:36:10,740 --> 00:36:12,359
the docs are going to tell you where it

892
00:36:12,359 --> 00:36:13,980
is that you need to look for things and

893
00:36:13,980 --> 00:36:15,960
what is happening inside of those flows

894
00:36:15,960 --> 00:36:18,060
right so that's going to help us

895
00:36:18,060 --> 00:36:20,579
understand oh we're creating a user here

896
00:36:20,579 --> 00:36:22,200
I wonder if there's a delete option

897
00:36:22,200 --> 00:36:25,879
inside of this API right

898
00:36:26,099 --> 00:36:29,280
how many of you guys know what crappy is

899
00:36:29,280 --> 00:36:32,400
Matt does really just Matt

900
00:36:32,400 --> 00:36:34,800
you guys said apis earlier I know you

901
00:36:34,800 --> 00:36:36,180
did

902
00:36:36,180 --> 00:36:38,220
so how many of you guys know what web

903
00:36:38,220 --> 00:36:39,900
goat is

904
00:36:39,900 --> 00:36:42,660
a bunch of you that's really good

905
00:36:42,660 --> 00:36:45,420
crappy is the web goat for apis all

906
00:36:45,420 --> 00:36:48,540
right uh so it's a really interesting uh

907
00:36:48,540 --> 00:36:51,060
implementation of like a car Enthusiast

908
00:36:51,060 --> 00:36:52,320
board

909
00:36:52,320 --> 00:36:54,359
and then you can go attack the crap out

910
00:36:54,359 --> 00:36:56,820
of it it's nice it's a great training

911
00:36:56,820 --> 00:36:58,320
thing you know because you get the

912
00:36:58,320 --> 00:36:59,760
source with it and all that it's an OAS

913
00:36:59,760 --> 00:37:05,640
project so it's run by Inon and errors

914
00:37:05,640 --> 00:37:07,500
um it's a guy from Salt security and guy

915
00:37:07,500 --> 00:37:10,020
from uh check marks

916
00:37:10,020 --> 00:37:12,480
um I'm a sponsor on the project and do

917
00:37:12,480 --> 00:37:13,920
quite a bit with those guys on this

918
00:37:13,920 --> 00:37:15,000
thing

919
00:37:15,000 --> 00:37:16,920
um but this is one of those things where

920
00:37:16,920 --> 00:37:18,900
if you have a Dev team that's working

921
00:37:18,900 --> 00:37:21,180
apis and you want to teach them kind of

922
00:37:21,180 --> 00:37:23,180
wacky crap that you can do with apis

923
00:37:23,180 --> 00:37:25,740
this is it right

924
00:37:25,740 --> 00:37:27,960
um I used to do a lot of that I used to

925
00:37:27,960 --> 00:37:29,880
do a lot of teaching Consulting so I

926
00:37:29,880 --> 00:37:30,960
would sit down and I would teach

927
00:37:30,960 --> 00:37:33,380
developers how to hack a website

928
00:37:33,380 --> 00:37:36,200
and my favorite thing in that is when

929
00:37:36,200 --> 00:37:39,720
the developer gets it and understands oh

930
00:37:39,720 --> 00:37:42,420
I get to be creative and mean right and

931
00:37:42,420 --> 00:37:44,099
then just starts going nuts with the

932
00:37:44,099 --> 00:37:46,440
thing that's that's my favorite part you

933
00:37:46,440 --> 00:37:48,359
know suddenly everybody's got cross-site

934
00:37:48,359 --> 00:37:50,400
scripting boxes packing up

935
00:37:50,400 --> 00:37:52,980
good stuff

936
00:37:52,980 --> 00:37:56,160
so I originally wrote this talk for RSA

937
00:37:56,160 --> 00:37:59,099
and uh they said you got to have a thing

938
00:37:59,099 --> 00:38:01,740
that tells people what to do

939
00:38:01,740 --> 00:38:03,320
I said all right

940
00:38:03,320 --> 00:38:06,180
so what should you do when you get back

941
00:38:06,180 --> 00:38:07,740
to the office you should look for your

942
00:38:07,740 --> 00:38:09,540
API specs

943
00:38:09,540 --> 00:38:11,220
where are they

944
00:38:11,220 --> 00:38:14,160
do you have them right and the answer is

945
00:38:14,160 --> 00:38:16,560
probably no you probably don't have them

946
00:38:16,560 --> 00:38:18,900
and that's fine but if you start

947
00:38:18,900 --> 00:38:23,040
creating them find a place to put them

948
00:38:23,040 --> 00:38:25,140
um versioning and understanding where

949
00:38:25,140 --> 00:38:27,300
things are and all of that you gain a

950
00:38:27,300 --> 00:38:29,640
lot out of having this right

951
00:38:29,640 --> 00:38:31,980
um just don't hang it out in the public

952
00:38:31,980 --> 00:38:35,760
if you have specs review them

953
00:38:35,760 --> 00:38:38,339
and understand is this the spec for the

954
00:38:38,339 --> 00:38:40,859
app as it's currently deployed or is

955
00:38:40,859 --> 00:38:42,780
this the spec from like five years ago

956
00:38:42,780 --> 00:38:44,339
when we thought open API would be a

957
00:38:44,339 --> 00:38:46,560
thing we should try right you you have

958
00:38:46,560 --> 00:38:49,520
to see does it actually work

959
00:38:49,520 --> 00:38:52,079
my organization makes a thing that will

960
00:38:52,079 --> 00:38:53,940
look at a spec and it will look at

961
00:38:53,940 --> 00:38:56,280
traffic and say is this traffic

962
00:38:56,280 --> 00:38:58,079
conforming to the spec that way you can

963
00:38:58,079 --> 00:38:59,760
easily identify it it's it's an easy

964
00:38:59,760 --> 00:39:01,980
thing to do in the logs though so you

965
00:39:01,980 --> 00:39:04,980
don't have to buy tools to do it

966
00:39:04,980 --> 00:39:06,720
um

967
00:39:06,720 --> 00:39:09,960
specs should be internal right an

968
00:39:09,960 --> 00:39:11,940
internal means something different to

969
00:39:11,940 --> 00:39:13,619
everyone if you have partners and

970
00:39:13,619 --> 00:39:15,240
they're under NDA maybe you consider

971
00:39:15,240 --> 00:39:17,099
them internal that's what I mean here

972
00:39:17,099 --> 00:39:18,480
right

973
00:39:18,480 --> 00:39:20,820
um keep it like that

974
00:39:20,820 --> 00:39:22,920
some best practices

975
00:39:22,920 --> 00:39:25,500
uh embrace the spec right but establish

976
00:39:25,500 --> 00:39:27,540
policies around it

977
00:39:27,540 --> 00:39:29,460
um no API gets published without a spec

978
00:39:29,460 --> 00:39:32,339
is a simple policy right and there's

979
00:39:32,339 --> 00:39:33,780
lots of tools out there you can plug

980
00:39:33,780 --> 00:39:35,940
into your API or plug into your nginx

981
00:39:35,940 --> 00:39:37,859
environment and it'll build a spec for

982
00:39:37,859 --> 00:39:39,599
you by watching the traffic go by so

983
00:39:39,599 --> 00:39:42,240
it's you know not that hard to do

984
00:39:42,240 --> 00:39:45,599
test against your spec right if you have

985
00:39:45,599 --> 00:39:47,940
a pen test coming up on this app produce

986
00:39:47,940 --> 00:39:50,220
the spec for the pen tester right that

987
00:39:50,220 --> 00:39:51,900
that's a really great easy way to do

988
00:39:51,900 --> 00:39:53,400
that right

989
00:39:53,400 --> 00:39:57,060
protect it replace any defaults in your

990
00:39:57,060 --> 00:39:59,160
environment that are going to have

991
00:39:59,160 --> 00:40:01,740
panels on them right so graphql

992
00:40:01,740 --> 00:40:04,339
interfaces those Explorer playgrounds

993
00:40:04,339 --> 00:40:07,140
all of those kinds of things there's

994
00:40:07,140 --> 00:40:09,960
even an open API one if you're using

995
00:40:09,960 --> 00:40:12,540
open API server there's an admin

996
00:40:12,540 --> 00:40:15,060
interface for it right if I find your

997
00:40:15,060 --> 00:40:16,560
Swagger file I can probably figure out

998
00:40:16,560 --> 00:40:17,880
where your server is and get on the

999
00:40:17,880 --> 00:40:20,640
admin interface

1000
00:40:20,640 --> 00:40:24,599
um and then manage the scanners right uh

1001
00:40:24,599 --> 00:40:26,880
use them to see what the attackers see

1002
00:40:26,880 --> 00:40:29,880
you want to understand how it is that

1003
00:40:29,880 --> 00:40:33,000
you're being attacked one of the things

1004
00:40:33,000 --> 00:40:35,579
that I get to do uh for my organization

1005
00:40:35,579 --> 00:40:38,520
as I do back looks so we'll look at an

1006
00:40:38,520 --> 00:40:40,560
attack that happened at a customer right

1007
00:40:40,560 --> 00:40:43,200
so pull out I don't know 50 million

1008
00:40:43,200 --> 00:40:45,839
requests and run data science against

1009
00:40:45,839 --> 00:40:48,119
them and try to figure out like What's

1010
00:40:48,119 --> 00:40:49,920
Happening Here what did they want to do

1011
00:40:49,920 --> 00:40:52,020
how are they trying to achieve it how

1012
00:40:52,020 --> 00:40:54,480
are they trying to avoid us right all of

1013
00:40:54,480 --> 00:40:55,980
those kinds of things you have to be

1014
00:40:55,980 --> 00:40:58,440
able to go back and watch the game tapes

1015
00:40:58,440 --> 00:41:01,079
right and figure out where they worked

1016
00:41:01,079 --> 00:41:02,880
and where they didn't

1017
00:41:02,880 --> 00:41:06,720
um I just recently did a pen test

1018
00:41:06,720 --> 00:41:09,900
engagement I wasn't the pen tester I was

1019
00:41:09,900 --> 00:41:12,420
receiving the pen test

1020
00:41:12,420 --> 00:41:15,900
um as my client had us installed and

1021
00:41:15,900 --> 00:41:17,579
said we want you to watch this pen test

1022
00:41:17,579 --> 00:41:19,260
because we want to know what they're

1023
00:41:19,260 --> 00:41:22,079
doing right and it was with the Chinese

1024
00:41:22,079 --> 00:41:23,480
government

1025
00:41:23,480 --> 00:41:26,339
this client was trying to put in a new

1026
00:41:26,339 --> 00:41:28,320
software platform and a hardware

1027
00:41:28,320 --> 00:41:31,200
manufacturing thing and it would be sold

1028
00:41:31,200 --> 00:41:32,940
to the public and the Chinese government

1029
00:41:32,940 --> 00:41:35,700
told them you can do that if we can come

1030
00:41:35,700 --> 00:41:39,300
pen tested and they were like

1031
00:41:39,300 --> 00:41:41,820
I don't know if I want that but they

1032
00:41:41,820 --> 00:41:44,280
want the business so uh they they said

1033
00:41:44,280 --> 00:41:46,320
yes and we sat there and I'm going to

1034
00:41:46,320 --> 00:41:47,820
tell you right now if you're worried

1035
00:41:47,820 --> 00:41:51,300
about apt from China please don't be uh

1036
00:41:51,300 --> 00:41:53,700
if you can block standard scanning tools

1037
00:41:53,700 --> 00:41:57,480
you're good most of the scanner tools

1038
00:41:57,480 --> 00:41:59,099
that they ran against most of the things

1039
00:41:59,099 --> 00:42:01,200
they ran against us were scanners and

1040
00:42:01,200 --> 00:42:03,720
none of the things that they did were

1041
00:42:03,720 --> 00:42:05,460
what I would consider creative like

1042
00:42:05,460 --> 00:42:07,560
taking out a head off header right

1043
00:42:07,560 --> 00:42:09,780
didn't do that they don't even run burp

1044
00:42:09,780 --> 00:42:12,599
they just fire scanners at you it's a

1045
00:42:12,599 --> 00:42:14,339
weird thing but I have all of that

1046
00:42:14,339 --> 00:42:15,900
traffic and I get to do back looks on it

1047
00:42:15,900 --> 00:42:17,640
and come back to the product team and

1048
00:42:17,640 --> 00:42:19,320
say hey this is how we can catch this

1049
00:42:19,320 --> 00:42:22,079
better right

1050
00:42:22,079 --> 00:42:25,740
so I have a few recommendations

1051
00:42:25,740 --> 00:42:29,400
and you're going to see me say oh wasp

1052
00:42:29,400 --> 00:42:32,460
API categories right a couple of times

1053
00:42:32,460 --> 00:42:33,599
for this

1054
00:42:33,599 --> 00:42:36,839
so we just did this massive exercise

1055
00:42:36,839 --> 00:42:38,640
where we looked at the last six months

1056
00:42:38,640 --> 00:42:40,980
of all of our customers traffic and we

1057
00:42:40,980 --> 00:42:44,400
said you know what there are three API

1058
00:42:44,400 --> 00:42:47,579
categories in the oauth standard that if

1059
00:42:47,579 --> 00:42:50,160
you have them you're screwed

1060
00:42:50,160 --> 00:42:53,460
like really screwed right and I'm now

1061
00:42:53,460 --> 00:42:55,200
going to give you the big secret it's

1062
00:42:55,200 --> 00:42:56,940
two three and nine

1063
00:42:56,940 --> 00:43:01,079
if you have those you're really screwed

1064
00:43:01,079 --> 00:43:02,280
um and especially if they appear all

1065
00:43:02,280 --> 00:43:03,060
together

1066
00:43:03,060 --> 00:43:06,480
in proper Asset Management uh is a it's

1067
00:43:06,480 --> 00:43:08,520
a pretty broad category right it's that

1068
00:43:08,520 --> 00:43:12,300
we have V16 but we left V1 on it's also

1069
00:43:12,300 --> 00:43:15,119
I left my graphql playground on I left

1070
00:43:15,119 --> 00:43:16,740
you know there's a whole bunch of things

1071
00:43:16,740 --> 00:43:18,480
inside of this that that you really need

1072
00:43:18,480 --> 00:43:19,800
to consider

1073
00:43:19,800 --> 00:43:22,740
what I like to make sure we do here is

1074
00:43:22,740 --> 00:43:25,200
uh you know very standard and clean

1075
00:43:25,200 --> 00:43:28,319
things https right consistent naming

1076
00:43:28,319 --> 00:43:29,640
conventions things that are going to

1077
00:43:29,640 --> 00:43:33,060
lead to code quality because quality

1078
00:43:33,060 --> 00:43:35,940
code is the cure code right

1079
00:43:35,940 --> 00:43:36,839
um

1080
00:43:36,839 --> 00:43:40,140
methods and paths this is another API

1081
00:43:40,140 --> 00:43:42,599
nine does anybody think nine will be

1082
00:43:42,599 --> 00:43:47,400
moving up in the next riff I do

1083
00:43:47,400 --> 00:43:49,140
um but make sure things are used as

1084
00:43:49,140 --> 00:43:52,260
intended right I I like the example that

1085
00:43:52,260 --> 00:43:54,420
Matt gave yesterday if there's an ad on

1086
00:43:54,420 --> 00:43:57,119
this user flow and I can add a user and

1087
00:43:57,119 --> 00:44:00,599
I can view all users can I delete all

1088
00:44:00,599 --> 00:44:01,500
users

1089
00:44:01,500 --> 00:44:05,780
right and don't test that

1090
00:44:05,780 --> 00:44:08,579
you know just randomly because it might

1091
00:44:08,579 --> 00:44:10,020
work

1092
00:44:10,020 --> 00:44:11,400
yeah

1093
00:44:11,400 --> 00:44:13,200
um but lots of different stuff right

1094
00:44:13,200 --> 00:44:15,720
post puts deletes uh all of the the

1095
00:44:15,720 --> 00:44:18,000
different uh HTTP methods that you can

1096
00:44:18,000 --> 00:44:21,119
use oftentimes some of them are enabled

1097
00:44:21,119 --> 00:44:22,619
when they shouldn't be or they're

1098
00:44:22,619 --> 00:44:25,260
enabled in a way that they shouldn't be

1099
00:44:25,260 --> 00:44:27,060
um you know I've I've gone to a lot of

1100
00:44:27,060 --> 00:44:30,180
organizations that gets don't work but

1101
00:44:30,180 --> 00:44:32,460
posts do and you can run all of the same

1102
00:44:32,460 --> 00:44:34,140
queries that you would normally run in

1103
00:44:34,140 --> 00:44:35,819
the git in the post just in the post

1104
00:44:35,819 --> 00:44:39,359
body and it works and you get back data

1105
00:44:39,359 --> 00:44:42,000
that's different than you know data that

1106
00:44:42,000 --> 00:44:44,220
you would get in a different way so it's

1107
00:44:44,220 --> 00:44:46,680
important

1108
00:44:46,680 --> 00:44:49,380
um Mass assignment uh is another one of

1109
00:44:49,380 --> 00:44:51,540
these things that it'll own you faster

1110
00:44:51,540 --> 00:44:54,480
right if you have it

1111
00:44:54,480 --> 00:44:57,420
um API six right open-ended parameter

1112
00:44:57,420 --> 00:45:00,180
values never a great idea being able to

1113
00:45:00,180 --> 00:45:03,300
add things you know a great example

1114
00:45:03,300 --> 00:45:05,099
yesterday about you know you show up to

1115
00:45:05,099 --> 00:45:07,440
a website or you're signing up for

1116
00:45:07,440 --> 00:45:09,359
something on your phone and it asks your

1117
00:45:09,359 --> 00:45:11,280
favorite color and it has you pick it

1118
00:45:11,280 --> 00:45:12,960
from a list

1119
00:45:12,960 --> 00:45:16,020
if you add things to that list

1120
00:45:16,020 --> 00:45:19,500
that's mean he adds things to that list

1121
00:45:19,500 --> 00:45:22,079
billions of them and then asks for the

1122
00:45:22,079 --> 00:45:24,800
list again right

1123
00:45:24,800 --> 00:45:27,780
it's a it's a neat way to roll it over

1124
00:45:27,780 --> 00:45:30,839
I've I'm totally stealing that

1125
00:45:30,839 --> 00:45:32,960
um

1126
00:45:33,480 --> 00:45:36,180
so the I I have two slides that are

1127
00:45:36,180 --> 00:45:38,520
marked as recommendation number four and

1128
00:45:38,520 --> 00:45:40,079
they're copies I don't know what

1129
00:45:40,079 --> 00:45:41,460
happened

1130
00:45:41,460 --> 00:45:42,839
um I don't know why it happened but

1131
00:45:42,839 --> 00:45:46,200
think about response bodies for a second

1132
00:45:46,200 --> 00:45:49,740
when I look at uh response bodies I can

1133
00:45:49,740 --> 00:45:52,200
end up with something called uh

1134
00:45:52,200 --> 00:45:56,040
excessive data exposure I did a uh so

1135
00:45:56,040 --> 00:45:59,339
you guys remember uh really early on

1136
00:45:59,339 --> 00:46:04,079
like March 21 March 20 I guess

1137
00:46:04,079 --> 00:46:06,359
um we didn't have a way to go out to eat

1138
00:46:06,359 --> 00:46:08,339
because we all had to stay home well we

1139
00:46:08,339 --> 00:46:09,599
did in some places

1140
00:46:09,599 --> 00:46:12,240
and I had to stay home and where I was

1141
00:46:12,240 --> 00:46:14,640
so when they decided they were going to

1142
00:46:14,640 --> 00:46:16,920
open things back up a little all of the

1143
00:46:16,920 --> 00:46:18,060
restaurants

1144
00:46:18,060 --> 00:46:20,099
now suddenly

1145
00:46:20,099 --> 00:46:22,140
had to be able to serve you at the curb

1146
00:46:22,140 --> 00:46:24,300
right and this was a real problem

1147
00:46:24,300 --> 00:46:25,800
because they're used to you walking into

1148
00:46:25,800 --> 00:46:27,900
the restaurant and ordering and they're

1149
00:46:27,900 --> 00:46:29,460
point of sale systems right there in

1150
00:46:29,460 --> 00:46:30,480
front of them

1151
00:46:30,480 --> 00:46:33,960
so a lot of these guys went to Clover

1152
00:46:33,960 --> 00:46:36,599
toast right those guys came out with

1153
00:46:36,599 --> 00:46:39,119
stuff real fast so you could you know do

1154
00:46:39,119 --> 00:46:40,800
it whatever it is that you wanted to do

1155
00:46:40,800 --> 00:46:42,960
I tell my friends all the time go back

1156
00:46:42,960 --> 00:46:45,660
in time four years walk into your

1157
00:46:45,660 --> 00:46:48,180
favorite bar or better yet call your

1158
00:46:48,180 --> 00:46:50,160
favorite bar and ask them to bring you a

1159
00:46:50,160 --> 00:46:53,060
double whiskey outside

1160
00:46:53,280 --> 00:46:54,540
right

1161
00:46:54,540 --> 00:46:56,819
but I could do that after they opened

1162
00:46:56,819 --> 00:46:58,980
things back up I could get drinks right

1163
00:46:58,980 --> 00:47:03,780
suddenly it wasn't so you know bad so I

1164
00:47:03,780 --> 00:47:06,480
ordered a hamburger and a beer from the

1165
00:47:06,480 --> 00:47:09,000
place down the street and I looked at

1166
00:47:09,000 --> 00:47:11,339
the API call it made

1167
00:47:11,339 --> 00:47:15,119
and it had a lot of stuff in it it was

1168
00:47:15,119 --> 00:47:17,880
all stuff about the relationship with

1169
00:47:17,880 --> 00:47:19,260
toast

1170
00:47:19,260 --> 00:47:22,200
and the company it was what level they

1171
00:47:22,200 --> 00:47:23,579
were at it was what their service

1172
00:47:23,579 --> 00:47:25,619
contracts had in it

1173
00:47:25,619 --> 00:47:29,099
right so

1174
00:47:29,579 --> 00:47:31,980
I looked at that and I said that seems

1175
00:47:31,980 --> 00:47:34,740
like an awful lot of data that's an

1176
00:47:34,740 --> 00:47:37,200
excessive data exposure they're giving

1177
00:47:37,200 --> 00:47:40,859
me so many things why why would that

1178
00:47:40,859 --> 00:47:42,599
even be on there and then I thought

1179
00:47:42,599 --> 00:47:44,700
about it for a second and I said they've

1180
00:47:44,700 --> 00:47:45,780
got a mobile app that you could

1181
00:47:45,780 --> 00:47:48,200
administer this thing off of

1182
00:47:48,200 --> 00:47:51,359
right that's why it's all sitting there

1183
00:47:51,359 --> 00:47:53,700
I bet if I walked into the bar and said

1184
00:47:53,700 --> 00:47:55,500
can I see your toast app it would have

1185
00:47:55,500 --> 00:47:57,780
all of that stuff on it you're sending

1186
00:47:57,780 --> 00:47:59,520
it to all of the client every client

1187
00:47:59,520 --> 00:48:01,440
that connects to that thing when you

1188
00:48:01,440 --> 00:48:03,240
really only need to send it to these

1189
00:48:03,240 --> 00:48:06,060
guys uh it's an interesting

1190
00:48:06,060 --> 00:48:10,079
Strange Case of why did you do that

1191
00:48:10,079 --> 00:48:11,760
all right the last one which isn't

1192
00:48:11,760 --> 00:48:13,260
number four

1193
00:48:13,260 --> 00:48:13,880
um

1194
00:48:13,880 --> 00:48:17,640
it's it's number five the uh

1195
00:48:17,640 --> 00:48:22,319
API number two is broken user off right

1196
00:48:22,319 --> 00:48:24,000
you're not authenticating them or you're

1197
00:48:24,000 --> 00:48:25,859
authenticating them and it's you're just

1198
00:48:25,859 --> 00:48:27,960
using some crap authentication routine

1199
00:48:27,960 --> 00:48:30,839
that's never going to get you anything

1200
00:48:30,839 --> 00:48:33,599
um so you start to look at how are you

1201
00:48:33,599 --> 00:48:36,300
doing authentication on this flow and

1202
00:48:36,300 --> 00:48:38,640
what I oftentimes point out is stuff

1203
00:48:38,640 --> 00:48:41,819
like this here we're using oauth right

1204
00:48:41,819 --> 00:48:45,300
you remember that V16 V5 V1 stuff I

1205
00:48:45,300 --> 00:48:48,359
talked about from before

1206
00:48:48,359 --> 00:48:52,500
what if you weren't using oauth on V1

1207
00:48:52,500 --> 00:48:54,480
and now you have a database of

1208
00:48:54,480 --> 00:48:56,060
authentication credentials sitting there

1209
00:48:56,060 --> 00:48:58,400
right

1210
00:48:58,400 --> 00:49:01,200
that I can go after right these are bad

1211
00:49:01,200 --> 00:49:04,440
things you don't want to do that so of

1212
00:49:04,440 --> 00:49:07,859
the five things that I suggest that you

1213
00:49:07,859 --> 00:49:10,619
uh do at the end of this

1214
00:49:10,619 --> 00:49:14,520
this one is important right you want to

1215
00:49:14,520 --> 00:49:16,140
make sure your authentication is set up

1216
00:49:16,140 --> 00:49:18,300
but it's nowhere near as important as

1217
00:49:18,300 --> 00:49:21,780
nine right being able to find your API

1218
00:49:21,780 --> 00:49:23,760
endpoints I mean this is the next thing

1219
00:49:23,760 --> 00:49:26,640
I'm going to test right so if I can't

1220
00:49:26,640 --> 00:49:28,980
find them I don't test them

1221
00:49:28,980 --> 00:49:30,780
if you look at breaches that have

1222
00:49:30,780 --> 00:49:33,300
happened really recently right there was

1223
00:49:33,300 --> 00:49:36,240
a big breach in Australia has anybody

1224
00:49:36,240 --> 00:49:39,060
heard of the Optus breach right so the

1225
00:49:39,060 --> 00:49:40,980
Optus Optus is the phone company in

1226
00:49:40,980 --> 00:49:44,280
Australia about 30 million clients I

1227
00:49:44,280 --> 00:49:45,119
think

1228
00:49:45,119 --> 00:49:47,220
something like that it's about 30

1229
00:49:47,220 --> 00:49:51,359
percent of Australia uses their service

1230
00:49:51,359 --> 00:49:53,760
they had an API endpoint that they were

1231
00:49:53,760 --> 00:49:55,079
unaware of

1232
00:49:55,079 --> 00:49:58,140
public no off

1233
00:49:58,140 --> 00:50:00,900
and if you typed in a phone number it

1234
00:50:00,900 --> 00:50:02,960
would give you back the owner's location

1235
00:50:02,960 --> 00:50:05,940
you know their address and all the

1236
00:50:05,940 --> 00:50:09,079
things right IMEI all the things

1237
00:50:09,079 --> 00:50:13,040
that breach has changed

1238
00:50:13,040 --> 00:50:16,260
what Parliament is doing in Australia

1239
00:50:16,260 --> 00:50:19,880
now right they they are now legislating

1240
00:50:19,880 --> 00:50:24,060
security into things because most of

1241
00:50:24,060 --> 00:50:27,259
them got breached

1242
00:50:27,740 --> 00:50:30,119
they're Optus people

1243
00:50:30,119 --> 00:50:31,880
uh so

1244
00:50:31,880 --> 00:50:33,839
you know

1245
00:50:33,839 --> 00:50:35,520
um if you if you confuse them with this

1246
00:50:35,520 --> 00:50:36,960
stuff they'll just legislate it away

1247
00:50:36,960 --> 00:50:40,020
right like that's that's how it works uh

1248
00:50:40,020 --> 00:50:42,000
for politicians but

1249
00:50:42,000 --> 00:50:45,000
when somebody stumbled across an API

1250
00:50:45,000 --> 00:50:48,359
endpoint they checked it right I work

1251
00:50:48,359 --> 00:50:50,520
with a lot of phone companies you'd be

1252
00:50:50,520 --> 00:50:52,260
surprised phone companies get attacked

1253
00:50:52,260 --> 00:50:54,300
by Bots constantly

1254
00:50:54,300 --> 00:50:56,160
um and we deal with that quite a bit and

1255
00:50:56,160 --> 00:50:57,599
we do a lot of stuff with phone

1256
00:50:57,599 --> 00:51:00,599
companies and almost all of it is you

1257
00:51:00,599 --> 00:51:02,880
have a flow with an endpoint that takes

1258
00:51:02,880 --> 00:51:06,000
the phone number as an input and outputs

1259
00:51:06,000 --> 00:51:09,300
some thing and people will just sit

1260
00:51:09,300 --> 00:51:10,980
there and type keyboard smash phone

1261
00:51:10,980 --> 00:51:13,920
numbers into it all day right

1262
00:51:13,920 --> 00:51:15,900
um and eventually they're going to get a

1263
00:51:15,900 --> 00:51:18,119
bunch of data back these guys figured

1264
00:51:18,119 --> 00:51:19,800
out if I type in this phone number I get

1265
00:51:19,800 --> 00:51:22,920
back this data package python script

1266
00:51:22,920 --> 00:51:24,900
start with this number and with this

1267
00:51:24,900 --> 00:51:27,359
number enter right like that that wasn't

1268
00:51:27,359 --> 00:51:30,660
hard I got it all also they had no

1269
00:51:30,660 --> 00:51:32,160
outbound

1270
00:51:32,160 --> 00:51:34,980
uh detection of

1271
00:51:34,980 --> 00:51:38,599
how fast the data was leaving right

1272
00:51:38,599 --> 00:51:41,460
one of the things I've always wanted is

1273
00:51:41,460 --> 00:51:43,079
a WAFF

1274
00:51:43,079 --> 00:51:46,140
that'll look at a response size and go

1275
00:51:46,140 --> 00:51:47,420
no

1276
00:51:47,420 --> 00:51:52,079
right 12 mags is too big

1277
00:51:52,079 --> 00:51:55,920
right for this output yeah I don't know

1278
00:51:55,920 --> 00:51:58,260
I'm not good at products I guess all

1279
00:51:58,260 --> 00:52:00,660
right so uh that's me and I I was

1280
00:52:00,660 --> 00:52:02,460
talking about apis

1281
00:52:02,460 --> 00:52:04,920
um I've got about five minutes left so

1282
00:52:04,920 --> 00:52:07,440
uh I wanted to be able to ask questions

1283
00:52:07,440 --> 00:52:09,180
or have you ask me questions if you

1284
00:52:09,180 --> 00:52:10,020
wanted

1285
00:52:10,020 --> 00:52:11,339
um and if you don't then you should

1286
00:52:11,339 --> 00:52:13,319
probably run over the other room uh

1287
00:52:13,319 --> 00:52:15,119
because at four I guess they end this

1288
00:52:15,119 --> 00:52:16,020
thing

1289
00:52:16,020 --> 00:52:17,339
um and we're five minutes from that so

1290
00:52:17,339 --> 00:52:20,599
does anybody have any questions

1291
00:52:21,839 --> 00:52:24,180
no one has the question hey Jason what

1292
00:52:24,180 --> 00:52:25,319
happened to that accident you had

1293
00:52:25,319 --> 00:52:26,819
earlier

1294
00:52:26,819 --> 00:52:29,780
how do you handle the pen testing

1295
00:52:29,780 --> 00:52:33,540
multi-tenant SAS vendors where basically

1296
00:52:33,540 --> 00:52:36,240
the tenant name is the first part of the

1297
00:52:36,240 --> 00:52:37,980
URL

1298
00:52:37,980 --> 00:52:40,559
yeah so I'm I actually am dealing with

1299
00:52:40,559 --> 00:52:43,380
this with the uh an organization that I

1300
00:52:43,380 --> 00:52:44,819
deal with

1301
00:52:44,819 --> 00:52:47,220
um they have 2 000

1302
00:52:47,220 --> 00:52:49,140
vendors coming through their platform

1303
00:52:49,140 --> 00:52:51,359
and each one has its own

1304
00:52:51,359 --> 00:52:53,400
um and when you're pen testing something

1305
00:52:53,400 --> 00:52:55,920
like that you're going to do kind of

1306
00:52:55,920 --> 00:52:57,240
like

1307
00:52:57,240 --> 00:53:00,480
I'm going to test it as a tenant as much

1308
00:53:00,480 --> 00:53:02,400
as I can and then I'm going to test to

1309
00:53:02,400 --> 00:53:05,220
see if I can go right or left right and

1310
00:53:05,220 --> 00:53:07,319
if I can go right or left then all the

1311
00:53:07,319 --> 00:53:09,059
rules apply to the same vulnerabilities

1312
00:53:09,059 --> 00:53:10,740
I found just going up and down the stack

1313
00:53:10,740 --> 00:53:12,720
right

1314
00:53:12,720 --> 00:53:15,180
um dating kind of API rate limits help

1315
00:53:15,180 --> 00:53:17,339
with solving problems that you've talked

1316
00:53:17,339 --> 00:53:19,260
about articulating your dog like you

1317
00:53:19,260 --> 00:53:20,400
know the number of endpoints you can

1318
00:53:20,400 --> 00:53:22,920
advance but at certain time time point

1319
00:53:22,920 --> 00:53:25,680
or anything like that rate limiting is

1320
00:53:25,680 --> 00:53:28,319
really hard because as soon as you tweak

1321
00:53:28,319 --> 00:53:31,079
something to change the rate and it's

1322
00:53:31,079 --> 00:53:32,819
something that the attacker is in

1323
00:53:32,819 --> 00:53:36,000
control of they'll change too right they

1324
00:53:36,000 --> 00:53:38,400
pivot just as fast as you do

1325
00:53:38,400 --> 00:53:40,440
um I've seen pivots in less than 30

1326
00:53:40,440 --> 00:53:42,780
seconds like we'll apply a policy and

1327
00:53:42,780 --> 00:53:44,460
bang their back

1328
00:53:44,460 --> 00:53:48,059
um it's crazy to watch but uh the the

1329
00:53:48,059 --> 00:53:49,619
challenge with rate limiting is the one

1330
00:53:49,619 --> 00:53:51,900
that I I talked about earlier where what

1331
00:53:51,900 --> 00:53:53,460
happens when it's always a single

1332
00:53:53,460 --> 00:53:54,420
request

1333
00:53:54,420 --> 00:53:56,000
right right

1334
00:53:56,000 --> 00:53:58,380
but it'll always just look like one

1335
00:53:58,380 --> 00:54:00,359
single request right

1336
00:54:00,359 --> 00:54:04,020
um and scraping isn't illegal here so uh

1337
00:54:04,020 --> 00:54:05,280
there's not a lot of things that you can

1338
00:54:05,280 --> 00:54:06,140
do

1339
00:54:06,140 --> 00:54:08,339
to sort of slow down if it's just

1340
00:54:08,339 --> 00:54:09,839
scraping if they're doing something like

1341
00:54:09,839 --> 00:54:12,960
logins and you can tie on to something

1342
00:54:12,960 --> 00:54:15,900
else right so this user came from three

1343
00:54:15,900 --> 00:54:17,280
countries

1344
00:54:17,280 --> 00:54:20,520
all right that's easy right this user

1345
00:54:20,520 --> 00:54:22,859
came from more than five IP addresses in

1346
00:54:22,859 --> 00:54:25,260
the last three minutes that's easy right

1347
00:54:25,260 --> 00:54:27,000
so you have to have something they can't

1348
00:54:27,000 --> 00:54:29,940
pivot off uh in order to lock down the

1349
00:54:29,940 --> 00:54:31,020
rates

1350
00:54:31,020 --> 00:54:32,640
they

1351
00:54:32,640 --> 00:54:35,420
anybody else

1352
00:54:36,380 --> 00:54:39,780
so do you also look at that SAS vendors

1353
00:54:39,780 --> 00:54:42,599
uh forums or communities you can see if

1354
00:54:42,599 --> 00:54:45,480
some of the posts might expose uh some

1355
00:54:45,480 --> 00:54:48,240
of the credentials

1356
00:54:48,240 --> 00:54:50,359
um

1357
00:54:51,240 --> 00:54:54,359
yeah so um a lot of times like if you

1358
00:54:54,359 --> 00:54:56,700
look at that quality is actually a

1359
00:54:56,700 --> 00:54:57,780
pretty good example because they have

1360
00:54:57,780 --> 00:54:59,700
multiple platforms you could be on one

1361
00:54:59,700 --> 00:55:02,220
of them it's multi-tenant inside they

1362
00:55:02,220 --> 00:55:04,440
don't do that uh thing where you know

1363
00:55:04,440 --> 00:55:07,319
it's driven off off so when you log in

1364
00:55:07,319 --> 00:55:09,300
you're on your platform

1365
00:55:09,300 --> 00:55:11,280
um but it's definitely one of those

1366
00:55:11,280 --> 00:55:13,859
things where if you're in an environment

1367
00:55:13,859 --> 00:55:16,140
like that yes you read every document

1368
00:55:16,140 --> 00:55:18,660
that you can every Forum complaint you

1369
00:55:18,660 --> 00:55:20,460
DM people that are complaining because

1370
00:55:20,460 --> 00:55:22,740
you know they've been poking it

1371
00:55:22,740 --> 00:55:24,359
um yeah there's a plenty of things that

1372
00:55:24,359 --> 00:55:26,839
you can do there

1373
00:55:27,359 --> 00:55:29,840
anybody else yep

1374
00:55:29,840 --> 00:55:32,040
[Music]

1375
00:55:32,040 --> 00:55:34,700
what's that

1376
00:55:35,040 --> 00:55:36,960
are you sure man I'm telling you we've

1377
00:55:36,960 --> 00:55:39,960
sat and stared at the screen for there

1378
00:55:39,960 --> 00:55:41,760
were eight of us on on a zoom call

1379
00:55:41,760 --> 00:55:44,280
watching the data flow through and I was

1380
00:55:44,280 --> 00:55:45,839
like

1381
00:55:45,839 --> 00:55:50,339
are they gonna start you know and

1382
00:55:50,339 --> 00:55:53,040
all we could figure is well all I could

1383
00:55:53,040 --> 00:55:56,579
figure was they either had the B team on

1384
00:55:56,579 --> 00:55:57,920
that day

1385
00:55:57,920 --> 00:56:00,780
or uh something they came from the same

1386
00:56:00,780 --> 00:56:03,660
IP address it was very well known tools

1387
00:56:03,660 --> 00:56:07,339
I could see them

1388
00:56:07,440 --> 00:56:10,800
and we thought that and we went and uh

1389
00:56:10,800 --> 00:56:13,380
had them pull all of their uh nginx

1390
00:56:13,380 --> 00:56:15,839
everything that they could give us and

1391
00:56:15,839 --> 00:56:18,420
all of the accounts matched up so every

1392
00:56:18,420 --> 00:56:19,859
transaction that came in was a

1393
00:56:19,859 --> 00:56:21,420
transaction we saw

1394
00:56:21,420 --> 00:56:23,480
they

1395
00:56:23,480 --> 00:56:26,520
knew that we were supposed to be doing

1396
00:56:26,520 --> 00:56:27,900
something that they were going to have

1397
00:56:27,900 --> 00:56:30,119
to get around

1398
00:56:30,119 --> 00:56:32,640
but they never it never went past

1399
00:56:32,640 --> 00:56:34,920
scanning tools right like I was very

1400
00:56:34,920 --> 00:56:37,079
strange I don't know what to take from

1401
00:56:37,079 --> 00:56:40,339
that I still am weirded out by it

1402
00:56:40,339 --> 00:56:43,079
but they passed you know my client got

1403
00:56:43,079 --> 00:56:44,460
passed and you can build his stuff now

1404
00:56:44,460 --> 00:56:48,420
so we're good but it was very strange

1405
00:56:48,420 --> 00:56:52,280
Jason appreciate it

