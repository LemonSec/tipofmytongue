1
00:00:00,030 --> 00:00:05,160
<font color="#E5E5E5">alright good afternoon everybody thanks</font>

2
00:00:03,419 --> 00:00:07,590
for<font color="#E5E5E5"> coming in here</font><font color="#CCCCCC"> for the last session</font>

3
00:00:05,160 --> 00:00:08,790
though it's been a long two days now<font color="#E5E5E5"> so</font>

4
00:00:07,590 --> 00:00:12,450
hopefully this will<font color="#E5E5E5"> be interesting to</font>

5
00:00:08,790 --> 00:00:14,910
end up the<font color="#E5E5E5"> conference let's go a little</font>

6
00:00:12,450 --> 00:00:17,009
bit more<font color="#E5E5E5"> about</font><font color="#CCCCCC"> my background I work in</font>

7
00:00:14,910 --> 00:00:18,150
spy<font color="#CCCCCC"> Trustwave spiderlabs there's a lot</font>

8
00:00:17,010 --> 00:00:20,370
of different<font color="#CCCCCC"> teams in there</font><font color="#E5E5E5"> I work on</font>

9
00:00:18,150 --> 00:00:22,890
<font color="#E5E5E5">the research team my area of expertise</font>

10
00:00:20,370 --> 00:00:24,510
is<font color="#E5E5E5"> web application defense so we have</font>

11
00:00:22,890 --> 00:00:25,830
like<font color="#E5E5E5"> a pen testing group time like the</font>

12
00:00:24,510 --> 00:00:28,620
reverse right I try and<font color="#E5E5E5"> protect the</font>

13
00:00:25,830 --> 00:00:31,349
websites from guys like them so on

14
00:00:28,620 --> 00:00:34,410
<font color="#E5E5E5">Twitter you're on twitter my twitter</font>

15
00:00:31,350 --> 00:00:36,960
handle<font color="#E5E5E5"> there Ryan see Barnett what else</font>

16
00:00:34,410 --> 00:00:39,690
modsecurity it's an open source web at

17
00:00:36,960 --> 00:00:42,749
firewall project modsecurity itself is

18
00:00:39,690 --> 00:00:45,059
not an OS project but the<font color="#CCCCCC"> ruleset</font><font color="#E5E5E5"> that</font>

19
00:00:42,749 --> 00:00:47,129
<font color="#CCCCCC">i'm going</font><font color="#E5E5E5"> to talk about is so that's the</font>

20
00:00:45,059 --> 00:00:49,649
<font color="#CCCCCC">think you ask the</font><font color="#E5E5E5"> question the CRS will</font>

21
00:00:47,129 --> 00:00:51,748
talk about<font color="#CCCCCC"> it's the core rule</font><font color="#E5E5E5"> set so</font>

22
00:00:49,649 --> 00:00:53,640
we'll get into that obvious affiliation

23
00:00:51,749 --> 00:00:56,339
with<font color="#E5E5E5"> a wasp fly on here running that</font>

24
00:00:53,640 --> 00:00:58,199
project<font color="#E5E5E5"> I also contribute to the app</font>

25
00:00:56,339 --> 00:01:00,690
sensor project which will talk about as

26
00:00:58,199 --> 00:01:03,420
well do some instruction at sans

27
00:01:00,690 --> 00:01:06,360
institute and shameless plug for my book

28
00:01:03,420 --> 00:01:07,680
preventing web attacks with<font color="#CCCCCC"> apache so</font>

29
00:01:06,360 --> 00:01:09,479
what<font color="#E5E5E5"> are we going to talk about</font><font color="#CCCCCC"> today</font>

30
00:01:07,680 --> 00:01:12,299
I'm trying to visually break it down for

31
00:01:09,479 --> 00:01:14,039
you into three different groups first of

32
00:01:12,299 --> 00:01:16,079
all by show of hands who has heard of

33
00:01:14,040 --> 00:01:19,110
app sensor before and knows<font color="#CCCCCC"> what it is</font>

34
00:01:16,079 --> 00:01:20,309
cool alright so the first circle over

35
00:01:19,110 --> 00:01:21,659
there<font color="#E5E5E5"> we'll go</font><font color="#CCCCCC"> through rather quick I</font>

36
00:01:20,310 --> 00:01:23,280
just want to<font color="#E5E5E5"> make sure if people had no</font>

37
00:01:21,659 --> 00:01:24,689
idea what ab sensor was we at least want

38
00:01:23,280 --> 00:01:27,180
<font color="#E5E5E5">to catch them up a little bit before</font><font color="#CCCCCC"> we</font>

39
00:01:24,689 --> 00:01:29,639
dive in an implementation of pieces of

40
00:01:27,180 --> 00:01:30,960
<font color="#E5E5E5">it the little circle on the right we're</font>

41
00:01:29,640 --> 00:01:33,420
going<font color="#E5E5E5"> to talk a little bit about the</font>

42
00:01:30,960 --> 00:01:36,059
idea<font color="#CCCCCC"> of absence or detection points and</font>

43
00:01:33,420 --> 00:01:37,829
doing response actions doing it inside

44
00:01:36,060 --> 00:01:39,479
the code which is<font color="#E5E5E5"> what absence or</font>

45
00:01:37,829 --> 00:01:41,939
promotes and<font color="#E5E5E5"> I promote that as well but</font>

46
00:01:39,479 --> 00:01:43,020
sometimes you may be can't do that so if

47
00:01:41,939 --> 00:01:44,850
you want<font color="#E5E5E5"> to try and implement these</font>

48
00:01:43,020 --> 00:01:46,770
externally to the code what are the pros

49
00:01:44,850 --> 00:01:48,419
and<font color="#E5E5E5"> cons of doing that just to get a</font>

50
00:01:46,770 --> 00:01:50,820
level set to make sure you're not<font color="#E5E5E5"> having</font>

51
00:01:48,420 --> 00:01:52,649
different expectations and then finally

52
00:01:50,820 --> 00:01:54,898
down at the bottom I want to show it's

53
00:01:52,649 --> 00:01:56,850
<font color="#E5E5E5">actually an effort that's underway right</font>

54
00:01:54,899 --> 00:01:58,560
now it's<font color="#CCCCCC"> not complete yet of what we're</font>

55
00:01:56,850 --> 00:01:59,788
<font color="#CCCCCC">doing is taking these detection points</font>

56
00:01:58,560 --> 00:02:02,039
that we're talking<font color="#E5E5E5"> about from app sensor</font>

57
00:01:59,789 --> 00:02:04,289
and implementing as many as we can

58
00:02:02,039 --> 00:02:05,999
within modsecurity so external to the

59
00:02:04,289 --> 00:02:07,679
code so we'll run through some examples

60
00:02:05,999 --> 00:02:09,658
of how we've<font color="#CCCCCC"> been doing that where we're</font>

61
00:02:07,679 --> 00:02:11,450
at and if anybody has any interest in

62
00:02:09,658 --> 00:02:13,440
helping out afterwards just<font color="#E5E5E5"> let me know</font>

63
00:02:11,450 --> 00:02:16,619
<font color="#CCCCCC">okay so at</font>

64
00:02:13,440 --> 00:02:18,840
what is it the<font color="#E5E5E5"> best way to look at this</font>

65
00:02:16,620 --> 00:02:22,020
from a real world analogy perspective is

66
00:02:18,840 --> 00:02:23,280
try<font color="#CCCCCC"> and look at a bank and looking here</font>

67
00:02:22,020 --> 00:02:25,380
kind of the schematics right the

68
00:02:23,280 --> 00:02:26,700
overview on the<font color="#CCCCCC"> right hand side are all</font>

69
00:02:25,380 --> 00:02:29,280
sorts of different security controls

70
00:02:26,700 --> 00:02:30,750
that you should<font color="#E5E5E5"> have right and if you</font>

71
00:02:29,280 --> 00:02:32,370
look<font color="#CCCCCC"> around you can see</font><font color="#E5E5E5"> of course you</font>

72
00:02:30,750 --> 00:02:33,720
have the armed guards<font color="#E5E5E5"> coming in you know</font>

73
00:02:32,370 --> 00:02:35,760
guarding the money as it's coming in

74
00:02:33,720 --> 00:02:37,050
going out you have police down at the

75
00:02:35,760 --> 00:02:39,239
bottom right if there's<font color="#E5E5E5"> a problem you</font>

76
00:02:37,050 --> 00:02:41,970
step on<font color="#E5E5E5"> that silent alarm basically</font>

77
00:02:39,240 --> 00:02:43,500
incident response right coming the front

78
00:02:41,970 --> 00:02:45,210
doors are guarded in such a way right

79
00:02:43,500 --> 00:02:46,830
they<font color="#CCCCCC"> can be locked off you have security</font>

80
00:02:45,210 --> 00:02:48,600
cameras scrolling around I mean all

81
00:02:46,830 --> 00:02:51,780
these different things make sense right

82
00:02:48,600 --> 00:02:53,010
and in the physical world and often the

83
00:02:51,780 --> 00:02:54,840
upper<font color="#CCCCCC"> right-hand</font><font color="#E5E5E5"> corner there you have a</font>

84
00:02:53,010 --> 00:02:57,690
safe right so the money's<font color="#CCCCCC"> hidden off in</font>

85
00:02:54,840 --> 00:02:59,310
a secure location now the problem<font color="#E5E5E5"> is if</font>

86
00:02:57,690 --> 00:03:00,960
you take this analogy and you try<font color="#E5E5E5"> and</font>

87
00:02:59,310 --> 00:03:02,820
apply it to<font color="#E5E5E5"> web applications</font>

88
00:03:00,960 --> 00:03:05,820
unfortunately most of the ones that are

89
00:03:02,820 --> 00:03:07,680
today it looks<font color="#CCCCCC"> more like this right and</font>

90
00:03:05,820 --> 00:03:10,470
that's the big question like would you

91
00:03:07,680 --> 00:03:12,150
bank here now the problem I think<font color="#E5E5E5"> most</font>

92
00:03:10,470 --> 00:03:13,560
people have is when you go to a site to

93
00:03:12,150 --> 00:03:15,330
purchase a widget or doing whatever

94
00:03:13,560 --> 00:03:16,920
you're doing you<font color="#E5E5E5"> have no idea that this</font>

95
00:03:15,330 --> 00:03:18,270
is the actual schematic of the

96
00:03:16,920 --> 00:03:20,488
application your working life right you

97
00:03:18,270 --> 00:03:21,180
assume it looks like the other<font color="#CCCCCC"> one but</font>

98
00:03:20,489 --> 00:03:23,640
<font color="#E5E5E5">then you have all these different</font>

99
00:03:21,180 --> 00:03:25,140
<font color="#E5E5E5">problems right incident response they</font>

100
00:03:23,640 --> 00:03:26,820
may or may not come it may take<font color="#CCCCCC"> them a</font>

101
00:03:25,140 --> 00:03:30,208
half hour to get there may take them two

102
00:03:26,820 --> 00:03:31,620
days you never know the<font color="#E5E5E5"> security cameras</font>

103
00:03:30,209 --> 00:03:33,750
a lot of times maybe they're pointed

104
00:03:31,620 --> 00:03:35,400
over here away from the doors rightfully

105
00:03:33,750 --> 00:03:37,050
you didn't set them up correctly you

106
00:03:35,400 --> 00:03:38,730
have people<font color="#E5E5E5"> with no training there's</font>

107
00:03:37,050 --> 00:03:40,010
like back doors to get<font color="#E5E5E5"> in the safe I</font>

108
00:03:38,730 --> 00:03:42,119
mean there's all sorts of problems that

109
00:03:40,010 --> 00:03:44,130
looking at this that does not<font color="#CCCCCC"> look like</font>

110
00:03:42,120 --> 00:03:45,480
<font color="#E5E5E5">a place you'd want to bank so it's those</font>

111
00:03:44,130 --> 00:03:47,070
kinds of things that<font color="#CCCCCC"> you need</font><font color="#E5E5E5"> to address</font>

112
00:03:45,480 --> 00:03:49,768
in<font color="#CCCCCC"> your applications to make sure you</font>

113
00:03:47,070 --> 00:03:52,049
have those types of Defense's now

114
00:03:49,769 --> 00:03:53,730
another way<font color="#CCCCCC"> to look at this is I did a</font>

115
00:03:52,050 --> 00:03:55,860
blog post over the summer after going

116
00:03:53,730 --> 00:03:57,929
out for black hat and Def Con in Vegas

117
00:03:55,860 --> 00:04:00,239
and when you're forced to hang out<font color="#CCCCCC"> in a</font>

118
00:03:57,930 --> 00:04:01,680
casino for a few days runs through<font color="#CCCCCC"> your</font>

119
00:04:00,239 --> 00:04:04,140
head about how does this relate to

120
00:04:01,680 --> 00:04:05,400
application security so is interesting

121
00:04:04,140 --> 00:04:08,429
when I was thinking<font color="#CCCCCC"> about it the whole</font>

122
00:04:05,400 --> 00:04:09,600
paradigm of the previous screen<font color="#E5E5E5"> and</font>

123
00:04:08,430 --> 00:04:11,100
everybody talking<font color="#CCCCCC"> about historically</font>

124
00:04:09,600 --> 00:04:13,530
network security how it used<font color="#E5E5E5"> to be the</font>

125
00:04:11,100 --> 00:04:15,000
castle defense right<font color="#CCCCCC"> Network firewalls</font>

126
00:04:13,530 --> 00:04:17,880
close everything off keep the bad guys

127
00:04:15,000 --> 00:04:20,040
out but in today's web apps that really

128
00:04:17,880 --> 00:04:22,200
doesn't apply of course we all know port

129
00:04:20,040 --> 00:04:24,330
80 and 443<font color="#CCCCCC"> they're open unless you</font><font color="#E5E5E5"> have</font>

130
00:04:22,200 --> 00:04:25,979
specific types of you know application

131
00:04:24,330 --> 00:04:26,520
layer inspection firewalls they just let

132
00:04:25,979 --> 00:04:29,310
<font color="#E5E5E5">that stuff for</font>

133
00:04:26,520 --> 00:04:30,990
so you can't just<font color="#E5E5E5"> keep bad guys out so</font>

134
00:04:29,310 --> 00:04:33,870
what I thought was interesting is how do

135
00:04:30,990 --> 00:04:36,120
casinos do<font color="#E5E5E5"> security versus what we just</font>

136
00:04:33,870 --> 00:04:38,009
saw with the bank right because when you

137
00:04:36,120 --> 00:04:39,150
<font color="#CCCCCC">think about it a casino isn't standing</font>

138
00:04:38,009 --> 00:04:41,490
there at<font color="#CCCCCC"> the front</font><font color="#E5E5E5"> door and every person</font>

139
00:04:39,150 --> 00:04:43,378
coming in<font color="#E5E5E5"> doing ID checks and like your</font>

140
00:04:41,490 --> 00:04:46,229
whole TSA kinds of things<font color="#E5E5E5"> they let</font>

141
00:04:43,379 --> 00:04:47,970
everybody in but they've instrumented

142
00:04:46,229 --> 00:04:50,818
their architecture right they have the

143
00:04:47,970 --> 00:04:52,650
smoke cameras everywhere everybody's

144
00:04:50,819 --> 00:04:55,050
trained appropriately to know when

145
00:04:52,650 --> 00:04:56,818
processes aren't working right they have

146
00:04:55,050 --> 00:04:58,680
incident response right happens<font color="#E5E5E5"> quickly</font>

147
00:04:56,819 --> 00:05:02,250
maybe it's happened to us some of<font color="#E5E5E5"> you</font>

148
00:04:58,680 --> 00:05:03,780
before right cattle prod take you out so

149
00:05:02,250 --> 00:05:05,789
it's<font color="#CCCCCC"> just interesting looking at that to</font>

150
00:05:03,780 --> 00:05:07,530
say hey it seems<font color="#CCCCCC"> to</font><font color="#E5E5E5"> me that casino</font>

151
00:05:05,789 --> 00:05:09,000
security and surveillance actually

152
00:05:07,530 --> 00:05:10,318
applies a lot more<font color="#E5E5E5"> to most of the web</font>

153
00:05:09,000 --> 00:05:12,330
apps that are running today so you<font color="#CCCCCC"> can</font>

154
00:05:10,319 --> 00:05:14,669
try<font color="#E5E5E5"> and take some lessons learned how do</font>

155
00:05:12,330 --> 00:05:16,469
they do security one of the<font color="#E5E5E5"> things that</font>

156
00:05:14,669 --> 00:05:18,930
<font color="#E5E5E5">was interesting and researching this</font>

157
00:05:16,470 --> 00:05:21,330
just a little<font color="#CCCCCC"> bit is gaming commissions</font>

158
00:05:18,930 --> 00:05:23,370
and casinos right they have very

159
00:05:21,330 --> 00:05:25,800
specific prescriptive advice scuze me

160
00:05:23,370 --> 00:05:27,419
saying<font color="#CCCCCC"> okay if you're setting up cameras</font>

161
00:05:25,800 --> 00:05:29,039
here's like one standard<font color="#CCCCCC"> two</font>

162
00:05:27,419 --> 00:05:32,310
<font color="#CCCCCC">requirements</font><font color="#E5E5E5"> surveillance coverage table</font>

163
00:05:29,039 --> 00:05:33,568
game very very specific right go here if

164
00:05:32,310 --> 00:05:35,310
you're running a table game you have to

165
00:05:33,569 --> 00:05:36,750
do these<font color="#E5E5E5"> kinds of things you</font><font color="#CCCCCC"> have to</font>

166
00:05:35,310 --> 00:05:38,909
make sure your camera can see every

167
00:05:36,750 --> 00:05:40,530
player is cards okay make sure if

168
00:05:38,909 --> 00:05:41,880
they're switching stuff around gotta be

169
00:05:40,530 --> 00:05:44,309
able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> see chips you</font><font color="#CCCCCC"> have to go watch</font>

170
00:05:41,880 --> 00:05:46,229
the dealer very prescriptive so you know

171
00:05:44,310 --> 00:05:47,940
if they go in<font color="#CCCCCC"> and get audited</font><font color="#E5E5E5"> and check</font>

172
00:05:46,229 --> 00:05:50,130
it they don't capture that you got a

173
00:05:47,940 --> 00:05:52,319
problem so when looking at all<font color="#E5E5E5"> this I</font>

174
00:05:50,130 --> 00:05:54,509
was like wouldn't that<font color="#CCCCCC"> be great if they</font>

175
00:05:52,319 --> 00:05:57,659
have that<font color="#E5E5E5"> type of prescriptive advice</font>

176
00:05:54,509 --> 00:05:59,849
for applications other than something

177
00:05:57,659 --> 00:06:01,500
like PCI which is probably this close as

178
00:05:59,849 --> 00:06:04,319
there is it doesn't get<font color="#E5E5E5"> to this level</font>

179
00:06:01,500 --> 00:06:05,279
right section six and six dot six and

180
00:06:04,319 --> 00:06:07,560
<font color="#E5E5E5">all those things it's talking</font>

181
00:06:05,279 --> 00:06:09,599
<font color="#E5E5E5">generically Oh block cross site</font>

182
00:06:07,560 --> 00:06:11,669
scripting does it tell you how doesn't

183
00:06:09,599 --> 00:06:13,469
<font color="#CCCCCC">tell you where so I'm like that</font><font color="#E5E5E5"> would be</font>

184
00:06:11,669 --> 00:06:15,990
<font color="#E5E5E5">really</font><font color="#CCCCCC"> cool to have</font><font color="#E5E5E5"> something</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> that</font>

185
00:06:13,469 --> 00:06:19,380
so that's<font color="#CCCCCC"> really what app sensor is</font>

186
00:06:15,990 --> 00:06:20,940
aiming for a project app center a wasp

187
00:06:19,380 --> 00:06:22,979
it most<font color="#E5E5E5"> people</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> their hands</font><font color="#CCCCCC"> up so</font>

188
00:06:20,940 --> 00:06:25,500
you know<font color="#E5E5E5"> where to find it this was a</font>

189
00:06:22,979 --> 00:06:27,568
<font color="#E5E5E5">recent article that Colin Watson who's</font>

190
00:06:25,500 --> 00:06:29,789
in here he's a help<font color="#CCCCCC"> and Project Lead</font>

191
00:06:27,569 --> 00:06:33,569
they<font color="#E5E5E5"> help to do this article</font><font color="#CCCCCC"> for is it</font>

192
00:06:29,789 --> 00:06:34,800
is it crosstalk crosstalk but you can go

193
00:06:33,569 --> 00:06:35,940
out<font color="#CCCCCC"> and check if you want to read up on</font>

194
00:06:34,800 --> 00:06:38,070
the full article it's really good

195
00:06:35,940 --> 00:06:38,340
especially like elevator pitch kind<font color="#E5E5E5"> of</font>

196
00:06:38,070 --> 00:06:39,659
<font color="#E5E5E5">stuff</font>

197
00:06:38,340 --> 00:06:41,070
if you want to give this<font color="#E5E5E5"> to management</font>

198
00:06:39,660 --> 00:06:43,500
or somebody it's a real good overview

199
00:06:41,070 --> 00:06:45,240
good read but<font color="#E5E5E5"> it talks about this</font>

200
00:06:43,500 --> 00:06:49,199
creating attack of where applications

201
00:06:45,240 --> 00:06:50,820
and real-time defense<font color="#E5E5E5"> okay so that's</font>

202
00:06:49,199 --> 00:06:52,410
also a piece that<font color="#CCCCCC"> I</font><font color="#E5E5E5"> think is missing in</font>

203
00:06:50,820 --> 00:06:54,300
a lot<font color="#E5E5E5"> of applications maybe there's</font>

204
00:06:52,410 --> 00:06:56,250
logging<font color="#E5E5E5"> that's being done if developers</font>

205
00:06:54,300 --> 00:06:58,650
are writing exceptions and things like

206
00:06:56,250 --> 00:07:00,330
that but<font color="#CCCCCC"> they're not really monitoring</font>

207
00:06:58,650 --> 00:07:02,130
for like trends or when things are

208
00:07:00,330 --> 00:07:04,289
happening and how do you respond to that

209
00:07:02,130 --> 00:07:05,580
I mean it's great if you flag that

210
00:07:04,290 --> 00:07:07,110
somebody put something in a field they

211
00:07:05,580 --> 00:07:09,000
shouldn't but if they're repeatedly

212
00:07:07,110 --> 00:07:10,169
<font color="#E5E5E5">doing that trying to break in you maybe</font>

213
00:07:09,000 --> 00:07:14,910
want to take some different actions

214
00:07:10,169 --> 00:07:16,380
against that user so the absence of

215
00:07:14,910 --> 00:07:18,090
project if<font color="#E5E5E5"> you want to go check out</font>

216
00:07:16,380 --> 00:07:20,669
there's all sorts of stuff you can

217
00:07:18,090 --> 00:07:22,349
download we had the absence or summit

218
00:07:20,669 --> 00:07:24,479
here on Wednesday there's like a cool

219
00:07:22,350 --> 00:07:26,220
promo video they're working on there's a

220
00:07:24,479 --> 00:07:27,510
demo site you can go play<font color="#E5E5E5"> with so</font>

221
00:07:26,220 --> 00:07:29,940
there's a lot of cool stuff if you want

222
00:07:27,510 --> 00:07:31,830
to go read about it one thing<font color="#E5E5E5"> that's a</font>

223
00:07:29,940 --> 00:07:35,490
bit interesting if anybody was in here

224
00:07:31,830 --> 00:07:37,198
previously<font color="#E5E5E5"> Jason Lee gave the talk about</font>

225
00:07:35,490 --> 00:07:40,260
projects and stuff is like 15 minute

226
00:07:37,199 --> 00:07:43,460
talk<font color="#E5E5E5"> AB sensor is like some other</font>

227
00:07:40,260 --> 00:07:46,139
projects at a wasp where it's not just

228
00:07:43,460 --> 00:07:47,280
documentation or tools or code it

229
00:07:46,139 --> 00:07:48,960
doesn't fit neatly in there cuz it's

230
00:07:47,280 --> 00:07:50,849
really a<font color="#E5E5E5"> couple pieces there's</font>

231
00:07:48,960 --> 00:07:52,469
definitely a documentation piece which

232
00:07:50,850 --> 00:07:54,630
we'll go over briefly here about the

233
00:07:52,470 --> 00:07:56,610
detection points but then there is a

234
00:07:54,630 --> 00:07:57,930
code portion right because most people

235
00:07:56,610 --> 00:08:00,210
like oh there's a great idea i'm going

236
00:07:57,930 --> 00:08:02,130
running java I need some code snippets

237
00:08:00,210 --> 00:08:04,799
right help<font color="#E5E5E5"> me to figure out where I hook</font>

238
00:08:02,130 --> 00:08:08,909
these in so it's both a documentation

239
00:08:04,800 --> 00:08:13,229
project and a code project so detection

240
00:08:08,910 --> 00:08:14,370
points what are these really the way

241
00:08:13,229 --> 00:08:16,020
<font color="#CCCCCC">that I would explain this if you were</font>

242
00:08:14,370 --> 00:08:17,430
<font color="#E5E5E5">going to talk to developers really and</font>

243
00:08:16,020 --> 00:08:19,460
sit down at the table and<font color="#CCCCCC"> try and</font><font color="#E5E5E5"> you</font>

244
00:08:17,430 --> 00:08:21,900
know figure out how to implement this

245
00:08:19,460 --> 00:08:23,460
all the places in<font color="#E5E5E5"> the code</font><font color="#CCCCCC"> that they're</font>

246
00:08:21,900 --> 00:08:25,440
probably already going to<font color="#E5E5E5"> be writing</font>

247
00:08:23,460 --> 00:08:27,780
exceptions for you know where they're

248
00:08:25,440 --> 00:08:30,090
checking stuff right if this boolean yes

249
00:08:27,780 --> 00:08:31,380
or no then do something and are<font color="#CCCCCC"> probably</font>

250
00:08:30,090 --> 00:08:33,929
already going<font color="#E5E5E5"> in there to write an</font>

251
00:08:31,380 --> 00:08:37,200
exception the issue from<font color="#CCCCCC"> my</font><font color="#E5E5E5"> perspective</font>

252
00:08:33,929 --> 00:08:39,179
is AB sensor is getting developers to

253
00:08:37,200 --> 00:08:41,400
instrument their code properly so that

254
00:08:39,179 --> 00:08:43,260
when its run in production not<font color="#E5E5E5"> by then</font>

255
00:08:41,400 --> 00:08:45,329
right<font color="#E5E5E5"> by operations you're giving them</font>

256
00:08:43,260 --> 00:08:47,370
operations intelligence to know that

257
00:08:45,330 --> 00:08:48,930
something bad is going on<font color="#E5E5E5"> right it's not</font>

258
00:08:47,370 --> 00:08:50,440
something just oh we've<font color="#CCCCCC"> had a bunch of</font>

259
00:08:48,930 --> 00:08:52,449
exceptions today well what are they

260
00:08:50,440 --> 00:08:54,790
I don't know it can<font color="#E5E5E5"> be more prescriptive</font>

261
00:08:52,450 --> 00:08:57,370
here and say oh this looks like this<font color="#E5E5E5"> is</font>

262
00:08:54,790 --> 00:08:59,110
SQL injection or you know somebody's

263
00:08:57,370 --> 00:09:01,090
tampering with this hidden field it's a

264
00:08:59,110 --> 00:09:03,880
<font color="#E5E5E5">little bit more intelligence for ops</font>

265
00:09:01,090 --> 00:09:05,560
really to know what's happening this is

266
00:09:03,880 --> 00:09:07,420
one way<font color="#CCCCCC"> to look at detection points and</font>

267
00:09:05,560 --> 00:09:08,979
kind<font color="#E5E5E5"> of break them down on the</font><font color="#CCCCCC"> left-hand</font>

268
00:09:07,420 --> 00:09:11,290
side you can see a lot of these parent

269
00:09:08,980 --> 00:09:14,320
categories are more traditional kind<font color="#CCCCCC"> of</font>

270
00:09:11,290 --> 00:09:16,540
signature based you have<font color="#E5E5E5"> request</font>

271
00:09:14,320 --> 00:09:18,070
exceptions authentication<font color="#E5E5E5"> session all</font>

272
00:09:16,540 --> 00:09:20,829
those there's some newer ones down there

273
00:09:18,070 --> 00:09:22,060
at the bottom honey trap and then the

274
00:09:20,830 --> 00:09:24,940
<font color="#CCCCCC">other one which is</font><font color="#E5E5E5"> kind of</font><font color="#CCCCCC"> cool is more</font>

275
00:09:22,060 --> 00:09:26,829
behavioral so we all know<font color="#CCCCCC"> about</font>

276
00:09:24,940 --> 00:09:28,480
cross-site scripting SQL injection yes

277
00:09:26,830 --> 00:09:30,820
those need to be dealt<font color="#E5E5E5"> with but then</font>

278
00:09:28,480 --> 00:09:33,610
other sorts of maybe external data feeds

279
00:09:30,820 --> 00:09:35,230
that<font color="#E5E5E5"> you can correlate and discussing</font>

280
00:09:33,610 --> 00:09:37,540
this as well app sensor is kind of a

281
00:09:35,230 --> 00:09:40,630
good blend between traditional maybe<font color="#E5E5E5"> IDs</font>

282
00:09:37,540 --> 00:09:42,069
IPS<font color="#E5E5E5"> web and web fraud detection it's</font>

283
00:09:40,630 --> 00:09:44,050
kind of putting those two together and

284
00:09:42,070 --> 00:09:48,550
then instrumenting your code to do all

285
00:09:44,050 --> 00:09:50,530
that<font color="#E5E5E5"> kind of stuff response actions is</font>

286
00:09:48,550 --> 00:09:52,180
kind of the flip side of<font color="#E5E5E5"> this and this</font>

287
00:09:50,530 --> 00:09:54,640
is<font color="#CCCCCC"> really where I think extending out</font>

288
00:09:52,180 --> 00:09:56,530
what developers are doing already<font color="#E5E5E5"> really</font>

289
00:09:54,640 --> 00:09:58,900
helps in operations for incident

290
00:09:56,530 --> 00:10:00,339
response on the<font color="#CCCCCC"> left-hand side you have</font>

291
00:09:58,900 --> 00:10:02,230
all these different<font color="#CCCCCC"> actions and you can</font>

292
00:10:00,340 --> 00:10:03,250
pick and choose maybe if one thing

293
00:10:02,230 --> 00:10:05,850
happens you want to do something

294
00:10:03,250 --> 00:10:08,680
specific log it or deny<font color="#CCCCCC"> the connection</font>

295
00:10:05,850 --> 00:10:10,270
if a group<font color="#E5E5E5"> of things happen maybe you</font>

296
00:10:08,680 --> 00:10:12,339
want to react differently you know maybe

297
00:10:10,270 --> 00:10:14,050
at<font color="#E5E5E5"> that point you say hey if there's</font>

298
00:10:12,340 --> 00:10:15,910
been this many alerts in a<font color="#CCCCCC"> certain time</font>

299
00:10:14,050 --> 00:10:17,589
frame now we<font color="#CCCCCC"> actually want</font><font color="#E5E5E5"> to get a</font>

300
00:10:15,910 --> 00:10:20,860
little<font color="#E5E5E5"> more</font><font color="#CCCCCC"> aggressive and forcefully</font>

301
00:10:17,590 --> 00:10:22,690
log that user out or lock their account

302
00:10:20,860 --> 00:10:24,880
for a period of time there's also two

303
00:10:22,690 --> 00:10:26,530
different ways you can respond but<font color="#E5E5E5"> it's</font>

304
00:10:24,880 --> 00:10:28,090
up<font color="#E5E5E5"> to you</font><font color="#CCCCCC"> to figure out working through</font>

305
00:10:26,530 --> 00:10:30,040
you know with impose<font color="#CCCCCC"> sack and different</font>

306
00:10:28,090 --> 00:10:32,980
groups<font color="#E5E5E5"> policy wise how do you want to</font>

307
00:10:30,040 --> 00:10:34,089
react under scenario a scenario B but

308
00:10:32,980 --> 00:10:40,000
there's a lot of different<font color="#CCCCCC"> ways that you</font>

309
00:10:34,089 --> 00:10:42,400
can do this so one example taking this

310
00:10:40,000 --> 00:10:45,370
again from<font color="#E5E5E5"> some other slides that were</font>

311
00:10:42,400 --> 00:10:47,410
out there already for app sensor if

312
00:10:45,370 --> 00:10:50,050
you're going to use<font color="#E5E5E5"> this let's say also</font>

313
00:10:47,410 --> 00:10:52,719
with<font color="#CCCCCC"> e safi you can easily piggyback on</font>

314
00:10:50,050 --> 00:10:54,400
top of these safi code & hook n this is

315
00:10:52,720 --> 00:10:56,350
<font color="#E5E5E5">showing here just you know number one</font>

316
00:10:54,400 --> 00:10:57,610
check for maliciousness these sappy is

317
00:10:56,350 --> 00:10:59,470
probably already doing<font color="#CCCCCC"> that for most of</font>

318
00:10:57,610 --> 00:11:01,420
those<font color="#E5E5E5"> cases then you can just add in</font>

319
00:10:59,470 --> 00:11:03,710
another line another hook that would

320
00:11:01,420 --> 00:11:07,319
then call up a detection

321
00:11:03,710 --> 00:11:08,640
so this type of detailed logging if

322
00:11:07,320 --> 00:11:10,680
you're feeding it out to maybe other

323
00:11:08,640 --> 00:11:12,300
systems like if you have sim and a knock

324
00:11:10,680 --> 00:11:13,709
and a sock and people<font color="#E5E5E5"> really monitoring</font>

325
00:11:12,300 --> 00:11:15,290
all this stuff that's<font color="#CCCCCC"> really going to</font>

326
00:11:13,710 --> 00:11:18,990
help them<font color="#CCCCCC"> to understand what's happening</font>

327
00:11:15,290 --> 00:11:20,910
so looking in the code that's<font color="#E5E5E5"> the ideal</font>

328
00:11:18,990 --> 00:11:22,560
place<font color="#E5E5E5"> to do all of this right because</font>

329
00:11:20,910 --> 00:11:25,980
you have all the data you<font color="#E5E5E5"> need to make</font>

330
00:11:22,560 --> 00:11:28,949
these decisions but inevitably you get

331
00:11:25,980 --> 00:11:31,530
to the issue of what if I have

332
00:11:28,950 --> 00:11:33,240
applications that I can't do<font color="#CCCCCC"> this</font><font color="#E5E5E5"> to it</font>

333
00:11:31,530 --> 00:11:34,980
we're responsible for<font color="#E5E5E5"> them but we didn't</font>

334
00:11:33,240 --> 00:11:37,140
write the code right it's<font color="#E5E5E5"> kind of the</font>

335
00:11:34,980 --> 00:11:38,340
<font color="#E5E5E5">black box it's a third-party app but I</font>

336
00:11:37,140 --> 00:11:40,080
still want appsense or type

337
00:11:38,340 --> 00:11:41,130
functionality what do<font color="#CCCCCC"> I do so that's</font>

338
00:11:40,080 --> 00:11:42,810
where<font color="#E5E5E5"> I</font><font color="#CCCCCC"> want to</font><font color="#E5E5E5"> talk a little bit about</font>

339
00:11:41,130 --> 00:11:44,370
doing these detection points and

340
00:11:42,810 --> 00:11:47,250
responses inside the code versus

341
00:11:44,370 --> 00:11:51,180
external and things to consider with

342
00:11:47,250 --> 00:11:53,700
either choice that you make so inside

343
00:11:51,180 --> 00:11:57,209
the code it is ideally it is the best

344
00:11:53,700 --> 00:11:58,740
place to do this because specifically

345
00:11:57,210 --> 00:12:00,900
talking from my background which is

346
00:11:58,740 --> 00:12:02,850
<font color="#CCCCCC">where that firewalls trying to do this</font>

347
00:12:00,900 --> 00:12:06,959
externally this is the<font color="#CCCCCC"> perfect example</font>

348
00:12:02,850 --> 00:12:09,990
of where that model fails right external

349
00:12:06,960 --> 00:12:12,030
<font color="#E5E5E5">devices really have no concept of access</font>

350
00:12:09,990 --> 00:12:15,780
control and authorization and this is

351
00:12:12,030 --> 00:12:17,640
the classic<font color="#CCCCCC"> example ID equals 100 to</font>

352
00:12:15,780 --> 00:12:19,500
your authorized to see you whatever you

353
00:12:17,640 --> 00:12:21,480
are looking<font color="#E5E5E5"> at you know your pay stub or</font>

354
00:12:19,500 --> 00:12:23,970
whatever but if you just toggle that to

355
00:12:21,480 --> 00:12:25,860
a different ID and it shows you somebody

356
00:12:23,970 --> 00:12:27,300
<font color="#E5E5E5">else's an external device is not going</font>

357
00:12:25,860 --> 00:12:28,710
to<font color="#E5E5E5"> know that right it's not an injection</font>

358
00:12:27,300 --> 00:12:29,969
attack I don't see anything malicious

359
00:12:28,710 --> 00:12:31,860
you're just looking at something you're

360
00:12:29,970 --> 00:12:33,390
not supposed to look at so keep that in

361
00:12:31,860 --> 00:12:34,770
mind<font color="#E5E5E5"> that if you're</font><font color="#CCCCCC"> going to</font><font color="#E5E5E5"> try and do</font>

362
00:12:33,390 --> 00:12:36,360
these detection points or certain

363
00:12:34,770 --> 00:12:37,920
categories in these detection points

364
00:12:36,360 --> 00:12:40,320
that you might not<font color="#CCCCCC"> even be able</font><font color="#E5E5E5"> to do</font>

365
00:12:37,920 --> 00:12:42,390
but that ends up<font color="#CCCCCC"> being a question of</font>

366
00:12:40,320 --> 00:12:44,430
risk<font color="#CCCCCC"> okay that</font><font color="#E5E5E5"> the business has to</font>

367
00:12:42,390 --> 00:12:46,860
decide<font color="#CCCCCC"> on I was</font><font color="#E5E5E5"> talking with somebody</font>

368
00:12:44,430 --> 00:12:48,000
earlier about this as well and the

369
00:12:46,860 --> 00:12:50,880
<font color="#E5E5E5">example would be if you had a group of</font>

370
00:12:48,000 --> 00:12:52,890
applications maybe half of them you have

371
00:12:50,880 --> 00:12:54,620
the developers you develop the code you

372
00:12:52,890 --> 00:12:57,060
go and you do all this the other group

373
00:12:54,620 --> 00:12:58,680
maybe you can't do it<font color="#E5E5E5"> all but externally</font>

374
00:12:57,060 --> 00:12:59,880
you could try and<font color="#E5E5E5"> put these detection</font>

375
00:12:58,680 --> 00:13:05,339
points in and<font color="#E5E5E5"> get some of this</font>

376
00:12:59,880 --> 00:13:07,710
protection<font color="#E5E5E5"> okay so outside of the code</font>

377
00:13:05,339 --> 00:13:09,240
what are some challenges but<font color="#CCCCCC"> we</font><font color="#E5E5E5"> just</font>

378
00:13:07,710 --> 00:13:11,339
highlighted one of those about<font color="#E5E5E5"> the whole</font>

379
00:13:09,240 --> 00:13:15,960
context with authorization and access

380
00:13:11,339 --> 00:13:16,780
control some other issues<font color="#E5E5E5"> are if you</font>

381
00:13:15,960 --> 00:13:19,180
have including

382
00:13:16,780 --> 00:13:21,339
issues anybody's played around at all

383
00:13:19,180 --> 00:13:24,189
between the differences with PHP and asp

384
00:13:21,340 --> 00:13:26,440
and<font color="#CCCCCC"> java and all of that</font><font color="#E5E5E5"> certainly</font><font color="#CCCCCC"> as</font>

385
00:13:24,190 --> 00:13:29,050
they handle different encodings some

386
00:13:26,440 --> 00:13:31,000
nuances there another one<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we talked</font>

387
00:13:29,050 --> 00:13:33,609
<font color="#E5E5E5">about at the summit if you've ever heard</font>

388
00:13:31,000 --> 00:13:35,890
of the attack HTTP HTTP parameter

389
00:13:33,610 --> 00:13:37,660
pollution right different platforms

390
00:13:35,890 --> 00:13:39,460
handle it differently if<font color="#CCCCCC"> you have</font>

391
00:13:37,660 --> 00:13:42,120
multiple parameters that have the exact

392
00:13:39,460 --> 00:13:45,250
<font color="#CCCCCC">same</font><font color="#E5E5E5"> name when</font><font color="#CCCCCC"> they make it server-side</font>

393
00:13:42,120 --> 00:13:46,990
like a SP for instance will take all of

394
00:13:45,250 --> 00:13:48,100
those payloads condense them into one

395
00:13:46,990 --> 00:13:50,110
<font color="#CCCCCC">and then it just shows one parameter</font>

396
00:13:48,100 --> 00:13:52,660
that's an interesting nuance to

397
00:13:50,110 --> 00:13:55,450
understand<font color="#E5E5E5"> it says you can miss that if</font>

398
00:13:52,660 --> 00:13:57,010
you're looking for certain attacks so

399
00:13:55,450 --> 00:13:58,690
there<font color="#CCCCCC"> are some good things and</font><font color="#E5E5E5"> I'll</font>

400
00:13:57,010 --> 00:14:00,760
highlight here<font color="#E5E5E5"> where an external device</font>

401
00:13:58,690 --> 00:14:02,770
can actually excel at giving<font color="#CCCCCC"> you some</font>

402
00:14:00,760 --> 00:14:04,270
protection but we<font color="#CCCCCC"> just</font><font color="#E5E5E5"> want to make sure</font>

403
00:14:02,770 --> 00:14:06,370
you're<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> a good compare and contrast</font>

404
00:14:04,270 --> 00:14:10,720
here you know this is<font color="#E5E5E5"> obviously on an</font>

405
00:14:06,370 --> 00:14:13,930
app my<font color="#E5E5E5"> apt basis so this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the big</font>

406
00:14:10,720 --> 00:14:15,610
issue and why I kind of decided to<font color="#E5E5E5"> try</font>

407
00:14:13,930 --> 00:14:17,979
and<font color="#E5E5E5"> take some that app sensor detection</font>

408
00:14:15,610 --> 00:14:20,020
points and put them into the core<font color="#E5E5E5"> rule</font>

409
00:14:17,980 --> 00:14:21,160
<font color="#E5E5E5">set at omas that's because you have a</font>

410
00:14:20,020 --> 00:14:24,130
<font color="#E5E5E5">lot of</font><font color="#CCCCCC"> people that</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> using third-party</font>

411
00:14:21,160 --> 00:14:25,630
apps and they're like oh crap there's<font color="#E5E5E5"> a</font>

412
00:14:24,130 --> 00:14:27,490
new vulnerability just released for

413
00:14:25,630 --> 00:14:28,840
whatever and we're<font color="#CCCCCC"> waiting for the</font>

414
00:14:27,490 --> 00:14:30,010
vendor and they're telling<font color="#CCCCCC"> us they're</font>

415
00:14:28,840 --> 00:14:31,720
going to get<font color="#E5E5E5"> us something whenever but</font>

416
00:14:30,010 --> 00:14:33,819
in the meantime you're exposed you know

417
00:14:31,720 --> 00:14:34,810
you're exposed and a bad guys now know

418
00:14:33,820 --> 00:14:36,790
you're exposed right because they

419
00:14:34,810 --> 00:14:37,989
monitor all those st. mailing<font color="#CCCCCC"> lists so</font>

420
00:14:36,790 --> 00:14:41,980
that's the idea you want to get some

421
00:14:37,990 --> 00:14:44,940
protection in as<font color="#E5E5E5"> soon as you can the</font>

422
00:14:41,980 --> 00:14:48,430
other thing to highlight here is a

423
00:14:44,940 --> 00:14:50,440
platform issues so if anybody remembers

424
00:14:48,430 --> 00:14:52,300
over the past year or so a lot of the

425
00:14:50,440 --> 00:14:54,340
slow denial of service you know

426
00:14:52,300 --> 00:14:56,530
targeting the web layer this is actually

427
00:14:54,340 --> 00:14:59,020
a tool that a lost<font color="#E5E5E5"> helped to develop so</font>

428
00:14:56,530 --> 00:15:01,900
you could test your applications part of

429
00:14:59,020 --> 00:15:05,079
this<font color="#E5E5E5"> was based on if you read our snakes</font>

430
00:15:01,900 --> 00:15:06,970
tool and stuffy<font color="#E5E5E5"> ad slow loris the idea</font>

431
00:15:05,080 --> 00:15:08,680
is as opposed to traditional network

432
00:15:06,970 --> 00:15:10,690
flooding or in this case you're not

433
00:15:08,680 --> 00:15:12,849
sending hundreds of thousands of web

434
00:15:10,690 --> 00:15:14,680
requests from a botnet you can send

435
00:15:12,850 --> 00:15:16,390
<font color="#CCCCCC">requests from a much smaller group of</font>

436
00:15:14,680 --> 00:15:18,790
servers or actually<font color="#CCCCCC"> you can do with a</font>

437
00:15:16,390 --> 00:15:21,699
few clients you open up that three-way

438
00:15:18,790 --> 00:15:23,860
handshake you send part of a web request

439
00:15:21,700 --> 00:15:26,530
but in this case<font color="#CCCCCC"> you don't send all the</font>

440
00:15:23,860 --> 00:15:28,330
headers right it's HTTP standard has to

441
00:15:26,530 --> 00:15:30,189
be<font color="#E5E5E5"> followed by control line feeds before</font>

442
00:15:28,330 --> 00:15:32,680
the web services<font color="#E5E5E5"> oh I got everything</font>

443
00:15:30,190 --> 00:15:35,230
well based on the timeout settings on

444
00:15:32,680 --> 00:15:37,660
your web server platform and apache by

445
00:15:35,230 --> 00:15:40,570
the way it's five minutes you can send

446
00:15:37,660 --> 00:15:42,579
that and just sit there<font color="#E5E5E5"> and wait every</font>

447
00:15:40,570 --> 00:15:44,620
<font color="#E5E5E5">minute or sell send one more request</font>

448
00:15:42,580 --> 00:15:46,870
header and you perpetually just keep

449
00:15:44,620 --> 00:15:49,000
that open so it's a<font color="#CCCCCC"> very easy way you</font>

450
00:15:46,870 --> 00:15:50,290
can<font color="#E5E5E5"> Doss the web server platform and in</font>

451
00:15:49,000 --> 00:15:52,750
that case<font color="#CCCCCC"> it never even makes it to the</font>

452
00:15:50,290 --> 00:15:54,520
application code so there's certain

453
00:15:52,750 --> 00:15:56,410
scenarios like that where you can't

454
00:15:54,520 --> 00:15:58,300
develop your way out of that<font color="#E5E5E5"> scenario</font>

455
00:15:56,410 --> 00:15:59,920
right so that would be<font color="#E5E5E5"> helpful</font>

456
00:15:58,300 --> 00:16:02,109
externally if you can spot that stuff

457
00:15:59,920 --> 00:16:06,880
and flag it block<font color="#E5E5E5"> it take some sort of</font>

458
00:16:02,110 --> 00:16:09,850
action this is<font color="#E5E5E5"> another interesting</font>

459
00:16:06,880 --> 00:16:12,820
concept talking about implementing these

460
00:16:09,850 --> 00:16:14,560
detection points so if you've been to a

461
00:16:12,820 --> 00:16:16,900
lot of Olaf stuff right<font color="#CCCCCC"> and I know it's</font>

462
00:16:14,560 --> 00:16:20,260
namely developer focused for a lot<font color="#E5E5E5"> of</font>

463
00:16:16,900 --> 00:16:23,020
<font color="#E5E5E5">these</font><font color="#CCCCCC"> things secure coding and E sappy</font>

464
00:16:20,260 --> 00:16:24,700
it makes sense to everybody who's doing

465
00:16:23,020 --> 00:16:26,410
development that if you're getting<font color="#E5E5E5"> let's</font>

466
00:16:24,700 --> 00:16:30,070
say doing input validation for a certain

467
00:16:26,410 --> 00:16:33,000
<font color="#CCCCCC">parameter field to say I can do either</font>

468
00:16:30,070 --> 00:16:34,690
or and or a black list or a white list

469
00:16:33,000 --> 00:16:36,670
ideally you'd want to do positive

470
00:16:34,690 --> 00:16:38,560
security right define a whitelist saying

471
00:16:36,670 --> 00:16:41,170
hey this parameter called product ID

472
00:16:38,560 --> 00:16:43,150
guess what it should only ever be digits

473
00:16:41,170 --> 00:16:45,699
nothing else right if it's anything

474
00:16:43,150 --> 00:16:46,569
besides that just block<font color="#CCCCCC"> it that way you</font>

475
00:16:45,700 --> 00:16:48,760
<font color="#E5E5E5">don't have to worry about cross-site</font>

476
00:16:46,570 --> 00:16:51,160
scripting SQL injection that makes sense

477
00:16:48,760 --> 00:16:52,930
and developers will do that the issue

478
00:16:51,160 --> 00:16:56,709
then is when you start<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get into black</font>

479
00:16:52,930 --> 00:16:58,030
<font color="#E5E5E5">lists like okay could</font><font color="#CCCCCC"> you also go in and</font>

480
00:16:56,710 --> 00:16:59,920
say well if<font color="#E5E5E5"> you see any tick marks just</font>

481
00:16:58,030 --> 00:17:02,319
<font color="#E5E5E5">block it I mean that only really makes</font>

482
00:16:59,920 --> 00:17:05,829
sense if<font color="#CCCCCC"> you can't do a whitelist</font>

483
00:17:02,320 --> 00:17:06,939
inspection now taking us a step<font color="#E5E5E5"> further</font>

484
00:17:05,829 --> 00:17:09,938
though if you're<font color="#E5E5E5"> going to talk about</font>

485
00:17:06,939 --> 00:17:13,260
implementing app sensor we got<font color="#E5E5E5"> another</font>

486
00:17:09,939 --> 00:17:15,550
detection point it's a further

487
00:17:13,260 --> 00:17:17,140
categorization or classification of

488
00:17:15,550 --> 00:17:18,938
something that would fail in this case

489
00:17:17,140 --> 00:17:20,199
<font color="#E5E5E5">you're positive security so you're</font>

490
00:17:18,939 --> 00:17:22,780
<font color="#E5E5E5">already going to throw an exception to</font>

491
00:17:20,199 --> 00:17:25,390
say hey I was expecting digits it's not

492
00:17:22,780 --> 00:17:27,970
digits exception right and<font color="#CCCCCC"> you would log</font>

493
00:17:25,390 --> 00:17:31,570
something this would do another check on

494
00:17:27,970 --> 00:17:33,250
that data to say let's apply a<font color="#CCCCCC"> regex or</font>

495
00:17:31,570 --> 00:17:36,669
<font color="#CCCCCC">something that goes</font><font color="#E5E5E5"> against that payload</font>

496
00:17:33,250 --> 00:17:39,100
and tries<font color="#CCCCCC"> to identify SQL injection okay</font>

497
00:17:36,670 --> 00:17:41,050
now conceptually I think<font color="#CCCCCC"> a Watson's done</font>

498
00:17:39,100 --> 00:17:42,830
a pretty good job of talking to

499
00:17:41,050 --> 00:17:45,289
developers about what SQL<font color="#E5E5E5"> injection</font>

500
00:17:42,830 --> 00:17:47,210
is and how they should build you know

501
00:17:45,289 --> 00:17:49,700
parameterised queries and all that stuff

502
00:17:47,210 --> 00:17:51,380
but<font color="#CCCCCC"> if you ask developers to say we want</font>

503
00:17:49,700 --> 00:17:54,140
you<font color="#E5E5E5"> to implement this detection point</font>

504
00:17:51,380 --> 00:17:56,600
and go off and figure out all the black

505
00:17:54,140 --> 00:17:59,090
list for SQL injection I think that's

506
00:17:56,600 --> 00:18:01,250
asking a little too much right that's

507
00:17:59,090 --> 00:18:03,199
not<font color="#E5E5E5"> their job to keep tabs on every you</font>

508
00:18:01,250 --> 00:18:04,130
<font color="#CCCCCC">know nuance of SQL injection that comes</font>

509
00:18:03,200 --> 00:18:06,500
out they should be<font color="#E5E5E5"> doing positive</font>

510
00:18:04,130 --> 00:18:08,480
security right saying<font color="#E5E5E5"> if we don't have</font>

511
00:18:06,500 --> 00:18:11,510
this input<font color="#CCCCCC"> blocking so this to me</font><font color="#E5E5E5"> is</font>

512
00:18:08,480 --> 00:18:14,870
where you get into if you can have not

513
00:18:11,510 --> 00:18:16,940
internal or external but both working

514
00:18:14,870 --> 00:18:18,229
together is pretty cool concept and

515
00:18:16,940 --> 00:18:22,940
we'll<font color="#E5E5E5"> talk about that here in just a</font>

516
00:18:18,230 --> 00:18:25,929
second so the<font color="#CCCCCC"> OWASP modsecurity core</font>

517
00:18:22,940 --> 00:18:28,100
<font color="#E5E5E5">rule set as I said it's a wats project</font>

518
00:18:25,929 --> 00:18:29,899
go check it out you can download the

519
00:18:28,100 --> 00:18:32,449
rules it's a base set of rules to give

520
00:18:29,899 --> 00:18:34,309
you a base level protection essentially

521
00:18:32,450 --> 00:18:36,230
the idea is you can take<font color="#E5E5E5"> these rules</font>

522
00:18:34,309 --> 00:18:37,970
plug them into any platform it doesn't

523
00:18:36,230 --> 00:18:39,909
<font color="#CCCCCC">matter if</font><font color="#E5E5E5"> you're running PHP or java or</font>

524
00:18:37,970 --> 00:18:41,870
asp net or whatever it<font color="#CCCCCC"> doesn't matter</font>

525
00:18:39,909 --> 00:18:42,950
and you can see some of the bullet

526
00:18:41,870 --> 00:18:45,559
<font color="#E5E5E5">points and some of the stuff we're</font>

527
00:18:42,950 --> 00:18:48,350
looking for its general badness that's

528
00:18:45,559 --> 00:18:50,480
easy to spot a lot of bad clients you

529
00:18:48,350 --> 00:18:51,889
know you check header fields you look

530
00:18:50,480 --> 00:18:53,630
for the<font color="#E5E5E5"> stuff like we're just talking</font>

531
00:18:51,889 --> 00:18:54,979
about cross-site scripting SQL injection

532
00:18:53,630 --> 00:18:59,809
but we have a lot of different<font color="#CCCCCC"> methods</font>

533
00:18:54,980 --> 00:19:02,539
to<font color="#E5E5E5"> detect that so what I want to</font><font color="#CCCCCC"> try and</font>

534
00:18:59,809 --> 00:19:04,100
do was to get more specific<font color="#E5E5E5"> and go</font>

535
00:19:02,539 --> 00:19:06,710
through all of the app sensor detection

536
00:19:04,100 --> 00:19:08,629
points and<font color="#E5E5E5"> then try</font><font color="#CCCCCC"> and take those in my</font>

537
00:19:06,710 --> 00:19:10,880
great a minute so this was actually the

538
00:19:08,630 --> 00:19:12,620
<font color="#CCCCCC">first one that I started to tackle it's</font>

539
00:19:10,880 --> 00:19:14,299
the request exception category and you

540
00:19:12,620 --> 00:19:17,689
can see now it's broken out from the

541
00:19:14,299 --> 00:19:18,649
parent down into some<font color="#E5E5E5"> sub categories so</font>

542
00:19:17,690 --> 00:19:20,720
some of this stuff is pretty

543
00:19:18,649 --> 00:19:22,518
straightforward if you want to go in and

544
00:19:20,720 --> 00:19:24,260
<font color="#E5E5E5">try and write a rule or something that</font>

545
00:19:22,519 --> 00:19:26,899
would look for this and block it that's

546
00:19:24,260 --> 00:19:29,120
pretty<font color="#E5E5E5"> easy to do the issue is with</font>

547
00:19:26,899 --> 00:19:30,830
modsecurity<font color="#E5E5E5"> I get this question a lot</font>

548
00:19:29,120 --> 00:19:33,260
how's modsecurity different from other

549
00:19:30,830 --> 00:19:35,330
commercial web app firewalls modsecurity

550
00:19:33,260 --> 00:19:37,190
doesn't have automated learning and

551
00:19:35,330 --> 00:19:39,379
profile that's really<font color="#E5E5E5"> what most</font>

552
00:19:37,190 --> 00:19:42,620
commercial<font color="#CCCCCC"> laughs try</font><font color="#E5E5E5"> and do because</font>

553
00:19:39,380 --> 00:19:46,220
they're targeting input validation but

554
00:19:42,620 --> 00:19:48,949
what it does have is a lua<font color="#CCCCCC"> API if</font>

555
00:19:46,220 --> 00:19:50,480
anybody's heard of fluo it's a real

556
00:19:48,950 --> 00:19:52,690
popular scripting language in the gaming

557
00:19:50,480 --> 00:19:54,770
industry cuz it's very fast and it's

558
00:19:52,690 --> 00:19:56,070
very easy to embed it in other

559
00:19:54,770 --> 00:19:58,450
applications

560
00:19:56,070 --> 00:20:00,580
does it get familiar with nmap right

561
00:19:58,450 --> 00:20:01,899
they added in a lua<font color="#CCCCCC"> AP</font><font color="#E5E5E5"> I don't know a</font>

562
00:20:00,580 --> 00:20:04,629
couple<font color="#E5E5E5"> years ago and it's become pretty</font>

563
00:20:01,899 --> 00:20:06,699
popular the idea is if the tool can't do

564
00:20:04,629 --> 00:20:09,759
what you want use the<font color="#E5E5E5"> Lua API and you</font>

565
00:20:06,700 --> 00:20:12,129
can do custom logic so I took it upon

566
00:20:09,759 --> 00:20:14,950
myself to try and implement these

567
00:20:12,129 --> 00:20:16,570
detection points in mud security using

568
00:20:14,950 --> 00:20:18,970
the Lua API to try and do some basic

569
00:20:16,570 --> 00:20:21,850
learning so I ended up doing<font color="#E5E5E5"> some of</font>

570
00:20:18,970 --> 00:20:23,950
that<font color="#E5E5E5"> you see here how to blog posts up</font>

571
00:20:21,850 --> 00:20:28,709
we did recently just to show some

572
00:20:23,950 --> 00:20:34,870
examples I did want to show some here

573
00:20:28,710 --> 00:20:36,940
oops so implementing this stuff if

574
00:20:34,870 --> 00:20:38,949
you're in the the modsecurity core rule

575
00:20:36,940 --> 00:20:40,629
set and you download the rules and<font color="#E5E5E5"> you</font>

576
00:20:38,950 --> 00:20:43,330
open it<font color="#E5E5E5"> up there's this activated rules</font>

577
00:20:40,629 --> 00:20:47,620
directory actually will do this just to

578
00:20:43,330 --> 00:20:55,750
give you some idea of where we are hold

579
00:20:47,620 --> 00:20:57,580
on do a longer listing that's not

580
00:20:55,750 --> 00:21:00,460
painting very well on here on the

581
00:20:57,580 --> 00:21:02,769
smaller screen well there's a bunch of

582
00:21:00,460 --> 00:21:04,149
<font color="#E5E5E5">different directories</font><font color="#CCCCCC"> of different rule</font>

583
00:21:02,769 --> 00:21:06,490
sets that you can use we have what we

584
00:21:04,149 --> 00:21:07,959
call base rules which obviously named

585
00:21:06,490 --> 00:21:10,299
those are the base rules that most

586
00:21:07,960 --> 00:21:11,889
everybody would want to activate we have

587
00:21:10,299 --> 00:21:13,570
some optional rules where depending on

588
00:21:11,889 --> 00:21:16,209
your platform you may or not may not

589
00:21:13,570 --> 00:21:18,100
want to<font color="#E5E5E5"> add those in experimental rules</font>

590
00:21:16,210 --> 00:21:21,309
is where all the app sensor stuff is

591
00:21:18,100 --> 00:21:24,399
<font color="#E5E5E5">being tested today but actually go in</font>

592
00:21:21,309 --> 00:21:26,860
here to the activated just you can see

593
00:21:24,399 --> 00:21:31,928
the ones that I'm working on here one

594
00:21:26,860 --> 00:21:33,758
second so you<font color="#E5E5E5"> can see down here I'm</font>

595
00:21:31,929 --> 00:21:37,000
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be uploading those to the svn</font>

596
00:21:33,759 --> 00:21:39,879
repository for the core ruleset<font color="#E5E5E5"> I didn't</font>

597
00:21:37,000 --> 00:21:41,139
<font color="#E5E5E5">have a chance to do that yet but you</font><font color="#CCCCCC"> can</font>

598
00:21:39,879 --> 00:21:42,820
see<font color="#E5E5E5"> how their name just the naming</font>

599
00:21:41,139 --> 00:21:44,590
convention so its absence or detection

600
00:21:42,820 --> 00:21:47,110
point that it will tell you it's related

601
00:21:44,590 --> 00:21:48,370
to the parent category so you can go

602
00:21:47,110 --> 00:21:52,258
inside there<font color="#CCCCCC"> and start to look at the</font>

603
00:21:48,370 --> 00:21:52,258
rules<font color="#CCCCCC"> okay so</font>

604
00:21:55,440 --> 00:21:58,440
oops

605
00:21:59,460 --> 00:22:05,450
do

606
00:22:01,950 --> 00:22:05,450
kind<font color="#E5E5E5"> of pull up the right line</font>

607
00:22:10,000 --> 00:22:13,440
scroll down<font color="#CCCCCC"> here</font>

608
00:22:18,540 --> 00:22:26,070
<font color="#E5E5E5">alright so it was interesting and trying</font>

609
00:22:21,870 --> 00:22:28,169
to profile all this stuff is you have

610
00:22:26,070 --> 00:22:29,939
all these rules that modsecurity looks

611
00:22:28,170 --> 00:22:31,260
for by default you know all the stuff

612
00:22:29,940 --> 00:22:33,330
that it would block and say hey this<font color="#CCCCCC"> is</font>

613
00:22:31,260 --> 00:22:34,950
bad this is that so before<font color="#CCCCCC"> we start to</font>

614
00:22:33,330 --> 00:22:36,330
profile stuff to learn what is good

615
00:22:34,950 --> 00:22:38,610
behavior you want to make sure you're

616
00:22:36,330 --> 00:22:40,199
<font color="#E5E5E5">not learning the bad stuff right so</font>

617
00:22:38,610 --> 00:22:42,209
that's what this does right here<font color="#CCCCCC"> you</font>

618
00:22:40,200 --> 00:22:44,310
<font color="#CCCCCC">have a</font><font color="#E5E5E5"> group of rules that at the end of</font>

619
00:22:42,210 --> 00:22:46,320
the whole request cycle if you've ever

620
00:22:44,310 --> 00:22:49,710
run apache or you've ever looked<font color="#E5E5E5"> at the</font>

621
00:22:46,320 --> 00:22:52,020
request cycle loop this is hooked into

622
00:22:49,710 --> 00:22:54,360
the post processing logging hook so

623
00:22:52,020 --> 00:22:56,250
request comes in it goes out after all

624
00:22:54,360 --> 00:22:58,110
that is done then we're going<font color="#E5E5E5"> to go in</font>

625
00:22:56,250 --> 00:22:59,640
here we're<font color="#E5E5E5"> going to do a few checks so</font>

626
00:22:58,110 --> 00:23:01,110
some of the stuff like for example right

627
00:22:59,640 --> 00:23:03,270
<font color="#CCCCCC">we don't</font><font color="#E5E5E5"> want to profile anything of it</font>

628
00:23:01,110 --> 00:23:07,110
to 404 file is not<font color="#E5E5E5"> there you're done</font>

629
00:23:03,270 --> 00:23:08,580
just<font color="#E5E5E5"> skip it if the status is a 400 or</font>

630
00:23:07,110 --> 00:23:10,020
500 level status code writing

631
00:23:08,580 --> 00:23:14,280
something's wrong we don't want to

632
00:23:10,020 --> 00:23:15,750
profile that<font color="#E5E5E5"> okay the core rule set when</font>

633
00:23:14,280 --> 00:23:17,790
you run it if it identifies that

634
00:23:15,750 --> 00:23:20,730
anything's bad it tracks in anomalies

635
00:23:17,790 --> 00:23:21,960
for so if there's an anomaly score

636
00:23:20,730 --> 00:23:23,370
that's above zero<font color="#E5E5E5"> meaning found</font>

637
00:23:21,960 --> 00:23:25,050
something wrong we don't want to profile

638
00:23:23,370 --> 00:23:27,060
that either right<font color="#E5E5E5"> we're trying to get</font><font color="#CCCCCC"> to</font>

639
00:23:25,050 --> 00:23:30,120
kind<font color="#E5E5E5"> of clean</font><font color="#CCCCCC"> request so then we can</font>

640
00:23:27,060 --> 00:23:32,879
make some decisions<font color="#E5E5E5"> okay so down here is</font>

641
00:23:30,120 --> 00:23:34,530
the Lua API so if you make it through

642
00:23:32,880 --> 00:23:36,030
all that we say hey this probably looks

643
00:23:34,530 --> 00:23:37,470
like it's a legit request nothing

644
00:23:36,030 --> 00:23:39,870
malicious is going on here let's go

645
00:23:37,470 --> 00:23:41,520
<font color="#E5E5E5">ahead and profile it you can see it's a</font>

646
00:23:39,870 --> 00:23:43,830
<font color="#CCCCCC">sectoral script you point it to your</font>

647
00:23:41,520 --> 00:23:45,030
<font color="#CCCCCC">Lewis script and then it runs so this</font>

648
00:23:43,830 --> 00:23:46,710
isn't going<font color="#E5E5E5"> to try and block anything</font>

649
00:23:45,030 --> 00:23:48,510
because essentially it's too late

650
00:23:46,710 --> 00:23:50,190
anyways request came in responsible now

651
00:23:48,510 --> 00:23:52,620
what<font color="#E5E5E5"> this is doing in the background is</font>

652
00:23:50,190 --> 00:23:54,420
learning and then the user<font color="#E5E5E5"> can set up a</font>

653
00:23:52,620 --> 00:23:56,610
threshold for how much<font color="#E5E5E5"> traffic they want</font>

654
00:23:54,420 --> 00:23:59,730
to monitor because hey I want to see

655
00:23:56,610 --> 00:24:00,959
five thousand requests or 50,000<font color="#E5E5E5"> well</font>

656
00:23:59,730 --> 00:24:03,150
whatever it<font color="#E5E5E5"> is you can pick and choose</font>

657
00:24:00,960 --> 00:24:05,070
and then at a certain point after it

658
00:24:03,150 --> 00:24:07,530
hits your threshold then it will set a

659
00:24:05,070 --> 00:24:08,970
certain variable and it'll say<font color="#CCCCCC"> ok from</font>

660
00:24:07,530 --> 00:24:11,940
<font color="#E5E5E5">this point on now we're going to enforce</font>

661
00:24:08,970 --> 00:24:14,340
this profile so all the black list stuff

662
00:24:11,940 --> 00:24:15,780
from the core rule<font color="#E5E5E5"> step always runs but</font>

663
00:24:14,340 --> 00:24:17,760
<font color="#E5E5E5">at a</font><font color="#CCCCCC"> certain point you also then get</font>

664
00:24:15,780 --> 00:24:19,139
this positive security model and it's

665
00:24:17,760 --> 00:24:24,560
going<font color="#E5E5E5"> to go ahead and</font><font color="#CCCCCC"> do all types of</font>

666
00:24:19,140 --> 00:24:24,560
different kinds<font color="#E5E5E5"> of profiling go back</font>

667
00:24:26,580 --> 00:24:33,189
so modsecurity has the<font color="#E5E5E5"> idea of</font>

668
00:24:30,519 --> 00:24:35,289
persistent storage which becomes very

669
00:24:33,190 --> 00:24:38,019
useful if you<font color="#CCCCCC"> want to try and track</font>

670
00:24:35,289 --> 00:24:39,610
things beyond one request that's a key

671
00:24:38,019 --> 00:24:41,379
differentiator between like an IDs or

672
00:24:39,610 --> 00:24:43,899
IPs right a lot of times they'll just

673
00:24:41,379 --> 00:24:46,090
look<font color="#CCCCCC"> for something wrong here no go</font>

674
00:24:43,899 --> 00:24:48,998
ahead<font color="#CCCCCC"> okay so we have this persistent</font>

675
00:24:46,090 --> 00:24:50,678
storage and this is showing<font color="#E5E5E5"> you looks</font>

676
00:24:48,999 --> 00:24:53,799
like a<font color="#E5E5E5"> lot of data of course but this is</font>

677
00:24:50,679 --> 00:24:55,659
<font color="#E5E5E5">for one resource it's got between I</font>

678
00:24:53,799 --> 00:24:57,668
don't know<font color="#E5E5E5"> two and i think four</font>

679
00:24:55,659 --> 00:24:59,190
<font color="#CCCCCC">parameters on it and this is all the</font>

680
00:24:57,669 --> 00:25:01,629
<font color="#CCCCCC">stuff the</font><font color="#E5E5E5"> lewis script learned about it</font>

681
00:24:59,190 --> 00:25:03,580
so you have all these different<font color="#E5E5E5"> sections</font>

682
00:25:01,629 --> 00:25:05,469
in here where we know the minimum<font color="#E5E5E5"> number</font>

683
00:25:03,580 --> 00:25:06,970
of arguments in the maximum once you

684
00:25:05,470 --> 00:25:10,179
know<font color="#CCCCCC"> that then it becomes easy</font><font color="#E5E5E5"> to</font>

685
00:25:06,970 --> 00:25:12,100
enforce it you can categorize a lot of

686
00:25:10,179 --> 00:25:14,559
these<font color="#CCCCCC"> parameters like this parameter</font>

687
00:25:12,100 --> 00:25:16,629
that's the class is a path<font color="#E5E5E5"> right so it's</font>

688
00:25:14,559 --> 00:25:19,299
a path to a file another one's an email

689
00:25:16,629 --> 00:25:20,860
address other ones old digits so<font color="#E5E5E5"> you can</font>

690
00:25:19,299 --> 00:25:22,119
let this run in the background once it

691
00:25:20,860 --> 00:25:23,918
sees enough then you<font color="#E5E5E5"> can start</font>

692
00:25:22,119 --> 00:25:25,059
implementing those absence or detection

693
00:25:23,919 --> 00:25:31,389
points and<font color="#CCCCCC"> it will start</font><font color="#E5E5E5"> triggering</font>

694
00:25:25,059 --> 00:25:33,668
those so this<font color="#E5E5E5"> is getting back to from</font>

695
00:25:31,389 --> 00:25:36,928
the previous circle talking about the

696
00:25:33,669 --> 00:25:40,269
developers the idea in<font color="#E5E5E5"> this case of</font>

697
00:25:36,929 --> 00:25:41,889
identifying SQL injection that that may

698
00:25:40,269 --> 00:25:43,809
be<font color="#E5E5E5"> tough for developers to come up with</font>

699
00:25:41,889 --> 00:25:45,580
<font color="#E5E5E5">all these reg exes are ways to say hey</font>

700
00:25:43,809 --> 00:25:46,928
this doesn't just match my positive

701
00:25:45,580 --> 00:25:49,119
security profile but this is SQL

702
00:25:46,929 --> 00:25:51,039
injection so this is<font color="#CCCCCC"> one of</font><font color="#E5E5E5"> the things</font>

703
00:25:49,119 --> 00:25:52,418
<font color="#CCCCCC">that</font><font color="#E5E5E5"> we do with the core rule set to try</font>

704
00:25:51,039 --> 00:25:54,730
and make<font color="#CCCCCC"> it better at detecting that</font>

705
00:25:52,419 --> 00:25:57,490
kind of stuff we had a challenge over

706
00:25:54,730 --> 00:25:59,649
the<font color="#E5E5E5"> summer and what was interesting was</font>

707
00:25:57,490 --> 00:26:01,480
we wanted<font color="#E5E5E5"> people to QA our rules and</font>

708
00:25:59,649 --> 00:26:03,428
actually I'd see Michael coaches<font color="#E5E5E5"> in back</font>

709
00:26:01,480 --> 00:26:06,100
he gave a talk earlier about bug bounty

710
00:26:03,429 --> 00:26:08,139
programs right so it's kind of a<font color="#E5E5E5"> similar</font>

711
00:26:06,100 --> 00:26:10,418
thing<font color="#CCCCCC"> that as</font><font color="#E5E5E5"> good as we thought we were</font>

712
00:26:08,139 --> 00:26:12,189
doing internally with these rules we

713
00:26:10,419 --> 00:26:14,049
said we got<font color="#E5E5E5"> to get put it out the public</font>

714
00:26:12,190 --> 00:26:15,700
right there's people that do<font color="#CCCCCC"> this as</font>

715
00:26:14,049 --> 00:26:18,460
their job there's people that do it

716
00:26:15,700 --> 00:26:19,809
illegally as their job but there's

717
00:26:18,460 --> 00:26:22,299
people that will poke and prod at this

718
00:26:19,809 --> 00:26:23,980
and find holes so we<font color="#E5E5E5"> said let's do a</font>

719
00:26:22,299 --> 00:26:26,168
challenge<font color="#E5E5E5"> and let's make it targeted</font>

720
00:26:23,980 --> 00:26:28,029
just SQL injection and<font color="#E5E5E5"> I was trying to</font>

721
00:26:26,169 --> 00:26:29,679
<font color="#E5E5E5">figure out how</font><font color="#CCCCCC"> can we do this</font><font color="#E5E5E5"> so we have</font>

722
00:26:28,029 --> 00:26:32,289
an application they can interact with

723
00:26:29,679 --> 00:26:33,549
and I didn't want to build stuff then if

724
00:26:32,289 --> 00:26:35,889
people hack in and have to figure all

725
00:26:33,549 --> 00:26:36,310
that out so came up with the idea if you

726
00:26:35,889 --> 00:26:37,629
can see

727
00:26:36,310 --> 00:26:40,030
links there in the<font color="#E5E5E5"> middle I said wait a</font>

728
00:26:37,630 --> 00:26:42,340
minute public commercial scanning

729
00:26:40,030 --> 00:26:44,110
vendors already have public demo sites

730
00:26:42,340 --> 00:26:46,030
right so you can go download their

731
00:26:44,110 --> 00:26:48,490
dynamic scanner run it against their

732
00:26:46,030 --> 00:26:49,660
demo site and get<font color="#E5E5E5"> a nice shiny report so</font>

733
00:26:48,490 --> 00:26:51,730
he said why don't we leverage that

734
00:26:49,660 --> 00:26:53,470
that's the site with a hole in it now we

735
00:26:51,730 --> 00:26:55,600
just need to somehow put us in the mix

736
00:26:53,470 --> 00:26:57,340
to look at this stuff<font color="#E5E5E5"> so what we did is</font>

737
00:26:55,600 --> 00:26:58,629
we set up those links if you come<font color="#CCCCCC"> here</font>

738
00:26:57,340 --> 00:27:00,280
to participate<font color="#CCCCCC"> in the challenge you</font>

739
00:26:58,630 --> 00:27:02,500
click<font color="#E5E5E5"> on the blank you go through the</font>

740
00:27:00,280 --> 00:27:06,190
mod security org website we just proxy

741
00:27:02,500 --> 00:27:08,110
and we sit passively we watch and what

742
00:27:06,190 --> 00:27:10,360
happened was the challenge<font color="#E5E5E5"> was to say</font>

743
00:27:08,110 --> 00:27:11,620
each one of these<font color="#E5E5E5"> websites has SQL</font>

744
00:27:10,360 --> 00:27:14,439
injection issues there's a back-end

745
00:27:11,620 --> 00:27:16,030
database not protected appropriately<font color="#E5E5E5"> the</font>

746
00:27:14,440 --> 00:27:19,120
challenge was for them to extract out

747
00:27:16,030 --> 00:27:20,800
database information what database type

748
00:27:19,120 --> 00:27:22,899
was it what<font color="#E5E5E5"> was the</font><font color="#CCCCCC"> name of the database</font>

749
00:27:20,800 --> 00:27:26,830
a column name and extract out some data

750
00:27:22,900 --> 00:27:28,450
<font color="#E5E5E5">from a table and we said okay level</font><font color="#CCCCCC"> one</font>

751
00:27:26,830 --> 00:27:30,669
is speed hacking how quickly can you do

752
00:27:28,450 --> 00:27:33,130
<font color="#E5E5E5">this we said go before people on the</font>

753
00:27:30,670 --> 00:27:34,810
right found<font color="#E5E5E5"> it relatively quickly level</font>

754
00:27:33,130 --> 00:27:37,210
<font color="#CCCCCC">two was what I was</font><font color="#E5E5E5"> really interested in</font>

755
00:27:34,810 --> 00:27:40,210
<font color="#E5E5E5">that's an evasion challenge so what we</font>

756
00:27:37,210 --> 00:27:41,740
were showing up at the top second I can

757
00:27:40,210 --> 00:27:47,770
<font color="#CCCCCC">actually show this real quick since we</font>

758
00:27:41,740 --> 00:27:51,779
got a little time see<font color="#E5E5E5"> if this</font><font color="#CCCCCC"> is going</font>

759
00:27:47,770 --> 00:27:53,840
<font color="#E5E5E5">to come up objects</font>

760
00:27:51,779 --> 00:27:53,840
you

761
00:27:54,919 --> 00:28:02,350
<font color="#CCCCCC">top through this real quick oh that's</font>

762
00:28:00,080 --> 00:28:02,350
okay

763
00:28:05,400 --> 00:28:08,990
all right go<font color="#CCCCCC"> to one of these</font>

764
00:28:11,250 --> 00:28:14,660
let's see if this<font color="#E5E5E5"> is going to work</font>

765
00:28:20,710 --> 00:28:24,370
<font color="#E5E5E5">okay so as they're interacting with the</font>

766
00:28:23,169 --> 00:28:26,260
website<font color="#E5E5E5"> we're passively watching</font>

767
00:28:24,370 --> 00:28:28,029
everything and if<font color="#E5E5E5"> we see something we</font>

768
00:28:26,260 --> 00:28:30,429
prepend a warning banner to the top just

769
00:28:28,029 --> 00:28:31,570
<font color="#E5E5E5">to let the end-user know okay if we were</font>

770
00:28:30,429 --> 00:28:32,679
<font color="#E5E5E5">in a blocking mode we would have blocked</font>

771
00:28:31,570 --> 00:28:34,720
that because we saw you were doing

772
00:28:32,679 --> 00:28:37,720
<font color="#E5E5E5">something bad so the level 2 challenge</font>

773
00:28:34,720 --> 00:28:39,730
was go in extract out the database

774
00:28:37,720 --> 00:28:41,289
information that we<font color="#E5E5E5"> asked</font><font color="#CCCCCC"> for however</font>

775
00:28:39,730 --> 00:28:43,899
you can't have a warning banner trigger

776
00:28:41,289 --> 00:28:46,120
if you do that that's an evasion you<font color="#E5E5E5"> win</font>

777
00:28:43,899 --> 00:28:47,529
let us know and we send you a t-shirt we

778
00:28:46,120 --> 00:28:49,689
put your name up on the big board and

779
00:28:47,529 --> 00:28:52,110
all that stuff so it wasn't a bug bounty

780
00:28:49,690 --> 00:28:55,270
program but smile parents go to one off

781
00:28:52,110 --> 00:28:57,490
but I definitely see the<font color="#E5E5E5"> value in it and</font>

782
00:28:55,270 --> 00:28:59,320
what<font color="#E5E5E5"> we're able to do then</font><font color="#CCCCCC"> for the core</font>

783
00:28:57,490 --> 00:29:01,600
<font color="#E5E5E5">rule set was we did a lessons learned</font>

784
00:28:59,320 --> 00:29:03,730
we're<font color="#E5E5E5"> able to go back</font><font color="#CCCCCC"> and analyze there</font>

785
00:29:01,600 --> 00:29:05,529
were nine different guys or groups that

786
00:29:03,730 --> 00:29:06,669
figured out the evasions and we could go

787
00:29:05,529 --> 00:29:08,169
<font color="#E5E5E5">back and look because we have the full</font>

788
00:29:06,669 --> 00:29:11,200
audit<font color="#E5E5E5"> log right of everything that</font>

789
00:29:08,169 --> 00:29:13,750
happen whether triggered a alert or not

790
00:29:11,200 --> 00:29:16,870
and you can look at him<font color="#E5E5E5"> and say oh crap</font>

791
00:29:13,750 --> 00:29:19,000
yeah why didn't we catch that some of it

792
00:29:16,870 --> 00:29:21,279
were in coding issues some of it were

793
00:29:19,000 --> 00:29:23,470
because of<font color="#E5E5E5"> false positives previously we</font>

794
00:29:21,279 --> 00:29:25,659
weren't<font color="#E5E5E5"> looking in certain places such</font>

795
00:29:23,470 --> 00:29:27,429
as cookies<font color="#E5E5E5"> and there was an evasion or</font>

796
00:29:25,659 --> 00:29:29,590
those a vector in one of the cookies<font color="#CCCCCC"> and</font>

797
00:29:27,429 --> 00:29:31,779
we weren't even looking at it so some of

798
00:29:29,590 --> 00:29:33,070
them were configures shoes it's a lot<font color="#E5E5E5"> of</font>

799
00:29:31,779 --> 00:29:35,500
the same stuff<font color="#E5E5E5"> Michael was talking about</font>

800
00:29:33,070 --> 00:29:37,120
lessons learned but<font color="#E5E5E5"> it's this kind of</font>

801
00:29:35,500 --> 00:29:40,450
stuff<font color="#CCCCCC"> that you can then</font><font color="#E5E5E5"> go back on so</font>

802
00:29:37,120 --> 00:29:41,770
the detection for SQL injection in this

803
00:29:40,450 --> 00:29:43,330
case in the court will set is getting

804
00:29:41,770 --> 00:29:44,559
<font color="#E5E5E5">better and better all the time we're</font>

805
00:29:43,330 --> 00:29:46,480
probably going to<font color="#E5E5E5"> have more challenges</font>

806
00:29:44,559 --> 00:29:48,158
like this<font color="#E5E5E5"> but it's this kind of stuff</font>

807
00:29:46,480 --> 00:29:50,289
when you think about inside the code

808
00:29:48,159 --> 00:29:52,690
it's good to<font color="#CCCCCC"> have the detection point</font>

809
00:29:50,289 --> 00:29:54,399
there but for SQL injection how often

810
00:29:52,690 --> 00:29:55,450
can you update that and get it pushed

811
00:29:54,399 --> 00:29:57,489
out because it needs to be constantly

812
00:29:55,450 --> 00:29:59,260
updated we were talking<font color="#E5E5E5"> about that a</font>

813
00:29:57,490 --> 00:30:01,090
little bit at the absence<font color="#E5E5E5"> or summat to</font>

814
00:29:59,260 --> 00:30:02,740
figure that out and say well you don't

815
00:30:01,090 --> 00:30:04,389
want to be pushing<font color="#E5E5E5"> new code maybe this</font>

816
00:30:02,740 --> 00:30:06,520
could be brought in dynamically

817
00:30:04,390 --> 00:30:08,020
periodically through a config file you

818
00:30:06,520 --> 00:30:09,549
know you need to make<font color="#E5E5E5"> it</font><font color="#CCCCCC"> more agile so</font>

819
00:30:08,020 --> 00:30:17,020
it can be updated<font color="#CCCCCC"> because these things</font>

820
00:30:09,549 --> 00:30:19,179
certainly aren't static<font color="#E5E5E5"> all right so</font>

821
00:30:17,020 --> 00:30:20,710
this is an interesting detection point

822
00:30:19,179 --> 00:30:23,020
that we had added in and it really is

823
00:30:20,710 --> 00:30:24,159
this concept<font color="#E5E5E5"> of like a layered approach</font>

824
00:30:23,020 --> 00:30:25,779
so if you think<font color="#CCCCCC"> about</font><font color="#E5E5E5"> the architecture</font>

825
00:30:24,159 --> 00:30:29,470
coming in somebody's<font color="#E5E5E5"> going to your web</font>

826
00:30:25,779 --> 00:30:30,970
app if they go through modsecurity we

827
00:30:29,470 --> 00:30:33,639
may or may not be<font color="#E5E5E5"> in the best position</font>

828
00:30:30,970 --> 00:30:34,610
to make a<font color="#CCCCCC"> decision to block it right but</font>

829
00:30:33,639 --> 00:30:36,559
<font color="#E5E5E5">what would be cool</font>

830
00:30:34,610 --> 00:30:38,120
is if we can look<font color="#E5E5E5"> at it like for SQL</font>

831
00:30:36,559 --> 00:30:40,850
injection that<font color="#E5E5E5"> we just saw and say hey</font>

832
00:30:38,120 --> 00:30:42,439
this looks like SQL injection I'm going

833
00:30:40,850 --> 00:30:44,870
<font color="#E5E5E5">to let this request go on to the</font>

834
00:30:42,440 --> 00:30:46,070
destination app server it has absence or

835
00:30:44,870 --> 00:30:48,860
detection points we're kind of working

836
00:30:46,070 --> 00:30:51,290
together I need to tell app sensor I saw

837
00:30:48,860 --> 00:30:53,959
SQL injection so it can factor that<font color="#E5E5E5"> in</font>

838
00:30:51,290 --> 00:30:55,670
so with<font color="#CCCCCC"> this concept of suspicious</font>

839
00:30:53,960 --> 00:30:57,890
external behavior in this case<font color="#CCCCCC"> it's</font>

840
00:30:55,670 --> 00:31:00,400
external to the application something

841
00:30:57,890 --> 00:31:03,200
else has said something weirds going off

842
00:31:00,400 --> 00:31:04,549
so to show you an example here<font color="#CCCCCC"> well it's</font>

843
00:31:03,200 --> 00:31:08,780
gonna be hard<font color="#CCCCCC"> to read from the back of</font>

844
00:31:04,549 --> 00:31:12,049
<font color="#CCCCCC">the room it's</font><font color="#E5E5E5"> very similar and concept</font>

845
00:31:08,780 --> 00:31:14,330
to like spam monitoring and tagging and

846
00:31:12,049 --> 00:31:15,740
smtp and emails right you ever get those

847
00:31:14,330 --> 00:31:17,090
spam emails and you look at the raw

848
00:31:15,740 --> 00:31:19,190
headers and you can see everything

849
00:31:17,090 --> 00:31:21,230
saying oh spam assassin or whatever

850
00:31:19,190 --> 00:31:22,940
you're using it it checked this here's

851
00:31:21,230 --> 00:31:25,030
this score and finally it said it's spam

852
00:31:22,940 --> 00:31:28,520
we want to take that<font color="#E5E5E5"> concept to the web</font>

853
00:31:25,030 --> 00:31:31,129
the other analogy i gave to somebody who

854
00:31:28,520 --> 00:31:32,629
what really wasn't<font color="#CCCCCC"> very technical is if</font>

855
00:31:31,130 --> 00:31:36,200
you've ever watched those wilderness

856
00:31:32,630 --> 00:31:38,030
shows<font color="#E5E5E5"> like</font><font color="#CCCCCC"> was a</font><font color="#E5E5E5"> mutual of omaha right</font>

857
00:31:36,200 --> 00:31:39,500
when I<font color="#E5E5E5"> was growing up all of those all</font>

858
00:31:38,030 --> 00:31:41,450
right the idea that oh here comes the

859
00:31:39,500 --> 00:31:42,860
<font color="#CCCCCC">rhino shoot the rhino falls asleep</font><font color="#E5E5E5"> you</font>

860
00:31:41,450 --> 00:31:44,809
go in you tag it you do all<font color="#E5E5E5"> that stuff</font>

861
00:31:42,860 --> 00:31:46,790
you categorize it and you watch<font color="#E5E5E5"> and then</font>

862
00:31:44,809 --> 00:31:48,649
<font color="#E5E5E5">it wakes up and runs off it's the same</font>

863
00:31:46,790 --> 00:31:50,990
<font color="#CCCCCC">kind</font><font color="#E5E5E5"> of thing it came in we saw it what</font>

864
00:31:48,650 --> 00:31:53,720
we want<font color="#E5E5E5"> to do is tag it so the idea is</font>

865
00:31:50,990 --> 00:31:55,340
modsecurity see something bad it exports

866
00:31:53,720 --> 00:31:58,010
this information to Apache as

867
00:31:55,340 --> 00:32:00,980
environment variables then<font color="#E5E5E5"> Apache ads in</font>

868
00:31:58,010 --> 00:32:03,169
two new request headers there's one<font color="#CCCCCC"> up</font>

869
00:32:00,980 --> 00:32:05,510
here is<font color="#E5E5E5"> this think abou</font><font color="#CCCCCC"> behavior there</font>

870
00:32:03,169 --> 00:32:08,150
we go there's this header here called<font color="#E5E5E5"> X</font>

871
00:32:05,510 --> 00:32:09,650
wafi bent and we can export all the

872
00:32:08,150 --> 00:32:11,960
different rules that trigger the

873
00:32:09,650 --> 00:32:13,760
messages and then<font color="#E5E5E5"> down here is an</font>

874
00:32:11,960 --> 00:32:16,760
ex-wife score you can see the total

875
00:32:13,760 --> 00:32:19,910
anomaly scores 35 and 12 of that was SQL

876
00:32:16,760 --> 00:32:21,340
injection so we can export<font color="#CCCCCC"> that send it</font>

877
00:32:19,910 --> 00:32:23,960
on its way and<font color="#E5E5E5"> if the destination</font>

878
00:32:21,340 --> 00:32:25,970
application server has certain logic

879
00:32:23,960 --> 00:32:28,460
that can look for those request headers

880
00:32:25,970 --> 00:32:30,200
and take that it can say<font color="#E5E5E5"> hmm let's throw</font>

881
00:32:28,460 --> 00:32:31,730
an exception for SQL injection because

882
00:32:30,200 --> 00:32:33,500
<font color="#E5E5E5">they said there was one and then we</font>

883
00:32:31,730 --> 00:32:36,700
factored that into maybe a<font color="#E5E5E5"> different</font>

884
00:32:33,500 --> 00:32:36,700
type of response action

885
00:32:38,070 --> 00:32:43,320
a couple other interesting detection

886
00:32:40,560 --> 00:32:45,500
points that we've added in this one it

887
00:32:43,320 --> 00:32:48,060
says a suspicious client-side behavior

888
00:32:45,500 --> 00:32:50,010
so there's all sorts of weird stuff that

889
00:32:48,060 --> 00:32:51,629
can happen inside the browser that

890
00:32:50,010 --> 00:32:53,250
traditionally from the web server

891
00:32:51,630 --> 00:32:55,020
perspective we have no<font color="#E5E5E5"> idea what's going</font>

892
00:32:53,250 --> 00:32:56,070
on<font color="#E5E5E5"> in there right that's why cross-site</font>

893
00:32:55,020 --> 00:32:57,750
scripting is such a big problem

894
00:32:56,070 --> 00:33:00,689
especially the<font color="#CCCCCC"> Dom based stuff we</font><font color="#E5E5E5"> just</font>

895
00:32:57,750 --> 00:33:02,250
have no insight so the idea<font color="#E5E5E5"> here is if</font>

896
00:33:00,690 --> 00:33:03,150
you leverage something I think<font color="#E5E5E5"> it's in</font>

897
00:33:02,250 --> 00:33:05,340
<font color="#CCCCCC">the middle here if you can see that</font>

898
00:33:03,150 --> 00:33:07,430
content security policy right CSP if

899
00:33:05,340 --> 00:33:09,990
you've heard<font color="#CCCCCC"> that for Mozilla Firefox</font>

900
00:33:07,430 --> 00:33:11,250
it's the idea that as an organization

901
00:33:09,990 --> 00:33:13,230
you<font color="#CCCCCC"> can define for your website</font>

902
00:33:11,250 --> 00:33:15,240
different controls<font color="#E5E5E5"> about what dynamic</font>

903
00:33:13,230 --> 00:33:16,680
code is allowed to<font color="#E5E5E5"> run what's allowed to</font>

904
00:33:15,240 --> 00:33:19,440
run at all where is it allowed<font color="#CCCCCC"> to run</font>

905
00:33:16,680 --> 00:33:21,840
from and actually Michael<font color="#CCCCCC"> this is good</font>

906
00:33:19,440 --> 00:33:23,700
from our summit discussion that I think

907
00:33:21,840 --> 00:33:26,129
the process<font color="#E5E5E5"> of</font><font color="#CCCCCC"> organizations need to go</font>

908
00:33:23,700 --> 00:33:28,050
through<font color="#CCCCCC"> for CSP creation it's very</font>

909
00:33:26,130 --> 00:33:29,820
<font color="#E5E5E5">similar to absence you know what I</font><font color="#CCCCCC"> mean</font>

910
00:33:28,050 --> 00:33:31,620
for the<font color="#CCCCCC"> relevant parties because you</font>

911
00:33:29,820 --> 00:33:32,939
<font color="#E5E5E5">need to get operations folks in because</font>

912
00:33:31,620 --> 00:33:35,010
you know they're adding in these clients

913
00:33:32,940 --> 00:33:36,690
are these response headers and its

914
00:33:35,010 --> 00:33:38,190
policy questions on how this<font color="#E5E5E5"> is going to</font>

915
00:33:36,690 --> 00:33:40,320
work any developers at the table you

916
00:33:38,190 --> 00:33:43,260
need op security info SEC get those

917
00:33:40,320 --> 00:33:46,379
people in a room so the idea here is you

918
00:33:43,260 --> 00:33:48,420
can define for your website send down in

919
00:33:46,380 --> 00:33:50,280
a new response header if it's Firefox

920
00:33:48,420 --> 00:33:52,650
and say hey here's restrictions about

921
00:33:50,280 --> 00:33:54,240
what codes allowed to run then if any of

922
00:33:52,650 --> 00:33:56,820
those are violated in the browser you

923
00:33:54,240 --> 00:33:58,830
can optionally of course you know take

924
00:33:56,820 --> 00:34:01,590
action on it but then the browser can

925
00:33:58,830 --> 00:34:04,080
send back a new reporting request to the

926
00:34:01,590 --> 00:34:07,260
website and<font color="#E5E5E5"> report back whatever weird</font>

927
00:34:04,080 --> 00:34:10,440
thing happened client side so I did this

928
00:34:07,260 --> 00:34:12,719
as a<font color="#E5E5E5"> good of proof of concept I did all</font>

929
00:34:10,440 --> 00:34:15,240
this in mud security so mod security can

930
00:34:12,719 --> 00:34:18,270
be used actually to define the CSP

931
00:34:15,239 --> 00:34:19,949
policy<font color="#E5E5E5"> push down to the client you can</font>

932
00:34:18,270 --> 00:34:22,230
do that<font color="#E5E5E5"> in the config files and set that</font>

933
00:34:19,949 --> 00:34:23,969
up in again I know it's hard<font color="#E5E5E5"> to read</font>

934
00:34:22,230 --> 00:34:26,400
from the back of<font color="#CCCCCC"> the room just grab this</font>

935
00:34:23,969 --> 00:34:28,439
with live HTTP headers just to see when

936
00:34:26,400 --> 00:34:29,970
the client was going to our site we

937
00:34:28,440 --> 00:34:32,040
highlighted the new response header

938
00:34:29,969 --> 00:34:34,830
that's now pushing that policy down to

939
00:34:32,040 --> 00:34:38,310
Firefox in CSP<font color="#E5E5E5"> and then if something</font>

940
00:34:34,830 --> 00:34:39,810
weird happens in this case there<font color="#E5E5E5"> was</font>

941
00:34:38,310 --> 00:34:42,690
some<font color="#E5E5E5"> JavaScript that came in and</font><font color="#CCCCCC"> it was</font>

942
00:34:39,810 --> 00:34:44,549
doing an iframe to third party it was

943
00:34:42,690 --> 00:34:46,170
trying to pull up some malicious code

944
00:34:44,550 --> 00:34:48,330
but the domain it was going to pull it

945
00:34:46,170 --> 00:34:49,920
<font color="#E5E5E5">from was not within the policy so the</font>

946
00:34:48,330 --> 00:34:52,020
browser says oh hold on a second it

947
00:34:49,920 --> 00:34:52,630
makes a new web request you can see here

948
00:34:52,020 --> 00:34:54,550
it's doing a

949
00:34:52,630 --> 00:34:57,070
goes to a certain URL that we specify

950
00:34:54,550 --> 00:35:00,520
and then down in the<font color="#E5E5E5"> bottom it's this</font>

951
00:34:57,070 --> 00:35:02,230
blob of text<font color="#CCCCCC"> i guess</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> json but from</font>

952
00:35:00,520 --> 00:35:07,380
our perspective here it's a blob of text

953
00:35:02,230 --> 00:35:09,730
we don't parse<font color="#E5E5E5"> json currently</font><font color="#CCCCCC"> but</font>

954
00:35:07,380 --> 00:35:13,270
another<font color="#E5E5E5"> interesting one here is this</font>

955
00:35:09,730 --> 00:35:15,250
idea<font color="#E5E5E5"> of honey trap and this again to me</font>

956
00:35:13,270 --> 00:35:16,630
is a real good example that<font color="#CCCCCC"> when you're</font>

957
00:35:15,250 --> 00:35:17,770
talking with developers and going

958
00:35:16,630 --> 00:35:20,410
through all this when you<font color="#E5E5E5"> get to this</font>

959
00:35:17,770 --> 00:35:22,630
category this isn't necessarily

960
00:35:20,410 --> 00:35:25,120
something<font color="#E5E5E5"> I</font><font color="#CCCCCC"> think developers have to</font>

961
00:35:22,630 --> 00:35:27,640
implement<font color="#CCCCCC"> its useful as a detection</font>

962
00:35:25,120 --> 00:35:29,020
point in operations but who implements

963
00:35:27,640 --> 00:35:32,529
it is a discussion you'll have to figure

964
00:35:29,020 --> 00:35:35,050
<font color="#E5E5E5">out</font><font color="#CCCCCC"> but a good thing to do why you think</font>

965
00:35:32,530 --> 00:35:36,520
infosec should be in the room is you

966
00:35:35,050 --> 00:35:38,680
want<font color="#E5E5E5"> to get the attackers perspective</font>

967
00:35:36,520 --> 00:35:40,000
and say if you're going to assess our

968
00:35:38,680 --> 00:35:41,500
site or attack our site what are the

969
00:35:40,000 --> 00:35:44,110
steps that you do and then<font color="#CCCCCC"> you can</font>

970
00:35:41,500 --> 00:35:45,880
<font color="#E5E5E5">highlight along the way oh I could put a</font>

971
00:35:44,110 --> 00:35:47,830
little trap here and if<font color="#E5E5E5"> you start</font><font color="#CCCCCC"> to</font>

972
00:35:45,880 --> 00:35:49,030
mess with that then real low false

973
00:35:47,830 --> 00:35:52,120
positive rate you know somebody's

974
00:35:49,030 --> 00:35:54,970
messing around with your<font color="#CCCCCC"> website so a</font>

975
00:35:52,120 --> 00:35:56,650
good example<font color="#E5E5E5"> that this is the example we</font>

976
00:35:54,970 --> 00:35:59,980
have here in modsecurity if you want to

977
00:35:56,650 --> 00:36:01,750
do the CSP 1mon security has<font color="#E5E5E5"> a</font>

978
00:35:59,980 --> 00:36:03,630
capability when the response body's

979
00:36:01,750 --> 00:36:06,190
going out you can<font color="#E5E5E5"> actually manipulate</font>

980
00:36:03,630 --> 00:36:08,050
the response it used<font color="#E5E5E5"> to be you could</font>

981
00:36:06,190 --> 00:36:10,090
only prepend stuff to the top<font color="#CCCCCC"> or append</font>

982
00:36:08,050 --> 00:36:11,530
it to the bottle but now we updated a

983
00:36:10,090 --> 00:36:15,130
new function where you can basically do

984
00:36:11,530 --> 00:36:17,860
<font color="#E5E5E5">regex substitutions so this one the way</font>

985
00:36:15,130 --> 00:36:21,580
we made it real easy here is we had

986
00:36:17,860 --> 00:36:24,130
trapped the closing HTML form tag and if

987
00:36:21,580 --> 00:36:27,160
it sees a form going<font color="#E5E5E5"> out it pre pens it</font>

988
00:36:24,130 --> 00:36:28,900
with this bogus hidden parameter now of

989
00:36:27,160 --> 00:36:31,049
course<font color="#E5E5E5"> you need to figure out and make</font>

990
00:36:28,900 --> 00:36:33,460
sure what that data is that you don't

991
00:36:31,050 --> 00:36:35,440
blow something up by mistake right<font color="#E5E5E5"> if an</font>

992
00:36:33,460 --> 00:36:36,760
application receives this crazy weird

993
00:36:35,440 --> 00:36:38,980
parameter wasn't expecting how's it

994
00:36:36,760 --> 00:36:41,140
going to react but this kind<font color="#E5E5E5"> of stuff is</font>

995
00:36:38,980 --> 00:36:42,490
perfect for a honey trap because<font color="#CCCCCC"> if</font>

996
00:36:41,140 --> 00:36:44,470
you're talking<font color="#E5E5E5"> about an attacker and</font>

997
00:36:42,490 --> 00:36:45,370
assessment person whoever they're going

998
00:36:44,470 --> 00:36:47,290
to start<font color="#CCCCCC"> looking for these hidden</font>

999
00:36:45,370 --> 00:36:48,790
variables and parameters and they're

1000
00:36:47,290 --> 00:36:50,710
<font color="#CCCCCC">gonna start messing with them especially</font>

1001
00:36:48,790 --> 00:36:52,390
if they see something called<font color="#CCCCCC"> Oh hidden</font>

1002
00:36:50,710 --> 00:36:54,670
name this is<font color="#E5E5E5"> called debug and it's false</font>

1003
00:36:52,390 --> 00:36:56,859
what am I going to do I'm going<font color="#E5E5E5"> to</font>

1004
00:36:54,670 --> 00:36:58,720
change it to true and see what happens

1005
00:36:56,860 --> 00:37:00,310
right so you're laying<font color="#E5E5E5"> these little land</font>

1006
00:36:58,720 --> 00:37:02,649
mines because now it's very easy

1007
00:37:00,310 --> 00:37:04,810
<font color="#CCCCCC">server-side</font><font color="#E5E5E5"> in modsecurity we have a</font>

1008
00:37:02,650 --> 00:37:06,400
rule that Justin forces this if it ever

1009
00:37:04,810 --> 00:37:08,890
sees a parameter called debug

1010
00:37:06,400 --> 00:37:11,049
if it's ever not false somebody's

1011
00:37:08,890 --> 00:37:12,190
messing around and it's not average Joe

1012
00:37:11,049 --> 00:37:13,960
in<font color="#E5E5E5"> the browser because they never see</font>

1013
00:37:12,190 --> 00:37:15,490
this it's somebody who's savvy enough to

1014
00:37:13,960 --> 00:37:17,440
get<font color="#E5E5E5"> out</font><font color="#CCCCCC"> of the browser start to</font>

1015
00:37:15,490 --> 00:37:21,669
manipulate things in the poking and you

1016
00:37:17,440 --> 00:37:23,170
want to keep a closer eye on again I

1017
00:37:21,670 --> 00:37:24,130
know it's tough to read<font color="#E5E5E5"> from the back</font><font color="#CCCCCC"> of</font>

1018
00:37:23,170 --> 00:37:25,839
<font color="#E5E5E5">the room but this is the event that</font>

1019
00:37:24,130 --> 00:37:27,130
<font color="#E5E5E5">triggered if somebody messed that up so</font>

1020
00:37:25,839 --> 00:37:29,470
you can see<font color="#E5E5E5"> the message tampering of</font>

1021
00:37:27,130 --> 00:37:30,520
hidden parameter honey trap data and it

1022
00:37:29,470 --> 00:37:32,799
captures<font color="#CCCCCC"> your data where they had</font>

1023
00:37:30,520 --> 00:37:34,029
changed it to true so on the back end

1024
00:37:32,799 --> 00:37:35,950
what's cool though is all these

1025
00:37:34,029 --> 00:37:37,630
different detection points if you have

1026
00:37:35,950 --> 00:37:39,279
these types of alerts whether it's

1027
00:37:37,630 --> 00:37:41,349
modsecurity creating it or internal to

1028
00:37:39,279 --> 00:37:43,750
the app it doesn't matter feed this

1029
00:37:41,349 --> 00:37:45,279
stuff to a centralized location like I

1030
00:37:43,750 --> 00:37:47,260
<font color="#E5E5E5">mentioned before a sim or something so</font>

1031
00:37:45,279 --> 00:37:49,680
that way<font color="#CCCCCC"> real time people monitoring</font>

1032
00:37:47,260 --> 00:37:52,420
they can correlate all this stuff and

1033
00:37:49,680 --> 00:37:55,089
<font color="#CCCCCC">the last one to show here is response</font>

1034
00:37:52,420 --> 00:37:56,619
actions I haven't<font color="#E5E5E5"> gotten</font><font color="#CCCCCC"> too deep scuze</font>

1035
00:37:55,089 --> 00:37:58,000
me from the project perspective to do

1036
00:37:56,619 --> 00:38:00,789
this just<font color="#CCCCCC"> because I'm</font><font color="#E5E5E5"> doing detection</font>

1037
00:37:58,000 --> 00:38:02,680
points first then we move on<font color="#E5E5E5"> to the the</font>

1038
00:38:00,789 --> 00:38:04,329
actions but one I did want to highlight

1039
00:38:02,680 --> 00:38:05,649
here and actually think i<font color="#CCCCCC"> have the blog</font>

1040
00:38:04,329 --> 00:38:11,500
post to kind of walk you through its

1041
00:38:05,650 --> 00:38:13,740
kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> interesting move</font><font color="#E5E5E5"> over here</font>

1042
00:38:11,500 --> 00:38:16,450
hopefully we can see it a little better

1043
00:38:13,740 --> 00:38:19,029
it's the idea of<font color="#CCCCCC"> an application log out</font>

1044
00:38:16,450 --> 00:38:20,649
so yes<font color="#CCCCCC"> you need to figure out under what</font>

1045
00:38:19,029 --> 00:38:22,599
circumstances would you<font color="#E5E5E5"> want to trigger</font>

1046
00:38:20,650 --> 00:38:24,460
this but this<font color="#E5E5E5"> is something typically</font>

1047
00:38:22,599 --> 00:38:27,220
external to your application that other

1048
00:38:24,460 --> 00:38:30,069
devices don't normally do because you

1049
00:38:27,220 --> 00:38:32,529
have to make this external device

1050
00:38:30,069 --> 00:38:34,240
authentication<font color="#E5E5E5"> aware it needs to</font>

1051
00:38:32,529 --> 00:38:36,099
understand how does somebody<font color="#E5E5E5"> login to</font>

1052
00:38:34,240 --> 00:38:39,009
your site but then also how does

1053
00:38:36,099 --> 00:38:40,450
somebody<font color="#CCCCCC"> log out more specifically so</font>

1054
00:38:39,010 --> 00:38:47,020
actually<font color="#CCCCCC"> let me scroll down just want to</font>

1055
00:38:40,450 --> 00:38:49,210
highlight a couple of these<font color="#E5E5E5"> all right so</font>

1056
00:38:47,020 --> 00:38:50,920
walking<font color="#E5E5E5"> through the process of how</font>

1057
00:38:49,210 --> 00:38:52,839
somebody logs in right now it's tracking

1058
00:38:50,920 --> 00:38:54,250
them<font color="#E5E5E5"> obviously once somebody logs in in</font>

1059
00:38:52,839 --> 00:38:56,349
this<font color="#E5E5E5"> case I</font><font color="#CCCCCC"> just did against Webb goat</font>

1060
00:38:54,250 --> 00:38:58,329
just<font color="#E5E5E5"> to quickly show something but after</font>

1061
00:38:56,349 --> 00:39:02,349
they<font color="#E5E5E5"> log in application should give out</font>

1062
00:38:58,329 --> 00:39:08,020
a new session ID right jsessionid 749

1063
00:39:02,349 --> 00:39:10,210
whatever it is<font color="#CCCCCC"> okay yes let go now the</font>

1064
00:39:08,020 --> 00:39:12,190
trick<font color="#E5E5E5"> now is how does somebody</font><font color="#CCCCCC"> log out</font>

1065
00:39:10,210 --> 00:39:13,869
so if you wanted to implement this

1066
00:39:12,190 --> 00:39:15,430
action you need to know<font color="#CCCCCC"> okay what do</font>

1067
00:39:13,869 --> 00:39:16,809
they do they go hit the button log out

1068
00:39:15,430 --> 00:39:19,990
yeah okay but<font color="#E5E5E5"> how does that look on the</font>

1069
00:39:16,809 --> 00:39:21,820
wire so in this case in web<font color="#E5E5E5"> go</font>

1070
00:39:19,990 --> 00:39:24,100
it'll pass a new parameter logout equals

1071
00:39:21,820 --> 00:39:26,530
true and the key piece you<font color="#E5E5E5"> need is the</font>

1072
00:39:24,100 --> 00:39:28,180
actual session ID and<font color="#E5E5E5"> web</font><font color="#CCCCCC"> code also</font><font color="#E5E5E5"> does</font>

1073
00:39:26,530 --> 00:39:29,380
basic off I should<font color="#CCCCCC"> probably don't have</font>

1074
00:39:28,180 --> 00:39:33,430
much<font color="#CCCCCC"> of that in the real world but</font>

1075
00:39:29,380 --> 00:39:38,110
that's how web goat has it so to define

1076
00:39:33,430 --> 00:39:41,890
this<font color="#E5E5E5"> in mud security the way that I</font>

1077
00:39:38,110 --> 00:39:43,750
<font color="#CCCCCC">implemented it in thus far is at the end</font>

1078
00:39:41,890 --> 00:39:45,759
<font color="#E5E5E5">of the request cycle we have a couple</font>

1079
00:39:43,750 --> 00:39:47,230
<font color="#CCCCCC">rules here that do the anomaly scoring</font>

1080
00:39:45,760 --> 00:39:48,970
validation to check what the anomaly

1081
00:39:47,230 --> 00:39:51,760
score is<font color="#E5E5E5"> you want to do blocking things</font>

1082
00:39:48,970 --> 00:39:53,259
like that so what I did is I was able<font color="#E5E5E5"> to</font>

1083
00:39:51,760 --> 00:39:55,360
update it with a couple<font color="#CCCCCC"> of</font><font color="#E5E5E5"> different</font>

1084
00:39:53,260 --> 00:39:57,190
actions here so we're saying if the

1085
00:39:55,360 --> 00:39:58,690
anomaly score is over whatever threshold

1086
00:39:57,190 --> 00:40:00,790
you're going to set to take this action

1087
00:39:58,690 --> 00:40:02,560
what we want to do is we want<font color="#E5E5E5"> to capture</font>

1088
00:40:00,790 --> 00:40:04,869
from the live request the person that's

1089
00:40:02,560 --> 00:40:07,540
attacking and who's logged in we<font color="#E5E5E5"> want to</font>

1090
00:40:04,869 --> 00:40:09,040
capture the request cookies that's what

1091
00:40:07,540 --> 00:40:10,450
this macro does grabs whatever their

1092
00:40:09,040 --> 00:40:13,360
current code key is in<font color="#E5E5E5"> this case it's</font>

1093
00:40:10,450 --> 00:40:14,470
jsessionid and because web goats doing

1094
00:40:13,360 --> 00:40:16,930
the weird stuff we also have<font color="#E5E5E5"> to grab the</font>

1095
00:40:14,470 --> 00:40:19,209
basic off pepper so we grabbed both of

1096
00:40:16,930 --> 00:40:24,040
those and<font color="#E5E5E5"> then we fire off this external</font>

1097
00:40:19,210 --> 00:40:26,080
script<font color="#E5E5E5"> log out Sh okay and you can see</font>

1098
00:40:24,040 --> 00:40:28,750
here the script is very very fancy it's

1099
00:40:26,080 --> 00:40:31,029
just calling a pearl right but as a

1100
00:40:28,750 --> 00:40:32,530
third-party device once we see this not

1101
00:40:31,030 --> 00:40:34,000
only do we want<font color="#E5E5E5"> to block what that user</font>

1102
00:40:32,530 --> 00:40:35,830
was doing because it's gone over our

1103
00:40:34,000 --> 00:40:38,760
anomaly score in the background we fire

1104
00:40:35,830 --> 00:40:45,490
off a new client request with their data

1105
00:40:38,760 --> 00:40:47,200
<font color="#E5E5E5">looking here right so this request</font>

1106
00:40:45,490 --> 00:40:50,259
actually gets sent to<font color="#E5E5E5"> the web server but</font>

1107
00:40:47,200 --> 00:40:51,879
it's from us so that way it would

1108
00:40:50,260 --> 00:40:53,560
forcefully log them out now if they go

1109
00:40:51,880 --> 00:40:55,960
to get back in they be kicked out and

1110
00:40:53,560 --> 00:40:57,430
have to go back<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the login page now</font>

1111
00:40:55,960 --> 00:40:59,440
what<font color="#CCCCCC"> was interesting and implementing</font>

1112
00:40:57,430 --> 00:41:00,640
this in the real world what we're

1113
00:40:59,440 --> 00:41:04,540
finding with a number of apps

1114
00:41:00,640 --> 00:41:06,850
unfortunately is<font color="#CCCCCC"> logout defects right</font>

1115
00:41:04,540 --> 00:41:08,650
<font color="#CCCCCC">we're what the application was doing was</font>

1116
00:41:06,850 --> 00:41:10,900
when you press log out all it did was

1117
00:41:08,650 --> 00:41:14,080
send down new cookies like delete cookie

1118
00:41:10,900 --> 00:41:15,760
but<font color="#E5E5E5"> it didn't expire at</font><font color="#CCCCCC"> server-side yeah</font>

1119
00:41:14,080 --> 00:41:17,140
so we're firing this thing off to kill

1120
00:41:15,760 --> 00:41:17,859
it meanwhile the bad guys<font color="#E5E5E5"> isn't doing</font>

1121
00:41:17,140 --> 00:41:19,180
what they're doing because they're

1122
00:41:17,859 --> 00:41:21,940
submitting that same one and server-side

1123
00:41:19,180 --> 00:41:23,580
to know it's still good so after<font color="#CCCCCC"> that</font>

1124
00:41:21,940 --> 00:41:26,440
lesson learned i had to go back in

1125
00:41:23,580 --> 00:41:28,569
because there's another app sensor

1126
00:41:26,440 --> 00:41:30,280
detection point where we can track the

1127
00:41:28,570 --> 00:41:32,530
session IDs as well we<font color="#E5E5E5"> have session</font>

1128
00:41:30,280 --> 00:41:33,290
types of detection points one of the

1129
00:41:32,530 --> 00:41:34,850
things we track

1130
00:41:33,290 --> 00:41:37,009
is when the application hands out<font color="#CCCCCC"> the</font>

1131
00:41:34,850 --> 00:41:39,410
set cookie after you<font color="#E5E5E5"> login we mark that</font>

1132
00:41:37,010 --> 00:41:41,120
cookie as valid locally in mud security

1133
00:41:39,410 --> 00:41:43,220
we know that's one<font color="#E5E5E5"> that the app gave out</font>

1134
00:41:41,120 --> 00:41:44,569
to you after you logged in that way of

1135
00:41:43,220 --> 00:41:47,000
people trying to<font color="#CCCCCC"> brute-force other ones</font>

1136
00:41:44,570 --> 00:41:48,920
they won't be valid right so the other

1137
00:41:47,000 --> 00:41:51,920
thing that we can add on down here and

1138
00:41:48,920 --> 00:41:55,010
here's the checks<font color="#E5E5E5"> that we do i added in</font>

1139
00:41:51,920 --> 00:41:56,930
this update down here where when we fire

1140
00:41:55,010 --> 00:41:59,330
off that script to log them off locally

1141
00:41:56,930 --> 00:42:01,250
in modsecurity we also mark that cookie

1142
00:41:59,330 --> 00:42:03,230
as invalid so that way if they try and

1143
00:42:01,250 --> 00:42:04,580
<font color="#E5E5E5">reuse it regardless of if it's sitting</font>

1144
00:42:03,230 --> 00:42:06,710
there<font color="#CCCCCC"> in the application and</font><font color="#E5E5E5"> it could</font><font color="#CCCCCC"> be</font>

1145
00:42:04,580 --> 00:42:08,029
used we're<font color="#E5E5E5"> saying it's</font><font color="#CCCCCC"> not valid so if</font>

1146
00:42:06,710 --> 00:42:12,890
they hit us first we're going to block

1147
00:42:08,030 --> 00:42:16,790
it and<font color="#CCCCCC"> save it</font><font color="#E5E5E5"> it's not good all right</font>

1148
00:42:12,890 --> 00:42:18,560
and<font color="#E5E5E5"> I</font><font color="#CCCCCC"> think that that was it so I know</font>

1149
00:42:16,790 --> 00:42:20,150
that's a real quick run-through I just

1150
00:42:18,560 --> 00:42:22,160
wanted<font color="#E5E5E5"> to give a status of what we're</font>

1151
00:42:20,150 --> 00:42:24,080
working on and to give<font color="#CCCCCC"> you some ideas on</font>

1152
00:42:22,160 --> 00:42:28,520
detection points that you could do

1153
00:42:24,080 --> 00:42:30,560
externally I will ask if anybody wants

1154
00:42:28,520 --> 00:42:32,900
to help we always<font color="#E5E5E5"> need help with</font><font color="#CCCCCC"> the</font>

1155
00:42:30,560 --> 00:42:34,940
rules we<font color="#CCCCCC"> have a active mailing list if</font>

1156
00:42:32,900 --> 00:42:36,800
<font color="#CCCCCC">you want to help</font><font color="#E5E5E5"> out you can actually</font><font color="#CCCCCC"> go</font>

1157
00:42:34,940 --> 00:42:38,480
in this case either one on the app

1158
00:42:36,800 --> 00:42:39,860
sensor one there is a lot of overlap and

1159
00:42:38,480 --> 00:42:42,920
how we're figuring out these detection

1160
00:42:39,860 --> 00:42:44,450
points on the detection<font color="#CCCCCC"> I didn't</font>

1161
00:42:42,920 --> 00:42:46,430
highlighted on<font color="#CCCCCC"> their each of those</font>

1162
00:42:44,450 --> 00:42:49,100
detection points on the project page at

1163
00:42:46,430 --> 00:42:50,870
the bottom there's a little links that

1164
00:42:49,100 --> 00:42:52,970
will go to example code like for java

1165
00:42:50,870 --> 00:42:55,520
there's a lot more there because it's a

1166
00:42:52,970 --> 00:42:57,980
<font color="#CCCCCC">Java code</font><font color="#E5E5E5"> just been worked on but like</font>

1167
00:42:55,520 --> 00:43:00,259
PHP and asp net or asp a lot of that

1168
00:42:57,980 --> 00:43:02,540
there's no code snippets for but i'm

1169
00:43:00,260 --> 00:43:03,770
<font color="#E5E5E5">going to go in and as i'm doing these in</font>

1170
00:43:02,540 --> 00:43:05,540
the core ruleset i'm going to go in<font color="#E5E5E5"> and</font>

1171
00:43:03,770 --> 00:43:07,040
put links to those as well but<font color="#E5E5E5"> if you</font>

1172
00:43:05,540 --> 00:43:08,630
want<font color="#E5E5E5"> to help with implementation of any</font>

1173
00:43:07,040 --> 00:43:09,950
of these<font color="#CCCCCC"> i'm sure to select project</font>

1174
00:43:08,630 --> 00:43:12,410
leaders<font color="#E5E5E5"> now and sign up for</font><font color="#CCCCCC"> the mail</font>

1175
00:43:09,950 --> 00:43:15,100
list and hopefully get some more help

1176
00:43:12,410 --> 00:43:15,100
all right<font color="#CCCCCC"> thank you</font>

1177
00:43:16,390 --> 00:43:18,450
you

