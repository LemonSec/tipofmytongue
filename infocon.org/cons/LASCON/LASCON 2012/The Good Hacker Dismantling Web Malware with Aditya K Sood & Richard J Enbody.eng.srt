1
00:00:00,000 --> 00:00:05,580
so to the talk is something like the boo

2
00:00:03,149 --> 00:00:07,200
hag occur dismantling web malware so

3
00:00:05,580 --> 00:00:08,940
this talk is an actually an outcome of

4
00:00:07,200 --> 00:00:10,800
some of the work that I have been doing

5
00:00:08,940 --> 00:00:12,780
as a back-end for many companies and

6
00:00:10,800 --> 00:00:16,289
some of the things<font color="#CCCCCC"> that I found missing</font>

7
00:00:12,780 --> 00:00:17,820
with them and maybe due to like business

8
00:00:16,289 --> 00:00:20,970
purposes may be due to like the time

9
00:00:17,820 --> 00:00:22,920
constraints so what I have done here is

10
00:00:20,970 --> 00:00:25,680
the part in order to set up this talk i

11
00:00:22,920 --> 00:00:27,060
have incorporated my research into some

12
00:00:25,680 --> 00:00:29,460
of the analysis that<font color="#CCCCCC"> I have done for</font>

13
00:00:27,060 --> 00:00:33,870
some companies and try to come<font color="#E5E5E5"> up with</font>

14
00:00:29,460 --> 00:00:35,969
<font color="#E5E5E5">the talk and we'll get it started so i</font>

15
00:00:33,870 --> 00:00:37,500
would like to lay a disclaimer so all

16
00:00:35,969 --> 00:00:39,450
the contents that<font color="#CCCCCC"> i'm going</font><font color="#E5E5E5"> to discuss</font>

17
00:00:37,500 --> 00:00:41,040
in this stock a solid on<font color="#E5E5E5"> my own</font><font color="#CCCCCC"> research</font>

18
00:00:39,450 --> 00:00:44,040
and does not relate to any of my

19
00:00:41,040 --> 00:00:46,440
employer and the dependency of the stock

20
00:00:44,040 --> 00:00:48,780
total eyes on the fact that how much you

21
00:00:46,440 --> 00:00:50,730
know penetration testing and how much

22
00:00:48,780 --> 00:00:52,260
<font color="#E5E5E5">you know where malware hunting and</font><font color="#CCCCCC"> i</font>

23
00:00:50,730 --> 00:00:53,819
really<font color="#CCCCCC"> want</font><font color="#E5E5E5"> to thanks the teacher for</font>

24
00:00:52,260 --> 00:00:56,820
supporting this chalk and<font color="#CCCCCC"> i think I</font>

25
00:00:53,820 --> 00:00:58,530
<font color="#CCCCCC">definitely tell you people to just go</font>

26
00:00:56,820 --> 00:01:01,649
and visit the booth it's a great<font color="#E5E5E5"> company</font>

27
00:00:58,530 --> 00:01:03,660
to work for so just a little background

28
00:01:01,649 --> 00:01:05,339
on mine what I'm doing I'm actually a

29
00:01:03,660 --> 00:01:07,350
founder<font color="#CCCCCC"> of second issue sexuality and</font>

30
00:01:05,339 --> 00:01:09,510
independent research labs where I just

31
00:01:07,350 --> 00:01:12,240
walk to as on a back-end researcher for

32
00:01:09,510 --> 00:01:14,189
many companies working side by side with

33
00:01:12,240 --> 00:01:16,679
my PhD I<font color="#E5E5E5"> previously worked for I</font>

34
00:01:14,189 --> 00:01:18,029
memorized<font color="#E5E5E5"> school zinc and KPMG regular</font>

35
00:01:16,680 --> 00:01:20,759
speaker at security and hacking

36
00:01:18,030 --> 00:01:22,950
conferences so love to<font color="#E5E5E5"> write a lot of</font>

37
00:01:20,759 --> 00:01:25,439
stuff on<font color="#E5E5E5"> my research and hacking aspects</font>

38
00:01:22,950 --> 00:01:30,780
of security and that is a collaborative

39
00:01:25,439 --> 00:01:32,789
work with my advisor so so what<font color="#E5E5E5"> the</font>

40
00:01:30,780 --> 00:01:34,979
equation<font color="#E5E5E5"> of this talk is all about so</font>

41
00:01:32,790 --> 00:01:36,600
this<font color="#CCCCCC"> is what the equation is</font><font color="#E5E5E5"> the fact</font>

42
00:01:34,979 --> 00:01:39,299
that if you want to be a good malware

43
00:01:36,600 --> 00:01:42,479
hunter a good hacker you need to have

44
00:01:39,299 --> 00:01:43,950
<font color="#E5E5E5">all these three basic things any guy was</font>

45
00:01:42,479 --> 00:01:45,990
working on a professional level as a

46
00:01:43,950 --> 00:01:48,149
security analyst security researcher

47
00:01:45,990 --> 00:01:49,979
penetration test or<font color="#E5E5E5"> whatever so if you</font>

48
00:01:48,149 --> 00:01:52,350
really<font color="#E5E5E5"> want to learn more</font><font color="#CCCCCC"> of like a</font>

49
00:01:49,979 --> 00:01:54,090
malware hunting you need to know all

50
00:01:52,350 --> 00:01:56,369
these three things so these are<font color="#CCCCCC"> the some</font>

51
00:01:54,090 --> 00:01:58,229
<font color="#E5E5E5">of the three basic pillars if you miss</font>

52
00:01:56,369 --> 00:02:00,060
one<font color="#E5E5E5"> of it you are missing</font><font color="#CCCCCC"> a lot of</font>

53
00:01:58,229 --> 00:02:02,070
things<font color="#E5E5E5"> and you probably not to get to</font>

54
00:02:00,060 --> 00:02:04,770
the point where you could be if you know

55
00:02:02,070 --> 00:02:07,380
all these three things so the might

56
00:02:04,770 --> 00:02:09,959
motivate of this talk is particularly to

57
00:02:07,380 --> 00:02:11,790
set up a benchmark try to discussing

58
00:02:09,959 --> 00:02:13,860
about the case studies that I have done

59
00:02:11,790 --> 00:02:15,600
and so the case study revolves

60
00:02:13,860 --> 00:02:18,930
round so how many have you heard about

61
00:02:15,600 --> 00:02:22,829
the blackhole exploit<font color="#CCCCCC"> pack and or maybe</font>

62
00:02:18,930 --> 00:02:24,480
<font color="#CCCCCC">spy I botnet</font><font color="#E5E5E5"> I hope must be yeah so</font>

63
00:02:22,830 --> 00:02:26,430
we'll let<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know how we pawn that and</font>

64
00:02:24,480 --> 00:02:30,510
how we find that vulnerable servers and

65
00:02:26,430 --> 00:02:32,370
how we hack them back into it so today

66
00:02:30,510 --> 00:02:34,230
gender revolves around the fact that we

67
00:02:32,370 --> 00:02:36,720
try<font color="#E5E5E5"> to look into the malware paradigm</font>

68
00:02:34,230 --> 00:02:38,820
and the<font color="#CCCCCC"> online world and then we try to</font>

69
00:02:36,720 --> 00:02:41,250
look into the reality of browsers why

70
00:02:38,820 --> 00:02:42,630
the reality of browsers just try to<font color="#E5E5E5"> look</font>

71
00:02:41,250 --> 00:02:45,510
into the what kind of browser version

72
00:02:42,630 --> 00:02:47,970
versions are still in use and<font color="#CCCCCC"> its really</font>

73
00:02:45,510 --> 00:02:49,769
good and its really required to industry

74
00:02:47,970 --> 00:02:51,300
on the browser malware taxonomy we

75
00:02:49,770 --> 00:02:54,420
<font color="#E5E5E5">publish their taxonomy in the virus</font>

76
00:02:51,300 --> 00:02:56,370
bulletin and it is being really required

77
00:02:54,420 --> 00:02:59,070
to understand what kind of malware we

78
00:02:56,370 --> 00:03:01,410
are dealing<font color="#CCCCCC"> with and so we're looking to</font>

79
00:02:59,070 --> 00:03:03,209
try<font color="#E5E5E5"> to set up a small brief introduction</font>

80
00:03:01,410 --> 00:03:05,370
about how web site infection works and

81
00:03:03,209 --> 00:03:08,100
the type of strategies used by the

82
00:03:05,370 --> 00:03:10,530
attackers and then why website traffic

83
00:03:08,100 --> 00:03:13,049
analysis is important<font color="#E5E5E5"> looking to the</font>

84
00:03:10,530 --> 00:03:15,060
<font color="#E5E5E5">methodology and right at the point</font>

85
00:03:13,050 --> 00:03:17,550
talking about the case study of black

86
00:03:15,060 --> 00:03:20,400
hole and<font color="#E5E5E5"> the spy I that will jump on to</font>

87
00:03:17,550 --> 00:03:23,070
the conclusion so let's<font color="#E5E5E5"> look at that and</font>

88
00:03:20,400 --> 00:03:25,650
at me<font color="#CCCCCC"> off malware it's some sort of</font>

89
00:03:23,070 --> 00:03:28,650
unbearable truth so you every day you

90
00:03:25,650 --> 00:03:30,090
find<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of news ruling notifications</font>

91
00:03:28,650 --> 00:03:32,610
about the fact that how the world is

92
00:03:30,090 --> 00:03:34,170
getting hampered by the web malware so

93
00:03:32,610 --> 00:03:36,269
these<font color="#CCCCCC"> are some other things and looking</font>

94
00:03:34,170 --> 00:03:37,980
the kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> frequency in this slide you</font>

95
00:03:36,269 --> 00:03:40,590
can see how much we are getting impacted

96
00:03:37,980 --> 00:03:41,910
by the web malware it's pretty<font color="#E5E5E5"> good you</font>

97
00:03:40,590 --> 00:03:43,769
understand the web application security

98
00:03:41,910 --> 00:03:45,930
and it's really<font color="#E5E5E5"> good because this is the</font>

99
00:03:43,769 --> 00:03:48,209
one part of<font color="#E5E5E5"> it but what after that if</font>

100
00:03:45,930 --> 00:03:49,950
you get exploited so we had a basic

101
00:03:48,209 --> 00:03:51,660
<font color="#E5E5E5">understanding preventing or you know</font>

102
00:03:49,950 --> 00:03:53,940
preserving some sort of vulnerabilities

103
00:03:51,660 --> 00:03:55,530
that are persisting in web apps we can

104
00:03:53,940 --> 00:03:58,590
cure<font color="#E5E5E5"> that but that is</font><font color="#CCCCCC"> not at all apart</font>

105
00:03:55,530 --> 00:04:00,390
it requires a<font color="#E5E5E5"> lot of other</font><font color="#CCCCCC"> things if I</font>

106
00:03:58,590 --> 00:04:02,370
talk about<font color="#CCCCCC"> a business perspective the</font>

107
00:04:00,390 --> 00:04:04,079
company was<font color="#CCCCCC"> doing of Bob app security</font><font color="#E5E5E5"> if</font>

108
00:04:02,370 --> 00:04:06,120
they have a good guys who know how to

109
00:04:04,080 --> 00:04:07,980
hunt malware you can start up your own

110
00:04:06,120 --> 00:04:10,860
service line by giving up an extra

111
00:04:07,980 --> 00:04:13,260
digital services to the guys yeah that's

112
00:04:10,860 --> 00:04:15,450
<font color="#CCCCCC">what I do so that's why it is</font><font color="#E5E5E5"> really</font>

113
00:04:13,260 --> 00:04:18,390
required to know all the artifacts in a

114
00:04:15,450 --> 00:04:23,010
detailed manner and how we look at the

115
00:04:18,390 --> 00:04:24,770
malware impact on real war well every

116
00:04:23,010 --> 00:04:27,060
single country is getting impacted by it

117
00:04:24,770 --> 00:04:27,330
maybe some of not where we<font color="#E5E5E5"> won't find</font>

118
00:04:27,060 --> 00:04:29,129
any

119
00:04:27,330 --> 00:04:31,789
internet in some parts of Africa and

120
00:04:29,129 --> 00:04:35,370
somewhere but rest of all everybody

121
00:04:31,789 --> 00:04:36,719
especially America so we need to<font color="#E5E5E5"> look</font>

122
00:04:35,370 --> 00:04:39,360
<font color="#E5E5E5">into the fact how diversity 5 this</font>

123
00:04:36,719 --> 00:04:41,280
malware is and it doesn't care about<font color="#CCCCCC"> the</font>

124
00:04:39,360 --> 00:04:43,590
cross borders or something like I'm in

125
00:04:41,280 --> 00:04:45,840
Israel I'm in Madrid it just internet

126
00:04:43,590 --> 00:04:48,030
and that's why we<font color="#CCCCCC"> really look into this</font>

127
00:04:45,840 --> 00:04:51,810
artifact why we really need<font color="#CCCCCC"> to hunt this</font>

128
00:04:48,030 --> 00:04:54,030
malware down and jumping<font color="#CCCCCC"> onto</font><font color="#E5E5E5"> the</font>

129
00:04:51,810 --> 00:04:56,039
<font color="#E5E5E5">underground malware I put this slide</font>

130
00:04:54,030 --> 00:04:57,270
because i really like it because I mean

131
00:04:56,039 --> 00:04:59,490
we are doing business<font color="#E5E5E5"> to provide</font>

132
00:04:57,270 --> 00:05:01,500
security features scatterflee services

133
00:04:59,490 --> 00:05:03,389
so what<font color="#E5E5E5"> is going on the underground</font>

134
00:05:01,500 --> 00:05:05,969
economy and this is what is going all

135
00:05:03,389 --> 00:05:08,550
around in the underground economy is

136
00:05:05,969 --> 00:05:12,330
similar to a virtual replica of what is

137
00:05:08,550 --> 00:05:14,460
<font color="#E5E5E5">going in here I so you can see the kind</font>

138
00:05:12,330 --> 00:05:17,430
of prices they have whether it's a 22

139
00:05:14,460 --> 00:05:19,799
you wrote 500 euro or whatever it<font color="#CCCCCC"> is but</font>

140
00:05:17,430 --> 00:05:21,539
everything<font color="#CCCCCC"> is getting sold out so let's</font>

141
00:05:19,800 --> 00:05:23,219
say for example a botnet is why the

142
00:05:21,539 --> 00:05:24,509
people<font color="#E5E5E5"> are running partner maybe they</font>

143
00:05:23,219 --> 00:05:26,009
are not<font color="#E5E5E5"> trying to use that some of the</font>

144
00:05:24,509 --> 00:05:28,409
information they want to sell that<font color="#E5E5E5"> up</font>

145
00:05:26,009 --> 00:05:30,360
and that's why they are doing it so they

146
00:05:28,409 --> 00:05:32,340
sell your rackets they sell your email

147
00:05:30,360 --> 00:05:34,949
addresses<font color="#CCCCCC"> and</font><font color="#E5E5E5"> is something like five</font>

148
00:05:32,340 --> 00:05:36,869
hundred dollars for per 10,000 rackets

149
00:05:34,949 --> 00:05:38,969
for the emails and<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> how</font><font color="#E5E5E5"> they sell</font>

150
00:05:36,870 --> 00:05:41,550
to the fishers and that's what they do

151
00:05:38,969 --> 00:05:44,279
so this is<font color="#CCCCCC"> a really bad aspect but this</font>

152
00:05:41,550 --> 00:05:47,599
is the bitter truth of our security

153
00:05:44,279 --> 00:05:49,860
business and to the<font color="#CCCCCC"> underground economy</font>

154
00:05:47,599 --> 00:05:52,259
just try<font color="#E5E5E5"> to get you in touch with the</font>

155
00:05:49,860 --> 00:05:54,089
how the malware flow model works so

156
00:05:52,259 --> 00:05:56,580
jumping<font color="#CCCCCC"> on to the underground</font><font color="#E5E5E5"> economy</font>

157
00:05:54,089 --> 00:06:00,000
people have a virus writers then they

158
00:05:56,580 --> 00:06:01,650
have a website<font color="#E5E5E5"> master crackers they used</font>

159
00:06:00,000 --> 00:06:03,990
to use<font color="#E5E5E5"> a term called as</font><font color="#CCCCCC"> envelope</font>

160
00:06:01,650 --> 00:06:06,539
<font color="#CCCCCC">Steelers what you</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> a set Steelers so</font>

161
00:06:03,990 --> 00:06:08,039
just a model how it actually works right

162
00:06:06,539 --> 00:06:10,378
from<font color="#E5E5E5"> the start how they in fact your</font>

163
00:06:08,039 --> 00:06:12,750
website to<font color="#CCCCCC"> the point how they steal the</font>

164
00:06:10,379 --> 00:06:14,639
credentials out of your<font color="#CCCCCC"> website it is</font>

165
00:06:12,750 --> 00:06:16,409
only good to look into the visualization

166
00:06:14,639 --> 00:06:18,360
impact of this factor just try to get

167
00:06:16,409 --> 00:06:21,930
<font color="#E5E5E5">you more understanding why it is being</font>

168
00:06:18,360 --> 00:06:23,610
<font color="#E5E5E5">required and so you first tell you look</font>

169
00:06:21,930 --> 00:06:26,099
at the malware writers through what they

170
00:06:23,610 --> 00:06:28,199
do then<font color="#E5E5E5"> you look at the flow of malware</font>

171
00:06:26,099 --> 00:06:29,940
websites how they impact and how they

172
00:06:28,199 --> 00:06:33,839
exploit the vulnerabilities and web

173
00:06:29,940 --> 00:06:35,729
sites and that's the real peculiar mod

174
00:06:33,839 --> 00:06:37,620
of the how the malware flow model works

175
00:06:35,729 --> 00:06:39,479
in the underground economy and with

176
00:06:37,620 --> 00:06:40,249
every point when you get the things done

177
00:06:39,479 --> 00:06:42,438
when<font color="#CCCCCC"> you come</font>

178
00:06:40,249 --> 00:06:44,629
complete your target<font color="#E5E5E5"> you get paid for it</font>

179
00:06:42,439 --> 00:06:46,639
<font color="#E5E5E5">when you sell so everybody have a</font>

180
00:06:44,629 --> 00:06:49,549
specific role in here the wider<font color="#E5E5E5"> Steelers</font>

181
00:06:46,639 --> 00:06:51,169
envelope guys and the wireless writers

182
00:06:49,549 --> 00:06:52,998
so they pay according to that they

183
00:06:51,169 --> 00:06:54,938
played a role to get the full process

184
00:06:52,999 --> 00:06:58,249
functioning in the underground economy

185
00:06:54,939 --> 00:07:00,709
and this with the real is so

186
00:06:58,249 --> 00:07:02,119
understanding the reality of browsers so

187
00:07:00,709 --> 00:07:05,059
you can look at the scenario this<font color="#E5E5E5"> is</font>

188
00:07:02,119 --> 00:07:07,909
<font color="#E5E5E5">some sort of a visualization</font><font color="#CCCCCC"> I get from</font>

189
00:07:05,059 --> 00:07:11,149
the<font color="#E5E5E5"> isaacs condo.com and what they say</font>

190
00:07:07,909 --> 00:07:13,039
about the<font color="#E5E5E5"> usage of ie6 in this present</font>

191
00:07:11,149 --> 00:07:15,259
time till the<font color="#E5E5E5"> time the Microsoft has</font>

192
00:07:13,039 --> 00:07:17,659
released<font color="#E5E5E5"> Internet Explorer 8 plus and</font>

193
00:07:15,259 --> 00:07:19,789
they are working<font color="#E5E5E5"> on ie9 so many</font>

194
00:07:17,659 --> 00:07:23,479
<font color="#E5E5E5">countries so many organization are still</font>

195
00:07:19,789 --> 00:07:26,119
using the IE<font color="#E5E5E5"> 6 so this can gives us an</font>

196
00:07:23,479 --> 00:07:28,849
idea dependency on the dependency factor

197
00:07:26,119 --> 00:07:31,399
that between<font color="#E5E5E5"> the ie6 and I een ein if</font>

198
00:07:28,849 --> 00:07:33,438
they're vulnerable<font color="#E5E5E5"> versions of Internet</font>

199
00:07:31,399 --> 00:07:36,699
Explorer is running how much they are

200
00:07:33,439 --> 00:07:38,839
impacting the wall so the world still

201
00:07:36,699 --> 00:07:40,789
you know beasts on this internet

202
00:07:38,839 --> 00:07:44,059
explorer thing and this gives me<font color="#E5E5E5"> the</font>

203
00:07:40,789 --> 00:07:45,889
<font color="#CCCCCC">impression that old habits die hard so</font>

204
00:07:44,059 --> 00:07:50,179
as the whole browsers still<font color="#E5E5E5"> many</font>

205
00:07:45,889 --> 00:07:51,499
organization<font color="#CCCCCC"> lane</font><font color="#E5E5E5"> and running ie6 the</font>

206
00:07:50,179 --> 00:07:53,208
threat model that's lies in the fact

207
00:07:51,499 --> 00:07:55,249
that older versions if they not patched

208
00:07:53,209 --> 00:07:58,309
appropriately things can be really

209
00:07:55,249 --> 00:08:00,229
sarcastic for<font color="#CCCCCC"> the organization and the</font>

210
00:07:58,309 --> 00:08:02,209
basic problems lies here the fact that

211
00:08:00,229 --> 00:08:03,589
organization don't<font color="#E5E5E5"> want to change maybe</font>

212
00:08:02,209 --> 00:08:05,389
<font color="#E5E5E5">because of business maybe because of</font>

213
00:08:03,589 --> 00:08:08,059
<font color="#E5E5E5">money that is required</font><font color="#CCCCCC"> to change the</font>

214
00:08:05,389 --> 00:08:09,619
whole scenario and I know many<font color="#E5E5E5"> of the</font>

215
00:08:08,059 --> 00:08:12,319
companies organization are still running

216
00:08:09,619 --> 00:08:14,979
this may be some has shifty<font color="#CCCCCC"> to ie7 but</font>

217
00:08:12,319 --> 00:08:17,899
this<font color="#E5E5E5"> is the bitter truth that we are</font>

218
00:08:14,979 --> 00:08:19,549
<font color="#CCCCCC">camping</font><font color="#E5E5E5"> with us so in order to</font>

219
00:08:17,899 --> 00:08:21,409
understand<font color="#E5E5E5"> what I'm going</font><font color="#CCCCCC"> to present I</font>

220
00:08:19,549 --> 00:08:24,099
want to give you a brief introduction

221
00:08:21,409 --> 00:08:26,719
how the browser malware taxonomy works

222
00:08:24,099 --> 00:08:28,969
and after were doing lot of analysis in

223
00:08:26,719 --> 00:08:30,679
the malware we thought to came across

224
00:08:28,969 --> 00:08:33,068
this and to write this malware taxonomy

225
00:08:30,679 --> 00:08:36,259
because we feel that<font color="#E5E5E5"> there's a lot of</font>

226
00:08:33,068 --> 00:08:38,299
misinterpretations in the online world

227
00:08:36,259 --> 00:08:40,519
about how the browser components work

228
00:08:38,299 --> 00:08:42,289
the first one is I mean it's really<font color="#CCCCCC"> hard</font>

229
00:08:40,519 --> 00:08:43,669
to distinguish between I mean when I

230
00:08:42,289 --> 00:08:46,089
<font color="#E5E5E5">talk with a lot of guys what's the</font>

231
00:08:43,669 --> 00:08:48,860
<font color="#E5E5E5">difference between an add-on</font><font color="#CCCCCC"> plugin and</font>

232
00:08:46,089 --> 00:08:51,649
then the extensibility model of browsers

233
00:08:48,860 --> 00:08:54,020
and all those sort of things and this

234
00:08:51,649 --> 00:08:55,700
particular diagrams the<font color="#CCCCCC"> class a so</font>

235
00:08:54,020 --> 00:08:58,640
he actually divided those category into

236
00:08:55,700 --> 00:09:00,200
<font color="#E5E5E5">class a plus B and Class C malware if</font>

237
00:08:58,640 --> 00:09:01,910
you want to look at<font color="#E5E5E5"> the bond to look at</font>

238
00:09:00,200 --> 00:09:04,850
the details of this paper you can ping

239
00:09:01,910 --> 00:09:06,920
me up<font color="#E5E5E5"> but it is</font><font color="#CCCCCC"> if you already you know</font>

240
00:09:04,850 --> 00:09:09,350
having subscription to waters bulletin

241
00:09:06,920 --> 00:09:11,060
you can definitely<font color="#CCCCCC"> go through it so the</font>

242
00:09:09,350 --> 00:09:13,850
basic understanding of this is any

243
00:09:11,060 --> 00:09:16,010
malware that runs as an add-on in a

244
00:09:13,850 --> 00:09:18,320
browser it means as a component in a

245
00:09:16,010 --> 00:09:20,270
browser what<font color="#E5E5E5"> they suggest that you are</font>

246
00:09:18,320 --> 00:09:22,640
running a no script firefox add-on right

247
00:09:20,270 --> 00:09:25,189
as a similar sort of<font color="#E5E5E5"> add on that resides</font>

248
00:09:22,640 --> 00:09:27,110
in the browser process itself so<font color="#E5E5E5"> that's</font>

249
00:09:25,190 --> 00:09:30,350
why I project it<font color="#CCCCCC"> is as a circle</font><font color="#E5E5E5"> and the</font>

250
00:09:27,110 --> 00:09:31,970
<font color="#E5E5E5">mallory reside in the browser process so</font>

251
00:09:30,350 --> 00:09:34,970
the<font color="#E5E5E5"> good point about this part is that</font>

252
00:09:31,970 --> 00:09:36,620
<font color="#E5E5E5">all the credentials and all the access</font>

253
00:09:34,970 --> 00:09:39,460
rights that a particular browser process

254
00:09:36,620 --> 00:09:42,470
has the<font color="#E5E5E5"> add-ons has access to it and</font>

255
00:09:39,460 --> 00:09:44,750
that's why the class a browser<font color="#E5E5E5"> malware</font>

256
00:09:42,470 --> 00:09:47,060
also been dumbed as a browser rootkits

257
00:09:44,750 --> 00:09:48,740
not much research has been done on to it

258
00:09:47,060 --> 00:09:50,869
but one or two people from researchers

259
00:09:48,740 --> 00:09:54,050
from Symantec has projected this fact

260
00:09:50,870 --> 00:09:55,310
but<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a big problem so you must</font>

261
00:09:54,050 --> 00:09:56,660
<font color="#CCCCCC">have heard about</font><font color="#E5E5E5"> if you go through all</font>

262
00:09:55,310 --> 00:09:58,969
<font color="#E5E5E5">the news now these there isn't a</font>

263
00:09:56,660 --> 00:10:01,160
transaction stealer who performs

264
00:09:58,970 --> 00:10:03,410
transactions through the concept or man

265
00:10:01,160 --> 00:10:05,480
in the browser and that is where this

266
00:10:03,410 --> 00:10:07,520
class a browser malware works the

267
00:10:05,480 --> 00:10:10,340
add-ons that resides inside in the

268
00:10:07,520 --> 00:10:12,260
browser process and if you<font color="#E5E5E5"> look into the</font>

269
00:10:10,340 --> 00:10:14,600
<font color="#E5E5E5">class b browser malware it is something</font>

270
00:10:12,260 --> 00:10:17,150
relates to the plugins plugins like

271
00:10:14,600 --> 00:10:19,760
<font color="#E5E5E5">Adobe plugins flash plugins and the</font>

272
00:10:17,150 --> 00:10:23,560
basic thin line of<font color="#E5E5E5"> differences the fact</font>

273
00:10:19,760 --> 00:10:26,060
here is that this browser process is not

274
00:10:23,560 --> 00:10:27,949
encompassing the browser<font color="#E5E5E5"> be male Class B</font>

275
00:10:26,060 --> 00:10:29,810
malware so what it's doing<font color="#CCCCCC"> the</font><font color="#E5E5E5"> plugin</font>

276
00:10:27,950 --> 00:10:32,390
process run in a separate address space

277
00:10:29,810 --> 00:10:34,640
in the sandbox but with the incessant

278
00:10:32,390 --> 00:10:37,540
vulnerabilities that are present in some

279
00:10:34,640 --> 00:10:40,610
sort of Adobe Flash plugins<font color="#CCCCCC"> you know</font>

280
00:10:37,540 --> 00:10:42,230
doesn't cure the sandbox functionality

281
00:10:40,610 --> 00:10:44,480
much because you can bypass it with

282
00:10:42,230 --> 00:10:47,180
exploit mechanisms some sort of such as

283
00:10:44,480 --> 00:10:48,860
like<font color="#E5E5E5"> JavaScript heap spying and then</font>

284
00:10:47,180 --> 00:10:50,660
from that they exploit the<font color="#CCCCCC"> plugin</font>

285
00:10:48,860 --> 00:10:52,610
process they exploit the<font color="#E5E5E5"> plugin</font>

286
00:10:50,660 --> 00:10:55,100
vulnerabilities to drop down the malware

287
00:10:52,610 --> 00:10:56,660
into your system and<font color="#CCCCCC"> that is where the</font>

288
00:10:55,100 --> 00:10:58,850
entry point is where they exploit the

289
00:10:56,660 --> 00:11:01,730
plugins and this nothing has to deal

290
00:10:58,850 --> 00:11:03,410
with the browser add-ons it's a plugins

291
00:11:01,730 --> 00:11:05,540
so there's a lot<font color="#CCCCCC"> of difference between</font>

292
00:11:03,410 --> 00:11:07,050
add-ons and plugins and if you surf on

293
00:11:05,540 --> 00:11:09,029
<font color="#CCCCCC">the internet you will find a lot of</font>

294
00:11:07,050 --> 00:11:11,250
more definitions which is not good

295
00:11:09,029 --> 00:11:13,050
<font color="#E5E5E5">enough cause to understand a browser</font>

296
00:11:11,250 --> 00:11:15,000
malware what kind of malware I'm

297
00:11:13,050 --> 00:11:16,890
analyzing I need to understand the<font color="#E5E5E5"> tech</font>

298
00:11:15,000 --> 00:11:18,600
<font color="#E5E5E5">sauna me otherwise</font><font color="#CCCCCC"> just like a</font>

299
00:11:16,890 --> 00:11:20,939
peripheral level research we are doing

300
00:11:18,600 --> 00:11:25,649
and will not<font color="#E5E5E5"> be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to get to the right</font>

301
00:11:20,940 --> 00:11:27,779
point and the last two-plus email you a

302
00:11:25,649 --> 00:11:29,579
taxonomist just the fact that we have a

303
00:11:27,779 --> 00:11:32,310
browser process we have a<font color="#E5E5E5"> plug-in</font>

304
00:11:29,579 --> 00:11:33,959
process but looking into the base we

305
00:11:32,310 --> 00:11:36,469
have an<font color="#E5E5E5"> operating system kernel and the</font>

306
00:11:33,959 --> 00:11:39,300
malware is installed in the system so

307
00:11:36,470 --> 00:11:41,820
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> very lame in terms like Class A</font>

308
00:11:39,300 --> 00:11:43,979
Class B or Class C malware have an

309
00:11:41,820 --> 00:11:45,899
interdependence e factor<font color="#CCCCCC"> so if somebody</font>

310
00:11:43,980 --> 00:11:49,170
exploits the vulnerability in<font color="#CCCCCC"> Adobe or a</font>

311
00:11:45,899 --> 00:11:51,630
flash plugin it drops down the malicious

312
00:11:49,170 --> 00:11:53,160
executable and this could<font color="#E5E5E5"> be a classy</font>

313
00:11:51,630 --> 00:11:57,290
malware which is installed<font color="#E5E5E5"> in your</font>

314
00:11:53,160 --> 00:11:59,699
system so this actually all these three

315
00:11:57,290 --> 00:12:01,949
classes gives you a better<font color="#CCCCCC"> understanding</font>

316
00:11:59,700 --> 00:12:03,870
of what a browser malware or how the

317
00:12:01,950 --> 00:12:07,410
browser is getting exploited in the wild

318
00:12:03,870 --> 00:12:10,500
and this is the truth<font color="#E5E5E5"> and we can't deny</font>

319
00:12:07,410 --> 00:12:12,120
it and but as far as I sing like right

320
00:12:10,500 --> 00:12:14,370
from the start of the talk if you really

321
00:12:12,120 --> 00:12:16,709
want to hunt malware you really know

322
00:12:14,370 --> 00:12:18,810
what you are dealing with<font color="#E5E5E5"> I mean if</font>

323
00:12:16,709 --> 00:12:21,000
you're analyzing a Class B malware and

324
00:12:18,810 --> 00:12:22,589
you're looking<font color="#E5E5E5"> into classy aspects or</font>

325
00:12:21,000 --> 00:12:24,510
crack teristics of that Mallory doesn't

326
00:12:22,589 --> 00:12:28,050
doesn't doesn't be a fruitful experience

327
00:12:24,510 --> 00:12:29,370
for anybody and not for your clients so

328
00:12:28,050 --> 00:12:33,270
this<font color="#E5E5E5"> is something is all about like</font>

329
00:12:29,370 --> 00:12:34,890
browser malware taxonomy and jumping on

330
00:12:33,270 --> 00:12:37,290
to<font color="#E5E5E5"> the next</font><font color="#CCCCCC"> pack I want to</font><font color="#E5E5E5"> lay about</font>

331
00:12:34,890 --> 00:12:41,459
some<font color="#E5E5E5"> sort of web site infection that</font><font color="#CCCCCC"> is</font>

332
00:12:37,290 --> 00:12:43,740
a really laying stress nowadays so long

333
00:12:41,459 --> 00:12:46,800
live iframe injections nothing can cure

334
00:12:43,740 --> 00:12:48,390
it because why the malware<font color="#CCCCCC"> persisting to</font>

335
00:12:46,800 --> 00:12:51,180
the bevel is I think<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> just because</font>

336
00:12:48,390 --> 00:12:53,279
of<font color="#E5E5E5"> JavaScript we cannot live with it we</font>

337
00:12:51,180 --> 00:12:54,870
cannot you know lose JavaScript because

338
00:12:53,279 --> 00:12:57,300
javascript is something where all the

339
00:12:54,870 --> 00:12:59,190
web businesses based one and that's why

340
00:12:57,300 --> 00:13:02,339
the attack surface is so large because

341
00:12:59,190 --> 00:13:04,769
of javascript is really hard to cure<font color="#CCCCCC"> it</font>

342
00:13:02,339 --> 00:13:06,300
I mean you cannot remove<font color="#CCCCCC"> javascript out</font>

343
00:13:04,769 --> 00:13:09,540
of the web and say like we can build a

344
00:13:06,300 --> 00:13:12,089
new web based on semantics but that's

345
00:13:09,540 --> 00:13:15,569
not possible javascript is the heart of

346
00:13:12,089 --> 00:13:17,070
web security and the web development<font color="#E5E5E5"> so</font>

347
00:13:15,570 --> 00:13:18,860
that's why all the what are<font color="#CCCCCC"> the</font>

348
00:13:17,070 --> 00:13:20,910
possibilities and what are the kind of

349
00:13:18,860 --> 00:13:22,710
the functionality provided

350
00:13:20,910 --> 00:13:24,870
by javascript is getting exploited by

351
00:13:22,710 --> 00:13:27,780
the malware so in this particular thing

352
00:13:24,870 --> 00:13:29,310
we have an iframe injections how can I

353
00:13:27,780 --> 00:13:31,800
high frame injection works because I

354
00:13:29,310 --> 00:13:34,140
<font color="#CCCCCC">fray means in framing in line framing</font>

355
00:13:31,800 --> 00:13:36,180
and so here is the fact that you look at

356
00:13:34,140 --> 00:13:38,460
the iframe source you<font color="#E5E5E5"> can make it</font><font color="#CCCCCC"> hidden</font>

357
00:13:36,180 --> 00:13:40,920
that you know points to there some sort

358
00:13:38,460 --> 00:13:42,630
of<font color="#CCCCCC"> third-world</font><font color="#E5E5E5"> label party and you</font>

359
00:13:40,920 --> 00:13:44,550
whenever<font color="#E5E5E5"> that particular web page</font><font color="#CCCCCC"> is</font>

360
00:13:42,630 --> 00:13:46,350
loaded it you know fetches that content

361
00:13:44,550 --> 00:13:50,880
and injects our content into your own

362
00:13:46,350 --> 00:13:52,890
domain and the<font color="#E5E5E5"> latest exploitation</font>

363
00:13:50,880 --> 00:13:55,200
tactics that are being<font color="#CCCCCC"> used by the guys</font>

364
00:13:52,890 --> 00:13:57,689
are<font color="#E5E5E5"> called</font><font color="#CCCCCC"> malva tinsmiths it's a really</font>

365
00:13:55,200 --> 00:13:59,640
really bad stitcher and<font color="#E5E5E5"> I have been</font>

366
00:13:57,690 --> 00:14:01,110
contacted by some of the<font color="#E5E5E5"> guys and I want</font>

367
00:13:59,640 --> 00:14:03,330
to<font color="#E5E5E5"> share the story it's the back story</font>

368
00:14:01,110 --> 00:14:05,190
but it's a really good<font color="#E5E5E5"> a real face set</font>

369
00:14:03,330 --> 00:14:08,780
of other businesses going on so that guy

370
00:14:05,190 --> 00:14:12,420
actually wants us to do some<font color="#E5E5E5"> sort of</font>

371
00:14:08,780 --> 00:14:14,160
hijacking proof of concept so where the

372
00:14:12,420 --> 00:14:15,689
guy can so he actually wrote<font color="#E5E5E5"> our</font>

373
00:14:14,160 --> 00:14:18,060
<font color="#E5E5E5">software that's called as an</font>

374
00:14:15,690 --> 00:14:19,650
advertisement hijacker and they want all

375
00:14:18,060 --> 00:14:22,140
the google ads to be displayed<font color="#CCCCCC"> on</font>

376
00:14:19,650 --> 00:14:24,209
different websites to be hijacked with

377
00:14:22,140 --> 00:14:25,890
their own plugin so class say they wrote

378
00:14:24,210 --> 00:14:28,310
of some sort of class a browser malware

379
00:14:25,890 --> 00:14:31,410
that access i installed as a plugin as

380
00:14:28,310 --> 00:14:33,390
an add-on into your browser and hijacks

381
00:14:31,410 --> 00:14:35,160
all the google ads and replaces it with

382
00:14:33,390 --> 00:14:37,080
their own ass so<font color="#E5E5E5"> that they can more and</font>

383
00:14:35,160 --> 00:14:38,280
more traffic out of it and this is the

384
00:14:37,080 --> 00:14:41,160
true fact and they are playing like

385
00:14:38,280 --> 00:14:43,380
quite high amount of money for that so

386
00:14:41,160 --> 00:14:45,480
the whole scenario of sharing this story

387
00:14:43,380 --> 00:14:47,490
is<font color="#CCCCCC"> the fact that you can look into the</font>

388
00:14:45,480 --> 00:14:50,250
fact how the browser malware is going on

389
00:14:47,490 --> 00:14:52,560
and the<font color="#E5E5E5"> basic problem is how the</font>

390
00:14:50,250 --> 00:14:54,090
business is going on so we are laying a

391
00:14:52,560 --> 00:14:55,770
lot of red alerts on the like

392
00:14:54,090 --> 00:14:58,340
underground economy so what we are<font color="#CCCCCC"> doing</font>

393
00:14:55,770 --> 00:15:00,510
on the website it's a business and

394
00:14:58,340 --> 00:15:02,100
everybody wants<font color="#CCCCCC"> to follow all sorts of</font>

395
00:15:00,510 --> 00:15:03,689
<font color="#CCCCCC">paths to get the things done one or the</font>

396
00:15:02,100 --> 00:15:06,300
other way whether it's a white or black

397
00:15:03,690 --> 00:15:08,670
or jump<font color="#E5E5E5"> on to agree but they are doing</font>

398
00:15:06,300 --> 00:15:12,209
it that is a real truth this is working

399
00:15:08,670 --> 00:15:14,579
<font color="#E5E5E5">and then we have a rock</font><font color="#CCCCCC"> jas some sort of</font>

400
00:15:12,210 --> 00:15:17,820
flash files of course works in the

401
00:15:14,580 --> 00:15:19,470
similar manner and then what are<font color="#E5E5E5"> the</font>

402
00:15:17,820 --> 00:15:22,800
other things you haven't look into many

403
00:15:19,470 --> 00:15:24,510
things like why look into<font color="#CCCCCC"> a lot of news</font>

404
00:15:22,800 --> 00:15:27,120
where<font color="#CCCCCC"> you see that</font><font color="#E5E5E5"> there is a 150</font>

405
00:15:24,510 --> 00:15:29,340
websites are getting defaced I mean how

406
00:15:27,120 --> 00:15:31,620
<font color="#CCCCCC">okay how what's the reason have anybody</font>

407
00:15:29,340 --> 00:15:34,380
thought like how they you know exploit

408
00:15:31,620 --> 00:15:34,830
150 websites and a<font color="#E5E5E5"> single shot maybe one</font>

409
00:15:34,380 --> 00:15:37,400
is

410
00:15:34,830 --> 00:15:40,140
okay two is ok but no no fun 50 websites

411
00:15:37,400 --> 00:15:43,170
exploitation works because<font color="#CCCCCC"> of web</font>

412
00:15:40,140 --> 00:15:45,150
virtual hosting so we wrote a one good

413
00:15:43,170 --> 00:15:46,979
paper about how this works in<font color="#E5E5E5"> the hack</font>

414
00:15:45,150 --> 00:15:49,199
in the box magazine with<font color="#CCCCCC"> the I</font><font color="#E5E5E5"> think in</font>

415
00:15:46,980 --> 00:15:53,160
the previous issues you can fetch that

416
00:15:49,200 --> 00:15:55,050
it is you know totally free<font color="#CCCCCC"> so once we</font>

417
00:15:53,160 --> 00:15:56,939
have a server which having a 150

418
00:15:55,050 --> 00:16:00,630
websites hosted on and this is call it

419
00:15:56,940 --> 00:16:02,610
up web virtual hosting right it's a you

420
00:16:00,630 --> 00:16:04,380
can say it's a problem<font color="#E5E5E5"> of design how</font>

421
00:16:02,610 --> 00:16:06,330
they do virtual hosting or maybe by

422
00:16:04,380 --> 00:16:08,550
default if you get an<font color="#CCCCCC"> access to one</font>

423
00:16:06,330 --> 00:16:10,830
website you can d face all the other

424
00:16:08,550 --> 00:16:12,420
websites so let's say your website is

425
00:16:10,830 --> 00:16:14,100
being hosted on a one particular domain

426
00:16:12,420 --> 00:16:16,170
let's<font color="#E5E5E5"> gonna go daddy and they are</font>

427
00:16:14,100 --> 00:16:18,720
hosting like a 150 200 websites on the

428
00:16:16,170 --> 00:16:20,670
<font color="#E5E5E5">same server and there is a some you know</font>

429
00:16:18,720 --> 00:16:23,610
uploading functionality present on

430
00:16:20,670 --> 00:16:25,589
website you upload like<font color="#E5E5E5"> c99 or any</font>

431
00:16:23,610 --> 00:16:27,150
exploitation shall over it the shell

432
00:16:25,590 --> 00:16:29,220
automatically you know do the privilege

433
00:16:27,150 --> 00:16:32,250
escalation and with a single script you

434
00:16:29,220 --> 00:16:34,380
<font color="#E5E5E5">can</font><font color="#CCCCCC"> defeat all the websites so that is</font>

435
00:16:32,250 --> 00:16:37,350
<font color="#E5E5E5">the basic problem with the web virtual</font>

436
00:16:34,380 --> 00:16:38,520
hosting is and that's why most of the

437
00:16:37,350 --> 00:16:40,020
businesses are getting suffered they

438
00:16:38,520 --> 00:16:41,819
think like they are pretty<font color="#CCCCCC"> okay maybe</font>

439
00:16:40,020 --> 00:16:44,699
they have good controls in place but

440
00:16:41,820 --> 00:16:47,880
they cannot control the virtual hosting

441
00:16:44,700 --> 00:16:49,500
and it is a big problem we have open

442
00:16:47,880 --> 00:16:51,240
relay service that's what the fishing

443
00:16:49,500 --> 00:16:53,400
and<font color="#E5E5E5"> scammers what they do they do all</font>

444
00:16:51,240 --> 00:16:55,590
these factors they just you know hack

445
00:16:53,400 --> 00:16:58,010
somebody's email server organization and

446
00:16:55,590 --> 00:17:01,860
try to use<font color="#E5E5E5"> it as an open relay server</font>

447
00:16:58,010 --> 00:17:03,990
ftp servers pretty good and of course

448
00:17:01,860 --> 00:17:05,220
<font color="#E5E5E5">there's a database servers and we know</font>

449
00:17:03,990 --> 00:17:08,069
that<font color="#CCCCCC"> there's a persistent sequel</font>

450
00:17:05,220 --> 00:17:10,440
injection attacks and using that you can

451
00:17:08,069 --> 00:17:12,119
incorporate or you can even inject a

452
00:17:10,440 --> 00:17:14,610
some<font color="#E5E5E5"> sort of accesses payload into the</font>

453
00:17:12,119 --> 00:17:16,770
draw format in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> backend database as</font>

454
00:17:14,609 --> 00:17:19,770
soon as you load a particular<font color="#CCCCCC"> wrap page</font>

455
00:17:16,770 --> 00:17:21,959
it extracts<font color="#E5E5E5"> all that data out from the</font>

456
00:17:19,770 --> 00:17:24,240
database<font color="#E5E5E5"> and render it as an</font><font color="#CCCCCC"> exercise</font>

457
00:17:21,959 --> 00:17:26,970
payload in your browser and that's how

458
00:17:24,240 --> 00:17:29,340
you get bond was recently like in 2010

459
00:17:26,970 --> 00:17:31,260
we analyzed<font color="#CCCCCC"> i work with our eyes so we</font>

460
00:17:29,340 --> 00:17:34,379
<font color="#CCCCCC">analyze like the mass</font><font color="#E5E5E5"> Tikal injection</font>

461
00:17:31,260 --> 00:17:36,690
and that is exploiting the asp.net stuff

462
00:17:34,380 --> 00:17:39,330
and that is based on the similar concept

463
00:17:36,690 --> 00:17:41,430
the exploit a vulnerability in asp.net

464
00:17:39,330 --> 00:17:44,100
dude or something version and start

465
00:17:41,430 --> 00:17:45,570
making it a chain reaction and with the

466
00:17:44,100 --> 00:17:46,949
passage of<font color="#CCCCCC"> time they got</font><font color="#E5E5E5"> raw used to</font>

467
00:17:45,570 --> 00:17:49,950
like 12,000

468
00:17:46,950 --> 00:17:52,410
fifteen thousand infections and of

469
00:17:49,950 --> 00:17:54,330
course the<font color="#E5E5E5"> last</font><font color="#CCCCCC"> spar</font><font color="#E5E5E5"> void or web site</font>

470
00:17:52,410 --> 00:17:56,430
infection is the<font color="#CCCCCC"> server-side</font><font color="#E5E5E5"> redirects</font>

471
00:17:54,330 --> 00:17:58,500
if you look at the<font color="#E5E5E5"> West top</font><font color="#CCCCCC"> ten nowadays</font>

472
00:17:56,430 --> 00:18:01,020
so you have an hour 810 vulnerability

473
00:17:58,500 --> 00:18:03,450
invalidated redirects and forwards and

474
00:18:01,020 --> 00:18:05,760
that is a<font color="#E5E5E5"> big problem it's a really big</font>

475
00:18:03,450 --> 00:18:07,890
problem and they may<font color="#E5E5E5"> not be taken into</font>

476
00:18:05,760 --> 00:18:11,040
account as such but this<font color="#CCCCCC"> Kanda's are</font>

477
00:18:07,890 --> 00:18:14,130
utilized a lot in redirecting our users

478
00:18:11,040 --> 00:18:16,170
from legitimate dawn domain to non

479
00:18:14,130 --> 00:18:18,090
legitimate so we found that some of

480
00:18:16,170 --> 00:18:20,430
where you get vulnerabilities in<font color="#CCCCCC"> Oracle</font>

481
00:18:18,090 --> 00:18:22,949
websites and they are one label to all

482
00:18:20,430 --> 00:18:25,020
these things but luckily<font color="#E5E5E5"> all get patched</font>

483
00:18:22,950 --> 00:18:27,720
but the point<font color="#E5E5E5"> what I'm saying is that</font>

484
00:18:25,020 --> 00:18:29,220
<font color="#E5E5E5">nothing is secure and all anything you</font>

485
00:18:27,720 --> 00:18:32,930
<font color="#E5E5E5">got one or the other way in these</font>

486
00:18:29,220 --> 00:18:36,390
methods you can get the things done and

487
00:18:32,930 --> 00:18:38,790
<font color="#E5E5E5">so why so long live drive-by downloads</font>

488
00:18:36,390 --> 00:18:40,440
and this attack is being into this world

489
00:18:38,790 --> 00:18:43,649
for like a long period of time and<font color="#CCCCCC"> it's</font>

490
00:18:40,440 --> 00:18:46,320
still working real good and it's a sort

491
00:18:43,650 --> 00:18:48,390
of evil reaction so the whole complete

492
00:18:46,320 --> 00:18:50,010
details the very simple is like victim

493
00:18:48,390 --> 00:18:53,430
browser visits a particular malware

494
00:18:50,010 --> 00:18:55,200
domain they have a kind<font color="#E5E5E5"> of resource or</font>

495
00:18:53,430 --> 00:18:57,180
some sort of JavaScript hostage which

496
00:18:55,200 --> 00:18:58,860
actually fingerprints your browser so if

497
00:18:57,180 --> 00:19:01,020
you're running<font color="#CCCCCC"> a browser environment in</font>

498
00:18:58,860 --> 00:19:03,659
Mozilla Firefox ie and all sort of those

499
00:19:01,020 --> 00:19:05,910
things so it fingerprints it so<font color="#E5E5E5"> okay the</font>

500
00:19:03,660 --> 00:19:08,250
guys running our internet explorer 7 and

501
00:19:05,910 --> 00:19:10,290
they side by side the<font color="#E5E5E5"> hofstra browser</font>

502
00:19:08,250 --> 00:19:12,000
exploit<font color="#CCCCCC"> pack and from once they</font>

503
00:19:10,290 --> 00:19:15,030
fingerprinted they check like okay I

504
00:19:12,000 --> 00:19:17,310
want to send ie7 exploit to it<font color="#CCCCCC"> descent</font>

505
00:19:15,030 --> 00:19:19,860
and exploit they use the JavaScript

506
00:19:17,310 --> 00:19:22,950
<font color="#CCCCCC">cheap spring and once the vulnerability</font>

507
00:19:19,860 --> 00:19:25,830
is exploited then they throw up as some

508
00:19:22,950 --> 00:19:27,300
sort of malicious executable and victim

509
00:19:25,830 --> 00:19:29,669
is not aware of the fact that because<font color="#E5E5E5"> it</font>

510
00:19:27,300 --> 00:19:32,639
happens in such a hidden manner and it's

511
00:19:29,670 --> 00:19:34,500
really<font color="#CCCCCC"> hard to do it and so the malware</font>

512
00:19:32,640 --> 00:19:36,570
is downloaded into your system and

513
00:19:34,500 --> 00:19:40,140
that's where if you remember it

514
00:19:36,570 --> 00:19:42,120
correctly we exploit the class how the

515
00:19:40,140 --> 00:19:43,950
<font color="#E5E5E5">Class B malware works it experts the</font>

516
00:19:42,120 --> 00:19:46,439
vulnerability in plugin or maybe in

517
00:19:43,950 --> 00:19:50,340
browser and then downloads the Class C

518
00:19:46,440 --> 00:19:52,920
malware into your system so that's<font color="#E5E5E5"> how</font>

519
00:19:50,340 --> 00:19:55,169
the<font color="#E5E5E5"> Maya economies are real good because</font>

520
00:19:52,920 --> 00:19:57,270
it lets you allow to map the things to

521
00:19:55,170 --> 00:19:59,130
what you<font color="#CCCCCC"> are doing and it's a</font><font color="#E5E5E5"> basic</font>

522
00:19:57,270 --> 00:20:00,600
understanding<font color="#CCCCCC"> so if you analyze a mass</font>

523
00:19:59,130 --> 00:20:03,240
Class C malware

524
00:20:00,600 --> 00:20:05,250
user land route kids because browser

525
00:20:03,240 --> 00:20:07,020
process works in a user application

526
00:20:05,250 --> 00:20:08,550
layer it's not<font color="#E5E5E5"> work as in a colonel and</font>

527
00:20:07,020 --> 00:20:10,379
so that's why whether you have

528
00:20:08,550 --> 00:20:12,780
administrator access or you have a

529
00:20:10,380 --> 00:20:14,900
normal<font color="#E5E5E5"> user access this will get into</font>

530
00:20:12,780 --> 00:20:18,600
there because browser runs everywhere

531
00:20:14,900 --> 00:20:22,200
it's a window of exposure or it's an

532
00:20:18,600 --> 00:20:26,370
<font color="#E5E5E5">Internet window that everybody having an</font>

533
00:20:22,200 --> 00:20:27,990
interface so what exactly works so now

534
00:20:26,370 --> 00:20:29,729
<font color="#E5E5E5">the</font><font color="#CCCCCC"> drive-by download occurs and you</font>

535
00:20:27,990 --> 00:20:33,480
started getting<font color="#CCCCCC"> become a victim of the</font>

536
00:20:29,730 --> 00:20:35,970
malware draw or whatever it is so how

537
00:20:33,480 --> 00:20:37,950
that is actually working from this the

538
00:20:35,970 --> 00:20:40,230
major exploitation frameworks<font color="#CCCCCC"> called as</font>

539
00:20:37,950 --> 00:20:42,900
browser exploit packs and the botnets

540
00:20:40,230 --> 00:20:44,370
let's say for<font color="#CCCCCC"> example spy I is working</font>

541
00:20:42,900 --> 00:20:46,680
collaboratively with some sort of

542
00:20:44,370 --> 00:20:48,870
browser exploit called as a black hole

543
00:20:46,680 --> 00:20:50,640
so they are hosted on a same server may

544
00:20:48,870 --> 00:20:53,159
<font color="#CCCCCC">be on a different server so the whole</font>

545
00:20:50,640 --> 00:20:55,710
process repeats instead of<font color="#E5E5E5"> class c</font>

546
00:20:53,160 --> 00:20:57,660
malware there will<font color="#CCCCCC"> be a bot you know</font>

547
00:20:55,710 --> 00:21:00,060
they can<font color="#E5E5E5"> design any shellcode right and</font>

548
00:20:57,660 --> 00:21:02,250
instead<font color="#E5E5E5"> of sending some sort of malware</font>

549
00:21:00,060 --> 00:21:04,139
that erases anything they shall code

550
00:21:02,250 --> 00:21:06,090
that particular board which is being

551
00:21:04,140 --> 00:21:09,690
dropped into your system and started

552
00:21:06,090 --> 00:21:12,030
exploiting it and that's all botnets do

553
00:21:09,690 --> 00:21:14,000
the thing so one by one the botnets keep

554
00:21:12,030 --> 00:21:18,120
on increasing and chain reaction works

555
00:21:14,000 --> 00:21:20,460
so again malgor taxonomy these kind of

556
00:21:18,120 --> 00:21:24,510
attacks helps us understand what we need

557
00:21:20,460 --> 00:21:26,820
to do and how we need<font color="#CCCCCC"> to hack back and</font>

558
00:21:24,510 --> 00:21:30,120
yes so this is an advanced clear that

559
00:21:26,820 --> 00:21:31,830
happy<font color="#E5E5E5"> knows didn't notice last year by</font><font color="#CCCCCC"> i</font>

560
00:21:30,120 --> 00:21:33,899
would really love to see the<font color="#E5E5E5"> arm rise</font>

561
00:21:31,830 --> 00:21:36,570
that did some research on that<font color="#E5E5E5"> it's a</font>

562
00:21:33,900 --> 00:21:38,490
dry by cash another variant I mean maybe

563
00:21:36,570 --> 00:21:42,270
a brother or maybe a sister or drive-by

564
00:21:38,490 --> 00:21:45,540
download so what it actually sees so if

565
00:21:42,270 --> 00:21:47,400
you look<font color="#E5E5E5"> at</font><font color="#CCCCCC"> the model at the don't stir</font>

566
00:21:45,540 --> 00:21:48,629
part and you will see<font color="#E5E5E5"> that there is</font>

567
00:21:47,400 --> 00:21:50,820
there<font color="#E5E5E5"> are five different steps our</font>

568
00:21:48,630 --> 00:21:52,740
<font color="#CCCCCC">drive-by download walks and the similar</font>

569
00:21:50,820 --> 00:21:55,500
pattern has been subjugated for the dry

570
00:21:52,740 --> 00:21:57,240
by cash and only the second thing is

571
00:21:55,500 --> 00:21:59,520
that<font color="#CCCCCC"> they say like by dry burn try by</font>

572
00:21:57,240 --> 00:22:02,220
download you loads the URL you execute

573
00:21:59,520 --> 00:22:04,950
exploit shellcode happens download some

574
00:22:02,220 --> 00:22:06,870
malware runs the malware but what

575
00:22:04,950 --> 00:22:09,780
happened in dry by cash why drive by

576
00:22:06,870 --> 00:22:12,780
cash by by<font color="#E5E5E5"> the default nature of</font>

577
00:22:09,780 --> 00:22:14,310
<font color="#E5E5E5">JavaScript files image files I mean</font>

578
00:22:12,780 --> 00:22:16,920
whenever you r load our particular

579
00:22:14,310 --> 00:22:18,780
<font color="#CCCCCC">book page you need to</font><font color="#E5E5E5"> fetch dot JPG</font>

580
00:22:16,920 --> 00:22:21,480
files from the content delivery network

581
00:22:18,780 --> 00:22:23,970
and that<font color="#CCCCCC"> resides</font><font color="#E5E5E5"> everything in the</font>

582
00:22:21,480 --> 00:22:26,490
temporary directory yes that<font color="#CCCCCC"> is that's</font>

583
00:22:23,970 --> 00:22:28,800
where the cash comes to play it depends

584
00:22:26,490 --> 00:22:31,920
a lot how the web application sets up a

585
00:22:28,800 --> 00:22:33,659
cash but by default is being there so

586
00:22:31,920 --> 00:22:35,700
the at first the malware is downloaded

587
00:22:33,660 --> 00:22:37,710
into your system it's not run<font color="#E5E5E5"> the</font>

588
00:22:35,700 --> 00:22:40,710
exploit is actually downloaded which

589
00:22:37,710 --> 00:22:43,440
actually performs the another legitimate

590
00:22:40,710 --> 00:22:46,260
steps which are like execute exploit and

591
00:22:43,440 --> 00:22:48,660
then execute shellcode and then install

592
00:22:46,260 --> 00:22:50,580
the malware into the system and that's

593
00:22:48,660 --> 00:22:53,460
the two different scenario so we have

594
00:22:50,580 --> 00:22:55,500
seen<font color="#CCCCCC"> this variance of dry by cash but it</font>

595
00:22:53,460 --> 00:22:57,780
is not as such in relation or in

596
00:22:55,500 --> 00:23:00,840
frequency to the drive-by<font color="#E5E5E5"> downloads and</font>

597
00:22:57,780 --> 00:23:02,730
that is a<font color="#E5E5E5"> big factor so if you look at</font>

598
00:23:00,840 --> 00:23:05,730
this scenario you<font color="#CCCCCC"> may be if you're</font><font color="#E5E5E5"> doing</font>

599
00:23:02,730 --> 00:23:07,580
<font color="#CCCCCC">any like aggressive malware analysis or</font>

600
00:23:05,730 --> 00:23:09,540
any sort of analysis you will find<font color="#CCCCCC"> that</font>

601
00:23:07,580 --> 00:23:12,120
<font color="#CCCCCC">you are</font><font color="#E5E5E5"> going to encounter these</font>

602
00:23:09,540 --> 00:23:13,500
scenarios on the dry by<font color="#CCCCCC"> Cashin drive i</font>

603
00:23:12,120 --> 00:23:15,899
download so that's what the basic

604
00:23:13,500 --> 00:23:18,810
difference<font color="#CCCCCC"> between drive-by downloads</font>

605
00:23:15,900 --> 00:23:21,300
and<font color="#E5E5E5"> the cash now jumping back on to the</font>

606
00:23:18,810 --> 00:23:24,590
<font color="#E5E5E5">business scenario so we have a very meh</font>

607
00:23:21,300 --> 00:23:27,540
webmail web malware<font color="#CCCCCC"> farms which provided</font>

608
00:23:24,590 --> 00:23:29,790
services based on that and what they do

609
00:23:27,540 --> 00:23:31,440
actually I mean we have like DC and we

610
00:23:29,790 --> 00:23:34,290
have armor eyes and those sort of things

611
00:23:31,440 --> 00:23:37,290
to do like light monitoring of malware

612
00:23:34,290 --> 00:23:39,420
on your website shrine so what<font color="#E5E5E5"> is the</font>

613
00:23:37,290 --> 00:23:40,920
basic scenario when I try to look into

614
00:23:39,420 --> 00:23:44,130
their tools and all that this is a very

615
00:23:40,920 --> 00:23:46,440
general and basic layout of<font color="#CCCCCC"> the</font>

616
00:23:44,130 --> 00:23:48,480
<font color="#E5E5E5">framework that I come with so it's some</font>

617
00:23:46,440 --> 00:23:50,940
sort of URL dissection so it scans

618
00:23:48,480 --> 00:23:52,890
everything your web page and try<font color="#E5E5E5"> to find</font>

619
00:23:50,940 --> 00:23:56,700
out<font color="#E5E5E5"> what kind of you are else you have</font>

620
00:23:52,890 --> 00:23:59,580
in it once you do that then they try<font color="#E5E5E5"> to</font>

621
00:23:56,700 --> 00:24:01,470
look into the blacklisted URL all the

622
00:23:59,580 --> 00:24:03,570
ninety percent of the tools use google

623
00:24:01,470 --> 00:24:05,940
safebrowsing that what it<font color="#CCCCCC"> is all about</font>

624
00:24:03,570 --> 00:24:08,189
and then they have blacklisted<font color="#CCCCCC"> urls that</font>

625
00:24:05,940 --> 00:24:10,530
of course that domains are blacklisted

626
00:24:08,190 --> 00:24:12,120
and they have already have some sort of

627
00:24:10,530 --> 00:24:14,129
database that say there is this is<font color="#E5E5E5"> a</font>

628
00:24:12,120 --> 00:24:16,439
malware specific domain you get a

629
00:24:14,130 --> 00:24:19,010
malware specific URLs you have a clean

630
00:24:16,440 --> 00:24:22,470
urls and you have a suspicious<font color="#CCCCCC"> urls and</font>

631
00:24:19,010 --> 00:24:24,480
why this is specious<font color="#CCCCCC"> urls comes from the</font>

632
00:24:22,470 --> 00:24:25,950
fact that there is<font color="#E5E5E5"> a chain if a</font>

633
00:24:24,480 --> 00:24:28,150
particular website is<font color="#E5E5E5"> linked</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font>

634
00:24:25,950 --> 00:24:29,470
another website which as like<font color="#CCCCCC"> google</font>

635
00:24:28,150 --> 00:24:31,780
blacklisting or some sort of those

636
00:24:29,470 --> 00:24:33,820
<font color="#E5E5E5">things then</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> like this might be a</font>

637
00:24:31,780 --> 00:24:35,800
suspicious nature you need to take care

638
00:24:33,820 --> 00:24:38,560
<font color="#E5E5E5">of that fact and that's what these tools</font>

639
00:24:35,800 --> 00:24:41,970
are doing a<font color="#CCCCCC"> lot and that is a very very</font>

640
00:24:38,560 --> 00:24:47,649
general scenario how most<font color="#E5E5E5"> of the online</font>

641
00:24:41,970 --> 00:24:49,540
<font color="#CCCCCC">another web malware tools work now so</font>

642
00:24:47,650 --> 00:24:51,040
now the case is so we have done a lot of

643
00:24:49,540 --> 00:24:54,010
<font color="#E5E5E5">things we understand about</font><font color="#CCCCCC"> browsers</font>

644
00:24:51,040 --> 00:24:56,110
malware taxonomy we understand how the

645
00:24:54,010 --> 00:24:58,990
browser malware works how the drive-by

646
00:24:56,110 --> 00:25:01,689
downloads works dry by cash work now

647
00:24:58,990 --> 00:25:04,840
what so we got all the entry points how

648
00:25:01,690 --> 00:25:06,010
the system is there or the things that

649
00:25:04,840 --> 00:25:08,500
are required to perform a particular

650
00:25:06,010 --> 00:25:11,470
analysis but the caution is now webmail

651
00:25:08,500 --> 00:25:13,240
<font color="#CCCCCC">we are hunting this</font><font color="#E5E5E5"> really good we have</font>

652
00:25:11,470 --> 00:25:15,130
an automated tools<font color="#E5E5E5"> even when we do like</font>

653
00:25:13,240 --> 00:25:17,470
web application security we run

654
00:25:15,130 --> 00:25:20,110
automated tools IBM all sort of things

655
00:25:17,470 --> 00:25:22,120
but I think Manuel analysis is really

656
00:25:20,110 --> 00:25:25,500
required and it's not<font color="#CCCCCC"> something you know</font>

657
00:25:22,120 --> 00:25:27,370
just very verifying or validating the

658
00:25:25,500 --> 00:25:30,820
vulnerabilities that are provided by<font color="#CCCCCC"> the</font>

659
00:25:27,370 --> 00:25:33,459
tool it's just beyond that step and that

660
00:25:30,820 --> 00:25:35,919
step involves<font color="#E5E5E5"> your thinking into that</font>

661
00:25:33,460 --> 00:25:37,510
particular case and we are going<font color="#E5E5E5"> to look</font>

662
00:25:35,920 --> 00:25:38,830
into<font color="#E5E5E5"> the webmail we're hunting code what</font>

663
00:25:37,510 --> 00:25:41,770
is being required and what<font color="#E5E5E5"> I hacker</font>

664
00:25:38,830 --> 00:25:43,570
needs to know to do<font color="#CCCCCC"> that</font><font color="#E5E5E5"> things this</font><font color="#CCCCCC"> is</font>

665
00:25:41,770 --> 00:25:46,870
<font color="#CCCCCC">what we do what we follow while</font>

666
00:25:43,570 --> 00:25:50,230
performing live analysis and let's<font color="#E5E5E5"> get</font>

667
00:25:46,870 --> 00:25:52,090
it started so this<font color="#E5E5E5"> is a hunting web</font>

668
00:25:50,230 --> 00:25:54,760
malware what kind of techniques<font color="#E5E5E5"> and</font>

669
00:25:52,090 --> 00:25:56,649
tactics you are required if you remember

670
00:25:54,760 --> 00:25:58,390
the first starting of this stop I point

671
00:25:56,650 --> 00:26:01,240
that<font color="#CCCCCC"> the equation of this talk is</font><font color="#E5E5E5"> a</font>

672
00:25:58,390 --> 00:26:03,400
rigorous penetration testing rigorous

673
00:26:01,240 --> 00:26:06,700
web application security and extensive

674
00:26:03,400 --> 00:26:09,550
malware analysis understanding and that

675
00:26:06,700 --> 00:26:11,590
is how it<font color="#E5E5E5"> is going to work so what do</font>

676
00:26:09,550 --> 00:26:13,000
you<font color="#E5E5E5"> need to</font><font color="#CCCCCC"> know on that perspective and</font>

677
00:26:11,590 --> 00:26:14,830
the first one is like detail

678
00:26:13,000 --> 00:26:17,320
understanding of different malware

679
00:26:14,830 --> 00:26:19,120
taxonomies we did that I<font color="#E5E5E5"> mean we looked</font>

680
00:26:17,320 --> 00:26:21,639
into one of the basic browser malware

681
00:26:19,120 --> 00:26:24,489
taxonomy<font color="#E5E5E5"> cuz browser is a window of</font>

682
00:26:21,640 --> 00:26:26,770
exposure and exploitation we know where

683
00:26:24,490 --> 00:26:28,540
the entry points are what components are

684
00:26:26,770 --> 00:26:31,330
getting exploited and those sort of

685
00:26:28,540 --> 00:26:32,680
things we looked at the malware<font color="#CCCCCC"> malvert</font>

686
00:26:31,330 --> 00:26:36,010
easements we look at the drive-by

687
00:26:32,680 --> 00:26:37,840
downloads and again we jump onto the

688
00:26:36,010 --> 00:26:40,180
categorization and classification of

689
00:26:37,840 --> 00:26:42,209
malware is important taxonomy provides

690
00:26:40,180 --> 00:26:43,860
it<font color="#CCCCCC"> okay a</font><font color="#E5E5E5"> be</font>

691
00:26:42,210 --> 00:26:46,470
see what kind of manual what kind of

692
00:26:43,860 --> 00:26:48,179
characteristic it has in a system how it

693
00:26:46,470 --> 00:26:50,850
is going to exploit a system where<font color="#CCCCCC"> we</font>

694
00:26:48,180 --> 00:26:53,130
can find it so if<font color="#CCCCCC"> I say</font><font color="#E5E5E5"> like a very</font>

695
00:26:50,850 --> 00:26:55,830
general malware analysis scenario works

696
00:26:53,130 --> 00:26:57,660
on the fact that any malware installed

697
00:26:55,830 --> 00:26:59,760
into<font color="#CCCCCC"> a</font><font color="#E5E5E5"> system must do some sort of file</font>

698
00:26:57,660 --> 00:27:02,400
system activity must do some sort of

699
00:26:59,760 --> 00:27:04,770
registry manipulation must perform some

700
00:27:02,400 --> 00:27:07,200
ingress egress filtering of traffic and

701
00:27:04,770 --> 00:27:08,970
input/output activity that's what the

702
00:27:07,200 --> 00:27:11,430
four<font color="#E5E5E5"> things where we lay filters and we</font>

703
00:27:08,970 --> 00:27:13,770
find that<font color="#E5E5E5"> okay we got</font><font color="#CCCCCC"> that malware and</font>

704
00:27:11,430 --> 00:27:15,600
that is all done but there<font color="#E5E5E5"> are certain</font>

705
00:27:13,770 --> 00:27:17,850
other things that<font color="#E5E5E5"> we require and that is</font>

706
00:27:15,600 --> 00:27:19,639
<font color="#E5E5E5">the penetration testing in that whether</font>

707
00:27:17,850 --> 00:27:22,230
it's a web whether it's a system and

708
00:27:19,640 --> 00:27:24,810
<font color="#CCCCCC">we'll why it is critical and white is</font>

709
00:27:22,230 --> 00:27:26,340
important by looking at the case studies

710
00:27:24,810 --> 00:27:29,159
that<font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> discuss</font><font color="#E5E5E5"> just a little</font>

711
00:27:26,340 --> 00:27:32,189
later so categorization and

712
00:27:29,160 --> 00:27:34,530
classification understanding of the

713
00:27:32,190 --> 00:27:35,820
browser exploitation in detail I mean if

714
00:27:34,530 --> 00:27:37,740
you have a good understanding how the

715
00:27:35,820 --> 00:27:39,720
browser exploit works our JavaScript

716
00:27:37,740 --> 00:27:41,610
heat works by exploiting the default

717
00:27:39,720 --> 00:27:43,200
heap structure and some sort of other

718
00:27:41,610 --> 00:27:44,610
things where they are going to low what

719
00:27:43,200 --> 00:27:47,240
kind of<font color="#CCCCCC"> one</font><font color="#E5E5E5"> the ability is coming in a</font>

720
00:27:44,610 --> 00:27:50,010
system now you try<font color="#CCCCCC"> to look into the</font>

721
00:27:47,240 --> 00:27:51,450
various you know know kind of<font color="#CCCCCC"> web mail</font>

722
00:27:50,010 --> 00:27:53,460
is where you find that<font color="#CCCCCC"> okay this</font>

723
00:27:51,450 --> 00:27:55,740
particular vulnerability is out zdi has

724
00:27:53,460 --> 00:27:58,290
released this kind and I defenses really

725
00:27:55,740 --> 00:28:00,750
this stuff so you might get<font color="#E5E5E5"> a much much</font>

726
00:27:58,290 --> 00:28:03,450
more exposure<font color="#CCCCCC"> of</font><font color="#E5E5E5"> you know handling the</font>

727
00:28:00,750 --> 00:28:06,420
exploitation tactics by the malware

728
00:28:03,450 --> 00:28:08,730
writers and then of course web attacks

729
00:28:06,420 --> 00:28:10,620
and defenses long live cross-site

730
00:28:08,730 --> 00:28:13,680
scripting long live sequel injection all

731
00:28:10,620 --> 00:28:15,570
these<font color="#E5E5E5"> are very</font><font color="#CCCCCC"> very important and since</font>

732
00:28:13,680 --> 00:28:17,730
I in the start of mitre I say like a

733
00:28:15,570 --> 00:28:19,860
good hacker I mean of course<font color="#E5E5E5"> we are</font>

734
00:28:17,730 --> 00:28:22,830
hacking the same way what the malware

735
00:28:19,860 --> 00:28:24,379
hacker do but an acne here is the fact

736
00:28:22,830 --> 00:28:27,179
that we are<font color="#E5E5E5"> using the same attacks</font>

737
00:28:24,380 --> 00:28:29,070
against them so<font color="#CCCCCC"> if there's a sequel</font>

738
00:28:27,180 --> 00:28:31,680
injection we use it for like business

739
00:28:29,070 --> 00:28:33,720
purposes to find<font color="#E5E5E5"> a</font><font color="#CCCCCC"> one abilities and you</font>

740
00:28:31,680 --> 00:28:35,160
know some sort of web applications so

741
00:28:33,720 --> 00:28:36,990
here we<font color="#CCCCCC"> are going to look how we use</font>

742
00:28:35,160 --> 00:28:39,720
sequel injection and this in the similar

743
00:28:36,990 --> 00:28:43,260
way to<font color="#CCCCCC"> hack back into the</font><font color="#E5E5E5"> their</font>

744
00:28:39,720 --> 00:28:45,450
frameworks and again the point is like

745
00:28:43,260 --> 00:28:47,910
system level penetration testing is very

746
00:28:45,450 --> 00:28:49,910
much required mail servers<font color="#E5E5E5"> FTP servers</font>

747
00:28:47,910 --> 00:28:53,910
SMB servers and all those sort of things

748
00:28:49,910 --> 00:28:55,650
it's really really required and we are

749
00:28:53,910 --> 00:28:56,070
not jumping<font color="#CCCCCC"> on this talk is not about</font>

750
00:28:55,650 --> 00:28:57,510
the<font color="#E5E5E5"> river</font>

751
00:28:56,070 --> 00:28:59,460
engineering of malware that is a

752
00:28:57,510 --> 00:29:01,500
complete different aspect but we are

753
00:28:59,460 --> 00:29:03,870
looking<font color="#E5E5E5"> into the point of initiation and</font>

754
00:29:01,500 --> 00:29:06,660
the point of entry into your system so

755
00:29:03,870 --> 00:29:08,729
we are looking<font color="#CCCCCC"> into the traffic</font><font color="#E5E5E5"> and how</font>

756
00:29:06,660 --> 00:29:12,590
we have to extract you know encrypted or

757
00:29:08,730 --> 00:29:15,000
decrypted executables from the traffic

758
00:29:12,590 --> 00:29:17,550
so the very basic thing is that you

759
00:29:15,000 --> 00:29:21,210
might encounter some sort of case where

760
00:29:17,550 --> 00:29:24,510
you<font color="#E5E5E5"> find that there</font><font color="#CCCCCC"> is a some some sort</font>

761
00:29:21,210 --> 00:29:26,520
of mass exploitation is going on and

762
00:29:24,510 --> 00:29:28,620
it's<font color="#E5E5E5"> always good to look into the Google</font>

763
00:29:26,520 --> 00:29:30,450
that's what we always do so it might

764
00:29:28,620 --> 00:29:32,189
gives you an idea what kind of<font color="#E5E5E5"> websites</font>

765
00:29:30,450 --> 00:29:34,920
are getting impacted you get a lot of

766
00:29:32,190 --> 00:29:38,040
less maybe it's not good to say that

767
00:29:34,920 --> 00:29:39,960
there might be alike 91,000 results but

768
00:29:38,040 --> 00:29:41,870
maybe forty percent and that is good

769
00:29:39,960 --> 00:29:44,340
enough<font color="#E5E5E5"> and this gives you an idea</font>

770
00:29:41,870 --> 00:29:46,800
looking at that particular website pages

771
00:29:44,340 --> 00:29:49,050
how the malware is getting rendered into

772
00:29:46,800 --> 00:29:50,970
the<font color="#CCCCCC"> website and that is a real scenario</font>

773
00:29:49,050 --> 00:29:52,889
<font color="#E5E5E5">so that's a some sort of like data</font>

774
00:29:50,970 --> 00:29:54,210
mining you know you get a data for<font color="#E5E5E5"> ten</font>

775
00:29:52,890 --> 00:29:55,770
<font color="#E5E5E5">thousand rackets and then you're going</font>

776
00:29:54,210 --> 00:29:58,140
to go<font color="#CCCCCC"> through it okay this particular</font>

777
00:29:55,770 --> 00:30:00,090
<font color="#CCCCCC">thing where a malware is acting upon and</font>

778
00:29:58,140 --> 00:30:02,610
it's<font color="#E5E5E5"> always good to get these things</font>

779
00:30:00,090 --> 00:30:05,129
done as a like setting up an environment

780
00:30:02,610 --> 00:30:08,580
in<font color="#CCCCCC"> your lab you know to start</font><font color="#E5E5E5"> up</font><font color="#CCCCCC"> the</font>

781
00:30:05,130 --> 00:30:10,950
hunting of course public repositories is

782
00:30:08,580 --> 00:30:13,169
all this good scenario maybe you won't

783
00:30:10,950 --> 00:30:16,590
get a complete details but you still get

784
00:30:13,170 --> 00:30:18,390
an idea<font color="#CCCCCC"> what kind of malware is hosting</font>

785
00:30:16,590 --> 00:30:20,790
where maybe<font color="#E5E5E5"> it's not going to give you a</font>

786
00:30:18,390 --> 00:30:23,760
detailed description but it gives you<font color="#E5E5E5"> at</font>

787
00:30:20,790 --> 00:30:25,430
least an idea that two days back this

788
00:30:23,760 --> 00:30:27,300
malware is on this particular domain

789
00:30:25,430 --> 00:30:29,490
because as we know google safebrowsing

790
00:30:27,300 --> 00:30:31,530
is a pre active defense and is a really

791
00:30:29,490 --> 00:30:34,080
proactive service which might flag it

792
00:30:31,530 --> 00:30:35,820
but guiding<font color="#CCCCCC"> on to this thing and you</font>

793
00:30:34,080 --> 00:30:38,280
might get<font color="#E5E5E5"> a good examples that are</font>

794
00:30:35,820 --> 00:30:39,810
running life looking at here and then

795
00:30:38,280 --> 00:30:42,720
you can start doing<font color="#E5E5E5"> what we</font><font color="#CCCCCC"> are going to</font>

796
00:30:39,810 --> 00:30:44,220
show<font color="#CCCCCC"> later on so pattern detection is</font>

797
00:30:42,720 --> 00:30:46,260
very<font color="#E5E5E5"> very much important in the online</font>

798
00:30:44,220 --> 00:30:50,070
world<font color="#E5E5E5"> if you really</font><font color="#CCCCCC"> want to</font><font color="#E5E5E5"> do a good</font>

799
00:30:46,260 --> 00:30:51,930
malware analysis and<font color="#E5E5E5"> I am continuously</font>

800
00:30:50,070 --> 00:30:54,030
repeating the good malware analysis but

801
00:30:51,930 --> 00:30:55,200
it's really required the great

802
00:30:54,030 --> 00:30:57,899
understanding<font color="#E5E5E5"> of a web application</font>

803
00:30:55,200 --> 00:31:02,100
security that<font color="#CCCCCC"> is being there without</font>

804
00:30:57,900 --> 00:31:03,690
<font color="#E5E5E5">that is no fun of analyzing malware so</font>

805
00:31:02,100 --> 00:31:05,399
I'll be jumping onto the pcap files

806
00:31:03,690 --> 00:31:07,710
which<font color="#CCCCCC"> is called as a packet capture</font>

807
00:31:05,400 --> 00:31:09,070
files so let's<font color="#E5E5E5"> say malware is you know</font>

808
00:31:07,710 --> 00:31:11,409
hosted on<font color="#CCCCCC"> a some malware</font>

809
00:31:09,070 --> 00:31:13,928
and it is being<font color="#E5E5E5"> coming onto your system</font>

810
00:31:11,409 --> 00:31:15,549
so that in between traffic the<font color="#E5E5E5"> TCP</font>

811
00:31:13,929 --> 00:31:17,799
traffic or some sort of UDP traffic

812
00:31:15,549 --> 00:31:20,710
connectionless or<font color="#CCCCCC"> connection oriented</font>

813
00:31:17,799 --> 00:31:22,658
you get a pcap files there<font color="#E5E5E5"> are many many</font>

814
00:31:20,710 --> 00:31:26,440
online repository which gives you a pcap

815
00:31:22,659 --> 00:31:28,090
files of various forms so you can do

816
00:31:26,440 --> 00:31:31,929
that<font color="#E5E5E5"> so this is the raw dumps of capture</font>

817
00:31:28,090 --> 00:31:33,699
files what it gives you DNS lot of

818
00:31:31,929 --> 00:31:35,409
information about DNS servers lot of

819
00:31:33,700 --> 00:31:37,029
information about like from where the

820
00:31:35,409 --> 00:31:39,880
malware is coming and<font color="#E5E5E5"> where it is going</font>

821
00:31:37,029 --> 00:31:41,950
and some sort of DNS changing techniques

822
00:31:39,880 --> 00:31:43,870
that are followed by malware there might

823
00:31:41,950 --> 00:31:46,389
be a possibility you encounter a<font color="#E5E5E5"> ten</font>

824
00:31:43,870 --> 00:31:48,459
different dns servers in a one flow of

825
00:31:46,389 --> 00:31:50,799
traffic and that is always<font color="#E5E5E5"> being there</font>

826
00:31:48,460 --> 00:31:52,899
so you need to<font color="#E5E5E5"> find out the</font><font color="#CCCCCC"> end points</font>

827
00:31:50,799 --> 00:31:56,200
where<font color="#CCCCCC"> I am getting</font><font color="#E5E5E5"> in for what I have to</font>

828
00:31:52,899 --> 00:31:59,168
do of course it abuses the protocol HTTP

829
00:31:56,200 --> 00:32:01,419
and HTTPS you might encounter a malware

830
00:31:59,169 --> 00:32:04,389
is coming over<font color="#E5E5E5"> an encrypted session or</font>

831
00:32:01,419 --> 00:32:07,509
encrypted session so the caution here is

832
00:32:04,389 --> 00:32:10,840
that is it possible if it is<font color="#E5E5E5"> the</font>

833
00:32:07,509 --> 00:32:13,000
connection oriented stuff it is possible

834
00:32:10,840 --> 00:32:18,220
<font color="#CCCCCC">to extract the executable out of this</font>

835
00:32:13,000 --> 00:32:21,000
pcap anybody yeah you swipe it<font color="#CCCCCC"> can be</font>

836
00:32:18,220 --> 00:32:23,289
done and that is what<font color="#CCCCCC"> we have</font><font color="#E5E5E5"> to do and</font>

837
00:32:21,000 --> 00:32:25,720
why it is<font color="#E5E5E5"> be it is required because</font>

838
00:32:23,289 --> 00:32:27,940
sometimes you only get a pcap files and

839
00:32:25,720 --> 00:32:30,879
you had to extract that executable which

840
00:32:27,940 --> 00:32:34,269
is not easy<font color="#E5E5E5"> process but you really need</font>

841
00:32:30,879 --> 00:32:35,740
<font color="#E5E5E5">to understand the structure of PE files</font>

842
00:32:34,269 --> 00:32:38,440
did you<font color="#E5E5E5"> call as a portable executable</font>

843
00:32:35,740 --> 00:32:40,269
files the only good<font color="#E5E5E5"> thing about is that</font>

844
00:32:38,440 --> 00:32:43,240
Wireshark provides that option which is

845
00:32:40,269 --> 00:32:44,919
<font color="#E5E5E5">called as a TCP session flow and you set</font>

846
00:32:43,240 --> 00:32:47,259
up a full session flow and get the

847
00:32:44,919 --> 00:32:49,419
things done but you<font color="#CCCCCC"> need to be very very</font>

848
00:32:47,259 --> 00:32:51,299
<font color="#E5E5E5">careful of course you should not deal</font>

849
00:32:49,419 --> 00:32:53,740
with some sort of encoding or decoding

850
00:32:51,299 --> 00:32:57,399
while extracting that<font color="#E5E5E5"> particular binary</font>

851
00:32:53,740 --> 00:32:58,929
you need a rod out raw data check out

852
00:32:57,399 --> 00:33:00,908
what is the length of<font color="#CCCCCC"> that particular</font>

853
00:32:58,929 --> 00:33:03,970
session and when the whole file is being

854
00:33:00,909 --> 00:33:05,320
transferred chunks off and then you can

855
00:33:03,970 --> 00:33:10,240
do<font color="#E5E5E5"> the things and</font><font color="#CCCCCC"> we'll show you a</font>

856
00:33:05,320 --> 00:33:12,009
player on and apart from Wireshark i

857
00:33:10,240 --> 00:33:14,769
love this tool this is a pretty good to

858
00:33:12,009 --> 00:33:16,360
call as a network minor go ahead<font color="#E5E5E5"> and try</font>

859
00:33:14,769 --> 00:33:19,090
<font color="#CCCCCC">this one up just it's an a pretty</font>

860
00:33:16,360 --> 00:33:21,789
dynamic analysis to just it you know I'm

861
00:33:19,090 --> 00:33:22,620
<font color="#E5E5E5">starting listening on to your Ethernet</font>

862
00:33:21,789 --> 00:33:25,260
capture

863
00:33:22,620 --> 00:33:27,179
frame files and then what it does

864
00:33:25,260 --> 00:33:28,500
actually set that frame in I said that

865
00:33:27,180 --> 00:33:30,600
particular ethernet adapter in a

866
00:33:28,500 --> 00:33:34,380
<font color="#E5E5E5">bedazzle state and try to listen to all</font>

867
00:33:30,600 --> 00:33:36,330
solid things and it extracts basically

868
00:33:34,380 --> 00:33:38,910
said data mining<font color="#CCCCCC"> tool it extracts all</font>

869
00:33:36,330 --> 00:33:40,710
sorts of information for you<font color="#CCCCCC"> ok these</font>

870
00:33:38,910 --> 00:33:43,500
are<font color="#CCCCCC"> the files have been transferred from</font>

871
00:33:40,710 --> 00:33:44,870
<font color="#CCCCCC">the facebook to your account these are</font>

872
00:33:43,500 --> 00:33:48,720
the files<font color="#E5E5E5"> have been transferred</font><font color="#CCCCCC"> from</font>

873
00:33:44,870 --> 00:33:50,520
Twitter or whatever to your machine<font color="#E5E5E5"> and</font>

874
00:33:48,720 --> 00:33:52,530
it gives you a good<font color="#CCCCCC"> idea so you get a</font>

875
00:33:50,520 --> 00:33:55,980
lot of mapping out of this too<font color="#E5E5E5"> and it is</font>

876
00:33:52,530 --> 00:33:58,620
a<font color="#E5E5E5"> very good tool in doing web malware</font>

877
00:33:55,980 --> 00:34:00,960
analysis apart from that somebody don't

878
00:33:58,620 --> 00:34:03,300
like<font color="#E5E5E5"> Windows I think the explico tool is</font>

879
00:34:00,960 --> 00:34:05,250
a pretty good too you should try this

880
00:34:03,300 --> 00:34:07,770
one out is anna has an interface based

881
00:34:05,250 --> 00:34:10,590
on<font color="#E5E5E5"> Nick's platforms pretty good too and</font>

882
00:34:07,770 --> 00:34:12,239
it is very<font color="#CCCCCC"> much required to perform the</font>

883
00:34:10,590 --> 00:34:15,090
web malware hunting gives you a lot of

884
00:34:12,239 --> 00:34:17,729
information and you can export a lot of

885
00:34:15,090 --> 00:34:20,399
data out of it and who can<font color="#E5E5E5"> forget the</font>

886
00:34:17,730 --> 00:34:23,820
Scapa it's a Swiss Army knife pretty

887
00:34:20,399 --> 00:34:26,009
much required why it gives you a modular

888
00:34:23,820 --> 00:34:27,690
control of how to set up<font color="#E5E5E5"> a packet I mean</font>

889
00:34:26,010 --> 00:34:29,730
you can design<font color="#CCCCCC"> your own packets and set</font>

890
00:34:27,690 --> 00:34:32,159
up to the balveer domain and check how

891
00:34:29,730 --> 00:34:34,649
it is being replying back and that is

892
00:34:32,159 --> 00:34:37,169
pretty pretty much<font color="#E5E5E5"> required thus kp2 and</font>

893
00:34:34,649 --> 00:34:41,429
<font color="#CCCCCC">i think</font><font color="#E5E5E5"> like must be in the tool set for</font>

894
00:34:37,168 --> 00:34:43,739
any malware researcher on so so just a

895
00:34:41,429 --> 00:34:46,590
walking down through the traffic dumps

896
00:34:43,739 --> 00:34:49,168
and analysis so we apply filters and

897
00:34:46,590 --> 00:34:51,540
wash<font color="#CCCCCC"> Rock pretty simple thing and then</font>

898
00:34:49,168 --> 00:34:54,870
we used to create a pcap files we have

899
00:34:51,540 --> 00:34:56,940
PK files and how to extract data using

900
00:34:54,870 --> 00:34:59,069
<font color="#CCCCCC">Scapa so we have these particular two</font>

901
00:34:56,940 --> 00:35:03,390
functions rdp cap and sniff functions

902
00:34:59,070 --> 00:35:05,460
provided in in the scape<font color="#CCCCCC"> ii itself so</font>

903
00:35:03,390 --> 00:35:07,620
you can write a small script in<font color="#E5E5E5"> python</font>

904
00:35:05,460 --> 00:35:09,990
get the things done as we know python is

905
00:35:07,620 --> 00:35:12,180
pretty powerful really leave rages lot

906
00:35:09,990 --> 00:35:15,120
of information and then you can look

907
00:35:12,180 --> 00:35:17,850
into their data operations how to do<font color="#E5E5E5"> it</font>

908
00:35:15,120 --> 00:35:19,830
I mean this again depends a lot what

909
00:35:17,850 --> 00:35:21,660
kind of malware you are analyzing or

910
00:35:19,830 --> 00:35:24,120
what you are<font color="#CCCCCC"> actually dealing with with</font>

911
00:35:21,660 --> 00:35:25,859
those files so this example simply says

912
00:35:24,120 --> 00:35:28,500
that you can write a bite adders pretty

913
00:35:25,860 --> 00:35:31,800
easily and what<font color="#E5E5E5"> kind of other required</font>

914
00:35:28,500 --> 00:35:34,320
operation you can do and again as I

915
00:35:31,800 --> 00:35:35,880
discuss about example of network minor

916
00:35:34,320 --> 00:35:38,609
and explico you can

917
00:35:35,880 --> 00:35:42,750
use those tools to do the data mining in

918
00:35:38,609 --> 00:35:44,839
the network and that's how traffic dumps

919
00:35:42,750 --> 00:35:47,549
and analysis we need to do and again

920
00:35:44,839 --> 00:35:50,279
simple way to extract executable is the

921
00:35:47,549 --> 00:35:52,859
fact that follow the<font color="#E5E5E5"> TCP sessions strain</font>

922
00:35:50,279 --> 00:35:54,059
in the<font color="#E5E5E5"> wires shock you should be sure of</font>

923
00:35:52,859 --> 00:35:56,640
what is the length of that<font color="#E5E5E5"> particular</font>

924
00:35:54,059 --> 00:35:59,039
packet capture and where you are<font color="#E5E5E5"> dealing</font>

925
00:35:56,640 --> 00:36:01,140
with<font color="#E5E5E5"> the things and what to look for</font>

926
00:35:59,039 --> 00:36:02,700
this is a very<font color="#CCCCCC"> important point so when</font>

927
00:36:01,140 --> 00:36:04,740
you follow a particular TCP session

928
00:36:02,700 --> 00:36:07,019
stream you might get some n<font color="#CCCCCC"> coatings you</font>

929
00:36:04,740 --> 00:36:08,538
might get some raw data but you need<font color="#E5E5E5"> to</font>

930
00:36:07,019 --> 00:36:11,189
really<font color="#E5E5E5"> need to handle the raw data</font>

931
00:36:08,539 --> 00:36:13,200
verified with the MZ header on the PE

932
00:36:11,190 --> 00:36:15,480
executable and reconstruct the<font color="#E5E5E5"> bindery</font>

933
00:36:13,200 --> 00:36:18,509
<font color="#E5E5E5">so again it's a very</font><font color="#CCCCCC"> very simple process</font>

934
00:36:15,480 --> 00:36:21,660
<font color="#E5E5E5">but this works both on the encrypted</font>

935
00:36:18,509 --> 00:36:23,519
session and unencrypted sessions so even

936
00:36:21,660 --> 00:36:24,899
if then an unencrypted<font color="#CCCCCC"> unencrypted you</font>

937
00:36:23,519 --> 00:36:26,459
still get the<font color="#CCCCCC"> bindery which may be</font>

938
00:36:24,900 --> 00:36:28,920
encrypted then you have to perform

939
00:36:26,460 --> 00:36:30,990
<font color="#E5E5E5">reverse engineering which is not a scope</font>

940
00:36:28,920 --> 00:36:33,480
of this talk so we are relating to the

941
00:36:30,990 --> 00:36:38,430
entry points to the infection points and

942
00:36:33,480 --> 00:36:39,930
that's<font color="#E5E5E5"> how we extract executables so</font>

943
00:36:38,430 --> 00:36:41,460
what it looks like it looks like like

944
00:36:39,930 --> 00:36:43,259
this so i<font color="#E5E5E5"> have a trace of that</font>

945
00:36:41,460 --> 00:36:45,960
particular malware it was some sort of

946
00:36:43,259 --> 00:36:47,730
in 32 rootkit downloader so when you get

947
00:36:45,960 --> 00:36:49,140
<font color="#E5E5E5">this thing so you get the follow session</font>

948
00:36:47,730 --> 00:36:51,480
stream analysis you get this kind<font color="#E5E5E5"> of</font>

949
00:36:49,140 --> 00:36:53,609
data and if you<font color="#CCCCCC"> look at the response</font>

950
00:36:51,480 --> 00:36:55,799
there<font color="#E5E5E5"> is an MZ header right from the</font>

951
00:36:53,609 --> 00:36:58,288
start and then you can copy that data in

952
00:36:55,799 --> 00:37:00,990
the raw format and build a file the

953
00:36:58,289 --> 00:37:03,029
rename it as dot exe still gives you a

954
00:37:00,990 --> 00:37:04,910
lot of idea even<font color="#E5E5E5"> if you're</font><font color="#CCCCCC"> not able to</font>

955
00:37:03,029 --> 00:37:08,039
you know reform it formulated

956
00:37:04,910 --> 00:37:10,109
appropriately but still you can you know

957
00:37:08,039 --> 00:37:12,809
do some sort of disassembly on that to

958
00:37:10,109 --> 00:37:15,000
get<font color="#E5E5E5"> the things out is being designed but</font>

959
00:37:12,809 --> 00:37:18,779
careful analysis can do the things turn

960
00:37:15,000 --> 00:37:21,690
for it so now this<font color="#CCCCCC"> is a beautiful part</font>

961
00:37:18,779 --> 00:37:25,230
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> what is</font><font color="#CCCCCC"> all about</font><font color="#E5E5E5"> them you know</font>

962
00:37:21,690 --> 00:37:27,390
the core<font color="#CCCCCC"> of this talk is the case</font>

963
00:37:25,230 --> 00:37:29,009
studies so<font color="#CCCCCC"> whatever</font><font color="#E5E5E5"> they discuss so</font>

964
00:37:27,390 --> 00:37:31,769
getting start from the point browser

965
00:37:29,009 --> 00:37:35,430
malware taxonomy website and factions

966
00:37:31,769 --> 00:37:37,319
traffic analysis penetration testing and

967
00:37:35,430 --> 00:37:39,180
other case studies this will<font color="#E5E5E5"> show you</font>

968
00:37:37,319 --> 00:37:41,339
<font color="#CCCCCC">how we hack into these some</font><font color="#E5E5E5"> of the</font>

969
00:37:39,180 --> 00:37:42,990
malware domains and what is a good point

970
00:37:41,339 --> 00:37:45,450
<font color="#E5E5E5">to look forward and you will see what</font>

971
00:37:42,990 --> 00:37:47,279
kind of techniques are required to get

972
00:37:45,450 --> 00:37:49,560
the things done so the whole equation

973
00:37:47,279 --> 00:37:52,590
has to be solved as I

974
00:37:49,560 --> 00:37:54,990
projected in the<font color="#CCCCCC"> start of the</font><font color="#E5E5E5"> stock so</font>

975
00:37:52,590 --> 00:37:57,750
the first so the first case<font color="#E5E5E5"> study is</font>

976
00:37:54,990 --> 00:37:59,250
about the blackhole exploit back hunt so

977
00:37:57,750 --> 00:38:02,640
I have actually written as some sort of

978
00:37:59,250 --> 00:38:04,080
quite points here like it's off most of

979
00:38:02,640 --> 00:38:07,410
the aggressive exploit<font color="#CCCCCC"> pack used</font>

980
00:38:04,080 --> 00:38:09,720
nowadays apart from the Phoenix use

981
00:38:07,410 --> 00:38:12,390
extensively for spreading malware in

982
00:38:09,720 --> 00:38:14,279
conjunction used with botnets or any

983
00:38:12,390 --> 00:38:16,920
sort of other malware depending on<font color="#CCCCCC"> the</font>

984
00:38:14,280 --> 00:38:18,140
value a writer exploit browser and

985
00:38:16,920 --> 00:38:20,340
<font color="#CCCCCC">plug-in vulnerabilities and</font>

986
00:38:18,140 --> 00:38:22,230
collaboratively use with botnets to

987
00:38:20,340 --> 00:38:25,380
spread malware that what is we are

988
00:38:22,230 --> 00:38:28,350
talking<font color="#E5E5E5"> about so wow the whole you know</font>

989
00:38:25,380 --> 00:38:30,660
the infection procedure started in this

990
00:38:28,350 --> 00:38:33,420
malicious<font color="#CCCCCC"> Lanka's link is served to you</font>

991
00:38:30,660 --> 00:38:36,839
maybe phishing email scam emails and

992
00:38:33,420 --> 00:38:38,550
kind<font color="#E5E5E5"> of stuff now we know that most of</font>

993
00:38:36,840 --> 00:38:40,770
the malware writer exploits the user

994
00:38:38,550 --> 00:38:42,360
ignorance maybe they are not maybe just

995
00:38:40,770 --> 00:38:44,420
try to trick them maybe then forcing

996
00:38:42,360 --> 00:38:47,490
them to do that that's what they do

997
00:38:44,420 --> 00:38:51,810
luckily or unluckily unfortunately user

998
00:38:47,490 --> 00:38:53,729
clicks tattling get onto a website as<font color="#E5E5E5"> I</font>

999
00:38:51,810 --> 00:38:55,740
stated you earlier all that finger

1000
00:38:53,730 --> 00:38:58,380
printing stuff happens solves the

1001
00:38:55,740 --> 00:39:00,209
exploit so this study has been conducted

1002
00:38:58,380 --> 00:39:01,710
in one of the university network of mine

1003
00:39:00,210 --> 00:39:03,780
where we found<font color="#E5E5E5"> that the guys doing this</font>

1004
00:39:01,710 --> 00:39:06,330
thing and how we caught catch that guy

1005
00:39:03,780 --> 00:39:08,640
is that<font color="#E5E5E5"> how it works and that's what he</font>

1006
00:39:06,330 --> 00:39:11,130
does so uh malicious<font color="#CCCCCC"> iframe is Austrian</font>

1007
00:39:08,640 --> 00:39:13,799
into it which is pointing to the malware

1008
00:39:11,130 --> 00:39:17,700
PHX index dot PHP which is actually a

1009
00:39:13,800 --> 00:39:19,530
browser exploit pack and exploit was

1010
00:39:17,700 --> 00:39:21,359
served based on the environment so okay

1011
00:39:19,530 --> 00:39:23,010
we got there this is something infection

1012
00:39:21,360 --> 00:39:25,020
is going on there so what<font color="#E5E5E5"> could be done</font>

1013
00:39:23,010 --> 00:39:28,500
what can kind<font color="#E5E5E5"> of framework it is being</font>

1014
00:39:25,020 --> 00:39:30,120
running<font color="#E5E5E5"> based on malware so all this</font>

1015
00:39:28,500 --> 00:39:32,100
gives up the information<font color="#CCCCCC"> we try to set</font>

1016
00:39:30,120 --> 00:39:33,839
up a vm your environment labs and all

1017
00:39:32,100 --> 00:39:36,450
that stuff and try to<font color="#E5E5E5"> start hunting the</font>

1018
00:39:33,840 --> 00:39:39,150
stuff so what it does so<font color="#E5E5E5"> where we found</font>

1019
00:39:36,450 --> 00:39:42,060
<font color="#E5E5E5">that how it exploits our machine is</font><font color="#CCCCCC"> that</font>

1020
00:39:39,150 --> 00:39:46,410
it exploits one<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> java smb1 ability</font>

1021
00:39:42,060 --> 00:39:48,180
and it just were because<font color="#E5E5E5"> we were running</font>

1022
00:39:46,410 --> 00:39:50,310
like vulnerable version of Java scripts

1023
00:39:48,180 --> 00:39:53,370
in a minimum environment so it serves

1024
00:39:50,310 --> 00:39:56,730
this expired it experts the<font color="#CCCCCC"> java and you</font>

1025
00:39:53,370 --> 00:39:58,410
know try to you know lower download the

1026
00:39:56,730 --> 00:40:00,810
particular bought file may be a spy<font color="#E5E5E5"> i</font>

1027
00:39:58,410 --> 00:40:03,359
bought into it and that's<font color="#E5E5E5"> the good part</font>

1028
00:40:00,810 --> 00:40:05,580
but it's<font color="#E5E5E5"> not fun fun for us</font>

1029
00:40:03,360 --> 00:40:07,520
Ryan<font color="#E5E5E5"> okay I set up an environment which</font>

1030
00:40:05,580 --> 00:40:10,290
is being exploited and infected by this

1031
00:40:07,520 --> 00:40:11,970
so what's the fun here like we need<font color="#CCCCCC"> to</font>

1032
00:40:10,290 --> 00:40:13,410
control that domain we need to control

1033
00:40:11,970 --> 00:40:15,959
that server where the blackhole exploit

1034
00:40:13,410 --> 00:40:17,819
back is so the first point that came<font color="#CCCCCC"> up</font>

1035
00:40:15,960 --> 00:40:20,730
to the factor that if is running a java

1036
00:40:17,820 --> 00:40:23,190
SMB exploit it must have some sort of

1037
00:40:20,730 --> 00:40:25,650
SMB server hosted on the<font color="#E5E5E5"> same domain or</font>

1038
00:40:23,190 --> 00:40:27,480
maybe on the sub domain and that is true

1039
00:40:25,650 --> 00:40:30,660
because that exploit cannot be solved

1040
00:40:27,480 --> 00:40:32,190
without SMB running on your server<font color="#CCCCCC"> ok so</font>

1041
00:40:30,660 --> 00:40:34,980
this is the thing<font color="#E5E5E5"> we get in touch with</font>

1042
00:40:32,190 --> 00:40:37,560
<font color="#E5E5E5">the SMB server so what how the SMB</font>

1043
00:40:34,980 --> 00:40:39,900
server is configured so of course we

1044
00:40:37,560 --> 00:40:41,820
need to initiate an nmap decoy scan and

1045
00:40:39,900 --> 00:40:44,640
why<font color="#E5E5E5"> I love to use this scan and this is</font>

1046
00:40:41,820 --> 00:40:47,010
a pretty good way to<font color="#CCCCCC"> or IP spoofing now</font>

1047
00:40:44,640 --> 00:40:50,069
try to use a direct scan because it's a

1048
00:40:47,010 --> 00:40:51,780
war between steals and the steel guys so

1049
00:40:50,070 --> 00:40:53,580
that ich weiß can gives me an idea ok

1050
00:40:51,780 --> 00:40:55,710
this SMB server is somewhere running on

1051
00:40:53,580 --> 00:40:58,560
there<font color="#E5E5E5"> and that is hosting a particular</font>

1052
00:40:55,710 --> 00:40:59,940
exploit that is true otherwise it won't

1053
00:40:58,560 --> 00:41:03,029
have been<font color="#E5E5E5"> exploited</font><font color="#CCCCCC"> that vulnerability</font>

1054
00:40:59,940 --> 00:41:04,830
now what so on performing some sort<font color="#E5E5E5"> of</font>

1055
00:41:03,030 --> 00:41:06,630
analysis in the system we fall at this

1056
00:41:04,830 --> 00:41:08,850
particular file looking<font color="#E5E5E5"> into the traffic</font>

1057
00:41:06,630 --> 00:41:13,320
analysis is being served the new dot avi

1058
00:41:08,850 --> 00:41:15,060
file which was an exploit<font color="#E5E5E5"> ok this pretty</font>

1059
00:41:13,320 --> 00:41:17,010
good while I regarded the file but how

1060
00:41:15,060 --> 00:41:19,529
it is being you know sent by the SMB

1061
00:41:17,010 --> 00:41:21,030
server so it actually uses the UNC

1062
00:41:19,530 --> 00:41:23,280
naming conventions you when you try to

1063
00:41:21,030 --> 00:41:26,100
browse a computer in the land<font color="#E5E5E5"> network</font>

1064
00:41:23,280 --> 00:41:28,590
you do that thing Universal naming stuff

1065
00:41:26,100 --> 00:41:31,140
and then you simply get got it on<font color="#E5E5E5"> the</font>

1066
00:41:28,590 --> 00:41:33,120
internet internet and that's how it<font color="#E5E5E5"> does</font>

1067
00:41:31,140 --> 00:41:35,040
the work<font color="#E5E5E5"> ok we got the file but the</font>

1068
00:41:33,120 --> 00:41:37,440
point is that how the SMB is configured

1069
00:41:35,040 --> 00:41:39,870
if I want<font color="#E5E5E5"> to run some sort of SMB scan</font>

1070
00:41:37,440 --> 00:41:42,450
or as<font color="#E5E5E5"> semi brute forcing some sort of</font>

1071
00:41:39,870 --> 00:41:44,640
for the<font color="#E5E5E5"> accounts so we know that SMB has</font>

1072
00:41:42,450 --> 00:41:46,529
<font color="#CCCCCC">a two modes which call as a user mood</font>

1073
00:41:44,640 --> 00:41:48,870
and other one<font color="#CCCCCC"> is called</font><font color="#E5E5E5"> as a sheer mood</font>

1074
00:41:46,530 --> 00:41:50,250
so if it<font color="#CCCCCC"> is running</font><font color="#E5E5E5"> in user mode it</font>

1075
00:41:48,870 --> 00:41:52,950
should have any some sort of username

1076
00:41:50,250 --> 00:41:54,450
and password which is ninety percent of

1077
00:41:52,950 --> 00:41:56,069
<font color="#CCCCCC">our cases not possible because it's</font>

1078
00:41:54,450 --> 00:41:59,310
running in a default<font color="#E5E5E5"> state and it is</font>

1079
00:41:56,070 --> 00:42:01,170
serving of files directly to us so of

1080
00:41:59,310 --> 00:42:02,580
course there must be a shared mode and

1081
00:42:01,170 --> 00:42:05,460
<font color="#E5E5E5">that's what it does so there</font><font color="#CCCCCC"> is a</font>

1082
00:42:02,580 --> 00:42:07,440
default IP share was available<font color="#E5E5E5"> and we</font>

1083
00:42:05,460 --> 00:42:10,500
just run a quick check and find that<font color="#E5E5E5"> ok</font>

1084
00:42:07,440 --> 00:42:13,230
it gives me a enumeration through IPC

1085
00:42:10,500 --> 00:42:15,870
sheer pretty good so we get into the job

1086
00:42:13,230 --> 00:42:16,990
fingerprinting the environment<font color="#E5E5E5"> for java</font>

1087
00:42:15,870 --> 00:42:19,270
SMB exploit

1088
00:42:16,990 --> 00:42:22,509
now what we need to<font color="#E5E5E5"> verify the facts and</font>

1089
00:42:19,270 --> 00:42:23,710
the<font color="#CCCCCC"> server was not browsable okay so if</font>

1090
00:42:22,510 --> 00:42:25,750
you're using a double slash and then

1091
00:42:23,710 --> 00:42:28,240
singles / try to look into the resource

1092
00:42:25,750 --> 00:42:30,700
it is not browsable<font color="#CCCCCC"> okay one option is</font>

1093
00:42:28,240 --> 00:42:33,279
gone now what so we found that there is

1094
00:42:30,700 --> 00:42:36,879
a new dot avi file and we try to start

1095
00:42:33,280 --> 00:42:39,010
fussing<font color="#E5E5E5"> the request on that part because</font>

1096
00:42:36,880 --> 00:42:40,510
browsable means you may not be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font>

1097
00:42:39,010 --> 00:42:42,820
browse the whole directory or different

1098
00:42:40,510 --> 00:42:45,610
<font color="#E5E5E5">directories on server but then you get</font>

1099
00:42:42,820 --> 00:42:48,310
onto<font color="#E5E5E5"> this typical file which is exploit</font>

1100
00:42:45,610 --> 00:42:50,350
then it then it gets it done you will

1101
00:42:48,310 --> 00:42:53,500
get that file<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we start</font><font color="#E5E5E5"> fussing using</font>

1102
00:42:50,350 --> 00:42:55,330
this the UNC path and we found<font color="#E5E5E5"> that in</font>

1103
00:42:53,500 --> 00:42:58,480
the<font color="#E5E5E5"> default home SMB environment there</font>

1104
00:42:55,330 --> 00:43:00,009
is a new dot avi file<font color="#CCCCCC"> is 0 of course we</font>

1105
00:42:58,480 --> 00:43:01,840
got that so the SMB server has been

1106
00:43:00,010 --> 00:43:03,520
<font color="#E5E5E5">running in share mode doing this</font>

1107
00:43:01,840 --> 00:43:06,520
particular file and get the things done

1108
00:43:03,520 --> 00:43:08,350
<font color="#E5E5E5">and if you have a good understanding of</font>

1109
00:43:06,520 --> 00:43:10,509
SMB you will feel that if this is a

1110
00:43:08,350 --> 00:43:12,880
problem we are browsable is not allowed

1111
00:43:10,510 --> 00:43:15,700
you will try to fetch that this may be a

1112
00:43:12,880 --> 00:43:17,830
particular options global or SMB<font color="#E5E5E5"> and</font>

1113
00:43:15,700 --> 00:43:20,980
this may be configured in this way this

1114
00:43:17,830 --> 00:43:22,450
<font color="#E5E5E5">is true and on the next part so we</font>

1115
00:43:20,980 --> 00:43:24,609
browse that<font color="#E5E5E5"> particular thing in browser</font>

1116
00:43:22,450 --> 00:43:26,500
and we get that exploit and we found

1117
00:43:24,609 --> 00:43:28,359
<font color="#E5E5E5">that the guy was</font><font color="#CCCCCC"> like a script kiddie or</font>

1118
00:43:26,500 --> 00:43:29,740
something like that so when we try to

1119
00:43:28,359 --> 00:43:31,840
brute force their semi log in

1120
00:43:29,740 --> 00:43:34,689
credentials we take control over the SMP

1121
00:43:31,840 --> 00:43:37,630
server and we gotta control of the

1122
00:43:34,690 --> 00:43:40,030
blackhole exploit<font color="#CCCCCC"> pack and how it works</font>

1123
00:43:37,630 --> 00:43:42,280
so it works in two ways you get the

1124
00:43:40,030 --> 00:43:43,840
control<font color="#E5E5E5"> of domain and you get the source</font>

1125
00:43:42,280 --> 00:43:45,940
code or how it<font color="#E5E5E5"> is being running on</font><font color="#CCCCCC"> the</font>

1126
00:43:43,840 --> 00:43:49,180
server so it's a profitable business

1127
00:43:45,940 --> 00:43:51,040
from both perspective but this is what

1128
00:43:49,180 --> 00:43:53,109
is required maybe they say we are bad

1129
00:43:51,040 --> 00:43:54,400
guys but they are the bad guys we are

1130
00:43:53,109 --> 00:43:55,960
the good hackers that's what we are

1131
00:43:54,400 --> 00:43:57,720
doing but we are exploiting the same

1132
00:43:55,960 --> 00:43:59,680
penetration testing approach and

1133
00:43:57,720 --> 00:44:02,830
considering<font color="#E5E5E5"> this case study you will</font>

1134
00:43:59,680 --> 00:44:05,080
find<font color="#E5E5E5"> that why it is necessary to have</font>

1135
00:44:02,830 --> 00:44:09,369
<font color="#CCCCCC">information for all these three things</font>

1136
00:44:05,080 --> 00:44:11,770
to get the control and<font color="#E5E5E5"> the last one is</font>

1137
00:44:09,369 --> 00:44:14,490
like latest we found a one ability<font color="#E5E5E5"> in</font>

1138
00:44:11,770 --> 00:44:18,220
spy I botnet command and control server

1139
00:44:14,490 --> 00:44:19,839
so the spy I CNCs as I say you can<font color="#CCCCCC"> go</font>

1140
00:44:18,220 --> 00:44:22,180
for<font color="#CCCCCC"> Google</font><font color="#E5E5E5"> pattern matching then you can</font>

1141
00:44:19,840 --> 00:44:24,359
go for various you know<font color="#E5E5E5"> online websites</font>

1142
00:44:22,180 --> 00:44:27,279
and if you get us<font color="#CCCCCC"> some</font>

1143
00:44:24,359 --> 00:44:29,410
malware hosting domain so it again

1144
00:44:27,280 --> 00:44:31,930
depends on a lot what kind of version of

1145
00:44:29,410 --> 00:44:34,210
<font color="#CCCCCC">Spy is running so we exploit a1 dot 3</font>

1146
00:44:31,930 --> 00:44:37,359
version what it does so regardless

1147
00:44:34,210 --> 00:44:39,280
sequel injection in it and this sequel

1148
00:44:37,359 --> 00:44:41,529
injection is so productive that we don't

1149
00:44:39,280 --> 00:44:43,810
<font color="#CCCCCC">even need to login into a particular</font>

1150
00:44:41,530 --> 00:44:45,580
<font color="#E5E5E5">thing and that particular domain and</font>

1151
00:44:43,810 --> 00:44:47,580
server is running a my sequel version

1152
00:44:45,580 --> 00:44:50,080
which is running on<font color="#E5E5E5"> 3305</font><font color="#CCCCCC"> boot and</font>

1153
00:44:47,580 --> 00:44:51,609
getting on this particular secret

1154
00:44:50,080 --> 00:44:53,170
injection vulnerability if you look at

1155
00:44:51,609 --> 00:44:55,240
the<font color="#E5E5E5"> screenshot we start running the</font>

1156
00:44:53,170 --> 00:44:57,760
injections and first one is a version

1157
00:44:55,240 --> 00:45:01,390
<font color="#CCCCCC">number so when they run a blind sequel</font>

1158
00:44:57,760 --> 00:45:03,070
on<font color="#E5E5E5"> it we get a version number jumping on</font>

1159
00:45:01,390 --> 00:45:05,049
to the<font color="#E5E5E5"> next part we try to see what kind</font>

1160
00:45:03,070 --> 00:45:07,900
of database is running so it goes gives

1161
00:45:05,050 --> 00:45:10,000
us the life<font color="#E5E5E5"> tom sex database and the</font>

1162
00:45:07,900 --> 00:45:13,450
last in the final shot we did is to get

1163
00:45:10,000 --> 00:45:15,280
the my sequel user root password and you

1164
00:45:13,450 --> 00:45:18,069
run a blank sequel injection and you got

1165
00:45:15,280 --> 00:45:20,340
like a root localhost password which is

1166
00:45:18,070 --> 00:45:22,570
admin password for the my sequel

1167
00:45:20,340 --> 00:45:25,420
database and you of<font color="#CCCCCC"> course you have a</font>

1168
00:45:22,570 --> 00:45:27,310
<font color="#CCCCCC">3305 port open the connection is all</font>

1169
00:45:25,420 --> 00:45:28,930
yours to use my zq client connect to it

1170
00:45:27,310 --> 00:45:31,150
and then you can search through lot of

1171
00:45:28,930 --> 00:45:33,399
database which is<font color="#E5E5E5"> being used</font><font color="#CCCCCC"> by it and</font>

1172
00:45:31,150 --> 00:45:35,460
you don't<font color="#E5E5E5"> need to login into a spy I</font>

1173
00:45:33,400 --> 00:45:38,950
command and control server to do<font color="#E5E5E5"> this</font>

1174
00:45:35,460 --> 00:45:41,140
<font color="#E5E5E5">it's just a free again is a web app</font>

1175
00:45:38,950 --> 00:45:44,020
right it's a PHP based web framework

1176
00:45:41,140 --> 00:45:47,890
they are using<font color="#E5E5E5"> and that how we get in</font>

1177
00:45:44,020 --> 00:45:49,750
touch with it and that's you pawn it so

1178
00:45:47,890 --> 00:45:52,900
at<font color="#CCCCCC"> last so we presented two case studies</font>

1179
00:45:49,750 --> 00:45:55,240
which actually you know proves our

1180
00:45:52,900 --> 00:45:57,640
equation get malware hunting good hacker

1181
00:45:55,240 --> 00:46:00,160
is equal to penetration testing less

1182
00:45:57,640 --> 00:46:02,890
malware analysis plus web app security

1183
00:46:00,160 --> 00:46:05,049
and that what it<font color="#CCCCCC"> is all about so I just</font>

1184
00:46:02,890 --> 00:46:06,670
want to<font color="#E5E5E5"> raise the three points malvern</font>

1185
00:46:05,050 --> 00:46:08,980
you should have a<font color="#E5E5E5"> good understanding of</font>

1186
00:46:06,670 --> 00:46:11,250
malware infection framework PHP based

1187
00:46:08,980 --> 00:46:14,500
applications so<font color="#CCCCCC"> spira is written in PHP</font>

1188
00:46:11,250 --> 00:46:16,660
same information works working of

1189
00:46:14,500 --> 00:46:18,369
<font color="#E5E5E5">exploits serving mechanisms really much</font>

1190
00:46:16,660 --> 00:46:20,500
required if I<font color="#E5E5E5"> don't have any great</font>

1191
00:46:18,369 --> 00:46:22,750
details of the<font color="#CCCCCC"> java SMB works i wouldn't</font>

1192
00:46:20,500 --> 00:46:24,460
have been getting to this point and then

1193
00:46:22,750 --> 00:46:27,609
the<font color="#CCCCCC"> detailed web security knowledge of</font>

1194
00:46:24,460 --> 00:46:31,119
all types of attacks and at last think

1195
00:46:27,609 --> 00:46:32,560
like an attacker and that what it is<font color="#E5E5E5"> all</font>

1196
00:46:31,119 --> 00:46:34,060
about and these are some of<font color="#E5E5E5"> the</font>

1197
00:46:32,560 --> 00:46:35,950
references you can fetch all our

1198
00:46:34,060 --> 00:46:37,570
available online<font color="#E5E5E5"> or you can drop me an</font>

1199
00:46:35,950 --> 00:46:41,799
<font color="#E5E5E5">email for any paper or</font><font color="#CCCCCC"> anything</font>

1200
00:46:37,570 --> 00:46:44,860
and thanks to ask my teammates acne<font color="#E5E5E5"> chey</font>

1201
00:46:41,800 --> 00:46:48,210
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> Twitter you can catch me on here</font>

1202
00:46:44,860 --> 00:46:48,210
and thanks very much

