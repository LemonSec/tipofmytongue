1
00:00:00,000 --> 00:00:13,019
video do it awesome

2
00:00:10,920 --> 00:00:14,190
<font color="#CCCCCC">alright we'll</font><font color="#E5E5E5"> get rid of this guy net</font>

3
00:00:13,019 --> 00:00:15,120
logo<font color="#E5E5E5"> I'm sure everyone's getting worried</font>

4
00:00:14,190 --> 00:00:18,509
that we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to start</font><font color="#E5E5E5"> taking over</font>

5
00:00:15,120 --> 00:00:19,230
<font color="#E5E5E5">computers and and start issuing world</font>

6
00:00:18,510 --> 00:00:22,859
domination

7
00:00:19,230 --> 00:00:24,570
welcome to myself<font color="#E5E5E5"> Matt and Brian's talk</font>

8
00:00:22,859 --> 00:00:26,010
<font color="#E5E5E5">Skynet will use PS exec when</font>

9
00:00:24,570 --> 00:00:27,599
sysinternals go bad before<font color="#CCCCCC"> we get</font>

10
00:00:26,010 --> 00:00:31,859
started how many red teamers do we have

11
00:00:27,599 --> 00:00:36,540
<font color="#E5E5E5">an audience I see</font><font color="#CCCCCC"> half a hand any blue</font>

12
00:00:31,859 --> 00:00:40,530
teamers<font color="#CCCCCC"> okay all right any sysadmin</font><font color="#E5E5E5"> any</font>

13
00:00:36,540 --> 00:00:41,760
of all of the<font color="#E5E5E5"> above maybe yeah all of</font><font color="#CCCCCC"> a</font>

14
00:00:40,530 --> 00:00:43,110
sudden<font color="#CCCCCC"> people</font><font color="#E5E5E5"> are like oh yeah I do some</font>

15
00:00:41,760 --> 00:00:44,399
of<font color="#CCCCCC"> that stuff okay</font><font color="#E5E5E5"> cool</font><font color="#CCCCCC"> well</font><font color="#E5E5E5"> hopefully</font>

16
00:00:43,110 --> 00:00:47,190
then this talk will serve as

17
00:00:44,399 --> 00:00:48,660
enlightening<font color="#CCCCCC"> and we'll all walk away</font>

18
00:00:47,190 --> 00:00:51,690
learning<font color="#CCCCCC"> a little</font><font color="#E5E5E5"> bit more about how we</font>

19
00:00:48,660 --> 00:00:52,440
<font color="#CCCCCC">can how we can</font><font color="#E5E5E5"> use sysinternals</font><font color="#CCCCCC"> to do</font>

20
00:00:51,690 --> 00:00:55,489
bad things

21
00:00:52,440 --> 00:00:57,809
infiltrate an environment and hopefully

22
00:00:55,489 --> 00:01:00,538
<font color="#E5E5E5">prevent Skynet</font><font color="#CCCCCC"> from actually taking over</font>

23
00:00:57,809 --> 00:01:01,828
<font color="#E5E5E5">but we'll see</font><font color="#CCCCCC"> so far</font><font color="#E5E5E5"> we wouldn't really</font>

24
00:01:00,539 --> 00:01:04,320
know if it hit<font color="#E5E5E5"> because all you really</font>

25
00:01:01,829 --> 00:01:06,479
<font color="#CCCCCC">need is an SMB vulnerability and someone</font>

26
00:01:04,319 --> 00:01:08,820
with some time on<font color="#E5E5E5"> their hands and the</font>

27
00:01:06,479 --> 00:01:10,140
world can<font color="#E5E5E5"> come to a seeming end but then</font>

28
00:01:08,820 --> 00:01:12,270
all you have to<font color="#E5E5E5"> do is not register a</font>

29
00:01:10,140 --> 00:01:14,340
domain and you can<font color="#CCCCCC"> ND end the</font><font color="#E5E5E5"> apocalypse</font>

30
00:01:12,270 --> 00:01:15,869
so this talk should really the Skynet

31
00:01:14,340 --> 00:01:18,869
will register all<font color="#CCCCCC"> of its domains but</font>

32
00:01:15,869 --> 00:01:20,670
we'd be here for<font color="#CCCCCC"> like</font><font color="#E5E5E5"> 30 seconds so all</font>

33
00:01:18,869 --> 00:01:21,780
right a little<font color="#E5E5E5"> bit about who we</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> I'm</font>

34
00:01:20,670 --> 00:01:23,580
going<font color="#CCCCCC"> to do this in reverse order my</font>

35
00:01:21,780 --> 00:01:25,200
name is Matt Bromley<font color="#E5E5E5"> I'm the one to the</font>

36
00:01:23,580 --> 00:01:26,789
<font color="#CCCCCC">other side of the</font><font color="#E5E5E5"> screen</font><font color="#CCCCCC"> a senior</font>

37
00:01:25,200 --> 00:01:28,590
managing consultant<font color="#CCCCCC"> I'm basically an</font>

38
00:01:26,790 --> 00:01:31,290
instant responder<font color="#E5E5E5"> title is</font><font color="#CCCCCC"> just what's</font>

39
00:01:28,590 --> 00:01:34,740
<font color="#E5E5E5">on the side I'm also an instructor for</font>

40
00:01:31,290 --> 00:01:37,200
<font color="#E5E5E5">the sand program</font><font color="#CCCCCC"> I'm also a free and</font>

41
00:01:34,740 --> 00:01:38,850
<font color="#CCCCCC">open source software nut as well I'm not</font>

42
00:01:37,200 --> 00:01:40,680
<font color="#E5E5E5">a fan of proprietary software I hate</font>

43
00:01:38,850 --> 00:01:43,229
having<font color="#E5E5E5"> to pay for</font><font color="#CCCCCC"> things I'm not try to</font>

44
00:01:40,680 --> 00:01:46,799
do it free if possible<font color="#E5E5E5"> Brian I'm</font><font color="#CCCCCC"> brown</font>

45
00:01:43,229 --> 00:01:51,479
March<font color="#CCCCCC"> I'm a senior associate</font><font color="#E5E5E5"> at KPMG</font><font color="#CCCCCC"> in</font>

46
00:01:46,799 --> 00:01:53,399
the<font color="#E5E5E5"> realm of DF</font><font color="#CCCCCC"> IR and I'm an elf</font>

47
00:01:51,479 --> 00:01:56,158
fanatic this is probably one of the

48
00:01:53,399 --> 00:01:57,899
<font color="#CCCCCC">first to talk to Paul the</font><font color="#E5E5E5"> closer written</font>

49
00:01:56,159 --> 00:02:01,140
one<font color="#E5E5E5"> of the first talks I've done that</font>

50
00:01:57,899 --> 00:02:03,760
isn't<font color="#CCCCCC"> elk related</font>

51
00:02:01,140 --> 00:02:04,990
all right so really quick our<font color="#CCCCCC"> agenda as</font>

52
00:02:03,760 --> 00:02:06,310
we go through this you're<font color="#E5E5E5"> going to see a</font>

53
00:02:04,990 --> 00:02:07,479
bunch<font color="#E5E5E5"> of terminator slides all</font>

54
00:02:06,310 --> 00:02:09,369
throughout<font color="#E5E5E5"> this by the way we couldn't</font>

55
00:02:07,480 --> 00:02:10,990
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about Skynet without having the the</font>

56
00:02:09,369 --> 00:02:12,130
<font color="#E5E5E5">doomsday device inside we're going</font><font color="#CCCCCC"> to</font>

57
00:02:10,990 --> 00:02:13,390
talk a little<font color="#E5E5E5"> bit about</font><font color="#CCCCCC"> our prediction</font>

58
00:02:12,130 --> 00:02:15,490
<font color="#E5E5E5">hopefully that's going to line up</font><font color="#CCCCCC"> with a</font>

59
00:02:13,390 --> 00:02:17,470
lot of our red teamers<font color="#CCCCCC"> so we're</font><font color="#E5E5E5"> going to</font>

60
00:02:15,490 --> 00:02:18,910
go through some<font color="#CCCCCC"> different</font><font color="#E5E5E5"> steps of an</font>

61
00:02:17,470 --> 00:02:20,620
attack<font color="#E5E5E5"> life cycle where</font><font color="#CCCCCC"> you can actually</font>

62
00:02:18,910 --> 00:02:22,960
<font color="#E5E5E5">use</font><font color="#CCCCCC"> sysinternals it's going to include</font>

63
00:02:20,620 --> 00:02:24,910
recon<font color="#E5E5E5"> deployment persistence deployment</font>

64
00:02:22,960 --> 00:02:26,110
we're actually<font color="#E5E5E5"> calling execution</font><font color="#CCCCCC"> and</font>

65
00:02:24,910 --> 00:02:28,090
<font color="#E5E5E5">we're going</font><font color="#CCCCCC"> to talk about</font><font color="#E5E5E5"> some anti</font>

66
00:02:26,110 --> 00:02:29,650
forensics<font color="#E5E5E5"> like how we can catch</font><font color="#CCCCCC"> you at</font>

67
00:02:28,090 --> 00:02:31,990
what you're doing<font color="#CCCCCC"> we're going to look at</font>

68
00:02:29,650 --> 00:02:33,790
a threat group that<font color="#E5E5E5"> uses PS exec in the</font>

69
00:02:31,990 --> 00:02:35,320
wild<font color="#CCCCCC"> they're one of</font><font color="#E5E5E5"> anyone here had a</font>

70
00:02:33,790 --> 00:02:38,079
credit<font color="#E5E5E5"> card replaced in the past five</font>

71
00:02:35,320 --> 00:02:39,519
years<font color="#E5E5E5"> yeah I would imagine so we're</font>

72
00:02:38,080 --> 00:02:41,860
probably<font color="#E5E5E5"> going to talk about the group</font>

73
00:02:39,520 --> 00:02:42,910
<font color="#CCCCCC">that</font><font color="#E5E5E5"> was the cause of that</font><font color="#CCCCCC"> and then last</font>

74
00:02:41,860 --> 00:02:44,980
but<font color="#E5E5E5"> not least we're going to talk about</font>

75
00:02:42,910 --> 00:02:45,359
<font color="#CCCCCC">judgment day</font><font color="#E5E5E5"> when when that happens as</font>

76
00:02:44,980 --> 00:02:47,500
<font color="#E5E5E5">well</font>

77
00:02:45,360 --> 00:02:49,120
<font color="#E5E5E5">all right so Brian and I had a lot</font><font color="#CCCCCC"> of</font>

78
00:02:47,500 --> 00:02:51,310
discussions for this talk and<font color="#E5E5E5"> we came</font><font color="#CCCCCC"> up</font>

79
00:02:49,120 --> 00:02:52,930
with a<font color="#E5E5E5"> prediction and that is in order</font>

80
00:02:51,310 --> 00:02:54,580
<font color="#E5E5E5">to actually take over the world</font>

81
00:02:52,930 --> 00:02:57,190
<font color="#E5E5E5">Skynet's going to have to blend in</font>

82
00:02:54,580 --> 00:02:58,420
<font color="#E5E5E5">because we're way to a depth knowledge</font>

83
00:02:57,190 --> 00:03:00,030
<font color="#E5E5E5">someone starts crawling</font><font color="#CCCCCC"> around our</font>

84
00:02:58,420 --> 00:03:02,769
network we're going to catch<font color="#E5E5E5"> them</font>

85
00:03:00,030 --> 00:03:04,150
<font color="#CCCCCC">they're going</font><font color="#E5E5E5"> to do evade us and they're</font>

86
00:03:02,770 --> 00:03:05,590
<font color="#E5E5E5">going to need to be kind of they're not</font>

87
00:03:04,150 --> 00:03:08,350
<font color="#E5E5E5">going to care really about futile</font>

88
00:03:05,590 --> 00:03:09,820
endpoint detection<font color="#CCCCCC"> they have one goal</font>

89
00:03:08,350 --> 00:03:12,430
<font color="#E5E5E5">and it's to take over everything it's</font>

90
00:03:09,820 --> 00:03:13,299
<font color="#E5E5E5">not to try and get caught or see</font><font color="#CCCCCC"> us see</font>

91
00:03:12,430 --> 00:03:16,269
how far<font color="#E5E5E5"> they can go</font>

92
00:03:13,299 --> 00:03:18,850
domain admin is every the domain is the

93
00:03:16,269 --> 00:03:20,590
<font color="#E5E5E5">globe for Skynet however even with these</font>

94
00:03:18,850 --> 00:03:23,019
lofty goals<font color="#CCCCCC"> in mind we decided that</font>

95
00:03:20,590 --> 00:03:26,290
Skynet will also probably<font color="#CCCCCC"> be very lazy</font>

96
00:03:23,019 --> 00:03:28,420
<font color="#E5E5E5">the best hackers are lazy</font><font color="#CCCCCC"> anyone</font>

97
00:03:26,290 --> 00:03:30,579
<font color="#CCCCCC">disagree with that I think if there's</font>

98
00:03:28,420 --> 00:03:32,200
code<font color="#E5E5E5"> already on Stack Overflow that does</font>

99
00:03:30,580 --> 00:03:34,060
what I<font color="#CCCCCC"> need to do</font><font color="#E5E5E5"> guess what</font><font color="#CCCCCC"> I can</font>

100
00:03:32,200 --> 00:03:36,488
<font color="#CCCCCC">copy/paste with the best of</font><font color="#E5E5E5"> them</font><font color="#CCCCCC"> I don't</font>

101
00:03:34,060 --> 00:03:38,440
<font color="#CCCCCC">know anything</font><font color="#E5E5E5"> about upgrading Python</font><font color="#CCCCCC"> 2</font>

102
00:03:36,489 --> 00:03:40,870
to Python 3<font color="#CCCCCC"> rack and copy-paste</font><font color="#E5E5E5"> Python 3</font>

103
00:03:38,440 --> 00:03:42,130
code like it's nothing<font color="#CCCCCC"> so we think</font>

104
00:03:40,870 --> 00:03:43,840
Skynet's going to follow the same way

105
00:03:42,130 --> 00:03:45,910
<font color="#CCCCCC">they're machines</font><font color="#E5E5E5"> they look for</font>

106
00:03:43,840 --> 00:03:47,950
efficiencies<font color="#E5E5E5"> in the world they're not</font>

107
00:03:45,910 --> 00:03:49,750
<font color="#E5E5E5">going to build a whole class of</font>

108
00:03:47,950 --> 00:03:51,399
<font color="#E5E5E5">Terminator that are like malware authors</font>

109
00:03:49,750 --> 00:03:52,600
<font color="#CCCCCC">that are sitting</font><font color="#E5E5E5"> off to the side looking</font>

110
00:03:51,400 --> 00:03:54,010
for<font color="#CCCCCC"> vulnerabilities they're going</font><font color="#E5E5E5"> to</font>

111
00:03:52,600 --> 00:03:56,680
look<font color="#E5E5E5"> for ways to take</font><font color="#CCCCCC"> advantage</font><font color="#E5E5E5"> of the</font>

112
00:03:54,010 --> 00:03:57,910
systems that<font color="#E5E5E5"> are</font><font color="#CCCCCC"> already in place</font><font color="#E5E5E5"> we</font>

113
00:03:56,680 --> 00:03:59,410
think<font color="#E5E5E5"> they're going to</font><font color="#CCCCCC"> probably</font><font color="#E5E5E5"> most</font>

114
00:03:57,910 --> 00:04:00,940
likely utilize tools<font color="#E5E5E5"> that already</font>

115
00:03:59,410 --> 00:04:02,680
perform system<font color="#E5E5E5"> functions they're going</font>

116
00:04:00,940 --> 00:04:03,190
<font color="#E5E5E5">to do as well and</font><font color="#CCCCCC"> that's why we came to</font>

117
00:04:02,680 --> 00:04:04,329
<font color="#CCCCCC">inclusion</font>

118
00:04:03,190 --> 00:04:06,070
hence the talk of<font color="#E5E5E5"> they're most likely</font>

119
00:04:04,329 --> 00:04:07,900
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to use</font><font color="#E5E5E5"> sysinternals</font><font color="#CCCCCC"> there's no</font>

120
00:04:06,070 --> 00:04:09,519
reason that<font color="#E5E5E5"> as</font><font color="#CCCCCC"> badass red teeners you</font>

121
00:04:07,900 --> 00:04:10,630
guys can do the same<font color="#E5E5E5"> as well blue</font>

122
00:04:09,520 --> 00:04:13,690
teamers<font color="#CCCCCC"> we'll talk about</font><font color="#E5E5E5"> how to catch</font>

123
00:04:10,630 --> 00:04:15,910
them<font color="#E5E5E5"> so what's so great about</font><font color="#CCCCCC"> System</font>

124
00:04:13,690 --> 00:04:17,488
<font color="#E5E5E5">journals well first of all well coated</font><font color="#CCCCCC"> I</font>

125
00:04:15,910 --> 00:04:21,070
mean mark russinovich

126
00:04:17,488 --> 00:04:22,409
<font color="#CCCCCC">said it's been maintained</font><font color="#E5E5E5"> for years and</font>

127
00:04:21,070 --> 00:04:25,930
years

128
00:04:22,410 --> 00:04:27,820
supported<font color="#CCCCCC"> SP through Windows 10</font><font color="#E5E5E5"> Mac</font>

129
00:04:25,930 --> 00:04:30,820
called me out on<font color="#CCCCCC"> this</font><font color="#E5E5E5"> like if you go to</font>

130
00:04:27,820 --> 00:04:33,490
the the sysinternals website<font color="#E5E5E5"> for some of</font>

131
00:04:30,820 --> 00:04:35,950
these tools it'll say<font color="#E5E5E5"> Windows Vista</font><font color="#CCCCCC"> to</font>

132
00:04:33,490 --> 00:04:38,740
<font color="#E5E5E5">you know in greater but that</font><font color="#CCCCCC"> stuff's</font>

133
00:04:35,950 --> 00:04:40,690
going<font color="#E5E5E5"> to run on XP</font><font color="#CCCCCC"> even some</font><font color="#E5E5E5"> of these go</font>

134
00:04:38,740 --> 00:04:42,430
back<font color="#E5E5E5"> to Windows NT 2000 let me actually</font>

135
00:04:40,690 --> 00:04:44,500
pause<font color="#E5E5E5"> Brian who here still run an NT in</font>

136
00:04:42,430 --> 00:04:46,840
your environment<font color="#CCCCCC"> everyone look around</font>

137
00:04:44,500 --> 00:04:48,130
for<font color="#E5E5E5"> your next target</font><font color="#CCCCCC"> anybody no all</font>

138
00:04:46,840 --> 00:04:51,219
<font color="#CCCCCC">right</font><font color="#E5E5E5"> okay you don't have to admit it</font>

139
00:04:48,130 --> 00:04:53,740
out loud<font color="#E5E5E5"> I've got issues too so yeah</font>

140
00:04:51,220 --> 00:04:55,390
they're<font color="#E5E5E5"> nice and portable you</font><font color="#CCCCCC"> can just</font>

141
00:04:53,740 --> 00:04:56,590
grab<font color="#E5E5E5"> whatever you need</font><font color="#CCCCCC"> bring it</font><font color="#E5E5E5"> with you</font>

142
00:04:55,390 --> 00:04:58,500
you don't<font color="#CCCCCC"> need to install</font><font color="#E5E5E5"> the</font>

143
00:04:56,590 --> 00:05:00,460
dependencies anything like that

144
00:04:58,500 --> 00:05:02,860
<font color="#CCCCCC">particular to bring it</font><font color="#E5E5E5"> just pull it down</font>

145
00:05:00,460 --> 00:05:06,820
from<font color="#E5E5E5"> TechNet no problem they'll go</font>

146
00:05:02,860 --> 00:05:09,310
through<font color="#CCCCCC"> Microsoft typically allowed by</font>

147
00:05:06,820 --> 00:05:11,020
any type of<font color="#E5E5E5"> intrusion detection that</font>

148
00:05:09,310 --> 00:05:12,970
includes a be a lot of times<font color="#E5E5E5"> ad</font>

149
00:05:11,020 --> 00:05:14,620
<font color="#E5E5E5">whitelist all these because they're just</font>

150
00:05:12,970 --> 00:05:16,000
administration tools really<font color="#E5E5E5"> who here</font>

151
00:05:14,620 --> 00:05:18,010
knows his internals is used in your

152
00:05:16,000 --> 00:05:19,240
<font color="#E5E5E5">environment</font><font color="#CCCCCC"> anybody I'm assuming some</font>

153
00:05:18,010 --> 00:05:21,340
folks here are two<font color="#E5E5E5"> new security yeah</font>

154
00:05:19,240 --> 00:05:22,720
<font color="#E5E5E5">okay if you're looking for evidence of</font>

155
00:05:21,340 --> 00:05:23,619
attacker activity and you see<font color="#E5E5E5"> some</font>

156
00:05:22,720 --> 00:05:24,600
journals what's the first thought<font color="#E5E5E5"> that</font>

157
00:05:23,620 --> 00:05:27,880
comes<font color="#E5E5E5"> to your mind</font>

158
00:05:24,600 --> 00:05:30,190
probably an admin most likely<font color="#CCCCCC"> alright</font>

159
00:05:27,880 --> 00:05:32,500
<font color="#E5E5E5">see we can't change that</font><font color="#CCCCCC"> it goes right</font>

160
00:05:30,190 --> 00:05:34,719
<font color="#CCCCCC">into the</font><font color="#E5E5E5"> next point blends in with any</font>

161
00:05:32,500 --> 00:05:37,210
of your IT admins are using any of these

162
00:05:34,720 --> 00:05:40,840
<font color="#CCCCCC">tools and from a forensic perspective we</font>

163
00:05:37,210 --> 00:05:42,400
need to kind<font color="#E5E5E5"> of find out which are</font>

164
00:05:40,840 --> 00:05:46,390
legitimate uses<font color="#E5E5E5"> which are illegitimate</font>

165
00:05:42,400 --> 00:05:47,799
illegitimate<font color="#E5E5E5"> just a total nightmare</font><font color="#CCCCCC"> from</font>

166
00:05:46,390 --> 00:05:51,310
<font color="#CCCCCC">the dfi our guy</font><font color="#E5E5E5"> I can't believe I'm</font>

167
00:05:47,800 --> 00:05:53,410
saying this stuff and<font color="#E5E5E5"> again</font><font color="#CCCCCC"> a few</font>

168
00:05:51,310 --> 00:05:54,840
friends<font color="#E5E5E5"> of artifacts</font><font color="#CCCCCC"> coming from a dfi</font>

169
00:05:53,410 --> 00:05:57,160
our guy

170
00:05:54,840 --> 00:05:58,929
typically what<font color="#CCCCCC"> happens in the GUI stays</font>

171
00:05:57,160 --> 00:06:00,850
in the GUI<font color="#CCCCCC"> I'm not talking about the</font>

172
00:05:58,930 --> 00:06:04,710
Windows desktop<font color="#CCCCCC"> you use the Windows</font>

173
00:06:00,850 --> 00:06:04,710
desktop<font color="#CCCCCC"> you're writing stuff everywhere</font>

174
00:06:04,720 --> 00:06:08,050
<font color="#CCCCCC">you</font><font color="#E5E5E5"> search for anything Windows Explorer</font>

175
00:06:06,850 --> 00:06:10,960
it gets written<font color="#CCCCCC"> all over the registry</font>

176
00:06:08,050 --> 00:06:13,660
I'm talking about<font color="#E5E5E5"> you launch a GUI like</font>

177
00:06:10,960 --> 00:06:16,060
cross bond<font color="#CCCCCC"> process Explorer or anything</font>

178
00:06:13,660 --> 00:06:17,380
<font color="#E5E5E5">like that from a forensics perspective</font>

179
00:06:16,060 --> 00:06:20,020
all you can<font color="#E5E5E5"> tells you launch that</font>

180
00:06:17,380 --> 00:06:21,400
<font color="#E5E5E5">executable</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> they use</font><font color="#CCCCCC"> it GUI well what</font>

181
00:06:20,020 --> 00:06:23,469
did they do with it<font color="#CCCCCC"> I can tell you what</font>

182
00:06:21,400 --> 00:06:25,789
they could do is what it's capable of

183
00:06:23,470 --> 00:06:27,830
but there's nothing<font color="#CCCCCC"> laws on</font>

184
00:06:25,790 --> 00:06:29,210
this exact<font color="#CCCCCC"> timestamp they performed this</font>

185
00:06:27,830 --> 00:06:31,130
<font color="#CCCCCC">function with that</font><font color="#E5E5E5"> no one's ever</font>

186
00:06:29,210 --> 00:06:33,229
complained<font color="#CCCCCC"> that to this in terms</font><font color="#E5E5E5"> of logs</font>

187
00:06:31,130 --> 00:06:34,460
<font color="#CCCCCC">to speak in a which actually brings up a</font>

188
00:06:33,230 --> 00:06:35,990
good<font color="#E5E5E5"> point from a forensic point of view</font>

189
00:06:34,460 --> 00:06:40,599
anyone know what the hardest<font color="#E5E5E5"> to track</font>

190
00:06:35,990 --> 00:06:40,600
exfiltration method is and he thought

191
00:06:40,630 --> 00:06:46,040
<font color="#CCCCCC">control-c control-v</font><font color="#E5E5E5"> clipboard is really</font>

192
00:06:44,540 --> 00:06:48,260
tough sometimes<font color="#CCCCCC"> especially after a</font>

193
00:06:46,040 --> 00:06:50,240
<font color="#E5E5E5">reboot</font><font color="#CCCCCC"> copy/paste is a good excellent so</font>

194
00:06:48,260 --> 00:06:52,969
<font color="#CCCCCC">to Brian's point</font><font color="#E5E5E5"> I can see you launched</font>

195
00:06:50,240 --> 00:06:55,460
notepad<font color="#CCCCCC"> I can see you launched some</font><font color="#E5E5E5"> sort</font>

196
00:06:52,970 --> 00:06:57,680
of text editing tool<font color="#E5E5E5"> maybe I can see</font>

197
00:06:55,460 --> 00:06:58,940
that your key press but I have no<font color="#E5E5E5"> idea</font>

198
00:06:57,680 --> 00:07:00,200
what you may have copied and copied out

199
00:06:58,940 --> 00:07:02,450
so it depends on on the type<font color="#CCCCCC"> of</font>

200
00:07:00,200 --> 00:07:03,500
visibility<font color="#E5E5E5"> that we have Brian brings up</font>

201
00:07:02,450 --> 00:07:04,849
a really<font color="#E5E5E5"> good</font><font color="#CCCCCC"> point too about these</font>

202
00:07:03,500 --> 00:07:07,010
tools<font color="#E5E5E5"> being allowed in most environments</font>

203
00:07:04,850 --> 00:07:09,530
<font color="#E5E5E5">we actually don't demo and walk through</font>

204
00:07:07,010 --> 00:07:11,150
this part<font color="#E5E5E5"> but if anyone hasn't used this</font>

205
00:07:09,530 --> 00:07:12,590
internals before it's a zip package that

206
00:07:11,150 --> 00:07:13,700
you download from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> internet can</font>

207
00:07:12,590 --> 00:07:16,549
download it from<font color="#E5E5E5"> the internet</font><font color="#CCCCCC"> that's</font>

208
00:07:13,700 --> 00:07:18,289
fine<font color="#CCCCCC"> TechNet</font><font color="#E5E5E5"> actually keeps open a</font><font color="#CCCCCC"> Wack</font>

209
00:07:16,550 --> 00:07:19,790
<font color="#CCCCCC">Wack</font><font color="#E5E5E5"> SMB share that you can connect to</font>

210
00:07:18,290 --> 00:07:22,160
<font color="#E5E5E5">at any point in time</font><font color="#CCCCCC"> whack-whack live</font>

211
00:07:19,790 --> 00:07:23,390
sysinternals<font color="#CCCCCC"> comm</font><font color="#E5E5E5"> hey</font><font color="#CCCCCC"> i didn't download</font>

212
00:07:22,160 --> 00:07:24,830
<font color="#E5E5E5">the tools or</font><font color="#CCCCCC"> I was not</font><font color="#E5E5E5"> allowing me to</font>

213
00:07:23,390 --> 00:07:26,419
pull<font color="#E5E5E5"> down a zip file</font><font color="#CCCCCC"> that's fine just</font>

214
00:07:24,830 --> 00:07:29,060
<font color="#E5E5E5">map a share over the</font><font color="#CCCCCC"> Internet</font><font color="#E5E5E5"> and just</font>

215
00:07:26,420 --> 00:07:30,830
<font color="#CCCCCC">pull them</font><font color="#E5E5E5"> down that way even better</font><font color="#CCCCCC"> you</font>

216
00:07:29,060 --> 00:07:32,600
can<font color="#E5E5E5"> map that</font><font color="#CCCCCC"> Drive and then just run</font>

217
00:07:30,830 --> 00:07:33,859
from<font color="#E5E5E5"> that drive if you want</font><font color="#CCCCCC"> to as well</font>

218
00:07:32,600 --> 00:07:35,720
<font color="#E5E5E5">so I don't</font><font color="#CCCCCC"> want to give in to the</font>

219
00:07:33,860 --> 00:07:38,110
discussion<font color="#CCCCCC"> of file</font><font color="#E5E5E5"> list malware because</font>

220
00:07:35,720 --> 00:07:40,520
that's a bit of a<font color="#CCCCCC"> nomenclature but</font>

221
00:07:38,110 --> 00:07:41,840
that's it's very<font color="#E5E5E5"> possible you don't have</font>

222
00:07:40,520 --> 00:07:44,270
to carry the<font color="#E5E5E5"> files and bring them over</font>

223
00:07:41,840 --> 00:07:48,950
<font color="#E5E5E5">with you</font><font color="#CCCCCC"> there's some other reasons to</font>

224
00:07:44,270 --> 00:07:51,710
<font color="#CCCCCC">use to use sysinternals as well we want</font>

225
00:07:48,950 --> 00:07:53,960
<font color="#CCCCCC">to avoid being attackers like</font><font color="#E5E5E5"> this</font>

226
00:07:51,710 --> 00:07:55,190
<font color="#E5E5E5">especially</font><font color="#CCCCCC"> if you want to</font><font color="#E5E5E5"> be stealthy if</font>

227
00:07:53,960 --> 00:07:56,390
anyone here has<font color="#E5E5E5"> ever worked in instant</font>

228
00:07:55,190 --> 00:07:58,010
response hopefully some of<font color="#E5E5E5"> these files</font>

229
00:07:56,390 --> 00:08:00,050
will start to look<font color="#E5E5E5"> familiar to you</font><font color="#CCCCCC"> this</font>

230
00:07:58,010 --> 00:08:01,370
<font color="#E5E5E5">is one of my favorite parts about being</font>

231
00:08:00,050 --> 00:08:02,660
<font color="#E5E5E5">an</font><font color="#CCCCCC"> instant responder and doing an</font>

232
00:08:01,370 --> 00:08:04,820
investigation<font color="#CCCCCC"> of attackers</font><font color="#E5E5E5"> and red</font>

233
00:08:02,660 --> 00:08:06,710
<font color="#CCCCCC">team's</font><font color="#E5E5E5"> is all the crap that gets left</font>

234
00:08:04,820 --> 00:08:07,969
behind<font color="#E5E5E5"> that I get to sift through and I</font>

235
00:08:06,710 --> 00:08:09,890
<font color="#E5E5E5">get to make indicators out of them</font>

236
00:08:07,970 --> 00:08:12,410
signatures<font color="#E5E5E5"> out of</font><font color="#CCCCCC"> whatsoever</font><font color="#E5E5E5"> all of your</font>

237
00:08:09,890 --> 00:08:15,050
support files<font color="#E5E5E5"> your random</font><font color="#CCCCCC"> ask named</font>

238
00:08:12,410 --> 00:08:17,120
executables<font color="#E5E5E5"> your DLL that you think your</font>

239
00:08:15,050 --> 00:08:18,740
signature<font color="#E5E5E5"> list</font><font color="#CCCCCC"> whatever you stole from</font>

240
00:08:17,120 --> 00:08:20,750
the latest shadow brokers equation

241
00:08:18,740 --> 00:08:23,210
whatever<font color="#E5E5E5"> some rat you haven't updated</font>

242
00:08:20,750 --> 00:08:25,280
the code from since 2006 but<font color="#E5E5E5"> admittedly</font>

243
00:08:23,210 --> 00:08:26,539
it still works<font color="#CCCCCC"> and then some</font><font color="#E5E5E5"> exploits</font>

244
00:08:25,280 --> 00:08:27,979
<font color="#CCCCCC">that someone dropped in</font><font color="#E5E5E5"> it only worked</font>

245
00:08:26,540 --> 00:08:29,330
in a<font color="#CCCCCC"> blackhat demo session that a</font>

246
00:08:27,980 --> 00:08:32,060
<font color="#CCCCCC">university spend a million dollars</font><font color="#E5E5E5"> to</font>

247
00:08:29,330 --> 00:08:34,250
set up but<font color="#E5E5E5"> hey we'll try it here anyways</font>

248
00:08:32,059 --> 00:08:36,589
don't don't<font color="#E5E5E5"> be this attacker don't leave</font>

249
00:08:34,250 --> 00:08:39,630
all this stuff lying around<font color="#CCCCCC"> please</font>

250
00:08:36,590 --> 00:08:41,340
because we're going<font color="#E5E5E5"> to find it and it</font>

251
00:08:39,630 --> 00:08:42,539
going to lead<font color="#E5E5E5"> us to attribution and the</font>

252
00:08:41,340 --> 00:08:43,830
next thing you know you're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to be</font>

253
00:08:42,539 --> 00:08:45,750
in<font color="#CCCCCC"> the Wall Street Journal on the front</font>

254
00:08:43,830 --> 00:08:47,160
page and<font color="#CCCCCC"> the US Department of Justice is</font>

255
00:08:45,750 --> 00:08:49,350
going<font color="#CCCCCC"> to issue</font><font color="#E5E5E5"> sanctions or they're</font>

256
00:08:47,160 --> 00:08:51,240
going to<font color="#E5E5E5"> indictments against you and</font>

257
00:08:49,350 --> 00:08:53,070
then we're<font color="#E5E5E5"> going to be in a really tough</font>

258
00:08:51,240 --> 00:08:55,500
spot<font color="#CCCCCC"> so don't leave this behind just use</font>

259
00:08:53,070 --> 00:08:57,300
the Microsoft approved<font color="#E5E5E5"> signed coded</font>

260
00:08:55,500 --> 00:09:00,150
software but more importantly Brian why

261
00:08:57,300 --> 00:09:02,969
else<font color="#CCCCCC"> should we use</font><font color="#E5E5E5"> this internals yeah</font>

262
00:09:00,150 --> 00:09:05,819
so<font color="#E5E5E5"> you know you want to look like</font><font color="#CCCCCC"> an</font>

263
00:09:02,970 --> 00:09:07,140
attacker<font color="#E5E5E5"> you want to kind of stand on</font>

264
00:09:05,820 --> 00:09:11,100
everything but<font color="#CCCCCC"> that's not really what</font>

265
00:09:07,140 --> 00:09:13,920
you<font color="#CCCCCC"> should be doing</font><font color="#E5E5E5"> think anyone seen ex</font>

266
00:09:11,100 --> 00:09:17,280
machina<font color="#E5E5E5"> think like that</font><font color="#CCCCCC"> Thanks blending</font>

267
00:09:13,920 --> 00:09:19,560
in looking like<font color="#CCCCCC"> a smug IT admin turning</font>

268
00:09:17,280 --> 00:09:22,500
around<font color="#E5E5E5"> for</font><font color="#CCCCCC"> Perico to blend in like him</font>

269
00:09:19,560 --> 00:09:24,479
instead<font color="#CCCCCC"> of sticking</font><font color="#E5E5E5"> out looking</font><font color="#CCCCCC"> like you</font>

270
00:09:22,500 --> 00:09:26,400
know<font color="#E5E5E5"> with your Guy Fawkes mask on no one</font>

271
00:09:24,480 --> 00:09:28,620
questions<font color="#CCCCCC"> that guy they just talk about</font>

272
00:09:26,400 --> 00:09:30,600
him<font color="#E5E5E5"> behind it back</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> as an</font>

273
00:09:28,620 --> 00:09:32,040
attacker<font color="#CCCCCC"> because</font><font color="#E5E5E5"> no one's detecting you</font>

274
00:09:30,600 --> 00:09:34,020
<font color="#E5E5E5">they're just talking about you but</font>

275
00:09:32,040 --> 00:09:37,680
<font color="#CCCCCC">that's alright this</font><font color="#E5E5E5"> is who we</font><font color="#CCCCCC"> want to be</font>

276
00:09:34,020 --> 00:09:39,390
<font color="#CCCCCC">right let's jump into the first million</font>

277
00:09:37,680 --> 00:09:42,359
<font color="#CCCCCC">yeah</font><font color="#E5E5E5"> what did you pull the</font><font color="#CCCCCC"> skin off of</font>

278
00:09:39,390 --> 00:09:43,080
<font color="#E5E5E5">mark russinovich and like that that that</font>

279
00:09:42,360 --> 00:09:45,180
<font color="#CCCCCC">would be scary</font>

280
00:09:43,080 --> 00:09:46,800
<font color="#CCCCCC">it'd be really scared yeah if Brian</font><font color="#E5E5E5"> and</font>

281
00:09:45,180 --> 00:09:49,319
I don't<font color="#E5E5E5"> surface</font><font color="#CCCCCC"> after giving</font><font color="#E5E5E5"> this talk</font>

282
00:09:46,800 --> 00:09:50,849
you all will know<font color="#E5E5E5"> what happened and why</font>

283
00:09:49,320 --> 00:09:53,190
that went about<font color="#CCCCCC"> all right</font><font color="#E5E5E5"> let's start</font>

284
00:09:50,850 --> 00:09:54,540
talking<font color="#E5E5E5"> about some some attacker stages</font>

285
00:09:53,190 --> 00:09:56,460
of the attack<font color="#E5E5E5"> life so I go on how we can</font>

286
00:09:54,540 --> 00:09:57,930
utilize you things by the way if life's

287
00:09:56,460 --> 00:09:59,970
I<font color="#CCCCCC"> kill didn't mean much</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> thing kill</font>

288
00:09:57,930 --> 00:10:02,550
chain they're the exact<font color="#CCCCCC"> same thing it's</font>

289
00:09:59,970 --> 00:10:04,170
<font color="#CCCCCC">just different branding</font><font color="#E5E5E5"> we're going to</font>

290
00:10:02,550 --> 00:10:06,180
talk<font color="#CCCCCC"> about some tools</font><font color="#E5E5E5"> that fall into the</font>

291
00:10:04,170 --> 00:10:07,860
PS tools category<font color="#CCCCCC"> basically they start</font>

292
00:10:06,180 --> 00:10:09,540
with the characters PS there's a quick

293
00:10:07,860 --> 00:10:11,670
disclaimer<font color="#E5E5E5"> about any of these now red</font>

294
00:10:09,540 --> 00:10:13,349
teamers check this out without<font color="#E5E5E5"> any</font>

295
00:10:11,670 --> 00:10:15,900
options<font color="#E5E5E5"> these tools will by default be</font>

296
00:10:13,350 --> 00:10:18,360
run against your local machine<font color="#E5E5E5"> good for</font>

297
00:10:15,900 --> 00:10:22,370
testing<font color="#CCCCCC"> good for profiling however they</font>

298
00:10:18,360 --> 00:10:24,720
also have<font color="#CCCCCC"> built-in looping and</font>

299
00:10:22,370 --> 00:10:25,980
enumeration tactics as<font color="#CCCCCC"> well you can</font>

300
00:10:24,720 --> 00:10:27,390
throw in a single host<font color="#CCCCCC"> so</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> whack</font>

301
00:10:25,980 --> 00:10:30,290
<font color="#CCCCCC">whack in front of it you can</font><font color="#E5E5E5"> actually</font>

302
00:10:27,390 --> 00:10:32,400
<font color="#E5E5E5">throw a list of hosts both IPs and</font>

303
00:10:30,290 --> 00:10:34,050
NetBIOS names inside of a text file

304
00:10:32,400 --> 00:10:36,000
<font color="#E5E5E5">throw an @ symbol in front</font><font color="#CCCCCC"> of it</font><font color="#E5E5E5"> and it</font>

305
00:10:34,050 --> 00:10:37,770
<font color="#CCCCCC">will automatically go through those who</font>

306
00:10:36,000 --> 00:10:40,050
here has ever put PS<font color="#CCCCCC"> exec inside of a</font>

307
00:10:37,770 --> 00:10:42,569
for<font color="#CCCCCC"> loop that's</font><font color="#E5E5E5"> what we called a waste</font>

308
00:10:40,050 --> 00:10:44,880
<font color="#E5E5E5">of time and duplicate use of CPU</font>

309
00:10:42,570 --> 00:10:46,380
<font color="#CCCCCC">resources or you can just throw</font><font color="#E5E5E5"> it</font>

310
00:10:44,880 --> 00:10:48,870
against<font color="#CCCCCC"> wack wack star and hit the</font>

311
00:10:46,380 --> 00:10:50,910
entire domain<font color="#CCCCCC"> that's right</font><font color="#E5E5E5"> it can</font><font color="#CCCCCC"> a scan</font>

312
00:10:48,870 --> 00:10:52,780
and enumerate a domain<font color="#E5E5E5"> and then perform</font>

313
00:10:50,910 --> 00:10:54,910
an activity<font color="#E5E5E5"> against that domain</font>

314
00:10:52,780 --> 00:10:56,800
so gone<font color="#CCCCCC"> are the days of you having to</font>

315
00:10:54,910 --> 00:10:58,569
<font color="#E5E5E5">pull the DNS cache and see what systems</font>

316
00:10:56,800 --> 00:11:00,370
there are<font color="#E5E5E5"> or working your hardest to</font>

317
00:10:58,570 --> 00:11:03,400
<font color="#E5E5E5">load volume</font><font color="#CCCCCC"> shadow copies just to get</font><font color="#E5E5E5"> to</font>

318
00:11:00,370 --> 00:11:05,710
<font color="#E5E5E5">NTDs it out</font><font color="#CCCCCC"> - then maybe possibly parse</font>

319
00:11:03,400 --> 00:11:07,750
it just let PS<font color="#CCCCCC"> exec you or PS</font><font color="#E5E5E5"> tool do</font>

320
00:11:05,710 --> 00:11:09,880
the<font color="#E5E5E5"> heavy lifting</font><font color="#CCCCCC"> you can also throw in</font>

321
00:11:07,750 --> 00:11:11,410
a - you in<font color="#CCCCCC"> at - P for all the PS tools</font>

322
00:11:09,880 --> 00:11:13,420
except one<font color="#CCCCCC"> and actually</font><font color="#E5E5E5"> change</font><font color="#CCCCCC"> your</font>

323
00:11:11,410 --> 00:11:15,730
identity<font color="#E5E5E5"> as well so you can actually</font>

324
00:11:13,420 --> 00:11:17,140
<font color="#E5E5E5">compromise a</font><font color="#CCCCCC"> low-level account operate</font>

325
00:11:15,730 --> 00:11:18,910
<font color="#CCCCCC">at</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> low level account and issue</font>

326
00:11:17,140 --> 00:11:21,460
elevated credentials that<font color="#E5E5E5"> you've also</font>

327
00:11:18,910 --> 00:11:23,680
<font color="#E5E5E5">stolen for only certain particular</font>

328
00:11:21,460 --> 00:11:25,420
commands<font color="#E5E5E5"> we won't go into all the</font>

329
00:11:23,680 --> 00:11:28,390
forensic implications<font color="#E5E5E5"> but this saves you</font>

330
00:11:25,420 --> 00:11:30,729
creating a lot of artifacts<font color="#E5E5E5"> on side of</font><font color="#CCCCCC"> a</font>

331
00:11:28,390 --> 00:11:32,439
system good<font color="#E5E5E5"> example logging in with a</font>

332
00:11:30,730 --> 00:11:34,210
normal user account generates<font color="#E5E5E5"> one event</font>

333
00:11:32,440 --> 00:11:36,070
log logging in with an<font color="#CCCCCC"> administrative</font>

334
00:11:34,210 --> 00:11:38,650
<font color="#E5E5E5">account can generate up to five event</font>

335
00:11:36,070 --> 00:11:39,820
logs<font color="#CCCCCC"> guess what I can find all those and</font>

336
00:11:38,650 --> 00:11:41,310
I<font color="#E5E5E5"> can start to see what account you're</font>

337
00:11:39,820 --> 00:11:43,930
using in the<font color="#E5E5E5"> privileges that you've got</font>

338
00:11:41,310 --> 00:11:45,609
so<font color="#E5E5E5"> yeah jumping in the internal recon</font>

339
00:11:43,930 --> 00:11:47,979
because that's the<font color="#E5E5E5"> first thing that the</font>

340
00:11:45,610 --> 00:11:51,130
machines will do<font color="#CCCCCC"> whenever</font><font color="#E5E5E5"> they land in a</font>

341
00:11:47,980 --> 00:11:54,700
domain start<font color="#E5E5E5"> looking around so the first</font>

342
00:11:51,130 --> 00:11:58,290
tool<font color="#E5E5E5"> PS</font><font color="#CCCCCC"> Enzo</font><font color="#E5E5E5"> this will</font><font color="#CCCCCC"> pull local or</font>

343
00:11:54,700 --> 00:12:03,610
remote system statistics on the users

344
00:11:58,290 --> 00:12:05,260
<font color="#CCCCCC">noting that are sorry I come to head for</font>

345
00:12:03,610 --> 00:12:06,760
the<font color="#CCCCCC"> other side TSS Oh</font>

346
00:12:05,260 --> 00:12:09,580
so if you're<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> for a specific</font>

347
00:12:06,760 --> 00:12:11,980
target specific specific system<font color="#CCCCCC"> maybe</font>

348
00:12:09,580 --> 00:12:14,470
<font color="#CCCCCC">you want one with a lot of</font><font color="#E5E5E5"> RAM a lot of</font>

349
00:12:11,980 --> 00:12:17,220
resources<font color="#E5E5E5"> maybe you want a server that</font>

350
00:12:14,470 --> 00:12:20,890
that you can do a remote interactive

351
00:12:17,220 --> 00:12:22,750
logon without knocking<font color="#E5E5E5"> a user offline</font><font color="#CCCCCC"> go</font>

352
00:12:20,890 --> 00:12:24,130
ahead and scan<font color="#E5E5E5"> the whole</font><font color="#CCCCCC"> domain</font><font color="#E5E5E5"> this</font>

353
00:12:22,750 --> 00:12:27,640
<font color="#E5E5E5">will give you back all the</font><font color="#CCCCCC"> information</font>

354
00:12:24,130 --> 00:12:30,189
if you add the<font color="#CCCCCC"> - s flag</font><font color="#E5E5E5"> it will scan</font>

355
00:12:27,640 --> 00:12:32,980
those those systems<font color="#E5E5E5"> and then give you a</font>

356
00:12:30,190 --> 00:12:34,810
list of<font color="#E5E5E5"> installed software whenever</font>

357
00:12:32,980 --> 00:12:36,640
we're<font color="#E5E5E5"> doing the research for</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> I look</font>

358
00:12:34,810 --> 00:12:39,459
at<font color="#E5E5E5"> Matt I go that sounds like a reverse</font>

359
00:12:36,640 --> 00:12:41,890
<font color="#CCCCCC">port scan one port scan</font><font color="#E5E5E5"> when you can</font>

360
00:12:39,460 --> 00:12:44,320
<font color="#E5E5E5">tell me all the programs are</font><font color="#CCCCCC"> installed</font>

361
00:12:41,890 --> 00:12:46,569
and probably running<font color="#E5E5E5"> so if you're</font>

362
00:12:44,320 --> 00:12:47,860
enumerated domain what do you and you

363
00:12:46,570 --> 00:12:49,450
look at<font color="#E5E5E5"> hostname list how do you usually</font>

364
00:12:47,860 --> 00:12:50,860
find what servers are doing right<font color="#E5E5E5"> sis</font>

365
00:12:49,450 --> 00:12:52,480
admins are really nice<font color="#CCCCCC"> they usually</font>

366
00:12:50,860 --> 00:12:54,790
throw<font color="#E5E5E5"> DC at the end for domain</font>

367
00:12:52,480 --> 00:12:57,010
controller<font color="#E5E5E5"> web somewhere in there or is</font>

368
00:12:54,790 --> 00:12:58,900
<font color="#E5E5E5">somewhere in there for a server SQL for</font>

369
00:12:57,010 --> 00:13:00,010
a database server<font color="#CCCCCC"> I'd rather just pull</font>

370
00:12:58,900 --> 00:13:01,930
this<font color="#E5E5E5"> because I'm going to</font><font color="#CCCCCC"> find all</font><font color="#E5E5E5"> those</font>

371
00:13:00,010 --> 00:13:05,750
hidden systems all those<font color="#CCCCCC"> internet-facing</font>

372
00:13:01,930 --> 00:13:07,459
<font color="#E5E5E5">ones that aren't labeled internal web 0</font>

373
00:13:05,750 --> 00:13:09,740
zero<font color="#E5E5E5"> - I'm going to find the ones that</font>

374
00:13:07,459 --> 00:13:11,689
<font color="#E5E5E5">are labeled some random letter number</font>

375
00:13:09,740 --> 00:13:13,490
combination but<font color="#E5E5E5"> are actually running is</font>

376
00:13:11,689 --> 00:13:15,019
<font color="#E5E5E5">six and boom I've just found another</font>

377
00:13:13,490 --> 00:13:17,810
exploitable method that I can jump in

378
00:13:15,019 --> 00:13:20,180
via also throw<font color="#CCCCCC"> - - C gives you a nice</font>

379
00:13:17,810 --> 00:13:22,699
little CSV output CSV means we can what

380
00:13:20,180 --> 00:13:24,050
<font color="#CCCCCC">we can script it</font><font color="#E5E5E5"> and then we can bring</font>

381
00:13:22,699 --> 00:13:25,579
<font color="#E5E5E5">it</font><font color="#CCCCCC"> back and we can analyze it we can</font>

382
00:13:24,050 --> 00:13:27,889
<font color="#E5E5E5">actually build our attack as opposed to</font>

383
00:13:25,579 --> 00:13:30,439
just<font color="#E5E5E5"> running on the fly so now here</font><font color="#CCCCCC"> we</font>

384
00:13:27,889 --> 00:13:32,959
<font color="#CCCCCC">go PS logged on see who's logged on to</font>

385
00:13:30,439 --> 00:13:37,009
<font color="#CCCCCC">local</font><font color="#E5E5E5"> or the remote system s equivalent</font>

386
00:13:32,959 --> 00:13:39,560
<font color="#CCCCCC">of like the Linux puh</font><font color="#E5E5E5"> W and so if you're</font>

387
00:13:37,009 --> 00:13:43,730
targeting specific account<font color="#CCCCCC"> I don't know</font>

388
00:13:39,560 --> 00:13:47,089
like John Connor<font color="#E5E5E5"> or NIT n man or some</font>

389
00:13:43,730 --> 00:13:48,379
target this<font color="#E5E5E5"> is Sarah Connor - it</font><font color="#CCCCCC"> Sarah</font>

390
00:13:47,089 --> 00:13:52,430
<font color="#CCCCCC">Khan yeah</font><font color="#E5E5E5"> whatever they're going after</font>

391
00:13:48,379 --> 00:13:53,689
<font color="#E5E5E5">Kyle Reese right that guy - this one is</font>

392
00:13:52,430 --> 00:13:55,609
fairly<font color="#E5E5E5"> straightforward this is a really</font>

393
00:13:53,689 --> 00:13:58,189
easy command anyone<font color="#E5E5E5"> think of why this</font>

394
00:13:55,610 --> 00:14:00,100
may be useful<font color="#E5E5E5"> what do we want to dump</font>

395
00:13:58,189 --> 00:14:02,839
from a system<font color="#E5E5E5"> that we've infiltrated</font>

396
00:14:00,100 --> 00:14:04,250
<font color="#E5E5E5">usually passwords or credentials be nice</font>

397
00:14:02,839 --> 00:14:05,750
<font color="#E5E5E5">to know to see who's actually logging in</font>

398
00:14:04,250 --> 00:14:07,459
to<font color="#E5E5E5"> wait for those so</font><font color="#CCCCCC"> that gives us</font><font color="#E5E5E5"> the</font>

399
00:14:05,750 --> 00:14:09,079
<font color="#CCCCCC">opportunity</font><font color="#E5E5E5"> to actually dump those</font>

400
00:14:07,459 --> 00:14:10,279
credentials<font color="#CCCCCC"> instead of coming back at</font>

401
00:14:09,079 --> 00:14:11,930
random intervals<font color="#CCCCCC"> and I see a lot of</font>

402
00:14:10,279 --> 00:14:14,059
attackers<font color="#E5E5E5"> and attack groups do this as</font>

403
00:14:11,930 --> 00:14:15,680
well<font color="#E5E5E5"> they don't get the</font><font color="#CCCCCC"> credit they want</font>

404
00:14:14,059 --> 00:14:17,719
on the first<font color="#E5E5E5"> a second time very rarely</font>

405
00:14:15,680 --> 00:14:19,160
does a fish lead immediately<font color="#CCCCCC"> to the</font>

406
00:14:17,720 --> 00:14:20,600
domain controller<font color="#E5E5E5"> although I've</font><font color="#CCCCCC"> seen</font>

407
00:14:19,160 --> 00:14:21,889
that<font color="#E5E5E5"> - I've seen email being read on</font><font color="#CCCCCC"> a</font>

408
00:14:20,600 --> 00:14:23,930
domain<font color="#CCCCCC"> controller and</font><font color="#E5E5E5"> it's just lights</font>

409
00:14:21,889 --> 00:14:25,160
<font color="#E5E5E5">out but very</font><font color="#CCCCCC"> rarely</font><font color="#E5E5E5"> - attackers get</font>

410
00:14:23,930 --> 00:14:26,689
right<font color="#E5E5E5"> there so they wait they sit and</font>

411
00:14:25,160 --> 00:14:28,730
<font color="#E5E5E5">wait</font><font color="#CCCCCC"> for someone to log on</font><font color="#E5E5E5"> this little</font>

412
00:14:26,689 --> 00:14:29,930
<font color="#CCCCCC">tool tells you</font><font color="#E5E5E5"> who maybe gives you their</font>

413
00:14:28,730 --> 00:14:31,850
privileges and also tells you if<font color="#CCCCCC"> they're</font>

414
00:14:29,930 --> 00:14:32,508
remote or if<font color="#E5E5E5"> they're local</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> well so as</font>

415
00:14:31,850 --> 00:14:35,059
an attacker

416
00:14:32,509 --> 00:14:36,680
if I see my<font color="#CCCCCC"> domain</font><font color="#E5E5E5"> my domain admin</font>

417
00:14:35,059 --> 00:14:38,089
coming in<font color="#E5E5E5"> remotely well then maybe</font>

418
00:14:36,680 --> 00:14:39,378
they've got a jump box<font color="#E5E5E5"> ongoing pone</font>

419
00:14:38,089 --> 00:14:42,649
maybe they've got something<font color="#E5E5E5"> that sits at</font>

420
00:14:39,379 --> 00:14:45,079
a central point that<font color="#CCCCCC"> I can go after</font><font color="#E5E5E5"> so</font>

421
00:14:42,649 --> 00:14:48,230
now logged on sessions is kind of like

422
00:14:45,079 --> 00:14:50,508
PS<font color="#E5E5E5"> log on just on steroids so this will</font>

423
00:14:48,230 --> 00:14:53,449
give you all<font color="#CCCCCC"> the active sessions on on a</font>

424
00:14:50,509 --> 00:14:56,480
given computer<font color="#E5E5E5"> so starting</font><font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> that</font>

425
00:14:53,449 --> 00:14:57,589
sent<font color="#E5E5E5"> forward each user</font><font color="#CCCCCC"> well if their</font>

426
00:14:56,480 --> 00:14:59,809
administrator they would have two

427
00:14:57,589 --> 00:15:01,370
<font color="#E5E5E5">different sessions</font><font color="#CCCCCC"> one is the under</font>

428
00:14:59,809 --> 00:15:05,589
privileged<font color="#E5E5E5"> and then yet the one is</font>

429
00:15:01,370 --> 00:15:08,509
privileged<font color="#E5E5E5"> so this can help you target</font>

430
00:15:05,589 --> 00:15:10,490
<font color="#E5E5E5">this can help you</font><font color="#CCCCCC"> target an</font>

431
00:15:08,509 --> 00:15:12,410
administrator<font color="#E5E5E5"> it</font><font color="#CCCCCC"> shells running with</font>

432
00:15:10,490 --> 00:15:14,829
<font color="#E5E5E5">administrator privileges if you add the</font>

433
00:15:12,410 --> 00:15:17,300
-<font color="#E5E5E5"> piece which to find out which process</font>

434
00:15:14,829 --> 00:15:18,739
so we actually<font color="#CCCCCC"> yeah we use the - piece</font>

435
00:15:17,300 --> 00:15:19,400
which I don't<font color="#E5E5E5"> know if</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> - top to read</font>

436
00:15:18,740 --> 00:15:21,470
on the slide

437
00:15:19,400 --> 00:15:23,750
what we've highlighted there is a user

438
00:15:21,470 --> 00:15:25,250
that<font color="#E5E5E5"> has both a command line so we've</font>

439
00:15:23,750 --> 00:15:28,670
got CMD<font color="#E5E5E5"> and con host and then they've</font>

440
00:15:25,250 --> 00:15:30,140
got<font color="#E5E5E5"> reg</font><font color="#CCCCCC"> edit what's reddit registry</font>

441
00:15:28,670 --> 00:15:32,360
editor what do you need to<font color="#E5E5E5"> have registry</font>

442
00:15:30,140 --> 00:15:34,430
editor open admin privileges so now we

443
00:15:32,360 --> 00:15:36,200
can<font color="#E5E5E5"> start to identify admin context as</font>

444
00:15:34,430 --> 00:15:37,880
well and see if our account actually<font color="#E5E5E5"> has</font>

445
00:15:36,200 --> 00:15:39,680
it or if they're<font color="#E5E5E5"> having to escalate to a</font>

446
00:15:37,880 --> 00:15:42,050
different account<font color="#CCCCCC"> good example my</font><font color="#E5E5E5"> Corp</font>

447
00:15:39,680 --> 00:15:43,819
laptop<font color="#E5E5E5"> my regular</font><font color="#CCCCCC"> user name and my</font><font color="#E5E5E5"> admin</font>

448
00:15:42,050 --> 00:15:45,800
<font color="#CCCCCC">username are two different</font><font color="#E5E5E5"> user names so</font>

449
00:15:43,820 --> 00:15:47,450
we've got usually<font color="#CCCCCC"> there's an ADM or</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> -</font>

450
00:15:45,800 --> 00:15:49,339
admin thrown<font color="#E5E5E5"> somewhere in there really</font>

451
00:15:47,450 --> 00:15:50,840
<font color="#CCCCCC">good way to identify that is to run a</font>

452
00:15:49,340 --> 00:15:53,510
command<font color="#E5E5E5"> like this and see what sessions</font>

453
00:15:50,840 --> 00:15:56,870
and<font color="#E5E5E5"> prophecies are owning</font><font color="#CCCCCC"> another thing</font>

454
00:15:53,510 --> 00:16:00,470
you may run into<font color="#CCCCCC"> slow</font><font color="#E5E5E5"> Easter</font><font color="#CCCCCC"> Egg</font><font color="#E5E5E5"> is an</font>

455
00:15:56,870 --> 00:16:04,340
is or some other service<font color="#E5E5E5"> is running in</font>

456
00:16:00,470 --> 00:16:07,430
<font color="#E5E5E5">that</font><font color="#CCCCCC"> privilege session</font><font color="#E5E5E5"> game on yep thank</font>

457
00:16:04,340 --> 00:16:08,570
you thank<font color="#E5E5E5"> you web server as</font><font color="#CCCCCC"> root all</font>

458
00:16:07,430 --> 00:16:10,130
<font color="#CCCCCC">right so</font><font color="#E5E5E5"> another tool that we really</font>

459
00:16:08,570 --> 00:16:12,650
like is<font color="#CCCCCC"> ad explore unfortunate we're</font>

460
00:16:10,130 --> 00:16:14,270
getting to<font color="#E5E5E5"> more of a GUI mode now and by</font>

461
00:16:12,650 --> 00:16:15,439
that I mean<font color="#E5E5E5"> you're you're actually</font>

462
00:16:14,270 --> 00:16:16,819
needing to load<font color="#E5E5E5"> something there are</font>

463
00:16:15,440 --> 00:16:18,590
<font color="#E5E5E5">command-line options but they're not as</font>

464
00:16:16,820 --> 00:16:20,660
versatile the first one is<font color="#CCCCCC"> ad explorer</font>

465
00:16:18,590 --> 00:16:22,640
<font color="#E5E5E5">this is one of my favorite tools inside</font>

466
00:16:20,660 --> 00:16:25,040
<font color="#E5E5E5">of sysinternals for the sole reason</font><font color="#CCCCCC"> of I</font>

467
00:16:22,640 --> 00:16:26,930
can snapshot an active directory<font color="#E5E5E5"> save it</font>

468
00:16:25,040 --> 00:16:29,569
to a file and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> open it somewhere</font>

469
00:16:26,930 --> 00:16:31,400
<font color="#E5E5E5">else</font><font color="#CCCCCC"> so I'm spending</font><font color="#E5E5E5"> less</font><font color="#CCCCCC"> time on</font><font color="#E5E5E5"> my</font>

470
00:16:29,570 --> 00:16:32,690
target<font color="#CCCCCC"> in my target environment</font><font color="#E5E5E5"> on my</font>

471
00:16:31,400 --> 00:16:34,220
<font color="#CCCCCC">target</font><font color="#E5E5E5"> computer I can profile that</font>

472
00:16:32,690 --> 00:16:35,390
domain<font color="#E5E5E5"> and</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> out of there I've worked</font>

473
00:16:34,220 --> 00:16:37,340
with<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of attack groups that</font>

474
00:16:35,390 --> 00:16:39,020
<font color="#E5E5E5">actually have a very methodical way of</font>

475
00:16:37,340 --> 00:16:41,000
getting into<font color="#E5E5E5"> an environment hitting the</font>

476
00:16:39,020 --> 00:16:41,900
domain controller dumping statistics Red

477
00:16:41,000 --> 00:16:43,400
Team let me know when this sounds

478
00:16:41,900 --> 00:16:45,350
familiar dumping domain objects

479
00:16:43,400 --> 00:16:47,270
<font color="#E5E5E5">numerating them</font><font color="#CCCCCC"> they're on they're on</font>

480
00:16:45,350 --> 00:16:50,600
<font color="#CCCCCC">this central</font><font color="#E5E5E5"> box for hours doing all</font>

481
00:16:47,270 --> 00:16:51,530
this recon<font color="#E5E5E5"> run one tool save it and then</font>

482
00:16:50,600 --> 00:16:52,310
get off the machine<font color="#CCCCCC"> and</font><font color="#E5E5E5"> go back</font>

483
00:16:51,530 --> 00:16:54,079
somewhere<font color="#E5E5E5"> else</font>

484
00:16:52,310 --> 00:16:55,670
leave your<font color="#CCCCCC"> backdoors in</font><font color="#E5E5E5"> place leave your</font>

485
00:16:54,080 --> 00:16:57,020
persistence mechanisms in<font color="#CCCCCC"> place and then</font>

486
00:16:55,670 --> 00:16:58,910
come back and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> effectively</font>

487
00:16:57,020 --> 00:17:00,199
<font color="#CCCCCC">compromise the environment instead of</font>

488
00:16:58,910 --> 00:17:01,880
sitting around<font color="#E5E5E5"> and hoping this just</font>

489
00:17:00,200 --> 00:17:04,940
admin doesn't<font color="#CCCCCC"> log in and block you off</font>

490
00:17:01,880 --> 00:17:06,950
<font color="#E5E5E5">and catch this one open</font><font color="#CCCCCC"> the second</font><font color="#E5E5E5"> one</font>

491
00:17:04,940 --> 00:17:09,410
is share you<font color="#CCCCCC"> know obviously for</font><font color="#E5E5E5"> sharing</font>

492
00:17:06,950 --> 00:17:10,520
<font color="#CCCCCC">a short for sharing numeration</font><font color="#E5E5E5"> this one</font>

493
00:17:09,410 --> 00:17:12,470
is another one<font color="#CCCCCC"> that allows you</font><font color="#E5E5E5"> to</font>

494
00:17:10,520 --> 00:17:14,690
enumerate file or printer shares access

495
00:17:12,470 --> 00:17:16,250
levels as<font color="#E5E5E5"> well as local paths again if</font>

496
00:17:14,690 --> 00:17:18,530
you're performing<font color="#E5E5E5"> recon environment what</font>

497
00:17:16,250 --> 00:17:20,750
do I have<font color="#E5E5E5"> access to what is what is</font>

498
00:17:18,530 --> 00:17:22,459
mapped what is not mapped or I<font color="#E5E5E5"> don't</font>

499
00:17:20,750 --> 00:17:24,500
understand exactly what this folder is

500
00:17:22,459 --> 00:17:26,480
<font color="#E5E5E5">or what it's telling me you</font><font color="#CCCCCC"> can use this</font>

501
00:17:24,500 --> 00:17:28,280
tool<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> actually also use it</font><font color="#E5E5E5"> to</font>

502
00:17:26,480 --> 00:17:30,710
<font color="#E5E5E5">look at every</font><font color="#CCCCCC"> domain that that</font><font color="#E5E5E5"> system</font>

503
00:17:28,280 --> 00:17:32,090
has<font color="#E5E5E5"> access to or you can focus in on</font>

504
00:17:30,710 --> 00:17:32,900
<font color="#E5E5E5">domains as well so you can use these</font>

505
00:17:32,090 --> 00:17:34,820
<font color="#E5E5E5">tools to zoom</font>

506
00:17:32,900 --> 00:17:37,190
in and out as<font color="#E5E5E5"> you're profiling in</font>

507
00:17:34,820 --> 00:17:39,260
environment another good recon

508
00:17:37,190 --> 00:17:41,570
application from the network side<font color="#E5E5E5"> gtp</font>

509
00:17:39,260 --> 00:17:43,850
view nice easy GUI<font color="#CCCCCC"> tells you every</font>

510
00:17:41,570 --> 00:17:47,600
process that's running<font color="#E5E5E5"> all the</font>

511
00:17:43,850 --> 00:17:49,399
connections<font color="#CCCCCC"> making to it with the GUI</font>

512
00:17:47,600 --> 00:17:51,770
<font color="#CCCCCC">you're</font><font color="#E5E5E5"> able</font><font color="#CCCCCC"> to close connections and</font>

513
00:17:49,400 --> 00:17:55,280
terminate processes again from<font color="#CCCCCC"> within</font>

514
00:17:51,770 --> 00:17:58,250
<font color="#CCCCCC">that GUI I</font><font color="#E5E5E5"> wouldn't be able to tell</font>

515
00:17:55,280 --> 00:18:00,470
<font color="#E5E5E5">friend forensically was something</font>

516
00:17:58,250 --> 00:18:03,590
terminated when was a connection closed

517
00:18:00,470 --> 00:18:05,150
<font color="#E5E5E5">it's just fair game the other sorry this</font>

518
00:18:03,590 --> 00:18:08,209
<font color="#E5E5E5">screenshots a little tough to read but</font>

519
00:18:05,150 --> 00:18:10,040
it is a list of executables<font color="#CCCCCC"> and then tcp</font>

520
00:18:08,210 --> 00:18:11,540
<font color="#CCCCCC">vs UDP what they're connecting to</font>

521
00:18:10,040 --> 00:18:13,490
<font color="#E5E5E5">whether it's open</font><font color="#CCCCCC"> the status of the</font>

522
00:18:11,540 --> 00:18:15,379
connection<font color="#CCCCCC"> its next at that channel</font><font color="#E5E5E5"> on</font>

523
00:18:13,490 --> 00:18:17,420
steroids and<font color="#E5E5E5"> in a nice little GUI as</font>

524
00:18:15,380 --> 00:18:19,450
well<font color="#CCCCCC"> the</font><font color="#E5E5E5"> other part I like</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> this</font>

525
00:18:17,420 --> 00:18:21,560
from attack points<font color="#E5E5E5"> of views though is</font>

526
00:18:19,450 --> 00:18:23,600
let's say you've got<font color="#E5E5E5"> a box that you've</font>

527
00:18:21,560 --> 00:18:25,159
been compromising for days who here

528
00:18:23,600 --> 00:18:26,689
keeps track of<font color="#E5E5E5"> the exact number of</font>

529
00:18:25,160 --> 00:18:29,510
meterpreter sessions they've got open

530
00:18:26,690 --> 00:18:31,220
<font color="#E5E5E5">you know to a tee all the time run a</font>

531
00:18:29,510 --> 00:18:32,870
tool like this<font color="#CCCCCC"> really quickly ok how</font>

532
00:18:31,220 --> 00:18:33,350
many<font color="#E5E5E5"> shells did</font><font color="#CCCCCC"> I actually</font><font color="#E5E5E5"> pop on this</font>

533
00:18:32,870 --> 00:18:35,060
<font color="#E5E5E5">box</font>

534
00:18:33,350 --> 00:18:36,320
how many ways<font color="#E5E5E5"> that I get in use this as</font>

535
00:18:35,060 --> 00:18:37,790
a nice little<font color="#E5E5E5"> cleanup method we don't</font>

536
00:18:36,320 --> 00:18:39,980
mention<font color="#E5E5E5"> anti forensics but I like it</font>

537
00:18:37,790 --> 00:18:41,510
from<font color="#E5E5E5"> that aspect</font><font color="#CCCCCC"> to I've been in some</font>

538
00:18:39,980 --> 00:18:42,650
<font color="#E5E5E5">cases I'm sure Brian seeing the same</font>

539
00:18:41,510 --> 00:18:44,720
where we've seen active attacker

540
00:18:42,650 --> 00:18:45,140
connections<font color="#E5E5E5"> from like six seven months</font>

541
00:18:44,720 --> 00:18:47,330
ago

542
00:18:45,140 --> 00:18:48,920
but<font color="#E5E5E5"> not being used they were initial</font>

543
00:18:47,330 --> 00:18:50,510
shell pops<font color="#E5E5E5"> but they're still there</font>

544
00:18:48,920 --> 00:18:52,550
<font color="#CCCCCC">they're still</font><font color="#E5E5E5"> running don't be a sloppy</font>

545
00:18:50,510 --> 00:18:55,070
attacker Skynet would close all<font color="#CCCCCC"> of its</font>

546
00:18:52,550 --> 00:18:57,020
ports of it good so the same<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> is</font>

547
00:18:55,070 --> 00:18:59,210
<font color="#E5E5E5">TCP view just from the command</font><font color="#CCCCCC"> line if</font>

548
00:18:57,020 --> 00:19:03,050
you don't<font color="#E5E5E5"> I use in</font><font color="#CCCCCC"> a Chansey GUI</font><font color="#E5E5E5"> again</font>

549
00:18:59,210 --> 00:19:08,000
CSV output<font color="#E5E5E5"> that you can script that</font>

550
00:19:03,050 --> 00:19:10,250
parse it another<font color="#CCCCCC"> screenshot</font><font color="#E5E5E5"> a little</font>

551
00:19:08,000 --> 00:19:12,020
tough to<font color="#E5E5E5"> read on this one</font><font color="#CCCCCC"> but yeah</font><font color="#E5E5E5"> a</font>

552
00:19:10,250 --> 00:19:13,880
couple options<font color="#E5E5E5"> network connections</font>

553
00:19:12,020 --> 00:19:15,230
listening ports<font color="#E5E5E5"> the same thing as TCP</font>

554
00:19:13,880 --> 00:19:17,180
view but with a little<font color="#CCCCCC"> more detail into</font>

555
00:19:15,230 --> 00:19:19,550
<font color="#CCCCCC">it the one I like about</font><font color="#E5E5E5"> this is it</font>

556
00:19:17,180 --> 00:19:22,160
actually<font color="#E5E5E5"> also resolves remote</font><font color="#CCCCCC"> host</font><font color="#E5E5E5"> for</font>

557
00:19:19,550 --> 00:19:23,720
you you can skip that<font color="#CCCCCC"> if you'd like but</font>

558
00:19:22,160 --> 00:19:26,240
it's just another way to profile more of

559
00:19:23,720 --> 00:19:27,590
your<font color="#CCCCCC"> environment</font><font color="#E5E5E5"> yeah yeah so another</font>

560
00:19:26,240 --> 00:19:31,930
thing I can't believe I'm saying this

561
00:19:27,590 --> 00:19:34,189
<font color="#CCCCCC">but one of the processes Dropbox dot exe</font>

562
00:19:31,930 --> 00:19:35,620
<font color="#CCCCCC">ok so they're running Dropbox in the</font>

563
00:19:34,190 --> 00:19:40,790
environment<font color="#E5E5E5"> how am I going to exfil</font>

564
00:19:35,620 --> 00:19:43,040
right<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> not nice</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> differentiate</font>

565
00:19:40,790 --> 00:19:45,399
what was the malicious<font color="#CCCCCC"> X Vil</font><font color="#E5E5E5"> versus him</font>

566
00:19:43,040 --> 00:19:47,928
just thinking his entire Dropbox folder

567
00:19:45,399 --> 00:19:50,239
also I like<font color="#CCCCCC"> to</font><font color="#E5E5E5"> use Dropbox and things</font>

568
00:19:47,929 --> 00:19:51,799
like Google<font color="#E5E5E5"> Drive</font><font color="#CCCCCC"> as a really good</font>

569
00:19:50,240 --> 00:19:53,840
<font color="#E5E5E5">example</font><font color="#CCCCCC"> of determining whether</font><font color="#E5E5E5"> or not</font>

570
00:19:51,799 --> 00:19:55,820
cloud servers are accessible from<font color="#E5E5E5"> the</font>

571
00:19:53,840 --> 00:19:57,470
<font color="#E5E5E5">environment</font><font color="#CCCCCC"> Dropbox</font><font color="#E5E5E5"> may be running</font>

572
00:19:55,820 --> 00:19:59,240
that's great maybe it's a corporate app

573
00:19:57,470 --> 00:20:00,799
maybe it's being used by the employees

574
00:19:59,240 --> 00:20:02,690
maybe it's being used legitimately<font color="#E5E5E5"> it</font>

575
00:20:00,799 --> 00:20:04,908
also tells me<font color="#CCCCCC"> that AWS is most likely</font>

576
00:20:02,690 --> 00:20:06,230
accessible as<font color="#E5E5E5"> well so it lets me profile</font>

577
00:20:04,909 --> 00:20:08,960
and see what's what's going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be open</font>

578
00:20:06,230 --> 00:20:10,250
<font color="#CCCCCC">all right</font><font color="#E5E5E5"> we probe on environment</font><font color="#CCCCCC"> using</font>

579
00:20:08,960 --> 00:20:11,720
<font color="#CCCCCC">systems Arnold</font><font color="#E5E5E5"> so we now know a lot</font>

580
00:20:10,250 --> 00:20:13,250
about<font color="#E5E5E5"> a domain and we really didn't need</font>

581
00:20:11,720 --> 00:20:14,799
much we didn't have to drop<font color="#E5E5E5"> any custom</font>

582
00:20:13,250 --> 00:20:16,909
things in everything just ran perfectly

583
00:20:14,799 --> 00:20:18,590
<font color="#CCCCCC">let's talk a little</font><font color="#E5E5E5"> bit</font><font color="#CCCCCC"> about executing</font>

584
00:20:16,909 --> 00:20:20,000
some additional malware so well<font color="#E5E5E5"> first</font>

585
00:20:18,590 --> 00:20:22,039
we're going<font color="#E5E5E5"> to look out</font><font color="#CCCCCC"> as TS exec who</font>

586
00:20:20,000 --> 00:20:23,860
here has heard of PS exec<font color="#CCCCCC"> whenever one</font>

587
00:20:22,039 --> 00:20:27,649
there we go there's all the hands that

588
00:20:23,860 --> 00:20:29,600
<font color="#E5E5E5">we wanted to see earlier so like one</font><font color="#CCCCCC"> Red</font>

589
00:20:27,649 --> 00:20:30,889
<font color="#CCCCCC">Team guy for blue teamers but like 30</font>

590
00:20:29,600 --> 00:20:32,389
<font color="#E5E5E5">people have heard of he</font><font color="#CCCCCC"> is exact all</font>

591
00:20:30,889 --> 00:20:34,010
<font color="#CCCCCC">right</font><font color="#E5E5E5"> I like this I will have to tell</font>

592
00:20:32,389 --> 00:20:34,969
<font color="#E5E5E5">mark that</font><font color="#CCCCCC"> he's got a lot of fans in</font><font color="#E5E5E5"> the</font>

593
00:20:34,010 --> 00:20:37,460
crowd

594
00:20:34,970 --> 00:20:39,340
<font color="#CCCCCC">PS exact is kind</font><font color="#E5E5E5"> of when people think of</font>

595
00:20:37,460 --> 00:20:42,080
sysinternals they think of this<font color="#E5E5E5"> tool and</font>

596
00:20:39,340 --> 00:20:44,658
PS tools actually<font color="#CCCCCC"> get labeled as PS</font>

597
00:20:42,080 --> 00:20:46,879
except as well it's used for<font color="#E5E5E5"> remote code</font>

598
00:20:44,659 --> 00:20:48,260
execution<font color="#CCCCCC"> it's used in software</font>

599
00:20:46,880 --> 00:20:49,669
deployment<font color="#E5E5E5"> mechanisms viewed by sis</font>

600
00:20:48,260 --> 00:20:51,649
admins legitimately all over the world

601
00:20:49,669 --> 00:20:53,960
<font color="#E5E5E5">it's also</font><font color="#CCCCCC"> used</font><font color="#E5E5E5"> by attackers</font><font color="#CCCCCC"> all over the</font>

602
00:20:51,649 --> 00:20:55,939
world as<font color="#CCCCCC"> well you can</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> it to run a</font>

603
00:20:53,960 --> 00:20:58,340
system command you can push a custom

604
00:20:55,940 --> 00:21:00,049
<font color="#CCCCCC">binary you can change permissions again</font>

605
00:20:58,340 --> 00:21:02,000
we talked earlier<font color="#E5E5E5"> about the - you - P</font>

606
00:21:00,049 --> 00:21:04,100
you can<font color="#CCCCCC"> run it</font><font color="#E5E5E5"> again</font><font color="#CCCCCC"> a host you can</font><font color="#E5E5E5"> run</font>

607
00:21:02,000 --> 00:21:05,330
it against a domain but red teamers you

608
00:21:04,100 --> 00:21:07,309
need to know<font color="#E5E5E5"> that when you run this you</font>

609
00:21:05,330 --> 00:21:09,080
<font color="#E5E5E5">create a very specific uniquely</font>

610
00:21:07,309 --> 00:21:12,350
identifiable forensic artifact<font color="#E5E5E5"> which is</font>

611
00:21:09,080 --> 00:21:14,480
PS<font color="#CCCCCC"> exe SVC</font><font color="#E5E5E5"> you can't just run a command</font>

612
00:21:12,350 --> 00:21:17,689
on<font color="#E5E5E5"> a remote host</font><font color="#CCCCCC"> PS exec actually drops</font>

613
00:21:14,480 --> 00:21:19,940
<font color="#CCCCCC">this</font><font color="#E5E5E5"> little executable on the target</font>

614
00:21:17,690 --> 00:21:20,929
system<font color="#E5E5E5"> that executable handles whatever</font>

615
00:21:19,940 --> 00:21:22,370
it is you're trying<font color="#E5E5E5"> to do and then it</font>

616
00:21:20,929 --> 00:21:24,200
gets deleted it gets<font color="#E5E5E5"> removed immediately</font>

617
00:21:22,370 --> 00:21:26,719
<font color="#CCCCCC">we're going to talk</font><font color="#E5E5E5"> about what artifact</font>

618
00:21:24,200 --> 00:21:28,399
is<font color="#E5E5E5"> left behind</font><font color="#CCCCCC"> a little</font><font color="#E5E5E5"> later the - s</font>

619
00:21:26,720 --> 00:21:30,529
flag<font color="#CCCCCC"> in PS exec is what you use to push</font>

620
00:21:28,399 --> 00:21:32,629
a custom binary<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can use</font><font color="#E5E5E5"> H to run</font>

621
00:21:30,529 --> 00:21:34,039
with elevated tokens of the<font color="#E5E5E5"> prot of the</font>

622
00:21:32,630 --> 00:21:35,929
user account<font color="#E5E5E5"> that you're running</font><font color="#CCCCCC"> with</font>

623
00:21:34,039 --> 00:21:37,580
anyone know what<font color="#CCCCCC"> the -</font><font color="#E5E5E5"> our switch does</font>

624
00:21:35,929 --> 00:21:39,649
aside<font color="#E5E5E5"> from just reading the slide it</font>

625
00:21:37,580 --> 00:21:40,879
lets you change<font color="#CCCCCC"> the service name that it</font>

626
00:21:39,649 --> 00:21:42,049
gets<font color="#E5E5E5"> installed with I'll show you from a</font>

627
00:21:40,880 --> 00:21:42,260
forensic some of you what that looks

628
00:21:42,049 --> 00:21:43,760
like

629
00:21:42,260 --> 00:21:45,710
as we go a little<font color="#E5E5E5"> bit later</font><font color="#CCCCCC"> on but this</font>

630
00:21:43,760 --> 00:21:48,019
<font color="#E5E5E5">is a good anti forensic method</font><font color="#CCCCCC"> to hide</font>

631
00:21:45,710 --> 00:21:50,029
<font color="#E5E5E5">yourself and then - W lets you set the</font>

632
00:21:48,019 --> 00:21:51,950
<font color="#E5E5E5">working directory</font><font color="#CCCCCC"> on the remote host</font>

633
00:21:50,029 --> 00:21:54,440
<font color="#CCCCCC">change the directory that</font><font color="#E5E5E5"> I drop files</font>

634
00:21:51,950 --> 00:21:58,279
into by default PS exact drops<font color="#E5E5E5"> into</font>

635
00:21:54,440 --> 00:21:58,980
<font color="#E5E5E5">Windows or your system</font><font color="#CCCCCC"> root we want to</font>

636
00:21:58,279 --> 00:22:00,630
maybe chain

637
00:21:58,980 --> 00:22:02,429
<font color="#E5E5E5">to a temp directory</font><font color="#CCCCCC"> maybe something</font>

638
00:22:00,630 --> 00:22:04,380
that's not monitored<font color="#E5E5E5"> maybe you know</font><font color="#CCCCCC"> that</font>

639
00:22:02,429 --> 00:22:06,150
they've got<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> 9 in the environment and</font>

640
00:22:04,380 --> 00:22:07,620
<font color="#E5E5E5">you know that</font><font color="#CCCCCC"> Program Files is</font><font color="#E5E5E5"> white</font>

641
00:22:06,150 --> 00:22:08,970
<font color="#E5E5E5">listed that's what that's where I'm</font>

642
00:22:07,620 --> 00:22:10,139
<font color="#CCCCCC">starting to</font><font color="#E5E5E5"> drop all of my stuff because</font>

643
00:22:08,970 --> 00:22:12,780
the application<font color="#E5E5E5"> is not going to be</font>

644
00:22:10,140 --> 00:22:15,240
<font color="#E5E5E5">looking there</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so now we're going</font>

645
00:22:12,780 --> 00:22:17,250
to jump<font color="#E5E5E5"> into background info this is one</font>

646
00:22:15,240 --> 00:22:20,640
of<font color="#E5E5E5"> the best sysinternals you guys have</font>

647
00:22:17,250 --> 00:22:25,320
<font color="#E5E5E5">probably never heard</font><font color="#CCCCCC"> of okay</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> BG info</font>

648
00:22:20,640 --> 00:22:27,419
is just<font color="#CCCCCC"> will tool that's used</font><font color="#E5E5E5"> to you you</font>

649
00:22:25,320 --> 00:22:29,850
<font color="#E5E5E5">run this and then on your back</font>

650
00:22:27,419 --> 00:22:32,280
on<font color="#CCCCCC"> your desktop</font><font color="#E5E5E5"> has little basic</font>

651
00:22:29,850 --> 00:22:36,360
information<font color="#E5E5E5"> like your host name how</font><font color="#CCCCCC"> many</font>

652
00:22:32,280 --> 00:22:38,190
views<font color="#CCCCCC"> you have RAM hard-disk who's who's</font>

653
00:22:36,360 --> 00:22:40,590
run into<font color="#E5E5E5"> this annoying</font><font color="#CCCCCC"> text before</font><font color="#E5E5E5"> on</font>

654
00:22:38,190 --> 00:22:42,030
servers since admins love this one

655
00:22:40,590 --> 00:22:43,889
<font color="#CCCCCC">they'd love to have</font><font color="#E5E5E5"> that little text box</font>

656
00:22:42,030 --> 00:22:47,160
<font color="#E5E5E5">in the upper right hand corner that</font>

657
00:22:43,890 --> 00:22:49,350
lists<font color="#E5E5E5"> all these stats so if you want to</font>

658
00:22:47,160 --> 00:22:51,809
<font color="#CCCCCC">go just beyond</font><font color="#E5E5E5"> what they give you in the</font>

659
00:22:49,350 --> 00:22:53,909
box as far as<font color="#E5E5E5"> listening information</font>

660
00:22:51,809 --> 00:22:55,678
about your system<font color="#CCCCCC"> and give you</font><font color="#E5E5E5"> the</font>

661
00:22:53,910 --> 00:22:57,059
ability<font color="#E5E5E5"> it's kind of small you guys</font>

662
00:22:55,679 --> 00:23:01,740
might<font color="#E5E5E5"> not be able to see that for walk</font>

663
00:22:57,059 --> 00:23:04,020
through it the ability<font color="#CCCCCC"> to run</font><font color="#E5E5E5"> WMI or DB</font>

664
00:23:01,740 --> 00:23:05,790
scripts<font color="#E5E5E5"> so let's back up inside</font><font color="#CCCCCC"> of the</font>

665
00:23:04,020 --> 00:23:09,210
GUI so to the right side<font color="#E5E5E5"> of the screen</font>

666
00:23:05,790 --> 00:23:12,059
<font color="#E5E5E5">sorry left side of the screen</font><font color="#CCCCCC"> there's an</font>

667
00:23:09,210 --> 00:23:14,010
option to<font color="#CCCCCC"> customize fields that</font><font color="#E5E5E5"> you drop</font>

668
00:23:12,059 --> 00:23:16,590
in inside<font color="#E5E5E5"> of this fields</font><font color="#CCCCCC"> has a custom</font>

669
00:23:14,010 --> 00:23:17,910
button<font color="#E5E5E5"> custom leads to new new leads to</font>

670
00:23:16,590 --> 00:23:19,530
this little<font color="#E5E5E5"> text box on the side here</font>

671
00:23:17,910 --> 00:23:21,179
<font color="#E5E5E5">slides will be available afterwards but</font>

672
00:23:19,530 --> 00:23:23,280
trust me when I tell<font color="#E5E5E5"> you the bottom</font>

673
00:23:21,179 --> 00:23:26,190
portions of the<font color="#E5E5E5"> text box there lets you</font>

674
00:23:23,280 --> 00:23:28,910
<font color="#E5E5E5">drop in a</font><font color="#CCCCCC"> WMI query if you want you</font><font color="#E5E5E5"> can</font>

675
00:23:26,190 --> 00:23:31,830
drop in a VBS script<font color="#E5E5E5"> if you want</font>

676
00:23:28,910 --> 00:23:33,690
<font color="#E5E5E5">registry keys let's see environment</font>

677
00:23:31,830 --> 00:23:35,850
<font color="#CCCCCC">variables all things that malware</font>

678
00:23:33,690 --> 00:23:37,919
<font color="#E5E5E5">authors love to use and in fact this was</font>

679
00:23:35,850 --> 00:23:39,120
<font color="#CCCCCC">actually recently</font><font color="#E5E5E5"> discussed for white</font>

680
00:23:37,919 --> 00:23:41,130
for application whitelisting

681
00:23:39,120 --> 00:23:45,389
<font color="#E5E5E5">yeah so just let that sink in this is a</font>

682
00:23:41,130 --> 00:23:50,370
signed<font color="#CCCCCC"> microsoft executable</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> allows</font>

683
00:23:45,390 --> 00:23:52,410
execution of<font color="#CCCCCC"> vb scripts so you can</font>

684
00:23:50,370 --> 00:23:54,389
bypass application whitelisting if

685
00:23:52,410 --> 00:23:57,059
you're<font color="#E5E5E5"> trusting any Microsoft signed</font>

686
00:23:54,390 --> 00:24:00,440
executable this just<font color="#E5E5E5"> released the other</font>

687
00:23:57,059 --> 00:24:03,240
day and has been patched with the latest

688
00:24:00,440 --> 00:24:05,460
<font color="#CCCCCC">leave it you've got</font><font color="#E5E5E5"> use version or for a</font>

689
00:24:03,240 --> 00:24:07,440
<font color="#CCCCCC">to one</font><font color="#E5E5E5"> or lower but everyone's always</font>

690
00:24:05,460 --> 00:24:09,210
got<font color="#CCCCCC"> this internal</font><font color="#E5E5E5"> lying around so I'm</font>

691
00:24:07,440 --> 00:24:10,900
sure you<font color="#E5E5E5"> can find a they might not</font><font color="#CCCCCC"> send</font>

692
00:24:09,210 --> 00:24:13,450
another one<font color="#E5E5E5"> of those</font>

693
00:24:10,900 --> 00:24:14,620
we'll see<font color="#E5E5E5"> but yeah we kind of really</font>

694
00:24:13,450 --> 00:24:16,300
<font color="#E5E5E5">like this we just happened to stumble</font>

695
00:24:14,620 --> 00:24:17,560
this article is two days old<font color="#CCCCCC"> so we</font>

696
00:24:16,300 --> 00:24:19,419
happen to<font color="#E5E5E5"> stumble in this and like oh we</font>

697
00:24:17,560 --> 00:24:21,129
need to<font color="#CCCCCC"> add this in real quick we are</font>

698
00:24:19,420 --> 00:24:22,450
<font color="#E5E5E5">aware of the</font><font color="#CCCCCC"> vbscript thing but to see</font>

699
00:24:21,130 --> 00:24:23,980
it actually<font color="#CCCCCC"> exported in the wild is</font>

700
00:24:22,450 --> 00:24:26,320
awesome there are folks just<font color="#E5E5E5"> pop</font><font color="#CCCCCC"> in</font>

701
00:24:23,980 --> 00:24:27,550
remote<font color="#CCCCCC"> gels all</font><font color="#E5E5E5"> over the place</font><font color="#CCCCCC"> it's a</font>

702
00:24:26,320 --> 00:24:29,550
really really<font color="#CCCCCC"> straightforward mechanism</font>

703
00:24:27,550 --> 00:24:32,409
<font color="#CCCCCC">and like I said it gets the proof</font><font color="#E5E5E5"> and</font>

704
00:24:29,550 --> 00:24:34,120
<font color="#CCCCCC">Microsoft loves it I</font><font color="#E5E5E5"> will talk a little</font>

705
00:24:32,410 --> 00:24:35,500
bit<font color="#CCCCCC"> about persistence</font><font color="#E5E5E5"> to tools we're</font>

706
00:24:34,120 --> 00:24:37,090
going to focus<font color="#E5E5E5"> on here the first is PS</font>

707
00:24:35,500 --> 00:24:39,400
password this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> actually a really</font>

708
00:24:37,090 --> 00:24:40,629
<font color="#E5E5E5">simple password changing tool the reason</font>

709
00:24:39,400 --> 00:24:43,000
I like it is<font color="#E5E5E5"> because you can target</font>

710
00:24:40,630 --> 00:24:44,680
specific hosts with it<font color="#CCCCCC"> so I</font><font color="#E5E5E5"> don't have</font>

711
00:24:43,000 --> 00:24:45,940
to<font color="#E5E5E5"> necessarily go into</font><font color="#CCCCCC"> the domain</font>

712
00:24:44,680 --> 00:24:47,650
controller<font color="#E5E5E5"> and change on my account</font>

713
00:24:45,940 --> 00:24:49,480
settings there<font color="#CCCCCC"> I can</font><font color="#E5E5E5"> just change local</font>

714
00:24:47,650 --> 00:24:50,980
admin in a couple places<font color="#CCCCCC"> who here has a</font>

715
00:24:49,480 --> 00:24:53,110
shared local admin account across your

716
00:24:50,980 --> 00:24:55,720
entire<font color="#CCCCCC"> environment</font><font color="#E5E5E5"> shared credentials I</font>

717
00:24:53,110 --> 00:24:56,919
mean<font color="#E5E5E5"> I can't get</font><font color="#CCCCCC"> a hand up I'm waiting</font>

718
00:24:55,720 --> 00:24:58,510
for<font color="#CCCCCC"> targets they'll pop up eventually</font>

719
00:24:56,920 --> 00:25:01,690
<font color="#E5E5E5">trust me they're out there we go there's</font>

720
00:24:58,510 --> 00:25:03,430
one don't pop up<font color="#E5E5E5"> trust me this is a good</font>

721
00:25:01,690 --> 00:25:04,660
<font color="#E5E5E5">way to compromise an account or create</font>

722
00:25:03,430 --> 00:25:06,340
your<font color="#E5E5E5"> own account we see a lot of</font>

723
00:25:04,660 --> 00:25:07,900
attackers do this one<font color="#E5E5E5"> especially an RDP</font>

724
00:25:06,340 --> 00:25:09,159
attacks they'll create their<font color="#CCCCCC"> own account</font>

725
00:25:07,900 --> 00:25:11,440
that they can fly<font color="#CCCCCC"> under the radar</font><font color="#E5E5E5"> with</font>

726
00:25:09,160 --> 00:25:13,420
all the time<font color="#E5E5E5"> use this one to distribute</font>

727
00:25:11,440 --> 00:25:14,130
credentials to only<font color="#E5E5E5"> a targeted group of</font>

728
00:25:13,420 --> 00:25:18,190
<font color="#E5E5E5">servers</font>

729
00:25:14,130 --> 00:25:19,840
the other one is move file so not so

730
00:25:18,190 --> 00:25:21,580
<font color="#E5E5E5">much anymore but what used to be the</font>

731
00:25:19,840 --> 00:25:23,020
<font color="#E5E5E5">most irritating feature about Windows</font>

732
00:25:21,580 --> 00:25:24,580
<font color="#CCCCCC">I'm going to answer the question because</font>

733
00:25:23,020 --> 00:25:27,100
<font color="#E5E5E5">we'd be here</font><font color="#CCCCCC"> all day talking</font><font color="#E5E5E5"> about that</font>

734
00:25:24,580 --> 00:25:29,350
one<font color="#E5E5E5"> but it used to be your system needs</font>

735
00:25:27,100 --> 00:25:31,030
<font color="#CCCCCC">to reboot in order to complete steps bla</font>

736
00:25:29,350 --> 00:25:33,010
bla bla bla bla bla<font color="#E5E5E5"> bla what's actually</font>

737
00:25:31,030 --> 00:25:35,440
happening is<font color="#E5E5E5"> windows can't overwrite</font>

738
00:25:33,010 --> 00:25:36,520
files that are<font color="#E5E5E5"> currently in use</font><font color="#CCCCCC"> doesn't</font>

739
00:25:35,440 --> 00:25:37,780
<font color="#CCCCCC">have</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> ability to do that</font><font color="#E5E5E5"> that's</font>

740
00:25:36,520 --> 00:25:39,040
actually<font color="#E5E5E5"> true for</font><font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> operating</font>

741
00:25:37,780 --> 00:25:41,080
systems but<font color="#E5E5E5"> Windows is kind of</font>

742
00:25:39,040 --> 00:25:42,580
<font color="#CCCCCC">in-your-face about it so they need to</font>

743
00:25:41,080 --> 00:25:44,889
<font color="#E5E5E5">schedule an update there's actually a</font>

744
00:25:42,580 --> 00:25:46,449
queue<font color="#CCCCCC"> of pending</font><font color="#E5E5E5"> file operations this</font><font color="#CCCCCC"> is</font>

745
00:25:44,890 --> 00:25:48,670
what Windows is it's called a pending

746
00:25:46,450 --> 00:25:50,140
file operation<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> builds it's this</font>

747
00:25:48,670 --> 00:25:51,940
list of basically<font color="#E5E5E5"> the next time you</font>

748
00:25:50,140 --> 00:25:53,890
reboot<font color="#E5E5E5"> what needs to read what needs to</font>

749
00:25:51,940 --> 00:25:55,510
<font color="#E5E5E5">happen</font><font color="#CCCCCC"> I need to delete</font><font color="#E5E5E5"> this I need to</font>

750
00:25:53,890 --> 00:25:56,890
<font color="#E5E5E5">move this basically I need to apply</font><font color="#CCCCCC"> a</font>

751
00:25:55,510 --> 00:25:58,210
service pack or I need<font color="#E5E5E5"> to apply</font><font color="#CCCCCC"> an</font>

752
00:25:56,890 --> 00:26:01,330
application update or<font color="#CCCCCC"> something of that</font>

753
00:25:58,210 --> 00:26:02,740
nature<font color="#E5E5E5"> well move file lets you take</font>

754
00:26:01,330 --> 00:26:04,780
<font color="#CCCCCC">advantage of</font><font color="#E5E5E5"> that pending operations</font>

755
00:26:02,740 --> 00:26:06,460
list<font color="#E5E5E5"> now from a sysadmin point of view</font>

756
00:26:04,780 --> 00:26:09,460
you could label it as I'm going<font color="#CCCCCC"> to use</font>

757
00:26:06,460 --> 00:26:10,930
move file<font color="#E5E5E5"> to maybe change a utility I</font>

758
00:26:09,460 --> 00:26:13,720
was using<font color="#E5E5E5"> or move it</font><font color="#CCCCCC"> to a</font><font color="#E5E5E5"> certain place</font>

759
00:26:10,930 --> 00:26:16,150
as an attacker<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can say you know what</font>

760
00:26:13,720 --> 00:26:18,160
<font color="#E5E5E5">on reboot</font><font color="#CCCCCC"> move my malware to somewhere</font>

761
00:26:16,150 --> 00:26:19,570
safe somewhere where I know it's<font color="#CCCCCC"> going</font>

762
00:26:18,160 --> 00:26:22,060
<font color="#E5E5E5">to</font><font color="#CCCCCC"> be somewhere that's white listed</font>

763
00:26:19,570 --> 00:26:23,620
somewhere<font color="#E5E5E5"> that AV skips so I can run it</font>

764
00:26:22,060 --> 00:26:24,490
<font color="#E5E5E5">on the system but if I ever jump into a</font>

765
00:26:23,620 --> 00:26:26,020
reboot

766
00:26:24,490 --> 00:26:27,820
move it to where I know<font color="#E5E5E5"> we're going to</font>

767
00:26:26,020 --> 00:26:30,010
<font color="#E5E5E5">talk about this in anti forensics as</font>

768
00:26:27,820 --> 00:26:33,070
well but I like move file because<font color="#CCCCCC"> it</font>

769
00:26:30,010 --> 00:26:34,300
lets me<font color="#E5E5E5"> hide things upon reboot</font><font color="#CCCCCC"> from a</font>

770
00:26:33,070 --> 00:26:35,740
forensic point of view there's a lot of

771
00:26:34,300 --> 00:26:37,570
reasons you'd force a reboot<font color="#E5E5E5"> some</font>

772
00:26:35,740 --> 00:26:39,309
important artifacts get written<font color="#E5E5E5"> at a</font>

773
00:26:37,570 --> 00:26:41,379
reboot time<font color="#E5E5E5"> as a malware author I can</font>

774
00:26:39,309 --> 00:26:44,020
now hide at reboot time as well

775
00:26:41,380 --> 00:26:45,910
and speaking of anti forensics<font color="#E5E5E5"> we'll</font>

776
00:26:44,020 --> 00:26:48,520
just jump<font color="#E5E5E5"> right</font><font color="#CCCCCC"> into how do you hide</font>

777
00:26:45,910 --> 00:26:50,380
from people<font color="#E5E5E5"> like Brian and myself</font><font color="#CCCCCC"> so</font>

778
00:26:48,520 --> 00:26:52,360
since we're using<font color="#E5E5E5"> this internals you</font>

779
00:26:50,380 --> 00:26:54,340
bring with you as<font color="#E5E5E5"> tallit anyone use s</font>

780
00:26:52,360 --> 00:26:56,939
lead for heard of s<font color="#E5E5E5"> please before there</font>

781
00:26:54,340 --> 00:26:59,379
we go<font color="#E5E5E5"> okay they're slowly waking up</font>

782
00:26:56,940 --> 00:27:01,870
nice<font color="#E5E5E5"> little file that you can zero out</font>

783
00:26:59,380 --> 00:27:04,809
see and I'll file<font color="#CCCCCC"> that you want</font><font color="#E5E5E5"> to get</font>

784
00:27:01,870 --> 00:27:06,520
rid of it<font color="#CCCCCC"> we'll also</font><font color="#E5E5E5"> clear free space</font><font color="#CCCCCC"> so</font>

785
00:27:04,809 --> 00:27:09,070
if you deleted<font color="#CCCCCC"> something and go oh no I</font>

786
00:27:06,520 --> 00:27:11,110
<font color="#CCCCCC">forgot to s delete that you got if</font><font color="#E5E5E5"> you</font>

787
00:27:09,070 --> 00:27:16,120
got<font color="#E5E5E5"> the time you can also zero free</font>

788
00:27:11,110 --> 00:27:19,270
space and it<font color="#E5E5E5"> also overrides the the</font><font color="#CCCCCC"> pre</font>

789
00:27:16,120 --> 00:27:21,340
<font color="#CCCCCC">record in</font><font color="#E5E5E5"> Manatee so so that so without</font>

790
00:27:19,270 --> 00:27:23,379
<font color="#CCCCCC">yeah without</font><font color="#E5E5E5"> getting too much into</font><font color="#CCCCCC"> an</font>

791
00:27:21,340 --> 00:27:24,879
MFT discussion which would really put

792
00:27:23,380 --> 00:27:27,640
everybody to sleep<font color="#E5E5E5"> no matter how many</font>

793
00:27:24,880 --> 00:27:28,990
hurricanes<font color="#E5E5E5"> we</font><font color="#CCCCCC"> outsource anyone here</font>

794
00:27:27,640 --> 00:27:29,940
think when you delete a file<font color="#E5E5E5"> that's it</font>

795
00:27:28,990 --> 00:27:32,260
gone forever

796
00:27:29,940 --> 00:27:34,500
<font color="#CCCCCC">okay good awesome</font><font color="#E5E5E5"> everyone has been</font>

797
00:27:32,260 --> 00:27:36,610
<font color="#E5E5E5">paying attention some way shape or form</font>

798
00:27:34,500 --> 00:27:39,309
<font color="#CCCCCC">I'm not sure if that was</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> talk</font><font color="#E5E5E5"> next</font>

799
00:27:36,610 --> 00:27:41,189
door or needs a<font color="#E5E5E5"> street but any event</font>

800
00:27:39,309 --> 00:27:43,540
yeah<font color="#E5E5E5"> so s</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> actually actually</font>

801
00:27:41,190 --> 00:27:45,990
<font color="#E5E5E5">deletes a file for you it doesn't just</font>

802
00:27:43,540 --> 00:27:48,790
mark that<font color="#E5E5E5"> space available for writing</font>

803
00:27:45,990 --> 00:27:51,580
got in and then also one<font color="#CCCCCC"> of the patterns</font>

804
00:27:48,790 --> 00:27:54,550
you<font color="#CCCCCC"> can see from</font><font color="#E5E5E5"> it so in order to</font>

805
00:27:51,580 --> 00:27:58,330
obscure the file name it renames it with

806
00:27:54,550 --> 00:28:02,020
<font color="#CCCCCC">layers</font><font color="#E5E5E5"> of the</font><font color="#CCCCCC"> alphabet</font><font color="#E5E5E5"> all 26 it's a 26</font>

807
00:27:58,330 --> 00:28:03,370
passes<font color="#CCCCCC"> ABC keeps</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> till</font><font color="#E5E5E5"> Z so from a</font>

808
00:28:02,020 --> 00:28:05,290
forensic point of view when<font color="#CCCCCC"> we find</font>

809
00:28:03,370 --> 00:28:08,379
<font color="#CCCCCC">artifact like</font><font color="#E5E5E5"> this we find folders full</font>

810
00:28:05,290 --> 00:28:10,450
of<font color="#E5E5E5"> zzzzzz</font><font color="#CCCCCC"> and it's just these</font><font color="#E5E5E5"> ease all</font>

811
00:28:08,380 --> 00:28:12,400
<font color="#E5E5E5">over the place sometimes</font><font color="#CCCCCC"> that's delete</font>

812
00:28:10,450 --> 00:28:15,640
<font color="#CCCCCC">stop short and</font><font color="#E5E5E5"> we'll find J's or H</font>

813
00:28:12,400 --> 00:28:17,950
azure-eyes sometimes essays or<font color="#CCCCCC"> T's just</font>

814
00:28:15,640 --> 00:28:20,320
depends but<font color="#CCCCCC"> usually</font><font color="#E5E5E5"> that's a very good</font>

815
00:28:17,950 --> 00:28:21,790
sign of something that<font color="#E5E5E5"> we're looking</font><font color="#CCCCCC"> for</font>

816
00:28:20,320 --> 00:28:23,649
I think the<font color="#CCCCCC"> screenshot</font><font color="#E5E5E5"> may be a little</font>

817
00:28:21,790 --> 00:28:25,629
hard<font color="#E5E5E5"> to read for everyone but this is</font>

818
00:28:23,650 --> 00:28:26,740
actually what s elite looks like we're

819
00:28:25,630 --> 00:28:28,210
going to carry this example<font color="#E5E5E5"> going</font>

820
00:28:26,740 --> 00:28:29,650
<font color="#E5E5E5">through just imagine there's a text file</font>

821
00:28:28,210 --> 00:28:31,540
<font color="#CCCCCC">with</font><font color="#E5E5E5"> social security</font><font color="#CCCCCC"> numbers inside of</font>

822
00:28:29,650 --> 00:28:33,010
it and escalate it actually goes through

823
00:28:31,540 --> 00:28:36,129
<font color="#E5E5E5">and then we get evidence of the file</font>

824
00:28:33,010 --> 00:28:37,900
being deleted<font color="#E5E5E5"> and then move file as well</font>

825
00:28:36,130 --> 00:28:39,850
<font color="#E5E5E5">we also talked about this both</font>

826
00:28:37,900 --> 00:28:41,020
persistence mechanism obviously I'm sure

827
00:28:39,850 --> 00:28:42,790
everyone<font color="#E5E5E5"> could see how it's an anti</font>

828
00:28:41,020 --> 00:28:44,770
<font color="#E5E5E5">forensic movement method as well move</font>

829
00:28:42,790 --> 00:28:45,129
your files move your<font color="#E5E5E5"> exfil move your</font>

830
00:28:44,770 --> 00:28:46,900
shells

831
00:28:45,130 --> 00:28:49,150
move your executables move whatever<font color="#E5E5E5"> app</font>

832
00:28:46,900 --> 00:28:50,800
on system reboot<font color="#E5E5E5"> another good way to</font>

833
00:28:49,150 --> 00:28:53,290
<font color="#E5E5E5">keep yourself hidden</font><font color="#CCCCCC"> and to hide things</font>

834
00:28:50,800 --> 00:28:55,030
from attackers<font color="#E5E5E5"> remember that you're</font>

835
00:28:53,290 --> 00:28:56,740
utilizing the native<font color="#E5E5E5"> windows functions</font>

836
00:28:55,030 --> 00:28:58,149
to move and<font color="#CCCCCC"> delete these files</font><font color="#E5E5E5"> as well</font>

837
00:28:56,740 --> 00:29:00,100
it's going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get wrapped up with all</font>

838
00:28:58,150 --> 00:29:01,180
the other<font color="#E5E5E5"> changes that are happening</font><font color="#CCCCCC"> so</font>

839
00:29:00,100 --> 00:29:03,219
<font color="#E5E5E5">even if someone like Brian or myself</font>

840
00:29:01,180 --> 00:29:04,690
<font color="#E5E5E5">want to do some advanced</font><font color="#CCCCCC"> MFT analytics</font>

841
00:29:03,220 --> 00:29:05,830
and take a look and see if<font color="#E5E5E5"> the record</font>

842
00:29:04,690 --> 00:29:08,410
<font color="#CCCCCC">numbers lined up or they're something</font>

843
00:29:05,830 --> 00:29:11,590
<font color="#CCCCCC">out of</font><font color="#E5E5E5"> place</font><font color="#CCCCCC"> were</font><font color="#E5E5E5"> wrapped into 10,000</font>

844
00:29:08,410 --> 00:29:13,930
other<font color="#E5E5E5"> changes going</font><font color="#CCCCCC"> on at a time</font><font color="#E5E5E5"> so it's</font>

845
00:29:11,590 --> 00:29:15,580
tough to<font color="#CCCCCC"> go</font><font color="#E5E5E5"> back and backtrack if you're</font>

846
00:29:13,930 --> 00:29:17,080
using a method like<font color="#E5E5E5"> that as opposed to</font>

847
00:29:15,580 --> 00:29:24,699
if you were to just delete<font color="#CCCCCC"> it during an</font>

848
00:29:17,080 --> 00:29:28,600
active session<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> you could well</font>

849
00:29:24,700 --> 00:29:30,820
actually no it would depend<font color="#E5E5E5"> it would</font>

850
00:29:28,600 --> 00:29:32,709
<font color="#E5E5E5">depend</font><font color="#CCCCCC"> on when the pending file</font>

851
00:29:30,820 --> 00:29:34,149
<font color="#CCCCCC">operations are taking place</font><font color="#E5E5E5"> if the</font>

852
00:29:32,710 --> 00:29:36,250
network stack has been initialized<font color="#E5E5E5"> or</font>

853
00:29:34,150 --> 00:29:38,890
<font color="#E5E5E5">not so it would depend on on that one</font>

854
00:29:36,250 --> 00:29:40,360
<font color="#E5E5E5">good</font><font color="#CCCCCC"> question just in case anyone didn't</font>

855
00:29:38,890 --> 00:29:43,900
hear the question<font color="#E5E5E5"> was we can also get</font>

856
00:29:40,360 --> 00:29:48,280
<font color="#E5E5E5">you sold answer</font><font color="#CCCCCC"> matt has</font><font color="#E5E5E5"> the book</font><font color="#CCCCCC"> 7</font>

857
00:29:43,900 --> 00:29:49,680
traffic but highlighted in tag<font color="#E5E5E5"> it looks</font>

858
00:29:48,280 --> 00:29:51,790
like it<font color="#CCCCCC"> looks like a</font><font color="#E5E5E5"> Dodgers textbook</font>

859
00:29:49,680 --> 00:29:52,810
<font color="#E5E5E5">but no good</font><font color="#CCCCCC"> questions just</font><font color="#E5E5E5"> for anyone</font>

860
00:29:51,790 --> 00:29:54,100
who didn't<font color="#E5E5E5"> hear the question was could</font>

861
00:29:52,810 --> 00:29:55,810
you schedule<font color="#E5E5E5"> this to do network</font>

862
00:29:54,100 --> 00:29:57,969
operations or move files<font color="#E5E5E5"> across a</font>

863
00:29:55,810 --> 00:29:59,710
<font color="#E5E5E5">network to another machine and I don't</font>

864
00:29:57,970 --> 00:30:01,480
<font color="#E5E5E5">believe so because I don't think it</font>

865
00:29:59,710 --> 00:30:04,420
takes place when the network stack is

866
00:30:01,480 --> 00:30:05,920
activated but<font color="#CCCCCC"> you might be able</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> we'll</font>

867
00:30:04,420 --> 00:30:07,120
test<font color="#E5E5E5"> that that's that's a good question</font>

868
00:30:05,920 --> 00:30:09,070
there<font color="#E5E5E5"> we go put that now</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> we got to</font>

869
00:30:07,120 --> 00:30:10,719
figure that<font color="#E5E5E5"> one</font><font color="#CCCCCC"> out alright</font><font color="#E5E5E5"> so we've</font>

870
00:30:09,070 --> 00:30:12,760
gone<font color="#CCCCCC"> through a few</font><font color="#E5E5E5"> different steps of</font>

871
00:30:10,720 --> 00:30:15,160
<font color="#E5E5E5">the</font><font color="#CCCCCC"> of kind of the kill chain or the the</font>

872
00:30:12,760 --> 00:30:16,870
attack process<font color="#CCCCCC"> we've got a really</font><font color="#E5E5E5"> good</font>

873
00:30:15,160 --> 00:30:18,190
<font color="#CCCCCC">example of kind of sysinternals in the</font>

874
00:30:16,870 --> 00:30:20,260
wild here told you I'd get<font color="#CCCCCC"> you</font><font color="#E5E5E5"> a good</font>

875
00:30:18,190 --> 00:30:21,310
terminator screenshots<font color="#E5E5E5"> it's lots of</font>

876
00:30:20,260 --> 00:30:23,830
minor this one's<font color="#CCCCCC"> missing an arm</font>

877
00:30:21,310 --> 00:30:26,379
unfortunately but that's<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so</font>

878
00:30:23,830 --> 00:30:27,760
citizen turtles in the wild<font color="#E5E5E5"> I used to</font>

879
00:30:26,380 --> 00:30:29,290
work<font color="#CCCCCC"> for a company</font><font color="#E5E5E5"> that has a name for</font>

880
00:30:27,760 --> 00:30:30,670
<font color="#E5E5E5">this group</font><font color="#CCCCCC"> but I can't</font><font color="#E5E5E5"> use that name</font>

881
00:30:29,290 --> 00:30:33,070
anymore<font color="#E5E5E5"> so now I'm just going</font><font color="#CCCCCC"> to call</font>

882
00:30:30,670 --> 00:30:34,990
them credit card<font color="#E5E5E5"> effect attackers</font>

883
00:30:33,070 --> 00:30:38,050
there's a financially motivated<font color="#CCCCCC"> Bret</font>

884
00:30:34,990 --> 00:30:39,430
group they use the raw POS malware<font color="#CCCCCC"> you</font>

885
00:30:38,050 --> 00:30:41,050
may have seen an article<font color="#CCCCCC"> about this</font>

886
00:30:39,430 --> 00:30:44,620
<font color="#E5E5E5">piece of malware has been in the</font>

887
00:30:41,050 --> 00:30:46,750
environment<font color="#E5E5E5"> since 2008 and I kid you not</font>

888
00:30:44,620 --> 00:30:48,070
<font color="#CCCCCC">there's an active</font><font color="#E5E5E5"> case I'm working where</font>

889
00:30:46,750 --> 00:30:50,470
it<font color="#E5E5E5"> was deployed yes sir</font>

890
00:30:48,070 --> 00:30:52,710
so yes<font color="#CCCCCC"> nine-year-old</font><font color="#E5E5E5"> malware</font><font color="#CCCCCC"> still being</font>

891
00:30:50,470 --> 00:30:55,950
used<font color="#E5E5E5"> they use a version of PS exec from</font>

892
00:30:52,710 --> 00:30:57,970
2006<font color="#E5E5E5"> I get to that in just a second I</font>

893
00:30:55,950 --> 00:30:59,620
apologize that<font color="#E5E5E5"> this is one it's hard to</font>

894
00:30:57,970 --> 00:31:01,240
read for<font color="#CCCCCC"> anyone kind of</font><font color="#E5E5E5"> further back in</font>

895
00:30:59,620 --> 00:31:03,729
the<font color="#E5E5E5"> room but this is actually</font><font color="#CCCCCC"> a series</font>

896
00:31:01,240 --> 00:31:06,130
of event logs<font color="#E5E5E5"> of what PS exec looks like</font>

897
00:31:03,730 --> 00:31:09,040
on a remote system generates an event

898
00:31:06,130 --> 00:31:10,810
log an event<font color="#E5E5E5"> 70</font><font color="#CCCCCC"> 45</font><font color="#E5E5E5"> side of the system</font>

899
00:31:09,040 --> 00:31:13,360
log says the service<font color="#E5E5E5"> was installed and</font>

900
00:31:10,810 --> 00:31:15,610
it drops<font color="#CCCCCC"> PS</font><font color="#E5E5E5"> exe SVC or</font><font color="#CCCCCC"> at least it's</font>

901
00:31:13,360 --> 00:31:18,459
<font color="#CCCCCC">supposed to this group drops</font><font color="#E5E5E5"> a</font>

902
00:31:15,610 --> 00:31:20,169
executable called frame package<font color="#CCCCCC"> FR AME</font>

903
00:31:18,460 --> 00:31:23,860
<font color="#CCCCCC">PKG anyone know what the legitimate</font>

904
00:31:20,170 --> 00:31:25,080
frame packages anyone have McAfee in

905
00:31:23,860 --> 00:31:28,270
their environment

906
00:31:25,080 --> 00:31:28,689
<font color="#CCCCCC">well not a single Mac you know owe you</font>

907
00:31:28,270 --> 00:31:31,930
<font color="#E5E5E5">one</font>

908
00:31:28,690 --> 00:31:35,530
<font color="#CCCCCC">Oh used to okay</font><font color="#E5E5E5"> bring package them with</font>

909
00:31:31,930 --> 00:31:37,510
that<font color="#CCCCCC"> so okay fair enough hopefully for</font>

910
00:31:35,530 --> 00:31:39,280
the better<font color="#E5E5E5"> sir</font>

911
00:31:37,510 --> 00:31:41,410
frame package is a Mac the update file

912
00:31:39,280 --> 00:31:43,990
so it actually<font color="#E5E5E5"> is meant to look like a</font>

913
00:31:41,410 --> 00:31:46,030
legitimate<font color="#E5E5E5"> file and when they go in the</font>

914
00:31:43,990 --> 00:31:48,010
<font color="#E5E5E5">service gets registered as PS exec but</font>

915
00:31:46,030 --> 00:31:49,510
they drop frame package on the system we

916
00:31:48,010 --> 00:31:51,850
actually<font color="#CCCCCC"> give a talk about these guys in</font>

917
00:31:49,510 --> 00:31:53,560
October<font color="#E5E5E5"> and after that talk</font>

918
00:31:51,850 --> 00:31:57,730
then they started renaming their files

919
00:31:53,560 --> 00:32:00,610
to VXX hjq service<font color="#E5E5E5"> but they still drop</font>

920
00:31:57,730 --> 00:32:02,890
the frame packaged Exe now<font color="#CCCCCC"> I left</font><font color="#E5E5E5"> from</font>

921
00:32:00,610 --> 00:32:04,270
2006<font color="#E5E5E5"> highlighter</font><font color="#CCCCCC"> on here anyone know any</font>

922
00:32:02,890 --> 00:32:06,150
history<font color="#CCCCCC"> of sysinternals as to why this</font>

923
00:32:04,270 --> 00:32:10,870
is<font color="#CCCCCC"> actually happening</font>

924
00:32:06,150 --> 00:32:12,880
what's that 2006 is when<font color="#CCCCCC"> Microsoft</font>

925
00:32:10,870 --> 00:32:14,649
bought mark russinovich<font color="#E5E5E5"> is company and</font>

926
00:32:12,880 --> 00:32:16,360
acquires his internal it's the last year

927
00:32:14,650 --> 00:32:18,250
that sysinternals was open source<font color="#E5E5E5"> and</font>

928
00:32:16,360 --> 00:32:19,719
<font color="#CCCCCC">you could actually</font><font color="#E5E5E5"> get the code</font><font color="#CCCCCC"> and</font>

929
00:32:18,250 --> 00:32:21,880
modify<font color="#CCCCCC"> it to</font><font color="#E5E5E5"> do what you wanted to do</font>

930
00:32:19,720 --> 00:32:24,310
<font color="#E5E5E5">this group is using</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> 11 year old</font>

931
00:32:21,880 --> 00:32:25,960
<font color="#CCCCCC">version of PS exec</font><font color="#E5E5E5"> and they're modifying</font>

932
00:32:24,310 --> 00:32:28,270
the names of<font color="#E5E5E5"> both the services that get</font>

933
00:32:25,960 --> 00:32:29,890
installed<font color="#E5E5E5"> and the target executables in</font>

934
00:32:28,270 --> 00:32:31,960
order to stay hidden

935
00:32:29,890 --> 00:32:33,790
however they're the only<font color="#E5E5E5"> group that does</font>

936
00:32:31,960 --> 00:32:35,050
this<font color="#E5E5E5"> and I hope they watch this because</font>

937
00:32:33,790 --> 00:32:37,720
<font color="#CCCCCC">every</font><font color="#E5E5E5"> time I talk about them they change</font>

938
00:32:35,050 --> 00:32:39,730
<font color="#E5E5E5">their</font><font color="#CCCCCC"> tactics in some way it's the</font>

939
00:32:37,720 --> 00:32:41,290
easiest indicator to check<font color="#CCCCCC"> you need one</font>

940
00:32:39,730 --> 00:32:42,550
event log in one entry<font color="#E5E5E5"> and after our</font>

941
00:32:41,290 --> 00:32:43,990
talk in October they started clearing

942
00:32:42,550 --> 00:32:46,510
event logs<font color="#E5E5E5"> after every stage of the</font>

943
00:32:43,990 --> 00:32:47,920
attack but long story short<font color="#E5E5E5"> a good</font>

944
00:32:46,510 --> 00:32:50,230
example<font color="#E5E5E5"> of a group that is still</font>

945
00:32:47,920 --> 00:32:51,310
actively using<font color="#E5E5E5"> TS exec and how they're</font>

946
00:32:50,230 --> 00:32:53,260
using it<font color="#E5E5E5"> this is what they used to</font>

947
00:32:51,310 --> 00:32:55,330
<font color="#E5E5E5">deploy their malware</font><font color="#CCCCCC"> they've got a</font>

948
00:32:53,260 --> 00:32:56,920
really<font color="#E5E5E5"> solid sound approach it's been</font>

949
00:32:55,330 --> 00:32:59,409
working<font color="#CCCCCC"> like I said for upwards of</font><font color="#E5E5E5"> nine</font>

950
00:32:56,920 --> 00:33:01,090
years<font color="#CCCCCC"> and we talked</font><font color="#E5E5E5"> about getting credit</font>

951
00:32:59,410 --> 00:33:02,980
<font color="#E5E5E5">cards replaced these guys are probably</font>

952
00:33:01,090 --> 00:33:05,080
<font color="#E5E5E5">the reason for at least one of those</font>

953
00:33:02,980 --> 00:33:06,700
replacements<font color="#CCCCCC"> alright so we've talked</font>

954
00:33:05,080 --> 00:33:07,960
about<font color="#E5E5E5"> it in the</font><font color="#CCCCCC"> wild now Brian and I</font>

955
00:33:06,700 --> 00:33:10,150
really get<font color="#CCCCCC"> to talk</font><font color="#E5E5E5"> about</font><font color="#CCCCCC"> the stuff we</font>

956
00:33:07,960 --> 00:33:12,280
<font color="#CCCCCC">love which is detecting sysinternals and</font>

957
00:33:10,150 --> 00:33:14,380
<font color="#CCCCCC">pretty badass terminator photo as well</font>

958
00:33:12,280 --> 00:33:16,720
<font color="#E5E5E5">so you're going to use</font><font color="#CCCCCC"> this internal</font>

959
00:33:14,380 --> 00:33:19,480
choose the catch you have to accept the

960
00:33:16,720 --> 00:33:22,510
EULA<font color="#E5E5E5"> every tool</font><font color="#CCCCCC"> you run for</font><font color="#E5E5E5"> the first</font>

961
00:33:19,480 --> 00:33:25,480
time you need<font color="#CCCCCC"> to accept it either in the</font>

962
00:33:22,510 --> 00:33:27,280
contiguous<font color="#E5E5E5"> I clicking accept or via</font>

963
00:33:25,480 --> 00:33:31,180
<font color="#E5E5E5">command line</font><font color="#CCCCCC"> bypassing the except you</font>

964
00:33:27,280 --> 00:33:34,060
look like<font color="#E5E5E5"> the every execution</font><font color="#CCCCCC"> they're on</font>

965
00:33:31,180 --> 00:33:35,560
it checks in this registry location to

966
00:33:34,060 --> 00:33:38,470
see if it's already<font color="#CCCCCC"> being</font><font color="#E5E5E5"> accepted and</font>

967
00:33:35,560 --> 00:33:40,899
if it has it doesn't<font color="#E5E5E5"> cross you</font><font color="#CCCCCC"> again so</font>

968
00:33:38,470 --> 00:33:43,570
from this we<font color="#CCCCCC"> can get</font><font color="#E5E5E5"> a timestamp</font><font color="#CCCCCC"> of the</font>

969
00:33:40,900 --> 00:33:45,880
very first<font color="#CCCCCC"> execution of that so it's</font>

970
00:33:43,570 --> 00:33:47,919
internals tool<font color="#E5E5E5"> this is really good</font><font color="#CCCCCC"> in</font>

971
00:33:45,880 --> 00:33:49,330
forensic investigations whenever they

972
00:33:47,920 --> 00:33:51,310
want<font color="#CCCCCC"> to know the entire scope of</font>

973
00:33:49,330 --> 00:33:53,740
exposure<font color="#E5E5E5"> instead of getting the last</font>

974
00:33:51,310 --> 00:33:56,649
execute time<font color="#E5E5E5"> we actually get the first</font><font color="#CCCCCC"> I</font>

975
00:33:53,740 --> 00:33:58,570
<font color="#E5E5E5">ones very important red teamers delete</font>

976
00:33:56,650 --> 00:34:00,700
<font color="#E5E5E5">your keys on the way out the door and</font>

977
00:33:58,570 --> 00:34:04,300
all of a sudden<font color="#CCCCCC"> that</font><font color="#E5E5E5"> artifact goes away</font>

978
00:34:00,700 --> 00:34:05,800
<font color="#E5E5E5">but</font><font color="#CCCCCC"> the leading registry keys can easily</font>

979
00:34:04,300 --> 00:34:08,290
be recovered<font color="#E5E5E5"> so unless you're wiping</font>

980
00:34:05,800 --> 00:34:10,150
registry<font color="#CCCCCC"> keys still</font><font color="#E5E5E5"> going to find that</font>

981
00:34:08,290 --> 00:34:11,710
so delete your<font color="#E5E5E5"> keys and hope that you</font>

982
00:34:10,150 --> 00:34:13,660
get<font color="#E5E5E5"> a</font><font color="#CCCCCC"> really crappy</font><font color="#E5E5E5"> incident responder</font>

983
00:34:11,710 --> 00:34:16,270
and you'll be good to go<font color="#E5E5E5"> the other thing</font>

984
00:34:13,659 --> 00:34:18,489
about<font color="#E5E5E5"> the EULA was</font><font color="#CCCCCC"> I read it this</font>

985
00:34:16,270 --> 00:34:21,250
morning<font color="#E5E5E5"> it's actually two languages it's</font>

986
00:34:18,489 --> 00:34:23,529
<font color="#E5E5E5">in English and French</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> Tecna is</font>

987
00:34:21,250 --> 00:34:26,830
<font color="#E5E5E5">is serving this out of Quebec Canada</font>

988
00:34:23,530 --> 00:34:30,640
<font color="#CCCCCC">that they provide those</font><font color="#E5E5E5"> two languages</font>

989
00:34:26,830 --> 00:34:32,409
<font color="#CCCCCC">and again</font><font color="#E5E5E5"> so I'm not a lawyer don't</font>

990
00:34:30,639 --> 00:34:34,389
think this<font color="#E5E5E5"> is a lawyer advice but it</font>

991
00:34:32,409 --> 00:34:36,310
doesn't<font color="#E5E5E5"> seem like there's anything in</font>

992
00:34:34,389 --> 00:34:39,150
there it's<font color="#CCCCCC"> just a standard license of</font>

993
00:34:36,310 --> 00:34:41,679
<font color="#E5E5E5">don't redistribute this sell this</font>

994
00:34:39,150 --> 00:34:44,080
reverse it stuff like<font color="#E5E5E5"> that doesn't say</font>

995
00:34:41,679 --> 00:34:45,220
<font color="#CCCCCC">anything about</font><font color="#E5E5E5"> misuse and hacking and</font>

996
00:34:44,080 --> 00:34:47,380
stuff like that and it<font color="#CCCCCC"> definitely</font>

997
00:34:45,219 --> 00:34:50,319
doesn't say anything<font color="#CCCCCC"> if you're</font><font color="#E5E5E5"> not human</font>

998
00:34:47,380 --> 00:34:53,650
in a terminator machine that you can't

999
00:34:50,320 --> 00:34:55,030
use<font color="#CCCCCC"> it there's</font><font color="#E5E5E5"> nothing in there so</font><font color="#CCCCCC"> they</font>

1000
00:34:53,650 --> 00:34:56,320
<font color="#CCCCCC">can accept</font><font color="#E5E5E5"> that you look I would</font><font color="#CCCCCC"> just</font>

1001
00:34:55,030 --> 00:34:58,300
like to put<font color="#E5E5E5"> on the record</font><font color="#CCCCCC"> that we're in</font>

1002
00:34:56,320 --> 00:35:00,250
New Orleans and Brian woke up<font color="#E5E5E5"> ready</font><font color="#CCCCCC"> eula</font>

1003
00:34:58,300 --> 00:35:06,970
this morning just<font color="#E5E5E5"> going to leave</font><font color="#CCCCCC"> that</font>

1004
00:35:00,250 --> 00:35:09,400
there yes so another cool artifact is

1005
00:35:06,970 --> 00:35:11,049
<font color="#E5E5E5">the</font><font color="#CCCCCC"> RDP</font><font color="#E5E5E5"> fit map</font><font color="#CCCCCC"> cache this is actually</font>

1006
00:35:09,400 --> 00:35:13,540
not a sysinternals tool<font color="#CCCCCC"> nor</font><font color="#E5E5E5"> is it</font>

1007
00:35:11,050 --> 00:35:14,589
necessarily a sysinternals artifact but

1008
00:35:13,540 --> 00:35:16,210
really<font color="#E5E5E5"> cool Brian's got a store</font>

1009
00:35:14,589 --> 00:35:18,339
about how<font color="#CCCCCC"> sysinternals</font><font color="#E5E5E5"> actually helped</font>

1010
00:35:16,210 --> 00:35:20,079
<font color="#E5E5E5">with this investigation</font><font color="#CCCCCC"> so if you do</font>

1011
00:35:18,339 --> 00:35:23,140
want to get a glimpse<font color="#E5E5E5"> into that GUI of</font>

1012
00:35:20,079 --> 00:35:26,529
<font color="#CCCCCC">what they're</font><font color="#E5E5E5"> doing and they're using</font>

1013
00:35:23,140 --> 00:35:28,989
terminal services to remote from a

1014
00:35:26,529 --> 00:35:31,569
source machine<font color="#E5E5E5"> to a destination machine</font>

1015
00:35:28,989 --> 00:35:33,849
you will<font color="#CCCCCC"> see in that RDP session some</font>

1016
00:35:31,569 --> 00:35:38,469
<font color="#CCCCCC">cache bitmap pause</font><font color="#E5E5E5"> these can be parsed</font>

1017
00:35:33,849 --> 00:35:41,670
<font color="#E5E5E5">and you can kind of reconstruct an image</font>

1018
00:35:38,469 --> 00:35:43,839
of what the attacker was seeing and

1019
00:35:41,670 --> 00:35:46,299
something<font color="#E5E5E5"> really cool that happen to one</font>

1020
00:35:43,839 --> 00:35:48,369
<font color="#E5E5E5">of our investigators not only have they</font>

1021
00:35:46,299 --> 00:35:51,099
reconstructed<font color="#CCCCCC"> this and said oh they're</font>

1022
00:35:48,369 --> 00:35:53,890
using<font color="#E5E5E5"> process Explorer or they're using</font>

1023
00:35:51,099 --> 00:35:55,960
<font color="#E5E5E5">ad Explorer and I can see that</font><font color="#CCCCCC"> a you</font>

1024
00:35:53,890 --> 00:35:57,700
know here's some values<font color="#CCCCCC"> that got back</font>

1025
00:35:55,960 --> 00:36:02,049
and we can kind of tell<font color="#E5E5E5"> what they're</font>

1026
00:35:57,700 --> 00:36:05,529
doing but there was<font color="#E5E5E5"> BG info running on</font>

1027
00:36:02,049 --> 00:36:07,839
the system<font color="#CCCCCC"> they remoted</font><font color="#E5E5E5"> into so whenever</font>

1028
00:36:05,529 --> 00:36:09,700
reconstructing this<font color="#E5E5E5"> RDP bitmap - you</font>

1029
00:36:07,839 --> 00:36:11,529
want to say<font color="#E5E5E5"> okay what machine were they</font>

1030
00:36:09,700 --> 00:36:13,868
on well guess what was right on<font color="#E5E5E5"> the</font>

1031
00:36:11,529 --> 00:36:16,210
desktop<font color="#CCCCCC"> the host name of where they're</font>

1032
00:36:13,869 --> 00:36:17,619
already<font color="#E5E5E5"> peed</font><font color="#CCCCCC"> into and in</font><font color="#E5E5E5"> attacks where</font>

1033
00:36:16,210 --> 00:36:20,109
you've got a lot<font color="#CCCCCC"> of lateral</font><font color="#E5E5E5"> movement as</font>

1034
00:36:17,619 --> 00:36:22,960
<font color="#E5E5E5">well the registry will store RDP systems</font>

1035
00:36:20,109 --> 00:36:24,400
that you RDP to but that cycles out<font color="#E5E5E5"> it</font>

1036
00:36:22,960 --> 00:36:26,200
<font color="#E5E5E5">only has a limited capability only</font>

1037
00:36:24,400 --> 00:36:28,509
stores the<font color="#E5E5E5"> last</font><font color="#CCCCCC"> ten so if you really</font>

1038
00:36:26,200 --> 00:36:29,859
<font color="#E5E5E5">want to</font><font color="#CCCCCC"> log so you can clear as n log n</font>

1039
00:36:28,509 --> 00:36:30,940
logs you can<font color="#E5E5E5"> clear those you can go</font>

1040
00:36:29,859 --> 00:36:32,680
through the registry<font color="#E5E5E5"> and just connect to</font>

1041
00:36:30,940 --> 00:36:34,210
<font color="#CCCCCC">a bunch of</font><font color="#E5E5E5"> random machines and really</font>

1042
00:36:32,680 --> 00:36:35,499
throw investigators off the track<font color="#E5E5E5"> but</font>

1043
00:36:34,210 --> 00:36:39,249
with this they were actually able<font color="#E5E5E5"> to</font>

1044
00:36:35,499 --> 00:36:40,988
recreate<font color="#CCCCCC"> using BG or</font><font color="#E5E5E5"> using the artifacts</font>

1045
00:36:39,249 --> 00:36:43,058
<font color="#E5E5E5">from VG info so we found out like a</font>

1046
00:36:40,989 --> 00:36:44,829
tertiary method<font color="#E5E5E5"> doing cluesive internals</font>

1047
00:36:43,059 --> 00:36:46,749
<font color="#CCCCCC">but it helped profile lateral movement</font>

1048
00:36:44,829 --> 00:36:48,999
which is interesting<font color="#E5E5E5"> so I talked earlier</font>

1049
00:36:46,749 --> 00:36:51,069
<font color="#E5E5E5">about</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> PS exec and the artifacts that</font>

1050
00:36:48,999 --> 00:36:53,049
<font color="#E5E5E5">it drops another one that we love</font><font color="#CCCCCC"> to use</font>

1051
00:36:51,069 --> 00:36:54,880
<font color="#E5E5E5">as well</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> artifacts of execution called</font>

1052
00:36:53,049 --> 00:36:56,859
<font color="#E5E5E5">Tim</font><font color="#CCCCCC"> cache</font><font color="#E5E5E5"> short for the application</font>

1053
00:36:54,880 --> 00:36:58,539
compatibility cache if you've ever seen

1054
00:36:56,859 --> 00:37:01,299
<font color="#E5E5E5">a</font><font color="#CCCCCC"> mandiant or fire</font><font color="#E5E5E5"> I webinar you know</font>

1055
00:36:58,539 --> 00:37:03,489
this artifact<font color="#E5E5E5"> really really</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> well</font>

1056
00:37:01,299 --> 00:37:05,769
<font color="#CCCCCC">Jim cache is basically an evidence of</font>

1057
00:37:03,489 --> 00:37:07,839
execution<font color="#E5E5E5"> and I'll describe it really</font>

1058
00:37:05,769 --> 00:37:09,549
really simple<font color="#E5E5E5"> you ship an application</font>

1059
00:37:07,839 --> 00:37:10,839
with old code<font color="#CCCCCC"> windows looks at</font><font color="#E5E5E5"> that</font>

1060
00:37:09,549 --> 00:37:13,299
<font color="#CCCCCC">application and says hey there's old</font>

1061
00:37:10,839 --> 00:37:15,279
code here I'm<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> need to shim in some</font>

1062
00:37:13,299 --> 00:37:17,019
old code in order<font color="#E5E5E5"> to get it to</font><font color="#CCCCCC"> run all</font>

1063
00:37:15,279 --> 00:37:18,549
this happens in milliseconds behind the

1064
00:37:17,019 --> 00:37:20,558
scenes none of us ever see the effects

1065
00:37:18,549 --> 00:37:22,630
<font color="#CCCCCC">windows never pops up well hopefully it</font>

1066
00:37:20,559 --> 00:37:24,549
doesn't<font color="#CCCCCC"> pop up</font><font color="#E5E5E5"> and say hey</font><font color="#CCCCCC"> fYI</font><font color="#E5E5E5"> this</font>

1067
00:37:22,630 --> 00:37:26,349
developer was lazy and they wrote in

1068
00:37:24,549 --> 00:37:27,690
code<font color="#E5E5E5"> from a DLL that we haven't updated</font>

1069
00:37:26,349 --> 00:37:29,790
in like<font color="#E5E5E5"> three</font>

1070
00:37:27,690 --> 00:37:32,040
are you<font color="#CCCCCC"> ok with this that just do it</font>

1071
00:37:29,790 --> 00:37:33,990
<font color="#CCCCCC">behind the</font><font color="#E5E5E5"> scene this actually this</font>

1072
00:37:32,040 --> 00:37:36,210
evidence is actually tracked<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's</font>

1073
00:37:33,990 --> 00:37:38,330
recorded inside<font color="#E5E5E5"> of this database</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

1074
00:37:36,210 --> 00:37:41,250
a good example<font color="#E5E5E5"> of a remote system</font>

1075
00:37:38,330 --> 00:37:43,380
<font color="#E5E5E5">executing multiple variants of PS exe</font>

1076
00:37:41,250 --> 00:37:45,120
<font color="#CCCCCC">SBC now the one thing</font><font color="#E5E5E5"> I'll note about</font>

1077
00:37:43,380 --> 00:37:46,950
shim cache is usually an executable is

1078
00:37:45,120 --> 00:37:48,810
stored in there one<font color="#E5E5E5"> time</font><font color="#CCCCCC"> and when it's</font>

1079
00:37:46,950 --> 00:37:51,359
<font color="#CCCCCC">executed it's moved up</font><font color="#E5E5E5"> in the chain it's</font>

1080
00:37:48,810 --> 00:37:53,430
stored in reverse order of execution<font color="#E5E5E5"> PS</font>

1081
00:37:51,360 --> 00:37:55,170
exe SBC remember I mentioned<font color="#E5E5E5"> that</font><font color="#CCCCCC"> just</font>

1082
00:37:53,430 --> 00:37:57,870
to<font color="#E5E5E5"> double that gets dropped when you run</font>

1083
00:37:55,170 --> 00:37:59,730
PS exec technically every time you run

1084
00:37:57,870 --> 00:38:02,520
PS exactly against the system<font color="#CCCCCC"> it's the</font>

1085
00:37:59,730 --> 00:38:05,340
<font color="#E5E5E5">first time this executable has been seen</font>

1086
00:38:02,520 --> 00:38:06,660
<font color="#E5E5E5">so these entries get stored not only is</font>

1087
00:38:05,340 --> 00:38:08,280
it the<font color="#CCCCCC"> first time the entries been seen</font>

1088
00:38:06,660 --> 00:38:09,899
but it gets<font color="#CCCCCC"> created in real time</font>

1089
00:38:08,280 --> 00:38:13,110
timestamps as well it's<font color="#E5E5E5"> very tough to</font>

1090
00:38:09,900 --> 00:38:15,510
<font color="#E5E5E5">time stop</font><font color="#CCCCCC"> PS es</font><font color="#E5E5E5"> vs</font><font color="#CCCCCC"> BC so that actually</font>

1091
00:38:13,110 --> 00:38:17,490
gives<font color="#CCCCCC"> us</font><font color="#E5E5E5"> artifacts timing as well</font><font color="#CCCCCC"> which</font>

1092
00:38:15,510 --> 00:38:19,620
<font color="#CCCCCC">is very</font><font color="#E5E5E5"> tough</font><font color="#CCCCCC"> to get from</font><font color="#E5E5E5"> this one now</font>

1093
00:38:17,490 --> 00:38:21,600
you<font color="#E5E5E5"> may be thinking</font><font color="#CCCCCC"> ok are there some</font>

1094
00:38:19,620 --> 00:38:23,460
ways I can<font color="#CCCCCC"> execute</font><font color="#E5E5E5"> artifacts</font><font color="#CCCCCC"> alright so</font>

1095
00:38:21,600 --> 00:38:25,529
I<font color="#E5E5E5"> just need to avoid executing malware</font>

1096
00:38:23,460 --> 00:38:26,730
right I can<font color="#E5E5E5"> still be safe if I don't</font>

1097
00:38:25,530 --> 00:38:29,820
execute<font color="#CCCCCC"> anything on the system</font>

1098
00:38:26,730 --> 00:38:31,740
unfortunately<font color="#CCCCCC"> not another</font><font color="#E5E5E5"> screenshot for</font>

1099
00:38:29,820 --> 00:38:33,330
you so I talked earlier about<font color="#CCCCCC"> Windows</font>

1100
00:38:31,740 --> 00:38:35,310
looks for code it<font color="#E5E5E5"> can shim for</font><font color="#CCCCCC"> you</font>

1101
00:38:33,330 --> 00:38:37,140
Microsoft also<font color="#E5E5E5"> thought</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know what we</font>

1102
00:38:35,310 --> 00:38:38,970
should<font color="#CCCCCC"> think ahead</font><font color="#E5E5E5"> and we should look</font>

1103
00:38:37,140 --> 00:38:41,549
for artifacts that<font color="#CCCCCC"> they are</font><font color="#E5E5E5"> executables</font>

1104
00:38:38,970 --> 00:38:43,230
<font color="#E5E5E5">that they may want to run so Windows</font>

1105
00:38:41,550 --> 00:38:45,570
<font color="#E5E5E5">actually looks</font><font color="#CCCCCC"> ahead into folders that</font>

1106
00:38:43,230 --> 00:38:47,220
you connect Terminal Services client<font color="#E5E5E5"> USB</font>

1107
00:38:45,570 --> 00:38:49,020
drives<font color="#E5E5E5"> anything of that nature and it</font>

1108
00:38:47,220 --> 00:38:50,790
says are you<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> need shims for any</font>

1109
00:38:49,020 --> 00:38:52,410
of the executables in here it's a

1110
00:38:50,790 --> 00:38:54,390
logical thought<font color="#E5E5E5"> right you connected a</font>

1111
00:38:52,410 --> 00:38:56,549
USB<font color="#E5E5E5"> Drive with a piece of malware or</font>

1112
00:38:54,390 --> 00:38:58,109
<font color="#CCCCCC">with sorry with an executable on it you</font>

1113
00:38:56,550 --> 00:39:00,210
may want<font color="#CCCCCC"> to run</font><font color="#E5E5E5"> that executable at one</font>

1114
00:38:58,110 --> 00:39:01,740
point in time<font color="#E5E5E5"> let me check and see if</font>

1115
00:39:00,210 --> 00:39:04,020
<font color="#E5E5E5">you're gonna need any code this</font><font color="#CCCCCC"> actually</font>

1116
00:39:01,740 --> 00:39:05,970
is a test<font color="#CCCCCC"> that we ran where we connected</font>

1117
00:39:04,020 --> 00:39:08,670
to a system<font color="#CCCCCC"> and</font><font color="#E5E5E5"> mapped over a drive via</font>

1118
00:39:05,970 --> 00:39:10,319
RDP and we had sysinternals<font color="#CCCCCC"> inside</font><font color="#E5E5E5"> of it</font>

1119
00:39:08,670 --> 00:39:12,300
we were<font color="#CCCCCC"> planning to compromise that</font>

1120
00:39:10,320 --> 00:39:14,070
<font color="#E5E5E5">system collect some domain admin or so I</font>

1121
00:39:12,300 --> 00:39:16,560
collect some domain information<font color="#CCCCCC"> shim</font>

1122
00:39:14,070 --> 00:39:18,570
cache actually read them<font color="#CCCCCC"> over to the far</font>

1123
00:39:16,560 --> 00:39:20,670
<font color="#CCCCCC">side is all the</font><font color="#E5E5E5"> false this is going to</font>

1124
00:39:18,570 --> 00:39:23,010
sound weird false flags<font color="#CCCCCC"> it's not a false</font>

1125
00:39:20,670 --> 00:39:24,690
flag<font color="#CCCCCC"> its false flags that are stored</font><font color="#E5E5E5"> by</font>

1126
00:39:23,010 --> 00:39:26,640
<font color="#CCCCCC">Windows</font><font color="#E5E5E5"> they were not executed</font>

1127
00:39:24,690 --> 00:39:28,740
they were<font color="#E5E5E5"> profiled by Windows upon</font>

1128
00:39:26,640 --> 00:39:30,509
connection of RDP<font color="#E5E5E5"> so now I've got</font>

1129
00:39:28,740 --> 00:39:32,370
evidence<font color="#E5E5E5"> that someone named</font><font color="#CCCCCC"> matt has a</font>

1130
00:39:30,510 --> 00:39:34,380
folder called<font color="#CCCCCC"> Matt admin tools in the</font>

1131
00:39:32,370 --> 00:39:35,970
root of<font color="#E5E5E5"> his</font><font color="#CCCCCC"> drive and he</font><font color="#E5E5E5"> mapped it over</font>

1132
00:39:34,380 --> 00:39:37,480
and had sysinternals inside of it we can

1133
00:39:35,970 --> 00:39:39,250
capture<font color="#E5E5E5"> all of this</font>

1134
00:39:37,480 --> 00:39:40,810
<font color="#CCCCCC">hack grooves or sorry attack groups</font><font color="#E5E5E5"> and</font>

1135
00:39:39,250 --> 00:39:42,609
attackers<font color="#E5E5E5"> get caught with this one all</font>

1136
00:39:40,810 --> 00:39:44,950
the<font color="#CCCCCC"> time we can actually profile your</font>

1137
00:39:42,609 --> 00:39:46,779
entire<font color="#CCCCCC"> tool set because it gets</font><font color="#E5E5E5"> read and</font>

1138
00:39:44,950 --> 00:39:49,200
if it gets read by<font color="#E5E5E5"> windows</font><font color="#CCCCCC"> guess what</font>

1139
00:39:46,780 --> 00:39:52,210
else takes a peek into it as well

1140
00:39:49,200 --> 00:39:55,299
<font color="#CCCCCC">av I've actually</font><font color="#E5E5E5"> seen some attacker</font>

1141
00:39:52,210 --> 00:39:58,210
toolkits<font color="#E5E5E5"> wiped out because they mapped</font>

1142
00:39:55,300 --> 00:40:00,490
over<font color="#E5E5E5"> a drive via RDP and Microsoft lit</font>

1143
00:39:58,210 --> 00:40:01,570
<font color="#E5E5E5">up like a Christmas</font><font color="#CCCCCC"> tree</font><font color="#E5E5E5"> and caught all</font>

1144
00:40:00,490 --> 00:40:03,549
<font color="#CCCCCC">of these executables and</font><font color="#E5E5E5"> then</font>

1145
00:40:01,570 --> 00:40:05,320
<font color="#E5E5E5">quarantined them all and then you start</font>

1146
00:40:03,550 --> 00:40:06,880
to<font color="#E5E5E5"> see the attackers not come over with</font>

1147
00:40:05,320 --> 00:40:11,680
<font color="#CCCCCC">Mac RDP shares anymore</font><font color="#E5E5E5"> because they</font>

1148
00:40:06,880 --> 00:40:15,430
<font color="#E5E5E5">learn the lesson the hard way</font><font color="#CCCCCC"> chin</font><font color="#E5E5E5"> cache</font>

1149
00:40:11,680 --> 00:40:18,549
v2 so this starts in Windows 8<font color="#E5E5E5"> M cache</font>

1150
00:40:15,430 --> 00:40:21,460
<font color="#E5E5E5">awesome</font><font color="#CCCCCC"> artifact</font><font color="#E5E5E5"> bullet point number</font><font color="#CCCCCC"> one</font>

1151
00:40:18,550 --> 00:40:24,100
sha-1 hash as awesome as digital

1152
00:40:21,460 --> 00:40:25,780
<font color="#E5E5E5">forensics and</font><font color="#CCCCCC"> ir guys it's really the</font>

1153
00:40:24,100 --> 00:40:27,609
<font color="#CCCCCC">only bullet point worth mentioning</font><font color="#E5E5E5"> right</font>

1154
00:40:25,780 --> 00:40:31,060
<font color="#E5E5E5">now we get a hash of your malware file</font>

1155
00:40:27,609 --> 00:40:32,859
size<font color="#CCCCCC"> how does is nice and yeah but so if</font>

1156
00:40:31,060 --> 00:40:34,330
you rename any sysinternals

1157
00:40:32,859 --> 00:40:36,009
tools or anything like<font color="#E5E5E5"> that it gets kind</font>

1158
00:40:34,330 --> 00:40:37,900
<font color="#E5E5E5">of</font><font color="#CCCCCC"> a em cash we have the sha-1 hash</font>

1159
00:40:36,010 --> 00:40:40,540
<font color="#CCCCCC">doesn't</font><font color="#E5E5E5"> matter what you call</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> week we</font>

1160
00:40:37,900 --> 00:40:43,030
ran it so<font color="#E5E5E5"> it's on</font><font color="#CCCCCC"> Windows 8</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> above by</font>

1161
00:40:40,540 --> 00:40:47,470
default however<font color="#CCCCCC"> most domains are still</font>

1162
00:40:43,030 --> 00:40:49,300
what<font color="#E5E5E5"> any red teamers any thoughts 7 2008</font>

1163
00:40:47,470 --> 00:40:52,720
domains anyone still messing around in

1164
00:40:49,300 --> 00:40:54,190
2003 domains<font color="#CCCCCC"> I can't get people to admit</font>

1165
00:40:52,720 --> 00:40:56,950
<font color="#CCCCCC">darn</font><font color="#E5E5E5"> I'm going to find one one of these</font>

1166
00:40:54,190 --> 00:40:58,780
days<font color="#E5E5E5"> I've been in some 2003 domains but</font>

1167
00:40:56,950 --> 00:41:01,629
yeah most<font color="#E5E5E5"> of days they're 2008 so</font><font color="#CCCCCC"> it's</font>

1168
00:40:58,780 --> 00:41:02,859
very rare or at least it's starting<font color="#E5E5E5"> to</font>

1169
00:41:01,630 --> 00:41:05,350
become more<font color="#E5E5E5"> commonplace that you've got</font>

1170
00:41:02,859 --> 00:41:07,750
a Windows 10 build domain<font color="#E5E5E5"> there is</font><font color="#CCCCCC"> a</font>

1171
00:41:05,350 --> 00:41:10,509
patch there the service packs are<font color="#CCCCCC"> not so</font>

1172
00:41:07,750 --> 00:41:12,760
respect<font color="#E5E5E5"> but a KB that will and do am</font>

1173
00:41:10,510 --> 00:41:15,790
cache on Windows 7<font color="#E5E5E5"> but it's not as</font>

1174
00:41:12,760 --> 00:41:18,070
widely seen as we'd like<font color="#CCCCCC"> it to be</font><font color="#E5E5E5"> so now</font>

1175
00:41:15,790 --> 00:41:21,070
here's that<font color="#CCCCCC"> social security numbers dot</font>

1176
00:41:18,070 --> 00:41:23,470
txt file from earlier our example so we

1177
00:41:21,070 --> 00:41:26,560
estimate it's gone it's zeroed out it's

1178
00:41:23,470 --> 00:41:28,868
been renamed<font color="#E5E5E5"> 26 times we can't recover</font>

1179
00:41:26,560 --> 00:41:31,000
anything<font color="#E5E5E5"> right well if it's been</font>

1180
00:41:28,869 --> 00:41:34,330
accessed then there's a<font color="#E5E5E5"> link file that</font>

1181
00:41:31,000 --> 00:41:37,720
<font color="#E5E5E5">gets created of recently accessed files</font>

1182
00:41:34,330 --> 00:41:39,640
in that<font color="#CCCCCC"> link file</font><font color="#E5E5E5"> there's a stream which</font>

1183
00:41:37,720 --> 00:41:42,669
tells us<font color="#CCCCCC"> the file size so</font><font color="#E5E5E5"> this would be</font>

1184
00:41:39,640 --> 00:41:44,740
<font color="#CCCCCC">really</font><font color="#E5E5E5"> good</font><font color="#CCCCCC"> you know how much data what</font>

1185
00:41:42,670 --> 00:41:47,109
was in that<font color="#E5E5E5"> social security number dot</font>

1186
00:41:44,740 --> 00:41:50,359
<font color="#CCCCCC">text file that was what we can recover</font>

1187
00:41:47,109 --> 00:41:54,500
that<font color="#E5E5E5"> as well as</font>

1188
00:41:50,360 --> 00:41:56,420
the<font color="#CCCCCC"> USN journal</font><font color="#E5E5E5"> if it will respond quick</font>

1189
00:41:54,500 --> 00:41:58,790
enough the journal will have every

1190
00:41:56,420 --> 00:42:02,720
single<font color="#E5E5E5"> operation that's been</font><font color="#CCCCCC"> performed</font>

1191
00:41:58,790 --> 00:42:05,420
<font color="#E5E5E5">before</font><font color="#CCCCCC"> s tallit wiped it and then we</font>

1192
00:42:02,720 --> 00:42:08,270
have all that<font color="#E5E5E5"> we have the dollar</font><font color="#CCCCCC"> i30</font>

1193
00:42:05,420 --> 00:42:11,170
<font color="#E5E5E5">index files that the each restructure of</font>

1194
00:42:08,270 --> 00:42:13,460
<font color="#E5E5E5">the NTFS file system we can recover</font>

1195
00:42:11,170 --> 00:42:16,580
<font color="#CCCCCC">defeats and times when that was placed</font>

1196
00:42:13,460 --> 00:42:17,600
on the system<font color="#CCCCCC"> things like that</font><font color="#E5E5E5"> you guys</font>

1197
00:42:16,580 --> 00:42:18,610
are pretty<font color="#E5E5E5"> sharp so I'm going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> throw</font>

1198
00:42:17,600 --> 00:42:20,660
this out to<font color="#CCCCCC"> you</font>

1199
00:42:18,610 --> 00:42:28,150
we just mess<font color="#CCCCCC"> around with this</font><font color="#E5E5E5"> this</font>

1200
00:42:20,660 --> 00:42:32,450
morning<font color="#CCCCCC"> can us delete Esteli any thought</font>

1201
00:42:28,150 --> 00:42:36,560
so you go<font color="#E5E5E5"> to</font><font color="#CCCCCC"> Verdun who says yes one yes</font>

1202
00:42:32,450 --> 00:42:38,029
who says<font color="#E5E5E5"> no all right so you don't like</font>

1203
00:42:36,560 --> 00:42:40,279
<font color="#CCCCCC">here people wait</font><font color="#E5E5E5"> you have to burn down</font>

1204
00:42:38,030 --> 00:42:43,040
your<font color="#CCCCCC"> entire</font><font color="#E5E5E5"> sets internal</font><font color="#CCCCCC"> toolkit that's</font>

1205
00:42:40,280 --> 00:42:45,500
<font color="#CCCCCC">you're done with s elite and then you go</font>

1206
00:42:43,040 --> 00:42:47,810
<font color="#E5E5E5">to delete the last one</font><font color="#CCCCCC"> and it airs out</font>

1207
00:42:45,500 --> 00:42:50,930
and says cannot get a<font color="#E5E5E5"> handle on an</font>

1208
00:42:47,810 --> 00:42:53,299
active process<font color="#E5E5E5"> to</font><font color="#CCCCCC"> remove it so you can't</font>

1209
00:42:50,930 --> 00:42:54,680
I can't<font color="#CCCCCC"> absolute absolutely</font><font color="#E5E5E5"> and then and</font>

1210
00:42:53,300 --> 00:42:56,390
then in the conversation with<font color="#E5E5E5"> Matt I</font>

1211
00:42:54,680 --> 00:42:59,180
said<font color="#E5E5E5"> - oh well then you just delete it</font>

1212
00:42:56,390 --> 00:43:01,279
<font color="#E5E5E5">and</font><font color="#CCCCCC"> then you can run it clearing slash</font>

1213
00:42:59,180 --> 00:43:02,569
space clearing<font color="#E5E5E5"> free space and then</font>

1214
00:43:01,280 --> 00:43:04,880
you'll<font color="#E5E5E5"> get rid of it</font><font color="#CCCCCC"> angers but then you</font>

1215
00:43:02,570 --> 00:43:09,170
have to delete as deleted<font color="#CCCCCC"> Idol very</font>

1216
00:43:04,880 --> 00:43:11,510
clear<font color="#E5E5E5"> that so so forth because of</font><font color="#CCCCCC"> this</font>

1217
00:43:09,170 --> 00:43:14,660
exact reason a lot of attack groups

1218
00:43:11,510 --> 00:43:16,400
leave behind one file s please<font color="#E5E5E5"> daddy</font><font color="#CCCCCC"> XE</font>

1219
00:43:14,660 --> 00:43:17,779
because it's the one thing they<font color="#CCCCCC"> couldn't</font>

1220
00:43:16,400 --> 00:43:20,360
<font color="#E5E5E5">get rid</font><font color="#CCCCCC"> of at the</font><font color="#E5E5E5"> end of the day and</font>

1221
00:43:17,780 --> 00:43:22,700
that<font color="#E5E5E5"> same group that has modified PS</font>

1222
00:43:20,360 --> 00:43:25,190
exec they actually leave<font color="#CCCCCC"> systole Esteli</font>

1223
00:43:22,700 --> 00:43:26,149
behind in the windows directory<font color="#E5E5E5"> and for</font>

1224
00:43:25,190 --> 00:43:31,100
that<font color="#CCCCCC"> reason they can't get rid of it</font>

1225
00:43:26,150 --> 00:43:32,270
<font color="#E5E5E5">yeah you could you could if you wanted</font>

1226
00:43:31,100 --> 00:43:34,520
to but<font color="#E5E5E5"> if you're running off</font><font color="#CCCCCC"> of there</font>

1227
00:43:32,270 --> 00:43:36,080
you're<font color="#E5E5E5"> not deleted on your system so</font>

1228
00:43:34,520 --> 00:43:37,730
technically I<font color="#CCCCCC"> suppose you could if you</font>

1229
00:43:36,080 --> 00:43:39,170
poured all these tools<font color="#CCCCCC"> onto a system and</font>

1230
00:43:37,730 --> 00:43:40,820
then<font color="#E5E5E5"> you connect you connect to the</font><font color="#CCCCCC"> on</font>

1231
00:43:39,170 --> 00:43:41,990
<font color="#E5E5E5">path</font><font color="#CCCCCC"> to then go back and believe</font>

1232
00:43:40,820 --> 00:43:43,160
everything you couldn't go<font color="#E5E5E5"> that route</font><font color="#CCCCCC"> I</font>

1233
00:43:41,990 --> 00:43:45,319
could work yeah that could definitely

1234
00:43:43,160 --> 00:43:47,060
work<font color="#E5E5E5"> but then</font><font color="#CCCCCC"> you got</font><font color="#E5E5E5"> to go to</font><font color="#CCCCCC"> leave the</font>

1235
00:43:45,320 --> 00:43:48,410
registry key as well so there's a<font color="#E5E5E5"> little</font>

1236
00:43:47,060 --> 00:43:49,820
<font color="#E5E5E5">bit of extra cleanup you got to do but</font>

1237
00:43:48,410 --> 00:43:53,149
you're right<font color="#E5E5E5"> you</font><font color="#CCCCCC"> could you could look at</font>

1238
00:43:49,820 --> 00:43:54,770
it that<font color="#E5E5E5"> way again the slides will be</font>

1239
00:43:53,150 --> 00:43:56,330
made available but<font color="#E5E5E5"> what you're seeing on</font>

1240
00:43:54,770 --> 00:43:58,820
the far side of the<font color="#E5E5E5"> screen there</font><font color="#CCCCCC"> is</font>

1241
00:43:56,330 --> 00:44:01,850
actually on the rotation of<font color="#CCCCCC"> sis of</font>

1242
00:43:58,820 --> 00:44:04,810
<font color="#CCCCCC">Vesely</font><font color="#E5E5E5"> going through ABCDEF the entire</font>

1243
00:44:01,850 --> 00:44:04,810
outfit<font color="#E5E5E5"> as it goes through yeah</font>

1244
00:44:05,740 --> 00:44:10,370
now you're<font color="#E5E5E5"> thinking now you're thinking</font>

1245
00:44:08,450 --> 00:44:29,569
there we go see<font color="#E5E5E5"> look at</font><font color="#CCCCCC"> that we just hit</font>

1246
00:44:10,370 --> 00:44:31,009
<font color="#CCCCCC">Esteli</font><font color="#E5E5E5"> yeah so I do not remember the</font>

1247
00:44:29,570 --> 00:44:32,660
exact range but<font color="#E5E5E5"> basically there I</font><font color="#CCCCCC"> think</font>

1248
00:44:31,010 --> 00:44:35,360
it's<font color="#E5E5E5"> four ports that PS exec requires</font>

1249
00:44:32,660 --> 00:44:38,270
137 138 139 then there's one I'm<font color="#E5E5E5"> missing</font>

1250
00:44:35,360 --> 00:44:39,980
<font color="#E5E5E5">maybe four or five I'm not sure but you</font>

1251
00:44:38,270 --> 00:44:42,530
<font color="#E5E5E5">if you're monitoring that type</font><font color="#CCCCCC"> of</font>

1252
00:44:39,980 --> 00:44:44,270
internal traffic<font color="#E5E5E5"> then you'll be able to</font>

1253
00:44:42,530 --> 00:44:46,310
see<font color="#CCCCCC"> ts exact going across you'll be able</font>

1254
00:44:44,270 --> 00:44:47,600
to see the commands<font color="#E5E5E5"> in plain text</font><font color="#CCCCCC"> PS</font>

1255
00:44:46,310 --> 00:44:49,549
<font color="#CCCCCC">music actually only encrypts the</font>

1256
00:44:47,600 --> 00:44:50,960
credentials<font color="#E5E5E5"> and for a while even that</font>

1257
00:44:49,550 --> 00:44:53,000
wasn't<font color="#E5E5E5"> being done</font><font color="#CCCCCC"> they were being sent</font>

1258
00:44:50,960 --> 00:44:54,470
<font color="#E5E5E5">as plain text but the commands are easy</font>

1259
00:44:53,000 --> 00:44:56,090
to see you just got<font color="#CCCCCC"> to be able to</font><font color="#E5E5E5"> parse</font>

1260
00:44:54,470 --> 00:44:59,029
that traffic<font color="#CCCCCC"> the issue with what you're</font>

1261
00:44:56,090 --> 00:45:01,430
<font color="#E5E5E5">saying is a lot of organizations do not</font>

1262
00:44:59,030 --> 00:45:02,840
<font color="#E5E5E5">capture or even look at internal to</font>

1263
00:45:01,430 --> 00:45:04,790
internal traffic<font color="#CCCCCC"> at all</font><font color="#E5E5E5"> so it's very</font>

1264
00:45:02,840 --> 00:45:06,830
tough to<font color="#E5E5E5"> see but</font><font color="#CCCCCC"> you're</font><font color="#E5E5E5"> right with</font>

1265
00:45:04,790 --> 00:45:08,600
either updated versions<font color="#E5E5E5"> either pre-sales</font>

1266
00:45:06,830 --> 00:45:10,670
and<font color="#CCCCCC"> 6 or updated</font><font color="#E5E5E5"> one you'll see the</font>

1267
00:45:08,600 --> 00:45:14,980
commands<font color="#E5E5E5"> you won't see the creds but you</font>

1268
00:45:10,670 --> 00:45:14,980
can flag on those<font color="#E5E5E5"> structures as well</font>

1269
00:45:15,280 --> 00:45:24,080
correct<font color="#CCCCCC"> exactly yep yeah so if anyone</font>

1270
00:45:22,460 --> 00:45:25,580
here<font color="#CCCCCC"> is doing internal</font><font color="#E5E5E5"> internal network</font>

1271
00:45:24,080 --> 00:45:29,170
introspection you<font color="#E5E5E5"> can look with this</font>

1272
00:45:25,580 --> 00:45:29,170
stuff but<font color="#E5E5E5"> that's a lot</font><font color="#CCCCCC"> of traffic</font><font color="#E5E5E5"> yeah</font>

1273
00:45:30,190 --> 00:45:36,680
so you from from<font color="#E5E5E5"> capture network traffic</font>

1274
00:45:33,400 --> 00:45:38,900
there<font color="#CCCCCC"> may be Jackie made a good point</font>

1275
00:45:36,680 --> 00:45:40,609
bro is one that does have<font color="#CCCCCC"> a built-in</font>

1276
00:45:38,900 --> 00:45:42,770
analyzer to it that you could use<font color="#E5E5E5"> to</font>

1277
00:45:40,610 --> 00:45:45,860
pull that<font color="#E5E5E5"> out there are like SMB ones</font>

1278
00:45:42,770 --> 00:45:48,500
<font color="#E5E5E5">whether or not you'd get ApS exact</font>

1279
00:45:45,860 --> 00:45:53,990
session recreation<font color="#E5E5E5"> that I do not know if</font>

1280
00:45:48,500 --> 00:45:55,670
not network matter might I'll be honest

1281
00:45:53,990 --> 00:45:57,140
with<font color="#E5E5E5"> you I have long ago stopped trying</font>

1282
00:45:55,670 --> 00:45:58,280
<font color="#E5E5E5">to</font><font color="#CCCCCC"> remember</font><font color="#E5E5E5"> everything</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> minor can</font>

1283
00:45:57,140 --> 00:46:01,129
do because<font color="#E5E5E5"> it's got a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> features</font>

1284
00:45:58,280 --> 00:46:02,870
<font color="#CCCCCC">built in it may</font><font color="#E5E5E5"> be able to but I</font><font color="#CCCCCC"> don't</font>

1285
00:46:01,130 --> 00:46:04,970
hold me<font color="#CCCCCC"> to that</font><font color="#E5E5E5"> it'd be a tough session</font>

1286
00:46:02,870 --> 00:46:06,859
<font color="#E5E5E5">to recreate it also depends on the</font>

1287
00:46:04,970 --> 00:46:08,930
<font color="#E5E5E5">volume</font><font color="#CCCCCC"> I know in sans whenever they</font>

1288
00:46:06,860 --> 00:46:10,910
teach them<font color="#CCCCCC"> networking</font><font color="#E5E5E5"> class</font><font color="#CCCCCC"> I didn't</font>

1289
00:46:08,930 --> 00:46:12,680
take it but from one of the<font color="#CCCCCC"> networks</font>

1290
00:46:10,910 --> 00:46:15,770
they give you a<font color="#E5E5E5"> peek at big enough to</font>

1291
00:46:12,680 --> 00:46:17,629
break<font color="#E5E5E5"> Network minor just so</font>

1292
00:46:15,770 --> 00:46:20,420
the students<font color="#E5E5E5"> aren't using the nice easy</font>

1293
00:46:17,630 --> 00:46:22,250
GUI<font color="#CCCCCC"> now if you sir are volunteering to</font>

1294
00:46:20,420 --> 00:46:24,770
<font color="#E5E5E5">write all of us</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> sysinternals</font>

1295
00:46:22,250 --> 00:46:26,420
recreation tool we will all just<font color="#E5E5E5"> follow</font>

1296
00:46:24,770 --> 00:46:29,360
you on twitter<font color="#E5E5E5"> and hound you every day</font>

1297
00:46:26,420 --> 00:46:31,310
<font color="#E5E5E5">for those</font><font color="#CCCCCC"> updates and those commits</font><font color="#E5E5E5"> with</font>

1298
00:46:29,360 --> 00:46:32,630
that<font color="#CCCCCC"> we'll get to our final piece which</font>

1299
00:46:31,310 --> 00:46:34,910
is<font color="#CCCCCC"> judgment day and this is kind of a</font>

1300
00:46:32,630 --> 00:46:38,330
<font color="#E5E5E5">tongue-in-cheek slide</font><font color="#CCCCCC"> because that's it</font>

1301
00:46:34,910 --> 00:46:38,509
<font color="#CCCCCC">at the</font><font color="#E5E5E5"> end</font><font color="#CCCCCC"> so thank you all</font><font color="#E5E5E5"> for coming</font>

1302
00:46:38,330 --> 00:46:40,670
today

1303
00:46:38,510 --> 00:46:42,950
<font color="#E5E5E5">obviously any questions anyone has will</font>

1304
00:46:40,670 --> 00:46:44,360
<font color="#E5E5E5">be happy to answer but please make sure</font>

1305
00:46:42,950 --> 00:46:45,589
<font color="#E5E5E5">you continue to enjoy New Orleans and</font>

1306
00:46:44,360 --> 00:46:47,860
again thanks for<font color="#E5E5E5"> thanks thanks for</font>

1307
00:46:45,590 --> 00:46:47,860
<font color="#CCCCCC">coming out</font>

