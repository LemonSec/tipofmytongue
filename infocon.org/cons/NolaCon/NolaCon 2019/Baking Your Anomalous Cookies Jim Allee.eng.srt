1
00:00:06,140 --> 00:00:16,490
alright guys I just talked is making

2
00:00:11,969 --> 00:00:16,490
your anomalous cookies or how I learned

3
00:00:39,800 --> 00:00:45,510
you follow the White Rabbit press the

4
00:00:42,570 --> 00:00:47,520
red button a lot I like breaking making

5
00:00:45,510 --> 00:00:50,339
exploiting resolving I like the whole

6
00:00:47,520 --> 00:00:52,649
stare called the full cycle rat

7
00:00:50,340 --> 00:00:58,770
Raspberry Pi hobbyist enthusiasts I like

8
00:00:52,649 --> 00:01:00,840
functional wearable silence and thought

9
00:00:58,770 --> 00:01:07,460
for security thank you guys I love you

10
00:01:00,840 --> 00:01:10,229
guys next 45 minutes are going to cover

11
00:01:07,460 --> 00:01:14,179
pausing a little bit how to break a

12
00:01:10,229 --> 00:01:17,310
little bit about cookies script I wrote

13
00:01:14,180 --> 00:01:21,420
self XSS and how to actually weaponize

14
00:01:17,310 --> 00:01:23,100
it something I call cookie baking talk

15
00:01:21,420 --> 00:01:24,150
about Google Chrome and how they handle

16
00:01:23,100 --> 00:01:28,619
their cookies at rest

17
00:01:24,150 --> 00:01:30,570
some powershell donkey scripts talk

18
00:01:28,619 --> 00:01:42,869
about bond use a little bit that process

19
00:01:30,570 --> 00:01:47,250
and thank you all for showing up what is

20
00:01:42,869 --> 00:01:54,658
fuzzy well it is kind of a QA processor

21
00:01:47,250 --> 00:01:58,110
off throwing everything and field on a

22
00:01:54,659 --> 00:02:00,570
website it could be a doorbell you read

23
00:01:58,110 --> 00:02:07,369
or bow once quickly hold it for five

24
00:02:00,570 --> 00:02:09,449
seconds we do fuzzing because it works

25
00:02:07,369 --> 00:02:12,420
it shows us where there are weaknesses

26
00:02:09,449 --> 00:02:13,530
and software and frameworks so that we

27
00:02:12,420 --> 00:02:16,829
can take advantage of that

28
00:02:13,530 --> 00:02:18,270
build up a log to exploit it our

29
00:02:16,830 --> 00:02:20,490
payloads come from everywhere they could

30
00:02:18,270 --> 00:02:22,740
be anything they come from creative

31
00:02:20,490 --> 00:02:39,780
people and people willing to try three

32
00:02:22,740 --> 00:02:40,830
periods to see how the original service

33
00:02:39,780 --> 00:02:44,520
or whatever it is

34
00:02:40,830 --> 00:02:47,070
reacts you are king you so for instance

35
00:02:44,520 --> 00:02:49,620
if you go to like at the games.com and

36
00:02:47,070 --> 00:02:51,810
you get a cookie like underscore epic si

37
00:02:49,620 --> 00:02:54,209
D it's got some random or not so random

38
00:02:51,810 --> 00:02:57,380
string in there what happens if you

39
00:02:54,209 --> 00:03:03,980
modify that and request the site to

40
00:02:57,380 --> 00:03:03,980
request again a little bit about cookies

41
00:03:04,880 --> 00:03:12,569
it's a way for a website to keep track

42
00:03:08,730 --> 00:03:14,369
of a states a password or some other

43
00:03:12,569 --> 00:03:16,589
confirmation that can see this whole

44
00:03:14,370 --> 00:03:19,470
Gator cookie they can use to identify

45
00:03:16,590 --> 00:03:28,640
you a lot of its core user experience

46
00:03:19,470 --> 00:03:31,590
for tracking so writing a buzzing tool

47
00:03:28,640 --> 00:03:35,359
we're trying to solve a challenge here

48
00:03:31,590 --> 00:03:39,209
and in fuzzing cookies we need a browser

49
00:03:35,360 --> 00:03:41,970
go to a website make the request grab

50
00:03:39,209 --> 00:03:44,310
the cookies modify them send them back

51
00:03:41,970 --> 00:03:46,950
to the server go and get some type of

52
00:03:44,310 --> 00:03:53,010
output in my case I wanted to get

53
00:03:46,950 --> 00:03:56,640
screenshots a spreadsheet and a CSV that

54
00:03:53,010 --> 00:03:59,519
we can sort through the reason we do the

55
00:03:56,640 --> 00:04:02,488
custom fuzzing tools is sometimes our

56
00:03:59,519 --> 00:04:05,640
page softer than the finder self access

57
00:04:02,489 --> 00:04:08,180
bindings are deemed is not important

58
00:04:05,640 --> 00:04:12,290
right now they're not really known as

59
00:04:08,180 --> 00:04:12,290
valid attack vectors so

60
00:04:17,630 --> 00:04:28,219
Hospital solutions for our particle we

61
00:04:19,910 --> 00:04:30,050
might be selenium is a browser my god

62
00:04:28,220 --> 00:04:34,550
again that might be part of our solution

63
00:04:30,050 --> 00:04:38,080
and we might be some good puzzlers so

64
00:04:34,550 --> 00:04:41,150
let's write a buzzer or you selenium

65
00:04:38,080 --> 00:04:42,770
selenium here not use proxy so you can

66
00:04:41,150 --> 00:04:46,250
send it to prettier or you can send it

67
00:04:42,770 --> 00:04:48,979
to for some other Proctor your service

68
00:04:46,250 --> 00:04:53,960
if you want to use change the custom

69
00:04:48,980 --> 00:05:02,960
user again the screenshot can't modify

70
00:04:53,960 --> 00:05:07,969
the header python again to build

71
00:05:02,960 --> 00:05:09,099
dictionaries for the value pair probably

72
00:05:07,970 --> 00:05:11,450
drop the request

73
00:05:09,100 --> 00:05:16,300
islip python everybody's moving to go

74
00:05:11,450 --> 00:05:20,870
but drop so we're gonna write in python

75
00:05:16,300 --> 00:05:23,780
one thing to say is you know is really

76
00:05:20,870 --> 00:05:26,810
better than anybody else you might know

77
00:05:23,780 --> 00:05:29,119
through experience over time two percent

78
00:05:26,810 --> 00:05:31,160
symbols in the URL bar will break web

79
00:05:29,120 --> 00:05:34,240
requests a lot and jump off pretty long

80
00:05:31,160 --> 00:05:37,670
hairs or other information disclosure

81
00:05:34,240 --> 00:05:42,710
but somebody fresh might try 18 or

82
00:05:37,670 --> 00:05:46,720
eighteen thousand so anybody buzz and

83
00:05:42,710 --> 00:05:46,719
actually use that to their death

84
00:05:47,350 --> 00:05:54,500
let's talk about anonymous good this is

85
00:05:49,940 --> 00:05:59,020
the script I wrote what anomalous cookie

86
00:05:54,500 --> 00:05:59,020
does it makes a request with fire

87
00:06:00,970 --> 00:06:06,350
halos whatever's in the puzzle is it'll

88
00:06:04,100 --> 00:06:09,200
save screenshots of each request and

89
00:06:06,350 --> 00:06:12,920
make a spreadsheet you just provided a

90
00:06:09,200 --> 00:06:14,900
URL applause option to replace the

91
00:06:12,920 --> 00:06:29,570
cookie value with your payload appended

92
00:06:14,900 --> 00:06:33,250
in front or a pendant I like your

93
00:06:29,570 --> 00:06:33,250
funding and you have to store through

94
00:06:37,750 --> 00:06:44,360
there may be the same or not pictures

95
00:06:41,960 --> 00:06:47,719
but request data but if you look at the

96
00:06:44,360 --> 00:07:05,120
pictures and a directory you can see how

97
00:06:47,720 --> 00:07:07,129
those two are you can download anomalous

98
00:07:05,120 --> 00:07:09,529
cookie from lost rabbit

99
00:07:07,129 --> 00:07:13,759
get hub and there's a little info on how

100
00:07:09,529 --> 00:07:16,369
to install it alright let's test it out

101
00:07:13,759 --> 00:07:17,779
so let's pick a target when you are

102
00:07:16,369 --> 00:07:32,029
doing this type of work always use your

103
00:07:17,779 --> 00:07:33,860
own website where you that's everything

104
00:07:32,029 --> 00:07:36,619
out for the next request that supplies

105
00:07:33,860 --> 00:07:38,409
payloads and then it starts going from

106
00:07:36,619 --> 00:07:40,220
there

107
00:07:38,409 --> 00:07:44,650
so the actual come

108
00:07:40,220 --> 00:09:16,550
to run anomalous cookies right there

109
00:07:44,650 --> 00:09:19,930
it's so here we can sort the images by

110
00:09:16,550 --> 00:09:22,250
side to find possibly alike images and

111
00:09:19,930 --> 00:09:22,939
then we can flip through them like a

112
00:09:22,250 --> 00:09:24,500
flipbook

113
00:09:22,940 --> 00:09:26,360
so back in the day before we had

114
00:09:24,500 --> 00:09:34,380
Internet video games we took pieces of

115
00:09:26,360 --> 00:09:36,480
paper do the same thing by

116
00:09:34,380 --> 00:09:38,130
an image preview and then only your

117
00:09:36,480 --> 00:09:40,410
cursor the animal cycle through all the

118
00:09:38,130 --> 00:09:42,470
images really fast you can stare at the

119
00:09:40,410 --> 00:09:44,880
screen and everything will look the same

120
00:09:42,470 --> 00:09:55,020
but then I'll cinema flash up here with

121
00:09:44,880 --> 00:09:57,150
a logon bar directory output here

122
00:09:55,020 --> 00:10:02,130
there's a whole lot of white pictures

123
00:09:57,150 --> 00:10:05,220
and with the normal a few stuff the way

124
00:10:02,130 --> 00:10:07,050
that we use that information is in this

125
00:10:05,220 --> 00:10:45,870
case we look at the pictures and we can

126
00:10:07,050 --> 00:10:48,030
see there's a I really wanted to make

127
00:10:45,870 --> 00:10:49,710
sure that I'm not going to get robbed or

128
00:10:48,030 --> 00:10:52,290
I'm kidding I just want to mess with my

129
00:10:49,710 --> 00:10:54,390
daughter it's true there was a bug

130
00:10:52,290 --> 00:10:56,040
Bonnie also for them and I figured I

131
00:10:54,390 --> 00:10:58,500
would just dive into this epic game

132
00:10:56,040 --> 00:10:59,130
thing real quick after the second

133
00:10:58,500 --> 00:11:02,810
request

134
00:10:59,130 --> 00:11:05,670
I got an XSS pop-up on Epic Games calm

135
00:11:02,810 --> 00:11:08,670
and then I found multiple payloads to

136
00:11:05,670 --> 00:11:10,349
work with that then the next thing I did

137
00:11:08,670 --> 00:11:11,670
is I went pivoted off the cookie name

138
00:11:10,350 --> 00:11:13,290
there's a few sites out there that you

139
00:11:11,670 --> 00:11:15,469
can do that and I found that cookie with

140
00:11:13,290 --> 00:11:15,469
you

141
00:11:20,830 --> 00:11:28,010
cookie and they were all vulnerable to

142
00:11:23,480 --> 00:11:30,860
the same exploitation so the problem

143
00:11:28,010 --> 00:11:33,620
here is that I did this to myself

144
00:11:30,860 --> 00:11:35,210
this is all self exercises nobody gets

145
00:11:33,620 --> 00:11:40,070
excited about this they don't take it

146
00:11:35,210 --> 00:11:47,450
seriously nobody so my inspiration was

147
00:11:40,070 --> 00:11:49,280
to try to turn this into a ballad so my

148
00:11:47,450 --> 00:11:51,860
next steps are going to be to write a

149
00:11:49,280 --> 00:11:54,319
proper payload and then I will reach out

150
00:11:51,860 --> 00:11:56,270
I do responsible disclosure my own way

151
00:11:54,320 --> 00:11:59,270
usually I will reach out I will provide

152
00:11:56,270 --> 00:12:09,710
the information ask for nothing and it

153
00:11:59,270 --> 00:12:12,350
is a courtesy so again I was talking

154
00:12:09,710 --> 00:12:15,950
about self Texas that's not viewed as a

155
00:12:12,350 --> 00:12:18,740
real you know threat so looking at what

156
00:12:15,950 --> 00:12:22,190
we found we have this horrible cookie we

157
00:12:18,740 --> 00:12:25,370
know it falling over at that size and we

158
00:12:22,190 --> 00:12:27,350
know that we need to inject that cookie

159
00:12:25,370 --> 00:12:30,800
data into the stream or the cookie jar

160
00:12:27,350 --> 00:12:33,410
so I know that I can do cookie stuffing

161
00:12:30,800 --> 00:12:36,229
yeah so you're not familiar with cookie

162
00:12:33,410 --> 00:12:44,390
stuffing you can trick the browser in a

163
00:12:36,230 --> 00:12:47,150
lot through I plain trickery and

164
00:12:44,390 --> 00:12:49,400
redirect trickery that's we already know

165
00:12:47,150 --> 00:12:52,550
that can happen so I feel like I can

166
00:12:49,400 --> 00:12:54,290
actually use this as a real attack but I

167
00:12:52,550 --> 00:13:01,339
did want to look at it locally as well

168
00:12:54,290 --> 00:13:03,110
since I found it locally you know I

169
00:13:01,340 --> 00:13:05,960
could steal the session token' I can

170
00:13:03,110 --> 00:13:07,550
steal authentication and again other

171
00:13:05,960 --> 00:13:10,190
creative things around injecting

172
00:13:07,550 --> 00:13:12,469
JavaScript so anyway I set out on a

173
00:13:10,190 --> 00:13:14,030
mission to make sure that I could really

174
00:13:12,470 --> 00:13:19,970
use this as an attack up there and steal

175
00:13:14,030 --> 00:13:23,480
my daughter's a call yeah I gave it back

176
00:13:19,970 --> 00:13:25,760
to her it's fine I cookies in the cookie

177
00:13:23,480 --> 00:13:28,880
jar so what happens when you get a

178
00:13:25,760 --> 00:13:31,300
cookie from a website gets stored in

179
00:13:28,880 --> 00:13:33,379
your local cookie jar in the file system

180
00:13:31,300 --> 00:13:35,299
I'll pick on crawl

181
00:13:33,379 --> 00:13:39,769
here Firefox is similar they're all very

182
00:13:35,299 --> 00:13:42,459
similar but you have this local cookie

183
00:13:39,769 --> 00:13:45,529
jar your system I mean are they

184
00:13:42,459 --> 00:13:47,508
encrypted what format is it are you

185
00:13:45,529 --> 00:13:50,109
allowed to write that can you camper

186
00:13:47,509 --> 00:13:50,109
with the cookie

187
00:14:04,009 --> 00:14:08,550
is on the encrypted value which is the

188
00:14:07,050 --> 00:14:10,310
value of the cookie that you get from a

189
00:14:08,550 --> 00:14:13,370
web server

190
00:14:10,310 --> 00:14:30,329
everything else is unencrypted so

191
00:14:13,370 --> 00:14:32,759
time-stamping all the other pieces Linux

192
00:14:30,329 --> 00:14:36,060
we have static key and phonetic salt we

193
00:14:32,759 --> 00:14:39,269
have salty salts to do all this and

194
00:14:36,060 --> 00:14:41,459
again anyone locally can delete and

195
00:14:39,269 --> 00:14:43,470
create cookies in that cookie jar

196
00:14:41,459 --> 00:14:47,790
there's no authentication on the

197
00:14:43,470 --> 00:14:57,269
database model I'm right now chrome does

198
00:14:47,790 --> 00:14:59,189
not check cookies with XSS alert flags

199
00:14:57,269 --> 00:15:04,100
to check the status or integrity of our

200
00:14:59,190 --> 00:15:04,100
cookies at rest and there's no required

201
00:15:16,670 --> 00:15:23,130
so right now we have security only on

202
00:15:20,639 --> 00:15:25,199
the transit of our cookies to check the

203
00:15:23,130 --> 00:15:27,329
integrity but we don't have any flags

204
00:15:25,199 --> 00:15:32,810
for local tampering I'm not checking

205
00:15:27,329 --> 00:15:35,250
that at all so we call the cookie baking

206
00:15:32,810 --> 00:15:37,859
cookie bacon is a technique of creating

207
00:15:35,250 --> 00:15:42,589
or modifying a cookie and a local users

208
00:15:37,860 --> 00:15:42,589
cookie jar and of course on authorize

209
00:15:43,699 --> 00:15:50,490
payloads affiliate tags other fly

210
00:15:47,040 --> 00:15:52,410
streams and payloads and it also

211
00:15:50,490 --> 00:15:55,290
provides this delivery method for our

212
00:15:52,410 --> 00:16:00,000
self XSS here so that we can actually

213
00:15:55,290 --> 00:16:01,740
use it in an attack chain some of the

214
00:16:00,000 --> 00:16:04,319
delivery methods so we can write a

215
00:16:01,740 --> 00:16:07,730
PowerShell script to do this it's a very

216
00:16:04,319 --> 00:16:07,729
small script it's like eight line

217
00:16:09,500 --> 00:16:15,870
of course Boyd module for post

218
00:16:13,350 --> 00:16:18,930
enumeration rubber ducky Crips weed

219
00:16:15,870 --> 00:16:20,760
injectors at the familiar with that and

220
00:16:18,930 --> 00:16:22,800
then we have AMT man in the middle now

221
00:16:20,760 --> 00:16:23,990
and then of course we have keyboard and

222
00:16:22,800 --> 00:16:25,920
mouse hi Jackie

223
00:16:23,990 --> 00:16:28,830
traditional cookie stuffing will be a

224
00:16:25,920 --> 00:16:34,709
little harder maybe so again we'll focus

225
00:16:28,830 --> 00:16:35,970
more on the local so chrome again the

226
00:16:34,710 --> 00:16:38,220
cookies are starting at sequel light

227
00:16:35,970 --> 00:16:40,110
database and your user directory they

228
00:16:38,220 --> 00:16:42,540
can be accessed with these two programs

229
00:16:40,110 --> 00:17:10,980
right here sequel browser sequel a

230
00:16:42,540 --> 00:17:12,420
browser sorry so we're going to we're

231
00:17:10,980 --> 00:17:14,490
going to use a power health threat to

232
00:17:12,420 --> 00:17:15,900
the PS and polite we're actually going

233
00:17:14,490 --> 00:17:18,420
to create a cookie called underscore

234
00:17:15,900 --> 00:17:21,030
epoch s ID this cookie will not be

235
00:17:18,420 --> 00:17:22,980
encrypted I'll just use the no look at

236
00:17:21,030 --> 00:17:25,530
the value and the normal value in the

237
00:17:22,980 --> 00:17:28,860
value field we can actually check this

238
00:17:25,530 --> 00:17:30,930
cookie looking into developer tools or

239
00:17:28,860 --> 00:17:32,850
looking well browser and you can

240
00:17:30,930 --> 00:17:38,700
actually see once you inject this cookie

241
00:17:32,850 --> 00:17:42,199
that they're ready relative if you go to

242
00:17:38,700 --> 00:17:45,090
the website you're going to get this

243
00:17:42,200 --> 00:17:48,080
JavaScript alert box that'll be your

244
00:17:45,090 --> 00:17:51,570
final proof so we'll talk about the

245
00:17:48,080 --> 00:17:55,020
attachment here get access to a Windows

246
00:17:51,570 --> 00:17:59,490
box run PowerShell you do need a admin

247
00:17:55,020 --> 00:18:01,920
for this piece there is the script right

248
00:17:59,490 --> 00:18:03,480
there again eight lines of code number

249
00:18:01,920 --> 00:18:05,880
one we have to kill Chrome it locks the

250
00:18:03,480 --> 00:18:07,560
cookie jar so we got to unlock it we're

251
00:18:05,880 --> 00:18:10,200
going to install the PS equal light

252
00:18:07,560 --> 00:18:13,770
module set execution policy to remote

253
00:18:10,200 --> 00:18:15,870
sign import our library we need for the

254
00:18:13,770 --> 00:18:19,950
sequel light and then just do a simple

255
00:18:15,870 --> 00:18:21,689
insert statement that's it so with the

256
00:18:19,950 --> 00:18:23,040
but that little amount of code you can

257
00:18:21,690 --> 00:18:25,650
actually inject any cook

258
00:18:23,040 --> 00:18:27,899
to your local concern and again you can

259
00:18:25,650 --> 00:18:31,140
delete an existing cookie and replace it

260
00:18:27,900 --> 00:18:33,450
with the orc so if you were say to do

261
00:18:31,140 --> 00:18:35,700
like a phishing campaign using this as a

262
00:18:33,450 --> 00:18:38,220
tap chain you could literally cookie

263
00:18:35,700 --> 00:18:43,440
stuff somebody or cookie bake them with

264
00:18:38,220 --> 00:18:45,810
a session token that's for you or a you

265
00:18:43,440 --> 00:18:48,570
know scooped website the user will log

266
00:18:45,810 --> 00:18:54,600
into it thinking it's theirs and operate

267
00:18:48,570 --> 00:18:56,939
as normal using the DB browser again we

268
00:18:54,600 --> 00:18:58,320
can see in the value field which is like

269
00:18:56,940 --> 00:19:01,920
the fourth one over from the left

270
00:18:58,320 --> 00:19:03,870
there's a script tag in there on the

271
00:19:01,920 --> 00:19:05,670
right the encrypted value is a second

272
00:19:03,870 --> 00:19:08,100
from the right and it will say null in

273
00:19:05,670 --> 00:19:10,130
that column and again that's all you

274
00:19:08,100 --> 00:19:13,530
need to be able to do the cookie baking

275
00:19:10,130 --> 00:19:14,910
opening up Chrome's developer tools we

276
00:19:13,530 --> 00:19:16,260
will also be able to see that at the

277
00:19:14,910 --> 00:19:26,190
guest ID cookie in there with the

278
00:19:16,260 --> 00:19:28,740
malicious payload so when the user they

279
00:19:26,190 --> 00:19:30,030
get that you can validate it through the

280
00:19:28,740 --> 00:19:32,540
source code as well what the payload

281
00:19:30,030 --> 00:19:34,710
looks like and how it breaks the view

282
00:19:32,540 --> 00:19:37,590
from there you can actually write a more

283
00:19:34,710 --> 00:19:45,530
proper payload than to do the session

284
00:19:37,590 --> 00:19:47,970
stealing or the beef hooking so

285
00:19:45,530 --> 00:19:49,320
post-fight here we want to automate this

286
00:19:47,970 --> 00:19:53,250
attack I don't want to have to type all

287
00:19:49,320 --> 00:19:56,129
that out anymore right so I created a

288
00:19:53,250 --> 00:19:58,380
few files here for weaponizing this we

289
00:19:56,130 --> 00:20:02,820
have cookie Baker duck which is a rubber

290
00:19:58,380 --> 00:20:04,860
ducky script my brother poncho Victor

291
00:20:02,820 --> 00:20:08,550
Tai sir over a coal fire wrote something

292
00:20:04,860 --> 00:20:10,350
amazing called death metal it is an T

293
00:20:08,550 --> 00:20:12,540
man in the middle and if you're not

294
00:20:10,350 --> 00:20:14,790
familiar with AMT please go look it up

295
00:20:12,540 --> 00:20:16,379
after this talk and go look at Victor's

296
00:20:14,790 --> 00:20:20,639
research on it he did an amazing job

297
00:20:16,380 --> 00:20:23,340
there Thank You Victor he helped create

298
00:20:20,640 --> 00:20:27,330
another conduit for my attack vector to

299
00:20:23,340 --> 00:20:28,949
work so the cookie Baker dot ps1 is just

300
00:20:27,330 --> 00:20:31,139
the powershell script which again can be

301
00:20:28,950 --> 00:20:34,170
used with Metasploit you can do local

302
00:20:31,140 --> 00:20:36,830
other methods there as well and then

303
00:20:34,170 --> 00:20:39,570
with the weed injector wireless you know

304
00:20:36,830 --> 00:20:41,699
hit device there that does a rubber

305
00:20:39,570 --> 00:20:43,770
ducky I have a script for that as well

306
00:20:41,700 --> 00:20:45,330
and the cool thing about the weed

307
00:20:43,770 --> 00:20:46,770
injector is you can actually take this

308
00:20:45,330 --> 00:20:49,860
thing and plug it inside somebody's

309
00:20:46,770 --> 00:20:51,629
motherboard it creates a hot spot to a

310
00:20:49,860 --> 00:20:54,449
rubber ducky so that you have

311
00:20:51,630 --> 00:20:56,910
persistence so if you can get the rubber

312
00:20:54,450 --> 00:20:59,040
ducky I'm sorry the weed injector on the

313
00:20:56,910 --> 00:21:00,480
motherboard nobody's going to see that

314
00:20:59,040 --> 00:21:05,270
thing and you have persistence to

315
00:21:00,480 --> 00:21:05,270
constantly update some users cookie jar

316
00:21:06,320 --> 00:21:11,669
this is what the ducky script looks like

317
00:21:09,390 --> 00:21:15,230
it's not super complicated since the

318
00:21:11,670 --> 00:21:15,230
PowerShell script again with some delays

319
00:21:20,690 --> 00:21:24,200
and again we saw

320
00:21:22,500 --> 00:21:26,370
earlier that's the powershell script

321
00:21:24,200 --> 00:21:33,090
it's kind of the baseline for the rest

322
00:21:26,370 --> 00:21:35,280
of them and there's the weed injector

323
00:21:33,090 --> 00:21:38,580
script right there so again that's the

324
00:21:35,280 --> 00:21:40,740
wireless HID has a web interface on it

325
00:21:38,580 --> 00:21:45,990
you can upload your code as you need to

326
00:21:40,740 --> 00:21:48,030
and then you close the payload if you

327
00:21:45,990 --> 00:21:49,890
end up finding some new cookies that are

328
00:21:48,030 --> 00:21:52,410
vulnerable that you know these users

329
00:21:49,890 --> 00:21:58,410
actually use you can update them any

330
00:21:52,410 --> 00:22:02,310
time so how do we fix it

331
00:21:58,410 --> 00:22:03,810
is this even a real problem so some of

332
00:22:02,310 --> 00:22:05,940
the difficulties around trying to fix

333
00:22:03,810 --> 00:22:07,740
this is there's confusion around the

334
00:22:05,940 --> 00:22:09,830
browser and how they all handle this

335
00:22:07,740 --> 00:22:11,670
panel it's slightly differently

336
00:22:09,830 --> 00:22:13,860
operating systems are a little bit

337
00:22:11,670 --> 00:22:16,320
different as well again with Linux you

338
00:22:13,860 --> 00:22:20,070
have the static key windows at the DP

339
00:22:16,320 --> 00:22:23,850
API I feel like there's some apathy

340
00:22:20,070 --> 00:22:26,520
around this issue as well where browser

341
00:22:23,850 --> 00:22:29,010
manufacturers and and other folks will

342
00:22:26,520 --> 00:22:31,230
say well users already have the ability

343
00:22:29,010 --> 00:22:33,660
to modify their code locally that's

344
00:22:31,230 --> 00:22:36,180
their fault but we're talking about the

345
00:22:33,660 --> 00:22:37,950
cookie jar which is pretty much a key

346
00:22:36,180 --> 00:22:40,890
vault right I mean we got passwords in

347
00:22:37,950 --> 00:22:43,170
there we have personal information we

348
00:22:40,890 --> 00:22:56,610
have other things that probably should

349
00:22:43,170 --> 00:22:58,440
be a little a little more secure opening

350
00:22:56,610 --> 00:23:00,780
a gun and make sure nothing's been

351
00:22:58,440 --> 00:23:02,190
tampered does anybody do that currently

352
00:23:00,780 --> 00:23:03,720
does anybody actually check their

353
00:23:02,190 --> 00:23:05,630
cookies to make sure they've not been

354
00:23:03,720 --> 00:23:08,400
tampered with

355
00:23:05,630 --> 00:23:10,970
negative is there a reason we're not

356
00:23:08,400 --> 00:23:10,970
touching that

357
00:23:13,860 --> 00:23:20,350
so I'm very excited about trying to find

358
00:23:17,820 --> 00:23:23,169
your like these are important we're not

359
00:23:20,350 --> 00:23:24,899
gonna they're not going anywhere but we

360
00:23:23,170 --> 00:23:28,540
need to do something

361
00:23:24,900 --> 00:23:33,120
so again checking the integrity maybe we

362
00:23:28,540 --> 00:23:33,120
can do a browser plug-in maybe an app

363
00:23:45,090 --> 00:23:49,959
the weather that was the browser that's

364
00:23:48,280 --> 00:23:52,420
there you know play

365
00:23:49,960 --> 00:23:55,450
I'm shouldn't be in there either that's

366
00:23:52,420 --> 00:23:56,740
my abilities yeah so maybe Google can

367
00:23:55,450 --> 00:23:59,740
tap and protect that thing a little

368
00:23:56,740 --> 00:24:06,670
better encrypted better or maybe we use

369
00:23:59,740 --> 00:24:08,080
something more than people like pop so I

370
00:24:06,670 --> 00:24:10,420
went down this path of responsible

371
00:24:08,080 --> 00:24:12,040
disclosure and this is the way I

372
00:24:10,420 --> 00:24:15,190
normally do it I use also enter to

373
00:24:12,040 --> 00:24:16,899
Google find the best contact and I

374
00:24:15,190 --> 00:24:20,050
usually all reach out directly to who I

375
00:24:16,900 --> 00:24:23,200
feel is the appropriate person and

376
00:24:20,050 --> 00:24:26,020
that's just from experience and working

377
00:24:23,200 --> 00:24:27,910
the industry for 25 plus years and so

378
00:24:26,020 --> 00:24:30,639
far I've been pretty lucky was hitting

379
00:24:27,910 --> 00:24:32,500
the right ball to that so I sent out an

380
00:24:30,640 --> 00:24:34,930
email directly to the company and then I

381
00:24:32,500 --> 00:24:39,010
also went look for the bug bounty that

382
00:24:34,930 --> 00:24:41,200
were behind me I ended up finding open

383
00:24:39,010 --> 00:24:42,640
bug bounty here and submitting my

384
00:24:41,200 --> 00:24:46,240
vulnerabilities with them to come back

385
00:24:42,640 --> 00:24:47,860
in December I provided all the detailed

386
00:24:46,240 --> 00:24:50,160
information about the vulnerabilities

387
00:24:47,860 --> 00:24:55,449
the document on the right there is a

388
00:24:50,160 --> 00:24:57,250
comical way that I used to submit this

389
00:24:55,450 --> 00:24:59,140
to Google I didn't wanted to send them

390
00:24:57,250 --> 00:25:00,700
some boring thing I kind of wanted to

391
00:24:59,140 --> 00:25:03,270
hype it up a little bit so I made this

392
00:25:00,700 --> 00:25:05,380
PDF that look like an old newspaper

393
00:25:03,270 --> 00:25:10,300
declaring that we can weaponize sell

394
00:25:05,380 --> 00:25:13,180
that that does know Google responded

395
00:25:10,300 --> 00:25:15,760
within one day you are correct

396
00:25:13,180 --> 00:25:18,990
XSS auditor does not detect a loading

397
00:25:15,760 --> 00:25:18,990
cookie nor are there plan

398
00:25:25,299 --> 00:25:30,549
right in the wild sound they put an

399
00:25:28,480 --> 00:25:34,059
embargo on my report restricted access

400
00:25:30,549 --> 00:25:37,570
to it and then they exposed it instantly

401
00:25:34,059 --> 00:25:38,110
where they wanted so maybe this isn't a

402
00:25:37,570 --> 00:25:39,428
problem

403
00:25:38,110 --> 00:25:44,889
maybe I'm full of you don't need to

404
00:25:39,429 --> 00:25:47,830
look at me um the open bug bounty an

405
00:25:44,889 --> 00:25:50,649
epic game so I got an email back from

406
00:25:47,830 --> 00:25:52,960
open bug bounty about yes they were

407
00:25:50,649 --> 00:25:57,609
doing the program and I needed to give

408
00:25:52,960 --> 00:25:59,489
them more information I never heard back

409
00:25:57,609 --> 00:26:02,080
after I gave him all the information I

410
00:25:59,489 --> 00:26:04,480
hadn't heard back from up epic games

411
00:26:02,080 --> 00:26:08,129
either I didn't get a reply not sure if

412
00:26:04,480 --> 00:26:10,629
I sent that email to the correct person

413
00:26:08,129 --> 00:26:13,269
but it looks like hacker one is doing

414
00:26:10,629 --> 00:26:15,699
the bug bounty paretic now I did see

415
00:26:13,269 --> 00:26:16,840
that recently and I'm not sure if they

416
00:26:15,700 --> 00:26:18,249
were originally doing it because I

417
00:26:16,840 --> 00:26:21,970
didn't see their name out there for that

418
00:26:18,249 --> 00:26:23,289
so maybe I didn't put enough work into

419
00:26:21,970 --> 00:26:26,909
figuring out who is running their bug

420
00:26:23,289 --> 00:26:29,590
bounty but I got no cookie

421
00:26:26,909 --> 00:26:33,840
yeah tonight one of those cookies

422
00:26:29,590 --> 00:26:33,840
actually like you know one left all huh

423
00:26:34,470 --> 00:26:41,159
now I can get a cookie I think thank you

424
00:26:39,340 --> 00:26:43,928
really

425
00:26:41,159 --> 00:26:47,169
we're busy like I do this is a full-time

426
00:26:43,929 --> 00:26:49,379
job so when I do things on the side or

427
00:26:47,169 --> 00:26:51,909
as a hobby I can't spend much time

428
00:26:49,379 --> 00:26:54,399
trying to help remediate some company I

429
00:26:51,909 --> 00:26:56,289
don't work for it so all I would ask is

430
00:26:54,399 --> 00:26:58,449
that the companies make this a little

431
00:26:56,289 --> 00:27:00,999
easier for us make this a little bit

432
00:26:58,450 --> 00:27:03,909
more of a streamlined process again I

433
00:27:00,999 --> 00:27:06,480
disclose it back in December never got

434
00:27:03,909 --> 00:27:06,480
any response

435
00:27:33,440 --> 00:27:42,920
so here is where we're going to talk

436
00:27:35,910 --> 00:27:46,380
about other tools or somebody else's I

437
00:27:42,920 --> 00:27:48,870
like to use things on both sides of the

438
00:27:46,380 --> 00:27:50,970
fence when I find an instructor a

439
00:27:48,870 --> 00:27:54,810
greater payload I like to instantly

440
00:27:50,970 --> 00:27:57,240
preview for it it makes for a better cat

441
00:27:54,810 --> 00:28:02,970
mounting although I was boring is that

442
00:27:57,240 --> 00:28:05,010
when we throw it out there and so I

443
00:28:02,970 --> 00:28:07,290
called it kooky honker I distribute it

444
00:28:05,010 --> 00:28:08,700
goes out you know what you sublunary or

445
00:28:07,290 --> 00:28:12,060
some other hosts and ways of finding

446
00:28:08,700 --> 00:28:15,540
subdomains and it will give me Tori all

447
00:28:12,060 --> 00:28:17,730
the cookies on your cookie tosser will

448
00:28:15,540 --> 00:28:19,800
then allow you to log in to one of the

449
00:28:17,730 --> 00:28:22,650
sites is going make that session is

450
00:28:19,800 --> 00:28:24,930
spray it across again the entire domain

451
00:28:22,650 --> 00:28:28,380
space here so if you do this quite

452
00:28:24,930 --> 00:28:30,750
Twitter or Facebook really just all go

453
00:28:28,380 --> 00:28:33,030
you can use selenium for this login

454
00:28:30,750 --> 00:28:35,220
through Facebook and then you use that

455
00:28:33,030 --> 00:28:39,060
same token and bring it across entire

456
00:28:35,220 --> 00:28:46,740
beat can you log into some weird stuff

457
00:28:39,060 --> 00:28:51,030
yeah get a lot of use out of that you

458
00:28:46,740 --> 00:28:54,410
actually have so these kind of tools

459
00:28:51,030 --> 00:29:00,930
will help show across entire domain

460
00:28:54,410 --> 00:29:03,390
vulnerability some other data points and

461
00:29:00,930 --> 00:29:06,390
then cookie paladin gonna check the

462
00:29:03,390 --> 00:29:09,750
integrity of this dark dot we have no

463
00:29:06,390 --> 00:29:11,460
idea so it's going to create some type

464
00:29:09,750 --> 00:29:13,860
of fingerprint of the cookie jar and

465
00:29:11,460 --> 00:29:20,040
then also do some monitor on it keep

466
00:29:13,860 --> 00:29:22,530
track and maybe up again the blue team

467
00:29:20,040 --> 00:29:24,420
side we have digital put grenadine and

468
00:29:22,530 --> 00:29:27,720
asset management with that security

469
00:29:24,420 --> 00:29:30,150
auditing and help you minimize risk the

470
00:29:27,720 --> 00:29:31,830
red side can you simplify and explore

471
00:29:30,150 --> 00:29:34,140
your cookies across oh come on don't

472
00:29:31,830 --> 00:29:36,060
mean quickly and of course around like

473
00:29:34,140 --> 00:29:39,240
an internal test and you end up hitting

474
00:29:36,060 --> 00:29:40,980
VA it straight across the domain once

475
00:29:39,240 --> 00:29:44,900
you have that and create resistance

476
00:29:40,980 --> 00:29:44,900
actually prove a scalp

477
00:29:48,820 --> 00:30:04,939
just reiterating here refugees is the

478
00:30:01,759 --> 00:30:14,350
leader again getting inside the box is

479
00:30:04,940 --> 00:30:17,989
better more more than like one way to

480
00:30:14,350 --> 00:30:20,959
create a database initially over every

481
00:30:17,989 --> 00:30:22,700
known vulnerability that you can and put

482
00:30:20,960 --> 00:30:24,619
it into the payroll this otherwise you

483
00:30:22,700 --> 00:30:27,259
can be targeted again we find one on

484
00:30:24,619 --> 00:30:42,080
Epic Games calm we can just stop that

485
00:30:27,259 --> 00:30:44,869
pokey but it'd be better to you can you

486
00:30:42,080 --> 00:30:46,879
be let's say so this is one of the

487
00:30:44,869 --> 00:30:49,939
things I did is my daughter is I made a

488
00:30:46,879 --> 00:30:52,248
custom DLC pop up with beef that said

489
00:30:49,940 --> 00:30:54,499
you can get more applause dancing if you

490
00:30:52,249 --> 00:30:57,590
click here and then that gave me a

491
00:30:54,499 --> 00:30:59,149
Metasploit show so it's really not that

492
00:30:57,590 --> 00:31:04,519
hard to get people to click on these

493
00:30:59,149 --> 00:31:11,449
boxes again blue team this to reiterate

494
00:31:04,519 --> 00:31:14,799
here as well opening up again checking

495
00:31:11,450 --> 00:31:21,440
the cookies all the time in the browser

496
00:31:14,799 --> 00:31:23,658
there I'm rather know trying to get it

497
00:31:21,440 --> 00:31:29,149
this stuff before they get the real

498
00:31:23,659 --> 00:31:32,749
stuff well this is anybody's and not

499
00:31:29,149 --> 00:31:34,758
alert you to that and again maybe we

500
00:31:32,749 --> 00:31:37,149
shouldn't rely on local cookies for

501
00:31:34,759 --> 00:31:46,429
authentication or storage of information

502
00:31:37,149 --> 00:31:51,969
yeah and again Oh Center on this there's

503
00:31:46,429 --> 00:31:57,530
a couple websites their sense of style

504
00:31:51,970 --> 00:32:01,190
Google as well and you can find actually

505
00:31:57,530 --> 00:32:04,610
go find where Alton yes leave use the

506
00:32:01,190 --> 00:32:13,490
other domain other company they share

507
00:32:04,610 --> 00:32:17,750
the same brain I used to do a lot of

508
00:32:13,490 --> 00:32:21,170
work in a camp I like this just made me

509
00:32:17,750 --> 00:32:23,060
realize I mean somebody started cooking

510
00:32:21,170 --> 00:32:26,840
making affiliate ads out there they

511
00:32:23,060 --> 00:32:34,700
probably would make mine yeah time it

512
00:32:26,840 --> 00:32:37,129
incentive for us is victory and I'm

513
00:32:34,700 --> 00:32:39,080
gonna do a demo here yeah so this is the

514
00:32:37,130 --> 00:32:41,750
last slide but I'm actually gonna do a

515
00:32:39,080 --> 00:32:44,389
quick demo okay and we're gonna see

516
00:32:41,750 --> 00:32:48,940
there were two domains I disclosed one

517
00:32:44,390 --> 00:32:48,940
was Epic Games calm and the other

518
00:33:07,140 --> 00:33:15,620
it looks like my internet from Chester

519
00:33:10,380 --> 00:33:15,620
is down Chester was your internet

520
00:33:16,400 --> 00:33:28,650
cricket

521
00:33:17,640 --> 00:33:34,309
I will try here hey homeless he's got

522
00:33:28,650 --> 00:33:34,309
his hot spot on thank you sir

523
00:33:38,240 --> 00:34:30,330
bear with me sorry alright thank you for

524
00:34:14,280 --> 00:34:33,179
that preciate you alright

525
00:34:30,330 --> 00:34:38,219
so we're actually gonna do a quick run

526
00:34:33,179 --> 00:34:40,560
of the script here again - one was put

527
00:34:38,219 --> 00:34:48,388
the payload in front of the arena hope

528
00:34:40,560 --> 00:34:51,659
you value we will have a holder that

529
00:34:48,389 --> 00:34:53,369
gets created here and then we will have

530
00:34:51,659 --> 00:34:56,520
a browser open when I hit this button

531
00:34:53,369 --> 00:35:01,250
so go ahead button and almost cookie

532
00:34:56,520 --> 00:35:01,250
starting makes our output directory here

533
00:35:04,220 --> 00:35:12,149
let's slide this

534
00:35:05,760 --> 00:35:31,290
a little bit looks like this internet

535
00:35:12,150 --> 00:36:13,110
might be a little slow seeing Chester is

536
00:35:31,290 --> 00:36:39,180
your internet up as well I love you all

537
00:36:13,110 --> 00:36:43,520
right thank you for your patience it's a

538
00:36:39,180 --> 00:36:43,520
little slow as well let's see yeah

539
00:36:44,240 --> 00:36:49,399
you're right Joe boo

540
00:37:02,599 --> 00:37:06,800
damos Oh No

541
00:37:04,820 --> 00:37:10,480
yo boo we don't have jobs with us here

542
00:37:06,800 --> 00:37:12,950
in a fried-chicken no it's good

543
00:37:10,480 --> 00:37:14,750
so I'll just kind of talk through this

544
00:37:12,950 --> 00:37:16,270
real quick so this is clearly not going

545
00:37:14,750 --> 00:37:20,860
to work I tried

546
00:37:16,270 --> 00:37:20,860
sorry demo guys I failed you

547
00:37:41,559 --> 00:37:44,950
look like that

548
00:37:45,369 --> 00:37:49,579
but that is current right now so I

549
00:37:47,599 --> 00:37:51,440
publicly discloses or privately

550
00:37:49,579 --> 00:37:55,640
disclosed it back in December and on

551
00:37:51,440 --> 00:37:57,079
that date so I'm not sure how we move

552
00:37:55,640 --> 00:37:58,879
forward with all this blog Bonnie stop

553
00:37:57,079 --> 00:38:01,880
and responsible disclosure and whatnot

554
00:37:58,880 --> 00:38:06,319
but again December this was disclosed

555
00:38:01,880 --> 00:38:09,319
today it's still rut ro go back here

556
00:38:06,319 --> 00:38:10,999
then thank you guys for your time if you

557
00:38:09,319 --> 00:38:13,549
have any follow-up questions well I'll

558
00:38:10,999 --> 00:38:46,848
stick around for that here my contact is

559
00:38:13,549 --> 00:38:50,980
both so thank you for everything you've

560
00:38:46,849 --> 00:38:50,980
done for me here and I'm proud to be

561
00:38:52,830 --> 00:38:58,389
[Applause]

