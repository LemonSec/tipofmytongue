1
00:03:19,200 --> 00:04:00,620
that's a mean way in testing testing
testing that working up higher as I

2
00:04:00,620 --> 00:04:06,140
guess alright it's at 11 I'll tell all
talk louder

3
00:04:10,670 --> 00:04:18,289
will quadruple its territory also pretty
get alright and welcome to our talk my

4
00:04:18,290 --> 00:04:23,620
name is Josh stone and this is Patrick
Russell we r penetration testers company

5
00:04:23,620 --> 00:04:29,729
called PSC we mostly do PCI assessments
there occasionally we do dip into other

6
00:04:29,729 --> 00:04:35,719
contacts and today we're talking about
penetration testing penetration testing

7
00:04:35,720 --> 00:04:40,430
has a lot of different contexts and
shades of meaning these days usually if

8
00:04:40,430 --> 00:04:45,030
you look at most industry methodologies
architecture class you'll find that

9
00:04:45,030 --> 00:04:49,200
penetration testing look something like
this has some sort of identification of

10
00:04:49,200 --> 00:04:53,030
the resources that are available to us
to try to see if they're gonna abilities

11
00:04:53,030 --> 00:04:59,388
their exploits and see where it leads us
unfortunately and something I feel like

12
00:04:59,389 --> 00:05:03,160
we have to mention here is that there
are lots of situations in our industry

13
00:05:03,160 --> 00:05:09,419
now where penetration test looks a
little bit more like this and just there

14
00:05:09,419 --> 00:05:12,139
it's a good service is good to find
vulnerabilities and verify that their

15
00:05:12,139 --> 00:05:15,979
true but it's not really a penetration
test what we're talking about and

16
00:05:15,979 --> 00:05:20,070
penetration testing and especially in
compliance focused on tests like a PCI

17
00:05:20,070 --> 00:05:24,320
scenario we're talking about a situation
where there is some

18
00:05:24,320 --> 00:05:29,270
identifiable objective there's a success
criteria that allows us to answer an

19
00:05:29,270 --> 00:05:35,409
important question with 10 tests so in
our case and we're doing PCI pen test

20
00:05:35,410 --> 00:05:40,480
the question is is the cardholder data
safe if somebody and truths and breaches

21
00:05:40,480 --> 00:05:45,830
the internal network so if we don't get
hold of the cardholder data or access

22
00:05:45,830 --> 00:05:50,300
the environment that processes it then
even if we pack some stuff it doesn't

23
00:05:50,300 --> 00:05:55,230
necessarily mean that there's a problem
as far as a PCI data and turns out in

24
00:05:55,230 --> 00:05:59,940
most RealNetworks there's something to
hack somewhere in the big question

25
00:05:59,940 --> 00:06:05,440
that's actually valuable is can someone
do something damaging the things that

26
00:06:05,440 --> 00:06:09,860
were most concerned about are they at
risk in an intrusion so

27
00:06:10,889 --> 00:06:19,400
along that vein or talking about today
his is more of a examples from the

28
00:06:19,400 --> 00:06:24,818
trenches as it were several scenarios
from real pain tests or aggregated

29
00:06:24,819 --> 00:06:31,539
examples from multiple real Penn tests
to highlight some strategies that we use

30
00:06:31,539 --> 00:06:32,789
in that process

31
00:06:32,789 --> 00:06:35,580
you know it's not just about going for
your five phases of pen testing and

32
00:06:35,580 --> 00:06:39,330
write a report the point is you keep
going within the time that you have

33
00:06:39,330 --> 00:06:46,109
available to find that success criteria
get those crown jewels so we're not

34
00:06:46,110 --> 00:06:51,500
talking about today we're not talking
about 20 days you have some spectacular

35
00:06:51,500 --> 00:06:55,539
vulnerability or not even really talking
about the tools we're talking about is

36
00:06:55,539 --> 00:06:59,669
the strategy or the technique and the
mental approach you were using to work

37
00:06:59,669 --> 00:07:02,930
our way through a big network this
should be relevant to you if you're a

38
00:07:02,930 --> 00:07:07,219
pen tester or also if you're a defender
argues that from the defense point of

39
00:07:07,219 --> 00:07:10,270
view what I find is a lot of the things
that really pan out for us especially if

40
00:07:10,270 --> 00:07:12,560
you're doing your patching and
vulnerability scanning and other

41
00:07:12,560 --> 00:07:17,719
assorted hygienic processes in your
network they're still all this other

42
00:07:17,719 --> 00:07:21,870
stuff it's useful to Manchester that
kinda never really gets fixed in your

43
00:07:21,870 --> 00:07:26,789
disclosing lots of information that we
can use that turned out quite handy so

44
00:07:26,789 --> 00:07:30,810
hop in 24 scenario that when Patrick
will do so handed over

45
00:07:31,590 --> 00:07:42,599
there isn't a way that you might rain
event ester or if you were to do Google

46
00:07:42,600 --> 00:07:46,920
colleges yet quite a few results

47
00:07:46,920 --> 00:07:54,060
think one of the things that just sort
of put into a little bit that he make it

48
00:07:54,060 --> 00:08:01,700
doesn't process seemed very linear
something you move on the problem with

49
00:08:01,700 --> 00:08:06,070
this is that in reality the things you
do in a pinch destined to repeat

50
00:08:06,070 --> 00:08:11,050
themselves or degrade organic situation
so for example one of the first things

51
00:08:11,050 --> 00:08:17,520
you might see any methodology involves
getting an enumeration right so you can

52
00:08:17,520 --> 00:08:23,130
or or resolving its neighbors something
this might be something that you do want

53
00:08:23,130 --> 00:08:27,370
but more than likely something maybe the
exploitation you put the quotation if

54
00:08:27,370 --> 00:08:32,060
you continue to build a picture of the
network so just for example maybe it you

55
00:08:32,059 --> 00:08:37,599
begin to test you do run some sort of
this or what can I see your where am I

56
00:08:37,600 --> 00:08:41,360
and maybe something this kind of
ambiguous you're in the user network and

57
00:08:41,360 --> 00:08:45,400
there's a server network somewhere but
don't really know as the contest

58
00:08:45,400 --> 00:08:51,910
progresses the dentist dresses that
might break down you start to see we're

59
00:08:51,910 --> 00:08:56,550
certainly there's our son to certain
segments or something something along

60
00:08:56,550 --> 00:08:59,620
those lines get a much better deal for
for what goes where

61
00:09:01,620 --> 00:09:04,710
so one of the

62
00:09:05,930 --> 00:09:11,930
things you really want to do with that
information together to get it to get a

63
00:09:11,930 --> 00:09:13,760
better feel for

64
00:09:13,760 --> 00:09:19,900
information to get a better feel for how
you might use it during the pen test the

65
00:09:19,900 --> 00:09:23,560
remote does how does one of the services
I think it's barely open to the network

66
00:09:23,560 --> 00:09:33,329
and really make it and what is network
but one of the things you might you

67
00:09:33,330 --> 00:09:36,450
might notice are you might not realize
it initially about remote desktop is

68
00:09:36,450 --> 00:09:41,150
actually can have some information
israelis so their users are you can do

69
00:09:41,150 --> 00:09:46,020
this session you connect to it as well
we'll see that when you log into it I

70
00:09:46,020 --> 00:09:54,380
see their their Active Directory domain
name username and keep that might reduce

71
00:09:54,380 --> 00:09:58,390
second another another piece of
information we might see as we start up

72
00:09:58,390 --> 00:10:04,650
in test is the main gripe DNS can give
us a really good feel for what the

73
00:10:04,650 --> 00:10:14,490
network they the name might be very
early period of my very descriptive I

74
00:10:14,490 --> 00:10:19,670
see things like this he wanted dc2 may
be a sequel database server one so it

75
00:10:19,670 --> 00:10:22,670
gives you a feel for what are these
systems and what do they do

76
00:10:26,320 --> 00:10:32,750
you might see is that users might be
associated with specific system dry and

77
00:10:32,750 --> 00:10:36,670
when we resolve these names we can tell
these hoes are sitting in some places

78
00:10:36,670 --> 00:10:43,000
and they belong to the users but as we
go back and take a look at the remote

79
00:10:43,000 --> 00:10:44,130
desktop session

80
00:10:44,130 --> 00:10:47,950
Remote Desktop not be may not be a great
place to log into a hundred per session

81
00:10:47,950 --> 00:10:53,350
and try to name but if we put it
together with the DNS names now we have

82
00:10:53,350 --> 00:10:59,120
a feel for what is the username
convention cut and grab and now we have

83
00:10:59,120 --> 00:11:02,970
a user list that we can use to do
something like build a house for basic

84
00:11:02,970 --> 00:11:05,970
technique that directory

85
00:11:09,550 --> 00:11:15,880
it's worth noting too if you think about
it there's no no using it no sessions on

86
00:11:15,880 --> 00:11:19,990
the domain controller we don't have to
find that there's no authentication for

87
00:11:19,990 --> 00:11:24,200
the internet or something like that so
we can find user names these kinds of

88
00:11:24,200 --> 00:11:28,329
operations voters are quite fun and for
this scenario we move into the the

89
00:11:28,329 --> 00:11:33,810
second example which is we've now gotten
that list of usernames and we check to

90
00:11:33,810 --> 00:11:38,719
see if anybody has about ask you might
think well if it's a small network and

91
00:11:38,720 --> 00:11:41,140
he's going to have password with a
capital P

92
00:11:41,140 --> 00:11:47,220
but actually as your user population
tends to infinity you definitely have

93
00:11:47,220 --> 00:11:51,450
somebody somewhere the password of
password one and so here and in this

94
00:11:51,450 --> 00:11:55,910
example we've gotten the password for
joe shmoe and as we might expect looking

95
00:11:55,910 --> 00:11:59,949
at the name were thinking it's really
unlikely that Joe Schmo is an

96
00:11:59,950 --> 00:12:04,600
interesting user at least something so
we can check against a domain and find

97
00:12:04,600 --> 00:12:08,880
out what kind of user is he will just
mail is only in the domain users group

98
00:12:08,880 --> 00:12:12,670
and this is one of those cases where a
lot of times if I was talking to the

99
00:12:12,670 --> 00:12:16,649
client they would say well all you have
is a regular user that's not very

100
00:12:16,649 --> 00:12:20,079
powerful they can't do anything in our
network no administrative rights nothing

101
00:12:20,079 --> 00:12:22,160
but as a pen tester

102
00:12:22,160 --> 00:12:27,170
where are we in the pen test and the
question we have to ask ourselves most

103
00:12:27,170 --> 00:12:32,229
importantly is what does domain users
actually get us what value is there in

104
00:12:32,230 --> 00:12:33,579
this user

105
00:12:33,579 --> 00:12:38,290
borrowing concept that I ran into your
presentation however flake a couple

106
00:12:38,290 --> 00:12:42,790
years ago he talked about the compromise
boundary and the compromise boundary for

107
00:12:42,790 --> 00:12:47,040
a hacker is the set of all the things
that you control or the things you could

108
00:12:47,040 --> 00:12:49,230
control given what you have

109
00:12:49,230 --> 00:12:53,500
and what we've done in the pen test is
we found an initial entry point and

110
00:12:53,500 --> 00:12:59,460
we've gone now from nothing to something
and something isn't everything but it's

111
00:12:59,460 --> 00:13:05,400
still a lot closer than where we were
right so even though we really wish joe

112
00:13:05,400 --> 00:13:08,530
shmoe is a schema admin that would be
awesome

113
00:13:08,530 --> 00:13:15,089
the fact that he doesn't control systems
is sad but he actually has access to a

114
00:13:15,090 --> 00:13:18,210
lot of things in the domain and the
thing we're going to focus on right now

115
00:13:18,210 --> 00:13:25,250
is when you look at a typical network
there are lots of files but some files

116
00:13:25,250 --> 00:13:29,380
are much more interesting than other
ones here a couple examples of some

117
00:13:29,380 --> 00:13:33,310
files that have credentials embedded in
them and then there would be other

118
00:13:33,310 --> 00:13:36,650
examples of interesting files I had two
occasions in the last couple of years

119
00:13:36,650 --> 00:13:41,870
actually found VMware disk images that
were on an open shared an open chair but

120
00:13:41,870 --> 00:13:46,430
a share that an authenticated user can
access and from there I can extract

121
00:13:46,430 --> 00:13:50,880
password hashes they're all kinds of
wonderful things that you find in the be

122
00:13:50,880 --> 00:13:55,480
file environment in your typical
corporate network and so I'm going to be

123
00:13:55,480 --> 00:14:04,790
particularly interested in finding out
what joe shmoe has access to so in a

124
00:14:04,790 --> 00:14:09,310
typical small environment and we've got
a few tens of users or something like

125
00:14:09,310 --> 00:14:12,849
that there are only about thousands of
files to think about

126
00:14:12,850 --> 00:14:16,120
is this something I can go through
probably in an afternoon might take me a

127
00:14:16,120 --> 00:14:20,470
couple hours to go through all their
shares and see what joseph has access to

128
00:14:20,470 --> 00:14:25,819
you that's no big deal but as we scale
this 202 enterprise we've got tens of

129
00:14:25,819 --> 00:14:31,180
thousands or more users this becomes a
very intractable problem for the pen

130
00:14:31,180 --> 00:14:36,339
tester we're not talking about thousands
of files were probably talking about

131
00:14:36,339 --> 00:14:41,269
thousands of shares in each of those
could have thousands of files and I just

132
00:14:41,269 --> 00:14:44,800
don't have the time to go through
millions of files to find that one

133
00:14:44,800 --> 00:14:50,899
that's cool so how many do this I can't
use manual techniques I can't grab a

134
00:14:50,899 --> 00:14:55,110
windows box and rapidshare clicking
through there will absolutely kill me

135
00:14:55,110 --> 00:14:59,050
and then there are some other options
are there has to be clients and those

136
00:14:59,050 --> 00:15:03,769
worked fine the SMB client tool that
comes with some but has a recursive

137
00:15:03,769 --> 00:15:07,430
feature so I I could in principle spider
the shares with that or something

138
00:15:07,430 --> 00:15:11,329
get back a good body of information it's
inconvenient though because the

139
00:15:11,329 --> 00:15:17,339
recursion behavior and the way as it
does that is inconvenient for me it'll

140
00:15:17,339 --> 00:15:22,779
get bogged down in these ginormous
shares that it'll get stuck on backup

141
00:15:22,779 --> 00:15:29,029
share or something that has a billion
DAT files has never come back so I'm not

142
00:15:29,029 --> 00:15:32,709
the only guy has ever done this but I
put together a tool some years ago

143
00:15:32,709 --> 00:15:36,439
called plunder because I was just so
frustrated with only being able to look

144
00:15:36,439 --> 00:15:39,360
at a few shares and knowing there's all
this stuff out there that I haven't

145
00:15:39,360 --> 00:15:45,050
already gotten so what this looks like
but focus not so much on the tool that

146
00:15:45,050 --> 00:15:50,029
focus on the idea first week and the
network we find ourselves a bunch of SMP

147
00:15:50,029 --> 00:15:55,220
servers formulate that as an input to
the plunder it just takes SMB URLs as

148
00:15:55,220 --> 00:15:58,880
input and it'll perform whatever action
we instructed to you

149
00:15:58,880 --> 00:16:04,079
given that input and then we run plunder
against a whole lot of systems and this

150
00:16:04,079 --> 00:16:04,920
is an example

151
00:16:04,920 --> 00:16:08,959
running against about seven hundred
different shares with five threads are

152
00:16:08,959 --> 00:16:13,949
under thirty threads successfully
indexed networks as large as like

153
00:16:13,949 --> 00:16:17,378
eighteen million files i get i get the
Joe Schmo user

154
00:16:17,379 --> 00:16:21,849
and in a couple hours I can get a list
of all eighteen million files that he

155
00:16:21,849 --> 00:16:27,069
can get to and that body of information
is tremendously useful because what was

156
00:16:27,069 --> 00:16:35,659
a manual process is now a tractable post
analysis situation so typical result

157
00:16:35,659 --> 00:16:39,979
would be something like this I get a
whole bunch of files back just lists of

158
00:16:39,979 --> 00:16:44,970
all the files you can access and I got
over 300 web config files everybody know

159
00:16:44,970 --> 00:16:47,360
what's in a config file

160
00:16:47,360 --> 00:16:51,910
what are the odds that at least one of
these three hundred files has a database

161
00:16:51,910 --> 00:16:56,920
credential that's probably going to be
essay or maybe it has a service account

162
00:16:56,920 --> 00:17:02,339
for Active Directory or something like
that but it was funny as it now is

163
00:17:02,339 --> 00:17:06,110
scaled up and got any information about
the files I have access to but I still

164
00:17:06,109 --> 00:17:10,089
have a difficult problem and that is it
could take me all day to download 300

165
00:17:10,089 --> 00:17:14,849
web config files and look through them
so plunder also has a download and

166
00:17:14,849 --> 00:17:19,530
mirroring capability so that I can take
that list of URLs that I got from the

167
00:17:19,530 --> 00:17:23,319
spiders can and run it right back
through and have it now it'll create a

168
00:17:23,319 --> 00:17:28,319
local directory tree that mirrors the
network file system and pull this finals

169
00:17:28,319 --> 00:17:33,820
down for me and I can just use a
recursive grab me the credentials so

170
00:17:33,820 --> 00:17:38,700
before you think well that's kind of you
know my network wouldn't ever have that

171
00:17:38,700 --> 00:17:39,820
problem

172
00:17:39,820 --> 00:17:45,200
the fact is every network I've ever been
to accept 425 found something that I

173
00:17:45,200 --> 00:17:49,520
shouldn't have had access to files here
it might be this situation where I've

174
00:17:49,520 --> 00:17:54,870
got a an unprivileged user and I can
escalate privileges or it might even be

175
00:17:54,870 --> 00:17:58,909
a case where I've got an administrative
user and i can get information that

176
00:17:58,910 --> 00:18:03,679
leads me outside the domain so I can get
access to the network devices or I can

177
00:18:03,679 --> 00:18:07,419
get access to the UNIX environment or
the mainframe or something like that and

178
00:18:07,419 --> 00:18:11,480
this turns out to be a tremendously
valuable strategy for pulling this

179
00:18:11,480 --> 00:18:16,790
information out of network when I've
only got a week so that will happen to

180
00:18:16,790 --> 00:18:17,460
you

181
00:18:17,460 --> 00:18:28,410
number three alright so probably go
based in Chester Taylor in apt I pen

182
00:18:28,410 --> 00:18:32,929
test and we have this concept of both
security network and high security

183
00:18:32,929 --> 00:18:37,970
network and typically we expected that
we can execute the pen test from the

184
00:18:37,970 --> 00:18:41,809
perspective of floristry networking
trying to gain access to that are

185
00:18:41,809 --> 00:18:47,160
securities that can take lots of
different forms I think this this goes

186
00:18:47,160 --> 00:18:52,260
out to two different ways of doing this
however most common we see that this is

187
00:18:52,260 --> 00:18:55,280
a a network segmentation boundary summer
long

188
00:18:55,929 --> 00:19:04,259
traffic now sometimes you might say that
there's a maybe a handful of services

189
00:19:04,259 --> 00:19:08,809
maybe there's an application expose but
I think more common than we think of

190
00:19:08,809 --> 00:19:13,850
this as a strict should be there should
be no services child having directly

191
00:19:13,850 --> 00:19:19,649
between however we know that somebody in
the storage area network is probably

192
00:19:19,649 --> 00:19:24,369
accessing the high street network maybe
it is again he's access to medication or

193
00:19:24,369 --> 00:19:27,369
people who are administering the network
at some point somebody moving between

194
00:19:27,369 --> 00:19:30,769
the two probably not walking their
laptop over two different every time

195
00:19:30,769 --> 00:19:36,159
they need to do something then one thing
to keep in mind especially with a

196
00:19:36,159 --> 00:19:40,119
network Ten's grow in size when we have
these tricks occupation boundaries

197
00:19:40,119 --> 00:19:45,209
something is going to further naturally
evolved from that is the increase in and

198
00:19:45,210 --> 00:19:49,679
the complexity of administering the
network because we have to interact with

199
00:19:49,679 --> 00:19:52,940
it in different ways to think about how
we're going to make changes the system

200
00:19:52,940 --> 00:19:57,720
to make sure that they're up to date or
whatever the challenges so what happens

201
00:19:57,720 --> 00:20:01,759
is you may start with something that
looks like this and you have a 38 a

202
00:20:01,759 --> 00:20:06,289
secure network but what it ends up
looking like something like that so we

203
00:20:06,289 --> 00:20:11,210
called it something temporary leave
nothing permanent and you forget about

204
00:20:11,210 --> 00:20:18,879
them and they they stay around forever
so in this scenario what we're thinking

205
00:20:18,879 --> 00:20:27,809
about getting a numeration we gain some
initial access the network already we've

206
00:20:27,809 --> 00:20:34,129
found a complete user but we found some
da crowd like justice revolving to we do

207
00:20:34,129 --> 00:20:37,139
now we have two minutes here access our
network

208
00:20:37,139 --> 00:20:38,600
the question becomes

209
00:20:38,600 --> 00:20:42,928
what the what the next step how do we
move how to move from the slow steady

210
00:20:42,929 --> 00:20:53,440
place the place so we want for PCR tests
we have been talking about the

211
00:20:53,440 --> 00:20:56,230
cardholder data environment is our
highest security network that would want

212
00:20:56,230 --> 00:21:02,010
to do you want to find a way into the
cardholder data environment one really

213
00:21:02,010 --> 00:21:07,900
great tool for accomplishing this is is
your nets that undercut any system

214
00:21:07,900 --> 00:21:10,530
that's actually just looking forward to
the connections to and from any

215
00:21:10,530 --> 00:21:17,789
particular host right now go ahead and
point out one really great way to regain

216
00:21:17,789 --> 00:21:22,679
its information gathered this across a
range of post is Josh's

217
00:21:22,679 --> 00:21:28,620
cool essentially all this does is Brad's
that's that's from a select with the

218
00:21:28,620 --> 00:21:29,820
systems for you

219
00:21:29,820 --> 00:21:33,899
given the target IP's and some
credentials that don't fit the data for

220
00:21:33,900 --> 00:21:38,799
you so now you have net that from
everybody and everybody on your your

221
00:21:38,799 --> 00:21:40,080
your local

222
00:21:40,080 --> 00:21:45,908
directly accessible to you with your
potential so what can we do with this

223
00:21:45,909 --> 00:21:49,590
information will probably one of the
most obvious things is we can just get

224
00:21:49,590 --> 00:21:55,870
or a network range maybe we know that a
target ranges is what we're looking for

225
00:21:55,870 --> 00:22:00,408
a quick reponse oh look there's there's
there's a direct connection that we can

226
00:22:00,409 --> 00:22:07,559
reuse maybe it's something we can abused
by her or maybe something that it

227
00:22:07,559 --> 00:22:11,289
requires a more advanced the quotation
but but we have no idea where to start

228
00:22:11,289 --> 00:22:17,280
to ease but what if we don't see any
direct connections this data can still

229
00:22:17,280 --> 00:22:22,210
be incredibly useful to you and we went
to general quickly as a way to go over

230
00:22:22,210 --> 00:22:28,570
another trip that that Josh Rowe
involves using taking did the net that

231
00:22:28,570 --> 00:22:33,860
and using graph is which is a
visualization tool to 22 actually

232
00:22:33,860 --> 00:22:39,840
visualize all the network connection so
what what the Duchess Creek does is it

233
00:22:39,840 --> 00:22:43,049
will turn the nets that tend to a doc
file so this is just a textual

234
00:22:43,049 --> 00:22:50,230
description and we executed command in
it draws a nice picture for us so one of

235
00:22:50,230 --> 00:22:50,720
the

236
00:22:50,720 --> 00:22:56,530
you can use or look at when you during
one of these is what to look for any

237
00:22:56,530 --> 00:23:01,270
more we see maybe a ton of connections
coming into a particular host this might

238
00:23:01,270 --> 00:23:06,740
be something as simple as a file server
or database or maybe it's something like

239
00:23:06,740 --> 00:23:12,450
a jump box that we didn't know about
before a particular think this is useful

240
00:23:12,450 --> 00:23:16,830
when you look at these these connection
then you see something that you didn't

241
00:23:16,830 --> 00:23:22,030
know about before maybe it's something
that I teach him the network team didn't

242
00:23:22,030 --> 00:23:26,490
tell you about doesn't know about you to
know about maybe it's a subnet you

243
00:23:26,490 --> 00:23:30,740
didn't see before but if we see a bunch
of texts coming into a single host and

244
00:23:30,740 --> 00:23:32,720
it's a sudden I would never seen before

245
00:23:32,720 --> 00:23:39,390
particularly may be very interesting the
great thing about Rob hunter is that it

246
00:23:39,390 --> 00:23:45,409
can quickly get this information i had
engaged in this year were you able to

247
00:23:45,409 --> 00:23:49,940
cover about 3,100 host and under nine
minutes so you gonna run this a couple

248
00:23:49,940 --> 00:23:53,740
of times throughout the course of the
engagement in a really great picture of

249
00:23:53,740 --> 00:23:58,360
the network and get a feel for you know
who should be going to wear and what

250
00:23:58,360 --> 00:24:02,100
what it was said that look like and we
can spot these outliers might tell us

251
00:24:02,100 --> 00:24:06,549
hey look there's the jump box that the
customer to tell you about that they

252
00:24:06,549 --> 00:24:09,840
forgot to pay for now you got your

253
00:24:09,840 --> 00:24:23,260
and saying with hunter but once you've
parked herself as an admin on a network

254
00:24:23,260 --> 00:24:28,860
just run run something like that every
30 minutes or every hour for a day and

255
00:24:28,860 --> 00:24:34,178
you'll see the behavior of the network
over time and I'm convinced that what

256
00:24:34,179 --> 00:24:37,770
we're talking about we just doing the
first layer of analysis on that stuff

257
00:24:38,470 --> 00:24:42,690
the material you can pull out of
analyzing big data set like that if you

258
00:24:42,690 --> 00:24:44,510
can get it is wonderful

259
00:24:44,510 --> 00:24:48,580
going into the next scenario this is a
little bit different this is not a PCI

260
00:24:49,240 --> 00:24:52,840
example but in this case it's a
penetration test against a product

261
00:24:52,840 --> 00:24:56,750
company that's concerned about people
leaking information about their new

262
00:24:56,750 --> 00:25:02,840
products so instead of looking for a PCI
card holder data environment i'm i'm

263
00:25:02,840 --> 00:25:03,860
looking for

264
00:25:03,860 --> 00:25:07,810
instead information about this new
unreleased products

265
00:25:07,810 --> 00:25:12,090
this is a different because its
expectation really should be very

266
00:25:12,090 --> 00:25:17,570
different in this case most places
aren't going to have a PCI style CDE for

267
00:25:17,570 --> 00:25:22,169
protecting their product data but turned
out this one was actually quite

268
00:25:22,170 --> 00:25:28,520
challenging for me in my initial
strategy going in and out so I don't

269
00:25:28,520 --> 00:25:33,490
know about you but I tends to overly
romanticize what I do for a living it

270
00:25:33,490 --> 00:25:38,380
makes a lot more fun I typically think
of your typical company as being kind of

271
00:25:38,380 --> 00:25:45,050
like a medieval kingdom got a nested
hierarchy enclaves in different silos

272
00:25:45,050 --> 00:25:49,750
and have complex political relationships
you got if you look at an org chart it's

273
00:25:49,750 --> 00:25:55,260
basically a system of feudal vassals
landlords makes a lot more fun to just

274
00:25:55,260 --> 00:25:59,260
think about it that we actually get in
this case once I got the keys to the

275
00:25:59,260 --> 00:26:00,629
kingdom

276
00:26:00,630 --> 00:26:04,470
I should be able to have the run of the
kingdom so I can just go to all the

277
00:26:04,470 --> 00:26:07,750
places and find little hamlet Sandberg's
where they're making this information

278
00:26:07,750 --> 00:26:14,250
about unreleased products it turned out
it defied my ability to find them I had

279
00:26:14,250 --> 00:26:17,700
gone through the shares I have gone
through Active Directory and I'm getting

280
00:26:17,700 --> 00:26:21,960
to the end of the pen test the eleventh
hour and I don't have anything that

281
00:26:21,960 --> 00:26:26,320
stuff about current products but nothing
that meets the success criteria haven't

282
00:26:26,320 --> 00:26:27,480
gotten to the call

283
00:26:27,480 --> 00:26:32,350
so I start kind of flailing around and
trying all my Statue of Liberty plays

284
00:26:32,350 --> 00:26:38,500
hail marys and so forth and and just
thinking great I'm gonna end up with

285
00:26:38,500 --> 00:26:42,380
domain admin in a non segmented network
and I'm not gonna have this success

286
00:26:42,380 --> 00:26:48,740
criteria so I'm going back to my roots
and thinking what do I have because at

287
00:26:48,740 --> 00:26:52,870
any point pen test to me if you're to
boil the entire process of contesting

288
00:26:52,870 --> 00:26:58,100
down to one thing it's that I am I think
what do I have where do I want to be

289
00:26:58,100 --> 00:27:03,209
anything I have get me there or closer
to their and some just going through the

290
00:27:03,210 --> 00:27:07,240
things I have done so far and one of the
quirky little scans I had done for for

291
00:27:07,240 --> 00:27:11,330
some reason was to collect a listing of
all the services running on all the

292
00:27:11,330 --> 00:27:14,909
systems in the domain I think at the
time I was probably looking for

293
00:27:14,910 --> 00:27:20,390
antivirus sweets or checking consistency
of implementation for yes I'm defensive

294
00:27:20,390 --> 00:27:24,760
tool that they had in the environment
but I I started thinking through and I

295
00:27:24,760 --> 00:27:29,320
thought you know if I was on a team that
makes information about new products

296
00:27:29,320 --> 00:27:33,830
baby I'm a product designer and engineer
something like that I bet I have some

297
00:27:33,830 --> 00:27:38,850
special software that everybody doesn't
get and I know for example with Visual

298
00:27:38,850 --> 00:27:42,100
Studio lot of times it's a couple
services associated Visual Studio I

299
00:27:42,100 --> 00:27:45,480
often use that to try and developers can
target them

300
00:27:45,480 --> 00:27:50,280
and this case may be the same thing
might work so I had this body of

301
00:27:50,280 --> 00:27:54,410
knowledge and started exploring it a
little bit but was kinda funny about

302
00:27:54,410 --> 00:27:58,530
services there some services like the
browser service that are actually

303
00:27:58,530 --> 00:28:02,610
running on all computers every Windows
box has the browser service running

304
00:28:02,610 --> 00:28:06,889
that's not a very useful service for me
it's not going to help me identify a

305
00:28:06,890 --> 00:28:10,559
special group that's different from the
others and then if you go to the other

306
00:28:10,559 --> 00:28:14,410
extreme I've got something like seven
hundred services that are running on

307
00:28:14,410 --> 00:28:19,220
only a single machine and that's overly
discriminating that just tells me who

308
00:28:19,220 --> 00:28:23,340
has a weird network card or who has the
one decent in video card or something

309
00:28:23,340 --> 00:28:28,740
that's not gonna help me so much when
I'm particularly curious about is

310
00:28:28,740 --> 00:28:33,080
anything in this zone where I see is
between five and 20 machines that have

311
00:28:33,080 --> 00:28:38,460
this service that's about the size to be
a team or maybe a small department

312
00:28:38,460 --> 00:28:43,660
something like that so I start looking
for the nato and as I'm going down I see

313
00:28:43,660 --> 00:28:49,299
that there are 12 systems that have the
SolidWorks Licensing Service install and

314
00:28:49,299 --> 00:28:55,320
how many people here recognize
SolidWorks and notice how it works is ok

315
00:28:55,320 --> 00:29:01,409
cool we got one yeah maybe this wouldn't
show up to everybody immediately but i

316
00:29:01,410 --> 00:29:04,320
wasnt administrator in mechanical
engineering department wants and I know

317
00:29:04,320 --> 00:29:09,939
exactly what SolidWorks is solid works
as a cat package it's a nice one that's

318
00:29:09,940 --> 00:29:13,309
an expensive one I wish I had one cause
I also have a 3d printer and that would

319
00:29:13,309 --> 00:29:19,559
be nice but anyway I started thinking
like that for people heard making the

320
00:29:19,559 --> 00:29:23,750
mechanical drawings and so forth for
these new products and so these are the

321
00:29:23,750 --> 00:29:25,830
CAD designers workstations

322
00:29:25,830 --> 00:29:31,320
and then as I started to explore in
their boxes I realize why I could never

323
00:29:31,320 --> 00:29:37,000
find this information on the file shares
its because these CAD designers don't

324
00:29:37,000 --> 00:29:41,000
use the file shares they start
everything on their local disk usually

325
00:29:41,000 --> 00:29:45,130
excludes he drives when i buy during
shares because they're generally

326
00:29:45,130 --> 00:29:50,760
uninteresting but by following this path
I was able to find the information about

327
00:29:50,760 --> 00:29:55,419
these products and their have my success
criteria this is a very fun and

328
00:29:55,419 --> 00:30:00,230
interesting contest to me is the first
time I had this kind of intuitively pin

329
00:30:00,230 --> 00:30:06,799
in this manner at this point but what I
realized is that this this is actually

330
00:30:06,799 --> 00:30:13,230
something that as a strategic move is
something I I now use all the time what

331
00:30:13,230 --> 00:30:17,429
I'm interested in is any system that's
not like other systems is more

332
00:30:17,429 --> 00:30:22,120
interesting to me there's some set a
baseline boxes are all about the same

333
00:30:22,120 --> 00:30:26,870
and those are those are useless and in a
big network but there might be thousands

334
00:30:26,870 --> 00:30:31,658
or tens of thousands of uninteresting
machines if I can find distinctive

335
00:30:31,659 --> 00:30:35,779
characteristics that helped me figure
out which ones are different and I can

336
00:30:35,779 --> 00:30:42,580
collect that information efficiently
then I'm able to narrow my focus in my

337
00:30:42,580 --> 00:30:46,970
limited time for the pen test and get to
where I can answer that useful question

338
00:30:46,970 --> 00:30:51,909
so once you see this one time you start
to see it everywhere and their

339
00:30:51,909 --> 00:30:56,820
situations that come up like you know
I'm interested in finding people who

340
00:30:56,820 --> 00:31:00,059
might have dual mode machines you can
get this information a few different

341
00:31:00,059 --> 00:31:03,559
ways but if you can list the interfaces
on all systems and all that information

342
00:31:03,559 --> 00:31:07,690
together these but interesting things
you also find anyone that has VMware

343
00:31:07,690 --> 00:31:11,010
install because they have a few extra
network interfaces you see anybody that

344
00:31:11,010 --> 00:31:12,260
has weird

345
00:31:12,260 --> 00:31:15,220
clients configured because each of those
who have their own little virtual

346
00:31:15,220 --> 00:31:18,280
interface it's it's actually this really
interesting body of data

347
00:31:19,110 --> 00:31:23,280
what if I can get a task listing list of
processes on all the systems in the

348
00:31:23,280 --> 00:31:27,780
domain and pull that together in in one
body of knowledge that that ends up

349
00:31:27,780 --> 00:31:31,450
being tremendously useful because I can
see all the people who have the terminal

350
00:31:31,450 --> 00:31:35,830
client her the mainframe or something
like that running these things help me

351
00:31:35,830 --> 00:31:42,020
to narrow down my focus and concentrate
on those groups of systems that are

352
00:31:42,020 --> 00:31:49,070
special and unique and then another
quick example I had a situation not too

353
00:31:49,070 --> 00:31:52,310
long ago I had about six thousand users
in the environment

354
00:31:52,880 --> 00:31:58,900
sitting on the network and some of them
can VPN into the CD well I'm interested

355
00:31:58,900 --> 00:32:02,820
to know which ones can and there is no
Active Directory group that just tells

356
00:32:02,820 --> 00:32:08,149
me these are the CD EP enters and so I
i'm looking at the end point for the VPN

357
00:32:08,150 --> 00:32:13,580
and I realized it's a it's a Cisco VPN
you know maybe if I just collect a

358
00:32:13,580 --> 00:32:17,889
listing for program files from all of
the systems in the domain I can tell who

359
00:32:17,890 --> 00:32:22,690
has a cisco anyconnect client install I
took six thousand users in winter that

360
00:32:22,690 --> 00:32:28,410
down 280 ish users or something like
that and that's practical I can't park

361
00:32:28,410 --> 00:32:33,860
and keyloggers and man the middle agents
and other fun things on six thousand

362
00:32:33,860 --> 00:32:37,860
boxes responsibly but I can go after a
hundred and eighty that's quite doable

363
00:32:37,860 --> 00:32:41,629
so starting to think about what
information can I collect and

364
00:32:41,630 --> 00:32:48,120
post-process to focus my my death ray
whatever whatever doing fantastic turns

365
00:32:48,120 --> 00:32:51,120
out to be a wonderful and very
profitable strategy

366
00:32:52,039 --> 00:33:01,049
personified we're not handing off I get
2005 is also a little bit different and

367
00:33:01,049 --> 00:33:04,210
we heard about domain admin and we're
trying to get our access to the

368
00:33:04,210 --> 00:33:08,340
cardholder data environment but in this
case I actually know exactly where it is

369
00:33:08,340 --> 00:33:12,418
I know where the crown jewels are you
sitting in that that locked box over

370
00:33:12,419 --> 00:33:17,080
there and the problem is when I try to
access it I come up against a

371
00:33:17,080 --> 00:33:24,509
challenging barrier so here when I was
younger pen tester I always we just got

372
00:33:24,509 --> 00:33:31,590
my hands up and say ok you have you got
a good network and over time it's just

373
00:33:31,590 --> 00:33:37,178
kind of it sticks you think there ought
to be something I could do and so last

374
00:33:37,179 --> 00:33:41,019
year in Derby Conn I had the opportunity
to present a few strategies we used to

375
00:33:41,019 --> 00:33:46,539
get around factor and even a heavily
protected environment it we should

376
00:33:46,539 --> 00:33:51,158
expect there should always be at least
something we could do so today I'm not

377
00:33:51,159 --> 00:33:54,460
going to talk about the bypasses I did
last year and this one's a different one

378
00:33:54,460 --> 00:33:58,369
and in fact this one is one that to me
it kind of fits into the socially I

379
00:33:58,369 --> 00:34:03,549
can't believe it works but in fact it's
so easy to do and it works so often I go

380
00:34:03,549 --> 00:34:08,629
to this one first now and in fact this
this month I've had to Penn tests in a

381
00:34:08,629 --> 00:34:13,199
row where I use this exact technique to
get access to the cardholder data

382
00:34:13,199 --> 00:34:16,848
environment so I understand where this
comes from there's a particular

383
00:34:16,849 --> 00:34:23,409
vulnerability that I'm leveraging here
and it all comes down to this is Bob

384
00:34:23,409 --> 00:34:30,309
he's the regular average mark one
corporate user ok he lives in the cube

385
00:34:30,309 --> 00:34:32,310
farm with all of the other

386
00:34:32,310 --> 00:34:37,340
denizens and works out his day and
whatever his role is and the big problem

387
00:34:37,340 --> 00:34:43,020
with bob's day is that he is absolutely
ruled by a harsh and unforgiving task

388
00:34:43,020 --> 00:34:48,850
mistress and that is his calendar
typically most environments would not

389
00:34:48,850 --> 00:34:51,730
consider the calendar to be a
vulnerability but this gets kind of a

390
00:34:51,730 --> 00:34:57,360
kind of fun once you do it easy in bob's
day he's got a bunch of meetings that

391
00:34:57,360 --> 00:35:01,590
clog it up as far as he's concerned most
of those use up an inordinate amount of

392
00:35:01,590 --> 00:35:06,570
time keep him from getting work done at
all bad because sometimes he gets to go

393
00:35:06,570 --> 00:35:10,810
out to eat and then there are those
opportunities to get up and walk around

394
00:35:10,810 --> 00:35:15,440
the office a bit had to the water cooler
make a coffee run commiserate with the

395
00:35:15,440 --> 00:35:19,530
other inmates and and that of course
nature calls on occasion for a little

396
00:35:19,530 --> 00:35:25,820
solitude in contemplation and really get
down to it the fact is for much of the

397
00:35:25,820 --> 00:35:26,430
day

398
00:35:26,430 --> 00:35:31,060
Bob's computer looks kind of like this
and that isn't so interesting I see

399
00:35:31,060 --> 00:35:36,299
computers like this all the time but
sometimes this is very special because

400
00:35:36,300 --> 00:35:40,450
behind the screen bob has a remote
desktop session that's already

401
00:35:40,450 --> 00:35:45,290
multi-factor authenticated in the
cardholder data and because it's so

402
00:35:45,290 --> 00:35:50,390
annoying to multi-factor every time that
screen locks it doesn't multi-factor

403
00:35:50,390 --> 00:35:56,680
when he unlocks that if I can only know
when this situation occurs maybe I could

404
00:35:56,680 --> 00:36:02,419
take advantage of that session so I
start thinking to myself if I could wait

405
00:36:02,420 --> 00:36:07,360
until bob goes to the CDE and then
telling me locke says screen I already

406
00:36:07,360 --> 00:36:11,980
know his password so I could remote
desktop into his box and then just use

407
00:36:11,980 --> 00:36:12,710
it

408
00:36:12,710 --> 00:36:18,130
kind of the dumbest a cover but if I
could get the right situation then I'd

409
00:36:18,130 --> 00:36:19,770
come out looking like a rockstar

410
00:36:19,770 --> 00:36:22,700
someone look at it and say well how on
earth did you ever find that situation

411
00:36:22,700 --> 00:36:27,149
and it turns out that this is really
cool in theory but in practice it could

412
00:36:27,150 --> 00:36:31,210
be kind of difficult in a small network
there are only so many people who access

413
00:36:31,210 --> 00:36:36,500
the target zone and then the other
problem is some people are kind of STIs

414
00:36:36,500 --> 00:36:40,650
and they close their windows before they
lock and go to Mindjolt whatever so in

415
00:36:40,650 --> 00:36:44,599
in a typical small environment this is
kind of hard to pull off you have to

416
00:36:44,599 --> 00:36:45,190
wait

417
00:36:45,190 --> 00:36:49,880
potentially for a long time for the
right situation to occur and you know I

418
00:36:49,880 --> 00:36:54,080
can't I can't bill the customer for 10
testing where I'm just waiting for

419
00:36:54,080 --> 00:37:00,529
something to happen gotta do something
thanks Jeff but there's this interesting

420
00:37:00,530 --> 00:37:04,020
thing that happens with scale in the
animal kingdom it's good to be heard

421
00:37:04,020 --> 00:37:08,220
right if you're if you're a wildebeest
you don't wanna be alone you want to be

422
00:37:08,220 --> 00:37:12,529
in a whole big group of wildebeests
because you're relatively safer for the

423
00:37:12,530 --> 00:37:15,940
predator the network is the opposite of
the bigger than ever get some more at

424
00:37:15,940 --> 00:37:21,150
risk it is because only one of those
will be says to get caught and attacker

425
00:37:21,150 --> 00:37:22,089
gets what he wants

426
00:37:22,089 --> 00:37:23,279
I'm not

427
00:37:23,279 --> 00:37:28,219
I'm not heard the predator the situation
when the network gets big there aren't

428
00:37:28,219 --> 00:37:32,439
just a handful of users can get to this
place you don't really get big by having

429
00:37:32,439 --> 00:37:36,299
only two people who work in your
cardholder data right there probably

430
00:37:36,299 --> 00:37:39,549
many many targets could even be
thousands depending on the situation

431
00:37:39,549 --> 00:37:44,890
maybe got call centers and everybody
jump box and whatever and so there's an

432
00:37:44,890 --> 00:37:48,299
interesting thing that happens with
scale at what we're doing is we're

433
00:37:48,299 --> 00:37:52,759
calculating the set intersection a bunch
of groups of people we start with the

434
00:37:52,759 --> 00:37:57,489
entire environment some of them can get
to the CDE some of them are right now in

435
00:37:57,489 --> 00:38:02,069
the CDE and then some of those my clock
their screen in the small environment

436
00:38:02,069 --> 00:38:06,640
the number of people in that black
shaded zone is probably small probably

437
00:38:06,640 --> 00:38:12,439
about 20 on average but in a big
networks it becomes non-zero on average

438
00:38:12,439 --> 00:38:16,709
which means at any given time there's
probably one of these sitting out there

439
00:38:16,709 --> 00:38:17,960
somewhere

440
00:38:17,960 --> 00:38:22,220
R and now they the only challenge here
especially given we've talked about so

441
00:38:22,220 --> 00:38:27,589
far is finding people with screens
locked if you look on Google you'll find

442
00:38:27,589 --> 00:38:31,650
that stack overflow suggest you read it
executable they called us win32 API

443
00:38:31,650 --> 00:38:35,720
function and you get back a struct and
it is populated with some flag that

444
00:38:35,720 --> 00:38:39,779
tells you this screen is locked and I
don't necessarily want to throw an

445
00:38:39,780 --> 00:38:45,570
executable how to all six thousand boxes
to put that listen to report right so

446
00:38:45,570 --> 00:38:49,680
I've got a few things that make me say
that's that's hard that's that's not the

447
00:38:49,680 --> 00:38:52,899
easy way to do it and actually they're
probably a hundred different ways to get

448
00:38:52,900 --> 00:38:56,660
this information but i just wanted to
find an easier one an easier one that I

449
00:38:56,660 --> 00:39:01,868
stumbled on is when windows locks the
screen it runs a program called logon

450
00:39:01,869 --> 00:39:06,950
you I dot exe already talked about with
Rielle Hunter I can get stats but I can

451
00:39:06,950 --> 00:39:10,970
also just run a command and get the
results back I can get a task list from

452
00:39:10,970 --> 00:39:15,848
other systems in the domain in about 10
minutes and I can have this list so now

453
00:39:15,849 --> 00:39:20,190
we have everything that we need Patrick
talked about that said whispering in

454
00:39:20,190 --> 00:39:24,890
order to get the people who talk to the
CDE we can find the lock screen by

455
00:39:24,890 --> 00:39:29,390
checking for logon you I don't exe we
can use these super leet hacking tool

456
00:39:29,390 --> 00:39:34,609
called grab to figure out which ones are
those lists and then any remote desktop

457
00:39:34,609 --> 00:39:40,069
client works see see this is basically
exploit free checking there's nothing

458
00:39:40,070 --> 00:39:43,720
going on using admin rights to do a
thing and had been can do and then

459
00:39:43,720 --> 00:39:50,200
Remote Desktop thing somewhere so at any
given time in during the assessment I

460
00:39:50,200 --> 00:39:54,529
can run two scans and aggressive and I
get a list of all of the points where I

461
00:39:54,530 --> 00:39:56,570
can get to the CDE right now

462
00:39:56,570 --> 00:40:00,350
there are some caveats there are things
that can go wrong things you have to

463
00:40:00,350 --> 00:40:04,140
account for might depend on what they're
using to access the CD and whatever we

464
00:40:04,140 --> 00:40:07,450
can chat about some of the details if
you want to I heard grab me the biggest

465
00:40:07,450 --> 00:40:08,350
one now

466
00:40:08,350 --> 00:40:14,049
was a substantial concern for me
initially because I thought well what if

467
00:40:14,050 --> 00:40:17,640
baby bear gets back from the bathroom
and figures out that somebody's been

468
00:40:17,640 --> 00:40:19,098
sleeping in his bed

469
00:40:19,099 --> 00:40:23,160
the mouse is moving by Wednesday that
can still see the lock screen but you

470
00:40:23,160 --> 00:40:26,589
know he sees it has windows are
rearranged and I was in the middle of

471
00:40:26,589 --> 00:40:31,130
typing some awesome commands some big
PowerShell one-liner and and and and he

472
00:40:31,130 --> 00:40:34,700
caught me I thought well that's that's
got to be a serious risk great but it

473
00:40:34,700 --> 00:40:39,569
turns out that in reality it's not that
big of a deal because the first thing I

474
00:40:39,569 --> 00:40:44,880
saw when I remote desktop into bob's
machine was his calendar and I can see

475
00:40:44,880 --> 00:40:47,700
that he's gonna be trapped in that
change control meeting for an hour

476
00:40:47,700 --> 00:40:51,779
because I actually have a pretty good
amount of time if it happens that I

477
00:40:51,779 --> 00:40:55,259
don't see any reason why he's going to
be gone for a little bit well then i'll

478
00:40:55,259 --> 00:40:58,989
just disconnected wait for a better time
there were two others in this can you

479
00:40:58,989 --> 00:41:02,289
saw a couple nights ago I can wait a few
minutes and see if someone else pops up

480
00:41:02,289 --> 00:41:07,920
in a few minutes on this box in the CD
is probably enough for me to identify

481
00:41:07,920 --> 00:41:11,680
what exfiltration mechanisms I have
available

482
00:41:11,680 --> 00:41:16,868
find a CT channel install malicious
agents and secure continuous control of

483
00:41:16,869 --> 00:41:21,190
that box and that gives me access the
CDE without having to ever worry about

484
00:41:21,190 --> 00:41:37,489
multi-factor again that defy scenario is
something I ran into this year that had

485
00:41:37,489 --> 00:41:42,690
me a little bit scary little frustrated
pressed for time I had gotten early

486
00:41:42,690 --> 00:41:47,089
optimizing the corporate side the
network had been able to get into the

487
00:41:47,089 --> 00:41:51,869
city actually ahead for compromise there
so I had full control over all the

488
00:41:51,869 --> 00:41:56,239
machines that would typically say this
is gonna give me the data I

489
00:41:56,239 --> 00:42:02,460
unfortunately 32 databases looking to
buy shares I was able to actually find a

490
00:42:02,460 --> 00:42:05,910
PCI contesta looking for cardholder data
I wasn't able to actually find any

491
00:42:05,910 --> 00:42:12,078
civilization solution in place maybe I
just was looking in the right place

492
00:42:12,079 --> 00:42:17,779
right time to start to press you can you
kill more creative with with on doing

493
00:42:17,779 --> 00:42:18,019
this

494
00:42:18,019 --> 00:42:22,729
approaching it so what I wanted to do
here take a step backwards and look at

495
00:42:22,729 --> 00:42:26,009
what information collected what did I
know about the network that could lead

496
00:42:26,009 --> 00:42:30,549
to figure out and maybe a more pointed
target or or forget where the data will

497
00:42:30,549 --> 00:42:36,819
be here is that there had been some free
engagement discussion that the customer

498
00:42:36,819 --> 00:42:42,038
had indicated somebody is interacting
with the date I want so I have a strong

499
00:42:42,039 --> 00:42:45,920
feeling or is pretty certain that it was
somewhere that nowhere in housing to get

500
00:42:45,920 --> 00:42:55,809
to it so in this situation like I said I
already had the main I had been on a

501
00:42:55,809 --> 00:43:03,190
couple hundred hosts because I was
starting to really open shelves look for

502
00:43:03,190 --> 00:43:10,789
information but when I think someone to
do was to break down these the block

503
00:43:10,789 --> 00:43:15,239
little more get a feel for where he was
where they used to interpret it

504
00:43:15,239 --> 00:43:21,269
see who's logged onto each individual
hosts denied used a new phalanx which if

505
00:43:21,269 --> 00:43:24,979
you don't know is essentially just a
wrapper RPC client to gather all the

506
00:43:24,979 --> 00:43:34,180
group memberships and so see what what
what users are members of groups like

507
00:43:34,180 --> 00:43:39,219
the output is pretty and in this
particular situation that could be very

508
00:43:39,219 --> 00:43:46,849
indicative of what what department you
remember to give me good just doing what

509
00:43:46,849 --> 00:43:55,130
I was doing was process list so sort of
see you know was there anything unique

510
00:43:55,130 --> 00:44:01,160
about groups of users of the program
that they're running around trying to do

511
00:44:01,160 --> 00:44:06,089
was correlated users their groups and
the processes that they were running so

512
00:44:06,089 --> 00:44:13,349
short of an extrapolation of what Josh
was driving earlier and we're trying to

513
00:44:13,349 --> 00:44:16,799
do is break this down from something
looks like this my understanding of the

514
00:44:16,799 --> 00:44:22,038
network something a little bit more
detail and in doing this I'll say that

515
00:44:22,039 --> 00:44:27,479
there was definitely some measure of
desperation in the recent hits and

516
00:44:27,479 --> 00:44:28,868
misses you are trying to put together

517
00:44:28,869 --> 00:44:32,640
was something interesting so hard to
find there wasn't anything that I wanted

518
00:44:32,640 --> 00:44:37,069
but one of things I did notice was
almost everybody in the organization is

519
00:44:37,069 --> 00:44:41,180
using Google Chrome except for people
and customer service they all have an

520
00:44:41,180 --> 00:44:43,440
explorer and now

521
00:44:43,440 --> 00:44:49,650
interesting but but simply because they
were unique in their use of Internet

522
00:44:49,650 --> 00:44:53,509
Explorer decided to grab a few
screenshots of the desktops and I see

523
00:44:53,509 --> 00:44:55,670
that very thing

524
00:44:55,670 --> 00:45:02,190
application that actually had some the
data looking for now I didn't just might

525
00:45:02,190 --> 00:45:07,269
be 2011 PC data isn't necessarily a
great indicator of compromise so wanted

526
00:45:07,269 --> 00:45:14,508
to spend a little bit further on the
recommendation of a co-worker I used CD

527
00:45:14,509 --> 00:45:20,099
search tool which will look for credit
card data panda look through their the

528
00:45:20,099 --> 00:45:24,839
cash piles and Internet Explorer and
found that there was indeed holding onto

529
00:45:24,839 --> 00:45:30,839
the data required that I was able to
spray an update that felt like it was a

530
00:45:30,839 --> 00:45:34,730
much better indicator of a compromise
then what initially come through with it

531
00:45:34,730 --> 00:45:39,720
was just access to the network because I
want to be able to represent is we are

532
00:45:39,720 --> 00:45:43,379
we are finding data that is a value to
the customer and that the real crown

533
00:45:43,380 --> 00:45:57,970
jewels so in conclusion I think that one
of the things that Josh and i were

534
00:45:57,970 --> 00:46:03,109
really only start talking about the
doing this talk was weird thing is that

535
00:46:03,109 --> 00:46:04,299
we're doing

536
00:46:04,300 --> 00:46:11,110
practically there were the philosophical
minds of three using running into

537
00:46:11,110 --> 00:46:16,280
problems you know I think we just got an
exploit you get to the end that's in the

538
00:46:16,280 --> 00:46:21,130
day maybe it would just be 123 stuff but
I think one of things we we actually

539
00:46:21,130 --> 00:46:24,880
experiences that we wanted to challenge
the things that take a lil bit of

540
00:46:24,880 --> 00:46:29,010
creativity and what are the things that
we are doing creatively or whether the

541
00:46:29,010 --> 00:46:35,040
minds of reusing to get to get past them
these problems when we married to each

542
00:46:35,040 --> 00:46:39,360
one of these directions as to what I
want to come to touch on real quickly

543
00:46:39,360 --> 00:46:43,420
exclusion of the word of the the sort of
philosophical bit that we starting with

544
00:46:43,420 --> 00:46:50,460
the mean initially talked about hiding
in plain sight that is weird sometimes

545
00:46:50,460 --> 00:46:54,130
the day that you need is already there
sometimes during you have on your system

546
00:46:54,130 --> 00:46:58,110
you just need to take a take a step back
and look at it and figure out how can I

547
00:46:58,110 --> 00:47:03,670
use it you know no privileges still feel
privileged like the philosophical

548
00:47:03,670 --> 00:47:10,580
driving there was don't be so set on a a
method of exploitation that I start with

549
00:47:10,580 --> 00:47:13,819
a user if he doesn't have any approaches
you did you move on

550
00:47:15,170 --> 00:47:19,660
laterally how can you check in your life
that you have to continue to the pen

551
00:47:19,660 --> 00:47:25,069
test we know there are holes somewhere
having this is almost a sort of

552
00:47:25,070 --> 00:47:28,690
foundational way we think about a pen
test when you walk into a network when

553
00:47:28,690 --> 00:47:32,110
you plug in your you know that there's
going to be a problem I don't know that

554
00:47:32,110 --> 00:47:37,510
there is a network that that the person
who was it will tell you that is perfect

555
00:47:37,510 --> 00:47:42,000
and has everybody will admit that
there's some sort of law at the

556
00:47:42,000 --> 00:47:45,400
Pentastar like our our job is to find
those things happen

557
00:47:45,400 --> 00:47:50,270
keep that in mind that should be your
mindset when you sit down and start some

558
00:47:50,270 --> 00:47:56,000
of these are not like the others the
takeaway are really driving that is

559
00:47:56,000 --> 00:48:02,040
being able to turn information into
discrete units so understand that a

560
00:48:02,040 --> 00:48:04,890
group of users as unique or get both
systems is unique

561
00:48:04,890 --> 00:48:07,759
being able to use it data in a pen test

562
00:48:07,759 --> 00:48:14,749
to process that will make you much more
effective in addressing there'll never

563
00:48:14,749 --> 00:48:20,229
be a TV CD for this Josh Vlasto I think
this was actually my favorite just

564
00:48:20,229 --> 00:48:24,218
because we talked about a pen testing we
talk about vulnerabilities a lot of the

565
00:48:24,219 --> 00:48:28,069
time the things that were describing
their not exploit the way that people

566
00:48:28,069 --> 00:48:33,429
mean when they say the word they are
architectural problem with the way that

567
00:48:33,429 --> 00:48:38,829
a network design their hair loss and in
the way that we divided access or try to

568
00:48:38,829 --> 00:48:44,449
prevent access between places and that
when you do that without photos supposed

569
00:48:44,449 --> 00:48:47,229
to do well we leverage that supposed to
do

570
00:48:47,229 --> 00:48:55,979
into a way to get your data and Jordan
respective places my my sort of crisis

571
00:48:55,979 --> 00:48:57,279
there was just that

572
00:48:57,279 --> 00:49:01,579
yeah you can get access to something but
you're walking away with the data that

573
00:49:01,579 --> 00:49:05,369
the customer things was part of it is
viable the thing that actually had a

574
00:49:05,369 --> 00:49:09,969
value have you really done the penthouse
have you really exercise you know what

575
00:49:09,969 --> 00:49:13,619
you were supposed to do and if not then
take a step back and take a broader look

576
00:49:13,619 --> 00:49:18,309
at what we're trying to do to make sure
that you're delivering value to the

577
00:49:18,309 --> 00:49:21,309
customer

578
00:49:24,459 --> 00:49:34,848
defenders and not a vendor's I'm trying
to think from this material with what

579
00:49:34,849 --> 00:49:37,729
would what should be useful to the
defender

580
00:49:37,729 --> 00:49:42,598
I think the biggest thing is there are
so many unrecognized assumptions are

581
00:49:42,599 --> 00:49:46,689
foregone conclusions about the way we
build our environments we don't realize

582
00:49:46,689 --> 00:49:50,428
what information is Telegraph and
sometimes we don't understand what

583
00:49:50,429 --> 00:49:55,139
information can be obtained and really
look at a lot of the rig that we have

584
00:49:55,139 --> 00:50:00,059
for collecting this information it's
baling wire in a sense we're wrapping a

585
00:50:00,059 --> 00:50:00,810
tool up

586
00:50:00,810 --> 00:50:05,390
we are collecting information systems
were gripping and whatever you guys

587
00:50:05,390 --> 00:50:09,359
actually have a lot of tools as the
defender to know these things before we

588
00:50:09,360 --> 00:50:14,000
ever show up in the pen test so I think
I really good exercise on the defense is

589
00:50:14,000 --> 00:50:19,400
it to turn introspective and think about
you know exactly where the crown jewels

590
00:50:19,400 --> 00:50:25,640
are probably can you kind of predict
what indicators or what pathways gonna

591
00:50:25,640 --> 00:50:30,870
be evident to an attacker and nip this
in the bud in advance before they would

592
00:50:30,870 --> 00:50:38,580
ever manifest as a problem I think that
open up for Q&A I don't know I think the

593
00:50:38,580 --> 00:50:43,140
last one for the day so we can probably
in an hour you wanna grab me outside

594
00:50:43,140 --> 00:50:51,549
whatever you call it thanks thanks

