1
00:00:02,390 --> 00:00:05,450
[Music]

2
00:00:08,480 --> 00:00:14,490
all right so we're gonna<font color="#E5E5E5"> kick</font><font color="#CCCCCC"> it off my</font>

3
00:00:11,610 --> 00:00:16,740
name is<font color="#E5E5E5"> Esteban</font><font color="#CCCCCC"> my talk is titled duck</font>

4
00:00:14,490 --> 00:00:19,650
<font color="#E5E5E5">in the middle injecting keystrokes into</font>

5
00:00:16,740 --> 00:00:22,320
<font color="#E5E5E5">plain text protocols so I'm a</font>

6
00:00:19,650 --> 00:00:24,359
penetration tester at<font color="#CCCCCC"> coalfire labs you</font>

7
00:00:22,320 --> 00:00:26,730
might have saw our booth out there we do

8
00:00:24,359 --> 00:00:29,810
<font color="#E5E5E5">pen testing and a bunch of other</font><font color="#CCCCCC"> InfoSec</font>

9
00:00:26,730 --> 00:00:32,250
consulting services<font color="#CCCCCC"> I run a blog</font>

10
00:00:29,810 --> 00:00:34,140
<font color="#E5E5E5">part-time</font><font color="#CCCCCC"> you know do a little security</font>

11
00:00:32,250 --> 00:00:35,520
research on the side and that's<font color="#E5E5E5"> what</font>

12
00:00:34,140 --> 00:00:38,000
this talk<font color="#E5E5E5"> is going to be about is just</font>

13
00:00:35,520 --> 00:00:41,550
<font color="#E5E5E5">kind of some stuff I did on</font><font color="#CCCCCC"> my own</font><font color="#E5E5E5"> time</font>

14
00:00:38,000 --> 00:00:44,610
<font color="#CCCCCC">previously I worked I was</font><font color="#E5E5E5"> enlisted US</font>

15
00:00:41,550 --> 00:00:49,260
Air Force<font color="#CCCCCC"> I also worked at Apple</font><font color="#E5E5E5"> down in</font>

16
00:00:44,610 --> 00:00:50,940
Cupertino<font color="#CCCCCC"> California so if you're</font>

17
00:00:49,260 --> 00:00:53,070
wondering<font color="#CCCCCC"> what the title meant maybe</font><font color="#E5E5E5"> you</font>

18
00:00:50,940 --> 00:00:55,199
weren't<font color="#E5E5E5"> familiar</font><font color="#CCCCCC"> the title is a</font>

19
00:00:53,070 --> 00:00:57,240
reference to the USB rubber ducky<font color="#CCCCCC"> which</font>

20
00:00:55,200 --> 00:00:59,430
is a pen test tool and what it does

21
00:00:57,240 --> 00:01:02,730
basically is you plug it into a computer

22
00:00:59,430 --> 00:01:04,650
<font color="#E5E5E5">and it emulates a keyboard and it will</font>

23
00:01:02,730 --> 00:01:06,600
<font color="#E5E5E5">start</font><font color="#CCCCCC"> sending keystrokes</font><font color="#E5E5E5"> to the system</font>

24
00:01:04,650 --> 00:01:07,979
<font color="#E5E5E5">and one of</font><font color="#CCCCCC"> the thing cool things you</font><font color="#E5E5E5"> can</font>

25
00:01:06,600 --> 00:01:10,439
<font color="#E5E5E5">do with that is you can open</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> the</font>

26
00:01:07,979 --> 00:01:13,320
<font color="#E5E5E5">command prompt put in a payload on the</font>

27
00:01:10,439 --> 00:01:15,538
command line<font color="#CCCCCC"> and get a reverse shell</font><font color="#E5E5E5"> so</font>

28
00:01:13,320 --> 00:01:18,210
kind of<font color="#E5E5E5"> going in that same in that same</font>

29
00:01:15,539 --> 00:01:20,429
vein<font color="#E5E5E5"> with this attack</font><font color="#CCCCCC"> what this is going</font>

30
00:01:18,210 --> 00:01:24,119
<font color="#E5E5E5">to be talking</font><font color="#CCCCCC"> about is taking protocols</font>

31
00:01:20,429 --> 00:01:26,729
<font color="#E5E5E5">know where protocols that by design</font><font color="#CCCCCC"> send</font>

32
00:01:24,119 --> 00:01:29,429
keystrokes<font color="#E5E5E5"> to</font><font color="#CCCCCC"> a system and we're going</font>

33
00:01:26,729 --> 00:01:32,219
to use that<font color="#E5E5E5"> to do an attack similar to</font>

34
00:01:29,429 --> 00:01:35,640
USB<font color="#E5E5E5"> rubber ducky</font><font color="#CCCCCC"> so in order</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> this to</font>

35
00:01:32,219 --> 00:01:37,829
<font color="#CCCCCC">work the protocol needs</font><font color="#E5E5E5"> to have</font>

36
00:01:35,640 --> 00:01:41,609
keystrokes sent to the<font color="#E5E5E5"> system and it</font>

37
00:01:37,829 --> 00:01:43,678
needs to<font color="#CCCCCC"> be not encrypted so here's an</font>

38
00:01:41,609 --> 00:01:45,719
<font color="#CCCCCC">example if you've never seen a USB</font>

39
00:01:43,679 --> 00:01:48,299
rubber ducky basically how it works<font color="#E5E5E5"> so</font>

40
00:01:45,719 --> 00:01:50,639
<font color="#E5E5E5">you have a computer unlocked open you</font>

41
00:01:48,299 --> 00:01:52,799
plug in a USB stick and<font color="#CCCCCC"> what it will do</font>

42
00:01:50,639 --> 00:01:55,048
is get recognized as a keyboard<font color="#CCCCCC"> open</font>

43
00:01:52,799 --> 00:01:57,990
command prompt type CMD and in the

44
00:01:55,049 --> 00:01:59,999
command prompt you<font color="#E5E5E5"> type in you</font><font color="#CCCCCC"> know a</font>

45
00:01:57,990 --> 00:02:03,179
line of code in this<font color="#CCCCCC"> case it's a</font>

46
00:01:59,999 --> 00:02:05,399
<font color="#CCCCCC">Metasploit</font><font color="#E5E5E5"> web delivery payload so once</font>

47
00:02:03,179 --> 00:02:08,310
this runs<font color="#E5E5E5"> you now have a meterpreter</font>

48
00:02:05,399 --> 00:02:09,900
shell on this system<font color="#CCCCCC"> so it's a</font><font color="#E5E5E5"> really</font>

49
00:02:08,310 --> 00:02:11,520
quick way that<font color="#CCCCCC"> you can just send</font>

50
00:02:09,900 --> 00:02:15,270
keystrokes<font color="#E5E5E5"> to a system real quick and</font>

51
00:02:11,520 --> 00:02:15,600
gain complete access<font color="#E5E5E5"> to it</font><font color="#CCCCCC"> so when it</font>

52
00:02:15,270 --> 00:02:17,640
comes

53
00:02:15,600 --> 00:02:20,400
to<font color="#E5E5E5"> analyzing protocols most of the work</font>

54
00:02:17,640 --> 00:02:21,929
I did<font color="#E5E5E5"> was</font><font color="#CCCCCC"> just in Wireshark</font><font color="#E5E5E5"> so if you</font>

55
00:02:20,400 --> 00:02:24,750
haven't<font color="#CCCCCC"> heard</font><font color="#E5E5E5"> of it Wireshark is a</font>

56
00:02:21,930 --> 00:02:27,600
<font color="#E5E5E5">protocol</font><font color="#CCCCCC"> analyzer</font><font color="#E5E5E5"> and it can parse a</font>

57
00:02:24,750 --> 00:02:29,520
bunch of different protocols<font color="#CCCCCC"> you can do</font>

58
00:02:27,600 --> 00:02:32,970
live analysis on the wire and<font color="#E5E5E5"> you can</font>

59
00:02:29,520 --> 00:02:36,150
also use a stored pcap<font color="#CCCCCC"> it runs on most</font>

60
00:02:32,970 --> 00:02:38,400
everything Linux Windows Mac the filters

61
00:02:36,150 --> 00:02:40,800
are extremely<font color="#CCCCCC"> powerful so when it comes</font>

62
00:02:38,400 --> 00:02:43,080
to filtering<font color="#E5E5E5"> these packet captures you</font>

63
00:02:40,800 --> 00:02:45,300
can get to what you<font color="#CCCCCC"> want and it's free</font>

64
00:02:43,080 --> 00:02:47,100
the version that's<font color="#E5E5E5"> free is is</font>

65
00:02:45,300 --> 00:02:48,800
full-featured so<font color="#E5E5E5"> it's pretty amp pretty</font>

66
00:02:47,100 --> 00:02:51,480
much has everything<font color="#E5E5E5"> you need for</font>

67
00:02:48,800 --> 00:02:54,180
<font color="#CCCCCC">analysis</font><font color="#E5E5E5"> so if you haven't seen</font>

68
00:02:51,480 --> 00:02:56,459
<font color="#E5E5E5">Wireshark this is what it looks like</font><font color="#CCCCCC"> top</font>

69
00:02:54,180 --> 00:02:58,890
pane you have your packets<font color="#E5E5E5"> middle pane</font>

70
00:02:56,460 --> 00:03:01,350
you have the<font color="#CCCCCC"> breakdown of the different</font>

71
00:02:58,890 --> 00:03:04,649
<font color="#CCCCCC">layers of the packet and on the</font><font color="#E5E5E5"> bottom</font>

72
00:03:01,350 --> 00:03:06,210
you<font color="#CCCCCC"> have the raw bytes so just to cover</font>

73
00:03:04,650 --> 00:03:08,820
some fundamentals that<font color="#E5E5E5"> you need to know</font>

74
00:03:06,210 --> 00:03:10,680
<font color="#E5E5E5">for these types of attacks first thing</font>

75
00:03:08,820 --> 00:03:13,109
<font color="#CCCCCC">man-in-the-middle</font><font color="#E5E5E5"> if you haven't heard</font>

76
00:03:10,680 --> 00:03:14,820
<font color="#E5E5E5">of it basically you know normally two</font>

77
00:03:13,110 --> 00:03:17,280
systems would<font color="#E5E5E5"> communicate</font><font color="#CCCCCC"> with each</font>

78
00:03:14,820 --> 00:03:17,970
other directly<font color="#CCCCCC"> but when you become</font><font color="#E5E5E5"> the</font>

79
00:03:17,280 --> 00:03:19,740
man in the middle

80
00:03:17,970 --> 00:03:22,170
you're basically intercepting the

81
00:03:19,740 --> 00:03:24,870
communication and relaying it on both

82
00:03:22,170 --> 00:03:27,450
<font color="#E5E5E5">sides and you can just relay it directly</font>

83
00:03:24,870 --> 00:03:31,500
<font color="#E5E5E5">just to</font><font color="#CCCCCC"> monitor it or you can actually</font>

84
00:03:27,450 --> 00:03:33,239
alter<font color="#CCCCCC"> the contents in transit and one of</font>

85
00:03:31,500 --> 00:03:35,880
the ways that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can do this you can</font>

86
00:03:33,240 --> 00:03:38,220
spoof a host directly or you can spoof

87
00:03:35,880 --> 00:03:41,760
the default<font color="#CCCCCC"> gateway</font><font color="#E5E5E5"> if routing in</font>

88
00:03:38,220 --> 00:03:44,220
between different<font color="#E5E5E5"> subnets</font><font color="#CCCCCC"> the most</font>

89
00:03:41,760 --> 00:03:46,140
common way in the<font color="#E5E5E5"> simplest way you can</font>

90
00:03:44,220 --> 00:03:49,170
do<font color="#E5E5E5"> man-in-the-middle attacks as ARP</font>

91
00:03:46,140 --> 00:03:50,730
spoofing<font color="#CCCCCC"> if</font><font color="#E5E5E5"> you're taken in networking</font>

92
00:03:49,170 --> 00:03:54,570
class you might be familiar<font color="#CCCCCC"> with how ARP</font>

93
00:03:50,730 --> 00:03:56,670
works<font color="#CCCCCC"> but basically I resolves a layer</font>

94
00:03:54,570 --> 00:04:00,450
<font color="#E5E5E5">to address to a layer at the layer 3</font>

95
00:03:56,670 --> 00:04:04,019
address<font color="#E5E5E5"> and when a system doesn't know</font>

96
00:04:00,450 --> 00:04:05,910
the<font color="#CCCCCC"> IP address</font><font color="#E5E5E5"> it'll go ask but you can</font>

97
00:04:04,020 --> 00:04:06,390
also send these things called gratuitous

98
00:04:05,910 --> 00:04:09,990
<font color="#CCCCCC">Arps</font>

99
00:04:06,390 --> 00:04:11,820
which<font color="#E5E5E5"> you're you're updating clients ARP</font>

100
00:04:09,990 --> 00:04:13,920
tables on your land<font color="#CCCCCC"> even though they</font>

101
00:04:11,820 --> 00:04:16,170
didn't ask and if you send it they'll

102
00:04:13,920 --> 00:04:18,390
<font color="#CCCCCC">just believe it so the protocol by</font>

103
00:04:16,170 --> 00:04:20,580
itself<font color="#CCCCCC"> doesn't offer</font><font color="#E5E5E5"> much protection</font>

104
00:04:18,390 --> 00:04:22,200
there are some<font color="#E5E5E5"> network switches out</font>

105
00:04:20,579 --> 00:04:24,330
there that would attacked and block

106
00:04:22,200 --> 00:04:26,159
these types of<font color="#E5E5E5"> attacks</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> the protocol</font>

107
00:04:24,330 --> 00:04:29,550
by<font color="#E5E5E5"> itself doesn't have any mitigation</font>

108
00:04:26,160 --> 00:04:32,580
<font color="#E5E5E5">against spoofing</font><font color="#CCCCCC"> so the basics of</font><font color="#E5E5E5"> tea</font>

109
00:04:29,550 --> 00:04:36,870
CP you might all be familiar<font color="#E5E5E5"> but near</font>

110
00:04:32,580 --> 00:04:38,880
the<font color="#E5E5E5"> syn/ack</font><font color="#CCCCCC"> sannan-san</font><font color="#E5E5E5"> a CAC</font><font color="#CCCCCC"> the big</font>

111
00:04:36,870 --> 00:04:40,530
thing<font color="#CCCCCC"> here is the sequence numbers</font><font color="#E5E5E5"> so</font>

112
00:04:38,880 --> 00:04:44,340
these sequence numbers<font color="#E5E5E5"> keep track of</font>

113
00:04:40,530 --> 00:04:47,070
<font color="#E5E5E5">state</font><font color="#CCCCCC"> and as you send data</font><font color="#E5E5E5"> the sequence</font>

114
00:04:44,340 --> 00:04:48,750
number will increment<font color="#E5E5E5"> and on the other</font>

115
00:04:47,070 --> 00:04:50,490
<font color="#E5E5E5">side</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> acknowledgement number will</font>

116
00:04:48,750 --> 00:04:55,200
increment to acknowledge<font color="#E5E5E5"> that the data</font>

117
00:04:50,490 --> 00:04:57,600
got sent so currently sequence numbers

118
00:04:55,200 --> 00:05:00,510
are what we call pseudo-random<font color="#CCCCCC"> they're</font>

119
00:04:57,600 --> 00:05:02,160
<font color="#E5E5E5">they're a relatively random value so</font>

120
00:05:00,510 --> 00:05:04,020
<font color="#CCCCCC">that and it's someone who's</font><font color="#E5E5E5"> not part of</font>

121
00:05:02,160 --> 00:05:05,400
<font color="#E5E5E5">the communication can't guess these</font>

122
00:05:04,020 --> 00:05:08,520
numbers and start<font color="#E5E5E5"> sending data</font>

123
00:05:05,400 --> 00:05:10,200
<font color="#E5E5E5">pretending to be someone</font><font color="#CCCCCC"> else</font><font color="#E5E5E5"> if you</font>

124
00:05:08,520 --> 00:05:12,620
want<font color="#CCCCCC"> to learn a little</font><font color="#E5E5E5"> bit</font><font color="#CCCCCC"> more about</font>

125
00:05:10,200 --> 00:05:14,969
networking<font color="#CCCCCC"> I really recommend this book</font>

126
00:05:12,620 --> 00:05:19,470
<font color="#CCCCCC">practical packet analysis it'll go</font><font color="#E5E5E5"> over</font>

127
00:05:14,970 --> 00:05:22,140
<font color="#E5E5E5">the basics of TCP using Wireshark and it</font>

128
00:05:19,470 --> 00:05:25,770
kind of has some<font color="#E5E5E5"> good good chapters on</font>

129
00:05:22,140 --> 00:05:27,360
learning<font color="#CCCCCC"> how to analyze packets so one</font>

130
00:05:25,770 --> 00:05:30,180
thing I<font color="#E5E5E5"> wanted</font><font color="#CCCCCC"> to talk about</font><font color="#E5E5E5"> was TCP</font>

131
00:05:27,360 --> 00:05:34,020
session hijacking<font color="#E5E5E5"> so that's taking over</font>

132
00:05:30,180 --> 00:05:35,970
<font color="#E5E5E5">an</font><font color="#CCCCCC"> existing established</font><font color="#E5E5E5"> TCP session so</font>

133
00:05:34,020 --> 00:05:37,830
this is<font color="#E5E5E5"> something</font><font color="#CCCCCC"> that you shouldn't</font>

134
00:05:35,970 --> 00:05:40,950
that shouldn't<font color="#CCCCCC"> you shouldn't</font><font color="#E5E5E5"> be able to</font>

135
00:05:37,830 --> 00:05:43,080
<font color="#E5E5E5">do but you can</font><font color="#CCCCCC"> in some circumstances if</font>

136
00:05:40,950 --> 00:05:45,090
we go way back in<font color="#E5E5E5"> time to the time</font>

137
00:05:43,080 --> 00:05:47,880
<font color="#E5E5E5">period of kevin Mitnick he actually</font>

138
00:05:45,090 --> 00:05:50,340
pulled<font color="#E5E5E5"> off a TCP session hijack by</font>

139
00:05:47,880 --> 00:05:52,290
guessing<font color="#CCCCCC"> the TCP sequence number because</font>

140
00:05:50,340 --> 00:05:54,659
they weren't sufficiently random<font color="#CCCCCC"> and he</font>

141
00:05:52,290 --> 00:05:57,570
<font color="#CCCCCC">actually popped a shell</font><font color="#E5E5E5"> on the box</font><font color="#CCCCCC"> if</font>

142
00:05:54,660 --> 00:05:59,430
<font color="#E5E5E5">the</font><font color="#CCCCCC"> person who</font><font color="#E5E5E5"> was investigating</font><font color="#CCCCCC"> him now</font>

143
00:05:57,570 --> 00:06:01,680
these<font color="#E5E5E5"> numbers are random enough you</font>

144
00:05:59,430 --> 00:06:03,540
can't really guess them<font color="#E5E5E5"> but if you</font><font color="#CCCCCC"> can</font>

145
00:06:01,680 --> 00:06:05,880
put<font color="#CCCCCC"> yourself in a man in the middle a</font>

146
00:06:03,540 --> 00:06:08,130
man in the middle<font color="#CCCCCC"> position</font><font color="#E5E5E5"> in the</font>

147
00:06:05,880 --> 00:06:09,810
network<font color="#CCCCCC"> communication</font><font color="#E5E5E5"> you can sniff out</font>

148
00:06:08,130 --> 00:06:11,969
those sequence and<font color="#E5E5E5"> acknowledge numbers</font>

149
00:06:09,810 --> 00:06:14,190
and it<font color="#CCCCCC"> start spoofing packets to the</font>

150
00:06:11,970 --> 00:06:16,320
target and<font color="#E5E5E5"> one of the easy ways</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get</font>

151
00:06:14,190 --> 00:06:20,790
that man and man in the<font color="#E5E5E5"> middle</font><font color="#CCCCCC"> position</font>

152
00:06:16,320 --> 00:06:23,849
is with ARP spoofing<font color="#E5E5E5"> so TCP session</font>

153
00:06:20,790 --> 00:06:26,490
hijacking is been around<font color="#E5E5E5"> as long as TCP</font>

154
00:06:23,850 --> 00:06:29,490
has and there's been a lot<font color="#CCCCCC"> of tools open</font>

155
00:06:26,490 --> 00:06:32,850
<font color="#E5E5E5">source that you can</font><font color="#CCCCCC"> use to hijack a TCP</font>

156
00:06:29,490 --> 00:06:35,640
session<font color="#CCCCCC"> and while you can't stop someone</font>

157
00:06:32,850 --> 00:06:37,260
<font color="#E5E5E5">from hijacking</font><font color="#CCCCCC"> your TCP session if they</font>

158
00:06:35,640 --> 00:06:38,820
have man in the<font color="#E5E5E5"> middle you can</font>

159
00:06:37,260 --> 00:06:41,849
<font color="#E5E5E5">effectively mitigate the negative</font>

160
00:06:38,820 --> 00:06:42,770
<font color="#E5E5E5">results</font><font color="#CCCCCC"> of that by using crypto so if</font>

161
00:06:41,850 --> 00:06:45,139
you

162
00:06:42,770 --> 00:06:47,780
<font color="#CCCCCC">cript the communication channel</font><font color="#E5E5E5"> even if</font>

163
00:06:45,139 --> 00:06:50,210
they inject packets into<font color="#E5E5E5"> the TCP session</font>

164
00:06:47,780 --> 00:06:51,919
they won't really do anything<font color="#CCCCCC"> because</font>

165
00:06:50,210 --> 00:06:54,710
they don't<font color="#CCCCCC"> know</font><font color="#E5E5E5"> you know what the</font>

166
00:06:51,919 --> 00:06:57,258
content is<font color="#CCCCCC"> and then even</font><font color="#E5E5E5"> if it's not</font>

167
00:06:54,710 --> 00:06:59,900
fully encrypted<font color="#CCCCCC"> you can use some sort</font><font color="#E5E5E5"> of</font>

168
00:06:57,259 --> 00:07:03,800
message<font color="#E5E5E5"> digest or hash to protect the</font>

169
00:06:59,900 --> 00:07:07,099
integrity of<font color="#E5E5E5"> those packets so last word</font>

170
00:07:03,800 --> 00:07:09,379
on<font color="#E5E5E5"> that</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> TCP hijacking is cool</font><font color="#CCCCCC"> but</font>

171
00:07:07,099 --> 00:07:12,469
most<font color="#E5E5E5"> of the time you don't actually need</font>

172
00:07:09,379 --> 00:07:15,380
to perform a TCP session hijack<font color="#E5E5E5"> to have</font>

173
00:07:12,470 --> 00:07:17,659
the same<font color="#E5E5E5"> effect as</font><font color="#CCCCCC"> if you did so for</font>

174
00:07:15,380 --> 00:07:20,330
<font color="#E5E5E5">example if you were attacking telnet you</font>

175
00:07:17,659 --> 00:07:23,210
could use TCP session hijacking<font color="#CCCCCC"> to start</font>

176
00:07:20,330 --> 00:07:25,758
<font color="#E5E5E5">injecting commands into an existing</font>

177
00:07:23,210 --> 00:07:27,979
<font color="#E5E5E5">tonette session but typically it would</font>

178
00:07:25,759 --> 00:07:29,659
<font color="#E5E5E5">be much easier just to sniff the tonette</font>

179
00:07:27,979 --> 00:07:33,800
credentials<font color="#E5E5E5"> and in the start a new</font>

180
00:07:29,659 --> 00:07:35,659
<font color="#E5E5E5">session</font><font color="#CCCCCC"> so it's a lot</font><font color="#E5E5E5"> more simple that</font>

181
00:07:33,800 --> 00:07:37,789
way so all the<font color="#E5E5E5"> attacks that</font><font color="#CCCCCC"> I'm going to</font>

182
00:07:35,659 --> 00:07:39,979
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> from here on out I'm not</font>

183
00:07:37,789 --> 00:07:41,810
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to use TCP session hijacking to</font>

184
00:07:39,979 --> 00:07:45,590
perform them but all of them are

185
00:07:41,810 --> 00:07:47,000
possible with TCP session hijacking<font color="#CCCCCC"> so</font>

186
00:07:45,590 --> 00:07:50,270
the first protocol<font color="#CCCCCC"> I want to</font><font color="#E5E5E5"> talk about</font>

187
00:07:47,000 --> 00:07:52,550
is VNC<font color="#CCCCCC"> it's really popular it's similar</font>

188
00:07:50,270 --> 00:07:55,460
<font color="#CCCCCC">to you know</font><font color="#E5E5E5"> Microsoft Remote Desktop as</font>

189
00:07:52,550 --> 00:07:57,080
in you can take<font color="#CCCCCC"> control of</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> system you</font>

190
00:07:55,460 --> 00:07:59,299
know you see the screen move the mouse

191
00:07:57,080 --> 00:08:01,940
<font color="#CCCCCC">around</font><font color="#E5E5E5"> type on the keyboard</font><font color="#CCCCCC"> and have</font>

192
00:07:59,300 --> 00:08:04,130
your keystrokes<font color="#E5E5E5"> sent to the</font><font color="#CCCCCC"> Box uses</font>

193
00:08:01,940 --> 00:08:07,069
this protocol called<font color="#CCCCCC"> RF B or remote</font>

194
00:08:04,130 --> 00:08:10,130
frame buffer<font color="#E5E5E5"> and it doesn't none of this</font>

195
00:08:07,069 --> 00:08:12,229
the session isn't encrypted at all not

196
00:08:10,130 --> 00:08:14,240
the keystrokes the screen updates<font color="#E5E5E5"> or the</font>

197
00:08:12,229 --> 00:08:16,460
mouse movements and then the way to

198
00:08:14,240 --> 00:08:19,009
<font color="#E5E5E5">authenticate</font><font color="#CCCCCC"> says it</font><font color="#E5E5E5"> uses a password and</font>

199
00:08:16,460 --> 00:08:22,400
it uses<font color="#CCCCCC"> a handshake but it's only</font>

200
00:08:19,009 --> 00:08:24,529
encrypted with DES which is a very weak

201
00:08:22,400 --> 00:08:26,330
<font color="#E5E5E5">and deprecated protocol and the</font>

202
00:08:24,529 --> 00:08:27,949
passwords typically are truncated to

203
00:08:26,330 --> 00:08:31,818
<font color="#CCCCCC">eight characters which means they're</font>

204
00:08:27,949 --> 00:08:35,149
<font color="#E5E5E5">extremely easy to</font><font color="#CCCCCC"> brute-force also on</font>

205
00:08:31,819 --> 00:08:38,000
the actual VNC server there is a file

206
00:08:35,149 --> 00:08:40,039
that<font color="#E5E5E5"> stores the password for the VNC</font>

207
00:08:38,000 --> 00:08:43,159
server and this<font color="#CCCCCC"> password</font><font color="#E5E5E5"> too is</font>

208
00:08:40,039 --> 00:08:44,240
<font color="#E5E5E5">encrypted with DES</font><font color="#CCCCCC"> and it doesn't even</font>

209
00:08:43,159 --> 00:08:46,189
<font color="#E5E5E5">really matter that it's encrypted</font>

210
00:08:44,240 --> 00:08:49,040
<font color="#E5E5E5">because</font><font color="#CCCCCC"> all the passwords are encrypted</font>

211
00:08:46,190 --> 00:08:51,920
with<font color="#CCCCCC"> the same key which is in the source</font>

212
00:08:49,040 --> 00:08:54,529
code<font color="#CCCCCC"> of any</font><font color="#E5E5E5"> open source VNC client which</font>

213
00:08:51,920 --> 00:08:56,930
is<font color="#E5E5E5"> this one</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> so they're</font>

214
00:08:54,529 --> 00:09:01,189
effectively plaintext

215
00:08:56,930 --> 00:09:03,739
so all all of the<font color="#E5E5E5"> the security</font><font color="#CCCCCC"> of that</font>

216
00:09:01,190 --> 00:09:05,870
password<font color="#CCCCCC"> depends on the security of</font><font color="#E5E5E5"> that</font>

217
00:09:03,740 --> 00:09:08,209
<font color="#E5E5E5">system so if you have weak NTFS</font>

218
00:09:05,870 --> 00:09:11,720
permissions<font color="#CCCCCC"> that</font><font color="#E5E5E5"> pass someone</font><font color="#CCCCCC"> on that</font>

219
00:09:08,209 --> 00:09:14,000
<font color="#CCCCCC">system can</font><font color="#E5E5E5"> get that password so on the</font>

220
00:09:11,720 --> 00:09:17,510
wire this is what a VNC handshake looks

221
00:09:14,000 --> 00:09:20,270
like<font color="#E5E5E5"> so this is a TCP stream taken out</font>

222
00:09:17,510 --> 00:09:22,520
of Wireshark<font color="#E5E5E5"> and the first box we can</font>

223
00:09:20,270 --> 00:09:24,199
see<font color="#E5E5E5"> the challenge and then we can see</font>

224
00:09:22,520 --> 00:09:27,529
the<font color="#E5E5E5"> response from the client this is</font>

225
00:09:24,200 --> 00:09:29,750
<font color="#E5E5E5">derived from that</font><font color="#CCCCCC"> password</font><font color="#E5E5E5"> that both the</font>

226
00:09:27,529 --> 00:09:32,390
server<font color="#E5E5E5"> and the client know</font><font color="#CCCCCC"> and once they</font>

227
00:09:29,750 --> 00:09:34,490
establish establish<font color="#CCCCCC"> the connection</font><font color="#E5E5E5"> the</font>

228
00:09:32,390 --> 00:09:37,550
client can start<font color="#E5E5E5"> sending keystrokes to</font>

229
00:09:34,490 --> 00:09:39,560
the server<font color="#CCCCCC"> and if you look here on that</font>

230
00:09:37,550 --> 00:09:42,740
very end<font color="#CCCCCC"> they're actually just all plain</font>

231
00:09:39,560 --> 00:09:44,329
text is just<font color="#CCCCCC"> ascii right here so if</font>

232
00:09:42,740 --> 00:09:47,180
you're<font color="#CCCCCC"> just</font><font color="#E5E5E5"> looking at the network</font>

233
00:09:44,330 --> 00:09:50,959
<font color="#CCCCCC">traffic you can see all the keys</font><font color="#E5E5E5"> that</font>

234
00:09:47,180 --> 00:09:52,729
the user is typing<font color="#E5E5E5"> through VNC so when</font>

235
00:09:50,959 --> 00:09:55,640
it comes to monitoring<font color="#E5E5E5"> these keystrokes</font>

236
00:09:52,730 --> 00:09:57,709
<font color="#E5E5E5">it's pretty easy you can</font><font color="#CCCCCC"> just get a peek</font>

237
00:09:55,640 --> 00:09:59,839
<font color="#E5E5E5">app look at it in Wireshark like that</font>

238
00:09:57,709 --> 00:10:02,660
<font color="#E5E5E5">there's also a Python tool called VNC</font>

239
00:09:59,839 --> 00:10:04,399
<font color="#E5E5E5">key logger</font><font color="#CCCCCC"> there's another older tool</font>

240
00:10:02,660 --> 00:10:07,459
called Foss that you can sniff out the

241
00:10:04,399 --> 00:10:10,130
handshakes handshakes again<font color="#E5E5E5"> easily</font>

242
00:10:07,459 --> 00:10:13,459
cracked<font color="#CCCCCC"> Des</font><font color="#E5E5E5"> eight characters you can</font>

243
00:10:10,130 --> 00:10:15,800
exhaust<font color="#E5E5E5"> the entire key space every time</font>

244
00:10:13,459 --> 00:10:17,239
so no matter what the password is<font color="#E5E5E5"> you</font>

245
00:10:15,800 --> 00:10:20,770
will always<font color="#CCCCCC"> be</font><font color="#E5E5E5"> able to recover the</font>

246
00:10:17,240 --> 00:10:23,600
plaintext<font color="#E5E5E5"> probably</font><font color="#CCCCCC"> within an hour or</font><font color="#E5E5E5"> two</font>

247
00:10:20,770 --> 00:10:25,819
<font color="#E5E5E5">VNC crack you</font><font color="#CCCCCC"> can use that to crack it</font>

248
00:10:23,600 --> 00:10:29,029
<font color="#E5E5E5">Cain</font><font color="#CCCCCC"> and Abel for sniffing and cracking</font>

249
00:10:25,820 --> 00:10:31,220
as well<font color="#E5E5E5"> so once you do get this password</font>

250
00:10:29,029 --> 00:10:32,500
<font color="#E5E5E5">if your man in the middle you sniff out</font>

251
00:10:31,220 --> 00:10:35,060
<font color="#E5E5E5">this handshake you crack the password</font>

252
00:10:32,500 --> 00:10:37,579
<font color="#E5E5E5">what can you do well you</font><font color="#CCCCCC"> can use a</font>

253
00:10:35,060 --> 00:10:40,069
regular VNC client<font color="#E5E5E5"> and you can connect</font>

254
00:10:37,579 --> 00:10:42,349
to<font color="#E5E5E5"> the server but there's something a</font>

255
00:10:40,070 --> 00:10:44,870
little<font color="#E5E5E5"> bit better you can do and that's</font>

256
00:10:42,350 --> 00:10:46,940
<font color="#E5E5E5">just connecting with something automated</font>

257
00:10:44,870 --> 00:10:47,390
<font color="#E5E5E5">sending the keystrokes and getting out</font>

258
00:10:46,940 --> 00:10:49,459
<font color="#E5E5E5">of there</font>

259
00:10:47,390 --> 00:10:51,260
so someone made a Metasploit module that

260
00:10:49,459 --> 00:10:53,060
does<font color="#CCCCCC"> this exactly</font><font color="#E5E5E5"> and it's kind of cool</font>

261
00:10:51,260 --> 00:10:55,490
so what it will do is it will connect

262
00:10:53,060 --> 00:10:58,760
<font color="#E5E5E5">over this</font><font color="#CCCCCC"> our efi protocol sending</font>

263
00:10:55,490 --> 00:11:01,310
keystrokes<font color="#E5E5E5"> to send a meterpreter payload</font>

264
00:10:58,760 --> 00:11:03,319
and then execute<font color="#E5E5E5"> it</font><font color="#CCCCCC"> so right here</font><font color="#E5E5E5"> we</font>

265
00:11:01,310 --> 00:11:05,329
have<font color="#CCCCCC"> Metasploit on the right on kali</font>

266
00:11:03,320 --> 00:11:07,850
<font color="#CCCCCC">linux</font><font color="#E5E5E5"> and on the Left we have a Windows</font>

267
00:11:05,329 --> 00:11:09,880
7<font color="#E5E5E5"> system</font><font color="#CCCCCC"> so the windows</font><font color="#E5E5E5"> 7</font><font color="#CCCCCC"> system is</font>

268
00:11:07,850 --> 00:11:12,910
running<font color="#CCCCCC"> a VNC server</font>

269
00:11:09,880 --> 00:11:16,180
and<font color="#CCCCCC"> Metasploit is using that module</font><font color="#E5E5E5"> with</font>

270
00:11:12,910 --> 00:11:19,329
the<font color="#E5E5E5"> password enabled so we see here we</font>

271
00:11:16,180 --> 00:11:21,189
run the module<font color="#E5E5E5"> and then we open up a</font>

272
00:11:19,330 --> 00:11:22,810
command prompt on<font color="#E5E5E5"> the victim and we</font>

273
00:11:21,190 --> 00:11:24,790
<font color="#E5E5E5">started sending keystrokes really really</font>

274
00:11:22,810 --> 00:11:27,130
fast<font color="#CCCCCC"> and then boom right there</font>

275
00:11:24,790 --> 00:11:29,709
<font color="#E5E5E5">mature procession open so</font><font color="#CCCCCC"> just like that</font>

276
00:11:27,130 --> 00:11:31,450
<font color="#CCCCCC">you don't have to spend a lot</font><font color="#E5E5E5"> of time on</font>

277
00:11:29,710 --> 00:11:33,520
the victim system just within a few

278
00:11:31,450 --> 00:11:35,830
<font color="#E5E5E5">seconds you</font><font color="#CCCCCC"> can completely</font><font color="#E5E5E5"> compromise</font>

279
00:11:33,520 --> 00:11:38,590
the<font color="#E5E5E5"> system with the meterpreter session</font>

280
00:11:35,830 --> 00:11:43,270
<font color="#E5E5E5">just by using the protocol to</font><font color="#CCCCCC"> send</font><font color="#E5E5E5"> the</font>

281
00:11:38,590 --> 00:11:46,660
keystrokes<font color="#CCCCCC"> so on to my original research</font>

282
00:11:43,270 --> 00:11:48,460
<font color="#CCCCCC">I found</font><font color="#E5E5E5"> this app for my Mac and my</font>

283
00:11:46,660 --> 00:11:50,980
<font color="#E5E5E5">iPhone it was called hippo remote and</font>

284
00:11:48,460 --> 00:11:53,380
basically the way<font color="#E5E5E5"> it worked</font><font color="#CCCCCC"> is if you</font>

285
00:11:50,980 --> 00:11:56,410
had a laptop<font color="#E5E5E5"> and you wanted</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use say</font>

286
00:11:53,380 --> 00:11:58,240
your iPhone as an external trackpad you

287
00:11:56,410 --> 00:11:59,800
could download this app you know sync it

288
00:11:58,240 --> 00:12:02,500
with<font color="#E5E5E5"> your device and then you could</font>

289
00:11:59,800 --> 00:12:04,810
start<font color="#E5E5E5"> using your phone as an external</font>

290
00:12:02,500 --> 00:12:06,610
mouse or keyboard<font color="#E5E5E5"> and also boasted</font>

291
00:12:04,810 --> 00:12:08,589
features such as you know<font color="#E5E5E5"> being a</font>

292
00:12:06,610 --> 00:12:11,860
password manager which made it<font color="#E5E5E5"> really</font>

293
00:12:08,590 --> 00:12:14,980
interesting<font color="#CCCCCC"> too so here's kind of an</font>

294
00:12:11,860 --> 00:12:16,240
example the developer made this<font color="#E5E5E5"> you can</font>

295
00:12:14,980 --> 00:12:18,550
see where they're using<font color="#E5E5E5"> it kind</font><font color="#CCCCCC"> of like</font>

296
00:12:16,240 --> 00:12:21,730
a mouse they'll move their finger around

297
00:12:18,550 --> 00:12:24,609
<font color="#E5E5E5">on the iPhone</font><font color="#CCCCCC"> they'll click in the paw</font>

298
00:12:21,730 --> 00:12:26,470
click in the box<font color="#E5E5E5"> and they'll go</font><font color="#CCCCCC"> insane</font>

299
00:12:24,610 --> 00:12:28,060
keystrokes<font color="#E5E5E5"> in this case it's their</font><font color="#CCCCCC"> user</font>

300
00:12:26,470 --> 00:12:30,880
<font color="#CCCCCC">name and password and they came</font><font color="#E5E5E5"> you know</font>

301
00:12:28,060 --> 00:12:34,329
<font color="#CCCCCC">login to their stuff so that's basically</font>

302
00:12:30,880 --> 00:12:36,340
the<font color="#CCCCCC"> design</font><font color="#E5E5E5"> around it and how it works so</font>

303
00:12:34,330 --> 00:12:38,950
what I found when<font color="#E5E5E5"> I was</font><font color="#CCCCCC"> analyzing it is</font>

304
00:12:36,340 --> 00:12:41,950
if you were<font color="#CCCCCC"> using</font><font color="#E5E5E5"> it on Windows</font><font color="#CCCCCC"> it had</font>

305
00:12:38,950 --> 00:12:45,190
this thing called<font color="#CCCCCC"> a hippo something but</font>

306
00:12:41,950 --> 00:12:47,620
it<font color="#E5E5E5"> was basically a VNC server that was</font>

307
00:12:45,190 --> 00:12:49,810
just a fork of<font color="#E5E5E5"> ultra VNC so as far as</font>

308
00:12:47,620 --> 00:12:53,110
<font color="#E5E5E5">attacking it all of that was the same</font>

309
00:12:49,810 --> 00:12:55,000
<font color="#CCCCCC">same for the Linux version</font><font color="#E5E5E5"> where instead</font>

310
00:12:53,110 --> 00:12:59,170
of<font color="#CCCCCC"> shipping a VNC client you just used</font>

311
00:12:55,000 --> 00:13:01,780
whatever VNC server<font color="#E5E5E5"> comes with comes</font>

312
00:12:59,170 --> 00:13:04,300
<font color="#E5E5E5">with your distro Enix but on Mac it</font>

313
00:13:01,780 --> 00:13:06,459
<font color="#E5E5E5">actually had its own app so that's what</font>

314
00:13:04,300 --> 00:13:09,670
I found really<font color="#E5E5E5"> interesting so I wanted</font>

315
00:13:06,460 --> 00:13:11,890
<font color="#CCCCCC">to dig in that a</font><font color="#E5E5E5"> little bit so when it</font>

316
00:13:09,670 --> 00:13:13,900
comes to the<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> app it actually has</font>

317
00:13:11,890 --> 00:13:16,990
a lot of<font color="#E5E5E5"> problems</font><font color="#CCCCCC"> even outside</font><font color="#E5E5E5"> the</font>

318
00:13:13,900 --> 00:13:19,240
network side<font color="#E5E5E5"> so the password storage the</font>

319
00:13:16,990 --> 00:13:21,880
password for the server is all stored in

320
00:13:19,240 --> 00:13:23,680
<font color="#E5E5E5">a plist file and if you have a Mac</font><font color="#CCCCCC"> you</font>

321
00:13:21,880 --> 00:13:26,980
probably know that the<font color="#CCCCCC"> plist</font><font color="#E5E5E5"> file</font>

322
00:13:23,680 --> 00:13:29,170
like config files<font color="#CCCCCC"> so in the launch</font>

323
00:13:26,980 --> 00:13:31,210
daemon in launch agents which is how you

324
00:13:29,170 --> 00:13:34,479
get something to automatically start<font color="#E5E5E5"> on</font>

325
00:13:31,210 --> 00:13:37,360
each<font color="#E5E5E5"> login or boot up</font><font color="#CCCCCC"> they have this</font>

326
00:13:34,480 --> 00:13:38,950
<font color="#E5E5E5">plist file which is basically XML and</font>

327
00:13:37,360 --> 00:13:41,110
the password<font color="#E5E5E5"> is just in their</font>

328
00:13:38,950 --> 00:13:43,570
unencrypted<font color="#CCCCCC"> and what makes</font><font color="#E5E5E5"> it even worse</font>

329
00:13:41,110 --> 00:13:46,990
than<font color="#E5E5E5"> that is that these pilas files are</font>

330
00:13:43,570 --> 00:13:49,420
world<font color="#CCCCCC"> readable by everybody so even if</font>

331
00:13:46,990 --> 00:13:51,880
you signed in as the guest account<font color="#E5E5E5"> with</font>

332
00:13:49,420 --> 00:13:53,680
<font color="#CCCCCC">no real privileges you could go and look</font>

333
00:13:51,880 --> 00:13:55,959
at this<font color="#CCCCCC"> password</font><font color="#E5E5E5"> so that</font><font color="#CCCCCC"> when a high</font>

334
00:13:53,680 --> 00:13:57,670
privileged user logged in<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> now</font>

335
00:13:55,959 --> 00:14:00,160
<font color="#CCCCCC">start sending keystrokes to</font><font color="#E5E5E5"> their system</font>

336
00:13:57,670 --> 00:14:02,290
and then<font color="#E5E5E5"> also the actual binary itself</font>

337
00:14:00,160 --> 00:14:04,930
<font color="#CCCCCC">execute</font><font color="#E5E5E5"> this route so</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> you're able to</font>

338
00:14:02,290 --> 00:14:06,370
find any vulnerability<font color="#E5E5E5"> in the</font>

339
00:14:04,930 --> 00:14:08,349
<font color="#E5E5E5">application such</font><font color="#CCCCCC"> as like a buffer</font>

340
00:14:06,370 --> 00:14:09,730
overflow or something<font color="#E5E5E5"> like</font><font color="#CCCCCC"> that you</font>

341
00:14:08,350 --> 00:14:13,180
could<font color="#CCCCCC"> potentially get</font><font color="#E5E5E5"> a root</font><font color="#CCCCCC"> shell out</font>

342
00:14:09,730 --> 00:14:14,529
<font color="#E5E5E5">of that too so here's the</font><font color="#CCCCCC"> P</font><font color="#E5E5E5"> list</font><font color="#CCCCCC"> I know</font>

343
00:14:13,180 --> 00:14:16,689
it's kind of<font color="#E5E5E5"> hard to see on this screen</font>

344
00:14:14,529 --> 00:14:18,760
but<font color="#E5E5E5"> the gist of it</font><font color="#CCCCCC"> is it's got the</font>

345
00:14:16,690 --> 00:14:22,510
password<font color="#CCCCCC"> in plain</font><font color="#E5E5E5"> text and it's world</font>

346
00:14:18,760 --> 00:14:24,790
<font color="#E5E5E5">readable to everybody</font><font color="#CCCCCC"> so again very</font>

347
00:14:22,510 --> 00:14:27,850
similar<font color="#E5E5E5"> to VNC all the same flaws</font>

348
00:14:24,790 --> 00:14:29,920
effectively<font color="#E5E5E5"> here's the stream we</font><font color="#CCCCCC"> have</font>

349
00:14:27,850 --> 00:14:32,620
the challenge right<font color="#CCCCCC"> there</font><font color="#E5E5E5"> in the blue</font>

350
00:14:29,920 --> 00:14:36,699
the handshake and then we<font color="#CCCCCC"> actually start</font>

351
00:14:32,620 --> 00:14:40,930
sending the commands<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> Mac using</font>

352
00:14:36,700 --> 00:14:43,029
this is basically JSON that<font color="#E5E5E5"> $0.08 so</font>

353
00:14:40,930 --> 00:14:45,189
let's say you have man in the middle<font color="#E5E5E5"> and</font>

354
00:14:43,029 --> 00:14:47,410
you want to sniff out what someone's

355
00:14:45,190 --> 00:14:49,810
<font color="#CCCCCC">doing</font><font color="#E5E5E5"> like say they're using the hippo</font>

356
00:14:47,410 --> 00:14:52,390
remote and they want to<font color="#E5E5E5"> log into their</font>

357
00:14:49,810 --> 00:14:54,640
Pandora or<font color="#E5E5E5"> their Gmail or whatever so</font>

358
00:14:52,390 --> 00:14:57,040
what you<font color="#E5E5E5"> would do is you would run this</font>

359
00:14:54,640 --> 00:14:59,199
tool I made it's called angry hippo<font color="#E5E5E5"> and</font>

360
00:14:57,040 --> 00:15:00,819
basically what it does it just<font color="#E5E5E5"> sits</font>

361
00:14:59,200 --> 00:15:03,459
there<font color="#E5E5E5"> and it looks for hippo remote</font>

362
00:15:00,820 --> 00:15:07,240
traffic so there's<font color="#E5E5E5"> the hippo is angry</font>

363
00:15:03,459 --> 00:15:09,400
<font color="#E5E5E5">you can tell by the angry</font><font color="#CCCCCC"> eyes so</font>

364
00:15:07,240 --> 00:15:12,100
there's the handshake<font color="#E5E5E5"> you get that and</font>

365
00:15:09,400 --> 00:15:13,449
then<font color="#E5E5E5"> keystrokes start coming down</font><font color="#CCCCCC"> I if</font>

366
00:15:12,100 --> 00:15:15,310
you're in the back maybe<font color="#E5E5E5"> you can't read</font>

367
00:15:13,450 --> 00:15:19,230
it but it basically<font color="#E5E5E5"> says hello</font><font color="#CCCCCC"> you can</font>

368
00:15:15,310 --> 00:15:22,869
see the key<font color="#E5E5E5"> down</font><font color="#CCCCCC"> and the key up commands</font>

369
00:15:19,230 --> 00:15:24,279
<font color="#CCCCCC">so so you can sniff</font><font color="#E5E5E5"> it out but let's say</font>

370
00:15:22,870 --> 00:15:26,680
you<font color="#E5E5E5"> want to start actually sending</font>

371
00:15:24,279 --> 00:15:28,390
keystrokes yourself well you<font color="#E5E5E5"> get you</font>

372
00:15:26,680 --> 00:15:31,810
need to<font color="#E5E5E5"> get the handshake just like VNC</font>

373
00:15:28,390 --> 00:15:36,040
<font color="#E5E5E5">so there's this sniff thing or you run</font>

374
00:15:31,810 --> 00:15:38,500
sniff first you get the<font color="#E5E5E5"> you get the chow</font>

375
00:15:36,040 --> 00:15:40,870
from the server and<font color="#E5E5E5"> then you get the</font>

376
00:15:38,500 --> 00:15:43,120
response<font color="#E5E5E5"> from the client and you can</font>

377
00:15:40,870 --> 00:15:45,730
just plug these back<font color="#CCCCCC"> into angry hippo</font>

378
00:15:43,120 --> 00:15:48,180
and give<font color="#E5E5E5"> it a word list and it will</font><font color="#CCCCCC"> go</font>

379
00:15:45,730 --> 00:15:50,710
and find<font color="#E5E5E5"> the plaintext password for you</font>

380
00:15:48,180 --> 00:15:53,140
<font color="#CCCCCC">so in this example</font><font color="#E5E5E5"> I have</font><font color="#CCCCCC"> a small word</font>

381
00:15:50,710 --> 00:15:56,710
list<font color="#CCCCCC"> but I actually ran this against the</font>

382
00:15:53,140 --> 00:15:58,870
rocky word list<font color="#CCCCCC"> in Kali Linux and</font><font color="#E5E5E5"> I in</font>

383
00:15:56,710 --> 00:16:00,370
my single threaded Python script<font color="#CCCCCC"> I</font><font color="#E5E5E5"> was</font>

384
00:15:58,870 --> 00:16:03,220
able<font color="#E5E5E5"> to iterate</font><font color="#CCCCCC"> through every password</font>

385
00:16:00,370 --> 00:16:06,340
<font color="#E5E5E5">in that word list in about five minutes</font>

386
00:16:03,220 --> 00:16:08,860
so again cracking is really fast<font color="#E5E5E5"> even</font><font color="#CCCCCC"> if</font>

387
00:16:06,340 --> 00:16:11,440
you're<font color="#E5E5E5"> using just a simple single thread</font>

388
00:16:08,860 --> 00:16:13,540
<font color="#CCCCCC">of Python script so here's the cool part</font>

389
00:16:11,440 --> 00:16:16,660
right<font color="#E5E5E5"> so</font><font color="#CCCCCC"> once</font><font color="#E5E5E5"> you crack the handshake</font>

390
00:16:13,540 --> 00:16:19,449
<font color="#CCCCCC">you have the</font><font color="#E5E5E5"> password so you can connect</font>

391
00:16:16,660 --> 00:16:21,459
to<font color="#E5E5E5"> this Mac system and start sending</font>

392
00:16:19,450 --> 00:16:23,230
keystrokes to<font color="#E5E5E5"> it and at this point you</font>

393
00:16:21,460 --> 00:16:25,390
no longer<font color="#E5E5E5"> need a man in the middle</font>

394
00:16:23,230 --> 00:16:27,730
<font color="#CCCCCC">position</font><font color="#E5E5E5"> you just needed that man in the</font>

395
00:16:25,390 --> 00:16:30,760
middle<font color="#CCCCCC"> position to get</font><font color="#E5E5E5"> the plain text</font>

396
00:16:27,730 --> 00:16:32,770
<font color="#CCCCCC">password so right here we're gonna run</font>

397
00:16:30,760 --> 00:16:36,250
angry hippo again<font color="#E5E5E5"> and we're gonna put</font>

398
00:16:32,770 --> 00:16:37,840
open up a netcat listener as well so we

399
00:16:36,250 --> 00:16:40,990
run it<font color="#E5E5E5"> and watch closely</font>

400
00:16:37,840 --> 00:16:43,420
boom reverse shell<font color="#E5E5E5"> just like that so it</font>

401
00:16:40,990 --> 00:16:46,810
can<font color="#E5E5E5"> be super fast</font><font color="#CCCCCC"> if you blink you might</font>

402
00:16:43,420 --> 00:16:49,329
miss it<font color="#CCCCCC"> but just</font><font color="#E5E5E5"> like that you know you</font>

403
00:16:46,810 --> 00:16:52,390
<font color="#E5E5E5">can send some commands really quickly</font>

404
00:16:49,330 --> 00:16:54,310
<font color="#CCCCCC">and compromise</font><font color="#E5E5E5"> the host so I have a</font>

405
00:16:52,390 --> 00:16:56,560
little<font color="#E5E5E5"> bit slowed down version so you</font>

406
00:16:54,310 --> 00:17:00,010
can<font color="#E5E5E5"> see it so I</font><font color="#CCCCCC"> open a netcat listener</font>

407
00:16:56,560 --> 00:17:02,890
I run angry hippo<font color="#E5E5E5"> you can see me open</font>

408
00:17:00,010 --> 00:17:06,879
spotlight<font color="#E5E5E5"> type in terminal terminal</font>

409
00:17:02,890 --> 00:17:10,379
window opens<font color="#CCCCCC"> I type in a or the script</font>

410
00:17:06,880 --> 00:17:13,060
<font color="#E5E5E5">puts in a one-liner</font><font color="#CCCCCC"> for a reverse shell</font>

411
00:17:10,380 --> 00:17:15,250
<font color="#E5E5E5">backgrounds it presses enter closes out</font>

412
00:17:13,060 --> 00:17:17,260
<font color="#CCCCCC">the terminal window now we don't see</font>

413
00:17:15,250 --> 00:17:21,670
<font color="#CCCCCC">anything but I have remote access to</font>

414
00:17:17,260 --> 00:17:23,949
that<font color="#E5E5E5"> Mac system so if you're ever</font>

415
00:17:21,670 --> 00:17:25,570
wondering<font color="#E5E5E5"> if say I don't know if I</font><font color="#CCCCCC"> if</font>

416
00:17:23,949 --> 00:17:27,970
hippo remote is on my<font color="#E5E5E5"> network and I'd</font>

417
00:17:25,569 --> 00:17:30,909
like<font color="#E5E5E5"> to</font><font color="#CCCCCC"> know well just</font><font color="#E5E5E5"> like almost</font>

418
00:17:27,970 --> 00:17:33,280
everything<font color="#E5E5E5"> on Macs it uses</font><font color="#CCCCCC"> Bonjour to</font>

419
00:17:30,910 --> 00:17:35,470
advertise what services are there so I

420
00:17:33,280 --> 00:17:37,450
here in this app I have this thing

421
00:17:35,470 --> 00:17:39,850
called bonjour browser<font color="#E5E5E5"> and you can</font>

422
00:17:37,450 --> 00:17:41,950
actually see there's hippo remote on the

423
00:17:39,850 --> 00:17:44,169
<font color="#E5E5E5">network it shows you what</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> host name</font>

424
00:17:41,950 --> 00:17:47,110
is it shows<font color="#E5E5E5"> you what the IP address</font><font color="#CCCCCC"> is</font>

425
00:17:44,170 --> 00:17:48,520
<font color="#E5E5E5">it shows you</font><font color="#CCCCCC"> what port it's on</font><font color="#E5E5E5"> and also</font>

426
00:17:47,110 --> 00:17:49,959
<font color="#CCCCCC">if you were to take a</font><font color="#E5E5E5"> wireshark capture</font>

427
00:17:48,520 --> 00:17:56,860
<font color="#E5E5E5">you would be able to get that</font>

428
00:17:49,960 --> 00:17:59,049
<font color="#CCCCCC">- so in general you usually don't</font><font color="#E5E5E5"> want</font>

429
00:17:56,860 --> 00:18:01,090
<font color="#CCCCCC">to use</font><font color="#E5E5E5"> VNC nowadays unless it's some</font>

430
00:17:59,049 --> 00:18:03,279
upgraded version where they<font color="#E5E5E5"> added crypto</font>

431
00:18:01,090 --> 00:18:05,080
because by<font color="#CCCCCC"> default it doesn't have that</font>

432
00:18:03,279 --> 00:18:08,470
one of the things you<font color="#E5E5E5"> can do if you</font>

433
00:18:05,080 --> 00:18:11,889
still want to use VNC<font color="#CCCCCC"> is you can</font><font color="#E5E5E5"> create</font>

434
00:18:08,470 --> 00:18:14,499
an SSH tunnel between<font color="#E5E5E5"> one target and</font>

435
00:18:11,889 --> 00:18:15,309
another<font color="#E5E5E5"> and tunnel all your VNC traffic</font>

436
00:18:14,499 --> 00:18:17,769
through there

437
00:18:15,309 --> 00:18:19,269
and<font color="#E5E5E5"> that will protect it and I would</font>

438
00:18:17,769 --> 00:18:22,029
<font color="#E5E5E5">just recommend not using</font><font color="#CCCCCC"> the hippo</font>

439
00:18:19,269 --> 00:18:24,129
<font color="#CCCCCC">Connect</font><font color="#E5E5E5"> Mac OS app if you do just</font>

440
00:18:22,029 --> 00:18:25,450
<font color="#E5E5E5">because it's no longer maintained and</font>

441
00:18:24,129 --> 00:18:27,039
there's really no way to secure it at

442
00:18:25,450 --> 00:18:30,070
all

443
00:18:27,039 --> 00:18:32,139
the next thing I did<font color="#E5E5E5"> as far</font><font color="#CCCCCC"> as research</font>

444
00:18:30,070 --> 00:18:34,450
was<font color="#E5E5E5"> I found</font><font color="#CCCCCC"> this cool app I actually</font>

445
00:18:32,139 --> 00:18:36,820
really like<font color="#CCCCCC"> it it's called synergy and</font>

446
00:18:34,450 --> 00:18:40,059
<font color="#E5E5E5">what it does is it allows</font><font color="#CCCCCC"> you to share</font>

447
00:18:36,820 --> 00:18:43,509
one mouse and keyboard<font color="#E5E5E5"> across multiple</font>

448
00:18:40,059 --> 00:18:46,330
different<font color="#E5E5E5"> systems of various OSS so if</font>

449
00:18:43,509 --> 00:18:48,549
you had a Linux box<font color="#CCCCCC"> a</font><font color="#E5E5E5"> Mac box in a</font>

450
00:18:46,330 --> 00:18:50,740
Windows box<font color="#CCCCCC"> you could use the same mouse</font>

451
00:18:48,549 --> 00:18:53,529
and keyboard to move across all three

452
00:18:50,740 --> 00:18:55,929
screens and send commands<font color="#CCCCCC"> to them</font><font color="#E5E5E5"> so</font>

453
00:18:53,529 --> 00:18:57,549
when I started<font color="#CCCCCC"> doing this research now</font>

454
00:18:55,929 --> 00:18:57,999
there was basically two versions of<font color="#E5E5E5"> the</font>

455
00:18:57,549 --> 00:19:00,700
software

456
00:18:57,999 --> 00:19:02,590
<font color="#CCCCCC">there was the basic edition which didn't</font>

457
00:19:00,700 --> 00:19:05,830
have any encryption<font color="#CCCCCC"> and there was the</font>

458
00:19:02,590 --> 00:19:07,449
pro version<font color="#E5E5E5"> that was SSL encrypted so</font>

459
00:19:05,830 --> 00:19:09,428
knowing<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the basic one didn't have</font>

460
00:19:07,450 --> 00:19:11,049
<font color="#E5E5E5">any encryption and people are cheap in</font>

461
00:19:09,429 --> 00:19:14,200
general I was<font color="#E5E5E5"> like okay that's the one</font>

462
00:19:11,049 --> 00:19:15,820
<font color="#E5E5E5">I'm going to look at now after I did</font>

463
00:19:14,200 --> 00:19:19,330
this<font color="#E5E5E5"> research they came out with synergy</font>

464
00:19:15,820 --> 00:19:21,939
<font color="#CCCCCC">2 which uses SSL for</font><font color="#E5E5E5"> both the basic and</font>

465
00:19:19,330 --> 00:19:24,369
<font color="#CCCCCC">Pro</font><font color="#E5E5E5"> so now if you were to buy</font><font color="#CCCCCC"> it you</font>

466
00:19:21,940 --> 00:19:27,100
<font color="#CCCCCC">pretty relatively</font><font color="#E5E5E5"> safe because they have</font>

467
00:19:24,369 --> 00:19:29,649
<font color="#E5E5E5">encryption for both so when it came to</font>

468
00:19:27,100 --> 00:19:32,559
monitoring<font color="#E5E5E5"> the keystrokes</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> synergy</font>

469
00:19:29,649 --> 00:19:34,869
basic it was just like the other ones

470
00:19:32,559 --> 00:19:37,779
and super easy so right here

471
00:19:34,869 --> 00:19:39,850
I have nine lines of Python and I'm

472
00:19:37,779 --> 00:19:42,220
using the scape<font color="#CCCCCC"> II library</font><font color="#E5E5E5"> and this</font>

473
00:19:39,850 --> 00:19:45,730
right here<font color="#E5E5E5"> will sniff all the traffic</font>

474
00:19:42,220 --> 00:19:48,610
TCP<font color="#E5E5E5"> to the default port</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> four eight</font>

475
00:19:45,730 --> 00:19:51,820
<font color="#E5E5E5">zero zero</font><font color="#CCCCCC"> it'll look for the</font><font color="#E5E5E5"> decay decay</font>

476
00:19:48,610 --> 00:19:53,350
DN string which is<font color="#E5E5E5"> the key down and it</font>

477
00:19:51,820 --> 00:19:56,080
<font color="#E5E5E5">will just print out whatever character</font>

478
00:19:53,350 --> 00:19:57,639
is typed<font color="#E5E5E5"> so really that's all you need</font>

479
00:19:56,080 --> 00:20:01,240
to just start sniffing out these

480
00:19:57,639 --> 00:20:03,129
keystrokes<font color="#E5E5E5"> if they're using synergy so</font>

481
00:20:01,240 --> 00:20:04,810
when it came to hijacking it<font color="#E5E5E5"> it was a</font>

482
00:20:03,130 --> 00:20:07,200
a bit<font color="#E5E5E5"> different than the other attack</font>

483
00:20:04,810 --> 00:20:09,550
paths<font color="#E5E5E5"> so instead of the client</font>

484
00:20:07,200 --> 00:20:11,020
authenticating to the server<font color="#E5E5E5"> you</font>

485
00:20:09,550 --> 00:20:12,730
actually had the<font color="#E5E5E5"> server just kind of</font>

486
00:20:11,020 --> 00:20:14,620
sitting<font color="#CCCCCC"> there and you would configure</font>

487
00:20:12,730 --> 00:20:17,200
the client to talk to it

488
00:20:14,620 --> 00:20:21,939
so all<font color="#E5E5E5"> the validation was happening on</font>

489
00:20:17,200 --> 00:20:25,060
<font color="#E5E5E5">the</font><font color="#CCCCCC"> client side</font><font color="#E5E5E5"> not the server side</font><font color="#CCCCCC"> so</font>

490
00:20:21,940 --> 00:20:28,360
again<font color="#E5E5E5"> what what I'm gonna do here is I'm</font>

491
00:20:25,060 --> 00:20:31,090
<font color="#CCCCCC">gonna use</font><font color="#E5E5E5"> Bonjour so one of the things</font>

492
00:20:28,360 --> 00:20:33,520
that synergy<font color="#E5E5E5"> has is it</font><font color="#CCCCCC"> has this Auto</font>

493
00:20:31,090 --> 00:20:35,919
config option and what it<font color="#E5E5E5"> will do for</font>

494
00:20:33,520 --> 00:20:39,040
<font color="#E5E5E5">you is will say</font><font color="#CCCCCC"> ok I don't know where</font>

495
00:20:35,920 --> 00:20:41,290
the synergy server is but if I find<font color="#E5E5E5"> one</font>

496
00:20:39,040 --> 00:20:43,930
I'm<font color="#CCCCCC"> just</font><font color="#E5E5E5"> gonna connect to that and it</font>

497
00:20:41,290 --> 00:20:47,889
does that by<font color="#CCCCCC"> using</font><font color="#E5E5E5"> Bonjour so what I did</font>

498
00:20:43,930 --> 00:20:50,530
<font color="#CCCCCC">is I made this rogue</font><font color="#E5E5E5"> synergy client</font><font color="#CCCCCC"> that</font>

499
00:20:47,890 --> 00:20:53,050
<font color="#E5E5E5">basically pretended to act like it was a</font>

500
00:20:50,530 --> 00:20:55,570
regular synergy server<font color="#E5E5E5"> it would accept</font>

501
00:20:53,050 --> 00:20:57,909
connections<font color="#E5E5E5"> from clients and once</font>

502
00:20:55,570 --> 00:21:01,300
clients connected<font color="#E5E5E5"> it would start sending</font>

503
00:20:57,910 --> 00:21:03,430
keystrokes to<font color="#E5E5E5"> them so to set the stage</font>

504
00:21:01,300 --> 00:21:05,200
I have Kali Linux and PowerShell<font color="#CCCCCC"> Empire</font>

505
00:21:03,430 --> 00:21:08,860
on<font color="#E5E5E5"> the right which</font><font color="#CCCCCC"> is going</font><font color="#E5E5E5"> to be the</font>

506
00:21:05,200 --> 00:21:10,990
<font color="#E5E5E5">CNC</font><font color="#CCCCCC"> in the middle and I know it says</font>

507
00:21:08,860 --> 00:21:12,370
Rouge<font color="#CCCCCC"> sorry I can't spell</font><font color="#E5E5E5"> but that's the</font>

508
00:21:10,990 --> 00:21:13,600
rogue synergy server<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> be</font>

509
00:21:12,370 --> 00:21:15,639
running<font color="#CCCCCC"> this tool</font><font color="#E5E5E5"> I made called</font>

510
00:21:13,600 --> 00:21:17,860
dissonance which is the fake synergy

511
00:21:15,640 --> 00:21:20,170
server<font color="#E5E5E5"> and on the left side we have</font><font color="#CCCCCC"> the</font>

512
00:21:17,860 --> 00:21:23,139
synergy client so what I'll do is<font color="#CCCCCC"> I'll</font>

513
00:21:20,170 --> 00:21:24,760
go click Auto config it'll find the bad

514
00:21:23,140 --> 00:21:30,960
server<font color="#E5E5E5"> in order to start accepting</font>

515
00:21:24,760 --> 00:21:34,240
<font color="#E5E5E5">commands so I start up the bad server</font>

516
00:21:30,960 --> 00:21:36,700
it's going<font color="#CCCCCC"> I go over to the left</font><font color="#E5E5E5"> click</font>

517
00:21:34,240 --> 00:21:38,590
the<font color="#CCCCCC"> auto config and you</font><font color="#E5E5E5"> just fought</font>

518
00:21:36,700 --> 00:21:41,710
since<font color="#E5E5E5"> it's on</font><font color="#CCCCCC"> the same land it finds the</font>

519
00:21:38,590 --> 00:21:43,929
bad server starts taking commands<font color="#E5E5E5"> open</font>

520
00:21:41,710 --> 00:21:46,930
ups command prompt<font color="#E5E5E5"> start</font><font color="#CCCCCC"> sending this is</font>

521
00:21:43,930 --> 00:21:49,930
actually a PowerShell<font color="#CCCCCC"> Empire one-liner</font>

522
00:21:46,930 --> 00:21:52,450
<font color="#CCCCCC">for a reverse shell</font><font color="#E5E5E5"> and then what we can</font>

523
00:21:49,930 --> 00:21:54,970
see is the the kind<font color="#CCCCCC"> of green there on</font>

524
00:21:52,450 --> 00:21:57,310
the right that's a check in on

525
00:21:54,970 --> 00:22:02,560
PowerShell<font color="#E5E5E5"> Empire</font><font color="#CCCCCC"> and we now have remote</font>

526
00:21:57,310 --> 00:22:05,139
<font color="#CCCCCC">access to that system so most of the</font>

527
00:22:02,560 --> 00:22:08,110
time that<font color="#E5E5E5"> you run into synergy if you do</font>

528
00:22:05,140 --> 00:22:09,910
run<font color="#CCCCCC"> into</font><font color="#E5E5E5"> it is a client and a server</font><font color="#CCCCCC"> are</font>

529
00:22:08,110 --> 00:22:12,189
<font color="#E5E5E5">already going to have an</font><font color="#CCCCCC"> established</font>

530
00:22:09,910 --> 00:22:14,950
connection<font color="#E5E5E5"> so it's</font><font color="#CCCCCC"> unlikely that</font><font color="#E5E5E5"> you'll</font>

531
00:22:12,190 --> 00:22:16,570
be<font color="#CCCCCC"> running your evil server when they go</font>

532
00:22:14,950 --> 00:22:19,029
<font color="#CCCCCC">to click Auto config</font>

533
00:22:16,570 --> 00:22:21,399
and most<font color="#E5E5E5"> likely</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> just set up the IP of</font>

534
00:22:19,029 --> 00:22:23,349
the server manually<font color="#E5E5E5"> so what you can do</font>

535
00:22:21,399 --> 00:22:26,168
is that there's already an<font color="#CCCCCC"> established</font>

536
00:22:23,349 --> 00:22:28,899
connection<font color="#E5E5E5"> you can find out where those</font>

537
00:22:26,169 --> 00:22:31,239
<font color="#E5E5E5">client</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> server are you can find out</font>

538
00:22:28,899 --> 00:22:33,968
their IP address you can<font color="#E5E5E5"> spoof the</font>

539
00:22:31,239 --> 00:22:36,099
<font color="#E5E5E5">server and then ARP spoof the client</font>

540
00:22:33,969 --> 00:22:38,469
into thinking you are<font color="#E5E5E5"> that same server</font>

541
00:22:36,099 --> 00:22:41,198
and it doesn't actually<font color="#E5E5E5"> validate your</font>

542
00:22:38,469 --> 00:22:42,699
identity<font color="#CCCCCC"> at all so we'll</font><font color="#E5E5E5"> just think that</font>

543
00:22:41,199 --> 00:22:45,429
you're that<font color="#CCCCCC"> same server and starts</font>

544
00:22:42,699 --> 00:22:47,049
<font color="#E5E5E5">taking commands so what we're going to</font>

545
00:22:45,429 --> 00:22:49,149
do here<font color="#E5E5E5"> is we have</font><font color="#CCCCCC"> a client on the Left</font>

546
00:22:47,049 --> 00:22:51,369
<font color="#E5E5E5">that's already set up</font><font color="#CCCCCC"> with the real</font>

547
00:22:49,149 --> 00:22:54,428
client or the<font color="#CCCCCC"> real server in the middle</font>

548
00:22:51,369 --> 00:22:56,529
and on<font color="#CCCCCC"> the left on the right</font><font color="#E5E5E5"> side we</font>

549
00:22:54,429 --> 00:22:58,599
have<font color="#E5E5E5"> the fake synergy server the</font>

550
00:22:56,529 --> 00:23:01,839
command-and-control server<font color="#E5E5E5"> and we're</font>

551
00:22:58,599 --> 00:23:04,658
going<font color="#E5E5E5"> to perform an ARP spoof so first</font>

552
00:23:01,839 --> 00:23:06,969
thing is we run<font color="#E5E5E5"> dissonance which is the</font>

553
00:23:04,659 --> 00:23:10,599
name of<font color="#E5E5E5"> the tool and we look at Bonjour</font>

554
00:23:06,969 --> 00:23:13,299
traffic to find the IP of the<font color="#CCCCCC"> client</font><font color="#E5E5E5"> and</font>

555
00:23:10,599 --> 00:23:14,619
the server<font color="#CCCCCC"> so after we run</font><font color="#E5E5E5"> that in the</font>

556
00:23:13,299 --> 00:23:18,549
output<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can't really see it but</font>

557
00:23:14,619 --> 00:23:20,559
here's the IP addresses<font color="#CCCCCC"> so</font><font color="#E5E5E5"> we just</font>

558
00:23:18,549 --> 00:23:23,889
grabbed those so we know what we're

559
00:23:20,559 --> 00:23:27,069
spoofing I'm just using if config to

560
00:23:23,889 --> 00:23:30,218
assume the IP of<font color="#CCCCCC"> the synergy</font><font color="#E5E5E5"> server and</font>

561
00:23:27,069 --> 00:23:33,639
then I'm using<font color="#E5E5E5"> ARP spoof to ARP spoof</font>

562
00:23:30,219 --> 00:23:36,909
<font color="#CCCCCC">the client that I identified so it now</font>

563
00:23:33,639 --> 00:23:39,579
thinks that I'm that same server then I

564
00:23:36,909 --> 00:23:42,279
start up my rogue server the<font color="#CCCCCC"> client</font>

565
00:23:39,579 --> 00:23:45,428
which had lost its<font color="#CCCCCC"> connection now goes</font>

566
00:23:42,279 --> 00:23:48,099
and reestablishes with what it thinks is

567
00:23:45,429 --> 00:23:50,259
<font color="#E5E5E5">the original server and then again I can</font>

568
00:23:48,099 --> 00:23:52,389
open the command prompt start start

569
00:23:50,259 --> 00:23:54,639
typing in<font color="#E5E5E5"> keystrokes</font><font color="#CCCCCC"> and then get that</font>

570
00:23:52,389 --> 00:23:58,059
<font color="#E5E5E5">PowerShell Empire stage</font><font color="#CCCCCC"> are executed</font><font color="#E5E5E5"> on</font>

571
00:23:54,639 --> 00:24:00,758
the<font color="#CCCCCC"> victim system so as far as</font>

572
00:23:58,059 --> 00:24:03,428
mitigating<font color="#CCCCCC"> this</font><font color="#E5E5E5"> you can always if you</font>

573
00:24:00,759 --> 00:24:05,529
have<font color="#CCCCCC"> synergy the first version you can</font>

574
00:24:03,429 --> 00:24:07,690
upgrade it<font color="#E5E5E5"> to</font><font color="#CCCCCC"> pro and then you have SSL</font>

575
00:24:05,529 --> 00:24:10,749
encryption<font color="#E5E5E5"> or you can get synergy to</font>

576
00:24:07,690 --> 00:24:12,789
which all forms<font color="#E5E5E5"> of it are encrypted</font>

577
00:24:10,749 --> 00:24:14,169
<font color="#CCCCCC">I tried</font><font color="#E5E5E5"> this attack with the encrypted</font>

578
00:24:12,789 --> 00:24:17,499
<font color="#CCCCCC">version just</font><font color="#E5E5E5"> to see what would happen</font>

579
00:24:14,169 --> 00:24:19,239
<font color="#E5E5E5">and actually it notices that the server</font>

580
00:24:17,499 --> 00:24:22,479
<font color="#E5E5E5">was swapped out and it will ask you to</font>

581
00:24:19,239 --> 00:24:24,459
revalidate<font color="#CCCCCC"> the fingerprint of the server</font>

582
00:24:22,479 --> 00:24:25,989
<font color="#E5E5E5">so if you got this pop if you were using</font>

583
00:24:24,459 --> 00:24:28,359
synergy<font color="#E5E5E5"> and you just got this pop up</font>

584
00:24:25,989 --> 00:24:30,310
randomly<font color="#E5E5E5"> that would be a bad sign</font><font color="#CCCCCC"> just</font>

585
00:24:28,359 --> 00:24:32,679
<font color="#CCCCCC">like if you were SSA</font><font color="#E5E5E5"> Qing into a server</font>

586
00:24:30,310 --> 00:24:35,379
you always<font color="#CCCCCC"> SSH into and it</font><font color="#E5E5E5"> tells you the</font>

587
00:24:32,680 --> 00:24:37,540
key changed<font color="#E5E5E5"> like that's not good so you</font>

588
00:24:35,380 --> 00:24:39,340
know<font color="#E5E5E5"> that warning there is what you need</font>

589
00:24:37,540 --> 00:24:41,409
to know<font color="#CCCCCC"> that you're being intercepted of</font>

590
00:24:39,340 --> 00:24:42,939
course<font color="#E5E5E5"> a user could always just click</font>

591
00:24:41,410 --> 00:24:43,870
<font color="#E5E5E5">through this and like</font><font color="#CCCCCC"> okay I don't</font><font color="#E5E5E5"> know</font>

592
00:24:42,940 --> 00:24:46,660
what that<font color="#E5E5E5"> means I'm going to click yes</font>

593
00:24:43,870 --> 00:24:49,389
<font color="#CCCCCC">which happens a lot but</font><font color="#E5E5E5"> you do have</font><font color="#CCCCCC"> some</font>

594
00:24:46,660 --> 00:24:50,400
indication that<font color="#E5E5E5"> this kind of bad stuff</font>

595
00:24:49,390 --> 00:24:53,350
is<font color="#E5E5E5"> happening</font>

596
00:24:50,400 --> 00:24:55,330
so in general<font color="#E5E5E5"> when it comes to using</font>

597
00:24:53,350 --> 00:24:57,159
software you you want to<font color="#CCCCCC"> make sure that</font>

598
00:24:55,330 --> 00:25:00,189
the software<font color="#CCCCCC"> you use</font><font color="#E5E5E5"> has encrypted</font>

599
00:24:57,160 --> 00:25:02,290
communications<font color="#E5E5E5"> not just because if it's</font>

600
00:25:00,190 --> 00:25:03,640
unencrypted you know they can sniff out

601
00:25:02,290 --> 00:25:06,370
<font color="#CCCCCC">anything you're doing</font><font color="#E5E5E5"> and then</font>

602
00:25:03,640 --> 00:25:08,020
<font color="#CCCCCC">potentially</font><font color="#E5E5E5"> you know sniff out something</font>

603
00:25:06,370 --> 00:25:10,659
<font color="#E5E5E5">like</font><font color="#CCCCCC"> this and be able to</font><font color="#E5E5E5"> perform an</font>

604
00:25:08,020 --> 00:25:13,389
<font color="#CCCCCC">attack against your system all these</font>

605
00:25:10,660 --> 00:25:14,830
tools I made I made<font color="#CCCCCC"> in</font><font color="#E5E5E5"> Python</font><font color="#CCCCCC"> I have</font>

606
00:25:13,390 --> 00:25:17,140
them on<font color="#E5E5E5"> my github if you want to play</font>

607
00:25:14,830 --> 00:25:19,659
with them<font color="#E5E5E5"> and then a more detailed</font>

608
00:25:17,140 --> 00:25:21,550
write-up is also on my<font color="#CCCCCC"> blog if you're</font>

609
00:25:19,660 --> 00:25:23,110
curious<font color="#E5E5E5"> like okay well how exactly did</font>

610
00:25:21,550 --> 00:25:26,379
<font color="#E5E5E5">you do that you know all the source</font>

611
00:25:23,110 --> 00:25:30,100
codes<font color="#CCCCCC"> they're detailed</font><font color="#E5E5E5"> of the detail of</font>

612
00:25:26,380 --> 00:25:31,840
<font color="#CCCCCC">the</font><font color="#E5E5E5"> attack path is on my blog</font><font color="#CCCCCC"> bottom</font>

613
00:25:30,100 --> 00:25:33,939
right that's the link to my blog I

614
00:25:31,840 --> 00:25:37,360
<font color="#E5E5E5">talked about</font><font color="#CCCCCC"> a lot of a lot of other</font>

615
00:25:33,940 --> 00:25:40,720
stuff<font color="#E5E5E5"> too I'm really into</font><font color="#CCCCCC"> mac OS stuff</font>

616
00:25:37,360 --> 00:25:42,669
and I have some<font color="#E5E5E5"> more mac OS exploitation</font>

617
00:25:40,720 --> 00:25:45,340
blogs on there and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> just kind</font><font color="#E5E5E5"> of</font>

618
00:25:42,670 --> 00:25:47,290
general pen testing stuff<font color="#CCCCCC"> if you've ever</font>

619
00:25:45,340 --> 00:25:48,939
wanted<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> research yourself</font><font color="#CCCCCC"> I would</font>

620
00:25:47,290 --> 00:25:52,600
say you know jump right into<font color="#E5E5E5"> it</font><font color="#CCCCCC"> because</font>

621
00:25:48,940 --> 00:25:54,600
for<font color="#E5E5E5"> the most</font><font color="#CCCCCC"> part I did this just in my</font>

622
00:25:52,600 --> 00:25:57,580
free time<font color="#E5E5E5"> and I didn't really know</font><font color="#CCCCCC"> a lot</font>

623
00:25:54,600 --> 00:25:59,639
<font color="#E5E5E5">when I started it so it's actually you</font>

624
00:25:57,580 --> 00:26:02,590
know<font color="#CCCCCC"> not too bad to get into and I just</font>

625
00:25:59,640 --> 00:26:03,820
would<font color="#E5E5E5"> say if you're just go out there</font>

626
00:26:02,590 --> 00:26:05,320
<font color="#E5E5E5">and give it a shot</font>

627
00:26:03,820 --> 00:26:07,179
because you'll<font color="#CCCCCC"> be surprised</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> you</font>

628
00:26:05,320 --> 00:26:10,570
find<font color="#CCCCCC"> you know a lot of</font><font color="#E5E5E5"> stuff is</font>

629
00:26:07,180 --> 00:26:12,250
developed in not a secure way<font color="#E5E5E5"> and you</font>

630
00:26:10,570 --> 00:26:15,540
can take advantage<font color="#CCCCCC"> of</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> you know for</font>

631
00:26:12,250 --> 00:26:18,970
fun or you know bad things<font color="#E5E5E5"> if you want</font>

632
00:26:15,540 --> 00:26:21,180
but that's about it<font color="#CCCCCC"> does anybody have</font>

633
00:26:18,970 --> 00:26:21,180
<font color="#E5E5E5">any questions</font>

634
00:26:36,510 --> 00:26:40,010
right

635
00:26:37,970 --> 00:26:43,910
in my<font color="#CCCCCC"> screenshot I</font><font color="#E5E5E5"> just put the mouse</font>

636
00:26:40,010 --> 00:26:45,800
moving in there<font color="#CCCCCC"> because it's really</font>

637
00:26:43,910 --> 00:26:47,450
noisy<font color="#CCCCCC"> so if you were to put all the</font>

638
00:26:45,800 --> 00:26:50,300
screen<font color="#CCCCCC"> updates there's a whole lot of</font>

639
00:26:47,450 --> 00:26:52,580
<font color="#E5E5E5">data</font><font color="#CCCCCC"> they get sent so just to have</font>

640
00:26:50,300 --> 00:26:55,240
<font color="#E5E5E5">something visual there for you like the</font>

641
00:26:52,580 --> 00:26:57,710
keystrokes which you could easily see

642
00:26:55,240 --> 00:26:59,630
<font color="#E5E5E5">but if you were performing a</font>

643
00:26:57,710 --> 00:27:01,730
man-in-the-middle attack<font color="#E5E5E5"> you would see</font>

644
00:26:59,630 --> 00:27:10,970
all the screen updates<font color="#E5E5E5"> all the mouse</font>

645
00:27:01,730 --> 00:27:13,370
movements and all the keystrokes<font color="#E5E5E5"> so so</font>

646
00:27:10,970 --> 00:27:16,850
yeah<font color="#E5E5E5"> I filtered it and when you look at</font>

647
00:27:13,370 --> 00:27:18,320
that stream I didn't really do anything

648
00:27:16,850 --> 00:27:24,620
other than<font color="#E5E5E5"> sing keystrokes</font>

649
00:27:18,320 --> 00:27:26,990
<font color="#E5E5E5">but in that example when I did the</font>

650
00:27:24,620 --> 00:27:29,510
stream<font color="#CCCCCC"> I just I didn't do anything else</font>

651
00:27:26,990 --> 00:27:32,060
other<font color="#E5E5E5"> than the same keystrokes</font><font color="#CCCCCC"> just just</font>

652
00:27:29,510 --> 00:27:38,750
to make the<font color="#E5E5E5"> screenshot easy yeah that's</font>

653
00:27:32,060 --> 00:27:40,879
right cool well if anybody wants to<font color="#CCCCCC"> ask</font>

654
00:27:38,750 --> 00:27:43,950
<font color="#E5E5E5">me questions after I'll be up here</font><font color="#CCCCCC"> for a</font>

655
00:27:40,880 --> 00:27:47,819
few<font color="#CCCCCC"> minutes</font><font color="#E5E5E5"> and thank you for your time</font>

656
00:27:43,950 --> 00:27:47,819
[Applause]

