1
00:00:04,580 --> 00:00:09,870
so alright so let's continue there's a

2
00:00:07,700 --> 00:00:12,629
Marvel researcher in this room and

3
00:00:09,870 --> 00:00:15,329
basically back swept and our work about

4
00:00:12,630 --> 00:00:17,880
it is about her mama research but we

5
00:00:15,330 --> 00:00:20,300
will try to shed some more light on

6
00:00:17,880 --> 00:00:22,948
cyber criminal scheme of how the

7
00:00:20,300 --> 00:00:28,289
criminals behind this project operated

8
00:00:22,949 --> 00:00:31,320
and wanted to steal money let's jump

9
00:00:28,289 --> 00:00:34,559
straight to the outline of our talk the

10
00:00:31,320 --> 00:00:36,870
three main parts the first we will try

11
00:00:34,559 --> 00:00:40,349
to explain the evolution of this

12
00:00:36,870 --> 00:00:43,290
malicious project and it's highlights in

13
00:00:40,350 --> 00:00:46,530
in the in the in the time the the cyber

14
00:00:43,290 --> 00:00:48,930
criminals took to develop it and we will

15
00:00:46,530 --> 00:00:51,719
explain also why it's kind of innovative

16
00:00:48,930 --> 00:00:55,260
and maybe we will see more of this kind

17
00:00:51,719 --> 00:00:57,920
of Mahler's in the future in the second

18
00:00:55,260 --> 00:01:00,660
part we will explain the most

19
00:00:57,920 --> 00:01:04,140
interesting technical aspects of this

20
00:01:00,660 --> 00:01:05,840
threat sometimes mal researchers are

21
00:01:04,140 --> 00:01:08,850
lucky that the malware authors

22
00:01:05,840 --> 00:01:11,580
incorporates interesting stuff in their

23
00:01:08,850 --> 00:01:15,750
piece of code and this is exactly the

24
00:01:11,580 --> 00:01:18,119
case and in the third the most important

25
00:01:15,750 --> 00:01:20,970
part we will explain the cyber crime

26
00:01:18,119 --> 00:01:28,500
scheme the modus operandi of how cyber

27
00:01:20,970 --> 00:01:30,539
criminals wanted to wash their heists so

28
00:01:28,500 --> 00:01:32,579
let's move to the first part the more

29
00:01:30,540 --> 00:01:35,250
developers behind this threat

30
00:01:32,579 --> 00:01:38,309
continuously improved in their leverage

31
00:01:35,250 --> 00:01:40,409
of windows clipboard windows keyboard is

32
00:01:38,310 --> 00:01:46,710
the essential part of Windows operating

33
00:01:40,409 --> 00:01:52,200
system that helped apply and in and like

34
00:01:46,710 --> 00:01:56,089
right web injects for these authors this

35
00:01:52,200 --> 00:02:00,240
is the timeline starting from late 2017

36
00:01:56,090 --> 00:02:03,240
we won't go too much detail into into

37
00:02:00,240 --> 00:02:06,298
all those events only three messages

38
00:02:03,240 --> 00:02:09,030
from this slide these guys like

39
00:02:06,299 --> 00:02:13,260
continuously improve their code they

40
00:02:09,030 --> 00:02:17,069
continuously start new model campaigns

41
00:02:13,260 --> 00:02:20,069
they like started to experiment with new

42
00:02:17,069 --> 00:02:24,450
concepts there's a three part three key

43
00:02:20,069 --> 00:02:26,730
points that is related to this slide to

44
00:02:24,450 --> 00:02:31,260
say more in detail about these

45
00:02:26,730 --> 00:02:33,000
highlights all started as a conventional

46
00:02:31,260 --> 00:02:35,609
banking Trojan conventional

47
00:02:33,000 --> 00:02:40,049
man-in-the-browser attack called timba

48
00:02:35,610 --> 00:02:43,829
it's something similar to I don't know

49
00:02:40,049 --> 00:02:47,190
car burp I guess like in Russia they

50
00:02:43,829 --> 00:02:50,099
were highlights about how Russian law

51
00:02:47,190 --> 00:02:53,549
enforcement like caught these guys in

52
00:02:50,099 --> 00:02:55,170
2013 so teen bar was something similar

53
00:02:53,549 --> 00:02:57,870
conventional banking Trojan

54
00:02:55,170 --> 00:03:02,000
incorporating two methods web injects

55
00:02:57,870 --> 00:03:05,909
and form grabbing like using hijacked

56
00:03:02,000 --> 00:03:09,569
hijacked or hooked attack points in

57
00:03:05,909 --> 00:03:12,060
browsers and like not nothing new in

58
00:03:09,569 --> 00:03:15,500
this this area and they took their

59
00:03:12,060 --> 00:03:18,870
source code and they thought how to

60
00:03:15,500 --> 00:03:22,109
improve it and they did it continuously

61
00:03:18,870 --> 00:03:25,530
they started a project using that code

62
00:03:22,109 --> 00:03:28,919
but the functionality was not a banking

63
00:03:25,530 --> 00:03:32,910
Trojan it was a generic clipboard

64
00:03:28,919 --> 00:03:38,340
replacer so the code was just searching

65
00:03:32,910 --> 00:03:40,530
for a pattern of crypto wallet or or

66
00:03:38,340 --> 00:03:43,109
bank account in the in the clipboard and

67
00:03:40,530 --> 00:03:46,859
when it found that pattern it replaced

68
00:03:43,109 --> 00:03:48,930
it so very generic approach but they

69
00:03:46,859 --> 00:03:51,810
wanted more they wanted some more

70
00:03:48,930 --> 00:03:53,519
specific way and they wanted to

71
00:03:51,810 --> 00:03:56,190
incorporate the bin jects and perhaps

72
00:03:53,519 --> 00:03:59,060
form gramming as well and in this

73
00:03:56,190 --> 00:04:02,790
initial project they didn't didn't

74
00:03:59,060 --> 00:04:05,430
involve bank accounts of a real banks

75
00:04:02,790 --> 00:04:07,230
because if you if you won't like to use

76
00:04:05,430 --> 00:04:09,690
these kind of attacks you are not able

77
00:04:07,230 --> 00:04:12,929
to use your own bank accounts you always

78
00:04:09,690 --> 00:04:16,199
knew you always need money Miller's so

79
00:04:12,930 --> 00:04:19,199
it's a kind of harder to incur harder to

80
00:04:16,199 --> 00:04:20,250
test like real bank accounts so crypto

81
00:04:19,199 --> 00:04:24,840
wallet is a good start

82
00:04:20,250 --> 00:04:26,590
you have full anonymity with it so that

83
00:04:24,840 --> 00:04:28,989
was the initial project and

84
00:04:26,590 --> 00:04:32,289
the first back swept also was tested

85
00:04:28,990 --> 00:04:34,060
with these script Awards and also with

86
00:04:32,290 --> 00:04:35,740
cryptocurrency payment systems and

87
00:04:34,060 --> 00:04:36,130
exchanges like advanced cash and what

88
00:04:35,740 --> 00:04:38,710
money

89
00:04:36,130 --> 00:04:43,810
I believe these these platforms are

90
00:04:38,710 --> 00:04:48,940
known here in Russian region and finally

91
00:04:43,810 --> 00:04:51,610
I guess it was like early 2018 when the

92
00:04:48,940 --> 00:04:55,780
real back sweat was distributed in the

93
00:04:51,610 --> 00:04:58,540
world supporting full web injects not

94
00:04:55,780 --> 00:05:01,599
for grabbing at the time but for

95
00:04:58,540 --> 00:05:07,090
grabbing kinda later and the initial

96
00:05:01,600 --> 00:05:11,680
campaigns were in Poland and Michelle

97
00:05:07,090 --> 00:05:14,469
wrote a pretty detailed technical blog

98
00:05:11,680 --> 00:05:16,600
post in village security explaining why

99
00:05:14,470 --> 00:05:19,120
this mother is innovative we will see it

100
00:05:16,600 --> 00:05:21,640
in the in the second part what are the

101
00:05:19,120 --> 00:05:24,490
mechanism how this banking Trojan

102
00:05:21,640 --> 00:05:28,599
operate and why it is different from

103
00:05:24,490 --> 00:05:32,680
classical approaches and we tweeted

104
00:05:28,600 --> 00:05:34,810
about it I guess these this paper had a

105
00:05:32,680 --> 00:05:38,110
good impact because fellow security

106
00:05:34,810 --> 00:05:40,390
researchers started to adapt these these

107
00:05:38,110 --> 00:05:43,090
news and started to track the threat as

108
00:05:40,390 --> 00:05:45,789
well by the way back sweat is a name

109
00:05:43,090 --> 00:05:49,510
invented created by one of our detection

110
00:05:45,790 --> 00:05:51,940
engineers in ESET so it's definitely not

111
00:05:49,510 --> 00:05:54,570
the name of the project of the authors

112
00:05:51,940 --> 00:05:56,979
we don't know who the authors are and

113
00:05:54,570 --> 00:05:59,530
but we saw from time to time

114
00:05:56,979 --> 00:06:03,340
advertisements trying to sell Beck's web

115
00:05:59,530 --> 00:06:06,099
source codes on underground forums using

116
00:06:03,340 --> 00:06:07,810
the backside name and that that was

117
00:06:06,100 --> 00:06:10,270
really like suspicious for us because

118
00:06:07,810 --> 00:06:12,370
more routers when they try to sell

119
00:06:10,270 --> 00:06:15,010
circles of their malicious projects they

120
00:06:12,370 --> 00:06:16,840
would never ever use like the name from

121
00:06:15,010 --> 00:06:19,210
the antivirus company they would always

122
00:06:16,840 --> 00:06:21,460
invent their own like code name or

123
00:06:19,210 --> 00:06:27,250
project name so usually these kind of

124
00:06:21,460 --> 00:06:29,200
advertisements are scan and fellow

125
00:06:27,250 --> 00:06:31,479
security researcher from Israel of here

126
00:06:29,200 --> 00:06:34,090
she liked the name actually there's a

127
00:06:31,479 --> 00:06:37,000
pun it is very close to banks lab and me

128
00:06:34,090 --> 00:06:39,700
personally sometimes I exchanged the

129
00:06:37,000 --> 00:06:40,390
word backs web like swapping bank

130
00:06:39,700 --> 00:06:42,880
account in the

131
00:06:40,390 --> 00:06:44,800
ground bank account immigrant with bank

132
00:06:42,880 --> 00:06:47,680
said like bank accounts swapping so

133
00:06:44,800 --> 00:06:49,600
sometimes I use bank swap instead of

134
00:06:47,680 --> 00:06:55,660
backs well as well I like I like this

135
00:06:49,600 --> 00:06:58,240
this kind of collision and actually she

136
00:06:55,660 --> 00:07:00,760
also tweeted about the mechanism about

137
00:06:58,240 --> 00:07:04,120
one of those two mechanisms the the

138
00:07:00,760 --> 00:07:06,820
marver uses like the web injection or

139
00:07:04,120 --> 00:07:09,010
the the malicious JavaScript injections

140
00:07:06,820 --> 00:07:12,580
into the address bar of a browser and

141
00:07:09,010 --> 00:07:14,110
actually this emerges JavaScript stays

142
00:07:12,580 --> 00:07:16,150
in the history of the browser so if you

143
00:07:14,110 --> 00:07:18,550
do incidence response analysis of an

144
00:07:16,150 --> 00:07:20,530
infected computer you could check that

145
00:07:18,550 --> 00:07:26,950
browser history and you would find found

146
00:07:20,530 --> 00:07:30,609
those traces and actually we were really

147
00:07:26,950 --> 00:07:34,120
surprised in late 2018 when these these

148
00:07:30,610 --> 00:07:37,690
guys behind backs web started to target

149
00:07:34,120 --> 00:07:39,730
remote banking interfaces of check banks

150
00:07:37,690 --> 00:07:41,290
this was really we are from Czech

151
00:07:39,730 --> 00:07:43,240
Republic so this we were really like

152
00:07:41,290 --> 00:07:46,090
interested in this what's going on and

153
00:07:43,240 --> 00:07:49,650
also we were involved in cooperation

154
00:07:46,090 --> 00:07:54,909
with law enforcement in Czech Republic

155
00:07:49,650 --> 00:07:56,500
and what is interesting about backstab

156
00:07:54,910 --> 00:07:58,900
it's not only the new innovative

157
00:07:56,500 --> 00:08:01,390
technique how to like high-tech browser

158
00:07:58,900 --> 00:08:05,950
activity of the victim but it also has

159
00:08:01,390 --> 00:08:08,380
to like forms two formats it it is

160
00:08:05,950 --> 00:08:11,229
always a shell code that is embedded in

161
00:08:08,380 --> 00:08:15,010
a legitimate application and this shell

162
00:08:11,230 --> 00:08:17,920
code is has a structure it's like 32 bit

163
00:08:15,010 --> 00:08:20,650
assembly but at the same time it's a bit

164
00:08:17,920 --> 00:08:25,270
net and they always use some interesting

165
00:08:20,650 --> 00:08:27,370
bit nut and if the little boss was of a

166
00:08:25,270 --> 00:08:29,740
lower quality so we had troubles to

167
00:08:27,370 --> 00:08:33,600
identify the original bit map they they

168
00:08:29,740 --> 00:08:36,340
they picked but sometimes it worked and

169
00:08:33,600 --> 00:08:39,370
also like guys from the security

170
00:08:36,340 --> 00:08:41,910
community also reported about their

171
00:08:39,370 --> 00:08:45,250
identification this was by checkpoint

172
00:08:41,909 --> 00:08:49,060
this is a public figure in Russia am i

173
00:08:45,250 --> 00:08:52,260
right or do do anybody know this guy but

174
00:08:49,060 --> 00:08:52,260
we say say his name

175
00:08:52,450 --> 00:09:00,620
he's an owner of Gazprom okay thank you

176
00:08:58,339 --> 00:09:03,800
so it's a Russian public public figure

177
00:09:00,620 --> 00:09:06,350
owner of of Gazprom we couldn't identify

178
00:09:03,800 --> 00:09:10,760
them but the this check one guys didn't

179
00:09:06,350 --> 00:09:13,130
you you could also and so let's say

180
00:09:10,760 --> 00:09:15,980
there's some connection with Russia or

181
00:09:13,130 --> 00:09:17,959
russian-speaking artifact no no it's a

182
00:09:15,980 --> 00:09:19,880
Russian artifact artifact related to

183
00:09:17,959 --> 00:09:24,859
Russian culture and public life would

184
00:09:19,880 --> 00:09:28,700
say there will be more oh this is I

185
00:09:24,860 --> 00:09:30,980
guess a character from Terminator so

186
00:09:28,700 --> 00:09:34,550
this is not not from real life

187
00:09:30,980 --> 00:09:37,579
we found contain not targeting polish

188
00:09:34,550 --> 00:09:41,000
banks but Spanish ones it was like I

189
00:09:37,579 --> 00:09:43,640
guess April 20 2018 no it was this year

190
00:09:41,000 --> 00:09:46,250
no it was this year 2018 yeah because

191
00:09:43,640 --> 00:09:48,620
there was a big gap yeah backside was

192
00:09:46,250 --> 00:09:50,360
active it was active last year there was

193
00:09:48,620 --> 00:09:53,660
a big gap like several months and they

194
00:09:50,360 --> 00:09:59,120
started to redistribute in April this

195
00:09:53,660 --> 00:10:02,060
year and very recently in May 2019 we

196
00:09:59,120 --> 00:10:07,010
found a campaign in Spain with a mask we

197
00:10:02,060 --> 00:10:09,410
will see more about this in while so

198
00:10:07,010 --> 00:10:12,260
that was about some kind of evolution of

199
00:10:09,410 --> 00:10:14,209
the threat let's talk about the novel

200
00:10:12,260 --> 00:10:17,600
analysis about the features of the model

201
00:10:14,209 --> 00:10:20,750
the authors are definitely capable of

202
00:10:17,600 --> 00:10:23,570
32-bit assembly JavaScript and Windows

203
00:10:20,750 --> 00:10:27,829
internals on a really high level of

204
00:10:23,570 --> 00:10:31,060
proficiency we will see because they

205
00:10:27,829 --> 00:10:35,359
didn't distribute their Mahler like as a

206
00:10:31,060 --> 00:10:40,040
complete binary they just like wrote

207
00:10:35,360 --> 00:10:41,959
shell codes and they they embedded this

208
00:10:40,040 --> 00:10:44,719
shell code in a legitimate application

209
00:10:41,959 --> 00:10:47,869
and because we tracked backs web

210
00:10:44,720 --> 00:10:50,300
contains a lot we collected several like

211
00:10:47,870 --> 00:10:53,449
many many samples like containing

212
00:10:50,300 --> 00:10:55,569
backstrap shell code and then we took a

213
00:10:53,449 --> 00:10:57,890
look at icons from these legitimate

214
00:10:55,570 --> 00:11:02,120
applications and this is what what we

215
00:10:57,890 --> 00:11:04,699
got they used like a li debugger or

216
00:11:02,120 --> 00:11:05,510
WinRAR as the application and carries

217
00:11:04,699 --> 00:11:08,269
the

218
00:11:05,510 --> 00:11:10,490
backflip shackled and they always

219
00:11:08,269 --> 00:11:14,389
applied some tricky Trojan ization they

220
00:11:10,490 --> 00:11:17,779
picked a call from CSer from C runtime

221
00:11:14,389 --> 00:11:21,350
or they modified Adele fih-dell fickle

222
00:11:17,779 --> 00:11:26,300
so the the shellcode itself was pretty

223
00:11:21,350 --> 00:11:29,389
hidden and it took it was not for a

224
00:11:26,300 --> 00:11:36,949
beginner for beginner analyst to to find

225
00:11:29,389 --> 00:11:39,829
founders piece of malicious code and now

226
00:11:36,949 --> 00:11:40,430
we explain explain the mechanism how

227
00:11:39,829 --> 00:11:43,519
baxford

228
00:11:40,430 --> 00:11:45,500
operates as I said already the

229
00:11:43,519 --> 00:11:48,399
conventional man-in-the-browser tags

230
00:11:45,500 --> 00:11:52,850
just try to hook very specific functions

231
00:11:48,399 --> 00:11:57,170
that would contain an argument which

232
00:11:52,850 --> 00:12:00,199
would contain like the the raw HTTP data

233
00:11:57,170 --> 00:12:02,510
before SSL encryption in this case they

234
00:12:00,199 --> 00:12:04,939
completely switched completely switched

235
00:12:02,510 --> 00:12:08,449
from this approach to leveraging graphic

236
00:12:04,940 --> 00:12:11,000
user interface system so they they hook

237
00:12:08,449 --> 00:12:14,269
relevant graphic user interface events

238
00:12:11,000 --> 00:12:19,510
instead and they went waits for correct

239
00:12:14,269 --> 00:12:22,670
Bank URL to trigger the main action and

240
00:12:19,510 --> 00:12:25,069
when the action is triggered they

241
00:12:22,670 --> 00:12:27,709
identified the browser window this could

242
00:12:25,069 --> 00:12:29,689
be done easily they insert the malicious

243
00:12:27,709 --> 00:12:32,388
JavaScript into the clipboard

244
00:12:29,690 --> 00:12:34,279
they make browser window transparent so

245
00:12:32,389 --> 00:12:37,430
user wouldn't interact with their

246
00:12:34,279 --> 00:12:41,899
activity they opens console by sending

247
00:12:37,430 --> 00:12:45,290
ctrl + Shift + J into the browser then

248
00:12:41,899 --> 00:12:48,680
they paste the script and triggers the

249
00:12:45,290 --> 00:12:53,510
JavaScript by using enter and then they

250
00:12:48,680 --> 00:12:55,489
would do a cleanup on the right frame of

251
00:12:53,510 --> 00:12:58,279
this slide you could see like assembly

252
00:12:55,490 --> 00:13:01,220
representing this action so it's not

253
00:12:58,279 --> 00:13:03,829
that easy to write this you definitely

254
00:13:01,220 --> 00:13:07,010
need to know a lot of about Windows

255
00:13:03,829 --> 00:13:09,769
internals but perhaps some security so

256
00:13:07,010 --> 00:13:11,810
she started to block browser console

257
00:13:09,769 --> 00:13:14,540
browser development console so they

258
00:13:11,810 --> 00:13:17,869
invented the second approach they paste

259
00:13:14,540 --> 00:13:19,439
the JavaScript into the address bar so

260
00:13:17,870 --> 00:13:22,410
again the initial

261
00:13:19,440 --> 00:13:25,020
steps are the same to hook rather than

262
00:13:22,410 --> 00:13:26,790
graphics and evens and try and wait for

263
00:13:25,020 --> 00:13:30,030
a correct Bank URL to trigger the main

264
00:13:26,790 --> 00:13:32,969
action so everything is the same

265
00:13:30,030 --> 00:13:35,130
just then then they just select the

266
00:13:32,970 --> 00:13:37,620
address bar because ctrl + L would

267
00:13:35,130 --> 00:13:40,110
select the text in the address bar bar

268
00:13:37,620 --> 00:13:44,280
that'll be able to delete it they would

269
00:13:40,110 --> 00:13:47,100
type JavaScript letter by letter and

270
00:13:44,280 --> 00:13:49,709
then they would script the they would

271
00:13:47,100 --> 00:13:54,110
paste the script itself and entry

272
00:13:49,710 --> 00:13:58,620
direction so all done done through like

273
00:13:54,110 --> 00:14:02,070
simulating users behavior all stored in

274
00:13:58,620 --> 00:14:04,260
the history of the browser again on the

275
00:14:02,070 --> 00:14:09,090
on the right there's like assembly

276
00:14:04,260 --> 00:14:11,970
representing this code and actually this

277
00:14:09,090 --> 00:14:13,980
was the core mechanism and with this

278
00:14:11,970 --> 00:14:16,230
core mechanism they would just like

279
00:14:13,980 --> 00:14:18,990
paste the malicious JavaScript into the

280
00:14:16,230 --> 00:14:21,420
browser and this JavaScript could do the

281
00:14:18,990 --> 00:14:24,870
same thing the regular men in the

282
00:14:21,420 --> 00:14:27,689
browser Trojan to do like to do web

283
00:14:24,870 --> 00:14:30,900
injects and to do form grabbing and in

284
00:14:27,690 --> 00:14:33,600
this sequence of five or six slides we

285
00:14:30,900 --> 00:14:35,939
will show you exactly the mechanism you

286
00:14:33,600 --> 00:14:38,130
have three elements here on the right

287
00:14:35,940 --> 00:14:43,830
you can see a browser with Google search

288
00:14:38,130 --> 00:14:48,060
engine loaded and on left you can see

289
00:14:43,830 --> 00:14:51,540
two like windows one is our emulator of

290
00:14:48,060 --> 00:14:54,540
backslap that runs in the console with

291
00:14:51,540 --> 00:14:56,780
the parameter the malicious script that

292
00:14:54,540 --> 00:15:00,569
we borrowed from the authors like the

293
00:14:56,780 --> 00:15:02,910
except of some changes tiny changes the

294
00:15:00,570 --> 00:15:06,600
JavaScript was like malicious our

295
00:15:02,910 --> 00:15:10,949
emulator was just artificial copy of

296
00:15:06,600 --> 00:15:13,920
their activity and on the lower lower

297
00:15:10,950 --> 00:15:17,430
left you can see a notepad this serves

298
00:15:13,920 --> 00:15:19,589
just as indicator of what is in the

299
00:15:17,430 --> 00:15:22,560
clipboard this note that is would

300
00:15:19,589 --> 00:15:27,330
reflect what's happening in clipboard so

301
00:15:22,560 --> 00:15:30,239
this is the setup and now user user

302
00:15:27,330 --> 00:15:32,580
selects selects the address bar in the

303
00:15:30,240 --> 00:15:33,120
browser and our emulator catches the

304
00:15:32,580 --> 00:15:35,189
event

305
00:15:33,120 --> 00:15:39,120
it shows that you are accessed and

306
00:15:35,189 --> 00:15:41,998
engine address and the user user starts

307
00:15:39,120 --> 00:15:43,769
to type his favorite remote banking

308
00:15:41,999 --> 00:15:46,949
interface in this case it's Bank

309
00:15:43,769 --> 00:15:49,319
it's a Spanish bank and and our analyzer

310
00:15:46,949 --> 00:15:53,910
of that swap like catches all the events

311
00:15:49,319 --> 00:15:56,819
or all the strokes of the user and and

312
00:15:53,910 --> 00:16:03,389
always compares it with patterns that is

313
00:15:56,819 --> 00:16:06,389
hard-coded in the script and if if the

314
00:16:03,389 --> 00:16:08,819
the URL fits some of these patterns of

315
00:16:06,389 --> 00:16:12,290
these rules the malicious JavaScript is

316
00:16:08,819 --> 00:16:15,930
injected injected into the browser and

317
00:16:12,290 --> 00:16:20,670
so so now the Ted of the browser is

318
00:16:15,930 --> 00:16:23,459
compromised and this is like the initial

319
00:16:20,670 --> 00:16:26,099
page of internet banking of a Spanish

320
00:16:23,459 --> 00:16:29,790
bank and user and just fills his

321
00:16:26,100 --> 00:16:31,170
credentials into the into the forms but

322
00:16:29,790 --> 00:16:34,680
the tab is compromised

323
00:16:31,170 --> 00:16:37,469
so the moshus JavaScript just catches

324
00:16:34,680 --> 00:16:41,670
all these information from entered

325
00:16:37,470 --> 00:16:44,790
entered into the forms it copies it into

326
00:16:41,670 --> 00:16:47,069
the clipboard and if we do a paste from

327
00:16:44,790 --> 00:16:50,040
the clipboard at this right moment we

328
00:16:47,069 --> 00:16:52,469
can find a special format a special

329
00:16:50,040 --> 00:16:54,540
string format it in the characteristic

330
00:16:52,470 --> 00:16:57,660
way that contains all the login

331
00:16:54,540 --> 00:17:01,709
information of the of the victim so this

332
00:16:57,660 --> 00:17:04,470
is form grabbing done by baxford and now

333
00:17:01,709 --> 00:17:06,779
if it's in clipboard the malicious shell

334
00:17:04,470 --> 00:17:09,779
code could just check for the specific

335
00:17:06,779 --> 00:17:12,659
format in the clipboard and get those

336
00:17:09,779 --> 00:17:15,689
data and send those data to the CNC

337
00:17:12,659 --> 00:17:18,870
server of the attackers so if we compare

338
00:17:15,689 --> 00:17:22,319
conventional MIT B's with this new

339
00:17:18,869 --> 00:17:25,188
approach we can see many differences

340
00:17:22,319 --> 00:17:29,370
like if you do classical MITB attacks

341
00:17:25,189 --> 00:17:31,770
you need to write your malicious module

342
00:17:29,370 --> 00:17:33,959
that would be injected into the targeted

343
00:17:31,770 --> 00:17:36,418
browser for both platforms because there

344
00:17:33,960 --> 00:17:40,399
are users who use 32-bit chrome and

345
00:17:36,419 --> 00:17:44,850
there are users who use 64-bit versions

346
00:17:40,399 --> 00:17:47,020
moreover you need to like support the

347
00:17:44,850 --> 00:17:51,090
specific browser because some users use

348
00:17:47,020 --> 00:17:53,980
opera some users use Firefox and so on

349
00:17:51,090 --> 00:17:56,290
moreover for chromium based projects

350
00:17:53,980 --> 00:17:59,380
it's an it's another additional tricky

351
00:17:56,290 --> 00:18:01,389
part because the attack points of

352
00:17:59,380 --> 00:18:03,570
interest the functions that are hooked

353
00:18:01,390 --> 00:18:06,550
by conventional banking Trojans

354
00:18:03,570 --> 00:18:08,520
sometimes changes so they need to

355
00:18:06,550 --> 00:18:13,980
support their malicious activity

356
00:18:08,520 --> 00:18:13,980
continuously as the browser develops and

357
00:18:14,400 --> 00:18:19,300
another another disadvantage of a

358
00:18:17,260 --> 00:18:22,629
classical MIT B is that this is a

359
00:18:19,300 --> 00:18:26,350
technique known from I don't know 2007

360
00:18:22,630 --> 00:18:28,809
used first by Zeus so there are many

361
00:18:26,350 --> 00:18:33,480
security solutions providing specific

362
00:18:28,809 --> 00:18:36,100
security against this kind of attacks so

363
00:18:33,480 --> 00:18:38,140
additional this is the disadvantage for

364
00:18:36,100 --> 00:18:42,760
the attackers perhaps all these all

365
00:18:38,140 --> 00:18:46,240
these reasons give extra authors like

366
00:18:42,760 --> 00:18:49,690
enough energy or motivation to create

367
00:18:46,240 --> 00:18:51,220
something new because all the old men in

368
00:18:49,690 --> 00:18:55,660
the browser attacks are so known and

369
00:18:51,220 --> 00:18:57,790
could be easily prevented the advantage

370
00:18:55,660 --> 00:19:00,940
of classical MITB is that the attacker

371
00:18:57,790 --> 00:19:06,070
gets full control over the browser this

372
00:19:00,940 --> 00:19:09,130
is not the case of backstop so how back

373
00:19:06,070 --> 00:19:12,850
swept has the advantage in comparison

374
00:19:09,130 --> 00:19:14,440
with MIT V's classic ones like browser

375
00:19:12,850 --> 00:19:16,110
architecture doesn't matter always

376
00:19:14,440 --> 00:19:19,929
happening in the graphic user interface

377
00:19:16,110 --> 00:19:23,439
subsystem so it works for any browser as

378
00:19:19,929 --> 00:19:27,730
long as it supports JavaScript address

379
00:19:23,440 --> 00:19:29,080
bar or web development console specific

380
00:19:27,730 --> 00:19:33,820
version of the browser doesn't matter

381
00:19:29,080 --> 00:19:36,790
and because only tiny JavaScript is used

382
00:19:33,820 --> 00:19:42,189
as a malicious activity it's even harder

383
00:19:36,790 --> 00:19:45,100
to detect this this lower and what could

384
00:19:42,190 --> 00:19:47,410
be a disadvantage it is that only the

385
00:19:45,100 --> 00:19:52,350
active the browser tab is compromised

386
00:19:47,410 --> 00:19:54,880
all all the other tabs are intact and

387
00:19:52,350 --> 00:19:59,990
again when we learned about this threat

388
00:19:54,880 --> 00:20:03,020
we tried hard to adopt some

389
00:19:59,990 --> 00:20:05,630
or we we try to like explain the threat

390
00:20:03,020 --> 00:20:07,879
so perhaps security solutions would

391
00:20:05,630 --> 00:20:09,980
bring their their approach how to

392
00:20:07,880 --> 00:20:12,230
mitigate this attack I guess this was

393
00:20:09,980 --> 00:20:13,580
the case like that's even that's that's

394
00:20:12,230 --> 00:20:15,320
a good thing about sharing this

395
00:20:13,580 --> 00:20:18,110
knowledge that if you share the

396
00:20:15,320 --> 00:20:20,330
mechanism the security developers could

397
00:20:18,110 --> 00:20:28,399
learn from it and like develop

398
00:20:20,330 --> 00:20:31,879
mitigation strategies and solutions now

399
00:20:28,400 --> 00:20:36,320
as we said before shell code of duxford

400
00:20:31,880 --> 00:20:37,940
had structure like to it was like it has

401
00:20:36,320 --> 00:20:39,889
two structures first one was the shell

402
00:20:37,940 --> 00:20:43,790
code itself and the second one was a bit

403
00:20:39,890 --> 00:20:46,730
met with the correct header and this is

404
00:20:43,790 --> 00:20:50,059
an example of the back swept like gets

405
00:20:46,730 --> 00:20:52,370
from its early days the shell code

406
00:20:50,059 --> 00:20:54,889
itself this is a bitmap representing the

407
00:20:52,370 --> 00:20:58,189
file the shell code itself is the like

408
00:20:54,890 --> 00:21:02,690
the part is the huge noise and the rest

409
00:20:58,190 --> 00:21:06,559
is a picture of Stalin with quotation

410
00:21:02,690 --> 00:21:12,080
like nasha nasha nasha del

411
00:21:06,559 --> 00:21:15,678
bravo me Bob a deal for Papa Deen Paula

412
00:21:12,080 --> 00:21:20,570
Deen I guess this is our cost is rights

413
00:21:15,679 --> 00:21:23,179
we won and this is the the like

414
00:21:20,570 --> 00:21:25,040
identified original this was the

415
00:21:23,179 --> 00:21:28,850
original and the model artist took a

416
00:21:25,040 --> 00:21:32,480
lower lower quality copy of this image

417
00:21:28,850 --> 00:21:34,309
and but this is not by styling it was

418
00:21:32,480 --> 00:21:38,300
from the speech of general motive on

419
00:21:34,309 --> 00:21:42,530
June 22nd 41 announcing Soviet Union was

420
00:21:38,300 --> 00:21:45,139
announcing war against Nazi Germany and

421
00:21:42,530 --> 00:21:50,320
this was from the speech to the public

422
00:21:45,140 --> 00:21:53,480
and I guess this slogan is also used in

423
00:21:50,320 --> 00:21:55,460
medals for Soviet soldiers I believe

424
00:21:53,480 --> 00:21:57,190
this is kind of cultural reference

425
00:21:55,460 --> 00:22:01,429
reference against related to Russian

426
00:21:57,190 --> 00:22:03,860
history but they there were more of

427
00:22:01,429 --> 00:22:07,160
these pictures we were always curious

428
00:22:03,860 --> 00:22:11,479
about which picture was used in their

429
00:22:07,160 --> 00:22:13,730
campaigns and hard to identify I don't

430
00:22:11,480 --> 00:22:20,090
know about these is

431
00:22:13,730 --> 00:22:24,800
Zelda yeah this is Zelda this is from

432
00:22:20,090 --> 00:22:26,810
Scarface with Al Pacino so I guess these

433
00:22:24,800 --> 00:22:33,139
three pictures doesn't have any relation

434
00:22:26,810 --> 00:22:36,950
to Russia our Soviet Union we thought

435
00:22:33,140 --> 00:22:37,570
this is Ronaldo but perhaps it is I

436
00:22:36,950 --> 00:22:42,110
don't know

437
00:22:37,570 --> 00:22:44,120
and guy without heads okay

438
00:22:42,110 --> 00:22:46,340
Israel researcher from checkpoint and I

439
00:22:44,120 --> 00:22:49,040
find that this is part of a character

440
00:22:46,340 --> 00:22:52,189
from South Park a Cartman's part of a

441
00:22:49,040 --> 00:22:56,930
body yeah this was a tweet revealing the

442
00:22:52,190 --> 00:23:00,380
connection and yeah our friend from

443
00:22:56,930 --> 00:23:03,410
checkpoint also mark lactic told us that

444
00:23:00,380 --> 00:23:06,350
this is a character from Soviets series

445
00:23:03,410 --> 00:23:12,460
like 70s do anybody recognize this

446
00:23:06,350 --> 00:23:12,459
series yeah there are several people

447
00:23:16,270 --> 00:23:25,010
okay okay so okay go dude and we

448
00:23:22,220 --> 00:23:31,460
couldn't identify him but our colleagues

449
00:23:25,010 --> 00:23:33,560
did and okay okay so sometimes it was

450
00:23:31,460 --> 00:23:37,430
Russian related or Soviet related

451
00:23:33,560 --> 00:23:39,159
sometimes it was it was not but there

452
00:23:37,430 --> 00:23:43,160
were cases these smaller authors

453
00:23:39,160 --> 00:23:46,490
directly sent us messages us as a

454
00:23:43,160 --> 00:23:51,320
antivirus community this was an example

455
00:23:46,490 --> 00:23:54,230
dear AV vendors you suck from huge you

456
00:23:51,320 --> 00:23:58,040
laugh with huge laugh from Russia okay

457
00:23:54,230 --> 00:24:01,850
so these we can't confirm the data from

458
00:23:58,040 --> 00:24:04,550
Russia but they pretend to be from

459
00:24:01,850 --> 00:24:08,439
Russia at least and this is putting

460
00:24:04,550 --> 00:24:10,879
drinking champagne is that correct

461
00:24:08,440 --> 00:24:14,120
so this was one message and they

462
00:24:10,880 --> 00:24:16,100
sometimes this was kind of innocent

463
00:24:14,120 --> 00:24:19,459
message but sometimes they threatened us

464
00:24:16,100 --> 00:24:23,709
like they warned us not to mess with

465
00:24:19,460 --> 00:24:26,539
their shellcode but suggested different

466
00:24:23,710 --> 00:24:29,029
activities instead

467
00:24:26,539 --> 00:24:35,179
so this was directly from the data

468
00:24:29,029 --> 00:24:37,070
section of one of the binaries and this

469
00:24:35,179 --> 00:24:39,949
was from a recent campaign it was May

470
00:24:37,070 --> 00:24:43,609
2019 actually there were two events

471
00:24:39,949 --> 00:24:48,320
happening on that day it was like 2nd of

472
00:24:43,609 --> 00:24:50,689
May like in in in early noon or early

473
00:24:48,320 --> 00:24:52,968
afternoon the guys was spreading back

474
00:24:50,690 --> 00:24:53,389
sweat with this bitmap representing the

475
00:24:52,969 --> 00:24:58,129
shellcode

476
00:24:53,389 --> 00:25:00,738
it is a mask it was a like a character

477
00:24:58,129 --> 00:25:07,329
from a American movie with Jim Carrey

478
00:25:00,739 --> 00:25:10,069
and Jay Rodriguez being like realized

479
00:25:07,329 --> 00:25:13,819
he's a Spanish security researcher and

480
00:25:10,069 --> 00:25:17,989
he realized this that's that a local

481
00:25:13,819 --> 00:25:21,199
Spanish TV dnt broadcast it's like the

482
00:25:17,989 --> 00:25:23,089
mask like both those parts of masks on

483
00:25:21,199 --> 00:25:27,349
the same day so perhaps these two events

484
00:25:23,089 --> 00:25:31,339
were really related it was a Spanish

485
00:25:27,349 --> 00:25:37,099
Spanish campaign yeah this is a mascara

486
00:25:31,339 --> 00:25:38,448
mascara means a mask and this is data

487
00:25:37,099 --> 00:25:40,968
from submission to the virustotal

488
00:25:38,449 --> 00:25:42,649
service we saw it at 1:00 1:00 p.m. and

489
00:25:40,969 --> 00:25:45,589
the first submission to the virus total

490
00:25:42,649 --> 00:25:48,139
was at 5:00 5:00 p.m. and the

491
00:25:45,589 --> 00:25:53,779
broadcasting was at I guess at 2:00 or

492
00:25:48,139 --> 00:26:01,698
3:00 so let's move to the third part

493
00:25:53,779 --> 00:26:06,049
perhaps now I give word to so let me

494
00:26:01,699 --> 00:26:09,679
tell you something a voter's cybercrime

495
00:26:06,049 --> 00:26:13,069
scheme now so the alter key the curse

496
00:26:09,679 --> 00:26:17,479
needs a way to divert the money to their

497
00:26:13,069 --> 00:26:22,099
bank accounts do ring a wire transfer

498
00:26:17,479 --> 00:26:25,339
and obviously they cannot use their own

499
00:26:22,099 --> 00:26:27,019
bank account because if they would put

500
00:26:25,339 --> 00:26:30,579
this to the bank account into the

501
00:26:27,019 --> 00:26:32,869
binaries Dave get caught like we

502
00:26:30,579 --> 00:26:35,869
reported the bank accounts to the law

503
00:26:32,869 --> 00:26:38,939
enforcement and they will just get ours

504
00:26:35,869 --> 00:26:41,490
that in some place Oh

505
00:26:38,940 --> 00:26:46,890
they have to use millenials instead and

506
00:26:41,490 --> 00:26:49,770
the the way to they get these manuals is

507
00:26:46,890 --> 00:26:52,680
that a hard time 2d online

508
00:26:49,770 --> 00:26:54,810
advertisements I'm sure you all saw this

509
00:26:52,680 --> 00:26:56,940
out residence it's like the two too good

510
00:26:54,810 --> 00:27:02,190
to be true ads that promise you will

511
00:26:56,940 --> 00:27:05,330
make ten ten thousand dollars per day

512
00:27:02,190 --> 00:27:09,840
for just sitting at home doing nothing

513
00:27:05,330 --> 00:27:12,419
and stuff like that but so so so so

514
00:27:09,840 --> 00:27:18,290
people fall fall for it fall for these

515
00:27:12,420 --> 00:27:21,600
ads and they they get hired and they

516
00:27:18,290 --> 00:27:25,260
usually provide their bank accounts for

517
00:27:21,600 --> 00:27:27,899
the operation they they of course don't

518
00:27:25,260 --> 00:27:30,660
have to know that they are able to

519
00:27:27,900 --> 00:27:34,170
commit a crime they might my belief that

520
00:27:30,660 --> 00:27:38,840
they are doing some legitimate babies

521
00:27:34,170 --> 00:27:42,890
need some like trading or something and

522
00:27:38,840 --> 00:27:48,620
once once they do the a constant get

523
00:27:42,890 --> 00:27:53,940
embedded into the binaries and he

524
00:27:48,620 --> 00:27:57,389
eventually like when a we him try to

525
00:27:53,940 --> 00:28:01,080
send so so so so so money to pay his

526
00:27:57,390 --> 00:28:05,280
rent he he sends it to the mule instead

527
00:28:01,080 --> 00:28:08,220
and and of course once the mule really

528
00:28:05,280 --> 00:28:11,639
sees the throttle from internal

529
00:28:08,220 --> 00:28:16,340
transactions he it needs to find a way

530
00:28:11,640 --> 00:28:16,340
to transfer the money to the attackers

531
00:28:16,520 --> 00:28:23,100
you're not sure how this is done but but

532
00:28:21,090 --> 00:28:26,939
we think it might be done like to create

533
00:28:23,100 --> 00:28:31,409
a currency stud Muse by create critical

534
00:28:26,940 --> 00:28:34,170
rinse your life for for money they stole

535
00:28:31,410 --> 00:28:36,600
and then they around transfer the

536
00:28:34,170 --> 00:28:40,410
cryptic color color color color incident

537
00:28:36,600 --> 00:28:43,409
occurs or today just we we read row cash

538
00:28:40,410 --> 00:28:44,460
from ATM and then somehow pass the cash

539
00:28:43,410 --> 00:28:47,790
to them

540
00:28:44,460 --> 00:28:52,140
that they could also buy some stuff

541
00:28:47,790 --> 00:28:56,460
online on our zone and just sending the

542
00:28:52,140 --> 00:28:59,310
stuff to some foreign country and then

543
00:28:56,460 --> 00:29:03,090
the Tigers will get the stuff and sell

544
00:28:59,310 --> 00:29:07,350
it but we are not sure because we have

545
00:29:03,090 --> 00:29:14,939
no way of confirming this so throughout

546
00:29:07,350 --> 00:29:18,899
our work we quoted all all over 70

547
00:29:14,940 --> 00:29:21,900
unique mule bank accounts as you can see

548
00:29:18,900 --> 00:29:25,500
on the graph mall September from Spain

549
00:29:21,900 --> 00:29:27,480
and Poland and it directly correlates

550
00:29:25,500 --> 00:29:29,700
with the length of the campaigns in in

551
00:29:27,480 --> 00:29:33,360
this country so that means this first

552
00:29:29,700 --> 00:29:35,850
part spanish campaign was the longest

553
00:29:33,360 --> 00:29:37,889
one then ten followed by the Pope Paul

554
00:29:35,850 --> 00:29:41,280
Sean and since the Czech campaign was

555
00:29:37,890 --> 00:29:43,860
quite short it was like three weeks it

556
00:29:41,280 --> 00:29:46,830
was just a few paying paying cups there

557
00:29:43,860 --> 00:29:49,709
and there was all also a few Romanian

558
00:29:46,830 --> 00:29:53,600
ones we don't know why they chose the

559
00:29:49,710 --> 00:29:57,480
wrong many one he it was in one of those

560
00:29:53,600 --> 00:30:00,689
Spanish attack but we think they might

561
00:29:57,480 --> 00:30:05,040
have just gotten out of the accounts and

562
00:30:00,690 --> 00:30:07,190
started to use Romanian in instead so

563
00:30:05,040 --> 00:30:11,280
that that concludes the third part and

564
00:30:07,190 --> 00:30:12,990
so let's summarize what we learned the

565
00:30:11,280 --> 00:30:15,510
more developers behind the threat

566
00:30:12,990 --> 00:30:18,180
continuously improved their their

567
00:30:15,510 --> 00:30:24,930
leverage of windows clipboard that was

568
00:30:18,180 --> 00:30:26,490
the key part and definitely the mobile

569
00:30:24,930 --> 00:30:30,390
developers behind is knew a lot about

570
00:30:26,490 --> 00:30:32,370
Windows Windows Windows internals they

571
00:30:30,390 --> 00:30:36,510
know a lot about JavaScript and 32-bit

572
00:30:32,370 --> 00:30:39,629
assembly perhaps ok now we don't know

573
00:30:36,510 --> 00:30:42,720
for sure but perhaps it is also possible

574
00:30:39,630 --> 00:30:46,560
to port these mechanisms to another

575
00:30:42,720 --> 00:30:48,660
platforms perhaps we could see a similar

576
00:30:46,560 --> 00:30:52,139
threat leveraging graphic user interface

577
00:30:48,660 --> 00:30:54,240
instead of hooking functions in the

578
00:30:52,140 --> 00:30:57,210
binaries in the executables for Mac

579
00:30:54,240 --> 00:30:58,050
platform and this could be like the next

580
00:30:57,210 --> 00:31:03,030
step that

581
00:30:58,050 --> 00:31:04,950
could could implement and finally the

582
00:31:03,030 --> 00:31:07,830
attackers have to exploit either real

583
00:31:04,950 --> 00:31:11,460
people as their straumann or missiles

584
00:31:07,830 --> 00:31:13,770
fake identities and this is actually the

585
00:31:11,460 --> 00:31:17,070
weakest link in their modus operandi

586
00:31:13,770 --> 00:31:19,050
because if we track their campaigns and

587
00:31:17,070 --> 00:31:21,480
collect all the samples collect all

588
00:31:19,050 --> 00:31:23,639
their web injects extract all the bank

589
00:31:21,480 --> 00:31:26,100
accounts now bank account numbers report

590
00:31:23,640 --> 00:31:29,640
these account numbers to banks they

591
00:31:26,100 --> 00:31:32,639
could be the first like first step they

592
00:31:29,640 --> 00:31:34,500
could block them or just monitor the

593
00:31:32,640 --> 00:31:37,590
transactions from them from these

594
00:31:34,500 --> 00:31:40,170
accounts or we could report it to the

595
00:31:37,590 --> 00:31:42,240
law enforcement entities so they could

596
00:31:40,170 --> 00:31:46,620
like being more aggressive to to

597
00:31:42,240 --> 00:31:50,640
mitigate the threat so I guess this is

598
00:31:46,620 --> 00:31:53,520
the main reason why like we security

599
00:31:50,640 --> 00:31:56,070
researchers should track activities of

600
00:31:53,520 --> 00:32:00,270
smaller actors like like the backside

601
00:31:56,070 --> 00:32:03,360
and this is the point where I would stop

602
00:32:00,270 --> 00:32:06,710
our talk so if you have any questions we

603
00:32:03,360 --> 00:32:06,709
will be glad to answer

604
00:32:09,610 --> 00:32:11,669
you

