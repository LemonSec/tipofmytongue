1
00:00:00,790 --> 00:00:04,760
thanks everyone hope you're having a

2
00:00:02,870 --> 00:00:06,470
good conference appreciate everybody

3
00:00:04,760 --> 00:00:09,680
attending under different circumstances

4
00:00:06,470 --> 00:00:13,160
I realized the gravity of the situation

5
00:00:09,680 --> 00:00:15,110
that's ahead of us but importantly we

6
00:00:13,160 --> 00:00:17,409
still have jobs to do and I appreciate

7
00:00:15,110 --> 00:00:20,689
everybody coming here to talk about

8
00:00:17,409 --> 00:00:23,900
threat hunting and where we see that

9
00:00:20,689 --> 00:00:25,550
moving forward the introduction that we

10
00:00:23,900 --> 00:00:27,319
went through just give you that quick

11
00:00:25,550 --> 00:00:29,509
background again so I lead the sales

12
00:00:27,319 --> 00:00:31,609
engineering team for the west and exa

13
00:00:29,509 --> 00:00:34,309
beam now we're a next-generation SIM

14
00:00:31,609 --> 00:00:37,309
provider that does you EPA what I'm

15
00:00:34,309 --> 00:00:40,640
going to be talking about mostly is how

16
00:00:37,309 --> 00:00:42,349
I used to do threat hunting in Sims and

17
00:00:40,640 --> 00:00:45,109
where a lot of customers I still speak

18
00:00:42,350 --> 00:00:47,480
to our doing threat hunting today so I

19
00:00:45,109 --> 00:00:50,179
used to do a triaging alerts and threat

20
00:00:47,480 --> 00:00:55,129
hunting as an analyst I worked in Splunk

21
00:00:50,179 --> 00:00:58,999
IBM qradar RSA security analytics McAfee

22
00:00:55,129 --> 00:01:01,039
nitro and elastic so those who the sims

23
00:00:58,999 --> 00:01:04,370
we operationalize in a managed service

24
00:01:01,039 --> 00:01:07,010
provider Drowned and alerts and then I

25
00:01:04,370 --> 00:01:09,170
moved into the sim engineer position

26
00:01:07,010 --> 00:01:11,060
where I started helping write the rules

27
00:01:09,170 --> 00:01:15,140
I manage threat intelligence

28
00:01:11,060 --> 00:01:18,430
integrations to bring IOC's in to sim

29
00:01:15,140 --> 00:01:21,460
products and also wrote play books for

30
00:01:18,430 --> 00:01:24,620
analysts of how to effectively leverage

31
00:01:21,460 --> 00:01:26,570
threat hunting techniques

32
00:01:24,620 --> 00:01:28,430
so that's where I came from and then I

33
00:01:26,570 --> 00:01:31,880
left the Simms face because quite

34
00:01:28,430 --> 00:01:32,780
frankly I felt that it was over promised

35
00:01:31,880 --> 00:01:35,570
under-delivered

36
00:01:32,780 --> 00:01:38,660
they were mostly they were sold as put

37
00:01:35,570 --> 00:01:40,369
everything in a bucket and the important

38
00:01:38,660 --> 00:01:43,220
stuff will bubble to the top but really

39
00:01:40,370 --> 00:01:45,920
it was a developmental platform that was

40
00:01:43,220 --> 00:01:48,560
very difficult for most customers to

41
00:01:45,920 --> 00:01:51,110
operationalise only really the fortune

42
00:01:48,560 --> 00:01:53,750
500 and 100 had the resources to really

43
00:01:51,110 --> 00:01:56,360
make those work so they made me leave

44
00:01:53,750 --> 00:01:59,890
for a long time now I'm back but less

45
00:01:56,360 --> 00:02:02,260
about where I'm at and let's talk about

46
00:01:59,890 --> 00:02:04,480
IOC s

47
00:02:02,260 --> 00:02:06,790
the agenda I'm going to talk about what

48
00:02:04,480 --> 00:02:09,490
are IO sees how do people use them

49
00:02:06,790 --> 00:02:13,690
mostly how do they apply to a kill chain

50
00:02:09,490 --> 00:02:17,350
and then what I want to move into our TT

51
00:02:13,690 --> 00:02:20,760
piece so tools tactics how are they used

52
00:02:17,350 --> 00:02:23,109
how do we combine those with analytics

53
00:02:20,760 --> 00:02:25,720
where do those fit in the kill chain

54
00:02:23,110 --> 00:02:27,700
that's really the flow we're gonna go

55
00:02:25,720 --> 00:02:30,040
through so a lot of the beginning should

56
00:02:27,700 --> 00:02:31,929
be very familiar I'm just gonna really

57
00:02:30,040 --> 00:02:34,239
make you remember all the pain that

58
00:02:31,930 --> 00:02:37,750
we're all going through in most

59
00:02:34,240 --> 00:02:41,740
environments IO sees what are I o sees

60
00:02:37,750 --> 00:02:43,840
these are indicators they're artifacts

61
00:02:41,740 --> 00:02:45,430
that give you an indication that there

62
00:02:43,840 --> 00:02:49,090
could have been a computer intrusion a

63
00:02:45,430 --> 00:02:52,150
lot of times these are simple one-line

64
00:02:49,090 --> 00:02:56,490
indicators AV signatures hashes file

65
00:02:52,150 --> 00:03:01,500
names IDs URLs these look familiar right

66
00:02:56,490 --> 00:03:05,260
different types of i/o sees some vendors

67
00:03:01,500 --> 00:03:07,720
call IO sees just this I these hashes

68
00:03:05,260 --> 00:03:11,079
registry keys some people are calling

69
00:03:07,720 --> 00:03:14,380
these observable observables other

70
00:03:11,080 --> 00:03:18,190
vendors will only call a combination of

71
00:03:14,380 --> 00:03:20,609
IO cease to be or I'm sorry a

72
00:03:18,190 --> 00:03:24,489
combination of observables to be an IO C

73
00:03:20,610 --> 00:03:27,250
either way we're gonna use miter attack

74
00:03:24,489 --> 00:03:30,130
frameworks definition which is that this

75
00:03:27,250 --> 00:03:32,290
is a either a network or system

76
00:03:30,130 --> 00:03:34,480
indicator that gives you a high

77
00:03:32,290 --> 00:03:36,940
confidence there was an intrusion how

78
00:03:34,480 --> 00:03:38,738
did I OC start where are we gone there's

79
00:03:36,940 --> 00:03:40,540
a lot of debate over first so I'm not

80
00:03:38,739 --> 00:03:44,170
gonna make any claim so what first was

81
00:03:40,540 --> 00:03:46,810
but one of the early IOC s was antivirus

82
00:03:44,170 --> 00:03:49,268
we had malware signatures one of the

83
00:03:46,810 --> 00:03:51,070
first ones that was ever a virus that

84
00:03:49,269 --> 00:03:54,600
was ever removed in the wild by an

85
00:03:51,070 --> 00:03:58,180
antivirus was called the Vienna virus in

86
00:03:54,600 --> 00:04:02,200
1987 then we started seeing networking

87
00:03:58,180 --> 00:04:05,680
grow and organizations wanted to monitor

88
00:04:02,200 --> 00:04:10,030
the ingress and egress spaces so then we

89
00:04:05,680 --> 00:04:11,410
got IP X we got frame relay we got IP we

90
00:04:10,030 --> 00:04:14,500
got atm

91
00:04:11,410 --> 00:04:16,540
and then we started using IP tables to

92
00:04:14,500 --> 00:04:18,910
start tracking not just what happened on

93
00:04:16,540 --> 00:04:20,419
the endpoint but communication back and

94
00:04:18,910 --> 00:04:22,879
forth

95
00:04:20,418 --> 00:04:26,870
right we started getting into firewalls

96
00:04:22,879 --> 00:04:29,960
then we got network intrusion right Oh

97
00:04:26,870 --> 00:04:32,509
an IPS came out but nibs now we're not

98
00:04:29,960 --> 00:04:35,779
just looking at the IPS but we're

99
00:04:32,509 --> 00:04:39,409
looking at correlating large volumes of

100
00:04:35,779 --> 00:04:42,590
traffic behavior flows to determine if

101
00:04:39,409 --> 00:04:46,789
there are indicators there then we

102
00:04:42,590 --> 00:04:50,388
started moving into web proxy so now

103
00:04:46,789 --> 00:04:53,900
we've got application layer monitoring

104
00:04:50,389 --> 00:04:56,090
to determine what types of files are

105
00:04:53,900 --> 00:04:59,900
being transferred what services are

106
00:04:56,090 --> 00:05:04,789
being used what protocols now we have a

107
00:04:59,900 --> 00:05:06,919
whole new set of indicators and what

108
00:05:04,789 --> 00:05:09,830
happened is we were logging into all of

109
00:05:06,919 --> 00:05:12,020
these tools separately to try and put

110
00:05:09,830 --> 00:05:15,050
them all together into a story that

111
00:05:12,020 --> 00:05:17,120
wasn't working so we came out with the

112
00:05:15,050 --> 00:05:19,849
first sim technology some of the big

113
00:05:17,120 --> 00:05:22,849
ones out there we talked about Splunk

114
00:05:19,849 --> 00:05:25,000
IBM qradar we'll throw ourselves in

115
00:05:22,849 --> 00:05:29,259
there EXA Beam we've got elastic

116
00:05:25,000 --> 00:05:33,169
logarithm sumo logic event tracker

117
00:05:29,259 --> 00:05:35,240
Microsoft Sentinel there is a lot to

118
00:05:33,169 --> 00:05:38,330
pick from here in the beginning there

119
00:05:35,240 --> 00:05:41,089
was not as much but the pitch was it's

120
00:05:38,330 --> 00:05:43,520
too inefficient to log into all of those

121
00:05:41,089 --> 00:05:46,449
tools and look at those and so we need

122
00:05:43,520 --> 00:05:50,149
to put everything together into a single

123
00:05:46,449 --> 00:05:53,719
platform where analysts can do threat

124
00:05:50,149 --> 00:05:57,500
hunting and incident analysis that was

125
00:05:53,719 --> 00:06:01,550
the pitch the problem is this doesn't

126
00:05:57,500 --> 00:06:05,659
work very well in practice right what we

127
00:06:01,550 --> 00:06:09,639
really ended up with is a giant bucket

128
00:06:05,659 --> 00:06:13,539
full of data and a search bar

129
00:06:09,639 --> 00:06:17,860
that's where most customers live so

130
00:06:13,539 --> 00:06:20,740
let's talk about IOC s in practice so

131
00:06:17,860 --> 00:06:24,099
let's talk about one of the apt threats

132
00:06:20,740 --> 00:06:27,310
that's pretty widely known apt 28 and 29

133
00:06:24,099 --> 00:06:31,120
these were fancy bear and cozy bear this

134
00:06:27,310 --> 00:06:34,030
was the the same team that broke into

135
00:06:31,120 --> 00:06:36,550
the DMZ emails and released those back

136
00:06:34,030 --> 00:06:40,659
in 2016 if you remember that highly

137
00:06:36,550 --> 00:06:46,120
publicized story that was their end goal

138
00:06:40,659 --> 00:06:48,069
and so what are the IOC s that were

139
00:06:46,120 --> 00:06:50,800
related to this threat

140
00:06:48,069 --> 00:06:53,250
one of the first IOC s that we got were

141
00:06:50,800 --> 00:06:56,770
IPS that were used for reconnaissance

142
00:06:53,250 --> 00:07:01,870
one of them being this IP listed here in

143
00:06:56,770 --> 00:07:04,960
red but there was a total of 876 IPS

144
00:07:01,870 --> 00:07:06,520
that we at least knew about on top of

145
00:07:04,960 --> 00:07:09,159
that we knew that they sends a spear

146
00:07:06,520 --> 00:07:12,878
phishing email with a specific subject

147
00:07:09,159 --> 00:07:16,029
line again a specific IOC we know they

148
00:07:12,879 --> 00:07:17,680
exploited a specific vulnerability we

149
00:07:16,029 --> 00:07:20,860
know they dropped malware with a

150
00:07:17,680 --> 00:07:24,009
specific hash we know that they did CNC

151
00:07:20,860 --> 00:07:27,099
connections to a specific domain and we

152
00:07:24,009 --> 00:07:30,580
know that they used that same malware to

153
00:07:27,099 --> 00:07:32,080
exfiltrate data from the system and so

154
00:07:30,580 --> 00:07:35,859
this is what would typically get

155
00:07:32,080 --> 00:07:38,020
released to teams or be in the community

156
00:07:35,860 --> 00:07:40,710
that we would share with one another is

157
00:07:38,020 --> 00:07:43,839
put these hashes in your malware

158
00:07:40,710 --> 00:07:47,258
anti-malware products put these C and C

159
00:07:43,839 --> 00:07:50,110
blocks on your web proxy block this

160
00:07:47,259 --> 00:07:54,069
subject line and your email stop these

161
00:07:50,110 --> 00:07:56,500
IPS at your firewall and that would help

162
00:07:54,069 --> 00:07:58,560
us with known bad right we could you can

163
00:07:56,500 --> 00:08:02,889
search for all of these things in your

164
00:07:58,560 --> 00:08:07,490
sim if you want to look for exactly this

165
00:08:02,889 --> 00:08:09,919
one particular attack

166
00:08:07,490 --> 00:08:13,150
that was the way that we moved forward

167
00:08:09,919 --> 00:08:15,770
the problem with this is that it's

168
00:08:13,150 --> 00:08:18,799
one-dimensional

169
00:08:15,770 --> 00:08:21,859
this IP address that was used for

170
00:08:18,800 --> 00:08:27,259
scanning is used for lots of other

171
00:08:21,860 --> 00:08:29,690
activity IPS are not only done I'm sorry

172
00:08:27,259 --> 00:08:31,190
IPS are not exclusively bad or

173
00:08:29,690 --> 00:08:33,708
exclusively good

174
00:08:31,190 --> 00:08:36,229
anyone who has integrated any threat

175
00:08:33,708 --> 00:08:41,140
intelligence into their Sam or another

176
00:08:36,229 --> 00:08:43,909
product knows that there are very few

177
00:08:41,140 --> 00:08:47,149
indicators that are always worth

178
00:08:43,909 --> 00:08:49,339
investigating sometimes this happens the

179
00:08:47,149 --> 00:08:51,990
FBI will call you and say if you have

180
00:08:49,339 --> 00:08:55,110
any connections to this IP

181
00:08:51,990 --> 00:08:59,130
you have an infection most of the time

182
00:08:55,110 --> 00:09:01,290
though these are just suspicious and so

183
00:08:59,130 --> 00:09:03,360
what you end up with is you get all

184
00:09:01,290 --> 00:09:06,180
excited you import all this threat

185
00:09:03,360 --> 00:09:09,750
intelligence and then you get a thousand

186
00:09:06,180 --> 00:09:13,079
alerts and when you get the alert you

187
00:09:09,750 --> 00:09:15,990
don't know is this IP used for scanning

188
00:09:13,080 --> 00:09:20,910
was it used to send email is this a C&C

189
00:09:15,990 --> 00:09:25,570
domain is this hosting malware all of

190
00:09:20,910 --> 00:09:27,529
these different utilizations of the IP

191
00:09:25,570 --> 00:09:30,470
influence how you do your investigation

192
00:09:27,529 --> 00:09:35,089
but we typically don't have that context

193
00:09:30,470 --> 00:09:37,550
we just have bad IP bad hostname

194
00:09:35,089 --> 00:09:38,569
they're also only valid for short

195
00:09:37,550 --> 00:09:41,209
periods of time

196
00:09:38,569 --> 00:09:44,089
this is one of the biggest problems with

197
00:09:41,209 --> 00:09:45,979
IO C's is that they're valid for as long

198
00:09:44,089 --> 00:09:47,480
as they're valid and the attacker can

199
00:09:45,980 --> 00:09:50,240
change where they're launching these

200
00:09:47,480 --> 00:09:52,939
attacks from at any time and so you have

201
00:09:50,240 --> 00:09:55,730
a very short window to leverage it and

202
00:09:52,939 --> 00:09:57,199
because of that you either end up with a

203
00:09:55,730 --> 00:09:59,240
lot of false positives while you're

204
00:09:57,199 --> 00:10:02,329
trying to chase hundreds you know

205
00:09:59,240 --> 00:10:05,149
there's 800 II's just with this one

206
00:10:02,329 --> 00:10:07,370
attack imagine how many IPS are used for

207
00:10:05,149 --> 00:10:09,680
attacks all over the world you just you

208
00:10:07,370 --> 00:10:11,480
end up with this monster amount of data

209
00:10:09,680 --> 00:10:14,540
the either comes with a ton of false

210
00:10:11,480 --> 00:10:16,579
positives that we all hate or even worse

211
00:10:14,540 --> 00:10:18,949
a false sense of security I don't have

212
00:10:16,579 --> 00:10:20,689
these connections so I can't possibly be

213
00:10:18,949 --> 00:10:22,670
breached or have a problem going on in

214
00:10:20,689 --> 00:10:26,360
my environment you end up with a game of

215
00:10:22,670 --> 00:10:30,949
whack-a-mole let's say that we're trying

216
00:10:26,360 --> 00:10:32,930
to detect a compromise and we find that

217
00:10:30,949 --> 00:10:36,050
someone connected to a known bad IP

218
00:10:32,930 --> 00:10:39,019
address one of most organizations do

219
00:10:36,050 --> 00:10:41,628
today we wipe and rebuild we take it off

220
00:10:39,019 --> 00:10:43,230
the network we reset the password and we

221
00:10:41,629 --> 00:10:45,480
move on

222
00:10:43,230 --> 00:10:48,420
the problem is we didn't have the time

223
00:10:45,480 --> 00:10:50,940
to go back and investigate how did this

224
00:10:48,420 --> 00:10:54,089
happen what was root cause what was the

225
00:10:50,940 --> 00:10:58,980
impact so we didn't have time to go and

226
00:10:54,090 --> 00:11:00,690
add additional IOC s before and after to

227
00:10:58,980 --> 00:11:02,370
continue to help us contain this threat

228
00:11:00,690 --> 00:11:05,250
all we're really doing is whack-a-mole

229
00:11:02,370 --> 00:11:08,640
infection infection infection infection

230
00:11:05,250 --> 00:11:11,310
most teams are far too overwhelmed with

231
00:11:08,640 --> 00:11:14,430
alerts to do deep dive investigations

232
00:11:11,310 --> 00:11:16,920
figure out root cause bit make a big

233
00:11:14,430 --> 00:11:19,079
risk mitigation strategy to put all

234
00:11:16,920 --> 00:11:22,770
these changes into policy and procedures

235
00:11:19,080 --> 00:11:26,070
and that's another big issue with this

236
00:11:22,770 --> 00:11:28,199
tunnel vision of looking at IOC s if

237
00:11:26,070 --> 00:11:29,460
you're just looking at one little part

238
00:11:28,200 --> 00:11:31,260
of the threat and if that's what you're

239
00:11:29,460 --> 00:11:32,970
detecting the attacker can change that

240
00:11:31,260 --> 00:11:36,030
and the rest of the attack still goes

241
00:11:32,970 --> 00:11:39,330
through let's assume that we got a good

242
00:11:36,030 --> 00:11:41,250
IOC hit and we want to pivot we want to

243
00:11:39,330 --> 00:11:43,260
go do an investigation let's just go

244
00:11:41,250 --> 00:11:46,890
through one of those exercises so here

245
00:11:43,260 --> 00:11:49,740
I'm an elastic search and I'm doing a

246
00:11:46,890 --> 00:11:52,710
search for anyone in my organization who

247
00:11:49,740 --> 00:11:56,100
has hit this destination IP in the last

248
00:11:52,710 --> 00:11:58,830
seven days search result comes back oh I

249
00:11:56,100 --> 00:12:02,250
love it only one hit it's our buddy

250
00:11:58,830 --> 00:12:05,700
Eric and he used this source IP address

251
00:12:02,250 --> 00:12:07,710
to make the connection so what's next

252
00:12:05,700 --> 00:12:09,510
for me okay I'm gonna go do a deeper

253
00:12:07,710 --> 00:12:12,240
dive right I'm gonna be a good analyst

254
00:12:09,510 --> 00:12:15,540
I'm gonna go and figure out what other

255
00:12:12,240 --> 00:12:17,670
connections did this host make I only

256
00:12:15,540 --> 00:12:21,030
know one of the bad IP addresses but

257
00:12:17,670 --> 00:12:24,390
let's see where else this user made

258
00:12:21,030 --> 00:12:25,920
outbound connections to and maybe I can

259
00:12:24,390 --> 00:12:29,460
find additional IOC s

260
00:12:25,920 --> 00:12:32,280
so I'm gonna expand my query

261
00:12:29,460 --> 00:12:33,990
I still have destination IP but I also

262
00:12:32,280 --> 00:12:37,620
want to look at anything that was

263
00:12:33,990 --> 00:12:40,650
sourced from Eric or anything from the

264
00:12:37,620 --> 00:12:43,180
source IP that he used in that one day

265
00:12:40,650 --> 00:12:46,689
the problem is I

266
00:12:43,180 --> 00:12:48,579
1.4 million events that this is what

267
00:12:46,690 --> 00:12:52,660
will happen when your logging process

268
00:12:48,580 --> 00:12:56,440
activity web proxy activity you're

269
00:12:52,660 --> 00:12:58,860
logging firewall activity these are very

270
00:12:56,440 --> 00:13:03,420
verbose logs

271
00:12:58,860 --> 00:13:06,270
that includes over 600 destination IPS

272
00:13:03,420 --> 00:13:09,300
he communicated with in that one day

273
00:13:06,270 --> 00:13:12,090
that's impossible so how is an analyst

274
00:13:09,300 --> 00:13:14,010
ever going to sort through which of

275
00:13:12,090 --> 00:13:17,970
those 609 are interesting

276
00:13:14,010 --> 00:13:20,130
none of them are known IOC's so how am I

277
00:13:17,970 --> 00:13:22,710
going to narrow this down

278
00:13:20,130 --> 00:13:24,689
and I haven't even gotten to doing what

279
00:13:22,710 --> 00:13:28,140
did they do in their applications or

280
00:13:24,690 --> 00:13:31,590
what processes did they run all of this

281
00:13:28,140 --> 00:13:34,050
becomes an impossible task we're really

282
00:13:31,590 --> 00:13:37,020
stuck in this is why we're stuck in the

283
00:13:34,050 --> 00:13:40,410
whack-a-mole mode we would love the idea

284
00:13:37,020 --> 00:13:44,790
of I want to review what happened in DLP

285
00:13:40,410 --> 00:13:48,480
my email web apps proxy cloud

286
00:13:44,790 --> 00:13:52,020
applications firewall VPN there's too

287
00:13:48,480 --> 00:13:54,480
much to go through and so the way that X

288
00:13:52,020 --> 00:13:58,439
apena does this and the way we recommend

289
00:13:54,480 --> 00:14:00,330
analysts sort through this noise is a

290
00:13:58,440 --> 00:14:04,500
little bit differently so instead of

291
00:14:00,330 --> 00:14:08,010
only relying on IO sees we also leverage

292
00:14:04,500 --> 00:14:11,850
analytics and user behavior and now

293
00:14:08,010 --> 00:14:14,580
we're getting closer to TTP's so in this

294
00:14:11,850 --> 00:14:17,460
example Frederik okay Eric in this

295
00:14:14,580 --> 00:14:20,820
example we see that instead of like

296
00:14:17,460 --> 00:14:23,730
elastic just to gave us the one IP but

297
00:14:20,820 --> 00:14:26,640
here we see that not only did this IP

298
00:14:23,730 --> 00:14:28,920
address match a risky reputation feed

299
00:14:26,640 --> 00:14:31,730
but it was also the first time that

300
00:14:28,920 --> 00:14:34,829
they've accessed an Internet IP in China

301
00:14:31,730 --> 00:14:39,410
it's also the first time anyone in the

302
00:14:34,830 --> 00:14:41,689
organization had accessed an IP in China

303
00:14:39,410 --> 00:14:45,469
the difference here between analytics

304
00:14:41,689 --> 00:14:49,728
and sim is that I didn't have to ask

305
00:14:45,470 --> 00:14:53,149
this question in elastic when I saw this

306
00:14:49,729 --> 00:14:56,720
event if I wanted to know if this user

307
00:14:53,149 --> 00:14:59,419
had ever contacted 19 China before I

308
00:14:56,720 --> 00:15:00,709
would need to go run a search and I

309
00:14:59,419 --> 00:15:02,509
would have to wait for that search to

310
00:15:00,709 --> 00:15:05,809
run and it would come back and it would

311
00:15:02,509 --> 00:15:08,029
say no and then I would wonder I wonder

312
00:15:05,809 --> 00:15:10,429
how many connections to China my

313
00:15:08,029 --> 00:15:12,660
organization makes I gotta go run

314
00:15:10,429 --> 00:15:14,250
another query

315
00:15:12,660 --> 00:15:18,389
these are the things we don't have time

316
00:15:14,250 --> 00:15:23,100
for and so we've added additional risk

317
00:15:18,389 --> 00:15:26,070
but with analytics plus known back

318
00:15:23,100 --> 00:15:30,570
and then to help you get through the 1.4

319
00:15:26,070 --> 00:15:33,720
million events we will add anomaly

320
00:15:30,570 --> 00:15:36,150
detection to other log sources like here

321
00:15:33,720 --> 00:15:39,210
we have the process activity that we're

322
00:15:36,150 --> 00:15:41,670
telling you that this user has never run

323
00:15:39,210 --> 00:15:44,460
this process before and nobody who uses

324
00:15:41,670 --> 00:15:47,099
Salesforce in the organization has ever

325
00:15:44,460 --> 00:15:51,120
used it before so now we have additional

326
00:15:47,100 --> 00:15:53,670
insights we're narrowing down what we're

327
00:15:51,120 --> 00:15:58,410
looking at but why is this important why

328
00:15:53,670 --> 00:16:02,430
do we care about an IOC and an abnormal

329
00:15:58,410 --> 00:16:04,589
process executed because and I've had

330
00:16:02,430 --> 00:16:06,780
customers tell me this before I don't

331
00:16:04,590 --> 00:16:09,060
have data scientists I had a security

332
00:16:06,780 --> 00:16:11,850
analysts I don't want to know about

333
00:16:09,060 --> 00:16:16,020
anomalies I want to know about security

334
00:16:11,850 --> 00:16:20,070
incidents so why why does analytics help

335
00:16:16,020 --> 00:16:22,890
us and the reason is is because it helps

336
00:16:20,070 --> 00:16:26,330
us get closer to the whole point of this

337
00:16:22,890 --> 00:16:31,230
talk tactics techniques and procedures

338
00:16:26,330 --> 00:16:33,240
these describe not how the user or how

339
00:16:31,230 --> 00:16:38,250
the attacker is accomplishing their

340
00:16:33,240 --> 00:16:40,170
attack but a high-level view so this is

341
00:16:38,250 --> 00:16:42,180
the minor attack framework I'm positive

342
00:16:40,170 --> 00:16:44,520
this was covered in other parts of the

343
00:16:42,180 --> 00:16:46,439
conference today but if not it's a

344
00:16:44,520 --> 00:16:49,199
really popular framework that's gaining

345
00:16:46,440 --> 00:16:52,650
traction where it breaks down an attack

346
00:16:49,200 --> 00:16:55,250
into different stages so this is like an

347
00:16:52,650 --> 00:16:57,720
evolution of the Lockheed Martin

348
00:16:55,250 --> 00:17:00,030
cyberattack kill chain familiar with

349
00:16:57,720 --> 00:17:02,370
that so initial access execution

350
00:17:00,030 --> 00:17:04,589
persistence privilege escalation defense

351
00:17:02,370 --> 00:17:06,660
evasion credential access discovery

352
00:17:04,589 --> 00:17:09,209
lateral movement collection exfiltration

353
00:17:06,660 --> 00:17:12,120
command and control these are the steps

354
00:17:09,210 --> 00:17:14,819
of any attack that we go through and

355
00:17:12,119 --> 00:17:18,719
there are a number of different

356
00:17:14,819 --> 00:17:21,419
techniques underneath these tactics that

357
00:17:18,720 --> 00:17:25,710
can be leveraged and where we're living

358
00:17:21,420 --> 00:17:28,290
is focusing on really small portions of

359
00:17:25,710 --> 00:17:31,050
this so when we talk about IO CS we're

360
00:17:28,290 --> 00:17:33,930
talking about looking at one command in

361
00:17:31,050 --> 00:17:35,139
control or we're looking at just brute

362
00:17:33,930 --> 00:17:38,350
force attempts

363
00:17:35,140 --> 00:17:40,360
instead of the entire picture what would

364
00:17:38,350 --> 00:17:42,520
you do if we want to look at TTP's we've

365
00:17:40,360 --> 00:17:43,840
already started to do this and you

366
00:17:42,520 --> 00:17:45,879
probably notice this with compliance

367
00:17:43,840 --> 00:17:47,350
frameworks let's start with persistence

368
00:17:45,880 --> 00:17:50,320
as one of these okay we know every every

369
00:17:47,350 --> 00:17:52,810
attacker wants persistence and our

370
00:17:50,320 --> 00:17:56,200
friends on the red team do this all the

371
00:17:52,810 --> 00:17:58,480
time as well so if you want to get local

372
00:17:56,200 --> 00:18:01,420
system account or a domain account you

373
00:17:58,480 --> 00:18:03,400
may need to create an account so an

374
00:18:01,420 --> 00:18:06,220
attacker might create an account to gain

375
00:18:03,400 --> 00:18:10,270
persistence this is the windows event ID

376
00:18:06,220 --> 00:18:12,190
the 4720 okay great and you've

377
00:18:10,270 --> 00:18:14,650
compliance reports that require you to

378
00:18:12,190 --> 00:18:16,150
build reports of everybody who's created

379
00:18:14,650 --> 00:18:18,160
an account or done account management

380
00:18:16,150 --> 00:18:20,320
and you find out in the last quarter

381
00:18:18,160 --> 00:18:22,210
that there were a thousand account

382
00:18:20,320 --> 00:18:26,200
creations what do you do with that

383
00:18:22,210 --> 00:18:27,730
report and rhetorically nothing no one

384
00:18:26,200 --> 00:18:29,560
does anything what are you gonna do call

385
00:18:27,730 --> 00:18:32,410
to every single admin and make them

386
00:18:29,560 --> 00:18:35,470
justify every single account creation

387
00:18:32,410 --> 00:18:37,210
that's not gonna happen and if you do

388
00:18:35,470 --> 00:18:39,670
that you'll find out quickly that I

389
00:18:37,210 --> 00:18:42,760
think will hate you this is the biggest

390
00:18:39,670 --> 00:18:46,740
issue is that these types of activities

391
00:18:42,760 --> 00:18:49,900
can be malicious but they're also

392
00:18:46,740 --> 00:18:53,320
run-of-the-mill admins doing their job

393
00:18:49,900 --> 00:18:56,320
and that goes for a number of these

394
00:18:53,320 --> 00:18:58,000
different techniques if anyone's trying

395
00:18:56,320 --> 00:19:00,730
to write rules around these this is

396
00:18:58,000 --> 00:19:02,950
gonna be cathartic for you brute force

397
00:19:00,730 --> 00:19:05,760
attacks is it no one ever tried to rule

398
00:19:02,950 --> 00:19:09,730
to say you know what if anyone tries to

399
00:19:05,760 --> 00:19:10,840
fails to log in more than fifteen times

400
00:19:09,730 --> 00:19:13,450
in five minutes

401
00:19:10,840 --> 00:19:15,490
give me an alert and then you find out

402
00:19:13,450 --> 00:19:17,530
that half your enterprise does that and

403
00:19:15,490 --> 00:19:19,330
there's all these admins who have buried

404
00:19:17,530 --> 00:19:21,430
credentials and scripts that have been

405
00:19:19,330 --> 00:19:24,070
blasting the domain controller all day

406
00:19:21,430 --> 00:19:25,660
or someone reset their password but

407
00:19:24,070 --> 00:19:27,879
their phone is still synced with the

408
00:19:25,660 --> 00:19:31,450
wrong password and hits exchange server

409
00:19:27,880 --> 00:19:33,690
all day there's so much that looks like

410
00:19:31,450 --> 00:19:37,800
a brute force when it's really normal

411
00:19:33,690 --> 00:19:41,230
RDP it's used normally and by attackers

412
00:19:37,800 --> 00:19:44,169
PowerShell very powerful administrative

413
00:19:41,230 --> 00:19:47,929
functions also used in several apt

414
00:19:44,170 --> 00:19:50,289
attacks account creation we covered data

415
00:19:47,929 --> 00:19:53,269
impression people zipping up files or

416
00:19:50,289 --> 00:19:56,480
sending large amounts of data to thumb

417
00:19:53,269 --> 00:19:58,749
drives or email file transfers inside

418
00:19:56,480 --> 00:20:02,149
the organization whether they're FTP or

419
00:19:58,749 --> 00:20:05,509
File fairs or upload the SharePoint or

420
00:20:02,149 --> 00:20:10,610
Google Drive or box there are a number

421
00:20:05,509 --> 00:20:13,770
of legitimate and suspicious reasons for

422
00:20:10,610 --> 00:20:16,709
all of this tap

423
00:20:13,770 --> 00:20:20,430
and that is what makes it so hard is

424
00:20:16,710 --> 00:20:23,970
that customers are writing rules for

425
00:20:20,430 --> 00:20:26,310
these that are 98 percent false positive

426
00:20:23,970 --> 00:20:29,310
rates and generate a hundred alerts each

427
00:20:26,310 --> 00:20:32,580
a day and nobody can go through them

428
00:20:29,310 --> 00:20:35,520
because they're all focused on each of

429
00:20:32,580 --> 00:20:39,419
these if we go back to they're focused

430
00:20:35,520 --> 00:20:41,730
on small tactics under here instead of

431
00:20:39,420 --> 00:20:44,850
what I'm gonna show you later instead of

432
00:20:41,730 --> 00:20:48,390
focusing on how an attack moves in

433
00:20:44,850 --> 00:20:50,189
general okay so how do we use analytics

434
00:20:48,390 --> 00:20:52,050
to cut through this noise and this

435
00:20:50,190 --> 00:20:54,870
doesn't have to just be product by the

436
00:20:52,050 --> 00:20:56,639
way obviously I'm from an analytics

437
00:20:54,870 --> 00:20:59,850
vendor but as we were talking about

438
00:20:56,640 --> 00:21:03,450
before this call these are are also our

439
00:20:59,850 --> 00:21:06,600
best analysts the ones that can stare at

440
00:21:03,450 --> 00:21:09,480
a group of server traffic and say yeah

441
00:21:06,600 --> 00:21:14,399
this admin does work on these servers

442
00:21:09,480 --> 00:21:16,680
but never this time of day or this admin

443
00:21:14,400 --> 00:21:18,930
creates accounts but they never they

444
00:21:16,680 --> 00:21:21,630
don't manage this group very often they

445
00:21:18,930 --> 00:21:24,150
have the permission to do it but I've

446
00:21:21,630 --> 00:21:27,150
never seen him do that before that's

447
00:21:24,150 --> 00:21:30,360
interesting and that's what can help us

448
00:21:27,150 --> 00:21:32,970
that's one of the ways to separate

449
00:21:30,360 --> 00:21:35,879
there's a hundred account creations but

450
00:21:32,970 --> 00:21:38,160
only one of them happened on a host that

451
00:21:35,880 --> 00:21:41,220
no one's ever used for account creation

452
00:21:38,160 --> 00:21:44,850
before that would be a really good way

453
00:21:41,220 --> 00:21:47,790
to cut down the noise other examples apt

454
00:21:44,850 --> 00:21:51,449
uses a persistence attack to add a

455
00:21:47,790 --> 00:21:55,350
scheduled tasks scheduled tasks are used

456
00:21:51,450 --> 00:21:58,080
for also for legitimate activities as a

457
00:21:55,350 --> 00:22:00,120
matter of fact 99.9% of scheduled tasks

458
00:21:58,080 --> 00:22:03,120
in your environment are probably benign

459
00:22:00,120 --> 00:22:06,419
and so what are the ways you can cut

460
00:22:03,120 --> 00:22:08,729
through that noise what if it's the

461
00:22:06,420 --> 00:22:11,460
first time anyone's ever scheduled a

462
00:22:08,730 --> 00:22:13,560
task on this host what if it's one

463
00:22:11,460 --> 00:22:16,530
that's unusual to run what if it's

464
00:22:13,560 --> 00:22:19,950
unusual for the organization how about

465
00:22:16,530 --> 00:22:25,260
when an apt downloader created a

466
00:22:19,950 --> 00:22:27,160
connection on fort 1913 and port 81 what

467
00:22:25,260 --> 00:22:29,110
if we don't know the I

468
00:22:27,160 --> 00:22:30,880
see for the IP address' what if we don't

469
00:22:29,110 --> 00:22:34,600
know the bad IP address that it's

470
00:22:30,880 --> 00:22:36,130
connecting to what other way is we can't

471
00:22:34,600 --> 00:22:39,010
create alerts for every connection on

472
00:22:36,130 --> 00:22:41,980
board 81 so what if we're just looking

473
00:22:39,010 --> 00:22:44,020
for machines that just now started to

474
00:22:41,980 --> 00:22:44,620
connect on port 81 when it's never done

475
00:22:44,020 --> 00:22:48,190
that before

476
00:22:44,620 --> 00:22:51,340
or it has but it still abnormal you

477
00:22:48,190 --> 00:22:56,170
follow the the gist here is that one of

478
00:22:51,340 --> 00:23:00,070
the ways it cut down on alerts is to use

479
00:22:56,170 --> 00:23:03,820
behavioral anomalies to help but it's

480
00:23:00,070 --> 00:23:07,020
not the Holy Grail because anomalies are

481
00:23:03,820 --> 00:23:09,520
also normal if that makes sense

482
00:23:07,020 --> 00:23:12,160
people do new things

483
00:23:09,520 --> 00:23:14,320
admins jobs are to be all over the

484
00:23:12,160 --> 00:23:16,830
environment doing new things are new

485
00:23:14,320 --> 00:23:20,679
networks installing new processes

486
00:23:16,830 --> 00:23:23,500
developers spin up apps on brand new IPs

487
00:23:20,680 --> 00:23:25,150
and admins using PowerShell in a way

488
00:23:23,500 --> 00:23:27,670
they never used before because they're

489
00:23:25,150 --> 00:23:31,690
on a new project there are still a

490
00:23:27,670 --> 00:23:34,450
tremendous number of benign reasons that

491
00:23:31,690 --> 00:23:36,850
anomalies occur and honestly that's one

492
00:23:34,450 --> 00:23:39,430
of the reasons why I hear from customers

493
00:23:36,850 --> 00:23:40,060
that they're not happy with most view

494
00:23:39,430 --> 00:23:42,850
bas

495
00:23:40,060 --> 00:23:45,129
because they feel like they just gotten

496
00:23:42,850 --> 00:23:49,810
a bunch of extra alerts dumped on them

497
00:23:45,130 --> 00:23:53,050
instead as an overview instead of

498
00:23:49,810 --> 00:23:54,940
focusing on again IO sees in general

499
00:23:53,050 --> 00:23:55,990
instead of looking for that idea we

500
00:23:54,940 --> 00:23:57,550
could say hey we got an inbound

501
00:23:55,990 --> 00:24:00,550
connection from a country that's

502
00:23:57,550 --> 00:24:03,190
abnormal instead of looking for a

503
00:24:00,550 --> 00:24:05,169
specific subject line we can say this

504
00:24:03,190 --> 00:24:07,390
person got an email from a domain they

505
00:24:05,170 --> 00:24:09,520
don't communicate with when the web

506
00:24:07,390 --> 00:24:11,380
shell was installed we could notice that

507
00:24:09,520 --> 00:24:13,210
this process has never run from this

508
00:24:11,380 --> 00:24:15,820
directory before in the organization

509
00:24:13,210 --> 00:24:17,980
when data was excellent rated we could

510
00:24:15,820 --> 00:24:20,200
have known that that host has never

511
00:24:17,980 --> 00:24:23,760
transmitted that much data to the web

512
00:24:20,200 --> 00:24:26,860
before all of this can be detected

513
00:24:23,760 --> 00:24:29,350
without you writing rules or managing

514
00:24:26,860 --> 00:24:33,520
threat intelligence which is a lot

515
00:24:29,350 --> 00:24:35,889
easier on a sock but again you do not

516
00:24:33,520 --> 00:24:38,889
want an alert when you get an abnormal

517
00:24:35,890 --> 00:24:41,670
inbound connection from a country or

518
00:24:38,890 --> 00:24:46,260
when there's an abnormal amount of data

519
00:24:41,670 --> 00:24:50,670
these happen all of the time the only

520
00:24:46,260 --> 00:24:53,820
time you want to know is when multiple

521
00:24:50,670 --> 00:24:57,110
stages in the kill chain have occurred

522
00:24:53,820 --> 00:25:00,450
this is the premise of this talk is that

523
00:24:57,110 --> 00:25:03,240
when there are multiple stages high

524
00:25:00,450 --> 00:25:06,870
level stages in and kill chain occurring

525
00:25:03,240 --> 00:25:09,240
that is a much higher indicator that

526
00:25:06,870 --> 00:25:12,449
this is a threat

527
00:25:09,240 --> 00:25:14,220
and as an example back into exa beam I'm

528
00:25:12,450 --> 00:25:17,280
showing here that there's a Windows

529
00:25:14,220 --> 00:25:20,550
event that this user performs a remote

530
00:25:17,280 --> 00:25:22,680
log on to a host that they don't

531
00:25:20,550 --> 00:25:24,780
normally communicate with it's the first

532
00:25:22,680 --> 00:25:26,640
time they've logged into that machine

533
00:25:24,780 --> 00:25:27,180
and they're also doing it from the

534
00:25:26,640 --> 00:25:29,250
internet

535
00:25:27,180 --> 00:25:31,350
here just for fun we're showing us from

536
00:25:29,250 --> 00:25:34,440
North Korea it could be from any country

537
00:25:31,350 --> 00:25:36,449
right it's a UVA the North Korea doesn't

538
00:25:34,440 --> 00:25:38,970
matter so we've got some potential

539
00:25:36,450 --> 00:25:41,100
lateral movement here moving it in the

540
00:25:38,970 --> 00:25:44,880
environment then we see the user do a

541
00:25:41,100 --> 00:25:48,209
right click run as and switch to their -

542
00:25:44,880 --> 00:25:51,870
admin account so now we've got that eye

543
00:25:48,210 --> 00:25:54,780
level tactic of privilege escalation and

544
00:25:51,870 --> 00:25:57,000
then we see the account creation again

545
00:25:54,780 --> 00:25:57,600
admins create accounts all the time who

546
00:25:57,000 --> 00:26:01,890
cares

547
00:25:57,600 --> 00:26:03,570
but this user created an account on an

548
00:26:01,890 --> 00:26:05,750
asset where they've never done that

549
00:26:03,570 --> 00:26:09,560
before

550
00:26:05,750 --> 00:26:11,870
none of these are IOC s and none of

551
00:26:09,560 --> 00:26:14,510
these individual anomalies are worth

552
00:26:11,870 --> 00:26:16,939
looking at on their own and because

553
00:26:14,510 --> 00:26:19,340
there's always an unlimited a number of

554
00:26:16,940 --> 00:26:22,400
suspicious events to go through in any

555
00:26:19,340 --> 00:26:25,820
environment we need prioritization we

556
00:26:22,400 --> 00:26:28,610
meet and I'm not talking critical high

557
00:26:25,820 --> 00:26:30,260
medium low because I you're all probably

558
00:26:28,610 --> 00:26:32,629
laughing you already have a hundred

559
00:26:30,260 --> 00:26:36,560
critical alerts a day and so we use a

560
00:26:32,630 --> 00:26:40,130
numerical risk scoring process to add

561
00:26:36,560 --> 00:26:42,500
additional risk to a user and rank them

562
00:26:40,130 --> 00:26:44,750
all on the home screen for you to go

563
00:26:42,500 --> 00:26:46,910
through so this user has a score of two

564
00:26:44,750 --> 00:26:48,950
hundred and forty two and when you drill

565
00:26:46,910 --> 00:26:52,790
in you can see that there were multiple

566
00:26:48,950 --> 00:26:55,370
tactics that were leveraged it's not

567
00:26:52,790 --> 00:26:58,149
about the individual anomalies nothing

568
00:26:55,370 --> 00:27:02,060
on the right-hand side here is an alert

569
00:26:58,150 --> 00:27:04,280
this entire story is an alert that's the

570
00:27:02,060 --> 00:27:05,960
big difference and that's the struggle

571
00:27:04,280 --> 00:27:08,030
that I think we're all going through is

572
00:27:05,960 --> 00:27:10,580
oh someone logged into a new server that

573
00:27:08,030 --> 00:27:11,870
could be lateral movement someone

574
00:27:10,580 --> 00:27:14,120
created an account that could be

575
00:27:11,870 --> 00:27:16,760
persistence yeah but it's probably only

576
00:27:14,120 --> 00:27:19,370
persistence if we have other indicators

577
00:27:16,760 --> 00:27:23,390
that CNC happened after that

578
00:27:19,370 --> 00:27:26,030
that CNC happened after that or if we

579
00:27:23,390 --> 00:27:27,910
had reconnaissance beforehand right

580
00:27:26,030 --> 00:27:31,550
knowing that there's multiple tactics

581
00:27:27,910 --> 00:27:35,180
that really changes the game so we're

582
00:27:31,550 --> 00:27:37,430
moving from you know millions of IOC s

583
00:27:35,180 --> 00:27:42,010
and we're moving to a small number of

584
00:27:37,430 --> 00:27:46,010
TTP's IOC is change minute by minute

585
00:27:42,010 --> 00:27:49,220
TTP's change a lot less and we're moving

586
00:27:46,010 --> 00:27:51,260
away from only using signatures and

587
00:27:49,220 --> 00:27:53,990
correlation rules that we have to write

588
00:27:51,260 --> 00:27:56,150
maintain ourselves to continuing to

589
00:27:53,990 --> 00:28:00,050
write correlation rules for specific

590
00:27:56,150 --> 00:28:01,720
scenarios but using behavior to help us

591
00:28:00,050 --> 00:28:03,399
do this

592
00:28:01,720 --> 00:28:06,640
so here's the problem you're probably

593
00:28:03,400 --> 00:28:13,040
asking okay well how do I go search for

594
00:28:06,640 --> 00:28:16,030
lateral movement in my sim right

595
00:28:13,040 --> 00:28:19,370
- the issue is most sims are filled and

596
00:28:16,030 --> 00:28:22,220
kyun value based hunting on behavior is

597
00:28:19,370 --> 00:28:26,360
very difficult so this is something that

598
00:28:22,220 --> 00:28:31,460
we take a lot of pride in is that in Ex

599
00:28:26,360 --> 00:28:34,879
abeam you can search by activities by

600
00:28:31,460 --> 00:28:38,260
different behavior and so here this rep

601
00:28:34,880 --> 00:28:42,440
hunter is searching for any user who has

602
00:28:38,260 --> 00:28:45,350
performed VPN that day and here we see

603
00:28:42,440 --> 00:28:48,020
there's three point four thousand thirty

604
00:28:45,350 --> 00:28:52,010
four hundred users who have had a VPN

605
00:28:48,020 --> 00:28:55,580
connection but we can also continue to

606
00:28:52,010 --> 00:28:58,820
drill down into other behaviors so now I

607
00:28:55,580 --> 00:29:01,360
can I can filter this down to only users

608
00:28:58,820 --> 00:29:06,169
who have performed the account creation

609
00:29:01,360 --> 00:29:09,020
TTP and we're VPN den during that same

610
00:29:06,170 --> 00:29:11,630
day this is very different most sims

611
00:29:09,020 --> 00:29:14,300
again you're searching for events and

612
00:29:11,630 --> 00:29:16,610
here we're not searching for events

613
00:29:14,300 --> 00:29:20,419
we're searching for sessions we're

614
00:29:16,610 --> 00:29:24,379
searching for at a user's day or a hosts

615
00:29:20,420 --> 00:29:27,880
day that contains this behavior so that

616
00:29:24,380 --> 00:29:30,470
we can again review an entire story

617
00:29:27,880 --> 00:29:33,090
because I don't want to review an event

618
00:29:30,470 --> 00:29:35,970
I want a review

619
00:29:33,090 --> 00:29:39,840
the story of multiple TTP's that's how I

620
00:29:35,970 --> 00:29:43,860
get out of this mess another example so

621
00:29:39,840 --> 00:29:46,408
what are some indicators of data

622
00:29:43,860 --> 00:29:49,860
exfiltration well so let's assume that

623
00:29:46,409 --> 00:29:52,259
even if you're not using the exhibition

624
00:29:49,860 --> 00:29:55,229
let's assume you have rules written that

625
00:29:52,259 --> 00:29:58,220
look for data exfiltration here I've

626
00:29:55,230 --> 00:30:02,009
written a giant or condition looking for

627
00:29:58,220 --> 00:30:04,470
users who have transmitted an abnormal

628
00:30:02,009 --> 00:30:06,600
amount of data from a network zone I've

629
00:30:04,470 --> 00:30:09,299
looked at people who are uploading data

630
00:30:06,600 --> 00:30:12,899
to webmail domains users who have

631
00:30:09,299 --> 00:30:17,190
uploaded data to job search websites who

632
00:30:12,899 --> 00:30:19,590
have written data to USB drives now why

633
00:30:17,190 --> 00:30:25,350
is this more useful than a traditional

634
00:30:19,590 --> 00:30:28,289
sim well again I don't get just the

635
00:30:25,350 --> 00:30:31,049
event back let's say that one of these

636
00:30:28,289 --> 00:30:34,559
is abnormal number of files written to a

637
00:30:31,049 --> 00:30:37,289
usb in a traditional sim you get that

638
00:30:34,559 --> 00:30:39,149
one event and then you have to go and

639
00:30:37,289 --> 00:30:41,610
build the whole story ok what else

640
00:30:39,149 --> 00:30:46,320
happened that day how many other TTP's

641
00:30:41,610 --> 00:30:48,330
were used in X abeam we show you the

642
00:30:46,320 --> 00:30:51,480
number of reasons the number of risk

643
00:30:48,330 --> 00:30:54,119
points that a user has generated during

644
00:30:51,480 --> 00:30:55,919
that same day so instead of just giving

645
00:30:54,119 --> 00:30:59,970
that one event back you get the whole

646
00:30:55,919 --> 00:31:02,789
story and all the TTP's and a numerical

647
00:30:59,970 --> 00:31:05,119
risk score associated with that so this

648
00:31:02,789 --> 00:31:09,740
really helps you get through the noise

649
00:31:05,119 --> 00:31:12,029
by looking for again not just an event

650
00:31:09,740 --> 00:31:12,480
but everything else that happened that

651
00:31:12,029 --> 00:31:15,749
day

652
00:31:12,480 --> 00:31:18,990
another example note an apt behaviors

653
00:31:15,749 --> 00:31:22,320
looking for an encrypted argument and a

654
00:31:18,990 --> 00:31:25,679
PowerShell man right that might be an

655
00:31:22,320 --> 00:31:29,759
indicator but unless there was a number

656
00:31:25,679 --> 00:31:33,059
of other suspicious activity that raised

657
00:31:29,759 --> 00:31:36,990
the risk or I may not be interested

658
00:31:33,059 --> 00:31:40,678
that's what's keeping us from looking at

659
00:31:36,990 --> 00:31:43,590
a hundred encrypted PowerShell commands

660
00:31:40,679 --> 00:31:45,929
we only want to know about the

661
00:31:43,590 --> 00:31:49,019
administrators that did that

662
00:31:45,929 --> 00:31:52,110
and other suspicious activity whether

663
00:31:49,019 --> 00:31:54,899
it's ueb a related it doesn't matter

664
00:31:52,110 --> 00:31:57,689
could be a Palo Alto Alert could be a

665
00:31:54,899 --> 00:31:59,908
proof point email alert could be a crown

666
00:31:57,690 --> 00:32:01,409
strike alert it could be a correlation

667
00:31:59,909 --> 00:32:03,269
rule you wrote yourself

668
00:32:01,409 --> 00:32:05,100
it could be threat intelligence you've

669
00:32:03,269 --> 00:32:08,730
integrated it could be a custom

670
00:32:05,100 --> 00:32:11,850
correlation rule you have all of this in

671
00:32:08,730 --> 00:32:16,159
your sim for a reason all of that should

672
00:32:11,850 --> 00:32:19,379
be contributing to this investigation

673
00:32:16,159 --> 00:32:21,149
the problem is is that that's a tough

674
00:32:19,379 --> 00:32:24,480
story to put together and you're usually

675
00:32:21,149 --> 00:32:29,129
doing that on your own in summary here

676
00:32:24,480 --> 00:32:30,570
the minor attack framework is really one

677
00:32:29,129 --> 00:32:33,959
of the attack brain works that's taking

678
00:32:30,570 --> 00:32:37,499
off in popularity we are one of the

679
00:32:33,960 --> 00:32:38,820
contributors to that team we work hand

680
00:32:37,499 --> 00:32:41,039
in hand with them where a small

681
00:32:38,820 --> 00:32:43,649
contributor but we believe in what

682
00:32:41,039 --> 00:32:47,820
they're doing this company is full of X

683
00:32:43,649 --> 00:32:49,408
sock and sim admins who are working with

684
00:32:47,820 --> 00:32:52,379
customers still struggling with this

685
00:32:49,409 --> 00:32:55,470
process we believe that this is how you

686
00:32:52,379 --> 00:32:58,678
get to signal from the noise let's get

687
00:32:55,470 --> 00:33:03,289
out of chasing every single potentially

688
00:32:58,679 --> 00:33:07,320
bad connection to IPs and hashes and

689
00:33:03,289 --> 00:33:10,470
start detecting attackers at all stages

690
00:33:07,320 --> 00:33:14,309
in an attack and only when we see

691
00:33:10,470 --> 00:33:16,970
multiple indicators do we know that this

692
00:33:14,309 --> 00:33:20,879
is actually worth a human's time and

693
00:33:16,970 --> 00:33:24,119
maybe then we can get customers to like

694
00:33:20,879 --> 00:33:26,549
their sim and enjoy red hunting I'm not

695
00:33:24,119 --> 00:33:29,309
used to talking for that long without

696
00:33:26,549 --> 00:33:31,320
anybody interrupting me so I hope I took

697
00:33:29,309 --> 00:33:35,399
enough breaths in there and left time

698
00:33:31,320 --> 00:33:37,860
for questions I'd love to answer any

699
00:33:35,399 --> 00:33:39,899
questions that you have thank you what's

700
00:33:37,860 --> 00:33:42,330
the tuning experience like when trying

701
00:33:39,899 --> 00:33:44,580
to tune a ue be a solution same

702
00:33:42,330 --> 00:33:48,509
different than say traditional theme

703
00:33:44,580 --> 00:33:51,119
alerts it is different so ideally a UE

704
00:33:48,509 --> 00:33:53,610
be a solution should be machine learning

705
00:33:51,119 --> 00:33:56,459
based which means that let's take the

706
00:33:53,610 --> 00:33:58,879
brute force example so let's say you're

707
00:33:56,460 --> 00:34:01,430
trying to write a rule where

708
00:33:58,880 --> 00:34:04,100
you're detecting users trying to break

709
00:34:01,430 --> 00:34:06,560
into an account and you've written a

710
00:34:04,100 --> 00:34:08,710
rule that says nobody should fail to log

711
00:34:06,560 --> 00:34:12,590
in more than 30 times in five minutes

712
00:34:08,710 --> 00:34:16,100
then you find out that that rule blows

713
00:34:12,590 --> 00:34:17,960
up because you have admins who run

714
00:34:16,100 --> 00:34:19,940
scripts that fail to log into more

715
00:34:17,960 --> 00:34:21,918
servers that all the time now you're in

716
00:34:19,940 --> 00:34:24,290
a tuning mode okay I have to change the

717
00:34:21,918 --> 00:34:25,850
rule either I have to up the threshold

718
00:34:24,290 --> 00:34:28,820
or make different rules for different

719
00:34:25,850 --> 00:34:32,360
people and that's something you have to

720
00:34:28,820 --> 00:34:35,899
do manually in a ueb a the machine

721
00:34:32,360 --> 00:34:37,790
should learn that your admin fails to

722
00:34:35,899 --> 00:34:41,750
log in a hundred times a day all the

723
00:34:37,790 --> 00:34:43,790
time and that someone in finance only

724
00:34:41,750 --> 00:34:46,699
does it three times if their behavior

725
00:34:43,790 --> 00:34:50,719
changes the rules should change with

726
00:34:46,699 --> 00:34:53,870
them and so there are some times when

727
00:34:50,719 --> 00:34:56,658
users dramatically change the roles or

728
00:34:53,870 --> 00:34:59,779
good do special projects where their

729
00:34:56,659 --> 00:35:02,090
behavior goes off the rails and you do

730
00:34:59,780 --> 00:35:04,090
need to do manual intervention there are

731
00:35:02,090 --> 00:35:07,580
no sims there with no tuning required

732
00:35:04,090 --> 00:35:09,800
but it should be substantially less

733
00:35:07,580 --> 00:35:12,290
because the machine learning should be

734
00:35:09,800 --> 00:35:14,570
there to help us build those rules and

735
00:35:12,290 --> 00:35:16,880
models on our way what would be a TTP to

736
00:35:14,570 --> 00:35:19,820
accomplish this type of learning when

737
00:35:16,880 --> 00:35:22,520
you don't have an exhibition without

738
00:35:19,820 --> 00:35:25,700
exiting what I would do is I would write

739
00:35:22,520 --> 00:35:30,610
my own correlation rules that map to

740
00:35:25,700 --> 00:35:34,430
these TTP so let's say if we go back to

741
00:35:30,610 --> 00:35:37,430
one of these slides that showed the

742
00:35:34,430 --> 00:35:39,290
different TTP's that are available so

743
00:35:37,430 --> 00:35:42,379
what I would do is label rules let's say

744
00:35:39,290 --> 00:35:45,560
that you have a lateral movement rule so

745
00:35:42,380 --> 00:35:47,450
you looked at someone who or let's use

746
00:35:45,560 --> 00:35:49,220
them exfiltration so you looked at

747
00:35:47,450 --> 00:35:52,399
someone who's compressing too much data

748
00:35:49,220 --> 00:35:55,669
but what I would do is if your sim

749
00:35:52,400 --> 00:35:57,460
allows you to categorize or label the

750
00:35:55,670 --> 00:36:00,140
rule with some type of categorization

751
00:35:57,460 --> 00:36:03,350
you can do some of this mapping yourself

752
00:36:00,140 --> 00:36:05,390
so this is you can start tagging your

753
00:36:03,350 --> 00:36:07,220
own rules with this is part of

754
00:36:05,390 --> 00:36:10,250
exfiltration

755
00:36:07,220 --> 00:36:12,770
and then you could write another level

756
00:36:10,250 --> 00:36:15,680
of correlation beyond that if you have

757
00:36:12,770 --> 00:36:18,050
ten rules written for these different

758
00:36:15,680 --> 00:36:20,690
stages you could be writing a

759
00:36:18,050 --> 00:36:23,450
correlation rule that looks for more

760
00:36:20,690 --> 00:36:24,770
than two in 24 hours for more than three

761
00:36:23,450 --> 00:36:27,470
in 48 hours

762
00:36:24,770 --> 00:36:30,200
so trying to build these nested

763
00:36:27,470 --> 00:36:31,609
detection layers it's a it's a lot of

764
00:36:30,200 --> 00:36:33,589
effort but that that is something you

765
00:36:31,609 --> 00:36:35,090
can do if you have the manpower how do

766
00:36:33,590 --> 00:36:37,160
you come it's leadership that ingesting

767
00:36:35,090 --> 00:36:40,010
tons of data to find the needles is a

768
00:36:37,160 --> 00:36:43,040
legitimate expenditure ooh tough one

769
00:36:40,010 --> 00:36:45,890
especially when most sims are billing

770
00:36:43,040 --> 00:36:48,470
you by the amount of data that you are

771
00:36:45,890 --> 00:36:51,020
ingesting as a sales engineer I feel

772
00:36:48,470 --> 00:36:53,118
that pain on a constant basis my whole

773
00:36:51,020 --> 00:36:55,400
job is to write justifications for

774
00:36:53,119 --> 00:37:00,020
projects and explain the technical to

775
00:36:55,400 --> 00:37:02,630
business leaders and what I do is I

776
00:37:00,020 --> 00:37:04,790
would recommend mapping if I bring in

777
00:37:02,630 --> 00:37:08,180
this log source these are the use cases

778
00:37:04,790 --> 00:37:10,490
that I expect to be able to achieve this

779
00:37:08,180 --> 00:37:12,680
is the detection that I'm going to gain

780
00:37:10,490 --> 00:37:14,959
these are the gaps that I'm going to

781
00:37:12,680 --> 00:37:17,598
cover these are the risks that I'm gonna

782
00:37:14,960 --> 00:37:18,470
be able to mitigate to the business

783
00:37:17,599 --> 00:37:21,140
because that's where they're thinking

784
00:37:18,470 --> 00:37:23,810
they're way over here and if you're just

785
00:37:21,140 --> 00:37:27,410
talking about I want to bring in office

786
00:37:23,810 --> 00:37:30,770
365 log so we're gonna add 200k to my

787
00:37:27,410 --> 00:37:33,410
Splunk subscription that's you know

788
00:37:30,770 --> 00:37:36,770
that's over their heads and so building

789
00:37:33,410 --> 00:37:39,770
a table of justification of log source

790
00:37:36,770 --> 00:37:41,690
to use case to risk mitigation that's

791
00:37:39,770 --> 00:37:43,280
that that's the best way and it might

792
00:37:41,690 --> 00:37:44,690
actually help you a lot I have customers

793
00:37:43,280 --> 00:37:46,730
sometimes who think they want to bring

794
00:37:44,690 --> 00:37:48,589
in a log and then they realize it only

795
00:37:46,730 --> 00:37:50,930
had one use case for it and so we

796
00:37:48,589 --> 00:37:52,820
scrapped it John I think that's it's

797
00:37:50,930 --> 00:37:55,009
unless you have any final words actually

798
00:37:52,820 --> 00:37:57,650
what are your final words my final words

799
00:37:55,010 --> 00:38:00,500
are really appreciate the opportunity to

800
00:37:57,650 --> 00:38:03,020
come here and speak love talking about

801
00:38:00,500 --> 00:38:05,300
threat hunting I'm super excited where

802
00:38:03,020 --> 00:38:06,950
the industry is going really excited

803
00:38:05,300 --> 00:38:09,830
about where minor attack framework can

804
00:38:06,950 --> 00:38:12,049
help us so looking forward to seeing

805
00:38:09,830 --> 00:38:13,609
everybody next year and at the next

806
00:38:12,050 --> 00:38:15,820
event talk about where we've gone from

807
00:38:13,609 --> 00:38:15,819
here

