1
00:00:01,280 --> 00:00:04,880
so jake i haven't talked to you in a

2
00:00:03,040 --> 00:00:07,680
couple of hours how are you doing

3
00:00:04,880 --> 00:00:08,719
oh outstanding my friend hey um look uh

4
00:00:07,680 --> 00:00:10,719
mad props man

5
00:00:08,720 --> 00:00:12,320
uh you know again i i told your staff

6
00:00:10,719 --> 00:00:13,759
this when i was in the green room but uh

7
00:00:12,320 --> 00:00:14,320
i understand the difficulty the decision

8
00:00:13,759 --> 00:00:16,560
you made

9
00:00:14,320 --> 00:00:17,680
remove the conference virtual you're

10
00:00:16,560 --> 00:00:18,479
obviously a thought leader in the

11
00:00:17,680 --> 00:00:20,320
industry

12
00:00:18,480 --> 00:00:21,600
you jump before others did and for the

13
00:00:20,320 --> 00:00:23,840
public good and

14
00:00:21,600 --> 00:00:24,960
hats off to you man i just cannot praise

15
00:00:23,840 --> 00:00:26,960
you enough for that

16
00:00:24,960 --> 00:00:28,240
thank you so much all right well i'm

17
00:00:26,960 --> 00:00:29,039
going to get out of here before i turn

18
00:00:28,240 --> 00:00:31,439
to red

19
00:00:29,039 --> 00:00:32,399
blushing with that jake please why don't

20
00:00:31,439 --> 00:00:35,280
you kick it off

21
00:00:32,399 --> 00:00:36,559
and let's close it out yeah rock on man

22
00:00:35,280 --> 00:00:38,800
this is great

23
00:00:36,559 --> 00:00:40,480
my name is jake williams uh i think most

24
00:00:38,800 --> 00:00:40,959
of you probably know me for those that

25
00:00:40,480 --> 00:00:42,398
don't

26
00:00:40,960 --> 00:00:44,879
i'll quickly uh quickly walk through

27
00:00:42,399 --> 00:00:46,559
here uh this is uh what my third wild

28
00:00:44,879 --> 00:00:47,839
bus hack fest i managed to somehow miss

29
00:00:46,559 --> 00:00:49,760
the first one because

30
00:00:47,840 --> 00:00:51,760
i don't remember what prior commitment

31
00:00:49,760 --> 00:00:53,760
something along those lines but uh

32
00:00:51,760 --> 00:00:54,640
super thrilled to be here and super

33
00:00:53,760 --> 00:00:55,839
thrilled to be closing out the

34
00:00:54,640 --> 00:00:59,039
conference right so

35
00:00:55,840 --> 00:01:01,840
um this talk is actually the third in a

36
00:00:59,039 --> 00:01:03,120
uh basically the third in a trilogy of

37
00:01:01,840 --> 00:01:03,760
talks that i've given at wild west

38
00:01:03,120 --> 00:01:05,600
hackfest

39
00:01:03,760 --> 00:01:06,880
first one was all about privilege

40
00:01:05,600 --> 00:01:09,439
escalation on linux

41
00:01:06,880 --> 00:01:10,960
that was deadwood was at deadwood 2018

42
00:01:09,439 --> 00:01:12,720
deadwood 2019.

43
00:01:10,960 --> 00:01:14,399
we had a chance to uh to run through

44
00:01:12,720 --> 00:01:16,640
privilege escalation on windows

45
00:01:14,400 --> 00:01:18,400
and uh now we're doing hunting software

46
00:01:16,640 --> 00:01:20,080
vulnerabilities without reversing in

47
00:01:18,400 --> 00:01:21,119
fact you know titled this talk before i

48
00:01:20,080 --> 00:01:24,000
even left deadwood

49
00:01:21,119 --> 00:01:24,799
last year and uh just i'm so thrilled to

50
00:01:24,000 --> 00:01:26,479
be here and

51
00:01:24,799 --> 00:01:28,320
thank everybody for uh for attending

52
00:01:26,479 --> 00:01:29,759
here i'm super super

53
00:01:28,320 --> 00:01:31,758
super super excited to get through this

54
00:01:29,759 --> 00:01:32,720
so that said let's get let's get rocking

55
00:01:31,759 --> 00:01:33,920
here so who am i

56
00:01:32,720 --> 00:01:35,200
uh for those that don't know me i'm the

57
00:01:33,920 --> 00:01:36,960
founder and president of rendition

58
00:01:35,200 --> 00:01:37,840
infosacc i work with a little company

59
00:01:36,960 --> 00:01:40,079
called ions

60
00:01:37,840 --> 00:01:41,680
on faculty over there former sands

61
00:01:40,079 --> 00:01:43,360
instructor i work a little with sand

62
00:01:41,680 --> 00:01:43,759
still but no longer on the instruction

63
00:01:43,360 --> 00:01:45,360
side

64
00:01:43,759 --> 00:01:46,479
formerly endorsed by the shadow brokers

65
00:01:45,360 --> 00:01:47,840
all right if you don't know about that

66
00:01:46,479 --> 00:01:49,840
just google my name with the shadow

67
00:01:47,840 --> 00:01:51,759
brokers and you will see the

68
00:01:49,840 --> 00:01:53,600
rumble grumble but as a result of that i

69
00:01:51,759 --> 00:01:54,240
can now confirm that i used to be an nsa

70
00:01:53,600 --> 00:01:56,960
hacker

71
00:01:54,240 --> 00:01:58,560
a master cna operator and all that stuff

72
00:01:56,960 --> 00:01:59,759
i dislike folks who call themselves

73
00:01:58,560 --> 00:02:01,520
thought leaders right uh

74
00:01:59,759 --> 00:02:03,200
you know i know i just called john one

75
00:02:01,520 --> 00:02:05,360
and that's not a knock on john

76
00:02:03,200 --> 00:02:06,799
what that is is a basically a

77
00:02:05,360 --> 00:02:08,080
recognition that if

78
00:02:06,799 --> 00:02:09,759
you are calling yourself a thought

79
00:02:08,080 --> 00:02:10,879
leader you're not and if someone else is

80
00:02:09,758 --> 00:02:12,720
calling you a thought leader

81
00:02:10,878 --> 00:02:14,160
you probably are right that that kind of

82
00:02:12,720 --> 00:02:14,959
thing right and then of course

83
00:02:14,160 --> 00:02:17,200
blockchain

84
00:02:14,959 --> 00:02:18,160
freaking blockchain right thankfully

85
00:02:17,200 --> 00:02:19,280
we're nearing the end of that

86
00:02:18,160 --> 00:02:21,200
ridiculousness

87
00:02:19,280 --> 00:02:22,480
but uh or i feel like we're nearing the

88
00:02:21,200 --> 00:02:23,280
end of that it's spun down a little bit

89
00:02:22,480 --> 00:02:24,799
but alas

90
00:02:23,280 --> 00:02:26,800
lots of folks needlessly adding that

91
00:02:24,800 --> 00:02:28,480
distributed ledger technology and smart

92
00:02:26,800 --> 00:02:30,400
grid and the whole you name it

93
00:02:28,480 --> 00:02:31,840
all the places it doesn't need to be

94
00:02:30,400 --> 00:02:33,360
right so

95
00:02:31,840 --> 00:02:35,200
before we get to go in here a little bit

96
00:02:33,360 --> 00:02:36,160
of an agenda bug hunting right you can

97
00:02:35,200 --> 00:02:38,000
do it too

98
00:02:36,160 --> 00:02:39,440
that's really the purpose of this talk

99
00:02:38,000 --> 00:02:41,360
right in fact you know john mentioned

100
00:02:39,440 --> 00:02:43,280
haven't talked in a couple hours

101
00:02:41,360 --> 00:02:45,040
tongue-in-cheek obviously before i came

102
00:02:43,280 --> 00:02:46,720
to give this talk it's john's conference

103
00:02:45,040 --> 00:02:48,480
great respect for john i wanted to make

104
00:02:46,720 --> 00:02:49,920
sure obviously that i wasn't dropping

105
00:02:48,480 --> 00:02:50,399
anything here that he was uncomfortable

106
00:02:49,920 --> 00:02:52,319
with

107
00:02:50,400 --> 00:02:54,080
we will go through a couple of o days

108
00:02:52,319 --> 00:02:55,440
that the vendor has not patched uh one

109
00:02:54,080 --> 00:02:56,400
of which the vendor is arguing with me

110
00:02:55,440 --> 00:02:58,560
about which is

111
00:02:56,400 --> 00:02:59,840
not a not not a good move i think but

112
00:02:58,560 --> 00:03:01,120
anyway alas

113
00:02:59,840 --> 00:03:02,400
uh you know wanted to make sure it was

114
00:03:01,120 --> 00:03:03,840
cool one of the things that came out of

115
00:03:02,400 --> 00:03:05,280
it was like well how much work did you

116
00:03:03,840 --> 00:03:07,120
need to put into to get this

117
00:03:05,280 --> 00:03:09,280
question john asked very responsibly by

118
00:03:07,120 --> 00:03:11,280
the way and said literally uh

119
00:03:09,280 --> 00:03:13,040
about five minutes for one of them no

120
00:03:11,280 --> 00:03:14,239
special tooling as it turns out right

121
00:03:13,040 --> 00:03:15,120
and so that was pretty much the point

122
00:03:14,239 --> 00:03:17,599
we're like oh yeah

123
00:03:15,120 --> 00:03:18,720
done it's just a go right so bug hunting

124
00:03:17,599 --> 00:03:20,480
you can do it too whether you have

125
00:03:18,720 --> 00:03:21,760
binary exploitation skills or not that's

126
00:03:20,480 --> 00:03:22,319
kind of the purpose of the talk here

127
00:03:21,760 --> 00:03:23,840
right

128
00:03:22,319 --> 00:03:25,518
then i have the why me right wouldn't

129
00:03:23,840 --> 00:03:27,840
there already be a cve all right

130
00:03:25,519 --> 00:03:29,040
by the way number of cds this guy has

131
00:03:27,840 --> 00:03:31,280
big goose egg right

132
00:03:29,040 --> 00:03:32,640
i i've lost count of the vulnerabilities

133
00:03:31,280 --> 00:03:33,519
but we'll say it's it's multiples of

134
00:03:32,640 --> 00:03:35,359
triple digits

135
00:03:33,519 --> 00:03:37,360
i've never submitted for a cve don't

136
00:03:35,360 --> 00:03:39,599
care to you know most of it's in

137
00:03:37,360 --> 00:03:40,879
uh most of us for client work anyway and

138
00:03:39,599 --> 00:03:42,238
all that good stuff right

139
00:03:40,879 --> 00:03:43,840
let's walk through some of the tools the

140
00:03:42,239 --> 00:03:45,040
trade what you're supposed to be looking

141
00:03:43,840 --> 00:03:46,400
for

142
00:03:45,040 --> 00:03:48,079
and then we'll get to the fun part case

143
00:03:46,400 --> 00:03:49,120
studies show this stuff works and then

144
00:03:48,080 --> 00:03:50,400
wrap it up

145
00:03:49,120 --> 00:03:52,560
now look i want to give a quick note

146
00:03:50,400 --> 00:03:54,480
here right none of the techniques in

147
00:03:52,560 --> 00:03:57,200
this presentation are original

148
00:03:54,480 --> 00:03:58,238
i am standing on the shoulders of giants

149
00:03:57,200 --> 00:03:59,760
getting in here and giving this

150
00:03:58,239 --> 00:04:02,239
presentation i've said this in

151
00:03:59,760 --> 00:04:03,920
all three now of my while was hackfest

152
00:04:02,239 --> 00:04:06,640
talks again standing on the shoulder

153
00:04:03,920 --> 00:04:07,599
shoulders of giants here as everybody

154
00:04:06,640 --> 00:04:09,839
that's presented

155
00:04:07,599 --> 00:04:11,679
today has i mean unless you're like the

156
00:04:09,840 --> 00:04:12,319
guy who built the internet or grace

157
00:04:11,680 --> 00:04:14,319
hopper

158
00:04:12,319 --> 00:04:15,920
you are very likely standing on the

159
00:04:14,319 --> 00:04:17,440
shoulders of giants as well

160
00:04:15,920 --> 00:04:18,719
i'll tell you here the vulnerabilities

161
00:04:17,440 --> 00:04:19,120
that we're going to disclose obviously

162
00:04:18,720 --> 00:04:21,120
are new

163
00:04:19,120 --> 00:04:22,880
the techniques are not right and the

164
00:04:21,120 --> 00:04:24,880
fact that the vulnerabilities are new

165
00:04:22,880 --> 00:04:26,320
tells me that people by and large aren't

166
00:04:24,880 --> 00:04:28,560
using these techniques

167
00:04:26,320 --> 00:04:30,080
hence the reason for the talk right but

168
00:04:28,560 --> 00:04:31,759
i also know i've got a lot of haters out

169
00:04:30,080 --> 00:04:32,639
there i throw this in here for two

170
00:04:31,759 --> 00:04:34,800
reasons one

171
00:04:32,639 --> 00:04:36,240
to give credit where credit's due tons

172
00:04:34,800 --> 00:04:37,919
of people have researched stuff like

173
00:04:36,240 --> 00:04:38,720
this come up with great techniques right

174
00:04:37,919 --> 00:04:40,320
invented

175
00:04:38,720 --> 00:04:41,520
stuff like the race condition or as i

176
00:04:40,320 --> 00:04:42,240
like to call the dale earnhardt

177
00:04:41,520 --> 00:04:43,280
condition

178
00:04:42,240 --> 00:04:45,600
right because i'm from backwoods

179
00:04:43,280 --> 00:04:47,119
virginia and go dale right i i do want

180
00:04:45,600 --> 00:04:48,560
to walk through though you know how we

181
00:04:47,120 --> 00:04:49,919
kind of change stuff together

182
00:04:48,560 --> 00:04:52,320
but i do want to throw a thank you and a

183
00:04:49,919 --> 00:04:52,719
shout out to the people way smarter than

184
00:04:52,320 --> 00:04:54,240
me

185
00:04:52,720 --> 00:04:56,240
the folks that came before me the folks

186
00:04:54,240 --> 00:04:57,360
that paved the way for this for this

187
00:04:56,240 --> 00:04:59,520
talk

188
00:04:57,360 --> 00:05:01,520
so talk about bug hunting you too can do

189
00:04:59,520 --> 00:05:03,280
bug hunting right it is it is not that

190
00:05:01,520 --> 00:05:05,198
uh not that hard and we start getting

191
00:05:03,280 --> 00:05:07,198
into looking for vulnerabilities

192
00:05:05,199 --> 00:05:08,400
look we're talking about not necessarily

193
00:05:07,199 --> 00:05:09,120
the kind of stuff that you'll find in

194
00:05:08,400 --> 00:05:10,400
metasploit

195
00:05:09,120 --> 00:05:12,400
it's already a metasploit right you

196
00:05:10,400 --> 00:05:14,479
don't need to go hunt that right this is

197
00:05:12,400 --> 00:05:15,599
the stuff that separates your custom uh

198
00:05:14,479 --> 00:05:17,680
you know vulnerabilities

199
00:05:15,600 --> 00:05:19,680
stuff separates the joes from the pros

200
00:05:17,680 --> 00:05:20,240
or the pros from the joe's or the jodies

201
00:05:19,680 --> 00:05:21,440
whoever

202
00:05:20,240 --> 00:05:22,880
um we're not looking for buffer

203
00:05:21,440 --> 00:05:24,960
overflows we're not looking for use

204
00:05:22,880 --> 00:05:26,719
after freeze we're not looking for

205
00:05:24,960 --> 00:05:28,479
that level of stuff and i'm not

206
00:05:26,720 --> 00:05:29,520
necessarily saying that these are

207
00:05:28,479 --> 00:05:31,520
somehow

208
00:05:29,520 --> 00:05:33,520
lesser vulnerabilities because it's not

209
00:05:31,520 --> 00:05:34,880
a sexy use after free

210
00:05:33,520 --> 00:05:36,880
that's not at all what i want you to

211
00:05:34,880 --> 00:05:38,639
take away from this statement we don't

212
00:05:36,880 --> 00:05:40,159
need to use fuzzing and binary

213
00:05:38,639 --> 00:05:40,800
techniques that's what i want you to

214
00:05:40,160 --> 00:05:42,240
take away

215
00:05:40,800 --> 00:05:44,000
i want you to take away here is that

216
00:05:42,240 --> 00:05:46,080
this is something you need

217
00:05:44,000 --> 00:05:47,039
zero assembly for and honestly let me go

218
00:05:46,080 --> 00:05:48,639
ahead and tell you that

219
00:05:47,039 --> 00:05:50,400
i'm gonna show you one remote code

220
00:05:48,639 --> 00:05:51,199
execution vulnerability with system

221
00:05:50,400 --> 00:05:52,960
privileges

222
00:05:51,199 --> 00:05:54,960
or administrative privileges it's unique

223
00:05:52,960 --> 00:05:55,919
but there's no separation religion admin

224
00:05:54,960 --> 00:05:57,680
system anyway

225
00:05:55,919 --> 00:05:59,680
and walk you through one of these before

226
00:05:57,680 --> 00:06:01,440
we're all done i'll tell you that if you

227
00:05:59,680 --> 00:06:02,319
pointed me to use after free in a buffer

228
00:06:01,440 --> 00:06:04,319
overflow and

229
00:06:02,319 --> 00:06:05,680
that i would use the vulnerability i

230
00:06:04,319 --> 00:06:06,800
found instead of any of those

231
00:06:05,680 --> 00:06:09,360
although i'm going to tell you those are

232
00:06:06,800 --> 00:06:10,960
way sexier mine's 100 reliable and will

233
00:06:09,360 --> 00:06:12,160
not crash the uh we'll absolutely not

234
00:06:10,960 --> 00:06:14,719
crash the application

235
00:06:12,160 --> 00:06:15,280
right so you don't need to use those

236
00:06:14,720 --> 00:06:16,960
techniques

237
00:06:15,280 --> 00:06:19,119
that's the takeaway here right usually

238
00:06:16,960 --> 00:06:21,758
we're hunting for logic flaws

239
00:06:19,120 --> 00:06:22,319
of paths bad permissions by the way hit

240
00:06:21,759 --> 00:06:25,280
the uh

241
00:06:22,319 --> 00:06:27,120
was hack fest talk from deadwood last

242
00:06:25,280 --> 00:06:28,799
year we cover a lot of unquoted path

243
00:06:27,120 --> 00:06:30,639
issues and bad permission issues

244
00:06:28,800 --> 00:06:32,560
now we're getting those bad programming

245
00:06:30,639 --> 00:06:34,560
issues to kind of wrap up the trilogy

246
00:06:32,560 --> 00:06:36,400
so why me why do you have to go hunt

247
00:06:34,560 --> 00:06:38,560
this stuff uh you're a pen tester you're

248
00:06:36,400 --> 00:06:40,159
a blue team or purple team or red teamer

249
00:06:38,560 --> 00:06:42,000
i don't care what color i hopefully got

250
00:06:40,160 --> 00:06:43,120
a brown team right whatever that means

251
00:06:42,000 --> 00:06:44,240
today but alas

252
00:06:43,120 --> 00:06:47,039
if it's vulnerable wouldn't there

253
00:06:44,240 --> 00:06:49,919
already be a cve and the answer is meh

254
00:06:47,039 --> 00:06:51,680
no in point of fact no absolutely not we

255
00:06:49,919 --> 00:06:54,080
find vulnerabilities all the time

256
00:06:51,680 --> 00:06:55,840
that don't have cves that we hope nobody

257
00:06:54,080 --> 00:06:56,960
else has found we tend to you know

258
00:06:55,840 --> 00:06:58,719
notify vendors

259
00:06:56,960 --> 00:07:00,719
but i'll tell you that not only does not

260
00:06:58,720 --> 00:07:02,960
every volume discover get a cve

261
00:07:00,720 --> 00:07:04,240
but if you work consulting at all like i

262
00:07:02,960 --> 00:07:06,638
do like john does

263
00:07:04,240 --> 00:07:08,400
um you run into some really sketchy

264
00:07:06,639 --> 00:07:09,520
software out there sketchy third-party

265
00:07:08,400 --> 00:07:11,039
software and typically

266
00:07:09,520 --> 00:07:12,719
when we get down to the root cause of

267
00:07:11,039 --> 00:07:14,000
you know for instance when you ask why

268
00:07:12,720 --> 00:07:16,240
are you using this instead of for

269
00:07:14,000 --> 00:07:19,520
instance i don't know smss or

270
00:07:16,240 --> 00:07:20,800
titanium or insert vendor here right and

271
00:07:19,520 --> 00:07:22,639
i'm not saying that all those are

272
00:07:20,800 --> 00:07:24,960
great i'm just going to go ahead and say

273
00:07:22,639 --> 00:07:26,000
that they are potentially safer what

274
00:07:24,960 --> 00:07:27,840
let's go with that all right

275
00:07:26,000 --> 00:07:29,440
somebody's audited the code i don't have

276
00:07:27,840 --> 00:07:30,080
any problem with you using third-party

277
00:07:29,440 --> 00:07:32,160
code that's

278
00:07:30,080 --> 00:07:33,599
maybe low density but for goodness sakes

279
00:07:32,160 --> 00:07:34,960
right if they've got better licensing

280
00:07:33,599 --> 00:07:36,639
more flexible models

281
00:07:34,960 --> 00:07:38,318
you just like how it looks you like how

282
00:07:36,639 --> 00:07:39,199
it works like the color scheme better

283
00:07:38,319 --> 00:07:42,400
rock on

284
00:07:39,199 --> 00:07:43,360
but do an audit for security because at

285
00:07:42,400 --> 00:07:44,799
the end of the day

286
00:07:43,360 --> 00:07:46,800
when you get the sketchy third-party

287
00:07:44,800 --> 00:07:48,479
software by bubba the ceo's cousin

288
00:07:46,800 --> 00:07:50,319
and i so wish i was making that up the

289
00:07:48,479 --> 00:07:51,840
guy's name was not bubba but he was the

290
00:07:50,319 --> 00:07:53,280
chief ops officer's cousin

291
00:07:51,840 --> 00:07:55,198
and it literally gave us keys to the

292
00:07:53,280 --> 00:07:57,039
kingdom across the enterprise listen in

293
00:07:55,199 --> 00:07:58,160
reality neither bubba nor his cousin not

294
00:07:57,039 --> 00:08:00,719
a code securely

295
00:07:58,160 --> 00:08:01,680
or evaluate programs for vulnerabilities

296
00:08:00,720 --> 00:08:03,280
and

297
00:08:01,680 --> 00:08:05,680
we don't care whether or not you know

298
00:08:03,280 --> 00:08:08,400
the solar security by obscurity thing is

299
00:08:05,680 --> 00:08:08,720
is absolute madness we know that doesn't

300
00:08:08,400 --> 00:08:10,799
work

301
00:08:08,720 --> 00:08:12,319
we absolutely know it doesn't work so we

302
00:08:10,800 --> 00:08:13,680
don't want bubba or his cousin

303
00:08:12,319 --> 00:08:15,360
doing the uh doing the code or her

304
00:08:13,680 --> 00:08:16,800
cousin whoever um it's not going to

305
00:08:15,360 --> 00:08:18,240
change the risk but nobody's done a

306
00:08:16,800 --> 00:08:20,080
security evaluation on it

307
00:08:18,240 --> 00:08:21,840
well it doesn't change the outcome maybe

308
00:08:20,080 --> 00:08:23,120
it changes the risk i guess but

309
00:08:21,840 --> 00:08:24,560
if you're counting on security through

310
00:08:23,120 --> 00:08:25,840
obscurity to save you this talk and

311
00:08:24,560 --> 00:08:26,479
honestly the whole conference the

312
00:08:25,840 --> 00:08:28,080
industry

313
00:08:26,479 --> 00:08:29,919
if i'm going to get down to it not for

314
00:08:28,080 --> 00:08:31,440
you go go somewhere else

315
00:08:29,919 --> 00:08:32,958
so let's talk about tools of the trade

316
00:08:31,440 --> 00:08:34,000
and i've got a few of these right off

317
00:08:32,958 --> 00:08:35,760
the bat that i use

318
00:08:34,000 --> 00:08:37,679
and i'm going to cover a few of these i

319
00:08:35,760 --> 00:08:38,799
don't have time unfortunately to cover

320
00:08:37,679 --> 00:08:40,478
all of these

321
00:08:38,799 --> 00:08:42,000
i'm just going to cover my my biggest

322
00:08:40,479 --> 00:08:43,599
hits the things that i use the most

323
00:08:42,000 --> 00:08:45,680
but you'll notice here there's some

324
00:08:43,599 --> 00:08:47,920
pretty like

325
00:08:45,680 --> 00:08:48,800
stupid easy tools to use down here

326
00:08:47,920 --> 00:08:52,319
things like

327
00:08:48,800 --> 00:08:54,079
strings and sqlite database viewer and

328
00:08:52,320 --> 00:08:56,080
and i'm not saying here that you know i

329
00:08:54,080 --> 00:08:57,680
mean we're a little bit past the level

330
00:08:56,080 --> 00:08:59,040
where i'm like oh yeah i can comfortably

331
00:08:57,680 --> 00:08:59,920
teach my parents to do this this

332
00:08:59,040 --> 00:09:01,760
afternoon

333
00:08:59,920 --> 00:09:03,279
we're past we're a little bit past that

334
00:09:01,760 --> 00:09:06,480
but we're certainly not in the

335
00:09:03,279 --> 00:09:08,080
hey i need a fuzzing rig and uh you know

336
00:09:06,480 --> 00:09:09,920
basically a a degree

337
00:09:08,080 --> 00:09:11,839
in computer science and i need to be

338
00:09:09,920 --> 00:09:13,120
able to reassemble you know you know

339
00:09:11,839 --> 00:09:14,560
what forget that i need to be able to

340
00:09:13,120 --> 00:09:15,279
look at the little green screen and be

341
00:09:14,560 --> 00:09:17,119
like

342
00:09:15,279 --> 00:09:18,480
i see the girl in the red dress right or

343
00:09:17,120 --> 00:09:19,920
the woman in the red dress

344
00:09:18,480 --> 00:09:22,160
you don't have to be like that matrix

345
00:09:19,920 --> 00:09:23,519
level neo kind of thing going on there

346
00:09:22,160 --> 00:09:26,079
again we're going to use tools like red

347
00:09:23,519 --> 00:09:27,600
shop rockmon i cackles and i got to tell

348
00:09:26,080 --> 00:09:29,279
you man after shallow hal

349
00:09:27,600 --> 00:09:30,640
i cannot look at eye cackles and not

350
00:09:29,279 --> 00:09:32,800
think about cankles again

351
00:09:30,640 --> 00:09:34,240
i'm sorry uh now you hopefully now too

352
00:09:32,800 --> 00:09:36,319
have that stuck in your head

353
00:09:34,240 --> 00:09:38,160
so again we'll be kind of like uh bad

354
00:09:36,320 --> 00:09:39,600
bad association partners there we go

355
00:09:38,160 --> 00:09:41,839
i use a little bit of powershell here

356
00:09:39,600 --> 00:09:42,720
and there equal light database viewer

357
00:09:41,839 --> 00:09:44,399
strings

358
00:09:42,720 --> 00:09:45,839
process hacker is one of the most

359
00:09:44,399 --> 00:09:47,120
underrated tools i'm going to walk you

360
00:09:45,839 --> 00:09:50,080
through this in just a moment here

361
00:09:47,120 --> 00:09:51,120
it's one of the most underrated tools

362
00:09:50,080 --> 00:09:52,959
bar none

363
00:09:51,120 --> 00:09:54,800
in our industry and i don't know why

364
00:09:52,959 --> 00:09:56,800
more people don't know about this tool

365
00:09:54,800 --> 00:09:58,880
now if you're a sans person you've

366
00:09:56,800 --> 00:10:01,599
probably seen uh jason fawson

367
00:09:58,880 --> 00:10:02,800
jason fawson phenomenally smart dude

368
00:10:01,600 --> 00:10:04,720
alyssa torres another

369
00:10:02,800 --> 00:10:06,240
another big process hacker champion you

370
00:10:04,720 --> 00:10:07,360
know in the memory forensics course but

371
00:10:06,240 --> 00:10:07,760
but i'm just going to tell you that they

372
00:10:07,360 --> 00:10:10,880
both

373
00:10:07,760 --> 00:10:11,519
are our big big evangelists for process

374
00:10:10,880 --> 00:10:13,839
hacker

375
00:10:11,519 --> 00:10:15,279
and uh jason fawson out on the sands

376
00:10:13,839 --> 00:10:15,680
website at sadly i will link to it in

377
00:10:15,279 --> 00:10:18,320
here

378
00:10:15,680 --> 00:10:19,120
but he's got a whole presentation on i

379
00:10:18,320 --> 00:10:21,120
think he calls it

380
00:10:19,120 --> 00:10:22,640
uh some exploratory surgery with process

381
00:10:21,120 --> 00:10:24,160
hacker i mean it's it's a free

382
00:10:22,640 --> 00:10:26,560
presentation go grab it

383
00:10:24,160 --> 00:10:27,519
and learn process hacker because it's an

384
00:10:26,560 --> 00:10:29,359
amazeballs

385
00:10:27,519 --> 00:10:30,880
level tool and then finally microsoft

386
00:10:29,360 --> 00:10:33,120
network monitor and notice here i didn't

387
00:10:30,880 --> 00:10:34,720
say wireshark i didn't say wireshark

388
00:10:33,120 --> 00:10:35,279
there's a reason for microsoft network

389
00:10:34,720 --> 00:10:36,720
monitor

390
00:10:35,279 --> 00:10:38,880
i'm going to cover that in a minute but

391
00:10:36,720 --> 00:10:40,800
you should know i don't mean wireshark

392
00:10:38,880 --> 00:10:42,560
these two things are not interchangeable

393
00:10:40,800 --> 00:10:43,920
not in this case at least generally i

394
00:10:42,560 --> 00:10:44,880
want to say by the way too microsoft

395
00:10:43,920 --> 00:10:47,920
network monitor

396
00:10:44,880 --> 00:10:48,480
is a worse tool generally for packet

397
00:10:47,920 --> 00:10:50,719
capture

398
00:10:48,480 --> 00:10:52,399
i use it for vulnerability or sorry

399
00:10:50,720 --> 00:10:54,320
vulnerability identification though

400
00:10:52,399 --> 00:10:56,079
because it has a couple of superpowers

401
00:10:54,320 --> 00:10:57,440
unfortunately the wireshark laughs right

402
00:10:56,079 --> 00:10:58,319
and that has to do with its tie into the

403
00:10:57,440 --> 00:10:59,600
operating system

404
00:10:58,320 --> 00:11:02,240
i want to start off talking about red

405
00:10:59,600 --> 00:11:04,160
shot red shot is an amazingly useful

406
00:11:02,240 --> 00:11:05,839
tool for snapshotting the registry

407
00:11:04,160 --> 00:11:07,920
and then comparing it to a snapshot

408
00:11:05,839 --> 00:11:08,640
taken later so that you can go find the

409
00:11:07,920 --> 00:11:11,120
changes

410
00:11:08,640 --> 00:11:13,040
now you can also snapshot file system

411
00:11:11,120 --> 00:11:14,320
changes as well right so basically here

412
00:11:13,040 --> 00:11:16,240
you'll notice that i've got

413
00:11:14,320 --> 00:11:17,519
in the uh basically notice here that

414
00:11:16,240 --> 00:11:19,839
i've got this little scan

415
00:11:17,519 --> 00:11:21,760
uh scan dur button set here and so

416
00:11:19,839 --> 00:11:23,519
because i've got this checked right

417
00:11:21,760 --> 00:11:25,200
this little box here check because i've

418
00:11:23,519 --> 00:11:26,480
got that box checked i'm able to go in

419
00:11:25,200 --> 00:11:28,880
then it scans the whole

420
00:11:26,480 --> 00:11:30,640
file system now you should know that

421
00:11:28,880 --> 00:11:33,360
when you check that box that makes

422
00:11:30,640 --> 00:11:34,640
redshot take phenomenally longer also

423
00:11:33,360 --> 00:11:36,000
you should know that you should have an

424
00:11:34,640 --> 00:11:38,880
ssd for this right

425
00:11:36,000 --> 00:11:40,560
and if your boss is like no it's desktop

426
00:11:38,880 --> 00:11:41,600
you don't need an ssd and even better

427
00:11:40,560 --> 00:11:44,000
than nvme

428
00:11:41,600 --> 00:11:45,200
you want fast speed is the name of the

429
00:11:44,000 --> 00:11:47,760
game here because

430
00:11:45,200 --> 00:11:49,760
you know even on a moderately sized vm

431
00:11:47,760 --> 00:11:51,600
right so moderately sized desktop vm

432
00:11:49,760 --> 00:11:53,040
in fact if you're familiar with iuser

433
00:11:51,600 --> 00:11:56,079
you can see what i'm using here

434
00:11:53,040 --> 00:11:57,360
this is actually the modern ie vm i use

435
00:11:56,079 --> 00:11:59,279
that for a lot of my vulnerability

436
00:11:57,360 --> 00:12:01,360
discovery because i

437
00:11:59,279 --> 00:12:02,959
basically it's a nobody argues with me

438
00:12:01,360 --> 00:12:05,680
like jake you did something i can

439
00:12:02,959 --> 00:12:07,439
literally point back to a public vm

440
00:12:05,680 --> 00:12:08,880
right that they can go as i'm basically

441
00:12:07,440 --> 00:12:10,399
for reproducing results

442
00:12:08,880 --> 00:12:12,320
it's not one of these well that didn't

443
00:12:10,399 --> 00:12:14,079
work on my system and my

444
00:12:12,320 --> 00:12:15,600
because it's configuration specific or

445
00:12:14,079 --> 00:12:18,000
when a vendor accuses me

446
00:12:15,600 --> 00:12:19,839
of modifying my configuration to make

447
00:12:18,000 --> 00:12:20,320
something exploitable my negative ghost

448
00:12:19,839 --> 00:12:22,399
rider

449
00:12:20,320 --> 00:12:24,560
go download this vm and again if you're

450
00:12:22,399 --> 00:12:25,440
not familiar with modern.ie that is the

451
00:12:24,560 --> 00:12:28,000
url

452
00:12:25,440 --> 00:12:28,480
you can go download virtual machines

453
00:12:28,000 --> 00:12:31,440
from

454
00:12:28,480 --> 00:12:32,399
modern.ie for browser testing now what

455
00:12:31,440 --> 00:12:34,320
do you know

456
00:12:32,399 --> 00:12:35,839
i always make sure to do browser testing

457
00:12:34,320 --> 00:12:36,560
there so microsoft don't don't hit me

458
00:12:35,839 --> 00:12:38,800
here right

459
00:12:36,560 --> 00:12:40,800
i always do some browser testing anytime

460
00:12:38,800 --> 00:12:41,920
i download a vm from there because of

461
00:12:40,800 --> 00:12:43,279
course i do right

462
00:12:41,920 --> 00:12:45,360
i comply with licensing but in the

463
00:12:43,279 --> 00:12:45,760
meantime it shows me files that were

464
00:12:45,360 --> 00:12:47,440
added

465
00:12:45,760 --> 00:12:49,600
files that were deleted files that

466
00:12:47,440 --> 00:12:51,360
change size or attributes as well as

467
00:12:49,600 --> 00:12:52,079
register keys and values that were

468
00:12:51,360 --> 00:12:55,120
modified

469
00:12:52,079 --> 00:12:57,519
added deleted etc it's a phenomenal tool

470
00:12:55,120 --> 00:12:59,600
for finding the differences in snapshots

471
00:12:57,519 --> 00:13:01,519
and when i say snapshots here again

472
00:12:59,600 --> 00:13:03,120
basically meaning that i can see all the

473
00:13:01,519 --> 00:13:03,600
changes that a particular application

474
00:13:03,120 --> 00:13:05,279
made

475
00:13:03,600 --> 00:13:07,440
i'm really concerned about this because

476
00:13:05,279 --> 00:13:08,880
sometimes they write really weird things

477
00:13:07,440 --> 00:13:10,240
into the registry now

478
00:13:08,880 --> 00:13:12,480
if you're thinking like but i don't want

479
00:13:10,240 --> 00:13:14,720
to compare snapshots right good news

480
00:13:12,480 --> 00:13:16,800
proc mod is the tool for you now procmod

481
00:13:14,720 --> 00:13:17,440
allows you to monitor files and register

482
00:13:16,800 --> 00:13:20,479
changes

483
00:13:17,440 --> 00:13:22,000
among other things in real time now

484
00:13:20,480 --> 00:13:23,920
i've had folks when i've talked about

485
00:13:22,000 --> 00:13:25,760
this in the past in smaller venues folks

486
00:13:23,920 --> 00:13:27,120
like sysmon is definitely i'm like rock

487
00:13:25,760 --> 00:13:28,720
on i hear it i hear it

488
00:13:27,120 --> 00:13:30,560
i know what sysmon is i know what

489
00:13:28,720 --> 00:13:32,240
suspend does it's not like i've been

490
00:13:30,560 --> 00:13:33,839
trapped in the industry here for

491
00:13:32,240 --> 00:13:35,519
you know are trapped you know basically

492
00:13:33,839 --> 00:13:35,920
like i went to sleep 10 years ago and

493
00:13:35,519 --> 00:13:37,519
just

494
00:13:35,920 --> 00:13:39,120
was pulled out of a medically induced

495
00:13:37,519 --> 00:13:40,720
coma or something and like

496
00:13:39,120 --> 00:13:42,160
still saying procmond there's a reason

497
00:13:40,720 --> 00:13:44,560
i'm using procmond it's because

498
00:13:42,160 --> 00:13:45,519
the additional noise that i get out of

499
00:13:44,560 --> 00:13:47,599
system on

500
00:13:45,519 --> 00:13:49,519
doesn't markedly help me here also by

501
00:13:47,600 --> 00:13:50,959
the way that extra noise is why i'm

502
00:13:49,519 --> 00:13:52,880
still using red shot here

503
00:13:50,959 --> 00:13:54,719
i'm using both tools simultaneously this

504
00:13:52,880 --> 00:13:56,240
is not an either or thing this is a both

505
00:13:54,720 --> 00:13:58,000
thing i launch procmon

506
00:13:56,240 --> 00:14:00,480
i have it not capturing then i launch

507
00:13:58,000 --> 00:14:02,240
red shot and then i get red shot to take

508
00:14:00,480 --> 00:14:03,920
its first shot then i do the things that

509
00:14:02,240 --> 00:14:06,639
i turn on capturing in

510
00:14:03,920 --> 00:14:08,160
rockmon do the things that i do grab a

511
00:14:06,639 --> 00:14:10,160
second snapshot now

512
00:14:08,160 --> 00:14:11,760
rockmon allows you if you want to think

513
00:14:10,160 --> 00:14:13,439
about this right red shots a lot like

514
00:14:11,760 --> 00:14:14,240
comparing two satellite photographs to

515
00:14:13,440 --> 00:14:15,839
find changes

516
00:14:14,240 --> 00:14:17,360
very topically there are some

517
00:14:15,839 --> 00:14:18,959
comparisons that were in the new york

518
00:14:17,360 --> 00:14:21,120
times i believe it was this morning

519
00:14:18,959 --> 00:14:22,479
of iran that apparently is digging mass

520
00:14:21,120 --> 00:14:24,240
graves and so they're able to look at

521
00:14:22,480 --> 00:14:25,600
two satellite photographs and see the

522
00:14:24,240 --> 00:14:27,279
delta between those

523
00:14:25,600 --> 00:14:28,959
and kind of see what's going on and the

524
00:14:27,279 --> 00:14:31,279
changes but we're not watching those in

525
00:14:28,959 --> 00:14:34,239
real time rock mod is like a close-up

526
00:14:31,279 --> 00:14:36,800
real-time video feed so rock on here i

527
00:14:34,240 --> 00:14:39,279
love the video feed the problem here is

528
00:14:36,800 --> 00:14:41,279
there is a ton of background noise right

529
00:14:39,279 --> 00:14:43,120
now a lot of people tell me like jake

530
00:14:41,279 --> 00:14:44,079
you know just filter on the one process

531
00:14:43,120 --> 00:14:46,720
that you need and i'm like

532
00:14:44,079 --> 00:14:47,920
neat i do that but i want to capture

533
00:14:46,720 --> 00:14:49,839
everything also

534
00:14:47,920 --> 00:14:51,920
by the way there's often times there's

535
00:14:49,839 --> 00:14:53,600
all kinds of extra stuff and other

536
00:14:51,920 --> 00:14:54,160
processes that's kicked off by my

537
00:14:53,600 --> 00:14:56,320
process

538
00:14:54,160 --> 00:14:58,079
it's interesting and anyway the the

539
00:14:56,320 --> 00:15:00,639
short of it is i use procmod

540
00:14:58,079 --> 00:15:01,760
and redshot redshot gives me a very

541
00:15:00,639 --> 00:15:03,360
consolidated view

542
00:15:01,760 --> 00:15:04,800
of all the changes that were made

543
00:15:03,360 --> 00:15:07,199
whereas rockmon

544
00:15:04,800 --> 00:15:09,199
shows me all the changes as they're

545
00:15:07,199 --> 00:15:10,639
happening i'm using both tools

546
00:15:09,199 --> 00:15:12,639
now in the vulnerabilities that you're

547
00:15:10,639 --> 00:15:13,839
gonna see see see as we talk about the

548
00:15:12,639 --> 00:15:15,120
case studies today

549
00:15:13,839 --> 00:15:17,199
what you're going to see there is going

550
00:15:15,120 --> 00:15:19,120
to be procmon output but i want you to

551
00:15:17,199 --> 00:15:20,240
know that in one of those cases i really

552
00:15:19,120 --> 00:15:22,800
got my initial lead

553
00:15:20,240 --> 00:15:24,399
via red shot another tool by the way too

554
00:15:22,800 --> 00:15:27,040
here this is one of my go-to's right

555
00:15:24,399 --> 00:15:28,720
operation is process create this is a

556
00:15:27,040 --> 00:15:30,240
good start for me here because i filter

557
00:15:28,720 --> 00:15:32,160
by operation a lot of people like

558
00:15:30,240 --> 00:15:33,440
filter by process they filter by the

559
00:15:32,160 --> 00:15:35,920
process and they've got

560
00:15:33,440 --> 00:15:37,040
10 000 lines or in one case that i was

561
00:15:35,920 --> 00:15:39,120
working with here one of the

562
00:15:37,040 --> 00:15:41,519
two applications when i filtered just by

563
00:15:39,120 --> 00:15:42,880
process i think i had 120 000 lines for

564
00:15:41,519 --> 00:15:45,519
about three minutes of activity

565
00:15:42,880 --> 00:15:46,959
it's a very busy process rock on what i

566
00:15:45,519 --> 00:15:47,920
did here is i strategically used

567
00:15:46,959 --> 00:15:49,518
filtering

568
00:15:47,920 --> 00:15:50,719
to get me to where i wanted to go i

569
00:15:49,519 --> 00:15:51,839
can't look through a hundred i can't

570
00:15:50,720 --> 00:15:53,040
even look through a thousand lines i'm

571
00:15:51,839 --> 00:15:54,480
gonna be straight up and tell it you

572
00:15:53,040 --> 00:15:55,199
give me a thousand lines of rock mount

573
00:15:54,480 --> 00:15:57,680
output

574
00:15:55,199 --> 00:15:58,479
i may miss the golden nugget in that

575
00:15:57,680 --> 00:16:00,560
poop pile

576
00:15:58,480 --> 00:16:02,160
because it's too much data and i'm being

577
00:16:00,560 --> 00:16:03,758
overrun by the data here so

578
00:16:02,160 --> 00:16:05,279
i'm really surgical about the uh

579
00:16:03,759 --> 00:16:05,839
basically about the filters that i that

580
00:16:05,279 --> 00:16:07,600
i create

581
00:16:05,839 --> 00:16:10,240
and this is one that i tend to like is

582
00:16:07,600 --> 00:16:11,839
process creek talk about process hacker

583
00:16:10,240 --> 00:16:14,160
process hacker does a lot of stuff it

584
00:16:11,839 --> 00:16:16,079
shows the relationship between processes

585
00:16:14,160 --> 00:16:17,519
services that are running dl's that are

586
00:16:16,079 --> 00:16:19,279
loaded and other information but that's

587
00:16:17,519 --> 00:16:20,160
not my favorite feature here it is for

588
00:16:19,279 --> 00:16:21,920
other stuff

589
00:16:20,160 --> 00:16:23,600
for other stuff i absolutely love it for

590
00:16:21,920 --> 00:16:24,399
that but i have to tell you my favorite

591
00:16:23,600 --> 00:16:26,079
feature in

592
00:16:24,399 --> 00:16:28,240
this scenario is the ability to search

593
00:16:26,079 --> 00:16:28,880
memory of a running process and edit it

594
00:16:28,240 --> 00:16:30,320
on the fly

595
00:16:28,880 --> 00:16:32,079
now a lot of folks like jake why would

596
00:16:30,320 --> 00:16:33,279
you do that that's ridiculous right why

597
00:16:32,079 --> 00:16:35,199
are you going to go edit the memory of a

598
00:16:33,279 --> 00:16:36,880
running process you said no reversing

599
00:16:35,199 --> 00:16:38,880
you're right no reversing

600
00:16:36,880 --> 00:16:40,320
what i do is i search for strings inside

601
00:16:38,880 --> 00:16:42,240
of memory and then i go

602
00:16:40,320 --> 00:16:44,079
surgically replace like let's say for

603
00:16:42,240 --> 00:16:45,279
instance a callback domain and i want to

604
00:16:44,079 --> 00:16:47,279
see can i force it

605
00:16:45,279 --> 00:16:48,720
to go somewhere else and i'll simply

606
00:16:47,279 --> 00:16:50,000
change the callback domain in the

607
00:16:48,720 --> 00:16:52,160
strings in memory

608
00:16:50,000 --> 00:16:53,440
and go and i love being able to do this

609
00:16:52,160 --> 00:16:55,839
for science

610
00:16:53,440 --> 00:16:57,680
science right we all know about this but

611
00:16:55,839 --> 00:16:58,079
look we get down to the whole science

612
00:16:57,680 --> 00:16:59,758
thing

613
00:16:58,079 --> 00:17:02,000
what am i looking at here i'm looking

614
00:16:59,759 --> 00:17:04,160
here at the ability to go in

615
00:17:02,000 --> 00:17:05,919
and start looking at the dlls that are

616
00:17:04,160 --> 00:17:07,760
present the dlls that are present tell

617
00:17:05,919 --> 00:17:09,199
me quite a bit about the uh quite a bit

618
00:17:07,760 --> 00:17:10,879
about the program itself

619
00:17:09,199 --> 00:17:12,640
you might infer that because this is in

620
00:17:10,880 --> 00:17:15,679
program files x86

621
00:17:12,640 --> 00:17:17,360
you might infer that indeed it is a x86

622
00:17:15,679 --> 00:17:19,679
versus an x64 program

623
00:17:17,359 --> 00:17:20,719
and i tell you be like right like 99 of

624
00:17:19,679 --> 00:17:23,839
the time in that case

625
00:17:20,720 --> 00:17:26,319
the reverse is not true a lot of 32-bit

626
00:17:23,839 --> 00:17:29,440
applications install themselves into

627
00:17:26,319 --> 00:17:31,678
64-bit the 64-bit program files folder

628
00:17:29,440 --> 00:17:33,679
and oftentimes there are both 32 and

629
00:17:31,679 --> 00:17:34,320
64-bit components in the same program in

630
00:17:33,679 --> 00:17:36,080
which case

631
00:17:34,320 --> 00:17:37,840
it really should go in the program files

632
00:17:36,080 --> 00:17:39,439
folder when i'm looking at a particular

633
00:17:37,840 --> 00:17:40,959
application while running though

634
00:17:39,440 --> 00:17:42,480
if i take a look at the modules and

635
00:17:40,960 --> 00:17:43,600
process hacker shows this to you on the

636
00:17:42,480 --> 00:17:45,120
general tab as well

637
00:17:43,600 --> 00:17:46,879
but if i look at the modules and i see

638
00:17:45,120 --> 00:17:48,879
this this wow 64.

639
00:17:46,880 --> 00:17:50,480
wow stands for windows on windows right

640
00:17:48,880 --> 00:17:52,160
and the 64-bit here means i'm looking at

641
00:17:50,480 --> 00:17:53,840
a 32-bit process

642
00:17:52,160 --> 00:17:55,440
running in the basically running in the

643
00:17:53,840 --> 00:17:58,000
emulation sub-system

644
00:17:55,440 --> 00:17:59,280
on 64-bit windows so that's that tells

645
00:17:58,000 --> 00:18:01,600
me that effectively

646
00:17:59,280 --> 00:18:02,960
and this is where things get amazeballs

647
00:18:01,600 --> 00:18:03,918
right because i can go over to the

648
00:18:02,960 --> 00:18:05,600
memory tab

649
00:18:03,919 --> 00:18:07,520
i can go find particular memory and

650
00:18:05,600 --> 00:18:09,760
hidden behind here by the way there's a

651
00:18:07,520 --> 00:18:11,120
basic a tab to go look for string so if

652
00:18:09,760 --> 00:18:12,559
you know what string you're looking for

653
00:18:11,120 --> 00:18:14,479
you just fire the strings tab

654
00:18:12,559 --> 00:18:16,160
it shows you the offset then you double

655
00:18:14,480 --> 00:18:17,200
click on the appropriate address there

656
00:18:16,160 --> 00:18:19,520
the appropriate range

657
00:18:17,200 --> 00:18:20,720
and literally you can now have a live

658
00:18:19,520 --> 00:18:23,039
hex editor into

659
00:18:20,720 --> 00:18:24,799
memory on your system now with great

660
00:18:23,039 --> 00:18:26,720
power comes great responsibility i

661
00:18:24,799 --> 00:18:27,600
demonstrate in practically every class

662
00:18:26,720 --> 00:18:29,600
that i teach

663
00:18:27,600 --> 00:18:31,439
basically breaking processes by doing

664
00:18:29,600 --> 00:18:32,480
this because it's i mean let's be fair

665
00:18:31,440 --> 00:18:35,120
it is kind of fun

666
00:18:32,480 --> 00:18:36,960
i enjoy it students enjoy it done and

667
00:18:35,120 --> 00:18:38,879
then finally microsoft network monitor

668
00:18:36,960 --> 00:18:40,799
this is a thing of absolute beauty it is

669
00:18:38,880 --> 00:18:42,880
a now deprecated tool but it allows you

670
00:18:40,799 --> 00:18:46,000
to watch traffic in real time

671
00:18:42,880 --> 00:18:47,440
and time networking individual processes

672
00:18:46,000 --> 00:18:50,480
and i don't know if you're watching here

673
00:18:47,440 --> 00:18:52,480
right but here in the process name field

674
00:18:50,480 --> 00:18:54,000
what we have here effectively is

675
00:18:52,480 --> 00:18:54,640
basically the process name that

676
00:18:54,000 --> 00:18:56,559
generated

677
00:18:54,640 --> 00:18:58,480
the traffic this is the thing you don't

678
00:18:56,559 --> 00:18:59,760
get with the regular packet capture data

679
00:18:58,480 --> 00:19:01,919
all right so if you have just a regular

680
00:18:59,760 --> 00:19:04,160
pcapp if you just fire up wireshark

681
00:19:01,919 --> 00:19:06,160
what you're dealing with now is you only

682
00:19:04,160 --> 00:19:07,600
get this data you don't get the uh you

683
00:19:06,160 --> 00:19:08,720
don't get the more important i would say

684
00:19:07,600 --> 00:19:10,559
more important data

685
00:19:08,720 --> 00:19:12,320
the process that is that's actually

686
00:19:10,559 --> 00:19:12,879
creating it that that's huge for me

687
00:19:12,320 --> 00:19:15,039
because

688
00:19:12,880 --> 00:19:16,640
if i see a connection you know i've done

689
00:19:15,039 --> 00:19:18,320
this with wireshark in the past right

690
00:19:16,640 --> 00:19:19,280
before somebody introduced this to me 10

691
00:19:18,320 --> 00:19:22,000
years ago

692
00:19:19,280 --> 00:19:23,760
and i'll tell you that when i used to

693
00:19:22,000 --> 00:19:25,760
use wireshark i would see

694
00:19:23,760 --> 00:19:27,360
like a communication i'd be like oh man

695
00:19:25,760 --> 00:19:29,200
i wonder is that my process

696
00:19:27,360 --> 00:19:30,959
is that the one i'm hunting right and i

697
00:19:29,200 --> 00:19:32,400
didn't know so that i'm trying to like

698
00:19:30,960 --> 00:19:34,480
rinse lather repeat because i'm trying

699
00:19:32,400 --> 00:19:35,360
not to reverse engineer i mean i can i

700
00:19:34,480 --> 00:19:37,360
certainly do

701
00:19:35,360 --> 00:19:39,360
but if i can avoid it why worry about

702
00:19:37,360 --> 00:19:40,959
that right so this is so much better

703
00:19:39,360 --> 00:19:41,360
because i get a chance i can filter

704
00:19:40,960 --> 00:19:43,840
against

705
00:19:41,360 --> 00:19:44,879
only a specific process and very very

706
00:19:43,840 --> 00:19:46,480
useful by the way

707
00:19:44,880 --> 00:19:47,919
even though it's deprecated you can

708
00:19:46,480 --> 00:19:48,720
still download and still run just fine

709
00:19:47,919 --> 00:19:51,039
on windows 10.

710
00:19:48,720 --> 00:19:52,160
i've got it running on 1909 right now it

711
00:19:51,039 --> 00:19:53,760
runs just fine

712
00:19:52,160 --> 00:19:56,000
couldn't be happier and uh we'll

713
00:19:53,760 --> 00:19:56,720
continue to keep running it on 1909 and

714
00:19:56,000 --> 00:19:58,400
and done

715
00:19:56,720 --> 00:20:00,960
but uh what i'll mention here is that

716
00:19:58,400 --> 00:20:02,960
there is also a not deprecated version

717
00:20:00,960 --> 00:20:05,280
net sh with the trace filter that

718
00:20:02,960 --> 00:20:07,200
creates what they call etl files

719
00:20:05,280 --> 00:20:08,879
and these etl their event trace logs

720
00:20:07,200 --> 00:20:11,360
basically with those

721
00:20:08,880 --> 00:20:13,280
you can still capture all this data but

722
00:20:11,360 --> 00:20:13,760
you can't watch it real time and i i'm

723
00:20:13,280 --> 00:20:15,840
i'm

724
00:20:13,760 --> 00:20:17,360
not a delayed gratification guy i want

725
00:20:15,840 --> 00:20:20,080
to see this in real time

726
00:20:17,360 --> 00:20:20,959
and so i'm far less likely to uh far

727
00:20:20,080 --> 00:20:22,720
less likely to

728
00:20:20,960 --> 00:20:24,240
to basically use wireshark than this

729
00:20:22,720 --> 00:20:25,039
right so take nothing else away from

730
00:20:24,240 --> 00:20:27,120
this talk

731
00:20:25,039 --> 00:20:28,799
process hacker and netmon are awesome

732
00:20:27,120 --> 00:20:30,000
awesome tools if you don't have those in

733
00:20:28,799 --> 00:20:31,679
your bug hunting arsenal

734
00:20:30,000 --> 00:20:33,280
put them in your bug hunting arsenal

735
00:20:31,679 --> 00:20:35,120
let's talk about what to look for

736
00:20:33,280 --> 00:20:36,480
first off i want to set up targets of

737
00:20:35,120 --> 00:20:38,399
opportunity here process

738
00:20:36,480 --> 00:20:39,760
calls if the program is creating a

739
00:20:38,400 --> 00:20:41,520
process what is the

740
00:20:39,760 --> 00:20:43,280
what is the path that's fully qualified

741
00:20:41,520 --> 00:20:45,520
was the path fully qualified

742
00:20:43,280 --> 00:20:47,120
are paths of spaces quoted mark baggett

743
00:20:45,520 --> 00:20:50,240
one of the smartest men i know

744
00:20:47,120 --> 00:20:51,840
who introduced me gosh 15 10 i can't

745
00:20:50,240 --> 00:20:52,960
even remember years ago it's been a lot

746
00:20:51,840 --> 00:20:54,879
of years sadly

747
00:20:52,960 --> 00:20:57,400
and he introduced me to the whole idea

748
00:20:54,880 --> 00:20:59,679
of basically creating a file called

749
00:20:57,400 --> 00:21:00,640
program.exe and you just put this in the

750
00:20:59,679 --> 00:21:03,600
root of your c drive

751
00:21:00,640 --> 00:21:04,240
literally see program.exe this is such a

752
00:21:03,600 --> 00:21:06,158
problem

753
00:21:04,240 --> 00:21:07,840
microsoft actually warns you about right

754
00:21:06,159 --> 00:21:09,159
they're like

755
00:21:07,840 --> 00:21:10,959
did you seriously just create

756
00:21:09,159 --> 00:21:13,760
program.exe they're like because

757
00:21:10,960 --> 00:21:15,520
that that's probably malware right they

758
00:21:13,760 --> 00:21:16,879
actually have a pop-up about this now

759
00:21:15,520 --> 00:21:18,639
incidentally the pop-up you can click

760
00:21:16,880 --> 00:21:20,480
the don't show me this again if you have

761
00:21:18,640 --> 00:21:21,760
permissions to write program.exe you

762
00:21:20,480 --> 00:21:23,440
have permissions to write the registry

763
00:21:21,760 --> 00:21:24,640
key that says don't show me this again

764
00:21:23,440 --> 00:21:27,120
we're not going to talk about that

765
00:21:24,640 --> 00:21:29,919
little logic kerfuffle right but

766
00:21:27,120 --> 00:21:32,158
whatever what i'm looking for here when

767
00:21:29,919 --> 00:21:34,159
we start looking at creating a process

768
00:21:32,159 --> 00:21:35,520
i can filter on create process i

769
00:21:34,159 --> 00:21:36,640
definitely again you saw that earlier

770
00:21:35,520 --> 00:21:40,320
i'll show you that again

771
00:21:36,640 --> 00:21:42,400
as we progress but the process creation

772
00:21:40,320 --> 00:21:44,320
calls are showing me the successful

773
00:21:42,400 --> 00:21:45,679
process creation calls what i'm looking

774
00:21:44,320 --> 00:21:47,600
for here

775
00:21:45,679 --> 00:21:50,000
first right is i'm looking for because

776
00:21:47,600 --> 00:21:50,559
as you tell windows create process if i

777
00:21:50,000 --> 00:21:53,679
say c

778
00:21:50,559 --> 00:21:56,879
program files common files let's call it

779
00:21:53,679 --> 00:21:58,559
i don't know jake and then jake.exe the

780
00:21:56,880 --> 00:21:59,440
first thing that create process call is

781
00:21:58,559 --> 00:22:00,879
going to do it's going to look for

782
00:21:59,440 --> 00:22:03,120
program.exe because

783
00:22:00,880 --> 00:22:04,720
program files if it's unquoted has a

784
00:22:03,120 --> 00:22:06,320
space and it's going to say program

785
00:22:04,720 --> 00:22:08,480
files and then common files let's say

786
00:22:06,320 --> 00:22:09,840
program files common.exe

787
00:22:08,480 --> 00:22:11,919
this is all happening without the

788
00:22:09,840 --> 00:22:13,520
developers interaction and so what i'm

789
00:22:11,919 --> 00:22:15,360
looking for here then because i won't

790
00:22:13,520 --> 00:22:17,120
see a failed process create call the

791
00:22:15,360 --> 00:22:19,199
call will eventually be successful

792
00:22:17,120 --> 00:22:20,158
if the program is there what i want to

793
00:22:19,200 --> 00:22:22,480
know is

794
00:22:20,159 --> 00:22:23,760
basically did we have an unquoted path

795
00:22:22,480 --> 00:22:25,360
and if so

796
00:22:23,760 --> 00:22:26,960
did we would we have looked for things

797
00:22:25,360 --> 00:22:28,158
other places in those cases what we're

798
00:22:26,960 --> 00:22:30,880
looking for here then

799
00:22:28,159 --> 00:22:32,559
is a create file call now create file in

800
00:22:30,880 --> 00:22:34,159
windows and create anything in windows

801
00:22:32,559 --> 00:22:35,520
really means create or open

802
00:22:34,159 --> 00:22:37,440
now there are flags that you can set

803
00:22:35,520 --> 00:22:38,158
really only create don't open it if it

804
00:22:37,440 --> 00:22:40,559
already exists

805
00:22:38,159 --> 00:22:42,080
but really it's create or open and so

806
00:22:40,559 --> 00:22:44,399
here we're saying create file

807
00:22:42,080 --> 00:22:45,199
and i'm looking for is not successful

808
00:22:44,400 --> 00:22:48,080
meaning

809
00:22:45,200 --> 00:22:49,360
that windows tried to find something

810
00:22:48,080 --> 00:22:51,199
that ends with exe

811
00:22:49,360 --> 00:22:53,039
so an executable now in this case i

812
00:22:51,200 --> 00:22:54,159
filtered it because all the process

813
00:22:53,039 --> 00:22:56,000
names that i was interested

814
00:22:54,159 --> 00:22:58,000
in they all begin with the letters asc

815
00:22:56,000 --> 00:23:00,159
so this was an easy one for me to do

816
00:22:58,000 --> 00:23:01,600
but with asc here basically i'm looking

817
00:23:00,159 --> 00:23:03,440
for create file call

818
00:23:01,600 --> 00:23:04,959
that is not successful that ends with

819
00:23:03,440 --> 00:23:05,919
exe because again they're looking to

820
00:23:04,960 --> 00:23:08,000
open this up

821
00:23:05,919 --> 00:23:09,360
and what i'm looking for here are where

822
00:23:08,000 --> 00:23:11,039
else might we have something now

823
00:23:09,360 --> 00:23:12,479
i want to mention here too by the way in

824
00:23:11,039 --> 00:23:13,280
fact you'll see an example of this in a

825
00:23:12,480 --> 00:23:15,280
few minutes

826
00:23:13,280 --> 00:23:17,760
it's not just stuff with spaces and

827
00:23:15,280 --> 00:23:21,120
unquoted paths we also run into problems

828
00:23:17,760 --> 00:23:22,960
with basically when the path is is not

829
00:23:21,120 --> 00:23:24,479
is not fully qualified they're going to

830
00:23:22,960 --> 00:23:25,679
walk through windows is going to walk

831
00:23:24,480 --> 00:23:26,480
through all the things in the path

832
00:23:25,679 --> 00:23:28,320
variable

833
00:23:26,480 --> 00:23:30,000
looking for the executable in those

834
00:23:28,320 --> 00:23:31,200
locations and again it's not going to

835
00:23:30,000 --> 00:23:32,559
find them if you can write choose

836
00:23:31,200 --> 00:23:35,360
anywhere on the path variable

837
00:23:32,559 --> 00:23:37,120
you win new services another big one red

838
00:23:35,360 --> 00:23:39,678
shot helps me find new services

839
00:23:37,120 --> 00:23:41,840
and i love it odd directories i want to

840
00:23:39,679 --> 00:23:43,600
look at dll path hijacking opportunities

841
00:23:41,840 --> 00:23:45,360
talked about that last uh last year in

842
00:23:43,600 --> 00:23:47,199
deadwood there's also other

843
00:23:45,360 --> 00:23:49,760
material that i've got out online about

844
00:23:47,200 --> 00:23:51,120
dll dll path hijacking vulnerabilities

845
00:23:49,760 --> 00:23:53,200
give a whole presentation on it

846
00:23:51,120 --> 00:23:54,719
at b-sides augusta a couple years ago

847
00:23:53,200 --> 00:23:54,960
process hacker in the background though

848
00:23:54,720 --> 00:23:56,400
is

849
00:23:54,960 --> 00:23:58,320
awesome because instead of me having to

850
00:23:56,400 --> 00:23:59,600
watch this stuff in real time or you

851
00:23:58,320 --> 00:24:01,439
know inside of rockmon

852
00:23:59,600 --> 00:24:03,039
or see it later i literally just

853
00:24:01,440 --> 00:24:04,559
minimized process hacker and pops up a

854
00:24:03,039 --> 00:24:06,080
little tool tip and it's like hey this

855
00:24:04,559 --> 00:24:07,120
service was just created did you want to

856
00:24:06,080 --> 00:24:09,120
know about that i'm like

857
00:24:07,120 --> 00:24:10,799
of course i did that's why you're

858
00:24:09,120 --> 00:24:11,520
running in the background kind of thing

859
00:24:10,799 --> 00:24:13,679
right so

860
00:24:11,520 --> 00:24:15,360
process hacker again for the win

861
00:24:13,679 --> 00:24:17,039
absolutely loving process hacker

862
00:24:15,360 --> 00:24:18,639
now bad file permissions if you were

863
00:24:17,039 --> 00:24:20,240
deadwood last year you've

864
00:24:18,640 --> 00:24:21,760
already heard all about bad file

865
00:24:20,240 --> 00:24:22,559
permissions gosh that was what probably

866
00:24:21,760 --> 00:24:23,919
25

867
00:24:22,559 --> 00:24:25,840
of the talk i don't know something like

868
00:24:23,919 --> 00:24:26,720
that it was a big piece because it's a

869
00:24:25,840 --> 00:24:28,158
big problem

870
00:24:26,720 --> 00:24:30,400
a lot of installers replicate the

871
00:24:28,159 --> 00:24:32,480
permissions of the original directory

872
00:24:30,400 --> 00:24:33,600
on the machine whereas package some of

873
00:24:32,480 --> 00:24:35,520
them just inherit from the parent

874
00:24:33,600 --> 00:24:37,120
director that latter one here inheriting

875
00:24:35,520 --> 00:24:39,120
this is what you're supposed to do

876
00:24:37,120 --> 00:24:40,479
this year replicating the permissions

877
00:24:39,120 --> 00:24:43,600
that is a bad plan

878
00:24:40,480 --> 00:24:45,279
it well it probably is a bad plan

879
00:24:43,600 --> 00:24:46,480
often ends up being a bad plan if we

880
00:24:45,279 --> 00:24:47,360
have less secure permissions in the

881
00:24:46,480 --> 00:24:50,080
build machine

882
00:24:47,360 --> 00:24:51,918
those can be propagated to basically

883
00:24:50,080 --> 00:24:53,439
their targets after installation now i'm

884
00:24:51,919 --> 00:24:55,120
not going to cover all this again

885
00:24:53,440 --> 00:24:56,960
because it's already covered and you can

886
00:24:55,120 --> 00:24:58,559
go see that the link here is in the

887
00:24:56,960 --> 00:25:00,080
slides by the way these slides

888
00:24:58,559 --> 00:25:02,240
are going to get posted on twitter

889
00:25:00,080 --> 00:25:04,080
within whatever me uh shutting up

890
00:25:02,240 --> 00:25:05,440
i'll tweet out the link i'm mal or jake

891
00:25:04,080 --> 00:25:06,720
on twitter if you don't follow me

892
00:25:05,440 --> 00:25:08,320
already just monitor that

893
00:25:06,720 --> 00:25:10,480
or the rendition sec account and i'm

894
00:25:08,320 --> 00:25:12,320
sure we retweet it from there too

895
00:25:10,480 --> 00:25:14,400
one other target of opportunity insecure

896
00:25:12,320 --> 00:25:16,080
updates so we want to examine

897
00:25:14,400 --> 00:25:18,080
the network traffic that's being

898
00:25:16,080 --> 00:25:19,199
generated by our target application

899
00:25:18,080 --> 00:25:21,039
i'm going to look at this network

900
00:25:19,200 --> 00:25:22,640
monitor i'm going to check for and this

901
00:25:21,039 --> 00:25:24,799
is my go to list here

902
00:25:22,640 --> 00:25:26,559
is the update being done over https a

903
00:25:24,799 --> 00:25:27,200
lot of people like oh it's https so

904
00:25:26,559 --> 00:25:28,639
we're done

905
00:25:27,200 --> 00:25:31,760
i'm like no you're not no no we're not

906
00:25:28,640 --> 00:25:34,080
done yet if it is my next check is is

907
00:25:31,760 --> 00:25:36,400
the https certificate being pinned

908
00:25:34,080 --> 00:25:38,080
meaning if the certificate isn't being

909
00:25:36,400 --> 00:25:38,799
pinned what i end up with here

910
00:25:38,080 --> 00:25:41,199
effectively

911
00:25:38,799 --> 00:25:43,120
is i have the opportunity to intercept i

912
00:25:41,200 --> 00:25:44,080
can man in the middle and i can shove an

913
00:25:43,120 --> 00:25:46,479
executable

914
00:25:44,080 --> 00:25:48,559
potentially you know back to you that is

915
00:25:46,480 --> 00:25:51,120
basically we're passing the https check

916
00:25:48,559 --> 00:25:52,799
in some cases it's not even checking the

917
00:25:51,120 --> 00:25:53,360
checking the certificate principle or

918
00:25:52,799 --> 00:25:55,120
any of that

919
00:25:53,360 --> 00:25:56,959
sometimes i self-sign a certificate with

920
00:25:55,120 --> 00:25:58,879
all the same information and that works

921
00:25:56,960 --> 00:26:00,640
you name it be creative here again some

922
00:25:58,880 --> 00:26:01,520
of this benefits from a reverse engineer

923
00:26:00,640 --> 00:26:03,120
but you can test

924
00:26:01,520 --> 00:26:05,360
all this manually with no reversing

925
00:26:03,120 --> 00:26:06,799
required just a little bit of creativity

926
00:26:05,360 --> 00:26:08,639
next thing i'll do is i'll check to see

927
00:26:06,799 --> 00:26:10,240
is the update sign so you downloaded an

928
00:26:08,640 --> 00:26:11,760
update but you haven't installed it yet

929
00:26:10,240 --> 00:26:13,600
i'm going to go swap that bad boy out

930
00:26:11,760 --> 00:26:14,158
and see if you run my executable if you

931
00:26:13,600 --> 00:26:16,240
will

932
00:26:14,159 --> 00:26:17,279
i i know then if i have an unsigned

933
00:26:16,240 --> 00:26:18,559
basic and unsigned

934
00:26:17,279 --> 00:26:20,559
i know that you're not signature

935
00:26:18,559 --> 00:26:23,120
validating even if you sign the update

936
00:26:20,559 --> 00:26:23,600
you'll process my unsigned app great and

937
00:26:23,120 --> 00:26:25,120
then

938
00:26:23,600 --> 00:26:27,039
even if it was signed how's that

939
00:26:25,120 --> 00:26:29,520
signature being validated right i can

940
00:26:27,039 --> 00:26:31,279
use openssl and i can use that to go

941
00:26:29,520 --> 00:26:33,360
open ssl to generate a cert

942
00:26:31,279 --> 00:26:34,480
and then sign tool from microsoft to

943
00:26:33,360 --> 00:26:36,639
very easily sign

944
00:26:34,480 --> 00:26:38,240
the assign the executable i want to know

945
00:26:36,640 --> 00:26:39,440
how is it being validated the right way

946
00:26:38,240 --> 00:26:42,000
to do this by the way

947
00:26:39,440 --> 00:26:43,279
or the best way most secure way is to

948
00:26:42,000 --> 00:26:45,039
look at these specific

949
00:26:43,279 --> 00:26:46,480
certificate fingerprints that's the

950
00:26:45,039 --> 00:26:49,279
right way

951
00:26:46,480 --> 00:26:50,559
you tell what a lot of folks do they

952
00:26:49,279 --> 00:26:51,760
parse the certificate

953
00:26:50,559 --> 00:26:53,200
they don't even check to see the

954
00:26:51,760 --> 00:26:53,919
signatures correct by the way in a lot

955
00:26:53,200 --> 00:26:55,840
of cases

956
00:26:53,919 --> 00:26:57,760
they parse the certificate and they

957
00:26:55,840 --> 00:27:00,799
check to see is the principal name

958
00:26:57,760 --> 00:27:01,039
mine now i'm going to go ahead and put

959
00:27:00,799 --> 00:27:03,440
an

960
00:27:01,039 --> 00:27:04,960
x over here as bad but but i want to

961
00:27:03,440 --> 00:27:06,720
kind of throw out here that

962
00:27:04,960 --> 00:27:08,400
doing the certificate fingerprint is

963
00:27:06,720 --> 00:27:10,320
less flexible because

964
00:27:08,400 --> 00:27:12,000
as i go update my certificate every

965
00:27:10,320 --> 00:27:13,760
certificate should expire

966
00:27:12,000 --> 00:27:15,679
definitely the the authentic code ones

967
00:27:13,760 --> 00:27:17,279
do and if i'm only going to trust a

968
00:27:15,679 --> 00:27:18,559
particular certificate fingerprint and i

969
00:27:17,279 --> 00:27:20,240
don't have my new cert yet

970
00:27:18,559 --> 00:27:22,320
let's say it's outside distribute

971
00:27:20,240 --> 00:27:24,720
software and a year later

972
00:27:22,320 --> 00:27:26,000
i need to basically a year later i need

973
00:27:24,720 --> 00:27:27,840
to distribute an update

974
00:27:26,000 --> 00:27:29,679
but nine months after that my nine

975
00:27:27,840 --> 00:27:30,399
months after i'd pushed the original

976
00:27:29,679 --> 00:27:32,320
software

977
00:27:30,399 --> 00:27:35,039
my certificate expired and i needed to

978
00:27:32,320 --> 00:27:36,559
get a new certificate

979
00:27:35,039 --> 00:27:38,399
i don't have the new fingerprint right

980
00:27:36,559 --> 00:27:40,000
so how do we deal with that well

981
00:27:38,399 --> 00:27:41,760
lots of folks think ahead around that or

982
00:27:40,000 --> 00:27:43,520
they get bit by that whatever the case

983
00:27:41,760 --> 00:27:44,879
is and alas they're like uh i'll just

984
00:27:43,520 --> 00:27:46,720
check the principal name

985
00:27:44,880 --> 00:27:48,640
well listen the principal name i can

986
00:27:46,720 --> 00:27:51,279
create self-signed certificates with

987
00:27:48,640 --> 00:27:52,399
any principal name now i'm not going to

988
00:27:51,279 --> 00:27:53,919
tell you that some vendors could

989
00:27:52,399 --> 00:27:54,559
supposedly have fallen victim to this in

990
00:27:53,919 --> 00:27:55,840
the past

991
00:27:54,559 --> 00:27:57,918
i'm definitely not going to tell you

992
00:27:55,840 --> 00:27:58,240
that right but but if i were to tell you

993
00:27:57,919 --> 00:28:00,720
that

994
00:27:58,240 --> 00:28:02,399
you probably wouldn't be surprised now

995
00:28:00,720 --> 00:28:04,320
in a specific case when i said by the

996
00:28:02,399 --> 00:28:04,799
way kind of subliminal man kaspersky

997
00:28:04,320 --> 00:28:07,200
there

998
00:28:04,799 --> 00:28:08,240
in their case it was actually a

999
00:28:07,200 --> 00:28:10,480
basically it was their

1000
00:28:08,240 --> 00:28:12,399
https man in the middle so we can

1001
00:28:10,480 --> 00:28:13,760
monitor your browser for totally good

1002
00:28:12,399 --> 00:28:15,600
reasons of course

1003
00:28:13,760 --> 00:28:17,520
stuff there right so that was it it

1004
00:28:15,600 --> 00:28:18,959
wasn't an update for the software but i

1005
00:28:17,520 --> 00:28:20,480
can tell you that a lot of software

1006
00:28:18,960 --> 00:28:21,600
updates do the same thing they literally

1007
00:28:20,480 --> 00:28:23,760
look at the certificate

1008
00:28:21,600 --> 00:28:25,279
and they say oh oh i recognize you right

1009
00:28:23,760 --> 00:28:26,879
because the principal name is correct

1010
00:28:25,279 --> 00:28:28,720
and they don't even validate it's email

1011
00:28:26,880 --> 00:28:30,320
legitimate certificate so definitely be

1012
00:28:28,720 --> 00:28:32,240
on the lookout for that that's another

1013
00:28:30,320 --> 00:28:33,600
great way to get in and cause some

1014
00:28:32,240 --> 00:28:35,360
opponents

1015
00:28:33,600 --> 00:28:37,360
let's get into some case studies because

1016
00:28:35,360 --> 00:28:38,719
infosec needs more michael bay moments

1017
00:28:37,360 --> 00:28:40,879
too many of our talks

1018
00:28:38,720 --> 00:28:42,799
we do a lot of theory and not a lot else

1019
00:28:40,880 --> 00:28:44,480
and uh sure enough my explosions didn't

1020
00:28:42,799 --> 00:28:46,480
go off there they just went to like

1021
00:28:44,480 --> 00:28:47,840
nothing so that that sucks right

1022
00:28:46,480 --> 00:28:49,840
i actually had explosions that were

1023
00:28:47,840 --> 00:28:52,158
supposed to whatever

1024
00:28:49,840 --> 00:28:53,678
anyway let's do some advanced system

1025
00:28:52,159 --> 00:28:55,039
care here right i never heard of this

1026
00:28:53,679 --> 00:28:56,799
application by the way

1027
00:28:55,039 --> 00:28:58,399
lest someone think that i am picking on

1028
00:28:56,799 --> 00:29:00,158
apps i'm absolutely not

1029
00:28:58,399 --> 00:29:01,520
i went to a site called major geeks if

1030
00:29:00,159 --> 00:29:03,120
you're not familiar with major geeks

1031
00:29:01,520 --> 00:29:05,918
they are an awesome project

1032
00:29:03,120 --> 00:29:08,399
by which they go and find software that

1033
00:29:05,919 --> 00:29:11,039
they confirm is spyware free

1034
00:29:08,399 --> 00:29:12,158
and they distribute it to or basically

1035
00:29:11,039 --> 00:29:14,080
where they can distribute

1036
00:29:12,159 --> 00:29:15,520
it they have some links too that they've

1037
00:29:14,080 --> 00:29:17,760
confirmed or spyware free

1038
00:29:15,520 --> 00:29:18,879
but where they can basically uh adware

1039
00:29:17,760 --> 00:29:20,480
spyware etc

1040
00:29:18,880 --> 00:29:22,480
um where they can they host that on

1041
00:29:20,480 --> 00:29:23,760
their own site and then they let

1042
00:29:22,480 --> 00:29:25,200
basically will uh

1043
00:29:23,760 --> 00:29:27,200
what we'll have folks download from

1044
00:29:25,200 --> 00:29:29,120
there a lot of elderly and folks that

1045
00:29:27,200 --> 00:29:31,120
are less computer sophisticated

1046
00:29:29,120 --> 00:29:32,239
use this i believe it actually started

1047
00:29:31,120 --> 00:29:34,479
when the dudes uh

1048
00:29:32,240 --> 00:29:35,919
you know had run by a husband wife pair

1049
00:29:34,480 --> 00:29:37,840
but uh when the dudes uh

1050
00:29:35,919 --> 00:29:40,159
elderly whoever's called him and said

1051
00:29:37,840 --> 00:29:41,439
hey you know i downloaded the software

1052
00:29:40,159 --> 00:29:45,039
and then i got infected

1053
00:29:41,440 --> 00:29:46,000
and and i so felt i just felt bad for

1054
00:29:45,039 --> 00:29:48,000
you know for them

1055
00:29:46,000 --> 00:29:49,120
that that sucked so so what do we think

1056
00:29:48,000 --> 00:29:51,760
about this

1057
00:29:49,120 --> 00:29:52,719
this is interesting we went and oh

1058
00:29:51,760 --> 00:29:54,480
actually before i

1059
00:29:52,720 --> 00:29:56,000
gave the plug for major geeks and i've

1060
00:29:54,480 --> 00:29:56,960
lost lost track they're called up my

1061
00:29:56,000 --> 00:29:59,039
adhd

1062
00:29:56,960 --> 00:30:00,640
um anyway as far as the apps that we're

1063
00:29:59,039 --> 00:30:01,279
gonna look at today i went to major

1064
00:30:00,640 --> 00:30:03,520
geeks

1065
00:30:01,279 --> 00:30:05,520
and i sorted i went to like utilities

1066
00:30:03,520 --> 00:30:06,879
and because utilities tend to start

1067
00:30:05,520 --> 00:30:09,120
things like services

1068
00:30:06,880 --> 00:30:10,480
and i wanted stuff that wasn't just like

1069
00:30:09,120 --> 00:30:11,600
by the way too if you go look at regular

1070
00:30:10,480 --> 00:30:14,399
user applications

1071
00:30:11,600 --> 00:30:15,760
it's a absolute poop show out there i

1072
00:30:14,399 --> 00:30:17,520
actually wanted stuff that was going to

1073
00:30:15,760 --> 00:30:18,240
run in an elevated context it wasn't

1074
00:30:17,520 --> 00:30:20,000
stuff that

1075
00:30:18,240 --> 00:30:21,440
i mean you know don't get me wrong i'll

1076
00:30:20,000 --> 00:30:23,840
take code execution any day of the week

1077
00:30:21,440 --> 00:30:26,399
but code execution in elevated context

1078
00:30:23,840 --> 00:30:28,080
already just sounds cooler this advanced

1079
00:30:26,399 --> 00:30:29,600
system care is one of these applications

1080
00:30:28,080 --> 00:30:30,720
when i went to utilities i sorted by

1081
00:30:29,600 --> 00:30:32,080
date and i said hey

1082
00:30:30,720 --> 00:30:33,919
show me the new stuff right because i

1083
00:30:32,080 --> 00:30:36,080
didn't want to be accused of

1084
00:30:33,919 --> 00:30:37,279
providing you examples of stuff that was

1085
00:30:36,080 --> 00:30:39,360
like 10 years old

1086
00:30:37,279 --> 00:30:41,120
the oldest thing that i downloaded was

1087
00:30:39,360 --> 00:30:43,120
built in like the middle of february

1088
00:30:41,120 --> 00:30:44,158
so so this is all up to the date you

1089
00:30:43,120 --> 00:30:45,918
know up to date

1090
00:30:44,159 --> 00:30:47,360
software you know with up-to-date

1091
00:30:45,919 --> 00:30:48,880
versioning and all that

1092
00:30:47,360 --> 00:30:50,959
i'm advanced system care is still an

1093
00:30:48,880 --> 00:30:52,480
answer my email sucks to be them

1094
00:30:50,960 --> 00:30:54,720
at least i didn't argue in the email so

1095
00:30:52,480 --> 00:30:55,360
i guess maybe they're ahead i'm not sure

1096
00:30:54,720 --> 00:30:57,840
whether

1097
00:30:55,360 --> 00:30:59,918
whatever anyway basically it promises to

1098
00:30:57,840 --> 00:31:01,279
clean your system of unwanted files and

1099
00:30:59,919 --> 00:31:02,799
register keys and i'm gonna go ahead and

1100
00:31:01,279 --> 00:31:04,799
throw out here and say that this now is

1101
00:31:02,799 --> 00:31:06,639
one of my unwanted files in general

1102
00:31:04,799 --> 00:31:08,559
advanced system care definitely follows

1103
00:31:06,640 --> 00:31:10,320
falls into that into that space

1104
00:31:08,559 --> 00:31:12,799
we fire up procmond and i start looking

1105
00:31:10,320 --> 00:31:14,559
at process create and right off the bat

1106
00:31:12,799 --> 00:31:15,918
i see sketch tasks now if you're not

1107
00:31:14,559 --> 00:31:17,519
feeling those sketch tasks

1108
00:31:15,919 --> 00:31:19,039
you probably should be i'm also going to

1109
00:31:17,519 --> 00:31:19,760
mention here if you're one of our blue

1110
00:31:19,039 --> 00:31:21,279
team folks

1111
00:31:19,760 --> 00:31:23,679
you know now i don't know who's online

1112
00:31:21,279 --> 00:31:25,440
here obviously but in deadwood last year

1113
00:31:23,679 --> 00:31:27,360
we had way more blue team folks there

1114
00:31:25,440 --> 00:31:27,760
honestly than red and i'll just mention

1115
00:31:27,360 --> 00:31:29,519
here

1116
00:31:27,760 --> 00:31:31,200
that when you see processes kicking off

1117
00:31:29,519 --> 00:31:35,200
from sis wow 64

1118
00:31:31,200 --> 00:31:37,440
this is a huge huge thing to look for

1119
00:31:35,200 --> 00:31:38,320
in your uh in your logs and the reason

1120
00:31:37,440 --> 00:31:40,080
for this is

1121
00:31:38,320 --> 00:31:42,639
that a lot of third-party apps you know

1122
00:31:40,080 --> 00:31:45,600
the vulnerable stuff that gets exploited

1123
00:31:42,640 --> 00:31:47,039
a lot of that is a preponderance of it

1124
00:31:45,600 --> 00:31:49,760
is still x86

1125
00:31:47,039 --> 00:31:50,559
and when they call a program without the

1126
00:31:49,760 --> 00:31:52,720
path

1127
00:31:50,559 --> 00:31:54,080
when they say fire up sketch task it

1128
00:31:52,720 --> 00:31:56,799
goes and grabs it from

1129
00:31:54,080 --> 00:31:57,918
sis wow 64 the 32-bit directory instead

1130
00:31:56,799 --> 00:32:00,799
of system 32

1131
00:31:57,919 --> 00:32:01,360
the 64-bit directory this right here to

1132
00:32:00,799 --> 00:32:03,679
me

1133
00:32:01,360 --> 00:32:05,039
first off if i'm a blue teamer this says

1134
00:32:03,679 --> 00:32:06,559
something very very special i should

1135
00:32:05,039 --> 00:32:07,440
have changed the pen color to blue here

1136
00:32:06,559 --> 00:32:08,879
before i did that

1137
00:32:07,440 --> 00:32:10,880
you'll have to forgive me here let's see

1138
00:32:08,880 --> 00:32:12,320
if we can get a blue up here there we go

1139
00:32:10,880 --> 00:32:14,480
right so the blue teamer

1140
00:32:12,320 --> 00:32:16,879
this scares me right this says i

1141
00:32:14,480 --> 00:32:19,519
probably have exploitation someplace

1142
00:32:16,880 --> 00:32:20,799
and why is this thing calling now i say

1143
00:32:19,519 --> 00:32:22,640
exploitation in some ways obviously it's

1144
00:32:20,799 --> 00:32:23,679
a legitimate application it's doing it

1145
00:32:22,640 --> 00:32:25,279
but it's something you want to pay

1146
00:32:23,679 --> 00:32:26,159
attention to because by and large

1147
00:32:25,279 --> 00:32:28,080
attackers

1148
00:32:26,159 --> 00:32:29,919
compromise these third-party apps and

1149
00:32:28,080 --> 00:32:31,600
when they do they get 32-bit permission

1150
00:32:29,919 --> 00:32:33,120
or sorry 32-bit environment

1151
00:32:31,600 --> 00:32:35,080
and then when they call and say run me a

1152
00:32:33,120 --> 00:32:38,399
command prompt just says wow 64

1153
00:32:35,080 --> 00:32:39,840
cmd.exe when i see this as a red teamer

1154
00:32:38,399 --> 00:32:41,279
and i'd have drawn a red and a blue box

1155
00:32:39,840 --> 00:32:42,320
around here regardless right when i see

1156
00:32:41,279 --> 00:32:44,240
it as a red teamer

1157
00:32:42,320 --> 00:32:46,158
what i'm thinking immediately is they

1158
00:32:44,240 --> 00:32:47,919
just called something without a path

1159
00:32:46,159 --> 00:32:50,720
now that immediately for me has my

1160
00:32:47,919 --> 00:32:53,760
little lizard brain going and thinking

1161
00:32:50,720 --> 00:32:57,120
but immediately i start looking at this

1162
00:32:53,760 --> 00:32:58,399
what is this what is asc well asc

1163
00:32:57,120 --> 00:33:02,000
advanced system care

1164
00:32:58,399 --> 00:33:04,559
asc skip uac ie user

1165
00:33:02,000 --> 00:33:05,200
well i user is my my username that's

1166
00:33:04,559 --> 00:33:08,240
cool

1167
00:33:05,200 --> 00:33:11,360
what a skip uac hmm

1168
00:33:08,240 --> 00:33:11,840
it turns out here that advanced system

1169
00:33:11,360 --> 00:33:15,279
care

1170
00:33:11,840 --> 00:33:16,639
is writing a task and then executing the

1171
00:33:15,279 --> 00:33:19,200
task

1172
00:33:16,640 --> 00:33:21,760
my friends do you know what this is when

1173
00:33:19,200 --> 00:33:23,760
you write a task and then execute a task

1174
00:33:21,760 --> 00:33:25,440
this is what i like to call a zoom zoom

1175
00:33:23,760 --> 00:33:27,760
or a dale earnhardt condition

1176
00:33:25,440 --> 00:33:28,559
a race condition they are writing the

1177
00:33:27,760 --> 00:33:30,799
task

1178
00:33:28,559 --> 00:33:32,720
and then they are executing set tasks by

1179
00:33:30,799 --> 00:33:34,879
the way do a little bit of testing here

1180
00:33:32,720 --> 00:33:36,559
and uh not only can you win that race

1181
00:33:34,880 --> 00:33:38,159
that they are running here

1182
00:33:36,559 --> 00:33:40,158
um you can also and by the way we're

1183
00:33:38,159 --> 00:33:41,279
skipping uac there's a reason for that

1184
00:33:40,159 --> 00:33:42,480
and that's because it's running in

1185
00:33:41,279 --> 00:33:45,200
elevated context

1186
00:33:42,480 --> 00:33:46,960
i'm super happy about that and uh so if

1187
00:33:45,200 --> 00:33:48,960
i come back here and i win that race

1188
00:33:46,960 --> 00:33:50,559
that's cool it turns out you can also

1189
00:33:48,960 --> 00:33:52,880
create the task ahead of time

1190
00:33:50,559 --> 00:33:54,320
which is another really neat thing to go

1191
00:33:52,880 --> 00:33:56,240
do right because if you are

1192
00:33:54,320 --> 00:33:57,200
a regular user on the box there's

1193
00:33:56,240 --> 00:33:58,399
nothing that prevents you from

1194
00:33:57,200 --> 00:34:00,080
scheduling a task

1195
00:33:58,399 --> 00:34:01,760
of the name of another user on the box

1196
00:34:00,080 --> 00:34:04,158
you might also go run advanced system

1197
00:34:01,760 --> 00:34:05,760
care later in elevated contacts and

1198
00:34:04,159 --> 00:34:07,279
woohoo right you don't have to be

1199
00:34:05,760 --> 00:34:08,800
elevated to go write the task in the

1200
00:34:07,279 --> 00:34:10,239
first place right it's a picture here on

1201
00:34:08,800 --> 00:34:12,320
a multi-user machine

1202
00:34:10,239 --> 00:34:14,560
and you've got stuff set up and game on

1203
00:34:12,320 --> 00:34:15,520
right so um you then write the task for

1204
00:34:14,560 --> 00:34:17,040
the other user

1205
00:34:15,520 --> 00:34:19,040
the other user later when they go run

1206
00:34:17,040 --> 00:34:22,320
this runs your task instead of

1207
00:34:19,040 --> 00:34:25,759
the ask that asc was going to write

1208
00:34:22,320 --> 00:34:28,800
but but wait there's more because

1209
00:34:25,760 --> 00:34:30,560
they call my friend nutshell now if you

1210
00:34:28,800 --> 00:34:33,599
were dead with last year you know

1211
00:34:30,560 --> 00:34:36,719
i talked about my go to

1212
00:34:33,599 --> 00:34:37,679
binary for this is net sh it's always

1213
00:34:36,719 --> 00:34:39,040
net sh

1214
00:34:37,679 --> 00:34:40,240
i don't know what it is about network

1215
00:34:39,040 --> 00:34:41,520
actually i do know what it is but that's

1216
00:34:40,239 --> 00:34:43,678
not important for this

1217
00:34:41,520 --> 00:34:45,759
networking apis are a pain in the butt

1218
00:34:43,679 --> 00:34:46,720
and as a result of networking apis being

1219
00:34:45,760 --> 00:34:49,679
a pain in the butt

1220
00:34:46,719 --> 00:34:52,000
what we see a lot of the time is we see

1221
00:34:49,679 --> 00:34:52,879
developers calling net sh to go get

1222
00:34:52,000 --> 00:34:55,280
information

1223
00:34:52,879 --> 00:34:57,200
instead of calling the apis this is

1224
00:34:55,280 --> 00:34:59,359
generally not a winning move

1225
00:34:57,200 --> 00:35:01,359
generally not a winning move can anybody

1226
00:34:59,359 --> 00:35:02,640
tell me sadly i'm not logged into

1227
00:35:01,359 --> 00:35:03,359
discord so i'm not gonna be able to see

1228
00:35:02,640 --> 00:35:05,118
this but

1229
00:35:03,359 --> 00:35:06,480
i'm sure john is modern discord does

1230
00:35:05,119 --> 00:35:08,000
anybody see the vulnerability here

1231
00:35:06,480 --> 00:35:10,640
before i disclose it

1232
00:35:08,000 --> 00:35:12,079
let me see what the problem is there's a

1233
00:35:10,640 --> 00:35:13,359
huge problem here

1234
00:35:12,079 --> 00:35:15,440
it's the same problem that we haven't

1235
00:35:13,359 --> 00:35:16,720
confirmed from the last one notice here

1236
00:35:15,440 --> 00:35:18,240
it shows the path

1237
00:35:16,720 --> 00:35:20,078
it says hey here's what actually ran

1238
00:35:18,240 --> 00:35:20,720
it's system 32 net sh and i'm like

1239
00:35:20,079 --> 00:35:23,200
woohoo

1240
00:35:20,720 --> 00:35:24,720
neat right but here's the command line

1241
00:35:23,200 --> 00:35:27,919
and the thing that's missing here

1242
00:35:24,720 --> 00:35:29,279
is the c windows

1243
00:35:27,920 --> 00:35:31,599
and i'm not going to write all this out

1244
00:35:29,280 --> 00:35:32,400
because it sucks to draw with a mouse

1245
00:35:31,599 --> 00:35:35,280
like this

1246
00:35:32,400 --> 00:35:36,960
it's a c windows system 32 net sh and

1247
00:35:35,280 --> 00:35:38,000
what this means is you now have a

1248
00:35:36,960 --> 00:35:40,320
process

1249
00:35:38,000 --> 00:35:42,400
that is running in an elevated context

1250
00:35:40,320 --> 00:35:43,599
calling net sh and just hoping it finds

1251
00:35:42,400 --> 00:35:45,599
it in the right place

1252
00:35:43,599 --> 00:35:46,880
this is not something you want this is

1253
00:35:45,599 --> 00:35:49,839
bad bad bad

1254
00:35:46,880 --> 00:35:50,560
now i am certain that when advanced

1255
00:35:49,839 --> 00:35:52,799
system care

1256
00:35:50,560 --> 00:35:53,759
finally answers my email the developer

1257
00:35:52,800 --> 00:35:55,920
will argue with me

1258
00:35:53,760 --> 00:35:58,320
like many have before that this is not

1259
00:35:55,920 --> 00:36:00,240
bad and it's not bad on their machines

1260
00:35:58,320 --> 00:36:00,720
because nobody can write anywhere in the

1261
00:36:00,240 --> 00:36:03,359
path

1262
00:36:00,720 --> 00:36:04,959
for them and they don't have if you were

1263
00:36:03,359 --> 00:36:06,799
my dead would talk last year we talked

1264
00:36:04,960 --> 00:36:08,320
all about the ability to go add files

1265
00:36:06,800 --> 00:36:10,880
the add file permission

1266
00:36:08,320 --> 00:36:12,720
in uh basically an ntfs and that's set

1267
00:36:10,880 --> 00:36:13,760
on a lot of program files directories

1268
00:36:12,720 --> 00:36:16,480
it's also set

1269
00:36:13,760 --> 00:36:17,839
by default on the root of your drives in

1270
00:36:16,480 --> 00:36:19,680
which case if somebody does a

1271
00:36:17,839 --> 00:36:21,520
non-standard installation and installs

1272
00:36:19,680 --> 00:36:22,560
this outside of program files they very

1273
00:36:21,520 --> 00:36:24,800
likely have

1274
00:36:22,560 --> 00:36:26,400
the add files permission which means i

1275
00:36:24,800 --> 00:36:28,160
can add a net sh

1276
00:36:26,400 --> 00:36:29,839
and what do you know the first path

1277
00:36:28,160 --> 00:36:31,440
that's called the first place that they

1278
00:36:29,839 --> 00:36:33,520
look for net sh

1279
00:36:31,440 --> 00:36:34,800
well yeah what are the odds again is in

1280
00:36:33,520 --> 00:36:36,400
the program directory

1281
00:36:34,800 --> 00:36:38,400
where advanced system care is running

1282
00:36:36,400 --> 00:36:40,400
from again and not a winning move here

1283
00:36:38,400 --> 00:36:42,000
right so again here we are not doing any

1284
00:36:40,400 --> 00:36:44,400
vulnerability hunting or sorry

1285
00:36:42,000 --> 00:36:46,079
not doing any reversing and yet now

1286
00:36:44,400 --> 00:36:47,520
we're up to two vulnerabilities

1287
00:36:46,079 --> 00:36:49,760
i'm an advanced system care and here

1288
00:36:47,520 --> 00:36:51,759
we're looking at about 30 minutes in

1289
00:36:49,760 --> 00:36:52,880
it's about counting the time to install

1290
00:36:51,760 --> 00:36:54,320
about 30 minutes in

1291
00:36:52,880 --> 00:36:55,839
and if you needed to know for sure that

1292
00:36:54,320 --> 00:36:56,640
this was really happening here you can

1293
00:36:55,839 --> 00:36:58,799
see it happening

1294
00:36:56,640 --> 00:37:00,720
so notice here we have the calls for

1295
00:36:58,800 --> 00:37:02,400
create files and again this package

1296
00:37:00,720 --> 00:37:03,759
installer inherits permission so i do

1297
00:37:02,400 --> 00:37:05,359
want to give them props

1298
00:37:03,760 --> 00:37:07,280
mom said if you can't say anything nice

1299
00:37:05,359 --> 00:37:08,480
about somebody don't say anything at all

1300
00:37:07,280 --> 00:37:09,599
i'm going to say something nice i'm

1301
00:37:08,480 --> 00:37:10,320
going to say at least they did that

1302
00:37:09,599 --> 00:37:11,920
right

1303
00:37:10,320 --> 00:37:13,680
i'm happy that they did that right but

1304
00:37:11,920 --> 00:37:14,400
notice here again you can see very

1305
00:37:13,680 --> 00:37:16,480
clearly

1306
00:37:14,400 --> 00:37:17,680
that net sh they looked for it here they

1307
00:37:16,480 --> 00:37:19,440
just didn't find it

1308
00:37:17,680 --> 00:37:21,040
if they find it here they will execute

1309
00:37:19,440 --> 00:37:23,280
it i can tell you this categorically

1310
00:37:21,040 --> 00:37:25,119
because well my code execution so game

1311
00:37:23,280 --> 00:37:26,160
on right also again if you go install

1312
00:37:25,119 --> 00:37:28,720
this in the root

1313
00:37:26,160 --> 00:37:30,160
of your drive again by default instead

1314
00:37:28,720 --> 00:37:31,439
of the program files directory

1315
00:37:30,160 --> 00:37:32,879
by default it's going to inherit those

1316
00:37:31,440 --> 00:37:34,400
permissions again as well remember it

1317
00:37:32,880 --> 00:37:36,160
inherits permissions and the inherited

1318
00:37:34,400 --> 00:37:38,560
permission allows you to add files and

1319
00:37:36,160 --> 00:37:38,560
folders

1320
00:37:39,119 --> 00:37:43,599
and then i'm down to what are these

1321
00:37:41,920 --> 00:37:44,800
right now sketch tasks you already know

1322
00:37:43,599 --> 00:37:46,400
about sketch tasks we already have a

1323
00:37:44,800 --> 00:37:47,520
race condition here you have the double

1324
00:37:46,400 --> 00:37:49,680
problem there

1325
00:37:47,520 --> 00:37:51,520
same deal i don't even know what these

1326
00:37:49,680 --> 00:37:53,440
are i didn't have time to go

1327
00:37:51,520 --> 00:37:55,359
to go find these what i am going to do

1328
00:37:53,440 --> 00:37:56,160
is i am going to publish links on major

1329
00:37:55,359 --> 00:37:57,440
geeks again

1330
00:37:56,160 --> 00:37:59,520
if you follow me on twitter you'll see

1331
00:37:57,440 --> 00:38:01,040
this here very quickly and uh

1332
00:37:59,520 --> 00:38:02,960
i'll publish links you can go download

1333
00:38:01,040 --> 00:38:04,720
these and play at home right one of the

1334
00:38:02,960 --> 00:38:06,000
things that separates wob was hack fest

1335
00:38:04,720 --> 00:38:07,759
from a lot of conferences

1336
00:38:06,000 --> 00:38:09,280
again we're virtual this year so so a

1337
00:38:07,760 --> 00:38:10,480
little bit less than i said this year

1338
00:38:09,280 --> 00:38:12,720
this this time around

1339
00:38:10,480 --> 00:38:13,920
a little bit less uh you know hands-on

1340
00:38:12,720 --> 00:38:15,919
than we're used to

1341
00:38:13,920 --> 00:38:17,520
but i mean it is a very hands-on

1342
00:38:15,920 --> 00:38:19,599
conference and i have to give john and

1343
00:38:17,520 --> 00:38:21,759
his team mad props for that because

1344
00:38:19,599 --> 00:38:23,040
man it is just wow and i want to make

1345
00:38:21,760 --> 00:38:24,240
sure here that i'm not just like

1346
00:38:23,040 --> 00:38:26,079
throwing a bunch of stuff out or folks

1347
00:38:24,240 --> 00:38:27,279
like well that's neat how do i do that

1348
00:38:26,079 --> 00:38:28,720
i'm going to send you links to the

1349
00:38:27,280 --> 00:38:30,720
installers and if somebody takes them

1350
00:38:28,720 --> 00:38:32,959
down i'll just post them somewhere else

1351
00:38:30,720 --> 00:38:34,399
alas meaning like if major geeks or

1352
00:38:32,960 --> 00:38:34,880
somebody else forces them to take them

1353
00:38:34,400 --> 00:38:36,160
down

1354
00:38:34,880 --> 00:38:37,599
maybe we'll bit torrent those i don't

1355
00:38:36,160 --> 00:38:38,399
know something to make sure that those

1356
00:38:37,599 --> 00:38:40,480
are still out here

1357
00:38:38,400 --> 00:38:42,160
so that you too can go work through this

1358
00:38:40,480 --> 00:38:42,800
after you download a vm from modern dot

1359
00:38:42,160 --> 00:38:44,720
ie

1360
00:38:42,800 --> 00:38:46,480
that said as we start getting into a

1361
00:38:44,720 --> 00:38:48,160
little bit more you see sketch tasks

1362
00:38:46,480 --> 00:38:50,320
and then this one i don't even know what

1363
00:38:48,160 --> 00:38:51,839
this hot mess of madness is over here

1364
00:38:50,320 --> 00:38:53,599
but but again you know and i don't want

1365
00:38:51,839 --> 00:38:56,400
to use the word where don't use the

1366
00:38:53,599 --> 00:38:58,000
words where there's smoke there's fire

1367
00:38:56,400 --> 00:38:59,599
but can we all agree that when you see

1368
00:38:58,000 --> 00:39:01,839
just weirdness like

1369
00:38:59,599 --> 00:39:02,720
stupid weird what that deuces that

1370
00:39:01,839 --> 00:39:05,119
weirdness

1371
00:39:02,720 --> 00:39:06,799
that maybe there might be structurally

1372
00:39:05,119 --> 00:39:08,160
underlying problems with the

1373
00:39:06,800 --> 00:39:10,640
i mean like for instance if you're gonna

1374
00:39:08,160 --> 00:39:11,520
go buy a house right i may not be a home

1375
00:39:10,640 --> 00:39:13,520
inspector

1376
00:39:11,520 --> 00:39:14,640
and i may not be a foundation inspector

1377
00:39:13,520 --> 00:39:16,720
i certainly am not

1378
00:39:14,640 --> 00:39:17,920
but if i for instance walked in and i

1379
00:39:16,720 --> 00:39:20,319
saw the light switches

1380
00:39:17,920 --> 00:39:21,520
installed sideways and i saw a ceiling

1381
00:39:20,320 --> 00:39:23,200
fan that was supposed to have five

1382
00:39:21,520 --> 00:39:24,800
blades that had four blades

1383
00:39:23,200 --> 00:39:26,960
i might assume that there's a lot of

1384
00:39:24,800 --> 00:39:28,320
stuff i can't see that's also effed up

1385
00:39:26,960 --> 00:39:30,240
and i'm just going to go ahead and tell

1386
00:39:28,320 --> 00:39:31,520
you here i see some stuff that concerns

1387
00:39:30,240 --> 00:39:33,520
me just a wee bit

1388
00:39:31,520 --> 00:39:35,119
and and i'll also say i am confident

1389
00:39:33,520 --> 00:39:37,040
there's a lot of stuff left to find

1390
00:39:35,119 --> 00:39:38,320
in advanced system care but if anybody's

1391
00:39:37,040 --> 00:39:40,000
keeping track at home

1392
00:39:38,320 --> 00:39:41,599
that is uh i don't want to play like the

1393
00:39:40,000 --> 00:39:43,280
count uh you know the

1394
00:39:41,599 --> 00:39:45,920
account from a sesame street here but

1395
00:39:43,280 --> 00:39:47,520
that's three three vulnerabilities in

1396
00:39:45,920 --> 00:39:49,119
literally an hour seriously it was it

1397
00:39:47,520 --> 00:39:50,880
was in the past in the space of an hour

1398
00:39:49,119 --> 00:39:53,680
that we discovered the sketch tasks

1399
00:39:50,880 --> 00:39:55,680
sketch task injection we discovered the

1400
00:39:53,680 --> 00:39:56,879
uh discovered the net sh injection

1401
00:39:55,680 --> 00:39:58,799
as well as the race condition with

1402
00:39:56,880 --> 00:40:00,160
sketch tasks as well so again

1403
00:39:58,800 --> 00:40:02,160
coming back to sketch tasks these are

1404
00:40:00,160 --> 00:40:04,078
not the sketch tasks you're looking for

1405
00:40:02,160 --> 00:40:06,160
and it's not just one sketch task that's

1406
00:40:04,079 --> 00:40:07,359
the problem like when i talk about like

1407
00:40:06,160 --> 00:40:09,839
people screwing stuff up

1408
00:40:07,359 --> 00:40:11,040
they do it again and again and again

1409
00:40:09,839 --> 00:40:12,560
event sentry

1410
00:40:11,040 --> 00:40:14,160
this one is the one that john and i had

1411
00:40:12,560 --> 00:40:15,440
a little bit deeper conversation about

1412
00:40:14,160 --> 00:40:17,040
because while he and i had never heard

1413
00:40:15,440 --> 00:40:17,839
of advanced system care we both know

1414
00:40:17,040 --> 00:40:19,119
this one

1415
00:40:17,839 --> 00:40:20,560
and i want to tell you there's plenty

1416
00:40:19,119 --> 00:40:22,000
left to find an event century i'm just

1417
00:40:20,560 --> 00:40:23,920
showing some of the greatest hits here

1418
00:40:22,000 --> 00:40:25,680
there's obvious lack of an sdlc or i

1419
00:40:23,920 --> 00:40:26,640
mentioned before i don't care about cves

1420
00:40:25,680 --> 00:40:29,440
but if you want one

1421
00:40:26,640 --> 00:40:30,560
download event sentry anyway there's

1422
00:40:29,440 --> 00:40:32,960
where there's smoke man

1423
00:40:30,560 --> 00:40:35,520
there's just fire and i started up here

1424
00:40:32,960 --> 00:40:37,920
and i have to tell you my blood ran cold

1425
00:40:35,520 --> 00:40:39,359
my blood ran cold because i started

1426
00:40:37,920 --> 00:40:42,800
installing this

1427
00:40:39,359 --> 00:40:46,160
and it called reg not once not twice

1428
00:40:42,800 --> 00:40:47,599
not three times but nine total times i

1429
00:40:46,160 --> 00:40:48,960
have seven of them up there

1430
00:40:47,599 --> 00:40:50,839
and there's another two that happen

1431
00:40:48,960 --> 00:40:52,760
later nine total times it called during

1432
00:40:50,839 --> 00:40:54,720
installation that's

1433
00:40:52,760 --> 00:40:55,680
absolutely nuts and then i thought

1434
00:40:54,720 --> 00:40:58,160
immediately like

1435
00:40:55,680 --> 00:41:00,560
woohoo trusted installer permissions for

1436
00:40:58,160 --> 00:41:00,560
the win

1437
00:41:01,040 --> 00:41:05,759
and then i fired up and i found out that

1438
00:41:03,599 --> 00:41:08,000
no no i only i only get

1439
00:41:05,760 --> 00:41:10,000
i only get admin permissions right i'm

1440
00:41:08,000 --> 00:41:12,160
only getting admin permissions but

1441
00:41:10,000 --> 00:41:13,680
earlier today after seeing somebody coin

1442
00:41:12,160 --> 00:41:15,200
the term disaster voltron

1443
00:41:13,680 --> 00:41:17,040
for all the stuff that's coming together

1444
00:41:15,200 --> 00:41:18,000
you know with the you know this uh stuff

1445
00:41:17,040 --> 00:41:20,000
going on now

1446
00:41:18,000 --> 00:41:21,760
um they called the kind of a response to

1447
00:41:20,000 --> 00:41:23,599
this disaster voltron and i said that's

1448
00:41:21,760 --> 00:41:24,319
it i'm naming a vulnerability disaster

1449
00:41:23,599 --> 00:41:26,880
voltron

1450
00:41:24,319 --> 00:41:28,240
and this is the one right reg.exe being

1451
00:41:26,880 --> 00:41:30,319
called without a path

1452
00:41:28,240 --> 00:41:31,680
from the downloads directory this is my

1453
00:41:30,319 --> 00:41:33,279
friends by the way is remote code

1454
00:41:31,680 --> 00:41:34,879
execution i had to fight with the vendor

1455
00:41:33,280 --> 00:41:36,880
about this one as well

1456
00:41:34,880 --> 00:41:38,640
and i said literally i said hey guys

1457
00:41:36,880 --> 00:41:42,480
like if an attacker

1458
00:41:38,640 --> 00:41:45,279
convinces a user to download reg.exe

1459
00:41:42,480 --> 00:41:46,720
malware named reg.exe first and then

1460
00:41:45,280 --> 00:41:48,319
download your installer

1461
00:41:46,720 --> 00:41:49,919
if they're in the same directory that's

1462
00:41:48,319 --> 00:41:51,200
where it's going to run from and they're

1463
00:41:49,920 --> 00:41:53,040
like oh oh

1464
00:41:51,200 --> 00:41:54,640
that's no problem we'll go ahead and

1465
00:41:53,040 --> 00:41:55,440
hard code the path that should be easy

1466
00:41:54,640 --> 00:41:57,440
enough to do

1467
00:41:55,440 --> 00:41:58,960
and i'm like no no how about using the

1468
00:41:57,440 --> 00:42:01,200
how about using the api

1469
00:41:58,960 --> 00:42:03,359
literally there's an api for this don't

1470
00:42:01,200 --> 00:42:04,799
call reg.exe right i haven't even gotten

1471
00:42:03,359 --> 00:42:06,799
into some of the other stuff

1472
00:42:04,800 --> 00:42:08,400
stop calling external commands you don't

1473
00:42:06,800 --> 00:42:10,400
need to your programmers

1474
00:42:08,400 --> 00:42:12,960
freaking program i don't even know what

1475
00:42:10,400 --> 00:42:16,000
this is i sent this to john yesterday

1476
00:42:12,960 --> 00:42:19,119
and what i got back was a confused what

1477
00:42:16,000 --> 00:42:20,319
in all caps after i texted him this

1478
00:42:19,119 --> 00:42:22,480
you know the immortal words are on

1479
00:42:20,319 --> 00:42:24,960
burgundy i'm not even mad

1480
00:42:22,480 --> 00:42:26,240
that's just amazing right what is this

1481
00:42:24,960 --> 00:42:27,520
well it turns out that there's actually

1482
00:42:26,240 --> 00:42:30,720
an event century folder

1483
00:42:27,520 --> 00:42:33,280
inside of a system 32 somehow and

1484
00:42:30,720 --> 00:42:35,118
we think based on some other commands

1485
00:42:33,280 --> 00:42:37,040
that we see fired that they are caching

1486
00:42:35,119 --> 00:42:38,720
pngs for some reason

1487
00:42:37,040 --> 00:42:40,319
i'm not sure what that is and then

1488
00:42:38,720 --> 00:42:42,799
deleting those now this doesn't do

1489
00:42:40,319 --> 00:42:44,880
anything thankfully right but

1490
00:42:42,800 --> 00:42:47,359
but i'm still blown away like what is

1491
00:42:44,880 --> 00:42:48,079
this and i also like what are those kind

1492
00:42:47,359 --> 00:42:49,359
of thing

1493
00:42:48,079 --> 00:42:50,560
i don't even know what this is so i'm

1494
00:42:49,359 --> 00:42:51,200
just going to skip this and keep right

1495
00:42:50,560 --> 00:42:53,359
on going

1496
00:42:51,200 --> 00:42:55,118
intent there's a lot of other stuff here

1497
00:42:53,359 --> 00:42:56,240
that you could probably find uh find a

1498
00:42:55,119 --> 00:42:57,920
ball in as well

1499
00:42:56,240 --> 00:42:59,598
my last email to them were arguing i

1500
00:42:57,920 --> 00:43:00,079
said listen guys i'm done just so you

1501
00:42:59,599 --> 00:43:01,680
know

1502
00:43:00,079 --> 00:43:03,760
they're so well yeah anyway just so just

1503
00:43:01,680 --> 00:43:04,560
so you know there's you probably an sdlc

1504
00:43:03,760 --> 00:43:06,160
in a code review

1505
00:43:04,560 --> 00:43:07,680
uh this is the last volume i'm sending

1506
00:43:06,160 --> 00:43:09,520
to you and uh

1507
00:43:07,680 --> 00:43:11,759
there are definitely others and i'm sure

1508
00:43:09,520 --> 00:43:13,359
people will be looking for them so alas

1509
00:43:11,760 --> 00:43:14,800
then i started looking here and i'm like

1510
00:43:13,359 --> 00:43:17,720
well this isn't very

1511
00:43:14,800 --> 00:43:19,599
fun but what madness is this it's a

1512
00:43:17,720 --> 00:43:21,839
regedit.exe and i'm like

1513
00:43:19,599 --> 00:43:23,520
regedit and you can see like they're

1514
00:43:21,839 --> 00:43:23,920
calling it from looking for it from all

1515
00:43:23,520 --> 00:43:25,200
over

1516
00:43:23,920 --> 00:43:27,119
and by the way here too if you're not

1517
00:43:25,200 --> 00:43:29,200
familiar with this i i tried to see if i

1518
00:43:27,119 --> 00:43:32,160
get cool stealthy persistence with

1519
00:43:29,200 --> 00:43:32,640
basically with hyper-v the vmms.exe is a

1520
00:43:32,160 --> 00:43:34,078
hyper-v

1521
00:43:32,640 --> 00:43:35,759
process i tried to see if it cool

1522
00:43:34,079 --> 00:43:37,119
stealthy persistence it is

1523
00:43:35,760 --> 00:43:38,880
checking for the presence of it but it

1524
00:43:37,119 --> 00:43:40,240
doesn't execute it right i was like they

1525
00:43:38,880 --> 00:43:41,119
can't be dumb enough to try to execute

1526
00:43:40,240 --> 00:43:42,560
and sure enough they're not

1527
00:43:41,119 --> 00:43:44,160
so game on mom said if you have to say

1528
00:43:42,560 --> 00:43:45,680
something nice i gotta ask though did

1529
00:43:44,160 --> 00:43:47,200
you ever find out why they were checking

1530
00:43:45,680 --> 00:43:50,960
for the presence of it

1531
00:43:47,200 --> 00:43:53,759
well can i say yes and no

1532
00:43:50,960 --> 00:43:55,359
so so the yes is yes but but it required

1533
00:43:53,760 --> 00:43:57,200
reverse engineering and that's not that

1534
00:43:55,359 --> 00:43:57,759
my talk explicitly said we wouldn't do

1535
00:43:57,200 --> 00:43:59,680
that

1536
00:43:57,760 --> 00:44:01,359
but the short of it is seriously on the

1537
00:43:59,680 --> 00:44:02,000
s side i mean it's because they're

1538
00:44:01,359 --> 00:44:03,119
trying to

1539
00:44:02,000 --> 00:44:04,720
they're literally using that to

1540
00:44:03,119 --> 00:44:05,280
determine if they're in a hypervisor

1541
00:44:04,720 --> 00:44:07,200
which

1542
00:44:05,280 --> 00:44:08,560
i i don't understand that that i'm

1543
00:44:07,200 --> 00:44:10,000
beyond the y i didn't chase down that

1544
00:44:08,560 --> 00:44:10,880
rabbit hole but they have a hypervisor

1545
00:44:10,000 --> 00:44:15,119
check

1546
00:44:10,880 --> 00:44:17,119
okay well oh all right then carry on

1547
00:44:15,119 --> 00:44:18,400
see that's where i'm at my guess john

1548
00:44:17,119 --> 00:44:19,680
honestly is that they're setting some

1549
00:44:18,400 --> 00:44:21,839
licensing flag

1550
00:44:19,680 --> 00:44:23,520
again just just from a timing and a i

1551
00:44:21,839 --> 00:44:24,880
didn't really care anymore standpoint

1552
00:44:23,520 --> 00:44:26,160
i didn't chase down but what they're

1553
00:44:24,880 --> 00:44:28,240
doing with it afterwards but it is

1554
00:44:26,160 --> 00:44:30,560
definitely a hypervisor check

1555
00:44:28,240 --> 00:44:32,160
and then you get to this i thought

1556
00:44:30,560 --> 00:44:34,240
originally regedit.exe

1557
00:44:32,160 --> 00:44:36,720
was not a lot of fun but it is a lot of

1558
00:44:34,240 --> 00:44:37,759
fun because you start running into stuff

1559
00:44:36,720 --> 00:44:41,598
like this now

1560
00:44:37,760 --> 00:44:44,960
they use regedit.exe a lot

1561
00:44:41,599 --> 00:44:46,640
a lot now again there's an api

1562
00:44:44,960 --> 00:44:48,319
for this you don't need to use

1563
00:44:46,640 --> 00:44:50,400
regedit.exe to go

1564
00:44:48,319 --> 00:44:52,640
to set registry keys and values but they

1565
00:44:50,400 --> 00:44:53,119
do they're cool with that and so here we

1566
00:44:52,640 --> 00:44:56,240
go

1567
00:44:53,119 --> 00:44:59,040
now if you're playing along at home here

1568
00:44:56,240 --> 00:45:01,359
what is this well okay i know it's

1569
00:44:59,040 --> 00:45:03,520
percent 10 percent i got that right

1570
00:45:01,359 --> 00:45:05,359
the problem here of course there's an

1571
00:45:03,520 --> 00:45:07,680
obvious dale earnhardt condition here

1572
00:45:05,359 --> 00:45:09,520
if percent temp is writable right i have

1573
00:45:07,680 --> 00:45:10,000
bad news for you and by the way by

1574
00:45:09,520 --> 00:45:12,640
default

1575
00:45:10,000 --> 00:45:14,720
c windows temp is absolutely writable

1576
00:45:12,640 --> 00:45:16,640
you can't list all the files in it right

1577
00:45:14,720 --> 00:45:18,720
but you can add files to it

1578
00:45:16,640 --> 00:45:20,078
and oh buddy you can add files to it and

1579
00:45:18,720 --> 00:45:22,078
i'm just going to leave it there

1580
00:45:20,079 --> 00:45:23,359
and this by the way oh yeah it does show

1581
00:45:22,079 --> 00:45:24,000
i was going to say did i somehow leave

1582
00:45:23,359 --> 00:45:27,598
that off

1583
00:45:24,000 --> 00:45:29,920
this is event century svcx64.exe

1584
00:45:27,599 --> 00:45:30,960
running in the context of local system

1585
00:45:29,920 --> 00:45:32,400
and i'm not going to tell you that

1586
00:45:30,960 --> 00:45:33,040
that's the time to get up and dance a

1587
00:45:32,400 --> 00:45:34,800
jig

1588
00:45:33,040 --> 00:45:36,160
if you can go ahead and add registry

1589
00:45:34,800 --> 00:45:38,079
keys right and values

1590
00:45:36,160 --> 00:45:39,920
this is code execution slash privilege i

1591
00:45:38,079 --> 00:45:42,079
guess privilege escalation in this case

1592
00:45:39,920 --> 00:45:43,520
we'll call the other the reg.exe code

1593
00:45:42,079 --> 00:45:44,800
execution actually john

1594
00:45:43,520 --> 00:45:46,800
how are you with this what would you

1595
00:45:44,800 --> 00:45:48,079
call this you go with code execution or

1596
00:45:46,800 --> 00:45:49,760
privilege escalation here

1597
00:45:48,079 --> 00:45:51,839
anytime i get into situations like this

1598
00:45:49,760 --> 00:45:53,520
i just say why not both

1599
00:45:51,839 --> 00:45:55,279
why not both there you go i like it i

1600
00:45:53,520 --> 00:45:56,480
like it you know here i think privilege

1601
00:45:55,280 --> 00:45:58,319
escalation because i already have to be

1602
00:45:56,480 --> 00:45:59,839
on the box to affect change here

1603
00:45:58,319 --> 00:46:01,440
and i have to be active on the box to

1604
00:45:59,839 --> 00:46:03,040
affect change at the time so i feel much

1605
00:46:01,440 --> 00:46:04,480
like prevents

1606
00:46:03,040 --> 00:46:06,160
i'm going to close this out here this

1607
00:46:04,480 --> 00:46:07,440
case study uh saying don't argue with

1608
00:46:06,160 --> 00:46:09,200
researchers right because

1609
00:46:07,440 --> 00:46:10,880
they literally when i sent this in they

1610
00:46:09,200 --> 00:46:12,560
said they sent me this response back and

1611
00:46:10,880 --> 00:46:15,040
i normally don't crap on researchers or

1612
00:46:12,560 --> 00:46:16,799
sorry crap on vendors here but

1613
00:46:15,040 --> 00:46:18,160
but i'm going to here because when they

1614
00:46:16,800 --> 00:46:19,200
can't go over there like all registry

1615
00:46:18,160 --> 00:46:20,720
files should only be created in

1616
00:46:19,200 --> 00:46:22,160
directories that are not accessible to

1617
00:46:20,720 --> 00:46:25,279
regular user accounts

1618
00:46:22,160 --> 00:46:27,839
i agree i 100 agree

1619
00:46:25,280 --> 00:46:29,200
like definitely agree but you're wrong

1620
00:46:27,839 --> 00:46:32,000
you're still doing it

1621
00:46:29,200 --> 00:46:33,040
like i i'm not going to call this thing

1622
00:46:32,000 --> 00:46:34,400
a dumpster fire

1623
00:46:33,040 --> 00:46:36,240
i'm not going to tell you to uninstall

1624
00:46:34,400 --> 00:46:38,400
event sentry but if you haven't

1625
00:46:36,240 --> 00:46:40,078
what i will say is that if you are

1626
00:46:38,400 --> 00:46:41,760
running event century today as

1627
00:46:40,079 --> 00:46:43,839
unfortunately a couple of my customers

1628
00:46:41,760 --> 00:46:46,240
are what i'm going to tell you is that

1629
00:46:43,839 --> 00:46:48,799
any third-party software that you allow

1630
00:46:46,240 --> 00:46:50,560
to run on your systems and definitely

1631
00:46:48,800 --> 00:46:52,720
third-party software you allow to run

1632
00:46:50,560 --> 00:46:54,560
your systems with elevated permissions

1633
00:46:52,720 --> 00:46:55,040
you have got to do a security assessment

1634
00:46:54,560 --> 00:46:57,200
on it

1635
00:46:55,040 --> 00:46:58,720
because again the top my total time on

1636
00:46:57,200 --> 00:47:01,359
target for event century

1637
00:46:58,720 --> 00:47:02,879
is just over an hour and that is that is

1638
00:47:01,359 --> 00:47:04,880
confirming findings

1639
00:47:02,880 --> 00:47:06,640
after they argue with me about this that

1640
00:47:04,880 --> 00:47:09,200
the original reg.exe

1641
00:47:06,640 --> 00:47:10,319
were sub 15 minutes on target a couple

1642
00:47:09,200 --> 00:47:12,399
of closing thoughts

1643
00:47:10,319 --> 00:47:14,079
well i left other closing thoughts in

1644
00:47:12,400 --> 00:47:16,000
there by missing my missing slide of the

1645
00:47:14,079 --> 00:47:18,000
week okay well closing thoughts

1646
00:47:16,000 --> 00:47:19,520
don't argue with you know what forget

1647
00:47:18,000 --> 00:47:21,920
i'm going to drop it over here

1648
00:47:19,520 --> 00:47:22,559
my bad here on leaving the wrong slide

1649
00:47:21,920 --> 00:47:23,599
in the uh

1650
00:47:22,559 --> 00:47:26,000
i don't know how that's there but

1651
00:47:23,599 --> 00:47:27,200
whatever um look uh my closing thoughts

1652
00:47:26,000 --> 00:47:28,160
now you know i'm gonna back up because

1653
00:47:27,200 --> 00:47:30,160
that gets confusing

1654
00:47:28,160 --> 00:47:32,000
closing thoughts do security assessment

1655
00:47:30,160 --> 00:47:32,720
right that's it on third party software

1656
00:47:32,000 --> 00:47:34,720
second piece

1657
00:47:32,720 --> 00:47:35,759
this is not as hard as a lot of people

1658
00:47:34,720 --> 00:47:37,040
make it out to be

1659
00:47:35,760 --> 00:47:40,640
a lot of the folks that will get up in

1660
00:47:37,040 --> 00:47:42,640
front you're like i have 50 cpes and and

1661
00:47:40,640 --> 00:47:44,799
they're like worship me kind of thing

1662
00:47:42,640 --> 00:47:46,879
they may be they may be absolute rocket

1663
00:47:44,800 --> 00:47:49,119
scientists maybe gods of exploitation

1664
00:47:46,880 --> 00:47:50,319
but maybe not this stuff isn't that hard

1665
00:47:49,119 --> 00:47:52,000
you can do it too

1666
00:47:50,319 --> 00:47:53,680
again just use the techniques that we

1667
00:47:52,000 --> 00:47:56,160
did there that we showed you here

1668
00:47:53,680 --> 00:47:57,598
and uh you too can rock this john hanna

1669
00:47:56,160 --> 00:47:59,440
back over to you man

1670
00:47:57,599 --> 00:48:01,440
yeah and i think we're gonna have some

1671
00:47:59,440 --> 00:48:04,079
questions coming in because

1672
00:48:01,440 --> 00:48:04,559
of course we are but a couple of quick

1673
00:48:04,079 --> 00:48:06,240
notes

1674
00:48:04,559 --> 00:48:08,640
on this that i think are really really

1675
00:48:06,240 --> 00:48:10,799
key you and i have talked about this

1676
00:48:08,640 --> 00:48:12,240
and i'm not going to get into previous

1677
00:48:10,800 --> 00:48:14,400
lives for you and me

1678
00:48:12,240 --> 00:48:15,598
this should have this should be a class

1679
00:48:14,400 --> 00:48:17,040
right like

1680
00:48:15,599 --> 00:48:19,280
i think that people look at all

1681
00:48:17,040 --> 00:48:22,480
exploitation as like super advanced

1682
00:48:19,280 --> 00:48:25,680
hacking class stuff and honestly

1683
00:48:22,480 --> 00:48:27,119
you talk about the sniff test if you're

1684
00:48:25,680 --> 00:48:28,720
a systems administrator if you're a

1685
00:48:27,119 --> 00:48:30,079
security professional who's also a

1686
00:48:28,720 --> 00:48:31,839
systems administrator

1687
00:48:30,079 --> 00:48:33,119
there needs to be a class for you just

1688
00:48:31,839 --> 00:48:35,279
to go through

1689
00:48:33,119 --> 00:48:36,319
and say okay yeah this this is

1690
00:48:35,280 --> 00:48:38,319
absolutely

1691
00:48:36,319 --> 00:48:39,279
a complete piece of garbage software

1692
00:48:38,319 --> 00:48:39,920
we're not going to put it in our

1693
00:48:39,280 --> 00:48:41,359
environment

1694
00:48:39,920 --> 00:48:43,440
without getting to the point of actually

1695
00:48:41,359 --> 00:48:45,680
doing fuzzing um

1696
00:48:43,440 --> 00:48:46,480
so this this is this is without question

1697
00:48:45,680 --> 00:48:49,359
of class and

1698
00:48:46,480 --> 00:48:50,960
it kind of gets in that question of is

1699
00:48:49,359 --> 00:48:52,480
this type of exploitation does it have

1700
00:48:50,960 --> 00:48:53,040
to be something that's just for the

1701
00:48:52,480 --> 00:48:55,520
super

1702
00:48:53,040 --> 00:48:56,640
elite or can this be the fire that's

1703
00:48:55,520 --> 00:48:59,359
brought down the mountain from

1704
00:48:56,640 --> 00:49:00,960
by prometheus and i really think there's

1705
00:48:59,359 --> 00:49:02,400
a ton of things that you can find

1706
00:49:00,960 --> 00:49:04,000
without going all the way to getting

1707
00:49:02,400 --> 00:49:05,680
shell that you don't need to go to shell

1708
00:49:04,000 --> 00:49:07,280
as well

1709
00:49:05,680 --> 00:49:08,558
well i think demonstrably right i mean

1710
00:49:07,280 --> 00:49:10,559
that's what we're looking at here it's

1711
00:49:08,559 --> 00:49:11,760
it's a case study of that and that's why

1712
00:49:10,559 --> 00:49:12,880
i mean i talked about this back at

1713
00:49:11,760 --> 00:49:13,760
deadwood that's why i want to put this

1714
00:49:12,880 --> 00:49:16,319
talk together and

1715
00:49:13,760 --> 00:49:17,920
kind of close that trilogy of of like

1716
00:49:16,319 --> 00:49:19,759
not lead stuff right and

1717
00:49:17,920 --> 00:49:21,280
you know deadwood i kind of gave the uh

1718
00:49:19,760 --> 00:49:23,200
gave the example there you know i said

1719
00:49:21,280 --> 00:49:24,319
look i i feel stupid every time i get up

1720
00:49:23,200 --> 00:49:25,759
and give a talk where

1721
00:49:24,319 --> 00:49:27,440
i feel like somebody's going to judge me

1722
00:49:25,760 --> 00:49:28,640
for not dropping a note i didn't say

1723
00:49:27,440 --> 00:49:30,240
that here because we did

1724
00:49:28,640 --> 00:49:32,160
but uh you know not being like the super

1725
00:49:30,240 --> 00:49:33,839
elite hacksaw but to the point of it

1726
00:49:32,160 --> 00:49:34,640
needed to be a class yeah definitely uh

1727
00:49:33,839 --> 00:49:36,160
i'm there

1728
00:49:34,640 --> 00:49:38,480
we actually are putting one together on

1729
00:49:36,160 --> 00:49:40,078
this rendition we'll be offering it uh

1730
00:49:38,480 --> 00:49:45,839
likely online and in person

1731
00:49:40,079 --> 00:49:45,839
i would say by one june no doubt

1732
00:49:46,480 --> 00:49:49,200
if i can just confirm it we got a bunch

1733
00:49:47,839 --> 00:49:50,319
of people that are asking for the class

1734
00:49:49,200 --> 00:49:51,279
right now you guys want to come on at

1735
00:49:50,319 --> 00:49:54,000
deadwood and run it

1736
00:49:51,280 --> 00:49:54,640
hey winning definitely yes the first

1737
00:49:54,000 --> 00:49:56,640
approved

1738
00:49:54,640 --> 00:49:57,680
training class for wildlife hiking fest

1739
00:49:56,640 --> 00:50:00,558
in deadwood is

1740
00:49:57,680 --> 00:50:01,839
this class by the way i have a handful

1741
00:50:00,559 --> 00:50:02,480
of things i'd like to throw your way as

1742
00:50:01,839 --> 00:50:04,400
well

1743
00:50:02,480 --> 00:50:06,240
you talked about kind of the elite

1744
00:50:04,400 --> 00:50:08,000
people and

1745
00:50:06,240 --> 00:50:10,319
i i think that that was a really big

1746
00:50:08,000 --> 00:50:13,599
concern in the community for a long time

1747
00:50:10,319 --> 00:50:15,680
years ago you know and it

1748
00:50:13,599 --> 00:50:17,200
kind of went away but it feels in some

1749
00:50:15,680 --> 00:50:19,118
ways like it's back

1750
00:50:17,200 --> 00:50:21,279
i've been in conversations with people

1751
00:50:19,119 --> 00:50:22,880
and because i'm old they tolerate me

1752
00:50:21,280 --> 00:50:24,880
but i've seen people literally do the

1753
00:50:22,880 --> 00:50:26,880
cbe thing it's like well how many cves

1754
00:50:24,880 --> 00:50:29,280
have you done it's like

1755
00:50:26,880 --> 00:50:30,079
it seems like it's a whole nother way of

1756
00:50:29,280 --> 00:50:32,720
trying to

1757
00:50:30,079 --> 00:50:33,839
uh develop street cred i guess that's

1758
00:50:32,720 --> 00:50:36,720
unnecessary and

1759
00:50:33,839 --> 00:50:38,400
not helpful can i offer a note on that

1760
00:50:36,720 --> 00:50:38,879
kind of just an observation one i mean

1761
00:50:38,400 --> 00:50:40,400
man

1762
00:50:38,880 --> 00:50:42,160
first off it's you and i both know it's

1763
00:50:40,400 --> 00:50:44,640
a phallic measuring contest right

1764
00:50:42,160 --> 00:50:46,078
um every time and sadly you know we've

1765
00:50:44,640 --> 00:50:47,839
both been around long enough that we've

1766
00:50:46,079 --> 00:50:48,480
seen it ebb and flow as as you really

1767
00:50:47,839 --> 00:50:50,078
pointed out

1768
00:50:48,480 --> 00:50:51,920
i'm kind of seeing a resurgence in it

1769
00:50:50,079 --> 00:50:52,640
but by and large that resurgence in the

1770
00:50:51,920 --> 00:50:54,160
whole like

1771
00:50:52,640 --> 00:50:55,839
you know the phallic measuring contest

1772
00:50:54,160 --> 00:50:56,879
you you look around at the

1773
00:50:55,839 --> 00:50:58,799
you know the folks who have been there

1774
00:50:56,880 --> 00:51:00,079
done that got the t-shirt and and we're

1775
00:50:58,800 --> 00:51:01,520
just we're over it right

1776
00:51:00,079 --> 00:51:03,520
but i think there's a lot of folks that

1777
00:51:01,520 --> 00:51:05,200
are you know coming into the field

1778
00:51:03,520 --> 00:51:06,880
that are trying to like plant their flag

1779
00:51:05,200 --> 00:51:09,040
and be like hey i wasn't an og

1780
00:51:06,880 --> 00:51:10,240
but you know i'm here now and and those

1781
00:51:09,040 --> 00:51:11,599
are the folks that i see

1782
00:51:10,240 --> 00:51:13,520
more than you know we talk a lot about

1783
00:51:11,599 --> 00:51:15,200
gatekeeping and infosec those are the

1784
00:51:13,520 --> 00:51:16,960
people sadly these people that are kind

1785
00:51:15,200 --> 00:51:17,520
of that three to five year range where

1786
00:51:16,960 --> 00:51:19,839
it's like

1787
00:51:17,520 --> 00:51:21,040
i feel like i'm not a noob and in order

1788
00:51:19,839 --> 00:51:22,558
to prove that i'm gonna make other

1789
00:51:21,040 --> 00:51:24,079
people feel like a noob i don't know

1790
00:51:22,559 --> 00:51:25,280
that's something i've observed and i

1791
00:51:24,079 --> 00:51:27,359
if you're one of those people please

1792
00:51:25,280 --> 00:51:29,040
stop it yeah

1793
00:51:27,359 --> 00:51:31,040
and i think that there's so many other

1794
00:51:29,040 --> 00:51:32,400
ways that you can

1795
00:51:31,040 --> 00:51:34,240
develop really good cred in the

1796
00:51:32,400 --> 00:51:36,559
community that are not exploit

1797
00:51:34,240 --> 00:51:37,919
related i kind of think about there's

1798
00:51:36,559 --> 00:51:39,680
some people on twitter

1799
00:51:37,920 --> 00:51:41,040
that get attacked because they're quote

1800
00:51:39,680 --> 00:51:43,759
unquote not technical

1801
00:51:41,040 --> 00:51:45,200
enough and you know just kind of

1802
00:51:43,760 --> 00:51:46,079
throwing stuff around i remember malware

1803
00:51:45,200 --> 00:51:48,078
unicorn

1804
00:51:46,079 --> 00:51:49,520
was doing some videos explaining some

1805
00:51:48,079 --> 00:51:50,559
basic concepts

1806
00:51:49,520 --> 00:51:52,000
and there were people that like

1807
00:51:50,559 --> 00:51:53,520
immediately crapped on her for the

1808
00:51:52,000 --> 00:51:55,839
videos that she did and anybody that

1809
00:51:53,520 --> 00:51:58,400
knows her knows that she's incredibly

1810
00:51:55,839 --> 00:51:59,440
competent and very very very very deeply

1811
00:51:58,400 --> 00:52:00,960
technical

1812
00:51:59,440 --> 00:52:02,720
jason street you know there's some

1813
00:52:00,960 --> 00:52:04,960
people that are calling him out and

1814
00:52:02,720 --> 00:52:06,640
i i think that that's that's kind of the

1815
00:52:04,960 --> 00:52:07,920
main thing that's got to stop

1816
00:52:06,640 --> 00:52:09,598
trying to call people out because they

1817
00:52:07,920 --> 00:52:11,440
aren't in your specific clubhouse is

1818
00:52:09,599 --> 00:52:12,640
totally and completely garbage and i'd

1819
00:52:11,440 --> 00:52:14,079
like to say you know places like wild

1820
00:52:12,640 --> 00:52:15,520
west high confess we just don't have

1821
00:52:14,079 --> 00:52:17,119
a time for it and we don't want to deal

1822
00:52:15,520 --> 00:52:19,119
with that garbage at all

1823
00:52:17,119 --> 00:52:20,319
i am into that brother amanda is amazing

1824
00:52:19,119 --> 00:52:21,920
jason's amazing and

1825
00:52:20,319 --> 00:52:23,599
we keep listening names off here but

1826
00:52:21,920 --> 00:52:24,400
people that have been attacked for quote

1827
00:52:23,599 --> 00:52:26,240
lack of

1828
00:52:24,400 --> 00:52:28,079
lack of exploits lack of vulnerabilities

1829
00:52:26,240 --> 00:52:31,439
but i mean go google me man i have

1830
00:52:28,079 --> 00:52:33,280
zero cvs zero yeah i'm in the i'm in the

1831
00:52:31,440 --> 00:52:36,480
zero cde club i think

1832
00:52:33,280 --> 00:52:36,880
for i think somebody once called me on

1833
00:52:36,480 --> 00:52:38,640
that

1834
00:52:36,880 --> 00:52:40,559
and i was like well let's go ahead and

1835
00:52:38,640 --> 00:52:42,078
talk about security researchers

1836
00:52:40,559 --> 00:52:45,119
and how many of them are students of

1837
00:52:42,079 --> 00:52:46,640
mine or ed scotuses or jakes

1838
00:52:45,119 --> 00:52:47,839
sometimes he may not be the person

1839
00:52:46,640 --> 00:52:49,200
coming up with that stuff which is a

1840
00:52:47,839 --> 00:52:50,000
conduit that gets people to where they

1841
00:52:49,200 --> 00:52:51,279
need to go

1842
00:52:50,000 --> 00:52:53,119
and i think that that's important as

1843
00:52:51,280 --> 00:52:55,280
well

1844
00:52:53,119 --> 00:52:56,480
and i don't know about you but seriously

1845
00:52:55,280 --> 00:52:58,160
especially and i think we've talked

1846
00:52:56,480 --> 00:52:59,760
about this i think rendition and bhis

1847
00:52:58,160 --> 00:53:01,279
have very similar views on this

1848
00:52:59,760 --> 00:53:02,640
working with companies to actually get

1849
00:53:01,280 --> 00:53:03,599
to the point where you get a cbe is

1850
00:53:02,640 --> 00:53:06,480
totally incomplete

1851
00:53:03,599 --> 00:53:07,119
it's a total time suck and it's just

1852
00:53:06,480 --> 00:53:09,359
absolute

1853
00:53:07,119 --> 00:53:10,480
miserable hell working with oracle is

1854
00:53:09,359 --> 00:53:11,359
probably one of the most painful

1855
00:53:10,480 --> 00:53:13,680
experiences

1856
00:53:11,359 --> 00:53:15,040
that we have ever had so what we do now

1857
00:53:13,680 --> 00:53:16,160
is we hand it over to the customers and

1858
00:53:15,040 --> 00:53:17,200
it's up to the customers to actually

1859
00:53:16,160 --> 00:53:18,558
relay that through

1860
00:53:17,200 --> 00:53:20,558
because i just don't want to deal with

1861
00:53:18,559 --> 00:53:21,440
that it's just too difficult and so much

1862
00:53:20,559 --> 00:53:22,800
definitely and then they get the

1863
00:53:21,440 --> 00:53:24,800
seasoned assist instead of you

1864
00:53:22,800 --> 00:53:26,640
right that's that's the great part right

1865
00:53:24,800 --> 00:53:27,680
so let oracle send them the season

1866
00:53:26,640 --> 00:53:30,078
assist

1867
00:53:27,680 --> 00:53:31,759
yeah yeah and and you know my my

1868
00:53:30,079 --> 00:53:33,520
favorite uh story and it's not even my

1869
00:53:31,760 --> 00:53:35,040
story it's actually kelsey's and kel she

1870
00:53:33,520 --> 00:53:37,040
used to come on and do this but

1871
00:53:35,040 --> 00:53:39,359
she found some vulnerabilities in or

1872
00:53:37,040 --> 00:53:40,960
with some oracle product

1873
00:53:39,359 --> 00:53:42,960
this is right after the what was her

1874
00:53:40,960 --> 00:53:44,480
name lady that was the ciso at oracle's

1875
00:53:42,960 --> 00:53:46,160
like don't pen test our products because

1876
00:53:44,480 --> 00:53:47,680
we're so much better at it than you are

1877
00:53:46,160 --> 00:53:49,520
found a bunch of sql injection and

1878
00:53:47,680 --> 00:53:51,520
cross-site scripting vulnerabilities

1879
00:53:49,520 --> 00:53:53,440
and she sent it in working with the

1880
00:53:51,520 --> 00:53:54,880
customer and oracle responded back

1881
00:53:53,440 --> 00:53:56,480
something like you know insufficient

1882
00:53:54,880 --> 00:53:58,079
details to verify this particular

1883
00:53:56,480 --> 00:53:58,880
vulnerability please provide additional

1884
00:53:58,079 --> 00:54:00,240
details

1885
00:53:58,880 --> 00:54:02,240
and we sent full packet captures

1886
00:54:00,240 --> 00:54:03,680
insufficient details uh please provide

1887
00:54:02,240 --> 00:54:05,839
more details to

1888
00:54:03,680 --> 00:54:07,839
verify this sent packet captures and

1889
00:54:05,839 --> 00:54:09,440
like burp suite state information with

1890
00:54:07,839 --> 00:54:12,160
screenshots and arrows

1891
00:54:09,440 --> 00:54:13,920
came back uh insufficient details to

1892
00:54:12,160 --> 00:54:15,520
document and verify that this

1893
00:54:13,920 --> 00:54:17,200
they were just basically running you

1894
00:54:15,520 --> 00:54:18,960
through the ringer until the point that

1895
00:54:17,200 --> 00:54:20,240
she just kept on hitting resend with all

1896
00:54:18,960 --> 00:54:21,359
the stuff and they finally started

1897
00:54:20,240 --> 00:54:22,879
working with us

1898
00:54:21,359 --> 00:54:24,400
but even after that it took months for

1899
00:54:22,880 --> 00:54:26,319
it to actually get addressed and i

1900
00:54:24,400 --> 00:54:28,000
really understand kind of the full

1901
00:54:26,319 --> 00:54:28,640
disclosure movement and i know that some

1902
00:54:28,000 --> 00:54:30,160
of you

1903
00:54:28,640 --> 00:54:31,440
i know that some of you are going to say

1904
00:54:30,160 --> 00:54:33,200
what what jake did here was

1905
00:54:31,440 --> 00:54:35,119
irresponsible he should have done

1906
00:54:33,200 --> 00:54:36,480
responsible disclosure and i want to be

1907
00:54:35,119 --> 00:54:37,920
honest to you that responsible

1908
00:54:36,480 --> 00:54:39,599
disclosure by and large is something

1909
00:54:37,920 --> 00:54:41,839
that's created by the vendors

1910
00:54:39,599 --> 00:54:43,599
so they can control the narrative about

1911
00:54:41,839 --> 00:54:45,680
how they address vulnerabilities

1912
00:54:43,599 --> 00:54:46,880
if you work with them and you go through

1913
00:54:45,680 --> 00:54:47,440
all the hoops you're gonna work for

1914
00:54:46,880 --> 00:54:49,359
months

1915
00:54:47,440 --> 00:54:51,280
if you drop something on the street it

1916
00:54:49,359 --> 00:54:53,598
takes less than 24 hours

1917
00:54:51,280 --> 00:54:54,559
and that's horrible it should not have

1918
00:54:53,599 --> 00:54:57,520
to be that way

1919
00:54:54,559 --> 00:54:58,559
but katie has i think the uh the best

1920
00:54:57,520 --> 00:55:00,640
t-shirt ever

1921
00:54:58,559 --> 00:55:02,240
it says don't hate the researcher hate

1922
00:55:00,640 --> 00:55:03,359
the vuln and that's really where it

1923
00:55:02,240 --> 00:55:05,040
needs to go

1924
00:55:03,359 --> 00:55:06,960
well thank you so much for closing this

1925
00:55:05,040 --> 00:55:08,799
out jake putting this much work into it

1926
00:55:06,960 --> 00:55:10,480
i know you haven't been sleeping much

1927
00:55:08,799 --> 00:55:17,520
i know you guys have been really really

1928
00:55:10,480 --> 00:55:17,520
really busy so i greatly appreciate it

