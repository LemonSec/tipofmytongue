1
00:00:00,100 --> 00:00:10,809
[Music]

2
00:00:08,160 --> 00:00:12,160
we're talking about extracting<font color="#CCCCCC"> data</font><font color="#E5E5E5"> from</font>

3
00:00:10,809 --> 00:00:14,440
slack<font color="#E5E5E5"> because there's a lot of</font>

4
00:00:12,160 --> 00:00:16,990
interesting<font color="#E5E5E5"> data in there that we might</font>

5
00:00:14,440 --> 00:00:19,270
<font color="#E5E5E5">want to look at and we're not revealing</font>

6
00:00:16,990 --> 00:00:21,580
some vulnerability with slack we're just

7
00:00:19,270 --> 00:00:24,279
going<font color="#E5E5E5"> to talk about using an API we</font>

8
00:00:21,580 --> 00:00:25,778
<font color="#E5E5E5">release a tool for pulling down</font><font color="#CCCCCC"> all</font>

9
00:00:24,279 --> 00:00:28,029
messages<font color="#E5E5E5"> and files another useful</font>

10
00:00:25,779 --> 00:00:29,948
<font color="#E5E5E5">information from slack using their API</font>

11
00:00:28,029 --> 00:00:32,650
and that's<font color="#E5E5E5"> a tool that you'll be</font><font color="#CCCCCC"> able to</font>

12
00:00:29,949 --> 00:00:34,390
use and then we'll also<font color="#E5E5E5"> talk about how</font>

13
00:00:32,650 --> 00:00:36,190
you<font color="#E5E5E5"> might be able to detect this being</font>

14
00:00:34,390 --> 00:00:37,750
used<font color="#E5E5E5"> in your environment</font><font color="#CCCCCC"> maybe to notice</font>

15
00:00:36,190 --> 00:00:38,620
that someone's account<font color="#E5E5E5"> has</font><font color="#CCCCCC"> been</font>

16
00:00:37,750 --> 00:00:42,030
compromised

17
00:00:38,620 --> 00:00:50,319
<font color="#E5E5E5">and that's the part</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> Tony will cover</font>

18
00:00:42,030 --> 00:00:53,410
<font color="#E5E5E5">okay so I'm Kerry Roberts I fun I'm a</font>

19
00:00:50,320 --> 00:00:56,050
red<font color="#E5E5E5"> teamer for Walmart and I used to be</font>

20
00:00:53,410 --> 00:00:58,959
a<font color="#E5E5E5"> developer and I really started out and</font>

21
00:00:56,050 --> 00:01:01,629
<font color="#CCCCCC">insecurity after miserably failing a pen</font>

22
00:00:58,960 --> 00:01:03,700
test with my web app I knew nothing

23
00:01:01,630 --> 00:01:05,049
about security at the time and it

24
00:01:03,700 --> 00:01:08,380
inspired me<font color="#E5E5E5"> to</font><font color="#CCCCCC"> learn</font><font color="#E5E5E5"> something</font><font color="#CCCCCC"> about</font>

25
00:01:05,049 --> 00:01:11,320
security<font color="#CCCCCC"> so now I'm a red teamer and I</font>

26
00:01:08,380 --> 00:01:15,250
also<font color="#E5E5E5"> to learn about security I got the</font>

27
00:01:11,320 --> 00:01:19,960
<font color="#CCCCCC">sans</font><font color="#E5E5E5"> master's degree and that was that</font>

28
00:01:15,250 --> 00:01:22,030
was a<font color="#E5E5E5"> great help to</font><font color="#CCCCCC"> me I'm</font><font color="#E5E5E5"> Tony</font><font color="#CCCCCC"> have</font>

29
00:01:19,960 --> 00:01:24,280
<font color="#E5E5E5">occur</font><font color="#CCCCCC"> I come from</font><font color="#E5E5E5"> a really varied</font>

30
00:01:22,030 --> 00:01:26,170
background<font color="#E5E5E5"> I've owned a business worked</font>

31
00:01:24,280 --> 00:01:28,000
in networking<font color="#CCCCCC"> security data loss</font>

32
00:01:26,170 --> 00:01:29,920
prevention<font color="#CCCCCC"> HIPAA compliance with</font>

33
00:01:28,000 --> 00:01:31,720
hospitals so medical information<font color="#E5E5E5"> systems</font>

34
00:01:29,920 --> 00:01:37,150
<font color="#E5E5E5">I'm currently working as an incident</font>

35
00:01:31,720 --> 00:01:38,590
responder with Walmart<font color="#CCCCCC"> ok in</font><font color="#E5E5E5"> just the</font>

36
00:01:37,150 --> 00:01:41,050
little disclaimers this isn't an

37
00:01:38,590 --> 00:01:43,510
endorsement for<font color="#CCCCCC"> any prod product or</font>

38
00:01:41,050 --> 00:01:45,670
service and<font color="#E5E5E5"> these views</font><font color="#CCCCCC"> are on we're not</font>

39
00:01:43,510 --> 00:01:49,930
<font color="#E5E5E5">officially representing Walmart here so</font>

40
00:01:45,670 --> 00:01:52,120
<font color="#CCCCCC">they may or may not</font><font color="#E5E5E5"> agree ok just quick</font>

41
00:01:49,930 --> 00:01:54,790
intro for those who don't<font color="#CCCCCC"> use slack</font>

42
00:01:52,120 --> 00:01:56,979
slack is kind of like a way to chat

43
00:01:54,790 --> 00:01:59,440
share files it makes it really easy<font color="#CCCCCC"> to</font>

44
00:01:56,979 --> 00:02:01,929
communicate<font color="#CCCCCC"> especially it</font><font color="#E5E5E5"> may be if your</font>

45
00:01:59,440 --> 00:02:04,810
remote<font color="#CCCCCC"> not</font><font color="#E5E5E5"> right in the</font><font color="#CCCCCC"> office with</font>

46
00:02:01,930 --> 00:02:07,390
someone<font color="#E5E5E5"> so here we have an example of</font>

47
00:02:04,810 --> 00:02:10,119
<font color="#E5E5E5">like me sending a message</font><font color="#CCCCCC"> to Martin and</font>

48
00:02:07,390 --> 00:02:12,340
<font color="#E5E5E5">we've got over</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the Left we have our</font>

49
00:02:10,119 --> 00:02:14,540
channels that we<font color="#E5E5E5"> can talk in and there's</font>

50
00:02:12,340 --> 00:02:16,400
public channels<font color="#E5E5E5"> shown with the hashed</font>

51
00:02:14,540 --> 00:02:18,590
<font color="#E5E5E5">there and private channels that only if</font>

52
00:02:16,400 --> 00:02:20,810
you've been invited<font color="#E5E5E5"> to you can talk to</font>

53
00:02:18,590 --> 00:02:22,430
<font color="#E5E5E5">people in</font><font color="#CCCCCC"> that private Channel and then</font>

54
00:02:20,810 --> 00:02:24,379
there's also<font color="#E5E5E5"> direct messages where it</font>

55
00:02:22,430 --> 00:02:26,060
you it's one-on-one you talk to someone

56
00:02:24,379 --> 00:02:28,280
else<font color="#E5E5E5"> or actually it can</font><font color="#CCCCCC"> be more</font><font color="#E5E5E5"> than one</font>

57
00:02:26,060 --> 00:02:29,599
on one<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can talk to multiple</font><font color="#E5E5E5"> people</font>

58
00:02:28,280 --> 00:02:32,120
other<font color="#E5E5E5"> people directly</font>

59
00:02:29,599 --> 00:02:34,040
they call that<font color="#E5E5E5"> multi party instant</font>

60
00:02:32,120 --> 00:02:35,810
messaging but<font color="#E5E5E5"> those are the four</font>

61
00:02:34,040 --> 00:02:37,429
different<font color="#E5E5E5"> types of channels and you'll</font>

62
00:02:35,810 --> 00:02:38,780
see that terminology throughout this

63
00:02:37,430 --> 00:02:41,269
<font color="#E5E5E5">presentation so I wanted to point that</font>

64
00:02:38,780 --> 00:02:44,389
<font color="#E5E5E5">out</font><font color="#CCCCCC"> but one important thing to note</font><font color="#E5E5E5"> here</font>

65
00:02:41,269 --> 00:02:46,400
<font color="#E5E5E5">is up in the URL is this like CC e</font>

66
00:02:44,389 --> 00:02:49,400
number that's the channel ID every

67
00:02:46,400 --> 00:02:51,379
channel<font color="#E5E5E5"> has</font><font color="#CCCCCC"> an ID and that's good to</font>

68
00:02:49,400 --> 00:02:57,260
<font color="#CCCCCC">know for when</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> interpret the output</font>

69
00:02:51,379 --> 00:03:01,548
<font color="#E5E5E5">of this script so</font><font color="#CCCCCC"> slack</font><font color="#E5E5E5"> is widely used</font>

70
00:02:57,260 --> 00:03:02,989
there's<font color="#CCCCCC"> 50,000</font><font color="#E5E5E5"> teams paying for to use</font>

71
00:03:01,549 --> 00:03:05,120
the slack service last year<font color="#E5E5E5"> they</font>

72
00:03:02,989 --> 00:03:10,939
announced they have 60 million daily<font color="#E5E5E5"> or</font>

73
00:03:05,120 --> 00:03:13,519
<font color="#CCCCCC">6</font><font color="#E5E5E5"> million daily users</font><font color="#CCCCCC"> 43% of</font><font color="#E5E5E5"> the largest</font>

74
00:03:10,939 --> 00:03:16,280
100 companies<font color="#E5E5E5"> in the nation are</font><font color="#CCCCCC"> using it</font>

75
00:03:13,519 --> 00:03:17,720
<font color="#E5E5E5">and 55%</font><font color="#CCCCCC"> of those daily users are outside</font>

76
00:03:16,280 --> 00:03:21,739
the<font color="#E5E5E5"> United</font><font color="#CCCCCC"> States so</font><font color="#E5E5E5"> this just give you</font>

77
00:03:17,720 --> 00:03:23,120
an idea<font color="#E5E5E5"> that this if</font><font color="#CCCCCC"> you're a</font><font color="#E5E5E5"> pen tester</font>

78
00:03:21,739 --> 00:03:25,159
you're likely<font color="#E5E5E5"> to bump into this at a</font>

79
00:03:23,120 --> 00:03:30,079
company you test and so this<font color="#E5E5E5"> might</font><font color="#CCCCCC"> be of</font>

80
00:03:25,159 --> 00:03:32,179
<font color="#E5E5E5">interest to you</font><font color="#CCCCCC"> we find a lot of</font>

81
00:03:30,079 --> 00:03:34,190
<font color="#E5E5E5">sensitive</font><font color="#CCCCCC"> information in slack it's just</font>

82
00:03:32,180 --> 00:03:36,349
so<font color="#CCCCCC"> easy to share information via slack</font>

83
00:03:34,190 --> 00:03:38,120
and companies may say well we<font color="#CCCCCC"> have a</font>

84
00:03:36,349 --> 00:03:41,888
policy<font color="#E5E5E5"> against sharing sensitive</font>

85
00:03:38,120 --> 00:03:44,419
information<font color="#CCCCCC"> in slack well</font><font color="#E5E5E5"> that policy</font>

86
00:03:41,889 --> 00:03:47,150
<font color="#CCCCCC">doesn't get it's here</font><font color="#E5E5E5"> to as well as you</font>

87
00:03:44,419 --> 00:03:48,799
<font color="#CCCCCC">might hope but when</font><font color="#E5E5E5"> people by golly they</font>

88
00:03:47,150 --> 00:03:51,109
just want<font color="#E5E5E5"> to tell this guy</font><font color="#CCCCCC"> what the</font>

89
00:03:48,799 --> 00:03:52,729
password<font color="#E5E5E5"> is and this</font><font color="#CCCCCC"> is just an</font><font color="#E5E5E5"> easy way</font>

90
00:03:51,109 --> 00:03:54,290
<font color="#CCCCCC">to do</font><font color="#E5E5E5"> it or they</font><font color="#CCCCCC"> just want to</font><font color="#E5E5E5"> post a</font>

91
00:03:52,729 --> 00:03:56,959
file or they<font color="#E5E5E5"> don't really a sensitive</font>

92
00:03:54,290 --> 00:03:59,030
<font color="#CCCCCC">information is in</font><font color="#E5E5E5"> that file so even with</font>

93
00:03:56,959 --> 00:04:03,590
policies you'll find a lot of<font color="#E5E5E5"> sensitive</font>

94
00:03:59,030 --> 00:04:06,319
information<font color="#E5E5E5"> in slack slack publishes an</font>

95
00:04:03,590 --> 00:04:08,720
API so<font color="#CCCCCC"> a programmatic</font><font color="#E5E5E5"> way</font><font color="#CCCCCC"> to interface</font>

96
00:04:06,319 --> 00:04:10,638
with slack to get<font color="#CCCCCC"> information I've</font>

97
00:04:08,720 --> 00:04:12,228
highlighted there the channel history

98
00:04:10,639 --> 00:04:13,639
call if he<font color="#CCCCCC"> caught make a call to channel</font>

99
00:04:12,229 --> 00:04:16,970
history you can fetch all the messages

100
00:04:13,639 --> 00:04:20,478
<font color="#E5E5E5">for a channel so the script that I</font>

101
00:04:16,970 --> 00:04:22,659
developed uses the slack API to use<font color="#CCCCCC"> the</font>

102
00:04:20,478 --> 00:04:26,570
slack<font color="#E5E5E5"> API you have</font><font color="#CCCCCC"> to be authenticated</font>

103
00:04:22,659 --> 00:04:27,740
<font color="#E5E5E5">and so on the website</font><font color="#CCCCCC"> it says to use the</font>

104
00:04:26,570 --> 00:04:29,719
API<font color="#E5E5E5"> you</font><font color="#CCCCCC"> need a Tok</font>

105
00:04:27,740 --> 00:04:32,509
and the token looks like that example

106
00:04:29,720 --> 00:04:35,000
there<font color="#E5E5E5"> it might be like</font><font color="#CCCCCC"> X</font><font color="#E5E5E5"> 0</font><font color="#CCCCCC"> XS - and a</font>

107
00:04:32,509 --> 00:04:37,970
bunch<font color="#CCCCCC"> of numbers you need</font><font color="#E5E5E5"> that to be</font>

108
00:04:35,000 --> 00:04:40,460
authorized<font color="#E5E5E5"> to use the API and you can</font>

109
00:04:37,970 --> 00:04:43,310
get that token<font color="#E5E5E5"> if you log in</font><font color="#CCCCCC"> with your</font>

110
00:04:40,460 --> 00:04:45,799
web browser<font color="#CCCCCC"> one of the responses that</font>

111
00:04:43,310 --> 00:04:47,630
<font color="#E5E5E5">you get will have your token and you</font><font color="#CCCCCC"> can</font>

112
00:04:45,800 --> 00:04:55,849
<font color="#CCCCCC">see there in</font><font color="#E5E5E5"> orange down there a</font>

113
00:04:47,630 --> 00:04:58,430
<font color="#E5E5E5">response that has the token there so at</font>

114
00:04:55,849 --> 00:05:00,680
that github<font color="#E5E5E5"> URL that's my github CLR</font><font color="#CCCCCC"> -</font>

115
00:04:58,430 --> 00:05:03,470
of<font color="#CCCCCC"> eight slash</font><font color="#E5E5E5"> slack extract you can</font>

116
00:05:00,680 --> 00:05:05,870
find<font color="#E5E5E5"> this script which</font><font color="#CCCCCC"> you can use and</font>

117
00:05:03,470 --> 00:05:08,000
the readme has just these three simple

118
00:05:05,870 --> 00:05:09,650
instructions to use<font color="#CCCCCC"> as a script</font><font color="#E5E5E5"> you</font>

119
00:05:08,000 --> 00:05:12,020
start up PowerShell with that command

120
00:05:09,650 --> 00:05:13,638
<font color="#CCCCCC">you import the module and then to learn</font>

121
00:05:12,020 --> 00:05:17,060
how to use it you can<font color="#CCCCCC"> just say</font><font color="#E5E5E5"> get help</font>

122
00:05:13,639 --> 00:05:18,740
<font color="#E5E5E5">for the script</font><font color="#CCCCCC"> and it has lists out all</font>

123
00:05:17,060 --> 00:05:22,789
<font color="#E5E5E5">the</font><font color="#CCCCCC"> options and examples</font><font color="#E5E5E5"> of how to use</font>

124
00:05:18,740 --> 00:05:25,310
<font color="#CCCCCC">it</font><font color="#E5E5E5"> but we'll talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> here too so</font>

125
00:05:22,789 --> 00:05:27,800
to use the slack extract script<font color="#E5E5E5"> there's</font>

126
00:05:25,310 --> 00:05:29,900
three required<font color="#E5E5E5"> things you have</font><font color="#CCCCCC"> to give</font>

127
00:05:27,800 --> 00:05:31,340
it you have to tell<font color="#E5E5E5"> the slack URL so in</font>

128
00:05:29,900 --> 00:05:35,239
our examples today<font color="#E5E5E5"> we're going to use</font>

129
00:05:31,340 --> 00:05:36,948
slack extract slack comm<font color="#E5E5E5"> and then you</font>

130
00:05:35,240 --> 00:05:38,240
have to give it an<font color="#CCCCCC"> output folder name so</font>

131
00:05:36,949 --> 00:05:42,169
just a<font color="#E5E5E5"> folder where you want all this</font>

132
00:05:38,240 --> 00:05:43,880
extracted stuff to go and then we'll use

133
00:05:42,169 --> 00:05:45,919
my<font color="#E5E5E5"> extraction as the name of the folder</font>

134
00:05:43,880 --> 00:05:48,770
for these demos<font color="#E5E5E5"> and then you need to</font>

135
00:05:45,919 --> 00:05:51,049
<font color="#CCCCCC">give it</font><font color="#E5E5E5"> either</font><font color="#CCCCCC"> the cookie that</font><font color="#E5E5E5"> your</font>

136
00:05:48,770 --> 00:05:53,448
browser generates when you log in and<font color="#CCCCCC"> I</font>

137
00:05:51,050 --> 00:05:55,550
call it<font color="#CCCCCC"> the</font><font color="#E5E5E5"> D cookie because slack</font><font color="#CCCCCC"> gives</font>

138
00:05:53,449 --> 00:05:58,340
this cookie the name of D just the

139
00:05:55,550 --> 00:06:01,340
letter D<font color="#E5E5E5"> so you either need to give it</font>

140
00:05:58,340 --> 00:06:03,619
<font color="#E5E5E5">the D cookie because that that</font><font color="#CCCCCC"> can't be</font>

141
00:06:01,340 --> 00:06:06,619
exchanged for an API token<font color="#E5E5E5"> or you can</font>

142
00:06:03,620 --> 00:06:08,060
just plain give it the API token<font color="#E5E5E5"> so one</font>

143
00:06:06,620 --> 00:06:09,919
<font color="#CCCCCC">of</font><font color="#E5E5E5"> those two things</font><font color="#CCCCCC"> are required</font><font color="#E5E5E5"> so</font>

144
00:06:08,060 --> 00:06:13,280
there's<font color="#E5E5E5"> three minimum parameters that</font>

145
00:06:09,919 --> 00:06:15,349
you use with<font color="#E5E5E5"> this script</font><font color="#CCCCCC"> so the</font><font color="#E5E5E5"> D cookie</font>

146
00:06:13,280 --> 00:06:17,119
I mentioned you<font color="#E5E5E5"> can get from your</font>

147
00:06:15,349 --> 00:06:19,400
browser<font color="#CCCCCC"> and I've got a demo</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> that but</font>

148
00:06:17,120 --> 00:06:22,400
you can take the<font color="#E5E5E5"> D coke cookie and make</font>

149
00:06:19,400 --> 00:06:25,250
it<font color="#CCCCCC"> call the slack</font><font color="#E5E5E5"> to the messages so</font>

150
00:06:22,400 --> 00:06:28,070
slack<font color="#CCCCCC"> DICOM /</font><font color="#E5E5E5"> messages and in return</font>

151
00:06:25,250 --> 00:06:29,719
that<font color="#E5E5E5"> response will contain</font><font color="#CCCCCC"> your token</font>

152
00:06:28,070 --> 00:06:33,159
<font color="#E5E5E5">again</font><font color="#CCCCCC"> this isn't of vulnerability this</font>

153
00:06:29,719 --> 00:06:36,349
is just how you<font color="#CCCCCC"> authorize with the</font><font color="#E5E5E5"> API</font>

154
00:06:33,159 --> 00:06:38,930
<font color="#CCCCCC">so how do we get the</font><font color="#E5E5E5"> D cookie</font><font color="#CCCCCC"> we can</font>

155
00:06:36,349 --> 00:06:40,940
look in our<font color="#E5E5E5"> browser after we</font><font color="#CCCCCC"> login</font><font color="#E5E5E5"> so if</font>

156
00:06:38,930 --> 00:06:43,280
we're<font color="#CCCCCC"> using this like we're not pin two</font>

157
00:06:40,940 --> 00:06:44,780
we just want<font color="#E5E5E5"> to extract all</font><font color="#CCCCCC"> of our own</font>

158
00:06:43,280 --> 00:06:46,309
information<font color="#E5E5E5"> because we want to search</font>

159
00:06:44,780 --> 00:06:50,239
through<font color="#E5E5E5"> the files that we put in there</font>

160
00:06:46,310 --> 00:06:52,280
<font color="#E5E5E5">or</font><font color="#CCCCCC"> the data for whatever reason or if</font>

161
00:06:50,240 --> 00:06:53,480
we're a<font color="#E5E5E5"> pen tester red teamer we may</font>

162
00:06:52,280 --> 00:06:55,219
have compromised someone's<font color="#E5E5E5"> psyche</font>

163
00:06:53,480 --> 00:06:57,350
credentials and we might want to pull

164
00:06:55,220 --> 00:07:00,410
<font color="#E5E5E5">down</font><font color="#CCCCCC"> all this</font><font color="#E5E5E5"> information that they have</font>

165
00:06:57,350 --> 00:07:02,600
so if we log in as them we grab their<font color="#E5E5E5"> D</font>

166
00:07:00,410 --> 00:07:05,330
cookie and now we extract information<font color="#E5E5E5"> as</font>

167
00:07:02,600 --> 00:07:06,920
if we were them<font color="#CCCCCC"> so I do have some</font>

168
00:07:05,330 --> 00:07:09,050
commands you don't have to try to write

169
00:07:06,920 --> 00:07:13,550
this<font color="#E5E5E5"> down it's all in the</font><font color="#CCCCCC"> github wiki</font>

170
00:07:09,050 --> 00:07:15,530
<font color="#E5E5E5">but some examples of if the user had</font>

171
00:07:13,550 --> 00:07:20,420
used<font color="#CCCCCC"> Chrome to</font><font color="#E5E5E5"> log</font><font color="#CCCCCC"> in to slack you could</font>

172
00:07:15,530 --> 00:07:23,599
extract<font color="#E5E5E5"> the D cookie with that</font><font color="#CCCCCC"> long</font>

173
00:07:20,420 --> 00:07:27,020
command line there or from<font color="#E5E5E5"> Firefox you</font>

174
00:07:23,600 --> 00:07:30,020
<font color="#E5E5E5">can do that here's a demo of</font><font color="#CCCCCC"> how do you</font>

175
00:07:27,020 --> 00:07:32,330
do<font color="#CCCCCC"> it if you were to</font><font color="#E5E5E5"> log in</font><font color="#CCCCCC"> to I'm</font><font color="#E5E5E5"> gonna</font>

176
00:07:30,020 --> 00:07:34,430
call at the victim in<font color="#E5E5E5"> this case but to</font>

177
00:07:32,330 --> 00:07:39,590
the person<font color="#CCCCCC"> who you have creds</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> login</font>

178
00:07:34,430 --> 00:07:45,350
<font color="#CCCCCC">to slack so you go up to the top menu</font>

179
00:07:39,590 --> 00:07:46,760
and<font color="#CCCCCC"> go to</font><font color="#E5E5E5"> settings and you just search</font>

180
00:07:45,350 --> 00:07:51,790
for cookies that's the easiest way to

181
00:07:46,760 --> 00:07:54,500
find<font color="#E5E5E5"> it scroll down to content settings</font>

182
00:07:51,790 --> 00:07:58,010
<font color="#E5E5E5">cookies and then see all cookies and</font>

183
00:07:54,500 --> 00:07:59,900
site data and then you can narrow it

184
00:07:58,010 --> 00:08:02,270
down by<font color="#E5E5E5"> searching</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> slack</font><font color="#CCCCCC"> com you see</font>

185
00:07:59,900 --> 00:08:05,210
slack there and then you just<font color="#CCCCCC"> want that</font>

186
00:08:02,270 --> 00:08:07,700
cookie<font color="#CCCCCC"> name de thadi</font><font color="#E5E5E5"> cookie so that big</font>

187
00:08:05,210 --> 00:08:09,919
long ugly thing there that's what you

188
00:08:07,700 --> 00:08:14,030
would like to<font color="#E5E5E5"> get a hold</font><font color="#CCCCCC"> of so</font><font color="#E5E5E5"> just copy</font>

189
00:08:09,919 --> 00:08:17,210
that<font color="#CCCCCC"> out</font><font color="#E5E5E5"> to use with the script okay so</font>

190
00:08:14,030 --> 00:08:19,820
here we<font color="#CCCCCC"> have basic usage</font><font color="#E5E5E5"> we just we have</font>

191
00:08:17,210 --> 00:08:23,060
our authorization<font color="#CCCCCC"> token or our D cookie</font>

192
00:08:19,820 --> 00:08:25,730
and we say invoke slack extract we give

193
00:08:23,060 --> 00:08:28,190
up the<font color="#E5E5E5"> output folder name we give it the</font>

194
00:08:25,730 --> 00:08:29,690
slack URL and our<font color="#E5E5E5"> D cookie and I have an</font>

195
00:08:28,190 --> 00:08:30,860
ellipsis there in the middle of the<font color="#E5E5E5"> D</font>

196
00:08:29,690 --> 00:08:33,320
cookie because<font color="#E5E5E5"> I don't want to paste</font>

197
00:08:30,860 --> 00:08:36,830
<font color="#CCCCCC">that big long</font><font color="#E5E5E5"> D cookie in but</font><font color="#CCCCCC"> that would</font>

198
00:08:33,320 --> 00:08:39,320
be<font color="#E5E5E5"> that</font><font color="#CCCCCC"> big long</font><font color="#E5E5E5"> D cookie there and the</font>

199
00:08:36,830 --> 00:08:42,650
example<font color="#CCCCCC"> output we see the inside our</font>

200
00:08:39,320 --> 00:08:44,720
documents directory<font color="#CCCCCC"> slack extract folder</font>

201
00:08:42,650 --> 00:08:47,449
was<font color="#CCCCCC"> created inside</font><font color="#E5E5E5"> that slack extract</font>

202
00:08:44,720 --> 00:08:49,940
folder gets<font color="#E5E5E5"> created your output folder</font>

203
00:08:47,450 --> 00:08:53,060
so we<font color="#E5E5E5"> called up my extraction so now we</font>

204
00:08:49,940 --> 00:08:54,230
have this my extraction folder inside<font color="#E5E5E5"> my</font>

205
00:08:53,060 --> 00:08:57,469
extraction fold

206
00:08:54,230 --> 00:08:59,870
we have<font color="#E5E5E5"> there'll be a folder for every</font>

207
00:08:57,470 --> 00:09:02,690
<font color="#CCCCCC">channel so this</font><font color="#E5E5E5"> is that CC e channel we</font>

208
00:08:59,870 --> 00:09:05,390
saw earlier<font color="#E5E5E5"> inside that folder is a</font>

209
00:09:02,690 --> 00:09:07,910
folder full<font color="#CCCCCC"> of files from that</font><font color="#E5E5E5"> channel</font>

210
00:09:05,390 --> 00:09:12,590
<font color="#E5E5E5">and a folder full of</font><font color="#CCCCCC"> messages</font><font color="#E5E5E5"> so the</font>

211
00:09:07,910 --> 00:09:14,000
files we look<font color="#CCCCCC"> over here</font><font color="#E5E5E5"> we see we see</font>

212
00:09:12,590 --> 00:09:16,460
that it has each of the files in there

213
00:09:14,000 --> 00:09:18,860
and<font color="#E5E5E5"> then in the messages directory we</font>

214
00:09:16,460 --> 00:09:21,410
have<font color="#CCCCCC"> a JSON file one for every single</font>

215
00:09:18,860 --> 00:09:22,940
<font color="#CCCCCC">message in that channel</font><font color="#E5E5E5"> and the JSON</font>

216
00:09:21,410 --> 00:09:25,430
file looks<font color="#E5E5E5"> like this in the lower right</font>

217
00:09:22,940 --> 00:09:27,380
it has a type of<font color="#E5E5E5"> the message the</font><font color="#CCCCCC"> user</font>

218
00:09:25,430 --> 00:09:30,709
who<font color="#CCCCCC"> posted that message the text of the</font>

219
00:09:27,380 --> 00:09:33,140
message<font color="#CCCCCC"> and</font><font color="#E5E5E5"> a timestamp and the message</font>

220
00:09:30,710 --> 00:09:35,600
files themselves<font color="#CCCCCC"> are named according to</font>

221
00:09:33,140 --> 00:09:38,360
that<font color="#CCCCCC"> timestamp so</font><font color="#E5E5E5"> if you sort by the</font>

222
00:09:35,600 --> 00:09:42,490
<font color="#E5E5E5">filename</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the messages you can read</font>

223
00:09:38,360 --> 00:09:42,490
messages in time<font color="#CCCCCC"> order</font>

224
00:09:43,820 --> 00:09:48,020
there's also metadata directory created

225
00:09:45,860 --> 00:09:50,750
<font color="#E5E5E5">so inside my</font><font color="#CCCCCC"> extraction is a metadata</font>

226
00:09:48,020 --> 00:09:53,329
folder so that's like information<font color="#CCCCCC"> about</font>

227
00:09:50,750 --> 00:09:55,160
the channels<font color="#CCCCCC"> themselves so each channel</font>

228
00:09:53,330 --> 00:09:57,080
has<font color="#CCCCCC"> a name a</font><font color="#E5E5E5"> topic a purpose whether</font>

229
00:09:55,160 --> 00:09:59,600
it's public<font color="#E5E5E5"> or private previous names</font>

230
00:09:57,080 --> 00:10:02,510
that use<font color="#E5E5E5"> create a date and more even</font>

231
00:09:59,600 --> 00:10:06,290
more<font color="#E5E5E5"> than that</font><font color="#CCCCCC"> if we look inside</font><font color="#E5E5E5"> the</font>

232
00:10:02,510 --> 00:10:08,630
channels<font color="#E5E5E5"> folder we see there's a JSON</font>

233
00:10:06,290 --> 00:10:10,250
file for<font color="#E5E5E5"> every channel</font><font color="#CCCCCC"> so that has all</font>

234
00:10:08,630 --> 00:10:14,120
those details we see on the right

235
00:10:10,250 --> 00:10:16,520
but after it<font color="#E5E5E5"> downloads all those channel</font>

236
00:10:14,120 --> 00:10:19,550
details<font color="#E5E5E5"> it rolls those up for you into</font>

237
00:10:16,520 --> 00:10:22,280
all channels CSV so that you can<font color="#E5E5E5"> open</font><font color="#CCCCCC"> it</font>

238
00:10:19,550 --> 00:10:24,140
up in<font color="#CCCCCC"> Excel and</font><font color="#E5E5E5"> you can quickly sort</font>

239
00:10:22,280 --> 00:10:26,839
through all<font color="#CCCCCC"> the</font><font color="#E5E5E5"> channels what their</font>

240
00:10:24,140 --> 00:10:31,880
purpose is and find channels of interest

241
00:10:26,840 --> 00:10:33,530
<font color="#E5E5E5">by looking at that CSV file</font><font color="#CCCCCC"> I said that</font>

242
00:10:31,880 --> 00:10:36,680
if you run this<font color="#CCCCCC"> it'll download all files</font>

243
00:10:33,530 --> 00:10:39,770
<font color="#E5E5E5">and messages that that user</font><font color="#CCCCCC"> has access</font>

244
00:10:36,680 --> 00:10:42,170
<font color="#CCCCCC">to which is mostly true</font><font color="#E5E5E5"> but there are</font>

245
00:10:39,770 --> 00:10:45,260
some<font color="#E5E5E5"> default limits</font><font color="#CCCCCC"> just to help</font><font color="#E5E5E5"> you</font>

246
00:10:42,170 --> 00:10:47,060
keep<font color="#E5E5E5"> from blowing up your disk space on</font>

247
00:10:45,260 --> 00:10:48,880
<font color="#CCCCCC">your machine so by default it'll</font>

248
00:10:47,060 --> 00:10:51,920
<font color="#CCCCCC">download up to</font><font color="#E5E5E5"> ten thousand messages</font>

249
00:10:48,880 --> 00:10:53,689
from each<font color="#CCCCCC"> channel and up to two thousand</font>

250
00:10:51,920 --> 00:10:56,990
files<font color="#E5E5E5"> and there's some other limits</font>

251
00:10:53,690 --> 00:10:59,120
there<font color="#CCCCCC"> but you can</font><font color="#E5E5E5"> increase that</font><font color="#CCCCCC"> to be</font>

252
00:10:56,990 --> 00:11:01,310
enough to grab everything<font color="#E5E5E5"> if you have</font>

253
00:10:59,120 --> 00:11:03,530
<font color="#CCCCCC">room to do</font><font color="#E5E5E5"> that on your system or</font>

254
00:11:01,310 --> 00:11:06,010
decrease it<font color="#CCCCCC"> to get less from each</font>

255
00:11:03,530 --> 00:11:06,010
<font color="#CCCCCC">channel</font>

256
00:11:06,930 --> 00:11:12,849
so here's an<font color="#CCCCCC"> example of distracting user</font>

257
00:11:09,640 --> 00:11:16,060
profiles so this actually<font color="#CCCCCC"> is my favorite</font>

258
00:11:12,850 --> 00:11:17,860
thing to<font color="#E5E5E5"> do very first is to pull down</font>

259
00:11:16,060 --> 00:11:19,300
<font color="#E5E5E5">all the users because I'm always</font>

260
00:11:17,860 --> 00:11:21,100
interested<font color="#E5E5E5"> in getting a list of all</font>

261
00:11:19,300 --> 00:11:23,410
users because I<font color="#E5E5E5"> really like to</font><font color="#CCCCCC"> do</font>

262
00:11:21,100 --> 00:11:25,960
password spraying so maybe the<font color="#E5E5E5"> way I got</font>

263
00:11:23,410 --> 00:11:27,790
<font color="#E5E5E5">into slack is I went on to LinkedIn and</font>

264
00:11:25,960 --> 00:11:29,770
found out maybe these 300<font color="#CCCCCC"> people</font><font color="#E5E5E5"> work</font>

265
00:11:27,790 --> 00:11:32,980
for<font color="#CCCCCC"> this company and I</font><font color="#E5E5E5"> did password</font>

266
00:11:29,770 --> 00:11:35,530
<font color="#E5E5E5">spring but you know</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> not a lot of</font>

267
00:11:32,980 --> 00:11:37,540
people<font color="#E5E5E5"> to try to guess passwords for but</font>

268
00:11:35,530 --> 00:11:40,420
eventually I get one<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> I get one</font>

269
00:11:37,540 --> 00:11:41,800
get<font color="#E5E5E5"> into slack and then if I download</font>

270
00:11:40,420 --> 00:11:43,689
<font color="#E5E5E5">the user profiles now I have the whole</font>

271
00:11:41,800 --> 00:11:45,130
<font color="#CCCCCC">company I have usernames for the whole</font>

272
00:11:43,690 --> 00:11:48,220
company<font color="#E5E5E5"> that I can use in</font><font color="#CCCCCC"> that password</font>

273
00:11:45,130 --> 00:11:50,470
<font color="#E5E5E5">spray so now if I went from 300 at 3,000</font>

274
00:11:48,220 --> 00:11:52,690
people<font color="#CCCCCC"> my chances</font><font color="#E5E5E5"> of guessing a password</font>

275
00:11:50,470 --> 00:11:55,540
just went up<font color="#CCCCCC"> ten times</font><font color="#E5E5E5"> so I like to</font>

276
00:11:52,690 --> 00:11:57,910
<font color="#E5E5E5">extract user profiles and the way you do</font>

277
00:11:55,540 --> 00:12:00,370
that is you<font color="#E5E5E5"> just add this extract</font><font color="#CCCCCC"> user</font>

278
00:11:57,910 --> 00:12:02,890
switch<font color="#E5E5E5"> and when you're using this switch</font>

279
00:12:00,370 --> 00:12:05,260
it will not<font color="#CCCCCC"> download files and messages</font>

280
00:12:02,890 --> 00:12:07,600
all it does<font color="#E5E5E5"> is user profiles</font><font color="#CCCCCC"> see you can</font>

281
00:12:05,260 --> 00:12:10,030
run this<font color="#E5E5E5"> separately and in this</font><font color="#CCCCCC"> example</font>

282
00:12:07,600 --> 00:12:12,850
<font color="#E5E5E5">I changed the limit for</font><font color="#CCCCCC"> max users to a</font>

283
00:12:10,030 --> 00:12:16,030
thousand from<font color="#E5E5E5"> the default of a hundred</font>

284
00:12:12,850 --> 00:12:18,970
thousand I think so<font color="#CCCCCC"> if we ran this</font>

285
00:12:16,030 --> 00:12:22,030
inside our my extraction folder metadata

286
00:12:18,970 --> 00:12:25,270
directory there's a<font color="#CCCCCC"> users folder</font><font color="#E5E5E5"> inside</font>

287
00:12:22,030 --> 00:12:27,490
there is<font color="#CCCCCC"> the JSON file for each user and</font>

288
00:12:25,270 --> 00:12:29,370
<font color="#E5E5E5">you can see that on the left you see</font>

289
00:12:27,490 --> 00:12:32,260
details<font color="#E5E5E5"> about the</font><font color="#CCCCCC"> user you see their</font>

290
00:12:29,370 --> 00:12:34,660
display name their phone number<font color="#CCCCCC"> their</font>

291
00:12:32,260 --> 00:12:36,689
email<font color="#E5E5E5"> address</font><font color="#CCCCCC"> their title job title if</font>

292
00:12:34,660 --> 00:12:39,280
they've<font color="#E5E5E5"> entered it in their profile</font><font color="#CCCCCC"> and</font>

293
00:12:36,690 --> 00:12:42,070
<font color="#CCCCCC">then it also rolls that up into</font><font color="#E5E5E5"> all</font>

294
00:12:39,280 --> 00:12:46,180
users<font color="#CCCCCC"> dot CSV so you can open that up</font>

295
00:12:42,070 --> 00:12:48,550
and see<font color="#CCCCCC"> a nice</font><font color="#E5E5E5"> sortable list of all the</font>

296
00:12:46,180 --> 00:12:51,640
<font color="#E5E5E5">users what their display</font><font color="#CCCCCC"> name is</font><font color="#E5E5E5"> whether</font>

297
00:12:48,550 --> 00:12:54,969
they're your admin and<font color="#E5E5E5"> also the display</font>

298
00:12:51,640 --> 00:12:56,980
<font color="#E5E5E5">names often defaults to be their Active</font>

299
00:12:54,970 --> 00:12:58,780
Directory user<font color="#CCCCCC"> name so that again comes</font>

300
00:12:56,980 --> 00:13:03,010
in really<font color="#CCCCCC"> handy for password</font><font color="#E5E5E5"> spring or</font>

301
00:12:58,780 --> 00:13:05,589
<font color="#CCCCCC">it can come in really handy another</font>

302
00:13:03,010 --> 00:13:07,630
option is the<font color="#E5E5E5"> private only switch so</font>

303
00:13:05,589 --> 00:13:09,610
there's public channels which anybody

304
00:13:07,630 --> 00:13:11,410
<font color="#E5E5E5">can talk in and there's private channels</font>

305
00:13:09,610 --> 00:13:13,570
and you might suspect<font color="#E5E5E5"> that some of</font><font color="#CCCCCC"> the</font>

306
00:13:11,410 --> 00:13:16,300
<font color="#CCCCCC">more juicy information gets shared</font><font color="#E5E5E5"> in</font>

307
00:13:13,570 --> 00:13:17,650
those private<font color="#E5E5E5"> channels and so in the</font>

308
00:13:16,300 --> 00:13:18,859
interest of time you might<font color="#E5E5E5"> choose to</font>

309
00:13:17,650 --> 00:13:21,290
<font color="#E5E5E5">only download</font>

310
00:13:18,860 --> 00:13:23,420
<font color="#E5E5E5">the private channel information and</font>

311
00:13:21,290 --> 00:13:26,900
private channels in this case<font color="#E5E5E5"> includes</font>

312
00:13:23,420 --> 00:13:30,020
those group<font color="#E5E5E5"> those private channels which</font>

313
00:13:26,900 --> 00:13:31,910
<font color="#CCCCCC">psych cults groups</font><font color="#E5E5E5"> instant messages</font>

314
00:13:30,020 --> 00:13:33,530
direct messages between<font color="#E5E5E5"> you and one</font>

315
00:13:31,910 --> 00:13:37,130
other<font color="#E5E5E5"> person and</font><font color="#CCCCCC"> also kind of</font><font color="#E5E5E5"> the</font>

316
00:13:33,530 --> 00:13:39,230
<font color="#CCCCCC">multi-party instant messages and so</font><font color="#E5E5E5"> all</font>

317
00:13:37,130 --> 00:13:41,330
you do is<font color="#CCCCCC"> you use the - private</font><font color="#E5E5E5"> only</font>

318
00:13:39,230 --> 00:13:43,100
flag and then I've got the<font color="#E5E5E5"> dot dot dot</font>

319
00:13:41,330 --> 00:13:44,390
on there<font color="#E5E5E5"> just to remind you that you</font>

320
00:13:43,100 --> 00:13:46,220
<font color="#CCCCCC">still have those three required</font>

321
00:13:44,390 --> 00:13:49,040
parameters which is<font color="#CCCCCC"> your output folder</font>

322
00:13:46,220 --> 00:13:50,540
name your slack URL and either your

323
00:13:49,040 --> 00:13:54,290
token or your<font color="#E5E5E5"> D cookie that you need to</font>

324
00:13:50,540 --> 00:13:56,060
have on<font color="#E5E5E5"> there</font><font color="#CCCCCC"> you can specify specific</font>

325
00:13:54,290 --> 00:13:58,459
channel IDs so<font color="#E5E5E5"> if you're only interested</font>

326
00:13:56,060 --> 00:14:00,439
<font color="#E5E5E5">in certain channels you can give a</font>

327
00:13:58,460 --> 00:14:02,270
comma-separated list<font color="#E5E5E5"> of those</font><font color="#CCCCCC"> channels</font>

328
00:14:00,440 --> 00:14:05,420
<font color="#E5E5E5">that you're</font><font color="#CCCCCC"> interested</font><font color="#E5E5E5"> in and only pull</font>

329
00:14:02,270 --> 00:14:07,340
data from<font color="#E5E5E5"> those channels on this flip of</font>

330
00:14:05,420 --> 00:14:08,540
<font color="#CCCCCC">that you can also exclude channels so</font>

331
00:14:07,340 --> 00:14:11,180
you<font color="#E5E5E5"> could say give me</font><font color="#CCCCCC"> all the private</font>

332
00:14:08,540 --> 00:14:12,920
channels except these five that I know

333
00:14:11,180 --> 00:14:15,229
are<font color="#E5E5E5"> bot channels so bot channels are</font>

334
00:14:12,920 --> 00:14:17,750
like<font color="#E5E5E5"> automated messages that come in</font>

335
00:14:15,230 --> 00:14:19,940
maybe from servers<font color="#E5E5E5"> and those are super</font>

336
00:14:17,750 --> 00:14:21,560
boring<font color="#CCCCCC"> I mean you look for a</font><font color="#E5E5E5"> little bit</font>

337
00:14:19,940 --> 00:14:23,870
to see if<font color="#E5E5E5"> it's posting passwords and</font>

338
00:14:21,560 --> 00:14:25,670
after that there's like millions<font color="#CCCCCC"> of</font>

339
00:14:23,870 --> 00:14:27,500
<font color="#CCCCCC">messages and it just clogs up your</font>

340
00:14:25,670 --> 00:14:29,150
<font color="#E5E5E5">system so you you know you want</font><font color="#CCCCCC"> to</font>

341
00:14:27,500 --> 00:14:30,800
ignore<font color="#CCCCCC"> those bot channels for the most</font>

342
00:14:29,150 --> 00:14:32,810
part when<font color="#E5E5E5"> you're looking for this</font>

343
00:14:30,800 --> 00:14:36,650
<font color="#E5E5E5">sensitive information and that gives you</font>

344
00:14:32,810 --> 00:14:39,560
the<font color="#E5E5E5"> option to do</font><font color="#CCCCCC"> it and then extracting</font>

345
00:14:36,650 --> 00:14:42,050
access<font color="#CCCCCC"> locks so this is only an option</font>

346
00:14:39,560 --> 00:14:44,989
if you have<font color="#E5E5E5"> credentials for an admin of</font>

347
00:14:42,050 --> 00:14:47,479
<font color="#E5E5E5">a paid</font><font color="#CCCCCC"> workspace</font><font color="#E5E5E5"> so if this is this free</font>

348
00:14:44,990 --> 00:14:48,800
<font color="#E5E5E5">workspace that</font><font color="#CCCCCC"> slack offers you won't be</font>

349
00:14:47,480 --> 00:14:50,090
able<font color="#E5E5E5"> to do it and if you don't have</font>

350
00:14:48,800 --> 00:14:51,650
credentials<font color="#E5E5E5"> for an admin you won't be</font>

351
00:14:50,090 --> 00:14:56,440
<font color="#E5E5E5">able to do it but if you happen</font><font color="#CCCCCC"> to have</font>

352
00:14:51,650 --> 00:15:00,800
that<font color="#E5E5E5"> this is handy</font><font color="#CCCCCC"> because you can</font>

353
00:14:56,440 --> 00:15:03,590
download all the access logs<font color="#E5E5E5"> and inside</font>

354
00:15:00,800 --> 00:15:05,750
the<font color="#CCCCCC"> each access log again as a JSON</font>

355
00:15:03,590 --> 00:15:08,420
<font color="#E5E5E5">format but it says the user their</font>

356
00:15:05,750 --> 00:15:10,850
display name<font color="#E5E5E5"> when they access the system</font>

357
00:15:08,420 --> 00:15:12,949
from what IP and what user<font color="#CCCCCC"> agent</font><font color="#E5E5E5"> so now</font>

358
00:15:10,850 --> 00:15:16,040
you know<font color="#CCCCCC"> the</font><font color="#E5E5E5"> IPS your users are coming</font>

359
00:15:12,950 --> 00:15:17,450
<font color="#E5E5E5">from and their user agent which</font><font color="#CCCCCC"> tells</font>

360
00:15:16,040 --> 00:15:20,209
you<font color="#E5E5E5"> information about what operating</font>

361
00:15:17,450 --> 00:15:22,010
system they're using<font color="#CCCCCC"> and</font><font color="#E5E5E5"> what software</font>

362
00:15:20,210 --> 00:15:24,080
<font color="#E5E5E5">they use on their system which can help</font>

363
00:15:22,010 --> 00:15:29,000
you do a targeted<font color="#CCCCCC"> attack</font><font color="#E5E5E5"> later so that's</font>

364
00:15:24,080 --> 00:15:31,670
good reconnaissance<font color="#CCCCCC"> what if we ID what</font>

365
00:15:29,000 --> 00:15:32,420
if I can't find the<font color="#CCCCCC"> D cookie or I've</font><font color="#E5E5E5"> got</font>

366
00:15:31,670 --> 00:15:34,310
<font color="#E5E5E5">access to</font>

367
00:15:32,420 --> 00:15:36,639
system but it's<font color="#E5E5E5"> not like a graphical</font>

368
00:15:34,310 --> 00:15:39,670
user<font color="#E5E5E5"> interface it's like a man line</font>

369
00:15:36,639 --> 00:15:42,350
<font color="#CCCCCC">connection maybe through a c2 session</font>

370
00:15:39,670 --> 00:15:45,199
<font color="#CCCCCC">you can also just</font><font color="#E5E5E5"> look directly for</font><font color="#CCCCCC"> the</font>

371
00:15:42,350 --> 00:15:47,180
token<font color="#CCCCCC"> and I give two commands to do that</font>

372
00:15:45,200 --> 00:15:49,490
one for a<font color="#E5E5E5"> Mac and one for</font><font color="#CCCCCC"> Windows to</font>

373
00:15:47,180 --> 00:15:53,420
pull out<font color="#E5E5E5"> that token in places that it</font>

374
00:15:49,490 --> 00:15:55,010
<font color="#E5E5E5">gets stored on those systems</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> think it</font>

375
00:15:53,420 --> 00:15:57,290
actually<font color="#CCCCCC"> gets stored there if they're</font>

376
00:15:55,010 --> 00:15:58,699
<font color="#CCCCCC">using</font><font color="#E5E5E5"> the slack app I don't I'm</font><font color="#CCCCCC"> not</font>

377
00:15:57,290 --> 00:16:01,670
positive<font color="#E5E5E5"> this applies if they're using</font>

378
00:15:58,699 --> 00:16:03,260
<font color="#E5E5E5">their browser only but for this like you</font>

379
00:16:01,670 --> 00:16:06,079
can find<font color="#CCCCCC"> those tokens</font><font color="#E5E5E5"> again this is on</font>

380
00:16:03,260 --> 00:16:08,660
github<font color="#CCCCCC"> on the wiki proportion you can</font>

381
00:16:06,079 --> 00:16:10,550
find these commands so there's an

382
00:16:08,660 --> 00:16:13,819
example<font color="#CCCCCC"> at the</font><font color="#E5E5E5"> bottom where you can</font>

383
00:16:10,550 --> 00:16:20,109
<font color="#E5E5E5">invoke slack extract and we give the</font>

384
00:16:13,820 --> 00:16:23,180
slack token here instead<font color="#CCCCCC"> of the D cookie</font>

385
00:16:20,110 --> 00:16:31,760
okay so here<font color="#CCCCCC"> we</font><font color="#E5E5E5"> have a demo</font><font color="#CCCCCC"> of all this</font>

386
00:16:23,180 --> 00:16:33,709
put together and didn't play<font color="#E5E5E5"> okay so on</font>

387
00:16:31,760 --> 00:16:36,560
the right we<font color="#CCCCCC"> have our</font><font color="#E5E5E5"> select extract</font>

388
00:16:33,709 --> 00:16:40,040
<font color="#E5E5E5">workspace</font><font color="#CCCCCC"> that we're logged into there's</font>

389
00:16:36,560 --> 00:16:41,149
a general<font color="#E5E5E5"> channel a public channel in</font>

390
00:16:40,040 --> 00:16:42,680
the public<font color="#CCCCCC"> channel there's like</font><font color="#E5E5E5"> this</font>

391
00:16:41,149 --> 00:16:44,990
<font color="#CCCCCC">picture of a carnival in this weird</font>

392
00:16:42,680 --> 00:16:47,209
picture of<font color="#E5E5E5"> a mask on a wand and the</font>

393
00:16:44,990 --> 00:16:50,240
random channel<font color="#E5E5E5"> there's a bluebird</font>

394
00:16:47,209 --> 00:16:52,069
sticker<font color="#E5E5E5"> sheet and a pink unicorn</font><font color="#CCCCCC"> so</font>

395
00:16:50,240 --> 00:16:56,930
we're we're gonna run slack extract

396
00:16:52,070 --> 00:16:58,610
script on this workspace<font color="#E5E5E5"> and the output</font>

397
00:16:56,930 --> 00:17:00,529
is<font color="#E5E5E5"> going to</font><font color="#CCCCCC"> go to the C temp directory</font>

398
00:16:58,610 --> 00:17:04,189
so we'll be<font color="#CCCCCC"> watching over</font><font color="#E5E5E5"> there for what</font>

399
00:17:00,529 --> 00:17:06,020
shows up<font color="#E5E5E5"> when we run the script okay</font><font color="#CCCCCC"> so</font>

400
00:17:04,189 --> 00:17:09,290
here we<font color="#E5E5E5"> have our command invoke slack</font>

401
00:17:06,020 --> 00:17:11,179
extract<font color="#CCCCCC"> we give it our slack URL which</font>

402
00:17:09,290 --> 00:17:13,909
for this<font color="#E5E5E5"> example is slack extract out</font>

403
00:17:11,179 --> 00:17:16,160
slack<font color="#E5E5E5"> comm output folder name again</font><font color="#CCCCCC"> is</font>

404
00:17:13,910 --> 00:17:19,579
<font color="#E5E5E5">going to be my extraction</font><font color="#CCCCCC"> and we're</font>

405
00:17:16,160 --> 00:17:21,890
using an optional<font color="#CCCCCC"> parameter to tell it</font>

406
00:17:19,579 --> 00:17:24,470
<font color="#E5E5E5">to write to C temp instead of the</font>

407
00:17:21,890 --> 00:17:30,770
documents directory<font color="#CCCCCC"> and then we give</font><font color="#E5E5E5"> it</font>

408
00:17:24,470 --> 00:17:32,690
our slack token<font color="#CCCCCC"> there's several optional</font>

409
00:17:30,770 --> 00:17:34,549
parameters<font color="#E5E5E5"> that I'm not talking</font><font color="#CCCCCC"> about in</font>

410
00:17:32,690 --> 00:17:37,190
this demo but if you run that get help

411
00:17:34,549 --> 00:17:43,250
<font color="#CCCCCC">it will tell you what those extra</font>

412
00:17:37,190 --> 00:17:45,440
options are so we run this and<font color="#CCCCCC"> over here</font>

413
00:17:43,250 --> 00:17:46,040
we see the slack extract folder show up

414
00:17:45,440 --> 00:17:48,620
and inside

415
00:17:46,040 --> 00:17:50,810
is in my extraction folder we start to

416
00:17:48,620 --> 00:17:53,149
see folders<font color="#E5E5E5"> for every channel popping up</font>

417
00:17:50,810 --> 00:17:55,129
and those those<font color="#E5E5E5"> pop up and they get</font>

418
00:17:53,150 --> 00:17:56,930
filled with<font color="#E5E5E5"> those Jason messages so we</font>

419
00:17:55,130 --> 00:17:58,880
<font color="#E5E5E5">look in the</font><font color="#CCCCCC"> jet</font><font color="#E5E5E5"> and the messages folder</font>

420
00:17:56,930 --> 00:18:01,280
there's every message<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> a small</font>

421
00:17:58,880 --> 00:18:03,290
demo<font color="#CCCCCC"> channel and then we go</font><font color="#E5E5E5"> into files</font>

422
00:18:01,280 --> 00:18:05,000
files get<font color="#E5E5E5"> downloaded very last so it</font>

423
00:18:03,290 --> 00:18:07,100
isn't<font color="#CCCCCC"> till all the messages for all the</font>

424
00:18:05,000 --> 00:18:08,780
<font color="#E5E5E5">channels get downloaded that that gets</font>

425
00:18:07,100 --> 00:18:10,310
downloaded but we see our images there

426
00:18:08,780 --> 00:18:12,110
we can go back<font color="#E5E5E5"> that was the random</font>

427
00:18:10,310 --> 00:18:15,139
<font color="#E5E5E5">channel we could go back to the files</font>

428
00:18:12,110 --> 00:18:16,459
for the general<font color="#E5E5E5"> channel and we can see</font>

429
00:18:15,140 --> 00:18:17,870
that<font color="#CCCCCC"> this is a bigger file so it's</font>

430
00:18:16,460 --> 00:18:19,370
taking them longer<font color="#CCCCCC"> to download</font><font color="#E5E5E5"> but then</font>

431
00:18:17,870 --> 00:18:23,300
we see the carnival image<font color="#E5E5E5"> in the mask</font>

432
00:18:19,370 --> 00:18:25,489
image<font color="#E5E5E5"> so now we have an offline copy of</font>

433
00:18:23,300 --> 00:18:28,129
all that<font color="#E5E5E5"> information now we're just</font>

434
00:18:25,490 --> 00:18:30,020
<font color="#E5E5E5">going to add on the - extract users and</font>

435
00:18:28,130 --> 00:18:33,200
we're<font color="#E5E5E5"> gonna pull all those user profiles</font>

436
00:18:30,020 --> 00:18:35,389
in and that's already done<font color="#E5E5E5"> because</font>

437
00:18:33,200 --> 00:18:38,330
there's only<font color="#CCCCCC"> three</font><font color="#E5E5E5"> users but if we go</font>

438
00:18:35,390 --> 00:18:41,180
<font color="#E5E5E5">back and go into</font><font color="#CCCCCC"> the meta folder under</font>

439
00:18:38,330 --> 00:18:44,810
users we see the JSON file for each user

440
00:18:41,180 --> 00:18:47,620
and<font color="#E5E5E5"> the CSV file that puts all those</font>

441
00:18:44,810 --> 00:18:50,510
<font color="#E5E5E5">users together in one the ez file for us</font>

442
00:18:47,620 --> 00:18:52,459
and we could get the title phone number

443
00:18:50,510 --> 00:18:57,379
if the users<font color="#E5E5E5"> have entered</font><font color="#CCCCCC"> it their email</font>

444
00:18:52,460 --> 00:18:59,660
their image<font color="#E5E5E5"> their display name etc so</font>

445
00:18:57,380 --> 00:19:01,490
back on that wiki right now I have two

446
00:18:59,660 --> 00:19:03,980
wiki pages I'll keep this<font color="#CCCCCC"> updated with</font>

447
00:19:01,490 --> 00:19:05,960
relevant information but one is about

448
00:19:03,980 --> 00:19:08,720
<font color="#CCCCCC">authorization so all those notes on how</font>

449
00:19:05,960 --> 00:19:12,530
to get<font color="#CCCCCC"> your d cookie our token and then</font>

450
00:19:08,720 --> 00:19:14,150
how to<font color="#CCCCCC"> some some tips</font><font color="#E5E5E5"> on analyzing your</font>

451
00:19:12,530 --> 00:19:18,500
results<font color="#E5E5E5"> after you've pulled everything</font>

452
00:19:14,150 --> 00:19:20,690
down so first is authorization<font color="#E5E5E5"> and</font>

453
00:19:18,500 --> 00:19:22,610
that's this<font color="#CCCCCC"> is straight</font><font color="#E5E5E5"> from that slide</font>

454
00:19:20,690 --> 00:19:26,930
getting your<font color="#CCCCCC"> D</font><font color="#E5E5E5"> cookie or getting your</font>

455
00:19:22,610 --> 00:19:29,510
<font color="#E5E5E5">sock token and then analyzing the</font>

456
00:19:26,930 --> 00:19:31,130
results<font color="#E5E5E5"> so when all these messages get</font>

457
00:19:29,510 --> 00:19:33,680
written<font color="#E5E5E5"> to file they get written in</font>

458
00:19:31,130 --> 00:19:37,100
default<font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> output format which</font>

459
00:19:33,680 --> 00:19:39,680
is utf-16<font color="#CCCCCC"> and I saw someone stick out</font>

460
00:19:37,100 --> 00:19:41,840
their tongue<font color="#CCCCCC"> and shake their head they</font>

461
00:19:39,680 --> 00:19:43,730
don't<font color="#CCCCCC"> like that you</font><font color="#E5E5E5"> could change the</font>

462
00:19:41,840 --> 00:19:46,010
script and<font color="#E5E5E5"> make</font><font color="#CCCCCC"> it right out</font><font color="#E5E5E5"> and ask you</font>

463
00:19:43,730 --> 00:19:48,230
if you want<font color="#E5E5E5"> but that I left</font><font color="#CCCCCC"> that the</font>

464
00:19:46,010 --> 00:19:51,470
default<font color="#E5E5E5"> but I give</font><font color="#CCCCCC"> you some pointers on</font>

465
00:19:48,230 --> 00:19:53,210
how to wait so the problem with<font color="#CCCCCC"> that is</font>

466
00:19:51,470 --> 00:19:55,340
when you go if you tried<font color="#E5E5E5"> to grep through</font>

467
00:19:53,210 --> 00:19:56,810
these files for the word<font color="#CCCCCC"> password even</font>

468
00:19:55,340 --> 00:19:58,639
<font color="#E5E5E5">though the word password is in there it</font>

469
00:19:56,810 --> 00:19:59,510
won't find it because<font color="#CCCCCC"> of the formatting</font>

470
00:19:58,640 --> 00:20:01,400
<font color="#E5E5E5">difference</font>

471
00:19:59,510 --> 00:20:05,900
<font color="#CCCCCC">I give some tips</font><font color="#E5E5E5"> on basically how</font><font color="#CCCCCC"> to</font>

472
00:20:01,400 --> 00:20:07,190
grep using<font color="#E5E5E5"> PowerShell for you</font><font color="#CCCCCC"> and so for</font>

473
00:20:05,900 --> 00:20:09,260
example<font color="#CCCCCC"> if you want to extract all the</font>

474
00:20:07,190 --> 00:20:10,760
<font color="#CCCCCC">user names this is kind of the</font>

475
00:20:09,260 --> 00:20:13,220
<font color="#CCCCCC">PowerShell version of grepping so you</font>

476
00:20:10,760 --> 00:20:14,990
could select string and select name<font color="#CCCCCC"> and</font>

477
00:20:13,220 --> 00:20:20,300
that<font color="#E5E5E5"> would give you all the names of all</font>

478
00:20:14,990 --> 00:20:22,580
<font color="#E5E5E5">the users</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> or you could do the email</font>

479
00:20:20,300 --> 00:20:24,050
<font color="#E5E5E5">addresses if you wanted to select the</font>

480
00:20:22,580 --> 00:20:26,720
title<font color="#E5E5E5"> and the name</font><font color="#CCCCCC"> you could</font><font color="#E5E5E5"> do</font>

481
00:20:24,050 --> 00:20:28,220
<font color="#E5E5E5">something command like that</font><font color="#CCCCCC"> and if you</font>

482
00:20:26,720 --> 00:20:30,050
wanted<font color="#E5E5E5"> to just write the user names to a</font>

483
00:20:28,220 --> 00:20:32,810
file which is really handy<font color="#CCCCCC"> for</font><font color="#E5E5E5"> password</font>

484
00:20:30,050 --> 00:20:34,129
<font color="#E5E5E5">spring you could use that command and</font>

485
00:20:32,810 --> 00:20:38,720
there's a little<font color="#CCCCCC"> description at the end</font>

486
00:20:34,130 --> 00:20:42,350
how that kind of how that<font color="#E5E5E5"> search works</font>

487
00:20:38,720 --> 00:20:44,330
there<font color="#E5E5E5"> so that's kind of useful</font><font color="#CCCCCC"> okay so</font>

488
00:20:42,350 --> 00:20:47,449
the advantages of using<font color="#E5E5E5"> slack extract</font>

489
00:20:44,330 --> 00:20:50,149
<font color="#E5E5E5">are that you quickly get an offline copy</font>

490
00:20:47,450 --> 00:20:54,020
of all the<font color="#E5E5E5"> data</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that this user has</font>

491
00:20:50,150 --> 00:20:56,090
<font color="#CCCCCC">access to so if</font><font color="#E5E5E5"> you were to lose access</font>

492
00:20:54,020 --> 00:20:59,060
shortly after gaining<font color="#CCCCCC"> it at least you</font>

493
00:20:56,090 --> 00:21:02,240
have<font color="#E5E5E5"> that data</font><font color="#CCCCCC"> available to</font><font color="#E5E5E5"> you to still</font>

494
00:20:59,060 --> 00:21:05,330
look through<font color="#CCCCCC"> also you can search through</font>

495
00:21:02,240 --> 00:21:07,250
that data<font color="#E5E5E5"> offline which means anything</font>

496
00:21:05,330 --> 00:21:10,220
like if you're certain<font color="#E5E5E5"> searching for</font>

497
00:21:07,250 --> 00:21:11,510
certain sensitive words<font color="#CCCCCC"> the defenders</font>

498
00:21:10,220 --> 00:21:14,300
won't see that if you're<font color="#E5E5E5"> just typing</font>

499
00:21:11,510 --> 00:21:15,530
<font color="#E5E5E5">that</font><font color="#CCCCCC"> into slack</font><font color="#E5E5E5"> search thing they could</font>

500
00:21:14,300 --> 00:21:17,510
potentially have alerts<font color="#E5E5E5"> that say if</font>

501
00:21:15,530 --> 00:21:20,690
people<font color="#E5E5E5"> start searching</font><font color="#CCCCCC"> for any of</font><font color="#E5E5E5"> these</font>

502
00:21:17,510 --> 00:21:24,230
keywords<font color="#E5E5E5"> like password and Amazon has</font>

503
00:21:20,690 --> 00:21:25,850
<font color="#CCCCCC">three keys and these</font><font color="#E5E5E5"> things alert us</font>

504
00:21:24,230 --> 00:21:27,320
because<font color="#CCCCCC"> that seems suspicious so if</font>

505
00:21:25,850 --> 00:21:29,990
you're doing<font color="#E5E5E5"> that offline you don't have</font>

506
00:21:27,320 --> 00:21:32,899
to worry<font color="#CCCCCC"> about those alerts</font><font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can</font>

507
00:21:29,990 --> 00:21:36,430
do quicker and more powerful<font color="#E5E5E5"> searches</font>

508
00:21:32,900 --> 00:21:39,020
without going through the<font color="#E5E5E5"> online version</font>

509
00:21:36,430 --> 00:21:40,970
so<font color="#CCCCCC"> that</font><font color="#E5E5E5"> brings us to the point where we</font>

510
00:21:39,020 --> 00:21:44,240
have this great tool for basically

511
00:21:40,970 --> 00:21:47,000
reconnaissance using<font color="#CCCCCC"> this slack API</font><font color="#E5E5E5"> with</font>

512
00:21:44,240 --> 00:21:49,850
<font color="#E5E5E5">credentials that we have so now on the</font>

513
00:21:47,000 --> 00:21:52,550
<font color="#CCCCCC">flipside as defenders we're interested</font>

514
00:21:49,850 --> 00:21:53,689
in knowing<font color="#CCCCCC"> that this is being</font><font color="#E5E5E5"> used cuz</font>

515
00:21:52,550 --> 00:21:55,370
this<font color="#E5E5E5"> definitely is going to have a</font>

516
00:21:53,690 --> 00:21:57,320
different look<font color="#E5E5E5"> and</font><font color="#CCCCCC"> feel if you had</font>

517
00:21:55,370 --> 00:21:59,510
access<font color="#E5E5E5"> to the locks</font><font color="#CCCCCC"> you know you've got</font>

518
00:21:57,320 --> 00:22:01,399
<font color="#E5E5E5">somebody who just downloaded millions of</font>

519
00:21:59,510 --> 00:22:05,870
messages<font color="#E5E5E5"> thousands of files all in a</font>

520
00:22:01,400 --> 00:22:07,700
short timeframe which humans could never

521
00:22:05,870 --> 00:22:09,500
go<font color="#E5E5E5"> through the slack API and right-click</font>

522
00:22:07,700 --> 00:22:10,940
<font color="#E5E5E5">a file and say download that</font><font color="#CCCCCC"> pass so you</font>

523
00:22:09,500 --> 00:22:12,130
know something's<font color="#E5E5E5"> up and maybe you could</font>

524
00:22:10,940 --> 00:22:14,710
determine<font color="#E5E5E5"> that this user</font>

525
00:22:12,130 --> 00:22:19,300
been compromised<font color="#CCCCCC"> and</font><font color="#E5E5E5"> so I turn it over</font>

526
00:22:14,710 --> 00:22:21,850
<font color="#E5E5E5">to Tony to talk about that portion</font><font color="#CCCCCC"> thank</font>

527
00:22:19,300 --> 00:22:23,590
<font color="#CCCCCC">you</font><font color="#E5E5E5"> Carrie</font><font color="#CCCCCC"> that that is great</font>

528
00:22:21,850 --> 00:22:25,120
information<font color="#CCCCCC"> and we can't discount</font><font color="#E5E5E5"> the</font>

529
00:22:23,590 --> 00:22:27,850
fact<font color="#CCCCCC"> that this script is good for Blue</font>

530
00:22:25,120 --> 00:22:30,010
team also because we can go through see

531
00:22:27,850 --> 00:22:32,110
what somebody<font color="#E5E5E5"> can find and then you know</font>

532
00:22:30,010 --> 00:22:36,850
<font color="#CCCCCC">exactly how much sensitive</font><font color="#E5E5E5"> data you have</font>

533
00:22:32,110 --> 00:22:37,360
sitting<font color="#E5E5E5"> out there so detection where to</font>

534
00:22:36,850 --> 00:22:40,060
start

535
00:22:37,360 --> 00:22:41,530
this was a overwhelming thing for us<font color="#CCCCCC"> to</font>

536
00:22:40,060 --> 00:22:43,000
<font color="#E5E5E5">first we had</font><font color="#CCCCCC"> to look at</font><font color="#E5E5E5"> it we're like</font>

537
00:22:41,530 --> 00:22:45,160
man that that's a lot<font color="#CCCCCC"> of information</font>

538
00:22:43,000 --> 00:22:47,890
<font color="#E5E5E5">that</font><font color="#CCCCCC"> can be</font><font color="#E5E5E5"> just pulled right</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> we</font>

539
00:22:45,160 --> 00:22:49,930
wanted<font color="#E5E5E5"> to know what</font><font color="#CCCCCC"> carry</font><font color="#E5E5E5"> script did so</font>

540
00:22:47,890 --> 00:22:51,880
we worked with<font color="#E5E5E5"> Carrie</font><font color="#CCCCCC"> we looked</font><font color="#E5E5E5"> through</font>

541
00:22:49,930 --> 00:22:54,040
the script we've learned the script we

542
00:22:51,880 --> 00:22:56,350
run the script<font color="#CCCCCC"> again very useful for</font>

543
00:22:54,040 --> 00:22:58,600
<font color="#CCCCCC">Blue</font><font color="#E5E5E5"> team also and then we had to go</font>

544
00:22:56,350 --> 00:23:01,360
back<font color="#E5E5E5"> and learn</font><font color="#CCCCCC"> our sources we have</font><font color="#E5E5E5"> an</font>

545
00:22:58,600 --> 00:23:03,909
audit log<font color="#E5E5E5"> API which is documented in</font>

546
00:23:01,360 --> 00:23:06,550
slack<font color="#CCCCCC"> it's on their website and then you</font>

547
00:23:03,910 --> 00:23:09,040
have the<font color="#E5E5E5"> nor other normal API methods</font>

548
00:23:06,550 --> 00:23:11,020
<font color="#E5E5E5">and it's listed under methods</font><font color="#CCCCCC"> there are</font>

549
00:23:09,040 --> 00:23:13,000
<font color="#CCCCCC">a</font><font color="#E5E5E5"> few other api's that they use</font>

550
00:23:11,020 --> 00:23:16,450
depending<font color="#CCCCCC"> on what you're</font><font color="#E5E5E5"> looking for</font>

551
00:23:13,000 --> 00:23:17,890
such as events but once we looked at our

552
00:23:16,450 --> 00:23:19,210
API so we kind<font color="#E5E5E5"> of knew what we were</font>

553
00:23:17,890 --> 00:23:20,470
<font color="#CCCCCC">looking at we needed to go back</font><font color="#E5E5E5"> and</font>

554
00:23:19,210 --> 00:23:23,140
<font color="#E5E5E5">decide what we wanted to do with the</font>

555
00:23:20,470 --> 00:23:24,910
data<font color="#E5E5E5"> so we needed</font><font color="#CCCCCC"> to decide are we</font><font color="#E5E5E5"> gonna</font>

556
00:23:23,140 --> 00:23:26,710
put it in a seam<font color="#E5E5E5"> are we gonna build a</font>

557
00:23:24,910 --> 00:23:29,410
<font color="#E5E5E5">custom alerting module what do we need</font>

558
00:23:26,710 --> 00:23:30,640
<font color="#E5E5E5">to do everybody's gonna be</font><font color="#CCCCCC"> a little</font>

559
00:23:29,410 --> 00:23:32,320
<font color="#CCCCCC">different</font><font color="#E5E5E5"> depending on the size</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> your</font>

560
00:23:30,640 --> 00:23:33,940
company<font color="#E5E5E5"> you may not have a</font><font color="#CCCCCC"> seam so you</font>

561
00:23:32,320 --> 00:23:37,899
may<font color="#E5E5E5"> have to build a custom learning tool</font>

562
00:23:33,940 --> 00:23:40,780
which is where we started<font color="#E5E5E5"> learn our</font>

563
00:23:37,900 --> 00:23:42,870
sources<font color="#E5E5E5"> each API has different formats</font>

564
00:23:40,780 --> 00:23:45,280
<font color="#CCCCCC">for the most part the API audit log</font>

565
00:23:42,870 --> 00:23:48,909
really tried<font color="#E5E5E5"> to standardize</font><font color="#CCCCCC"> how their</font>

566
00:23:45,280 --> 00:23:50,080
output goes the others they change<font color="#E5E5E5"> every</font>

567
00:23:48,910 --> 00:23:52,180
now and then slack will go through and

568
00:23:50,080 --> 00:23:54,429
be like hey<font color="#E5E5E5"> we didn't have this column</font>

569
00:23:52,180 --> 00:23:56,500
<font color="#CCCCCC">in our database but we needed</font><font color="#E5E5E5"> to add it</font>

570
00:23:54,430 --> 00:23:58,180
so we added it<font color="#E5E5E5"> so all of a sudden you're</font>

571
00:23:56,500 --> 00:23:59,260
putting into<font color="#E5E5E5"> a structured database and</font>

572
00:23:58,180 --> 00:24:01,870
you have a new column you're not

573
00:23:59,260 --> 00:24:04,090
recording<font color="#E5E5E5"> anymore so we had to take that</font>

574
00:24:01,870 --> 00:24:05,350
<font color="#CCCCCC">into account in</font><font color="#E5E5E5"> the auto log API they</font>

575
00:24:04,090 --> 00:24:07,389
try and<font color="#E5E5E5"> break</font><font color="#CCCCCC"> everything down</font><font color="#E5E5E5"> into an</font>

576
00:24:05,350 --> 00:24:10,929
action an actor and entity and what

577
00:24:07,390 --> 00:24:13,060
context<font color="#E5E5E5"> so in these these are logins</font><font color="#CCCCCC"> so</font>

578
00:24:10,930 --> 00:24:15,580
<font color="#CCCCCC">our actor and our entity are the same</font>

579
00:24:13,060 --> 00:24:18,310
exact information<font color="#E5E5E5"> if you're looking at</font>

580
00:24:15,580 --> 00:24:19,840
files downloaded the entity is actually

581
00:24:18,310 --> 00:24:23,379
<font color="#E5E5E5">going to be the file information</font><font color="#CCCCCC"> the</font>

582
00:24:19,840 --> 00:24:25,990
name<font color="#E5E5E5"> what the file ID is in slack</font><font color="#CCCCCC"> what</font>

583
00:24:23,380 --> 00:24:28,570
type of<font color="#E5E5E5"> file it was when it</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> uploaded</font>

584
00:24:25,990 --> 00:24:30,040
that type of<font color="#E5E5E5"> information on the flip</font>

585
00:24:28,570 --> 00:24:32,980
<font color="#E5E5E5">side when we were looking</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> our</font>

586
00:24:30,040 --> 00:24:34,510
standard API methods<font color="#E5E5E5"> if we're</font><font color="#CCCCCC"> looking</font><font color="#E5E5E5"> at</font>

587
00:24:32,980 --> 00:24:36,790
the<font color="#E5E5E5"> events for user login we've got</font>

588
00:24:34,510 --> 00:24:40,379
something<font color="#E5E5E5"> called date last that's the</font>

589
00:24:36,790 --> 00:24:43,420
<font color="#E5E5E5">last combination that the IP address the</font>

590
00:24:40,380 --> 00:24:46,000
<font color="#E5E5E5">user agent</font><font color="#CCCCCC"> and the user name were logged</font>

591
00:24:43,420 --> 00:24:47,679
in<font color="#E5E5E5"> from so they use a combination</font><font color="#CCCCCC"> as</font>

592
00:24:46,000 --> 00:24:49,510
<font color="#CCCCCC">well as when the first time</font><font color="#E5E5E5"> they saw it</font>

593
00:24:47,679 --> 00:24:52,540
<font color="#E5E5E5">was so rather than getting a hey this</font>

594
00:24:49,510 --> 00:24:53,980
<font color="#E5E5E5">user logged in today 50 times they say</font>

595
00:24:52,540 --> 00:24:58,720
hey we've seen this pattern once<font color="#E5E5E5"> and</font>

596
00:24:53,980 --> 00:25:00,550
<font color="#E5E5E5">this is when we first saw</font><font color="#CCCCCC"> it so kind of</font>

597
00:24:58,720 --> 00:25:02,679
<font color="#E5E5E5">the differences Auto log API does</font>

598
00:25:00,550 --> 00:25:05,290
require you be an owner or<font color="#E5E5E5"> an admin</font><font color="#CCCCCC"> it</font>

599
00:25:02,679 --> 00:25:06,460
is designed for<font color="#E5E5E5"> monitoring that's kind</font>

600
00:25:05,290 --> 00:25:08,889
<font color="#E5E5E5">of key when you're looking at this and</font>

601
00:25:06,460 --> 00:25:10,780
it separates logs<font color="#E5E5E5"> your login and</font><font color="#CCCCCC"> your</font>

602
00:25:08,890 --> 00:25:13,470
log off events are separate your file

603
00:25:10,780 --> 00:25:16,480
upload download<font color="#E5E5E5"> they're separated</font>

604
00:25:13,470 --> 00:25:17,920
<font color="#CCCCCC">standard</font><font color="#E5E5E5"> and corporate exports</font><font color="#CCCCCC"> you have</font>

605
00:25:16,480 --> 00:25:19,540
the ability to export<font color="#CCCCCC"> some data</font>

606
00:25:17,920 --> 00:25:21,820
depending on what<font color="#E5E5E5"> level of slack you</font>

607
00:25:19,540 --> 00:25:24,280
have so<font color="#E5E5E5"> you can actually go</font><font color="#CCCCCC"> through</font><font color="#E5E5E5"> and</font>

608
00:25:21,820 --> 00:25:26,320
monitor who's downloaded these who's

609
00:25:24,280 --> 00:25:29,170
been joining channels<font color="#CCCCCC"> role changing if</font>

610
00:25:26,320 --> 00:25:31,270
you're looking for someone<font color="#E5E5E5"> getting in</font>

611
00:25:29,170 --> 00:25:32,830
and trying to elevate<font color="#E5E5E5"> to an account they</font>

612
00:25:31,270 --> 00:25:35,470
may<font color="#E5E5E5"> get another account they may</font><font color="#CCCCCC"> elevate</font>

613
00:25:32,830 --> 00:25:37,870
it you can monitor for that<font color="#E5E5E5"> on the</font>

614
00:25:35,470 --> 00:25:40,360
<font color="#CCCCCC">flipside if you only have access</font><font color="#E5E5E5"> to the</font>

615
00:25:37,870 --> 00:25:42,370
<font color="#E5E5E5">API logs you're looking at any standard</font>

616
00:25:40,360 --> 00:25:44,110
user can<font color="#CCCCCC"> use it as Kerry's demonstrated</font>

617
00:25:42,370 --> 00:25:48,070
you can use the<font color="#E5E5E5"> D cookie or their token</font>

618
00:25:44,110 --> 00:25:49,959
<font color="#E5E5E5">it's designed for user interaction it's</font>

619
00:25:48,070 --> 00:25:52,649
not really<font color="#E5E5E5"> designed for logging so what</font>

620
00:25:49,960 --> 00:25:56,470
you get back<font color="#E5E5E5"> isn't really ideal</font><font color="#CCCCCC"> for that</font>

621
00:25:52,650 --> 00:25:58,270
<font color="#CCCCCC">it's a lot less comprehensive it doesn't</font>

622
00:25:56,470 --> 00:26:00,880
contain separate files for who

623
00:25:58,270 --> 00:26:03,820
downloaded<font color="#E5E5E5"> what the file downloads</font>

624
00:26:00,880 --> 00:26:06,370
aren't included<font color="#CCCCCC"> it does allow for</font><font color="#E5E5E5"> login</font>

625
00:26:03,820 --> 00:26:07,600
events and<font color="#E5E5E5"> channels</font><font color="#CCCCCC"> dot history like</font>

626
00:26:06,370 --> 00:26:12,129
<font color="#CCCCCC">Carrie was showing it also allows for</font>

627
00:26:07,600 --> 00:26:17,050
<font color="#E5E5E5">other similar</font><font color="#CCCCCC"> API calls to</font><font color="#E5E5E5"> be made</font><font color="#CCCCCC"> so</font>

628
00:26:12,130 --> 00:26:19,780
that's something<font color="#E5E5E5"> to be aware of also so</font>

629
00:26:17,050 --> 00:26:21,340
when we're calling the the api's<font color="#E5E5E5"> with</font>

630
00:26:19,780 --> 00:26:24,550
the audit log<font color="#E5E5E5"> API which is where we</font>

631
00:26:21,340 --> 00:26:26,199
<font color="#CCCCCC">primarily focused for our alerting</font><font color="#E5E5E5"> it</font>

632
00:26:24,550 --> 00:26:28,990
<font color="#E5E5E5">uses what's called a bearer token which</font>

633
00:26:26,200 --> 00:26:30,610
we've all seen you know<font color="#E5E5E5"> Facebook did a</font>

634
00:26:28,990 --> 00:26:32,260
similar<font color="#CCCCCC"> thing they had</font><font color="#E5E5E5"> that nice</font>

635
00:26:30,610 --> 00:26:35,590
<font color="#CCCCCC">wonderful little news article recently</font>

636
00:26:32,260 --> 00:26:38,860
<font color="#E5E5E5">about those</font><font color="#CCCCCC"> tokens</font><font color="#E5E5E5"> you have to call the</font>

637
00:26:35,590 --> 00:26:39,610
bearer tokens the audit log API uses one

638
00:26:38,860 --> 00:26:43,870
rather than

639
00:26:39,610 --> 00:26:45,699
user<font color="#CCCCCC"> the bearer tokens can</font><font color="#E5E5E5"> be really</font>

640
00:26:43,870 --> 00:26:47,379
problematic<font color="#E5E5E5"> to set up and it's not just</font>

641
00:26:45,700 --> 00:26:48,760
<font color="#E5E5E5">the first time you do it you actually</font>

642
00:26:47,380 --> 00:26:50,200
<font color="#E5E5E5">have</font><font color="#CCCCCC"> to go through an authorization</font>

643
00:26:48,760 --> 00:26:52,750
process through slack and you<font color="#E5E5E5"> go through</font>

644
00:26:50,200 --> 00:26:55,000
<font color="#E5E5E5">you set up the API you set up the token</font>

645
00:26:52,750 --> 00:26:58,150
you set up the<font color="#CCCCCC"> the</font><font color="#E5E5E5"> basically you're</font>

646
00:26:55,000 --> 00:27:00,070
setting up a bot you need to make<font color="#CCCCCC"> sure</font>

647
00:26:58,150 --> 00:27:02,230
you set plenty of time aside for<font color="#CCCCCC"> this</font>

648
00:27:00,070 --> 00:27:03,669
<font color="#E5E5E5">you need to make sure that</font><font color="#CCCCCC"> you're</font>

649
00:27:02,230 --> 00:27:05,410
prepared<font color="#CCCCCC"> with at least a contact at</font>

650
00:27:03,670 --> 00:27:07,420
<font color="#CCCCCC">slack you know</font><font color="#E5E5E5"> have their</font><font color="#CCCCCC"> email their</font>

651
00:27:05,410 --> 00:27:08,500
support email pulled up<font color="#E5E5E5"> ready to go</font>

652
00:27:07,420 --> 00:27:11,860
<font color="#E5E5E5">because there's a really</font><font color="#CCCCCC"> good chance</font>

653
00:27:08,500 --> 00:27:13,630
you're<font color="#E5E5E5"> gonna need to email them</font><font color="#CCCCCC"> and just</font>

654
00:27:11,860 --> 00:27:14,649
be<font color="#E5E5E5"> aware of the headache don't get don't</font>

655
00:27:13,630 --> 00:27:16,809
get<font color="#E5E5E5"> stressed about it</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> get upset</font>

656
00:27:14,650 --> 00:27:18,549
<font color="#E5E5E5">about it</font><font color="#CCCCCC"> it the</font><font color="#E5E5E5"> first time you do it</font><font color="#CCCCCC"> and</font>

657
00:27:16,809 --> 00:27:21,399
<font color="#E5E5E5">every other time sometimes you just run</font>

658
00:27:18,549 --> 00:27:23,889
into<font color="#E5E5E5"> those brick walls and probably the</font>

659
00:27:21,400 --> 00:27:26,440
biggest problem for<font color="#E5E5E5"> us</font><font color="#CCCCCC"> was copy and</font>

660
00:27:23,890 --> 00:27:28,809
paste for whatever reason and I've used

661
00:27:26,440 --> 00:27:31,390
PowerShell I've used Python<font color="#CCCCCC"> I've typed</font>

662
00:27:28,809 --> 00:27:33,850
out<font color="#CCCCCC"> the string user underscore</font><font color="#E5E5E5"> logout</font>

663
00:27:31,390 --> 00:27:36,040
and<font color="#E5E5E5"> I will compare</font><font color="#CCCCCC"> it with</font><font color="#E5E5E5"> a copy and</font>

664
00:27:33,850 --> 00:27:38,439
<font color="#E5E5E5">paste directly off this website</font><font color="#CCCCCC"> link</font>

665
00:27:36,040 --> 00:27:41,200
right here<font color="#E5E5E5"> and they will be perfectly</font>

666
00:27:38,440 --> 00:27:43,720
identical<font color="#CCCCCC"> and</font><font color="#E5E5E5"> we'll pass</font><font color="#CCCCCC"> it the API</font>

667
00:27:41,200 --> 00:27:46,510
string<font color="#E5E5E5"> and it returns nothing there's an</font>

668
00:27:43,720 --> 00:27:48,340
error<font color="#CCCCCC"> I'm like what and we can copy the</font>

669
00:27:46,510 --> 00:27:49,750
string<font color="#E5E5E5"> out we can paste it in notepad we</font>

670
00:27:48,340 --> 00:27:52,389
can paste<font color="#E5E5E5"> it back in and it works just</font>

671
00:27:49,750 --> 00:27:54,880
<font color="#E5E5E5">fine</font><font color="#CCCCCC"> we have no idea why</font><font color="#E5E5E5"> so when you run</font>

672
00:27:52,390 --> 00:27:57,490
<font color="#E5E5E5">into</font><font color="#CCCCCC"> problems try copy out</font><font color="#E5E5E5"> paste back in</font>

673
00:27:54,880 --> 00:27:59,880
see if it fixes it<font color="#CCCCCC"> it's weirdness but</font>

674
00:27:57,490 --> 00:28:02,710
we've seen it<font color="#E5E5E5"> with multiple people</font><font color="#CCCCCC"> in</font>

675
00:27:59,880 --> 00:28:09,130
<font color="#E5E5E5">Python in</font><font color="#CCCCCC"> PowerShell and</font><font color="#E5E5E5"> directly in</font>

676
00:28:02,710 --> 00:28:10,750
their web web api's so calling the API

677
00:28:09,130 --> 00:28:13,419
<font color="#E5E5E5">in</font><font color="#CCCCCC"> Python we'll start with that</font><font color="#E5E5E5"> one</font>

678
00:28:10,750 --> 00:28:14,710
that's<font color="#E5E5E5"> kind of where we started</font><font color="#CCCCCC"> you're</font>

679
00:28:13,419 --> 00:28:16,150
gonna have to have your proxies if

680
00:28:14,710 --> 00:28:19,360
you're behind<font color="#E5E5E5"> a proxy</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> remember to</font>

681
00:28:16,150 --> 00:28:21,790
include<font color="#E5E5E5"> those your audit log API is not</font>

682
00:28:19,360 --> 00:28:23,500
being called by your<font color="#CCCCCC"> organization dot</font>

683
00:28:21,790 --> 00:28:27,340
slack it's actually<font color="#CCCCCC"> calling directly</font><font color="#E5E5E5"> to</font>

684
00:28:23,500 --> 00:28:29,919
<font color="#E5E5E5">API slack comm forward slash audit /v 1</font>

685
00:28:27,340 --> 00:28:32,770
/e logs<font color="#E5E5E5"> that's important to note</font><font color="#CCCCCC"> because</font>

686
00:28:29,919 --> 00:28:34,780
<font color="#E5E5E5">when you pass the token that's how it</font>

687
00:28:32,770 --> 00:28:36,460
knows exactly<font color="#E5E5E5"> what organization it is</font>

688
00:28:34,780 --> 00:28:40,720
<font color="#E5E5E5">not looking for</font><font color="#CCCCCC"> you to</font><font color="#E5E5E5"> pass the</font>

689
00:28:36,460 --> 00:28:43,809
<font color="#E5E5E5">organization we have different actions</font>

690
00:28:40,720 --> 00:28:48,220
<font color="#CCCCCC">user login user logout file upload file</font>

691
00:28:43,809 --> 00:28:51,220
download exports you'll be passing those

692
00:28:48,220 --> 00:28:51,910
each user the limit if you look is<font color="#E5E5E5"> nine</font>

693
00:28:51,220 --> 00:28:53,440
<font color="#E5E5E5">nine nine nine</font>

694
00:28:51,910 --> 00:28:56,320
that's the<font color="#CCCCCC"> stand</font>

695
00:28:53,440 --> 00:28:57,790
default<font color="#CCCCCC"> I believe for their limit but</font>

696
00:28:56,320 --> 00:29:00,610
<font color="#E5E5E5">you can actually call less depending on</font>

697
00:28:57,790 --> 00:29:03,580
how much you're<font color="#E5E5E5"> populating that's per</font>

698
00:29:00,610 --> 00:29:05,439
page the cursor they use pagination<font color="#E5E5E5"> so</font>

699
00:29:03,580 --> 00:29:06,909
at the<font color="#E5E5E5"> bottom of the call you're</font><font color="#CCCCCC"> gonna</font>

700
00:29:05,440 --> 00:29:08,380
have a little pagination you just pass

701
00:29:06,910 --> 00:29:10,480
that back<font color="#E5E5E5"> and you can keep cycling</font>

702
00:29:08,380 --> 00:29:12,550
<font color="#E5E5E5">through every now and then you're gonna</font>

703
00:29:10,480 --> 00:29:15,460
run<font color="#CCCCCC"> into a weird issue where it's gonna</font>

704
00:29:12,550 --> 00:29:18,610
pass that pagination token like three or

705
00:29:15,460 --> 00:29:19,900
<font color="#CCCCCC">four</font><font color="#E5E5E5"> times so</font><font color="#CCCCCC"> sometimes you</font><font color="#E5E5E5"> have to go</font>

706
00:29:18,610 --> 00:29:22,030
<font color="#E5E5E5">through and you</font><font color="#CCCCCC"> have to watch what your</font>

707
00:29:19,900 --> 00:29:23,140
<font color="#E5E5E5">codes doing what what it's returning and</font>

708
00:29:22,030 --> 00:29:28,170
make sure you're not<font color="#E5E5E5"> getting</font><font color="#CCCCCC"> any</font>

709
00:29:23,140 --> 00:29:31,000
duplicates in your data so the wonderful

710
00:29:28,170 --> 00:29:32,440
<font color="#E5E5E5">values are parameters we can't pass the</font>

711
00:29:31,000 --> 00:29:36,940
bearer token and<font color="#E5E5E5"> right there if you try</font>

712
00:29:32,440 --> 00:29:38,740
and<font color="#E5E5E5"> pass it authorization</font><font color="#CCCCCC"> colon</font><font color="#E5E5E5"> bearer</font>

713
00:29:36,940 --> 00:29:40,240
space and the token value<font color="#E5E5E5"> it's not gonna</font>

714
00:29:38,740 --> 00:29:42,520
work<font color="#CCCCCC"> it's going</font><font color="#E5E5E5"> to throw</font><font color="#CCCCCC"> an error it</font>

715
00:29:40,240 --> 00:29:45,370
<font color="#E5E5E5">will say not authorized it will say user</font>

716
00:29:42,520 --> 00:29:47,470
does not have permissions you have to

717
00:29:45,370 --> 00:29:52,780
pass it as a separate pass it as the

718
00:29:47,470 --> 00:29:53,770
headers equal works just fine so we went

719
00:29:52,780 --> 00:29:55,780
through<font color="#E5E5E5"> and also did this with</font>

720
00:29:53,770 --> 00:29:56,710
<font color="#E5E5E5">PowerShell</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> if we do it one</font>

721
00:29:55,780 --> 00:29:58,720
let's do<font color="#E5E5E5"> it</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the other that way you</font>

722
00:29:56,710 --> 00:30:02,110
<font color="#CCCCCC">kind of have a</font><font color="#E5E5E5"> good</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> so again</font>

723
00:29:58,720 --> 00:30:04,750
very<font color="#CCCCCC"> similar</font><font color="#E5E5E5"> we've got the proxy up</font>

724
00:30:02,110 --> 00:30:06,429
there we've<font color="#CCCCCC"> got the API token</font><font color="#E5E5E5"> but inside</font>

725
00:30:04,750 --> 00:30:08,800
we actually<font color="#CCCCCC"> built the headers and this</font>

726
00:30:06,430 --> 00:30:12,010
is very<font color="#E5E5E5"> similar</font><font color="#CCCCCC"> I tried</font><font color="#E5E5E5"> creating this in</font>

727
00:30:08,800 --> 00:30:15,610
one line<font color="#E5E5E5"> it didn't work we had to</font><font color="#CCCCCC"> do the</font>

728
00:30:12,010 --> 00:30:17,260
dot add separate it just would<font color="#CCCCCC"> not take</font>

729
00:30:15,610 --> 00:30:19,540
it<font color="#E5E5E5"> otherwise again we ran into the same</font>

730
00:30:17,260 --> 00:30:21,430
authorization errors<font color="#E5E5E5"> so if you look even</font>

731
00:30:19,540 --> 00:30:23,139
<font color="#CCCCCC">in</font><font color="#E5E5E5"> PowerShell we get a status code 200</font>

732
00:30:21,430 --> 00:30:24,400
it comes back and<font color="#E5E5E5"> your content is</font>

733
00:30:23,140 --> 00:30:27,970
actually<font color="#E5E5E5"> where</font><font color="#CCCCCC"> all of your</font><font color="#E5E5E5"> entries are</font>

734
00:30:24,400 --> 00:30:29,890
gonna lie<font color="#E5E5E5"> and this is kind of what it</font>

735
00:30:27,970 --> 00:30:33,130
<font color="#CCCCCC">looks like in your</font><font color="#E5E5E5"> text document you've</font>

736
00:30:29,890 --> 00:30:35,680
got your same layout<font color="#CCCCCC"> your your action</font>

737
00:30:33,130 --> 00:30:42,340
<font color="#E5E5E5">your entity your context down at the</font>

738
00:30:35,680 --> 00:30:43,540
bottom<font color="#CCCCCC"> of your UA</font><font color="#E5E5E5"> IP address so once we</font>

739
00:30:42,340 --> 00:30:44,830
have the<font color="#E5E5E5"> data and</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> were calling it we</font>

740
00:30:43,540 --> 00:30:45,220
had to<font color="#E5E5E5"> know what we were gonna do with</font>

741
00:30:44,830 --> 00:30:47,679
<font color="#CCCCCC">it</font>

742
00:30:45,220 --> 00:30:49,510
slack uses structured<font color="#E5E5E5"> data which is</font>

743
00:30:47,680 --> 00:30:51,550
great<font color="#E5E5E5"> for them but whenever you're</font>

744
00:30:49,510 --> 00:30:53,500
calling events if they go through and

745
00:30:51,550 --> 00:30:55,570
add an<font color="#E5E5E5"> extra column we don't have that</font>

746
00:30:53,500 --> 00:30:57,790
luxury<font color="#CCCCCC"> so when we were</font><font color="#E5E5E5"> going through our</font>

747
00:30:55,570 --> 00:31:00,220
data we decided we're<font color="#E5E5E5"> gonna use</font><font color="#CCCCCC"> kibana</font>

748
00:30:57,790 --> 00:31:02,129
and<font color="#CCCCCC"> python why not</font><font color="#E5E5E5"> a lot of people are</font>

749
00:31:00,220 --> 00:31:04,570
using it we're gonna try<font color="#E5E5E5"> something new</font>

750
00:31:02,130 --> 00:31:06,190
<font color="#E5E5E5">so we were like hey what are</font><font color="#CCCCCC"> we gonna do</font>

751
00:31:04,570 --> 00:31:07,240
with our results<font color="#CCCCCC"> well we're gonna</font><font color="#E5E5E5"> pipe</font>

752
00:31:06,190 --> 00:31:08,500
<font color="#E5E5E5">it into elasticsearch</font>

753
00:31:07,240 --> 00:31:10,950
call it<font color="#CCCCCC"> into</font><font color="#E5E5E5"> cabana and then we're gonna</font>

754
00:31:08,500 --> 00:31:13,290
build<font color="#E5E5E5"> a custom alerting module</font>

755
00:31:10,950 --> 00:31:15,460
elasticsearch<font color="#E5E5E5"> and</font><font color="#CCCCCC"> kobato were used</font>

756
00:31:13,290 --> 00:31:17,379
elasticsearch just because when they

757
00:31:15,460 --> 00:31:19,179
change data<font color="#E5E5E5"> we can keep piping into the</font>

758
00:31:17,380 --> 00:31:20,650
same indexes it's gonna<font color="#E5E5E5"> modify itself</font>

759
00:31:19,179 --> 00:31:22,900
it's still<font color="#CCCCCC"> gonna be in one index we</font>

760
00:31:20,650 --> 00:31:24,880
don't have to worry about<font color="#E5E5E5"> it</font><font color="#CCCCCC"> kibana</font><font color="#E5E5E5"> was</font>

761
00:31:22,900 --> 00:31:27,040
<font color="#E5E5E5">because we could very quickly see</font><font color="#CCCCCC"> the</font>

762
00:31:24,880 --> 00:31:30,220
visualizations<font color="#E5E5E5"> so we could very</font><font color="#CCCCCC"> quickly</font>

763
00:31:27,040 --> 00:31:33,909
analyze<font color="#E5E5E5"> our data here's kind of a basic</font>

764
00:31:30,220 --> 00:31:35,380
<font color="#CCCCCC">example if you look well</font><font color="#E5E5E5"> pretty</font><font color="#CCCCCC"> much</font>

765
00:31:33,910 --> 00:31:37,270
<font color="#E5E5E5">exactly what I just</font><font color="#CCCCCC"> said</font><font color="#E5E5E5"> but the quick</font>

766
00:31:35,380 --> 00:31:39,070
pattern review that was really easy<font color="#E5E5E5"> for</font>

767
00:31:37,270 --> 00:31:40,929
<font color="#CCCCCC">us</font><font color="#E5E5E5"> even if you look there we can see hey</font>

768
00:31:39,070 --> 00:31:43,750
that's kind of a weekend and look we had

769
00:31:40,929 --> 00:31:45,700
a<font color="#E5E5E5"> holiday weekend</font><font color="#CCCCCC"> but we can take that</font>

770
00:31:43,750 --> 00:31:47,559
quick flip into<font color="#E5E5E5"> a visualization based</font>

771
00:31:45,700 --> 00:31:50,740
<font color="#E5E5E5">off of count and very quickly see</font><font color="#CCCCCC"> that</font>

772
00:31:47,559 --> 00:31:52,720
one user was really hammering<font color="#E5E5E5"> that file</font>

773
00:31:50,740 --> 00:31:56,110
downloads<font color="#E5E5E5"> they downloaded a</font><font color="#CCCCCC"> lot</font><font color="#E5E5E5"> of files</font>

774
00:31:52,720 --> 00:31:58,929
in<font color="#CCCCCC"> that amount</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> time so we were like</font>

775
00:31:56,110 --> 00:32:00,010
<font color="#E5E5E5">hey how do we Kiev this what's unique we</font>

776
00:31:58,929 --> 00:32:02,250
had to go<font color="#E5E5E5"> back to our down and say</font>

777
00:32:00,010 --> 00:32:05,530
what's unique is the<font color="#CCCCCC"> user name unique is</font>

778
00:32:02,250 --> 00:32:08,800
the user ID unique<font color="#E5E5E5"> slack actually has a</font>

779
00:32:05,530 --> 00:32:10,149
user ID field<font color="#CCCCCC"> that's the unique key it</font>

780
00:32:08,800 --> 00:32:11,440
doesn't matter how many<font color="#CCCCCC"> emails they</font>

781
00:32:10,150 --> 00:32:12,580
change doesn't<font color="#E5E5E5"> matter how many user</font>

782
00:32:11,440 --> 00:32:14,590
names they change<font color="#E5E5E5"> that's not</font><font color="#CCCCCC"> gonna</font>

783
00:32:12,580 --> 00:32:19,090
<font color="#CCCCCC">change so we said hey</font><font color="#E5E5E5"> that's one of our</font>

784
00:32:14,590 --> 00:32:20,889
keys<font color="#E5E5E5"> so we looked and this is in a 30</font>

785
00:32:19,090 --> 00:32:24,370
minute window<font color="#E5E5E5"> we had this user up here</font>

786
00:32:20,890 --> 00:32:25,960
downloaded 741 files<font color="#E5E5E5"> in 30 minutes most</font>

787
00:32:24,370 --> 00:32:29,800
people can't do<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I can't click</font><font color="#E5E5E5"> that</font>

788
00:32:25,960 --> 00:32:31,570
fast<font color="#E5E5E5"> so we started looking hey who is</font>

789
00:32:29,800 --> 00:32:33,879
this user we can<font color="#CCCCCC"> see that</font><font color="#E5E5E5"> the user was</font>

790
00:32:31,570 --> 00:32:35,740
none other than<font color="#CCCCCC"> Kerry Roberts</font><font color="#E5E5E5"> and she</font>

791
00:32:33,880 --> 00:32:37,870
<font color="#CCCCCC">even tried changing her name</font><font color="#E5E5E5"> she even</font>

792
00:32:35,740 --> 00:32:40,390
<font color="#E5E5E5">tried to</font><font color="#CCCCCC"> make it really sneaky make it</font>

793
00:32:37,870 --> 00:32:41,800
<font color="#E5E5E5">compliance exports which some</font><font color="#CCCCCC"> users</font>

794
00:32:40,390 --> 00:32:44,140
would<font color="#E5E5E5"> be like hey that</font><font color="#CCCCCC"> you know that</font>

795
00:32:41,800 --> 00:32:46,690
<font color="#E5E5E5">could be</font><font color="#CCCCCC"> normal you know</font><font color="#E5E5E5"> user the</font>

796
00:32:44,140 --> 00:32:48,280
<font color="#E5E5E5">compliance exports downloading files so</font>

797
00:32:46,690 --> 00:32:51,570
<font color="#E5E5E5">we wanted</font><font color="#CCCCCC"> to rotate</font><font color="#E5E5E5"> through that's kind</font>

798
00:32:48,280 --> 00:32:54,970
<font color="#E5E5E5">of identify your data know what's unique</font>

799
00:32:51,570 --> 00:32:56,559
once we had<font color="#CCCCCC"> that we built a very basic</font>

800
00:32:54,970 --> 00:32:58,690
alerting mechanism<font color="#E5E5E5"> this was nothing</font>

801
00:32:56,559 --> 00:33:00,639
<font color="#CCCCCC">fancy</font><font color="#E5E5E5"> we literally just took Python said</font>

802
00:32:58,690 --> 00:33:03,309
hey email me every<font color="#CCCCCC"> time</font><font color="#E5E5E5"> you aggregate</font>

803
00:33:00,640 --> 00:33:06,040
the same data so I went through<font color="#CCCCCC"> and I</font>

804
00:33:03,309 --> 00:33:07,899
went go aggregate the last X<font color="#E5E5E5"> number of</font>

805
00:33:06,040 --> 00:33:10,990
minutes<font color="#CCCCCC"> and</font><font color="#E5E5E5"> I want to see this many file</font>

806
00:33:07,900 --> 00:33:12,580
downloads within<font color="#E5E5E5"> that time also</font><font color="#CCCCCC"> I want</font>

807
00:33:10,990 --> 00:33:14,830
to exclude<font color="#E5E5E5"> all of the stuff</font><font color="#CCCCCC"> that I know</font>

808
00:33:12,580 --> 00:33:15,879
for a fact<font color="#E5E5E5"> is a false positive</font><font color="#CCCCCC"> as you go</font>

809
00:33:14,830 --> 00:33:16,870
through your<font color="#E5E5E5"> data it's gonna be</font>

810
00:33:15,880 --> 00:33:17,950
<font color="#CCCCCC">different</font><font color="#E5E5E5"> for everybody</font>

811
00:33:16,870 --> 00:33:20,830
<font color="#E5E5E5">but as you go through</font><font color="#CCCCCC"> you're gonna see</font>

812
00:33:17,950 --> 00:33:22,600
stuff that<font color="#E5E5E5"> is plainly just</font><font color="#CCCCCC"> gonna be</font>

813
00:33:20,830 --> 00:33:24,039
false-positive it's something that's

814
00:33:22,600 --> 00:33:25,539
<font color="#E5E5E5">automated it's something that system</font>

815
00:33:24,039 --> 00:33:26,860
it's something<font color="#E5E5E5"> from slack</font><font color="#CCCCCC"> you're gonna</font>

816
00:33:25,539 --> 00:33:28,480
see<font color="#E5E5E5"> it you're gonna be like nope need to</font>

817
00:33:26,860 --> 00:33:29,769
exclude that<font color="#E5E5E5"> so that's what we did</font><font color="#CCCCCC"> we</font>

818
00:33:28,480 --> 00:33:31,750
just<font color="#CCCCCC"> passed</font><font color="#E5E5E5"> it straight into an email</font>

819
00:33:29,769 --> 00:33:34,149
module and I just got a<font color="#E5E5E5"> really basic</font>

820
00:33:31,750 --> 00:33:37,000
<font color="#E5E5E5">email give me the user ID and how many</font>

821
00:33:34,149 --> 00:33:38,590
files they downloaded from there I<font color="#E5E5E5"> could</font>

822
00:33:37,000 --> 00:33:40,630
very quickly<font color="#E5E5E5"> just</font><font color="#CCCCCC"> open up my Cabana</font>

823
00:33:38,590 --> 00:33:42,480
interface drop in the user ID and say

824
00:33:40,630 --> 00:33:44,559
hey show me<font color="#CCCCCC"> everything this user did</font>

825
00:33:42,480 --> 00:33:45,909
then we<font color="#E5E5E5"> loop back through and sure</font>

826
00:33:44,559 --> 00:33:49,510
enough<font color="#E5E5E5"> it was</font><font color="#CCCCCC"> Kerry Roberts throwing all</font>

827
00:33:45,909 --> 00:33:51,010
those<font color="#E5E5E5"> alerts so automation is your</font>

828
00:33:49,510 --> 00:33:52,840
friend<font color="#CCCCCC"> I really like to automate</font>

829
00:33:51,010 --> 00:33:56,260
<font color="#E5E5E5">everything I can because</font><font color="#CCCCCC"> I don't like</font>

830
00:33:52,840 --> 00:33:57,970
<font color="#E5E5E5">going in back and doing work over it's</font>

831
00:33:56,260 --> 00:34:01,330
important<font color="#E5E5E5"> not to</font><font color="#CCCCCC"> hard-code your tokens</font>

832
00:33:57,970 --> 00:34:03,010
<font color="#E5E5E5">when you set</font><font color="#CCCCCC"> up these api's for audit</font>

833
00:34:01,330 --> 00:34:05,080
log you set up and one<font color="#E5E5E5"> of the agreements</font>

834
00:34:03,010 --> 00:34:07,809
<font color="#CCCCCC">in it is you will not hard code your</font>

835
00:34:05,080 --> 00:34:10,569
token don't<font color="#CCCCCC"> hard-code it in your script</font>

836
00:34:07,809 --> 00:34:12,609
<font color="#CCCCCC">if god forbid somebody posts your script</font>

837
00:34:10,570 --> 00:34:14,790
<font color="#E5E5E5">into your slack or anywhere</font><font color="#CCCCCC"> else there's</font>

838
00:34:12,609 --> 00:34:16,899
<font color="#E5E5E5">gonna be your token just remember that</font>

839
00:34:14,790 --> 00:34:19,359
<font color="#CCCCCC">rotate</font><font color="#E5E5E5"> your tokens regularly</font>

840
00:34:16,899 --> 00:34:21,069
I mean basic<font color="#CCCCCC"> security you've got a</font>

841
00:34:19,359 --> 00:34:23,020
<font color="#E5E5E5">button yes it's a long drawn-out process</font>

842
00:34:21,070 --> 00:34:24,700
you can't automate the process<font color="#E5E5E5"> that's</font>

843
00:34:23,020 --> 00:34:26,889
<font color="#E5E5E5">the problem you cannot automate it you</font>

844
00:34:24,699 --> 00:34:31,239
actually<font color="#E5E5E5"> physically have to log in</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> to</font>

845
00:34:26,889 --> 00:34:33,220
a page<font color="#E5E5E5"> pull up pull</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> script or a part</font>

846
00:34:31,239 --> 00:34:35,229
of<font color="#CCCCCC"> a web URL out go</font><font color="#E5E5E5"> through a process</font>

847
00:34:33,219 --> 00:34:37,719
<font color="#CCCCCC">just</font><font color="#E5E5E5"> to get a returned value so you can</font>

848
00:34:35,230 --> 00:34:39,790
pass it back<font color="#E5E5E5"> and get the API token it's</font>

849
00:34:37,719 --> 00:34:41,129
kind of a hassle<font color="#CCCCCC"> once you get the token</font>

850
00:34:39,790 --> 00:34:43,029
<font color="#E5E5E5">set up the first time though it's pretty</font>

851
00:34:41,129 --> 00:34:46,359
<font color="#E5E5E5">pretty standard and it didn't seem to</font>

852
00:34:43,030 --> 00:34:49,030
<font color="#E5E5E5">fail so of course automate what you can</font>

853
00:34:46,359 --> 00:34:50,949
we<font color="#E5E5E5"> automated the download of all of the</font>

854
00:34:49,030 --> 00:34:52,690
API data so we'd pull it straight<font color="#E5E5E5"> into a</font>

855
00:34:50,949 --> 00:34:54,549
database<font color="#CCCCCC"> we'd push it into</font><font color="#E5E5E5"> the database</font>

856
00:34:52,690 --> 00:34:56,740
<font color="#E5E5E5">with automation</font><font color="#CCCCCC"> and then we automated</font>

857
00:34:54,550 --> 00:34:59,140
<font color="#E5E5E5">the alerts that allowed us more time to</font>

858
00:34:56,739 --> 00:35:00,430
<font color="#CCCCCC">do the</font><font color="#E5E5E5"> tuning we knew what we could see</font>

859
00:34:59,140 --> 00:35:01,810
is<font color="#E5E5E5"> the true positive what we could see</font>

860
00:35:00,430 --> 00:35:08,500
is a false positive<font color="#CCCCCC"> and how to tune it</font>

861
00:35:01,810 --> 00:35:10,660
quickly so there were some real hurdles

862
00:35:08,500 --> 00:35:13,450
and struggles<font color="#E5E5E5"> not all API calls are</font>

863
00:35:10,660 --> 00:35:17,740
logged the message downloads are not

864
00:35:13,450 --> 00:35:19,750
logged file downloads are logged<font color="#E5E5E5"> that's</font>

865
00:35:17,740 --> 00:35:21,640
something<font color="#E5E5E5"> to be aware of</font><font color="#CCCCCC"> so even when</font>

866
00:35:19,750 --> 00:35:23,230
we're looking<font color="#E5E5E5"> at the alerting we're</font>

867
00:35:21,640 --> 00:35:25,330
limited on what<font color="#CCCCCC"> we can see is a</font><font color="#E5E5E5"> blue</font>

868
00:35:23,230 --> 00:35:27,550
team that's why it's important to know

869
00:35:25,330 --> 00:35:29,529
what<font color="#E5E5E5"> the scripts do and how they</font><font color="#CCCCCC"> can be</font>

870
00:35:27,550 --> 00:35:31,780
used<font color="#E5E5E5"> even run them against your system</font>

871
00:35:29,530 --> 00:35:34,080
regularly<font color="#CCCCCC"> just so that you</font><font color="#E5E5E5"> can see what</font>

872
00:35:31,780 --> 00:35:36,010
sensitive information<font color="#E5E5E5"> is out there</font>

873
00:35:34,080 --> 00:35:37,990
optimize your<font color="#CCCCCC"> data storage from</font><font color="#E5E5E5"> the</font>

874
00:35:36,010 --> 00:35:39,850
<font color="#E5E5E5">start</font><font color="#CCCCCC"> we did not do</font><font color="#E5E5E5"> this the first time</font>

875
00:35:37,990 --> 00:35:41,950
around<font color="#CCCCCC"> an intern</font><font color="#E5E5E5"> completely blew up our</font>

876
00:35:39,850 --> 00:35:45,339
<font color="#CCCCCC">elasticsearch</font><font color="#E5E5E5"> a couple times it's kind</font>

877
00:35:41,950 --> 00:35:46,810
of<font color="#E5E5E5"> fun</font><font color="#CCCCCC"> you may</font><font color="#E5E5E5"> have to break your</font>

878
00:35:45,340 --> 00:35:48,820
indexes down by date<font color="#E5E5E5"> depending on how</font>

879
00:35:46,810 --> 00:35:50,950
much data you're running into<font color="#E5E5E5"> you may</font>

880
00:35:48,820 --> 00:35:52,870
have to run dual databases one that<font color="#E5E5E5"> runs</font>

881
00:35:50,950 --> 00:35:54,910
a shorter amount<font color="#CCCCCC"> of time say a week and</font>

882
00:35:52,870 --> 00:35:58,560
then<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> long term storage</font><font color="#E5E5E5"> in</font>

883
00:35:54,910 --> 00:35:58,560
another database<font color="#CCCCCC"> just keep that in</font><font color="#E5E5E5"> mind</font>

884
00:35:58,650 --> 00:36:03,670
<font color="#CCCCCC">trying use some sort of data loss</font>

885
00:36:00,670 --> 00:36:06,220
prevention<font color="#E5E5E5"> these tokens</font><font color="#CCCCCC"> some of them are</font>

886
00:36:03,670 --> 00:36:08,680
<font color="#E5E5E5">flat-out keys</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the castle</font><font color="#CCCCCC"> they can</font>

887
00:36:06,220 --> 00:36:10,660
read anything<font color="#E5E5E5"> your admins and your</font>

888
00:36:08,680 --> 00:36:13,660
owners have more read privilege than

889
00:36:10,660 --> 00:36:15,850
anybody else<font color="#CCCCCC"> so if somebody gets a hold</font>

890
00:36:13,660 --> 00:36:17,170
<font color="#E5E5E5">of that token they can pipe it through</font>

891
00:36:15,850 --> 00:36:18,640
<font color="#E5E5E5">the script and they can start</font><font color="#CCCCCC"> pulling</font>

892
00:36:17,170 --> 00:36:21,480
all your<font color="#E5E5E5"> information down just like the</font>

893
00:36:18,640 --> 00:36:21,480
<font color="#E5E5E5">or an admin or an owner</font>

894
00:36:21,630 --> 00:36:25,870
there are log discrepancies this was the

895
00:36:24,520 --> 00:36:29,290
hardest one<font color="#E5E5E5"> for</font><font color="#CCCCCC"> us to wrap</font><font color="#E5E5E5"> our head</font>

896
00:36:25,870 --> 00:36:32,350
around there are way more<font color="#E5E5E5"> logout events</font>

897
00:36:29,290 --> 00:36:35,110
than<font color="#CCCCCC"> login events and I'm not talking</font>

898
00:36:32,350 --> 00:36:38,500
like twice as many we're talking<font color="#E5E5E5"> 25</font>

899
00:36:35,110 --> 00:36:40,270
times as many logout events as<font color="#E5E5E5"> log in be</font>

900
00:36:38,500 --> 00:36:42,840
<font color="#E5E5E5">aware of</font><font color="#CCCCCC"> that because you may</font><font color="#E5E5E5"> be looking</font>

901
00:36:40,270 --> 00:36:44,770
at<font color="#E5E5E5"> a</font><font color="#CCCCCC"> number going</font><font color="#E5E5E5"> this is way off</font>

902
00:36:42,840 --> 00:36:46,690
<font color="#CCCCCC">something's wrong</font><font color="#E5E5E5"> with my script</font><font color="#CCCCCC"> and it</font>

903
00:36:44,770 --> 00:36:48,700
may not be<font color="#E5E5E5"> your script it may just be a</font>

904
00:36:46,690 --> 00:36:50,800
<font color="#CCCCCC">discrepancy that is something that we</font>

905
00:36:48,700 --> 00:36:53,290
passed<font color="#E5E5E5"> along we're like hey</font><font color="#CCCCCC"> we see this</font>

906
00:36:50,800 --> 00:36:55,110
discrepancy<font color="#CCCCCC"> and we did get</font><font color="#E5E5E5"> some feedback</font>

907
00:36:53,290 --> 00:36:58,990
<font color="#E5E5E5">on it</font>

908
00:36:55,110 --> 00:37:00,460
<font color="#CCCCCC">API</font><font color="#E5E5E5"> rate limits slack actually documents</font>

909
00:36:58,990 --> 00:37:03,819
<font color="#CCCCCC">are rate limits very well on their</font>

910
00:37:00,460 --> 00:37:07,330
website<font color="#E5E5E5"> for API tokens you have a rate</font>

911
00:37:03,820 --> 00:37:11,950
limit of 50 per minute we've however run

912
00:37:07,330 --> 00:37:14,319
into issues<font color="#CCCCCC"> with</font><font color="#E5E5E5"> this it's not sure if</font>

913
00:37:11,950 --> 00:37:15,759
it's a<font color="#E5E5E5"> calculated rate limit or just a</font>

914
00:37:14,320 --> 00:37:18,160
<font color="#CCCCCC">flat-out rate limit but</font><font color="#E5E5E5"> we have noticed</font>

915
00:37:15,760 --> 00:37:19,630
that we<font color="#E5E5E5"> have to put a larger timer in</font>

916
00:37:18,160 --> 00:37:20,950
the more<font color="#E5E5E5"> amount of data we're pulling so</font>

917
00:37:19,630 --> 00:37:22,720
of<font color="#E5E5E5"> course with the log out of</font><font color="#CCCCCC"> ents I</font>

918
00:37:20,950 --> 00:37:24,549
said they were much larger<font color="#CCCCCC"> we had to</font>

919
00:37:22,720 --> 00:37:27,189
have a much larger<font color="#E5E5E5"> delay between each of</font>

920
00:37:24,550 --> 00:37:30,040
<font color="#CCCCCC">our</font><font color="#E5E5E5"> API calls then we did say on</font><font color="#CCCCCC"> the</font>

921
00:37:27,190 --> 00:37:31,870
file downloads<font color="#CCCCCC"> that's again we're not</font>

922
00:37:30,040 --> 00:37:33,160
<font color="#E5E5E5">sure exactly why that happened</font><font color="#CCCCCC"> but we</font>

923
00:37:31,870 --> 00:37:34,750
did<font color="#E5E5E5"> notice</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> it's something you need</font>

924
00:37:33,160 --> 00:37:36,220
to be<font color="#E5E5E5"> aware of because if your script</font>

925
00:37:34,750 --> 00:37:38,770
starts failing<font color="#E5E5E5"> and you may be</font><font color="#CCCCCC"> going hey</font>

926
00:37:36,220 --> 00:37:40,839
my<font color="#E5E5E5"> codes wrong try adjusting</font><font color="#CCCCCC"> that timer</font>

927
00:37:38,770 --> 00:37:42,400
because<font color="#E5E5E5"> you may just be hitting a rate</font>

928
00:37:40,840 --> 00:37:46,050
limit watch for<font color="#E5E5E5"> your I believe it's your</font>

929
00:37:42,400 --> 00:37:46,050
429 so<font color="#CCCCCC"> what they pass back</font>

930
00:37:47,220 --> 00:37:53,709
so are<font color="#E5E5E5"> there any questions</font><font color="#CCCCCC"> the question</font>

931
00:37:51,700 --> 00:37:55,089
was what's<font color="#E5E5E5"> the worst thing</font><font color="#CCCCCC"> that has been</font>

932
00:37:53,710 --> 00:37:59,410
<font color="#E5E5E5">found you know through running the</font>

933
00:37:55,089 --> 00:38:03,009
script<font color="#CCCCCC"> you know data</font><font color="#E5E5E5"> in slack</font><font color="#CCCCCC"> and we we</font>

934
00:37:59,410 --> 00:38:05,740
found the corporate Wi-Fi password<font color="#E5E5E5"> which</font>

935
00:38:03,010 --> 00:38:07,390
was wpa2 so they should have been using

936
00:38:05,740 --> 00:38:10,390
<font color="#E5E5E5">that in the first place but the</font>

937
00:38:07,390 --> 00:38:13,598
corporate Wi-Fi password the shared like

938
00:38:10,390 --> 00:38:16,569
here's where<font color="#E5E5E5"> we put all</font><font color="#CCCCCC"> all of</font><font color="#E5E5E5"> our</font>

939
00:38:13,599 --> 00:38:18,190
important stuff<font color="#E5E5E5"> on this shared</font><font color="#CCCCCC"> drive</font>

940
00:38:16,569 --> 00:38:24,089
here's the password<font color="#E5E5E5"> that they</font><font color="#CCCCCC"> were</font>

941
00:38:18,190 --> 00:38:24,089
sharing<font color="#CCCCCC"> user passwords</font><font color="#E5E5E5"> s3 access keys</font>

942
00:38:24,720 --> 00:38:29,950
<font color="#E5E5E5">code people put a lot of code on there</font>

943
00:38:27,760 --> 00:38:32,619
and the code<font color="#E5E5E5"> often has credentials</font>

944
00:38:29,950 --> 00:38:35,710
<font color="#E5E5E5">mostly what I look for is credentials</font>

945
00:38:32,619 --> 00:38:37,990
and the other interesting<font color="#CCCCCC"> stuff that</font><font color="#E5E5E5"> I</font>

946
00:38:35,710 --> 00:38:40,780
look for that's<font color="#E5E5E5"> not credentials is just</font>

947
00:38:37,990 --> 00:38:42,578
it's a<font color="#E5E5E5"> great way to get a list of</font><font color="#CCCCCC"> URLs</font>

948
00:38:40,780 --> 00:38:45,310
that<font color="#E5E5E5"> they use in the company internal</font>

949
00:38:42,579 --> 00:38:47,319
and external like<font color="#E5E5E5"> oh look they use this</font>

950
00:38:45,310 --> 00:38:48,970
<font color="#E5E5E5">third-party</font><font color="#CCCCCC"> app and this third-party app</font>

951
00:38:47,319 --> 00:38:50,290
they probably have<font color="#E5E5E5"> logins over there and</font>

952
00:38:48,970 --> 00:38:51,819
I could try to<font color="#E5E5E5"> get into</font><font color="#CCCCCC"> that and they</font>

953
00:38:50,290 --> 00:38:56,500
<font color="#CCCCCC">use this for</font><font color="#E5E5E5"> shipping and they use this</font>

954
00:38:51,819 --> 00:38:58,390
for<font color="#CCCCCC"> SA</font><font color="#E5E5E5"> P and so it's great recon that</font>

955
00:38:56,500 --> 00:39:01,060
way and also there'll be a lot of

956
00:38:58,390 --> 00:39:03,190
internal your<font color="#E5E5E5"> URLs posted like here's</font>

957
00:39:01,060 --> 00:39:04,960
our admin portal which<font color="#CCCCCC"> is only</font>

958
00:39:03,190 --> 00:39:08,349
<font color="#E5E5E5">accessible on the internal network so</font>

959
00:39:04,960 --> 00:39:10,960
suddenly<font color="#E5E5E5"> you have a great list of if you</font>

960
00:39:08,349 --> 00:39:18,280
do get<font color="#CCCCCC"> on their network</font><font color="#E5E5E5"> places</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> go of</font>

961
00:39:10,960 --> 00:39:20,109
interest yeah so his question<font color="#CCCCCC"> was so if</font>

962
00:39:18,280 --> 00:39:22,180
I<font color="#E5E5E5"> get ahold of somebody's cookie somehow</font>

963
00:39:20,109 --> 00:39:23,259
<font color="#E5E5E5">I can download can i</font><font color="#CCCCCC"> download it</font>

964
00:39:22,180 --> 00:39:25,149
everything they have access<font color="#E5E5E5"> to</font>

965
00:39:23,260 --> 00:39:27,400
<font color="#E5E5E5">regardless of the fact that I'm not on</font>

966
00:39:25,150 --> 00:39:32,670
their machine coming from their IP on

967
00:39:27,400 --> 00:39:32,670
their network and<font color="#E5E5E5"> the answer is yes</font><font color="#CCCCCC"> so</font>

968
00:39:34,710 --> 00:39:39,970
<font color="#CCCCCC">the</font><font color="#E5E5E5"> question is the sanitization if you</font>

969
00:39:37,450 --> 00:39:41,439
find a w<font color="#E5E5E5"> AP</font><font color="#CCCCCC"> - password or any other</font>

970
00:39:39,970 --> 00:39:43,868
credential inside of slack

971
00:39:41,440 --> 00:39:45,880
does<font color="#CCCCCC"> this annotation</font><font color="#E5E5E5"> actually take it</font>

972
00:39:43,869 --> 00:39:47,770
out<font color="#CCCCCC"> of just that</font><font color="#E5E5E5"> channel or multiples it</font>

973
00:39:45,880 --> 00:39:49,150
depends you<font color="#E5E5E5"> actually have to go through</font>

974
00:39:47,770 --> 00:39:50,530
<font color="#CCCCCC">and start</font><font color="#E5E5E5"> looking</font><font color="#CCCCCC"> for it and</font><font color="#E5E5E5"> then</font>

975
00:39:49,150 --> 00:39:51,670
finding where it's at<font color="#CCCCCC"> and your admins</font>

976
00:39:50,530 --> 00:39:53,170
and owners are<font color="#CCCCCC"> gonna have to go through</font>

977
00:39:51,670 --> 00:39:55,930
and manually delete it most of<font color="#E5E5E5"> the time</font>

978
00:39:53,170 --> 00:39:57,770
there are api's to go through and<font color="#E5E5E5"> delete</font>

979
00:39:55,930 --> 00:39:59,390
them but<font color="#E5E5E5"> again you're</font><font color="#CCCCCC"> gonna have to know</font>

980
00:39:57,770 --> 00:40:01,520
exactly what channel it is<font color="#E5E5E5"> if it's a</font>

981
00:39:59,390 --> 00:40:04,100
private<font color="#E5E5E5"> message depending</font><font color="#CCCCCC"> on the level</font>

982
00:40:01,520 --> 00:40:05,270
of slack you have your owners admins may

983
00:40:04,100 --> 00:40:09,130
not have<font color="#CCCCCC"> access into that</font><font color="#E5E5E5"> private</font>

984
00:40:05,270 --> 00:40:09,130
<font color="#CCCCCC">message</font><font color="#E5E5E5"> that's important to know also</font>

985
00:40:09,280 --> 00:40:14,660
<font color="#E5E5E5">sanitization can be a real task</font><font color="#CCCCCC"> I'll be</font>

986
00:40:11,690 --> 00:40:16,940
<font color="#CCCCCC">totally honest</font><font color="#E5E5E5"> it can be very cumbersome</font>

987
00:40:14,660 --> 00:40:19,190
<font color="#E5E5E5">to go through and a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the time it's</font>

988
00:40:16,940 --> 00:40:21,920
a lot easier<font color="#E5E5E5"> to go through and force a</font>

989
00:40:19,190 --> 00:40:26,900
password<font color="#CCCCCC"> change</font><font color="#E5E5E5"> then try and sanitize</font>

990
00:40:21,920 --> 00:40:28,010
just<font color="#E5E5E5"> straight out</font><font color="#CCCCCC"> okay I believe the</font>

991
00:40:26,900 --> 00:40:30,410
question<font color="#E5E5E5"> was can we do anything</font>

992
00:40:28,010 --> 00:40:32,740
proactive<font color="#E5E5E5"> to prevent this with slack</font>

993
00:40:30,410 --> 00:40:32,740
correct

994
00:40:34,330 --> 00:40:40,520
well you can put policies in<font color="#CCCCCC"> place</font><font color="#E5E5E5"> but</font>

995
00:40:38,630 --> 00:40:43,250
people<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> always follow policies</font>

996
00:40:40,520 --> 00:40:44,900
<font color="#E5E5E5">that's just how it is</font>

997
00:40:43,250 --> 00:40:47,150
unfortunately because<font color="#E5E5E5"> you're looking</font><font color="#CCCCCC"> at</font>

998
00:40:44,900 --> 00:40:49,190
<font color="#CCCCCC">a cloud provider you're limited there</font>

999
00:40:47,150 --> 00:40:50,960
you can attempt to<font color="#E5E5E5"> put some DLP in place</font>

1000
00:40:49,190 --> 00:40:53,450
to say hey if<font color="#CCCCCC"> this stuff's</font><font color="#E5E5E5"> going out try</font>

1001
00:40:50,960 --> 00:40:54,910
and<font color="#E5E5E5"> block it not all DLP solutions are</font>

1002
00:40:53,450 --> 00:40:58,669
gonna be able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> provide that</font>

1003
00:40:54,910 --> 00:41:00,529
so you just it's hard

1004
00:40:58,670 --> 00:41:02,360
you really have<font color="#CCCCCC"> to monitor</font><font color="#E5E5E5"> what's inside</font>

1005
00:41:00,530 --> 00:41:04,670
your slack environment<font color="#E5E5E5"> and do good</font>

1006
00:41:02,360 --> 00:41:06,800
sanitation<font color="#E5E5E5"> by of course either using</font>

1007
00:41:04,670 --> 00:41:08,450
scripts or going through<font color="#CCCCCC"> and using</font><font color="#E5E5E5"> logs</font>

1008
00:41:06,800 --> 00:41:13,640
to start looking<font color="#CCCCCC"> through your</font><font color="#E5E5E5"> data to</font>

1009
00:41:08,450 --> 00:41:15,799
see what's out<font color="#CCCCCC"> there that so the</font>

1010
00:41:13,640 --> 00:41:18,140
<font color="#E5E5E5">question was what about a slack bot that</font>

1011
00:41:15,800 --> 00:41:21,200
to<font color="#E5E5E5"> monitor for text and then if you see</font>

1012
00:41:18,140 --> 00:41:23,029
something like<font color="#E5E5E5"> password alert that would</font>

1013
00:41:21,200 --> 00:41:24,919
probably<font color="#E5E5E5"> be a good method the thing you</font>

1014
00:41:23,030 --> 00:41:26,750
need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> remember is if that token for</font>

1015
00:41:24,920 --> 00:41:29,450
that bot ever<font color="#E5E5E5"> gets used</font><font color="#CCCCCC"> or found out</font>

1016
00:41:26,750 --> 00:41:31,340
they can then start exploding<font color="#E5E5E5"> that bot</font>

1017
00:41:29,450 --> 00:41:33,259
to start<font color="#E5E5E5"> getting that data</font><font color="#CCCCCC"> also and</font>

1018
00:41:31,340 --> 00:41:34,910
that's<font color="#E5E5E5"> something</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be aware of</font><font color="#CCCCCC"> you're</font>

1019
00:41:33,260 --> 00:41:36,980
not just looking<font color="#E5E5E5"> at your user tokens</font>

1020
00:41:34,910 --> 00:41:40,339
<font color="#CCCCCC">you're looking at</font><font color="#E5E5E5"> your user tokens your</font>

1021
00:41:36,980 --> 00:41:43,580
bot tokens<font color="#E5E5E5"> your audit log API tokens all</font>

1022
00:41:40,340 --> 00:41:45,320
of your tokens are a prime target<font color="#E5E5E5"> some</font>

1023
00:41:43,580 --> 00:41:47,540
<font color="#CCCCCC">bots have more power they'll have things</font>

1024
00:41:45,320 --> 00:41:49,850
like incoming or outgoing web hooks so

1025
00:41:47,540 --> 00:41:52,460
you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> write</font><font color="#CCCCCC"> into or write</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> of from</font>

1026
00:41:49,850 --> 00:41:54,770
slack and there may or may<font color="#CCCCCC"> not be good</font>

1027
00:41:52,460 --> 00:41:57,080
alerting for that<font color="#E5E5E5"> so that's something to</font>

1028
00:41:54,770 --> 00:42:00,470
be<font color="#E5E5E5"> aware of your tokens really can be</font>

1029
00:41:57,080 --> 00:42:03,560
<font color="#CCCCCC">the keys to your castle we asked as a</font>

1030
00:42:00,470 --> 00:42:05,779
non<font color="#CCCCCC"> privilege user</font><font color="#E5E5E5"> can I will I be able</font>

1031
00:42:03,560 --> 00:42:08,710
<font color="#E5E5E5">to see the names of all the private</font>

1032
00:42:05,780 --> 00:42:18,099
<font color="#E5E5E5">channels that I'm not invited to and</font>

1033
00:42:08,710 --> 00:42:20,260
<font color="#CCCCCC">No so I think you're asking if if like</font>

1034
00:42:18,099 --> 00:42:22,630
blue team were to<font color="#E5E5E5"> find out that somebody</font>

1035
00:42:20,260 --> 00:42:24,359
<font color="#E5E5E5">put the corporate Wi-Fi password in</font>

1036
00:42:22,630 --> 00:42:29,250
slack and went and<font color="#E5E5E5"> talked to that user</font>

1037
00:42:24,359 --> 00:42:29,250
<font color="#E5E5E5">how</font><font color="#CCCCCC"> would they how have they reacted</font>

1038
00:42:29,580 --> 00:42:34,569
well that can be<font color="#CCCCCC"> a</font><font color="#E5E5E5"> little bit touchy</font>

1039
00:42:33,369 --> 00:42:36,700
<font color="#E5E5E5">because the user of</font><font color="#CCCCCC"> course is going to</font>

1040
00:42:34,570 --> 00:42:37,960
<font color="#E5E5E5">first say hey I probably didn't do that</font>

1041
00:42:36,700 --> 00:42:41,049
or it was an accident

1042
00:42:37,960 --> 00:42:43,750
a lot<font color="#CCCCCC"> of the time as as blue team's as</font>

1043
00:42:41,050 --> 00:42:46,150
owners as admins we can go in we can

1044
00:42:43,750 --> 00:42:50,740
delete<font color="#E5E5E5"> that message depending</font><font color="#CCCCCC"> again on</font>

1045
00:42:46,150 --> 00:42:52,390
our<font color="#E5E5E5"> level</font><font color="#CCCCCC"> of slack then we have to push</font>

1046
00:42:50,740 --> 00:42:54,490
a change because<font color="#CCCCCC"> again you don't know</font>

1047
00:42:52,390 --> 00:42:56,589
who's downloaded it<font color="#E5E5E5"> so you still</font><font color="#CCCCCC"> need to</font>

1048
00:42:54,490 --> 00:42:58,779
<font color="#CCCCCC">rotate</font><font color="#E5E5E5"> it treat</font><font color="#CCCCCC"> it just as if it was</font>

1049
00:42:56,589 --> 00:43:00,790
completely<font color="#E5E5E5"> compromised it's just like</font>

1050
00:42:58,780 --> 00:43:02,230
any<font color="#E5E5E5"> other password</font><font color="#CCCCCC"> if you treat it</font><font color="#E5E5E5"> like</font>

1051
00:43:00,790 --> 00:43:05,349
<font color="#E5E5E5">it's been compromised</font><font color="#CCCCCC"> it's a cloud</font>

1052
00:43:02,230 --> 00:43:07,359
environment<font color="#CCCCCC"> if you don't know for</font><font color="#E5E5E5"> 100%</font>

1053
00:43:05,349 --> 00:43:09,880
<font color="#E5E5E5">certain nobody's ever scraped your</font>

1054
00:43:07,359 --> 00:43:14,859
environment then treat it<font color="#E5E5E5"> like it's been</font>

1055
00:43:09,880 --> 00:43:17,470
compromised<font color="#E5E5E5"> ask you about</font><font color="#CCCCCC"> something to</font>

1056
00:43:14,859 --> 00:43:20,830
go back home<font color="#E5E5E5"> and</font><font color="#CCCCCC"> try if you use slack</font>

1057
00:43:17,470 --> 00:43:22,689
<font color="#CCCCCC">it's to type in the search password and</font>

1058
00:43:20,830 --> 00:43:24,549
just<font color="#CCCCCC"> get an idea of how</font><font color="#E5E5E5"> much is</font>

1059
00:43:22,690 --> 00:43:26,950
accessible even<font color="#E5E5E5"> to you and if you do it</font>

1060
00:43:24,550 --> 00:43:28,750
like password<font color="#CCCCCC"> :</font><font color="#E5E5E5"> but you need to put that</font>

1061
00:43:26,950 --> 00:43:31,689
in double quotes so you're telling slack

1062
00:43:28,750 --> 00:43:33,400
I you<font color="#E5E5E5"> know don't try to be smart and</font>

1063
00:43:31,690 --> 00:43:36,040
give me things like password I went

1064
00:43:33,400 --> 00:43:38,200
specifically password :<font color="#CCCCCC"> then you'll find</font>

1065
00:43:36,040 --> 00:43:39,670
even<font color="#CCCCCC"> more stuff quickly</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> people</font>

1066
00:43:38,200 --> 00:43:42,040
will do that<font color="#CCCCCC"> password : and put the</font>

1067
00:43:39,670 --> 00:43:45,220
password<font color="#E5E5E5"> but question in the black here</font>

1068
00:43:42,040 --> 00:43:49,359
the question is what's the largest<font color="#CCCCCC"> exfil</font>

1069
00:43:45,220 --> 00:43:53,859
I've done well I assume I assume I've

1070
00:43:49,359 --> 00:43:57,069
done with the slack extract<font color="#E5E5E5"> I've let it</font>

1071
00:43:53,859 --> 00:44:00,880
<font color="#E5E5E5">I haven't I've used it like in three</font>

1072
00:43:57,070 --> 00:44:03,760
campaigns so far and I didn't look up

1073
00:44:00,880 --> 00:44:06,220
how big it<font color="#E5E5E5"> was well it was</font><font color="#CCCCCC"> about the</font>

1074
00:44:03,760 --> 00:44:07,990
last<font color="#E5E5E5"> time I was about</font><font color="#CCCCCC"> ten gigs</font><font color="#E5E5E5"> and it</font>

1075
00:44:06,220 --> 00:44:09,490
ran<font color="#CCCCCC"> through</font><font color="#E5E5E5"> the night it was done in the</font>

1076
00:44:07,990 --> 00:44:13,959
morning<font color="#CCCCCC"> so I'm not sure how many hours</font>

1077
00:44:09,490 --> 00:44:16,240
it took but maybe six<font color="#E5E5E5"> or</font><font color="#CCCCCC"> seven hours for</font>

1078
00:44:13,960 --> 00:44:17,650
<font color="#CCCCCC">10 gigs</font><font color="#E5E5E5"> and I was using</font><font color="#CCCCCC"> that they fought</font>

1079
00:44:16,240 --> 00:44:20,649
<font color="#E5E5E5">limits so</font>

1080
00:44:17,650 --> 00:44:24,090
<font color="#CCCCCC">ten ten thousand messages</font><font color="#E5E5E5"> per channel</font>

1081
00:44:20,650 --> 00:44:24,090
<font color="#E5E5E5">two thousand files per channel</font>

1082
00:44:28,290 --> 00:44:32,710
<font color="#CCCCCC">you kept you tapped long enough</font><font color="#E5E5E5"> okay</font>

1083
00:44:30,610 --> 00:44:34,510
<font color="#CCCCCC">you're welcome to come up and chat with</font>

1084
00:44:32,710 --> 00:44:47,619
<font color="#CCCCCC">us afterwards</font><font color="#E5E5E5"> so thanks for coming</font>

1085
00:44:34,510 --> 00:44:47,619
[Music]

