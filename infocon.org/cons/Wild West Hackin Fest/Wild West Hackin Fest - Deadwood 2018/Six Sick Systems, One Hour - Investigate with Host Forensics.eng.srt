1
00:00:00,300 --> 00:00:08,230
[Music]

2
00:00:08,570 --> 00:00:13,110
I'm happy to<font color="#E5E5E5"> be here is my first time</font>

3
00:00:10,920 --> 00:00:15,540
<font color="#E5E5E5">out to South Dakota like many of you it</font>

4
00:00:13,110 --> 00:00:18,600
<font color="#CCCCCC">is awesome so I'm going</font><font color="#E5E5E5"> to be talking</font>

5
00:00:15,540 --> 00:00:21,240
<font color="#CCCCCC">about one of</font><font color="#E5E5E5"> my passions which is memory</font>

6
00:00:18,600 --> 00:00:23,850
forensics a little bit about me just a

7
00:00:21,240 --> 00:00:25,169
little<font color="#CCCCCC"> bit I teach</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> sans I've been</font>

8
00:00:23,850 --> 00:00:28,170
teaching for<font color="#CCCCCC"> sans as a sort of an</font>

9
00:00:25,170 --> 00:00:29,340
instructor<font color="#CCCCCC"> for five years and again in</font>

10
00:00:28,170 --> 00:00:31,230
the digital<font color="#CCCCCC"> forensics Incident Response</font>

11
00:00:29,340 --> 00:00:35,640
<font color="#CCCCCC">tract so</font><font color="#E5E5E5"> you might have had</font><font color="#CCCCCC"> me in the</font>

12
00:00:31,230 --> 00:00:37,920
500 508 504 but the class that I own is

13
00:00:35,640 --> 00:00:40,440
the memory forensics so that's the 526

14
00:00:37,920 --> 00:00:41,910
and check it out<font color="#CCCCCC"> it's cool</font><font color="#E5E5E5"> I'm not</font><font color="#CCCCCC"> gonna</font>

15
00:00:40,440 --> 00:00:45,059
talk<font color="#E5E5E5"> too much about</font><font color="#CCCCCC"> it but I'm going</font><font color="#E5E5E5"> to</font>

16
00:00:41,910 --> 00:00:47,190
show<font color="#E5E5E5"> you how I was able to make my team</font>

17
00:00:45,059 --> 00:00:49,860
more effective my most recent full-time

18
00:00:47,190 --> 00:00:51,360
position was leaving an incident

19
00:00:49,860 --> 00:00:53,670
response<font color="#CCCCCC"> team</font><font color="#E5E5E5"> at Cargill I think it's</font>

20
00:00:51,360 --> 00:00:55,860
still<font color="#E5E5E5"> up</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> but it was a good time</font>

21
00:00:53,670 --> 00:00:57,390
and<font color="#E5E5E5"> it was a good time and often times</font>

22
00:00:55,860 --> 00:00:59,519
<font color="#E5E5E5">Incident Response Teams</font>

23
00:00:57,390 --> 00:01:01,379
<font color="#E5E5E5">well you know there's no time for root</font>

24
00:00:59,520 --> 00:01:03,329
cause analysis so<font color="#E5E5E5"> you have to be pretty</font>

25
00:01:01,379 --> 00:01:05,369
picky about how you proceed<font color="#CCCCCC"> with</font>

26
00:01:03,329 --> 00:01:09,630
compromised<font color="#CCCCCC"> systems on</font><font color="#E5E5E5"> it anyone working</font>

27
00:01:05,369 --> 00:01:11,909
IR right<font color="#E5E5E5"> now oh dude I'm so psyched to</font>

28
00:01:09,630 --> 00:01:13,798
be<font color="#E5E5E5"> on ok ok</font><font color="#CCCCCC"> I was pretty happy already</font>

29
00:01:11,909 --> 00:01:15,780
but the fact that<font color="#E5E5E5"> about half of you</font>

30
00:01:13,799 --> 00:01:18,930
raised<font color="#E5E5E5"> your hands I feel like I'm</font>

31
00:01:15,780 --> 00:01:19,530
amongst<font color="#E5E5E5"> friends you know</font><font color="#CCCCCC"> you should feel</font>

32
00:01:18,930 --> 00:01:21,479
that<font color="#E5E5E5"> way</font><font color="#CCCCCC"> too</font>

33
00:01:19,530 --> 00:01:23,430
so what we're going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be well first off</font>

34
00:01:21,479 --> 00:01:26,970
because<font color="#E5E5E5"> we are</font><font color="#CCCCCC"> talking about</font><font color="#E5E5E5"> you all</font>

35
00:01:23,430 --> 00:01:29,670
good job and good<font color="#CCCCCC"> job in furthering your</font>

36
00:01:26,970 --> 00:01:31,890
<font color="#E5E5E5">skill set it's no joke you</font><font color="#CCCCCC"> know you have</font>

37
00:01:29,670 --> 00:01:33,570
to go to<font color="#E5E5E5"> ground</font><font color="#CCCCCC"> and continue your</font>

38
00:01:31,890 --> 00:01:35,729
learning constantly<font color="#E5E5E5"> to stay up-to-date</font>

39
00:01:33,570 --> 00:01:37,860
<font color="#CCCCCC">in</font><font color="#E5E5E5"> this field some of you may</font><font color="#CCCCCC"> be</font>

40
00:01:35,729 --> 00:01:39,570
checking your<font color="#CCCCCC"> Twitter feed right now am</font>

41
00:01:37,860 --> 00:01:41,310
<font color="#E5E5E5">i right no there's only a couple</font><font color="#CCCCCC"> of you</font>

42
00:01:39,570 --> 00:01:43,500
looking down<font color="#CCCCCC"> right now but</font><font color="#E5E5E5"> yeah I mean</font>

43
00:01:41,310 --> 00:01:46,079
<font color="#E5E5E5">isn't that</font><font color="#CCCCCC"> how we stay up</font><font color="#E5E5E5"> to date just</font>

44
00:01:43,500 --> 00:01:49,680
constantly<font color="#E5E5E5"> attending training watching</font>

45
00:01:46,079 --> 00:01:51,839
webinars which are so very<font color="#E5E5E5"> very many of</font>

46
00:01:49,680 --> 00:01:54,119
them these<font color="#E5E5E5"> days but I commend you</font><font color="#CCCCCC"> I</font>

47
00:01:51,840 --> 00:01:55,110
<font color="#E5E5E5">commend you not everybody's here</font><font color="#CCCCCC"> looks</font>

48
00:01:54,119 --> 00:01:57,149
<font color="#CCCCCC">your left or right</font><font color="#E5E5E5"> there's empty seats</font>

49
00:01:55,110 --> 00:01:58,979
<font color="#E5E5E5">for shame for</font><font color="#CCCCCC"> shame we're gonna shame</font>

50
00:01:57,149 --> 00:02:02,119
those other<font color="#E5E5E5"> folks that didn't make it</font><font color="#CCCCCC"> to</font>

51
00:01:58,979 --> 00:02:03,240
this this conference<font color="#CCCCCC"> this attend</font>

52
00:02:02,119 --> 00:02:06,060
presentation

53
00:02:03,240 --> 00:02:07,649
hey so as I was<font color="#CCCCCC"> growing my</font><font color="#E5E5E5"> Incident</font>

54
00:02:06,060 --> 00:02:10,410
<font color="#E5E5E5">Response Team there was a certain</font>

55
00:02:07,649 --> 00:02:11,959
<font color="#CCCCCC">skillset I was looking for it's true</font>

56
00:02:10,410 --> 00:02:14,030
it's true

57
00:02:11,959 --> 00:02:16,489
definitely people<font color="#E5E5E5"> who had been in the</font>

58
00:02:14,030 --> 00:02:20,329
trenches<font color="#E5E5E5"> who had worked investigations</font>

59
00:02:16,489 --> 00:02:21,769
of an enterprise<font color="#E5E5E5"> scale maybe who had</font>

60
00:02:20,329 --> 00:02:24,140
<font color="#E5E5E5">experienced a little</font><font color="#CCCCCC"> bit of pain and</font>

61
00:02:21,769 --> 00:02:26,180
<font color="#E5E5E5">embarrassment</font><font color="#CCCCCC"> you know that that tempers</font>

62
00:02:24,140 --> 00:02:28,339
an incident responder would you say

63
00:02:26,180 --> 00:02:30,680
<font color="#E5E5E5">you're</font><font color="#CCCCCC"> the more</font><font color="#E5E5E5"> that you've seen the</font>

64
00:02:28,340 --> 00:02:33,170
more hard times that<font color="#CCCCCC"> you live through I</font>

65
00:02:30,680 --> 00:02:34,549
<font color="#E5E5E5">I think</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> makes you a better incident</font>

66
00:02:33,170 --> 00:02:37,339
responder<font color="#CCCCCC"> but don't tell your boss that</font>

67
00:02:34,549 --> 00:02:39,019
<font color="#CCCCCC">you know it's it's you have</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> act the</font>

68
00:02:37,340 --> 00:02:43,639
<font color="#CCCCCC">part like I can't believe the attacker</font>

69
00:02:39,019 --> 00:02:45,680
did this what<font color="#E5E5E5"> but you know I grew the</font>

70
00:02:43,639 --> 00:02:48,260
size of my incident response team we

71
00:02:45,680 --> 00:02:50,659
actually<font color="#E5E5E5"> doubled the size while I was at</font>

72
00:02:48,260 --> 00:02:53,048
Cargill and I got to do a lot of

73
00:02:50,659 --> 00:02:55,790
interviews<font color="#CCCCCC"> and I was always</font><font color="#E5E5E5"> looking for</font>

74
00:02:53,049 --> 00:02:57,980
<font color="#E5E5E5">purists</font><font color="#CCCCCC"> you know what I mean</font><font color="#E5E5E5"> by purists</font>

75
00:02:55,790 --> 00:03:00,620
people who want to do a deep dive who

76
00:02:57,980 --> 00:03:03,409
actually wants to<font color="#E5E5E5"> find out root cause</font>

77
00:03:00,620 --> 00:03:05,719
like<font color="#E5E5E5"> okay this malware is fascinating</font>

78
00:03:03,409 --> 00:03:07,250
but how did it<font color="#E5E5E5"> get there and they want</font>

79
00:03:05,719 --> 00:03:08,750
<font color="#E5E5E5">to apply whether there be</font><font color="#CCCCCC"> a network</font>

80
00:03:07,250 --> 00:03:10,519
forensic specialists or host<font color="#CCCCCC"> based</font>

81
00:03:08,750 --> 00:03:12,859
forensic specialists<font color="#E5E5E5"> they want to apply</font>

82
00:03:10,519 --> 00:03:15,439
<font color="#E5E5E5">their unique skill set in order</font><font color="#CCCCCC"> to find</font>

83
00:03:12,859 --> 00:03:17,900
the answer<font color="#E5E5E5"> so I hope that</font><font color="#CCCCCC"> you guys would</font>

84
00:03:15,439 --> 00:03:20,840
join<font color="#E5E5E5"> me in doing</font><font color="#CCCCCC"> just this very same</font>

85
00:03:17,900 --> 00:03:23,060
<font color="#E5E5E5">thing with the six systems</font>

86
00:03:20,840 --> 00:03:25,099
<font color="#CCCCCC">maybe Plus wine</font><font color="#E5E5E5"> that we're going to be</font>

87
00:03:23,060 --> 00:03:27,049
<font color="#E5E5E5">looking at so first and foremost I have</font>

88
00:03:25,099 --> 00:03:32,689
to kick out and say<font color="#E5E5E5"> memory forensics is</font>

89
00:03:27,049 --> 00:03:36,729
awesome<font color="#E5E5E5"> yes oh yeah yeah he's a you're</font>

90
00:03:32,689 --> 00:03:38,810
an alumni<font color="#E5E5E5"> right are you a</font><font color="#CCCCCC"> GC FA already</font>

91
00:03:36,729 --> 00:03:42,290
yeah yeah yeah yeah<font color="#E5E5E5"> awesome</font>

92
00:03:38,810 --> 00:03:43,669
congratulations<font color="#CCCCCC"> 508 alumni here</font><font color="#E5E5E5"> so I'm</font>

93
00:03:42,290 --> 00:03:45,709
<font color="#E5E5E5">not gonna go through each and every</font><font color="#CCCCCC"> one</font>

94
00:03:43,669 --> 00:03:47,659
of these reasons<font color="#E5E5E5"> why you need to be</font>

95
00:03:45,709 --> 00:03:50,329
<font color="#E5E5E5">looking in memory in system memory I'll</font>

96
00:03:47,659 --> 00:03:53,000
just ask<font color="#E5E5E5"> are you do you have the ability</font>

97
00:03:50,329 --> 00:03:55,250
<font color="#CCCCCC">in your enterprise to reach across</font><font color="#E5E5E5"> the</font>

98
00:03:53,000 --> 00:03:57,439
wire and<font color="#CCCCCC"> pull back the</font><font color="#E5E5E5"> contents of</font>

99
00:03:55,250 --> 00:03:59,150
physical memory some people are saying

100
00:03:57,439 --> 00:04:01,970
no yes<font color="#E5E5E5"> there</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> some hands going up</font>

101
00:03:59,150 --> 00:04:04,579
impressive impressive<font color="#CCCCCC"> and the last time</font>

102
00:04:01,970 --> 00:04:07,669
we asked via<font color="#E5E5E5"> sans survey it was right at</font>

103
00:04:04,579 --> 00:04:09,620
<font color="#CCCCCC">40% that</font><font color="#E5E5E5"> was last year we asked how many</font>

104
00:04:07,669 --> 00:04:12,229
<font color="#E5E5E5">of the</font><font color="#CCCCCC"> participants of</font><font color="#E5E5E5"> the endpoint</font>

105
00:04:09,620 --> 00:04:15,769
security survey have the ability to pull

106
00:04:12,229 --> 00:04:19,519
back memory data it was just a<font color="#CCCCCC"> 40%</font><font color="#E5E5E5"> so I</font>

107
00:04:15,769 --> 00:04:20,209
think<font color="#E5E5E5"> I'm amongst the elite here very</font>

108
00:04:19,519 --> 00:04:23,560
well<font color="#E5E5E5"> very well</font>

109
00:04:20,209 --> 00:04:25,940
so we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to find hand how the</font>

110
00:04:23,560 --> 00:04:28,850
contents<font color="#E5E5E5"> of memory is going to be</font>

111
00:04:25,940 --> 00:04:31,490
kind of like shed light on what<font color="#CCCCCC"> happened</font>

112
00:04:28,850 --> 00:04:34,040
the<font color="#CCCCCC"> first compromise system that I want</font>

113
00:04:31,490 --> 00:04:35,870
to<font color="#E5E5E5"> introduce to you</font><font color="#CCCCCC"> well it's an</font>

114
00:04:34,040 --> 00:04:37,640
<font color="#CCCCCC">anti-virus</font><font color="#E5E5E5"> it you're like</font><font color="#CCCCCC"> blah that's</font>

115
00:04:35,870 --> 00:04:39,680
crap I'm out<font color="#CCCCCC"> of here</font><font color="#E5E5E5"> I'll turn around</font>

116
00:04:37,640 --> 00:04:41,180
<font color="#E5E5E5">again</font><font color="#CCCCCC"> so anyone</font><font color="#E5E5E5"> who</font><font color="#CCCCCC"> wants</font><font color="#E5E5E5"> to leave okay</font>

117
00:04:39,680 --> 00:04:42,800
<font color="#E5E5E5">all right no no</font>

118
00:04:41,180 --> 00:04:45,620
so again if you're<font color="#CCCCCC"> just walking in</font><font color="#E5E5E5"> this</font>

119
00:04:42,800 --> 00:04:48,560
<font color="#E5E5E5">isn't the AWS presentation no it's even</font>

120
00:04:45,620 --> 00:04:51,410
<font color="#CCCCCC">better than that</font><font color="#E5E5E5"> so host base host</font><font color="#CCCCCC"> base</font>

121
00:04:48,560 --> 00:04:55,640
forensics<font color="#CCCCCC"> this first system</font><font color="#E5E5E5"> was</font>

122
00:04:51,410 --> 00:04:58,300
identified<font color="#CCCCCC"> by my Sauk analysts yeah yeah</font>

123
00:04:55,640 --> 00:05:00,890
every morning<font color="#E5E5E5"> we had a</font><font color="#CCCCCC"> stand up meeting</font>

124
00:04:58,300 --> 00:05:02,090
incident response<font color="#CCCCCC"> team and Sauk analyst</font>

125
00:05:00,890 --> 00:05:03,620
and I think that's very important<font color="#E5E5E5"> you</font>

126
00:05:02,090 --> 00:05:06,200
know<font color="#CCCCCC"> the</font><font color="#E5E5E5"> communication we weren't there</font>

127
00:05:03,620 --> 00:05:07,790
<font color="#CCCCCC">for every</font><font color="#E5E5E5"> turnover because we had 24/7</font>

128
00:05:06,200 --> 00:05:09,920
<font color="#E5E5E5">follow-the-sun</font><font color="#CCCCCC"> Security Operations</font>

129
00:05:07,790 --> 00:05:12,290
<font color="#CCCCCC">Center</font><font color="#E5E5E5"> but we were there</font><font color="#CCCCCC"> every morning</font>

130
00:05:09,920 --> 00:05:15,740
<font color="#E5E5E5">when it counts right</font><font color="#CCCCCC"> and we went over</font>

131
00:05:12,290 --> 00:05:17,300
the antivirus report<font color="#E5E5E5"> and largely if the</font>

132
00:05:15,740 --> 00:05:19,550
antivirus product that we were using<font color="#E5E5E5"> it</font>

133
00:05:17,300 --> 00:05:21,230
wasn't so folks come<font color="#E5E5E5"> on the antivirus</font>

134
00:05:19,550 --> 00:05:23,840
product that we're using set in a

135
00:05:21,230 --> 00:05:26,150
quarantine something my analysts weren't

136
00:05:23,840 --> 00:05:28,400
concerned<font color="#E5E5E5"> about it is that the right way</font>

137
00:05:26,150 --> 00:05:30,979
to proceed<font color="#CCCCCC"> I mean well</font><font color="#E5E5E5"> you might want to</font>

138
00:05:28,400 --> 00:05:32,950
find<font color="#E5E5E5"> out more details</font><font color="#CCCCCC"> so in this case we</font>

139
00:05:30,980 --> 00:05:36,020
have a<font color="#E5E5E5"> screenshot of so posts</font>

140
00:05:32,950 --> 00:05:38,750
identifying<font color="#E5E5E5"> an</font><font color="#CCCCCC"> SVC host</font><font color="#E5E5E5"> those are always</font>

141
00:05:36,020 --> 00:05:41,990
legitimate right<font color="#CCCCCC"> I see</font><font color="#E5E5E5"> some people</font>

142
00:05:38,750 --> 00:05:43,760
nodding<font color="#CCCCCC"> how yeah I love this crowd yeah</font>

143
00:05:41,990 --> 00:05:45,950
so we got<font color="#CCCCCC"> an SPC host but that's been</font>

144
00:05:43,760 --> 00:05:47,719
<font color="#CCCCCC">identified</font><font color="#E5E5E5"> but it's be a scheduled scan</font>

145
00:05:45,950 --> 00:05:49,580
<font color="#CCCCCC">and I don't</font><font color="#E5E5E5"> know how</font><font color="#CCCCCC"> frequently</font>

146
00:05:47,720 --> 00:05:51,590
scheduled scans are in your environment

147
00:05:49,580 --> 00:05:52,990
<font color="#CCCCCC">but we were like</font><font color="#E5E5E5"> at a month mark and</font>

148
00:05:51,590 --> 00:05:56,030
we'd call<font color="#CCCCCC"> it good</font><font color="#E5E5E5"> you're like what's</font>

149
00:05:52,990 --> 00:05:57,919
scheduled scans<font color="#CCCCCC"> are</font><font color="#E5E5E5"> weekly not in some</font>

150
00:05:56,030 --> 00:06:00,770
environments<font color="#E5E5E5"> I assure you it's like the</font>

151
00:05:57,919 --> 00:06:04,010
month mark<font color="#E5E5E5"> so what happens if this SVC</font>

152
00:06:00,770 --> 00:06:06,080
host<font color="#E5E5E5"> was detected be a scheduled scan on</font>

153
00:06:04,010 --> 00:06:08,240
the file system<font color="#CCCCCC"> what could have</font><font color="#E5E5E5"> happened</font>

154
00:06:06,080 --> 00:06:10,849
between the time<font color="#CCCCCC"> that this binary landed</font>

155
00:06:08,240 --> 00:06:15,080
on the box<font color="#E5E5E5"> and the time well in this</font>

156
00:06:10,850 --> 00:06:17,930
case so post detected<font color="#CCCCCC"> it oh that's a</font>

157
00:06:15,080 --> 00:06:20,270
<font color="#E5E5E5">perfect answer</font><font color="#CCCCCC"> you don't know or</font>

158
00:06:17,930 --> 00:06:22,910
computer science answer it<font color="#E5E5E5"> depends right</font>

159
00:06:20,270 --> 00:06:25,880
<font color="#E5E5E5">it depends</font><font color="#CCCCCC"> I get it I get</font><font color="#E5E5E5"> it</font>

160
00:06:22,910 --> 00:06:28,160
I like I<font color="#E5E5E5"> like this audience</font><font color="#CCCCCC"> so we're</font>

161
00:06:25,880 --> 00:06:29,900
going to<font color="#E5E5E5"> go about figuring out did this</font>

162
00:06:28,160 --> 00:06:31,550
execute isn't that one of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> most</font>

163
00:06:29,900 --> 00:06:34,070
important things to<font color="#CCCCCC"> find</font><font color="#E5E5E5"> out at this</font>

164
00:06:31,550 --> 00:06:35,030
<font color="#E5E5E5">point</font><font color="#CCCCCC"> yeah like I said my</font><font color="#E5E5E5"> sock analysts</font>

165
00:06:34,070 --> 00:06:37,580
were like whoa

166
00:06:35,030 --> 00:06:39,479
listen he's taken care<font color="#CCCCCC"> of antivirus said</font>

167
00:06:37,580 --> 00:06:41,070
<font color="#E5E5E5">is quarantined but I'm like do</font>

168
00:06:39,480 --> 00:06:43,139
<font color="#E5E5E5">yeah</font><font color="#CCCCCC"> it's quarantine today but what</font>

169
00:06:41,070 --> 00:06:46,080
happened over the last<font color="#E5E5E5"> month since it</font>

170
00:06:43,139 --> 00:06:47,520
land in<font color="#E5E5E5"> the box so I encourage my</font><font color="#CCCCCC"> incent</font>

171
00:06:46,080 --> 00:06:49,650
responders to do some root cause

172
00:06:47,520 --> 00:06:52,530
analysis to go back and<font color="#CCCCCC"> figure out when</font>

173
00:06:49,650 --> 00:06:54,090
that<font color="#CCCCCC"> SVC host</font><font color="#E5E5E5"> ANDed hey can anyone tell</font>

174
00:06:52,530 --> 00:06:57,030
<font color="#E5E5E5">me this is obviously an exemple our</font>

175
00:06:54,090 --> 00:06:58,469
memory image<font color="#E5E5E5"> and system them that I'm</font>

176
00:06:57,030 --> 00:07:01,369
cueing off of that I have so<font color="#E5E5E5"> folks</font>

177
00:06:58,470 --> 00:07:05,250
running on where<font color="#E5E5E5"> did I get the VM from</font>

178
00:07:01,370 --> 00:07:09,120
based on the user profile<font color="#E5E5E5"> same will</font>

179
00:07:05,250 --> 00:07:12,060
recognize the user profile where the SVC

180
00:07:09,120 --> 00:07:14,160
host was detected<font color="#E5E5E5"> it says ie user is</font>

181
00:07:12,060 --> 00:07:16,020
anyone<font color="#CCCCCC"> using the free VMs from</font><font color="#E5E5E5"> Microsoft</font>

182
00:07:14,160 --> 00:07:17,610
thank you thank you<font color="#E5E5E5"> if you're not</font>

183
00:07:16,020 --> 00:07:19,740
<font color="#CCCCCC">downloading the free VMs from</font>

184
00:07:17,610 --> 00:07:22,139
Microsoft's I know they put them up

185
00:07:19,740 --> 00:07:25,050
there so you can do what a web app

186
00:07:22,139 --> 00:07:26,610
testing but dude those are<font color="#E5E5E5"> awesome</font><font color="#CCCCCC"> all</font>

187
00:07:25,050 --> 00:07:28,889
of these different versions<font color="#CCCCCC"> of</font><font color="#E5E5E5"> Windows</font>

188
00:07:26,610 --> 00:07:30,600
<font color="#CCCCCC">and</font><font color="#E5E5E5"> you can infect them so I don't know</font>

189
00:07:28,889 --> 00:07:34,229
<font color="#E5E5E5">it break open your</font><font color="#CCCCCC"> left start</font>

190
00:07:30,600 --> 00:07:36,030
downloading now<font color="#E5E5E5"> anyways so the next</font>

191
00:07:34,229 --> 00:07:38,370
thing that we did of course was dump

192
00:07:36,030 --> 00:07:40,109
memory<font color="#E5E5E5"> because I strongly influenced my</font>

193
00:07:38,370 --> 00:07:43,350
team<font color="#E5E5E5"> and like</font><font color="#CCCCCC"> you need</font><font color="#E5E5E5"> to go get memory</font>

194
00:07:40,110 --> 00:07:46,289
of the system so I present<font color="#CCCCCC"> to you</font><font color="#E5E5E5"> the</font>

195
00:07:43,350 --> 00:07:49,919
<font color="#E5E5E5">output from running PS list and then of</font>

196
00:07:46,289 --> 00:07:51,740
course<font color="#E5E5E5"> bringing it</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> calc which is</font>

197
00:07:49,919 --> 00:07:54,090
open offices excellent spreadsheets

198
00:07:51,740 --> 00:07:57,150
<font color="#E5E5E5">application and kind of just filtering</font>

199
00:07:54,090 --> 00:08:07,679
on SVC host is<font color="#CCCCCC"> Q which one of these</font>

200
00:07:57,150 --> 00:08:10,349
should<font color="#E5E5E5"> I be</font><font color="#CCCCCC"> concerned about you guys are</font>

201
00:08:07,680 --> 00:08:12,270
saying the last one can you give me

202
00:08:10,350 --> 00:08:16,110
<font color="#E5E5E5">three reasons why the last one is all</font>

203
00:08:12,270 --> 00:08:17,370
kinds<font color="#E5E5E5"> of crazy and worrisome you can you</font>

204
00:08:16,110 --> 00:08:19,350
can answer<font color="#CCCCCC"> in</font><font color="#E5E5E5"> your head you're just not</font>

205
00:08:17,370 --> 00:08:22,530
like yeah I totally<font color="#CCCCCC"> I see three you can</font>

206
00:08:19,350 --> 00:08:24,990
give me<font color="#E5E5E5"> two of them</font><font color="#CCCCCC"> oh session two he's</font>

207
00:08:22,530 --> 00:08:27,059
only of<font color="#E5E5E5"> his head so session enumeration</font>

208
00:08:24,990 --> 00:08:29,789
yeah he's<font color="#E5E5E5"> saying that last one I'll</font><font color="#CCCCCC"> just</font>

209
00:08:27,060 --> 00:08:32,458
go ahead and point it out<font color="#E5E5E5"> that last SVC</font>

210
00:08:29,789 --> 00:08:34,919
host is the one that<font color="#E5E5E5"> was hanging on the</font>

211
00:08:32,458 --> 00:08:38,279
<font color="#E5E5E5">user profile directory and this is a</font>

212
00:08:34,919 --> 00:08:40,348
<font color="#E5E5E5">process list so I'm I'm actually parsing</font>

213
00:08:38,279 --> 00:08:41,820
the memory of the system that<font color="#E5E5E5"> we thought</font>

214
00:08:40,349 --> 00:08:44,820
<font color="#CCCCCC">was all clear because</font><font color="#E5E5E5"> so folks</font>

215
00:08:41,820 --> 00:08:46,830
quarantine<font color="#E5E5E5"> this I'm seeing that SVC host</font>

216
00:08:44,820 --> 00:08:49,589
<font color="#E5E5E5">is currently running despite it being</font>

217
00:08:46,830 --> 00:08:52,709
sucked off the<font color="#E5E5E5"> file system</font><font color="#CCCCCC"> and I know</font>

218
00:08:49,589 --> 00:08:52,920
that<font color="#E5E5E5"> this is not a legit</font><font color="#CCCCCC"> SVC host will</font>

219
00:08:52,709 --> 00:08:54,689
<font color="#E5E5E5">be</font>

220
00:08:52,920 --> 00:08:58,110
<font color="#CCCCCC">cuz it's in session two which is a user</font>

221
00:08:54,690 --> 00:09:00,000
session where why else<font color="#E5E5E5"> the parent</font>

222
00:08:58,110 --> 00:09:01,709
process<font color="#E5E5E5"> identifier we don't know what</font>

223
00:09:00,000 --> 00:09:04,110
the parent<font color="#E5E5E5"> process identify errs are of</font>

224
00:09:01,709 --> 00:09:08,089
the legitimate<font color="#CCCCCC"> SPC host</font><font color="#E5E5E5"> we know it's</font>

225
00:09:04,110 --> 00:09:08,089
four seven six which is

226
00:09:09,050 --> 00:09:14,339
<font color="#CCCCCC">services services</font><font color="#E5E5E5"> yeah okay you just at</font>

227
00:09:12,480 --> 00:09:16,709
this<font color="#E5E5E5"> point if you're not down with</font>

228
00:09:14,339 --> 00:09:18,839
<font color="#CCCCCC">Windows I guess that's respectable you</font>

229
00:09:16,709 --> 00:09:22,500
know saying<font color="#E5E5E5"> it's good to deny the</font><font color="#CCCCCC"> arrow</font>

230
00:09:18,839 --> 00:09:23,250
<font color="#E5E5E5">windows user slash investigator but four</font>

231
00:09:22,500 --> 00:09:25,709
seven<font color="#E5E5E5"> six</font>

232
00:09:23,250 --> 00:09:28,260
it must be services because that's

233
00:09:25,709 --> 00:09:30,599
<font color="#E5E5E5">legitimate</font><font color="#CCCCCC"> and a Window System</font><font color="#E5E5E5"> wouldn't</font>

234
00:09:28,260 --> 00:09:33,029
run without legitimate<font color="#CCCCCC"> SBC hosts we hope</font>

235
00:09:30,600 --> 00:09:35,910
so having<font color="#E5E5E5"> something other than that is</font>

236
00:09:33,029 --> 00:09:38,160
the peep it is concerning<font color="#E5E5E5"> we could also</font>

237
00:09:35,910 --> 00:09:42,029
point to<font color="#CCCCCC"> the start time this started way</font>

238
00:09:38,160 --> 00:09:44,100
after like days after the other<font color="#CCCCCC"> SBC</font>

239
00:09:42,029 --> 00:09:46,320
<font color="#CCCCCC">hosts</font><font color="#E5E5E5"> so I feel pretty good about this I</font>

240
00:09:44,100 --> 00:09:47,699
<font color="#E5E5E5">mean bad about it but remember my team</font>

241
00:09:46,320 --> 00:09:50,010
<font color="#CCCCCC">is a bunch of purist they're like hell</font>

242
00:09:47,699 --> 00:09:51,660
yeah this<font color="#E5E5E5"> Michigan is compromised let's</font>

243
00:09:50,010 --> 00:09:54,360
keep on going<font color="#CCCCCC"> let's keep on going</font>

244
00:09:51,660 --> 00:09:54,810
so what else<font color="#CCCCCC"> should we</font><font color="#E5E5E5"> ask at this</font><font color="#CCCCCC"> point</font>

245
00:09:54,360 --> 00:09:59,010
<font color="#E5E5E5">in time</font>

246
00:09:54,810 --> 00:10:01,619
just follow your instincts it's hard

247
00:09:59,010 --> 00:10:03,779
it's<font color="#E5E5E5"> hard I know you want to fire</font>

248
00:10:01,620 --> 00:10:06,360
<font color="#E5E5E5">someone don't you you want to find out</font>

249
00:10:03,779 --> 00:10:09,680
how<font color="#E5E5E5"> this got on the box that's what I</font>

250
00:10:06,360 --> 00:10:09,680
want to find out you<font color="#CCCCCC"> were gonna say oh</font>

251
00:10:11,209 --> 00:10:14,880
he's actually saying<font color="#E5E5E5"> that we do a little</font>

252
00:10:13,500 --> 00:10:19,019
bit more investigating and figure out

253
00:10:14,880 --> 00:10:20,939
who that process identifier 400 is and

254
00:10:19,019 --> 00:10:22,980
that actually turns out<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> Explorer</font><font color="#CCCCCC"> I</font>

255
00:10:20,940 --> 00:10:26,130
don't know whether<font color="#E5E5E5"> I give that little</font>

256
00:10:22,980 --> 00:10:28,230
<font color="#CCCCCC">shoutout</font><font color="#E5E5E5"> or not do I know Explorer</font>

257
00:10:26,130 --> 00:10:30,089
<font color="#CCCCCC">launched this thing</font><font color="#E5E5E5"> you can see full</font>

258
00:10:28,230 --> 00:10:33,269
path of<font color="#E5E5E5"> where this current process is</font>

259
00:10:30,089 --> 00:10:35,579
running<font color="#CCCCCC"> from app data</font><font color="#E5E5E5"> there it is man</font><font color="#CCCCCC"> so</font>

260
00:10:33,269 --> 00:10:37,649
suppose said<font color="#E5E5E5"> it taking care</font><font color="#CCCCCC"> of this but</font>

261
00:10:35,579 --> 00:10:39,180
we have a copy of<font color="#CCCCCC"> that</font><font color="#E5E5E5"> binary up in</font>

262
00:10:37,649 --> 00:10:41,279
memory<font color="#E5E5E5"> and it's currently running</font>

263
00:10:39,180 --> 00:10:43,859
<font color="#E5E5E5">whatever this mallow is designed to do</font>

264
00:10:41,279 --> 00:10:46,529
<font color="#E5E5E5">it's been on the box for well that's the</font>

265
00:10:43,860 --> 00:10:50,250
question<font color="#CCCCCC"> right</font><font color="#E5E5E5"> how long has it been on</font>

266
00:10:46,529 --> 00:10:52,500
<font color="#CCCCCC">the</font><font color="#E5E5E5"> box can we find the</font><font color="#CCCCCC"> initial vector</font>

267
00:10:50,250 --> 00:10:55,110
<font color="#E5E5E5">infection how did it get</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the system</font>

268
00:10:52,500 --> 00:10:57,360
so let's do it<font color="#CCCCCC"> let's do it so I'm</font>

269
00:10:55,110 --> 00:10:58,769
throwing out some volatility plugins if

270
00:10:57,360 --> 00:11:01,050
<font color="#E5E5E5">you're are you down with</font><font color="#CCCCCC"> the volatility</font>

271
00:10:58,769 --> 00:11:03,510
because incident responders are probably

272
00:11:01,050 --> 00:11:04,689
<font color="#E5E5E5">using it on a daily so good good so I'm</font>

273
00:11:03,510 --> 00:11:07,270
just like kind of

274
00:11:04,690 --> 00:11:09,760
<font color="#E5E5E5">I don't know</font><font color="#CCCCCC"> given a</font><font color="#E5E5E5"> little</font><font color="#CCCCCC"> coating</font><font color="#E5E5E5"> up</font>

275
00:11:07,270 --> 00:11:12,250
there<font color="#E5E5E5"> this keyword coding for plugins so</font>

276
00:11:09,760 --> 00:11:14,680
the<font color="#E5E5E5"> next plugin</font><font color="#CCCCCC"> that Iran was MFT parser</font>

277
00:11:12,250 --> 00:11:16,570
<font color="#E5E5E5">because I'm a fight I love file system</font>

278
00:11:14,680 --> 00:11:18,670
forensics<font color="#CCCCCC"> too so I'm all about the MFT</font>

279
00:11:16,570 --> 00:11:19,570
<font color="#CCCCCC">carbon for those</font><font color="#E5E5E5"> 1,024 bytes</font>

280
00:11:18,670 --> 00:11:21,910
<font color="#CCCCCC">ching-ching-ching</font>

281
00:11:19,570 --> 00:11:25,960
<font color="#E5E5E5">and what were able to identify is not</font>

282
00:11:21,910 --> 00:11:27,100
the svchost.exe<font color="#CCCCCC"> cuz that record I</font><font color="#E5E5E5"> don't</font>

283
00:11:25,960 --> 00:11:28,840
know what happened to<font color="#E5E5E5"> that record</font><font color="#CCCCCC"> you</font>

284
00:11:27,100 --> 00:11:30,760
know<font color="#E5E5E5"> some records are corrupted memory</font>

285
00:11:28,840 --> 00:11:33,310
<font color="#E5E5E5">you're not gonna get</font><font color="#CCCCCC"> them all it's ok</font>

286
00:11:30,760 --> 00:11:36,010
<font color="#E5E5E5">but we do have the directory that was</font>

287
00:11:33,310 --> 00:11:37,209
created<font color="#E5E5E5"> by the dropper and I thought</font>

288
00:11:36,010 --> 00:11:39,220
that was<font color="#E5E5E5"> pretty cool the directory is</font>

289
00:11:37,210 --> 00:11:41,830
<font color="#E5E5E5">Google and so we have time and date</font>

290
00:11:39,220 --> 00:11:43,360
<font color="#CCCCCC">statuses show I'm smiling</font><font color="#E5E5E5"> we have time</font>

291
00:11:41,830 --> 00:11:44,980
and<font color="#E5E5E5"> dates it was the show when that was</font>

292
00:11:43,360 --> 00:11:47,260
created and<font color="#E5E5E5"> I think that's pretty good</font>

293
00:11:44,980 --> 00:11:50,140
<font color="#CCCCCC">maybe</font><font color="#E5E5E5"> actionable enough to fire someone</font>

294
00:11:47,260 --> 00:11:51,850
<font color="#E5E5E5">I'm</font><font color="#CCCCCC"> also excited I didn't really share</font>

295
00:11:50,140 --> 00:11:53,260
with you that my background<font color="#E5E5E5"> is an</font>

296
00:11:51,850 --> 00:11:54,970
employee investigator for<font color="#E5E5E5"> a large</font>

297
00:11:53,260 --> 00:11:56,950
<font color="#CCCCCC">government contractor</font><font color="#E5E5E5"> so I get really</font>

298
00:11:54,970 --> 00:11:58,570
excited<font color="#CCCCCC"> like oh it's</font><font color="#E5E5E5"> this fault</font><font color="#CCCCCC"> it's her</font>

299
00:11:56,950 --> 00:12:00,880
fault<font color="#CCCCCC"> ok I would always say it's the</font>

300
00:11:58,570 --> 00:12:02,380
<font color="#E5E5E5">user accounts I can attribute the</font>

301
00:12:00,880 --> 00:12:03,400
activity of the user account because

302
00:12:02,380 --> 00:12:05,680
that's the way you write a forensics

303
00:12:03,400 --> 00:12:07,569
report so it's good though join me

304
00:12:05,680 --> 00:12:09,699
<font color="#CCCCCC">alright so we</font><font color="#E5E5E5"> are going ahead and</font>

305
00:12:07,570 --> 00:12:11,380
<font color="#CCCCCC">looking at all of these MFT records</font>

306
00:12:09,700 --> 00:12:13,630
because there's a couple<font color="#CCCCCC"> ways you can</font>

307
00:12:11,380 --> 00:12:16,660
<font color="#E5E5E5">run</font><font color="#CCCCCC"> MFT parser you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> actually send it</font>

308
00:12:13,630 --> 00:12:19,270
to a body file and then you can run<font color="#CCCCCC"> mac</font>

309
00:12:16,660 --> 00:12:22,180
<font color="#E5E5E5">time against it this is just pure nerdy</font>

310
00:12:19,270 --> 00:12:23,439
digital forensic stuff folks that we're

311
00:12:22,180 --> 00:12:25,150
<font color="#CCCCCC">working</font><font color="#E5E5E5"> on the offensive side</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

312
00:12:23,440 --> 00:12:27,250
house<font color="#E5E5E5"> I used to work with them</font><font color="#CCCCCC"> they</font>

313
00:12:25,150 --> 00:12:28,660
called me Indiana<font color="#E5E5E5"> Jones and I thought</font>

314
00:12:27,250 --> 00:12:30,490
that was a<font color="#CCCCCC"> little dated honestly I mean</font>

315
00:12:28,660 --> 00:12:32,589
it kind of showed how old they were<font color="#CCCCCC"> and</font>

316
00:12:30,490 --> 00:12:37,890
it felt<font color="#E5E5E5"> weird to me but I get</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> like</font>

317
00:12:32,590 --> 00:12:37,890
artifact hunter Indiana Jones<font color="#E5E5E5"> no I said</font>

318
00:12:38,010 --> 00:12:43,180
yeah<font color="#E5E5E5"> it's it's the 80s the 90s</font><font color="#CCCCCC"> ok so</font>

319
00:12:41,530 --> 00:12:44,740
what do we see here we<font color="#CCCCCC"> see the Google</font>

320
00:12:43,180 --> 00:12:45,729
directory<font color="#E5E5E5"> because I know I have that MFT</font>

321
00:12:44,740 --> 00:12:48,490
record it's gonna<font color="#E5E5E5"> be the one that's</font>

322
00:12:45,730 --> 00:12:51,490
lower and as you go<font color="#CCCCCC"> up the slide you're</font>

323
00:12:48,490 --> 00:12:54,130
going<font color="#E5E5E5"> back in time so it's older MFT</font>

324
00:12:51,490 --> 00:12:56,140
record so I actually have something

325
00:12:54,130 --> 00:12:59,320
that's<font color="#E5E5E5"> quite</font><font color="#CCCCCC"> interesting to me it's the</font>

326
00:12:56,140 --> 00:13:01,540
loyalty card<font color="#E5E5E5"> dot exe</font><font color="#CCCCCC"> it looks like it</font>

327
00:12:59,320 --> 00:13:03,160
was from<font color="#CCCCCC"> a directory called</font><font color="#E5E5E5"> loyalty card</font>

328
00:13:01,540 --> 00:13:05,349
<font color="#CCCCCC">JPEG and that's weird</font>

329
00:13:03,160 --> 00:13:07,120
<font color="#CCCCCC">but I get it right</font><font color="#E5E5E5"> because everyone</font>

330
00:13:05,350 --> 00:13:09,360
wants a discount<font color="#E5E5E5"> whoa</font><font color="#CCCCCC"> thank you very</font>

331
00:13:07,120 --> 00:13:09,360
<font color="#E5E5E5">much</font>

332
00:13:10,260 --> 00:13:17,140
jealousy<font color="#CCCCCC"> hits</font><font color="#E5E5E5"> it's a good</font><font color="#CCCCCC"> feeling to</font>

333
00:13:13,030 --> 00:13:18,339
inspire audience here<font color="#E5E5E5"> all right so I'm</font>

334
00:13:17,140 --> 00:13:21,180
thinking<font color="#CCCCCC"> I'm</font>

335
00:13:18,339 --> 00:13:25,660
might have identified<font color="#E5E5E5"> the dropper that</font>

336
00:13:21,180 --> 00:13:27,819
<font color="#CCCCCC">then copied the SPC host you know what</font>

337
00:13:25,660 --> 00:13:31,569
<font color="#E5E5E5">you don't need privilege escalation</font><font color="#CCCCCC"> -</font>

338
00:13:27,819 --> 00:13:34,389
right then to<font color="#E5E5E5"> the that profile directory</font>

339
00:13:31,569 --> 00:13:36,579
do<font color="#E5E5E5"> you know so I'm thinking this is a</font>

340
00:13:34,389 --> 00:13:37,809
chain effect<font color="#E5E5E5"> and don't don't believe my</font>

341
00:13:36,579 --> 00:13:39,339
<font color="#CCCCCC">MFG records because maybe you're a</font>

342
00:13:37,809 --> 00:13:41,649
doubter<font color="#CCCCCC"> over the file system because</font><font color="#E5E5E5"> of</font>

343
00:13:39,339 --> 00:13:43,149
like time stomping<font color="#E5E5E5"> and all so maybe</font><font color="#CCCCCC"> you</font>

344
00:13:41,649 --> 00:13:46,360
switch back<font color="#CCCCCC"> and you want to do more</font>

345
00:13:43,149 --> 00:13:48,220
evidence<font color="#E5E5E5"> of execution well shout out to</font>

346
00:13:46,360 --> 00:13:51,009
the<font color="#CCCCCC"> fireEye team that developed the</font><font color="#E5E5E5"> shim</font>

347
00:13:48,220 --> 00:13:53,259
cache Memphian<font color="#E5E5E5"> and volatility</font><font color="#CCCCCC"> it is</font>

348
00:13:51,009 --> 00:13:55,209
amazing<font color="#E5E5E5"> you can actually go into your</font>

349
00:13:53,259 --> 00:13:57,009
memory image<font color="#E5E5E5"> and pull things that have</font>

350
00:13:55,209 --> 00:13:59,469
yet to<font color="#E5E5E5"> be written to</font><font color="#CCCCCC"> the registry</font>

351
00:13:57,009 --> 00:14:02,559
you know shim cache it's all about

352
00:13:59,470 --> 00:14:03,999
application compatibility<font color="#E5E5E5"> and I know</font>

353
00:14:02,559 --> 00:14:05,439
that has very little<font color="#E5E5E5"> to do with</font>

354
00:14:03,999 --> 00:14:08,170
forensics is up the fact<font color="#CCCCCC"> that it leaves</font>

355
00:14:05,439 --> 00:14:09,639
behind artifacts<font color="#CCCCCC"> okay it depends on</font>

356
00:14:08,170 --> 00:14:11,680
which realm you're working in<font color="#E5E5E5"> but join</font>

357
00:14:09,639 --> 00:14:13,990
me and<font color="#E5E5E5"> looking at shim cache mem</font>

358
00:14:11,680 --> 00:14:15,309
which are things<font color="#E5E5E5"> that are hanging</font><font color="#CCCCCC"> out in</font>

359
00:14:13,990 --> 00:14:17,259
a buffer somewhere in<font color="#CCCCCC"> memory that</font><font color="#E5E5E5"> we're</font>

360
00:14:15,309 --> 00:14:19,569
<font color="#E5E5E5">pulling out now this is evidence of</font>

361
00:14:17,259 --> 00:14:21,699
execution<font color="#E5E5E5"> don't get too excited about</font>

362
00:14:19,569 --> 00:14:24,579
those time and date stamps<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you see</font>

363
00:14:21,699 --> 00:14:27,459
there<font color="#E5E5E5"> they're actually</font><font color="#CCCCCC"> the last</font><font color="#E5E5E5"> modified</font>

364
00:14:24,579 --> 00:14:29,199
time<font color="#E5E5E5"> associated</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> the MFT record of</font>

365
00:14:27,459 --> 00:14:32,920
said evil but do you see what<font color="#CCCCCC"> I'm seeing</font>

366
00:14:29,199 --> 00:14:34,359
I see the SVC host now the<font color="#CCCCCC"> SPCA list is</font>

367
00:14:32,920 --> 00:14:36,160
up there and<font color="#E5E5E5"> let me blow this up so you</font>

368
00:14:34,360 --> 00:14:36,910
<font color="#E5E5E5">can see it to fully</font><font color="#CCCCCC"> appreciate what</font><font color="#E5E5E5"> we</font>

369
00:14:36,160 --> 00:14:39,279
got going on<font color="#CCCCCC"> here</font>

370
00:14:36,910 --> 00:14:41,589
I got<font color="#CCCCCC"> SPCA host which is a higher rank</font>

371
00:14:39,279 --> 00:14:43,389
<font color="#E5E5E5">so the things that</font><font color="#CCCCCC"> are the very</font><font color="#E5E5E5"> top</font><font color="#CCCCCC"> of</font>

372
00:14:41,589 --> 00:14:45,699
<font color="#CCCCCC">your</font><font color="#E5E5E5"> shim</font><font color="#CCCCCC"> cache mem are the things</font><font color="#E5E5E5"> that</font>

373
00:14:43,389 --> 00:14:46,779
have<font color="#E5E5E5"> run most recently it's beautiful</font>

374
00:14:45,699 --> 00:14:49,748
this<font color="#CCCCCC"> this plugin</font>

375
00:14:46,779 --> 00:14:51,670
what<font color="#CCCCCC"> did Fred do it's</font><font color="#E5E5E5"> amazing so the</font>

376
00:14:49,749 --> 00:14:54,189
very top is going to<font color="#CCCCCC"> be like</font><font color="#E5E5E5"> rank</font><font color="#CCCCCC"> one or</font>

377
00:14:51,670 --> 00:14:55,540
<font color="#E5E5E5">one most recently</font><font color="#CCCCCC"> run you come down a</font>

378
00:14:54,189 --> 00:14:57,998
little bit further<font color="#E5E5E5"> now we got a</font>

379
00:14:55,540 --> 00:15:00,189
historical walk back of evidence of

380
00:14:57,999 --> 00:15:03,360
execution<font color="#E5E5E5"> this is perfect for us</font>

381
00:15:00,189 --> 00:15:05,439
<font color="#CCCCCC">take a look prior to the svchost.exe</font>

382
00:15:03,360 --> 00:15:08,730
<font color="#E5E5E5">running from the Google directory we</font>

383
00:15:05,439 --> 00:15:11,949
<font color="#CCCCCC">have that strange loyalty card dot exe</font>

384
00:15:08,730 --> 00:15:14,800
<font color="#CCCCCC">lame</font><font color="#E5E5E5"> all right so we probably have</font>

385
00:15:11,949 --> 00:15:16,660
<font color="#E5E5E5">enough to go off</font><font color="#CCCCCC"> of from here</font><font color="#E5E5E5"> to things</font>

386
00:15:14,800 --> 00:15:18,939
that<font color="#CCCCCC"> we could go about</font><font color="#E5E5E5"> extracting</font><font color="#CCCCCC"> if lil</font>

387
00:15:16,660 --> 00:15:21,279
<font color="#CCCCCC">T</font><font color="#E5E5E5"> card</font><font color="#CCCCCC"> exe is</font><font color="#E5E5E5"> still memory mapped you</font>

388
00:15:18,939 --> 00:15:22,779
know you want a copy<font color="#E5E5E5"> of</font><font color="#CCCCCC"> that you might</font>

389
00:15:21,279 --> 00:15:24,699
be<font color="#E5E5E5"> able to find on the file system</font><font color="#CCCCCC"> so</font>

390
00:15:22,779 --> 00:15:26,589
I'm<font color="#E5E5E5"> not</font><font color="#CCCCCC"> pooping file system forensics</font>

391
00:15:24,699 --> 00:15:28,179
but you know I have a memory<font color="#E5E5E5"> image here</font>

392
00:15:26,589 --> 00:15:29,170
in front of<font color="#CCCCCC"> me let me use it to the</font>

393
00:15:28,179 --> 00:15:31,059
fullest<font color="#CCCCCC"> extent</font>

394
00:15:29,170 --> 00:15:32,300
so I'd pull these<font color="#E5E5E5"> things out I think I</font>

395
00:15:31,059 --> 00:15:35,000
actually pulled out the<font color="#CCCCCC"> SVC</font>

396
00:15:32,300 --> 00:15:37,609
and<font color="#CCCCCC"> ran strings against it because</font><font color="#E5E5E5"> well</font>

397
00:15:35,000 --> 00:15:40,250
you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> that's a solid technique to</font>

398
00:15:37,610 --> 00:15:41,390
static analysis man<font color="#E5E5E5"> so these are the</font>

399
00:15:40,250 --> 00:15:43,100
strings I was able<font color="#E5E5E5"> to pull</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> that I</font>

400
00:15:41,390 --> 00:15:47,810
found interesting kind of<font color="#E5E5E5"> speaking to</font>

401
00:15:43,100 --> 00:15:50,959
<font color="#CCCCCC">you a bot some mutex ah and</font><font color="#E5E5E5"> in summary</font><font color="#CCCCCC"> I</font>

402
00:15:47,810 --> 00:15:52,550
<font color="#E5E5E5">think you guys help</font><font color="#CCCCCC"> me I mean</font><font color="#E5E5E5"> you listen</font>

403
00:15:50,959 --> 00:15:54,170
next<font color="#E5E5E5"> time you'll participate more right</font>

404
00:15:52,550 --> 00:15:54,709
<font color="#E5E5E5">do you feel comfortable with how this is</font>

405
00:15:54,170 --> 00:16:03,050
<font color="#E5E5E5">gonna</font><font color="#CCCCCC"> go</font>

406
00:15:54,709 --> 00:16:04,160
that was system number<font color="#CCCCCC"> one okay</font><font color="#E5E5E5"> thank</font>

407
00:16:03,050 --> 00:16:07,010
<font color="#E5E5E5">you thank you</font>

408
00:16:04,160 --> 00:16:08,510
the guy who participated actually gets

409
00:16:07,010 --> 00:16:10,930
<font color="#E5E5E5">to celebrate with me it's fine it's fine</font>

410
00:16:08,510 --> 00:16:13,250
<font color="#CCCCCC">so let's talk about system number two</font>

411
00:16:10,930 --> 00:16:15,529
system number<font color="#E5E5E5"> two it's a little bit more</font>

412
00:16:13,250 --> 00:16:17,779
sophisticated<font color="#CCCCCC"> now I can't say that many</font>

413
00:16:15,529 --> 00:16:19,670
Incident Response Teams<font color="#E5E5E5"> have that</font>

414
00:16:17,779 --> 00:16:23,000
opportunity to<font color="#CCCCCC"> put on their proactive</font>

415
00:16:19,670 --> 00:16:24,649
hunting hats<font color="#CCCCCC"> come on man we're working</font>

416
00:16:23,000 --> 00:16:27,470
hard these days<font color="#E5E5E5"> and it's very hard to</font>

417
00:16:24,649 --> 00:16:29,240
<font color="#CCCCCC">convince</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> top-level</font><font color="#E5E5E5"> execs that we</font>

418
00:16:27,470 --> 00:16:31,310
need to grow our<font color="#CCCCCC"> team and expand because</font>

419
00:16:29,240 --> 00:16:34,820
<font color="#E5E5E5">they asked</font><font color="#CCCCCC"> for metrics you know like</font><font color="#E5E5E5"> ah</font>

420
00:16:31,310 --> 00:16:36,319
what's your time to remediation how many

421
00:16:34,820 --> 00:16:37,250
<font color="#E5E5E5">events are you handling these days and</font>

422
00:16:36,320 --> 00:16:39,560
<font color="#E5E5E5">what are you gonna do when you're not</font>

423
00:16:37,250 --> 00:16:41,810
handling<font color="#E5E5E5"> events and incidents</font><font color="#CCCCCC"> and I get</font>

424
00:16:39,560 --> 00:16:43,310
it I<font color="#CCCCCC"> get it so sometimes we do have the</font>

425
00:16:41,810 --> 00:16:47,000
<font color="#CCCCCC">opportunity to put on our</font><font color="#E5E5E5"> proactive</font>

426
00:16:43,310 --> 00:16:48,979
hunting hats<font color="#CCCCCC"> we have tons</font><font color="#E5E5E5"> and tons of</font>

427
00:16:47,000 --> 00:16:51,020
<font color="#E5E5E5">content out there that tell us what to</font>

428
00:16:48,980 --> 00:16:53,570
look<font color="#E5E5E5"> for but in this case what did I</font>

429
00:16:51,020 --> 00:16:56,750
look for<font color="#E5E5E5"> oh I pulled back some prefetch</font>

430
00:16:53,570 --> 00:16:59,390
files so if you like me I<font color="#CCCCCC"> mean pretty</font>

431
00:16:56,750 --> 00:17:01,610
much<font color="#E5E5E5"> is</font><font color="#CCCCCC"> my favorite favorite evidence of</font>

432
00:16:59,390 --> 00:17:03,170
execution<font color="#E5E5E5"> I know it's not for me it's</font>

433
00:17:01,610 --> 00:17:05,780
<font color="#CCCCCC">not</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> the forensic examiner it's all</font>

434
00:17:03,170 --> 00:17:07,550
about efficiency<font color="#E5E5E5"> right prefetch it's</font>

435
00:17:05,780 --> 00:17:09,230
supposed to<font color="#E5E5E5"> like free load all of</font><font color="#CCCCCC"> the</font>

436
00:17:07,550 --> 00:17:12,169
<font color="#E5E5E5">dependents dependencies for an</font>

437
00:17:09,230 --> 00:17:15,860
executable into<font color="#E5E5E5"> memory and and track</font>

438
00:17:12,170 --> 00:17:17,240
<font color="#E5E5E5">that in a PF file that shows what is the</font>

439
00:17:15,859 --> 00:17:18,708
computer gonna<font color="#CCCCCC"> needs it'll load</font><font color="#E5E5E5"> the next</font>

440
00:17:17,240 --> 00:17:20,959
time that kicks off<font color="#E5E5E5"> right and there's</font>

441
00:17:18,709 --> 00:17:22,730
optimizations but you know forensic

442
00:17:20,959 --> 00:17:26,030
examiners we get really<font color="#E5E5E5"> excited if</font>

443
00:17:22,730 --> 00:17:28,010
there's prefetch am i right<font color="#E5E5E5"> am i</font><font color="#CCCCCC"> oh yeah</font>

444
00:17:26,030 --> 00:17:30,110
I like<font color="#CCCCCC"> to joke that you know if there's</font>

445
00:17:28,010 --> 00:17:33,110
no prefetch<font color="#E5E5E5"> I'll subcontract out of work</font>

446
00:17:30,110 --> 00:17:34,399
<font color="#E5E5E5">outs</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know it's like too hard so this</font>

447
00:17:33,110 --> 00:17:37,159
is what I'm<font color="#E5E5E5"> doing I'm pulling back</font>

448
00:17:34,400 --> 00:17:38,980
<font color="#CCCCCC">across the enterprise all of the</font>

449
00:17:37,160 --> 00:17:41,540
prefetch files<font color="#E5E5E5"> that I'm</font><font color="#CCCCCC"> doing some</font>

450
00:17:38,980 --> 00:17:43,100
stacking some data stacking now you

451
00:17:41,540 --> 00:17:44,280
<font color="#E5E5E5">probably have a method of</font><font color="#CCCCCC"> doing this</font>

452
00:17:43,100 --> 00:17:46,709
right at the

453
00:17:44,280 --> 00:17:48,690
<font color="#E5E5E5">enterprise-level you could be</font><font color="#CCCCCC"> doing it</font>

454
00:17:46,710 --> 00:17:50,790
like just be a<font color="#E5E5E5"> powershell Kansa a good</font>

455
00:17:48,690 --> 00:17:52,980
tool for<font color="#E5E5E5"> data stacking right pull back</font>

456
00:17:50,790 --> 00:17:55,230
all of<font color="#CCCCCC"> your</font><font color="#E5E5E5"> prefetch with Kansa</font><font color="#CCCCCC"> which is</font>

457
00:17:52,980 --> 00:17:58,230
a<font color="#CCCCCC"> powershell framework and you're able</font>

458
00:17:55,230 --> 00:17:59,730
<font color="#CCCCCC">to sort by in</font><font color="#E5E5E5"> this case maybe I've</font>

459
00:17:58,230 --> 00:18:01,890
chosen wrong<font color="#E5E5E5"> because it's order of</font>

460
00:17:59,730 --> 00:18:04,860
frequency<font color="#CCCCCC"> by most frequently occurring</font>

461
00:18:01,890 --> 00:18:10,140
is that notable like<font color="#CCCCCC"> it's an TOS</font><font color="#E5E5E5"> boot</font>

462
00:18:04,860 --> 00:18:12,600
interesting<font color="#E5E5E5"> no not normally</font><font color="#CCCCCC"> and TOS boot</font>

463
00:18:10,140 --> 00:18:14,550
<font color="#CCCCCC">you</font><font color="#E5E5E5"> can certainly</font><font color="#CCCCCC"> set your nevermind</font>

464
00:18:12,600 --> 00:18:16,830
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> let's switch this around and do</font>

465
00:18:14,550 --> 00:18:20,430
lease for frequency of occurrence<font color="#E5E5E5"> and</font>

466
00:18:16,830 --> 00:18:22,560
you know<font color="#CCCCCC"> there's a few up here</font><font color="#E5E5E5"> there's a</font>

467
00:18:20,430 --> 00:18:25,500
few of these that like set up<font color="#E5E5E5"> dot exe</font>

468
00:18:22,560 --> 00:18:27,870
<font color="#E5E5E5">maybe that's okay but I don't know the</font>

469
00:18:25,500 --> 00:18:31,320
things that<font color="#E5E5E5"> make these unique are going</font>

470
00:18:27,870 --> 00:18:32,879
to be<font color="#E5E5E5"> the path the path of the</font>

471
00:18:31,320 --> 00:18:34,770
executable so those pads are gonna be

472
00:18:32,880 --> 00:18:36,450
different for various<font color="#E5E5E5"> reasons</font><font color="#CCCCCC"> but</font>

473
00:18:34,770 --> 00:18:37,590
<font color="#CCCCCC">because this is a hunting</font><font color="#E5E5E5"> technique I</font>

474
00:18:36,450 --> 00:18:39,540
don't need to be<font color="#E5E5E5"> right a hundred</font><font color="#CCCCCC"> percent</font>

475
00:18:37,590 --> 00:18:41,340
<font color="#E5E5E5">of the</font><font color="#CCCCCC"> time this is supposed to give me</font>

476
00:18:39,540 --> 00:18:43,200
<font color="#E5E5E5">something</font><font color="#CCCCCC"> to look at that could</font>

477
00:18:41,340 --> 00:18:45,510
potentially<font color="#CCCCCC"> aligned with attacker</font>

478
00:18:43,200 --> 00:18:47,190
behavior some crazy randomly named

479
00:18:45,510 --> 00:18:49,680
executable<font color="#CCCCCC"> that creates a prefetch file</font>

480
00:18:47,190 --> 00:18:51,900
<font color="#E5E5E5">I want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> look into it and I certainly</font><font color="#CCCCCC"> I</font>

481
00:18:49,680 --> 00:18:53,460
wish to you that you have a team<font color="#CCCCCC"> that</font>

482
00:18:51,900 --> 00:18:56,870
has cycles to do<font color="#E5E5E5"> this type of proactive</font>

483
00:18:53,460 --> 00:18:59,940
hunting so this machine<font color="#E5E5E5"> was identified</font>

484
00:18:56,870 --> 00:19:01,889
using<font color="#CCCCCC"> these techniques</font><font color="#E5E5E5"> we found some</font>

485
00:18:59,940 --> 00:19:03,480
crazy prefetch file that was<font color="#E5E5E5"> only</font>

486
00:19:01,890 --> 00:19:05,520
occurring on that one machine<font color="#E5E5E5"> and we</font>

487
00:19:03,480 --> 00:19:07,080
kicked back and<font color="#E5E5E5"> we looked at it</font><font color="#CCCCCC"> alright</font>

488
00:19:05,520 --> 00:19:09,960
<font color="#E5E5E5">and</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is what we were able</font><font color="#CCCCCC"> to find</font>

489
00:19:07,080 --> 00:19:11,610
holy what's all right all right<font color="#E5E5E5"> right so</font>

490
00:19:09,960 --> 00:19:13,440
maybe this<font color="#E5E5E5"> is for</font><font color="#CCCCCC"> DES quarry because</font><font color="#E5E5E5"> we</font>

491
00:19:11,610 --> 00:19:15,389
don't see des quarry running so

492
00:19:13,440 --> 00:19:17,460
frequently in our environment<font color="#E5E5E5"> I mean</font>

493
00:19:15,390 --> 00:19:19,310
what is<font color="#E5E5E5"> there des</font><font color="#CCCCCC"> what does that</font><font color="#E5E5E5"> stand</font>

494
00:19:17,460 --> 00:19:21,930
for

495
00:19:19,310 --> 00:19:23,220
it's got<font color="#E5E5E5"> if it's if it's associated with</font>

496
00:19:21,930 --> 00:19:25,470
<font color="#CCCCCC">a attacker it's got to be directory</font>

497
00:19:23,220 --> 00:19:28,470
services right directory services so

498
00:19:25,470 --> 00:19:30,360
this is actually<font color="#CCCCCC"> I</font><font color="#E5E5E5"> I know this is the</font>

499
00:19:28,470 --> 00:19:32,660
real world<font color="#E5E5E5"> investigation I worked at</font>

500
00:19:30,360 --> 00:19:32,659
<font color="#CCCCCC">manye</font>

501
00:19:36,900 --> 00:19:39,990
and I was like no way<font color="#CCCCCC"> like 20 times</font>

502
00:19:39,210 --> 00:19:42,330
<font color="#CCCCCC">right</font>

503
00:19:39,990 --> 00:19:46,090
so<font color="#E5E5E5"> I crafted this it's pretty cool</font><font color="#CCCCCC"> and</font>

504
00:19:42,330 --> 00:19:48,849
<font color="#E5E5E5">he actually points</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the attackers</font>

505
00:19:46,090 --> 00:19:50,918
<font color="#E5E5E5">school directory</font><font color="#CCCCCC"> he dropped in program</font>

506
00:19:48,849 --> 00:19:52,869
data which i think is<font color="#E5E5E5"> pretty awesome</font><font color="#CCCCCC"> you</font>

507
00:19:50,919 --> 00:19:55,690
can see all of this because we had what

508
00:19:52,869 --> 00:19:58,529
is that<font color="#CCCCCC"> Frost detail process tracking</font>

509
00:19:55,690 --> 00:20:01,239
you guys know the the event ID for that

510
00:19:58,529 --> 00:20:03,929
<font color="#CCCCCC">446</font><font color="#E5E5E5"> 88 dude oh that wasn't a</font>

511
00:20:01,239 --> 00:20:06,399
presentation<font color="#CCCCCC"> earlier today 46 88 I</font>

512
00:20:03,929 --> 00:20:09,070
remember I remember<font color="#E5E5E5"> something</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right</font>

513
00:20:06,399 --> 00:20:10,928
46 88 so detail process tracking was how

514
00:20:09,070 --> 00:20:13,539
I<font color="#E5E5E5"> was able to figure</font><font color="#CCCCCC"> all this out</font><font color="#E5E5E5"> but it</font>

515
00:20:10,929 --> 00:20:15,669
all started<font color="#E5E5E5"> from her strange prefetch</font>

516
00:20:13,539 --> 00:20:17,649
file I know you're thinking<font color="#E5E5E5"> I could</font>

517
00:20:15,669 --> 00:20:19,119
totally do this<font color="#E5E5E5"> better I would have I</font>

518
00:20:17,649 --> 00:20:21,580
would<font color="#E5E5E5"> have had an alert for</font><font color="#CCCCCC"> Deus quarry</font>

519
00:20:19,119 --> 00:20:22,988
or<font color="#CCCCCC"> D s ask</font><font color="#E5E5E5"> or some strangeness</font><font color="#CCCCCC"> run</font>

520
00:20:21,580 --> 00:20:25,299
<font color="#E5E5E5">anything running from the program</font>

521
00:20:22,989 --> 00:20:26,619
directory maybe I don't<font color="#E5E5E5"> know yeah you</font>

522
00:20:25,299 --> 00:20:28,599
would have<font color="#CCCCCC"> gone there</font><font color="#E5E5E5"> I like</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> convince</font>

523
00:20:26,619 --> 00:20:29,978
<font color="#E5E5E5">my students that you would have gotten</font>

524
00:20:28,599 --> 00:20:32,229
there may be<font color="#CCCCCC"> using a different technique</font>

525
00:20:29,979 --> 00:20:34,479
but you<font color="#E5E5E5"> would have found said evil so</font>

526
00:20:32,229 --> 00:20:37,239
this guy was<font color="#CCCCCC"> clearly interacting with</font>

527
00:20:34,479 --> 00:20:38,739
Active Directory<font color="#E5E5E5"> creating accounts</font>

528
00:20:37,239 --> 00:20:40,719
initially trying to figure<font color="#CCCCCC"> out group</font>

529
00:20:38,739 --> 00:20:42,399
membership and the story continues<font color="#CCCCCC"> from</font>

530
00:20:40,719 --> 00:20:44,139
there<font color="#CCCCCC"> this spun up into a</font><font color="#E5E5E5"> full-fledged</font>

531
00:20:42,399 --> 00:20:47,439
<font color="#E5E5E5">investigation</font><font color="#CCCCCC"> there was</font><font color="#E5E5E5"> multiple</font>

532
00:20:44,139 --> 00:20:52,119
machines<font color="#CCCCCC"> it's a good one</font><font color="#E5E5E5"> proper scoping</font>

533
00:20:47,440 --> 00:20:53,349
<font color="#E5E5E5">proper scoping how did you do did you</font>

534
00:20:52,119 --> 00:20:55,209
<font color="#E5E5E5">feel good about</font><font color="#CCCCCC"> that one were you</font>

535
00:20:53,349 --> 00:20:56,468
tracking like I want<font color="#E5E5E5"> to do some</font><font color="#CCCCCC"> free</font>

536
00:20:55,210 --> 00:20:59,729
fetch stacking<font color="#E5E5E5"> all right all right</font>

537
00:20:56,469 --> 00:21:02,710
<font color="#CCCCCC">that's cool</font><font color="#E5E5E5"> number three is another</font>

538
00:20:59,729 --> 00:21:05,349
proactive technique it's a<font color="#E5E5E5"> hunting</font>

539
00:21:02,710 --> 00:21:07,899
method where you're looking<font color="#E5E5E5"> for services</font>

540
00:21:05,349 --> 00:21:09,218
<font color="#E5E5E5">that are terminated tournament services</font>

541
00:21:07,899 --> 00:21:11,049
that are stopped<font color="#E5E5E5"> that are really</font>

542
00:21:09,219 --> 00:21:13,570
designed<font color="#CCCCCC"> to</font><font color="#E5E5E5"> protect your</font><font color="#CCCCCC"> environment</font>

543
00:21:11,049 --> 00:21:15,759
isn't<font color="#E5E5E5"> it unusual to find systems with no</font>

544
00:21:13,570 --> 00:21:18,279
antivirus running so a little<font color="#CCCCCC"> shout-out</font>

545
00:21:15,759 --> 00:21:19,779
to<font color="#CCCCCC"> one of my favorite tools tain iam</font>

546
00:21:18,279 --> 00:21:23,589
<font color="#E5E5E5">it's a good tool is it good to anyone</font>

547
00:21:19,779 --> 00:21:26,259
anyone<font color="#E5E5E5"> know I'm certain about it it's</font>

548
00:21:23,589 --> 00:21:28,119
you can't control it<font color="#CCCCCC"> hello it's</font><font color="#E5E5E5"> like a</font>

549
00:21:26,259 --> 00:21:30,639
race car<font color="#CCCCCC"> you need</font><font color="#E5E5E5"> somebody you need some</font>

550
00:21:28,119 --> 00:21:31,959
special<font color="#CCCCCC"> training</font><font color="#E5E5E5"> on a man you might wrap</font>

551
00:21:30,639 --> 00:21:33,879
it around telephone pole if you don't

552
00:21:31,960 --> 00:21:35,710
you<font color="#CCCCCC"> don't get</font><font color="#E5E5E5"> behind it</font><font color="#CCCCCC"> rain so I'm</font>

553
00:21:33,879 --> 00:21:38,439
saying the<font color="#CCCCCC"> obtaining it was good today</font>

554
00:21:35,710 --> 00:21:40,179
<font color="#E5E5E5">was good but I'm</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> pulling back here</font>

555
00:21:38,440 --> 00:21:42,159
and I gotta give<font color="#CCCCCC"> credit where credit's</font>

556
00:21:40,179 --> 00:21:43,779
due this<font color="#E5E5E5"> is my forensics team</font><font color="#CCCCCC"> now myosin</font>

557
00:21:42,159 --> 00:21:46,659
response team that crafted this<font color="#CCCCCC"> quarry</font>

558
00:21:43,779 --> 00:21:49,479
the quarry was to pull back<font color="#E5E5E5"> collection</font>

559
00:21:46,659 --> 00:21:51,729
of hosts every<font color="#E5E5E5"> host that had the clients</font>

560
00:21:49,479 --> 00:21:53,710
running<font color="#E5E5E5"> on it like ask the question</font><font color="#CCCCCC"> okay</font>

561
00:21:51,729 --> 00:21:56,019
<font color="#CCCCCC">are you running the end start what does</font>

562
00:21:53,710 --> 00:22:00,180
<font color="#CCCCCC">then start why does that relate to</font>

563
00:21:56,019 --> 00:22:02,260
forensics teams and start 64<font color="#E5E5E5"> DXE</font>

564
00:22:00,180 --> 00:22:04,750
they don't come around<font color="#E5E5E5"> to here do they</font>

565
00:22:02,260 --> 00:22:06,760
forensics<font color="#CCCCCC"> people and in case in</font><font color="#E5E5E5"> case</font>

566
00:22:04,750 --> 00:22:09,070
yeah yeah so they were wondering which

567
00:22:06,760 --> 00:22:10,720
machines were not<font color="#CCCCCC"> running in case</font><font color="#E5E5E5"> but</font>

568
00:22:09,070 --> 00:22:12,669
they also asked a question which

569
00:22:10,720 --> 00:22:14,470
<font color="#E5E5E5">machines are not running whatever</font><font color="#CCCCCC"> our</font>

570
00:22:12,670 --> 00:22:18,100
antivirus was do I do a big reveal<font color="#E5E5E5"> oh</font>

571
00:22:14,470 --> 00:22:20,380
the sub client<font color="#CCCCCC"> ha so some kind</font><font color="#E5E5E5"> of solid</font>

572
00:22:18,100 --> 00:22:22,389
<font color="#E5E5E5">man I saw it but there were some</font>

573
00:22:20,380 --> 00:22:25,480
machines that had that disabled so are

574
00:22:22,390 --> 00:22:26,770
you concerned are you<font color="#E5E5E5"> concerned that</font>

575
00:22:25,480 --> 00:22:28,570
there's some machines in<font color="#E5E5E5"> your vibe you</font>

576
00:22:26,770 --> 00:22:30,070
can probably think<font color="#CCCCCC"> of a few that are not</font>

577
00:22:28,570 --> 00:22:32,230
<font color="#E5E5E5">running your antivirus am i right</font>

578
00:22:30,070 --> 00:22:34,000
and maybe they<font color="#E5E5E5"> they are the ones that</font>

579
00:22:32,230 --> 00:22:35,710
qualified for<font color="#E5E5E5"> some exception because</font>

580
00:22:34,000 --> 00:22:38,110
<font color="#E5E5E5">they're in the you know the</font>

581
00:22:35,710 --> 00:22:40,600
manufacturing<font color="#CCCCCC"> line and you're afraid of</font>

582
00:22:38,110 --> 00:22:43,240
<font color="#E5E5E5">I'm always operating a crane when I</font>

583
00:22:40,600 --> 00:22:45,520
stalk about industrial plant

584
00:22:43,240 --> 00:22:47,470
environments but yeah maybe<font color="#E5E5E5"> maybe you</font>

585
00:22:45,520 --> 00:22:49,480
have some that you would have<font color="#CCCCCC"> a good</font>

586
00:22:47,470 --> 00:22:52,510
excuse you'd have an exception and some

587
00:22:49,480 --> 00:22:54,130
some mitigating factors that have come

588
00:22:52,510 --> 00:22:56,290
into play<font color="#E5E5E5"> so you don't need antivirus</font>

589
00:22:54,130 --> 00:22:58,120
<font color="#CCCCCC">but you know this is how we identified</font>

590
00:22:56,290 --> 00:23:00,220
one<font color="#CCCCCC"> of these</font><font color="#E5E5E5"> machines is we had extra</font>

591
00:22:58,120 --> 00:23:02,530
cycles<font color="#CCCCCC"> I asked my team go ahead and do</font>

592
00:23:00,220 --> 00:23:04,030
some data<font color="#E5E5E5"> stacking pull back and figure</font>

593
00:23:02,530 --> 00:23:07,030
out which machines<font color="#E5E5E5"> don't have</font><font color="#CCCCCC"> antivirus</font>

594
00:23:04,030 --> 00:23:10,180
currently on and we go from<font color="#CCCCCC"> there</font>

595
00:23:07,030 --> 00:23:11,649
do you agree<font color="#CCCCCC"> with this</font><font color="#E5E5E5"> you're gonna go</font>

596
00:23:10,180 --> 00:23:13,210
back<font color="#E5E5E5"> and</font><font color="#CCCCCC"> do</font><font color="#E5E5E5"> this right now who's who's</font>

597
00:23:11,650 --> 00:23:14,080
like dialing in<font color="#CCCCCC"> I'm VP adding into my</font>

598
00:23:13,210 --> 00:23:16,000
<font color="#CCCCCC">environment right now and I'm using</font>

599
00:23:14,080 --> 00:23:18,070
<font color="#E5E5E5">tinium it will not master me I will</font>

600
00:23:16,000 --> 00:23:20,590
master it<font color="#CCCCCC"> I get it good good good</font>

601
00:23:18,070 --> 00:23:21,909
so I<font color="#CCCCCC"> dump memory</font><font color="#E5E5E5"> from this system</font><font color="#CCCCCC"> and</font>

602
00:23:20,590 --> 00:23:23,530
you know I probably don't<font color="#CCCCCC"> need to</font>

603
00:23:21,910 --> 00:23:26,110
convince<font color="#E5E5E5"> you now why it's compromised</font>

604
00:23:23,530 --> 00:23:30,220
<font color="#CCCCCC">rate do you see the profile</font><font color="#E5E5E5"> from this</font>

605
00:23:26,110 --> 00:23:32,050
volatility analysis<font color="#E5E5E5"> wait what</font><font color="#CCCCCC"> OS is this</font>

606
00:23:30,220 --> 00:23:33,900
system<font color="#E5E5E5"> running</font><font color="#CCCCCC"> oh you're like Windows</font>

607
00:23:32,050 --> 00:23:36,760
what version of<font color="#E5E5E5"> Windows</font>

608
00:23:33,900 --> 00:23:39,130
yeah it's 2003 you can see up there<font color="#E5E5E5"> in</font>

609
00:23:36,760 --> 00:23:40,690
the<font color="#CCCCCC"> gray a 2003 it's service pack it</font>

610
00:23:39,130 --> 00:23:42,400
serves back to you though<font color="#CCCCCC"> oh</font><font color="#E5E5E5"> wait it</font>

611
00:23:40,690 --> 00:23:45,460
serves back<font color="#E5E5E5"> whoa all</font><font color="#CCCCCC"> right all right</font>

612
00:23:42,400 --> 00:23:47,920
<font color="#CCCCCC">enough calm</font><font color="#E5E5E5"> down everyone what do you</font>

613
00:23:45,460 --> 00:23:50,410
see because<font color="#E5E5E5"> I I</font><font color="#CCCCCC"> initially start with</font>

614
00:23:47,920 --> 00:23:53,290
connections and you know you got to

615
00:23:50,410 --> 00:23:55,330
adjust<font color="#E5E5E5"> your volatility push your ninja</font>

616
00:23:53,290 --> 00:23:57,550
<font color="#E5E5E5">skills because it's a different set</font><font color="#CCCCCC"> of</font>

617
00:23:55,330 --> 00:24:00,010
plugins<font color="#CCCCCC"> whether you're looking at XP /</font>

618
00:23:57,550 --> 00:24:02,379
2003<font color="#E5E5E5"> or they look at a Vista</font><font color="#CCCCCC"> and beyond</font>

619
00:24:00,010 --> 00:24:04,660
so<font color="#CCCCCC"> we're gonna go</font><font color="#E5E5E5"> with con scan</font><font color="#CCCCCC"> to gen</font>

620
00:24:02,380 --> 00:24:05,680
up this<font color="#E5E5E5"> are you concerned you're like</font>

621
00:24:04,660 --> 00:24:07,090
<font color="#E5E5E5">this is preposterous</font>

622
00:24:05,680 --> 00:24:08,980
who's feeling like<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a contrived</font>

623
00:24:07,090 --> 00:24:13,080
scenario<font color="#E5E5E5"> but there's no way this could</font>

624
00:24:08,980 --> 00:24:16,289
possibly<font color="#E5E5E5"> be in someone's environment why</font>

625
00:24:13,080 --> 00:24:19,289
we're do that<font color="#CCCCCC"> oh</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> Metasploit users</font>

626
00:24:16,289 --> 00:24:22,320
either<font color="#E5E5E5"> huh</font><font color="#CCCCCC"> I see</font><font color="#E5E5E5"> I see</font><font color="#CCCCCC"> you got four four</font>

627
00:24:19,289 --> 00:24:23,249
four four<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> a lazy</font><font color="#E5E5E5"> pentester come</font>

628
00:24:22,320 --> 00:24:25,739
on

629
00:24:23,249 --> 00:24:27,419
that's the<font color="#E5E5E5"> callback</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> airport</font>

630
00:24:25,739 --> 00:24:29,460
that's why do you<font color="#E5E5E5"> fold it</font><font color="#CCCCCC"> Metasploit</font>

631
00:24:27,419 --> 00:24:31,049
<font color="#CCCCCC">it's true it's true</font><font color="#E5E5E5"> so you're looking at</font>

632
00:24:29,460 --> 00:24:32,879
this list of<font color="#E5E5E5"> connections which would be</font>

633
00:24:31,049 --> 00:24:38,639
<font color="#E5E5E5">equivalent of what you might call</font><font color="#CCCCCC"> the</font>

634
00:24:32,879 --> 00:24:40,139
<font color="#CCCCCC">netstat ano and</font><font color="#E5E5E5"> I see lots of pigs so I</font>

635
00:24:38,639 --> 00:24:42,149
don't really<font color="#E5E5E5"> know the owning processes</font>

636
00:24:40,139 --> 00:24:45,019
<font color="#E5E5E5">but what's concerning to me is those</font>

637
00:24:42,149 --> 00:24:47,580
four four four fours<font color="#CCCCCC"> I got a lot of SMB</font>

638
00:24:45,019 --> 00:24:50,820
<font color="#CCCCCC">maybe that's legit maybe that's normal</font>

639
00:24:47,580 --> 00:24:53,070
maybe it's normal to see<font color="#E5E5E5"> from India to</font>

640
00:24:50,820 --> 00:24:54,239
Pennsylvania<font color="#E5E5E5"> straight across four four</font>

641
00:24:53,070 --> 00:24:55,710
or<font color="#E5E5E5"> five in your environment flat</font>

642
00:24:54,239 --> 00:24:58,919
environments<font color="#E5E5E5"> I mean they're run</font>

643
00:24:55,710 --> 00:25:00,899
efficiently<font color="#E5E5E5"> continue to research because</font>

644
00:24:58,919 --> 00:25:04,289
I am concerned about<font color="#E5E5E5"> what</font><font color="#CCCCCC"> those ports</font>

645
00:25:00,899 --> 00:25:06,928
those pads are<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> awesome</font>

646
00:25:04,289 --> 00:25:07,830
do a little PS scan<font color="#CCCCCC"> why did I</font><font color="#E5E5E5"> choose BS</font>

647
00:25:06,929 --> 00:25:10,169
<font color="#E5E5E5">cam well because it gives</font><font color="#CCCCCC"> me a</font>

648
00:25:07,830 --> 00:25:12,720
historical view<font color="#CCCCCC"> of what ran in the past</font>

649
00:25:10,169 --> 00:25:14,519
<font color="#E5E5E5">a little bit more than PS list would</font>

650
00:25:12,720 --> 00:25:17,369
have<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know now it's</font><font color="#E5E5E5"> just carving for</font>

651
00:25:14,519 --> 00:25:21,809
those<font color="#CCCCCC"> he process blocks and I have a lot</font>

652
00:25:17,369 --> 00:25:23,309
<font color="#CCCCCC">of run DLL 32cm nice I just have a</font>

653
00:25:21,809 --> 00:25:26,609
behavioral indicator of compromise that

654
00:25:23,309 --> 00:25:28,859
<font color="#E5E5E5">scan for all the CMT's</font><font color="#CCCCCC"> it was exhausting</font>

655
00:25:26,609 --> 00:25:30,779
to go through but I mean<font color="#CCCCCC"> is putting on</font>

656
00:25:28,859 --> 00:25:32,970
your<font color="#E5E5E5"> pro hunting we're proactive hunting</font>

657
00:25:30,779 --> 00:25:36,509
hat and maybe that<font color="#E5E5E5"> would be</font><font color="#CCCCCC"> a fruitful</font>

658
00:25:32,970 --> 00:25:38,129
<font color="#E5E5E5">what else is is curious about this net</font>

659
00:25:36,509 --> 00:25:41,669
<font color="#E5E5E5">cats</font><font color="#CCCCCC"> all the way down there at the</font>

660
00:25:38,129 --> 00:25:43,859
<font color="#E5E5E5">bottom</font><font color="#CCCCCC"> if you see and see</font><font color="#E5E5E5"> exe and it had</font>

661
00:25:41,669 --> 00:25:46,799
a pit of 1308 so let's see if it owns

662
00:25:43,859 --> 00:25:49,499
any of the ports<font color="#CCCCCC"> no it doesn't own any</font>

663
00:25:46,799 --> 00:25:52,049
<font color="#E5E5E5">of the ports but certainly some</font><font color="#CCCCCC"> of these</font>

664
00:25:49,499 --> 00:25:55,859
some of these connections<font color="#E5E5E5"> are owned by</font>

665
00:25:52,049 --> 00:25:57,509
<font color="#CCCCCC">run G</font><font color="#E5E5E5"> low 32</font><font color="#CCCCCC"> XE</font><font color="#E5E5E5"> so I think what we</font><font color="#CCCCCC"> just</font>

666
00:25:55,859 --> 00:25:59,730
did was<font color="#CCCCCC"> increase the scope of our</font>

667
00:25:57,509 --> 00:26:01,169
investigation<font color="#CCCCCC"> we just added some more</font>

668
00:25:59,730 --> 00:26:02,730
machines that are<font color="#E5E5E5"> internal to this</font>

669
00:26:01,169 --> 00:26:03,960
<font color="#E5E5E5">environment</font><font color="#CCCCCC"> that are involved</font><font color="#E5E5E5"> in the</font>

670
00:26:02,730 --> 00:26:06,029
<font color="#CCCCCC">compromised we don't know what's going</font>

671
00:26:03,960 --> 00:26:08,759
<font color="#E5E5E5">on but</font><font color="#CCCCCC"> we know it's</font><font color="#E5E5E5"> not just this system</font>

672
00:26:06,029 --> 00:26:11,220
would you say<font color="#E5E5E5"> I mean who's working for</font>

673
00:26:08,759 --> 00:26:13,559
billable hours<font color="#E5E5E5"> you know did you</font><font color="#CCCCCC"> see what</font>

674
00:26:11,220 --> 00:26:16,559
we<font color="#CCCCCC"> just did there we took one system</font><font color="#E5E5E5"> and</font>

675
00:26:13,559 --> 00:26:21,240
now we're like<font color="#E5E5E5"> oh I need a let's go back</font>

676
00:26:16,559 --> 00:26:22,769
I need 10.10 not 75<font color="#CCCCCC"> one one one I need a</font>

677
00:26:21,240 --> 00:26:24,450
<font color="#E5E5E5">memory dump from I need</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> memory dump</font>

678
00:26:22,769 --> 00:26:25,889
<font color="#E5E5E5">from</font><font color="#CCCCCC"> and on and</font><font color="#E5E5E5"> on and on because you're</font>

679
00:26:24,450 --> 00:26:26,880
very<font color="#E5E5E5"> concerned what's happening with</font>

680
00:26:25,889 --> 00:26:28,550
these<font color="#E5E5E5"> systems</font>

681
00:26:26,880 --> 00:26:30,270
why are they<font color="#E5E5E5"> making inbound connections</font>

682
00:26:28,550 --> 00:26:35,070
<font color="#CCCCCC">potentially I guess we</font><font color="#E5E5E5"> could figure that</font>

683
00:26:30,270 --> 00:26:37,110
<font color="#E5E5E5">one out hmm all right maybe a little bit</font>

684
00:26:35,070 --> 00:26:38,760
more memory<font color="#E5E5E5"> Alice's would ensue you'd</font>

685
00:26:37,110 --> 00:26:40,199
want<font color="#CCCCCC"> to figure</font><font color="#E5E5E5"> out what's going on</font><font color="#CCCCCC"> in</font>

686
00:26:38,760 --> 00:26:41,400
the context of<font color="#E5E5E5"> these run</font><font color="#CCCCCC"> diello thirty</font>

687
00:26:40,200 --> 00:26:44,520
twos one of the questions<font color="#E5E5E5"> you might ask</font>

688
00:26:41,400 --> 00:26:46,970
<font color="#CCCCCC">yourself is is there code injection</font><font color="#E5E5E5"> and</font>

689
00:26:44,520 --> 00:26:49,980
of course we find that<font color="#CCCCCC"> mouths mind</font>

690
00:26:46,970 --> 00:26:53,160
<font color="#E5E5E5">delivers yet again mal</font><font color="#CCCCCC"> pond identifies</font>

691
00:26:49,980 --> 00:26:55,140
in the context<font color="#E5E5E5"> of one run</font><font color="#CCCCCC"> TL o 32 a ton</font>

692
00:26:53,160 --> 00:26:57,570
of memory ranges that<font color="#E5E5E5"> are showing signs</font>

693
00:26:55,140 --> 00:26:59,580
of well they're marked<font color="#E5E5E5"> is execute no</font>

694
00:26:57,570 --> 00:27:01,379
path the<font color="#E5E5E5"> disk and they're not all no</font>

695
00:26:59,580 --> 00:27:03,330
<font color="#CCCCCC">bites so we have</font><font color="#E5E5E5"> something that</font><font color="#CCCCCC"> we need</font>

696
00:27:01,380 --> 00:27:04,620
<font color="#CCCCCC">to look into</font><font color="#E5E5E5"> you I run strings against</font>

697
00:27:03,330 --> 00:27:07,889
one of<font color="#E5E5E5"> these memory ranges and it comes</font>

698
00:27:04,620 --> 00:27:10,229
<font color="#E5E5E5">back with meterpreter boom all right</font>

699
00:27:07,890 --> 00:27:12,740
done<font color="#CCCCCC"> done good job good job</font><font color="#E5E5E5"> by the</font><font color="#CCCCCC"> way</font>

700
00:27:10,230 --> 00:27:15,150
<font color="#E5E5E5">do you feel like is this satisfying</font>

701
00:27:12,740 --> 00:27:18,960
satisfied yes<font color="#E5E5E5"> all right</font>

702
00:27:15,150 --> 00:27:20,760
so system number<font color="#CCCCCC"> four this</font><font color="#E5E5E5"> happens</font><font color="#CCCCCC"> too</font>

703
00:27:18,960 --> 00:27:22,140
but it really<font color="#E5E5E5"> depends</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the</font>

704
00:27:20,760 --> 00:27:23,760
relationship<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> have with your</font>

705
00:27:22,140 --> 00:27:26,130
users whether they're going<font color="#E5E5E5"> to call and</font>

706
00:27:23,760 --> 00:27:30,270
complain<font color="#E5E5E5"> like do my machine is running</font>

707
00:27:26,130 --> 00:27:32,400
<font color="#E5E5E5">slow just be aware that by the time they</font>

708
00:27:30,270 --> 00:27:34,740
call you they've attempted to clean up

709
00:27:32,400 --> 00:27:37,290
right<font color="#E5E5E5"> like oh it was probably that</font><font color="#CCCCCC"> uh</font>

710
00:27:34,740 --> 00:27:40,170
that<font color="#E5E5E5"> productivity lost website that I</font>

711
00:27:37,290 --> 00:27:42,090
was visiting him I don't<font color="#CCCCCC"> know I probably</font>

712
00:27:40,170 --> 00:27:44,130
<font color="#E5E5E5">need to remove</font><font color="#CCCCCC"> some of these programs</font>

713
00:27:42,090 --> 00:27:46,530
<font color="#E5E5E5">that I've installed</font><font color="#CCCCCC"> that might have have</font>

714
00:27:44,130 --> 00:27:48,480
back doors<font color="#CCCCCC"> so you know just</font><font color="#E5E5E5"> realize</font><font color="#CCCCCC"> that</font>

715
00:27:46,530 --> 00:27:50,399
if we're informed by the user<font color="#E5E5E5"> that their</font>

716
00:27:48,480 --> 00:27:53,090
machine is running<font color="#E5E5E5"> slow it's probably</font>

717
00:27:50,400 --> 00:27:55,560
made it through a<font color="#E5E5E5"> couple of layers of</font>

718
00:27:53,090 --> 00:27:57,600
sanitizing<font color="#E5E5E5"> I don't know let's see let's</font>

719
00:27:55,560 --> 00:27:59,040
see so that's<font color="#E5E5E5"> how we're</font><font color="#CCCCCC"> able to</font><font color="#E5E5E5"> find out</font>

720
00:27:57,600 --> 00:28:02,100
<font color="#E5E5E5">about this one we reach across the wire</font>

721
00:27:59,040 --> 00:28:04,080
we pull<font color="#CCCCCC"> back a</font><font color="#E5E5E5"> memory dump and this</font>

722
00:28:02,100 --> 00:28:06,270
looks pretty legit<font color="#E5E5E5"> anyone anyone want to</font>

723
00:28:04,080 --> 00:28:10,889
guess what type<font color="#E5E5E5"> of system is</font><font color="#CCCCCC"> is this is</font>

724
00:28:06,270 --> 00:28:12,570
system number four dude<font color="#CCCCCC"> oh oh is it</font>

725
00:28:10,890 --> 00:28:14,910
<font color="#E5E5E5">because</font><font color="#CCCCCC"> the profile is up there is that</font>

726
00:28:12,570 --> 00:28:17,070
<font color="#CCCCCC">is that</font><font color="#E5E5E5"> why I was so excited because you</font>

727
00:28:14,910 --> 00:28:18,870
can<font color="#E5E5E5"> kind of there's a telltale sign to</font>

728
00:28:17,070 --> 00:28:21,090
you in the process<font color="#E5E5E5"> list then</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> talked</font>

729
00:28:18,870 --> 00:28:21,449
<font color="#CCCCCC">about in class</font><font color="#E5E5E5"> and I like</font><font color="#CCCCCC"> I swell with</font>

730
00:28:21,090 --> 00:28:23,399
pride

731
00:28:21,450 --> 00:28:25,710
every time my<font color="#E5E5E5"> students are like wow I</font>

732
00:28:23,400 --> 00:28:26,940
see that task task<font color="#CCCCCC"> oh study X</font><font color="#E5E5E5"> two years</font>

733
00:28:25,710 --> 00:28:29,310
there that's obviously a<font color="#E5E5E5"> Windows 7</font>

734
00:28:26,940 --> 00:28:30,690
<font color="#CCCCCC">machine I was</font><font color="#E5E5E5"> like hell yeah you could</font>

735
00:28:29,310 --> 00:28:31,919
get pretty<font color="#E5E5E5"> good at this just by looking</font>

736
00:28:30,690 --> 00:28:35,670
at a process listen being<font color="#E5E5E5"> like dude</font>

737
00:28:31,920 --> 00:28:37,670
that's<font color="#E5E5E5"> the latest Windows 10 17</font><font color="#CCCCCC"> 134</font>

738
00:28:35,670 --> 00:28:40,169
because it has a registry process boom

739
00:28:37,670 --> 00:28:43,889
<font color="#E5E5E5">good stuff good stuff so I</font><font color="#CCCCCC"> could</font>

740
00:28:40,169 --> 00:28:46,139
<font color="#CCCCCC">I don't see anything too suspicious what</font>

741
00:28:43,889 --> 00:28:47,309
tells me<font color="#E5E5E5"> that someone's logged in do you</font>

742
00:28:46,139 --> 00:28:51,959
see a<font color="#E5E5E5"> process that might be indicative</font>

743
00:28:47,309 --> 00:28:57,269
of<font color="#E5E5E5"> someone logging in this is amazing</font>

744
00:28:51,960 --> 00:29:00,359
<font color="#CCCCCC">yeah you see it huh</font><font color="#E5E5E5"> oh it's up there</font>

745
00:28:57,269 --> 00:29:02,369
<font color="#E5E5E5">it's up there</font><font color="#CCCCCC"> explore that exe nice</font>

746
00:29:00,359 --> 00:29:03,809
<font color="#E5E5E5">explore yeah you don't</font><font color="#CCCCCC"> have that</font>

747
00:29:02,369 --> 00:29:06,449
telltale sign<font color="#CCCCCC"> of like session</font>

748
00:29:03,809 --> 00:29:08,399
<font color="#E5E5E5">enumeration that started like as a Vista</font>

749
00:29:06,450 --> 00:29:10,080
<font color="#E5E5E5">so we're kind of left hanging a little</font>

750
00:29:08,399 --> 00:29:11,459
<font color="#CCCCCC">bit on this one but you know I don't</font>

751
00:29:10,080 --> 00:29:13,080
<font color="#CCCCCC">really see anything</font><font color="#E5E5E5"> the process list</font>

752
00:29:11,460 --> 00:29:14,970
<font color="#E5E5E5">let's go ahead and look at network</font>

753
00:29:13,080 --> 00:29:19,139
connections<font color="#CCCCCC"> is there anything strange</font>

754
00:29:14,970 --> 00:29:20,369
here now I don't pull out<font color="#E5E5E5"> your domain</font>

755
00:29:19,139 --> 00:29:22,439
tools and<font color="#E5E5E5"> start</font><font color="#CCCCCC"> looking to buy P</font>

756
00:29:20,369 --> 00:29:23,249
addresses<font color="#E5E5E5"> and I know that's not</font>

757
00:29:22,440 --> 00:29:25,470
necessary

758
00:29:23,249 --> 00:29:29,119
what<font color="#E5E5E5"> do you recognize any of the pigs</font>

759
00:29:25,470 --> 00:29:29,119
<font color="#CCCCCC">there over in</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> right hand</font><font color="#E5E5E5"> column</font><font color="#CCCCCC"> I</font>

760
00:29:29,570 --> 00:29:33,210
know they all<font color="#CCCCCC"> have to</font><font color="#E5E5E5"> be divisible by</font>

761
00:29:31,679 --> 00:29:37,590
<font color="#CCCCCC">four</font><font color="#E5E5E5"> that's just one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the things for</font>

762
00:29:33,210 --> 00:29:40,649
<font color="#E5E5E5">Windows but paid for what is this pit</font>

763
00:29:37,590 --> 00:29:42,600
for<font color="#E5E5E5"> the system process</font><font color="#CCCCCC"> should it be</font>

764
00:29:40,649 --> 00:29:47,609
communicating outbound on port 80<font color="#E5E5E5"> to</font>

765
00:29:42,600 --> 00:29:49,980
some remote host<font color="#E5E5E5"> like oh my no no no no</font>

766
00:29:47,609 --> 00:29:52,019
unless<font color="#CCCCCC"> you</font><font color="#E5E5E5"> have a really</font><font color="#CCCCCC"> good reason why</font>

767
00:29:49,980 --> 00:29:54,269
your system process is communicating to

768
00:29:52,019 --> 00:29:55,830
<font color="#CCCCCC">a remote IP address on port 80</font><font color="#E5E5E5"> you need</font>

769
00:29:54,269 --> 00:29:57,840
to look into<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you need to look into</font>

770
00:29:55,830 --> 00:30:00,359
<font color="#E5E5E5">that this turns out</font><font color="#CCCCCC"> to be</font><font color="#E5E5E5"> a storm worm</font>

771
00:29:57,840 --> 00:30:02,369
infection<font color="#E5E5E5"> and if you</font><font color="#CCCCCC"> were to pull any</font><font color="#E5E5E5"> of</font>

772
00:30:00,359 --> 00:30:04,408
these IP<font color="#E5E5E5"> addresses they would square you</font>

773
00:30:02,369 --> 00:30:06,330
away<font color="#CCCCCC"> and be</font><font color="#E5E5E5"> like there's a problem there</font>

774
00:30:04,409 --> 00:30:08,009
<font color="#E5E5E5">what I decided to do I know it's a</font>

775
00:30:06,330 --> 00:30:10,499
little<font color="#E5E5E5"> bit advanced it's kind of a break</font>

776
00:30:08,009 --> 00:30:12,480
the glass<font color="#E5E5E5"> technique my co-author that's</font>

777
00:30:10,499 --> 00:30:14,369
Jake Williams<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the memory forensics</font>

778
00:30:12,480 --> 00:30:16,350
class this<font color="#E5E5E5"> is one</font><font color="#CCCCCC"> of his his terms break</font>

779
00:30:14,369 --> 00:30:17,789
the glass<font color="#E5E5E5"> like you would never just jump</font>

780
00:30:16,350 --> 00:30:20,699
in<font color="#E5E5E5"> and be</font><font color="#CCCCCC"> like I feel</font><font color="#E5E5E5"> like doing</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> call</font>

781
00:30:17,789 --> 00:30:22,440
<font color="#E5E5E5">back unless</font><font color="#CCCCCC"> you were hunting in a modern</font>

782
00:30:20,700 --> 00:30:25,109
malware you knew that<font color="#E5E5E5"> you can't hook</font>

783
00:30:22,440 --> 00:30:26,369
<font color="#CCCCCC">anymore to the system call table</font><font color="#E5E5E5"> you</font>

784
00:30:25,109 --> 00:30:28,739
need<font color="#E5E5E5"> to like</font><font color="#CCCCCC"> be a little bit more</font>

785
00:30:26,369 --> 00:30:32,399
creative<font color="#E5E5E5"> so join</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> looking at this</font>

786
00:30:28,739 --> 00:30:34,409
<font color="#CCCCCC">callbacks plugin output from volatility</font>

787
00:30:32,399 --> 00:30:36,479
<font color="#E5E5E5">you can see here I have two callbacks</font>

788
00:30:34,409 --> 00:30:39,059
<font color="#E5E5E5">that were registered by unknown and</font>

789
00:30:36,480 --> 00:30:41,309
that's<font color="#E5E5E5"> probably always bad it's always</font>

790
00:30:39,059 --> 00:30:43,379
bad yeah I need to<font color="#CCCCCC"> figure</font><font color="#E5E5E5"> out what</font>

791
00:30:41,309 --> 00:30:44,820
unknown<font color="#E5E5E5"> is because clearly volatility</font>

792
00:30:43,379 --> 00:30:48,178
<font color="#E5E5E5">was on there was a map it</font><font color="#CCCCCC"> to something</font>

793
00:30:44,820 --> 00:30:51,029
<font color="#CCCCCC">that</font><font color="#E5E5E5"> was in the modules list so are we</font>

794
00:30:48,179 --> 00:30:52,710
good are we good<font color="#CCCCCC"> like this isn't</font>

795
00:30:51,029 --> 00:30:53,610
<font color="#E5E5E5">supposed to be depressing</font><font color="#CCCCCC"> we're knocking</font>

796
00:30:52,710 --> 00:30:55,890
<font color="#CCCCCC">the stuff out man</font>

797
00:30:53,610 --> 00:30:57,780
and do you feel<font color="#E5E5E5"> like maybe I</font><font color="#CCCCCC"> need to pay</font>

798
00:30:55,890 --> 00:30:59,130
you<font color="#E5E5E5"> you know because you've been looking</font>

799
00:30:57,780 --> 00:31:01,260
<font color="#CCCCCC">at so</font><font color="#E5E5E5"> much of my data and you're like</font>

800
00:30:59,130 --> 00:31:02,490
yeah go go<font color="#CCCCCC"> Alyssa that one right there</font>

801
00:31:01,260 --> 00:31:05,190
<font color="#E5E5E5">thank you</font>

802
00:31:02,490 --> 00:31:06,720
is that enough thank you<font color="#CCCCCC"> I'm going to be</font>

803
00:31:05,190 --> 00:31:08,520
turning<font color="#CCCCCC"> in my deliverables after this</font>

804
00:31:06,720 --> 00:31:10,650
<font color="#CCCCCC">presentation and I'll have</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> of your</font>

805
00:31:08,520 --> 00:31:14,340
<font color="#E5E5E5">names on</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> be like</font><font color="#CCCCCC"> uh my work is done</font>

806
00:31:10,650 --> 00:31:16,980
here<font color="#E5E5E5"> so numbers</font><font color="#CCCCCC"> number</font><font color="#E5E5E5"> five system</font>

807
00:31:14,340 --> 00:31:18,870
number five is based on an IOC hit<font color="#E5E5E5"> now</font>

808
00:31:16,980 --> 00:31:20,160
you might not<font color="#E5E5E5"> be believer in iOS</font><font color="#CCCCCC"> C's</font>

809
00:31:18,870 --> 00:31:22,770
much like you weren't believer in

810
00:31:20,160 --> 00:31:24,750
antivirus why<font color="#CCCCCC"> well indicators of</font>

811
00:31:22,770 --> 00:31:27,360
<font color="#CCCCCC">compromised are based on past evil and</font>

812
00:31:24,750 --> 00:31:29,400
my<font color="#CCCCCC"> environment is totally unique and</font><font color="#E5E5E5"> you</font>

813
00:31:27,360 --> 00:31:31,350
know act<font color="#CCCCCC"> ackers are gonna</font><font color="#E5E5E5"> have to try to</font>

814
00:31:29,400 --> 00:31:33,030
get into<font color="#CCCCCC"> my</font><font color="#E5E5E5"> environment so every iOS see</font>

815
00:31:31,350 --> 00:31:36,178
that you've ever seen<font color="#CCCCCC"> before is</font><font color="#E5E5E5"> going to</font>

816
00:31:33,030 --> 00:31:39,510
be null<font color="#E5E5E5"> avoid as I'm looking maybe maybe</font>

817
00:31:36,179 --> 00:31:42,360
I know<font color="#E5E5E5"> IO sees they can be brittle at</font>

818
00:31:39,510 --> 00:31:45,870
times but<font color="#E5E5E5"> this one's pretty behavioral</font>

819
00:31:42,360 --> 00:31:48,510
based this pivots<font color="#E5E5E5"> off of what we</font><font color="#CCCCCC"> learned</font>

820
00:31:45,870 --> 00:31:50,549
<font color="#CCCCCC">from the</font><font color="#E5E5E5"> number one</font><font color="#CCCCCC"> and number</font><font color="#E5E5E5"> two based</font>

821
00:31:48,510 --> 00:31:53,160
on prefetch conversations<font color="#E5E5E5"> what you're</font>

822
00:31:50,549 --> 00:31:55,320
looking at<font color="#CCCCCC"> here is a prefetch file that</font>

823
00:31:53,160 --> 00:31:57,500
points<font color="#CCCCCC"> to an executable that ran from</font><font color="#E5E5E5"> a</font>

824
00:31:55,320 --> 00:32:00,899
<font color="#CCCCCC">user's directory I think it's roaming</font>

825
00:31:57,500 --> 00:32:02,580
yeah just<font color="#CCCCCC"> straight up roaming</font><font color="#E5E5E5"> so that</font>

826
00:32:00,900 --> 00:32:05,549
should always be bad<font color="#E5E5E5"> unless you have</font>

827
00:32:02,580 --> 00:32:07,409
some<font color="#CCCCCC"> other explanation notice the</font>

828
00:32:05,549 --> 00:32:09,780
student has said to me<font color="#E5E5E5"> Alyssa I can say</font>

829
00:32:07,410 --> 00:32:12,120
<font color="#E5E5E5">100 words what</font><font color="#CCCCCC"> could easily</font><font color="#E5E5E5"> be said in</font>

830
00:32:09,780 --> 00:32:13,950
<font color="#CCCCCC">ten</font><font color="#E5E5E5"> and I said thank you they wrote</font><font color="#CCCCCC"> that</font>

831
00:32:12,120 --> 00:32:15,989
on my eval we get evals all the time and

832
00:32:13,950 --> 00:32:17,640
I was<font color="#E5E5E5"> like thank you</font><font color="#CCCCCC"> that means</font><font color="#E5E5E5"> I'm an</font>

833
00:32:15,990 --> 00:32:19,679
excellent forensic examiner because she

834
00:32:17,640 --> 00:32:22,140
should never say there is no malware

835
00:32:19,679 --> 00:32:24,840
<font color="#CCCCCC">should you should you ever say there is</font>

836
00:32:22,140 --> 00:32:27,480
no malware<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> system nah you should</font>

837
00:32:24,840 --> 00:32:31,290
say based on<font color="#CCCCCC"> the time allowed using the</font>

838
00:32:27,480 --> 00:32:33,570
methods employed<font color="#E5E5E5"> blah blah no evidence</font>

839
00:32:31,290 --> 00:32:38,220
of do you agree

840
00:32:33,570 --> 00:32:40,860
<font color="#CCCCCC">no thank you I see you nodding</font><font color="#E5E5E5"> yeah okay</font>

841
00:32:38,220 --> 00:32:42,179
so<font color="#CCCCCC"> 100 words don't don't use the</font><font color="#E5E5E5"> ten so</font>

842
00:32:40,860 --> 00:32:45,030
I will say that this indicator<font color="#E5E5E5"> of</font>

843
00:32:42,179 --> 00:32:46,860
<font color="#E5E5E5">compromise allowed us to identify a</font>

844
00:32:45,030 --> 00:32:48,870
<font color="#E5E5E5">prefetch file that pointed</font><font color="#CCCCCC"> to an</font>

845
00:32:46,860 --> 00:32:50,969
executable<font color="#E5E5E5"> and it was running from the</font>

846
00:32:48,870 --> 00:32:53,040
roaming directory of a<font color="#E5E5E5"> user's profile</font>

847
00:32:50,970 --> 00:32:54,840
and that<font color="#E5E5E5"> I actually get a little bit</font>

848
00:32:53,040 --> 00:32:56,460
sick in my stomach<font color="#CCCCCC"> when I</font><font color="#E5E5E5"> think</font><font color="#CCCCCC"> about</font>

849
00:32:54,840 --> 00:32:58,620
<font color="#E5E5E5">that because that's dirty that's dirty</font>

850
00:32:56,460 --> 00:33:01,169
<font color="#CCCCCC">you shouldn't be</font><font color="#E5E5E5"> running there</font><font color="#CCCCCC"> mm-hmm</font>

851
00:32:58,620 --> 00:33:02,129
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> and I think little IOC definition</font>

852
00:33:01,169 --> 00:33:05,460
for those<font color="#CCCCCC"> either they're not</font><font color="#E5E5E5"> down with</font>

853
00:33:02,130 --> 00:33:07,110
<font color="#E5E5E5">that but a MFT parser why did I decide</font>

854
00:33:05,460 --> 00:33:14,429
<font color="#CCCCCC">to go</font><font color="#E5E5E5"> with that first</font>

855
00:33:07,110 --> 00:33:16,889
ah<font color="#CCCCCC"> because I hit the prefetch file first</font>

856
00:33:14,429 --> 00:33:18,960
<font color="#CCCCCC">and then I parsed the prefetch file and</font>

857
00:33:16,890 --> 00:33:19,950
it pointed<font color="#CCCCCC"> to this executable this is</font>

858
00:33:18,960 --> 00:33:21,779
the one that<font color="#E5E5E5"> was running</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> the</font>

859
00:33:19,950 --> 00:33:23,549
roaming directory<font color="#E5E5E5"> are you are you</font>

860
00:33:21,779 --> 00:33:27,419
feeling<font color="#E5E5E5"> pretty down with this when I and</font>

861
00:33:23,549 --> 00:33:32,279
I is<font color="#E5E5E5"> legit yeah</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> winnin it when</font><font color="#E5E5E5"> I</font>

862
00:33:27,419 --> 00:33:34,019
<font color="#E5E5E5">net when i and i know i</font><font color="#CCCCCC"> am out to</font><font color="#E5E5E5"> see</font>

863
00:33:32,279 --> 00:33:35,940
any not ignore do I see any violent

864
00:33:34,019 --> 00:33:37,289
disagreement<font color="#CCCCCC"> oh my god I don't don't do</font>

865
00:33:35,940 --> 00:33:40,649
<font color="#E5E5E5">it illicit don't do it double</font><font color="#CCCCCC"> click on</font>

866
00:33:37,289 --> 00:33:43,049
that<font color="#E5E5E5"> no so what we're seeing here is an</font>

867
00:33:40,649 --> 00:33:46,620
MFT record<font color="#E5E5E5"> so a master file table record</font>

868
00:33:43,049 --> 00:33:49,590
straight up and it's pointing to or the

869
00:33:46,620 --> 00:33:51,600
metadata<font color="#E5E5E5"> of this task</font><font color="#CCCCCC"> hosted exe and</font>

870
00:33:49,590 --> 00:33:53,070
this is pretty legit mad cuz<font color="#CCCCCC"> task host</font>

871
00:33:51,600 --> 00:33:55,049
is supposed to be<font color="#CCCCCC"> running on a Windows 7</font>

872
00:33:53,070 --> 00:33:57,330
<font color="#E5E5E5">machine</font><font color="#CCCCCC"> so what's another</font><font color="#E5E5E5"> task oh so</font>

873
00:33:55,049 --> 00:33:59,039
<font color="#E5E5E5">they kick it out there you know</font><font color="#CCCCCC"> and it</font>

874
00:33:57,330 --> 00:34:01,889
<font color="#E5E5E5">would be really hard I'll admit really</font>

875
00:33:59,039 --> 00:34:03,960
hard for my<font color="#CCCCCC"> ir team as well as my field</font>

876
00:34:01,889 --> 00:34:06,899
services<font color="#E5E5E5"> and my</font><font color="#CCCCCC"> sock analysts you</font><font color="#E5E5E5"> pick</font>

877
00:34:03,960 --> 00:34:08,159
the side of the<font color="#E5E5E5"> lineup</font><font color="#CCCCCC"> unless they got a</font>

878
00:34:06,899 --> 00:34:10,020
<font color="#E5E5E5">process list and they're gonna go deep</font>

879
00:34:08,159 --> 00:34:11,580
<font color="#E5E5E5">and they're gonna get command-line so</font>

880
00:34:10,020 --> 00:34:13,859
important for command line stuff<font color="#E5E5E5"> right</font>

881
00:34:11,580 --> 00:34:15,779
<font color="#CCCCCC">so</font><font color="#E5E5E5"> let's see if this is running right</font>

882
00:34:13,859 --> 00:34:19,139
<font color="#E5E5E5">now we only</font><font color="#CCCCCC"> have an MFT record that</font>

883
00:34:15,780 --> 00:34:21,599
we've drawn out of<font color="#E5E5E5"> memory and yeah I'm</font>

884
00:34:19,139 --> 00:34:24,149
interesting<font color="#E5E5E5"> so now we're the same</font>

885
00:34:21,599 --> 00:34:25,560
I mean<font color="#E5E5E5"> timeline analysis yeah you'll</font>

886
00:34:24,149 --> 00:34:27,629
have<font color="#CCCCCC"> to excuse me because</font><font color="#E5E5E5"> it's kind</font><font color="#CCCCCC"> of a</font>

887
00:34:25,560 --> 00:34:29,099
<font color="#E5E5E5">forensic examiner thing like oh I feel</font>

888
00:34:27,629 --> 00:34:31,199
<font color="#CCCCCC">like doing timeline I can't move</font><font color="#E5E5E5"> on</font>

889
00:34:29,099 --> 00:34:32,879
until we put it on timeline<font color="#E5E5E5"> so that's</font>

890
00:34:31,199 --> 00:34:35,129
what I'm<font color="#E5E5E5"> doing here taking all those</font><font color="#CCCCCC"> MOT</font>

891
00:34:32,879 --> 00:34:37,049
records and dropping<font color="#E5E5E5"> them in anything</font>

892
00:34:35,129 --> 00:34:40,319
happening immediately<font color="#E5E5E5"> prior well this is</font>

893
00:34:37,050 --> 00:34:41,669
a handle to the key<font color="#CCCCCC"> and last modified</font>

894
00:34:40,320 --> 00:34:43,230
some<font color="#CCCCCC"> of that key so I'm not really</font>

895
00:34:41,668 --> 00:34:44,790
<font color="#E5E5E5">getting any more than</font><font color="#CCCCCC"> at what I'm an</font>

896
00:34:43,230 --> 00:34:48,000
initially had but what is this<font color="#E5E5E5"> evidence</font>

897
00:34:44,790 --> 00:34:49,739
<font color="#E5E5E5">of it's the</font><font color="#CCCCCC"> same executable but now what</font>

898
00:34:48,000 --> 00:34:52,770
are<font color="#CCCCCC"> we seeing based on the presence of</font>

899
00:34:49,739 --> 00:34:55,199
the executable in the key<font color="#CCCCCC"> I hear you</font>

900
00:34:52,770 --> 00:34:58,140
guys say<font color="#E5E5E5"> it nicely done</font><font color="#CCCCCC"> they're saying</font>

901
00:34:55,199 --> 00:35:00,089
persistence<font color="#CCCCCC"> so yeah a lot of</font><font color="#E5E5E5"> my buddies</font>

902
00:34:58,140 --> 00:35:01,109
they'll start their investigation I

903
00:35:00,089 --> 00:35:02,339
think<font color="#E5E5E5"> because they're so fed up with</font>

904
00:35:01,109 --> 00:35:04,200
malware today they're like I'm just

905
00:35:02,339 --> 00:35:05,820
<font color="#E5E5E5">gonna look for persistence like autoruns</font>

906
00:35:04,200 --> 00:35:07,830
mark russinovich would want it this way

907
00:35:05,820 --> 00:35:10,140
<font color="#CCCCCC">and they pull out their auto runs and</font>

908
00:35:07,830 --> 00:35:11,460
however<font color="#CCCCCC"> a context</font><font color="#E5E5E5"> or tool maybe it scans</font>

909
00:35:10,140 --> 00:35:13,740
<font color="#E5E5E5">I mean is</font><font color="#CCCCCC"> taenia maybe it's just</font>

910
00:35:11,460 --> 00:35:14,760
<font color="#E5E5E5">straight-up</font><font color="#CCCCCC"> autoruns be a power show you</font>

911
00:35:13,740 --> 00:35:16,109
can push that<font color="#E5E5E5"> uh-huh</font>

912
00:35:14,760 --> 00:35:18,599
and they'll pull it back and<font color="#E5E5E5"> they'll</font>

913
00:35:16,109 --> 00:35:19,950
<font color="#CCCCCC">just look</font><font color="#E5E5E5"> through the common persistence</font>

914
00:35:18,599 --> 00:35:21,690
locations and the register

915
00:35:19,950 --> 00:35:23,279
we're seeing here<font color="#CCCCCC"> oh those are</font><font color="#E5E5E5"> straight</font>

916
00:35:21,690 --> 00:35:25,260
<font color="#E5E5E5">up look for services man cuz that's</font>

917
00:35:23,280 --> 00:35:27,510
about<font color="#E5E5E5"> 70% of malware</font><font color="#CCCCCC"> that instantiates</font>

918
00:35:25,260 --> 00:35:29,760
persistence<font color="#E5E5E5"> that is going to create or</font>

919
00:35:27,510 --> 00:35:30,540
hijack a service so<font color="#CCCCCC"> that's pretty slick</font>

920
00:35:29,760 --> 00:35:31,800
<font color="#CCCCCC">ass</font><font color="#E5E5E5"> pretty slick</font>

921
00:35:30,540 --> 00:35:33,779
it's a good job<font color="#E5E5E5"> I mean I definitely</font>

922
00:35:31,800 --> 00:35:35,490
write this one<font color="#CCCCCC"> up</font><font color="#E5E5E5"> in my report so that</font>

923
00:35:33,780 --> 00:35:37,500
was current version run<font color="#E5E5E5"> as you're</font>

924
00:35:35,490 --> 00:35:40,140
looking at<font color="#E5E5E5"> it what's happening prior to</font>

925
00:35:37,500 --> 00:35:42,420
<font color="#CCCCCC">kerma ah who's flipping</font><font color="#E5E5E5"> over the table</font>

926
00:35:40,140 --> 00:35:44,700
that this<font color="#E5E5E5"> is a contrived scenario do you</font>

927
00:35:42,420 --> 00:35:47,339
see what's<font color="#CCCCCC"> happening up here higher in</font>

928
00:35:44,700 --> 00:35:49,348
my timeline<font color="#E5E5E5"> my</font><font color="#CCCCCC"> MFT records this looks</font>

929
00:35:47,339 --> 00:35:52,020
like<font color="#E5E5E5"> someone infected their own machine</font>

930
00:35:49,349 --> 00:35:55,800
because<font color="#E5E5E5"> I see</font><font color="#CCCCCC"> what is</font><font color="#E5E5E5"> that a sha-1</font><font color="#CCCCCC"> sha-1</font>

931
00:35:52,020 --> 00:35:57,630
<font color="#CCCCCC">Exe spy net you can</font><font color="#E5E5E5"> actually see how</font>

932
00:35:55,800 --> 00:35:59,130
this<font color="#E5E5E5"> machine</font><font color="#CCCCCC"> was infected</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> I'm</font>

933
00:35:57,630 --> 00:36:00,869
pulling user<font color="#CCCCCC"> assists</font>

934
00:35:59,130 --> 00:36:03,210
actually this is<font color="#E5E5E5"> timeline</font><font color="#CCCCCC"> er</font><font color="#E5E5E5"> output</font>

935
00:36:00,869 --> 00:36:04,680
isn't<font color="#E5E5E5"> it timeline or not just</font><font color="#CCCCCC"> MFT parser</font>

936
00:36:03,210 --> 00:36:06,690
<font color="#E5E5E5">but time liner is being pulled in and</font>

937
00:36:04,680 --> 00:36:09,598
shown to<font color="#E5E5E5"> us so this is good stuff</font>

938
00:36:06,690 --> 00:36:12,599
<font color="#E5E5E5">because evidence of execution</font><font color="#CCCCCC"> for Spina</font>

939
00:36:09,599 --> 00:36:14,460
<font color="#E5E5E5">XD and shortly after</font><font color="#CCCCCC"> that we see that</font>

940
00:36:12,599 --> 00:36:16,859
<font color="#CCCCCC">relationship exists between</font><font color="#E5E5E5"> the</font>

941
00:36:14,460 --> 00:36:18,390
persistence key<font color="#E5E5E5"> and whatever else is</font>

942
00:36:16,859 --> 00:36:20,369
currently running<font color="#E5E5E5"> this good stuff</font><font color="#CCCCCC"> it's</font>

943
00:36:18,390 --> 00:36:21,750
good stuff<font color="#CCCCCC"> you agree yeah I don't</font><font color="#E5E5E5"> know</font>

944
00:36:20,369 --> 00:36:23,760
if you<font color="#E5E5E5"> feel done with this one yet but</font>

945
00:36:21,750 --> 00:36:25,829
<font color="#CCCCCC">yeah</font><font color="#E5E5E5"> we'll go ahead and we'll verify</font>

946
00:36:23,760 --> 00:36:29,550
that the user<font color="#E5E5E5"> who's currently logged in</font>

947
00:36:25,829 --> 00:36:32,369
at the time we dumped memory has the

948
00:36:29,550 --> 00:36:33,450
<font color="#E5E5E5">tosco study XE hanging right off</font><font color="#CCCCCC"> of</font>

949
00:36:32,369 --> 00:36:35,130
their current version run in there<font color="#CCCCCC"> and</font>

950
00:36:33,450 --> 00:36:36,629
<font color="#CCCCCC">to user dot dot</font><font color="#E5E5E5"> so that's what we're</font>

951
00:36:35,130 --> 00:36:38,670
seeing<font color="#CCCCCC"> here and a little shout out the</font>

952
00:36:36,630 --> 00:36:42,450
<font color="#CCCCCC">Thomas top idea who wrote this autoruns</font>

953
00:36:38,670 --> 00:36:43,380
<font color="#CCCCCC">plugin is good</font><font color="#E5E5E5"> it's good so I think I</font>

954
00:36:42,450 --> 00:36:48,598
<font color="#E5E5E5">think we're rounding the bend on that</font>

955
00:36:43,380 --> 00:36:49,500
one<font color="#E5E5E5"> whoa speed round speed round no it</font>

956
00:36:48,599 --> 00:36:52,079
gets<font color="#E5E5E5"> a little bit harder from here</font>

957
00:36:49,500 --> 00:36:54,240
<font color="#CCCCCC">because I got a you have to hear from</font><font color="#E5E5E5"> me</font>

958
00:36:52,079 --> 00:36:56,849
about<font color="#E5E5E5"> this</font><font color="#CCCCCC"> network forensics based tool</font>

959
00:36:54,240 --> 00:37:00,149
stealthWatch<font color="#E5E5E5"> is anyone using</font><font color="#CCCCCC"> this so me</font>

960
00:36:56,849 --> 00:37:02,970
using this<font color="#E5E5E5"> still watch no whoops come on</font>

961
00:37:00,150 --> 00:37:05,099
man the ability<font color="#CCCCCC"> to</font><font color="#E5E5E5"> use net flow</font>

962
00:37:02,970 --> 00:37:08,009
information<font color="#E5E5E5"> to figure out what is going</font>

963
00:37:05,099 --> 00:37:11,069
<font color="#E5E5E5">on in my network and I know it takes a</font>

964
00:37:08,010 --> 00:37:14,430
lot<font color="#E5E5E5"> of time to baseline these network</font>

965
00:37:11,069 --> 00:37:16,980
intrusion detection<font color="#CCCCCC"> products</font><font color="#E5E5E5"> that are in</font>

966
00:37:14,430 --> 00:37:18,540
<font color="#E5E5E5">your environment but I would say once</font>

967
00:37:16,980 --> 00:37:19,890
you get it<font color="#E5E5E5"> rolling you might benefit</font>

968
00:37:18,540 --> 00:37:23,640
<font color="#CCCCCC">from something</font><font color="#E5E5E5"> like this which is a</font>

969
00:37:19,890 --> 00:37:25,140
<font color="#CCCCCC">stealthWatch high concern index</font><font color="#E5E5E5"> hits so</font>

970
00:37:23,640 --> 00:37:26,910
<font color="#E5E5E5">there was one machine inside our</font>

971
00:37:25,140 --> 00:37:28,440
environment that was<font color="#E5E5E5"> active</font><font color="#CCCCCC"> okay there's</font>

972
00:37:26,910 --> 00:37:30,029
a lot<font color="#E5E5E5"> of machines inside our environment</font>

973
00:37:28,440 --> 00:37:32,900
one<font color="#CCCCCC"> of them was detected with this</font>

974
00:37:30,030 --> 00:37:35,120
technique<font color="#E5E5E5"> and it was acting crazy</font>

975
00:37:32,900 --> 00:37:38,600
right network network<font color="#E5E5E5"> so the fact that</font>

976
00:37:35,120 --> 00:37:41,870
we identified<font color="#E5E5E5"> this one machine based on</font>

977
00:37:38,600 --> 00:37:44,509
<font color="#E5E5E5">network traffic means that when I get a</font>

978
00:37:41,870 --> 00:37:45,859
<font color="#E5E5E5">memory dump in front of me and I know</font>

979
00:37:44,510 --> 00:37:47,600
you<font color="#E5E5E5"> guys are probably thinking like how</font>

980
00:37:45,860 --> 00:37:50,060
is she dumping this like how is she

981
00:37:47,600 --> 00:37:51,680
dumping all<font color="#CCCCCC"> of these memory images</font><font color="#E5E5E5"> I</font>

982
00:37:50,060 --> 00:37:53,330
know what you want to<font color="#E5E5E5"> ask me what my</font>

983
00:37:51,680 --> 00:37:55,220
<font color="#CCCCCC">favorite tool this am i right</font>

984
00:37:53,330 --> 00:37:57,920
like what's my<font color="#E5E5E5"> favorite acquisition tool</font>

985
00:37:55,220 --> 00:38:01,279
<font color="#E5E5E5">it's like I can read your minds what it</font>

986
00:37:57,920 --> 00:38:03,440
what he is what<font color="#CCCCCC"> do</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> use whatever</font><font color="#E5E5E5"> I</font>

987
00:38:01,280 --> 00:38:05,630
tell you<font color="#E5E5E5"> to</font><font color="#CCCCCC"> do huh yeah when pee man</font>

988
00:38:03,440 --> 00:38:07,340
<font color="#CCCCCC">responds</font><font color="#E5E5E5"> that's nice of response</font>

989
00:38:05,630 --> 00:38:09,620
what else is a possible solution here I

990
00:38:07,340 --> 00:38:13,340
<font color="#CCCCCC">talk to attain</font><font color="#E5E5E5"> iam</font><font color="#CCCCCC"> Danny amuses</font><font color="#E5E5E5"> the wind</font>

991
00:38:09,620 --> 00:38:14,720
<font color="#CCCCCC">pmm pushes</font><font color="#E5E5E5"> that driver say</font><font color="#CCCCCC"> in case we'll</font>

992
00:38:13,340 --> 00:38:16,940
<font color="#E5E5E5">do it right in case we'll pull it back</font>

993
00:38:14,720 --> 00:38:19,220
<font color="#CCCCCC">fdk know I step to K imager</font>

994
00:38:16,940 --> 00:38:21,160
I don't<font color="#E5E5E5"> pit is never using dump it</font>

995
00:38:19,220 --> 00:38:25,669
little<font color="#CCCCCC"> shout-out to</font><font color="#E5E5E5"> Matt you</font><font color="#CCCCCC"> sweet</font>

996
00:38:21,160 --> 00:38:27,049
really<font color="#E5E5E5"> that's my stuff</font><font color="#CCCCCC"> with you guys I</font>

997
00:38:25,670 --> 00:38:28,580
must have named<font color="#E5E5E5"> your favorite it's very</font>

998
00:38:27,050 --> 00:38:30,590
early<font color="#CCCCCC"> on it must name her</font><font color="#E5E5E5"> favorites okay</font>

999
00:38:28,580 --> 00:38:32,270
<font color="#E5E5E5">we'll proceed now that I've made you</font>

1000
00:38:30,590 --> 00:38:33,590
<font color="#CCCCCC">believe for</font><font color="#E5E5E5"> the you</font><font color="#CCCCCC"> Coon you too could</font>

1001
00:38:32,270 --> 00:38:36,440
dump all these memory images we<font color="#E5E5E5"> can't</font>

1002
00:38:33,590 --> 00:38:38,360
proceed<font color="#E5E5E5"> so is anyone nervous maybe</font>

1003
00:38:36,440 --> 00:38:39,620
that's why I lost<font color="#E5E5E5"> your attention are you</font>

1004
00:38:38,360 --> 00:38:41,720
nervous about<font color="#E5E5E5"> what you're seeing up here</font>

1005
00:38:39,620 --> 00:38:43,310
<font color="#E5E5E5">because the first thing I'm gonna do</font>

1006
00:38:41,720 --> 00:38:45,980
when I get that stealthWatch<font color="#E5E5E5"> high</font>

1007
00:38:43,310 --> 00:38:47,299
concern index is like okay it was acting

1008
00:38:45,980 --> 00:38:48,640
crazy on the network<font color="#CCCCCC"> we're gonna go</font>

1009
00:38:47,300 --> 00:38:53,540
ahead<font color="#CCCCCC"> and</font><font color="#E5E5E5"> we're gonna run net scan</font>

1010
00:38:48,640 --> 00:38:55,879
what's concerning<font color="#E5E5E5"> about this yeah yeah</font>

1011
00:38:53,540 --> 00:39:00,350
<font color="#CCCCCC">four four five who should own</font><font color="#E5E5E5"> four four</font>

1012
00:38:55,880 --> 00:39:02,690
five<font color="#CCCCCC"> comms</font><font color="#E5E5E5"> mostly you know the</font><font color="#CCCCCC"> majority</font>

1013
00:39:00,350 --> 00:39:05,839
of<font color="#E5E5E5"> the time who should who should own as</font>

1014
00:39:02,690 --> 00:39:08,210
a process for<font color="#E5E5E5"> four five like it depends</font>

1015
00:39:05,840 --> 00:39:10,460
okay okay get past the it<font color="#E5E5E5"> depends based</font>

1016
00:39:08,210 --> 00:39:12,530
on what you've seen<font color="#E5E5E5"> if it's just</font>

1017
00:39:10,460 --> 00:39:15,260
straight<font color="#CCCCCC"> up like net use a little nap</font>

1018
00:39:12,530 --> 00:39:17,270
drive<font color="#CCCCCC"> its system so</font><font color="#E5E5E5"> pip or do you see</font>

1019
00:39:15,260 --> 00:39:20,510
<font color="#E5E5E5">any</font><font color="#CCCCCC"> pitfalls here that</font><font color="#E5E5E5"> on the four four</font>

1020
00:39:17,270 --> 00:39:22,700
five I see I see one<font color="#CCCCCC"> and that looks</font>

1021
00:39:20,510 --> 00:39:24,020
<font color="#E5E5E5">that's</font><font color="#CCCCCC"> probably us that's</font><font color="#E5E5E5"> probably us</font>

1022
00:39:22,700 --> 00:39:27,319
connecting to the<font color="#CCCCCC"> machine</font><font color="#E5E5E5"> and doing some</font>

1023
00:39:24,020 --> 00:39:29,690
<font color="#E5E5E5">investigations</font><font color="#CCCCCC"> ah but who else</font><font color="#E5E5E5"> I mean</font>

1024
00:39:27,320 --> 00:39:34,160
what other<font color="#E5E5E5"> process owns the four four or</font>

1025
00:39:29,690 --> 00:39:37,850
<font color="#E5E5E5">five comms</font><font color="#CCCCCC"> m/s sec</font><font color="#E5E5E5"> SVC does anyone</font>

1026
00:39:34,160 --> 00:39:40,460
recognize<font color="#CCCCCC"> this process name is good you</font>

1027
00:39:37,850 --> 00:39:43,970
guys you live a charmed life<font color="#E5E5E5"> charmed</font>

1028
00:39:40,460 --> 00:39:45,059
life<font color="#CCCCCC"> alright then I'll save I'll stay at</font>

1029
00:39:43,970 --> 00:39:47,848
the grand finale here

1030
00:39:45,059 --> 00:39:50,339
oh wait<font color="#E5E5E5"> oh wait for it but you know</font><font color="#CCCCCC"> four</font>

1031
00:39:47,849 --> 00:39:53,359
<font color="#CCCCCC">or</font><font color="#E5E5E5"> five can you tell me why did we think</font>

1032
00:39:50,339 --> 00:39:56,069
<font color="#CCCCCC">this was patient</font><font color="#E5E5E5"> zero in this compromise</font>

1033
00:39:53,359 --> 00:39:57,689
as you're<font color="#CCCCCC"> looking at this memory dump</font>

1034
00:39:56,069 --> 00:39:59,699
and<font color="#E5E5E5"> you see four four five</font><font color="#CCCCCC"> connections</font>

1035
00:39:57,689 --> 00:40:02,098
<font color="#E5E5E5">is there anything that would be</font>

1036
00:39:59,699 --> 00:40:03,659
concerning<font color="#E5E5E5"> to you it's a whole bunch of</font>

1037
00:40:02,099 --> 00:40:05,579
<font color="#E5E5E5">outbound traffic so obviously this</font>

1038
00:40:03,659 --> 00:40:07,380
<font color="#E5E5E5">machine is attempting to connect so</font>

1039
00:40:05,579 --> 00:40:09,569
remote IP addresses on four four<font color="#E5E5E5"> five</font>

1040
00:40:07,380 --> 00:40:11,429
which<font color="#CCCCCC"> is a little bit</font><font color="#E5E5E5"> obnoxious</font><font color="#CCCCCC"> a little</font>

1041
00:40:09,569 --> 00:40:13,679
bit obnoxious<font color="#CCCCCC"> but</font><font color="#E5E5E5"> do you see the inbound</font>

1042
00:40:11,429 --> 00:40:15,569
four four five<font color="#E5E5E5"> the</font><font color="#CCCCCC"> only way we're able</font>

1043
00:40:13,679 --> 00:40:17,400
to see<font color="#CCCCCC"> the inbound four four five</font>

1044
00:40:15,569 --> 00:40:19,829
connection to this system<font color="#E5E5E5"> let me get my</font>

1045
00:40:17,400 --> 00:40:22,619
<font color="#CCCCCC">pointer out oh</font><font color="#E5E5E5"> wait that's good is</font>

1046
00:40:19,829 --> 00:40:24,630
because<font color="#CCCCCC"> I'm scanning for the</font><font color="#E5E5E5"> presence of</font>

1047
00:40:22,619 --> 00:40:26,939
these TCP underscore endpoints<font color="#CCCCCC"> I</font>

1048
00:40:24,630 --> 00:40:29,039
wouldn't see<font color="#E5E5E5"> this if I was interrogating</font>

1049
00:40:26,939 --> 00:40:29,999
the<font color="#CCCCCC"> machine across the network using say</font>

1050
00:40:29,039 --> 00:40:32,209
wmic

1051
00:40:29,999 --> 00:40:34,738
<font color="#CCCCCC">I wouldn't see the close connection</font>

1052
00:40:32,209 --> 00:40:36,899
<font color="#E5E5E5">because it's</font><font color="#CCCCCC"> already</font><font color="#E5E5E5"> been</font><font color="#CCCCCC"> removed from</font>

1053
00:40:34,739 --> 00:40:39,179
say<font color="#E5E5E5"> your netstat output</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> only way I'm</font>

1054
00:40:36,900 --> 00:40:41,669
seeing that closed connection which<font color="#E5E5E5"> is</font>

1055
00:40:39,179 --> 00:40:43,650
<font color="#CCCCCC">an inbounds to this systems four four</font>

1056
00:40:41,669 --> 00:40:45,359
five<font color="#CCCCCC"> for remote IP address is because I</font>

1057
00:40:43,650 --> 00:40:48,119
have the memory<font color="#E5E5E5"> image and this data</font>

1058
00:40:45,359 --> 00:40:50,788
<font color="#E5E5E5">structure is there as consider it an</font>

1059
00:40:48,119 --> 00:40:53,069
unallocated space in memory<font color="#E5E5E5"> so it's cool</font>

1060
00:40:50,789 --> 00:40:54,630
<font color="#E5E5E5">net scan allows me to carve this out and</font>

1061
00:40:53,069 --> 00:40:56,369
I'm like damn you know<font color="#E5E5E5"> this very well</font>

1062
00:40:54,630 --> 00:40:59,699
<font color="#CCCCCC">could</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> been patient zero and what</font>

1063
00:40:56,369 --> 00:41:03,209
type of<font color="#E5E5E5"> infection</font><font color="#CCCCCC"> it could</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> been</font>

1064
00:40:59,699 --> 00:41:04,979
anything<font color="#CCCCCC"> any any nasty eternal blue</font><font color="#E5E5E5"> yeah</font>

1065
00:41:03,209 --> 00:41:06,719
and he nasty eternal blue<font color="#E5E5E5"> compromised</font>

1066
00:41:04,979 --> 00:41:09,328
you'd be right in saying<font color="#CCCCCC"> that</font><font color="#E5E5E5"> so what</font>

1067
00:41:06,719 --> 00:41:11,939
we're looking at<font color="#CCCCCC"> here is what we deemed</font>

1068
00:41:09,329 --> 00:41:13,979
<font color="#CCCCCC">to be patient zero</font><font color="#E5E5E5"> and we're seeing</font>

1069
00:41:11,939 --> 00:41:16,919
<font color="#E5E5E5">evidence of initial infection the bad</font>

1070
00:41:13,979 --> 00:41:18,118
thing about time I say<font color="#E5E5E5"> network</font>

1071
00:41:16,919 --> 00:41:19,679
connections as we're<font color="#E5E5E5"> pulling them out</font>

1072
00:41:18,119 --> 00:41:21,419
they don't<font color="#E5E5E5"> have time and</font><font color="#CCCCCC"> date stamps</font>

1073
00:41:19,679 --> 00:41:23,130
associated with them as you're

1074
00:41:21,419 --> 00:41:24,689
retrieving<font color="#CCCCCC"> these artifacts from memory</font>

1075
00:41:23,130 --> 00:41:27,179
<font color="#E5E5E5">yeah you got</font><font color="#CCCCCC"> to get it from a different</font>

1076
00:41:24,689 --> 00:41:29,219
data source<font color="#CCCCCC"> yeah that's alright alright</font>

1077
00:41:27,179 --> 00:41:31,499
<font color="#E5E5E5">we'll proceed yeah that one's pretty</font>

1078
00:41:29,219 --> 00:41:33,359
<font color="#E5E5E5">pretty interesting</font><font color="#CCCCCC"> too I would</font>

1079
00:41:31,499 --> 00:41:36,118
immediately expand the scope of my

1080
00:41:33,359 --> 00:41:37,769
investigation it's the whole world<font color="#CCCCCC"> I</font>

1081
00:41:36,119 --> 00:41:40,769
don't<font color="#CCCCCC"> know four</font><font color="#E5E5E5"> four five this is</font>

1082
00:41:37,769 --> 00:41:42,328
<font color="#E5E5E5">probably a highly infectious system now</font>

1083
00:41:40,769 --> 00:41:44,939
where propagation was<font color="#E5E5E5"> rampant</font>

1084
00:41:42,329 --> 00:41:46,979
<font color="#E5E5E5">it was very aggressive</font><font color="#CCCCCC"> so of course you</font>

1085
00:41:44,939 --> 00:41:48,299
want<font color="#E5E5E5"> to pivot</font><font color="#CCCCCC"> to a winning process</font>

1086
00:41:46,979 --> 00:41:50,308
getting<font color="#E5E5E5"> more details about that</font>

1087
00:41:48,299 --> 00:41:51,839
<font color="#E5E5E5">particular process that</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> running that</font>

1088
00:41:50,309 --> 00:41:53,640
<font color="#E5E5E5">was responsible</font><font color="#CCCCCC"> for all of those out</font>

1089
00:41:51,839 --> 00:41:56,570
<font color="#CCCCCC">barons</font><font color="#E5E5E5"> quarries you know attempts to</font>

1090
00:41:53,640 --> 00:41:58,400
connect<font color="#E5E5E5"> to remote IP addresses so this</font>

1091
00:41:56,570 --> 00:42:00,020
what we were<font color="#CCCCCC"> able to</font><font color="#E5E5E5"> get note that time</font>

1092
00:41:58,400 --> 00:42:02,030
and date stamp might be relevant here

1093
00:42:00,020 --> 00:42:03,740
<font color="#E5E5E5">but I know what you're thinking dwell</font>

1094
00:42:02,030 --> 00:42:05,000
time<font color="#CCCCCC"> ELISA</font><font color="#E5E5E5"> right</font>

1095
00:42:03,740 --> 00:42:08,689
what is<font color="#E5E5E5"> that bridge</font><font color="#CCCCCC"> to all the time</font>

1096
00:42:05,000 --> 00:42:12,020
these<font color="#E5E5E5"> days</font><font color="#CCCCCC"> do it</font><font color="#E5E5E5"> Everage dwell time it's</font>

1097
00:42:08,690 --> 00:42:13,310
like a<font color="#CCCCCC"> 6070 i mean it does depend on</font><font color="#E5E5E5"> who</font>

1098
00:42:12,020 --> 00:42:15,920
you are<font color="#E5E5E5"> and what you're willing to admit</font>

1099
00:42:13,310 --> 00:42:17,270
<font color="#CCCCCC">you we</font><font color="#E5E5E5"> asked our</font><font color="#CCCCCC"> sands</font><font color="#E5E5E5"> participants for</font>

1100
00:42:15,920 --> 00:42:19,670
the surveys and<font color="#CCCCCC"> they say oh it's two</font>

1101
00:42:17,270 --> 00:42:21,770
days<font color="#CCCCCC"> two days</font><font color="#E5E5E5"> less</font><font color="#CCCCCC"> than two day less</font>

1102
00:42:19,670 --> 00:42:24,320
than<font color="#E5E5E5"> two hours</font><font color="#CCCCCC"> we're able to detect a</font>

1103
00:42:21,770 --> 00:42:27,290
system that's compromised<font color="#CCCCCC"> ten minutes</font>

1104
00:42:24,320 --> 00:42:27,860
<font color="#CCCCCC">after that</font><font color="#E5E5E5"> it's remediated it's okay</font>

1105
00:42:27,290 --> 00:42:30,740
it's<font color="#E5E5E5"> okay</font>

1106
00:42:27,860 --> 00:42:32,180
serious face serious<font color="#CCCCCC"> face it's not easy</font>

1107
00:42:30,740 --> 00:42:34,310
it's<font color="#E5E5E5"> not easy stuff and it all depends</font>

1108
00:42:32,180 --> 00:42:36,319
<font color="#CCCCCC">on definition so we kick back</font><font color="#E5E5E5"> and we run</font>

1109
00:42:34,310 --> 00:42:38,960
<font color="#CCCCCC">to shrimp</font><font color="#E5E5E5"> cache mem</font><font color="#CCCCCC"> which I know pleased</font>

1110
00:42:36,320 --> 00:42:40,610
you before<font color="#E5E5E5"> right evidence of execution</font>

1111
00:42:38,960 --> 00:42:43,550
where you can kind<font color="#CCCCCC"> of put it</font><font color="#E5E5E5"> in order I</font>

1112
00:42:40,610 --> 00:42:46,940
have MS SEC<font color="#E5E5E5"> SVC and then I have that</font>

1113
00:42:43,550 --> 00:42:48,620
task as CAG<font color="#E5E5E5"> that</font><font color="#CCCCCC"> exe</font><font color="#E5E5E5"> this is obvious</font>

1114
00:42:46,940 --> 00:42:49,610
<font color="#CCCCCC">okay it's</font><font color="#E5E5E5"> obvious to me because I've</font>

1115
00:42:48,620 --> 00:42:51,470
<font color="#E5E5E5">been born by it</font>

1116
00:42:49,610 --> 00:42:54,020
but I can see all<font color="#CCCCCC"> kinds of things</font>

1117
00:42:51,470 --> 00:42:57,049
<font color="#E5E5E5">popping up in my timeline or output and</font>

1118
00:42:54,020 --> 00:42:59,270
then finally an injected<font color="#CCCCCC"> L</font><font color="#E5E5E5"> sauce that</font>

1119
00:42:57,050 --> 00:43:03,920
might be like the finishing blow<font color="#E5E5E5"> this</font><font color="#CCCCCC"> L</font>

1120
00:42:59,270 --> 00:43:06,830
<font color="#CCCCCC">SAS has a memory range it has</font><font color="#E5E5E5"> a DLL has</font>

1121
00:43:03,920 --> 00:43:09,350
the MZ header that's tucked away in an

1122
00:43:06,830 --> 00:43:10,940
outlet memory a range allocation<font color="#CCCCCC"> it's</font>

1123
00:43:09,350 --> 00:43:12,860
clearly<font color="#E5E5E5"> no path to</font><font color="#CCCCCC"> disk that's</font><font color="#E5E5E5"> why I'm</font>

1124
00:43:10,940 --> 00:43:14,300
al fine is<font color="#E5E5E5"> complaining about it so what</font>

1125
00:43:12,860 --> 00:43:16,160
do you do when you<font color="#CCCCCC"> find something</font><font color="#E5E5E5"> like</font>

1126
00:43:14,300 --> 00:43:17,300
this don't let me<font color="#E5E5E5"> get</font><font color="#CCCCCC"> in your</font><font color="#E5E5E5"> way</font>

1127
00:43:16,160 --> 00:43:19,910
don't let me get in your<font color="#CCCCCC"> way you know</font>

1128
00:43:17,300 --> 00:43:22,100
<font color="#E5E5E5">you can upload a virus oh no oh all</font>

1129
00:43:19,910 --> 00:43:23,779
right<font color="#CCCCCC"> so we upload that memory range</font>

1130
00:43:22,100 --> 00:43:25,069
after<font color="#E5E5E5"> already identifying and knowing</font>

1131
00:43:23,780 --> 00:43:28,760
what we're dealing with<font color="#E5E5E5"> and</font><font color="#CCCCCC"> knowing that</font>

1132
00:43:25,070 --> 00:43:30,770
it's my commodity but it's well known we

1133
00:43:28,760 --> 00:43:34,040
would upload this<font color="#CCCCCC"> and we</font><font color="#E5E5E5"> get back hey</font>

1134
00:43:30,770 --> 00:43:36,440
this is wanna cry<font color="#E5E5E5"> you can see that</font><font color="#CCCCCC"> Ahn</font>

1135
00:43:34,040 --> 00:43:38,930
lab it does not let<font color="#CCCCCC"> us down improper</font>

1136
00:43:36,440 --> 00:43:40,540
<font color="#CCCCCC">identification there you go Dooney</font><font color="#E5E5E5"> did</font>

1137
00:43:38,930 --> 00:43:44,870
you use virus Toto at all

1138
00:43:40,540 --> 00:43:47,060
<font color="#E5E5E5">all right yeah for some purpose to</font><font color="#CCCCCC"> laugh</font>

1139
00:43:44,870 --> 00:43:49,400
at others<font color="#CCCCCC"> don't laugh</font><font color="#E5E5E5"> at the victims of</font>

1140
00:43:47,060 --> 00:43:53,600
the world<font color="#E5E5E5"> I get it I get it</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so</font>

1141
00:43:49,400 --> 00:43:56,300
I have five more<font color="#CCCCCC"> minutes</font><font color="#E5E5E5"> and I</font><font color="#CCCCCC"> would</font>

1142
00:43:53,600 --> 00:43:58,400
like<font color="#E5E5E5"> to offer a bonus system are you</font>

1143
00:43:56,300 --> 00:44:00,320
down with<font color="#CCCCCC"> that or is it just</font><font color="#E5E5E5"> is it just</font>

1144
00:43:58,400 --> 00:44:03,890
too much this would be system number<font color="#CCCCCC"> 700</font>

1145
00:44:00,320 --> 00:44:05,240
<font color="#CCCCCC">I always always</font><font color="#E5E5E5"> you miss your workplace</font>

1146
00:44:03,890 --> 00:44:07,430
<font color="#E5E5E5">you want to go back to your shop</font><font color="#CCCCCC"> and</font>

1147
00:44:05,240 --> 00:44:08,450
look at you know images from compromises

1148
00:44:07,430 --> 00:44:10,879
<font color="#CCCCCC">- all right</font>

1149
00:44:08,450 --> 00:44:13,520
jump in<font color="#CCCCCC"> now this one doesn't</font><font color="#E5E5E5"> look too</font>

1150
00:44:10,880 --> 00:44:14,750
bad it honestly doesn't but I was able

1151
00:44:13,520 --> 00:44:16,520
<font color="#E5E5E5">to figure out</font><font color="#CCCCCC"> that something was wrong</font>

1152
00:44:14,750 --> 00:44:18,430
<font color="#E5E5E5">with the system because I enumerated</font>

1153
00:44:16,520 --> 00:44:20,480
processes and looked at the session

1154
00:44:18,430 --> 00:44:22,098
<font color="#E5E5E5">Association now we've done this before</font>

1155
00:44:20,480 --> 00:44:24,320
and it panned out for<font color="#E5E5E5"> us if you remember</font>

1156
00:44:22,099 --> 00:44:25,940
it was system number<font color="#E5E5E5"> one</font><font color="#CCCCCC"> when you're</font>

1157
00:44:24,320 --> 00:44:28,339
like that<font color="#E5E5E5"> SPC host is associate with</font>

1158
00:44:25,940 --> 00:44:31,430
<font color="#E5E5E5">session</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> and session two was the user</font>

1159
00:44:28,339 --> 00:44:33,560
session if they log on and session in

1160
00:44:31,430 --> 00:44:36,078
him rates and there you go<font color="#CCCCCC"> so this is</font>

1161
00:44:33,560 --> 00:44:39,230
<font color="#CCCCCC">what I saw</font><font color="#E5E5E5"> when I</font><font color="#CCCCCC"> was dumping memory on</font>

1162
00:44:36,079 --> 00:44:41,119
my<font color="#E5E5E5"> own system it looks</font><font color="#CCCCCC"> pretty clean</font>

1163
00:44:39,230 --> 00:44:42,800
<font color="#E5E5E5">doesn't it I mean I</font><font color="#CCCCCC"> think I actually had</font>

1164
00:44:41,119 --> 00:44:45,260
<font color="#E5E5E5">notepad running so it's a little bit</font>

1165
00:44:42,800 --> 00:44:47,660
<font color="#E5E5E5">different from what I saw</font><font color="#CCCCCC"> I teach the</font>

1166
00:44:45,260 --> 00:44:50,240
526 class all the time<font color="#E5E5E5"> and I was</font><font color="#CCCCCC"> just</font>

1167
00:44:47,660 --> 00:44:52,279
<font color="#E5E5E5">about to roll</font><font color="#CCCCCC"> into day two and I still</font>

1168
00:44:50,240 --> 00:44:53,598
had some content left from day one<font color="#E5E5E5"> you</font>

1169
00:44:52,280 --> 00:44:55,400
<font color="#E5E5E5">know so it's the memory forensics class</font>

1170
00:44:53,599 --> 00:44:56,960
and I'm like I'm<font color="#CCCCCC"> gonna be a</font><font color="#E5E5E5"> good</font><font color="#CCCCCC"> sands</font>

1171
00:44:55,400 --> 00:45:00,260
instructor I'm gonna walk<font color="#E5E5E5"> through my lab</font>

1172
00:44:56,960 --> 00:45:02,540
before<font color="#CCCCCC"> I get in and</font><font color="#E5E5E5"> that lab</font><font color="#CCCCCC"> was dumping</font>

1173
00:45:00,260 --> 00:45:04,579
memory with wind<font color="#E5E5E5"> peameal and then</font>

1174
00:45:02,540 --> 00:45:06,440
bringing<font color="#E5E5E5"> it over to my Ubuntu</font><font color="#CCCCCC"> shift and</font>

1175
00:45:04,579 --> 00:45:08,359
doing some analysis I<font color="#E5E5E5"> think we were</font>

1176
00:45:06,440 --> 00:45:10,099
doing<font color="#CCCCCC"> analysis with volatility because</font>

1177
00:45:08,359 --> 00:45:13,369
recall<font color="#E5E5E5"> is in an unstable</font><font color="#CCCCCC"> State at the</font>

1178
00:45:10,099 --> 00:45:16,700
time<font color="#E5E5E5"> so when I brought it over this is</font>

1179
00:45:13,369 --> 00:45:19,460
what I saw you know going<font color="#E5E5E5"> from that</font>

1180
00:45:16,700 --> 00:45:21,980
desktop<font color="#E5E5E5"> so now what I see in the process</font>

1181
00:45:19,460 --> 00:45:25,880
<font color="#E5E5E5">lists I was a little</font><font color="#CCCCCC"> concerned because</font>

1182
00:45:21,980 --> 00:45:27,829
<font color="#CCCCCC">my</font><font color="#E5E5E5"> students had the same VM as me and I</font>

1183
00:45:25,880 --> 00:45:30,079
was<font color="#E5E5E5"> about to roll in and see whether</font>

1184
00:45:27,829 --> 00:45:31,550
they were<font color="#E5E5E5"> seeing what I was seeing and</font>

1185
00:45:30,079 --> 00:45:32,710
what's wrong<font color="#E5E5E5"> with these Internet</font>

1186
00:45:31,550 --> 00:45:35,270
<font color="#E5E5E5">Explorer's</font>

1187
00:45:32,710 --> 00:45:37,369
volatility doesn't<font color="#E5E5E5"> color code people it</font>

1188
00:45:35,270 --> 00:45:39,619
doesn't<font color="#E5E5E5"> color code for you but I'm color</font>

1189
00:45:37,369 --> 00:45:44,119
coding those<font color="#E5E5E5"> Internet Explorer's are</font>

1190
00:45:39,619 --> 00:45:45,829
associated with session<font color="#E5E5E5"> zero and I know</font>

1191
00:45:44,119 --> 00:45:49,220
it's been a<font color="#E5E5E5"> long time since you've used</font>

1192
00:45:45,829 --> 00:45:51,020
<font color="#CCCCCC">ie I get it I get it I use it all the</font>

1193
00:45:49,220 --> 00:45:53,149
time<font color="#CCCCCC"> it's it's it's still</font><font color="#E5E5E5"> good it's</font>

1194
00:45:51,020 --> 00:45:56,270
<font color="#E5E5E5">still hanging in</font><font color="#CCCCCC"> there but I you know</font>

1195
00:45:53,150 --> 00:45:59,150
what<font color="#E5E5E5"> session should Internet Explorer be</font>

1196
00:45:56,270 --> 00:46:01,400
associated with in most cases<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> say</font>

1197
00:45:59,150 --> 00:46:02,690
it<font color="#CCCCCC"> depends yeah one or above</font><font color="#E5E5E5"> right</font>

1198
00:46:01,400 --> 00:46:05,060
wonder about<font color="#E5E5E5"> it should be associate with</font>

1199
00:46:02,690 --> 00:46:06,560
<font color="#E5E5E5">a user session and you know what if</font>

1200
00:46:05,060 --> 00:46:08,089
Internet Explorer was running it should

1201
00:46:06,560 --> 00:46:10,490
have been rendering<font color="#CCCCCC"> Windows to the</font>

1202
00:46:08,089 --> 00:46:13,130
desktop<font color="#E5E5E5"> and I was a little sick I was</font>

1203
00:46:10,490 --> 00:46:15,500
always a little<font color="#E5E5E5"> concerned of course and</font>

1204
00:46:13,130 --> 00:46:19,460
also<font color="#E5E5E5"> because I'm a purist</font><font color="#CCCCCC"> I was thrilled</font>

1205
00:46:15,500 --> 00:46:20,869
<font color="#E5E5E5">I was like oh my gosh we have</font><font color="#CCCCCC"> boom live</font>

1206
00:46:19,460 --> 00:46:23,779
malware up in here

1207
00:46:20,869 --> 00:46:25,700
<font color="#E5E5E5">all right so you might want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> figure</font>

1208
00:46:23,779 --> 00:46:27,859
out that<font color="#E5E5E5"> guy initially I was like those</font>

1209
00:46:25,700 --> 00:46:29,899
aren't<font color="#E5E5E5"> real</font><font color="#CCCCCC"> Internet Explorer's</font><font color="#E5E5E5"> you</font>

1210
00:46:27,859 --> 00:46:32,058
might feel that way<font color="#CCCCCC"> too</font><font color="#E5E5E5"> like those must</font>

1211
00:46:29,900 --> 00:46:34,640
be hanging off<font color="#CCCCCC"> of the C Drive or running</font>

1212
00:46:32,059 --> 00:46:35,690
from<font color="#E5E5E5"> somebody's</font><font color="#CCCCCC"> AppData local</font><font color="#E5E5E5"> but it</font>

1213
00:46:34,640 --> 00:46:38,450
turned out<font color="#CCCCCC"> that these</font><font color="#E5E5E5"> were</font><font color="#CCCCCC"> legitimate</font>

1214
00:46:35,690 --> 00:46:41,480
<font color="#E5E5E5">right or a seemingly legitimate they</font>

1215
00:46:38,450 --> 00:46:45,169
<font color="#CCCCCC">were running</font><font color="#E5E5E5"> from Program Files</font><font color="#CCCCCC"> Internet</font>

1216
00:46:41,480 --> 00:46:46,519
<font color="#E5E5E5">Explorer so we continue we continue</font><font color="#CCCCCC"> now</font>

1217
00:46:45,170 --> 00:46:49,369
you might want<font color="#CCCCCC"> to do a</font><font color="#E5E5E5"> process list</font>

1218
00:46:46,519 --> 00:46:50,660
because we<font color="#CCCCCC"> haven't</font><font color="#E5E5E5"> done</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> yet because</font>

1219
00:46:49,369 --> 00:46:52,490
<font color="#E5E5E5">before we were kind of looking at</font>

1220
00:46:50,660 --> 00:46:54,558
sessions as we go back<font color="#E5E5E5"> and we kick in</font>

1221
00:46:52,490 --> 00:46:56,720
with<font color="#CCCCCC"> a process</font><font color="#E5E5E5"> list there's other</font><font color="#CCCCCC"> things</font>

1222
00:46:54,559 --> 00:46:59,269
to be suspicious of that are also

1223
00:46:56,720 --> 00:47:00,529
running<font color="#E5E5E5"> quite close in</font><font color="#CCCCCC"> proximity</font><font color="#E5E5E5"> you</font>

1224
00:46:59,269 --> 00:47:02,538
<font color="#E5E5E5">know starting right around the same time</font>

1225
00:47:00,529 --> 00:47:05,809
<font color="#CCCCCC">as these crazy Internet Explorer's</font><font color="#E5E5E5"> so</font>

1226
00:47:02,539 --> 00:47:07,309
that's in<font color="#E5E5E5"> spacio it's it's throwing out</font>

1227
00:47:05,809 --> 00:47:09,829
I don't<font color="#E5E5E5"> know what</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> spatio is let's</font>

1228
00:47:07,309 --> 00:47:12,109
let's<font color="#E5E5E5"> figure it out so as I kick back in</font>

1229
00:47:09,829 --> 00:47:14,749
a run a PS list how many<font color="#CCCCCC"> in</font><font color="#E5E5E5"> speciose do</font>

1230
00:47:12,109 --> 00:47:17,210
I see recalls a little bit different

1231
00:47:14,749 --> 00:47:19,368
notice that I chose<font color="#CCCCCC"> to use a different</font>

1232
00:47:17,210 --> 00:47:21,890
tool from<font color="#CCCCCC"> my tool bag I'd you</font><font color="#E5E5E5"> know I</font>

1233
00:47:19,369 --> 00:47:24,259
swapped out<font color="#E5E5E5"> my weapons arsenal is many</font>

1234
00:47:21,890 --> 00:47:26,538
and I chose the difference<font color="#E5E5E5"> for this time</font>

1235
00:47:24,259 --> 00:47:28,009
so recall<font color="#CCCCCC"> actually implements five</font>

1236
00:47:26,539 --> 00:47:29,869
different<font color="#CCCCCC"> methods of processing</font>

1237
00:47:28,009 --> 00:47:31,400
numeration<font color="#E5E5E5"> it doesn't just walk the</font>

1238
00:47:29,869 --> 00:47:33,529
<font color="#CCCCCC">doubly-linked list to be process blocks</font>

1239
00:47:31,400 --> 00:47:35,960
it brings in a little<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> more a</font><font color="#CCCCCC"> little</font>

1240
00:47:33,529 --> 00:47:38,599
<font color="#CCCCCC">bit extra so we're able to</font><font color="#E5E5E5"> see some</font>

1241
00:47:35,960 --> 00:47:40,579
pasts he process blocks because of the

1242
00:47:38,599 --> 00:47:44,059
methods employed<font color="#CCCCCC"> it's a little bit of</font>

1243
00:47:40,579 --> 00:47:45,440
<font color="#CCCCCC">PSK and technique there and yeah two of</font>

1244
00:47:44,059 --> 00:47:47,210
<font color="#E5E5E5">them</font><font color="#CCCCCC"> are in a terminated</font><font color="#E5E5E5"> state so I'm</font>

1245
00:47:45,440 --> 00:47:49,249
like what is this this<font color="#E5E5E5"> is also quite</font>

1246
00:47:47,210 --> 00:47:51,440
exciting um you would probably<font color="#CCCCCC"> want to</font>

1247
00:47:49,249 --> 00:47:51,709
<font color="#E5E5E5">find out full path to disk what else do</font>

1248
00:47:51,440 --> 00:47:55,759
I do

1249
00:47:51,710 --> 00:47:56,960
<font color="#CCCCCC">Oh Oh</font><font color="#E5E5E5"> faster run</font>

1250
00:47:55,759 --> 00:48:00,380
that's nerd stuff because it<font color="#E5E5E5"> was a</font>

1251
00:47:56,960 --> 00:48:03,019
Windows 8<font color="#CCCCCC"> service pack 1 x64 so I ran it</font>

1252
00:48:00,380 --> 00:48:04,730
again and finally<font color="#E5E5E5"> timeline analysis</font>

1253
00:48:03,019 --> 00:48:06,529
because you couldn't stop<font color="#CCCCCC"> me from doing</font>

1254
00:48:04,730 --> 00:48:09,230
<font color="#CCCCCC">timeline like when</font><font color="#E5E5E5"> did that</font><font color="#CCCCCC"> uh</font><font color="#E5E5E5"> since</font>

1255
00:48:06,529 --> 00:48:10,940
<font color="#CCCCCC">passio land on the</font><font color="#E5E5E5"> box we figure it out</font>

1256
00:48:09,230 --> 00:48:12,950
<font color="#CCCCCC">we point the finger back to an</font>

1257
00:48:10,940 --> 00:48:15,109
installation package<font color="#CCCCCC"> I guess my advice</font>

1258
00:48:12,950 --> 00:48:19,279
<font color="#E5E5E5">to you is</font><font color="#CCCCCC"> when you're installing firefox</font>

1259
00:48:15,109 --> 00:48:21,828
<font color="#CCCCCC">don't choose the</font><font color="#E5E5E5"> first search results</font>

1260
00:48:19,279 --> 00:48:24,049
when you type in Firefox download don't

1261
00:48:21,829 --> 00:48:26,150
do that don't do that it's not the

1262
00:48:24,049 --> 00:48:29,569
<font color="#CCCCCC">SourceForge one that you want</font><font color="#E5E5E5"> to install</font>

1263
00:48:26,150 --> 00:48:31,339
<font color="#E5E5E5">Firefox so yeah what we did was more</font>

1264
00:48:29,569 --> 00:48:33,290
evidence of execution here you<font color="#CCCCCC"> can see</font>

1265
00:48:31,339 --> 00:48:35,690
<font color="#CCCCCC">an ins fassio did in fact Orion</font>

1266
00:48:33,290 --> 00:48:37,970
I've played around with<font color="#E5E5E5"> my am</font><font color="#CCCCCC"> cash</font>

1267
00:48:35,690 --> 00:48:41,390
because I couldn't get<font color="#E5E5E5"> in spatio be</font>

1268
00:48:37,970 --> 00:48:43,700
executable<font color="#E5E5E5"> and get a solid</font><font color="#CCCCCC"> md5 or sha-1</font>

1269
00:48:41,390 --> 00:48:44,839
<font color="#E5E5E5">you can go to your am cash register</font><font color="#CCCCCC"> you</font>

1270
00:48:43,700 --> 00:48:47,029
hive and get it

1271
00:48:44,840 --> 00:48:49,550
so I dump this out with<font color="#E5E5E5"> a recall my</font>

1272
00:48:47,030 --> 00:48:51,200
<font color="#CCCCCC">total to us now and went ahead ran</font>

1273
00:48:49,550 --> 00:48:53,930
strings against that am cash registry

1274
00:48:51,200 --> 00:48:56,990
<font color="#E5E5E5">I've and then what did I do</font>

1275
00:48:53,930 --> 00:48:59,810
uploaded a virus total do it do it whoa

1276
00:48:56,990 --> 00:49:01,520
I mean again it's<font color="#CCCCCC"> this tragic it's</font>

1277
00:48:59,810 --> 00:49:04,549
tragic<font color="#E5E5E5"> it was an absolute infection a</font>

1278
00:49:01,520 --> 00:49:06,250
nightmare but<font color="#CCCCCC"> a cool man cool</font><font color="#E5E5E5"> live</font>

1279
00:49:04,550 --> 00:49:09,380
infection I don't remember<font color="#CCCCCC"> Yan</font>

1280
00:49:06,250 --> 00:49:11,480
unbeknownst to me and<font color="#E5E5E5"> shocking so you</font>

1281
00:49:09,380 --> 00:49:14,570
know<font color="#E5E5E5"> I I congratulate you you've made it</font>

1282
00:49:11,480 --> 00:49:17,330
<font color="#CCCCCC">through all seven systems</font><font color="#E5E5E5"> and it is now</font>

1283
00:49:14,570 --> 00:49:21,200
like<font color="#E5E5E5"> five zero minutes 50 minutes</font><font color="#CCCCCC"> good</font>

1284
00:49:17,330 --> 00:49:23,960
<font color="#E5E5E5">job good job</font><font color="#CCCCCC"> I want to I just think the</font>

1285
00:49:21,200 --> 00:49:25,149
<font color="#E5E5E5">Wild West</font><font color="#CCCCCC"> hack best for having me it</font><font color="#E5E5E5"> is</font>

1286
00:49:23,960 --> 00:49:37,150
an honor<font color="#CCCCCC"> to talk to you today</font>

1287
00:49:25,150 --> 00:49:37,150
[Music]

