1
00:00:00,100 --> 00:00:11,340
[Music]

2
00:00:08,480 --> 00:00:13,410
welcome to using<font color="#E5E5E5"> power-ups</font><font color="#CCCCCC"> equal and</font>

3
00:00:11,340 --> 00:00:16,109
gaudy<font color="#E5E5E5"> for Active Directory information</font>

4
00:00:13,410 --> 00:00:17,820
<font color="#E5E5E5">gathering so that's kind of a mouthful</font>

5
00:00:16,109 --> 00:00:19,260
of a title but<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know what you</font>

6
00:00:17,820 --> 00:00:21,090
probably<font color="#E5E5E5"> gathered from that you know</font>

7
00:00:19,260 --> 00:00:23,220
<font color="#E5E5E5">title there is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> this is</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> be</font>

8
00:00:21,090 --> 00:00:25,830
about Active Directory<font color="#E5E5E5"> and information</font>

9
00:00:23,220 --> 00:00:27,900
gathering<font color="#CCCCCC"> and what you may not know from</font>

10
00:00:25,830 --> 00:00:30,570
that title<font color="#CCCCCC"> is those two tools power-ups</font>

11
00:00:27,900 --> 00:00:32,219
equal and gaudy<font color="#E5E5E5"> and hopefully by the end</font>

12
00:00:30,570 --> 00:00:34,579
of<font color="#E5E5E5"> this talk you know you guys are all</font>

13
00:00:32,219 --> 00:00:37,440
familiar with<font color="#E5E5E5"> Active Directory</font>

14
00:00:34,579 --> 00:00:39,210
<font color="#E5E5E5">information gathering concepts and you</font>

15
00:00:37,440 --> 00:00:42,120
know how<font color="#E5E5E5"> to use these two tools to</font>

16
00:00:39,210 --> 00:00:44,460
<font color="#CCCCCC">accomplish that end</font><font color="#E5E5E5"> so you know just</font>

17
00:00:42,120 --> 00:00:46,649
<font color="#E5E5E5">quickly about me my name is Thomas</font>

18
00:00:44,460 --> 00:00:49,649
selling and I'm a web application<font color="#CCCCCC"> in</font>

19
00:00:46,649 --> 00:00:51,870
<font color="#E5E5E5">network pentester at net spy</font><font color="#CCCCCC"> I also</font>

20
00:00:49,649 --> 00:00:54,239
worked<font color="#CCCCCC"> with Scott Sutherland who is the</font>

21
00:00:51,870 --> 00:00:55,649
creator of<font color="#CCCCCC"> powerup sequel on the</font><font color="#E5E5E5"> Active</font>

22
00:00:54,239 --> 00:00:58,430
<font color="#E5E5E5">Directory information gathering</font>

23
00:00:55,649 --> 00:01:01,050
functionality<font color="#E5E5E5"> you know in powerup sequel</font>

24
00:00:58,430 --> 00:01:02,789
and I'm also the creator of<font color="#CCCCCC"> gaadi</font><font color="#E5E5E5"> which</font>

25
00:01:01,050 --> 00:01:05,039
stands for go dump domain info and I'm

26
00:01:02,789 --> 00:01:07,080
kind<font color="#CCCCCC"> of going back and forth go DD I got</font>

27
00:01:05,040 --> 00:01:09,710
or whatever but you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> we're kind</font><font color="#CCCCCC"> of</font>

28
00:01:07,080 --> 00:01:12,479
settling on that for<font color="#E5E5E5"> the moment</font><font color="#CCCCCC"> you know</font>

29
00:01:09,710 --> 00:01:14,850
personal fact<font color="#E5E5E5"> I actually like the venom</font>

30
00:01:12,479 --> 00:01:17,340
movie so maybe that says all<font color="#CCCCCC"> you need to</font>

31
00:01:14,850 --> 00:01:19,619
know about<font color="#E5E5E5"> me but yeah I thought it was</font>

32
00:01:17,340 --> 00:01:22,890
pretty<font color="#E5E5E5"> good you can</font><font color="#CCCCCC"> also find</font><font color="#E5E5E5"> me on</font>

33
00:01:19,619 --> 00:01:25,080
<font color="#E5E5E5">Twitter and I blog at blog</font><font color="#CCCCCC"> net spy calm</font>

34
00:01:22,890 --> 00:01:30,450
and I'll be throwing<font color="#E5E5E5"> these slides up on</font>

35
00:01:25,080 --> 00:01:32,009
SlideShare here right after<font color="#CCCCCC"> this</font><font color="#E5E5E5"> so so</font>

36
00:01:30,450 --> 00:01:33,659
<font color="#E5E5E5">again this is kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> meant to be an</font>

37
00:01:32,009 --> 00:01:35,640
introductory level talk we're<font color="#E5E5E5"> gonna be</font>

38
00:01:33,659 --> 00:01:38,790
talking about<font color="#CCCCCC"> Active Directory concepts</font>

39
00:01:35,640 --> 00:01:40,860
<font color="#E5E5E5">80 information gathering</font><font color="#CCCCCC"> you know and</font>

40
00:01:38,790 --> 00:01:42,890
<font color="#CCCCCC">power-ups</font><font color="#E5E5E5"> equal and gaudy</font><font color="#CCCCCC"> so we'll go</font>

41
00:01:40,860 --> 00:01:44,939
<font color="#CCCCCC">over install instructions set up</font>

42
00:01:42,890 --> 00:01:47,040
methodology of<font color="#E5E5E5"> those two tools you know</font>

43
00:01:44,939 --> 00:01:50,189
how are they<font color="#CCCCCC"> working under the</font><font color="#E5E5E5"> hood</font><font color="#CCCCCC"> and</font>

44
00:01:47,040 --> 00:01:51,600
demos for both and you know<font color="#E5E5E5"> I also want</font>

45
00:01:50,189 --> 00:01:53,939
<font color="#CCCCCC">to</font><font color="#E5E5E5"> recognize some previous research</font>

46
00:01:51,600 --> 00:01:56,039
that's been done<font color="#E5E5E5"> in the area</font><font color="#CCCCCC"> cuz you</font>

47
00:01:53,939 --> 00:01:58,500
<font color="#E5E5E5">know it's really great work you know</font>

48
00:01:56,040 --> 00:02:00,450
that<font color="#CCCCCC"> I've learned from</font><font color="#E5E5E5"> and at the very</font>

49
00:01:58,500 --> 00:02:03,060
<font color="#E5E5E5">end here I just</font><font color="#CCCCCC"> wanted to talk about a</font>

50
00:02:00,450 --> 00:02:04,740
few detection tonight techniques and

51
00:02:03,060 --> 00:02:06,450
really<font color="#E5E5E5"> those</font><font color="#CCCCCC"> are just Windows Event IDs</font>

52
00:02:04,740 --> 00:02:08,310
that I found that have been pretty

53
00:02:06,450 --> 00:02:10,360
interesting<font color="#CCCCCC"> for</font><font color="#E5E5E5"> me while I'm developing</font>

54
00:02:08,310 --> 00:02:15,519
these<font color="#E5E5E5"> tools and while I'm testing</font>

55
00:02:10,360 --> 00:02:17,410
so so<font color="#E5E5E5"> before we get into that</font><font color="#CCCCCC"> why is 80</font>

56
00:02:15,519 --> 00:02:19,000
<font color="#E5E5E5">information gathering useful and I kind</font>

57
00:02:17,410 --> 00:02:21,450
of like<font color="#CCCCCC"> to think about</font><font color="#E5E5E5"> it in three ways</font>

58
00:02:19,000 --> 00:02:23,980
here<font color="#E5E5E5"> so you know in terms of social</font>

59
00:02:21,450 --> 00:02:26,649
situational awareness<font color="#CCCCCC"> what am I</font><font color="#E5E5E5"> looking</font>

60
00:02:23,980 --> 00:02:28,450
for<font color="#CCCCCC"> you know whether you're a pen tester</font>

61
00:02:26,650 --> 00:02:29,980
red team or blue<font color="#E5E5E5"> team or you know</font>

62
00:02:28,450 --> 00:02:31,450
whoever you<font color="#CCCCCC"> are whatever you're however</font>

63
00:02:29,980 --> 00:02:33,670
you're going<font color="#CCCCCC"> about</font><font color="#E5E5E5"> this you need to know</font>

64
00:02:31,450 --> 00:02:35,798
what you're<font color="#E5E5E5"> looking for</font><font color="#CCCCCC"> you know an</font>

65
00:02:33,670 --> 00:02:38,798
<font color="#E5E5E5">information</font><font color="#CCCCCC"> gathering</font><font color="#E5E5E5"> isn't necessarily</font>

66
00:02:35,799 --> 00:02:40,810
it it's it's not trivial right<font color="#E5E5E5"> so you</font>

67
00:02:38,799 --> 00:02:42,640
know with these automation tools<font color="#E5E5E5"> you</font>

68
00:02:40,810 --> 00:02:44,170
know it's made<font color="#CCCCCC"> things a</font><font color="#E5E5E5"> lot easier</font><font color="#CCCCCC"> and</font>

69
00:02:42,640 --> 00:02:46,480
it kind of<font color="#E5E5E5"> gives you a better idea of</font>

70
00:02:44,170 --> 00:02:48,250
what's in<font color="#E5E5E5"> your environment and really</font>

71
00:02:46,480 --> 00:02:51,310
you<font color="#CCCCCC"> know you can't target</font><font color="#E5E5E5"> what you can't</font>

72
00:02:48,250 --> 00:02:54,370
see<font color="#E5E5E5"> so and then the next</font><font color="#CCCCCC"> thing is just</font>

73
00:02:51,310 --> 00:02:56,230
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> escalation paths so you know</font>

74
00:02:54,370 --> 00:02:59,019
where<font color="#E5E5E5"> are privileged users logged in</font>

75
00:02:56,230 --> 00:03:01,119
<font color="#E5E5E5">where are highly</font><font color="#CCCCCC"> trafficked</font><font color="#E5E5E5"> servers you</font>

76
00:02:59,019 --> 00:03:02,860
<font color="#CCCCCC">know information</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> that and if you've</font>

77
00:03:01,120 --> 00:03:05,680
<font color="#E5E5E5">ever used bloodhound or</font><font color="#CCCCCC"> char pound</font>

78
00:03:02,860 --> 00:03:08,560
before<font color="#E5E5E5"> you you know that being able to</font>

79
00:03:05,680 --> 00:03:11,200
see these escalation paths<font color="#E5E5E5"> you know and</font>

80
00:03:08,560 --> 00:03:12,970
see them visually<font color="#E5E5E5"> is really impactful</font>

81
00:03:11,200 --> 00:03:15,940
<font color="#CCCCCC">when</font><font color="#E5E5E5"> you're doing you know any kind of</font>

82
00:03:12,970 --> 00:03:17,500
testing really<font color="#E5E5E5"> and then also identifying</font>

83
00:03:15,940 --> 00:03:20,799
<font color="#CCCCCC">silly misconfigurations</font>

84
00:03:17,500 --> 00:03:23,170
so you know stuff like checking to make

85
00:03:20,799 --> 00:03:24,790
sure<font color="#E5E5E5"> users that shouldn't be a part of</font>

86
00:03:23,170 --> 00:03:26,888
groups with administrative<font color="#CCCCCC"> privileges</font>

87
00:03:24,790 --> 00:03:29,530
<font color="#CCCCCC">you know aren't in those groups</font><font color="#E5E5E5"> and you</font>

88
00:03:26,889 --> 00:03:31,120
<font color="#E5E5E5">know even things</font><font color="#CCCCCC"> like seeing passwords</font>

89
00:03:29,530 --> 00:03:33,609
in the description attributes when

90
00:03:31,120 --> 00:03:35,920
you're<font color="#E5E5E5"> pulling back users</font><font color="#CCCCCC"> I've only seen</font>

91
00:03:33,609 --> 00:03:37,989
<font color="#CCCCCC">that once</font><font color="#E5E5E5"> and nine times out of ten</font>

92
00:03:35,920 --> 00:03:39,790
those passwords<font color="#E5E5E5"> aren't going to work but</font>

93
00:03:37,989 --> 00:03:41,079
you know on<font color="#E5E5E5"> that</font><font color="#CCCCCC"> tenth of time when it</font>

94
00:03:39,790 --> 00:03:42,700
does you know that can really<font color="#E5E5E5"> make a</font>

95
00:03:41,079 --> 00:03:44,109
difference<font color="#E5E5E5"> and even when those don't</font>

96
00:03:42,700 --> 00:03:47,078
work<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> that can give you an</font>

97
00:03:44,109 --> 00:03:48,639
insight into you know what sis admins

98
00:03:47,079 --> 00:03:50,380
are doing with their passwords and you

99
00:03:48,639 --> 00:03:54,459
know what kind of passwords are they

100
00:03:50,380 --> 00:03:56,859
using so and then why are we<font color="#CCCCCC"> talking</font>

101
00:03:54,459 --> 00:03:58,450
about these two<font color="#E5E5E5"> tools here so really</font>

102
00:03:56,859 --> 00:04:01,389
they're just<font color="#E5E5E5"> information gathering</font>

103
00:03:58,450 --> 00:04:03,280
alternatives so you may be<font color="#E5E5E5"> familiar</font><font color="#CCCCCC"> with</font>

104
00:04:01,389 --> 00:04:05,470
Power View<font color="#CCCCCC"> and you know that's a tool</font>

105
00:04:03,280 --> 00:04:07,060
written in PowerShell<font color="#CCCCCC"> and really what</font>

106
00:04:05,470 --> 00:04:09,190
separates these two<font color="#E5E5E5"> tools from you know</font>

107
00:04:07,060 --> 00:04:10,569
something like Power View is the mediums

108
00:04:09,190 --> 00:04:12,700
that<font color="#E5E5E5"> they're doing this information</font>

109
00:04:10,569 --> 00:04:14,888
gathering through<font color="#E5E5E5"> so obviously power up</font>

110
00:04:12,700 --> 00:04:16,060
sequel is in a sequel server<font color="#CCCCCC"> tak toolkit</font>

111
00:04:14,889 --> 00:04:18,459
so<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> going to be going through</font>

112
00:04:16,060 --> 00:04:21,459
<font color="#E5E5E5">sequel server and using a DSi to dump</font>

113
00:04:18,459 --> 00:04:23,700
<font color="#CCCCCC">that information and then for</font><font color="#E5E5E5"> ngati</font><font color="#CCCCCC"> or</font>

114
00:04:21,459 --> 00:04:26,250
<font color="#E5E5E5">go DDI that's written in peered</font>

115
00:04:23,700 --> 00:04:29,190
and it's just<font color="#E5E5E5"> using</font><font color="#CCCCCC"> LDAP to achieve that</font>

116
00:04:26,250 --> 00:04:33,930
<font color="#E5E5E5">end there and really yeah they're just</font>

117
00:04:29,190 --> 00:04:35,760
<font color="#CCCCCC">non-typical</font><font color="#E5E5E5"> ways to dumb information so</font>

118
00:04:33,930 --> 00:04:37,440
<font color="#E5E5E5">just some you</font><font color="#CCCCCC"> know I wanted</font><font color="#E5E5E5"> to recognize</font>

119
00:04:35,760 --> 00:04:38,909
<font color="#E5E5E5">some</font><font color="#CCCCCC"> people in the community that I've</font>

120
00:04:37,440 --> 00:04:41,820
learned from specifically<font color="#E5E5E5"> and who have</font>

121
00:04:38,910 --> 00:04:44,940
<font color="#E5E5E5">done great work in this area</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know</font>

122
00:04:41,820 --> 00:04:47,250
harm Joey<font color="#CCCCCC"> over at Specter ops you know</font>

123
00:04:44,940 --> 00:04:49,170
he's put out<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of great research a</font>

124
00:04:47,250 --> 00:04:51,720
lot<font color="#E5E5E5"> of great tools a lot of great blogs</font>

125
00:04:49,170 --> 00:04:54,690
<font color="#E5E5E5">and you know really up here everybody on</font>

126
00:04:51,720 --> 00:04:56,760
this slide<font color="#CCCCCC"> here you know</font><font color="#E5E5E5"> this phrase has</font>

127
00:04:54,690 --> 00:04:57,810
probably been overused enough but really

128
00:04:56,760 --> 00:05:00,000
we're standing on<font color="#CCCCCC"> the</font><font color="#E5E5E5"> shoulders of</font>

129
00:04:57,810 --> 00:05:01,800
giants<font color="#CCCCCC"> you know with this research and</font>

130
00:05:00,000 --> 00:05:04,560
the tools that<font color="#E5E5E5"> you know we're all</font>

131
00:05:01,800 --> 00:05:06,000
<font color="#CCCCCC">looking at here so</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> really a big</font>

132
00:05:04,560 --> 00:05:07,980
thanks to these guys and<font color="#E5E5E5"> all</font><font color="#CCCCCC"> the work</font>

133
00:05:06,000 --> 00:05:10,440
<font color="#CCCCCC">that they've done and if you've</font><font color="#E5E5E5"> ever</font>

134
00:05:07,980 --> 00:05:11,970
been to<font color="#CCCCCC"> ad Security org</font><font color="#E5E5E5"> absolutely check</font>

135
00:05:10,440 --> 00:05:13,800
<font color="#E5E5E5">it out it's great reading pretty much</font>

136
00:05:11,970 --> 00:05:15,570
required homework<font color="#E5E5E5"> if you're going to be</font>

137
00:05:13,800 --> 00:05:16,890
getting<font color="#CCCCCC"> into Active Directory security</font>

138
00:05:15,570 --> 00:05:20,280
at<font color="#CCCCCC"> all</font>

139
00:05:16,890 --> 00:05:22,409
Nikhil he runs a great<font color="#E5E5E5"> blog as</font><font color="#CCCCCC"> well and</font>

140
00:05:20,280 --> 00:05:24,719
<font color="#CCCCCC">nobody Scott Sutherland he's done a lot</font>

141
00:05:22,410 --> 00:05:26,880
of<font color="#E5E5E5"> great work and you know sequel server</font>

142
00:05:24,720 --> 00:05:29,520
research and you know<font color="#E5E5E5"> obviously the</font>

143
00:05:26,880 --> 00:05:31,140
<font color="#E5E5E5">creator of powerup sequel and then you</font>

144
00:05:29,520 --> 00:05:33,599
know<font color="#E5E5E5"> all the authors of Power View</font><font color="#CCCCCC"> too</font>

145
00:05:31,140 --> 00:05:35,640
<font color="#CCCCCC">and you know we</font><font color="#E5E5E5"> kind of touched on power</font>

146
00:05:33,600 --> 00:05:37,800
of you a little<font color="#CCCCCC"> bit before but</font><font color="#E5E5E5"> you know</font>

147
00:05:35,640 --> 00:05:40,140
<font color="#CCCCCC">Power View now</font><font color="#E5E5E5"> is a part of the power</font>

148
00:05:37,800 --> 00:05:42,030
sploit repo up on github<font color="#CCCCCC"> and it's part</font>

149
00:05:40,140 --> 00:05:44,310
of the<font color="#CCCCCC"> recon module stuff and it's</font>

150
00:05:42,030 --> 00:05:47,340
dumping<font color="#E5E5E5"> you know 80 information via you</font>

151
00:05:44,310 --> 00:05:49,470
<font color="#E5E5E5">know PowerShell 80 module hooks LDAP net</font>

152
00:05:47,340 --> 00:05:52,500
<font color="#E5E5E5">WI you know went 32 all that stuff and</font>

153
00:05:49,470 --> 00:05:54,720
really<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> you know the</font><font color="#CCCCCC"> bloodhound</font>

154
00:05:52,500 --> 00:05:56,940
<font color="#CCCCCC">and gesture for PowerShell is actually</font>

155
00:05:54,720 --> 00:05:58,710
based on<font color="#E5E5E5"> Power View</font><font color="#CCCCCC"> you know I don't</font>

156
00:05:56,940 --> 00:06:00,780
know<font color="#E5E5E5"> where it's at exactly now but</font>

157
00:05:58,710 --> 00:06:02,489
<font color="#E5E5E5">really that's you know it's a really</font>

158
00:06:00,780 --> 00:06:06,270
<font color="#E5E5E5">important tool and you know I've</font>

159
00:06:02,490 --> 00:06:08,010
certainly learned a lot from it so and

160
00:06:06,270 --> 00:06:09,240
like I said<font color="#CCCCCC"> before this is</font><font color="#E5E5E5"> kind of we're</font>

161
00:06:08,010 --> 00:06:12,060
<font color="#E5E5E5">gonna go over some in you know</font>

162
00:06:09,240 --> 00:06:13,170
introductory some basics<font color="#CCCCCC"> here</font><font color="#E5E5E5"> just so</font>

163
00:06:12,060 --> 00:06:15,150
you know<font color="#E5E5E5"> everybody's on</font><font color="#CCCCCC"> the same page</font>

164
00:06:13,170 --> 00:06:16,890
<font color="#E5E5E5">but you</font><font color="#CCCCCC"> know I</font><font color="#E5E5E5"> apologize to all of you</font>

165
00:06:15,150 --> 00:06:20,340
who<font color="#CCCCCC"> already know</font><font color="#E5E5E5"> this stuff but you know</font>

166
00:06:16,890 --> 00:06:23,550
just<font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit of intro so you know</font>

167
00:06:20,340 --> 00:06:25,560
what is Active Directory<font color="#E5E5E5"> so you know</font>

168
00:06:23,550 --> 00:06:27,000
<font color="#E5E5E5">even if you can't define</font><font color="#CCCCCC"> it chances</font><font color="#E5E5E5"> are</font>

169
00:06:25,560 --> 00:06:29,010
you've<font color="#CCCCCC"> probably experienced or</font>

170
00:06:27,000 --> 00:06:30,720
interacted with<font color="#CCCCCC"> ad</font><font color="#E5E5E5"> before in your life</font>

171
00:06:29,010 --> 00:06:33,030
you know logging<font color="#CCCCCC"> in to your Windows</font>

172
00:06:30,720 --> 00:06:36,060
domain join computer you're using<font color="#CCCCCC"> you</font>

173
00:06:33,030 --> 00:06:37,638
know domain services and stuff so it's

174
00:06:36,060 --> 00:06:39,499
<font color="#E5E5E5">Microsoft's directory server</font>

175
00:06:37,639 --> 00:06:41,810
already kind<font color="#E5E5E5"> of knew that right but a</font>

176
00:06:39,499 --> 00:06:43,879
directory service<font color="#E5E5E5"> is essentially just</font>

177
00:06:41,810 --> 00:06:45,889
<font color="#E5E5E5">it's providing resource and network</font>

178
00:06:43,879 --> 00:06:48,229
mappings for objects<font color="#CCCCCC"> that are</font>

179
00:06:45,889 --> 00:06:50,060
<font color="#CCCCCC">distributed across a network and</font><font color="#E5E5E5"> you</font>

180
00:06:48,229 --> 00:06:52,099
know this includes like a wide variety

181
00:06:50,060 --> 00:06:54,229
<font color="#CCCCCC">of directory services Federation</font>

182
00:06:52,099 --> 00:06:55,969
services<font color="#CCCCCC"> I deal with</font><font color="#E5E5E5"> you know single</font>

183
00:06:54,229 --> 00:06:59,120
sign-on<font color="#E5E5E5"> lightweight directory services</font>

184
00:06:55,969 --> 00:07:01,370
and domain services and you know domain

185
00:06:59,120 --> 00:07:03,590
services here are really<font color="#E5E5E5"> just scalable</font>

186
00:07:01,370 --> 00:07:04,789
infrastructure for object management

187
00:07:03,590 --> 00:07:08,748
that's really what we're going<font color="#CCCCCC"> to be</font>

188
00:07:04,789 --> 00:07:11,240
focusing on here so<font color="#E5E5E5"> you know I see</font><font color="#CCCCCC"> all</font>

189
00:07:08,749 --> 00:07:12,710
these diagrams<font color="#CCCCCC"> online with triangles and</font>

190
00:07:11,240 --> 00:07:14,599
squares and<font color="#E5E5E5"> all these computers and</font>

191
00:07:12,710 --> 00:07:15,830
<font color="#CCCCCC">stuff but</font><font color="#E5E5E5"> you know I wanted to give you</font>

192
00:07:14,599 --> 00:07:18,949
<font color="#E5E5E5">something a</font><font color="#CCCCCC"> little bit different in</font>

193
00:07:15,830 --> 00:07:21,289
<font color="#CCCCCC">terms</font><font color="#E5E5E5"> of logical you know view of AD so</font>

194
00:07:18,949 --> 00:07:23,449
at the very<font color="#CCCCCC"> top level</font><font color="#E5E5E5"> we have forests</font>

195
00:07:21,289 --> 00:07:24,919
right and those<font color="#E5E5E5"> are going to be</font>

196
00:07:23,449 --> 00:07:27,529
collections of one or more tree

197
00:07:24,919 --> 00:07:30,109
structures and then within<font color="#E5E5E5"> trees we have</font>

198
00:07:27,529 --> 00:07:33,009
<font color="#CCCCCC">you know one or more collections of</font>

199
00:07:30,110 --> 00:07:35,629
goats or domains in this example so

200
00:07:33,009 --> 00:07:38,810
these all kind of represent security

201
00:07:35,629 --> 00:07:41,960
boundaries<font color="#CCCCCC"> within a D and a domain here</font>

202
00:07:38,810 --> 00:07:43,430
<font color="#E5E5E5">is just a collection of objects</font><font color="#CCCCCC"> and you</font>

203
00:07:41,960 --> 00:07:45,680
know we're separating<font color="#E5E5E5"> those objects into</font>

204
00:07:43,430 --> 00:07:47,150
you know two main<font color="#E5E5E5"> groups right we have</font>

205
00:07:45,680 --> 00:07:49,159
resources which is<font color="#E5E5E5"> are like your</font>

206
00:07:47,150 --> 00:07:51,289
printers or something<font color="#E5E5E5"> like</font><font color="#CCCCCC"> that and then</font>

207
00:07:49,159 --> 00:07:53,479
your<font color="#E5E5E5"> security principles which is really</font>

208
00:07:51,289 --> 00:07:56,389
just<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> your users and computers</font>

209
00:07:53,479 --> 00:07:58,128
and those users<font color="#CCCCCC"> and computers are</font><font color="#E5E5E5"> just</font>

210
00:07:56,389 --> 00:08:01,699
basically just physical entities on your

211
00:07:58,129 --> 00:08:04,310
domain<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> you're a user</font><font color="#CCCCCC"> and then</font>

212
00:08:01,699 --> 00:08:05,629
you know domain controllers we all kind

213
00:08:04,310 --> 00:08:06,830
of know what<font color="#E5E5E5"> domain controllers are but</font>

214
00:08:05,629 --> 00:08:08,719
those are<font color="#E5E5E5"> the service where Active</font>

215
00:08:06,830 --> 00:08:11,628
Directory is installed<font color="#E5E5E5"> and you know that</font>

216
00:08:08,719 --> 00:08:13,159
can be<font color="#E5E5E5"> on one or more</font><font color="#CCCCCC"> DC's and you know</font>

217
00:08:11,629 --> 00:08:16,279
all<font color="#E5E5E5"> that information is replicated</font>

218
00:08:13,159 --> 00:08:19,938
<font color="#E5E5E5">across those DC's and then we kind of</font>

219
00:08:16,279 --> 00:08:21,409
<font color="#E5E5E5">have oh use and groups and in oh you is</font>

220
00:08:19,939 --> 00:08:23,960
an organizational<font color="#E5E5E5"> unit and</font><font color="#CCCCCC"> that's a</font>

221
00:08:21,409 --> 00:08:26,629
container for users computers groups and

222
00:08:23,960 --> 00:08:29,299
<font color="#E5E5E5">you can apply group policy and</font>

223
00:08:26,629 --> 00:08:31,580
delegation<font color="#E5E5E5"> to an</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> whereas you</font><font color="#E5E5E5"> know</font>

224
00:08:29,300 --> 00:08:33,919
in contrast with groups<font color="#E5E5E5"> those are</font>

225
00:08:31,580 --> 00:08:35,899
collections of users and computers where

226
00:08:33,919 --> 00:08:37,789
you<font color="#CCCCCC"> know fine-grained access</font><font color="#E5E5E5"> control can</font>

227
00:08:35,899 --> 00:08:39,529
<font color="#CCCCCC">be applied but</font><font color="#E5E5E5"> you can't apply those</font>

228
00:08:37,789 --> 00:08:41,718
group policies that are that delegation

229
00:08:39,529 --> 00:08:43,588
<font color="#E5E5E5">and the same way that you can with those</font>

230
00:08:41,719 --> 00:08:46,060
organizational units

231
00:08:43,589 --> 00:08:48,460
<font color="#E5E5E5">okay so we kind of have that high level</font>

232
00:08:46,060 --> 00:08:51,399
out of<font color="#CCCCCC"> the way right so</font><font color="#E5E5E5"> how are we</font>

233
00:08:48,460 --> 00:08:53,410
access ngey main services so for powerup

234
00:08:51,399 --> 00:08:55,200
sequel we're using<font color="#E5E5E5"> as a</font><font color="#CCCCCC"> DSIRE at the</font>

235
00:08:53,410 --> 00:08:57,339
<font color="#CCCCCC">Active Directory</font><font color="#E5E5E5"> service interfaces</font>

236
00:08:55,200 --> 00:08:58,330
<font color="#CCCCCC">essentially</font><font color="#E5E5E5"> this is just a set of comm</font>

237
00:08:57,339 --> 00:09:00,760
interfaces

238
00:08:58,330 --> 00:09:03,040
you know that are used to manage network

239
00:09:00,760 --> 00:09:05,770
<font color="#E5E5E5">resources and we're using the Olli DB</font>

240
00:09:03,040 --> 00:09:08,860
provider<font color="#E5E5E5"> for</font><font color="#CCCCCC"> ATS I</font><font color="#E5E5E5"> in you know</font><font color="#CCCCCC"> powerup</font>

241
00:09:05,770 --> 00:09:10,959
<font color="#E5E5E5">sequel and essentially you know a DSi</font>

242
00:09:08,860 --> 00:09:12,790
has LDAP providers and if you know

243
00:09:10,959 --> 00:09:13,959
you're<font color="#E5E5E5"> confused about what ATS is</font><font color="#CCCCCC"> you've</font>

244
00:09:12,790 --> 00:09:15,730
never<font color="#E5E5E5"> really heard of it you don't</font>

245
00:09:13,959 --> 00:09:17,260
really understand that<font color="#E5E5E5"> concept</font><font color="#CCCCCC"> it's</font>

246
00:09:15,730 --> 00:09:18,970
really think of it as like you<font color="#CCCCCC"> know</font>

247
00:09:17,260 --> 00:09:21,160
<font color="#E5E5E5">again this is a broad</font><font color="#CCCCCC"> generalization but</font>

248
00:09:18,970 --> 00:09:23,649
<font color="#E5E5E5">it's a wrapper for LDAP essentially</font>

249
00:09:21,160 --> 00:09:26,770
you're using LDAP<font color="#E5E5E5"> you know at the</font><font color="#CCCCCC"> very</font>

250
00:09:23,649 --> 00:09:28,510
end<font color="#CCCCCC"> therefore powers equal ease and then</font>

251
00:09:26,770 --> 00:09:30,010
you know speaking of LDAP<font color="#E5E5E5"> that's</font>

252
00:09:28,510 --> 00:09:32,620
essentially the lightweight directory

253
00:09:30,010 --> 00:09:33,970
access protocol and<font color="#E5E5E5"> that's what Active</font>

254
00:09:32,620 --> 00:09:36,220
Directory is using to get<font color="#E5E5E5"> that</font>

255
00:09:33,970 --> 00:09:39,100
information<font color="#E5E5E5"> so</font><font color="#CCCCCC"> it's used to send and</font>

256
00:09:36,220 --> 00:09:40,360
retrieve<font color="#E5E5E5"> domain information and it</font>

257
00:09:39,100 --> 00:09:42,220
supports different<font color="#CCCCCC"> authentication</font>

258
00:09:40,360 --> 00:09:44,860
methods so we're<font color="#CCCCCC"> talking</font><font color="#E5E5E5"> about you know</font>

259
00:09:42,220 --> 00:09:49,120
simple<font color="#CCCCCC"> bind</font><font color="#E5E5E5"> sazzle with Kerberos and</font>

260
00:09:44,860 --> 00:09:51,430
stuff like that<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> LDAP basics</font>

261
00:09:49,120 --> 00:09:52,900
<font color="#CCCCCC">again here sorry</font><font color="#E5E5E5"> I don't if I'm boring</font>

262
00:09:51,430 --> 00:09:54,790
<font color="#E5E5E5">you</font><font color="#CCCCCC"> guys but just I don't</font><font color="#E5E5E5"> know this is</font>

263
00:09:52,900 --> 00:09:56,740
<font color="#E5E5E5">kind of important topics</font><font color="#CCCCCC"> you know to</font>

264
00:09:54,790 --> 00:09:58,750
<font color="#E5E5E5">kind of get in and understand</font><font color="#CCCCCC"> AD and the</font>

265
00:09:56,740 --> 00:10:00,100
<font color="#CCCCCC">information gathering but I promise</font>

266
00:09:58,750 --> 00:10:01,990
there's gonna be some demos later on

267
00:10:00,100 --> 00:10:06,400
here so don't worry it's<font color="#CCCCCC"> not just</font><font color="#E5E5E5"> going</font>

268
00:10:01,990 --> 00:10:07,870
<font color="#E5E5E5">to be walls of text but so LDAP we have</font>

269
00:10:06,400 --> 00:10:10,360
entries which<font color="#E5E5E5"> are collections of</font>

270
00:10:07,870 --> 00:10:12,640
attributes<font color="#E5E5E5"> and those you know entries</font>

271
00:10:10,360 --> 00:10:14,980
are identified by you know<font color="#E5E5E5"> unique</font>

272
00:10:12,640 --> 00:10:17,050
identifiers or<font color="#E5E5E5"> DNS distinguished names</font>

273
00:10:14,980 --> 00:10:19,480
<font color="#CCCCCC">and there's an example</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> that right</font>

274
00:10:17,050 --> 00:10:21,520
<font color="#CCCCCC">there and</font><font color="#E5E5E5"> then with your attributes</font>

275
00:10:19,480 --> 00:10:23,589
there that's essentially the LDAP data

276
00:10:21,520 --> 00:10:25,270
that's you know identified by a

277
00:10:23,589 --> 00:10:26,320
predefined name and that's<font color="#E5E5E5"> kind of the</font>

278
00:10:25,270 --> 00:10:28,180
information<font color="#CCCCCC"> that we're going</font><font color="#E5E5E5"> to be</font>

279
00:10:26,320 --> 00:10:30,459
<font color="#E5E5E5">looking for that's that's the meat and</font>

280
00:10:28,180 --> 00:10:32,620
potatoes right there and then scope

281
00:10:30,459 --> 00:10:33,969
specifies the search<font color="#CCCCCC"> object that we're</font>

282
00:10:32,620 --> 00:10:35,980
using within<font color="#E5E5E5"> when we're making those</font>

283
00:10:33,970 --> 00:10:37,600
LDAP queries<font color="#CCCCCC"> an example</font><font color="#E5E5E5"> that's you know</font>

284
00:10:35,980 --> 00:10:40,750
a whole subtree or something like<font color="#E5E5E5"> that</font>

285
00:10:37,600 --> 00:10:42,790
<font color="#E5E5E5">and then filters here are interesting</font>

286
00:10:40,750 --> 00:10:44,410
<font color="#E5E5E5">because that's how you filter down data</font>

287
00:10:42,790 --> 00:10:47,110
obviously<font color="#E5E5E5"> and that's how you're</font>

288
00:10:44,410 --> 00:10:49,449
selecting<font color="#E5E5E5"> data within a search so</font><font color="#CCCCCC"> for</font>

289
00:10:47,110 --> 00:10:51,820
<font color="#E5E5E5">example in here we're searching for</font>

290
00:10:49,450 --> 00:10:53,970
groups and we're using you know the

291
00:10:51,820 --> 00:10:55,649
<font color="#CCCCCC">object category filter there</font>

292
00:10:53,970 --> 00:10:57,300
<font color="#CCCCCC">Sam account</font><font color="#E5E5E5"> name with a</font><font color="#CCCCCC"> wild-card which</font>

293
00:10:55,649 --> 00:10:58,410
means we're<font color="#CCCCCC"> just returning</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> the</font>

294
00:10:57,300 --> 00:11:01,319
groups

295
00:10:58,410 --> 00:11:03,120
you know from ad there<font color="#E5E5E5"> and notice that</font>

296
00:11:01,319 --> 00:11:05,579
we also<font color="#E5E5E5"> have you know you can</font><font color="#CCCCCC"> combine</font>

297
00:11:03,120 --> 00:11:07,920
multiple filters and we also have an and

298
00:11:05,579 --> 00:11:10,290
operator<font color="#E5E5E5"> there at the very end and those</font>

299
00:11:07,920 --> 00:11:14,729
operators can be<font color="#E5E5E5"> you know and equal to</font>

300
00:11:10,290 --> 00:11:18,360
or not<font color="#CCCCCC"> you know etc</font><font color="#E5E5E5"> here's just you know</font>

301
00:11:14,730 --> 00:11:19,439
a list of useful LDAP filters<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you</font>

302
00:11:18,360 --> 00:11:20,939
know you can take<font color="#E5E5E5"> a look at these</font>

303
00:11:19,439 --> 00:11:22,620
reference them<font color="#CCCCCC"> later in the slides</font><font color="#E5E5E5"> but</font>

304
00:11:20,939 --> 00:11:25,410
<font color="#E5E5E5">the one thing I wanted to note on was</font>

305
00:11:22,620 --> 00:11:26,879
for the DC's<font color="#E5E5E5"> there you're</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to</font>

306
00:11:25,410 --> 00:11:28,399
notice after user account control

307
00:11:26,879 --> 00:11:31,529
there's<font color="#E5E5E5"> an odd string of digits</font>

308
00:11:28,399 --> 00:11:34,560
<font color="#CCCCCC">essentially what that</font><font color="#E5E5E5"> is is it's an</font>

309
00:11:31,529 --> 00:11:37,620
<font color="#CCCCCC">object identifier and</font><font color="#E5E5E5"> in this specific</font>

310
00:11:34,560 --> 00:11:39,119
case that's an LDAP matching rule and so

311
00:11:37,620 --> 00:11:41,970
what<font color="#CCCCCC"> that</font><font color="#E5E5E5"> means when you're trying to</font>

312
00:11:39,120 --> 00:11:44,100
<font color="#CCCCCC">identify</font><font color="#E5E5E5"> an ADC</font><font color="#CCCCCC"> a match here is only</font>

313
00:11:41,970 --> 00:11:46,350
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to be found if all of those bits</font>

314
00:11:44,100 --> 00:11:48,600
from<font color="#E5E5E5"> the attribute match the value so</font>

315
00:11:46,350 --> 00:11:51,750
it's kind of you<font color="#E5E5E5"> know basically</font>

316
00:11:48,600 --> 00:11:53,970
equivalent<font color="#E5E5E5"> to a bitwise and operator but</font>

317
00:11:51,750 --> 00:11:57,990
you know just those are some<font color="#E5E5E5"> examples of</font>

318
00:11:53,970 --> 00:11:59,610
<font color="#E5E5E5">some useful filters there so got all the</font>

319
00:11:57,990 --> 00:12:02,490
basics out of the way let's get into the

320
00:11:59,610 --> 00:12:04,949
tools right<font color="#E5E5E5"> so first tool is</font><font color="#CCCCCC"> powerup</font>

321
00:12:02,490 --> 00:12:06,870
<font color="#CCCCCC">sequel and essentially</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is just a</font>

322
00:12:04,949 --> 00:12:09,569
<font color="#CCCCCC">PowerShell</font><font color="#E5E5E5"> based tool kit</font><font color="#CCCCCC"> for attacking</font>

323
00:12:06,870 --> 00:12:11,040
sequel server so you<font color="#E5E5E5"> know it supports</font>

324
00:12:09,569 --> 00:12:13,079
sequel server discovery<font color="#E5E5E5"> week</font>

325
00:12:11,040 --> 00:12:15,990
configuration auditing privilege

326
00:12:13,079 --> 00:12:17,339
escalation post exploitation<font color="#E5E5E5"> and you</font>

327
00:12:15,990 --> 00:12:19,740
know some you know Scott Sutherland

328
00:12:17,339 --> 00:12:22,649
released this for blackhat<font color="#E5E5E5"> Arsenal for</font>

329
00:12:19,740 --> 00:12:25,170
2018<font color="#E5E5E5"> but he actually</font><font color="#CCCCCC"> created a</font>

330
00:12:22,649 --> 00:12:27,300
<font color="#CCCCCC">PowerShell script for a sequel C 2</font>

331
00:12:25,170 --> 00:12:29,339
server<font color="#E5E5E5"> so he was pushing that up into</font>

332
00:12:27,300 --> 00:12:30,329
<font color="#E5E5E5">Azure and you know kind of demonstrating</font>

333
00:12:29,339 --> 00:12:33,209
some of<font color="#E5E5E5"> the value there as an</font>

334
00:12:30,329 --> 00:12:34,439
alternative C<font color="#CCCCCC"> to channel so that's you</font>

335
00:12:33,209 --> 00:12:35,849
know<font color="#E5E5E5"> kind of one of</font><font color="#CCCCCC"> the interesting</font>

336
00:12:34,439 --> 00:12:37,319
things that's<font color="#E5E5E5"> been coming</font><font color="#CCCCCC"> out of power</font>

337
00:12:35,850 --> 00:12:39,689
<font color="#CCCCCC">up sequel and you know in terms of the</font>

338
00:12:37,319 --> 00:12:41,040
post exploitation<font color="#CCCCCC"> privilege escalation</font>

339
00:12:39,689 --> 00:12:43,050
really just you know some<font color="#E5E5E5"> of the</font>

340
00:12:41,040 --> 00:12:45,540
interesting functionality<font color="#CCCCCC"> that</font><font color="#E5E5E5"> power up</font>

341
00:12:43,050 --> 00:12:47,430
sequel supports<font color="#E5E5E5"> and at the end of the</font>

342
00:12:45,540 --> 00:12:49,649
<font color="#E5E5E5">day really power up sequel is just about</font>

343
00:12:47,430 --> 00:12:52,378
hacking sequel server on scale and<font color="#CCCCCC"> that</font>

344
00:12:49,649 --> 00:12:53,639
<font color="#E5E5E5">on scale part is extremely important</font><font color="#CCCCCC"> you</font>

345
00:12:52,379 --> 00:12:56,339
know running this in an enterprise

346
00:12:53,639 --> 00:12:58,709
<font color="#CCCCCC">environment it's been pretty quick for</font>

347
00:12:56,339 --> 00:13:00,449
what it is in PowerShell<font color="#CCCCCC"> so you know as</font>

348
00:12:58,709 --> 00:13:02,550
opposed to configuring and looking at

349
00:13:00,449 --> 00:13:05,279
all these configurations on your sequel

350
00:13:02,550 --> 00:13:06,469
server<font color="#CCCCCC"> manually it really speeds</font><font color="#E5E5E5"> things</font>

351
00:13:05,279 --> 00:13:08,760
up

352
00:13:06,470 --> 00:13:10,410
so you know why are<font color="#E5E5E5"> we talking about</font>

353
00:13:08,760 --> 00:13:13,439
sequel server<font color="#E5E5E5"> and why are we still</font>

354
00:13:10,410 --> 00:13:15,000
<font color="#E5E5E5">talking about PowerShell</font><font color="#CCCCCC"> you know sequel</font>

355
00:13:13,440 --> 00:13:17,370
server is going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be extremely popular</font>

356
00:13:15,000 --> 00:13:19,350
<font color="#E5E5E5">in enterprise environments</font><font color="#CCCCCC"> and you know</font>

357
00:13:17,370 --> 00:13:21,240
where you have<font color="#E5E5E5"> ad</font><font color="#CCCCCC"> you're gonna have</font>

358
00:13:19,350 --> 00:13:23,490
sequel server because it integrates so

359
00:13:21,240 --> 00:13:26,430
well with Windows services and that's<font color="#E5E5E5"> by</font>

360
00:13:23,490 --> 00:13:28,380
design<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> know it also offers a ton</font>

361
00:13:26,430 --> 00:13:31,170
of vertical escalation opportunities on

362
00:13:28,380 --> 00:13:33,390
the domain<font color="#CCCCCC"> in a lot</font><font color="#E5E5E5"> of times you know</font>

363
00:13:31,170 --> 00:13:35,640
<font color="#CCCCCC">people aren't</font><font color="#E5E5E5"> looking at the sequel</font>

364
00:13:33,390 --> 00:13:38,100
server or the<font color="#CCCCCC"> database layer</font><font color="#E5E5E5"> you know</font>

365
00:13:35,640 --> 00:13:39,840
for escalation paths<font color="#E5E5E5"> so you're kind of</font>

366
00:13:38,100 --> 00:13:41,970
flying<font color="#E5E5E5"> under the radar when you're</font>

367
00:13:39,840 --> 00:13:43,290
attacking through sequel server<font color="#E5E5E5"> and you</font>

368
00:13:41,970 --> 00:13:44,940
know there's been<font color="#CCCCCC"> a ton</font><font color="#E5E5E5"> of instances</font>

369
00:13:43,290 --> 00:13:47,670
<font color="#E5E5E5">where</font><font color="#CCCCCC"> I've seen and you see Co you know</font>

370
00:13:44,940 --> 00:13:50,250
<font color="#CCCCCC">prob sequel and you know I can go from</font>

371
00:13:47,670 --> 00:13:53,849
<font color="#E5E5E5">you know sysadmin to da just threw a few</font>

372
00:13:50,250 --> 00:13:56,610
<font color="#CCCCCC">Hobbs through a few links</font><font color="#E5E5E5"> so it's really</font>

373
00:13:53,850 --> 00:13:59,250
just a wealth of you know<font color="#E5E5E5"> of escalation</font>

374
00:13:56,610 --> 00:14:01,920
opportunities and then why PowerShell

375
00:13:59,250 --> 00:14:03,810
<font color="#E5E5E5">you know obviously native to Windows</font>

376
00:14:01,920 --> 00:14:06,270
runs commands<font color="#E5E5E5"> in memory and is still</font>

377
00:14:03,810 --> 00:14:08,130
flagged as trusted<font color="#CCCCCC"> but you know in the</font>

378
00:14:06,270 --> 00:14:10,650
<font color="#CCCCCC">future here as we're</font><font color="#E5E5E5"> moving along</font><font color="#CCCCCC"> you</font>

379
00:14:08,130 --> 00:14:12,689
know PowerShell v5 logging EDR solutions

380
00:14:10,650 --> 00:14:14,970
and stuff like that<font color="#E5E5E5"> we may need to start</font>

381
00:14:12,690 --> 00:14:16,560
office skating or disabling<font color="#CCCCCC"> security</font>

382
00:14:14,970 --> 00:14:18,900
features to continue to use these

383
00:14:16,560 --> 00:14:20,939
<font color="#CCCCCC">PowerShell based tools so</font><font color="#E5E5E5"> you know</font>

384
00:14:18,900 --> 00:14:23,430
<font color="#E5E5E5">looking</font><font color="#CCCCCC"> into the future PowerShell is</font>

385
00:14:20,940 --> 00:14:25,230
absolutely still<font color="#CCCCCC"> relevant</font><font color="#E5E5E5"> but we may</font>

386
00:14:23,430 --> 00:14:28,160
need<font color="#E5E5E5"> to start you know we need some</font>

387
00:14:25,230 --> 00:14:31,230
wriggle wiggle room to<font color="#CCCCCC"> work with it so</font>

388
00:14:28,160 --> 00:14:33,329
so<font color="#E5E5E5"> getting</font><font color="#CCCCCC"> started with</font><font color="#E5E5E5"> powerup sequel</font>

389
00:14:31,230 --> 00:14:35,820
you know first place to look is the wiki

390
00:14:33,330 --> 00:14:37,290
up on<font color="#CCCCCC"> github so you're gonna find</font><font color="#E5E5E5"> setup</font>

391
00:14:35,820 --> 00:14:39,720
instructions you're gonna find sheet

392
00:14:37,290 --> 00:14:41,880
sheets documentation resource links and

393
00:14:39,720 --> 00:14:43,680
really<font color="#E5E5E5"> I would recommend taking a look</font>

394
00:14:41,880 --> 00:14:45,540
<font color="#CCCCCC">at those</font><font color="#E5E5E5"> cheat sheets up there because</font>

395
00:14:43,680 --> 00:14:48,120
<font color="#CCCCCC">that will take you from you</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> just</font>

396
00:14:45,540 --> 00:14:50,010
<font color="#E5E5E5">discovering sequel circuit servers to</font>

397
00:14:48,120 --> 00:14:50,730
you know all<font color="#E5E5E5"> the way to escalating on</font>

398
00:14:50,010 --> 00:14:52,290
the domain

399
00:14:50,730 --> 00:14:54,540
so those cheat sheets have<font color="#E5E5E5"> been</font>

400
00:14:52,290 --> 00:14:58,560
invaluable to<font color="#E5E5E5"> me</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> even though I</font>

401
00:14:54,540 --> 00:15:00,780
still use the tool<font color="#CCCCCC"> pretty regularly so</font>

402
00:14:58,560 --> 00:15:02,939
setting up<font color="#E5E5E5"> power-ups equal you can</font><font color="#CCCCCC"> you</font>

403
00:15:00,780 --> 00:15:04,680
know download the file<font color="#E5E5E5"> you know drop it</font>

404
00:15:02,940 --> 00:15:07,260
to disk<font color="#E5E5E5"> ignore the module that way or</font>

405
00:15:04,680 --> 00:15:10,439
<font color="#E5E5E5">just install the module or you can use</font>

406
00:15:07,260 --> 00:15:12,540
the to download cradles here<font color="#E5E5E5"> which you</font>

407
00:15:10,440 --> 00:15:14,880
<font color="#E5E5E5">know you may be familiar with</font><font color="#CCCCCC"> before</font><font color="#E5E5E5"> but</font>

408
00:15:12,540 --> 00:15:16,150
yeah the right<font color="#CCCCCC"> therefore if you want to</font>

409
00:15:14,880 --> 00:15:17,920
reference them<font color="#E5E5E5"> later</font>

410
00:15:16,150 --> 00:15:19,569
and then once you<font color="#CCCCCC"> get everything</font>

411
00:15:17,920 --> 00:15:21,790
<font color="#E5E5E5">installed there and that module is</font>

412
00:15:19,570 --> 00:15:23,620
<font color="#E5E5E5">imported</font><font color="#CCCCCC"> you can see all of the commands</font>

413
00:15:21,790 --> 00:15:26,290
just by running<font color="#E5E5E5"> the get command module</font>

414
00:15:23,620 --> 00:15:29,860
<font color="#E5E5E5">and then you know if you want to see the</font>

415
00:15:26,290 --> 00:15:32,560
<font color="#E5E5E5">ad information-gathering</font><font color="#CCCCCC"> command up here</font>

416
00:15:29,860 --> 00:15:35,560
what you can<font color="#CCCCCC"> do is just</font><font color="#E5E5E5"> thrown that -</font>

417
00:15:32,560 --> 00:15:38,050
name<font color="#CCCCCC"> command</font><font color="#E5E5E5"> line option and get -</font>

418
00:15:35,560 --> 00:15:39,880
sequel domain star<font color="#E5E5E5"> so all of these</font>

419
00:15:38,050 --> 00:15:42,099
functions<font color="#E5E5E5"> are designed to start with you</font>

420
00:15:39,880 --> 00:15:44,050
know get - sequel domain<font color="#E5E5E5"> so you can find</font>

421
00:15:42,100 --> 00:15:45,610
them that<font color="#E5E5E5"> way and if you want to get</font>

422
00:15:44,050 --> 00:15:48,490
help you<font color="#CCCCCC"> know just run</font><font color="#E5E5E5"> the get help</font>

423
00:15:45,610 --> 00:15:50,410
command and really that's<font color="#E5E5E5"> all the</font>

424
00:15:48,490 --> 00:15:52,810
further we're gonna go with introductory

425
00:15:50,410 --> 00:15:54,279
<font color="#E5E5E5">stuff with you know powerup sequel if</font>

426
00:15:52,810 --> 00:15:55,719
you're interested<font color="#E5E5E5"> in seeing more</font><font color="#CCCCCC"> of its</font>

427
00:15:54,279 --> 00:15:59,800
functionality check out the<font color="#CCCCCC"> blackhat</font>

428
00:15:55,720 --> 00:16:01,870
<font color="#E5E5E5">Arsenal slides but so how are we doing</font>

429
00:15:59,800 --> 00:16:05,050
this how are<font color="#E5E5E5"> we dumping information you</font>

430
00:16:01,870 --> 00:16:07,060
know from 80 through sequel server<font color="#E5E5E5"> well</font>

431
00:16:05,050 --> 00:16:09,579
<font color="#E5E5E5">again we</font><font color="#CCCCCC"> mentioned this before</font><font color="#E5E5E5"> it's the</font>

432
00:16:07,060 --> 00:16:11,050
<font color="#E5E5E5">only DB ADSI provider and that's the</font>

433
00:16:09,580 --> 00:16:11,860
main way that<font color="#E5E5E5"> we're gonna be</font><font color="#CCCCCC"> looking for</font>

434
00:16:11,050 --> 00:16:14,290
this information

435
00:16:11,860 --> 00:16:16,390
we<font color="#CCCCCC"> can we support</font><font color="#E5E5E5"> two</font><font color="#CCCCCC"> different ways to</font>

436
00:16:14,290 --> 00:16:18,219
do that<font color="#E5E5E5"> the</font><font color="#CCCCCC"> first one is open query</font>

437
00:16:16,390 --> 00:16:20,260
through<font color="#E5E5E5"> link servers and the other one</font>

438
00:16:18,220 --> 00:16:23,740
is<font color="#E5E5E5"> through open</font><font color="#CCCCCC"> ro set using ad-hoc</font>

439
00:16:20,260 --> 00:16:25,689
<font color="#E5E5E5">queries so that open query method there</font>

440
00:16:23,740 --> 00:16:28,330
<font color="#E5E5E5">again we're using link servers and</font>

441
00:16:25,690 --> 00:16:30,160
essentially you<font color="#E5E5E5"> can use link servers to</font>

442
00:16:28,330 --> 00:16:33,220
<font color="#CCCCCC">run queries</font><font color="#E5E5E5"> on another instance of</font>

443
00:16:30,160 --> 00:16:35,770
sequel server or in<font color="#E5E5E5"> another database</font><font color="#CCCCCC"> and</font>

444
00:16:33,220 --> 00:16:37,810
another big benefit of<font color="#E5E5E5"> link</font><font color="#CCCCCC"> services</font>

445
00:16:35,770 --> 00:16:40,360
that you know you they can<font color="#E5E5E5"> be used to</font>

446
00:16:37,810 --> 00:16:43,119
<font color="#E5E5E5">allow data access from outside of sequel</font>

447
00:16:40,360 --> 00:16:45,760
server and this<font color="#E5E5E5"> is going to you know we</font>

448
00:16:43,120 --> 00:16:48,459
can<font color="#CCCCCC"> actually specify</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> Noli DBA ADSI</font>

449
00:16:45,760 --> 00:16:50,080
provider for<font color="#CCCCCC"> that</font><font color="#E5E5E5"> link server so that's</font>

450
00:16:48,459 --> 00:16:52,630
really<font color="#E5E5E5"> the</font><font color="#CCCCCC"> main way that we're going</font><font color="#E5E5E5"> to</font>

451
00:16:50,080 --> 00:16:55,420
<font color="#E5E5E5">be able to dump this information and</font>

452
00:16:52,630 --> 00:16:57,910
then open query essentially<font color="#E5E5E5"> that's just</font>

453
00:16:55,420 --> 00:16:59,439
executing a<font color="#E5E5E5"> pass-through query on a link</font>

454
00:16:57,910 --> 00:17:01,870
server and<font color="#E5E5E5"> that's how that's the method</font>

455
00:16:59,440 --> 00:17:05,230
<font color="#CCCCCC">you can do</font><font color="#E5E5E5"> to run queries through a link</font>

456
00:17:01,870 --> 00:17:07,720
server that you've set<font color="#CCCCCC"> up and again</font><font color="#E5E5E5"> you</font>

457
00:17:05,230 --> 00:17:10,630
know it's that provider is that<font color="#CCCCCC"> Oly</font><font color="#E5E5E5"> DB</font>

458
00:17:07,720 --> 00:17:12,160
<font color="#CCCCCC">datasource</font><font color="#E5E5E5"> so then on the other hand</font><font color="#CCCCCC"> we</font>

459
00:17:10,630 --> 00:17:14,410
have the open row set method and<font color="#E5E5E5"> that's</font>

460
00:17:12,160 --> 00:17:16,660
going<font color="#E5E5E5"> to be using ad hoc queries and</font>

461
00:17:14,410 --> 00:17:19,150
essentially<font color="#E5E5E5"> ad hoc queries are kind of</font>

462
00:17:16,660 --> 00:17:20,650
just<font color="#E5E5E5"> off-the-cuff fly-by-night queries</font>

463
00:17:19,150 --> 00:17:23,050
that<font color="#E5E5E5"> are meant to be kind of run once</font>

464
00:17:20,650 --> 00:17:24,370
<font color="#E5E5E5">and access data and then that's it and</font>

465
00:17:23,050 --> 00:17:26,050
<font color="#CCCCCC">so you can</font><font color="#E5E5E5"> kind of think</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> them as the</font>

466
00:17:24,369 --> 00:17:28,270
opposite of<font color="#E5E5E5"> stored procedures</font><font color="#CCCCCC"> in that</font>

467
00:17:26,050 --> 00:17:28,960
way<font color="#E5E5E5"> and they're disabled by default</font><font color="#CCCCCC"> and</font>

468
00:17:28,270 --> 00:17:31,149
<font color="#E5E5E5">sequels</font>

469
00:17:28,960 --> 00:17:33,970
so what<font color="#CCCCCC"> powerup</font><font color="#E5E5E5"> sequel is going to be</font>

470
00:17:31,149 --> 00:17:36,549
doing is it's going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be enabling</font><font color="#E5E5E5"> it if</font>

471
00:17:33,970 --> 00:17:38,860
it's disabled<font color="#E5E5E5"> and then once everything</font>

472
00:17:36,549 --> 00:17:40,360
is run through<font color="#E5E5E5"> it goes back and restores</font>

473
00:17:38,860 --> 00:17:42,070
the<font color="#CCCCCC"> setting so we're not trying to</font>

474
00:17:40,360 --> 00:17:44,830
create<font color="#CCCCCC"> massive state changes here when</font>

475
00:17:42,070 --> 00:17:46,870
we're doing our testing so again if it's

476
00:17:44,830 --> 00:17:50,230
disabled we enable it<font color="#E5E5E5"> then</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> disable it</font>

477
00:17:46,870 --> 00:17:51,399
again<font color="#CCCCCC"> and then open</font><font color="#E5E5E5"> row set again like</font>

478
00:17:50,230 --> 00:17:53,409
we mentioned<font color="#E5E5E5"> before that's kind of just</font>

479
00:17:51,399 --> 00:17:55,870
<font color="#E5E5E5">your one time connection to</font><font color="#CCCCCC"> access</font>

480
00:17:53,409 --> 00:17:58,059
remote data<font color="#CCCCCC"> and it's a great alternative</font>

481
00:17:55,870 --> 00:18:00,699
<font color="#CCCCCC">to link servers you know if you know</font>

482
00:17:58,059 --> 00:18:02,470
<font color="#E5E5E5">that the sequel server</font><font color="#CCCCCC"> you know people</font>

483
00:18:00,700 --> 00:18:05,169
are checking for<font color="#E5E5E5"> linked server creation</font>

484
00:18:02,470 --> 00:18:08,710
try using open row set we've had a lot

485
00:18:05,169 --> 00:18:09,789
of luck with<font color="#CCCCCC"> that so these few slides</font>

486
00:18:08,710 --> 00:18:11,890
<font color="#E5E5E5">here I just want to show you what's</font>

487
00:18:09,789 --> 00:18:13,360
<font color="#CCCCCC">going on under the hood and T sequel</font><font color="#E5E5E5"> but</font>

488
00:18:11,890 --> 00:18:14,950
we're not gonna spend<font color="#CCCCCC"> too much time</font><font color="#E5E5E5"> on</font>

489
00:18:13,360 --> 00:18:17,439
this and I<font color="#E5E5E5"> just want to highlight a few</font>

490
00:18:14,950 --> 00:18:19,570
<font color="#CCCCCC">things here so</font><font color="#E5E5E5"> this is where we're</font>

491
00:18:17,440 --> 00:18:22,330
<font color="#CCCCCC">creating our open query</font><font color="#E5E5E5"> and our linked</font>

492
00:18:19,570 --> 00:18:24,370
server here<font color="#E5E5E5"> so the one thing you want to</font>

493
00:18:22,330 --> 00:18:27,010
pay attention<font color="#E5E5E5"> to is that provider there</font>

494
00:18:24,370 --> 00:18:28,959
we're specifying the ad<font color="#E5E5E5"> as DSO object</font>

495
00:18:27,010 --> 00:18:31,149
<font color="#E5E5E5">and we're also providing the</font><font color="#CCCCCC"> datasource</font>

496
00:18:28,960 --> 00:18:35,559
there which is the<font color="#CCCCCC"> ad s</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> data</font>

497
00:18:31,149 --> 00:18:38,439
<font color="#E5E5E5">source and then here with that link that</font>

498
00:18:35,559 --> 00:18:40,779
<font color="#E5E5E5">we've just</font><font color="#CCCCCC"> created</font><font color="#E5E5E5"> we're associating you</font>

499
00:18:38,440 --> 00:18:42,669
know the<font color="#E5E5E5"> users current security context</font>

500
00:18:40,779 --> 00:18:45,250
with this link<font color="#E5E5E5"> and we're doing that by</font>

501
00:18:42,669 --> 00:18:47,080
<font color="#CCCCCC">yourself</font><font color="#E5E5E5"> setting that to true and then</font>

502
00:18:45,250 --> 00:18:50,409
we're<font color="#E5E5E5"> setting local login remote user</font>

503
00:18:47,080 --> 00:18:53,020
and remote password all to know and then

504
00:18:50,409 --> 00:18:55,330
you<font color="#E5E5E5"> know we passed that you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> our</font>

505
00:18:53,020 --> 00:18:57,639
LDAP query through<font color="#E5E5E5"> that linked server</font>

506
00:18:55,330 --> 00:19:00,939
<font color="#E5E5E5">through you know and</font><font color="#CCCCCC"> then it dumps that</font>

507
00:18:57,640 --> 00:19:04,120
information<font color="#E5E5E5"> through the ADSI</font><font color="#CCCCCC"> and Oly DB</font>

508
00:19:00,940 --> 00:19:07,149
provider and then<font color="#E5E5E5"> for open</font><font color="#CCCCCC"> rows that</font>

509
00:19:04,120 --> 00:19:09,100
<font color="#E5E5E5">same thing except we're</font><font color="#CCCCCC"> enabling you</font>

510
00:19:07,149 --> 00:19:10,570
know<font color="#CCCCCC"> ad-hoc</font><font color="#E5E5E5"> queries and then we're</font>

511
00:19:09,100 --> 00:19:12,820
<font color="#CCCCCC">passing you know the same stuff we're</font>

512
00:19:10,570 --> 00:19:15,010
providing that<font color="#CCCCCC"> ad</font><font color="#E5E5E5"> SDS</font><font color="#CCCCCC"> o object as</font><font color="#E5E5E5"> the</font>

513
00:19:12,820 --> 00:19:16,928
provider and<font color="#CCCCCC"> that data</font><font color="#E5E5E5"> source and we</font>

514
00:19:15,010 --> 00:19:19,240
have our user<font color="#E5E5E5"> you know our user filters</font>

515
00:19:16,929 --> 00:19:22,179
there and then you<font color="#E5E5E5"> know that LDAP query</font>

516
00:19:19,240 --> 00:19:24,370
so<font color="#CCCCCC"> that is the last of it</font>

517
00:19:22,179 --> 00:19:26,020
no more<font color="#E5E5E5"> T sequel so don't worry</font><font color="#CCCCCC"> about</font>

518
00:19:24,370 --> 00:19:27,729
<font color="#E5E5E5">that and this is just</font><font color="#CCCCCC"> a list</font><font color="#E5E5E5"> of</font>

519
00:19:26,020 --> 00:19:29,950
functionality<font color="#E5E5E5"> that</font><font color="#CCCCCC"> power up sequel</font>

520
00:19:27,730 --> 00:19:32,679
currently supports and we're<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> talk</font>

521
00:19:29,950 --> 00:19:34,720
about<font color="#E5E5E5"> you know why we can't do some</font>

522
00:19:32,679 --> 00:19:36,730
<font color="#CCCCCC">things and others but really this is</font>

523
00:19:34,720 --> 00:19:38,380
just<font color="#E5E5E5"> your list of you know</font><font color="#CCCCCC"> stuff that</font>

524
00:19:36,730 --> 00:19:39,630
<font color="#CCCCCC">you can dump</font><font color="#E5E5E5"> from the domain through</font>

525
00:19:38,380 --> 00:19:44,549
sequel server

526
00:19:39,630 --> 00:19:46,679
so let's get<font color="#CCCCCC"> to some demo so the first</font>

527
00:19:44,549 --> 00:19:49,350
one here is we're<font color="#CCCCCC"> just</font><font color="#E5E5E5"> going to dump</font>

528
00:19:46,679 --> 00:19:51,240
users from<font color="#E5E5E5"> the domain and what you need</font>

529
00:19:49,350 --> 00:19:53,520
<font color="#E5E5E5">to do the requirements for this is you</font>

530
00:19:51,240 --> 00:19:55,410
<font color="#E5E5E5">need to specify an instance and I would</font>

531
00:19:53,520 --> 00:19:57,629
recommend<font color="#CCCCCC"> also</font><font color="#E5E5E5"> adding on that verbose</font>

532
00:19:55,410 --> 00:20:03,179
flag and in<font color="#E5E5E5"> this example we're looking</font>

533
00:19:57,630 --> 00:20:07,710
only for<font color="#E5E5E5"> users that</font><font color="#CCCCCC"> are enabled so</font>

534
00:20:03,179 --> 00:20:10,230
should<font color="#CCCCCC"> be running their runs</font><font color="#E5E5E5"> pretty</font>

535
00:20:07,710 --> 00:20:11,730
quickly<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> next slide here I'll show</font>

536
00:20:10,230 --> 00:20:13,620
that output<font color="#E5E5E5"> and we'll go over some of</font>

537
00:20:11,730 --> 00:20:15,690
<font color="#E5E5E5">what it's doing</font><font color="#CCCCCC"> there</font>

538
00:20:13,620 --> 00:20:17,219
<font color="#E5E5E5">but you know the first thing and that is</font>

539
00:20:15,690 --> 00:20:19,530
checking<font color="#E5E5E5"> for</font><font color="#CCCCCC"> is that you have the</font>

540
00:20:17,220 --> 00:20:22,530
current permissions for<font color="#CCCCCC"> that instance</font><font color="#E5E5E5"> or</font>

541
00:20:19,530 --> 00:20:24,000
that sequel server instance so first of

542
00:20:22,530 --> 00:20:25,710
all checks if you you have sysadmin

543
00:20:24,000 --> 00:20:28,320
<font color="#E5E5E5">prigs if you don't it's going</font><font color="#CCCCCC"> to stop</font>

544
00:20:25,710 --> 00:20:30,480
execution pretty much right<font color="#E5E5E5"> away</font><font color="#CCCCCC"> and</font>

545
00:20:28,320 --> 00:20:33,330
then it<font color="#E5E5E5"> creates it checks to make sure</font>

546
00:20:30,480 --> 00:20:35,610
<font color="#E5E5E5">that</font><font color="#CCCCCC"> a dsds</font><font color="#E5E5E5"> object is allowed</font><font color="#CCCCCC"> to run in</font>

547
00:20:33,330 --> 00:20:37,379
the current process<font color="#E5E5E5"> and again if it can</font>

548
00:20:35,610 --> 00:20:40,049
it goes<font color="#E5E5E5"> ahead and creates a randomly</font>

549
00:20:37,380 --> 00:20:41,760
named link and then once that<font color="#E5E5E5"> link is</font>

550
00:20:40,049 --> 00:20:44,668
<font color="#E5E5E5">associated</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> user</font><font color="#E5E5E5"> security</font>

551
00:20:41,760 --> 00:20:47,039
context<font color="#CCCCCC"> runs that LDAP query collects</font>

552
00:20:44,669 --> 00:20:48,600
the results<font color="#CCCCCC"> and then kills</font><font color="#E5E5E5"> that sequel</font>

553
00:20:47,039 --> 00:20:50,640
server link so it's<font color="#E5E5E5"> not leaving these</font>

554
00:20:48,600 --> 00:20:52,649
links<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know still on the server there</font>

555
00:20:50,640 --> 00:20:56,280
it's<font color="#E5E5E5"> making sure again to avoid all</font>

556
00:20:52,650 --> 00:20:58,500
kinds<font color="#CCCCCC"> of state changes and then this is</font>

557
00:20:56,280 --> 00:21:00,750
just<font color="#CCCCCC"> an example with open row set same</font>

558
00:20:58,500 --> 00:21:02,549
thing here<font color="#E5E5E5"> we're providing that user</font>

559
00:21:00,750 --> 00:21:05,940
<font color="#E5E5E5">state making</font><font color="#CCCCCC"> sure you know we're looking</font>

560
00:21:02,549 --> 00:21:08,340
<font color="#E5E5E5">for enabled users and we're dumping -</font>

561
00:21:05,940 --> 00:21:09,720
use<font color="#E5E5E5"> ad hoc and that's going to be how</font>

562
00:21:08,340 --> 00:21:14,000
you're going<font color="#E5E5E5"> to be using</font><font color="#CCCCCC"> ad hoc queries</font>

563
00:21:09,720 --> 00:21:14,000
<font color="#CCCCCC">and open row set for</font><font color="#E5E5E5"> this example</font>

564
00:21:18,160 --> 00:21:24,430
so<font color="#CCCCCC"> they're yeah not too hard and again</font>

565
00:21:22,150 --> 00:21:25,870
really<font color="#CCCCCC"> the only</font><font color="#E5E5E5"> difference</font><font color="#CCCCCC"> here from you</font>

566
00:21:24,430 --> 00:21:27,490
<font color="#CCCCCC">know the link service stuff is just</font>

567
00:21:25,870 --> 00:21:30,100
making<font color="#CCCCCC"> sure that</font><font color="#E5E5E5"> ad</font><font color="#CCCCCC"> hoc queries are</font>

568
00:21:27,490 --> 00:21:31,750
enabled there and if you know they

569
00:21:30,100 --> 00:21:35,110
<font color="#E5E5E5">already are it leaves it alone and then</font>

570
00:21:31,750 --> 00:21:36,940
<font color="#E5E5E5">you know it resets those configurations</font>

571
00:21:35,110 --> 00:21:41,169
so you know<font color="#E5E5E5"> we're not leaving massive</font>

572
00:21:36,940 --> 00:21:41,800
state changes and here's<font color="#E5E5E5"> just another</font>

573
00:21:41,170 --> 00:21:43,690
one

574
00:21:41,800 --> 00:21:45,460
you know<font color="#E5E5E5"> dumping</font><font color="#CCCCCC"> laps passwords</font><font color="#E5E5E5"> will</font>

575
00:21:43,690 --> 00:21:47,860
kind<font color="#E5E5E5"> of touch back</font><font color="#CCCCCC"> on this in a few</font>

576
00:21:45,460 --> 00:21:50,560
<font color="#CCCCCC">slides here but</font><font color="#E5E5E5"> again just works the</font>

577
00:21:47,860 --> 00:21:52,870
same way<font color="#E5E5E5"> but you know we can dump users</font>

578
00:21:50,560 --> 00:21:56,230
computers<font color="#CCCCCC"> labs passwords</font><font color="#E5E5E5"> all kinds of</font>

579
00:21:52,870 --> 00:21:59,290
<font color="#CCCCCC">information from the domain so we</font>

580
00:21:56,230 --> 00:22:01,510
mentioned<font color="#CCCCCC"> before about sis admin</font>

581
00:21:59,290 --> 00:22:03,220
privileges and<font color="#E5E5E5"> Scott's done a ton of</font>

582
00:22:01,510 --> 00:22:06,010
<font color="#CCCCCC">research into this and you know what</font>

583
00:22:03,220 --> 00:22:08,710
permissions<font color="#CCCCCC"> you need to actually dump 80</font>

584
00:22:06,010 --> 00:22:10,330
information from<font color="#E5E5E5"> the domain</font><font color="#CCCCCC"> and really</font>

585
00:22:08,710 --> 00:22:11,980
what we kind<font color="#E5E5E5"> of settled on here is that</font>

586
00:22:10,330 --> 00:22:14,620
we absolutely<font color="#E5E5E5"> pretty much do you need</font>

587
00:22:11,980 --> 00:22:16,660
sysadmin<font color="#CCCCCC"> prigs</font><font color="#E5E5E5"> for both open query and</font>

588
00:22:14,620 --> 00:22:18,370
open row set but if you're kind of

589
00:22:16,660 --> 00:22:20,350
interested<font color="#CCCCCC"> in you know the authorization</font>

590
00:22:18,370 --> 00:22:23,320
table here<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> i'll leave that in</font>

591
00:22:20,350 --> 00:22:26,409
the slides but<font color="#CCCCCC"> oh i'm sorry</font><font color="#E5E5E5"> but yeah</font>

592
00:22:23,320 --> 00:22:27,790
<font color="#CCCCCC">those are the two tables here and since</font>

593
00:22:26,410 --> 00:22:30,490
we need<font color="#E5E5E5"> to make sure</font><font color="#CCCCCC"> that we have</font>

594
00:22:27,790 --> 00:22:32,290
sysadmin<font color="#CCCCCC"> prims for that database you can</font>

595
00:22:30,490 --> 00:22:35,020
also provide alternate credentials and

596
00:22:32,290 --> 00:22:38,110
this is useful<font color="#E5E5E5"> because you can provide</font>

597
00:22:35,020 --> 00:22:40,210
you<font color="#CCCCCC"> know for the actual</font><font color="#E5E5E5"> you know MS</font>

598
00:22:38,110 --> 00:22:42,760
sequel instance the user<font color="#E5E5E5"> that has those</font>

599
00:22:40,210 --> 00:22:44,680
<font color="#CCCCCC">SA privileges and then provide a</font>

600
00:22:42,760 --> 00:22:47,230
different<font color="#CCCCCC"> set of credentials</font><font color="#E5E5E5"> to</font>

601
00:22:44,680 --> 00:22:48,700
authenticate<font color="#E5E5E5"> against LDAP with so you</font>

602
00:22:47,230 --> 00:22:50,620
know<font color="#CCCCCC"> in this example we have our</font><font color="#E5E5E5"> sis</font>

603
00:22:48,700 --> 00:22:52,330
<font color="#E5E5E5">have been login and we're using a</font>

604
00:22:50,620 --> 00:22:55,510
<font color="#E5E5E5">completely different set of Windows</font>

605
00:22:52,330 --> 00:22:57,010
domain credentials<font color="#E5E5E5"> so you know supplying</font>

606
00:22:55,510 --> 00:22:58,750
the username and<font color="#CCCCCC"> password there and</font>

607
00:22:57,010 --> 00:23:00,970
<font color="#E5E5E5">obviously the link</font><font color="#CCCCCC"> user name and the</font>

608
00:22:58,750 --> 00:23:03,130
link<font color="#E5E5E5"> password</font><font color="#CCCCCC"> are what you're using</font><font color="#E5E5E5"> to</font>

609
00:23:00,970 --> 00:23:05,080
<font color="#E5E5E5">authenticate against LDAP with and that</font>

610
00:23:03,130 --> 00:23:09,330
works<font color="#E5E5E5"> pretty</font><font color="#CCCCCC"> much</font><font color="#E5E5E5"> the exact</font><font color="#CCCCCC"> same way</font>

611
00:23:05,080 --> 00:23:12,159
with ad-hoc queries and open<font color="#E5E5E5"> row set so</font>

612
00:23:09,330 --> 00:23:14,290
there<font color="#E5E5E5"> are some caveats to using</font><font color="#CCCCCC"> power-up</font>

613
00:23:12,160 --> 00:23:16,690
<font color="#CCCCCC">sequel essentially like we mentioned</font>

614
00:23:14,290 --> 00:23:19,780
<font color="#CCCCCC">before you need sis admin privileges to</font>

615
00:23:16,690 --> 00:23:21,700
return data multivalued<font color="#E5E5E5"> attributes can</font>

616
00:23:19,780 --> 00:23:23,620
it cannot be returned as well which is

617
00:23:21,700 --> 00:23:26,320
<font color="#E5E5E5">extremely annoying</font><font color="#CCCCCC"> especially when you</font>

618
00:23:23,620 --> 00:23:28,300
get<font color="#E5E5E5"> an error like</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> but description</font>

619
00:23:26,320 --> 00:23:30,370
and member<font color="#E5E5E5"> of our two examples</font><font color="#CCCCCC"> of that</font>

620
00:23:28,300 --> 00:23:31,820
and you<font color="#E5E5E5"> know those can</font><font color="#CCCCCC"> be that's useful</font>

621
00:23:30,370 --> 00:23:33,590
<font color="#CCCCCC">information that</font><font color="#E5E5E5"> we've on</font>

622
00:23:31,820 --> 00:23:36,200
fortunately<font color="#CCCCCC"> having</font><font color="#E5E5E5"> figure out how to</font>

623
00:23:33,590 --> 00:23:37,250
dump yet there should be<font color="#E5E5E5"> workarounds</font>

624
00:23:36,200 --> 00:23:39,710
through you know<font color="#CCCCCC"> sequels</font><font color="#E5E5E5"> see all our</font>

625
00:23:37,250 --> 00:23:42,740
<font color="#E5E5E5">stuff but you know we're still</font><font color="#CCCCCC"> looking</font>

626
00:23:39,710 --> 00:23:44,870
into<font color="#CCCCCC"> that</font><font color="#E5E5E5"> and then there's also paging</font>

627
00:23:42,740 --> 00:23:47,060
so essentially if you don't know what

628
00:23:44,870 --> 00:23:50,000
paging is that ensures that the<font color="#CCCCCC"> results</font>

629
00:23:47,060 --> 00:23:52,129
set is going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be presented in a number</font>

630
00:23:50,000 --> 00:23:55,730
<font color="#E5E5E5">of individual pages that all contain the</font>

631
00:23:52,130 --> 00:23:57,950
exact same number<font color="#CCCCCC"> of results so you know</font>

632
00:23:55,730 --> 00:23:59,510
<font color="#E5E5E5">for I guess</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> Windows Server 2012</font>

633
00:23:57,950 --> 00:24:02,450
the default there<font color="#CCCCCC"> is going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> be a</font>

634
00:23:59,510 --> 00:24:04,070
thousand so safer if you're dumping

635
00:24:02,450 --> 00:24:06,140
information you have a thousand and one

636
00:24:04,070 --> 00:24:08,480
results you're only getting a thousand

637
00:24:06,140 --> 00:24:09,740
back<font color="#E5E5E5"> which again is unfortunate but</font>

638
00:24:08,480 --> 00:24:13,490
<font color="#CCCCCC">we're you know we're still working and</font>

639
00:24:09,740 --> 00:24:15,200
looking at workarounds for<font color="#E5E5E5"> that so the</font>

640
00:24:13,490 --> 00:24:16,880
second tool we're talking about here is

641
00:24:15,200 --> 00:24:19,910
<font color="#CCCCCC">gaudí</font><font color="#E5E5E5"> or go DDI</font>

642
00:24:16,880 --> 00:24:22,940
and that<font color="#CCCCCC"> stubs</font><font color="#E5E5E5"> stands for go dump domain</font>

643
00:24:19,910 --> 00:24:25,070
info<font color="#CCCCCC"> and essentially it's just</font><font color="#E5E5E5"> a tool</font>

644
00:24:22,940 --> 00:24:27,440
that's<font color="#E5E5E5"> been written and go to just do</font><font color="#CCCCCC"> a</font>

645
00:24:25,070 --> 00:24:29,689
<font color="#CCCCCC">tea information-gathering</font><font color="#E5E5E5"> so you know in</font>

646
00:24:27,440 --> 00:24:31,940
contrast with<font color="#CCCCCC"> power-up sequel it's a</font>

647
00:24:29,690 --> 00:24:34,760
fully fledged<font color="#E5E5E5"> sequel server attack</font>

648
00:24:31,940 --> 00:24:37,430
toolkit but you know this<font color="#CCCCCC"> is kind of on</font>

649
00:24:34,760 --> 00:24:38,990
a smaller scale<font color="#E5E5E5"> and really it's</font><font color="#CCCCCC"> just you</font>

650
00:24:37,430 --> 00:24:41,630
know a tool that's been written<font color="#E5E5E5"> and go</font>

651
00:24:38,990 --> 00:24:44,420
<font color="#E5E5E5">to dump this information you know and it</font>

652
00:24:41,630 --> 00:24:46,910
so you know supports cross-platform come

653
00:24:44,420 --> 00:24:48,290
<font color="#E5E5E5">compatibility which is really cool so</font>

654
00:24:46,910 --> 00:24:49,940
you know you could<font color="#E5E5E5"> you have your Linux</font>

655
00:24:48,290 --> 00:24:52,760
binaries you have your<font color="#CCCCCC"> Windows binaries</font>

656
00:24:49,940 --> 00:24:54,740
and you know they all support that<font color="#CCCCCC"> I</font>

657
00:24:52,760 --> 00:24:56,240
mean it's all wrapping the environment

658
00:24:54,740 --> 00:25:01,280
up in<font color="#E5E5E5"> that</font><font color="#CCCCCC"> buying area when you drop</font><font color="#E5E5E5"> it</font>

659
00:24:56,240 --> 00:25:02,720
so that's one caveat<font color="#CCCCCC"> so it also performs</font>

660
00:25:01,280 --> 00:25:04,370
well<font color="#CCCCCC"> in larger environments</font>

661
00:25:02,720 --> 00:25:06,740
you know environments where I have run

662
00:25:04,370 --> 00:25:09,080
both<font color="#CCCCCC"> powerup sequel and Power View you</font>

663
00:25:06,740 --> 00:25:11,120
know<font color="#CCCCCC"> gadi or go dump domain information</font>

664
00:25:09,080 --> 00:25:13,610
is significantly<font color="#E5E5E5"> faster just because</font>

665
00:25:11,120 --> 00:25:15,500
we're using you know pure<font color="#E5E5E5"> go and LDAP</font>

666
00:25:13,610 --> 00:25:18,590
<font color="#E5E5E5">it's just a little bit more efficient in</font>

667
00:25:15,500 --> 00:25:20,450
that<font color="#E5E5E5"> way and like I said</font><font color="#CCCCCC"> before</font><font color="#E5E5E5"> for this</font>

668
00:25:18,590 --> 00:25:22,610
<font color="#E5E5E5">it's written in</font><font color="#CCCCCC"> peer go but it does</font><font color="#E5E5E5"> use</font>

669
00:25:20,450 --> 00:25:24,920
another LDAP library<font color="#E5E5E5"> that's written and</font>

670
00:25:22,610 --> 00:25:28,250
go<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know for all the LDAP</font>

671
00:25:24,920 --> 00:25:29,870
functionality so to set it up<font color="#E5E5E5"> you can</font>

672
00:25:28,250 --> 00:25:31,790
<font color="#CCCCCC">just use the binaries in the releases</font>

673
00:25:29,870 --> 00:25:34,429
section which is<font color="#E5E5E5"> extremely simple</font><font color="#CCCCCC"> you</font>

674
00:25:31,790 --> 00:25:36,440
<font color="#CCCCCC">know drop it to disk run it or you can</font>

675
00:25:34,430 --> 00:25:38,390
build<font color="#E5E5E5"> it yourself</font><font color="#CCCCCC"> so if you want</font><font color="#E5E5E5"> to do</font>

676
00:25:36,440 --> 00:25:40,280
some you know make some custom<font color="#E5E5E5"> queries</font>

677
00:25:38,390 --> 00:25:42,470
or you know maybe<font color="#E5E5E5"> tweak the paging a</font>

678
00:25:40,280 --> 00:25:43,970
little bit you<font color="#E5E5E5"> can do that so just make</font>

679
00:25:42,470 --> 00:25:46,370
sure you're<font color="#CCCCCC"> going vironment is set up</font>

680
00:25:43,970 --> 00:25:48,410
<font color="#E5E5E5">follow the link there</font><font color="#CCCCCC"> on the</font>

681
00:25:46,370 --> 00:25:50,270
and then just used to go get<font color="#E5E5E5"> command to</font>

682
00:25:48,410 --> 00:25:54,920
get that<font color="#E5E5E5"> LDAP package and you're on your</font>

683
00:25:50,270 --> 00:25:57,710
<font color="#CCCCCC">way</font><font color="#E5E5E5"> so what's going on under the hood</font>

684
00:25:54,920 --> 00:26:00,410
<font color="#CCCCCC">again we're just using LDAP pretty much</font>

685
00:25:57,710 --> 00:26:02,330
just<font color="#E5E5E5"> simple LDAP queries so we're again</font>

686
00:26:00,410 --> 00:26:04,520
<font color="#E5E5E5">using a third-party</font><font color="#CCCCCC"> library there that's</font>

687
00:26:02,330 --> 00:26:06,230
all written<font color="#CCCCCC"> and go and we're doing on</font>

688
00:26:04,520 --> 00:26:08,780
our<font color="#E5E5E5"> authentication stuff through dialing</font>

689
00:26:06,230 --> 00:26:11,300
<font color="#CCCCCC">binds</font><font color="#E5E5E5"> so we're using go Lang's you know</font>

690
00:26:08,780 --> 00:26:13,040
standard TLS client and we're managing

691
00:26:11,300 --> 00:26:15,950
our certificates through TLS

692
00:26:13,040 --> 00:26:17,270
certificates<font color="#E5E5E5"> and you know when we're</font>

693
00:26:15,950 --> 00:26:19,100
<font color="#E5E5E5">late when the tool is looking for</font>

694
00:26:17,270 --> 00:26:21,560
certificates<font color="#E5E5E5"> that we're doing LDAP over</font>

695
00:26:19,100 --> 00:26:23,810
SSL<font color="#E5E5E5"> it's looking in the default you know</font>

696
00:26:21,560 --> 00:26:26,510
certificate store<font color="#CCCCCC"> that set you know and</font>

697
00:26:23,810 --> 00:26:28,250
<font color="#E5E5E5">you're in in your go environment so for</font>

698
00:26:26,510 --> 00:26:30,260
<font color="#CCCCCC">Windows</font><font color="#E5E5E5"> and Linux</font><font color="#CCCCCC"> that's obviously going</font>

699
00:26:28,250 --> 00:26:31,880
<font color="#CCCCCC">to be</font><font color="#E5E5E5"> different but you</font><font color="#CCCCCC"> know the tool</font>

700
00:26:30,260 --> 00:26:34,790
currently doesn't<font color="#E5E5E5"> support you being able</font>

701
00:26:31,880 --> 00:26:36,290
to specify<font color="#E5E5E5"> a custom you know certificate</font>

702
00:26:34,790 --> 00:26:38,690
<font color="#E5E5E5">store</font><font color="#CCCCCC"> on the command line</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> just make</font>

703
00:26:36,290 --> 00:26:42,110
sure<font color="#CCCCCC"> to dump those certificates in the</font>

704
00:26:38,690 --> 00:26:45,110
<font color="#E5E5E5">default store so you know it supports a</font>

705
00:26:42,110 --> 00:26:48,199
<font color="#E5E5E5">cell</font><font color="#CCCCCC"> or LDAP over Ahsan 636 start TLS</font>

706
00:26:45,110 --> 00:26:50,030
and<font color="#E5E5E5"> plaintext dials which I wouldn't</font>

707
00:26:48,200 --> 00:26:51,830
<font color="#E5E5E5">recommend</font><font color="#CCCCCC"> doing plain</font><font color="#E5E5E5"> text</font><font color="#CCCCCC"> styles unless</font>

708
00:26:50,030 --> 00:26:54,110
you're in a lab environments always make

709
00:26:51,830 --> 00:26:56,449
<font color="#CCCCCC">sure you're using LDAP over SSL because</font>

710
00:26:54,110 --> 00:26:59,389
<font color="#E5E5E5">you know playing LDAP is</font><font color="#CCCCCC"> gonna be the</font>

711
00:26:56,450 --> 00:27:01,160
<font color="#CCCCCC">default</font><font color="#E5E5E5"> but at least for</font><font color="#CCCCCC"> gaudí the tool</font>

712
00:26:59,390 --> 00:27:05,630
here is going<font color="#E5E5E5"> to you know default to</font>

713
00:27:01,160 --> 00:27:07,310
<font color="#CCCCCC">using LDAP over</font><font color="#E5E5E5"> SSL and 636 so and on</font>

714
00:27:05,630 --> 00:27:09,230
<font color="#E5E5E5">linux again</font><font color="#CCCCCC"> you know make sure</font><font color="#E5E5E5"> you're</font>

715
00:27:07,310 --> 00:27:11,300
providing<font color="#CCCCCC"> those certs</font><font color="#E5E5E5"> and if you're on a</font>

716
00:27:09,230 --> 00:27:14,870
Windows domain join most machine<font color="#CCCCCC"> you</font>

717
00:27:11,300 --> 00:27:16,430
shouldn't<font color="#E5E5E5"> have a problem so when</font>

718
00:27:14,870 --> 00:27:18,800
creating the tool and<font color="#E5E5E5"> you know making</font>

719
00:27:16,430 --> 00:27:21,350
these LDAP queries<font color="#CCCCCC"> you know we we try to</font>

720
00:27:18,800 --> 00:27:23,389
take optimizations<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know into the</font>

721
00:27:21,350 --> 00:27:25,459
design here<font color="#E5E5E5"> and this is really just</font><font color="#CCCCCC"> for</font>

722
00:27:23,390 --> 00:27:27,200
any tool<font color="#CCCCCC"> that you're using</font><font color="#E5E5E5"> you know when</font>

723
00:27:25,460 --> 00:27:28,760
you're creating LDAP queries you may

724
00:27:27,200 --> 00:27:31,070
want<font color="#E5E5E5"> to follow some of these steps here</font>

725
00:27:28,760 --> 00:27:33,080
<font color="#CCCCCC">so you know we're gonna</font><font color="#E5E5E5"> be cat you know</font>

726
00:27:31,070 --> 00:27:35,330
<font color="#E5E5E5">querying for object category when</font>

727
00:27:33,080 --> 00:27:37,310
possible<font color="#E5E5E5"> and we're using object category</font>

728
00:27:35,330 --> 00:27:40,580
as an<font color="#E5E5E5"> example here</font><font color="#CCCCCC"> because it's one of</font>

729
00:27:37,310 --> 00:27:42,590
many index attributes and ad so that

730
00:27:40,580 --> 00:27:44,710
indexing basically allows us<font color="#CCCCCC"> to make</font>

731
00:27:42,590 --> 00:27:47,959
faster and more efficient queries

732
00:27:44,710 --> 00:27:49,700
against the DC and we're also<font color="#E5E5E5"> only</font>

733
00:27:47,960 --> 00:27:51,830
clearing<font color="#CCCCCC"> for</font><font color="#E5E5E5"> attributes that are needed</font>

734
00:27:49,700 --> 00:27:53,420
<font color="#E5E5E5">again the more attributes that you're</font>

735
00:27:51,830 --> 00:27:56,010
adding<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know that's going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> be a</font>

736
00:27:53,420 --> 00:27:58,290
longer<font color="#CCCCCC"> search result</font><font color="#E5E5E5"> longer time</font>

737
00:27:56,010 --> 00:28:00,420
efficient<font color="#E5E5E5"> so each one we're</font><font color="#CCCCCC"> making sure</font>

738
00:27:58,290 --> 00:28:03,210
to<font color="#E5E5E5"> only return what</font><font color="#CCCCCC"> we need and what we</font>

739
00:28:00,420 --> 00:28:05,070
want<font color="#CCCCCC"> and paging like we</font><font color="#E5E5E5"> mentioned before</font>

740
00:28:03,210 --> 00:28:07,050
<font color="#E5E5E5">you know unfortunately</font><font color="#CCCCCC"> through power-ups</font>

741
00:28:05,070 --> 00:28:09,330
equal the paging is you know doesn't

742
00:28:07,050 --> 00:28:11,520
quite work as well as we want it to but

743
00:28:09,330 --> 00:28:13,110
here<font color="#E5E5E5"> you know instead of</font><font color="#CCCCCC"> just using</font><font color="#E5E5E5"> that</font>

744
00:28:11,520 --> 00:28:15,330
default of a thousand results<font color="#E5E5E5"> we're</font>

745
00:28:13,110 --> 00:28:17,100
setting the paging to<font color="#CCCCCC"> 200 results and</font>

746
00:28:15,330 --> 00:28:18,960
the reason why we're<font color="#CCCCCC"> doing this is it</font>

747
00:28:17,100 --> 00:28:21,000
pretty helps prevent client blocking<font color="#E5E5E5"> on</font>

748
00:28:18,960 --> 00:28:24,060
<font color="#E5E5E5">the golang side and it also</font><font color="#CCCCCC"> reduces</font>

749
00:28:21,000 --> 00:28:25,890
<font color="#CCCCCC">memory stress on the DC and avoids you</font>

750
00:28:24,060 --> 00:28:27,810
know heavy query detection and flagging

751
00:28:25,890 --> 00:28:29,340
<font color="#CCCCCC">which you know something interesting</font>

752
00:28:27,810 --> 00:28:32,040
<font color="#CCCCCC">we'll talk</font><font color="#E5E5E5"> about right at the very end</font>

753
00:28:29,340 --> 00:28:33,360
here so<font color="#CCCCCC"> this is kind of the last piece</font>

754
00:28:32,040 --> 00:28:35,430
of<font color="#E5E5E5"> code that</font><font color="#CCCCCC"> we're gonna be</font><font color="#E5E5E5"> looking at</font>

755
00:28:33,360 --> 00:28:38,280
but<font color="#E5E5E5"> this is just an example of you know</font>

756
00:28:35,430 --> 00:28:40,590
<font color="#E5E5E5">dumping</font><font color="#CCCCCC"> laps passwords again</font><font color="#E5E5E5"> just</font>

757
00:28:38,280 --> 00:28:42,600
through go so you know again we're only

758
00:28:40,590 --> 00:28:44,520
specifying the attributes that<font color="#E5E5E5"> we need</font>

759
00:28:42,600 --> 00:28:46,709
up there<font color="#CCCCCC"> and you know that's DNS</font>

760
00:28:44,520 --> 00:28:49,230
hostname in both of those you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> key</font>

761
00:28:46,710 --> 00:28:51,690
<font color="#E5E5E5">lapse attributes</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> then our filter</font>

762
00:28:49,230 --> 00:28:54,540
there again<font color="#E5E5E5"> using object category</font>

763
00:28:51,690 --> 00:28:59,640
<font color="#E5E5E5">because it's indexed</font><font color="#CCCCCC"> so and we make the</font>

764
00:28:54,540 --> 00:29:02,040
actual<font color="#E5E5E5"> LDAP search but so feature list</font>

765
00:28:59,640 --> 00:29:03,990
<font color="#CCCCCC">you know users computers DC's we're</font>

766
00:29:02,040 --> 00:29:05,280
really dumping everything<font color="#E5E5E5"> that you know</font>

767
00:29:03,990 --> 00:29:09,060
everything that<font color="#E5E5E5"> you want and everything</font>

768
00:29:05,280 --> 00:29:10,920
<font color="#CCCCCC">that</font><font color="#E5E5E5"> Power View pretty much does and you</font>

769
00:29:09,060 --> 00:29:12,750
know<font color="#E5E5E5"> three of</font><font color="#CCCCCC"> the things that here</font><font color="#E5E5E5"> that</font>

770
00:29:10,920 --> 00:29:15,450
I found<font color="#E5E5E5"> pretty</font><font color="#CCCCCC"> interesting are you know</font>

771
00:29:12,750 --> 00:29:18,150
looking<font color="#CCCCCC"> at labs passwords GPP passwords</font>

772
00:29:15,450 --> 00:29:19,830
<font color="#E5E5E5">and sensitive data checks so you if you</font>

773
00:29:18,150 --> 00:29:21,540
<font color="#E5E5E5">remember you know earlier in the talk I</font>

774
00:29:19,830 --> 00:29:23,070
kind of mentioned<font color="#CCCCCC"> you know that one time</font>

775
00:29:21,540 --> 00:29:24,960
where I found passwords in that

776
00:29:23,070 --> 00:29:26,760
description<font color="#E5E5E5"> attribute</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> we're</font>

777
00:29:24,960 --> 00:29:28,950
just<font color="#CCCCCC"> using a</font><font color="#E5E5E5"> simple discovery looking</font>

778
00:29:26,760 --> 00:29:30,510
for<font color="#CCCCCC"> keywords and stuff like</font><font color="#E5E5E5"> that in that</font>

779
00:29:28,950 --> 00:29:34,290
description<font color="#E5E5E5"> attribute and that'll get</font>

780
00:29:30,510 --> 00:29:36,000
flagged and dumped in a<font color="#E5E5E5"> separate CSV so</font>

781
00:29:34,290 --> 00:29:38,220
<font color="#E5E5E5">I'll just take a few</font><font color="#CCCCCC"> slides to quickly</font>

782
00:29:36,000 --> 00:29:39,930
<font color="#E5E5E5">go over</font><font color="#CCCCCC"> some of the basics here</font><font color="#E5E5E5"> of you</font>

783
00:29:38,220 --> 00:29:42,600
know laps and<font color="#CCCCCC"> GPP if you're not familiar</font>

784
00:29:39,930 --> 00:29:44,430
<font color="#E5E5E5">so you know laps</font><font color="#CCCCCC"> that's essentially</font><font color="#E5E5E5"> the</font>

785
00:29:42,600 --> 00:29:46,530
local administrator password solution

786
00:29:44,430 --> 00:29:48,510
created by Microsoft<font color="#E5E5E5"> as you know</font>

787
00:29:46,530 --> 00:29:50,580
intended for centralized<font color="#CCCCCC"> storage of</font>

788
00:29:48,510 --> 00:29:52,440
passwords<font color="#E5E5E5"> in Active Directory</font>

789
00:29:50,580 --> 00:29:54,449
<font color="#E5E5E5">so all of your local administrator</font>

790
00:29:52,440 --> 00:29:56,100
passwords on domain<font color="#CCCCCC"> join machines all</font>

791
00:29:54,450 --> 00:29:58,879
<font color="#CCCCCC">those</font><font color="#E5E5E5"> are going to be randomized all of</font>

792
00:29:56,100 --> 00:30:01,369
them are going to<font color="#CCCCCC"> be</font><font color="#E5E5E5"> unique</font>

793
00:29:58,879 --> 00:30:03,019
so you know the access<font color="#E5E5E5"> here can be</font>

794
00:30:01,369 --> 00:30:04,999
limited through you know<font color="#CCCCCC"> ackles</font>

795
00:30:03,019 --> 00:30:07,580
but you know what we're looking<font color="#CCCCCC"> for</font><font color="#E5E5E5"> here</font>

796
00:30:04,999 --> 00:30:09,080
<font color="#CCCCCC">is one the admin password and that's</font><font color="#E5E5E5"> the</font>

797
00:30:07,580 --> 00:30:11,330
attribute<font color="#CCCCCC"> that stores</font><font color="#E5E5E5"> the clear text</font>

798
00:30:09,080 --> 00:30:14,090
<font color="#CCCCCC">password but</font><font color="#E5E5E5"> you need domain admin</font>

799
00:30:11,330 --> 00:30:17,360
privileges to read that<font color="#E5E5E5"> which can be</font>

800
00:30:14,090 --> 00:30:20,720
<font color="#E5E5E5">kind of a pain</font><font color="#CCCCCC"> however for the admin</font>

801
00:30:17,360 --> 00:30:22,129
password expiration time<font color="#E5E5E5"> again the</font>

802
00:30:20,720 --> 00:30:24,320
attribute<font color="#E5E5E5"> that stores the password reset</font>

803
00:30:22,129 --> 00:30:26,269
date and time<font color="#CCCCCC"> all you</font><font color="#E5E5E5"> really need is</font>

804
00:30:24,320 --> 00:30:28,610
just<font color="#CCCCCC"> to be an authenticated domain user</font>

805
00:30:26,269 --> 00:30:30,799
and you can read<font color="#E5E5E5"> that attribute and that</font>

806
00:30:28,610 --> 00:30:33,199
can be as you<font color="#E5E5E5"> know extremely useful when</font>

807
00:30:30,799 --> 00:30:34,970
<font color="#CCCCCC">you're looking for computers that have</font>

808
00:30:33,200 --> 00:30:39,619
<font color="#CCCCCC">labs enabled that</font><font color="#E5E5E5"> are using labs</font>

809
00:30:34,970 --> 00:30:42,139
<font color="#E5E5E5">actively and for</font><font color="#CCCCCC"> GPP this is just Group</font>

810
00:30:39,619 --> 00:30:44,449
<font color="#CCCCCC">Policy preferences and you know</font><font color="#E5E5E5"> group</font>

811
00:30:42,139 --> 00:30:45,979
<font color="#E5E5E5">policy preferences essentially were you</font>

812
00:30:44,450 --> 00:30:48,980
know additional functionality that<font color="#E5E5E5"> were</font>

813
00:30:45,980 --> 00:30:50,539
<font color="#E5E5E5">added to group policy objects and what</font>

814
00:30:48,980 --> 00:30:52,369
you can do with<font color="#E5E5E5"> those</font><font color="#CCCCCC"> is you can change</font>

815
00:30:50,539 --> 00:30:54,019
<font color="#E5E5E5">local administrator passwords you can</font>

816
00:30:52,369 --> 00:30:56,029
<font color="#E5E5E5">set configurations for printers</font>

817
00:30:54,019 --> 00:30:58,730
<font color="#E5E5E5">scheduled tasks all that kind of stuff</font>

818
00:30:56,029 --> 00:31:01,159
and when you provide a you know set of

819
00:30:58,730 --> 00:31:03,409
credentials<font color="#CCCCCC"> or a password through you</font>

820
00:31:01,159 --> 00:31:05,749
know with<font color="#CCCCCC"> GPP</font><font color="#E5E5E5"> that's going to create an</font>

821
00:31:03,409 --> 00:31:06,950
XML file with an encrypted password<font color="#CCCCCC"> and</font>

822
00:31:05,749 --> 00:31:10,940
<font color="#E5E5E5">that's</font><font color="#CCCCCC"> gonna be stored in that</font><font color="#E5E5E5"> C</font>

823
00:31:06,950 --> 00:31:14,210
password value<font color="#CCCCCC"> AES 256-bit encrypted and</font>

824
00:31:10,940 --> 00:31:16,009
again once you create a<font color="#CCCCCC"> GPP</font><font color="#E5E5E5"> those</font><font color="#CCCCCC"> XML</font>

825
00:31:14,210 --> 00:31:19,159
files<font color="#E5E5E5"> get dumped on</font><font color="#CCCCCC"> sysvol in the</font>

826
00:31:16,009 --> 00:31:20,749
policies folder which<font color="#E5E5E5"> you know this is</font>

827
00:31:19,159 --> 00:31:24,289
all fine there's<font color="#E5E5E5"> nothing wrong with that</font>

828
00:31:20,749 --> 00:31:27,859
but<font color="#E5E5E5"> for some reason</font><font color="#CCCCCC"> Microsoft did</font>

829
00:31:24,289 --> 00:31:30,470
release that 32 byte<font color="#E5E5E5"> AES private key</font><font color="#CCCCCC"> so</font>

830
00:31:27,859 --> 00:31:31,970
if all authenticated<font color="#E5E5E5"> users have access</font>

831
00:31:30,470 --> 00:31:35,419
to sis file which means<font color="#CCCCCC"> they all have</font>

832
00:31:31,970 --> 00:31:37,039
access<font color="#E5E5E5"> to</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> XML these</font><font color="#CCCCCC"> GPP files they</font>

833
00:31:35,419 --> 00:31:39,980
<font color="#CCCCCC">can get at that</font><font color="#E5E5E5"> password they can</font>

834
00:31:37,039 --> 00:31:42,590
decrypt that password<font color="#E5E5E5"> so you know this</font>

835
00:31:39,980 --> 00:31:44,899
was<font color="#E5E5E5"> fixed in May</font><font color="#CCCCCC"> of 2014 but</font><font color="#E5E5E5"> you would</font>

836
00:31:42,590 --> 00:31:46,609
be<font color="#E5E5E5"> surprised how often we see</font><font color="#CCCCCC"> GPP</font>

837
00:31:44,899 --> 00:31:49,580
passwords<font color="#E5E5E5"> floating around in</font>

838
00:31:46,609 --> 00:31:51,259
environments so again<font color="#E5E5E5"> like we mentioned</font>

839
00:31:49,580 --> 00:31:53,359
<font color="#E5E5E5">before this</font><font color="#CCCCCC"> is a you know a list of</font>

840
00:31:51,259 --> 00:31:56,499
example files here<font color="#E5E5E5"> where you can find</font>

841
00:31:53,359 --> 00:32:00,049
those<font color="#E5E5E5"> encrypted</font><font color="#CCCCCC"> C</font><font color="#E5E5E5"> passwords stored and</font>

842
00:31:56,499 --> 00:32:02,419
just a quick demo<font color="#CCCCCC"> here you know with you</font>

843
00:32:00,049 --> 00:32:04,039
know both Windows<font color="#CCCCCC"> and Linux</font><font color="#E5E5E5"> with running</font>

844
00:32:02,419 --> 00:32:06,109
<font color="#CCCCCC">the tool so there are a number</font><font color="#E5E5E5"> of</font>

845
00:32:04,039 --> 00:32:07,759
<font color="#E5E5E5">required parameters you know you need to</font>

846
00:32:06,109 --> 00:32:10,320
provide the username the<font color="#CCCCCC"> password the</font>

847
00:32:07,759 --> 00:32:12,269
domain your target do you see

848
00:32:10,320 --> 00:32:21,149
and<font color="#E5E5E5"> the option if you want to use start</font>

849
00:32:12,269 --> 00:32:24,360
TLS or just the default<font color="#E5E5E5"> TLS on</font><font color="#CCCCCC"> 636 so</font>

850
00:32:21,149 --> 00:32:27,090
pretty quick there<font color="#CCCCCC"> where we'll go</font><font color="#E5E5E5"> over</font>

851
00:32:24,360 --> 00:32:30,240
the output<font color="#CCCCCC"> there in a few seconds</font><font color="#E5E5E5"> but</font>

852
00:32:27,090 --> 00:32:34,100
this is<font color="#CCCCCC"> just</font><font color="#E5E5E5"> the example</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the the</font>

853
00:32:30,240 --> 00:32:36,720
<font color="#E5E5E5">Linux command and it runs</font><font color="#CCCCCC"> just as fast</font>

854
00:32:34,100 --> 00:32:39,178
so again going back to<font color="#CCCCCC"> that</font><font color="#E5E5E5"> Windows</font>

855
00:32:36,720 --> 00:32:42,299
output<font color="#E5E5E5"> you know we're looking</font><font color="#CCCCCC"> for DC's</font>

856
00:32:39,179 --> 00:32:44,759
domain trusts domain admins<font color="#CCCCCC"> all of</font><font color="#E5E5E5"> that</font>

857
00:32:42,299 --> 00:32:46,799
good<font color="#CCCCCC"> stuff and if you look there we also</font>

858
00:32:44,759 --> 00:32:48,659
found some warnings or some keywords

859
00:32:46,799 --> 00:32:50,279
with some possibly sensitive information

860
00:32:48,659 --> 00:32:53,370
that's been stored in<font color="#E5E5E5"> that</font><font color="#CCCCCC"> description</font>

861
00:32:50,279 --> 00:32:57,720
attribute<font color="#E5E5E5"> and we</font><font color="#CCCCCC"> also found it looks</font>

862
00:32:53,370 --> 00:32:59,549
like seven<font color="#CCCCCC"> GPP passwords so again all of</font>

863
00:32:57,720 --> 00:33:02,519
<font color="#E5E5E5">that output there</font><font color="#CCCCCC"> is getting</font><font color="#E5E5E5"> dumped to</font>

864
00:32:59,549 --> 00:33:04,139
<font color="#CCCCCC">CSV and it creates a cut you know a</font><font color="#E5E5E5"> CSV</font>

865
00:33:02,519 --> 00:33:05,909
directory just<font color="#CCCCCC"> to put all of those files</font>

866
00:33:04,139 --> 00:33:08,459
that<font color="#E5E5E5"> you can look at you know at a later</font>

867
00:33:05,909 --> 00:33:12,389
time<font color="#CCCCCC"> and it's all saved off in that CSV</font>

868
00:33:08,460 --> 00:33:15,269
folder so you<font color="#E5E5E5"> know what are some</font><font color="#CCCCCC"> caveats</font>

869
00:33:12,389 --> 00:33:17,490
here<font color="#E5E5E5"> with using you know</font><font color="#CCCCCC"> gaudy</font><font color="#E5E5E5"> ergo DD</font><font color="#CCCCCC"> I</font>

870
00:33:15,269 --> 00:33:19,409
well<font color="#E5E5E5"> you need to supply credentials</font>

871
00:33:17,490 --> 00:33:22,350
every single time on the command<font color="#E5E5E5"> line</font>

872
00:33:19,409 --> 00:33:23,820
<font color="#E5E5E5">which is kind of annoying and</font><font color="#CCCCCC"> you know</font>

873
00:33:22,350 --> 00:33:25,918
that you can't have it when you're

874
00:33:23,820 --> 00:33:28,080
running<font color="#E5E5E5"> on Windows run from the users</font>

875
00:33:25,919 --> 00:33:29,669
current security context such as<font color="#E5E5E5"> you</font>

876
00:33:28,080 --> 00:33:32,100
<font color="#E5E5E5">know when you use</font><font color="#CCCCCC"> powerup</font><font color="#E5E5E5"> sequel or</font>

877
00:33:29,669 --> 00:33:33,690
<font color="#CCCCCC">Power View</font><font color="#E5E5E5"> and that's you know kind of</font>

878
00:33:32,100 --> 00:33:35,759
something<font color="#E5E5E5"> that I'm</font><font color="#CCCCCC"> interested</font><font color="#E5E5E5"> in seeing</font>

879
00:33:33,690 --> 00:33:39,240
<font color="#E5E5E5">if I can replicate that functionality</font>

880
00:33:35,759 --> 00:33:41,460
<font color="#E5E5E5">with go certificates can also be tricky</font>

881
00:33:39,240 --> 00:33:43,529
<font color="#E5E5E5">when you're</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> a non domain joined</font>

882
00:33:41,460 --> 00:33:45,539
Windows machine make sure<font color="#CCCCCC"> to import</font>

883
00:33:43,529 --> 00:33:49,230
those certificates<font color="#CCCCCC"> on linux</font><font color="#E5E5E5"> and then on</font>

884
00:33:45,539 --> 00:33:51,450
windows<font color="#CCCCCC"> and then when the get GPB</font>

885
00:33:49,230 --> 00:33:53,370
functionality<font color="#CCCCCC"> we're using net</font><font color="#E5E5E5"> use and</font>

886
00:33:51,450 --> 00:33:55,259
mount<font color="#E5E5E5"> to kind of map</font><font color="#CCCCCC"> that share to</font>

887
00:33:53,370 --> 00:33:56,908
<font color="#CCCCCC">sysvol and that could really</font><font color="#E5E5E5"> use some</font>

888
00:33:55,259 --> 00:33:59,070
<font color="#CCCCCC">more robust</font><font color="#E5E5E5"> error handling and we could</font>

889
00:33:56,909 --> 00:34:00,980
probably improve<font color="#E5E5E5"> the XML parsing as well</font>

890
00:33:59,070 --> 00:34:03,330
that could be<font color="#E5E5E5"> a little bit quicker and</font>

891
00:34:00,980 --> 00:34:06,029
probably one of the most<font color="#CCCCCC"> annoying things</font>

892
00:34:03,330 --> 00:34:08,190
that<font color="#E5E5E5"> about you know the</font><font color="#CCCCCC"> third-party</font><font color="#E5E5E5"> LDAP</font>

893
00:34:06,029 --> 00:34:10,710
library that you know this tool is using

894
00:34:08,190 --> 00:34:14,099
is that<font color="#E5E5E5"> all of the attributes need to</font><font color="#CCCCCC"> be</font>

895
00:34:10,710 --> 00:34:16,079
<font color="#E5E5E5">case sensitive</font><font color="#CCCCCC"> which is extremely</font>

896
00:34:14,099 --> 00:34:18,060
painful when you're<font color="#E5E5E5"> trying to you</font><font color="#CCCCCC"> know</font>

897
00:34:16,079 --> 00:34:19,859
try<font color="#E5E5E5"> and figure out and debug these</font>

898
00:34:18,060 --> 00:34:21,509
functions<font color="#E5E5E5"> like oh is that</font><font color="#CCCCCC"> s supposed to</font>

899
00:34:19,859 --> 00:34:21,918
be capitalized in<font color="#E5E5E5"> Sam account name and</font>

900
00:34:21,510 --> 00:34:23,149
<font color="#CCCCCC">it's</font>

901
00:34:21,918 --> 00:34:25,819
<font color="#E5E5E5">you know actually supposed to be</font>

902
00:34:23,149 --> 00:34:29,179
<font color="#CCCCCC">lowercase so I don't know maybe</font><font color="#E5E5E5"> I should</font>

903
00:34:25,819 --> 00:34:31,000
<font color="#E5E5E5">make a pull request for that but and in</font>

904
00:34:29,179 --> 00:34:33,918
terms of the road<font color="#CCCCCC"> map for Gatti</font>

905
00:34:31,000 --> 00:34:36,020
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> again</font><font color="#CCCCCC"> I would</font><font color="#E5E5E5"> like to see if we</font>

906
00:34:33,918 --> 00:34:38,598
<font color="#CCCCCC">could make it use that users current</font>

907
00:34:36,020 --> 00:34:40,219
<font color="#E5E5E5">Windows</font><font color="#CCCCCC"> security context so this</font><font color="#E5E5E5"> would</font>

908
00:34:38,599 --> 00:34:42,679
really be done through<font color="#E5E5E5"> the use of</font><font color="#CCCCCC"> comm</font>

909
00:34:40,219 --> 00:34:45,918
objects and go so tapping into those

910
00:34:42,679 --> 00:34:47,629
IEDs interfaces and seeing if we can you

911
00:34:45,918 --> 00:34:49,460
know first<font color="#CCCCCC"> of</font><font color="#E5E5E5"> all create</font><font color="#CCCCCC"> calm objects</font>

912
00:34:47,629 --> 00:34:51,918
and go which we know we can but<font color="#CCCCCC"> also</font>

913
00:34:49,460 --> 00:34:54,530
creating those interfaces<font color="#E5E5E5"> as</font><font color="#CCCCCC"> well to</font>

914
00:34:51,918 --> 00:34:56,418
dump all this information<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that would</font>

915
00:34:54,530 --> 00:34:58,339
really require<font color="#E5E5E5"> looking at lower level</font>

916
00:34:56,418 --> 00:35:01,970
<font color="#E5E5E5">you</font><font color="#CCCCCC"> know system calls through you know</font>

917
00:34:58,339 --> 00:35:03,500
the<font color="#CCCCCC"> Cisco library and go so</font><font color="#E5E5E5"> low</font><font color="#CCCCCC"> dll fine</font>

918
00:35:01,970 --> 00:35:05,299
procedure<font color="#E5E5E5"> and then calling that</font>

919
00:35:03,500 --> 00:35:07,280
procedure and<font color="#CCCCCC"> then basically doing</font><font color="#E5E5E5"> that</font>

920
00:35:05,299 --> 00:35:09,890
<font color="#E5E5E5">over and over</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> creating you</font><font color="#CCCCCC"> know</font>

921
00:35:07,280 --> 00:35:12,650
custom<font color="#CCCCCC"> Struck's to save all this</font>

922
00:35:09,890 --> 00:35:14,569
information and<font color="#CCCCCC"> you know there is a</font>

923
00:35:12,650 --> 00:35:17,210
<font color="#E5E5E5">library that does this and go already</font>

924
00:35:14,569 --> 00:35:18,740
<font color="#E5E5E5">but it really doesn't support some of</font>

925
00:35:17,210 --> 00:35:22,390
<font color="#E5E5E5">the functionality</font><font color="#CCCCCC"> that I'm looking</font><font color="#E5E5E5"> for</font>

926
00:35:18,740 --> 00:35:25,129
<font color="#CCCCCC">and</font><font color="#E5E5E5"> that would really</font><font color="#CCCCCC"> fit</font><font color="#E5E5E5"> this tool so</font>

927
00:35:22,390 --> 00:35:27,109
so here just<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of like the</font><font color="#E5E5E5"> last bit</font>

928
00:35:25,130 --> 00:35:29,390
<font color="#CCCCCC">of</font><font color="#E5E5E5"> information here is just some very</font>

929
00:35:27,109 --> 00:35:31,130
<font color="#E5E5E5">rudimentary detection you know</font><font color="#CCCCCC"> windows</font>

930
00:35:29,390 --> 00:35:32,569
<font color="#E5E5E5">event IDs that I found that we're kind</font>

931
00:35:31,130 --> 00:35:35,619
of interesting while I was<font color="#E5E5E5"> developing</font>

932
00:35:32,569 --> 00:35:38,750
<font color="#E5E5E5">while I was testing these tools here so</font>

933
00:35:35,619 --> 00:35:40,790
by no means is this as an exhaustive

934
00:35:38,750 --> 00:35:42,020
approach but<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know it might help you</font>

935
00:35:40,790 --> 00:35:46,099
if<font color="#CCCCCC"> you're looking for</font><font color="#E5E5E5"> this type of</font>

936
00:35:42,020 --> 00:35:48,140
behavior<font color="#E5E5E5"> in your environment</font><font color="#CCCCCC"> so in your</font>

937
00:35:46,099 --> 00:35:50,299
registry editor go<font color="#E5E5E5"> to this path here and</font>

938
00:35:48,140 --> 00:35:53,118
take a look at the LDAP interface events

939
00:35:50,299 --> 00:35:54,770
and field engineering sections there go

940
00:35:53,119 --> 00:35:57,710
ahead<font color="#CCCCCC"> and bump those up to five and</font>

941
00:35:54,770 --> 00:36:00,319
<font color="#E5E5E5">those are going to create a huge a ton</font>

942
00:35:57,710 --> 00:36:01,430
amount of logs<font color="#CCCCCC"> so you know you probably</font>

943
00:36:00,319 --> 00:36:03,890
<font color="#E5E5E5">don't want to do this in a production</font>

944
00:36:01,430 --> 00:36:07,700
<font color="#CCCCCC">environment take a look in your</font><font color="#E5E5E5"> lab and</font>

945
00:36:03,890 --> 00:36:09,770
see if it's<font color="#E5E5E5"> beneficial for you so the</font>

946
00:36:07,700 --> 00:36:11,089
<font color="#CCCCCC">two event IDs here the first one pretty</font>

947
00:36:09,770 --> 00:36:12,950
simple you already know that and

948
00:36:11,089 --> 00:36:15,319
<font color="#CCCCCC">probably you know</font><font color="#E5E5E5"> you don't need to turn</font>

949
00:36:12,950 --> 00:36:17,868
those settings up to<font color="#E5E5E5"> five to see you</font>

950
00:36:15,319 --> 00:36:21,500
know clear text binds<font color="#E5E5E5"> or you know binds</font>

951
00:36:17,869 --> 00:36:24,230
without<font color="#E5E5E5"> signing but 16:44 basically has</font>

952
00:36:21,500 --> 00:36:26,480
to do with costly<font color="#E5E5E5"> LDAP searches and this</font>

953
00:36:24,230 --> 00:36:29,000
<font color="#CCCCCC">keys on either you know heavy query</font>

954
00:36:26,480 --> 00:36:31,520
detection or<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> L Deb queries</font><font color="#E5E5E5"> that</font>

955
00:36:29,000 --> 00:36:33,950
<font color="#E5E5E5">have not been optimized</font>

956
00:36:31,520 --> 00:36:35,420
and then this<font color="#E5E5E5"> is just</font><font color="#CCCCCC"> two examples</font><font color="#E5E5E5"> again</font>

957
00:36:33,950 --> 00:36:38,868
<font color="#E5E5E5">you know this</font><font color="#CCCCCC"> is what it's going</font><font color="#E5E5E5"> to look</font>

958
00:36:35,420 --> 00:36:40,850
<font color="#CCCCCC">like in that</font><font color="#E5E5E5"> event log but you know if</font>

959
00:36:38,869 --> 00:36:42,470
you're<font color="#CCCCCC"> using sazzle or just like an LDAP</font>

960
00:36:40,850 --> 00:36:46,160
bind<font color="#E5E5E5"> you know that's</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to get</font>

961
00:36:42,470 --> 00:36:47,390
flagged there and then for 1644 you can

962
00:36:46,160 --> 00:36:49,730
probably see that<font color="#CCCCCC"> a little bit better</font>

963
00:36:47,390 --> 00:36:51,980
<font color="#E5E5E5">but this was actually</font><font color="#CCCCCC"> created by</font><font color="#E5E5E5"> my tool</font>

964
00:36:49,730 --> 00:36:54,260
where I was<font color="#E5E5E5"> looking for users with you</font>

965
00:36:51,980 --> 00:36:57,560
know delegation delegated users in other

966
00:36:54,260 --> 00:36:59,869
words so this<font color="#E5E5E5"> event log is taking you</font>

967
00:36:57,560 --> 00:37:02,509
<font color="#CCCCCC">know note of the filters that we're</font>

968
00:36:59,869 --> 00:37:04,550
using specifically here and also<font color="#E5E5E5"> the</font>

969
00:37:02,510 --> 00:37:06,500
search scope<font color="#E5E5E5"> and the attribute selection</font>

970
00:37:04,550 --> 00:37:09,410
<font color="#E5E5E5">even down</font><font color="#CCCCCC"> to like those individual</font>

971
00:37:06,500 --> 00:37:11,150
attributes<font color="#E5E5E5"> so if you're seeing this sort</font>

972
00:37:09,410 --> 00:37:12,980
of<font color="#CCCCCC"> behavior and it your environment</font>

973
00:37:11,150 --> 00:37:15,650
where you know users<font color="#E5E5E5"> looking for you</font>

974
00:37:12,980 --> 00:37:18,290
know users with you know delegated users

975
00:37:15,650 --> 00:37:20,420
or users that are part of a privileged

976
00:37:18,290 --> 00:37:21,980
user group<font color="#E5E5E5"> this may be something</font><font color="#CCCCCC"> that</font>

977
00:37:20,420 --> 00:37:25,910
could help you<font color="#E5E5E5"> in</font><font color="#CCCCCC"> identifying this sort</font>

978
00:37:21,980 --> 00:37:28,490
of<font color="#CCCCCC"> behavior but so you know wrapping up</font>

979
00:37:25,910 --> 00:37:30,200
here<font color="#CCCCCC"> I'd</font><font color="#E5E5E5"> just like to thank you know</font>

980
00:37:28,490 --> 00:37:32,390
everyone on<font color="#CCCCCC"> that</font><font color="#E5E5E5"> previous research slide</font>

981
00:37:30,200 --> 00:37:33,819
who has helped<font color="#E5E5E5"> me to learn about AD and</font>

982
00:37:32,390 --> 00:37:36,830
you know helping to write<font color="#E5E5E5"> these tools</font>

983
00:37:33,820 --> 00:37:39,650
<font color="#E5E5E5">and my colleague Scott Sutherland Carl</font>

984
00:37:36,830 --> 00:37:41,420
Foss<font color="#CCCCCC"> and Kevin Roberson all really great</font>

985
00:37:39,650 --> 00:37:43,609
and helping me debug and learn all<font color="#CCCCCC"> of</font>

986
00:37:41,420 --> 00:37:45,050
this<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> you know and all the</font>

987
00:37:43,609 --> 00:37:47,240
<font color="#E5E5E5">contributors and really everybody at</font>

988
00:37:45,050 --> 00:37:49,369
this<font color="#E5E5E5"> talk so you know thanks everybody</font>

989
00:37:47,240 --> 00:37:51,740
for listening<font color="#E5E5E5"> through and looking at</font>

990
00:37:49,369 --> 00:37:53,570
some T sequel with me and if you want to

991
00:37:51,740 --> 00:37:55,069
talk<font color="#E5E5E5"> security</font><font color="#CCCCCC"> you know I should be at</font>

992
00:37:53,570 --> 00:37:58,369
the<font color="#CCCCCC"> con or if you want</font><font color="#E5E5E5"> to talk to venom</font>

993
00:37:55,070 --> 00:37:58,820
movie<font color="#E5E5E5"> I'll be wandering so thanks</font>

994
00:37:58,369 --> 00:38:01,690
everybody

995
00:37:58,820 --> 00:38:01,690
preciate it

996
00:38:03,390 --> 00:38:13,420
[Music]

